BICAMERAL REQUEST FOR COMMENTS: RFC-0054
# TITLE: PROJECT ANVIL: PHASE 2 - THE MONOLITH & INJECTION
# CLASSIFICATION: EYES ONLY // KERNEL
# AUTHOR: MEAT (COMMANDER)
# STATUS: RATIFIED

---

## 1. ABSTRACT
Phase 2 is the pivotal transition from loose scripts to a sovereign operating system. It consists of two sub-phases:
1.  **Phase 2A (The Monolith):** Forging the custom Kernel with built-in ZFS and creating the bootable ISO.
2.  **Phase 2B (The Injection):** Compiling and injecting the hermetic toolchain and core services (Compiler, VMM, DB) into that new OS.

## 2. PHASE 2A: THE MONOLITH (INFRASTRUCTURE)
*Ref: PHASE2_DIRECTIVES.md*

### 2.1. The Kernel (Heart)
*   **Base:** Linux 6.6.x (LTS).
*   **Modification:** OpenZFS 2.2.x merged directly into the kernel tree (`CONFIG_ZFS=y`).
*   **Configuration:** Monolithic (No Modules). `CONFIG_BLK_DEV_INITRD=y`, `CONFIG_BLK_DEV_LOOP=y`.

### 2.2. The Userland (Muscles)
*   **Base:** Busybox (Static).
*   **Storage:** ZFS Utilities (Static, Custom Build).
*   **Init:** Custom Python/Shell `init` script for ZFS Pool import and Switch Root.

### 2.3. The Artifact (Body)
*   **Output:** `anvilos-phase2.iso`.
*   **Structure:** Hybrid ISO with a ZFS Pool image (`rootfs.img`) embedded.

---

## 3. PHASE 2B: THE INJECTION (PAYLOAD)
Once the Monolith boots, we inject the "Holy Trinity" of services.

### 3.1. OBJECTIVE 0: THE COMPILER (ANVIL-CC)
*   **Action:** Inject GCC/Musl source.
*   **Build:** Self-hosting static build within the running Monolith.
*   **Purpose:** The only compiler allowed to touch the other components.

### 3.2. OBJECTIVE 1: THE HYPERVISOR (ANVIL-VMM)
*   **Base:** AWS Firecracker (Raw Source).
*   **The Purge:** Remove metrics, logging, and non-essential crates.
*   **The Build:** Static binary targeting `x86_64-unknown-linux-musl`.
*   **The Control:** Custom C-Shim talking to `/tmp/anvil.sock`.

### 3.3. OBJECTIVE 2: THE DATABASE (ANVIL-DB)
*   **Base:** PostgreSQL 16 (Source).
*   **Extensions:** Hydra (Columnar), pgvector (AI Memory).
*   **The Purge:** Remove readline, zlib, perl, python, tcl.
*   **Linking:** Static link against custom OpenSSL.

---
**[SHE] First we build the house (2A), then we move in the furniture (2B).**
