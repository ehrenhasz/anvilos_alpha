{
  "module_name": "mk-2nd.awk",
  "hash_id": "6cf221e3ed551a4f77dfd73bd289076e0f4316eee727f57a4606cca4acca20bc",
  "original_prompt": "Ingested from ncurses-6.4/mk-2nd.awk",
  "human_readable_source": "# $Id: mk-2nd.awk,v 1.23 2021/06/17 21:20:30 tom Exp $\n##############################################################################\n# Copyright 2020,2021 Thomas E. Dickey                                       #\n# Copyright 1998-2004,2005 Free Software Foundation, Inc.                    #\n#                                                                            #\n# Permission is hereby granted, free of charge, to any person obtaining a    #\n# copy of this software and associated documentation files (the \"Software\"), #\n# to deal in the Software without restriction, including without limitation  #\n# the rights to use, copy, modify, merge, publish, distribute, distribute    #\n# with modifications, sublicense, and/or sell copies of the Software, and to #\n# permit persons to whom the Software is furnished to do so, subject to the  #\n# following conditions:                                                      #\n#                                                                            #\n# The above copyright notice and this permission notice shall be included in #\n# all copies or substantial portions of the Software.                        #\n#                                                                            #\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR #\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   #\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    #\n# THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER      #\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING    #\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER        #\n# DEALINGS IN THE SOFTWARE.                                                  #\n#                                                                            #\n# Except as contained in this notice, the name(s) of the above copyright     #\n# holders shall not be used in advertising or otherwise to promote the sale, #\n# use or other dealings in this Software without prior written               #\n# authorization.                                                             #\n##############################################################################\n#\n# Author: Thomas E. Dickey\n#\n# Generate compile-rules for the modules that we are using in libraries or\n# programs.  We are listing them explicitly because we have turned off the\n# suffix rules (to force compilation with the appropriate flags).  We could use\n# make-recursion but that would result in makefiles that are useless for\n# development.\n#\n# Variables:\n#\tmodel directory into which objects are compiled.\n#\tMODEL (uppercase version of \"model\"; toupper is not portable)\n#\techo (yes iff we will show the $(CC) lines)\n#\tsubset (\"none\", \"base\", \"base+ext_funcs\" or \"termlib\")\n#\tcrenames (\"yes\" or \"no\", flag to control whether -c & -o options are used)\n#\tcxxrenames (\"yes\" or \"no\", flag to control whether -c & -o options are used)\n#\ttraces (\"all\" or \"DEBUG\", to control whether tracing is compiled in)\n#\tsrcdir is expanded when \"configure --srcdir\" was used\n#\n# Fields in src/modules:\n#\t$1 = module name\n#\t$2 = progs|lib|c++\n#\t$3 = source-directory\n#\n# Fields in src/modules past $3 are dependencies\n#\nfunction in_subset(value) {\n\t\tvalue = \" \" value \" \";\n\t\tcheck = subset;\n\t\tgsub(\"[+]\", \" \", check);\n\t\tcheck = \" \" check \" \";\n\t\treturn index(check,value);\n\t}\nBEGIN\t{\n\t\tfound = 0\n\t\tusing = 0\n\t}\n\t/^@/ {\n\t\tusing = 0\n\t\tif (subset == \"none\") {\n\t\t\tusing = 1\n\t\t} else if (in_subset($2) > 0) {\n\t\t\tif (using == 0) {\n\t\t\t\tif (found == 0) {\n\t\t\t\t\tprint  \"\"\n\t\t\t\t\tprint  \"# generated by mk-2nd.awk\"\n\t\t\t\t\tprintf \"#   model:      %s\\n\", model\n\t\t\t\t\tprintf \"#   MODEL:      %s\\n\", MODEL\n\t\t\t\t\tprintf \"#   echo:       %s\\n\", echo\n\t\t\t\t\tprintf \"#   subset:     %s\\n\", subset\n\t\t\t\t\tprintf \"#   crenames:   %s\\n\", crenames\n\t\t\t\t\tprintf \"#   cxxrenames: %s\\n\", cxxrenames\n\t\t\t\t\tprintf \"#   traces:     %s\\n\", traces\n\t\t\t\t\tprintf \"#   srcdir:     %s\\n\", srcdir\n\t\t\t\t}\n\t\t\t\tusing = 1\n\t\t\t}\n\t\t}\n\t}\n\t/^[@#]/ {\n\t\tnext\n\t}\n\t$1 ~ /trace/ {\n\t\tif (traces != \"all\" && traces != MODEL && $1 != \"lib_trace\")\n\t\t\tnext\n\t}\n\t{\n\t\tif ($0 != \"\" \\\n\t\t && using != 0) {\n\t\t\tfound = 1\n\t\t\tif ( $1 != \"\" ) {\n\t\t\t\tprint  \"\"\n\t\t\t\tif ( $2 == \"c++\" ) {\n\t\t\t\t\tcompile=\"CXX\"\n\t\t\t\t\tsuffix=\".cc\"\n\t\t\t\t\tuse_c_o=cxxrenames\n\t\t\t\t} else {\n\t\t\t\t\tcompile=\"CC\"\n\t\t\t\t\tsuffix=\".c\"\n\t\t\t\t\tuse_c_o=crenames\n\t\t\t\t}\n\t\t\t\tprintf \"../%s/%s$o :\\t%s/%s%s\", model, $1, $3, $1, suffix\n\t\t\t\tfor (n = 4; n <= NF; n++) printf \" \\\\\\n\\t\\t\\t%s\", $n\n\t\t\t\tprint  \"\"\n\t\t\t\tif ( echo == \"yes\" )\n\t\t\t\t\tatsign=\"\"\n\t\t\t\telse {\n\t\t\t\t\tatsign=\"@\"\n\t\t\t\t\tprintf \"\\t@echo 'compiling %s (%s)'\\n\", $1, model\n\t\t\t\t}\n\t\t\t\tprintf \"\\t%s\", atsign;\n\t\t\t\tif ( use_c_o != \"yes\" ) {\n\t\t\t\t\tprintf \"cd ../%s; \", model;\n\t\t\t\t}\n\t\t\t\t# The choice here is between\n\t\t\t\t#\tbase+ext_funcs and\n\t\t\t\t#\ttermlib+ext_tinfo\n\t\t\t\t# but they may appear in the same value.\n\t\t\t\tif ( subset ~ /base/ ) {\n\t\t\t\t\tmycflags=\"\"\n\t\t\t\t} else if ( subset ~ /termlib/ ) {\n\t\t\t\t\tmycflags=\" -DUSE_TERMLIB\"\n\t\t\t\t}\n\t\t\t\tprintf \"$(LIBTOOL_COMPILE) $(%s) $(CFLAGS_%s)%s -c \", compile, MODEL, mycflags\n\t\t\t\tif ( $3 == \".\" || srcdir == \".\" ) {\n\t\t\t\t\tdir = $3 \"/\"\n\t\t\t\t\tsub(\"^\\\\$\\\\(srcdir\\\\)/\",\"\",dir);\n\t\t\t\t\tsub(\"^\\\\./\",\"\",dir);\n\t\t\t\t\tprintf \"../%s/%s%s%s\", name, dir, $1, suffix\n\t\t\t\t} else {\n\t\t\t\t\tprintf \"%s/%s%s\", $3, $1, suffix\n\t\t\t\t}\n\t\t\t\tif ( use_c_o == \"yes\" ) {\n\t\t\t\t\tprintf \" -o ../%s/%s$o\", model, $1\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tprintf \"%s\", $1\n\t\t\t\tfor (n = 2; n <= NF; n++) printf \" %s\", $n\n\t\t\t}\n\t\t\tprint  \"\"\n\t\t}\n\t}\nEND\t{\n\t\tprint  \"\"\n\t}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}