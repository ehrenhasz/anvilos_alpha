{
  "module_name": "trace_buf.c",
  "hash_id": "df2fa0756a0e9070d4fe09ddfde615a4fb3204333a4f833e8487f479ee3c9702",
  "original_prompt": "Ingested from ncurses-6.4/ncurses/trace/trace_buf.c",
  "human_readable_source": " \n\n \n \n\n#include <curses.priv.h>\n\nMODULE_ID(\"$Id: trace_buf.c,v 1.21 2020/02/02 23:34:34 tom Exp $\")\n\n#ifdef TRACE\n\n#define MyList _nc_globals.tracebuf_ptr\n#define MySize _nc_globals.tracebuf_used\n\nstatic char *\n_nc_trace_alloc(int bufnum, size_t want)\n{\n    char *result = 0;\n\n    if (bufnum >= 0) {\n\tif ((size_t) (bufnum + 1) > MySize) {\n\t    size_t need = (size_t) (bufnum + 1) * 2;\n\t    if ((MyList = typeRealloc(TRACEBUF, need, MyList)) != 0) {\n\t\twhile (need > MySize)\n\t\t    MyList[MySize++].text = 0;\n\t    }\n\t}\n\n\tif (MyList != 0) {\n\t    if (MyList[bufnum].text == 0\n\t\t|| want > MyList[bufnum].size) {\n\t\tMyList[bufnum].text = typeRealloc(char, want, MyList[bufnum].text);\n\t\tif (MyList[bufnum].text != 0)\n\t\t    MyList[bufnum].size = want;\n\t    }\n\t    result = MyList[bufnum].text;\n\t}\n    }\n#if NO_LEAKS\n    else {\n\tif (MySize) {\n\t    if (MyList) {\n\t\twhile (MySize--) {\n\t\t    if (MyList[MySize].text != 0) {\n\t\t\tfree(MyList[MySize].text);\n\t\t    }\n\t\t}\n\t\tfree(MyList);\n\t\tMyList = 0;\n\t    }\n\t    MySize = 0;\n\t}\n    }\n#endif\n    return result;\n}\n\n \nNCURSES_EXPORT(char *)\n_nc_trace_buf(int bufnum, size_t want)\n{\n    char *result = _nc_trace_alloc(bufnum, want);\n    if (result != 0)\n\t*result = '\\0';\n    return result;\n}\n\n \nNCURSES_EXPORT(char *)\n_nc_trace_bufcat(int bufnum, const char *value)\n{\n    char *buffer = _nc_trace_alloc(bufnum, (size_t) 0);\n    if (buffer != 0) {\n\tsize_t have = strlen(buffer);\n\tsize_t need = strlen(value) + have;\n\n\tbuffer = _nc_trace_alloc(bufnum, 1 + need);\n\tif (buffer != 0)\n\t    _nc_STRCPY(buffer + have, value, need);\n\n    }\n    return buffer;\n}\n#else\nEMPTY_MODULE(_nc_empty_trace_buf)\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}