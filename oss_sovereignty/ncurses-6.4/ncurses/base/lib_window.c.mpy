{
  "module_name": "lib_window.c",
  "hash_id": "c748ee43fc83327e097f8bc47196bf6f4e7bb1327d10159953f9bc6a7c64239d",
  "original_prompt": "Ingested from ncurses-6.4/ncurses/base/lib_window.c",
  "human_readable_source": " \n\n \n\n \n\n#include <curses.priv.h>\n\nMODULE_ID(\"$Id: lib_window.c,v 1.32 2021/10/23 23:06:24 tom Exp $\")\n\nNCURSES_EXPORT(void)\n_nc_synchook(WINDOW *win)\n \n{\n    if (win->_immed)\n\twrefresh(win);\n    if (win->_sync)\n\twsyncup(win);\n}\n\nNCURSES_EXPORT(int)\nmvderwin(WINDOW *win, int y, int x)\n \n{\n    WINDOW *orig;\n    int rc = ERR;\n\n    T((T_CALLED(\"mvderwin(%p,%d,%d)\"), (void *) win, y, x));\n\n    if (win != 0\n\t&& (orig = win->_parent) != 0\n\t&& (x >= 0 && y >= 0)\n\t&& (x + getmaxx(win) <= getmaxx(orig))\n\t&& (y + getmaxy(win) <= getmaxy(orig))) {\n\tint i;\n\n\twsyncup(win);\n\twin->_parx = x;\n\twin->_pary = y;\n\tfor (i = 0; i < getmaxy(win); i++)\n\t    win->_line[i].text = &(orig->_line[y++].text[x]);\n\trc = OK;\n    }\n    returnCode(rc);\n}\n\nNCURSES_EXPORT(int)\nsyncok(WINDOW *win, bool bf)\n \n{\n    T((T_CALLED(\"syncok(%p,%d)\"), (void *) win, bf));\n\n    if (win) {\n\twin->_sync = bf;\n\treturnCode(OK);\n    } else\n\treturnCode(ERR);\n}\n\nNCURSES_EXPORT(void)\nwsyncup(WINDOW *win)\n \n \n{\n    WINDOW *wp;\n\n    T((T_CALLED(\"wsyncup(%p)\"), (void *) win));\n    if (win && win->_parent) {\n\tfor (wp = win; wp->_parent; wp = wp->_parent) {\n\t    int y;\n\t    WINDOW *pp = wp->_parent;\n\n\t    assert((wp->_pary <= pp->_maxy) &&\n\t\t   ((wp->_pary + wp->_maxy) <= pp->_maxy));\n\n\t    for (y = 0; y <= wp->_maxy; y++) {\n\t\tint left = wp->_line[y].firstchar;\n\t\tif (left >= 0) {\t \n\t\t    struct ldat *line = &(pp->_line[wp->_pary + y]);\n\t\t     \n\t\t    int right = wp->_line[y].lastchar + wp->_parx;\n\t\t    left += wp->_parx;\n\n\t\t    CHANGED_RANGE(line, left, right);\n\t\t}\n\t    }\n\t}\n    }\n    returnVoid;\n}\n\nNCURSES_EXPORT(void)\nwsyncdown(WINDOW *win)\n \n \n{\n    T((T_CALLED(\"wsyncdown(%p)\"), (void *) win));\n\n    if (win != NULL && win->_parent != NULL) {\n\tWINDOW *pp = win->_parent;\n\tint y;\n\n\t \n\twsyncdown(pp);\n\n\t \n\tassert((win->_pary <= pp->_maxy) &&\n\t       ((win->_pary + win->_maxy) <= pp->_maxy));\n\n\tfor (y = 0; y <= win->_maxy; y++) {\n\t    if (pp->_line[win->_pary + y].firstchar >= 0) {\t \n\t\tstruct ldat *line = &(win->_line[y]);\n\t\t \n\t\tint left = pp->_line[win->_pary + y].firstchar - win->_parx;\n\t\tint right = pp->_line[win->_pary + y].lastchar - win->_parx;\n\t\t \n\t\tif (left < 0)\n\t\t    left = 0;\n\t\tif (right > win->_maxx)\n\t\t    right = win->_maxx;\n\t\tCHANGED_RANGE(line, left, right);\n\t    }\n\t}\n    }\n    returnVoid;\n}\n\nNCURSES_EXPORT(void)\nwcursyncup(WINDOW *win)\n \n{\n    WINDOW *wp;\n\n    T((T_CALLED(\"wcursyncup(%p)\"), (void *) win));\n    for (wp = win; wp && wp->_parent; wp = wp->_parent) {\n\twmove(wp->_parent, wp->_pary + wp->_cury, wp->_parx + wp->_curx);\n    }\n    returnVoid;\n}\n\nNCURSES_EXPORT(WINDOW *)\ndupwin(WINDOW *win)\n \n{\n    WINDOW *nwin = 0;\n\n    T((T_CALLED(\"dupwin(%p)\"), (void *) win));\n\n    if (win != 0) {\n#if NCURSES_SP_FUNCS\n\tSCREEN *sp = _nc_screen_of(win);\n#endif\n\t_nc_lock_global(curses);\n\tif (IS_PAD(win)) {\n\t    nwin = NCURSES_SP_NAME(newpad) (NCURSES_SP_ARGx\n\t\t\t\t\t    win->_maxy + 1,\n\t\t\t\t\t    win->_maxx + 1);\n\t} else {\n\t    nwin = NCURSES_SP_NAME(newwin) (NCURSES_SP_ARGx\n\t\t\t\t\t    win->_maxy + 1,\n\t\t\t\t\t    win->_maxx + 1,\n\t\t\t\t\t    win->_begy,\n\t\t\t\t\t    win->_begx);\n\t}\n\n\tif (nwin != 0) {\n\t    int i;\n\t    size_t linesize;\n\n\t    nwin->_curx = win->_curx;\n\t    nwin->_cury = win->_cury;\n\t    nwin->_maxy = win->_maxy;\n\t    nwin->_maxx = win->_maxx;\n\t    nwin->_begy = win->_begy;\n\t    nwin->_begx = win->_begx;\n\t    nwin->_yoffset = win->_yoffset;\n\n\t    nwin->_flags = win->_flags & ~_SUBWIN;\n\t     \n\n\t    WINDOW_ATTRS(nwin) = WINDOW_ATTRS(win);\n\t    nwin->_nc_bkgd = win->_nc_bkgd;\n\n\t    nwin->_notimeout = win->_notimeout;\n\t    nwin->_clear = win->_clear;\n\t    nwin->_leaveok = win->_leaveok;\n\t    nwin->_scroll = win->_scroll;\n\t    nwin->_idlok = win->_idlok;\n\t    nwin->_idcok = win->_idcok;\n\t    nwin->_immed = win->_immed;\n\t    nwin->_sync = win->_sync;\n\t    nwin->_use_keypad = win->_use_keypad;\n\t    nwin->_delay = win->_delay;\n\n\t    nwin->_parx = 0;\n\t    nwin->_pary = 0;\n\t    nwin->_parent = (WINDOW *) 0;\n\t     \n\n\t    nwin->_regtop = win->_regtop;\n\t    nwin->_regbottom = win->_regbottom;\n\n\t    if (IS_PAD(win))\n\t\tnwin->_pad = win->_pad;\n\n\t    linesize = (unsigned) (win->_maxx + 1) * sizeof(NCURSES_CH_T);\n\t    for (i = 0; i <= nwin->_maxy; i++) {\n\t\tmemcpy(nwin->_line[i].text, win->_line[i].text, linesize);\n\t\tnwin->_line[i].firstchar = win->_line[i].firstchar;\n\t\tnwin->_line[i].lastchar = win->_line[i].lastchar;\n\t    }\n\t}\n\t_nc_unlock_global(curses);\n    }\n    returnWin(nwin);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}