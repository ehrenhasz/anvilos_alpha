{
  "module_name": "lib_insch.c",
  "hash_id": "57e5bd6ee338106bbd4b70abdb3e1a76f7c7d0fd13a48d58fa1d4e69cadb1afa",
  "original_prompt": "Ingested from ncurses-6.4/ncurses/base/lib_insch.c",
  "human_readable_source": " \n\n \n\n \n\n#include <curses.priv.h>\n#include <ctype.h>\n\nMODULE_ID(\"$Id: lib_insch.c,v 1.37 2020/02/02 23:34:34 tom Exp $\")\n\n \nNCURSES_EXPORT(int)\n_nc_insert_ch(SCREEN *sp, WINDOW *win, chtype ch)\n{\n    int code = OK;\n    int ch8 = (int) ChCharOf(ch);\n    NCURSES_CH_T wch;\n    int count;\n    int tabsize = (\n#if USE_REENTRANT\n\t\t      sp->_TABSIZE\n#else\n\t\t      TABSIZE\n#endif\n    );\n\n    switch (ch) {\n    case '\\t':\n\tfor (count = (tabsize - (win->_curx % tabsize)); count > 0; count--) {\n\t    if ((code = _nc_insert_ch(sp, win, ' ')) != OK)\n\t\tbreak;\n\t}\n\tbreak;\n    case '\\n':\n    case '\\r':\n    case '\\b':\n\tSetChar2(wch, ch);\n\t_nc_waddch_nosync(win, wch);\n\tbreak;\n    default:\n\tif (\n#if USE_WIDEC_SUPPORT\n\t       WINDOW_EXT(win, addch_used) == 0 &&\n#endif\n\t       (isprint(ch8) ||\n\t\t(ChAttrOf(ch) & A_ALTCHARSET) ||\n\t\t(sp != 0 && sp->_legacy_coding && !iscntrl(ch8)))) {\n\t    if (win->_curx <= win->_maxx) {\n\t\tstruct ldat *line = &(win->_line[win->_cury]);\n\t\tNCURSES_CH_T *end = &(line->text[win->_curx]);\n\t\tNCURSES_CH_T *temp1 = &(line->text[win->_maxx]);\n\t\tNCURSES_CH_T *temp2 = temp1 - 1;\n\n\t\tSetChar2(wch, ch);\n\n\t\tCHANGED_TO_EOL(line, win->_curx, win->_maxx);\n\t\twhile (temp1 > end)\n\t\t    *temp1-- = *temp2--;\n\n\t\t*temp1 = _nc_render(win, wch);\n\t\twin->_curx++;\n\t    }\n\t} else if (iscntrl(ch8)) {\n\t    NCURSES_CONST char *s;\n\t    s = NCURSES_SP_NAME(unctrl) (NCURSES_SP_ARGx (chtype) ch8);\n\t    while (*s != '\\0') {\n\t\tcode = _nc_insert_ch(sp, win, ChAttrOf(ch) | UChar(*s));\n\t\tif (code != OK)\n\t\t    break;\n\t\t++s;\n\t    }\n\t}\n#if USE_WIDEC_SUPPORT\n\telse {\n\t     \n\t    SetChar2(wch, ch);\n\t    wch = _nc_render(win, wch);\n\t    count = _nc_build_wch(win, &wch);\n\t    if (count > 0) {\n\t\tcode = _nc_insert_wch(win, &wch);\n\t    } else if (count == -1) {\n\t\tNCURSES_CONST char *s;\n\t\t \n\t\ts = NCURSES_SP_NAME(unctrl) (NCURSES_SP_ARGx (chtype) ch8);\n\t\tif (strlen(s) > 1) {\n\t\t    while (*s != '\\0') {\n\t\t\tcode = _nc_insert_ch(sp, win,\n\t\t\t\t\t     ChAttrOf(ch) | UChar(*s));\n\t\t\tif (code != OK)\n\t\t\t    break;\n\t\t\t++s;\n\t\t    }\n\t\t} else {\n\t\t    code = ERR;\n\t\t}\n\t    }\n\t}\n#endif\n\tbreak;\n    }\n    return code;\n}\n\nNCURSES_EXPORT(int)\nwinsch(WINDOW *win, chtype c)\n{\n    int code = ERR;\n\n    T((T_CALLED(\"winsch(%p, %s)\"), (void *) win, _tracechtype(c)));\n\n    if (win != 0) {\n\tNCURSES_SIZE_T oy = win->_cury;\n\tNCURSES_SIZE_T ox = win->_curx;\n\n\tcode = _nc_insert_ch(_nc_screen_of(win), win, c);\n\n\twin->_curx = ox;\n\twin->_cury = oy;\n\t_nc_synchook(win);\n    }\n    returnCode(code);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}