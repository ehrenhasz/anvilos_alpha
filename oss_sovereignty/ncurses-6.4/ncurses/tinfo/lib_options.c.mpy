{
  "module_name": "lib_options.c",
  "hash_id": "53b80f21acb768cd1438ddc0ee697ebb9daa5ade4a1e696e154e7a081f64568b",
  "original_prompt": "Ingested from ncurses-6.4/ncurses/tinfo/lib_options.c",
  "human_readable_source": " \n\n \n\n \n\n#include <curses.priv.h>\n\n#ifndef CUR\n#define CUR SP_TERMTYPE\n#endif\n\nMODULE_ID(\"$Id: lib_options.c,v 1.82 2021/02/14 00:17:35 tom Exp $\")\n\nNCURSES_EXPORT(int)\nidlok(WINDOW *win, bool flag)\n{\n    int res = ERR;\n    T((T_CALLED(\"idlok(%p,%d)\"), (void *) win, flag));\n\n    if (win) {\n\tSCREEN *sp = _nc_screen_of(win);\n\tif (sp != 0\n#ifdef USE_TERM_DRIVER\n\t    && IsTermInfo(sp)\n#endif\n\t    ) {\n\t    sp->_nc_sp_idlok =\n\t\twin->_idlok = (flag && (NCURSES_SP_NAME(has_il) (NCURSES_SP_ARG)\n\t\t\t\t\t|| change_scroll_region));\n\t    res = OK;\n\t}\n    }\n    returnCode(res);\n}\n\nNCURSES_EXPORT(void)\nidcok(WINDOW *win, bool flag)\n{\n    T((T_CALLED(\"idcok(%p,%d)\"), (void *) win, flag));\n\n    if (win) {\n\tSCREEN *sp = _nc_screen_of(win);\n\tsp->_nc_sp_idcok = win->_idcok = (flag && NCURSES_SP_NAME(has_ic) (NCURSES_SP_ARG));\n    }\n    returnVoid;\n}\n\nNCURSES_EXPORT(int)\nNCURSES_SP_NAME(halfdelay) (NCURSES_SP_DCLx int t)\n{\n    T((T_CALLED(\"halfdelay(%p,%d)\"), (void *) SP_PARM, t));\n\n    if (t < 1 || t > 255 || !SP_PARM || !IsValidTIScreen(SP_PARM))\n\treturnCode(ERR);\n\n    NCURSES_SP_NAME(cbreak) (NCURSES_SP_ARG);\n    SP_PARM->_cbreak = t + 1;\n    returnCode(OK);\n}\n\n#if NCURSES_SP_FUNCS\nNCURSES_EXPORT(int)\nhalfdelay(int t)\n{\n    return NCURSES_SP_NAME(halfdelay) (CURRENT_SCREEN, t);\n}\n#endif\n\nNCURSES_EXPORT(int)\nnodelay(WINDOW *win, bool flag)\n{\n    T((T_CALLED(\"nodelay(%p,%d)\"), (void *) win, flag));\n\n    if (win) {\n\tif (flag == TRUE)\n\t    win->_delay = 0;\n\telse\n\t    win->_delay = -1;\n\treturnCode(OK);\n    } else\n\treturnCode(ERR);\n}\n\nNCURSES_EXPORT(int)\nnotimeout(WINDOW *win, bool f)\n{\n    T((T_CALLED(\"notimeout(%p,%d)\"), (void *) win, f));\n\n    if (win) {\n\twin->_notimeout = f;\n\treturnCode(OK);\n    } else\n\treturnCode(ERR);\n}\n\nNCURSES_EXPORT(void)\nwtimeout(WINDOW *win, int delay)\n{\n    T((T_CALLED(\"wtimeout(%p,%d)\"), (void *) win, delay));\n\n    if (win) {\n\twin->_delay = delay;\n    }\n    returnVoid;\n}\n\nNCURSES_EXPORT(int)\nkeypad(WINDOW *win, bool flag)\n{\n    T((T_CALLED(\"keypad(%p,%d)\"), (void *) win, flag));\n\n    if (win) {\n\twin->_use_keypad = flag;\n\treturnCode(_nc_keypad(_nc_screen_of(win), flag));\n    } else\n\treturnCode(ERR);\n}\n\nNCURSES_EXPORT(int)\nmeta(WINDOW *win GCC_UNUSED, bool flag)\n{\n    int result = ERR;\n    SCREEN *sp = (win == 0) ? CURRENT_SCREEN : _nc_screen_of(win);\n\n     \n    T((T_CALLED(\"meta(%p,%d)\"), (void *) win, flag));\n\n     \n\n    if (sp != 0) {\n\tsp->_use_meta = flag;\n#ifdef USE_TERM_DRIVER\n\tif (IsTermInfo(sp)) {\n\t    if (flag) {\n\t\tNCURSES_PUTP2(\"meta_on\", meta_on);\n\t    } else {\n\t\tNCURSES_PUTP2(\"meta_off\", meta_off);\n\t    }\n\t}\n#else\n\tif (flag) {\n\t    NCURSES_PUTP2(\"meta_on\", meta_on);\n\t} else {\n\t    NCURSES_PUTP2(\"meta_off\", meta_off);\n\t}\n#endif\n\tresult = OK;\n    }\n    returnCode(result);\n}\n\n \n\nNCURSES_EXPORT(int)\nNCURSES_SP_NAME(curs_set) (NCURSES_SP_DCLx int vis)\n{\n    int code = ERR;\n    T((T_CALLED(\"curs_set(%p,%d)\"), (void *) SP_PARM, vis));\n\n    if (SP_PARM != 0 && vis >= 0 && vis <= 2) {\n\tint cursor = SP_PARM->_cursor;\n\tif (vis == cursor) {\n\t    code = cursor;\n\t} else {\n#ifdef USE_TERM_DRIVER\n\t    code = CallDriver_1(SP_PARM, td_cursorSet, vis);\n#else\n\t    if (IsValidTIScreen(SP_PARM)) {\n\t\tswitch (vis) {\n\t\tcase 2:\n\t\t    code = NCURSES_PUTP2_FLUSH(\"cursor_visible\",\n\t\t\t\t\t       cursor_visible);\n\t\t    break;\n\t\tcase 1:\n\t\t    code = NCURSES_PUTP2_FLUSH(\"cursor_normal\",\n\t\t\t\t\t       cursor_normal);\n\t\t    break;\n\t\tcase 0:\n\t\t    code = NCURSES_PUTP2_FLUSH(\"cursor_invisible\",\n\t\t\t\t\t       cursor_invisible);\n\t\t    break;\n\t\t}\n\t    } else {\n\t\tcode = ERR;\n\t    }\n#endif\n\t    if (code != ERR)\n\t\tcode = (cursor == -1 ? 1 : cursor);\n\t    SP_PARM->_cursor = vis;\n\t}\n    }\n    returnCode(code);\n}\n\n#if NCURSES_SP_FUNCS\nNCURSES_EXPORT(int)\ncurs_set(int vis)\n{\n    return (NCURSES_SP_NAME(curs_set) (CURRENT_SCREEN, vis));\n}\n#endif\n\nNCURSES_EXPORT(int)\nNCURSES_SP_NAME(typeahead) (NCURSES_SP_DCLx int fd)\n{\n    T((T_CALLED(\"typeahead(%p, %d)\"), (void *) SP_PARM, fd));\n    if (SP_PARM && IsValidTIScreen(SP_PARM)) {\n\tSP_PARM->_checkfd = fd;\n\treturnCode(OK);\n    } else {\n\treturnCode(ERR);\n    }\n}\n\n#if NCURSES_SP_FUNCS\nNCURSES_EXPORT(int)\ntypeahead(int fd)\n{\n    return NCURSES_SP_NAME(typeahead) (CURRENT_SCREEN, fd);\n}\n#endif\n\n \n\n#if NCURSES_EXT_FUNCS\nstatic int\nhas_key_internal(int keycode, TRIES * tp)\n{\n    if (tp == 0)\n\treturn (FALSE);\n    else if (tp->value == keycode)\n\treturn (TRUE);\n    else\n\treturn (has_key_internal(keycode, tp->child)\n\t\t|| has_key_internal(keycode, tp->sibling));\n}\n\n#ifdef USE_TERM_DRIVER\nNCURSES_EXPORT(int)\nTINFO_HAS_KEY(SCREEN *sp, int keycode)\n{\n    return IsValidTIScreen(sp) ?\n\thas_key_internal(keycode, sp->_keytry) : 0;\n}\n#else\nNCURSES_EXPORT(int)\nNCURSES_SP_NAME(has_key) (NCURSES_SP_DCLx int keycode)\n{\n    T((T_CALLED(\"has_key(%p,%d)\"), (void *) SP_PARM, keycode));\n    returnCode(SP != 0 ? has_key_internal(keycode, SP_PARM->_keytry) : FALSE);\n}\n\n#if NCURSES_SP_FUNCS\nNCURSES_EXPORT(int)\nhas_key(int keycode)\n{\n    return NCURSES_SP_NAME(has_key) (CURRENT_SCREEN, keycode);\n}\n#endif\n#endif\n#endif  \n\nNCURSES_EXPORT(int)\nNCURSES_SP_NAME(_nc_putp_flush) (NCURSES_SP_DCLx\n\t\t\t\t const char *name, const char *value)\n{\n    int rc = NCURSES_PUTP2(name, value);\n    if (rc != ERR) {\n\t_nc_flush();\n    }\n    return rc;\n}\n\n#if 0 && NCURSES_SP_FUNCS\nNCURSES_EXPORT(int)\n_nc_putp_flush(const char *name, const char *value)\n{\n    return NCURSES_SP_NAME(_nc_putp_flush) (CURRENT_SCREEN, name, value);\n}\n#endif\n\n \nNCURSES_EXPORT(int)\n_nc_keypad(SCREEN *sp, int flag)\n{\n    int rc = ERR;\n\n    if (sp != 0) {\n#ifdef USE_PTHREADS\n\t \n\tif (_nc_use_pthreads && sp != CURRENT_SCREEN) {\n\t    SCREEN *save_sp;\n\n\t     \n\t    _nc_lock_global(curses);\n\t    save_sp = CURRENT_SCREEN;\n\t    _nc_set_screen(sp);\n\t    rc = _nc_keypad(sp, flag);\n\t    _nc_set_screen(save_sp);\n\t    _nc_unlock_global(curses);\n\t} else\n#endif\n\t{\n#ifdef USE_TERM_DRIVER\n\t    rc = CallDriver_1(sp, td_kpad, flag);\n\t    if (rc == OK)\n\t\tsp->_keypad_on = flag;\n#else\n\t    if (flag) {\n\t\t(void) NCURSES_PUTP2_FLUSH(\"keypad_xmit\", keypad_xmit);\n\t    } else if (keypad_local) {\n\t\t(void) NCURSES_PUTP2_FLUSH(\"keypad_local\", keypad_local);\n\t    }\n\n\t    if (flag && !sp->_tried) {\n\t\t_nc_init_keytry(sp);\n\t\tsp->_tried = TRUE;\n\t    }\n\t    sp->_keypad_on = flag;\n\t    rc = OK;\n#endif\n\t}\n    }\n    return (rc);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}