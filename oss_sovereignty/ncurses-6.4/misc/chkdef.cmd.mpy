{
  "module_name": "chkdef.cmd",
  "hash_id": "8dab9eb7303fa73bae5638fda97cabb52774eb82a839a81f750354be71f84db1",
  "original_prompt": "Ingested from ncurses-6.4/misc/chkdef.cmd",
  "human_readable_source": "/****************************************************************************\n * Copyright 2020 Thomas E. Dickey                                          *\n * Copyright 1998,2006 Free Software Foundation, Inc.                       *\n *                                                                          *\n * Permission is hereby granted, free of charge, to any person obtaining a  *\n * copy of this software and associated documentation files (the            *\n * \"Software\"), to deal in the Software without restriction, including      *\n * without limitation the rights to use, copy, modify, merge, publish,      *\n * distribute, distribute with modifications, sublicense, and/or sell       *\n * copies of the Software, and to permit persons to whom the Software is    *\n * furnished to do so, subject to the following conditions:                 *\n *                                                                          *\n * The above copyright notice and this permission notice shall be included  *\n * in all copies or substantial portions of the Software.                   *\n *                                                                          *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  *\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               *\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   *\n * IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   *\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    *\n * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    *\n * THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               *\n *                                                                          *\n * Except as contained in this notice, the name(s) of the above copyright   *\n * holders shall not be used in advertising or otherwise to promote the     *\n * sale, use or other dealings in this Software without prior written       *\n * authorization.                                                           *\n ****************************************************************************/\n\n/*\n * $Id: chkdef.cmd,v 1.4 2020/02/02 23:34:34 tom Exp $\n *\n * Author:  Juan Jose Garcia Ripoll <worm@arrakis.es>.\n * Webpage: http://www.arrakis.es/~worm/\n *\n * chkdef.cmd - checks that a .def file has no conflicts and is properly\n *\t\tformatted.\n *\n * returns nonzero if two symbols have the same code or a line has a wrong\n * format.\n *\n * returns 0 otherwise\n *\n * the standard output shows conflicts.\n */\nparse arg def_file\n\ndef_file = translate(def_file,'\\','/')\n\ncall CleanQueue\n\n/*\n * `cmp' is zero when the file is valid\n * `codes' associates a name to a code\n * `names' associates a code to a name\n */\ncmp    = 0\ncodes. = 0\nnames. = ''\n\n/*\n * This sed expression cleans empty lines, comments and special .DEF\n * commands, such as LIBRARY..., EXPORTS..., etc\n */\ntidy_up  = '\"s/[ \t][ \t]*/ /g;s/;.*//g;/^[ ]*$/d;/^[a-zA-Z]/d;\"'\n\n/*\n * First we find all public symbols from the original DLL. All this\n * information is pushed into a REXX private list with the RXQUEUE\n * utility program.\n */\n'@echo off'\n'type' def_file '| sed' tidy_up '| sort | rxqueue'\n\ndo while queued() > 0\n   /*\n    * We retrieve the symbol name (NEW_NAME) and its code (NEW_CODE)\n    */\n   parse pull '\"' new_name '\"' '@'new_code rest\n   select\n      when (new_code = '') | (new_name = '') then\n         /* The input was not properly formatted */\n         do\n         say 'Error: symbol \"'new_name'\" has no export code or is empty'\n         cmp = 1\n         end\n      when codes.new_name \\= 0 then\n         /* This symbol was already defined */\n         if codes.new_name \\= new_code then\n            do\n\t    cmp = 2\n \t    say 'Symbol \"'new_name'\" multiply defined'\n\t    end\n      when names.new_code \\= '' then\n         /* This code was already assigned to a symbol */\n         if names.new_code \\= new_name then\n            do\n            cmp = 3\n\t    say 'Conflict with \"'names.new_code'\" & \"'new_name'\" being @'new_code\n            end\n      otherwise\n         do\n         codes.new_name = new_code\n         names.new_code = new_name\n         end\n   end  /* select */\nend\n\nexit cmp\n\nCleanQueue: procedure\n\tdo while queued() > 0\n\t   parse pull foo\n\tend\nreturn\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}