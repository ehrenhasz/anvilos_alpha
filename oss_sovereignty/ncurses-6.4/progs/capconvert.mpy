{
  "module_name": "capconvert",
  "hash_id": "ad89b8147aa88ce7f9003a124c31fa43bb8f53bb9e6003d7aa2e877429535760",
  "original_prompt": "Ingested from ncurses-6.4/progs/capconvert",
  "human_readable_source": "#!/bin/sh\n##############################################################################\n# Copyright 2019-2021,2022 Thomas E. Dickey                                  #\n# Copyright 1998-2011,2017 Free Software Foundation, Inc.                    #\n#                                                                            #\n# Permission is hereby granted, free of charge, to any person obtaining a    #\n# copy of this software and associated documentation files (the \"Software\"), #\n# to deal in the Software without restriction, including without limitation  #\n# the rights to use, copy, modify, merge, publish, distribute, distribute    #\n# with modifications, sublicense, and/or sell copies of the Software, and to #\n# permit persons to whom the Software is furnished to do so, subject to the  #\n# following conditions:                                                      #\n#                                                                            #\n# The above copyright notice and this permission notice shall be included in #\n# all copies or substantial portions of the Software.                        #\n#                                                                            #\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR #\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   #\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    #\n# THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER      #\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING    #\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER        #\n# DEALINGS IN THE SOFTWARE.                                                  #\n#                                                                            #\n# Except as contained in this notice, the name(s) of the above copyright     #\n# holders shall not be used in advertising or otherwise to promote the sale, #\n# use or other dealings in this Software without prior written               #\n# authorization.                                                             #\n##############################################################################\n# $Id: capconvert,v 1.12 2022/07/16 21:00:27 tom Exp $\n#\n# capconvert -- automated conversion from termcap to terminfo\n#\n\necho \"This script tries to automatically set you up so that your applications\"\necho \"that now use termcap can use terminfo and the ncurses library.\"\necho \"\"\n\n# Note, except for telling if we're running under xterm we don't use TERM at\n# all.  This is because BSD users not infrequently have multiple termtypes\n# selected by conditionals in tset -- unless they're xterm users, in which\n# case they're on a workstation and probably don't.\n\n# Check to make sure TERMINFO is not already defined\nif test -n \"$TERMINFO\"\nthen\n\techo \"TERMINFO is already defined in your environment.  This means\"\n\techo \"you already have a local terminfo tree, so you do not need any\"\n\techo \"conversion.\"\n\tif test ! -d \"$TERMINFO\" ; then\n\t\techo \"Caution: TERMINFO does not point to a directory!\"\n\tfi\n\texit;\nfi\n\n# Check to see if terminfo is present in one of the standard locations.\nterminfo=no\nfor p in $TERMINFO \\\n\t/usr/lib/terminfo \\\n\t/usr/share/lib/terminfo \\\n\t/usr/share/terminfo \\\n\t/usr/local/lib/terminfo \\\n\t/usr/local/share/terminfo\ndo\n\tif test -d \"$p\" ; then\n\t\tterminfo=yes\n\t\tbreak\n\tfi\ndone\n\nif test $terminfo = yes\nthen\n\techo \"Your system already has a system-wide terminfo tree.\"\n\techo \"\"\n\tif test -z \"$TERMCAP\"\n\tthen\n\t\techo \"You have no TERMCAP variable set, so we are done.\"\n\t\t# Assumes the terminfo master covers all canned terminal types\n\t\texit;\n\tfi\n\tcase $TERM in\n\txterm | xterm-*)\n\t\techo \"You are running xterm, which usually sets TERMCAP itself.\"\n\t\techo \"We can ignore this, because terminfo knows about xterm.\"\n\t\techo \"So you will just use the system-wide terminfo tree.\"\n\t\texit\n\t\t;;\n\t*)\n\t\techo \"We will have to make a local one for you anyway, to capture the effect\"\n\t\techo \"of your TERMCAP variable.\"\n\t\t;;\n\tesac\nelse\n\techo \"No system-wide terminfo tree.  We will make you a local one.\"\nfi\necho \"\";\n\n# Check if test -x works (it is not portable, but useful)\nOPT=\"-x\"\nTMP=test$$; touch $TMP && chmod 755 $TMP\nif test $OPT $TMP ; then\n\tchmod 644 $TMP\n\ttest $OPT $TMP && OPT=\"-f\"\nelse\n\tOPT=\"-f\"\nfi\nrm -f $TMP\n\n# First step -- go find tic\nTIC=\nIFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS=\"${IFS}:\"\nfor x in $PATH .\ndo\n\tif test \"$OPT\" \"$x\"/tic\n\tthen\n\t\tTIC=$x/tic\n\t\tbreak\n\tfi\ndone\nIFS=\"$save_ifs\"\n\nif test -n \"$TIC\"\nthen\n\techo \"I see tic at $TIC.\"\n\tcase $TIC in # (vi\n\t./tic)\n\t\tif test $OPT ../misc/shlib ; then\n\t\t\tTIC=\"../misc/shlib $TIC\"\n\t\tfi\n\t\t;;\n\tesac\nelse\n\techo \"You do not have tic installed anywhere I can see, please fix that.\"\n\texit;\nfi\necho \"\";\n\n# We have tic.  Either there's no system terminfo tree or there is one but\n# the user has a TERMCAP variable that may modify a stock description.\n#\n\n# Make the user a terminfo directory\nif test -d \"$HOME\"/.terminfo\nthen\n\techo \"It appears you already have a private terminfo directory\"\n\techo \"at $HOME/.terminfo; this seems odd, because TERMINFO\"\n\techo \"is not defined.  I am not going to second-guess this -- if you\"\n\techo \"really want me to try auto-configuring for you, remove or\"\n\techo \"rename $HOME/terminfo and run me again.\"\n\texit;\nelse\n\techo \"I am creating your private terminfo directory at $HOME/.terminfo\"\n\tmkdir \"$HOME\"/.terminfo\n\t# Ensure that that's where tic's compilation results.\n\t# This isn't strictly necessary with a 1.9.7 or later tic.\n\tTERMINFO=\"$HOME/.terminfo\"; export TERMINFO\nfi\necho \"\";\n\n# Find a terminfo source to work from\nif test -f ../misc/terminfo.src\nthen\n\techo \"I see the terminfo master source is handy; I will use that.\"\n\tmaster=../misc/terminfo.src\nelse\n\t# Ooops...looks like we're running from somewhere other than the\n\t# progs directory of an ncurses source tree.\n\tmaster=`find \"$HOME\" -name \"*terminfo.src\" -print`\n\tmcount=`find \"$HOME\" -name \"*terminfo.src\" | wc -l`\n\tcase $mcount in\n\t0)\n\t\techo \"I can not find a terminfo source file anywhere under your home directory.\"\n\t\techo \"There should be a file called terminfo.src somewhere in your\"\n\t\techo \"ncurses distribution; please put it in your home directotry\"\n\t\techo \"and run me again (it does not have to live there permanently).\"\n\t\texit;\n\t;;\n\t1)\n\t\techo \"I see a file called $master.\"\n\t\techo \"I am going to assume this is the terminfo source included with\"\n\t\techo \"the ncurses distribution.  If this assumption is wrong, please\"\n\t\techo \"interrupt me now!  OK to continue?\"\n\t\tread answer;\n\t;;\n\t2)\n\t\techo \"I see more than one possible terminfo source.  Here they are:\"\n\t\techo \"$master\" | sed \"/^/s//\t/\";\n\t\twhile :\n\t\tdo\n\t\t\techo \"Please tell me which one to use:\"\n\t\t\tread master;\n\t\t\tif test -f \"$master\"\n\t\t\tthen\n\t\t\t\tbreak\n\t\t\telse\n\t\t\t\techo \"That file does not exist. Try again?\";\n\t\t\tfi\n\t\tdone\n\t;;\n\tesac\nfi\necho \"\";\n\n# Now that we have a master, compile it into the local tree\necho \"OK, now I will make your private terminfo tree.  This may take a bit...\"\n#\n# Kluge alert: we compile terminfo.src in two pieces because a lot of machines\n# with < 16MB RAM choke on tic's core-hog habits.\ntrap 'rm -f tsplit$$.*; exit 1' 1 2 3 15\ntrap 'rm -f tsplit$$.*' 0\nsed -n \"$master\" \\\n\t-e '1,/SPLIT HERE/w 'tsplit$$.01 \\\n\t-e '/SPLIT HERE/,$w 'tsplit$$.02 \\\n\t2>/dev/null\nfor x in tsplit$$.*; do eval $TIC \"$x\"; done\nrm tsplit$$.*\ntrap EXIT INT QUIT TERM HUP\n#\necho \"You now have a private tree under $HOME/.terminfo;\"\necho \"the ncurses library will automatically read from it,\"\necho \"and ncurses tic will automatically compile entries to it.\"\n\n# We're done unless user has a .termcap file or equivalent named by TERMCAP\nif test -z \"$TERMCAP\"\nthen\n\techo \"You have no TERMCAP set, so we are done.\"\nfi\n\n# OK, here comes the nasty case...user has a TERMCAP.  Instead of\n# trying to follow all the convolutions of the relationship between\n# TERM and TERMCAP (partly because it is too painful, and partly because\n# we don't actually know what TERM will be nor even if it always has\n# the same value for this user) we do the following three steps...\n\nif test -f \"$HOME\"/.termcap\nthen\n\techo \"I see you have a \\$HOME/.termcap file.  I will compile that.\"\n\teval $TIC \"$HOME\"/.termcap\n\techo \"Done.\"\n\techo \"Note that editing $HOME/.termcap will no longer change the data curses sees.\"\nelif test -f \"$TERMCAP\"\nthen\n\techo \"Your TERMCAP names the file $TERMCAP.  I will compile that.\"\n\teval $TIC \"$TERMCAP\"\n\techo \"Done.\"\n\techo \"Note that editing $TERMCAP will no longer change the data curses sees.\"\nelse\n\techo \"Your TERMCAP value appears to be an entry in termcap format.\"\n\techo \"I will compile it.\"\n\techo \"$TERMCAP\" >myterm$$\n\teval $TIC myterm$$\n\trm myterm$$\n\techo \"Done.\"\n\techo \"Note that editing TERMCAP will no longer change the data curses sees.\"\nfi\necho \"To do that, decompile the terminal description you want with infocmp(1),\"\necho \"edit to taste, and recompile using tic(1).\"\n\n# capconvert ends here\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}