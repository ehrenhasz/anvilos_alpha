{
  "module_name": "demo.cc",
  "hash_id": "377d8cbed62e4c495740beceb36b284b0b6d9fdc81a1e2dabcfa27cc81bb6896",
  "original_prompt": "Ingested from ncurses-6.4/c++/demo.cc",
  "human_readable_source": "\n \n\n \n\n#include \"internal.h\"\n#include \"cursesapp.h\"\n#include \"cursesm.h\"\n#include \"cursesf.h\"\n\n#if (defined(_WIN32) || defined(_WIN64))\n#undef KEY_EVENT\n#define sleep(n) Sleep(n)\n#else\nextern \"C\" unsigned int sleep(unsigned int);\n#endif\n\n#undef index \n\n\n\n\nclass SillyDemo\n{\n  public:\n  void run(int sleeptime) {\n\n    NCursesPanel *mystd = new NCursesPanel();\n\n    \n\n    NCursesPanel *u = new NCursesPanel(8, 20, 12, 4);\n    NCursesPanel *v = new NCursesPanel(8, 20, 10, 6);\n    NCursesPanel *w = new NCursesPanel(8, 20, 8, 8);\n    NCursesPanel *x = new NCursesPanel(8, 20, 6, 10);\n    NCursesPanel *y = new NCursesPanel(8, 20, 4, 12);\n    NCursesPanel *z = new NCursesPanel(8, 30, 2, 14);\n\n    \n    \n\n    mystd->box();\n    mystd->move(mystd->height()/2, 1);\n    mystd->hline(mystd->width()-2);\n    mystd->move(1, mystd->width()/2);\n    mystd->vline(mystd->height()-2);\n    mystd->addch(0, mystd->width()/2, ACS_TTEE);\n    mystd->addch(mystd->height()-1, mystd->width()/2, ACS_BTEE);\n    mystd->addch(mystd->height()/2, 0, ACS_LTEE);\n    mystd->addch(mystd->height()/2, mystd->width()-1, ACS_RTEE);\n    mystd->addch(mystd->height()/2, mystd->width()/2, ACS_PLUS);\n\n    \n    \n    u->boldframe(\"Win U\");\n    v->frame(\"Win V\");\n    w->boldframe(\"Win W\");\n    x->frame(\"Win X\");\n    y->boldframe(\"Win Y\");\n    z->frame(\"Win Z\");\n    if (NCursesApplication::getApplication()->useColors()) {\n      u->bkgd(' '|COLOR_PAIR(1));\n      w->bkgd(' '|COLOR_PAIR(1));\n      y->bkgd(' '|COLOR_PAIR(1));\n      v->bkgd(' '|COLOR_PAIR(2));\n      x->bkgd(' '|COLOR_PAIR(2));\n      z->bkgd(' '|COLOR_PAIR(2));\n    }\n\n    \n    \n    \n\n    mystd->refresh();\n    sleep(sleeptime);\n\n    \n\n    sleep(sleeptime);\n    delete u;\n    mystd->refresh();\n\n    sleep(sleeptime);\n    delete z;\n    mystd->refresh();\n\n    sleep(sleeptime);\n    delete v;\n    mystd->refresh();\n\n    \n    sleep(sleeptime);\n    y->mvwin(5, 30);\n    mystd->refresh();\n\n    sleep(sleeptime);\n    delete y;\n    mystd->refresh();\n\n    \n    sleep(sleeptime);\n    w->top();\n    mystd->refresh();\n\n    sleep(sleeptime);\n    delete w;\n    mystd->refresh();\n\n    sleep(sleeptime);\n    delete x;\n\n    mystd->clear();\n    mystd->refresh();\n\n    \n    \n    \n\n    sleep(sleeptime);\n    delete mystd;\n  }\n};\n\nclass UserData\n{\nprivate:\n  int u;\npublic:\n  UserData(int x) : u(x) {}\n  int sleeptime() const { return u; }\n};\n\n\n\ntemplate<class T> class MyAction : public NCursesUserItem<T>\n{\npublic:\n  MyAction (const char* p_name,\n            const T* p_UserData)\n    : NCursesUserItem<T>(p_name, static_cast<const char*>(0), p_UserData)\n  {}\n\n  virtual ~MyAction() THROWS(NCursesException) {}\n\n  bool action() {\n    SillyDemo a;\n    a.run(NCursesUserItem<T>::UserData()->sleeptime());\n    return FALSE;\n  }\n};\n\ntemplate class MyAction<UserData>;\ntemplate class NCURSES_CXX_IMPEXP NCursesUserItem<UserData>;\n\nclass QuitItem : public NCursesMenuItem\n{\npublic:\n  QuitItem() : NCursesMenuItem(\"Quit\") {\n  }\n\n  bool action() {\n    return TRUE;\n  }\n};\n\n\n\nclass Label : public NCursesFormField\n{\npublic:\n  Label(const char* title,\n        int row, int col)\n    : NCursesFormField(1, static_cast<int>(::strlen(title)), row, col) {\n      set_value(title);\n      options_off(O_EDIT|O_ACTIVE);\n  }\n};\n\n\n\nclass MyFieldType : public UserDefinedFieldType\n{\nprivate:\n  int chk;\nprotected:\n  bool field_check(NCursesFormField& f) {\n    (void) f;\n    return TRUE;\n  }\n  bool char_check(int c) {\n    return (c==chk?TRUE:FALSE);\n  }\npublic:\n  MyFieldType(int x) : chk(x) {\n  }\n};\n\n\n\nclass TestForm : public NCursesForm\n{\nprivate:\n  NCursesFormField** F;\n  MyFieldType* mft;\n  Integer_Field *ift;\n  Enumeration_Field *eft;\n\n  static const char *weekdays[];\n\npublic:\n  TestForm()\n    : NCursesForm(13, 51, (lines() - 15)/2, (cols() - 53)/2),\n      F(0),\n      mft(0),\n      ift(0),\n      eft(0)\n  {\n\n    F     = new NCursesFormField*[10];\n    mft   = new MyFieldType('X');\n    ift   = new Integer_Field(0, 1, 10);\n    eft   = new Enumeration_Field(weekdays);\n\n    F[0]  = new Label(\"Demo Entry Form\", 0, 16);\n    F[1]  = new Label(\"Weekday Enum\", 2, 1);\n    F[2]  = new Label(\"Number(1-10)\", 2, 21);\n    F[3]  = new Label(\"Only 'X'\", 2, 35);\n    F[4]  = new Label(\"Multiline Field (Dynamic and Scrollable)\", 5, 1);\n    F[5]  = new NCursesFormField(1, 18, 3, 1);\n    F[6]  = new NCursesFormField(1, 12, 3, 21);\n    F[7]  = new NCursesFormField(1, 12, 3, 35);\n    F[8]  = new NCursesFormField(4, 46, 6, 1, 2);\n    F[9]  = new NCursesFormField();\n\n    InitForm(F, TRUE, TRUE);\n    boldframe();\n\n    F[5]->set_fieldtype(*eft);\n    F[6]->set_fieldtype(*ift);\n\n    F[7]->set_fieldtype(*mft);\n    F[7]->set_maximum_growth(20); \n    F[7]->options_off(O_STATIC);  \n\n    F[8]->set_maximum_growth(10); \n    F[8]->options_off(O_STATIC);  \n  }\n\n  TestForm& operator=(const TestForm& rhs)\n  {\n    if (this != &rhs) {\n      *this = rhs;\n    }\n    return *this;\n  }\n\n  TestForm(const TestForm& rhs)\n    : NCursesForm(rhs), F(0), mft(0), ift(0), eft(0)\n  {\n  }\n\n  ~TestForm() THROWS(NCursesException) {\n    delete mft;\n    delete ift;\n    delete eft;\n  }\n};\n\nconst char* TestForm::weekdays[] = {\n    \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\",\n    \"Friday\", \"Saturday\", NULL };\n\n\n\nclass FormAction : public NCursesMenuItem\n{\npublic:\n  FormAction(const char *s) : NCursesMenuItem(s) {\n  }\n\n  bool action() {\n    TestForm F;\n    Soft_Label_Key_Set* S = new Soft_Label_Key_Set;\n    for(int i=1; i <= S->labels(); i++) {\n      char buf[8];\n      assert(i < 100);\n      ::_nc_SPRINTF(buf, _nc_SLIMIT(sizeof(buf)) \"Frm%02d\", i % 100);\n      (*S)[i] = buf;                                      \n      (*S)[i] = Soft_Label_Key_Set::Soft_Label_Key::Left; \n    }\n    NCursesApplication::getApplication()->push(*S);\n    F();\n    NCursesApplication::getApplication()->pop();\n    delete S;\n    return FALSE;\n  }\n};\n\n\n\nclass PadAction : public NCursesMenuItem\n{\npublic:\n  PadAction(const char* s) : NCursesMenuItem(s) {\n  }\n\n  bool action() {\n    const int GRIDSIZE = 3;\n    const int PADSIZE  = 200;\n    unsigned gridcount = 0;\n\n    NCursesPanel mystd;\n    NCursesPanel P(mystd.lines()-2, mystd.cols()-2, 1, 1);\n    NCursesFramedPad FP(P, PADSIZE, PADSIZE);\n\n    for (int i=0; i < PADSIZE; i++) {\n      for (int j=0; j < PADSIZE; j++) {\n        if (i % GRIDSIZE == 0 && j % GRIDSIZE == 0) {\n          if (i==0 || j==0)\n            FP.addch('+');\n          else\n            FP.addch(static_cast<chtype>('A' + (gridcount++ % 26)));\n        }\n        else if (i % GRIDSIZE == 0)\n          FP.addch('-');\n        else if (j % GRIDSIZE == 0)\n          FP.addch('|');\n        else\n          FP.addch(' ');\n      }\n    }\n\n    P.label(\"Pad Demo\", NULL);\n    FP();\n    P.clear();\n    return FALSE;\n  }\n};\n\n\n\n\nclass PassiveItem : public NCursesMenuItem\n{\npublic:\n  PassiveItem(const char* text) : NCursesMenuItem(text) {\n    options_off(O_SELECTABLE);\n  }\n};\n\n\n\n\nclass ScanAction : public NCursesMenuItem\n{\npublic:\n  ScanAction(const char* s) : NCursesMenuItem(s) {\n  }\n\n  bool action() {\n    NCursesPanel *mystd = new NCursesPanel();\n\n    NCursesPanel *w = new NCursesPanel(mystd->lines() - 2, mystd->cols() - 2, 1, 1);\n    w->box();\n    w->refresh();\n\n    NCursesPanel *s = new NCursesPanel(w->lines() - 6, w->cols() - 6, 3, 3);\n    s->scrollok(TRUE);\n    ::echo();\n\n    s->printw(\"Enter decimal integers.  The running total will be shown\\n\");\n    int nvalue = -1;\n    int result = 0;\n    while (nvalue != 0) {\n      nvalue = 0;\n      s->scanw(\"%d\", &nvalue);\n      if (nvalue != 0) {\n        s->printw(\"%d: \", result += nvalue);\n      }\n      s->refresh();\n    }\n    s->printw(\"\\nPress any key to continue...\");\n    s->getch();\n\n    delete s;\n    delete w;\n    delete mystd;\n    ::noecho();\n    return FALSE;\n  }\n};\n\n\n\n\nclass MyMenu : public NCursesMenu\n{\nprivate:\n  NCursesPanel* P;\n  NCursesMenuItem** I;\n  UserData *u;\n  #define n_items 7\n\npublic:\n  MyMenu ()\n    : NCursesMenu (n_items+2, 8, (lines()-10)/2, (cols()-10)/2),\n      P(0), I(0), u(0)\n  {\n    u = new UserData(1);\n    I = new NCursesMenuItem*[1+n_items];\n    I[0] = new PassiveItem(\"One\");\n    I[1] = new PassiveItem(\"Two\");\n    I[2] = new MyAction<UserData> (\"Silly\", u);\n    I[3] = new FormAction(\"Form\");\n    I[4] = new PadAction(\"Pad\");\n    I[5] = new ScanAction(\"Scan\");\n    I[6] = new QuitItem();\n    I[7] = new NCursesMenuItem(); \n\n    InitMenu(I, TRUE, TRUE);\n\n    P = new NCursesPanel(1, n_items, LINES-1, 1);\n    boldframe(\"Demo\", \"Silly\");\n    P->show();\n  }\n\n  MyMenu& operator=(const MyMenu& rhs)\n  {\n    if (this != &rhs) {\n      *this = rhs;\n    }\n    return *this;\n  }\n\n  MyMenu(const MyMenu& rhs)\n    : NCursesMenu(rhs), P(0), I(0), u(0)\n  {\n  }\n\n  ~MyMenu() THROWS(NCursesException)\n  {\n    P->hide();\n    delete P;\n    delete u;\n  }\n\n  virtual void On_Menu_Init()\n  {\n    NCursesWindow W(::stdscr);\n    P->move(0, 0);\n    P->clrtoeol();\n    for(int i=1; i<=count(); i++)\n      P->addch('0' + i);\n    P->bkgd(W.getbkgd());\n    refresh();\n  }\n\n  virtual void On_Menu_Termination()\n  {\n    P->move(0, 0);\n    P->clrtoeol();\n    refresh();\n  }\n\n  virtual void On_Item_Init(NCursesMenuItem& item)\n  {\n    P->move(0, item.index());\n    P->attron(A_REVERSE);\n    P->printw(\"%1d\", 1+item.index());\n    P->attroff(A_REVERSE);\n    refresh();\n  }\n\n  virtual void On_Item_Termination(NCursesMenuItem& item)\n  {\n    P->move(0, item.index());\n    P->attroff(A_REVERSE);\n    P->printw(\"%1d\", 1+item.index());\n    refresh();\n  }\n};\n\n\n\nclass TestApplication : public NCursesApplication\n{\nprotected:\n  int titlesize() const { return 1; }\n  void title();\n  Soft_Label_Key_Set::Label_Layout useSLKs() const {\n    return Soft_Label_Key_Set::PC_Style_With_Index;\n  }\n  void init_labels(Soft_Label_Key_Set& S) const;\n\npublic:\n  TestApplication() : NCursesApplication(TRUE) {\n  }\n\n  int run();\n};\n\nvoid TestApplication::init_labels(Soft_Label_Key_Set& S) const\n{\n  for(int i=1; i <= S.labels(); i++) {\n    char buf[8];\n    assert(i < 100);\n    ::_nc_SPRINTF(buf, _nc_SLIMIT(sizeof(buf)) \"Key%02d\", i % 100);\n    S[i] = buf;                                      \n    S[i] = Soft_Label_Key_Set::Soft_Label_Key::Left; \n  }\n}\n\nvoid TestApplication::title()\n{\n  const char * const titleText = \"Simple C++ Binding Demo\";\n  const int len = ::strlen(titleText);\n\n  getTitleWindow()->bkgd(screen_titles());\n  getTitleWindow()->addstr(0, (getTitleWindow()->cols() - len)/2, titleText);\n  getTitleWindow()->noutrefresh();\n}\n\n\nint TestApplication::run()\n{\n  MyMenu M;\n  M();\n  return 0;\n}\n\n\n\n\nstatic TestApplication *Demo = new TestApplication();\n\n#if (defined(_WIN32) || defined(_WIN64))\n\nNCURSES_CXX_MAIN\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}