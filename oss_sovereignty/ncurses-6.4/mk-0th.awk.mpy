{
  "module_name": "mk-0th.awk",
  "hash_id": "e5aff3afbd5145b095bc7728e4a48b96a751cc22da0b5f63d0ae7e618398165f",
  "original_prompt": "Ingested from ncurses-6.4/mk-0th.awk",
  "human_readable_source": "# $Id: mk-0th.awk,v 1.24 2021/03/20 11:44:48 tom Exp $\n##############################################################################\n# Copyright 2020,2021 Thomas E. Dickey                                       #\n# Copyright 1998-2010,2012 Free Software Foundation, Inc.                    #\n#                                                                            #\n# Permission is hereby granted, free of charge, to any person obtaining a    #\n# copy of this software and associated documentation files (the \"Software\"), #\n# to deal in the Software without restriction, including without limitation  #\n# the rights to use, copy, modify, merge, publish, distribute, distribute    #\n# with modifications, sublicense, and/or sell copies of the Software, and to #\n# permit persons to whom the Software is furnished to do so, subject to the  #\n# following conditions:                                                      #\n#                                                                            #\n# The above copyright notice and this permission notice shall be included in #\n# all copies or substantial portions of the Software.                        #\n#                                                                            #\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR #\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   #\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    #\n# THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER      #\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING    #\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER        #\n# DEALINGS IN THE SOFTWARE.                                                  #\n#                                                                            #\n# Except as contained in this notice, the name(s) of the above copyright     #\n# holders shall not be used in advertising or otherwise to promote the sale, #\n# use or other dealings in this Software without prior written               #\n# authorization.                                                             #\n##############################################################################\n#\n# Author: Thomas E. Dickey 1996-on\n#\n# Generate list of sources for a library, together with lint/lintlib rules\n#\n# Variables:\n#\tlibname (library name, e.g., \"ncurses\", \"panel\", \"forms\", \"menus\")\n#\tsubsets (is used here to decide if wide-character code is used)\n#\tticlib (library name for libtic, e.g., \"tic\")\n#\ttermlib (library name for libtinfo, e.g., \"tinfo\")\n#\nfunction make_lintlib(name,sources) {\n\tprint  \"\"\n\tprint  \"clean ::\"\n\tprintf \"\\trm -f llib-l%s.*\\n\", name\n\tprint  \"\"\n\tprint  \"realclean ::\"\n\tprintf \"\\trm -f llib-l%s\\n\", name\n\tprint  \"\"\n\tprintf \"llib-l%s : %s\\n\", name, sources\n\tprintf \"\\tcproto -a -l -DNCURSES_ENABLE_STDBOOL_H=0 -DLINT $(CPPFLAGS) %s >$@\\n\", sources\n\tprint  \"\"\n\tprint  \"lintlib ::\"\n\tprintf \"\\tsh $(srcdir)/../misc/makellib %s $(CPPFLAGS)\\n\", name\n\tprint \"\"\n\tprint \"lint ::\"\n\tprintf \"\\t$(LINT) $(LINT_OPTS) $(CPPFLAGS) %s $(LINT_LIBS)\\n\", sources\n}\n\n# A blank in \"subsets\" indicates a split-off of the library into a separate\n# file, e.g., for libtic or libtinfo.  They are all logical parts of the same\n# library.\nfunction which_library() {\n\tif ( ( which == \"ticlib\" ) && ( subsets ~ /ticlib / ) ) {\n\t\treturn ticlib;\n\t} else if ( ( which == \"termlib\" || which == \"ext_tinfo\" ) && ( subsets ~ /[[:space:]]base/ ) ) {\n\t\treturn termlib;\n\t} else {\n\t\treturn libname;\n\t}\n}\n\nfunction show_list(name, len, list) {\n\tif ( len > 0 ) {\n\t\tprintf \"\\n%s_SRC =\", toupper(name);\n\t\tfor (n = 0; n < len; ++n)\n\t\t\tprintf \" \\\\\\n\\t%s\", list[n];\n\t\tprint \"\";\n\t\tmake_lintlib(name, sprintf(\"$(%s_SRC)\", toupper(name)));\n\t}\n}\n\nBEGIN\t{\n\t\twhich = libname;\n\t\tusing = 0;\n\t\tfound = 0;\n\t\tcount_ticlib = 0;\n\t\tcount_termlib = 0;\n\t\tcount_library = 0;\n\t}\n\t/^@/ {\n\t\twhich = $0;\n\t\tsub(/^@[[:blank:]]+/, \"\", which);\n\t\tsub(/[[:blank:]]+$/, \"\", which);\n\t}\n\t!/^[@#]/ {\n\t\tif (using == 0)\n\t\t{\n\t\t\tprint  \"\"\n\t\t\tprint  \"# generated by mk-0th.awk\"\n\t\t\tprintf \"#   libname:    %s\\n\", libname\n\t\t\tprintf \"#   subsets:    %s\\n\", subsets\n\t\t\tif ( libname ~ /ncurses/ ) {\n\t\t\t\tprintf \"#   ticlib:     %s\\n\", ticlib\n\t\t\t\tprintf \"#   termlib:    %s\\n\", termlib\n\t\t\t}\n\t\t\tprint  \"\"\n\t\t\tprint  \".SUFFIXES: .c .cc .h .i .ii\"\n\t\t\tprint  \".c.i :\"\n\t\t\tprintf \"\\t$(CPP) $(CPPFLAGS) $< >$@\\n\"\n\t\t\tprint  \".cc.ii :\"\n\t\t\tprintf \"\\t$(CPP) $(CPPFLAGS) $< >$@\\n\"\n\t\t\tprint  \".h.i :\"\n\t\t\tprintf \"\\t$(CPP) $(CPPFLAGS) $< >$@\\n\"\n\t\t\tprint  \"\"\n\t\t\tusing = 1;\n\t\t}\n\t\tif (which ~ /port_/ )\n\t\t{\n\t\t\t# skip win32 source\n\t\t}\n\t\telse if ( $0 != \"\" && $1 != \"link_test\" )\n\t\t{\n\t\t\tif ( found == 0 )\n\t\t\t{\n\t\t\t\tif ( subsets ~ /widechar/ )\n\t\t\t\t\twidechar = 1;\n\t\t\t\telse\n\t\t\t\t\twidechar = 0;\n\t\t\t\tprintf \"C_SRC =\"\n\t\t\t\tif ( $2 == \"lib\" )\n\t\t\t\t\tfound = 1\n\t\t\t\telse if ( $2 == \"c++\" )\n\t\t\t\t\tfound = 2\n\t\t\t\telse\n\t\t\t\t\tfound = 3\n\t\t\t}\n\t\t\tif ( libname == \"c++\" || libname == \"c++w\" ) {\n\t\t\t\tsrcname = sprintf(\"%s/%s.cc\", $3, $1);\n\t\t\t\tprintf \" \\\\\\n\\t%s\", srcname;\n\t\t\t} else if ( widechar == 1 || $3 != \"$(wide)\" ) {\n\t\t\t\tsrcname = sprintf(\"%s/%s.c\", $3, $1);\n\t\t\t\tprintf \" \\\\\\n\\t%s\", srcname;\n\t\t\t\tif ( which_library() == libname ) {\n\t\t\t\t\tlist_library[count_library++] = srcname;\n\t\t\t\t} else if ( which_library() == ticlib ) {\n\t\t\t\t\tlist_ticlib[count_ticlib++] = srcname;\n\t\t\t\t} else {\n\t\t\t\t\tlist_termlib[count_termlib++] = srcname;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\nEND\t{\n\t\tprint  \"\"\n\t\tif ( found == 1 )\n\t\t{\n\t\t\tprint  \"\"\n\t\t\tprintf \"# Producing llib-l%s is time-consuming, so there's no direct-dependency for\\n\", libname;\n\t\t\tprint  \"# it in the lintlib rule.  We'll only remove in the cleanest setup.\";\n\t\t\tshow_list(libname, count_library, list_library);\n\t\t\tshow_list(ticlib, count_ticlib, list_ticlib);\n\t\t\tshow_list(termlib, count_termlib, list_termlib);\n\t\t}\n\t\telse if ( found == 2 )\n\t\t{\n\t\t\tmake_lintlib(libname, \"$(C_SRC)\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tprint  \"\"\n\t\t\tprint  \"lintlib :\"\n\t\t\tprint  \"\\t@echo no action needed\"\n\t\t}\n\t}\n# vile:ts=4 sw=4\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}