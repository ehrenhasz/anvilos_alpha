{
  "module_name": "sample.adb",
  "hash_id": "b1ca96c02080b1353bbde07c22595dd94aa892dcb5eba0f05ed839c66cb7031e",
  "original_prompt": "Ingested from ncurses-6.4/Ada95/samples/sample.adb",
  "human_readable_source": "------------------------------------------------------------------------------\n--                                                                          --\n--                       GNAT ncurses Binding Samples                       --\n--                                                                          --\n--                                 Sample                                   --\n--                                                                          --\n--                                 B O D Y                                  --\n--                                                                          --\n------------------------------------------------------------------------------\n-- Copyright 2020 Thomas E. Dickey                                          --\n-- Copyright 1998-2008,2011 Free Software Foundation, Inc.                  --\n--                                                                          --\n-- Permission is hereby granted, free of charge, to any person obtaining a  --\n-- copy of this software and associated documentation files (the            --\n-- \"Software\"), to deal in the Software without restriction, including      --\n-- without limitation the rights to use, copy, modify, merge, publish,      --\n-- distribute, distribute with modifications, sublicense, and/or sell       --\n-- copies of the Software, and to permit persons to whom the Software is    --\n-- furnished to do so, subject to the following conditions:                 --\n--                                                                          --\n-- The above copyright notice and this permission notice shall be included  --\n-- in all copies or substantial portions of the Software.                   --\n--                                                                          --\n-- THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  --\n-- OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               --\n-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   --\n-- IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   --\n-- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    --\n-- OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    --\n-- THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               --\n--                                                                          --\n-- Except as contained in this notice, the name(s) of the above copyright   --\n-- holders shall not be used in advertising or otherwise to promote the     --\n-- sale, use or other dealings in this Software without prior written       --\n-- authorization.                                                           --\n------------------------------------------------------------------------------\n--  Author:  Juergen Pfeifer, 1996\n--  Version Control\n--  $Revision: 1.19 $\n--  $Date: 2020/02/02 23:34:34 $\n--  Binding Version 01.00\n------------------------------------------------------------------------------\nwith Text_IO;\n\nwith Ada.Exceptions; use Ada.Exceptions;\n\nwith Terminal_Interface.Curses; use Terminal_Interface.Curses;\nwith Terminal_Interface.Curses.Panels; use Terminal_Interface.Curses.Panels;\nwith Terminal_Interface.Curses.Menus; use Terminal_Interface.Curses.Menus;\nwith Terminal_Interface.Curses.Menus.Menu_User_Data;\nwith Terminal_Interface.Curses.Menus.Item_User_Data;\n\nwith Sample.Manifest; use Sample.Manifest;\nwith Sample.Function_Key_Setting; use Sample.Function_Key_Setting;\nwith Sample.Keyboard_Handler; use Sample.Keyboard_Handler;\nwith Sample.Header_Handler; use Sample.Header_Handler;\nwith Sample.Explanation; use Sample.Explanation;\n\nwith Sample.Menu_Demo.Handler;\nwith Sample.Curses_Demo;\nwith Sample.Form_Demo;\nwith Sample.Menu_Demo;\nwith Sample.Text_IO_Demo;\n\nwith GNAT.OS_Lib;\n\npackage body Sample is\n\n   type User_Data is\n      record\n         Data : Integer;\n      end record;\n   type User_Access is access User_Data;\n\n   package Ud is new\n     Terminal_Interface.Curses.Menus.Menu_User_Data\n     (User_Data, User_Access);\n\n   package Id is new\n     Terminal_Interface.Curses.Menus.Item_User_Data\n     (User_Data, User_Access);\n\n   procedure Whow is\n      procedure Main_Menu;\n      procedure Main_Menu\n      is\n         function My_Driver (M : Menu;\n                             K : Key_Code;\n                             Pan : Panel) return Boolean;\n\n         package Mh is new Sample.Menu_Demo.Handler (My_Driver);\n\n         I : Item_Array_Access := new Item_Array'\n           (New_Item (\"Curses Core Demo\"),\n            New_Item (\"Menu Demo\"),\n            New_Item (\"Form Demo\"),\n            New_Item (\"Text IO Demo\"),\n            Null_Item);\n\n         M : Menu := New_Menu (I);\n\n         D1, D2 : User_Access;\n         I1, I2 : User_Access;\n\n         function My_Driver (M : Menu;\n                             K : Key_Code;\n                             Pan : Panel) return Boolean\n         is\n            Idx : constant Positive := Get_Index (Current (M));\n         begin\n            if K in User_Key_Code'Range then\n               if K = QUIT then\n                  return True;\n               elsif K = SELECT_ITEM then\n                  if Idx <= 4 then\n                     Hide (Pan);\n                     Update_Panels;\n                  end if;\n                  case Idx is\n                     when 1 => Sample.Curses_Demo.Demo;\n                     when 2 => Sample.Menu_Demo.Demo;\n                     when 3 => Sample.Form_Demo.Demo;\n                     when 4 => Sample.Text_IO_Demo.Demo;\n                     when others => null;\n                  end case;\n                  if Idx <= 4 then\n                     Top (Pan);\n                     Show (Pan);\n                     Update_Panels;\n                     Update_Screen;\n                  end if;\n               end if;\n            end if;\n            return False;\n         end My_Driver;\n\n      begin\n\n         if (1 + Item_Count (M)) /= I'Length then\n            raise Constraint_Error;\n         end if;\n\n         D1 := new User_Data'(Data => 4711);\n         Ud.Set_User_Data (M, D1);\n\n         I1 := new User_Data'(Data => 1174);\n         Id.Set_User_Data (I.all (1), I1);\n\n         Set_Spacing (Men => M, Row => 2);\n\n         Default_Labels;\n         Notepad (\"MAINPAD\");\n\n         Mh.Drive_Me (M, \" Demo \");\n\n         Ud.Get_User_Data (M, D2);\n         pragma Assert (D1 = D2);\n         pragma Assert (D1.Data = D2.Data);\n\n         Id.Get_User_Data (I.all (1), I2);\n         pragma Assert (I1 = I2);\n         pragma Assert (I1.Data = I2.Data);\n\n         Delete (M);\n         Free (I, True);\n      end Main_Menu;\n\n   begin\n      Initialize (PC_Style_With_Index);\n      Init_Header_Handler;\n      Init_Screen;\n\n      if Has_Colors then\n         Start_Color;\n\n         Init_Pair (Pair => Default_Colors,  Fore => Black,   Back => White);\n         Init_Pair (Pair => Menu_Back_Color, Fore => Black,   Back => Cyan);\n         Init_Pair (Pair => Menu_Fore_Color, Fore => Red,     Back => Cyan);\n         Init_Pair (Pair => Menu_Grey_Color, Fore => White,   Back => Cyan);\n         Init_Pair (Pair => Notepad_Color,   Fore => Black,   Back => Yellow);\n         Init_Pair (Pair => Help_Color,      Fore => Blue,    Back => Cyan);\n         Init_Pair (Pair => Form_Back_Color, Fore => Black,   Back => Cyan);\n         Init_Pair (Pair => Form_Fore_Color, Fore => Red,     Back => Cyan);\n         Init_Pair (Pair => Header_Color,    Fore => Black,   Back => Green);\n\n         Set_Background (Ch => (Color => Default_Colors,\n                                Attr  => Normal_Video,\n                                Ch    => ' '));\n         Set_Character_Attributes (Attr  => Normal_Video,\n                                   Color => Default_Colors);\n         Erase;\n\n         Set_Soft_Label_Key_Attributes (Color => Header_Color);\n         --  This propagates the attributes to the label window\n         Refresh_Soft_Label_Keys;\n      end if;\n\n      Init_Keyboard_Handler;\n\n      Set_Echo_Mode (False);\n      Set_Raw_Mode;\n      Set_Meta_Mode;\n      Set_KeyPad_Mode;\n\n      --  Initialize the Function Key Environment\n      --  We have some fixed key throughout this sample\n      Main_Menu;\n      End_Windows;\n      Curses_Free_All;\n\n   exception\n      when Event : others =>\n         Terminal_Interface.Curses.End_Windows;\n         Text_IO.Put (\"Exception: \");\n         Text_IO.Put (Exception_Name (Event));\n         Text_IO.New_Line;\n         GNAT.OS_Lib.OS_Exit (1);\n\n   end Whow;\n\nend Sample;\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}