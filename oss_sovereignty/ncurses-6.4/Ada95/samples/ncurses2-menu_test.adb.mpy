{
  "module_name": "ncurses2-menu_test.adb",
  "hash_id": "d6b6aeb1d44027a8dbcdd0038bc5d6f1ebe38900148f9f666776ab1669f22391",
  "original_prompt": "Ingested from ncurses-6.4/Ada95/samples/ncurses2-menu_test.adb",
  "human_readable_source": "------------------------------------------------------------------------------\n--                                                                          --\n--                       GNAT ncurses Binding Samples                       --\n--                                                                          --\n--                                 ncurses                                  --\n--                                                                          --\n--                                 B O D Y                                  --\n--                                                                          --\n------------------------------------------------------------------------------\n-- Copyright 2020 Thomas E. Dickey                                          --\n-- Copyright 2000-2006,2011 Free Software Foundation, Inc.                  --\n--                                                                          --\n-- Permission is hereby granted, free of charge, to any person obtaining a  --\n-- copy of this software and associated documentation files (the            --\n-- \"Software\"), to deal in the Software without restriction, including      --\n-- without limitation the rights to use, copy, modify, merge, publish,      --\n-- distribute, distribute with modifications, sublicense, and/or sell       --\n-- copies of the Software, and to permit persons to whom the Software is    --\n-- furnished to do so, subject to the following conditions:                 --\n--                                                                          --\n-- The above copyright notice and this permission notice shall be included  --\n-- in all copies or substantial portions of the Software.                   --\n--                                                                          --\n-- THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  --\n-- OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               --\n-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   --\n-- IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   --\n-- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    --\n-- OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    --\n-- THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               --\n--                                                                          --\n-- Except as contained in this notice, the name(s) of the above copyright   --\n-- holders shall not be used in advertising or otherwise to promote the     --\n-- sale, use or other dealings in this Software without prior written       --\n-- authorization.                                                           --\n------------------------------------------------------------------------------\n--  Author: Eugene V. Melaragno <aldomel@ix.netcom.com> 2000\n--  Version Control\n--  $Revision: 1.9 $\n--  $Date: 2020/02/02 23:34:34 $\n--  Binding Version 01.00\n------------------------------------------------------------------------------\nwith ncurses2.util; use ncurses2.util;\n\nwith Terminal_Interface.Curses; use Terminal_Interface.Curses;\nwith Terminal_Interface.Curses.Menus; use Terminal_Interface.Curses.Menus;\nwith Terminal_Interface.Curses.Mouse; use Terminal_Interface.Curses.Mouse;\n\nprocedure ncurses2.menu_test is\n   function menu_virtualize (c : Key_Code) return Key_Code;\n   procedure xAdd (l : Line_Position; c : Column_Position; s : String);\n\n   function menu_virtualize (c : Key_Code) return Key_Code is\n   begin\n      case c is\n         when Character'Pos (newl) | Key_Exit =>\n            return Menu_Request_Code'Last + 1; --  MAX_COMMAND? TODO\n         when  Character'Pos ('u')  =>\n            return M_ScrollUp_Line;\n         when  Character'Pos ('d') =>\n            return M_ScrollDown_Line;\n         when  Character'Pos ('b') |  Key_Next_Page =>\n            return M_ScrollUp_Page;\n         when  Character'Pos ('f') |  Key_Previous_Page =>\n            return M_ScrollDown_Page;\n         when  Character'Pos ('n') |  Key_Cursor_Down =>\n            return M_Next_Item;\n         when  Character'Pos ('p') |  Key_Cursor_Up =>\n            return M_Previous_Item;\n         when  Character'Pos (' ') =>\n            return M_Toggle_Item;\n         when  Key_Mouse =>\n            return c;\n         when others =>\n            Beep;\n            return c;\n      end case;\n   end menu_virtualize;\n\n   MENU_Y : constant Line_Count := 8;\n   MENU_X : constant Column_Count := 8;\n\n   type String_Access is access String;\n\n   animals : constant array (Positive range <>) of String_Access :=\n     (new String'(\"Lions\"),\n      new String'(\"Tigers\"),\n      new String'(\"Bears\"),\n      new String'(\"(Oh my!)\"),\n      new String'(\"Newts\"),\n      new String'(\"Platypi\"),\n      new String'(\"Lemurs\"));\n\n   items_a : constant Item_Array_Access :=\n      new Item_Array (1 .. animals'Last + 1);\n\n   tmp : Event_Mask;\n\n   procedure xAdd (l : Line_Position; c : Column_Position; s : String) is\n   begin\n      Add (Line => l, Column => c, Str => s);\n   end xAdd;\n\n   mrows : Line_Count;\n   mcols : Column_Count;\n\n   menuwin : Window;\n\n   m : Menu;\n\n   c1 : Key_Code;\n\n   c : Driver_Result;\n   r : Key_Code;\nbegin\n   tmp := Start_Mouse;\n   xAdd (0, 0, \"This is the menu test:\");\n   xAdd (2, 0, \"  Use up and down arrow to move the select bar.\");\n   xAdd (3, 0, \"  'n' and 'p' act like arrows.\");\n   xAdd (4, 0, \"  'b' and 'f' scroll up/down (page), 'u' and 'd' (line).\");\n   xAdd (5, 0, \"  Press return to exit.\");\n   Refresh;\n\n   for i in animals'Range loop\n      items_a.all (i) := New_Item (animals (i).all);\n   end loop;\n   items_a.all (animals'Last + 1) := Null_Item;\n\n   m := New_Menu (items_a);\n\n   Set_Format (m, Line_Position (animals'Last + 1) / 2, 1);\n   Scale (m, mrows, mcols);\n\n   menuwin := Create (mrows + 2, mcols + 2, MENU_Y, MENU_X);\n   Set_Window (m, menuwin);\n   Set_KeyPad_Mode (menuwin, True);\n   Box (menuwin); -- 0,0?\n\n   Set_Sub_Window (m, Derived_Window (menuwin, mrows, mcols, 1, 1));\n\n   Post (m);\n\n   loop\n      c1 := Getchar (menuwin);\n      r := menu_virtualize (c1);\n      c := Driver (m, r);\n      exit when c = Unknown_Request; -- E_UNKNOWN_COMMAND?\n      if c = Request_Denied then\n         Beep;\n      end if;\n      --  continue ?\n   end loop;\n\n   Move_Cursor (Line => Lines - 2, Column => 0);\n   Add (Str => \"You chose: \");\n   Add (Str => Name (Current (m)));\n   Add (Ch => newl);\n   Pause; -- the C version didn't use Pause, it spelled it out\n\n   Post (m, False); --  unpost, not clear :-(\n   declare begin\n      Delete (menuwin);\n   exception when Curses_Exception => null; end;\n   --  menuwin has children so will raise the exception.\n\n   Delete (m);\n\n   End_Mouse (tmp);\nend ncurses2.menu_test;\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}