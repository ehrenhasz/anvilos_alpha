{
  "module_name": "ncurses2-slk_test.adb",
  "hash_id": "e700c0bf45fca678fd8b8f0599b6eb996d78dfc8b04f0e85a593bb9954aa9b19",
  "original_prompt": "Ingested from ncurses-6.4/Ada95/samples/ncurses2-slk_test.adb",
  "human_readable_source": "------------------------------------------------------------------------------\n--                                                                          --\n--                       GNAT ncurses Binding Samples                       --\n--                                                                          --\n--                                 ncurses                                  --\n--                                                                          --\n--                                 B O D Y                                  --\n--                                                                          --\n------------------------------------------------------------------------------\n-- Copyright 2018,2020 Thomas E. Dickey                                     --\n-- Copyright 2000-2009,2011 Free Software Foundation, Inc.                  --\n--                                                                          --\n-- Permission is hereby granted, free of charge, to any person obtaining a  --\n-- copy of this software and associated documentation files (the            --\n-- \"Software\"), to deal in the Software without restriction, including      --\n-- without limitation the rights to use, copy, modify, merge, publish,      --\n-- distribute, distribute with modifications, sublicense, and/or sell       --\n-- copies of the Software, and to permit persons to whom the Software is    --\n-- furnished to do so, subject to the following conditions:                 --\n--                                                                          --\n-- The above copyright notice and this permission notice shall be included  --\n-- in all copies or substantial portions of the Software.                   --\n--                                                                          --\n-- THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  --\n-- OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               --\n-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   --\n-- IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   --\n-- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    --\n-- OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    --\n-- THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               --\n--                                                                          --\n-- Except as contained in this notice, the name(s) of the above copyright   --\n-- holders shall not be used in advertising or otherwise to promote the     --\n-- sale, use or other dealings in this Software without prior written       --\n-- authorization.                                                           --\n------------------------------------------------------------------------------\n--  Author: Eugene V. Melaragno <aldomel@ix.netcom.com> 2000\n--  Version Control\n--  $Revision: 1.11 $\n--  $Date: 2020/02/02 23:34:34 $\n--  Binding Version 01.00\n------------------------------------------------------------------------------\nwith ncurses2.util; use ncurses2.util;\nwith Terminal_Interface.Curses; use Terminal_Interface.Curses;\n\nwith Ada.Strings.Unbounded;\nwith Interfaces.C;\nwith Terminal_Interface.Curses.Aux;\n\nprocedure ncurses2.slk_test is\n   procedure myGet (Win : Window := Standard_Window;\n                    Str : out Ada.Strings.Unbounded.Unbounded_String;\n                    Len : Integer := -1);\n\n   procedure myGet (Win : Window := Standard_Window;\n                    Str : out Ada.Strings.Unbounded.Unbounded_String;\n                    Len : Integer := -1)\n   is\n      use Ada.Strings.Unbounded;\n      use Interfaces.C;\n      use Terminal_Interface.Curses.Aux;\n\n      function Wgetnstr (Win : Window;\n                         Str : char_array;\n                         Len : int) return int;\n      pragma Import (C, Wgetnstr, \"wgetnstr\");\n\n      --  FIXME: how to construct \"(Len > 0) ? Len : 80\"?\n      Ask : constant Interfaces.C.size_t := Interfaces.C.size_t'Val (Len + 80);\n      Txt : char_array (0 .. Ask);\n\n   begin\n      Txt (0) := Interfaces.C.char'First;\n      if Wgetnstr (Win, Txt, Txt'Length) = Curses_Err then\n         raise Curses_Exception;\n      end if;\n      Str := To_Unbounded_String (To_Ada (Txt, True));\n   end myGet;\n\n   use Ada.Strings.Unbounded;\n\n   c : Key_Code;\n   buf : Unbounded_String;\n   c2 : Character;\n   fmt : Label_Justification := Centered;\n   tmp : Integer;\n\nbegin\n   c := CTRL ('l');\n   loop\n      Move_Cursor (Line => 0, Column => 0);\n      c2 := Code_To_Char (c);\n      case c2 is\n         when Character'Val (Character'Pos ('l') mod 16#20#) => --  CTRL('l')\n            Erase;\n            Switch_Character_Attribute (Attr => (Bold_Character => True,\n                                                 others => False));\n            Add (Line => 0, Column => 20,\n                 Str => \"Soft Key Exerciser\");\n            Switch_Character_Attribute (On => False,\n                                        Attr => (Bold_Character => True,\n                                                 others => False));\n\n            Move_Cursor (Line => 2, Column => 0);\n            P (\"Available commands are:\");\n            P (\"\");\n            P (\"^L         -- refresh screen\");\n            P (\"a          -- activate or restore soft keys\");\n            P (\"d          -- disable soft keys\");\n            P (\"c          -- set centered format for labels\");\n            P (\"l          -- set left-justified format for labels\");\n            P (\"r          -- set right-justified format for labels\");\n            P (\"[12345678] -- set label; labels are numbered 1 through 8\");\n            P (\"e          -- erase stdscr (should not erase labels)\");\n            P (\"s          -- test scrolling of shortened screen\");\n            P (\"x, q       -- return to main menu\");\n            P (\"\");\n            P (\"Note: if activating the soft keys causes your terminal to\");\n            P (\"scroll up one line, your terminal auto-scrolls when anything\");\n            P (\"is written to the last screen position.  The ncurses code\");\n            P (\"does not yet handle this gracefully.\");\n            Refresh;\n            Restore_Soft_Label_Keys;\n\n         when 'a' =>\n            Restore_Soft_Label_Keys;\n         when 'e' =>\n            Clear;\n         when 's' =>\n            Add (Line => 20, Column => 0,\n                Str => \"Press Q to stop the scrolling-test: \");\n            loop\n               c := Getchar;\n               c2 := Code_To_Char (c);\n               exit when c2 = 'Q';\n               --  c = ERR?\n               --  TODO when c is not a character (arrow key)\n               --  the behavior is different from the C version.\n               Add (Ch => c2);\n            end loop;\n         when 'd' =>\n            Clear_Soft_Label_Keys;\n         when 'l' =>\n            fmt := Left;\n         when 'c' =>\n            fmt := Centered;\n         when 'r' =>\n            fmt := Right;\n         when '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8'  =>\n            Add (Line => 20, Column => 0,\n                 Str => \"Please enter the label value: \");\n            Set_Echo_Mode (SwitchOn => True);\n            myGet (Str => buf);\n            Set_Echo_Mode (SwitchOn => False);\n            tmp := ctoi (c2);\n            Set_Soft_Label_Key (Label_Number (tmp), To_String (buf), fmt);\n            Refresh_Soft_Label_Keys;\n            Move_Cursor (Line => 20, Column => 0);\n            Clear_To_End_Of_Line;\n         when 'x' | 'q' =>\n            exit;\n            --  the C version needed a goto, ha ha\n            --  breaks exit the case not the loop because fall-through\n            --  happens in C!\n         when others =>\n            Beep;\n      end case;\n      c := Getchar;\n      --  TODO exit when c = EOF\n   end loop;\n   Erase;\n   End_Windows;\nend ncurses2.slk_test;\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}