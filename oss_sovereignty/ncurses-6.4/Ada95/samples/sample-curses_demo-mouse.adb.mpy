{
  "module_name": "sample-curses_demo-mouse.adb",
  "hash_id": "c5f60b4e745c206b62985ee269a72d992d4b5f251d2331644de5c82a99f29ac8",
  "original_prompt": "Ingested from ncurses-6.4/Ada95/samples/sample-curses_demo-mouse.adb",
  "human_readable_source": "------------------------------------------------------------------------------\n--                                                                          --\n--                       GNAT ncurses Binding Samples                       --\n--                                                                          --\n--                         Sample.Curses_Demo.Mouse                         --\n--                                                                          --\n--                                 B O D Y                                  --\n--                                                                          --\n------------------------------------------------------------------------------\n-- Copyright 2020 Thomas E. Dickey                                          --\n-- Copyright 1998-2006,2008 Free Software Foundation, Inc.                  --\n--                                                                          --\n-- Permission is hereby granted, free of charge, to any person obtaining a  --\n-- copy of this software and associated documentation files (the            --\n-- \"Software\"), to deal in the Software without restriction, including      --\n-- without limitation the rights to use, copy, modify, merge, publish,      --\n-- distribute, distribute with modifications, sublicense, and/or sell       --\n-- copies of the Software, and to permit persons to whom the Software is    --\n-- furnished to do so, subject to the following conditions:                 --\n--                                                                          --\n-- The above copyright notice and this permission notice shall be included  --\n-- in all copies or substantial portions of the Software.                   --\n--                                                                          --\n-- THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  --\n-- OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               --\n-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   --\n-- IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   --\n-- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    --\n-- OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    --\n-- THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               --\n--                                                                          --\n-- Except as contained in this notice, the name(s) of the above copyright   --\n-- holders shall not be used in advertising or otherwise to promote the     --\n-- sale, use or other dealings in this Software without prior written       --\n-- authorization.                                                           --\n------------------------------------------------------------------------------\n--  Author:  Juergen Pfeifer, 1996\n--  Version Control\n--  $Revision: 1.17 $\n--  $Date: 2020/02/02 23:34:34 $\n--  Binding Version 01.00\n------------------------------------------------------------------------------\nwith Terminal_Interface.Curses; use Terminal_Interface.Curses;\nwith Terminal_Interface.Curses.Panels; use Terminal_Interface.Curses.Panels;\nwith Terminal_Interface.Curses.Mouse; use Terminal_Interface.Curses.Mouse;\nwith Terminal_Interface.Curses.Text_IO; use Terminal_Interface.Curses.Text_IO;\nwith Terminal_Interface.Curses.Text_IO.Integer_IO;\nwith Terminal_Interface.Curses.Text_IO.Enumeration_IO;\n\nwith Sample.Helpers; use Sample.Helpers;\nwith Sample.Manifest; use Sample.Manifest;\nwith Sample.Keyboard_Handler; use Sample.Keyboard_Handler;\nwith Sample.Function_Key_Setting; use Sample.Function_Key_Setting;\nwith Sample.Explanation; use Sample.Explanation;\n\npackage body Sample.Curses_Demo.Mouse is\n\n   package Int_IO is new\n     Terminal_Interface.Curses.Text_IO.Integer_IO (Integer);\n   use Int_IO;\n\n   package Button_IO is new\n     Terminal_Interface.Curses.Text_IO.Enumeration_IO (Mouse_Button);\n   use Button_IO;\n\n   package State_IO is new\n     Terminal_Interface.Curses.Text_IO.Enumeration_IO (Button_State);\n   use State_IO;\n\n   procedure Demo is\n\n      type Controls is array (1 .. 3) of Panel;\n\n      Frame : Window;\n      Msg   : Window;\n      Ctl   : Controls;\n      Pan   : Panel;\n      K     : Real_Key_Code;\n      V     : Cursor_Visibility := Invisible;\n      W     : Window;\n      Note  : Window;\n      Msg_L : constant Line_Count := 8;\n      Lins  : Line_Position := Lines;\n      Cols  : Column_Position;\n      Mask  : Event_Mask;\n      procedure Show_Mouse_Event;\n\n      procedure Show_Mouse_Event\n      is\n         Evt    : constant Mouse_Event := Get_Mouse;\n         Y      : Line_Position;\n         X      : Column_Position;\n         Button : Mouse_Button;\n         State  : Button_State;\n         W      : Window;\n      begin\n         Get_Event (Evt, Y, X, Button, State);\n         Put (Msg, \"Event at\");\n         Put (Msg, \"  X=\");    Put (Msg, Integer (X), 3);\n         Put (Msg, \", Y=\");    Put (Msg, Integer (Y), 3);\n         Put (Msg, \", Btn=\");  Put (Msg, Button, 10);\n         Put (Msg, \", Stat=\"); Put (Msg, State, 15);\n         for I in Ctl'Range loop\n            W := Get_Window (Ctl (I));\n            if Enclosed_In_Window (W, Evt) then\n               Transform_Coordinates (W, Y, X, From_Screen);\n               Put (Msg, \",Box(\");\n               Put (Msg, (I), 1); Put (Msg, \",\");\n               Put (Msg, Integer (Y), 1); Put (Msg, \",\");\n               Put (Msg, Integer (X), 1); Put (Msg, \")\");\n            end if;\n         end loop;\n         New_Line (Msg);\n         Flush (Msg);\n         Update_Panels; Update_Screen;\n      end Show_Mouse_Event;\n\n   begin\n      Push_Environment (\"MOUSE00\");\n      Notepad (\"MOUSE-PAD00\");\n      Default_Labels;\n      Set_Cursor_Visibility (V);\n\n      Note  := Notepad_Window;\n      if Note /= Null_Window then\n         Get_Window_Position (Note, Lins, Cols);\n      end if;\n      Frame := Create (Msg_L, Columns, Lins - Msg_L, 0);\n      if Has_Colors then\n         Set_Background (Win => Frame,\n                         Ch => (Color => Default_Colors,\n                                Attr  => Normal_Video,\n                                Ch    => ' '));\n         Set_Character_Attributes (Win   => Frame,\n                                   Attr  => Normal_Video,\n                                   Color => Default_Colors);\n         Erase (Frame);\n      end if;\n      Msg   := Derived_Window (Frame, Msg_L - 2, Columns - 2, 1, 1);\n      Pan   := Create (Frame);\n\n      Set_Meta_Mode;\n      Set_KeyPad_Mode;\n      Mask := Start_Mouse;\n\n      Box (Frame);\n      Window_Title (Frame, \"Mouse Protocol\");\n      Refresh_Without_Update (Frame);\n      Allow_Scrolling (Msg, True);\n\n      declare\n         Middle_Column : constant Integer := Integer (Columns) / 2;\n         Middle_Index  : constant Natural := Ctl'First + (Ctl'Length / 2);\n         Width         : constant Column_Count := 5;\n         Height        : constant Line_Count   := 3;\n         Half          : constant Column_Count := Width / 2;\n         Space         : constant Column_Count := 3;\n         Position      : Integer;\n         W             : Window;\n      begin\n         for I in Ctl'Range loop\n            Position := ((I) - Integer (Middle_Index)) *\n              Integer (Half + Space + Width) + Middle_Column;\n            W := Create (Height,\n                         Width,\n                         1,\n                         Column_Position (Position));\n            if Has_Colors then\n               Set_Background (Win => W,\n                               Ch => (Color => Menu_Back_Color,\n                                      Attr  => Normal_Video,\n                                      Ch    => ' '));\n               Set_Character_Attributes (Win   => W,\n                                         Attr  => Normal_Video,\n                                         Color => Menu_Fore_Color);\n               Erase (W);\n            end if;\n            Ctl (I) := Create (W);\n            Box (W);\n            Move_Cursor (W, 1, Half);\n            Put (W, (I), 1);\n            Refresh_Without_Update (W);\n         end loop;\n      end;\n\n      Update_Panels; Update_Screen;\n\n      loop\n         K := Get_Key;\n         if K in Special_Key_Code'Range then\n            case K is\n               when QUIT_CODE     => exit;\n               when HELP_CODE     => Explain_Context;\n               when EXPLAIN_CODE  => Explain (\"MOUSEKEYS\");\n               when Key_Mouse     => Show_Mouse_Event;\n               when others        => null;\n            end case;\n         end if;\n      end loop;\n\n      for I in Ctl'Range loop\n         W := Get_Window (Ctl (I));\n         Clear (W);\n         Delete (Ctl (I));\n         Delete (W);\n      end loop;\n\n      Clear (Frame);\n      Delete (Pan);\n      Delete (Msg);\n      Delete (Frame);\n\n      Set_Cursor_Visibility (V);\n      End_Mouse (Mask);\n\n      Pop_Environment;\n      Update_Panels; Update_Screen;\n\n   end Demo;\n\nend Sample.Curses_Demo.Mouse;\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}