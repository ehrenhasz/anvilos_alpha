{
  "module_name": "terminal_interface-curses-menus.adb",
  "hash_id": "c03e5798fedda6a6f601aae8fff0e8cf9da2e9ace2e3ed30217713123c925378",
  "original_prompt": "Ingested from ncurses-6.4/Ada95/src/terminal_interface-curses-menus.adb",
  "human_readable_source": "------------------------------------------------------------------------------\n--                                                                          --\n--                           GNAT ncurses Binding                           --\n--                                                                          --\n--                      Terminal_Interface.Curses.Menus                     --\n--                                                                          --\n--                                 B O D Y                                  --\n--                                                                          --\n------------------------------------------------------------------------------\n-- Copyright 2018,2020 Thomas E. Dickey                                     --\n-- Copyright 1999-2011,2014 Free Software Foundation, Inc.                  --\n--                                                                          --\n-- Permission is hereby granted, free of charge, to any person obtaining a  --\n-- copy of this software and associated documentation files (the            --\n-- \"Software\"), to deal in the Software without restriction, including      --\n-- without limitation the rights to use, copy, modify, merge, publish,      --\n-- distribute, distribute with modifications, sublicense, and/or sell       --\n-- copies of the Software, and to permit persons to whom the Software is    --\n-- furnished to do so, subject to the following conditions:                 --\n--                                                                          --\n-- The above copyright notice and this permission notice shall be included  --\n-- in all copies or substantial portions of the Software.                   --\n--                                                                          --\n-- THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  --\n-- OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               --\n-- MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   --\n-- IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   --\n-- DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    --\n-- OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    --\n-- THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               --\n--                                                                          --\n-- Except as contained in this notice, the name(s) of the above copyright   --\n-- holders shall not be used in advertising or otherwise to promote the     --\n-- sale, use or other dealings in this Software without prior written       --\n-- authorization.                                                           --\n------------------------------------------------------------------------------\n--  Author:  Juergen Pfeifer, 1996\n--  Version Control:\n--  $Revision: 1.34 $\n--  $Date: 2020/02/02 23:34:34 $\n--  Binding Version 01.00\n------------------------------------------------------------------------------\nwith Ada.Unchecked_Deallocation;\nwith Terminal_Interface.Curses.Aux; use Terminal_Interface.Curses.Aux;\n\nwith Interfaces.C; use Interfaces.C;\nwith Interfaces.C.Strings; use Interfaces.C.Strings;\nwith Interfaces.C.Pointers;\n\npackage body Terminal_Interface.Curses.Menus is\n\n   type C_Item_Array is array (Natural range <>) of aliased Item;\n   package I_Array is new\n     Interfaces.C.Pointers (Natural, Item, C_Item_Array, Null_Item);\n\n   subtype chars_ptr is Interfaces.C.Strings.chars_ptr;\n\n------------------------------------------------------------------------------\n   procedure Request_Name (Key  : Menu_Request_Code;\n                           Name : out String)\n   is\n      function Request_Name (Key : C_Int) return chars_ptr;\n      pragma Import (C, Request_Name, \"menu_request_name\");\n   begin\n      Fill_String (Request_Name (C_Int (Key)), Name);\n   end Request_Name;\n\n   function Request_Name (Key : Menu_Request_Code) return String\n   is\n      function Request_Name (Key : C_Int) return chars_ptr;\n      pragma Import (C, Request_Name, \"menu_request_name\");\n   begin\n      return Fill_String (Request_Name (C_Int (Key)));\n   end Request_Name;\n\n   function Create (Name        : String;\n                    Description : String := \"\") return Item\n   is\n      type Char_Ptr is access all Interfaces.C.char;\n      function Newitem (Name, Desc : Char_Ptr) return Item;\n      pragma Import (C, Newitem, \"new_item\");\n\n      type Name_String is new char_array (0 .. Name'Length);\n      type Name_String_Ptr is access Name_String;\n      pragma Controlled (Name_String_Ptr);\n\n      type Desc_String is new char_array (0 .. Description'Length);\n      type Desc_String_Ptr is access Desc_String;\n      pragma Controlled (Desc_String_Ptr);\n\n      Name_Str : constant Name_String_Ptr := new Name_String;\n      Desc_Str : constant Desc_String_Ptr := new Desc_String;\n      Name_Len, Desc_Len : size_t;\n      Result : Item;\n   begin\n      To_C (Name, Name_Str.all, Name_Len);\n      To_C (Description, Desc_Str.all, Desc_Len);\n      Result := Newitem (Name_Str.all (Name_Str.all'First)'Access,\n                         Desc_Str.all (Desc_Str.all'First)'Access);\n      if Result = Null_Item then\n         raise Eti_System_Error;\n      end if;\n      return Result;\n   end Create;\n\n   procedure Delete (Itm : in out Item)\n   is\n      function Descname (Itm  : Item) return chars_ptr;\n      pragma Import (C, Descname, \"item_description\");\n      function Itemname (Itm  : Item) return chars_ptr;\n      pragma Import (C, Itemname, \"item_name\");\n\n      function Freeitem (Itm : Item) return Eti_Error;\n      pragma Import (C, Freeitem, \"free_item\");\n\n      Ptr : chars_ptr;\n   begin\n      Ptr := Descname (Itm);\n      if Ptr /= Null_Ptr then\n         Interfaces.C.Strings.Free (Ptr);\n      end if;\n      Ptr := Itemname (Itm);\n      if Ptr /= Null_Ptr then\n         Interfaces.C.Strings.Free (Ptr);\n      end if;\n      Eti_Exception (Freeitem (Itm));\n      Itm := Null_Item;\n   end Delete;\n-------------------------------------------------------------------------------\n   procedure Set_Value (Itm   : Item;\n                        Value : Boolean := True)\n   is\n      function Set_Item_Val (Itm : Item;\n                             Val : C_Int) return Eti_Error;\n      pragma Import (C, Set_Item_Val, \"set_item_value\");\n\n   begin\n      Eti_Exception (Set_Item_Val (Itm, Boolean'Pos (Value)));\n   end Set_Value;\n\n   function Value (Itm : Item) return Boolean\n   is\n      function Item_Val (Itm : Item) return C_Int;\n      pragma Import (C, Item_Val, \"item_value\");\n   begin\n      if Item_Val (Itm) = Curses_False then\n         return False;\n      else\n         return True;\n      end if;\n   end Value;\n\n-------------------------------------------------------------------------------\n   function Visible (Itm : Item) return Boolean\n   is\n      function Item_Vis (Itm : Item) return C_Int;\n      pragma Import (C, Item_Vis, \"item_visible\");\n   begin\n      if Item_Vis (Itm) = Curses_False then\n         return False;\n      else\n         return True;\n      end if;\n   end Visible;\n-------------------------------------------------------------------------------\n   procedure Set_Options (Itm     : Item;\n                          Options : Item_Option_Set)\n   is\n      function Set_Item_Opts (Itm : Item;\n                              Opt : Item_Option_Set) return Eti_Error;\n      pragma Import (C, Set_Item_Opts, \"set_item_opts\");\n\n   begin\n      Eti_Exception (Set_Item_Opts (Itm, Options));\n   end Set_Options;\n\n   procedure Switch_Options (Itm     : Item;\n                             Options : Item_Option_Set;\n                             On      : Boolean := True)\n   is\n      function Item_Opts_On (Itm : Item;\n                             Opt : Item_Option_Set) return Eti_Error;\n      pragma Import (C, Item_Opts_On, \"item_opts_on\");\n      function Item_Opts_Off (Itm : Item;\n                              Opt : Item_Option_Set) return Eti_Error;\n      pragma Import (C, Item_Opts_Off, \"item_opts_off\");\n\n   begin\n      if On then\n         Eti_Exception (Item_Opts_On (Itm, Options));\n      else\n         Eti_Exception (Item_Opts_Off (Itm, Options));\n      end if;\n   end Switch_Options;\n\n   procedure Get_Options (Itm     : Item;\n                          Options : out Item_Option_Set)\n   is\n      function Item_Opts (Itm : Item) return Item_Option_Set;\n      pragma Import (C, Item_Opts, \"item_opts\");\n\n   begin\n      Options := Item_Opts (Itm);\n   end Get_Options;\n\n   function Get_Options (Itm : Item := Null_Item) return Item_Option_Set\n   is\n      Ios : Item_Option_Set;\n   begin\n      Get_Options (Itm, Ios);\n      return Ios;\n   end Get_Options;\n-------------------------------------------------------------------------------\n   procedure Name (Itm  : Item;\n                   Name : out String)\n   is\n      function Itemname (Itm : Item) return chars_ptr;\n      pragma Import (C, Itemname, \"item_name\");\n   begin\n      Fill_String (Itemname (Itm), Name);\n   end Name;\n\n   function Name (Itm : Item) return String\n   is\n      function Itemname (Itm : Item) return chars_ptr;\n      pragma Import (C, Itemname, \"item_name\");\n   begin\n      return Fill_String (Itemname (Itm));\n   end Name;\n\n   procedure Description (Itm         : Item;\n                          Description : out String)\n   is\n      function Descname (Itm  : Item) return chars_ptr;\n      pragma Import (C, Descname, \"item_description\");\n   begin\n      Fill_String (Descname (Itm), Description);\n   end Description;\n\n   function Description (Itm : Item) return String\n   is\n      function Descname (Itm  : Item) return chars_ptr;\n      pragma Import (C, Descname, \"item_description\");\n   begin\n      return Fill_String (Descname (Itm));\n   end Description;\n-------------------------------------------------------------------------------\n   procedure Set_Current (Men : Menu;\n                          Itm : Item)\n   is\n      function Set_Curr_Item (Men : Menu;\n                              Itm : Item) return Eti_Error;\n      pragma Import (C, Set_Curr_Item, \"set_current_item\");\n\n   begin\n      Eti_Exception (Set_Curr_Item (Men, Itm));\n   end Set_Current;\n\n   function Current (Men : Menu) return Item\n   is\n      function Curr_Item (Men : Menu) return Item;\n      pragma Import (C, Curr_Item, \"current_item\");\n\n      Res : constant Item := Curr_Item (Men);\n   begin\n      if Res = Null_Item then\n         raise Menu_Exception;\n      end if;\n      return Res;\n   end Current;\n\n   procedure Set_Top_Row (Men  : Menu;\n                          Line : Line_Position)\n   is\n      function Set_Toprow (Men  : Menu;\n                           Line : C_Int) return Eti_Error;\n      pragma Import (C, Set_Toprow, \"set_top_row\");\n\n   begin\n      Eti_Exception (Set_Toprow (Men, C_Int (Line)));\n   end Set_Top_Row;\n\n   function Top_Row (Men : Menu) return Line_Position\n   is\n      function Toprow (Men : Menu) return C_Int;\n      pragma Import (C, Toprow, \"top_row\");\n\n      Res : constant C_Int := Toprow (Men);\n   begin\n      if Res = Curses_Err then\n         raise Menu_Exception;\n      end if;\n      return Line_Position (Res);\n   end Top_Row;\n\n   function Get_Index (Itm : Item) return Positive\n   is\n      function Get_Itemindex (Itm : Item) return C_Int;\n      pragma Import (C, Get_Itemindex, \"item_index\");\n\n      Res : constant C_Int := Get_Itemindex (Itm);\n   begin\n      if Res = Curses_Err then\n         raise Menu_Exception;\n      end if;\n      return Positive (Natural (Res) + Positive'First);\n   end Get_Index;\n-------------------------------------------------------------------------------\n   procedure Post (Men  : Menu;\n                   Post : Boolean := True)\n   is\n      function M_Post (Men : Menu) return Eti_Error;\n      pragma Import (C, M_Post, \"post_menu\");\n      function M_Unpost (Men : Menu) return Eti_Error;\n      pragma Import (C, M_Unpost, \"unpost_menu\");\n\n   begin\n      if Post then\n         Eti_Exception (M_Post (Men));\n      else\n         Eti_Exception (M_Unpost (Men));\n      end if;\n   end Post;\n-------------------------------------------------------------------------------\n   procedure Set_Options (Men     : Menu;\n                          Options : Menu_Option_Set)\n   is\n      function Set_Menu_Opts (Men : Menu;\n                              Opt : Menu_Option_Set) return Eti_Error;\n      pragma Import (C, Set_Menu_Opts, \"set_menu_opts\");\n\n   begin\n      Eti_Exception (Set_Menu_Opts (Men, Options));\n   end Set_Options;\n\n   procedure Switch_Options (Men     : Menu;\n                             Options : Menu_Option_Set;\n                             On      : Boolean := True)\n   is\n      function Menu_Opts_On (Men : Menu;\n                             Opt : Menu_Option_Set) return Eti_Error;\n      pragma Import (C, Menu_Opts_On, \"menu_opts_on\");\n      function Menu_Opts_Off (Men : Menu;\n                              Opt : Menu_Option_Set) return Eti_Error;\n      pragma Import (C, Menu_Opts_Off, \"menu_opts_off\");\n\n   begin\n      if On then\n         Eti_Exception (Menu_Opts_On  (Men, Options));\n      else\n         Eti_Exception (Menu_Opts_Off (Men, Options));\n      end if;\n   end Switch_Options;\n\n   procedure Get_Options (Men     : Menu;\n                          Options : out Menu_Option_Set)\n   is\n      function Menu_Opts (Men : Menu) return Menu_Option_Set;\n      pragma Import (C, Menu_Opts, \"menu_opts\");\n\n   begin\n      Options := Menu_Opts (Men);\n   end Get_Options;\n\n   function Get_Options (Men : Menu := Null_Menu) return Menu_Option_Set\n   is\n      Mos : Menu_Option_Set;\n   begin\n      Get_Options (Men, Mos);\n      return Mos;\n   end Get_Options;\n-------------------------------------------------------------------------------\n   procedure Set_Window (Men : Menu;\n                         Win : Window)\n   is\n      function Set_Menu_Win (Men : Menu;\n                             Win : Window) return Eti_Error;\n      pragma Import (C, Set_Menu_Win, \"set_menu_win\");\n\n   begin\n      Eti_Exception (Set_Menu_Win (Men, Win));\n   end Set_Window;\n\n   function Get_Window (Men : Menu) return Window\n   is\n      function Menu_Win (Men : Menu) return Window;\n      pragma Import (C, Menu_Win, \"menu_win\");\n\n      W : constant Window := Menu_Win (Men);\n   begin\n      return W;\n   end Get_Window;\n\n   procedure Set_Sub_Window (Men : Menu;\n                             Win : Window)\n   is\n      function Set_Menu_Sub (Men : Menu;\n                             Win : Window) return Eti_Error;\n      pragma Import (C, Set_Menu_Sub, \"set_menu_sub\");\n\n   begin\n      Eti_Exception (Set_Menu_Sub (Men, Win));\n   end Set_Sub_Window;\n\n   function Get_Sub_Window (Men : Menu) return Window\n   is\n      function Menu_Sub (Men : Menu) return Window;\n      pragma Import (C, Menu_Sub, \"menu_sub\");\n\n      W : constant Window := Menu_Sub (Men);\n   begin\n      return W;\n   end Get_Sub_Window;\n\n   procedure Scale (Men     : Menu;\n                    Lines   : out Line_Count;\n                    Columns : out Column_Count)\n   is\n      type C_Int_Access is access all C_Int;\n      function M_Scale (Men    : Menu;\n                        Yp, Xp : C_Int_Access) return Eti_Error;\n      pragma Import (C, M_Scale, \"scale_menu\");\n\n      X, Y : aliased C_Int;\n   begin\n      Eti_Exception (M_Scale (Men, Y'Access, X'Access));\n      Lines := Line_Count (Y);\n      Columns := Column_Count (X);\n   end Scale;\n-------------------------------------------------------------------------------\n   procedure Position_Cursor (Men : Menu)\n   is\n      function Pos_Menu_Cursor (Men : Menu) return Eti_Error;\n      pragma Import (C, Pos_Menu_Cursor, \"pos_menu_cursor\");\n\n   begin\n      Eti_Exception (Pos_Menu_Cursor (Men));\n   end Position_Cursor;\n\n-------------------------------------------------------------------------------\n   procedure Set_Mark (Men  : Menu;\n                       Mark : String)\n   is\n      type Char_Ptr is access all Interfaces.C.char;\n      function Set_Mark (Men  : Menu;\n                         Mark : Char_Ptr) return Eti_Error;\n      pragma Import (C, Set_Mark, \"set_menu_mark\");\n\n      Txt : char_array (0 .. Mark'Length);\n      Len : size_t;\n   begin\n      To_C (Mark, Txt, Len);\n      Eti_Exception (Set_Mark (Men, Txt (Txt'First)'Access));\n   end Set_Mark;\n\n   procedure Mark (Men  : Menu;\n                   Mark : out String)\n   is\n      function Get_Menu_Mark (Men : Menu) return chars_ptr;\n      pragma Import (C, Get_Menu_Mark, \"menu_mark\");\n   begin\n      Fill_String (Get_Menu_Mark (Men), Mark);\n   end Mark;\n\n   function Mark (Men : Menu) return String\n   is\n      function Get_Menu_Mark (Men : Menu) return chars_ptr;\n      pragma Import (C, Get_Menu_Mark, \"menu_mark\");\n   begin\n      return Fill_String (Get_Menu_Mark (Men));\n   end Mark;\n\n-------------------------------------------------------------------------------\n   procedure Set_Foreground\n     (Men   : Menu;\n      Fore  : Character_Attribute_Set := Normal_Video;\n      Color : Color_Pair := Color_Pair'First)\n   is\n      function Set_Menu_Fore (Men  : Menu;\n                              Attr : Attributed_Character) return Eti_Error;\n      pragma Import (C, Set_Menu_Fore, \"set_menu_fore\");\n\n      Ch : constant Attributed_Character := (Ch    => Character'First,\n                                             Color => Color,\n                                             Attr  => Fore);\n   begin\n      Eti_Exception (Set_Menu_Fore (Men, Ch));\n   end Set_Foreground;\n\n   procedure Foreground (Men  : Menu;\n                         Fore : out Character_Attribute_Set)\n   is\n      function Menu_Fore (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Fore, \"menu_fore\");\n   begin\n      Fore := Menu_Fore (Men).Attr;\n   end Foreground;\n\n   procedure Foreground (Men   : Menu;\n                         Fore  : out Character_Attribute_Set;\n                         Color : out Color_Pair)\n   is\n      function Menu_Fore (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Fore, \"menu_fore\");\n   begin\n      Fore  := Menu_Fore (Men).Attr;\n      Color := Menu_Fore (Men).Color;\n   end Foreground;\n\n   procedure Set_Background\n     (Men   : Menu;\n      Back  : Character_Attribute_Set := Normal_Video;\n      Color : Color_Pair := Color_Pair'First)\n   is\n      function Set_Menu_Back (Men  : Menu;\n                              Attr : Attributed_Character) return Eti_Error;\n      pragma Import (C, Set_Menu_Back, \"set_menu_back\");\n\n      Ch : constant Attributed_Character := (Ch    => Character'First,\n                                             Color => Color,\n                                             Attr  => Back);\n   begin\n      Eti_Exception (Set_Menu_Back (Men, Ch));\n   end Set_Background;\n\n   procedure Background (Men  : Menu;\n                         Back : out Character_Attribute_Set)\n   is\n      function Menu_Back (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Back, \"menu_back\");\n   begin\n      Back := Menu_Back (Men).Attr;\n   end Background;\n\n   procedure Background (Men   : Menu;\n                         Back  : out Character_Attribute_Set;\n                         Color : out Color_Pair)\n   is\n      function Menu_Back (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Back, \"menu_back\");\n   begin\n      Back  := Menu_Back (Men).Attr;\n      Color := Menu_Back (Men).Color;\n   end Background;\n\n   procedure Set_Grey (Men   : Menu;\n                       Grey  : Character_Attribute_Set := Normal_Video;\n                       Color : Color_Pair := Color_Pair'First)\n   is\n      function Set_Menu_Grey (Men  : Menu;\n                              Attr : Attributed_Character) return Eti_Error;\n      pragma Import (C, Set_Menu_Grey, \"set_menu_grey\");\n\n      Ch : constant Attributed_Character := (Ch    => Character'First,\n                                             Color => Color,\n                                             Attr  => Grey);\n\n   begin\n      Eti_Exception (Set_Menu_Grey (Men, Ch));\n   end Set_Grey;\n\n   procedure Grey (Men  : Menu;\n                   Grey : out Character_Attribute_Set)\n   is\n      function Menu_Grey (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Grey, \"menu_grey\");\n   begin\n      Grey := Menu_Grey (Men).Attr;\n   end Grey;\n\n   procedure Grey (Men  : Menu;\n                   Grey : out Character_Attribute_Set;\n                   Color : out Color_Pair)\n   is\n      function Menu_Grey (Men : Menu) return Attributed_Character;\n      pragma Import (C, Menu_Grey, \"menu_grey\");\n   begin\n      Grey  := Menu_Grey (Men).Attr;\n      Color := Menu_Grey (Men).Color;\n   end Grey;\n\n   procedure Set_Pad_Character (Men : Menu;\n                                Pad : Character := Space)\n   is\n      function Set_Menu_Pad (Men : Menu;\n                             Ch  : C_Int) return Eti_Error;\n      pragma Import (C, Set_Menu_Pad, \"set_menu_pad\");\n\n   begin\n      Eti_Exception (Set_Menu_Pad (Men, C_Int (Character'Pos (Pad))));\n   end Set_Pad_Character;\n\n   procedure Pad_Character (Men : Menu;\n                            Pad : out Character)\n   is\n      function Menu_Pad (Men : Menu) return C_Int;\n      pragma Import (C, Menu_Pad, \"menu_pad\");\n   begin\n      Pad := Character'Val (Menu_Pad (Men));\n   end Pad_Character;\n-------------------------------------------------------------------------------\n   procedure Set_Spacing (Men   : Menu;\n                          Descr : Column_Position := 0;\n                          Row   : Line_Position   := 0;\n                          Col   : Column_Position := 0)\n   is\n      function Set_Spacing (Men     : Menu;\n                            D, R, C : C_Int) return Eti_Error;\n      pragma Import (C, Set_Spacing, \"set_menu_spacing\");\n\n   begin\n      Eti_Exception (Set_Spacing (Men,\n                                  C_Int (Descr),\n                                  C_Int (Row),\n                                  C_Int (Col)));\n   end Set_Spacing;\n\n   procedure Spacing (Men   : Menu;\n                      Descr : out Column_Position;\n                      Row   : out Line_Position;\n                      Col   : out Column_Position)\n   is\n      type C_Int_Access is access all C_Int;\n      function Get_Spacing (Men     : Menu;\n                            D, R, C : C_Int_Access) return Eti_Error;\n      pragma Import (C, Get_Spacing, \"menu_spacing\");\n\n      D, R, C : aliased C_Int;\n   begin\n      Eti_Exception (Get_Spacing (Men,\n                                  D'Access,\n                                  R'Access,\n                                  C'Access));\n      Descr := Column_Position (D);\n      Row   := Line_Position (R);\n      Col   := Column_Position (C);\n   end Spacing;\n-------------------------------------------------------------------------------\n   function Set_Pattern (Men  : Menu;\n                         Text : String) return Boolean\n   is\n      type Char_Ptr is access all Interfaces.C.char;\n      function Set_Pattern (Men     : Menu;\n                            Pattern : Char_Ptr) return Eti_Error;\n      pragma Import (C, Set_Pattern, \"set_menu_pattern\");\n\n      S   : char_array (0 .. Text'Length);\n      L   : size_t;\n      Res : Eti_Error;\n   begin\n      To_C (Text, S, L);\n      Res := Set_Pattern (Men, S (S'First)'Access);\n      case Res is\n         when E_No_Match =>\n            return False;\n         when others =>\n            Eti_Exception (Res);\n            return True;\n      end case;\n   end Set_Pattern;\n\n   procedure Pattern (Men  : Menu;\n                      Text : out String)\n   is\n      function Get_Pattern (Men : Menu) return chars_ptr;\n      pragma Import (C, Get_Pattern, \"menu_pattern\");\n   begin\n      Fill_String (Get_Pattern (Men), Text);\n   end Pattern;\n-------------------------------------------------------------------------------\n   procedure Set_Format (Men     : Menu;\n                         Lines   : Line_Count;\n                         Columns : Column_Count)\n   is\n      function Set_Menu_Fmt (Men : Menu;\n                             Lin : C_Int;\n                             Col : C_Int) return Eti_Error;\n      pragma Import (C, Set_Menu_Fmt, \"set_menu_format\");\n\n   begin\n      Eti_Exception (Set_Menu_Fmt (Men,\n                                   C_Int (Lines),\n                                   C_Int (Columns)));\n\n   end Set_Format;\n\n   procedure Format (Men     : Menu;\n                     Lines   : out Line_Count;\n                     Columns : out Column_Count)\n   is\n      type C_Int_Access is access all C_Int;\n      function Menu_Fmt (Men  : Menu;\n                         Y, X : C_Int_Access) return Eti_Error;\n      pragma Import (C, Menu_Fmt, \"menu_format\");\n\n      L, C : aliased C_Int;\n   begin\n      Eti_Exception (Menu_Fmt (Men, L'Access, C'Access));\n      Lines   := Line_Count (L);\n      Columns := Column_Count (C);\n   end Format;\n-------------------------------------------------------------------------------\n   procedure Set_Item_Init_Hook (Men  : Menu;\n                                 Proc : Menu_Hook_Function)\n   is\n      function Set_Item_Init (Men  : Menu;\n                              Proc : Menu_Hook_Function) return Eti_Error;\n      pragma Import (C, Set_Item_Init, \"set_item_init\");\n\n   begin\n      Eti_Exception (Set_Item_Init (Men, Proc));\n   end Set_Item_Init_Hook;\n\n   procedure Set_Item_Term_Hook (Men  : Menu;\n                                 Proc : Menu_Hook_Function)\n   is\n      function Set_Item_Term (Men  : Menu;\n                              Proc : Menu_Hook_Function) return Eti_Error;\n      pragma Import (C, Set_Item_Term, \"set_item_term\");\n\n   begin\n      Eti_Exception (Set_Item_Term (Men, Proc));\n   end Set_Item_Term_Hook;\n\n   procedure Set_Menu_Init_Hook (Men  : Menu;\n                                 Proc : Menu_Hook_Function)\n   is\n      function Set_Menu_Init (Men  : Menu;\n                              Proc : Menu_Hook_Function) return Eti_Error;\n      pragma Import (C, Set_Menu_Init, \"set_menu_init\");\n\n   begin\n      Eti_Exception (Set_Menu_Init (Men, Proc));\n   end Set_Menu_Init_Hook;\n\n   procedure Set_Menu_Term_Hook (Men  : Menu;\n                                 Proc : Menu_Hook_Function)\n   is\n      function Set_Menu_Term (Men  : Menu;\n                              Proc : Menu_Hook_Function) return Eti_Error;\n      pragma Import (C, Set_Menu_Term, \"set_menu_term\");\n\n   begin\n      Eti_Exception (Set_Menu_Term (Men, Proc));\n   end Set_Menu_Term_Hook;\n\n   function Get_Item_Init_Hook (Men : Menu) return Menu_Hook_Function\n   is\n      function Item_Init (Men : Menu) return Menu_Hook_Function;\n      pragma Import (C, Item_Init, \"item_init\");\n   begin\n      return Item_Init (Men);\n   end Get_Item_Init_Hook;\n\n   function Get_Item_Term_Hook (Men : Menu) return Menu_Hook_Function\n   is\n      function Item_Term (Men : Menu) return Menu_Hook_Function;\n      pragma Import (C, Item_Term, \"item_term\");\n   begin\n      return Item_Term (Men);\n   end Get_Item_Term_Hook;\n\n   function Get_Menu_Init_Hook (Men : Menu) return Menu_Hook_Function\n   is\n      function Menu_Init (Men : Menu) return Menu_Hook_Function;\n      pragma Import (C, Menu_Init, \"menu_init\");\n   begin\n      return Menu_Init (Men);\n   end Get_Menu_Init_Hook;\n\n   function Get_Menu_Term_Hook (Men : Menu) return Menu_Hook_Function\n   is\n      function Menu_Term (Men : Menu) return Menu_Hook_Function;\n      pragma Import (C, Menu_Term, \"menu_term\");\n   begin\n      return Menu_Term (Men);\n   end Get_Menu_Term_Hook;\n-------------------------------------------------------------------------------\n   procedure Redefine (Men   : Menu;\n                       Items : Item_Array_Access)\n   is\n      function Set_Items (Men   : Menu;\n                          Items : System.Address) return Eti_Error;\n      pragma Import (C, Set_Items, \"set_menu_items\");\n\n   begin\n      pragma Assert (Items.all (Items'Last) = Null_Item);\n      if Items.all (Items'Last) /= Null_Item then\n         raise Menu_Exception;\n      else\n         Eti_Exception (Set_Items (Men, Items.all'Address));\n      end if;\n   end Redefine;\n\n   function Item_Count (Men : Menu) return Natural\n   is\n      function Count (Men : Menu) return C_Int;\n      pragma Import (C, Count, \"item_count\");\n   begin\n      return Natural (Count (Men));\n   end Item_Count;\n\n   function Items (Men   : Menu;\n                   Index : Positive) return Item\n   is\n      use I_Array;\n\n      function C_Mitems (Men : Menu) return Pointer;\n      pragma Import (C, C_Mitems, \"menu_items\");\n\n      P : Pointer := C_Mitems (Men);\n   begin\n      if P = null or else Index > Item_Count (Men) then\n         raise Menu_Exception;\n      else\n         P := P + ptrdiff_t (C_Int (Index) - 1);\n         return P.all;\n      end if;\n   end Items;\n\n-------------------------------------------------------------------------------\n   function Create (Items : Item_Array_Access) return Menu\n   is\n      function Newmenu (Items : System.Address) return Menu;\n      pragma Import (C, Newmenu, \"new_menu\");\n\n      M   : Menu;\n   begin\n      pragma Assert (Items.all (Items'Last) = Null_Item);\n      if Items.all (Items'Last) /= Null_Item then\n         raise Menu_Exception;\n      else\n         M := Newmenu (Items.all'Address);\n         if M = Null_Menu then\n            raise Menu_Exception;\n         end if;\n         return M;\n      end if;\n   end Create;\n\n   procedure Delete (Men : in out Menu)\n   is\n      function Free (Men : Menu) return Eti_Error;\n      pragma Import (C, Free, \"free_menu\");\n\n   begin\n      Eti_Exception (Free (Men));\n      Men := Null_Menu;\n   end Delete;\n\n------------------------------------------------------------------------------\n   function Driver (Men : Menu;\n                    Key : Key_Code) return Driver_Result\n   is\n      function Driver (Men : Menu;\n                       Key : C_Int) return Eti_Error;\n      pragma Import (C, Driver, \"menu_driver\");\n\n      R : constant Eti_Error := Driver (Men, C_Int (Key));\n   begin\n      case R is\n         when E_Unknown_Command =>\n            return Unknown_Request;\n         when E_No_Match =>\n            return No_Match;\n         when E_Request_Denied | E_Not_Selectable =>\n            return Request_Denied;\n         when others =>\n            Eti_Exception (R);\n            return Menu_Ok;\n      end case;\n   end Driver;\n\n   procedure Free (IA         : in out Item_Array_Access;\n                   Free_Items : Boolean := False)\n   is\n      procedure Release is new Ada.Unchecked_Deallocation\n        (Item_Array, Item_Array_Access);\n   begin\n      if IA /= null and then Free_Items then\n         for I in IA'First .. (IA'Last - 1) loop\n            if IA.all (I) /= Null_Item then\n               Delete (IA.all (I));\n            end if;\n         end loop;\n      end if;\n      Release (IA);\n   end Free;\n\n-------------------------------------------------------------------------------\n   function Default_Menu_Options return Menu_Option_Set\n   is\n   begin\n      return Get_Options (Null_Menu);\n   end Default_Menu_Options;\n\n   function Default_Item_Options return Item_Option_Set\n   is\n   begin\n      return Get_Options (Null_Item);\n   end Default_Item_Options;\n-------------------------------------------------------------------------------\n\nend Terminal_Interface.Curses.Menus;\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}