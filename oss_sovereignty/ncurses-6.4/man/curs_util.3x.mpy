{
  "module_name": "curs_util.3x",
  "hash_id": "25a823c101a250dc77e76665c325320b71a18688283c173e5d96ee6426e88201",
  "original_prompt": "Ingested from ncurses-6.4/man/curs_util.3x",
  "human_readable_source": "'\\\" t\n.\\\"***************************************************************************\n.\\\" Copyright 2018-2021,2022 Thomas E. Dickey                                *\n.\\\" Copyright 1998-2015,2017 Free Software Foundation, Inc.                  *\n.\\\"                                                                          *\n.\\\" Permission is hereby granted, free of charge, to any person obtaining a  *\n.\\\" copy of this software and associated documentation files (the            *\n.\\\" \"Software\"), to deal in the Software without restriction, including      *\n.\\\" without limitation the rights to use, copy, modify, merge, publish,      *\n.\\\" distribute, distribute with modifications, sublicense, and/or sell       *\n.\\\" copies of the Software, and to permit persons to whom the Software is    *\n.\\\" furnished to do so, subject to the following conditions:                 *\n.\\\"                                                                          *\n.\\\" The above copyright notice and this permission notice shall be included  *\n.\\\" in all copies or substantial portions of the Software.                   *\n.\\\"                                                                          *\n.\\\" THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  *\n.\\\" OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               *\n.\\\" MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   *\n.\\\" IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   *\n.\\\" DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    *\n.\\\" OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    *\n.\\\" THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               *\n.\\\"                                                                          *\n.\\\" Except as contained in this notice, the name(s) of the above copyright   *\n.\\\" holders shall not be used in advertising or otherwise to promote the     *\n.\\\" sale, use or other dealings in this Software without prior written       *\n.\\\" authorization.                                                           *\n.\\\"***************************************************************************\n.\\\"\n.\\\" $Id: curs_util.3x,v 1.65 2022/02/12 20:06:41 tom Exp $\n.TH curs_util 3X \"\"\n.ie \\n(.g .ds `` \\(lq\n.el       .ds `` ``\n.ie \\n(.g .ds '' \\(rq\n.el       .ds '' ''\n.de bP\n.ie n  .IP \\(bu 4\n.el    .IP \\(bu 2\n..\n.na\n.hy 0\n.SH NAME\n\\fBdelay_output\\fP,\n\\fBfilter\\fP,\n\\fBflushinp\\fP,\n\\fBgetwin\\fP,\n\\fBkey_name\\fP,\n\\fBkeyname\\fP,\n\\fBnofilter\\fP,\n\\fBputwin\\fP,\n\\fBunctrl\\fP,\n\\fBuse_env\\fP,\n\\fBuse_tioctl\\fP,\n\\fBwunctrl\\fP \\- miscellaneous \\fBcurses\\fP utility routines\n.ad\n.hy\n.SH SYNOPSIS\n\\fB#include <curses.h>\\fP\n.sp\n\\fBconst char *unctrl(chtype \\fIc\\fB);\\fR\n.br\n\\fBwchar_t *wunctrl(cchar_t *\\fIc\\fB);\\fR\n.sp\n\\fBconst char *keyname(int \\fIc\\fB);\\fR\n.br\n\\fBconst char *key_name(wchar_t \\fIw\\fB);\\fR\n.sp\n\\fBvoid filter(void);\\fP\n.br\n\\fBvoid nofilter(void);\\fP\n.sp\n\\fBvoid use_env(bool \\fIf\\fB);\\fR\n.br\n\\fBvoid use_tioctl(bool \\fIf\\fB);\\fR\n.sp\n\\fBint putwin(WINDOW *\\fIwin\\fB, FILE *\\fIfilep\\fB);\\fR\n.br\n\\fBWINDOW *getwin(FILE *\\fIfilep\\fB);\\fR\n.sp\n\\fBint delay_output(int \\fIms\\fB);\\fR\n.br\n\\fBint flushinp(void);\\fP\n.br\n.SH DESCRIPTION\n.SS unctrl\n.PP\nThe \\fBunctrl\\fP routine returns a character string which is a printable\nrepresentation of the character \\fIc\\fP, ignoring attributes.\nControl characters are displayed in the \\fB^\\fIX\\fR notation.\nPrinting characters are displayed as is.\nThe corresponding \\fBwunctrl\\fP returns a printable representation of\na wide character.\n.SS keyname/key_name\n.PP\nThe \\fBkeyname\\fP routine returns a character string\ncorresponding to the key \\fIc\\fP:\n.bP\nPrintable characters are displayed as themselves,\ne.g., a one-character string containing the key.\n.bP\nControl characters are displayed in the \\fB^\\fIX\\fR notation.\n.bP\nDEL (character 127) is displayed as \\fB^?\\fP.\n.bP\nValues above 128 are either meta characters\n(if the screen has not been initialized,\nor if \\fBmeta\\fP(3X) has been called with a \\fBTRUE\\fP parameter),\nshown in the \\fBM\\-\\fIX\\fR notation,\nor are displayed as themselves.\nIn the latter case, the values may not be printable;\nthis follows the X/Open specification.\n.bP\nValues above 256 may be the names of the names of function keys.\n.bP\nOtherwise (if there is no corresponding name) the function returns null,\nto denote an error.\nX/Open also lists an \\*(``UNKNOWN KEY\\*('' return value,\nwhich some implementations return rather than null.\n.LP\nThe corresponding \\fBkey_name\\fP returns a character string corresponding\nto the wide-character value \\fIw\\fP.\nThe two functions do not return the same set of strings;\nthe latter returns null where the former would display a meta character.\n.SS filter/nofilter\n.PP\nThe \\fBfilter\\fP routine, if used, must be called before \\fBinitscr\\fP or\n\\fBnewterm\\fP are called.\nCalling \\fBfilter\\fP causes these changes in initialization:\n.bP\n\\fBLINES\\fP is set to 1;\n.bP\nthe capabilities\n\\fBclear\\fP,\n\\fBcud1\\fP,\n\\fBcud\\fP,\n\\fBcup\\fP,\n\\fBcuu1\\fP,\n\\fBcuu\\fP,\n\\fBvpa\\fP\nare disabled;\n.bP\nthe capability \\fBed\\fP is disabled if \\fBbce\\fP is set;\n.bP\nand the \\fBhome\\fP string is set to the value of \\fBcr\\fP.\n.PP\nThe \\fBnofilter\\fP routine cancels the effect of a preceding \\fBfilter\\fP\ncall.\nThat allows the caller to initialize a screen on a different device,\nusing a different value of \\fB$TERM\\fP.\nThe limitation arises because the \\fBfilter\\fP routine modifies the\nin-memory copy of the terminal information.\n.SS use_env\n.PP\nThe \\fBuse_env\\fP routine, if used,\nshould be called before \\fBinitscr\\fP or\n\\fBnewterm\\fP are called\n(because those compute the screen size).\nIt modifies the way \\fBncurses\\fP treats environment variables\nwhen determining the screen size.\n.bP\nNormally \\fBncurses\\fP looks first at the terminal database for the screen size.\n.IP\nIf \\fBuse_env\\fP was called with \\fBFALSE\\fP for parameter,\nit stops here unless\n\\fBuse_tioctl\\fP was also called with \\fBTRUE\\fP for parameter.\n.bP\nThen it asks for the screen size via operating system calls.\nIf successful,\nit overrides the values from the terminal database.\n.bP\nFinally (unless \\fBuse_env\\fP was called with \\fBFALSE\\fP parameter),\n\\fBncurses\\fP examines the \\fBLINES\\fP or \\fBCOLUMNS\\fP environment variables,\nusing a value in those to override the results\nfrom the operating system or terminal database.\n.IP\n\\fBNcurses\\fP also updates the screen size in response to \\fBSIGWINCH\\fP,\nunless overridden by the \\fBLINES\\fP or \\fBCOLUMNS\\fP environment variables,\n.SS use_tioctl\n.PP\nThe \\fBuse_tioctl\\fP routine, if used,\nshould be called before \\fBinitscr\\fP or \\fBnewterm\\fP are called\n(because those compute the screen size).\nAfter \\fBuse_tioctl\\fP is called with \\fBTRUE\\fP as an argument,\n\\fBncurses\\fP modifies the last step in its computation\nof screen size as follows:\n.bP\nchecks if the \\fBLINES\\fP and \\fBCOLUMNS\\fP environment variables\nare set to a number greater than zero.\n.bP\nfor each, \\fBncurses\\fP updates the corresponding environment variable\nwith the value that it has obtained via operating system call\nor from the terminal database.\n.bP\n\\fBncurses\\fP re-fetches the value of the environment variables so that\nit is still the environment variables which set the screen size.\n.PP\nThe \\fBuse_env\\fP and \\fBuse_tioctl\\fP routines combine as\nsummarized here:\n.TS\ncenter tab(/);\nl l l\n_ _ _\nlw7 lw7 lw40.\n\\fBuse_env\\fP/\\fBuse_tioctl\\fP/\\fBSummary\\fP\nTRUE/FALSE/T{\nThis is the default behavior.\n\\fBncurses\\fP uses operating system calls\nunless overridden by $LINES or $COLUMNS environment variables.\nT}\nTRUE/TRUE/T{\n\\fBncurses\\fP updates $LINES and $COLUMNS based on operating system calls.\nT}\nFALSE/TRUE/T{\n\\fBncurses\\fP ignores $LINES and $COLUMNS,\nuses operating system calls to obtain size.\nT}\nFALSE/FALSE/T{\n\\fBncurses\\fP relies on the terminal database to determine size.\nT}\n.TE\n.SS putwin/getwin\n.PP\nThe \\fBputwin\\fP routine writes all data associated\nwith window (or pad) \\fIwin\\fP into\nthe file to which \\fIfilep\\fP points.\nThis information can be later retrieved\nusing the \\fBgetwin\\fP function.\n.PP\nThe \\fBgetwin\\fP routine reads window related data stored in the file by\n\\fBputwin\\fP.\nThe routine then creates and initializes a new window using that\ndata.\nIt returns a pointer to the new window.\nThere are a few caveats:\n.bP\nthe data written is a copy of the \\fBWINDOW\\fP structure,\nand its associated character cells.\nThe format differs between the wide-character (\\fBncursesw\\fP) and\nnon-wide (\\fBncurses\\fP) libraries.\nYou can transfer data between the two, however.\n.bP\nthe retrieved window is always created as a top-level window (or pad),\nrather than a subwindow.\n.bP\nthe window's character cells contain the color pair \\fIvalue\\fP,\nbut not the actual color \\fInumbers\\fP.\nIf cells in the retrieved window use color pairs which have not been\ncreated in the application using \\fBinit_pair\\fP,\nthey will not be colored when the window is refreshed.\n.SS delay_output\n.PP\nThe \\fBdelay_output\\fP routine inserts an \\fIms\\fP millisecond pause\nin output.\nThis routine should not be used extensively because\npadding characters are used rather than a CPU pause.\nIf no padding character is specified,\nthis uses \\fBnapms\\fP to perform the delay.\n.SS flushinp\n.PP\nThe \\fBflushinp\\fP routine throws away any typeahead that has been typed by the\nuser and has not yet been read by the program.\n.SH RETURN VALUE\nExcept for \\fBflushinp\\fP, routines that return an integer return \\fBERR\\fP\nupon failure and \\fBOK\\fP (SVr4 specifies only \"an integer value other than\n\\fBERR\\fP\") upon successful completion.\n.PP\nRoutines that return pointers return \\fBNULL\\fP on error.\n.PP\nX/Open does not define any error conditions.\nIn this implementation\n.RS 3\n.TP 5\n\\fBflushinp\\fP\nreturns an error if the terminal was not initialized.\n.TP 5\n\\fBputwin\\fP\nreturns an error if the associated \\fBfwrite\\fP calls return an error.\n.RE\n.SH PORTABILITY\n.SS filter\n.PP\nThe SVr4 documentation describes the action of \\fBfilter\\fP only in the vaguest\nterms.\nThe description here is adapted from the XSI Curses standard (which\nerroneously fails to describe the disabling of \\fBcuu\\fP).\n.SS keyname\n.PP\nThe \\fBkeyname\\fP function may return the names of user-defined\nstring capabilities which are defined in the terminfo entry via the \\fB\\-x\\fP\noption of \\fB@TIC@\\fP.\nThis implementation automatically assigns at run-time keycodes to\nuser-defined strings which begin with \\*(``k\\*(''.\nThe keycodes start at KEY_MAX, but are not guaranteed to be\nthe same value for different runs because user-defined codes are\nmerged from all terminal descriptions which have been loaded.\nThe \\fBuse_extended_names\\fP(3X) function controls whether this data is\nloaded when the terminal description is read by the library.\n.SS nofilter/use_tioctl\n.PP\nThe \\fBnofilter\\fP and \\fBuse_tioctl\\fP routines are specific to \\fBncurses\\fP.\nThey were not supported on Version 7, BSD or System V implementations.\nIt is recommended that any code depending on \\fBncurses\\fP extensions\nbe conditioned using NCURSES_VERSION.\n.SS putwin/getwin file-format\n.PP\nThe \\fBputwin\\fP and \\fBgetwin\\fP functions have several issues with\nportability:\n.bP\nThe files written and read by these functions\nuse an implementation-specific format.\nAlthough the format is an obvious target for standardization,\nit has been overlooked.\n.IP\nInterestingly enough, according to the copyright dates in Solaris source,\nthe functions (along with \\fBscr_init\\fP, etc.) originated with\nthe University of California, Berkeley (in 1982)\nand were later (in 1988) incorporated into SVr4.\nOddly, there are no such functions in the 4.3BSD curses sources.\n.bP\nMost implementations simply dump the binary \\fBWINDOW\\fP structure to the file.\nThese include SVr4 curses, NetBSD and PDCurses,\nas well as older \\fBncurses\\fP versions.\nThis implementation\n(as well as the X/Open variant of Solaris curses, dated 1995)\nuses textual dumps.\n.IP\nThe implementations which use binary dumps use block-I/O\n(the \\fBfwrite\\fP and \\fBfread\\fP functions).\nThose that use textual dumps use buffered-I/O.\nA few applications may happen to write extra data in the file using\nthese functions.\nDoing that can run into problems mixing block- and buffered-I/O.\nThis implementation reduces the problem on writes by flushing the output.\nHowever, reading from a file written using mixed schemes may not be successful.\n.SS unctrl/wunctrl\n.PP\nThe XSI Curses standard, Issue 4 describes these functions.\nIt states that \\fBunctrl\\fP and \\fBwunctrl\\fP will return a null pointer if\nunsuccessful, but does not define any error conditions.\nThis implementation checks for three cases:\n.bP\nthe parameter is a 7-bit US\\-ASCII code.\nThis is the case that X/Open Curses documented.\n.bP\nthe parameter is in the range 128\\-159, i.e., a C1 control code.\nIf \\fBuse_legacy_coding\\fP(3X) has been called with a \\fB2\\fP parameter,\n\\fBunctrl\\fP returns the parameter, i.e., a one-character string with\nthe parameter as the first character.\nOtherwise, it returns \\*(``~@\\*('', \\*(``~A\\*('', etc.,\nanalogous to \\*(``^@\\*('', \\*(``^A\\*('', C0 controls.\n.IP\nX/Open Curses does not document whether \\fBunctrl\\fP can be called before\ninitializing curses.\nThis implementation permits that,\nand returns the \\*(``~@\\*('', etc., values in that case.\n.bP\nparameter values outside the 0 to 255 range.\n\\fBunctrl\\fP returns a null pointer.\n.PP\nThe strings returned by \\fBunctrl\\fP in this implementation are determined\nat compile time,\nshowing C1 controls from the upper-128 codes\nwith a \\*(``~\\*('' prefix rather than \\*(``^\\*(''.\nOther implementations have different conventions.\nFor example, they may show both sets of control characters with \\*(``^\\*('',\nand strip the parameter to 7 bits.\nOr they may ignore C1 controls and treat all of the upper-128 codes as\nprintable.\nThis implementation uses 8 bits but does not modify the string to reflect\nlocale.\nThe \\fBuse_legacy_coding\\fP(3X) function allows the caller to\nchange the output of \\fBunctrl\\fP.\n.PP\nLikewise, the \\fBmeta\\fP(3X) function allows the caller to change the\noutput of \\fBkeyname\\fP, i.e.,\nit determines whether to use the \\*(``M\\-\\*('' prefix\nfor \\*(``meta\\*('' keys (codes in the range 128 to 255).\nBoth \\fBuse_legacy_coding\\fP(3X) and \\fBmeta\\fP(3X) succeed only after\ncurses is initialized.\nX/Open Curses does not document the treatment of codes 128 to 159.\nWhen treating them as \\*(``meta\\*('' keys\n(or if \\fBkeyname\\fP is called before initializing curses),\nthis implementation returns strings \\*(``M\\-^@\\*('', \\*(``M\\-^A\\*('', etc.\n.PP\nX/Open Curses documents \\fBunctrl\\fP as declared in \\fB<unctrl.h>\\fP,\nwhich \\fBncurses\\fP does.\nHowever, \\fBncurses\\fP' \\fB<curses.h>\\fP includes \\fB<unctrl.h>\\fP,\nmatching the behavior of SVr4 curses.\nOther implementations may not do that.\n.SS use_env/use_tioctl\n.PP\nIf \\fBncurses\\fP is configured to provide the sp-functions extension,\nthe state of \\fBuse_env\\fP and \\fBuse_tioctl\\fP may be updated before\ncreating each \\fIscreen\\fP rather than once only\n(\\fBcurs_sp_funcs\\fP(3X)).\nThis feature of \\fBuse_env\\fP\nis not provided by other implementation of curses.\n.SH SEE ALSO\n\\fBcurses\\fP(3X),\n\\fBcurs_initscr\\fP(3X),\n\\fBcurs_inopts\\fP(3X),\n\\fBcurs_kernel\\fP(3X),\n\\fBcurs_scr_dump\\fP(3X),\n\\fBcurs_sp_funcs\\fP(3X),\n\\fBcurs_variables\\fP(3X),\n\\fBlegacy_coding\\fP(3X).\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}