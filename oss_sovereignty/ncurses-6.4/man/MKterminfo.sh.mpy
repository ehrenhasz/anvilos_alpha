{
  "module_name": "MKterminfo.sh",
  "hash_id": "9c364f44d1242788fc1fdec5fb1f2e622e710b30160b342036db2a541cdb6cb3",
  "original_prompt": "Ingested from ncurses-6.4/man/MKterminfo.sh",
  "human_readable_source": "#!/bin/sh\n# $Id: MKterminfo.sh,v 1.19 2022/07/16 17:55:20 tom Exp $\n#\n# MKterminfo.sh -- generate terminfo.5 from Caps tabular data\n#\n#***************************************************************************\n# Copyright 2018-2020,2022 Thomas E. Dickey                                *\n# Copyright 1998-2003,2017 Free Software Foundation, Inc.                  *\n#                                                                          *\n# Permission is hereby granted, free of charge, to any person obtaining a  *\n# copy of this software and associated documentation files (the            *\n# \"Software\"), to deal in the Software without restriction, including      *\n# without limitation the rights to use, copy, modify, merge, publish,      *\n# distribute, distribute with modifications, sublicense, and/or sell       *\n# copies of the Software, and to permit persons to whom the Software is    *\n# furnished to do so, subject to the following conditions:                 *\n#                                                                          *\n# The above copyright notice and this permission notice shall be included  *\n# in all copies or substantial portions of the Software.                   *\n#                                                                          *\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  *\n# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               *\n# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   *\n# IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   *\n# DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    *\n# OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    *\n# THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               *\n#                                                                          *\n# Except as contained in this notice, the name(s) of the above copyright   *\n# holders shall not be used in advertising or otherwise to promote the     *\n# sale, use or other dealings in this Software without prior written       *\n# authorization.                                                           *\n#***************************************************************************\n#\n# This script takes terminfo.head and terminfo.tail and splices in between\n# them a table derived from the Caps data file.  Besides avoiding having\n# the docs fall out of sync with the table, this also lets us set up tbl\n# commands for better formatting of the table.\n#\n# NOTE: The \u0005s in this script really are control characters.  It translates\n# \u0005 to \\n because I couldn't get used to inserting linefeeds directly.  There\n# had better be no \u0005s in the table source text.\n#\n# keep the order independent of locale:\nif test \"${LANGUAGE+set}\"    = set; then LANGUAGE=C;    export LANGUAGE;    fi\nif test \"${LANG+set}\"        = set; then LANG=C;        export LANG;        fi\nif test \"${LC_ALL+set}\"      = set; then LC_ALL=C;      export LC_ALL;      fi\nif test \"${LC_MESSAGES+set}\" = set; then LC_MESSAGES=C; export LC_MESSAGES; fi\nif test \"${LC_CTYPE+set}\"    = set; then LC_CTYPE=C;    export LC_CTYPE;    fi\nif test \"${LC_COLLATE+set}\"  = set; then LC_COLLATE=C;  export LC_COLLATE;  fi\n\n#\nhead=\"$1\"\nshift 1\ncaps=\nwhile test $# -gt 1\ndo\n\tcaps=\"$caps $1\"\n\tshift 1\ndone\ntail=\"$1\"\ncat <<EOF\n'\\\\\" t\n.\\\\\" DO NOT EDIT THIS FILE BY HAND!\n.\\\\\" It is generated from terminfo.head, $caps, and terminfo.tail.\n.\\\\\"\n.\\\\\" Note: this must be run through tbl before nroff.\n.\\\\\" The magic cookie on the first line triggers this under some man programs.\nEOF\ncat \"$head\"\n\ntemp=temp$$\nsorted=sorted$$\nunsorted=unsorted$$\ntrap 'code=$?; rm -f $sorted $temp $unsorted; exit $code' EXIT HUP INT QUIT TERM\nrm -f $sorted $temp $unsorted\n\ncat $caps | sed -n \"\\\n/%%-STOP-HERE-%%/q\n/^#%center/s, expand,,\n/^#%lw25/s, lw6 , lw7 ,\n/^#%/s/#%//p\n/^#/d\ns/[\t][\t]*/\t/g\ns/$/\u0005T}/\ns/\t[A-Z0-9_()\\-][A-Z0-9_()\\-]*\t[0-9\\-][0-9\\-]*\t[Y\\-][B\\-][C\\-][G\\-][EK\\-]\\**\t/\tT{\u0005/\ns/\tbool\t/\t/p\ns/\tnum\t/\t/p\ns/\tstr\t/\t/p\n\" |sed -e 's/^$/../' | tr \"\\134\" \"\\006\" >$unsorted\n\nrm -f $sorted\nrm -f $temp\nsaved=no\nwhile true\ndo\n\tdata=\n\tread data\n\ttest -z \"$data\" && break\n\tcase \"$data\" in #(vi\n\t*\u0005*) #(vi\n\t\techo \"$data\" >>$temp\n\t\tsaved=yes\n\t\t;;\n\t*)\n\t\tif test $saved = yes ; then\n\t\t\tsaved=no\n\t\t\tsort $temp >>$sorted\n\t\t\trm -f $temp\n\t\tfi\n\t\techo \"$data\" >>$sorted\n\t\t;;\n\tesac\ndone <$unsorted\ntest $saved = yes && sort $temp >>$sorted\n\nsed -e 's/^\\.\\.$//' $sorted | tr \"\\005\\006\" \"\\012\\134\"\n\nsed\t-e '/^center expand;/s, expand,,' \\\n\t-e '/^\\.TS/,/^\\\\/s, lw[1-9][0-9]*\\., l.,' \\\n\t\"$tail\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}