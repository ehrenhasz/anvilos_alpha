{
  "module_name": "scr_dump.5",
  "hash_id": "dc0fc82cb68d399f30b9ac44cef23fc6bc9ddafed7d8647ac5777aa80c17c750",
  "original_prompt": "Ingested from ncurses-6.4/man/scr_dump.5",
  "human_readable_source": ".\\\"***************************************************************************\n.\\\" Copyright 2018-2020,2021 Thomas E. Dickey                                *\n.\\\" Copyright 2017 Free Software Foundation, Inc.                            *\n.\\\"                                                                          *\n.\\\" Permission is hereby granted, free of charge, to any person obtaining a  *\n.\\\" copy of this software and associated documentation files (the            *\n.\\\" \"Software\"), to deal in the Software without restriction, including      *\n.\\\" without limitation the rights to use, copy, modify, merge, publish,      *\n.\\\" distribute, distribute with modifications, sublicense, and/or sell       *\n.\\\" copies of the Software, and to permit persons to whom the Software is    *\n.\\\" furnished to do so, subject to the following conditions:                 *\n.\\\"                                                                          *\n.\\\" The above copyright notice and this permission notice shall be included  *\n.\\\" in all copies or substantial portions of the Software.                   *\n.\\\"                                                                          *\n.\\\" THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS  *\n.\\\" OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               *\n.\\\" MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   *\n.\\\" IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   *\n.\\\" DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    *\n.\\\" OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    *\n.\\\" THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               *\n.\\\"                                                                          *\n.\\\" Except as contained in this notice, the name(s) of the above copyright   *\n.\\\" holders shall not be used in advertising or otherwise to promote the     *\n.\\\" sale, use or other dealings in this Software without prior written       *\n.\\\" authorization.                                                           *\n.\\\"***************************************************************************\n.\\\"\n.\\\" $Id: scr_dump.5,v 1.20 2021/12/25 21:13:38 tom Exp $\n.TH scr_dump 5\n.ie \\n(.g .ds `` \\(lq\n.el       .ds `` ``\n.ie \\n(.g .ds '' \\(rq\n.el       .ds '' ''\n.de NS\n.ie n  .sp\n.el    .sp .5\n.ie n  .in +4\n.el    .in +2\n.nf\n.ft C\t\t\t\\\" Courier\n..\n.de NE\n.fi\n.ft R\n.ie n  .in -4\n.el    .in -2\n..\n.de bP\n.ie n  .IP \\(bu 4\n.el    .IP \\(bu 2\n..\n.SH NAME\nscr_dump \\- format of curses screen-dumps.\n.SH SYNOPSIS\n.B scr_dump\n.SH DESCRIPTION\n.PP\nThe curses library provides applications with the ability to write the\ncontents of a window to an external file using \\fBscr_dump\\fP or \\fBputwin\\fP,\nand read it back using \\fBscr_restore\\fP or \\fBgetwin\\fP.\n.PP\nThe \\fBputwin\\fP and \\fBgetwin\\fP functions do the work;\nwhile \\fBscr_dump\\fP and \\fBscr_restore\\fP conveniently save and restore\nthe whole screen, i.e., \\fBstdscr\\fP.\n.SS ncurses6\n.PP\nA longstanding implementation of screen-dump was\nrevised with ncurses6 to remedy problems with the earlier approach:\n.bP\nA \\*(``magic number\\*('' is written to the beginning of the dump file,\nallowing applications (such as \\fBfile\\fP(1)) to recognize curses dump files.\n.IP\nBecause ncurses6 uses a new format,\nthat requires a new magic number\nwas unused by other applications.\nThis 16-bit number was unused:\n.NS\n0x8888 (octal \\*(``\\\\210\\\\210\\*('')\n.NE\n.IP\nbut to be more certain, this 32-bit number was chosen:\n.NS\n0x88888888 (octal \\*(``\\\\210\\\\210\\\\210\\\\210\\*('')\n.NE\n.IP\nThis is the pattern submitted to the maintainers of the \\fBfile\\fP program:\n.NS\n#\n# ncurses5 (and before) did not use a magic number,\n# making screen dumps \"data\".\n#\n# ncurses6 (2015) uses this format, ignoring byte-order\n0    string    \\\\210\\\\210\\\\210\\\\210ncurses    ncurses6 screen image\n#\n.NE\n.bP\nThe screen dumps are written in textual form,\nso that internal data sizes are not directly related to the dump-format, and\nenabling the library to read dumps from either narrow- or wide-character-\nconfigurations.\n.IP\nThe \\fInarrow\\fP library configuration holds characters and video attributes\nin a 32-bit \\fBchtype\\fP, while the \\fIwide-character\\fP library stores\nthis information in the \\fBcchar_t\\fP structure, which is much larger than\n32-bits.\n.bP\nIt is possible to read a screen dump into a terminal with a different\nscreen-size,\nbecause the library truncates or fills the screen as necessary.\n.bP\nThe ncurses6 \\fBgetwin\\fP reads the legacy screen dumps from ncurses5.\n.SS ncurses5 (legacy)\n.PP\nThe screen-dump feature was added to ncurses in June 1995.\nWhile there were fixes and improvements in succeeding years,\nthe basic scheme was unchanged:\n.bP\nThe \\fBWINDOW\\fP structure was written in binary form.\n.bP\nThe \\fBWINDOW\\fP structure refers to lines of data,\nwhich were written as an array of binary data following the \\fBWINDOW\\fP.\n.bP\nWhen \\fBgetwin\\fP restored the window,\nit would keep track of offsets into the array of line-data\nand adjust the \\fBWINDOW\\fP structure which was read back into memory.\n.PP\nThis is similar to Unix SystemV,\nbut does not write a \\*(``magic number\\*('' to identify the file format.\n.SH PORTABILITY\n.PP\nThere is no standard format for \\fBputwin\\fP.\nThis section gives a brief description of the existing formats.\n.SS X/Open Curses\n.PP\nRefer to \\fIX/Open Curses, Issue 7\\fP (2009).\n.PP\nX/Open's documentation for \\fIenhanced curses\\fP says only:\n.RS 3\n.PP\nThe \\fBgetwin(\\ ) \\fPfunction reads window-related data\nstored in the file by \\fIputwin(\\ )\\fP.\nThe function\nthen creates and initializes a new window using that data.\n.PP\nThe \\fBputwin(\\ )\\fP function writes all data associated\nwith \\fIwin\\fP into the \\fBstdio\\fP(3) stream to which \\fIfilep\\fP\npoints, using an \\fBunspecified format\\fP.\nThis information can be retrieved later using \\fBgetwin(\\ )\\fP.\n.RE\n.PP\nIn the mid-1990s when the X/Open Curses document was written,\nthere were still systems using older, less capable curses libraries\n(aside from the BSD curses library which was not relevant to X/Open\nbecause it did not meet the criteria for \\fIbase curses\\fP).\nThe document explained the term \\*(``enhanced\\*('' as follows:\n.RS 3\n.bP\nShading is used to identify \\fIX/Open Enhanced Curses\\fP material,\nrelating to interfaces included to provide enhanced capabilities\nfor applications originally written to be compiled on systems\nbased on the UNIX operating system.\nTherefore, the features described may not be present on systems\nthat conform to \\fBXPG4 or to earlier XPG releases\\fP.\nThe relevant reference pages may provide additional\nor more specific portability warnings about use of the material.\n.RE\n.PP\nIn the foregoing, emphasis was added to \\fBunspecified format\\fP\nand to \\fBXPG4 or to earlier XPG releases\\fP,\nfor clarity.\n.SS Unix SystemV\n.PP\nUnix SystemV curses identified the file format by writing a\n\\*(``magic number\\*('' at the beginning of the dump.\nThe \\fBWINDOW\\fP data and the lines of text follow, all in binary form.\n.PP\nThe Solaris curses source has these definitions:\n.NS\n/* terminfo magic number */\n#define MAGNUM  0432\n\n/* curses screen dump magic number */\n#define SVR2_DUMP_MAGIC_NUMBER  0433\n#define SVR3_DUMP_MAGIC_NUMBER  0434\n.NE\n.PP\nThat is, the feature was likely introduced in SVr2 (1984),\nand improved in SVr3 (1987).\nThe Solaris curses source has no magic number for SVr4 (1989).\nOther operating systems (AIX and HPUX) use a magic number which would\ncorrespond to this definition:\n.NS\n/* curses screen dump magic number */\n#define SVR4_DUMP_MAGIC_NUMBER  0435\n.NE\n.PP\nThat octal number in bytes is 001, 035.\nBecause most Unix vendors use big-endian hardware,\nthe magic number is written with the high-order byte first, e.g.,\n.NS\n\\001\\035\n.NE\n.PP\nAfter the magic number, the \\fBWINDOW\\fP structure and line-data are\nwritten in binary format.\nWhile the magic number used by the Unix systems can be seen using \\fBod\\fP(1),\nnone of the Unix systems documents the format used for screen-dumps.\n.PP\nThe Unix systems do not use identical formats.\nWhile collecting information for for this manual page,\nthe \\fIsavescreen\\fP test-program\nproduced dumps of different size\n(all on 64-bit hardware, on 40x80 screens):\n.bP\nAIX (51817 bytes)\n.bP\nHPUX (90093 bytes)\n.bP\nSolaris 10 (13273 bytes)\n.bP\nncurses5 (12888 bytes)\n.SS Solaris\n.PP\nAs noted above, Solaris curses has no magic number corresponding\nto SVr4 curses.\nThis is odd since Solaris was the first operating system\nto pass the SVr4 guidelines.\nSolaris has two versions of curses:\n.bP\nThe default curses library uses the SVr3 magic number.\n.bP\nThere is an alternate curses library in \\fB/usr/xpg4\\fP.\nThis uses a textual format with no magic number.\n.IP\nAccording to the copyright notice, the \\fIxpg4\\fP Solaris curses library was\ndeveloped by MKS (Mortice Kern Systems) from 1990 to 1995.\n.IP\nLike ncurses6, there is a file-header with parameters.\nUnlike ncurses6, the contents of the window are written piecemeal,\nwith coordinates and attributes for each chunk of text rather\nthan writing the whole window from top to bottom.\n.SS PDCurses\n.PP\nPDCurses added support for screen dumps in version 2.7 (2005).\nLike Unix SystemV and ncurses5,\nit writes the \\fBWINDOW\\fP structure in binary,\nbut begins the file with its three-byte identifier \\*(``PDC\\*('',\nfollowed by a one-byte version,\ne.g.,\n.NS\n\t\\*(``PDC\\\\001\\*(''\n.NE\n.SS NetBSD\n.PP\nAs of April 2017, NetBSD curses does\nnot support \\fBscr_dump\\fP and \\fBscr_restore\\fP\n(or \\fBscr_init\\fP, \\fBscr_set\\fP),\nalthough it has \\fBputwin\\fP and \\fBgetwin\\fP.\n.PP\nLike ncurses5, NetBSD \\fBputwin\\fP does not identify its dumps with a\nuseful magic number.\nIt writes\n.bP\nthe curses shared library major and minor versions\nas the first two bytes (e.g., 7 and 1),\n.bP\nfollowed by a binary dump of the \\fBWINDOW\\fP,\n.bP\nsome data for wide-characters referenced by the \\fBWINDOW\\fP structure, and\n.bP\nfinally, lines as done by other implementations.\n.SH EXAMPLE\n.PP\nGiven a simple program which writes text to the screen\n(and for the sake of example, limiting the screen-size to 10x20):\n.NS\n#include <curses.h>\n\nint\nmain(void)\n{\n    putenv(\"LINES=10\");\n    putenv(\"COLUMNS=20\");\n    initscr();\n    start_color();\n    init_pair(1, COLOR_WHITE, COLOR_BLUE);\n    init_pair(2, COLOR_RED, COLOR_BLACK);\n    bkgd(COLOR_PAIR(1));\n    move(4, 5);\n    attron(A_BOLD);\n    addstr(\"Hello\");\n    move(5, 5);\n    attroff(A_BOLD);\n    attrset(A_REVERSE | COLOR_PAIR(2));\n    addstr(\"World!\");\n    refresh();\n    scr_dump(\"foo.out\");\n    endwin();\n    return 0;\n}\n.NE\n.PP\nWhen run using ncurses6, the output looks like this:\n.NS\n\\\\210\\\\210\\\\210\\\\210ncurses 6.0.20170415\n_cury=5\n_curx=11\n_maxy=9\n_maxx=19\n_flags=14\n_attrs=\\\\{REVERSE|C2}\nflag=_idcok\n_delay=-1\n_regbottom=9\n_bkgrnd=\\\\{NORMAL|C1}\\\\s\nrows:\n1:\\\\{NORMAL|C1}\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n2:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n3:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n4:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n5:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\{BOLD}Hello\\\\{NORMAL}\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n6:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\{REVERSE|C2}World!\\\\{NORMAL|C1}\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n7:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n8:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n9:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n10:\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\\\\s\n.NE\n.PP\nThe first four octal escapes are actually nonprinting characters,\nwhile the remainder of the file is printable text.\nYou may notice:\n.bP\nThe actual color pair values are not written to the file.\n.bP\nAll characters are shown in printable form; spaces are \\*(``\\\\s\\*('' to\nensure they are not overlooked.\n.bP\nAttributes are written in escaped curly braces, e.g., \\*(``\\\\{BOLD}\\*('',\nand may include a color-pair (C1 or C2 in this example).\n.bP\nThe parameters in the header are written out only if they are nonzero.\nWhen reading back, order does not matter.\n.ne 10\n.PP\nRunning the same program with Solaris \\fIxpg4\\fP curses gives this dump:\n.NS\nMAX=10,20\nBEG=0,0\nSCROLL=0,10\nVMIN=1\nVTIME=0\nFLAGS=0x1000\nFG=0,0\nBG=0,0,\n0,0,0,1,\n0,19,0,0,\n1,0,0,1,\n1,19,0,0,\n2,0,0,1,\n2,19,0,0,\n3,0,0,1,\n3,19,0,0,\n4,0,0,1,\n4,5,0x20,0,Hello\n4,10,0,1,\n4,19,0,0,\n5,0,0,1,\n5,5,0x4,2,World!\n5,11,0,1,\n5,19,0,0,\n6,0,0,1,\n6,19,0,0,\n7,0,0,1,\n7,19,0,0,\n8,0,0,1,\n8,19,0,0,\n9,0,0,1,\n9,19,0,0,\nCUR=11,5\n.NE\n.PP\nSolaris \\fBgetwin\\fP requires that all parameters are present, and\nin the same order.\nThe \\fIxpg4\\fP curses library does not know about the \\fBbce\\fP\n(back color erase) capability, and does not color the window background.\n.ne 10\n.PP\nOn the other hand, the SVr4 curses library does know about the background color.\nHowever, its screen dumps are in binary.\nHere is the corresponding dump (using \\*(``od -t x1\\*(''):\n.NS\n0000000 1c 01 c3 d6 f3 58 05 00 0b 00 0a 00 14 00 00 00\n0000020 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00\n0000040 00 00 b8 1a 06 08 cc 1a 06 08 00 00 09 00 10 00\n0000060 00 00 00 80 00 00 20 00 00 00 ff ff ff ff 00 00\n0000100 ff ff ff ff 00 00 00 00 20 80 00 00 20 80 00 00\n0000120 20 80 00 00 20 80 00 00 20 80 00 00 20 80 00 00\n*\n0000620 20 80 00 00 20 80 00 00 20 80 00 00 48 80 00 04\n0000640 65 80 00 04 6c 80 00 04 6c 80 00 04 6f 80 00 04\n0000660 20 80 00 00 20 80 00 00 20 80 00 00 20 80 00 00\n*\n0000740 20 80 00 00 20 80 00 00 20 80 00 00 57 00 81 00\n0000760 6f 00 81 00 72 00 81 00 6c 00 81 00 64 00 81 00\n0001000 21 00 81 00 20 80 00 00 20 80 00 00 20 80 00 00\n0001020 20 80 00 00 20 80 00 00 20 80 00 00 20 80 00 00\n*\n0001540 20 80 00 00 20 80 00 00 00 00 f6 d1 01 00 f6 d1\n0001560 08 00 00 00 40 00 00 00 00 00 00 00 00 00 00 07\n0001600 00 04 00 01 00 01 00 00 00 01 00 00 00 00 00 00\n0001620 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n*\n0002371\n.NE\n.SH SEE ALSO\n.PP\n\\fBcurs_scr_dump\\fP(3X),\n\\fBcurs_util\\fP(3X).\n.SH AUTHORS\n.PP\nThomas E. Dickey\n.br\nextended screen-dump format for ncurses 6.0 (2015)\n.sp\nEric S. Raymond\n.br\nscreen dump feature in ncurses 1.9.2d (1995)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}