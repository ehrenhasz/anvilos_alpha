{
  "module_name": "fty_int.c",
  "hash_id": "9cdcd8c48b71c03b13b6c7bd884b1660608b61c3db0b9110c9ec2409a8aeeedc",
  "original_prompt": "Ingested from ncurses-6.4/form/fty_int.c",
  "human_readable_source": " \n\n \n\n#include \"form.priv.h\"\n\nMODULE_ID(\"$Id: fty_int.c,v 1.33 2021/06/17 21:11:08 tom Exp $\")\n\n#if USE_WIDEC_SUPPORT\n#define isDigit(c) (iswdigit((wint_t)(c)) || isdigit(UChar(c)))\n#else\n#define isDigit(c) isdigit(UChar(c))\n#endif\n\n#define thisARG integerARG\n\ntypedef struct\n  {\n    int precision;\n    long low;\n    long high;\n  }\nthisARG;\n\ntypedef struct\n  {\n    int precision;\n    long low;\n    long high;\n  }\nintegerPARM;\n\n \nstatic void *\nGeneric_This_Type(void *arg)\n{\n  thisARG *argp = (thisARG *)0;\n  thisARG *param = (thisARG *)arg;\n\n  if (param)\n    {\n      argp = typeMalloc(thisARG, 1);\n\n      if (argp)\n\t{\n\t  T((T_CREATE(\"thisARG %p\"), (void *)argp));\n\t  *argp = *param;\n\t}\n    }\n  return (void *)argp;\n}\n\n \nstatic void *\nMake_This_Type(va_list *ap)\n{\n  thisARG arg;\n\n  arg.precision = va_arg(*ap, int);\n  arg.low = va_arg(*ap, long);\n  arg.high = va_arg(*ap, long);\n\n  return Generic_This_Type((void *)&arg);\n}\n\n \nstatic void *\nCopy_This_Type(const void *argp)\n{\n  const thisARG *ap = (const thisARG *)argp;\n  thisARG *result = (thisARG *)0;\n\n  if (argp)\n    {\n      result = typeMalloc(thisARG, 1);\n\n      if (result)\n\t{\n\t  T((T_CREATE(\"thisARG %p\"), (void *)result));\n\t  *result = *ap;\n\t}\n    }\n  return (void *)result;\n}\n\n \nstatic void\nFree_This_Type(void *argp)\n{\n  if (argp)\n    free(argp);\n}\n\n \nstatic bool\nCheck_This_Field(FIELD *field, const void *argp)\n{\n  const thisARG *argi = (const thisARG *)argp;\n  long low = argi->low;\n  long high = argi->high;\n  int prec = argi->precision;\n  unsigned char *bp = (unsigned char *)field_buffer(field, 0);\n  char *s = (char *)bp;\n  bool result = FALSE;\n\n  while (*bp == ' ')\n    bp++;\n  if (*bp)\n    {\n      if (*bp == '-')\n\tbp++;\n#if USE_WIDEC_SUPPORT\n      if (*bp)\n\t{\n\t  int len;\n\t  wchar_t *list = _nc_Widen_String((char *)bp, &len);\n\n\t  if (list != 0)\n\t    {\n\t      bool blank = FALSE;\n\t      int n;\n\n\t      result = TRUE;\n\t      for (n = 0; n < len; ++n)\n\t\t{\n\t\t  if (blank)\n\t\t    {\n\t\t      if (list[n] != ' ')\n\t\t\t{\n\t\t\t  result = FALSE;\n\t\t\t  break;\n\t\t\t}\n\t\t    }\n\t\t  else if (list[n] == ' ')\n\t\t    {\n\t\t      blank = TRUE;\n\t\t    }\n\t\t  else if (!isDigit(list[n]))\n\t\t    {\n\t\t      result = FALSE;\n\t\t      break;\n\t\t    }\n\t\t}\n\t      free(list);\n\t    }\n\t}\n#else\n      while (*bp)\n\t{\n\t  if (!isdigit(UChar(*bp)))\n\t    break;\n\t  bp++;\n\t}\n      while (*bp && *bp == ' ')\n\tbp++;\n      result = (*bp == '\\0');\n#endif\n      if (result)\n\t{\n\t  long val = atol(s);\n\n\t  if (low < high)\n\t    {\n\t      if (val < low || val > high)\n\t\tresult = FALSE;\n\t    }\n\t  if (result)\n\t    {\n\t      char buf[100];\n\n\t      _nc_SPRINTF(buf, _nc_SLIMIT(sizeof(buf))\n\t\t\t  \"%.*ld\", (prec > 0 ? prec : 0), val);\n\t      set_field_buffer(field, 0, buf);\n\t    }\n\t}\n    }\n  return (result);\n}\n\n \nstatic bool\nCheck_This_Character(int c, const void *argp GCC_UNUSED)\n{\n  return ((isDigit(UChar(c)) || (c == '-')) ? TRUE : FALSE);\n}\n\nstatic FIELDTYPE typeTHIS =\n{\n  _HAS_ARGS | _RESIDENT,\n  1,\t\t\t\t \n  (FIELDTYPE *)0,\n  (FIELDTYPE *)0,\n  Make_This_Type,\n  Copy_This_Type,\n  Free_This_Type,\n  INIT_FT_FUNC(Check_This_Field),\n  INIT_FT_FUNC(Check_This_Character),\n  INIT_FT_FUNC(NULL),\n  INIT_FT_FUNC(NULL),\n#if NCURSES_INTEROP_FUNCS\n  Generic_This_Type\n#endif\n};\n\nFORM_EXPORT_VAR(FIELDTYPE *) TYPE_INTEGER = &typeTHIS;\n\n#if NCURSES_INTEROP_FUNCS\n \nFORM_EXPORT(FIELDTYPE *)\n_nc_TYPE_INTEGER(void)\n{\n  return TYPE_INTEGER;\n}\n#endif\n\n \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}