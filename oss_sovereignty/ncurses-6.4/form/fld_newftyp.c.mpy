{
  "module_name": "fld_newftyp.c",
  "hash_id": "572b68358c0a15eeeb9b926fe828466edbdd0b0fbec9a0705890534a77a4f1b6",
  "original_prompt": "Ingested from ncurses-6.4/form/fld_newftyp.c",
  "human_readable_source": " \n\n \n\n#include \"form.priv.h\"\n\nMODULE_ID(\"$Id: fld_newftyp.c,v 1.23 2020/05/24 01:40:20 anonymous.maarten Exp $\")\n\nstatic FIELDTYPE default_fieldtype =\n{\n  0,\t\t\t\t \n  0L,\t\t\t\t \n  (FIELDTYPE *)0,\t\t \n  (FIELDTYPE *)0,\t\t \n  NULL,\t\t\t\t \n  NULL,\t\t\t\t \n  NULL,\t\t\t\t \n  INIT_FT_FUNC(NULL),\t\t \n  INIT_FT_FUNC(NULL),\t\t \n  INIT_FT_FUNC(NULL),\t\t \n  INIT_FT_FUNC(NULL),\t\t \n#if NCURSES_INTEROP_FUNCS\n  NULL\t\t\t\t \n#endif\n};\n\nFORM_EXPORT_VAR(FIELDTYPE *)\n  _nc_Default_FieldType = &default_fieldtype;\n\n \nFORM_EXPORT(FIELDTYPE *)\nnew_fieldtype(bool (*const field_check) (FIELD *, const void *),\n\t      bool (*const char_check) (int, const void *))\n{\n  FIELDTYPE *nftyp = (FIELDTYPE *)0;\n\n  TR_FUNC_BFR(2);\n\n  T((T_CALLED(\"new_fieldtype(%s,%s)\"),\n     TR_FUNC_ARG(0, field_check),\n     TR_FUNC_ARG(1, char_check)));\n\n  if ((field_check) || (char_check))\n    {\n      nftyp = typeMalloc(FIELDTYPE, 1);\n\n      if (nftyp)\n\t{\n\t  T((T_CREATE(\"fieldtype %p\"), (void *)nftyp));\n\t  *nftyp = default_fieldtype;\n#if NCURSES_INTEROP_FUNCS\n\t  nftyp->fieldcheck.ofcheck = field_check;\n\t  nftyp->charcheck.occheck = char_check;\n#else\n\t  nftyp->fcheck = field_check;\n\t  nftyp->ccheck = char_check;\n#endif\n\t}\n      else\n\t{\n\t  SET_ERROR(E_SYSTEM_ERROR);\n\t}\n    }\n  else\n    {\n      SET_ERROR(E_BAD_ARGUMENT);\n    }\n  returnFieldType(nftyp);\n}\n\n \nFORM_EXPORT(int)\nfree_fieldtype(FIELDTYPE *typ)\n{\n  T((T_CALLED(\"free_fieldtype(%p)\"), (void *)typ));\n\n  if (!typ)\n    RETURN(E_BAD_ARGUMENT);\n\n  if (typ->ref != 0)\n    RETURN(E_CONNECTED);\n\n  if (typ->status & _RESIDENT)\n    RETURN(E_CONNECTED);\n\n  if (typ->status & _LINKED_TYPE)\n    {\n      if (typ->left)\n\ttyp->left->ref--;\n      if (typ->right)\n\ttyp->right->ref--;\n    }\n  free(typ);\n  RETURN(E_OK);\n}\n\n \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}