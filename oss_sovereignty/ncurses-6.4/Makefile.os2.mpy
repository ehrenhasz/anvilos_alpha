{
  "module_name": "Makefile.os2",
  "hash_id": "68b246870b4c009611cdea05f10b7f0d103c35abbea18f2bd4fa33577e24579e",
  "original_prompt": "Ingested from ncurses-6.4/Makefile.os2",
  "human_readable_source": "##############################################################################\n# Copyright 2020,2021 Thomas E. Dickey                                       #\n# Copyright 1998-2000,2006 Free Software Foundation, Inc.                    #\n#                                                                            #\n# Permission is hereby granted, free of charge, to any person obtaining a    #\n# copy of this software and associated documentation files (the \"Software\"), #\n# to deal in the Software without restriction, including without limitation  #\n# the rights to use, copy, modify, merge, publish, distribute, distribute    #\n# with modifications, sublicense, and/or sell copies of the Software, and to #\n# permit persons to whom the Software is furnished to do so, subject to the  #\n# following conditions:                                                      #\n#                                                                            #\n# The above copyright notice and this permission notice shall be included in #\n# all copies or substantial portions of the Software.                        #\n#                                                                            #\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR #\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   #\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    #\n# THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER      #\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING    #\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER        #\n# DEALINGS IN THE SOFTWARE.                                                  #\n#                                                                            #\n# Except as contained in this notice, the name(s) of the above copyright     #\n# holders shall not be used in advertising or otherwise to promote the sale, #\n# use or other dealings in this Software without prior written               #\n# authorization.                                                             #\n################################################################################\n# $Id: Makefile.os2,v 1.13 2021/06/17 21:20:30 tom Exp $\n#\n# Wrapper Makefile for ncurses library under OS/2.\n# Author:  Juan Jose Garcia Ripoll <worm@arrakis.es>.\n# Webpage: http://www.arrakis.es/~worm/\n################################################################################\n#\n# Notes (from I Zakharevich)\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~\n# I could build the library with the following sequence of commands:\n#\n#   touch Makefile\n#   make -f Makefile.os2 config\n#   make -f Makefile.os2 CC=gcc HOSTCC=gcc CXX=gcc\n#\n# Ignoring the following errors:\n#   Invalid configuration `os2'...\n#   ... ac_maketemp=\"make\": not found\n#   ... syntax error: `done' unexpected\n#   No rule to make target `lib/ncurses4.dll'\n#\n# You may need to run\n#\n#   rm make.defs\n#   make -f Makefile.os2 make.defs\n#\n# if the build of misc/panel.def fails.\n#\n# If you do not have perl, the configuration will fail.  Use autoconf to\n# generate the EMX-specific configure script (see README.emx), and run the\n# configure script to generate the makefiles.  Then, run\n#\n#   make -f Makefile.os2 make.dlls\n#\n# Notes (from J J G Ripoll)\n# ~~~~~~~~~~~~~~~~~~~~~~~~~\n# The `make.defs' rule creates the new '.def' files and outputs a diagnostic\n# about symbols that disappear from one release to the other, as well as\n# checks about the new '.def' consistency.  If there were no problems, the\n# maintainer is free to replace the `.ref' files with the newer ones using the\n# `save.defs' rule.  So, the only tough work is ensuring that the symbols that\n# disappear are not essential.\n#\n# I first thought about killing '_nc_*' symbols, but it seems that some of\n# them --_nc_panel_hook, _nc_ada*, etc-- are needed outside ncurses.dll.\n# However, the whole size of the export table will not be larger than 1k or\n# so.\n#\n# [installation]\n#\n# The way things are handled in misc/Makefile is not well suited for OS/2,\n# where only emx.src is needed.  Thus, I've written a few wrapper rules in\n# Makefile.os2 that handle installation/deinstallation.\n#\n# [distribution]\n#\n# There's also a new rule that configures and builds a sort of binary\n# distribution, much like the one I prepared for 1.9.9e.  It's `os2dist'.\n#\n################################################################################\n\nall :: config\n\n# This is for configuring\n\n# What is a useful value for this?\nCONFIG_OPTS\t= --enable-termcap\nWWWGET\t\t= lynx -source\nMV_F\t\t= mv -f\nDLL_LN_OPTS\t= -Zcrtdll -Zdll -Zomf -Zmt\n\nconfig: config.cache\n\nconfig.cache: configure.cmd configure\n\t-$(MV_F) $@ $@.ref\n\tconfigure.cmd $(CONFIG_OPTS)\n\nconfigure.cmd: configure convert_configure.pl\n\tperl convert_configure.pl configure > $@\n\nconvert_configure.pl:\n\t$(WWWGET) ftp://ftp.math.ohio-state.edu/pub/users/ilya/os2/$@ > $@\n\ninstall ::\n\techo ***\n\techo *** Do not use this command. Use install.os2 instead.\n\techo ***\n\texit 2\n\ninstall.os2 : install.emxdata install.libs install.progs\n\ninclude ./Makefile\n\nall :: make.dlls\n\n#\n# DLLs and that stuff\n#\n\nLIBRARIES = ncurses form menu panel\n\nDLL_TAG = $(NCURSES_MAJOR)\nLIB_TAG = _s\n\nDLL_ROOTS = $(addsuffix $(DLL_TAG), $(LIBRARIES))\nDLLS = $(addsuffix .dll, $(addprefix ./lib/, $(DLL_ROOTS)))\n\nLIB_ROOTS = $(addsuffix $(LIB_TAG), $(LIBRARIES))\nLIBS = $(addsuffix .lib, $(addprefix ./lib/, $(LIB_ROOTS)))\n\nLIBS_AOUT = $(addsuffix .a, $(addprefix ./lib/, $(LIB_ROOTS)))\n\nDEFS = $(addsuffix .def, $(addprefix ./misc/, $(LIBRARIES)))\n\nDLL_SIGNATURE = NCurses-$(NCURSES_MAJOR)-$(NCURSES_MINOR)-$(NCURSES_PATCH)\n\n./lib/%$(LIB_TAG).lib : ./misc/%.def\n\temximp -o $@ $<\n\n./lib/%$(LIB_TAG).a : ./misc/%.def\n\temximp -o $@ $<\n\n./lib/%$(DLL_TAG).dll : ./lib/%.a\n\temxomf -o ./lib/$*$(DLL_TAG).lib $<\n\tif [ \"$*\" = \"ncurses\" ]; then \\\n\t\tgcc $(LDFLAGS) $(DLL_LN_OPTS) ./lib/$*$(DLL_TAG).lib \\\n\t\t\t\t./misc/$*.def -o $@; \\\n\telse \\\n\t\tgcc $(LDFLAGS) $(DLL_LN_OPTS) ./lib/$*$(DLL_TAG).lib \\\n\t\t\t\t./lib/ncurses$(LIB_TAG).lib ./misc/$*.def -o $@; \\\n\tfi\n\t-rm -f ./lib/$*$(DLL_TAG).lib\n\nmake.dlls : $(DEFS) $(LIBS) $(DLLS) $(LIBS_AOUT)\n\n$(DEFS) : make.defs\n\nLIBDIR\t= $(DESTDIR)$(libdir)\n$(LIBDIR) :\n\tmkdir -p $@\n\ninstall.libs :: $(LIBS) $(DLLS) $(LIBDIR)\n\t@for i in $(DLL_ROOTS); do \\\n\techo installing ./lib/$$i.dll as $(LIBDIR)/$$i.dll; \\\n\t$(INSTALL_DATA) ./lib/$$i.dll $(LIBDIR)/$$i.dll; done\n\t@for i in $(LIB_ROOTS); do \\\n\techo installing ./lib/$$i.lib as $(LIBDIR)/$$i.lib; \\\n\t$(INSTALL_DATA) ./lib/$$i.lib $(LIBDIR)/$$i.lib; done\n\nuninstall.libs ::\n\t-@for i in $(DLL_ROOTS); do \\\n\techo uninstalling $(LIBDIR)/$$i.dll; \\\n\trm -f $(LIBDIR)/$$i.dll; done\n\t-@for i in $(LIB_ROOTS); do \\\n\techo uninstalling $(LIBDIR)/$$i.lib; \\\n\trm -f $(LIBDIR)/$$i.lib; done\n\nmake.defs :\n\tfor i in $(LIBRARIES); do \\\n\techo LIBRARY $${i}$(DLL_TAG) INITINSTANCE TERMINSTANCE > ./misc/$$i.def; \\\n\techo DESCRIPTION \\\"$(DLL_SIGNATURE), module $$i\\\" >> ./misc/$$i.def; \\\n\techo CODE LOADONCALL >> ./misc/$$i.def; \\\n\techo DATA LOADONCALL NONSHARED MULTIPLE >> ./misc/$$i.def; \\\n\techo EXPORTS >> ./misc/$$i.def; \\\n\techo Creating $$i.def; \\\n\t(cmd /C \".\\\\misc\\\\makedef.cmd ./lib/$$i.a ./misc/$$i.ref >> ./misc/$$i.def\" \\\n\t && cmd /C \".\\\\misc\\\\chkdef.cmd ./misc/$$i.def\") \\\n\t|| exit 1; \\\n\tdone\n\ttouch make.defs\n\nsave.defs :\n\tfor i in $(LIBRARIES); do \\\n\ttest -f ./misc/$$i.def && cp ./misc/$$i.def ./misc/$$i.ref; \\\n\tdone\n\nclean \\\nos2clean ::\n\t-rm -f $(DLLS) $(LIBS)\n\nrealclean ::\n\t-rm -f $(addprefix ./misc/, $(addsuffix .def, $(LIBRARIES)))\n\n#\n# This is a simplified version of misc/Makefile\n#\n\nTICDIR = $(DESTDIR)$(datadir)/terminfo\nTABSETDIR = $(DESTDIR)$(datadir)/tabset\n\n$(TICDIR) :\n\tmkdir -p $@\n\ninstall \\\ninstall.emxdata :: $(TICDIR)\n\t-@rm -fr $(TICDIR)/*\n\techo Building terminfo database, please wait...\n\tset TERMINFO=$(TICDIR); ./progs/tic ./misc/emx.src\n\techo Installing the terminfo cleaner and the sources...\n\tcp ./misc/emx.src ./misc/cleantic.cmd $(TICDIR)\n\t./misc/cleantic.cmd $(TICDIR)\n\nuninstall \\\nuninstall.emxdata ::\n\t-cd $(TICDIR) && rm -rf *\n\t-cd $(TABSETDIR) && rm -rf *\n\n#\n# This is for preparing binary distributions\n#\n\nOS2NAME=ncurses-$(NCURSES_MAJOR).$(NCURSES_MINOR)-emx\n\n#\n# FIXME: this assumes that we can rerun the configure script, changing only\n# the install-prefix.  That means we cannot provide \"interesting\" options\n# when building.\n#\nos2dist :\n\t$(MAKE) -f Makefile.os2 os2clean\n\t./configure --without-debug --with-install-prefix=`pwd|sed -e 's@^.:@@'`/$(OS2NAME)\n\t$(MAKE) -f Makefile.os2 $(CF_MFLAGS) install.os2\n\t-rm -f $(OS2NAME).zip\n\techo NCurses-$(NCURSES_MAJOR).$(NCURSES_MINOR)-$(NCURSES_PATCH) for emx > $(OS2NAME)/FILE_ID.DIZ\n\techo Binary release. >> $(OS2NAME)/FILE_ID.DIZ\n\tzip -r $(OS2NAME).zip ./$(OS2NAME)\n\nclean \\\nos2clean ::\n\t-rm -rf $(OS2NAME)\n\t-rm -f $(OS2NAME).zip\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}