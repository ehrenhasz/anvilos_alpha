{
  "module_name": "skein_impl.h",
  "hash_id": "1a48da029c025462631cf795eafd4d1ea1e6433496a806305e6359d9f34ccb0f",
  "original_prompt": "Ingested from zfs-2.2.2/module/icp/algs/skein/skein_impl.h",
  "human_readable_source": " \n \n\n#ifndef\t_SKEIN_IMPL_H_\n#define\t_SKEIN_IMPL_H_\n\n#include <sys/skein.h>\n#include <sys/string.h>\n#include \"skein_impl.h\"\n#include \"skein_port.h\"\n\n \n\n \n \n#define\tSKEIN_T1_BIT(BIT)\t((BIT) - 64)\n\n \n#define\tSKEIN_T1_POS_TREE_LVL\tSKEIN_T1_BIT(112)\n \n#define\tSKEIN_T1_POS_BIT_PAD\tSKEIN_T1_BIT(119)\n \n#define\tSKEIN_T1_POS_BLK_TYPE\tSKEIN_T1_BIT(120)\n \n#define\tSKEIN_T1_POS_FIRST\tSKEIN_T1_BIT(126)\n \n#define\tSKEIN_T1_POS_FINAL\tSKEIN_T1_BIT(127)\n\n \n#define\tSKEIN_T1_FLAG_FIRST\t(((uint64_t)1) << SKEIN_T1_POS_FIRST)\n#define\tSKEIN_T1_FLAG_FINAL\t(((uint64_t)1) << SKEIN_T1_POS_FINAL)\n#define\tSKEIN_T1_FLAG_BIT_PAD\t(((uint64_t)1) << SKEIN_T1_POS_BIT_PAD)\n\n \n#define\tSKEIN_T1_TREE_LVL_MASK\t(((uint64_t)0x7F) << SKEIN_T1_POS_TREE_LVL)\n#define\tSKEIN_T1_TREE_LEVEL(n)\t(((uint64_t)(n)) << SKEIN_T1_POS_TREE_LVL)\n\n \n#define\tSKEIN_BLK_TYPE_KEY\t(0)\t \n#define\tSKEIN_BLK_TYPE_CFG\t(4)\t \n#define\tSKEIN_BLK_TYPE_PERS\t(8)\t \n#define\tSKEIN_BLK_TYPE_PK\t(12)\t \n#define\tSKEIN_BLK_TYPE_KDF\t(16)\t \n#define\tSKEIN_BLK_TYPE_NONCE\t(20)\t \n#define\tSKEIN_BLK_TYPE_MSG\t(48)\t \n#define\tSKEIN_BLK_TYPE_OUT\t(63)\t \n#define\tSKEIN_BLK_TYPE_MASK\t(63)\t \n\n#define\tSKEIN_T1_BLK_TYPE(T)\t\\\n\t(((uint64_t)(SKEIN_BLK_TYPE_##T)) << SKEIN_T1_POS_BLK_TYPE)\n \n#define\tSKEIN_T1_BLK_TYPE_KEY\tSKEIN_T1_BLK_TYPE(KEY)\n \n#define\tSKEIN_T1_BLK_TYPE_CFG\tSKEIN_T1_BLK_TYPE(CFG)\n \n#define\tSKEIN_T1_BLK_TYPE_PERS\tSKEIN_T1_BLK_TYPE(PERS)\n \n#define\tSKEIN_T1_BLK_TYPE_PK\tSKEIN_T1_BLK_TYPE(PK)\n \n#define\tSKEIN_T1_BLK_TYPE_KDF\tSKEIN_T1_BLK_TYPE(KDF)\n \n#define\tSKEIN_T1_BLK_TYPE_NONCE\tSKEIN_T1_BLK_TYPE(NONCE)\n \n#define\tSKEIN_T1_BLK_TYPE_MSG\tSKEIN_T1_BLK_TYPE(MSG)\n \n#define\tSKEIN_T1_BLK_TYPE_OUT\tSKEIN_T1_BLK_TYPE(OUT)\n \n#define\tSKEIN_T1_BLK_TYPE_MASK\tSKEIN_T1_BLK_TYPE(MASK)\n\n#define\tSKEIN_T1_BLK_TYPE_CFG_FINAL\t\\\n\t(SKEIN_T1_BLK_TYPE_CFG | SKEIN_T1_FLAG_FINAL)\n#define\tSKEIN_T1_BLK_TYPE_OUT_FINAL\t\\\n\t(SKEIN_T1_BLK_TYPE_OUT | SKEIN_T1_FLAG_FINAL)\n\n#define\tSKEIN_VERSION\t\t(1)\n\n#ifndef\tSKEIN_ID_STRING_LE\t \n#define\tSKEIN_ID_STRING_LE\t(0x33414853)\t \n#endif\n\n#define\tSKEIN_MK_64(hi32, lo32)\t((lo32) + (((uint64_t)(hi32)) << 32))\n#define\tSKEIN_SCHEMA_VER\tSKEIN_MK_64(SKEIN_VERSION, SKEIN_ID_STRING_LE)\n#define\tSKEIN_KS_PARITY\t\tSKEIN_MK_64(0x1BD11BDA, 0xA9FC1A22)\n\n#define\tSKEIN_CFG_STR_LEN\t(4*8)\n\n \n#define\tSKEIN_CFG_TREE_LEAF_SIZE_POS\t(0)\n#define\tSKEIN_CFG_TREE_NODE_SIZE_POS\t(8)\n#define\tSKEIN_CFG_TREE_MAX_LEVEL_POS\t(16)\n\n#define\tSKEIN_CFG_TREE_LEAF_SIZE_MSK\t\\\n\t(((uint64_t)0xFF) << SKEIN_CFG_TREE_LEAF_SIZE_POS)\n#define\tSKEIN_CFG_TREE_NODE_SIZE_MSK\t\\\n\t(((uint64_t)0xFF) << SKEIN_CFG_TREE_NODE_SIZE_POS)\n#define\tSKEIN_CFG_TREE_MAX_LEVEL_MSK\t\\\n\t(((uint64_t)0xFF) << SKEIN_CFG_TREE_MAX_LEVEL_POS)\n\n#define\tSKEIN_CFG_TREE_INFO(leaf, node, maxLvl)\t\t\t\\\n\t((((uint64_t)(leaf)) << SKEIN_CFG_TREE_LEAF_SIZE_POS) |\t\\\n\t(((uint64_t)(node)) << SKEIN_CFG_TREE_NODE_SIZE_POS) |\t\\\n\t(((uint64_t)(maxLvl)) << SKEIN_CFG_TREE_MAX_LEVEL_POS))\n\n \n#define\tSKEIN_CFG_TREE_INFO_SEQUENTIAL\tSKEIN_CFG_TREE_INFO(0, 0, 0)\n\n \n#define\tSkein_Get_Tweak(ctxPtr, TWK_NUM)\t((ctxPtr)->h.T[TWK_NUM])\n#define\tSkein_Set_Tweak(ctxPtr, TWK_NUM, tVal)\t\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\t(ctxPtr)->h.T[TWK_NUM] = (tVal);\t\\\n\t} while (0)\n\n#define\tSkein_Get_T0(ctxPtr)\t\tSkein_Get_Tweak(ctxPtr, 0)\n#define\tSkein_Get_T1(ctxPtr)\t\tSkein_Get_Tweak(ctxPtr, 1)\n#define\tSkein_Set_T0(ctxPtr, T0)\tSkein_Set_Tweak(ctxPtr, 0, T0)\n#define\tSkein_Set_T1(ctxPtr, T1)\tSkein_Set_Tweak(ctxPtr, 1, T1)\n\n \n#define\tSkein_Set_T0_T1(ctxPtr, T0, T1)\t\t\\\n\tdo {\t\t\t\t\t\\\n\t\tSkein_Set_T0(ctxPtr, (T0));\t\\\n\t\tSkein_Set_T1(ctxPtr, (T1));\t\\\n\t} while (0)\n\n#define\tSkein_Set_Type(ctxPtr, BLK_TYPE)\t\\\n\tSkein_Set_T1(ctxPtr, SKEIN_T1_BLK_TYPE_##BLK_TYPE)\n\n \n#define\tSkein_Start_New_Type(ctxPtr, BLK_TYPE)\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tSkein_Set_T0_T1(ctxPtr, 0, SKEIN_T1_FLAG_FIRST |\t\\\n\t\t    SKEIN_T1_BLK_TYPE_ ## BLK_TYPE);\t\t\t\\\n\t\t(ctxPtr)->h.bCnt = 0;\t\\\n\t} while (0)\n\n#define\tSkein_Clear_First_Flag(hdr)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t(hdr).T[1] &= ~SKEIN_T1_FLAG_FIRST;\t\t\t\\\n\t} while (0)\n#define\tSkein_Set_Bit_Pad_Flag(hdr)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t(hdr).T[1] |=  SKEIN_T1_FLAG_BIT_PAD;\t\t\t\\\n\t} while (0)\n\n#define\tSkein_Set_Tree_Level(hdr, height)\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t(hdr).T[1] |= SKEIN_T1_TREE_LEVEL(height);\t\t\\\n\t} while (0)\n\n \n#define\tSkein_Show_Block(bits, ctx, X, blkPtr, wPtr, ksEvenPtr, ksOddPtr)\n#define\tSkein_Show_Round(bits, ctx, r, X)\n#define\tSkein_Show_R_Ptr(bits, ctx, r, X_ptr)\n#define\tSkein_Show_Final(bits, ctx, cnt, outPtr)\n#define\tSkein_Show_Key(bits, ctx, key, keyBytes)\n\n \n#ifndef\tSKEIN_ERR_CHECK\n \n#define\tSkein_Assert(x, retCode)\n#define\tSkein_assert(x)\n#elif\tdefined(SKEIN_ASSERT)\n#include <sys/debug.h>\n#define\tSkein_Assert(x, retCode)\tASSERT(x)\n#define\tSkein_assert(x)\t\t\tASSERT(x)\n#else\n#include <sys/debug.h>\n \n#define\tSkein_Assert(x, retCode)\t\t\\\n\tdo {\t\t\t\t\t\\\n\t\tif (!(x))\t\t\t\\\n\t\t\treturn (retCode);\t\\\n\t} while (0)\n \n#define\tSkein_assert(x)\tASSERT(x)\n#endif\n\n \nenum {\n\t \n\tR_256_0_0 = 14, R_256_0_1 = 16,\n\tR_256_1_0 = 52, R_256_1_1 = 57,\n\tR_256_2_0 = 23, R_256_2_1 = 40,\n\tR_256_3_0 = 5, R_256_3_1 = 37,\n\tR_256_4_0 = 25, R_256_4_1 = 33,\n\tR_256_5_0 = 46, R_256_5_1 = 12,\n\tR_256_6_0 = 58, R_256_6_1 = 22,\n\tR_256_7_0 = 32, R_256_7_1 = 32,\n\n\t \n\tR_512_0_0 = 46, R_512_0_1 = 36, R_512_0_2 = 19, R_512_0_3 = 37,\n\tR_512_1_0 = 33, R_512_1_1 = 27, R_512_1_2 = 14, R_512_1_3 = 42,\n\tR_512_2_0 = 17, R_512_2_1 = 49, R_512_2_2 = 36, R_512_2_3 = 39,\n\tR_512_3_0 = 44, R_512_3_1 = 9, R_512_3_2 = 54, R_512_3_3 = 56,\n\tR_512_4_0 = 39, R_512_4_1 = 30, R_512_4_2 = 34, R_512_4_3 = 24,\n\tR_512_5_0 = 13, R_512_5_1 = 50, R_512_5_2 = 10, R_512_5_3 = 17,\n\tR_512_6_0 = 25, R_512_6_1 = 29, R_512_6_2 = 39, R_512_6_3 = 43,\n\tR_512_7_0 = 8, R_512_7_1 = 35, R_512_7_2 = 56, R_512_7_3 = 22,\n\n\t \n\tR1024_0_0 = 24, R1024_0_1 = 13, R1024_0_2 = 8, R1024_0_3 =\n\t    47, R1024_0_4 = 8, R1024_0_5 = 17, R1024_0_6 = 22, R1024_0_7 = 37,\n\tR1024_1_0 = 38, R1024_1_1 = 19, R1024_1_2 = 10, R1024_1_3 =\n\t    55, R1024_1_4 = 49, R1024_1_5 = 18, R1024_1_6 = 23, R1024_1_7 = 52,\n\tR1024_2_0 = 33, R1024_2_1 = 4, R1024_2_2 = 51, R1024_2_3 =\n\t    13, R1024_2_4 = 34, R1024_2_5 = 41, R1024_2_6 = 59, R1024_2_7 = 17,\n\tR1024_3_0 = 5, R1024_3_1 = 20, R1024_3_2 = 48, R1024_3_3 =\n\t    41, R1024_3_4 = 47, R1024_3_5 = 28, R1024_3_6 = 16, R1024_3_7 = 25,\n\tR1024_4_0 = 41, R1024_4_1 = 9, R1024_4_2 = 37, R1024_4_3 =\n\t    31, R1024_4_4 = 12, R1024_4_5 = 47, R1024_4_6 = 44, R1024_4_7 = 30,\n\tR1024_5_0 = 16, R1024_5_1 = 34, R1024_5_2 = 56, R1024_5_3 =\n\t    51, R1024_5_4 = 4, R1024_5_5 = 53, R1024_5_6 = 42, R1024_5_7 = 41,\n\tR1024_6_0 = 31, R1024_6_1 = 44, R1024_6_2 = 47, R1024_6_3 =\n\t    46, R1024_6_4 = 19, R1024_6_5 = 42, R1024_6_6 = 44, R1024_6_7 = 25,\n\tR1024_7_0 = 9, R1024_7_1 = 48, R1024_7_2 = 35, R1024_7_3 =\n\t    52, R1024_7_4 = 23, R1024_7_5 = 31, R1024_7_6 = 37, R1024_7_7 = 20\n};\n\n \n#define\tSKEIN_256_ROUNDS_TOTAL\t(72)\n#define\tSKEIN_512_ROUNDS_TOTAL\t(72)\n#define\tSKEIN1024_ROUNDS_TOTAL\t(80)\n\n\nextern const uint64_t SKEIN_256_IV_128[];\nextern const uint64_t SKEIN_256_IV_160[];\nextern const uint64_t SKEIN_256_IV_224[];\nextern const uint64_t SKEIN_256_IV_256[];\nextern const uint64_t SKEIN_512_IV_224[];\nextern const uint64_t SKEIN_512_IV_256[];\nextern const uint64_t SKEIN_512_IV_384[];\nextern const uint64_t SKEIN_512_IV_512[];\nextern const uint64_t SKEIN1024_IV_384[];\nextern const uint64_t SKEIN1024_IV_512[];\nextern const uint64_t SKEIN1024_IV_1024[];\n\n \nvoid Skein_256_Process_Block(Skein_256_Ctxt_t *ctx, const uint8_t *blkPtr,\n    size_t blkCnt, size_t byteCntAdd);\nvoid Skein_512_Process_Block(Skein_512_Ctxt_t *ctx, const uint8_t *blkPtr,\n    size_t blkCnt, size_t byteCntAdd);\nvoid Skein1024_Process_Block(Skein1024_Ctxt_t *ctx, const uint8_t *blkPtr,\n    size_t blkCnt, size_t byteCntAdd);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}