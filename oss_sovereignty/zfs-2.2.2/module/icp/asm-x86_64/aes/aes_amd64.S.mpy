{
  "module_name": "aes_amd64.S",
  "hash_id": "6ce1d393524beda4dfccdfd4dcd5c50f11f4253c1224bb2e39ca5070b490916a",
  "original_prompt": "Ingested from zfs-2.2.2/module/icp/asm-x86_64/aes/aes_amd64.S",
  "human_readable_source": " \n#define\tAES_REV_DKS\t   \n\n#define\tLAST_ROUND_TABLES  \n\n \n\n \n\n#if defined(lint) || defined(__lint)\n\n#include <sys/types.h>\nvoid\naes_encrypt_amd64(const uint32_t rk[], int Nr, const uint32_t pt[4],\n       uint32_t ct[4]) {\n\t\t(void) rk, (void) Nr, (void) pt, (void) ct;\n}\nvoid\naes_decrypt_amd64(const uint32_t rk[], int Nr, const uint32_t ct[4],\n       uint32_t pt[4]) {\n\t\t(void) rk, (void) Nr, (void) pt, (void) ct;\n}\n\n\n#else\n\n#define _ASM\n#include <sys/asm_linkage.h>\n\n#define\tKS_LENGTH\t60\n\n#define\traxd\t\teax\n#define\trdxd\t\tedx\n#define\trcxd\t\tecx\n#define\trbxd\t\tebx\n#define\trsid\t\tesi\n#define\trdid\t\tedi\n\n#define\traxb\t\tal\n#define\trdxb\t\tdl\n#define\trcxb\t\tcl\n#define\trbxb\t\tbl\n#define\trsib\t\tsil\n#define\trdib\t\tdil\n\n \n\n#define\tf2(x) ((x<<1)^(((x>>7)&1)*0x11b))\n#define\tf4(x) ((x<<2)^(((x>>6)&1)*0x11b)^(((x>>6)&2)*0x11b))\n#define\tf8(x) ((x<<3)^(((x>>5)&1)*0x11b)^(((x>>5)&2)*0x11b)^(((x>>5)&4)*0x11b))\n\n \n\n#define\tf3(x) ((f2(x)) ^ (x))\n#define\tf9(x) ((f8(x)) ^ (x))\n#define\tfb(x) ((f8(x)) ^ (f2(x)) ^ (x))\n#define\tfd(x) ((f8(x)) ^ (f4(x)) ^ (x))\n#define\tfe(x) ((f8(x)) ^ (f4(x)) ^ (f2(x)))\n\n \n\n#define\tu8(x) (f2(x)), (x), (x), (f3(x)), (f2(x)), (x), (x), (f3(x))\n#define\tv8(x) (fe(x)), (f9(x)), (fd(x)), (fb(x)), (fe(x)), (f9(x)), (fd(x)), (x)\n#define\tw8(x) (x), 0, 0, 0, (x), 0, 0, 0\n\n#define\tenc_vals(x)\t\\\n   .byte x(0x63),x(0x7c),x(0x77),x(0x7b),x(0xf2),x(0x6b),x(0x6f),x(0xc5); \\\n   .byte x(0x30),x(0x01),x(0x67),x(0x2b),x(0xfe),x(0xd7),x(0xab),x(0x76); \\\n   .byte x(0xca),x(0x82),x(0xc9),x(0x7d),x(0xfa),x(0x59),x(0x47),x(0xf0); \\\n   .byte x(0xad),x(0xd4),x(0xa2),x(0xaf),x(0x9c),x(0xa4),x(0x72),x(0xc0); \\\n   .byte x(0xb7),x(0xfd),x(0x93),x(0x26),x(0x36),x(0x3f),x(0xf7),x(0xcc); \\\n   .byte x(0x34),x(0xa5),x(0xe5),x(0xf1),x(0x71),x(0xd8),x(0x31),x(0x15); \\\n   .byte x(0x04),x(0xc7),x(0x23),x(0xc3),x(0x18),x(0x96),x(0x05),x(0x9a); \\\n   .byte x(0x07),x(0x12),x(0x80),x(0xe2),x(0xeb),x(0x27),x(0xb2),x(0x75); \\\n   .byte x(0x09),x(0x83),x(0x2c),x(0x1a),x(0x1b),x(0x6e),x(0x5a),x(0xa0); \\\n   .byte x(0x52),x(0x3b),x(0xd6),x(0xb3),x(0x29),x(0xe3),x(0x2f),x(0x84); \\\n   .byte x(0x53),x(0xd1),x(0x00),x(0xed),x(0x20),x(0xfc),x(0xb1),x(0x5b); \\\n   .byte x(0x6a),x(0xcb),x(0xbe),x(0x39),x(0x4a),x(0x4c),x(0x58),x(0xcf); \\\n   .byte x(0xd0),x(0xef),x(0xaa),x(0xfb),x(0x43),x(0x4d),x(0x33),x(0x85); \\\n   .byte x(0x45),x(0xf9),x(0x02),x(0x7f),x(0x50),x(0x3c),x(0x9f),x(0xa8); \\\n   .byte x(0x51),x(0xa3),x(0x40),x(0x8f),x(0x92),x(0x9d),x(0x38),x(0xf5); \\\n   .byte x(0xbc),x(0xb6),x(0xda),x(0x21),x(0x10),x(0xff),x(0xf3),x(0xd2); \\\n   .byte x(0xcd),x(0x0c),x(0x13),x(0xec),x(0x5f),x(0x97),x(0x44),x(0x17); \\\n   .byte x(0xc4),x(0xa7),x(0x7e),x(0x3d),x(0x64),x(0x5d),x(0x19),x(0x73); \\\n   .byte x(0x60),x(0x81),x(0x4f),x(0xdc),x(0x22),x(0x2a),x(0x90),x(0x88); \\\n   .byte x(0x46),x(0xee),x(0xb8),x(0x14),x(0xde),x(0x5e),x(0x0b),x(0xdb); \\\n   .byte x(0xe0),x(0x32),x(0x3a),x(0x0a),x(0x49),x(0x06),x(0x24),x(0x5c); \\\n   .byte x(0xc2),x(0xd3),x(0xac),x(0x62),x(0x91),x(0x95),x(0xe4),x(0x79); \\\n   .byte x(0xe7),x(0xc8),x(0x37),x(0x6d),x(0x8d),x(0xd5),x(0x4e),x(0xa9); \\\n   .byte x(0x6c),x(0x56),x(0xf4),x(0xea),x(0x65),x(0x7a),x(0xae),x(0x08); \\\n   .byte x(0xba),x(0x78),x(0x25),x(0x2e),x(0x1c),x(0xa6),x(0xb4),x(0xc6); \\\n   .byte x(0xe8),x(0xdd),x(0x74),x(0x1f),x(0x4b),x(0xbd),x(0x8b),x(0x8a); \\\n   .byte x(0x70),x(0x3e),x(0xb5),x(0x66),x(0x48),x(0x03),x(0xf6),x(0x0e); \\\n   .byte x(0x61),x(0x35),x(0x57),x(0xb9),x(0x86),x(0xc1),x(0x1d),x(0x9e); \\\n   .byte x(0xe1),x(0xf8),x(0x98),x(0x11),x(0x69),x(0xd9),x(0x8e),x(0x94); \\\n   .byte x(0x9b),x(0x1e),x(0x87),x(0xe9),x(0xce),x(0x55),x(0x28),x(0xdf); \\\n   .byte x(0x8c),x(0xa1),x(0x89),x(0x0d),x(0xbf),x(0xe6),x(0x42),x(0x68); \\\n   .byte x(0x41),x(0x99),x(0x2d),x(0x0f),x(0xb0),x(0x54),x(0xbb),x(0x16)\n\n#define\tdec_vals(x) \\\n   .byte x(0x52),x(0x09),x(0x6a),x(0xd5),x(0x30),x(0x36),x(0xa5),x(0x38); \\\n   .byte x(0xbf),x(0x40),x(0xa3),x(0x9e),x(0x81),x(0xf3),x(0xd7),x(0xfb); \\\n   .byte x(0x7c),x(0xe3),x(0x39),x(0x82),x(0x9b),x(0x2f),x(0xff),x(0x87); \\\n   .byte x(0x34),x(0x8e),x(0x43),x(0x44),x(0xc4),x(0xde),x(0xe9),x(0xcb); \\\n   .byte x(0x54),x(0x7b),x(0x94),x(0x32),x(0xa6),x(0xc2),x(0x23),x(0x3d); \\\n   .byte x(0xee),x(0x4c),x(0x95),x(0x0b),x(0x42),x(0xfa),x(0xc3),x(0x4e); \\\n   .byte x(0x08),x(0x2e),x(0xa1),x(0x66),x(0x28),x(0xd9),x(0x24),x(0xb2); \\\n   .byte x(0x76),x(0x5b),x(0xa2),x(0x49),x(0x6d),x(0x8b),x(0xd1),x(0x25); \\\n   .byte x(0x72),x(0xf8),x(0xf6),x(0x64),x(0x86),x(0x68),x(0x98),x(0x16); \\\n   .byte x(0xd4),x(0xa4),x(0x5c),x(0xcc),x(0x5d),x(0x65),x(0xb6),x(0x92); \\\n   .byte x(0x6c),x(0x70),x(0x48),x(0x50),x(0xfd),x(0xed),x(0xb9),x(0xda); \\\n   .byte x(0x5e),x(0x15),x(0x46),x(0x57),x(0xa7),x(0x8d),x(0x9d),x(0x84); \\\n   .byte x(0x90),x(0xd8),x(0xab),x(0x00),x(0x8c),x(0xbc),x(0xd3),x(0x0a); \\\n   .byte x(0xf7),x(0xe4),x(0x58),x(0x05),x(0xb8),x(0xb3),x(0x45),x(0x06); \\\n   .byte x(0xd0),x(0x2c),x(0x1e),x(0x8f),x(0xca),x(0x3f),x(0x0f),x(0x02); \\\n   .byte x(0xc1),x(0xaf),x(0xbd),x(0x03),x(0x01),x(0x13),x(0x8a),x(0x6b); \\\n   .byte x(0x3a),x(0x91),x(0x11),x(0x41),x(0x4f),x(0x67),x(0xdc),x(0xea); \\\n   .byte x(0x97),x(0xf2),x(0xcf),x(0xce),x(0xf0),x(0xb4),x(0xe6),x(0x73); \\\n   .byte x(0x96),x(0xac),x(0x74),x(0x22),x(0xe7),x(0xad),x(0x35),x(0x85); \\\n   .byte x(0xe2),x(0xf9),x(0x37),x(0xe8),x(0x1c),x(0x75),x(0xdf),x(0x6e); \\\n   .byte x(0x47),x(0xf1),x(0x1a),x(0x71),x(0x1d),x(0x29),x(0xc5),x(0x89); \\\n   .byte x(0x6f),x(0xb7),x(0x62),x(0x0e),x(0xaa),x(0x18),x(0xbe),x(0x1b); \\\n   .byte x(0xfc),x(0x56),x(0x3e),x(0x4b),x(0xc6),x(0xd2),x(0x79),x(0x20); \\\n   .byte x(0x9a),x(0xdb),x(0xc0),x(0xfe),x(0x78),x(0xcd),x(0x5a),x(0xf4); \\\n   .byte x(0x1f),x(0xdd),x(0xa8),x(0x33),x(0x88),x(0x07),x(0xc7),x(0x31); \\\n   .byte x(0xb1),x(0x12),x(0x10),x(0x59),x(0x27),x(0x80),x(0xec),x(0x5f); \\\n   .byte x(0x60),x(0x51),x(0x7f),x(0xa9),x(0x19),x(0xb5),x(0x4a),x(0x0d); \\\n   .byte x(0x2d),x(0xe5),x(0x7a),x(0x9f),x(0x93),x(0xc9),x(0x9c),x(0xef); \\\n   .byte x(0xa0),x(0xe0),x(0x3b),x(0x4d),x(0xae),x(0x2a),x(0xf5),x(0xb0); \\\n   .byte x(0xc8),x(0xeb),x(0xbb),x(0x3c),x(0x83),x(0x53),x(0x99),x(0x61); \\\n   .byte x(0x17),x(0x2b),x(0x04),x(0x7e),x(0xba),x(0x77),x(0xd6),x(0x26); \\\n   .byte x(0xe1),x(0x69),x(0x14),x(0x63),x(0x55),x(0x21),x(0x0c),x(0x7d)\n\n#define\ttptr\t%rbp\t \n#define\tkptr\t%r8\t \n#define\tfofs\t128\t \n#define\tfk_ref(x, y)\t-16*x+fofs+4*y(kptr)\n\n#ifdef\tAES_REV_DKS\n#define\trofs\t\t128\n#define\tik_ref(x, y)\t-16*x+rofs+4*y(kptr)\n\n#else\n#define\trofs\t\t-128\n#define\tik_ref(x, y)\t16*x+rofs+4*y(kptr)\n#endif\t \n\n#define\ttab_0(x)\t(tptr,x,8)\n#define\ttab_1(x)\t3(tptr,x,8)\n#define\ttab_2(x)\t2(tptr,x,8)\n#define\ttab_3(x)\t1(tptr,x,8)\n#define\ttab_f(x)\t1(tptr,x,8)\n#define\ttab_i(x)\t7(tptr,x,8)\n\n#define\tff_rnd(p1, p2, p3, p4, round)\t  \\\n\tmov\tfk_ref(round,0), p1; \\\n\tmov\tfk_ref(round,1), p2; \\\n\tmov\tfk_ref(round,2), p3; \\\n\tmov\tfk_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tshr\t$16, %eax; \\\n\txor\ttab_0(%rsi), p1; \\\n\txor\ttab_1(%rdi), p4; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\txor\ttab_2(%rsi), p3; \\\n\txor\ttab_3(%rdi), p2; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tshr\t$16, %ebx; \\\n\txor\ttab_0(%rsi), p2; \\\n\txor\ttab_1(%rdi), p1; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\txor\ttab_2(%rsi), p4; \\\n\txor\ttab_3(%rdi), p3; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\ttab_0(%rsi), p3; \\\n\txor\ttab_1(%rdi), p2; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\txor\ttab_2(%rsi), p1; \\\n\txor\ttab_3(%rdi), p4; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tshr\t$16, %edx; \\\n\txor\ttab_0(%rsi), p4; \\\n\txor\ttab_1(%rdi), p3; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\txor\ttab_2(%rsi), p2; \\\n\txor\ttab_3(%rdi), p1; \\\n \\\n\tmov\tp1, %eax; \\\n\tmov\tp2, %ebx; \\\n\tmov\tp3, %ecx; \\\n\tmov\tp4, %edx\n\n#ifdef\tLAST_ROUND_TABLES\n\n#define\tfl_rnd(p1, p2, p3, p4, round)\t  \\\n\tadd\t$2048, tptr; \\\n\tmov\tfk_ref(round,0), p1; \\\n\tmov\tfk_ref(round,1), p2; \\\n\tmov\tfk_ref(round,2), p3; \\\n\tmov\tfk_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tshr\t$16, %eax; \\\n\txor\ttab_0(%rsi), p1; \\\n\txor\ttab_1(%rdi), p4; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\txor\ttab_2(%rsi), p3; \\\n\txor\ttab_3(%rdi), p2; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tshr\t$16, %ebx; \\\n\txor\ttab_0(%rsi), p2; \\\n\txor\ttab_1(%rdi), p1; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\txor\ttab_2(%rsi), p4; \\\n\txor\ttab_3(%rdi), p3; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\ttab_0(%rsi), p3; \\\n\txor\ttab_1(%rdi), p2; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\txor\ttab_2(%rsi), p1; \\\n\txor\ttab_3(%rdi), p4; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tshr\t$16, %edx; \\\n\txor\ttab_0(%rsi), p4; \\\n\txor\ttab_1(%rdi), p3; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\txor\ttab_2(%rsi), p2; \\\n\txor\ttab_3(%rdi), p1\n\n#else\n\n#define\tfl_rnd(p1, p2, p3, p4, round)\t  \\\n\tmov\tfk_ref(round,0), p1; \\\n\tmov\tfk_ref(round,1), p2; \\\n\tmov\tfk_ref(round,2), p3; \\\n\tmov\tfk_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tshr\t$16, %eax; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\txor\t%esi, p1; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p4; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p3; \\\n\txor\t%edi, p2; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tshr\t$16, %ebx; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\txor\t%esi, p2; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p1; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p4; \\\n\txor\t%edi, p3; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\t%esi, p3; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p2; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p1; \\\n\txor\t%edi, p4; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\tshr\t$16, %edx; \\\n\txor\t%esi, p4; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p3; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tmovzx\ttab_f(%rsi), %esi; \\\n\tmovzx\ttab_f(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p2; \\\n\txor\t%edi, p1\n\n#endif\t \n\n#define\tii_rnd(p1, p2, p3, p4, round)\t  \\\n\tmov\tik_ref(round,0), p1; \\\n\tmov\tik_ref(round,1), p2; \\\n\tmov\tik_ref(round,2), p3; \\\n\tmov\tik_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tshr\t$16, %eax; \\\n\txor\ttab_0(%rsi), p1; \\\n\txor\ttab_1(%rdi), p2; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\txor\ttab_2(%rsi), p3; \\\n\txor\ttab_3(%rdi), p4; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tshr\t$16, %ebx; \\\n\txor\ttab_0(%rsi), p2; \\\n\txor\ttab_1(%rdi), p3; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\txor\ttab_2(%rsi), p4; \\\n\txor\ttab_3(%rdi), p1; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\ttab_0(%rsi), p3; \\\n\txor\ttab_1(%rdi), p4; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\txor\ttab_2(%rsi), p1; \\\n\txor\ttab_3(%rdi), p2; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tshr\t$16, %edx; \\\n\txor\ttab_0(%rsi), p4; \\\n\txor\ttab_1(%rdi), p1; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\txor\ttab_2(%rsi), p2; \\\n\txor\ttab_3(%rdi), p3; \\\n \\\n\tmov\tp1, %eax; \\\n\tmov\tp2, %ebx; \\\n\tmov\tp3, %ecx; \\\n\tmov\tp4, %edx\n\n#ifdef\tLAST_ROUND_TABLES\n\n#define\til_rnd(p1, p2, p3, p4, round)\t  \\\n\tadd\t$2048, tptr; \\\n\tmov\tik_ref(round,0), p1; \\\n\tmov\tik_ref(round,1), p2; \\\n\tmov\tik_ref(round,2), p3; \\\n\tmov\tik_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tshr\t$16, %eax; \\\n\txor\ttab_0(%rsi), p1; \\\n\txor\ttab_1(%rdi), p2; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\txor\ttab_2(%rsi), p3; \\\n\txor\ttab_3(%rdi), p4; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tshr\t$16, %ebx; \\\n\txor\ttab_0(%rsi), p2; \\\n\txor\ttab_1(%rdi), p3; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\txor\ttab_2(%rsi), p4; \\\n\txor\ttab_3(%rdi), p1; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\ttab_0(%rsi), p3; \\\n\txor\ttab_1(%rdi), p4; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\txor\ttab_2(%rsi), p1; \\\n\txor\ttab_3(%rdi), p2; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tshr\t$16, %edx; \\\n\txor\ttab_0(%rsi), p4; \\\n\txor\ttab_1(%rdi), p1; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\txor\ttab_2(%rsi), p2; \\\n\txor\ttab_3(%rdi), p3\n\n#else\n\n#define\til_rnd(p1, p2, p3, p4, round)\t  \\\n\tmov\tik_ref(round,0), p1; \\\n\tmov\tik_ref(round,1), p2; \\\n\tmov\tik_ref(round,2), p3; \\\n\tmov\tik_ref(round,3), p4; \\\n \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\tshr\t$16, %eax; \\\n\txor\t%esi, p1; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p2; \\\n\tmovzx\t%al, %esi; \\\n\tmovzx\t%ah, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p3; \\\n\txor\t%edi, p4; \\\n \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\tshr\t$16, %ebx; \\\n\txor\t%esi, p2; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p3; \\\n\tmovzx\t%bl, %esi; \\\n\tmovzx\t%bh, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p4; \\\n\txor\t%edi, p1; \\\n \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\tshr\t$16, %ecx; \\\n\txor\t%esi, p3; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p4; \\\n\tmovzx\t%cl, %esi; \\\n\tmovzx\t%ch, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p1; \\\n\txor\t%edi, p2; \\\n \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\tshr\t$16, %edx; \\\n\txor\t%esi, p4; \\\n\trol\t$8, %edi; \\\n\txor\t%edi, p1; \\\n\tmovzx\t%dl, %esi; \\\n\tmovzx\t%dh, %edi; \\\n\tmovzx\ttab_i(%rsi), %esi; \\\n\tmovzx\ttab_i(%rdi), %edi; \\\n\trol\t$16, %esi; \\\n\trol\t$24, %edi; \\\n\txor\t%esi, p2; \\\n\txor\t%edi, p3\n\n#endif\t \n\n \nSECTION_STATIC\n.balign\t64\nenc_tab:\n\tenc_vals(u8)\n#ifdef\tLAST_ROUND_TABLES\n\t \n\tenc_vals(w8)\n#endif\n\n\nENTRY_NP(aes_encrypt_amd64)\n\tENDBR\n#ifdef\tGLADMAN_INTERFACE\n\t \n\tsub\t$[4*8], %rsp\t \n\tmov\t%rsi, (%rsp)\t \n\tmov\t%rdx, %r8\t \n\n\tmov\t%rbx, 1*8(%rsp)\t \n\tmov\t%rbp, 2*8(%rsp)\t \n\tmov\t%r12, 3*8(%rsp)\t \n\tmovzx\t4*KS_LENGTH(kptr), %esi\t \n\n#else\n\t \n\tsub\t$(4*8), %rsp\t \n\tmov\t%rcx, (%rsp)\t \n\tmov\t%rdi, %r8\t \n\tmov\t%rdx, %rdi\t \n\tshl\t$4, %esi\t \n\n\tmov\t%rbx, 1*8(%rsp)\t \n\tmov\t%rbp, 2*8(%rsp)\n\tmov\t%r12, 3*8(%rsp)\n\t \n\t \n\t \n\t \n#endif\t \n\n\tlea\tenc_tab(%rip), tptr\n\tsub\t$fofs, kptr\n\n\t \n\tmov\t(%rdi), %eax\n\tmov\t1*4(%rdi), %ebx\n\tmov\t2*4(%rdi), %ecx\n\tmov\t3*4(%rdi), %edx\n\n\txor\tfofs(kptr), %eax\n\txor\tfofs+4(kptr), %ebx\n\txor\tfofs+8(kptr), %ecx\n\txor\tfofs+12(kptr), %edx\n\n\tlea\t(kptr,%rsi), kptr\n\t \n\tcmp\t$(10*16), %esi\n\tje\t3f\n\tcmp\t$(12*16), %esi\n\tje\t2f\n\tcmp\t$(14*16), %esi\n\tje\t1f\n\tmov\t$-1, %rax\t \n\tjmp\t4f\n\n\t \n1:\tff_rnd(%r9d, %r10d, %r11d, %r12d, 13)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d, 12)\n2:\tff_rnd(%r9d, %r10d, %r11d, %r12d, 11)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d, 10)\n3:\tff_rnd(%r9d, %r10d, %r11d, %r12d,  9)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  8)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  7)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  6)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  5)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  4)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  3)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  2)\n\tff_rnd(%r9d, %r10d, %r11d, %r12d,  1)\n\tfl_rnd(%r9d, %r10d, %r11d, %r12d,  0)\n\n\t \n\tmov\t(%rsp), %rbx\n\tmov\t%r9d, (%rbx)\n\tmov\t%r10d, 4(%rbx)\n\tmov\t%r11d, 8(%rbx)\n\tmov\t%r12d, 12(%rbx)\n\txor\t%rax, %rax\n4:\t \n\tmov\t1*8(%rsp), %rbx\n\tmov\t2*8(%rsp), %rbp\n\tmov\t3*8(%rsp), %r12\n\tadd\t$(4*8), %rsp\n\tRET\n\n\tSET_SIZE(aes_encrypt_amd64)\n\n \nSECTION_STATIC\n.balign\t64\ndec_tab:\n\tdec_vals(v8)\n#ifdef\tLAST_ROUND_TABLES\n\t \n\tdec_vals(w8)\n#endif\n\n\nENTRY_NP(aes_decrypt_amd64)\n\tENDBR\n#ifdef\tGLADMAN_INTERFACE\n\t \n\tsub\t$[4*8], %rsp\t \n\tmov\t%rsi, (%rsp)\t \n\tmov\t%rdx, %r8\t \n\n\tmov\t%rbx, 1*8(%rsp)\t \n\tmov\t%rbp, 2*8(%rsp)\t \n\tmov\t%r12, 3*8(%rsp)\t \n\tmovzx\t4*KS_LENGTH(kptr), %esi\t \n\n#else\n\t \n\tsub\t$(4*8), %rsp\t \n\tmov\t%rcx, (%rsp)\t \n\tmov\t%rdi, %r8\t \n\tmov\t%rdx, %rdi\t \n\tshl\t$4, %esi\t \n\n\tmov\t%rbx, 1*8(%rsp)\t \n\tmov\t%rbp, 2*8(%rsp)\n\tmov\t%r12, 3*8(%rsp)\n\t \n\t \n\t \n\t \n#endif\t \n\n\tlea\tdec_tab(%rip), tptr\n\tsub\t$rofs, kptr\n\n\t \n\tmov\t(%rdi), %eax\n\tmov\t1*4(%rdi), %ebx\n\tmov\t2*4(%rdi), %ecx\n\tmov\t3*4(%rdi), %edx\n\n#ifdef AES_REV_DKS\n\tmov\tkptr, %rdi\n\tlea\t(kptr,%rsi), kptr\n#else\n\tlea\t(kptr,%rsi), %rdi\n#endif\n\n\txor\trofs(%rdi), %eax\n\txor\trofs+4(%rdi), %ebx\n\txor\trofs+8(%rdi), %ecx\n\txor\trofs+12(%rdi), %edx\n\n\t \n\tcmp\t$(10*16), %esi\n\tje\t3f\n\tcmp\t$(12*16), %esi\n\tje\t2f\n\tcmp\t$(14*16), %esi\n\tje\t1f\n\tmov\t$-1, %rax\t \n\tjmp\t4f\n\n\t \n1:\tii_rnd(%r9d, %r10d, %r11d, %r12d, 13)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d, 12)\n2:\tii_rnd(%r9d, %r10d, %r11d, %r12d, 11)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d, 10)\n3:\tii_rnd(%r9d, %r10d, %r11d, %r12d,  9)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  8)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  7)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  6)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  5)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  4)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  3)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  2)\n\tii_rnd(%r9d, %r10d, %r11d, %r12d,  1)\n\til_rnd(%r9d, %r10d, %r11d, %r12d,  0)\n\n\t \n\tmov\t(%rsp), %rbx\n\tmov\t%r9d, (%rbx)\n\tmov\t%r10d, 4(%rbx)\n\tmov\t%r11d, 8(%rbx)\n\tmov\t%r12d, 12(%rbx)\n\txor\t%rax, %rax\n4:\t \n\tmov\t1*8(%rsp), %rbx\n\tmov\t2*8(%rsp), %rbp\n\tmov\t3*8(%rsp), %r12\n\tadd\t$(4*8), %rsp\n\tRET\n\n\tSET_SIZE(aes_decrypt_amd64)\n#endif  \n\n#ifdef __ELF__\n.section .note.GNU-stack,\"\",%progbits\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}