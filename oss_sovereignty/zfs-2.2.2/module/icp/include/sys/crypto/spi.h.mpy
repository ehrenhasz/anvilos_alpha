{
  "module_name": "spi.h",
  "hash_id": "a055e59e2fd085dad03fc236095f3e65ccf52708cd6d8eb8c9d3cd059700b731",
  "original_prompt": "Ingested from zfs-2.2.2/module/icp/include/sys/crypto/spi.h",
  "human_readable_source": " \n \n\n#ifndef\t_SYS_CRYPTO_SPI_H\n#define\t_SYS_CRYPTO_SPI_H\n\n \n\n#include <sys/zfs_context.h>\n#include <sys/crypto/common.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n#ifdef CONSTIFY_PLUGIN\n#define\t__no_const __attribute__((no_const))\n#else\n#define\t__no_const\n#endif  \n\n \ntypedef void *crypto_spi_ctx_template_t;\n\n \ntypedef struct crypto_ctx {\n\tvoid\t\t\t*cc_provider_private;\t \n\tvoid\t\t\t*cc_framework_private;\t \n} crypto_ctx_t;\n\n \ntypedef struct crypto_digest_ops {\n\tint (*digest_init)(crypto_ctx_t *, crypto_mechanism_t *);\n\tint (*digest)(crypto_ctx_t *, crypto_data_t *, crypto_data_t *);\n\tint (*digest_update)(crypto_ctx_t *, crypto_data_t *);\n\tint (*digest_key)(crypto_ctx_t *, crypto_key_t *);\n\tint (*digest_final)(crypto_ctx_t *, crypto_data_t *);\n\tint (*digest_atomic)(crypto_mechanism_t *, crypto_data_t *,\n\t    crypto_data_t *);\n} __no_const crypto_digest_ops_t;\n\n \ntypedef struct crypto_cipher_ops {\n\tint (*encrypt_init)(crypto_ctx_t *,\n\t    crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_spi_ctx_template_t);\n\tint (*encrypt)(crypto_ctx_t *,\n\t    crypto_data_t *, crypto_data_t *);\n\tint (*encrypt_update)(crypto_ctx_t *,\n\t    crypto_data_t *, crypto_data_t *);\n\tint (*encrypt_final)(crypto_ctx_t *,\n\t    crypto_data_t *);\n\tint (*encrypt_atomic)(crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_data_t *, crypto_data_t *, crypto_spi_ctx_template_t);\n\n\tint (*decrypt_init)(crypto_ctx_t *,\n\t    crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_spi_ctx_template_t);\n\tint (*decrypt)(crypto_ctx_t *,\n\t    crypto_data_t *, crypto_data_t *);\n\tint (*decrypt_update)(crypto_ctx_t *,\n\t    crypto_data_t *, crypto_data_t *);\n\tint (*decrypt_final)(crypto_ctx_t *,\n\t    crypto_data_t *);\n\tint (*decrypt_atomic)(crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_data_t *, crypto_data_t *, crypto_spi_ctx_template_t);\n} __no_const crypto_cipher_ops_t;\n\n \ntypedef struct crypto_mac_ops {\n\tint (*mac_init)(crypto_ctx_t *,\n\t    crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_spi_ctx_template_t);\n\tint (*mac)(crypto_ctx_t *,\n\t    crypto_data_t *, crypto_data_t *);\n\tint (*mac_update)(crypto_ctx_t *,\n\t    crypto_data_t *);\n\tint (*mac_final)(crypto_ctx_t *,\n\t    crypto_data_t *);\n\tint (*mac_atomic)(crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_data_t *, crypto_data_t *, crypto_spi_ctx_template_t);\n\tint (*mac_verify_atomic)(crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_data_t *, crypto_data_t *, crypto_spi_ctx_template_t);\n} __no_const crypto_mac_ops_t;\n\n \ntypedef struct crypto_ctx_ops {\n\tint (*create_ctx_template)(crypto_mechanism_t *, crypto_key_t *,\n\t    crypto_spi_ctx_template_t *, size_t *);\n\tint (*free_context)(crypto_ctx_t *);\n} __no_const crypto_ctx_ops_t;\n\n \ntypedef struct crypto_ops {\n\tconst crypto_digest_ops_t\t\t\t*co_digest_ops;\n\tconst crypto_cipher_ops_t\t\t\t*co_cipher_ops;\n\tconst crypto_mac_ops_t\t\t\t*co_mac_ops;\n\tconst crypto_ctx_ops_t\t\t\t*co_ctx_ops;\n} crypto_ops_t;\n\n \n\ntypedef uint32_t crypto_func_group_t;\n\n\n#define\tCRYPTO_FG_ENCRYPT\t\t0x00000001  \n#define\tCRYPTO_FG_DECRYPT\t\t0x00000002  \n#define\tCRYPTO_FG_DIGEST\t\t0x00000004  \n#define\tCRYPTO_FG_MAC\t\t\t0x00001000  \n#define\tCRYPTO_FG_ENCRYPT_ATOMIC\t0x00008000  \n#define\tCRYPTO_FG_DECRYPT_ATOMIC\t0x00010000  \n#define\tCRYPTO_FG_MAC_ATOMIC\t\t0x00020000  \n#define\tCRYPTO_FG_DIGEST_ATOMIC\t\t0x00040000  \n\n \n#define\tCRYPTO_PROVIDER_DESCR_MAX_LEN\t64\n\n\n \ntypedef struct crypto_mech_info {\n\tcrypto_mech_name_t\tcm_mech_name;\n\tcrypto_mech_type_t\tcm_mech_number;\n\tcrypto_func_group_t\tcm_func_group_mask;\n} crypto_mech_info_t;\n\n \ntypedef uint_t crypto_kcf_provider_handle_t;\n\n \ntypedef struct crypto_provider_info {\n\tconst char\t\t\t\t*pi_provider_description;\n\tconst crypto_ops_t\t\t\t*pi_ops_vector;\n\tuint_t\t\t\t\tpi_mech_list_count;\n\tconst crypto_mech_info_t\t\t*pi_mechanisms;\n} crypto_provider_info_t;\n\n \nextern int crypto_register_provider(const crypto_provider_info_t *,\n\t\tcrypto_kcf_provider_handle_t *);\nextern int crypto_unregister_provider(crypto_kcf_provider_handle_t);\n\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}