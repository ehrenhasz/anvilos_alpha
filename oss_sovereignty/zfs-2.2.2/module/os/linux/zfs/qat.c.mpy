{
  "module_name": "qat.c",
  "hash_id": "9ee735a69ea4ed0141e3fbc37468fbdb810fe0ef8e850e4c5003c44ac82bd58c",
  "original_prompt": "Ingested from zfs-2.2.2/module/os/linux/zfs/qat.c",
  "human_readable_source": " \n\n#if defined(_KERNEL) && defined(HAVE_QAT)\n#include <sys/zfs_context.h>\n#include <sys/qat.h>\n\nqat_stats_t qat_stats = {\n\t{ \"comp_requests\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"comp_total_in_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"comp_total_out_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"decomp_requests\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"decomp_total_in_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"decomp_total_out_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"dc_fails\",\t\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"encrypt_requests\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"encrypt_total_in_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"encrypt_total_out_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"decrypt_requests\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"decrypt_total_in_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"decrypt_total_out_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"crypt_fails\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"cksum_requests\",\t\t\tKSTAT_DATA_UINT64 },\n\t{ \"cksum_total_in_bytes\",\t\tKSTAT_DATA_UINT64 },\n\t{ \"cksum_fails\",\t\t\tKSTAT_DATA_UINT64 },\n};\n\nstatic kstat_t *qat_ksp = NULL;\n\nCpaStatus\nqat_mem_alloc_contig(void **pp_mem_addr, Cpa32U size_bytes)\n{\n\t*pp_mem_addr = kmalloc(size_bytes, GFP_KERNEL);\n\tif (*pp_mem_addr == NULL)\n\t\treturn (CPA_STATUS_RESOURCE);\n\treturn (CPA_STATUS_SUCCESS);\n}\n\nvoid\nqat_mem_free_contig(void **pp_mem_addr)\n{\n\tif (*pp_mem_addr != NULL) {\n\t\tkfree(*pp_mem_addr);\n\t\t*pp_mem_addr = NULL;\n\t}\n}\n\nint\nqat_init(void)\n{\n\tqat_ksp = kstat_create(\"zfs\", 0, \"qat\", \"misc\",\n\t    KSTAT_TYPE_NAMED, sizeof (qat_stats) / sizeof (kstat_named_t),\n\t    KSTAT_FLAG_VIRTUAL);\n\tif (qat_ksp != NULL) {\n\t\tqat_ksp->ks_data = &qat_stats;\n\t\tkstat_install(qat_ksp);\n\t}\n\n\t \n\tif (qat_dc_init() != 0)\n\t\tzfs_qat_compress_disable = 1;\n\n\tif (qat_cy_init() != 0) {\n\t\tzfs_qat_checksum_disable = 1;\n\t\tzfs_qat_encrypt_disable = 1;\n\t}\n\n\treturn (0);\n}\n\nvoid\nqat_fini(void)\n{\n\tif (qat_ksp != NULL) {\n\t\tkstat_delete(qat_ksp);\n\t\tqat_ksp = NULL;\n\t}\n\n\tqat_cy_fini();\n\tqat_dc_fini();\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}