{
  "module_name": "spl-err.c",
  "hash_id": "6e92db144e4edd76661b12e57553e6db8e364373544e1c3f8a31c914b556ce67",
  "original_prompt": "Ingested from zfs-2.2.2/module/os/linux/spl/spl-err.c",
  "human_readable_source": " \n\n#include <sys/sysmacros.h>\n#include <sys/cmn_err.h>\n\n \nstatic unsigned int spl_panic_halt;\n \nmodule_param(spl_panic_halt, uint, 0644);\nMODULE_PARM_DESC(spl_panic_halt, \"Cause kernel panic on assertion failures\");\n\nvoid\nspl_dumpstack(void)\n{\n\tprintk(\"Showing stack for process %d\\n\", current->pid);\n\tdump_stack();\n}\nEXPORT_SYMBOL(spl_dumpstack);\n\nvoid\nspl_panic(const char *file, const char *func, int line, const char *fmt, ...)\n{\n\tconst char *newfile;\n\tchar msg[MAXMSGLEN];\n\tva_list ap;\n\n\tnewfile = strrchr(file, '/');\n\tif (newfile != NULL)\n\t\tnewfile = newfile + 1;\n\telse\n\t\tnewfile = file;\n\n\tva_start(ap, fmt);\n\t(void) vsnprintf(msg, sizeof (msg), fmt, ap);\n\tva_end(ap);\n\n\tprintk(KERN_EMERG \"%s\", msg);\n\tprintk(KERN_EMERG \"PANIC at %s:%d:%s()\\n\", newfile, line, func);\n\tif (spl_panic_halt)\n\t\tpanic(\"%s\", msg);\n\n\tspl_dumpstack();\n\n\t \n\tset_current_state(TASK_UNINTERRUPTIBLE);\n\twhile (1)\n\t\tschedule();\n\n\t \n}\nEXPORT_SYMBOL(spl_panic);\n\nvoid\nvcmn_err(int ce, const char *fmt, va_list ap)\n{\n\tchar msg[MAXMSGLEN];\n\n\tvsnprintf(msg, MAXMSGLEN, fmt, ap);\n\n\tswitch (ce) {\n\tcase CE_IGNORE:\n\t\tbreak;\n\tcase CE_CONT:\n\t\tprintk(\"%s\", msg);\n\t\tbreak;\n\tcase CE_NOTE:\n\t\tprintk(KERN_NOTICE \"NOTICE: %s\\n\", msg);\n\t\tbreak;\n\tcase CE_WARN:\n\t\tprintk(KERN_WARNING \"WARNING: %s\\n\", msg);\n\t\tbreak;\n\tcase CE_PANIC:\n\t\tprintk(KERN_EMERG \"PANIC: %s\\n\", msg);\n\t\tif (spl_panic_halt)\n\t\t\tpanic(\"%s\", msg);\n\n\t\tspl_dumpstack();\n\n\t\t \n\t\tset_current_state(TASK_UNINTERRUPTIBLE);\n\t\twhile (1)\n\t\t\tschedule();\n\t}\n}  \nEXPORT_SYMBOL(vcmn_err);\n\nvoid\ncmn_err(int ce, const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvcmn_err(ce, fmt, ap);\n\tva_end(ap);\n}  \nEXPORT_SYMBOL(cmn_err);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}