{
  "module_name": "spl_uio.c",
  "hash_id": "e3dff8eee38ae8d6a1c50df9503118cf9403fe5142d4594d33058ccc10af2f13",
  "original_prompt": "Ingested from zfs-2.2.2/module/os/freebsd/spl/spl_uio.c",
  "human_readable_source": " \n \n\n \n \n\n \n\n \n\n#include <sys/param.h>\n#include <sys/uio_impl.h>\n#include <sys/vnode.h>\n#include <sys/zfs_znode.h>\n\nint\nzfs_uiomove(void *cp, size_t n, zfs_uio_rw_t dir, zfs_uio_t *uio)\n{\n\tASSERT3U(zfs_uio_rw(uio), ==, dir);\n\treturn (uiomove(cp, (int)n, GET_UIO_STRUCT(uio)));\n}\n\n \nint\nzfs_uiocopy(void *p, size_t n, zfs_uio_rw_t rw, zfs_uio_t *uio, size_t *cbytes)\n{\n\tstruct iovec small_iovec[1];\n\tstruct uio small_uio_clone;\n\tstruct uio *uio_clone;\n\tint error;\n\n\tASSERT3U(zfs_uio_rw(uio), ==, rw);\n\tif (zfs_uio_iovcnt(uio) == 1) {\n\t\tsmall_uio_clone = *(GET_UIO_STRUCT(uio));\n\t\tsmall_iovec[0] = *(GET_UIO_STRUCT(uio)->uio_iov);\n\t\tsmall_uio_clone.uio_iov = small_iovec;\n\t\tuio_clone = &small_uio_clone;\n\t} else {\n\t\tuio_clone = cloneuio(GET_UIO_STRUCT(uio));\n\t}\n\n\terror = vn_io_fault_uiomove(p, n, uio_clone);\n\t*cbytes = zfs_uio_resid(uio) - uio_clone->uio_resid;\n\tif (uio_clone != &small_uio_clone)\n\t\tfree(uio_clone, M_IOV);\n\treturn (error);\n}\n\n \nvoid\nzfs_uioskip(zfs_uio_t *uio, size_t n)\n{\n\tzfs_uio_seg_t segflg;\n\n\t \n\tif (n > zfs_uio_resid(uio))\n\t\treturn;\n\n\tsegflg = zfs_uio_segflg(uio);\n\tzfs_uio_segflg(uio) = UIO_NOCOPY;\n\tzfs_uiomove(NULL, n, zfs_uio_rw(uio), uio);\n\tzfs_uio_segflg(uio) = segflg;\n}\n\nint\nzfs_uio_fault_move(void *p, size_t n, zfs_uio_rw_t dir, zfs_uio_t *uio)\n{\n\tASSERT3U(zfs_uio_rw(uio), ==, dir);\n\treturn (vn_io_fault_uiomove(p, n, GET_UIO_STRUCT(uio)));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}