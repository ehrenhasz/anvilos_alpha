{
  "module_name": "zfs_fletcher_superscalar4.c",
  "hash_id": "84345ee74e1387639c7fedf67193bb8545625b8ecfaf1410c53e36ae0566861f",
  "original_prompt": "Ingested from zfs-2.2.2/module/zcommon/zfs_fletcher_superscalar4.c",
  "human_readable_source": " \n\n#include <sys/param.h>\n#include <sys/byteorder.h>\n#include <sys/spa_checksum.h>\n#include <sys/string.h>\n#include <zfs_fletcher.h>\n\nstatic void\nfletcher_4_superscalar4_init(fletcher_4_ctx_t *ctx)\n{\n\tmemset(ctx->superscalar, 0, 4 * sizeof (zfs_fletcher_superscalar_t));\n}\n\nstatic void\nfletcher_4_superscalar4_fini(fletcher_4_ctx_t *ctx, zio_cksum_t *zcp)\n{\n\tuint64_t A, B, C, D;\n\n\tA = ctx->superscalar[0].v[0] + ctx->superscalar[0].v[1] +\n\t    ctx->superscalar[0].v[2] + ctx->superscalar[0].v[3];\n\tB = 0 - ctx->superscalar[0].v[1] - 2 * ctx->superscalar[0].v[2] -\n\t    3 * ctx->superscalar[0].v[3] + 4 * ctx->superscalar[1].v[0] +\n\t    4 * ctx->superscalar[1].v[1] + 4 * ctx->superscalar[1].v[2] +\n\t    4 * ctx->superscalar[1].v[3];\n\n\tC = ctx->superscalar[0].v[2] + 3 * ctx->superscalar[0].v[3] -\n\t    6 * ctx->superscalar[1].v[0] - 10 * ctx->superscalar[1].v[1] -\n\t    14 * ctx->superscalar[1].v[2] - 18 * ctx->superscalar[1].v[3] +\n\t    16 * ctx->superscalar[2].v[0] + 16 * ctx->superscalar[2].v[1] +\n\t    16 * ctx->superscalar[2].v[2] + 16 * ctx->superscalar[2].v[3];\n\n\tD = 0 - ctx->superscalar[0].v[3] + 4 * ctx->superscalar[1].v[0] +\n\t    10 * ctx->superscalar[1].v[1] + 20 * ctx->superscalar[1].v[2] +\n\t    34 * ctx->superscalar[1].v[3] - 48 * ctx->superscalar[2].v[0] -\n\t    64 * ctx->superscalar[2].v[1] - 80 * ctx->superscalar[2].v[2] -\n\t    96 * ctx->superscalar[2].v[3] + 64 * ctx->superscalar[3].v[0] +\n\t    64 * ctx->superscalar[3].v[1] + 64 * ctx->superscalar[3].v[2] +\n\t    64 * ctx->superscalar[3].v[3];\n\n\tZIO_SET_CHECKSUM(zcp, A, B, C, D);\n}\n\nstatic void\nfletcher_4_superscalar4_native(fletcher_4_ctx_t *ctx,\n    const void *buf, uint64_t size)\n{\n\tconst uint32_t *ip = buf;\n\tconst uint32_t *ipend = ip + (size / sizeof (uint32_t));\n\tuint64_t a, b, c, d;\n\tuint64_t a2, b2, c2, d2;\n\tuint64_t a3, b3, c3, d3;\n\tuint64_t a4, b4, c4, d4;\n\n\ta = ctx->superscalar[0].v[0];\n\tb = ctx->superscalar[1].v[0];\n\tc = ctx->superscalar[2].v[0];\n\td = ctx->superscalar[3].v[0];\n\ta2 = ctx->superscalar[0].v[1];\n\tb2 = ctx->superscalar[1].v[1];\n\tc2 = ctx->superscalar[2].v[1];\n\td2 = ctx->superscalar[3].v[1];\n\ta3 = ctx->superscalar[0].v[2];\n\tb3 = ctx->superscalar[1].v[2];\n\tc3 = ctx->superscalar[2].v[2];\n\td3 = ctx->superscalar[3].v[2];\n\ta4 = ctx->superscalar[0].v[3];\n\tb4 = ctx->superscalar[1].v[3];\n\tc4 = ctx->superscalar[2].v[3];\n\td4 = ctx->superscalar[3].v[3];\n\n\tdo {\n\t\ta += ip[0];\n\t\ta2 += ip[1];\n\t\ta3 += ip[2];\n\t\ta4 += ip[3];\n\t\tb += a;\n\t\tb2 += a2;\n\t\tb3 += a3;\n\t\tb4 += a4;\n\t\tc += b;\n\t\tc2 += b2;\n\t\tc3 += b3;\n\t\tc4 += b4;\n\t\td += c;\n\t\td2 += c2;\n\t\td3 += c3;\n\t\td4 += c4;\n\t} while ((ip += 4) < ipend);\n\n\tctx->superscalar[0].v[0] = a;\n\tctx->superscalar[1].v[0] = b;\n\tctx->superscalar[2].v[0] = c;\n\tctx->superscalar[3].v[0] = d;\n\tctx->superscalar[0].v[1] = a2;\n\tctx->superscalar[1].v[1] = b2;\n\tctx->superscalar[2].v[1] = c2;\n\tctx->superscalar[3].v[1] = d2;\n\tctx->superscalar[0].v[2] = a3;\n\tctx->superscalar[1].v[2] = b3;\n\tctx->superscalar[2].v[2] = c3;\n\tctx->superscalar[3].v[2] = d3;\n\tctx->superscalar[0].v[3] = a4;\n\tctx->superscalar[1].v[3] = b4;\n\tctx->superscalar[2].v[3] = c4;\n\tctx->superscalar[3].v[3] = d4;\n}\n\nstatic void\nfletcher_4_superscalar4_byteswap(fletcher_4_ctx_t *ctx,\n    const void *buf, uint64_t size)\n{\n\tconst uint32_t *ip = buf;\n\tconst uint32_t *ipend = ip + (size / sizeof (uint32_t));\n\tuint64_t a, b, c, d;\n\tuint64_t a2, b2, c2, d2;\n\tuint64_t a3, b3, c3, d3;\n\tuint64_t a4, b4, c4, d4;\n\n\ta = ctx->superscalar[0].v[0];\n\tb = ctx->superscalar[1].v[0];\n\tc = ctx->superscalar[2].v[0];\n\td = ctx->superscalar[3].v[0];\n\ta2 = ctx->superscalar[0].v[1];\n\tb2 = ctx->superscalar[1].v[1];\n\tc2 = ctx->superscalar[2].v[1];\n\td2 = ctx->superscalar[3].v[1];\n\ta3 = ctx->superscalar[0].v[2];\n\tb3 = ctx->superscalar[1].v[2];\n\tc3 = ctx->superscalar[2].v[2];\n\td3 = ctx->superscalar[3].v[2];\n\ta4 = ctx->superscalar[0].v[3];\n\tb4 = ctx->superscalar[1].v[3];\n\tc4 = ctx->superscalar[2].v[3];\n\td4 = ctx->superscalar[3].v[3];\n\n\tdo {\n\t\ta += BSWAP_32(ip[0]);\n\t\ta2 += BSWAP_32(ip[1]);\n\t\ta3 += BSWAP_32(ip[2]);\n\t\ta4 += BSWAP_32(ip[3]);\n\t\tb += a;\n\t\tb2 += a2;\n\t\tb3 += a3;\n\t\tb4 += a4;\n\t\tc += b;\n\t\tc2 += b2;\n\t\tc3 += b3;\n\t\tc4 += b4;\n\t\td += c;\n\t\td2 += c2;\n\t\td3 += c3;\n\t\td4 += c4;\n\t} while ((ip += 4) < ipend);\n\n\tctx->superscalar[0].v[0] = a;\n\tctx->superscalar[1].v[0] = b;\n\tctx->superscalar[2].v[0] = c;\n\tctx->superscalar[3].v[0] = d;\n\tctx->superscalar[0].v[1] = a2;\n\tctx->superscalar[1].v[1] = b2;\n\tctx->superscalar[2].v[1] = c2;\n\tctx->superscalar[3].v[1] = d2;\n\tctx->superscalar[0].v[2] = a3;\n\tctx->superscalar[1].v[2] = b3;\n\tctx->superscalar[2].v[2] = c3;\n\tctx->superscalar[3].v[2] = d3;\n\tctx->superscalar[0].v[3] = a4;\n\tctx->superscalar[1].v[3] = b4;\n\tctx->superscalar[2].v[3] = c4;\n\tctx->superscalar[3].v[3] = d4;\n}\n\nstatic boolean_t fletcher_4_superscalar4_valid(void)\n{\n\treturn (B_TRUE);\n}\n\nconst fletcher_4_ops_t fletcher_4_superscalar4_ops = {\n\t.init_native = fletcher_4_superscalar4_init,\n\t.compute_native = fletcher_4_superscalar4_native,\n\t.fini_native = fletcher_4_superscalar4_fini,\n\t.init_byteswap = fletcher_4_superscalar4_init,\n\t.compute_byteswap = fletcher_4_superscalar4_byteswap,\n\t.fini_byteswap = fletcher_4_superscalar4_fini,\n\t.valid = fletcher_4_superscalar4_valid,\n\t.uses_fpu = B_FALSE,\n\t.name = \"superscalar4\"\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}