{
  "module_name": "mancheck.sh",
  "hash_id": "28d85f6d709e9b690d8cab7837c49e695b68b6c1687ddce8fbc9a8365446f584",
  "original_prompt": "Ingested from zfs-2.2.2/scripts/mancheck.sh",
  "human_readable_source": "#!/bin/sh\n#\n# Permission to use, copy, modify, and/or distribute this software for\n# any purpose with or without fee is hereby granted.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\n# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\n# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\n# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN\n# AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT\n# OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n#\n# shellcheck disable=SC2086\n\ntrap 'rm -f \"$stdout_file\" \"$stderr_file\" \"$result_file\"' EXIT\n\nif [ \"$#\" -eq 0 ]; then\n    echo \"Usage: $0 manpage-directory...\"\n    exit 1\nfi\n\nif ! command -v mandoc > /dev/null; then\n    echo \"skipping mancheck because mandoc is not installed\"\n    exit 0\nfi\n\nIFS=\"\n\"\nfiles=\"$(find \"$@\" -type f -name '*[1-9]*' -not -name '.*')\" || exit 1\n\nadd_excl=\"$(awk '\n    /^.\\\\\" lint-ok:/ {\n        print \"-e\"\n        $1 = \"mandoc:\"\n        $2 = FILENAME \":[[:digit:]]+:[[:digit:]]+:\"\n        print\n    }' $files)\"\n\n# Redirect to file instead of 2>&1ing because mandoc flushes inconsistently(?) which tears lines\n# https://github.com/openzfs/zfs/pull/12129/checks?check_run_id=2701608671#step:5:3\nstdout_file=\"$(mktemp)\"\nstderr_file=\"$(mktemp)\"\nmandoc -Tlint $files 1>\"$stdout_file\" 2>\"$stderr_file\"\nresult_file=\"$(mktemp)\"\ngrep -vhE -e 'mandoc: outdated mandoc.db' -e 'STYLE: referenced manual not found' $add_excl \"$stdout_file\" \"$stderr_file\" > \"$result_file\"\n\nif [ -s \"$result_file\" ]; then\n    cat \"$result_file\"\n    exit 1\nelse\n    echo \"no errors found\"\nfi\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}