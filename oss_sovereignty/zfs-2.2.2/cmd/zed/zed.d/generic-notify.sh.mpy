{
  "module_name": "generic-notify.sh",
  "hash_id": "186eef3e514e70acae5a67ff4be2656bc07ff441dba3914dd614de0487bcbcf4",
  "original_prompt": "Ingested from zfs-2.2.2/cmd/zed/zed.d/generic-notify.sh",
  "human_readable_source": "#!/bin/sh\n# shellcheck disable=SC2154\n#\n# Send notification in response to a given zevent.\n#\n# This is a generic script than can be symlinked to a file in the\n# enabled-zedlets directory to have a notification sent when a particular\n# class of zevents occurs.  The symlink filename must begin with the zevent\n# (sub)class string (e.g., \"probe_failure-notify.sh\" for the \"probe_failure\"\n# subclass).  Refer to the zed(8) manpage for details.\n#\n# Only one notification per ZED_NOTIFY_INTERVAL_SECS will be sent for a given\n# class/pool combination.  This protects against spamming the recipient\n# should multiple events occur together in time for the same pool.\n#\n# Exit codes:\n#   0: notification sent\n#   1: notification failed\n#   2: notification not configured\n#   3: notification suppressed\n\n[ -f \"${ZED_ZEDLET_DIR}/zed.rc\" ] && . \"${ZED_ZEDLET_DIR}/zed.rc\"\n. \"${ZED_ZEDLET_DIR}/zed-functions.sh\"\n\n# Rate-limit the notification based in part on the filename.\n#\nrate_limit_tag=\"${ZEVENT_POOL};${ZEVENT_SUBCLASS};${0##*/}\"\nrate_limit_interval=\"${ZED_NOTIFY_INTERVAL_SECS}\"\nzed_rate_limit \"${rate_limit_tag}\" \"${rate_limit_interval}\" || exit 3\n\numask 077\npool_str=\"${ZEVENT_POOL:+\" for ${ZEVENT_POOL}\"}\"\nhost_str=\" on $(hostname)\"\nnote_subject=\"ZFS ${ZEVENT_SUBCLASS} event${pool_str}${host_str}\"\nnote_pathname=\"$(mktemp)\"\n{\n    echo \"ZFS has posted the following event:\"\n    echo\n    echo \"   eid: ${ZEVENT_EID}\"\n    echo \" class: ${ZEVENT_SUBCLASS}\"\n    echo \"  host: $(hostname)\"\n    echo \"  time: ${ZEVENT_TIME_STRING}\"\n\n    [ -n \"${ZEVENT_VDEV_TYPE}\" ] && echo \" vtype: ${ZEVENT_VDEV_TYPE}\"\n    [ -n \"${ZEVENT_VDEV_PATH}\" ] && echo \" vpath: ${ZEVENT_VDEV_PATH}\"\n    [ -n \"${ZEVENT_VDEV_GUID}\" ] && echo \" vguid: ${ZEVENT_VDEV_GUID}\"\n\n    [ -n \"${ZEVENT_POOL}\" ] && [ -x \"${ZPOOL}\" ] \\\n        && \"${ZPOOL}\" status \"${ZEVENT_POOL}\"\n\n} > \"${note_pathname}\"\n\nzed_notify \"${note_subject}\" \"${note_pathname}\"; rv=$?\nrm -f \"${note_pathname}\"\nexit \"${rv}\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}