{
  "module_name": "fmd_api.h",
  "hash_id": "c5872ce24c35f6e49d063bf91ae5f313dc30d80b18b6bd08a3b49f3993600bf3",
  "original_prompt": "Ingested from zfs-2.2.2/cmd/zed/agents/fmd_api.h",
  "human_readable_source": " \n\n \n\n#ifndef\t_FMD_API_H\n#define\t_FMD_API_H\n\n#include <sys/types.h>\n#include <sys/time.h>\n#include <time.h>\n#include <libnvpair.h>\n#include <stdarg.h>\n#include <umem.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n \n\n#define\tFMD_API_VERSION\t\t5\n\ntypedef struct fmd_hdl fmd_hdl_t;\n\ntypedef struct fmd_timer {\n\ttimer_t\t\tft_tid;\n\tvoid\t\t*ft_arg;\n\tfmd_hdl_t\t*ft_hdl;\n} fmd_timer_t;\n\n#define\tid_t\tfmd_timer_t *\n\n\ntypedef struct fmd_event {\n\thrtime_t\tev_hrt;\t\t \n} fmd_event_t;\n\ntypedef struct fmd_case {\n\tchar\t\tci_uuid[48];\t \n\tfmd_hdl_t\t*ci_mod;\t \n\tvoid\t\t*ci_data;\t \n\tushort_t\tci_state;\t \n\tushort_t\tci_flags;\t \n\tstruct timeval\tci_tv;\t\t \n\tvoid\t\t*ci_bufptr;\t \n\tsize_t\t\tci_bufsiz;\n} fmd_case_t;\n\n\n#define\tFMD_CASE_UNSOLVED\t0\t \n#define\tFMD_CASE_SOLVED\t\t1\t \n#define\tFMD_CASE_CLOSE_WAIT\t2\t \n#define\tFMD_CASE_CLOSED\t\t3\t \n#define\tFMD_CASE_REPAIRED\t4\t \n#define\tFMD_CASE_RESOLVED\t5\t \n\n#define\tFMD_CF_DIRTY\t\t0x01\t \n#define\tFMD_CF_SOLVED\t\t0x02\t \n#define\tFMD_CF_ISOLATED\t\t0x04\t \n#define\tFMD_CF_REPAIRED\t\t0x08\t \n#define\tFMD_CF_RESOLVED\t\t0x10\t \n\n\n#define\tFMD_TYPE_BOOL\t0\t\t \n#define\tFMD_TYPE_INT32\t1\t\t \n#define\tFMD_TYPE_UINT32\t2\t\t \n#define\tFMD_TYPE_INT64\t3\t\t \n#define\tFMD_TYPE_UINT64\t4\t\t \n#define\tFMD_TYPE_TIME\t5\t\t \n#define\tFMD_TYPE_SIZE\t6\t\t \n\ntypedef struct fmd_prop {\n\tconst char *fmdp_name;\t\t \n\tuint_t fmdp_type;\t\t \n\tconst char *fmdp_defv;\t\t \n} fmd_prop_t;\n\ntypedef struct fmd_stat {\n\tchar fmds_name[32];\t\t \n\tuint_t fmds_type;\t\t \n\tchar fmds_desc[64];\t\t \n\tunion {\n\t\tint bool;\t\t \n\t\tint32_t i32;\t\t \n\t\tuint32_t ui32;\t\t \n\t\tint64_t i64;\t\t \n\t\tuint64_t ui64;\t\t \n\t} fmds_value;\n} fmd_stat_t;\n\ntypedef struct fmd_hdl_ops {\n\tvoid (*fmdo_recv)(fmd_hdl_t *, fmd_event_t *, nvlist_t *, const char *);\n\tvoid (*fmdo_timeout)(fmd_hdl_t *, id_t, void *);\n\tvoid (*fmdo_close)(fmd_hdl_t *, fmd_case_t *);\n\tvoid (*fmdo_stats)(fmd_hdl_t *);\n\tvoid (*fmdo_gc)(fmd_hdl_t *);\n} fmd_hdl_ops_t;\n\n#define\tFMD_SEND_SUCCESS\t0\t \n#define\tFMD_SEND_FAILED\t\t1\t \n#define\tFMD_SEND_RETRY\t\t2\t \n\ntypedef struct fmd_hdl_info {\n\tconst char *fmdi_desc;\t\t \n\tconst char *fmdi_vers;\t\t \n\tconst fmd_hdl_ops_t *fmdi_ops;\t \n\tconst fmd_prop_t *fmdi_props;\t \n} fmd_hdl_info_t;\n\nextern int fmd_hdl_register(fmd_hdl_t *, int, const fmd_hdl_info_t *);\nextern void fmd_hdl_unregister(fmd_hdl_t *);\n\nextern void fmd_hdl_setspecific(fmd_hdl_t *, void *);\nextern void *fmd_hdl_getspecific(fmd_hdl_t *);\n\n#define\tFMD_SLEEP\tUMEM_NOFAIL\n\nextern void *fmd_hdl_alloc(fmd_hdl_t *, size_t, int);\nextern void *fmd_hdl_zalloc(fmd_hdl_t *, size_t, int);\nextern void fmd_hdl_free(fmd_hdl_t *, void *, size_t);\n\nextern char *fmd_hdl_strdup(fmd_hdl_t *, const char *, int);\nextern void fmd_hdl_strfree(fmd_hdl_t *, char *);\n\nextern void fmd_hdl_vdebug(fmd_hdl_t *, const char *, va_list);\nextern void fmd_hdl_debug(fmd_hdl_t *, const char *, ...);\n\nextern int32_t fmd_prop_get_int32(fmd_hdl_t *, const char *);\nextern int64_t fmd_prop_get_int64(fmd_hdl_t *, const char *);\n\n#define\tFMD_STAT_NOALLOC\t0x0\t \n#define\tFMD_STAT_ALLOC\t\t0x1\t \n\nextern fmd_stat_t *fmd_stat_create(fmd_hdl_t *, uint_t, uint_t, fmd_stat_t *);\nextern void fmd_stat_destroy(fmd_hdl_t *, uint_t, fmd_stat_t *);\nextern void fmd_stat_setstr(fmd_hdl_t *, fmd_stat_t *, const char *);\n\nextern fmd_case_t *fmd_case_open(fmd_hdl_t *, void *);\nextern void fmd_case_reset(fmd_hdl_t *, fmd_case_t *);\nextern void fmd_case_solve(fmd_hdl_t *, fmd_case_t *);\nextern void fmd_case_close(fmd_hdl_t *, fmd_case_t *);\n\nextern const char *fmd_case_uuid(fmd_hdl_t *, fmd_case_t *);\nextern fmd_case_t *fmd_case_uulookup(fmd_hdl_t *, const char *);\nextern void fmd_case_uuclose(fmd_hdl_t *, const char *);\nextern int fmd_case_uuclosed(fmd_hdl_t *, const char *);\nextern int fmd_case_uuisresolved(fmd_hdl_t *, const char *);\nextern void fmd_case_uuresolved(fmd_hdl_t *, const char *);\n\nextern boolean_t fmd_case_solved(fmd_hdl_t *, fmd_case_t *);\n\nextern void fmd_case_add_ereport(fmd_hdl_t *, fmd_case_t *, fmd_event_t *);\nextern void fmd_case_add_serd(fmd_hdl_t *, fmd_case_t *, const char *);\nextern void fmd_case_add_suspect(fmd_hdl_t *, fmd_case_t *, nvlist_t *);\n\nextern void fmd_case_setspecific(fmd_hdl_t *, fmd_case_t *, void *);\nextern void *fmd_case_getspecific(fmd_hdl_t *, fmd_case_t *);\n\nextern fmd_case_t *fmd_case_next(fmd_hdl_t *, fmd_case_t *);\nextern fmd_case_t *fmd_case_prev(fmd_hdl_t *, fmd_case_t *);\n\nextern void fmd_buf_create(fmd_hdl_t *, fmd_case_t *, const char *, size_t);\nextern void fmd_buf_destroy(fmd_hdl_t *, fmd_case_t *, const char *);\nextern void fmd_buf_read(fmd_hdl_t *, fmd_case_t *,\n    const char *, void *, size_t);\nextern void fmd_buf_write(fmd_hdl_t *, fmd_case_t *,\n    const char *, const void *, size_t);\nextern size_t fmd_buf_size(fmd_hdl_t *, fmd_case_t *, const char *);\n\nextern void fmd_serd_create(fmd_hdl_t *, const char *, uint_t, hrtime_t);\nextern void fmd_serd_destroy(fmd_hdl_t *, const char *);\nextern int fmd_serd_exists(fmd_hdl_t *, const char *);\nextern void fmd_serd_reset(fmd_hdl_t *, const char *);\nextern int fmd_serd_record(fmd_hdl_t *, const char *, fmd_event_t *);\nextern int fmd_serd_fired(fmd_hdl_t *, const char *);\nextern int fmd_serd_empty(fmd_hdl_t *, const char *);\n\nextern id_t fmd_timer_install(fmd_hdl_t *, void *, fmd_event_t *, hrtime_t);\nextern void fmd_timer_remove(fmd_hdl_t *, id_t);\n\nextern nvlist_t *fmd_nvl_create_fault(fmd_hdl_t *,\n    const char *, uint8_t, nvlist_t *, nvlist_t *, nvlist_t *);\n\nextern int fmd_nvl_class_match(fmd_hdl_t *, nvlist_t *, const char *);\n\n#define\tFMD_HAS_FAULT_FRU\t0\n#define\tFMD_HAS_FAULT_ASRU\t1\n#define\tFMD_HAS_FAULT_RESOURCE\t2\n\nextern void fmd_repair_fru(fmd_hdl_t *, const char *);\nextern int fmd_repair_asru(fmd_hdl_t *, const char *);\n\nextern nvlist_t *fmd_nvl_alloc(fmd_hdl_t *, int);\nextern nvlist_t *fmd_nvl_dup(fmd_hdl_t *, nvlist_t *, int);\n\n \n\nextern fmd_hdl_t *fmd_module_hdl(const char *);\nextern boolean_t fmd_module_initialized(fmd_hdl_t *);\nextern void fmd_module_recv(fmd_hdl_t *, nvlist_t *, const char *);\n\n \nextern void _zfs_retire_init(fmd_hdl_t *);\nextern void _zfs_retire_fini(fmd_hdl_t *);\n\n \nextern void _zfs_diagnosis_init(fmd_hdl_t *);\nextern void _zfs_diagnosis_fini(fmd_hdl_t *);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}