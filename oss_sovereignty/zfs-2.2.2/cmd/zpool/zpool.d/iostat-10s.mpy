{
  "module_name": "iostat-10s",
  "hash_id": "372b4296dbaa24b3d8fae1d4f3d694cacab86e6d54a6937932b2ccf991e3ea57",
  "original_prompt": "Ingested from zfs-2.2.2/cmd/zpool/zpool.d/iostat-10s",
  "human_readable_source": "#!/bin/sh\n#\n# Display most relevant iostat bandwidth/latency numbers.  The output is\n# dependent on the name of the script/symlink used to call it.\n#\n\nhelpstr=\"\niostat:\t\tShow iostat values since boot (summary page).\niostat-1s:\tDo a single 1-second iostat sample and show values.\niostat-10s:\tDo a single 10-second iostat sample and show values.\"\n\nscript=\"${0##*/}\"\nif [ \"$1\" = \"-h\" ] ; then\n\techo \"$helpstr\" | grep \"$script:\" | tr -s '\\t' | cut -f 2-\n\texit\nfi\n\n# Sometimes, UPATH ends up /dev/(null).\n# That should be corrected, but for now...\n# shellcheck disable=SC2154\nif [ ! -b \"$VDEV_UPATH\" ]; then\n\tsomepath=\"${VDEV_PATH}\"\nelse\n\tsomepath=\"${VDEV_UPATH}\"\nfi\n\nif [ \"$script\" = \"iostat-1s\" ] ; then\n\t# Do a single one-second sample\n\tinterval=1\n\t# Don't show summary stats\n\tbrief=\"yes\"\nelif [ \"$script\" = \"iostat-10s\" ] ; then\n\t# Do a single ten-second sample\n\tinterval=10\n\t# Don't show summary stats\n\tbrief=\"yes\"\nfi\n\nif [ -f \"$somepath\" ] ; then\n\t# We're a file-based vdev, iostat doesn't work on us.  Do nothing.\n\texit\nfi\n\nif [ \"$(uname)\" = \"FreeBSD\" ]; then\n\tout=$(iostat -dKx \\\n\t\t${interval:+\"-w $interval\"} \\\n\t\t${interval:+\"-c 1\"} \\\n\t\t\"$somepath\" | tail -n 2)\nelse\n\tout=$(iostat -kx \\\n\t\t${brief:+\"-y\"} \\\n\t\t${interval:+\"$interval\"} \\\n\t\t${interval:+\"1\"} \\\n\t\t\"$somepath\" | grep -v '^$' | tail -n 2)\nfi\n\n\n# Sample output (we want the last two lines):\n#\n# Linux 2.6.32-642.13.1.el6.x86_64 (centos68) \t03/09/2017 \t_x86_64_\t(6 CPU)\n#\n# avg-cpu:  %user   %nice %system %iowait  %steal   %idle\n#           0.00    0.00    0.00    0.00    0.00  100.00\n#\n# Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util\n# sdb               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00    0.00    0.00   0.00   0.00\n#\n\n# Get the column names\ncols=$(echo \"$out\" | head -n 1)\n\n# Get the values and tab separate them to make them cut-able.\nvals=$(echo \"$out\" | tail -n 1 | tr -s '[:space:]' '\\t')\n\ni=0\nfor col in $cols ; do\n\ti=$((i+1))\n\t# Skip the first column since it's just the device name\n\tif [ \"$i\" -eq 1 ]; then\n\t\tcontinue\n\tfi\n\n\t# Get i'th value\n\tval=$(echo \"$vals\" | cut -f \"$i\")\n\techo \"$col=$val\"\ndone\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}