{
  "module_name": "Makefile.am",
  "hash_id": "8c60c7dee64fa83e7375f134a2b281c98550d56e71a84a54e402ca9eedb7e200",
  "original_prompt": "Ingested from zfs-2.2.2/lib/Makefile.am",
  "human_readable_source": "#\n# Shown below is a simplified dependency graph of the OpenZFS provided\n# libraries.  Administrative commands (`zfs`, `zpool`, etc) interface with\n# the kernel modules using the `libzfs.so` and `libzfs_core.so` libraries.\n# These libraries provide a stable ABI across OpenZFS point releases.\n#\n# The `libzpool.so` library is a user space build of the DMU and SPA layers\n# used to implement debugging tools (zdb) and code validation tools (ztest).\n# These library interfaces are subject to change at any time.\n#\n#\n# CMDS:   zhack/ztest/zdb/            zfs/zpool/zed/\n#        raidz_{test,bench}          zinject/zstream\n#                |                          |\n# LIBS:          |                          |              libzfsbootenv*\n#                |                          |                    |\n#                |                          |                    |\n#             libzpool                   libzfs* ----------------+\n#             | | |  \\                  / | | |\n#    libicp --/ | |   \\                /  | | \\------- libshare\n#               | |    \\              /   | |\n#    libzstd ---/ |     \\            /    | \\--------- libuutil\n#                 |      \\          /     \\              | |\n#    libunicode --/       \\        /       \\             | |\n#                          \\      /         \\            | |\n#                          libzutil        libzfs_core*  | |\n#                          | | | | \\          |     |    | |\n#                          | | | | |          |     |    | |\n#                          | | | | |          |     |    | |\n#    libtpool -------------/ | | | \\---- libnvpair* |    | |\n#                            | | |                  |    | |\n#    libefi -----------------/ | \\------ libavl* --------/ |\n#                              |                    |      |\n#                              \\-------- libspl ----+------/\n#\n#\n# NB: GNU Automake Manual, Chapter 8.3.5: Libtool Convenience Libraries\n# These nine libraries are intermediary build components.\n#\n# * - A stable ABI is provided for these libraries;\n# when performing an ABI check the following options are applied:\n#\n# --no-unreferenced-symbols: Exclude symbols which are not referenced by\n# any debug information.  Without this _init() and _fini() are incorrectly\n# reported on CentOS7 for libuutil.so.\n#\n# --headers-dir1: Limit ABI checks to public OpenZFS headers, otherwise\n# changes in public system headers are also reported.\n#\n# --suppressions: Honor a suppressions file for each library to provide\n# a mechanism for suppressing harmless warnings.\n#\n\nnoinst_LTLIBRARIES =\nlib_LTLIBRARIES =\npkgconfig_DATA =\ninclude $(srcdir)/%D%/libavl/Makefile.am\ninclude $(srcdir)/%D%/libicp/Makefile.am\ninclude $(srcdir)/%D%/libnvpair/Makefile.am\ninclude $(srcdir)/%D%/libshare/Makefile.am\ninclude $(srcdir)/%D%/libspl/Makefile.am\ninclude $(srcdir)/%D%/libtpool/Makefile.am\ninclude $(srcdir)/%D%/libunicode/Makefile.am\ninclude $(srcdir)/%D%/libuutil/Makefile.am\ninclude $(srcdir)/%D%/libzfs_core/Makefile.am\ninclude $(srcdir)/%D%/libzfs/Makefile.am\ninclude $(srcdir)/%D%/libzfsbootenv/Makefile.am\ninclude $(srcdir)/%D%/libzpool/Makefile.am\ninclude $(srcdir)/%D%/libzstd/Makefile.am\ninclude $(srcdir)/%D%/libzutil/Makefile.am\nif BUILD_LINUX\ninclude $(srcdir)/%D%/libefi/Makefile.am\nendif\n\n\nPHONY += lib\nlib: $(noinst_LTLIBRARIES) $(lib_LTLIBRARIES)\n\n\nPHONY += checkabi storeabi check_libabi_version allow_libabi_only_for_x86_64\n\ncheck_libabi_version:\n\tif [ $$(abidw -v | $(SED) 's/[^0-9]//g') -lt 200 ]; then \\\n\t\tprintf '%s\\n' \"\" \\\n\t\t    \"*** Please use libabigail 2.0.0 version or newer;\" \\\n\t\t    \"*** otherwise results are not consistent!\" \\\n\t\t    \"(or see https://github.com/openzfs/libabigail-docker)\"; \\\n\t\texit 1; \\\n\tfi\n\nallow_libabi_only_for_x86_64:\n\techo '*** ABI definitions provided apply only to x86_64:'\n\techo '*** not checking or storing ABI and assuming success.'\n\nif TARGET_CPU_X86_64\n# These should depend on $(lib_LTLIBRARIES), but this breaks on CI when bound into Docker\ncheckabi: check_libabi_version\n\terr=0; \\\n\tfor lib in $(lib_LTLIBRARIES); do \\\n\t\tlib=$${lib%.la}; \\\n\t\t[ -f $(srcdir)/lib/$$lib/$$lib.suppr ] || continue; \\\n\t\techo $$lib:; \\\n\t\tabidiff --no-unreferenced-symbols \\\n\t\t    --headers-dir1 include \\\n\t\t    --suppressions $(srcdir)/lib/$$lib/$$lib.suppr \\\n\t\t    $(srcdir)/lib/$$lib/$$lib.abi .libs/$$lib.so || err=$$((err + 1)); \\\n\tdone; \\\n\texit $$err\n\nstoreabi: check_libabi_version\n\tfor lib in $(lib_LTLIBRARIES); do \\\n\t\tlib=$${lib%.la}; \\\n\t\t[ -f $(srcdir)/lib/$$lib/$$lib.suppr ] || continue; \\\n\t\tabidw --no-show-locs \\\n\t\t    --no-corpus-path \\\n\t\t    --no-comp-dir-path \\\n\t\t    --type-id-style hash \\\n\t\t    .libs/$$lib.so > $(srcdir)/lib/$$lib/$$lib.abi; \\\n\tdone\nelse\ncheckabi: allow_libabi_only_for_x86_64\nstoreabi: allow_libabi_only_for_x86_64\nendif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}