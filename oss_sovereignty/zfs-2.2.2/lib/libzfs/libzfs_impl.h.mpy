{
  "module_name": "libzfs_impl.h",
  "hash_id": "9612ebaaa44b61c25aae917c80a944189861efa774cd1b0e1cbdea3f096aa075",
  "original_prompt": "Ingested from zfs-2.2.2/lib/libzfs/libzfs_impl.h",
  "human_readable_source": " \n\n \n\n#ifndef\t_LIBZFS_IMPL_H\n#define\t_LIBZFS_IMPL_H\n\n#include <sys/fs/zfs.h>\n#include <sys/nvpair.h>\n#include <sys/dmu.h>\n#include <sys/zfs_ioctl.h>\n#include <regex.h>\n\n#include <libuutil.h>\n#include <libzfs.h>\n#include <libshare.h>\n#include <libzfs_core.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n#define\tERRBUFLEN 1024\n\nstruct libzfs_handle {\n\tint libzfs_error;\n\tint libzfs_fd;\n\tzpool_handle_t *libzfs_pool_handles;\n\tuu_avl_pool_t *libzfs_ns_avlpool;\n\tuu_avl_t *libzfs_ns_avl;\n\tuint64_t libzfs_ns_gen;\n\tint libzfs_desc_active;\n\tchar libzfs_action[1024];\n\tchar libzfs_desc[1024];\n\tint libzfs_printerr;\n\tboolean_t libzfs_mnttab_enable;\n\t \n\tpthread_mutex_t libzfs_mnttab_cache_lock;\n\tavl_tree_t libzfs_mnttab_cache;\n\tint libzfs_pool_iter;\n\tboolean_t libzfs_prop_debug;\n\tregex_t libzfs_urire;\n\tuint64_t libzfs_max_nvlist;\n\tvoid *libfetch;\n\tchar *libfetch_load_error;\n};\n\nstruct zfs_handle {\n\tlibzfs_handle_t *zfs_hdl;\n\tzpool_handle_t *zpool_hdl;\n\tchar zfs_name[ZFS_MAX_DATASET_NAME_LEN];\n\tzfs_type_t zfs_type;  \n\tzfs_type_t zfs_head_type;  \n\tdmu_objset_stats_t zfs_dmustats;\n\tnvlist_t *zfs_props;\n\tnvlist_t *zfs_user_props;\n\tnvlist_t *zfs_recvd_props;\n\tboolean_t zfs_mntcheck;\n\tchar *zfs_mntopts;\n\tuint8_t *zfs_props_table;\n};\n\n \n#define\tZFS_IS_VOLUME(zhp) ((zhp)->zfs_head_type == ZFS_TYPE_VOLUME)\n\nstruct zpool_handle {\n\tlibzfs_handle_t *zpool_hdl;\n\tzpool_handle_t *zpool_next;\n\tchar zpool_name[ZFS_MAX_DATASET_NAME_LEN];\n\tint zpool_state;\n\tsize_t zpool_config_size;\n\tnvlist_t *zpool_config;\n\tnvlist_t *zpool_old_config;\n\tnvlist_t *zpool_props;\n\tdiskaddr_t zpool_start_block;\n};\n\ntypedef int (*zfs_uri_handler_fn_t)(struct libzfs_handle *, const char *,\n    const char *, zfs_keyformat_t, boolean_t, uint8_t **, size_t *);\n\ntypedef struct zfs_uri_handler {\n\tconst char *zuh_scheme;\n\tzfs_uri_handler_fn_t zuh_handler;\n} zfs_uri_handler_t;\n\n#define\tCONFIG_BUF_MINSIZE\t262144\n\nextern int zfs_error(libzfs_handle_t *, int, const char *);\nextern int zfs_error_fmt(libzfs_handle_t *, int, const char *, ...)\n    __attribute__((format(printf, 3, 4)));\nextern void zfs_error_aux(libzfs_handle_t *, const char *, ...)\n    __attribute__((format(printf, 2, 3)));\nextern void *zfs_alloc(libzfs_handle_t *, size_t);\nextern void *zfs_realloc(libzfs_handle_t *, void *, size_t, size_t);\nextern char *zfs_asprintf(libzfs_handle_t *, const char *, ...)\n    __attribute__((format(printf, 2, 3)));\nextern char *zfs_strdup(libzfs_handle_t *, const char *);\nextern int no_memory(libzfs_handle_t *);\n\nextern int zfs_standard_error_fmt(libzfs_handle_t *, int, const char *, ...)\n    __attribute__((format(printf, 3, 4)));\nextern void zfs_setprop_error(libzfs_handle_t *, zfs_prop_t, int, char *);\nextern int zpool_standard_error(libzfs_handle_t *, int, const char *);\nextern int zpool_standard_error_fmt(libzfs_handle_t *, int, const char *, ...)\n    __attribute__((format(printf, 3, 4)));\n\nextern zfs_handle_t *make_dataset_handle_zc(libzfs_handle_t *, zfs_cmd_t *);\nextern zfs_handle_t *make_dataset_simple_handle_zc(zfs_handle_t *, zfs_cmd_t *);\n\nextern int zprop_parse_value(libzfs_handle_t *, nvpair_t *, int, zfs_type_t,\n    nvlist_t *, const char **, uint64_t *, const char *);\nextern int zprop_expand_list(libzfs_handle_t *hdl, zprop_list_t **plp,\n    zfs_type_t type);\n\n \n#define\tCL_GATHER_MOUNT_ALWAYS\t1\n \n#define\tCL_GATHER_ITER_MOUNTED\t2\n \n#define\tCL_GATHER_DONT_UNMOUNT\t4\n\ntypedef struct prop_changelist prop_changelist_t;\n\nextern void zcmd_alloc_dst_nvlist(libzfs_handle_t *, zfs_cmd_t *, size_t);\nextern void zcmd_write_src_nvlist(libzfs_handle_t *, zfs_cmd_t *, nvlist_t *);\nextern void zcmd_write_conf_nvlist(libzfs_handle_t *, zfs_cmd_t *, nvlist_t *);\nextern void zcmd_expand_dst_nvlist(libzfs_handle_t *, zfs_cmd_t *);\nextern int zcmd_read_dst_nvlist(libzfs_handle_t *, zfs_cmd_t *, nvlist_t **);\nextern void zcmd_free_nvlists(zfs_cmd_t *);\n\nextern int changelist_prefix(prop_changelist_t *);\nextern int changelist_postfix(prop_changelist_t *);\nextern void changelist_rename(prop_changelist_t *, const char *, const char *);\nextern void changelist_remove(prop_changelist_t *, const char *);\nextern void changelist_free(prop_changelist_t *);\nextern prop_changelist_t *changelist_gather(zfs_handle_t *, zfs_prop_t, int,\n    int);\nextern int changelist_unshare(prop_changelist_t *, const enum sa_protocol *);\nextern int changelist_haszonedchild(prop_changelist_t *);\n\nextern void remove_mountpoint(zfs_handle_t *);\nextern int create_parents(libzfs_handle_t *, char *, int);\n\nextern zfs_handle_t *make_dataset_handle(libzfs_handle_t *, const char *);\nextern zfs_handle_t *make_bookmark_handle(zfs_handle_t *, const char *,\n    nvlist_t *props);\n\nextern int zpool_open_silent(libzfs_handle_t *, const char *,\n    zpool_handle_t **);\n\nextern boolean_t zpool_name_valid(libzfs_handle_t *, boolean_t, const char *);\n\nextern int zfs_validate_name(libzfs_handle_t *hdl, const char *path, int type,\n    boolean_t modifying);\n\nextern void namespace_clear(libzfs_handle_t *);\n\ntypedef struct {\n\tzfs_prop_t p_prop;\n\tint p_share_err;\n\tint p_unshare_err;\n} proto_table_t;\n\ntypedef struct differ_info {\n\tzfs_handle_t *zhp;\n\tchar *fromsnap;\n\tchar *frommnt;\n\tchar *tosnap;\n\tchar *tomnt;\n\tchar *ds;\n\tchar *dsmnt;\n\tchar *tmpsnap;\n\tchar errbuf[ERRBUFLEN];\n\tboolean_t isclone;\n\tboolean_t scripted;\n\tboolean_t classify;\n\tboolean_t timestamped;\n\tboolean_t no_mangle;\n\tuint64_t shares;\n\tint zerr;\n\tint cleanupfd;\n\tint outputfd;\n\tint datafd;\n} differ_info_t;\n\nextern int do_mount(zfs_handle_t *zhp, const char *mntpt, const char *opts,\n    int flags);\nextern int do_unmount(zfs_handle_t *zhp, const char *mntpt, int flags);\nextern int libzfs_load_module(void);\nextern int zpool_relabel_disk(libzfs_handle_t *hdl, const char *path,\n    const char *msg);\nextern int find_shares_object(differ_info_t *di);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}