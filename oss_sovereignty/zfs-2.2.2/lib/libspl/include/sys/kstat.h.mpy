{
  "module_name": "kstat.h",
  "hash_id": "661c55b5d37a8c845c1baf0205499e430b84d0f449f82c20dfc106902c7bd6fc",
  "original_prompt": "Ingested from zfs-2.2.2/lib/libspl/include/sys/kstat.h",
  "human_readable_source": " \n \n\n#ifndef\t_SYS_KSTAT_H\n#define\t_SYS_KSTAT_H\n\n\n\n \n\n#include <sys/types.h>\n#include <sys/time.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\ntypedef int\tkid_t;\t\t \n\n \n\n#define\tKSTAT_IOC_BASE\t\t('K' << 8)\n\n#define\tKSTAT_IOC_CHAIN_ID\tKSTAT_IOC_BASE | 0x01\n#define\tKSTAT_IOC_READ\t\tKSTAT_IOC_BASE | 0x02\n#define\tKSTAT_IOC_WRITE\t\tKSTAT_IOC_BASE | 0x03\n\n \n\n#define\tKSTAT_STRLEN\t255\t \n\n \n\ntypedef struct kstat {\n\t \n\thrtime_t\tks_crtime;\t \n\tstruct kstat\t*ks_next;\t \n\tkid_t\t\tks_kid;\t\t \n\tchar\t\tks_module[KSTAT_STRLEN];  \n\tuchar_t\t\tks_resv;\t \n\tint\t\tks_instance;\t \n\tchar\t\tks_name[KSTAT_STRLEN];  \n\tuchar_t\t\tks_type;\t \n\tchar\t\tks_class[KSTAT_STRLEN];  \n\tuchar_t\t\tks_flags;\t \n\tvoid\t\t*ks_data;\t \n\tuint_t\t\tks_ndata;\t \n\tsize_t\t\tks_data_size;\t \n\thrtime_t\tks_snaptime;\t \n\t \n\tint\t\t(*ks_update)(struct kstat *, int);  \n\tvoid\t\t*ks_private;\t \n\tint\t\t(*ks_snapshot)(struct kstat *, void *, int);\n\tvoid\t\t*ks_lock;\t \n} kstat_t;\n\n \n\n#if\tdefined(_KERNEL)\n\n#define\tKSTAT_ENTER(k)\t\\\n\t{ kmutex_t *lp = (k)->ks_lock; if (lp) mutex_enter(lp); }\n\n#define\tKSTAT_EXIT(k)\t\\\n\t{ kmutex_t *lp = (k)->ks_lock; if (lp) mutex_exit(lp); }\n\n#define\tKSTAT_UPDATE(k, rw)\t\t(*(k)->ks_update)((k), (rw))\n\n#define\tKSTAT_SNAPSHOT(k, buf, rw)\t(*(k)->ks_snapshot)((k), (buf), (rw))\n\n#endif\t \n\n \n\n \n\n \n\n \n\n \n\n#define\tKSTAT_TYPE_RAW\t\t0\t \n\t\t\t\t\t \n#define\tKSTAT_TYPE_NAMED\t1\t \n\t\t\t\t\t \n#define\tKSTAT_TYPE_INTR\t\t2\t \n\t\t\t\t\t \n#define\tKSTAT_TYPE_IO\t\t3\t \n\t\t\t\t\t \n#define\tKSTAT_TYPE_TIMER\t4\t \n\t\t\t\t\t \n\n#define\tKSTAT_NUM_TYPES\t\t5\n\n \n\n \n\n#define\tKSTAT_FLAG_VIRTUAL\t\t0x01\n#define\tKSTAT_FLAG_VAR_SIZE\t\t0x02\n#define\tKSTAT_FLAG_WRITABLE\t\t0x04\n#define\tKSTAT_FLAG_PERSISTENT\t\t0x08\n#define\tKSTAT_FLAG_DORMANT\t\t0x10\n#define\tKSTAT_FLAG_INVALID\t\t0x20\n#define\tKSTAT_FLAG_LONGSTRINGS\t\t0x40\n#define\tKSTAT_FLAG_NO_HEADERS\t\t0x80\n\n \n\n#define\tKSTAT_READ\t0\n#define\tKSTAT_WRITE\t1\n\n \n\n \n\ntypedef struct kstat_named {\n\tchar\tname[KSTAT_STRLEN];\t \n\tuchar_t\tdata_type;\t\t \n\tunion {\n\t\tchar\t\tc[16];\t \n\t\tint32_t\t\ti32;\n\t\tuint32_t\tui32;\n\t\tstruct {\n\t\t\tunion {\n\t\t\t\tchar \t\t*ptr;\t \n#if defined(_KERNEL) && defined(_MULTI_DATAMODEL)\n\t\t\t\tcaddr32_t\tptr32;\n#endif\n\t\t\t\tchar \t\t__pad[8];  \n\t\t\t} addr;\n\t\t\tuint32_t\tlen;\t \n\t\t} str;\n \n#if defined(_INT64_TYPE)\n\t\tint64_t\t\ti64;\n\t\tuint64_t\tui64;\n#endif\n\t\tlong\t\tl;\n\t\tulong_t\t\tul;\n\n\t\t \n\n\t\tlonglong_t\tll;\n\t\tu_longlong_t\tull;\n\t\tfloat\t\tf;\n\t\tdouble\t\td;\n\t} value;\t\t\t \n} kstat_named_t;\n\n#define\tKSTAT_DATA_CHAR\t\t0\n#define\tKSTAT_DATA_INT32\t1\n#define\tKSTAT_DATA_UINT32\t2\n#define\tKSTAT_DATA_INT64\t3\n#define\tKSTAT_DATA_UINT64\t4\n\n#if !defined(_LP64)\n#define\tKSTAT_DATA_LONG\t\tKSTAT_DATA_INT32\n#define\tKSTAT_DATA_ULONG\tKSTAT_DATA_UINT32\n#else\n#if !defined(_KERNEL)\n#define\tKSTAT_DATA_LONG\t\tKSTAT_DATA_INT64\n#define\tKSTAT_DATA_ULONG\tKSTAT_DATA_UINT64\n#else\n#define\tKSTAT_DATA_LONG\t\t7\t \n#define\tKSTAT_DATA_ULONG\t8\t \n#endif\t \n#endif\t \n\n \n#define\tKSTAT_DATA_STRING\t9\n\n \n\n#define\tKSTAT_DATA_LONGLONG\tKSTAT_DATA_INT64\n#define\tKSTAT_DATA_ULONGLONG\tKSTAT_DATA_UINT64\n#define\tKSTAT_DATA_FLOAT\t5\n#define\tKSTAT_DATA_DOUBLE\t6\n\n#define\tKSTAT_NAMED_PTR(kptr)\t((kstat_named_t *)(kptr)->ks_data)\n\n \n#define\tKSTAT_NAMED_STR_PTR(knptr) ((knptr)->value.str.addr.ptr)\n\n \n#define\tKSTAT_NAMED_STR_BUFLEN(knptr) ((knptr)->value.str.len)\n\n \n\n#define\tKSTAT_INTR_HARD\t\t\t0\n#define\tKSTAT_INTR_SOFT\t\t\t1\n#define\tKSTAT_INTR_WATCHDOG\t\t2\n#define\tKSTAT_INTR_SPURIOUS\t\t3\n#define\tKSTAT_INTR_MULTSVC\t\t4\n\n#define\tKSTAT_NUM_INTRS\t\t\t5\n\ntypedef struct kstat_intr {\n\tuint_t\tintrs[KSTAT_NUM_INTRS];\t \n} kstat_intr_t;\n\n#define\tKSTAT_INTR_PTR(kptr)\t((kstat_intr_t *)(kptr)->ks_data)\n\n \n\ntypedef struct kstat_io {\n\n\t \n\n\tu_longlong_t\tnread;\t\t \n\tu_longlong_t\tnwritten;\t \n\tuint_t\t\treads;\t\t \n\tuint_t\t\twrites;\t\t \n\n\t \n\n\thrtime_t wtime;\t\t \n\thrtime_t wlentime;\t \n\thrtime_t wlastupdate;\t \n\thrtime_t rtime;\t\t \n\thrtime_t rlentime;\t \n\thrtime_t rlastupdate;\t \n\n\tuint_t\twcnt;\t\t \n\tuint_t\trcnt;\t\t \n\n} kstat_io_t;\n\n#define\tKSTAT_IO_PTR(kptr)\t((kstat_io_t *)(kptr)->ks_data)\n\n \n\ntypedef struct kstat_timer {\n\tchar\t\tname[KSTAT_STRLEN];\t \n\tuchar_t\t\tresv;\t\t\t \n\tu_longlong_t\tnum_events;\t\t \n\thrtime_t\telapsed_time;\t\t \n\thrtime_t\tmin_time;\t\t \n\thrtime_t\tmax_time;\t\t \n\thrtime_t\tstart_time;\t\t \n\thrtime_t\tstop_time;\t\t \n} kstat_timer_t;\n\n#define\tKSTAT_TIMER_PTR(kptr)\t((kstat_timer_t *)(kptr)->ks_data)\n\n#if\tdefined(_KERNEL)\n\n#include <sys/t_lock.h>\n\nextern kid_t\tkstat_chain_id;\t\t \nextern void\tkstat_init(void);\t \n\n \n\nextern kstat_t *kstat_create(const char *, int, const char *, const char *,\n    uchar_t, uint_t, uchar_t);\nextern kstat_t *kstat_create_zone(const char *, int, const char *,\n    const char *, uchar_t, uint_t, uchar_t, zoneid_t);\nextern void kstat_install(kstat_t *);\nextern void kstat_delete(kstat_t *);\nextern void kstat_named_setstr(kstat_named_t *knp, const char *src);\nextern void kstat_set_string(char *, const char *);\nextern void kstat_delete_byname(const char *, int, const char *);\nextern void kstat_delete_byname_zone(const char *, int, const char *, zoneid_t);\nextern void kstat_named_init(kstat_named_t *, const char *, uchar_t);\nextern void kstat_timer_init(kstat_timer_t *, const char *);\nextern void kstat_timer_start(kstat_timer_t *);\nextern void kstat_timer_stop(kstat_timer_t *);\n\nextern void kstat_zone_add(kstat_t *, zoneid_t);\nextern void kstat_zone_remove(kstat_t *, zoneid_t);\nextern int kstat_zone_find(kstat_t *, zoneid_t);\n\nextern kstat_t *kstat_hold_bykid(kid_t kid, zoneid_t);\nextern kstat_t *kstat_hold_byname(const char *, int, const char *, zoneid_t);\nextern void kstat_rele(kstat_t *);\n\n#endif\t \n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}