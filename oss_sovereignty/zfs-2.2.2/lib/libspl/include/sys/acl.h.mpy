{
  "module_name": "acl.h",
  "hash_id": "9ad4c5e28e0bdcedc694994968fc10ccec2ca4daa9449a9e207662fbfe835fe1",
  "original_prompt": "Ingested from zfs-2.2.2/lib/libspl/include/sys/acl.h",
  "human_readable_source": " \n \n\n#ifndef _SYS_ACL_H\n#define\t_SYS_ACL_H\n\n#include <sys/types.h>\n#include <sys/acl_impl.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n#define\tMAX_ACL_ENTRIES\t\t(1024)\t \ntypedef struct acl {\n\tint\t\ta_type;\t\t \n\tuid_t\t\ta_id;\t\t \n\to_mode_t\ta_perm;\t\t \n} aclent_t;\n\ntypedef struct ace {\n\tuid_t\t\ta_who;\t\t \n\tuint32_t\ta_access_mask;\t \n\tuint16_t\ta_flags;\t \n\tuint16_t\ta_type;\t\t \n} ace_t;\n\ntypedef struct acl_info acl_t;\n\n \n#define\tUSER_OBJ\t(0x01)\t\t \n#define\tUSER\t\t(0x02)\t\t \n#define\tGROUP_OBJ\t(0x04)\t\t \n#define\tGROUP\t\t(0x08)\t\t \n#define\tCLASS_OBJ\t(0x10)\t\t \n#define\tOTHER_OBJ\t(0x20)\t\t \n#define\tACL_DEFAULT\t(0x1000)\t \n \n#define\tDEF_USER_OBJ\t(ACL_DEFAULT | USER_OBJ)\n \n#define\tDEF_USER\t(ACL_DEFAULT | USER)\n \n#define\tDEF_GROUP_OBJ\t(ACL_DEFAULT | GROUP_OBJ)\n \n#define\tDEF_GROUP\t(ACL_DEFAULT | GROUP)\n \n#define\tDEF_CLASS_OBJ\t(ACL_DEFAULT | CLASS_OBJ)\n \n#define\tDEF_OTHER_OBJ\t(ACL_DEFAULT | OTHER_OBJ)\n\n \n#define\tACE_READ_DATA\t\t0x00000001\t \n#define\tACE_LIST_DIRECTORY\t0x00000001\t \n#define\tACE_WRITE_DATA\t\t0x00000002\t \n#define\tACE_ADD_FILE\t\t0x00000002\t \n#define\tACE_APPEND_DATA\t\t0x00000004\t \n#define\tACE_ADD_SUBDIRECTORY\t0x00000004\t \n#define\tACE_READ_NAMED_ATTRS\t0x00000008\t \n#define\tACE_WRITE_NAMED_ATTRS\t0x00000010\t \n#define\tACE_EXECUTE\t\t0x00000020\t \n#define\tACE_TRAVERSE\t\t0x00000020\t \n#define\tACE_DELETE_CHILD\t0x00000040\t \n#define\tACE_READ_ATTRIBUTES\t0x00000080\t \n#define\tACE_WRITE_ATTRIBUTES\t0x00000100\t \n#define\tACE_DELETE\t\t0x00010000\t \n#define\tACE_READ_ACL\t\t0x00020000\t \n#define\tACE_WRITE_ACL\t\t0x00040000\t \n#define\tACE_WRITE_OWNER\t\t0x00080000\t \n#define\tACE_SYNCHRONIZE\t\t0x00100000\t \n\n#define\tACE_FILE_INHERIT_ACE\t\t0x0001\n#define\tACE_DIRECTORY_INHERIT_ACE\t0x0002\n#define\tACE_NO_PROPAGATE_INHERIT_ACE\t0x0004\n#define\tACE_INHERIT_ONLY_ACE\t\t0x0008\n#define\tACE_SUCCESSFUL_ACCESS_ACE_FLAG\t0x0010\n#define\tACE_FAILED_ACCESS_ACE_FLAG\t0x0020\n#define\tACE_IDENTIFIER_GROUP\t\t0x0040\n#define\tACE_INHERITED_ACE\t\t0x0080\n#define\tACE_OWNER\t\t\t0x1000\n#define\tACE_GROUP\t\t\t0x2000\n#define\tACE_EVERYONE\t\t\t0x4000\n\n#define\tACE_ACCESS_ALLOWED_ACE_TYPE\t0x0000\n#define\tACE_ACCESS_DENIED_ACE_TYPE\t0x0001\n#define\tACE_SYSTEM_AUDIT_ACE_TYPE\t0x0002\n#define\tACE_SYSTEM_ALARM_ACE_TYPE\t0x0003\n\n#define\tACL_AUTO_INHERIT\t\t0x0001\n#define\tACL_PROTECTED\t\t\t0x0002\n#define\tACL_DEFAULTED\t\t\t0x0004\n#define\tACL_FLAGS_ALL\t\t\t(ACL_AUTO_INHERIT|ACL_PROTECTED| \\\n    ACL_DEFAULTED)\n\n \n#define\tACE_ACCESS_ALLOWED_COMPOUND_ACE_TYPE\t\t0x04\n#define\tACE_ACCESS_ALLOWED_OBJECT_ACE_TYPE\t\t0x05\n#define\tACE_ACCESS_DENIED_OBJECT_ACE_TYPE\t\t0x06\n#define\tACE_SYSTEM_AUDIT_OBJECT_ACE_TYPE\t\t0x07\n#define\tACE_SYSTEM_ALARM_OBJECT_ACE_TYPE\t\t0x08\n#define\tACE_ACCESS_ALLOWED_CALLBACK_ACE_TYPE\t\t0x09\n#define\tACE_ACCESS_DENIED_CALLBACK_ACE_TYPE\t\t0x0A\n#define\tACE_ACCESS_ALLOWED_CALLBACK_OBJECT_ACE_TYPE\t0x0B\n#define\tACE_ACCESS_DENIED_CALLBACK_OBJECT_ACE_TYPE\t0x0C\n#define\tACE_SYSTEM_AUDIT_CALLBACK_ACE_TYPE\t\t0x0D\n#define\tACE_SYSTEM_ALARM_CALLBACK_ACE_TYPE\t\t0x0E\n#define\tACE_SYSTEM_AUDIT_CALLBACK_OBJECT_ACE_TYPE\t0x0F\n#define\tACE_SYSTEM_ALARM_CALLBACK_OBJECT_ACE_TYPE\t0x10\n\n#define\tACE_ALL_TYPES\t0x001F\n\n#if defined(_KERNEL)\n\ntypedef struct ace_object {\n\tuid_t\t\ta_who;\t\t \n\tuint32_t\ta_access_mask;\t \n\tuint16_t\ta_flags;\t \n\tuint16_t\ta_type;\t\t \n\tuint8_t\t\ta_obj_type[16];\t \n\tuint8_t\t\ta_inherit_obj_type[16];   \n} ace_object_t;\n\n#endif\n\n#define\tACE_ALL_PERMS\t(ACE_READ_DATA|ACE_LIST_DIRECTORY|ACE_WRITE_DATA| \\\n    ACE_ADD_FILE|ACE_APPEND_DATA|ACE_ADD_SUBDIRECTORY|ACE_READ_NAMED_ATTRS| \\\n    ACE_WRITE_NAMED_ATTRS|ACE_EXECUTE|ACE_DELETE_CHILD|ACE_READ_ATTRIBUTES| \\\n    ACE_WRITE_ATTRIBUTES|ACE_DELETE|ACE_READ_ACL|ACE_WRITE_ACL| \\\n    ACE_WRITE_OWNER|ACE_SYNCHRONIZE)\n\n#define\tACE_ALL_WRITE_PERMS (ACE_WRITE_DATA|ACE_APPEND_DATA| \\\n    ACE_WRITE_ATTRIBUTES|ACE_WRITE_NAMED_ATTRS|ACE_WRITE_ACL| \\\n    ACE_WRITE_OWNER|ACE_DELETE|ACE_DELETE_CHILD)\n\n#define\tACE_READ_PERMS\t(ACE_READ_DATA|ACE_READ_ACL|ACE_READ_ATTRIBUTES| \\\n    ACE_READ_NAMED_ATTRS)\n\n#define\tACE_WRITE_PERMS\t(ACE_WRITE_DATA|ACE_APPEND_DATA|ACE_WRITE_ATTRIBUTES| \\\n    ACE_WRITE_NAMED_ATTRS)\n\n#define\tACE_MODIFY_PERMS (ACE_READ_DATA|ACE_LIST_DIRECTORY|ACE_WRITE_DATA| \\\n    ACE_ADD_FILE|ACE_APPEND_DATA|ACE_ADD_SUBDIRECTORY|ACE_READ_NAMED_ATTRS| \\\n    ACE_WRITE_NAMED_ATTRS|ACE_EXECUTE|ACE_DELETE_CHILD|ACE_READ_ATTRIBUTES| \\\n    ACE_WRITE_ATTRIBUTES|ACE_DELETE|ACE_READ_ACL|ACE_SYNCHRONIZE)\n\n \n#define\tACE_NFSV4_SUP_FLAGS (ACE_FILE_INHERIT_ACE | \\\n    ACE_DIRECTORY_INHERIT_ACE | \\\n    ACE_NO_PROPAGATE_INHERIT_ACE | \\\n    ACE_INHERIT_ONLY_ACE | \\\n    ACE_IDENTIFIER_GROUP)\n\n#define\tACE_TYPE_FLAGS\t\t(ACE_OWNER|ACE_GROUP|ACE_EVERYONE| \\\n    ACE_IDENTIFIER_GROUP)\n#define\tACE_INHERIT_FLAGS\t(ACE_FILE_INHERIT_ACE| \\\n    ACE_DIRECTORY_INHERIT_ACE|ACE_NO_PROPAGATE_INHERIT_ACE|ACE_INHERIT_ONLY_ACE)\n\n \n#define\tGETACL\t\t\t1\n#define\tSETACL\t\t\t2\n#define\tGETACLCNT\t\t3\n\n \n#define\tACE_GETACL\t\t4\n#define\tACE_SETACL\t\t5\n#define\tACE_GETACLCNT\t\t6\n\n \n#define\tMIN_ACL_ENTRIES\t\t4\n\n#if !defined(_KERNEL)\n\n \n#define\tGRP_ERROR\t\t1\n#define\tUSER_ERROR\t\t2\n#define\tOTHER_ERROR\t\t3\n#define\tCLASS_ERROR\t\t4\n#define\tDUPLICATE_ERROR\t\t5\n#define\tMISS_ERROR\t\t6\n#define\tMEM_ERROR\t\t7\n#define\tENTRY_ERROR\t\t8\n\n\n \n#define\tUFSD_FREE\t('0')\t \n#define\tUFSD_ACL\t('1')\t \n#define\tUFSD_DFACL\t('2')\t \n#define\tACE_ACL\t\t('3')\t \n\n \n#define\tACL_NO_TRIVIAL\t0x2\n\n\n \n\n#define\tACL_APPEND_ID\t0x1 \t \n#define\tACL_COMPACT_FMT\t0x2 \t \n#define\tACL_NORESOLVE\t0x4\t \n#define\tACL_SID_FMT\t0x8\t \n\n \n#define\tEACL_GRP_ERROR\t\tGRP_ERROR\n#define\tEACL_USER_ERROR\t\tUSER_ERROR\n#define\tEACL_OTHER_ERROR\tOTHER_ERROR\n#define\tEACL_CLASS_ERROR\tCLASS_ERROR\n#define\tEACL_DUPLICATE_ERROR\tDUPLICATE_ERROR\n#define\tEACL_MISS_ERROR\t\tMISS_ERROR\n#define\tEACL_MEM_ERROR\t\tMEM_ERROR\n#define\tEACL_ENTRY_ERROR\tENTRY_ERROR\n\n#define\tEACL_INHERIT_ERROR\t9\t\t \n#define\tEACL_FLAGS_ERROR\t10\t\t \n#define\tEACL_PERM_MASK_ERROR\t11\t\t \n#define\tEACL_COUNT_ERROR\t12\t\t \n\n#define\tEACL_INVALID_SLOT\t13\t\t \n#define\tEACL_NO_ACL_ENTRY\t14\t\t \n#define\tEACL_DIFF_TYPE\t\t15\t\t \n\n#define\tEACL_INVALID_USER_GROUP\t16\t\t \n#define\tEACL_INVALID_STR\t17\t\t \n#define\tEACL_FIELD_NOT_BLANK\t18\t\t \n#define\tEACL_INVALID_ACCESS_TYPE 19\t\t \n#define\tEACL_UNKNOWN_DATA\t20\t\t \n#define\tEACL_MISSING_FIELDS\t21\t\t \n\n#define\tEACL_INHERIT_NOTDIR\t22\t\t \n\nextern int aclcheck(aclent_t *, int, int *);\nextern int acltomode(aclent_t *, int, mode_t *);\nextern int aclfrommode(aclent_t *, int, mode_t *);\nextern int aclsort(int, int, aclent_t *);\nextern char *acltotext(aclent_t *, int);\nextern aclent_t *aclfromtext(char *, int *);\nextern void acl_free(acl_t *);\nextern int acl_get(const char *, int, acl_t **);\nextern int facl_get(int, int, acl_t **);\nextern int acl_set(const char *, acl_t *acl);\nextern int facl_set(int, acl_t *acl);\nextern int acl_strip(const char *, uid_t, gid_t, mode_t);\nextern int acl_trivial(const char *);\nextern char *acl_totext(acl_t *, int);\nextern int acl_fromtext(const char *, acl_t **);\nextern int acl_check(acl_t *, int);\n\n#else\t \n\nextern void ksort(caddr_t, int, int, int (*)(void *, void *));\nextern int cmp2acls(void *, void *);\n\n#endif\t \n\nextern int acl(const char *path, int cmd, int cnt, void *buf);\nextern int facl(int fd, int cmd, int cnt, void *buf);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}