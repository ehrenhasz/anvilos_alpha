{
  "module_name": "trace_dbuf.h",
  "hash_id": "19fdc68f44d5e8aa46ad0e6ce4b1fbeac427a2d5dea586d19f5fc07cebe8f72b",
  "original_prompt": "Ingested from zfs-2.2.2/include/os/linux/zfs/sys/trace_dbuf.h",
  "human_readable_source": " \n\n#if defined(_KERNEL)\n#if defined(HAVE_DECLARE_EVENT_CLASS)\n\n#undef TRACE_SYSTEM\n#define\tTRACE_SYSTEM zfs\n\n#undef TRACE_SYSTEM_VAR\n#define\tTRACE_SYSTEM_VAR zfs_dbuf\n\n#if !defined(_TRACE_DBUF_H) || defined(TRACE_HEADER_MULTI_READ)\n#define\t_TRACE_DBUF_H\n\n#include <linux/tracepoint.h>\n#include <sys/types.h>\n\n#ifndef\tTRACE_DBUF_MSG_MAX\n#define\tTRACE_DBUF_MSG_MAX\t512\n#endif\n\n \n\n#define\tDBUF_TP_STRUCT_ENTRY\t\t\t\t\t\\\n\t__dynamic_array(char,\tos_spa,\tTRACE_DBUF_MSG_MAX)\t\\\n\t__field(uint64_t,\tds_object)\t\t\t\\\n\t__field(uint64_t,\tdb_object)\t\t\t\\\n\t__field(uint64_t,\tdb_level)\t\t\t\\\n\t__field(uint64_t,\tdb_blkid)\t\t\t\\\n\t__field(uint64_t,\tdb_offset)\t\t\t\\\n\t__field(uint64_t,\tdb_size)\t\t\t\\\n\t__field(uint64_t,\tdb_state)\t\t\t\\\n\t__field(int64_t,\tdb_holds)\t\t\t\\\n\t__dynamic_array(char,\tmsg,\tTRACE_DBUF_MSG_MAX)\n\n#define\tDBUF_TP_FAST_ASSIGN\t\t\t\t\t\t\\\n\tif (db != NULL) {\t\t\t\t\t\t\\\n\t\tif (POINTER_IS_VALID(DB_DNODE(db)->dn_objset)) {\t\\\n\t\t\t__assign_str(os_spa,\t\t\t\t\\\n\t\t\tspa_name(DB_DNODE(db)->dn_objset->os_spa));\t\\\n\t\t} else {\t\t\t\t\t\t\\\n\t\t\t__assign_str(os_spa, \"NULL\");\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\t__entry->ds_object = db->db_objset->os_dsl_dataset ?\t\\\n\t\tdb->db_objset->os_dsl_dataset->ds_object : 0;\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\t__entry->db_object = db->db.db_object;\t\t\t\\\n\t\t__entry->db_level  = db->db_level;\t\t\t\\\n\t\t__entry->db_blkid  = db->db_blkid;\t\t\t\\\n\t\t__entry->db_offset = db->db.db_offset;\t\t\t\\\n\t\t__entry->db_size   = db->db.db_size;\t\t\t\\\n\t\t__entry->db_state  = db->db_state;\t\t\t\\\n\t\t__entry->db_holds  = zfs_refcount_count(&db->db_holds);\t\\\n\t\tsnprintf(__get_str(msg), TRACE_DBUF_MSG_MAX,\t\t\\\n\t\t    DBUF_TP_PRINTK_FMT, DBUF_TP_PRINTK_ARGS);\t\t\\\n\t} else {\t\t\t\t\t\t\t\\\n\t\t__assign_str(os_spa, \"NULL\")\t\t\t\t\\\n\t\t__entry->ds_object = 0;\t\t\t\t\t\\\n\t\t__entry->db_object = 0;\t\t\t\t\t\\\n\t\t__entry->db_level  = 0;\t\t\t\t\t\\\n\t\t__entry->db_blkid  = 0;\t\t\t\t\t\\\n\t\t__entry->db_offset = 0;\t\t\t\t\t\\\n\t\t__entry->db_size   = 0;\t\t\t\t\t\\\n\t\t__entry->db_state  = 0;\t\t\t\t\t\\\n\t\t__entry->db_holds  = 0;\t\t\t\t\t\\\n\t\tsnprintf(__get_str(msg), TRACE_DBUF_MSG_MAX,\t\t\\\n\t\t    \"dbuf { NULL }\");\t\t\t\t\t\\\n\t}\n\n#define\tDBUF_TP_PRINTK_FMT\t\t\t\t\t\t\\\n\t\"dbuf { spa \\\"%s\\\" objset %llu object %llu level %llu \"\t\t\\\n\t\"blkid %llu offset %llu size %llu state %llu holds %lld }\"\n\n#define\tDBUF_TP_PRINTK_ARGS\t\t\t\t\t\\\n\t__get_str(os_spa), __entry->ds_object,\t\t\t\\\n\t__entry->db_object, __entry->db_level,\t\t\t\\\n\t__entry->db_blkid, __entry->db_offset,\t\t\t\\\n\t__entry->db_size, __entry->db_state, __entry->db_holds\n\n \nDECLARE_EVENT_CLASS(zfs_dbuf_class,\n\tTP_PROTO(dmu_buf_impl_t *db, zio_t *zio),\n\tTP_ARGS(db, zio),\n\tTP_STRUCT__entry(DBUF_TP_STRUCT_ENTRY),\n\tTP_fast_assign(DBUF_TP_FAST_ASSIGN),\n\tTP_printk(\"%s\", __get_str(msg))\n);\n\nDECLARE_EVENT_CLASS(zfs_dbuf_state_class,\n\tTP_PROTO(dmu_buf_impl_t *db, const char *why),\n\tTP_ARGS(db, why),\n\tTP_STRUCT__entry(DBUF_TP_STRUCT_ENTRY),\n\tTP_fast_assign(DBUF_TP_FAST_ASSIGN),\n\tTP_printk(\"%s\", __get_str(msg))\n);\n \n\n#define\tDEFINE_DBUF_EVENT(name) \\\nDEFINE_EVENT(zfs_dbuf_class, name, \\\n    TP_PROTO(dmu_buf_impl_t *db, zio_t *zio), \\\n    TP_ARGS(db, zio))\nDEFINE_DBUF_EVENT(zfs_blocked__read);\n\n#define\tDEFINE_DBUF_STATE_EVENT(name) \\\nDEFINE_EVENT(zfs_dbuf_state_class, name, \\\n    TP_PROTO(dmu_buf_impl_t *db, const char *why), \\\n    TP_ARGS(db, why))\nDEFINE_DBUF_STATE_EVENT(zfs_dbuf__state_change);\n\n \nDECLARE_EVENT_CLASS(zfs_dbuf_evict_one_class,\n\tTP_PROTO(dmu_buf_impl_t *db, multilist_sublist_t *mls),\n\tTP_ARGS(db, mls),\n\tTP_STRUCT__entry(DBUF_TP_STRUCT_ENTRY),\n\tTP_fast_assign(DBUF_TP_FAST_ASSIGN),\n\tTP_printk(\"%s\", __get_str(msg))\n);\n \n\n#define\tDEFINE_DBUF_EVICT_ONE_EVENT(name) \\\nDEFINE_EVENT(zfs_dbuf_evict_one_class, name, \\\n    TP_PROTO(dmu_buf_impl_t *db, multilist_sublist_t *mls), \\\n    TP_ARGS(db, mls))\nDEFINE_DBUF_EVICT_ONE_EVENT(zfs_dbuf__evict__one);\n\n#endif  \n\n#undef TRACE_INCLUDE_PATH\n#undef TRACE_INCLUDE_FILE\n#define\tTRACE_INCLUDE_PATH sys\n#define\tTRACE_INCLUDE_FILE trace_dbuf\n#include <trace/define_trace.h>\n\n#else\n\nDEFINE_DTRACE_PROBE2(blocked__read);\nDEFINE_DTRACE_PROBE2(dbuf__evict__one);\nDEFINE_DTRACE_PROBE2(dbuf__state_change);\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}