{
  "module_name": "trace_arc.h",
  "hash_id": "545492664827de441d3c87e2a78639216381073f0c8412433b4ed52b606c5568",
  "original_prompt": "Ingested from zfs-2.2.2/include/os/linux/zfs/sys/trace_arc.h",
  "human_readable_source": " \n\n#include <sys/list.h>\n\n#if defined(_KERNEL)\n#if defined(HAVE_DECLARE_EVENT_CLASS)\n\n#undef TRACE_SYSTEM\n#define\tTRACE_SYSTEM zfs\n\n#undef TRACE_SYSTEM_VAR\n#define\tTRACE_SYSTEM_VAR zfs_arc\n\n#if !defined(_TRACE_ARC_H) || defined(TRACE_HEADER_MULTI_READ)\n#define\t_TRACE_ARC_H\n\n#include <linux/tracepoint.h>\n#include <sys/types.h>\n#include <sys/trace_common.h>  \n\n \n \nDECLARE_EVENT_CLASS(zfs_arc_buf_hdr_class,\n\tTP_PROTO(arc_buf_hdr_t *ab),\n\tTP_ARGS(ab),\n\tTP_STRUCT__entry(\n\t    __array(uint64_t,\t\thdr_dva_word, 2)\n\t    __field(uint64_t,\t\thdr_birth)\n\t    __field(uint32_t,\t\thdr_flags)\n\t    __field(arc_buf_contents_t,\thdr_type)\n\t    __field(uint16_t,\t\thdr_psize)\n\t    __field(uint16_t,\t\thdr_lsize)\n\t    __field(uint64_t,\t\thdr_spa)\n\t    __field(arc_state_type_t,\thdr_state_type)\n\t    __field(clock_t,\t\thdr_access)\n\t    __field(uint32_t,\t\thdr_mru_hits)\n\t    __field(uint32_t,\t\thdr_mru_ghost_hits)\n\t    __field(uint32_t,\t\thdr_mfu_hits)\n\t    __field(uint32_t,\t\thdr_mfu_ghost_hits)\n\t    __field(uint32_t,\t\thdr_l2_hits)\n\t    __field(int64_t,\t\thdr_refcount)\n\t),\n\tTP_fast_assign(\n\t    __entry->hdr_dva_word[0]\t= ab->b_dva.dva_word[0];\n\t    __entry->hdr_dva_word[1]\t= ab->b_dva.dva_word[1];\n\t    __entry->hdr_birth\t\t= ab->b_birth;\n\t    __entry->hdr_flags\t\t= ab->b_flags;\n\t    __entry->hdr_psize\t\t= ab->b_psize;\n\t    __entry->hdr_lsize\t\t= ab->b_lsize;\n\t    __entry->hdr_spa\t\t= ab->b_spa;\n\t    __entry->hdr_state_type\t= ab->b_l1hdr.b_state->arcs_state;\n\t    __entry->hdr_access\t\t= ab->b_l1hdr.b_arc_access;\n\t    __entry->hdr_mru_hits\t= ab->b_l1hdr.b_mru_hits;\n\t    __entry->hdr_mru_ghost_hits\t= ab->b_l1hdr.b_mru_ghost_hits;\n\t    __entry->hdr_mfu_hits\t= ab->b_l1hdr.b_mfu_hits;\n\t    __entry->hdr_mfu_ghost_hits\t= ab->b_l1hdr.b_mfu_ghost_hits;\n\t    __entry->hdr_l2_hits\t= ab->b_l2hdr.b_hits;\n\t    __entry->hdr_refcount\t= ab->b_l1hdr.b_refcnt.rc_count;\n\t),\n\tTP_printk(\"hdr { dva 0x%llx:0x%llx birth %llu \"\n\t    \"flags 0x%x type %u psize %u lsize %u spa %llu \"\n\t    \"state_type %u access %lu mru_hits %u mru_ghost_hits %u \"\n\t    \"mfu_hits %u mfu_ghost_hits %u l2_hits %u refcount %lli }\",\n\t    __entry->hdr_dva_word[0], __entry->hdr_dva_word[1],\n\t    __entry->hdr_birth, __entry->hdr_flags,\n\t    __entry->hdr_type, __entry->hdr_psize,\n\t    __entry->hdr_lsize, __entry->hdr_spa, __entry->hdr_state_type,\n\t    __entry->hdr_access, __entry->hdr_mru_hits,\n\t    __entry->hdr_mru_ghost_hits, __entry->hdr_mfu_hits,\n\t    __entry->hdr_mfu_ghost_hits, __entry->hdr_l2_hits,\n\t    __entry->hdr_refcount)\n);\n \n\n#define\tDEFINE_ARC_BUF_HDR_EVENT(name) \\\nDEFINE_EVENT(zfs_arc_buf_hdr_class, name, \\\n    TP_PROTO(arc_buf_hdr_t *ab), \\\n    TP_ARGS(ab))\nDEFINE_ARC_BUF_HDR_EVENT(zfs_arc__hit);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_arc__iohit);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_arc__evict);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_arc__delete);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_new_state__mru);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_new_state__mfu);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_new_state__uncached);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_arc__async__upgrade__sync);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_l2arc__hit);\nDEFINE_ARC_BUF_HDR_EVENT(zfs_l2arc__miss);\n\n \n \nDECLARE_EVENT_CLASS(zfs_l2arc_rw_class,\n\tTP_PROTO(vdev_t *vd, zio_t *zio),\n\tTP_ARGS(vd, zio),\n\tTP_STRUCT__entry(\n\t    __field(uint64_t,\tvdev_id)\n\t    __field(uint64_t,\tvdev_guid)\n\t    __field(uint64_t,\tvdev_state)\n\t    ZIO_TP_STRUCT_ENTRY\n\t),\n\tTP_fast_assign(\n\t    __entry->vdev_id\t= vd->vdev_id;\n\t    __entry->vdev_guid\t= vd->vdev_guid;\n\t    __entry->vdev_state\t= vd->vdev_state;\n\t    ZIO_TP_FAST_ASSIGN\n\t),\n\tTP_printk(\"vdev { id %llu guid %llu state %llu } \"\n\t    ZIO_TP_PRINTK_FMT, __entry->vdev_id, __entry->vdev_guid,\n\t    __entry->vdev_state, ZIO_TP_PRINTK_ARGS)\n);\n \n\n#define\tDEFINE_L2ARC_RW_EVENT(name) \\\nDEFINE_EVENT(zfs_l2arc_rw_class, name, \\\n    TP_PROTO(vdev_t *vd, zio_t *zio), \\\n    TP_ARGS(vd, zio))\nDEFINE_L2ARC_RW_EVENT(zfs_l2arc__read);\nDEFINE_L2ARC_RW_EVENT(zfs_l2arc__write);\n\n\n \n \nDECLARE_EVENT_CLASS(zfs_l2arc_iodone_class,\n\tTP_PROTO(zio_t *zio, l2arc_write_callback_t *cb),\n\tTP_ARGS(zio, cb),\n\tTP_STRUCT__entry(ZIO_TP_STRUCT_ENTRY),\n\tTP_fast_assign(ZIO_TP_FAST_ASSIGN),\n\tTP_printk(ZIO_TP_PRINTK_FMT, ZIO_TP_PRINTK_ARGS)\n);\n \n\n#define\tDEFINE_L2ARC_IODONE_EVENT(name) \\\nDEFINE_EVENT(zfs_l2arc_iodone_class, name, \\\n    TP_PROTO(zio_t *zio, l2arc_write_callback_t *cb), \\\n    TP_ARGS(zio, cb))\nDEFINE_L2ARC_IODONE_EVENT(zfs_l2arc__iodone);\n\n\n \n \nDECLARE_EVENT_CLASS(zfs_arc_miss_class,\n\tTP_PROTO(arc_buf_hdr_t *hdr,\n\t    const blkptr_t *bp, uint64_t size, const zbookmark_phys_t *zb),\n\tTP_ARGS(hdr, bp, size, zb),\n\tTP_STRUCT__entry(\n\t    __array(uint64_t,\t\thdr_dva_word, 2)\n\t    __field(uint64_t,\t\thdr_birth)\n\t    __field(uint32_t,\t\thdr_flags)\n\t    __field(arc_buf_contents_t,\thdr_type)\n\t    __field(uint16_t,\t\thdr_psize)\n\t    __field(uint16_t,\t\thdr_lsize)\n\t    __field(uint64_t,\t\thdr_spa)\n\t    __field(arc_state_type_t,\thdr_state_type)\n\t    __field(clock_t,\t\thdr_access)\n\t    __field(uint32_t,\t\thdr_mru_hits)\n\t    __field(uint32_t,\t\thdr_mru_ghost_hits)\n\t    __field(uint32_t,\t\thdr_mfu_hits)\n\t    __field(uint32_t,\t\thdr_mfu_ghost_hits)\n\t    __field(uint32_t,\t\thdr_l2_hits)\n\t    __field(int64_t,\t\thdr_refcount)\n\n\t    __array(uint64_t,\t\tbp_dva0, 2)\n\t    __array(uint64_t,\t\tbp_dva1, 2)\n\t    __array(uint64_t,\t\tbp_dva2, 2)\n\t    __array(uint64_t,\t\tbp_cksum, 4)\n\n\t    __field(uint64_t,\t\tbp_lsize)\n\n\t    __field(uint64_t,\t\tzb_objset)\n\t    __field(uint64_t,\t\tzb_object)\n\t    __field(int64_t,\t\tzb_level)\n\t    __field(uint64_t,\t\tzb_blkid)\n\t),\n\tTP_fast_assign(\n\t    __entry->hdr_dva_word[0]\t= hdr->b_dva.dva_word[0];\n\t    __entry->hdr_dva_word[1]\t= hdr->b_dva.dva_word[1];\n\t    __entry->hdr_birth\t\t= hdr->b_birth;\n\t    __entry->hdr_flags\t\t= hdr->b_flags;\n\t    __entry->hdr_psize\t\t= hdr->b_psize;\n\t    __entry->hdr_lsize\t\t= hdr->b_lsize;\n\t    __entry->hdr_spa\t\t= hdr->b_spa;\n\t    __entry->hdr_state_type\t= hdr->b_l1hdr.b_state->arcs_state;\n\t    __entry->hdr_access\t\t= hdr->b_l1hdr.b_arc_access;\n\t    __entry->hdr_mru_hits\t= hdr->b_l1hdr.b_mru_hits;\n\t    __entry->hdr_mru_ghost_hits\t= hdr->b_l1hdr.b_mru_ghost_hits;\n\t    __entry->hdr_mfu_hits\t= hdr->b_l1hdr.b_mfu_hits;\n\t    __entry->hdr_mfu_ghost_hits\t= hdr->b_l1hdr.b_mfu_ghost_hits;\n\t    __entry->hdr_l2_hits\t= hdr->b_l2hdr.b_hits;\n\t    __entry->hdr_refcount\t= hdr->b_l1hdr.b_refcnt.rc_count;\n\n\t    __entry->bp_dva0[0]\t\t= bp->blk_dva[0].dva_word[0];\n\t    __entry->bp_dva0[1]\t\t= bp->blk_dva[0].dva_word[1];\n\t    __entry->bp_dva1[0]\t\t= bp->blk_dva[1].dva_word[0];\n\t    __entry->bp_dva1[1]\t\t= bp->blk_dva[1].dva_word[1];\n\t    __entry->bp_dva2[0]\t\t= bp->blk_dva[2].dva_word[0];\n\t    __entry->bp_dva2[1]\t\t= bp->blk_dva[2].dva_word[1];\n\t    __entry->bp_cksum[0]\t= bp->blk_cksum.zc_word[0];\n\t    __entry->bp_cksum[1]\t= bp->blk_cksum.zc_word[1];\n\t    __entry->bp_cksum[2]\t= bp->blk_cksum.zc_word[2];\n\t    __entry->bp_cksum[3]\t= bp->blk_cksum.zc_word[3];\n\n\t    __entry->bp_lsize\t\t= size;\n\n\t    __entry->zb_objset\t\t= zb->zb_objset;\n\t    __entry->zb_object\t\t= zb->zb_object;\n\t    __entry->zb_level\t\t= zb->zb_level;\n\t    __entry->zb_blkid\t\t= zb->zb_blkid;\n\t),\n\tTP_printk(\"hdr { dva 0x%llx:0x%llx birth %llu \"\n\t    \"flags 0x%x psize %u lsize %u spa %llu state_type %u \"\n\t    \"access %lu mru_hits %u mru_ghost_hits %u mfu_hits %u \"\n\t    \"mfu_ghost_hits %u l2_hits %u refcount %lli } \"\n\t    \"bp { dva0 0x%llx:0x%llx dva1 0x%llx:0x%llx dva2 \"\n\t    \"0x%llx:0x%llx cksum 0x%llx:0x%llx:0x%llx:0x%llx \"\n\t    \"lsize %llu } zb { objset %llu object %llu level %lli \"\n\t    \"blkid %llu }\",\n\t    __entry->hdr_dva_word[0], __entry->hdr_dva_word[1],\n\t    __entry->hdr_birth, __entry->hdr_flags,\n\t    __entry->hdr_psize, __entry->hdr_lsize,\n\t    __entry->hdr_spa, __entry->hdr_state_type, __entry->hdr_access,\n\t    __entry->hdr_mru_hits, __entry->hdr_mru_ghost_hits,\n\t    __entry->hdr_mfu_hits, __entry->hdr_mfu_ghost_hits,\n\t    __entry->hdr_l2_hits, __entry->hdr_refcount,\n\t    __entry->bp_dva0[0], __entry->bp_dva0[1],\n\t    __entry->bp_dva1[0], __entry->bp_dva1[1],\n\t    __entry->bp_dva2[0], __entry->bp_dva2[1],\n\t    __entry->bp_cksum[0], __entry->bp_cksum[1],\n\t    __entry->bp_cksum[2], __entry->bp_cksum[3],\n\t    __entry->bp_lsize, __entry->zb_objset, __entry->zb_object,\n\t    __entry->zb_level, __entry->zb_blkid)\n);\n \n\n#define\tDEFINE_ARC_MISS_EVENT(name) \\\nDEFINE_EVENT(zfs_arc_miss_class, name, \\\n    TP_PROTO(arc_buf_hdr_t *hdr, \\\n    const blkptr_t *bp, uint64_t size, const zbookmark_phys_t *zb), \\\n    TP_ARGS(hdr, bp, size, zb))\nDEFINE_ARC_MISS_EVENT(zfs_arc__miss);\n\n \n \nDECLARE_EVENT_CLASS(zfs_l2arc_evict_class,\n\tTP_PROTO(l2arc_dev_t *dev,\n\t    list_t *buflist, uint64_t taddr, boolean_t all),\n\tTP_ARGS(dev, buflist, taddr, all),\n\tTP_STRUCT__entry(\n\t    __field(uint64_t,\t\tvdev_id)\n\t    __field(uint64_t,\t\tvdev_guid)\n\t    __field(uint64_t,\t\tvdev_state)\n\n\t    __field(uint64_t,\t\tl2ad_hand)\n\t    __field(uint64_t,\t\tl2ad_start)\n\t    __field(uint64_t,\t\tl2ad_end)\n\t    __field(boolean_t,\t\tl2ad_first)\n\t    __field(boolean_t,\t\tl2ad_writing)\n\n\t    __field(uint64_t,\t\ttaddr)\n\t    __field(boolean_t,\t\tall)\n\t),\n\tTP_fast_assign(\n\t    __entry->vdev_id\t\t= dev->l2ad_vdev->vdev_id;\n\t    __entry->vdev_guid\t\t= dev->l2ad_vdev->vdev_guid;\n\t    __entry->vdev_state\t\t= dev->l2ad_vdev->vdev_state;\n\n\t    __entry->l2ad_hand\t\t= dev->l2ad_hand;\n\t    __entry->l2ad_start\t\t= dev->l2ad_start;\n\t    __entry->l2ad_end\t\t= dev->l2ad_end;\n\t    __entry->l2ad_first\t\t= dev->l2ad_first;\n\t    __entry->l2ad_writing\t= dev->l2ad_writing;\n\n\t    __entry->taddr\t\t= taddr;\n\t    __entry->all\t\t= all;\n\t),\n\tTP_printk(\"l2ad { vdev { id %llu guid %llu state %llu } \"\n\t    \"hand %llu start %llu end %llu \"\n\t    \"first %d writing %d } taddr %llu all %d\",\n\t    __entry->vdev_id, __entry->vdev_guid, __entry->vdev_state,\n\t    __entry->l2ad_hand, __entry->l2ad_start,\n\t    __entry->l2ad_end, __entry->l2ad_first, __entry->l2ad_writing,\n\t    __entry->taddr, __entry->all)\n);\n \n\n#define\tDEFINE_L2ARC_EVICT_EVENT(name) \\\nDEFINE_EVENT(zfs_l2arc_evict_class, name, \\\n    TP_PROTO(l2arc_dev_t *dev, list_t *buflist, uint64_t taddr, boolean_t all),\\\n    TP_ARGS(dev, buflist, taddr, all))\nDEFINE_L2ARC_EVICT_EVENT(zfs_l2arc__evict);\n\n \n \nDECLARE_EVENT_CLASS(zfs_arc_wait_for_eviction_class,\n\tTP_PROTO(uint64_t amount, uint64_t arc_evict_count, uint64_t aew_count),\n\tTP_ARGS(amount, arc_evict_count, aew_count),\n\tTP_STRUCT__entry(\n\t    __field(uint64_t,\t\tamount)\n\t    __field(uint64_t,\t\tarc_evict_count)\n\t    __field(uint64_t,\t\taew_count)\n\t),\n\tTP_fast_assign(\n\t    __entry->amount\t\t= amount;\n\t    __entry->arc_evict_count\t= arc_evict_count;\n\t    __entry->aew_count\t\t= aew_count;\n\t),\n\tTP_printk(\"amount %llu arc_evict_count %llu aew_count %llu\",\n\t    __entry->amount, __entry->arc_evict_count, __entry->aew_count)\n);\n \n\n#define\tDEFINE_ARC_WAIT_FOR_EVICTION_EVENT(name) \\\nDEFINE_EVENT(zfs_arc_wait_for_eviction_class, name, \\\n    TP_PROTO(uint64_t amount, uint64_t arc_evict_count, uint64_t aew_count), \\\n    TP_ARGS(amount, arc_evict_count, aew_count))\nDEFINE_ARC_WAIT_FOR_EVICTION_EVENT(zfs_arc__wait__for__eviction);\n\n#endif  \n\n#undef TRACE_INCLUDE_PATH\n#undef TRACE_INCLUDE_FILE\n#define\tTRACE_INCLUDE_PATH sys\n#define\tTRACE_INCLUDE_FILE trace_arc\n#include <trace/define_trace.h>\n\n#else\n\nDEFINE_DTRACE_PROBE1(arc__hit);\nDEFINE_DTRACE_PROBE1(arc__iohit);\nDEFINE_DTRACE_PROBE1(arc__evict);\nDEFINE_DTRACE_PROBE1(arc__delete);\nDEFINE_DTRACE_PROBE1(new_state__mru);\nDEFINE_DTRACE_PROBE1(new_state__mfu);\nDEFINE_DTRACE_PROBE1(new_state__uncached);\nDEFINE_DTRACE_PROBE1(arc__async__upgrade__sync);\nDEFINE_DTRACE_PROBE1(l2arc__hit);\nDEFINE_DTRACE_PROBE1(l2arc__miss);\nDEFINE_DTRACE_PROBE2(l2arc__read);\nDEFINE_DTRACE_PROBE2(l2arc__write);\nDEFINE_DTRACE_PROBE2(l2arc__iodone);\nDEFINE_DTRACE_PROBE3(arc__wait__for__eviction);\nDEFINE_DTRACE_PROBE4(arc__miss);\nDEFINE_DTRACE_PROBE4(l2arc__evict);\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}