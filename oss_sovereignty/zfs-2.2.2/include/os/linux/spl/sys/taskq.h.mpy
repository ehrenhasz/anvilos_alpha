{
  "module_name": "taskq.h",
  "hash_id": "6fb4b79d74dfe60098e4f980daf504bf20904412ced1fc1adfc6c88bf4cccf9d",
  "original_prompt": "Ingested from zfs-2.2.2/include/os/linux/spl/sys/taskq.h",
  "human_readable_source": " \n\n#ifndef _SPL_TASKQ_H\n#define\t_SPL_TASKQ_H\n\n#include <linux/module.h>\n#include <linux/gfp.h>\n#include <linux/slab.h>\n#include <linux/interrupt.h>\n#include <linux/kthread.h>\n#include <sys/types.h>\n#include <sys/thread.h>\n#include <sys/rwlock.h>\n#include <sys/wait.h>\n\n#define\tTASKQ_NAMELEN\t\t31\n\n#define\tTASKQ_PREPOPULATE\t0x00000001\n#define\tTASKQ_CPR_SAFE\t\t0x00000002\n#define\tTASKQ_DYNAMIC\t\t0x00000004\n#define\tTASKQ_THREADS_CPU_PCT\t0x00000008\n#define\tTASKQ_DC_BATCH\t\t0x00000010\n#define\tTASKQ_ACTIVE\t\t0x80000000\n\n \n#define\tTQ_SLEEP\t\t0x00000000\n#define\tTQ_NOSLEEP\t\t0x00000001\n#define\tTQ_PUSHPAGE\t\t0x00000002\n#define\tTQ_NOQUEUE\t\t0x01000000\n#define\tTQ_NOALLOC\t\t0x02000000\n#define\tTQ_NEW\t\t\t0x04000000\n#define\tTQ_FRONT\t\t0x08000000\n\n \n#define\tTASKQID_INVALID\t\t((taskqid_t)0)\n#define\tTASKQID_INITIAL\t\t((taskqid_t)1)\n\n \ntypedef enum tq_lock_role {\n\tTQ_LOCK_GENERAL =\t0,\n\tTQ_LOCK_DYNAMIC =\t1,\n} tq_lock_role_t;\n\ntypedef unsigned long taskqid_t;\ntypedef void (task_func_t)(void *);\n\ntypedef struct taskq {\n\tspinlock_t\t\ttq_lock;\t \n\tchar\t\t\t*tq_name;\t \n\tint\t\t\ttq_instance;\t \n\tstruct list_head\ttq_thread_list;\t \n\tstruct list_head\ttq_active_list;\t \n\tint\t\t\ttq_nactive;\t \n\tint\t\t\ttq_nthreads;\t \n\tint\t\t\ttq_nspawn;\t \n\tint\t\t\ttq_maxthreads;\t \n\t \n\tint\t\t\ttq_cpu_pct;\n\tint\t\t\ttq_pri;\t\t \n\tint\t\t\ttq_minalloc;\t \n\tint\t\t\ttq_maxalloc;\t \n\tint\t\t\ttq_nalloc;\t \n\tuint_t\t\t\ttq_flags;\t \n\ttaskqid_t\t\ttq_next_id;\t \n\ttaskqid_t\t\ttq_lowest_id;\t \n\tstruct list_head\ttq_free_list;\t \n\tstruct list_head\ttq_pend_list;\t \n\tstruct list_head\ttq_prio_list;\t \n\tstruct list_head\ttq_delay_list;\t \n\tstruct list_head\ttq_taskqs;\t \n\tspl_wait_queue_head_t\ttq_work_waitq;\t \n\tspl_wait_queue_head_t\ttq_wait_waitq;\t \n\ttq_lock_role_t\t\ttq_lock_class;\t \n\t \n\tstruct hlist_node\ttq_hp_cb_node;\n\tboolean_t\t\ttq_hp_support;\n\tunsigned long\t\tlastshouldstop;  \n} taskq_t;\n\ntypedef struct taskq_ent {\n\tspinlock_t\t\ttqent_lock;\n\tspl_wait_queue_head_t\ttqent_waitq;\n\tstruct timer_list\ttqent_timer;\n\tstruct list_head\ttqent_list;\n\ttaskqid_t\t\ttqent_id;\n\ttask_func_t\t\t*tqent_func;\n\tvoid\t\t\t*tqent_arg;\n\ttaskq_t\t\t\t*tqent_taskq;\n\tuintptr_t\t\ttqent_flags;\n\tunsigned long\t\ttqent_birth;\n} taskq_ent_t;\n\n#define\tTQENT_FLAG_PREALLOC\t0x1\n#define\tTQENT_FLAG_CANCEL\t0x2\n\ntypedef struct taskq_thread {\n\tstruct list_head\ttqt_thread_list;\n\tstruct list_head\ttqt_active_list;\n\tstruct task_struct\t*tqt_thread;\n\ttaskq_t\t\t\t*tqt_tq;\n\ttaskqid_t\t\ttqt_id;\n\ttaskq_ent_t\t\t*tqt_task;\n\tuintptr_t\t\ttqt_flags;\n} taskq_thread_t;\n\n \nextern taskq_t *system_taskq;\n \nextern taskq_t *system_delay_taskq;\n\n \nextern struct list_head tq_list;\nextern struct rw_semaphore tq_list_sem;\n\nextern taskqid_t taskq_dispatch(taskq_t *, task_func_t, void *, uint_t);\nextern taskqid_t taskq_dispatch_delay(taskq_t *, task_func_t, void *,\n    uint_t, clock_t);\nextern void taskq_dispatch_ent(taskq_t *, task_func_t, void *, uint_t,\n    taskq_ent_t *);\nextern int taskq_empty_ent(taskq_ent_t *);\nextern void taskq_init_ent(taskq_ent_t *);\nextern taskq_t *taskq_create(const char *, int, pri_t, int, int, uint_t);\nextern void taskq_destroy(taskq_t *);\nextern void taskq_wait_id(taskq_t *, taskqid_t);\nextern void taskq_wait_outstanding(taskq_t *, taskqid_t);\nextern void taskq_wait(taskq_t *);\nextern int taskq_cancel_id(taskq_t *, taskqid_t);\nextern int taskq_member(taskq_t *, kthread_t *);\nextern taskq_t *taskq_of_curthread(void);\n\n#define\ttaskq_create_proc(name, nthreads, pri, min, max, proc, flags) \\\n    taskq_create(name, nthreads, pri, min, max, flags)\n#define\ttaskq_create_sysdc(name, nthreads, min, max, proc, dc, flags) \\\n\t((void) sizeof (dc), \\\n\t    taskq_create(name, nthreads, maxclsyspri, min, max, flags))\n\nint spl_taskq_init(void);\nvoid spl_taskq_fini(void);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}