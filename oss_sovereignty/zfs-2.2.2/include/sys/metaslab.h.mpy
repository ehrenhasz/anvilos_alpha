{
  "module_name": "metaslab.h",
  "hash_id": "e7ff5f5450e02908a552c467d33c26252fd0fa09c71b2149dff720af5bbc0c90",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/metaslab.h",
  "human_readable_source": " \n \n\n#ifndef _SYS_METASLAB_H\n#define\t_SYS_METASLAB_H\n\n#include <sys/spa.h>\n#include <sys/space_map.h>\n#include <sys/txg.h>\n#include <sys/zio.h>\n#include <sys/avl.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n\ntypedef struct metaslab_ops {\n\tuint64_t (*msop_alloc)(metaslab_t *, uint64_t);\n} metaslab_ops_t;\n\n\nextern const metaslab_ops_t zfs_metaslab_ops;\n\nint metaslab_init(metaslab_group_t *, uint64_t, uint64_t, uint64_t,\n    metaslab_t **);\nvoid metaslab_fini(metaslab_t *);\n\nvoid metaslab_set_unflushed_dirty(metaslab_t *, boolean_t);\nvoid metaslab_set_unflushed_txg(metaslab_t *, uint64_t, dmu_tx_t *);\nvoid metaslab_set_estimated_condensed_size(metaslab_t *, uint64_t, dmu_tx_t *);\nboolean_t metaslab_unflushed_dirty(metaslab_t *);\nuint64_t metaslab_unflushed_txg(metaslab_t *);\nuint64_t metaslab_estimated_condensed_size(metaslab_t *);\nint metaslab_sort_by_flushed(const void *, const void *);\nvoid metaslab_unflushed_bump(metaslab_t *, dmu_tx_t *, boolean_t);\nuint64_t metaslab_unflushed_changes_memused(metaslab_t *);\n\nint metaslab_load(metaslab_t *);\nvoid metaslab_unload(metaslab_t *);\nboolean_t metaslab_flush(metaslab_t *, dmu_tx_t *);\n\nuint64_t metaslab_allocated_space(metaslab_t *);\n\nvoid metaslab_sync(metaslab_t *, uint64_t);\nvoid metaslab_sync_done(metaslab_t *, uint64_t);\nvoid metaslab_sync_reassess(metaslab_group_t *);\nuint64_t metaslab_largest_allocatable(metaslab_t *);\n\n \n#define\tMETASLAB_HINTBP_FAVOR\t\t0x0\n#define\tMETASLAB_HINTBP_AVOID\t\t0x1\n#define\tMETASLAB_GANG_HEADER\t\t0x2\n#define\tMETASLAB_GANG_CHILD\t\t0x4\n#define\tMETASLAB_ASYNC_ALLOC\t\t0x8\n#define\tMETASLAB_DONT_THROTTLE\t\t0x10\n#define\tMETASLAB_MUST_RESERVE\t\t0x20\n#define\tMETASLAB_ZIL\t\t\t0x80\n\nint metaslab_alloc(spa_t *, metaslab_class_t *, uint64_t,\n    blkptr_t *, int, uint64_t, blkptr_t *, int, zio_alloc_list_t *, zio_t *,\n\tint);\nint metaslab_alloc_dva(spa_t *, metaslab_class_t *, uint64_t,\n    dva_t *, int, dva_t *, uint64_t, int, zio_alloc_list_t *, int);\nvoid metaslab_free(spa_t *, const blkptr_t *, uint64_t, boolean_t);\nvoid metaslab_free_concrete(vdev_t *, uint64_t, uint64_t, boolean_t);\nvoid metaslab_free_dva(spa_t *, const dva_t *, boolean_t);\nvoid metaslab_free_impl_cb(uint64_t, vdev_t *, uint64_t, uint64_t, void *);\nvoid metaslab_unalloc_dva(spa_t *, const dva_t *, uint64_t);\nint metaslab_claim(spa_t *, const blkptr_t *, uint64_t);\nint metaslab_claim_impl(vdev_t *, uint64_t, uint64_t, uint64_t);\nvoid metaslab_check_free(spa_t *, const blkptr_t *);\n\nvoid metaslab_stat_init(void);\nvoid metaslab_stat_fini(void);\nvoid metaslab_trace_init(zio_alloc_list_t *);\nvoid metaslab_trace_fini(zio_alloc_list_t *);\n\nmetaslab_class_t *metaslab_class_create(spa_t *, const metaslab_ops_t *);\nvoid metaslab_class_destroy(metaslab_class_t *);\nint metaslab_class_validate(metaslab_class_t *);\nvoid metaslab_class_histogram_verify(metaslab_class_t *);\nuint64_t metaslab_class_fragmentation(metaslab_class_t *);\nuint64_t metaslab_class_expandable_space(metaslab_class_t *);\nboolean_t metaslab_class_throttle_reserve(metaslab_class_t *, int, int,\n    zio_t *, int);\nvoid metaslab_class_throttle_unreserve(metaslab_class_t *, int, int, zio_t *);\nvoid metaslab_class_evict_old(metaslab_class_t *, uint64_t);\nuint64_t metaslab_class_get_alloc(metaslab_class_t *);\nuint64_t metaslab_class_get_space(metaslab_class_t *);\nuint64_t metaslab_class_get_dspace(metaslab_class_t *);\nuint64_t metaslab_class_get_deferred(metaslab_class_t *);\n\nvoid metaslab_space_update(vdev_t *, metaslab_class_t *,\n    int64_t, int64_t, int64_t);\n\nmetaslab_group_t *metaslab_group_create(metaslab_class_t *, vdev_t *, int);\nvoid metaslab_group_destroy(metaslab_group_t *);\nvoid metaslab_group_activate(metaslab_group_t *);\nvoid metaslab_group_passivate(metaslab_group_t *);\nboolean_t metaslab_group_initialized(metaslab_group_t *);\nuint64_t metaslab_group_get_space(metaslab_group_t *);\nvoid metaslab_group_histogram_verify(metaslab_group_t *);\nuint64_t metaslab_group_fragmentation(metaslab_group_t *);\nvoid metaslab_group_histogram_remove(metaslab_group_t *, metaslab_t *);\nvoid metaslab_group_alloc_decrement(spa_t *, uint64_t, const void *, int, int,\n    boolean_t);\nvoid metaslab_group_alloc_verify(spa_t *, const blkptr_t *, const void *, int);\nvoid metaslab_recalculate_weight_and_sort(metaslab_t *);\nvoid metaslab_disable(metaslab_t *);\nvoid metaslab_enable(metaslab_t *, boolean_t, boolean_t);\nvoid metaslab_set_selected_txg(metaslab_t *, uint64_t);\n\nextern int metaslab_debug_load;\n\nrange_seg_type_t metaslab_calculate_range_tree_type(vdev_t *vdev,\n    metaslab_t *msp, uint64_t *start, uint64_t *shift);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}