{
  "module_name": "zap.h",
  "hash_id": "6af82ed74a51842d771381a4fdb24c33ea9ee313f38dfa8d28bef9bbec47c74c",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/zap.h",
  "human_readable_source": " \n\n \n\n#ifndef\t_SYS_ZAP_H\n#define\t_SYS_ZAP_H\n\n \n\n \n\n#include <sys/dmu.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n \ntypedef enum matchtype {\n\tMT_NORMALIZE = 1 << 0,\n\tMT_MATCH_CASE = 1 << 1,\n} matchtype_t;\n\ntypedef enum zap_flags {\n\t \n\tZAP_FLAG_HASH64 = 1 << 0,\n\t \n\tZAP_FLAG_UINT64_KEY = 1 << 1,\n\t \n\tZAP_FLAG_PRE_HASHED_KEY = 1 << 2,\n#if defined(__linux__) && defined(_KERNEL)\n} zfs_zap_flags_t;\n#define\tzap_flags_t\tzfs_zap_flags_t\n#else\n} zap_flags_t;\n#endif\n\n \nuint64_t zap_create(objset_t *ds, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, dmu_tx_t *tx);\nuint64_t zap_create_dnsize(objset_t *ds, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, int dnodesize, dmu_tx_t *tx);\nuint64_t zap_create_norm(objset_t *ds, int normflags, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, dmu_tx_t *tx);\nuint64_t zap_create_norm_dnsize(objset_t *ds, int normflags,\n    dmu_object_type_t ot, dmu_object_type_t bonustype, int bonuslen,\n    int dnodesize, dmu_tx_t *tx);\nuint64_t zap_create_flags(objset_t *os, int normflags, zap_flags_t flags,\n    dmu_object_type_t ot, int leaf_blockshift, int indirect_blockshift,\n    dmu_object_type_t bonustype, int bonuslen, dmu_tx_t *tx);\nuint64_t zap_create_flags_dnsize(objset_t *os, int normflags,\n    zap_flags_t flags, dmu_object_type_t ot, int leaf_blockshift,\n    int indirect_blockshift, dmu_object_type_t bonustype, int bonuslen,\n    int dnodesize, dmu_tx_t *tx);\nuint64_t zap_create_hold(objset_t *os, int normflags, zap_flags_t flags,\n    dmu_object_type_t ot, int leaf_blockshift, int indirect_blockshift,\n    dmu_object_type_t bonustype, int bonuslen, int dnodesize,\n    dnode_t **allocated_dnode, const void *tag, dmu_tx_t *tx);\n\nuint64_t zap_create_link(objset_t *os, dmu_object_type_t ot,\n    uint64_t parent_obj, const char *name, dmu_tx_t *tx);\nuint64_t zap_create_link_dnsize(objset_t *os, dmu_object_type_t ot,\n    uint64_t parent_obj, const char *name, int dnodesize, dmu_tx_t *tx);\n\n \nvoid mzap_create_impl(dnode_t *dn, int normflags, zap_flags_t flags,\n    dmu_tx_t *tx);\n\n \nint zap_create_claim(objset_t *ds, uint64_t obj, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, dmu_tx_t *tx);\nint zap_create_claim_dnsize(objset_t *ds, uint64_t obj, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, int dnodesize, dmu_tx_t *tx);\nint zap_create_claim_norm(objset_t *ds, uint64_t obj,\n    int normflags, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, dmu_tx_t *tx);\nint zap_create_claim_norm_dnsize(objset_t *ds, uint64_t obj,\n    int normflags, dmu_object_type_t ot,\n    dmu_object_type_t bonustype, int bonuslen, int dnodesize, dmu_tx_t *tx);\n\n \n\n \nint zap_destroy(objset_t *ds, uint64_t zapobj, dmu_tx_t *tx);\n\n \n\n \nint zap_lookup(objset_t *ds, uint64_t zapobj, const char *name,\n    uint64_t integer_size, uint64_t num_integers, void *buf);\n\n \nint zap_lookup_norm(objset_t *ds, uint64_t zapobj, const char *name,\n    uint64_t integer_size, uint64_t num_integers, void *buf,\n    matchtype_t mt, char *realname, int rn_len,\n    boolean_t *normalization_conflictp);\nint zap_lookup_uint64(objset_t *os, uint64_t zapobj, const uint64_t *key,\n    int key_numints, uint64_t integer_size, uint64_t num_integers, void *buf);\nint zap_contains(objset_t *ds, uint64_t zapobj, const char *name);\nint zap_prefetch(objset_t *os, uint64_t zapobj, const char *name);\nint zap_prefetch_uint64(objset_t *os, uint64_t zapobj, const uint64_t *key,\n    int key_numints);\n\nint zap_lookup_by_dnode(dnode_t *dn, const char *name,\n    uint64_t integer_size, uint64_t num_integers, void *buf);\nint zap_lookup_norm_by_dnode(dnode_t *dn, const char *name,\n    uint64_t integer_size, uint64_t num_integers, void *buf,\n    matchtype_t mt, char *realname, int rn_len,\n    boolean_t *ncp);\n\nint zap_count_write_by_dnode(dnode_t *dn, const char *name,\n    int add, zfs_refcount_t *towrite, zfs_refcount_t *tooverwrite);\n\n \nint zap_add(objset_t *ds, uint64_t zapobj, const char *key,\n    int integer_size, uint64_t num_integers,\n    const void *val, dmu_tx_t *tx);\nint zap_add_by_dnode(dnode_t *dn, const char *key,\n    int integer_size, uint64_t num_integers,\n    const void *val, dmu_tx_t *tx);\nint zap_add_uint64(objset_t *ds, uint64_t zapobj, const uint64_t *key,\n    int key_numints, int integer_size, uint64_t num_integers,\n    const void *val, dmu_tx_t *tx);\n\n \nint zap_update(objset_t *ds, uint64_t zapobj, const char *name,\n    int integer_size, uint64_t num_integers, const void *val, dmu_tx_t *tx);\nint zap_update_uint64(objset_t *os, uint64_t zapobj, const uint64_t *key,\n    int key_numints,\n    int integer_size, uint64_t num_integers, const void *val, dmu_tx_t *tx);\n\n \nint zap_length(objset_t *ds, uint64_t zapobj, const char *name,\n    uint64_t *integer_size, uint64_t *num_integers);\nint zap_length_uint64(objset_t *os, uint64_t zapobj, const uint64_t *key,\n    int key_numints, uint64_t *integer_size, uint64_t *num_integers);\n\n \nint zap_remove(objset_t *ds, uint64_t zapobj, const char *name, dmu_tx_t *tx);\nint zap_remove_norm(objset_t *ds, uint64_t zapobj, const char *name,\n    matchtype_t mt, dmu_tx_t *tx);\nint zap_remove_by_dnode(dnode_t *dn, const char *name, dmu_tx_t *tx);\nint zap_remove_uint64(objset_t *os, uint64_t zapobj, const uint64_t *key,\n    int key_numints, dmu_tx_t *tx);\n\n \nint zap_count(objset_t *ds, uint64_t zapobj, uint64_t *count);\n\n \nint zap_value_search(objset_t *os, uint64_t zapobj,\n    uint64_t value, uint64_t mask, char *name);\n\n \nint zap_join(objset_t *os, uint64_t fromobj, uint64_t intoobj, dmu_tx_t *tx);\n\n \nint zap_join_key(objset_t *os, uint64_t fromobj, uint64_t intoobj,\n    uint64_t value, dmu_tx_t *tx);\n\n \nint zap_join_increment(objset_t *os, uint64_t fromobj, uint64_t intoobj,\n    dmu_tx_t *tx);\n\n \nint zap_add_int(objset_t *os, uint64_t obj, uint64_t value, dmu_tx_t *tx);\nint zap_remove_int(objset_t *os, uint64_t obj, uint64_t value, dmu_tx_t *tx);\nint zap_lookup_int(objset_t *os, uint64_t obj, uint64_t value);\nint zap_increment_int(objset_t *os, uint64_t obj, uint64_t key, int64_t delta,\n    dmu_tx_t *tx);\n\n \nint zap_add_int_key(objset_t *os, uint64_t obj,\n    uint64_t key, uint64_t value, dmu_tx_t *tx);\nint zap_update_int_key(objset_t *os, uint64_t obj,\n    uint64_t key, uint64_t value, dmu_tx_t *tx);\nint zap_lookup_int_key(objset_t *os, uint64_t obj,\n    uint64_t key, uint64_t *valuep);\n\nint zap_increment(objset_t *os, uint64_t obj, const char *name, int64_t delta,\n    dmu_tx_t *tx);\n\nstruct zap;\nstruct zap_leaf;\ntypedef struct zap_cursor {\n\t \n\tobjset_t *zc_objset;\n\tstruct zap *zc_zap;\n\tstruct zap_leaf *zc_leaf;\n\tuint64_t zc_zapobj;\n\tuint64_t zc_serialized;\n\tuint64_t zc_hash;\n\tuint32_t zc_cd;\n\tboolean_t zc_prefetch;\n} zap_cursor_t;\n\ntypedef struct {\n\tint za_integer_length;\n\t \n\tboolean_t za_normalization_conflict;\n\tuint64_t za_num_integers;\n\tuint64_t za_first_integer;\t \n\tchar za_name[ZAP_MAXNAMELEN];\n} zap_attribute_t;\n\n \n\n \nvoid zap_cursor_init(zap_cursor_t *zc, objset_t *os, uint64_t zapobj);\nvoid zap_cursor_init_noprefetch(zap_cursor_t *zc, objset_t *os,\n    uint64_t zapobj);\nvoid zap_cursor_fini(zap_cursor_t *zc);\n\n \nint zap_cursor_retrieve(zap_cursor_t *zc, zap_attribute_t *za);\n\n \nvoid zap_cursor_advance(zap_cursor_t *zc);\n\n \nuint64_t zap_cursor_serialize(zap_cursor_t *zc);\n\n \nvoid zap_cursor_init_serialized(zap_cursor_t *zc, objset_t *ds,\n    uint64_t zapobj, uint64_t serialized);\n\n\n#define\tZAP_HISTOGRAM_SIZE 10\n\ntypedef struct zap_stats {\n\t \n\tuint64_t zs_ptrtbl_len;\n\n\tuint64_t zs_blocksize;\t\t \n\n\t \n\tuint64_t zs_num_blocks;\n\n\t \n\tuint64_t zs_ptrtbl_nextblk;\t   \n\tuint64_t zs_ptrtbl_blks_copied;    \n\tuint64_t zs_ptrtbl_zt_blk;\t   \n\tuint64_t zs_ptrtbl_zt_numblks;     \n\tuint64_t zs_ptrtbl_zt_shift;\t   \n\n\t \n\tuint64_t zs_block_type;\t\t \n\tuint64_t zs_magic;\t\t \n\tuint64_t zs_num_leafs;\t\t \n\tuint64_t zs_num_entries;\t \n\tuint64_t zs_salt;\t\t \n\n\t \n\n\t \n\tuint64_t zs_leafs_with_2n_pointers[ZAP_HISTOGRAM_SIZE];\n\n\t \n\tuint64_t zs_blocks_with_n5_entries[ZAP_HISTOGRAM_SIZE];\n\n\t \n\tuint64_t zs_blocks_n_tenths_full[ZAP_HISTOGRAM_SIZE];\n\n\t \n\tuint64_t zs_entries_using_n_chunks[ZAP_HISTOGRAM_SIZE];\n\n\t \n\tuint64_t zs_buckets_with_n_entries[ZAP_HISTOGRAM_SIZE];\n} zap_stats_t;\n\n \nint zap_get_stats(objset_t *ds, uint64_t zapobj, zap_stats_t *zs);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}