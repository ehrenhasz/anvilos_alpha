{
  "module_name": "dsl_pool.h",
  "hash_id": "c8f44e16f9d8602b8260935c95c9cbac0a15ffe5c9fbd7df536a5730e4a89fd7",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/dsl_pool.h",
  "human_readable_source": " \n \n\n#ifndef\t_SYS_DSL_POOL_H\n#define\t_SYS_DSL_POOL_H\n\n#include <sys/spa.h>\n#include <sys/txg.h>\n#include <sys/txg_impl.h>\n#include <sys/zfs_context.h>\n#include <sys/zio.h>\n#include <sys/dnode.h>\n#include <sys/ddt.h>\n#include <sys/arc.h>\n#include <sys/bpobj.h>\n#include <sys/bptree.h>\n#include <sys/rrwlock.h>\n#include <sys/dsl_synctask.h>\n#include <sys/mmp.h>\n#include <sys/aggsum.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\nextern int zfs_txg_synctime_ms;\n\nstruct objset;\nstruct dsl_dir;\nstruct dsl_dataset;\nstruct dsl_pool;\nstruct dmu_tx;\nstruct dsl_scan;\nstruct dsl_crypto_params;\nstruct dsl_deadlist;\n\nextern uint64_t zfs_dirty_data_max;\nextern uint64_t zfs_dirty_data_max_max;\nextern uint64_t zfs_wrlog_data_max;\nextern uint_t zfs_dirty_data_max_percent;\nextern uint_t zfs_dirty_data_max_max_percent;\nextern uint_t zfs_delay_min_dirty_percent;\nextern uint64_t zfs_delay_scale;\n\n \n#define\tDMU_OT_DEFERRED\tDMU_OT_NONE\n#define\tDMU_OT_OTHER\tDMU_OT_NUMTYPES  \n#define\tDMU_OT_TOTAL\t(DMU_OT_NUMTYPES + 1)\n\ntypedef struct zfs_blkstat {\n\tuint64_t\tzb_count;\n\tuint64_t\tzb_asize;\n\tuint64_t\tzb_lsize;\n\tuint64_t\tzb_psize;\n\tuint64_t\tzb_gangs;\n\tuint64_t\tzb_ditto_2_of_2_samevdev;\n\tuint64_t\tzb_ditto_2_of_3_samevdev;\n\tuint64_t\tzb_ditto_3_of_3_samevdev;\n} zfs_blkstat_t;\n\ntypedef struct zfs_all_blkstats {\n\tzfs_blkstat_t\tzab_type[DN_MAX_LEVELS + 1][DMU_OT_TOTAL + 1];\n} zfs_all_blkstats_t;\n\n\ntypedef struct dsl_pool {\n\t \n\tspa_t *dp_spa;\n\tstruct objset *dp_meta_objset;\n\tstruct dsl_dir *dp_root_dir;\n\tstruct dsl_dir *dp_mos_dir;\n\tstruct dsl_dir *dp_free_dir;\n\tstruct dsl_dir *dp_leak_dir;\n\tstruct dsl_dataset *dp_origin_snap;\n\tuint64_t dp_root_dir_obj;\n\tstruct taskq *dp_zrele_taskq;\n\tstruct taskq *dp_unlinked_drain_taskq;\n\n\t \n\tblkptr_t dp_meta_rootbp;\n\tuint64_t dp_tmp_userrefs_obj;\n\tbpobj_t dp_free_bpobj;\n\tuint64_t dp_bptree_obj;\n\tuint64_t dp_empty_bpobj;\n\tbpobj_t dp_obsolete_bpobj;\n\n\tstruct dsl_scan *dp_scan;\n\n\t \n\tkmutex_t dp_lock;\n\tkcondvar_t dp_spaceavail_cv;\n\tuint64_t dp_dirty_pertxg[TXG_SIZE];\n\tuint64_t dp_dirty_total;\n\tuint64_t dp_long_free_dirty_pertxg[TXG_SIZE];\n\tuint64_t dp_mos_used_delta;\n\tuint64_t dp_mos_compressed_delta;\n\tuint64_t dp_mos_uncompressed_delta;\n\n\taggsum_t dp_wrlog_pertxg[TXG_SIZE];\n\taggsum_t dp_wrlog_total;\n\n\t \n\thrtime_t dp_last_wakeup;\n\n\t \n\ttx_state_t dp_tx;\n\ttxg_list_t dp_dirty_datasets;\n\ttxg_list_t dp_dirty_zilogs;\n\ttxg_list_t dp_dirty_dirs;\n\ttxg_list_t dp_sync_tasks;\n\ttxg_list_t dp_early_sync_tasks;\n\ttaskq_t *dp_sync_taskq;\n\ttaskq_t *dp_zil_clean_taskq;\n\n\t \n\trrwlock_t dp_config_rwlock;\n\n\tzfs_all_blkstats_t *dp_blkstats;\n} dsl_pool_t;\n\nint dsl_pool_init(spa_t *spa, uint64_t txg, dsl_pool_t **dpp);\nint dsl_pool_open(dsl_pool_t *dp);\nvoid dsl_pool_close(dsl_pool_t *dp);\ndsl_pool_t *dsl_pool_create(spa_t *spa, nvlist_t *zplprops,\n    struct dsl_crypto_params *dcp, uint64_t txg);\nvoid dsl_pool_sync(dsl_pool_t *dp, uint64_t txg);\nvoid dsl_pool_sync_done(dsl_pool_t *dp, uint64_t txg);\nint dsl_pool_sync_context(dsl_pool_t *dp);\nuint64_t dsl_pool_adjustedsize(dsl_pool_t *dp, zfs_space_check_t slop_policy);\nuint64_t dsl_pool_unreserved_space(dsl_pool_t *dp,\n    zfs_space_check_t slop_policy);\nuint64_t dsl_pool_deferred_space(dsl_pool_t *dp);\nvoid dsl_pool_wrlog_count(dsl_pool_t *dp, int64_t size, uint64_t txg);\nboolean_t dsl_pool_need_wrlog_delay(dsl_pool_t *dp);\nvoid dsl_pool_dirty_space(dsl_pool_t *dp, int64_t space, dmu_tx_t *tx);\nvoid dsl_pool_undirty_space(dsl_pool_t *dp, int64_t space, uint64_t txg);\nvoid dsl_free(dsl_pool_t *dp, uint64_t txg, const blkptr_t *bpp);\nvoid dsl_free_sync(zio_t *pio, dsl_pool_t *dp, uint64_t txg,\n    const blkptr_t *bpp);\nvoid dsl_pool_create_origin(dsl_pool_t *dp, dmu_tx_t *tx);\nvoid dsl_pool_upgrade_clones(dsl_pool_t *dp, dmu_tx_t *tx);\nvoid dsl_pool_upgrade_dir_clones(dsl_pool_t *dp, dmu_tx_t *tx);\nvoid dsl_pool_mos_diduse_space(dsl_pool_t *dp,\n    int64_t used, int64_t comp, int64_t uncomp);\nvoid dsl_pool_ckpoint_diduse_space(dsl_pool_t *dp,\n    int64_t used, int64_t comp, int64_t uncomp);\nboolean_t dsl_pool_need_dirty_delay(dsl_pool_t *dp);\nvoid dsl_pool_config_enter(dsl_pool_t *dp, const void *tag);\nvoid dsl_pool_config_enter_prio(dsl_pool_t *dp, const void *tag);\nvoid dsl_pool_config_exit(dsl_pool_t *dp, const void *tag);\nboolean_t dsl_pool_config_held(dsl_pool_t *dp);\nboolean_t dsl_pool_config_held_writer(dsl_pool_t *dp);\n\ntaskq_t *dsl_pool_zrele_taskq(dsl_pool_t *dp);\ntaskq_t *dsl_pool_unlinked_drain_taskq(dsl_pool_t *dp);\n\nint dsl_pool_user_hold(dsl_pool_t *dp, uint64_t dsobj,\n    const char *tag, uint64_t now, dmu_tx_t *tx);\nint dsl_pool_user_release(dsl_pool_t *dp, uint64_t dsobj,\n    const char *tag, dmu_tx_t *tx);\nvoid dsl_pool_clean_tmp_userrefs(dsl_pool_t *dp);\nint dsl_pool_open_special_dir(dsl_pool_t *dp, const char *name, dsl_dir_t **);\nint dsl_pool_hold(const char *name, const void *tag, dsl_pool_t **dp);\nvoid dsl_pool_rele(dsl_pool_t *dp, const void *tag);\n\nvoid dsl_pool_create_obsolete_bpobj(dsl_pool_t *dp, dmu_tx_t *tx);\nvoid dsl_pool_destroy_obsolete_bpobj(dsl_pool_t *dp, dmu_tx_t *tx);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}