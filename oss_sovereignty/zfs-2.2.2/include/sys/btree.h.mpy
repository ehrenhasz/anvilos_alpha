{
  "module_name": "btree.h",
  "hash_id": "fe75bba0b877ff7d887d1ee0f6d1f114df24542aaf58e11f72090aa88471b149",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/btree.h",
  "human_readable_source": " \n \n\n#ifndef\t_BTREE_H\n#define\t_BTREE_H\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\n#include\t<sys/zfs_context.h>\n\n \n\n \n#define\tBTREE_CORE_ELEMS\t126\n#define\tBTREE_LEAF_SIZE\t\t4096\n\nextern kmem_cache_t *zfs_btree_leaf_cache;\n\ntypedef struct zfs_btree_hdr {\n\tstruct zfs_btree_core\t*bth_parent;\n\t \n\tuint32_t\t\tbth_first;\n\t \n\tuint32_t\t\tbth_count;\n} zfs_btree_hdr_t;\n\ntypedef struct zfs_btree_core {\n\tzfs_btree_hdr_t\tbtc_hdr;\n\tzfs_btree_hdr_t\t*btc_children[BTREE_CORE_ELEMS + 1];\n\tuint8_t\t\tbtc_elems[];\n} zfs_btree_core_t;\n\ntypedef struct zfs_btree_leaf {\n\tzfs_btree_hdr_t\tbtl_hdr;\n\tuint8_t\t\tbtl_elems[];\n} zfs_btree_leaf_t;\n\ntypedef struct zfs_btree_index {\n\tzfs_btree_hdr_t\t*bti_node;\n\tuint32_t\tbti_offset;\n\t \n\tboolean_t\tbti_before;\n} zfs_btree_index_t;\n\ntypedef struct btree zfs_btree_t;\ntypedef void * (*bt_find_in_buf_f) (zfs_btree_t *, uint8_t *, uint32_t,\n    const void *, zfs_btree_index_t *);\n\nstruct btree {\n\tint (*bt_compar) (const void *, const void *);\n\tbt_find_in_buf_f\tbt_find_in_buf;\n\tsize_t\t\t\tbt_elem_size;\n\tsize_t\t\t\tbt_leaf_size;\n\tuint32_t\t\tbt_leaf_cap;\n\tint32_t\t\t\tbt_height;\n\tuint64_t\t\tbt_num_elems;\n\tuint64_t\t\tbt_num_nodes;\n\tzfs_btree_hdr_t\t\t*bt_root;\n\tzfs_btree_leaf_t\t*bt_bulk;  \n};\n\n \n \n#define\tZFS_BTREE_FIND_IN_BUF_FUNC(NAME, T, COMP)\t\t\t\\\n_Pragma(\"GCC diagnostic push\")\t\t\t\t\t\t\\\n_Pragma(\"GCC diagnostic ignored \\\"-Wunknown-pragmas\\\"\")\t\t\t\\\nstatic void *\t\t\t\t\t\t\t\t\\\nNAME(zfs_btree_t *tree, uint8_t *buf, uint32_t nelems,\t\t\t\\\n    const void *value, zfs_btree_index_t *where)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tT *i = (T *)buf;\t\t\t\t\t\t\\\n\t(void) tree;\t\t\t\t\t\t\t\\\n\t_Pragma(\"GCC unroll 9\")\t\t\t\t\t\t\\\n\twhile (nelems > 1) {\t\t\t\t\t\t\\\n\t\tuint32_t half = nelems / 2;\t\t\t\t\\\n\t\tnelems -= half;\t\t\t\t\t\t\\\n\t\ti += (COMP(&i[half - 1], value) < 0) * half;\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tint comp = COMP(i, value);\t\t\t\t\t\\\n\twhere->bti_offset = (i - (T *)buf) + (comp < 0);\t\t\\\n\twhere->bti_before = (comp != 0);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tif (comp == 0) {\t\t\t\t\t\t\\\n\t\treturn (i);\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn (NULL);\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\n_Pragma(\"GCC diagnostic pop\")\n \n\n \nvoid zfs_btree_init(void);\nvoid zfs_btree_fini(void);\n\n \nvoid zfs_btree_create(zfs_btree_t *, int (*) (const void *, const void *),\n    bt_find_in_buf_f, size_t);\nvoid zfs_btree_create_custom(zfs_btree_t *, int (*)(const void *, const void *),\n    bt_find_in_buf_f, size_t, size_t);\n\n \nvoid *zfs_btree_find(zfs_btree_t *, const void *, zfs_btree_index_t *);\n\n \nvoid zfs_btree_add_idx(zfs_btree_t *, const void *, const zfs_btree_index_t *);\n\n \nvoid *zfs_btree_first(zfs_btree_t *, zfs_btree_index_t *);\nvoid *zfs_btree_last(zfs_btree_t *, zfs_btree_index_t *);\n\n \nvoid *zfs_btree_next(zfs_btree_t *, const zfs_btree_index_t *,\n    zfs_btree_index_t *);\nvoid *zfs_btree_prev(zfs_btree_t *, const zfs_btree_index_t *,\n    zfs_btree_index_t *);\n\n \nvoid *zfs_btree_get(zfs_btree_t *, zfs_btree_index_t *);\n\n \nvoid zfs_btree_add(zfs_btree_t *, const void *);\n\n \nvoid zfs_btree_remove(zfs_btree_t *, const void *);\n\n \nvoid zfs_btree_remove_idx(zfs_btree_t *, zfs_btree_index_t *);\n\n \nulong_t zfs_btree_numnodes(zfs_btree_t *);\n\n \nvoid *zfs_btree_destroy_nodes(zfs_btree_t *, zfs_btree_index_t **);\n\n \nvoid zfs_btree_clear(zfs_btree_t *);\n\n \nvoid zfs_btree_destroy(zfs_btree_t *tree);\n\n \nvoid zfs_btree_verify(zfs_btree_t *tree);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}