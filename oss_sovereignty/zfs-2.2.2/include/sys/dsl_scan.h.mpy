{
  "module_name": "dsl_scan.h",
  "hash_id": "2d1ddb62b0e2f439f01bcb6b8df7bf9640195f3866d00335ea519b050b7289a1",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/dsl_scan.h",
  "human_readable_source": " \n \n\n#ifndef\t_SYS_DSL_SCAN_H\n#define\t_SYS_DSL_SCAN_H\n\n#include <sys/zfs_context.h>\n#include <sys/zio.h>\n#include <sys/zap.h>\n#include <sys/ddt.h>\n#include <sys/bplist.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\nstruct objset;\nstruct dsl_dir;\nstruct dsl_dataset;\nstruct dsl_pool;\nstruct dmu_tx;\n\nextern int zfs_scan_suspend_progress;\n\n \ntypedef struct dsl_scan_phys {\n\tuint64_t scn_func;  \n\tuint64_t scn_state;  \n\tuint64_t scn_queue_obj;\n\tuint64_t scn_min_txg;\n\tuint64_t scn_max_txg;\n\tuint64_t scn_cur_min_txg;\n\tuint64_t scn_cur_max_txg;\n\tuint64_t scn_start_time;\n\tuint64_t scn_end_time;\n\tuint64_t scn_to_examine;  \n\tuint64_t scn_examined;  \n\tuint64_t scn_skipped;\t \n\tuint64_t scn_processed;\n\tuint64_t scn_errors;\t \n\tuint64_t scn_ddt_class_max;\n\tddt_bookmark_t scn_ddt_bookmark;\n\tzbookmark_phys_t scn_bookmark;\n\tuint64_t scn_flags;  \n} dsl_scan_phys_t;\n\n#define\tSCAN_PHYS_NUMINTS (sizeof (dsl_scan_phys_t) / sizeof (uint64_t))\n\ntypedef enum dsl_scan_flags {\n\tDSF_VISIT_DS_AGAIN = 1<<0,\n\tDSF_SCRUB_PAUSED = 1<<1,\n} dsl_scan_flags_t;\n\n#define\tDSL_SCAN_FLAGS_MASK (DSF_VISIT_DS_AGAIN)\n\ntypedef struct dsl_errorscrub_phys {\n\tuint64_t dep_func;  \n\tuint64_t dep_state;  \n\tuint64_t dep_cursor;  \n\tuint64_t dep_start_time;  \n\tuint64_t dep_end_time;  \n\tuint64_t dep_to_examine;  \n\tuint64_t dep_examined;  \n\tuint64_t dep_errors;\t \n\tuint64_t dep_paused_flags;  \n} dsl_errorscrub_phys_t;\n\n#define\tERRORSCRUB_PHYS_NUMINTS (sizeof (dsl_errorscrub_phys_t) \\\n\t/ sizeof (uint64_t))\n\n \ntypedef struct dsl_scan {\n\tstruct dsl_pool *scn_dp;\n\tuint64_t scn_restart_txg;\n\tuint64_t scn_done_txg;\n\tuint64_t scn_sync_start_time;\n\tuint64_t scn_issued_before_pass;\n\n\t \n\tboolean_t scn_is_bptree;\n\tboolean_t scn_async_destroying;\n\tboolean_t scn_async_stalled;\n\tuint64_t  scn_async_block_min_time_ms;\n\n\t \n\tboolean_t scn_is_sorted;\t \n\tboolean_t scn_clearing;\t\t \n\tboolean_t scn_checkpointing;\t \n\tboolean_t scn_suspending;\t \n\tuint64_t scn_last_checkpoint;\t \n\n\t \n\tzio_t *scn_zio_root;\t\t \n\ttaskq_t *scn_taskq;\t\t \n\n\t \n\tboolean_t scn_prefetch_stop;\t \n\tzbookmark_phys_t scn_prefetch_bookmark;\t \n\tavl_tree_t scn_prefetch_queue;\t \n\tuint64_t scn_maxinflight_bytes;  \n\n\t \n\tuint64_t scn_visited_this_txg;\t \n\tuint64_t scn_dedup_frees_this_txg;\t \n\tuint64_t scn_holes_this_txg;\n\tuint64_t scn_lt_min_this_txg;\n\tuint64_t scn_gt_max_this_txg;\n\tuint64_t scn_ddt_contained_this_txg;\n\tuint64_t scn_objsets_visited_this_txg;\n\tuint64_t scn_avg_seg_size_this_txg;\n\tuint64_t scn_segs_this_txg;\n\tuint64_t scn_avg_zio_size_this_txg;\n\tuint64_t scn_zios_this_txg;\n\n\t \n\tzap_cursor_t errorscrub_cursor;\n\t \n\tdsl_scan_phys_t scn_phys;\t \n\tdsl_scan_phys_t scn_phys_cached;\n\tavl_tree_t scn_queue;\t\t \n\tuint64_t scn_queues_pending;\t \n\t \n\tdsl_errorscrub_phys_t errorscrub_phys;\n} dsl_scan_t;\n\ntypedef struct dsl_scan_io_queue dsl_scan_io_queue_t;\n\nvoid scan_init(void);\nvoid scan_fini(void);\nint dsl_scan_init(struct dsl_pool *dp, uint64_t txg);\nint dsl_scan_setup_check(void *, dmu_tx_t *);\nvoid dsl_scan_setup_sync(void *, dmu_tx_t *);\nvoid dsl_scan_fini(struct dsl_pool *dp);\nvoid dsl_scan_sync(struct dsl_pool *, dmu_tx_t *);\nint dsl_scan_cancel(struct dsl_pool *);\nint dsl_scan(struct dsl_pool *, pool_scan_func_t);\nvoid dsl_scan_assess_vdev(struct dsl_pool *dp, vdev_t *vd);\nboolean_t dsl_scan_scrubbing(const struct dsl_pool *dp);\nboolean_t dsl_errorscrubbing(const struct dsl_pool *dp);\nboolean_t dsl_errorscrub_active(dsl_scan_t *scn);\nvoid dsl_scan_restart_resilver(struct dsl_pool *, uint64_t txg);\nint dsl_scrub_set_pause_resume(const struct dsl_pool *dp,\n    pool_scrub_cmd_t cmd);\nvoid dsl_errorscrub_sync(struct dsl_pool *, dmu_tx_t *);\nboolean_t dsl_scan_resilvering(struct dsl_pool *dp);\nboolean_t dsl_scan_resilver_scheduled(struct dsl_pool *dp);\nboolean_t dsl_dataset_unstable(struct dsl_dataset *ds);\nvoid dsl_scan_ddt_entry(dsl_scan_t *scn, enum zio_checksum checksum,\n    ddt_entry_t *dde, dmu_tx_t *tx);\nvoid dsl_scan_ds_destroyed(struct dsl_dataset *ds, struct dmu_tx *tx);\nvoid dsl_scan_ds_snapshotted(struct dsl_dataset *ds, struct dmu_tx *tx);\nvoid dsl_scan_ds_clone_swapped(struct dsl_dataset *ds1, struct dsl_dataset *ds2,\n    struct dmu_tx *tx);\nboolean_t dsl_scan_active(dsl_scan_t *scn);\nboolean_t dsl_scan_is_paused_scrub(const dsl_scan_t *scn);\nboolean_t dsl_errorscrub_is_paused(const dsl_scan_t *scn);\nvoid dsl_scan_freed(spa_t *spa, const blkptr_t *bp);\nvoid dsl_scan_io_queue_destroy(dsl_scan_io_queue_t *queue);\nvoid dsl_scan_io_queue_vdev_xfer(vdev_t *svd, vdev_t *tvd);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}