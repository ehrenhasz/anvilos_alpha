{
  "module_name": "zfs_acl.h",
  "hash_id": "9e002fceecafb9759b56baee0e1fb485035fefdfd6cb282adca36f89fc233063",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/zfs_acl.h",
  "human_readable_source": " \n \n\n#ifndef\t_SYS_FS_ZFS_ACL_H\n#define\t_SYS_FS_ZFS_ACL_H\n\n#ifdef _KERNEL\n#include <sys/isa_defs.h>\n#include <sys/types32.h>\n#include <sys/xvattr.h>\n#endif\n#include <sys/acl.h>\n#include <sys/dmu.h>\n#include <sys/zfs_fuid.h>\n#include <sys/sa.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\nstruct znode_phys;\n\n#define\tACE_SLOT_CNT\t6\n#define\tZFS_ACL_VERSION_INITIAL 0ULL\n#define\tZFS_ACL_VERSION_FUID\t1ULL\n#define\tZFS_ACL_VERSION\t\tZFS_ACL_VERSION_FUID\n\n \n\n \ntypedef struct zfs_ace_hdr {\n\tuint16_t z_type;\n\tuint16_t z_flags;\n\tuint32_t z_access_mask;\n} zfs_ace_hdr_t;\n\ntypedef zfs_ace_hdr_t zfs_ace_abstract_t;\n\n \ntypedef struct zfs_ace {\n\tzfs_ace_hdr_t\tz_hdr;\n\tuint64_t\tz_fuid;\n} zfs_ace_t;\n\n \n\ntypedef struct zfs_object_ace {\n\tzfs_ace_t\tz_ace;\n\tuint8_t\t\tz_object_type[16];  \n\tuint8_t\t\tz_inherit_type[16];  \n} zfs_object_ace_t;\n\ntypedef struct zfs_oldace {\n\tuint32_t\tz_fuid;\t\t \n\tuint32_t\tz_access_mask;   \n\tuint16_t\tz_flags;\t \n\tuint16_t\tz_type;\t\t \n} zfs_oldace_t;\n\ntypedef struct zfs_acl_phys_v0 {\n\tuint64_t\tz_acl_extern_obj;\t \n\tuint32_t\tz_acl_count;\t\t \n\tuint16_t\tz_acl_version;\t\t \n\tuint16_t\tz_acl_pad;\t\t \n\tzfs_oldace_t\tz_ace_data[ACE_SLOT_CNT];  \n} zfs_acl_phys_v0_t;\n\n#define\tZFS_ACE_SPACE\t(sizeof (zfs_oldace_t) * ACE_SLOT_CNT)\n\n \n#define\tZFS_ACL_COUNT_SIZE\t(sizeof (uint16_t))\n\ntypedef struct zfs_acl_phys {\n\tuint64_t\tz_acl_extern_obj;\t   \n\tuint32_t\tz_acl_size;\t\t   \n\tuint16_t\tz_acl_version;\t\t   \n\tuint16_t\tz_acl_count;\t\t   \n\tuint8_t\tz_ace_data[ZFS_ACE_SPACE];  \n} zfs_acl_phys_t;\n\ntypedef struct acl_ops {\n\tuint32_t\t(*ace_mask_get) (void *acep);  \n\tvoid \t\t(*ace_mask_set) (void *acep,\n\t\t\t    uint32_t mask);  \n\tuint16_t\t(*ace_flags_get) (void *acep);\t \n\tvoid\t\t(*ace_flags_set) (void *acep,\n\t\t\t    uint16_t flags);  \n\tuint16_t\t(*ace_type_get)(void *acep);  \n\tvoid\t\t(*ace_type_set)(void *acep,\n\t\t\t    uint16_t type);  \n\tuint64_t\t(*ace_who_get)(void *acep);  \n\tvoid\t\t(*ace_who_set)(void *acep,\n\t\t\t    uint64_t who);  \n\tsize_t\t\t(*ace_size)(void *acep);  \n\tsize_t\t\t(*ace_abstract_size)(void);  \n\tint\t\t(*ace_mask_off)(void);  \n\t \n\tint\t\t(*ace_data)(void *acep, void **datap);\n} acl_ops_t;\n\n \ntypedef struct zfs_acl_node {\n\tlist_node_t\tz_next;\t\t \n\tvoid\t\t*z_acldata;\t \n\tvoid\t\t*z_allocdata;\t \n\tsize_t\t\tz_allocsize;\t \n\tsize_t\t\tz_size;\t\t \n\tuint64_t\tz_ace_count;\t \n\tint\t\tz_ace_idx;\t \n} zfs_acl_node_t;\n\ntypedef struct zfs_acl {\n\tuint64_t\tz_acl_count;\t \n\tsize_t\t\tz_acl_bytes;\t \n\tuint_t\t\tz_version;\t \n\tvoid\t\t*z_next_ace;\t \n\tuint64_t\tz_hints;\t \n\tzfs_acl_node_t\t*z_curr_node;\t \n\tlist_t\t\tz_acl;\t\t \n\tconst acl_ops_t\t*z_ops;\t\t \n} zfs_acl_t;\n\ntypedef struct acl_locator_cb {\n\tzfs_acl_t *cb_aclp;\n\tzfs_acl_node_t *cb_acl_node;\n} zfs_acl_locator_cb_t;\n\n#define\tACL_DATA_ALLOCED\t0x1\n#define\tZFS_ACL_SIZE(aclcnt)\t(sizeof (ace_t) * (aclcnt))\n\nstruct zfs_fuid_info;\n\ntypedef struct zfs_acl_ids {\n\tuint64_t\t\tz_fuid;\t\t \n\tuint64_t\t\tz_fgid;\t\t \n\tuint64_t\t\tz_mode;\t\t \n\tzfs_acl_t\t\t*z_aclp;\t \n\tstruct zfs_fuid_info \t*z_fuidp;\t \n} zfs_acl_ids_t;\n\n \n\n#define\tZFS_ACL_DISCARD\t\t0\n#define\tZFS_ACL_NOALLOW\t\t1\n#define\tZFS_ACL_GROUPMASK\t2\n#define\tZFS_ACL_PASSTHROUGH\t3\n#define\tZFS_ACL_RESTRICTED\t4\n#define\tZFS_ACL_PASSTHROUGH_X\t5\n\nstruct znode;\nstruct zfsvfs;\n\n#ifdef _KERNEL\nint zfs_acl_ids_create(struct znode *, int, vattr_t *,\n    cred_t *, vsecattr_t *, zfs_acl_ids_t *, zidmap_t *);\nvoid zfs_acl_ids_free(zfs_acl_ids_t *);\nboolean_t zfs_acl_ids_overquota(struct zfsvfs *, zfs_acl_ids_t *, uint64_t);\nint zfs_getacl(struct znode *, vsecattr_t *, boolean_t, cred_t *);\nint zfs_setacl(struct znode *, vsecattr_t *, boolean_t, cred_t *);\nvoid zfs_acl_rele(void *);\nvoid zfs_oldace_byteswap(ace_t *, int);\nvoid zfs_ace_byteswap(void *, size_t, boolean_t);\nextern boolean_t zfs_has_access(struct znode *zp, cred_t *cr);\nextern int zfs_zaccess(struct znode *, int, int, boolean_t, cred_t *,\n    zidmap_t *);\nint zfs_fastaccesschk_execute(struct znode *, cred_t *);\nextern int zfs_zaccess_rwx(struct znode *, mode_t, int, cred_t *, zidmap_t *);\nextern int zfs_zaccess_unix(void *, int, cred_t *);\nextern int zfs_acl_access(struct znode *, int, cred_t *);\nint zfs_acl_chmod_setattr(struct znode *, zfs_acl_t **, uint64_t);\nint zfs_zaccess_delete(struct znode *, struct znode *, cred_t *, zidmap_t *);\nint zfs_zaccess_rename(struct znode *, struct znode *,\n    struct znode *, struct znode *, cred_t *cr, zidmap_t *mnt_ns);\nvoid zfs_acl_free(zfs_acl_t *);\nint zfs_vsec_2_aclp(struct zfsvfs *, umode_t, vsecattr_t *, cred_t *,\n    struct zfs_fuid_info **, zfs_acl_t **);\nint zfs_aclset_common(struct znode *, zfs_acl_t *, cred_t *, dmu_tx_t *);\nuint64_t zfs_external_acl(struct znode *);\nint zfs_znode_acl_version(struct znode *);\nint zfs_acl_size(struct znode *, int *);\nzfs_acl_t *zfs_acl_alloc(int);\nzfs_acl_node_t *zfs_acl_node_alloc(size_t);\nvoid zfs_acl_xform(struct znode *, zfs_acl_t *, cred_t *);\nvoid zfs_acl_data_locator(void **, uint32_t *, uint32_t, boolean_t, void *);\nuint64_t zfs_mode_compute(uint64_t, zfs_acl_t *,\n    uint64_t *, uint64_t, uint64_t);\nint zfs_acl_node_read(struct znode *, boolean_t, zfs_acl_t **, boolean_t);\nint zfs_acl_chown_setattr(struct znode *);\n\n#endif\n\n#ifdef\t__cplusplus\n}\n#endif\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}