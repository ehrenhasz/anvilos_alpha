{
  "module_name": "vdev_indirect_mapping.h",
  "hash_id": "a2cd7fb05be680f84ae4c7700e20d11a49884374db7d2bd6ba8e6c7221cb2eca",
  "original_prompt": "Ingested from zfs-2.2.2/include/sys/vdev_indirect_mapping.h",
  "human_readable_source": " \n\n \n\n#ifndef\t_SYS_VDEV_INDIRECT_MAPPING_H\n#define\t_SYS_VDEV_INDIRECT_MAPPING_H\n\n#include <sys/dmu.h>\n#include <sys/list.h>\n#include <sys/spa.h>\n#include <sys/space_map.h>\n\n#ifdef\t__cplusplus\nextern \"C\" {\n#endif\n\ntypedef struct vdev_indirect_mapping_entry_phys {\n\t \n\tuint64_t vimep_src;\n\n\t \n\tdva_t\tvimep_dst;\n} vdev_indirect_mapping_entry_phys_t;\n\n#define\tDVA_MAPPING_GET_SRC_OFFSET(vimep)\t\\\n\tBF64_GET_SB((vimep)->vimep_src, 0, 63, SPA_MINBLOCKSHIFT, 0)\n#define\tDVA_MAPPING_SET_SRC_OFFSET(vimep, x)\t\\\n\tBF64_SET_SB((vimep)->vimep_src, 0, 63, SPA_MINBLOCKSHIFT, 0, x)\n\ntypedef struct vdev_indirect_mapping_entry {\n\tvdev_indirect_mapping_entry_phys_t\tvime_mapping;\n\tuint32_t\t\t\t\tvime_obsolete_count;\n\tlist_node_t\t\t\t\tvime_node;\n} vdev_indirect_mapping_entry_t;\n\n \ntypedef struct vdev_indirect_mapping_phys {\n\tuint64_t\tvimp_max_offset;\n\tuint64_t\tvimp_bytes_mapped;\n\tuint64_t\tvimp_num_entries;  \n\n\t \n\tuint64_t\tvimp_counts_object;\n} vdev_indirect_mapping_phys_t;\n\n#define\tVDEV_INDIRECT_MAPPING_SIZE_V0\t(3 * sizeof (uint64_t))\n\ntypedef struct vdev_indirect_mapping {\n\tuint64_t\tvim_object;\n\tboolean_t\tvim_havecounts;\n\n\t \n\tvdev_indirect_mapping_entry_phys_t *vim_entries;\n\n\tobjset_t\t*vim_objset;\n\n\tdmu_buf_t\t*vim_dbuf;\n\tvdev_indirect_mapping_phys_t\t*vim_phys;\n} vdev_indirect_mapping_t;\n\nextern vdev_indirect_mapping_t *vdev_indirect_mapping_open(objset_t *os,\n    uint64_t object);\nextern void vdev_indirect_mapping_close(vdev_indirect_mapping_t *vim);\nextern uint64_t vdev_indirect_mapping_alloc(objset_t *os, dmu_tx_t *tx);\nextern void vdev_indirect_mapping_free(objset_t *os, uint64_t obj,\n    dmu_tx_t *tx);\n\nextern uint64_t vdev_indirect_mapping_num_entries(vdev_indirect_mapping_t *vim);\nextern uint64_t vdev_indirect_mapping_max_offset(vdev_indirect_mapping_t *vim);\nextern uint64_t vdev_indirect_mapping_object(vdev_indirect_mapping_t *vim);\nextern uint64_t vdev_indirect_mapping_bytes_mapped(\n    vdev_indirect_mapping_t *vim);\nextern uint64_t vdev_indirect_mapping_size(vdev_indirect_mapping_t *vim);\n\n \nextern void vdev_indirect_mapping_add_entries(vdev_indirect_mapping_t *vim,\n    list_t *vime_list, dmu_tx_t *tx);\n\nextern vdev_indirect_mapping_entry_phys_t *\n    vdev_indirect_mapping_entry_for_offset(vdev_indirect_mapping_t *vim,\n    uint64_t offset);\n\nextern vdev_indirect_mapping_entry_phys_t *\n    vdev_indirect_mapping_entry_for_offset_or_next(vdev_indirect_mapping_t *vim,\n    uint64_t offset);\n\nextern uint32_t *vdev_indirect_mapping_load_obsolete_counts(\n    vdev_indirect_mapping_t *vim);\nextern void vdev_indirect_mapping_load_obsolete_spacemap(\n    vdev_indirect_mapping_t *vim,\n    uint32_t *counts, space_map_t *obsolete_space_sm);\nextern void vdev_indirect_mapping_increment_obsolete_count(\n    vdev_indirect_mapping_t *vim,\n    uint64_t offset, uint64_t asize, uint32_t *counts);\nextern void vdev_indirect_mapping_free_obsolete_counts(\n    vdev_indirect_mapping_t *vim, uint32_t *counts);\n\n#ifdef\t__cplusplus\n}\n#endif\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}