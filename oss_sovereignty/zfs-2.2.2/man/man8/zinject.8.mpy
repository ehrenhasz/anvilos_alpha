{
  "module_name": "zinject.8",
  "hash_id": "be32c3b60bda3ffe7bd17848ba5e35852f7a2a4232f1ecbe3f856324d68e136f",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zinject.8",
  "human_readable_source": ".\\\"\n.\\\" CDDL HEADER START\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License (the \"License\").\n.\\\" You may not use this file except in compliance with the License.\n.\\\"\n.\\\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE\n.\\\" or https://opensource.org/licenses/CDDL-1.0.\n.\\\" See the License for the specific language governing permissions\n.\\\" and limitations under the License.\n.\\\"\n.\\\" When distributing Covered Code, include this CDDL HEADER in each\n.\\\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.\n.\\\" If applicable, add the following below this CDDL HEADER, with the\n.\\\" fields enclosed by brackets \"[]\" replaced with your own identifying\n.\\\" information: Portions Copyright [yyyy] [name of copyright owner]\n.\\\"\n.\\\" CDDL HEADER END\n.\\\"\n.\\\" Copyright 2013 Darik Horn <dajhorn@vanadac.com>. All rights reserved.\n.\\\"\n.\\\" lint-ok: WARNING: sections out of conventional order: Sh SYNOPSIS\n.\\\"\n.Dd May 26, 2021\n.Dt ZINJECT 8\n.Os\n.\n.Sh NAME\n.Nm zinject\n.Nd ZFS Fault Injector\n.Sh DESCRIPTION\n.Nm\ncreates artificial problems in a ZFS pool by simulating data corruption\nor device failures.\nThis program is dangerous.\n.\n.Sh SYNOPSIS\n.Bl -tag -width Ds\n.It Xo\n.Nm zinject\n.Xc\nList injection records.\n.\n.It Xo\n.Nm zinject\n.Fl b Ar objset : Ns Ar object : Ns Ar level : Ns Ar start : Ns Ar end\n.Op Fl f Ar frequency\n.Fl amu\n.Op pool\n.Xc\nForce an error into the pool at a bookmark.\n.\n.It Xo\n.Nm zinject\n.Fl c Ar id Ns | Ns Sy all\n.Xc\nCancel injection records.\n.\n.It Xo\n.Nm zinject\n.Fl d Ar vdev\n.Fl A Sy degrade Ns | Ns Sy fault\n.Ar pool\n.Xc\nForce a vdev into the DEGRADED or FAULTED state.\n.\n.It Xo\n.Nm zinject\n.Fl d Ar vdev\n.Fl D Ar latency : Ns Ar lanes\n.Ar pool\n.Xc\nAdd an artificial delay to I/O requests on a particular\ndevice, such that the requests take a minimum of\n.Ar latency\nmilliseconds to complete.\nEach delay has an associated number of\n.Ar lanes\nwhich defines the number of concurrent\nI/O requests that can be processed.\n.Pp\nFor example, with a single lane delay of 10 ms\n.No (\\& Ns Fl D Ar 10 : Ns Ar 1 ) ,\nthe device will only be able to service a single I/O request\nat a time with each request taking 10 ms to complete.\nSo, if only a single request is submitted every 10 ms, the\naverage latency will be 10 ms; but if more than one request\nis submitted every 10 ms, the average latency will be more\nthan 10 ms.\n.Pp\nSimilarly, if a delay of 10 ms is specified to have two\nlanes\n.No (\\& Ns Fl D Ar 10 : Ns Ar 2 ) ,\nthen the device will be able to service\ntwo requests at a time, each with a minimum latency of 10 ms.\nSo, if two requests are submitted every 10 ms, then\nthe average latency will be 10 ms; but if more than two\nrequests are submitted every 10 ms, the average latency\nwill be more than 10 ms.\n.Pp\nAlso note, these delays are additive.\nSo two invocations of\n.Fl D Ar 10 : Ns Ar 1\nare roughly equivalent to a single invocation of\n.Fl D Ar 10 : Ns Ar 2 .\nThis also means, that one can specify multiple\nlanes with differing target latencies.\nFor example, an invocation of\n.Fl D Ar 10 : Ns Ar 1\nfollowed by\n.Fl D Ar 25 : Ns Ar 2\nwill create 3 lanes on the device: one lane with a latency\nof 10 ms and two lanes with a 25 ms latency.\n.\n.It Xo\n.Nm zinject\n.Fl d Ar vdev\n.Op Fl e Ar device_error\n.Op Fl L Ar label_error\n.Op Fl T Ar failure\n.Op Fl f Ar frequency\n.Op Fl F\n.Ar pool\n.Xc\nForce a vdev error.\n.\n.It Xo\n.Nm zinject\n.Fl I\n.Op Fl s Ar seconds Ns | Ns Fl g Ar txgs\n.Ar pool\n.Xc\nSimulate a hardware failure that fails to honor a cache flush.\n.\n.It Xo\n.Nm zinject\n.Fl p Ar function\n.Ar pool\n.Xc\nPanic inside the specified function.\n.\n.It Xo\n.Nm zinject\n.Fl t Sy data\n.Fl C Ar dvas\n.Op Fl e Ar device_error\n.Op Fl f Ar frequency\n.Op Fl l Ar level\n.Op Fl r Ar range\n.Op Fl amq\n.Ar path\n.Xc\nForce an error into the contents of a file.\n.\n.It Xo\n.Nm zinject\n.Fl t Sy dnode\n.Fl C Ar dvas\n.Op Fl e Ar device_error\n.Op Fl f Ar frequency\n.Op Fl l Ar level\n.Op Fl amq\n.Ar path\n.Xc\nForce an error into the metadnode for a file or directory.\n.\n.It Xo\n.Nm zinject\n.Fl t Ar mos_type\n.Fl C Ar dvas\n.Op Fl e Ar device_error\n.Op Fl f Ar frequency\n.Op Fl l Ar level\n.Op Fl r Ar range\n.Op Fl amqu\n.Ar pool\n.Xc\nForce an error into the MOS of a pool.\n.El\n.Sh OPTIONS\n.Bl -tag -width \"-C dvas\"\n.It Fl a\nFlush the ARC before injection.\n.It Fl b Ar objset : Ns Ar object : Ns Ar level : Ns Ar start : Ns Ar end\nForce an error into the pool at this bookmark tuple.\nEach number is in hexadecimal, and only one block can be specified.\n.It Fl C Ar dvas\nInject the given error only into specific DVAs.\nThe mask should be specified as a list of 0-indexed DVAs separated by commas\n.No (e.g . Ar 0,2 Ns No ).\nThis option is not applicable to logical data errors such as\n.Sy decompress\nand\n.Sy decrypt .\n.It Fl d Ar vdev\nA vdev specified by path or GUID.\n.It Fl e Ar device_error\nSpecify\n.Bl -tag -compact -width \"decompress\"\n.It Sy checksum\nfor an ECKSUM error,\n.It Sy decompress\nfor a data decompression error,\n.It Sy decrypt\nfor a data decryption error,\n.It Sy corrupt\nto flip a bit in the data after a read,\n.It Sy dtl\nfor an ECHILD error,\n.It Sy io\nfor an EIO error where reopening the device will succeed, or\n.It Sy nxio\nfor an ENXIO error where reopening the device will fail.\n.El\n.Pp\nFor EIO and ENXIO, the \"failed\" reads or writes still occur.\nThe probe simply sets the error value reported by the I/O pipeline\nso it appears the read or write failed.\nDecryption errors only currently work with file data.\n.It Fl f Ar frequency\nOnly inject errors a fraction of the time.\nExpressed as a real number percentage between\n.Sy 0.0001\nand\n.Sy 100 .\n.It Fl F\nFail faster.\nDo fewer checks.\n.It Fl f Ar txgs\nRun for this many transaction groups before reporting failure.\n.It Fl h\nPrint the usage message.\n.It Fl l Ar level\nInject an error at a particular block level.\nThe default is\n.Sy 0 .\n.It Fl L Ar label_error\nSet the label error region to one of\n.Sy nvlist ,\n.Sy pad1 ,\n.Sy pad2 ,\nor\n.Sy uber .\n.It Fl m\nAutomatically remount the underlying filesystem.\n.It Fl q\nQuiet mode.\nOnly print the handler number added.\n.It Fl r Ar range\nInject an error over a particular logical range of an object, which\nwill be translated to the appropriate blkid range according to the\nobject's properties.\n.It Fl s Ar seconds\nRun for this many seconds before reporting failure.\n.It Fl T Ar failure\nSet the failure type to one of\n.Sy all ,\n.Sy claim ,\n.Sy free ,\n.Sy read ,\nor\n.Sy write .\n.It Fl t Ar mos_type\nSet this to\n.Bl -tag -compact -width \"spacemap\"\n.It Sy mos\nfor any data in the MOS,\n.It Sy mosdir\nfor an object directory,\n.It Sy config\nfor the pool configuration,\n.It Sy bpobj\nfor the block pointer list,\n.It Sy spacemap\nfor the space map,\n.It Sy metaslab\nfor the metaslab, or\n.It Sy errlog\nfor the persistent error log.\n.El\n.It Fl u\nUnload the pool after injection.\n.El\n.\n.Sh ENVIRONMENT VARIABLES\n.Bl -tag -width \"ZF\"\n.It Ev ZFS_HOSTID\nRun\n.Nm\nin debug mode.\n.El\n.\n.Sh SEE ALSO\n.Xr zfs 8 ,\n.Xr zpool 8\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}