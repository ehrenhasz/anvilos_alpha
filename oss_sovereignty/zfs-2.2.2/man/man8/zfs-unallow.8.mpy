{
  "module_name": "zfs-unallow.8",
  "hash_id": "48b1f62f6e202c27d3a9dfe7eb50f3fcdd74224aebc66c09c3cd709c4345ca40",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zfs-unallow.8",
  "human_readable_source": ".\\\"\n.\\\" CDDL HEADER START\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License (the \"License\").\n.\\\" You may not use this file except in compliance with the License.\n.\\\"\n.\\\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE\n.\\\" or https://opensource.org/licenses/CDDL-1.0.\n.\\\" See the License for the specific language governing permissions\n.\\\" and limitations under the License.\n.\\\"\n.\\\" When distributing Covered Code, include this CDDL HEADER in each\n.\\\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.\n.\\\" If applicable, add the following below this CDDL HEADER, with the\n.\\\" fields enclosed by brackets \"[]\" replaced with your own identifying\n.\\\" information: Portions Copyright [yyyy] [name of copyright owner]\n.\\\"\n.\\\" CDDL HEADER END\n.\\\"\n.\\\" Copyright (c) 2009 Sun Microsystems, Inc. All Rights Reserved.\n.\\\" Copyright 2011 Joshua M. Clulow <josh@sysmgr.org>\n.\\\" Copyright (c) 2011, 2019 by Delphix. All rights reserved.\n.\\\" Copyright (c) 2013 by Saso Kiselkov. All rights reserved.\n.\\\" Copyright (c) 2014, Joyent, Inc. All rights reserved.\n.\\\" Copyright (c) 2014 by Adam Stevko. All rights reserved.\n.\\\" Copyright (c) 2014 Integros [integros.com]\n.\\\" Copyright 2019 Richard Laager. All rights reserved.\n.\\\" Copyright 2018 Nexenta Systems, Inc.\n.\\\" Copyright 2019 Joyent, Inc.\n.\\\"\n.Dd March 16, 2022\n.Dt ZFS-ALLOW 8\n.Os\n.\n.Sh NAME\n.Nm zfs-allow\n.Nd delegate ZFS administration permissions to unprivileged users\n.Sh SYNOPSIS\n.Nm zfs\n.Cm allow\n.Op Fl dglu\n.Ar user Ns | Ns Ar group Ns Oo , Ns Ar user Ns | Ns Ar group Oc Ns \u2026\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm allow\n.Op Fl dl\n.Fl e Ns | Ns Sy everyone\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm allow\n.Fl c\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm allow\n.Fl s No @ Ns Ar setname\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm unallow\n.Op Fl dglru\n.Ar user Ns | Ns Ar group Ns Oo , Ns Ar user Ns | Ns Ar group Oc Ns \u2026\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm unallow\n.Op Fl dlr\n.Fl e Ns | Ns Sy everyone\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm unallow\n.Op Fl r\n.Fl c\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Nm zfs\n.Cm unallow\n.Op Fl r\n.Fl s No @ Ns Ar setname\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.\n.Sh DESCRIPTION\n.Bl -tag -width \"\"\n.It Xo\n.Nm zfs\n.Cm allow\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nDisplays permissions that have been delegated on the specified filesystem or\nvolume.\nSee the other forms of\n.Nm zfs Cm allow\nfor more information.\n.Pp\nDelegations are supported under Linux with the exception of\n.Sy mount ,\n.Sy unmount ,\n.Sy mountpoint ,\n.Sy canmount ,\n.Sy rename ,\nand\n.Sy share .\nThese permissions cannot be delegated because the Linux\n.Xr mount 8\ncommand restricts modifications of the global namespace to the root user.\n.It Xo\n.Nm zfs\n.Cm allow\n.Op Fl dglu\n.Ar user Ns | Ns Ar group Ns Oo , Ns Ar user Ns | Ns Ar group Oc Ns \u2026\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Xc\n.It Xo\n.Nm zfs\n.Cm allow\n.Op Fl dl\n.Fl e Ns | Ns Sy everyone\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nDelegates ZFS administration permission for the file systems to non-privileged\nusers.\n.Bl -tag -width \"-d\"\n.It Fl d\nAllow only for the descendent file systems.\n.It Fl e Ns | Ns Sy everyone\nSpecifies that the permissions be delegated to everyone.\n.It Fl g Ar group Ns Oo , Ns Ar group Oc Ns \u2026\nExplicitly specify that permissions are delegated to the group.\n.It Fl l\nAllow\n.Qq locally\nonly for the specified file system.\n.It Fl u Ar user Ns Oo , Ns Ar user Oc Ns \u2026\nExplicitly specify that permissions are delegated to the user.\n.It Ar user Ns | Ns Ar group Ns Oo , Ns Ar user Ns | Ns Ar group Oc Ns \u2026\nSpecifies to whom the permissions are delegated.\nMultiple entities can be specified as a comma-separated list.\nIf neither of the\n.Fl gu\noptions are specified, then the argument is interpreted preferentially as the\nkeyword\n.Sy everyone ,\nthen as a user name, and lastly as a group name.\nTo specify a user or group named\n.Qq everyone ,\nuse the\n.Fl g\nor\n.Fl u\noptions.\nTo specify a group with the same name as a user, use the\n.Fl g\noptions.\n.It Xo\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Xc\nThe permissions to delegate.\nMultiple permissions may be specified as a comma-separated list.\nPermission names are the same as ZFS subcommand and property names.\nSee the property list below.\nProperty set names, which begin with\n.Sy @ ,\nmay be specified.\nSee the\n.Fl s\nform below for details.\n.El\n.Pp\nIf neither of the\n.Fl dl\noptions are specified, or both are, then the permissions are allowed for the\nfile system or volume, and all of its descendents.\n.Pp\nPermissions are generally the ability to use a ZFS subcommand or change a ZFS\nproperty.\nThe following permissions are available:\n.TS\nl l l .\nNAME\tTYPE\tNOTES\n_\t_\t_\nallow\tsubcommand\tMust also have the permission that is being allowed\nbookmark\tsubcommand\nclone\tsubcommand\tMust also have the \\fBcreate\\fR ability and \\fBmount\\fR ability in the origin file system\ncreate\tsubcommand\tMust also have the \\fBmount\\fR ability. Must also have the \\fBrefreservation\\fR ability to create a non-sparse volume.\ndestroy\tsubcommand\tMust also have the \\fBmount\\fR ability\ndiff\tsubcommand\tAllows lookup of paths within a dataset given an object number, and the ability to create snapshots necessary to \\fBzfs diff\\fR.\nhold\tsubcommand\tAllows adding a user hold to a snapshot\nload-key\tsubcommand\tAllows loading and unloading of encryption key (see \\fBzfs load-key\\fR and \\fBzfs unload-key\\fR).\nchange-key\tsubcommand\tAllows changing an encryption key via \\fBzfs change-key\\fR.\nmount\tsubcommand\tAllows mounting/umounting ZFS datasets\npromote\tsubcommand\tMust also have the \\fBmount\\fR and \\fBpromote\\fR ability in the origin file system\nreceive\tsubcommand\tMust also have the \\fBmount\\fR and \\fBcreate\\fR ability\nrelease\tsubcommand\tAllows releasing a user hold which might destroy the snapshot\nrename\tsubcommand\tMust also have the \\fBmount\\fR and \\fBcreate\\fR ability in the new parent\nrollback\tsubcommand\tMust also have the \\fBmount\\fR ability\nsend\tsubcommand\nshare\tsubcommand\tAllows sharing file systems over NFS or SMB protocols\nsnapshot\tsubcommand\tMust also have the \\fBmount\\fR ability\n\ngroupquota\tother\tAllows accessing any \\fBgroupquota@\\fI\u2026\\fR property\ngroupobjquota\tother\tAllows accessing any \\fBgroupobjquota@\\fI\u2026\\fR property\ngroupused\tother\tAllows reading any \\fBgroupused@\\fI\u2026\\fR property\ngroupobjused\tother\tAllows reading any \\fBgroupobjused@\\fI\u2026\\fR property\nuserprop\tother\tAllows changing any user property\nuserquota\tother\tAllows accessing any \\fBuserquota@\\fI\u2026\\fR property\nuserobjquota\tother\tAllows accessing any \\fBuserobjquota@\\fI\u2026\\fR property\nuserused\tother\tAllows reading any \\fBuserused@\\fI\u2026\\fR property\nuserobjused\tother\tAllows reading any \\fBuserobjused@\\fI\u2026\\fR property\nprojectobjquota\tother\tAllows accessing any \\fBprojectobjquota@\\fI\u2026\\fR property\nprojectquota\tother\tAllows accessing any \\fBprojectquota@\\fI\u2026\\fR property\nprojectobjused\tother\tAllows reading any \\fBprojectobjused@\\fI\u2026\\fR property\nprojectused\tother\tAllows reading any \\fBprojectused@\\fI\u2026\\fR property\n\naclinherit\tproperty\naclmode\tproperty\nacltype\tproperty\natime\tproperty\ncanmount\tproperty\ncasesensitivity\tproperty\nchecksum\tproperty\ncompression\tproperty\ncontext\tproperty\ncopies\tproperty\ndedup\tproperty\ndefcontext\tproperty\ndevices\tproperty\ndnodesize\tproperty\nencryption\tproperty\nexec\tproperty\nfilesystem_limit\tproperty\nfscontext\tproperty\nkeyformat\tproperty\nkeylocation\tproperty\nlogbias\tproperty\nmlslabel\tproperty\nmountpoint\tproperty\nnbmand\tproperty\nnormalization\tproperty\noverlay\tproperty\npbkdf2iters\tproperty\nprimarycache\tproperty\nquota\tproperty\nreadonly\tproperty\nrecordsize\tproperty\nredundant_metadata\tproperty\nrefquota\tproperty\nrefreservation\tproperty\nrelatime\tproperty\nreservation\tproperty\nrootcontext\tproperty\nsecondarycache\tproperty\nsetuid\tproperty\nsharenfs\tproperty\nsharesmb\tproperty\nsnapdev\tproperty\nsnapdir\tproperty\nsnapshot_limit\tproperty\nspecial_small_blocks\tproperty\nsync\tproperty\nutf8only\tproperty\nversion\tproperty\nvolblocksize\tproperty\nvolmode\tproperty\nvolsize\tproperty\nvscan\tproperty\nxattr\tproperty\nzoned\tproperty\n.TE\n.It Xo\n.Nm zfs\n.Cm allow\n.Fl c\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nSets\n.Qq create time\npermissions.\nThese permissions are granted\n.Pq locally\nto the creator of any newly-created descendent file system.\n.It Xo\n.Nm zfs\n.Cm allow\n.Fl s No @ Ns Ar setname\n.Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nDefines or adds permissions to a permission set.\nThe set can be used by other\n.Nm zfs Cm allow\ncommands for the specified file system and its descendents.\nSets are evaluated dynamically, so changes to a set are immediately reflected.\nPermission sets follow the same naming restrictions as ZFS file systems, but the\nname must begin with\n.Sy @ ,\nand can be no more than 64 characters long.\n.It Xo\n.Nm zfs\n.Cm unallow\n.Op Fl dglru\n.Ar user Ns | Ns Ar group Ns Oo , Ns Ar user Ns | Ns Ar group Oc Ns \u2026\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Xc\n.It Xo\n.Nm zfs\n.Cm unallow\n.Op Fl dlr\n.Fl e Ns | Ns Sy everyone\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Xc\n.It Xo\n.Nm zfs\n.Cm unallow\n.Op Fl r\n.Fl c\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nRemoves permissions that were granted with the\n.Nm zfs Cm allow\ncommand.\nNo permissions are explicitly denied, so other permissions granted are still in\neffect.\nFor example, if the permission is granted by an ancestor.\nIf no permissions are specified, then all permissions for the specified\n.Ar user ,\n.Ar group ,\nor\n.Sy everyone\nare removed.\nSpecifying\n.Sy everyone\n.Po or using the\n.Fl e\noption\n.Pc\nonly removes the permissions that were granted to everyone, not all permissions\nfor every user and group.\nSee the\n.Nm zfs Cm allow\ncommand for a description of the\n.Fl ldugec\noptions.\n.Bl -tag -width \"-r\"\n.It Fl r\nRecursively remove the permissions from this file system and all descendents.\n.El\n.It Xo\n.Nm zfs\n.Cm unallow\n.Op Fl r\n.Fl s No @ Ns Ar setname\n.Oo Ar perm Ns | Ns @ Ns Ar setname Ns Oo , Ns Ar perm Ns | Ns @ Ns\n.Ar setname Oc Ns \u2026 Oc\n.Ar filesystem Ns | Ns Ar volume\n.Xc\nRemoves permissions from a permission set.\nIf no permissions are specified, then all permissions are removed, thus removing\nthe set entirely.\n.El\n.\n.Sh EXAMPLES\n.\\\" These are, respectively, examples 17, 18, 19, 20 from zfs.8\n.\\\" Make sure to update them bidirectionally\n.Ss Example 1 : No Delegating ZFS Administration Permissions on a ZFS Dataset\nThe following example shows how to set permissions so that user\n.Ar cindys\ncan create, destroy, mount, and take snapshots on\n.Ar tank/cindys .\nThe permissions on\n.Ar tank/cindys\nare also displayed.\n.Bd -literal -compact -offset Ds\n.No # Nm zfs Cm allow Sy cindys create , Ns Sy destroy , Ns Sy mount , Ns Sy snapshot Ar tank/cindys\n.No # Nm zfs Cm allow Ar tank/cindys\n---- Permissions on tank/cindys --------------------------------------\nLocal+Descendent permissions:\n        user cindys create,destroy,mount,snapshot\n.Ed\n.Pp\nBecause the\n.Ar tank/cindys\nmount point permission is set to 755 by default, user\n.Ar cindys\nwill be unable to mount file systems under\n.Ar tank/cindys .\nAdd an ACE similar to the following syntax to provide mount point access:\n.Dl # Cm chmod No A+user : Ns Ar cindys Ns :add_subdirectory:allow Ar /tank/cindys\n.\n.Ss Example 2 : No Delegating Create Time Permissions on a ZFS Dataset\nThe following example shows how to grant anyone in the group\n.Ar staff\nto create file systems in\n.Ar tank/users .\nThis syntax also allows staff members to destroy their own file systems, but not\ndestroy anyone else's file system.\nThe permissions on\n.Ar tank/users\nare also displayed.\n.Bd -literal -compact -offset Ds\n.No # Nm zfs Cm allow Ar staff Sy create , Ns Sy mount Ar tank/users\n.No # Nm zfs Cm allow Fl c Sy destroy Ar tank/users\n.No # Nm zfs Cm allow Ar tank/users\n---- Permissions on tank/users ---------------------------------------\nPermission sets:\n        destroy\nLocal+Descendent permissions:\n        group staff create,mount\n.Ed\n.\n.Ss Example 3 : No Defining and Granting a Permission Set on a ZFS Dataset\nThe following example shows how to define and grant a permission set on the\n.Ar tank/users\nfile system.\nThe permissions on\n.Ar tank/users\nare also displayed.\n.Bd -literal -compact -offset Ds\n.No # Nm zfs Cm allow Fl s No @ Ns Ar pset Sy create , Ns Sy destroy , Ns Sy snapshot , Ns Sy mount Ar tank/users\n.No # Nm zfs Cm allow staff No @ Ns Ar pset tank/users\n.No # Nm zfs Cm allow Ar tank/users\n---- Permissions on tank/users ---------------------------------------\nPermission sets:\n        @pset create,destroy,mount,snapshot\nLocal+Descendent permissions:\n        group staff @pset\n.Ed\n.\n.Ss Example 4 : No Delegating Property Permissions on a ZFS Dataset\nThe following example shows to grant the ability to set quotas and reservations\non the\n.Ar users/home\nfile system.\nThe permissions on\n.Ar users/home\nare also displayed.\n.Bd -literal -compact -offset Ds\n.No # Nm zfs Cm allow Ar cindys Sy quota , Ns Sy reservation Ar users/home\n.No # Nm zfs Cm allow Ar users/home\n---- Permissions on users/home ---------------------------------------\nLocal+Descendent permissions:\n        user cindys quota,reservation\ncindys% zfs set quota=10G users/home/marks\ncindys% zfs get quota users/home/marks\nNAME              PROPERTY  VALUE  SOURCE\nusers/home/marks  quota     10G    local\n.Ed\n.\n.Ss Example 5 : No Removing ZFS Delegated Permissions on a ZFS Dataset\nThe following example shows how to remove the snapshot permission from the\n.Ar staff\ngroup on the\n.Sy tank/users\nfile system.\nThe permissions on\n.Sy tank/users\nare also displayed.\n.Bd -literal -compact -offset Ds\n.No # Nm zfs Cm unallow Ar staff Sy snapshot Ar tank/users\n.No # Nm zfs Cm allow Ar tank/users\n---- Permissions on tank/users ---------------------------------------\nPermission sets:\n        @pset create,destroy,mount,snapshot\nLocal+Descendent permissions:\n        group staff @pset\n.Ed\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}