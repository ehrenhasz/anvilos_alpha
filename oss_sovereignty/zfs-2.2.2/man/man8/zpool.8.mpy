{
  "module_name": "zpool.8",
  "hash_id": "10090d763c8f0bf95a7cfe44f2c2df4b1aa3591eabae64aac3dbec27bcd2846e",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zpool.8",
  "human_readable_source": ".\\\"\n.\\\" CDDL HEADER START\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License (the \"License\").\n.\\\" You may not use this file except in compliance with the License.\n.\\\"\n.\\\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE\n.\\\" or https://opensource.org/licenses/CDDL-1.0.\n.\\\" See the License for the specific language governing permissions\n.\\\" and limitations under the License.\n.\\\"\n.\\\" When distributing Covered Code, include this CDDL HEADER in each\n.\\\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.\n.\\\" If applicable, add the following below this CDDL HEADER, with the\n.\\\" fields enclosed by brackets \"[]\" replaced with your own identifying\n.\\\" information: Portions Copyright [yyyy] [name of copyright owner]\n.\\\"\n.\\\" CDDL HEADER END\n.\\\"\n.\\\" Copyright (c) 2007, Sun Microsystems, Inc. All Rights Reserved.\n.\\\" Copyright (c) 2012, 2018 by Delphix. All rights reserved.\n.\\\" Copyright (c) 2012 Cyril Plisko. All Rights Reserved.\n.\\\" Copyright (c) 2017 Datto Inc.\n.\\\" Copyright (c) 2018 George Melikov. All Rights Reserved.\n.\\\" Copyright 2017 Nexenta Systems, Inc.\n.\\\" Copyright (c) 2017 Open-E, Inc. All Rights Reserved.\n.\\\"\n.Dd March 16, 2022\n.Dt ZPOOL 8\n.Os\n.\n.Sh NAME\n.Nm zpool\n.Nd configure ZFS storage pools\n.Sh SYNOPSIS\n.Nm\n.Fl ?V\n.Nm\n.Cm version\n.Nm\n.Cm subcommand\n.Op Ar arguments\n.\n.Sh DESCRIPTION\nThe\n.Nm\ncommand configures ZFS storage pools.\nA storage pool is a collection of devices that provides physical storage and\ndata replication for ZFS datasets.\nAll datasets within a storage pool share the same space.\nSee\n.Xr zfs 8\nfor information on managing datasets.\n.Pp\nFor an overview of creating and managing ZFS storage pools see the\n.Xr zpoolconcepts 7\nmanual page.\n.\n.Sh SUBCOMMANDS\nAll subcommands that modify state are logged persistently to the pool in their\noriginal form.\n.Pp\nThe\n.Nm\ncommand provides subcommands to create and destroy storage pools, add capacity\nto storage pools, and provide information about the storage pools.\nThe following subcommands are supported:\n.Bl -tag -width Ds\n.It Xo\n.Nm\n.Fl ?\\&\n.Xc\nDisplays a help message.\n.It Xo\n.Nm\n.Fl V , -version\n.Xc\n.It Xo\n.Nm\n.Cm version\n.Xc\nDisplays the software version of the\n.Nm\nuserland utility and the ZFS kernel module.\n.El\n.\n.Ss Creation\n.Bl -tag -width Ds\n.It Xr zpool-create 8\nCreates a new storage pool containing the virtual devices specified on the\ncommand line.\n.It Xr zpool-initialize 8\nBegins initializing by writing to all unallocated regions on the specified\ndevices, or all eligible devices in the pool if no individual devices are\nspecified.\n.El\n.\n.Ss Destruction\n.Bl -tag -width Ds\n.It Xr zpool-destroy 8\nDestroys the given pool, freeing up any devices for other use.\n.It Xr zpool-labelclear 8\nRemoves ZFS label information from the specified\n.Ar device .\n.El\n.\n.Ss Virtual Devices\n.Bl -tag -width Ds\n.It Xo\n.Xr zpool-attach 8 Ns / Ns Xr zpool-detach 8\n.Xc\nConverts a non-redundant disk into a mirror, or increases\nthe redundancy level of an existing mirror\n.Cm ( attach Ns ), or performs the inverse operation (\n.Cm detach Ns ).\n.It Xo\n.Xr zpool-add 8 Ns / Ns Xr zpool-remove 8\n.Xc\nAdds the specified virtual devices to the given pool,\nor removes the specified device from the pool.\n.It Xr zpool-replace 8\nReplaces an existing device (which may be faulted) with a new one.\n.It Xr zpool-split 8\nCreates a new pool by splitting all mirrors in an existing pool (which decreases\nits redundancy).\n.El\n.\n.Ss Properties\nAvailable pool properties listed in the\n.Xr zpoolprops 7\nmanual page.\n.Bl -tag -width Ds\n.It Xr zpool-list 8\nLists the given pools along with a health status and space usage.\n.It Xo\n.Xr zpool-get 8 Ns / Ns Xr zpool-set 8\n.Xc\nRetrieves the given list of properties\n.Po\nor all properties if\n.Sy all\nis used\n.Pc\nfor the specified storage pool(s).\n.El\n.\n.Ss Monitoring\n.Bl -tag -width Ds\n.It Xr zpool-status 8\nDisplays the detailed health status for the given pools.\n.It Xr zpool-iostat 8\nDisplays logical I/O statistics for the given pools/vdevs.\nPhysical I/O operations may be observed via\n.Xr iostat 1 .\n.It Xr zpool-events 8\nLists all recent events generated by the ZFS kernel modules.\nThese events are consumed by the\n.Xr zed 8\nand used to automate administrative tasks such as replacing a failed device\nwith a hot spare.\nThat manual page also describes the subclasses and event payloads\nthat can be generated.\n.It Xr zpool-history 8\nDisplays the command history of the specified pool(s) or all pools if no pool is\nspecified.\n.El\n.\n.Ss Maintenance\n.Bl -tag -width Ds\n.It Xr zpool-scrub 8\nBegins a scrub or resumes a paused scrub.\n.It Xr zpool-checkpoint 8\nCheckpoints the current state of\n.Ar pool ,\nwhich can be later restored by\n.Nm zpool Cm import Fl -rewind-to-checkpoint .\n.It Xr zpool-trim 8\nInitiates an immediate on-demand TRIM operation for all of the free space in a\npool.\nThis operation informs the underlying storage devices of all blocks\nin the pool which are no longer allocated and allows thinly provisioned\ndevices to reclaim the space.\n.It Xr zpool-sync 8\nThis command forces all in-core dirty data to be written to the primary\npool storage and not the ZIL.\nIt will also update administrative information including quota reporting.\nWithout arguments,\n.Nm zpool Cm sync\nwill sync all pools on the system.\nOtherwise, it will sync only the specified pool(s).\n.It Xr zpool-upgrade 8\nManage the on-disk format version of storage pools.\n.It Xr zpool-wait 8\nWaits until all background activity of the given types has ceased in the given\npool.\n.El\n.\n.Ss Fault Resolution\n.Bl -tag -width Ds\n.It Xo\n.Xr zpool-offline 8 Ns / Ns Xr zpool-online 8\n.Xc\nTakes the specified physical device offline or brings it online.\n.It Xr zpool-resilver 8\nStarts a resilver.\nIf an existing resilver is already running it will be restarted from the\nbeginning.\n.It Xr zpool-reopen 8\nReopen all the vdevs associated with the pool.\n.It Xr zpool-clear 8\nClears device errors in a pool.\n.El\n.\n.Ss Import & Export\n.Bl -tag -width Ds\n.It Xr zpool-import 8\nMake disks containing ZFS storage pools available for use on the system.\n.It Xr zpool-export 8\nExports the given pools from the system.\n.It Xr zpool-reguid 8\nGenerates a new unique identifier for the pool.\n.El\n.\n.Sh EXIT STATUS\nThe following exit values are returned:\n.Bl -tag -compact -offset 4n -width \"a\"\n.It Sy 0\nSuccessful completion.\n.It Sy 1\nAn error occurred.\n.It Sy 2\nInvalid command line options were specified.\n.El\n.\n.Sh EXAMPLES\n.\\\" Examples 1, 2, 3, 4, 12, 13 are shared with zpool-create.8.\n.\\\" Examples 6, 14 are shared with zpool-add.8.\n.\\\" Examples 7, 16 are shared with zpool-list.8.\n.\\\" Examples 8 are shared with zpool-destroy.8.\n.\\\" Examples 9 are shared with zpool-export.8.\n.\\\" Examples 10 are shared with zpool-import.8.\n.\\\" Examples 11 are shared with zpool-upgrade.8.\n.\\\" Examples 15 are shared with zpool-remove.8.\n.\\\" Examples 17 are shared with zpool-status.8.\n.\\\" Examples 14, 17 are also shared with zpool-iostat.8.\n.\\\" Make sure to update them omnidirectionally\n.Ss Example 1 : No Creating a RAID-Z Storage Pool\nThe following command creates a pool with a single raidz root vdev that\nconsists of six disks:\n.Dl # Nm zpool Cm create Ar tank Sy raidz Pa sda sdb sdc sdd sde sdf\n.\n.Ss Example 2 : No Creating a Mirrored Storage Pool\nThe following command creates a pool with two mirrors, where each mirror\ncontains two disks:\n.Dl # Nm zpool Cm create Ar tank Sy mirror Pa sda sdb Sy mirror Pa sdc sdd\n.\n.Ss Example 3 : No Creating a ZFS Storage Pool by Using Partitions\nThe following command creates a non-redundant pool using two disk partitions:\n.Dl # Nm zpool Cm create Ar tank Pa sda1 sdb2\n.\n.Ss Example 4 : No Creating a ZFS Storage Pool by Using Files\nThe following command creates a non-redundant pool using files.\nWhile not recommended, a pool based on files can be useful for experimental\npurposes.\n.Dl # Nm zpool Cm create Ar tank Pa /path/to/file/a /path/to/file/b\n.\n.Ss Example 5 : No Making a non-mirrored ZFS Storage Pool mirrored\nThe following command converts an existing single device\n.Ar sda\ninto a mirror by attaching a second device to it,\n.Ar sdb .\n.Dl # Nm zpool Cm attach Ar tank Pa sda sdb\n.\n.Ss Example 6 : No Adding a Mirror to a ZFS Storage Pool\nThe following command adds two mirrored disks to the pool\n.Ar tank ,\nassuming the pool is already made up of two-way mirrors.\nThe additional space is immediately available to any datasets within the pool.\n.Dl # Nm zpool Cm add Ar tank Sy mirror Pa sda sdb\n.\n.Ss Example 7 : No Listing Available ZFS Storage Pools\nThe following command lists all available pools on the system.\nIn this case, the pool\n.Ar zion\nis faulted due to a missing device.\nThe results from this command are similar to the following:\n.Bd -literal -compact -offset Ds\n.No # Nm zpool Cm list\nNAME    SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT\nrpool  19.9G  8.43G  11.4G         -    33%    42%  1.00x  ONLINE  -\ntank   61.5G  20.0G  41.5G         -    48%    32%  1.00x  ONLINE  -\nzion       -      -      -         -      -      -      -  FAULTED -\n.Ed\n.\n.Ss Example 8 : No Destroying a ZFS Storage Pool\nThe following command destroys the pool\n.Ar tank\nand any datasets contained within:\n.Dl # Nm zpool Cm destroy Fl f Ar tank\n.\n.Ss Example 9 : No Exporting a ZFS Storage Pool\nThe following command exports the devices in pool\n.Ar tank\nso that they can be relocated or later imported:\n.Dl # Nm zpool Cm export Ar tank\n.\n.Ss Example 10 : No Importing a ZFS Storage Pool\nThe following command displays available pools, and then imports the pool\n.Ar tank\nfor use on the system.\nThe results from this command are similar to the following:\n.Bd -literal -compact -offset Ds\n.No # Nm zpool Cm import\n  pool: tank\n    id: 15451357997522795478\n state: ONLINE\naction: The pool can be imported using its name or numeric identifier.\nconfig:\n\n        tank        ONLINE\n          mirror    ONLINE\n            sda     ONLINE\n            sdb     ONLINE\n\n.No # Nm zpool Cm import Ar tank\n.Ed\n.\n.Ss Example 11 : No Upgrading All ZFS Storage Pools to the Current Version\nThe following command upgrades all ZFS Storage pools to the current version of\nthe software:\n.Bd -literal -compact -offset Ds\n.No # Nm zpool Cm upgrade Fl a\nThis system is currently running ZFS version 2.\n.Ed\n.\n.Ss Example 12 : No Managing Hot Spares\nThe following command creates a new pool with an available hot spare:\n.Dl # Nm zpool Cm create Ar tank Sy mirror Pa sda sdb Sy spare Pa sdc\n.Pp\nIf one of the disks were to fail, the pool would be reduced to the degraded\nstate.\nThe failed device can be replaced using the following command:\n.Dl # Nm zpool Cm replace Ar tank Pa sda sdd\n.Pp\nOnce the data has been resilvered, the spare is automatically removed and is\nmade available for use should another device fail.\nThe hot spare can be permanently removed from the pool using the following\ncommand:\n.Dl # Nm zpool Cm remove Ar tank Pa sdc\n.\n.Ss Example 13 : No Creating a ZFS Pool with Mirrored Separate Intent Logs\nThe following command creates a ZFS storage pool consisting of two, two-way\nmirrors and mirrored log devices:\n.Dl # Nm zpool Cm create Ar pool Sy mirror Pa sda sdb Sy mirror Pa sdc sdd Sy log mirror Pa sde sdf\n.\n.Ss Example 14 : No Adding Cache Devices to a ZFS Pool\nThe following command adds two disks for use as cache devices to a ZFS storage\npool:\n.Dl # Nm zpool Cm add Ar pool Sy cache Pa sdc sdd\n.Pp\nOnce added, the cache devices gradually fill with content from main memory.\nDepending on the size of your cache devices, it could take over an hour for\nthem to fill.\nCapacity and reads can be monitored using the\n.Cm iostat\nsubcommand as follows:\n.Dl # Nm zpool Cm iostat Fl v Ar pool 5\n.\n.Ss Example 15 : No Removing a Mirrored top-level (Log or Data) Device\nThe following commands remove the mirrored log device\n.Sy mirror-2\nand mirrored top-level data device\n.Sy mirror-1 .\n.Pp\nGiven this configuration:\n.Bd -literal -compact -offset Ds\n  pool: tank\n state: ONLINE\n scrub: none requested\nconfig:\n\n         NAME        STATE     READ WRITE CKSUM\n         tank        ONLINE       0     0     0\n           mirror-0  ONLINE       0     0     0\n             sda     ONLINE       0     0     0\n             sdb     ONLINE       0     0     0\n           mirror-1  ONLINE       0     0     0\n             sdc     ONLINE       0     0     0\n             sdd     ONLINE       0     0     0\n         logs\n           mirror-2  ONLINE       0     0     0\n             sde     ONLINE       0     0     0\n             sdf     ONLINE       0     0     0\n.Ed\n.Pp\nThe command to remove the mirrored log\n.Ar mirror-2 No is :\n.Dl # Nm zpool Cm remove Ar tank mirror-2\n.Pp\nThe command to remove the mirrored data\n.Ar mirror-1 No is :\n.Dl # Nm zpool Cm remove Ar tank mirror-1\n.\n.Ss Example 16 : No Displaying expanded space on a device\nThe following command displays the detailed information for the pool\n.Ar data .\nThis pool is comprised of a single raidz vdev where one of its devices\nincreased its capacity by 10 GiB.\nIn this example, the pool will not be able to utilize this extra capacity until\nall the devices under the raidz vdev have been expanded.\n.Bd -literal -compact -offset Ds\n.No # Nm zpool Cm list Fl v Ar data\nNAME         SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT\ndata        23.9G  14.6G  9.30G         -    48%    61%  1.00x  ONLINE  -\n  raidz1    23.9G  14.6G  9.30G         -    48%\n    sda         -      -      -         -      -\n    sdb         -      -      -       10G      -\n    sdc         -      -      -         -      -\n.Ed\n.\n.Ss Example 17 : No Adding output columns\nAdditional columns can be added to the\n.Nm zpool Cm status No and Nm zpool Cm iostat No output with Fl c .\n.Bd -literal -compact -offset Ds\n.No # Nm zpool Cm status Fl c Pa vendor , Ns Pa model , Ns Pa size\n   NAME     STATE  READ WRITE CKSUM vendor  model        size\n   tank     ONLINE 0    0     0\n   mirror-0 ONLINE 0    0     0\n   U1       ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n   U10      ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n   U11      ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n   U12      ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n   U13      ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n   U14      ONLINE 0    0     0     SEAGATE ST8000NM0075 7.3T\n\n.No # Nm zpool Cm iostat Fl vc Pa size\n              capacity     operations     bandwidth\npool        alloc   free   read  write   read  write  size\n----------  -----  -----  -----  -----  -----  -----  ----\nrpool       14.6G  54.9G      4     55   250K  2.69M\n  sda1      14.6G  54.9G      4     55   250K  2.69M   70G\n----------  -----  -----  -----  -----  -----  -----  ----\n.Ed\n.\n.Sh ENVIRONMENT VARIABLES\n.Bl -tag -compact -width \"ZPOOL_IMPORT_UDEV_TIMEOUT_MS\"\n.It Sy ZFS_ABORT\nCause\n.Nm\nto dump core on exit for the purposes of running\n.Sy ::findleaks .\n.It Sy ZFS_COLOR\nUse ANSI color in\n.Nm zpool Cm status\nand\n.Nm zpool Cm iostat\noutput.\n.It Sy ZPOOL_IMPORT_PATH\nThe search path for devices or files to use with the pool.\nThis is a colon-separated list of directories in which\n.Nm\nlooks for device nodes and files.\nSimilar to the\n.Fl d\noption in\n.Nm zpool import .\n.It Sy ZPOOL_IMPORT_UDEV_TIMEOUT_MS\nThe maximum time in milliseconds that\n.Nm zpool import\nwill wait for an expected device to be available.\n.It Sy ZPOOL_STATUS_NON_NATIVE_ASHIFT_IGNORE\nIf set, suppress warning about non-native vdev ashift in\n.Nm zpool Cm status .\nThe value is not used, only the presence or absence of the variable matters.\n.It Sy ZPOOL_VDEV_NAME_GUID\nCause\n.Nm\nsubcommands to output vdev guids by default.\nThis behavior is identical to the\n.Nm zpool Cm status Fl g\ncommand line option.\n.It Sy ZPOOL_VDEV_NAME_FOLLOW_LINKS\nCause\n.Nm\nsubcommands to follow links for vdev names by default.\nThis behavior is identical to the\n.Nm zpool Cm status Fl L\ncommand line option.\n.It Sy ZPOOL_VDEV_NAME_PATH\nCause\n.Nm\nsubcommands to output full vdev path names by default.\nThis behavior is identical to the\n.Nm zpool Cm status Fl P\ncommand line option.\n.It Sy ZFS_VDEV_DEVID_OPT_OUT\nOlder OpenZFS implementations had issues when attempting to display pool\nconfig vdev names if a\n.Sy devid\nNVP value is present in the pool's config.\n.Pp\nFor example, a pool that originated on illumos platform would have a\n.Sy devid\nvalue in the config and\n.Nm zpool Cm status\nwould fail when listing the config.\nThis would also be true for future Linux-based pools.\n.Pp\nA pool can be stripped of any\n.Sy devid\nvalues on import or prevented from adding\nthem on\n.Nm zpool Cm create\nor\n.Nm zpool Cm add\nby setting\n.Sy ZFS_VDEV_DEVID_OPT_OUT .\n.Pp\n.It Sy ZPOOL_SCRIPTS_AS_ROOT\nAllow a privileged user to run\n.Nm zpool Cm status Ns / Ns Cm iostat Fl c .\nNormally, only unprivileged users are allowed to run\n.Fl c .\n.It Sy ZPOOL_SCRIPTS_PATH\nThe search path for scripts when running\n.Nm zpool Cm status Ns / Ns Cm iostat Fl c .\nThis is a colon-separated list of directories and overrides the default\n.Pa ~/.zpool.d\nand\n.Pa /etc/zfs/zpool.d\nsearch paths.\n.It Sy ZPOOL_SCRIPTS_ENABLED\nAllow a user to run\n.Nm zpool Cm status Ns / Ns Cm iostat Fl c .\nIf\n.Sy ZPOOL_SCRIPTS_ENABLED\nis not set, it is assumed that the user is allowed to run\n.Nm zpool Cm status Ns / Ns Cm iostat Fl c .\n.\\\" Shared with zfs.8\n.It Sy ZFS_MODULE_TIMEOUT\nTime, in seconds, to wait for\n.Pa /dev/zfs\nto appear.\nDefaults to\n.Sy 10 ,\nmax\n.Sy 600 Pq 10 minutes .\nIf\n.Pf < Sy 0 ,\nwait forever; if\n.Sy 0 ,\ndon't wait.\n.El\n.\n.Sh INTERFACE STABILITY\n.Sy Evolving\n.\n.Sh SEE ALSO\n.Xr zfs 4 ,\n.Xr zpool-features 7 ,\n.Xr zpoolconcepts 7 ,\n.Xr zpoolprops 7 ,\n.Xr zed 8 ,\n.Xr zfs 8 ,\n.Xr zpool-add 8 ,\n.Xr zpool-attach 8 ,\n.Xr zpool-checkpoint 8 ,\n.Xr zpool-clear 8 ,\n.Xr zpool-create 8 ,\n.Xr zpool-destroy 8 ,\n.Xr zpool-detach 8 ,\n.Xr zpool-events 8 ,\n.Xr zpool-export 8 ,\n.Xr zpool-get 8 ,\n.Xr zpool-history 8 ,\n.Xr zpool-import 8 ,\n.Xr zpool-initialize 8 ,\n.Xr zpool-iostat 8 ,\n.Xr zpool-labelclear 8 ,\n.Xr zpool-list 8 ,\n.Xr zpool-offline 8 ,\n.Xr zpool-online 8 ,\n.Xr zpool-reguid 8 ,\n.Xr zpool-remove 8 ,\n.Xr zpool-reopen 8 ,\n.Xr zpool-replace 8 ,\n.Xr zpool-resilver 8 ,\n.Xr zpool-scrub 8 ,\n.Xr zpool-set 8 ,\n.Xr zpool-split 8 ,\n.Xr zpool-status 8 ,\n.Xr zpool-sync 8 ,\n.Xr zpool-trim 8 ,\n.Xr zpool-upgrade 8 ,\n.Xr zpool-wait 8\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}