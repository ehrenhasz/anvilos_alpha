{
  "module_name": "zpool-remove.8",
  "hash_id": "5f78cb23d48b27a36b7be2cb789df52bf91e8a35478933a4489c1819d8f26a4c",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zpool-remove.8",
  "human_readable_source": ".\\\"\n.\\\" CDDL HEADER START\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License (the \"License\").\n.\\\" You may not use this file except in compliance with the License.\n.\\\"\n.\\\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE\n.\\\" or https://opensource.org/licenses/CDDL-1.0.\n.\\\" See the License for the specific language governing permissions\n.\\\" and limitations under the License.\n.\\\"\n.\\\" When distributing Covered Code, include this CDDL HEADER in each\n.\\\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.\n.\\\" If applicable, add the following below this CDDL HEADER, with the\n.\\\" fields enclosed by brackets \"[]\" replaced with your own identifying\n.\\\" information: Portions Copyright [yyyy] [name of copyright owner]\n.\\\"\n.\\\" CDDL HEADER END\n.\\\"\n.\\\" Copyright (c) 2007, Sun Microsystems, Inc. All Rights Reserved.\n.\\\" Copyright (c) 2012, 2018 by Delphix. All rights reserved.\n.\\\" Copyright (c) 2012 Cyril Plisko. All Rights Reserved.\n.\\\" Copyright (c) 2017 Datto Inc.\n.\\\" Copyright (c) 2018 George Melikov. All Rights Reserved.\n.\\\" Copyright 2017 Nexenta Systems, Inc.\n.\\\" Copyright (c) 2017 Open-E, Inc. All Rights Reserved.\n.\\\"\n.Dd March 16, 2022\n.Dt ZPOOL-REMOVE 8\n.Os\n.\n.Sh NAME\n.Nm zpool-remove\n.Nd remove devices from ZFS storage pool\n.\n.Sh SYNOPSIS\n.Nm zpool\n.Cm remove\n.Op Fl npw\n.Ar pool Ar device Ns \u2026\n.Nm zpool\n.Cm remove\n.Fl s\n.Ar pool\n.\n.Sh DESCRIPTION\n.Bl -tag -width Ds\n.It Xo\n.Nm zpool\n.Cm remove\n.Op Fl npw\n.Ar pool Ar device Ns \u2026\n.Xc\nRemoves the specified device from the pool.\nThis command supports removing hot spare, cache, log, and both mirrored and\nnon-redundant primary top-level vdevs, including dedup and special vdevs.\n.Pp\nTop-level vdevs can only be removed if the primary pool storage does not contain\na top-level raidz vdev, all top-level vdevs have the same sector size, and the\nkeys for all encrypted datasets are loaded.\n.Pp\nRemoving a top-level vdev reduces the total amount of space in the storage pool.\nThe specified device will be evacuated by copying all allocated space from it to\nthe other devices in the pool.\nIn this case, the\n.Nm zpool Cm remove\ncommand initiates the removal and returns, while the evacuation continues in\nthe background.\nThe removal progress can be monitored with\n.Nm zpool Cm status .\nIf an I/O error is encountered during the removal process it will be cancelled.\nThe\n.Sy device_removal\nfeature flag must be enabled to remove a top-level vdev, see\n.Xr zpool-features 7 .\n.Pp\nA mirrored top-level device (log or data) can be removed by specifying the top-\nlevel mirror for the\nsame.\nNon-log devices or data devices that are part of a mirrored configuration can be\nremoved using\nthe\n.Nm zpool Cm detach\ncommand.\n.Bl -tag -width Ds\n.It Fl n\nDo not actually perform the removal\n.Pq Qq No-op .\nInstead, print the estimated amount of memory that will be used by the\nmapping table after the removal completes.\nThis is nonzero only for top-level vdevs.\n.El\n.Bl -tag -width Ds\n.It Fl p\nUsed in conjunction with the\n.Fl n\nflag, displays numbers as parsable (exact) values.\n.It Fl w\nWaits until the removal has completed before returning.\n.El\n.It Xo\n.Nm zpool\n.Cm remove\n.Fl s\n.Ar pool\n.Xc\nStops and cancels an in-progress removal of a top-level vdev.\n.El\n.\n.Sh EXAMPLES\n.\\\" These are, respectively, examples 14 from zpool.8\n.\\\" Make sure to update them bidirectionally\n.Ss Example 1 : No Removing a Mirrored top-level (Log or Data) Device\nThe following commands remove the mirrored log device\n.Sy mirror-2\nand mirrored top-level data device\n.Sy mirror-1 .\n.Pp\nGiven this configuration:\n.Bd -literal -compact -offset Ds\n  pool: tank\n state: ONLINE\n scrub: none requested\nconfig:\n\n         NAME        STATE     READ WRITE CKSUM\n         tank        ONLINE       0     0     0\n           mirror-0  ONLINE       0     0     0\n             sda     ONLINE       0     0     0\n             sdb     ONLINE       0     0     0\n           mirror-1  ONLINE       0     0     0\n             sdc     ONLINE       0     0     0\n             sdd     ONLINE       0     0     0\n         logs\n           mirror-2  ONLINE       0     0     0\n             sde     ONLINE       0     0     0\n             sdf     ONLINE       0     0     0\n.Ed\n.Pp\nThe command to remove the mirrored log\n.Ar mirror-2 No is :\n.Dl # Nm zpool Cm remove Ar tank mirror-2\n.Pp\nThe command to remove the mirrored data\n.Ar mirror-1 No is :\n.Dl # Nm zpool Cm remove Ar tank mirror-1\n.\n.Sh SEE ALSO\n.Xr zpool-add 8 ,\n.Xr zpool-detach 8 ,\n.Xr zpool-labelclear 8 ,\n.Xr zpool-offline 8 ,\n.Xr zpool-replace 8 ,\n.Xr zpool-split 8\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}