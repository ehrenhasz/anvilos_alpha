{
  "module_name": "zfs_prepare_disk.8",
  "hash_id": "0e33deec01bbf03e61f83277ae8e35a013dd85181dcba28fadfc475f88597938",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zfs_prepare_disk.8",
  "human_readable_source": ".\\\"\n.\\\" Developed at Lawrence Livermore National Laboratory (LLNL-CODE-403049).\n.\\\" Copyright (C) 2023 Lawrence Livermore National Security, LLC.\n.\\\" Refer to the OpenZFS git commit log for authoritative copyright attribution.\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License Version 1.0 (CDDL-1.0).\n.\\\" You can obtain a copy of the license from the top-level file\n.\\\" \"OPENSOLARIS.LICENSE\" or at <http://opensource.org/licenses/CDDL-1.0>.\n.\\\" You may not use this file except in compliance with the license.\n.\\\"\n.\\\" Developed at Lawrence Livermore National Laboratory (LLNL-CODE-403049)\n.\\\"\n.Dd August 30, 2023\n.Dt ZFS_PREPARE_DISK 8\n.Os\n.\n.Sh NAME\n.Nm zfs_prepare_disk\n.Nd special script that gets run before bringing a disk into a pool\n.Sh DESCRIPTION\n.Nm\nis an optional script that gets called by libzfs before bringing a disk into a\npool.\nIt can be modified by the user to run whatever commands are necessary to prepare\na disk for inclusion into the pool.\nFor example, users can add lines to\n.Nm zfs_prepare_disk\nto do things like update the drive's firmware or check the drive's health.\n.Nm zfs_prepare_disk\nis optional and can be removed if not needed.\nlibzfs will look for the script at /zfs_prepare_disk.\n.\n.Ss Properties\n.Nm zfs_prepare_disk\nwill be passed the following environment variables:\n.sp\n.Bl -tag -compact -width \"VDEV_ENC_SYSFS_PATH\"\n.\n.It Nm POOL_NAME\n.No Name of the pool\n.It Nm VDEV_PATH\n.No Path to the disk (like /dev/sda)\n.It Nm VDEV_PREPARE\n.No Reason why the disk is being prepared for inclusion\n('create', 'add', 'replace', or 'autoreplace').\nThis can be useful if you only want the script to be run under certain actions.\n.It Nm VDEV_UPATH\n.No Path to one of the underlying devices for the\ndisk.\nFor multipath this would return one of the /dev/sd* paths to the disk.\nIf the device is not a device mapper device, then\n.Nm VDEV_UPATH\njust returns the same value as\n.Nm VDEV_PATH\n.It Nm VDEV_ENC_SYSFS_PATH\n.No Path to the disk's enclosure sysfs path, if available\n.El\n.Pp\nNote that some of these variables may have a blank value.\n.Nm POOL_NAME\nis blank at pool creation time, for example.\n.Sh ENVIRONMENT\n.Nm zfs_prepare_disk\nruns with a limited $PATH.\n.Sh EXIT STATUS\n.Nm zfs_prepare_disk\nshould return 0 on success, non-zero otherwise.\nIf non-zero is returned, the disk will not be included in the pool.\n.\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}