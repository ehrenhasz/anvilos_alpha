{
  "module_name": "zpool-scrub.8",
  "hash_id": "b141a13bb804def631b18bcce2cd84d99337003e43dab1df635c0cc0d3a15716",
  "original_prompt": "Ingested from zfs-2.2.2/man/man8/zpool-scrub.8",
  "human_readable_source": ".\\\"\n.\\\" CDDL HEADER START\n.\\\"\n.\\\" The contents of this file are subject to the terms of the\n.\\\" Common Development and Distribution License (the \"License\").\n.\\\" You may not use this file except in compliance with the License.\n.\\\"\n.\\\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE\n.\\\" or https://opensource.org/licenses/CDDL-1.0.\n.\\\" See the License for the specific language governing permissions\n.\\\" and limitations under the License.\n.\\\"\n.\\\" When distributing Covered Code, include this CDDL HEADER in each\n.\\\" file and include the License file at usr/src/OPENSOLARIS.LICENSE.\n.\\\" If applicable, add the following below this CDDL HEADER, with the\n.\\\" fields enclosed by brackets \"[]\" replaced with your own identifying\n.\\\" information: Portions Copyright [yyyy] [name of copyright owner]\n.\\\"\n.\\\" CDDL HEADER END\n.\\\"\n.\\\" Copyright (c) 2007, Sun Microsystems, Inc. All Rights Reserved.\n.\\\" Copyright (c) 2012, 2018 by Delphix. All rights reserved.\n.\\\" Copyright (c) 2012 Cyril Plisko. All Rights Reserved.\n.\\\" Copyright (c) 2017 Datto Inc.\n.\\\" Copyright (c) 2018, 2021 George Melikov. All Rights Reserved.\n.\\\" Copyright 2017 Nexenta Systems, Inc.\n.\\\" Copyright (c) 2017 Open-E, Inc. All Rights Reserved.\n.\\\"\n.Dd June 22, 2023\n.Dt ZPOOL-SCRUB 8\n.Os\n.\n.Sh NAME\n.Nm zpool-scrub\n.Nd begin or resume scrub of ZFS storage pools\n.Sh SYNOPSIS\n.Nm zpool\n.Cm scrub\n.Op Fl s Ns | Ns Fl p\n.Op Fl w\n.Op Fl e\n.Ar pool Ns \u2026\n.\n.Sh DESCRIPTION\nBegins a scrub or resumes a paused scrub.\nThe scrub examines all data in the specified pools to verify that it checksums\ncorrectly.\nFor replicated\n.Pq mirror, raidz, or draid\ndevices, ZFS automatically repairs any damage discovered during the scrub.\nThe\n.Nm zpool Cm status\ncommand reports the progress of the scrub and summarizes the results of the\nscrub upon completion.\n.Pp\nScrubbing and resilvering are very similar operations.\nThe difference is that resilvering only examines data that ZFS knows to be out\nof date\n.Po\nfor example, when attaching a new device to a mirror or replacing an existing\ndevice\n.Pc ,\nwhereas scrubbing examines all data to discover silent errors due to hardware\nfaults or disk failure.\n.Pp\nWhen scrubbing a pool with encrypted filesystems the keys do not need to be\nloaded.\nHowever, if the keys are not loaded and an unrepairable checksum error is\ndetected the file name cannot be included in the\n.Nm zpool Cm status Fl v\nverbose error report.\n.Pp\nBecause scrubbing and resilvering are I/O-intensive operations, ZFS only allows\none at a time.\n.Pp\nA scrub is split into two parts: metadata scanning and block scrubbing.\nThe metadata scanning sorts blocks into large sequential ranges which can then\nbe read much more efficiently from disk when issuing the scrub I/O.\n.Pp\nIf a scrub is paused, the\n.Nm zpool Cm scrub\nresumes it.\nIf a resilver is in progress, ZFS does not allow a scrub to be started until the\nresilver completes.\n.Pp\nNote that, due to changes in pool data on a live system, it is possible for\nscrubs to progress slightly beyond 100% completion.\nDuring this period, no completion time estimate will be provided.\n.\n.Sh OPTIONS\n.Bl -tag -width \"-s\"\n.It Fl s\nStop scrubbing.\n.It Fl p\nPause scrubbing.\nScrub pause state and progress are periodically synced to disk.\nIf the system is restarted or pool is exported during a paused scrub,\neven after import, scrub will remain paused until it is resumed.\nOnce resumed the scrub will pick up from the place where it was last\ncheckpointed to disk.\nTo resume a paused scrub issue\n.Nm zpool Cm scrub\nor\n.Nm zpool Cm scrub\n.Fl e\nagain.\n.It Fl w\nWait until scrub has completed before returning.\n.It Fl e\nOnly scrub files with known data errors as reported by\n.Nm zpool Cm status Fl v .\nThe pool must have been scrubbed at least once with the\n.Sy head_errlog\nfeature enabled to use this option.\nError scrubbing cannot be run simultaneously with regular scrubbing or\nresilvering, nor can it be run when a regular scrub is paused.\n.El\n.Sh EXAMPLES\n.Ss Example 1\nStatus of pool with ongoing scrub:\n.sp\n.Bd -literal -compact\n.No # Nm zpool Cm status\n  ...\n  scan: scrub in progress since Sun Jul 25 16:07:49 2021\n        403M / 405M scanned at 100M/s, 68.4M / 405M issued at 10.0M/s\n        0B repaired, 16.91% done, 00:00:04 to go\n  ...\n.Ed\n.Pp\nWhere metadata which references 403M of file data has been\nscanned at 100M/s, and 68.4M of that file data has been\nscrubbed sequentially at 10.0M/s.\n.Sh PERIODIC SCRUB\nOn machines using systemd, scrub timers can be enabled on per-pool basis.\n.Nm weekly\nand\n.Nm monthly\ntimer units are provided.\n.Bl -tag -width Ds\n.It Xo\n.Xc\n.Nm systemctl\n.Cm enable\n.Cm zfs-scrub-\\fIweekly\\fB@\\fIrpool\\fB.timer\n.Cm --now\n.It Xo\n.Xc\n.Nm systemctl\n.Cm enable\n.Cm zfs-scrub-\\fImonthly\\fB@\\fIotherpool\\fB.timer\n.Cm --now\n.El\n.\n.Sh SEE ALSO\n.Xr systemd.timer 5 ,\n.Xr zpool-iostat 8 ,\n.Xr zpool-resilver 8 ,\n.Xr zpool-status 8\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}