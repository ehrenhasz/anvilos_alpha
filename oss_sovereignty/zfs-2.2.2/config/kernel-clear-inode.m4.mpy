{
  "module_name": "kernel-clear-inode.m4",
  "hash_id": "0b1109020c48892596d7272a6c36612c5b1c83c82d4623eb81f52da357077376",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-clear-inode.m4",
  "human_readable_source": "dnl #\ndnl # 3.5.0 API change\ndnl # torvalds/linux@dbd5768f87ff6fb0a4fe09c4d7b6c4a24de99430 and\ndnl # torvalds/linux@7994e6f7254354e03028a11f98a27bd67dace9f1 reworked\ndnl # where inode_sync_wait() is called.\ndnl #\ndnl # Prior to these changes it would occur in end_writeback() but due\ndnl # to various issues (described in the above commits) it has been\ndnl # moved to evict().   This changes the ordering is which sync occurs\ndnl # but otherwise doesn't impact the zpl implementation.\ndnl #\ndnl # The major impact here is the renaming of end_writeback() to\ndnl # clear_inode().  However, care must be taken when detecting this\ndnl # API change because as recently as 2.6.35 there was a clear_inode()\ndnl # function.  However, it was made obsolete by the evict_inode() API\ndnl # change at the same time.\ndnl #\ndnl # Therefore, to ensure we have the correct API we only allow the\ndnl # clear_inode() compatibility code to be defined iff the evict_inode()\ndnl # functionality is also detected.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_CLEAR_INODE], [\n\tZFS_LINUX_TEST_SRC([clear_inode], [\n\t\t#include <linux/fs.h>\n\t], [\n\t\tclear_inode(NULL);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_CLEAR_INODE], [\n\tAC_MSG_CHECKING([whether clear_inode() is available])\n\tZFS_LINUX_TEST_RESULT_SYMBOL([clear_inode],\n\t    [clear_inode], [fs/inode.c], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_CLEAR_INODE, 1, [clear_inode() is available])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}