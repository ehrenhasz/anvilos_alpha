{
  "module_name": "rpm.am",
  "hash_id": "5ab01e47f30b88add6ca12b43d6807ab25e63605e5e32446ad9df1ee989d3a0e",
  "original_prompt": "Ingested from zfs-2.2.2/config/rpm.am",
  "human_readable_source": "###############################################################################\n# Copyright (C) 2007-2013 Lawrence Livermore National Security, LLC.\n# Copyright (C) 2007 The Regents of the University of California.\n# Written by Brian Behlendorf <behlendorf1@llnl.gov>.\n###############################################################################\n# Build targets for RPM packages.\n###############################################################################\n\nPHONY += srpm srpms srpm-kmod srpm-dkms srpm-utils\nPHONY += rpm rpms rpm-kmod rpm-dkms rpm-utils rpm-utils-initramfs\nPHONY += srpm-common rpm-common rpm-local\n\nsrpm-kmod srpm-dkms srpm-utils: dist\n\nsrpm-kmod:\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}-kmod\" \\\n\t\tdef='${SRPM_DEFINE_COMMON} ${SRPM_DEFINE_KMOD}' srpm-common\n\nsrpm-dkms:\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}-dkms\" \\\n\t\tdef='${SRPM_DEFINE_COMMON} ${SRPM_DEFINE_DKMS}' srpm-common\n\nsrpm-utils:\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}\" \\\n\t\tdef='${SRPM_DEFINE_COMMON} ${SRPM_DEFINE_UTIL}' srpm-common\n\nsrpm: srpm-kmod srpm-dkms srpm-utils\nsrpms: srpm-kmod srpm-dkms srpm-utils\n\nrpm-kmod: srpm-kmod\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}-kmod\" \\\n\t\tdef='${RPM_DEFINE_COMMON} ${RPM_DEFINE_KMOD}' rpm-common\n\nrpm-dkms: srpm-dkms\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}-dkms\" \\\n\t\tdef='${RPM_DEFINE_COMMON} ${RPM_DEFINE_DKMS}' rpm-common\n\n# The rpm-utils and rpm-utils-initramfs targets are identical except for the\n# zfs-initramfs package: rpm-utils never includes it, rpm-utils-initramfs\n# includes it if detected at configure time. The zfs-initramfs package does\n# not work on any known RPM-based distribution and the resulting RPM is only\n# used to create a Debian package. The rpm-utils-initramfs target is not\n# intended to be specified by the user directly, it is provided as a\n# dependency of the deb-utils target.\n\nrpm-utils: srpm-utils\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}\" \\\n\t\tdef='${RPM_DEFINE_COMMON} ${RPM_DEFINE_UTIL}' rpm-common\n\nrpm-utils-initramfs: srpm-utils\n\t$(MAKE) $(AM_MAKEFLAGS) pkg=\"${PACKAGE}\" \\\n\t\tdef='${RPM_DEFINE_COMMON} ${RPM_DEFINE_UTIL} ${RPM_DEFINE_INITRAMFS}' rpm-common\n\nrpm: rpm-kmod rpm-dkms rpm-utils\nrpms: rpm-kmod rpm-dkms rpm-utils\n\nrpm-local:\n\t@(if test \"${HAVE_RPMBUILD}\" = \"no\"; then \\\n\t\techo -e \"\\n\" \\\n\t\"*** Required util ${RPMBUILD} missing.  Please install the\\n\" \\\n\t\"*** package for your distribution which provides ${RPMBUILD},\\n\" \\\n\t\"*** re-run configure, and try again.\\n\"; \\\n\t\texit 1; \\\n\tfi; \\\n\tmkdir -p $(rpmbuild)/TMP && \\\n\tmkdir -p $(rpmbuild)/BUILD && \\\n\tmkdir -p $(rpmbuild)/RPMS && \\\n\tmkdir -p $(rpmbuild)/SRPMS && \\\n\tmkdir -p $(rpmbuild)/SPECS && \\\n\tcp ${RPM_SPEC_DIR}/$(rpmspec) $(rpmbuild)/SPECS && \\\n\tmkdir -p $(rpmbuild)/SOURCES && \\\n\tcp $(top_srcdir)/scripts/kmodtool $(rpmbuild)/SOURCES && \\\n\tcp $(distdir).tar.gz $(rpmbuild)/SOURCES)\n\nsrpm-common:\n\t@(dist=`$(RPM) --eval %{?dist}`; \\\n\trpmpkg=$(pkg)-$(VERSION)-$(RELEASE)$$dist*src.rpm; \\\n\trpmspec=$(pkg).spec; \\\n\trpmbuild=`mktemp -t -d $(PACKAGE)-build-$$USER-XXXXXXXX`; \\\n\t$(MAKE) $(AM_MAKEFLAGS) \\\n\t\trpmbuild=\"$$rpmbuild\" \\\n\t\trpmspec=\"$$rpmspec\" \\\n\t\trpm-local || exit 1; \\\n\tLANG=C $(RPMBUILD) \\\n\t\t--define \"_tmppath $$rpmbuild/TMP\" \\\n\t\t--define \"_topdir $$rpmbuild\" \\\n\t\t$(def) -bs $$rpmbuild/SPECS/$$rpmspec || exit 1; \\\n\tcp $$rpmbuild/SRPMS/$$rpmpkg . || exit 1; \\\n\trm -R $$rpmbuild)\n\nrpm-common: \n\t@(dist=`$(RPM) --eval %{?dist}`; \\\n\trpmpkg=$(pkg)-$(VERSION)-$(RELEASE)$$dist*src.rpm; \\\n\trpmspec=$(pkg).spec; \\\n\trpmbuild=`mktemp -t -d $(PACKAGE)-build-$$USER-XXXXXXXX`; \\\n\t$(MAKE) $(AM_MAKEFLAGS) \\\n\t\trpmbuild=\"$$rpmbuild\" \\\n\t\trpmspec=\"$$rpmspec\" \\\n\t\trpm-local || exit 1; \\\n\tLANG=C ${RPMBUILD} \\\n\t\t--define \"_tmppath $$rpmbuild/TMP\" \\\n\t\t--define \"_topdir $$rpmbuild\" \\\n\t\t$(def) --rebuild $$rpmpkg || exit 1; \\\n\tcp $$rpmbuild/RPMS/*/* . || exit 1; \\\n\trm -R $$rpmbuild)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}