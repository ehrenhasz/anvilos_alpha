{
  "module_name": "kernel-is_owner_or_cap.m4",
  "hash_id": "e19b25db50348b03ab3ebd1b854d0cae23de303f0d98af4af24ed6e3272eabc1",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-is_owner_or_cap.m4",
  "human_readable_source": "dnl #\ndnl # 2.6.39 API change,\ndnl # The is_owner_or_cap() macro was renamed to inode_owner_or_capable(),\ndnl # This is used for permission checks in the xattr and file attribute call\ndnl # paths.\ndnl #\ndnl # 5.12 API change,\ndnl # inode_owner_or_capable() now takes struct user_namespace *\ndnl # to support idmapped mounts\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_INODE_OWNER_OR_CAPABLE], [\n\tZFS_LINUX_TEST_SRC([inode_owner_or_capable], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct inode *ip = NULL;\n\t\t(void) inode_owner_or_capable(ip);\n\t])\n\n\tZFS_LINUX_TEST_SRC([inode_owner_or_capable_userns], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct inode *ip = NULL;\n\t\t(void) inode_owner_or_capable(&init_user_ns, ip);\n\t])\n\n\tZFS_LINUX_TEST_SRC([inode_owner_or_capable_mnt_idmap], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/mnt_idmapping.h>\n\t],[\n\t\tstruct inode *ip = NULL;\n\t\t(void) inode_owner_or_capable(&nop_mnt_idmap, ip);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_INODE_OWNER_OR_CAPABLE], [\n\tAC_MSG_CHECKING([whether inode_owner_or_capable() exists])\n\tZFS_LINUX_TEST_RESULT([inode_owner_or_capable], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_INODE_OWNER_OR_CAPABLE, 1,\n\t\t    [inode_owner_or_capable() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\n\t\tAC_MSG_CHECKING(\n\t\t    [whether inode_owner_or_capable() takes user_ns])\n\t\tZFS_LINUX_TEST_RESULT([inode_owner_or_capable_userns], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_INODE_OWNER_OR_CAPABLE_USERNS, 1,\n\t\t\t    [inode_owner_or_capable() takes user_ns])\n\t\t],[\n\t\t\tAC_MSG_RESULT(no)\n\t\t\tAC_MSG_CHECKING(\n\t\t\t    [whether inode_owner_or_capable() takes mnt_idmap])\n\t\t\tZFS_LINUX_TEST_RESULT([inode_owner_or_capable_mnt_idmap], [\n\t\t\t\tAC_MSG_RESULT(yes)\n\t\t\t\tAC_DEFINE(HAVE_INODE_OWNER_OR_CAPABLE_IDMAP, 1,\n\t\t\t\t    [inode_owner_or_capable() takes mnt_idmap])\n\t\t\t], [\n\t\t\t\tZFS_LINUX_TEST_ERROR([capability])\n\t\t\t])\n\t\t])\n\t])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}