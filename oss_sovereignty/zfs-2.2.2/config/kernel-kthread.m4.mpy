{
  "module_name": "kernel-kthread.m4",
  "hash_id": "2e4059e3002785d1eb39858bce2d5b142df7d80dcbaa7d26f5eedee993083078",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-kthread.m4",
  "human_readable_source": "AC_DEFUN([ZFS_AC_KERNEL_KTHREAD_COMPLETE_AND_EXIT], [\n\tdnl #\n\tdnl # 5.17 API,\n\tdnl # cead18552660702a4a46f58e65188fe5f36e9dfe (\"exit: Rename complete_and_exit to kthread_complete_and_exit\")\n\tdnl #\n\tdnl # Also moves the definition from include/linux/kernel.h to include/linux/kthread.h\n\tdnl #\n\tAC_MSG_CHECKING([whether kthread_complete_and_exit() is available])\n\tZFS_LINUX_TEST_RESULT([kthread_complete_and_exit], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(SPL_KTHREAD_COMPLETE_AND_EXIT, kthread_complete_and_exit, [kthread_complete_and_exit() available])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t\tAC_DEFINE(SPL_KTHREAD_COMPLETE_AND_EXIT, complete_and_exit, [using complete_and_exit() instead])\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_KTHREAD_DEQUEUE_SIGNAL_4ARG], [\n\tdnl #\n\tdnl # 5.17 API: enum pid_type * as new 4th dequeue_signal() argument,\n\tdnl # 5768d8906bc23d512b1a736c1e198aa833a6daa4 (\"signal: Requeue signals in the appropriate queue\")\n\tdnl #\n\tdnl # int dequeue_signal(struct task_struct *task, sigset_t *mask, kernel_siginfo_t *info);\n\tdnl # int dequeue_signal(struct task_struct *task, sigset_t *mask, kernel_siginfo_t *info, enum pid_type *type);\n\tdnl #\n\tAC_MSG_CHECKING([whether dequeue_signal() takes 4 arguments])\n\tZFS_LINUX_TEST_RESULT([kthread_dequeue_signal], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_DEQUEUE_SIGNAL_4ARG, 1, [dequeue_signal() takes 4 arguments])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_SRC_KTHREAD_COMPLETE_AND_EXIT], [\n\tZFS_LINUX_TEST_SRC([kthread_complete_and_exit], [\n\t\t#include <linux/kthread.h>\n\t], [\n\t\tstruct completion *completion = NULL;\n\t\tlong code = 0;\n\n\t\tkthread_complete_and_exit(completion, code);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_SRC_KTHREAD_DEQUEUE_SIGNAL_4ARG], [\n\tZFS_LINUX_TEST_SRC([kthread_dequeue_signal], [\n\t\t#include <linux/sched/signal.h>\n\t], [\n\t\tstruct task_struct *task = NULL;\n\t\tsigset_t *mask = NULL;\n\t\tkernel_siginfo_t *info = NULL;\n\t\tenum pid_type *type = NULL;\n\t\tint error __attribute__ ((unused));\n\n\t\terror = dequeue_signal(task, mask, info, type);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_KTHREAD], [\n\tZFS_AC_KERNEL_KTHREAD_COMPLETE_AND_EXIT\n\tZFS_AC_KERNEL_KTHREAD_DEQUEUE_SIGNAL_4ARG\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_SRC_KTHREAD], [\n\tZFS_AC_KERNEL_SRC_KTHREAD_COMPLETE_AND_EXIT\n\tZFS_AC_KERNEL_SRC_KTHREAD_DEQUEUE_SIGNAL_4ARG\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}