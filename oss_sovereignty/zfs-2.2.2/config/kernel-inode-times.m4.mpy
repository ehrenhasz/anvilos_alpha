{
  "module_name": "kernel-inode-times.m4",
  "hash_id": "ce32fd16c0fea3792d1f245732133823a262b3216c39c659966f0f867f828a56",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-inode-times.m4",
  "human_readable_source": "AC_DEFUN([ZFS_AC_KERNEL_SRC_INODE_TIMES], [\n\n\tdnl #\n\tdnl # 5.6 API change\n\tdnl # timespec64_trunc() replaced by timestamp_truncate() interface.\n\tdnl #\n\tZFS_LINUX_TEST_SRC([timestamp_truncate], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct timespec64 ts;\n\t\tstruct inode ip;\n\n\t\tmemset(&ts, 0, sizeof(ts));\n\t\tts = timestamp_truncate(ts, &ip);\n\t])\n\n\tdnl #\n\tdnl # 4.18 API change\n\tdnl # i_atime, i_mtime, and i_ctime changed from timespec to timespec64.\n\tdnl #\n\tZFS_LINUX_TEST_SRC([inode_times], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct inode ip;\n\t\tstruct timespec ts;\n\n\t\tmemset(&ip, 0, sizeof(ip));\n\t\tts = ip.i_mtime;\n\t])\n\n\tdnl #\n\tdnl # 6.6 API change\n\tdnl # i_ctime no longer directly accessible, must use\n\tdnl # inode_get_ctime(ip), inode_set_ctime*(ip) to\n\tdnl # read/write.\n\tdnl #\n\tZFS_LINUX_TEST_SRC([inode_get_ctime], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct inode ip;\n\n\t\tmemset(&ip, 0, sizeof(ip));\n\t\tinode_get_ctime(&ip);\n\t])\n\n\tZFS_LINUX_TEST_SRC([inode_set_ctime_to_ts], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct inode ip;\n\t\tstruct timespec64 ts = {0};\n\n\t\tmemset(&ip, 0, sizeof(ip));\n\t\tinode_set_ctime_to_ts(&ip, ts);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_INODE_TIMES], [\n\tAC_MSG_CHECKING([whether timestamp_truncate() exists])\n\tZFS_LINUX_TEST_RESULT([timestamp_truncate], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_INODE_TIMESTAMP_TRUNCATE, 1,\n\t\t    [timestamp_truncate() exists])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n\n\tAC_MSG_CHECKING([whether inode->i_*time's are timespec64])\n\tZFS_LINUX_TEST_RESULT([inode_times], [\n\t\tAC_MSG_RESULT(no)\n\t],[\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_INODE_TIMESPEC64_TIMES, 1,\n\t\t    [inode->i_*time's are timespec64])\n\t])\n\n\tAC_MSG_CHECKING([whether inode_get_ctime() exists])\n\tZFS_LINUX_TEST_RESULT([inode_get_ctime], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_INODE_GET_CTIME, 1,\n\t\t    [inode_get_ctime() exists in linux/fs.h])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n\n\tAC_MSG_CHECKING([whether inode_set_ctime_to_ts() exists])\n\tZFS_LINUX_TEST_RESULT([inode_set_ctime_to_ts], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_INODE_SET_CTIME_TO_TS, 1,\n\t\t    [inode_set_ctime_to_ts() exists in linux/fs.h])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}