{
  "module_name": "always-compiler-options.m4",
  "hash_id": "358439786e312aeba52fc8ed3456f5a60b3d7cce3f05cd70f066bb6393cc774b",
  "original_prompt": "Ingested from zfs-2.2.2/config/always-compiler-options.m4",
  "human_readable_source": "dnl #\ndnl # Enabled -fsanitize=address if supported by $CC.\ndnl #\ndnl # LDFLAGS needs -fsanitize=address at all times so libraries compiled with\ndnl # it will be linked successfully. CFLAGS will vary by binary being built.\ndnl #\ndnl # The ASAN_OPTIONS environment variable can be used to further control\ndnl # the behavior of binaries and libraries build with -fsanitize=address.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_ASAN], [\n\tAC_MSG_CHECKING([whether to build with -fsanitize=address support])\n\tAC_ARG_ENABLE([asan],\n\t\t[AS_HELP_STRING([--enable-asan],\n\t\t[Enable -fsanitize=address support  @<:@default=no@:>@])],\n\t\t[],\n\t\t[enable_asan=no])\n\n\tAM_CONDITIONAL([ASAN_ENABLED], [test x$enable_asan = xyes])\n\tAC_SUBST([ASAN_ENABLED], [$enable_asan])\n\tAC_MSG_RESULT($enable_asan)\n\n\tAS_IF([ test \"$enable_asan\" = \"yes\" ], [\n\t\tAC_MSG_CHECKING([whether $CC supports -fsanitize=address])\n\t\tsaved_cflags=\"$CFLAGS\"\n\t\tCFLAGS=\"$CFLAGS -Werror -fsanitize=address\"\n\t\tAC_LINK_IFELSE([\n\t\t\tAC_LANG_SOURCE([[ int main() { return 0; } ]])\n\t\t], [\n\t\t\tASAN_CFLAGS=\"-fsanitize=address\"\n\t\t\tASAN_LDFLAGS=\"-fsanitize=address\"\n\t\t\tASAN_ZFS=\"_with_asan\"\n\t\t\tAC_MSG_RESULT([yes])\n\t\t], [\n\t\t\tAC_MSG_ERROR([$CC does not support -fsanitize=address])\n\t\t])\n\t\tCFLAGS=\"$saved_cflags\"\n\t], [\n\t\tASAN_CFLAGS=\"\"\n\t\tASAN_LDFLAGS=\"\"\n\t\tASAN_ZFS=\"_without_asan\"\n\t])\n\n\tAC_SUBST([ASAN_CFLAGS])\n\tAC_SUBST([ASAN_LDFLAGS])\n\tAC_SUBST([ASAN_ZFS])\n])\n\ndnl #\ndnl # Enabled -fsanitize=undefined if supported by cc.\ndnl #\ndnl # LDFLAGS needs -fsanitize=undefined at all times so libraries compiled with\ndnl # it will be linked successfully. CFLAGS will vary by binary being built.\ndnl #\ndnl # The UBSAN_OPTIONS environment variable can be used to further control\ndnl # the behavior of binaries and libraries build with -fsanitize=undefined.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_UBSAN], [\n\tAC_MSG_CHECKING([whether to build with -fsanitize=undefined support])\n\tAC_ARG_ENABLE([ubsan],\n\t\t[AS_HELP_STRING([--enable-ubsan],\n\t\t[Enable -fsanitize=undefined support  @<:@default=no@:>@])],\n\t\t[],\n\t\t[enable_ubsan=no])\n\n\tAM_CONDITIONAL([UBSAN_ENABLED], [test x$enable_ubsan = xyes])\n\tAC_SUBST([UBSAN_ENABLED], [$enable_ubsan])\n\tAC_MSG_RESULT($enable_ubsan)\n\n\tAS_IF([ test \"$enable_ubsan\" = \"yes\" ], [\n\t\tAC_MSG_CHECKING([whether $CC supports -fsanitize=undefined])\n\t\tsaved_cflags=\"$CFLAGS\"\n\t\tCFLAGS=\"$CFLAGS -Werror -fsanitize=undefined\"\n\t\tAC_LINK_IFELSE([\n\t\t\tAC_LANG_SOURCE([[ int main() { return 0; } ]])\n\t\t], [\n\t\t\tUBSAN_CFLAGS=\"-fsanitize=undefined\"\n\t\t\tUBSAN_LDFLAGS=\"-fsanitize=undefined\"\n\t\t\tUBSAN_ZFS=\"_with_ubsan\"\n\t\t\tAC_MSG_RESULT([yes])\n\t\t], [\n\t\t\tAC_MSG_ERROR([$CC does not support -fsanitize=undefined])\n\t\t])\n\t\tCFLAGS=\"$saved_cflags\"\n\t], [\n\t\tUBSAN_CFLAGS=\"\"\n\t\tUBSAN_LDFLAGS=\"\"\n\t\tUBSAN_ZFS=\"_without_ubsan\"\n\t])\n\n\tAC_SUBST([UBSAN_CFLAGS])\n\tAC_SUBST([UBSAN_LDFLAGS])\n\tAC_SUBST([UBSAN_ZFS])\n])\n\ndnl #\ndnl # Check if cc supports -Wframe-larger-than=<size> option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_FRAME_LARGER_THAN], [\n\tAC_MSG_CHECKING([whether $CC supports -Wframe-larger-than=<size>])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wframe-larger-than=4096\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tFRAME_LARGER_THAN=\"-Wframe-larger-than=4096\"\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tFRAME_LARGER_THAN=\"\"\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([FRAME_LARGER_THAN])\n])\n\ndnl #\ndnl # Check if cc supports -Wno-format-truncation option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_FORMAT_TRUNCATION], [\n\tAC_MSG_CHECKING([whether $CC supports -Wno-format-truncation])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wno-format-truncation\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tNO_FORMAT_TRUNCATION=-Wno-format-truncation\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tNO_FORMAT_TRUNCATION=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([NO_FORMAT_TRUNCATION])\n])\n\ndnl #\ndnl # Check if cc supports -Wno-format-zero-length option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_FORMAT_ZERO_LENGTH], [\n\tAC_MSG_CHECKING([whether $CC supports -Wno-format-zero-length])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wno-format-zero-length\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tNO_FORMAT_ZERO_LENGTH=-Wno-format-zero-length\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tNO_FORMAT_ZERO_LENGTH=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([NO_FORMAT_ZERO_LENGTH])\n])\n\ndnl #\ndnl # Check if cc supports -Wno-clobbered option.\ndnl #\ndnl # We actually invoke it with the -Wclobbered option\ndnl # and infer the 'no-' version does or doesn't exist based upon\ndnl # the results.  This is required because when checking any of\ndnl # no- prefixed options gcc always returns success.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_CLOBBERED], [\n\tAC_MSG_CHECKING([whether $CC supports -Wno-clobbered])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wclobbered\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tNO_CLOBBERED=-Wno-clobbered\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tNO_CLOBBERED=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([NO_CLOBBERED])\n])\n\ndnl #\ndnl # Check if cc supports -Wimplicit-fallthrough option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_IMPLICIT_FALLTHROUGH], [\n\tAC_MSG_CHECKING([whether $CC supports -Wimplicit-fallthrough])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wimplicit-fallthrough\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tIMPLICIT_FALLTHROUGH=-Wimplicit-fallthrough\n\t\tAC_DEFINE([HAVE_IMPLICIT_FALLTHROUGH], 1,\n\t\t\t[Define if compiler supports -Wimplicit-fallthrough])\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tIMPLICIT_FALLTHROUGH=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([IMPLICIT_FALLTHROUGH])\n])\n\ndnl #\ndnl # Check if cc supports -Winfinite-recursion option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_INFINITE_RECURSION], [\n\tAC_MSG_CHECKING([whether $CC supports -Winfinite-recursion])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Winfinite-recursion\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tINFINITE_RECURSION=-Winfinite-recursion\n\t\tAC_DEFINE([HAVE_INFINITE_RECURSION], 1,\n\t\t\t[Define if compiler supports -Winfinite-recursion])\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tINFINITE_RECURSION=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([INFINITE_RECURSION])\n])\n\ndnl #\ndnl # Check if kernel cc supports -Winfinite-recursion option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_KERNEL_CC_INFINITE_RECURSION], [\n\tAC_MSG_CHECKING([whether $KERNEL_CC supports -Winfinite-recursion])\n\n\tsaved_cc=\"$CC\"\n\tsaved_flags=\"$CFLAGS\"\n\tCC=\"gcc\"\n\tCFLAGS=\"$CFLAGS -Werror -Winfinite-recursion\"\n\n\tAS_IF([ test -n \"$KERNEL_CC\" ], [\n\t\tCC=\"$KERNEL_CC\"\n\t])\n\tAS_IF([ test -n \"$KERNEL_LLVM\" ], [\n\t\tCC=\"clang\"\n\t])\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tKERNEL_INFINITE_RECURSION=-Winfinite-recursion\n\t\tAC_DEFINE([HAVE_KERNEL_INFINITE_RECURSION], 1,\n\t\t\t[Define if compiler supports -Winfinite-recursion])\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tKERNEL_INFINITE_RECURSION=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCC=\"$saved_cc\"\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([KERNEL_INFINITE_RECURSION])\n])\n\ndnl #\ndnl # Check if cc supports -Wformat-overflow option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_FORMAT_OVERFLOW], [\n\tAC_MSG_CHECKING([whether $CC supports -Wformat-overflow])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -Wformat-overflow\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tFORMAT_OVERFLOW=-Wformat-overflow\n\t\tAC_DEFINE([HAVE_FORMAT_OVERFLOW], 1,\n\t\t\t[Define if compiler supports -Wformat-overflow])\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tFORMAT_OVERFLOW=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([FORMAT_OVERFLOW])\n])\n\ndnl #\ndnl # Check if cc supports -fno-omit-frame-pointer option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_OMIT_FRAME_POINTER], [\n\tAC_MSG_CHECKING([whether $CC supports -fno-omit-frame-pointer])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -fno-omit-frame-pointer\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tNO_OMIT_FRAME_POINTER=-fno-omit-frame-pointer\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tNO_OMIT_FRAME_POINTER=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([NO_OMIT_FRAME_POINTER])\n])\n\ndnl #\ndnl # Check if cc supports -fno-ipa-sra option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_IPA_SRA], [\n\tAC_MSG_CHECKING([whether $CC supports -fno-ipa-sra])\n\n\tsaved_flags=\"$CFLAGS\"\n\tCFLAGS=\"$CFLAGS -Werror -fno-ipa-sra\"\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tNO_IPA_SRA=-fno-ipa-sra\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tNO_IPA_SRA=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([NO_IPA_SRA])\n])\n\ndnl #\ndnl # Check if kernel cc supports -fno-ipa-sra option.\ndnl #\nAC_DEFUN([ZFS_AC_CONFIG_ALWAYS_KERNEL_CC_NO_IPA_SRA], [\n\tAC_MSG_CHECKING([whether $KERNEL_CC supports -fno-ipa-sra])\n\n\tsaved_cc=\"$CC\"\n\tsaved_flags=\"$CFLAGS\"\n\tCC=\"gcc\"\n\tCFLAGS=\"$CFLAGS -Werror -fno-ipa-sra\"\n\n\tAS_IF([ test -n \"$KERNEL_CC\" ], [\n\t\tCC=\"$KERNEL_CC\"\n\t])\n\tAS_IF([ test -n \"$KERNEL_LLVM\" ], [\n\t\tCC=\"clang\"\n\t])\n\n\tAC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [\n\t\tKERNEL_NO_IPA_SRA=-fno-ipa-sra\n\t\tAC_MSG_RESULT([yes])\n\t], [\n\t\tKERNEL_NO_IPA_SRA=\n\t\tAC_MSG_RESULT([no])\n\t])\n\n\tCC=\"$saved_cc\"\n\tCFLAGS=\"$saved_flags\"\n\tAC_SUBST([KERNEL_NO_IPA_SRA])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}