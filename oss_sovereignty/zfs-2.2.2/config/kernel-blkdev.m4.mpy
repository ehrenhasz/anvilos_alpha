{
  "module_name": "kernel-blkdev.m4",
  "hash_id": "60bcf2452f705aae34749bc0fbdfd35fb936e3711f36fcf6473b70e82e09f599",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-blkdev.m4",
  "human_readable_source": "dnl #\ndnl # 2.6.38 API change,\ndnl # Added blkdev_get_by_path()\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_GET_BY_PATH], [\n\tZFS_LINUX_TEST_SRC([blkdev_get_by_path], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev __attribute__ ((unused)) = NULL;\n\t\tconst char *path = \"path\";\n\t\tfmode_t mode = 0;\n\t\tvoid *holder = NULL;\n\n\t\tbdev = blkdev_get_by_path(path, mode, holder);\n\t])\n])\n\ndnl #\ndnl # 6.5.x API change,\ndnl # blkdev_get_by_path() takes 4 args\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_GET_BY_PATH_4ARG], [\n\tZFS_LINUX_TEST_SRC([blkdev_get_by_path_4arg], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev __attribute__ ((unused)) = NULL;\n\t\tconst char *path = \"path\";\n\t\tfmode_t mode = 0;\n\t\tvoid *holder = NULL;\n\t\tstruct blk_holder_ops h;\n\n\t\tbdev = blkdev_get_by_path(path, mode, holder, &h);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_GET_BY_PATH], [\n\tAC_MSG_CHECKING([whether blkdev_get_by_path() exists and takes 3 args])\n\tZFS_LINUX_TEST_RESULT([blkdev_get_by_path], [\n\t\tAC_MSG_RESULT(yes)\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t\tAC_MSG_CHECKING([whether blkdev_get_by_path() exists and takes 4 args])\n\t\tZFS_LINUX_TEST_RESULT([blkdev_get_by_path_4arg], [\n\t\t\tAC_DEFINE(HAVE_BLKDEV_GET_BY_PATH_4ARG, 1,\n\t\t\t\t[blkdev_get_by_path() exists and takes 4 args])\n\t\t\tAC_MSG_RESULT(yes)\n\t\t], [\n\t\t\tZFS_LINUX_TEST_ERROR([blkdev_get_by_path()])\n\t\t])\n\t])\n])\n\ndnl #\ndnl # 6.5.x API change\ndnl # blk_mode_t was added as a type to supercede some places where fmode_t\ndnl # is used\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BLK_MODE_T], [\n\tZFS_LINUX_TEST_SRC([blk_mode_t], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tblk_mode_t m __attribute((unused)) = (blk_mode_t)0;\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BLK_MODE_T], [\n\tAC_MSG_CHECKING([whether blk_mode_t is defined])\n\tZFS_LINUX_TEST_RESULT([blk_mode_t], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BLK_MODE_T, 1, [blk_mode_t is defined])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 2.6.38 API change,\ndnl # Added blkdev_put()\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_PUT], [\n\tZFS_LINUX_TEST_SRC([blkdev_put], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tfmode_t mode = 0;\n\n\t\tblkdev_put(bdev, mode);\n\t])\n])\n\ndnl #\ndnl # 6.5.x API change.\ndnl # blkdev_put() takes (void* holder) as arg 2\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_PUT_HOLDER], [\n\tZFS_LINUX_TEST_SRC([blkdev_put_holder], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tvoid *holder = NULL;\n\n\t\tblkdev_put(bdev, holder);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_PUT], [\n\tAC_MSG_CHECKING([whether blkdev_put() exists])\n\tZFS_LINUX_TEST_RESULT([blkdev_put], [\n\t\tAC_MSG_RESULT(yes)\n\t], [\n\t\tAC_MSG_CHECKING([whether blkdev_put() accepts void* as arg 2])\n\t\tZFS_LINUX_TEST_RESULT([blkdev_put_holder], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_BLKDEV_PUT_HOLDER, 1,\n\t\t\t\t[blkdev_put() accepts void* as arg 2])\n\t\t], [\n\t\t\tZFS_LINUX_TEST_ERROR([blkdev_put()])\n\t\t])\n\t])\n])\n\ndnl #\ndnl # 4.1 API, exported blkdev_reread_part() symbol, back ported to the\ndnl # 3.10.0 CentOS 7.x enterprise kernels.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_REREAD_PART], [\n\tZFS_LINUX_TEST_SRC([blkdev_reread_part], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tint error;\n\n\t\terror = blkdev_reread_part(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_REREAD_PART], [\n\tAC_MSG_CHECKING([whether blkdev_reread_part() exists])\n\tZFS_LINUX_TEST_RESULT([blkdev_reread_part], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BLKDEV_REREAD_PART, 1,\n\t\t    [blkdev_reread_part() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # check_disk_change() was removed in 5.10\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_CHECK_DISK_CHANGE], [\n\tZFS_LINUX_TEST_SRC([check_disk_change], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tbool error;\n\n\t\terror = check_disk_change(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_CHECK_DISK_CHANGE], [\n\tAC_MSG_CHECKING([whether check_disk_change() exists])\n\tZFS_LINUX_TEST_RESULT([check_disk_change], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_CHECK_DISK_CHANGE, 1,\n\t\t    [check_disk_change() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 6.5.x API change\ndnl # disk_check_media_change() was added\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_DISK_CHECK_MEDIA_CHANGE], [\n\tZFS_LINUX_TEST_SRC([disk_check_media_change], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tbool error;\n\n\t\terror = disk_check_media_change(bdev->bd_disk);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_DISK_CHECK_MEDIA_CHANGE], [\n\tAC_MSG_CHECKING([whether disk_check_media_change() exists])\n\tZFS_LINUX_TEST_RESULT([disk_check_media_change], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_DISK_CHECK_MEDIA_CHANGE, 1,\n\t\t    [disk_check_media_change() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # bdev_kobj() is introduced from 5.12\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEV_KOBJ], [\n\tZFS_LINUX_TEST_SRC([bdev_kobj], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t\t#include <linux/kobject.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tstruct kobject *disk_kobj;\n\t\tdisk_kobj = bdev_kobj(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEV_KOBJ], [\n\tAC_MSG_CHECKING([whether bdev_kobj() exists])\n\tZFS_LINUX_TEST_RESULT([bdev_kobj], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BDEV_KOBJ, 1,\n\t\t    [bdev_kobj() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # part_to_dev() was removed in 5.12\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_PART_TO_DEV], [\n\tZFS_LINUX_TEST_SRC([part_to_dev], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct hd_struct *p = NULL;\n\t\tstruct device *pdev;\n\t\tpdev = part_to_dev(p);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_PART_TO_DEV], [\n\tAC_MSG_CHECKING([whether part_to_dev() exists])\n\tZFS_LINUX_TEST_RESULT([part_to_dev], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_PART_TO_DEV, 1,\n\t\t    [part_to_dev() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 5.10 API, check_disk_change() is removed, in favor of\ndnl # bdev_check_media_change(), which doesn't force revalidation\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEV_CHECK_MEDIA_CHANGE], [\n\tZFS_LINUX_TEST_SRC([bdev_check_media_change], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev = NULL;\n\t\tint error;\n\n\t\terror = bdev_check_media_change(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEV_CHECK_MEDIA_CHANGE], [\n\tAC_MSG_CHECKING([whether bdev_check_media_change() exists])\n\tZFS_LINUX_TEST_RESULT([bdev_check_media_change], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BDEV_CHECK_MEDIA_CHANGE, 1,\n\t\t    [bdev_check_media_change() exists])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 2.6.22 API change\ndnl # Single argument invalidate_bdev()\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_INVALIDATE_BDEV], [\n\tZFS_LINUX_TEST_SRC([invalidate_bdev], [\n\t\t#include <linux/buffer_head.h>\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev = NULL;\n\t\tinvalidate_bdev(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_INVALIDATE_BDEV], [\n\tAC_MSG_CHECKING([whether invalidate_bdev() exists])\n\tZFS_LINUX_TEST_RESULT([invalidate_bdev], [\n\t\tAC_MSG_RESULT(yes)\n\t],[\n\t\tZFS_LINUX_TEST_ERROR([invalidate_bdev()])\n\t])\n])\n\ndnl #\ndnl # 5.11 API, lookup_bdev() takes dev_t argument.\ndnl # 2.6.27 API, lookup_bdev() was first exported.\ndnl # 4.4.0-6.21 API, lookup_bdev() on Ubuntu takes mode argument.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_LOOKUP_BDEV], [\n\tZFS_LINUX_TEST_SRC([lookup_bdev_devt], [\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tint error __attribute__ ((unused));\n\t\tconst char path[] = \"/example/path\";\n\t\tdev_t dev;\n\n\t\terror = lookup_bdev(path, &dev);\n\t])\n\n\tZFS_LINUX_TEST_SRC([lookup_bdev_1arg], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev __attribute__ ((unused));\n\t\tconst char path[] = \"/example/path\";\n\n\t\tbdev = lookup_bdev(path);\n\t])\n\n\tZFS_LINUX_TEST_SRC([lookup_bdev_mode], [\n\t\t#include <linux/fs.h>\n\t], [\n\t\tstruct block_device *bdev __attribute__ ((unused));\n\t\tconst char path[] = \"/example/path\";\n\n\t\tbdev = lookup_bdev(path, FMODE_READ);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_LOOKUP_BDEV], [\n\tAC_MSG_CHECKING([whether lookup_bdev() wants dev_t arg])\n\tZFS_LINUX_TEST_RESULT_SYMBOL([lookup_bdev_devt],\n\t    [lookup_bdev], [fs/block_dev.c], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_DEVT_LOOKUP_BDEV, 1,\n\t\t    [lookup_bdev() wants dev_t arg])\n\t], [\n\t\tAC_MSG_RESULT(no)\n\n\t\tAC_MSG_CHECKING([whether lookup_bdev() wants 1 arg])\n\t\tZFS_LINUX_TEST_RESULT_SYMBOL([lookup_bdev_1arg],\n\t\t    [lookup_bdev], [fs/block_dev.c], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_1ARG_LOOKUP_BDEV, 1,\n\t\t\t    [lookup_bdev() wants 1 arg])\n\t\t], [\n\t\t\tAC_MSG_RESULT(no)\n\n\t\t\tAC_MSG_CHECKING([whether lookup_bdev() wants mode arg])\n\t\t\tZFS_LINUX_TEST_RESULT_SYMBOL([lookup_bdev_mode],\n\t\t\t    [lookup_bdev], [fs/block_dev.c], [\n\t\t\t\tAC_MSG_RESULT(yes)\n\t\t\t\tAC_DEFINE(HAVE_MODE_LOOKUP_BDEV, 1,\n\t\t\t\t    [lookup_bdev() wants mode arg])\n\t\t\t], [\n\t\t\t\tZFS_LINUX_TEST_ERROR([lookup_bdev()])\n\t\t\t])\n\t\t])\n\t])\n])\n\ndnl #\ndnl # 2.6.30 API change\ndnl #\ndnl # The bdev_physical_block_size() interface was added to provide a way\ndnl # to determine the smallest write which can be performed without a\ndnl # read-modify-write operation.\ndnl #\ndnl # Unfortunately, this interface isn't entirely reliable because\ndnl # drives are sometimes known to misreport this value.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEV_PHYSICAL_BLOCK_SIZE], [\n\tZFS_LINUX_TEST_SRC([bdev_physical_block_size], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev __attribute__ ((unused)) = NULL;\n\t\tbdev_physical_block_size(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEV_PHYSICAL_BLOCK_SIZE], [\n\tAC_MSG_CHECKING([whether bdev_physical_block_size() is available])\n\tZFS_LINUX_TEST_RESULT([bdev_physical_block_size], [\n\t\tAC_MSG_RESULT(yes)\n\t],[\n\t\tZFS_LINUX_TEST_ERROR([bdev_physical_block_size()])\n\t])\n])\n\ndnl #\ndnl # 2.6.30 API change\ndnl # Added bdev_logical_block_size().\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEV_LOGICAL_BLOCK_SIZE], [\n\tZFS_LINUX_TEST_SRC([bdev_logical_block_size], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev __attribute__ ((unused)) = NULL;\n\t\tbdev_logical_block_size(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEV_LOGICAL_BLOCK_SIZE], [\n\tAC_MSG_CHECKING([whether bdev_logical_block_size() is available])\n\tZFS_LINUX_TEST_RESULT([bdev_logical_block_size], [\n\t\tAC_MSG_RESULT(yes)\n\t],[\n\t\tZFS_LINUX_TEST_ERROR([bdev_logical_block_size()])\n\t])\n])\n\ndnl #\ndnl # 5.11 API change\ndnl # Added bdev_whole() helper.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEV_WHOLE], [\n\tZFS_LINUX_TEST_SRC([bdev_whole], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev = NULL;\n\t\tbdev = bdev_whole(bdev);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEV_WHOLE], [\n\tAC_MSG_CHECKING([whether bdev_whole() is available])\n\tZFS_LINUX_TEST_RESULT([bdev_whole], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BDEV_WHOLE, 1, [bdev_whole() is available])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 5.20 API change,\ndnl # Removed bdevname(), snprintf(.., %pg) should be used.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BDEVNAME], [\n\tZFS_LINUX_TEST_SRC([bdevname], [\n\t\t#include <linux/fs.h>\n\t\t#include <linux/blkdev.h>\n\t], [\n\t\tstruct block_device *bdev __attribute__ ((unused)) = NULL;\n\t\tchar path[BDEVNAME_SIZE];\n\n\t\t(void) bdevname(bdev, path);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BDEVNAME], [\n\tAC_MSG_CHECKING([whether bdevname() exists])\n\tZFS_LINUX_TEST_RESULT([bdevname], [\n\t\tAC_DEFINE(HAVE_BDEVNAME, 1, [bdevname() is available])\n\t\tAC_MSG_RESULT(yes)\n\t], [\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 5.19 API: blkdev_issue_secure_erase()\ndnl # 3.10 API: blkdev_issue_discard(..., BLKDEV_DISCARD_SECURE)\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_ISSUE_SECURE_ERASE], [\n\tZFS_LINUX_TEST_SRC([blkdev_issue_secure_erase], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev = NULL;\n\t\tsector_t sector = 0;\n\t\tsector_t nr_sects = 0;\n\t\tint error __attribute__ ((unused));\n\n\t\terror = blkdev_issue_secure_erase(bdev,\n\t\t    sector, nr_sects, GFP_KERNEL);\n\t])\n\n\tZFS_LINUX_TEST_SRC([blkdev_issue_discard_flags], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tstruct block_device *bdev = NULL;\n\t\tsector_t sector = 0;\n\t\tsector_t nr_sects = 0;\n\t\tunsigned long flags = 0;\n\t\tint error __attribute__ ((unused));\n\n\t\terror = blkdev_issue_discard(bdev,\n\t\t    sector, nr_sects, GFP_KERNEL, flags);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_ISSUE_SECURE_ERASE], [\n\tAC_MSG_CHECKING([whether blkdev_issue_secure_erase() is available])\n\tZFS_LINUX_TEST_RESULT([blkdev_issue_secure_erase], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BLKDEV_ISSUE_SECURE_ERASE, 1,\n\t\t    [blkdev_issue_secure_erase() is available])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\n\t\tAC_MSG_CHECKING([whether blkdev_issue_discard() is available])\n\t\tZFS_LINUX_TEST_RESULT([blkdev_issue_discard_flags], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_BLKDEV_ISSUE_DISCARD, 1,\n\t\t\t    [blkdev_issue_discard() is available])\n\t\t],[\n\t\t\tZFS_LINUX_TEST_ERROR([blkdev_issue_discard()])\n\t\t])\n\t])\n])\n\ndnl #\ndnl # 5.13 API change\ndnl # blkdev_get_by_path() no longer handles ERESTARTSYS\ndnl #\ndnl # Unfortunately we're forced to rely solely on the kernel version\ndnl # number in order to determine the expected behavior.  This was an\ndnl # internal change to blkdev_get_by_dev(), see commit a8ed1a0607.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_GET_ERESTARTSYS], [\n\tAC_MSG_CHECKING([whether blkdev_get_by_path() handles ERESTARTSYS])\n\tAS_VERSION_COMPARE([$LINUX_VERSION], [5.13.0], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_BLKDEV_GET_ERESTARTSYS, 1,\n\t\t\t[blkdev_get_by_path() handles ERESTARTSYS])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # 6.5.x API change\ndnl # BLK_STS_NEXUS replaced with BLK_STS_RESV_CONFLICT\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV_BLK_STS_RESV_CONFLICT], [\n\tZFS_LINUX_TEST_SRC([blk_sts_resv_conflict], [\n\t\t#include <linux/blkdev.h>\n\t],[\n\t\tblk_status_t s __attribute__ ((unused)) = BLK_STS_RESV_CONFLICT;\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV_BLK_STS_RESV_CONFLICT], [\n\tAC_MSG_CHECKING([whether BLK_STS_RESV_CONFLICT is defined])\n\t\tZFS_LINUX_TEST_RESULT([blk_sts_resv_conflict], [\n\t\t\tAC_DEFINE(HAVE_BLK_STS_RESV_CONFLICT, 1, [BLK_STS_RESV_CONFLICT is defined])\n\t\t\tAC_MSG_RESULT(yes)\n\t\t], [\n\t\t\tAC_MSG_RESULT(no)\n\t\t])\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_SRC_BLKDEV], [\n\tZFS_AC_KERNEL_SRC_BLKDEV_GET_BY_PATH\n\tZFS_AC_KERNEL_SRC_BLKDEV_GET_BY_PATH_4ARG\n\tZFS_AC_KERNEL_SRC_BLKDEV_PUT\n\tZFS_AC_KERNEL_SRC_BLKDEV_PUT_HOLDER\n\tZFS_AC_KERNEL_SRC_BLKDEV_REREAD_PART\n\tZFS_AC_KERNEL_SRC_BLKDEV_INVALIDATE_BDEV\n\tZFS_AC_KERNEL_SRC_BLKDEV_LOOKUP_BDEV\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEV_LOGICAL_BLOCK_SIZE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEV_PHYSICAL_BLOCK_SIZE\n\tZFS_AC_KERNEL_SRC_BLKDEV_CHECK_DISK_CHANGE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEV_CHECK_MEDIA_CHANGE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEV_WHOLE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEVNAME\n\tZFS_AC_KERNEL_SRC_BLKDEV_ISSUE_SECURE_ERASE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BDEV_KOBJ\n\tZFS_AC_KERNEL_SRC_BLKDEV_PART_TO_DEV\n\tZFS_AC_KERNEL_SRC_BLKDEV_DISK_CHECK_MEDIA_CHANGE\n\tZFS_AC_KERNEL_SRC_BLKDEV_BLK_STS_RESV_CONFLICT\n\tZFS_AC_KERNEL_SRC_BLKDEV_BLK_MODE_T\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_BLKDEV], [\n\tZFS_AC_KERNEL_BLKDEV_GET_BY_PATH\n\tZFS_AC_KERNEL_BLKDEV_PUT\n\tZFS_AC_KERNEL_BLKDEV_REREAD_PART\n\tZFS_AC_KERNEL_BLKDEV_INVALIDATE_BDEV\n\tZFS_AC_KERNEL_BLKDEV_LOOKUP_BDEV\n\tZFS_AC_KERNEL_BLKDEV_BDEV_LOGICAL_BLOCK_SIZE\n\tZFS_AC_KERNEL_BLKDEV_BDEV_PHYSICAL_BLOCK_SIZE\n\tZFS_AC_KERNEL_BLKDEV_CHECK_DISK_CHANGE\n\tZFS_AC_KERNEL_BLKDEV_BDEV_CHECK_MEDIA_CHANGE\n\tZFS_AC_KERNEL_BLKDEV_BDEV_WHOLE\n\tZFS_AC_KERNEL_BLKDEV_BDEVNAME\n\tZFS_AC_KERNEL_BLKDEV_GET_ERESTARTSYS\n\tZFS_AC_KERNEL_BLKDEV_ISSUE_SECURE_ERASE\n\tZFS_AC_KERNEL_BLKDEV_BDEV_KOBJ\n\tZFS_AC_KERNEL_BLKDEV_PART_TO_DEV\n\tZFS_AC_KERNEL_BLKDEV_DISK_CHECK_MEDIA_CHANGE\n\tZFS_AC_KERNEL_BLKDEV_BLK_STS_RESV_CONFLICT\n\tZFS_AC_KERNEL_BLKDEV_BLK_MODE_T\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}