{
  "module_name": "kernel-objtool.m4",
  "hash_id": "af46c25c0bccdfdf856d227911de6faa789e68aceb74877bdb3702c7f72842e0",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-objtool.m4",
  "human_readable_source": "dnl #\ndnl # Detect objtool functionality.\ndnl #\n\ndnl #\ndnl # Kernel 5.10: linux/frame.h was renamed linux/objtool.h\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_OBJTOOL_HEADER], [\n\tAC_MSG_CHECKING([whether objtool header is available])\n\tZFS_LINUX_TRY_COMPILE([\n\t\t#include <linux/objtool.h>\n\t],[\n\t],[\n\t\tAC_DEFINE(HAVE_KERNEL_OBJTOOL_HEADER, 1,\n\t\t    [kernel has linux/objtool.h])\n\t\tAC_MSG_RESULT(linux/objtool.h)\n\t],[\n\t\tAC_MSG_RESULT(linux/frame.h)\n\t])\n])\n\ndnl #\ndnl # Check for objtool support.\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_OBJTOOL], [\n\n\tdnl # 4.6 API for compile-time stack validation\n\tZFS_LINUX_TEST_SRC([objtool], [\n\t\t#undef __ASSEMBLY__\n\t\t#include <asm/ptrace.h>\n\t\t#include <asm/frame.h>\n\t],[\n\t\t#if !defined(FRAME_BEGIN)\n\t\t#error \"FRAME_BEGIN is not defined\"\n\t\t#endif\n\t])\n\n\tdnl # 4.6 API added STACK_FRAME_NON_STANDARD macro\n\tZFS_LINUX_TEST_SRC([stack_frame_non_standard], [\n\t\t#ifdef HAVE_KERNEL_OBJTOOL_HEADER\n\t\t#include <linux/objtool.h>\n\t\t#else\n\t\t#include <linux/frame.h>\n\t\t#endif\n\t],[\n\t\t#if !defined(STACK_FRAME_NON_STANDARD)\n\t\t#error \"STACK_FRAME_NON_STANDARD is not defined.\"\n\t\t#endif\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_OBJTOOL], [\n\tAC_MSG_CHECKING(\n\t    [whether compile-time stack validation (objtool) is available])\n\tZFS_LINUX_TEST_RESULT([objtool], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_KERNEL_OBJTOOL, 1,\n\t\t    [kernel does stack verification])\n\n\t\tAC_MSG_CHECKING([whether STACK_FRAME_NON_STANDARD is defined])\n\t\tZFS_LINUX_TEST_RESULT([stack_frame_non_standard], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_STACK_FRAME_NON_STANDARD, 1,\n\t\t\t   [STACK_FRAME_NON_STANDARD is defined])\n\t\t],[\n\t\t\tAC_MSG_RESULT(no)\n\t\t])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}