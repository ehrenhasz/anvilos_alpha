{
  "module_name": "kernel-vfs-rw-iterate.m4",
  "hash_id": "7778c2b31aa6fa051e2d81a378e51c08728ab1f4379c98465f5d89e459333b33",
  "original_prompt": "Ingested from zfs-2.2.2/config/kernel-vfs-rw-iterate.m4",
  "human_readable_source": "dnl #\ndnl # Linux 3.16 API\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_VFS_RW_ITERATE], [\n\tZFS_LINUX_TEST_SRC([file_operations_rw], [\n\t\t#include <linux/fs.h>\n\n\t\tssize_t test_read(struct kiocb *kiocb, struct iov_iter *to)\n\t\t    { return 0; }\n\t\tssize_t test_write(struct kiocb *kiocb, struct iov_iter *from)\n\t\t    { return 0; }\n\n\t\tstatic const struct file_operations\n\t\t    fops __attribute__ ((unused)) = {\n\t\t    .read_iter = test_read,\n\t\t    .write_iter = test_write,\n\t\t};\n\t],[])\n\n\tZFS_LINUX_TEST_SRC([new_sync_rw], [\n\t\t#include <linux/fs.h>\n\t],[\n\t        ssize_t ret __attribute__ ((unused));\n\t\tstruct file *filp = NULL;\n\t\tchar __user *rbuf = NULL;\n\t\tconst char __user *wbuf = NULL;\n\t\tsize_t len = 0;\n\t\tloff_t ppos;\n\n\t\tret = new_sync_read(filp, rbuf, len, &ppos);\n\t\tret = new_sync_write(filp, wbuf, len, &ppos);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_VFS_RW_ITERATE], [\n\tAC_MSG_CHECKING([whether fops->read/write_iter() are available])\n\tZFS_LINUX_TEST_RESULT([file_operations_rw], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_VFS_RW_ITERATE, 1,\n\t\t    [fops->read/write_iter() are available])\n\n\t\tdnl #\n\t\tdnl # Linux 4.1 API\n\t\tdnl #\n\t\tAC_MSG_CHECKING([whether new_sync_read/write() are available])\n\t\tZFS_LINUX_TEST_RESULT([new_sync_rw], [\n\t\t\tAC_MSG_RESULT(yes)\n\t\t\tAC_DEFINE(HAVE_NEW_SYNC_READ, 1,\n\t\t\t    [new_sync_read()/new_sync_write() are available])\n\t\t],[\n\t\t\tAC_MSG_RESULT(no)\n\t\t])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n\ndnl #\ndnl # Linux 4.1.x API\ndnl #\nAC_DEFUN([ZFS_AC_KERNEL_SRC_VFS_GENERIC_WRITE_CHECKS], [\n\tZFS_LINUX_TEST_SRC([generic_write_checks], [\n\t\t#include <linux/fs.h>\n\t],[\n\t\tstruct kiocb *iocb = NULL;\n\t\tstruct iov_iter *iov = NULL;\n\t\tgeneric_write_checks(iocb, iov);\n\t])\n])\n\nAC_DEFUN([ZFS_AC_KERNEL_VFS_GENERIC_WRITE_CHECKS], [\n\tAC_MSG_CHECKING([whether generic_write_checks() takes kiocb])\n\tZFS_LINUX_TEST_RESULT([generic_write_checks], [\n\t\tAC_MSG_RESULT(yes)\n\t\tAC_DEFINE(HAVE_GENERIC_WRITE_CHECKS_KIOCB, 1,\n\t\t    [generic_write_checks() takes kiocb])\n\t],[\n\t\tAC_MSG_RESULT(no)\n\t])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}