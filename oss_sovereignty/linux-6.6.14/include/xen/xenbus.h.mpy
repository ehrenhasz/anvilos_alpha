{
  "module_name": "xenbus.h",
  "hash_id": "8aa5cc259eac541a4db9a6a8289e06106e7e62c992ed84dc8dc4f890a0a203d0",
  "original_prompt": "Ingested from linux-6.6.14/include/xen/xenbus.h",
  "human_readable_source": " \n\n#ifndef _XEN_XENBUS_H\n#define _XEN_XENBUS_H\n\n#include <linux/device.h>\n#include <linux/notifier.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n#include <linux/completion.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/semaphore.h>\n#include <xen/interface/xen.h>\n#include <xen/interface/grant_table.h>\n#include <xen/interface/io/xenbus.h>\n#include <xen/interface/io/xs_wire.h>\n#include <xen/interface/event_channel.h>\n\n#define XENBUS_MAX_RING_GRANT_ORDER 4\n#define XENBUS_MAX_RING_GRANTS      (1U << XENBUS_MAX_RING_GRANT_ORDER)\n\n \nstruct xenbus_watch\n{\n\tstruct list_head list;\n\n\t \n\tconst char *node;\n\n\tunsigned int nr_pending;\n\n\t \n\tbool (*will_handle)(struct xenbus_watch *,\n\t\t\t      const char *path, const char *token);\n\n\t \n\tvoid (*callback)(struct xenbus_watch *,\n\t\t\t const char *path, const char *token);\n};\n\n\n \nstruct xenbus_device {\n\tconst char *devicetype;\n\tconst char *nodename;\n\tconst char *otherend;\n\tint otherend_id;\n\tstruct xenbus_watch otherend_watch;\n\tstruct device dev;\n\tenum xenbus_state state;\n\tstruct completion down;\n\tstruct work_struct work;\n\tstruct semaphore reclaim_sem;\n\n\t \n\tatomic_t event_channels;\n\tatomic_t events;\n\tatomic_t spurious_events;\n\tatomic_t jiffies_eoi_delayed;\n\tunsigned int spurious_threshold;\n};\n\n#define to_xenbus_device(__dev)\tcontainer_of_const(__dev, struct xenbus_device, dev)\n\nstruct xenbus_device_id\n{\n\t \n\tchar devicetype[32]; \t \n};\n\n \nstruct xenbus_driver {\n\tconst char *name;        \n\tconst struct xenbus_device_id *ids;\n\tbool allow_rebind;  \n\tbool not_essential;      \n\tint (*probe)(struct xenbus_device *dev,\n\t\t     const struct xenbus_device_id *id);\n\tvoid (*otherend_changed)(struct xenbus_device *dev,\n\t\t\t\t enum xenbus_state backend_state);\n\tvoid (*remove)(struct xenbus_device *dev);\n\tint (*suspend)(struct xenbus_device *dev);\n\tint (*resume)(struct xenbus_device *dev);\n\tint (*uevent)(const struct xenbus_device *, struct kobj_uevent_env *);\n\tstruct device_driver driver;\n\tint (*read_otherend_details)(struct xenbus_device *dev);\n\tint (*is_ready)(struct xenbus_device *dev);\n\tvoid (*reclaim_memory)(struct xenbus_device *dev);\n};\n\nstatic inline struct xenbus_driver *to_xenbus_driver(struct device_driver *drv)\n{\n\treturn container_of(drv, struct xenbus_driver, driver);\n}\n\nint __must_check __xenbus_register_frontend(struct xenbus_driver *drv,\n\t\t\t\t\t    struct module *owner,\n\t\t\t\t\t    const char *mod_name);\nint __must_check __xenbus_register_backend(struct xenbus_driver *drv,\n\t\t\t\t\t   struct module *owner,\n\t\t\t\t\t   const char *mod_name);\n\n#define xenbus_register_frontend(drv) \\\n\t__xenbus_register_frontend(drv, THIS_MODULE, KBUILD_MODNAME)\n#define xenbus_register_backend(drv) \\\n\t__xenbus_register_backend(drv, THIS_MODULE, KBUILD_MODNAME)\n\nvoid xenbus_unregister_driver(struct xenbus_driver *drv);\n\nstruct xenbus_transaction\n{\n\tu32 id;\n};\n\n \n#define XBT_NIL ((struct xenbus_transaction) { 0 })\n\nchar **xenbus_directory(struct xenbus_transaction t,\n\t\t\tconst char *dir, const char *node, unsigned int *num);\nvoid *xenbus_read(struct xenbus_transaction t,\n\t\t  const char *dir, const char *node, unsigned int *len);\nint xenbus_write(struct xenbus_transaction t,\n\t\t const char *dir, const char *node, const char *string);\nint xenbus_mkdir(struct xenbus_transaction t,\n\t\t const char *dir, const char *node);\nint xenbus_exists(struct xenbus_transaction t,\n\t\t  const char *dir, const char *node);\nint xenbus_rm(struct xenbus_transaction t, const char *dir, const char *node);\nint xenbus_transaction_start(struct xenbus_transaction *t);\nint xenbus_transaction_end(struct xenbus_transaction t, int abort);\n\n \n__scanf(4, 5)\nint xenbus_scanf(struct xenbus_transaction t,\n\t\t const char *dir, const char *node, const char *fmt, ...);\n\n \nunsigned int xenbus_read_unsigned(const char *dir, const char *node,\n\t\t\t\t  unsigned int default_val);\n\n \n__printf(4, 5)\nint xenbus_printf(struct xenbus_transaction t,\n\t\t  const char *dir, const char *node, const char *fmt, ...);\n\n \nint xenbus_gather(struct xenbus_transaction t, const char *dir, ...);\n\n \nextern int xenstored_ready;\nint register_xenstore_notifier(struct notifier_block *nb);\nvoid unregister_xenstore_notifier(struct notifier_block *nb);\n\nint register_xenbus_watch(struct xenbus_watch *watch);\nvoid unregister_xenbus_watch(struct xenbus_watch *watch);\nvoid xs_suspend(void);\nvoid xs_resume(void);\nvoid xs_suspend_cancel(void);\n\nstruct work_struct;\n\n#define XENBUS_IS_ERR_READ(str) ({\t\t\t\\\n\tif (!IS_ERR(str) && strlen(str) == 0) {\t\t\\\n\t\tkfree(str);\t\t\t\t\\\n\t\tstr = ERR_PTR(-ERANGE);\t\t\t\\\n\t}\t\t\t\t\t\t\\\n\tIS_ERR(str);\t\t\t\t\t\\\n})\n\n#define XENBUS_EXIST_ERR(err) ((err) == -ENOENT || (err) == -ERANGE)\n\nint xenbus_watch_path(struct xenbus_device *dev, const char *path,\n\t\t      struct xenbus_watch *watch,\n\t\t      bool (*will_handle)(struct xenbus_watch *,\n\t\t\t\t\t  const char *, const char *),\n\t\t      void (*callback)(struct xenbus_watch *,\n\t\t\t\t       const char *, const char *));\n__printf(5, 6)\nint xenbus_watch_pathfmt(struct xenbus_device *dev, struct xenbus_watch *watch,\n\t\t\t bool (*will_handle)(struct xenbus_watch *,\n\t\t\t\t\t     const char *, const char *),\n\t\t\t void (*callback)(struct xenbus_watch *,\n\t\t\t\t\t  const char *, const char *),\n\t\t\t const char *pathfmt, ...);\n\nint xenbus_switch_state(struct xenbus_device *dev, enum xenbus_state new_state);\nint xenbus_setup_ring(struct xenbus_device *dev, gfp_t gfp, void **vaddr,\n\t\t      unsigned int nr_pages, grant_ref_t *grefs);\nvoid xenbus_teardown_ring(void **vaddr, unsigned int nr_pages,\n\t\t\t  grant_ref_t *grefs);\nint xenbus_map_ring_valloc(struct xenbus_device *dev, grant_ref_t *gnt_refs,\n\t\t\t   unsigned int nr_grefs, void **vaddr);\n\nint xenbus_unmap_ring_vfree(struct xenbus_device *dev, void *vaddr);\n\nint xenbus_alloc_evtchn(struct xenbus_device *dev, evtchn_port_t *port);\nint xenbus_free_evtchn(struct xenbus_device *dev, evtchn_port_t port);\n\nenum xenbus_state xenbus_read_driver_state(const char *path);\n\n__printf(3, 4)\nvoid xenbus_dev_error(struct xenbus_device *dev, int err, const char *fmt, ...);\n__printf(3, 4)\nvoid xenbus_dev_fatal(struct xenbus_device *dev, int err, const char *fmt, ...);\n\nconst char *xenbus_strstate(enum xenbus_state state);\nint xenbus_dev_is_online(struct xenbus_device *dev);\nint xenbus_frontend_closed(struct xenbus_device *dev);\n\nextern const struct file_operations xen_xenbus_fops;\nextern struct xenstore_domain_interface *xen_store_interface;\nextern int xen_store_evtchn;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}