{
  "module_name": "ib_umem_odp.h",
  "hash_id": "f9e870e1263c65657b3ce6b8caeb443ad4575085645dc063e3f2ae421113c8f1",
  "original_prompt": "Ingested from linux-6.6.14/include/rdma/ib_umem_odp.h",
  "human_readable_source": " \n \n\n#ifndef IB_UMEM_ODP_H\n#define IB_UMEM_ODP_H\n\n#include <rdma/ib_umem.h>\n#include <rdma/ib_verbs.h>\n\nstruct ib_umem_odp {\n\tstruct ib_umem umem;\n\tstruct mmu_interval_notifier notifier;\n\tstruct pid *tgid;\n\n\t \n\tunsigned long *pfn_list;\n\n\t \n\tdma_addr_t\t\t*dma_list;\n\t \n\tstruct mutex\t\tumem_mutex;\n\tvoid\t\t\t*private;  \n\n\tint npages;\n\n\t \n\tbool is_implicit_odp;\n\n\tunsigned int\t\tpage_shift;\n};\n\nstatic inline struct ib_umem_odp *to_ib_umem_odp(struct ib_umem *umem)\n{\n\treturn container_of(umem, struct ib_umem_odp, umem);\n}\n\n \nstatic inline unsigned long ib_umem_start(struct ib_umem_odp *umem_odp)\n{\n\treturn umem_odp->notifier.interval_tree.start;\n}\n\n \nstatic inline unsigned long ib_umem_end(struct ib_umem_odp *umem_odp)\n{\n\treturn umem_odp->notifier.interval_tree.last + 1;\n}\n\nstatic inline size_t ib_umem_odp_num_pages(struct ib_umem_odp *umem_odp)\n{\n\treturn (ib_umem_end(umem_odp) - ib_umem_start(umem_odp)) >>\n\t       umem_odp->page_shift;\n}\n\n \n#define ODP_READ_ALLOWED_BIT  (1<<0ULL)\n#define ODP_WRITE_ALLOWED_BIT (1<<1ULL)\n\n#define ODP_DMA_ADDR_MASK (~(ODP_READ_ALLOWED_BIT | ODP_WRITE_ALLOWED_BIT))\n\n#ifdef CONFIG_INFINIBAND_ON_DEMAND_PAGING\n\nstruct ib_umem_odp *\nib_umem_odp_get(struct ib_device *device, unsigned long addr, size_t size,\n\t\tint access, const struct mmu_interval_notifier_ops *ops);\nstruct ib_umem_odp *ib_umem_odp_alloc_implicit(struct ib_device *device,\n\t\t\t\t\t       int access);\nstruct ib_umem_odp *\nib_umem_odp_alloc_child(struct ib_umem_odp *root_umem, unsigned long addr,\n\t\t\tsize_t size,\n\t\t\tconst struct mmu_interval_notifier_ops *ops);\nvoid ib_umem_odp_release(struct ib_umem_odp *umem_odp);\n\nint ib_umem_odp_map_dma_and_lock(struct ib_umem_odp *umem_odp, u64 start_offset,\n\t\t\t\t u64 bcnt, u64 access_mask, bool fault);\n\nvoid ib_umem_odp_unmap_dma_pages(struct ib_umem_odp *umem_odp, u64 start_offset,\n\t\t\t\t u64 bound);\n\n#else  \n\nstatic inline struct ib_umem_odp *\nib_umem_odp_get(struct ib_device *device, unsigned long addr, size_t size,\n\t\tint access, const struct mmu_interval_notifier_ops *ops)\n{\n\treturn ERR_PTR(-EINVAL);\n}\n\nstatic inline void ib_umem_odp_release(struct ib_umem_odp *umem_odp) {}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}