{
  "module_name": "iba.h",
  "hash_id": "7a9ede61b2b9d1f7b021068c84e9e10e3df8ac1237bf5214c4e8f796144e6800",
  "original_prompt": "Ingested from linux-6.6.14/include/rdma/iba.h",
  "human_readable_source": " \n \n#ifndef _IBA_DEFS_H_\n#define _IBA_DEFS_H_\n\n#include <linux/kernel.h>\n#include <linux/bitfield.h>\n#include <asm/unaligned.h>\n\nstatic inline u32 _iba_get8(const u8 *ptr)\n{\n\treturn *ptr;\n}\n\nstatic inline void _iba_set8(u8 *ptr, u32 mask, u32 prep_value)\n{\n\t*ptr = (*ptr & ~mask) | prep_value;\n}\n\nstatic inline u16 _iba_get16(const __be16 *ptr)\n{\n\treturn be16_to_cpu(*ptr);\n}\n\nstatic inline void _iba_set16(__be16 *ptr, u16 mask, u16 prep_value)\n{\n\t*ptr = cpu_to_be16((be16_to_cpu(*ptr) & ~mask) | prep_value);\n}\n\nstatic inline u32 _iba_get32(const __be32 *ptr)\n{\n\treturn be32_to_cpu(*ptr);\n}\n\nstatic inline void _iba_set32(__be32 *ptr, u32 mask, u32 prep_value)\n{\n\t*ptr = cpu_to_be32((be32_to_cpu(*ptr) & ~mask) | prep_value);\n}\n\nstatic inline u64 _iba_get64(const __be64 *ptr)\n{\n\t \n\treturn be64_to_cpu(get_unaligned(ptr));\n}\n\nstatic inline void _iba_set64(__be64 *ptr, u64 mask, u64 prep_value)\n{\n\tput_unaligned(cpu_to_be64((_iba_get64(ptr) & ~mask) | prep_value), ptr);\n}\n\n#define _IBA_SET(field_struct, field_offset, field_mask, num_bits, ptr, value) \\\n\t({                                                                     \\\n\t\tfield_struct *_ptr = ptr;                                      \\\n\t\t_iba_set##num_bits((void *)_ptr + (field_offset), field_mask,  \\\n\t\t\t\t   FIELD_PREP(field_mask, value));             \\\n\t})\n#define IBA_SET(field, ptr, value) _IBA_SET(field, ptr, value)\n\n#define _IBA_GET_MEM_PTR(field_struct, field_offset, type, num_bits, ptr)      \\\n\t({                                                                     \\\n\t\tfield_struct *_ptr = ptr;                                      \\\n\t\t(type *)((void *)_ptr + (field_offset));                       \\\n\t})\n#define IBA_GET_MEM_PTR(field, ptr) _IBA_GET_MEM_PTR(field, ptr)\n\n \n#define _IBA_SET_MEM(field_struct, field_offset, type, num_bits, ptr, in,      \\\n\t\t     bytes)                                                    \\\n\t({                                                                     \\\n\t\tconst type *_in_ptr = in;                                      \\\n\t\tWARN_ON(bytes * 8 > num_bits);                                 \\\n\t\tif (in && bytes)                                               \\\n\t\t\tmemcpy(_IBA_GET_MEM_PTR(field_struct, field_offset,    \\\n\t\t\t\t\t\ttype, num_bits, ptr),          \\\n\t\t\t       _in_ptr, bytes);                                \\\n\t})\n#define IBA_SET_MEM(field, ptr, in, bytes) _IBA_SET_MEM(field, ptr, in, bytes)\n\n#define _IBA_GET(field_struct, field_offset, field_mask, num_bits, ptr)        \\\n\t({                                                                     \\\n\t\tconst field_struct *_ptr = ptr;                                \\\n\t\t(u##num_bits) FIELD_GET(                                       \\\n\t\t\tfield_mask, _iba_get##num_bits((const void *)_ptr +    \\\n\t\t\t\t\t\t       (field_offset)));       \\\n\t})\n#define IBA_GET(field, ptr) _IBA_GET(field, ptr)\n\n#define _IBA_GET_MEM(field_struct, field_offset, type, num_bits, ptr, out,     \\\n\t\t     bytes)                                                    \\\n\t({                                                                     \\\n\t\ttype *_out_ptr = out;                                          \\\n\t\tWARN_ON(bytes * 8 > num_bits);                                 \\\n\t\tif (out && bytes)                                              \\\n\t\t\tmemcpy(_out_ptr,                                       \\\n\t\t\t       _IBA_GET_MEM_PTR(field_struct, field_offset,    \\\n\t\t\t\t\t\ttype, num_bits, ptr),          \\\n\t\t\t       bytes);                                         \\\n\t})\n#define IBA_GET_MEM(field, ptr, out, bytes) _IBA_GET_MEM(field, ptr, out, bytes)\n\n \n\n \n#define IBA_FIELD_BLOC(field_struct, byte_offset, bit_offset, num_bits)        \\\n\tfield_struct, byte_offset,                                             \\\n\t\tGENMASK(7 - (bit_offset), 7 - (bit_offset) - (num_bits - 1)),  \\\n\t\t8\n#define IBA_FIELD8_LOC(field_struct, byte_offset, num_bits)                    \\\n\tIBA_FIELD_BLOC(field_struct, byte_offset, 0, num_bits)\n\n#define IBA_FIELD16_LOC(field_struct, byte_offset, num_bits)                   \\\n\tfield_struct, (byte_offset)&0xFFFE,                                    \\\n\t\tGENMASK(15 - (((byte_offset) % 2) * 8),                        \\\n\t\t\t15 - (((byte_offset) % 2) * 8) - (num_bits - 1)),      \\\n\t\t16\n\n#define IBA_FIELD32_LOC(field_struct, byte_offset, num_bits)                   \\\n\tfield_struct, (byte_offset)&0xFFFC,                                    \\\n\t\tGENMASK(31 - (((byte_offset) % 4) * 8),                        \\\n\t\t\t31 - (((byte_offset) % 4) * 8) - (num_bits - 1)),      \\\n\t\t32\n\n#define IBA_FIELD64_LOC(field_struct, byte_offset)                             \\\n\tfield_struct, byte_offset, GENMASK_ULL(63, 0), 64\n \n#define IBA_FIELD_MLOC(field_struct, byte_offset, num_bits, type)              \\\n\tfield_struct, byte_offset, type, num_bits\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}