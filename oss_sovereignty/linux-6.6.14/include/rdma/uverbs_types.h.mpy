{
  "module_name": "uverbs_types.h",
  "hash_id": "7dee6508ed41a19ec622802cdb0d27c074ea4718ee72900ec13e88fba643699c",
  "original_prompt": "Ingested from linux-6.6.14/include/rdma/uverbs_types.h",
  "human_readable_source": " \n \n\n#ifndef _UVERBS_TYPES_\n#define _UVERBS_TYPES_\n\n#include <linux/kernel.h>\n#include <rdma/ib_verbs.h>\n\nstruct uverbs_obj_type;\nstruct uverbs_api_object;\n\nenum rdma_lookup_mode {\n\tUVERBS_LOOKUP_READ,\n\tUVERBS_LOOKUP_WRITE,\n\t \n\tUVERBS_LOOKUP_DESTROY,\n};\n\n \nstruct uverbs_obj_type_class {\n\tstruct ib_uobject *(*alloc_begin)(const struct uverbs_api_object *obj,\n\t\t\t\t\t  struct uverbs_attr_bundle *attrs);\n\t \n\tvoid (*alloc_commit)(struct ib_uobject *uobj);\n\t \n\tvoid (*alloc_abort)(struct ib_uobject *uobj);\n\n\tstruct ib_uobject *(*lookup_get)(const struct uverbs_api_object *obj,\n\t\t\t\t\t struct ib_uverbs_file *ufile, s64 id,\n\t\t\t\t\t enum rdma_lookup_mode mode);\n\tvoid (*lookup_put)(struct ib_uobject *uobj, enum rdma_lookup_mode mode);\n\t \n\tint __must_check (*destroy_hw)(struct ib_uobject *uobj,\n\t\t\t\t       enum rdma_remove_reason why,\n\t\t\t\t       struct uverbs_attr_bundle *attrs);\n\tvoid (*remove_handle)(struct ib_uobject *uobj);\n\tvoid (*swap_uobjects)(struct ib_uobject *obj_old,\n\t\t\t      struct ib_uobject *obj_new);\n};\n\nstruct uverbs_obj_type {\n\tconst struct uverbs_obj_type_class * const type_class;\n\tsize_t\t     obj_size;\n};\n\n \n\nstruct uverbs_obj_idr_type {\n\t \n\tstruct uverbs_obj_type  type;\n\n\t \n\tint __must_check (*destroy_object)(struct ib_uobject *uobj,\n\t\t\t\t\t   enum rdma_remove_reason why,\n\t\t\t\t\t   struct uverbs_attr_bundle *attrs);\n};\n\nstruct ib_uobject *rdma_lookup_get_uobject(const struct uverbs_api_object *obj,\n\t\t\t\t\t   struct ib_uverbs_file *ufile, s64 id,\n\t\t\t\t\t   enum rdma_lookup_mode mode,\n\t\t\t\t\t   struct uverbs_attr_bundle *attrs);\nvoid rdma_lookup_put_uobject(struct ib_uobject *uobj,\n\t\t\t     enum rdma_lookup_mode mode);\nstruct ib_uobject *rdma_alloc_begin_uobject(const struct uverbs_api_object *obj,\n\t\t\t\t\t    struct uverbs_attr_bundle *attrs);\nvoid rdma_alloc_abort_uobject(struct ib_uobject *uobj,\n\t\t\t      struct uverbs_attr_bundle *attrs,\n\t\t\t      bool hw_obj_valid);\nvoid rdma_alloc_commit_uobject(struct ib_uobject *uobj,\n\t\t\t       struct uverbs_attr_bundle *attrs);\nvoid rdma_assign_uobject(struct ib_uobject *to_uobj,\n\t\t\t struct ib_uobject *new_uobj,\n\t\t\t struct uverbs_attr_bundle *attrs);\n\n \nstatic inline void uverbs_uobject_get(struct ib_uobject *uobject)\n{\n\tkref_get(&uobject->ref);\n}\nvoid uverbs_uobject_put(struct ib_uobject *uobject);\n\nstruct uverbs_obj_fd_type {\n\t \n\tstruct uverbs_obj_type  type;\n\tvoid (*destroy_object)(struct ib_uobject *uobj,\n\t\t\t       enum rdma_remove_reason why);\n\tconst struct file_operations\t*fops;\n\tconst char\t\t\t*name;\n\tint\t\t\t\tflags;\n};\n\nextern const struct uverbs_obj_type_class uverbs_idr_class;\nextern const struct uverbs_obj_type_class uverbs_fd_class;\nint uverbs_uobject_fd_release(struct inode *inode, struct file *filp);\n\n#define UVERBS_BUILD_BUG_ON(cond) (sizeof(char[1 - 2 * !!(cond)]) -\t\\\n\t\t\t\t   sizeof(char))\n#define UVERBS_TYPE_ALLOC_FD(_obj_size, _destroy_object, _fops, _name, _flags) \\\n\t((&((const struct uverbs_obj_fd_type)\t\t\t\t\\\n\t {.type = {\t\t\t\t\t\t\t\\\n\t\t.type_class = &uverbs_fd_class,\t\t\t\t\\\n\t\t.obj_size = (_obj_size) +\t\t\t\t\\\n\t\t\tUVERBS_BUILD_BUG_ON((_obj_size) <               \\\n\t\t\t\t\t    sizeof(struct ib_uobject)), \\\n\t },\t\t\t\t\t\t\t\t\\\n\t .destroy_object = _destroy_object,\t\t\t\t\\\n\t .fops = _fops,\t\t\t\t\t\t\t\\\n\t .name = _name,\t\t\t\t\t\t\t\\\n\t .flags = _flags}))->type)\n#define UVERBS_TYPE_ALLOC_IDR_SZ(_size, _destroy_object)\t\\\n\t((&((const struct uverbs_obj_idr_type)\t\t\t\t\\\n\t {.type = {\t\t\t\t\t\t\t\\\n\t\t.type_class = &uverbs_idr_class,\t\t\t\\\n\t\t.obj_size = (_size) +\t\t\t\t\t\\\n\t\t\tUVERBS_BUILD_BUG_ON((_size) <\t\t\t\\\n\t\t\t\t\t    sizeof(struct ib_uobject))\t\\\n\t },\t\t\t\t\t\t\t\t\\\n\t .destroy_object = _destroy_object,}))->type)\n#define UVERBS_TYPE_ALLOC_IDR(_destroy_object)\t\t\t\\\n\t UVERBS_TYPE_ALLOC_IDR_SZ(sizeof(struct ib_uobject),\t\\\n\t\t\t\t  _destroy_object)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}