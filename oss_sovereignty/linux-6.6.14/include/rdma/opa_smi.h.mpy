{
  "module_name": "opa_smi.h",
  "hash_id": "8bf148a599682d682e4fa5870729d4ad1e78e1561fe2c54a3770713b510641e4",
  "original_prompt": "Ingested from linux-6.6.14/include/rdma/opa_smi.h",
  "human_readable_source": " \n \n\n#ifndef OPA_SMI_H\n#define OPA_SMI_H\n\n#include <rdma/ib_mad.h>\n#include <rdma/ib_smi.h>\n\n#define OPA_SMP_LID_DATA_SIZE\t\t\t2016\n#define OPA_SMP_DR_DATA_SIZE\t\t\t1872\n#define OPA_SMP_MAX_PATH_HOPS\t\t\t64\n\n#define OPA_MAX_VLS\t\t\t\t32\n#define OPA_MAX_SLS\t\t\t\t32\n#define OPA_MAX_SCS\t\t\t\t32\n\n#define OPA_LID_PERMISSIVE\t\t\tcpu_to_be32(0xFFFFFFFF)\n\nstruct opa_smp {\n\tu8\tbase_version;\n\tu8\tmgmt_class;\n\tu8\tclass_version;\n\tu8\tmethod;\n\t__be16\tstatus;\n\tu8\thop_ptr;\n\tu8\thop_cnt;\n\t__be64\ttid;\n\t__be16\tattr_id;\n\t__be16\tresv;\n\t__be32\tattr_mod;\n\t__be64\tmkey;\n\tunion {\n\t\tstruct {\n\t\t\tuint8_t data[OPA_SMP_LID_DATA_SIZE];\n\t\t} lid;\n\t\tstruct {\n\t\t\t__be32\tdr_slid;\n\t\t\t__be32\tdr_dlid;\n\t\t\tu8\tinitial_path[OPA_SMP_MAX_PATH_HOPS];\n\t\t\tu8\treturn_path[OPA_SMP_MAX_PATH_HOPS];\n\t\t\tu8\treserved[8];\n\t\t\tu8\tdata[OPA_SMP_DR_DATA_SIZE];\n\t\t} dr;\n\t} route;\n} __packed;\n\n\n \n \n#define OPA_ATTRIB_ID_NODE_DESCRIPTION\t\tcpu_to_be16(0x0010)\n#define OPA_ATTRIB_ID_NODE_INFO\t\t\tcpu_to_be16(0x0011)\n#define OPA_ATTRIB_ID_PORT_INFO\t\t\tcpu_to_be16(0x0015)\n#define OPA_ATTRIB_ID_PARTITION_TABLE\t\tcpu_to_be16(0x0016)\n#define OPA_ATTRIB_ID_SL_TO_SC_MAP\t\tcpu_to_be16(0x0017)\n#define OPA_ATTRIB_ID_VL_ARBITRATION\t\tcpu_to_be16(0x0018)\n#define OPA_ATTRIB_ID_SM_INFO\t\t\tcpu_to_be16(0x0020)\n#define OPA_ATTRIB_ID_CABLE_INFO\t\tcpu_to_be16(0x0032)\n#define OPA_ATTRIB_ID_AGGREGATE\t\t\tcpu_to_be16(0x0080)\n#define OPA_ATTRIB_ID_SC_TO_SL_MAP\t\tcpu_to_be16(0x0082)\n#define OPA_ATTRIB_ID_SC_TO_VLR_MAP\t\tcpu_to_be16(0x0083)\n#define OPA_ATTRIB_ID_SC_TO_VLT_MAP\t\tcpu_to_be16(0x0084)\n#define OPA_ATTRIB_ID_SC_TO_VLNT_MAP\t\tcpu_to_be16(0x0085)\n \n#define OPA_ATTRIB_ID_PORT_STATE_INFO\t\tcpu_to_be16(0x0087)\n \n#define OPA_ATTRIB_ID_BUFFER_CONTROL_TABLE\tcpu_to_be16(0x008A)\n \n\nstruct opa_node_description {\n\tu8 data[64];\n} __packed;\n\nstruct opa_node_info {\n\tu8      base_version;\n\tu8      class_version;\n\tu8      node_type;\n\tu8      num_ports;\n\t__be32  reserved;\n\t__be64  system_image_guid;\n\t__be64  node_guid;\n\t__be64  port_guid;\n\t__be16  partition_cap;\n\t__be16  device_id;\n\t__be32  revision;\n\tu8      local_port_num;\n\tu8      vendor_id[3];    \n} __packed;\n\n#define OPA_PARTITION_TABLE_BLK_SIZE 32\n\nstatic inline u8\nopa_get_smp_direction(struct opa_smp *smp)\n{\n\treturn ib_get_smp_direction((struct ib_smp *)smp);\n}\n\nstatic inline u8 *opa_get_smp_data(struct opa_smp *smp)\n{\n\tif (smp->mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE)\n\t\treturn smp->route.dr.data;\n\n\treturn smp->route.lid.data;\n}\n\nstatic inline size_t opa_get_smp_data_size(struct opa_smp *smp)\n{\n\tif (smp->mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE)\n\t\treturn sizeof(smp->route.dr.data);\n\n\treturn sizeof(smp->route.lid.data);\n}\n\nstatic inline size_t opa_get_smp_header_size(struct opa_smp *smp)\n{\n\tif (smp->mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE)\n\t\treturn sizeof(*smp) - sizeof(smp->route.dr.data);\n\n\treturn sizeof(*smp) - sizeof(smp->route.lid.data);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}