{
  "module_name": "ib_cm.h",
  "hash_id": "5c0be6e00e4bd3fd9775cb86a2638d0294ca8b4478f6805c46889acfb68325d3",
  "original_prompt": "Ingested from linux-6.6.14/include/rdma/ib_cm.h",
  "human_readable_source": " \n \n\n#ifndef IB_CM_H\n#define IB_CM_H\n\n#include <rdma/ib_mad.h>\n#include <rdma/ib_sa.h>\n#include <rdma/rdma_cm.h>\n\nenum ib_cm_state {\n\tIB_CM_IDLE,\n\tIB_CM_LISTEN,\n\tIB_CM_REQ_SENT,\n\tIB_CM_REQ_RCVD,\n\tIB_CM_MRA_REQ_SENT,\n\tIB_CM_MRA_REQ_RCVD,\n\tIB_CM_REP_SENT,\n\tIB_CM_REP_RCVD,\n\tIB_CM_MRA_REP_SENT,\n\tIB_CM_MRA_REP_RCVD,\n\tIB_CM_ESTABLISHED,\n\tIB_CM_DREQ_SENT,\n\tIB_CM_DREQ_RCVD,\n\tIB_CM_TIMEWAIT,\n\tIB_CM_SIDR_REQ_SENT,\n\tIB_CM_SIDR_REQ_RCVD\n};\n\nenum ib_cm_lap_state {\n\tIB_CM_LAP_UNINIT,\n\tIB_CM_LAP_IDLE,\n\tIB_CM_LAP_SENT,\n\tIB_CM_LAP_RCVD,\n\tIB_CM_MRA_LAP_SENT,\n\tIB_CM_MRA_LAP_RCVD,\n};\n\nenum ib_cm_event_type {\n\tIB_CM_REQ_ERROR,\n\tIB_CM_REQ_RECEIVED,\n\tIB_CM_REP_ERROR,\n\tIB_CM_REP_RECEIVED,\n\tIB_CM_RTU_RECEIVED,\n\tIB_CM_USER_ESTABLISHED,\n\tIB_CM_DREQ_ERROR,\n\tIB_CM_DREQ_RECEIVED,\n\tIB_CM_DREP_RECEIVED,\n\tIB_CM_TIMEWAIT_EXIT,\n\tIB_CM_MRA_RECEIVED,\n\tIB_CM_REJ_RECEIVED,\n\tIB_CM_LAP_ERROR,\n\tIB_CM_LAP_RECEIVED,\n\tIB_CM_APR_RECEIVED,\n\tIB_CM_SIDR_REQ_ERROR,\n\tIB_CM_SIDR_REQ_RECEIVED,\n\tIB_CM_SIDR_REP_RECEIVED\n};\n\nenum ib_cm_data_size {\n\tIB_CM_REQ_PRIVATE_DATA_SIZE\t = 92,\n\tIB_CM_MRA_PRIVATE_DATA_SIZE\t = 222,\n\tIB_CM_REJ_PRIVATE_DATA_SIZE\t = 148,\n\tIB_CM_REP_PRIVATE_DATA_SIZE\t = 196,\n\tIB_CM_RTU_PRIVATE_DATA_SIZE\t = 224,\n\tIB_CM_DREQ_PRIVATE_DATA_SIZE\t = 220,\n\tIB_CM_DREP_PRIVATE_DATA_SIZE\t = 224,\n\tIB_CM_REJ_ARI_LENGTH\t\t = 72,\n\tIB_CM_LAP_PRIVATE_DATA_SIZE\t = 168,\n\tIB_CM_APR_PRIVATE_DATA_SIZE\t = 148,\n\tIB_CM_APR_INFO_LENGTH\t\t = 72,\n\tIB_CM_SIDR_REQ_PRIVATE_DATA_SIZE = 216,\n\tIB_CM_SIDR_REP_PRIVATE_DATA_SIZE = 136,\n\tIB_CM_SIDR_REP_INFO_LENGTH\t = 72,\n};\n\nstruct ib_cm_id;\n\nstruct ib_cm_req_event_param {\n\tstruct ib_cm_id\t\t*listen_id;\n\n\t \n\tu16\t\t\tbth_pkey;\n\n\tu8\t\t\tport;\n\n\tstruct sa_path_rec\t*primary_path;\n\tstruct sa_path_rec\t*alternate_path;\n\n\t \n\tconst struct ib_gid_attr *ppath_sgid_attr;\n\n\t__be64\t\t\tremote_ca_guid;\n\tu32\t\t\tremote_qkey;\n\tu32\t\t\tremote_qpn;\n\tenum ib_qp_type\t\tqp_type;\n\n\tu32\t\t\tstarting_psn;\n\tu8\t\t\tresponder_resources;\n\tu8\t\t\tinitiator_depth;\n\tunsigned int\t\tlocal_cm_response_timeout:5;\n\tunsigned int\t\tflow_control:1;\n\tunsigned int\t\tremote_cm_response_timeout:5;\n\tunsigned int\t\tretry_count:3;\n\tunsigned int\t\trnr_retry_count:3;\n\tunsigned int\t\tsrq:1;\n\tstruct rdma_ucm_ece\tece;\n};\n\nstruct ib_cm_rep_event_param {\n\t__be64\t\t\tremote_ca_guid;\n\tu32\t\t\tremote_qkey;\n\tu32\t\t\tremote_qpn;\n\tu32\t\t\tstarting_psn;\n\tu8\t\t\tresponder_resources;\n\tu8\t\t\tinitiator_depth;\n\tunsigned int\t\ttarget_ack_delay:5;\n\tunsigned int\t\tfailover_accepted:2;\n\tunsigned int\t\tflow_control:1;\n\tunsigned int\t\trnr_retry_count:3;\n\tunsigned int\t\tsrq:1;\n\tstruct rdma_ucm_ece\tece;\n};\n\nenum ib_cm_rej_reason {\n\tIB_CM_REJ_NO_QP\t\t\t\t= 1,\n\tIB_CM_REJ_NO_EEC\t\t\t= 2,\n\tIB_CM_REJ_NO_RESOURCES\t\t\t= 3,\n\tIB_CM_REJ_TIMEOUT\t\t\t= 4,\n\tIB_CM_REJ_UNSUPPORTED\t\t\t= 5,\n\tIB_CM_REJ_INVALID_COMM_ID\t\t= 6,\n\tIB_CM_REJ_INVALID_COMM_INSTANCE\t\t= 7,\n\tIB_CM_REJ_INVALID_SERVICE_ID\t\t= 8,\n\tIB_CM_REJ_INVALID_TRANSPORT_TYPE\t= 9,\n\tIB_CM_REJ_STALE_CONN\t\t\t= 10,\n\tIB_CM_REJ_RDC_NOT_EXIST\t\t\t= 11,\n\tIB_CM_REJ_INVALID_GID\t\t\t= 12,\n\tIB_CM_REJ_INVALID_LID\t\t\t= 13,\n\tIB_CM_REJ_INVALID_SL\t\t\t= 14,\n\tIB_CM_REJ_INVALID_TRAFFIC_CLASS\t\t= 15,\n\tIB_CM_REJ_INVALID_HOP_LIMIT\t\t= 16,\n\tIB_CM_REJ_INVALID_PACKET_RATE\t\t= 17,\n\tIB_CM_REJ_INVALID_ALT_GID\t\t= 18,\n\tIB_CM_REJ_INVALID_ALT_LID\t\t= 19,\n\tIB_CM_REJ_INVALID_ALT_SL\t\t= 20,\n\tIB_CM_REJ_INVALID_ALT_TRAFFIC_CLASS\t= 21,\n\tIB_CM_REJ_INVALID_ALT_HOP_LIMIT\t\t= 22,\n\tIB_CM_REJ_INVALID_ALT_PACKET_RATE\t= 23,\n\tIB_CM_REJ_PORT_CM_REDIRECT\t\t= 24,\n\tIB_CM_REJ_PORT_REDIRECT\t\t\t= 25,\n\tIB_CM_REJ_INVALID_MTU\t\t\t= 26,\n\tIB_CM_REJ_INSUFFICIENT_RESP_RESOURCES\t= 27,\n\tIB_CM_REJ_CONSUMER_DEFINED\t\t= 28,\n\tIB_CM_REJ_INVALID_RNR_RETRY\t\t= 29,\n\tIB_CM_REJ_DUPLICATE_LOCAL_COMM_ID\t= 30,\n\tIB_CM_REJ_INVALID_CLASS_VERSION\t\t= 31,\n\tIB_CM_REJ_INVALID_FLOW_LABEL\t\t= 32,\n\tIB_CM_REJ_INVALID_ALT_FLOW_LABEL\t= 33,\n\tIB_CM_REJ_VENDOR_OPTION_NOT_SUPPORTED\t= 35,\n};\n\nstruct ib_cm_rej_event_param {\n\tenum ib_cm_rej_reason\treason;\n\tvoid\t\t\t*ari;\n\tu8\t\t\tari_length;\n};\n\nstruct ib_cm_mra_event_param {\n\tu8\tservice_timeout;\n};\n\nstruct ib_cm_lap_event_param {\n\tstruct sa_path_rec\t*alternate_path;\n};\n\nenum ib_cm_apr_status {\n\tIB_CM_APR_SUCCESS,\n\tIB_CM_APR_INVALID_COMM_ID,\n\tIB_CM_APR_UNSUPPORTED,\n\tIB_CM_APR_REJECT,\n\tIB_CM_APR_REDIRECT,\n\tIB_CM_APR_IS_CURRENT,\n\tIB_CM_APR_INVALID_QPN_EECN,\n\tIB_CM_APR_INVALID_LID,\n\tIB_CM_APR_INVALID_GID,\n\tIB_CM_APR_INVALID_FLOW_LABEL,\n\tIB_CM_APR_INVALID_TCLASS,\n\tIB_CM_APR_INVALID_HOP_LIMIT,\n\tIB_CM_APR_INVALID_PACKET_RATE,\n\tIB_CM_APR_INVALID_SL\n};\n\nstruct ib_cm_apr_event_param {\n\tenum ib_cm_apr_status\tap_status;\n\tvoid\t\t\t*apr_info;\n\tu8\t\t\tinfo_len;\n};\n\nstruct ib_cm_sidr_req_event_param {\n\tstruct ib_cm_id\t\t*listen_id;\n\t__be64\t\t\tservice_id;\n\n\t \n\tconst struct ib_gid_attr *sgid_attr;\n\t \n\tu16\t\t\tbth_pkey;\n\tu8\t\t\tport;\n\tu16\t\t\tpkey;\n};\n\nenum ib_cm_sidr_status {\n\tIB_SIDR_SUCCESS,\n\tIB_SIDR_UNSUPPORTED,\n\tIB_SIDR_REJECT,\n\tIB_SIDR_NO_QP,\n\tIB_SIDR_REDIRECT,\n\tIB_SIDR_UNSUPPORTED_VERSION\n};\n\nstruct ib_cm_sidr_rep_event_param {\n\tenum ib_cm_sidr_status\tstatus;\n\tu32\t\t\tqkey;\n\tu32\t\t\tqpn;\n\tvoid\t\t\t*info;\n\tconst struct ib_gid_attr *sgid_attr;\n\tu8\t\t\tinfo_len;\n};\n\nstruct ib_cm_event {\n\tenum ib_cm_event_type\tevent;\n\tunion {\n\t\tstruct ib_cm_req_event_param\treq_rcvd;\n\t\tstruct ib_cm_rep_event_param\trep_rcvd;\n\t\t \n\t\tstruct ib_cm_rej_event_param\trej_rcvd;\n\t\tstruct ib_cm_mra_event_param\tmra_rcvd;\n\t\tstruct ib_cm_lap_event_param\tlap_rcvd;\n\t\tstruct ib_cm_apr_event_param\tapr_rcvd;\n\t\t \n\t\tstruct ib_cm_sidr_req_event_param sidr_req_rcvd;\n\t\tstruct ib_cm_sidr_rep_event_param sidr_rep_rcvd;\n\t\tenum ib_wc_status\t\tsend_status;\n\t} param;\n\n\tvoid\t\t\t*private_data;\n};\n\n#define CM_REQ_ATTR_ID\t\tcpu_to_be16(0x0010)\n#define CM_MRA_ATTR_ID\t\tcpu_to_be16(0x0011)\n#define CM_REJ_ATTR_ID\t\tcpu_to_be16(0x0012)\n#define CM_REP_ATTR_ID\t\tcpu_to_be16(0x0013)\n#define CM_RTU_ATTR_ID\t\tcpu_to_be16(0x0014)\n#define CM_DREQ_ATTR_ID\t\tcpu_to_be16(0x0015)\n#define CM_DREP_ATTR_ID\t\tcpu_to_be16(0x0016)\n#define CM_SIDR_REQ_ATTR_ID\tcpu_to_be16(0x0017)\n#define CM_SIDR_REP_ATTR_ID\tcpu_to_be16(0x0018)\n#define CM_LAP_ATTR_ID\t\tcpu_to_be16(0x0019)\n#define CM_APR_ATTR_ID\t\tcpu_to_be16(0x001A)\n\n \ntypedef int (*ib_cm_handler)(struct ib_cm_id *cm_id,\n\t\t\t     const struct ib_cm_event *event);\n\nstruct ib_cm_id {\n\tib_cm_handler\t\tcm_handler;\n\tvoid\t\t\t*context;\n\tstruct ib_device\t*device;\n\t__be64\t\t\tservice_id;\n\tenum ib_cm_state\tstate;\t\t \n\tenum ib_cm_lap_state\tlap_state;\t \n\t__be32\t\t\tlocal_id;\n\t__be32\t\t\tremote_id;\n\tu32\t\t\tremote_cm_qpn;   \n};\n\n \nstruct ib_cm_id *ib_create_cm_id(struct ib_device *device,\n\t\t\t\t ib_cm_handler cm_handler,\n\t\t\t\t void *context);\n\n \nvoid ib_destroy_cm_id(struct ib_cm_id *cm_id);\n\n#define IB_SERVICE_ID_AGN_MASK\tcpu_to_be64(0xFF00000000000000ULL)\n#define IB_CM_ASSIGN_SERVICE_ID\tcpu_to_be64(0x0200000000000000ULL)\n#define IB_CMA_SERVICE_ID\tcpu_to_be64(0x0000000001000000ULL)\n#define IB_CMA_SERVICE_ID_MASK\tcpu_to_be64(0xFFFFFFFFFF000000ULL)\n#define IB_SDP_SERVICE_ID\tcpu_to_be64(0x0000000000010000ULL)\n#define IB_SDP_SERVICE_ID_MASK\tcpu_to_be64(0xFFFFFFFFFFFF0000ULL)\n\n \nint ib_cm_listen(struct ib_cm_id *cm_id, __be64 service_id);\n\nstruct ib_cm_id *ib_cm_insert_listen(struct ib_device *device,\n\t\t\t\t     ib_cm_handler cm_handler,\n\t\t\t\t     __be64 service_id);\n\nstruct ib_cm_req_param {\n\tstruct sa_path_rec\t*primary_path;\n\tstruct sa_path_rec\t*primary_path_inbound;\n\tstruct sa_path_rec\t*primary_path_outbound;\n\tstruct sa_path_rec\t*alternate_path;\n\tconst struct ib_gid_attr *ppath_sgid_attr;\n\t__be64\t\t\tservice_id;\n\tu32\t\t\tqp_num;\n\tenum ib_qp_type\t\tqp_type;\n\tu32\t\t\tstarting_psn;\n\tconst void\t\t*private_data;\n\tu8\t\t\tprivate_data_len;\n\tu8\t\t\tresponder_resources;\n\tu8\t\t\tinitiator_depth;\n\tu8\t\t\tremote_cm_response_timeout;\n\tu8\t\t\tflow_control;\n\tu8\t\t\tlocal_cm_response_timeout;\n\tu8\t\t\tretry_count;\n\tu8\t\t\trnr_retry_count;\n\tu8\t\t\tmax_cm_retries;\n\tu8\t\t\tsrq;\n\tstruct rdma_ucm_ece\tece;\n};\n\n \nint ib_send_cm_req(struct ib_cm_id *cm_id,\n\t\t   struct ib_cm_req_param *param);\n\nstruct ib_cm_rep_param {\n\tu32\t\tqp_num;\n\tu32\t\tstarting_psn;\n\tconst void\t*private_data;\n\tu8\t\tprivate_data_len;\n\tu8\t\tresponder_resources;\n\tu8\t\tinitiator_depth;\n\tu8\t\tfailover_accepted;\n\tu8\t\tflow_control;\n\tu8\t\trnr_retry_count;\n\tu8\t\tsrq;\n\tstruct rdma_ucm_ece ece;\n};\n\n \nint ib_send_cm_rep(struct ib_cm_id *cm_id,\n\t\t   struct ib_cm_rep_param *param);\n\n \nint ib_send_cm_rtu(struct ib_cm_id *cm_id,\n\t\t   const void *private_data,\n\t\t   u8 private_data_len);\n\n \nint ib_send_cm_dreq(struct ib_cm_id *cm_id,\n\t\t    const void *private_data,\n\t\t    u8 private_data_len);\n\n \nint ib_send_cm_drep(struct ib_cm_id *cm_id,\n\t\t    const void *private_data,\n\t\t    u8 private_data_len);\n\n \nint ib_cm_notify(struct ib_cm_id *cm_id, enum ib_event_type event);\n\n \nint ib_send_cm_rej(struct ib_cm_id *cm_id,\n\t\t   enum ib_cm_rej_reason reason,\n\t\t   void *ari,\n\t\t   u8 ari_length,\n\t\t   const void *private_data,\n\t\t   u8 private_data_len);\n\n#define IB_CM_MRA_FLAG_DELAY 0x80   \n\n \nint ib_send_cm_mra(struct ib_cm_id *cm_id,\n\t\t   u8 service_timeout,\n\t\t   const void *private_data,\n\t\t   u8 private_data_len);\n\n \nint ib_cm_init_qp_attr(struct ib_cm_id *cm_id,\n\t\t       struct ib_qp_attr *qp_attr,\n\t\t       int *qp_attr_mask);\n\nstruct ib_cm_sidr_req_param {\n\tstruct sa_path_rec\t*path;\n\tconst struct ib_gid_attr *sgid_attr;\n\t__be64\t\t\tservice_id;\n\tunsigned long\t\ttimeout_ms;\n\tconst void\t\t*private_data;\n\tu8\t\t\tprivate_data_len;\n\tu8\t\t\tmax_cm_retries;\n};\n\n \nint ib_send_cm_sidr_req(struct ib_cm_id *cm_id,\n\t\t\tstruct ib_cm_sidr_req_param *param);\n\nstruct ib_cm_sidr_rep_param {\n\tu32\t\t\tqp_num;\n\tu32\t\t\tqkey;\n\tenum ib_cm_sidr_status\tstatus;\n\tconst void\t\t*info;\n\tu8\t\t\tinfo_length;\n\tconst void\t\t*private_data;\n\tu8\t\t\tprivate_data_len;\n\tstruct rdma_ucm_ece\tece;\n};\n\n \nint ib_send_cm_sidr_rep(struct ib_cm_id *cm_id,\n\t\t\tstruct ib_cm_sidr_rep_param *param);\n\n \nconst char *__attribute_const__ ibcm_reject_msg(int reason);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}