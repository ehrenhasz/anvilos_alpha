{
  "module_name": "saa7146.h",
  "hash_id": "93e65307f3095c363feb48b1d6c9cb26dfaa07216e8fa7a85ab95d803ba6916f",
  "original_prompt": "Ingested from linux-6.6.14/include/media/drv-intf/saa7146.h",
  "human_readable_source": " \n#ifndef __SAA7146__\n#define __SAA7146__\n\n#include <linux/delay.h>\t \n#include <linux/slab.h>\t\t \n#include <linux/pci.h>\t\t \n#include <linux/init.h>\t\t \n#include <linux/interrupt.h>\t \n#include <linux/kmod.h>\t\t \n#include <linux/i2c.h>\t\t \n#include <asm/io.h>\t\t \n#include <linux/stringify.h>\n#include <linux/mutex.h>\n#include <linux/scatterlist.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-ctrls.h>\n\n#include <linux/vmalloc.h>\t \n#include <linux/mm.h>\t\t \n\n#define saa7146_write(sxy,adr,dat)    writel((dat),(sxy->mem+(adr)))\n#define saa7146_read(sxy,adr)         readl(sxy->mem+(adr))\n\nextern unsigned int saa7146_debug;\n\n#ifndef DEBUG_VARIABLE\n\t#define DEBUG_VARIABLE saa7146_debug\n#endif\n\n#define ERR(fmt, ...)\tpr_err(\"%s: \" fmt, __func__, ##__VA_ARGS__)\n\n#define _DBG(mask, fmt, ...)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (DEBUG_VARIABLE & mask)\t\t\t\t\t\\\n\t\tpr_debug(\"%s(): \" fmt, __func__, ##__VA_ARGS__);\t\\\n} while (0)\n\n \n#define DEB_S(fmt, ...)\t\t_DBG(0x01, fmt, ##__VA_ARGS__)\n \n#define DEB_D(fmt, ...)\t\t_DBG(0x02, fmt, ##__VA_ARGS__)\n \n#define DEB_EE(fmt, ...)\t_DBG(0x04, fmt, ##__VA_ARGS__)\n \n#define DEB_I2C(fmt, ...)\t_DBG(0x08, fmt, ##__VA_ARGS__)\n \n#define DEB_VBI(fmt, ...)\t_DBG(0x10, fmt, ##__VA_ARGS__)\n \n#define DEB_INT(fmt, ...)\t_DBG(0x20, fmt, ##__VA_ARGS__)\n \n#define DEB_CAP(fmt, ...)\t_DBG(0x40, fmt, ##__VA_ARGS__)\n\n#define SAA7146_ISR_CLEAR(x,y) \\\n\tsaa7146_write(x, ISR, (y));\n\nstruct module;\n\nstruct saa7146_dev;\nstruct saa7146_extension;\nstruct saa7146_vv;\n\n \nstruct saa7146_pgtable {\n\tunsigned int\tsize;\n\t__le32\t\t*cpu;\n\tdma_addr_t\tdma;\n\t \n\tunsigned long\toffset;\n\t \n\tstruct scatterlist *slist;\n\tint\t\tnents;\n};\n\nstruct saa7146_pci_extension_data {\n\tstruct saa7146_extension *ext;\n\tvoid *ext_priv;\t\t\t \n};\n\n#define MAKE_EXTENSION_PCI(x_var, x_vendor, x_device)\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.vendor    = PCI_VENDOR_ID_PHILIPS,\t\t\\\n\t\t.device\t   = PCI_DEVICE_ID_PHILIPS_SAA7146,\t\\\n\t\t.subvendor = x_vendor,\t\t\t\t\\\n\t\t.subdevice = x_device,\t\t\t\t\\\n\t\t.driver_data = (unsigned long)& x_var,\t\t\\\n\t}\n\nstruct saa7146_extension\n{\n\tchar\tname[32];\t\t \n#define SAA7146_USE_I2C_IRQ\t0x1\n#define SAA7146_I2C_SHORT_DELAY\t0x2\n\tint\tflags;\n\n\t \n\tstruct module *module;\n\tstruct pci_driver driver;\n\tconst struct pci_device_id *pci_tbl;\n\n\t \n\tint (*probe)(struct saa7146_dev *);\n\tint (*attach)(struct saa7146_dev *, struct saa7146_pci_extension_data *);\n\tint (*detach)(struct saa7146_dev*);\n\n\tu32\tirq_mask;\t \n\tvoid\t(*irq_func)(struct saa7146_dev*, u32* irq_mask);\n};\n\nstruct saa7146_dma\n{\n\tdma_addr_t\tdma_handle;\n\t__le32\t\t*cpu_addr;\n};\n\nstruct saa7146_dev\n{\n\tstruct module\t\t\t*module;\n\n\tstruct v4l2_device\t\tv4l2_dev;\n\tstruct v4l2_ctrl_handler\tctrl_handler;\n\n\t \n\tspinlock_t\t\t\tslock;\n\tstruct mutex\t\t\tv4l2_lock;\n\n\tunsigned char\t\t\t__iomem *mem;\t\t \n\tu32\t\t\t\trevision;\t \n\n\t \n\tchar\t\t\t\tname[32];\n\tstruct pci_dev\t\t\t*pci;\n\tu32\t\t\t\tint_todo;\n\tspinlock_t\t\t\tint_slock;\n\n\t \n\tstruct saa7146_extension\t*ext;\t\t \n\tvoid\t\t\t\t*ext_priv;\t \n\tstruct saa7146_ext_vv\t\t*ext_vv_data;\n\n\t \n\tstruct saa7146_vv\t*vv_data;\n\tvoid (*vv_callback)(struct saa7146_dev *dev, unsigned long status);\n\n\t \n\tstruct mutex\t\t\ti2c_lock;\n\n\tu32\t\t\t\ti2c_bitrate;\n\tstruct saa7146_dma\t\td_i2c;\t \n\twait_queue_head_t\t\ti2c_wq;\n\tint\t\t\t\ti2c_op;\n\n\t \n\tstruct saa7146_dma\t\td_rps0;\n\tstruct saa7146_dma\t\td_rps1;\n};\n\nstatic inline struct saa7146_dev *to_saa7146_dev(struct v4l2_device *v4l2_dev)\n{\n\treturn container_of(v4l2_dev, struct saa7146_dev, v4l2_dev);\n}\n\n \nint saa7146_i2c_adapter_prepare(struct saa7146_dev *dev, struct i2c_adapter *i2c_adapter, u32 bitrate);\n\n \nint saa7146_register_extension(struct saa7146_extension*);\nint saa7146_unregister_extension(struct saa7146_extension*);\nstruct saa7146_format* saa7146_format_by_fourcc(struct saa7146_dev *dev, int fourcc);\nint saa7146_pgtable_alloc(struct pci_dev *pci, struct saa7146_pgtable *pt);\nvoid saa7146_pgtable_free(struct pci_dev *pci, struct saa7146_pgtable *pt);\nint saa7146_pgtable_build_single(struct pci_dev *pci, struct saa7146_pgtable *pt, struct scatterlist *list, int length );\nvoid *saa7146_vmalloc_build_pgtable(struct pci_dev *pci, long length, struct saa7146_pgtable *pt);\nvoid saa7146_vfree_destroy_pgtable(struct pci_dev *pci, void *mem, struct saa7146_pgtable *pt);\nvoid saa7146_setgpio(struct saa7146_dev *dev, int port, u32 data);\nint saa7146_wait_for_debi_done(struct saa7146_dev *dev, int nobusyloop);\n\n \n#define SAA7146_I2C_MEM\t\t( 1*PAGE_SIZE)\n#define SAA7146_RPS_MEM\t\t( 1*PAGE_SIZE)\n\n \n#define SAA7146_I2C_TIMEOUT\t100\t \n#define SAA7146_I2C_RETRIES\t3\t \n#define SAA7146_I2C_DELAY\t5\t \n\n \n#define ME1    0x0000000800\n#define PV1    0x0000000008\n\n \n#define SAA7146_GPIO_INPUT 0x00\n#define SAA7146_GPIO_IRQHI 0x10\n#define SAA7146_GPIO_IRQLO 0x20\n#define SAA7146_GPIO_IRQHL 0x30\n#define SAA7146_GPIO_OUTLO 0x40\n#define SAA7146_GPIO_OUTHI 0x50\n\n \n#define DEBINOSWAP 0x000e0000\n\n \n#define CMD_NOP\t\t0x00000000   \n#define CMD_CLR_EVENT\t0x00000000   \n#define CMD_SET_EVENT\t0x10000000   \n#define CMD_PAUSE\t0x20000000   \n#define CMD_CHECK_LATE\t0x30000000   \n#define CMD_UPLOAD\t0x40000000   \n#define CMD_STOP\t0x50000000   \n#define CMD_INTERRUPT\t0x60000000   \n#define CMD_JUMP\t0x80000000   \n#define CMD_WR_REG\t0x90000000   \n#define CMD_RD_REG\t0xa0000000   \n#define CMD_WR_REG_MASK\t0xc0000000   \n\n#define CMD_OAN\t\tMASK_27\n#define CMD_INV\t\tMASK_26\n#define CMD_SIG4\tMASK_25\n#define CMD_SIG3\tMASK_24\n#define CMD_SIG2\tMASK_23\n#define CMD_SIG1\tMASK_22\n#define CMD_SIG0\tMASK_21\n#define CMD_O_FID_B\tMASK_14\n#define CMD_E_FID_B\tMASK_13\n#define CMD_O_FID_A\tMASK_12\n#define CMD_E_FID_A\tMASK_11\n\n \n#define EVT_HS          (1<<15)     \n#define EVT_VBI_B       (1<<9)      \n#define RPS_OAN         (1<<27)     \n#define RPS_INV         (1<<26)     \n#define GPIO3_MSK       0xFF000000  \n\n \n#define MASK_00   0x00000001     \n#define MASK_01   0x00000002     \n#define MASK_02   0x00000004     \n#define MASK_03   0x00000008     \n#define MASK_04   0x00000010     \n#define MASK_05   0x00000020     \n#define MASK_06   0x00000040     \n#define MASK_07   0x00000080     \n#define MASK_08   0x00000100     \n#define MASK_09   0x00000200     \n#define MASK_10   0x00000400     \n#define MASK_11   0x00000800     \n#define MASK_12   0x00001000     \n#define MASK_13   0x00002000     \n#define MASK_14   0x00004000     \n#define MASK_15   0x00008000     \n#define MASK_16   0x00010000     \n#define MASK_17   0x00020000     \n#define MASK_18   0x00040000     \n#define MASK_19   0x00080000     \n#define MASK_20   0x00100000     \n#define MASK_21   0x00200000     \n#define MASK_22   0x00400000     \n#define MASK_23   0x00800000     \n#define MASK_24   0x01000000     \n#define MASK_25   0x02000000     \n#define MASK_26   0x04000000     \n#define MASK_27   0x08000000     \n#define MASK_28   0x10000000     \n#define MASK_29   0x20000000     \n#define MASK_30   0x40000000     \n#define MASK_31   0x80000000     \n\n#define MASK_B0   0x000000ff     \n#define MASK_B1   0x0000ff00     \n#define MASK_B2   0x00ff0000     \n#define MASK_B3   0xff000000     \n\n#define MASK_W0   0x0000ffff     \n#define MASK_W1   0xffff0000     \n\n#define MASK_PA   0xfffffffc     \n#define MASK_PR   0xfffffffe\t \n#define MASK_ER   0xffffffff     \n\n#define MASK_NONE 0x00000000     \n\n \n#define BASE_ODD1         0x00   \n#define BASE_EVEN1        0x04\n#define PROT_ADDR1        0x08\n#define PITCH1            0x0C\n#define BASE_PAGE1        0x10   \n#define NUM_LINE_BYTE1    0x14\n\n#define BASE_ODD2         0x18   \n#define BASE_EVEN2        0x1C\n#define PROT_ADDR2        0x20\n#define PITCH2            0x24\n#define BASE_PAGE2        0x28   \n#define NUM_LINE_BYTE2    0x2C\n\n#define BASE_ODD3         0x30   \n#define BASE_EVEN3        0x34\n#define PROT_ADDR3        0x38\n#define PITCH3            0x3C\n#define BASE_PAGE3        0x40   \n#define NUM_LINE_BYTE3    0x44\n\n#define PCI_BT_V1         0x48   \n#define PCI_BT_V2         0x49   \n#define PCI_BT_V3         0x4A   \n#define PCI_BT_DEBI       0x4B   \n#define PCI_BT_A          0x4C   \n\n#define DD1_INIT          0x50   \n\n#define DD1_STREAM_B      0x54   \n#define DD1_STREAM_A      0x56   \n\n#define BRS_CTRL          0x58   \n#define HPS_CTRL          0x5C   \n#define HPS_V_SCALE       0x60   \n#define HPS_V_GAIN        0x64   \n#define HPS_H_PRESCALE    0x68   \n#define HPS_H_SCALE       0x6C   \n#define BCS_CTRL          0x70   \n#define CHROMA_KEY_RANGE  0x74\n#define CLIP_FORMAT_CTRL  0x78   \n\n#define DEBI_CONFIG       0x7C\n#define DEBI_COMMAND      0x80\n#define DEBI_PAGE         0x84\n#define DEBI_AD           0x88\n\n#define I2C_TRANSFER      0x8C\n#define I2C_STATUS        0x90\n\n#define BASE_A1_IN        0x94\t \n#define PROT_A1_IN        0x98\n#define PAGE_A1_IN        0x9C\n\n#define BASE_A1_OUT       0xA0   \n#define PROT_A1_OUT       0xA4\n#define PAGE_A1_OUT       0xA8\n\n#define BASE_A2_IN        0xAC   \n#define PROT_A2_IN        0xB0\n#define PAGE_A2_IN        0xB4\n\n#define BASE_A2_OUT       0xB8   \n#define PROT_A2_OUT       0xBC\n#define PAGE_A2_OUT       0xC0\n\n#define RPS_PAGE0         0xC4   \n#define RPS_PAGE1         0xC8   \n\n#define RPS_THRESH0       0xCC   \n#define RPS_THRESH1       0xD0   \n\n#define RPS_TOV0          0xD4   \n#define RPS_TOV1          0xD8   \n\n#define IER               0xDC   \n\n#define GPIO_CTRL         0xE0   \n\n#define EC1SSR            0xE4   \n#define EC2SSR            0xE8   \n#define ECT1R             0xEC   \n#define ECT2R             0xF0   \n\n#define ACON1             0xF4\n#define ACON2             0xF8\n\n#define MC1               0xFC    \n#define MC2               0x100   \n\n#define RPS_ADDR0         0x104   \n#define RPS_ADDR1         0x108   \n\n#define ISR               0x10C   \n#define PSR               0x110   \n#define SSR               0x114   \n\n#define EC1R              0x118   \n#define EC2R              0x11C   \n\n#define PCI_VDP1          0x120   \n#define PCI_VDP2          0x124   \n#define PCI_VDP3          0x128   \n#define PCI_ADP1          0x12C   \n#define PCI_ADP2          0x130   \n#define PCI_ADP3          0x134   \n#define PCI_ADP4          0x138   \n#define PCI_DMA_DDP       0x13C   \n\n#define LEVEL_REP         0x140,\n#define A_TIME_SLOT1      0x180,   \n#define A_TIME_SLOT2      0x1C0,   \n\n \n#define SPCI_PPEF       0x80000000   \n#define SPCI_PABO       0x40000000   \n#define SPCI_PPED       0x20000000   \n#define SPCI_RPS_I1     0x10000000   \n#define SPCI_RPS_I0     0x08000000   \n#define SPCI_RPS_LATE1  0x04000000   \n#define SPCI_RPS_LATE0  0x02000000   \n#define SPCI_RPS_E1     0x01000000   \n#define SPCI_RPS_E0     0x00800000   \n#define SPCI_RPS_TO1    0x00400000   \n#define SPCI_RPS_TO0    0x00200000   \n#define SPCI_UPLD       0x00100000   \n#define SPCI_DEBI_S     0x00080000   \n#define SPCI_DEBI_E     0x00040000   \n#define SPCI_IIC_S      0x00020000   \n#define SPCI_IIC_E      0x00010000   \n#define SPCI_A2_IN      0x00008000   \n#define SPCI_A2_OUT     0x00004000   \n#define SPCI_A1_IN      0x00002000   \n#define SPCI_A1_OUT     0x00001000   \n#define SPCI_AFOU       0x00000800   \n#define SPCI_V_PE       0x00000400   \n#define SPCI_VFOU       0x00000200   \n#define SPCI_FIDA       0x00000100   \n#define SPCI_FIDB       0x00000080   \n#define SPCI_PIN3       0x00000040   \n#define SPCI_PIN2       0x00000020   \n#define SPCI_PIN1       0x00000010   \n#define SPCI_PIN0       0x00000008   \n#define SPCI_ECS        0x00000004   \n#define SPCI_EC3S       0x00000002   \n#define SPCI_EC0S       0x00000001   \n\n \n#define\tSAA7146_I2C_ABORT\t(1<<7)\n#define\tSAA7146_I2C_SPERR\t(1<<6)\n#define\tSAA7146_I2C_APERR\t(1<<5)\n#define\tSAA7146_I2C_DTERR\t(1<<4)\n#define\tSAA7146_I2C_DRERR\t(1<<3)\n#define\tSAA7146_I2C_AL\t\t(1<<2)\n#define\tSAA7146_I2C_ERR\t\t(1<<1)\n#define\tSAA7146_I2C_BUSY\t(1<<0)\n\n#define\tSAA7146_I2C_START\t(0x3)\n#define\tSAA7146_I2C_CONT\t(0x2)\n#define\tSAA7146_I2C_STOP\t(0x1)\n#define\tSAA7146_I2C_NOP\t\t(0x0)\n\n#define SAA7146_I2C_BUS_BIT_RATE_6400\t(0x500)\n#define SAA7146_I2C_BUS_BIT_RATE_3200\t(0x100)\n#define SAA7146_I2C_BUS_BIT_RATE_480\t(0x400)\n#define SAA7146_I2C_BUS_BIT_RATE_320\t(0x600)\n#define SAA7146_I2C_BUS_BIT_RATE_240\t(0x700)\n#define SAA7146_I2C_BUS_BIT_RATE_120\t(0x000)\n#define SAA7146_I2C_BUS_BIT_RATE_80\t(0x200)\n#define SAA7146_I2C_BUS_BIT_RATE_60\t(0x300)\n\nstatic inline void SAA7146_IER_DISABLE(struct saa7146_dev *x, unsigned y)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&x->int_slock, flags);\n\tsaa7146_write(x, IER, saa7146_read(x, IER) & ~y);\n\tspin_unlock_irqrestore(&x->int_slock, flags);\n}\n\nstatic inline void SAA7146_IER_ENABLE(struct saa7146_dev *x, unsigned y)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&x->int_slock, flags);\n\tsaa7146_write(x, IER, saa7146_read(x, IER) | y);\n\tspin_unlock_irqrestore(&x->int_slock, flags);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}