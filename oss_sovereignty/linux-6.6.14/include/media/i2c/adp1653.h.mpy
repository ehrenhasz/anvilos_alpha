{
  "module_name": "adp1653.h",
  "hash_id": "6df496b9f304991efcf21296bee1982a658448d261b5c78a96ff687c48f7ea14",
  "original_prompt": "Ingested from linux-6.6.14/include/media/i2c/adp1653.h",
  "human_readable_source": " \n \n\n#ifndef ADP1653_H\n#define ADP1653_H\n\n#include <linux/i2c.h>\n#include <linux/mutex.h>\n#include <linux/videodev2.h>\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-subdev.h>\n\n#define ADP1653_NAME\t\t\t\t\"adp1653\"\n#define ADP1653_I2C_ADDR\t\t\t(0x60 >> 1)\n\n \n#define ADP1653_REG_OUT_SEL\t\t\t0x00\n#define ADP1653_REG_OUT_SEL_HPLED_TORCH_MIN\t0x01\n#define ADP1653_REG_OUT_SEL_HPLED_TORCH_MAX\t0x0b\n#define ADP1653_REG_OUT_SEL_HPLED_FLASH_MIN\t0x0c\n#define ADP1653_REG_OUT_SEL_HPLED_FLASH_MAX\t0x1f\n#define ADP1653_REG_OUT_SEL_HPLED_SHIFT\t\t3\n#define ADP1653_REG_OUT_SEL_ILED_MAX\t\t0x07\n#define ADP1653_REG_OUT_SEL_ILED_SHIFT\t\t0\n\n#define ADP1653_REG_CONFIG\t\t\t0x01\n#define ADP1653_REG_CONFIG_TMR_CFG\t\t(1 << 4)\n#define ADP1653_REG_CONFIG_TMR_SET_MAX\t\t0x0f\n#define ADP1653_REG_CONFIG_TMR_SET_SHIFT\t0\n\n#define ADP1653_REG_SW_STROBE\t\t\t0x02\n#define ADP1653_REG_SW_STROBE_SW_STROBE\t\t(1 << 0)\n\n#define ADP1653_REG_FAULT\t\t\t0x03\n#define ADP1653_REG_FAULT_FLT_SCP\t\t(1 << 3)\n#define ADP1653_REG_FAULT_FLT_OT\t\t(1 << 2)\n#define ADP1653_REG_FAULT_FLT_TMR\t\t(1 << 1)\n#define ADP1653_REG_FAULT_FLT_OV\t\t(1 << 0)\n\n#define ADP1653_INDICATOR_INTENSITY_MIN\t\t0\n#define ADP1653_INDICATOR_INTENSITY_STEP\t2500\n#define ADP1653_INDICATOR_INTENSITY_MAX\t\t\\\n\t(ADP1653_REG_OUT_SEL_ILED_MAX * ADP1653_INDICATOR_INTENSITY_STEP)\n#define ADP1653_INDICATOR_INTENSITY_uA_TO_REG(a) \\\n\t((a) / ADP1653_INDICATOR_INTENSITY_STEP)\n#define ADP1653_INDICATOR_INTENSITY_REG_TO_uA(a) \\\n\t((a) * ADP1653_INDICATOR_INTENSITY_STEP)\n\n#define ADP1653_FLASH_INTENSITY_BASE\t\t35\n#define ADP1653_FLASH_INTENSITY_STEP\t\t15\n#define ADP1653_FLASH_INTENSITY_MIN\t\t\t\t\t\\\n\t(ADP1653_FLASH_INTENSITY_BASE\t\t\t\t\t\\\n\t + ADP1653_REG_OUT_SEL_HPLED_FLASH_MIN * ADP1653_FLASH_INTENSITY_STEP)\n#define ADP1653_FLASH_INTENSITY_MAX\t\t\t\\\n\t(ADP1653_FLASH_INTENSITY_MIN +\t\t\t\\\n\t (ADP1653_REG_OUT_SEL_HPLED_FLASH_MAX -\t\t\\\n\t  ADP1653_REG_OUT_SEL_HPLED_FLASH_MIN + 1) *\t\\\n\t ADP1653_FLASH_INTENSITY_STEP)\n\n#define ADP1653_FLASH_INTENSITY_mA_TO_REG(a)\t\t\t\t\\\n\t((a) < ADP1653_FLASH_INTENSITY_BASE ? 0 :\t\t\t\\\n\t (((a) - ADP1653_FLASH_INTENSITY_BASE) / ADP1653_FLASH_INTENSITY_STEP))\n#define ADP1653_FLASH_INTENSITY_REG_TO_mA(a)\t\t\\\n\t((a) * ADP1653_FLASH_INTENSITY_STEP + ADP1653_FLASH_INTENSITY_BASE)\n\n#define ADP1653_TORCH_INTENSITY_MIN\t\t\t\t\t\\\n\t(ADP1653_FLASH_INTENSITY_BASE\t\t\t\t\t\\\n\t + ADP1653_REG_OUT_SEL_HPLED_TORCH_MIN * ADP1653_FLASH_INTENSITY_STEP)\n#define ADP1653_TORCH_INTENSITY_MAX\t\t\t\\\n\t(ADP1653_TORCH_INTENSITY_MIN +\t\t\t\\\n\t (ADP1653_REG_OUT_SEL_HPLED_TORCH_MAX -\t\t\\\n\t  ADP1653_REG_OUT_SEL_HPLED_TORCH_MIN + 1) *\t\\\n\t ADP1653_FLASH_INTENSITY_STEP)\n\nstruct adp1653_platform_data {\n\tint (*power)(struct v4l2_subdev *sd, int on);\n\n\tu32 max_flash_timeout;\t\t \n\tu32 max_flash_intensity;\t \n\tu32 max_torch_intensity;\t \n\tu32 max_indicator_intensity;\t \n\n\tstruct gpio_desc *enable_gpio;\t \n};\n\n#define to_adp1653_flash(sd)\tcontainer_of(sd, struct adp1653_flash, subdev)\n\nstruct adp1653_flash {\n\tstruct v4l2_subdev subdev;\n\tstruct adp1653_platform_data *platform_data;\n\n\tstruct v4l2_ctrl_handler ctrls;\n\tstruct v4l2_ctrl *led_mode;\n\tstruct v4l2_ctrl *flash_timeout;\n\tstruct v4l2_ctrl *flash_intensity;\n\tstruct v4l2_ctrl *torch_intensity;\n\tstruct v4l2_ctrl *indicator_intensity;\n\n\tstruct mutex power_lock;\n\tint power_count;\n\tint fault;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}