{
  "module_name": "v4l2-dev.h",
  "hash_id": "5760e8a74550cd27755c8d176e6c346b96ef97d519f01795e8843e2d1ad8d6cf",
  "original_prompt": "Ingested from linux-6.6.14/include/media/v4l2-dev.h",
  "human_readable_source": " \n \n#ifndef _V4L2_DEV_H\n#define _V4L2_DEV_H\n\n#include <linux/poll.h>\n#include <linux/fs.h>\n#include <linux/device.h>\n#include <linux/cdev.h>\n#include <linux/mutex.h>\n#include <linux/videodev2.h>\n\n#include <media/media-entity.h>\n\n#define VIDEO_MAJOR\t81\n\n \nenum vfl_devnode_type {\n\tVFL_TYPE_VIDEO,\n\tVFL_TYPE_VBI,\n\tVFL_TYPE_RADIO,\n\tVFL_TYPE_SUBDEV,\n\tVFL_TYPE_SDR,\n\tVFL_TYPE_TOUCH,\n\tVFL_TYPE_MAX  \n};\n\n \nenum vfl_devnode_direction {\n\tVFL_DIR_RX,\n\tVFL_DIR_TX,\n\tVFL_DIR_M2M,\n};\n\nstruct v4l2_ioctl_callbacks;\nstruct video_device;\nstruct v4l2_device;\nstruct v4l2_ctrl_handler;\n\n \nenum v4l2_video_device_flags {\n\tV4L2_FL_REGISTERED\t\t= 0,\n\tV4L2_FL_USES_V4L2_FH\t\t= 1,\n\tV4L2_FL_QUIRK_INVERTED_CROP\t= 2,\n\tV4L2_FL_SUBDEV_RO_DEVNODE\t= 3,\n};\n\n \n\n \nstruct v4l2_prio_state {\n\tatomic_t prios[4];\n};\n\n \nvoid v4l2_prio_init(struct v4l2_prio_state *global);\n\n \nint v4l2_prio_change(struct v4l2_prio_state *global, enum v4l2_priority *local,\n\t\t     enum v4l2_priority new);\n\n \nvoid v4l2_prio_open(struct v4l2_prio_state *global, enum v4l2_priority *local);\n\n \nvoid v4l2_prio_close(struct v4l2_prio_state *global, enum v4l2_priority local);\n\n \nenum v4l2_priority v4l2_prio_max(struct v4l2_prio_state *global);\n\n \nint v4l2_prio_check(struct v4l2_prio_state *global, enum v4l2_priority local);\n\n \nstruct v4l2_file_operations {\n\tstruct module *owner;\n\tssize_t (*read) (struct file *, char __user *, size_t, loff_t *);\n\tssize_t (*write) (struct file *, const char __user *, size_t, loff_t *);\n\t__poll_t (*poll) (struct file *, struct poll_table_struct *);\n\tlong (*unlocked_ioctl) (struct file *, unsigned int, unsigned long);\n#ifdef CONFIG_COMPAT\n\tlong (*compat_ioctl32) (struct file *, unsigned int, unsigned long);\n#endif\n\tunsigned long (*get_unmapped_area) (struct file *, unsigned long,\n\t\t\t\tunsigned long, unsigned long, unsigned long);\n\tint (*mmap) (struct file *, struct vm_area_struct *);\n\tint (*open) (struct file *);\n\tint (*release) (struct file *);\n};\n\n \n\n \n\nstruct video_device {\n#if defined(CONFIG_MEDIA_CONTROLLER)\n\tstruct media_entity entity;\n\tstruct media_intf_devnode *intf_devnode;\n\tstruct media_pipeline pipe;\n#endif\n\tconst struct v4l2_file_operations *fops;\n\n\tu32 device_caps;\n\n\t \n\tstruct device dev;\n\tstruct cdev *cdev;\n\n\tstruct v4l2_device *v4l2_dev;\n\tstruct device *dev_parent;\n\n\tstruct v4l2_ctrl_handler *ctrl_handler;\n\n\tstruct vb2_queue *queue;\n\n\tstruct v4l2_prio_state *prio;\n\n\t \n\tchar name[32];\n\tenum vfl_devnode_type vfl_type;\n\tenum vfl_devnode_direction vfl_dir;\n\tint minor;\n\tu16 num;\n\tunsigned long flags;\n\tint index;\n\n\t \n\tspinlock_t\t\tfh_lock;\n\tstruct list_head\tfh_list;\n\n\tint dev_debug;\n\n\tv4l2_std_id tvnorms;\n\n\t \n\tvoid (*release)(struct video_device *vdev);\n\tconst struct v4l2_ioctl_ops *ioctl_ops;\n\tDECLARE_BITMAP(valid_ioctls, BASE_VIDIOC_PRIVATE);\n\n\tstruct mutex *lock;\n};\n\n \n#define media_entity_to_video_device(__entity) \\\n\tcontainer_of(__entity, struct video_device, entity)\n\n \n#define to_video_device(cd) container_of(cd, struct video_device, dev)\n\n \nint __must_check __video_register_device(struct video_device *vdev,\n\t\t\t\t\t enum vfl_devnode_type type,\n\t\t\t\t\t int nr, int warn_if_nr_in_use,\n\t\t\t\t\t struct module *owner);\n\n \nstatic inline int __must_check video_register_device(struct video_device *vdev,\n\t\t\t\t\t\t     enum vfl_devnode_type type,\n\t\t\t\t\t\t     int nr)\n{\n\treturn __video_register_device(vdev, type, nr, 1, vdev->fops->owner);\n}\n\n \nstatic inline int __must_check\nvideo_register_device_no_warn(struct video_device *vdev,\n\t\t\t      enum vfl_devnode_type type, int nr)\n{\n\treturn __video_register_device(vdev, type, nr, 0, vdev->fops->owner);\n}\n\n \nvoid video_unregister_device(struct video_device *vdev);\n\n \nstruct video_device * __must_check video_device_alloc(void);\n\n \nvoid video_device_release(struct video_device *vdev);\n\n \nvoid video_device_release_empty(struct video_device *vdev);\n\n \nstatic inline void v4l2_disable_ioctl(struct video_device *vdev,\n\t\t\t\t      unsigned int cmd)\n{\n\tif (_IOC_NR(cmd) < BASE_VIDIOC_PRIVATE)\n\t\tset_bit(_IOC_NR(cmd), vdev->valid_ioctls);\n}\n\n \nstatic inline void *video_get_drvdata(struct video_device *vdev)\n{\n\treturn dev_get_drvdata(&vdev->dev);\n}\n\n \nstatic inline void video_set_drvdata(struct video_device *vdev, void *data)\n{\n\tdev_set_drvdata(&vdev->dev, data);\n}\n\n \nstruct video_device *video_devdata(struct file *file);\n\n \nstatic inline void *video_drvdata(struct file *file)\n{\n\treturn video_get_drvdata(video_devdata(file));\n}\n\n \nstatic inline const char *video_device_node_name(struct video_device *vdev)\n{\n\treturn dev_name(&vdev->dev);\n}\n\n \nstatic inline int video_is_registered(struct video_device *vdev)\n{\n\treturn test_bit(V4L2_FL_REGISTERED, &vdev->flags);\n}\n\n#if defined(CONFIG_MEDIA_CONTROLLER)\n\n \n__must_check int video_device_pipeline_start(struct video_device *vdev,\n\t\t\t\t\t     struct media_pipeline *pipe);\n\n \n__must_check int __video_device_pipeline_start(struct video_device *vdev,\n\t\t\t\t\t       struct media_pipeline *pipe);\n\n \nvoid video_device_pipeline_stop(struct video_device *vdev);\n\n \nvoid __video_device_pipeline_stop(struct video_device *vdev);\n\n \n__must_check int video_device_pipeline_alloc_start(struct video_device *vdev);\n\n \nstruct media_pipeline *video_device_pipeline(struct video_device *vdev);\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}