{
  "module_name": "pcm_params.h",
  "hash_id": "aaa17c24c1382c7e8b9d83f1d374cce322711750976d1412473e860de0c263c8",
  "original_prompt": "Ingested from linux-6.6.14/include/sound/pcm_params.h",
  "human_readable_source": " \n#ifndef __SOUND_PCM_PARAMS_H\n#define __SOUND_PCM_PARAMS_H\n\n \n\n#include <sound/pcm.h>\n\nint snd_pcm_hw_param_first(struct snd_pcm_substream *pcm, \n\t\t\t   struct snd_pcm_hw_params *params,\n\t\t\t   snd_pcm_hw_param_t var, int *dir);\nint snd_pcm_hw_param_last(struct snd_pcm_substream *pcm, \n\t\t\t  struct snd_pcm_hw_params *params,\n\t\t\t  snd_pcm_hw_param_t var, int *dir);\nint snd_pcm_hw_param_value(const struct snd_pcm_hw_params *params,\n\t\t\t   snd_pcm_hw_param_t var, int *dir);\n\n#define SNDRV_MASK_BITS\t64\t \n#define SNDRV_MASK_SIZE\t(SNDRV_MASK_BITS / 32)\n#define MASK_OFS(i)\t((i) >> 5)\n#define MASK_BIT(i)\t(1U << ((i) & 31))\n\nstatic inline void snd_mask_none(struct snd_mask *mask)\n{\n\tmemset(mask, 0, sizeof(*mask));\n}\n\nstatic inline void snd_mask_any(struct snd_mask *mask)\n{\n\tmemset(mask, 0xff, SNDRV_MASK_SIZE * sizeof(u_int32_t));\n}\n\nstatic inline int snd_mask_empty(const struct snd_mask *mask)\n{\n\tint i;\n\tfor (i = 0; i < SNDRV_MASK_SIZE; i++)\n\t\tif (mask->bits[i])\n\t\t\treturn 0;\n\treturn 1;\n}\n\nstatic inline unsigned int snd_mask_min(const struct snd_mask *mask)\n{\n\tint i;\n\tfor (i = 0; i < SNDRV_MASK_SIZE; i++) {\n\t\tif (mask->bits[i])\n\t\t\treturn __ffs(mask->bits[i]) + (i << 5);\n\t}\n\treturn 0;\n}\n\nstatic inline unsigned int snd_mask_max(const struct snd_mask *mask)\n{\n\tint i;\n\tfor (i = SNDRV_MASK_SIZE - 1; i >= 0; i--) {\n\t\tif (mask->bits[i])\n\t\t\treturn __fls(mask->bits[i]) + (i << 5);\n\t}\n\treturn 0;\n}\n\nstatic inline void snd_mask_set(struct snd_mask *mask, unsigned int val)\n{\n\tmask->bits[MASK_OFS(val)] |= MASK_BIT(val);\n}\n\n \nstatic inline void snd_mask_set_format(struct snd_mask *mask,\n\t\t\t\t       snd_pcm_format_t format)\n{\n\tsnd_mask_set(mask, (__force unsigned int)format);\n}\n\nstatic inline void snd_mask_reset(struct snd_mask *mask, unsigned int val)\n{\n\tmask->bits[MASK_OFS(val)] &= ~MASK_BIT(val);\n}\n\nstatic inline void snd_mask_set_range(struct snd_mask *mask,\n\t\t\t\t      unsigned int from, unsigned int to)\n{\n\tunsigned int i;\n\tfor (i = from; i <= to; i++)\n\t\tmask->bits[MASK_OFS(i)] |= MASK_BIT(i);\n}\n\nstatic inline void snd_mask_reset_range(struct snd_mask *mask,\n\t\t\t\t\tunsigned int from, unsigned int to)\n{\n\tunsigned int i;\n\tfor (i = from; i <= to; i++)\n\t\tmask->bits[MASK_OFS(i)] &= ~MASK_BIT(i);\n}\n\nstatic inline void snd_mask_leave(struct snd_mask *mask, unsigned int val)\n{\n\tunsigned int v;\n\tv = mask->bits[MASK_OFS(val)] & MASK_BIT(val);\n\tsnd_mask_none(mask);\n\tmask->bits[MASK_OFS(val)] = v;\n}\n\nstatic inline void snd_mask_intersect(struct snd_mask *mask,\n\t\t\t\t      const struct snd_mask *v)\n{\n\tint i;\n\tfor (i = 0; i < SNDRV_MASK_SIZE; i++)\n\t\tmask->bits[i] &= v->bits[i];\n}\n\nstatic inline int snd_mask_eq(const struct snd_mask *mask,\n\t\t\t      const struct snd_mask *v)\n{\n\treturn ! memcmp(mask, v, SNDRV_MASK_SIZE * sizeof(u_int32_t));\n}\n\nstatic inline void snd_mask_copy(struct snd_mask *mask,\n\t\t\t\t const struct snd_mask *v)\n{\n\t*mask = *v;\n}\n\nstatic inline int snd_mask_test(const struct snd_mask *mask, unsigned int val)\n{\n\treturn mask->bits[MASK_OFS(val)] & MASK_BIT(val);\n}\n\n \nstatic inline int snd_mask_test_format(const struct snd_mask *mask,\n\t\t\t\t       snd_pcm_format_t format)\n{\n\treturn snd_mask_test(mask, (__force unsigned int)format);\n}\n\nstatic inline int snd_mask_single(const struct snd_mask *mask)\n{\n\tint i, c = 0;\n\tfor (i = 0; i < SNDRV_MASK_SIZE; i++) {\n\t\tif (! mask->bits[i])\n\t\t\tcontinue;\n\t\tif (mask->bits[i] & (mask->bits[i] - 1))\n\t\t\treturn 0;\n\t\tif (c)\n\t\t\treturn 0;\n\t\tc++;\n\t}\n\treturn 1;\n}\n\nstatic inline int snd_mask_refine(struct snd_mask *mask,\n\t\t\t\t  const struct snd_mask *v)\n{\n\tstruct snd_mask old;\n\tsnd_mask_copy(&old, mask);\n\tsnd_mask_intersect(mask, v);\n\tif (snd_mask_empty(mask))\n\t\treturn -EINVAL;\n\treturn !snd_mask_eq(mask, &old);\n}\n\nstatic inline int snd_mask_refine_first(struct snd_mask *mask)\n{\n\tif (snd_mask_single(mask))\n\t\treturn 0;\n\tsnd_mask_leave(mask, snd_mask_min(mask));\n\treturn 1;\n}\n\nstatic inline int snd_mask_refine_last(struct snd_mask *mask)\n{\n\tif (snd_mask_single(mask))\n\t\treturn 0;\n\tsnd_mask_leave(mask, snd_mask_max(mask));\n\treturn 1;\n}\n\nstatic inline int snd_mask_refine_min(struct snd_mask *mask, unsigned int val)\n{\n\tif (snd_mask_min(mask) >= val)\n\t\treturn 0;\n\tsnd_mask_reset_range(mask, 0, val - 1);\n\tif (snd_mask_empty(mask))\n\t\treturn -EINVAL;\n\treturn 1;\n}\n\nstatic inline int snd_mask_refine_max(struct snd_mask *mask, unsigned int val)\n{\n\tif (snd_mask_max(mask) <= val)\n\t\treturn 0;\n\tsnd_mask_reset_range(mask, val + 1, SNDRV_MASK_BITS);\n\tif (snd_mask_empty(mask))\n\t\treturn -EINVAL;\n\treturn 1;\n}\n\nstatic inline int snd_mask_refine_set(struct snd_mask *mask, unsigned int val)\n{\n\tint changed;\n\tchanged = !snd_mask_single(mask);\n\tsnd_mask_leave(mask, val);\n\tif (snd_mask_empty(mask))\n\t\treturn -EINVAL;\n\treturn changed;\n}\n\nstatic inline int snd_mask_value(const struct snd_mask *mask)\n{\n\treturn snd_mask_min(mask);\n}\n\nstatic inline void snd_interval_any(struct snd_interval *i)\n{\n\ti->min = 0;\n\ti->openmin = 0;\n\ti->max = UINT_MAX;\n\ti->openmax = 0;\n\ti->integer = 0;\n\ti->empty = 0;\n}\n\nstatic inline void snd_interval_none(struct snd_interval *i)\n{\n\ti->empty = 1;\n}\n\nstatic inline int snd_interval_checkempty(const struct snd_interval *i)\n{\n\treturn (i->min > i->max ||\n\t\t(i->min == i->max && (i->openmin || i->openmax)));\n}\n\nstatic inline int snd_interval_empty(const struct snd_interval *i)\n{\n\treturn i->empty;\n}\n\nstatic inline int snd_interval_single(const struct snd_interval *i)\n{\n\treturn (i->min == i->max || \n\t\t(i->min + 1 == i->max && (i->openmin || i->openmax)));\n}\n\nstatic inline int snd_interval_value(const struct snd_interval *i)\n{\n\tif (i->openmin && !i->openmax)\n\t\treturn i->max;\n\treturn i->min;\n}\n\nstatic inline int snd_interval_min(const struct snd_interval *i)\n{\n\treturn i->min;\n}\n\nstatic inline int snd_interval_max(const struct snd_interval *i)\n{\n\tunsigned int v;\n\tv = i->max;\n\tif (i->openmax)\n\t\tv--;\n\treturn v;\n}\n\nstatic inline int snd_interval_test(const struct snd_interval *i, unsigned int val)\n{\n\treturn !((i->min > val || (i->min == val && i->openmin) ||\n\t\t  i->max < val || (i->max == val && i->openmax)));\n}\n\nstatic inline void snd_interval_copy(struct snd_interval *d, const struct snd_interval *s)\n{\n\t*d = *s;\n}\n\nstatic inline int snd_interval_setinteger(struct snd_interval *i)\n{\n\tif (i->integer)\n\t\treturn 0;\n\tif (i->openmin && i->openmax && i->min == i->max)\n\t\treturn -EINVAL;\n\ti->integer = 1;\n\treturn 1;\n}\n\nstatic inline int snd_interval_eq(const struct snd_interval *i1, const struct snd_interval *i2)\n{\n\tif (i1->empty)\n\t\treturn i2->empty;\n\tif (i2->empty)\n\t\treturn i1->empty;\n\treturn i1->min == i2->min && i1->openmin == i2->openmin &&\n\t\ti1->max == i2->max && i1->openmax == i2->openmax;\n}\n\n \nstatic inline snd_pcm_access_t params_access(const struct snd_pcm_hw_params *p)\n{\n\treturn (__force snd_pcm_access_t)snd_mask_min(hw_param_mask_c(p,\n\t\tSNDRV_PCM_HW_PARAM_ACCESS));\n}\n\n \nstatic inline snd_pcm_format_t params_format(const struct snd_pcm_hw_params *p)\n{\n\treturn (__force snd_pcm_format_t)snd_mask_min(hw_param_mask_c(p,\n\t\tSNDRV_PCM_HW_PARAM_FORMAT));\n}\n\n \nstatic inline snd_pcm_subformat_t\nparams_subformat(const struct snd_pcm_hw_params *p)\n{\n\treturn (__force snd_pcm_subformat_t)snd_mask_min(hw_param_mask_c(p,\n\t\tSNDRV_PCM_HW_PARAM_SUBFORMAT));\n}\n\n \nstatic inline unsigned int\nparams_period_bytes(const struct snd_pcm_hw_params *p)\n{\n\treturn hw_param_interval_c(p, SNDRV_PCM_HW_PARAM_PERIOD_BYTES)->min;\n}\n\n \nstatic inline int params_width(const struct snd_pcm_hw_params *p)\n{\n\treturn snd_pcm_format_width(params_format(p));\n}\n\n \nstatic inline int params_physical_width(const struct snd_pcm_hw_params *p)\n{\n\treturn snd_pcm_format_physical_width(params_format(p));\n}\n\nstatic inline void\nparams_set_format(struct snd_pcm_hw_params *p, snd_pcm_format_t fmt)\n{\n\tsnd_mask_set_format(hw_param_mask(p, SNDRV_PCM_HW_PARAM_FORMAT), fmt);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}