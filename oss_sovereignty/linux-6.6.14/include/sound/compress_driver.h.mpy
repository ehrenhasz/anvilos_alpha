{
  "module_name": "compress_driver.h",
  "hash_id": "c0fbc3db2a2e39b484c38ba3d9fa9cfd03c70c1c8e34e034a73f82f9f322408e",
  "original_prompt": "Ingested from linux-6.6.14/include/sound/compress_driver.h",
  "human_readable_source": " \n\n#ifndef __COMPRESS_DRIVER_H\n#define __COMPRESS_DRIVER_H\n\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <sound/core.h>\n#include <sound/compress_offload.h>\n#include <sound/asound.h>\n#include <sound/pcm.h>\n\nstruct snd_compr_ops;\n\n \nstruct snd_compr_runtime {\n\tsnd_pcm_state_t state;\n\tstruct snd_compr_ops *ops;\n\tvoid *buffer;\n\tu64 buffer_size;\n\tu32 fragment_size;\n\tu32 fragments;\n\tu64 total_bytes_available;\n\tu64 total_bytes_transferred;\n\twait_queue_head_t sleep;\n\tvoid *private_data;\n\n\tunsigned char *dma_area;\n\tdma_addr_t dma_addr;\n\tsize_t dma_bytes;\n\tstruct snd_dma_buffer *dma_buffer_p;\n};\n\n \nstruct snd_compr_stream {\n\tconst char *name;\n\tstruct snd_compr_ops *ops;\n\tstruct snd_compr_runtime *runtime;\n\tstruct snd_compr *device;\n\tstruct delayed_work error_work;\n\tenum snd_compr_direction direction;\n\tbool metadata_set;\n\tbool next_track;\n\tbool partial_drain;\n\tbool pause_in_draining;\n\tvoid *private_data;\n\tstruct snd_dma_buffer dma_buffer;\n};\n\n \nstruct snd_compr_ops {\n\tint (*open)(struct snd_compr_stream *stream);\n\tint (*free)(struct snd_compr_stream *stream);\n\tint (*set_params)(struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_params *params);\n\tint (*get_params)(struct snd_compr_stream *stream,\n\t\t\tstruct snd_codec *params);\n\tint (*set_metadata)(struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_metadata *metadata);\n\tint (*get_metadata)(struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_metadata *metadata);\n\tint (*trigger)(struct snd_compr_stream *stream, int cmd);\n\tint (*pointer)(struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_tstamp *tstamp);\n\tint (*copy)(struct snd_compr_stream *stream, char __user *buf,\n\t\t       size_t count);\n\tint (*mmap)(struct snd_compr_stream *stream,\n\t\t\tstruct vm_area_struct *vma);\n\tint (*ack)(struct snd_compr_stream *stream, size_t bytes);\n\tint (*get_caps) (struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_caps *caps);\n\tint (*get_codec_caps) (struct snd_compr_stream *stream,\n\t\t\tstruct snd_compr_codec_caps *codec);\n};\n\n \nstruct snd_compr {\n\tconst char *name;\n\tstruct device *dev;\n\tstruct snd_compr_ops *ops;\n\tvoid *private_data;\n\tstruct snd_card *card;\n\tunsigned int direction;\n\tstruct mutex lock;\n\tint device;\n\tbool use_pause_in_draining;\n#ifdef CONFIG_SND_VERBOSE_PROCFS\n\t \n\tchar id[64];\n\tstruct snd_info_entry *proc_root;\n\tstruct snd_info_entry *proc_info_entry;\n#endif\n};\n\n \nint snd_compress_new(struct snd_card *card, int device,\n\t\t\tint type, const char *id, struct snd_compr *compr);\n\n \nstatic inline void snd_compr_use_pause_in_draining(struct snd_compr_stream *substream)\n{\n\tsubstream->device->use_pause_in_draining = true;\n}\n\n \nstatic inline void snd_compr_fragment_elapsed(struct snd_compr_stream *stream)\n{\n\twake_up(&stream->runtime->sleep);\n}\n\nstatic inline void snd_compr_drain_notify(struct snd_compr_stream *stream)\n{\n\tif (snd_BUG_ON(!stream))\n\t\treturn;\n\n\t \n\tif (stream->partial_drain) {\n\t\tstream->runtime->state = SNDRV_PCM_STATE_RUNNING;\n\t\tstream->partial_drain = false;  \n\t} else {\n\t\tstream->runtime->state = SNDRV_PCM_STATE_SETUP;\n\t}\n\n\twake_up(&stream->runtime->sleep);\n}\n\n \nstatic inline void\nsnd_compr_set_runtime_buffer(struct snd_compr_stream *stream,\n\t\t\t     struct snd_dma_buffer *bufp)\n{\n\tstruct snd_compr_runtime *runtime = stream->runtime;\n\n\tif (bufp) {\n\t\truntime->dma_buffer_p = bufp;\n\t\truntime->dma_area = bufp->area;\n\t\truntime->dma_addr = bufp->addr;\n\t\truntime->dma_bytes = bufp->bytes;\n\t} else {\n\t\truntime->dma_buffer_p = NULL;\n\t\truntime->dma_area = NULL;\n\t\truntime->dma_addr = 0;\n\t\truntime->dma_bytes = 0;\n\t}\n}\n\nint snd_compr_malloc_pages(struct snd_compr_stream *stream, size_t size);\nint snd_compr_free_pages(struct snd_compr_stream *stream);\n\nint snd_compr_stop_error(struct snd_compr_stream *stream,\n\t\t\t snd_pcm_state_t state);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}