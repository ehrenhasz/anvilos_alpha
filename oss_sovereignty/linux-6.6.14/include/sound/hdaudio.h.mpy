{
  "module_name": "hdaudio.h",
  "hash_id": "60b1b515f5adbd88179b54bb6dbbf507d2c20bbff81acbe3726fea378ad9bcf2",
  "original_prompt": "Ingested from linux-6.6.14/include/sound/hdaudio.h",
  "human_readable_source": " \n \n\n#ifndef __SOUND_HDAUDIO_H\n#define __SOUND_HDAUDIO_H\n\n#include <linux/device.h>\n#include <linux/interrupt.h>\n#include <linux/io.h>\n#include <linux/io-64-nonatomic-lo-hi.h>\n#include <linux/iopoll.h>\n#include <linux/pci.h>\n#include <linux/pm_runtime.h>\n#include <linux/timecounter.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/memalloc.h>\n#include <sound/hda_verbs.h>\n#include <drm/i915_component.h>\n\n \ntypedef u16 hda_nid_t;\n\nstruct hdac_bus;\nstruct hdac_stream;\nstruct hdac_device;\nstruct hdac_driver;\nstruct hdac_widget_tree;\nstruct hda_device_id;\n\n \nextern struct bus_type snd_hda_bus_type;\n\n \nstruct snd_array {\n\tunsigned int used;\n\tunsigned int alloced;\n\tunsigned int elem_size;\n\tunsigned int alloc_align;\n\tvoid *list;\n};\n\n \nstruct hdac_device {\n\tstruct device dev;\n\tint type;\n\tstruct hdac_bus *bus;\n\tunsigned int addr;\t\t \n\tstruct list_head list;\t\t \n\n\thda_nid_t afg;\t\t\t \n\thda_nid_t mfg;\t\t\t \n\n\t \n\tunsigned int vendor_id;\n\tunsigned int subsystem_id;\n\tunsigned int revision_id;\n\tunsigned int afg_function_id;\n\tunsigned int mfg_function_id;\n\tunsigned int afg_unsol:1;\n\tunsigned int mfg_unsol:1;\n\n\tunsigned int power_caps;\t \n\n\tconst char *vendor_name;\t \n\tconst char *chip_name;\t\t \n\n\t \n\tint (*exec_verb)(struct hdac_device *dev, unsigned int cmd,\n\t\t\t unsigned int flags, unsigned int *res);\n\n\t \n\tunsigned int num_nodes;\n\thda_nid_t start_nid, end_nid;\n\n\t \n\tatomic_t in_pm;\t\t \n\n\t \n\tstruct mutex widget_lock;\n\tstruct hdac_widget_tree *widgets;\n\n\t \n\tstruct regmap *regmap;\n\tstruct mutex regmap_lock;\n\tstruct snd_array vendor_verbs;\n\tbool lazy_cache:1;\t \n\tbool caps_overwriting:1;  \n\tbool cache_coef:1;\t \n\tunsigned int registered:1;  \n};\n\n \nenum {\n\tHDA_DEV_CORE,\n\tHDA_DEV_LEGACY,\n\tHDA_DEV_ASOC,\n};\n\nenum {\n\tSND_SKL_PCI_BIND_AUTO,\t \n\tSND_SKL_PCI_BIND_LEGACY, \n\tSND_SKL_PCI_BIND_ASOC\t \n};\n\n \nenum {\n\tHDA_INPUT, HDA_OUTPUT\n};\n\n#define dev_to_hdac_dev(_dev)\tcontainer_of(_dev, struct hdac_device, dev)\n\nint snd_hdac_device_init(struct hdac_device *dev, struct hdac_bus *bus,\n\t\t\t const char *name, unsigned int addr);\nvoid snd_hdac_device_exit(struct hdac_device *dev);\nint snd_hdac_device_register(struct hdac_device *codec);\nvoid snd_hdac_device_unregister(struct hdac_device *codec);\nint snd_hdac_device_set_chip_name(struct hdac_device *codec, const char *name);\nint snd_hdac_codec_modalias(const struct hdac_device *hdac, char *buf, size_t size);\n\nint snd_hdac_refresh_widgets(struct hdac_device *codec);\n\nint snd_hdac_read(struct hdac_device *codec, hda_nid_t nid,\n\t\t  unsigned int verb, unsigned int parm, unsigned int *res);\nint _snd_hdac_read_parm(struct hdac_device *codec, hda_nid_t nid, int parm,\n\t\t\tunsigned int *res);\nint snd_hdac_read_parm_uncached(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t\tint parm);\nint snd_hdac_override_parm(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t   unsigned int parm, unsigned int val);\nint snd_hdac_get_connections(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t     hda_nid_t *conn_list, int max_conns);\nint snd_hdac_get_sub_nodes(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t   hda_nid_t *start_id);\nunsigned int snd_hdac_calc_stream_format(unsigned int rate,\n\t\t\t\t\t unsigned int channels,\n\t\t\t\t\t snd_pcm_format_t format,\n\t\t\t\t\t unsigned int maxbps,\n\t\t\t\t\t unsigned short spdif_ctls);\nint snd_hdac_query_supported_pcm(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t\tu32 *ratesp, u64 *formatsp, unsigned int *bpsp);\nbool snd_hdac_is_supported_format(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t\t  unsigned int format);\n\nint snd_hdac_codec_read(struct hdac_device *hdac, hda_nid_t nid,\n\t\t\tint flags, unsigned int verb, unsigned int parm);\nint snd_hdac_codec_write(struct hdac_device *hdac, hda_nid_t nid,\n\t\t\tint flags, unsigned int verb, unsigned int parm);\nbool snd_hdac_check_power_state(struct hdac_device *hdac,\n\t\thda_nid_t nid, unsigned int target_state);\nunsigned int snd_hdac_sync_power_state(struct hdac_device *hdac,\n\t\t      hda_nid_t nid, unsigned int target_state);\n \nstatic inline int snd_hdac_read_parm(struct hdac_device *codec, hda_nid_t nid,\n\t\t\t\t     int parm)\n{\n\tunsigned int val;\n\n\treturn _snd_hdac_read_parm(codec, nid, parm, &val) < 0 ? -1 : val;\n}\n\n#ifdef CONFIG_PM\nint snd_hdac_power_up(struct hdac_device *codec);\nint snd_hdac_power_down(struct hdac_device *codec);\nint snd_hdac_power_up_pm(struct hdac_device *codec);\nint snd_hdac_power_down_pm(struct hdac_device *codec);\nint snd_hdac_keep_power_up(struct hdac_device *codec);\n\n \nstatic inline void snd_hdac_enter_pm(struct hdac_device *codec)\n{\n\tatomic_inc(&codec->in_pm);\n}\n\n \nstatic inline void snd_hdac_leave_pm(struct hdac_device *codec)\n{\n\tatomic_dec(&codec->in_pm);\n}\n\nstatic inline bool snd_hdac_is_in_pm(struct hdac_device *codec)\n{\n\treturn atomic_read(&codec->in_pm);\n}\n\nstatic inline bool snd_hdac_is_power_on(struct hdac_device *codec)\n{\n\treturn !pm_runtime_suspended(&codec->dev);\n}\n#else\nstatic inline int snd_hdac_power_up(struct hdac_device *codec) { return 0; }\nstatic inline int snd_hdac_power_down(struct hdac_device *codec) { return 0; }\nstatic inline int snd_hdac_power_up_pm(struct hdac_device *codec) { return 0; }\nstatic inline int snd_hdac_power_down_pm(struct hdac_device *codec) { return 0; }\nstatic inline int snd_hdac_keep_power_up(struct hdac_device *codec) { return 0; }\nstatic inline void snd_hdac_enter_pm(struct hdac_device *codec) {}\nstatic inline void snd_hdac_leave_pm(struct hdac_device *codec) {}\nstatic inline bool snd_hdac_is_in_pm(struct hdac_device *codec) { return false; }\nstatic inline bool snd_hdac_is_power_on(struct hdac_device *codec) { return true; }\n#endif\n\n \nstruct hdac_driver {\n\tstruct device_driver driver;\n\tint type;\n\tconst struct hda_device_id *id_table;\n\tint (*match)(struct hdac_device *dev, struct hdac_driver *drv);\n\tvoid (*unsol_event)(struct hdac_device *dev, unsigned int event);\n\n\t \n\tint (*probe)(struct hdac_device *dev);\n\tint (*remove)(struct hdac_device *dev);\n\tvoid (*shutdown)(struct hdac_device *dev);\n};\n\n#define drv_to_hdac_driver(_drv) container_of(_drv, struct hdac_driver, driver)\n\nconst struct hda_device_id *\nhdac_get_device_id(struct hdac_device *hdev, struct hdac_driver *drv);\n\n \nstruct hdac_bus_ops {\n\t \n\tint (*command)(struct hdac_bus *bus, unsigned int cmd);\n\t \n\tint (*get_response)(struct hdac_bus *bus, unsigned int addr,\n\t\t\t    unsigned int *res);\n\t \n\tvoid (*link_power)(struct hdac_device *hdev, bool enable);\n};\n\n \nstruct hdac_ext_bus_ops {\n\tint (*hdev_attach)(struct hdac_device *hdev);\n\tint (*hdev_detach)(struct hdac_device *hdev);\n};\n\n#define HDA_UNSOL_QUEUE_SIZE\t64\n#define HDA_MAX_CODECS\t\t8\t \n\n \nstruct hdac_rb {\n\t__le32 *buf;\t\t \n\tdma_addr_t addr;\t \n\tunsigned short rp, wp;\t \n\tint cmds[HDA_MAX_CODECS];\t \n\tu32 res[HDA_MAX_CODECS];\t \n};\n\n \nstruct hdac_bus {\n\tstruct device *dev;\n\tconst struct hdac_bus_ops *ops;\n\tconst struct hdac_ext_bus_ops *ext_ops;\n\n\t \n\tunsigned long addr;\n\tvoid __iomem *remap_addr;\n\tint irq;\n\n\tvoid __iomem *ppcap;\n\tvoid __iomem *spbcap;\n\tvoid __iomem *mlcap;\n\tvoid __iomem *gtscap;\n\tvoid __iomem *drsmcap;\n\n\t \n\tstruct list_head codec_list;\n\tunsigned int num_codecs;\n\n\t \n\tstruct hdac_device *caddr_tbl[HDA_MAX_CODEC_ADDRESS + 1];\n\n\t \n\tu32 unsol_queue[HDA_UNSOL_QUEUE_SIZE * 2];  \n\tunsigned int unsol_rp, unsol_wp;\n\tstruct work_struct unsol_work;\n\n\t \n\tunsigned long codec_mask;\n\n\t \n\tunsigned long codec_powered;\n\n\t \n\tstruct hdac_rb corb;\n\tstruct hdac_rb rirb;\n\tunsigned int last_cmd[HDA_MAX_CODECS];\t \n\twait_queue_head_t rirb_wq;\n\n\t \n\tstruct snd_dma_buffer rb;\n\tstruct snd_dma_buffer posbuf;\n\tint dma_type;\t\t\t \n\n\t \n\tstruct list_head stream_list;\n\n\t \n\tbool chip_init:1;\t\t \n\n\t \n\tbool aligned_mmio:1;\t\t \n\tbool sync_write:1;\t\t \n\tbool use_posbuf:1;\t\t \n\tbool snoop:1;\t\t\t \n\tbool align_bdle_4k:1;\t\t \n\tbool reverse_assign:1;\t\t \n\tbool corbrp_self_clear:1;\t \n\tbool polling_mode:1;\n\tbool needs_damn_long_delay:1;\n\tbool not_use_interrupts:1;\t \n\tbool access_sdnctl_in_dword:1;\t \n\n\tint poll_count;\n\n\tint bdl_pos_adj;\t\t \n\n\t \n\tunsigned int dma_stop_delay;\n\n\t \n\tspinlock_t reg_lock;\n\tstruct mutex cmd_mutex;\n\tstruct mutex lock;\n\n\t \n\tstruct drm_audio_component *audio_component;\n\tlong display_power_status;\n\tunsigned long display_power_active;\n\n\t \n\tint num_streams;\n\tint idx;\n\n\t \n\tstruct list_head hlink_list;\n\tbool cmd_dma_state;\n\n\t \n\tunsigned int sdo_limit;\n};\n\nint snd_hdac_bus_init(struct hdac_bus *bus, struct device *dev,\n\t\t      const struct hdac_bus_ops *ops);\nvoid snd_hdac_bus_exit(struct hdac_bus *bus);\nint snd_hdac_bus_exec_verb_unlocked(struct hdac_bus *bus, unsigned int addr,\n\t\t\t\t    unsigned int cmd, unsigned int *res);\n\nvoid snd_hdac_codec_link_up(struct hdac_device *codec);\nvoid snd_hdac_codec_link_down(struct hdac_device *codec);\n\nint snd_hdac_bus_send_cmd(struct hdac_bus *bus, unsigned int val);\nint snd_hdac_bus_get_response(struct hdac_bus *bus, unsigned int addr,\n\t\t\t      unsigned int *res);\nint snd_hdac_bus_parse_capabilities(struct hdac_bus *bus);\n\nbool snd_hdac_bus_init_chip(struct hdac_bus *bus, bool full_reset);\nvoid snd_hdac_bus_stop_chip(struct hdac_bus *bus);\nvoid snd_hdac_bus_init_cmd_io(struct hdac_bus *bus);\nvoid snd_hdac_bus_stop_cmd_io(struct hdac_bus *bus);\nvoid snd_hdac_bus_enter_link_reset(struct hdac_bus *bus);\nvoid snd_hdac_bus_exit_link_reset(struct hdac_bus *bus);\nint snd_hdac_bus_reset_link(struct hdac_bus *bus, bool full_reset);\nvoid snd_hdac_bus_link_power(struct hdac_device *hdev, bool enable);\n\nvoid snd_hdac_bus_update_rirb(struct hdac_bus *bus);\nint snd_hdac_bus_handle_stream_irq(struct hdac_bus *bus, unsigned int status,\n\t\t\t\t    void (*ack)(struct hdac_bus *,\n\t\t\t\t\t\tstruct hdac_stream *));\n\nint snd_hdac_bus_alloc_stream_pages(struct hdac_bus *bus);\nvoid snd_hdac_bus_free_stream_pages(struct hdac_bus *bus);\n\n#ifdef CONFIG_SND_HDA_ALIGNED_MMIO\nunsigned int snd_hdac_aligned_read(void __iomem *addr, unsigned int mask);\nvoid snd_hdac_aligned_write(unsigned int val, void __iomem *addr,\n\t\t\t    unsigned int mask);\n#define snd_hdac_aligned_mmio(bus)\t(bus)->aligned_mmio\n#else\n#define snd_hdac_aligned_mmio(bus)\tfalse\n#define snd_hdac_aligned_read(addr, mask)\t0\n#define snd_hdac_aligned_write(val, addr, mask) do {} while (0)\n#endif\n\nstatic inline void snd_hdac_reg_writeb(struct hdac_bus *bus, void __iomem *addr,\n\t\t\t\t       u8 val)\n{\n\tif (snd_hdac_aligned_mmio(bus))\n\t\tsnd_hdac_aligned_write(val, addr, 0xff);\n\telse\n\t\twriteb(val, addr);\n}\n\nstatic inline void snd_hdac_reg_writew(struct hdac_bus *bus, void __iomem *addr,\n\t\t\t\t       u16 val)\n{\n\tif (snd_hdac_aligned_mmio(bus))\n\t\tsnd_hdac_aligned_write(val, addr, 0xffff);\n\telse\n\t\twritew(val, addr);\n}\n\nstatic inline u8 snd_hdac_reg_readb(struct hdac_bus *bus, void __iomem *addr)\n{\n\treturn snd_hdac_aligned_mmio(bus) ?\n\t\tsnd_hdac_aligned_read(addr, 0xff) : readb(addr);\n}\n\nstatic inline u16 snd_hdac_reg_readw(struct hdac_bus *bus, void __iomem *addr)\n{\n\treturn snd_hdac_aligned_mmio(bus) ?\n\t\tsnd_hdac_aligned_read(addr, 0xffff) : readw(addr);\n}\n\n#define snd_hdac_reg_writel(bus, addr, val)\twritel(val, addr)\n#define snd_hdac_reg_readl(bus, addr)\treadl(addr)\n#define snd_hdac_reg_writeq(bus, addr, val)\twriteq(val, addr)\n#define snd_hdac_reg_readq(bus, addr)\t\treadq(addr)\n\n \n#define _snd_hdac_chip_writeb(chip, reg, value) \\\n\tsnd_hdac_reg_writeb(chip, (chip)->remap_addr + (reg), value)\n#define _snd_hdac_chip_readb(chip, reg) \\\n\tsnd_hdac_reg_readb(chip, (chip)->remap_addr + (reg))\n#define _snd_hdac_chip_writew(chip, reg, value) \\\n\tsnd_hdac_reg_writew(chip, (chip)->remap_addr + (reg), value)\n#define _snd_hdac_chip_readw(chip, reg) \\\n\tsnd_hdac_reg_readw(chip, (chip)->remap_addr + (reg))\n#define _snd_hdac_chip_writel(chip, reg, value) \\\n\tsnd_hdac_reg_writel(chip, (chip)->remap_addr + (reg), value)\n#define _snd_hdac_chip_readl(chip, reg) \\\n\tsnd_hdac_reg_readl(chip, (chip)->remap_addr + (reg))\n\n \n#define snd_hdac_chip_writel(chip, reg, value) \\\n\t_snd_hdac_chip_writel(chip, AZX_REG_ ## reg, value)\n#define snd_hdac_chip_writew(chip, reg, value) \\\n\t_snd_hdac_chip_writew(chip, AZX_REG_ ## reg, value)\n#define snd_hdac_chip_writeb(chip, reg, value) \\\n\t_snd_hdac_chip_writeb(chip, AZX_REG_ ## reg, value)\n#define snd_hdac_chip_readl(chip, reg) \\\n\t_snd_hdac_chip_readl(chip, AZX_REG_ ## reg)\n#define snd_hdac_chip_readw(chip, reg) \\\n\t_snd_hdac_chip_readw(chip, AZX_REG_ ## reg)\n#define snd_hdac_chip_readb(chip, reg) \\\n\t_snd_hdac_chip_readb(chip, AZX_REG_ ## reg)\n\n \n#define snd_hdac_chip_updatel(chip, reg, mask, val) \\\n\tsnd_hdac_chip_writel(chip, reg, \\\n\t\t\t     (snd_hdac_chip_readl(chip, reg) & ~(mask)) | (val))\n#define snd_hdac_chip_updatew(chip, reg, mask, val) \\\n\tsnd_hdac_chip_writew(chip, reg, \\\n\t\t\t     (snd_hdac_chip_readw(chip, reg) & ~(mask)) | (val))\n#define snd_hdac_chip_updateb(chip, reg, mask, val) \\\n\tsnd_hdac_chip_writeb(chip, reg, \\\n\t\t\t     (snd_hdac_chip_readb(chip, reg) & ~(mask)) | (val))\n\n \n#define snd_hdac_updatel(addr, reg, mask, val)\t\t\\\n\twritel(((readl(addr + reg) & ~(mask)) | (val)), addr + reg)\n\n#define snd_hdac_updatew(addr, reg, mask, val)\t\t\\\n\twritew(((readw(addr + reg) & ~(mask)) | (val)), addr + reg)\n\n \nstruct hdac_stream {\n\tstruct hdac_bus *bus;\n\tstruct snd_dma_buffer bdl;  \n\t__le32 *posbuf;\t\t \n\tint direction;\t\t \n\n\tunsigned int bufsize;\t \n\tunsigned int period_bytes;  \n\tunsigned int frags;\t \n\tunsigned int fifo_size;\t \n\n\tvoid __iomem *sd_addr;\t \n\n\tvoid __iomem *spib_addr;  \n\tvoid __iomem *fifo_addr;  \n\n\tvoid __iomem *dpibr_addr;  \n\tu32 dpib;\t\t \n\tu32 lpib;\t\t \n\n\tu32 sd_int_sta_mask;\t \n\n\t \n\tstruct snd_pcm_substream *substream;\t \n\tstruct snd_compr_stream *cstream;\n\tunsigned int format_val;\t \n\tunsigned char stream_tag;\t \n\tunsigned char index;\t\t \n\tint assigned_key;\t\t \n\n\tbool opened:1;\n\tbool running:1;\n\tbool prepared:1;\n\tbool no_period_wakeup:1;\n\tbool locked:1;\n\tbool stripe:1;\t\t\t \n\n\tu64 curr_pos;\n\t \n\tunsigned long start_wallclk;\t \n\tunsigned long period_wallclk;\t \n\tstruct timecounter  tc;\n\tstruct cyclecounter cc;\n\tint delay_negative_threshold;\n\n\tstruct list_head list;\n#ifdef CONFIG_SND_HDA_DSP_LOADER\n\t \n\tstruct mutex dsp_mutex;\n#endif\n};\n\nvoid snd_hdac_stream_init(struct hdac_bus *bus, struct hdac_stream *azx_dev,\n\t\t\t  int idx, int direction, int tag);\nstruct hdac_stream *snd_hdac_stream_assign(struct hdac_bus *bus,\n\t\t\t\t\t   struct snd_pcm_substream *substream);\nvoid snd_hdac_stream_release_locked(struct hdac_stream *azx_dev);\nvoid snd_hdac_stream_release(struct hdac_stream *azx_dev);\nstruct hdac_stream *snd_hdac_get_stream(struct hdac_bus *bus,\n\t\t\t\t\tint dir, int stream_tag);\n\nint snd_hdac_stream_setup(struct hdac_stream *azx_dev);\nvoid snd_hdac_stream_cleanup(struct hdac_stream *azx_dev);\nint snd_hdac_stream_setup_periods(struct hdac_stream *azx_dev);\nint snd_hdac_stream_set_params(struct hdac_stream *azx_dev,\n\t\t\t\tunsigned int format_val);\nvoid snd_hdac_stream_start(struct hdac_stream *azx_dev);\nvoid snd_hdac_stream_stop(struct hdac_stream *azx_dev);\nvoid snd_hdac_stop_streams(struct hdac_bus *bus);\nvoid snd_hdac_stop_streams_and_chip(struct hdac_bus *bus);\nvoid snd_hdac_stream_reset(struct hdac_stream *azx_dev);\nvoid snd_hdac_stream_sync_trigger(struct hdac_stream *azx_dev, bool set,\n\t\t\t\t  unsigned int streams, unsigned int reg);\nvoid snd_hdac_stream_sync(struct hdac_stream *azx_dev, bool start,\n\t\t\t  unsigned int streams);\nvoid snd_hdac_stream_timecounter_init(struct hdac_stream *azx_dev,\n\t\t\t\t      unsigned int streams);\nint snd_hdac_get_stream_stripe_ctl(struct hdac_bus *bus,\n\t\t\t\tstruct snd_pcm_substream *substream);\n\nvoid snd_hdac_stream_spbcap_enable(struct hdac_bus *chip,\n\t\t\t\t   bool enable, int index);\nint snd_hdac_stream_set_spib(struct hdac_bus *bus,\n\t\t\t     struct hdac_stream *azx_dev, u32 value);\nint snd_hdac_stream_get_spbmaxfifo(struct hdac_bus *bus,\n\t\t\t\t   struct hdac_stream *azx_dev);\nvoid snd_hdac_stream_drsm_enable(struct hdac_bus *bus,\n\t\t\t\t bool enable, int index);\nint snd_hdac_stream_wait_drsm(struct hdac_stream *azx_dev);\nint snd_hdac_stream_set_dpibr(struct hdac_bus *bus,\n\t\t\t      struct hdac_stream *azx_dev, u32 value);\nint snd_hdac_stream_set_lpib(struct hdac_stream *azx_dev, u32 value);\n\n \n \n#define snd_hdac_stream_writel(dev, reg, value) \\\n\tsnd_hdac_reg_writel((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg, value)\n#define snd_hdac_stream_writew(dev, reg, value) \\\n\tsnd_hdac_reg_writew((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg, value)\n#define snd_hdac_stream_writeb(dev, reg, value) \\\n\tsnd_hdac_reg_writeb((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg, value)\n#define snd_hdac_stream_readl(dev, reg) \\\n\tsnd_hdac_reg_readl((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg)\n#define snd_hdac_stream_readw(dev, reg) \\\n\tsnd_hdac_reg_readw((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg)\n#define snd_hdac_stream_readb(dev, reg) \\\n\tsnd_hdac_reg_readb((dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg)\n#define snd_hdac_stream_readb_poll(dev, reg, val, cond, delay_us, timeout_us) \\\n\tread_poll_timeout_atomic(snd_hdac_reg_readb, val, cond, delay_us, timeout_us, \\\n\t\t\t\t false, (dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg)\n#define snd_hdac_stream_readl_poll(dev, reg, val, cond, delay_us, timeout_us) \\\n\tread_poll_timeout_atomic(snd_hdac_reg_readl, val, cond, delay_us, timeout_us, \\\n\t\t\t\t false, (dev)->bus, (dev)->sd_addr + AZX_REG_ ## reg)\n\n \n#define snd_hdac_stream_updatel(dev, reg, mask, val) \\\n\tsnd_hdac_stream_writel(dev, reg, \\\n\t\t\t       (snd_hdac_stream_readl(dev, reg) & \\\n\t\t\t\t~(mask)) | (val))\n#define snd_hdac_stream_updatew(dev, reg, mask, val) \\\n\tsnd_hdac_stream_writew(dev, reg, \\\n\t\t\t       (snd_hdac_stream_readw(dev, reg) & \\\n\t\t\t\t~(mask)) | (val))\n#define snd_hdac_stream_updateb(dev, reg, mask, val) \\\n\tsnd_hdac_stream_writeb(dev, reg, \\\n\t\t\t       (snd_hdac_stream_readb(dev, reg) & \\\n\t\t\t\t~(mask)) | (val))\n\n#ifdef CONFIG_SND_HDA_DSP_LOADER\n \n#define snd_hdac_dsp_lock_init(dev)\tmutex_init(&(dev)->dsp_mutex)\n#define snd_hdac_dsp_lock(dev)\t\tmutex_lock(&(dev)->dsp_mutex)\n#define snd_hdac_dsp_unlock(dev)\tmutex_unlock(&(dev)->dsp_mutex)\n#define snd_hdac_stream_is_locked(dev)\t((dev)->locked)\n \nint snd_hdac_dsp_prepare(struct hdac_stream *azx_dev, unsigned int format,\n\t\t\t unsigned int byte_size, struct snd_dma_buffer *bufp);\nvoid snd_hdac_dsp_trigger(struct hdac_stream *azx_dev, bool start);\nvoid snd_hdac_dsp_cleanup(struct hdac_stream *azx_dev,\n\t\t\t  struct snd_dma_buffer *dmab);\n#else  \n#define snd_hdac_dsp_lock_init(dev)\tdo {} while (0)\n#define snd_hdac_dsp_lock(dev)\t\tdo {} while (0)\n#define snd_hdac_dsp_unlock(dev)\tdo {} while (0)\n#define snd_hdac_stream_is_locked(dev)\t0\n\nstatic inline int\nsnd_hdac_dsp_prepare(struct hdac_stream *azx_dev, unsigned int format,\n\t\t     unsigned int byte_size, struct snd_dma_buffer *bufp)\n{\n\treturn 0;\n}\n\nstatic inline void snd_hdac_dsp_trigger(struct hdac_stream *azx_dev, bool start)\n{\n}\n\nstatic inline void snd_hdac_dsp_cleanup(struct hdac_stream *azx_dev,\n\t\t\t\t\tstruct snd_dma_buffer *dmab)\n{\n}\n#endif  \n\n\n \nvoid *snd_array_new(struct snd_array *array);\nvoid snd_array_free(struct snd_array *array);\nstatic inline void snd_array_init(struct snd_array *array, unsigned int size,\n\t\t\t\t  unsigned int align)\n{\n\tarray->elem_size = size;\n\tarray->alloc_align = align;\n}\n\nstatic inline void *snd_array_elem(struct snd_array *array, unsigned int idx)\n{\n\treturn array->list + idx * array->elem_size;\n}\n\nstatic inline unsigned int snd_array_index(struct snd_array *array, void *ptr)\n{\n\treturn (unsigned long)(ptr - array->list) / array->elem_size;\n}\n\n \n#define snd_array_for_each(array, idx, ptr) \\\n\tfor ((idx) = 0, (ptr) = (array)->list; (idx) < (array)->used; \\\n\t     (ptr) = snd_array_elem(array, ++(idx)))\n\n \n\n#define HDA_CONTROLLER_IS_HSW(pci) (pci_match_id((struct pci_device_id []){ \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_HSW_0) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_HSW_2) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_HSW_3) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_BDW) }, \\\n\t\t\t{ } \\\n\t\t}, pci))\n\n#define HDA_CONTROLLER_IS_APL(pci) (pci_match_id((struct pci_device_id []){ \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_APL) }, \\\n\t\t\t{ } \\\n\t\t}, pci))\n\n#define HDA_CONTROLLER_IN_GPU(pci) (pci_match_id((struct pci_device_id []){ \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_DG1) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_DG2_0) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_DG2_1) }, \\\n\t\t\t{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_HDA_DG2_2) }, \\\n\t\t\t{ } \\\n\t\t}, pci) || HDA_CONTROLLER_IS_HSW(pci))\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}