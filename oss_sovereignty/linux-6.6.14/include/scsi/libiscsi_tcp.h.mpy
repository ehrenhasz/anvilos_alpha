{
  "module_name": "libiscsi_tcp.h",
  "hash_id": "50d1bce1040e03a3d0595d5120c0c305d3fd64746b25372f22f789fe41a2063a",
  "original_prompt": "Ingested from linux-6.6.14/include/scsi/libiscsi_tcp.h",
  "human_readable_source": " \n \n\n#ifndef LIBISCSI_TCP_H\n#define LIBISCSI_TCP_H\n\n#include <scsi/libiscsi.h>\n\nstruct iscsi_tcp_conn;\nstruct iscsi_segment;\nstruct sk_buff;\nstruct ahash_request;\n\ntypedef int iscsi_segment_done_fn_t(struct iscsi_tcp_conn *,\n\t\t\t\t    struct iscsi_segment *);\n\nstruct iscsi_segment {\n\tunsigned char\t\t*data;\n\tunsigned int\t\tsize;\n\tunsigned int\t\tcopied;\n\tunsigned int\t\ttotal_size;\n\tunsigned int\t\ttotal_copied;\n\n\tstruct ahash_request\t*hash;\n\tunsigned char\t\tpadbuf[ISCSI_PAD_LEN];\n\tunsigned char\t\trecv_digest[ISCSI_DIGEST_SIZE];\n\tunsigned char\t\tdigest[ISCSI_DIGEST_SIZE];\n\tunsigned int\t\tdigest_len;\n\n\tstruct scatterlist\t*sg;\n\tvoid\t\t\t*sg_mapped;\n\tunsigned int\t\tsg_offset;\n\tbool\t\t\tatomic_mapped;\n\n\tiscsi_segment_done_fn_t\t*done;\n};\n\n \nstruct iscsi_tcp_recv {\n\tstruct iscsi_hdr\t*hdr;\n\tstruct iscsi_segment\tsegment;\n\n\t \n\tuint32_t\t\thdr_buf[64];\n\n\t \n\tint\t\t\tdatalen;\n};\n\nstruct iscsi_tcp_conn {\n\tstruct iscsi_conn\t*iscsi_conn;\n\tvoid\t\t\t*dd_data;\n\tint\t\t\tstop_stage;\t \n\t \n\tstruct iscsi_tcp_recv\tin;\t\t \n\t \n\tstruct ahash_request\t*rx_hash;\n};\n\nstruct iscsi_tcp_task {\n\tuint32_t\t\texp_datasn;\t \n\tint\t\t\tdata_offset;\n\tstruct iscsi_r2t_info\t*r2t;\t\t \n\tstruct iscsi_pool\tr2tpool;\n\tstruct kfifo\t\tr2tqueue;\n\tvoid\t\t\t*dd_data;\n\tspinlock_t\t\tpool2queue;\n\tspinlock_t\t\tqueue2pool;\n};\n\nenum {\n\tISCSI_TCP_SEGMENT_DONE,\t\t \n\tISCSI_TCP_SKB_DONE,\t\t \n\tISCSI_TCP_CONN_ERR,\t\t \n\tISCSI_TCP_SUSPENDED,\t\t \n};\n\nextern void iscsi_tcp_hdr_recv_prep(struct iscsi_tcp_conn *tcp_conn);\nextern int iscsi_tcp_recv_skb(struct iscsi_conn *conn, struct sk_buff *skb,\n\t\t\t      unsigned int offset, bool offloaded, int *status);\nextern void iscsi_tcp_cleanup_task(struct iscsi_task *task);\nextern int iscsi_tcp_task_init(struct iscsi_task *task);\nextern int iscsi_tcp_task_xmit(struct iscsi_task *task);\n\n \nextern int iscsi_tcp_recv_segment_is_hdr(struct iscsi_tcp_conn *tcp_conn);\nextern int iscsi_tcp_segment_done(struct iscsi_tcp_conn *tcp_conn,\n\t\t\t\t  struct iscsi_segment *segment, int recv,\n\t\t\t\t  unsigned copied);\nextern void iscsi_tcp_segment_unmap(struct iscsi_segment *segment);\n\nextern void iscsi_segment_init_linear(struct iscsi_segment *segment,\n\t\t\t\t      void *data, size_t size,\n\t\t\t\t      iscsi_segment_done_fn_t *done,\n\t\t\t\t      struct ahash_request *hash);\nextern int\niscsi_segment_seek_sg(struct iscsi_segment *segment,\n\t\t      struct scatterlist *sg_list, unsigned int sg_count,\n\t\t      unsigned int offset, size_t size,\n\t\t      iscsi_segment_done_fn_t *done,\n\t\t      struct ahash_request *hash);\n\n \nextern void iscsi_tcp_dgst_header(struct ahash_request *hash, const void *hdr,\n\t\t\t\t  size_t hdrlen,\n\t\t\t\t  unsigned char digest[ISCSI_DIGEST_SIZE]);\nextern struct iscsi_cls_conn *\niscsi_tcp_conn_setup(struct iscsi_cls_session *cls_session, int dd_data_size,\n\t\t     uint32_t conn_idx);\nextern void iscsi_tcp_conn_teardown(struct iscsi_cls_conn *cls_conn);\n\n \nextern int iscsi_tcp_r2tpool_alloc(struct iscsi_session *session);\nextern void iscsi_tcp_r2tpool_free(struct iscsi_session *session);\nextern int iscsi_tcp_set_max_r2t(struct iscsi_conn *conn, char *buf);\nextern void iscsi_tcp_conn_get_stats(struct iscsi_cls_conn *cls_conn,\n\t\t\t\t     struct iscsi_stats *stats);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}