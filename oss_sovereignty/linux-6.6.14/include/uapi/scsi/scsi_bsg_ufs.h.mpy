{
  "module_name": "scsi_bsg_ufs.h",
  "hash_id": "7c57101b19ada539af95d10315f10409b533c89ec6b9205bda3016ae3b55e7aa",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/scsi/scsi_bsg_ufs.h",
  "human_readable_source": " \n \n#ifndef SCSI_BSG_UFS_H\n#define SCSI_BSG_UFS_H\n\n#include <asm/byteorder.h>\n#include <linux/types.h>\n \n\n#define UFS_CDB_SIZE\t16\n \n#define UIC_CMD_SIZE (sizeof(__u32) * 4)\n\nenum ufs_bsg_msg_code {\n\tUPIU_TRANSACTION_UIC_CMD = 0x1F,\n\tUPIU_TRANSACTION_ARPMB_CMD,\n};\n\n \nenum ufs_rpmb_op_type {\n\tUFS_RPMB_WRITE_KEY\t\t= 0x01,\n\tUFS_RPMB_READ_CNT\t\t= 0x02,\n\tUFS_RPMB_WRITE\t\t\t= 0x03,\n\tUFS_RPMB_READ\t\t\t= 0x04,\n\tUFS_RPMB_READ_RESP\t\t= 0x05,\n\tUFS_RPMB_SEC_CONF_WRITE\t\t= 0x06,\n\tUFS_RPMB_SEC_CONF_READ\t\t= 0x07,\n\tUFS_RPMB_PURGE_ENABLE\t\t= 0x08,\n\tUFS_RPMB_PURGE_STATUS_READ\t= 0x09,\n};\n\n \nstruct utp_upiu_header {\n\tunion {\n\t\tstruct {\n\t\t\t__be32 dword_0;\n\t\t\t__be32 dword_1;\n\t\t\t__be32 dword_2;\n\t\t};\n\t\tstruct {\n\t\t\t__u8 transaction_code;\n\t\t\t__u8 flags;\n\t\t\t__u8 lun;\n\t\t\t__u8 task_tag;\n#if defined(__BIG_ENDIAN)\n\t\t\t__u8 iid: 4;\n\t\t\t__u8 command_set_type: 4;\n#elif defined(__LITTLE_ENDIAN)\n\t\t\t__u8 command_set_type: 4;\n\t\t\t__u8 iid: 4;\n#else\n#error\n#endif\n\t\t\tunion {\n\t\t\t\t__u8 tm_function;\n\t\t\t\t__u8 query_function;\n\t\t\t} __attribute__((packed));\n\t\t\t__u8 response;\n\t\t\t__u8 status;\n\t\t\t__u8 ehs_length;\n\t\t\t__u8 device_information;\n\t\t\t__be16 data_segment_length;\n\t\t};\n\t};\n};\n\n \nstruct utp_upiu_query {\n\t__u8 opcode;\n\t__u8 idn;\n\t__u8 index;\n\t__u8 selector;\n\t__be16 reserved_osf;\n\t__be16 length;\n\t__be32 value;\n\t__be32 reserved[2];\n};\n\n \nstruct utp_upiu_query_v4_0 {\n\t__u8 opcode;\n\t__u8 idn;\n\t__u8 index;\n\t__u8 selector;\n\t__u8 osf3;\n\t__u8 osf4;\n\t__be16 osf5;\n\t__be32 osf6;\n\t__be32 osf7;\n\t__be32 reserved;\n};\n\n \nstruct utp_upiu_cmd {\n\t__be32 exp_data_transfer_len;\n\t__u8 cdb[UFS_CDB_SIZE];\n};\n\n \nstruct utp_upiu_req {\n\tstruct utp_upiu_header header;\n\tunion {\n\t\tstruct utp_upiu_cmd\t\tsc;\n\t\tstruct utp_upiu_query\t\tqr;\n\t\tstruct utp_upiu_query\t\tuc;\n\t};\n};\n\nstruct ufs_arpmb_meta {\n\t__be16\treq_resp_type;\n\t__u8\tnonce[16];\n\t__be32\twrite_counter;\n\t__be16\taddr_lun;\n\t__be16\tblock_count;\n\t__be16\tresult;\n} __attribute__((__packed__));\n\nstruct ufs_ehs {\n\t__u8\tlength;\n\t__u8\tehs_type;\n\t__be16\tehssub_type;\n\tstruct ufs_arpmb_meta meta;\n\t__u8\tmac_key[32];\n} __attribute__((__packed__));\n\n \nstruct ufs_bsg_request {\n\t__u32 msgcode;\n\tstruct utp_upiu_req upiu_req;\n};\n\n \nstruct ufs_bsg_reply {\n\t \n\tint result;\n\n\t \n\t__u32 reply_payload_rcv_len;\n\n\tstruct utp_upiu_req upiu_rsp;\n};\n\nstruct ufs_rpmb_request {\n\tstruct ufs_bsg_request bsg_request;\n\tstruct ufs_ehs ehs_req;\n};\n\nstruct ufs_rpmb_reply {\n\tstruct ufs_bsg_reply bsg_reply;\n\tstruct ufs_ehs ehs_rsp;\n};\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}