{
  "module_name": "if_packet.h",
  "hash_id": "5d3702dd30f00fde27b308d1808110c806e7eb16061ae3a802a1555586d452e2",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/linux/if_packet.h",
  "human_readable_source": " \n#ifndef __LINUX_IF_PACKET_H\n#define __LINUX_IF_PACKET_H\n\n#include <asm/byteorder.h>\n#include <linux/types.h>\n\nstruct sockaddr_pkt {\n\tunsigned short spkt_family;\n\tunsigned char spkt_device[14];\n\t__be16 spkt_protocol;\n};\n\nstruct sockaddr_ll {\n\tunsigned short\tsll_family;\n\t__be16\t\tsll_protocol;\n\tint\t\tsll_ifindex;\n\tunsigned short\tsll_hatype;\n\tunsigned char\tsll_pkttype;\n\tunsigned char\tsll_halen;\n\tunsigned char\tsll_addr[8];\n};\n\n \n\n#define PACKET_HOST\t\t0\t\t \n#define PACKET_BROADCAST\t1\t\t \n#define PACKET_MULTICAST\t2\t\t \n#define PACKET_OTHERHOST\t3\t\t \n#define PACKET_OUTGOING\t\t4\t\t \n#define PACKET_LOOPBACK\t\t5\t\t \n#define PACKET_USER\t\t6\t\t \n#define PACKET_KERNEL\t\t7\t\t \n \n#define PACKET_FASTROUTE\t6\t\t \n\n \n\n#define PACKET_ADD_MEMBERSHIP\t\t1\n#define PACKET_DROP_MEMBERSHIP\t\t2\n#define PACKET_RECV_OUTPUT\t\t3\n \n#define PACKET_RX_RING\t\t\t5\n#define PACKET_STATISTICS\t\t6\n#define PACKET_COPY_THRESH\t\t7\n#define PACKET_AUXDATA\t\t\t8\n#define PACKET_ORIGDEV\t\t\t9\n#define PACKET_VERSION\t\t\t10\n#define PACKET_HDRLEN\t\t\t11\n#define PACKET_RESERVE\t\t\t12\n#define PACKET_TX_RING\t\t\t13\n#define PACKET_LOSS\t\t\t14\n#define PACKET_VNET_HDR\t\t\t15\n#define PACKET_TX_TIMESTAMP\t\t16\n#define PACKET_TIMESTAMP\t\t17\n#define PACKET_FANOUT\t\t\t18\n#define PACKET_TX_HAS_OFF\t\t19\n#define PACKET_QDISC_BYPASS\t\t20\n#define PACKET_ROLLOVER_STATS\t\t21\n#define PACKET_FANOUT_DATA\t\t22\n#define PACKET_IGNORE_OUTGOING\t\t23\n#define PACKET_VNET_HDR_SZ\t\t24\n\n#define PACKET_FANOUT_HASH\t\t0\n#define PACKET_FANOUT_LB\t\t1\n#define PACKET_FANOUT_CPU\t\t2\n#define PACKET_FANOUT_ROLLOVER\t\t3\n#define PACKET_FANOUT_RND\t\t4\n#define PACKET_FANOUT_QM\t\t5\n#define PACKET_FANOUT_CBPF\t\t6\n#define PACKET_FANOUT_EBPF\t\t7\n#define PACKET_FANOUT_FLAG_ROLLOVER\t0x1000\n#define PACKET_FANOUT_FLAG_UNIQUEID\t0x2000\n#define PACKET_FANOUT_FLAG_IGNORE_OUTGOING     0x4000\n#define PACKET_FANOUT_FLAG_DEFRAG\t0x8000\n\nstruct tpacket_stats {\n\tunsigned int\ttp_packets;\n\tunsigned int\ttp_drops;\n};\n\nstruct tpacket_stats_v3 {\n\tunsigned int\ttp_packets;\n\tunsigned int\ttp_drops;\n\tunsigned int\ttp_freeze_q_cnt;\n};\n\nstruct tpacket_rollover_stats {\n\t__aligned_u64\ttp_all;\n\t__aligned_u64\ttp_huge;\n\t__aligned_u64\ttp_failed;\n};\n\nunion tpacket_stats_u {\n\tstruct tpacket_stats stats1;\n\tstruct tpacket_stats_v3 stats3;\n};\n\nstruct tpacket_auxdata {\n\t__u32\t\ttp_status;\n\t__u32\t\ttp_len;\n\t__u32\t\ttp_snaplen;\n\t__u16\t\ttp_mac;\n\t__u16\t\ttp_net;\n\t__u16\t\ttp_vlan_tci;\n\t__u16\t\ttp_vlan_tpid;\n};\n\n \n#define TP_STATUS_KERNEL\t\t      0\n#define TP_STATUS_USER\t\t\t(1 << 0)\n#define TP_STATUS_COPY\t\t\t(1 << 1)\n#define TP_STATUS_LOSING\t\t(1 << 2)\n#define TP_STATUS_CSUMNOTREADY\t\t(1 << 3)\n#define TP_STATUS_VLAN_VALID\t\t(1 << 4)  \n#define TP_STATUS_BLK_TMO\t\t(1 << 5)\n#define TP_STATUS_VLAN_TPID_VALID\t(1 << 6)  \n#define TP_STATUS_CSUM_VALID\t\t(1 << 7)\n#define TP_STATUS_GSO_TCP\t\t(1 << 8)\n\n \n#define TP_STATUS_AVAILABLE\t      0\n#define TP_STATUS_SEND_REQUEST\t(1 << 0)\n#define TP_STATUS_SENDING\t(1 << 1)\n#define TP_STATUS_WRONG_FORMAT\t(1 << 2)\n\n \n#define TP_STATUS_TS_SOFTWARE\t\t(1 << 29)\n#define TP_STATUS_TS_SYS_HARDWARE\t(1 << 30)  \n#define TP_STATUS_TS_RAW_HARDWARE\t(1U << 31)\n\n \n#define TP_FT_REQ_FILL_RXHASH\t0x1\n\nstruct tpacket_hdr {\n\tunsigned long\ttp_status;\n\tunsigned int\ttp_len;\n\tunsigned int\ttp_snaplen;\n\tunsigned short\ttp_mac;\n\tunsigned short\ttp_net;\n\tunsigned int\ttp_sec;\n\tunsigned int\ttp_usec;\n};\n\n#define TPACKET_ALIGNMENT\t16\n#define TPACKET_ALIGN(x)\t(((x)+TPACKET_ALIGNMENT-1)&~(TPACKET_ALIGNMENT-1))\n#define TPACKET_HDRLEN\t\t(TPACKET_ALIGN(sizeof(struct tpacket_hdr)) + sizeof(struct sockaddr_ll))\n\nstruct tpacket2_hdr {\n\t__u32\t\ttp_status;\n\t__u32\t\ttp_len;\n\t__u32\t\ttp_snaplen;\n\t__u16\t\ttp_mac;\n\t__u16\t\ttp_net;\n\t__u32\t\ttp_sec;\n\t__u32\t\ttp_nsec;\n\t__u16\t\ttp_vlan_tci;\n\t__u16\t\ttp_vlan_tpid;\n\t__u8\t\ttp_padding[4];\n};\n\nstruct tpacket_hdr_variant1 {\n\t__u32\ttp_rxhash;\n\t__u32\ttp_vlan_tci;\n\t__u16\ttp_vlan_tpid;\n\t__u16\ttp_padding;\n};\n\nstruct tpacket3_hdr {\n\t__u32\t\ttp_next_offset;\n\t__u32\t\ttp_sec;\n\t__u32\t\ttp_nsec;\n\t__u32\t\ttp_snaplen;\n\t__u32\t\ttp_len;\n\t__u32\t\ttp_status;\n\t__u16\t\ttp_mac;\n\t__u16\t\ttp_net;\n\t \n\tunion {\n\t\tstruct tpacket_hdr_variant1 hv1;\n\t};\n\t__u8\t\ttp_padding[8];\n};\n\nstruct tpacket_bd_ts {\n\tunsigned int ts_sec;\n\tunion {\n\t\tunsigned int ts_usec;\n\t\tunsigned int ts_nsec;\n\t};\n};\n\nstruct tpacket_hdr_v1 {\n\t__u32\tblock_status;\n\t__u32\tnum_pkts;\n\t__u32\toffset_to_first_pkt;\n\n\t \n\t__u32\tblk_len;\n\n\t \n\t__aligned_u64\tseq_num;\n\n\t \n\tstruct tpacket_bd_ts\tts_first_pkt, ts_last_pkt;\n};\n\nunion tpacket_bd_header_u {\n\tstruct tpacket_hdr_v1 bh1;\n};\n\nstruct tpacket_block_desc {\n\t__u32 version;\n\t__u32 offset_to_priv;\n\tunion tpacket_bd_header_u hdr;\n};\n\n#define TPACKET2_HDRLEN\t\t(TPACKET_ALIGN(sizeof(struct tpacket2_hdr)) + sizeof(struct sockaddr_ll))\n#define TPACKET3_HDRLEN\t\t(TPACKET_ALIGN(sizeof(struct tpacket3_hdr)) + sizeof(struct sockaddr_ll))\n\nenum tpacket_versions {\n\tTPACKET_V1,\n\tTPACKET_V2,\n\tTPACKET_V3\n};\n\n \n\nstruct tpacket_req {\n\tunsigned int\ttp_block_size;\t \n\tunsigned int\ttp_block_nr;\t \n\tunsigned int\ttp_frame_size;\t \n\tunsigned int\ttp_frame_nr;\t \n};\n\nstruct tpacket_req3 {\n\tunsigned int\ttp_block_size;\t \n\tunsigned int\ttp_block_nr;\t \n\tunsigned int\ttp_frame_size;\t \n\tunsigned int\ttp_frame_nr;\t \n\tunsigned int\ttp_retire_blk_tov;  \n\tunsigned int\ttp_sizeof_priv;  \n\tunsigned int\ttp_feature_req_word;\n};\n\nunion tpacket_req_u {\n\tstruct tpacket_req\treq;\n\tstruct tpacket_req3\treq3;\n};\n\nstruct packet_mreq {\n\tint\t\tmr_ifindex;\n\tunsigned short\tmr_type;\n\tunsigned short\tmr_alen;\n\tunsigned char\tmr_address[8];\n};\n\nstruct fanout_args {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\t__u16\t\tid;\n\t__u16\t\ttype_flags;\n#else\n\t__u16\t\ttype_flags;\n\t__u16\t\tid;\n#endif\n\t__u32\t\tmax_num_members;\n};\n\n#define PACKET_MR_MULTICAST\t0\n#define PACKET_MR_PROMISC\t1\n#define PACKET_MR_ALLMULTI\t2\n#define PACKET_MR_UNICAST\t3\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}