{
  "module_name": "ebtables.h",
  "hash_id": "5e88b1c137c583c2b138b0cbfafb9b04cb66262723731c8563d6b6facbfb40a4",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/linux/netfilter_bridge/ebtables.h",
  "human_readable_source": " \n \n\n#ifndef _UAPI__LINUX_BRIDGE_EFF_H\n#define _UAPI__LINUX_BRIDGE_EFF_H\n#include <linux/types.h>\n#include <linux/if.h>\n#include <linux/netfilter_bridge.h>\n\n#define EBT_TABLE_MAXNAMELEN 32\n#define EBT_CHAIN_MAXNAMELEN EBT_TABLE_MAXNAMELEN\n#define EBT_FUNCTION_MAXNAMELEN EBT_TABLE_MAXNAMELEN\n#define EBT_EXTENSION_MAXNAMELEN 31\n\n \n#define EBT_ACCEPT   -1\n#define EBT_DROP     -2\n#define EBT_CONTINUE -3\n#define EBT_RETURN   -4\n#define NUM_STANDARD_TARGETS   4\n \n#define EBT_VERDICT_BITS 0x0000000F\n\nstruct xt_match;\nstruct xt_target;\n\nstruct ebt_counter {\n\t__u64 pcnt;\n\t__u64 bcnt;\n};\n\nstruct ebt_replace {\n\tchar name[EBT_TABLE_MAXNAMELEN];\n\tunsigned int valid_hooks;\n\t \n\tunsigned int nentries;\n\t \n\tunsigned int entries_size;\n\t \n\tstruct ebt_entries __user *hook_entry[NF_BR_NUMHOOKS];\n\t \n\tunsigned int num_counters;\n\t \n\tstruct ebt_counter __user *counters;\n\tchar __user *entries;\n};\n\nstruct ebt_replace_kernel {\n\tchar name[EBT_TABLE_MAXNAMELEN];\n\tunsigned int valid_hooks;\n\t \n\tunsigned int nentries;\n\t \n\tunsigned int entries_size;\n\t \n\tstruct ebt_entries *hook_entry[NF_BR_NUMHOOKS];\n\t \n\tunsigned int num_counters;\n\t \n\tstruct ebt_counter *counters;\n\tchar *entries;\n};\n\nstruct ebt_entries {\n\t \n\tunsigned int distinguisher;\n\t \n\tchar name[EBT_CHAIN_MAXNAMELEN];\n\t \n\tunsigned int counter_offset;\n\t \n\tint policy;\n\t \n\tunsigned int nentries;\n\t \n\tchar data[] __attribute__ ((aligned (__alignof__(struct ebt_replace))));\n};\n\n \n\n \n#define EBT_ENTRY_OR_ENTRIES 0x01\n \n#define EBT_NOPROTO 0x02\n#define EBT_802_3 0x04\n#define EBT_SOURCEMAC 0x08\n#define EBT_DESTMAC 0x10\n#define EBT_F_MASK (EBT_NOPROTO | EBT_802_3 | EBT_SOURCEMAC | EBT_DESTMAC \\\n   | EBT_ENTRY_OR_ENTRIES)\n\n#define EBT_IPROTO 0x01\n#define EBT_IIN 0x02\n#define EBT_IOUT 0x04\n#define EBT_ISOURCE 0x8\n#define EBT_IDEST 0x10\n#define EBT_ILOGICALIN 0x20\n#define EBT_ILOGICALOUT 0x40\n#define EBT_INV_MASK (EBT_IPROTO | EBT_IIN | EBT_IOUT | EBT_ILOGICALIN \\\n   | EBT_ILOGICALOUT | EBT_ISOURCE | EBT_IDEST)\n\nstruct ebt_entry_match {\n\tunion {\n\t\tstruct {\n\t\t\tchar name[EBT_EXTENSION_MAXNAMELEN];\n\t\t\t__u8 revision;\n\t\t};\n\t\tstruct xt_match *match;\n\t} u;\n\t \n\tunsigned int match_size;\n\tunsigned char data[] __attribute__ ((aligned (__alignof__(struct ebt_replace))));\n};\n\nstruct ebt_entry_watcher {\n\tunion {\n\t\tstruct {\n\t\t\tchar name[EBT_EXTENSION_MAXNAMELEN];\n\t\t\t__u8 revision;\n\t\t};\n\t\tstruct xt_target *watcher;\n\t} u;\n\t \n\tunsigned int watcher_size;\n\tunsigned char data[] __attribute__ ((aligned (__alignof__(struct ebt_replace))));\n};\n\nstruct ebt_entry_target {\n\tunion {\n\t\tstruct {\n\t\t\tchar name[EBT_EXTENSION_MAXNAMELEN];\n\t\t\t__u8 revision;\n\t\t};\n\t\tstruct xt_target *target;\n\t} u;\n\t \n\tunsigned int target_size;\n\tunsigned char data[0] __attribute__ ((aligned (__alignof__(struct ebt_replace))));\n};\n\n#define EBT_STANDARD_TARGET \"standard\"\nstruct ebt_standard_target {\n\tstruct ebt_entry_target target;\n\tint verdict;\n};\n\n \nstruct ebt_entry {\n\t \n\tunsigned int bitmask;\n\tunsigned int invflags;\n\t__be16 ethproto;\n\t \n\tchar in[IFNAMSIZ];\n\t \n\tchar logical_in[IFNAMSIZ];\n\t \n\tchar out[IFNAMSIZ];\n\t \n\tchar logical_out[IFNAMSIZ];\n\tunsigned char sourcemac[ETH_ALEN];\n\tunsigned char sourcemsk[ETH_ALEN];\n\tunsigned char destmac[ETH_ALEN];\n\tunsigned char destmsk[ETH_ALEN];\n\t__struct_group( , offsets,  ,\n\t\t \n\t\tunsigned int watchers_offset;\n\t\t \n\t\tunsigned int target_offset;\n\t\t \n\t\tunsigned int next_offset;\n\t);\n\tunsigned char elems[] __attribute__ ((aligned (__alignof__(struct ebt_replace))));\n};\n\nstatic __inline__ struct ebt_entry_target *\nebt_get_target(struct ebt_entry *e)\n{\n\treturn (struct ebt_entry_target *)((char *)e + e->target_offset);\n}\n\n \n#define EBT_BASE_CTL            128\n\n#define EBT_SO_SET_ENTRIES      (EBT_BASE_CTL)\n#define EBT_SO_SET_COUNTERS     (EBT_SO_SET_ENTRIES+1)\n#define EBT_SO_SET_MAX          (EBT_SO_SET_COUNTERS+1)\n\n#define EBT_SO_GET_INFO         (EBT_BASE_CTL)\n#define EBT_SO_GET_ENTRIES      (EBT_SO_GET_INFO+1)\n#define EBT_SO_GET_INIT_INFO    (EBT_SO_GET_ENTRIES+1)\n#define EBT_SO_GET_INIT_ENTRIES (EBT_SO_GET_INIT_INFO+1)\n#define EBT_SO_GET_MAX          (EBT_SO_GET_INIT_ENTRIES+1)\n\n\n \n#define EBT_MATCH_ITERATE(e, fn, args...)                   \\\n({                                                          \\\n\tunsigned int __i;                                   \\\n\tint __ret = 0;                                      \\\n\tstruct ebt_entry_match *__match;                    \\\n\t                                                    \\\n\tfor (__i = sizeof(struct ebt_entry);                \\\n\t     __i < (e)->watchers_offset;                    \\\n\t     __i += __match->match_size +                   \\\n\t     sizeof(struct ebt_entry_match)) {              \\\n\t\t__match = (void *)(e) + __i;                \\\n\t\t                                            \\\n\t\t__ret = fn(__match , ## args);              \\\n\t\tif (__ret != 0)                             \\\n\t\t\tbreak;                              \\\n\t}                                                   \\\n\tif (__ret == 0) {                                   \\\n\t\tif (__i != (e)->watchers_offset)            \\\n\t\t\t__ret = -EINVAL;                    \\\n\t}                                                   \\\n\t__ret;                                              \\\n})\n\n#define EBT_WATCHER_ITERATE(e, fn, args...)                 \\\n({                                                          \\\n\tunsigned int __i;                                   \\\n\tint __ret = 0;                                      \\\n\tstruct ebt_entry_watcher *__watcher;                \\\n\t                                                    \\\n\tfor (__i = e->watchers_offset;                      \\\n\t     __i < (e)->target_offset;                      \\\n\t     __i += __watcher->watcher_size +               \\\n\t     sizeof(struct ebt_entry_watcher)) {            \\\n\t\t__watcher = (void *)(e) + __i;              \\\n\t\t                                            \\\n\t\t__ret = fn(__watcher , ## args);            \\\n\t\tif (__ret != 0)                             \\\n\t\t\tbreak;                              \\\n\t}                                                   \\\n\tif (__ret == 0) {                                   \\\n\t\tif (__i != (e)->target_offset)              \\\n\t\t\t__ret = -EINVAL;                    \\\n\t}                                                   \\\n\t__ret;                                              \\\n})\n\n#define EBT_ENTRY_ITERATE(entries, size, fn, args...)       \\\n({                                                          \\\n\tunsigned int __i;                                   \\\n\tint __ret = 0;                                      \\\n\tstruct ebt_entry *__entry;                          \\\n\t                                                    \\\n\tfor (__i = 0; __i < (size);) {                      \\\n\t\t__entry = (void *)(entries) + __i;          \\\n\t\t__ret = fn(__entry , ## args);              \\\n\t\tif (__ret != 0)                             \\\n\t\t\tbreak;                              \\\n\t\tif (__entry->bitmask != 0)                  \\\n\t\t\t__i += __entry->next_offset;        \\\n\t\telse                                        \\\n\t\t\t__i += sizeof(struct ebt_entries);  \\\n\t}                                                   \\\n\tif (__ret == 0) {                                   \\\n\t\tif (__i != (size))                          \\\n\t\t\t__ret = -EINVAL;                    \\\n\t}                                                   \\\n\t__ret;                                              \\\n})\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}