{
  "module_name": "batadv_packet.h",
  "hash_id": "969172f88ae6fb0919809bf199b152e394737bccaadcc64c52e5f96a7568a85c",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/linux/batadv_packet.h",
  "human_readable_source": " \n \n\n#ifndef _UAPI_LINUX_BATADV_PACKET_H_\n#define _UAPI_LINUX_BATADV_PACKET_H_\n\n#include <asm/byteorder.h>\n#include <linux/if_ether.h>\n#include <linux/types.h>\n\n \n#define batadv_tp_is_error(n) ((__u8)(n) > 127 ? 1 : 0)\n\n \nenum batadv_packettype {\n\t \n\tBATADV_IV_OGM           = 0x00,\n\tBATADV_BCAST            = 0x01,\n\tBATADV_CODED            = 0x02,\n\tBATADV_ELP\t\t= 0x03,\n\tBATADV_OGM2\t\t= 0x04,\n\tBATADV_MCAST            = 0x05,\n\t \n#define BATADV_UNICAST_MIN     0x40\n\tBATADV_UNICAST          = 0x40,\n\tBATADV_UNICAST_FRAG     = 0x41,\n\tBATADV_UNICAST_4ADDR    = 0x42,\n\tBATADV_ICMP             = 0x43,\n\tBATADV_UNICAST_TVLV     = 0x44,\n#define BATADV_UNICAST_MAX     0x7f\n\t \n};\n\n \nenum batadv_subtype {\n\tBATADV_P_DATA\t\t\t= 0x01,\n\tBATADV_P_DAT_DHT_GET\t\t= 0x02,\n\tBATADV_P_DAT_DHT_PUT\t\t= 0x03,\n\tBATADV_P_DAT_CACHE_REPLY\t= 0x04,\n};\n\n \n#define BATADV_COMPAT_VERSION 15\n\n \nenum batadv_iv_flags {\n\tBATADV_NOT_BEST_NEXT_HOP   = 1UL << 0,\n\tBATADV_PRIMARIES_FIRST_HOP = 1UL << 1,\n\tBATADV_DIRECTLINK          = 1UL << 2,\n};\n\n \nenum batadv_icmp_packettype {\n\tBATADV_ECHO_REPLY\t       = 0,\n\tBATADV_DESTINATION_UNREACHABLE = 3,\n\tBATADV_ECHO_REQUEST\t       = 8,\n\tBATADV_TTL_EXCEEDED\t       = 11,\n\tBATADV_PARAMETER_PROBLEM       = 12,\n\tBATADV_TP\t\t       = 15,\n};\n\n \nenum batadv_mcast_flags {\n\tBATADV_MCAST_WANT_ALL_UNSNOOPABLES\t= 1UL << 0,\n\tBATADV_MCAST_WANT_ALL_IPV4\t\t= 1UL << 1,\n\tBATADV_MCAST_WANT_ALL_IPV6\t\t= 1UL << 2,\n\tBATADV_MCAST_WANT_NO_RTR4\t\t= 1UL << 3,\n\tBATADV_MCAST_WANT_NO_RTR6\t\t= 1UL << 4,\n};\n\n \n#define BATADV_TT_DATA_TYPE_MASK 0x0F\n\n \nenum batadv_tt_data_flags {\n\tBATADV_TT_OGM_DIFF   = 1UL << 0,\n\tBATADV_TT_REQUEST    = 1UL << 1,\n\tBATADV_TT_RESPONSE   = 1UL << 2,\n\tBATADV_TT_FULL_TABLE = 1UL << 4,\n};\n\n \nenum batadv_vlan_flags {\n\tBATADV_VLAN_HAS_TAG\t= 1UL << 15,\n};\n\n \nenum batadv_bla_claimframe {\n\tBATADV_CLAIM_TYPE_CLAIM\t\t= 0x00,\n\tBATADV_CLAIM_TYPE_UNCLAIM\t= 0x01,\n\tBATADV_CLAIM_TYPE_ANNOUNCE\t= 0x02,\n\tBATADV_CLAIM_TYPE_REQUEST\t= 0x03,\n\tBATADV_CLAIM_TYPE_LOOPDETECT\t= 0x04,\n};\n\n \nenum batadv_tvlv_type {\n\tBATADV_TVLV_GW\t\t= 0x01,\n\tBATADV_TVLV_DAT\t\t= 0x02,\n\tBATADV_TVLV_NC\t\t= 0x03,\n\tBATADV_TVLV_TT\t\t= 0x04,\n\tBATADV_TVLV_ROAM\t= 0x05,\n\tBATADV_TVLV_MCAST\t= 0x06,\n};\n\n#pragma pack(2)\n \nstruct batadv_bla_claim_dst {\n\t__u8   magic[3];\t \n\t__u8   type;\t\t \n\t__be16 group;\t\t \n};\n\n \nstruct batadv_ogm_packet {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   ttl;\n\t__u8   flags;\n\t__be32 seqno;\n\t__u8   orig[ETH_ALEN];\n\t__u8   prev_sender[ETH_ALEN];\n\t__u8   reserved;\n\t__u8   tq;\n\t__be16 tvlv_len;\n};\n\n#define BATADV_OGM_HLEN sizeof(struct batadv_ogm_packet)\n\n \nstruct batadv_ogm2_packet {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   ttl;\n\t__u8   flags;\n\t__be32 seqno;\n\t__u8   orig[ETH_ALEN];\n\t__be16 tvlv_len;\n\t__be32 throughput;\n};\n\n#define BATADV_OGM2_HLEN sizeof(struct batadv_ogm2_packet)\n\n \nstruct batadv_elp_packet {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   orig[ETH_ALEN];\n\t__be32 seqno;\n\t__be32 elp_interval;\n};\n\n#define BATADV_ELP_HLEN sizeof(struct batadv_elp_packet)\n\n \nstruct batadv_icmp_header {\n\t__u8 packet_type;\n\t__u8 version;\n\t__u8 ttl;\n\t__u8 msg_type;  \n\t__u8 dst[ETH_ALEN];\n\t__u8 orig[ETH_ALEN];\n\t__u8 uid;\n\t__u8 align[3];\n};\n\n \nstruct batadv_icmp_packet {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   ttl;\n\t__u8   msg_type;  \n\t__u8   dst[ETH_ALEN];\n\t__u8   orig[ETH_ALEN];\n\t__u8   uid;\n\t__u8   reserved;\n\t__be16 seqno;\n};\n\n \nstruct batadv_icmp_tp_packet {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   ttl;\n\t__u8   msg_type;  \n\t__u8   dst[ETH_ALEN];\n\t__u8   orig[ETH_ALEN];\n\t__u8   uid;\n\t__u8   subtype;\n\t__u8   session[2];\n\t__be32 seqno;\n\t__be32 timestamp;\n};\n\n \nenum batadv_icmp_tp_subtype {\n\tBATADV_TP_MSG\t= 0,\n\tBATADV_TP_ACK,\n};\n\n#define BATADV_RR_LEN 16\n\n \nstruct batadv_icmp_packet_rr {\n\t__u8   packet_type;\n\t__u8   version;\n\t__u8   ttl;\n\t__u8   msg_type;  \n\t__u8   dst[ETH_ALEN];\n\t__u8   orig[ETH_ALEN];\n\t__u8   uid;\n\t__u8   rr_cur;\n\t__be16 seqno;\n\t__u8   rr[BATADV_RR_LEN][ETH_ALEN];\n};\n\n#define BATADV_ICMP_MAX_PACKET_SIZE\tsizeof(struct batadv_icmp_packet_rr)\n\n \n\n \nstruct batadv_unicast_packet {\n\t__u8 packet_type;\n\t__u8 version;\n\t__u8 ttl;\n\t__u8 ttvn;  \n\t__u8 dest[ETH_ALEN];\n\t \n};\n\n \nstruct batadv_unicast_4addr_packet {\n\tstruct batadv_unicast_packet u;\n\t__u8 src[ETH_ALEN];\n\t__u8 subtype;\n\t__u8 reserved;\n\t \n};\n\n \nstruct batadv_frag_packet {\n\t__u8   packet_type;\n\t__u8   version;   \n\t__u8   ttl;\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t__u8   no:4;\n\t__u8   priority:3;\n\t__u8   reserved:1;\n#elif defined(__LITTLE_ENDIAN_BITFIELD)\n\t__u8   reserved:1;\n\t__u8   priority:3;\n\t__u8   no:4;\n#else\n#error \"unknown bitfield endianness\"\n#endif\n\t__u8   dest[ETH_ALEN];\n\t__u8   orig[ETH_ALEN];\n\t__be16 seqno;\n\t__be16 total_size;\n};\n\n \nstruct batadv_bcast_packet {\n\t__u8   packet_type;\n\t__u8   version;   \n\t__u8   ttl;\n\t__u8   reserved;\n\t__be32 seqno;\n\t__u8   orig[ETH_ALEN];\n\t \n};\n\n \nstruct batadv_coded_packet {\n\t__u8   packet_type;\n\t__u8   version;   \n\t__u8   ttl;\n\t__u8   first_ttvn;\n\t \n\t__u8   first_source[ETH_ALEN];\n\t__u8   first_orig_dest[ETH_ALEN];\n\t__be32 first_crc;\n\t__u8   second_ttl;\n\t__u8   second_ttvn;\n\t__u8   second_dest[ETH_ALEN];\n\t__u8   second_source[ETH_ALEN];\n\t__u8   second_orig_dest[ETH_ALEN];\n\t__be32 second_crc;\n\t__be16 coded_len;\n};\n\n \nstruct batadv_unicast_tvlv_packet {\n\t__u8   packet_type;\n\t__u8   version;   \n\t__u8   ttl;\n\t__u8   reserved;\n\t__u8   dst[ETH_ALEN];\n\t__u8   src[ETH_ALEN];\n\t__be16 tvlv_len;\n\t__u16  align;\n};\n\n \nstruct batadv_tvlv_hdr {\n\t__u8   type;\n\t__u8   version;\n\t__be16 len;\n};\n\n \nstruct batadv_tvlv_gateway_data {\n\t__be32 bandwidth_down;\n\t__be32 bandwidth_up;\n};\n\n \nstruct batadv_tvlv_tt_data {\n\t__u8   flags;\n\t__u8   ttvn;\n\t__be16 num_vlan;\n};\n\n \nstruct batadv_tvlv_tt_vlan_data {\n\t__be32 crc;\n\t__be16 vid;\n\t__u16  reserved;\n};\n\n \nstruct batadv_tvlv_tt_change {\n\t__u8   flags;\n\t__u8   reserved[3];\n\t__u8   addr[ETH_ALEN];\n\t__be16 vid;\n};\n\n \nstruct batadv_tvlv_roam_adv {\n\t__u8   client[ETH_ALEN];\n\t__be16 vid;\n};\n\n \nstruct batadv_tvlv_mcast_data {\n\t__u8 flags;\n\t__u8 reserved[3];\n};\n\n#pragma pack()\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}