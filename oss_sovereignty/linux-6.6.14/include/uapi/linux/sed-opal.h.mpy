{
  "module_name": "sed-opal.h",
  "hash_id": "7fdda889a6a7369cb2c395ae29ae193154a4623bd169e7561dfa1af09293fc51",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/linux/sed-opal.h",
  "human_readable_source": " \n \n\n#ifndef _UAPI_SED_OPAL_H\n#define _UAPI_SED_OPAL_H\n\n#include <linux/types.h>\n\n#define OPAL_KEY_MAX 256\n#define OPAL_MAX_LRS 9\n\nenum opal_mbr {\n\tOPAL_MBR_ENABLE = 0x0,\n\tOPAL_MBR_DISABLE = 0x01,\n};\n\nenum opal_mbr_done_flag {\n\tOPAL_MBR_NOT_DONE = 0x0,\n\tOPAL_MBR_DONE = 0x01\n};\n\nenum opal_user {\n\tOPAL_ADMIN1 = 0x0,\n\tOPAL_USER1 = 0x01,\n\tOPAL_USER2 = 0x02,\n\tOPAL_USER3 = 0x03,\n\tOPAL_USER4 = 0x04,\n\tOPAL_USER5 = 0x05,\n\tOPAL_USER6 = 0x06,\n\tOPAL_USER7 = 0x07,\n\tOPAL_USER8 = 0x08,\n\tOPAL_USER9 = 0x09,\n};\n\nenum opal_lock_state {\n\tOPAL_RO = 0x01,  \n\tOPAL_RW = 0x02,  \n\tOPAL_LK = 0x04,  \n};\n\nenum opal_lock_flags {\n\t \n\tOPAL_SAVE_FOR_LOCK = 0x01,\n};\n\nenum opal_key_type {\n\tOPAL_INCLUDED = 0,\t \n\tOPAL_KEYRING,\t\t \n};\n\nstruct opal_key {\n\t__u8 lr;\n\t__u8 key_len;\n\t__u8 key_type;\n\t__u8 __align[5];\n\t__u8 key[OPAL_KEY_MAX];\n};\n\nenum opal_revert_lsp_opts {\n\tOPAL_PRESERVE = 0x01,\n};\n\nstruct opal_lr_act {\n\tstruct opal_key key;\n\t__u32 sum;\n\t__u8 num_lrs;\n\t__u8 lr[OPAL_MAX_LRS];\n\t__u8 align[2];  \n};\n\nstruct opal_session_info {\n\t__u32 sum;\n\t__u32 who;\n\tstruct opal_key opal_key;\n};\n\nstruct opal_user_lr_setup {\n\t__u64 range_start;\n\t__u64 range_length;\n\t__u32 RLE;  \n\t__u32 WLE;  \n\tstruct opal_session_info session;\n};\n\nstruct opal_lr_status {\n\tstruct opal_session_info session;\n\t__u64 range_start;\n\t__u64 range_length;\n\t__u32 RLE;  \n\t__u32 WLE;  \n\t__u32 l_state;\n\t__u8  align[4];\n};\n\nstruct opal_lock_unlock {\n\tstruct opal_session_info session;\n\t__u32 l_state;\n\t__u16 flags;\n\t__u8 __align[2];\n};\n\nstruct opal_new_pw {\n\tstruct opal_session_info session;\n\n\t \n\tstruct opal_session_info new_user_pw;\n};\n\nstruct opal_mbr_data {\n\tstruct opal_key key;\n\t__u8 enable_disable;\n\t__u8 __align[7];\n};\n\nstruct opal_mbr_done {\n\tstruct opal_key key;\n\t__u8 done_flag;\n\t__u8 __align[7];\n};\n\nstruct opal_shadow_mbr {\n\tstruct opal_key key;\n\tconst __u64 data;\n\t__u64 offset;\n\t__u64 size;\n};\n\n \nenum opal_table_ops {\n\tOPAL_READ_TABLE,\n\tOPAL_WRITE_TABLE,\n};\n\n#define OPAL_UID_LENGTH 8\nstruct opal_read_write_table {\n\tstruct opal_key key;\n\tconst __u64 data;\n\tconst __u8 table_uid[OPAL_UID_LENGTH];\n\t__u64 offset;\n\t__u64 size;\n#define OPAL_TABLE_READ (1 << OPAL_READ_TABLE)\n#define OPAL_TABLE_WRITE (1 << OPAL_WRITE_TABLE)\n\t__u64 flags;\n\t__u64 priv;\n};\n\n#define OPAL_FL_SUPPORTED\t\t0x00000001\n#define OPAL_FL_LOCKING_SUPPORTED\t0x00000002\n#define OPAL_FL_LOCKING_ENABLED\t\t0x00000004\n#define OPAL_FL_LOCKED\t\t\t0x00000008\n#define OPAL_FL_MBR_ENABLED\t\t0x00000010\n#define OPAL_FL_MBR_DONE\t\t0x00000020\n#define OPAL_FL_SUM_SUPPORTED\t\t0x00000040\n\nstruct opal_status {\n\t__u32 flags;\n\t__u32 reserved;\n};\n\n \nstruct opal_geometry {\n\t__u8 align;\n\t__u32 logical_block_size;\n\t__u64 alignment_granularity;\n\t__u64 lowest_aligned_lba;\n\t__u8  __align[3];\n};\n\nstruct opal_discovery {\n\t__u64 data;\n\t__u64 size;\n};\n\nstruct opal_revert_lsp {\n\tstruct opal_key key;\n\t__u32 options;\n\t__u32 __pad;\n};\n\n#define IOC_OPAL_SAVE\t\t    _IOW('p', 220, struct opal_lock_unlock)\n#define IOC_OPAL_LOCK_UNLOCK\t    _IOW('p', 221, struct opal_lock_unlock)\n#define IOC_OPAL_TAKE_OWNERSHIP\t    _IOW('p', 222, struct opal_key)\n#define IOC_OPAL_ACTIVATE_LSP       _IOW('p', 223, struct opal_lr_act)\n#define IOC_OPAL_SET_PW             _IOW('p', 224, struct opal_new_pw)\n#define IOC_OPAL_ACTIVATE_USR       _IOW('p', 225, struct opal_session_info)\n#define IOC_OPAL_REVERT_TPR         _IOW('p', 226, struct opal_key)\n#define IOC_OPAL_LR_SETUP           _IOW('p', 227, struct opal_user_lr_setup)\n#define IOC_OPAL_ADD_USR_TO_LR      _IOW('p', 228, struct opal_lock_unlock)\n#define IOC_OPAL_ENABLE_DISABLE_MBR _IOW('p', 229, struct opal_mbr_data)\n#define IOC_OPAL_ERASE_LR           _IOW('p', 230, struct opal_session_info)\n#define IOC_OPAL_SECURE_ERASE_LR    _IOW('p', 231, struct opal_session_info)\n#define IOC_OPAL_PSID_REVERT_TPR    _IOW('p', 232, struct opal_key)\n#define IOC_OPAL_MBR_DONE           _IOW('p', 233, struct opal_mbr_done)\n#define IOC_OPAL_WRITE_SHADOW_MBR   _IOW('p', 234, struct opal_shadow_mbr)\n#define IOC_OPAL_GENERIC_TABLE_RW   _IOW('p', 235, struct opal_read_write_table)\n#define IOC_OPAL_GET_STATUS         _IOR('p', 236, struct opal_status)\n#define IOC_OPAL_GET_LR_STATUS      _IOW('p', 237, struct opal_lr_status)\n#define IOC_OPAL_GET_GEOMETRY       _IOR('p', 238, struct opal_geometry)\n#define IOC_OPAL_DISCOVERY          _IOW('p', 239, struct opal_discovery)\n#define IOC_OPAL_REVERT_LSP         _IOW('p', 240, struct opal_revert_lsp)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}