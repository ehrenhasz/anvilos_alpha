{
  "module_name": "xfrm.h",
  "hash_id": "4c2cdf0f384716f2ddf6492729748732958e39a83b3aa18f0969adcf1d21927e",
  "original_prompt": "Ingested from linux-6.6.14/include/uapi/linux/xfrm.h",
  "human_readable_source": " \n#ifndef _LINUX_XFRM_H\n#define _LINUX_XFRM_H\n\n#include <linux/in6.h>\n#include <linux/types.h>\n\n \n\n \ntypedef union {\n\t__be32\t\ta4;\n\t__be32\t\ta6[4];\n\tstruct in6_addr\tin6;\n} xfrm_address_t;\n\n \nstruct xfrm_id {\n\txfrm_address_t\tdaddr;\n\t__be32\t\tspi;\n\t__u8\t\tproto;\n};\n\nstruct xfrm_sec_ctx {\n\t__u8\tctx_doi;\n\t__u8\tctx_alg;\n\t__u16\tctx_len;\n\t__u32\tctx_sid;\n\tchar\tctx_str[];\n};\n\n \n#define XFRM_SC_DOI_RESERVED 0\n#define XFRM_SC_DOI_LSM 1\n\n \n#define XFRM_SC_ALG_RESERVED 0\n#define XFRM_SC_ALG_SELINUX 1\n\n \n\nstruct xfrm_selector {\n\txfrm_address_t\tdaddr;\n\txfrm_address_t\tsaddr;\n\t__be16\tdport;\n\t__be16\tdport_mask;\n\t__be16\tsport;\n\t__be16\tsport_mask;\n\t__u16\tfamily;\n\t__u8\tprefixlen_d;\n\t__u8\tprefixlen_s;\n\t__u8\tproto;\n\tint\tifindex;\n\t__kernel_uid32_t\tuser;\n};\n\n#define XFRM_INF (~(__u64)0)\n\nstruct xfrm_lifetime_cfg {\n\t__u64\tsoft_byte_limit;\n\t__u64\thard_byte_limit;\n\t__u64\tsoft_packet_limit;\n\t__u64\thard_packet_limit;\n\t__u64\tsoft_add_expires_seconds;\n\t__u64\thard_add_expires_seconds;\n\t__u64\tsoft_use_expires_seconds;\n\t__u64\thard_use_expires_seconds;\n};\n\nstruct xfrm_lifetime_cur {\n\t__u64\tbytes;\n\t__u64\tpackets;\n\t__u64\tadd_time;\n\t__u64\tuse_time;\n};\n\nstruct xfrm_replay_state {\n\t__u32\toseq;\n\t__u32\tseq;\n\t__u32\tbitmap;\n};\n\n#define XFRMA_REPLAY_ESN_MAX\t4096\n\nstruct xfrm_replay_state_esn {\n\tunsigned int\tbmp_len;\n\t__u32\t\toseq;\n\t__u32\t\tseq;\n\t__u32\t\toseq_hi;\n\t__u32\t\tseq_hi;\n\t__u32\t\treplay_window;\n\t__u32\t\tbmp[];\n};\n\nstruct xfrm_algo {\n\tchar\t\talg_name[64];\n\tunsigned int\talg_key_len;     \n\tchar\t\talg_key[];\n};\n\nstruct xfrm_algo_auth {\n\tchar\t\talg_name[64];\n\tunsigned int\talg_key_len;     \n\tunsigned int\talg_trunc_len;   \n\tchar\t\talg_key[];\n};\n\nstruct xfrm_algo_aead {\n\tchar\t\talg_name[64];\n\tunsigned int\talg_key_len;\t \n\tunsigned int\talg_icv_len;\t \n\tchar\t\talg_key[];\n};\n\nstruct xfrm_stats {\n\t__u32\treplay_window;\n\t__u32\treplay;\n\t__u32\tintegrity_failed;\n};\n\nenum {\n\tXFRM_POLICY_TYPE_MAIN\t= 0,\n\tXFRM_POLICY_TYPE_SUB\t= 1,\n\tXFRM_POLICY_TYPE_MAX\t= 2,\n\tXFRM_POLICY_TYPE_ANY\t= 255\n};\n\nenum {\n\tXFRM_POLICY_IN\t= 0,\n\tXFRM_POLICY_OUT\t= 1,\n\tXFRM_POLICY_FWD\t= 2,\n\tXFRM_POLICY_MASK = 3,\n\tXFRM_POLICY_MAX\t= 3\n};\n\nenum {\n\tXFRM_SHARE_ANY,\t\t \n\tXFRM_SHARE_SESSION,\t \n\tXFRM_SHARE_USER,\t \n\tXFRM_SHARE_UNIQUE\t \n};\n\n#define XFRM_MODE_TRANSPORT 0\n#define XFRM_MODE_TUNNEL 1\n#define XFRM_MODE_ROUTEOPTIMIZATION 2\n#define XFRM_MODE_IN_TRIGGER 3\n#define XFRM_MODE_BEET 4\n#define XFRM_MODE_MAX 5\n\n \nenum {\n\tXFRM_MSG_BASE = 0x10,\n\n\tXFRM_MSG_NEWSA = 0x10,\n#define XFRM_MSG_NEWSA XFRM_MSG_NEWSA\n\tXFRM_MSG_DELSA,\n#define XFRM_MSG_DELSA XFRM_MSG_DELSA\n\tXFRM_MSG_GETSA,\n#define XFRM_MSG_GETSA XFRM_MSG_GETSA\n\n\tXFRM_MSG_NEWPOLICY,\n#define XFRM_MSG_NEWPOLICY XFRM_MSG_NEWPOLICY\n\tXFRM_MSG_DELPOLICY,\n#define XFRM_MSG_DELPOLICY XFRM_MSG_DELPOLICY\n\tXFRM_MSG_GETPOLICY,\n#define XFRM_MSG_GETPOLICY XFRM_MSG_GETPOLICY\n\n\tXFRM_MSG_ALLOCSPI,\n#define XFRM_MSG_ALLOCSPI XFRM_MSG_ALLOCSPI\n\tXFRM_MSG_ACQUIRE,\n#define XFRM_MSG_ACQUIRE XFRM_MSG_ACQUIRE\n\tXFRM_MSG_EXPIRE,\n#define XFRM_MSG_EXPIRE XFRM_MSG_EXPIRE\n\n\tXFRM_MSG_UPDPOLICY,\n#define XFRM_MSG_UPDPOLICY XFRM_MSG_UPDPOLICY\n\tXFRM_MSG_UPDSA,\n#define XFRM_MSG_UPDSA XFRM_MSG_UPDSA\n\n\tXFRM_MSG_POLEXPIRE,\n#define XFRM_MSG_POLEXPIRE XFRM_MSG_POLEXPIRE\n\n\tXFRM_MSG_FLUSHSA,\n#define XFRM_MSG_FLUSHSA XFRM_MSG_FLUSHSA\n\tXFRM_MSG_FLUSHPOLICY,\n#define XFRM_MSG_FLUSHPOLICY XFRM_MSG_FLUSHPOLICY\n\n\tXFRM_MSG_NEWAE,\n#define XFRM_MSG_NEWAE XFRM_MSG_NEWAE\n\tXFRM_MSG_GETAE,\n#define XFRM_MSG_GETAE XFRM_MSG_GETAE\n\n\tXFRM_MSG_REPORT,\n#define XFRM_MSG_REPORT XFRM_MSG_REPORT\n\n\tXFRM_MSG_MIGRATE,\n#define XFRM_MSG_MIGRATE XFRM_MSG_MIGRATE\n\n\tXFRM_MSG_NEWSADINFO,\n#define XFRM_MSG_NEWSADINFO XFRM_MSG_NEWSADINFO\n\tXFRM_MSG_GETSADINFO,\n#define XFRM_MSG_GETSADINFO XFRM_MSG_GETSADINFO\n\n\tXFRM_MSG_NEWSPDINFO,\n#define XFRM_MSG_NEWSPDINFO XFRM_MSG_NEWSPDINFO\n\tXFRM_MSG_GETSPDINFO,\n#define XFRM_MSG_GETSPDINFO XFRM_MSG_GETSPDINFO\n\n\tXFRM_MSG_MAPPING,\n#define XFRM_MSG_MAPPING XFRM_MSG_MAPPING\n\n\tXFRM_MSG_SETDEFAULT,\n#define XFRM_MSG_SETDEFAULT XFRM_MSG_SETDEFAULT\n\tXFRM_MSG_GETDEFAULT,\n#define XFRM_MSG_GETDEFAULT XFRM_MSG_GETDEFAULT\n\t__XFRM_MSG_MAX\n};\n#define XFRM_MSG_MAX (__XFRM_MSG_MAX - 1)\n\n#define XFRM_NR_MSGTYPES (XFRM_MSG_MAX + 1 - XFRM_MSG_BASE)\n\n \nstruct xfrm_user_sec_ctx {\n\t__u16\t\t\tlen;\n\t__u16\t\t\texttype;\n\t__u8\t\t\tctx_alg;   \n\t__u8\t\t\tctx_doi;\n\t__u16\t\t\tctx_len;\n};\n\nstruct xfrm_user_tmpl {\n\tstruct xfrm_id\t\tid;\n\t__u16\t\t\tfamily;\n\txfrm_address_t\t\tsaddr;\n\t__u32\t\t\treqid;\n\t__u8\t\t\tmode;\n\t__u8\t\t\tshare;\n\t__u8\t\t\toptional;\n\t__u32\t\t\taalgos;\n\t__u32\t\t\tealgos;\n\t__u32\t\t\tcalgos;\n};\n\nstruct xfrm_encap_tmpl {\n\t__u16\t\tencap_type;\n\t__be16\t\tencap_sport;\n\t__be16\t\tencap_dport;\n\txfrm_address_t\tencap_oa;\n};\n\n \nenum xfrm_ae_ftype_t {\n\tXFRM_AE_UNSPEC,\n\tXFRM_AE_RTHR=1,\t \n\tXFRM_AE_RVAL=2,  \n\tXFRM_AE_LVAL=4,  \n\tXFRM_AE_ETHR=8,  \n\tXFRM_AE_CR=16,  \n\tXFRM_AE_CE=32,  \n\tXFRM_AE_CU=64,  \n\t__XFRM_AE_MAX\n\n#define XFRM_AE_MAX (__XFRM_AE_MAX - 1)\n};\n\nstruct xfrm_userpolicy_type {\n\t__u8\t\ttype;\n\t__u16\t\treserved1;\n\t__u8\t\treserved2;\n};\n\n \nenum xfrm_attr_type_t {\n\tXFRMA_UNSPEC,\n\tXFRMA_ALG_AUTH,\t\t \n\tXFRMA_ALG_CRYPT,\t \n\tXFRMA_ALG_COMP,\t\t \n\tXFRMA_ENCAP,\t\t \n\tXFRMA_TMPL,\t\t \n\tXFRMA_SA,\t\t \n\tXFRMA_POLICY,\t\t \n\tXFRMA_SEC_CTX,\t\t \n\tXFRMA_LTIME_VAL,\n\tXFRMA_REPLAY_VAL,\n\tXFRMA_REPLAY_THRESH,\n\tXFRMA_ETIMER_THRESH,\n\tXFRMA_SRCADDR,\t\t \n\tXFRMA_COADDR,\t\t \n\tXFRMA_LASTUSED,\t\t \n\tXFRMA_POLICY_TYPE,\t \n\tXFRMA_MIGRATE,\n\tXFRMA_ALG_AEAD,\t\t \n\tXFRMA_KMADDRESS,         \n\tXFRMA_ALG_AUTH_TRUNC,\t \n\tXFRMA_MARK,\t\t \n\tXFRMA_TFCPAD,\t\t \n\tXFRMA_REPLAY_ESN_VAL,\t \n\tXFRMA_SA_EXTRA_FLAGS,\t \n\tXFRMA_PROTO,\t\t \n\tXFRMA_ADDRESS_FILTER,\t \n\tXFRMA_PAD,\n\tXFRMA_OFFLOAD_DEV,\t \n\tXFRMA_SET_MARK,\t\t \n\tXFRMA_SET_MARK_MASK,\t \n\tXFRMA_IF_ID,\t\t \n\tXFRMA_MTIMER_THRESH,\t \n\t__XFRMA_MAX\n\n#define XFRMA_OUTPUT_MARK XFRMA_SET_MARK\t \n#define XFRMA_MAX (__XFRMA_MAX - 1)\n};\n\nstruct xfrm_mark {\n\t__u32           v;  \n\t__u32           m;  \n};\n\nenum xfrm_sadattr_type_t {\n\tXFRMA_SAD_UNSPEC,\n\tXFRMA_SAD_CNT,\n\tXFRMA_SAD_HINFO,\n\t__XFRMA_SAD_MAX\n\n#define XFRMA_SAD_MAX (__XFRMA_SAD_MAX - 1)\n};\n\nstruct xfrmu_sadhinfo {\n\t__u32 sadhcnt;  \n\t__u32 sadhmcnt;  \n};\n\nenum xfrm_spdattr_type_t {\n\tXFRMA_SPD_UNSPEC,\n\tXFRMA_SPD_INFO,\n\tXFRMA_SPD_HINFO,\n\tXFRMA_SPD_IPV4_HTHRESH,\n\tXFRMA_SPD_IPV6_HTHRESH,\n\t__XFRMA_SPD_MAX\n\n#define XFRMA_SPD_MAX (__XFRMA_SPD_MAX - 1)\n};\n\nstruct xfrmu_spdinfo {\n\t__u32 incnt;\n\t__u32 outcnt;\n\t__u32 fwdcnt;\n\t__u32 inscnt;\n\t__u32 outscnt;\n\t__u32 fwdscnt;\n};\n\nstruct xfrmu_spdhinfo {\n\t__u32 spdhcnt;\n\t__u32 spdhmcnt;\n};\n\nstruct xfrmu_spdhthresh {\n\t__u8 lbits;\n\t__u8 rbits;\n};\n\nstruct xfrm_usersa_info {\n\tstruct xfrm_selector\t\tsel;\n\tstruct xfrm_id\t\t\tid;\n\txfrm_address_t\t\t\tsaddr;\n\tstruct xfrm_lifetime_cfg\tlft;\n\tstruct xfrm_lifetime_cur\tcurlft;\n\tstruct xfrm_stats\t\tstats;\n\t__u32\t\t\t\tseq;\n\t__u32\t\t\t\treqid;\n\t__u16\t\t\t\tfamily;\n\t__u8\t\t\t\tmode;\t\t \n\t__u8\t\t\t\treplay_window;\n\t__u8\t\t\t\tflags;\n#define XFRM_STATE_NOECN\t1\n#define XFRM_STATE_DECAP_DSCP\t2\n#define XFRM_STATE_NOPMTUDISC\t4\n#define XFRM_STATE_WILDRECV\t8\n#define XFRM_STATE_ICMP\t\t16\n#define XFRM_STATE_AF_UNSPEC\t32\n#define XFRM_STATE_ALIGN4\t64\n#define XFRM_STATE_ESN\t\t128\n};\n\n#define XFRM_SA_XFLAG_DONT_ENCAP_DSCP\t1\n#define XFRM_SA_XFLAG_OSEQ_MAY_WRAP\t2\n\nstruct xfrm_usersa_id {\n\txfrm_address_t\t\t\tdaddr;\n\t__be32\t\t\t\tspi;\n\t__u16\t\t\t\tfamily;\n\t__u8\t\t\t\tproto;\n};\n\nstruct xfrm_aevent_id {\n\tstruct xfrm_usersa_id\t\tsa_id;\n\txfrm_address_t\t\t\tsaddr;\n\t__u32\t\t\t\tflags;\n\t__u32\t\t\t\treqid;\n};\n\nstruct xfrm_userspi_info {\n\tstruct xfrm_usersa_info\t\tinfo;\n\t__u32\t\t\t\tmin;\n\t__u32\t\t\t\tmax;\n};\n\nstruct xfrm_userpolicy_info {\n\tstruct xfrm_selector\t\tsel;\n\tstruct xfrm_lifetime_cfg\tlft;\n\tstruct xfrm_lifetime_cur\tcurlft;\n\t__u32\t\t\t\tpriority;\n\t__u32\t\t\t\tindex;\n\t__u8\t\t\t\tdir;\n\t__u8\t\t\t\taction;\n#define XFRM_POLICY_ALLOW\t0\n#define XFRM_POLICY_BLOCK\t1\n\t__u8\t\t\t\tflags;\n#define XFRM_POLICY_LOCALOK\t1\t \n\t \n#define XFRM_POLICY_ICMP\t2\n\t__u8\t\t\t\tshare;\n};\n\nstruct xfrm_userpolicy_id {\n\tstruct xfrm_selector\t\tsel;\n\t__u32\t\t\t\tindex;\n\t__u8\t\t\t\tdir;\n};\n\nstruct xfrm_user_acquire {\n\tstruct xfrm_id\t\t\tid;\n\txfrm_address_t\t\t\tsaddr;\n\tstruct xfrm_selector\t\tsel;\n\tstruct xfrm_userpolicy_info\tpolicy;\n\t__u32\t\t\t\taalgos;\n\t__u32\t\t\t\tealgos;\n\t__u32\t\t\t\tcalgos;\n\t__u32\t\t\t\tseq;\n};\n\nstruct xfrm_user_expire {\n\tstruct xfrm_usersa_info\t\tstate;\n\t__u8\t\t\t\thard;\n};\n\nstruct xfrm_user_polexpire {\n\tstruct xfrm_userpolicy_info\tpol;\n\t__u8\t\t\t\thard;\n};\n\nstruct xfrm_usersa_flush {\n\t__u8\t\t\t\tproto;\n};\n\nstruct xfrm_user_report {\n\t__u8\t\t\t\tproto;\n\tstruct xfrm_selector\t\tsel;\n};\n\n \nstruct xfrm_user_kmaddress {\n\txfrm_address_t                  local;\n\txfrm_address_t                  remote;\n\t__u32\t\t\t\treserved;\n\t__u16\t\t\t\tfamily;\n};\n\nstruct xfrm_user_migrate {\n\txfrm_address_t\t\t\told_daddr;\n\txfrm_address_t\t\t\told_saddr;\n\txfrm_address_t\t\t\tnew_daddr;\n\txfrm_address_t\t\t\tnew_saddr;\n\t__u8\t\t\t\tproto;\n\t__u8\t\t\t\tmode;\n\t__u16\t\t\t\treserved;\n\t__u32\t\t\t\treqid;\n\t__u16\t\t\t\told_family;\n\t__u16\t\t\t\tnew_family;\n};\n\nstruct xfrm_user_mapping {\n\tstruct xfrm_usersa_id\t\tid;\n\t__u32\t\t\t\treqid;\n\txfrm_address_t\t\t\told_saddr;\n\txfrm_address_t\t\t\tnew_saddr;\n\t__be16\t\t\t\told_sport;\n\t__be16\t\t\t\tnew_sport;\n};\n\nstruct xfrm_address_filter {\n\txfrm_address_t\t\t\tsaddr;\n\txfrm_address_t\t\t\tdaddr;\n\t__u16\t\t\t\tfamily;\n\t__u8\t\t\t\tsplen;\n\t__u8\t\t\t\tdplen;\n};\n\nstruct xfrm_user_offload {\n\tint\t\t\t\tifindex;\n\t__u8\t\t\t\tflags;\n};\n \n#define XFRM_OFFLOAD_IPV6\t1\n#define XFRM_OFFLOAD_INBOUND\t2\n \n#define XFRM_OFFLOAD_PACKET\t4\n\nstruct xfrm_userpolicy_default {\n#define XFRM_USERPOLICY_UNSPEC\t0\n#define XFRM_USERPOLICY_BLOCK\t1\n#define XFRM_USERPOLICY_ACCEPT\t2\n\t__u8\t\t\t\tin;\n\t__u8\t\t\t\tfwd;\n\t__u8\t\t\t\tout;\n};\n\n#ifndef __KERNEL__\n \n#define XFRMGRP_ACQUIRE\t\t1\n#define XFRMGRP_EXPIRE\t\t2\n#define XFRMGRP_SA\t\t4\n#define XFRMGRP_POLICY\t\t8\n#define XFRMGRP_REPORT\t\t0x20\n#endif\n\nenum xfrm_nlgroups {\n\tXFRMNLGRP_NONE,\n#define XFRMNLGRP_NONE\t\tXFRMNLGRP_NONE\n\tXFRMNLGRP_ACQUIRE,\n#define XFRMNLGRP_ACQUIRE\tXFRMNLGRP_ACQUIRE\n\tXFRMNLGRP_EXPIRE,\n#define XFRMNLGRP_EXPIRE\tXFRMNLGRP_EXPIRE\n\tXFRMNLGRP_SA,\n#define XFRMNLGRP_SA\t\tXFRMNLGRP_SA\n\tXFRMNLGRP_POLICY,\n#define XFRMNLGRP_POLICY\tXFRMNLGRP_POLICY\n\tXFRMNLGRP_AEVENTS,\n#define XFRMNLGRP_AEVENTS\tXFRMNLGRP_AEVENTS\n\tXFRMNLGRP_REPORT,\n#define XFRMNLGRP_REPORT\tXFRMNLGRP_REPORT\n\tXFRMNLGRP_MIGRATE,\n#define XFRMNLGRP_MIGRATE\tXFRMNLGRP_MIGRATE\n\tXFRMNLGRP_MAPPING,\n#define XFRMNLGRP_MAPPING\tXFRMNLGRP_MAPPING\n\t__XFRMNLGRP_MAX\n};\n#define XFRMNLGRP_MAX\t(__XFRMNLGRP_MAX - 1)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}