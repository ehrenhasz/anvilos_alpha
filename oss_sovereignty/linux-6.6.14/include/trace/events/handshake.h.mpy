{
  "module_name": "handshake.h",
  "hash_id": "a35a7b2834e69dc6e9ec555493320851d8b5365d667eefd4c43ccbd539d59c34",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/handshake.h",
  "human_readable_source": " \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM handshake\n\n#if !defined(_TRACE_HANDSHAKE_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_HANDSHAKE_H\n\n#include <linux/net.h>\n#include <net/tls_prot.h>\n#include <linux/tracepoint.h>\n#include <trace/events/net_probe_common.h>\n\n#define TLS_RECORD_TYPE_LIST \\\n\trecord_type(CHANGE_CIPHER_SPEC) \\\n\trecord_type(ALERT) \\\n\trecord_type(HANDSHAKE) \\\n\trecord_type(DATA) \\\n\trecord_type(HEARTBEAT) \\\n\trecord_type(TLS12_CID) \\\n\trecord_type_end(ACK)\n\n#undef record_type\n#undef record_type_end\n#define record_type(x)\t\tTRACE_DEFINE_ENUM(TLS_RECORD_TYPE_##x);\n#define record_type_end(x)\tTRACE_DEFINE_ENUM(TLS_RECORD_TYPE_##x);\n\nTLS_RECORD_TYPE_LIST\n\n#undef record_type\n#undef record_type_end\n#define record_type(x)\t\t{ TLS_RECORD_TYPE_##x, #x },\n#define record_type_end(x)\t{ TLS_RECORD_TYPE_##x, #x }\n\n#define show_tls_content_type(type) \\\n\t__print_symbolic(type, TLS_RECORD_TYPE_LIST)\n\nTRACE_DEFINE_ENUM(TLS_ALERT_LEVEL_WARNING);\nTRACE_DEFINE_ENUM(TLS_ALERT_LEVEL_FATAL);\n\n#define show_tls_alert_level(level) \\\n\t__print_symbolic(level, \\\n\t\t{ TLS_ALERT_LEVEL_WARNING,\t\"Warning\" }, \\\n\t\t{ TLS_ALERT_LEVEL_FATAL,\t\"Fatal\" })\n\n#define TLS_ALERT_DESCRIPTION_LIST \\\n\talert_description(CLOSE_NOTIFY) \\\n\talert_description(UNEXPECTED_MESSAGE) \\\n\talert_description(BAD_RECORD_MAC) \\\n\talert_description(RECORD_OVERFLOW) \\\n\talert_description(HANDSHAKE_FAILURE) \\\n\talert_description(BAD_CERTIFICATE) \\\n\talert_description(UNSUPPORTED_CERTIFICATE) \\\n\talert_description(CERTIFICATE_REVOKED) \\\n\talert_description(CERTIFICATE_EXPIRED) \\\n\talert_description(CERTIFICATE_UNKNOWN) \\\n\talert_description(ILLEGAL_PARAMETER) \\\n\talert_description(UNKNOWN_CA) \\\n\talert_description(ACCESS_DENIED) \\\n\talert_description(DECODE_ERROR) \\\n\talert_description(DECRYPT_ERROR) \\\n\talert_description(TOO_MANY_CIDS_REQUESTED) \\\n\talert_description(PROTOCOL_VERSION) \\\n\talert_description(INSUFFICIENT_SECURITY) \\\n\talert_description(INTERNAL_ERROR) \\\n\talert_description(INAPPROPRIATE_FALLBACK) \\\n\talert_description(USER_CANCELED) \\\n\talert_description(MISSING_EXTENSION) \\\n\talert_description(UNSUPPORTED_EXTENSION) \\\n\talert_description(UNRECOGNIZED_NAME) \\\n\talert_description(BAD_CERTIFICATE_STATUS_RESPONSE) \\\n\talert_description(UNKNOWN_PSK_IDENTITY) \\\n\talert_description(CERTIFICATE_REQUIRED) \\\n\talert_description_end(NO_APPLICATION_PROTOCOL)\n\n#undef alert_description\n#undef alert_description_end\n#define alert_description(x)\t\tTRACE_DEFINE_ENUM(TLS_ALERT_DESC_##x);\n#define alert_description_end(x)\tTRACE_DEFINE_ENUM(TLS_ALERT_DESC_##x);\n\nTLS_ALERT_DESCRIPTION_LIST\n\n#undef alert_description\n#undef alert_description_end\n#define alert_description(x)\t\t{ TLS_ALERT_DESC_##x, #x },\n#define alert_description_end(x)\t{ TLS_ALERT_DESC_##x, #x }\n\n#define show_tls_alert_description(desc) \\\n\t__print_symbolic(desc, TLS_ALERT_DESCRIPTION_LIST)\n\nDECLARE_EVENT_CLASS(handshake_event_class,\n\tTP_PROTO(\n\t\tconst struct net *net,\n\t\tconst struct handshake_req *req,\n\t\tconst struct sock *sk\n\t),\n\tTP_ARGS(net, req, sk),\n\tTP_STRUCT__entry(\n\t\t__field(const void *, req)\n\t\t__field(const void *, sk)\n\t\t__field(unsigned int, netns_ino)\n\t),\n\tTP_fast_assign(\n\t\t__entry->req = req;\n\t\t__entry->sk = sk;\n\t\t__entry->netns_ino = net->ns.inum;\n\t),\n\tTP_printk(\"req=%p sk=%p\",\n\t\t__entry->req, __entry->sk\n\t)\n);\n#define DEFINE_HANDSHAKE_EVENT(name)\t\t\t\t\\\n\tDEFINE_EVENT(handshake_event_class, name,\t\t\\\n\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\tconst struct net *net,\t\t\t\\\n\t\t\tconst struct handshake_req *req,\t\\\n\t\t\tconst struct sock *sk\t\t\t\\\n\t\t),\t\t\t\t\t\t\\\n\t\tTP_ARGS(net, req, sk))\n\nDECLARE_EVENT_CLASS(handshake_fd_class,\n\tTP_PROTO(\n\t\tconst struct net *net,\n\t\tconst struct handshake_req *req,\n\t\tconst struct sock *sk,\n\t\tint fd\n\t),\n\tTP_ARGS(net, req, sk, fd),\n\tTP_STRUCT__entry(\n\t\t__field(const void *, req)\n\t\t__field(const void *, sk)\n\t\t__field(int, fd)\n\t\t__field(unsigned int, netns_ino)\n\t),\n\tTP_fast_assign(\n\t\t__entry->req = req;\n\t\t__entry->sk = req->hr_sk;\n\t\t__entry->fd = fd;\n\t\t__entry->netns_ino = net->ns.inum;\n\t),\n\tTP_printk(\"req=%p sk=%p fd=%d\",\n\t\t__entry->req, __entry->sk, __entry->fd\n\t)\n);\n#define DEFINE_HANDSHAKE_FD_EVENT(name)\t\t\t\t\\\n\tDEFINE_EVENT(handshake_fd_class, name,\t\t\t\\\n\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\tconst struct net *net,\t\t\t\\\n\t\t\tconst struct handshake_req *req,\t\\\n\t\t\tconst struct sock *sk,\t\t\t\\\n\t\t\tint fd\t\t\t\t\t\\\n\t\t),\t\t\t\t\t\t\\\n\t\tTP_ARGS(net, req, sk, fd))\n\nDECLARE_EVENT_CLASS(handshake_error_class,\n\tTP_PROTO(\n\t\tconst struct net *net,\n\t\tconst struct handshake_req *req,\n\t\tconst struct sock *sk,\n\t\tint err\n\t),\n\tTP_ARGS(net, req, sk, err),\n\tTP_STRUCT__entry(\n\t\t__field(const void *, req)\n\t\t__field(const void *, sk)\n\t\t__field(int, err)\n\t\t__field(unsigned int, netns_ino)\n\t),\n\tTP_fast_assign(\n\t\t__entry->req = req;\n\t\t__entry->sk = sk;\n\t\t__entry->err = err;\n\t\t__entry->netns_ino = net->ns.inum;\n\t),\n\tTP_printk(\"req=%p sk=%p err=%d\",\n\t\t__entry->req, __entry->sk, __entry->err\n\t)\n);\n#define DEFINE_HANDSHAKE_ERROR(name)\t\t\t\t\\\n\tDEFINE_EVENT(handshake_error_class, name,\t\t\\\n\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\tconst struct net *net,\t\t\t\\\n\t\t\tconst struct handshake_req *req,\t\\\n\t\t\tconst struct sock *sk,\t\t\t\\\n\t\t\tint err\t\t\t\t\t\\\n\t\t),\t\t\t\t\t\t\\\n\t\tTP_ARGS(net, req, sk, err))\n\nDECLARE_EVENT_CLASS(handshake_alert_class,\n\tTP_PROTO(\n\t\tconst struct sock *sk,\n\t\tunsigned char level,\n\t\tunsigned char description\n\t),\n\tTP_ARGS(sk, level, description),\n\tTP_STRUCT__entry(\n\t\t \n\t\t__array(__u8, saddr, sizeof(struct sockaddr_in6))\n\t\t__array(__u8, daddr, sizeof(struct sockaddr_in6))\n\t\t__field(unsigned int, netns_ino)\n\t\t__field(unsigned long, level)\n\t\t__field(unsigned long, description)\n\t),\n\tTP_fast_assign(\n\t\tconst struct inet_sock *inet = inet_sk(sk);\n\n\t\tmemset(__entry->saddr, 0, sizeof(struct sockaddr_in6));\n\t\tmemset(__entry->daddr, 0, sizeof(struct sockaddr_in6));\n\t\tTP_STORE_ADDR_PORTS(__entry, inet, sk);\n\n\t\t__entry->netns_ino = sock_net(sk)->ns.inum;\n\t\t__entry->level = level;\n\t\t__entry->description = description;\n\t),\n\tTP_printk(\"src=%pISpc dest=%pISpc %s: %s\",\n\t\t__entry->saddr, __entry->daddr,\n\t\tshow_tls_alert_level(__entry->level),\n\t\tshow_tls_alert_description(__entry->description)\n\t)\n);\n#define DEFINE_HANDSHAKE_ALERT(name)\t\t\t\t\\\n\tDEFINE_EVENT(handshake_alert_class, name,\t\t\\\n\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\tconst struct sock *sk,\t\t\t\\\n\t\t\tunsigned char level,\t\t\t\\\n\t\t\tunsigned char description\t\t\\\n\t\t),\t\t\t\t\t\t\\\n\t\tTP_ARGS(sk, level, description))\n\n\n \n\nDEFINE_HANDSHAKE_EVENT(handshake_submit);\nDEFINE_HANDSHAKE_ERROR(handshake_submit_err);\nDEFINE_HANDSHAKE_EVENT(handshake_cancel);\nDEFINE_HANDSHAKE_EVENT(handshake_cancel_none);\nDEFINE_HANDSHAKE_EVENT(handshake_cancel_busy);\nDEFINE_HANDSHAKE_EVENT(handshake_destruct);\n\n\nTRACE_EVENT(handshake_complete,\n\tTP_PROTO(\n\t\tconst struct net *net,\n\t\tconst struct handshake_req *req,\n\t\tconst struct sock *sk,\n\t\tint status\n\t),\n\tTP_ARGS(net, req, sk, status),\n\tTP_STRUCT__entry(\n\t\t__field(const void *, req)\n\t\t__field(const void *, sk)\n\t\t__field(int, status)\n\t\t__field(unsigned int, netns_ino)\n\t),\n\tTP_fast_assign(\n\t\t__entry->req = req;\n\t\t__entry->sk = sk;\n\t\t__entry->status = status;\n\t\t__entry->netns_ino = net->ns.inum;\n\t),\n\tTP_printk(\"req=%p sk=%p status=%d\",\n\t\t__entry->req, __entry->sk, __entry->status\n\t)\n);\n\n \n\nDEFINE_HANDSHAKE_ERROR(handshake_notify_err);\nDEFINE_HANDSHAKE_FD_EVENT(handshake_cmd_accept);\nDEFINE_HANDSHAKE_ERROR(handshake_cmd_accept_err);\nDEFINE_HANDSHAKE_FD_EVENT(handshake_cmd_done);\nDEFINE_HANDSHAKE_ERROR(handshake_cmd_done_err);\n\n \n\nTRACE_EVENT(tls_contenttype,\n\tTP_PROTO(\n\t\tconst struct sock *sk,\n\t\tunsigned char type\n\t),\n\tTP_ARGS(sk, type),\n\tTP_STRUCT__entry(\n\t\t \n\t\t__array(__u8, saddr, sizeof(struct sockaddr_in6))\n\t\t__array(__u8, daddr, sizeof(struct sockaddr_in6))\n\t\t__field(unsigned int, netns_ino)\n\t\t__field(unsigned long, type)\n\t),\n\tTP_fast_assign(\n\t\tconst struct inet_sock *inet = inet_sk(sk);\n\n\t\tmemset(__entry->saddr, 0, sizeof(struct sockaddr_in6));\n\t\tmemset(__entry->daddr, 0, sizeof(struct sockaddr_in6));\n\t\tTP_STORE_ADDR_PORTS(__entry, inet, sk);\n\n\t\t__entry->netns_ino = sock_net(sk)->ns.inum;\n\t\t__entry->type = type;\n\t),\n\tTP_printk(\"src=%pISpc dest=%pISpc %s\",\n\t\t__entry->saddr, __entry->daddr,\n\t\tshow_tls_content_type(__entry->type)\n\t)\n);\n\n \n\nDEFINE_HANDSHAKE_ALERT(tls_alert_send);\nDEFINE_HANDSHAKE_ALERT(tls_alert_recv);\n\n#endif  \n\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}