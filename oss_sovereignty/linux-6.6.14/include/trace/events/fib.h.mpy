{
  "module_name": "fib.h",
  "hash_id": "7454e1ec66ad32ba270e3eb0f5ecad76aecb15fa7566a5cb4f3f5aa7dcd48957",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/fib.h",
  "human_readable_source": " \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM fib\n\n#if !defined(_TRACE_FIB_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_FIB_H\n\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <net/ip_fib.h>\n#include <linux/tracepoint.h>\n\nTRACE_EVENT(fib_table_lookup,\n\n\tTP_PROTO(u32 tb_id, const struct flowi4 *flp,\n\t\t const struct fib_nh_common *nhc, int err),\n\n\tTP_ARGS(tb_id, flp, nhc, err),\n\n\tTP_STRUCT__entry(\n\t\t__field(\tu32,\ttb_id\t\t)\n\t\t__field(\tint,\terr\t\t)\n\t\t__field(\tint,\toif\t\t)\n\t\t__field(\tint,\tiif\t\t)\n\t\t__field(\tu8,\tproto\t\t)\n\t\t__field(\t__u8,\ttos\t\t)\n\t\t__field(\t__u8,\tscope\t\t)\n\t\t__field(\t__u8,\tflags\t\t)\n\t\t__array(\t__u8,\tsrc,\t4\t)\n\t\t__array(\t__u8,\tdst,\t4\t)\n\t\t__array(\t__u8,\tgw4,\t4\t)\n\t\t__array(\t__u8,\tgw6,\t16\t)\n\t\t__field(\tu16,\tsport\t\t)\n\t\t__field(\tu16,\tdport\t\t)\n\t\t__array(char,  name,   IFNAMSIZ )\n\t),\n\n\tTP_fast_assign(\n\t\tstruct net_device *dev;\n\t\tstruct in6_addr *in6;\n\t\t__be32 *p32;\n\n\t\t__entry->tb_id = tb_id;\n\t\t__entry->err = err;\n\t\t__entry->oif = flp->flowi4_oif;\n\t\t__entry->iif = flp->flowi4_iif;\n\t\t__entry->tos = flp->flowi4_tos;\n\t\t__entry->scope = flp->flowi4_scope;\n\t\t__entry->flags = flp->flowi4_flags;\n\n\t\tp32 = (__be32 *) __entry->src;\n\t\t*p32 = flp->saddr;\n\n\t\tp32 = (__be32 *) __entry->dst;\n\t\t*p32 = flp->daddr;\n\n\t\t__entry->proto = flp->flowi4_proto;\n\t\tif (__entry->proto == IPPROTO_TCP ||\n\t\t    __entry->proto == IPPROTO_UDP) {\n\t\t\t__entry->sport = ntohs(flp->fl4_sport);\n\t\t\t__entry->dport = ntohs(flp->fl4_dport);\n\t\t} else {\n\t\t\t__entry->sport = 0;\n\t\t\t__entry->dport = 0;\n\t\t}\n\n\t\tdev = nhc ? nhc->nhc_dev : NULL;\n\t\tstrscpy(__entry->name, dev ? dev->name : \"-\", IFNAMSIZ);\n\n\t\tif (nhc) {\n\t\t\tif (nhc->nhc_gw_family == AF_INET) {\n\t\t\t\tp32 = (__be32 *) __entry->gw4;\n\t\t\t\t*p32 = nhc->nhc_gw.ipv4;\n\n\t\t\t\tin6 = (struct in6_addr *)__entry->gw6;\n\t\t\t\t*in6 = in6addr_any;\n\t\t\t} else if (nhc->nhc_gw_family == AF_INET6) {\n\t\t\t\tp32 = (__be32 *) __entry->gw4;\n\t\t\t\t*p32 = 0;\n\n\t\t\t\tin6 = (struct in6_addr *)__entry->gw6;\n\t\t\t\t*in6 = nhc->nhc_gw.ipv6;\n\t\t\t}\n\t\t} else {\n\t\t\tp32 = (__be32 *) __entry->gw4;\n\t\t\t*p32 = 0;\n\n\t\t\tin6 = (struct in6_addr *)__entry->gw6;\n\t\t\t*in6 = in6addr_any;\n\t\t}\n\t),\n\n\tTP_printk(\"table %u oif %d iif %d proto %u %pI4/%u -> %pI4/%u tos %d scope %d flags %x ==> dev %s gw %pI4/%pI6c err %d\",\n\t\t  __entry->tb_id, __entry->oif, __entry->iif, __entry->proto,\n\t\t  __entry->src, __entry->sport, __entry->dst, __entry->dport,\n\t\t  __entry->tos, __entry->scope, __entry->flags,\n\t\t  __entry->name, __entry->gw4, __entry->gw6, __entry->err)\n);\n#endif  \n\n \n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}