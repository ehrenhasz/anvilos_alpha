{
  "module_name": "rpcrdma.h",
  "hash_id": "487608cd2b7a5efde1ca911f02705a1d6883230e806267cdb42e610651d54785",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/rpcrdma.h",
  "human_readable_source": " \n \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM rpcrdma\n\n#if !defined(_TRACE_RPCRDMA_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_RPCRDMA_H\n\n#include <linux/scatterlist.h>\n#include <linux/sunrpc/rpc_rdma_cid.h>\n#include <linux/tracepoint.h>\n#include <rdma/ib_cm.h>\n\n#include <trace/misc/rdma.h>\n#include <trace/misc/sunrpc.h>\n\n \n\nDECLARE_EVENT_CLASS(rpcrdma_completion_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned long, status)\n\t\t__field(unsigned int, vendor_err)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->status = wc->status;\n\t\tif (wc->status)\n\t\t\t__entry->vendor_err = wc->vendor_err;\n\t\telse\n\t\t\t__entry->vendor_err = 0;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d status=%s (%lu/0x%x)\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\trdma_show_wc_status(__entry->status),\n\t\t__entry->status, __entry->vendor_err\n\t)\n);\n\n#define DEFINE_COMPLETION_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_completion_class, name,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_send_completion_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d\",\n\t\t__entry->cq_id, __entry->completion_id\n\t)\n);\n\n#define DEFINE_SEND_COMPLETION_EVENT(name)\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_send_completion_class, name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_send_flush_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned long, status)\n\t\t__field(unsigned int, vendor_err)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->status = wc->status;\n\t\t__entry->vendor_err = wc->vendor_err;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d status=%s (%lu/0x%x)\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\trdma_show_wc_status(__entry->status),\n\t\t__entry->status, __entry->vendor_err\n\t)\n);\n\n#define DEFINE_SEND_FLUSH_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_send_flush_class, name,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_mr_completion_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned long, status)\n\t\t__field(unsigned int, vendor_err)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->status = wc->status;\n\t\tif (wc->status)\n\t\t\t__entry->vendor_err = wc->vendor_err;\n\t\telse\n\t\t\t__entry->vendor_err = 0;\n\t),\n\n\tTP_printk(\"cq.id=%u mr.id=%d status=%s (%lu/0x%x)\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\trdma_show_wc_status(__entry->status),\n\t\t__entry->status, __entry->vendor_err\n\t)\n);\n\n#define DEFINE_MR_COMPLETION_EVENT(name)\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_mr_completion_class, name,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_receive_completion_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, received)\n\t\t__field(unsigned long, status)\n\t\t__field(unsigned int, vendor_err)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->status = wc->status;\n\t\tif (wc->status) {\n\t\t\t__entry->received = 0;\n\t\t\t__entry->vendor_err = wc->vendor_err;\n\t\t} else {\n\t\t\t__entry->received = wc->byte_len;\n\t\t\t__entry->vendor_err = 0;\n\t\t}\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d status=%s (%lu/0x%x) received=%u\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\trdma_show_wc_status(__entry->status),\n\t\t__entry->status, __entry->vendor_err,\n\t\t__entry->received\n\t)\n);\n\n#define DEFINE_RECEIVE_COMPLETION_EVENT(name)\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_receive_completion_class, name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_receive_success_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, received)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->received = wc->byte_len;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d received=%u\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->received\n\t)\n);\n\n#define DEFINE_RECEIVE_SUCCESS_EVENT(name)\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_receive_success_class, name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(rpcrdma_receive_flush_class,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid\n\t),\n\n\tTP_ARGS(wc, cid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned long, status)\n\t\t__field(unsigned int, vendor_err)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->status = wc->status;\n\t\t__entry->vendor_err = wc->vendor_err;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d status=%s (%lu/0x%x)\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\trdma_show_wc_status(__entry->status),\n\t\t__entry->status, __entry->vendor_err\n\t)\n);\n\n#define DEFINE_RECEIVE_FLUSH_EVENT(name)\t\t\t\t\\\n\t\tDEFINE_EVENT(rpcrdma_receive_flush_class, name,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct ib_wc *wc,\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(wc, cid))\n\nDECLARE_EVENT_CLASS(xprtrdma_reply_class,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_rep *rep\n\t),\n\n\tTP_ARGS(rep),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, xid)\n\t\t__field(u32, version)\n\t\t__field(u32, proc)\n\t\t__string(addr, rpcrdma_addrstr(rep->rr_rxprt))\n\t\t__string(port, rpcrdma_portstr(rep->rr_rxprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->xid = be32_to_cpu(rep->rr_xid);\n\t\t__entry->version = be32_to_cpu(rep->rr_vers);\n\t\t__entry->proc = be32_to_cpu(rep->rr_proc);\n\t\t__assign_str(addr, rpcrdma_addrstr(rep->rr_rxprt));\n\t\t__assign_str(port, rpcrdma_portstr(rep->rr_rxprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s xid=0x%08x version=%u proc=%u\",\n\t\t__get_str(addr), __get_str(port),\n\t\t__entry->xid, __entry->version, __entry->proc\n\t)\n);\n\n#define DEFINE_REPLY_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_reply_class,\t\t\t\\\n\t\t\t\txprtrdma_reply_##name##_err,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_rep *rep\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(rep))\n\nDECLARE_EVENT_CLASS(xprtrdma_rxprt,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt\n\t),\n\n\tTP_ARGS(r_xprt),\n\n\tTP_STRUCT__entry(\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s\",\n\t\t__get_str(addr), __get_str(port)\n\t)\n);\n\n#define DEFINE_RXPRT_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_rxprt, name,\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_xprt *r_xprt \\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(r_xprt))\n\nDECLARE_EVENT_CLASS(xprtrdma_connect_class,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tint rc\n\t),\n\n\tTP_ARGS(r_xprt, rc),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, rc)\n\t\t__field(int, connect_status)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->rc = rc;\n\t\t__entry->connect_status = r_xprt->rx_ep->re_connect_status;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s rc=%d connection status=%d\",\n\t\t__get_str(addr), __get_str(port),\n\t\t__entry->rc, __entry->connect_status\n\t)\n);\n\n#define DEFINE_CONN_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_connect_class, xprtrdma_##name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_xprt *r_xprt, \\\n\t\t\t\t\tint rc\t\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(r_xprt, rc))\n\nDECLARE_EVENT_CLASS(xprtrdma_rdch_event,\n\tTP_PROTO(\n\t\tconst struct rpc_task *task,\n\t\tunsigned int pos,\n\t\tstruct rpcrdma_mr *mr,\n\t\tint nsegs\n\t),\n\n\tTP_ARGS(task, pos, mr, nsegs),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(unsigned int, pos)\n\t\t__field(int, nents)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t\t__field(int, nsegs)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = task->tk_pid;\n\t\t__entry->client_id = task->tk_client->cl_clid;\n\t\t__entry->pos = pos;\n\t\t__entry->nents = mr->mr_nents;\n\t\t__entry->handle = mr->mr_handle;\n\t\t__entry->length = mr->mr_length;\n\t\t__entry->offset = mr->mr_offset;\n\t\t__entry->nsegs = nsegs;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER\n\t\t  \" pos=%u %u@0x%016llx:0x%08x (%s)\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__entry->pos, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle,\n\t\t__entry->nents < __entry->nsegs ? \"more\" : \"last\"\n\t)\n);\n\n#define DEFINE_RDCH_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_rdch_event, xprtrdma_chunk_##name,\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpc_task *task,\t\\\n\t\t\t\t\tunsigned int pos,\t\t\\\n\t\t\t\t\tstruct rpcrdma_mr *mr,\t\t\\\n\t\t\t\t\tint nsegs\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(task, pos, mr, nsegs))\n\nDECLARE_EVENT_CLASS(xprtrdma_wrch_event,\n\tTP_PROTO(\n\t\tconst struct rpc_task *task,\n\t\tstruct rpcrdma_mr *mr,\n\t\tint nsegs\n\t),\n\n\tTP_ARGS(task, mr, nsegs),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(int, nents)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t\t__field(int, nsegs)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = task->tk_pid;\n\t\t__entry->client_id = task->tk_client->cl_clid;\n\t\t__entry->nents = mr->mr_nents;\n\t\t__entry->handle = mr->mr_handle;\n\t\t__entry->length = mr->mr_length;\n\t\t__entry->offset = mr->mr_offset;\n\t\t__entry->nsegs = nsegs;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER\n\t\t  \" %u@0x%016llx:0x%08x (%s)\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__entry->length, (unsigned long long)__entry->offset,\n\t\t__entry->handle,\n\t\t__entry->nents < __entry->nsegs ? \"more\" : \"last\"\n\t)\n);\n\n#define DEFINE_WRCH_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_wrch_event, xprtrdma_chunk_##name,\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpc_task *task,\t\\\n\t\t\t\t\tstruct rpcrdma_mr *mr,\t\t\\\n\t\t\t\t\tint nsegs\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(task, mr, nsegs))\n\nTRACE_DEFINE_ENUM(DMA_BIDIRECTIONAL);\nTRACE_DEFINE_ENUM(DMA_TO_DEVICE);\nTRACE_DEFINE_ENUM(DMA_FROM_DEVICE);\nTRACE_DEFINE_ENUM(DMA_NONE);\n\n#define xprtrdma_show_direction(x)\t\t\t\t\t\\\n\t\t__print_symbolic(x,\t\t\t\t\t\\\n\t\t\t\t{ DMA_BIDIRECTIONAL, \"BIDIR\" },\t\t\\\n\t\t\t\t{ DMA_TO_DEVICE, \"TO_DEVICE\" },\t\t\\\n\t\t\t\t{ DMA_FROM_DEVICE, \"FROM_DEVICE\" },\t\\\n\t\t\t\t{ DMA_NONE, \"NONE\" })\n\nDECLARE_EVENT_CLASS(xprtrdma_mr_class,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr\n\t),\n\n\tTP_ARGS(mr),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, mr_id)\n\t\t__field(int, nents)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t\t__field(u32, dir)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpcrdma_req *req = mr->mr_req;\n\n\t\tif (req) {\n\t\t\tconst struct rpc_task *task = req->rl_slot.rq_task;\n\n\t\t\t__entry->task_id = task->tk_pid;\n\t\t\t__entry->client_id = task->tk_client->cl_clid;\n\t\t} else {\n\t\t\t__entry->task_id = 0;\n\t\t\t__entry->client_id = -1;\n\t\t}\n\t\t__entry->mr_id  = mr->mr_ibmr->res.id;\n\t\t__entry->nents  = mr->mr_nents;\n\t\t__entry->handle = mr->mr_handle;\n\t\t__entry->length = mr->mr_length;\n\t\t__entry->offset = mr->mr_offset;\n\t\t__entry->dir    = mr->mr_dir;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER\n\t\t  \" mr.id=%u nents=%d %u@0x%016llx:0x%08x (%s)\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__entry->mr_id, __entry->nents, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle,\n\t\txprtrdma_show_direction(__entry->dir)\n\t)\n);\n\n#define DEFINE_MR_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_mr_class,\t\t\t\t\\\n\t\t\t\txprtrdma_mr_##name,\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_mr *mr\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(mr))\n\nDECLARE_EVENT_CLASS(xprtrdma_anonymous_mr_class,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr\n\t),\n\n\tTP_ARGS(mr),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, mr_id)\n\t\t__field(int, nents)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t\t__field(u32, dir)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->mr_id  = mr->mr_ibmr->res.id;\n\t\t__entry->nents  = mr->mr_nents;\n\t\t__entry->handle = mr->mr_handle;\n\t\t__entry->length = mr->mr_length;\n\t\t__entry->offset = mr->mr_offset;\n\t\t__entry->dir    = mr->mr_dir;\n\t),\n\n\tTP_printk(\"mr.id=%u nents=%d %u@0x%016llx:0x%08x (%s)\",\n\t\t__entry->mr_id, __entry->nents, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle,\n\t\txprtrdma_show_direction(__entry->dir)\n\t)\n);\n\n#define DEFINE_ANON_MR_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_anonymous_mr_class,\t\t\\\n\t\t\t\txprtrdma_mr_##name,\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_mr *mr\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(mr))\n\nDECLARE_EVENT_CLASS(xprtrdma_callback_class,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tconst struct rpc_rqst *rqst\n\t),\n\n\tTP_ARGS(r_xprt, rqst),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, xid)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s xid=0x%08x\",\n\t\t__get_str(addr), __get_str(port), __entry->xid\n\t)\n);\n\n#define DEFINE_CALLBACK_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(xprtrdma_callback_class,\t\t\t\\\n\t\t\t\txprtrdma_cb_##name,\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpcrdma_xprt *r_xprt, \\\n\t\t\t\t\tconst struct rpc_rqst *rqst\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(r_xprt, rqst))\n\n \n\nTRACE_EVENT(xprtrdma_inline_thresh,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_ep *ep\n\t),\n\n\tTP_ARGS(ep),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, inline_send)\n\t\t__field(unsigned int, inline_recv)\n\t\t__field(unsigned int, max_send)\n\t\t__field(unsigned int, max_recv)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rdma_cm_id *id = ep->re_id;\n\n\t\t__entry->inline_send = ep->re_inline_send;\n\t\t__entry->inline_recv = ep->re_inline_recv;\n\t\t__entry->max_send = ep->re_max_inline_send;\n\t\t__entry->max_recv = ep->re_max_inline_recv;\n\t\tmemcpy(__entry->srcaddr, &id->route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id->route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"%pISpc -> %pISpc neg send/recv=%u/%u, calc send/recv=%u/%u\",\n\t\t__entry->srcaddr, __entry->dstaddr,\n\t\t__entry->inline_send, __entry->inline_recv,\n\t\t__entry->max_send, __entry->max_recv\n\t)\n);\n\nDEFINE_CONN_EVENT(connect);\nDEFINE_CONN_EVENT(disconnect);\n\nDEFINE_RXPRT_EVENT(xprtrdma_op_inject_dsc);\n\nTRACE_EVENT(xprtrdma_op_connect,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tunsigned long delay\n\t),\n\n\tTP_ARGS(r_xprt, delay),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned long, delay)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->delay = delay;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s delay=%lu\",\n\t\t__get_str(addr), __get_str(port), __entry->delay\n\t)\n);\n\n\nTRACE_EVENT(xprtrdma_op_set_cto,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tunsigned long connect,\n\t\tunsigned long reconnect\n\t),\n\n\tTP_ARGS(r_xprt, connect, reconnect),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned long, connect)\n\t\t__field(unsigned long, reconnect)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->connect = connect;\n\t\t__entry->reconnect = reconnect;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s connect=%lu reconnect=%lu\",\n\t\t__get_str(addr), __get_str(port),\n\t\t__entry->connect / HZ, __entry->reconnect / HZ\n\t)\n);\n\n \n\nTRACE_EVENT(xprtrdma_createmrs,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tunsigned int count\n\t),\n\n\tTP_ARGS(r_xprt, count),\n\n\tTP_STRUCT__entry(\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t\t__field(unsigned int, count)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->count = count;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s created %u MRs\",\n\t\t__get_str(addr), __get_str(port), __entry->count\n\t)\n);\n\nTRACE_EVENT(xprtrdma_nomrs_err,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tconst struct rpcrdma_req *req\n\t),\n\n\tTP_ARGS(r_xprt, req),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpc_rqst *rqst = &req->rl_slot;\n\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" peer=[%s]:%s\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__get_str(addr), __get_str(port)\n\t)\n);\n\nDEFINE_RDCH_EVENT(read);\nDEFINE_WRCH_EVENT(write);\nDEFINE_WRCH_EVENT(reply);\nDEFINE_WRCH_EVENT(wp);\n\nTRACE_DEFINE_ENUM(rpcrdma_noch);\nTRACE_DEFINE_ENUM(rpcrdma_noch_pullup);\nTRACE_DEFINE_ENUM(rpcrdma_noch_mapped);\nTRACE_DEFINE_ENUM(rpcrdma_readch);\nTRACE_DEFINE_ENUM(rpcrdma_areadch);\nTRACE_DEFINE_ENUM(rpcrdma_writech);\nTRACE_DEFINE_ENUM(rpcrdma_replych);\n\n#define xprtrdma_show_chunktype(x)\t\t\t\t\t\\\n\t\t__print_symbolic(x,\t\t\t\t\t\\\n\t\t\t\t{ rpcrdma_noch, \"inline\" },\t\t\\\n\t\t\t\t{ rpcrdma_noch_pullup, \"pullup\" },\t\\\n\t\t\t\t{ rpcrdma_noch_mapped, \"mapped\" },\t\\\n\t\t\t\t{ rpcrdma_readch, \"read list\" },\t\\\n\t\t\t\t{ rpcrdma_areadch, \"*read list\" },\t\\\n\t\t\t\t{ rpcrdma_writech, \"write list\" },\t\\\n\t\t\t\t{ rpcrdma_replych, \"reply chunk\" })\n\nTRACE_EVENT(xprtrdma_marshal,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_req *req,\n\t\tunsigned int rtype,\n\t\tunsigned int wtype\n\t),\n\n\tTP_ARGS(req, rtype, wtype),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(unsigned int, hdrlen)\n\t\t__field(unsigned int, headlen)\n\t\t__field(unsigned int, pagelen)\n\t\t__field(unsigned int, taillen)\n\t\t__field(unsigned int, rtype)\n\t\t__field(unsigned int, wtype)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpc_rqst *rqst = &req->rl_slot;\n\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t\t__entry->hdrlen = req->rl_hdrbuf.len;\n\t\t__entry->headlen = rqst->rq_snd_buf.head[0].iov_len;\n\t\t__entry->pagelen = rqst->rq_snd_buf.page_len;\n\t\t__entry->taillen = rqst->rq_snd_buf.tail[0].iov_len;\n\t\t__entry->rtype = rtype;\n\t\t__entry->wtype = wtype;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER\n\t\t  \" xid=0x%08x hdr=%u xdr=%u/%u/%u %s/%s\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->hdrlen,\n\t\t__entry->headlen, __entry->pagelen, __entry->taillen,\n\t\txprtrdma_show_chunktype(__entry->rtype),\n\t\txprtrdma_show_chunktype(__entry->wtype)\n\t)\n);\n\nTRACE_EVENT(xprtrdma_marshal_failed,\n\tTP_PROTO(const struct rpc_rqst *rqst,\n\t\t int ret\n\t),\n\n\tTP_ARGS(rqst, ret),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(int, ret)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t\t__entry->ret = ret;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x ret=%d\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->ret\n\t)\n);\n\nTRACE_EVENT(xprtrdma_prepsend_failed,\n\tTP_PROTO(const struct rpc_rqst *rqst,\n\t\t int ret\n\t),\n\n\tTP_ARGS(rqst, ret),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(int, ret)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t\t__entry->ret = ret;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x ret=%d\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->ret\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_send,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_req *req\n\t),\n\n\tTP_ARGS(req),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(int, num_sge)\n\t\t__field(int, signaled)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpc_rqst *rqst = &req->rl_slot;\n\t\tconst struct rpcrdma_sendctx *sc = req->rl_sendctx;\n\n\t\t__entry->cq_id = sc->sc_cid.ci_queue_id;\n\t\t__entry->completion_id = sc->sc_cid.ci_completion_id;\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client ?\n\t\t\t\t     rqst->rq_task->tk_client->cl_clid : -1;\n\t\t__entry->num_sge = req->rl_wr.num_sge;\n\t\t__entry->signaled = req->rl_wr.send_flags & IB_SEND_SIGNALED;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" cq.id=%u cid=%d (%d SGE%s) %s\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->num_sge, (__entry->num_sge == 1 ? \"\" : \"s\"),\n\t\t(__entry->signaled ? \"signaled\" : \"\")\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_send_err,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tconst struct rpcrdma_req *req,\n\t\tint rc\n\t),\n\n\tTP_ARGS(r_xprt, req, rc),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(int, rc)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpc_rqst *rqst = &req->rl_slot;\n\t\tconst struct rpcrdma_ep *ep = r_xprt->rx_ep;\n\n\t\t__entry->cq_id = ep ? ep->re_attr.recv_cq->res.id : 0;\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client ?\n\t\t\t\t     rqst->rq_task->tk_client->cl_clid : -1;\n\t\t__entry->rc = rc;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" cq.id=%u rc=%d\",\n\t\t__entry->task_id, __entry->client_id,\n\t\t__entry->cq_id, __entry->rc\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_recv,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_rep *rep\n\t),\n\n\tTP_ARGS(rep),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = rep->rr_cid.ci_queue_id;\n\t\t__entry->completion_id = rep->rr_cid.ci_completion_id;\n\t),\n\n\tTP_printk(\"cq.id=%d cid=%d\",\n\t\t__entry->cq_id, __entry->completion_id\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_recvs,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tunsigned int count\n\t),\n\n\tTP_ARGS(r_xprt, count),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(unsigned int, count)\n\t\t__field(int, posted)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpcrdma_ep *ep = r_xprt->rx_ep;\n\n\t\t__entry->cq_id = ep->re_attr.recv_cq->res.id;\n\t\t__entry->count = count;\n\t\t__entry->posted = ep->re_receive_count;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s cq.id=%d %u new recvs, %d active\",\n\t\t__get_str(addr), __get_str(port), __entry->cq_id,\n\t\t__entry->count, __entry->posted\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_recvs_err,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tint status\n\t),\n\n\tTP_ARGS(r_xprt, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, status)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpcrdma_ep *ep = r_xprt->rx_ep;\n\n\t\t__entry->cq_id = ep->re_attr.recv_cq->res.id;\n\t\t__entry->status = status;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s cq.id=%d rc=%d\",\n\t\t__get_str(addr), __get_str(port), __entry->cq_id,\n\t\t__entry->status\n\t)\n);\n\nTRACE_EVENT(xprtrdma_post_linv_err,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_req *req,\n\t\tint status\n\t),\n\n\tTP_ARGS(req, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(int, status)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct rpc_task *task = req->rl_slot.rq_task;\n\n\t\t__entry->task_id = task->tk_pid;\n\t\t__entry->client_id = task->tk_client->cl_clid;\n\t\t__entry->status = status;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" status=%d\",\n\t\t__entry->task_id, __entry->client_id, __entry->status\n\t)\n);\n\n \n\nDEFINE_RECEIVE_COMPLETION_EVENT(xprtrdma_wc_receive);\n\nDEFINE_COMPLETION_EVENT(xprtrdma_wc_send);\nDEFINE_MR_COMPLETION_EVENT(xprtrdma_wc_fastreg);\nDEFINE_MR_COMPLETION_EVENT(xprtrdma_wc_li);\nDEFINE_MR_COMPLETION_EVENT(xprtrdma_wc_li_wake);\nDEFINE_MR_COMPLETION_EVENT(xprtrdma_wc_li_done);\n\nTRACE_EVENT(xprtrdma_frwr_alloc,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr,\n\t\tint rc\n\t),\n\n\tTP_ARGS(mr, rc),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, mr_id)\n\t\t__field(int, rc)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->mr_id = mr->mr_ibmr->res.id;\n\t\t__entry->rc = rc;\n\t),\n\n\tTP_printk(\"mr.id=%u: rc=%d\",\n\t\t__entry->mr_id, __entry->rc\n\t)\n);\n\nTRACE_EVENT(xprtrdma_frwr_dereg,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr,\n\t\tint rc\n\t),\n\n\tTP_ARGS(mr, rc),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, mr_id)\n\t\t__field(int, nents)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t\t__field(u32, dir)\n\t\t__field(int, rc)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->mr_id  = mr->mr_ibmr->res.id;\n\t\t__entry->nents  = mr->mr_nents;\n\t\t__entry->handle = mr->mr_handle;\n\t\t__entry->length = mr->mr_length;\n\t\t__entry->offset = mr->mr_offset;\n\t\t__entry->dir    = mr->mr_dir;\n\t\t__entry->rc\t= rc;\n\t),\n\n\tTP_printk(\"mr.id=%u nents=%d %u@0x%016llx:0x%08x (%s): rc=%d\",\n\t\t__entry->mr_id, __entry->nents, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle,\n\t\txprtrdma_show_direction(__entry->dir),\n\t\t__entry->rc\n\t)\n);\n\nTRACE_EVENT(xprtrdma_frwr_sgerr,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr,\n\t\tint sg_nents\n\t),\n\n\tTP_ARGS(mr, sg_nents),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, mr_id)\n\t\t__field(u64, addr)\n\t\t__field(u32, dir)\n\t\t__field(int, nents)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->mr_id = mr->mr_ibmr->res.id;\n\t\t__entry->addr = mr->mr_sg->dma_address;\n\t\t__entry->dir = mr->mr_dir;\n\t\t__entry->nents = sg_nents;\n\t),\n\n\tTP_printk(\"mr.id=%u DMA addr=0x%llx (%s) sg_nents=%d\",\n\t\t__entry->mr_id, __entry->addr,\n\t\txprtrdma_show_direction(__entry->dir),\n\t\t__entry->nents\n\t)\n);\n\nTRACE_EVENT(xprtrdma_frwr_maperr,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_mr *mr,\n\t\tint num_mapped\n\t),\n\n\tTP_ARGS(mr, num_mapped),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, mr_id)\n\t\t__field(u64, addr)\n\t\t__field(u32, dir)\n\t\t__field(int, num_mapped)\n\t\t__field(int, nents)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->mr_id = mr->mr_ibmr->res.id;\n\t\t__entry->addr = mr->mr_sg->dma_address;\n\t\t__entry->dir = mr->mr_dir;\n\t\t__entry->num_mapped = num_mapped;\n\t\t__entry->nents = mr->mr_nents;\n\t),\n\n\tTP_printk(\"mr.id=%u DMA addr=0x%llx (%s) nents=%d of %d\",\n\t\t__entry->mr_id, __entry->addr,\n\t\txprtrdma_show_direction(__entry->dir),\n\t\t__entry->num_mapped, __entry->nents\n\t)\n);\n\nDEFINE_MR_EVENT(fastreg);\nDEFINE_MR_EVENT(localinv);\nDEFINE_MR_EVENT(reminv);\nDEFINE_MR_EVENT(map);\n\nDEFINE_ANON_MR_EVENT(unmap);\n\nTRACE_EVENT(xprtrdma_dma_maperr,\n\tTP_PROTO(\n\t\tu64 addr\n\t),\n\n\tTP_ARGS(addr),\n\n\tTP_STRUCT__entry(\n\t\t__field(u64, addr)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->addr = addr;\n\t),\n\n\tTP_printk(\"dma addr=0x%llx\\n\", __entry->addr)\n);\n\n \n\nTRACE_EVENT(xprtrdma_reply,\n\tTP_PROTO(\n\t\tconst struct rpc_task *task,\n\t\tconst struct rpcrdma_rep *rep,\n\t\tunsigned int credits\n\t),\n\n\tTP_ARGS(task, rep, credits),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(unsigned int, credits)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = task->tk_pid;\n\t\t__entry->client_id = task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rep->rr_xid);\n\t\t__entry->credits = credits;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x credits=%u\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->credits\n\t)\n);\n\nDEFINE_REPLY_EVENT(vers);\nDEFINE_REPLY_EVENT(rqst);\nDEFINE_REPLY_EVENT(short);\nDEFINE_REPLY_EVENT(hdr);\n\nTRACE_EVENT(xprtrdma_err_vers,\n\tTP_PROTO(\n\t\tconst struct rpc_rqst *rqst,\n\t\t__be32 *min,\n\t\t__be32 *max\n\t),\n\n\tTP_ARGS(rqst, min, max),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(u32, min)\n\t\t__field(u32, max)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t\t__entry->min = be32_to_cpup(min);\n\t\t__entry->max = be32_to_cpup(max);\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x versions=[%u, %u]\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->min, __entry->max\n\t)\n);\n\nTRACE_EVENT(xprtrdma_err_chunk,\n\tTP_PROTO(\n\t\tconst struct rpc_rqst *rqst\n\t),\n\n\tTP_ARGS(rqst),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->xid = be32_to_cpu(rqst->rq_xid);\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid\n\t)\n);\n\nTRACE_EVENT(xprtrdma_err_unrecognized,\n\tTP_PROTO(\n\t\tconst struct rpc_rqst *rqst,\n\t\t__be32 *procedure\n\t),\n\n\tTP_ARGS(rqst, procedure),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(u32, xid)\n\t\t__field(u32, procedure)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->procedure = be32_to_cpup(procedure);\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" xid=0x%08x procedure=%u\",\n\t\t__entry->task_id, __entry->client_id, __entry->xid,\n\t\t__entry->procedure\n\t)\n);\n\nTRACE_EVENT(xprtrdma_fixup,\n\tTP_PROTO(\n\t\tconst struct rpc_rqst *rqst,\n\t\tunsigned long fixup\n\t),\n\n\tTP_ARGS(rqst, fixup),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t\t__field(unsigned long, fixup)\n\t\t__field(size_t, headlen)\n\t\t__field(unsigned int, pagelen)\n\t\t__field(size_t, taillen)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = rqst->rq_task->tk_pid;\n\t\t__entry->client_id = rqst->rq_task->tk_client->cl_clid;\n\t\t__entry->fixup = fixup;\n\t\t__entry->headlen = rqst->rq_rcv_buf.head[0].iov_len;\n\t\t__entry->pagelen = rqst->rq_rcv_buf.page_len;\n\t\t__entry->taillen = rqst->rq_rcv_buf.tail[0].iov_len;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER \" fixup=%lu xdr=%zu/%u/%zu\",\n\t\t__entry->task_id, __entry->client_id, __entry->fixup,\n\t\t__entry->headlen, __entry->pagelen, __entry->taillen\n\t)\n);\n\nTRACE_EVENT(xprtrdma_decode_seg,\n\tTP_PROTO(\n\t\tu32 handle,\n\t\tu32 length,\n\t\tu64 offset\n\t),\n\n\tTP_ARGS(handle, length, offset),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->handle = handle;\n\t\t__entry->length = length;\n\t\t__entry->offset = offset;\n\t),\n\n\tTP_printk(\"%u@0x%016llx:0x%08x\",\n\t\t__entry->length, (unsigned long long)__entry->offset,\n\t\t__entry->handle\n\t)\n);\n\nTRACE_EVENT(xprtrdma_mrs_zap,\n\tTP_PROTO(\n\t\tconst struct rpc_task *task\n\t),\n\n\tTP_ARGS(task),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, task_id)\n\t\t__field(unsigned int, client_id)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->task_id = task->tk_pid;\n\t\t__entry->client_id = task->tk_client->cl_clid;\n\t),\n\n\tTP_printk(SUNRPC_TRACE_TASK_SPECIFIER,\n\t\t__entry->task_id, __entry->client_id\n\t)\n);\n\n \n\nTRACE_EVENT(xprtrdma_cb_setup,\n\tTP_PROTO(\n\t\tconst struct rpcrdma_xprt *r_xprt,\n\t\tunsigned int reqs\n\t),\n\n\tTP_ARGS(r_xprt, reqs),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, reqs)\n\t\t__string(addr, rpcrdma_addrstr(r_xprt))\n\t\t__string(port, rpcrdma_portstr(r_xprt))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->reqs = reqs;\n\t\t__assign_str(addr, rpcrdma_addrstr(r_xprt));\n\t\t__assign_str(port, rpcrdma_portstr(r_xprt));\n\t),\n\n\tTP_printk(\"peer=[%s]:%s %u reqs\",\n\t\t__get_str(addr), __get_str(port), __entry->reqs\n\t)\n);\n\nDEFINE_CALLBACK_EVENT(call);\nDEFINE_CALLBACK_EVENT(reply);\n\n \n\nDECLARE_EVENT_CLASS(svcrdma_accept_class,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tlong status\n\t),\n\n\tTP_ARGS(rdma, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(long, status)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->status = status;\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s status=%ld\",\n\t\t__get_str(addr), __entry->status\n\t)\n);\n\n#define DEFINE_ACCEPT_EVENT(name) \\\n\t\tDEFINE_EVENT(svcrdma_accept_class, svcrdma_##name##_err, \\\n\t\t\t\tTP_PROTO( \\\n\t\t\t\t\tconst struct svcxprt_rdma *rdma, \\\n\t\t\t\t\tlong status \\\n\t\t\t\t), \\\n\t\t\t\tTP_ARGS(rdma, status))\n\nDEFINE_ACCEPT_EVENT(pd);\nDEFINE_ACCEPT_EVENT(qp);\nDEFINE_ACCEPT_EVENT(fabric);\nDEFINE_ACCEPT_EVENT(initdepth);\nDEFINE_ACCEPT_EVENT(accept);\n\nTRACE_DEFINE_ENUM(RDMA_MSG);\nTRACE_DEFINE_ENUM(RDMA_NOMSG);\nTRACE_DEFINE_ENUM(RDMA_MSGP);\nTRACE_DEFINE_ENUM(RDMA_DONE);\nTRACE_DEFINE_ENUM(RDMA_ERROR);\n\n#define show_rpcrdma_proc(x)\t\t\t\t\t\t\\\n\t\t__print_symbolic(x,\t\t\t\t\t\\\n\t\t\t\t{ RDMA_MSG, \"RDMA_MSG\" },\t\t\\\n\t\t\t\t{ RDMA_NOMSG, \"RDMA_NOMSG\" },\t\t\\\n\t\t\t\t{ RDMA_MSGP, \"RDMA_MSGP\" },\t\t\\\n\t\t\t\t{ RDMA_DONE, \"RDMA_DONE\" },\t\t\\\n\t\t\t\t{ RDMA_ERROR, \"RDMA_ERROR\" })\n\nTRACE_EVENT(svcrdma_decode_rqst,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_recv_ctxt *ctxt,\n\t\t__be32 *p,\n\t\tunsigned int hdrlen\n\t),\n\n\tTP_ARGS(ctxt, p, hdrlen),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, xid)\n\t\t__field(u32, vers)\n\t\t__field(u32, proc)\n\t\t__field(u32, credits)\n\t\t__field(unsigned int, hdrlen)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->rc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->rc_cid.ci_completion_id;\n\t\t__entry->xid = be32_to_cpup(p++);\n\t\t__entry->vers = be32_to_cpup(p++);\n\t\t__entry->credits = be32_to_cpup(p++);\n\t\t__entry->proc = be32_to_cpup(p);\n\t\t__entry->hdrlen = hdrlen;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d xid=0x%08x vers=%u credits=%u proc=%s hdrlen=%u\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->xid, __entry->vers, __entry->credits,\n\t\tshow_rpcrdma_proc(__entry->proc), __entry->hdrlen)\n);\n\nTRACE_EVENT(svcrdma_decode_short_err,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_recv_ctxt *ctxt,\n\t\tunsigned int hdrlen\n\t),\n\n\tTP_ARGS(ctxt, hdrlen),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned int, hdrlen)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->rc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->rc_cid.ci_completion_id;\n\t\t__entry->hdrlen = hdrlen;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d hdrlen=%u\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->hdrlen)\n);\n\nDECLARE_EVENT_CLASS(svcrdma_badreq_event,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_recv_ctxt *ctxt,\n\t\t__be32 *p\n\t),\n\n\tTP_ARGS(ctxt, p),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, xid)\n\t\t__field(u32, vers)\n\t\t__field(u32, proc)\n\t\t__field(u32, credits)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->rc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->rc_cid.ci_completion_id;\n\t\t__entry->xid = be32_to_cpup(p++);\n\t\t__entry->vers = be32_to_cpup(p++);\n\t\t__entry->credits = be32_to_cpup(p++);\n\t\t__entry->proc = be32_to_cpup(p);\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d xid=0x%08x vers=%u credits=%u proc=%u\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->xid, __entry->vers, __entry->credits, __entry->proc)\n);\n\n#define DEFINE_BADREQ_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(svcrdma_badreq_event,\t\t\t\\\n\t\t\t     svcrdma_decode_##name##_err,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct svc_rdma_recv_ctxt *ctxt,\t\\\n\t\t\t\t\t__be32 *p\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(ctxt, p))\n\nDEFINE_BADREQ_EVENT(badvers);\nDEFINE_BADREQ_EVENT(drop);\nDEFINE_BADREQ_EVENT(badproc);\nDEFINE_BADREQ_EVENT(parse);\n\nTRACE_EVENT(svcrdma_encode_wseg,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_send_ctxt *ctxt,\n\t\tu32 segno,\n\t\tu32 handle,\n\t\tu32 length,\n\t\tu64 offset\n\t),\n\n\tTP_ARGS(ctxt, segno, handle, length, offset),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, segno)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->sc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->sc_cid.ci_completion_id;\n\t\t__entry->segno = segno;\n\t\t__entry->handle = handle;\n\t\t__entry->length = length;\n\t\t__entry->offset = offset;\n\t),\n\n\tTP_printk(\"cq_id=%u cid=%d segno=%u %u@0x%016llx:0x%08x\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->segno, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle\n\t)\n);\n\nTRACE_EVENT(svcrdma_decode_rseg,\n\tTP_PROTO(\n\t\tconst struct rpc_rdma_cid *cid,\n\t\tconst struct svc_rdma_chunk *chunk,\n\t\tconst struct svc_rdma_segment *segment\n\t),\n\n\tTP_ARGS(cid, chunk, segment),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, segno)\n\t\t__field(u32, position)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->segno = chunk->ch_segcount;\n\t\t__entry->position = chunk->ch_position;\n\t\t__entry->handle = segment->rs_handle;\n\t\t__entry->length = segment->rs_length;\n\t\t__entry->offset = segment->rs_offset;\n\t),\n\n\tTP_printk(\"cq_id=%u cid=%d segno=%u position=%u %u@0x%016llx:0x%08x\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->segno, __entry->position, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle\n\t)\n);\n\nTRACE_EVENT(svcrdma_decode_wseg,\n\tTP_PROTO(\n\t\tconst struct rpc_rdma_cid *cid,\n\t\tconst struct svc_rdma_chunk *chunk,\n\t\tu32 segno\n\t),\n\n\tTP_ARGS(cid, chunk, segno),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(u32, segno)\n\t\t__field(u32, handle)\n\t\t__field(u32, length)\n\t\t__field(u64, offset)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct svc_rdma_segment *segment =\n\t\t\t&chunk->ch_segments[segno];\n\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->segno = segno;\n\t\t__entry->handle = segment->rs_handle;\n\t\t__entry->length = segment->rs_length;\n\t\t__entry->offset = segment->rs_offset;\n\t),\n\n\tTP_printk(\"cq_id=%u cid=%d segno=%u %u@0x%016llx:0x%08x\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->segno, __entry->length,\n\t\t(unsigned long long)__entry->offset, __entry->handle\n\t)\n);\n\nDECLARE_EVENT_CLASS(svcrdma_error_event,\n\tTP_PROTO(\n\t\t__be32 xid\n\t),\n\n\tTP_ARGS(xid),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, xid)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->xid = be32_to_cpu(xid);\n\t),\n\n\tTP_printk(\"xid=0x%08x\",\n\t\t__entry->xid\n\t)\n);\n\n#define DEFINE_ERROR_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(svcrdma_error_event, svcrdma_err_##name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\t__be32 xid\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(xid))\n\nDEFINE_ERROR_EVENT(vers);\nDEFINE_ERROR_EVENT(chunk);\n\n \n\nDECLARE_EVENT_CLASS(svcrdma_dma_map_class,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tu64 dma_addr,\n\t\tu32 length\n\t),\n\n\tTP_ARGS(rdma, dma_addr, length),\n\n\tTP_STRUCT__entry(\n\t\t__field(u64, dma_addr)\n\t\t__field(u32, length)\n\t\t__string(device, rdma->sc_cm_id->device->name)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dma_addr = dma_addr;\n\t\t__entry->length = length;\n\t\t__assign_str(device, rdma->sc_cm_id->device->name);\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s device=%s dma_addr=%llu length=%u\",\n\t\t__get_str(addr), __get_str(device),\n\t\t__entry->dma_addr, __entry->length\n\t)\n);\n\n#define DEFINE_SVC_DMA_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(svcrdma_dma_map_class, svcrdma_##name,\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct svcxprt_rdma *rdma,\\\n\t\t\t\t\tu64 dma_addr,\t\t\t\\\n\t\t\t\t\tu32 length\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(rdma, dma_addr, length))\n\nDEFINE_SVC_DMA_EVENT(dma_map_page);\nDEFINE_SVC_DMA_EVENT(dma_map_err);\nDEFINE_SVC_DMA_EVENT(dma_unmap_page);\n\nTRACE_EVENT(svcrdma_dma_map_rw_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tunsigned int nents,\n\t\tint status\n\t),\n\n\tTP_ARGS(rdma, nents, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, status)\n\t\t__field(unsigned int, nents)\n\t\t__string(device, rdma->sc_cm_id->device->name)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->status = status;\n\t\t__entry->nents = nents;\n\t\t__assign_str(device, rdma->sc_cm_id->device->name);\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s device=%s nents=%u status=%d\",\n\t\t__get_str(addr), __get_str(device), __entry->nents,\n\t\t__entry->status\n\t)\n);\n\nTRACE_EVENT(svcrdma_no_rwctx_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tunsigned int num_sges\n\t),\n\n\tTP_ARGS(rdma, num_sges),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, num_sges)\n\t\t__string(device, rdma->sc_cm_id->device->name)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->num_sges = num_sges;\n\t\t__assign_str(device, rdma->sc_cm_id->device->name);\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s device=%s num_sges=%d\",\n\t\t__get_str(addr), __get_str(device), __entry->num_sges\n\t)\n);\n\nTRACE_EVENT(svcrdma_page_overrun_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tconst struct svc_rqst *rqst,\n\t\tunsigned int pageno\n\t),\n\n\tTP_ARGS(rdma, rqst, pageno),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, pageno)\n\t\t__field(u32, xid)\n\t\t__string(device, rdma->sc_cm_id->device->name)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->pageno = pageno;\n\t\t__entry->xid = __be32_to_cpu(rqst->rq_xid);\n\t\t__assign_str(device, rdma->sc_cm_id->device->name);\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s device=%s xid=0x%08x pageno=%u\", __get_str(addr),\n\t\t__get_str(device), __entry->xid, __entry->pageno\n\t)\n);\n\nTRACE_EVENT(svcrdma_small_wrch_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tunsigned int remaining,\n\t\tunsigned int seg_no,\n\t\tunsigned int num_segs\n\t),\n\n\tTP_ARGS(rdma, remaining, seg_no, num_segs),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, remaining)\n\t\t__field(unsigned int, seg_no)\n\t\t__field(unsigned int, num_segs)\n\t\t__string(device, rdma->sc_cm_id->device->name)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->remaining = remaining;\n\t\t__entry->seg_no = seg_no;\n\t\t__entry->num_segs = num_segs;\n\t\t__assign_str(device, rdma->sc_cm_id->device->name);\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s device=%s remaining=%u seg_no=%u num_segs=%u\",\n\t\t__get_str(addr), __get_str(device), __entry->remaining,\n\t\t__entry->seg_no, __entry->num_segs\n\t)\n);\n\nTRACE_EVENT(svcrdma_send_pullup,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_send_ctxt *ctxt,\n\t\tunsigned int msglen\n\t),\n\n\tTP_ARGS(ctxt, msglen),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned int, hdrlen)\n\t\t__field(unsigned int, msglen)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->sc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->sc_cid.ci_completion_id;\n\t\t__entry->hdrlen = ctxt->sc_hdrbuf.len,\n\t\t__entry->msglen = msglen;\n\t),\n\n\tTP_printk(\"cq_id=%u cid=%d hdr=%u msg=%u (total %u)\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->hdrlen, __entry->msglen,\n\t\t__entry->hdrlen + __entry->msglen)\n);\n\nTRACE_EVENT(svcrdma_send_err,\n\tTP_PROTO(\n\t\tconst struct svc_rqst *rqst,\n\t\tint status\n\t),\n\n\tTP_ARGS(rqst, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, status)\n\t\t__field(u32, xid)\n\t\t__string(addr, rqst->rq_xprt->xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->status = status;\n\t\t__entry->xid = __be32_to_cpu(rqst->rq_xid);\n\t\t__assign_str(addr, rqst->rq_xprt->xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s xid=0x%08x status=%d\", __get_str(addr),\n\t\t__entry->xid, __entry->status\n\t)\n);\n\nTRACE_EVENT(svcrdma_post_send,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_send_ctxt *ctxt\n\t),\n\n\tTP_ARGS(ctxt),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(unsigned int, num_sge)\n\t\t__field(u32, inv_rkey)\n\t),\n\n\tTP_fast_assign(\n\t\tconst struct ib_send_wr *wr = &ctxt->sc_send_wr;\n\n\t\t__entry->cq_id = ctxt->sc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->sc_cid.ci_completion_id;\n\t\t__entry->num_sge = wr->num_sge;\n\t\t__entry->inv_rkey = (wr->opcode == IB_WR_SEND_WITH_INV) ?\n\t\t\t\t\twr->ex.invalidate_rkey : 0;\n\t),\n\n\tTP_printk(\"cq_id=%u cid=%d num_sge=%u inv_rkey=0x%08x\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->num_sge, __entry->inv_rkey\n\t)\n);\n\nDEFINE_SEND_COMPLETION_EVENT(svcrdma_wc_send);\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_send_flush);\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_send_err);\n\nTRACE_EVENT(svcrdma_post_recv,\n\tTP_PROTO(\n\t\tconst struct svc_rdma_recv_ctxt *ctxt\n\t),\n\n\tTP_ARGS(ctxt),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = ctxt->rc_cid.ci_queue_id;\n\t\t__entry->completion_id = ctxt->rc_cid.ci_completion_id;\n\t),\n\n\tTP_printk(\"cq.id=%d cid=%d\",\n\t\t__entry->cq_id, __entry->completion_id\n\t)\n);\n\nDEFINE_RECEIVE_SUCCESS_EVENT(svcrdma_wc_recv);\nDEFINE_RECEIVE_FLUSH_EVENT(svcrdma_wc_recv_flush);\nDEFINE_RECEIVE_FLUSH_EVENT(svcrdma_wc_recv_err);\n\nTRACE_EVENT(svcrdma_rq_post_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tint status\n\t),\n\n\tTP_ARGS(rdma, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, status)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->status = status;\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s status=%d\",\n\t\t__get_str(addr), __entry->status\n\t)\n);\n\nDECLARE_EVENT_CLASS(svcrdma_post_chunk_class,\n\tTP_PROTO(\n\t\tconst struct rpc_rdma_cid *cid,\n\t\tint sqecount\n\t),\n\n\tTP_ARGS(cid, sqecount),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(int, sqecount)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->sqecount = sqecount;\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d sqecount=%d\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->sqecount\n\t)\n);\n\n#define DEFINE_POST_CHUNK_EVENT(name)\t\t\t\t\t\\\n\t\tDEFINE_EVENT(svcrdma_post_chunk_class,\t\t\t\\\n\t\t\t\tsvcrdma_post_##name##_chunk,\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct rpc_rdma_cid *cid,\t\\\n\t\t\t\t\tint sqecount\t\t\t\\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(cid, sqecount))\n\nDEFINE_POST_CHUNK_EVENT(read);\nDEFINE_POST_CHUNK_EVENT(write);\nDEFINE_POST_CHUNK_EVENT(reply);\n\nDEFINE_EVENT(svcrdma_post_chunk_class, svcrdma_cc_release,\n\tTP_PROTO(\n\t\tconst struct rpc_rdma_cid *cid,\n\t\tint sqecount\n\t),\n\tTP_ARGS(cid, sqecount)\n);\n\nTRACE_EVENT(svcrdma_wc_read,\n\tTP_PROTO(\n\t\tconst struct ib_wc *wc,\n\t\tconst struct rpc_rdma_cid *cid,\n\t\tunsigned int totalbytes,\n\t\tconst ktime_t posttime\n\t),\n\n\tTP_ARGS(wc, cid, totalbytes, posttime),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cq_id)\n\t\t__field(int, completion_id)\n\t\t__field(s64, read_latency)\n\t\t__field(unsigned int, totalbytes)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cq_id = cid->ci_queue_id;\n\t\t__entry->completion_id = cid->ci_completion_id;\n\t\t__entry->totalbytes = totalbytes;\n\t\t__entry->read_latency = ktime_us_delta(ktime_get(), posttime);\n\t),\n\n\tTP_printk(\"cq.id=%u cid=%d totalbytes=%u latency-us=%lld\",\n\t\t__entry->cq_id, __entry->completion_id,\n\t\t__entry->totalbytes, __entry->read_latency\n\t)\n);\n\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_read_flush);\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_read_err);\n\nDEFINE_SEND_COMPLETION_EVENT(svcrdma_wc_write);\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_write_flush);\nDEFINE_SEND_FLUSH_EVENT(svcrdma_wc_write_err);\n\nTRACE_EVENT(svcrdma_qp_error,\n\tTP_PROTO(\n\t\tconst struct ib_event *event,\n\t\tconst struct sockaddr *sap\n\t),\n\n\tTP_ARGS(event, sap),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned int, event)\n\t\t__string(device, event->device->name)\n\t\t__array(__u8, addr, INET6_ADDRSTRLEN + 10)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->event = event->event;\n\t\t__assign_str(device, event->device->name);\n\t\tsnprintf(__entry->addr, sizeof(__entry->addr) - 1,\n\t\t\t \"%pISpc\", sap);\n\t),\n\n\tTP_printk(\"addr=%s dev=%s event=%s (%u)\",\n\t\t__entry->addr, __get_str(device),\n\t\trdma_show_ib_event(__entry->event), __entry->event\n\t)\n);\n\nDECLARE_EVENT_CLASS(svcrdma_sendqueue_event,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma\n\t),\n\n\tTP_ARGS(rdma),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, avail)\n\t\t__field(int, depth)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->avail = atomic_read(&rdma->sc_sq_avail);\n\t\t__entry->depth = rdma->sc_sq_depth;\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s sc_sq_avail=%d/%d\",\n\t\t__get_str(addr), __entry->avail, __entry->depth\n\t)\n);\n\n#define DEFINE_SQ_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(svcrdma_sendqueue_event, svcrdma_sq_##name,\\\n\t\t\t\tTP_PROTO(\t\t\t\t\\\n\t\t\t\t\tconst struct svcxprt_rdma *rdma \\\n\t\t\t\t),\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(rdma))\n\nDEFINE_SQ_EVENT(full);\nDEFINE_SQ_EVENT(retry);\n\nTRACE_EVENT(svcrdma_sq_post_err,\n\tTP_PROTO(\n\t\tconst struct svcxprt_rdma *rdma,\n\t\tint status\n\t),\n\n\tTP_ARGS(rdma, status),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, avail)\n\t\t__field(int, depth)\n\t\t__field(int, status)\n\t\t__string(addr, rdma->sc_xprt.xpt_remotebuf)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->avail = atomic_read(&rdma->sc_sq_avail);\n\t\t__entry->depth = rdma->sc_sq_depth;\n\t\t__entry->status = status;\n\t\t__assign_str(addr, rdma->sc_xprt.xpt_remotebuf);\n\t),\n\n\tTP_printk(\"addr=%s sc_sq_avail=%d/%d status=%d\",\n\t\t__get_str(addr), __entry->avail, __entry->depth,\n\t\t__entry->status\n\t)\n);\n\n#endif  \n\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}