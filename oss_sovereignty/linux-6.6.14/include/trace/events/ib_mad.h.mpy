{
  "module_name": "ib_mad.h",
  "hash_id": "36d322fc23de77b1349e842e99e8e8ee32f9697522afc2066756aa0631744a30",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/ib_mad.h",
  "human_readable_source": " \n\n \n\n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM ib_mad\n\n#if !defined(_TRACE_IB_MAD_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_IB_MAD_H\n\n#include <linux/tracepoint.h>\n#include <rdma/ib_mad.h>\n\n#ifdef CONFIG_TRACEPOINTS\nstruct trace_event_raw_ib_mad_send_template;\nstatic void create_mad_addr_info(struct ib_mad_send_wr_private *mad_send_wr,\n\t\t\t  struct ib_mad_qp_info *qp_info,\n\t\t\t  struct trace_event_raw_ib_mad_send_template *entry);\n#endif\n\nDECLARE_EVENT_CLASS(ib_mad_send_template,\n\tTP_PROTO(struct ib_mad_send_wr_private *wr,\n\t\t struct ib_mad_qp_info *qp_info),\n\tTP_ARGS(wr, qp_info),\n\n\tTP_STRUCT__entry(\n\t\t__field(u8,             base_version)\n\t\t__field(u8,             mgmt_class)\n\t\t__field(u8,             class_version)\n\t\t__field(u8,             port_num)\n\t\t__field(u32,            qp_num)\n\t\t__field(u8,             method)\n\t\t__field(u8,             sl)\n\t\t__field(u16,            attr_id)\n\t\t__field(u32,            attr_mod)\n\t\t__field(u64,            wrtid)\n\t\t__field(u64,            tid)\n\t\t__field(u16,            status)\n\t\t__field(u16,            class_specific)\n\t\t__field(u32,            length)\n\t\t__field(u32,            dlid)\n\t\t__field(u32,            rqpn)\n\t\t__field(u32,            rqkey)\n\t\t__field(u32,            dev_index)\n\t\t__field(void *,         agent_priv)\n\t\t__field(unsigned long,  timeout)\n\t\t__field(int,            retries_left)\n\t\t__field(int,            max_retries)\n\t\t__field(int,            retry)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dev_index = wr->mad_agent_priv->agent.device->index;\n\t\t__entry->port_num = wr->mad_agent_priv->agent.port_num;\n\t\t__entry->qp_num = wr->mad_agent_priv->qp_info->qp->qp_num;\n\t\t__entry->agent_priv = wr->mad_agent_priv;\n\t\t__entry->wrtid = wr->tid;\n\t\t__entry->max_retries = wr->max_retries;\n\t\t__entry->retries_left = wr->retries_left;\n\t\t__entry->retry = wr->retry;\n\t\t__entry->timeout = wr->timeout;\n\t\t__entry->length = wr->send_buf.hdr_len +\n\t\t\t\t  wr->send_buf.data_len;\n\t\t__entry->base_version =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->base_version;\n\t\t__entry->mgmt_class =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->mgmt_class;\n\t\t__entry->class_version =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->class_version;\n\t\t__entry->method =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->method;\n\t\t__entry->status =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->status;\n\t\t__entry->class_specific =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->class_specific;\n\t\t__entry->tid = ((struct ib_mad_hdr *)wr->send_buf.mad)->tid;\n\t\t__entry->attr_id =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->attr_id;\n\t\t__entry->attr_mod =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->attr_mod;\n\t\tcreate_mad_addr_info(wr, qp_info, __entry);\n\t),\n\n\tTP_printk(\"%d:%d QP%d agent %p: \" \\\n\t\t  \"wrtid 0x%llx; %d/%d retries(%d); timeout %lu length %d : \" \\\n\t\t  \"hdr : base_ver 0x%x class 0x%x class_ver 0x%x \" \\\n\t\t  \"method 0x%x status 0x%x class_specific 0x%x tid 0x%llx \" \\\n\t\t  \"attr_id 0x%x attr_mod 0x%x  => dlid 0x%08x sl %d \"\\\n\t\t  \"rpqn 0x%x rqpkey 0x%x\",\n\t\t__entry->dev_index, __entry->port_num, __entry->qp_num,\n\t\t__entry->agent_priv, be64_to_cpu(__entry->wrtid),\n\t\t__entry->retries_left, __entry->max_retries,\n\t\t__entry->retry, __entry->timeout, __entry->length,\n\t\t__entry->base_version, __entry->mgmt_class,\n\t\t__entry->class_version,\n\t\t__entry->method, be16_to_cpu(__entry->status),\n\t\tbe16_to_cpu(__entry->class_specific),\n\t\tbe64_to_cpu(__entry->tid), be16_to_cpu(__entry->attr_id),\n\t\tbe32_to_cpu(__entry->attr_mod),\n\t\tbe32_to_cpu(__entry->dlid), __entry->sl,\n\t\t__entry->rqpn, __entry->rqkey\n\t)\n);\n\nDEFINE_EVENT(ib_mad_send_template, ib_mad_error_handler,\n\tTP_PROTO(struct ib_mad_send_wr_private *wr,\n\t\t struct ib_mad_qp_info *qp_info),\n\tTP_ARGS(wr, qp_info));\nDEFINE_EVENT(ib_mad_send_template, ib_mad_ib_send_mad,\n\tTP_PROTO(struct ib_mad_send_wr_private *wr,\n\t\t struct ib_mad_qp_info *qp_info),\n\tTP_ARGS(wr, qp_info));\nDEFINE_EVENT(ib_mad_send_template, ib_mad_send_done_resend,\n\tTP_PROTO(struct ib_mad_send_wr_private *wr,\n\t\t struct ib_mad_qp_info *qp_info),\n\tTP_ARGS(wr, qp_info));\n\nTRACE_EVENT(ib_mad_send_done_handler,\n\tTP_PROTO(struct ib_mad_send_wr_private *wr, struct ib_wc *wc),\n\tTP_ARGS(wr, wc),\n\n\tTP_STRUCT__entry(\n\t\t__field(u8,             port_num)\n\t\t__field(u8,             base_version)\n\t\t__field(u8,             mgmt_class)\n\t\t__field(u8,             class_version)\n\t\t__field(u32,            qp_num)\n\t\t__field(u64,            wrtid)\n\t\t__field(u16,            status)\n\t\t__field(u16,            wc_status)\n\t\t__field(u32,            length)\n\t\t__field(void *,         agent_priv)\n\t\t__field(unsigned long,  timeout)\n\t\t__field(u32,            dev_index)\n\t\t__field(int,            retries_left)\n\t\t__field(int,            max_retries)\n\t\t__field(int,            retry)\n\t\t__field(u8,             method)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dev_index = wr->mad_agent_priv->agent.device->index;\n\t\t__entry->port_num = wr->mad_agent_priv->agent.port_num;\n\t\t__entry->qp_num = wr->mad_agent_priv->qp_info->qp->qp_num;\n\t\t__entry->agent_priv = wr->mad_agent_priv;\n\t\t__entry->wrtid = wr->tid;\n\t\t__entry->max_retries = wr->max_retries;\n\t\t__entry->retries_left = wr->retries_left;\n\t\t__entry->retry = wr->retry;\n\t\t__entry->timeout = wr->timeout;\n\t\t__entry->base_version =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->base_version;\n\t\t__entry->mgmt_class =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->mgmt_class;\n\t\t__entry->class_version =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->class_version;\n\t\t__entry->method =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->method;\n\t\t__entry->status =\n\t\t\t((struct ib_mad_hdr *)wr->send_buf.mad)->status;\n\t\t__entry->wc_status = wc->status;\n\t\t__entry->length = wc->byte_len;\n\t),\n\n\tTP_printk(\"%d:%d QP%d : SEND WC Status %d : agent %p: \" \\\n\t\t  \"wrtid 0x%llx %d/%d retries(%d) timeout %lu length %d: \" \\\n\t\t  \"hdr : base_ver 0x%x class 0x%x class_ver 0x%x \" \\\n\t\t  \"method 0x%x status 0x%x\",\n\t\t__entry->dev_index, __entry->port_num, __entry->qp_num,\n\t\t__entry->wc_status,\n\t\t__entry->agent_priv, be64_to_cpu(__entry->wrtid),\n\t\t__entry->retries_left, __entry->max_retries,\n\t\t__entry->retry, __entry->timeout,\n\t\t__entry->length,\n\t\t__entry->base_version, __entry->mgmt_class,\n\t\t__entry->class_version, __entry->method,\n\t\tbe16_to_cpu(__entry->status)\n\t)\n);\n\nTRACE_EVENT(ib_mad_recv_done_handler,\n\tTP_PROTO(struct ib_mad_qp_info *qp_info, struct ib_wc *wc,\n\t\t struct ib_mad_hdr *mad_hdr),\n\tTP_ARGS(qp_info, wc, mad_hdr),\n\n\tTP_STRUCT__entry(\n\t\t__field(u8,             base_version)\n\t\t__field(u8,             mgmt_class)\n\t\t__field(u8,             class_version)\n\t\t__field(u8,             port_num)\n\t\t__field(u32,            qp_num)\n\t\t__field(u16,            status)\n\t\t__field(u16,            class_specific)\n\t\t__field(u32,            length)\n\t\t__field(u64,            tid)\n\t\t__field(u8,             method)\n\t\t__field(u8,             sl)\n\t\t__field(u16,            attr_id)\n\t\t__field(u32,            attr_mod)\n\t\t__field(u16,            src_qp)\n\t\t__field(u16,            wc_status)\n\t\t__field(u32,            slid)\n\t\t__field(u32,            dev_index)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dev_index = qp_info->port_priv->device->index;\n\t\t__entry->port_num = qp_info->port_priv->port_num;\n\t\t__entry->qp_num = qp_info->qp->qp_num;\n\t\t__entry->length = wc->byte_len;\n\t\t__entry->base_version = mad_hdr->base_version;\n\t\t__entry->mgmt_class = mad_hdr->mgmt_class;\n\t\t__entry->class_version = mad_hdr->class_version;\n\t\t__entry->method = mad_hdr->method;\n\t\t__entry->status = mad_hdr->status;\n\t\t__entry->class_specific = mad_hdr->class_specific;\n\t\t__entry->tid = mad_hdr->tid;\n\t\t__entry->attr_id = mad_hdr->attr_id;\n\t\t__entry->attr_mod = mad_hdr->attr_mod;\n\t\t__entry->slid = wc->slid;\n\t\t__entry->src_qp = wc->src_qp;\n\t\t__entry->sl = wc->sl;\n\t\t__entry->wc_status = wc->status;\n\t),\n\n\tTP_printk(\"%d:%d QP%d : RECV WC Status %d : length %d : hdr : \" \\\n\t\t  \"base_ver 0x%02x class 0x%02x class_ver 0x%02x \" \\\n\t\t  \"method 0x%02x status 0x%04x class_specific 0x%04x \" \\\n\t\t  \"tid 0x%016llx attr_id 0x%04x attr_mod 0x%08x \" \\\n\t\t  \"slid 0x%08x src QP%d, sl %d\",\n\t\t__entry->dev_index, __entry->port_num, __entry->qp_num,\n\t\t__entry->wc_status,\n\t\t__entry->length,\n\t\t__entry->base_version, __entry->mgmt_class,\n\t\t__entry->class_version, __entry->method,\n\t\tbe16_to_cpu(__entry->status),\n\t\tbe16_to_cpu(__entry->class_specific),\n\t\tbe64_to_cpu(__entry->tid), be16_to_cpu(__entry->attr_id),\n\t\tbe32_to_cpu(__entry->attr_mod),\n\t\t__entry->slid, __entry->src_qp, __entry->sl\n\t)\n);\n\nDECLARE_EVENT_CLASS(ib_mad_agent_template,\n\tTP_PROTO(struct ib_mad_agent_private *agent),\n\tTP_ARGS(agent),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32,            dev_index)\n\t\t__field(u32,            hi_tid)\n\t\t__field(u8,             port_num)\n\t\t__field(u8,             mgmt_class)\n\t\t__field(u8,             mgmt_class_version)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dev_index = agent->agent.device->index;\n\t\t__entry->port_num = agent->agent.port_num;\n\t\t__entry->hi_tid = agent->agent.hi_tid;\n\n\t\tif (agent->reg_req) {\n\t\t\t__entry->mgmt_class = agent->reg_req->mgmt_class;\n\t\t\t__entry->mgmt_class_version =\n\t\t\t\tagent->reg_req->mgmt_class_version;\n\t\t} else {\n\t\t\t__entry->mgmt_class = 0;\n\t\t\t__entry->mgmt_class_version = 0;\n\t\t}\n\t),\n\n\tTP_printk(\"%d:%d mad agent : hi_tid 0x%08x class 0x%02x class_ver 0x%02x\",\n\t\t__entry->dev_index, __entry->port_num,\n\t\t__entry->hi_tid, __entry->mgmt_class,\n\t\t__entry->mgmt_class_version\n\t)\n);\nDEFINE_EVENT(ib_mad_agent_template, ib_mad_recv_done_agent,\n\tTP_PROTO(struct ib_mad_agent_private *agent),\n\tTP_ARGS(agent));\nDEFINE_EVENT(ib_mad_agent_template, ib_mad_send_done_agent,\n\tTP_PROTO(struct ib_mad_agent_private *agent),\n\tTP_ARGS(agent));\nDEFINE_EVENT(ib_mad_agent_template, ib_mad_create_agent,\n\tTP_PROTO(struct ib_mad_agent_private *agent),\n\tTP_ARGS(agent));\nDEFINE_EVENT(ib_mad_agent_template, ib_mad_unregister_agent,\n\tTP_PROTO(struct ib_mad_agent_private *agent),\n\tTP_ARGS(agent));\n\n\n\nDECLARE_EVENT_CLASS(ib_mad_opa_smi_template,\n\tTP_PROTO(struct opa_smp *smp),\n\tTP_ARGS(smp),\n\n\tTP_STRUCT__entry(\n\t\t__field(u64,            mkey)\n\t\t__field(u32,            dr_slid)\n\t\t__field(u32,            dr_dlid)\n\t\t__field(u8,             hop_ptr)\n\t\t__field(u8,             hop_cnt)\n\t\t__array(u8,             initial_path, OPA_SMP_MAX_PATH_HOPS)\n\t\t__array(u8,             return_path, OPA_SMP_MAX_PATH_HOPS)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->hop_ptr = smp->hop_ptr;\n\t\t__entry->hop_cnt = smp->hop_cnt;\n\t\t__entry->mkey = smp->mkey;\n\t\t__entry->dr_slid = smp->route.dr.dr_slid;\n\t\t__entry->dr_dlid = smp->route.dr.dr_dlid;\n\t\tmemcpy(__entry->initial_path, smp->route.dr.initial_path,\n\t\t\tOPA_SMP_MAX_PATH_HOPS);\n\t\tmemcpy(__entry->return_path, smp->route.dr.return_path,\n\t\t\tOPA_SMP_MAX_PATH_HOPS);\n\t),\n\n\tTP_printk(\"OPA SMP: hop_ptr %d hop_cnt %d \" \\\n\t\t  \"mkey 0x%016llx dr_slid 0x%08x dr_dlid 0x%08x \" \\\n\t\t  \"initial_path %*ph return_path %*ph \",\n\t\t__entry->hop_ptr, __entry->hop_cnt,\n\t\tbe64_to_cpu(__entry->mkey), be32_to_cpu(__entry->dr_slid),\n\t\tbe32_to_cpu(__entry->dr_dlid),\n\t\tOPA_SMP_MAX_PATH_HOPS, __entry->initial_path,\n\t\tOPA_SMP_MAX_PATH_HOPS, __entry->return_path\n\t)\n);\n\nDEFINE_EVENT(ib_mad_opa_smi_template, ib_mad_handle_opa_smi,\n\tTP_PROTO(struct opa_smp *smp),\n\tTP_ARGS(smp));\nDEFINE_EVENT(ib_mad_opa_smi_template, ib_mad_handle_out_opa_smi,\n\tTP_PROTO(struct opa_smp *smp),\n\tTP_ARGS(smp));\n\n\nDECLARE_EVENT_CLASS(ib_mad_opa_ib_template,\n\tTP_PROTO(struct ib_smp *smp),\n\tTP_ARGS(smp),\n\n\tTP_STRUCT__entry(\n\t\t__field(u64,            mkey)\n\t\t__field(u32,            dr_slid)\n\t\t__field(u32,            dr_dlid)\n\t\t__field(u8,             hop_ptr)\n\t\t__field(u8,             hop_cnt)\n\t\t__array(u8,             initial_path, IB_SMP_MAX_PATH_HOPS)\n\t\t__array(u8,             return_path, IB_SMP_MAX_PATH_HOPS)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->hop_ptr = smp->hop_ptr;\n\t\t__entry->hop_cnt = smp->hop_cnt;\n\t\t__entry->mkey = smp->mkey;\n\t\t__entry->dr_slid = smp->dr_slid;\n\t\t__entry->dr_dlid = smp->dr_dlid;\n\t\tmemcpy(__entry->initial_path, smp->initial_path,\n\t\t\tIB_SMP_MAX_PATH_HOPS);\n\t\tmemcpy(__entry->return_path, smp->return_path,\n\t\t\tIB_SMP_MAX_PATH_HOPS);\n\t),\n\n\tTP_printk(\"OPA SMP: hop_ptr %d hop_cnt %d \" \\\n\t\t  \"mkey 0x%016llx dr_slid 0x%04x dr_dlid 0x%04x \" \\\n\t\t  \"initial_path %*ph return_path %*ph \",\n\t\t__entry->hop_ptr, __entry->hop_cnt,\n\t\tbe64_to_cpu(__entry->mkey), be16_to_cpu(__entry->dr_slid),\n\t\tbe16_to_cpu(__entry->dr_dlid),\n\t\tIB_SMP_MAX_PATH_HOPS, __entry->initial_path,\n\t\tIB_SMP_MAX_PATH_HOPS, __entry->return_path\n\t)\n);\n\nDEFINE_EVENT(ib_mad_opa_ib_template, ib_mad_handle_ib_smi,\n\tTP_PROTO(struct ib_smp *smp),\n\tTP_ARGS(smp));\nDEFINE_EVENT(ib_mad_opa_ib_template, ib_mad_handle_out_ib_smi,\n\tTP_PROTO(struct ib_smp *smp),\n\tTP_ARGS(smp));\n\n#endif  \n\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}