{
  "module_name": "fib6.h",
  "hash_id": "15729c69807e2f59cdfa1188da0829c39b76a792ec1748992250b2cd7c84c4dd",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/fib6.h",
  "human_readable_source": " \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM fib6\n\n#if !defined(_TRACE_FIB6_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_FIB6_H\n\n#include <linux/in6.h>\n#include <net/flow.h>\n#include <net/ip6_fib.h>\n#include <linux/tracepoint.h>\n\nTRACE_EVENT(fib6_table_lookup,\n\n\tTP_PROTO(const struct net *net, const struct fib6_result *res,\n\t\t struct fib6_table *table, const struct flowi6 *flp),\n\n\tTP_ARGS(net, res, table, flp),\n\n\tTP_STRUCT__entry(\n\t\t__field(\tu32,\ttb_id\t\t)\n\t\t__field(\tint,\terr\t\t)\n\t\t__field(\tint,\toif\t\t)\n\t\t__field(\tint,\tiif\t\t)\n\t\t__field(\t__u8,\ttos\t\t)\n\t\t__field(\t__u8,\tscope\t\t)\n\t\t__field(\t__u8,\tflags\t\t)\n\t\t__array(\t__u8,\tsrc,\t16\t)\n\t\t__array(\t__u8,\tdst,\t16\t)\n\t\t__field(        u16,\tsport\t\t)\n\t\t__field(        u16,\tdport\t\t)\n\t\t__field(        u8,\tproto\t\t)\n\t\t__field(        u8,\trt_type\t\t)\n\t\t__array(\t\tchar,\tname,\tIFNAMSIZ )\n\t\t__array(\t\t__u8,\tgw,\t16\t )\n\t),\n\n\tTP_fast_assign(\n\t\tstruct in6_addr *in6;\n\n\t\t__entry->tb_id = table->tb6_id;\n\t\t__entry->err = ip6_rt_type_to_error(res->fib6_type);\n\t\t__entry->oif = flp->flowi6_oif;\n\t\t__entry->iif = flp->flowi6_iif;\n\t\t__entry->tos = ip6_tclass(flp->flowlabel);\n\t\t__entry->scope = flp->flowi6_scope;\n\t\t__entry->flags = flp->flowi6_flags;\n\n\t\tin6 = (struct in6_addr *)__entry->src;\n\t\t*in6 = flp->saddr;\n\n\t\tin6 = (struct in6_addr *)__entry->dst;\n\t\t*in6 = flp->daddr;\n\n\t\t__entry->proto = flp->flowi6_proto;\n\t\tif (__entry->proto == IPPROTO_TCP ||\n\t\t    __entry->proto == IPPROTO_UDP) {\n\t\t\t__entry->sport = ntohs(flp->fl6_sport);\n\t\t\t__entry->dport = ntohs(flp->fl6_dport);\n\t\t} else {\n\t\t\t__entry->sport = 0;\n\t\t\t__entry->dport = 0;\n\t\t}\n\n\t\tif (res->nh && res->nh->fib_nh_dev) {\n\t\t\tstrscpy(__entry->name, res->nh->fib_nh_dev->name, IFNAMSIZ);\n\t\t} else {\n\t\t\tstrcpy(__entry->name, \"-\");\n\t\t}\n\t\tif (res->f6i == net->ipv6.fib6_null_entry) {\n\t\t\tin6 = (struct in6_addr *)__entry->gw;\n\t\t\t*in6 = in6addr_any;\n\t\t} else if (res->nh) {\n\t\t\tin6 = (struct in6_addr *)__entry->gw;\n\t\t\t*in6 = res->nh->fib_nh_gw6;\n\t\t}\n\t),\n\n\tTP_printk(\"table %3u oif %d iif %d proto %u %pI6c/%u -> %pI6c/%u tos %d scope %d flags %x ==> dev %s gw %pI6c err %d\",\n\t\t  __entry->tb_id, __entry->oif, __entry->iif, __entry->proto,\n\t\t  __entry->src, __entry->sport, __entry->dst, __entry->dport,\n\t\t  __entry->tos, __entry->scope, __entry->flags,\n\t\t  __entry->name, __entry->gw, __entry->err)\n);\n\n#endif  \n\n \n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}