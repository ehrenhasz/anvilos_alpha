{
  "module_name": "writeback.h",
  "hash_id": "8bed47abe7e3c75135bb08effb0fc4f4f06e1b3513415ecd5e79ad26b9e4a50d",
  "original_prompt": "Ingested from linux-6.6.14/include/trace/events/writeback.h",
  "human_readable_source": " \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM writeback\n\n#if !defined(_TRACE_WRITEBACK_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_WRITEBACK_H\n\n#include <linux/tracepoint.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n\n#define show_inode_state(state)\t\t\t\t\t\\\n\t__print_flags(state, \"|\",\t\t\t\t\\\n\t\t{I_DIRTY_SYNC,\t\t\"I_DIRTY_SYNC\"},\t\\\n\t\t{I_DIRTY_DATASYNC,\t\"I_DIRTY_DATASYNC\"},\t\\\n\t\t{I_DIRTY_PAGES,\t\t\"I_DIRTY_PAGES\"},\t\\\n\t\t{I_NEW,\t\t\t\"I_NEW\"},\t\t\\\n\t\t{I_WILL_FREE,\t\t\"I_WILL_FREE\"},\t\t\\\n\t\t{I_FREEING,\t\t\"I_FREEING\"},\t\t\\\n\t\t{I_CLEAR,\t\t\"I_CLEAR\"},\t\t\\\n\t\t{I_SYNC,\t\t\"I_SYNC\"},\t\t\\\n\t\t{I_DIRTY_TIME,\t\t\"I_DIRTY_TIME\"},\t\\\n\t\t{I_REFERENCED,\t\t\"I_REFERENCED\"}\t\t\\\n\t)\n\n \n#undef EM\n#undef EMe\n#define EM(a,b) \tTRACE_DEFINE_ENUM(a);\n#define EMe(a,b)\tTRACE_DEFINE_ENUM(a);\n\n#define WB_WORK_REASON\t\t\t\t\t\t\t\\\n\tEM( WB_REASON_BACKGROUND,\t\t\"background\")\t\t\\\n\tEM( WB_REASON_VMSCAN,\t\t\t\"vmscan\")\t\t\\\n\tEM( WB_REASON_SYNC,\t\t\t\"sync\")\t\t\t\\\n\tEM( WB_REASON_PERIODIC,\t\t\t\"periodic\")\t\t\\\n\tEM( WB_REASON_LAPTOP_TIMER,\t\t\"laptop_timer\")\t\t\\\n\tEM( WB_REASON_FS_FREE_SPACE,\t\t\"fs_free_space\")\t\\\n\tEM( WB_REASON_FORKER_THREAD,\t\t\"forker_thread\")\t\\\n\tEMe(WB_REASON_FOREIGN_FLUSH,\t\t\"foreign_flush\")\n\nWB_WORK_REASON\n\n \n#undef EM\n#undef EMe\n#define EM(a,b)\t\t{ a, b },\n#define EMe(a,b)\t{ a, b }\n\nstruct wb_writeback_work;\n\nDECLARE_EVENT_CLASS(writeback_folio_template,\n\n\tTP_PROTO(struct folio *folio, struct address_space *mapping),\n\n\tTP_ARGS(folio, mapping),\n\n\tTP_STRUCT__entry (\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, ino)\n\t\t__field(pgoff_t, index)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name,\n\t\t\t    bdi_dev_name(mapping ? inode_to_bdi(mapping->host) :\n\t\t\t\t\t NULL), 32);\n\t\t__entry->ino = (mapping && mapping->host) ? mapping->host->i_ino : 0;\n\t\t__entry->index = folio->index;\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu index=%lu\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->ino,\n\t\t__entry->index\n\t)\n);\n\nDEFINE_EVENT(writeback_folio_template, writeback_dirty_folio,\n\n\tTP_PROTO(struct folio *folio, struct address_space *mapping),\n\n\tTP_ARGS(folio, mapping)\n);\n\nDEFINE_EVENT(writeback_folio_template, folio_wait_writeback,\n\n\tTP_PROTO(struct folio *folio, struct address_space *mapping),\n\n\tTP_ARGS(folio, mapping)\n);\n\nDECLARE_EVENT_CLASS(writeback_dirty_inode_template,\n\n\tTP_PROTO(struct inode *inode, int flags),\n\n\tTP_ARGS(inode, flags),\n\n\tTP_STRUCT__entry (\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, ino)\n\t\t__field(unsigned long, state)\n\t\t__field(unsigned long, flags)\n\t),\n\n\tTP_fast_assign(\n\t\tstruct backing_dev_info *bdi = inode_to_bdi(inode);\n\n\t\t \n\t\tstrscpy_pad(__entry->name, bdi_dev_name(bdi), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->state\t\t= inode->i_state;\n\t\t__entry->flags\t\t= flags;\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu state=%s flags=%s\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->ino,\n\t\tshow_inode_state(__entry->state),\n\t\tshow_inode_state(__entry->flags)\n\t)\n);\n\nDEFINE_EVENT(writeback_dirty_inode_template, writeback_mark_inode_dirty,\n\n\tTP_PROTO(struct inode *inode, int flags),\n\n\tTP_ARGS(inode, flags)\n);\n\nDEFINE_EVENT(writeback_dirty_inode_template, writeback_dirty_inode_start,\n\n\tTP_PROTO(struct inode *inode, int flags),\n\n\tTP_ARGS(inode, flags)\n);\n\nDEFINE_EVENT(writeback_dirty_inode_template, writeback_dirty_inode,\n\n\tTP_PROTO(struct inode *inode, int flags),\n\n\tTP_ARGS(inode, flags)\n);\n\n#ifdef CREATE_TRACE_POINTS\n#ifdef CONFIG_CGROUP_WRITEBACK\n\nstatic inline ino_t __trace_wb_assign_cgroup(struct bdi_writeback *wb)\n{\n\treturn cgroup_ino(wb->memcg_css->cgroup);\n}\n\nstatic inline ino_t __trace_wbc_assign_cgroup(struct writeback_control *wbc)\n{\n\tif (wbc->wb)\n\t\treturn __trace_wb_assign_cgroup(wbc->wb);\n\telse\n\t\treturn 1;\n}\n#else\t \n\nstatic inline ino_t __trace_wb_assign_cgroup(struct bdi_writeback *wb)\n{\n\treturn 1;\n}\n\nstatic inline ino_t __trace_wbc_assign_cgroup(struct writeback_control *wbc)\n{\n\treturn 1;\n}\n\n#endif\t \n#endif\t \n\n#ifdef CONFIG_CGROUP_WRITEBACK\nTRACE_EVENT(inode_foreign_history,\n\n\tTP_PROTO(struct inode *inode, struct writeback_control *wbc,\n\t\t unsigned int history),\n\n\tTP_ARGS(inode, wbc, history),\n\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tname, 32)\n\t\t__field(ino_t,\t\tino)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t\t__field(unsigned int,\thistory)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(inode_to_bdi(inode)), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->cgroup_ino\t= __trace_wbc_assign_cgroup(wbc);\n\t\t__entry->history\t= history;\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu cgroup_ino=%lu history=0x%x\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->ino,\n\t\t(unsigned long)__entry->cgroup_ino,\n\t\t__entry->history\n\t)\n);\n\nTRACE_EVENT(inode_switch_wbs,\n\n\tTP_PROTO(struct inode *inode, struct bdi_writeback *old_wb,\n\t\t struct bdi_writeback *new_wb),\n\n\tTP_ARGS(inode, old_wb, new_wb),\n\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tname, 32)\n\t\t__field(ino_t,\t\tino)\n\t\t__field(ino_t,\t\told_cgroup_ino)\n\t\t__field(ino_t,\t\tnew_cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(old_wb->bdi), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->old_cgroup_ino\t= __trace_wb_assign_cgroup(old_wb);\n\t\t__entry->new_cgroup_ino\t= __trace_wb_assign_cgroup(new_wb);\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu old_cgroup_ino=%lu new_cgroup_ino=%lu\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->ino,\n\t\t(unsigned long)__entry->old_cgroup_ino,\n\t\t(unsigned long)__entry->new_cgroup_ino\n\t)\n);\n\nTRACE_EVENT(track_foreign_dirty,\n\n\tTP_PROTO(struct folio *folio, struct bdi_writeback *wb),\n\n\tTP_ARGS(folio, wb),\n\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tname, 32)\n\t\t__field(u64,\t\tbdi_id)\n\t\t__field(ino_t,\t\tino)\n\t\t__field(unsigned int,\tmemcg_id)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t\t__field(ino_t,\t\tpage_cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstruct address_space *mapping = folio_mapping(folio);\n\t\tstruct inode *inode = mapping ? mapping->host : NULL;\n\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->bdi_id\t\t= wb->bdi->id;\n\t\t__entry->ino\t\t= inode ? inode->i_ino : 0;\n\t\t__entry->memcg_id\t= wb->memcg_css->id;\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(wb);\n\t\t__entry->page_cgroup_ino = cgroup_ino(folio_memcg(folio)->css.cgroup);\n\t),\n\n\tTP_printk(\"bdi %s[%llu]: ino=%lu memcg_id=%u cgroup_ino=%lu page_cgroup_ino=%lu\",\n\t\t__entry->name,\n\t\t__entry->bdi_id,\n\t\t(unsigned long)__entry->ino,\n\t\t__entry->memcg_id,\n\t\t(unsigned long)__entry->cgroup_ino,\n\t\t(unsigned long)__entry->page_cgroup_ino\n\t)\n);\n\nTRACE_EVENT(flush_foreign,\n\n\tTP_PROTO(struct bdi_writeback *wb, unsigned int frn_bdi_id,\n\t\t unsigned int frn_memcg_id),\n\n\tTP_ARGS(wb, frn_bdi_id, frn_memcg_id),\n\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tname, 32)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t\t__field(unsigned int,\tfrn_bdi_id)\n\t\t__field(unsigned int,\tfrn_memcg_id)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(wb);\n\t\t__entry->frn_bdi_id\t= frn_bdi_id;\n\t\t__entry->frn_memcg_id\t= frn_memcg_id;\n\t),\n\n\tTP_printk(\"bdi %s: cgroup_ino=%lu frn_bdi_id=%u frn_memcg_id=%u\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->cgroup_ino,\n\t\t__entry->frn_bdi_id,\n\t\t__entry->frn_memcg_id\n\t)\n);\n#endif\n\nDECLARE_EVENT_CLASS(writeback_write_inode_template,\n\n\tTP_PROTO(struct inode *inode, struct writeback_control *wbc),\n\n\tTP_ARGS(inode, wbc),\n\n\tTP_STRUCT__entry (\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, ino)\n\t\t__field(int, sync_mode)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name,\n\t\t\t    bdi_dev_name(inode_to_bdi(inode)), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->sync_mode\t= wbc->sync_mode;\n\t\t__entry->cgroup_ino\t= __trace_wbc_assign_cgroup(wbc);\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu sync_mode=%d cgroup_ino=%lu\",\n\t\t__entry->name,\n\t\t(unsigned long)__entry->ino,\n\t\t__entry->sync_mode,\n\t\t(unsigned long)__entry->cgroup_ino\n\t)\n);\n\nDEFINE_EVENT(writeback_write_inode_template, writeback_write_inode_start,\n\n\tTP_PROTO(struct inode *inode, struct writeback_control *wbc),\n\n\tTP_ARGS(inode, wbc)\n);\n\nDEFINE_EVENT(writeback_write_inode_template, writeback_write_inode,\n\n\tTP_PROTO(struct inode *inode, struct writeback_control *wbc),\n\n\tTP_ARGS(inode, wbc)\n);\n\nDECLARE_EVENT_CLASS(writeback_work_class,\n\tTP_PROTO(struct bdi_writeback *wb, struct wb_writeback_work *work),\n\tTP_ARGS(wb, work),\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t\t__field(long, nr_pages)\n\t\t__field(dev_t, sb_dev)\n\t\t__field(int, sync_mode)\n\t\t__field(int, for_kupdate)\n\t\t__field(int, range_cyclic)\n\t\t__field(int, for_background)\n\t\t__field(int, reason)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->nr_pages = work->nr_pages;\n\t\t__entry->sb_dev = work->sb ? work->sb->s_dev : 0;\n\t\t__entry->sync_mode = work->sync_mode;\n\t\t__entry->for_kupdate = work->for_kupdate;\n\t\t__entry->range_cyclic = work->range_cyclic;\n\t\t__entry->for_background\t= work->for_background;\n\t\t__entry->reason = work->reason;\n\t\t__entry->cgroup_ino = __trace_wb_assign_cgroup(wb);\n\t),\n\tTP_printk(\"bdi %s: sb_dev %d:%d nr_pages=%ld sync_mode=%d \"\n\t\t  \"kupdate=%d range_cyclic=%d background=%d reason=%s cgroup_ino=%lu\",\n\t\t  __entry->name,\n\t\t  MAJOR(__entry->sb_dev), MINOR(__entry->sb_dev),\n\t\t  __entry->nr_pages,\n\t\t  __entry->sync_mode,\n\t\t  __entry->for_kupdate,\n\t\t  __entry->range_cyclic,\n\t\t  __entry->for_background,\n\t\t  __print_symbolic(__entry->reason, WB_WORK_REASON),\n\t\t  (unsigned long)__entry->cgroup_ino\n\t)\n);\n#define DEFINE_WRITEBACK_WORK_EVENT(name) \\\nDEFINE_EVENT(writeback_work_class, name, \\\n\tTP_PROTO(struct bdi_writeback *wb, struct wb_writeback_work *work), \\\n\tTP_ARGS(wb, work))\nDEFINE_WRITEBACK_WORK_EVENT(writeback_queue);\nDEFINE_WRITEBACK_WORK_EVENT(writeback_exec);\nDEFINE_WRITEBACK_WORK_EVENT(writeback_start);\nDEFINE_WRITEBACK_WORK_EVENT(writeback_written);\nDEFINE_WRITEBACK_WORK_EVENT(writeback_wait);\n\nTRACE_EVENT(writeback_pages_written,\n\tTP_PROTO(long pages_written),\n\tTP_ARGS(pages_written),\n\tTP_STRUCT__entry(\n\t\t__field(long,\t\tpages)\n\t),\n\tTP_fast_assign(\n\t\t__entry->pages\t\t= pages_written;\n\t),\n\tTP_printk(\"%ld\", __entry->pages)\n);\n\nDECLARE_EVENT_CLASS(writeback_class,\n\tTP_PROTO(struct bdi_writeback *wb),\n\tTP_ARGS(wb),\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->cgroup_ino = __trace_wb_assign_cgroup(wb);\n\t),\n\tTP_printk(\"bdi %s: cgroup_ino=%lu\",\n\t\t  __entry->name,\n\t\t  (unsigned long)__entry->cgroup_ino\n\t)\n);\n#define DEFINE_WRITEBACK_EVENT(name) \\\nDEFINE_EVENT(writeback_class, name, \\\n\tTP_PROTO(struct bdi_writeback *wb), \\\n\tTP_ARGS(wb))\n\nDEFINE_WRITEBACK_EVENT(writeback_wake_background);\n\nTRACE_EVENT(writeback_bdi_register,\n\tTP_PROTO(struct backing_dev_info *bdi),\n\tTP_ARGS(bdi),\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t),\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(bdi), 32);\n\t),\n\tTP_printk(\"bdi %s\",\n\t\t__entry->name\n\t)\n);\n\nDECLARE_EVENT_CLASS(wbc_class,\n\tTP_PROTO(struct writeback_control *wbc, struct backing_dev_info *bdi),\n\tTP_ARGS(wbc, bdi),\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t\t__field(long, nr_to_write)\n\t\t__field(long, pages_skipped)\n\t\t__field(int, sync_mode)\n\t\t__field(int, for_kupdate)\n\t\t__field(int, for_background)\n\t\t__field(int, for_reclaim)\n\t\t__field(int, range_cyclic)\n\t\t__field(long, range_start)\n\t\t__field(long, range_end)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(bdi), 32);\n\t\t__entry->nr_to_write\t= wbc->nr_to_write;\n\t\t__entry->pages_skipped\t= wbc->pages_skipped;\n\t\t__entry->sync_mode\t= wbc->sync_mode;\n\t\t__entry->for_kupdate\t= wbc->for_kupdate;\n\t\t__entry->for_background\t= wbc->for_background;\n\t\t__entry->for_reclaim\t= wbc->for_reclaim;\n\t\t__entry->range_cyclic\t= wbc->range_cyclic;\n\t\t__entry->range_start\t= (long)wbc->range_start;\n\t\t__entry->range_end\t= (long)wbc->range_end;\n\t\t__entry->cgroup_ino\t= __trace_wbc_assign_cgroup(wbc);\n\t),\n\n\tTP_printk(\"bdi %s: towrt=%ld skip=%ld mode=%d kupd=%d \"\n\t\t\"bgrd=%d reclm=%d cyclic=%d \"\n\t\t\"start=0x%lx end=0x%lx cgroup_ino=%lu\",\n\t\t__entry->name,\n\t\t__entry->nr_to_write,\n\t\t__entry->pages_skipped,\n\t\t__entry->sync_mode,\n\t\t__entry->for_kupdate,\n\t\t__entry->for_background,\n\t\t__entry->for_reclaim,\n\t\t__entry->range_cyclic,\n\t\t__entry->range_start,\n\t\t__entry->range_end,\n\t\t(unsigned long)__entry->cgroup_ino\n\t)\n)\n\n#define DEFINE_WBC_EVENT(name) \\\nDEFINE_EVENT(wbc_class, name, \\\n\tTP_PROTO(struct writeback_control *wbc, struct backing_dev_info *bdi), \\\n\tTP_ARGS(wbc, bdi))\nDEFINE_WBC_EVENT(wbc_writepage);\n\nTRACE_EVENT(writeback_queue_io,\n\tTP_PROTO(struct bdi_writeback *wb,\n\t\t struct wb_writeback_work *work,\n\t\t unsigned long dirtied_before,\n\t\t int moved),\n\tTP_ARGS(wb, work, dirtied_before, moved),\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tname, 32)\n\t\t__field(unsigned long,\tolder)\n\t\t__field(long,\t\tage)\n\t\t__field(int,\t\tmoved)\n\t\t__field(int,\t\treason)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t),\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->older\t= dirtied_before;\n\t\t__entry->age\t= (jiffies - dirtied_before) * 1000 / HZ;\n\t\t__entry->moved\t= moved;\n\t\t__entry->reason\t= work->reason;\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(wb);\n\t),\n\tTP_printk(\"bdi %s: older=%lu age=%ld enqueue=%d reason=%s cgroup_ino=%lu\",\n\t\t__entry->name,\n\t\t__entry->older,\t \n\t\t__entry->age,\t \n\t\t__entry->moved,\n\t\t__print_symbolic(__entry->reason, WB_WORK_REASON),\n\t\t(unsigned long)__entry->cgroup_ino\n\t)\n);\n\nTRACE_EVENT(global_dirty_state,\n\n\tTP_PROTO(unsigned long background_thresh,\n\t\t unsigned long dirty_thresh\n\t),\n\n\tTP_ARGS(background_thresh,\n\t\tdirty_thresh\n\t),\n\n\tTP_STRUCT__entry(\n\t\t__field(unsigned long,\tnr_dirty)\n\t\t__field(unsigned long,\tnr_writeback)\n\t\t__field(unsigned long,\tbackground_thresh)\n\t\t__field(unsigned long,\tdirty_thresh)\n\t\t__field(unsigned long,\tdirty_limit)\n\t\t__field(unsigned long,\tnr_dirtied)\n\t\t__field(unsigned long,\tnr_written)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->nr_dirty\t= global_node_page_state(NR_FILE_DIRTY);\n\t\t__entry->nr_writeback\t= global_node_page_state(NR_WRITEBACK);\n\t\t__entry->nr_dirtied\t= global_node_page_state(NR_DIRTIED);\n\t\t__entry->nr_written\t= global_node_page_state(NR_WRITTEN);\n\t\t__entry->background_thresh = background_thresh;\n\t\t__entry->dirty_thresh\t= dirty_thresh;\n\t\t__entry->dirty_limit\t= global_wb_domain.dirty_limit;\n\t),\n\n\tTP_printk(\"dirty=%lu writeback=%lu \"\n\t\t  \"bg_thresh=%lu thresh=%lu limit=%lu \"\n\t\t  \"dirtied=%lu written=%lu\",\n\t\t  __entry->nr_dirty,\n\t\t  __entry->nr_writeback,\n\t\t  __entry->background_thresh,\n\t\t  __entry->dirty_thresh,\n\t\t  __entry->dirty_limit,\n\t\t  __entry->nr_dirtied,\n\t\t  __entry->nr_written\n\t)\n);\n\n#define KBps(x)\t\t\t((x) << (PAGE_SHIFT - 10))\n\nTRACE_EVENT(bdi_dirty_ratelimit,\n\n\tTP_PROTO(struct bdi_writeback *wb,\n\t\t unsigned long dirty_rate,\n\t\t unsigned long task_ratelimit),\n\n\tTP_ARGS(wb, dirty_rate, task_ratelimit),\n\n\tTP_STRUCT__entry(\n\t\t__array(char,\t\tbdi, 32)\n\t\t__field(unsigned long,\twrite_bw)\n\t\t__field(unsigned long,\tavg_write_bw)\n\t\t__field(unsigned long,\tdirty_rate)\n\t\t__field(unsigned long,\tdirty_ratelimit)\n\t\t__field(unsigned long,\ttask_ratelimit)\n\t\t__field(unsigned long,\tbalanced_dirty_ratelimit)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->bdi, bdi_dev_name(wb->bdi), 32);\n\t\t__entry->write_bw\t= KBps(wb->write_bandwidth);\n\t\t__entry->avg_write_bw\t= KBps(wb->avg_write_bandwidth);\n\t\t__entry->dirty_rate\t= KBps(dirty_rate);\n\t\t__entry->dirty_ratelimit = KBps(wb->dirty_ratelimit);\n\t\t__entry->task_ratelimit\t= KBps(task_ratelimit);\n\t\t__entry->balanced_dirty_ratelimit =\n\t\t\t\t\tKBps(wb->balanced_dirty_ratelimit);\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(wb);\n\t),\n\n\tTP_printk(\"bdi %s: \"\n\t\t  \"write_bw=%lu awrite_bw=%lu dirty_rate=%lu \"\n\t\t  \"dirty_ratelimit=%lu task_ratelimit=%lu \"\n\t\t  \"balanced_dirty_ratelimit=%lu cgroup_ino=%lu\",\n\t\t  __entry->bdi,\n\t\t  __entry->write_bw,\t\t \n\t\t  __entry->avg_write_bw,\t \n\t\t  __entry->dirty_rate,\t\t \n\t\t  __entry->dirty_ratelimit,\t \n\t\t  __entry->task_ratelimit,  \n\t\t  __entry->balanced_dirty_ratelimit,  \n\t\t  (unsigned long)__entry->cgroup_ino\n\t)\n);\n\nTRACE_EVENT(balance_dirty_pages,\n\n\tTP_PROTO(struct bdi_writeback *wb,\n\t\t unsigned long thresh,\n\t\t unsigned long bg_thresh,\n\t\t unsigned long dirty,\n\t\t unsigned long bdi_thresh,\n\t\t unsigned long bdi_dirty,\n\t\t unsigned long dirty_ratelimit,\n\t\t unsigned long task_ratelimit,\n\t\t unsigned long dirtied,\n\t\t unsigned long period,\n\t\t long pause,\n\t\t unsigned long start_time),\n\n\tTP_ARGS(wb, thresh, bg_thresh, dirty, bdi_thresh, bdi_dirty,\n\t\tdirty_ratelimit, task_ratelimit,\n\t\tdirtied, period, pause, start_time),\n\n\tTP_STRUCT__entry(\n\t\t__array(\t char,\tbdi, 32)\n\t\t__field(unsigned long,\tlimit)\n\t\t__field(unsigned long,\tsetpoint)\n\t\t__field(unsigned long,\tdirty)\n\t\t__field(unsigned long,\tbdi_setpoint)\n\t\t__field(unsigned long,\tbdi_dirty)\n\t\t__field(unsigned long,\tdirty_ratelimit)\n\t\t__field(unsigned long,\ttask_ratelimit)\n\t\t__field(unsigned int,\tdirtied)\n\t\t__field(unsigned int,\tdirtied_pause)\n\t\t__field(unsigned long,\tpaused)\n\t\t__field(\t long,\tpause)\n\t\t__field(unsigned long,\tperiod)\n\t\t__field(\t long,\tthink)\n\t\t__field(ino_t,\t\tcgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tunsigned long freerun = (thresh + bg_thresh) / 2;\n\t\tstrscpy_pad(__entry->bdi, bdi_dev_name(wb->bdi), 32);\n\n\t\t__entry->limit\t\t= global_wb_domain.dirty_limit;\n\t\t__entry->setpoint\t= (global_wb_domain.dirty_limit +\n\t\t\t\t\t\tfreerun) / 2;\n\t\t__entry->dirty\t\t= dirty;\n\t\t__entry->bdi_setpoint\t= __entry->setpoint *\n\t\t\t\t\t\tbdi_thresh / (thresh + 1);\n\t\t__entry->bdi_dirty\t= bdi_dirty;\n\t\t__entry->dirty_ratelimit = KBps(dirty_ratelimit);\n\t\t__entry->task_ratelimit\t= KBps(task_ratelimit);\n\t\t__entry->dirtied\t= dirtied;\n\t\t__entry->dirtied_pause\t= current->nr_dirtied_pause;\n\t\t__entry->think\t\t= current->dirty_paused_when == 0 ? 0 :\n\t\t\t (long)(jiffies - current->dirty_paused_when) * 1000/HZ;\n\t\t__entry->period\t\t= period * 1000 / HZ;\n\t\t__entry->pause\t\t= pause * 1000 / HZ;\n\t\t__entry->paused\t\t= (jiffies - start_time) * 1000 / HZ;\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(wb);\n\t),\n\n\n\tTP_printk(\"bdi %s: \"\n\t\t  \"limit=%lu setpoint=%lu dirty=%lu \"\n\t\t  \"bdi_setpoint=%lu bdi_dirty=%lu \"\n\t\t  \"dirty_ratelimit=%lu task_ratelimit=%lu \"\n\t\t  \"dirtied=%u dirtied_pause=%u \"\n\t\t  \"paused=%lu pause=%ld period=%lu think=%ld cgroup_ino=%lu\",\n\t\t  __entry->bdi,\n\t\t  __entry->limit,\n\t\t  __entry->setpoint,\n\t\t  __entry->dirty,\n\t\t  __entry->bdi_setpoint,\n\t\t  __entry->bdi_dirty,\n\t\t  __entry->dirty_ratelimit,\n\t\t  __entry->task_ratelimit,\n\t\t  __entry->dirtied,\n\t\t  __entry->dirtied_pause,\n\t\t  __entry->paused,\t \n\t\t  __entry->pause,\t \n\t\t  __entry->period,\t \n\t\t  __entry->think,\t \n\t\t  (unsigned long)__entry->cgroup_ino\n\t  )\n);\n\nTRACE_EVENT(writeback_sb_inodes_requeue,\n\n\tTP_PROTO(struct inode *inode),\n\tTP_ARGS(inode),\n\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, ino)\n\t\t__field(unsigned long, state)\n\t\t__field(unsigned long, dirtied_when)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name,\n\t\t\t    bdi_dev_name(inode_to_bdi(inode)), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->state\t\t= inode->i_state;\n\t\t__entry->dirtied_when\t= inode->dirtied_when;\n\t\t__entry->cgroup_ino\t= __trace_wb_assign_cgroup(inode_to_wb(inode));\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu state=%s dirtied_when=%lu age=%lu cgroup_ino=%lu\",\n\t\t  __entry->name,\n\t\t  (unsigned long)__entry->ino,\n\t\t  show_inode_state(__entry->state),\n\t\t  __entry->dirtied_when,\n\t\t  (jiffies - __entry->dirtied_when) / HZ,\n\t\t  (unsigned long)__entry->cgroup_ino\n\t)\n);\n\nDECLARE_EVENT_CLASS(writeback_single_inode_template,\n\n\tTP_PROTO(struct inode *inode,\n\t\t struct writeback_control *wbc,\n\t\t unsigned long nr_to_write\n\t),\n\n\tTP_ARGS(inode, wbc, nr_to_write),\n\n\tTP_STRUCT__entry(\n\t\t__array(char, name, 32)\n\t\t__field(ino_t, ino)\n\t\t__field(unsigned long, state)\n\t\t__field(unsigned long, dirtied_when)\n\t\t__field(unsigned long, writeback_index)\n\t\t__field(long, nr_to_write)\n\t\t__field(unsigned long, wrote)\n\t\t__field(ino_t, cgroup_ino)\n\t),\n\n\tTP_fast_assign(\n\t\tstrscpy_pad(__entry->name,\n\t\t\t    bdi_dev_name(inode_to_bdi(inode)), 32);\n\t\t__entry->ino\t\t= inode->i_ino;\n\t\t__entry->state\t\t= inode->i_state;\n\t\t__entry->dirtied_when\t= inode->dirtied_when;\n\t\t__entry->writeback_index = inode->i_mapping->writeback_index;\n\t\t__entry->nr_to_write\t= nr_to_write;\n\t\t__entry->wrote\t\t= nr_to_write - wbc->nr_to_write;\n\t\t__entry->cgroup_ino\t= __trace_wbc_assign_cgroup(wbc);\n\t),\n\n\tTP_printk(\"bdi %s: ino=%lu state=%s dirtied_when=%lu age=%lu \"\n\t\t  \"index=%lu to_write=%ld wrote=%lu cgroup_ino=%lu\",\n\t\t  __entry->name,\n\t\t  (unsigned long)__entry->ino,\n\t\t  show_inode_state(__entry->state),\n\t\t  __entry->dirtied_when,\n\t\t  (jiffies - __entry->dirtied_when) / HZ,\n\t\t  __entry->writeback_index,\n\t\t  __entry->nr_to_write,\n\t\t  __entry->wrote,\n\t\t  (unsigned long)__entry->cgroup_ino\n\t)\n);\n\nDEFINE_EVENT(writeback_single_inode_template, writeback_single_inode_start,\n\tTP_PROTO(struct inode *inode,\n\t\t struct writeback_control *wbc,\n\t\t unsigned long nr_to_write),\n\tTP_ARGS(inode, wbc, nr_to_write)\n);\n\nDEFINE_EVENT(writeback_single_inode_template, writeback_single_inode,\n\tTP_PROTO(struct inode *inode,\n\t\t struct writeback_control *wbc,\n\t\t unsigned long nr_to_write),\n\tTP_ARGS(inode, wbc, nr_to_write)\n);\n\nDECLARE_EVENT_CLASS(writeback_inode_template,\n\tTP_PROTO(struct inode *inode),\n\n\tTP_ARGS(inode),\n\n\tTP_STRUCT__entry(\n\t\t__field(\tdev_t,\tdev\t\t\t)\n\t\t__field(\tino_t,\tino\t\t\t)\n\t\t__field(unsigned long,\tstate\t\t\t)\n\t\t__field(\t__u16, mode\t\t\t)\n\t\t__field(unsigned long, dirtied_when\t\t)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->dev\t= inode->i_sb->s_dev;\n\t\t__entry->ino\t= inode->i_ino;\n\t\t__entry->state\t= inode->i_state;\n\t\t__entry->mode\t= inode->i_mode;\n\t\t__entry->dirtied_when = inode->dirtied_when;\n\t),\n\n\tTP_printk(\"dev %d,%d ino %lu dirtied %lu state %s mode 0%o\",\n\t\t  MAJOR(__entry->dev), MINOR(__entry->dev),\n\t\t  (unsigned long)__entry->ino, __entry->dirtied_when,\n\t\t  show_inode_state(__entry->state), __entry->mode)\n);\n\nDEFINE_EVENT(writeback_inode_template, writeback_lazytime,\n\tTP_PROTO(struct inode *inode),\n\n\tTP_ARGS(inode)\n);\n\nDEFINE_EVENT(writeback_inode_template, writeback_lazytime_iput,\n\tTP_PROTO(struct inode *inode),\n\n\tTP_ARGS(inode)\n);\n\nDEFINE_EVENT(writeback_inode_template, writeback_dirty_inode_enqueue,\n\n\tTP_PROTO(struct inode *inode),\n\n\tTP_ARGS(inode)\n);\n\n \n\nDEFINE_EVENT(writeback_inode_template, sb_mark_inode_writeback,\n\tTP_PROTO(struct inode *inode),\n\tTP_ARGS(inode)\n);\n\nDEFINE_EVENT(writeback_inode_template, sb_clear_inode_writeback,\n\tTP_PROTO(struct inode *inode),\n\tTP_ARGS(inode)\n);\n\n#endif  \n\n \n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}