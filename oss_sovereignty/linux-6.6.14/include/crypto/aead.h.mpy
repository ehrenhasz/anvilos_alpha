{
  "module_name": "aead.h",
  "hash_id": "21a25ccc511394f8c22f577d0cb1137ebe88ec6d1cdcd8ccfac62715169a43ae",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/aead.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_AEAD_H\n#define _CRYPTO_AEAD_H\n\n#include <linux/atomic.h>\n#include <linux/container_of.h>\n#include <linux/crypto.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n \n\nstruct crypto_aead;\nstruct scatterlist;\n\n \nstruct aead_request {\n\tstruct crypto_async_request base;\n\n\tunsigned int assoclen;\n\tunsigned int cryptlen;\n\n\tu8 *iv;\n\n\tstruct scatterlist *src;\n\tstruct scatterlist *dst;\n\n\tvoid *__ctx[] CRYPTO_MINALIGN_ATTR;\n};\n\n \nstruct crypto_istat_aead {\n\tatomic64_t encrypt_cnt;\n\tatomic64_t encrypt_tlen;\n\tatomic64_t decrypt_cnt;\n\tatomic64_t decrypt_tlen;\n\tatomic64_t err_cnt;\n};\n\n \nstruct aead_alg {\n\tint (*setkey)(struct crypto_aead *tfm, const u8 *key,\n\t              unsigned int keylen);\n\tint (*setauthsize)(struct crypto_aead *tfm, unsigned int authsize);\n\tint (*encrypt)(struct aead_request *req);\n\tint (*decrypt)(struct aead_request *req);\n\tint (*init)(struct crypto_aead *tfm);\n\tvoid (*exit)(struct crypto_aead *tfm);\n\n#ifdef CONFIG_CRYPTO_STATS\n\tstruct crypto_istat_aead stat;\n#endif\n\n\tunsigned int ivsize;\n\tunsigned int maxauthsize;\n\tunsigned int chunksize;\n\n\tstruct crypto_alg base;\n};\n\nstruct crypto_aead {\n\tunsigned int authsize;\n\tunsigned int reqsize;\n\n\tstruct crypto_tfm base;\n};\n\nstatic inline struct crypto_aead *__crypto_aead_cast(struct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_aead, base);\n}\n\n \nstruct crypto_aead *crypto_alloc_aead(const char *alg_name, u32 type, u32 mask);\n\nstatic inline struct crypto_tfm *crypto_aead_tfm(struct crypto_aead *tfm)\n{\n\treturn &tfm->base;\n}\n\n \nstatic inline void crypto_free_aead(struct crypto_aead *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_aead_tfm(tfm));\n}\n\nstatic inline const char *crypto_aead_driver_name(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_alg_driver_name(crypto_aead_tfm(tfm));\n}\n\nstatic inline struct aead_alg *crypto_aead_alg(struct crypto_aead *tfm)\n{\n\treturn container_of(crypto_aead_tfm(tfm)->__crt_alg,\n\t\t\t    struct aead_alg, base);\n}\n\nstatic inline unsigned int crypto_aead_alg_ivsize(struct aead_alg *alg)\n{\n\treturn alg->ivsize;\n}\n\n \nstatic inline unsigned int crypto_aead_ivsize(struct crypto_aead *tfm)\n{\n\treturn crypto_aead_alg_ivsize(crypto_aead_alg(tfm));\n}\n\n \nstatic inline unsigned int crypto_aead_authsize(struct crypto_aead *tfm)\n{\n\treturn tfm->authsize;\n}\n\nstatic inline unsigned int crypto_aead_alg_maxauthsize(struct aead_alg *alg)\n{\n\treturn alg->maxauthsize;\n}\n\nstatic inline unsigned int crypto_aead_maxauthsize(struct crypto_aead *aead)\n{\n\treturn crypto_aead_alg_maxauthsize(crypto_aead_alg(aead));\n}\n\n \nstatic inline unsigned int crypto_aead_blocksize(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_alg_blocksize(crypto_aead_tfm(tfm));\n}\n\nstatic inline unsigned int crypto_aead_alignmask(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_alg_alignmask(crypto_aead_tfm(tfm));\n}\n\nstatic inline u32 crypto_aead_get_flags(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_get_flags(crypto_aead_tfm(tfm));\n}\n\nstatic inline void crypto_aead_set_flags(struct crypto_aead *tfm, u32 flags)\n{\n\tcrypto_tfm_set_flags(crypto_aead_tfm(tfm), flags);\n}\n\nstatic inline void crypto_aead_clear_flags(struct crypto_aead *tfm, u32 flags)\n{\n\tcrypto_tfm_clear_flags(crypto_aead_tfm(tfm), flags);\n}\n\n \nint crypto_aead_setkey(struct crypto_aead *tfm,\n\t\t       const u8 *key, unsigned int keylen);\n\n \nint crypto_aead_setauthsize(struct crypto_aead *tfm, unsigned int authsize);\n\nstatic inline struct crypto_aead *crypto_aead_reqtfm(struct aead_request *req)\n{\n\treturn __crypto_aead_cast(req->base.tfm);\n}\n\n \nint crypto_aead_encrypt(struct aead_request *req);\n\n \nint crypto_aead_decrypt(struct aead_request *req);\n\n \n\n \nstatic inline unsigned int crypto_aead_reqsize(struct crypto_aead *tfm)\n{\n\treturn tfm->reqsize;\n}\n\n \nstatic inline void aead_request_set_tfm(struct aead_request *req,\n\t\t\t\t\tstruct crypto_aead *tfm)\n{\n\treq->base.tfm = crypto_aead_tfm(tfm);\n}\n\n \nstatic inline struct aead_request *aead_request_alloc(struct crypto_aead *tfm,\n\t\t\t\t\t\t      gfp_t gfp)\n{\n\tstruct aead_request *req;\n\n\treq = kmalloc(sizeof(*req) + crypto_aead_reqsize(tfm), gfp);\n\n\tif (likely(req))\n\t\taead_request_set_tfm(req, tfm);\n\n\treturn req;\n}\n\n \nstatic inline void aead_request_free(struct aead_request *req)\n{\n\tkfree_sensitive(req);\n}\n\n \nstatic inline void aead_request_set_callback(struct aead_request *req,\n\t\t\t\t\t     u32 flags,\n\t\t\t\t\t     crypto_completion_t compl,\n\t\t\t\t\t     void *data)\n{\n\treq->base.complete = compl;\n\treq->base.data = data;\n\treq->base.flags = flags;\n}\n\n \nstatic inline void aead_request_set_crypt(struct aead_request *req,\n\t\t\t\t\t  struct scatterlist *src,\n\t\t\t\t\t  struct scatterlist *dst,\n\t\t\t\t\t  unsigned int cryptlen, u8 *iv)\n{\n\treq->src = src;\n\treq->dst = dst;\n\treq->cryptlen = cryptlen;\n\treq->iv = iv;\n}\n\n \nstatic inline void aead_request_set_ad(struct aead_request *req,\n\t\t\t\t       unsigned int assoclen)\n{\n\treq->assoclen = assoclen;\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}