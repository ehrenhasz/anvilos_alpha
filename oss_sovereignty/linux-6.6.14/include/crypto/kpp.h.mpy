{
  "module_name": "kpp.h",
  "hash_id": "09a933f2ed23091de8bf4c9ad2aa66c6dd218bfd8471d66173333e55cea8781f",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/kpp.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_KPP_\n#define _CRYPTO_KPP_\n\n#include <linux/atomic.h>\n#include <linux/container_of.h>\n#include <linux/crypto.h>\n#include <linux/slab.h>\n\n \nstruct kpp_request {\n\tstruct crypto_async_request base;\n\tstruct scatterlist *src;\n\tstruct scatterlist *dst;\n\tunsigned int src_len;\n\tunsigned int dst_len;\n\tvoid *__ctx[] CRYPTO_MINALIGN_ATTR;\n};\n\n \nstruct crypto_kpp {\n\tunsigned int reqsize;\n\n\tstruct crypto_tfm base;\n};\n\n \nstruct crypto_istat_kpp {\n\tatomic64_t setsecret_cnt;\n\tatomic64_t generate_public_key_cnt;\n\tatomic64_t compute_shared_secret_cnt;\n\tatomic64_t err_cnt;\n};\n\n \nstruct kpp_alg {\n\tint (*set_secret)(struct crypto_kpp *tfm, const void *buffer,\n\t\t\t  unsigned int len);\n\tint (*generate_public_key)(struct kpp_request *req);\n\tint (*compute_shared_secret)(struct kpp_request *req);\n\n\tunsigned int (*max_size)(struct crypto_kpp *tfm);\n\n\tint (*init)(struct crypto_kpp *tfm);\n\tvoid (*exit)(struct crypto_kpp *tfm);\n\n#ifdef CONFIG_CRYPTO_STATS\n\tstruct crypto_istat_kpp stat;\n#endif\n\n\tstruct crypto_alg base;\n};\n\n \n\n \nstruct crypto_kpp *crypto_alloc_kpp(const char *alg_name, u32 type, u32 mask);\n\nint crypto_has_kpp(const char *alg_name, u32 type, u32 mask);\n\nstatic inline struct crypto_tfm *crypto_kpp_tfm(struct crypto_kpp *tfm)\n{\n\treturn &tfm->base;\n}\n\nstatic inline struct kpp_alg *__crypto_kpp_alg(struct crypto_alg *alg)\n{\n\treturn container_of(alg, struct kpp_alg, base);\n}\n\nstatic inline struct crypto_kpp *__crypto_kpp_tfm(struct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_kpp, base);\n}\n\nstatic inline struct kpp_alg *crypto_kpp_alg(struct crypto_kpp *tfm)\n{\n\treturn __crypto_kpp_alg(crypto_kpp_tfm(tfm)->__crt_alg);\n}\n\nstatic inline unsigned int crypto_kpp_reqsize(struct crypto_kpp *tfm)\n{\n\treturn tfm->reqsize;\n}\n\nstatic inline void kpp_request_set_tfm(struct kpp_request *req,\n\t\t\t\t       struct crypto_kpp *tfm)\n{\n\treq->base.tfm = crypto_kpp_tfm(tfm);\n}\n\nstatic inline struct crypto_kpp *crypto_kpp_reqtfm(struct kpp_request *req)\n{\n\treturn __crypto_kpp_tfm(req->base.tfm);\n}\n\nstatic inline u32 crypto_kpp_get_flags(struct crypto_kpp *tfm)\n{\n\treturn crypto_tfm_get_flags(crypto_kpp_tfm(tfm));\n}\n\nstatic inline void crypto_kpp_set_flags(struct crypto_kpp *tfm, u32 flags)\n{\n\tcrypto_tfm_set_flags(crypto_kpp_tfm(tfm), flags);\n}\n\n \nstatic inline void crypto_free_kpp(struct crypto_kpp *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_kpp_tfm(tfm));\n}\n\n \nstatic inline struct kpp_request *kpp_request_alloc(struct crypto_kpp *tfm,\n\t\t\t\t\t\t    gfp_t gfp)\n{\n\tstruct kpp_request *req;\n\n\treq = kmalloc(sizeof(*req) + crypto_kpp_reqsize(tfm), gfp);\n\tif (likely(req))\n\t\tkpp_request_set_tfm(req, tfm);\n\n\treturn req;\n}\n\n \nstatic inline void kpp_request_free(struct kpp_request *req)\n{\n\tkfree_sensitive(req);\n}\n\n \nstatic inline void kpp_request_set_callback(struct kpp_request *req,\n\t\t\t\t\t    u32 flgs,\n\t\t\t\t\t    crypto_completion_t cmpl,\n\t\t\t\t\t    void *data)\n{\n\treq->base.complete = cmpl;\n\treq->base.data = data;\n\treq->base.flags = flgs;\n}\n\n \nstatic inline void kpp_request_set_input(struct kpp_request *req,\n\t\t\t\t\t struct scatterlist *input,\n\t\t\t\t\t unsigned int input_len)\n{\n\treq->src = input;\n\treq->src_len = input_len;\n}\n\n \nstatic inline void kpp_request_set_output(struct kpp_request *req,\n\t\t\t\t\t  struct scatterlist *output,\n\t\t\t\t\t  unsigned int output_len)\n{\n\treq->dst = output;\n\treq->dst_len = output_len;\n}\n\nenum {\n\tCRYPTO_KPP_SECRET_TYPE_UNKNOWN,\n\tCRYPTO_KPP_SECRET_TYPE_DH,\n\tCRYPTO_KPP_SECRET_TYPE_ECDH,\n};\n\n \nstruct kpp_secret {\n\tunsigned short type;\n\tunsigned short len;\n};\n\nstatic inline struct crypto_istat_kpp *kpp_get_stat(struct kpp_alg *alg)\n{\n#ifdef CONFIG_CRYPTO_STATS\n\treturn &alg->stat;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline int crypto_kpp_errstat(struct kpp_alg *alg, int err)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\treturn err;\n\n\tif (err && err != -EINPROGRESS && err != -EBUSY)\n\t\tatomic64_inc(&kpp_get_stat(alg)->err_cnt);\n\n\treturn err;\n}\n\n \nstatic inline int crypto_kpp_set_secret(struct crypto_kpp *tfm,\n\t\t\t\t\tconst void *buffer, unsigned int len)\n{\n\tstruct kpp_alg *alg = crypto_kpp_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_inc(&kpp_get_stat(alg)->setsecret_cnt);\n\n\treturn crypto_kpp_errstat(alg, alg->set_secret(tfm, buffer, len));\n}\n\n \nstatic inline int crypto_kpp_generate_public_key(struct kpp_request *req)\n{\n\tstruct crypto_kpp *tfm = crypto_kpp_reqtfm(req);\n\tstruct kpp_alg *alg = crypto_kpp_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_inc(&kpp_get_stat(alg)->generate_public_key_cnt);\n\n\treturn crypto_kpp_errstat(alg, alg->generate_public_key(req));\n}\n\n \nstatic inline int crypto_kpp_compute_shared_secret(struct kpp_request *req)\n{\n\tstruct crypto_kpp *tfm = crypto_kpp_reqtfm(req);\n\tstruct kpp_alg *alg = crypto_kpp_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_inc(&kpp_get_stat(alg)->compute_shared_secret_cnt);\n\n\treturn crypto_kpp_errstat(alg, alg->compute_shared_secret(req));\n}\n\n \nstatic inline unsigned int crypto_kpp_maxsize(struct crypto_kpp *tfm)\n{\n\tstruct kpp_alg *alg = crypto_kpp_alg(tfm);\n\n\treturn alg->max_size(tfm);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}