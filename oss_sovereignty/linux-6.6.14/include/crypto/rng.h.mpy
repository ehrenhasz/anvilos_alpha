{
  "module_name": "rng.h",
  "hash_id": "83102e69dcb89c6bc2a800131fa3fd98295cf53951b40fe506ec81f2b59922e3",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/rng.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_RNG_H\n#define _CRYPTO_RNG_H\n\n#include <linux/atomic.h>\n#include <linux/container_of.h>\n#include <linux/crypto.h>\n\nstruct crypto_rng;\n\n \nstruct crypto_istat_rng {\n\tatomic64_t generate_cnt;\n\tatomic64_t generate_tlen;\n\tatomic64_t seed_cnt;\n\tatomic64_t err_cnt;\n};\n\n \nstruct rng_alg {\n\tint (*generate)(struct crypto_rng *tfm,\n\t\t\tconst u8 *src, unsigned int slen,\n\t\t\tu8 *dst, unsigned int dlen);\n\tint (*seed)(struct crypto_rng *tfm, const u8 *seed, unsigned int slen);\n\tvoid (*set_ent)(struct crypto_rng *tfm, const u8 *data,\n\t\t\tunsigned int len);\n\n#ifdef CONFIG_CRYPTO_STATS\n\tstruct crypto_istat_rng stat;\n#endif\n\n\tunsigned int seedsize;\n\n\tstruct crypto_alg base;\n};\n\nstruct crypto_rng {\n\tstruct crypto_tfm base;\n};\n\nextern struct crypto_rng *crypto_default_rng;\n\nint crypto_get_default_rng(void);\nvoid crypto_put_default_rng(void);\n\n \n\n \nstruct crypto_rng *crypto_alloc_rng(const char *alg_name, u32 type, u32 mask);\n\nstatic inline struct crypto_tfm *crypto_rng_tfm(struct crypto_rng *tfm)\n{\n\treturn &tfm->base;\n}\n\nstatic inline struct rng_alg *__crypto_rng_alg(struct crypto_alg *alg)\n{\n\treturn container_of(alg, struct rng_alg, base);\n}\n\n \nstatic inline struct rng_alg *crypto_rng_alg(struct crypto_rng *tfm)\n{\n\treturn __crypto_rng_alg(crypto_rng_tfm(tfm)->__crt_alg);\n}\n\n \nstatic inline void crypto_free_rng(struct crypto_rng *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_rng_tfm(tfm));\n}\n\nstatic inline struct crypto_istat_rng *rng_get_stat(struct rng_alg *alg)\n{\n#ifdef CONFIG_CRYPTO_STATS\n\treturn &alg->stat;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline int crypto_rng_errstat(struct rng_alg *alg, int err)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\treturn err;\n\n\tif (err && err != -EINPROGRESS && err != -EBUSY)\n\t\tatomic64_inc(&rng_get_stat(alg)->err_cnt);\n\n\treturn err;\n}\n\n \nstatic inline int crypto_rng_generate(struct crypto_rng *tfm,\n\t\t\t\t      const u8 *src, unsigned int slen,\n\t\t\t\t      u8 *dst, unsigned int dlen)\n{\n\tstruct rng_alg *alg = crypto_rng_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS)) {\n\t\tstruct crypto_istat_rng *istat = rng_get_stat(alg);\n\n\t\tatomic64_inc(&istat->generate_cnt);\n\t\tatomic64_add(dlen, &istat->generate_tlen);\n\t}\n\n\treturn crypto_rng_errstat(alg,\n\t\t\t\t  alg->generate(tfm, src, slen, dst, dlen));\n}\n\n \nstatic inline int crypto_rng_get_bytes(struct crypto_rng *tfm,\n\t\t\t\t       u8 *rdata, unsigned int dlen)\n{\n\treturn crypto_rng_generate(tfm, NULL, 0, rdata, dlen);\n}\n\n \nint crypto_rng_reset(struct crypto_rng *tfm, const u8 *seed,\n\t\t     unsigned int slen);\n\n \nstatic inline int crypto_rng_seedsize(struct crypto_rng *tfm)\n{\n\treturn crypto_rng_alg(tfm)->seedsize;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}