{
  "module_name": "hash.h",
  "hash_id": "dc465b7e67d92c711583b6f1795a3f851efbbd3ded7e185ce3f85f3adfb863a8",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/hash.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_HASH_H\n#define _CRYPTO_HASH_H\n\n#include <linux/atomic.h>\n#include <linux/crypto.h>\n#include <linux/string.h>\n\nstruct crypto_ahash;\n\n \n\n \nstruct crypto_istat_hash {\n\tatomic64_t hash_cnt;\n\tatomic64_t hash_tlen;\n\tatomic64_t err_cnt;\n};\n\n#ifdef CONFIG_CRYPTO_STATS\n#define HASH_ALG_COMMON_STAT struct crypto_istat_hash stat;\n#else\n#define HASH_ALG_COMMON_STAT\n#endif\n\n \n#define HASH_ALG_COMMON {\t\t\\\n\tHASH_ALG_COMMON_STAT\t\t\\\n\t\t\t\t\t\\\n\tunsigned int digestsize;\t\\\n\tunsigned int statesize;\t\t\\\n\t\t\t\t\t\\\n\tstruct crypto_alg base;\t\t\\\n}\nstruct hash_alg_common HASH_ALG_COMMON;\n\nstruct ahash_request {\n\tstruct crypto_async_request base;\n\n\tunsigned int nbytes;\n\tstruct scatterlist *src;\n\tu8 *result;\n\n\t \n\tvoid *priv;\n\n\tvoid *__ctx[] CRYPTO_MINALIGN_ATTR;\n};\n\n \nstruct ahash_alg {\n\tint (*init)(struct ahash_request *req);\n\tint (*update)(struct ahash_request *req);\n\tint (*final)(struct ahash_request *req);\n\tint (*finup)(struct ahash_request *req);\n\tint (*digest)(struct ahash_request *req);\n\tint (*export)(struct ahash_request *req, void *out);\n\tint (*import)(struct ahash_request *req, const void *in);\n\tint (*setkey)(struct crypto_ahash *tfm, const u8 *key,\n\t\t      unsigned int keylen);\n\tint (*init_tfm)(struct crypto_ahash *tfm);\n\tvoid (*exit_tfm)(struct crypto_ahash *tfm);\n\tint (*clone_tfm)(struct crypto_ahash *dst, struct crypto_ahash *src);\n\n\tstruct hash_alg_common halg;\n};\n\nstruct shash_desc {\n\tstruct crypto_shash *tfm;\n\tvoid *__ctx[] __aligned(ARCH_SLAB_MINALIGN);\n};\n\n#define HASH_MAX_DIGESTSIZE\t 64\n\n \n#define HASH_MAX_DESCSIZE\t(sizeof(struct shash_desc) + 360)\n\n#define SHASH_DESC_ON_STACK(shash, ctx)\t\t\t\t\t     \\\n\tchar __##shash##_desc[sizeof(struct shash_desc) + HASH_MAX_DESCSIZE] \\\n\t\t__aligned(__alignof__(struct shash_desc));\t\t     \\\n\tstruct shash_desc *shash = (struct shash_desc *)__##shash##_desc\n\n \nstruct shash_alg {\n\tint (*init)(struct shash_desc *desc);\n\tint (*update)(struct shash_desc *desc, const u8 *data,\n\t\t      unsigned int len);\n\tint (*final)(struct shash_desc *desc, u8 *out);\n\tint (*finup)(struct shash_desc *desc, const u8 *data,\n\t\t     unsigned int len, u8 *out);\n\tint (*digest)(struct shash_desc *desc, const u8 *data,\n\t\t      unsigned int len, u8 *out);\n\tint (*export)(struct shash_desc *desc, void *out);\n\tint (*import)(struct shash_desc *desc, const void *in);\n\tint (*setkey)(struct crypto_shash *tfm, const u8 *key,\n\t\t      unsigned int keylen);\n\tint (*init_tfm)(struct crypto_shash *tfm);\n\tvoid (*exit_tfm)(struct crypto_shash *tfm);\n\tint (*clone_tfm)(struct crypto_shash *dst, struct crypto_shash *src);\n\n\tunsigned int descsize;\n\n\tunion {\n\t\tstruct HASH_ALG_COMMON;\n\t\tstruct hash_alg_common halg;\n\t};\n};\n#undef HASH_ALG_COMMON\n#undef HASH_ALG_COMMON_STAT\n\nstruct crypto_ahash {\n\tint (*init)(struct ahash_request *req);\n\tint (*update)(struct ahash_request *req);\n\tint (*final)(struct ahash_request *req);\n\tint (*finup)(struct ahash_request *req);\n\tint (*digest)(struct ahash_request *req);\n\tint (*export)(struct ahash_request *req, void *out);\n\tint (*import)(struct ahash_request *req, const void *in);\n\tint (*setkey)(struct crypto_ahash *tfm, const u8 *key,\n\t\t      unsigned int keylen);\n\n\tunsigned int statesize;\n\tunsigned int reqsize;\n\tstruct crypto_tfm base;\n};\n\nstruct crypto_shash {\n\tunsigned int descsize;\n\tstruct crypto_tfm base;\n};\n\n \n\nstatic inline struct crypto_ahash *__crypto_ahash_cast(struct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_ahash, base);\n}\n\n \nstruct crypto_ahash *crypto_alloc_ahash(const char *alg_name, u32 type,\n\t\t\t\t\tu32 mask);\n\nstruct crypto_ahash *crypto_clone_ahash(struct crypto_ahash *tfm);\n\nstatic inline struct crypto_tfm *crypto_ahash_tfm(struct crypto_ahash *tfm)\n{\n\treturn &tfm->base;\n}\n\n \nstatic inline void crypto_free_ahash(struct crypto_ahash *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_ahash_tfm(tfm));\n}\n\n \nint crypto_has_ahash(const char *alg_name, u32 type, u32 mask);\n\nstatic inline const char *crypto_ahash_alg_name(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_alg_name(crypto_ahash_tfm(tfm));\n}\n\nstatic inline const char *crypto_ahash_driver_name(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_alg_driver_name(crypto_ahash_tfm(tfm));\n}\n\nstatic inline unsigned int crypto_ahash_alignmask(\n\tstruct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_alg_alignmask(crypto_ahash_tfm(tfm));\n}\n\n \nstatic inline unsigned int crypto_ahash_blocksize(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_alg_blocksize(crypto_ahash_tfm(tfm));\n}\n\nstatic inline struct hash_alg_common *__crypto_hash_alg_common(\n\tstruct crypto_alg *alg)\n{\n\treturn container_of(alg, struct hash_alg_common, base);\n}\n\nstatic inline struct hash_alg_common *crypto_hash_alg_common(\n\tstruct crypto_ahash *tfm)\n{\n\treturn __crypto_hash_alg_common(crypto_ahash_tfm(tfm)->__crt_alg);\n}\n\n \nstatic inline unsigned int crypto_ahash_digestsize(struct crypto_ahash *tfm)\n{\n\treturn crypto_hash_alg_common(tfm)->digestsize;\n}\n\n \nstatic inline unsigned int crypto_ahash_statesize(struct crypto_ahash *tfm)\n{\n\treturn tfm->statesize;\n}\n\nstatic inline u32 crypto_ahash_get_flags(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_get_flags(crypto_ahash_tfm(tfm));\n}\n\nstatic inline void crypto_ahash_set_flags(struct crypto_ahash *tfm, u32 flags)\n{\n\tcrypto_tfm_set_flags(crypto_ahash_tfm(tfm), flags);\n}\n\nstatic inline void crypto_ahash_clear_flags(struct crypto_ahash *tfm, u32 flags)\n{\n\tcrypto_tfm_clear_flags(crypto_ahash_tfm(tfm), flags);\n}\n\n \nstatic inline struct crypto_ahash *crypto_ahash_reqtfm(\n\tstruct ahash_request *req)\n{\n\treturn __crypto_ahash_cast(req->base.tfm);\n}\n\n \nstatic inline unsigned int crypto_ahash_reqsize(struct crypto_ahash *tfm)\n{\n\treturn tfm->reqsize;\n}\n\nstatic inline void *ahash_request_ctx(struct ahash_request *req)\n{\n\treturn req->__ctx;\n}\n\n \nint crypto_ahash_setkey(struct crypto_ahash *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\n\n \nint crypto_ahash_finup(struct ahash_request *req);\n\n \nint crypto_ahash_final(struct ahash_request *req);\n\n \nint crypto_ahash_digest(struct ahash_request *req);\n\n \nstatic inline int crypto_ahash_export(struct ahash_request *req, void *out)\n{\n\treturn crypto_ahash_reqtfm(req)->export(req, out);\n}\n\n \nstatic inline int crypto_ahash_import(struct ahash_request *req, const void *in)\n{\n\tstruct crypto_ahash *tfm = crypto_ahash_reqtfm(req);\n\n\tif (crypto_ahash_get_flags(tfm) & CRYPTO_TFM_NEED_KEY)\n\t\treturn -ENOKEY;\n\n\treturn tfm->import(req, in);\n}\n\n \nstatic inline int crypto_ahash_init(struct ahash_request *req)\n{\n\tstruct crypto_ahash *tfm = crypto_ahash_reqtfm(req);\n\n\tif (crypto_ahash_get_flags(tfm) & CRYPTO_TFM_NEED_KEY)\n\t\treturn -ENOKEY;\n\n\treturn tfm->init(req);\n}\n\nstatic inline struct crypto_istat_hash *hash_get_stat(\n\tstruct hash_alg_common *alg)\n{\n#ifdef CONFIG_CRYPTO_STATS\n\treturn &alg->stat;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline int crypto_hash_errstat(struct hash_alg_common *alg, int err)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\treturn err;\n\n\tif (err && err != -EINPROGRESS && err != -EBUSY)\n\t\tatomic64_inc(&hash_get_stat(alg)->err_cnt);\n\n\treturn err;\n}\n\n \nstatic inline int crypto_ahash_update(struct ahash_request *req)\n{\n\tstruct crypto_ahash *tfm = crypto_ahash_reqtfm(req);\n\tstruct hash_alg_common *alg = crypto_hash_alg_common(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_add(req->nbytes, &hash_get_stat(alg)->hash_tlen);\n\n\treturn crypto_hash_errstat(alg, tfm->update(req));\n}\n\n \n\n \nstatic inline void ahash_request_set_tfm(struct ahash_request *req,\n\t\t\t\t\t struct crypto_ahash *tfm)\n{\n\treq->base.tfm = crypto_ahash_tfm(tfm);\n}\n\n \nstatic inline struct ahash_request *ahash_request_alloc(\n\tstruct crypto_ahash *tfm, gfp_t gfp)\n{\n\tstruct ahash_request *req;\n\n\treq = kmalloc(sizeof(struct ahash_request) +\n\t\t      crypto_ahash_reqsize(tfm), gfp);\n\n\tif (likely(req))\n\t\tahash_request_set_tfm(req, tfm);\n\n\treturn req;\n}\n\n \nstatic inline void ahash_request_free(struct ahash_request *req)\n{\n\tkfree_sensitive(req);\n}\n\nstatic inline void ahash_request_zero(struct ahash_request *req)\n{\n\tmemzero_explicit(req, sizeof(*req) +\n\t\t\t      crypto_ahash_reqsize(crypto_ahash_reqtfm(req)));\n}\n\nstatic inline struct ahash_request *ahash_request_cast(\n\tstruct crypto_async_request *req)\n{\n\treturn container_of(req, struct ahash_request, base);\n}\n\n \nstatic inline void ahash_request_set_callback(struct ahash_request *req,\n\t\t\t\t\t      u32 flags,\n\t\t\t\t\t      crypto_completion_t compl,\n\t\t\t\t\t      void *data)\n{\n\treq->base.complete = compl;\n\treq->base.data = data;\n\treq->base.flags = flags;\n}\n\n \nstatic inline void ahash_request_set_crypt(struct ahash_request *req,\n\t\t\t\t\t   struct scatterlist *src, u8 *result,\n\t\t\t\t\t   unsigned int nbytes)\n{\n\treq->src = src;\n\treq->nbytes = nbytes;\n\treq->result = result;\n}\n\n \n\n \nstruct crypto_shash *crypto_alloc_shash(const char *alg_name, u32 type,\n\t\t\t\t\tu32 mask);\n\nstruct crypto_shash *crypto_clone_shash(struct crypto_shash *tfm);\n\nint crypto_has_shash(const char *alg_name, u32 type, u32 mask);\n\nstatic inline struct crypto_tfm *crypto_shash_tfm(struct crypto_shash *tfm)\n{\n\treturn &tfm->base;\n}\n\n \nstatic inline void crypto_free_shash(struct crypto_shash *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_shash_tfm(tfm));\n}\n\nstatic inline const char *crypto_shash_alg_name(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_alg_name(crypto_shash_tfm(tfm));\n}\n\nstatic inline const char *crypto_shash_driver_name(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_alg_driver_name(crypto_shash_tfm(tfm));\n}\n\nstatic inline unsigned int crypto_shash_alignmask(\n\tstruct crypto_shash *tfm)\n{\n\treturn crypto_tfm_alg_alignmask(crypto_shash_tfm(tfm));\n}\n\n \nstatic inline unsigned int crypto_shash_blocksize(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_alg_blocksize(crypto_shash_tfm(tfm));\n}\n\nstatic inline struct shash_alg *__crypto_shash_alg(struct crypto_alg *alg)\n{\n\treturn container_of(alg, struct shash_alg, base);\n}\n\nstatic inline struct shash_alg *crypto_shash_alg(struct crypto_shash *tfm)\n{\n\treturn __crypto_shash_alg(crypto_shash_tfm(tfm)->__crt_alg);\n}\n\n \nstatic inline unsigned int crypto_shash_digestsize(struct crypto_shash *tfm)\n{\n\treturn crypto_shash_alg(tfm)->digestsize;\n}\n\nstatic inline unsigned int crypto_shash_statesize(struct crypto_shash *tfm)\n{\n\treturn crypto_shash_alg(tfm)->statesize;\n}\n\nstatic inline u32 crypto_shash_get_flags(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_get_flags(crypto_shash_tfm(tfm));\n}\n\nstatic inline void crypto_shash_set_flags(struct crypto_shash *tfm, u32 flags)\n{\n\tcrypto_tfm_set_flags(crypto_shash_tfm(tfm), flags);\n}\n\nstatic inline void crypto_shash_clear_flags(struct crypto_shash *tfm, u32 flags)\n{\n\tcrypto_tfm_clear_flags(crypto_shash_tfm(tfm), flags);\n}\n\n \nstatic inline unsigned int crypto_shash_descsize(struct crypto_shash *tfm)\n{\n\treturn tfm->descsize;\n}\n\nstatic inline void *shash_desc_ctx(struct shash_desc *desc)\n{\n\treturn desc->__ctx;\n}\n\n \nint crypto_shash_setkey(struct crypto_shash *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\n\n \nint crypto_shash_digest(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *out);\n\n \nint crypto_shash_tfm_digest(struct crypto_shash *tfm, const u8 *data,\n\t\t\t    unsigned int len, u8 *out);\n\n \nstatic inline int crypto_shash_export(struct shash_desc *desc, void *out)\n{\n\treturn crypto_shash_alg(desc->tfm)->export(desc, out);\n}\n\n \nstatic inline int crypto_shash_import(struct shash_desc *desc, const void *in)\n{\n\tstruct crypto_shash *tfm = desc->tfm;\n\n\tif (crypto_shash_get_flags(tfm) & CRYPTO_TFM_NEED_KEY)\n\t\treturn -ENOKEY;\n\n\treturn crypto_shash_alg(tfm)->import(desc, in);\n}\n\n \nstatic inline int crypto_shash_init(struct shash_desc *desc)\n{\n\tstruct crypto_shash *tfm = desc->tfm;\n\n\tif (crypto_shash_get_flags(tfm) & CRYPTO_TFM_NEED_KEY)\n\t\treturn -ENOKEY;\n\n\treturn crypto_shash_alg(tfm)->init(desc);\n}\n\n \nint crypto_shash_update(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len);\n\n \nint crypto_shash_final(struct shash_desc *desc, u8 *out);\n\n \nint crypto_shash_finup(struct shash_desc *desc, const u8 *data,\n\t\t       unsigned int len, u8 *out);\n\nstatic inline void shash_desc_zero(struct shash_desc *desc)\n{\n\tmemzero_explicit(desc,\n\t\t\t sizeof(*desc) + crypto_shash_descsize(desc->tfm));\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}