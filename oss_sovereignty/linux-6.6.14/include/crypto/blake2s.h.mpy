{
  "module_name": "blake2s.h",
  "hash_id": "389d1791d16cecebfbe2371a59604d55143952c2a679405cf0d98b49ab2f5c3c",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/blake2s.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_BLAKE2S_H\n#define _CRYPTO_BLAKE2S_H\n\n#include <linux/bug.h>\n#include <linux/kconfig.h>\n#include <linux/types.h>\n#include <linux/string.h>\n\nenum blake2s_lengths {\n\tBLAKE2S_BLOCK_SIZE = 64,\n\tBLAKE2S_HASH_SIZE = 32,\n\tBLAKE2S_KEY_SIZE = 32,\n\n\tBLAKE2S_128_HASH_SIZE = 16,\n\tBLAKE2S_160_HASH_SIZE = 20,\n\tBLAKE2S_224_HASH_SIZE = 28,\n\tBLAKE2S_256_HASH_SIZE = 32,\n};\n\nstruct blake2s_state {\n\t \n\tu32 h[8];\n\tu32 t[2];\n\tu32 f[2];\n\tu8 buf[BLAKE2S_BLOCK_SIZE];\n\tunsigned int buflen;\n\tunsigned int outlen;\n};\n\nenum blake2s_iv {\n\tBLAKE2S_IV0 = 0x6A09E667UL,\n\tBLAKE2S_IV1 = 0xBB67AE85UL,\n\tBLAKE2S_IV2 = 0x3C6EF372UL,\n\tBLAKE2S_IV3 = 0xA54FF53AUL,\n\tBLAKE2S_IV4 = 0x510E527FUL,\n\tBLAKE2S_IV5 = 0x9B05688CUL,\n\tBLAKE2S_IV6 = 0x1F83D9ABUL,\n\tBLAKE2S_IV7 = 0x5BE0CD19UL,\n};\n\nstatic inline void __blake2s_init(struct blake2s_state *state, size_t outlen,\n\t\t\t\t  const void *key, size_t keylen)\n{\n\tstate->h[0] = BLAKE2S_IV0 ^ (0x01010000 | keylen << 8 | outlen);\n\tstate->h[1] = BLAKE2S_IV1;\n\tstate->h[2] = BLAKE2S_IV2;\n\tstate->h[3] = BLAKE2S_IV3;\n\tstate->h[4] = BLAKE2S_IV4;\n\tstate->h[5] = BLAKE2S_IV5;\n\tstate->h[6] = BLAKE2S_IV6;\n\tstate->h[7] = BLAKE2S_IV7;\n\tstate->t[0] = 0;\n\tstate->t[1] = 0;\n\tstate->f[0] = 0;\n\tstate->f[1] = 0;\n\tstate->buflen = 0;\n\tstate->outlen = outlen;\n\tif (keylen) {\n\t\tmemcpy(state->buf, key, keylen);\n\t\tmemset(&state->buf[keylen], 0, BLAKE2S_BLOCK_SIZE - keylen);\n\t\tstate->buflen = BLAKE2S_BLOCK_SIZE;\n\t}\n}\n\nstatic inline void blake2s_init(struct blake2s_state *state,\n\t\t\t\tconst size_t outlen)\n{\n\t__blake2s_init(state, outlen, NULL, 0);\n}\n\nstatic inline void blake2s_init_key(struct blake2s_state *state,\n\t\t\t\t    const size_t outlen, const void *key,\n\t\t\t\t    const size_t keylen)\n{\n\tWARN_ON(IS_ENABLED(DEBUG) && (!outlen || outlen > BLAKE2S_HASH_SIZE ||\n\t\t!key || !keylen || keylen > BLAKE2S_KEY_SIZE));\n\n\t__blake2s_init(state, outlen, key, keylen);\n}\n\nvoid blake2s_update(struct blake2s_state *state, const u8 *in, size_t inlen);\nvoid blake2s_final(struct blake2s_state *state, u8 *out);\n\nstatic inline void blake2s(u8 *out, const u8 *in, const u8 *key,\n\t\t\t   const size_t outlen, const size_t inlen,\n\t\t\t   const size_t keylen)\n{\n\tstruct blake2s_state state;\n\n\tWARN_ON(IS_ENABLED(DEBUG) && ((!in && inlen > 0) || !out || !outlen ||\n\t\toutlen > BLAKE2S_HASH_SIZE || keylen > BLAKE2S_KEY_SIZE ||\n\t\t(!key && keylen)));\n\n\t__blake2s_init(&state, outlen, key, keylen);\n\tblake2s_update(&state, in, inlen);\n\tblake2s_final(&state, out);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}