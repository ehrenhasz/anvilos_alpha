{
  "module_name": "akcipher.h",
  "hash_id": "2969145d492c3706aeef9b515031bebd1b08122e6bf5de2d98dc16f26bb7dfad",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/akcipher.h",
  "human_readable_source": " \n \n#ifndef _CRYPTO_AKCIPHER_H\n#define _CRYPTO_AKCIPHER_H\n\n#include <linux/atomic.h>\n#include <linux/crypto.h>\n\n \nstruct akcipher_request {\n\tstruct crypto_async_request base;\n\tstruct scatterlist *src;\n\tstruct scatterlist *dst;\n\tunsigned int src_len;\n\tunsigned int dst_len;\n\tvoid *__ctx[] CRYPTO_MINALIGN_ATTR;\n};\n\n \nstruct crypto_akcipher {\n\tunsigned int reqsize;\n\n\tstruct crypto_tfm base;\n};\n\n \nstruct crypto_istat_akcipher {\n\tatomic64_t encrypt_cnt;\n\tatomic64_t encrypt_tlen;\n\tatomic64_t decrypt_cnt;\n\tatomic64_t decrypt_tlen;\n\tatomic64_t verify_cnt;\n\tatomic64_t sign_cnt;\n\tatomic64_t err_cnt;\n};\n\n \nstruct akcipher_alg {\n\tint (*sign)(struct akcipher_request *req);\n\tint (*verify)(struct akcipher_request *req);\n\tint (*encrypt)(struct akcipher_request *req);\n\tint (*decrypt)(struct akcipher_request *req);\n\tint (*set_pub_key)(struct crypto_akcipher *tfm, const void *key,\n\t\t\t   unsigned int keylen);\n\tint (*set_priv_key)(struct crypto_akcipher *tfm, const void *key,\n\t\t\t    unsigned int keylen);\n\tunsigned int (*max_size)(struct crypto_akcipher *tfm);\n\tint (*init)(struct crypto_akcipher *tfm);\n\tvoid (*exit)(struct crypto_akcipher *tfm);\n\n#ifdef CONFIG_CRYPTO_STATS\n\tstruct crypto_istat_akcipher stat;\n#endif\n\n\tstruct crypto_alg base;\n};\n\n \n\n \nstruct crypto_akcipher *crypto_alloc_akcipher(const char *alg_name, u32 type,\n\t\t\t\t\t      u32 mask);\n\nstatic inline struct crypto_tfm *crypto_akcipher_tfm(\n\tstruct crypto_akcipher *tfm)\n{\n\treturn &tfm->base;\n}\n\nstatic inline struct akcipher_alg *__crypto_akcipher_alg(struct crypto_alg *alg)\n{\n\treturn container_of(alg, struct akcipher_alg, base);\n}\n\nstatic inline struct crypto_akcipher *__crypto_akcipher_tfm(\n\tstruct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_akcipher, base);\n}\n\nstatic inline struct akcipher_alg *crypto_akcipher_alg(\n\tstruct crypto_akcipher *tfm)\n{\n\treturn __crypto_akcipher_alg(crypto_akcipher_tfm(tfm)->__crt_alg);\n}\n\nstatic inline unsigned int crypto_akcipher_reqsize(struct crypto_akcipher *tfm)\n{\n\treturn tfm->reqsize;\n}\n\nstatic inline void akcipher_request_set_tfm(struct akcipher_request *req,\n\t\t\t\t\t    struct crypto_akcipher *tfm)\n{\n\treq->base.tfm = crypto_akcipher_tfm(tfm);\n}\n\nstatic inline struct crypto_akcipher *crypto_akcipher_reqtfm(\n\tstruct akcipher_request *req)\n{\n\treturn __crypto_akcipher_tfm(req->base.tfm);\n}\n\n \nstatic inline void crypto_free_akcipher(struct crypto_akcipher *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_akcipher_tfm(tfm));\n}\n\n \nstatic inline struct akcipher_request *akcipher_request_alloc(\n\tstruct crypto_akcipher *tfm, gfp_t gfp)\n{\n\tstruct akcipher_request *req;\n\n\treq = kmalloc(sizeof(*req) + crypto_akcipher_reqsize(tfm), gfp);\n\tif (likely(req))\n\t\takcipher_request_set_tfm(req, tfm);\n\n\treturn req;\n}\n\n \nstatic inline void akcipher_request_free(struct akcipher_request *req)\n{\n\tkfree_sensitive(req);\n}\n\n \nstatic inline void akcipher_request_set_callback(struct akcipher_request *req,\n\t\t\t\t\t\t u32 flgs,\n\t\t\t\t\t\t crypto_completion_t cmpl,\n\t\t\t\t\t\t void *data)\n{\n\treq->base.complete = cmpl;\n\treq->base.data = data;\n\treq->base.flags = flgs;\n}\n\n \nstatic inline void akcipher_request_set_crypt(struct akcipher_request *req,\n\t\t\t\t\t      struct scatterlist *src,\n\t\t\t\t\t      struct scatterlist *dst,\n\t\t\t\t\t      unsigned int src_len,\n\t\t\t\t\t      unsigned int dst_len)\n{\n\treq->src = src;\n\treq->dst = dst;\n\treq->src_len = src_len;\n\treq->dst_len = dst_len;\n}\n\n \nstatic inline unsigned int crypto_akcipher_maxsize(struct crypto_akcipher *tfm)\n{\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\treturn alg->max_size(tfm);\n}\n\nstatic inline struct crypto_istat_akcipher *akcipher_get_stat(\n\tstruct akcipher_alg *alg)\n{\n#ifdef CONFIG_CRYPTO_STATS\n\treturn &alg->stat;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline int crypto_akcipher_errstat(struct akcipher_alg *alg, int err)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\treturn err;\n\n\tif (err && err != -EINPROGRESS && err != -EBUSY)\n\t\tatomic64_inc(&akcipher_get_stat(alg)->err_cnt);\n\n\treturn err;\n}\n\n \nstatic inline int crypto_akcipher_encrypt(struct akcipher_request *req)\n{\n\tstruct crypto_akcipher *tfm = crypto_akcipher_reqtfm(req);\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS)) {\n\t\tstruct crypto_istat_akcipher *istat = akcipher_get_stat(alg);\n\n\t\tatomic64_inc(&istat->encrypt_cnt);\n\t\tatomic64_add(req->src_len, &istat->encrypt_tlen);\n\t}\n\n\treturn crypto_akcipher_errstat(alg, alg->encrypt(req));\n}\n\n \nstatic inline int crypto_akcipher_decrypt(struct akcipher_request *req)\n{\n\tstruct crypto_akcipher *tfm = crypto_akcipher_reqtfm(req);\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS)) {\n\t\tstruct crypto_istat_akcipher *istat = akcipher_get_stat(alg);\n\n\t\tatomic64_inc(&istat->decrypt_cnt);\n\t\tatomic64_add(req->src_len, &istat->decrypt_tlen);\n\t}\n\n\treturn crypto_akcipher_errstat(alg, alg->decrypt(req));\n}\n\n \nint crypto_akcipher_sync_encrypt(struct crypto_akcipher *tfm,\n\t\t\t\t const void *src, unsigned int slen,\n\t\t\t\t void *dst, unsigned int dlen);\n\n \nint crypto_akcipher_sync_decrypt(struct crypto_akcipher *tfm,\n\t\t\t\t const void *src, unsigned int slen,\n\t\t\t\t void *dst, unsigned int dlen);\n\n \nstatic inline int crypto_akcipher_sign(struct akcipher_request *req)\n{\n\tstruct crypto_akcipher *tfm = crypto_akcipher_reqtfm(req);\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_inc(&akcipher_get_stat(alg)->sign_cnt);\n\n\treturn crypto_akcipher_errstat(alg, alg->sign(req));\n}\n\n \nstatic inline int crypto_akcipher_verify(struct akcipher_request *req)\n{\n\tstruct crypto_akcipher *tfm = crypto_akcipher_reqtfm(req);\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\tatomic64_inc(&akcipher_get_stat(alg)->verify_cnt);\n\n\treturn crypto_akcipher_errstat(alg, alg->verify(req));\n}\n\n \nstatic inline int crypto_akcipher_set_pub_key(struct crypto_akcipher *tfm,\n\t\t\t\t\t      const void *key,\n\t\t\t\t\t      unsigned int keylen)\n{\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\treturn alg->set_pub_key(tfm, key, keylen);\n}\n\n \nstatic inline int crypto_akcipher_set_priv_key(struct crypto_akcipher *tfm,\n\t\t\t\t\t       const void *key,\n\t\t\t\t\t       unsigned int keylen)\n{\n\tstruct akcipher_alg *alg = crypto_akcipher_alg(tfm);\n\n\treturn alg->set_priv_key(tfm, key, keylen);\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}