{
  "module_name": "nhpoly1305.h",
  "hash_id": "36677e05f6aedbe4421bff35167279ee00c06e00b642729980e745bb4782ecc0",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/nhpoly1305.h",
  "human_readable_source": " \n \n\n#ifndef _NHPOLY1305_H\n#define _NHPOLY1305_H\n\n#include <crypto/hash.h>\n#include <crypto/internal/poly1305.h>\n\n \n\n \n \n\n \n#define NH_PAIR_STRIDE\t\t2\n#define NH_MESSAGE_UNIT\t\t(NH_PAIR_STRIDE * 2 * sizeof(u32))\n\n \n#define NH_NUM_PASSES\t\t4\n#define NH_HASH_BYTES\t\t(NH_NUM_PASSES * sizeof(u64))\n\n \n#define NH_NUM_STRIDES\t\t64\n#define NH_MESSAGE_WORDS\t(NH_PAIR_STRIDE * 2 * NH_NUM_STRIDES)\n#define NH_MESSAGE_BYTES\t(NH_MESSAGE_WORDS * sizeof(u32))\n#define NH_KEY_WORDS\t\t(NH_MESSAGE_WORDS + \\\n\t\t\t\t NH_PAIR_STRIDE * 2 * (NH_NUM_PASSES - 1))\n#define NH_KEY_BYTES\t\t(NH_KEY_WORDS * sizeof(u32))\n\n#define NHPOLY1305_KEY_SIZE\t(POLY1305_BLOCK_SIZE + NH_KEY_BYTES)\n\nstruct nhpoly1305_key {\n\tstruct poly1305_core_key poly_key;\n\tu32 nh_key[NH_KEY_WORDS];\n};\n\nstruct nhpoly1305_state {\n\n\t \n\tstruct poly1305_state poly_state;\n\n\t \n\tu8 buffer[NH_MESSAGE_UNIT];\n\tunsigned int buflen;\n\n\t \n\tunsigned int nh_remaining;\n\n\t__le64 nh_hash[NH_NUM_PASSES];\n};\n\ntypedef void (*nh_t)(const u32 *key, const u8 *message, size_t message_len,\n\t\t     __le64 hash[NH_NUM_PASSES]);\n\nint crypto_nhpoly1305_setkey(struct crypto_shash *tfm,\n\t\t\t     const u8 *key, unsigned int keylen);\n\nint crypto_nhpoly1305_init(struct shash_desc *desc);\nint crypto_nhpoly1305_update(struct shash_desc *desc,\n\t\t\t     const u8 *src, unsigned int srclen);\nint crypto_nhpoly1305_update_helper(struct shash_desc *desc,\n\t\t\t\t    const u8 *src, unsigned int srclen,\n\t\t\t\t    nh_t nh_fn);\nint crypto_nhpoly1305_final(struct shash_desc *desc, u8 *dst);\nint crypto_nhpoly1305_final_helper(struct shash_desc *desc, u8 *dst,\n\t\t\t\t   nh_t nh_fn);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}