{
  "module_name": "curve25519.h",
  "hash_id": "d43f7f894ad4b37464ed700e196aa87665b4fe7974235f8e91cb25d2da1e4eeb",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/curve25519.h",
  "human_readable_source": " \n \n\n#ifndef CURVE25519_H\n#define CURVE25519_H\n\n#include <crypto/algapi.h> \n#include <linux/types.h>\n#include <linux/random.h>\n\nenum curve25519_lengths {\n\tCURVE25519_KEY_SIZE = 32\n};\n\nextern const u8 curve25519_null_point[];\nextern const u8 curve25519_base_point[];\n\nvoid curve25519_generic(u8 out[CURVE25519_KEY_SIZE],\n\t\t\tconst u8 scalar[CURVE25519_KEY_SIZE],\n\t\t\tconst u8 point[CURVE25519_KEY_SIZE]);\n\nvoid curve25519_arch(u8 out[CURVE25519_KEY_SIZE],\n\t\t     const u8 scalar[CURVE25519_KEY_SIZE],\n\t\t     const u8 point[CURVE25519_KEY_SIZE]);\n\nvoid curve25519_base_arch(u8 pub[CURVE25519_KEY_SIZE],\n\t\t\t  const u8 secret[CURVE25519_KEY_SIZE]);\n\nbool curve25519_selftest(void);\n\nstatic inline\nbool __must_check curve25519(u8 mypublic[CURVE25519_KEY_SIZE],\n\t\t\t     const u8 secret[CURVE25519_KEY_SIZE],\n\t\t\t     const u8 basepoint[CURVE25519_KEY_SIZE])\n{\n\tif (IS_ENABLED(CONFIG_CRYPTO_ARCH_HAVE_LIB_CURVE25519))\n\t\tcurve25519_arch(mypublic, secret, basepoint);\n\telse\n\t\tcurve25519_generic(mypublic, secret, basepoint);\n\treturn crypto_memneq(mypublic, curve25519_null_point,\n\t\t\t     CURVE25519_KEY_SIZE);\n}\n\nstatic inline bool\n__must_check curve25519_generate_public(u8 pub[CURVE25519_KEY_SIZE],\n\t\t\t\t\tconst u8 secret[CURVE25519_KEY_SIZE])\n{\n\tif (unlikely(!crypto_memneq(secret, curve25519_null_point,\n\t\t\t\t    CURVE25519_KEY_SIZE)))\n\t\treturn false;\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_ARCH_HAVE_LIB_CURVE25519))\n\t\tcurve25519_base_arch(pub, secret);\n\telse\n\t\tcurve25519_generic(pub, secret, curve25519_base_point);\n\treturn crypto_memneq(pub, curve25519_null_point, CURVE25519_KEY_SIZE);\n}\n\nstatic inline void curve25519_clamp_secret(u8 secret[CURVE25519_KEY_SIZE])\n{\n\tsecret[0] &= 248;\n\tsecret[31] = (secret[31] & 127) | 64;\n}\n\nstatic inline void curve25519_generate_secret(u8 secret[CURVE25519_KEY_SIZE])\n{\n\tget_random_bytes_wait(secret, CURVE25519_KEY_SIZE);\n\tcurve25519_clamp_secret(secret);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}