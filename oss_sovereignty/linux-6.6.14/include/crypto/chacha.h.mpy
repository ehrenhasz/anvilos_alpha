{
  "module_name": "chacha.h",
  "hash_id": "829ecea1de49fcb7322cbbe9f30077d8e06ab61360d4804d0686665fdc8908d9",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/chacha.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_CHACHA_H\n#define _CRYPTO_CHACHA_H\n\n#include <asm/unaligned.h>\n#include <linux/types.h>\n\n \n#define CHACHA_IV_SIZE\t\t16\n\n#define CHACHA_KEY_SIZE\t\t32\n#define CHACHA_BLOCK_SIZE\t64\n#define CHACHAPOLY_IV_SIZE\t12\n\n#define CHACHA_STATE_WORDS\t(CHACHA_BLOCK_SIZE / sizeof(u32))\n\n \n#define XCHACHA_IV_SIZE\t\t32\n\nvoid chacha_block_generic(u32 *state, u8 *stream, int nrounds);\nstatic inline void chacha20_block(u32 *state, u8 *stream)\n{\n\tchacha_block_generic(state, stream, 20);\n}\n\nvoid hchacha_block_arch(const u32 *state, u32 *out, int nrounds);\nvoid hchacha_block_generic(const u32 *state, u32 *out, int nrounds);\n\nstatic inline void hchacha_block(const u32 *state, u32 *out, int nrounds)\n{\n\tif (IS_ENABLED(CONFIG_CRYPTO_ARCH_HAVE_LIB_CHACHA))\n\t\thchacha_block_arch(state, out, nrounds);\n\telse\n\t\thchacha_block_generic(state, out, nrounds);\n}\n\nenum chacha_constants {  \n\tCHACHA_CONSTANT_EXPA = 0x61707865U,\n\tCHACHA_CONSTANT_ND_3 = 0x3320646eU,\n\tCHACHA_CONSTANT_2_BY = 0x79622d32U,\n\tCHACHA_CONSTANT_TE_K = 0x6b206574U\n};\n\nstatic inline void chacha_init_consts(u32 *state)\n{\n\tstate[0]  = CHACHA_CONSTANT_EXPA;\n\tstate[1]  = CHACHA_CONSTANT_ND_3;\n\tstate[2]  = CHACHA_CONSTANT_2_BY;\n\tstate[3]  = CHACHA_CONSTANT_TE_K;\n}\n\nvoid chacha_init_arch(u32 *state, const u32 *key, const u8 *iv);\nstatic inline void chacha_init_generic(u32 *state, const u32 *key, const u8 *iv)\n{\n\tchacha_init_consts(state);\n\tstate[4]  = key[0];\n\tstate[5]  = key[1];\n\tstate[6]  = key[2];\n\tstate[7]  = key[3];\n\tstate[8]  = key[4];\n\tstate[9]  = key[5];\n\tstate[10] = key[6];\n\tstate[11] = key[7];\n\tstate[12] = get_unaligned_le32(iv +  0);\n\tstate[13] = get_unaligned_le32(iv +  4);\n\tstate[14] = get_unaligned_le32(iv +  8);\n\tstate[15] = get_unaligned_le32(iv + 12);\n}\n\nstatic inline void chacha_init(u32 *state, const u32 *key, const u8 *iv)\n{\n\tif (IS_ENABLED(CONFIG_CRYPTO_ARCH_HAVE_LIB_CHACHA))\n\t\tchacha_init_arch(state, key, iv);\n\telse\n\t\tchacha_init_generic(state, key, iv);\n}\n\nvoid chacha_crypt_arch(u32 *state, u8 *dst, const u8 *src,\n\t\t       unsigned int bytes, int nrounds);\nvoid chacha_crypt_generic(u32 *state, u8 *dst, const u8 *src,\n\t\t\t  unsigned int bytes, int nrounds);\n\nstatic inline void chacha_crypt(u32 *state, u8 *dst, const u8 *src,\n\t\t\t\tunsigned int bytes, int nrounds)\n{\n\tif (IS_ENABLED(CONFIG_CRYPTO_ARCH_HAVE_LIB_CHACHA))\n\t\tchacha_crypt_arch(state, dst, src, bytes, nrounds);\n\telse\n\t\tchacha_crypt_generic(state, dst, src, bytes, nrounds);\n}\n\nstatic inline void chacha20_crypt(u32 *state, u8 *dst, const u8 *src,\n\t\t\t\t  unsigned int bytes)\n{\n\tchacha_crypt(state, dst, src, bytes, 20);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}