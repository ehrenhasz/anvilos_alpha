{
  "module_name": "drbg.h",
  "hash_id": "2ebfd2bbdd0ab5bc1d66490cdfc3b058c557fb2bc16114702c262a7c7a8c900b",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/drbg.h",
  "human_readable_source": " \n\n#ifndef _DRBG_H\n#define _DRBG_H\n\n\n#include <linux/random.h>\n#include <linux/scatterlist.h>\n#include <crypto/hash.h>\n#include <crypto/skcipher.h>\n#include <linux/module.h>\n#include <linux/crypto.h>\n#include <linux/slab.h>\n#include <crypto/internal/rng.h>\n#include <crypto/rng.h>\n#include <linux/fips.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n\n \nstruct drbg_string {\n\tconst unsigned char *buf;\n\tsize_t len;\n\tstruct list_head list;\n};\n\nstatic inline void drbg_string_fill(struct drbg_string *string,\n\t\t\t\t    const unsigned char *buf, size_t len)\n{\n\tstring->buf = buf;\n\tstring->len = len;\n\tINIT_LIST_HEAD(&string->list);\n}\n\nstruct drbg_state;\ntypedef uint32_t drbg_flag_t;\n\nstruct drbg_core {\n\tdrbg_flag_t flags;\t \n\t__u8 statelen;\t\t \n\t__u8 blocklen_bytes;\t \n\tchar cra_name[CRYPTO_MAX_ALG_NAME];  \n\t  \n\tchar backend_cra_name[CRYPTO_MAX_ALG_NAME];\n};\n\nstruct drbg_state_ops {\n\tint (*update)(struct drbg_state *drbg, struct list_head *seed,\n\t\t      int reseed);\n\tint (*generate)(struct drbg_state *drbg,\n\t\t\tunsigned char *buf, unsigned int buflen,\n\t\t\tstruct list_head *addtl);\n\tint (*crypto_init)(struct drbg_state *drbg);\n\tint (*crypto_fini)(struct drbg_state *drbg);\n\n};\n\nstruct drbg_test_data {\n\tstruct drbg_string *testentropy;  \n};\n\nenum drbg_seed_state {\n\tDRBG_SEED_STATE_UNSEEDED,\n\tDRBG_SEED_STATE_PARTIAL,  \n\tDRBG_SEED_STATE_FULL,\n};\n\nstruct drbg_state {\n\tstruct mutex drbg_mutex;\t \n\tunsigned char *V;\t \n\tunsigned char *Vbuf;\n\t \n\tunsigned char *C;\n\tunsigned char *Cbuf;\n\t \n\tsize_t reseed_ctr;\n\tsize_t reseed_threshold;\n\t  \n\tunsigned char *scratchpad;\n\tunsigned char *scratchpadbuf;\n\tvoid *priv_data;\t \n\n\tstruct crypto_skcipher *ctr_handle;\t \n\tstruct skcipher_request *ctr_req;\t \n\t__u8 *outscratchpadbuf;\t\t\t \n        __u8 *outscratchpad;\t\t\t \n\tstruct crypto_wait ctr_wait;\t\t \n\tstruct scatterlist sg_in, sg_out;\t \n\n\tenum drbg_seed_state seeded;\t\t \n\tunsigned long last_seed_time;\n\tbool pr;\t\t \n\tbool fips_primed;\t \n\tunsigned char *prev;\t \n\tstruct crypto_rng *jent;\n\tconst struct drbg_state_ops *d_ops;\n\tconst struct drbg_core *core;\n\tstruct drbg_string test_data;\n};\n\nstatic inline __u8 drbg_statelen(struct drbg_state *drbg)\n{\n\tif (drbg && drbg->core)\n\t\treturn drbg->core->statelen;\n\treturn 0;\n}\n\nstatic inline __u8 drbg_blocklen(struct drbg_state *drbg)\n{\n\tif (drbg && drbg->core)\n\t\treturn drbg->core->blocklen_bytes;\n\treturn 0;\n}\n\nstatic inline __u8 drbg_keylen(struct drbg_state *drbg)\n{\n\tif (drbg && drbg->core)\n\t\treturn (drbg->core->statelen - drbg->core->blocklen_bytes);\n\treturn 0;\n}\n\nstatic inline size_t drbg_max_request_bytes(struct drbg_state *drbg)\n{\n\t \n\treturn (1 << 16);\n}\n\nstatic inline size_t drbg_max_addtl(struct drbg_state *drbg)\n{\n\t \n#if (__BITS_PER_LONG == 32)\n\t \n\treturn (SIZE_MAX - 1);\n#else\n\treturn (1UL<<35);\n#endif\n}\n\nstatic inline size_t drbg_max_requests(struct drbg_state *drbg)\n{\n\t \n\treturn (1<<20);\n}\n\n \nstatic inline int crypto_drbg_get_bytes_addtl(struct crypto_rng *drng,\n\t\t\tunsigned char *outbuf, unsigned int outlen,\n\t\t\tstruct drbg_string *addtl)\n{\n\treturn crypto_rng_generate(drng, addtl->buf, addtl->len,\n\t\t\t\t   outbuf, outlen);\n}\n\n \nstatic inline int crypto_drbg_get_bytes_addtl_test(struct crypto_rng *drng,\n\t\t\tunsigned char *outbuf, unsigned int outlen,\n\t\t\tstruct drbg_string *addtl,\n\t\t\tstruct drbg_test_data *test_data)\n{\n\tcrypto_rng_set_entropy(drng, test_data->testentropy->buf,\n\t\t\t       test_data->testentropy->len);\n\treturn crypto_rng_generate(drng, addtl->buf, addtl->len,\n\t\t\t\t   outbuf, outlen);\n}\n\n \nstatic inline int crypto_drbg_reset_test(struct crypto_rng *drng,\n\t\t\t\t\t struct drbg_string *pers,\n\t\t\t\t\t struct drbg_test_data *test_data)\n{\n\tcrypto_rng_set_entropy(drng, test_data->testentropy->buf,\n\t\t\t       test_data->testentropy->len);\n\treturn crypto_rng_reset(drng, pers->buf, pers->len);\n}\n\n \n#define DRBG_CTR\t((drbg_flag_t)1<<0)\n#define DRBG_HMAC\t((drbg_flag_t)1<<1)\n#define DRBG_HASH\t((drbg_flag_t)1<<2)\n#define DRBG_TYPE_MASK\t(DRBG_CTR | DRBG_HMAC | DRBG_HASH)\n \n#define DRBG_STRENGTH128\t((drbg_flag_t)1<<3)\n#define DRBG_STRENGTH192\t((drbg_flag_t)1<<4)\n#define DRBG_STRENGTH256\t((drbg_flag_t)1<<5)\n#define DRBG_STRENGTH_MASK\t(DRBG_STRENGTH128 | DRBG_STRENGTH192 | \\\n\t\t\t\t DRBG_STRENGTH256)\n\nenum drbg_prefixes {\n\tDRBG_PREFIX0 = 0x00,\n\tDRBG_PREFIX1,\n\tDRBG_PREFIX2,\n\tDRBG_PREFIX3\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}