{
  "module_name": "acompress.h",
  "hash_id": "00d0acc27324a063ba33f57c6304688b614a5d9a5d78be3bd7ab782a2ec3adf7",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/acompress.h",
  "human_readable_source": " \n \n#ifndef _CRYPTO_ACOMP_H\n#define _CRYPTO_ACOMP_H\n\n#include <linux/atomic.h>\n#include <linux/container_of.h>\n#include <linux/crypto.h>\n\n#define CRYPTO_ACOMP_ALLOC_OUTPUT\t0x00000001\n#define CRYPTO_ACOMP_DST_MAX\t\t131072\n\n \nstruct acomp_req {\n\tstruct crypto_async_request base;\n\tstruct scatterlist *src;\n\tstruct scatterlist *dst;\n\tunsigned int slen;\n\tunsigned int dlen;\n\tu32 flags;\n\tvoid *__ctx[] CRYPTO_MINALIGN_ATTR;\n};\n\n \nstruct crypto_acomp {\n\tint (*compress)(struct acomp_req *req);\n\tint (*decompress)(struct acomp_req *req);\n\tvoid (*dst_free)(struct scatterlist *dst);\n\tunsigned int reqsize;\n\tstruct crypto_tfm base;\n};\n\n \nstruct crypto_istat_compress {\n\tatomic64_t compress_cnt;\n\tatomic64_t compress_tlen;\n\tatomic64_t decompress_cnt;\n\tatomic64_t decompress_tlen;\n\tatomic64_t err_cnt;\n};\n\n#ifdef CONFIG_CRYPTO_STATS\n#define COMP_ALG_COMMON_STATS struct crypto_istat_compress stat;\n#else\n#define COMP_ALG_COMMON_STATS\n#endif\n\n#define COMP_ALG_COMMON {\t\t\t\\\n\tCOMP_ALG_COMMON_STATS\t\t\t\\\n\t\t\t\t\t\t\\\n\tstruct crypto_alg base;\t\t\t\\\n}\nstruct comp_alg_common COMP_ALG_COMMON;\n\n \n\n \nstruct crypto_acomp *crypto_alloc_acomp(const char *alg_name, u32 type,\n\t\t\t\t\tu32 mask);\n \nstruct crypto_acomp *crypto_alloc_acomp_node(const char *alg_name, u32 type,\n\t\t\t\t\tu32 mask, int node);\n\nstatic inline struct crypto_tfm *crypto_acomp_tfm(struct crypto_acomp *tfm)\n{\n\treturn &tfm->base;\n}\n\nstatic inline struct comp_alg_common *__crypto_comp_alg_common(\n\tstruct crypto_alg *alg)\n{\n\treturn container_of(alg, struct comp_alg_common, base);\n}\n\nstatic inline struct crypto_acomp *__crypto_acomp_tfm(struct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_acomp, base);\n}\n\nstatic inline struct comp_alg_common *crypto_comp_alg_common(\n\tstruct crypto_acomp *tfm)\n{\n\treturn __crypto_comp_alg_common(crypto_acomp_tfm(tfm)->__crt_alg);\n}\n\nstatic inline unsigned int crypto_acomp_reqsize(struct crypto_acomp *tfm)\n{\n\treturn tfm->reqsize;\n}\n\nstatic inline void acomp_request_set_tfm(struct acomp_req *req,\n\t\t\t\t\t struct crypto_acomp *tfm)\n{\n\treq->base.tfm = crypto_acomp_tfm(tfm);\n}\n\nstatic inline struct crypto_acomp *crypto_acomp_reqtfm(struct acomp_req *req)\n{\n\treturn __crypto_acomp_tfm(req->base.tfm);\n}\n\n \nstatic inline void crypto_free_acomp(struct crypto_acomp *tfm)\n{\n\tcrypto_destroy_tfm(tfm, crypto_acomp_tfm(tfm));\n}\n\nstatic inline int crypto_has_acomp(const char *alg_name, u32 type, u32 mask)\n{\n\ttype &= ~CRYPTO_ALG_TYPE_MASK;\n\ttype |= CRYPTO_ALG_TYPE_ACOMPRESS;\n\tmask |= CRYPTO_ALG_TYPE_ACOMPRESS_MASK;\n\n\treturn crypto_has_alg(alg_name, type, mask);\n}\n\n \nstruct acomp_req *acomp_request_alloc(struct crypto_acomp *tfm);\n\n \nvoid acomp_request_free(struct acomp_req *req);\n\n \nstatic inline void acomp_request_set_callback(struct acomp_req *req,\n\t\t\t\t\t      u32 flgs,\n\t\t\t\t\t      crypto_completion_t cmpl,\n\t\t\t\t\t      void *data)\n{\n\treq->base.complete = cmpl;\n\treq->base.data = data;\n\treq->base.flags &= CRYPTO_ACOMP_ALLOC_OUTPUT;\n\treq->base.flags |= flgs & ~CRYPTO_ACOMP_ALLOC_OUTPUT;\n}\n\n \nstatic inline void acomp_request_set_params(struct acomp_req *req,\n\t\t\t\t\t    struct scatterlist *src,\n\t\t\t\t\t    struct scatterlist *dst,\n\t\t\t\t\t    unsigned int slen,\n\t\t\t\t\t    unsigned int dlen)\n{\n\treq->src = src;\n\treq->dst = dst;\n\treq->slen = slen;\n\treq->dlen = dlen;\n\n\treq->flags &= ~CRYPTO_ACOMP_ALLOC_OUTPUT;\n\tif (!req->dst)\n\t\treq->flags |= CRYPTO_ACOMP_ALLOC_OUTPUT;\n}\n\nstatic inline struct crypto_istat_compress *comp_get_stat(\n\tstruct comp_alg_common *alg)\n{\n#ifdef CONFIG_CRYPTO_STATS\n\treturn &alg->stat;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline int crypto_comp_errstat(struct comp_alg_common *alg, int err)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_STATS))\n\t\treturn err;\n\n\tif (err && err != -EINPROGRESS && err != -EBUSY)\n\t\tatomic64_inc(&comp_get_stat(alg)->err_cnt);\n\n\treturn err;\n}\n\n \nstatic inline int crypto_acomp_compress(struct acomp_req *req)\n{\n\tstruct crypto_acomp *tfm = crypto_acomp_reqtfm(req);\n\tstruct comp_alg_common *alg;\n\n\talg = crypto_comp_alg_common(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS)) {\n\t\tstruct crypto_istat_compress *istat = comp_get_stat(alg);\n\n\t\tatomic64_inc(&istat->compress_cnt);\n\t\tatomic64_add(req->slen, &istat->compress_tlen);\n\t}\n\n\treturn crypto_comp_errstat(alg, tfm->compress(req));\n}\n\n \nstatic inline int crypto_acomp_decompress(struct acomp_req *req)\n{\n\tstruct crypto_acomp *tfm = crypto_acomp_reqtfm(req);\n\tstruct comp_alg_common *alg;\n\n\talg = crypto_comp_alg_common(tfm);\n\n\tif (IS_ENABLED(CONFIG_CRYPTO_STATS)) {\n\t\tstruct crypto_istat_compress *istat = comp_get_stat(alg);\n\n\t\tatomic64_inc(&istat->decompress_cnt);\n\t\tatomic64_add(req->slen, &istat->decompress_tlen);\n\t}\n\n\treturn crypto_comp_errstat(alg, tfm->decompress(req));\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}