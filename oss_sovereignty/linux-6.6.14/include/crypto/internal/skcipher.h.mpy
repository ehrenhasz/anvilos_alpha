{
  "module_name": "skcipher.h",
  "hash_id": "dc477ded2203fed6a4575a64d19c1a278f1080f6af3db3d38e0d2898aa982f07",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/internal/skcipher.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_INTERNAL_SKCIPHER_H\n#define _CRYPTO_INTERNAL_SKCIPHER_H\n\n#include <crypto/algapi.h>\n#include <crypto/internal/cipher.h>\n#include <crypto/skcipher.h>\n#include <linux/list.h>\n#include <linux/types.h>\n\n \n#define CRYPTO_ALG_SKCIPHER_REQSIZE_LARGE CRYPTO_ALG_OPTIONAL_KEY\n\nstruct aead_request;\nstruct rtattr;\n\nstruct skcipher_instance {\n\tvoid (*free)(struct skcipher_instance *inst);\n\tunion {\n\t\tstruct {\n\t\t\tchar head[offsetof(struct skcipher_alg, base)];\n\t\t\tstruct crypto_instance base;\n\t\t} s;\n\t\tstruct skcipher_alg alg;\n\t};\n};\n\nstruct crypto_skcipher_spawn {\n\tstruct crypto_spawn base;\n};\n\nstruct skcipher_walk {\n\tunion {\n\t\tstruct {\n\t\t\tstruct page *page;\n\t\t\tunsigned long offset;\n\t\t} phys;\n\n\t\tstruct {\n\t\t\tu8 *page;\n\t\t\tvoid *addr;\n\t\t} virt;\n\t} src, dst;\n\n\tstruct scatter_walk in;\n\tunsigned int nbytes;\n\n\tstruct scatter_walk out;\n\tunsigned int total;\n\n\tstruct list_head buffers;\n\n\tu8 *page;\n\tu8 *buffer;\n\tu8 *oiv;\n\tvoid *iv;\n\n\tunsigned int ivsize;\n\n\tint flags;\n\tunsigned int blocksize;\n\tunsigned int stride;\n\tunsigned int alignmask;\n};\n\nstatic inline struct crypto_instance *skcipher_crypto_instance(\n\tstruct skcipher_instance *inst)\n{\n\treturn &inst->s.base;\n}\n\nstatic inline struct skcipher_instance *skcipher_alg_instance(\n\tstruct crypto_skcipher *skcipher)\n{\n\treturn container_of(crypto_skcipher_alg(skcipher),\n\t\t\t    struct skcipher_instance, alg);\n}\n\nstatic inline void *skcipher_instance_ctx(struct skcipher_instance *inst)\n{\n\treturn crypto_instance_ctx(skcipher_crypto_instance(inst));\n}\n\nstatic inline void skcipher_request_complete(struct skcipher_request *req, int err)\n{\n\tcrypto_request_complete(&req->base, err);\n}\n\nint crypto_grab_skcipher(struct crypto_skcipher_spawn *spawn,\n\t\t\t struct crypto_instance *inst,\n\t\t\t const char *name, u32 type, u32 mask);\n\nstatic inline void crypto_drop_skcipher(struct crypto_skcipher_spawn *spawn)\n{\n\tcrypto_drop_spawn(&spawn->base);\n}\n\nstatic inline struct skcipher_alg *crypto_skcipher_spawn_alg(\n\tstruct crypto_skcipher_spawn *spawn)\n{\n\treturn container_of(spawn->base.alg, struct skcipher_alg, base);\n}\n\nstatic inline struct skcipher_alg *crypto_spawn_skcipher_alg(\n\tstruct crypto_skcipher_spawn *spawn)\n{\n\treturn crypto_skcipher_spawn_alg(spawn);\n}\n\nstatic inline struct crypto_skcipher *crypto_spawn_skcipher(\n\tstruct crypto_skcipher_spawn *spawn)\n{\n\treturn crypto_spawn_tfm2(&spawn->base);\n}\n\nstatic inline void crypto_skcipher_set_reqsize(\n\tstruct crypto_skcipher *skcipher, unsigned int reqsize)\n{\n\tskcipher->reqsize = reqsize;\n}\n\nstatic inline void crypto_skcipher_set_reqsize_dma(\n\tstruct crypto_skcipher *skcipher, unsigned int reqsize)\n{\n\treqsize += crypto_dma_align() & ~(crypto_tfm_ctx_alignment() - 1);\n\tskcipher->reqsize = reqsize;\n}\n\nint crypto_register_skcipher(struct skcipher_alg *alg);\nvoid crypto_unregister_skcipher(struct skcipher_alg *alg);\nint crypto_register_skciphers(struct skcipher_alg *algs, int count);\nvoid crypto_unregister_skciphers(struct skcipher_alg *algs, int count);\nint skcipher_register_instance(struct crypto_template *tmpl,\n\t\t\t       struct skcipher_instance *inst);\n\nint skcipher_walk_done(struct skcipher_walk *walk, int err);\nint skcipher_walk_virt(struct skcipher_walk *walk,\n\t\t       struct skcipher_request *req,\n\t\t       bool atomic);\nint skcipher_walk_async(struct skcipher_walk *walk,\n\t\t\tstruct skcipher_request *req);\nint skcipher_walk_aead_encrypt(struct skcipher_walk *walk,\n\t\t\t       struct aead_request *req, bool atomic);\nint skcipher_walk_aead_decrypt(struct skcipher_walk *walk,\n\t\t\t       struct aead_request *req, bool atomic);\nvoid skcipher_walk_complete(struct skcipher_walk *walk, int err);\n\nstatic inline void skcipher_walk_abort(struct skcipher_walk *walk)\n{\n\tskcipher_walk_done(walk, -ECANCELED);\n}\n\nstatic inline void *crypto_skcipher_ctx(struct crypto_skcipher *tfm)\n{\n\treturn crypto_tfm_ctx(&tfm->base);\n}\n\nstatic inline void *crypto_skcipher_ctx_dma(struct crypto_skcipher *tfm)\n{\n\treturn crypto_tfm_ctx_dma(&tfm->base);\n}\n\nstatic inline void *skcipher_request_ctx(struct skcipher_request *req)\n{\n\treturn req->__ctx;\n}\n\nstatic inline void *skcipher_request_ctx_dma(struct skcipher_request *req)\n{\n\tunsigned int align = crypto_dma_align();\n\n\tif (align <= crypto_tfm_ctx_alignment())\n\t\talign = 1;\n\n\treturn PTR_ALIGN(skcipher_request_ctx(req), align);\n}\n\nstatic inline u32 skcipher_request_flags(struct skcipher_request *req)\n{\n\treturn req->base.flags;\n}\n\nstatic inline unsigned int crypto_skcipher_alg_min_keysize(\n\tstruct skcipher_alg *alg)\n{\n\treturn alg->min_keysize;\n}\n\nstatic inline unsigned int crypto_skcipher_alg_max_keysize(\n\tstruct skcipher_alg *alg)\n{\n\treturn alg->max_keysize;\n}\n\nstatic inline unsigned int crypto_skcipher_alg_walksize(\n\tstruct skcipher_alg *alg)\n{\n\treturn alg->walksize;\n}\n\n \nstatic inline unsigned int crypto_skcipher_walksize(\n\tstruct crypto_skcipher *tfm)\n{\n\treturn crypto_skcipher_alg_walksize(crypto_skcipher_alg(tfm));\n}\n\n \nstruct skcipher_ctx_simple {\n\tstruct crypto_cipher *cipher;\t \n};\nstatic inline struct crypto_cipher *\nskcipher_cipher_simple(struct crypto_skcipher *tfm)\n{\n\tstruct skcipher_ctx_simple *ctx = crypto_skcipher_ctx(tfm);\n\n\treturn ctx->cipher;\n}\n\nstruct skcipher_instance *skcipher_alloc_instance_simple(\n\tstruct crypto_template *tmpl, struct rtattr **tb);\n\nstatic inline struct crypto_alg *skcipher_ialg_simple(\n\tstruct skcipher_instance *inst)\n{\n\tstruct crypto_cipher_spawn *spawn = skcipher_instance_ctx(inst);\n\n\treturn crypto_spawn_cipher_alg(spawn);\n}\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}