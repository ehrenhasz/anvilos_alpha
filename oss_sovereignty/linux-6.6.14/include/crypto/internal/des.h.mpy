{
  "module_name": "des.h",
  "hash_id": "76c43886f5e3c74c090e69b4a9faf38a7c9a13da44a74b611b483a87c541ea1b",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/internal/des.h",
  "human_readable_source": " \n \n\n#ifndef __CRYPTO_INTERNAL_DES_H\n#define __CRYPTO_INTERNAL_DES_H\n\n#include <linux/crypto.h>\n#include <linux/fips.h>\n#include <crypto/des.h>\n#include <crypto/aead.h>\n#include <crypto/skcipher.h>\n\n \nstatic inline int crypto_des_verify_key(struct crypto_tfm *tfm, const u8 *key)\n{\n\tstruct des_ctx tmp;\n\tint err;\n\n\terr = des_expand_key(&tmp, key, DES_KEY_SIZE);\n\tif (err == -ENOKEY) {\n\t\tif (crypto_tfm_get_flags(tfm) & CRYPTO_TFM_REQ_FORBID_WEAK_KEYS)\n\t\t\terr = -EINVAL;\n\t\telse\n\t\t\terr = 0;\n\t}\n\tmemzero_explicit(&tmp, sizeof(tmp));\n\treturn err;\n}\n\n \nstatic inline int des3_ede_verify_key(const u8 *key, unsigned int key_len,\n\t\t\t\t      bool check_weak)\n{\n\tint ret = fips_enabled ? -EINVAL : -ENOKEY;\n\tu32 K[6];\n\n\tmemcpy(K, key, DES3_EDE_KEY_SIZE);\n\n\tif ((!((K[0] ^ K[2]) | (K[1] ^ K[3])) ||\n\t     !((K[2] ^ K[4]) | (K[3] ^ K[5]))) &&\n\t    (fips_enabled || check_weak))\n\t\tgoto bad;\n\n\tif ((!((K[0] ^ K[4]) | (K[1] ^ K[5]))) && fips_enabled)\n\t\tgoto bad;\n\n\tret = 0;\nbad:\n\tmemzero_explicit(K, DES3_EDE_KEY_SIZE);\n\n\treturn ret;\n}\n\n \nstatic inline int crypto_des3_ede_verify_key(struct crypto_tfm *tfm,\n\t\t\t\t\t     const u8 *key)\n{\n\treturn des3_ede_verify_key(key, DES3_EDE_KEY_SIZE,\n\t\t\t\t   crypto_tfm_get_flags(tfm) &\n\t\t\t\t   CRYPTO_TFM_REQ_FORBID_WEAK_KEYS);\n}\n\nstatic inline int verify_skcipher_des_key(struct crypto_skcipher *tfm,\n\t\t\t\t\t  const u8 *key)\n{\n\treturn crypto_des_verify_key(crypto_skcipher_tfm(tfm), key);\n}\n\nstatic inline int verify_skcipher_des3_key(struct crypto_skcipher *tfm,\n\t\t\t\t\t   const u8 *key)\n{\n\treturn crypto_des3_ede_verify_key(crypto_skcipher_tfm(tfm), key);\n}\n\nstatic inline int verify_aead_des_key(struct crypto_aead *tfm, const u8 *key,\n\t\t\t\t      int keylen)\n{\n\tif (keylen != DES_KEY_SIZE)\n\t\treturn -EINVAL;\n\treturn crypto_des_verify_key(crypto_aead_tfm(tfm), key);\n}\n\nstatic inline int verify_aead_des3_key(struct crypto_aead *tfm, const u8 *key,\n\t\t\t\t       int keylen)\n{\n\tif (keylen != DES3_EDE_KEY_SIZE)\n\t\treturn -EINVAL;\n\treturn crypto_des3_ede_verify_key(crypto_aead_tfm(tfm), key);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}