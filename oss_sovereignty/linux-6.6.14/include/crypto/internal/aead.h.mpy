{
  "module_name": "aead.h",
  "hash_id": "7106a497ad82911d56294f3fccd17a9f2eab1cfd740aa1d71237afe169a03469",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/internal/aead.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_INTERNAL_AEAD_H\n#define _CRYPTO_INTERNAL_AEAD_H\n\n#include <crypto/aead.h>\n#include <crypto/algapi.h>\n#include <linux/stddef.h>\n#include <linux/types.h>\n\nstruct rtattr;\n\nstruct aead_instance {\n\tvoid (*free)(struct aead_instance *inst);\n\tunion {\n\t\tstruct {\n\t\t\tchar head[offsetof(struct aead_alg, base)];\n\t\t\tstruct crypto_instance base;\n\t\t} s;\n\t\tstruct aead_alg alg;\n\t};\n};\n\nstruct crypto_aead_spawn {\n\tstruct crypto_spawn base;\n};\n\nstruct aead_queue {\n\tstruct crypto_queue base;\n};\n\nstatic inline void *crypto_aead_ctx(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_ctx(&tfm->base);\n}\n\nstatic inline void *crypto_aead_ctx_dma(struct crypto_aead *tfm)\n{\n\treturn crypto_tfm_ctx_dma(&tfm->base);\n}\n\nstatic inline struct crypto_instance *aead_crypto_instance(\n\tstruct aead_instance *inst)\n{\n\treturn container_of(&inst->alg.base, struct crypto_instance, alg);\n}\n\nstatic inline struct aead_instance *aead_instance(struct crypto_instance *inst)\n{\n\treturn container_of(&inst->alg, struct aead_instance, alg.base);\n}\n\nstatic inline struct aead_instance *aead_alg_instance(struct crypto_aead *aead)\n{\n\treturn aead_instance(crypto_tfm_alg_instance(&aead->base));\n}\n\nstatic inline void *aead_instance_ctx(struct aead_instance *inst)\n{\n\treturn crypto_instance_ctx(aead_crypto_instance(inst));\n}\n\nstatic inline void *aead_request_ctx(struct aead_request *req)\n{\n\treturn req->__ctx;\n}\n\nstatic inline void *aead_request_ctx_dma(struct aead_request *req)\n{\n\tunsigned int align = crypto_dma_align();\n\n\tif (align <= crypto_tfm_ctx_alignment())\n\t\talign = 1;\n\n\treturn PTR_ALIGN(aead_request_ctx(req), align);\n}\n\nstatic inline void aead_request_complete(struct aead_request *req, int err)\n{\n\tcrypto_request_complete(&req->base, err);\n}\n\nstatic inline u32 aead_request_flags(struct aead_request *req)\n{\n\treturn req->base.flags;\n}\n\nstatic inline struct aead_request *aead_request_cast(\n\tstruct crypto_async_request *req)\n{\n\treturn container_of(req, struct aead_request, base);\n}\n\nint crypto_grab_aead(struct crypto_aead_spawn *spawn,\n\t\t     struct crypto_instance *inst,\n\t\t     const char *name, u32 type, u32 mask);\n\nstatic inline void crypto_drop_aead(struct crypto_aead_spawn *spawn)\n{\n\tcrypto_drop_spawn(&spawn->base);\n}\n\nstatic inline struct aead_alg *crypto_spawn_aead_alg(\n\tstruct crypto_aead_spawn *spawn)\n{\n\treturn container_of(spawn->base.alg, struct aead_alg, base);\n}\n\nstatic inline struct crypto_aead *crypto_spawn_aead(\n\tstruct crypto_aead_spawn *spawn)\n{\n\treturn crypto_spawn_tfm2(&spawn->base);\n}\n\nstatic inline void crypto_aead_set_reqsize(struct crypto_aead *aead,\n\t\t\t\t\t   unsigned int reqsize)\n{\n\taead->reqsize = reqsize;\n}\n\nstatic inline void crypto_aead_set_reqsize_dma(struct crypto_aead *aead,\n\t\t\t\t\t       unsigned int reqsize)\n{\n\treqsize += crypto_dma_align() & ~(crypto_tfm_ctx_alignment() - 1);\n\taead->reqsize = reqsize;\n}\n\nstatic inline void aead_init_queue(struct aead_queue *queue,\n\t\t\t\t   unsigned int max_qlen)\n{\n\tcrypto_init_queue(&queue->base, max_qlen);\n}\n\nstatic inline unsigned int crypto_aead_alg_chunksize(struct aead_alg *alg)\n{\n\treturn alg->chunksize;\n}\n\n \nstatic inline unsigned int crypto_aead_chunksize(struct crypto_aead *tfm)\n{\n\treturn crypto_aead_alg_chunksize(crypto_aead_alg(tfm));\n}\n\nint crypto_register_aead(struct aead_alg *alg);\nvoid crypto_unregister_aead(struct aead_alg *alg);\nint crypto_register_aeads(struct aead_alg *algs, int count);\nvoid crypto_unregister_aeads(struct aead_alg *algs, int count);\nint aead_register_instance(struct crypto_template *tmpl,\n\t\t\t   struct aead_instance *inst);\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}