{
  "module_name": "hash.h",
  "hash_id": "28f2b42fdb08020cf086934b2e07c7d5eb9314e59efd2244b87f52019fc76a72",
  "original_prompt": "Ingested from linux-6.6.14/include/crypto/internal/hash.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_INTERNAL_HASH_H\n#define _CRYPTO_INTERNAL_HASH_H\n\n#include <crypto/algapi.h>\n#include <crypto/hash.h>\n\nstruct ahash_request;\nstruct scatterlist;\n\nstruct crypto_hash_walk {\n\tchar *data;\n\n\tunsigned int offset;\n\tunsigned int alignmask;\n\n\tstruct page *pg;\n\tunsigned int entrylen;\n\n\tunsigned int total;\n\tstruct scatterlist *sg;\n\n\tunsigned int flags;\n};\n\nstruct ahash_instance {\n\tvoid (*free)(struct ahash_instance *inst);\n\tunion {\n\t\tstruct {\n\t\t\tchar head[offsetof(struct ahash_alg, halg.base)];\n\t\t\tstruct crypto_instance base;\n\t\t} s;\n\t\tstruct ahash_alg alg;\n\t};\n};\n\nstruct shash_instance {\n\tvoid (*free)(struct shash_instance *inst);\n\tunion {\n\t\tstruct {\n\t\t\tchar head[offsetof(struct shash_alg, base)];\n\t\t\tstruct crypto_instance base;\n\t\t} s;\n\t\tstruct shash_alg alg;\n\t};\n};\n\nstruct crypto_ahash_spawn {\n\tstruct crypto_spawn base;\n};\n\nstruct crypto_shash_spawn {\n\tstruct crypto_spawn base;\n};\n\nint crypto_hash_walk_done(struct crypto_hash_walk *walk, int err);\nint crypto_hash_walk_first(struct ahash_request *req,\n\t\t\t   struct crypto_hash_walk *walk);\n\nstatic inline int crypto_hash_walk_last(struct crypto_hash_walk *walk)\n{\n\treturn !(walk->entrylen | walk->total);\n}\n\nint crypto_register_ahash(struct ahash_alg *alg);\nvoid crypto_unregister_ahash(struct ahash_alg *alg);\nint crypto_register_ahashes(struct ahash_alg *algs, int count);\nvoid crypto_unregister_ahashes(struct ahash_alg *algs, int count);\nint ahash_register_instance(struct crypto_template *tmpl,\n\t\t\t    struct ahash_instance *inst);\n\nint shash_no_setkey(struct crypto_shash *tfm, const u8 *key,\n\t\t    unsigned int keylen);\n\nstatic inline bool crypto_shash_alg_has_setkey(struct shash_alg *alg)\n{\n\treturn alg->setkey != shash_no_setkey;\n}\n\nstatic inline bool crypto_shash_alg_needs_key(struct shash_alg *alg)\n{\n\treturn crypto_shash_alg_has_setkey(alg) &&\n\t\t!(alg->base.cra_flags & CRYPTO_ALG_OPTIONAL_KEY);\n}\n\nbool crypto_hash_alg_has_setkey(struct hash_alg_common *halg);\n\nint crypto_grab_ahash(struct crypto_ahash_spawn *spawn,\n\t\t      struct crypto_instance *inst,\n\t\t      const char *name, u32 type, u32 mask);\n\nstatic inline void crypto_drop_ahash(struct crypto_ahash_spawn *spawn)\n{\n\tcrypto_drop_spawn(&spawn->base);\n}\n\nstatic inline struct hash_alg_common *crypto_spawn_ahash_alg(\n\tstruct crypto_ahash_spawn *spawn)\n{\n\treturn __crypto_hash_alg_common(spawn->base.alg);\n}\n\nint crypto_register_shash(struct shash_alg *alg);\nvoid crypto_unregister_shash(struct shash_alg *alg);\nint crypto_register_shashes(struct shash_alg *algs, int count);\nvoid crypto_unregister_shashes(struct shash_alg *algs, int count);\nint shash_register_instance(struct crypto_template *tmpl,\n\t\t\t    struct shash_instance *inst);\nvoid shash_free_singlespawn_instance(struct shash_instance *inst);\n\nint crypto_grab_shash(struct crypto_shash_spawn *spawn,\n\t\t      struct crypto_instance *inst,\n\t\t      const char *name, u32 type, u32 mask);\n\nstatic inline void crypto_drop_shash(struct crypto_shash_spawn *spawn)\n{\n\tcrypto_drop_spawn(&spawn->base);\n}\n\nstatic inline struct shash_alg *crypto_spawn_shash_alg(\n\tstruct crypto_shash_spawn *spawn)\n{\n\treturn __crypto_shash_alg(spawn->base.alg);\n}\n\nint shash_ahash_update(struct ahash_request *req, struct shash_desc *desc);\nint shash_ahash_finup(struct ahash_request *req, struct shash_desc *desc);\nint shash_ahash_digest(struct ahash_request *req, struct shash_desc *desc);\n\nstatic inline void *crypto_ahash_ctx(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_ctx(crypto_ahash_tfm(tfm));\n}\n\nstatic inline void *crypto_ahash_ctx_dma(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_ctx_dma(crypto_ahash_tfm(tfm));\n}\n\nstatic inline struct ahash_alg *__crypto_ahash_alg(struct crypto_alg *alg)\n{\n\treturn container_of(__crypto_hash_alg_common(alg), struct ahash_alg,\n\t\t\t    halg);\n}\n\nstatic inline struct ahash_alg *crypto_ahash_alg(struct crypto_ahash *hash)\n{\n\treturn container_of(crypto_hash_alg_common(hash), struct ahash_alg,\n\t\t\t    halg);\n}\n\nstatic inline void crypto_ahash_set_statesize(struct crypto_ahash *tfm,\n\t\t\t\t\t      unsigned int size)\n{\n\ttfm->statesize = size;\n}\n\nstatic inline void crypto_ahash_set_reqsize(struct crypto_ahash *tfm,\n\t\t\t\t\t    unsigned int reqsize)\n{\n\ttfm->reqsize = reqsize;\n}\n\nstatic inline void crypto_ahash_set_reqsize_dma(struct crypto_ahash *ahash,\n\t\t\t\t\t\tunsigned int reqsize)\n{\n\treqsize += crypto_dma_align() & ~(crypto_tfm_ctx_alignment() - 1);\n\tahash->reqsize = reqsize;\n}\n\nstatic inline struct crypto_instance *ahash_crypto_instance(\n\tstruct ahash_instance *inst)\n{\n\treturn &inst->s.base;\n}\n\nstatic inline struct ahash_instance *ahash_instance(\n\tstruct crypto_instance *inst)\n{\n\treturn container_of(inst, struct ahash_instance, s.base);\n}\n\nstatic inline struct ahash_instance *ahash_alg_instance(\n\tstruct crypto_ahash *ahash)\n{\n\treturn ahash_instance(crypto_tfm_alg_instance(&ahash->base));\n}\n\nstatic inline void *ahash_instance_ctx(struct ahash_instance *inst)\n{\n\treturn crypto_instance_ctx(ahash_crypto_instance(inst));\n}\n\nstatic inline void *ahash_request_ctx_dma(struct ahash_request *req)\n{\n\tunsigned int align = crypto_dma_align();\n\n\tif (align <= crypto_tfm_ctx_alignment())\n\t\talign = 1;\n\n\treturn PTR_ALIGN(ahash_request_ctx(req), align);\n}\n\nstatic inline void ahash_request_complete(struct ahash_request *req, int err)\n{\n\tcrypto_request_complete(&req->base, err);\n}\n\nstatic inline u32 ahash_request_flags(struct ahash_request *req)\n{\n\treturn req->base.flags;\n}\n\nstatic inline struct crypto_ahash *crypto_spawn_ahash(\n\tstruct crypto_ahash_spawn *spawn)\n{\n\treturn crypto_spawn_tfm2(&spawn->base);\n}\n\nstatic inline int ahash_enqueue_request(struct crypto_queue *queue,\n\t\t\t\t\t     struct ahash_request *request)\n{\n\treturn crypto_enqueue_request(queue, &request->base);\n}\n\nstatic inline struct ahash_request *ahash_dequeue_request(\n\tstruct crypto_queue *queue)\n{\n\treturn ahash_request_cast(crypto_dequeue_request(queue));\n}\n\nstatic inline void *crypto_shash_ctx(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_ctx(&tfm->base);\n}\n\nstatic inline struct crypto_instance *shash_crypto_instance(\n\tstruct shash_instance *inst)\n{\n\treturn &inst->s.base;\n}\n\nstatic inline struct shash_instance *shash_instance(\n\tstruct crypto_instance *inst)\n{\n\treturn container_of(inst, struct shash_instance, s.base);\n}\n\nstatic inline struct shash_instance *shash_alg_instance(\n\tstruct crypto_shash *shash)\n{\n\treturn shash_instance(crypto_tfm_alg_instance(&shash->base));\n}\n\nstatic inline void *shash_instance_ctx(struct shash_instance *inst)\n{\n\treturn crypto_instance_ctx(shash_crypto_instance(inst));\n}\n\nstatic inline struct crypto_shash *crypto_spawn_shash(\n\tstruct crypto_shash_spawn *spawn)\n{\n\treturn crypto_spawn_tfm2(&spawn->base);\n}\n\nstatic inline void *crypto_shash_ctx_aligned(struct crypto_shash *tfm)\n{\n\treturn crypto_tfm_ctx_aligned(&tfm->base);\n}\n\nstatic inline struct crypto_shash *__crypto_shash_cast(struct crypto_tfm *tfm)\n{\n\treturn container_of(tfm, struct crypto_shash, base);\n}\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}