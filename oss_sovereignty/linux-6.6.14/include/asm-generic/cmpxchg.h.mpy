{
  "module_name": "cmpxchg.h",
  "hash_id": "f570eeed43a43adf5431a03c5360e7986f593a10fb118d97c8544cfe196c047a",
  "original_prompt": "Ingested from linux-6.6.14/include/asm-generic/cmpxchg.h",
  "human_readable_source": " \n \n\n#ifndef __ASM_GENERIC_CMPXCHG_H\n#define __ASM_GENERIC_CMPXCHG_H\n\n#ifdef CONFIG_SMP\n#error \"Cannot use generic cmpxchg on SMP\"\n#endif\n\n#include <linux/types.h>\n#include <linux/irqflags.h>\n\n \nextern void __generic_xchg_called_with_bad_pointer(void);\n\nstatic inline\nunsigned long __generic_xchg(unsigned long x, volatile void *ptr, int size)\n{\n\tunsigned long ret, flags;\n\n\tswitch (size) {\n\tcase 1:\n#ifdef __xchg_u8\n\t\treturn __xchg_u8(x, ptr);\n#else\n\t\tlocal_irq_save(flags);\n\t\tret = *(volatile u8 *)ptr;\n\t\t*(volatile u8 *)ptr = (x & 0xffu);\n\t\tlocal_irq_restore(flags);\n\t\treturn ret;\n#endif  \n\n\tcase 2:\n#ifdef __xchg_u16\n\t\treturn __xchg_u16(x, ptr);\n#else\n\t\tlocal_irq_save(flags);\n\t\tret = *(volatile u16 *)ptr;\n\t\t*(volatile u16 *)ptr = (x & 0xffffu);\n\t\tlocal_irq_restore(flags);\n\t\treturn ret;\n#endif  \n\n\tcase 4:\n#ifdef __xchg_u32\n\t\treturn __xchg_u32(x, ptr);\n#else\n\t\tlocal_irq_save(flags);\n\t\tret = *(volatile u32 *)ptr;\n\t\t*(volatile u32 *)ptr = (x & 0xffffffffu);\n\t\tlocal_irq_restore(flags);\n\t\treturn ret;\n#endif  \n\n#ifdef CONFIG_64BIT\n\tcase 8:\n#ifdef __xchg_u64\n\t\treturn __xchg_u64(x, ptr);\n#else\n\t\tlocal_irq_save(flags);\n\t\tret = *(volatile u64 *)ptr;\n\t\t*(volatile u64 *)ptr = x;\n\t\tlocal_irq_restore(flags);\n\t\treturn ret;\n#endif  \n#endif  \n\n\tdefault:\n\t\t__generic_xchg_called_with_bad_pointer();\n\t\treturn x;\n\t}\n}\n\n#define generic_xchg(ptr, x) ({\t\t\t\t\t\t\t\\\n\t((__typeof__(*(ptr)))\t\t\t\t\t\t\t\\\n\t\t__generic_xchg((unsigned long)(x), (ptr), sizeof(*(ptr))));\t\\\n})\n\n \n#include <asm-generic/cmpxchg-local.h>\n\n#define generic_cmpxchg_local(ptr, o, n) ({\t\t\t\t\t\\\n\t((__typeof__(*(ptr)))__generic_cmpxchg_local((ptr), (unsigned long)(o),\t\\\n\t\t\t(unsigned long)(n), sizeof(*(ptr))));\t\t\t\\\n})\n\n#define generic_cmpxchg64_local(ptr, o, n) \\\n\t__generic_cmpxchg64_local((ptr), (o), (n))\n\n\n#ifndef arch_xchg\n#define arch_xchg\t\tgeneric_xchg\n#endif\n\n#ifndef arch_cmpxchg_local\n#define arch_cmpxchg_local\tgeneric_cmpxchg_local\n#endif\n\n#ifndef arch_cmpxchg64_local\n#define arch_cmpxchg64_local\tgeneric_cmpxchg64_local\n#endif\n\n#define arch_cmpxchg\t\tarch_cmpxchg_local\n#define arch_cmpxchg64\t\tarch_cmpxchg64_local\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}