{
  "module_name": "uaccess.h",
  "hash_id": "ef5e133a816c189835b1454d8baf731a5ef945c7f017438fe506010abef03246",
  "original_prompt": "Ingested from linux-6.6.14/include/asm-generic/uaccess.h",
  "human_readable_source": " \n#ifndef __ASM_GENERIC_UACCESS_H\n#define __ASM_GENERIC_UACCESS_H\n\n \n#include <linux/string.h>\n#include <asm-generic/access_ok.h>\n\n#ifdef CONFIG_UACCESS_MEMCPY\n#include <asm/unaligned.h>\n\nstatic __always_inline int\n__get_user_fn(size_t size, const void __user *from, void *to)\n{\n\tBUILD_BUG_ON(!__builtin_constant_p(size));\n\n\tswitch (size) {\n\tcase 1:\n\t\t*(u8 *)to = *((u8 __force *)from);\n\t\treturn 0;\n\tcase 2:\n\t\t*(u16 *)to = get_unaligned((u16 __force *)from);\n\t\treturn 0;\n\tcase 4:\n\t\t*(u32 *)to = get_unaligned((u32 __force *)from);\n\t\treturn 0;\n\tcase 8:\n\t\t*(u64 *)to = get_unaligned((u64 __force *)from);\n\t\treturn 0;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn 0;\n\t}\n\n}\n#define __get_user_fn(sz, u, k)\t__get_user_fn(sz, u, k)\n\nstatic __always_inline int\n__put_user_fn(size_t size, void __user *to, void *from)\n{\n\tBUILD_BUG_ON(!__builtin_constant_p(size));\n\n\tswitch (size) {\n\tcase 1:\n\t\t*(u8 __force *)to = *(u8 *)from;\n\t\treturn 0;\n\tcase 2:\n\t\tput_unaligned(*(u16 *)from, (u16 __force *)to);\n\t\treturn 0;\n\tcase 4:\n\t\tput_unaligned(*(u32 *)from, (u32 __force *)to);\n\t\treturn 0;\n\tcase 8:\n\t\tput_unaligned(*(u64 *)from, (u64 __force *)to);\n\t\treturn 0;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn 0;\n\t}\n}\n#define __put_user_fn(sz, u, k)\t__put_user_fn(sz, u, k)\n\n#define __get_kernel_nofault(dst, src, type, err_label)\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\t*((type *)dst) = get_unaligned((type *)(src));\t\t\t\\\n\tif (0)  \t\\\n\t\tgoto err_label;\t\t\t\t\t\t\\\n} while (0)\n\n#define __put_kernel_nofault(dst, src, type, err_label)\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tput_unaligned(*((type *)src), (type *)(dst));\t\t\t\\\n\tif (0)  \t\\\n\t\tgoto err_label;\t\t\t\t\t\t\\\n} while (0)\n\nstatic inline __must_check unsigned long\nraw_copy_from_user(void *to, const void __user * from, unsigned long n)\n{\n\tmemcpy(to, (const void __force *)from, n);\n\treturn 0;\n}\n\nstatic inline __must_check unsigned long\nraw_copy_to_user(void __user *to, const void *from, unsigned long n)\n{\n\tmemcpy((void __force *)to, from, n);\n\treturn 0;\n}\n#define INLINE_COPY_FROM_USER\n#define INLINE_COPY_TO_USER\n#endif  \n\n \n#define __put_user(x, ptr) \\\n({\t\t\t\t\t\t\t\t\\\n\t__typeof__(*(ptr)) __x = (x);\t\t\t\t\\\n\tint __pu_err = -EFAULT;\t\t\t\t\t\\\n        __chk_user_ptr(ptr);                                    \\\n\tswitch (sizeof (*(ptr))) {\t\t\t\t\\\n\tcase 1:\t\t\t\t\t\t\t\\\n\tcase 2:\t\t\t\t\t\t\t\\\n\tcase 4:\t\t\t\t\t\t\t\\\n\tcase 8:\t\t\t\t\t\t\t\\\n\t\t__pu_err = __put_user_fn(sizeof (*(ptr)),\t\\\n\t\t\t\t\t ptr, &__x);\t\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\tdefault:\t\t\t\t\t\t\\\n\t\t__put_user_bad();\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t }\t\t\t\t\t\t\t\\\n\t__pu_err;\t\t\t\t\t\t\\\n})\n\n#define put_user(x, ptr)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tvoid __user *__p = (ptr);\t\t\t\t\\\n\tmight_fault();\t\t\t\t\t\t\\\n\taccess_ok(__p, sizeof(*ptr)) ?\t\t\\\n\t\t__put_user((x), ((__typeof__(*(ptr)) __user *)__p)) :\t\\\n\t\t-EFAULT;\t\t\t\t\t\\\n})\n\n#ifndef __put_user_fn\n\nstatic inline int __put_user_fn(size_t size, void __user *ptr, void *x)\n{\n\treturn unlikely(raw_copy_to_user(ptr, x, size)) ? -EFAULT : 0;\n}\n\n#define __put_user_fn(sz, u, k)\t__put_user_fn(sz, u, k)\n\n#endif\n\nextern int __put_user_bad(void) __attribute__((noreturn));\n\n#define __get_user(x, ptr)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tint __gu_err = -EFAULT;\t\t\t\t\t\\\n\t__chk_user_ptr(ptr);\t\t\t\t\t\\\n\tswitch (sizeof(*(ptr))) {\t\t\t\t\\\n\tcase 1: {\t\t\t\t\t\t\\\n\t\tunsigned char __x = 0;\t\t\t\t\\\n\t\t__gu_err = __get_user_fn(sizeof (*(ptr)),\t\\\n\t\t\t\t\t ptr, &__x);\t\t\\\n\t\t(x) = *(__force __typeof__(*(ptr)) *) &__x;\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t};\t\t\t\t\t\t\t\\\n\tcase 2: {\t\t\t\t\t\t\\\n\t\tunsigned short __x = 0;\t\t\t\t\\\n\t\t__gu_err = __get_user_fn(sizeof (*(ptr)),\t\\\n\t\t\t\t\t ptr, &__x);\t\t\\\n\t\t(x) = *(__force __typeof__(*(ptr)) *) &__x;\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t};\t\t\t\t\t\t\t\\\n\tcase 4: {\t\t\t\t\t\t\\\n\t\tunsigned int __x = 0;\t\t\t\t\\\n\t\t__gu_err = __get_user_fn(sizeof (*(ptr)),\t\\\n\t\t\t\t\t ptr, &__x);\t\t\\\n\t\t(x) = *(__force __typeof__(*(ptr)) *) &__x;\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t};\t\t\t\t\t\t\t\\\n\tcase 8: {\t\t\t\t\t\t\\\n\t\tunsigned long long __x = 0;\t\t\t\\\n\t\t__gu_err = __get_user_fn(sizeof (*(ptr)),\t\\\n\t\t\t\t\t ptr, &__x);\t\t\\\n\t\t(x) = *(__force __typeof__(*(ptr)) *) &__x;\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t};\t\t\t\t\t\t\t\\\n\tdefault:\t\t\t\t\t\t\\\n\t\t__get_user_bad();\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\\\n\t__gu_err;\t\t\t\t\t\t\\\n})\n\n#define get_user(x, ptr)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tconst void __user *__p = (ptr);\t\t\t\t\\\n\tmight_fault();\t\t\t\t\t\t\\\n\taccess_ok(__p, sizeof(*ptr)) ?\t\t\\\n\t\t__get_user((x), (__typeof__(*(ptr)) __user *)__p) :\\\n\t\t((x) = (__typeof__(*(ptr)))0,-EFAULT);\t\t\\\n})\n\n#ifndef __get_user_fn\nstatic inline int __get_user_fn(size_t size, const void __user *ptr, void *x)\n{\n\treturn unlikely(raw_copy_from_user(x, ptr, size)) ? -EFAULT : 0;\n}\n\n#define __get_user_fn(sz, u, k)\t__get_user_fn(sz, u, k)\n\n#endif\n\nextern int __get_user_bad(void) __attribute__((noreturn));\n\n \n#ifndef __clear_user\nstatic inline __must_check unsigned long\n__clear_user(void __user *to, unsigned long n)\n{\n\tmemset((void __force *)to, 0, n);\n\treturn 0;\n}\n#endif\n\nstatic inline __must_check unsigned long\nclear_user(void __user *to, unsigned long n)\n{\n\tmight_fault();\n\tif (!access_ok(to, n))\n\t\treturn n;\n\n\treturn __clear_user(to, n);\n}\n\n#include <asm/extable.h>\n\n__must_check long strncpy_from_user(char *dst, const char __user *src,\n\t\t\t\t    long count);\n__must_check long strnlen_user(const char __user *src, long n);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}