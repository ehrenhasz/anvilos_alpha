{
  "module_name": "atomic.h",
  "hash_id": "e5b89c57b2a6f8649658a484a94da03ddfcff142a0fd5622542aa4adf177a2e6",
  "original_prompt": "Ingested from linux-6.6.14/include/asm-generic/atomic.h",
  "human_readable_source": " \n \n#ifndef __ASM_GENERIC_ATOMIC_H\n#define __ASM_GENERIC_ATOMIC_H\n\n#include <asm/cmpxchg.h>\n#include <asm/barrier.h>\n\n#ifdef CONFIG_SMP\n\n \n\n#define ATOMIC_OP(op, c_op)\t\t\t\t\t\t\\\nstatic inline void generic_atomic_##op(int i, atomic_t *v)\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tint c, old;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tc = v->counter;\t\t\t\t\t\t\t\\\n\twhile ((old = arch_cmpxchg(&v->counter, c, c c_op i)) != c)\t\\\n\t\tc = old;\t\t\t\t\t\t\\\n}\n\n#define ATOMIC_OP_RETURN(op, c_op)\t\t\t\t\t\\\nstatic inline int generic_atomic_##op##_return(int i, atomic_t *v)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tint c, old;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tc = v->counter;\t\t\t\t\t\t\t\\\n\twhile ((old = arch_cmpxchg(&v->counter, c, c c_op i)) != c)\t\\\n\t\tc = old;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn c c_op i;\t\t\t\t\t\t\\\n}\n\n#define ATOMIC_FETCH_OP(op, c_op)\t\t\t\t\t\\\nstatic inline int generic_atomic_fetch_##op(int i, atomic_t *v)\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tint c, old;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tc = v->counter;\t\t\t\t\t\t\t\\\n\twhile ((old = arch_cmpxchg(&v->counter, c, c c_op i)) != c)\t\\\n\t\tc = old;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn c;\t\t\t\t\t\t\t\\\n}\n\n#else\n\n#include <linux/irqflags.h>\n\n#define ATOMIC_OP(op, c_op)\t\t\t\t\t\t\\\nstatic inline void generic_atomic_##op(int i, atomic_t *v)\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tunsigned long flags;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\traw_local_irq_save(flags);\t\t\t\t\t\\\n\tv->counter = v->counter c_op i;\t\t\t\t\t\\\n\traw_local_irq_restore(flags);\t\t\t\t\t\\\n}\n\n#define ATOMIC_OP_RETURN(op, c_op)\t\t\t\t\t\\\nstatic inline int generic_atomic_##op##_return(int i, atomic_t *v)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tunsigned long flags;\t\t\t\t\t\t\\\n\tint ret;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\traw_local_irq_save(flags);\t\t\t\t\t\\\n\tret = (v->counter = v->counter c_op i);\t\t\t\t\\\n\traw_local_irq_restore(flags);\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn ret;\t\t\t\t\t\t\t\\\n}\n\n#define ATOMIC_FETCH_OP(op, c_op)\t\t\t\t\t\\\nstatic inline int generic_atomic_fetch_##op(int i, atomic_t *v)\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tunsigned long flags;\t\t\t\t\t\t\\\n\tint ret;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\traw_local_irq_save(flags);\t\t\t\t\t\\\n\tret = v->counter;\t\t\t\t\t\t\\\n\tv->counter = v->counter c_op i;\t\t\t\t\t\\\n\traw_local_irq_restore(flags);\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn ret;\t\t\t\t\t\t\t\\\n}\n\n#endif  \n\nATOMIC_OP_RETURN(add, +)\nATOMIC_OP_RETURN(sub, -)\n\nATOMIC_FETCH_OP(add, +)\nATOMIC_FETCH_OP(sub, -)\nATOMIC_FETCH_OP(and, &)\nATOMIC_FETCH_OP(or, |)\nATOMIC_FETCH_OP(xor, ^)\n\nATOMIC_OP(add, +)\nATOMIC_OP(sub, -)\nATOMIC_OP(and, &)\nATOMIC_OP(or, |)\nATOMIC_OP(xor, ^)\n\n#undef ATOMIC_FETCH_OP\n#undef ATOMIC_OP_RETURN\n#undef ATOMIC_OP\n\n#define arch_atomic_add_return\t\t\tgeneric_atomic_add_return\n#define arch_atomic_sub_return\t\t\tgeneric_atomic_sub_return\n\n#define arch_atomic_fetch_add\t\t\tgeneric_atomic_fetch_add\n#define arch_atomic_fetch_sub\t\t\tgeneric_atomic_fetch_sub\n#define arch_atomic_fetch_and\t\t\tgeneric_atomic_fetch_and\n#define arch_atomic_fetch_or\t\t\tgeneric_atomic_fetch_or\n#define arch_atomic_fetch_xor\t\t\tgeneric_atomic_fetch_xor\n\n#define arch_atomic_add\t\t\t\tgeneric_atomic_add\n#define arch_atomic_sub\t\t\t\tgeneric_atomic_sub\n#define arch_atomic_and\t\t\t\tgeneric_atomic_and\n#define arch_atomic_or\t\t\t\tgeneric_atomic_or\n#define arch_atomic_xor\t\t\t\tgeneric_atomic_xor\n\n#define arch_atomic_read(v)\t\t\tREAD_ONCE((v)->counter)\n#define arch_atomic_set(v, i)\t\t\tWRITE_ONCE(((v)->counter), (i))\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}