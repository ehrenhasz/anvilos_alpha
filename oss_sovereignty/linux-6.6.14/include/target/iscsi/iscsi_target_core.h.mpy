{
  "module_name": "iscsi_target_core.h",
  "hash_id": "3678643b17844a5d2d1f70df09643ccbddd3afac7d81154cd70ac093b585c6f8",
  "original_prompt": "Ingested from linux-6.6.14/include/target/iscsi/iscsi_target_core.h",
  "human_readable_source": " \n#ifndef ISCSI_TARGET_CORE_H\n#define ISCSI_TARGET_CORE_H\n\n#include <linux/dma-direction.h>      \n#include <linux/list.h>               \n#include <linux/sched.h>\n#include <linux/socket.h>             \n#include <linux/types.h>              \n#include <scsi/iscsi_proto.h>         \n#include <target/target_core_base.h>  \n\nstruct sock;\n\n#define ISCSIT_VERSION\t\t\t\"v4.1.0\"\n#define ISCSI_MAX_DATASN_MISSING_COUNT\t16\n#define ISCSI_TX_THREAD_TCP_TIMEOUT\t2\n#define ISCSI_RX_THREAD_TCP_TIMEOUT\t2\n#define SECONDS_FOR_ASYNC_LOGOUT\t10\n#define SECONDS_FOR_ASYNC_TEXT\t\t10\n#define SECONDS_FOR_LOGOUT_COMP\t\t15\n#define WHITE_SPACE\t\t\t\" \\t\\v\\f\\n\\r\"\n#define ISCSIT_MIN_TAGS\t\t\t16\n#define ISCSIT_EXTRA_TAGS\t\t8\n#define ISCSIT_TCP_BACKLOG\t\t256\n#define ISCSI_RX_THREAD_NAME\t\t\"iscsi_trx\"\n#define ISCSI_TX_THREAD_NAME\t\t\"iscsi_ttx\"\n#define ISCSI_IQN_LEN\t\t\t224\n#define NA_AUTHENTICATION_INHERITED\t-1\n\n \n#define NA_DATAOUT_TIMEOUT\t\t3\n#define NA_DATAOUT_TIMEOUT_MAX\t\t60\n#define NA_DATAOUT_TIMEOUT_MIX\t\t2\n#define NA_DATAOUT_TIMEOUT_RETRIES\t5\n#define NA_DATAOUT_TIMEOUT_RETRIES_MAX\t15\n#define NA_DATAOUT_TIMEOUT_RETRIES_MIN\t1\n#define NA_NOPIN_TIMEOUT\t\t15\n#define NA_NOPIN_TIMEOUT_MAX\t\t60\n#define NA_NOPIN_TIMEOUT_MIN\t\t3\n#define NA_NOPIN_RESPONSE_TIMEOUT\t30\n#define NA_NOPIN_RESPONSE_TIMEOUT_MAX\t60\n#define NA_NOPIN_RESPONSE_TIMEOUT_MIN\t3\n#define NA_RANDOM_DATAIN_PDU_OFFSETS\t0\n#define NA_RANDOM_DATAIN_SEQ_OFFSETS\t0\n#define NA_RANDOM_R2T_OFFSETS\t\t0\n\n \n#define TA_AUTHENTICATION\t\t1\n#define TA_LOGIN_TIMEOUT\t\t15\n#define TA_LOGIN_TIMEOUT_MAX\t\t30\n#define TA_LOGIN_TIMEOUT_MIN\t\t5\n#define TA_GENERATE_NODE_ACLS\t\t0\n#define TA_DEFAULT_CMDSN_DEPTH\t\t64\n#define TA_DEFAULT_CMDSN_DEPTH_MAX\t512\n#define TA_DEFAULT_CMDSN_DEPTH_MIN\t1\n#define TA_CACHE_DYNAMIC_ACLS\t\t0\n \n#define TA_DEMO_MODE_WRITE_PROTECT\t1\n \n#define TA_PROD_MODE_WRITE_PROTECT\t0\n#define TA_DEMO_MODE_DISCOVERY\t\t1\n#define TA_DEFAULT_ERL\t\t\t0\n#define TA_CACHE_CORE_NPS\t\t0\n \n#define TA_DEFAULT_T10_PI\t\t0\n#define TA_DEFAULT_FABRIC_PROT_TYPE\t0\n \n#define TA_DEFAULT_TPG_ENABLED_SENDTARGETS 1\n \n#define TA_DEFAULT_LOGIN_KEYS_WORKAROUND 1\n\n#define ISCSI_IOV_DATA_BUFFER\t\t5\n\nenum iscsit_transport_type {\n\tISCSI_TCP\t\t\t\t= 0,\n\tISCSI_SCTP_TCP\t\t\t\t= 1,\n\tISCSI_SCTP_UDP\t\t\t\t= 2,\n\tISCSI_IWARP_TCP\t\t\t\t= 3,\n\tISCSI_IWARP_SCTP\t\t\t= 4,\n\tISCSI_INFINIBAND\t\t\t= 5,\n\tISCSI_CXGBIT\t\t\t\t= 6,\n};\n\n \nenum target_conn_state_table {\n\tTARG_CONN_STATE_FREE\t\t\t= 0x1,\n\tTARG_CONN_STATE_XPT_UP\t\t\t= 0x3,\n\tTARG_CONN_STATE_IN_LOGIN\t\t= 0x4,\n\tTARG_CONN_STATE_LOGGED_IN\t\t= 0x5,\n\tTARG_CONN_STATE_IN_LOGOUT\t\t= 0x6,\n\tTARG_CONN_STATE_LOGOUT_REQUESTED\t= 0x7,\n\tTARG_CONN_STATE_CLEANUP_WAIT\t\t= 0x8,\n};\n\n \nenum target_sess_state_table {\n\tTARG_SESS_STATE_FREE\t\t\t= 0x1,\n\tTARG_SESS_STATE_ACTIVE\t\t\t= 0x2,\n\tTARG_SESS_STATE_LOGGED_IN\t\t= 0x3,\n\tTARG_SESS_STATE_FAILED\t\t\t= 0x4,\n\tTARG_SESS_STATE_IN_CONTINUE\t\t= 0x5,\n};\n\n \nenum data_count_type {\n\tISCSI_RX_DATA\t= 1,\n\tISCSI_TX_DATA\t= 2,\n};\n\n \nenum datain_req_comp_table {\n\tDATAIN_COMPLETE_NORMAL\t\t\t= 1,\n\tDATAIN_COMPLETE_WITHIN_COMMAND_RECOVERY = 2,\n\tDATAIN_COMPLETE_CONNECTION_RECOVERY\t= 3,\n};\n\n \nenum datain_req_rec_table {\n\tDATAIN_WITHIN_COMMAND_RECOVERY\t\t= 1,\n\tDATAIN_CONNECTION_RECOVERY\t\t= 2,\n};\n\n \nenum tpg_state_table {\n\tTPG_STATE_FREE\t\t\t\t= 0,\n\tTPG_STATE_ACTIVE\t\t\t= 1,\n\tTPG_STATE_INACTIVE\t\t\t= 2,\n\tTPG_STATE_COLD_RESET\t\t\t= 3,\n};\n\n \nenum tiqn_state_table {\n\tTIQN_STATE_ACTIVE\t\t\t= 1,\n\tTIQN_STATE_SHUTDOWN\t\t\t= 2,\n};\n\n \nenum cmd_flags_table {\n\tICF_GOT_LAST_DATAOUT\t\t\t= 0x00000001,\n\tICF_GOT_DATACK_SNACK\t\t\t= 0x00000002,\n\tICF_NON_IMMEDIATE_UNSOLICITED_DATA\t= 0x00000004,\n\tICF_SENT_LAST_R2T\t\t\t= 0x00000008,\n\tICF_WITHIN_COMMAND_RECOVERY\t\t= 0x00000010,\n\tICF_CONTIG_MEMORY\t\t\t= 0x00000020,\n\tICF_ATTACHED_TO_RQUEUE\t\t\t= 0x00000040,\n\tICF_OOO_CMDSN\t\t\t\t= 0x00000080,\n\tICF_SENDTARGETS_ALL\t\t\t= 0x00000100,\n\tICF_SENDTARGETS_SINGLE\t\t\t= 0x00000200,\n};\n\n \nenum cmd_i_state_table {\n\tISTATE_NO_STATE\t\t\t= 0,\n\tISTATE_NEW_CMD\t\t\t= 1,\n\tISTATE_DEFERRED_CMD\t\t= 2,\n\tISTATE_UNSOLICITED_DATA\t\t= 3,\n\tISTATE_RECEIVE_DATAOUT\t\t= 4,\n\tISTATE_RECEIVE_DATAOUT_RECOVERY\t= 5,\n\tISTATE_RECEIVED_LAST_DATAOUT\t= 6,\n\tISTATE_WITHIN_DATAOUT_RECOVERY\t= 7,\n\tISTATE_IN_CONNECTION_RECOVERY\t= 8,\n\tISTATE_RECEIVED_TASKMGT\t\t= 9,\n\tISTATE_SEND_ASYNCMSG\t\t= 10,\n\tISTATE_SENT_ASYNCMSG\t\t= 11,\n\tISTATE_SEND_DATAIN\t\t= 12,\n\tISTATE_SEND_LAST_DATAIN\t\t= 13,\n\tISTATE_SENT_LAST_DATAIN\t\t= 14,\n\tISTATE_SEND_LOGOUTRSP\t\t= 15,\n\tISTATE_SENT_LOGOUTRSP\t\t= 16,\n\tISTATE_SEND_NOPIN\t\t= 17,\n\tISTATE_SENT_NOPIN\t\t= 18,\n\tISTATE_SEND_REJECT\t\t= 19,\n\tISTATE_SENT_REJECT\t\t= 20,\n\tISTATE_SEND_R2T\t\t\t= 21,\n\tISTATE_SENT_R2T\t\t\t= 22,\n\tISTATE_SEND_R2T_RECOVERY\t= 23,\n\tISTATE_SENT_R2T_RECOVERY\t= 24,\n\tISTATE_SEND_LAST_R2T\t\t= 25,\n\tISTATE_SENT_LAST_R2T\t\t= 26,\n\tISTATE_SEND_LAST_R2T_RECOVERY\t= 27,\n\tISTATE_SENT_LAST_R2T_RECOVERY\t= 28,\n\tISTATE_SEND_STATUS\t\t= 29,\n\tISTATE_SEND_STATUS_BROKEN_PC\t= 30,\n\tISTATE_SENT_STATUS\t\t= 31,\n\tISTATE_SEND_STATUS_RECOVERY\t= 32,\n\tISTATE_SENT_STATUS_RECOVERY\t= 33,\n\tISTATE_SEND_TASKMGTRSP\t\t= 34,\n\tISTATE_SENT_TASKMGTRSP\t\t= 35,\n\tISTATE_SEND_TEXTRSP\t\t= 36,\n\tISTATE_SENT_TEXTRSP\t\t= 37,\n\tISTATE_SEND_NOPIN_WANT_RESPONSE\t= 38,\n\tISTATE_SENT_NOPIN_WANT_RESPONSE\t= 39,\n\tISTATE_SEND_NOPIN_NO_RESPONSE\t= 40,\n\tISTATE_REMOVE\t\t\t= 41,\n\tISTATE_FREE\t\t\t= 42,\n};\n\n \nenum recover_cmdsn_ret_table {\n\tCMDSN_ERROR_CANNOT_RECOVER\t= -1,\n\tCMDSN_NORMAL_OPERATION\t\t= 0,\n\tCMDSN_LOWER_THAN_EXP\t\t= 1,\n\tCMDSN_HIGHER_THAN_EXP\t\t= 2,\n\tCMDSN_MAXCMDSN_OVERRUN\t\t= 3,\n};\n\n \nenum immedate_data_ret_table {\n\tIMMEDIATE_DATA_CANNOT_RECOVER\t= -1,\n\tIMMEDIATE_DATA_NORMAL_OPERATION = 0,\n\tIMMEDIATE_DATA_ERL1_CRC_FAILURE = 1,\n};\n\n \nenum dataout_action_ret_table {\n\tDATAOUT_CANNOT_RECOVER\t\t= -1,\n\tDATAOUT_NORMAL\t\t\t= 0,\n\tDATAOUT_SEND_R2T\t\t= 1,\n\tDATAOUT_SEND_TO_TRANSPORT\t= 2,\n\tDATAOUT_WITHIN_COMMAND_RECOVERY = 3,\n};\n\n \nenum naf_flags_table {\n\tNAF_USERID_SET\t\t\t= 0x01,\n\tNAF_PASSWORD_SET\t\t= 0x02,\n\tNAF_USERID_IN_SET\t\t= 0x04,\n\tNAF_PASSWORD_IN_SET\t\t= 0x08,\n};\n\n \nenum iscsi_timer_flags_table {\n\tISCSI_TF_RUNNING\t\t= 0x01,\n\tISCSI_TF_STOP\t\t\t= 0x02,\n\tISCSI_TF_EXPIRED\t\t= 0x04,\n};\n\n \nenum np_flags_table {\n\tNPF_IP_NETWORK\t\t= 0x00,\n};\n\n \nenum np_thread_state_table {\n\tISCSI_NP_THREAD_ACTIVE\t\t= 1,\n\tISCSI_NP_THREAD_INACTIVE\t= 2,\n\tISCSI_NP_THREAD_RESET\t\t= 3,\n\tISCSI_NP_THREAD_SHUTDOWN\t= 4,\n\tISCSI_NP_THREAD_EXIT\t\t= 5,\n};\n\nstruct iscsi_conn_ops {\n\tu8\tHeaderDigest;\t\t\t \n\tu8\tDataDigest;\t\t\t \n\tu32\tMaxRecvDataSegmentLength;\t \n\tu32\tMaxXmitDataSegmentLength;\t \n\t \n\tu32\tInitiatorRecvDataSegmentLength;\t \n\tu32\tTargetRecvDataSegmentLength;\t \n};\n\nstruct iscsi_sess_ops {\n\tchar\tInitiatorName[ISCSI_IQN_LEN];\n\tchar\tInitiatorAlias[256];\n\tchar\tTargetName[ISCSI_IQN_LEN];\n\tchar\tTargetAlias[256];\n\tchar\tTargetAddress[256];\n\tu16\tTargetPortalGroupTag;\t\t \n\tu16\tMaxConnections;\t\t\t \n\tu8\tInitialR2T;\t\t\t \n\tu8\tImmediateData;\t\t\t \n\tu32\tMaxBurstLength;\t\t\t \n\tu32\tFirstBurstLength;\t\t \n\tu16\tDefaultTime2Wait;\t\t \n\tu16\tDefaultTime2Retain;\t\t \n\tu16\tMaxOutstandingR2T;\t\t \n\tu8\tDataPDUInOrder;\t\t\t \n\tu8\tDataSequenceInOrder;\t\t \n\tu8\tErrorRecoveryLevel;\t\t \n\tu8\tSessionType;\t\t\t \n\t \n\tu8\tRDMAExtensions;\t\t\t \n};\n\nstruct iscsi_queue_req {\n\tint\t\t\tstate;\n\tstruct iscsit_cmd\t*cmd;\n\tstruct list_head\tqr_list;\n};\n\nstruct iscsi_param_list {\n\tbool\t\t\tiser;\n\tstruct list_head\tparam_list;\n\tstruct list_head\textra_response_list;\n};\n\nstruct iscsi_datain_req {\n\tenum datain_req_comp_table dr_complete;\n\tint\t\t\tgenerate_recovery_values;\n\tenum datain_req_rec_table recovery;\n\tu32\t\t\tbegrun;\n\tu32\t\t\trunlength;\n\tu32\t\t\tdata_length;\n\tu32\t\t\tdata_offset;\n\tu32\t\t\tdata_sn;\n\tu32\t\t\tnext_burst_len;\n\tu32\t\t\tread_data_done;\n\tu32\t\t\tseq_send_order;\n\tstruct list_head\tcmd_datain_node;\n} ____cacheline_aligned;\n\nstruct iscsi_ooo_cmdsn {\n\tu16\t\t\tcid;\n\tu32\t\t\tbatch_count;\n\tu32\t\t\tcmdsn;\n\tu32\t\t\texp_cmdsn;\n\tstruct iscsit_cmd\t*cmd;\n\tstruct list_head\tooo_list;\n} ____cacheline_aligned;\n\nstruct iscsi_datain {\n\tu8\t\t\tflags;\n\tu32\t\t\tdata_sn;\n\tu32\t\t\tlength;\n\tu32\t\t\toffset;\n} ____cacheline_aligned;\n\nstruct iscsi_r2t {\n\tint\t\t\tseq_complete;\n\tint\t\t\trecovery_r2t;\n\tint\t\t\tsent_r2t;\n\tu32\t\t\tr2t_sn;\n\tu32\t\t\toffset;\n\tu32\t\t\ttarg_xfer_tag;\n\tu32\t\t\txfer_len;\n\tstruct list_head\tr2t_list;\n} ____cacheline_aligned;\n\nstruct iscsit_cmd {\n\tenum iscsi_timer_flags_table dataout_timer_flags;\n\t \n\tu8\t\t\tdataout_timeout_retries;\n\t \n\tu8\t\t\terror_recovery_count;\n\t \n\tenum cmd_i_state_table\tdeferred_i_state;\n\t \n\tenum cmd_i_state_table\ti_state;\n\t \n\tu8\t\t\timmediate_cmd;\n\t \n\tu8\t\t\timmediate_data;\n\t \n\tu8\t\t\tiscsi_opcode;\n\t \n\tu8\t\t\tiscsi_response;\n\t \n\tu8\t\t\tlogout_reason;\n\t \n\tu8\t\t\tlogout_response;\n\t \n\tu8\t\t\tmaxcmdsn_inc;\n\t \n\tu8\t\t\tunsolicited_data;\n\t \n\tu8\t\t\treject_reason;\n\t \n\tu16\t\t\tlogout_cid;\n\t \n\tenum cmd_flags_table\tcmd_flags;\n\t \n\titt_t\t\t\tinit_task_tag;\n\t \n\tu32\t\t\ttarg_xfer_tag;\n\t \n\tu32\t\t\tcmd_sn;\n\t \n\tu32\t\t\texp_stat_sn;\n\t \n\tu32\t\t\tstat_sn;\n\t \n\tu32\t\t\tdata_sn;\n\t \n\tu32\t\t\tr2t_sn;\n\t \n\tu32\t\t\tacked_data_sn;\n\t \n\tu32\t\t\tbuf_ptr_size;\n\t \n\tu32\t\t\tdata_crc;\n\t \n\tu32\t\t\toutstanding_r2ts;\n\t \n\tu32\t\t\tr2t_offset;\n\t \n\tu32\t\t\tiov_data_count;\n\tu32\t\t\torig_iov_data_count;\n\t \n\tu32\t\t\tiov_misc_count;\n\t \n\tu32\t\t\tpdu_count;\n\t \n\tu32\t\t\tpdu_send_order;\n\t \n\tu32\t\t\tpdu_start;\n\t \n\tu32\t\t\tseq_send_order;\n\t \n\tu32\t\t\tseq_count;\n\t \n\tu32\t\t\tseq_no;\n\t \n\tu32\t\t\tseq_start_offset;\n\t \n\tu32\t\t\tseq_end_offset;\n\t \n\tu32\t\t\tread_data_done;\n\t \n\tu32\t\t\twrite_data_done;\n\t \n\tu32\t\t\tfirst_burst_len;\n\t \n\tu32\t\t\tnext_burst_len;\n\t \n\tu32\t\t\ttx_size;\n\t \n\tvoid\t\t\t*buf_ptr;\n\t \n\tvoid\t\t\t*text_in_ptr;\n\t \n\tenum dma_data_direction\tdata_direction;\n\t \n\tunsigned char\t\tpdu[ISCSI_HDR_LEN + ISCSI_CRC_LEN];\n\t \n\tatomic_t\t\timmed_queue_count;\n\tatomic_t\t\tresponse_queue_count;\n\tspinlock_t\t\tdatain_lock;\n\tspinlock_t\t\tdataout_timeout_lock;\n\t \n\tspinlock_t\t\tistate_lock;\n\t \n\tspinlock_t\t\terror_lock;\n\t \n\tspinlock_t\t\tr2t_lock;\n\t \n\tstruct list_head\tdatain_list;\n\t \n\tstruct list_head\tcmd_r2t_list;\n\t \n\tstruct timer_list\tdataout_timer;\n\t \n\tstruct kvec\t\t*iov_data;\n\tvoid\t\t\t*overflow_buf;\n\t \n#define ISCSI_MISC_IOVECS\t\t\t5\n\tstruct kvec\t\tiov_misc[ISCSI_MISC_IOVECS];\n\t \n\tstruct iscsi_pdu\t*pdu_list;\n\t \n\tstruct iscsi_pdu\t*pdu_ptr;\n\t \n\tstruct iscsi_seq\t*seq_list;\n\t \n\tstruct iscsi_seq\t*seq_ptr;\n\t \n\tstruct iscsi_tmr_req\t*tmr_req;\n\t \n\tstruct iscsit_conn\t*conn;\n\t \n\tstruct iscsi_conn_recovery *cr;\n\t \n\tstruct iscsit_session\t*sess;\n\t \n\tstruct list_head\ti_conn_node;\n\t \n\tstruct se_cmd\t\tse_cmd;\n\t \n#define ISCSI_SENSE_BUFFER_LEN          (TRANSPORT_SENSE_BUFFER + 2)\n\tunsigned char\t\tsense_buffer[ISCSI_SENSE_BUFFER_LEN];\n\n\tu32\t\t\tpadding;\n\tu8\t\t\tpad_bytes[4];\n\n\tstruct scatterlist\t*first_data_sg;\n\tu32\t\t\tfirst_data_sg_off;\n\tu32\t\t\tkmapped_nents;\n\tsense_reason_t\t\tsense_reason;\n}  ____cacheline_aligned;\n\nstruct iscsi_tmr_req {\n\tbool\t\t\ttask_reassign:1;\n\tu32\t\t\texp_data_sn;\n\tstruct iscsit_cmd\t*ref_cmd;\n\tstruct iscsi_conn_recovery *conn_recovery;\n\tstruct se_tmr_req\t*se_tmr_req;\n};\n\nstruct iscsit_conn {\n\twait_queue_head_t\tqueues_wq;\n\t \n\tu8\t\t\tauth_complete;\n\t \n\tu8\t\t\tconn_state;\n\tu8\t\t\tconn_logout_reason;\n\tu8\t\t\tnetwork_transport;\n\tenum iscsi_timer_flags_table nopin_timer_flags;\n\tenum iscsi_timer_flags_table nopin_response_timer_flags;\n\t \n\tu8\t\t\twhich_thread;\n\t \n\tu16\t\t\tcid;\n\t \n\tu16\t\t\tlogin_port;\n\tint\t\t\tnet_size;\n\tint\t\t\tlogin_family;\n\tu32\t\t\tauth_id;\n\tu32\t\t\tconn_flags;\n\t \n\titt_t\t\t\tlogin_itt;\n\tu32\t\t\texp_statsn;\n\t \n\tu32\t\t\tstat_sn;\n\tstruct sockaddr_storage login_sockaddr;\n\tstruct sockaddr_storage local_sockaddr;\n\tint\t\t\tconn_usage_count;\n\tint\t\t\tconn_waiting_on_uc;\n\tatomic_t\t\tcheck_immediate_queue;\n\tatomic_t\t\tconn_logout_remove;\n\tatomic_t\t\tconnection_exit;\n\tatomic_t\t\tconnection_recovery;\n\tatomic_t\t\tconnection_reinstatement;\n\tatomic_t\t\tconnection_wait_rcfr;\n\tatomic_t\t\tsleep_on_conn_wait_comp;\n\tatomic_t\t\ttransport_failed;\n\tstruct completion\tconn_post_wait_comp;\n\tstruct completion\tconn_wait_comp;\n\tstruct completion\tconn_wait_rcfr_comp;\n\tstruct completion\tconn_waiting_on_uc_comp;\n\tstruct completion\tconn_logout_comp;\n\tstruct completion\ttx_half_close_comp;\n\tstruct completion\trx_half_close_comp;\n\t \n\tstruct socket\t\t*sock;\n\tvoid\t\t\t(*orig_data_ready)(struct sock *);\n\tvoid\t\t\t(*orig_state_change)(struct sock *);\n#define LOGIN_FLAGS_READY\t\t0\n#define LOGIN_FLAGS_INITIAL_PDU\t\t1\n#define LOGIN_FLAGS_READ_ACTIVE\t\t2\n#define LOGIN_FLAGS_WRITE_ACTIVE\t3\n#define LOGIN_FLAGS_CLOSED\t\t4\n#define LOGIN_FLAGS_WORKER_RUNNING\t5\n\tunsigned long\t\tlogin_flags;\n\tstruct delayed_work\tlogin_work;\n\tstruct iscsi_login\t*login;\n\tstruct timer_list\tnopin_timer;\n\tstruct timer_list\tnopin_response_timer;\n\tstruct timer_list\tlogin_timer;\n\tstruct task_struct\t*login_kworker;\n\t \n\tspinlock_t\t\tcmd_lock;\n\tspinlock_t\t\tconn_usage_lock;\n\tspinlock_t\t\timmed_queue_lock;\n\tspinlock_t\t\tnopin_timer_lock;\n\tspinlock_t\t\tresponse_queue_lock;\n\tspinlock_t\t\tstate_lock;\n\tspinlock_t\t\tlogin_timer_lock;\n\tspinlock_t\t\tlogin_worker_lock;\n\t \n\tstruct ahash_request\t*conn_rx_hash;\n\tstruct ahash_request\t*conn_tx_hash;\n\t \n\tcpumask_var_t\t\tconn_cpumask;\n\tcpumask_var_t\t\tallowed_cpumask;\n\tunsigned int\t\tconn_rx_reset_cpumask:1;\n\tunsigned int\t\tconn_tx_reset_cpumask:1;\n\t \n\tstruct list_head\tconn_cmd_list;\n\tstruct list_head\timmed_queue_list;\n\tstruct list_head\tresponse_queue_list;\n\tstruct iscsi_conn_ops\t*conn_ops;\n\tstruct iscsi_login\t*conn_login;\n\tstruct iscsit_transport *conn_transport;\n\tstruct iscsi_param_list\t*param_list;\n\t \n\tvoid\t\t\t*auth_protocol;\n\tvoid\t\t\t*context;\n\tstruct iscsi_login_thread_s *login_thread;\n\tstruct iscsi_portal_group *tpg;\n\tstruct iscsi_tpg_np\t*tpg_np;\n\t \n\tstruct iscsit_session\t*sess;\n\tstruct target_cmd_counter *cmd_cnt;\n\tint\t\t\tbitmap_id;\n\tint\t\t\trx_thread_active;\n\tstruct task_struct\t*rx_thread;\n\tstruct completion\trx_login_comp;\n\tint\t\t\ttx_thread_active;\n\tstruct task_struct\t*tx_thread;\n\t \n\tstruct list_head\tconn_list;\n} ____cacheline_aligned;\n\nstruct iscsi_conn_recovery {\n\tu16\t\t\tcid;\n\tu32\t\t\tcmd_count;\n\tu32\t\t\tmaxrecvdatasegmentlength;\n\tu32\t\t\tmaxxmitdatasegmentlength;\n\tint\t\t\tready_for_reallegiance;\n\tstruct list_head\tconn_recovery_cmd_list;\n\tspinlock_t\t\tconn_recovery_cmd_lock;\n\tstruct timer_list\ttime2retain_timer;\n\tstruct iscsit_session\t*sess;\n\tstruct list_head\tcr_list;\n}  ____cacheline_aligned;\n\nstruct iscsit_session {\n\tu8\t\t\tinitiator_vendor;\n\tu8\t\t\tisid[6];\n\tenum iscsi_timer_flags_table time2retain_timer_flags;\n\tu8\t\t\tversion_active;\n\tu16\t\t\tcid_called;\n\tu16\t\t\tconn_recovery_count;\n\tu16\t\t\ttsih;\n\t \n\tu32\t\t\tsession_state;\n\t \n\titt_t\t\t\tinit_task_tag;\n\t \n\tu32\t\t\ttarg_xfer_tag;\n\tu32\t\t\tcmdsn_window;\n\n\t \n\tstruct mutex\t\tcmdsn_mutex;\n\t \n\tu32\t\t\texp_cmd_sn;\n\t \n\tatomic_t\t\tmax_cmd_sn;\n\tstruct list_head\tsess_ooo_cmdsn_list;\n\n\t \n\tu32\t\t\tsid;\n\tchar\t\t\tauth_type[8];\n\t \n\tint\t\t\tsession_index;\n\t \n\tint\t\t\tsession_usage_count;\n\tint\t\t\tsession_waiting_on_uc;\n\tatomic_long_t\t\tcmd_pdus;\n\tatomic_long_t\t\trsp_pdus;\n\tatomic_long_t\t\ttx_data_octets;\n\tatomic_long_t\t\trx_data_octets;\n\tatomic_long_t\t\tconn_digest_errors;\n\tatomic_long_t\t\tconn_timeout_errors;\n\tu64\t\t\tcreation_time;\n\t \n\tatomic_t\t\tnconn;\n\tatomic_t\t\tsession_continuation;\n\tatomic_t\t\tsession_fall_back_to_erl0;\n\tatomic_t\t\tsession_logout;\n\tatomic_t\t\tsession_reinstatement;\n\tatomic_t\t\tsession_stop_active;\n\tatomic_t\t\tsession_close;\n\t \n\tstruct list_head\tsess_conn_list;\n\tstruct list_head\tcr_active_list;\n\tstruct list_head\tcr_inactive_list;\n\tspinlock_t\t\tconn_lock;\n\tspinlock_t\t\tcr_a_lock;\n\tspinlock_t\t\tcr_i_lock;\n\tspinlock_t\t\tsession_usage_lock;\n\tspinlock_t\t\tttt_lock;\n\tstruct completion\tasync_msg_comp;\n\tstruct completion\treinstatement_comp;\n\tstruct completion\tsession_wait_comp;\n\tstruct completion\tsession_waiting_on_uc_comp;\n\tstruct timer_list\ttime2retain_timer;\n\tstruct iscsi_sess_ops\t*sess_ops;\n\tstruct se_session\t*se_sess;\n\tstruct iscsi_portal_group *tpg;\n} ____cacheline_aligned;\n\nstruct iscsi_login {\n\tu8 auth_complete;\n\tu8 checked_for_existing;\n\tu8 current_stage;\n\tu8 leading_connection;\n\tu8 first_request;\n\tu8 version_min;\n\tu8 version_max;\n\tu8 login_complete;\n\tu8 login_failed;\n\tbool zero_tsih;\n\tchar isid[6];\n\tu32 cmd_sn;\n\titt_t init_task_tag;\n\tu32 initial_exp_statsn;\n\tu32 rsp_length;\n\tu16 cid;\n\tu16 tsih;\n\tchar req[ISCSI_HDR_LEN];\n\tchar rsp[ISCSI_HDR_LEN];\n\tchar *req_buf;\n\tchar *rsp_buf;\n\tstruct iscsit_conn *conn;\n\tstruct iscsi_np *np;\n} ____cacheline_aligned;\n\nstruct iscsi_node_attrib {\n\ts32\t\t\tauthentication;\n\tu32\t\t\tdataout_timeout;\n\tu32\t\t\tdataout_timeout_retries;\n\tu32\t\t\tdefault_erl;\n\tu32\t\t\tnopin_timeout;\n\tu32\t\t\tnopin_response_timeout;\n\tu32\t\t\trandom_datain_pdu_offsets;\n\tu32\t\t\trandom_datain_seq_offsets;\n\tu32\t\t\trandom_r2t_offsets;\n\tu32\t\t\ttmr_cold_reset;\n\tu32\t\t\ttmr_warm_reset;\n\tstruct iscsi_node_acl *nacl;\n};\n\nstruct se_dev_entry_s;\n\nstruct iscsi_node_auth {\n\tenum naf_flags_table\tnaf_flags;\n\tint\t\t\tauthenticate_target;\n\t \n\tint\t\t\tenforce_discovery_auth;\n#define MAX_USER_LEN\t\t\t\t256\n#define MAX_PASS_LEN\t\t\t\t256\n\tchar\t\t\tuserid[MAX_USER_LEN];\n\tchar\t\t\tpassword[MAX_PASS_LEN];\n\tchar\t\t\tuserid_mutual[MAX_USER_LEN];\n\tchar\t\t\tpassword_mutual[MAX_PASS_LEN];\n};\n\n#include \"iscsi_target_stat.h\"\n\nstruct iscsi_node_stat_grps {\n\tstruct config_group\tiscsi_sess_stats_group;\n\tstruct config_group\tiscsi_conn_stats_group;\n};\n\nstruct iscsi_node_acl {\n\tstruct se_node_acl\tse_node_acl;\n\tstruct iscsi_node_attrib node_attrib;\n\tstruct iscsi_node_auth\tnode_auth;\n\tstruct iscsi_node_stat_grps node_stat_grps;\n};\n\nstatic inline struct iscsi_node_acl *\nto_iscsi_nacl(struct se_node_acl *se_nacl)\n{\n\treturn container_of(se_nacl, struct iscsi_node_acl, se_node_acl);\n}\n\nstruct iscsi_tpg_attrib {\n\tu32\t\t\tauthentication;\n\tu32\t\t\tlogin_timeout;\n\tu32\t\t\tgenerate_node_acls;\n\tu32\t\t\tcache_dynamic_acls;\n\tu32\t\t\tdefault_cmdsn_depth;\n\tu32\t\t\tdemo_mode_write_protect;\n\tu32\t\t\tprod_mode_write_protect;\n\tu32\t\t\tdemo_mode_discovery;\n\tu32\t\t\tdefault_erl;\n\tu8\t\t\tt10_pi;\n\tu32\t\t\tfabric_prot_type;\n\tu32\t\t\ttpg_enabled_sendtargets;\n\tu32\t\t\tlogin_keys_workaround;\n\tstruct iscsi_portal_group *tpg;\n};\n\nstruct iscsi_np {\n\tint\t\t\tnp_network_transport;\n\tint\t\t\tnp_ip_proto;\n\tint\t\t\tnp_sock_type;\n\tenum np_thread_state_table np_thread_state;\n\tbool                    enabled;\n\tatomic_t\t\tnp_reset_count;\n\tu32\t\t\tnp_exports;\n\tenum np_flags_table\tnp_flags;\n\tspinlock_t\t\tnp_thread_lock;\n\tstruct completion\tnp_restart_comp;\n\tstruct socket\t\t*np_socket;\n\tstruct sockaddr_storage np_sockaddr;\n\tstruct task_struct\t*np_thread;\n\tvoid\t\t\t*np_context;\n\tstruct iscsit_transport *np_transport;\n\tstruct list_head\tnp_list;\n} ____cacheline_aligned;\n\nstruct iscsi_tpg_np {\n\tstruct iscsi_np\t\t*tpg_np;\n\tstruct iscsi_portal_group *tpg;\n\tstruct iscsi_tpg_np\t*tpg_np_parent;\n\tstruct list_head\ttpg_np_list;\n\tstruct list_head\ttpg_np_child_list;\n\tstruct list_head\ttpg_np_parent_list;\n\tstruct se_tpg_np\tse_tpg_np;\n\tspinlock_t\t\ttpg_np_parent_lock;\n\tstruct completion\ttpg_np_comp;\n\tstruct kref\t\ttpg_np_kref;\n};\n\nstruct iscsi_portal_group {\n\tunsigned char\t\ttpg_chap_id;\n\t \n\tenum tpg_state_table\ttpg_state;\n\t \n\tu16\t\t\ttpgt;\n\t \n\tu16\t\t\tntsih;\n\t \n\tu32\t\t\tnsessions;\n\t \n\tu32\t\t\tnum_tpg_nps;\n\t \n\tu32\t\t\tsid;\n\t \n\tspinlock_t\t\ttpg_np_lock;\n\tspinlock_t\t\ttpg_state_lock;\n\tstruct se_portal_group tpg_se_tpg;\n\tstruct mutex\t\ttpg_access_lock;\n\tstruct semaphore\tnp_login_sem;\n\tstruct iscsi_tpg_attrib\ttpg_attrib;\n\tstruct iscsi_node_auth\ttpg_demo_auth;\n\t \n\tstruct iscsi_param_list\t*param_list;\n\tstruct iscsi_tiqn\t*tpg_tiqn;\n\tstruct list_head\ttpg_gnp_list;\n\tstruct list_head\ttpg_list;\n} ____cacheline_aligned;\n\nstatic inline struct iscsi_portal_group *\nto_iscsi_tpg(struct se_portal_group *se_tpg)\n{\n\treturn container_of(se_tpg, struct iscsi_portal_group, tpg_se_tpg);\n}\n\nstruct iscsi_wwn_stat_grps {\n\tstruct config_group\tiscsi_stat_group;\n\tstruct config_group\tiscsi_instance_group;\n\tstruct config_group\tiscsi_sess_err_group;\n\tstruct config_group\tiscsi_tgt_attr_group;\n\tstruct config_group\tiscsi_login_stats_group;\n\tstruct config_group\tiscsi_logout_stats_group;\n};\n\nstruct iscsi_tiqn {\n\tunsigned char\t\ttiqn[ISCSI_IQN_LEN];\n\tenum tiqn_state_table\ttiqn_state;\n\tint\t\t\ttiqn_access_count;\n\tu32\t\t\ttiqn_active_tpgs;\n\tu32\t\t\ttiqn_ntpgs;\n\tu32\t\t\ttiqn_num_tpg_nps;\n\tu32\t\t\ttiqn_nsessions;\n\tstruct list_head\ttiqn_list;\n\tstruct list_head\ttiqn_tpg_list;\n\tspinlock_t\t\ttiqn_state_lock;\n\tspinlock_t\t\ttiqn_tpg_lock;\n\tstruct se_wwn\t\ttiqn_wwn;\n\tstruct iscsi_wwn_stat_grps tiqn_stat_grps;\n\tint\t\t\ttiqn_index;\n\tstruct iscsi_sess_err_stats  sess_err_stats;\n\tstruct iscsi_login_stats     login_stats;\n\tstruct iscsi_logout_stats    logout_stats;\n} ____cacheline_aligned;\n\nstruct iscsit_global {\n\t \n\tu32\t\t\tin_shutdown;\n\tu32\t\t\tactive_ts;\n\t \n\tu32\t\t\tauth_id;\n\tu32\t\t\tinactive_ts;\n#define ISCSIT_BITMAP_BITS\t262144\n\t \n\tunsigned long\t\t*ts_bitmap;\n\tspinlock_t\t\tts_bitmap_lock;\n\tcpumask_var_t\t\tallowed_cpumask;\n\t \n\tstruct iscsi_node_acl\tdiscovery_acl;\n\tstruct iscsi_portal_group\t*discovery_tpg;\n};\n\nstatic inline u32 session_get_next_ttt(struct iscsit_session *session)\n{\n\tu32 ttt;\n\n\tspin_lock_bh(&session->ttt_lock);\n\tttt = session->targ_xfer_tag++;\n\tif (ttt == 0xFFFFFFFF)\n\t\tttt = session->targ_xfer_tag++;\n\tspin_unlock_bh(&session->ttt_lock);\n\n\treturn ttt;\n}\n\nextern struct iscsit_cmd *iscsit_find_cmd_from_itt(struct iscsit_conn *, itt_t);\n\nextern void iscsit_thread_check_cpumask(struct iscsit_conn *conn,\n\t\t\t\t\tstruct task_struct *p,\n\t\t\t\t\tint mode);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}