{
  "module_name": "target_core_fabric.h",
  "hash_id": "c639418de85315c05414d3795322f97ad3a05cbd23dd641b3be60035237858d7",
  "original_prompt": "Ingested from linux-6.6.14/include/target/target_core_fabric.h",
  "human_readable_source": " \n#ifndef TARGET_CORE_FABRIC_H\n#define TARGET_CORE_FABRIC_H\n\n#include <linux/configfs.h>\n#include <linux/types.h>\n#include <target/target_core_base.h>\n\nstruct target_core_fabric_ops {\n\tstruct module *module;\n\t \n\tconst char *fabric_alias;\n\t \n\tconst char *fabric_name;\n\tsize_t node_acl_size;\n\t \n\tu32 max_data_sg_nents;\n\tchar *(*tpg_get_wwn)(struct se_portal_group *);\n\tu16 (*tpg_get_tag)(struct se_portal_group *);\n\tu32 (*tpg_get_default_depth)(struct se_portal_group *);\n\tint (*tpg_check_demo_mode)(struct se_portal_group *);\n\tint (*tpg_check_demo_mode_cache)(struct se_portal_group *);\n\tint (*tpg_check_demo_mode_write_protect)(struct se_portal_group *);\n\tint (*tpg_check_prod_mode_write_protect)(struct se_portal_group *);\n\t \n\tint (*tpg_check_demo_mode_login_only)(struct se_portal_group *);\n\t \n\tint (*tpg_check_prot_fabric_only)(struct se_portal_group *);\n\tu32 (*tpg_get_inst_index)(struct se_portal_group *);\n\t \n\tint (*check_stop_free)(struct se_cmd *);\n\tvoid (*release_cmd)(struct se_cmd *);\n\tvoid (*close_session)(struct se_session *);\n\tu32 (*sess_get_index)(struct se_session *);\n\t \n\tu32 (*sess_get_initiator_sid)(struct se_session *,\n\t\t\t\t      unsigned char *, u32);\n\tint (*write_pending)(struct se_cmd *);\n\tvoid (*set_default_node_attributes)(struct se_node_acl *);\n\tint (*get_cmd_state)(struct se_cmd *);\n\tint (*queue_data_in)(struct se_cmd *);\n\tint (*queue_status)(struct se_cmd *);\n\tvoid (*queue_tm_rsp)(struct se_cmd *);\n\tvoid (*aborted_task)(struct se_cmd *);\n\t \n\tstruct se_wwn *(*fabric_make_wwn)(struct target_fabric_configfs *,\n\t\t\t\tstruct config_group *, const char *);\n\tvoid (*fabric_drop_wwn)(struct se_wwn *);\n\tvoid (*add_wwn_groups)(struct se_wwn *);\n\tstruct se_portal_group *(*fabric_make_tpg)(struct se_wwn *,\n\t\t\t\t\t\t   const char *);\n\tint (*fabric_enable_tpg)(struct se_portal_group *se_tpg, bool enable);\n\tvoid (*fabric_drop_tpg)(struct se_portal_group *);\n\tint (*fabric_post_link)(struct se_portal_group *,\n\t\t\t\tstruct se_lun *);\n\tvoid (*fabric_pre_unlink)(struct se_portal_group *,\n\t\t\t\tstruct se_lun *);\n\tstruct se_tpg_np *(*fabric_make_np)(struct se_portal_group *,\n\t\t\t\tstruct config_group *, const char *);\n\tvoid (*fabric_drop_np)(struct se_tpg_np *);\n\tint (*fabric_init_nodeacl)(struct se_node_acl *, const char *);\n\n\tstruct configfs_attribute **tfc_discovery_attrs;\n\tstruct configfs_attribute **tfc_wwn_attrs;\n\tstruct configfs_attribute **tfc_tpg_base_attrs;\n\tstruct configfs_attribute **tfc_tpg_np_base_attrs;\n\tstruct configfs_attribute **tfc_tpg_attrib_attrs;\n\tstruct configfs_attribute **tfc_tpg_auth_attrs;\n\tstruct configfs_attribute **tfc_tpg_param_attrs;\n\tstruct configfs_attribute **tfc_tpg_nacl_base_attrs;\n\tstruct configfs_attribute **tfc_tpg_nacl_attrib_attrs;\n\tstruct configfs_attribute **tfc_tpg_nacl_auth_attrs;\n\tstruct configfs_attribute **tfc_tpg_nacl_param_attrs;\n\n\t \n\tbool write_pending_must_be_called;\n};\n\nint target_register_template(const struct target_core_fabric_ops *fo);\nvoid target_unregister_template(const struct target_core_fabric_ops *fo);\n\nint target_depend_item(struct config_item *item);\nvoid target_undepend_item(struct config_item *item);\n\nstruct se_session *target_setup_session(struct se_portal_group *,\n\t\tunsigned int, unsigned int, enum target_prot_op prot_op,\n\t\tconst char *, void *,\n\t\tint (*callback)(struct se_portal_group *,\n\t\t\t\tstruct se_session *, void *));\nvoid target_remove_session(struct se_session *);\n\nvoid target_stop_cmd_counter(struct target_cmd_counter *cmd_cnt);\nvoid target_wait_for_cmds(struct target_cmd_counter *cmd_cnt);\nstruct target_cmd_counter *target_alloc_cmd_counter(void);\nvoid target_free_cmd_counter(struct target_cmd_counter *cmd_cnt);\n\nvoid transport_init_session(struct se_session *se_sess);\nstruct se_session *transport_alloc_session(enum target_prot_op);\nint transport_alloc_session_tags(struct se_session *, unsigned int,\n\t\tunsigned int);\nvoid\t__transport_register_session(struct se_portal_group *,\n\t\tstruct se_node_acl *, struct se_session *, void *);\nvoid\ttransport_register_session(struct se_portal_group *,\n\t\tstruct se_node_acl *, struct se_session *, void *);\nssize_t\ttarget_show_dynamic_sessions(struct se_portal_group *, char *);\nvoid\ttransport_free_session(struct se_session *);\nvoid\ttarget_spc2_release(struct se_node_acl *nacl);\nvoid\ttarget_put_nacl(struct se_node_acl *);\nvoid\ttransport_deregister_session_configfs(struct se_session *);\nvoid\ttransport_deregister_session(struct se_session *);\n\n\nvoid\t__target_init_cmd(struct se_cmd *cmd,\n\t\tconst struct target_core_fabric_ops *tfo,\n\t\tstruct se_session *sess, u32 data_length, int data_direction,\n\t\tint task_attr, unsigned char *sense_buffer, u64 unpacked_lun,\n\t\tstruct target_cmd_counter *cmd_cnt);\nint\ttarget_init_cmd(struct se_cmd *se_cmd, struct se_session *se_sess,\n\t\tunsigned char *sense, u64 unpacked_lun, u32 data_length,\n\t\tint task_attr, int data_dir, int flags);\nint\ttarget_submit_prep(struct se_cmd *se_cmd, unsigned char *cdb,\n\t\tstruct scatterlist *sgl, u32 sgl_count,\n\t\tstruct scatterlist *sgl_bidi, u32 sgl_bidi_count,\n\t\tstruct scatterlist *sgl_prot, u32 sgl_prot_count, gfp_t gfp);\nvoid\ttarget_submit(struct se_cmd *se_cmd);\nsense_reason_t transport_lookup_cmd_lun(struct se_cmd *);\nsense_reason_t target_cmd_init_cdb(struct se_cmd *se_cmd, unsigned char *cdb,\n\t\t\t\t   gfp_t gfp);\nsense_reason_t target_cmd_parse_cdb(struct se_cmd *);\nvoid\ttarget_submit_cmd(struct se_cmd *, struct se_session *, unsigned char *,\n\t\tunsigned char *, u64, u32, int, int, int);\nvoid\ttarget_queue_submission(struct se_cmd *se_cmd);\n\nint\ttarget_submit_tmr(struct se_cmd *se_cmd, struct se_session *se_sess,\n\t\tunsigned char *sense, u64 unpacked_lun,\n\t\tvoid *fabric_tmr_ptr, unsigned char tm_type,\n\t\tgfp_t, u64, int);\nint\ttransport_handle_cdb_direct(struct se_cmd *);\nsense_reason_t\ttransport_generic_new_cmd(struct se_cmd *);\n\nvoid\ttarget_put_cmd_and_wait(struct se_cmd *cmd);\nvoid\ttarget_execute_cmd(struct se_cmd *cmd);\n\nint\ttransport_generic_free_cmd(struct se_cmd *, int);\n\nbool\ttransport_wait_for_tasks(struct se_cmd *);\nint\ttransport_send_check_condition_and_sense(struct se_cmd *,\n\t\tsense_reason_t, int);\nint\ttarget_send_busy(struct se_cmd *cmd);\nint\ttarget_get_sess_cmd(struct se_cmd *, bool);\nint\ttarget_put_sess_cmd(struct se_cmd *);\nvoid\ttarget_stop_session(struct se_session *se_sess);\nvoid\ttarget_wait_for_sess_cmds(struct se_session *);\nvoid\ttarget_show_cmd(const char *pfx, struct se_cmd *cmd);\n\nint\tcore_alua_check_nonop_delay(struct se_cmd *);\n\nint\tcore_tmr_alloc_req(struct se_cmd *, void *, u8, gfp_t);\nvoid\tcore_tmr_release_req(struct se_tmr_req *);\nint\ttransport_generic_handle_tmr(struct se_cmd *);\nvoid\ttransport_generic_request_failure(struct se_cmd *, sense_reason_t);\nint\ttransport_lookup_tmr_lun(struct se_cmd *);\nvoid\tcore_allocate_nexus_loss_ua(struct se_node_acl *acl);\n\nstruct se_node_acl *core_tpg_get_initiator_node_acl(struct se_portal_group *tpg,\n\t\tunsigned char *);\nbool\ttarget_tpg_has_node_acl(struct se_portal_group *tpg,\n\t\tconst char *);\nstruct se_node_acl *core_tpg_check_initiator_node_acl(struct se_portal_group *,\n\t\tunsigned char *);\nint\tcore_tpg_set_initiator_node_queue_depth(struct se_node_acl *, u32);\nint\tcore_tpg_set_initiator_node_tag(struct se_portal_group *,\n\t\tstruct se_node_acl *, const char *);\nint\tcore_tpg_register(struct se_wwn *, struct se_portal_group *, int);\nint\tcore_tpg_deregister(struct se_portal_group *);\n\nint\ttarget_alloc_sgl(struct scatterlist **sgl, unsigned int *nents,\n\t\tu32 length, bool zero_page, bool chainable);\nvoid\ttarget_free_sgl(struct scatterlist *sgl, int nents);\n\n \nstatic inline enum dma_data_direction\ntarget_reverse_dma_direction(struct se_cmd *se_cmd)\n{\n\tif (se_cmd->se_cmd_flags & SCF_BIDI)\n\t\treturn DMA_BIDIRECTIONAL;\n\n\tswitch (se_cmd->data_direction) {\n\tcase DMA_TO_DEVICE:\n\t\treturn DMA_FROM_DEVICE;\n\tcase DMA_FROM_DEVICE:\n\t\treturn DMA_TO_DEVICE;\n\tcase DMA_NONE:\n\tdefault:\n\t\treturn DMA_NONE;\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}