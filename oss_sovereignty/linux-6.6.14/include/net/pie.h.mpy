{
  "module_name": "pie.h",
  "hash_id": "144cb218e5d5406ffd5ee31f97de83f2f8b12984377f2f0e42065553bda623a0",
  "original_prompt": "Ingested from linux-6.6.14/include/net/pie.h",
  "human_readable_source": " \n#ifndef __NET_SCHED_PIE_H\n#define __NET_SCHED_PIE_H\n\n#include <linux/ktime.h>\n#include <linux/skbuff.h>\n#include <linux/types.h>\n#include <net/inet_ecn.h>\n#include <net/pkt_sched.h>\n\n#define MAX_PROB\t(U64_MAX >> BITS_PER_BYTE)\n#define DTIME_INVALID\tU64_MAX\n#define QUEUE_THRESHOLD\t16384\n#define DQCOUNT_INVALID\t-1\n#define PIE_SCALE\t8\n\n \nstruct pie_params {\n\tpsched_time_t target;\n\tu32 tupdate;\n\tu32 limit;\n\tu32 alpha;\n\tu32 beta;\n\tu8 ecn;\n\tu8 bytemode;\n\tu8 dq_rate_estimator;\n};\n\n \nstruct pie_vars {\n\tpsched_time_t qdelay;\n\tpsched_time_t qdelay_old;\n\tpsched_time_t burst_time;\n\tpsched_time_t dq_tstamp;\n\tu64 prob;\n\tu64 accu_prob;\n\tu64 dq_count;\n\tu32 avg_dq_rate;\n\tu32 backlog_old;\n};\n\n \nstruct pie_stats {\n\tu32 packets_in;\n\tu32 dropped;\n\tu32 overlimit;\n\tu32 ecn_mark;\n\tu32 maxq;\n};\n\n \nstruct pie_skb_cb {\n\tpsched_time_t enqueue_time;\n\tu32 mem_usage;\n};\n\nstatic inline void pie_params_init(struct pie_params *params)\n{\n\tparams->target = PSCHED_NS2TICKS(15 * NSEC_PER_MSEC);\t \n\tparams->tupdate = usecs_to_jiffies(15 * USEC_PER_MSEC);\t \n\tparams->limit = 1000;\n\tparams->alpha = 2;\n\tparams->beta = 20;\n\tparams->ecn = false;\n\tparams->bytemode = false;\n\tparams->dq_rate_estimator = false;\n}\n\nstatic inline void pie_vars_init(struct pie_vars *vars)\n{\n\tvars->burst_time = PSCHED_NS2TICKS(150 * NSEC_PER_MSEC);  \n\tvars->dq_tstamp = DTIME_INVALID;\n\tvars->accu_prob = 0;\n\tvars->dq_count = DQCOUNT_INVALID;\n\tvars->avg_dq_rate = 0;\n}\n\nstatic inline struct pie_skb_cb *get_pie_cb(const struct sk_buff *skb)\n{\n\tqdisc_cb_private_validate(skb, sizeof(struct pie_skb_cb));\n\treturn (struct pie_skb_cb *)qdisc_skb_cb(skb)->data;\n}\n\nstatic inline psched_time_t pie_get_enqueue_time(const struct sk_buff *skb)\n{\n\treturn get_pie_cb(skb)->enqueue_time;\n}\n\nstatic inline void pie_set_enqueue_time(struct sk_buff *skb)\n{\n\tget_pie_cb(skb)->enqueue_time = psched_get_time();\n}\n\nbool pie_drop_early(struct Qdisc *sch, struct pie_params *params,\n\t\t    struct pie_vars *vars, u32 backlog, u32 packet_size);\n\nvoid pie_process_dequeue(struct sk_buff *skb, struct pie_params *params,\n\t\t\t struct pie_vars *vars, u32 backlog);\n\nvoid pie_calculate_probability(struct pie_params *params, struct pie_vars *vars,\n\t\t\t       u32 backlog);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}