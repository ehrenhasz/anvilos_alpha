{
  "module_name": "snmp.h",
  "hash_id": "df825cac79c9cb0816741f9ea984d67b4bd6882da1f9f7acec89c8e6fac12eae",
  "original_prompt": "Ingested from linux-6.6.14/include/net/snmp.h",
  "human_readable_source": " \n \n \n#ifndef _SNMP_H\n#define _SNMP_H\n\n#include <linux/cache.h>\n#include <linux/snmp.h>\n#include <linux/smp.h>\n\n \n \nstruct snmp_mib {\n\tconst char *name;\n\tint entry;\n};\n\n#define SNMP_MIB_ITEM(_name,_entry)\t{\t\\\n\t.name = _name,\t\t\t\t\\\n\t.entry = _entry,\t\t\t\\\n}\n\n#define SNMP_MIB_SENTINEL {\t\\\n\t.name = NULL,\t\t\\\n\t.entry = 0,\t\t\\\n}\n\n \n#include <linux/u64_stats_sync.h>\n\n \n#define IPSTATS_MIB_MAX\t__IPSTATS_MIB_MAX\nstruct ipstats_mib {\n\t \n\tu64\t\tmibs[IPSTATS_MIB_MAX];\n\tstruct u64_stats_sync syncp;\n};\n\n \n#define ICMP_MIB_MAX\t__ICMP_MIB_MAX\nstruct icmp_mib {\n\tunsigned long\tmibs[ICMP_MIB_MAX];\n};\n\n#define ICMPMSG_MIB_MAX\t__ICMPMSG_MIB_MAX\nstruct icmpmsg_mib {\n\tatomic_long_t\tmibs[ICMPMSG_MIB_MAX];\n};\n\n \n#define ICMP6_MIB_MAX\t__ICMP6_MIB_MAX\n \nstruct icmpv6_mib {\n\tunsigned long\tmibs[ICMP6_MIB_MAX];\n};\n \nstruct icmpv6_mib_device {\n\tatomic_long_t\tmibs[ICMP6_MIB_MAX];\n};\n\n#define ICMP6MSG_MIB_MAX  __ICMP6MSG_MIB_MAX\n \nstruct icmpv6msg_mib {\n\tatomic_long_t\tmibs[ICMP6MSG_MIB_MAX];\n};\n \nstruct icmpv6msg_mib_device {\n\tatomic_long_t\tmibs[ICMP6MSG_MIB_MAX];\n};\n\n\n \n#define TCP_MIB_MAX\t__TCP_MIB_MAX\nstruct tcp_mib {\n\tunsigned long\tmibs[TCP_MIB_MAX];\n};\n\n \n#define UDP_MIB_MAX\t__UDP_MIB_MAX\nstruct udp_mib {\n\tunsigned long\tmibs[UDP_MIB_MAX];\n};\n\n \n#define LINUX_MIB_MAX\t__LINUX_MIB_MAX\nstruct linux_mib {\n\tunsigned long\tmibs[LINUX_MIB_MAX];\n};\n\n \n#define LINUX_MIB_XFRMMAX\t__LINUX_MIB_XFRMMAX\nstruct linux_xfrm_mib {\n\tunsigned long\tmibs[LINUX_MIB_XFRMMAX];\n};\n\n \n#define LINUX_MIB_TLSMAX\t__LINUX_MIB_TLSMAX\nstruct linux_tls_mib {\n\tunsigned long\tmibs[LINUX_MIB_TLSMAX];\n};\n\n#define DEFINE_SNMP_STAT(type, name)\t\\\n\t__typeof__(type) __percpu *name\n#define DEFINE_SNMP_STAT_ATOMIC(type, name)\t\\\n\t__typeof__(type) *name\n#define DECLARE_SNMP_STAT(type, name)\t\\\n\textern __typeof__(type) __percpu *name\n\n#define __SNMP_INC_STATS(mib, field)\t\\\n\t\t\t__this_cpu_inc(mib->mibs[field])\n\n#define SNMP_INC_STATS_ATOMIC_LONG(mib, field)\t\\\n\t\t\tatomic_long_inc(&mib->mibs[field])\n\n#define SNMP_INC_STATS(mib, field)\t\\\n\t\t\tthis_cpu_inc(mib->mibs[field])\n\n#define SNMP_DEC_STATS(mib, field)\t\\\n\t\t\tthis_cpu_dec(mib->mibs[field])\n\n#define __SNMP_ADD_STATS(mib, field, addend)\t\\\n\t\t\t__this_cpu_add(mib->mibs[field], addend)\n\n#define SNMP_ADD_STATS(mib, field, addend)\t\\\n\t\t\tthis_cpu_add(mib->mibs[field], addend)\n#define SNMP_UPD_PO_STATS(mib, basefield, addend)\t\\\n\tdo { \\\n\t\t__typeof__((mib->mibs) + 0) ptr = mib->mibs;\t\\\n\t\tthis_cpu_inc(ptr[basefield##PKTS]);\t\t\\\n\t\tthis_cpu_add(ptr[basefield##OCTETS], addend);\t\\\n\t} while (0)\n#define __SNMP_UPD_PO_STATS(mib, basefield, addend)\t\\\n\tdo { \\\n\t\t__typeof__((mib->mibs) + 0) ptr = mib->mibs;\t\\\n\t\t__this_cpu_inc(ptr[basefield##PKTS]);\t\t\\\n\t\t__this_cpu_add(ptr[basefield##OCTETS], addend);\t\\\n\t} while (0)\n\n\n#if BITS_PER_LONG==32\n\n#define __SNMP_ADD_STATS64(mib, field, addend) \t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t__typeof__(*mib) *ptr = raw_cpu_ptr(mib);\t\t\\\n\t\tu64_stats_update_begin(&ptr->syncp);\t\t\t\\\n\t\tptr->mibs[field] += addend;\t\t\t\t\\\n\t\tu64_stats_update_end(&ptr->syncp);\t\t\t\\\n\t} while (0)\n\n#define SNMP_ADD_STATS64(mib, field, addend) \t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tlocal_bh_disable();\t\t\t\t\t\\\n\t\t__SNMP_ADD_STATS64(mib, field, addend);\t\t\t\\\n\t\tlocal_bh_enable();\t\t\t\t\\\n\t} while (0)\n\n#define __SNMP_INC_STATS64(mib, field) SNMP_ADD_STATS64(mib, field, 1)\n#define SNMP_INC_STATS64(mib, field) SNMP_ADD_STATS64(mib, field, 1)\n#define __SNMP_UPD_PO_STATS64(mib, basefield, addend)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t__typeof__(*mib) *ptr;\t\t\t\t\\\n\t\tptr = raw_cpu_ptr((mib));\t\t\t\t\\\n\t\tu64_stats_update_begin(&ptr->syncp);\t\t\t\\\n\t\tptr->mibs[basefield##PKTS]++;\t\t\t\t\\\n\t\tptr->mibs[basefield##OCTETS] += addend;\t\t\t\\\n\t\tu64_stats_update_end(&ptr->syncp);\t\t\t\\\n\t} while (0)\n#define SNMP_UPD_PO_STATS64(mib, basefield, addend)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tlocal_bh_disable();\t\t\t\t\t\\\n\t\t__SNMP_UPD_PO_STATS64(mib, basefield, addend);\t\t\\\n\t\tlocal_bh_enable();\t\t\t\t\\\n\t} while (0)\n#else\n#define __SNMP_INC_STATS64(mib, field)\t\t__SNMP_INC_STATS(mib, field)\n#define SNMP_INC_STATS64(mib, field)\t\tSNMP_INC_STATS(mib, field)\n#define SNMP_DEC_STATS64(mib, field)\t\tSNMP_DEC_STATS(mib, field)\n#define __SNMP_ADD_STATS64(mib, field, addend)\t__SNMP_ADD_STATS(mib, field, addend)\n#define SNMP_ADD_STATS64(mib, field, addend)\tSNMP_ADD_STATS(mib, field, addend)\n#define SNMP_UPD_PO_STATS64(mib, basefield, addend) SNMP_UPD_PO_STATS(mib, basefield, addend)\n#define __SNMP_UPD_PO_STATS64(mib, basefield, addend) __SNMP_UPD_PO_STATS(mib, basefield, addend)\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}