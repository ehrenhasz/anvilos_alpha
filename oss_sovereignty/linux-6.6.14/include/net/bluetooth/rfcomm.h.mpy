{
  "module_name": "rfcomm.h",
  "hash_id": "c51b0cc7ca041c133da006bfb91c8a34832552ee8979babada5401e9fa12f71b",
  "original_prompt": "Ingested from linux-6.6.14/include/net/bluetooth/rfcomm.h",
  "human_readable_source": " \n\n#include <linux/refcount.h>\n\n#ifndef __RFCOMM_H\n#define __RFCOMM_H\n\n#define RFCOMM_CONN_TIMEOUT (HZ * 30)\n#define RFCOMM_DISC_TIMEOUT (HZ * 20)\n#define RFCOMM_AUTH_TIMEOUT (HZ * 25)\n#define RFCOMM_IDLE_TIMEOUT (HZ * 2)\n\n#define RFCOMM_DEFAULT_MTU\t127\n#define RFCOMM_DEFAULT_CREDITS\t7\n\n#define RFCOMM_MAX_CREDITS\t40\n\n#define RFCOMM_SKB_HEAD_RESERVE\t8\n#define RFCOMM_SKB_TAIL_RESERVE\t2\n#define RFCOMM_SKB_RESERVE  (RFCOMM_SKB_HEAD_RESERVE + RFCOMM_SKB_TAIL_RESERVE)\n\n#define RFCOMM_SABM\t0x2f\n#define RFCOMM_DISC\t0x43\n#define RFCOMM_UA\t0x63\n#define RFCOMM_DM\t0x0f\n#define RFCOMM_UIH\t0xef\n\n#define RFCOMM_TEST\t0x08\n#define RFCOMM_FCON\t0x28\n#define RFCOMM_FCOFF\t0x18\n#define RFCOMM_MSC\t0x38\n#define RFCOMM_RPN\t0x24\n#define RFCOMM_RLS\t0x14\n#define RFCOMM_PN\t0x20\n#define RFCOMM_NSC\t0x04\n\n#define RFCOMM_V24_FC\t0x02\n#define RFCOMM_V24_RTC\t0x04\n#define RFCOMM_V24_RTR\t0x08\n#define RFCOMM_V24_IC\t0x40\n#define RFCOMM_V24_DV\t0x80\n\n#define RFCOMM_RPN_BR_2400\t0x0\n#define RFCOMM_RPN_BR_4800\t0x1\n#define RFCOMM_RPN_BR_7200\t0x2\n#define RFCOMM_RPN_BR_9600\t0x3\n#define RFCOMM_RPN_BR_19200\t0x4\n#define RFCOMM_RPN_BR_38400\t0x5\n#define RFCOMM_RPN_BR_57600\t0x6\n#define RFCOMM_RPN_BR_115200\t0x7\n#define RFCOMM_RPN_BR_230400\t0x8\n\n#define RFCOMM_RPN_DATA_5\t0x0\n#define RFCOMM_RPN_DATA_6\t0x1\n#define RFCOMM_RPN_DATA_7\t0x2\n#define RFCOMM_RPN_DATA_8\t0x3\n\n#define RFCOMM_RPN_STOP_1\t0\n#define RFCOMM_RPN_STOP_15\t1\n\n#define RFCOMM_RPN_PARITY_NONE\t0x0\n#define RFCOMM_RPN_PARITY_ODD\t0x1\n#define RFCOMM_RPN_PARITY_EVEN\t0x3\n#define RFCOMM_RPN_PARITY_MARK\t0x5\n#define RFCOMM_RPN_PARITY_SPACE\t0x7\n\n#define RFCOMM_RPN_FLOW_NONE\t0x00\n\n#define RFCOMM_RPN_XON_CHAR\t0x11\n#define RFCOMM_RPN_XOFF_CHAR\t0x13\n\n#define RFCOMM_RPN_PM_BITRATE\t\t0x0001\n#define RFCOMM_RPN_PM_DATA\t\t0x0002\n#define RFCOMM_RPN_PM_STOP\t\t0x0004\n#define RFCOMM_RPN_PM_PARITY\t\t0x0008\n#define RFCOMM_RPN_PM_PARITY_TYPE\t0x0010\n#define RFCOMM_RPN_PM_XON\t\t0x0020\n#define RFCOMM_RPN_PM_XOFF\t\t0x0040\n#define RFCOMM_RPN_PM_FLOW\t\t0x3F00\n\n#define RFCOMM_RPN_PM_ALL\t\t0x3F7F\n\nstruct rfcomm_hdr {\n\tu8 addr;\n\tu8 ctrl;\n\tu8 len;     \n} __packed;\n\nstruct rfcomm_cmd {\n\tu8 addr;\n\tu8 ctrl;\n\tu8 len;\n\tu8 fcs;\n} __packed;\n\nstruct rfcomm_mcc {\n\tu8 type;\n\tu8 len;\n} __packed;\n\nstruct rfcomm_pn {\n\tu8  dlci;\n\tu8  flow_ctrl;\n\tu8  priority;\n\tu8  ack_timer;\n\t__le16 mtu;\n\tu8  max_retrans;\n\tu8  credits;\n} __packed;\n\nstruct rfcomm_rpn {\n\tu8  dlci;\n\tu8  bit_rate;\n\tu8  line_settings;\n\tu8  flow_ctrl;\n\tu8  xon_char;\n\tu8  xoff_char;\n\t__le16 param_mask;\n} __packed;\n\nstruct rfcomm_rls {\n\tu8  dlci;\n\tu8  status;\n} __packed;\n\nstruct rfcomm_msc {\n\tu8  dlci;\n\tu8  v24_sig;\n} __packed;\n\n \n\nstruct rfcomm_session {\n\tstruct list_head list;\n\tstruct socket   *sock;\n\tstruct timer_list timer;\n\tunsigned long    state;\n\tunsigned long    flags;\n\tint              initiator;\n\n\t \n\tint    cfc;\n\tuint   mtu;\n\n\tstruct list_head dlcs;\n};\n\nstruct rfcomm_dlc {\n\tstruct list_head      list;\n\tstruct rfcomm_session *session;\n\tstruct sk_buff_head   tx_queue;\n\tstruct timer_list     timer;\n\n\tstruct mutex  lock;\n\tunsigned long state;\n\tunsigned long flags;\n\trefcount_t    refcnt;\n\tu8            dlci;\n\tu8            addr;\n\tu8            priority;\n\tu8            v24_sig;\n\tu8            remote_v24_sig;\n\tu8            mscex;\n\tu8            out;\n\tu8            sec_level;\n\tu8            role_switch;\n\tu32           defer_setup;\n\n\tuint          mtu;\n\tuint          cfc;\n\tuint          rx_credits;\n\tuint          tx_credits;\n\n\tvoid          *owner;\n\n\tvoid (*data_ready)(struct rfcomm_dlc *d, struct sk_buff *skb);\n\tvoid (*state_change)(struct rfcomm_dlc *d, int err);\n\tvoid (*modem_status)(struct rfcomm_dlc *d, u8 v24_sig);\n};\n\n \n#define RFCOMM_RX_THROTTLED 0\n#define RFCOMM_TX_THROTTLED 1\n#define RFCOMM_TIMED_OUT    2\n#define RFCOMM_MSC_PENDING  3\n#define RFCOMM_SEC_PENDING  4\n#define RFCOMM_AUTH_PENDING 5\n#define RFCOMM_AUTH_ACCEPT  6\n#define RFCOMM_AUTH_REJECT  7\n#define RFCOMM_DEFER_SETUP  8\n#define RFCOMM_ENC_DROP     9\n\n \n#define RFCOMM_SCHED_WAKEUP 31\n\n \n#define RFCOMM_MSCEX_TX     1\n#define RFCOMM_MSCEX_RX     2\n#define RFCOMM_MSCEX_OK     (RFCOMM_MSCEX_TX + RFCOMM_MSCEX_RX)\n\n \n#define RFCOMM_CFC_UNKNOWN  -1\n#define RFCOMM_CFC_DISABLED 0\n#define RFCOMM_CFC_ENABLED  RFCOMM_MAX_CREDITS\n\n \nint rfcomm_send_rpn(struct rfcomm_session *s, int cr, u8 dlci,\n\t\t\tu8 bit_rate, u8 data_bits, u8 stop_bits,\n\t\t\tu8 parity, u8 flow_ctrl_settings,\n\t\t\tu8 xon_char, u8 xoff_char, u16 param_mask);\n\n \nstruct rfcomm_dlc *rfcomm_dlc_alloc(gfp_t prio);\nvoid rfcomm_dlc_free(struct rfcomm_dlc *d);\nint  rfcomm_dlc_open(struct rfcomm_dlc *d, bdaddr_t *src, bdaddr_t *dst,\n\t\t\t\t\t\t\t\tu8 channel);\nint  rfcomm_dlc_close(struct rfcomm_dlc *d, int reason);\nint  rfcomm_dlc_send(struct rfcomm_dlc *d, struct sk_buff *skb);\nvoid rfcomm_dlc_send_noerror(struct rfcomm_dlc *d, struct sk_buff *skb);\nint  rfcomm_dlc_set_modem_status(struct rfcomm_dlc *d, u8 v24_sig);\nint  rfcomm_dlc_get_modem_status(struct rfcomm_dlc *d, u8 *v24_sig);\nvoid rfcomm_dlc_accept(struct rfcomm_dlc *d);\nstruct rfcomm_dlc *rfcomm_dlc_exists(bdaddr_t *src, bdaddr_t *dst, u8 channel);\n\n#define rfcomm_dlc_lock(d)     mutex_lock(&d->lock)\n#define rfcomm_dlc_unlock(d)   mutex_unlock(&d->lock)\n\nstatic inline void rfcomm_dlc_hold(struct rfcomm_dlc *d)\n{\n\trefcount_inc(&d->refcnt);\n}\n\nstatic inline void rfcomm_dlc_put(struct rfcomm_dlc *d)\n{\n\tif (refcount_dec_and_test(&d->refcnt))\n\t\trfcomm_dlc_free(d);\n}\n\nvoid __rfcomm_dlc_throttle(struct rfcomm_dlc *d);\nvoid __rfcomm_dlc_unthrottle(struct rfcomm_dlc *d);\n\nstatic inline void rfcomm_dlc_throttle(struct rfcomm_dlc *d)\n{\n\tif (!test_and_set_bit(RFCOMM_RX_THROTTLED, &d->flags))\n\t\t__rfcomm_dlc_throttle(d);\n}\n\nstatic inline void rfcomm_dlc_unthrottle(struct rfcomm_dlc *d)\n{\n\tif (test_and_clear_bit(RFCOMM_RX_THROTTLED, &d->flags))\n\t\t__rfcomm_dlc_unthrottle(d);\n}\n\n \nvoid   rfcomm_session_getaddr(struct rfcomm_session *s, bdaddr_t *src,\n\t\t\t\t\t\t\t\tbdaddr_t *dst);\n\n \nstruct sockaddr_rc {\n\tsa_family_t\trc_family;\n\tbdaddr_t\trc_bdaddr;\n\tu8\t\trc_channel;\n};\n\n#define RFCOMM_CONNINFO\t0x02\nstruct rfcomm_conninfo {\n\t__u16 hci_handle;\n\t__u8  dev_class[3];\n};\n\n#define RFCOMM_LM\t0x03\n#define RFCOMM_LM_MASTER\t0x0001\n#define RFCOMM_LM_AUTH\t\t0x0002\n#define RFCOMM_LM_ENCRYPT\t0x0004\n#define RFCOMM_LM_TRUSTED\t0x0008\n#define RFCOMM_LM_RELIABLE\t0x0010\n#define RFCOMM_LM_SECURE\t0x0020\n#define RFCOMM_LM_FIPS\t\t0x0040\n\n#define rfcomm_pi(sk) ((struct rfcomm_pinfo *) sk)\n\nstruct rfcomm_pinfo {\n\tstruct bt_sock bt;\n\tbdaddr_t src;\n\tbdaddr_t dst;\n\tstruct rfcomm_dlc   *dlc;\n\tu8     channel;\n\tu8     sec_level;\n\tu8     role_switch;\n};\n\nint  rfcomm_init_sockets(void);\nvoid rfcomm_cleanup_sockets(void);\n\nint  rfcomm_connect_ind(struct rfcomm_session *s, u8 channel,\n\t\t\t\t\t\t\tstruct rfcomm_dlc **d);\n\n \n#define RFCOMM_MAX_DEV  256\n\n#define RFCOMMCREATEDEV\t\t_IOW('R', 200, int)\n#define RFCOMMRELEASEDEV\t_IOW('R', 201, int)\n#define RFCOMMGETDEVLIST\t_IOR('R', 210, int)\n#define RFCOMMGETDEVINFO\t_IOR('R', 211, int)\n#define RFCOMMSTEALDLC\t\t_IOW('R', 220, int)\n\n \n#define RFCOMM_REUSE_DLC      0\n#define RFCOMM_RELEASE_ONHUP  1\n#define RFCOMM_HANGUP_NOW     2\n#define RFCOMM_TTY_ATTACHED   3\n#define RFCOMM_DEFUNCT_BIT4   4\t   \n\n \n#define RFCOMM_DEV_RELEASED   0\n#define RFCOMM_TTY_OWNED      1\n\nstruct rfcomm_dev_req {\n\ts16      dev_id;\n\tu32      flags;\n\tbdaddr_t src;\n\tbdaddr_t dst;\n\tu8       channel;\n};\n\nstruct rfcomm_dev_info {\n\ts16      id;\n\tu32      flags;\n\tu16      state;\n\tbdaddr_t src;\n\tbdaddr_t dst;\n\tu8       channel;\n};\n\nstruct rfcomm_dev_list_req {\n\tu16      dev_num;\n\tstruct   rfcomm_dev_info dev_info[];\n};\n\nint  rfcomm_dev_ioctl(struct sock *sk, unsigned int cmd, void __user *arg);\n\n#ifdef CONFIG_BT_RFCOMM_TTY\nint  rfcomm_init_ttys(void);\nvoid rfcomm_cleanup_ttys(void);\n#else\nstatic inline int rfcomm_init_ttys(void)\n{\n\treturn 0;\n}\nstatic inline void rfcomm_cleanup_ttys(void)\n{\n}\n#endif\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}