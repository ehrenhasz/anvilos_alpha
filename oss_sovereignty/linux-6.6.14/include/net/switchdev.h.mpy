{
  "module_name": "switchdev.h",
  "hash_id": "a6bbb776380ccb487496c14ac73fd254b1ed3acb40714a2ed730f1bd7318dcf4",
  "original_prompt": "Ingested from linux-6.6.14/include/net/switchdev.h",
  "human_readable_source": " \n \n#ifndef _LINUX_SWITCHDEV_H_\n#define _LINUX_SWITCHDEV_H_\n\n#include <linux/netdevice.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <net/ip_fib.h>\n\n#define SWITCHDEV_F_NO_RECURSE\t\tBIT(0)\n#define SWITCHDEV_F_SKIP_EOPNOTSUPP\tBIT(1)\n#define SWITCHDEV_F_DEFER\t\tBIT(2)\n\nenum switchdev_attr_id {\n\tSWITCHDEV_ATTR_ID_UNDEFINED,\n\tSWITCHDEV_ATTR_ID_PORT_STP_STATE,\n\tSWITCHDEV_ATTR_ID_PORT_MST_STATE,\n\tSWITCHDEV_ATTR_ID_PORT_BRIDGE_FLAGS,\n\tSWITCHDEV_ATTR_ID_PORT_PRE_BRIDGE_FLAGS,\n\tSWITCHDEV_ATTR_ID_PORT_MROUTER,\n\tSWITCHDEV_ATTR_ID_BRIDGE_AGEING_TIME,\n\tSWITCHDEV_ATTR_ID_BRIDGE_VLAN_FILTERING,\n\tSWITCHDEV_ATTR_ID_BRIDGE_VLAN_PROTOCOL,\n\tSWITCHDEV_ATTR_ID_BRIDGE_MC_DISABLED,\n\tSWITCHDEV_ATTR_ID_BRIDGE_MROUTER,\n\tSWITCHDEV_ATTR_ID_BRIDGE_MST,\n\tSWITCHDEV_ATTR_ID_MRP_PORT_ROLE,\n\tSWITCHDEV_ATTR_ID_VLAN_MSTI,\n};\n\nstruct switchdev_mst_state {\n\tu16 msti;\n\tu8 state;\n};\n\nstruct switchdev_brport_flags {\n\tunsigned long val;\n\tunsigned long mask;\n};\n\nstruct switchdev_vlan_msti {\n\tu16 vid;\n\tu16 msti;\n};\n\nstruct switchdev_attr {\n\tstruct net_device *orig_dev;\n\tenum switchdev_attr_id id;\n\tu32 flags;\n\tvoid *complete_priv;\n\tvoid (*complete)(struct net_device *dev, int err, void *priv);\n\tunion {\n\t\tu8 stp_state;\t\t\t\t \n\t\tstruct switchdev_mst_state mst_state;\t \n\t\tstruct switchdev_brport_flags brport_flags;  \n\t\tbool mrouter;\t\t\t\t \n\t\tclock_t ageing_time;\t\t\t \n\t\tbool vlan_filtering;\t\t\t \n\t\tu16 vlan_protocol;\t\t\t \n\t\tbool mst;\t\t\t\t \n\t\tbool mc_disabled;\t\t\t \n\t\tu8 mrp_port_role;\t\t\t \n\t\tstruct switchdev_vlan_msti vlan_msti;\t \n\t} u;\n};\n\nenum switchdev_obj_id {\n\tSWITCHDEV_OBJ_ID_UNDEFINED,\n\tSWITCHDEV_OBJ_ID_PORT_VLAN,\n\tSWITCHDEV_OBJ_ID_PORT_MDB,\n\tSWITCHDEV_OBJ_ID_HOST_MDB,\n\tSWITCHDEV_OBJ_ID_MRP,\n\tSWITCHDEV_OBJ_ID_RING_TEST_MRP,\n\tSWITCHDEV_OBJ_ID_RING_ROLE_MRP,\n\tSWITCHDEV_OBJ_ID_RING_STATE_MRP,\n\tSWITCHDEV_OBJ_ID_IN_TEST_MRP,\n\tSWITCHDEV_OBJ_ID_IN_ROLE_MRP,\n\tSWITCHDEV_OBJ_ID_IN_STATE_MRP,\n};\n\nstruct switchdev_obj {\n\tstruct list_head list;\n\tstruct net_device *orig_dev;\n\tenum switchdev_obj_id id;\n\tu32 flags;\n\tvoid *complete_priv;\n\tvoid (*complete)(struct net_device *dev, int err, void *priv);\n};\n\n \nstruct switchdev_obj_port_vlan {\n\tstruct switchdev_obj obj;\n\tu16 flags;\n\tu16 vid;\n\t \n\tbool changed;\n};\n\n#define SWITCHDEV_OBJ_PORT_VLAN(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_port_vlan, obj)\n\n \nstruct switchdev_obj_port_mdb {\n\tstruct switchdev_obj obj;\n\tunsigned char addr[ETH_ALEN];\n\tu16 vid;\n};\n\n#define SWITCHDEV_OBJ_PORT_MDB(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_port_mdb, obj)\n\n\n \nstruct switchdev_obj_mrp {\n\tstruct switchdev_obj obj;\n\tstruct net_device *p_port;\n\tstruct net_device *s_port;\n\tu32 ring_id;\n\tu16 prio;\n};\n\n#define SWITCHDEV_OBJ_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_mrp, obj)\n\n \nstruct switchdev_obj_ring_test_mrp {\n\tstruct switchdev_obj obj;\n\t \n\tu32 interval;\n\tu8 max_miss;\n\tu32 ring_id;\n\tu32 period;\n\tbool monitor;\n};\n\n#define SWITCHDEV_OBJ_RING_TEST_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_ring_test_mrp, obj)\n\n \nstruct switchdev_obj_ring_role_mrp {\n\tstruct switchdev_obj obj;\n\tu8 ring_role;\n\tu32 ring_id;\n\tu8 sw_backup;\n};\n\n#define SWITCHDEV_OBJ_RING_ROLE_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_ring_role_mrp, obj)\n\nstruct switchdev_obj_ring_state_mrp {\n\tstruct switchdev_obj obj;\n\tu8 ring_state;\n\tu32 ring_id;\n};\n\n#define SWITCHDEV_OBJ_RING_STATE_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_ring_state_mrp, obj)\n\n \nstruct switchdev_obj_in_test_mrp {\n\tstruct switchdev_obj obj;\n\t \n\tu32 interval;\n\tu32 in_id;\n\tu32 period;\n\tu8 max_miss;\n};\n\n#define SWITCHDEV_OBJ_IN_TEST_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_in_test_mrp, obj)\n\n \nstruct switchdev_obj_in_role_mrp {\n\tstruct switchdev_obj obj;\n\tstruct net_device *i_port;\n\tu32 ring_id;\n\tu16 in_id;\n\tu8 in_role;\n\tu8 sw_backup;\n};\n\n#define SWITCHDEV_OBJ_IN_ROLE_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_in_role_mrp, obj)\n\nstruct switchdev_obj_in_state_mrp {\n\tstruct switchdev_obj obj;\n\tu32 in_id;\n\tu8 in_state;\n};\n\n#define SWITCHDEV_OBJ_IN_STATE_MRP(OBJ) \\\n\tcontainer_of((OBJ), struct switchdev_obj_in_state_mrp, obj)\n\nstruct switchdev_brport {\n\tstruct net_device *dev;\n\tconst void *ctx;\n\tstruct notifier_block *atomic_nb;\n\tstruct notifier_block *blocking_nb;\n\tbool tx_fwd_offload;\n};\n\nenum switchdev_notifier_type {\n\tSWITCHDEV_FDB_ADD_TO_BRIDGE = 1,\n\tSWITCHDEV_FDB_DEL_TO_BRIDGE,\n\tSWITCHDEV_FDB_ADD_TO_DEVICE,\n\tSWITCHDEV_FDB_DEL_TO_DEVICE,\n\tSWITCHDEV_FDB_OFFLOADED,\n\tSWITCHDEV_FDB_FLUSH_TO_BRIDGE,\n\n\tSWITCHDEV_PORT_OBJ_ADD,  \n\tSWITCHDEV_PORT_OBJ_DEL,  \n\tSWITCHDEV_PORT_ATTR_SET,  \n\n\tSWITCHDEV_VXLAN_FDB_ADD_TO_BRIDGE,\n\tSWITCHDEV_VXLAN_FDB_DEL_TO_BRIDGE,\n\tSWITCHDEV_VXLAN_FDB_ADD_TO_DEVICE,\n\tSWITCHDEV_VXLAN_FDB_DEL_TO_DEVICE,\n\tSWITCHDEV_VXLAN_FDB_OFFLOADED,\n\n\tSWITCHDEV_BRPORT_OFFLOADED,\n\tSWITCHDEV_BRPORT_UNOFFLOADED,\n\tSWITCHDEV_BRPORT_REPLAY,\n};\n\nstruct switchdev_notifier_info {\n\tstruct net_device *dev;\n\tstruct netlink_ext_ack *extack;\n\tconst void *ctx;\n};\n\n \nstruct switchdev_notifier_fdb_info {\n\tstruct switchdev_notifier_info info;  \n\tconst unsigned char *addr;\n\tu16 vid;\n\tu8 added_by_user:1,\n\t   is_local:1,\n\t   locked:1,\n\t   offloaded:1;\n};\n\nstruct switchdev_notifier_port_obj_info {\n\tstruct switchdev_notifier_info info;  \n\tconst struct switchdev_obj *obj;\n\tbool handled;\n};\n\nstruct switchdev_notifier_port_attr_info {\n\tstruct switchdev_notifier_info info;  \n\tconst struct switchdev_attr *attr;\n\tbool handled;\n};\n\nstruct switchdev_notifier_brport_info {\n\tstruct switchdev_notifier_info info;  \n\tconst struct switchdev_brport brport;\n};\n\nstatic inline struct net_device *\nswitchdev_notifier_info_to_dev(const struct switchdev_notifier_info *info)\n{\n\treturn info->dev;\n}\n\nstatic inline struct netlink_ext_ack *\nswitchdev_notifier_info_to_extack(const struct switchdev_notifier_info *info)\n{\n\treturn info->extack;\n}\n\nstatic inline bool\nswitchdev_fdb_is_dynamically_learned(const struct switchdev_notifier_fdb_info *fdb_info)\n{\n\treturn !fdb_info->added_by_user && !fdb_info->is_local;\n}\n\n#ifdef CONFIG_NET_SWITCHDEV\n\nint switchdev_bridge_port_offload(struct net_device *brport_dev,\n\t\t\t\t  struct net_device *dev, const void *ctx,\n\t\t\t\t  struct notifier_block *atomic_nb,\n\t\t\t\t  struct notifier_block *blocking_nb,\n\t\t\t\t  bool tx_fwd_offload,\n\t\t\t\t  struct netlink_ext_ack *extack);\nvoid switchdev_bridge_port_unoffload(struct net_device *brport_dev,\n\t\t\t\t     const void *ctx,\n\t\t\t\t     struct notifier_block *atomic_nb,\n\t\t\t\t     struct notifier_block *blocking_nb);\nint switchdev_bridge_port_replay(struct net_device *brport_dev,\n\t\t\t\t struct net_device *dev, const void *ctx,\n\t\t\t\t struct notifier_block *atomic_nb,\n\t\t\t\t struct notifier_block *blocking_nb,\n\t\t\t\t struct netlink_ext_ack *extack);\n\nvoid switchdev_deferred_process(void);\nint switchdev_port_attr_set(struct net_device *dev,\n\t\t\t    const struct switchdev_attr *attr,\n\t\t\t    struct netlink_ext_ack *extack);\nint switchdev_port_obj_add(struct net_device *dev,\n\t\t\t   const struct switchdev_obj *obj,\n\t\t\t   struct netlink_ext_ack *extack);\nint switchdev_port_obj_del(struct net_device *dev,\n\t\t\t   const struct switchdev_obj *obj);\n\nint register_switchdev_notifier(struct notifier_block *nb);\nint unregister_switchdev_notifier(struct notifier_block *nb);\nint call_switchdev_notifiers(unsigned long val, struct net_device *dev,\n\t\t\t     struct switchdev_notifier_info *info,\n\t\t\t     struct netlink_ext_ack *extack);\n\nint register_switchdev_blocking_notifier(struct notifier_block *nb);\nint unregister_switchdev_blocking_notifier(struct notifier_block *nb);\nint call_switchdev_blocking_notifiers(unsigned long val, struct net_device *dev,\n\t\t\t\t      struct switchdev_notifier_info *info,\n\t\t\t\t      struct netlink_ext_ack *extack);\n\nint switchdev_handle_fdb_event_to_device(struct net_device *dev, unsigned long event,\n\t\tconst struct switchdev_notifier_fdb_info *fdb_info,\n\t\tbool (*check_cb)(const struct net_device *dev),\n\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\tint (*mod_cb)(struct net_device *dev, struct net_device *orig_dev,\n\t\t\t      unsigned long event, const void *ctx,\n\t\t\t      const struct switchdev_notifier_fdb_info *fdb_info));\n\nint switchdev_handle_port_obj_add(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*add_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj,\n\t\t\t\t      struct netlink_ext_ack *extack));\nint switchdev_handle_port_obj_add_foreign(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\t\tint (*add_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj,\n\t\t\t\t      struct netlink_ext_ack *extack));\nint switchdev_handle_port_obj_del(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*del_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj));\nint switchdev_handle_port_obj_del_foreign(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\t\tint (*del_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj));\n\nint switchdev_handle_port_attr_set(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_attr_info *port_attr_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*set_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_attr *attr,\n\t\t\t\t      struct netlink_ext_ack *extack));\n#else\n\nstatic inline int\nswitchdev_bridge_port_offload(struct net_device *brport_dev,\n\t\t\t      struct net_device *dev, const void *ctx,\n\t\t\t      struct notifier_block *atomic_nb,\n\t\t\t      struct notifier_block *blocking_nb,\n\t\t\t      bool tx_fwd_offload,\n\t\t\t      struct netlink_ext_ack *extack)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void\nswitchdev_bridge_port_unoffload(struct net_device *brport_dev,\n\t\t\t\tconst void *ctx,\n\t\t\t\tstruct notifier_block *atomic_nb,\n\t\t\t\tstruct notifier_block *blocking_nb)\n{\n}\n\nstatic inline void switchdev_deferred_process(void)\n{\n}\n\nstatic inline int switchdev_port_attr_set(struct net_device *dev,\n\t\t\t\t\t  const struct switchdev_attr *attr,\n\t\t\t\t\t  struct netlink_ext_ack *extack)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int switchdev_port_obj_add(struct net_device *dev,\n\t\t\t\t\t const struct switchdev_obj *obj,\n\t\t\t\t\t struct netlink_ext_ack *extack)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int switchdev_port_obj_del(struct net_device *dev,\n\t\t\t\t\t const struct switchdev_obj *obj)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int register_switchdev_notifier(struct notifier_block *nb)\n{\n\treturn 0;\n}\n\nstatic inline int unregister_switchdev_notifier(struct notifier_block *nb)\n{\n\treturn 0;\n}\n\nstatic inline int call_switchdev_notifiers(unsigned long val,\n\t\t\t\t\t   struct net_device *dev,\n\t\t\t\t\t   struct switchdev_notifier_info *info,\n\t\t\t\t\t   struct netlink_ext_ack *extack)\n{\n\treturn NOTIFY_DONE;\n}\n\nstatic inline int\nregister_switchdev_blocking_notifier(struct notifier_block *nb)\n{\n\treturn 0;\n}\n\nstatic inline int\nunregister_switchdev_blocking_notifier(struct notifier_block *nb)\n{\n\treturn 0;\n}\n\nstatic inline int\ncall_switchdev_blocking_notifiers(unsigned long val,\n\t\t\t\t  struct net_device *dev,\n\t\t\t\t  struct switchdev_notifier_info *info,\n\t\t\t\t  struct netlink_ext_ack *extack)\n{\n\treturn NOTIFY_DONE;\n}\n\nstatic inline int\nswitchdev_handle_fdb_event_to_device(struct net_device *dev, unsigned long event,\n\t\tconst struct switchdev_notifier_fdb_info *fdb_info,\n\t\tbool (*check_cb)(const struct net_device *dev),\n\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\tint (*mod_cb)(struct net_device *dev, struct net_device *orig_dev,\n\t\t\t      unsigned long event, const void *ctx,\n\t\t\t      const struct switchdev_notifier_fdb_info *fdb_info))\n{\n\treturn 0;\n}\n\nstatic inline int\nswitchdev_handle_port_obj_add(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*add_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj,\n\t\t\t\t      struct netlink_ext_ack *extack))\n{\n\treturn 0;\n}\n\nstatic inline int switchdev_handle_port_obj_add_foreign(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\t\tint (*add_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj,\n\t\t\t\t      struct netlink_ext_ack *extack))\n{\n\treturn 0;\n}\n\nstatic inline int\nswitchdev_handle_port_obj_del(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*del_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj))\n{\n\treturn 0;\n}\n\nstatic inline int\nswitchdev_handle_port_obj_del_foreign(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_obj_info *port_obj_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tbool (*foreign_dev_check_cb)(const struct net_device *dev,\n\t\t\t\t\t\t     const struct net_device *foreign_dev),\n\t\t\tint (*del_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_obj *obj))\n{\n\treturn 0;\n}\n\nstatic inline int\nswitchdev_handle_port_attr_set(struct net_device *dev,\n\t\t\tstruct switchdev_notifier_port_attr_info *port_attr_info,\n\t\t\tbool (*check_cb)(const struct net_device *dev),\n\t\t\tint (*set_cb)(struct net_device *dev, const void *ctx,\n\t\t\t\t      const struct switchdev_attr *attr,\n\t\t\t\t      struct netlink_ext_ack *extack))\n{\n\treturn 0;\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}