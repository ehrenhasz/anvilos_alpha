{
  "module_name": "seg6.h",
  "hash_id": "3403fb4dc5b3b69d724c3ac4e08e48c27b7066701f0c08718c8846e96fa20fb5",
  "original_prompt": "Ingested from linux-6.6.14/include/net/seg6.h",
  "human_readable_source": " \n \n\n#ifndef _NET_SEG6_H\n#define _NET_SEG6_H\n\n#include <linux/net.h>\n#include <linux/ipv6.h>\n#include <linux/seg6.h>\n#include <linux/rhashtable-types.h>\n\nstatic inline void update_csum_diff4(struct sk_buff *skb, __be32 from,\n\t\t\t\t     __be32 to)\n{\n\t__be32 diff[] = { ~from, to };\n\n\tskb->csum = ~csum_partial((char *)diff, sizeof(diff), ~skb->csum);\n}\n\nstatic inline void update_csum_diff16(struct sk_buff *skb, __be32 *from,\n\t\t\t\t      __be32 *to)\n{\n\t__be32 diff[] = {\n\t\t~from[0], ~from[1], ~from[2], ~from[3],\n\t\tto[0], to[1], to[2], to[3],\n\t};\n\n\tskb->csum = ~csum_partial((char *)diff, sizeof(diff), ~skb->csum);\n}\n\nstruct seg6_pernet_data {\n\tstruct mutex lock;\n\tstruct in6_addr __rcu *tun_src;\n#ifdef CONFIG_IPV6_SEG6_HMAC\n\tstruct rhashtable hmac_infos;\n#endif\n};\n\nstatic inline struct seg6_pernet_data *seg6_pernet(struct net *net)\n{\n#if IS_ENABLED(CONFIG_IPV6)\n\treturn net->ipv6.seg6_data;\n#else\n\treturn NULL;\n#endif\n}\n\nextern int seg6_init(void);\nextern void seg6_exit(void);\nextern int seg6_iptunnel_init(void);\nextern void seg6_iptunnel_exit(void);\nextern int seg6_local_init(void);\nextern void seg6_local_exit(void);\n\nextern bool seg6_validate_srh(struct ipv6_sr_hdr *srh, int len, bool reduced);\nextern struct ipv6_sr_hdr *seg6_get_srh(struct sk_buff *skb, int flags);\nextern void seg6_icmp_srh(struct sk_buff *skb, struct inet6_skb_parm *opt);\nextern int seg6_do_srh_encap(struct sk_buff *skb, struct ipv6_sr_hdr *osrh,\n\t\t\t     int proto);\nextern int seg6_do_srh_inline(struct sk_buff *skb, struct ipv6_sr_hdr *osrh);\nextern int seg6_lookup_nexthop(struct sk_buff *skb, struct in6_addr *nhaddr,\n\t\t\t       u32 tbl_id);\n\n \nstatic inline const struct in6_addr *seg6_get_daddr(struct sk_buff *skb,\n\t\t\t\t\t\t    struct inet6_skb_parm *opt)\n{\n\tstruct ipv6_sr_hdr *srh;\n\n\tif (opt->flags & IP6SKB_SEG6) {\n\t\tsrh = (struct ipv6_sr_hdr *)(skb->data + opt->srhoff);\n\t\treturn  &srh->segments[0];\n\t}\n\n\treturn NULL;\n}\n\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}