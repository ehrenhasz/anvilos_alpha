{
  "module_name": "ieee802154_netdev.h",
  "hash_id": "496b1775541ae7526b2f6545e2bf754fb07a84d75909853f4db6e8fed90a04d6",
  "original_prompt": "Ingested from linux-6.6.14/include/net/ieee802154_netdev.h",
  "human_readable_source": " \n \n\n#ifndef IEEE802154_NETDEVICE_H\n#define IEEE802154_NETDEVICE_H\n\n#define IEEE802154_REQUIRED_SIZE(struct_type, member) \\\n\t(offsetof(typeof(struct_type), member) + \\\n\tsizeof(((typeof(struct_type) *)(NULL))->member))\n\n#define IEEE802154_ADDR_OFFSET \\\n\toffsetof(typeof(struct sockaddr_ieee802154), addr)\n\n#define IEEE802154_MIN_NAMELEN (IEEE802154_ADDR_OFFSET + \\\n\tIEEE802154_REQUIRED_SIZE(struct ieee802154_addr_sa, addr_type))\n\n#define IEEE802154_NAMELEN_SHORT (IEEE802154_ADDR_OFFSET + \\\n\tIEEE802154_REQUIRED_SIZE(struct ieee802154_addr_sa, short_addr))\n\n#define IEEE802154_NAMELEN_LONG (IEEE802154_ADDR_OFFSET + \\\n\tIEEE802154_REQUIRED_SIZE(struct ieee802154_addr_sa, hwaddr))\n\n#include <net/af_ieee802154.h>\n#include <linux/netdevice.h>\n#include <linux/skbuff.h>\n#include <linux/ieee802154.h>\n\n#include <net/cfg802154.h>\n\nstruct ieee802154_beacon_hdr {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\tu16 beacon_order:4,\n\t    superframe_order:4,\n\t    final_cap_slot:4,\n\t    battery_life_ext:1,\n\t    reserved0:1,\n\t    pan_coordinator:1,\n\t    assoc_permit:1;\n\tu8  gts_count:3,\n\t    gts_reserved:4,\n\t    gts_permit:1;\n\tu8  pend_short_addr_count:3,\n\t    reserved1:1,\n\t    pend_ext_addr_count:3,\n\t    reserved2:1;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n\tu16 assoc_permit:1,\n\t    pan_coordinator:1,\n\t    reserved0:1,\n\t    battery_life_ext:1,\n\t    final_cap_slot:4,\n\t    superframe_order:4,\n\t    beacon_order:4;\n\tu8  gts_permit:1,\n\t    gts_reserved:4,\n\t    gts_count:3;\n\tu8  reserved2:1,\n\t    pend_ext_addr_count:3,\n\t    reserved1:1,\n\t    pend_short_addr_count:3;\n#else\n#error\t\"Please fix <asm/byteorder.h>\"\n#endif\n} __packed;\n\nstruct ieee802154_mac_cmd_pl {\n\tu8  cmd_id;\n} __packed;\n\nstruct ieee802154_sechdr {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\tu8 level:3,\n\t   key_id_mode:2,\n\t   reserved:3;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n\tu8 reserved:3,\n\t   key_id_mode:2,\n\t   level:3;\n#else\n#error\t\"Please fix <asm/byteorder.h>\"\n#endif\n\tu8 key_id;\n\t__le32 frame_counter;\n\tunion {\n\t\t__le32 short_src;\n\t\t__le64 extended_src;\n\t};\n};\n\nstruct ieee802154_hdr_fc {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\tu16 type:3,\n\t    security_enabled:1,\n\t    frame_pending:1,\n\t    ack_request:1,\n\t    intra_pan:1,\n\t    reserved:3,\n\t    dest_addr_mode:2,\n\t    version:2,\n\t    source_addr_mode:2;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n\tu16 reserved:1,\n\t    intra_pan:1,\n\t    ack_request:1,\n\t    frame_pending:1,\n\t    security_enabled:1,\n\t    type:3,\n\t    source_addr_mode:2,\n\t    version:2,\n\t    dest_addr_mode:2,\n\t    reserved2:2;\n#else\n#error\t\"Please fix <asm/byteorder.h>\"\n#endif\n};\n\nenum ieee802154_frame_version {\n\tIEEE802154_2003_STD,\n\tIEEE802154_2006_STD,\n\tIEEE802154_STD,\n\tIEEE802154_RESERVED_STD,\n\tIEEE802154_MULTIPURPOSE_STD = IEEE802154_2003_STD,\n};\n\nenum ieee802154_addressing_mode {\n\tIEEE802154_NO_ADDRESSING,\n\tIEEE802154_RESERVED,\n\tIEEE802154_SHORT_ADDRESSING,\n\tIEEE802154_EXTENDED_ADDRESSING,\n};\n\nstruct ieee802154_hdr {\n\tstruct ieee802154_hdr_fc fc;\n\tu8 seq;\n\tstruct ieee802154_addr source;\n\tstruct ieee802154_addr dest;\n\tstruct ieee802154_sechdr sec;\n};\n\nstruct ieee802154_beacon_frame {\n\tstruct ieee802154_hdr mhr;\n\tstruct ieee802154_beacon_hdr mac_pl;\n};\n\nstruct ieee802154_mac_cmd_frame {\n\tstruct ieee802154_hdr mhr;\n\tstruct ieee802154_mac_cmd_pl mac_pl;\n};\n\nstruct ieee802154_beacon_req_frame {\n\tstruct ieee802154_hdr mhr;\n\tstruct ieee802154_mac_cmd_pl mac_pl;\n};\n\n \nint ieee802154_hdr_push(struct sk_buff *skb, struct ieee802154_hdr *hdr);\n\n \nint ieee802154_hdr_pull(struct sk_buff *skb, struct ieee802154_hdr *hdr);\n\n \nint ieee802154_hdr_peek_addrs(const struct sk_buff *skb,\n\t\t\t      struct ieee802154_hdr *hdr);\n\n \nint ieee802154_hdr_peek(const struct sk_buff *skb, struct ieee802154_hdr *hdr);\n\n \nint ieee802154_beacon_push(struct sk_buff *skb,\n\t\t\t   struct ieee802154_beacon_frame *beacon);\nint ieee802154_mac_cmd_push(struct sk_buff *skb, void *frame,\n\t\t\t    const void *pl, unsigned int pl_len);\nint ieee802154_mac_cmd_pl_pull(struct sk_buff *skb,\n\t\t\t       struct ieee802154_mac_cmd_pl *mac_pl);\n\nint ieee802154_max_payload(const struct ieee802154_hdr *hdr);\n\nstatic inline int\nieee802154_sechdr_authtag_len(const struct ieee802154_sechdr *sec)\n{\n\tswitch (sec->level) {\n\tcase IEEE802154_SCF_SECLEVEL_MIC32:\n\tcase IEEE802154_SCF_SECLEVEL_ENC_MIC32:\n\t\treturn 4;\n\tcase IEEE802154_SCF_SECLEVEL_MIC64:\n\tcase IEEE802154_SCF_SECLEVEL_ENC_MIC64:\n\t\treturn 8;\n\tcase IEEE802154_SCF_SECLEVEL_MIC128:\n\tcase IEEE802154_SCF_SECLEVEL_ENC_MIC128:\n\t\treturn 16;\n\tcase IEEE802154_SCF_SECLEVEL_NONE:\n\tcase IEEE802154_SCF_SECLEVEL_ENC:\n\tdefault:\n\t\treturn 0;\n\t}\n}\n\nstatic inline int ieee802154_hdr_length(struct sk_buff *skb)\n{\n\tstruct ieee802154_hdr hdr;\n\tint len = ieee802154_hdr_pull(skb, &hdr);\n\n\tif (len > 0)\n\t\tskb_push(skb, len);\n\n\treturn len;\n}\n\nstatic inline bool ieee802154_addr_equal(const struct ieee802154_addr *a1,\n\t\t\t\t\t const struct ieee802154_addr *a2)\n{\n\tif (a1->pan_id != a2->pan_id || a1->mode != a2->mode)\n\t\treturn false;\n\n\tif ((a1->mode == IEEE802154_ADDR_LONG &&\n\t     a1->extended_addr != a2->extended_addr) ||\n\t    (a1->mode == IEEE802154_ADDR_SHORT &&\n\t     a1->short_addr != a2->short_addr))\n\t\treturn false;\n\n\treturn true;\n}\n\nstatic inline __le64 ieee802154_devaddr_from_raw(const void *raw)\n{\n\tu64 temp;\n\n\tmemcpy(&temp, raw, IEEE802154_ADDR_LEN);\n\treturn (__force __le64)swab64(temp);\n}\n\nstatic inline void ieee802154_devaddr_to_raw(void *raw, __le64 addr)\n{\n\tu64 temp = swab64((__force u64)addr);\n\n\tmemcpy(raw, &temp, IEEE802154_ADDR_LEN);\n}\n\nstatic inline int\nieee802154_sockaddr_check_size(struct sockaddr_ieee802154 *daddr, int len)\n{\n\tstruct ieee802154_addr_sa *sa;\n\tint ret = 0;\n\n\tsa = &daddr->addr;\n\tif (len < IEEE802154_MIN_NAMELEN)\n\t\treturn -EINVAL;\n\tswitch (sa->addr_type) {\n\tcase IEEE802154_ADDR_NONE:\n\t\tbreak;\n\tcase IEEE802154_ADDR_SHORT:\n\t\tif (len < IEEE802154_NAMELEN_SHORT)\n\t\t\tret = -EINVAL;\n\t\tbreak;\n\tcase IEEE802154_ADDR_LONG:\n\t\tif (len < IEEE802154_NAMELEN_LONG)\n\t\t\tret = -EINVAL;\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t\tbreak;\n\t}\n\treturn ret;\n}\n\nstatic inline void ieee802154_addr_from_sa(struct ieee802154_addr *a,\n\t\t\t\t\t   const struct ieee802154_addr_sa *sa)\n{\n\ta->mode = sa->addr_type;\n\ta->pan_id = cpu_to_le16(sa->pan_id);\n\n\tswitch (a->mode) {\n\tcase IEEE802154_ADDR_SHORT:\n\t\ta->short_addr = cpu_to_le16(sa->short_addr);\n\t\tbreak;\n\tcase IEEE802154_ADDR_LONG:\n\t\ta->extended_addr = ieee802154_devaddr_from_raw(sa->hwaddr);\n\t\tbreak;\n\t}\n}\n\nstatic inline void ieee802154_addr_to_sa(struct ieee802154_addr_sa *sa,\n\t\t\t\t\t const struct ieee802154_addr *a)\n{\n\tsa->addr_type = a->mode;\n\tsa->pan_id = le16_to_cpu(a->pan_id);\n\n\tswitch (a->mode) {\n\tcase IEEE802154_ADDR_SHORT:\n\t\tsa->short_addr = le16_to_cpu(a->short_addr);\n\t\tbreak;\n\tcase IEEE802154_ADDR_LONG:\n\t\tieee802154_devaddr_to_raw(sa->hwaddr, a->extended_addr);\n\t\tbreak;\n\t}\n}\n\n \nstruct ieee802154_mac_cb {\n\tu8 lqi;\n\tu8 type;\n\tbool ackreq;\n\tbool secen;\n\tbool secen_override;\n\tu8 seclevel;\n\tbool seclevel_override;\n\tstruct ieee802154_addr source;\n\tstruct ieee802154_addr dest;\n};\n\nstatic inline struct ieee802154_mac_cb *mac_cb(struct sk_buff *skb)\n{\n\treturn (struct ieee802154_mac_cb *)skb->cb;\n}\n\nstatic inline struct ieee802154_mac_cb *mac_cb_init(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct ieee802154_mac_cb) > sizeof(skb->cb));\n\n\tmemset(skb->cb, 0, sizeof(struct ieee802154_mac_cb));\n\treturn mac_cb(skb);\n}\n\nenum {\n\tIEEE802154_LLSEC_DEVKEY_IGNORE,\n\tIEEE802154_LLSEC_DEVKEY_RESTRICT,\n\tIEEE802154_LLSEC_DEVKEY_RECORD,\n\n\t__IEEE802154_LLSEC_DEVKEY_MAX,\n};\n\n#define IEEE802154_MAC_SCAN_ED\t\t0\n#define IEEE802154_MAC_SCAN_ACTIVE\t1\n#define IEEE802154_MAC_SCAN_PASSIVE\t2\n#define IEEE802154_MAC_SCAN_ORPHAN\t3\n\nstruct ieee802154_mac_params {\n\ts8 transmit_power;\n\tu8 min_be;\n\tu8 max_be;\n\tu8 csma_retries;\n\ts8 frame_retries;\n\n\tbool lbt;\n\tstruct wpan_phy_cca cca;\n\ts32 cca_ed_level;\n};\n\nstruct wpan_phy;\n\nenum {\n\tIEEE802154_LLSEC_PARAM_ENABLED\t\t= BIT(0),\n\tIEEE802154_LLSEC_PARAM_FRAME_COUNTER\t= BIT(1),\n\tIEEE802154_LLSEC_PARAM_OUT_LEVEL\t= BIT(2),\n\tIEEE802154_LLSEC_PARAM_OUT_KEY\t\t= BIT(3),\n\tIEEE802154_LLSEC_PARAM_KEY_SOURCE\t= BIT(4),\n\tIEEE802154_LLSEC_PARAM_PAN_ID\t\t= BIT(5),\n\tIEEE802154_LLSEC_PARAM_HWADDR\t\t= BIT(6),\n\tIEEE802154_LLSEC_PARAM_COORD_HWADDR\t= BIT(7),\n\tIEEE802154_LLSEC_PARAM_COORD_SHORTADDR\t= BIT(8),\n};\n\nstruct ieee802154_llsec_ops {\n\tint (*get_params)(struct net_device *dev,\n\t\t\t  struct ieee802154_llsec_params *params);\n\tint (*set_params)(struct net_device *dev,\n\t\t\t  const struct ieee802154_llsec_params *params,\n\t\t\t  int changed);\n\n\tint (*add_key)(struct net_device *dev,\n\t\t       const struct ieee802154_llsec_key_id *id,\n\t\t       const struct ieee802154_llsec_key *key);\n\tint (*del_key)(struct net_device *dev,\n\t\t       const struct ieee802154_llsec_key_id *id);\n\n\tint (*add_dev)(struct net_device *dev,\n\t\t       const struct ieee802154_llsec_device *llsec_dev);\n\tint (*del_dev)(struct net_device *dev, __le64 dev_addr);\n\n\tint (*add_devkey)(struct net_device *dev,\n\t\t\t  __le64 device_addr,\n\t\t\t  const struct ieee802154_llsec_device_key *key);\n\tint (*del_devkey)(struct net_device *dev,\n\t\t\t  __le64 device_addr,\n\t\t\t  const struct ieee802154_llsec_device_key *key);\n\n\tint (*add_seclevel)(struct net_device *dev,\n\t\t\t    const struct ieee802154_llsec_seclevel *sl);\n\tint (*del_seclevel)(struct net_device *dev,\n\t\t\t    const struct ieee802154_llsec_seclevel *sl);\n\n\tvoid (*lock_table)(struct net_device *dev);\n\tvoid (*get_table)(struct net_device *dev,\n\t\t\t  struct ieee802154_llsec_table **t);\n\tvoid (*unlock_table)(struct net_device *dev);\n};\n \nstruct ieee802154_mlme_ops {\n\t \n\n\tint (*assoc_req)(struct net_device *dev,\n\t\t\tstruct ieee802154_addr *addr,\n\t\t\tu8 channel, u8 page, u8 cap);\n\tint (*assoc_resp)(struct net_device *dev,\n\t\t\tstruct ieee802154_addr *addr,\n\t\t\t__le16 short_addr, u8 status);\n\tint (*disassoc_req)(struct net_device *dev,\n\t\t\tstruct ieee802154_addr *addr,\n\t\t\tu8 reason);\n\tint (*start_req)(struct net_device *dev,\n\t\t\tstruct ieee802154_addr *addr,\n\t\t\tu8 channel, u8 page, u8 bcn_ord, u8 sf_ord,\n\t\t\tu8 pan_coord, u8 blx, u8 coord_realign);\n\tint (*scan_req)(struct net_device *dev,\n\t\t\tu8 type, u32 channels, u8 page, u8 duration);\n\n\tint (*set_mac_params)(struct net_device *dev,\n\t\t\t      const struct ieee802154_mac_params *params);\n\tvoid (*get_mac_params)(struct net_device *dev,\n\t\t\t       struct ieee802154_mac_params *params);\n\n\tconst struct ieee802154_llsec_ops *llsec;\n};\n\nstatic inline struct ieee802154_mlme_ops *\nieee802154_mlme_ops(const struct net_device *dev)\n{\n\treturn dev->ml_priv;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}