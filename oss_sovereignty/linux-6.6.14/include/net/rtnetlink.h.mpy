{
  "module_name": "rtnetlink.h",
  "hash_id": "2b4908d43dbb41d7bce43d86ed97acff319ad40c1ed8a15439e5c67a0b58f852",
  "original_prompt": "Ingested from linux-6.6.14/include/net/rtnetlink.h",
  "human_readable_source": " \n#ifndef __NET_RTNETLINK_H\n#define __NET_RTNETLINK_H\n\n#include <linux/rtnetlink.h>\n#include <net/netlink.h>\n\ntypedef int (*rtnl_doit_func)(struct sk_buff *, struct nlmsghdr *,\n\t\t\t      struct netlink_ext_ack *);\ntypedef int (*rtnl_dumpit_func)(struct sk_buff *, struct netlink_callback *);\n\nenum rtnl_link_flags {\n\tRTNL_FLAG_DOIT_UNLOCKED\t\t= BIT(0),\n\tRTNL_FLAG_BULK_DEL_SUPPORTED\t= BIT(1),\n};\n\nenum rtnl_kinds {\n\tRTNL_KIND_NEW,\n\tRTNL_KIND_DEL,\n\tRTNL_KIND_GET,\n\tRTNL_KIND_SET\n};\n#define RTNL_KIND_MASK 0x3\n\nstatic inline enum rtnl_kinds rtnl_msgtype_kind(int msgtype)\n{\n\treturn msgtype & RTNL_KIND_MASK;\n}\n\nvoid rtnl_register(int protocol, int msgtype,\n\t\t   rtnl_doit_func, rtnl_dumpit_func, unsigned int flags);\nint rtnl_register_module(struct module *owner, int protocol, int msgtype,\n\t\t\t rtnl_doit_func, rtnl_dumpit_func, unsigned int flags);\nint rtnl_unregister(int protocol, int msgtype);\nvoid rtnl_unregister_all(int protocol);\n\nstatic inline int rtnl_msg_family(const struct nlmsghdr *nlh)\n{\n\tif (nlmsg_len(nlh) >= sizeof(struct rtgenmsg))\n\t\treturn ((struct rtgenmsg *) nlmsg_data(nlh))->rtgen_family;\n\telse\n\t\treturn AF_UNSPEC;\n}\n\n \nstruct rtnl_link_ops {\n\tstruct list_head\tlist;\n\n\tconst char\t\t*kind;\n\n\tsize_t\t\t\tpriv_size;\n\tstruct net_device\t*(*alloc)(struct nlattr *tb[],\n\t\t\t\t\t  const char *ifname,\n\t\t\t\t\t  unsigned char name_assign_type,\n\t\t\t\t\t  unsigned int num_tx_queues,\n\t\t\t\t\t  unsigned int num_rx_queues);\n\tvoid\t\t\t(*setup)(struct net_device *dev);\n\n\tbool\t\t\tnetns_refund;\n\tunsigned int\t\tmaxtype;\n\tconst struct nla_policy\t*policy;\n\tint\t\t\t(*validate)(struct nlattr *tb[],\n\t\t\t\t\t    struct nlattr *data[],\n\t\t\t\t\t    struct netlink_ext_ack *extack);\n\n\tint\t\t\t(*newlink)(struct net *src_net,\n\t\t\t\t\t   struct net_device *dev,\n\t\t\t\t\t   struct nlattr *tb[],\n\t\t\t\t\t   struct nlattr *data[],\n\t\t\t\t\t   struct netlink_ext_ack *extack);\n\tint\t\t\t(*changelink)(struct net_device *dev,\n\t\t\t\t\t      struct nlattr *tb[],\n\t\t\t\t\t      struct nlattr *data[],\n\t\t\t\t\t      struct netlink_ext_ack *extack);\n\tvoid\t\t\t(*dellink)(struct net_device *dev,\n\t\t\t\t\t   struct list_head *head);\n\n\tsize_t\t\t\t(*get_size)(const struct net_device *dev);\n\tint\t\t\t(*fill_info)(struct sk_buff *skb,\n\t\t\t\t\t     const struct net_device *dev);\n\n\tsize_t\t\t\t(*get_xstats_size)(const struct net_device *dev);\n\tint\t\t\t(*fill_xstats)(struct sk_buff *skb,\n\t\t\t\t\t       const struct net_device *dev);\n\tunsigned int\t\t(*get_num_tx_queues)(void);\n\tunsigned int\t\t(*get_num_rx_queues)(void);\n\n\tunsigned int\t\tslave_maxtype;\n\tconst struct nla_policy\t*slave_policy;\n\tint\t\t\t(*slave_changelink)(struct net_device *dev,\n\t\t\t\t\t\t    struct net_device *slave_dev,\n\t\t\t\t\t\t    struct nlattr *tb[],\n\t\t\t\t\t\t    struct nlattr *data[],\n\t\t\t\t\t\t    struct netlink_ext_ack *extack);\n\tsize_t\t\t\t(*get_slave_size)(const struct net_device *dev,\n\t\t\t\t\t\t  const struct net_device *slave_dev);\n\tint\t\t\t(*fill_slave_info)(struct sk_buff *skb,\n\t\t\t\t\t\t   const struct net_device *dev,\n\t\t\t\t\t\t   const struct net_device *slave_dev);\n\tstruct net\t\t*(*get_link_net)(const struct net_device *dev);\n\tsize_t\t\t\t(*get_linkxstats_size)(const struct net_device *dev,\n\t\t\t\t\t\t       int attr);\n\tint\t\t\t(*fill_linkxstats)(struct sk_buff *skb,\n\t\t\t\t\t\t   const struct net_device *dev,\n\t\t\t\t\t\t   int *prividx, int attr);\n};\n\nint __rtnl_link_register(struct rtnl_link_ops *ops);\nvoid __rtnl_link_unregister(struct rtnl_link_ops *ops);\n\nint rtnl_link_register(struct rtnl_link_ops *ops);\nvoid rtnl_link_unregister(struct rtnl_link_ops *ops);\n\n \nstruct rtnl_af_ops {\n\tstruct list_head\tlist;\n\tint\t\t\tfamily;\n\n\tint\t\t\t(*fill_link_af)(struct sk_buff *skb,\n\t\t\t\t\t\tconst struct net_device *dev,\n\t\t\t\t\t\tu32 ext_filter_mask);\n\tsize_t\t\t\t(*get_link_af_size)(const struct net_device *dev,\n\t\t\t\t\t\t    u32 ext_filter_mask);\n\n\tint\t\t\t(*validate_link_af)(const struct net_device *dev,\n\t\t\t\t\t\t    const struct nlattr *attr,\n\t\t\t\t\t\t    struct netlink_ext_ack *extack);\n\tint\t\t\t(*set_link_af)(struct net_device *dev,\n\t\t\t\t\t       const struct nlattr *attr,\n\t\t\t\t\t       struct netlink_ext_ack *extack);\n\tint\t\t\t(*fill_stats_af)(struct sk_buff *skb,\n\t\t\t\t\t\t const struct net_device *dev);\n\tsize_t\t\t\t(*get_stats_af_size)(const struct net_device *dev);\n};\n\nvoid rtnl_af_register(struct rtnl_af_ops *ops);\nvoid rtnl_af_unregister(struct rtnl_af_ops *ops);\n\nstruct net *rtnl_link_get_net(struct net *src_net, struct nlattr *tb[]);\nstruct net_device *rtnl_create_link(struct net *net, const char *ifname,\n\t\t\t\t    unsigned char name_assign_type,\n\t\t\t\t    const struct rtnl_link_ops *ops,\n\t\t\t\t    struct nlattr *tb[],\n\t\t\t\t    struct netlink_ext_ack *extack);\nint rtnl_delete_link(struct net_device *dev, u32 portid, const struct nlmsghdr *nlh);\nint rtnl_configure_link(struct net_device *dev, const struct ifinfomsg *ifm,\n\t\t\tu32 portid, const struct nlmsghdr *nlh);\n\nint rtnl_nla_parse_ifinfomsg(struct nlattr **tb, const struct nlattr *nla_peer,\n\t\t\t     struct netlink_ext_ack *exterr);\nstruct net *rtnl_get_net_ns_capable(struct sock *sk, int netnsid);\n\n#define MODULE_ALIAS_RTNL_LINK(kind) MODULE_ALIAS(\"rtnl-link-\" kind)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}