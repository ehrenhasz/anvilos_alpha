{
  "module_name": "mrp.h",
  "hash_id": "8d77dc5f5c79095fc0f46ea0b898dd214ba788fbf59a9c43154aba72dcd5fe34",
  "original_prompt": "Ingested from linux-6.6.14/include/net/mrp.h",
  "human_readable_source": " \n#ifndef _NET_MRP_H\n#define _NET_MRP_H\n\n#include <linux/netdevice.h>\n#include <linux/skbuff.h>\n#include <linux/types.h>\n\n#define MRP_END_MARK\t\t0x0\n\nstruct mrp_pdu_hdr {\n\tu8\tversion;\n};\n\nstruct mrp_msg_hdr {\n\tu8\tattrtype;\n\tu8\tattrlen;\n};\n\nstruct mrp_vecattr_hdr {\n\t__be16\tlenflags;\n\tunsigned char\tfirstattrvalue[];\n#define MRP_VECATTR_HDR_LEN_MASK cpu_to_be16(0x1FFF)\n#define MRP_VECATTR_HDR_FLAG_LA cpu_to_be16(0x2000)\n};\n\nenum mrp_vecattr_event {\n\tMRP_VECATTR_EVENT_NEW,\n\tMRP_VECATTR_EVENT_JOIN_IN,\n\tMRP_VECATTR_EVENT_IN,\n\tMRP_VECATTR_EVENT_JOIN_MT,\n\tMRP_VECATTR_EVENT_MT,\n\tMRP_VECATTR_EVENT_LV,\n\t__MRP_VECATTR_EVENT_MAX\n};\n\nstruct mrp_skb_cb {\n\tstruct mrp_msg_hdr\t*mh;\n\tstruct mrp_vecattr_hdr\t*vah;\n\tunsigned char\t\tattrvalue[];\n};\n\nstatic inline struct mrp_skb_cb *mrp_cb(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct mrp_skb_cb) >\n\t\t     sizeof_field(struct sk_buff, cb));\n\treturn (struct mrp_skb_cb *)skb->cb;\n}\n\nenum mrp_applicant_state {\n\tMRP_APPLICANT_INVALID,\n\tMRP_APPLICANT_VO,\n\tMRP_APPLICANT_VP,\n\tMRP_APPLICANT_VN,\n\tMRP_APPLICANT_AN,\n\tMRP_APPLICANT_AA,\n\tMRP_APPLICANT_QA,\n\tMRP_APPLICANT_LA,\n\tMRP_APPLICANT_AO,\n\tMRP_APPLICANT_QO,\n\tMRP_APPLICANT_AP,\n\tMRP_APPLICANT_QP,\n\t__MRP_APPLICANT_MAX\n};\n#define MRP_APPLICANT_MAX\t(__MRP_APPLICANT_MAX - 1)\n\nenum mrp_event {\n\tMRP_EVENT_NEW,\n\tMRP_EVENT_JOIN,\n\tMRP_EVENT_LV,\n\tMRP_EVENT_TX,\n\tMRP_EVENT_R_NEW,\n\tMRP_EVENT_R_JOIN_IN,\n\tMRP_EVENT_R_IN,\n\tMRP_EVENT_R_JOIN_MT,\n\tMRP_EVENT_R_MT,\n\tMRP_EVENT_R_LV,\n\tMRP_EVENT_R_LA,\n\tMRP_EVENT_REDECLARE,\n\tMRP_EVENT_PERIODIC,\n\t__MRP_EVENT_MAX\n};\n#define MRP_EVENT_MAX\t\t(__MRP_EVENT_MAX - 1)\n\nenum mrp_tx_action {\n\tMRP_TX_ACTION_NONE,\n\tMRP_TX_ACTION_S_NEW,\n\tMRP_TX_ACTION_S_JOIN_IN,\n\tMRP_TX_ACTION_S_JOIN_IN_OPTIONAL,\n\tMRP_TX_ACTION_S_IN_OPTIONAL,\n\tMRP_TX_ACTION_S_LV,\n};\n\nstruct mrp_attr {\n\tstruct rb_node\t\t\tnode;\n\tenum mrp_applicant_state\tstate;\n\tu8\t\t\t\ttype;\n\tu8\t\t\t\tlen;\n\tunsigned char\t\t\tvalue[];\n};\n\nenum mrp_applications {\n\tMRP_APPLICATION_MVRP,\n\t__MRP_APPLICATION_MAX\n};\n#define MRP_APPLICATION_MAX\t(__MRP_APPLICATION_MAX - 1)\n\nstruct mrp_application {\n\tenum mrp_applications\ttype;\n\tunsigned int\t\tmaxattr;\n\tstruct packet_type\tpkttype;\n\tunsigned char\t\tgroup_address[ETH_ALEN];\n\tu8\t\t\tversion;\n};\n\nstruct mrp_applicant {\n\tstruct mrp_application\t*app;\n\tstruct net_device\t*dev;\n\tstruct timer_list\tjoin_timer;\n\tstruct timer_list\tperiodic_timer;\n\n\tspinlock_t\t\tlock;\n\tstruct sk_buff_head\tqueue;\n\tstruct sk_buff\t\t*pdu;\n\tstruct rb_root\t\tmad;\n\tstruct rcu_head\t\trcu;\n\tbool\t\t\tactive;\n};\n\nstruct mrp_port {\n\tstruct mrp_applicant __rcu\t*applicants[MRP_APPLICATION_MAX + 1];\n\tstruct rcu_head\t\t\trcu;\n};\n\nint mrp_register_application(struct mrp_application *app);\nvoid mrp_unregister_application(struct mrp_application *app);\n\nint mrp_init_applicant(struct net_device *dev, struct mrp_application *app);\nvoid mrp_uninit_applicant(struct net_device *dev, struct mrp_application *app);\n\nint mrp_request_join(const struct net_device *dev,\n\t\t     const struct mrp_application *app,\n\t\t     const void *value, u8 len, u8 type);\nvoid mrp_request_leave(const struct net_device *dev,\n\t\t       const struct mrp_application *app,\n\t\t       const void *value, u8 len, u8 type);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}