{
  "module_name": "cipso_ipv4.h",
  "hash_id": "ee5a6cb7888aaccc0df8fc772723995083433fcc6e183c313ee52d847d49b6e3",
  "original_prompt": "Ingested from linux-6.6.14/include/net/cipso_ipv4.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _CIPSO_IPV4_H\n#define _CIPSO_IPV4_H\n\n#include <linux/types.h>\n#include <linux/rcupdate.h>\n#include <linux/list.h>\n#include <linux/net.h>\n#include <linux/skbuff.h>\n#include <net/netlabel.h>\n#include <net/request_sock.h>\n#include <linux/atomic.h>\n#include <linux/refcount.h>\n#include <asm/unaligned.h>\n\n \n#define CIPSO_V4_DOI_UNKNOWN          0x00000000\n\n \n#define CIPSO_V4_TAG_INVALID          0\n#define CIPSO_V4_TAG_RBITMAP          1\n#define CIPSO_V4_TAG_ENUM             2\n#define CIPSO_V4_TAG_RANGE            5\n#define CIPSO_V4_TAG_PBITMAP          6\n#define CIPSO_V4_TAG_FREEFORM         7\n\n \n#define CIPSO_V4_TAG_LOCAL            128\n\n \n#define CIPSO_V4_MAP_UNKNOWN          0\n#define CIPSO_V4_MAP_TRANS            1\n#define CIPSO_V4_MAP_PASS             2\n#define CIPSO_V4_MAP_LOCAL            3\n\n \n#define CIPSO_V4_MAX_REM_LVLS         255\n#define CIPSO_V4_INV_LVL              0x80000000\n#define CIPSO_V4_MAX_LOC_LVLS         (CIPSO_V4_INV_LVL - 1)\n#define CIPSO_V4_MAX_REM_CATS         65534\n#define CIPSO_V4_INV_CAT              0x80000000\n#define CIPSO_V4_MAX_LOC_CATS         (CIPSO_V4_INV_CAT - 1)\n\n \n\n \n#define CIPSO_V4_TAG_MAXCNT           5\nstruct cipso_v4_doi {\n\tu32 doi;\n\tu32 type;\n\tunion {\n\t\tstruct cipso_v4_std_map_tbl *std;\n\t} map;\n\tu8 tags[CIPSO_V4_TAG_MAXCNT];\n\n\trefcount_t refcount;\n\tstruct list_head list;\n\tstruct rcu_head rcu;\n};\n\n \n \nstruct cipso_v4_std_map_tbl {\n\tstruct {\n\t\tu32 *cipso;\n\t\tu32 *local;\n\t\tu32 cipso_size;\n\t\tu32 local_size;\n\t} lvl;\n\tstruct {\n\t\tu32 *cipso;\n\t\tu32 *local;\n\t\tu32 cipso_size;\n\t\tu32 local_size;\n\t} cat;\n};\n\n \n\n#ifdef CONFIG_NETLABEL\nextern int cipso_v4_cache_enabled;\nextern int cipso_v4_cache_bucketsize;\nextern int cipso_v4_rbm_optfmt;\nextern int cipso_v4_rbm_strictvalid;\n#endif\n\n \n\n#ifdef CONFIG_NETLABEL\nint cipso_v4_doi_add(struct cipso_v4_doi *doi_def,\n\t\t     struct netlbl_audit *audit_info);\nvoid cipso_v4_doi_free(struct cipso_v4_doi *doi_def);\nint cipso_v4_doi_remove(u32 doi, struct netlbl_audit *audit_info);\nstruct cipso_v4_doi *cipso_v4_doi_getdef(u32 doi);\nvoid cipso_v4_doi_putdef(struct cipso_v4_doi *doi_def);\nint cipso_v4_doi_walk(u32 *skip_cnt,\n\t\t     int (*callback) (struct cipso_v4_doi *doi_def, void *arg),\n\t             void *cb_arg);\n#else\nstatic inline int cipso_v4_doi_add(struct cipso_v4_doi *doi_def,\n\t\t\t\t   struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline void cipso_v4_doi_free(struct cipso_v4_doi *doi_def)\n{\n\treturn;\n}\n\nstatic inline int cipso_v4_doi_remove(u32 doi,\n\t\t\t\t      struct netlbl_audit *audit_info)\n{\n\treturn 0;\n}\n\nstatic inline struct cipso_v4_doi *cipso_v4_doi_getdef(u32 doi)\n{\n\treturn NULL;\n}\n\nstatic inline int cipso_v4_doi_walk(u32 *skip_cnt,\n\t\t     int (*callback) (struct cipso_v4_doi *doi_def, void *arg),\n\t\t     void *cb_arg)\n{\n\treturn 0;\n}\n#endif  \n\n \n\n#ifdef CONFIG_NETLABEL\nvoid cipso_v4_cache_invalidate(void);\nint cipso_v4_cache_add(const unsigned char *cipso_ptr,\n\t\t       const struct netlbl_lsm_secattr *secattr);\n#else\nstatic inline void cipso_v4_cache_invalidate(void)\n{\n\treturn;\n}\n\nstatic inline int cipso_v4_cache_add(const unsigned char *cipso_ptr,\n\t\t\t\t     const struct netlbl_lsm_secattr *secattr)\n{\n\treturn 0;\n}\n#endif  \n\n \n\n#ifdef CONFIG_NETLABEL\nvoid cipso_v4_error(struct sk_buff *skb, int error, u32 gateway);\nint cipso_v4_getattr(const unsigned char *cipso,\n\t\t     struct netlbl_lsm_secattr *secattr);\nint cipso_v4_sock_setattr(struct sock *sk,\n\t\t\t  const struct cipso_v4_doi *doi_def,\n\t\t\t  const struct netlbl_lsm_secattr *secattr);\nvoid cipso_v4_sock_delattr(struct sock *sk);\nint cipso_v4_sock_getattr(struct sock *sk, struct netlbl_lsm_secattr *secattr);\nint cipso_v4_req_setattr(struct request_sock *req,\n\t\t\t const struct cipso_v4_doi *doi_def,\n\t\t\t const struct netlbl_lsm_secattr *secattr);\nvoid cipso_v4_req_delattr(struct request_sock *req);\nint cipso_v4_skbuff_setattr(struct sk_buff *skb,\n\t\t\t    const struct cipso_v4_doi *doi_def,\n\t\t\t    const struct netlbl_lsm_secattr *secattr);\nint cipso_v4_skbuff_delattr(struct sk_buff *skb);\nint cipso_v4_skbuff_getattr(const struct sk_buff *skb,\n\t\t\t    struct netlbl_lsm_secattr *secattr);\nunsigned char *cipso_v4_optptr(const struct sk_buff *skb);\nint cipso_v4_validate(const struct sk_buff *skb, unsigned char **option);\n#else\nstatic inline void cipso_v4_error(struct sk_buff *skb,\n\t\t\t\t  int error,\n\t\t\t\t  u32 gateway)\n{\n\treturn;\n}\n\nstatic inline int cipso_v4_getattr(const unsigned char *cipso,\n\t\t\t\t   struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline int cipso_v4_sock_setattr(struct sock *sk,\n\t\t\t\t      const struct cipso_v4_doi *doi_def,\n\t\t\t\t      const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline void cipso_v4_sock_delattr(struct sock *sk)\n{\n}\n\nstatic inline int cipso_v4_sock_getattr(struct sock *sk,\n\t\t\t\t\tstruct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline int cipso_v4_req_setattr(struct request_sock *req,\n\t\t\t\t       const struct cipso_v4_doi *doi_def,\n\t\t\t\t       const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline void cipso_v4_req_delattr(struct request_sock *req)\n{\n\treturn;\n}\n\nstatic inline int cipso_v4_skbuff_setattr(struct sk_buff *skb,\n\t\t\t\t      const struct cipso_v4_doi *doi_def,\n\t\t\t\t      const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline int cipso_v4_skbuff_delattr(struct sk_buff *skb)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline int cipso_v4_skbuff_getattr(const struct sk_buff *skb,\n\t\t\t\t\t  struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\n\nstatic inline unsigned char *cipso_v4_optptr(const struct sk_buff *skb)\n{\n\treturn NULL;\n}\n\nstatic inline int cipso_v4_validate(const struct sk_buff *skb,\n\t\t\t\t    unsigned char **option)\n{\n\tunsigned char *opt = *option;\n\tunsigned char err_offset = 0;\n\tu8 opt_len = opt[1];\n\tu8 opt_iter;\n\tu8 tag_len;\n\n\tif (opt_len < 8) {\n\t\terr_offset = 1;\n\t\tgoto out;\n\t}\n\n\tif (get_unaligned_be32(&opt[2]) == 0) {\n\t\terr_offset = 2;\n\t\tgoto out;\n\t}\n\n\tfor (opt_iter = 6; opt_iter < opt_len;) {\n\t\tif (opt_iter + 1 == opt_len) {\n\t\t\terr_offset = opt_iter;\n\t\t\tgoto out;\n\t\t}\n\t\ttag_len = opt[opt_iter + 1];\n\t\tif ((tag_len == 0) || (tag_len > (opt_len - opt_iter))) {\n\t\t\terr_offset = opt_iter + 1;\n\t\t\tgoto out;\n\t\t}\n\t\topt_iter += tag_len;\n\t}\n\nout:\n\t*option = opt + err_offset;\n\treturn err_offset;\n\n}\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}