{
  "module_name": "mac802154.h",
  "hash_id": "5549cea5b0dd13ccb903ef3160e4177972046864fd6b8b1a846e809ec4d76a40",
  "original_prompt": "Ingested from linux-6.6.14/include/net/mac802154.h",
  "human_readable_source": " \n \n#ifndef NET_MAC802154_H\n#define NET_MAC802154_H\n\n#include <asm/unaligned.h>\n#include <net/af_ieee802154.h>\n#include <linux/ieee802154.h>\n#include <linux/skbuff.h>\n\n#include <net/cfg802154.h>\n\n \nenum ieee802154_hw_addr_filt_flags {\n\tIEEE802154_AFILT_SADDR_CHANGED\t\t= BIT(0),\n\tIEEE802154_AFILT_IEEEADDR_CHANGED\t= BIT(1),\n\tIEEE802154_AFILT_PANID_CHANGED\t\t= BIT(2),\n\tIEEE802154_AFILT_PANC_CHANGED\t\t= BIT(3),\n};\n\n \nstruct ieee802154_hw_addr_filt {\n\t__le16\tpan_id;\n\t__le16\tshort_addr;\n\t__le64\tieee_addr;\n\tbool\tpan_coord;\n};\n\n \nstruct ieee802154_hw {\n\t \n\tint\textra_tx_headroom;\n\tu32\tflags;\n\tstruct\tdevice *parent;\n\tvoid\t*priv;\n\n\t \n\tstruct\twpan_phy *phy;\n};\n\n \nenum ieee802154_hw_flags {\n\tIEEE802154_HW_TX_OMIT_CKSUM\t= BIT(0),\n\tIEEE802154_HW_LBT\t\t= BIT(1),\n\tIEEE802154_HW_CSMA_PARAMS\t= BIT(2),\n\tIEEE802154_HW_FRAME_RETRIES\t= BIT(3),\n\tIEEE802154_HW_AFILT\t\t= BIT(4),\n\tIEEE802154_HW_PROMISCUOUS\t= BIT(5),\n\tIEEE802154_HW_RX_OMIT_CKSUM\t= BIT(6),\n};\n\n \n#define IEEE802154_HW_OMIT_CKSUM\t(IEEE802154_HW_TX_OMIT_CKSUM | \\\n\t\t\t\t\t IEEE802154_HW_RX_OMIT_CKSUM)\n\n \nstruct ieee802154_ops {\n\tstruct module\t*owner;\n\tint\t\t(*start)(struct ieee802154_hw *hw);\n\tvoid\t\t(*stop)(struct ieee802154_hw *hw);\n\tint\t\t(*xmit_sync)(struct ieee802154_hw *hw,\n\t\t\t\t     struct sk_buff *skb);\n\tint\t\t(*xmit_async)(struct ieee802154_hw *hw,\n\t\t\t\t      struct sk_buff *skb);\n\tint\t\t(*ed)(struct ieee802154_hw *hw, u8 *level);\n\tint\t\t(*set_channel)(struct ieee802154_hw *hw, u8 page,\n\t\t\t\t       u8 channel);\n\tint\t\t(*set_hw_addr_filt)(struct ieee802154_hw *hw,\n\t\t\t\t\t    struct ieee802154_hw_addr_filt *filt,\n\t\t\t\t\t    unsigned long changed);\n\tint\t\t(*set_txpower)(struct ieee802154_hw *hw, s32 mbm);\n\tint\t\t(*set_lbt)(struct ieee802154_hw *hw, bool on);\n\tint\t\t(*set_cca_mode)(struct ieee802154_hw *hw,\n\t\t\t\t\tconst struct wpan_phy_cca *cca);\n\tint\t\t(*set_cca_ed_level)(struct ieee802154_hw *hw, s32 mbm);\n\tint\t\t(*set_csma_params)(struct ieee802154_hw *hw,\n\t\t\t\t\t   u8 min_be, u8 max_be, u8 retries);\n\tint\t\t(*set_frame_retries)(struct ieee802154_hw *hw,\n\t\t\t\t\t     s8 retries);\n\tint             (*set_promiscuous_mode)(struct ieee802154_hw *hw,\n\t\t\t\t\t\tconst bool on);\n};\n\n \nstatic inline __le16 ieee802154_get_fc_from_skb(const struct sk_buff *skb)\n{\n\t__le16 fc;\n\n\t \n\tif (WARN_ON(!skb_mac_header_was_set(skb) ||\n\t\t    (skb_tail_pointer(skb) -\n\t\t     skb_mac_header(skb)) < IEEE802154_FC_LEN))\n\t\treturn cpu_to_le16(0);\n\n\tmemcpy(&fc, skb_mac_header(skb), IEEE802154_FC_LEN);\n\treturn fc;\n}\n\n \nstatic inline unsigned char *ieee802154_skb_dst_pan(__le16 fc,\n\t\t\t\t\t\t    const struct sk_buff *skb)\n{\n\tunsigned char *dst_pan;\n\n\tswitch (ieee802154_daddr_mode(fc)) {\n\tcase cpu_to_le16(IEEE802154_FCTL_ADDR_NONE):\n\t\tdst_pan = NULL;\n\t\tbreak;\n\tcase cpu_to_le16(IEEE802154_FCTL_DADDR_SHORT):\n\tcase cpu_to_le16(IEEE802154_FCTL_DADDR_EXTENDED):\n\t\tdst_pan = skb_mac_header(skb) +\n\t\t\t  IEEE802154_FC_LEN +\n\t\t\t  IEEE802154_SEQ_LEN;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ONCE(1, \"invalid addr mode detected\");\n\t\tdst_pan = NULL;\n\t\tbreak;\n\t}\n\n\treturn dst_pan;\n}\n\n \nstatic inline unsigned char *ieee802154_skb_src_pan(__le16 fc,\n\t\t\t\t\t\t    const struct sk_buff *skb)\n{\n\tunsigned char *src_pan;\n\n\tswitch (ieee802154_saddr_mode(fc)) {\n\tcase cpu_to_le16(IEEE802154_FCTL_ADDR_NONE):\n\t\tsrc_pan = NULL;\n\t\tbreak;\n\tcase cpu_to_le16(IEEE802154_FCTL_SADDR_SHORT):\n\tcase cpu_to_le16(IEEE802154_FCTL_SADDR_EXTENDED):\n\t\t \n\t\tif (ieee802154_is_intra_pan(fc)) {\n\t\t\tsrc_pan = ieee802154_skb_dst_pan(fc, skb);\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch (ieee802154_daddr_mode(fc)) {\n\t\tcase cpu_to_le16(IEEE802154_FCTL_ADDR_NONE):\n\t\t\tsrc_pan = skb_mac_header(skb) +\n\t\t\t\t  IEEE802154_FC_LEN +\n\t\t\t\t  IEEE802154_SEQ_LEN;\n\t\t\tbreak;\n\t\tcase cpu_to_le16(IEEE802154_FCTL_DADDR_SHORT):\n\t\t\tsrc_pan = skb_mac_header(skb) +\n\t\t\t\t  IEEE802154_FC_LEN +\n\t\t\t\t  IEEE802154_SEQ_LEN +\n\t\t\t\t  IEEE802154_PAN_ID_LEN +\n\t\t\t\t  IEEE802154_SHORT_ADDR_LEN;\n\t\t\tbreak;\n\t\tcase cpu_to_le16(IEEE802154_FCTL_DADDR_EXTENDED):\n\t\t\tsrc_pan = skb_mac_header(skb) +\n\t\t\t\t  IEEE802154_FC_LEN +\n\t\t\t\t  IEEE802154_SEQ_LEN +\n\t\t\t\t  IEEE802154_PAN_ID_LEN +\n\t\t\t\t  IEEE802154_EXTENDED_ADDR_LEN;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tWARN_ONCE(1, \"invalid addr mode detected\");\n\t\t\tsrc_pan = NULL;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tWARN_ONCE(1, \"invalid addr mode detected\");\n\t\tsrc_pan = NULL;\n\t\tbreak;\n\t}\n\n\treturn src_pan;\n}\n\n \nstatic inline bool ieee802154_skb_is_intra_pan_addressing(__le16 fc,\n\t\t\t\t\t\t\t  const struct sk_buff *skb)\n{\n\tunsigned char *dst_pan = ieee802154_skb_dst_pan(fc, skb),\n\t\t      *src_pan = ieee802154_skb_src_pan(fc, skb);\n\n\t \n\tif (!dst_pan || !src_pan)\n\t\treturn false;\n\n\treturn !memcmp(dst_pan, src_pan, IEEE802154_PAN_ID_LEN);\n}\n\n \nstatic inline void ieee802154_be64_to_le64(void *le64_dst, const void *be64_src)\n{\n\tput_unaligned_le64(get_unaligned_be64(be64_src), le64_dst);\n}\n\n \nstatic inline void ieee802154_le64_to_be64(void *be64_dst, const void *le64_src)\n{\n\tput_unaligned_be64(get_unaligned_le64(le64_src), be64_dst);\n}\n\n \nstatic inline void ieee802154_le16_to_be16(void *be16_dst, const void *le16_src)\n{\n\tput_unaligned_be16(get_unaligned_le16(le16_src), be16_dst);\n}\n\n \nstatic inline void ieee802154_be16_to_le16(void *le16_dst, const void *be16_src)\n{\n\tput_unaligned_le16(get_unaligned_be16(be16_src), le16_dst);\n}\n\n \nstruct ieee802154_hw *\nieee802154_alloc_hw(size_t priv_data_len, const struct ieee802154_ops *ops);\n\n \nvoid ieee802154_free_hw(struct ieee802154_hw *hw);\n\n \nint ieee802154_register_hw(struct ieee802154_hw *hw);\n\n \nvoid ieee802154_unregister_hw(struct ieee802154_hw *hw);\n\n \nvoid ieee802154_rx_irqsafe(struct ieee802154_hw *hw, struct sk_buff *skb,\n\t\t\t   u8 lqi);\n\n \nvoid ieee802154_xmit_complete(struct ieee802154_hw *hw, struct sk_buff *skb,\n\t\t\t      bool ifs_handling);\n\n \nvoid ieee802154_xmit_error(struct ieee802154_hw *hw, struct sk_buff *skb,\n\t\t\t   int reason);\n\n \nvoid ieee802154_xmit_hw_error(struct ieee802154_hw *hw, struct sk_buff *skb);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}