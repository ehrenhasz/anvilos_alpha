{
  "module_name": "client.h",
  "hash_id": "d6d7d500f1908b034f34094f19111aec1fe721f0b58fbe19dce879d875dc72ad",
  "original_prompt": "Ingested from linux-6.6.14/include/net/9p/client.h",
  "human_readable_source": " \n \n\n#ifndef NET_9P_CLIENT_H\n#define NET_9P_CLIENT_H\n\n#include <linux/utsname.h>\n#include <linux/idr.h>\n#include <linux/tracepoint-defs.h>\n\n \n#define P9_ROW_MAXTAG 255\n\n \n\nenum p9_proto_versions {\n\tp9_proto_legacy,\n\tp9_proto_2000u,\n\tp9_proto_2000L,\n};\n\n\n \n\nenum p9_trans_status {\n\tConnected,\n\tBeginDisconnect,\n\tDisconnected,\n\tHung,\n};\n\n \n\nenum p9_req_status_t {\n\tREQ_STATUS_ALLOC,\n\tREQ_STATUS_UNSENT,\n\tREQ_STATUS_SENT,\n\tREQ_STATUS_RCVD,\n\tREQ_STATUS_FLSHD,\n\tREQ_STATUS_ERROR,\n};\n\n \nstruct p9_req_t {\n\tint status;\n\tint t_err;\n\trefcount_t refcount;\n\twait_queue_head_t wq;\n\tstruct p9_fcall tc;\n\tstruct p9_fcall rc;\n\tstruct list_head req_list;\n};\n\n \nstruct p9_client {\n\tspinlock_t lock;\n\tunsigned int msize;\n\tunsigned char proto_version;\n\tstruct p9_trans_module *trans_mod;\n\tenum p9_trans_status status;\n\tvoid *trans;\n\tstruct kmem_cache *fcall_cache;\n\n\tunion {\n\t\tstruct {\n\t\t\tint rfd;\n\t\t\tint wfd;\n\t\t} fd;\n\t\tstruct {\n\t\t\tu16 port;\n\t\t\tbool privport;\n\n\t\t} tcp;\n\t} trans_opts;\n\n\tstruct idr fids;\n\tstruct idr reqs;\n\n\tchar name[__NEW_UTS_LEN + 1];\n};\n\n \nenum fid_source {\n\tFID_FROM_OTHER,\n\tFID_FROM_INODE,\n\tFID_FROM_DENTRY,\n};\n\nstruct p9_fid {\n\tstruct p9_client *clnt;\n\tu32 fid;\n\trefcount_t count;\n\tint mode;\n\tstruct p9_qid qid;\n\tu32 iounit;\n\tkuid_t uid;\n\n\tvoid *rdir;\n\n\tstruct hlist_node dlist;\t \n\tstruct hlist_node ilist;\n};\n\n \n\nstruct p9_dirent {\n\tstruct p9_qid qid;\n\tu64 d_off;\n\tunsigned char d_type;\n\tchar d_name[256];\n};\n\nstruct iov_iter;\n\nint p9_show_client_options(struct seq_file *m, struct p9_client *clnt);\nint p9_client_statfs(struct p9_fid *fid, struct p9_rstatfs *sb);\nint p9_client_rename(struct p9_fid *fid, struct p9_fid *newdirfid,\n\t\t     const char *name);\nint p9_client_renameat(struct p9_fid *olddirfid, const char *old_name,\n\t\t       struct p9_fid *newdirfid, const char *new_name);\nstruct p9_client *p9_client_create(const char *dev_name, char *options);\nvoid p9_client_destroy(struct p9_client *clnt);\nvoid p9_client_disconnect(struct p9_client *clnt);\nvoid p9_client_begin_disconnect(struct p9_client *clnt);\nstruct p9_fid *p9_client_attach(struct p9_client *clnt, struct p9_fid *afid,\n\t\t\t\tconst char *uname, kuid_t n_uname, const char *aname);\nstruct p9_fid *p9_client_walk(struct p9_fid *oldfid, uint16_t nwname,\n\t\tconst unsigned char * const *wnames, int clone);\nint p9_client_open(struct p9_fid *fid, int mode);\nint p9_client_fcreate(struct p9_fid *fid, const char *name, u32 perm, int mode,\n\t\t\t\t\t\t\tchar *extension);\nint p9_client_link(struct p9_fid *fid, struct p9_fid *oldfid, const char *newname);\nint p9_client_symlink(struct p9_fid *fid, const char *name, const char *symname,\n\t\tkgid_t gid, struct p9_qid *qid);\nint p9_client_create_dotl(struct p9_fid *ofid, const char *name, u32 flags, u32 mode,\n\t\tkgid_t gid, struct p9_qid *qid);\nint p9_client_clunk(struct p9_fid *fid);\nint p9_client_fsync(struct p9_fid *fid, int datasync);\nint p9_client_remove(struct p9_fid *fid);\nint p9_client_unlinkat(struct p9_fid *dfid, const char *name, int flags);\nint p9_client_read(struct p9_fid *fid, u64 offset, struct iov_iter *to, int *err);\nint p9_client_read_once(struct p9_fid *fid, u64 offset, struct iov_iter *to,\n\t\tint *err);\nint p9_client_write(struct p9_fid *fid, u64 offset, struct iov_iter *from, int *err);\nint p9_client_readdir(struct p9_fid *fid, char *data, u32 count, u64 offset);\nint p9dirent_read(struct p9_client *clnt, char *buf, int len,\n\t\t  struct p9_dirent *dirent);\nstruct p9_wstat *p9_client_stat(struct p9_fid *fid);\nint p9_client_wstat(struct p9_fid *fid, struct p9_wstat *wst);\nint p9_client_setattr(struct p9_fid *fid, struct p9_iattr_dotl *attr);\n\nstruct p9_stat_dotl *p9_client_getattr_dotl(struct p9_fid *fid,\n\t\t\t\t\t\t\tu64 request_mask);\n\nint p9_client_mknod_dotl(struct p9_fid *oldfid, const char *name, int mode,\n\t\t\tdev_t rdev, kgid_t gid, struct p9_qid *qid);\nint p9_client_mkdir_dotl(struct p9_fid *fid, const char *name, int mode,\n\t\t\t\tkgid_t gid, struct p9_qid *qid);\nint p9_client_lock_dotl(struct p9_fid *fid, struct p9_flock *flock, u8 *status);\nint p9_client_getlock_dotl(struct p9_fid *fid, struct p9_getlock *fl);\nvoid p9_fcall_fini(struct p9_fcall *fc);\nstruct p9_req_t *p9_tag_lookup(struct p9_client *c, u16 tag);\n\nstatic inline void p9_req_get(struct p9_req_t *r)\n{\n\trefcount_inc(&r->refcount);\n}\n\nstatic inline int p9_req_try_get(struct p9_req_t *r)\n{\n\treturn refcount_inc_not_zero(&r->refcount);\n}\n\nint p9_req_put(struct p9_client *c, struct p9_req_t *r);\n\n \nDECLARE_TRACEPOINT(9p_fid_ref);\nvoid do_trace_9p_fid_get(struct p9_fid *fid);\nvoid do_trace_9p_fid_put(struct p9_fid *fid);\n\n \nstatic inline struct p9_fid *p9_fid_get(struct p9_fid *fid)\n{\n\tif (tracepoint_enabled(9p_fid_ref))\n\t\tdo_trace_9p_fid_get(fid);\n\n\trefcount_inc(&fid->count);\n\n\treturn fid;\n}\n\nstatic inline int p9_fid_put(struct p9_fid *fid)\n{\n\tif (!fid || IS_ERR(fid))\n\t\treturn 0;\n\n\tif (tracepoint_enabled(9p_fid_ref))\n\t\tdo_trace_9p_fid_put(fid);\n\n\tif (!refcount_dec_and_test(&fid->count))\n\t\treturn 0;\n\n\treturn p9_client_clunk(fid);\n}\n\nvoid p9_client_cb(struct p9_client *c, struct p9_req_t *req, int status);\n\nint p9_parse_header(struct p9_fcall *pdu, int32_t *size, int8_t *type,\n\t\t    int16_t *tag, int rewind);\nint p9stat_read(struct p9_client *clnt, char *buf, int len,\n\t\tstruct p9_wstat *st);\nvoid p9stat_free(struct p9_wstat *stbuf);\n\nint p9_is_proto_dotu(struct p9_client *clnt);\nint p9_is_proto_dotl(struct p9_client *clnt);\nstruct p9_fid *p9_client_xattrwalk(struct p9_fid *file_fid,\n\t\t\t\t   const char *attr_name, u64 *attr_size);\nint p9_client_xattrcreate(struct p9_fid *fid, const char *name,\n\t\t\t  u64 attr_size, int flags);\nint p9_client_readlink(struct p9_fid *fid, char **target);\n\nint p9_client_init(void);\nvoid p9_client_exit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}