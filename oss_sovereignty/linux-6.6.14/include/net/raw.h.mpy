{
  "module_name": "raw.h",
  "hash_id": "24e223c45d9efa8bbe7f3e989fb1ba88f8e129af765f1ad68be468ce8f4d5330",
  "original_prompt": "Ingested from linux-6.6.14/include/net/raw.h",
  "human_readable_source": " \n \n#ifndef _RAW_H\n#define _RAW_H\n\n#include <net/inet_sock.h>\n#include <net/protocol.h>\n#include <net/netns/hash.h>\n#include <linux/hash.h>\n#include <linux/icmp.h>\n\nextern struct proto raw_prot;\n\nextern struct raw_hashinfo raw_v4_hashinfo;\nbool raw_v4_match(struct net *net, const struct sock *sk, unsigned short num,\n\t\t  __be32 raddr, __be32 laddr, int dif, int sdif);\n\nint raw_abort(struct sock *sk, int err);\nvoid raw_icmp_error(struct sk_buff *, int, u32);\nint raw_local_deliver(struct sk_buff *, int);\n\nint raw_rcv(struct sock *, struct sk_buff *);\n\n#define RAW_HTABLE_LOG\t8\n#define RAW_HTABLE_SIZE\t(1U << RAW_HTABLE_LOG)\n\nstruct raw_hashinfo {\n\tspinlock_t lock;\n\n\tstruct hlist_head ht[RAW_HTABLE_SIZE] ____cacheline_aligned;\n};\n\nstatic inline u32 raw_hashfunc(const struct net *net, u32 proto)\n{\n\treturn hash_32(net_hash_mix(net) ^ proto, RAW_HTABLE_LOG);\n}\n\nstatic inline void raw_hashinfo_init(struct raw_hashinfo *hashinfo)\n{\n\tint i;\n\n\tspin_lock_init(&hashinfo->lock);\n\tfor (i = 0; i < RAW_HTABLE_SIZE; i++)\n\t\tINIT_HLIST_HEAD(&hashinfo->ht[i]);\n}\n\n#ifdef CONFIG_PROC_FS\nint raw_proc_init(void);\nvoid raw_proc_exit(void);\n\nstruct raw_iter_state {\n\tstruct seq_net_private p;\n\tint bucket;\n};\n\nstatic inline struct raw_iter_state *raw_seq_private(struct seq_file *seq)\n{\n\treturn seq->private;\n}\nvoid *raw_seq_start(struct seq_file *seq, loff_t *pos);\nvoid *raw_seq_next(struct seq_file *seq, void *v, loff_t *pos);\nvoid raw_seq_stop(struct seq_file *seq, void *v);\n#endif\n\nint raw_hash_sk(struct sock *sk);\nvoid raw_unhash_sk(struct sock *sk);\nvoid raw_init(void);\n\nstruct raw_sock {\n\t \n\tstruct inet_sock   inet;\n\tstruct icmp_filter filter;\n\tu32\t\t   ipmr_table;\n};\n\n#define raw_sk(ptr) container_of_const(ptr, struct raw_sock, inet.sk)\n\nstatic inline bool raw_sk_bound_dev_eq(struct net *net, int bound_dev_if,\n\t\t\t\t       int dif, int sdif)\n{\n#if IS_ENABLED(CONFIG_NET_L3_MASTER_DEV)\n\treturn inet_bound_dev_eq(READ_ONCE(net->ipv4.sysctl_raw_l3mdev_accept),\n\t\t\t\t bound_dev_if, dif, sdif);\n#else\n\treturn inet_bound_dev_eq(true, bound_dev_if, dif, sdif);\n#endif\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}