{
  "module_name": "xdp_sock.h",
  "hash_id": "f0b0f053dc33c8f0218a0069244a555c00db6051a043605c294cc235eb8d78c1",
  "original_prompt": "Ingested from linux-6.6.14/include/net/xdp_sock.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_XDP_SOCK_H\n#define _LINUX_XDP_SOCK_H\n\n#include <linux/bpf.h>\n#include <linux/workqueue.h>\n#include <linux/if_xdp.h>\n#include <linux/mutex.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <net/sock.h>\n\n#define XDP_UMEM_SG_FLAG (1 << 1)\n\nstruct net_device;\nstruct xsk_queue;\nstruct xdp_buff;\n\nstruct xdp_umem {\n\tvoid *addrs;\n\tu64 size;\n\tu32 headroom;\n\tu32 chunk_size;\n\tu32 chunks;\n\tu32 npgs;\n\tstruct user_struct *user;\n\trefcount_t users;\n\tu8 flags;\n\tbool zc;\n\tstruct page **pgs;\n\tint id;\n\tstruct list_head xsk_dma_list;\n\tstruct work_struct work;\n};\n\nstruct xsk_map {\n\tstruct bpf_map map;\n\tspinlock_t lock;  \n\tatomic_t count;\n\tstruct xdp_sock __rcu *xsk_map[];\n};\n\nstruct xdp_sock {\n\t \n\tstruct sock sk;\n\tstruct xsk_queue *rx ____cacheline_aligned_in_smp;\n\tstruct net_device *dev;\n\tstruct xdp_umem *umem;\n\tstruct list_head flush_node;\n\tstruct xsk_buff_pool *pool;\n\tu16 queue_id;\n\tbool zc;\n\tbool sg;\n\tenum {\n\t\tXSK_READY = 0,\n\t\tXSK_BOUND,\n\t\tXSK_UNBOUND,\n\t} state;\n\n\tstruct xsk_queue *tx ____cacheline_aligned_in_smp;\n\tstruct list_head tx_list;\n\t \n\tspinlock_t rx_lock;\n\n\t \n\tu64 rx_dropped;\n\tu64 rx_queue_full;\n\n\t \n\tstruct sk_buff *skb;\n\n\tstruct list_head map_list;\n\t \n\tspinlock_t map_list_lock;\n\t \n\tstruct mutex mutex;\n\tstruct xsk_queue *fq_tmp;  \n\tstruct xsk_queue *cq_tmp;  \n};\n\n#ifdef CONFIG_XDP_SOCKETS\n\nint xsk_generic_rcv(struct xdp_sock *xs, struct xdp_buff *xdp);\nint __xsk_map_redirect(struct xdp_sock *xs, struct xdp_buff *xdp);\nvoid __xsk_map_flush(void);\n\n#else\n\nstatic inline int xsk_generic_rcv(struct xdp_sock *xs, struct xdp_buff *xdp)\n{\n\treturn -ENOTSUPP;\n}\n\nstatic inline int __xsk_map_redirect(struct xdp_sock *xs, struct xdp_buff *xdp)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void __xsk_map_flush(void)\n{\n}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}