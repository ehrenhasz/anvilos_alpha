{
  "module_name": "gso.h",
  "hash_id": "4a3c3f62c5d77db85a018390c3bad897c8f1eb21530cddf11b29bb6284011430",
  "original_prompt": "Ingested from linux-6.6.14/include/net/gso.h",
  "human_readable_source": " \n\n#ifndef _NET_GSO_H\n#define _NET_GSO_H\n\n#include <linux/skbuff.h>\n\n \nstruct skb_gso_cb {\n\tunion {\n\t\tint\tmac_offset;\n\t\tint\tdata_offset;\n\t};\n\tint\tencap_level;\n\t__wsum\tcsum;\n\t__u16\tcsum_start;\n};\n#define SKB_GSO_CB_OFFSET\t32\n#define SKB_GSO_CB(skb) ((struct skb_gso_cb *)((skb)->cb + SKB_GSO_CB_OFFSET))\n\nstatic inline int skb_tnl_header_len(const struct sk_buff *inner_skb)\n{\n\treturn (skb_mac_header(inner_skb) - inner_skb->head) -\n\t\tSKB_GSO_CB(inner_skb)->mac_offset;\n}\n\nstatic inline int gso_pskb_expand_head(struct sk_buff *skb, int extra)\n{\n\tint new_headroom, headroom;\n\tint ret;\n\n\theadroom = skb_headroom(skb);\n\tret = pskb_expand_head(skb, extra, 0, GFP_ATOMIC);\n\tif (ret)\n\t\treturn ret;\n\n\tnew_headroom = skb_headroom(skb);\n\tSKB_GSO_CB(skb)->mac_offset += (new_headroom - headroom);\n\treturn 0;\n}\n\nstatic inline void gso_reset_checksum(struct sk_buff *skb, __wsum res)\n{\n\t \n\tif (skb->remcsum_offload)\n\t\treturn;\n\n\tSKB_GSO_CB(skb)->csum = res;\n\tSKB_GSO_CB(skb)->csum_start = skb_checksum_start(skb) - skb->head;\n}\n\n \nstatic inline __sum16 gso_make_checksum(struct sk_buff *skb, __wsum res)\n{\n\tunsigned char *csum_start = skb_transport_header(skb);\n\tint plen = (skb->head + SKB_GSO_CB(skb)->csum_start) - csum_start;\n\t__wsum partial = SKB_GSO_CB(skb)->csum;\n\n\tSKB_GSO_CB(skb)->csum = res;\n\tSKB_GSO_CB(skb)->csum_start = csum_start - skb->head;\n\n\treturn csum_fold(csum_partial(csum_start, plen, partial));\n}\n\nstruct sk_buff *__skb_gso_segment(struct sk_buff *skb,\n\t\t\t\t  netdev_features_t features, bool tx_path);\n\nstatic inline struct sk_buff *skb_gso_segment(struct sk_buff *skb,\n\t\t\t\t\t      netdev_features_t features)\n{\n\treturn __skb_gso_segment(skb, features, true);\n}\n\nstruct sk_buff *skb_eth_gso_segment(struct sk_buff *skb,\n\t\t\t\t    netdev_features_t features, __be16 type);\n\nstruct sk_buff *skb_mac_gso_segment(struct sk_buff *skb,\n\t\t\t\t    netdev_features_t features);\n\nbool skb_gso_validate_network_len(const struct sk_buff *skb, unsigned int mtu);\n\nbool skb_gso_validate_mac_len(const struct sk_buff *skb, unsigned int len);\n\nstatic inline void skb_gso_error_unwind(struct sk_buff *skb, __be16 protocol,\n\t\t\t\t\tint pulled_hlen, u16 mac_offset,\n\t\t\t\t\tint mac_len)\n{\n\tskb->protocol = protocol;\n\tskb->encapsulation = 1;\n\tskb_push(skb, pulled_hlen);\n\tskb_reset_transport_header(skb);\n\tskb->mac_header = mac_offset;\n\tskb->network_header = skb->mac_header + mac_len;\n\tskb->mac_len = mac_len;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}