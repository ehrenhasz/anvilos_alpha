{
  "module_name": "pep.h",
  "hash_id": "71b06211479087ae4b3f09dad19e93d24ef5a854cabf2a65eeca908a13498b62",
  "original_prompt": "Ingested from linux-6.6.14/include/net/phonet/pep.h",
  "human_readable_source": " \n \n\n#ifndef NET_PHONET_PEP_H\n#define NET_PHONET_PEP_H\n\n#include <linux/skbuff.h>\n#include <net/phonet/phonet.h>\n\nstruct pep_sock {\n\tstruct pn_sock\t\tpn_sk;\n\n\t \n\t \n\tstruct hlist_head\thlist;\n\n\t \n\tstruct sock\t\t*listener;\n\tstruct sk_buff_head\tctrlreq_queue;\n#define PNPIPE_CTRLREQ_MAX\t10\n\tatomic_t\t\ttx_credits;\n\tint\t\t\tifindex;\n\tu16\t\t\tpeer_type;\t \n\tu8\t\t\tpipe_handle;\n\n\tu8\t\t\trx_credits;\n\tu8\t\t\trx_fc;\t \n\tu8\t\t\ttx_fc;\t \n\tu8\t\t\tinit_enable;\t \n\tu8\t\t\taligned;\n};\n\nstatic inline struct pep_sock *pep_sk(struct sock *sk)\n{\n\treturn (struct pep_sock *)sk;\n}\n\nextern const struct proto_ops phonet_stream_ops;\n\n \nstruct pnpipehdr {\n\tu8\t\t\tutid;  \n\tu8\t\t\tmessage_id;\n\tu8\t\t\tpipe_handle;\n\tunion {\n\t\tu8\t\tstate_after_connect;\t \n\t\tu8\t\tstate_after_reset;\t \n\t\tu8\t\terror_code;\t\t \n\t\tu8\t\tpep_type;\t\t \n\t\tu8\t\tdata0;\t\t\t \n\t};\n\tu8\t\t\tdata[];\n};\n#define other_pep_type\t\tdata[0]\n\nstatic inline struct pnpipehdr *pnp_hdr(struct sk_buff *skb)\n{\n\treturn (struct pnpipehdr *)skb_transport_header(skb);\n}\n\n#define MAX_PNPIPE_HEADER (MAX_PHONET_HEADER + 4)\n\nenum {\n\tPNS_PIPE_CREATE_REQ = 0x00,\n\tPNS_PIPE_CREATE_RESP,\n\tPNS_PIPE_REMOVE_REQ,\n\tPNS_PIPE_REMOVE_RESP,\n\n\tPNS_PIPE_DATA = 0x20,\n\tPNS_PIPE_ALIGNED_DATA,\n\n\tPNS_PEP_CONNECT_REQ = 0x40,\n\tPNS_PEP_CONNECT_RESP,\n\tPNS_PEP_DISCONNECT_REQ,\n\tPNS_PEP_DISCONNECT_RESP,\n\tPNS_PEP_RESET_REQ,\n\tPNS_PEP_RESET_RESP,\n\tPNS_PEP_ENABLE_REQ,\n\tPNS_PEP_ENABLE_RESP,\n\tPNS_PEP_CTRL_REQ,\n\tPNS_PEP_CTRL_RESP,\n\tPNS_PEP_DISABLE_REQ = 0x4C,\n\tPNS_PEP_DISABLE_RESP,\n\n\tPNS_PEP_STATUS_IND = 0x60,\n\tPNS_PIPE_CREATED_IND,\n\tPNS_PIPE_RESET_IND = 0x63,\n\tPNS_PIPE_ENABLED_IND,\n\tPNS_PIPE_REDIRECTED_IND,\n\tPNS_PIPE_DISABLED_IND = 0x66,\n};\n\n#define PN_PIPE_INVALID_HANDLE\t0xff\n#define PN_PEP_TYPE_COMMON\t0x00\n\n \nenum {\n\tPN_PEP_IND_FLOW_CONTROL,\n\tPN_PEP_IND_ID_MCFC_GRANT_CREDITS,\n};\n\n \nenum {\n\tPN_PIPE_NO_ERROR,\n\tPN_PIPE_ERR_INVALID_PARAM,\n\tPN_PIPE_ERR_INVALID_HANDLE,\n\tPN_PIPE_ERR_INVALID_CTRL_ID,\n\tPN_PIPE_ERR_NOT_ALLOWED,\n\tPN_PIPE_ERR_PEP_IN_USE,\n\tPN_PIPE_ERR_OVERLOAD,\n\tPN_PIPE_ERR_DEV_DISCONNECTED,\n\tPN_PIPE_ERR_TIMEOUT,\n\tPN_PIPE_ERR_ALL_PIPES_IN_USE,\n\tPN_PIPE_ERR_GENERAL,\n\tPN_PIPE_ERR_NOT_SUPPORTED,\n};\n\n \nenum {\n\tPN_PIPE_DISABLE,\n\tPN_PIPE_ENABLE,\n};\n\n \nenum {\n\tPN_PIPE_SB_CREATE_REQ_PEP_SUB_TYPE,\n\tPN_PIPE_SB_CONNECT_REQ_PEP_SUB_TYPE,\n\tPN_PIPE_SB_REDIRECT_REQ_PEP_SUB_TYPE,\n\tPN_PIPE_SB_NEGOTIATED_FC,\n\tPN_PIPE_SB_REQUIRED_FC_TX,\n\tPN_PIPE_SB_PREFERRED_FC_RX,\n\tPN_PIPE_SB_ALIGNED_DATA,\n};\n\n \nenum {\n\tPN_NO_FLOW_CONTROL,\n\tPN_LEGACY_FLOW_CONTROL,\n\tPN_ONE_CREDIT_FLOW_CONTROL,\n\tPN_MULTI_CREDIT_FLOW_CONTROL,\n\tPN_MAX_FLOW_CONTROL,\n};\n\n#define pn_flow_safe(fc) ((fc) >> 1)\n\n \nenum {\n\tPEP_IND_EMPTY,\n\tPEP_IND_BUSY,\n\tPEP_IND_READY,\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}