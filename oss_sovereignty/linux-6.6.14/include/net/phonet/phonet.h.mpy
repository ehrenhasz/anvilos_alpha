{
  "module_name": "phonet.h",
  "hash_id": "7e2956a8193b943b0ca2bcbfa5c421c0e5fd44c89a569bf6fedab2eefebfecd0",
  "original_prompt": "Ingested from linux-6.6.14/include/net/phonet/phonet.h",
  "human_readable_source": " \n \n\n#ifndef AF_PHONET_H\n#define AF_PHONET_H\n\n#include <linux/phonet.h>\n#include <linux/skbuff.h>\n#include <net/sock.h>\n\n \n#define MAX_PHONET_HEADER\t(8 + MAX_HEADER)\n\n \nstruct pn_sock {\n\tstruct sock\tsk;\n\tu16\t\tsobject;\n\tu16\t\tdobject;\n\tu8\t\tresource;\n};\n\nstatic inline struct pn_sock *pn_sk(struct sock *sk)\n{\n\treturn (struct pn_sock *)sk;\n}\n\nextern const struct proto_ops phonet_dgram_ops;\n\nvoid pn_sock_init(void);\nstruct sock *pn_find_sock_by_sa(struct net *net, const struct sockaddr_pn *sa);\nvoid pn_deliver_sock_broadcast(struct net *net, struct sk_buff *skb);\nvoid phonet_get_local_port_range(int *min, int *max);\nint pn_sock_hash(struct sock *sk);\nvoid pn_sock_unhash(struct sock *sk);\nint pn_sock_get_port(struct sock *sk, unsigned short sport);\n\nstruct sock *pn_find_sock_by_res(struct net *net, u8 res);\nint pn_sock_bind_res(struct sock *sock, u8 res);\nint pn_sock_unbind_res(struct sock *sk, u8 res);\nvoid pn_sock_unbind_all_res(struct sock *sk);\n\nint pn_skb_send(struct sock *sk, struct sk_buff *skb,\n\t\tconst struct sockaddr_pn *target);\n\nstatic inline struct phonethdr *pn_hdr(struct sk_buff *skb)\n{\n\treturn (struct phonethdr *)skb_network_header(skb);\n}\n\nstatic inline struct phonetmsg *pn_msg(struct sk_buff *skb)\n{\n\treturn (struct phonetmsg *)skb_transport_header(skb);\n}\n\n \nstatic inline\nvoid pn_skb_get_src_sockaddr(struct sk_buff *skb, struct sockaddr_pn *sa)\n{\n\tstruct phonethdr *ph = pn_hdr(skb);\n\tu16 obj = pn_object(ph->pn_sdev, ph->pn_sobj);\n\n\tsa->spn_family = AF_PHONET;\n\tpn_sockaddr_set_object(sa, obj);\n\tpn_sockaddr_set_resource(sa, ph->pn_res);\n\tmemset(sa->spn_zero, 0, sizeof(sa->spn_zero));\n}\n\nstatic inline\nvoid pn_skb_get_dst_sockaddr(struct sk_buff *skb, struct sockaddr_pn *sa)\n{\n\tstruct phonethdr *ph = pn_hdr(skb);\n\tu16 obj = pn_object(ph->pn_rdev, ph->pn_robj);\n\n\tsa->spn_family = AF_PHONET;\n\tpn_sockaddr_set_object(sa, obj);\n\tpn_sockaddr_set_resource(sa, ph->pn_res);\n\tmemset(sa->spn_zero, 0, sizeof(sa->spn_zero));\n}\n\n \nstruct phonet_protocol {\n\tconst struct proto_ops\t*ops;\n\tstruct proto\t\t*prot;\n\tint\t\t\tsock_type;\n};\n\nint phonet_proto_register(unsigned int protocol,\n\t\tconst struct phonet_protocol *pp);\nvoid phonet_proto_unregister(unsigned int protocol,\n\t\tconst struct phonet_protocol *pp);\n\nint phonet_sysctl_init(void);\nvoid phonet_sysctl_exit(void);\nint isi_register(void);\nvoid isi_unregister(void);\n\nstatic inline bool sk_is_phonet(struct sock *sk)\n{\n\treturn sk->sk_family == PF_PHONET;\n}\n\nstatic inline int phonet_sk_ioctl(struct sock *sk, unsigned int cmd,\n\t\t\t\t  void __user *arg)\n{\n\tint karg;\n\n\tswitch (cmd) {\n\tcase SIOCPNADDRESOURCE:\n\tcase SIOCPNDELRESOURCE:\n\t\tif (get_user(karg, (int __user *)arg))\n\t\t\treturn -EFAULT;\n\n\t\treturn sk->sk_prot->ioctl(sk, cmd, &karg);\n\t}\n\t \n\treturn 1;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}