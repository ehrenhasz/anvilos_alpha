{
  "module_name": "nsh.h",
  "hash_id": "7c693918106a1c4f8b22c741c66203a9fc1e6c4f70d11ec371d94a0ce1a88f5e",
  "original_prompt": "Ingested from linux-6.6.14/include/net/nsh.h",
  "human_readable_source": "#ifndef __NET_NSH_H\n#define __NET_NSH_H 1\n\n#include <linux/skbuff.h>\n\n \n\n \nstruct nsh_md1_ctx {\n\t__be32 context[4];\n};\n\nstruct nsh_md2_tlv {\n\t__be16 md_class;\n\tu8 type;\n\tu8 length;\n\tu8 md_value[];\n};\n\nstruct nshhdr {\n\t__be16 ver_flags_ttl_len;\n\tu8 mdtype;\n\tu8 np;\n\t__be32 path_hdr;\n\tunion {\n\t    struct nsh_md1_ctx md1;\n\t    struct nsh_md2_tlv md2;\n\t};\n};\n\n \n#define NSH_VER_MASK       0xc000\n#define NSH_VER_SHIFT      14\n#define NSH_FLAGS_MASK     0x3000\n#define NSH_FLAGS_SHIFT    12\n#define NSH_TTL_MASK       0x0fc0\n#define NSH_TTL_SHIFT      6\n#define NSH_LEN_MASK       0x003f\n#define NSH_LEN_SHIFT      0\n\n#define NSH_MDTYPE_MASK    0x0f\n#define NSH_MDTYPE_SHIFT   0\n\n#define NSH_SPI_MASK       0xffffff00\n#define NSH_SPI_SHIFT      8\n#define NSH_SI_MASK        0x000000ff\n#define NSH_SI_SHIFT       0\n\n \n#define NSH_M_TYPE1     0x01\n#define NSH_M_TYPE2     0x02\n#define NSH_M_EXP1      0xFE\n#define NSH_M_EXP2      0xFF\n\n \n#define NSH_BASE_HDR_LEN  8\n\n \n#define NSH_M_TYPE1_LEN   24\n\n \n#define NSH_HDR_MAX_LEN 256\n\n \n#define NSH_CTX_HDRS_MAX_LEN 248\n\nstatic inline struct nshhdr *nsh_hdr(struct sk_buff *skb)\n{\n\treturn (struct nshhdr *)skb_network_header(skb);\n}\n\nstatic inline u16 nsh_hdr_len(const struct nshhdr *nsh)\n{\n\treturn ((ntohs(nsh->ver_flags_ttl_len) & NSH_LEN_MASK)\n\t\t>> NSH_LEN_SHIFT) << 2;\n}\n\nstatic inline u8 nsh_get_ver(const struct nshhdr *nsh)\n{\n\treturn (ntohs(nsh->ver_flags_ttl_len) & NSH_VER_MASK)\n\t\t>> NSH_VER_SHIFT;\n}\n\nstatic inline u8 nsh_get_flags(const struct nshhdr *nsh)\n{\n\treturn (ntohs(nsh->ver_flags_ttl_len) & NSH_FLAGS_MASK)\n\t\t>> NSH_FLAGS_SHIFT;\n}\n\nstatic inline u8 nsh_get_ttl(const struct nshhdr *nsh)\n{\n\treturn (ntohs(nsh->ver_flags_ttl_len) & NSH_TTL_MASK)\n\t\t>> NSH_TTL_SHIFT;\n}\n\nstatic inline void __nsh_set_xflag(struct nshhdr *nsh, u16 xflag, u16 xmask)\n{\n\tnsh->ver_flags_ttl_len\n\t\t= (nsh->ver_flags_ttl_len & ~htons(xmask)) | htons(xflag);\n}\n\nstatic inline void nsh_set_flags_and_ttl(struct nshhdr *nsh, u8 flags, u8 ttl)\n{\n\t__nsh_set_xflag(nsh, ((flags << NSH_FLAGS_SHIFT) & NSH_FLAGS_MASK) |\n\t\t\t     ((ttl << NSH_TTL_SHIFT) & NSH_TTL_MASK),\n\t\t\tNSH_FLAGS_MASK | NSH_TTL_MASK);\n}\n\nstatic inline void nsh_set_flags_ttl_len(struct nshhdr *nsh, u8 flags,\n\t\t\t\t\t u8 ttl, u8 len)\n{\n\tlen = len >> 2;\n\t__nsh_set_xflag(nsh, ((flags << NSH_FLAGS_SHIFT) & NSH_FLAGS_MASK) |\n\t\t\t     ((ttl << NSH_TTL_SHIFT) & NSH_TTL_MASK) |\n\t\t\t     ((len << NSH_LEN_SHIFT) & NSH_LEN_MASK),\n\t\t\tNSH_FLAGS_MASK | NSH_TTL_MASK | NSH_LEN_MASK);\n}\n\nint nsh_push(struct sk_buff *skb, const struct nshhdr *pushed_nh);\nint nsh_pop(struct sk_buff *skb);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}