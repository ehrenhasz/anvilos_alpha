{
  "module_name": "netlabel.h",
  "hash_id": "98a0a4a75f8ad60d520f71846b63ee15f7b3f59633ca1d4e8b7b637065fdd244",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netlabel.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _NETLABEL_H\n#define _NETLABEL_H\n\n#include <linux/types.h>\n#include <linux/slab.h>\n#include <linux/net.h>\n#include <linux/skbuff.h>\n#include <linux/in.h>\n#include <linux/in6.h>\n#include <net/netlink.h>\n#include <net/request_sock.h>\n#include <linux/refcount.h>\n\nstruct cipso_v4_doi;\nstruct calipso_doi;\n\n \n\n \n\n \n#define NETLBL_PROTO_VERSION            3\n\n \n#define NETLBL_NLTYPE_NONE              0\n#define NETLBL_NLTYPE_MGMT              1\n#define NETLBL_NLTYPE_MGMT_NAME         \"NLBL_MGMT\"\n#define NETLBL_NLTYPE_RIPSO             2\n#define NETLBL_NLTYPE_RIPSO_NAME        \"NLBL_RIPSO\"\n#define NETLBL_NLTYPE_CIPSOV4           3\n#define NETLBL_NLTYPE_CIPSOV4_NAME      \"NLBL_CIPSOv4\"\n#define NETLBL_NLTYPE_CIPSOV6           4\n#define NETLBL_NLTYPE_CIPSOV6_NAME      \"NLBL_CIPSOv6\"\n#define NETLBL_NLTYPE_UNLABELED         5\n#define NETLBL_NLTYPE_UNLABELED_NAME    \"NLBL_UNLBL\"\n#define NETLBL_NLTYPE_ADDRSELECT        6\n#define NETLBL_NLTYPE_ADDRSELECT_NAME   \"NLBL_ADRSEL\"\n#define NETLBL_NLTYPE_CALIPSO           7\n#define NETLBL_NLTYPE_CALIPSO_NAME      \"NLBL_CALIPSO\"\n\n \n\n \nstruct netlbl_audit {\n\tu32 secid;\n\tkuid_t loginuid;\n\tunsigned int sessionid;\n};\n\n \n\n \nstruct netlbl_lsm_cache {\n\trefcount_t refcount;\n\tvoid (*free) (const void *data);\n\tvoid *data;\n};\n\n \n#define NETLBL_CATMAP_MAPTYPE           u64\n#define NETLBL_CATMAP_MAPCNT            4\n#define NETLBL_CATMAP_MAPSIZE           (sizeof(NETLBL_CATMAP_MAPTYPE) * 8)\n#define NETLBL_CATMAP_SIZE              (NETLBL_CATMAP_MAPSIZE * \\\n\t\t\t\t\t NETLBL_CATMAP_MAPCNT)\n#define NETLBL_CATMAP_BIT               (NETLBL_CATMAP_MAPTYPE)0x01\nstruct netlbl_lsm_catmap {\n\tu32 startbit;\n\tNETLBL_CATMAP_MAPTYPE bitmap[NETLBL_CATMAP_MAPCNT];\n\tstruct netlbl_lsm_catmap *next;\n};\n\n \nstruct netlbl_lsm_secattr {\n\tu32 flags;\n\t \n#define NETLBL_SECATTR_NONE             0x00000000\n#define NETLBL_SECATTR_DOMAIN           0x00000001\n#define NETLBL_SECATTR_DOMAIN_CPY       (NETLBL_SECATTR_DOMAIN | \\\n\t\t\t\t\t NETLBL_SECATTR_FREE_DOMAIN)\n#define NETLBL_SECATTR_CACHE            0x00000002\n#define NETLBL_SECATTR_MLS_LVL          0x00000004\n#define NETLBL_SECATTR_MLS_CAT          0x00000008\n#define NETLBL_SECATTR_SECID            0x00000010\n\t \n#define NETLBL_SECATTR_FREE_DOMAIN      0x01000000\n#define NETLBL_SECATTR_CACHEABLE        (NETLBL_SECATTR_MLS_LVL | \\\n\t\t\t\t\t NETLBL_SECATTR_MLS_CAT | \\\n\t\t\t\t\t NETLBL_SECATTR_SECID)\n\tu32 type;\n\tchar *domain;\n\tstruct netlbl_lsm_cache *cache;\n\tstruct {\n\t\tstruct {\n\t\t\tstruct netlbl_lsm_catmap *cat;\n\t\t\tu32 lvl;\n\t\t} mls;\n\t\tu32 secid;\n\t} attr;\n};\n\n \nstruct netlbl_calipso_ops {\n\tint (*doi_add)(struct calipso_doi *doi_def,\n\t\t       struct netlbl_audit *audit_info);\n\tvoid (*doi_free)(struct calipso_doi *doi_def);\n\tint (*doi_remove)(u32 doi, struct netlbl_audit *audit_info);\n\tstruct calipso_doi *(*doi_getdef)(u32 doi);\n\tvoid (*doi_putdef)(struct calipso_doi *doi_def);\n\tint (*doi_walk)(u32 *skip_cnt,\n\t\t\tint (*callback)(struct calipso_doi *doi_def, void *arg),\n\t\t\tvoid *cb_arg);\n\tint (*sock_getattr)(struct sock *sk,\n\t\t\t    struct netlbl_lsm_secattr *secattr);\n\tint (*sock_setattr)(struct sock *sk,\n\t\t\t    const struct calipso_doi *doi_def,\n\t\t\t    const struct netlbl_lsm_secattr *secattr);\n\tvoid (*sock_delattr)(struct sock *sk);\n\tint (*req_setattr)(struct request_sock *req,\n\t\t\t   const struct calipso_doi *doi_def,\n\t\t\t   const struct netlbl_lsm_secattr *secattr);\n\tvoid (*req_delattr)(struct request_sock *req);\n\tint (*opt_getattr)(const unsigned char *calipso,\n\t\t\t   struct netlbl_lsm_secattr *secattr);\n\tunsigned char *(*skbuff_optptr)(const struct sk_buff *skb);\n\tint (*skbuff_setattr)(struct sk_buff *skb,\n\t\t\t      const struct calipso_doi *doi_def,\n\t\t\t      const struct netlbl_lsm_secattr *secattr);\n\tint (*skbuff_delattr)(struct sk_buff *skb);\n\tvoid (*cache_invalidate)(void);\n\tint (*cache_add)(const unsigned char *calipso_ptr,\n\t\t\t const struct netlbl_lsm_secattr *secattr);\n};\n\n \n\n \nstatic inline struct netlbl_lsm_cache *netlbl_secattr_cache_alloc(gfp_t flags)\n{\n\tstruct netlbl_lsm_cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), flags);\n\tif (cache)\n\t\trefcount_set(&cache->refcount, 1);\n\treturn cache;\n}\n\n \nstatic inline void netlbl_secattr_cache_free(struct netlbl_lsm_cache *cache)\n{\n\tif (!refcount_dec_and_test(&cache->refcount))\n\t\treturn;\n\n\tif (cache->free)\n\t\tcache->free(cache->data);\n\tkfree(cache);\n}\n\n \nstatic inline struct netlbl_lsm_catmap *netlbl_catmap_alloc(gfp_t flags)\n{\n\treturn kzalloc(sizeof(struct netlbl_lsm_catmap), flags);\n}\n\n \nstatic inline void netlbl_catmap_free(struct netlbl_lsm_catmap *catmap)\n{\n\tstruct netlbl_lsm_catmap *iter;\n\n\twhile (catmap) {\n\t\titer = catmap;\n\t\tcatmap = catmap->next;\n\t\tkfree(iter);\n\t}\n}\n\n \nstatic inline void netlbl_secattr_init(struct netlbl_lsm_secattr *secattr)\n{\n\tmemset(secattr, 0, sizeof(*secattr));\n}\n\n \nstatic inline void netlbl_secattr_destroy(struct netlbl_lsm_secattr *secattr)\n{\n\tif (secattr->flags & NETLBL_SECATTR_FREE_DOMAIN)\n\t\tkfree(secattr->domain);\n\tif (secattr->flags & NETLBL_SECATTR_CACHE)\n\t\tnetlbl_secattr_cache_free(secattr->cache);\n\tif (secattr->flags & NETLBL_SECATTR_MLS_CAT)\n\t\tnetlbl_catmap_free(secattr->attr.mls.cat);\n}\n\n \nstatic inline struct netlbl_lsm_secattr *netlbl_secattr_alloc(gfp_t flags)\n{\n\treturn kzalloc(sizeof(struct netlbl_lsm_secattr), flags);\n}\n\n \nstatic inline void netlbl_secattr_free(struct netlbl_lsm_secattr *secattr)\n{\n\tnetlbl_secattr_destroy(secattr);\n\tkfree(secattr);\n}\n\n#ifdef CONFIG_NETLABEL\n \nint netlbl_cfg_map_del(const char *domain,\n\t\t       u16 family,\n\t\t       const void *addr,\n\t\t       const void *mask,\n\t\t       struct netlbl_audit *audit_info);\nint netlbl_cfg_unlbl_map_add(const char *domain,\n\t\t\t     u16 family,\n\t\t\t     const void *addr,\n\t\t\t     const void *mask,\n\t\t\t     struct netlbl_audit *audit_info);\nint netlbl_cfg_unlbl_static_add(struct net *net,\n\t\t\t\tconst char *dev_name,\n\t\t\t\tconst void *addr,\n\t\t\t\tconst void *mask,\n\t\t\t\tu16 family,\n\t\t\t\tu32 secid,\n\t\t\t\tstruct netlbl_audit *audit_info);\nint netlbl_cfg_unlbl_static_del(struct net *net,\n\t\t\t\tconst char *dev_name,\n\t\t\t\tconst void *addr,\n\t\t\t\tconst void *mask,\n\t\t\t\tu16 family,\n\t\t\t\tstruct netlbl_audit *audit_info);\nint netlbl_cfg_cipsov4_add(struct cipso_v4_doi *doi_def,\n\t\t\t   struct netlbl_audit *audit_info);\nvoid netlbl_cfg_cipsov4_del(u32 doi, struct netlbl_audit *audit_info);\nint netlbl_cfg_cipsov4_map_add(u32 doi,\n\t\t\t       const char *domain,\n\t\t\t       const struct in_addr *addr,\n\t\t\t       const struct in_addr *mask,\n\t\t\t       struct netlbl_audit *audit_info);\nint netlbl_cfg_calipso_add(struct calipso_doi *doi_def,\n\t\t\t   struct netlbl_audit *audit_info);\nvoid netlbl_cfg_calipso_del(u32 doi, struct netlbl_audit *audit_info);\nint netlbl_cfg_calipso_map_add(u32 doi,\n\t\t\t       const char *domain,\n\t\t\t       const struct in6_addr *addr,\n\t\t\t       const struct in6_addr *mask,\n\t\t\t       struct netlbl_audit *audit_info);\n \nint netlbl_catmap_walk(struct netlbl_lsm_catmap *catmap, u32 offset);\nint netlbl_catmap_walkrng(struct netlbl_lsm_catmap *catmap, u32 offset);\nint netlbl_catmap_getlong(struct netlbl_lsm_catmap *catmap,\n\t\t\t  u32 *offset,\n\t\t\t  unsigned long *bitmap);\nint netlbl_catmap_setbit(struct netlbl_lsm_catmap **catmap,\n\t\t\t u32 bit,\n\t\t\t gfp_t flags);\nint netlbl_catmap_setrng(struct netlbl_lsm_catmap **catmap,\n\t\t\t u32 start,\n\t\t\t u32 end,\n\t\t\t gfp_t flags);\nint netlbl_catmap_setlong(struct netlbl_lsm_catmap **catmap,\n\t\t\t  u32 offset,\n\t\t\t  unsigned long bitmap,\n\t\t\t  gfp_t flags);\n\n \nint netlbl_bitmap_walk(const unsigned char *bitmap, u32 bitmap_len,\n\t\t       u32 offset, u8 state);\nvoid netlbl_bitmap_setbit(unsigned char *bitmap, u32 bit, u8 state);\n\n \nint netlbl_enabled(void);\nint netlbl_sock_setattr(struct sock *sk,\n\t\t\tu16 family,\n\t\t\tconst struct netlbl_lsm_secattr *secattr);\nvoid netlbl_sock_delattr(struct sock *sk);\nint netlbl_sock_getattr(struct sock *sk,\n\t\t\tstruct netlbl_lsm_secattr *secattr);\nint netlbl_conn_setattr(struct sock *sk,\n\t\t\tstruct sockaddr *addr,\n\t\t\tconst struct netlbl_lsm_secattr *secattr);\nint netlbl_req_setattr(struct request_sock *req,\n\t\t       const struct netlbl_lsm_secattr *secattr);\nvoid netlbl_req_delattr(struct request_sock *req);\nint netlbl_skbuff_setattr(struct sk_buff *skb,\n\t\t\t  u16 family,\n\t\t\t  const struct netlbl_lsm_secattr *secattr);\nint netlbl_skbuff_getattr(const struct sk_buff *skb,\n\t\t\t  u16 family,\n\t\t\t  struct netlbl_lsm_secattr *secattr);\nvoid netlbl_skbuff_err(struct sk_buff *skb, u16 family, int error, int gateway);\n\n \nvoid netlbl_cache_invalidate(void);\nint netlbl_cache_add(const struct sk_buff *skb, u16 family,\n\t\t     const struct netlbl_lsm_secattr *secattr);\n\n \nstruct audit_buffer *netlbl_audit_start(int type,\n\t\t\t\t\tstruct netlbl_audit *audit_info);\n#else\nstatic inline int netlbl_cfg_map_del(const char *domain,\n\t\t\t\t     u16 family,\n\t\t\t\t     const void *addr,\n\t\t\t\t     const void *mask,\n\t\t\t\t     struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_cfg_unlbl_map_add(const char *domain,\n\t\t\t\t\t   u16 family,\n\t\t\t\t\t   void *addr,\n\t\t\t\t\t   void *mask,\n\t\t\t\t\t   struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_cfg_unlbl_static_add(struct net *net,\n\t\t\t\t\t      const char *dev_name,\n\t\t\t\t\t      const void *addr,\n\t\t\t\t\t      const void *mask,\n\t\t\t\t\t      u16 family,\n\t\t\t\t\t      u32 secid,\n\t\t\t\t\t      struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_cfg_unlbl_static_del(struct net *net,\n\t\t\t\t\t      const char *dev_name,\n\t\t\t\t\t      const void *addr,\n\t\t\t\t\t      const void *mask,\n\t\t\t\t\t      u16 family,\n\t\t\t\t\t      struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_cfg_cipsov4_add(struct cipso_v4_doi *doi_def,\n\t\t\t\t\t struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline void netlbl_cfg_cipsov4_del(u32 doi,\n\t\t\t\t\t  struct netlbl_audit *audit_info)\n{\n\treturn;\n}\nstatic inline int netlbl_cfg_cipsov4_map_add(u32 doi,\n\t\t\t\t\t     const char *domain,\n\t\t\t\t\t     const struct in_addr *addr,\n\t\t\t\t\t     const struct in_addr *mask,\n\t\t\t\t\t     struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_cfg_calipso_add(struct calipso_doi *doi_def,\n\t\t\t\t\t struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline void netlbl_cfg_calipso_del(u32 doi,\n\t\t\t\t\t  struct netlbl_audit *audit_info)\n{\n\treturn;\n}\nstatic inline int netlbl_cfg_calipso_map_add(u32 doi,\n\t\t\t\t\t     const char *domain,\n\t\t\t\t\t     const struct in6_addr *addr,\n\t\t\t\t\t     const struct in6_addr *mask,\n\t\t\t\t\t     struct netlbl_audit *audit_info)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_catmap_walk(struct netlbl_lsm_catmap *catmap,\n\t\t\t\t     u32 offset)\n{\n\treturn -ENOENT;\n}\nstatic inline int netlbl_catmap_walkrng(struct netlbl_lsm_catmap *catmap,\n\t\t\t\t\tu32 offset)\n{\n\treturn -ENOENT;\n}\nstatic inline int netlbl_catmap_getlong(struct netlbl_lsm_catmap *catmap,\n\t\t\t\t\tu32 *offset,\n\t\t\t\t\tunsigned long *bitmap)\n{\n\treturn 0;\n}\nstatic inline int netlbl_catmap_setbit(struct netlbl_lsm_catmap **catmap,\n\t\t\t\t       u32 bit,\n\t\t\t\t       gfp_t flags)\n{\n\treturn 0;\n}\nstatic inline int netlbl_catmap_setrng(struct netlbl_lsm_catmap **catmap,\n\t\t\t\t       u32 start,\n\t\t\t\t       u32 end,\n\t\t\t\t       gfp_t flags)\n{\n\treturn 0;\n}\nstatic inline int netlbl_catmap_setlong(struct netlbl_lsm_catmap **catmap,\n\t\t\t\t\tu32 offset,\n\t\t\t\t\tunsigned long bitmap,\n\t\t\t\t\tgfp_t flags)\n{\n\treturn 0;\n}\nstatic inline int netlbl_enabled(void)\n{\n\treturn 0;\n}\nstatic inline int netlbl_sock_setattr(struct sock *sk,\n\t\t\t\t      u16 family,\n\t\t\t\t      const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline void netlbl_sock_delattr(struct sock *sk)\n{\n}\nstatic inline int netlbl_sock_getattr(struct sock *sk,\n\t\t\t\t      struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_conn_setattr(struct sock *sk,\n\t\t\t\t      struct sockaddr *addr,\n\t\t\t\t      const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_req_setattr(struct request_sock *req,\n\t\t\t\t     const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline void netlbl_req_delattr(struct request_sock *req)\n{\n\treturn;\n}\nstatic inline int netlbl_skbuff_setattr(struct sk_buff *skb,\n\t\t\t\t      u16 family,\n\t\t\t\t      const struct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline int netlbl_skbuff_getattr(const struct sk_buff *skb,\n\t\t\t\t\tu16 family,\n\t\t\t\t\tstruct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOSYS;\n}\nstatic inline void netlbl_skbuff_err(struct sk_buff *skb,\n\t\t\t\t     int error,\n\t\t\t\t     int gateway)\n{\n\treturn;\n}\nstatic inline void netlbl_cache_invalidate(void)\n{\n\treturn;\n}\nstatic inline int netlbl_cache_add(const struct sk_buff *skb, u16 family,\n\t\t\t\t   const struct netlbl_lsm_secattr *secattr)\n{\n\treturn 0;\n}\nstatic inline struct audit_buffer *netlbl_audit_start(int type,\n\t\t\t\t\t\tstruct netlbl_audit *audit_info)\n{\n\treturn NULL;\n}\n#endif  \n\nconst struct netlbl_calipso_ops *\nnetlbl_calipso_ops_register(const struct netlbl_calipso_ops *ops);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}