{
  "module_name": "nf_conntrack_expect.h",
  "hash_id": "b1efe79ec5dd4ff62c4041ee87aea5e5bdfd77db7d54f42f2e16c1530174c5b6",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_expect.h",
  "human_readable_source": " \n \n\n#ifndef _NF_CONNTRACK_EXPECT_H\n#define _NF_CONNTRACK_EXPECT_H\n\n#include <linux/refcount.h>\n\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_zones.h>\n\nextern unsigned int nf_ct_expect_hsize;\nextern unsigned int nf_ct_expect_max;\nextern struct hlist_head *nf_ct_expect_hash;\n\nstruct nf_conntrack_expect {\n\t \n\tstruct hlist_node lnode;\n\n\t \n\tstruct hlist_node hnode;\n\n\t \n\tstruct nf_conntrack_tuple tuple;\n\tstruct nf_conntrack_tuple_mask mask;\n\n\t \n\trefcount_t use;\n\n\t \n\tunsigned int flags;\n\n\t \n\tunsigned int class;\n\n\t \n\tvoid (*expectfn)(struct nf_conn *new,\n\t\t\t struct nf_conntrack_expect *this);\n\n\t \n\tstruct nf_conntrack_helper *helper;\n\n\t \n\tstruct nf_conn *master;\n\n\t \n\tstruct timer_list timeout;\n\n#if IS_ENABLED(CONFIG_NF_NAT)\n\tunion nf_inet_addr saved_addr;\n\t \n\tunion nf_conntrack_man_proto saved_proto;\n\t \n\tenum ip_conntrack_dir dir;\n#endif\n\n\tstruct rcu_head rcu;\n};\n\nstatic inline struct net *nf_ct_exp_net(struct nf_conntrack_expect *exp)\n{\n\treturn nf_ct_net(exp->master);\n}\n\n#define NF_CT_EXP_POLICY_NAME_LEN\t16\n\nstruct nf_conntrack_expect_policy {\n\tunsigned int\tmax_expected;\n\tunsigned int\ttimeout;\n\tchar\t\tname[NF_CT_EXP_POLICY_NAME_LEN];\n};\n\n#define NF_CT_EXPECT_CLASS_DEFAULT\t0\n#define NF_CT_EXPECT_MAX_CNT\t\t255\n\n \n#define NF_CT_EXP_F_SKIP_MASTER\t0x1\n\nint nf_conntrack_expect_pernet_init(struct net *net);\nvoid nf_conntrack_expect_pernet_fini(struct net *net);\n\nint nf_conntrack_expect_init(void);\nvoid nf_conntrack_expect_fini(void);\n\nstruct nf_conntrack_expect *\n__nf_ct_expect_find(struct net *net,\n\t\t    const struct nf_conntrack_zone *zone,\n\t\t    const struct nf_conntrack_tuple *tuple);\n\nstruct nf_conntrack_expect *\nnf_ct_expect_find_get(struct net *net,\n\t\t      const struct nf_conntrack_zone *zone,\n\t\t      const struct nf_conntrack_tuple *tuple);\n\nstruct nf_conntrack_expect *\nnf_ct_find_expectation(struct net *net,\n\t\t       const struct nf_conntrack_zone *zone,\n\t\t       const struct nf_conntrack_tuple *tuple, bool unlink);\n\nvoid nf_ct_unlink_expect_report(struct nf_conntrack_expect *exp,\n\t\t\t\tu32 portid, int report);\nstatic inline void nf_ct_unlink_expect(struct nf_conntrack_expect *exp)\n{\n\tnf_ct_unlink_expect_report(exp, 0, 0);\n}\n\nvoid nf_ct_remove_expectations(struct nf_conn *ct);\nvoid nf_ct_unexpect_related(struct nf_conntrack_expect *exp);\nbool nf_ct_remove_expect(struct nf_conntrack_expect *exp);\n\nvoid nf_ct_expect_iterate_destroy(bool (*iter)(struct nf_conntrack_expect *e, void *data), void *data);\nvoid nf_ct_expect_iterate_net(struct net *net,\n\t\t\t      bool (*iter)(struct nf_conntrack_expect *e, void *data),\n                              void *data, u32 portid, int report);\n\n \nstruct nf_conntrack_expect *nf_ct_expect_alloc(struct nf_conn *me);\nvoid nf_ct_expect_init(struct nf_conntrack_expect *, unsigned int, u_int8_t,\n\t\t       const union nf_inet_addr *,\n\t\t       const union nf_inet_addr *,\n\t\t       u_int8_t, const __be16 *, const __be16 *);\nvoid nf_ct_expect_put(struct nf_conntrack_expect *exp);\nint nf_ct_expect_related_report(struct nf_conntrack_expect *expect,\n\t\t\t\tu32 portid, int report, unsigned int flags);\nstatic inline int nf_ct_expect_related(struct nf_conntrack_expect *expect,\n\t\t\t\t       unsigned int flags)\n{\n\treturn nf_ct_expect_related_report(expect, 0, 0, flags);\n}\n\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}