{
  "module_name": "nf_tables_core.h",
  "hash_id": "17c994fe39a94804b64422928a1e52ff1416d1d8d8e9d27edc3395dc46fcbbe6",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_tables_core.h",
  "human_readable_source": " \n#ifndef _NET_NF_TABLES_CORE_H\n#define _NET_NF_TABLES_CORE_H\n\n#include <net/netfilter/nf_tables.h>\n#include <linux/indirect_call_wrapper.h>\n\nextern struct nft_expr_type nft_imm_type;\nextern struct nft_expr_type nft_cmp_type;\nextern struct nft_expr_type nft_counter_type;\nextern struct nft_expr_type nft_lookup_type;\nextern struct nft_expr_type nft_bitwise_type;\nextern struct nft_expr_type nft_byteorder_type;\nextern struct nft_expr_type nft_payload_type;\nextern struct nft_expr_type nft_dynset_type;\nextern struct nft_expr_type nft_range_type;\nextern struct nft_expr_type nft_meta_type;\nextern struct nft_expr_type nft_rt_type;\nextern struct nft_expr_type nft_exthdr_type;\nextern struct nft_expr_type nft_last_type;\nextern struct nft_expr_type nft_objref_type;\nextern struct nft_expr_type nft_inner_type;\n\n#ifdef CONFIG_NETWORK_SECMARK\nextern struct nft_object_type nft_secmark_obj_type;\n#endif\nextern struct nft_object_type nft_counter_obj_type;\n\nint nf_tables_core_module_init(void);\nvoid nf_tables_core_module_exit(void);\n\nstruct nft_bitwise_fast_expr {\n\tu32\t\t\tmask;\n\tu32\t\t\txor;\n\tu8\t\t\tsreg;\n\tu8\t\t\tdreg;\n};\n\nstruct nft_cmp_fast_expr {\n\tu32\t\t\tdata;\n\tu32\t\t\tmask;\n\tu8\t\t\tsreg;\n\tu8\t\t\tlen;\n\tbool\t\t\tinv;\n};\n\nstruct nft_cmp16_fast_expr {\n\tstruct nft_data\t\tdata;\n\tstruct nft_data\t\tmask;\n\tu8\t\t\tsreg;\n\tu8\t\t\tlen;\n\tbool\t\t\tinv;\n};\n\nstruct nft_immediate_expr {\n\tstruct nft_data\t\tdata;\n\tu8\t\t\tdreg;\n\tu8\t\t\tdlen;\n};\n\nextern const struct nft_expr_ops nft_cmp_fast_ops;\nextern const struct nft_expr_ops nft_cmp16_fast_ops;\n\nstruct nft_ct {\n\tenum nft_ct_keys\tkey:8;\n\tenum ip_conntrack_dir\tdir:8;\n\tu8\t\t\tlen;\n\tunion {\n\t\tu8\t\tdreg;\n\t\tu8\t\tsreg;\n\t};\n};\n\nstruct nft_payload {\n\tenum nft_payload_bases\tbase:8;\n\tu8\t\t\toffset;\n\tu8\t\t\tlen;\n\tu8\t\t\tdreg;\n};\n\nextern const struct nft_expr_ops nft_payload_fast_ops;\n\nextern const struct nft_expr_ops nft_bitwise_fast_ops;\n\nextern struct static_key_false nft_counters_enabled;\nextern struct static_key_false nft_trace_enabled;\n\nextern const struct nft_set_type nft_set_rhash_type;\nextern const struct nft_set_type nft_set_hash_type;\nextern const struct nft_set_type nft_set_hash_fast_type;\nextern const struct nft_set_type nft_set_rbtree_type;\nextern const struct nft_set_type nft_set_bitmap_type;\nextern const struct nft_set_type nft_set_pipapo_type;\nextern const struct nft_set_type nft_set_pipapo_avx2_type;\n\n#ifdef CONFIG_RETPOLINE\nbool nft_rhash_lookup(const struct net *net, const struct nft_set *set,\n\t\t      const u32 *key, const struct nft_set_ext **ext);\nbool nft_rbtree_lookup(const struct net *net, const struct nft_set *set,\n\t\t       const u32 *key, const struct nft_set_ext **ext);\nbool nft_bitmap_lookup(const struct net *net, const struct nft_set *set,\n\t\t       const u32 *key, const struct nft_set_ext **ext);\nbool nft_hash_lookup_fast(const struct net *net,\n\t\t\t  const struct nft_set *set,\n\t\t\t  const u32 *key, const struct nft_set_ext **ext);\nbool nft_hash_lookup(const struct net *net, const struct nft_set *set,\n\t\t     const u32 *key, const struct nft_set_ext **ext);\nbool nft_set_do_lookup(const struct net *net, const struct nft_set *set,\n\t\t       const u32 *key, const struct nft_set_ext **ext);\n#else\nstatic inline bool\nnft_set_do_lookup(const struct net *net, const struct nft_set *set,\n\t\t  const u32 *key, const struct nft_set_ext **ext)\n{\n\treturn set->ops->lookup(net, set, key, ext);\n}\n#endif\n\n \nbool nft_pipapo_lookup(const struct net *net, const struct nft_set *set,\n\t\t       const u32 *key, const struct nft_set_ext **ext);\n \nbool nft_pipapo_avx2_lookup(const struct net *net, const struct nft_set *set,\n\t\t\t    const u32 *key, const struct nft_set_ext **ext);\n\nvoid nft_counter_init_seqcount(void);\n\nstruct nft_expr;\nstruct nft_regs;\nstruct nft_pktinfo;\nvoid nft_meta_get_eval(const struct nft_expr *expr,\n\t\t       struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_cmp_eval(const struct nft_expr *expr,\n\t\t  struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_lookup_eval(const struct nft_expr *expr,\n\t\t     struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_payload_eval(const struct nft_expr *expr,\n\t\t      struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_immediate_eval(const struct nft_expr *expr,\n\t\t\tstruct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_bitwise_eval(const struct nft_expr *expr,\n\t\t      struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_range_eval(const struct nft_expr *expr,\n\t\t    struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_byteorder_eval(const struct nft_expr *expr,\n\t\t\tstruct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_dynset_eval(const struct nft_expr *expr,\n\t\t     struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_rt_get_eval(const struct nft_expr *expr,\n\t\t     struct nft_regs *regs, const struct nft_pktinfo *pkt);\nvoid nft_counter_eval(const struct nft_expr *expr, struct nft_regs *regs,\n                      const struct nft_pktinfo *pkt);\nvoid nft_ct_get_fast_eval(const struct nft_expr *expr,\n\t\t\t  struct nft_regs *regs, const struct nft_pktinfo *pkt);\n\nenum {\n\tNFT_PAYLOAD_CTX_INNER_TUN\t= (1 << 0),\n\tNFT_PAYLOAD_CTX_INNER_LL\t= (1 << 1),\n\tNFT_PAYLOAD_CTX_INNER_NH\t= (1 << 2),\n\tNFT_PAYLOAD_CTX_INNER_TH\t= (1 << 3),\n};\n\nstruct nft_inner_tun_ctx {\n\tu16\ttype;\n\tu16\tinner_tunoff;\n\tu16\tinner_lloff;\n\tu16\tinner_nhoff;\n\tu16\tinner_thoff;\n\t__be16\tllproto;\n\tu8\tl4proto;\n\tu8      flags;\n};\n\nint nft_payload_inner_offset(const struct nft_pktinfo *pkt);\nvoid nft_payload_inner_eval(const struct nft_expr *expr, struct nft_regs *regs,\n\t\t\t    const struct nft_pktinfo *pkt,\n\t\t\t    struct nft_inner_tun_ctx *ctx);\n\nvoid nft_objref_eval(const struct nft_expr *expr, struct nft_regs *regs,\n\t\t     const struct nft_pktinfo *pkt);\nvoid nft_objref_map_eval(const struct nft_expr *expr, struct nft_regs *regs,\n\t\t\t const struct nft_pktinfo *pkt);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}