{
  "module_name": "nf_conntrack_acct.h",
  "hash_id": "a83896a92b973322b5b79c932a2a3110971ef089b1940dc86f028eefe8c617d3",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_acct.h",
  "human_readable_source": " \n \n\n#ifndef _NF_CONNTRACK_ACCT_H\n#define _NF_CONNTRACK_ACCT_H\n#include <net/net_namespace.h>\n#include <linux/netfilter/nf_conntrack_common.h>\n#include <linux/netfilter/nf_conntrack_tuple_common.h>\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_extend.h>\n\nstruct nf_conn_counter {\n\tatomic64_t packets;\n\tatomic64_t bytes;\n};\n\nstruct nf_conn_acct {\n\tstruct nf_conn_counter counter[IP_CT_DIR_MAX];\n};\n\nstatic inline\nstruct nf_conn_acct *nf_conn_acct_find(const struct nf_conn *ct)\n{\n\treturn nf_ct_ext_find(ct, NF_CT_EXT_ACCT);\n}\n\nstatic inline\nstruct nf_conn_acct *nf_ct_acct_ext_add(struct nf_conn *ct, gfp_t gfp)\n{\n#if IS_ENABLED(CONFIG_NF_CONNTRACK)\n\tstruct net *net = nf_ct_net(ct);\n\tstruct nf_conn_acct *acct;\n\n\tif (!net->ct.sysctl_acct)\n\t\treturn NULL;\n\n\tacct = nf_ct_ext_add(ct, NF_CT_EXT_ACCT, gfp);\n\tif (!acct)\n\t\tpr_debug(\"failed to add accounting extension area\");\n\n\n\treturn acct;\n#else\n\treturn NULL;\n#endif\n}\n\n \nstatic inline bool nf_ct_acct_enabled(struct net *net)\n{\n#if IS_ENABLED(CONFIG_NF_CONNTRACK)\n\treturn net->ct.sysctl_acct != 0;\n#else\n\treturn false;\n#endif\n}\n\n \nstatic inline void nf_ct_set_acct(struct net *net, bool enable)\n{\n#if IS_ENABLED(CONFIG_NF_CONNTRACK)\n\tnet->ct.sysctl_acct = enable;\n#endif\n}\n\nvoid nf_ct_acct_add(struct nf_conn *ct, u32 dir, unsigned int packets,\n\t\t    unsigned int bytes);\n\nstatic inline void nf_ct_acct_update(struct nf_conn *ct, u32 dir,\n\t\t\t\t     unsigned int bytes)\n{\n#if IS_ENABLED(CONFIG_NF_CONNTRACK)\n\tnf_ct_acct_add(ct, dir, 1, bytes);\n#endif\n}\n\nvoid nf_conntrack_acct_pernet_init(struct net *net);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}