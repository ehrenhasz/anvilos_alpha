{
  "module_name": "nf_conntrack_helper.h",
  "hash_id": "7a80a3f35b8c5e4b6d17875bc6e4f9dbd462579203d7fbf6b3961127d75ad3f3",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_helper.h",
  "human_readable_source": " \n \n\n#ifndef _NF_CONNTRACK_HELPER_H\n#define _NF_CONNTRACK_HELPER_H\n#include <linux/refcount.h>\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_extend.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n\n#define NF_NAT_HELPER_PREFIX\t\t\"ip_nat_\"\n#define NF_NAT_HELPER_NAME(name)\tNF_NAT_HELPER_PREFIX name\n#define MODULE_ALIAS_NF_NAT_HELPER(name) \\\n\tMODULE_ALIAS(NF_NAT_HELPER_NAME(name))\n\nstruct module;\n\nenum nf_ct_helper_flags {\n\tNF_CT_HELPER_F_USERSPACE\t= (1 << 0),\n\tNF_CT_HELPER_F_CONFIGURED\t= (1 << 1),\n};\n\n#define NF_CT_HELPER_NAME_LEN\t16\n\nstruct nf_conntrack_helper {\n\tstruct hlist_node hnode;\t \n\n\tchar name[NF_CT_HELPER_NAME_LEN];  \n\trefcount_t refcnt;\n\tstruct module *me;\t\t \n\tconst struct nf_conntrack_expect_policy *expect_policy;\n\n\t \n\tstruct nf_conntrack_tuple tuple;\n\n\t \n\tint (*help)(struct sk_buff *skb,\n\t\t    unsigned int protoff,\n\t\t    struct nf_conn *ct,\n\t\t    enum ip_conntrack_info conntrackinfo);\n\n\tvoid (*destroy)(struct nf_conn *ct);\n\n\tint (*from_nlattr)(struct nlattr *attr, struct nf_conn *ct);\n\tint (*to_nlattr)(struct sk_buff *skb, const struct nf_conn *ct);\n\tunsigned int expect_class_max;\n\n\tunsigned int flags;\n\n\t \n\tunsigned int queue_num;\n\t \n\tu16 data_len;\n\t \n\tchar nat_mod_name[NF_CT_HELPER_NAME_LEN];\n};\n\n \n#define NF_CT_MAX_EXPECT_CLASSES\t4\n\n \nstruct nf_conn_help {\n\t \n\tstruct nf_conntrack_helper __rcu *helper;\n\n\tstruct hlist_head expectations;\n\n\t \n\tu8 expecting[NF_CT_MAX_EXPECT_CLASSES];\n\n\t \n\tchar data[32] __aligned(8);\n};\n\n#define NF_CT_HELPER_BUILD_BUG_ON(structsize) \\\n\tBUILD_BUG_ON((structsize) > sizeof_field(struct nf_conn_help, data))\n\nstruct nf_conntrack_helper *__nf_conntrack_helper_find(const char *name,\n\t\t\t\t\t\t       u16 l3num, u8 protonum);\n\nstruct nf_conntrack_helper *nf_conntrack_helper_try_module_get(const char *name,\n\t\t\t\t\t\t\t       u16 l3num,\n\t\t\t\t\t\t\t       u8 protonum);\nvoid nf_conntrack_helper_put(struct nf_conntrack_helper *helper);\n\nvoid nf_ct_helper_init(struct nf_conntrack_helper *helper,\n\t\t       u16 l3num, u16 protonum, const char *name,\n\t\t       u16 default_port, u16 spec_port, u32 id,\n\t\t       const struct nf_conntrack_expect_policy *exp_pol,\n\t\t       u32 expect_class_max,\n\t\t       int (*help)(struct sk_buff *skb, unsigned int protoff,\n\t\t\t\t   struct nf_conn *ct,\n\t\t\t\t   enum ip_conntrack_info ctinfo),\n\t\t       int (*from_nlattr)(struct nlattr *attr,\n\t\t\t\t\t  struct nf_conn *ct),\n\t\t       struct module *module);\n\nint nf_conntrack_helper_register(struct nf_conntrack_helper *);\nvoid nf_conntrack_helper_unregister(struct nf_conntrack_helper *);\n\nint nf_conntrack_helpers_register(struct nf_conntrack_helper *, unsigned int);\nvoid nf_conntrack_helpers_unregister(struct nf_conntrack_helper *,\n\t\t\t\t     unsigned int);\n\nstruct nf_conn_help *nf_ct_helper_ext_add(struct nf_conn *ct, gfp_t gfp);\n\nint __nf_ct_try_assign_helper(struct nf_conn *ct, struct nf_conn *tmpl,\n\t\t\t      gfp_t flags);\n\nint nf_ct_helper(struct sk_buff *skb, struct nf_conn *ct,\n\t\t enum ip_conntrack_info ctinfo, u16 proto);\nint nf_ct_add_helper(struct nf_conn *ct, const char *name, u8 family,\n\t\t     u8 proto, bool nat, struct nf_conntrack_helper **hp);\n\nvoid nf_ct_helper_destroy(struct nf_conn *ct);\n\nstatic inline struct nf_conn_help *nfct_help(const struct nf_conn *ct)\n{\n\treturn nf_ct_ext_find(ct, NF_CT_EXT_HELPER);\n}\n\nstatic inline void *nfct_help_data(const struct nf_conn *ct)\n{\n\tstruct nf_conn_help *help;\n\n\thelp = nf_ct_ext_find(ct, NF_CT_EXT_HELPER);\n\n\treturn (void *)help->data;\n}\n\nint nf_conntrack_helper_init(void);\nvoid nf_conntrack_helper_fini(void);\n\nint nf_conntrack_broadcast_help(struct sk_buff *skb, struct nf_conn *ct,\n\t\t\t\tenum ip_conntrack_info ctinfo,\n\t\t\t\tunsigned int timeout);\n\nstruct nf_ct_helper_expectfn {\n\tstruct list_head head;\n\tconst char *name;\n\tvoid (*expectfn)(struct nf_conn *ct, struct nf_conntrack_expect *exp);\n};\n\n__printf(3,4)\nvoid nf_ct_helper_log(struct sk_buff *skb, const struct nf_conn *ct,\n\t\t      const char *fmt, ...);\n\nvoid nf_ct_helper_expectfn_register(struct nf_ct_helper_expectfn *n);\nvoid nf_ct_helper_expectfn_unregister(struct nf_ct_helper_expectfn *n);\nstruct nf_ct_helper_expectfn *\nnf_ct_helper_expectfn_find_by_name(const char *name);\nstruct nf_ct_helper_expectfn *\nnf_ct_helper_expectfn_find_by_symbol(const void *symbol);\n\nextern struct hlist_head *nf_ct_helper_hash;\nextern unsigned int nf_ct_helper_hsize;\n\nstruct nf_conntrack_nat_helper {\n\tstruct list_head list;\n\tchar mod_name[NF_CT_HELPER_NAME_LEN];\t \n\tstruct module *module;\t\t\t \n};\n\n#define NF_CT_NAT_HELPER_INIT(name) \\\n\t{ \\\n\t.mod_name = NF_NAT_HELPER_NAME(name), \\\n\t.module = THIS_MODULE \\\n\t}\n\nvoid nf_nat_helper_register(struct nf_conntrack_nat_helper *nat);\nvoid nf_nat_helper_unregister(struct nf_conntrack_nat_helper *nat);\nint nf_nat_helper_try_module_get(const char *name, u16 l3num,\n\t\t\t\t u8 protonum);\nvoid nf_nat_helper_put(struct nf_conntrack_helper *helper);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}