{
  "module_name": "nf_tables_offload.h",
  "hash_id": "7fac07ef6c9280b98202cdc45e3d7a088ed08ee7299725caacf8973cf1a2333b",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_tables_offload.h",
  "human_readable_source": "#ifndef _NET_NF_TABLES_OFFLOAD_H\n#define _NET_NF_TABLES_OFFLOAD_H\n\n#include <net/flow_offload.h>\n#include <net/netfilter/nf_tables.h>\n\nenum nft_offload_reg_flags {\n\tNFT_OFFLOAD_F_NETWORK2HOST\t= (1 << 0),\n};\n\nstruct nft_offload_reg {\n\tu32\t\tkey;\n\tu32\t\tlen;\n\tu32\t\tbase_offset;\n\tu32\t\toffset;\n\tu32\t\tflags;\n\tstruct nft_data data;\n\tstruct nft_data\tmask;\n};\n\nenum nft_offload_dep_type {\n\tNFT_OFFLOAD_DEP_UNSPEC\t= 0,\n\tNFT_OFFLOAD_DEP_NETWORK,\n\tNFT_OFFLOAD_DEP_TRANSPORT,\n};\n\nstruct nft_offload_ctx {\n\tstruct {\n\t\tenum nft_offload_dep_type\ttype;\n\t\t__be16\t\t\t\tl3num;\n\t\tu8\t\t\t\tprotonum;\n\t} dep;\n\tunsigned int\t\t\t\tnum_actions;\n\tstruct net\t\t\t\t*net;\n\tstruct nft_offload_reg\t\t\tregs[NFT_REG32_15 + 1];\n};\n\nvoid nft_offload_set_dependency(struct nft_offload_ctx *ctx,\n\t\t\t\tenum nft_offload_dep_type type);\nvoid nft_offload_update_dependency(struct nft_offload_ctx *ctx,\n\t\t\t\t   const void *data, u32 len);\n\nstruct nft_flow_key {\n\tstruct flow_dissector_key_basic\t\t\tbasic;\n\tstruct flow_dissector_key_control\t\tcontrol;\n\tunion {\n\t\tstruct flow_dissector_key_ipv4_addrs\tipv4;\n\t\tstruct flow_dissector_key_ipv6_addrs\tipv6;\n\t};\n\tstruct flow_dissector_key_ports\t\t\ttp;\n\tstruct flow_dissector_key_ip\t\t\tip;\n\tstruct flow_dissector_key_vlan\t\t\tvlan;\n\tstruct flow_dissector_key_vlan\t\t\tcvlan;\n\tstruct flow_dissector_key_eth_addrs\t\teth_addrs;\n\tstruct flow_dissector_key_meta\t\t\tmeta;\n} __aligned(BITS_PER_LONG / 8);  \n\nstruct nft_flow_match {\n\tstruct flow_dissector\tdissector;\n\tstruct nft_flow_key\tkey;\n\tstruct nft_flow_key\tmask;\n};\n\nstruct nft_flow_rule {\n\t__be16\t\t\tproto;\n\tstruct nft_flow_match\tmatch;\n\tstruct flow_rule\t*rule;\n};\n\nvoid nft_flow_rule_set_addr_type(struct nft_flow_rule *flow,\n\t\t\t\t enum flow_dissector_key_id addr_type);\n\nstruct nft_rule;\nstruct nft_flow_rule *nft_flow_rule_create(struct net *net, const struct nft_rule *rule);\nint nft_flow_rule_stats(const struct nft_chain *chain, const struct nft_rule *rule);\nvoid nft_flow_rule_destroy(struct nft_flow_rule *flow);\nint nft_flow_rule_offload_commit(struct net *net);\n\n#define NFT_OFFLOAD_MATCH_FLAGS(__key, __base, __field, __len, __reg, __flags)\t\\\n\t(__reg)->base_offset\t=\t\t\t\t\t\\\n\t\toffsetof(struct nft_flow_key, __base);\t\t\t\\\n\t(__reg)->offset\t\t=\t\t\t\t\t\\\n\t\toffsetof(struct nft_flow_key, __base.__field);\t\t\\\n\t(__reg)->len\t\t= __len;\t\t\t\t\\\n\t(__reg)->key\t\t= __key;\t\t\t\t\\\n\t(__reg)->flags\t\t= __flags;\n\n#define NFT_OFFLOAD_MATCH(__key, __base, __field, __len, __reg)\t\t\\\n\tNFT_OFFLOAD_MATCH_FLAGS(__key, __base, __field, __len, __reg, 0)\n\n#define NFT_OFFLOAD_MATCH_EXACT(__key, __base, __field, __len, __reg)\t\\\n\tNFT_OFFLOAD_MATCH(__key, __base, __field, __len, __reg)\t\t\\\n\tmemset(&(__reg)->mask, 0xff, (__reg)->len);\n\nbool nft_chain_offload_support(const struct nft_base_chain *basechain);\n\nint nft_offload_init(void);\nvoid nft_offload_exit(void);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}