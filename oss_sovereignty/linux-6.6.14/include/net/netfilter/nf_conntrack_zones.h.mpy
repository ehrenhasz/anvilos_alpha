{
  "module_name": "nf_conntrack_zones.h",
  "hash_id": "14c0c55ca995aa7d88ffbdf9d4a5f9bc865d45a6b3f17272f489274d351293f2",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_zones.h",
  "human_readable_source": " \n#ifndef _NF_CONNTRACK_ZONES_H\n#define _NF_CONNTRACK_ZONES_H\n\n#include <linux/netfilter/nf_conntrack_zones_common.h>\n#include <net/netfilter/nf_conntrack.h>\n\nstatic inline const struct nf_conntrack_zone *\nnf_ct_zone(const struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\treturn &ct->zone;\n#else\n\treturn &nf_ct_zone_dflt;\n#endif\n}\n\nstatic inline const struct nf_conntrack_zone *\nnf_ct_zone_init(struct nf_conntrack_zone *zone, u16 id, u8 dir, u8 flags)\n{\n\tzone->id = id;\n\tzone->flags = flags;\n\tzone->dir = dir;\n\n\treturn zone;\n}\n\nstatic inline const struct nf_conntrack_zone *\nnf_ct_zone_tmpl(const struct nf_conn *tmpl, const struct sk_buff *skb,\n\t\tstruct nf_conntrack_zone *tmp)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\tif (!tmpl)\n\t\treturn &nf_ct_zone_dflt;\n\n\tif (tmpl->zone.flags & NF_CT_FLAG_MARK)\n\t\treturn nf_ct_zone_init(tmp, skb->mark, tmpl->zone.dir, 0);\n#endif\n\treturn nf_ct_zone(tmpl);\n}\n\nstatic inline void nf_ct_zone_add(struct nf_conn *ct,\n\t\t\t\t  const struct nf_conntrack_zone *zone)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\tct->zone = *zone;\n#endif\n}\n\nstatic inline bool nf_ct_zone_matches_dir(const struct nf_conntrack_zone *zone,\n\t\t\t\t\t  enum ip_conntrack_dir dir)\n{\n\treturn zone->dir & (1 << dir);\n}\n\nstatic inline u16 nf_ct_zone_id(const struct nf_conntrack_zone *zone,\n\t\t\t\tenum ip_conntrack_dir dir)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\treturn nf_ct_zone_matches_dir(zone, dir) ?\n\t       zone->id : NF_CT_DEFAULT_ZONE_ID;\n#else\n\treturn NF_CT_DEFAULT_ZONE_ID;\n#endif\n}\n\nstatic inline bool nf_ct_zone_equal(const struct nf_conn *a,\n\t\t\t\t    const struct nf_conntrack_zone *b,\n\t\t\t\t    enum ip_conntrack_dir dir)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\treturn nf_ct_zone_id(nf_ct_zone(a), dir) ==\n\t       nf_ct_zone_id(b, dir);\n#else\n\treturn true;\n#endif\n}\n\nstatic inline bool nf_ct_zone_equal_any(const struct nf_conn *a,\n\t\t\t\t\tconst struct nf_conntrack_zone *b)\n{\n#ifdef CONFIG_NF_CONNTRACK_ZONES\n\treturn nf_ct_zone(a)->id == b->id;\n#else\n\treturn true;\n#endif\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}