{
  "module_name": "nf_tproxy.h",
  "hash_id": "8e72800a2a00b02bd9d7fa2e34367c27e3ddc6b7e163883cb33381bb6fcac6c4",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_tproxy.h",
  "human_readable_source": "#ifndef _NF_TPROXY_H_\n#define _NF_TPROXY_H_\n\n#include <net/tcp.h>\n\nenum nf_tproxy_lookup_t {\n\t NF_TPROXY_LOOKUP_LISTENER,\n\t NF_TPROXY_LOOKUP_ESTABLISHED,\n};\n\nstatic inline bool nf_tproxy_sk_is_transparent(struct sock *sk)\n{\n\tif (inet_sk_transparent(sk))\n\t\treturn true;\n\n\tsock_gen_put(sk);\n\treturn false;\n}\n\nstatic inline void nf_tproxy_twsk_deschedule_put(struct inet_timewait_sock *tw)\n{\n\tlocal_bh_disable();\n\tinet_twsk_deschedule_put(tw);\n\tlocal_bh_enable();\n}\n\n \nstatic inline void nf_tproxy_assign_sock(struct sk_buff *skb, struct sock *sk)\n{\n\tskb_orphan(skb);\n\tskb->sk = sk;\n\tskb->destructor = sock_edemux;\n}\n\n__be32 nf_tproxy_laddr4(struct sk_buff *skb, __be32 user_laddr, __be32 daddr);\n\n \nstruct sock *\nnf_tproxy_handle_time_wait4(struct net *net, struct sk_buff *skb,\n\t\t\t    __be32 laddr, __be16 lport, struct sock *sk);\n\n \nstruct sock *\nnf_tproxy_get_sock_v4(struct net *net, struct sk_buff *skb,\n\t\t      const u8 protocol,\n\t\t      const __be32 saddr, const __be32 daddr,\n\t\t      const __be16 sport, const __be16 dport,\n\t\t      const struct net_device *in,\n\t\t      const enum nf_tproxy_lookup_t lookup_type);\n\nconst struct in6_addr *\nnf_tproxy_laddr6(struct sk_buff *skb, const struct in6_addr *user_laddr,\n\t\t const struct in6_addr *daddr);\n\n \nstruct sock *\nnf_tproxy_handle_time_wait6(struct sk_buff *skb, int tproto, int thoff,\n\t\t\t    struct net *net,\n\t\t\t    const struct in6_addr *laddr,\n\t\t\t    const __be16 lport,\n\t\t\t    struct sock *sk);\n\nstruct sock *\nnf_tproxy_get_sock_v6(struct net *net, struct sk_buff *skb, int thoff,\n\t\t      const u8 protocol,\n\t\t      const struct in6_addr *saddr, const struct in6_addr *daddr,\n\t\t      const __be16 sport, const __be16 dport,\n\t\t      const struct net_device *in,\n\t\t      const enum nf_tproxy_lookup_t lookup_type);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}