{
  "module_name": "nf_conntrack_timeout.h",
  "hash_id": "418627d0f6a61de5192dc477f7ee568b964d5245396b956a1ff8c5a09bedf791",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_timeout.h",
  "human_readable_source": " \n#ifndef _NF_CONNTRACK_TIMEOUT_H\n#define _NF_CONNTRACK_TIMEOUT_H\n\n#include <net/net_namespace.h>\n#include <linux/netfilter/nf_conntrack_common.h>\n#include <linux/netfilter/nf_conntrack_tuple_common.h>\n#include <linux/refcount.h>\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_extend.h>\n\n#define CTNL_TIMEOUT_NAME_MAX\t32\n\nstruct nf_ct_timeout {\n\t__u16\t\t\tl3num;\n\tconst struct nf_conntrack_l4proto *l4proto;\n\tchar\t\t\tdata[];\n};\n\nstruct nf_conn_timeout {\n\tstruct nf_ct_timeout __rcu *timeout;\n};\n\nstatic inline unsigned int *\nnf_ct_timeout_data(const struct nf_conn_timeout *t)\n{\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\tstruct nf_ct_timeout *timeout;\n\n\ttimeout = rcu_dereference(t->timeout);\n\tif (timeout == NULL)\n\t\treturn NULL;\n\n\treturn (unsigned int *)timeout->data;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline\nstruct nf_conn_timeout *nf_ct_timeout_find(const struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\treturn nf_ct_ext_find(ct, NF_CT_EXT_TIMEOUT);\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline\nstruct nf_conn_timeout *nf_ct_timeout_ext_add(struct nf_conn *ct,\n\t\t\t\t\t      struct nf_ct_timeout *timeout,\n\t\t\t\t\t      gfp_t gfp)\n{\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\tstruct nf_conn_timeout *timeout_ext;\n\n\ttimeout_ext = nf_ct_ext_add(ct, NF_CT_EXT_TIMEOUT, gfp);\n\tif (timeout_ext == NULL)\n\t\treturn NULL;\n\n\trcu_assign_pointer(timeout_ext->timeout, timeout);\n\n\treturn timeout_ext;\n#else\n\treturn NULL;\n#endif\n};\n\nstatic inline unsigned int *nf_ct_timeout_lookup(const struct nf_conn *ct)\n{\n\tunsigned int *timeouts = NULL;\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\tstruct nf_conn_timeout *timeout_ext;\n\n\ttimeout_ext = nf_ct_timeout_find(ct);\n\tif (timeout_ext)\n\t\ttimeouts = nf_ct_timeout_data(timeout_ext);\n#endif\n\treturn timeouts;\n}\n\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\nvoid nf_ct_untimeout(struct net *net, struct nf_ct_timeout *timeout);\nint nf_ct_set_timeout(struct net *net, struct nf_conn *ct, u8 l3num, u8 l4num,\n\t\t      const char *timeout_name);\nvoid nf_ct_destroy_timeout(struct nf_conn *ct);\n#else\nstatic inline int nf_ct_set_timeout(struct net *net, struct nf_conn *ct,\n\t\t\t\t    u8 l3num, u8 l4num,\n\t\t\t\t    const char *timeout_name)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void nf_ct_destroy_timeout(struct nf_conn *ct)\n{\n\treturn;\n}\n#endif  \n\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\nstruct nf_ct_timeout_hooks {\n\tstruct nf_ct_timeout *(*timeout_find_get)(struct net *net, const char *name);\n\tvoid (*timeout_put)(struct nf_ct_timeout *timeout);\n};\n\nextern const struct nf_ct_timeout_hooks __rcu *nf_ct_timeout_hook;\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}