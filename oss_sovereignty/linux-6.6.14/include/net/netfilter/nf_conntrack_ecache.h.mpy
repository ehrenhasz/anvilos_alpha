{
  "module_name": "nf_conntrack_ecache.h",
  "hash_id": "61c509d1743aa10092ac5520cb6acfbc9db90aee7a357097cc5b14d9333e1e3a",
  "original_prompt": "Ingested from linux-6.6.14/include/net/netfilter/nf_conntrack_ecache.h",
  "human_readable_source": " \n \n\n#ifndef _NF_CONNTRACK_ECACHE_H\n#define _NF_CONNTRACK_ECACHE_H\n#include <net/netfilter/nf_conntrack.h>\n\n#include <net/net_namespace.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n#include <linux/netfilter/nf_conntrack_common.h>\n#include <linux/netfilter/nf_conntrack_tuple_common.h>\n#include <net/netfilter/nf_conntrack_extend.h>\n\nenum nf_ct_ecache_state {\n\tNFCT_ECACHE_DESTROY_FAIL,\t \n\tNFCT_ECACHE_DESTROY_SENT,\t \n};\n\nstruct nf_conntrack_ecache {\n\tunsigned long cache;\t\t \n\tu16 ctmask;\t\t\t \n\tu16 expmask;\t\t\t \n\tu32 missed;\t\t\t \n\tu32 portid;\t\t\t \n};\n\nstatic inline struct nf_conntrack_ecache *\nnf_ct_ecache_find(const struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\treturn nf_ct_ext_find(ct, NF_CT_EXT_ECACHE);\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline bool nf_ct_ecache_exist(const struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\treturn nf_ct_ext_exist(ct, NF_CT_EXT_ECACHE);\n#else\n\treturn false;\n#endif\n}\n\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\n \nstruct nf_ct_event {\n\tstruct nf_conn *ct;\n\tu32 portid;\n\tint report;\n};\n\nstruct nf_exp_event {\n\tstruct nf_conntrack_expect *exp;\n\tu32 portid;\n\tint report;\n};\n\nstruct nf_ct_event_notifier {\n\tint (*ct_event)(unsigned int events, const struct nf_ct_event *item);\n\tint (*exp_event)(unsigned int events, const struct nf_exp_event *item);\n};\n\nvoid nf_conntrack_register_notifier(struct net *net,\n\t\t\t\t   const struct nf_ct_event_notifier *nb);\nvoid nf_conntrack_unregister_notifier(struct net *net);\n\nvoid nf_ct_deliver_cached_events(struct nf_conn *ct);\nint nf_conntrack_eventmask_report(unsigned int eventmask, struct nf_conn *ct,\n\t\t\t\t  u32 portid, int report);\n\nbool nf_ct_ecache_ext_add(struct nf_conn *ct, u16 ctmask, u16 expmask, gfp_t gfp);\n#else\n\nstatic inline void nf_ct_deliver_cached_events(const struct nf_conn *ct)\n{\n}\n\nstatic inline int nf_conntrack_eventmask_report(unsigned int eventmask,\n\t\t\t\t\t\tstruct nf_conn *ct,\n\t\t\t\t\t\tu32 portid,\n\t\t\t\t\t\tint report)\n{\n\treturn 0;\n}\n\nstatic inline bool nf_ct_ecache_ext_add(struct nf_conn *ct, u16 ctmask, u16 expmask, gfp_t gfp)\n{\n\treturn false;\n}\n#endif\n\nstatic inline void\nnf_conntrack_event_cache(enum ip_conntrack_events event, struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\tstruct net *net = nf_ct_net(ct);\n\tstruct nf_conntrack_ecache *e;\n\n\tif (!rcu_access_pointer(net->ct.nf_conntrack_event_cb))\n\t\treturn;\n\n\te = nf_ct_ecache_find(ct);\n\tif (e == NULL)\n\t\treturn;\n\n\tset_bit(event, &e->cache);\n#endif\n}\n\nstatic inline int\nnf_conntrack_event_report(enum ip_conntrack_events event, struct nf_conn *ct,\n\t\t\t  u32 portid, int report)\n{\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\tif (nf_ct_ecache_exist(ct))\n\t\treturn nf_conntrack_eventmask_report(1 << event, ct, portid, report);\n#endif\n\treturn 0;\n}\n\nstatic inline int\nnf_conntrack_event(enum ip_conntrack_events event, struct nf_conn *ct)\n{\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\n\tif (nf_ct_ecache_exist(ct))\n\t\treturn nf_conntrack_eventmask_report(1 << event, ct, 0, 0);\n#endif\n\treturn 0;\n}\n\n#ifdef CONFIG_NF_CONNTRACK_EVENTS\nvoid nf_ct_expect_event_report(enum ip_conntrack_expect_events event,\n\t\t\t       struct nf_conntrack_expect *exp,\n\t\t\t       u32 portid, int report);\n\nvoid nf_conntrack_ecache_work(struct net *net, enum nf_ct_ecache_state state);\n\nvoid nf_conntrack_ecache_pernet_init(struct net *net);\nvoid nf_conntrack_ecache_pernet_fini(struct net *net);\n\nstruct nf_conntrack_net_ecache *nf_conn_pernet_ecache(const struct net *net);\n\nstatic inline bool nf_conntrack_ecache_dwork_pending(const struct net *net)\n{\n\treturn net->ct.ecache_dwork_pending;\n}\n#else  \n\nstatic inline void nf_ct_expect_event_report(enum ip_conntrack_expect_events e,\n\t\t\t\t\t     struct nf_conntrack_expect *exp,\n\t\t\t\t\t     u32 portid,\n\t\t\t\t\t     int report)\n{\n}\n\nstatic inline void nf_conntrack_ecache_work(struct net *net,\n\t\t\t\t\t    enum nf_ct_ecache_state s)\n{\n}\n\nstatic inline void nf_conntrack_ecache_pernet_init(struct net *net)\n{\n}\n\nstatic inline void nf_conntrack_ecache_pernet_fini(struct net *net)\n{\n}\nstatic inline bool nf_conntrack_ecache_dwork_pending(const struct net *net) { return false; }\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}