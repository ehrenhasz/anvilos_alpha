{
  "module_name": "bond_3ad.h",
  "hash_id": "e757efe77a0dba0d1c9d30145721a9ae2ec423e25d831d50fedace1ed5d9fec3",
  "original_prompt": "Ingested from linux-6.6.14/include/net/bond_3ad.h",
  "human_readable_source": " \n \n\n#ifndef _NET_BOND_3AD_H\n#define _NET_BOND_3AD_H\n\n#include <asm/byteorder.h>\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <linux/if_ether.h>\n\n \n#define PKT_TYPE_LACPDU         cpu_to_be16(ETH_P_SLOW)\n#define AD_TIMER_INTERVAL       100  \n\n#define AD_LACP_SLOW 0\n#define AD_LACP_FAST 1\n\ntypedef struct mac_addr {\n\tu8 mac_addr_value[ETH_ALEN];\n} __packed mac_addr_t;\n\nenum {\n\tBOND_AD_STABLE = 0,\n\tBOND_AD_BANDWIDTH = 1,\n\tBOND_AD_COUNT = 2,\n};\n\n \ntypedef enum {\n\tAD_RX_DUMMY,\n\tAD_RX_INITIALIZE,\t \n\tAD_RX_PORT_DISABLED,\t \n\tAD_RX_LACP_DISABLED,\t \n\tAD_RX_EXPIRED,\t\t \n\tAD_RX_DEFAULTED,\t \n\tAD_RX_CURRENT\t\t \n} rx_states_t;\n\n \ntypedef enum {\n\tAD_PERIODIC_DUMMY,\n\tAD_NO_PERIODIC,\t\t \n\tAD_FAST_PERIODIC,\t \n\tAD_SLOW_PERIODIC,\t \n\tAD_PERIODIC_TX\t\t \n} periodic_states_t;\n\n \ntypedef enum {\n\tAD_MUX_DUMMY,\n\tAD_MUX_DETACHED,\t \n\tAD_MUX_WAITING,\t\t \n\tAD_MUX_ATTACHED,\t \n\tAD_MUX_COLLECTING_DISTRIBUTING\t \n} mux_states_t;\n\n \ntypedef enum {\n\tAD_TX_DUMMY,\n\tAD_TRANSMIT\t\t \n} tx_states_t;\n\n \ntypedef enum {\n\t AD_CHURN_MONITOR,  \n\t AD_CHURN,          \n\t AD_NO_CHURN        \n} churn_state_t;\n\n \ntypedef enum {\n\tAD_TYPE_LACPDU = 1,\t \n\tAD_TYPE_MARKER\t\t \n} pdu_type_t;\n\n \ntypedef enum {\n\tAD_MARKER_INFORMATION_SUBTYPE = 1,\t \n\tAD_MARKER_RESPONSE_SUBTYPE\t\t \n} bond_marker_subtype_t;\n\n \ntypedef enum {\n\tAD_CURRENT_WHILE_TIMER,\n\tAD_ACTOR_CHURN_TIMER,\n\tAD_PERIODIC_TIMER,\n\tAD_PARTNER_CHURN_TIMER,\n\tAD_WAIT_WHILE_TIMER\n} ad_timers_t;\n\n#pragma pack(1)\n\n \ntypedef struct lacpdu {\n\tu8 subtype;\t\t \n\tu8 version_number;\n\tu8 tlv_type_actor_info;\t \n\tu8 actor_information_length;\t \n\t__be16 actor_system_priority;\n\tstruct mac_addr actor_system;\n\t__be16 actor_key;\n\t__be16 actor_port_priority;\n\t__be16 actor_port;\n\tu8 actor_state;\n\tu8 reserved_3_1[3];\t\t \n\tu8 tlv_type_partner_info;\t \n\tu8 partner_information_length;\t \n\t__be16 partner_system_priority;\n\tstruct mac_addr partner_system;\n\t__be16 partner_key;\n\t__be16 partner_port_priority;\n\t__be16 partner_port;\n\tu8 partner_state;\n\tu8 reserved_3_2[3];\t\t \n\tu8 tlv_type_collector_info;\t \n\tu8 collector_information_length; \n\t__be16 collector_max_delay;\n\tu8 reserved_12[12];\n\tu8 tlv_type_terminator;\t\t \n\tu8 terminator_length;\t\t \n\tu8 reserved_50[50];\t\t \n} __packed lacpdu_t;\n\ntypedef struct lacpdu_header {\n\tstruct ethhdr hdr;\n\tstruct lacpdu lacpdu;\n} __packed lacpdu_header_t;\n\n \ntypedef struct bond_marker {\n\tu8 subtype;\t\t \n\tu8 version_number;\t \n\tu8 tlv_type;\t\t \n\t \n\tu8 marker_length;\t \n\tu16 requester_port;\t \n\tstruct mac_addr requester_system;\t \n\tu32 requester_transaction_id;\t\t \n\tu16 pad;\t\t \n\tu8 tlv_type_terminator;\t \n\tu8 terminator_length;\t \n\tu8 reserved_90[90];\t \n} __packed bond_marker_t;\n\ntypedef struct bond_marker_header {\n\tstruct ethhdr hdr;\n\tstruct bond_marker marker;\n} __packed bond_marker_header_t;\n\n#pragma pack()\n\nstruct slave;\nstruct bonding;\nstruct ad_info;\nstruct port;\n\n#ifdef __ia64__\n#pragma pack(8)\n#endif\n\nstruct bond_3ad_stats {\n\tatomic64_t lacpdu_rx;\n\tatomic64_t lacpdu_tx;\n\tatomic64_t lacpdu_unknown_rx;\n\tatomic64_t lacpdu_illegal_rx;\n\n\tatomic64_t marker_rx;\n\tatomic64_t marker_tx;\n\tatomic64_t marker_resp_rx;\n\tatomic64_t marker_resp_tx;\n\tatomic64_t marker_unknown_rx;\n};\n\n \ntypedef struct aggregator {\n\tstruct mac_addr aggregator_mac_address;\n\tu16 aggregator_identifier;\n\tbool is_individual;\n\tu16 actor_admin_aggregator_key;\n\tu16 actor_oper_aggregator_key;\n\tstruct mac_addr partner_system;\n\tu16 partner_system_priority;\n\tu16 partner_oper_aggregator_key;\n\tu16 receive_state;\t \n\tu16 transmit_state;\t \n\tstruct port *lag_ports;\n\t \n\tstruct slave *slave;\t \n\tu16 is_active;\t\t \n\tu16 num_of_ports;\n} aggregator_t;\n\nstruct port_params {\n\tstruct mac_addr system;\n\tu16 system_priority;\n\tu16 key;\n\tu16 port_number;\n\tu16 port_priority;\n\tu16 port_state;\n};\n\n \ntypedef struct port {\n\tu16 actor_port_number;\n\tu16 actor_port_priority;\n\tstruct mac_addr actor_system;\t \n\tu16 actor_system_priority;\t \n\tu16 actor_port_aggregator_identifier;\n\tbool ntt;\n\tu16 actor_admin_port_key;\n\tu16 actor_oper_port_key;\n\tu8 actor_admin_port_state;\n\tu8 actor_oper_port_state;\n\n\tstruct port_params partner_admin;\n\tstruct port_params partner_oper;\n\n\tbool is_enabled;\n\n\t \n\tu16 sm_vars;\t\t \n\trx_states_t sm_rx_state;\t \n\tu16 sm_rx_timer_counter;\t \n\tperiodic_states_t sm_periodic_state;\t \n\tu16 sm_periodic_timer_counter;\t \n\tmux_states_t sm_mux_state;\t \n\tu16 sm_mux_timer_counter;\t \n\ttx_states_t sm_tx_state;\t \n\tu16 sm_tx_timer_counter;\t \n\tu16 sm_churn_actor_timer_counter;\n\tu16 sm_churn_partner_timer_counter;\n\tu32 churn_actor_count;\n\tu32 churn_partner_count;\n\tchurn_state_t sm_churn_actor_state;\n\tchurn_state_t sm_churn_partner_state;\n\tstruct slave *slave;\t\t \n\tstruct aggregator *aggregator;\t \n\tstruct port *next_port_in_aggregator;\t \n\tu32 transaction_id;\t\t \n\tstruct lacpdu lacpdu;\t\t \n} port_t;\n\n \nstruct ad_system {\n\tu16 sys_priority;\n\tstruct mac_addr sys_mac_addr;\n};\n\n#ifdef __ia64__\n#pragma pack()\n#endif\n\n \n#define BOND_AD_INFO(bond)   ((bond)->ad_info)\n#define SLAVE_AD_INFO(slave) ((slave)->ad_info)\n\nstruct ad_bond_info {\n\tstruct ad_system system;\t \n\tstruct bond_3ad_stats stats;\n\tatomic_t agg_select_timer;\t\t \n\tu16 aggregator_identifier;\n};\n\nstruct ad_slave_info {\n\tstruct aggregator aggregator;\t \n\tstruct port port;\t\t \n\tstruct bond_3ad_stats stats;\n\tu16 id;\n};\n\nstatic inline const char *bond_3ad_churn_desc(churn_state_t state)\n{\n\tstatic const char *const churn_description[] = {\n\t\t\"monitoring\",\n\t\t\"churned\",\n\t\t\"none\",\n\t\t\"unknown\"\n\t};\n\tint max_size = ARRAY_SIZE(churn_description);\n\n\tif (state >= max_size)\n\t\tstate = max_size - 1;\n\n\treturn churn_description[state];\n}\n\n \nvoid bond_3ad_initialize(struct bonding *bond);\nvoid bond_3ad_bind_slave(struct slave *slave);\nvoid bond_3ad_unbind_slave(struct slave *slave);\nvoid bond_3ad_state_machine_handler(struct work_struct *);\nvoid bond_3ad_initiate_agg_selection(struct bonding *bond, int timeout);\nvoid bond_3ad_adapter_speed_duplex_changed(struct slave *slave);\nvoid bond_3ad_handle_link_change(struct slave *slave, char link);\nint  bond_3ad_get_active_agg_info(struct bonding *bond, struct ad_info *ad_info);\nint  __bond_3ad_get_active_agg_info(struct bonding *bond,\n\t\t\t\t    struct ad_info *ad_info);\nint bond_3ad_lacpdu_recv(const struct sk_buff *skb, struct bonding *bond,\n\t\t\t struct slave *slave);\nint bond_3ad_set_carrier(struct bonding *bond);\nvoid bond_3ad_update_lacp_rate(struct bonding *bond);\nvoid bond_3ad_update_ad_actor_settings(struct bonding *bond);\nint bond_3ad_stats_fill(struct sk_buff *skb, struct bond_3ad_stats *stats);\nsize_t bond_3ad_stats_size(void);\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}