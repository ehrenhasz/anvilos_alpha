{
  "module_name": "if_inet6.h",
  "hash_id": "af1e9813f598ef1e369c277e4cf7dc3264d3ef75ab6e1781edd7cb3581b7c55c",
  "original_prompt": "Ingested from linux-6.6.14/include/net/if_inet6.h",
  "human_readable_source": " \n \n\n#ifndef _NET_IF_INET6_H\n#define _NET_IF_INET6_H\n\n#include <net/snmp.h>\n#include <linux/ipv6.h>\n#include <linux/refcount.h>\n\n \n\n#define IF_RA_OTHERCONF\t0x80\n#define IF_RA_MANAGED\t0x40\n#define IF_RA_RCVD\t0x20\n#define IF_RS_SENT\t0x10\n#define IF_READY\t0x80000000\n\nenum {\n\tINET6_IFADDR_STATE_PREDAD,\n\tINET6_IFADDR_STATE_DAD,\n\tINET6_IFADDR_STATE_POSTDAD,\n\tINET6_IFADDR_STATE_ERRDAD,\n\tINET6_IFADDR_STATE_DEAD,\n};\n\nstruct inet6_ifaddr {\n\tstruct in6_addr\t\taddr;\n\t__u32\t\t\tprefix_len;\n\t__u32\t\t\trt_priority;\n\n\t \n\t__u32\t\t\tvalid_lft;\n\t__u32\t\t\tprefered_lft;\n\trefcount_t\t\trefcnt;\n\tspinlock_t\t\tlock;\n\n\tint\t\t\tstate;\n\n\t__u32\t\t\tflags;\n\t__u8\t\t\tdad_probes;\n\t__u8\t\t\tstable_privacy_retry;\n\n\t__u16\t\t\tscope;\n\t__u64\t\t\tdad_nonce;\n\n\tunsigned long\t\tcstamp;\t \n\tunsigned long\t\ttstamp;  \n\n\tstruct delayed_work\tdad_work;\n\n\tstruct inet6_dev\t*idev;\n\tstruct fib6_info\t*rt;\n\n\tstruct hlist_node\taddr_lst;\n\tstruct list_head\tif_list;\n\t \n\tstruct list_head\tif_list_aux;\n\n\tstruct list_head\ttmp_list;\n\tstruct inet6_ifaddr\t*ifpub;\n\tint\t\t\tregen_count;\n\n\tbool\t\t\ttokenized;\n\n\tu8\t\t\tifa_proto;\n\n\tstruct rcu_head\t\trcu;\n\tstruct in6_addr\t\tpeer_addr;\n};\n\nstruct ip6_sf_socklist {\n\tunsigned int\t\tsl_max;\n\tunsigned int\t\tsl_count;\n\tstruct rcu_head\t\trcu;\n\tstruct in6_addr\t\tsl_addr[];\n};\n\n#define IP6_SFBLOCK\t10\t \n\nstruct ipv6_mc_socklist {\n\tstruct in6_addr\t\taddr;\n\tint\t\t\tifindex;\n\tunsigned int\t\tsfmode;\t\t \n\tstruct ipv6_mc_socklist __rcu *next;\n\tstruct ip6_sf_socklist\t__rcu *sflist;\n\tstruct rcu_head\t\trcu;\n};\n\nstruct ip6_sf_list {\n\tstruct ip6_sf_list __rcu *sf_next;\n\tstruct in6_addr\t\tsf_addr;\n\tunsigned long\t\tsf_count[2];\t \n\tunsigned char\t\tsf_gsresp;\t \n\tunsigned char\t\tsf_oldin;\t \n\tunsigned char\t\tsf_crcount;\t \n\tstruct rcu_head\t\trcu;\n};\n\n#define MAF_TIMER_RUNNING\t0x01\n#define MAF_LAST_REPORTER\t0x02\n#define MAF_LOADED\t\t0x04\n#define MAF_NOREPORT\t\t0x08\n#define MAF_GSQUERY\t\t0x10\n\nstruct ifmcaddr6 {\n\tstruct in6_addr\t\tmca_addr;\n\tstruct inet6_dev\t*idev;\n\tstruct ifmcaddr6\t__rcu *next;\n\tstruct ip6_sf_list\t__rcu *mca_sources;\n\tstruct ip6_sf_list\t__rcu *mca_tomb;\n\tunsigned int\t\tmca_sfmode;\n\tunsigned char\t\tmca_crcount;\n\tunsigned long\t\tmca_sfcount[2];\n\tstruct delayed_work\tmca_work;\n\tunsigned int\t\tmca_flags;\n\tint\t\t\tmca_users;\n\trefcount_t\t\tmca_refcnt;\n\tunsigned long\t\tmca_cstamp;\n\tunsigned long\t\tmca_tstamp;\n\tstruct rcu_head\t\trcu;\n};\n\n \n\nstruct ipv6_ac_socklist {\n\tstruct in6_addr\t\tacl_addr;\n\tint\t\t\tacl_ifindex;\n\tstruct ipv6_ac_socklist *acl_next;\n};\n\nstruct ifacaddr6 {\n\tstruct in6_addr\t\taca_addr;\n\tstruct fib6_info\t*aca_rt;\n\tstruct ifacaddr6\t*aca_next;\n\tstruct hlist_node\taca_addr_lst;\n\tint\t\t\taca_users;\n\trefcount_t\t\taca_refcnt;\n\tunsigned long\t\taca_cstamp;\n\tunsigned long\t\taca_tstamp;\n\tstruct rcu_head\t\trcu;\n};\n\n#define\tIFA_HOST\tIPV6_ADDR_LOOPBACK\n#define\tIFA_LINK\tIPV6_ADDR_LINKLOCAL\n#define\tIFA_SITE\tIPV6_ADDR_SITELOCAL\n\nstruct ipv6_devstat {\n\tstruct proc_dir_entry\t*proc_dir_entry;\n\tDEFINE_SNMP_STAT(struct ipstats_mib, ipv6);\n\tDEFINE_SNMP_STAT_ATOMIC(struct icmpv6_mib_device, icmpv6dev);\n\tDEFINE_SNMP_STAT_ATOMIC(struct icmpv6msg_mib_device, icmpv6msgdev);\n};\n\nstruct inet6_dev {\n\tstruct net_device\t*dev;\n\tnetdevice_tracker\tdev_tracker;\n\n\tstruct list_head\taddr_list;\n\n\tstruct ifmcaddr6\t__rcu *mc_list;\n\tstruct ifmcaddr6\t__rcu *mc_tomb;\n\n\tunsigned char\t\tmc_qrv;\t\t \n\tunsigned char\t\tmc_gq_running;\n\tunsigned char\t\tmc_ifc_count;\n\tunsigned char\t\tmc_dad_count;\n\n\tunsigned long\t\tmc_v1_seen;\t \n\tunsigned long\t\tmc_qi;\t\t \n\tunsigned long\t\tmc_qri;\t\t \n\tunsigned long\t\tmc_maxdelay;\n\n\tstruct delayed_work\tmc_gq_work;\t \n\tstruct delayed_work\tmc_ifc_work;\t \n\tstruct delayed_work\tmc_dad_work;\t \n\tstruct delayed_work\tmc_query_work;\t \n\tstruct delayed_work\tmc_report_work;\t \n\n\tstruct sk_buff_head\tmc_query_queue;\t\t \n\tstruct sk_buff_head\tmc_report_queue;\t \n\n\tspinlock_t\t\tmc_query_lock;\t \n\tspinlock_t\t\tmc_report_lock;\t \n\tstruct mutex\t\tmc_lock;\t \n\n\tstruct ifacaddr6\t*ac_list;\n\trwlock_t\t\tlock;\n\trefcount_t\t\trefcnt;\n\t__u32\t\t\tif_flags;\n\tint\t\t\tdead;\n\n\tu32\t\t\tdesync_factor;\n\tstruct list_head\ttempaddr_list;\n\n\tstruct in6_addr\t\ttoken;\n\n\tstruct neigh_parms\t*nd_parms;\n\tstruct ipv6_devconf\tcnf;\n\tstruct ipv6_devstat\tstats;\n\n\tstruct timer_list\trs_timer;\n\t__s32\t\t\trs_interval;\t \n\t__u8\t\t\trs_probes;\n\n\tunsigned long\t\ttstamp;  \n\tstruct rcu_head\t\trcu;\n\n\tunsigned int\t\tra_mtu;\n};\n\nstatic inline void ipv6_eth_mc_map(const struct in6_addr *addr, char *buf)\n{\n\t \n\n\tbuf[0]= 0x33;\n\tbuf[1]= 0x33;\n\n\tmemcpy(buf + 2, &addr->s6_addr32[3], sizeof(__u32));\n}\n\nstatic inline void ipv6_arcnet_mc_map(const struct in6_addr *addr, char *buf)\n{\n\tbuf[0] = 0x00;\n}\n\nstatic inline void ipv6_ib_mc_map(const struct in6_addr *addr,\n\t\t\t\t  const unsigned char *broadcast, char *buf)\n{\n\tunsigned char scope = broadcast[5] & 0xF;\n\n\tbuf[0]  = 0;\t\t \n\tbuf[1]  = 0xff;\t\t \n\tbuf[2]  = 0xff;\n\tbuf[3]  = 0xff;\n\tbuf[4]  = 0xff;\n\tbuf[5]  = 0x10 | scope;\t \n\tbuf[6]  = 0x60;\t\t \n\tbuf[7]  = 0x1b;\n\tbuf[8]  = broadcast[8];\t \n\tbuf[9]  = broadcast[9];\n\tmemcpy(buf + 10, addr->s6_addr + 6, 10);\n}\n\nstatic inline int ipv6_ipgre_mc_map(const struct in6_addr *addr,\n\t\t\t\t    const unsigned char *broadcast, char *buf)\n{\n\tif ((broadcast[0] | broadcast[1] | broadcast[2] | broadcast[3]) != 0) {\n\t\tmemcpy(buf, broadcast, 4);\n\t} else {\n\t\t \n\t\tif ((addr->s6_addr32[0] | addr->s6_addr32[1] |\n\t\t     (addr->s6_addr32[2] ^ htonl(0x0000ffff))) != 0)\n\t\t\treturn -EINVAL;\n\t\tmemcpy(buf, &addr->s6_addr32[3], 4);\n\t}\n\treturn 0;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}