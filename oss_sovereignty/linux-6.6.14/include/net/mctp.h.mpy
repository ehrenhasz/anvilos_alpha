{
  "module_name": "mctp.h",
  "hash_id": "bf6f96e4ad45cd50ab69c65f9379ba04826d036f7718fbfe98338c23809ec9e2",
  "original_prompt": "Ingested from linux-6.6.14/include/net/mctp.h",
  "human_readable_source": " \n \n\n#ifndef __NET_MCTP_H\n#define __NET_MCTP_H\n\n#include <linux/bits.h>\n#include <linux/mctp.h>\n#include <linux/netdevice.h>\n#include <net/net_namespace.h>\n#include <net/sock.h>\n\n \nstruct mctp_hdr {\n\tu8\tver;\n\tu8\tdest;\n\tu8\tsrc;\n\tu8\tflags_seq_tag;\n};\n\n#define MCTP_VER_MIN\t1\n#define MCTP_VER_MAX\t1\n\n \n#define MCTP_HDR_FLAG_SOM\tBIT(7)\n#define MCTP_HDR_FLAG_EOM\tBIT(6)\n#define MCTP_HDR_FLAG_TO\tBIT(3)\n#define MCTP_HDR_FLAGS\t\tGENMASK(5, 3)\n#define MCTP_HDR_SEQ_SHIFT\t4\n#define MCTP_HDR_SEQ_MASK\tGENMASK(1, 0)\n#define MCTP_HDR_TAG_SHIFT\t0\n#define MCTP_HDR_TAG_MASK\tGENMASK(2, 0)\n\n#define MCTP_INITIAL_DEFAULT_NET\t1\n\nstatic inline bool mctp_address_unicast(mctp_eid_t eid)\n{\n\treturn eid >= 8 && eid < 255;\n}\n\nstatic inline bool mctp_address_broadcast(mctp_eid_t eid)\n{\n\treturn eid == 255;\n}\n\nstatic inline bool mctp_address_null(mctp_eid_t eid)\n{\n\treturn eid == 0;\n}\n\nstatic inline bool mctp_address_matches(mctp_eid_t match, mctp_eid_t eid)\n{\n\treturn match == eid || match == MCTP_ADDR_ANY;\n}\n\nstatic inline struct mctp_hdr *mctp_hdr(struct sk_buff *skb)\n{\n\treturn (struct mctp_hdr *)skb_network_header(skb);\n}\n\n \nstruct mctp_sock {\n\tstruct sock\tsk;\n\n\t \n\tunsigned int\tbind_net;\n\tmctp_eid_t\tbind_addr;\n\t__u8\t\tbind_type;\n\n\t \n\tbool\t\taddr_ext;\n\n\t \n\tstruct hlist_head keys;\n\n\t \n\tstruct timer_list key_expiry;\n};\n\n \nstruct mctp_sk_key {\n\tmctp_eid_t\tpeer_addr;\n\tmctp_eid_t\tlocal_addr;  \n\t__u8\t\ttag;  \n\n\t \n\tstruct sock\t*sk;\n\n\t \n\tstruct hlist_node hlist;\n\n\t \n\tstruct hlist_node sklist;\n\n\t \n\tspinlock_t\tlock;\n\n\t \n\trefcount_t\trefs;\n\n\t \n\tstruct sk_buff\t*reasm_head;\n\tstruct sk_buff\t**reasm_tailp;\n\tbool\t\treasm_dead;\n\tu8\t\tlast_seq;\n\n\t \n\tbool\t\tvalid;\n\n\t \n\tunsigned long\texpiry;\n\n\t \n\tunsigned long\tdev_flow_state;\n\tstruct mctp_dev\t*dev;\n\n\t \n\tbool\t\tmanual_alloc;\n};\n\nstruct mctp_skb_cb {\n\tunsigned int\tmagic;\n\tunsigned int\tnet;\n\tint\t\tifindex;  \n\tmctp_eid_t\tsrc;\n\tunsigned char\thalen;\n\tunsigned char\thaddr[MAX_ADDR_LEN];\n};\n\n \nstatic inline struct mctp_skb_cb *__mctp_cb(struct sk_buff *skb)\n{\n\tstruct mctp_skb_cb *cb = (void *)skb->cb;\n\n\tcb->magic = 0x4d435450;\n\treturn cb;\n}\n\nstatic inline struct mctp_skb_cb *mctp_cb(struct sk_buff *skb)\n{\n\tstruct mctp_skb_cb *cb = (void *)skb->cb;\n\n\tBUILD_BUG_ON(sizeof(struct mctp_skb_cb) > sizeof(skb->cb));\n\tWARN_ON(cb->magic != 0x4d435450);\n\treturn (void *)(skb->cb);\n}\n\n \nstruct mctp_flow {\n\tstruct mctp_sk_key *key;\n};\n\n \nstruct mctp_route {\n\tmctp_eid_t\t\tmin, max;\n\n\tunsigned char\t\ttype;\n\tunsigned int\t\tmtu;\n\tstruct mctp_dev\t\t*dev;\n\tint\t\t\t(*output)(struct mctp_route *route,\n\t\t\t\t\t  struct sk_buff *skb);\n\n\tstruct list_head\tlist;\n\trefcount_t\t\trefs;\n\tstruct rcu_head\t\trcu;\n};\n\n \nstruct mctp_route *mctp_route_lookup(struct net *net, unsigned int dnet,\n\t\t\t\t     mctp_eid_t daddr);\n\nint mctp_local_output(struct sock *sk, struct mctp_route *rt,\n\t\t      struct sk_buff *skb, mctp_eid_t daddr, u8 req_tag);\n\nvoid mctp_key_unref(struct mctp_sk_key *key);\nstruct mctp_sk_key *mctp_alloc_local_tag(struct mctp_sock *msk,\n\t\t\t\t\t mctp_eid_t daddr, mctp_eid_t saddr,\n\t\t\t\t\t bool manual, u8 *tagp);\n\n \nunsigned int mctp_default_net(struct net *net);\nint mctp_default_net_set(struct net *net, unsigned int index);\nint mctp_route_add_local(struct mctp_dev *mdev, mctp_eid_t addr);\nint mctp_route_remove_local(struct mctp_dev *mdev, mctp_eid_t addr);\nvoid mctp_route_remove_dev(struct mctp_dev *mdev);\n\n \nenum mctp_neigh_source {\n\tMCTP_NEIGH_STATIC,\n\tMCTP_NEIGH_DISCOVER,\n};\n\nstruct mctp_neigh {\n\tstruct mctp_dev\t\t*dev;\n\tmctp_eid_t\t\teid;\n\tenum mctp_neigh_source\tsource;\n\n\tunsigned char\t\tha[MAX_ADDR_LEN];\n\n\tstruct list_head\tlist;\n\tstruct rcu_head\t\trcu;\n};\n\nint mctp_neigh_init(void);\nvoid mctp_neigh_exit(void);\n\n\nint mctp_neigh_lookup(struct mctp_dev *dev, mctp_eid_t eid,\n\t\t      void *ret_hwaddr);\nvoid mctp_neigh_remove_dev(struct mctp_dev *mdev);\n\nint mctp_routes_init(void);\nvoid mctp_routes_exit(void);\n\nvoid mctp_device_init(void);\nvoid mctp_device_exit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}