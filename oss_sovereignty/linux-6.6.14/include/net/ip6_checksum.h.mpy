{
  "module_name": "ip6_checksum.h",
  "hash_id": "c5bdf26a563448d7e586d34e69e823856c1cbd73e06a4d6b6522bbb50026fe4b",
  "original_prompt": "Ingested from linux-6.6.14/include/net/ip6_checksum.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _CHECKSUM_IPV6_H\n#define _CHECKSUM_IPV6_H\n\n#include <asm/types.h>\n#include <asm/byteorder.h>\n#include <net/ip.h>\n#include <asm/checksum.h>\n#include <linux/in6.h>\n#include <linux/tcp.h>\n#include <linux/ipv6.h>\n\n#ifndef _HAVE_ARCH_IPV6_CSUM\n__sum16 csum_ipv6_magic(const struct in6_addr *saddr,\n\t\t\tconst struct in6_addr *daddr,\n\t\t\t__u32 len, __u8 proto, __wsum csum);\n#endif\n\nstatic inline __wsum ip6_compute_pseudo(struct sk_buff *skb, int proto)\n{\n\treturn ~csum_unfold(csum_ipv6_magic(&ipv6_hdr(skb)->saddr,\n\t\t\t\t\t    &ipv6_hdr(skb)->daddr,\n\t\t\t\t\t    skb->len, proto, 0));\n}\n\nstatic __inline__ __sum16 tcp_v6_check(int len,\n\t\t\t\t   const struct in6_addr *saddr,\n\t\t\t\t   const struct in6_addr *daddr,\n\t\t\t\t   __wsum base)\n{\n\treturn csum_ipv6_magic(saddr, daddr, len, IPPROTO_TCP, base);\n}\n\nstatic inline void __tcp_v6_send_check(struct sk_buff *skb,\n\t\t\t\t       const struct in6_addr *saddr,\n\t\t\t\t       const struct in6_addr *daddr)\n{\n\tstruct tcphdr *th = tcp_hdr(skb);\n\n\tth->check = ~tcp_v6_check(skb->len, saddr, daddr, 0);\n\tskb->csum_start = skb_transport_header(skb) - skb->head;\n\tskb->csum_offset = offsetof(struct tcphdr, check);\n}\n\nstatic inline void tcp_v6_gso_csum_prep(struct sk_buff *skb)\n{\n\tstruct ipv6hdr *ipv6h = ipv6_hdr(skb);\n\tstruct tcphdr *th = tcp_hdr(skb);\n\n\tipv6h->payload_len = 0;\n\tth->check = ~tcp_v6_check(0, &ipv6h->saddr, &ipv6h->daddr, 0);\n}\n\nstatic inline __sum16 udp_v6_check(int len,\n\t\t\t\t   const struct in6_addr *saddr,\n\t\t\t\t   const struct in6_addr *daddr,\n\t\t\t\t   __wsum base)\n{\n\treturn csum_ipv6_magic(saddr, daddr, len, IPPROTO_UDP, base);\n}\n\nvoid udp6_set_csum(bool nocheck, struct sk_buff *skb,\n\t\t   const struct in6_addr *saddr,\n\t\t   const struct in6_addr *daddr, int len);\n\nint udp6_csum_init(struct sk_buff *skb, struct udphdr *uh, int proto);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}