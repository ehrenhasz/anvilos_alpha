{
  "module_name": "auth.h",
  "hash_id": "c7fb401283f3ed5c948ff5071dae9748a747ac535f607a9c0be635bff3f3bffb",
  "original_prompt": "Ingested from linux-6.6.14/include/net/sctp/auth.h",
  "human_readable_source": " \n \n\n#ifndef __sctp_auth_h__\n#define __sctp_auth_h__\n\n#include <linux/list.h>\n#include <linux/refcount.h>\n\nstruct sctp_endpoint;\nstruct sctp_association;\nstruct sctp_authkey;\nstruct sctp_hmacalgo;\nstruct crypto_shash;\n\n \nstruct sctp_hmac {\n\t__u16 hmac_id;\t\t \n\tchar *hmac_name;\t \n\t__u16 hmac_len;\t\t \n};\n\n \nstruct sctp_auth_bytes {\n\trefcount_t refcnt;\n\t__u32 len;\n\t__u8  data[];\n};\n\n \nstruct sctp_shared_key {\n\tstruct list_head key_list;\n\tstruct sctp_auth_bytes *key;\n\trefcount_t refcnt;\n\t__u16 key_id;\n\t__u8 deactivated;\n};\n\n#define key_for_each(__key, __list_head) \\\n\tlist_for_each_entry(__key, __list_head, key_list)\n\n#define key_for_each_safe(__key, __tmp, __list_head) \\\n\tlist_for_each_entry_safe(__key, __tmp, __list_head, key_list)\n\nstatic inline void sctp_auth_key_hold(struct sctp_auth_bytes *key)\n{\n\tif (!key)\n\t\treturn;\n\n\trefcount_inc(&key->refcnt);\n}\n\nvoid sctp_auth_key_put(struct sctp_auth_bytes *key);\nstruct sctp_shared_key *sctp_auth_shkey_create(__u16 key_id, gfp_t gfp);\nvoid sctp_auth_destroy_keys(struct list_head *keys);\nint sctp_auth_asoc_init_active_key(struct sctp_association *asoc, gfp_t gfp);\nstruct sctp_shared_key *sctp_auth_get_shkey(\n\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t__u16 key_id);\nint sctp_auth_asoc_copy_shkeys(const struct sctp_endpoint *ep,\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tgfp_t gfp);\nint sctp_auth_init_hmacs(struct sctp_endpoint *ep, gfp_t gfp);\nvoid sctp_auth_destroy_hmacs(struct crypto_shash *auth_hmacs[]);\nstruct sctp_hmac *sctp_auth_get_hmac(__u16 hmac_id);\nstruct sctp_hmac *sctp_auth_asoc_get_hmac(const struct sctp_association *asoc);\nvoid sctp_auth_asoc_set_default_hmac(struct sctp_association *asoc,\n\t\t\t\t     struct sctp_hmac_algo_param *hmacs);\nint sctp_auth_asoc_verify_hmac_id(const struct sctp_association *asoc,\n\t\t\t\t    __be16 hmac_id);\nint sctp_auth_send_cid(enum sctp_cid chunk,\n\t\t       const struct sctp_association *asoc);\nint sctp_auth_recv_cid(enum sctp_cid chunk,\n\t\t       const struct sctp_association *asoc);\nvoid sctp_auth_calculate_hmac(const struct sctp_association *asoc,\n\t\t\t      struct sk_buff *skb, struct sctp_auth_chunk *auth,\n\t\t\t      struct sctp_shared_key *ep_key, gfp_t gfp);\nvoid sctp_auth_shkey_release(struct sctp_shared_key *sh_key);\nvoid sctp_auth_shkey_hold(struct sctp_shared_key *sh_key);\n\n \nint sctp_auth_ep_add_chunkid(struct sctp_endpoint *ep, __u8 chunk_id);\nint sctp_auth_ep_set_hmacs(struct sctp_endpoint *ep,\n\t\t\t    struct sctp_hmacalgo *hmacs);\nint sctp_auth_set_key(struct sctp_endpoint *ep, struct sctp_association *asoc,\n\t\t      struct sctp_authkey *auth_key);\nint sctp_auth_set_active_key(struct sctp_endpoint *ep,\n\t\t\t     struct sctp_association *asoc, __u16 key_id);\nint sctp_auth_del_key_id(struct sctp_endpoint *ep,\n\t\t\t struct sctp_association *asoc, __u16 key_id);\nint sctp_auth_deact_key_id(struct sctp_endpoint *ep,\n\t\t\t   struct sctp_association *asoc, __u16 key_id);\nint sctp_auth_init(struct sctp_endpoint *ep, gfp_t gfp);\nvoid sctp_auth_free(struct sctp_endpoint *ep);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}