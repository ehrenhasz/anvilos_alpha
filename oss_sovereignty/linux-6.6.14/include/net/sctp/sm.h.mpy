{
  "module_name": "sm.h",
  "hash_id": "eab2d8f4b8765d6d70606a99294612f153dddd37457f611671b410321b9efa4d",
  "original_prompt": "Ingested from linux-6.6.14/include/net/sctp/sm.h",
  "human_readable_source": " \n \n\n#include <linux/types.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/in.h>\n#include <net/sctp/command.h>\n#include <net/sctp/sctp.h>\n\n#ifndef __sctp_sm_h__\n#define __sctp_sm_h__\n\n \nenum sctp_disposition {\n\tSCTP_DISPOSITION_DISCARD,\t  \n\tSCTP_DISPOSITION_CONSUME,\t  \n\tSCTP_DISPOSITION_NOMEM,\t\t  \n\tSCTP_DISPOSITION_DELETE_TCB,\t  \n\tSCTP_DISPOSITION_ABORT,\t\t  \n\tSCTP_DISPOSITION_VIOLATION,\t  \n\tSCTP_DISPOSITION_NOT_IMPL,\t  \n\tSCTP_DISPOSITION_ERROR,\t\t  \n\tSCTP_DISPOSITION_BUG,\t\t  \n};\n\ntypedef enum sctp_disposition (sctp_state_fn_t) (\n\t\t\t\t\tstruct net *net,\n\t\t\t\t\tconst struct sctp_endpoint *ep,\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst union sctp_subtype type,\n\t\t\t\t\tvoid *arg,\n\t\t\t\t\tstruct sctp_cmd_seq *commands);\ntypedef void (sctp_timer_event_t) (struct timer_list *);\nstruct sctp_sm_table_entry {\n\tsctp_state_fn_t *fn;\n\tconst char *name;\n};\n\n \n\n \nsctp_state_fn_t sctp_sf_not_impl;\nsctp_state_fn_t sctp_sf_bug;\n\n \nsctp_state_fn_t sctp_sf_timer_ignore;\n\n \nsctp_state_fn_t sctp_sf_do_9_1_abort;\nsctp_state_fn_t sctp_sf_cookie_wait_abort;\nsctp_state_fn_t sctp_sf_cookie_echoed_abort;\nsctp_state_fn_t sctp_sf_shutdown_pending_abort;\nsctp_state_fn_t sctp_sf_shutdown_sent_abort;\nsctp_state_fn_t sctp_sf_shutdown_ack_sent_abort;\nsctp_state_fn_t sctp_sf_do_5_1B_init;\nsctp_state_fn_t sctp_sf_do_5_1C_ack;\nsctp_state_fn_t sctp_sf_do_5_1D_ce;\nsctp_state_fn_t sctp_sf_do_5_1E_ca;\nsctp_state_fn_t sctp_sf_do_4_C;\nsctp_state_fn_t sctp_sf_eat_data_6_2;\nsctp_state_fn_t sctp_sf_eat_data_fast_4_4;\nsctp_state_fn_t sctp_sf_eat_sack_6_2;\nsctp_state_fn_t sctp_sf_operr_notify;\nsctp_state_fn_t sctp_sf_t1_init_timer_expire;\nsctp_state_fn_t sctp_sf_t1_cookie_timer_expire;\nsctp_state_fn_t sctp_sf_t2_timer_expire;\nsctp_state_fn_t sctp_sf_t4_timer_expire;\nsctp_state_fn_t sctp_sf_t5_timer_expire;\nsctp_state_fn_t sctp_sf_sendbeat_8_3;\nsctp_state_fn_t sctp_sf_beat_8_3;\nsctp_state_fn_t sctp_sf_backbeat_8_3;\nsctp_state_fn_t sctp_sf_do_9_2_final;\nsctp_state_fn_t sctp_sf_do_9_2_shutdown;\nsctp_state_fn_t sctp_sf_do_9_2_shut_ctsn;\nsctp_state_fn_t sctp_sf_do_ecn_cwr;\nsctp_state_fn_t sctp_sf_do_ecne;\nsctp_state_fn_t sctp_sf_ootb;\nsctp_state_fn_t sctp_sf_pdiscard;\nsctp_state_fn_t sctp_sf_violation;\nsctp_state_fn_t sctp_sf_discard_chunk;\nsctp_state_fn_t sctp_sf_do_5_2_1_siminit;\nsctp_state_fn_t sctp_sf_do_5_2_2_dupinit;\nsctp_state_fn_t sctp_sf_do_5_2_3_initack;\nsctp_state_fn_t sctp_sf_do_5_2_4_dupcook;\nsctp_state_fn_t sctp_sf_unk_chunk;\nsctp_state_fn_t sctp_sf_do_8_5_1_E_sa;\nsctp_state_fn_t sctp_sf_cookie_echoed_err;\nsctp_state_fn_t sctp_sf_do_asconf;\nsctp_state_fn_t sctp_sf_do_asconf_ack;\nsctp_state_fn_t sctp_sf_do_reconf;\nsctp_state_fn_t sctp_sf_do_9_2_reshutack;\nsctp_state_fn_t sctp_sf_eat_fwd_tsn;\nsctp_state_fn_t sctp_sf_eat_fwd_tsn_fast;\nsctp_state_fn_t sctp_sf_eat_auth;\n\n \nsctp_state_fn_t sctp_sf_do_prm_asoc;\nsctp_state_fn_t sctp_sf_do_prm_send;\nsctp_state_fn_t sctp_sf_do_9_2_prm_shutdown;\nsctp_state_fn_t sctp_sf_cookie_wait_prm_shutdown;\nsctp_state_fn_t sctp_sf_cookie_echoed_prm_shutdown;\nsctp_state_fn_t sctp_sf_do_9_1_prm_abort;\nsctp_state_fn_t sctp_sf_cookie_wait_prm_abort;\nsctp_state_fn_t sctp_sf_cookie_echoed_prm_abort;\nsctp_state_fn_t sctp_sf_shutdown_pending_prm_abort;\nsctp_state_fn_t sctp_sf_shutdown_sent_prm_abort;\nsctp_state_fn_t sctp_sf_shutdown_ack_sent_prm_abort;\nsctp_state_fn_t sctp_sf_error_closed;\nsctp_state_fn_t sctp_sf_error_shutdown;\nsctp_state_fn_t sctp_sf_ignore_primitive;\nsctp_state_fn_t sctp_sf_do_prm_requestheartbeat;\nsctp_state_fn_t sctp_sf_do_prm_asconf;\nsctp_state_fn_t sctp_sf_do_prm_reconf;\n\n \nsctp_state_fn_t sctp_sf_do_no_pending_tsn;\nsctp_state_fn_t sctp_sf_do_9_2_start_shutdown;\nsctp_state_fn_t sctp_sf_do_9_2_shutdown_ack;\nsctp_state_fn_t sctp_sf_ignore_other;\nsctp_state_fn_t sctp_sf_cookie_wait_icmp_abort;\n\n \nsctp_state_fn_t sctp_sf_do_6_3_3_rtx;\nsctp_state_fn_t sctp_sf_send_reconf;\nsctp_state_fn_t sctp_sf_send_probe;\nsctp_state_fn_t sctp_sf_do_6_2_sack;\nsctp_state_fn_t sctp_sf_autoclose_timer_expire;\n\n \nconst struct sctp_sm_table_entry *sctp_sm_lookup_event(\n\t\t\t\t\tstruct net *net,\n\t\t\t\t\tenum sctp_event_type event_type,\n\t\t\t\t\tenum sctp_state state,\n\t\t\t\t\tunion sctp_subtype event_subtype);\nint sctp_chunk_iif(const struct sctp_chunk *);\nstruct sctp_association *sctp_make_temp_asoc(const struct sctp_endpoint *,\n\t\t\t\t\t     struct sctp_chunk *,\n\t\t\t\t\t     gfp_t gfp);\n\n \nstruct sctp_chunk *sctp_make_init(const struct sctp_association *asoc,\n\t\t\t\t  const struct sctp_bind_addr *bp,\n\t\t\t\t  gfp_t gfp, int vparam_len);\nstruct sctp_chunk *sctp_make_init_ack(const struct sctp_association *asoc,\n\t\t\t\t      const struct sctp_chunk *chunk,\n\t\t\t\t      const gfp_t gfp, const int unkparam_len);\nstruct sctp_chunk *sctp_make_cookie_echo(const struct sctp_association *asoc,\n\t\t\t\t\t const struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_cookie_ack(const struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_cwr(const struct sctp_association *asoc,\n\t\t\t\t const __u32 lowest_tsn,\n\t\t\t\t const struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_idata(const struct sctp_association *asoc,\n\t\t\t\t   __u8 flags, int paylen, gfp_t gfp);\nstruct sctp_chunk *sctp_make_ifwdtsn(const struct sctp_association *asoc,\n\t\t\t\t     __u32 new_cum_tsn, size_t nstreams,\n\t\t\t\t     struct sctp_ifwdtsn_skip *skiplist);\nstruct sctp_chunk *sctp_make_datafrag_empty(const struct sctp_association *asoc,\n\t\t\t\t\t    const struct sctp_sndrcvinfo *sinfo,\n\t\t\t\t\t    int len, __u8 flags, gfp_t gfp);\nstruct sctp_chunk *sctp_make_ecne(const struct sctp_association *asoc,\n\t\t\t\t  const __u32 lowest_tsn);\nstruct sctp_chunk *sctp_make_sack(struct sctp_association *asoc);\nstruct sctp_chunk *sctp_make_shutdown(const struct sctp_association *asoc,\n\t\t\t\t      const struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_shutdown_ack(const struct sctp_association *asoc,\n\t\t\t\t\t  const struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_shutdown_complete(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk);\nint sctp_init_cause(struct sctp_chunk *chunk, __be16 cause, size_t paylen);\nstruct sctp_chunk *sctp_make_abort(const struct sctp_association *asoc,\n\t\t\t\t   const struct sctp_chunk *chunk,\n\t\t\t\t   const size_t hint);\nstruct sctp_chunk *sctp_make_abort_no_data(const struct sctp_association *asoc,\n\t\t\t\t\t   const struct sctp_chunk *chunk,\n\t\t\t\t\t   __u32 tsn);\nstruct sctp_chunk *sctp_make_abort_user(const struct sctp_association *asoc,\n\t\t\t\t\tstruct msghdr *msg, size_t msg_len);\nstruct sctp_chunk *sctp_make_abort_violation(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk,\n\t\t\t\t\tconst __u8 *payload,\n\t\t\t\t\tconst size_t paylen);\nstruct sctp_chunk *sctp_make_violation_paramlen(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk,\n\t\t\t\t\tstruct sctp_paramhdr *param);\nstruct sctp_chunk *sctp_make_violation_max_retrans(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_new_encap_port(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tconst struct sctp_chunk *chunk);\nstruct sctp_chunk *sctp_make_heartbeat(const struct sctp_association *asoc,\n\t\t\t\t       const struct sctp_transport *transport,\n\t\t\t\t       __u32 probe_size);\nstruct sctp_chunk *sctp_make_heartbeat_ack(const struct sctp_association *asoc,\n\t\t\t\t\t   const struct sctp_chunk *chunk,\n\t\t\t\t\t   const void *payload,\n\t\t\t\t\t   const size_t paylen);\nstruct sctp_chunk *sctp_make_pad(const struct sctp_association *asoc, int len);\nstruct sctp_chunk *sctp_make_op_error(const struct sctp_association *asoc,\n\t\t\t\t      const struct sctp_chunk *chunk,\n\t\t\t\t      __be16 cause_code, const void *payload,\n\t\t\t\t      size_t paylen, size_t reserve_tail);\n\nstruct sctp_chunk *sctp_make_asconf_update_ip(struct sctp_association *asoc,\n\t\t\t\t\t      union sctp_addr *laddr,\n\t\t\t\t\t      struct sockaddr *addrs,\n\t\t\t\t\t      int addrcnt, __be16 flags);\nstruct sctp_chunk *sctp_make_asconf_set_prim(struct sctp_association *asoc,\n\t\t\t\t\t     union sctp_addr *addr);\nbool sctp_verify_asconf(const struct sctp_association *asoc,\n\t\t\tstruct sctp_chunk *chunk, bool addr_param_needed,\n\t\t\tstruct sctp_paramhdr **errp);\nstruct sctp_chunk *sctp_process_asconf(struct sctp_association *asoc,\n\t\t\t\t       struct sctp_chunk *asconf);\nint sctp_process_asconf_ack(struct sctp_association *asoc,\n\t\t\t    struct sctp_chunk *asconf_ack);\nstruct sctp_chunk *sctp_make_fwdtsn(const struct sctp_association *asoc,\n\t\t\t\t    __u32 new_cum_tsn, size_t nstreams,\n\t\t\t\t    struct sctp_fwdtsn_skip *skiplist);\nstruct sctp_chunk *sctp_make_auth(const struct sctp_association *asoc,\n\t\t\t\t  __u16 key_id);\nstruct sctp_chunk *sctp_make_strreset_req(const struct sctp_association *asoc,\n\t\t\t\t\t  __u16 stream_num, __be16 *stream_list,\n\t\t\t\t\t  bool out, bool in);\nstruct sctp_chunk *sctp_make_strreset_tsnreq(\n\t\t\t\t\tconst struct sctp_association *asoc);\nstruct sctp_chunk *sctp_make_strreset_addstrm(\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\t__u16 out, __u16 in);\nstruct sctp_chunk *sctp_make_strreset_resp(const struct sctp_association *asoc,\n\t\t\t\t\t   __u32 result, __u32 sn);\nstruct sctp_chunk *sctp_make_strreset_tsnresp(struct sctp_association *asoc,\n\t\t\t\t\t      __u32 result, __u32 sn,\n\t\t\t\t\t      __u32 sender_tsn,\n\t\t\t\t\t      __u32 receiver_tsn);\nbool sctp_verify_reconf(const struct sctp_association *asoc,\n\t\t\tstruct sctp_chunk *chunk,\n\t\t\tstruct sctp_paramhdr **errp);\nvoid sctp_chunk_assign_tsn(struct sctp_chunk *chunk);\nvoid sctp_chunk_assign_ssn(struct sctp_chunk *chunk);\n\n \nstruct sctp_chunk *sctp_process_strreset_outreq(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\nstruct sctp_chunk *sctp_process_strreset_inreq(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\nstruct sctp_chunk *sctp_process_strreset_tsnreq(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\nstruct sctp_chunk *sctp_process_strreset_addstrm_out(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\nstruct sctp_chunk *sctp_process_strreset_addstrm_in(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\nstruct sctp_chunk *sctp_process_strreset_resp(\n\t\t\t\tstruct sctp_association *asoc,\n\t\t\t\tunion sctp_params param,\n\t\t\t\tstruct sctp_ulpevent **evp);\n\n \n\nint sctp_do_sm(struct net *net, enum sctp_event_type event_type,\n\t       union sctp_subtype subtype, enum sctp_state state,\n\t       struct sctp_endpoint *ep, struct sctp_association *asoc,\n\t       void *event_arg, gfp_t gfp);\n\n \nvoid sctp_generate_t3_rtx_event(struct timer_list *t);\nvoid sctp_generate_heartbeat_event(struct timer_list *t);\nvoid sctp_generate_reconf_event(struct timer_list *t);\nvoid sctp_generate_probe_event(struct timer_list *t);\nvoid sctp_generate_proto_unreach_event(struct timer_list *t);\n\nvoid sctp_ootb_pkt_free(struct sctp_packet *packet);\n\nstruct sctp_association *sctp_unpack_cookie(\n\t\t\t\t\tconst struct sctp_endpoint *ep,\n\t\t\t\t\tconst struct sctp_association *asoc,\n\t\t\t\t\tstruct sctp_chunk *chunk,\n\t\t\t\t\tgfp_t gfp, int *err,\n\t\t\t\t\tstruct sctp_chunk **err_chk_p);\n\n \n__u32 sctp_generate_tag(const struct sctp_endpoint *ep);\n__u32 sctp_generate_tsn(const struct sctp_endpoint *ep);\n\n \nextern sctp_timer_event_t *sctp_timer_events[SCTP_NUM_TIMEOUT_TYPES];\n\n\n \nstatic inline __u16 sctp_data_size(struct sctp_chunk *chunk)\n{\n\t__u16 size;\n\n\tsize = ntohs(chunk->chunk_hdr->length);\n\tsize -= sctp_datachk_len(&chunk->asoc->stream);\n\n\treturn size;\n}\n\n \n#define TSN_lt(a,b)\t\\\n\t(typecheck(__u32, a) && \\\n\t typecheck(__u32, b) && \\\n\t ((__s32)((a) - (b)) < 0))\n\n#define TSN_lte(a,b)\t\\\n\t(typecheck(__u32, a) && \\\n\t typecheck(__u32, b) && \\\n\t ((__s32)((a) - (b)) <= 0))\n\n \n#define MID_lt(a, b)\t\\\n\t(typecheck(__u32, a) && \\\n\t typecheck(__u32, b) && \\\n\t ((__s32)((a) - (b)) < 0))\n\n \n#define SSN_lt(a,b)\t\t\\\n\t(typecheck(__u16, a) && \\\n\t typecheck(__u16, b) && \\\n\t ((__s16)((a) - (b)) < 0))\n\n \n#define ADDIP_SERIAL_gte(a,b)\t\\\n\t(typecheck(__u32, a) && \\\n\t typecheck(__u32, b) && \\\n\t ((__s32)((b) - (a)) <= 0))\n\n \nstatic inline int\nsctp_vtag_verify(const struct sctp_chunk *chunk,\n\t\t const struct sctp_association *asoc)\n{\n\t \n\tif (ntohl(chunk->sctp_hdr->vtag) != asoc->c.my_vtag)\n\t\treturn 0;\n\n\tchunk->transport->encap_port = SCTP_INPUT_CB(chunk->skb)->encap_port;\n\treturn 1;\n}\n\n \nstatic inline int\nsctp_vtag_verify_either(const struct sctp_chunk *chunk,\n\t\t\tconst struct sctp_association *asoc)\n{\n         \n        if ((!sctp_test_T_bit(chunk) &&\n             (ntohl(chunk->sctp_hdr->vtag) == asoc->c.my_vtag)) ||\n\t    (sctp_test_T_bit(chunk) && asoc->c.peer_vtag &&\n\t     (ntohl(chunk->sctp_hdr->vtag) == asoc->c.peer_vtag))) {\n                return 1;\n\t}\n\n\treturn 0;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}