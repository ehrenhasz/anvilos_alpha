{
  "module_name": "rose.h",
  "hash_id": "fe5e1948d379925a4d4c5a8335a8f7bce448dc4938bcbf1c05d60104f1d9e49f",
  "original_prompt": "Ingested from linux-6.6.14/include/net/rose.h",
  "human_readable_source": " \n \n\n#ifndef _ROSE_H\n#define _ROSE_H \n\n#include <linux/rose.h>\n#include <net/ax25.h>\n#include <net/sock.h>\n\n#define\tROSE_ADDR_LEN\t\t\t5\n\n#define\tROSE_MIN_LEN\t\t\t3\n\n#define\tROSE_CALL_REQ_ADDR_LEN_OFF\t3\n#define\tROSE_CALL_REQ_ADDR_LEN_VAL\t0xAA\t \n#define\tROSE_CALL_REQ_DEST_ADDR_OFF\t4\n#define\tROSE_CALL_REQ_SRC_ADDR_OFF\t9\n#define\tROSE_CALL_REQ_FACILITIES_OFF\t14\n\n#define\tROSE_GFI\t\t\t0x10\n#define\tROSE_Q_BIT\t\t\t0x80\n#define\tROSE_D_BIT\t\t\t0x40\n#define\tROSE_M_BIT\t\t\t0x10\n\n#define\tROSE_CALL_REQUEST\t\t0x0B\n#define\tROSE_CALL_ACCEPTED\t\t0x0F\n#define\tROSE_CLEAR_REQUEST\t\t0x13\n#define\tROSE_CLEAR_CONFIRMATION\t\t0x17\n#define\tROSE_DATA\t\t\t0x00\n#define\tROSE_INTERRUPT\t\t\t0x23\n#define\tROSE_INTERRUPT_CONFIRMATION\t0x27\n#define\tROSE_RR\t\t\t\t0x01\n#define\tROSE_RNR\t\t\t0x05\n#define\tROSE_REJ\t\t\t0x09\n#define\tROSE_RESET_REQUEST\t\t0x1B\n#define\tROSE_RESET_CONFIRMATION\t\t0x1F\n#define\tROSE_REGISTRATION_REQUEST\t0xF3\n#define\tROSE_REGISTRATION_CONFIRMATION\t0xF7\n#define\tROSE_RESTART_REQUEST\t\t0xFB\n#define\tROSE_RESTART_CONFIRMATION\t0xFF\n#define\tROSE_DIAGNOSTIC\t\t\t0xF1\n#define\tROSE_ILLEGAL\t\t\t0xFD\n\n \n\nenum {\n\tROSE_STATE_0,\t\t\t \n\tROSE_STATE_1,\t\t\t \n\tROSE_STATE_2,\t\t\t \n\tROSE_STATE_3,\t\t\t \n\tROSE_STATE_4,\t\t\t \n\tROSE_STATE_5\t\t\t \n};\n\n#define ROSE_DEFAULT_T0\t\t\t180000\t\t \n#define ROSE_DEFAULT_T1\t\t\t200000\t\t \n#define ROSE_DEFAULT_T2\t\t\t180000\t\t \n#define\tROSE_DEFAULT_T3\t\t\t180000\t\t \n#define\tROSE_DEFAULT_HB\t\t\t5000\t\t \n#define\tROSE_DEFAULT_IDLE\t\t0\t\t \n#define\tROSE_DEFAULT_ROUTING\t\t1\t\t \n#define\tROSE_DEFAULT_FAIL_TIMEOUT\t120000\t\t \n#define\tROSE_DEFAULT_MAXVC\t\t50\t\t \n#define\tROSE_DEFAULT_WINDOW_SIZE\t7\t\t \n\n#define ROSE_MODULUS \t\t\t8\n#define\tROSE_MAX_PACKET_SIZE\t\t251\t\t \n\n#define\tROSE_COND_ACK_PENDING\t\t0x01\n#define\tROSE_COND_PEER_RX_BUSY\t\t0x02\n#define\tROSE_COND_OWN_RX_BUSY\t\t0x04\n\n#define\tFAC_NATIONAL\t\t\t0x00\n#define\tFAC_CCITT\t\t\t0x0F\n\n#define\tFAC_NATIONAL_RAND\t\t0x7F\n#define\tFAC_NATIONAL_FLAGS\t\t0x3F\n#define\tFAC_NATIONAL_DEST_DIGI\t\t0xE9\n#define\tFAC_NATIONAL_SRC_DIGI\t\t0xEB\n#define\tFAC_NATIONAL_FAIL_CALL\t\t0xED\n#define\tFAC_NATIONAL_FAIL_ADD\t\t0xEE\n#define\tFAC_NATIONAL_DIGIS\t\t\t0xEF\n\n#define\tFAC_CCITT_DEST_NSAP\t\t0xC9\n#define\tFAC_CCITT_SRC_NSAP\t\t0xCB\n\nstruct rose_neigh {\n\tstruct rose_neigh\t*next;\n\tax25_address\t\tcallsign;\n\tax25_digi\t\t*digipeat;\n\tax25_cb\t\t\t*ax25;\n\tstruct net_device\t\t*dev;\n\tunsigned short\t\tcount;\n\tunsigned short\t\tuse;\n\tunsigned int\t\tnumber;\n\tchar\t\t\trestarted;\n\tchar\t\t\tdce_mode;\n\tchar\t\t\tloopback;\n\tstruct sk_buff_head\tqueue;\n\tstruct timer_list\tt0timer;\n\tstruct timer_list\tftimer;\n};\n\nstruct rose_node {\n\tstruct rose_node\t*next;\n\trose_address\t\taddress;\n\tunsigned short\t\tmask;\n\tunsigned char\t\tcount;\n\tchar\t\t\tloopback;\n\tstruct rose_neigh\t*neighbour[3];\n};\n\nstruct rose_route {\n\tstruct rose_route\t*next;\n\tunsigned int\t\tlci1, lci2;\n\trose_address\t\tsrc_addr, dest_addr;\n\tax25_address\t\tsrc_call, dest_call;\n\tstruct rose_neigh \t*neigh1, *neigh2;\n\tunsigned int\t\trand;\n};\n\nstruct rose_sock {\n\tstruct sock\t\tsock;\n\trose_address\t\tsource_addr,   dest_addr;\n\tax25_address\t\tsource_call,   dest_call;\n\tunsigned char\t\tsource_ndigis, dest_ndigis;\n\tax25_address\t\tsource_digis[ROSE_MAX_DIGIS];\n\tax25_address\t\tdest_digis[ROSE_MAX_DIGIS];\n\tstruct rose_neigh\t*neighbour;\n\tstruct net_device\t*device;\n\tnetdevice_tracker\tdev_tracker;\n\tunsigned int\t\tlci, rand;\n\tunsigned char\t\tstate, condition, qbitincl, defer;\n\tunsigned char\t\tcause, diagnostic;\n\tunsigned short\t\tvs, vr, va, vl;\n\tunsigned long\t\tt1, t2, t3, hb, idle;\n#ifdef M_BIT\n\tunsigned short\t\tfraglen;\n\tstruct sk_buff_head\tfrag_queue;\n#endif\n\tstruct sk_buff_head\tack_queue;\n\tstruct rose_facilities_struct facilities;\n\tstruct timer_list\ttimer;\n\tstruct timer_list\tidletimer;\n};\n\n#define rose_sk(sk) ((struct rose_sock *)(sk))\n\n \nextern ax25_address rose_callsign;\nextern int  sysctl_rose_restart_request_timeout;\nextern int  sysctl_rose_call_request_timeout;\nextern int  sysctl_rose_reset_request_timeout;\nextern int  sysctl_rose_clear_request_timeout;\nextern int  sysctl_rose_no_activity_timeout;\nextern int  sysctl_rose_ack_hold_back_timeout;\nextern int  sysctl_rose_routing_control;\nextern int  sysctl_rose_link_fail_timeout;\nextern int  sysctl_rose_maximum_vcs;\nextern int  sysctl_rose_window_size;\n\nint rosecmp(const rose_address *, const rose_address *);\nint rosecmpm(const rose_address *, const rose_address *, unsigned short);\nchar *rose2asc(char *buf, const rose_address *);\nstruct sock *rose_find_socket(unsigned int, struct rose_neigh *);\nvoid rose_kill_by_neigh(struct rose_neigh *);\nunsigned int rose_new_lci(struct rose_neigh *);\nint rose_rx_call_request(struct sk_buff *, struct net_device *,\n\t\t\t struct rose_neigh *, unsigned int);\nvoid rose_destroy_socket(struct sock *);\n\n \nvoid rose_setup(struct net_device *);\n\n \nint rose_process_rx_frame(struct sock *, struct sk_buff *);\n\n \nvoid rose_start_ftimer(struct rose_neigh *);\nvoid rose_stop_ftimer(struct rose_neigh *);\nvoid rose_stop_t0timer(struct rose_neigh *);\nint rose_ftimer_running(struct rose_neigh *);\nvoid rose_link_rx_restart(struct sk_buff *, struct rose_neigh *,\n\t\t\t  unsigned short);\nvoid rose_transmit_clear_request(struct rose_neigh *, unsigned int,\n\t\t\t\t unsigned char, unsigned char);\nvoid rose_transmit_link(struct sk_buff *, struct rose_neigh *);\n\n \nvoid rose_loopback_init(void);\nvoid rose_loopback_clear(void);\nint rose_loopback_queue(struct sk_buff *, struct rose_neigh *);\n\n \nvoid rose_kick(struct sock *);\nvoid rose_enquiry_response(struct sock *);\n\n \nextern struct rose_neigh *rose_loopback_neigh;\nextern const struct seq_operations rose_neigh_seqops;\nextern const struct seq_operations rose_node_seqops;\nextern struct seq_operations rose_route_seqops;\n\nvoid rose_add_loopback_neigh(void);\nint __must_check rose_add_loopback_node(const rose_address *);\nvoid rose_del_loopback_node(const rose_address *);\nvoid rose_rt_device_down(struct net_device *);\nvoid rose_link_device_down(struct net_device *);\nstruct net_device *rose_dev_first(void);\nstruct net_device *rose_dev_get(rose_address *);\nstruct rose_route *rose_route_free_lci(unsigned int, struct rose_neigh *);\nstruct rose_neigh *rose_get_neigh(rose_address *, unsigned char *,\n\t\t\t\t  unsigned char *, int);\nint rose_rt_ioctl(unsigned int, void __user *);\nvoid rose_link_failed(ax25_cb *, int);\nint rose_route_frame(struct sk_buff *, ax25_cb *);\nvoid rose_rt_free(void);\n\n \nvoid rose_clear_queues(struct sock *);\nvoid rose_frames_acked(struct sock *, unsigned short);\nvoid rose_requeue_frames(struct sock *);\nint rose_validate_nr(struct sock *, unsigned short);\nvoid rose_write_internal(struct sock *, int);\nint rose_decode(struct sk_buff *, int *, int *, int *, int *, int *);\nint rose_parse_facilities(unsigned char *, unsigned int,\n\t\t\t  struct rose_facilities_struct *);\nvoid rose_disconnect(struct sock *, int, int, int);\n\n \nvoid rose_start_heartbeat(struct sock *);\nvoid rose_start_t1timer(struct sock *);\nvoid rose_start_t2timer(struct sock *);\nvoid rose_start_t3timer(struct sock *);\nvoid rose_start_hbtimer(struct sock *);\nvoid rose_start_idletimer(struct sock *);\nvoid rose_stop_heartbeat(struct sock *);\nvoid rose_stop_timer(struct sock *);\nvoid rose_stop_idletimer(struct sock *);\n\n \nvoid rose_register_sysctl(void);\nvoid rose_unregister_sysctl(void);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}