{
  "module_name": "nfc.h",
  "hash_id": "58b35dc73224480da2ffff0b9db77aee31b979b06030b2894ffb2ff9f76f70db",
  "original_prompt": "Ingested from linux-6.6.14/include/net/nfc/nfc.h",
  "human_readable_source": " \n \n\n#ifndef __NET_NFC_H\n#define __NET_NFC_H\n\n#include <linux/nfc.h>\n#include <linux/device.h>\n#include <linux/skbuff.h>\n\n#define nfc_dbg(dev, fmt, ...) dev_dbg((dev), \"NFC: \" fmt, ##__VA_ARGS__)\n#define nfc_info(dev, fmt, ...) dev_info((dev), \"NFC: \" fmt, ##__VA_ARGS__)\n#define nfc_err(dev, fmt, ...) dev_err((dev), \"NFC: \" fmt, ##__VA_ARGS__)\n\nstruct nfc_phy_ops {\n\tint (*write)(void *dev_id, struct sk_buff *skb);\n\tint (*enable)(void *dev_id);\n\tvoid (*disable)(void *dev_id);\n};\n\nstruct nfc_dev;\n\n \ntypedef void (*data_exchange_cb_t)(void *context, struct sk_buff *skb,\n\t\t\t\t\t\t\t\tint err);\n\ntypedef void (*se_io_cb_t)(void *context, u8 *apdu, size_t apdu_len, int err);\n\nstruct nfc_target;\n\nstruct nfc_ops {\n\tint (*dev_up)(struct nfc_dev *dev);\n\tint (*dev_down)(struct nfc_dev *dev);\n\tint (*start_poll)(struct nfc_dev *dev,\n\t\t\t  u32 im_protocols, u32 tm_protocols);\n\tvoid (*stop_poll)(struct nfc_dev *dev);\n\tint (*dep_link_up)(struct nfc_dev *dev, struct nfc_target *target,\n\t\t\t   u8 comm_mode, u8 *gb, size_t gb_len);\n\tint (*dep_link_down)(struct nfc_dev *dev);\n\tint (*activate_target)(struct nfc_dev *dev, struct nfc_target *target,\n\t\t\t       u32 protocol);\n\tvoid (*deactivate_target)(struct nfc_dev *dev,\n\t\t\t\t  struct nfc_target *target, u8 mode);\n\tint (*im_transceive)(struct nfc_dev *dev, struct nfc_target *target,\n\t\t\t     struct sk_buff *skb, data_exchange_cb_t cb,\n\t\t\t     void *cb_context);\n\tint (*tm_send)(struct nfc_dev *dev, struct sk_buff *skb);\n\tint (*check_presence)(struct nfc_dev *dev, struct nfc_target *target);\n\tint (*fw_download)(struct nfc_dev *dev, const char *firmware_name);\n\n\t \n\tint (*discover_se)(struct nfc_dev *dev);\n\tint (*enable_se)(struct nfc_dev *dev, u32 se_idx);\n\tint (*disable_se)(struct nfc_dev *dev, u32 se_idx);\n\tint (*se_io) (struct nfc_dev *dev, u32 se_idx,\n\t\t      u8 *apdu, size_t apdu_length,\n\t\t      se_io_cb_t cb, void *cb_context);\n};\n\n#define NFC_TARGET_IDX_ANY -1\n#define NFC_MAX_GT_LEN 48\n#define NFC_ATR_RES_GT_OFFSET 15\n#define NFC_ATR_REQ_GT_OFFSET 14\n\n \nstruct nfc_target {\n\tu32 idx;\n\tu32 supported_protocols;\n\tu16 sens_res;\n\tu8 sel_res;\n\tu8 nfcid1_len;\n\tu8 nfcid1[NFC_NFCID1_MAXSIZE];\n\tu8 nfcid2_len;\n\tu8 nfcid2[NFC_NFCID2_MAXSIZE];\n\tu8 sensb_res_len;\n\tu8 sensb_res[NFC_SENSB_RES_MAXSIZE];\n\tu8 sensf_res_len;\n\tu8 sensf_res[NFC_SENSF_RES_MAXSIZE];\n\tu8 hci_reader_gate;\n\tu8 logical_idx;\n\tu8 is_iso15693;\n\tu8 iso15693_dsfid;\n\tu8 iso15693_uid[NFC_ISO15693_UID_MAXSIZE];\n};\n\n \nstruct nfc_se {\n\tstruct list_head list;\n\tu32 idx;\n\tu16 type;\n\tu16 state;\n};\n\n \n#define NFC_MIN_AID_LENGTH\t5\n#define\tNFC_MAX_AID_LENGTH\t16\n#define NFC_MAX_PARAMS_LENGTH\t255\n\n#define NFC_EVT_TRANSACTION_AID_TAG\t0x81\n#define NFC_EVT_TRANSACTION_PARAMS_TAG\t0x82\nstruct nfc_evt_transaction {\n\tu32 aid_len;\n\tu8 aid[NFC_MAX_AID_LENGTH];\n\tu8 params_len;\n\tu8 params[];\n} __packed;\n\nstruct nfc_genl_data {\n\tu32 poll_req_portid;\n\tstruct mutex genl_data_mutex;\n};\n\nstruct nfc_vendor_cmd {\n\t__u32 vendor_id;\n\t__u32 subcmd;\n\tint (*doit)(struct nfc_dev *dev, void *data, size_t data_len);\n};\n\nstruct nfc_dev {\n\tint idx;\n\tu32 target_next_idx;\n\tstruct nfc_target *targets;\n\tint n_targets;\n\tint targets_generation;\n\tstruct device dev;\n\tbool dev_up;\n\tbool fw_download_in_progress;\n\tu8 rf_mode;\n\tbool polling;\n\tstruct nfc_target *active_target;\n\tbool dep_link_up;\n\tstruct nfc_genl_data genl_data;\n\tu32 supported_protocols;\n\n\tstruct list_head secure_elements;\n\n\tint tx_headroom;\n\tint tx_tailroom;\n\n\tstruct timer_list check_pres_timer;\n\tstruct work_struct check_pres_work;\n\n\tbool shutting_down;\n\n\tstruct rfkill *rfkill;\n\n\tconst struct nfc_vendor_cmd *vendor_cmds;\n\tint n_vendor_cmds;\n\n\tconst struct nfc_ops *ops;\n\tstruct genl_info *cur_cmd_info;\n};\n#define to_nfc_dev(_dev) container_of(_dev, struct nfc_dev, dev)\n\nextern struct class nfc_class;\n\nstruct nfc_dev *nfc_allocate_device(const struct nfc_ops *ops,\n\t\t\t\t    u32 supported_protocols,\n\t\t\t\t    int tx_headroom,\n\t\t\t\t    int tx_tailroom);\n\n \nstatic inline void nfc_free_device(struct nfc_dev *dev)\n{\n\tput_device(&dev->dev);\n}\n\nint nfc_register_device(struct nfc_dev *dev);\n\nvoid nfc_unregister_device(struct nfc_dev *dev);\n\n \nstatic inline void nfc_set_parent_dev(struct nfc_dev *nfc_dev,\n\t\t\t\t      struct device *dev)\n{\n\tnfc_dev->dev.parent = dev;\n}\n\n \nstatic inline void nfc_set_drvdata(struct nfc_dev *dev, void *data)\n{\n\tdev_set_drvdata(&dev->dev, data);\n}\n\n \nstatic inline void *nfc_get_drvdata(const struct nfc_dev *dev)\n{\n\treturn dev_get_drvdata(&dev->dev);\n}\n\n \nstatic inline const char *nfc_device_name(const struct nfc_dev *dev)\n{\n\treturn dev_name(&dev->dev);\n}\n\nstruct sk_buff *nfc_alloc_send_skb(struct nfc_dev *dev, struct sock *sk,\n\t\t\t\t   unsigned int flags, unsigned int size,\n\t\t\t\t   unsigned int *err);\nstruct sk_buff *nfc_alloc_recv_skb(unsigned int size, gfp_t gfp);\n\nint nfc_set_remote_general_bytes(struct nfc_dev *dev,\n\t\t\t\t const u8 *gt, u8 gt_len);\nu8 *nfc_get_local_general_bytes(struct nfc_dev *dev, size_t *gb_len);\n\nint nfc_fw_download_done(struct nfc_dev *dev, const char *firmware_name,\n\t\t\t u32 result);\n\nint nfc_targets_found(struct nfc_dev *dev,\n\t\t      struct nfc_target *targets, int ntargets);\nint nfc_target_lost(struct nfc_dev *dev, u32 target_idx);\n\nint nfc_dep_link_is_up(struct nfc_dev *dev, u32 target_idx,\n\t\t       u8 comm_mode, u8 rf_mode);\n\nint nfc_tm_activated(struct nfc_dev *dev, u32 protocol, u8 comm_mode,\n\t\t     const u8 *gb, size_t gb_len);\nint nfc_tm_deactivated(struct nfc_dev *dev);\nint nfc_tm_data_received(struct nfc_dev *dev, struct sk_buff *skb);\n\nvoid nfc_driver_failure(struct nfc_dev *dev, int err);\n\nint nfc_se_transaction(struct nfc_dev *dev, u8 se_idx,\n\t\t       struct nfc_evt_transaction *evt_transaction);\nint nfc_se_connectivity(struct nfc_dev *dev, u8 se_idx);\nint nfc_add_se(struct nfc_dev *dev, u32 se_idx, u16 type);\nint nfc_remove_se(struct nfc_dev *dev, u32 se_idx);\nstruct nfc_se *nfc_find_se(struct nfc_dev *dev, u32 se_idx);\n\nvoid nfc_send_to_raw_sock(struct nfc_dev *dev, struct sk_buff *skb,\n\t\t\t  u8 payload_type, u8 direction);\n\nstatic inline int nfc_set_vendor_cmds(struct nfc_dev *dev,\n\t\t\t\t      const struct nfc_vendor_cmd *cmds,\n\t\t\t\t      int n_cmds)\n{\n\tif (dev->vendor_cmds || dev->n_vendor_cmds)\n\t\treturn -EINVAL;\n\n\tdev->vendor_cmds = cmds;\n\tdev->n_vendor_cmds = n_cmds;\n\n\treturn 0;\n}\n\nstruct sk_buff *__nfc_alloc_vendor_cmd_reply_skb(struct nfc_dev *dev,\n\t\t\t\t\t\t enum nfc_attrs attr,\n\t\t\t\t\t\t u32 oui, u32 subcmd,\n\t\t\t\t\t\t int approxlen);\nint nfc_vendor_cmd_reply(struct sk_buff *skb);\n\n \nstatic inline struct sk_buff *\nnfc_vendor_cmd_alloc_reply_skb(struct nfc_dev *dev,\n\t\t\t\tu32 oui, u32 subcmd, int approxlen)\n{\n\treturn __nfc_alloc_vendor_cmd_reply_skb(dev,\n\t\t\t\t\t\tNFC_ATTR_VENDOR_DATA,\n\t\t\t\t\t\toui,\n\t\t\t\t\t\tsubcmd, approxlen);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}