{
  "module_name": "flow.h",
  "hash_id": "eb1b9dc303183c3581f58fd18d1963d3bc312668ec7d812592a2895d3bc1ef14",
  "original_prompt": "Ingested from linux-6.6.14/include/net/flow.h",
  "human_readable_source": " \n \n\n#ifndef _NET_FLOW_H\n#define _NET_FLOW_H\n\n#include <linux/in6.h>\n#include <linux/atomic.h>\n#include <linux/container_of.h>\n#include <linux/uidgid.h>\n\nstruct flow_keys;\n\n \n\n#define LOOPBACK_IFINDEX\t1\n\nstruct flowi_tunnel {\n\t__be64\t\t\ttun_id;\n};\n\nstruct flowi_common {\n\tint\tflowic_oif;\n\tint\tflowic_iif;\n\tint     flowic_l3mdev;\n\t__u32\tflowic_mark;\n\t__u8\tflowic_tos;\n\t__u8\tflowic_scope;\n\t__u8\tflowic_proto;\n\t__u8\tflowic_flags;\n#define FLOWI_FLAG_ANYSRC\t\t0x01\n#define FLOWI_FLAG_KNOWN_NH\t\t0x02\n\t__u32\tflowic_secid;\n\tkuid_t  flowic_uid;\n\t__u32\t\tflowic_multipath_hash;\n\tstruct flowi_tunnel flowic_tun_key;\n};\n\nunion flowi_uli {\n\tstruct {\n\t\t__be16\tdport;\n\t\t__be16\tsport;\n\t} ports;\n\n\tstruct {\n\t\t__u8\ttype;\n\t\t__u8\tcode;\n\t} icmpt;\n\n\t__be32\t\tgre_key;\n\n\tstruct {\n\t\t__u8\ttype;\n\t} mht;\n};\n\nstruct flowi4 {\n\tstruct flowi_common\t__fl_common;\n#define flowi4_oif\t\t__fl_common.flowic_oif\n#define flowi4_iif\t\t__fl_common.flowic_iif\n#define flowi4_l3mdev\t\t__fl_common.flowic_l3mdev\n#define flowi4_mark\t\t__fl_common.flowic_mark\n#define flowi4_tos\t\t__fl_common.flowic_tos\n#define flowi4_scope\t\t__fl_common.flowic_scope\n#define flowi4_proto\t\t__fl_common.flowic_proto\n#define flowi4_flags\t\t__fl_common.flowic_flags\n#define flowi4_secid\t\t__fl_common.flowic_secid\n#define flowi4_tun_key\t\t__fl_common.flowic_tun_key\n#define flowi4_uid\t\t__fl_common.flowic_uid\n#define flowi4_multipath_hash\t__fl_common.flowic_multipath_hash\n\n\t \n\t__be32\t\t\tsaddr;\n\t__be32\t\t\tdaddr;\n\n\tunion flowi_uli\t\tuli;\n#define fl4_sport\t\tuli.ports.sport\n#define fl4_dport\t\tuli.ports.dport\n#define fl4_icmp_type\t\tuli.icmpt.type\n#define fl4_icmp_code\t\tuli.icmpt.code\n#define fl4_mh_type\t\tuli.mht.type\n#define fl4_gre_key\t\tuli.gre_key\n} __attribute__((__aligned__(BITS_PER_LONG/8)));\n\nstatic inline void flowi4_init_output(struct flowi4 *fl4, int oif,\n\t\t\t\t      __u32 mark, __u8 tos, __u8 scope,\n\t\t\t\t      __u8 proto, __u8 flags,\n\t\t\t\t      __be32 daddr, __be32 saddr,\n\t\t\t\t      __be16 dport, __be16 sport,\n\t\t\t\t      kuid_t uid)\n{\n\tfl4->flowi4_oif = oif;\n\tfl4->flowi4_iif = LOOPBACK_IFINDEX;\n\tfl4->flowi4_l3mdev = 0;\n\tfl4->flowi4_mark = mark;\n\tfl4->flowi4_tos = tos;\n\tfl4->flowi4_scope = scope;\n\tfl4->flowi4_proto = proto;\n\tfl4->flowi4_flags = flags;\n\tfl4->flowi4_secid = 0;\n\tfl4->flowi4_tun_key.tun_id = 0;\n\tfl4->flowi4_uid = uid;\n\tfl4->daddr = daddr;\n\tfl4->saddr = saddr;\n\tfl4->fl4_dport = dport;\n\tfl4->fl4_sport = sport;\n\tfl4->flowi4_multipath_hash = 0;\n}\n\n \nstatic inline void flowi4_update_output(struct flowi4 *fl4, int oif,\n\t\t\t\t\t__be32 daddr, __be32 saddr)\n{\n\tfl4->flowi4_oif = oif;\n\tfl4->daddr = daddr;\n\tfl4->saddr = saddr;\n}\n\n\nstruct flowi6 {\n\tstruct flowi_common\t__fl_common;\n#define flowi6_oif\t\t__fl_common.flowic_oif\n#define flowi6_iif\t\t__fl_common.flowic_iif\n#define flowi6_l3mdev\t\t__fl_common.flowic_l3mdev\n#define flowi6_mark\t\t__fl_common.flowic_mark\n#define flowi6_scope\t\t__fl_common.flowic_scope\n#define flowi6_proto\t\t__fl_common.flowic_proto\n#define flowi6_flags\t\t__fl_common.flowic_flags\n#define flowi6_secid\t\t__fl_common.flowic_secid\n#define flowi6_tun_key\t\t__fl_common.flowic_tun_key\n#define flowi6_uid\t\t__fl_common.flowic_uid\n\tstruct in6_addr\t\tdaddr;\n\tstruct in6_addr\t\tsaddr;\n\t \n\t__be32\t\t\tflowlabel;\n\tunion flowi_uli\t\tuli;\n#define fl6_sport\t\tuli.ports.sport\n#define fl6_dport\t\tuli.ports.dport\n#define fl6_icmp_type\t\tuli.icmpt.type\n#define fl6_icmp_code\t\tuli.icmpt.code\n#define fl6_mh_type\t\tuli.mht.type\n#define fl6_gre_key\t\tuli.gre_key\n\t__u32\t\t\tmp_hash;\n} __attribute__((__aligned__(BITS_PER_LONG/8)));\n\nstruct flowi {\n\tunion {\n\t\tstruct flowi_common\t__fl_common;\n\t\tstruct flowi4\t\tip4;\n\t\tstruct flowi6\t\tip6;\n\t} u;\n#define flowi_oif\tu.__fl_common.flowic_oif\n#define flowi_iif\tu.__fl_common.flowic_iif\n#define flowi_l3mdev\tu.__fl_common.flowic_l3mdev\n#define flowi_mark\tu.__fl_common.flowic_mark\n#define flowi_tos\tu.__fl_common.flowic_tos\n#define flowi_scope\tu.__fl_common.flowic_scope\n#define flowi_proto\tu.__fl_common.flowic_proto\n#define flowi_flags\tu.__fl_common.flowic_flags\n#define flowi_secid\tu.__fl_common.flowic_secid\n#define flowi_tun_key\tu.__fl_common.flowic_tun_key\n#define flowi_uid\tu.__fl_common.flowic_uid\n} __attribute__((__aligned__(BITS_PER_LONG/8)));\n\nstatic inline struct flowi *flowi4_to_flowi(struct flowi4 *fl4)\n{\n\treturn container_of(fl4, struct flowi, u.ip4);\n}\n\nstatic inline struct flowi_common *flowi4_to_flowi_common(struct flowi4 *fl4)\n{\n\treturn &(fl4->__fl_common);\n}\n\nstatic inline struct flowi *flowi6_to_flowi(struct flowi6 *fl6)\n{\n\treturn container_of(fl6, struct flowi, u.ip6);\n}\n\nstatic inline struct flowi_common *flowi6_to_flowi_common(struct flowi6 *fl6)\n{\n\treturn &(fl6->__fl_common);\n}\n\n__u32 __get_hash_from_flowi6(const struct flowi6 *fl6, struct flow_keys *keys);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}