{
  "module_name": "hw_channel.h",
  "hash_id": "04e99b2b3746ed5a8388b594571d75718638745608e2d6fdf7c51872492bde92",
  "original_prompt": "Ingested from linux-6.6.14/include/net/mana/hw_channel.h",
  "human_readable_source": " \n \n\n#ifndef _HW_CHANNEL_H\n#define _HW_CHANNEL_H\n\n#define DEFAULT_LOG2_THROTTLING_FOR_ERROR_EQ  4\n\n#define HW_CHANNEL_MAX_REQUEST_SIZE  0x1000\n#define HW_CHANNEL_MAX_RESPONSE_SIZE 0x1000\n\n#define HW_CHANNEL_VF_BOOTSTRAP_QUEUE_DEPTH 1\n\n#define HWC_INIT_DATA_CQID\t\t1\n#define HWC_INIT_DATA_RQID\t\t2\n#define HWC_INIT_DATA_SQID\t\t3\n#define HWC_INIT_DATA_QUEUE_DEPTH\t4\n#define HWC_INIT_DATA_MAX_REQUEST\t5\n#define HWC_INIT_DATA_MAX_RESPONSE\t6\n#define HWC_INIT_DATA_MAX_NUM_CQS\t7\n#define HWC_INIT_DATA_PDID\t\t8\n#define HWC_INIT_DATA_GPA_MKEY\t\t9\n#define HWC_INIT_DATA_PF_DEST_RQ_ID\t10\n#define HWC_INIT_DATA_PF_DEST_CQ_ID\t11\n\n#define HWC_DATA_CFG_HWC_TIMEOUT 1\n\n#define HW_CHANNEL_WAIT_RESOURCE_TIMEOUT_MS 30000\n\n \n\nunion hwc_init_eq_id_db {\n\tu32 as_uint32;\n\n\tstruct {\n\t\tu32 eq_id\t: 16;\n\t\tu32 doorbell\t: 16;\n\t};\n};  \n\nunion hwc_init_type_data {\n\tu32 as_uint32;\n\n\tstruct {\n\t\tu32 value\t: 24;\n\t\tu32 type\t:  8;\n\t};\n};  \n\nstruct hwc_rx_oob {\n\tu32 type\t: 6;\n\tu32 eom\t\t: 1;\n\tu32 som\t\t: 1;\n\tu32 vendor_err\t: 8;\n\tu32 reserved1\t: 16;\n\n\tu32 src_virt_wq\t: 24;\n\tu32 src_vfid\t: 8;\n\n\tu32 reserved2;\n\n\tunion {\n\t\tu32 wqe_addr_low;\n\t\tu32 wqe_offset;\n\t};\n\n\tu32 wqe_addr_high;\n\n\tu32 client_data_unit\t: 14;\n\tu32 reserved3\t\t: 18;\n\n\tu32 tx_oob_data_size;\n\n\tu32 chunk_offset\t: 21;\n\tu32 reserved4\t\t: 11;\n};  \n\nstruct hwc_tx_oob {\n\tu32 reserved1;\n\n\tu32 reserved2;\n\n\tu32 vrq_id\t: 24;\n\tu32 dest_vfid\t: 8;\n\n\tu32 vrcq_id\t: 24;\n\tu32 reserved3\t: 8;\n\n\tu32 vscq_id\t: 24;\n\tu32 loopback\t: 1;\n\tu32 lso_override: 1;\n\tu32 dest_pf\t: 1;\n\tu32 reserved4\t: 5;\n\n\tu32 vsq_id\t: 24;\n\tu32 reserved5\t: 8;\n};  \n\nstruct hwc_work_request {\n\tvoid *buf_va;\n\tvoid *buf_sge_addr;\n\tu32 buf_len;\n\tu32 msg_size;\n\n\tstruct gdma_wqe_request wqe_req;\n\tstruct hwc_tx_oob tx_oob;\n\n\tstruct gdma_sge sge;\n};\n\n \nstruct hwc_dma_buf {\n\tstruct gdma_mem_info mem_info;\n\n\tu32 gpa_mkey;\n\n\tu32 num_reqs;\n\tstruct hwc_work_request reqs[];\n};\n\ntypedef void hwc_rx_event_handler_t(void *ctx, u32 gdma_rxq_id,\n\t\t\t\t    const struct hwc_rx_oob *rx_oob);\n\ntypedef void hwc_tx_event_handler_t(void *ctx, u32 gdma_txq_id,\n\t\t\t\t    const struct hwc_rx_oob *rx_oob);\n\nstruct hwc_cq {\n\tstruct hw_channel_context *hwc;\n\n\tstruct gdma_queue *gdma_cq;\n\tstruct gdma_queue *gdma_eq;\n\tstruct gdma_comp *comp_buf;\n\tu16 queue_depth;\n\n\thwc_rx_event_handler_t *rx_event_handler;\n\tvoid *rx_event_ctx;\n\n\thwc_tx_event_handler_t *tx_event_handler;\n\tvoid *tx_event_ctx;\n};\n\nstruct hwc_wq {\n\tstruct hw_channel_context *hwc;\n\n\tstruct gdma_queue *gdma_wq;\n\tstruct hwc_dma_buf *msg_buf;\n\tu16 queue_depth;\n\n\tstruct hwc_cq *hwc_cq;\n};\n\nstruct hwc_caller_ctx {\n\tstruct completion comp_event;\n\tvoid *output_buf;\n\tu32 output_buflen;\n\n\tu32 error;  \n\tu32 status_code;\n};\n\nstruct hw_channel_context {\n\tstruct gdma_dev *gdma_dev;\n\tstruct device *dev;\n\n\tu16 num_inflight_msg;\n\tu32 max_req_msg_size;\n\n\tu16 hwc_init_q_depth_max;\n\tu32 hwc_init_max_req_msg_size;\n\tu32 hwc_init_max_resp_msg_size;\n\n\tstruct completion hwc_init_eqe_comp;\n\n\tstruct hwc_wq *rxq;\n\tstruct hwc_wq *txq;\n\tstruct hwc_cq *cq;\n\n\tstruct semaphore sema;\n\tstruct gdma_resource inflight_msg_res;\n\n\tu32 pf_dest_vrq_id;\n\tu32 pf_dest_vrcq_id;\n\tu32 hwc_timeout;\n\n\tstruct hwc_caller_ctx *caller_ctx;\n};\n\nint mana_hwc_create_channel(struct gdma_context *gc);\nvoid mana_hwc_destroy_channel(struct gdma_context *gc);\n\nint mana_hwc_send_request(struct hw_channel_context *hwc, u32 req_len,\n\t\t\t  const void *req, u32 resp_len, void *resp);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}