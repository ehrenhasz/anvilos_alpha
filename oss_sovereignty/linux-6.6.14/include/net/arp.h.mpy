{
  "module_name": "arp.h",
  "hash_id": "6b4414b6426c11b10116e45bbc3199657f0b6ff8da1e1e44d7413e3acf49d2ee",
  "original_prompt": "Ingested from linux-6.6.14/include/net/arp.h",
  "human_readable_source": " \n \n#ifndef _ARP_H\n#define _ARP_H\n\n#include <linux/if_arp.h>\n#include <linux/hash.h>\n#include <net/neighbour.h>\n\n\nextern struct neigh_table arp_tbl;\n\nstatic inline u32 arp_hashfn(const void *pkey, const struct net_device *dev, u32 *hash_rnd)\n{\n\tu32 key = *(const u32 *)pkey;\n\tu32 val = key ^ hash32_ptr(dev);\n\n\treturn val * hash_rnd[0];\n}\n\n#ifdef CONFIG_INET\nstatic inline struct neighbour *__ipv4_neigh_lookup_noref(struct net_device *dev, u32 key)\n{\n\tif (dev->flags & (IFF_LOOPBACK | IFF_POINTOPOINT))\n\t\tkey = INADDR_ANY;\n\n\treturn ___neigh_lookup_noref(&arp_tbl, neigh_key_eq32, arp_hashfn, &key, dev);\n}\n#else\nstatic inline\nstruct neighbour *__ipv4_neigh_lookup_noref(struct net_device *dev, u32 key)\n{\n\treturn NULL;\n}\n#endif\n\nstatic inline struct neighbour *__ipv4_neigh_lookup(struct net_device *dev, u32 key)\n{\n\tstruct neighbour *n;\n\n\trcu_read_lock();\n\tn = __ipv4_neigh_lookup_noref(dev, key);\n\tif (n && !refcount_inc_not_zero(&n->refcnt))\n\t\tn = NULL;\n\trcu_read_unlock();\n\n\treturn n;\n}\n\nstatic inline void __ipv4_confirm_neigh(struct net_device *dev, u32 key)\n{\n\tstruct neighbour *n;\n\n\trcu_read_lock();\n\tn = __ipv4_neigh_lookup_noref(dev, key);\n\tneigh_confirm(n);\n\trcu_read_unlock();\n}\n\nvoid arp_init(void);\nint arp_ioctl(struct net *net, unsigned int cmd, void __user *arg);\nvoid arp_send(int type, int ptype, __be32 dest_ip,\n\t      struct net_device *dev, __be32 src_ip,\n\t      const unsigned char *dest_hw,\n\t      const unsigned char *src_hw, const unsigned char *th);\nint arp_mc_map(__be32 addr, u8 *haddr, struct net_device *dev, int dir);\nvoid arp_ifdown(struct net_device *dev);\nint arp_invalidate(struct net_device *dev, __be32 ip, bool force);\n\nstruct sk_buff *arp_create(int type, int ptype, __be32 dest_ip,\n\t\t\t   struct net_device *dev, __be32 src_ip,\n\t\t\t   const unsigned char *dest_hw,\n\t\t\t   const unsigned char *src_hw,\n\t\t\t   const unsigned char *target_hw);\nvoid arp_xmit(struct sk_buff *skb);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}