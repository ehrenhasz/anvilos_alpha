{
  "module_name": "genetlink.h",
  "hash_id": "2177335c097f408d3e636debdb5fc1ab22f525b4eaa4dec761dfc122b959189f",
  "original_prompt": "Ingested from linux-6.6.14/include/net/genetlink.h",
  "human_readable_source": " \n#ifndef __NET_GENERIC_NETLINK_H\n#define __NET_GENERIC_NETLINK_H\n\n#include <linux/genetlink.h>\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n\n#define GENLMSG_DEFAULT_SIZE (NLMSG_DEFAULT_SIZE - GENL_HDRLEN)\n\n \nstruct genl_multicast_group {\n\tchar\t\t\tname[GENL_NAMSIZ];\n\tu8\t\t\tflags;\n\tu8\t\t\tcap_sys_admin:1;\n};\n\nstruct genl_split_ops;\nstruct genl_info;\n\n \nstruct genl_family {\n\tunsigned int\t\thdrsize;\n\tchar\t\t\tname[GENL_NAMSIZ];\n\tunsigned int\t\tversion;\n\tunsigned int\t\tmaxattr;\n\tu8\t\t\tnetnsok:1;\n\tu8\t\t\tparallel_ops:1;\n\tu8\t\t\tn_ops;\n\tu8\t\t\tn_small_ops;\n\tu8\t\t\tn_split_ops;\n\tu8\t\t\tn_mcgrps;\n\tu8\t\t\tresv_start_op;\n\tconst struct nla_policy *policy;\n\tint\t\t\t(*pre_doit)(const struct genl_split_ops *ops,\n\t\t\t\t\t    struct sk_buff *skb,\n\t\t\t\t\t    struct genl_info *info);\n\tvoid\t\t\t(*post_doit)(const struct genl_split_ops *ops,\n\t\t\t\t\t     struct sk_buff *skb,\n\t\t\t\t\t     struct genl_info *info);\n\tconst struct genl_ops *\tops;\n\tconst struct genl_small_ops *small_ops;\n\tconst struct genl_split_ops *split_ops;\n\tconst struct genl_multicast_group *mcgrps;\n\tstruct module\t\t*module;\n\n \n\t \n\tint\t\t\tid;\n\t \n\tunsigned int\t\tmcgrp_offset;\n};\n\n \nstruct genl_info {\n\tu32\t\t\tsnd_seq;\n\tu32\t\t\tsnd_portid;\n\tconst struct genl_family *family;\n\tconst struct nlmsghdr *\tnlhdr;\n\tstruct genlmsghdr *\tgenlhdr;\n\tstruct nlattr **\tattrs;\n\tpossible_net_t\t\t_net;\n\tvoid *\t\t\tuser_ptr[2];\n\tstruct netlink_ext_ack *extack;\n};\n\nstatic inline struct net *genl_info_net(const struct genl_info *info)\n{\n\treturn read_pnet(&info->_net);\n}\n\nstatic inline void genl_info_net_set(struct genl_info *info, struct net *net)\n{\n\twrite_pnet(&info->_net, net);\n}\n\nstatic inline void *genl_info_userhdr(const struct genl_info *info)\n{\n\treturn (u8 *)info->genlhdr + GENL_HDRLEN;\n}\n\n#define GENL_SET_ERR_MSG(info, msg) NL_SET_ERR_MSG((info)->extack, msg)\n\n#define GENL_SET_ERR_MSG_FMT(info, msg, args...) \\\n\tNL_SET_ERR_MSG_FMT((info)->extack, msg, ##args)\n\n \n#define GENL_REQ_ATTR_CHECK(info, attr) ({\t\t\t\t\\\n\tstruct genl_info *__info = (info);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tNL_REQ_ATTR_CHECK(__info->extack, NULL, __info->attrs, (attr)); \\\n})\n\nenum genl_validate_flags {\n\tGENL_DONT_VALIDATE_STRICT\t\t= BIT(0),\n\tGENL_DONT_VALIDATE_DUMP\t\t\t= BIT(1),\n\tGENL_DONT_VALIDATE_DUMP_STRICT\t\t= BIT(2),\n};\n\n \nstruct genl_small_ops {\n\tint\t(*doit)(struct sk_buff *skb, struct genl_info *info);\n\tint\t(*dumpit)(struct sk_buff *skb, struct netlink_callback *cb);\n\tu8\tcmd;\n\tu8\tinternal_flags;\n\tu8\tflags;\n\tu8\tvalidate;\n};\n\n \nstruct genl_ops {\n\tint\t\t       (*doit)(struct sk_buff *skb,\n\t\t\t\t       struct genl_info *info);\n\tint\t\t       (*start)(struct netlink_callback *cb);\n\tint\t\t       (*dumpit)(struct sk_buff *skb,\n\t\t\t\t\t struct netlink_callback *cb);\n\tint\t\t       (*done)(struct netlink_callback *cb);\n\tconst struct nla_policy *policy;\n\tunsigned int\t\tmaxattr;\n\tu8\t\t\tcmd;\n\tu8\t\t\tinternal_flags;\n\tu8\t\t\tflags;\n\tu8\t\t\tvalidate;\n};\n\n \nstruct genl_split_ops {\n\tunion {\n\t\tstruct {\n\t\t\tint (*pre_doit)(const struct genl_split_ops *ops,\n\t\t\t\t\tstruct sk_buff *skb,\n\t\t\t\t\tstruct genl_info *info);\n\t\t\tint (*doit)(struct sk_buff *skb,\n\t\t\t\t    struct genl_info *info);\n\t\t\tvoid (*post_doit)(const struct genl_split_ops *ops,\n\t\t\t\t\t  struct sk_buff *skb,\n\t\t\t\t\t  struct genl_info *info);\n\t\t};\n\t\tstruct {\n\t\t\tint (*start)(struct netlink_callback *cb);\n\t\t\tint (*dumpit)(struct sk_buff *skb,\n\t\t\t\t      struct netlink_callback *cb);\n\t\t\tint (*done)(struct netlink_callback *cb);\n\t\t};\n\t};\n\tconst struct nla_policy *policy;\n\tunsigned int\t\tmaxattr;\n\tu8\t\t\tcmd;\n\tu8\t\t\tinternal_flags;\n\tu8\t\t\tflags;\n\tu8\t\t\tvalidate;\n};\n\n \nstruct genl_dumpit_info {\n\tstruct genl_split_ops op;\n\tstruct genl_info info;\n};\n\nstatic inline const struct genl_dumpit_info *\ngenl_dumpit_info(struct netlink_callback *cb)\n{\n\treturn cb->data;\n}\n\nstatic inline const struct genl_info *\ngenl_info_dump(struct netlink_callback *cb)\n{\n\treturn &genl_dumpit_info(cb)->info;\n}\n\n \nstatic inline void\ngenl_info_init_ntf(struct genl_info *info, const struct genl_family *family,\n\t\t   u8 cmd)\n{\n\tstruct genlmsghdr *hdr = (void *) &info->user_ptr[0];\n\n\tmemset(info, 0, sizeof(*info));\n\tinfo->family = family;\n\tinfo->genlhdr = hdr;\n\thdr->cmd = cmd;\n}\n\nstatic inline bool genl_info_is_ntf(const struct genl_info *info)\n{\n\treturn !info->nlhdr;\n}\n\nint genl_register_family(struct genl_family *family);\nint genl_unregister_family(const struct genl_family *family);\nvoid genl_notify(const struct genl_family *family, struct sk_buff *skb,\n\t\t struct genl_info *info, u32 group, gfp_t flags);\n\nvoid *genlmsg_put(struct sk_buff *skb, u32 portid, u32 seq,\n\t\t  const struct genl_family *family, int flags, u8 cmd);\n\nstatic inline void *\n__genlmsg_iput(struct sk_buff *skb, const struct genl_info *info, int flags)\n{\n\treturn genlmsg_put(skb, info->snd_portid, info->snd_seq, info->family,\n\t\t\t   flags, info->genlhdr->cmd);\n}\n\n \nstatic inline void *\ngenlmsg_iput(struct sk_buff *skb, const struct genl_info *info)\n{\n\treturn __genlmsg_iput(skb, info, 0);\n}\n\n \nstatic inline struct nlmsghdr *genlmsg_nlhdr(void *user_hdr)\n{\n\treturn (struct nlmsghdr *)((char *)user_hdr -\n\t\t\t\t   GENL_HDRLEN -\n\t\t\t\t   NLMSG_HDRLEN);\n}\n\n \nstatic inline int genlmsg_parse_deprecated(const struct nlmsghdr *nlh,\n\t\t\t\t\t   const struct genl_family *family,\n\t\t\t\t\t   struct nlattr *tb[], int maxtype,\n\t\t\t\t\t   const struct nla_policy *policy,\n\t\t\t\t\t   struct netlink_ext_ack *extack)\n{\n\treturn __nlmsg_parse(nlh, family->hdrsize + GENL_HDRLEN, tb, maxtype,\n\t\t\t     policy, NL_VALIDATE_LIBERAL, extack);\n}\n\n \nstatic inline int genlmsg_parse(const struct nlmsghdr *nlh,\n\t\t\t\tconst struct genl_family *family,\n\t\t\t\tstruct nlattr *tb[], int maxtype,\n\t\t\t\tconst struct nla_policy *policy,\n\t\t\t\tstruct netlink_ext_ack *extack)\n{\n\treturn __nlmsg_parse(nlh, family->hdrsize + GENL_HDRLEN, tb, maxtype,\n\t\t\t     policy, NL_VALIDATE_STRICT, extack);\n}\n\n \nstatic inline void genl_dump_check_consistent(struct netlink_callback *cb,\n\t\t\t\t\t      void *user_hdr)\n{\n\tnl_dump_check_consistent(cb, genlmsg_nlhdr(user_hdr));\n}\n\n \nstatic inline void *genlmsg_put_reply(struct sk_buff *skb,\n\t\t\t\t      struct genl_info *info,\n\t\t\t\t      const struct genl_family *family,\n\t\t\t\t      int flags, u8 cmd)\n{\n\treturn genlmsg_put(skb, info->snd_portid, info->snd_seq, family,\n\t\t\t   flags, cmd);\n}\n\n \nstatic inline void genlmsg_end(struct sk_buff *skb, void *hdr)\n{\n\tnlmsg_end(skb, hdr - GENL_HDRLEN - NLMSG_HDRLEN);\n}\n\n \nstatic inline void genlmsg_cancel(struct sk_buff *skb, void *hdr)\n{\n\tif (hdr)\n\t\tnlmsg_cancel(skb, hdr - GENL_HDRLEN - NLMSG_HDRLEN);\n}\n\n \nstatic inline int genlmsg_multicast_netns(const struct genl_family *family,\n\t\t\t\t\t  struct net *net, struct sk_buff *skb,\n\t\t\t\t\t  u32 portid, unsigned int group, gfp_t flags)\n{\n\tif (WARN_ON_ONCE(group >= family->n_mcgrps))\n\t\treturn -EINVAL;\n\tgroup = family->mcgrp_offset + group;\n\treturn nlmsg_multicast(net->genl_sock, skb, portid, group, flags);\n}\n\n \nstatic inline int genlmsg_multicast(const struct genl_family *family,\n\t\t\t\t    struct sk_buff *skb, u32 portid,\n\t\t\t\t    unsigned int group, gfp_t flags)\n{\n\treturn genlmsg_multicast_netns(family, &init_net, skb,\n\t\t\t\t       portid, group, flags);\n}\n\n \nint genlmsg_multicast_allns(const struct genl_family *family,\n\t\t\t    struct sk_buff *skb, u32 portid,\n\t\t\t    unsigned int group, gfp_t flags);\n\n \nstatic inline int genlmsg_unicast(struct net *net, struct sk_buff *skb, u32 portid)\n{\n\treturn nlmsg_unicast(net->genl_sock, skb, portid);\n}\n\n \nstatic inline int genlmsg_reply(struct sk_buff *skb, struct genl_info *info)\n{\n\treturn genlmsg_unicast(genl_info_net(info), skb, info->snd_portid);\n}\n\n \nstatic inline void *genlmsg_data(const struct genlmsghdr *gnlh)\n{\n\treturn ((unsigned char *) gnlh + GENL_HDRLEN);\n}\n\n \nstatic inline int genlmsg_len(const struct genlmsghdr *gnlh)\n{\n\tstruct nlmsghdr *nlh = (struct nlmsghdr *)((unsigned char *)gnlh -\n\t\t\t\t\t\t\tNLMSG_HDRLEN);\n\treturn (nlh->nlmsg_len - GENL_HDRLEN - NLMSG_HDRLEN);\n}\n\n \nstatic inline int genlmsg_msg_size(int payload)\n{\n\treturn GENL_HDRLEN + payload;\n}\n\n \nstatic inline int genlmsg_total_size(int payload)\n{\n\treturn NLMSG_ALIGN(genlmsg_msg_size(payload));\n}\n\n \nstatic inline struct sk_buff *genlmsg_new(size_t payload, gfp_t flags)\n{\n\treturn nlmsg_new(genlmsg_total_size(payload), flags);\n}\n\n \nstatic inline int genl_set_err(const struct genl_family *family,\n\t\t\t       struct net *net, u32 portid,\n\t\t\t       u32 group, int code)\n{\n\tif (WARN_ON_ONCE(group >= family->n_mcgrps))\n\t\treturn -EINVAL;\n\tgroup = family->mcgrp_offset + group;\n\treturn netlink_set_err(net->genl_sock, portid, group, code);\n}\n\nstatic inline int genl_has_listeners(const struct genl_family *family,\n\t\t\t\t     struct net *net, unsigned int group)\n{\n\tif (WARN_ON_ONCE(group >= family->n_mcgrps))\n\t\treturn -EINVAL;\n\tgroup = family->mcgrp_offset + group;\n\treturn netlink_has_listeners(net->genl_sock, group);\n}\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}