{
  "module_name": "llc.h",
  "hash_id": "55c8f8a937efcb8b51dc3b8a986b11e1e77ed65edc77745b77ad13da86a58434",
  "original_prompt": "Ingested from linux-6.6.14/include/net/llc.h",
  "human_readable_source": "#ifndef LLC_H\n#define LLC_H\n \n\n#include <linux/if.h>\n#include <linux/if_ether.h>\n#include <linux/list.h>\n#include <linux/spinlock.h>\n#include <linux/rculist_nulls.h>\n#include <linux/hash.h>\n#include <linux/jhash.h>\n\n#include <linux/atomic.h>\n\nstruct net_device;\nstruct packet_type;\nstruct sk_buff;\n\nstruct llc_addr {\n\tunsigned char lsap;\n\tunsigned char mac[IFHWADDRLEN];\n};\n\n#define LLC_SAP_STATE_INACTIVE\t1\n#define LLC_SAP_STATE_ACTIVE\t2\n\n#define LLC_SK_DEV_HASH_BITS 6\n#define LLC_SK_DEV_HASH_ENTRIES (1<<LLC_SK_DEV_HASH_BITS)\n\n#define LLC_SK_LADDR_HASH_BITS 6\n#define LLC_SK_LADDR_HASH_ENTRIES (1<<LLC_SK_LADDR_HASH_BITS)\n\n \nstruct llc_sap {\n\tunsigned char\t state;\n\tunsigned char\t p_bit;\n\tunsigned char\t f_bit;\n\trefcount_t\t\t refcnt;\n\tint\t\t (*rcv_func)(struct sk_buff *skb,\n\t\t\t\t     struct net_device *dev,\n\t\t\t\t     struct packet_type *pt,\n\t\t\t\t     struct net_device *orig_dev);\n\tstruct llc_addr\t laddr;\n\tstruct list_head node;\n\tspinlock_t sk_lock;\n\tint sk_count;\n\tstruct hlist_nulls_head sk_laddr_hash[LLC_SK_LADDR_HASH_ENTRIES];\n\tstruct hlist_head sk_dev_hash[LLC_SK_DEV_HASH_ENTRIES];\n\tstruct rcu_head rcu;\n};\n\nstatic inline\nstruct hlist_head *llc_sk_dev_hash(struct llc_sap *sap, int ifindex)\n{\n\tu32 bucket = hash_32(ifindex, LLC_SK_DEV_HASH_BITS);\n\n\treturn &sap->sk_dev_hash[bucket];\n}\n\nstatic inline\nu32 llc_sk_laddr_hashfn(struct llc_sap *sap, const struct llc_addr *laddr)\n{\n\treturn hash_32(jhash(laddr->mac, sizeof(laddr->mac), 0),\n\t\t       LLC_SK_LADDR_HASH_BITS);\n}\n\nstatic inline\nstruct hlist_nulls_head *llc_sk_laddr_hash(struct llc_sap *sap,\n\t\t\t\t\t   const struct llc_addr *laddr)\n{\n\treturn &sap->sk_laddr_hash[llc_sk_laddr_hashfn(sap, laddr)];\n}\n\n#define LLC_DEST_INVALID         0       \n#define LLC_DEST_SAP             1       \n#define LLC_DEST_CONN            2       \n\nextern struct list_head llc_sap_list;\n\nint llc_rcv(struct sk_buff *skb, struct net_device *dev, struct packet_type *pt,\n\t    struct net_device *orig_dev);\n\nint llc_mac_hdr_init(struct sk_buff *skb, const unsigned char *sa,\n\t\t     const unsigned char *da);\n\nvoid llc_add_pack(int type,\n\t\t  void (*handler)(struct llc_sap *sap, struct sk_buff *skb));\nvoid llc_remove_pack(int type);\n\nvoid llc_set_station_handler(void (*handler)(struct sk_buff *skb));\n\nstruct llc_sap *llc_sap_open(unsigned char lsap,\n\t\t\t     int (*rcv)(struct sk_buff *skb,\n\t\t\t\t\tstruct net_device *dev,\n\t\t\t\t\tstruct packet_type *pt,\n\t\t\t\t\tstruct net_device *orig_dev));\nstatic inline void llc_sap_hold(struct llc_sap *sap)\n{\n\trefcount_inc(&sap->refcnt);\n}\n\nstatic inline bool llc_sap_hold_safe(struct llc_sap *sap)\n{\n\treturn refcount_inc_not_zero(&sap->refcnt);\n}\n\nvoid llc_sap_close(struct llc_sap *sap);\n\nstatic inline void llc_sap_put(struct llc_sap *sap)\n{\n\tif (refcount_dec_and_test(&sap->refcnt))\n\t\tllc_sap_close(sap);\n}\n\nstruct llc_sap *llc_sap_find(unsigned char sap_value);\n\nint llc_build_and_send_ui_pkt(struct llc_sap *sap, struct sk_buff *skb,\n\t\t\t      const unsigned char *dmac, unsigned char dsap);\n\nvoid llc_sap_handler(struct llc_sap *sap, struct sk_buff *skb);\nvoid llc_conn_handler(struct llc_sap *sap, struct sk_buff *skb);\n\nvoid llc_station_init(void);\nvoid llc_station_exit(void);\n\n#ifdef CONFIG_PROC_FS\nint llc_proc_init(void);\nvoid llc_proc_exit(void);\n#else\n#define llc_proc_init()\t(0)\n#define llc_proc_exit()\tdo { } while(0)\n#endif  \n#ifdef CONFIG_SYSCTL\nint llc_sysctl_init(void);\nvoid llc_sysctl_exit(void);\n\nextern int sysctl_llc2_ack_timeout;\nextern int sysctl_llc2_busy_timeout;\nextern int sysctl_llc2_p_timeout;\nextern int sysctl_llc2_rej_timeout;\n#else\n#define llc_sysctl_init() (0)\n#define llc_sysctl_exit() do { } while(0)\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}