{
  "module_name": "lapb.h",
  "hash_id": "3547cb9bedd9c41b473594d9899a5be9f0b4f9e4ee84018e504323fdb7db7284",
  "original_prompt": "Ingested from linux-6.6.14/include/net/lapb.h",
  "human_readable_source": " \n#ifndef _LAPB_H\n#define _LAPB_H \n#include <linux/lapb.h>\n#include <linux/refcount.h>\n\n#define\tLAPB_HEADER_LEN\t20\t\t \n\n#define\tLAPB_ACK_PENDING_CONDITION\t0x01\n#define\tLAPB_REJECT_CONDITION\t\t0x02\n#define\tLAPB_PEER_RX_BUSY_CONDITION\t0x04\n\n \n#define\tLAPB_I\t\t0x00\t \n#define\tLAPB_S\t\t0x01\t \n#define\tLAPB_U\t\t0x03\t \n\n#define\tLAPB_RR\t\t0x01\t \n#define\tLAPB_RNR\t0x05\t \n#define\tLAPB_REJ\t0x09\t \n\n#define\tLAPB_SABM\t0x2F\t \n#define\tLAPB_SABME\t0x6F\t \n#define\tLAPB_DISC\t0x43\t \n#define\tLAPB_DM\t\t0x0F\t \n#define\tLAPB_UA\t\t0x63\t \n#define\tLAPB_FRMR\t0x87\t \n\n#define LAPB_ILLEGAL\t0x100\t \n\n#define\tLAPB_SPF\t0x10\t \n#define\tLAPB_EPF\t0x01\t \n\n#define\tLAPB_FRMR_W\t0x01\t \n#define\tLAPB_FRMR_X\t0x02\t \n#define\tLAPB_FRMR_Y\t0x04\t \n#define\tLAPB_FRMR_Z\t0x08\t \n\n#define\tLAPB_POLLOFF\t0\n#define\tLAPB_POLLON\t1\n\n \n#define LAPB_COMMAND\t1\n#define LAPB_RESPONSE\t2\n\n#define\tLAPB_ADDR_A\t0x03\n#define\tLAPB_ADDR_B\t0x01\n#define\tLAPB_ADDR_C\t0x0F\n#define\tLAPB_ADDR_D\t0x07\n\n \nenum {\n\tLAPB_STATE_0,\t \n\tLAPB_STATE_1,\t \n\tLAPB_STATE_2,\t \n\tLAPB_STATE_3,\t \n\tLAPB_STATE_4\t \n};\n\n#define\tLAPB_DEFAULT_MODE\t\t(LAPB_STANDARD | LAPB_SLP | LAPB_DTE)\n#define\tLAPB_DEFAULT_WINDOW\t\t7\t\t \n#define\tLAPB_DEFAULT_T1\t\t\t(5 * HZ)\t \n#define\tLAPB_DEFAULT_T2\t\t\t(1 * HZ)\t \n#define\tLAPB_DEFAULT_N2\t\t\t20\t\t \n\n#define\tLAPB_SMODULUS\t8\n#define\tLAPB_EMODULUS\t128\n\n \nstruct lapb_frame {\n\tunsigned short\t\ttype;\t\t \n\tunsigned short\t\tnr, ns;\t\t \n\tunsigned char\t\tcr;\t\t \n\tunsigned char\t\tpf;\t\t \n\tunsigned char\t\tcontrol[2];\t \n};\n\n \nstruct lapb_cb {\n\tstruct list_head\tnode;\n\tstruct net_device\t*dev;\n\n\t \n\tunsigned int\t\tmode;\n\tunsigned char\t\tstate;\n\tunsigned short\t\tvs, vr, va;\n\tunsigned char\t\tcondition;\n\tunsigned short\t\tn2, n2count;\n\tunsigned short\t\tt1, t2;\n\tstruct timer_list\tt1timer, t2timer;\n\tbool\t\t\tt1timer_running, t2timer_running;\n\n\t \n\tstruct sk_buff_head\twrite_queue;\n\tstruct sk_buff_head\tack_queue;\n\tunsigned char\t\twindow;\n\tconst struct lapb_register_struct *callbacks;\n\n\t \n\tstruct lapb_frame\tfrmr_data;\n\tunsigned char\t\tfrmr_type;\n\n\tspinlock_t\t\tlock;\n\trefcount_t\t\trefcnt;\n};\n\n \nvoid lapb_connect_confirmation(struct lapb_cb *lapb, int);\nvoid lapb_connect_indication(struct lapb_cb *lapb, int);\nvoid lapb_disconnect_confirmation(struct lapb_cb *lapb, int);\nvoid lapb_disconnect_indication(struct lapb_cb *lapb, int);\nint lapb_data_indication(struct lapb_cb *lapb, struct sk_buff *);\nint lapb_data_transmit(struct lapb_cb *lapb, struct sk_buff *);\n\n \nvoid lapb_data_input(struct lapb_cb *lapb, struct sk_buff *);\n\n \nvoid lapb_kick(struct lapb_cb *lapb);\nvoid lapb_transmit_buffer(struct lapb_cb *lapb, struct sk_buff *, int);\nvoid lapb_establish_data_link(struct lapb_cb *lapb);\nvoid lapb_enquiry_response(struct lapb_cb *lapb);\nvoid lapb_timeout_response(struct lapb_cb *lapb);\nvoid lapb_check_iframes_acked(struct lapb_cb *lapb, unsigned short);\nvoid lapb_check_need_response(struct lapb_cb *lapb, int, int);\n\n \nvoid lapb_clear_queues(struct lapb_cb *lapb);\nvoid lapb_frames_acked(struct lapb_cb *lapb, unsigned short);\nvoid lapb_requeue_frames(struct lapb_cb *lapb);\nint lapb_validate_nr(struct lapb_cb *lapb, unsigned short);\nint lapb_decode(struct lapb_cb *lapb, struct sk_buff *, struct lapb_frame *);\nvoid lapb_send_control(struct lapb_cb *lapb, int, int, int);\nvoid lapb_transmit_frmr(struct lapb_cb *lapb);\n\n \nvoid lapb_start_t1timer(struct lapb_cb *lapb);\nvoid lapb_start_t2timer(struct lapb_cb *lapb);\nvoid lapb_stop_t1timer(struct lapb_cb *lapb);\nvoid lapb_stop_t2timer(struct lapb_cb *lapb);\nint lapb_t1timer_running(struct lapb_cb *lapb);\n\n \n#define\tLAPB_DEBUG\t0\n\n#define lapb_dbg(level, fmt, ...)\t\t\t\\\ndo {\t\t\t\t\t\t\t\\\n\tif (level < LAPB_DEBUG)\t\t\t\t\\\n\t\tpr_debug(fmt, ##__VA_ARGS__);\t\t\\\n} while (0)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}