{
  "module_name": "x25.h",
  "hash_id": "5ab32fa5bcde35b50d0bfab81e541f72ca01b3af6fc525447f798f623c0dc7f0",
  "original_prompt": "Ingested from linux-6.6.14/include/net/x25.h",
  "human_readable_source": " \n \n\n#ifndef _X25_H\n#define _X25_H \n#include <linux/x25.h>\n#include <linux/slab.h>\n#include <linux/refcount.h>\n#include <net/sock.h>\n\n#define\tX25_ADDR_LEN\t\t\t16\n\n#define\tX25_MAX_L2_LEN\t\t\t18\t \n\n#define\tX25_STD_MIN_LEN\t\t\t3\n#define\tX25_EXT_MIN_LEN\t\t\t4\n\n#define\tX25_GFI_SEQ_MASK\t\t0x30\n#define\tX25_GFI_STDSEQ\t\t\t0x10\n#define\tX25_GFI_EXTSEQ\t\t\t0x20\n\n#define\tX25_Q_BIT\t\t\t0x80\n#define\tX25_D_BIT\t\t\t0x40\n#define\tX25_STD_M_BIT\t\t\t0x10\n#define\tX25_EXT_M_BIT\t\t\t0x01\n\n#define\tX25_CALL_REQUEST\t\t0x0B\n#define\tX25_CALL_ACCEPTED\t\t0x0F\n#define\tX25_CLEAR_REQUEST\t\t0x13\n#define\tX25_CLEAR_CONFIRMATION\t\t0x17\n#define\tX25_DATA\t\t\t0x00\n#define\tX25_INTERRUPT\t\t\t0x23\n#define\tX25_INTERRUPT_CONFIRMATION\t0x27\n#define\tX25_RR\t\t\t\t0x01\n#define\tX25_RNR\t\t\t\t0x05\n#define\tX25_REJ\t\t\t\t0x09\n#define\tX25_RESET_REQUEST\t\t0x1B\n#define\tX25_RESET_CONFIRMATION\t\t0x1F\n#define\tX25_REGISTRATION_REQUEST\t0xF3\n#define\tX25_REGISTRATION_CONFIRMATION\t0xF7\n#define\tX25_RESTART_REQUEST\t\t0xFB\n#define\tX25_RESTART_CONFIRMATION\t0xFF\n#define\tX25_DIAGNOSTIC\t\t\t0xF1\n#define\tX25_ILLEGAL\t\t\t0xFD\n\n \n\n#define\tX25_COND_ACK_PENDING\t0x01\n#define\tX25_COND_OWN_RX_BUSY\t0x02\n#define\tX25_COND_PEER_RX_BUSY\t0x04\n\n \nenum {\n\tX25_STATE_0,\t\t \n\tX25_STATE_1,\t\t \n\tX25_STATE_2,\t\t \n\tX25_STATE_3,\t\t \n\tX25_STATE_4,\t\t \n\tX25_STATE_5\t\t \n};\n\nenum {\n\tX25_LINK_STATE_0,\n\tX25_LINK_STATE_1,\n\tX25_LINK_STATE_2,\n\tX25_LINK_STATE_3\n};\n\n#define X25_DEFAULT_T20\t\t(180 * HZ)\t\t \n#define X25_DEFAULT_T21\t\t(200 * HZ)\t\t \n#define X25_DEFAULT_T22\t\t(180 * HZ)\t\t \n#define\tX25_DEFAULT_T23\t\t(180 * HZ)\t\t \n#define\tX25_DEFAULT_T2\t\t(3   * HZ)\t\t \n\n#define\tX25_DEFAULT_WINDOW_SIZE\t2\t\t\t \n#define\tX25_DEFAULT_PACKET_SIZE\tX25_PS128\t\t \n#define\tX25_DEFAULT_THROUGHPUT\t0x0A\t\t\t \n#define\tX25_DEFAULT_REVERSE\t0x00\t\t\t \n\n#define X25_SMODULUS \t\t8\n#define\tX25_EMODULUS\t\t128\n\n \n\n#define\tX25_FAC_CLASS_MASK\t0xC0\n\n#define\tX25_FAC_CLASS_A\t\t0x00\n#define\tX25_FAC_CLASS_B\t\t0x40\n#define\tX25_FAC_CLASS_C\t\t0x80\n#define\tX25_FAC_CLASS_D\t\t0xC0\n\n#define\tX25_FAC_REVERSE\t\t0x01\t\t\t \n#define\tX25_FAC_THROUGHPUT\t0x02\n#define\tX25_FAC_PACKET_SIZE\t0x42\n#define\tX25_FAC_WINDOW_SIZE\t0x43\n\n#define X25_MAX_FAC_LEN \t60\n#define\tX25_MAX_CUD_LEN\t\t128\n\n#define X25_FAC_CALLING_AE \t0xCB\n#define X25_FAC_CALLED_AE \t0xC9\n\n#define X25_MARKER \t\t0x00\n#define X25_DTE_SERVICES \t0x0F\n#define X25_MAX_AE_LEN \t\t40\t\t\t \n#define X25_MAX_DTE_FACIL_LEN\t21\t\t\t \n\n \n#define X25_Q_BIT_FLAG\t\t0\n#define X25_INTERRUPT_FLAG\t1\n#define X25_ACCPT_APPRV_FLAG\t2\n\n \nstruct x25_route {\n\tstruct list_head\tnode;\t\t\n\tstruct x25_address\taddress;\n\tunsigned int\t\tsigdigits;\n\tstruct net_device\t*dev;\n\trefcount_t\t\trefcnt;\n};\n\nstruct x25_neigh {\n\tstruct list_head\tnode;\n\tstruct net_device\t*dev;\n\tunsigned int\t\tstate;\n\tunsigned int\t\textended;\n\tstruct sk_buff_head\tqueue;\n\tunsigned long\t\tt20;\n\tstruct timer_list\tt20timer;\n\tunsigned long\t\tglobal_facil_mask;\n\trefcount_t\t\trefcnt;\n};\n\nstruct x25_sock {\n\tstruct sock\t\tsk;\n\tstruct x25_address\tsource_addr, dest_addr;\n\tstruct x25_neigh\t*neighbour;\n\tunsigned int\t\tlci, cudmatchlength;\n\tunsigned char\t\tstate, condition;\n\tunsigned short\t\tvs, vr, va, vl;\n\tunsigned long\t\tt2, t21, t22, t23;\n\tunsigned short\t\tfraglen;\n\tunsigned long\t\tflags;\n\tstruct sk_buff_head\tack_queue;\n\tstruct sk_buff_head\tfragment_queue;\n\tstruct sk_buff_head\tinterrupt_in_queue;\n\tstruct sk_buff_head\tinterrupt_out_queue;\n\tstruct timer_list\ttimer;\n\tstruct x25_causediag\tcausediag;\n\tstruct x25_facilities\tfacilities;\n\tstruct x25_dte_facilities dte_facilities;\n\tstruct x25_calluserdata\tcalluserdata;\n\tunsigned long \t\tvc_facil_mask;\t \n};\n\nstruct x25_forward {\n\tstruct list_head\tnode;\n\tunsigned int\t\tlci;\n\tstruct net_device\t*dev1;\n\tstruct net_device\t*dev2;\n\tatomic_t\t\trefcnt;\n};\n\n#define x25_sk(ptr) container_of_const(ptr, struct x25_sock, sk)\n\n \nextern int  sysctl_x25_restart_request_timeout;\nextern int  sysctl_x25_call_request_timeout;\nextern int  sysctl_x25_reset_request_timeout;\nextern int  sysctl_x25_clear_request_timeout;\nextern int  sysctl_x25_ack_holdback_timeout;\nextern int  sysctl_x25_forward;\n\nint x25_parse_address_block(struct sk_buff *skb,\n\t\t\t    struct x25_address *called_addr,\n\t\t\t    struct x25_address *calling_addr);\n\nint x25_addr_ntoa(unsigned char *, struct x25_address *, struct x25_address *);\nint x25_addr_aton(unsigned char *, struct x25_address *, struct x25_address *);\nstruct sock *x25_find_socket(unsigned int, struct x25_neigh *);\nvoid x25_destroy_socket_from_timer(struct sock *);\nint x25_rx_call_request(struct sk_buff *, struct x25_neigh *, unsigned int);\nvoid x25_kill_by_neigh(struct x25_neigh *);\n\n \nvoid x25_send_frame(struct sk_buff *, struct x25_neigh *);\nint x25_lapb_receive_frame(struct sk_buff *, struct net_device *,\n\t\t\t   struct packet_type *, struct net_device *);\nvoid x25_establish_link(struct x25_neigh *);\nvoid x25_terminate_link(struct x25_neigh *);\n\n \nint x25_parse_facilities(struct sk_buff *, struct x25_facilities *,\n\t\t\t struct x25_dte_facilities *, unsigned long *);\nint x25_create_facilities(unsigned char *, struct x25_facilities *,\n\t\t\t  struct x25_dte_facilities *, unsigned long);\nint x25_negotiate_facilities(struct sk_buff *, struct sock *,\n\t\t\t     struct x25_facilities *,\n\t\t\t     struct x25_dte_facilities *);\nvoid x25_limit_facilities(struct x25_facilities *, struct x25_neigh *);\n\n \nvoid x25_clear_forward_by_lci(unsigned int lci);\nvoid x25_clear_forward_by_dev(struct net_device *);\nint x25_forward_data(int, struct x25_neigh *, struct sk_buff *);\nint x25_forward_call(struct x25_address *, struct x25_neigh *, struct sk_buff *,\n\t\t     int);\n\n \nint x25_process_rx_frame(struct sock *, struct sk_buff *);\nint x25_backlog_rcv(struct sock *, struct sk_buff *);\n\n \nvoid x25_link_control(struct sk_buff *, struct x25_neigh *, unsigned short);\nvoid x25_link_device_up(struct net_device *);\nvoid x25_link_device_down(struct net_device *);\nvoid x25_link_established(struct x25_neigh *);\nvoid x25_link_terminated(struct x25_neigh *);\nvoid x25_transmit_clear_request(struct x25_neigh *, unsigned int,\n\t\t\t\tunsigned char);\nvoid x25_transmit_link(struct sk_buff *, struct x25_neigh *);\nint x25_subscr_ioctl(unsigned int, void __user *);\nstruct x25_neigh *x25_get_neigh(struct net_device *);\nvoid x25_link_free(void);\n\n \nstatic __inline__ void x25_neigh_hold(struct x25_neigh *nb)\n{\n\trefcount_inc(&nb->refcnt);\n}\n\nstatic __inline__ void x25_neigh_put(struct x25_neigh *nb)\n{\n\tif (refcount_dec_and_test(&nb->refcnt))\n\t\tkfree(nb);\n}\n\n \nint x25_output(struct sock *, struct sk_buff *);\nvoid x25_kick(struct sock *);\nvoid x25_enquiry_response(struct sock *);\n\n \nstruct x25_route *x25_get_route(struct x25_address *addr);\nstruct net_device *x25_dev_get(char *);\nvoid x25_route_device_down(struct net_device *dev);\nint x25_route_ioctl(unsigned int, void __user *);\nvoid x25_route_free(void);\n\nstatic __inline__ void x25_route_hold(struct x25_route *rt)\n{\n\trefcount_inc(&rt->refcnt);\n}\n\nstatic __inline__ void x25_route_put(struct x25_route *rt)\n{\n\tif (refcount_dec_and_test(&rt->refcnt))\n\t\tkfree(rt);\n}\n\n \nvoid x25_clear_queues(struct sock *);\nvoid x25_frames_acked(struct sock *, unsigned short);\nvoid x25_requeue_frames(struct sock *);\nint x25_validate_nr(struct sock *, unsigned short);\nvoid x25_write_internal(struct sock *, int);\nint x25_decode(struct sock *, struct sk_buff *, int *, int *, int *, int *,\n\t       int *);\nvoid x25_disconnect(struct sock *, int, unsigned char, unsigned char);\n\n \nvoid x25_init_timers(struct sock *sk);\nvoid x25_start_heartbeat(struct sock *);\nvoid x25_start_t2timer(struct sock *);\nvoid x25_start_t21timer(struct sock *);\nvoid x25_start_t22timer(struct sock *);\nvoid x25_start_t23timer(struct sock *);\nvoid x25_stop_heartbeat(struct sock *);\nvoid x25_stop_timer(struct sock *);\nunsigned long x25_display_timer(struct sock *);\nvoid x25_check_rbuf(struct sock *);\n\n \n#ifdef CONFIG_SYSCTL\nint x25_register_sysctl(void);\nvoid x25_unregister_sysctl(void);\n#else\nstatic inline int x25_register_sysctl(void) { return 0; };\nstatic inline void x25_unregister_sysctl(void) {};\n#endif  \n\nstruct x25_skb_cb {\n\tunsigned int flags;\n};\n#define X25_SKB_CB(s) ((struct x25_skb_cb *) ((s)->cb))\n\nextern struct hlist_head x25_list;\nextern rwlock_t x25_list_lock;\nextern struct list_head x25_route_list;\nextern rwlock_t x25_route_list_lock;\nextern struct list_head x25_forward_list;\nextern rwlock_t x25_forward_list_lock;\nextern struct list_head x25_neigh_list;\nextern rwlock_t x25_neigh_list_lock;\n\nint x25_proc_init(void);\nvoid x25_proc_exit(void);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}