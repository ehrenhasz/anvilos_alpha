{
  "module_name": "tc_tunnel_key.h",
  "hash_id": "afd2b4357a2eee77922610996bed7aa83253579dc1e1f158759351c1efba7fdd",
  "original_prompt": "Ingested from linux-6.6.14/include/net/tc_act/tc_tunnel_key.h",
  "human_readable_source": " \n \n\n#ifndef __NET_TC_TUNNEL_KEY_H\n#define __NET_TC_TUNNEL_KEY_H\n\n#include <net/act_api.h>\n#include <linux/tc_act/tc_tunnel_key.h>\n#include <net/dst_metadata.h>\n\nstruct tcf_tunnel_key_params {\n\tstruct rcu_head\t\trcu;\n\tint\t\t\ttcft_action;\n\tstruct metadata_dst     *tcft_enc_metadata;\n};\n\nstruct tcf_tunnel_key {\n\tstruct tc_action\t      common;\n\tstruct tcf_tunnel_key_params __rcu *params;\n};\n\n#define to_tunnel_key(a) ((struct tcf_tunnel_key *)a)\n\nstatic inline bool is_tcf_tunnel_set(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tstruct tcf_tunnel_key *t = to_tunnel_key(a);\n\tstruct tcf_tunnel_key_params *params;\n\n\tparams = rcu_dereference_protected(t->params,\n\t\t\t\t\t   lockdep_is_held(&a->tcfa_lock));\n\tif (a->ops && a->ops->id == TCA_ID_TUNNEL_KEY)\n\t\treturn params->tcft_action == TCA_TUNNEL_KEY_ACT_SET;\n#endif\n\treturn false;\n}\n\nstatic inline bool is_tcf_tunnel_release(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tstruct tcf_tunnel_key *t = to_tunnel_key(a);\n\tstruct tcf_tunnel_key_params *params;\n\n\tparams = rcu_dereference_protected(t->params,\n\t\t\t\t\t   lockdep_is_held(&a->tcfa_lock));\n\tif (a->ops && a->ops->id == TCA_ID_TUNNEL_KEY)\n\t\treturn params->tcft_action == TCA_TUNNEL_KEY_ACT_RELEASE;\n#endif\n\treturn false;\n}\n\nstatic inline struct ip_tunnel_info *tcf_tunnel_info(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tstruct tcf_tunnel_key *t = to_tunnel_key(a);\n\tstruct tcf_tunnel_key_params *params;\n\n\tparams = rcu_dereference_protected(t->params,\n\t\t\t\t\t   lockdep_is_held(&a->tcfa_lock));\n\n\treturn &params->tcft_enc_metadata->u.tun_info;\n#else\n\treturn NULL;\n#endif\n}\n\nstatic inline struct ip_tunnel_info *\ntcf_tunnel_info_copy(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tstruct ip_tunnel_info *tun = tcf_tunnel_info(a);\n\n\tif (tun) {\n\t\tsize_t tun_size = sizeof(*tun) + tun->options_len;\n\t\tstruct ip_tunnel_info *tun_copy = kmemdup(tun, tun_size,\n\t\t\t\t\t\t\t  GFP_ATOMIC);\n\n\t\treturn tun_copy;\n\t}\n#endif\n\treturn NULL;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}