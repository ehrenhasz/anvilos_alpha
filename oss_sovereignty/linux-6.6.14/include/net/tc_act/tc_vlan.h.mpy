{
  "module_name": "tc_vlan.h",
  "hash_id": "87ee1e60ab9e64405e7b0d15cbc2ab6019248691290da22336c13bb6104b876b",
  "original_prompt": "Ingested from linux-6.6.14/include/net/tc_act/tc_vlan.h",
  "human_readable_source": " \n \n\n#ifndef __NET_TC_VLAN_H\n#define __NET_TC_VLAN_H\n\n#include <net/act_api.h>\n#include <linux/tc_act/tc_vlan.h>\n\nstruct tcf_vlan_params {\n\tint               tcfv_action;\n\tunsigned char     tcfv_push_dst[ETH_ALEN];\n\tunsigned char     tcfv_push_src[ETH_ALEN];\n\tu16               tcfv_push_vid;\n\t__be16            tcfv_push_proto;\n\tu8                tcfv_push_prio;\n\tbool              tcfv_push_prio_exists;\n\tstruct rcu_head   rcu;\n};\n\nstruct tcf_vlan {\n\tstruct tc_action\tcommon;\n\tstruct tcf_vlan_params __rcu *vlan_p;\n};\n#define to_vlan(a) ((struct tcf_vlan *)a)\n\nstatic inline bool is_tcf_vlan(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tif (a->ops && a->ops->id == TCA_ID_VLAN)\n\t\treturn true;\n#endif\n\treturn false;\n}\n\nstatic inline u32 tcf_vlan_action(const struct tc_action *a)\n{\n\tu32 tcfv_action;\n\n\trcu_read_lock();\n\ttcfv_action = rcu_dereference(to_vlan(a)->vlan_p)->tcfv_action;\n\trcu_read_unlock();\n\n\treturn tcfv_action;\n}\n\nstatic inline u16 tcf_vlan_push_vid(const struct tc_action *a)\n{\n\tu16 tcfv_push_vid;\n\n\trcu_read_lock();\n\ttcfv_push_vid = rcu_dereference(to_vlan(a)->vlan_p)->tcfv_push_vid;\n\trcu_read_unlock();\n\n\treturn tcfv_push_vid;\n}\n\nstatic inline __be16 tcf_vlan_push_proto(const struct tc_action *a)\n{\n\t__be16 tcfv_push_proto;\n\n\trcu_read_lock();\n\ttcfv_push_proto = rcu_dereference(to_vlan(a)->vlan_p)->tcfv_push_proto;\n\trcu_read_unlock();\n\n\treturn tcfv_push_proto;\n}\n\nstatic inline u8 tcf_vlan_push_prio(const struct tc_action *a)\n{\n\tu8 tcfv_push_prio;\n\n\trcu_read_lock();\n\ttcfv_push_prio = rcu_dereference(to_vlan(a)->vlan_p)->tcfv_push_prio;\n\trcu_read_unlock();\n\n\treturn tcfv_push_prio;\n}\n\nstatic inline void tcf_vlan_push_eth(unsigned char *src, unsigned char *dest,\n\t\t\t\t     const struct tc_action *a)\n{\n\trcu_read_lock();\n\tmemcpy(dest, rcu_dereference(to_vlan(a)->vlan_p)->tcfv_push_dst, ETH_ALEN);\n\tmemcpy(src, rcu_dereference(to_vlan(a)->vlan_p)->tcfv_push_src, ETH_ALEN);\n\trcu_read_unlock();\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}