{
  "module_name": "tc_pedit.h",
  "hash_id": "71bc06843496a79346bc25af5d1f70611bf6f36ff3a4c34d9880e90690034210",
  "original_prompt": "Ingested from linux-6.6.14/include/net/tc_act/tc_pedit.h",
  "human_readable_source": " \n#ifndef __NET_TC_PED_H\n#define __NET_TC_PED_H\n\n#include <net/act_api.h>\n#include <linux/tc_act/tc_pedit.h>\n#include <linux/types.h>\n\nstruct tcf_pedit_key_ex {\n\tenum pedit_header_type htype;\n\tenum pedit_cmd cmd;\n};\n\nstruct tcf_pedit_parms {\n\tstruct tc_pedit_key\t*tcfp_keys;\n\tstruct tcf_pedit_key_ex\t*tcfp_keys_ex;\n\tu32 tcfp_off_max_hint;\n\tunsigned char tcfp_nkeys;\n\tunsigned char tcfp_flags;\n\tstruct rcu_head rcu;\n};\n\nstruct tcf_pedit {\n\tstruct tc_action common;\n\tstruct tcf_pedit_parms __rcu *parms;\n};\n\n#define to_pedit(a) ((struct tcf_pedit *)a)\n#define to_pedit_parms(a) (rcu_dereference(to_pedit(a)->parms))\n\nstatic inline bool is_tcf_pedit(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tif (a->ops && a->ops->id == TCA_ID_PEDIT)\n\t\treturn true;\n#endif\n\treturn false;\n}\n\nstatic inline int tcf_pedit_nkeys(const struct tc_action *a)\n{\n\tstruct tcf_pedit_parms *parms;\n\tint nkeys;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\tnkeys = parms->tcfp_nkeys;\n\trcu_read_unlock();\n\n\treturn nkeys;\n}\n\nstatic inline u32 tcf_pedit_htype(const struct tc_action *a, int index)\n{\n\tu32 htype = TCA_PEDIT_KEY_EX_HDR_TYPE_NETWORK;\n\tstruct tcf_pedit_parms *parms;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\tif (parms->tcfp_keys_ex)\n\t\thtype = parms->tcfp_keys_ex[index].htype;\n\trcu_read_unlock();\n\n\treturn htype;\n}\n\nstatic inline u32 tcf_pedit_cmd(const struct tc_action *a, int index)\n{\n\tstruct tcf_pedit_parms *parms;\n\tu32 cmd = __PEDIT_CMD_MAX;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\tif (parms->tcfp_keys_ex)\n\t\tcmd = parms->tcfp_keys_ex[index].cmd;\n\trcu_read_unlock();\n\n\treturn cmd;\n}\n\nstatic inline u32 tcf_pedit_mask(const struct tc_action *a, int index)\n{\n\tstruct tcf_pedit_parms *parms;\n\tu32 mask;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\tmask = parms->tcfp_keys[index].mask;\n\trcu_read_unlock();\n\n\treturn mask;\n}\n\nstatic inline u32 tcf_pedit_val(const struct tc_action *a, int index)\n{\n\tstruct tcf_pedit_parms *parms;\n\tu32 val;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\tval = parms->tcfp_keys[index].val;\n\trcu_read_unlock();\n\n\treturn val;\n}\n\nstatic inline u32 tcf_pedit_offset(const struct tc_action *a, int index)\n{\n\tstruct tcf_pedit_parms *parms;\n\tu32 off;\n\n\trcu_read_lock();\n\tparms = to_pedit_parms(a);\n\toff = parms->tcfp_keys[index].off;\n\trcu_read_unlock();\n\n\treturn off;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}