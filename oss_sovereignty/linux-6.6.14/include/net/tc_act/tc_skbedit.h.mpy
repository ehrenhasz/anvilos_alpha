{
  "module_name": "tc_skbedit.h",
  "hash_id": "afc5fe979bd9474c71dbe63be1522defe5c34f8a03398680da7fe23d043c6dfe",
  "original_prompt": "Ingested from linux-6.6.14/include/net/tc_act/tc_skbedit.h",
  "human_readable_source": " \n \n\n#ifndef __NET_TC_SKBEDIT_H\n#define __NET_TC_SKBEDIT_H\n\n#include <net/act_api.h>\n#include <linux/tc_act/tc_skbedit.h>\n\nstruct tcf_skbedit_params {\n\tu32 flags;\n\tu32 priority;\n\tu32 mark;\n\tu32 mask;\n\tu16 queue_mapping;\n\tu16 mapping_mod;\n\tu16 ptype;\n\tstruct rcu_head rcu;\n};\n\nstruct tcf_skbedit {\n\tstruct tc_action common;\n\tstruct tcf_skbedit_params __rcu *params;\n};\n#define to_skbedit(a) ((struct tcf_skbedit *)a)\n\n \nstatic inline bool is_tcf_skbedit_with_flag(const struct tc_action *a, u32 flag)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tu32 flags;\n\n\tif (a->ops && a->ops->id == TCA_ID_SKBEDIT) {\n\t\trcu_read_lock();\n\t\tflags = rcu_dereference(to_skbedit(a)->params)->flags;\n\t\trcu_read_unlock();\n\t\treturn flags == flag;\n\t}\n#endif\n\treturn false;\n}\n\n \nstatic inline bool is_tcf_skbedit_mark(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_with_flag(a, SKBEDIT_F_MARK);\n}\n\nstatic inline u32 tcf_skbedit_mark(const struct tc_action *a)\n{\n\tu32 mark;\n\n\trcu_read_lock();\n\tmark = rcu_dereference(to_skbedit(a)->params)->mark;\n\trcu_read_unlock();\n\n\treturn mark;\n}\n\n \nstatic inline bool is_tcf_skbedit_ptype(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_with_flag(a, SKBEDIT_F_PTYPE);\n}\n\nstatic inline u32 tcf_skbedit_ptype(const struct tc_action *a)\n{\n\tu16 ptype;\n\n\trcu_read_lock();\n\tptype = rcu_dereference(to_skbedit(a)->params)->ptype;\n\trcu_read_unlock();\n\n\treturn ptype;\n}\n\n \nstatic inline bool is_tcf_skbedit_priority(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_with_flag(a, SKBEDIT_F_PRIORITY);\n}\n\nstatic inline u32 tcf_skbedit_priority(const struct tc_action *a)\n{\n\tu32 priority;\n\n\trcu_read_lock();\n\tpriority = rcu_dereference(to_skbedit(a)->params)->priority;\n\trcu_read_unlock();\n\n\treturn priority;\n}\n\nstatic inline u16 tcf_skbedit_rx_queue_mapping(const struct tc_action *a)\n{\n\tu16 rx_queue;\n\n\trcu_read_lock();\n\trx_queue = rcu_dereference(to_skbedit(a)->params)->queue_mapping;\n\trcu_read_unlock();\n\n\treturn rx_queue;\n}\n\n \nstatic inline bool is_tcf_skbedit_queue_mapping(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_with_flag(a, SKBEDIT_F_QUEUE_MAPPING);\n}\n\n \nstatic inline bool is_tcf_skbedit_ingress(u32 flags)\n{\n\treturn flags & TCA_ACT_FLAGS_AT_INGRESS;\n}\n\nstatic inline bool is_tcf_skbedit_tx_queue_mapping(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_queue_mapping(a) &&\n\t       !is_tcf_skbedit_ingress(a->tcfa_flags);\n}\n\nstatic inline bool is_tcf_skbedit_rx_queue_mapping(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_queue_mapping(a) &&\n\t       is_tcf_skbedit_ingress(a->tcfa_flags);\n}\n\n \nstatic inline bool is_tcf_skbedit_inheritdsfield(const struct tc_action *a)\n{\n\treturn is_tcf_skbedit_with_flag(a, SKBEDIT_F_INHERITDSFIELD);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}