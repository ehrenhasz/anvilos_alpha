{
  "module_name": "tc_mpls.h",
  "hash_id": "07362f4304881eb1a0b3bab2e2cf5422ff34f73f037740dc9d66b8d9993a3a0b",
  "original_prompt": "Ingested from linux-6.6.14/include/net/tc_act/tc_mpls.h",
  "human_readable_source": " \n \n\n#ifndef __NET_TC_MPLS_H\n#define __NET_TC_MPLS_H\n\n#include <linux/tc_act/tc_mpls.h>\n#include <net/act_api.h>\n\nstruct tcf_mpls_params {\n\tint tcfm_action;\n\tu32 tcfm_label;\n\tu8 tcfm_tc;\n\tu8 tcfm_ttl;\n\tu8 tcfm_bos;\n\t__be16 tcfm_proto;\n\tstruct rcu_head\trcu;\n};\n\n#define ACT_MPLS_TC_NOT_SET\t0xff\n#define ACT_MPLS_BOS_NOT_SET\t0xff\n#define ACT_MPLS_LABEL_NOT_SET\t0xffffffff\n\nstruct tcf_mpls {\n\tstruct tc_action common;\n\tstruct tcf_mpls_params __rcu *mpls_p;\n};\n#define to_mpls(a) ((struct tcf_mpls *)a)\n\nstatic inline bool is_tcf_mpls(const struct tc_action *a)\n{\n#ifdef CONFIG_NET_CLS_ACT\n\tif (a->ops && a->ops->id == TCA_ID_MPLS)\n\t\treturn true;\n#endif\n\treturn false;\n}\n\nstatic inline u32 tcf_mpls_action(const struct tc_action *a)\n{\n\tu32 tcfm_action;\n\n\trcu_read_lock();\n\ttcfm_action = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_action;\n\trcu_read_unlock();\n\n\treturn tcfm_action;\n}\n\nstatic inline __be16 tcf_mpls_proto(const struct tc_action *a)\n{\n\t__be16 tcfm_proto;\n\n\trcu_read_lock();\n\ttcfm_proto = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_proto;\n\trcu_read_unlock();\n\n\treturn tcfm_proto;\n}\n\nstatic inline u32 tcf_mpls_label(const struct tc_action *a)\n{\n\tu32 tcfm_label;\n\n\trcu_read_lock();\n\ttcfm_label = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_label;\n\trcu_read_unlock();\n\n\treturn tcfm_label;\n}\n\nstatic inline u8 tcf_mpls_tc(const struct tc_action *a)\n{\n\tu8 tcfm_tc;\n\n\trcu_read_lock();\n\ttcfm_tc = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_tc;\n\trcu_read_unlock();\n\n\treturn tcfm_tc;\n}\n\nstatic inline u8 tcf_mpls_bos(const struct tc_action *a)\n{\n\tu8 tcfm_bos;\n\n\trcu_read_lock();\n\ttcfm_bos = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_bos;\n\trcu_read_unlock();\n\n\treturn tcfm_bos;\n}\n\nstatic inline u8 tcf_mpls_ttl(const struct tc_action *a)\n{\n\tu8 tcfm_ttl;\n\n\trcu_read_lock();\n\ttcfm_ttl = rcu_dereference(to_mpls(a)->mpls_p)->tcfm_ttl;\n\trcu_read_unlock();\n\n\treturn tcfm_ttl;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}