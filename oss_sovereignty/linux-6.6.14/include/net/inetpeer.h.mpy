{
  "module_name": "inetpeer.h",
  "hash_id": "58af4dd48f04b9bf0543afe80eeff65c88da995cc740993db080c4baf48d4cb5",
  "original_prompt": "Ingested from linux-6.6.14/include/net/inetpeer.h",
  "human_readable_source": " \n \n\n#ifndef _NET_INETPEER_H\n#define _NET_INETPEER_H\n\n#include <linux/types.h>\n#include <linux/init.h>\n#include <linux/jiffies.h>\n#include <linux/spinlock.h>\n#include <linux/rtnetlink.h>\n#include <net/ipv6.h>\n#include <linux/atomic.h>\n\n \nstruct ipv4_addr_key {\n\t__be32\taddr;\n\tint\tvif;\n};\n\n#define INETPEER_MAXKEYSZ   (sizeof(struct in6_addr) / sizeof(u32))\n\nstruct inetpeer_addr {\n\tunion {\n\t\tstruct ipv4_addr_key\ta4;\n\t\tstruct in6_addr\t\ta6;\n\t\tu32\t\t\tkey[INETPEER_MAXKEYSZ];\n\t};\n\t__u16\t\t\t\tfamily;\n};\n\nstruct inet_peer {\n\tstruct rb_node\t\trb_node;\n\tstruct inetpeer_addr\tdaddr;\n\n\tu32\t\t\tmetrics[RTAX_MAX];\n\tu32\t\t\trate_tokens;\t \n\tu32\t\t\tn_redirects;\n\tunsigned long\t\trate_last;\n\t \n\tunion {\n\t\tstruct {\n\t\t\tatomic_t\t\t\trid;\t\t \n\t\t};\n\t\tstruct rcu_head         rcu;\n\t};\n\n\t \n\t__u32\t\t\tdtime;\t \n\trefcount_t\t\trefcnt;\n};\n\nstruct inet_peer_base {\n\tstruct rb_root\t\trb_root;\n\tseqlock_t\t\tlock;\n\tint\t\t\ttotal;\n};\n\nvoid inet_peer_base_init(struct inet_peer_base *);\n\nvoid inet_initpeers(void) __init;\n\n#define INETPEER_METRICS_NEW\t(~(u32) 0)\n\nstatic inline void inetpeer_set_addr_v4(struct inetpeer_addr *iaddr, __be32 ip)\n{\n\tiaddr->a4.addr = ip;\n\tiaddr->a4.vif = 0;\n\tiaddr->family = AF_INET;\n}\n\nstatic inline __be32 inetpeer_get_addr_v4(struct inetpeer_addr *iaddr)\n{\n\treturn iaddr->a4.addr;\n}\n\nstatic inline void inetpeer_set_addr_v6(struct inetpeer_addr *iaddr,\n\t\t\t\t\tstruct in6_addr *in6)\n{\n\tiaddr->a6 = *in6;\n\tiaddr->family = AF_INET6;\n}\n\nstatic inline struct in6_addr *inetpeer_get_addr_v6(struct inetpeer_addr *iaddr)\n{\n\treturn &iaddr->a6;\n}\n\n \nstruct inet_peer *inet_getpeer(struct inet_peer_base *base,\n\t\t\t       const struct inetpeer_addr *daddr,\n\t\t\t       int create);\n\nstatic inline struct inet_peer *inet_getpeer_v4(struct inet_peer_base *base,\n\t\t\t\t\t\t__be32 v4daddr,\n\t\t\t\t\t\tint vif, int create)\n{\n\tstruct inetpeer_addr daddr;\n\n\tdaddr.a4.addr = v4daddr;\n\tdaddr.a4.vif = vif;\n\tdaddr.family = AF_INET;\n\treturn inet_getpeer(base, &daddr, create);\n}\n\nstatic inline struct inet_peer *inet_getpeer_v6(struct inet_peer_base *base,\n\t\t\t\t\t\tconst struct in6_addr *v6daddr,\n\t\t\t\t\t\tint create)\n{\n\tstruct inetpeer_addr daddr;\n\n\tdaddr.a6 = *v6daddr;\n\tdaddr.family = AF_INET6;\n\treturn inet_getpeer(base, &daddr, create);\n}\n\nstatic inline int inetpeer_addr_cmp(const struct inetpeer_addr *a,\n\t\t\t\t    const struct inetpeer_addr *b)\n{\n\tint i, n;\n\n\tif (a->family == AF_INET)\n\t\tn = sizeof(a->a4) / sizeof(u32);\n\telse\n\t\tn = sizeof(a->a6) / sizeof(u32);\n\n\tfor (i = 0; i < n; i++) {\n\t\tif (a->key[i] == b->key[i])\n\t\t\tcontinue;\n\t\tif (a->key[i] < b->key[i])\n\t\t\treturn -1;\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n\n \nvoid inet_putpeer(struct inet_peer *p);\nbool inet_peer_xrlim_allow(struct inet_peer *peer, int timeout);\n\nvoid inetpeer_invalidate_tree(struct inet_peer_base *);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}