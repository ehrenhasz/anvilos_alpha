{
  "module_name": "posix_acl.h",
  "hash_id": "7e8c165ba1e3612e4a50b6e79578de45a2afb703c6282165e9f9b84672b8d0c3",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/posix_acl.h",
  "human_readable_source": " \n \n\n\n#ifndef __LINUX_POSIX_ACL_H\n#define __LINUX_POSIX_ACL_H\n\n#include <linux/bug.h>\n#include <linux/slab.h>\n#include <linux/rcupdate.h>\n#include <linux/refcount.h>\n#include <uapi/linux/posix_acl.h>\n\nstruct user_namespace;\n\nstruct posix_acl_entry {\n\tshort\t\t\te_tag;\n\tunsigned short\t\te_perm;\n\tunion {\n\t\tkuid_t\t\te_uid;\n\t\tkgid_t\t\te_gid;\n\t};\n};\n\nstruct posix_acl {\n\trefcount_t\t\ta_refcount;\n\tstruct rcu_head\t\ta_rcu;\n\tunsigned int\t\ta_count;\n\tstruct posix_acl_entry\ta_entries[];\n};\n\n#define FOREACH_ACL_ENTRY(pa, acl, pe) \\\n\tfor(pa=(acl)->a_entries, pe=pa+(acl)->a_count; pa<pe; pa++)\n\n\n \nstatic inline struct posix_acl *\nposix_acl_dup(struct posix_acl *acl)\n{\n\tif (acl)\n\t\trefcount_inc(&acl->a_refcount);\n\treturn acl;\n}\n\n \nstatic inline void\nposix_acl_release(struct posix_acl *acl)\n{\n\tif (acl && refcount_dec_and_test(&acl->a_refcount))\n\t\tkfree_rcu(acl, a_rcu);\n}\n\n\n \n\nextern void posix_acl_init(struct posix_acl *, int);\nextern struct posix_acl *posix_acl_alloc(int, gfp_t);\nextern struct posix_acl *posix_acl_from_mode(umode_t, gfp_t);\nextern int posix_acl_equiv_mode(const struct posix_acl *, umode_t *);\nextern int __posix_acl_create(struct posix_acl **, gfp_t, umode_t *);\nextern int __posix_acl_chmod(struct posix_acl **, gfp_t, umode_t);\n\nextern struct posix_acl *get_posix_acl(struct inode *, int);\nint set_posix_acl(struct mnt_idmap *, struct dentry *, int,\n\t\t  struct posix_acl *);\n\nstruct posix_acl *get_cached_acl_rcu(struct inode *inode, int type);\nstruct posix_acl *posix_acl_clone(const struct posix_acl *acl, gfp_t flags);\n\n#ifdef CONFIG_FS_POSIX_ACL\nint posix_acl_chmod(struct mnt_idmap *, struct dentry *, umode_t);\nextern int posix_acl_create(struct inode *, umode_t *, struct posix_acl **,\n\t\tstruct posix_acl **);\nint posix_acl_update_mode(struct mnt_idmap *, struct inode *, umode_t *,\n\t\t\t  struct posix_acl **);\n\nint simple_set_acl(struct mnt_idmap *, struct dentry *,\n\t\t   struct posix_acl *, int);\nextern int simple_acl_create(struct inode *, struct inode *);\n\nstruct posix_acl *get_cached_acl(struct inode *inode, int type);\nvoid set_cached_acl(struct inode *inode, int type, struct posix_acl *acl);\nvoid forget_cached_acl(struct inode *inode, int type);\nvoid forget_all_cached_acls(struct inode *inode);\nint posix_acl_valid(struct user_namespace *, const struct posix_acl *);\nint posix_acl_permission(struct mnt_idmap *, struct inode *,\n\t\t\t const struct posix_acl *, int);\n\nstatic inline void cache_no_acl(struct inode *inode)\n{\n\tinode->i_acl = NULL;\n\tinode->i_default_acl = NULL;\n}\n\nint vfs_set_acl(struct mnt_idmap *idmap, struct dentry *dentry,\n\t\tconst char *acl_name, struct posix_acl *kacl);\nstruct posix_acl *vfs_get_acl(struct mnt_idmap *idmap,\n\t\t\t      struct dentry *dentry, const char *acl_name);\nint vfs_remove_acl(struct mnt_idmap *idmap, struct dentry *dentry,\n\t\t   const char *acl_name);\nint posix_acl_listxattr(struct inode *inode, char **buffer,\n\t\t\tssize_t *remaining_size);\n#else\nstatic inline int posix_acl_chmod(struct mnt_idmap *idmap,\n\t\t\t\t  struct dentry *dentry, umode_t mode)\n{\n\treturn 0;\n}\n\n#define simple_set_acl\t\tNULL\n\nstatic inline int simple_acl_create(struct inode *dir, struct inode *inode)\n{\n\treturn 0;\n}\nstatic inline void cache_no_acl(struct inode *inode)\n{\n}\n\nstatic inline int posix_acl_create(struct inode *inode, umode_t *mode,\n\t\tstruct posix_acl **default_acl, struct posix_acl **acl)\n{\n\t*default_acl = *acl = NULL;\n\treturn 0;\n}\n\nstatic inline void forget_all_cached_acls(struct inode *inode)\n{\n}\n\nstatic inline int vfs_set_acl(struct mnt_idmap *idmap,\n\t\t\t      struct dentry *dentry, const char *name,\n\t\t\t      struct posix_acl *acl)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline struct posix_acl *vfs_get_acl(struct mnt_idmap *idmap,\n\t\t\t\t\t    struct dentry *dentry,\n\t\t\t\t\t    const char *acl_name)\n{\n\treturn ERR_PTR(-EOPNOTSUPP);\n}\n\nstatic inline int vfs_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t struct dentry *dentry, const char *acl_name)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int posix_acl_listxattr(struct inode *inode, char **buffer,\n\t\t\t\t      ssize_t *remaining_size)\n{\n\treturn 0;\n}\n#endif  \n\nstruct posix_acl *get_inode_acl(struct inode *inode, int type);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}