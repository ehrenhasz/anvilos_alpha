{
  "module_name": "verification.h",
  "hash_id": "5b0f1a1e25e0e37a6dd18c787d502e9dbdc82e8cb42e2c8ea8126282f3164e0b",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/verification.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_VERIFICATION_H\n#define _LINUX_VERIFICATION_H\n\n#include <linux/errno.h>\n#include <linux/types.h>\n\n \n#define VERIFY_USE_SECONDARY_KEYRING ((struct key *)1UL)\n#define VERIFY_USE_PLATFORM_KEYRING  ((struct key *)2UL)\n\nstatic inline int system_keyring_id_check(u64 id)\n{\n\tif (id > (unsigned long)VERIFY_USE_PLATFORM_KEYRING)\n\t\treturn -EINVAL;\n\n\treturn 0;\n}\n\n \nenum key_being_used_for {\n\tVERIFYING_MODULE_SIGNATURE,\n\tVERIFYING_FIRMWARE_SIGNATURE,\n\tVERIFYING_KEXEC_PE_SIGNATURE,\n\tVERIFYING_KEY_SIGNATURE,\n\tVERIFYING_KEY_SELF_SIGNATURE,\n\tVERIFYING_UNSPECIFIED_SIGNATURE,\n\tNR__KEY_BEING_USED_FOR\n};\nextern const char *const key_being_used_for[NR__KEY_BEING_USED_FOR];\n\n#ifdef CONFIG_SYSTEM_DATA_VERIFICATION\n\nstruct key;\nstruct pkcs7_message;\n\nextern int verify_pkcs7_signature(const void *data, size_t len,\n\t\t\t\t  const void *raw_pkcs7, size_t pkcs7_len,\n\t\t\t\t  struct key *trusted_keys,\n\t\t\t\t  enum key_being_used_for usage,\n\t\t\t\t  int (*view_content)(void *ctx,\n\t\t\t\t\t\t      const void *data, size_t len,\n\t\t\t\t\t\t      size_t asn1hdrlen),\n\t\t\t\t  void *ctx);\nextern int verify_pkcs7_message_sig(const void *data, size_t len,\n\t\t\t\t    struct pkcs7_message *pkcs7,\n\t\t\t\t    struct key *trusted_keys,\n\t\t\t\t    enum key_being_used_for usage,\n\t\t\t\t    int (*view_content)(void *ctx,\n\t\t\t\t\t\t\tconst void *data,\n\t\t\t\t\t\t\tsize_t len,\n\t\t\t\t\t\t\tsize_t asn1hdrlen),\n\t\t\t\t    void *ctx);\n\n#ifdef CONFIG_SIGNED_PE_FILE_VERIFICATION\nextern int verify_pefile_signature(const void *pebuf, unsigned pelen,\n\t\t\t\t   struct key *trusted_keys,\n\t\t\t\t   enum key_being_used_for usage);\n#endif\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}