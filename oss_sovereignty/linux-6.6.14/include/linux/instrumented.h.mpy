{
  "module_name": "instrumented.h",
  "hash_id": "916e1ecfa8a384334c188066150b424f8fe0d07c704440ed7eae4f93e313e3f3",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/instrumented.h",
  "human_readable_source": " \n\n \n#ifndef _LINUX_INSTRUMENTED_H\n#define _LINUX_INSTRUMENTED_H\n\n#include <linux/compiler.h>\n#include <linux/kasan-checks.h>\n#include <linux/kcsan-checks.h>\n#include <linux/kmsan-checks.h>\n#include <linux/types.h>\n\n \nstatic __always_inline void instrument_read(const volatile void *v, size_t size)\n{\n\tkasan_check_read(v, size);\n\tkcsan_check_read(v, size);\n}\n\n \nstatic __always_inline void instrument_write(const volatile void *v, size_t size)\n{\n\tkasan_check_write(v, size);\n\tkcsan_check_write(v, size);\n}\n\n \nstatic __always_inline void instrument_read_write(const volatile void *v, size_t size)\n{\n\tkasan_check_write(v, size);\n\tkcsan_check_read_write(v, size);\n}\n\n \nstatic __always_inline void instrument_atomic_read(const volatile void *v, size_t size)\n{\n\tkasan_check_read(v, size);\n\tkcsan_check_atomic_read(v, size);\n}\n\n \nstatic __always_inline void instrument_atomic_write(const volatile void *v, size_t size)\n{\n\tkasan_check_write(v, size);\n\tkcsan_check_atomic_write(v, size);\n}\n\n \nstatic __always_inline void instrument_atomic_read_write(const volatile void *v, size_t size)\n{\n\tkasan_check_write(v, size);\n\tkcsan_check_atomic_read_write(v, size);\n}\n\n \nstatic __always_inline void\ninstrument_copy_to_user(void __user *to, const void *from, unsigned long n)\n{\n\tkasan_check_read(from, n);\n\tkcsan_check_read(from, n);\n\tkmsan_copy_to_user(to, from, n, 0);\n}\n\n \nstatic __always_inline void\ninstrument_copy_from_user_before(const void *to, const void __user *from, unsigned long n)\n{\n\tkasan_check_write(to, n);\n\tkcsan_check_write(to, n);\n}\n\n \nstatic __always_inline void\ninstrument_copy_from_user_after(const void *to, const void __user *from,\n\t\t\t\tunsigned long n, unsigned long left)\n{\n\tkmsan_unpoison_memory(to, n - left);\n}\n\n \n#define instrument_get_user(to)\t\t\t\t\\\n({\t\t\t\t\t\t\t\\\n\tu64 __tmp = (u64)(to);\t\t\t\t\\\n\tkmsan_unpoison_memory(&__tmp, sizeof(__tmp));\t\\\n\tto = __tmp;\t\t\t\t\t\\\n})\n\n\n \n#define instrument_put_user(from, ptr, size)\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tkmsan_copy_to_user(ptr, &from, sizeof(from), 0);\t\\\n})\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}