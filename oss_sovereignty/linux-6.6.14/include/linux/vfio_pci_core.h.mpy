{
  "module_name": "vfio_pci_core.h",
  "hash_id": "bfbdd8a101bc61760de9b1d89ce7a325ea37972b7f0b21611bba37aac4f97e02",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/vfio_pci_core.h",
  "human_readable_source": " \n \n\n#include <linux/mutex.h>\n#include <linux/pci.h>\n#include <linux/vfio.h>\n#include <linux/irqbypass.h>\n#include <linux/types.h>\n#include <linux/uuid.h>\n#include <linux/notifier.h>\n\n#ifndef VFIO_PCI_CORE_H\n#define VFIO_PCI_CORE_H\n\n#define VFIO_PCI_OFFSET_SHIFT   40\n#define VFIO_PCI_OFFSET_TO_INDEX(off)\t(off >> VFIO_PCI_OFFSET_SHIFT)\n#define VFIO_PCI_INDEX_TO_OFFSET(index)\t((u64)(index) << VFIO_PCI_OFFSET_SHIFT)\n#define VFIO_PCI_OFFSET_MASK\t(((u64)(1) << VFIO_PCI_OFFSET_SHIFT) - 1)\n\nstruct vfio_pci_core_device;\nstruct vfio_pci_region;\n\nstruct vfio_pci_regops {\n\tssize_t (*rw)(struct vfio_pci_core_device *vdev, char __user *buf,\n\t\t      size_t count, loff_t *ppos, bool iswrite);\n\tvoid\t(*release)(struct vfio_pci_core_device *vdev,\n\t\t\t   struct vfio_pci_region *region);\n\tint\t(*mmap)(struct vfio_pci_core_device *vdev,\n\t\t\tstruct vfio_pci_region *region,\n\t\t\tstruct vm_area_struct *vma);\n\tint\t(*add_capability)(struct vfio_pci_core_device *vdev,\n\t\t\t\t  struct vfio_pci_region *region,\n\t\t\t\t  struct vfio_info_cap *caps);\n};\n\nstruct vfio_pci_region {\n\tu32\t\t\t\ttype;\n\tu32\t\t\t\tsubtype;\n\tconst struct vfio_pci_regops\t*ops;\n\tvoid\t\t\t\t*data;\n\tsize_t\t\t\t\tsize;\n\tu32\t\t\t\tflags;\n};\n\nstruct vfio_pci_core_device {\n\tstruct vfio_device\tvdev;\n\tstruct pci_dev\t\t*pdev;\n\tvoid __iomem\t\t*barmap[PCI_STD_NUM_BARS];\n\tbool\t\t\tbar_mmap_supported[PCI_STD_NUM_BARS];\n\tu8\t\t\t*pci_config_map;\n\tu8\t\t\t*vconfig;\n\tstruct perm_bits\t*msi_perm;\n\tspinlock_t\t\tirqlock;\n\tstruct mutex\t\tigate;\n\tstruct xarray\t\tctx;\n\tint\t\t\tirq_type;\n\tint\t\t\tnum_regions;\n\tstruct vfio_pci_region\t*region;\n\tu8\t\t\tmsi_qmax;\n\tu8\t\t\tmsix_bar;\n\tu16\t\t\tmsix_size;\n\tu32\t\t\tmsix_offset;\n\tu32\t\t\trbar[7];\n\tbool\t\t\thas_dyn_msix:1;\n\tbool\t\t\tpci_2_3:1;\n\tbool\t\t\tvirq_disabled:1;\n\tbool\t\t\treset_works:1;\n\tbool\t\t\textended_caps:1;\n\tbool\t\t\tbardirty:1;\n\tbool\t\t\thas_vga:1;\n\tbool\t\t\tneeds_reset:1;\n\tbool\t\t\tnointx:1;\n\tbool\t\t\tneeds_pm_restore:1;\n\tbool\t\t\tpm_intx_masked:1;\n\tbool\t\t\tpm_runtime_engaged:1;\n\tstruct pci_saved_state\t*pci_saved_state;\n\tstruct pci_saved_state\t*pm_save;\n\tint\t\t\tioeventfds_nr;\n\tstruct eventfd_ctx\t*err_trigger;\n\tstruct eventfd_ctx\t*req_trigger;\n\tstruct eventfd_ctx\t*pm_wake_eventfd_ctx;\n\tstruct list_head\tdummy_resources_list;\n\tstruct mutex\t\tioeventfds_lock;\n\tstruct list_head\tioeventfds_list;\n\tstruct vfio_pci_vf_token\t*vf_token;\n\tstruct list_head\t\tsriov_pfs_item;\n\tstruct vfio_pci_core_device\t*sriov_pf_core_dev;\n\tstruct notifier_block\tnb;\n\tstruct mutex\t\tvma_lock;\n\tstruct list_head\tvma_list;\n\tstruct rw_semaphore\tmemory_lock;\n};\n\n \nint vfio_pci_core_register_dev_region(struct vfio_pci_core_device *vdev,\n\t\t\t\t      unsigned int type, unsigned int subtype,\n\t\t\t\t      const struct vfio_pci_regops *ops,\n\t\t\t\t      size_t size, u32 flags, void *data);\nvoid vfio_pci_core_set_params(bool nointxmask, bool is_disable_vga,\n\t\t\t      bool is_disable_idle_d3);\nvoid vfio_pci_core_close_device(struct vfio_device *core_vdev);\nint vfio_pci_core_init_dev(struct vfio_device *core_vdev);\nvoid vfio_pci_core_release_dev(struct vfio_device *core_vdev);\nint vfio_pci_core_register_device(struct vfio_pci_core_device *vdev);\nvoid vfio_pci_core_unregister_device(struct vfio_pci_core_device *vdev);\nextern const struct pci_error_handlers vfio_pci_core_err_handlers;\nint vfio_pci_core_sriov_configure(struct vfio_pci_core_device *vdev,\n\t\t\t\t  int nr_virtfn);\nlong vfio_pci_core_ioctl(struct vfio_device *core_vdev, unsigned int cmd,\n\t\tunsigned long arg);\nint vfio_pci_core_ioctl_feature(struct vfio_device *device, u32 flags,\n\t\t\t\tvoid __user *arg, size_t argsz);\nssize_t vfio_pci_core_read(struct vfio_device *core_vdev, char __user *buf,\n\t\tsize_t count, loff_t *ppos);\nssize_t vfio_pci_core_write(struct vfio_device *core_vdev, const char __user *buf,\n\t\tsize_t count, loff_t *ppos);\nint vfio_pci_core_mmap(struct vfio_device *core_vdev, struct vm_area_struct *vma);\nvoid vfio_pci_core_request(struct vfio_device *core_vdev, unsigned int count);\nint vfio_pci_core_match(struct vfio_device *core_vdev, char *buf);\nint vfio_pci_core_enable(struct vfio_pci_core_device *vdev);\nvoid vfio_pci_core_disable(struct vfio_pci_core_device *vdev);\nvoid vfio_pci_core_finish_enable(struct vfio_pci_core_device *vdev);\npci_ers_result_t vfio_pci_core_aer_err_detected(struct pci_dev *pdev,\n\t\t\t\t\t\tpci_channel_state_t state);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}