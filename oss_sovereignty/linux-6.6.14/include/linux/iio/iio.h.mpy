{
  "module_name": "iio.h",
  "hash_id": "cb28e44441bb30a4ef6a9cf650e78888d64acc55bb8025d12694a407ee3168c4",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/iio/iio.h",
  "human_readable_source": " \n\n \n#ifndef _INDUSTRIAL_IO_H_\n#define _INDUSTRIAL_IO_H_\n\n#include <linux/device.h>\n#include <linux/cdev.h>\n#include <linux/slab.h>\n#include <linux/iio/types.h>\n \n \n\nstruct fwnode_reference_args;\n\nenum iio_shared_by {\n\tIIO_SEPARATE,\n\tIIO_SHARED_BY_TYPE,\n\tIIO_SHARED_BY_DIR,\n\tIIO_SHARED_BY_ALL\n};\n\nenum iio_endian {\n\tIIO_CPU,\n\tIIO_BE,\n\tIIO_LE,\n};\n\nstruct iio_chan_spec;\nstruct iio_dev;\n\n \nstruct iio_chan_spec_ext_info {\n\tconst char *name;\n\tenum iio_shared_by shared;\n\tssize_t (*read)(struct iio_dev *, uintptr_t private,\n\t\t\tstruct iio_chan_spec const *, char *buf);\n\tssize_t (*write)(struct iio_dev *, uintptr_t private,\n\t\t\t struct iio_chan_spec const *, const char *buf,\n\t\t\t size_t len);\n\tuintptr_t private;\n};\n\n \nstruct iio_enum {\n\tconst char * const *items;\n\tunsigned int num_items;\n\tint (*set)(struct iio_dev *, const struct iio_chan_spec *, unsigned int);\n\tint (*get)(struct iio_dev *, const struct iio_chan_spec *);\n};\n\nssize_t iio_enum_available_read(struct iio_dev *indio_dev,\n\tuintptr_t priv, const struct iio_chan_spec *chan, char *buf);\nssize_t iio_enum_read(struct iio_dev *indio_dev,\n\tuintptr_t priv, const struct iio_chan_spec *chan, char *buf);\nssize_t iio_enum_write(struct iio_dev *indio_dev,\n\tuintptr_t priv, const struct iio_chan_spec *chan, const char *buf,\n\tsize_t len);\n\n \n#define IIO_ENUM(_name, _shared, _e) \\\n{ \\\n\t.name = (_name), \\\n\t.shared = (_shared), \\\n\t.read = iio_enum_read, \\\n\t.write = iio_enum_write, \\\n\t.private = (uintptr_t)(_e), \\\n}\n\n \n#define IIO_ENUM_AVAILABLE(_name, _shared, _e) \\\n{ \\\n\t.name = (_name \"_available\"), \\\n\t.shared = _shared, \\\n\t.read = iio_enum_available_read, \\\n\t.private = (uintptr_t)(_e), \\\n}\n\n \nstruct iio_mount_matrix {\n\tconst char *rotation[9];\n};\n\nssize_t iio_show_mount_matrix(struct iio_dev *indio_dev, uintptr_t priv,\n\t\t\t      const struct iio_chan_spec *chan, char *buf);\nint iio_read_mount_matrix(struct device *dev, struct iio_mount_matrix *matrix);\n\ntypedef const struct iio_mount_matrix *\n\t(iio_get_mount_matrix_t)(const struct iio_dev *indio_dev,\n\t\t\t\t const struct iio_chan_spec *chan);\n\n \n#define IIO_MOUNT_MATRIX(_shared, _get) \\\n{ \\\n\t.name = \"mount_matrix\", \\\n\t.shared = (_shared), \\\n\t.read = iio_show_mount_matrix, \\\n\t.private = (uintptr_t)(_get), \\\n}\n\n \nstruct iio_event_spec {\n\tenum iio_event_type type;\n\tenum iio_event_direction dir;\n\tunsigned long mask_separate;\n\tunsigned long mask_shared_by_type;\n\tunsigned long mask_shared_by_dir;\n\tunsigned long mask_shared_by_all;\n};\n\n \nstruct iio_chan_spec {\n\tenum iio_chan_type\ttype;\n\tint\t\t\tchannel;\n\tint\t\t\tchannel2;\n\tunsigned long\t\taddress;\n\tint\t\t\tscan_index;\n\tstruct {\n\t\tchar\tsign;\n\t\tu8\trealbits;\n\t\tu8\tstoragebits;\n\t\tu8\tshift;\n\t\tu8\trepeat;\n\t\tenum iio_endian endianness;\n\t} scan_type;\n\tlong\t\t\tinfo_mask_separate;\n\tlong\t\t\tinfo_mask_separate_available;\n\tlong\t\t\tinfo_mask_shared_by_type;\n\tlong\t\t\tinfo_mask_shared_by_type_available;\n\tlong\t\t\tinfo_mask_shared_by_dir;\n\tlong\t\t\tinfo_mask_shared_by_dir_available;\n\tlong\t\t\tinfo_mask_shared_by_all;\n\tlong\t\t\tinfo_mask_shared_by_all_available;\n\tconst struct iio_event_spec *event_spec;\n\tunsigned int\t\tnum_event_specs;\n\tconst struct iio_chan_spec_ext_info *ext_info;\n\tconst char\t\t*extend_name;\n\tconst char\t\t*datasheet_name;\n\tunsigned\t\tmodified:1;\n\tunsigned\t\tindexed:1;\n\tunsigned\t\toutput:1;\n\tunsigned\t\tdifferential:1;\n};\n\n\n \nstatic inline bool iio_channel_has_info(const struct iio_chan_spec *chan,\n\tenum iio_chan_info_enum type)\n{\n\treturn (chan->info_mask_separate & BIT(type)) |\n\t\t(chan->info_mask_shared_by_type & BIT(type)) |\n\t\t(chan->info_mask_shared_by_dir & BIT(type)) |\n\t\t(chan->info_mask_shared_by_all & BIT(type));\n}\n\n \nstatic inline bool iio_channel_has_available(const struct iio_chan_spec *chan,\n\t\t\t\t\t     enum iio_chan_info_enum type)\n{\n\treturn (chan->info_mask_separate_available & BIT(type)) |\n\t\t(chan->info_mask_shared_by_type_available & BIT(type)) |\n\t\t(chan->info_mask_shared_by_dir_available & BIT(type)) |\n\t\t(chan->info_mask_shared_by_all_available & BIT(type));\n}\n\n#define IIO_CHAN_SOFT_TIMESTAMP(_si) {\t\t\t\t\t\\\n\t.type = IIO_TIMESTAMP,\t\t\t\t\t\t\\\n\t.channel = -1,\t\t\t\t\t\t\t\\\n\t.scan_index = _si,\t\t\t\t\t\t\\\n\t.scan_type = {\t\t\t\t\t\t\t\\\n\t\t.sign = 's',\t\t\t\t\t\t\\\n\t\t.realbits = 64,\t\t\t\t\t\\\n\t\t.storagebits = 64,\t\t\t\t\t\\\n\t\t},\t\t\t\t\t\t\t\\\n}\n\ns64 iio_get_time_ns(const struct iio_dev *indio_dev);\n\n \n#define INDIO_DIRECT_MODE\t\t0x01\n#define INDIO_BUFFER_TRIGGERED\t\t0x02\n#define INDIO_BUFFER_SOFTWARE\t\t0x04\n#define INDIO_BUFFER_HARDWARE\t\t0x08\n#define INDIO_EVENT_TRIGGERED\t\t0x10\n#define INDIO_HARDWARE_TRIGGERED\t0x20\n\n#define INDIO_ALL_BUFFER_MODES\t\t\t\t\t\\\n\t(INDIO_BUFFER_TRIGGERED | INDIO_BUFFER_HARDWARE | INDIO_BUFFER_SOFTWARE)\n\n#define INDIO_ALL_TRIGGERED_MODES\t\\\n\t(INDIO_BUFFER_TRIGGERED\t\t\\\n\t | INDIO_EVENT_TRIGGERED\t\\\n\t | INDIO_HARDWARE_TRIGGERED)\n\n#define INDIO_MAX_RAW_ELEMENTS\t\t4\n\nstruct iio_val_int_plus_micro {\n\tint integer;\n\tint micro;\n};\n\nstruct iio_trigger;  \n\n \nstruct iio_info {\n\tconst struct attribute_group\t*event_attrs;\n\tconst struct attribute_group\t*attrs;\n\n\tint (*read_raw)(struct iio_dev *indio_dev,\n\t\t\tstruct iio_chan_spec const *chan,\n\t\t\tint *val,\n\t\t\tint *val2,\n\t\t\tlong mask);\n\n\tint (*read_raw_multi)(struct iio_dev *indio_dev,\n\t\t\tstruct iio_chan_spec const *chan,\n\t\t\tint max_len,\n\t\t\tint *vals,\n\t\t\tint *val_len,\n\t\t\tlong mask);\n\n\tint (*read_avail)(struct iio_dev *indio_dev,\n\t\t\t  struct iio_chan_spec const *chan,\n\t\t\t  const int **vals,\n\t\t\t  int *type,\n\t\t\t  int *length,\n\t\t\t  long mask);\n\n\tint (*write_raw)(struct iio_dev *indio_dev,\n\t\t\t struct iio_chan_spec const *chan,\n\t\t\t int val,\n\t\t\t int val2,\n\t\t\t long mask);\n\n\tint (*read_label)(struct iio_dev *indio_dev,\n\t\t\t struct iio_chan_spec const *chan,\n\t\t\t char *label);\n\n\tint (*write_raw_get_fmt)(struct iio_dev *indio_dev,\n\t\t\t struct iio_chan_spec const *chan,\n\t\t\t long mask);\n\n\tint (*read_event_config)(struct iio_dev *indio_dev,\n\t\t\t\t const struct iio_chan_spec *chan,\n\t\t\t\t enum iio_event_type type,\n\t\t\t\t enum iio_event_direction dir);\n\n\tint (*write_event_config)(struct iio_dev *indio_dev,\n\t\t\t\t  const struct iio_chan_spec *chan,\n\t\t\t\t  enum iio_event_type type,\n\t\t\t\t  enum iio_event_direction dir,\n\t\t\t\t  int state);\n\n\tint (*read_event_value)(struct iio_dev *indio_dev,\n\t\t\t\tconst struct iio_chan_spec *chan,\n\t\t\t\tenum iio_event_type type,\n\t\t\t\tenum iio_event_direction dir,\n\t\t\t\tenum iio_event_info info, int *val, int *val2);\n\n\tint (*write_event_value)(struct iio_dev *indio_dev,\n\t\t\t\t const struct iio_chan_spec *chan,\n\t\t\t\t enum iio_event_type type,\n\t\t\t\t enum iio_event_direction dir,\n\t\t\t\t enum iio_event_info info, int val, int val2);\n\n\tint (*validate_trigger)(struct iio_dev *indio_dev,\n\t\t\t\tstruct iio_trigger *trig);\n\tint (*update_scan_mode)(struct iio_dev *indio_dev,\n\t\t\t\tconst unsigned long *scan_mask);\n\tint (*debugfs_reg_access)(struct iio_dev *indio_dev,\n\t\t\t\t  unsigned reg, unsigned writeval,\n\t\t\t\t  unsigned *readval);\n\tint (*fwnode_xlate)(struct iio_dev *indio_dev,\n\t\t\t    const struct fwnode_reference_args *iiospec);\n\tint (*hwfifo_set_watermark)(struct iio_dev *indio_dev, unsigned val);\n\tint (*hwfifo_flush_to_buffer)(struct iio_dev *indio_dev,\n\t\t\t\t      unsigned count);\n};\n\n \nstruct iio_buffer_setup_ops {\n\tint (*preenable)(struct iio_dev *);\n\tint (*postenable)(struct iio_dev *);\n\tint (*predisable)(struct iio_dev *);\n\tint (*postdisable)(struct iio_dev *);\n\tbool (*validate_scan_mask)(struct iio_dev *indio_dev,\n\t\t\t\t   const unsigned long *scan_mask);\n};\n\n \nstruct iio_dev {\n\tint\t\t\t\tmodes;\n\tstruct device\t\t\tdev;\n\n\tstruct iio_buffer\t\t*buffer;\n\tint\t\t\t\tscan_bytes;\n\n\tconst unsigned long\t\t*available_scan_masks;\n\tunsigned\t\t\tmasklength;\n\tconst unsigned long\t\t*active_scan_mask;\n\tbool\t\t\t\tscan_timestamp;\n\tstruct iio_trigger\t\t*trig;\n\tstruct iio_poll_func\t\t*pollfunc;\n\tstruct iio_poll_func\t\t*pollfunc_event;\n\n\tstruct iio_chan_spec const\t*channels;\n\tint\t\t\t\tnum_channels;\n\n\tconst char\t\t\t*name;\n\tconst char\t\t\t*label;\n\tconst struct iio_info\t\t*info;\n\tconst struct iio_buffer_setup_ops\t*setup_ops;\n\n\tvoid\t\t\t\t*priv;\n};\n\nint iio_device_id(struct iio_dev *indio_dev);\nint iio_device_get_current_mode(struct iio_dev *indio_dev);\nbool iio_buffer_enabled(struct iio_dev *indio_dev);\n\nconst struct iio_chan_spec\n*iio_find_channel_from_si(struct iio_dev *indio_dev, int si);\n \n#define iio_device_register(indio_dev) \\\n\t__iio_device_register((indio_dev), THIS_MODULE)\nint __iio_device_register(struct iio_dev *indio_dev, struct module *this_mod);\nvoid iio_device_unregister(struct iio_dev *indio_dev);\n \n#define devm_iio_device_register(dev, indio_dev) \\\n\t__devm_iio_device_register((dev), (indio_dev), THIS_MODULE)\nint __devm_iio_device_register(struct device *dev, struct iio_dev *indio_dev,\n\t\t\t       struct module *this_mod);\nint iio_push_event(struct iio_dev *indio_dev, u64 ev_code, s64 timestamp);\nint iio_device_claim_direct_mode(struct iio_dev *indio_dev);\nvoid iio_device_release_direct_mode(struct iio_dev *indio_dev);\nint iio_device_claim_buffer_mode(struct iio_dev *indio_dev);\nvoid iio_device_release_buffer_mode(struct iio_dev *indio_dev);\n\nextern struct bus_type iio_bus_type;\n\n \nstatic inline void iio_device_put(struct iio_dev *indio_dev)\n{\n\tif (indio_dev)\n\t\tput_device(&indio_dev->dev);\n}\n\nclockid_t iio_device_get_clock(const struct iio_dev *indio_dev);\nint iio_device_set_clock(struct iio_dev *indio_dev, clockid_t clock_id);\n\n \nstatic inline struct iio_dev *dev_to_iio_dev(struct device *dev)\n{\n\treturn container_of(dev, struct iio_dev, dev);\n}\n\n \nstatic inline struct iio_dev *iio_device_get(struct iio_dev *indio_dev)\n{\n\treturn indio_dev ? dev_to_iio_dev(get_device(&indio_dev->dev)) : NULL;\n}\n\n \nstatic inline void iio_device_set_parent(struct iio_dev *indio_dev,\n\t\t\t\t\t struct device *parent)\n{\n\tindio_dev->dev.parent = parent;\n}\n\n \nstatic inline void iio_device_set_drvdata(struct iio_dev *indio_dev, void *data)\n{\n\tdev_set_drvdata(&indio_dev->dev, data);\n}\n\n \nstatic inline void *iio_device_get_drvdata(const struct iio_dev *indio_dev)\n{\n\treturn dev_get_drvdata(&indio_dev->dev);\n}\n\n \n#define IIO_DMA_MINALIGN ARCH_DMA_MINALIGN\nstruct iio_dev *iio_device_alloc(struct device *parent, int sizeof_priv);\n\n \nstatic inline void *iio_priv(const struct iio_dev *indio_dev)\n{\n\treturn indio_dev->priv;\n}\n\nvoid iio_device_free(struct iio_dev *indio_dev);\nstruct iio_dev *devm_iio_device_alloc(struct device *parent, int sizeof_priv);\n\n#define devm_iio_trigger_alloc(parent, fmt, ...) \\\n\t__devm_iio_trigger_alloc((parent), THIS_MODULE, (fmt), ##__VA_ARGS__)\n__printf(3, 4)\nstruct iio_trigger *__devm_iio_trigger_alloc(struct device *parent,\n\t\t\t\t\t     struct module *this_mod,\n\t\t\t\t\t     const char *fmt, ...);\n \n#if defined(CONFIG_DEBUG_FS)\nstruct dentry *iio_get_debugfs_dentry(struct iio_dev *indio_dev);\n#else\nstatic inline struct dentry *iio_get_debugfs_dentry(struct iio_dev *indio_dev)\n{\n\treturn NULL;\n}\n#endif\n\nssize_t iio_format_value(char *buf, unsigned int type, int size, int *vals);\n\nint iio_str_to_fixpoint(const char *str, int fract_mult, int *integer,\n\tint *fract);\n\n \n#define IIO_DEGREE_TO_RAD(deg) (((deg) * 314159ULL + 9000000ULL) / 18000000ULL)\n\n \n#define IIO_RAD_TO_DEGREE(rad) \\\n\t(((rad) * 18000000ULL + 314159ULL / 2) / 314159ULL)\n\n \n#define IIO_G_TO_M_S_2(g) ((g) * 980665ULL / 100000ULL)\n\n \n#define IIO_M_S_2_TO_G(ms2) (((ms2) * 100000ULL + 980665ULL / 2) / 980665ULL)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}