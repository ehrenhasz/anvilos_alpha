{
  "module_name": "buffer-dma.h",
  "hash_id": "38f2343bc0044121355ae8100da0cc577c0c5cf54a9c72a4e8a2e5f0f49131f1",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/iio/buffer-dma.h",
  "human_readable_source": " \n \n\n#ifndef __INDUSTRIALIO_DMA_BUFFER_H__\n#define __INDUSTRIALIO_DMA_BUFFER_H__\n\n#include <linux/list.h>\n#include <linux/kref.h>\n#include <linux/spinlock.h>\n#include <linux/mutex.h>\n#include <linux/iio/buffer_impl.h>\n\nstruct iio_dma_buffer_queue;\nstruct iio_dma_buffer_ops;\nstruct device;\n\n \nenum iio_block_state {\n\tIIO_BLOCK_STATE_DEQUEUED,\n\tIIO_BLOCK_STATE_QUEUED,\n\tIIO_BLOCK_STATE_ACTIVE,\n\tIIO_BLOCK_STATE_DONE,\n\tIIO_BLOCK_STATE_DEAD,\n};\n\n \nstruct iio_dma_buffer_block {\n\t \n\tstruct list_head head;\n\tsize_t bytes_used;\n\n\t \n\tvoid *vaddr;\n\tdma_addr_t phys_addr;\n\tsize_t size;\n\tstruct iio_dma_buffer_queue *queue;\n\n\t \n\tstruct kref kref;\n\t \n\tenum iio_block_state state;\n};\n\n \nstruct iio_dma_buffer_queue_fileio {\n\tstruct iio_dma_buffer_block *blocks[2];\n\tstruct iio_dma_buffer_block *active_block;\n\tsize_t pos;\n\tsize_t block_size;\n};\n\n \nstruct iio_dma_buffer_queue {\n\tstruct iio_buffer buffer;\n\tstruct device *dev;\n\tconst struct iio_dma_buffer_ops *ops;\n\n\tstruct mutex lock;\n\tspinlock_t list_lock;\n\tstruct list_head incoming;\n\tstruct list_head outgoing;\n\n\tbool active;\n\n\tstruct iio_dma_buffer_queue_fileio fileio;\n};\n\n \nstruct iio_dma_buffer_ops {\n\tint (*submit)(struct iio_dma_buffer_queue *queue,\n\t\tstruct iio_dma_buffer_block *block);\n\tvoid (*abort)(struct iio_dma_buffer_queue *queue);\n};\n\nvoid iio_dma_buffer_block_done(struct iio_dma_buffer_block *block);\nvoid iio_dma_buffer_block_list_abort(struct iio_dma_buffer_queue *queue,\n\tstruct list_head *list);\n\nint iio_dma_buffer_enable(struct iio_buffer *buffer,\n\tstruct iio_dev *indio_dev);\nint iio_dma_buffer_disable(struct iio_buffer *buffer,\n\tstruct iio_dev *indio_dev);\nint iio_dma_buffer_read(struct iio_buffer *buffer, size_t n,\n\tchar __user *user_buffer);\nsize_t iio_dma_buffer_data_available(struct iio_buffer *buffer);\nint iio_dma_buffer_set_bytes_per_datum(struct iio_buffer *buffer, size_t bpd);\nint iio_dma_buffer_set_length(struct iio_buffer *buffer, unsigned int length);\nint iio_dma_buffer_request_update(struct iio_buffer *buffer);\n\nint iio_dma_buffer_init(struct iio_dma_buffer_queue *queue,\n\tstruct device *dma_dev, const struct iio_dma_buffer_ops *ops);\nvoid iio_dma_buffer_exit(struct iio_dma_buffer_queue *queue);\nvoid iio_dma_buffer_release(struct iio_dma_buffer_queue *queue);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}