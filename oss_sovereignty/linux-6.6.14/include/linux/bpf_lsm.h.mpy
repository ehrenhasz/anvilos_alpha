{
  "module_name": "bpf_lsm.h",
  "hash_id": "b9ae73e39022723d4bb665c1b287e5bf66c64ddc88d59f8c945acac873fa4b5f",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/bpf_lsm.h",
  "human_readable_source": " \n\n \n\n#ifndef _LINUX_BPF_LSM_H\n#define _LINUX_BPF_LSM_H\n\n#include <linux/sched.h>\n#include <linux/bpf.h>\n#include <linux/lsm_hooks.h>\n\n#ifdef CONFIG_BPF_LSM\n\n#define LSM_HOOK(RET, DEFAULT, NAME, ...) \\\n\tRET bpf_lsm_##NAME(__VA_ARGS__);\n#include <linux/lsm_hook_defs.h>\n#undef LSM_HOOK\n\nstruct bpf_storage_blob {\n\tstruct bpf_local_storage __rcu *storage;\n};\n\nextern struct lsm_blob_sizes bpf_lsm_blob_sizes;\n\nint bpf_lsm_verify_prog(struct bpf_verifier_log *vlog,\n\t\t\tconst struct bpf_prog *prog);\n\nbool bpf_lsm_is_sleepable_hook(u32 btf_id);\nbool bpf_lsm_is_trusted(const struct bpf_prog *prog);\n\nstatic inline struct bpf_storage_blob *bpf_inode(\n\tconst struct inode *inode)\n{\n\tif (unlikely(!inode->i_security))\n\t\treturn NULL;\n\n\treturn inode->i_security + bpf_lsm_blob_sizes.lbs_inode;\n}\n\nextern const struct bpf_func_proto bpf_inode_storage_get_proto;\nextern const struct bpf_func_proto bpf_inode_storage_delete_proto;\nvoid bpf_inode_storage_free(struct inode *inode);\n\nvoid bpf_lsm_find_cgroup_shim(const struct bpf_prog *prog, bpf_func_t *bpf_func);\n\n#else  \n\nstatic inline bool bpf_lsm_is_sleepable_hook(u32 btf_id)\n{\n\treturn false;\n}\n\nstatic inline bool bpf_lsm_is_trusted(const struct bpf_prog *prog)\n{\n\treturn false;\n}\n\nstatic inline int bpf_lsm_verify_prog(struct bpf_verifier_log *vlog,\n\t\t\t\t      const struct bpf_prog *prog)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline struct bpf_storage_blob *bpf_inode(\n\tconst struct inode *inode)\n{\n\treturn NULL;\n}\n\nstatic inline void bpf_inode_storage_free(struct inode *inode)\n{\n}\n\nstatic inline void bpf_lsm_find_cgroup_shim(const struct bpf_prog *prog,\n\t\t\t\t\t   bpf_func_t *bpf_func)\n{\n}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}