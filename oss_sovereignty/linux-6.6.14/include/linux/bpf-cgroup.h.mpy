{
  "module_name": "bpf-cgroup.h",
  "hash_id": "5444f94e8e89a73a773e89d4655292c1fdb43bef1020b668bb88d7f1720080c2",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/bpf-cgroup.h",
  "human_readable_source": " \n#ifndef _BPF_CGROUP_H\n#define _BPF_CGROUP_H\n\n#include <linux/bpf.h>\n#include <linux/bpf-cgroup-defs.h>\n#include <linux/errno.h>\n#include <linux/jump_label.h>\n#include <linux/percpu.h>\n#include <linux/rbtree.h>\n#include <net/sock.h>\n#include <uapi/linux/bpf.h>\n\nstruct sock;\nstruct sockaddr;\nstruct cgroup;\nstruct sk_buff;\nstruct bpf_map;\nstruct bpf_prog;\nstruct bpf_sock_ops_kern;\nstruct bpf_cgroup_storage;\nstruct ctl_table;\nstruct ctl_table_header;\nstruct task_struct;\n\nunsigned int __cgroup_bpf_run_lsm_sock(const void *ctx,\n\t\t\t\t       const struct bpf_insn *insn);\nunsigned int __cgroup_bpf_run_lsm_socket(const void *ctx,\n\t\t\t\t\t const struct bpf_insn *insn);\nunsigned int __cgroup_bpf_run_lsm_current(const void *ctx,\n\t\t\t\t\t  const struct bpf_insn *insn);\n\n#ifdef CONFIG_CGROUP_BPF\n\n#define CGROUP_ATYPE(type) \\\n\tcase BPF_##type: return type\n\nstatic inline enum cgroup_bpf_attach_type\nto_cgroup_bpf_attach_type(enum bpf_attach_type attach_type)\n{\n\tswitch (attach_type) {\n\tCGROUP_ATYPE(CGROUP_INET_INGRESS);\n\tCGROUP_ATYPE(CGROUP_INET_EGRESS);\n\tCGROUP_ATYPE(CGROUP_INET_SOCK_CREATE);\n\tCGROUP_ATYPE(CGROUP_SOCK_OPS);\n\tCGROUP_ATYPE(CGROUP_DEVICE);\n\tCGROUP_ATYPE(CGROUP_INET4_BIND);\n\tCGROUP_ATYPE(CGROUP_INET6_BIND);\n\tCGROUP_ATYPE(CGROUP_INET4_CONNECT);\n\tCGROUP_ATYPE(CGROUP_INET6_CONNECT);\n\tCGROUP_ATYPE(CGROUP_INET4_POST_BIND);\n\tCGROUP_ATYPE(CGROUP_INET6_POST_BIND);\n\tCGROUP_ATYPE(CGROUP_UDP4_SENDMSG);\n\tCGROUP_ATYPE(CGROUP_UDP6_SENDMSG);\n\tCGROUP_ATYPE(CGROUP_SYSCTL);\n\tCGROUP_ATYPE(CGROUP_UDP4_RECVMSG);\n\tCGROUP_ATYPE(CGROUP_UDP6_RECVMSG);\n\tCGROUP_ATYPE(CGROUP_GETSOCKOPT);\n\tCGROUP_ATYPE(CGROUP_SETSOCKOPT);\n\tCGROUP_ATYPE(CGROUP_INET4_GETPEERNAME);\n\tCGROUP_ATYPE(CGROUP_INET6_GETPEERNAME);\n\tCGROUP_ATYPE(CGROUP_INET4_GETSOCKNAME);\n\tCGROUP_ATYPE(CGROUP_INET6_GETSOCKNAME);\n\tCGROUP_ATYPE(CGROUP_INET_SOCK_RELEASE);\n\tdefault:\n\t\treturn CGROUP_BPF_ATTACH_TYPE_INVALID;\n\t}\n}\n\n#undef CGROUP_ATYPE\n\nextern struct static_key_false cgroup_bpf_enabled_key[MAX_CGROUP_BPF_ATTACH_TYPE];\n#define cgroup_bpf_enabled(atype) static_branch_unlikely(&cgroup_bpf_enabled_key[atype])\n\n#define for_each_cgroup_storage_type(stype) \\\n\tfor (stype = 0; stype < MAX_BPF_CGROUP_STORAGE_TYPE; stype++)\n\nstruct bpf_cgroup_storage_map;\n\nstruct bpf_storage_buffer {\n\tstruct rcu_head rcu;\n\tchar data[];\n};\n\nstruct bpf_cgroup_storage {\n\tunion {\n\t\tstruct bpf_storage_buffer *buf;\n\t\tvoid __percpu *percpu_buf;\n\t};\n\tstruct bpf_cgroup_storage_map *map;\n\tstruct bpf_cgroup_storage_key key;\n\tstruct list_head list_map;\n\tstruct list_head list_cg;\n\tstruct rb_node node;\n\tstruct rcu_head rcu;\n};\n\nstruct bpf_cgroup_link {\n\tstruct bpf_link link;\n\tstruct cgroup *cgroup;\n\tenum bpf_attach_type type;\n};\n\nstruct bpf_prog_list {\n\tstruct hlist_node node;\n\tstruct bpf_prog *prog;\n\tstruct bpf_cgroup_link *link;\n\tstruct bpf_cgroup_storage *storage[MAX_BPF_CGROUP_STORAGE_TYPE];\n};\n\nint cgroup_bpf_inherit(struct cgroup *cgrp);\nvoid cgroup_bpf_offline(struct cgroup *cgrp);\n\nint __cgroup_bpf_run_filter_skb(struct sock *sk,\n\t\t\t\tstruct sk_buff *skb,\n\t\t\t\tenum cgroup_bpf_attach_type atype);\n\nint __cgroup_bpf_run_filter_sk(struct sock *sk,\n\t\t\t       enum cgroup_bpf_attach_type atype);\n\nint __cgroup_bpf_run_filter_sock_addr(struct sock *sk,\n\t\t\t\t      struct sockaddr *uaddr,\n\t\t\t\t      enum cgroup_bpf_attach_type atype,\n\t\t\t\t      void *t_ctx,\n\t\t\t\t      u32 *flags);\n\nint __cgroup_bpf_run_filter_sock_ops(struct sock *sk,\n\t\t\t\t     struct bpf_sock_ops_kern *sock_ops,\n\t\t\t\t     enum cgroup_bpf_attach_type atype);\n\nint __cgroup_bpf_check_dev_permission(short dev_type, u32 major, u32 minor,\n\t\t\t\t      short access, enum cgroup_bpf_attach_type atype);\n\nint __cgroup_bpf_run_filter_sysctl(struct ctl_table_header *head,\n\t\t\t\t   struct ctl_table *table, int write,\n\t\t\t\t   char **buf, size_t *pcount, loff_t *ppos,\n\t\t\t\t   enum cgroup_bpf_attach_type atype);\n\nint __cgroup_bpf_run_filter_setsockopt(struct sock *sock, int *level,\n\t\t\t\t       int *optname, char __user *optval,\n\t\t\t\t       int *optlen, char **kernel_optval);\nint __cgroup_bpf_run_filter_getsockopt(struct sock *sk, int level,\n\t\t\t\t       int optname, char __user *optval,\n\t\t\t\t       int __user *optlen, int max_optlen,\n\t\t\t\t       int retval);\n\nint __cgroup_bpf_run_filter_getsockopt_kern(struct sock *sk, int level,\n\t\t\t\t\t    int optname, void *optval,\n\t\t\t\t\t    int *optlen, int retval);\n\nstatic inline enum bpf_cgroup_storage_type cgroup_storage_type(\n\tstruct bpf_map *map)\n{\n\tif (map->map_type == BPF_MAP_TYPE_PERCPU_CGROUP_STORAGE)\n\t\treturn BPF_CGROUP_STORAGE_PERCPU;\n\n\treturn BPF_CGROUP_STORAGE_SHARED;\n}\n\nstruct bpf_cgroup_storage *\ncgroup_storage_lookup(struct bpf_cgroup_storage_map *map,\n\t\t      void *key, bool locked);\nstruct bpf_cgroup_storage *bpf_cgroup_storage_alloc(struct bpf_prog *prog,\n\t\t\t\t\tenum bpf_cgroup_storage_type stype);\nvoid bpf_cgroup_storage_free(struct bpf_cgroup_storage *storage);\nvoid bpf_cgroup_storage_link(struct bpf_cgroup_storage *storage,\n\t\t\t     struct cgroup *cgroup,\n\t\t\t     enum bpf_attach_type type);\nvoid bpf_cgroup_storage_unlink(struct bpf_cgroup_storage *storage);\nint bpf_cgroup_storage_assign(struct bpf_prog_aux *aux, struct bpf_map *map);\n\nint bpf_percpu_cgroup_storage_copy(struct bpf_map *map, void *key, void *value);\nint bpf_percpu_cgroup_storage_update(struct bpf_map *map, void *key,\n\t\t\t\t     void *value, u64 flags);\n\n \nstatic inline bool cgroup_bpf_sock_enabled(struct sock *sk,\n\t\t\t\t\t   enum cgroup_bpf_attach_type type)\n{\n\tstruct cgroup *cgrp = sock_cgroup_ptr(&sk->sk_cgrp_data);\n\tstruct bpf_prog_array *array;\n\n\tarray = rcu_access_pointer(cgrp->bpf.effective[type]);\n\treturn array != &bpf_empty_prog_array.hdr;\n}\n\n \n#define BPF_CGROUP_RUN_PROG_INET_INGRESS(sk, skb)\t\t\t      \\\n({\t\t\t\t\t\t\t\t\t      \\\n\tint __ret = 0;\t\t\t\t\t\t\t      \\\n\tif (cgroup_bpf_enabled(CGROUP_INET_INGRESS) &&\t\t\t      \\\n\t    cgroup_bpf_sock_enabled(sk, CGROUP_INET_INGRESS))\t\t      \\\n\t\t__ret = __cgroup_bpf_run_filter_skb(sk, skb,\t\t      \\\n\t\t\t\t\t\t    CGROUP_INET_INGRESS); \\\n\t\t\t\t\t\t\t\t\t      \\\n\t__ret;\t\t\t\t\t\t\t\t      \\\n})\n\n#define BPF_CGROUP_RUN_PROG_INET_EGRESS(sk, skb)\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_INET_EGRESS) && sk) {\t\t       \\\n\t\ttypeof(sk) __sk = sk_to_full_sk(sk);\t\t\t       \\\n\t\tif (sk_fullsock(__sk) && __sk == skb_to_full_sk(skb) &&\t       \\\n\t\t    cgroup_bpf_sock_enabled(__sk, CGROUP_INET_EGRESS))\t       \\\n\t\t\t__ret = __cgroup_bpf_run_filter_skb(__sk, skb,\t       \\\n\t\t\t\t\t\t      CGROUP_INET_EGRESS); \\\n\t}\t\t\t\t\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_SK_PROG(sk, atype)\t\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(atype)) {\t\t\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_sk(sk, atype);\t\t       \\\n\t}\t\t\t\t\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_PROG_INET_SOCK(sk)\t\t\t\t       \\\n\tBPF_CGROUP_RUN_SK_PROG(sk, CGROUP_INET_SOCK_CREATE)\n\n#define BPF_CGROUP_RUN_PROG_INET_SOCK_RELEASE(sk)\t\t\t       \\\n\tBPF_CGROUP_RUN_SK_PROG(sk, CGROUP_INET_SOCK_RELEASE)\n\n#define BPF_CGROUP_RUN_PROG_INET4_POST_BIND(sk)\t\t\t\t       \\\n\tBPF_CGROUP_RUN_SK_PROG(sk, CGROUP_INET4_POST_BIND)\n\n#define BPF_CGROUP_RUN_PROG_INET6_POST_BIND(sk)\t\t\t\t       \\\n\tBPF_CGROUP_RUN_SK_PROG(sk, CGROUP_INET6_POST_BIND)\n\n#define BPF_CGROUP_RUN_SA_PROG(sk, uaddr, atype)\t\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(atype))\t\t\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_sock_addr(sk, uaddr, atype,     \\\n\t\t\t\t\t\t\t  NULL, NULL);\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, atype, t_ctx)\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(atype))\t{\t\t\t\t       \\\n\t\tlock_sock(sk);\t\t\t\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_sock_addr(sk, uaddr, atype,     \\\n\t\t\t\t\t\t\t  t_ctx, NULL);\t       \\\n\t\trelease_sock(sk);\t\t\t\t\t       \\\n\t}\t\t\t\t\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n \n#define BPF_CGROUP_RUN_PROG_INET_BIND_LOCK(sk, uaddr, atype, bind_flags)\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tu32 __flags = 0;\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(atype))\t{\t\t\t\t       \\\n\t\tlock_sock(sk);\t\t\t\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_sock_addr(sk, uaddr, atype,     \\\n\t\t\t\t\t\t\t  NULL, &__flags);     \\\n\t\trelease_sock(sk);\t\t\t\t\t       \\\n\t\tif (__flags & BPF_RET_BIND_NO_CAP_NET_BIND_SERVICE)\t       \\\n\t\t\t*bind_flags |= BIND_NO_CAP_NET_BIND_SERVICE;\t       \\\n\t}\t\t\t\t\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_PRE_CONNECT_ENABLED(sk)\t\t\t\t       \\\n\t((cgroup_bpf_enabled(CGROUP_INET4_CONNECT) ||\t\t       \\\n\t  cgroup_bpf_enabled(CGROUP_INET6_CONNECT)) &&\t\t       \\\n\t (sk)->sk_prot->pre_connect)\n\n#define BPF_CGROUP_RUN_PROG_INET4_CONNECT(sk, uaddr)\t\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG(sk, uaddr, CGROUP_INET4_CONNECT)\n\n#define BPF_CGROUP_RUN_PROG_INET6_CONNECT(sk, uaddr)\t\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG(sk, uaddr, CGROUP_INET6_CONNECT)\n\n#define BPF_CGROUP_RUN_PROG_INET4_CONNECT_LOCK(sk, uaddr)\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_INET4_CONNECT, NULL)\n\n#define BPF_CGROUP_RUN_PROG_INET6_CONNECT_LOCK(sk, uaddr)\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_INET6_CONNECT, NULL)\n\n#define BPF_CGROUP_RUN_PROG_UDP4_SENDMSG_LOCK(sk, uaddr, t_ctx)\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_UDP4_SENDMSG, t_ctx)\n\n#define BPF_CGROUP_RUN_PROG_UDP6_SENDMSG_LOCK(sk, uaddr, t_ctx)\t\t       \\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_UDP6_SENDMSG, t_ctx)\n\n#define BPF_CGROUP_RUN_PROG_UDP4_RECVMSG_LOCK(sk, uaddr)\t\t\t\\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_UDP4_RECVMSG, NULL)\n\n#define BPF_CGROUP_RUN_PROG_UDP6_RECVMSG_LOCK(sk, uaddr)\t\t\t\\\n\tBPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, CGROUP_UDP6_RECVMSG, NULL)\n\n \n#define BPF_CGROUP_RUN_PROG_SOCK_OPS_SK(sock_ops, sk)\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tint __ret = 0;\t\t\t\t\t\t\t\\\n\tif (cgroup_bpf_enabled(CGROUP_SOCK_OPS))\t\t\t\\\n\t\t__ret = __cgroup_bpf_run_filter_sock_ops(sk,\t\t\\\n\t\t\t\t\t\t\t sock_ops,\t\\\n\t\t\t\t\t\t\t CGROUP_SOCK_OPS); \\\n\t__ret;\t\t\t\t\t\t\t\t\\\n})\n\n#define BPF_CGROUP_RUN_PROG_SOCK_OPS(sock_ops)\t\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_SOCK_OPS) && (sock_ops)->sk) {       \\\n\t\ttypeof(sk) __sk = sk_to_full_sk((sock_ops)->sk);\t       \\\n\t\tif (__sk && sk_fullsock(__sk))\t\t\t\t       \\\n\t\t\t__ret = __cgroup_bpf_run_filter_sock_ops(__sk,\t       \\\n\t\t\t\t\t\t\t\t sock_ops,     \\\n\t\t\t\t\t\t\t CGROUP_SOCK_OPS); \\\n\t}\t\t\t\t\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_PROG_DEVICE_CGROUP(atype, major, minor, access)\t      \\\n({\t\t\t\t\t\t\t\t\t      \\\n\tint __ret = 0;\t\t\t\t\t\t\t      \\\n\tif (cgroup_bpf_enabled(CGROUP_DEVICE))\t\t\t      \\\n\t\t__ret = __cgroup_bpf_check_dev_permission(atype, major, minor, \\\n\t\t\t\t\t\t\t  access,\t      \\\n\t\t\t\t\t\t\t  CGROUP_DEVICE); \\\n\t\t\t\t\t\t\t\t\t      \\\n\t__ret;\t\t\t\t\t\t\t\t      \\\n})\n\n\n#define BPF_CGROUP_RUN_PROG_SYSCTL(head, table, write, buf, count, pos)  \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_SYSCTL))\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_sysctl(head, table, write,     \\\n\t\t\t\t\t\t       buf, count, pos,        \\\n\t\t\t\t\t\t       CGROUP_SYSCTL);     \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_PROG_SETSOCKOPT(sock, level, optname, optval, optlen,   \\\n\t\t\t\t       kernel_optval)\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_SETSOCKOPT) &&\t\t\t       \\\n\t    cgroup_bpf_sock_enabled(sock, CGROUP_SETSOCKOPT))\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_setsockopt(sock, level,\t       \\\n\t\t\t\t\t\t\t   optname, optval,    \\\n\t\t\t\t\t\t\t   optlen,\t       \\\n\t\t\t\t\t\t\t   kernel_optval);     \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_GETSOCKOPT_MAX_OPTLEN(optlen)\t\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = 0;\t\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_GETSOCKOPT))\t\t\t       \\\n\t\tget_user(__ret, optlen);\t\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_PROG_GETSOCKOPT(sock, level, optname, optval, optlen,   \\\n\t\t\t\t       max_optlen, retval)\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = retval;\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_GETSOCKOPT) &&\t\t\t       \\\n\t    cgroup_bpf_sock_enabled(sock, CGROUP_GETSOCKOPT))\t\t       \\\n\t\tif (!(sock)->sk_prot->bpf_bypass_getsockopt ||\t\t       \\\n\t\t    !INDIRECT_CALL_INET_1((sock)->sk_prot->bpf_bypass_getsockopt, \\\n\t\t\t\t\ttcp_bpf_bypass_getsockopt,\t       \\\n\t\t\t\t\tlevel, optname))\t\t       \\\n\t\t\t__ret = __cgroup_bpf_run_filter_getsockopt(\t       \\\n\t\t\t\tsock, level, optname, optval, optlen,\t       \\\n\t\t\t\tmax_optlen, retval);\t\t\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\n#define BPF_CGROUP_RUN_PROG_GETSOCKOPT_KERN(sock, level, optname, optval,      \\\n\t\t\t\t\t    optlen, retval)\t\t       \\\n({\t\t\t\t\t\t\t\t\t       \\\n\tint __ret = retval;\t\t\t\t\t\t       \\\n\tif (cgroup_bpf_enabled(CGROUP_GETSOCKOPT))\t\t\t       \\\n\t\t__ret = __cgroup_bpf_run_filter_getsockopt_kern(\t       \\\n\t\t\tsock, level, optname, optval, optlen, retval);\t       \\\n\t__ret;\t\t\t\t\t\t\t\t       \\\n})\n\nint cgroup_bpf_prog_attach(const union bpf_attr *attr,\n\t\t\t   enum bpf_prog_type ptype, struct bpf_prog *prog);\nint cgroup_bpf_prog_detach(const union bpf_attr *attr,\n\t\t\t   enum bpf_prog_type ptype);\nint cgroup_bpf_link_attach(const union bpf_attr *attr, struct bpf_prog *prog);\nint cgroup_bpf_prog_query(const union bpf_attr *attr,\n\t\t\t  union bpf_attr __user *uattr);\n\nconst struct bpf_func_proto *\ncgroup_common_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog);\nconst struct bpf_func_proto *\ncgroup_current_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog);\n#else\n\nstatic inline int cgroup_bpf_inherit(struct cgroup *cgrp) { return 0; }\nstatic inline void cgroup_bpf_offline(struct cgroup *cgrp) {}\n\nstatic inline int cgroup_bpf_prog_attach(const union bpf_attr *attr,\n\t\t\t\t\t enum bpf_prog_type ptype,\n\t\t\t\t\t struct bpf_prog *prog)\n{\n\treturn -EINVAL;\n}\n\nstatic inline int cgroup_bpf_prog_detach(const union bpf_attr *attr,\n\t\t\t\t\t enum bpf_prog_type ptype)\n{\n\treturn -EINVAL;\n}\n\nstatic inline int cgroup_bpf_link_attach(const union bpf_attr *attr,\n\t\t\t\t\t struct bpf_prog *prog)\n{\n\treturn -EINVAL;\n}\n\nstatic inline int cgroup_bpf_prog_query(const union bpf_attr *attr,\n\t\t\t\t\tunion bpf_attr __user *uattr)\n{\n\treturn -EINVAL;\n}\n\nstatic inline const struct bpf_func_proto *\ncgroup_common_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\treturn NULL;\n}\n\nstatic inline const struct bpf_func_proto *\ncgroup_current_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\treturn NULL;\n}\n\nstatic inline int bpf_cgroup_storage_assign(struct bpf_prog_aux *aux,\n\t\t\t\t\t    struct bpf_map *map) { return 0; }\nstatic inline struct bpf_cgroup_storage *bpf_cgroup_storage_alloc(\n\tstruct bpf_prog *prog, enum bpf_cgroup_storage_type stype) { return NULL; }\nstatic inline void bpf_cgroup_storage_free(\n\tstruct bpf_cgroup_storage *storage) {}\nstatic inline int bpf_percpu_cgroup_storage_copy(struct bpf_map *map, void *key,\n\t\t\t\t\t\t void *value) {\n\treturn 0;\n}\nstatic inline int bpf_percpu_cgroup_storage_update(struct bpf_map *map,\n\t\t\t\t\tvoid *key, void *value, u64 flags) {\n\treturn 0;\n}\n\n#define cgroup_bpf_enabled(atype) (0)\n#define BPF_CGROUP_RUN_SA_PROG_LOCK(sk, uaddr, atype, t_ctx) ({ 0; })\n#define BPF_CGROUP_RUN_SA_PROG(sk, uaddr, atype) ({ 0; })\n#define BPF_CGROUP_PRE_CONNECT_ENABLED(sk) (0)\n#define BPF_CGROUP_RUN_PROG_INET_INGRESS(sk,skb) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET_EGRESS(sk,skb) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET_SOCK(sk) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET_SOCK_RELEASE(sk) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET_BIND_LOCK(sk, uaddr, atype, flags) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET4_POST_BIND(sk) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET6_POST_BIND(sk) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET4_CONNECT(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET4_CONNECT_LOCK(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET6_CONNECT(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_INET6_CONNECT_LOCK(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_UDP4_SENDMSG_LOCK(sk, uaddr, t_ctx) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_UDP6_SENDMSG_LOCK(sk, uaddr, t_ctx) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_UDP4_RECVMSG_LOCK(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_UDP6_RECVMSG_LOCK(sk, uaddr) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_SOCK_OPS(sock_ops) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_DEVICE_CGROUP(atype, major, minor, access) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_SYSCTL(head,table,write,buf,count,pos) ({ 0; })\n#define BPF_CGROUP_GETSOCKOPT_MAX_OPTLEN(optlen) ({ 0; })\n#define BPF_CGROUP_RUN_PROG_GETSOCKOPT(sock, level, optname, optval, \\\n\t\t\t\t       optlen, max_optlen, retval) ({ retval; })\n#define BPF_CGROUP_RUN_PROG_GETSOCKOPT_KERN(sock, level, optname, optval, \\\n\t\t\t\t\t    optlen, retval) ({ retval; })\n#define BPF_CGROUP_RUN_PROG_SETSOCKOPT(sock, level, optname, optval, optlen, \\\n\t\t\t\t       kernel_optval) ({ 0; })\n\n#define for_each_cgroup_storage_type(stype) for (; false; )\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}