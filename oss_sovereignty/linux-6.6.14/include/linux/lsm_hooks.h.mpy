{
  "module_name": "lsm_hooks.h",
  "hash_id": "158d28f66438efae5c843dd580decf2809bbad4178a8228fbde504887e911a31",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/lsm_hooks.h",
  "human_readable_source": " \n\n#ifndef __LINUX_LSM_HOOKS_H\n#define __LINUX_LSM_HOOKS_H\n\n#include <linux/security.h>\n#include <linux/init.h>\n#include <linux/rculist.h>\n#include <linux/xattr.h>\n\nunion security_list_options {\n\t#define LSM_HOOK(RET, DEFAULT, NAME, ...) RET (*NAME)(__VA_ARGS__);\n\t#include \"lsm_hook_defs.h\"\n\t#undef LSM_HOOK\n};\n\nstruct security_hook_heads {\n\t#define LSM_HOOK(RET, DEFAULT, NAME, ...) struct hlist_head NAME;\n\t#include \"lsm_hook_defs.h\"\n\t#undef LSM_HOOK\n} __randomize_layout;\n\n \nstruct security_hook_list {\n\tstruct hlist_node\t\tlist;\n\tstruct hlist_head\t\t*head;\n\tunion security_list_options\thook;\n\tconst char\t\t\t*lsm;\n} __randomize_layout;\n\n \nstruct lsm_blob_sizes {\n\tint\tlbs_cred;\n\tint\tlbs_file;\n\tint\tlbs_inode;\n\tint\tlbs_superblock;\n\tint\tlbs_ipc;\n\tint\tlbs_msg_msg;\n\tint\tlbs_task;\n\tint\tlbs_xattr_count;  \n};\n\n \nstatic inline struct xattr *lsm_get_xattr_slot(struct xattr *xattrs,\n\t\t\t\t\t       int *xattr_count)\n{\n\tif (unlikely(!xattrs))\n\t\treturn NULL;\n\treturn &xattrs[(*xattr_count)++];\n}\n\n \n#define LSM_RET_VOID ((void) 0)\n\n \n#define LSM_HOOK_INIT(HEAD, HOOK) \\\n\t{ .head = &security_hook_heads.HEAD, .hook = { .HEAD = HOOK } }\n\nextern struct security_hook_heads security_hook_heads;\nextern char *lsm_names;\n\nextern void security_add_hooks(struct security_hook_list *hooks, int count,\n\t\t\t\tconst char *lsm);\n\n#define LSM_FLAG_LEGACY_MAJOR\tBIT(0)\n#define LSM_FLAG_EXCLUSIVE\tBIT(1)\n\nenum lsm_order {\n\tLSM_ORDER_FIRST = -1,\t \n\tLSM_ORDER_MUTABLE = 0,\n\tLSM_ORDER_LAST = 1,\t \n};\n\nstruct lsm_info {\n\tconst char *name;\t \n\tenum lsm_order order;\t \n\tunsigned long flags;\t \n\tint *enabled;\t\t \n\tint (*init)(void);\t \n\tstruct lsm_blob_sizes *blobs;  \n};\n\nextern struct lsm_info __start_lsm_info[], __end_lsm_info[];\nextern struct lsm_info __start_early_lsm_info[], __end_early_lsm_info[];\n\n#define DEFINE_LSM(lsm)\t\t\t\t\t\t\t\\\n\tstatic struct lsm_info __lsm_##lsm\t\t\t\t\\\n\t\t__used __section(\".lsm_info.init\")\t\t\t\\\n\t\t__aligned(sizeof(unsigned long))\n\n#define DEFINE_EARLY_LSM(lsm)\t\t\t\t\t\t\\\n\tstatic struct lsm_info __early_lsm_##lsm\t\t\t\\\n\t\t__used __section(\".early_lsm_info.init\")\t\t\\\n\t\t__aligned(sizeof(unsigned long))\n\nextern int lsm_inode_alloc(struct inode *inode);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}