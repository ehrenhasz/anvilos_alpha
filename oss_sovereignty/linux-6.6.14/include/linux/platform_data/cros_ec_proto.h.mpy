{
  "module_name": "cros_ec_proto.h",
  "hash_id": "dfaaeb61b5d08e7512f6ad994064f1f3c8d58d8431954c5ddbb0d913a0e61774",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/platform_data/cros_ec_proto.h",
  "human_readable_source": " \n \n\n#ifndef __LINUX_CROS_EC_PROTO_H\n#define __LINUX_CROS_EC_PROTO_H\n\n#include <linux/device.h>\n#include <linux/lockdep_types.h>\n#include <linux/mutex.h>\n#include <linux/notifier.h>\n\n#include <linux/platform_data/cros_ec_commands.h>\n\n#define CROS_EC_DEV_NAME\t\"cros_ec\"\n#define CROS_EC_DEV_FP_NAME\t\"cros_fp\"\n#define CROS_EC_DEV_ISH_NAME\t\"cros_ish\"\n#define CROS_EC_DEV_PD_NAME\t\"cros_pd\"\n#define CROS_EC_DEV_SCP_NAME\t\"cros_scp\"\n#define CROS_EC_DEV_TP_NAME\t\"cros_tp\"\n\n#define CROS_EC_DEV_EC_INDEX 0\n#define CROS_EC_DEV_PD_INDEX 1\n\n \n#define EC_REBOOT_DELAY_MS\t\t50\n\n \n#define EC_PROTO_VERSION_UNKNOWN\t0\n#define EC_MAX_REQUEST_OVERHEAD\t\t1\n#define EC_MAX_RESPONSE_OVERHEAD\t32\n\n \n#define ACPI_NOTIFY_CROS_EC_PANIC 0xB0\n\n \nenum {\n\tEC_MSG_TX_HEADER_BYTES\t= 3,\n\tEC_MSG_TX_TRAILER_BYTES\t= 1,\n\tEC_MSG_TX_PROTO_BYTES\t= EC_MSG_TX_HEADER_BYTES +\n\t\t\t\t  EC_MSG_TX_TRAILER_BYTES,\n\tEC_MSG_RX_PROTO_BYTES\t= 3,\n\n\t \n\tEC_PROTO2_MSG_BYTES\t= EC_PROTO2_MAX_PARAM_SIZE +\n\t\t\t\t  EC_MSG_TX_PROTO_BYTES,\n\n\tEC_MAX_MSG_BYTES\t= 64 * 1024,\n};\n\n \nstruct cros_ec_command {\n\tuint32_t version;\n\tuint32_t command;\n\tuint32_t outsize;\n\tuint32_t insize;\n\tuint32_t result;\n\tuint8_t data[];\n};\n\n \nstruct cros_ec_device {\n\t \n\tconst char *phys_name;\n\tstruct device *dev;\n\tstruct class *cros_class;\n\tint (*cmd_readmem)(struct cros_ec_device *ec, unsigned int offset,\n\t\t\t   unsigned int bytes, void *dest);\n\n\t \n\tu16 max_request;\n\tu16 max_response;\n\tu16 max_passthru;\n\tu16 proto_version;\n\tvoid *priv;\n\tint irq;\n\tu8 *din;\n\tu8 *dout;\n\tint din_size;\n\tint dout_size;\n\tbool wake_enabled;\n\tbool suspended;\n\tint (*cmd_xfer)(struct cros_ec_device *ec,\n\t\t\tstruct cros_ec_command *msg);\n\tint (*pkt_xfer)(struct cros_ec_device *ec,\n\t\t\tstruct cros_ec_command *msg);\n\tstruct lock_class_key lockdep_key;\n\tstruct mutex lock;\n\tu8 mkbp_event_supported;\n\tbool host_sleep_v1;\n\tstruct blocking_notifier_head event_notifier;\n\n\tstruct ec_response_get_next_event_v1 event_data;\n\tint event_size;\n\tu32 host_event_wake_mask;\n\tu32 last_resume_result;\n\tu16 suspend_timeout_ms;\n\tktime_t last_event_time;\n\tstruct notifier_block notifier_ready;\n\n\t \n\tstruct platform_device *ec;\n\tstruct platform_device *pd;\n\n\tstruct blocking_notifier_head panic_notifier;\n};\n\n \nstruct cros_ec_platform {\n\tconst char *ec_name;\n\tu16 cmd_offset;\n};\n\n \nstruct cros_ec_dev {\n\tstruct device class_dev;\n\tstruct cros_ec_device *ec_dev;\n\tstruct device *dev;\n\tstruct cros_ec_debugfs *debug_info;\n\tbool has_kb_wake_angle;\n\tu16 cmd_offset;\n\tstruct ec_response_get_features features;\n};\n\n#define to_cros_ec_dev(dev)  container_of(dev, struct cros_ec_dev, class_dev)\n\nint cros_ec_prepare_tx(struct cros_ec_device *ec_dev,\n\t\t       struct cros_ec_command *msg);\n\nint cros_ec_check_result(struct cros_ec_device *ec_dev,\n\t\t\t struct cros_ec_command *msg);\n\nint cros_ec_cmd_xfer(struct cros_ec_device *ec_dev,\n\t\t     struct cros_ec_command *msg);\n\nint cros_ec_cmd_xfer_status(struct cros_ec_device *ec_dev,\n\t\t\t    struct cros_ec_command *msg);\n\nint cros_ec_query_all(struct cros_ec_device *ec_dev);\n\nint cros_ec_get_next_event(struct cros_ec_device *ec_dev,\n\t\t\t   bool *wake_event,\n\t\t\t   bool *has_more_events);\n\nu32 cros_ec_get_host_event(struct cros_ec_device *ec_dev);\n\nbool cros_ec_check_features(struct cros_ec_dev *ec, int feature);\n\nint cros_ec_get_sensor_count(struct cros_ec_dev *ec);\n\nint cros_ec_cmd(struct cros_ec_device *ec_dev, unsigned int version, int command, void *outdata,\n\t\t    size_t outsize, void *indata, size_t insize);\n\n \nstatic inline ktime_t cros_ec_get_time_ns(void)\n{\n\treturn ktime_get_boottime_ns();\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}