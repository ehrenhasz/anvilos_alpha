{
  "module_name": "cros_ec_sensorhub.h",
  "hash_id": "f17a0f33bb42b4cedc16756e915e10a860869e24de81498e276aa1585a76e26c",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/platform_data/cros_ec_sensorhub.h",
  "human_readable_source": " \n \n\n#ifndef __LINUX_PLATFORM_DATA_CROS_EC_SENSORHUB_H\n#define __LINUX_PLATFORM_DATA_CROS_EC_SENSORHUB_H\n\n#include <linux/ktime.h>\n#include <linux/mutex.h>\n#include <linux/notifier.h>\n#include <linux/platform_data/cros_ec_commands.h>\n\nstruct iio_dev;\n\n \nstruct cros_ec_sensor_platform {\n\tu8 sensor_num;\n};\n\n \ntypedef int (*cros_ec_sensorhub_push_data_cb_t)(struct iio_dev *indio_dev,\n\t\t\t\t\t\ts16 *data,\n\t\t\t\t\t\ts64 timestamp);\n\nstruct cros_ec_sensorhub_sensor_push_data {\n\tstruct iio_dev *indio_dev;\n\tcros_ec_sensorhub_push_data_cb_t push_data_cb;\n};\n\nenum {\n\tCROS_EC_SENSOR_LAST_TS,\n\tCROS_EC_SENSOR_NEW_TS,\n\tCROS_EC_SENSOR_ALL_TS\n};\n\nstruct cros_ec_sensors_ring_sample {\n\tu8  sensor_id;\n\tu8  flag;\n\ts16 vector[3];\n\ts64 timestamp;\n} __packed;\n\n \nstruct cros_ec_sensors_ec_overflow_state {\n\ts64 offset;\n\ts64 last;\n};\n\n \n#define CROS_EC_SENSORHUB_TS_HISTORY_SIZE 64\n\n \nstruct cros_ec_sensors_ts_filter_state {\n\ts64 x_offset, y_offset;\n\ts64 x_history[CROS_EC_SENSORHUB_TS_HISTORY_SIZE];\n\ts64 y_history[CROS_EC_SENSORHUB_TS_HISTORY_SIZE];\n\ts64 m_history[CROS_EC_SENSORHUB_TS_HISTORY_SIZE];\n\tint history_len;\n\n\ts64 temp_buf[CROS_EC_SENSORHUB_TS_HISTORY_SIZE];\n\n\ts64 median_m;\n\ts64 median_error;\n};\n\n \nstruct cros_ec_sensors_ts_batch_state {\n\ts64 penul_ts;\n\tint penul_len;\n\ts64 last_ts;\n\tint last_len;\n\ts64 newest_sensor_event;\n};\n\n \nstruct cros_ec_sensorhub {\n\tstruct device *dev;\n\tstruct cros_ec_dev *ec;\n\tint sensor_num;\n\n\tstruct cros_ec_command *msg;\n\tstruct ec_params_motion_sense *params;\n\tstruct ec_response_motion_sense *resp;\n\tstruct mutex cmd_lock;   \n\n\tstruct notifier_block notifier;\n\n\tstruct cros_ec_sensors_ring_sample *ring;\n\n\tktime_t fifo_timestamp[CROS_EC_SENSOR_ALL_TS];\n\tstruct ec_response_motion_sense_fifo_info *fifo_info;\n\tint fifo_size;\n\n\tstruct cros_ec_sensors_ts_batch_state *batch_state;\n\n\tstruct cros_ec_sensors_ec_overflow_state overflow_a;\n\tstruct cros_ec_sensors_ec_overflow_state overflow_b;\n\n\tstruct cros_ec_sensors_ts_filter_state filter;\n\n\tint tight_timestamps;\n\n\ts32 future_timestamp_count;\n\ts64 future_timestamp_total_ns;\n\n\tstruct cros_ec_sensorhub_sensor_push_data *push_data;\n};\n\nint cros_ec_sensorhub_register_push_data(struct cros_ec_sensorhub *sensorhub,\n\t\t\t\t\t u8 sensor_num,\n\t\t\t\t\t struct iio_dev *indio_dev,\n\t\t\t\t\t cros_ec_sensorhub_push_data_cb_t cb);\n\nvoid cros_ec_sensorhub_unregister_push_data(struct cros_ec_sensorhub *sensorhub,\n\t\t\t\t\t    u8 sensor_num);\n\nint cros_ec_sensorhub_ring_allocate(struct cros_ec_sensorhub *sensorhub);\nint cros_ec_sensorhub_ring_add(struct cros_ec_sensorhub *sensorhub);\nvoid cros_ec_sensorhub_ring_remove(void *arg);\nint cros_ec_sensorhub_ring_fifo_enable(struct cros_ec_sensorhub *sensorhub,\n\t\t\t\t       bool on);\n\n#endif    \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}