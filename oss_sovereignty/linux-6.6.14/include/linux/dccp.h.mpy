{
  "module_name": "dccp.h",
  "hash_id": "ecd18d55ae70595b536584fe6885d1dfe84bfeef15828e6650012a7a344f9a59",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/dccp.h",
  "human_readable_source": " \n#ifndef _LINUX_DCCP_H\n#define _LINUX_DCCP_H\n\n\n#include <linux/in.h>\n#include <linux/interrupt.h>\n#include <linux/ktime.h>\n#include <linux/list.h>\n#include <linux/uio.h>\n#include <linux/workqueue.h>\n\n#include <net/inet_connection_sock.h>\n#include <net/inet_sock.h>\n#include <net/inet_timewait_sock.h>\n#include <net/tcp_states.h>\n#include <uapi/linux/dccp.h>\n\nenum dccp_state {\n\tDCCP_OPEN\t     = TCP_ESTABLISHED,\n\tDCCP_REQUESTING\t     = TCP_SYN_SENT,\n\tDCCP_LISTEN\t     = TCP_LISTEN,\n\tDCCP_RESPOND\t     = TCP_SYN_RECV,\n\t \n\tDCCP_ACTIVE_CLOSEREQ = TCP_FIN_WAIT1,\n\tDCCP_PASSIVE_CLOSE   = TCP_CLOSE_WAIT,\t \n\tDCCP_CLOSING\t     = TCP_CLOSING,\n\tDCCP_TIME_WAIT\t     = TCP_TIME_WAIT,\n\tDCCP_CLOSED\t     = TCP_CLOSE,\n\tDCCP_NEW_SYN_RECV    = TCP_NEW_SYN_RECV,\n\tDCCP_PARTOPEN\t     = TCP_MAX_STATES,\n\tDCCP_PASSIVE_CLOSEREQ,\t\t\t \n\tDCCP_MAX_STATES\n};\n\nenum {\n\tDCCPF_OPEN\t      = TCPF_ESTABLISHED,\n\tDCCPF_REQUESTING      = TCPF_SYN_SENT,\n\tDCCPF_LISTEN\t      = TCPF_LISTEN,\n\tDCCPF_RESPOND\t      = TCPF_SYN_RECV,\n\tDCCPF_ACTIVE_CLOSEREQ = TCPF_FIN_WAIT1,\n\tDCCPF_CLOSING\t      = TCPF_CLOSING,\n\tDCCPF_TIME_WAIT\t      = TCPF_TIME_WAIT,\n\tDCCPF_CLOSED\t      = TCPF_CLOSE,\n\tDCCPF_NEW_SYN_RECV    = TCPF_NEW_SYN_RECV,\n\tDCCPF_PARTOPEN\t      = (1 << DCCP_PARTOPEN),\n};\n\nstatic inline struct dccp_hdr *dccp_hdr(const struct sk_buff *skb)\n{\n\treturn (struct dccp_hdr *)skb_transport_header(skb);\n}\n\nstatic inline struct dccp_hdr *dccp_zeroed_hdr(struct sk_buff *skb, int headlen)\n{\n\tskb_push(skb, headlen);\n\tskb_reset_transport_header(skb);\n\treturn memset(skb_transport_header(skb), 0, headlen);\n}\n\nstatic inline struct dccp_hdr_ext *dccp_hdrx(const struct dccp_hdr *dh)\n{\n\treturn (struct dccp_hdr_ext *)((unsigned char *)dh + sizeof(*dh));\n}\n\nstatic inline unsigned int __dccp_basic_hdr_len(const struct dccp_hdr *dh)\n{\n\treturn sizeof(*dh) + (dh->dccph_x ? sizeof(struct dccp_hdr_ext) : 0);\n}\n\nstatic inline unsigned int dccp_basic_hdr_len(const struct sk_buff *skb)\n{\n\tconst struct dccp_hdr *dh = dccp_hdr(skb);\n\treturn __dccp_basic_hdr_len(dh);\n}\n\nstatic inline __u64 dccp_hdr_seq(const struct dccp_hdr *dh)\n{\n\t__u64 seq_nr =  ntohs(dh->dccph_seq);\n\n\tif (dh->dccph_x != 0)\n\t\tseq_nr = (seq_nr << 32) + ntohl(dccp_hdrx(dh)->dccph_seq_low);\n\telse\n\t\tseq_nr += (u32)dh->dccph_seq2 << 16;\n\n\treturn seq_nr;\n}\n\nstatic inline struct dccp_hdr_request *dccp_hdr_request(struct sk_buff *skb)\n{\n\treturn (struct dccp_hdr_request *)(skb_transport_header(skb) +\n\t\t\t\t\t   dccp_basic_hdr_len(skb));\n}\n\nstatic inline struct dccp_hdr_ack_bits *dccp_hdr_ack_bits(const struct sk_buff *skb)\n{\n\treturn (struct dccp_hdr_ack_bits *)(skb_transport_header(skb) +\n\t\t\t\t\t    dccp_basic_hdr_len(skb));\n}\n\nstatic inline u64 dccp_hdr_ack_seq(const struct sk_buff *skb)\n{\n\tconst struct dccp_hdr_ack_bits *dhack = dccp_hdr_ack_bits(skb);\n\treturn ((u64)ntohs(dhack->dccph_ack_nr_high) << 32) + ntohl(dhack->dccph_ack_nr_low);\n}\n\nstatic inline struct dccp_hdr_response *dccp_hdr_response(struct sk_buff *skb)\n{\n\treturn (struct dccp_hdr_response *)(skb_transport_header(skb) +\n\t\t\t\t\t    dccp_basic_hdr_len(skb));\n}\n\nstatic inline struct dccp_hdr_reset *dccp_hdr_reset(struct sk_buff *skb)\n{\n\treturn (struct dccp_hdr_reset *)(skb_transport_header(skb) +\n\t\t\t\t\t dccp_basic_hdr_len(skb));\n}\n\nstatic inline unsigned int __dccp_hdr_len(const struct dccp_hdr *dh)\n{\n\treturn __dccp_basic_hdr_len(dh) +\n\t       dccp_packet_hdr_len(dh->dccph_type);\n}\n\nstatic inline unsigned int dccp_hdr_len(const struct sk_buff *skb)\n{\n\treturn __dccp_hdr_len(dccp_hdr(skb));\n}\n\n \nstruct dccp_request_sock {\n\tstruct inet_request_sock dreq_inet_rsk;\n\t__u64\t\t\t dreq_iss;\n\t__u64\t\t\t dreq_gss;\n\t__u64\t\t\t dreq_isr;\n\t__u64\t\t\t dreq_gsr;\n\t__be32\t\t\t dreq_service;\n\tspinlock_t\t\t dreq_lock;\n\tstruct list_head\t dreq_featneg;\n\t__u32\t\t\t dreq_timestamp_echo;\n\t__u32\t\t\t dreq_timestamp_time;\n};\n\nstatic inline struct dccp_request_sock *dccp_rsk(const struct request_sock *req)\n{\n\treturn (struct dccp_request_sock *)req;\n}\n\nextern struct inet_timewait_death_row dccp_death_row;\n\nextern int dccp_parse_options(struct sock *sk, struct dccp_request_sock *dreq,\n\t\t\t      struct sk_buff *skb);\n\nstruct dccp_options_received {\n\tu64\tdccpor_ndp:48;\n\tu32\tdccpor_timestamp;\n\tu32\tdccpor_timestamp_echo;\n\tu32\tdccpor_elapsed_time;\n};\n\nstruct ccid;\n\nenum dccp_role {\n\tDCCP_ROLE_UNDEFINED,\n\tDCCP_ROLE_LISTEN,\n\tDCCP_ROLE_CLIENT,\n\tDCCP_ROLE_SERVER,\n};\n\nstruct dccp_service_list {\n\t__u32\tdccpsl_nr;\n\t__be32\tdccpsl_list[];\n};\n\n#define DCCP_SERVICE_INVALID_VALUE htonl((__u32)-1)\n#define DCCP_SERVICE_CODE_IS_ABSENT\t\t0\n\nstatic inline bool dccp_list_has_service(const struct dccp_service_list *sl,\n\t\t\t\t\tconst __be32 service)\n{\n\tif (likely(sl != NULL)) {\n\t\tu32 i = sl->dccpsl_nr;\n\t\twhile (i--)\n\t\t\tif (sl->dccpsl_list[i] == service)\n\t\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nstruct dccp_ackvec;\n\n \nstruct dccp_sock {\n\t \n\tstruct inet_connection_sock\tdccps_inet_connection;\n#define dccps_syn_rtt\t\t\tdccps_inet_connection.icsk_ack.lrcvtime\n\t__u64\t\t\t\tdccps_swl;\n\t__u64\t\t\t\tdccps_swh;\n\t__u64\t\t\t\tdccps_awl;\n\t__u64\t\t\t\tdccps_awh;\n\t__u64\t\t\t\tdccps_iss;\n\t__u64\t\t\t\tdccps_isr;\n\t__u64\t\t\t\tdccps_osr;\n\t__u64\t\t\t\tdccps_gss;\n\t__u64\t\t\t\tdccps_gsr;\n\t__u64\t\t\t\tdccps_gar;\n\t__be32\t\t\t\tdccps_service;\n\t__u32\t\t\t\tdccps_mss_cache;\n\tstruct dccp_service_list\t*dccps_service_list;\n\t__u32\t\t\t\tdccps_timestamp_echo;\n\t__u32\t\t\t\tdccps_timestamp_time;\n\t__u16\t\t\t\tdccps_l_ack_ratio;\n\t__u16\t\t\t\tdccps_r_ack_ratio;\n\t__u64\t\t\t\tdccps_l_seq_win:48;\n\t__u64\t\t\t\tdccps_r_seq_win:48;\n\t__u8\t\t\t\tdccps_pcslen:4;\n\t__u8\t\t\t\tdccps_pcrlen:4;\n\t__u8\t\t\t\tdccps_send_ndp_count:1;\n\t__u64\t\t\t\tdccps_ndp_count:48;\n\tunsigned long\t\t\tdccps_rate_last;\n\tstruct list_head\t\tdccps_featneg;\n\tstruct dccp_ackvec\t\t*dccps_hc_rx_ackvec;\n\tstruct ccid\t\t\t*dccps_hc_rx_ccid;\n\tstruct ccid\t\t\t*dccps_hc_tx_ccid;\n\tstruct dccp_options_received\tdccps_options_received;\n\t__u8\t\t\t\tdccps_qpolicy;\n\t__u32\t\t\t\tdccps_tx_qlen;\n\tenum dccp_role\t\t\tdccps_role:2;\n\t__u8\t\t\t\tdccps_hc_rx_insert_options:1;\n\t__u8\t\t\t\tdccps_hc_tx_insert_options:1;\n\t__u8\t\t\t\tdccps_server_timewait:1;\n\t__u8\t\t\t\tdccps_sync_scheduled:1;\n\tstruct tasklet_struct\t\tdccps_xmitlet;\n\tstruct timer_list\t\tdccps_xmit_timer;\n};\n\n#define dccp_sk(ptr)\tcontainer_of_const(ptr, struct dccp_sock, \\\n\t\t\t\t\t   dccps_inet_connection.icsk_inet.sk)\n\nstatic inline const char *dccp_role(const struct sock *sk)\n{\n\tswitch (dccp_sk(sk)->dccps_role) {\n\tcase DCCP_ROLE_UNDEFINED: return \"undefined\";\n\tcase DCCP_ROLE_LISTEN:\t  return \"listen\";\n\tcase DCCP_ROLE_SERVER:\t  return \"server\";\n\tcase DCCP_ROLE_CLIENT:\t  return \"client\";\n\t}\n\treturn NULL;\n}\n\nextern void dccp_syn_ack_timeout(const struct request_sock *req);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}