{
  "module_name": "if_pppox.h",
  "hash_id": "5f426139353eebccedd60d9305208d63bf001f9a5eef565676bc5ccea75fd3b6",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/if_pppox.h",
  "human_readable_source": " \n \n#ifndef __LINUX_IF_PPPOX_H\n#define __LINUX_IF_PPPOX_H\n\n#include <linux/if.h>\n#include <linux/netdevice.h>\n#include <linux/ppp_channel.h>\n#include <linux/skbuff.h>\n#include <linux/workqueue.h>\n#include <uapi/linux/if_pppox.h>\n\nstatic inline struct pppoe_hdr *pppoe_hdr(const struct sk_buff *skb)\n{\n\treturn (struct pppoe_hdr *)skb_network_header(skb);\n}\n\nstruct pppoe_opt {\n\tstruct net_device      *dev;\t   \n\tint\t\t\tifindex;   \n\tstruct pppoe_addr\tpa;\t   \n\tstruct sockaddr_pppox\trelay;\t   \n\tstruct work_struct      padt_work; \n};\n\nstruct pptp_opt {\n\tstruct pptp_addr src_addr;\n\tstruct pptp_addr dst_addr;\n\tu32 ack_sent, ack_recv;\n\tu32 seq_sent, seq_recv;\n\tint ppp_flags;\n};\n#include <net/sock.h>\n\nstruct pppox_sock {\n\t \n\tstruct sock sk;\n\tstruct ppp_channel chan;\n\tstruct pppox_sock\t*next;\t   \n\tunion {\n\t\tstruct pppoe_opt pppoe;\n\t\tstruct pptp_opt  pptp;\n\t} proto;\n\t__be16\t\t\tnum;\n};\n#define pppoe_dev\tproto.pppoe.dev\n#define pppoe_ifindex\tproto.pppoe.ifindex\n#define pppoe_pa\tproto.pppoe.pa\n#define pppoe_relay\tproto.pppoe.relay\n\nstatic inline struct pppox_sock *pppox_sk(struct sock *sk)\n{\n\treturn (struct pppox_sock *)sk;\n}\n\nstatic inline struct sock *sk_pppox(struct pppox_sock *po)\n{\n\treturn (struct sock *)po;\n}\n\nstruct module;\n\nstruct pppox_proto {\n\tint\t\t(*create)(struct net *net, struct socket *sock, int kern);\n\tint\t\t(*ioctl)(struct socket *sock, unsigned int cmd,\n\t\t\t\t unsigned long arg);\n\tstruct module\t*owner;\n};\n\nextern int register_pppox_proto(int proto_num, const struct pppox_proto *pp);\nextern void unregister_pppox_proto(int proto_num);\nextern void pppox_unbind_sock(struct sock *sk); \nextern int pppox_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg);\nextern int pppox_compat_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg);\n\n#define PPPOEIOCSFWD32    _IOW(0xB1 ,0, compat_size_t)\n\n \nenum {\n    PPPOX_NONE\t\t= 0,   \n    PPPOX_CONNECTED\t= 1,   \n    PPPOX_BOUND\t\t= 2,   \n    PPPOX_RELAY\t\t= 4,   \n    PPPOX_DEAD\t\t= 16   \n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}