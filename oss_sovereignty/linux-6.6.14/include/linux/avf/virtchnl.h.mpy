{
  "module_name": "virtchnl.h",
  "hash_id": "4d252145e558cb31b8e979668297fef6c8135d29b93d7824946ae2847882e15a",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/avf/virtchnl.h",
  "human_readable_source": " \n \n\n#ifndef _VIRTCHNL_H_\n#define _VIRTCHNL_H_\n\n \n\n \n\n \nenum virtchnl_status_code {\n\tVIRTCHNL_STATUS_SUCCESS\t\t\t\t= 0,\n\tVIRTCHNL_STATUS_ERR_PARAM\t\t\t= -5,\n\tVIRTCHNL_STATUS_ERR_NO_MEMORY\t\t\t= -18,\n\tVIRTCHNL_STATUS_ERR_OPCODE_MISMATCH\t\t= -38,\n\tVIRTCHNL_STATUS_ERR_CQP_COMPL_ERROR\t\t= -39,\n\tVIRTCHNL_STATUS_ERR_INVALID_VF_ID\t\t= -40,\n\tVIRTCHNL_STATUS_ERR_ADMIN_QUEUE_ERROR\t\t= -53,\n\tVIRTCHNL_STATUS_ERR_NOT_SUPPORTED\t\t= -64,\n};\n\n \n#define VIRTCHNL_ERR_PARAM VIRTCHNL_STATUS_ERR_PARAM\n#define VIRTCHNL_STATUS_NOT_SUPPORTED VIRTCHNL_STATUS_ERR_NOT_SUPPORTED\n\n#define VIRTCHNL_LINK_SPEED_2_5GB_SHIFT\t\t0x0\n#define VIRTCHNL_LINK_SPEED_100MB_SHIFT\t\t0x1\n#define VIRTCHNL_LINK_SPEED_1000MB_SHIFT\t0x2\n#define VIRTCHNL_LINK_SPEED_10GB_SHIFT\t\t0x3\n#define VIRTCHNL_LINK_SPEED_40GB_SHIFT\t\t0x4\n#define VIRTCHNL_LINK_SPEED_20GB_SHIFT\t\t0x5\n#define VIRTCHNL_LINK_SPEED_25GB_SHIFT\t\t0x6\n#define VIRTCHNL_LINK_SPEED_5GB_SHIFT\t\t0x7\n\nenum virtchnl_link_speed {\n\tVIRTCHNL_LINK_SPEED_UNKNOWN\t= 0,\n\tVIRTCHNL_LINK_SPEED_100MB\t= BIT(VIRTCHNL_LINK_SPEED_100MB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_1GB\t\t= BIT(VIRTCHNL_LINK_SPEED_1000MB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_10GB\t= BIT(VIRTCHNL_LINK_SPEED_10GB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_40GB\t= BIT(VIRTCHNL_LINK_SPEED_40GB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_20GB\t= BIT(VIRTCHNL_LINK_SPEED_20GB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_25GB\t= BIT(VIRTCHNL_LINK_SPEED_25GB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_2_5GB\t= BIT(VIRTCHNL_LINK_SPEED_2_5GB_SHIFT),\n\tVIRTCHNL_LINK_SPEED_5GB\t\t= BIT(VIRTCHNL_LINK_SPEED_5GB_SHIFT),\n};\n\n \n \nenum virtchnl_rx_hsplit {\n\tVIRTCHNL_RX_HSPLIT_NO_SPLIT      = 0,\n\tVIRTCHNL_RX_HSPLIT_SPLIT_L2      = 1,\n\tVIRTCHNL_RX_HSPLIT_SPLIT_IP      = 2,\n\tVIRTCHNL_RX_HSPLIT_SPLIT_TCP_UDP = 4,\n\tVIRTCHNL_RX_HSPLIT_SPLIT_SCTP    = 8,\n};\n\n \n\n \nenum virtchnl_ops {\n \n\tVIRTCHNL_OP_UNKNOWN = 0,\n\tVIRTCHNL_OP_VERSION = 1,  \n\tVIRTCHNL_OP_RESET_VF = 2,\n\tVIRTCHNL_OP_GET_VF_RESOURCES = 3,\n\tVIRTCHNL_OP_CONFIG_TX_QUEUE = 4,\n\tVIRTCHNL_OP_CONFIG_RX_QUEUE = 5,\n\tVIRTCHNL_OP_CONFIG_VSI_QUEUES = 6,\n\tVIRTCHNL_OP_CONFIG_IRQ_MAP = 7,\n\tVIRTCHNL_OP_ENABLE_QUEUES = 8,\n\tVIRTCHNL_OP_DISABLE_QUEUES = 9,\n\tVIRTCHNL_OP_ADD_ETH_ADDR = 10,\n\tVIRTCHNL_OP_DEL_ETH_ADDR = 11,\n\tVIRTCHNL_OP_ADD_VLAN = 12,\n\tVIRTCHNL_OP_DEL_VLAN = 13,\n\tVIRTCHNL_OP_CONFIG_PROMISCUOUS_MODE = 14,\n\tVIRTCHNL_OP_GET_STATS = 15,\n\tVIRTCHNL_OP_RSVD = 16,\n\tVIRTCHNL_OP_EVENT = 17,  \n\t \n\tVIRTCHNL_OP_IWARP = 20,  \n\tVIRTCHNL_OP_RDMA = VIRTCHNL_OP_IWARP,\n\tVIRTCHNL_OP_CONFIG_IWARP_IRQ_MAP = 21,  \n\tVIRTCHNL_OP_CONFIG_RDMA_IRQ_MAP = VIRTCHNL_OP_CONFIG_IWARP_IRQ_MAP,\n\tVIRTCHNL_OP_RELEASE_IWARP_IRQ_MAP = 22,  \n\tVIRTCHNL_OP_RELEASE_RDMA_IRQ_MAP = VIRTCHNL_OP_RELEASE_IWARP_IRQ_MAP,\n\tVIRTCHNL_OP_CONFIG_RSS_KEY = 23,\n\tVIRTCHNL_OP_CONFIG_RSS_LUT = 24,\n\tVIRTCHNL_OP_GET_RSS_HENA_CAPS = 25,\n\tVIRTCHNL_OP_SET_RSS_HENA = 26,\n\tVIRTCHNL_OP_ENABLE_VLAN_STRIPPING = 27,\n\tVIRTCHNL_OP_DISABLE_VLAN_STRIPPING = 28,\n\tVIRTCHNL_OP_REQUEST_QUEUES = 29,\n\tVIRTCHNL_OP_ENABLE_CHANNELS = 30,\n\tVIRTCHNL_OP_DISABLE_CHANNELS = 31,\n\tVIRTCHNL_OP_ADD_CLOUD_FILTER = 32,\n\tVIRTCHNL_OP_DEL_CLOUD_FILTER = 33,\n\t \n\tVIRTCHNL_OP_GET_SUPPORTED_RXDIDS = 44,\n\tVIRTCHNL_OP_ADD_RSS_CFG = 45,\n\tVIRTCHNL_OP_DEL_RSS_CFG = 46,\n\tVIRTCHNL_OP_ADD_FDIR_FILTER = 47,\n\tVIRTCHNL_OP_DEL_FDIR_FILTER = 48,\n\tVIRTCHNL_OP_GET_OFFLOAD_VLAN_V2_CAPS = 51,\n\tVIRTCHNL_OP_ADD_VLAN_V2 = 52,\n\tVIRTCHNL_OP_DEL_VLAN_V2 = 53,\n\tVIRTCHNL_OP_ENABLE_VLAN_STRIPPING_V2 = 54,\n\tVIRTCHNL_OP_DISABLE_VLAN_STRIPPING_V2 = 55,\n\tVIRTCHNL_OP_ENABLE_VLAN_INSERTION_V2 = 56,\n\tVIRTCHNL_OP_DISABLE_VLAN_INSERTION_V2 = 57,\n\tVIRTCHNL_OP_MAX,\n};\n\n \n#define VIRTCHNL_CHECK_STRUCT_LEN(n, X) enum virtchnl_static_assert_enum_##X \\\n\t{ virtchnl_static_assert_##X = (n)/((sizeof(struct X) == (n)) ? 1 : 0) }\n#define VIRTCHNL_CHECK_UNION_LEN(n, X) enum virtchnl_static_asset_enum_##X \\\n\t{ virtchnl_static_assert_##X = (n)/((sizeof(union X) == (n)) ? 1 : 0) }\n\n \n\n \n#define VIRTCHNL_VERSION_MAJOR\t\t1\n#define VIRTCHNL_VERSION_MINOR\t\t1\n#define VIRTCHNL_VERSION_MINOR_NO_VF_CAPS\t0\n\nstruct virtchnl_version_info {\n\tu32 major;\n\tu32 minor;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_version_info);\n\n#define VF_IS_V10(_v) (((_v)->major == 1) && ((_v)->minor == 0))\n#define VF_IS_V11(_ver) (((_ver)->major == 1) && ((_ver)->minor == 1))\n\n \n\n \nenum virtchnl_vsi_type {\n\tVIRTCHNL_VSI_TYPE_INVALID = 0,\n\tVIRTCHNL_VSI_SRIOV = 6,\n};\n\n \n\nstruct virtchnl_vsi_resource {\n\tu16 vsi_id;\n\tu16 num_queue_pairs;\n\n\t \n\ts32 vsi_type;\n\tu16 qset_handle;\n\tu8 default_mac_addr[ETH_ALEN];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(16, virtchnl_vsi_resource);\n\n \n#define VIRTCHNL_VF_OFFLOAD_L2\t\t\tBIT(0)\n#define VIRTCHNL_VF_OFFLOAD_RDMA\t\tBIT(1)\n#define VIRTCHNL_VF_CAP_RDMA\t\t\tVIRTCHNL_VF_OFFLOAD_RDMA\n#define VIRTCHNL_VF_OFFLOAD_RSS_AQ\t\tBIT(3)\n#define VIRTCHNL_VF_OFFLOAD_RSS_REG\t\tBIT(4)\n#define VIRTCHNL_VF_OFFLOAD_WB_ON_ITR\t\tBIT(5)\n#define VIRTCHNL_VF_OFFLOAD_REQ_QUEUES\t\tBIT(6)\n \n#define VIRTCHNL_VF_CAP_ADV_LINK_SPEED\t\tBIT(7)\n#define VIRTCHNL_VF_OFFLOAD_VLAN_V2\t\tBIT(15)\n#define VIRTCHNL_VF_OFFLOAD_VLAN\t\tBIT(16)\n#define VIRTCHNL_VF_OFFLOAD_RX_POLLING\t\tBIT(17)\n#define VIRTCHNL_VF_OFFLOAD_RSS_PCTYPE_V2\tBIT(18)\n#define VIRTCHNL_VF_OFFLOAD_RSS_PF\t\tBIT(19)\n#define VIRTCHNL_VF_OFFLOAD_ENCAP\t\tBIT(20)\n#define VIRTCHNL_VF_OFFLOAD_ENCAP_CSUM\t\tBIT(21)\n#define VIRTCHNL_VF_OFFLOAD_RX_ENCAP_CSUM\tBIT(22)\n#define VIRTCHNL_VF_OFFLOAD_ADQ\t\t\tBIT(23)\n#define VIRTCHNL_VF_OFFLOAD_USO\t\t\tBIT(25)\n#define VIRTCHNL_VF_OFFLOAD_RX_FLEX_DESC\tBIT(26)\n#define VIRTCHNL_VF_OFFLOAD_ADV_RSS_PF\t\tBIT(27)\n#define VIRTCHNL_VF_OFFLOAD_FDIR_PF\t\tBIT(28)\n\n#define VF_BASE_MODE_OFFLOADS (VIRTCHNL_VF_OFFLOAD_L2 | \\\n\t\t\t       VIRTCHNL_VF_OFFLOAD_VLAN | \\\n\t\t\t       VIRTCHNL_VF_OFFLOAD_RSS_PF)\n\nstruct virtchnl_vf_resource {\n\tu16 num_vsis;\n\tu16 num_queue_pairs;\n\tu16 max_vectors;\n\tu16 max_mtu;\n\n\tu32 vf_cap_flags;\n\tu32 rss_key_size;\n\tu32 rss_lut_size;\n\n\tstruct virtchnl_vsi_resource vsi_res[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(20, virtchnl_vf_resource);\n#define virtchnl_vf_resource_LEGACY_SIZEOF\t36\n\n \n\n \nstruct virtchnl_txq_info {\n\tu16 vsi_id;\n\tu16 queue_id;\n\tu16 ring_len;\t\t \n\tu16 headwb_enabled;  \n\tu64 dma_ring_addr;\n\tu64 dma_headwb_addr;  \n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(24, virtchnl_txq_info);\n\n \n\n \nstruct virtchnl_rxq_info {\n\tu16 vsi_id;\n\tu16 queue_id;\n\tu32 ring_len;\t\t \n\tu16 hdr_size;\n\tu16 splithdr_enabled;  \n\tu32 databuffer_size;\n\tu32 max_pkt_size;\n\tu8 pad0;\n\tu8 rxdid;\n\tu8 pad1[2];\n\tu64 dma_ring_addr;\n\n\t \n\ts32 rx_split_pos;\n\tu32 pad2;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(40, virtchnl_rxq_info);\n\n \nstruct virtchnl_queue_pair_info {\n\t \n\tstruct virtchnl_txq_info txq;\n\tstruct virtchnl_rxq_info rxq;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(64, virtchnl_queue_pair_info);\n\nstruct virtchnl_vsi_queue_config_info {\n\tu16 vsi_id;\n\tu16 num_queue_pairs;\n\tu32 pad;\n\tstruct virtchnl_queue_pair_info qpair[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_vsi_queue_config_info);\n#define virtchnl_vsi_queue_config_info_LEGACY_SIZEOF\t72\n\n \n\n \nstruct virtchnl_vf_res_request {\n\tu16 num_queue_pairs;\n};\n\n \nstruct virtchnl_vector_map {\n\tu16 vsi_id;\n\tu16 vector_id;\n\tu16 rxq_map;\n\tu16 txq_map;\n\tu16 rxitr_idx;\n\tu16 txitr_idx;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(12, virtchnl_vector_map);\n\nstruct virtchnl_irq_map_info {\n\tu16 num_vectors;\n\tstruct virtchnl_vector_map vecmap[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(2, virtchnl_irq_map_info);\n#define virtchnl_irq_map_info_LEGACY_SIZEOF\t14\n\n \nstruct virtchnl_queue_select {\n\tu16 vsi_id;\n\tu16 pad;\n\tu32 rx_queues;\n\tu32 tx_queues;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(12, virtchnl_queue_select);\n\n \n\n \n\n \n\n \n\n \nstruct virtchnl_ether_addr {\n\tu8 addr[ETH_ALEN];\n\tu8 type;\n#define VIRTCHNL_ETHER_ADDR_LEGACY\t0\n#define VIRTCHNL_ETHER_ADDR_PRIMARY\t1\n#define VIRTCHNL_ETHER_ADDR_EXTRA\t2\n#define VIRTCHNL_ETHER_ADDR_TYPE_MASK\t3  \n\tu8 pad;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_ether_addr);\n\nstruct virtchnl_ether_addr_list {\n\tu16 vsi_id;\n\tu16 num_elements;\n\tstruct virtchnl_ether_addr list[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_ether_addr_list);\n#define virtchnl_ether_addr_list_LEGACY_SIZEOF\t12\n\n \n\n \n\nstruct virtchnl_vlan_filter_list {\n\tu16 vsi_id;\n\tu16 num_elements;\n\tu16 vlan_id[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_vlan_filter_list);\n#define virtchnl_vlan_filter_list_LEGACY_SIZEOF\t6\n\n \nenum virtchnl_vlan_support {\n\tVIRTCHNL_VLAN_UNSUPPORTED =\t\t0,\n\tVIRTCHNL_VLAN_ETHERTYPE_8100 =\t\tBIT(0),\n\tVIRTCHNL_VLAN_ETHERTYPE_88A8 =\t\tBIT(1),\n\tVIRTCHNL_VLAN_ETHERTYPE_9100 =\t\tBIT(2),\n\tVIRTCHNL_VLAN_TAG_LOCATION_L2TAG1 =\tBIT(8),\n\tVIRTCHNL_VLAN_TAG_LOCATION_L2TAG2 =\tBIT(9),\n\tVIRTCHNL_VLAN_TAG_LOCATION_L2TAG2_2 =\tBIT(10),\n\tVIRTCHNL_VLAN_PRIO =\t\t\tBIT(24),\n\tVIRTCHNL_VLAN_FILTER_MASK =\t\tBIT(28),\n\tVIRTCHNL_VLAN_ETHERTYPE_AND =\t\tBIT(29),\n\tVIRTCHNL_VLAN_ETHERTYPE_XOR =\t\tBIT(30),\n\tVIRTCHNL_VLAN_TOGGLE =\t\t\tBIT(31),\n};\n\n \nstruct virtchnl_vlan_supported_caps {\n\tu32 outer;\n\tu32 inner;\n};\n\n \nstruct virtchnl_vlan_filtering_caps {\n\tstruct virtchnl_vlan_supported_caps filtering_support;\n\tu32 ethertype_init;\n\tu16 max_filters;\n\tu8 pad[2];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(16, virtchnl_vlan_filtering_caps);\n\n \nenum virtchnl_vlan_ethertype_match {\n\tVIRTCHNL_ETHERTYPE_STRIPPING_MATCHES_INSERTION = 0,\n\tVIRTCHNL_ETHERTYPE_MATCH_NOT_REQUIRED = 1,\n};\n\n \nstruct virtchnl_vlan_offload_caps {\n\tstruct virtchnl_vlan_supported_caps stripping_support;\n\tstruct virtchnl_vlan_supported_caps insertion_support;\n\tu32 ethertype_init;\n\tu8 ethertype_match;\n\tu8 pad[3];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(24, virtchnl_vlan_offload_caps);\n\n \nstruct virtchnl_vlan_caps {\n\tstruct virtchnl_vlan_filtering_caps filtering;\n\tstruct virtchnl_vlan_offload_caps offloads;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(40, virtchnl_vlan_caps);\n\nstruct virtchnl_vlan {\n\tu16 tci;\t \n\tu16 tci_mask;\t \n\tu16 tpid;\t \n\tu8 pad[2];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_vlan);\n\nstruct virtchnl_vlan_filter {\n\tstruct virtchnl_vlan inner;\n\tstruct virtchnl_vlan outer;\n\tu8 pad[16];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(32, virtchnl_vlan_filter);\n\n \nstruct virtchnl_vlan_filter_list_v2 {\n\tu16 vport_id;\n\tu16 num_elements;\n\tu8 pad[4];\n\tstruct virtchnl_vlan_filter filters[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_vlan_filter_list_v2);\n#define virtchnl_vlan_filter_list_v2_LEGACY_SIZEOF\t40\n\n \nstruct virtchnl_vlan_setting {\n\tu32 outer_ethertype_setting;\n\tu32 inner_ethertype_setting;\n\tu16 vport_id;\n\tu8 pad[6];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(16, virtchnl_vlan_setting);\n\n \nstruct virtchnl_promisc_info {\n\tu16 vsi_id;\n\tu16 flags;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_promisc_info);\n\n#define FLAG_VF_UNICAST_PROMISC\t0x00000001\n#define FLAG_VF_MULTICAST_PROMISC\t0x00000002\n\n \n\n \nstruct virtchnl_rss_key {\n\tu16 vsi_id;\n\tu16 key_len;\n\tu8 key[];           \n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_rss_key);\n#define virtchnl_rss_key_LEGACY_SIZEOF\t6\n\nstruct virtchnl_rss_lut {\n\tu16 vsi_id;\n\tu16 lut_entries;\n\tu8 lut[];          \n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_rss_lut);\n#define virtchnl_rss_lut_LEGACY_SIZEOF\t6\n\n \nstruct virtchnl_rss_hena {\n\tu64 hena;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_rss_hena);\n\n \nstruct virtchnl_channel_info {\n\tu16 count;  \n\tu16 offset;  \n\tu32 pad;\n\tu64 max_tx_rate;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(16, virtchnl_channel_info);\n\nstruct virtchnl_tc_info {\n\tu32\tnum_tc;\n\tu32\tpad;\n\tstruct virtchnl_channel_info list[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(8, virtchnl_tc_info);\n#define virtchnl_tc_info_LEGACY_SIZEOF\t24\n\n \n\nstruct virtchnl_l4_spec {\n\tu8\tsrc_mac[ETH_ALEN];\n\tu8\tdst_mac[ETH_ALEN];\n\t__be16\tvlan_id;\n\t__be16\tpad;  \n\t__be32\tsrc_ip[4];\n\t__be32\tdst_ip[4];\n\t__be16\tsrc_port;\n\t__be16\tdst_port;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(52, virtchnl_l4_spec);\n\nunion virtchnl_flow_spec {\n\tstruct\tvirtchnl_l4_spec tcp_spec;\n\tu8\tbuffer[128];  \n};\n\nVIRTCHNL_CHECK_UNION_LEN(128, virtchnl_flow_spec);\n\nenum virtchnl_action {\n\t \n\tVIRTCHNL_ACTION_DROP = 0,\n\tVIRTCHNL_ACTION_TC_REDIRECT,\n\tVIRTCHNL_ACTION_PASSTHRU,\n\tVIRTCHNL_ACTION_QUEUE,\n\tVIRTCHNL_ACTION_Q_REGION,\n\tVIRTCHNL_ACTION_MARK,\n\tVIRTCHNL_ACTION_COUNT,\n};\n\nenum virtchnl_flow_type {\n\t \n\tVIRTCHNL_TCP_V4_FLOW = 0,\n\tVIRTCHNL_TCP_V6_FLOW,\n};\n\nstruct virtchnl_filter {\n\tunion\tvirtchnl_flow_spec data;\n\tunion\tvirtchnl_flow_spec mask;\n\n\t \n\ts32\tflow_type;\n\n\t \n\ts32\taction;\n\tu32\taction_meta;\n\tu8\tfield_flags;\n\tu8\tpad[3];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(272, virtchnl_filter);\n\nstruct virtchnl_supported_rxdids {\n\tu64 supported_rxdids;\n};\n\n \nenum virtchnl_event_codes {\n\tVIRTCHNL_EVENT_UNKNOWN = 0,\n\tVIRTCHNL_EVENT_LINK_CHANGE,\n\tVIRTCHNL_EVENT_RESET_IMPENDING,\n\tVIRTCHNL_EVENT_PF_DRIVER_CLOSE,\n};\n\n#define PF_EVENT_SEVERITY_INFO\t\t0\n#define PF_EVENT_SEVERITY_CERTAIN_DOOM\t255\n\nstruct virtchnl_pf_event {\n\t \n\ts32 event;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\tenum virtchnl_link_speed link_speed;\n\t\t\tbool link_status;\n\t\t\tu8 pad[3];\n\t\t} link_event;\n\t\tstruct {\n\t\t\t \n\t\t\tu32 link_speed;\n\t\t\tu8 link_status;\n\t\t\tu8 pad[3];\n\t\t} link_event_adv;\n\t} event_data;\n\n\ts32 severity;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(16, virtchnl_pf_event);\n\n \n#define VIRTCHNL_RDMA_INVALID_QUEUE_IDX\t0xFFFF\n \n\nstruct virtchnl_rdma_qv_info {\n\tu32 v_idx;  \n\tu16 ceq_idx;  \n\tu16 aeq_idx;  \n\tu8 itr_idx;\n\tu8 pad[3];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(12, virtchnl_rdma_qv_info);\n\nstruct virtchnl_rdma_qvlist_info {\n\tu32 num_vectors;\n\tstruct virtchnl_rdma_qv_info qv_info[];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(4, virtchnl_rdma_qvlist_info);\n#define virtchnl_rdma_qvlist_info_LEGACY_SIZEOF\t16\n\n \nenum virtchnl_vfr_states {\n\tVIRTCHNL_VFR_INPROGRESS = 0,\n\tVIRTCHNL_VFR_COMPLETED,\n\tVIRTCHNL_VFR_VFACTIVE,\n};\n\n \nenum virtchnl_rss_algorithm {\n\tVIRTCHNL_RSS_ALG_TOEPLITZ_ASYMMETRIC\t= 0,\n\tVIRTCHNL_RSS_ALG_R_ASYMMETRIC\t\t= 1,\n\tVIRTCHNL_RSS_ALG_TOEPLITZ_SYMMETRIC\t= 2,\n\tVIRTCHNL_RSS_ALG_XOR_SYMMETRIC\t\t= 3,\n};\n\n#define VIRTCHNL_MAX_NUM_PROTO_HDRS\t32\n#define PROTO_HDR_SHIFT\t\t\t5\n#define PROTO_HDR_FIELD_START(proto_hdr_type) ((proto_hdr_type) << PROTO_HDR_SHIFT)\n#define PROTO_HDR_FIELD_MASK ((1UL << PROTO_HDR_SHIFT) - 1)\n\n \n#define VIRTCHNL_ADD_PROTO_HDR_FIELD(hdr, field) \\\n\t((hdr)->field_selector |= BIT((field) & PROTO_HDR_FIELD_MASK))\n#define VIRTCHNL_DEL_PROTO_HDR_FIELD(hdr, field) \\\n\t((hdr)->field_selector &= ~BIT((field) & PROTO_HDR_FIELD_MASK))\n#define VIRTCHNL_TEST_PROTO_HDR_FIELD(hdr, val) \\\n\t((hdr)->field_selector & BIT((val) & PROTO_HDR_FIELD_MASK))\n#define VIRTCHNL_GET_PROTO_HDR_FIELD(hdr)\t((hdr)->field_selector)\n\n#define VIRTCHNL_ADD_PROTO_HDR_FIELD_BIT(hdr, hdr_type, field) \\\n\t(VIRTCHNL_ADD_PROTO_HDR_FIELD(hdr, \\\n\t\tVIRTCHNL_PROTO_HDR_ ## hdr_type ## _ ## field))\n#define VIRTCHNL_DEL_PROTO_HDR_FIELD_BIT(hdr, hdr_type, field) \\\n\t(VIRTCHNL_DEL_PROTO_HDR_FIELD(hdr, \\\n\t\tVIRTCHNL_PROTO_HDR_ ## hdr_type ## _ ## field))\n\n#define VIRTCHNL_SET_PROTO_HDR_TYPE(hdr, hdr_type) \\\n\t((hdr)->type = VIRTCHNL_PROTO_HDR_ ## hdr_type)\n#define VIRTCHNL_GET_PROTO_HDR_TYPE(hdr) \\\n\t(((hdr)->type) >> PROTO_HDR_SHIFT)\n#define VIRTCHNL_TEST_PROTO_HDR_TYPE(hdr, val) \\\n\t((hdr)->type == ((s32)((val) >> PROTO_HDR_SHIFT)))\n#define VIRTCHNL_TEST_PROTO_HDR(hdr, val) \\\n\t(VIRTCHNL_TEST_PROTO_HDR_TYPE((hdr), (val)) && \\\n\t VIRTCHNL_TEST_PROTO_HDR_FIELD((hdr), (val)))\n\n \nenum virtchnl_proto_hdr_type {\n\tVIRTCHNL_PROTO_HDR_NONE,\n\tVIRTCHNL_PROTO_HDR_ETH,\n\tVIRTCHNL_PROTO_HDR_S_VLAN,\n\tVIRTCHNL_PROTO_HDR_C_VLAN,\n\tVIRTCHNL_PROTO_HDR_IPV4,\n\tVIRTCHNL_PROTO_HDR_IPV6,\n\tVIRTCHNL_PROTO_HDR_TCP,\n\tVIRTCHNL_PROTO_HDR_UDP,\n\tVIRTCHNL_PROTO_HDR_SCTP,\n\tVIRTCHNL_PROTO_HDR_GTPU_IP,\n\tVIRTCHNL_PROTO_HDR_GTPU_EH,\n\tVIRTCHNL_PROTO_HDR_GTPU_EH_PDU_DWN,\n\tVIRTCHNL_PROTO_HDR_GTPU_EH_PDU_UP,\n\tVIRTCHNL_PROTO_HDR_PPPOE,\n\tVIRTCHNL_PROTO_HDR_L2TPV3,\n\tVIRTCHNL_PROTO_HDR_ESP,\n\tVIRTCHNL_PROTO_HDR_AH,\n\tVIRTCHNL_PROTO_HDR_PFCP,\n};\n\n \nenum virtchnl_proto_hdr_field {\n\t \n\tVIRTCHNL_PROTO_HDR_ETH_SRC =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_ETH),\n\tVIRTCHNL_PROTO_HDR_ETH_DST,\n\tVIRTCHNL_PROTO_HDR_ETH_ETHERTYPE,\n\t \n\tVIRTCHNL_PROTO_HDR_S_VLAN_ID =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_S_VLAN),\n\t \n\tVIRTCHNL_PROTO_HDR_C_VLAN_ID =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_C_VLAN),\n\t \n\tVIRTCHNL_PROTO_HDR_IPV4_SRC =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_IPV4),\n\tVIRTCHNL_PROTO_HDR_IPV4_DST,\n\tVIRTCHNL_PROTO_HDR_IPV4_DSCP,\n\tVIRTCHNL_PROTO_HDR_IPV4_TTL,\n\tVIRTCHNL_PROTO_HDR_IPV4_PROT,\n\t \n\tVIRTCHNL_PROTO_HDR_IPV6_SRC =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_IPV6),\n\tVIRTCHNL_PROTO_HDR_IPV6_DST,\n\tVIRTCHNL_PROTO_HDR_IPV6_TC,\n\tVIRTCHNL_PROTO_HDR_IPV6_HOP_LIMIT,\n\tVIRTCHNL_PROTO_HDR_IPV6_PROT,\n\t \n\tVIRTCHNL_PROTO_HDR_TCP_SRC_PORT =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_TCP),\n\tVIRTCHNL_PROTO_HDR_TCP_DST_PORT,\n\t \n\tVIRTCHNL_PROTO_HDR_UDP_SRC_PORT =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_UDP),\n\tVIRTCHNL_PROTO_HDR_UDP_DST_PORT,\n\t \n\tVIRTCHNL_PROTO_HDR_SCTP_SRC_PORT =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_SCTP),\n\tVIRTCHNL_PROTO_HDR_SCTP_DST_PORT,\n\t \n\tVIRTCHNL_PROTO_HDR_GTPU_IP_TEID =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_GTPU_IP),\n\t \n\tVIRTCHNL_PROTO_HDR_GTPU_EH_PDU =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_GTPU_EH),\n\tVIRTCHNL_PROTO_HDR_GTPU_EH_QFI,\n\t \n\tVIRTCHNL_PROTO_HDR_PPPOE_SESS_ID =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_PPPOE),\n\t \n\tVIRTCHNL_PROTO_HDR_L2TPV3_SESS_ID =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_L2TPV3),\n\t \n\tVIRTCHNL_PROTO_HDR_ESP_SPI =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_ESP),\n\t \n\tVIRTCHNL_PROTO_HDR_AH_SPI =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_AH),\n\t \n\tVIRTCHNL_PROTO_HDR_PFCP_S_FIELD =\n\t\tPROTO_HDR_FIELD_START(VIRTCHNL_PROTO_HDR_PFCP),\n\tVIRTCHNL_PROTO_HDR_PFCP_SEID,\n};\n\nstruct virtchnl_proto_hdr {\n\t \n\ts32 type;\n\tu32 field_selector;  \n\tu8 buffer[64];\n\t \n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(72, virtchnl_proto_hdr);\n\nstruct virtchnl_proto_hdrs {\n\tu8 tunnel_level;\n\tu8 pad[3];\n\t \n\tint count;  \n\tstruct virtchnl_proto_hdr proto_hdr[VIRTCHNL_MAX_NUM_PROTO_HDRS];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(2312, virtchnl_proto_hdrs);\n\nstruct virtchnl_rss_cfg {\n\tstruct virtchnl_proto_hdrs proto_hdrs;\t    \n\n\t \n\ts32 rss_algorithm;\n\tu8 reserved[128];                           \n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(2444, virtchnl_rss_cfg);\n\n \nstruct virtchnl_filter_action {\n\t \n\ts32 type;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\tu16 index;\n\t\t\tu8 region;\n\t\t} queue;\n\t\t \n\t\tstruct {\n\t\t\t \n\t\t\tu8 shared;\n\t\t\tu32 id;  \n\t\t} count;\n\t\t \n\t\tu32 mark_id;\n\t\tu8 reserve[32];\n\t} act_conf;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(36, virtchnl_filter_action);\n\n#define VIRTCHNL_MAX_NUM_ACTIONS  8\n\nstruct virtchnl_filter_action_set {\n\t \n\tint count;\n\tstruct virtchnl_filter_action actions[VIRTCHNL_MAX_NUM_ACTIONS];\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(292, virtchnl_filter_action_set);\n\n \nstruct virtchnl_fdir_rule {\n\tstruct virtchnl_proto_hdrs proto_hdrs;\n\tstruct virtchnl_filter_action_set action_set;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(2604, virtchnl_fdir_rule);\n\n \nenum virtchnl_fdir_prgm_status {\n\tVIRTCHNL_FDIR_SUCCESS = 0,\n\tVIRTCHNL_FDIR_FAILURE_RULE_NORESOURCE,\n\tVIRTCHNL_FDIR_FAILURE_RULE_EXIST,\n\tVIRTCHNL_FDIR_FAILURE_RULE_CONFLICT,\n\tVIRTCHNL_FDIR_FAILURE_RULE_NONEXIST,\n\tVIRTCHNL_FDIR_FAILURE_RULE_INVALID,\n\tVIRTCHNL_FDIR_FAILURE_RULE_TIMEOUT,\n\tVIRTCHNL_FDIR_FAILURE_QUERY_INVALID,\n};\n\n \nstruct virtchnl_fdir_add {\n\tu16 vsi_id;   \n\t \n\tu16 validate_only;  \n\tu32 flow_id;        \n\tstruct virtchnl_fdir_rule rule_cfg;  \n\n\t \n\ts32 status;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(2616, virtchnl_fdir_add);\n\n \nstruct virtchnl_fdir_del {\n\tu16 vsi_id;   \n\tu16 pad;\n\tu32 flow_id;  \n\n\t \n\ts32 status;\n};\n\nVIRTCHNL_CHECK_STRUCT_LEN(12, virtchnl_fdir_del);\n\n#define __vss_byone(p, member, count, old)\t\t\t\t      \\\n\t(struct_size(p, member, count) + (old - 1 - struct_size(p, member, 0)))\n\n#define __vss_byelem(p, member, count, old)\t\t\t\t      \\\n\t(struct_size(p, member, count - 1) + (old - struct_size(p, member, 0)))\n\n#define __vss_full(p, member, count, old)\t\t\t\t      \\\n\t(struct_size(p, member, count) + (old - struct_size(p, member, 0)))\n\n#define __vss(type, func, p, member, count)\t\t\\\n\tstruct type: func(p, member, count, type##_LEGACY_SIZEOF)\n\n#define virtchnl_struct_size(p, m, c)\t\t\t\t\t      \\\n\t_Generic(*p,\t\t\t\t\t\t\t      \\\n\t\t __vss(virtchnl_vf_resource, __vss_full, p, m, c),\t      \\\n\t\t __vss(virtchnl_vsi_queue_config_info, __vss_full, p, m, c),  \\\n\t\t __vss(virtchnl_irq_map_info, __vss_full, p, m, c),\t      \\\n\t\t __vss(virtchnl_ether_addr_list, __vss_full, p, m, c),\t      \\\n\t\t __vss(virtchnl_vlan_filter_list, __vss_full, p, m, c),\t      \\\n\t\t __vss(virtchnl_vlan_filter_list_v2, __vss_byelem, p, m, c),  \\\n\t\t __vss(virtchnl_tc_info, __vss_byelem, p, m, c),\t      \\\n\t\t __vss(virtchnl_rdma_qvlist_info, __vss_byelem, p, m, c),     \\\n\t\t __vss(virtchnl_rss_key, __vss_byone, p, m, c),\t\t      \\\n\t\t __vss(virtchnl_rss_lut, __vss_byone, p, m, c))\n\n \nstatic inline int\nvirtchnl_vc_validate_vf_msg(struct virtchnl_version_info *ver, u32 v_opcode,\n\t\t\t    u8 *msg, u16 msglen)\n{\n\tbool err_msg_format = false;\n\tu32 valid_len = 0;\n\n\t \n\tswitch (v_opcode) {\n\tcase VIRTCHNL_OP_VERSION:\n\t\tvalid_len = sizeof(struct virtchnl_version_info);\n\t\tbreak;\n\tcase VIRTCHNL_OP_RESET_VF:\n\t\tbreak;\n\tcase VIRTCHNL_OP_GET_VF_RESOURCES:\n\t\tif (VF_IS_V11(ver))\n\t\t\tvalid_len = sizeof(u32);\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_TX_QUEUE:\n\t\tvalid_len = sizeof(struct virtchnl_txq_info);\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_RX_QUEUE:\n\t\tvalid_len = sizeof(struct virtchnl_rxq_info);\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_VSI_QUEUES:\n\t\tvalid_len = virtchnl_vsi_queue_config_info_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_vsi_queue_config_info *vqc =\n\t\t\t    (struct virtchnl_vsi_queue_config_info *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vqc, qpair,\n\t\t\t\t\t\t\t vqc->num_queue_pairs);\n\t\t\tif (vqc->num_queue_pairs == 0)\n\t\t\t\terr_msg_format = true;\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_IRQ_MAP:\n\t\tvalid_len = virtchnl_irq_map_info_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_irq_map_info *vimi =\n\t\t\t    (struct virtchnl_irq_map_info *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vimi, vecmap,\n\t\t\t\t\t\t\t vimi->num_vectors);\n\t\t\tif (vimi->num_vectors == 0)\n\t\t\t\terr_msg_format = true;\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_ENABLE_QUEUES:\n\tcase VIRTCHNL_OP_DISABLE_QUEUES:\n\t\tvalid_len = sizeof(struct virtchnl_queue_select);\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_ETH_ADDR:\n\tcase VIRTCHNL_OP_DEL_ETH_ADDR:\n\t\tvalid_len = virtchnl_ether_addr_list_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_ether_addr_list *veal =\n\t\t\t    (struct virtchnl_ether_addr_list *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(veal, list,\n\t\t\t\t\t\t\t veal->num_elements);\n\t\t\tif (veal->num_elements == 0)\n\t\t\t\terr_msg_format = true;\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_VLAN:\n\tcase VIRTCHNL_OP_DEL_VLAN:\n\t\tvalid_len = virtchnl_vlan_filter_list_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_vlan_filter_list *vfl =\n\t\t\t    (struct virtchnl_vlan_filter_list *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vfl, vlan_id,\n\t\t\t\t\t\t\t vfl->num_elements);\n\t\t\tif (vfl->num_elements == 0)\n\t\t\t\terr_msg_format = true;\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_PROMISCUOUS_MODE:\n\t\tvalid_len = sizeof(struct virtchnl_promisc_info);\n\t\tbreak;\n\tcase VIRTCHNL_OP_GET_STATS:\n\t\tvalid_len = sizeof(struct virtchnl_queue_select);\n\t\tbreak;\n\tcase VIRTCHNL_OP_RDMA:\n\t\t \n\t\tif (msglen)\n\t\t\tvalid_len = msglen;\n\t\telse\n\t\t\terr_msg_format = true;\n\t\tbreak;\n\tcase VIRTCHNL_OP_RELEASE_RDMA_IRQ_MAP:\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_RDMA_IRQ_MAP:\n\t\tvalid_len = virtchnl_rdma_qvlist_info_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_rdma_qvlist_info *qv =\n\t\t\t\t(struct virtchnl_rdma_qvlist_info *)msg;\n\n\t\t\tvalid_len = virtchnl_struct_size(qv, qv_info,\n\t\t\t\t\t\t\t qv->num_vectors);\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_RSS_KEY:\n\t\tvalid_len = virtchnl_rss_key_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_rss_key *vrk =\n\t\t\t\t(struct virtchnl_rss_key *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vrk, key,\n\t\t\t\t\t\t\t vrk->key_len);\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_CONFIG_RSS_LUT:\n\t\tvalid_len = virtchnl_rss_lut_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_rss_lut *vrl =\n\t\t\t\t(struct virtchnl_rss_lut *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vrl, lut,\n\t\t\t\t\t\t\t vrl->lut_entries);\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_GET_RSS_HENA_CAPS:\n\t\tbreak;\n\tcase VIRTCHNL_OP_SET_RSS_HENA:\n\t\tvalid_len = sizeof(struct virtchnl_rss_hena);\n\t\tbreak;\n\tcase VIRTCHNL_OP_ENABLE_VLAN_STRIPPING:\n\tcase VIRTCHNL_OP_DISABLE_VLAN_STRIPPING:\n\t\tbreak;\n\tcase VIRTCHNL_OP_REQUEST_QUEUES:\n\t\tvalid_len = sizeof(struct virtchnl_vf_res_request);\n\t\tbreak;\n\tcase VIRTCHNL_OP_ENABLE_CHANNELS:\n\t\tvalid_len = virtchnl_tc_info_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_tc_info *vti =\n\t\t\t\t(struct virtchnl_tc_info *)msg;\n\t\t\tvalid_len = virtchnl_struct_size(vti, list,\n\t\t\t\t\t\t\t vti->num_tc);\n\t\t\tif (vti->num_tc == 0)\n\t\t\t\terr_msg_format = true;\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_DISABLE_CHANNELS:\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_CLOUD_FILTER:\n\tcase VIRTCHNL_OP_DEL_CLOUD_FILTER:\n\t\tvalid_len = sizeof(struct virtchnl_filter);\n\t\tbreak;\n\tcase VIRTCHNL_OP_GET_SUPPORTED_RXDIDS:\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_RSS_CFG:\n\tcase VIRTCHNL_OP_DEL_RSS_CFG:\n\t\tvalid_len = sizeof(struct virtchnl_rss_cfg);\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_FDIR_FILTER:\n\t\tvalid_len = sizeof(struct virtchnl_fdir_add);\n\t\tbreak;\n\tcase VIRTCHNL_OP_DEL_FDIR_FILTER:\n\t\tvalid_len = sizeof(struct virtchnl_fdir_del);\n\t\tbreak;\n\tcase VIRTCHNL_OP_GET_OFFLOAD_VLAN_V2_CAPS:\n\t\tbreak;\n\tcase VIRTCHNL_OP_ADD_VLAN_V2:\n\tcase VIRTCHNL_OP_DEL_VLAN_V2:\n\t\tvalid_len = virtchnl_vlan_filter_list_v2_LEGACY_SIZEOF;\n\t\tif (msglen >= valid_len) {\n\t\t\tstruct virtchnl_vlan_filter_list_v2 *vfl =\n\t\t\t    (struct virtchnl_vlan_filter_list_v2 *)msg;\n\n\t\t\tvalid_len = virtchnl_struct_size(vfl, filters,\n\t\t\t\t\t\t\t vfl->num_elements);\n\n\t\t\tif (vfl->num_elements == 0) {\n\t\t\t\terr_msg_format = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase VIRTCHNL_OP_ENABLE_VLAN_STRIPPING_V2:\n\tcase VIRTCHNL_OP_DISABLE_VLAN_STRIPPING_V2:\n\tcase VIRTCHNL_OP_ENABLE_VLAN_INSERTION_V2:\n\tcase VIRTCHNL_OP_DISABLE_VLAN_INSERTION_V2:\n\t\tvalid_len = sizeof(struct virtchnl_vlan_setting);\n\t\tbreak;\n\t \n\tcase VIRTCHNL_OP_EVENT:\n\tcase VIRTCHNL_OP_UNKNOWN:\n\tdefault:\n\t\treturn VIRTCHNL_STATUS_ERR_PARAM;\n\t}\n\t \n\tif (err_msg_format || valid_len != msglen)\n\t\treturn VIRTCHNL_STATUS_ERR_OPCODE_MISMATCH;\n\n\treturn 0;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}