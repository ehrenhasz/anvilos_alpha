{
  "module_name": "configfs.h",
  "hash_id": "af9992f2bc21d2a0597d0d17c543c8e16755a67abc410e08d9222459745d7622",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/configfs.h",
  "human_readable_source": " \n \n\n#ifndef _CONFIGFS_H_\n#define _CONFIGFS_H_\n\n#include <linux/stat.h>    \n#include <linux/types.h>   \n#include <linux/list.h>    \n#include <linux/kref.h>    \n#include <linux/mutex.h>   \n\n#define CONFIGFS_ITEM_NAME_LEN\t20\n\nstruct module;\n\nstruct configfs_item_operations;\nstruct configfs_group_operations;\nstruct configfs_attribute;\nstruct configfs_bin_attribute;\nstruct configfs_subsystem;\n\nstruct config_item {\n\tchar\t\t\t*ci_name;\n\tchar\t\t\tci_namebuf[CONFIGFS_ITEM_NAME_LEN];\n\tstruct kref\t\tci_kref;\n\tstruct list_head\tci_entry;\n\tstruct config_item\t*ci_parent;\n\tstruct config_group\t*ci_group;\n\tconst struct config_item_type\t*ci_type;\n\tstruct dentry\t\t*ci_dentry;\n};\n\nextern __printf(2, 3)\nint config_item_set_name(struct config_item *, const char *, ...);\n\nstatic inline char *config_item_name(struct config_item * item)\n{\n\treturn item->ci_name;\n}\n\nextern void config_item_init_type_name(struct config_item *item,\n\t\t\t\t       const char *name,\n\t\t\t\t       const struct config_item_type *type);\n\nextern struct config_item *config_item_get(struct config_item *);\nextern struct config_item *config_item_get_unless_zero(struct config_item *);\nextern void config_item_put(struct config_item *);\n\nstruct config_item_type {\n\tstruct module\t\t\t\t*ct_owner;\n\tstruct configfs_item_operations\t\t*ct_item_ops;\n\tstruct configfs_group_operations\t*ct_group_ops;\n\tstruct configfs_attribute\t\t**ct_attrs;\n\tstruct configfs_bin_attribute\t\t**ct_bin_attrs;\n};\n\n \nstruct config_group {\n\tstruct config_item\t\tcg_item;\n\tstruct list_head\t\tcg_children;\n\tstruct configfs_subsystem \t*cg_subsys;\n\tstruct list_head\t\tdefault_groups;\n\tstruct list_head\t\tgroup_entry;\n};\n\nextern void config_group_init(struct config_group *group);\nextern void config_group_init_type_name(struct config_group *group,\n\t\t\t\t\tconst char *name,\n\t\t\t\t\tconst struct config_item_type *type);\n\nstatic inline struct config_group *to_config_group(struct config_item *item)\n{\n\treturn item ? container_of(item,struct config_group,cg_item) : NULL;\n}\n\nstatic inline struct config_group *config_group_get(struct config_group *group)\n{\n\treturn group ? to_config_group(config_item_get(&group->cg_item)) : NULL;\n}\n\nstatic inline void config_group_put(struct config_group *group)\n{\n\tconfig_item_put(&group->cg_item);\n}\n\nextern struct config_item *config_group_find_item(struct config_group *,\n\t\t\t\t\t\t  const char *);\n\n\nstatic inline void configfs_add_default_group(struct config_group *new_group,\n\t\tstruct config_group *group)\n{\n\tlist_add_tail(&new_group->group_entry, &group->default_groups);\n}\n\nstruct configfs_attribute {\n\tconst char\t\t*ca_name;\n\tstruct module \t\t*ca_owner;\n\tumode_t\t\t\tca_mode;\n\tssize_t (*show)(struct config_item *, char *);\n\tssize_t (*store)(struct config_item *, const char *, size_t);\n};\n\n#define CONFIGFS_ATTR(_pfx, _name)\t\t\t\\\nstatic struct configfs_attribute _pfx##attr_##_name = {\t\\\n\t.ca_name\t= __stringify(_name),\t\t\\\n\t.ca_mode\t= S_IRUGO | S_IWUSR,\t\t\\\n\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t.show\t\t= _pfx##_name##_show,\t\t\\\n\t.store\t\t= _pfx##_name##_store,\t\t\\\n}\n\n#define CONFIGFS_ATTR_RO(_pfx, _name)\t\t\t\\\nstatic struct configfs_attribute _pfx##attr_##_name = {\t\\\n\t.ca_name\t= __stringify(_name),\t\t\\\n\t.ca_mode\t= S_IRUGO,\t\t\t\\\n\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t.show\t\t= _pfx##_name##_show,\t\t\\\n}\n\n#define CONFIGFS_ATTR_WO(_pfx, _name)\t\t\t\\\nstatic struct configfs_attribute _pfx##attr_##_name = {\t\\\n\t.ca_name\t= __stringify(_name),\t\t\\\n\t.ca_mode\t= S_IWUSR,\t\t\t\\\n\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t.store\t\t= _pfx##_name##_store,\t\t\\\n}\n\nstruct file;\nstruct vm_area_struct;\n\nstruct configfs_bin_attribute {\n\tstruct configfs_attribute cb_attr;\t \n\tvoid *cb_private;\t\t\t \n\tsize_t cb_max_size;\t\t\t \n\tssize_t (*read)(struct config_item *, void *, size_t);\n\tssize_t (*write)(struct config_item *, const void *, size_t);\n};\n\n#define CONFIGFS_BIN_ATTR(_pfx, _name, _priv, _maxsz)\t\t\\\nstatic struct configfs_bin_attribute _pfx##attr_##_name = {\t\\\n\t.cb_attr = {\t\t\t\t\t\t\\\n\t\t.ca_name\t= __stringify(_name),\t\t\\\n\t\t.ca_mode\t= S_IRUGO | S_IWUSR,\t\t\\\n\t\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t},\t\t\t\t\t\t\t\\\n\t.cb_private\t= _priv,\t\t\t\t\\\n\t.cb_max_size\t= _maxsz,\t\t\t\t\\\n\t.read\t\t= _pfx##_name##_read,\t\t\t\\\n\t.write\t\t= _pfx##_name##_write,\t\t\t\\\n}\n\n#define CONFIGFS_BIN_ATTR_RO(_pfx, _name, _priv, _maxsz)\t\\\nstatic struct configfs_bin_attribute _pfx##attr_##_name = {\t\\\n\t.cb_attr = {\t\t\t\t\t\t\\\n\t\t.ca_name\t= __stringify(_name),\t\t\\\n\t\t.ca_mode\t= S_IRUGO,\t\t\t\\\n\t\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t},\t\t\t\t\t\t\t\\\n\t.cb_private\t= _priv,\t\t\t\t\\\n\t.cb_max_size\t= _maxsz,\t\t\t\t\\\n\t.read\t\t= _pfx##_name##_read,\t\t\t\\\n}\n\n#define CONFIGFS_BIN_ATTR_WO(_pfx, _name, _priv, _maxsz)\t\\\nstatic struct configfs_bin_attribute _pfx##attr_##_name = {\t\\\n\t.cb_attr = {\t\t\t\t\t\t\\\n\t\t.ca_name\t= __stringify(_name),\t\t\\\n\t\t.ca_mode\t= S_IWUSR,\t\t\t\\\n\t\t.ca_owner\t= THIS_MODULE,\t\t\t\\\n\t},\t\t\t\t\t\t\t\\\n\t.cb_private\t= _priv,\t\t\t\t\\\n\t.cb_max_size\t= _maxsz,\t\t\t\t\\\n\t.write\t\t= _pfx##_name##_write,\t\t\t\\\n}\n\n \nstruct configfs_item_operations {\n\tvoid (*release)(struct config_item *);\n\tint (*allow_link)(struct config_item *src, struct config_item *target);\n\tvoid (*drop_link)(struct config_item *src, struct config_item *target);\n};\n\nstruct configfs_group_operations {\n\tstruct config_item *(*make_item)(struct config_group *group, const char *name);\n\tstruct config_group *(*make_group)(struct config_group *group, const char *name);\n\tvoid (*disconnect_notify)(struct config_group *group, struct config_item *item);\n\tvoid (*drop_item)(struct config_group *group, struct config_item *item);\n};\n\nstruct configfs_subsystem {\n\tstruct config_group\tsu_group;\n\tstruct mutex\t\tsu_mutex;\n};\n\nstatic inline struct configfs_subsystem *to_configfs_subsystem(struct config_group *group)\n{\n\treturn group ?\n\t\tcontainer_of(group, struct configfs_subsystem, su_group) :\n\t\tNULL;\n}\n\nint configfs_register_subsystem(struct configfs_subsystem *subsys);\nvoid configfs_unregister_subsystem(struct configfs_subsystem *subsys);\n\nint configfs_register_group(struct config_group *parent_group,\n\t\t\t    struct config_group *group);\nvoid configfs_unregister_group(struct config_group *group);\n\nvoid configfs_remove_default_groups(struct config_group *group);\n\nstruct config_group *\nconfigfs_register_default_group(struct config_group *parent_group,\n\t\t\t\tconst char *name,\n\t\t\t\tconst struct config_item_type *item_type);\nvoid configfs_unregister_default_group(struct config_group *group);\n\n \n \nint configfs_depend_item(struct configfs_subsystem *subsys,\n\t\t\t struct config_item *target);\nvoid configfs_undepend_item(struct config_item *target);\n\n \nint configfs_depend_item_unlocked(struct configfs_subsystem *caller_subsys,\n\t\t\t\t  struct config_item *target);\n\n\nstatic inline void configfs_undepend_item_unlocked(struct config_item *target)\n{\n\tconfigfs_undepend_item(target);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}