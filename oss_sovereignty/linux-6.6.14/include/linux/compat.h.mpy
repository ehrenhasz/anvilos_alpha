{
  "module_name": "compat.h",
  "hash_id": "31b3b01688d40de27352e240f74b5ab9b24c62e2a6a74312110d80705ad60e37",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/compat.h",
  "human_readable_source": " \n#ifndef _LINUX_COMPAT_H\n#define _LINUX_COMPAT_H\n \n\n#include <linux/types.h>\n#include <linux/time.h>\n\n#include <linux/stat.h>\n#include <linux/param.h>\t \n#include <linux/sem.h>\n#include <linux/socket.h>\n#include <linux/if.h>\n#include <linux/fs.h>\n#include <linux/aio_abi.h>\t \n#include <linux/uaccess.h>\n#include <linux/unistd.h>\n\n#include <asm/compat.h>\n#include <asm/siginfo.h>\n#include <asm/signal.h>\n\n#ifdef CONFIG_ARCH_HAS_SYSCALL_WRAPPER\n \n#include <asm/syscall_wrapper.h>\n#endif  \n\n#ifndef COMPAT_USE_64BIT_TIME\n#define COMPAT_USE_64BIT_TIME 0\n#endif\n\n#ifndef __SC_DELOUSE\n#define __SC_DELOUSE(t,v) ((__force t)(unsigned long)(v))\n#endif\n\n#ifndef COMPAT_SYSCALL_DEFINE0\n#define COMPAT_SYSCALL_DEFINE0(name) \\\n\tasmlinkage long compat_sys_##name(void); \\\n\tALLOW_ERROR_INJECTION(compat_sys_##name, ERRNO); \\\n\tasmlinkage long compat_sys_##name(void)\n#endif  \n\n#define COMPAT_SYSCALL_DEFINE1(name, ...) \\\n        COMPAT_SYSCALL_DEFINEx(1, _##name, __VA_ARGS__)\n#define COMPAT_SYSCALL_DEFINE2(name, ...) \\\n\tCOMPAT_SYSCALL_DEFINEx(2, _##name, __VA_ARGS__)\n#define COMPAT_SYSCALL_DEFINE3(name, ...) \\\n\tCOMPAT_SYSCALL_DEFINEx(3, _##name, __VA_ARGS__)\n#define COMPAT_SYSCALL_DEFINE4(name, ...) \\\n\tCOMPAT_SYSCALL_DEFINEx(4, _##name, __VA_ARGS__)\n#define COMPAT_SYSCALL_DEFINE5(name, ...) \\\n\tCOMPAT_SYSCALL_DEFINEx(5, _##name, __VA_ARGS__)\n#define COMPAT_SYSCALL_DEFINE6(name, ...) \\\n\tCOMPAT_SYSCALL_DEFINEx(6, _##name, __VA_ARGS__)\n\n \n#ifndef COMPAT_SYSCALL_DEFINEx\n#define COMPAT_SYSCALL_DEFINEx(x, name, ...)\t\t\t\t\t\\\n\t__diag_push();\t\t\t\t\t\t\t\t\\\n\t__diag_ignore(GCC, 8, \"-Wattribute-alias\",\t\t\t\t\\\n\t\t      \"Type aliasing is used to sanitize syscall arguments\");\\\n\tasmlinkage long compat_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__))\t\\\n\t\t__attribute__((alias(__stringify(__se_compat_sys##name))));\t\\\n\tALLOW_ERROR_INJECTION(compat_sys##name, ERRNO);\t\t\t\t\\\n\tstatic inline long __do_compat_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__));\\\n\tasmlinkage long __se_compat_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__));\t\\\n\tasmlinkage long __se_compat_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__))\t\\\n\t{\t\t\t\t\t\t\t\t\t\\\n\t\tlong ret = __do_compat_sys##name(__MAP(x,__SC_DELOUSE,__VA_ARGS__));\\\n\t\t__MAP(x,__SC_TEST,__VA_ARGS__);\t\t\t\t\t\\\n\t\treturn ret;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\t__diag_pop();\t\t\t\t\t\t\t\t\\\n\tstatic inline long __do_compat_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__))\n#endif  \n\nstruct compat_iovec {\n\tcompat_uptr_t\tiov_base;\n\tcompat_size_t\tiov_len;\n};\n\n#ifndef compat_user_stack_pointer\n#define compat_user_stack_pointer() current_user_stack_pointer()\n#endif\n#ifndef compat_sigaltstack\t \ntypedef struct compat_sigaltstack {\n\tcompat_uptr_t\t\t\tss_sp;\n\tint\t\t\t\tss_flags;\n\tcompat_size_t\t\t\tss_size;\n} compat_stack_t;\n#endif\n#ifndef COMPAT_MINSIGSTKSZ\n#define COMPAT_MINSIGSTKSZ\tMINSIGSTKSZ\n#endif\n\n#define compat_jiffies_to_clock_t(x)\t\\\n\t\t(((unsigned long)(x) * COMPAT_USER_HZ) / HZ)\n\ntypedef __compat_uid32_t\tcompat_uid_t;\ntypedef __compat_gid32_t\tcompat_gid_t;\n\nstruct compat_sel_arg_struct;\nstruct rusage;\n\nstruct old_itimerval32;\n\nstruct compat_tms {\n\tcompat_clock_t\t\ttms_utime;\n\tcompat_clock_t\t\ttms_stime;\n\tcompat_clock_t\t\ttms_cutime;\n\tcompat_clock_t\t\ttms_cstime;\n};\n\n#define _COMPAT_NSIG_WORDS\t(_COMPAT_NSIG / _COMPAT_NSIG_BPW)\n\ntypedef struct {\n\tcompat_sigset_word\tsig[_COMPAT_NSIG_WORDS];\n} compat_sigset_t;\n\nint set_compat_user_sigmask(const compat_sigset_t __user *umask,\n\t\t\t    size_t sigsetsize);\n\nstruct compat_sigaction {\n#ifndef __ARCH_HAS_IRIX_SIGACTION\n\tcompat_uptr_t\t\t\tsa_handler;\n\tcompat_ulong_t\t\t\tsa_flags;\n#else\n\tcompat_uint_t\t\t\tsa_flags;\n\tcompat_uptr_t\t\t\tsa_handler;\n#endif\n#ifdef __ARCH_HAS_SA_RESTORER\n\tcompat_uptr_t\t\t\tsa_restorer;\n#endif\n\tcompat_sigset_t\t\t\tsa_mask __packed;\n};\n\ntypedef union compat_sigval {\n\tcompat_int_t\tsival_int;\n\tcompat_uptr_t\tsival_ptr;\n} compat_sigval_t;\n\ntypedef struct compat_siginfo {\n\tint si_signo;\n#ifndef __ARCH_HAS_SWAPPED_SIGINFO\n\tint si_errno;\n\tint si_code;\n#else\n\tint si_code;\n\tint si_errno;\n#endif\n\n\tunion {\n\t\tint _pad[128/sizeof(int) - 3];\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_pid_t _pid;\t \n\t\t\t__compat_uid32_t _uid;\t \n\t\t} _kill;\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_timer_t _tid;\t \n\t\t\tint _overrun;\t\t \n\t\t\tcompat_sigval_t _sigval;\t \n\t\t} _timer;\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_pid_t _pid;\t \n\t\t\t__compat_uid32_t _uid;\t \n\t\t\tcompat_sigval_t _sigval;\n\t\t} _rt;\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_pid_t _pid;\t \n\t\t\t__compat_uid32_t _uid;\t \n\t\t\tint _status;\t\t \n\t\t\tcompat_clock_t _utime;\n\t\t\tcompat_clock_t _stime;\n\t\t} _sigchld;\n\n#ifdef CONFIG_X86_X32_ABI\n\t\t \n\t\tstruct {\n\t\t\tcompat_pid_t _pid;\t \n\t\t\t__compat_uid32_t _uid;\t \n\t\t\tint _status;\t\t \n\t\t\tcompat_s64 _utime;\n\t\t\tcompat_s64 _stime;\n\t\t} _sigchld_x32;\n#endif\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_uptr_t _addr;\t \n#define __COMPAT_ADDR_BND_PKEY_PAD  (__alignof__(compat_uptr_t) < sizeof(short) ? \\\n\t\t\t\t     sizeof(short) : __alignof__(compat_uptr_t))\n\t\t\tunion {\n\t\t\t\t \n\t\t\t\tint _trapno;\t \n\t\t\t\t \n\t\t\t\tshort int _addr_lsb;\t \n\t\t\t\t \n\t\t\t\tstruct {\n\t\t\t\t\tchar _dummy_bnd[__COMPAT_ADDR_BND_PKEY_PAD];\n\t\t\t\t\tcompat_uptr_t _lower;\n\t\t\t\t\tcompat_uptr_t _upper;\n\t\t\t\t} _addr_bnd;\n\t\t\t\t \n\t\t\t\tstruct {\n\t\t\t\t\tchar _dummy_pkey[__COMPAT_ADDR_BND_PKEY_PAD];\n\t\t\t\t\tu32 _pkey;\n\t\t\t\t} _addr_pkey;\n\t\t\t\t \n\t\t\t\tstruct {\n\t\t\t\t\tcompat_ulong_t _data;\n\t\t\t\t\tu32 _type;\n\t\t\t\t\tu32 _flags;\n\t\t\t\t} _perf;\n\t\t\t};\n\t\t} _sigfault;\n\n\t\t \n\t\tstruct {\n\t\t\tcompat_long_t _band;\t \n\t\t\tint _fd;\n\t\t} _sigpoll;\n\n\t\tstruct {\n\t\t\tcompat_uptr_t _call_addr;  \n\t\t\tint _syscall;\t \n\t\t\tunsigned int _arch;\t \n\t\t} _sigsys;\n\t} _sifields;\n} compat_siginfo_t;\n\nstruct compat_rlimit {\n\tcompat_ulong_t\trlim_cur;\n\tcompat_ulong_t\trlim_max;\n};\n\n#ifdef __ARCH_NEED_COMPAT_FLOCK64_PACKED\n#define __ARCH_COMPAT_FLOCK64_PACK\t__attribute__((packed))\n#else\n#define __ARCH_COMPAT_FLOCK64_PACK\n#endif\n\nstruct compat_flock {\n\tshort\t\t\tl_type;\n\tshort\t\t\tl_whence;\n\tcompat_off_t\t\tl_start;\n\tcompat_off_t\t\tl_len;\n#ifdef __ARCH_COMPAT_FLOCK_EXTRA_SYSID\n\t__ARCH_COMPAT_FLOCK_EXTRA_SYSID\n#endif\n\tcompat_pid_t\t\tl_pid;\n#ifdef __ARCH_COMPAT_FLOCK_PAD\n\t__ARCH_COMPAT_FLOCK_PAD\n#endif\n};\n\nstruct compat_flock64 {\n\tshort\t\tl_type;\n\tshort\t\tl_whence;\n\tcompat_loff_t\tl_start;\n\tcompat_loff_t\tl_len;\n\tcompat_pid_t\tl_pid;\n#ifdef __ARCH_COMPAT_FLOCK64_PAD\n\t__ARCH_COMPAT_FLOCK64_PAD\n#endif\n} __ARCH_COMPAT_FLOCK64_PACK;\n\nstruct compat_rusage {\n\tstruct old_timeval32 ru_utime;\n\tstruct old_timeval32 ru_stime;\n\tcompat_long_t\tru_maxrss;\n\tcompat_long_t\tru_ixrss;\n\tcompat_long_t\tru_idrss;\n\tcompat_long_t\tru_isrss;\n\tcompat_long_t\tru_minflt;\n\tcompat_long_t\tru_majflt;\n\tcompat_long_t\tru_nswap;\n\tcompat_long_t\tru_inblock;\n\tcompat_long_t\tru_oublock;\n\tcompat_long_t\tru_msgsnd;\n\tcompat_long_t\tru_msgrcv;\n\tcompat_long_t\tru_nsignals;\n\tcompat_long_t\tru_nvcsw;\n\tcompat_long_t\tru_nivcsw;\n};\n\nextern int put_compat_rusage(const struct rusage *,\n\t\t\t     struct compat_rusage __user *);\n\nstruct compat_siginfo;\nstruct __compat_aio_sigset;\n\nstruct compat_dirent {\n\tu32\t\td_ino;\n\tcompat_off_t\td_off;\n\tu16\t\td_reclen;\n\tchar\t\td_name[256];\n};\n\nstruct compat_ustat {\n\tcompat_daddr_t\t\tf_tfree;\n\tcompat_ino_t\t\tf_tinode;\n\tchar\t\t\tf_fname[6];\n\tchar\t\t\tf_fpack[6];\n};\n\n#define COMPAT_SIGEV_PAD_SIZE\t((SIGEV_MAX_SIZE/sizeof(int)) - 3)\n\ntypedef struct compat_sigevent {\n\tcompat_sigval_t sigev_value;\n\tcompat_int_t sigev_signo;\n\tcompat_int_t sigev_notify;\n\tunion {\n\t\tcompat_int_t _pad[COMPAT_SIGEV_PAD_SIZE];\n\t\tcompat_int_t _tid;\n\n\t\tstruct {\n\t\t\tcompat_uptr_t _function;\n\t\t\tcompat_uptr_t _attribute;\n\t\t} _sigev_thread;\n\t} _sigev_un;\n} compat_sigevent_t;\n\nstruct compat_ifmap {\n\tcompat_ulong_t mem_start;\n\tcompat_ulong_t mem_end;\n\tunsigned short base_addr;\n\tunsigned char irq;\n\tunsigned char dma;\n\tunsigned char port;\n};\n\nstruct compat_if_settings {\n\tunsigned int type;\t \n\tunsigned int size;\t \n\tcompat_uptr_t ifs_ifsu;\t \n};\n\nstruct compat_ifreq {\n\tunion {\n\t\tchar\tifrn_name[IFNAMSIZ];     \n\t} ifr_ifrn;\n\tunion {\n\t\tstruct\tsockaddr ifru_addr;\n\t\tstruct\tsockaddr ifru_dstaddr;\n\t\tstruct\tsockaddr ifru_broadaddr;\n\t\tstruct\tsockaddr ifru_netmask;\n\t\tstruct\tsockaddr ifru_hwaddr;\n\t\tshort\tifru_flags;\n\t\tcompat_int_t\tifru_ivalue;\n\t\tcompat_int_t\tifru_mtu;\n\t\tstruct\tcompat_ifmap ifru_map;\n\t\tchar\tifru_slave[IFNAMSIZ];    \n\t\tchar\tifru_newname[IFNAMSIZ];\n\t\tcompat_caddr_t\tifru_data;\n\t\tstruct\tcompat_if_settings ifru_settings;\n\t} ifr_ifru;\n};\n\nstruct compat_ifconf {\n\tcompat_int_t\tifc_len;                 \n\tcompat_caddr_t  ifcbuf;\n};\n\nstruct compat_robust_list {\n\tcompat_uptr_t\t\t\tnext;\n};\n\nstruct compat_robust_list_head {\n\tstruct compat_robust_list\tlist;\n\tcompat_long_t\t\t\tfutex_offset;\n\tcompat_uptr_t\t\t\tlist_op_pending;\n};\n\n#ifdef CONFIG_COMPAT_OLD_SIGACTION\nstruct compat_old_sigaction {\n\tcompat_uptr_t\t\t\tsa_handler;\n\tcompat_old_sigset_t\t\tsa_mask;\n\tcompat_ulong_t\t\t\tsa_flags;\n\tcompat_uptr_t\t\t\tsa_restorer;\n};\n#endif\n\nstruct compat_keyctl_kdf_params {\n\tcompat_uptr_t hashname;\n\tcompat_uptr_t otherinfo;\n\t__u32 otherinfolen;\n\t__u32 __spare[8];\n};\n\nstruct compat_stat;\nstruct compat_statfs;\nstruct compat_statfs64;\nstruct compat_old_linux_dirent;\nstruct compat_linux_dirent;\nstruct linux_dirent64;\nstruct compat_msghdr;\nstruct compat_mmsghdr;\nstruct compat_sysinfo;\nstruct compat_sysctl_args;\nstruct compat_kexec_segment;\nstruct compat_mq_attr;\nstruct compat_msgbuf;\n\nvoid copy_siginfo_to_external32(struct compat_siginfo *to,\n\t\tconst struct kernel_siginfo *from);\nint copy_siginfo_from_user32(kernel_siginfo_t *to,\n\t\tconst struct compat_siginfo __user *from);\nint __copy_siginfo_to_user32(struct compat_siginfo __user *to,\n\t\tconst kernel_siginfo_t *from);\n#ifndef copy_siginfo_to_user32\n#define copy_siginfo_to_user32 __copy_siginfo_to_user32\n#endif\nint get_compat_sigevent(struct sigevent *event,\n\t\tconst struct compat_sigevent __user *u_event);\n\nextern int get_compat_sigset(sigset_t *set, const compat_sigset_t __user *compat);\n\n \nstatic inline int\nput_compat_sigset(compat_sigset_t __user *compat, const sigset_t *set,\n\t\t  unsigned int size)\n{\n\t \n#if defined(__BIG_ENDIAN) && defined(CONFIG_64BIT)\n\tcompat_sigset_t v;\n\tswitch (_NSIG_WORDS) {\n\tcase 4: v.sig[7] = (set->sig[3] >> 32); v.sig[6] = set->sig[3];\n\t\tfallthrough;\n\tcase 3: v.sig[5] = (set->sig[2] >> 32); v.sig[4] = set->sig[2];\n\t\tfallthrough;\n\tcase 2: v.sig[3] = (set->sig[1] >> 32); v.sig[2] = set->sig[1];\n\t\tfallthrough;\n\tcase 1: v.sig[1] = (set->sig[0] >> 32); v.sig[0] = set->sig[0];\n\t}\n\treturn copy_to_user(compat, &v, size) ? -EFAULT : 0;\n#else\n\treturn copy_to_user(compat, set, size) ? -EFAULT : 0;\n#endif\n}\n\n#ifdef CONFIG_CPU_BIG_ENDIAN\n#define unsafe_put_compat_sigset(compat, set, label) do {\t\t\\\n\tcompat_sigset_t __user *__c = compat;\t\t\t\t\\\n\tconst sigset_t *__s = set;\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tswitch (_NSIG_WORDS) {\t\t\t\t\t\t\\\n\tcase 4:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_put_user(__s->sig[3] >> 32, &__c->sig[7], label);\t\\\n\t\tunsafe_put_user(__s->sig[3], &__c->sig[6], label);\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 3:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_put_user(__s->sig[2] >> 32, &__c->sig[5], label);\t\\\n\t\tunsafe_put_user(__s->sig[2], &__c->sig[4], label);\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 2:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_put_user(__s->sig[1] >> 32, &__c->sig[3], label);\t\\\n\t\tunsafe_put_user(__s->sig[1], &__c->sig[2], label);\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 1:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_put_user(__s->sig[0] >> 32, &__c->sig[1], label);\t\\\n\t\tunsafe_put_user(__s->sig[0], &__c->sig[0], label);\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define unsafe_get_compat_sigset(set, compat, label) do {\t\t\\\n\tconst compat_sigset_t __user *__c = compat;\t\t\t\\\n\tcompat_sigset_word hi, lo;\t\t\t\t\t\\\n\tsigset_t *__s = set;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tswitch (_NSIG_WORDS) {\t\t\t\t\t\t\\\n\tcase 4:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_get_user(lo, &__c->sig[7], label);\t\t\\\n\t\tunsafe_get_user(hi, &__c->sig[6], label);\t\t\\\n\t\t__s->sig[3] = hi | (((long)lo) << 32);\t\t\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 3:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_get_user(lo, &__c->sig[5], label);\t\t\\\n\t\tunsafe_get_user(hi, &__c->sig[4], label);\t\t\\\n\t\t__s->sig[2] = hi | (((long)lo) << 32);\t\t\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 2:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_get_user(lo, &__c->sig[3], label);\t\t\\\n\t\tunsafe_get_user(hi, &__c->sig[2], label);\t\t\\\n\t\t__s->sig[1] = hi | (((long)lo) << 32);\t\t\t\\\n\t\tfallthrough;\t\t\t\t\t\t\\\n\tcase 1:\t\t\t\t\t\t\t\t\\\n\t\tunsafe_get_user(lo, &__c->sig[1], label);\t\t\\\n\t\tunsafe_get_user(hi, &__c->sig[0], label);\t\t\\\n\t\t__s->sig[0] = hi | (((long)lo) << 32);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n#else\n#define unsafe_put_compat_sigset(compat, set, label) do {\t\t\\\n\tcompat_sigset_t __user *__c = compat;\t\t\t\t\\\n\tconst sigset_t *__s = set;\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tunsafe_copy_to_user(__c, __s, sizeof(*__c), label);\t\t\\\n} while (0)\n\n#define unsafe_get_compat_sigset(set, compat, label) do {\t\t\\\n\tconst compat_sigset_t __user *__c = compat;\t\t\t\\\n\tsigset_t *__s = set;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tunsafe_copy_from_user(__s, __c, sizeof(*__c), label);\t\t\\\n} while (0)\n#endif\n\nextern int compat_ptrace_request(struct task_struct *child,\n\t\t\t\t compat_long_t request,\n\t\t\t\t compat_ulong_t addr, compat_ulong_t data);\n\nextern long compat_arch_ptrace(struct task_struct *child, compat_long_t request,\n\t\t\t       compat_ulong_t addr, compat_ulong_t data);\n\nstruct epoll_event;\t \n\nint compat_restore_altstack(const compat_stack_t __user *uss);\nint __compat_save_altstack(compat_stack_t __user *, unsigned long);\n#define unsafe_compat_save_altstack(uss, sp, label) do { \\\n\tcompat_stack_t __user *__uss = uss; \\\n\tstruct task_struct *t = current; \\\n\tunsafe_put_user(ptr_to_compat((void __user *)t->sas_ss_sp), \\\n\t\t\t&__uss->ss_sp, label); \\\n\tunsafe_put_user(t->sas_ss_flags, &__uss->ss_flags, label); \\\n\tunsafe_put_user(t->sas_ss_size, &__uss->ss_size, label); \\\n} while (0);\n\n \n#ifndef CONFIG_ARCH_HAS_SYSCALL_WRAPPER\nasmlinkage long compat_sys_io_setup(unsigned nr_reqs, u32 __user *ctx32p);\nasmlinkage long compat_sys_io_submit(compat_aio_context_t ctx_id, int nr,\n\t\t\t\t     u32 __user *iocb);\nasmlinkage long compat_sys_io_pgetevents(compat_aio_context_t ctx_id,\n\t\t\t\t\tcompat_long_t min_nr,\n\t\t\t\t\tcompat_long_t nr,\n\t\t\t\t\tstruct io_event __user *events,\n\t\t\t\t\tstruct old_timespec32 __user *timeout,\n\t\t\t\t\tconst struct __compat_aio_sigset __user *usig);\nasmlinkage long compat_sys_io_pgetevents_time64(compat_aio_context_t ctx_id,\n\t\t\t\t\tcompat_long_t min_nr,\n\t\t\t\t\tcompat_long_t nr,\n\t\t\t\t\tstruct io_event __user *events,\n\t\t\t\t\tstruct __kernel_timespec __user *timeout,\n\t\t\t\t\tconst struct __compat_aio_sigset __user *usig);\nasmlinkage long compat_sys_lookup_dcookie(u32, u32, char __user *, compat_size_t);\nasmlinkage long compat_sys_epoll_pwait(int epfd,\n\t\t\tstruct epoll_event __user *events,\n\t\t\tint maxevents, int timeout,\n\t\t\tconst compat_sigset_t __user *sigmask,\n\t\t\tcompat_size_t sigsetsize);\nasmlinkage long compat_sys_epoll_pwait2(int epfd,\n\t\t\tstruct epoll_event __user *events,\n\t\t\tint maxevents,\n\t\t\tconst struct __kernel_timespec __user *timeout,\n\t\t\tconst compat_sigset_t __user *sigmask,\n\t\t\tcompat_size_t sigsetsize);\nasmlinkage long compat_sys_fcntl(unsigned int fd, unsigned int cmd,\n\t\t\t\t compat_ulong_t arg);\nasmlinkage long compat_sys_fcntl64(unsigned int fd, unsigned int cmd,\n\t\t\t\t   compat_ulong_t arg);\nasmlinkage long compat_sys_ioctl(unsigned int fd, unsigned int cmd,\n\t\t\t\t compat_ulong_t arg);\nasmlinkage long compat_sys_statfs(const char __user *pathname,\n\t\t\t\t  struct compat_statfs __user *buf);\nasmlinkage long compat_sys_statfs64(const char __user *pathname,\n\t\t\t\t    compat_size_t sz,\n\t\t\t\t    struct compat_statfs64 __user *buf);\nasmlinkage long compat_sys_fstatfs(unsigned int fd,\n\t\t\t\t   struct compat_statfs __user *buf);\nasmlinkage long compat_sys_fstatfs64(unsigned int fd, compat_size_t sz,\n\t\t\t\t     struct compat_statfs64 __user *buf);\nasmlinkage long compat_sys_truncate(const char __user *, compat_off_t);\nasmlinkage long compat_sys_ftruncate(unsigned int, compat_ulong_t);\n \nasmlinkage long compat_sys_openat(int dfd, const char __user *filename,\n\t\t\t\t  int flags, umode_t mode);\nasmlinkage long compat_sys_getdents(unsigned int fd,\n\t\t\t\t    struct compat_linux_dirent __user *dirent,\n\t\t\t\t    unsigned int count);\nasmlinkage long compat_sys_lseek(unsigned int, compat_off_t, unsigned int);\n \nasmlinkage ssize_t compat_sys_preadv(compat_ulong_t fd,\n\t\tconst struct iovec __user *vec,\n\t\tcompat_ulong_t vlen, u32 pos_low, u32 pos_high);\nasmlinkage ssize_t compat_sys_pwritev(compat_ulong_t fd,\n\t\tconst struct iovec __user *vec,\n\t\tcompat_ulong_t vlen, u32 pos_low, u32 pos_high);\n#ifdef __ARCH_WANT_COMPAT_SYS_PREADV64\nasmlinkage long compat_sys_preadv64(unsigned long fd,\n\t\tconst struct iovec __user *vec,\n\t\tunsigned long vlen, loff_t pos);\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_SYS_PWRITEV64\nasmlinkage long compat_sys_pwritev64(unsigned long fd,\n\t\tconst struct iovec __user *vec,\n\t\tunsigned long vlen, loff_t pos);\n#endif\nasmlinkage long compat_sys_sendfile(int out_fd, int in_fd,\n\t\t\t\t    compat_off_t __user *offset, compat_size_t count);\nasmlinkage long compat_sys_sendfile64(int out_fd, int in_fd,\n\t\t\t\t    compat_loff_t __user *offset, compat_size_t count);\nasmlinkage long compat_sys_pselect6_time32(int n, compat_ulong_t __user *inp,\n\t\t\t\t    compat_ulong_t __user *outp,\n\t\t\t\t    compat_ulong_t __user *exp,\n\t\t\t\t    struct old_timespec32 __user *tsp,\n\t\t\t\t    void __user *sig);\nasmlinkage long compat_sys_pselect6_time64(int n, compat_ulong_t __user *inp,\n\t\t\t\t    compat_ulong_t __user *outp,\n\t\t\t\t    compat_ulong_t __user *exp,\n\t\t\t\t    struct __kernel_timespec __user *tsp,\n\t\t\t\t    void __user *sig);\nasmlinkage long compat_sys_ppoll_time32(struct pollfd __user *ufds,\n\t\t\t\t unsigned int nfds,\n\t\t\t\t struct old_timespec32 __user *tsp,\n\t\t\t\t const compat_sigset_t __user *sigmask,\n\t\t\t\t compat_size_t sigsetsize);\nasmlinkage long compat_sys_ppoll_time64(struct pollfd __user *ufds,\n\t\t\t\t unsigned int nfds,\n\t\t\t\t struct __kernel_timespec __user *tsp,\n\t\t\t\t const compat_sigset_t __user *sigmask,\n\t\t\t\t compat_size_t sigsetsize);\nasmlinkage long compat_sys_signalfd4(int ufd,\n\t\t\t\t     const compat_sigset_t __user *sigmask,\n\t\t\t\t     compat_size_t sigsetsize, int flags);\nasmlinkage long compat_sys_newfstatat(unsigned int dfd,\n\t\t\t\t      const char __user *filename,\n\t\t\t\t      struct compat_stat __user *statbuf,\n\t\t\t\t      int flag);\nasmlinkage long compat_sys_newfstat(unsigned int fd,\n\t\t\t\t    struct compat_stat __user *statbuf);\n \nasmlinkage long compat_sys_waitid(int, compat_pid_t,\n\t\tstruct compat_siginfo __user *, int,\n\t\tstruct compat_rusage __user *);\nasmlinkage long\ncompat_sys_set_robust_list(struct compat_robust_list_head __user *head,\n\t\t\t   compat_size_t len);\nasmlinkage long\ncompat_sys_get_robust_list(int pid, compat_uptr_t __user *head_ptr,\n\t\t\t   compat_size_t __user *len_ptr);\nasmlinkage long compat_sys_getitimer(int which,\n\t\t\t\t     struct old_itimerval32 __user *it);\nasmlinkage long compat_sys_setitimer(int which,\n\t\t\t\t     struct old_itimerval32 __user *in,\n\t\t\t\t     struct old_itimerval32 __user *out);\nasmlinkage long compat_sys_kexec_load(compat_ulong_t entry,\n\t\t\t\t      compat_ulong_t nr_segments,\n\t\t\t\t      struct compat_kexec_segment __user *,\n\t\t\t\t      compat_ulong_t flags);\nasmlinkage long compat_sys_timer_create(clockid_t which_clock,\n\t\t\tstruct compat_sigevent __user *timer_event_spec,\n\t\t\ttimer_t __user *created_timer_id);\nasmlinkage long compat_sys_ptrace(compat_long_t request, compat_long_t pid,\n\t\t\t\t  compat_long_t addr, compat_long_t data);\nasmlinkage long compat_sys_sched_setaffinity(compat_pid_t pid,\n\t\t\t\t     unsigned int len,\n\t\t\t\t     compat_ulong_t __user *user_mask_ptr);\nasmlinkage long compat_sys_sched_getaffinity(compat_pid_t pid,\n\t\t\t\t     unsigned int len,\n\t\t\t\t     compat_ulong_t __user *user_mask_ptr);\nasmlinkage long compat_sys_sigaltstack(const compat_stack_t __user *uss_ptr,\n\t\t\t\t       compat_stack_t __user *uoss_ptr);\nasmlinkage long compat_sys_rt_sigsuspend(compat_sigset_t __user *unewset,\n\t\t\t\t\t compat_size_t sigsetsize);\n#ifndef CONFIG_ODD_RT_SIGACTION\nasmlinkage long compat_sys_rt_sigaction(int,\n\t\t\t\t const struct compat_sigaction __user *,\n\t\t\t\t struct compat_sigaction __user *,\n\t\t\t\t compat_size_t);\n#endif\nasmlinkage long compat_sys_rt_sigprocmask(int how, compat_sigset_t __user *set,\n\t\t\t\t\t  compat_sigset_t __user *oset,\n\t\t\t\t\t  compat_size_t sigsetsize);\nasmlinkage long compat_sys_rt_sigpending(compat_sigset_t __user *uset,\n\t\t\t\t\t compat_size_t sigsetsize);\nasmlinkage long compat_sys_rt_sigtimedwait_time32(compat_sigset_t __user *uthese,\n\t\tstruct compat_siginfo __user *uinfo,\n\t\tstruct old_timespec32 __user *uts, compat_size_t sigsetsize);\nasmlinkage long compat_sys_rt_sigtimedwait_time64(compat_sigset_t __user *uthese,\n\t\tstruct compat_siginfo __user *uinfo,\n\t\tstruct __kernel_timespec __user *uts, compat_size_t sigsetsize);\nasmlinkage long compat_sys_rt_sigqueueinfo(compat_pid_t pid, int sig,\n\t\t\t\tstruct compat_siginfo __user *uinfo);\n \nasmlinkage long compat_sys_times(struct compat_tms __user *tbuf);\nasmlinkage long compat_sys_getrlimit(unsigned int resource,\n\t\t\t\t     struct compat_rlimit __user *rlim);\nasmlinkage long compat_sys_setrlimit(unsigned int resource,\n\t\t\t\t     struct compat_rlimit __user *rlim);\nasmlinkage long compat_sys_getrusage(int who, struct compat_rusage __user *ru);\nasmlinkage long compat_sys_gettimeofday(struct old_timeval32 __user *tv,\n\t\tstruct timezone __user *tz);\nasmlinkage long compat_sys_settimeofday(struct old_timeval32 __user *tv,\n\t\tstruct timezone __user *tz);\nasmlinkage long compat_sys_sysinfo(struct compat_sysinfo __user *info);\nasmlinkage long compat_sys_mq_open(const char __user *u_name,\n\t\t\tint oflag, compat_mode_t mode,\n\t\t\tstruct compat_mq_attr __user *u_attr);\nasmlinkage long compat_sys_mq_notify(mqd_t mqdes,\n\t\t\tconst struct compat_sigevent __user *u_notification);\nasmlinkage long compat_sys_mq_getsetattr(mqd_t mqdes,\n\t\t\tconst struct compat_mq_attr __user *u_mqstat,\n\t\t\tstruct compat_mq_attr __user *u_omqstat);\nasmlinkage long compat_sys_msgctl(int first, int second, void __user *uptr);\nasmlinkage long compat_sys_msgrcv(int msqid, compat_uptr_t msgp,\n\t\tcompat_ssize_t msgsz, compat_long_t msgtyp, int msgflg);\nasmlinkage long compat_sys_msgsnd(int msqid, compat_uptr_t msgp,\n\t\tcompat_ssize_t msgsz, int msgflg);\nasmlinkage long compat_sys_semctl(int semid, int semnum, int cmd, int arg);\nasmlinkage long compat_sys_shmctl(int first, int second, void __user *uptr);\nasmlinkage long compat_sys_shmat(int shmid, compat_uptr_t shmaddr, int shmflg);\nasmlinkage long compat_sys_recvfrom(int fd, void __user *buf, compat_size_t len,\n\t\t\t    unsigned flags, struct sockaddr __user *addr,\n\t\t\t    int __user *addrlen);\nasmlinkage long compat_sys_sendmsg(int fd, struct compat_msghdr __user *msg,\n\t\t\t\t   unsigned flags);\nasmlinkage long compat_sys_recvmsg(int fd, struct compat_msghdr __user *msg,\n\t\t\t\t   unsigned int flags);\n \nasmlinkage long compat_sys_keyctl(u32 option,\n\t\t\t      u32 arg2, u32 arg3, u32 arg4, u32 arg5);\nasmlinkage long compat_sys_execve(const char __user *filename, const compat_uptr_t __user *argv,\n\t\t     const compat_uptr_t __user *envp);\n \n \nasmlinkage long compat_sys_rt_tgsigqueueinfo(compat_pid_t tgid,\n\t\t\t\t\tcompat_pid_t pid, int sig,\n\t\t\t\t\tstruct compat_siginfo __user *uinfo);\nasmlinkage long compat_sys_recvmmsg_time64(int fd, struct compat_mmsghdr __user *mmsg,\n\t\t\t\t    unsigned vlen, unsigned int flags,\n\t\t\t\t    struct __kernel_timespec __user *timeout);\nasmlinkage long compat_sys_recvmmsg_time32(int fd, struct compat_mmsghdr __user *mmsg,\n\t\t\t\t    unsigned vlen, unsigned int flags,\n\t\t\t\t    struct old_timespec32 __user *timeout);\nasmlinkage long compat_sys_wait4(compat_pid_t pid,\n\t\t\t\t compat_uint_t __user *stat_addr, int options,\n\t\t\t\t struct compat_rusage __user *ru);\nasmlinkage long compat_sys_fanotify_mark(int, unsigned int, __u32, __u32,\n\t\t\t\t\t    int, const char __user *);\nasmlinkage long compat_sys_open_by_handle_at(int mountdirfd,\n\t\t\t\t\t     struct file_handle __user *handle,\n\t\t\t\t\t     int flags);\nasmlinkage long compat_sys_sendmmsg(int fd, struct compat_mmsghdr __user *mmsg,\n\t\t\t\t    unsigned vlen, unsigned int flags);\nasmlinkage long compat_sys_execveat(int dfd, const char __user *filename,\n\t\t     const compat_uptr_t __user *argv,\n\t\t     const compat_uptr_t __user *envp, int flags);\nasmlinkage ssize_t compat_sys_preadv2(compat_ulong_t fd,\n\t\tconst struct iovec __user *vec,\n\t\tcompat_ulong_t vlen, u32 pos_low, u32 pos_high, rwf_t flags);\nasmlinkage ssize_t compat_sys_pwritev2(compat_ulong_t fd,\n\t\tconst struct iovec __user *vec,\n\t\tcompat_ulong_t vlen, u32 pos_low, u32 pos_high, rwf_t flags);\n#ifdef __ARCH_WANT_COMPAT_SYS_PREADV64V2\nasmlinkage long  compat_sys_preadv64v2(unsigned long fd,\n\t\tconst struct iovec __user *vec,\n\t\tunsigned long vlen, loff_t pos, rwf_t flags);\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_SYS_PWRITEV64V2\nasmlinkage long compat_sys_pwritev64v2(unsigned long fd,\n\t\tconst struct iovec __user *vec,\n\t\tunsigned long vlen, loff_t pos, rwf_t flags);\n#endif\n\n\n \n\n \nasmlinkage long compat_sys_open(const char __user *filename, int flags,\n\t\t\t\tumode_t mode);\n\n \nasmlinkage long compat_sys_signalfd(int ufd,\n\t\t\t\t    const compat_sigset_t __user *sigmask,\n\t\t\t\t    compat_size_t sigsetsize);\n\n \nasmlinkage long compat_sys_newstat(const char __user *filename,\n\t\t\t\t   struct compat_stat __user *statbuf);\nasmlinkage long compat_sys_newlstat(const char __user *filename,\n\t\t\t\t    struct compat_stat __user *statbuf);\n\n \nasmlinkage long compat_sys_select(int n, compat_ulong_t __user *inp,\n\t\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\t\tstruct old_timeval32 __user *tvp);\nasmlinkage long compat_sys_ustat(unsigned dev, struct compat_ustat __user *u32);\nasmlinkage long compat_sys_recv(int fd, void __user *buf, compat_size_t len,\n\t\t\t\tunsigned flags);\n\n \nasmlinkage long compat_sys_old_readdir(unsigned int fd,\n\t\t\t\t       struct compat_old_linux_dirent __user *,\n\t\t\t\t       unsigned int count);\n\n \nasmlinkage long compat_sys_old_select(struct compat_sel_arg_struct __user *arg);\n\n \nasmlinkage long compat_sys_ipc(u32, int, int, u32, compat_uptr_t, u32);\n\n \n#ifdef __ARCH_WANT_SYS_SIGPENDING\nasmlinkage long compat_sys_sigpending(compat_old_sigset_t __user *set);\n#endif\n\n#ifdef __ARCH_WANT_SYS_SIGPROCMASK\nasmlinkage long compat_sys_sigprocmask(int how, compat_old_sigset_t __user *nset,\n\t\t\t\t       compat_old_sigset_t __user *oset);\n#endif\n#ifdef CONFIG_COMPAT_OLD_SIGACTION\nasmlinkage long compat_sys_sigaction(int sig,\n                                   const struct compat_old_sigaction __user *act,\n                                   struct compat_old_sigaction __user *oact);\n#endif\n\n \nasmlinkage long compat_sys_socketcall(int call, u32 __user *args);\n\n#ifdef __ARCH_WANT_COMPAT_TRUNCATE64\nasmlinkage long compat_sys_truncate64(const char __user *pathname, compat_arg_u64(len));\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_FTRUNCATE64\nasmlinkage long compat_sys_ftruncate64(unsigned int fd, compat_arg_u64(len));\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_FALLOCATE\nasmlinkage long compat_sys_fallocate(int fd, int mode, compat_arg_u64(offset),\n\t\t\t\t     compat_arg_u64(len));\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_PREAD64\nasmlinkage long compat_sys_pread64(unsigned int fd, char __user *buf, size_t count,\n\t\t\t\t   compat_arg_u64(pos));\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_PWRITE64\nasmlinkage long compat_sys_pwrite64(unsigned int fd, const char __user *buf, size_t count,\n\t\t\t\t    compat_arg_u64(pos));\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_SYNC_FILE_RANGE\nasmlinkage long compat_sys_sync_file_range(int fd, compat_arg_u64(pos),\n\t\t\t\t\t   compat_arg_u64(nbytes), unsigned int flags);\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_FADVISE64_64\nasmlinkage long compat_sys_fadvise64_64(int fd, compat_arg_u64(pos),\n\t\t\t\t\tcompat_arg_u64(len), int advice);\n#endif\n\n#ifdef __ARCH_WANT_COMPAT_READAHEAD\nasmlinkage long compat_sys_readahead(int fd, compat_arg_u64(offset), size_t count);\n#endif\n\n#endif  \n\n \nstatic inline struct old_timeval32 ns_to_old_timeval32(s64 nsec)\n{\n\tstruct __kernel_old_timeval tv;\n\tstruct old_timeval32 ctv;\n\n\ttv = ns_to_kernel_old_timeval(nsec);\n\tctv.tv_sec = tv.tv_sec;\n\tctv.tv_usec = tv.tv_usec;\n\n\treturn ctv;\n}\n\n \n\nint kcompat_sys_statfs64(const char __user * pathname, compat_size_t sz,\n\t\t     struct compat_statfs64 __user * buf);\nint kcompat_sys_fstatfs64(unsigned int fd, compat_size_t sz,\n\t\t\t  struct compat_statfs64 __user * buf);\n\n#ifdef CONFIG_COMPAT\n\n \n#ifndef in_compat_syscall\nstatic inline bool in_compat_syscall(void) { return is_compat_task(); }\n#endif\n\n#else  \n\n#define is_compat_task() (0)\n \n#define in_compat_syscall in_compat_syscall\nstatic inline bool in_compat_syscall(void) { return false; }\n\n#endif  \n\n#define BITS_PER_COMPAT_LONG    (8*sizeof(compat_long_t))\n\n#define BITS_TO_COMPAT_LONGS(bits) DIV_ROUND_UP(bits, BITS_PER_COMPAT_LONG)\n\nlong compat_get_bitmap(unsigned long *mask, const compat_ulong_t __user *umask,\n\t\t       unsigned long bitmap_size);\nlong compat_put_bitmap(compat_ulong_t __user *umask, unsigned long *mask,\n\t\t       unsigned long bitmap_size);\n\n \n#ifndef compat_need_64bit_alignment_fixup\n#define compat_need_64bit_alignment_fixup()\t\tfalse\n#endif\n\n \n#ifndef compat_ptr\nstatic inline void __user *compat_ptr(compat_uptr_t uptr)\n{\n\treturn (void __user *)(unsigned long)uptr;\n}\n#endif\n\nstatic inline compat_uptr_t ptr_to_compat(void __user *uptr)\n{\n\treturn (u32)(unsigned long)uptr;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}