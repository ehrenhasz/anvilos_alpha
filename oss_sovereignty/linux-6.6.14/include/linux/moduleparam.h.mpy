{
  "module_name": "moduleparam.h",
  "hash_id": "1ab4db7572f834741da7da7913143081c9c748800ced9638992469992a97103a",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/moduleparam.h",
  "human_readable_source": " \n#ifndef _LINUX_MODULE_PARAMS_H\n#define _LINUX_MODULE_PARAMS_H\n \n#include <linux/init.h>\n#include <linux/stringify.h>\n#include <linux/kernel.h>\n\n \n#ifdef MODULE\n#define MODULE_PARAM_PREFIX  \n#define __MODULE_INFO_PREFIX  \n#else\n#define MODULE_PARAM_PREFIX KBUILD_MODNAME \".\"\n \n#define __MODULE_INFO_PREFIX KBUILD_MODNAME \".\"\n#endif\n\n \n#define MAX_PARAM_PREFIX_LEN (64 - sizeof(unsigned long))\n\n#define __MODULE_INFO(tag, name, info)\t\t\t\t\t  \\\n\tstatic const char __UNIQUE_ID(name)[]\t\t\t\t  \\\n\t\t__used __section(\".modinfo\") __aligned(1)\t\t  \\\n\t\t= __MODULE_INFO_PREFIX __stringify(tag) \"=\" info\n\n#define __MODULE_PARM_TYPE(name, _type)\t\t\t\t\t  \\\n\t__MODULE_INFO(parmtype, name##type, #name \":\" _type)\n\n \n#define MODULE_PARM_DESC(_parm, desc) \\\n\t__MODULE_INFO(parm, _parm, #_parm \":\" desc)\n\nstruct kernel_param;\n\n \nenum {\n\tKERNEL_PARAM_OPS_FL_NOARG = (1 << 0)\n};\n\nstruct kernel_param_ops {\n\t \n\tunsigned int flags;\n\t \n\tint (*set)(const char *val, const struct kernel_param *kp);\n\t \n\tint (*get)(char *buffer, const struct kernel_param *kp);\n\t \n\tvoid (*free)(void *arg);\n};\n\n \nenum {\n\tKERNEL_PARAM_FL_UNSAFE\t= (1 << 0),\n\tKERNEL_PARAM_FL_HWPARAM\t= (1 << 1),\n};\n\nstruct kernel_param {\n\tconst char *name;\n\tstruct module *mod;\n\tconst struct kernel_param_ops *ops;\n\tconst u16 perm;\n\ts8 level;\n\tu8 flags;\n\tunion {\n\t\tvoid *arg;\n\t\tconst struct kparam_string *str;\n\t\tconst struct kparam_array *arr;\n\t};\n};\n\nextern const struct kernel_param __start___param[], __stop___param[];\n\n \nstruct kparam_string {\n\tunsigned int maxlen;\n\tchar *string;\n};\n\n \nstruct kparam_array\n{\n\tunsigned int max;\n\tunsigned int elemsize;\n\tunsigned int *num;\n\tconst struct kernel_param_ops *ops;\n\tvoid *elem;\n};\n\n \n#define module_param(name, type, perm)\t\t\t\t\\\n\tmodule_param_named(name, name, type, perm)\n\n \n#define module_param_unsafe(name, type, perm)\t\t\t\\\n\tmodule_param_named_unsafe(name, name, type, perm)\n\n \n#define module_param_named(name, value, type, perm)\t\t\t   \\\n\tparam_check_##type(name, &(value));\t\t\t\t   \\\n\tmodule_param_cb(name, &param_ops_##type, &value, perm);\t\t   \\\n\t__MODULE_PARM_TYPE(name, #type)\n\n \n#define module_param_named_unsafe(name, value, type, perm)\t\t\\\n\tparam_check_##type(name, &(value));\t\t\t\t\\\n\tmodule_param_cb_unsafe(name, &param_ops_##type, &value, perm);\t\\\n\t__MODULE_PARM_TYPE(name, #type)\n\n \n#define module_param_cb(name, ops, arg, perm)\t\t\t\t      \\\n\t__module_param_call(MODULE_PARAM_PREFIX, name, ops, arg, perm, -1, 0)\n\n#define module_param_cb_unsafe(name, ops, arg, perm)\t\t\t      \\\n\t__module_param_call(MODULE_PARAM_PREFIX, name, ops, arg, perm, -1,    \\\n\t\t\t    KERNEL_PARAM_FL_UNSAFE)\n\n#define __level_param_cb(name, ops, arg, perm, level)\t\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX, name, ops, arg, perm, level, 0)\n \n#define core_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 1)\n\n \n#define postcore_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 2)\n\n \n#define arch_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 3)\n\n \n#define subsys_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 4)\n\n \n#define fs_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 5)\n\n \n#define device_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 6)\n\n \n#define late_param_cb(name, ops, arg, perm)\t\t\\\n\t__level_param_cb(name, ops, arg, perm, 7)\n\n \n#if defined(CONFIG_ALPHA) || defined(CONFIG_IA64) || defined(CONFIG_PPC64)\n#define __moduleparam_const\n#else\n#define __moduleparam_const const\n#endif\n\n \n#define __module_param_call(prefix, name, ops, arg, perm, level, flags)\t\\\n\t \t\t\t\\\n\tstatic const char __param_str_##name[] = prefix #name;\t\t\\\n\tstatic struct kernel_param __moduleparam_const __param_##name\t\\\n\t__used __section(\"__param\")\t\t\t\t\t\\\n\t__aligned(__alignof__(struct kernel_param))\t\t\t\\\n\t= { __param_str_##name, THIS_MODULE, ops,\t\t\t\\\n\t    VERIFY_OCTAL_PERMISSIONS(perm), level, flags, { arg } }\n\n \n#define module_param_call(name, _set, _get, arg, perm)\t\t\t\\\n\tstatic const struct kernel_param_ops __param_ops_##name =\t\\\n\t\t{ .flags = 0, .set = _set, .get = _get };\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX,\t\t\t\\\n\t\t\t    name, &__param_ops_##name, arg, perm, -1, 0)\n\n#ifdef CONFIG_SYSFS\nextern void kernel_param_lock(struct module *mod);\nextern void kernel_param_unlock(struct module *mod);\n#else\nstatic inline void kernel_param_lock(struct module *mod)\n{\n}\nstatic inline void kernel_param_unlock(struct module *mod)\n{\n}\n#endif\n\n#ifndef MODULE\n \n#define core_param(name, var, type, perm)\t\t\t\t\\\n\tparam_check_##type(name, &(var));\t\t\t\t\\\n\t__module_param_call(\"\", name, &param_ops_##type, &var, perm, -1, 0)\n\n \n#define core_param_unsafe(name, var, type, perm)\t\t\\\n\tparam_check_##type(name, &(var));\t\t\t\t\\\n\t__module_param_call(\"\", name, &param_ops_##type, &var, perm,\t\\\n\t\t\t    -1, KERNEL_PARAM_FL_UNSAFE)\n\n#endif  \n\n \n#define module_param_string(name, string, len, perm)\t\t\t\\\n\tstatic const struct kparam_string __param_string_##name\t\t\\\n\t\t= { len, string };\t\t\t\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX, name,\t\t\t\\\n\t\t\t    &param_ops_string,\t\t\t\t\\\n\t\t\t    .str = &__param_string_##name, perm, -1, 0);\\\n\t__MODULE_PARM_TYPE(name, \"string\")\n\n \nextern bool parameq(const char *name1, const char *name2);\n\n \nextern bool parameqn(const char *name1, const char *name2, size_t n);\n\n \nextern char *parse_args(const char *name,\n\t\t      char *args,\n\t\t      const struct kernel_param *params,\n\t\t      unsigned num,\n\t\t      s16 level_min,\n\t\t      s16 level_max,\n\t\t      void *arg,\n\t\t      int (*unknown)(char *param, char *val,\n\t\t\t\t     const char *doing, void *arg));\n\n \n#ifdef CONFIG_SYSFS\nextern void destroy_params(const struct kernel_param *params, unsigned num);\n#else\nstatic inline void destroy_params(const struct kernel_param *params,\n\t\t\t\t  unsigned num)\n{\n}\n#endif  \n\n \n \n#define __param_check(name, p, type) \\\n\tstatic inline type __always_unused *__check_##name(void) { return(p); }\n\nextern const struct kernel_param_ops param_ops_byte;\nextern int param_set_byte(const char *val, const struct kernel_param *kp);\nextern int param_get_byte(char *buffer, const struct kernel_param *kp);\n#define param_check_byte(name, p) __param_check(name, p, unsigned char)\n\nextern const struct kernel_param_ops param_ops_short;\nextern int param_set_short(const char *val, const struct kernel_param *kp);\nextern int param_get_short(char *buffer, const struct kernel_param *kp);\n#define param_check_short(name, p) __param_check(name, p, short)\n\nextern const struct kernel_param_ops param_ops_ushort;\nextern int param_set_ushort(const char *val, const struct kernel_param *kp);\nextern int param_get_ushort(char *buffer, const struct kernel_param *kp);\n#define param_check_ushort(name, p) __param_check(name, p, unsigned short)\n\nextern const struct kernel_param_ops param_ops_int;\nextern int param_set_int(const char *val, const struct kernel_param *kp);\nextern int param_get_int(char *buffer, const struct kernel_param *kp);\n#define param_check_int(name, p) __param_check(name, p, int)\n\nextern const struct kernel_param_ops param_ops_uint;\nextern int param_set_uint(const char *val, const struct kernel_param *kp);\nextern int param_get_uint(char *buffer, const struct kernel_param *kp);\nint param_set_uint_minmax(const char *val, const struct kernel_param *kp,\n\t\tunsigned int min, unsigned int max);\n#define param_check_uint(name, p) __param_check(name, p, unsigned int)\n\nextern const struct kernel_param_ops param_ops_long;\nextern int param_set_long(const char *val, const struct kernel_param *kp);\nextern int param_get_long(char *buffer, const struct kernel_param *kp);\n#define param_check_long(name, p) __param_check(name, p, long)\n\nextern const struct kernel_param_ops param_ops_ulong;\nextern int param_set_ulong(const char *val, const struct kernel_param *kp);\nextern int param_get_ulong(char *buffer, const struct kernel_param *kp);\n#define param_check_ulong(name, p) __param_check(name, p, unsigned long)\n\nextern const struct kernel_param_ops param_ops_ullong;\nextern int param_set_ullong(const char *val, const struct kernel_param *kp);\nextern int param_get_ullong(char *buffer, const struct kernel_param *kp);\n#define param_check_ullong(name, p) __param_check(name, p, unsigned long long)\n\nextern const struct kernel_param_ops param_ops_hexint;\nextern int param_set_hexint(const char *val, const struct kernel_param *kp);\nextern int param_get_hexint(char *buffer, const struct kernel_param *kp);\n#define param_check_hexint(name, p) param_check_uint(name, p)\n\nextern const struct kernel_param_ops param_ops_charp;\nextern int param_set_charp(const char *val, const struct kernel_param *kp);\nextern int param_get_charp(char *buffer, const struct kernel_param *kp);\nextern void param_free_charp(void *arg);\n#define param_check_charp(name, p) __param_check(name, p, char *)\n\n \nextern const struct kernel_param_ops param_ops_bool;\nextern int param_set_bool(const char *val, const struct kernel_param *kp);\nextern int param_get_bool(char *buffer, const struct kernel_param *kp);\n#define param_check_bool(name, p) __param_check(name, p, bool)\n\nextern const struct kernel_param_ops param_ops_bool_enable_only;\nextern int param_set_bool_enable_only(const char *val,\n\t\t\t\t      const struct kernel_param *kp);\n \n#define param_check_bool_enable_only param_check_bool\n\nextern const struct kernel_param_ops param_ops_invbool;\nextern int param_set_invbool(const char *val, const struct kernel_param *kp);\nextern int param_get_invbool(char *buffer, const struct kernel_param *kp);\n#define param_check_invbool(name, p) __param_check(name, p, bool)\n\n \nextern const struct kernel_param_ops param_ops_bint;\nextern int param_set_bint(const char *val, const struct kernel_param *kp);\n#define param_get_bint param_get_int\n#define param_check_bint param_check_int\n\n \n#define module_param_array(name, type, nump, perm)\t\t\\\n\tmodule_param_array_named(name, name, type, nump, perm)\n\n \n#define module_param_array_named(name, array, type, nump, perm)\t\t\\\n\tparam_check_##type(name, &(array)[0]);\t\t\t\t\\\n\tstatic const struct kparam_array __param_arr_##name\t\t\\\n\t= { .max = ARRAY_SIZE(array), .num = nump,                      \\\n\t    .ops = &param_ops_##type,\t\t\t\t\t\\\n\t    .elemsize = sizeof(array[0]), .elem = array };\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX, name,\t\t\t\\\n\t\t\t    &param_array_ops,\t\t\t\t\\\n\t\t\t    .arr = &__param_arr_##name,\t\t\t\\\n\t\t\t    perm, -1, 0);\t\t\t\t\\\n\t__MODULE_PARM_TYPE(name, \"array of \" #type)\n\nenum hwparam_type {\n\thwparam_ioport,\t\t \n\thwparam_iomem,\t\t \n\thwparam_ioport_or_iomem,  \n\thwparam_irq,\t\t \n\thwparam_dma,\t\t \n\thwparam_dma_addr,\t \n\thwparam_other,\t\t \n};\n\n \n#define module_param_hw_named(name, value, type, hwtype, perm)\t\t\\\n\tparam_check_##type(name, &(value));\t\t\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX, name,\t\t\t\\\n\t\t\t    &param_ops_##type, &value,\t\t\t\\\n\t\t\t    perm, -1,\t\t\t\t\t\\\n\t\t\t    KERNEL_PARAM_FL_HWPARAM | (hwparam_##hwtype & 0));\t\\\n\t__MODULE_PARM_TYPE(name, #type)\n\n#define module_param_hw(name, type, hwtype, perm)\t\t\\\n\tmodule_param_hw_named(name, name, type, hwtype, perm)\n\n \n#define module_param_hw_array(name, type, hwtype, nump, perm)\t\t\\\n\tparam_check_##type(name, &(name)[0]);\t\t\t\t\\\n\tstatic const struct kparam_array __param_arr_##name\t\t\\\n\t= { .max = ARRAY_SIZE(name), .num = nump,\t\t\t\\\n\t    .ops = &param_ops_##type,\t\t\t\t\t\\\n\t    .elemsize = sizeof(name[0]), .elem = name };\t\t\\\n\t__module_param_call(MODULE_PARAM_PREFIX, name,\t\t\t\\\n\t\t\t    &param_array_ops,\t\t\t\t\\\n\t\t\t    .arr = &__param_arr_##name,\t\t\t\\\n\t\t\t    perm, -1,\t\t\t\t\t\\\n\t\t\t    KERNEL_PARAM_FL_HWPARAM | (hwparam_##hwtype & 0));\t\\\n\t__MODULE_PARM_TYPE(name, \"array of \" #type)\n\n\nextern const struct kernel_param_ops param_array_ops;\n\nextern const struct kernel_param_ops param_ops_string;\nextern int param_set_copystring(const char *val, const struct kernel_param *);\nextern int param_get_string(char *buffer, const struct kernel_param *kp);\n\n \n\nstruct module;\n\n#if defined(CONFIG_SYSFS) && defined(CONFIG_MODULES)\nextern int module_param_sysfs_setup(struct module *mod,\n\t\t\t\t    const struct kernel_param *kparam,\n\t\t\t\t    unsigned int num_params);\n\nextern void module_param_sysfs_remove(struct module *mod);\n#else\nstatic inline int module_param_sysfs_setup(struct module *mod,\n\t\t\t     const struct kernel_param *kparam,\n\t\t\t     unsigned int num_params)\n{\n\treturn 0;\n}\n\nstatic inline void module_param_sysfs_remove(struct module *mod)\n{ }\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}