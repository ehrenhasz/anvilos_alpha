{
  "module_name": "dim.h",
  "hash_id": "85970a6bbe5a0fd0ad3db81a8e99af3e9bd92a6b6837f527f5c5a378bca31b97",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/dim.h",
  "human_readable_source": " \n \n\n#ifndef DIM_H\n#define DIM_H\n\n#include <linux/bits.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/types.h>\n#include <linux/workqueue.h>\n\n \n#define DIM_NEVENTS 64\n\n \n#define IS_SIGNIFICANT_DIFF(val, ref) \\\n\t((ref) && (((100UL * abs((val) - (ref))) / (ref)) > 10))\n\n \n#define BIT_GAP(bits, end, start) ((((end) - (start)) + BIT_ULL(bits)) \\\n\t\t& (BIT_ULL(bits) - 1))\n\n \nstruct dim_cq_moder {\n\tu16 usec;\n\tu16 pkts;\n\tu16 comps;\n\tu8 cq_period_mode;\n};\n\n \nstruct dim_sample {\n\tktime_t time;\n\tu32 pkt_ctr;\n\tu32 byte_ctr;\n\tu16 event_ctr;\n\tu32 comp_ctr;\n};\n\n \nstruct dim_stats {\n\tint ppms;  \n\tint bpms;  \n\tint epms;  \n\tint cpms;  \n\tint cpe_ratio;  \n};\n\n \nstruct dim {\n\tu8 state;\n\tstruct dim_stats prev_stats;\n\tstruct dim_sample start_sample;\n\tstruct dim_sample measuring_sample;\n\tstruct work_struct work;\n\tvoid *priv;\n\tu8 profile_ix;\n\tu8 mode;\n\tu8 tune_state;\n\tu8 steps_right;\n\tu8 steps_left;\n\tu8 tired;\n};\n\n \nenum dim_cq_period_mode {\n\tDIM_CQ_PERIOD_MODE_START_FROM_EQE = 0x0,\n\tDIM_CQ_PERIOD_MODE_START_FROM_CQE = 0x1,\n\tDIM_CQ_PERIOD_NUM_MODES\n};\n\n \nenum dim_state {\n\tDIM_START_MEASURE,\n\tDIM_MEASURE_IN_PROGRESS,\n\tDIM_APPLY_NEW_PROFILE,\n};\n\n \nenum dim_tune_state {\n\tDIM_PARKING_ON_TOP,\n\tDIM_PARKING_TIRED,\n\tDIM_GOING_RIGHT,\n\tDIM_GOING_LEFT,\n};\n\n \nenum dim_stats_state {\n\tDIM_STATS_WORSE,\n\tDIM_STATS_SAME,\n\tDIM_STATS_BETTER,\n};\n\n \nenum dim_step_result {\n\tDIM_STEPPED,\n\tDIM_TOO_TIRED,\n\tDIM_ON_EDGE,\n};\n\n \nbool dim_on_top(struct dim *dim);\n\n \nvoid dim_turn(struct dim *dim);\n\n \nvoid dim_park_on_top(struct dim *dim);\n\n \nvoid dim_park_tired(struct dim *dim);\n\n \nbool dim_calc_stats(struct dim_sample *start, struct dim_sample *end,\n\t\t    struct dim_stats *curr_stats);\n\n \nstatic inline void\ndim_update_sample(u16 event_ctr, u64 packets, u64 bytes, struct dim_sample *s)\n{\n\ts->time\t     = ktime_get();\n\ts->pkt_ctr   = packets;\n\ts->byte_ctr  = bytes;\n\ts->event_ctr = event_ctr;\n}\n\n \nstatic inline void\ndim_update_sample_with_comps(u16 event_ctr, u64 packets, u64 bytes, u64 comps,\n\t\t\t     struct dim_sample *s)\n{\n\tdim_update_sample(event_ctr, packets, bytes, s);\n\ts->comp_ctr = comps;\n}\n\n \n\n \nstruct dim_cq_moder net_dim_get_rx_moderation(u8 cq_period_mode, int ix);\n\n \nstruct dim_cq_moder net_dim_get_def_rx_moderation(u8 cq_period_mode);\n\n \nstruct dim_cq_moder net_dim_get_tx_moderation(u8 cq_period_mode, int ix);\n\n \nstruct dim_cq_moder net_dim_get_def_tx_moderation(u8 cq_period_mode);\n\n \nvoid net_dim(struct dim *dim, struct dim_sample end_sample);\n\n \n\n \n#define RDMA_DIM_PARAMS_NUM_PROFILES 9\n#define RDMA_DIM_START_PROFILE 0\n\n \nvoid rdma_dim(struct dim *dim, u64 completions);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}