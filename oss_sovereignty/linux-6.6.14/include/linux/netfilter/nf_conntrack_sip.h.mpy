{
  "module_name": "nf_conntrack_sip.h",
  "hash_id": "f144a29186386a7db47951b6ca02eda7a04a27d38e7cd29ee4e9a9e1c5852dd6",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/netfilter/nf_conntrack_sip.h",
  "human_readable_source": " \n#ifndef __NF_CONNTRACK_SIP_H__\n#define __NF_CONNTRACK_SIP_H__\n\n#include <linux/skbuff.h>\n#include <linux/types.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n\n#define SIP_PORT\t5060\n#define SIP_TIMEOUT\t3600\n\nstruct nf_ct_sip_master {\n\tunsigned int\tregister_cseq;\n\tunsigned int\tinvite_cseq;\n\t__be16\t\tforced_dport;\n};\n\nenum sip_expectation_classes {\n\tSIP_EXPECT_SIGNALLING,\n\tSIP_EXPECT_AUDIO,\n\tSIP_EXPECT_VIDEO,\n\tSIP_EXPECT_IMAGE,\n\t__SIP_EXPECT_MAX\n};\n#define SIP_EXPECT_MAX\t(__SIP_EXPECT_MAX - 1)\n\nstruct sdp_media_type {\n\tconst char\t\t\t*name;\n\tunsigned int\t\t\tlen;\n\tenum sip_expectation_classes\tclass;\n};\n\n#define SDP_MEDIA_TYPE(__name, __class)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t.name\t= (__name),\t\t\t\t\t\t\\\n\t.len\t= sizeof(__name) - 1,\t\t\t\t\t\\\n\t.class\t= (__class),\t\t\t\t\t\t\\\n}\n\nstruct sip_handler {\n\tconst char\t*method;\n\tunsigned int\tlen;\n\tint\t\t(*request)(struct sk_buff *skb, unsigned int protoff,\n\t\t\t\t   unsigned int dataoff,\n\t\t\t\t   const char **dptr, unsigned int *datalen,\n\t\t\t\t   unsigned int cseq);\n\tint\t\t(*response)(struct sk_buff *skb, unsigned int protoff,\n\t\t\t\t    unsigned int dataoff,\n\t\t\t\t    const char **dptr, unsigned int *datalen,\n\t\t\t\t    unsigned int cseq, unsigned int code);\n};\n\n#define SIP_HANDLER(__method, __request, __response)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t.method\t\t= (__method),\t\t\t\t\t\\\n\t.len\t\t= sizeof(__method) - 1,\t\t\t\t\\\n\t.request\t= (__request),\t\t\t\t\t\\\n\t.response\t= (__response),\t\t\t\t\t\\\n}\n\nstruct sip_header {\n\tconst char\t*name;\n\tconst char\t*cname;\n\tconst char\t*search;\n\tunsigned int\tlen;\n\tunsigned int\tclen;\n\tunsigned int\tslen;\n\tint\t\t(*match_len)(const struct nf_conn *ct,\n\t\t\t\t     const char *dptr, const char *limit,\n\t\t\t\t     int *shift);\n};\n\n#define __SIP_HDR(__name, __cname, __search, __match)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t.name\t\t= (__name),\t\t\t\t\t\\\n\t.len\t\t= sizeof(__name) - 1,\t\t\t\t\\\n\t.cname\t\t= (__cname),\t\t\t\t\t\\\n\t.clen\t\t= (__cname) ? sizeof(__cname) - 1 : 0,\t\t\\\n\t.search\t\t= (__search),\t\t\t\t\t\\\n\t.slen\t\t= (__search) ? sizeof(__search) - 1 : 0,\t\\\n\t.match_len\t= (__match),\t\t\t\t\t\\\n}\n\n#define SIP_HDR(__name, __cname, __search, __match) \\\n\t__SIP_HDR(__name, __cname, __search, __match)\n\n#define SDP_HDR(__name, __search, __match) \\\n\t__SIP_HDR(__name, NULL, __search, __match)\n\nenum sip_header_types {\n\tSIP_HDR_CSEQ,\n\tSIP_HDR_FROM,\n\tSIP_HDR_TO,\n\tSIP_HDR_CONTACT,\n\tSIP_HDR_VIA_UDP,\n\tSIP_HDR_VIA_TCP,\n\tSIP_HDR_EXPIRES,\n\tSIP_HDR_CONTENT_LENGTH,\n\tSIP_HDR_CALL_ID,\n};\n\nenum sdp_header_types {\n\tSDP_HDR_UNSPEC,\n\tSDP_HDR_VERSION,\n\tSDP_HDR_OWNER,\n\tSDP_HDR_CONNECTION,\n\tSDP_HDR_MEDIA,\n};\n\nstruct nf_nat_sip_hooks {\n\tunsigned int (*msg)(struct sk_buff *skb,\n\t\t\t    unsigned int protoff,\n\t\t\t    unsigned int dataoff,\n\t\t\t    const char **dptr,\n\t\t\t    unsigned int *datalen);\n\n\tvoid (*seq_adjust)(struct sk_buff *skb,\n\t\t\t   unsigned int protoff, s16 off);\n\n\tunsigned int (*expect)(struct sk_buff *skb,\n\t\t\t       unsigned int protoff,\n\t\t\t       unsigned int dataoff,\n\t\t\t       const char **dptr,\n\t\t\t       unsigned int *datalen,\n\t\t\t       struct nf_conntrack_expect *exp,\n\t\t\t       unsigned int matchoff,\n\t\t\t       unsigned int matchlen);\n\n\tunsigned int (*sdp_addr)(struct sk_buff *skb,\n\t\t\t\t unsigned int protoff,\n\t\t\t\t unsigned int dataoff,\n\t\t\t\t const char **dptr,\n\t\t\t\t unsigned int *datalen,\n\t\t\t\t unsigned int sdpoff,\n\t\t\t\t enum sdp_header_types type,\n\t\t\t\t enum sdp_header_types term,\n\t\t\t\t const union nf_inet_addr *addr);\n\n\tunsigned int (*sdp_port)(struct sk_buff *skb,\n\t\t\t\t unsigned int protoff,\n\t\t\t\t unsigned int dataoff,\n\t\t\t\t const char **dptr,\n\t\t\t\t unsigned int *datalen,\n\t\t\t\t unsigned int matchoff,\n\t\t\t\t unsigned int matchlen,\n\t\t\t\t u_int16_t port);\n\n\tunsigned int (*sdp_session)(struct sk_buff *skb,\n\t\t\t\t    unsigned int protoff,\n\t\t\t\t    unsigned int dataoff,\n\t\t\t\t    const char **dptr,\n\t\t\t\t    unsigned int *datalen,\n\t\t\t\t    unsigned int sdpoff,\n\t\t\t\t    const union nf_inet_addr *addr);\n\n\tunsigned int (*sdp_media)(struct sk_buff *skb,\n\t\t\t\t  unsigned int protoff,\n\t\t\t\t  unsigned int dataoff,\n\t\t\t\t  const char **dptr,\n\t\t\t\t  unsigned int *datalen,\n\t\t\t\t  struct nf_conntrack_expect *rtp_exp,\n\t\t\t\t  struct nf_conntrack_expect *rtcp_exp,\n\t\t\t\t  unsigned int mediaoff,\n\t\t\t\t  unsigned int medialen,\n\t\t\t\t  union nf_inet_addr *rtp_addr);\n};\nextern const struct nf_nat_sip_hooks __rcu *nf_nat_sip_hooks;\n\nint ct_sip_parse_request(const struct nf_conn *ct, const char *dptr,\n\t\t\t unsigned int datalen, unsigned int *matchoff,\n\t\t\t unsigned int *matchlen, union nf_inet_addr *addr,\n\t\t\t __be16 *port);\nint ct_sip_get_header(const struct nf_conn *ct, const char *dptr,\n\t\t      unsigned int dataoff, unsigned int datalen,\n\t\t      enum sip_header_types type, unsigned int *matchoff,\n\t\t      unsigned int *matchlen);\nint ct_sip_parse_header_uri(const struct nf_conn *ct, const char *dptr,\n\t\t\t    unsigned int *dataoff, unsigned int datalen,\n\t\t\t    enum sip_header_types type, int *in_header,\n\t\t\t    unsigned int *matchoff, unsigned int *matchlen,\n\t\t\t    union nf_inet_addr *addr, __be16 *port);\nint ct_sip_parse_address_param(const struct nf_conn *ct, const char *dptr,\n\t\t\t       unsigned int dataoff, unsigned int datalen,\n\t\t\t       const char *name, unsigned int *matchoff,\n\t\t\t       unsigned int *matchlen, union nf_inet_addr *addr,\n\t\t\t       bool delim);\nint ct_sip_parse_numerical_param(const struct nf_conn *ct, const char *dptr,\n\t\t\t\t unsigned int off, unsigned int datalen,\n\t\t\t\t const char *name, unsigned int *matchoff,\n\t\t\t\t unsigned int *matchen, unsigned int *val);\n\nint ct_sip_get_sdp_header(const struct nf_conn *ct, const char *dptr,\n\t\t\t  unsigned int dataoff, unsigned int datalen,\n\t\t\t  enum sdp_header_types type,\n\t\t\t  enum sdp_header_types term,\n\t\t\t  unsigned int *matchoff, unsigned int *matchlen);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}