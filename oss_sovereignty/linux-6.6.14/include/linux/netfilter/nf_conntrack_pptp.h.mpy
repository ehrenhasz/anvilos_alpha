{
  "module_name": "nf_conntrack_pptp.h",
  "hash_id": "993922b6e5cac39eb8f1a6b802ed56b682d430eabc9fe928f1cd74416c557491",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/netfilter/nf_conntrack_pptp.h",
  "human_readable_source": " \n \n#ifndef _NF_CONNTRACK_PPTP_H\n#define _NF_CONNTRACK_PPTP_H\n\n#include <linux/netfilter.h>\n#include <linux/skbuff.h>\n#include <linux/types.h>\n#include <linux/netfilter/nf_conntrack_common.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n#include <uapi/linux/netfilter/nf_conntrack_tuple_common.h>\n\nconst char *pptp_msg_name(u_int16_t msg);\n\n \nenum pptp_ctrlsess_state {\n\tPPTP_SESSION_NONE,\t\t\t \n\tPPTP_SESSION_ERROR,\t\t\t \n\tPPTP_SESSION_STOPREQ,\t\t\t \n\tPPTP_SESSION_REQUESTED,\t\t\t \n\tPPTP_SESSION_CONFIRMED,\t\t\t \n};\n\n \nenum pptp_ctrlcall_state {\n\tPPTP_CALL_NONE,\n\tPPTP_CALL_ERROR,\n\tPPTP_CALL_OUT_REQ,\n\tPPTP_CALL_OUT_CONF,\n\tPPTP_CALL_IN_REQ,\n\tPPTP_CALL_IN_REP,\n\tPPTP_CALL_IN_CONF,\n\tPPTP_CALL_CLEAR_REQ,\n};\n\n \nstruct nf_ct_pptp_master {\n\tenum pptp_ctrlsess_state sstate;\t \n\tenum pptp_ctrlcall_state cstate;\t \n\t__be16 pac_call_id;\t\t\t \n\t__be16 pns_call_id;\t\t\t \n\n\t \n\tstruct nf_ct_gre_keymap *keymap[IP_CT_DIR_MAX];\n};\n\nstruct nf_nat_pptp {\n\t__be16 pns_call_id;\t\t\t \n\t__be16 pac_call_id;\t\t\t \n};\n\n#define PPTP_CONTROL_PORT\t1723\n\n#define PPTP_PACKET_CONTROL\t1\n#define PPTP_PACKET_MGMT\t2\n\n#define PPTP_MAGIC_COOKIE\t0x1a2b3c4d\n\nstruct pptp_pkt_hdr {\n\t__u16\tpacketLength;\n\t__be16\tpacketType;\n\t__be32\tmagicCookie;\n};\n\n \n#define PPTP_START_SESSION_REQUEST\t1\n#define PPTP_START_SESSION_REPLY\t2\n#define PPTP_STOP_SESSION_REQUEST\t3\n#define PPTP_STOP_SESSION_REPLY\t\t4\n#define PPTP_ECHO_REQUEST\t\t5\n#define PPTP_ECHO_REPLY\t\t\t6\n#define PPTP_OUT_CALL_REQUEST\t\t7\n#define PPTP_OUT_CALL_REPLY\t\t8\n#define PPTP_IN_CALL_REQUEST\t\t9\n#define PPTP_IN_CALL_REPLY\t\t10\n#define PPTP_IN_CALL_CONNECT\t\t11\n#define PPTP_CALL_CLEAR_REQUEST\t\t12\n#define PPTP_CALL_DISCONNECT_NOTIFY\t13\n#define PPTP_WAN_ERROR_NOTIFY\t\t14\n#define PPTP_SET_LINK_INFO\t\t15\n\n#define PPTP_MSG_MAX\t\t\t15\n\n \n#define PPTP_ERROR_CODE_NONE\t\t0\n#define PPTP_NOT_CONNECTED\t\t1\n#define PPTP_BAD_FORMAT\t\t\t2\n#define PPTP_BAD_VALUE\t\t\t3\n#define PPTP_NO_RESOURCE\t\t4\n#define PPTP_BAD_CALLID\t\t\t5\n#define PPTP_REMOVE_DEVICE_ERROR\t6\n\nstruct PptpControlHeader {\n\t__be16\tmessageType;\n\t__u16\treserved;\n};\n\n \n#define PPTP_FRAME_CAP_ASYNC\t\t0x1\n#define PPTP_FRAME_CAP_SYNC\t\t0x2\n\n \n#define PPTP_BEARER_CAP_ANALOG\t\t0x1\n#define PPTP_BEARER_CAP_DIGITAL\t\t0x2\n\nstruct PptpStartSessionRequest {\n\t__be16\tprotocolVersion;\n\t__u16\treserved1;\n\t__be32\tframingCapability;\n\t__be32\tbearerCapability;\n\t__be16\tmaxChannels;\n\t__be16\tfirmwareRevision;\n\t__u8\thostName[64];\n\t__u8\tvendorString[64];\n};\n\n \n#define PPTP_START_OK\t\t\t1\n#define PPTP_START_GENERAL_ERROR\t2\n#define PPTP_START_ALREADY_CONNECTED\t3\n#define PPTP_START_NOT_AUTHORIZED\t4\n#define PPTP_START_UNKNOWN_PROTOCOL\t5\n\nstruct PptpStartSessionReply {\n\t__be16\tprotocolVersion;\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__be32\tframingCapability;\n\t__be32\tbearerCapability;\n\t__be16\tmaxChannels;\n\t__be16\tfirmwareRevision;\n\t__u8\thostName[64];\n\t__u8\tvendorString[64];\n};\n\n \n#define PPTP_STOP_NONE\t\t\t1\n#define PPTP_STOP_PROTOCOL\t\t2\n#define PPTP_STOP_LOCAL_SHUTDOWN\t3\n\nstruct PptpStopSessionRequest {\n\t__u8\treason;\n\t__u8\treserved1;\n\t__u16\treserved2;\n};\n\n \n#define PPTP_STOP_OK\t\t\t1\n#define PPTP_STOP_GENERAL_ERROR\t\t2\n\nstruct PptpStopSessionReply {\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__u16\treserved1;\n};\n\nstruct PptpEchoRequest {\n\t__be32 identNumber;\n};\n\n \n#define PPTP_ECHO_OK\t\t\t1\n#define PPTP_ECHO_GENERAL_ERROR\t\t2\n\nstruct PptpEchoReply {\n\t__be32\tidentNumber;\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__u16\treserved;\n};\n\n \n#define PPTP_ASYNC_FRAMING\t\t1\n#define PPTP_SYNC_FRAMING\t\t2\n#define PPTP_DONT_CARE_FRAMING\t\t3\n\n \n#define PPTP_ANALOG_TYPE\t\t1\n#define PPTP_DIGITAL_TYPE\t\t2\n#define PPTP_DONT_CARE_BEARER_TYPE\t3\n\nstruct PptpOutCallRequest {\n\t__be16\tcallID;\n\t__be16\tcallSerialNumber;\n\t__be32\tminBPS;\n\t__be32\tmaxBPS;\n\t__be32\tbearerType;\n\t__be32\tframingType;\n\t__be16\tpacketWindow;\n\t__be16\tpacketProcDelay;\n\t__be16\tphoneNumberLength;\n\t__u16\treserved1;\n\t__u8\tphoneNumber[64];\n\t__u8\tsubAddress[64];\n};\n\n \n#define PPTP_OUTCALL_CONNECT\t\t1\n#define PPTP_OUTCALL_GENERAL_ERROR\t2\n#define PPTP_OUTCALL_NO_CARRIER\t\t3\n#define PPTP_OUTCALL_BUSY\t\t4\n#define PPTP_OUTCALL_NO_DIAL_TONE\t5\n#define PPTP_OUTCALL_TIMEOUT\t\t6\n#define PPTP_OUTCALL_DONT_ACCEPT\t7\n\nstruct PptpOutCallReply {\n\t__be16\tcallID;\n\t__be16\tpeersCallID;\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__be16\tcauseCode;\n\t__be32\tconnectSpeed;\n\t__be16\tpacketWindow;\n\t__be16\tpacketProcDelay;\n\t__be32\tphysChannelID;\n};\n\nstruct PptpInCallRequest {\n\t__be16\tcallID;\n\t__be16\tcallSerialNumber;\n\t__be32\tcallBearerType;\n\t__be32\tphysChannelID;\n\t__be16\tdialedNumberLength;\n\t__be16\tdialingNumberLength;\n\t__u8\tdialedNumber[64];\n\t__u8\tdialingNumber[64];\n\t__u8\tsubAddress[64];\n};\n\n \n#define PPTP_INCALL_ACCEPT\t\t1\n#define PPTP_INCALL_GENERAL_ERROR\t2\n#define PPTP_INCALL_DONT_ACCEPT\t\t3\n\nstruct PptpInCallReply {\n\t__be16\tcallID;\n\t__be16\tpeersCallID;\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__be16\tpacketWindow;\n\t__be16\tpacketProcDelay;\n\t__u16\treserved;\n};\n\nstruct PptpInCallConnected {\n\t__be16\tpeersCallID;\n\t__u16\treserved;\n\t__be32\tconnectSpeed;\n\t__be16\tpacketWindow;\n\t__be16\tpacketProcDelay;\n\t__be32\tcallFramingType;\n};\n\nstruct PptpClearCallRequest {\n\t__be16\tcallID;\n\t__u16\treserved;\n};\n\nstruct PptpCallDisconnectNotify {\n\t__be16\tcallID;\n\t__u8\tresultCode;\n\t__u8\tgeneralErrorCode;\n\t__be16\tcauseCode;\n\t__u16\treserved;\n\t__u8\tcallStatistics[128];\n};\n\nstruct PptpWanErrorNotify {\n\t__be16\tpeersCallID;\n\t__u16\treserved;\n\t__be32\tcrcErrors;\n\t__be32\tframingErrors;\n\t__be32\thardwareOverRuns;\n\t__be32\tbufferOverRuns;\n\t__be32\ttimeoutErrors;\n\t__be32\talignmentErrors;\n};\n\nstruct PptpSetLinkInfo {\n\t__be16\tpeersCallID;\n\t__u16\treserved;\n\t__be32\tsendAccm;\n\t__be32\trecvAccm;\n};\n\nunion pptp_ctrl_union {\n\tstruct PptpStartSessionRequest\tsreq;\n\tstruct PptpStartSessionReply\tsrep;\n\tstruct PptpStopSessionRequest\tstreq;\n\tstruct PptpStopSessionReply\tstrep;\n\tstruct PptpOutCallRequest\tocreq;\n\tstruct PptpOutCallReply\t\tocack;\n\tstruct PptpInCallRequest\ticreq;\n\tstruct PptpInCallReply\t\ticack;\n\tstruct PptpInCallConnected\ticcon;\n\tstruct PptpClearCallRequest\tclrreq;\n\tstruct PptpCallDisconnectNotify disc;\n\tstruct PptpWanErrorNotify\twanerr;\n\tstruct PptpSetLinkInfo\t\tsetlink;\n};\n\nstruct nf_nat_pptp_hook {\n\tint (*outbound)(struct sk_buff *skb,\n\t\t\tstruct nf_conn *ct, enum ip_conntrack_info ctinfo,\n\t\t\tunsigned int protoff,\n\t\t\tstruct PptpControlHeader *ctlh,\n\t\t\tunion pptp_ctrl_union *pptpReq);\n\tint (*inbound)(struct sk_buff *skb,\n\t\t       struct nf_conn *ct, enum ip_conntrack_info ctinfo,\n\t\t       unsigned int protoff,\n\t\t       struct PptpControlHeader *ctlh,\n\t\t       union pptp_ctrl_union *pptpReq);\n\tvoid (*exp_gre)(struct nf_conntrack_expect *exp_orig,\n\t\t\tstruct nf_conntrack_expect *exp_reply);\n\tvoid (*expectfn)(struct nf_conn *ct,\n\t\t\t struct nf_conntrack_expect *exp);\n};\n\nextern const struct nf_nat_pptp_hook __rcu *nf_nat_pptp_hook;\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}