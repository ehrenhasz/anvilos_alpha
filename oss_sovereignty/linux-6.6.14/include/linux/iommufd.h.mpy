{
  "module_name": "iommufd.h",
  "hash_id": "8e5d9e8f517b4f26e2cd366590f009acc3a3441fa2a6f36464522b1506370193",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/iommufd.h",
  "human_readable_source": " \n \n#ifndef __LINUX_IOMMUFD_H\n#define __LINUX_IOMMUFD_H\n\n#include <linux/types.h>\n#include <linux/errno.h>\n#include <linux/err.h>\n\nstruct device;\nstruct iommufd_device;\nstruct page;\nstruct iommufd_ctx;\nstruct iommufd_access;\nstruct file;\nstruct iommu_group;\n\nstruct iommufd_device *iommufd_device_bind(struct iommufd_ctx *ictx,\n\t\t\t\t\t   struct device *dev, u32 *id);\nvoid iommufd_device_unbind(struct iommufd_device *idev);\n\nint iommufd_device_attach(struct iommufd_device *idev, u32 *pt_id);\nint iommufd_device_replace(struct iommufd_device *idev, u32 *pt_id);\nvoid iommufd_device_detach(struct iommufd_device *idev);\n\nstruct iommufd_ctx *iommufd_device_to_ictx(struct iommufd_device *idev);\nu32 iommufd_device_to_id(struct iommufd_device *idev);\n\nstruct iommufd_access_ops {\n\tu8 needs_pin_pages : 1;\n\tvoid (*unmap)(void *data, unsigned long iova, unsigned long length);\n};\n\nenum {\n\tIOMMUFD_ACCESS_RW_READ = 0,\n\tIOMMUFD_ACCESS_RW_WRITE = 1 << 0,\n\t \n\tIOMMUFD_ACCESS_RW_KTHREAD = 1 << 1,\n\n\t \n\t__IOMMUFD_ACCESS_RW_SLOW_PATH = 1 << 2,\n};\n\nstruct iommufd_access *\niommufd_access_create(struct iommufd_ctx *ictx,\n\t\t      const struct iommufd_access_ops *ops, void *data, u32 *id);\nvoid iommufd_access_destroy(struct iommufd_access *access);\nint iommufd_access_attach(struct iommufd_access *access, u32 ioas_id);\nint iommufd_access_replace(struct iommufd_access *access, u32 ioas_id);\nvoid iommufd_access_detach(struct iommufd_access *access);\n\nvoid iommufd_ctx_get(struct iommufd_ctx *ictx);\n\n#if IS_ENABLED(CONFIG_IOMMUFD)\nstruct iommufd_ctx *iommufd_ctx_from_file(struct file *file);\nstruct iommufd_ctx *iommufd_ctx_from_fd(int fd);\nvoid iommufd_ctx_put(struct iommufd_ctx *ictx);\nbool iommufd_ctx_has_group(struct iommufd_ctx *ictx, struct iommu_group *group);\n\nint iommufd_access_pin_pages(struct iommufd_access *access, unsigned long iova,\n\t\t\t     unsigned long length, struct page **out_pages,\n\t\t\t     unsigned int flags);\nvoid iommufd_access_unpin_pages(struct iommufd_access *access,\n\t\t\t\tunsigned long iova, unsigned long length);\nint iommufd_access_rw(struct iommufd_access *access, unsigned long iova,\n\t\t      void *data, size_t len, unsigned int flags);\nint iommufd_vfio_compat_ioas_get_id(struct iommufd_ctx *ictx, u32 *out_ioas_id);\nint iommufd_vfio_compat_ioas_create(struct iommufd_ctx *ictx);\nint iommufd_vfio_compat_set_no_iommu(struct iommufd_ctx *ictx);\n#else  \nstatic inline struct iommufd_ctx *iommufd_ctx_from_file(struct file *file)\n{\n\treturn ERR_PTR(-EOPNOTSUPP);\n}\n\nstatic inline void iommufd_ctx_put(struct iommufd_ctx *ictx)\n{\n}\n\nstatic inline int iommufd_access_pin_pages(struct iommufd_access *access,\n\t\t\t\t\t   unsigned long iova,\n\t\t\t\t\t   unsigned long length,\n\t\t\t\t\t   struct page **out_pages,\n\t\t\t\t\t   unsigned int flags)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void iommufd_access_unpin_pages(struct iommufd_access *access,\n\t\t\t\t\t      unsigned long iova,\n\t\t\t\t\t      unsigned long length)\n{\n}\n\nstatic inline int iommufd_access_rw(struct iommufd_access *access, unsigned long iova,\n\t\t      void *data, size_t len, unsigned int flags)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int iommufd_vfio_compat_ioas_create(struct iommufd_ctx *ictx)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int iommufd_vfio_compat_set_no_iommu(struct iommufd_ctx *ictx)\n{\n\treturn -EOPNOTSUPP;\n}\n#endif  \n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}