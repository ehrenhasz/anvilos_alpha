{
  "module_name": "ti_am335x_tscadc.h",
  "hash_id": "003e5943e9fe5c575574d97f7dc8fb14e9791a95fd3061ad539721140f02b321",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/mfd/ti_am335x_tscadc.h",
  "human_readable_source": " \n \n\n#ifndef __LINUX_TI_AM335X_TSCADC_MFD_H\n#define __LINUX_TI_AM335X_TSCADC_MFD_H\n\n#include <linux/bitfield.h>\n#include <linux/mfd/core.h>\n#include <linux/units.h>\n\n#define REG_RAWIRQSTATUS\t0x024\n#define REG_IRQSTATUS\t\t0x028\n#define REG_IRQENABLE\t\t0x02C\n#define REG_IRQCLR\t\t0x030\n#define REG_IRQWAKEUP\t\t0x034\n#define REG_DMAENABLE_SET\t0x038\n#define REG_DMAENABLE_CLEAR\t0x03c\n#define REG_CTRL\t\t0x040\n#define REG_ADCFSM\t\t0x044\n#define REG_CLKDIV\t\t0x04C\n#define REG_SE\t\t\t0x054\n#define REG_IDLECONFIG\t\t0x058\n#define REG_CHARGECONFIG\t0x05C\n#define REG_CHARGEDELAY\t\t0x060\n#define REG_STEPCONFIG(n)\t(0x64 + ((n) * 8))\n#define REG_STEPDELAY(n)\t(0x68 + ((n) * 8))\n#define REG_FIFO0CNT\t\t0xE4\n#define REG_FIFO0THR\t\t0xE8\n#define REG_FIFO1CNT\t\t0xF0\n#define REG_FIFO1THR\t\t0xF4\n#define REG_DMA1REQ\t\t0xF8\n#define REG_FIFO0\t\t0x100\n#define REG_FIFO1\t\t0x200\n\n \n \n#define IRQWKUP_ENB\t\tBIT(0)\n\n \n#define IRQENB_HW_PEN\t\tBIT(0)\n#define IRQENB_EOS\t\tBIT(1)\n#define IRQENB_FIFO0THRES\tBIT(2)\n#define IRQENB_FIFO0OVRRUN\tBIT(3)\n#define IRQENB_FIFO0UNDRFLW\tBIT(4)\n#define IRQENB_FIFO1THRES\tBIT(5)\n#define IRQENB_FIFO1OVRRUN\tBIT(6)\n#define IRQENB_FIFO1UNDRFLW\tBIT(7)\n#define IRQENB_PENUP\t\tBIT(9)\n\n \n#define STEPCONFIG_MODE(val)\tFIELD_PREP(GENMASK(1, 0), (val))\n#define STEPCONFIG_MODE_SWCNT\tSTEPCONFIG_MODE(1)\n#define STEPCONFIG_MODE_HWSYNC\tSTEPCONFIG_MODE(2)\n#define STEPCONFIG_AVG(val)\tFIELD_PREP(GENMASK(4, 2), (val))\n#define STEPCONFIG_AVG_16\tSTEPCONFIG_AVG(4)\n#define STEPCONFIG_XPP\t\tBIT(5)\n#define STEPCONFIG_XNN\t\tBIT(6)\n#define STEPCONFIG_YPP\t\tBIT(7)\n#define STEPCONFIG_YNN\t\tBIT(8)\n#define STEPCONFIG_XNP\t\tBIT(9)\n#define STEPCONFIG_YPN\t\tBIT(10)\n#define STEPCONFIG_RFP(val)\tFIELD_PREP(GENMASK(13, 12), (val))\n#define STEPCONFIG_RFP_VREFP\tSTEPCONFIG_RFP(3)\n#define STEPCONFIG_INM(val)\tFIELD_PREP(GENMASK(18, 15), (val))\n#define STEPCONFIG_INM_ADCREFM\tSTEPCONFIG_INM(8)\n#define STEPCONFIG_INP(val)\tFIELD_PREP(GENMASK(22, 19), (val))\n#define STEPCONFIG_INP_AN4\tSTEPCONFIG_INP(4)\n#define STEPCONFIG_INP_ADCREFM\tSTEPCONFIG_INP(8)\n#define STEPCONFIG_FIFO1\tBIT(26)\n#define STEPCONFIG_RFM(val)\tFIELD_PREP(GENMASK(24, 23), (val))\n#define STEPCONFIG_RFM_VREFN\tSTEPCONFIG_RFM(3)\n\n \n#define STEPDELAY_OPEN(val)\tFIELD_PREP(GENMASK(17, 0), (val))\n#define STEPCONFIG_OPENDLY\tSTEPDELAY_OPEN(0x098)\n#define STEPCONFIG_MAX_OPENDLY\tGENMASK(17, 0)\n#define STEPDELAY_SAMPLE(val)\tFIELD_PREP(GENMASK(31, 24), (val))\n#define STEPCONFIG_SAMPLEDLY\tSTEPDELAY_SAMPLE(0)\n#define STEPCONFIG_MAX_SAMPLE\tGENMASK(7, 0)\n\n \n#define STEPCHARGE_RFP(val)\tFIELD_PREP(GENMASK(14, 12), (val))\n#define STEPCHARGE_RFP_XPUL\tSTEPCHARGE_RFP(1)\n#define STEPCHARGE_INM(val)\tFIELD_PREP(GENMASK(18, 15), (val))\n#define STEPCHARGE_INM_AN1\tSTEPCHARGE_INM(1)\n#define STEPCHARGE_INP(val)\tFIELD_PREP(GENMASK(22, 19), (val))\n#define STEPCHARGE_RFM(val)\tFIELD_PREP(GENMASK(24, 23), (val))\n#define STEPCHARGE_RFM_XNUR\tSTEPCHARGE_RFM(1)\n\n \n#define CHARGEDLY_OPEN(val)\tFIELD_PREP(GENMASK(17, 0), (val))\n#define CHARGEDLY_OPENDLY\tCHARGEDLY_OPEN(0x400)\n\n \n#define CNTRLREG_SSENB\t\tBIT(0)\n#define CNTRLREG_STEPID\t\tBIT(1)\n#define CNTRLREG_TSC_STEPCONFIGWRT BIT(2)\n#define CNTRLREG_POWERDOWN\tBIT(4)\n#define CNTRLREG_TSC_AFE_CTRL(val) FIELD_PREP(GENMASK(6, 5), (val))\n#define CNTRLREG_TSC_4WIRE\tCNTRLREG_TSC_AFE_CTRL(1)\n#define CNTRLREG_TSC_5WIRE\tCNTRLREG_TSC_AFE_CTRL(2)\n#define CNTRLREG_TSC_ENB\tBIT(7)\n\n \n#define CNTRLREG_MAGADCENB      BIT(0)\n#define CNTRLREG_MAG_PREAMP_PWRDOWN BIT(5)\n#define CNTRLREG_MAG_PREAMP_BYPASS  BIT(6)\n\n \n#define FIFOREAD_DATA_MASK\tGENMASK(11, 0)\n#define FIFOREAD_CHNLID_MASK\tGENMASK(19, 16)\n\n \n#define DMA_FIFO0\t\tBIT(0)\n#define DMA_FIFO1\t\tBIT(1)\n\n \n#define SEQ_STATUS\t\tBIT(5)\n#define CHARGE_STEP\t\t0x11\n\n#define TSC_ADC_CLK\t\t(3 * HZ_PER_MHZ)\n#define MAG_ADC_CLK\t\t(13 * HZ_PER_MHZ)\n#define TOTAL_STEPS\t\t16\n#define TOTAL_CHANNELS\t\t8\n#define FIFO1_THRESHOLD\t\t19\n\n \n#define IDLE_TIMEOUT_MS\t\t83  \n\n#define TSCADC_CELLS\t\t2\n\nstruct ti_tscadc_data {\n\tchar *adc_feature_name;\n\tchar *adc_feature_compatible;\n\tchar *secondary_feature_name;\n\tchar *secondary_feature_compatible;\n\tunsigned int target_clk_rate;\n};\n\nstruct ti_tscadc_dev {\n\tstruct device *dev;\n\tstruct regmap *regmap;\n\tvoid __iomem *tscadc_base;\n\tphys_addr_t tscadc_phys_base;\n\tconst struct ti_tscadc_data *data;\n\tint irq;\n\tstruct mfd_cell cells[TSCADC_CELLS];\n\tu32 ctrl;\n\tu32 reg_se_cache;\n\tbool adc_waiting;\n\tbool adc_in_use;\n\twait_queue_head_t reg_se_wait;\n\tspinlock_t reg_lock;\n\tunsigned int clk_div;\n\n\t \n\tstruct titsc *tsc;\n\n\t \n\tstruct adc_device *adc;\n};\n\nstatic inline struct ti_tscadc_dev *ti_tscadc_dev_get(struct platform_device *p)\n{\n\tstruct ti_tscadc_dev **tscadc_dev = p->dev.platform_data;\n\n\treturn *tscadc_dev;\n}\n\nstatic inline bool ti_adc_with_touchscreen(struct ti_tscadc_dev *tscadc)\n{\n\treturn of_device_is_compatible(tscadc->dev->of_node,\n\t\t\t\t       \"ti,am3359-tscadc\");\n}\n\nvoid am335x_tsc_se_set_cache(struct ti_tscadc_dev *tsadc, u32 val);\nvoid am335x_tsc_se_set_once(struct ti_tscadc_dev *tsadc, u32 val);\nvoid am335x_tsc_se_clr(struct ti_tscadc_dev *tsadc, u32 val);\nvoid am335x_tsc_se_adc_done(struct ti_tscadc_dev *tsadc);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}