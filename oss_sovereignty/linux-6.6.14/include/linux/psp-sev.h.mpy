{
  "module_name": "psp-sev.h",
  "hash_id": "0cfc866722bf389654ffa0fc2f6a1c7e6a5a5479c346db3b31c8595e9ec9fcc8",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/psp-sev.h",
  "human_readable_source": " \n \n\n#ifndef __PSP_SEV_H__\n#define __PSP_SEV_H__\n\n#include <uapi/linux/psp-sev.h>\n\n#define SEV_FW_BLOB_MAX_SIZE\t0x4000\t \n\n \nenum sev_state {\n\tSEV_STATE_UNINIT\t\t= 0x0,\n\tSEV_STATE_INIT\t\t\t= 0x1,\n\tSEV_STATE_WORKING\t\t= 0x2,\n\n\tSEV_STATE_MAX\n};\n\n \nenum sev_cmd {\n\t \n\tSEV_CMD_INIT\t\t\t= 0x001,\n\tSEV_CMD_SHUTDOWN\t\t= 0x002,\n\tSEV_CMD_FACTORY_RESET\t\t= 0x003,\n\tSEV_CMD_PLATFORM_STATUS\t\t= 0x004,\n\tSEV_CMD_PEK_GEN\t\t\t= 0x005,\n\tSEV_CMD_PEK_CSR\t\t\t= 0x006,\n\tSEV_CMD_PEK_CERT_IMPORT\t\t= 0x007,\n\tSEV_CMD_PDH_CERT_EXPORT\t\t= 0x008,\n\tSEV_CMD_PDH_GEN\t\t\t= 0x009,\n\tSEV_CMD_DF_FLUSH\t\t= 0x00A,\n\tSEV_CMD_DOWNLOAD_FIRMWARE\t= 0x00B,\n\tSEV_CMD_GET_ID\t\t\t= 0x00C,\n\tSEV_CMD_INIT_EX                 = 0x00D,\n\n\t \n\tSEV_CMD_DECOMMISSION\t\t= 0x020,\n\tSEV_CMD_ACTIVATE\t\t= 0x021,\n\tSEV_CMD_DEACTIVATE\t\t= 0x022,\n\tSEV_CMD_GUEST_STATUS\t\t= 0x023,\n\n\t \n\tSEV_CMD_LAUNCH_START\t\t= 0x030,\n\tSEV_CMD_LAUNCH_UPDATE_DATA\t= 0x031,\n\tSEV_CMD_LAUNCH_UPDATE_VMSA\t= 0x032,\n\tSEV_CMD_LAUNCH_MEASURE\t\t= 0x033,\n\tSEV_CMD_LAUNCH_UPDATE_SECRET\t= 0x034,\n\tSEV_CMD_LAUNCH_FINISH\t\t= 0x035,\n\tSEV_CMD_ATTESTATION_REPORT\t= 0x036,\n\n\t \n\tSEV_CMD_SEND_START\t\t= 0x040,\n\tSEV_CMD_SEND_UPDATE_DATA\t= 0x041,\n\tSEV_CMD_SEND_UPDATE_VMSA\t= 0x042,\n\tSEV_CMD_SEND_FINISH\t\t= 0x043,\n\tSEV_CMD_SEND_CANCEL\t\t= 0x044,\n\n\t \n\tSEV_CMD_RECEIVE_START\t\t= 0x050,\n\tSEV_CMD_RECEIVE_UPDATE_DATA\t= 0x051,\n\tSEV_CMD_RECEIVE_UPDATE_VMSA\t= 0x052,\n\tSEV_CMD_RECEIVE_FINISH\t\t= 0x053,\n\n\t \n\tSEV_CMD_DBG_DECRYPT\t\t= 0x060,\n\tSEV_CMD_DBG_ENCRYPT\t\t= 0x061,\n\n\tSEV_CMD_MAX,\n};\n\n \nstruct sev_data_init {\n\tu32 flags;\t\t\t \n\tu32 reserved;\t\t\t \n\tu64 tmr_address;\t\t \n\tu32 tmr_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_init_ex {\n\tu32 length;                      \n\tu32 flags;                       \n\tu64 tmr_address;                 \n\tu32 tmr_len;                     \n\tu32 reserved;                    \n\tu64 nv_address;                  \n\tu32 nv_len;                      \n} __packed;\n\n#define SEV_INIT_FLAGS_SEV_ES\t0x01\n\n \nstruct sev_data_pek_csr {\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_pek_cert_import {\n\tu64 pek_cert_address;\t\t\t \n\tu32 pek_cert_len;\t\t\t \n\tu32 reserved;\t\t\t\t \n\tu64 oca_cert_address;\t\t\t \n\tu32 oca_cert_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_download_firmware {\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_get_id {\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n \nstruct sev_data_pdh_cert_export {\n\tu64 pdh_cert_address;\t\t\t \n\tu32 pdh_cert_len;\t\t\t \n\tu32 reserved;\t\t\t\t \n\tu64 cert_chain_address;\t\t\t \n\tu32 cert_chain_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_decommission {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_activate {\n\tu32 handle;\t\t\t\t \n\tu32 asid;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_deactivate {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_guest_status {\n\tu32 handle;\t\t\t\t \n\tu32 policy;\t\t\t\t \n\tu32 asid;\t\t\t\t \n\tu8 state;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_start {\n\tu32 handle;\t\t\t\t \n\tu32 policy;\t\t\t\t \n\tu64 dh_cert_address;\t\t\t \n\tu32 dh_cert_len;\t\t\t \n\tu32 reserved;\t\t\t\t \n\tu64 session_address;\t\t\t \n\tu32 session_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_update_data {\n\tu32 handle;\t\t\t\t \n\tu32 reserved;\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_update_vmsa {\n\tu32 handle;\t\t\t\t \n\tu32 reserved;\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_measure {\n\tu32 handle;\t\t\t\t \n\tu32 reserved;\n\tu64 address;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_secret {\n\tu32 handle;\t\t\t\t \n\tu32 reserved1;\n\tu64 hdr_address;\t\t\t \n\tu32 hdr_len;\t\t\t\t \n\tu32 reserved2;\n\tu64 guest_address;\t\t\t \n\tu32 guest_len;\t\t\t\t \n\tu32 reserved3;\n\tu64 trans_address;\t\t\t \n\tu32 trans_len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_launch_finish {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_send_start {\n\tu32 handle;\t\t\t\t \n\tu32 policy;\t\t\t\t \n\tu64 pdh_cert_address;\t\t\t \n\tu32 pdh_cert_len;\t\t\t \n\tu32 reserved1;\n\tu64 plat_certs_address;\t\t\t \n\tu32 plat_certs_len;\t\t\t \n\tu32 reserved2;\n\tu64 amd_certs_address;\t\t\t \n\tu32 amd_certs_len;\t\t\t \n\tu32 reserved3;\n\tu64 session_address;\t\t\t \n\tu32 session_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_send_update_data {\n\tu32 handle;\t\t\t\t \n\tu32 reserved1;\n\tu64 hdr_address;\t\t\t \n\tu32 hdr_len;\t\t\t\t \n\tu32 reserved2;\n\tu64 guest_address;\t\t\t \n\tu32 guest_len;\t\t\t\t \n\tu32 reserved3;\n\tu64 trans_address;\t\t\t \n\tu32 trans_len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_send_update_vmsa {\n\tu32 handle;\t\t\t\t \n\tu64 hdr_address;\t\t\t \n\tu32 hdr_len;\t\t\t\t \n\tu32 reserved2;\n\tu64 guest_address;\t\t\t \n\tu32 guest_len;\t\t\t\t \n\tu32 reserved3;\n\tu64 trans_address;\t\t\t \n\tu32 trans_len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_send_finish {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_send_cancel {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_receive_start {\n\tu32 handle;\t\t\t\t \n\tu32 policy;\t\t\t\t \n\tu64 pdh_cert_address;\t\t\t \n\tu32 pdh_cert_len;\t\t\t \n\tu32 reserved1;\n\tu64 session_address;\t\t\t \n\tu32 session_len;\t\t\t \n} __packed;\n\n \nstruct sev_data_receive_update_data {\n\tu32 handle;\t\t\t\t \n\tu32 reserved1;\n\tu64 hdr_address;\t\t\t \n\tu32 hdr_len;\t\t\t\t \n\tu32 reserved2;\n\tu64 guest_address;\t\t\t \n\tu32 guest_len;\t\t\t\t \n\tu32 reserved3;\n\tu64 trans_address;\t\t\t \n\tu32 trans_len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_receive_update_vmsa {\n\tu32 handle;\t\t\t\t \n\tu32 reserved1;\n\tu64 hdr_address;\t\t\t \n\tu32 hdr_len;\t\t\t\t \n\tu32 reserved2;\n\tu64 guest_address;\t\t\t \n\tu32 guest_len;\t\t\t\t \n\tu32 reserved3;\n\tu64 trans_address;\t\t\t \n\tu32 trans_len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_receive_finish {\n\tu32 handle;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_dbg {\n\tu32 handle;\t\t\t\t \n\tu32 reserved;\n\tu64 src_addr;\t\t\t\t \n\tu64 dst_addr;\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n \nstruct sev_data_attestation_report {\n\tu32 handle;\t\t\t\t \n\tu32 reserved;\n\tu64 address;\t\t\t\t \n\tu8 mnonce[16];\t\t\t\t \n\tu32 len;\t\t\t\t \n} __packed;\n\n#ifdef CONFIG_CRYPTO_DEV_SP_PSP\n\n \nint sev_platform_init(int *error);\n\n \nint sev_platform_status(struct sev_user_data_status *status, int *error);\n\n \nint sev_issue_cmd_external_user(struct file *filep, unsigned int id,\n\t\t\t\tvoid *data, int *error);\n\n \nint sev_guest_deactivate(struct sev_data_deactivate *data, int *error);\n\n \nint sev_guest_activate(struct sev_data_activate *data, int *error);\n\n \nint sev_guest_df_flush(int *error);\n\n \nint sev_guest_decommission(struct sev_data_decommission *data, int *error);\n\nvoid *psp_copy_user_blob(u64 uaddr, u32 len);\n\n#else\t \n\nstatic inline int\nsev_platform_status(struct sev_user_data_status *status, int *error) { return -ENODEV; }\n\nstatic inline int sev_platform_init(int *error) { return -ENODEV; }\n\nstatic inline int\nsev_guest_deactivate(struct sev_data_deactivate *data, int *error) { return -ENODEV; }\n\nstatic inline int\nsev_guest_decommission(struct sev_data_decommission *data, int *error) { return -ENODEV; }\n\nstatic inline int\nsev_guest_activate(struct sev_data_activate *data, int *error) { return -ENODEV; }\n\nstatic inline int sev_guest_df_flush(int *error) { return -ENODEV; }\n\nstatic inline int\nsev_issue_cmd_external_user(struct file *filep, unsigned int id, void *data, int *error) { return -ENODEV; }\n\nstatic inline void *psp_copy_user_blob(u64 __user uaddr, u32 len) { return ERR_PTR(-EINVAL); }\n\n#endif\t \n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}