{
  "module_name": "ccp.h",
  "hash_id": "0e750e3a1f4e9033960da4672ccdb877c7b5728bc1496ee417d1f4c6f12e6579",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ccp.h",
  "human_readable_source": " \n \n\n#ifndef __CCP_H__\n#define __CCP_H__\n\n#include <linux/scatterlist.h>\n#include <linux/workqueue.h>\n#include <linux/list.h>\n#include <crypto/aes.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n\nstruct ccp_device;\nstruct ccp_cmd;\n\n#if defined(CONFIG_CRYPTO_DEV_SP_CCP)\n\n \nint ccp_present(void);\n\n#define\tCCP_VSIZE 16\n#define\tCCP_VMASK\t\t((unsigned int)((1 << CCP_VSIZE) - 1))\n#define\tCCP_VERSION(v, r)\t((unsigned int)((v << CCP_VSIZE) \\\n\t\t\t\t\t       | (r & CCP_VMASK)))\n\n \nunsigned int ccp_version(void);\n\n \nint ccp_enqueue_cmd(struct ccp_cmd *cmd);\n\n#else  \n\nstatic inline int ccp_present(void)\n{\n\treturn -ENODEV;\n}\n\nstatic inline unsigned int ccp_version(void)\n{\n\treturn 0;\n}\n\nstatic inline int ccp_enqueue_cmd(struct ccp_cmd *cmd)\n{\n\treturn -ENODEV;\n}\n\n#endif  \n\n\n \n \nenum ccp_aes_type {\n\tCCP_AES_TYPE_128 = 0,\n\tCCP_AES_TYPE_192,\n\tCCP_AES_TYPE_256,\n\tCCP_AES_TYPE__LAST,\n};\n\n \nenum ccp_aes_mode {\n\tCCP_AES_MODE_ECB = 0,\n\tCCP_AES_MODE_CBC,\n\tCCP_AES_MODE_OFB,\n\tCCP_AES_MODE_CFB,\n\tCCP_AES_MODE_CTR,\n\tCCP_AES_MODE_CMAC,\n\tCCP_AES_MODE_GHASH,\n\tCCP_AES_MODE_GCTR,\n\tCCP_AES_MODE_GCM,\n\tCCP_AES_MODE_GMAC,\n\tCCP_AES_MODE__LAST,\n};\n\n \nenum ccp_aes_action {\n\tCCP_AES_ACTION_DECRYPT = 0,\n\tCCP_AES_ACTION_ENCRYPT,\n\tCCP_AES_ACTION__LAST,\n};\n \n#define\tCCP_AES_GHASHAAD\tCCP_AES_ACTION_DECRYPT\n#define\tCCP_AES_GHASHFINAL\tCCP_AES_ACTION_ENCRYPT\n\n \nstruct ccp_aes_engine {\n\tenum ccp_aes_type type;\n\tenum ccp_aes_mode mode;\n\tenum ccp_aes_action action;\n\n\tu32 authsize;\n\n\tstruct scatterlist *key;\n\tu32 key_len;\t\t \n\n\tstruct scatterlist *iv;\n\tu32 iv_len;\t\t \n\n\tstruct scatterlist *src, *dst;\n\tu64 src_len;\t\t \n\n\tu32 cmac_final;\t\t \n\tstruct scatterlist *cmac_key;\t \n\tu32 cmac_key_len;\t \n\n\tu32 aad_len;\t\t \n};\n\n \n \nenum ccp_xts_aes_unit_size {\n\tCCP_XTS_AES_UNIT_SIZE_16 = 0,\n\tCCP_XTS_AES_UNIT_SIZE_512,\n\tCCP_XTS_AES_UNIT_SIZE_1024,\n\tCCP_XTS_AES_UNIT_SIZE_2048,\n\tCCP_XTS_AES_UNIT_SIZE_4096,\n\tCCP_XTS_AES_UNIT_SIZE__LAST,\n};\n\n \nstruct ccp_xts_aes_engine {\n\tenum ccp_aes_type type;\n\tenum ccp_aes_action action;\n\tenum ccp_xts_aes_unit_size unit_size;\n\n\tstruct scatterlist *key;\n\tu32 key_len;\t\t \n\n\tstruct scatterlist *iv;\n\tu32 iv_len;\t\t \n\n\tstruct scatterlist *src, *dst;\n\tu64 src_len;\t\t \n\n\tu32 final;\n};\n\n \n \nenum ccp_sha_type {\n\tCCP_SHA_TYPE_1 = 1,\n\tCCP_SHA_TYPE_224,\n\tCCP_SHA_TYPE_256,\n\tCCP_SHA_TYPE_384,\n\tCCP_SHA_TYPE_512,\n\tCCP_SHA_TYPE__LAST,\n};\n\n \nstruct ccp_sha_engine {\n\tenum ccp_sha_type type;\n\n\tstruct scatterlist *ctx;\n\tu32 ctx_len;\t\t \n\n\tstruct scatterlist *src;\n\tu64 src_len;\t\t \n\n\tstruct scatterlist *opad;\n\tu32 opad_len;\t\t \n\n\tu32 first;\t\t \n\tu32 final;\t\t \n\tu64 msg_bits;\t\t \n};\n\n \nenum ccp_des3_mode {\n\tCCP_DES3_MODE_ECB = 0,\n\tCCP_DES3_MODE_CBC,\n\tCCP_DES3_MODE_CFB,\n\tCCP_DES3_MODE__LAST,\n};\n\nenum ccp_des3_type {\n\tCCP_DES3_TYPE_168 = 1,\n\tCCP_DES3_TYPE__LAST,\n\t};\n\nenum ccp_des3_action {\n\tCCP_DES3_ACTION_DECRYPT = 0,\n\tCCP_DES3_ACTION_ENCRYPT,\n\tCCP_DES3_ACTION__LAST,\n};\n\n \nstruct ccp_des3_engine {\n\tenum ccp_des3_type type;\n\tenum ccp_des3_mode mode;\n\tenum ccp_des3_action action;\n\n\tstruct scatterlist *key;\n\tu32 key_len;\t     \n\n\tstruct scatterlist *iv;\n\tu32 iv_len;\t      \n\n\tstruct scatterlist *src, *dst;\n\tu64 src_len;\t     \n};\n\n \n \nstruct ccp_rsa_engine {\n\tu32 key_size;\t\t \n\n\tstruct scatterlist *exp;\n\tu32 exp_len;\t\t \n\n\tstruct scatterlist *mod;\n\tu32 mod_len;\t\t \n\n\tstruct scatterlist *src, *dst;\n\tu32 src_len;\t\t \n};\n\n \n \nenum ccp_passthru_bitwise {\n\tCCP_PASSTHRU_BITWISE_NOOP = 0,\n\tCCP_PASSTHRU_BITWISE_AND,\n\tCCP_PASSTHRU_BITWISE_OR,\n\tCCP_PASSTHRU_BITWISE_XOR,\n\tCCP_PASSTHRU_BITWISE_MASK,\n\tCCP_PASSTHRU_BITWISE__LAST,\n};\n\n \nenum ccp_passthru_byteswap {\n\tCCP_PASSTHRU_BYTESWAP_NOOP = 0,\n\tCCP_PASSTHRU_BYTESWAP_32BIT,\n\tCCP_PASSTHRU_BYTESWAP_256BIT,\n\tCCP_PASSTHRU_BYTESWAP__LAST,\n};\n\n \nstruct ccp_passthru_engine {\n\tenum ccp_passthru_bitwise bit_mod;\n\tenum ccp_passthru_byteswap byte_swap;\n\n\tstruct scatterlist *mask;\n\tu32 mask_len;\t\t \n\n\tstruct scatterlist *src, *dst;\n\tu64 src_len;\t\t \n\n\tu32 final;\n};\n\n \nstruct ccp_passthru_nomap_engine {\n\tenum ccp_passthru_bitwise bit_mod;\n\tenum ccp_passthru_byteswap byte_swap;\n\n\tdma_addr_t mask;\n\tu32 mask_len;\t\t \n\n\tdma_addr_t src_dma, dst_dma;\n\tu64 src_len;\t\t \n\n\tu32 final;\n};\n\n \n#define CCP_ECC_MODULUS_BYTES\t48\t \n#define CCP_ECC_MAX_OPERANDS\t6\n#define CCP_ECC_MAX_OUTPUTS\t3\n\n \nenum ccp_ecc_function {\n\tCCP_ECC_FUNCTION_MMUL_384BIT = 0,\n\tCCP_ECC_FUNCTION_MADD_384BIT,\n\tCCP_ECC_FUNCTION_MINV_384BIT,\n\tCCP_ECC_FUNCTION_PADD_384BIT,\n\tCCP_ECC_FUNCTION_PMUL_384BIT,\n\tCCP_ECC_FUNCTION_PDBL_384BIT,\n};\n\n \nstruct ccp_ecc_modular_math {\n\tstruct scatterlist *operand_1;\n\tunsigned int operand_1_len;\t \n\n\tstruct scatterlist *operand_2;\n\tunsigned int operand_2_len;\t \n\n\tstruct scatterlist *result;\n\tunsigned int result_len;\t \n};\n\n \nstruct ccp_ecc_point {\n\tstruct scatterlist *x;\n\tunsigned int x_len;\t \n\n\tstruct scatterlist *y;\n\tunsigned int y_len;\t \n};\n\n \nstruct ccp_ecc_point_math {\n\tstruct ccp_ecc_point point_1;\n\tstruct ccp_ecc_point point_2;\n\n\tstruct scatterlist *domain_a;\n\tunsigned int domain_a_len;\t \n\n\tstruct scatterlist *scalar;\n\tunsigned int scalar_len;\t \n\n\tstruct ccp_ecc_point result;\n};\n\n \nstruct ccp_ecc_engine {\n\tenum ccp_ecc_function function;\n\n\tstruct scatterlist *mod;\n\tu32 mod_len;\t\t \n\n\tunion {\n\t\tstruct ccp_ecc_modular_math mm;\n\t\tstruct ccp_ecc_point_math pm;\n\t} u;\n\n\tu16 ecc_result;\n};\n\n\n \nenum ccp_engine {\n\tCCP_ENGINE_AES = 0,\n\tCCP_ENGINE_XTS_AES_128,\n\tCCP_ENGINE_DES3,\n\tCCP_ENGINE_SHA,\n\tCCP_ENGINE_RSA,\n\tCCP_ENGINE_PASSTHRU,\n\tCCP_ENGINE_ZLIB_DECOMPRESS,\n\tCCP_ENGINE_ECC,\n\tCCP_ENGINE__LAST,\n};\n\n \n#define CCP_CMD_MAY_BACKLOG\t\t0x00000001\n#define CCP_CMD_PASSTHRU_NO_DMA_MAP\t0x00000002\n\n \nstruct ccp_cmd {\n\t \n\tstruct list_head entry;\n\tstruct work_struct work;\n\tstruct ccp_device *ccp;\n\tint ret;\n\n\tu32 flags;\n\n\tenum ccp_engine engine;\n\tu32 engine_error;\n\n\tunion {\n\t\tstruct ccp_aes_engine aes;\n\t\tstruct ccp_xts_aes_engine xts;\n\t\tstruct ccp_des3_engine des3;\n\t\tstruct ccp_sha_engine sha;\n\t\tstruct ccp_rsa_engine rsa;\n\t\tstruct ccp_passthru_engine passthru;\n\t\tstruct ccp_passthru_nomap_engine passthru_nomap;\n\t\tstruct ccp_ecc_engine ecc;\n\t} u;\n\n\t \n\tvoid (*callback)(void *data, int err);\n\tvoid *data;\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}