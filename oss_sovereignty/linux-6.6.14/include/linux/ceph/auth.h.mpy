{
  "module_name": "auth.h",
  "hash_id": "f172db2c19d60cf0d5960191e81f94ad029a5a428482b9bff9079b3f0c59b6ec",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ceph/auth.h",
  "human_readable_source": " \n#ifndef _FS_CEPH_AUTH_H\n#define _FS_CEPH_AUTH_H\n\n#include <linux/ceph/types.h>\n#include <linux/ceph/buffer.h>\n\n \n\nstruct ceph_auth_client;\nstruct ceph_msg;\n\nstruct ceph_authorizer {\n\tvoid (*destroy)(struct ceph_authorizer *);\n};\n\nstruct ceph_auth_handshake {\n\tstruct ceph_authorizer *authorizer;\n\tvoid *authorizer_buf;\n\tsize_t authorizer_buf_len;\n\tvoid *authorizer_reply_buf;\n\tsize_t authorizer_reply_buf_len;\n\tint (*sign_message)(struct ceph_auth_handshake *auth,\n\t\t\t    struct ceph_msg *msg);\n\tint (*check_message_signature)(struct ceph_auth_handshake *auth,\n\t\t\t\t       struct ceph_msg *msg);\n};\n\nstruct ceph_auth_client_ops {\n\t \n\tint (*is_authenticated)(struct ceph_auth_client *ac);\n\n\t \n\tint (*should_authenticate)(struct ceph_auth_client *ac);\n\n\t \n\tint (*build_request)(struct ceph_auth_client *ac, void *buf, void *end);\n\tint (*handle_reply)(struct ceph_auth_client *ac, u64 global_id,\n\t\t\t    void *buf, void *end, u8 *session_key,\n\t\t\t    int *session_key_len, u8 *con_secret,\n\t\t\t    int *con_secret_len);\n\n\t \n\tint (*create_authorizer)(struct ceph_auth_client *ac, int peer_type,\n\t\t\t\t struct ceph_auth_handshake *auth);\n\t \n\tint (*update_authorizer)(struct ceph_auth_client *ac, int peer_type,\n\t\t\t\t struct ceph_auth_handshake *auth);\n\tint (*add_authorizer_challenge)(struct ceph_auth_client *ac,\n\t\t\t\t\tstruct ceph_authorizer *a,\n\t\t\t\t\tvoid *challenge_buf,\n\t\t\t\t\tint challenge_buf_len);\n\tint (*verify_authorizer_reply)(struct ceph_auth_client *ac,\n\t\t\t\t       struct ceph_authorizer *a,\n\t\t\t\t       void *reply, int reply_len,\n\t\t\t\t       u8 *session_key, int *session_key_len,\n\t\t\t\t       u8 *con_secret, int *con_secret_len);\n\tvoid (*invalidate_authorizer)(struct ceph_auth_client *ac,\n\t\t\t\t      int peer_type);\n\n\t \n\tvoid (*reset)(struct ceph_auth_client *ac);\n\n\tvoid (*destroy)(struct ceph_auth_client *ac);\n\n\tint (*sign_message)(struct ceph_auth_handshake *auth,\n\t\t\t    struct ceph_msg *msg);\n\tint (*check_message_signature)(struct ceph_auth_handshake *auth,\n\t\t\t\t       struct ceph_msg *msg);\n};\n\nstruct ceph_auth_client {\n\tu32 protocol;            \n\tvoid *private;           \n\tconst struct ceph_auth_client_ops *ops;   \n\n\tbool negotiating;        \n\tconst char *name;        \n\tu64 global_id;           \n\tconst struct ceph_crypto_key *key;      \n\tunsigned want_keys;      \n\n\tint preferred_mode;\t \n\tint fallback_mode;\t \n\n\tstruct mutex mutex;\n};\n\nvoid ceph_auth_set_global_id(struct ceph_auth_client *ac, u64 global_id);\n\nstruct ceph_auth_client *ceph_auth_init(const char *name,\n\t\t\t\t\tconst struct ceph_crypto_key *key,\n\t\t\t\t\tconst int *con_modes);\nextern void ceph_auth_destroy(struct ceph_auth_client *ac);\n\nextern void ceph_auth_reset(struct ceph_auth_client *ac);\n\nextern int ceph_auth_build_hello(struct ceph_auth_client *ac,\n\t\t\t\t void *buf, size_t len);\nextern int ceph_handle_auth_reply(struct ceph_auth_client *ac,\n\t\t\t\t  void *buf, size_t len,\n\t\t\t\t  void *reply_buf, size_t reply_len);\nint ceph_auth_entity_name_encode(const char *name, void **p, void *end);\n\nextern int ceph_build_auth(struct ceph_auth_client *ac,\n\t\t    void *msg_buf, size_t msg_len);\nextern int ceph_auth_is_authenticated(struct ceph_auth_client *ac);\n\nint __ceph_auth_get_authorizer(struct ceph_auth_client *ac,\n\t\t\t       struct ceph_auth_handshake *auth,\n\t\t\t       int peer_type, bool force_new,\n\t\t\t       int *proto, int *pref_mode, int *fallb_mode);\nvoid ceph_auth_destroy_authorizer(struct ceph_authorizer *a);\nint ceph_auth_add_authorizer_challenge(struct ceph_auth_client *ac,\n\t\t\t\t       struct ceph_authorizer *a,\n\t\t\t\t       void *challenge_buf,\n\t\t\t\t       int challenge_buf_len);\nint ceph_auth_verify_authorizer_reply(struct ceph_auth_client *ac,\n\t\t\t\t      struct ceph_authorizer *a,\n\t\t\t\t      void *reply, int reply_len,\n\t\t\t\t      u8 *session_key, int *session_key_len,\n\t\t\t\t      u8 *con_secret, int *con_secret_len);\nextern void ceph_auth_invalidate_authorizer(struct ceph_auth_client *ac,\n\t\t\t\t\t    int peer_type);\n\nstatic inline int ceph_auth_sign_message(struct ceph_auth_handshake *auth,\n\t\t\t\t\t struct ceph_msg *msg)\n{\n\tif (auth->sign_message)\n\t\treturn auth->sign_message(auth, msg);\n\treturn 0;\n}\n\nstatic inline\nint ceph_auth_check_message_signature(struct ceph_auth_handshake *auth,\n\t\t\t\t      struct ceph_msg *msg)\n{\n\tif (auth->check_message_signature)\n\t\treturn auth->check_message_signature(auth, msg);\n\treturn 0;\n}\n\nint ceph_auth_get_request(struct ceph_auth_client *ac, void *buf, int buf_len);\nint ceph_auth_handle_reply_more(struct ceph_auth_client *ac, void *reply,\n\t\t\t\tint reply_len, void *buf, int buf_len);\nint ceph_auth_handle_reply_done(struct ceph_auth_client *ac,\n\t\t\t\tu64 global_id, void *reply, int reply_len,\n\t\t\t\tu8 *session_key, int *session_key_len,\n\t\t\t\tu8 *con_secret, int *con_secret_len);\nbool ceph_auth_handle_bad_method(struct ceph_auth_client *ac,\n\t\t\t\t int used_proto, int result,\n\t\t\t\t const int *allowed_protos, int proto_cnt,\n\t\t\t\t const int *allowed_modes, int mode_cnt);\n\nint ceph_auth_get_authorizer(struct ceph_auth_client *ac,\n\t\t\t     struct ceph_auth_handshake *auth,\n\t\t\t     int peer_type, void *buf, int *buf_len);\nint ceph_auth_handle_svc_reply_more(struct ceph_auth_client *ac,\n\t\t\t\t    struct ceph_auth_handshake *auth,\n\t\t\t\t    void *reply, int reply_len,\n\t\t\t\t    void *buf, int *buf_len);\nint ceph_auth_handle_svc_reply_done(struct ceph_auth_client *ac,\n\t\t\t\t    struct ceph_auth_handshake *auth,\n\t\t\t\t    void *reply, int reply_len,\n\t\t\t\t    u8 *session_key, int *session_key_len,\n\t\t\t\t    u8 *con_secret, int *con_secret_len);\nbool ceph_auth_handle_bad_authorizer(struct ceph_auth_client *ac,\n\t\t\t\t     int peer_type, int used_proto, int result,\n\t\t\t\t     const int *allowed_protos, int proto_cnt,\n\t\t\t\t     const int *allowed_modes, int mode_cnt);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}