{
  "module_name": "ebtables.h",
  "hash_id": "9498e5c5c32a04fd140ffc89f2c36a4a9614cb4c490cc8c7c8d8f3d097f47d6e",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/netfilter_bridge/ebtables.h",
  "human_readable_source": " \n \n#ifndef __LINUX_BRIDGE_EFF_H\n#define __LINUX_BRIDGE_EFF_H\n\n#include <linux/if.h>\n#include <linux/if_ether.h>\n#include <uapi/linux/netfilter_bridge/ebtables.h>\n\nstruct ebt_match {\n\tstruct list_head list;\n\tconst char name[EBT_FUNCTION_MAXNAMELEN];\n\tbool (*match)(const struct sk_buff *skb, const struct net_device *in,\n\t\tconst struct net_device *out, const struct xt_match *match,\n\t\tconst void *matchinfo, int offset, unsigned int protoff,\n\t\tbool *hotdrop);\n\tbool (*checkentry)(const char *table, const void *entry,\n\t\tconst struct xt_match *match, void *matchinfo,\n\t\tunsigned int hook_mask);\n\tvoid (*destroy)(const struct xt_match *match, void *matchinfo);\n\tunsigned int matchsize;\n\tu_int8_t revision;\n\tu_int8_t family;\n\tstruct module *me;\n};\n\nstruct ebt_watcher {\n\tstruct list_head list;\n\tconst char name[EBT_FUNCTION_MAXNAMELEN];\n\tunsigned int (*target)(struct sk_buff *skb,\n\t\tconst struct net_device *in, const struct net_device *out,\n\t\tunsigned int hook_num, const struct xt_target *target,\n\t\tconst void *targinfo);\n\tbool (*checkentry)(const char *table, const void *entry,\n\t\tconst struct xt_target *target, void *targinfo,\n\t\tunsigned int hook_mask);\n\tvoid (*destroy)(const struct xt_target *target, void *targinfo);\n\tunsigned int targetsize;\n\tu_int8_t revision;\n\tu_int8_t family;\n\tstruct module *me;\n};\n\nstruct ebt_target {\n\tstruct list_head list;\n\tconst char name[EBT_FUNCTION_MAXNAMELEN];\n\t \n\tunsigned int (*target)(struct sk_buff *skb,\n\t\tconst struct net_device *in, const struct net_device *out,\n\t\tunsigned int hook_num, const struct xt_target *target,\n\t\tconst void *targinfo);\n\tbool (*checkentry)(const char *table, const void *entry,\n\t\tconst struct xt_target *target, void *targinfo,\n\t\tunsigned int hook_mask);\n\tvoid (*destroy)(const struct xt_target *target, void *targinfo);\n\tunsigned int targetsize;\n\tu_int8_t revision;\n\tu_int8_t family;\n\tstruct module *me;\n};\n\n \nstruct ebt_chainstack {\n\tstruct ebt_entries *chaininfo;  \n\tstruct ebt_entry *e;  \n\tunsigned int n;  \n};\n\nstruct ebt_table_info {\n\t \n\tunsigned int entries_size;\n\tunsigned int nentries;\n\t \n\tstruct ebt_entries *hook_entry[NF_BR_NUMHOOKS];\n\t \n\tstruct ebt_chainstack **chainstack;\n\tchar *entries;\n\tstruct ebt_counter counters[] ____cacheline_aligned;\n};\n\nstruct ebt_table {\n\tstruct list_head list;\n\tchar name[EBT_TABLE_MAXNAMELEN];\n\tstruct ebt_replace_kernel *table;\n\tunsigned int valid_hooks;\n\trwlock_t lock;\n\t \n\tstruct ebt_table_info *private;\n\tstruct nf_hook_ops *ops;\n\tstruct module *me;\n};\n\n#define EBT_ALIGN(s) (((s) + (__alignof__(struct _xt_align)-1)) & \\\n\t\t     ~(__alignof__(struct _xt_align)-1))\n\nextern int ebt_register_table(struct net *net,\n\t\t\t      const struct ebt_table *table,\n\t\t\t      const struct nf_hook_ops *ops);\nextern void ebt_unregister_table(struct net *net, const char *tablename);\nvoid ebt_unregister_table_pre_exit(struct net *net, const char *tablename);\nextern unsigned int ebt_do_table(void *priv, struct sk_buff *skb,\n\t\t\t\t const struct nf_hook_state *state);\n\n \n#define BASE_CHAIN (par->hook_mask & (1 << NF_BR_NUMHOOKS))\n \n#define CLEAR_BASE_CHAIN_BIT (par->hook_mask &= ~(1 << NF_BR_NUMHOOKS))\n\nstatic inline bool ebt_invalid_target(int target)\n{\n\treturn (target < -NUM_STANDARD_TARGETS || target >= 0);\n}\n\nint ebt_register_template(const struct ebt_table *t, int(*table_init)(struct net *net));\nvoid ebt_unregister_template(const struct ebt_table *t);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}