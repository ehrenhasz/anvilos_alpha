{
  "module_name": "textsearch.h",
  "hash_id": "eccfe02855bb831b5e2c70bae4f24cd08f72560f848f315cee62d9d42f6dd7b7",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/textsearch.h",
  "human_readable_source": " \n#ifndef __LINUX_TEXTSEARCH_H\n#define __LINUX_TEXTSEARCH_H\n\n#include <linux/types.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n\nstruct module;\n\nstruct ts_config;\n\n#define TS_AUTOLOAD\t1  \n#define TS_IGNORECASE\t2  \n\n \nstruct ts_state\n{\n\tunsigned int\t\toffset;\n\tchar\t\t\tcb[48];\n};\n\n \nstruct ts_ops\n{\n\tconst char\t\t*name;\n\tstruct ts_config *\t(*init)(const void *, unsigned int, gfp_t, int);\n\tunsigned int\t\t(*find)(struct ts_config *,\n\t\t\t\t\tstruct ts_state *);\n\tvoid\t\t\t(*destroy)(struct ts_config *);\n\tvoid *\t\t\t(*get_pattern)(struct ts_config *);\n\tunsigned int\t\t(*get_pattern_len)(struct ts_config *);\n\tstruct module\t\t*owner;\n\tstruct list_head\tlist;\n};\n\n \nstruct ts_config\n{\n\tstruct ts_ops\t\t*ops;\n\tint \t\t\tflags;\n\n\t \n\tunsigned int\t\t(*get_next_block)(unsigned int consumed,\n\t\t\t\t\t\t  const u8 **dst,\n\t\t\t\t\t\t  struct ts_config *conf,\n\t\t\t\t\t\t  struct ts_state *state);\n\n\t \n\tvoid\t\t\t(*finish)(struct ts_config *conf,\n\t\t\t\t\t  struct ts_state *state);\n};\n\n  \nstatic inline unsigned int textsearch_next(struct ts_config *conf,\n\t\t\t\t\t   struct ts_state *state)\n{\n\tunsigned int ret = conf->ops->find(conf, state);\n\n\tif (conf->finish)\n\t\tconf->finish(conf, state);\n\n\treturn ret;\n}\n\n  \nstatic inline unsigned int textsearch_find(struct ts_config *conf,\n\t\t\t\t\t   struct ts_state *state)\n{\n\tstate->offset = 0;\n\treturn textsearch_next(conf, state);\n}\n\n \nstatic inline void *textsearch_get_pattern(struct ts_config *conf)\n{\n\treturn conf->ops->get_pattern(conf);\n}\n\n \nstatic inline unsigned int textsearch_get_pattern_len(struct ts_config *conf)\n{\n\treturn conf->ops->get_pattern_len(conf);\n}\n\nextern int textsearch_register(struct ts_ops *);\nextern int textsearch_unregister(struct ts_ops *);\nextern struct ts_config *textsearch_prepare(const char *, const void *,\n\t\t\t\t\t    unsigned int, gfp_t, int);\nextern void textsearch_destroy(struct ts_config *conf);\nextern unsigned int textsearch_find_continuous(struct ts_config *,\n\t\t\t\t\t       struct ts_state *,\n\t\t\t\t\t       const void *, unsigned int);\n\n\n#define TS_PRIV_ALIGNTO\t8\n#define TS_PRIV_ALIGN(len) (((len) + TS_PRIV_ALIGNTO-1) & ~(TS_PRIV_ALIGNTO-1))\n\nstatic inline struct ts_config *alloc_ts_config(size_t payload,\n\t\t\t\t\t\tgfp_t gfp_mask)\n{\n\tstruct ts_config *conf;\n\n\tconf = kzalloc(TS_PRIV_ALIGN(sizeof(*conf)) + payload, gfp_mask);\n\tif (conf == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\treturn conf;\n}\n\nstatic inline void *ts_config_priv(struct ts_config *conf)\n{\n\treturn ((u8 *) conf + TS_PRIV_ALIGN(sizeof(struct ts_config)));\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}