{
  "module_name": "igmp.h",
  "hash_id": "54944d42516687ac9de9126f89cbdb2e232246365d6e4da1d6aaa879458754a2",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/igmp.h",
  "human_readable_source": " \n \n#ifndef _LINUX_IGMP_H\n#define _LINUX_IGMP_H\n\n#include <linux/skbuff.h>\n#include <linux/timer.h>\n#include <linux/in.h>\n#include <linux/ip.h>\n#include <linux/refcount.h>\n#include <linux/sockptr.h>\n#include <uapi/linux/igmp.h>\n\nstatic inline struct igmphdr *igmp_hdr(const struct sk_buff *skb)\n{\n\treturn (struct igmphdr *)skb_transport_header(skb);\n}\n\nstatic inline struct igmpv3_report *\n\t\t\tigmpv3_report_hdr(const struct sk_buff *skb)\n{\n\treturn (struct igmpv3_report *)skb_transport_header(skb);\n}\n\nstatic inline struct igmpv3_query *\n\t\t\tigmpv3_query_hdr(const struct sk_buff *skb)\n{\n\treturn (struct igmpv3_query *)skb_transport_header(skb);\n}\n\nstruct ip_sf_socklist {\n\tunsigned int\t\tsl_max;\n\tunsigned int\t\tsl_count;\n\tstruct rcu_head\t\trcu;\n\t__be32\t\t\tsl_addr[];\n};\n\n#define IP_SFBLOCK\t10\t \n\n \n\nstruct ip_mc_socklist {\n\tstruct ip_mc_socklist __rcu *next_rcu;\n\tstruct ip_mreqn\t\tmulti;\n\tunsigned int\t\tsfmode;\t\t \n\tstruct ip_sf_socklist __rcu\t*sflist;\n\tstruct rcu_head\t\trcu;\n};\n\nstruct ip_sf_list {\n\tstruct ip_sf_list\t*sf_next;\n\tunsigned long\t\tsf_count[2];\t \n\t__be32\t\t\tsf_inaddr;\n\tunsigned char\t\tsf_gsresp;\t \n\tunsigned char\t\tsf_oldin;\t \n\tunsigned char\t\tsf_crcount;\t \n};\n\nstruct ip_mc_list {\n\tstruct in_device\t*interface;\n\t__be32\t\t\tmultiaddr;\n\tunsigned int\t\tsfmode;\n\tstruct ip_sf_list\t*sources;\n\tstruct ip_sf_list\t*tomb;\n\tunsigned long\t\tsfcount[2];\n\tunion {\n\t\tstruct ip_mc_list *next;\n\t\tstruct ip_mc_list __rcu *next_rcu;\n\t};\n\tstruct ip_mc_list __rcu *next_hash;\n\tstruct timer_list\ttimer;\n\tint\t\t\tusers;\n\trefcount_t\t\trefcnt;\n\tspinlock_t\t\tlock;\n\tchar\t\t\ttm_running;\n\tchar\t\t\treporter;\n\tchar\t\t\tunsolicit_count;\n\tchar\t\t\tloaded;\n\tunsigned char\t\tgsquery;\t \n\tunsigned char\t\tcrcount;\n\tstruct rcu_head\t\trcu;\n};\n\n \n#define IGMPV3_MASK(value, nb) ((nb)>=32 ? (value) : ((1<<(nb))-1) & (value))\n#define IGMPV3_EXP(thresh, nbmant, nbexp, value) \\\n\t((value) < (thresh) ? (value) : \\\n        ((IGMPV3_MASK(value, nbmant) | (1<<(nbmant))) << \\\n         (IGMPV3_MASK((value) >> (nbmant), nbexp) + (nbexp))))\n\n#define IGMPV3_QQIC(value) IGMPV3_EXP(0x80, 4, 3, value)\n#define IGMPV3_MRC(value) IGMPV3_EXP(0x80, 4, 3, value)\n\nstatic inline int ip_mc_may_pull(struct sk_buff *skb, unsigned int len)\n{\n\tif (skb_transport_offset(skb) + ip_transport_len(skb) < len)\n\t\treturn 0;\n\n\treturn pskb_may_pull(skb, len);\n}\n\nextern int ip_check_mc_rcu(struct in_device *dev, __be32 mc_addr, __be32 src_addr, u8 proto);\nextern int igmp_rcv(struct sk_buff *);\nextern int ip_mc_join_group(struct sock *sk, struct ip_mreqn *imr);\nextern int ip_mc_join_group_ssm(struct sock *sk, struct ip_mreqn *imr,\n\t\t\t\tunsigned int mode);\nextern int ip_mc_leave_group(struct sock *sk, struct ip_mreqn *imr);\nextern void ip_mc_drop_socket(struct sock *sk);\nextern int ip_mc_source(int add, int omode, struct sock *sk,\n\t\tstruct ip_mreq_source *mreqs, int ifindex);\nextern int ip_mc_msfilter(struct sock *sk, struct ip_msfilter *msf,int ifindex);\nextern int ip_mc_msfget(struct sock *sk, struct ip_msfilter *msf,\n\t\t\tsockptr_t optval, sockptr_t optlen);\nextern int ip_mc_gsfget(struct sock *sk, struct group_filter *gsf,\n\t\t\tsockptr_t optval, size_t offset);\nextern int ip_mc_sf_allow(const struct sock *sk, __be32 local, __be32 rmt,\n\t\t\t  int dif, int sdif);\nextern void ip_mc_init_dev(struct in_device *);\nextern void ip_mc_destroy_dev(struct in_device *);\nextern void ip_mc_up(struct in_device *);\nextern void ip_mc_down(struct in_device *);\nextern void ip_mc_unmap(struct in_device *);\nextern void ip_mc_remap(struct in_device *);\nextern void __ip_mc_dec_group(struct in_device *in_dev, __be32 addr, gfp_t gfp);\nstatic inline void ip_mc_dec_group(struct in_device *in_dev, __be32 addr)\n{\n\treturn __ip_mc_dec_group(in_dev, addr, GFP_KERNEL);\n}\nextern void __ip_mc_inc_group(struct in_device *in_dev, __be32 addr,\n\t\t\t      gfp_t gfp);\nextern void ip_mc_inc_group(struct in_device *in_dev, __be32 addr);\nint ip_mc_check_igmp(struct sk_buff *skb);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}