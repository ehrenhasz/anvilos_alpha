{
  "module_name": "ipv6.h",
  "hash_id": "6cf948514668f5dc965a2a1a2791f2a622b2f768242d0e3fcfbd4a36275ed2f8",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ipv6.h",
  "human_readable_source": " \n#ifndef _IPV6_H\n#define _IPV6_H\n\n#include <uapi/linux/ipv6.h>\n\n#define ipv6_optlen(p)  (((p)->hdrlen+1) << 3)\n#define ipv6_authlen(p) (((p)->hdrlen+2) << 2)\n \nstruct ipv6_devconf {\n\t__s32\t\tforwarding;\n\t__s32\t\thop_limit;\n\t__s32\t\tmtu6;\n\t__s32\t\taccept_ra;\n\t__s32\t\taccept_redirects;\n\t__s32\t\tautoconf;\n\t__s32\t\tdad_transmits;\n\t__s32\t\trtr_solicits;\n\t__s32\t\trtr_solicit_interval;\n\t__s32\t\trtr_solicit_max_interval;\n\t__s32\t\trtr_solicit_delay;\n\t__s32\t\tforce_mld_version;\n\t__s32\t\tmldv1_unsolicited_report_interval;\n\t__s32\t\tmldv2_unsolicited_report_interval;\n\t__s32\t\tuse_tempaddr;\n\t__s32\t\ttemp_valid_lft;\n\t__s32\t\ttemp_prefered_lft;\n\t__s32\t\tregen_max_retry;\n\t__s32\t\tmax_desync_factor;\n\t__s32\t\tmax_addresses;\n\t__s32\t\taccept_ra_defrtr;\n\t__u32\t\tra_defrtr_metric;\n\t__s32\t\taccept_ra_min_hop_limit;\n\t__s32\t\taccept_ra_min_lft;\n\t__s32\t\taccept_ra_pinfo;\n\t__s32\t\tignore_routes_with_linkdown;\n#ifdef CONFIG_IPV6_ROUTER_PREF\n\t__s32\t\taccept_ra_rtr_pref;\n\t__s32\t\trtr_probe_interval;\n#ifdef CONFIG_IPV6_ROUTE_INFO\n\t__s32\t\taccept_ra_rt_info_min_plen;\n\t__s32\t\taccept_ra_rt_info_max_plen;\n#endif\n#endif\n\t__s32\t\tproxy_ndp;\n\t__s32\t\taccept_source_route;\n\t__s32\t\taccept_ra_from_local;\n#ifdef CONFIG_IPV6_OPTIMISTIC_DAD\n\t__s32\t\toptimistic_dad;\n\t__s32\t\tuse_optimistic;\n#endif\n#ifdef CONFIG_IPV6_MROUTE\n\tatomic_t\tmc_forwarding;\n#endif\n\t__s32\t\tdisable_ipv6;\n\t__s32\t\tdrop_unicast_in_l2_multicast;\n\t__s32\t\taccept_dad;\n\t__s32\t\tforce_tllao;\n\t__s32           ndisc_notify;\n\t__s32\t\tsuppress_frag_ndisc;\n\t__s32\t\taccept_ra_mtu;\n\t__s32\t\tdrop_unsolicited_na;\n\t__s32\t\taccept_untracked_na;\n\tstruct ipv6_stable_secret {\n\t\tbool initialized;\n\t\tstruct in6_addr secret;\n\t} stable_secret;\n\t__s32\t\tuse_oif_addrs_only;\n\t__s32\t\tkeep_addr_on_down;\n\t__s32\t\tseg6_enabled;\n#ifdef CONFIG_IPV6_SEG6_HMAC\n\t__s32\t\tseg6_require_hmac;\n#endif\n\t__u32\t\tenhanced_dad;\n\t__u32\t\taddr_gen_mode;\n\t__s32\t\tdisable_policy;\n\t__s32           ndisc_tclass;\n\t__s32\t\trpl_seg_enabled;\n\t__u32\t\tioam6_id;\n\t__u32\t\tioam6_id_wide;\n\t__u8\t\tioam6_enabled;\n\t__u8\t\tndisc_evict_nocarrier;\n\n\tstruct ctl_table_header *sysctl_header;\n};\n\nstruct ipv6_params {\n\t__s32 disable_ipv6;\n\t__s32 autoconf;\n};\nextern struct ipv6_params ipv6_defaults;\n#include <linux/tcp.h>\n#include <linux/udp.h>\n\n#include <net/inet_sock.h>\n\nstatic inline struct ipv6hdr *ipv6_hdr(const struct sk_buff *skb)\n{\n\treturn (struct ipv6hdr *)skb_network_header(skb);\n}\n\nstatic inline struct ipv6hdr *inner_ipv6_hdr(const struct sk_buff *skb)\n{\n\treturn (struct ipv6hdr *)skb_inner_network_header(skb);\n}\n\nstatic inline struct ipv6hdr *ipipv6_hdr(const struct sk_buff *skb)\n{\n\treturn (struct ipv6hdr *)skb_transport_header(skb);\n}\n\nstatic inline unsigned int ipv6_transport_len(const struct sk_buff *skb)\n{\n\treturn ntohs(ipv6_hdr(skb)->payload_len) + sizeof(struct ipv6hdr) -\n\t       skb_network_header_len(skb);\n}\n\n \n\nstruct inet6_skb_parm {\n\tint\t\t\tiif;\n\t__be16\t\t\tra;\n\t__u16\t\t\tdst0;\n\t__u16\t\t\tsrcrt;\n\t__u16\t\t\tdst1;\n\t__u16\t\t\tlastopt;\n\t__u16\t\t\tnhoff;\n\t__u16\t\t\tflags;\n#if defined(CONFIG_IPV6_MIP6) || defined(CONFIG_IPV6_MIP6_MODULE)\n\t__u16\t\t\tdsthao;\n#endif\n\t__u16\t\t\tfrag_max_size;\n\t__u16\t\t\tsrhoff;\n\n#define IP6SKB_XFRM_TRANSFORMED\t1\n#define IP6SKB_FORWARDED\t2\n#define IP6SKB_REROUTED\t\t4\n#define IP6SKB_ROUTERALERT\t8\n#define IP6SKB_FRAGMENTED      16\n#define IP6SKB_HOPBYHOP        32\n#define IP6SKB_L3SLAVE         64\n#define IP6SKB_JUMBOGRAM      128\n#define IP6SKB_SEG6\t      256\n#define IP6SKB_FAKEJUMBO      512\n#define IP6SKB_MULTIPATH      1024\n};\n\n#if defined(CONFIG_NET_L3_MASTER_DEV)\nstatic inline bool ipv6_l3mdev_skb(__u16 flags)\n{\n\treturn flags & IP6SKB_L3SLAVE;\n}\n#else\nstatic inline bool ipv6_l3mdev_skb(__u16 flags)\n{\n\treturn false;\n}\n#endif\n\n#define IP6CB(skb)\t((struct inet6_skb_parm*)((skb)->cb))\n#define IP6CBMTU(skb)\t((struct ip6_mtuinfo *)((skb)->cb))\n\nstatic inline int inet6_iif(const struct sk_buff *skb)\n{\n\tbool l3_slave = ipv6_l3mdev_skb(IP6CB(skb)->flags);\n\n\treturn l3_slave ? skb->skb_iif : IP6CB(skb)->iif;\n}\n\nstatic inline bool inet6_is_jumbogram(const struct sk_buff *skb)\n{\n\treturn !!(IP6CB(skb)->flags & IP6SKB_JUMBOGRAM);\n}\n\n \nstatic inline int inet6_sdif(const struct sk_buff *skb)\n{\n#if IS_ENABLED(CONFIG_NET_L3_MASTER_DEV)\n\tif (skb && ipv6_l3mdev_skb(IP6CB(skb)->flags))\n\t\treturn IP6CB(skb)->iif;\n#endif\n\treturn 0;\n}\n\nstruct tcp6_request_sock {\n\tstruct tcp_request_sock\t  tcp6rsk_tcp;\n};\n\nstruct ipv6_mc_socklist;\nstruct ipv6_ac_socklist;\nstruct ipv6_fl_socklist;\n\nstruct inet6_cork {\n\tstruct ipv6_txoptions *opt;\n\tu8 hop_limit;\n\tu8 tclass;\n};\n\n \nstruct ipv6_pinfo {\n\tstruct in6_addr \tsaddr;\n\tstruct in6_pktinfo\tsticky_pktinfo;\n\tconst struct in6_addr\t\t*daddr_cache;\n#ifdef CONFIG_IPV6_SUBTREES\n\tconst struct in6_addr\t\t*saddr_cache;\n#endif\n\n\t__be32\t\t\tflow_label;\n\t__u32\t\t\tfrag_size;\n\n\t \n#if defined(__BIG_ENDIAN_BITFIELD)\n\t__s16\t\t\thop_limit:9;\n\t__u16\t\t\t__unused_1:7;\n#else\n\t__u16\t\t\t__unused_1:7;\n\t__s16\t\t\thop_limit:9;\n#endif\n\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t \n\t__s16\t\t\tmcast_hops:9;\n\t__u16\t\t\t__unused_2:6,\n\t\t\t\tmc_loop:1;\n#else\n\t__u16\t\t\tmc_loop:1,\n\t\t\t\t__unused_2:6;\n\t__s16\t\t\tmcast_hops:9;\n#endif\n\tint\t\t\tucast_oif;\n\tint\t\t\tmcast_oif;\n\n\t \n\tunion {\n\t\tstruct {\n\t\t\t__u16\tsrcrt:1,\n\t\t\t\tosrcrt:1,\n\t\t\t        rxinfo:1,\n\t\t\t        rxoinfo:1,\n\t\t\t\trxhlim:1,\n\t\t\t\trxohlim:1,\n\t\t\t\thopopts:1,\n\t\t\t\tohopopts:1,\n\t\t\t\tdstopts:1,\n\t\t\t\todstopts:1,\n                                rxflow:1,\n\t\t\t\trxtclass:1,\n\t\t\t\trxpmtu:1,\n\t\t\t\trxorigdstaddr:1,\n\t\t\t\trecvfragsize:1;\n\t\t\t\t \n\t\t} bits;\n\t\t__u16\t\tall;\n\t} rxopt;\n\n\t \n\t__u16\t\t\trecverr:1,\n\t                        sndflow:1,\n\t\t\t\trepflow:1,\n\t\t\t\tpmtudisc:3,\n\t\t\t\tpadding:1,\t \n\t\t\t\tsrcprefs:3,\t \n\t\t\t\tdontfrag:1,\n\t\t\t\tautoflowlabel:1,\n\t\t\t\tautoflowlabel_set:1,\n\t\t\t\tmc_all:1,\n\t\t\t\trecverr_rfc4884:1,\n\t\t\t\trtalert_isolate:1;\n\t__u8\t\t\tmin_hopcount;\n\t__u8\t\t\ttclass;\n\t__be32\t\t\trcv_flowinfo;\n\n\t__u32\t\t\tdst_cookie;\n\n\tstruct ipv6_mc_socklist\t__rcu *ipv6_mc_list;\n\tstruct ipv6_ac_socklist\t*ipv6_ac_list;\n\tstruct ipv6_fl_socklist __rcu *ipv6_fl_list;\n\n\tstruct ipv6_txoptions __rcu\t*opt;\n\tstruct sk_buff\t\t*pktoptions;\n\tstruct sk_buff\t\t*rxpmtu;\n\tstruct inet6_cork\tcork;\n};\n\n \nstruct raw6_sock {\n\t \n\tstruct inet_sock\tinet;\n\t__u32\t\t\tchecksum;\t \n\t__u32\t\t\toffset;\t\t \n\tstruct icmp6_filter\tfilter;\n\t__u32\t\t\tip6mr_table;\n\n\tstruct ipv6_pinfo\tinet6;\n};\n\nstruct udp6_sock {\n\tstruct udp_sock\t  udp;\n\n\tstruct ipv6_pinfo inet6;\n};\n\nstruct tcp6_sock {\n\tstruct tcp_sock\t  tcp;\n\n\tstruct ipv6_pinfo inet6;\n};\n\nextern int inet6_sk_rebuild_header(struct sock *sk);\n\nstruct tcp6_timewait_sock {\n\tstruct tcp_timewait_sock   tcp6tw_tcp;\n};\n\n#if IS_ENABLED(CONFIG_IPV6)\nbool ipv6_mod_enabled(void);\n\nstatic inline struct ipv6_pinfo *inet6_sk(const struct sock *__sk)\n{\n\treturn sk_fullsock(__sk) ? inet_sk(__sk)->pinet6 : NULL;\n}\n\n#define raw6_sk(ptr) container_of_const(ptr, struct raw6_sock, inet.sk)\n\n#define ipv6_only_sock(sk)\t(sk->sk_ipv6only)\n#define ipv6_sk_rxinfo(sk)\t((sk)->sk_family == PF_INET6 && \\\n\t\t\t\t inet6_sk(sk)->rxopt.bits.rxinfo)\n\nstatic inline const struct in6_addr *inet6_rcv_saddr(const struct sock *sk)\n{\n\tif (sk->sk_family == AF_INET6)\n\t\treturn &sk->sk_v6_rcv_saddr;\n\treturn NULL;\n}\n\nstatic inline int inet_v6_ipv6only(const struct sock *sk)\n{\n\t \n\treturn ipv6_only_sock(sk);\n}\n#else\n#define ipv6_only_sock(sk)\t0\n#define ipv6_sk_rxinfo(sk)\t0\n\nstatic inline bool ipv6_mod_enabled(void)\n{\n\treturn false;\n}\n\nstatic inline struct ipv6_pinfo * inet6_sk(const struct sock *__sk)\n{\n\treturn NULL;\n}\n\nstatic inline struct raw6_sock *raw6_sk(const struct sock *sk)\n{\n\treturn NULL;\n}\n\n#define inet6_rcv_saddr(__sk)\tNULL\n#define inet_v6_ipv6only(__sk)\t\t0\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}