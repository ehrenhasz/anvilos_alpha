{
  "module_name": "mISDNif.h",
  "hash_id": "12e7c6263b1b36f1b734036e5557f9060110d0edd0ed915b64ec296f87a55d0a",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/mISDNif.h",
  "human_readable_source": " \n\n#ifndef mISDNIF_H\n#define mISDNIF_H\n\n#include <linux/types.h>\n#include <linux/errno.h>\n#include <linux/socket.h>\n\n \n#define\tMISDN_MAJOR_VERSION\t1\n#define\tMISDN_MINOR_VERSION\t1\n#define MISDN_RELEASE\t\t29\n\n \n\n#define MISDN_CMDMASK\t\t0xff00\n#define MISDN_LAYERMASK\t\t0x00ff\n\n \n#define OPEN_CHANNEL\t\t0x0100\n#define CLOSE_CHANNEL\t\t0x0200\n#define CONTROL_CHANNEL\t\t0x0300\n#define CHECK_DATA\t\t0x0400\n\n \n#define PH_ACTIVATE_REQ\t\t0x0101\n#define PH_DEACTIVATE_REQ\t0x0201\n#define PH_DATA_REQ\t\t0x2001\n#define MPH_ACTIVATE_REQ\t0x0501\n#define MPH_DEACTIVATE_REQ\t0x0601\n#define MPH_INFORMATION_REQ\t0x0701\n#define PH_CONTROL_REQ\t\t0x0801\n\n \n#define PH_ACTIVATE_IND\t\t0x0102\n#define PH_ACTIVATE_CNF\t\t0x4102\n#define PH_DEACTIVATE_IND\t0x0202\n#define PH_DEACTIVATE_CNF\t0x4202\n#define PH_DATA_IND\t\t0x2002\n#define PH_DATA_E_IND\t\t0x3002\n#define MPH_ACTIVATE_IND\t0x0502\n#define MPH_DEACTIVATE_IND\t0x0602\n#define MPH_INFORMATION_IND\t0x0702\n#define PH_DATA_CNF\t\t0x6002\n#define PH_CONTROL_IND\t\t0x0802\n#define PH_CONTROL_CNF\t\t0x4802\n\n \n#define DL_ESTABLISH_REQ\t0x1004\n#define DL_RELEASE_REQ\t\t0x1104\n#define DL_DATA_REQ\t\t0x3004\n#define DL_UNITDATA_REQ\t\t0x3104\n#define DL_INFORMATION_REQ\t0x0004\n\n \n#define DL_ESTABLISH_IND\t0x1008\n#define DL_ESTABLISH_CNF\t0x5008\n#define DL_RELEASE_IND\t\t0x1108\n#define DL_RELEASE_CNF\t\t0x5108\n#define DL_DATA_IND\t\t0x3008\n#define DL_UNITDATA_IND\t\t0x3108\n#define DL_INFORMATION_IND\t0x0008\n\n \n#define MDL_ASSIGN_REQ\t\t0x1804\n#define MDL_ASSIGN_IND\t\t0x1904\n#define MDL_REMOVE_REQ\t\t0x1A04\n#define MDL_REMOVE_IND\t\t0x1B04\n#define MDL_STATUS_UP_IND\t0x1C04\n#define MDL_STATUS_DOWN_IND\t0x1D04\n#define MDL_STATUS_UI_IND\t0x1E04\n#define MDL_ERROR_IND\t\t0x1F04\n#define MDL_ERROR_RSP\t\t0x5F04\n\n \n#define DL_TIMER200_IND\t\t0x7004\n#define DL_TIMER203_IND\t\t0x7304\n#define DL_INTERN_MSG\t\t0x7804\n\n \n#define DL_INFO_L2_CONNECT\t0x0001\n#define DL_INFO_L2_REMOVED\t0x0002\n\n \n \n#define DTMF_TONE_VAL\t\t0x2000\n#define DTMF_TONE_MASK\t\t0x007F\n#define DTMF_TONE_START\t\t0x2100\n#define DTMF_TONE_STOP\t\t0x2200\n#define DTMF_HFC_COEF\t\t0x4000\n#define DSP_CONF_JOIN\t\t0x2403\n#define DSP_CONF_SPLIT\t\t0x2404\n#define DSP_RECEIVE_OFF\t\t0x2405\n#define DSP_RECEIVE_ON\t\t0x2406\n#define DSP_ECHO_ON\t\t0x2407\n#define DSP_ECHO_OFF\t\t0x2408\n#define DSP_MIX_ON\t\t0x2409\n#define DSP_MIX_OFF\t\t0x240a\n#define DSP_DELAY\t\t0x240b\n#define DSP_JITTER\t\t0x240c\n#define DSP_TXDATA_ON\t\t0x240d\n#define DSP_TXDATA_OFF\t\t0x240e\n#define DSP_TX_DEJITTER\t\t0x240f\n#define DSP_TX_DEJ_OFF\t\t0x2410\n#define DSP_TONE_PATT_ON\t0x2411\n#define DSP_TONE_PATT_OFF\t0x2412\n#define DSP_VOL_CHANGE_TX\t0x2413\n#define DSP_VOL_CHANGE_RX\t0x2414\n#define DSP_BF_ENABLE_KEY\t0x2415\n#define DSP_BF_DISABLE\t\t0x2416\n#define DSP_BF_ACCEPT\t\t0x2416\n#define DSP_BF_REJECT\t\t0x2417\n#define DSP_PIPELINE_CFG\t0x2418\n#define HFC_VOL_CHANGE_TX\t0x2601\n#define HFC_VOL_CHANGE_RX\t0x2602\n#define HFC_SPL_LOOP_ON\t\t0x2603\n#define HFC_SPL_LOOP_OFF\t0x2604\n \n#define HW_MOD_FRM\t\t0x4000\n#define HW_MOD_FRH\t\t0x4001\n#define HW_MOD_FTM\t\t0x4002\n#define HW_MOD_FTH\t\t0x4003\n#define HW_MOD_FTS\t\t0x4004\n#define HW_MOD_CONNECT\t\t0x4010\n#define HW_MOD_OK\t\t0x4011\n#define HW_MOD_NOCARR\t\t0x4012\n#define HW_MOD_FCERROR\t\t0x4013\n#define HW_MOD_READY\t\t0x4014\n#define HW_MOD_LASTDATA\t\t0x4015\n\n \n#define TONE_OFF\t\t\t0x0000\n#define TONE_GERMAN_DIALTONE\t\t0x0001\n#define TONE_GERMAN_OLDDIALTONE\t\t0x0002\n#define TONE_AMERICAN_DIALTONE\t\t0x0003\n#define TONE_GERMAN_DIALPBX\t\t0x0004\n#define TONE_GERMAN_OLDDIALPBX\t\t0x0005\n#define TONE_AMERICAN_DIALPBX\t\t0x0006\n#define TONE_GERMAN_RINGING\t\t0x0007\n#define TONE_GERMAN_OLDRINGING\t\t0x0008\n#define TONE_AMERICAN_RINGPBX\t\t0x000b\n#define TONE_GERMAN_RINGPBX\t\t0x000c\n#define TONE_GERMAN_OLDRINGPBX\t\t0x000d\n#define TONE_AMERICAN_RINGING\t\t0x000e\n#define TONE_GERMAN_BUSY\t\t0x000f\n#define TONE_GERMAN_OLDBUSY\t\t0x0010\n#define TONE_AMERICAN_BUSY\t\t0x0011\n#define TONE_GERMAN_HANGUP\t\t0x0012\n#define TONE_GERMAN_OLDHANGUP\t\t0x0013\n#define TONE_AMERICAN_HANGUP\t\t0x0014\n#define TONE_SPECIAL_INFO\t\t0x0015\n#define TONE_GERMAN_GASSENBESETZT\t0x0016\n#define TONE_GERMAN_AUFSCHALTTON\t0x0016\n\n \n#define L1_SIGNAL_LOS_OFF\t0x0010\n#define L1_SIGNAL_LOS_ON\t0x0011\n#define L1_SIGNAL_AIS_OFF\t0x0012\n#define L1_SIGNAL_AIS_ON\t0x0013\n#define L1_SIGNAL_RDI_OFF\t0x0014\n#define L1_SIGNAL_RDI_ON\t0x0015\n#define L1_SIGNAL_SLIP_RX\t0x0020\n#define L1_SIGNAL_SLIP_TX\t0x0021\n\n \n\n#define ISDN_P_NONE\t\t0\n#define ISDN_P_BASE\t\t0\n#define ISDN_P_TE_S0\t\t0x01\n#define ISDN_P_NT_S0  \t\t0x02\n#define ISDN_P_TE_E1\t\t0x03\n#define ISDN_P_NT_E1  \t\t0x04\n#define ISDN_P_TE_UP0\t\t0x05\n#define ISDN_P_NT_UP0\t\t0x06\n\n#define IS_ISDN_P_TE(p) ((p == ISDN_P_TE_S0) || (p == ISDN_P_TE_E1) || \\\n\t\t\t\t(p == ISDN_P_TE_UP0) || (p == ISDN_P_LAPD_TE))\n#define IS_ISDN_P_NT(p) ((p == ISDN_P_NT_S0) || (p == ISDN_P_NT_E1) || \\\n\t\t\t\t(p == ISDN_P_NT_UP0) || (p == ISDN_P_LAPD_NT))\n#define IS_ISDN_P_S0(p) ((p == ISDN_P_TE_S0) || (p == ISDN_P_NT_S0))\n#define IS_ISDN_P_E1(p) ((p == ISDN_P_TE_E1) || (p == ISDN_P_NT_E1))\n#define IS_ISDN_P_UP0(p) ((p == ISDN_P_TE_UP0) || (p == ISDN_P_NT_UP0))\n\n\n#define ISDN_P_LAPD_TE\t\t0x10\n#define\tISDN_P_LAPD_NT\t\t0x11\n\n#define ISDN_P_B_MASK\t\t0x1f\n#define ISDN_P_B_START\t\t0x20\n\n#define ISDN_P_B_RAW\t\t0x21\n#define ISDN_P_B_HDLC\t\t0x22\n#define ISDN_P_B_X75SLP\t\t0x23\n#define ISDN_P_B_L2DTMF\t\t0x24\n#define ISDN_P_B_L2DSP\t\t0x25\n#define ISDN_P_B_L2DSPHDLC\t0x26\n#define ISDN_P_B_T30_FAX\t0x27\n#define ISDN_P_B_MODEM_ASYNC\t0x28\n\n#define OPTION_L2_PMX\t\t1\n#define OPTION_L2_PTP\t\t2\n#define OPTION_L2_FIXEDTEI\t3\n#define OPTION_L2_CLEANUP\t4\n#define OPTION_L1_HOLD\t\t5\n\n \n#define MISDN_MAX_IDLEN\t\t20\n\nstruct mISDNhead {\n\tunsigned int\tprim;\n\tunsigned int\tid;\n}  __packed;\n\n#define MISDN_HEADER_LEN\tsizeof(struct mISDNhead)\n#define MAX_DATA_SIZE\t\t2048\n#define MAX_DATA_MEM\t\t(MAX_DATA_SIZE + MISDN_HEADER_LEN)\n#define MAX_DFRAME_LEN\t\t260\n\n#define MISDN_ID_ADDR_MASK\t0xFFFF\n#define MISDN_ID_TEI_MASK\t0xFF00\n#define MISDN_ID_SAPI_MASK\t0x00FF\n#define MISDN_ID_TEI_ANY\t0x7F00\n\n#define MISDN_ID_ANY\t\t0xFFFF\n#define MISDN_ID_NONE\t\t0xFFFE\n\n#define GROUP_TEI\t\t127\n#define TEI_SAPI\t\t63\n#define CTRL_SAPI\t\t0\n\n#define MISDN_MAX_CHANNEL\t127\n#define MISDN_CHMAP_SIZE\t((MISDN_MAX_CHANNEL + 1) >> 3)\n\n#define SOL_MISDN\t0\n\nstruct sockaddr_mISDN {\n\tsa_family_t    family;\n\tunsigned char\tdev;\n\tunsigned char\tchannel;\n\tunsigned char\tsapi;\n\tunsigned char\ttei;\n};\n\nstruct mISDNversion {\n\tunsigned char\tmajor;\n\tunsigned char\tminor;\n\tunsigned short\trelease;\n};\n\nstruct mISDN_devinfo {\n\tu_int\t\t\tid;\n\tu_int\t\t\tDprotocols;\n\tu_int\t\t\tBprotocols;\n\tu_int\t\t\tprotocol;\n\tu_char\t\t\tchannelmap[MISDN_CHMAP_SIZE];\n\tu_int\t\t\tnrbchan;\n\tchar\t\t\tname[MISDN_MAX_IDLEN];\n};\n\nstruct mISDN_devrename {\n\tu_int\t\t\tid;\n\tchar\t\t\tname[MISDN_MAX_IDLEN];  \n};\n\n \nstruct ph_info_ch {\n\t__u32 protocol;\n\t__u64 Flags;\n};\n\nstruct ph_info_dch {\n\tstruct ph_info_ch ch;\n\t__u16 state;\n\t__u16 num_bch;\n};\n\nstruct ph_info {\n\tstruct ph_info_dch dch;\n\tstruct ph_info_ch  bch[];\n};\n\n \n#define IMADDTIMER\t_IOR('I', 64, int)\n#define IMDELTIMER\t_IOR('I', 65, int)\n\n \n#define\tIMGETVERSION\t_IOR('I', 66, int)\n#define\tIMGETCOUNT\t_IOR('I', 67, int)\n#define IMGETDEVINFO\t_IOR('I', 68, int)\n#define IMCTRLREQ\t_IOR('I', 69, int)\n#define IMCLEAR_L2\t_IOR('I', 70, int)\n#define IMSETDEVNAME\t_IOR('I', 71, struct mISDN_devrename)\n#define IMHOLD_L1\t_IOR('I', 72, int)\n\nstatic inline int\ntest_channelmap(u_int nr, u_char *map)\n{\n\tif (nr <= MISDN_MAX_CHANNEL)\n\t\treturn map[nr >> 3] & (1 << (nr & 7));\n\telse\n\t\treturn 0;\n}\n\nstatic inline void\nset_channelmap(u_int nr, u_char *map)\n{\n\tmap[nr >> 3] |= (1 << (nr & 7));\n}\n\nstatic inline void\nclear_channelmap(u_int nr, u_char *map)\n{\n\tmap[nr >> 3] &= ~(1 << (nr & 7));\n}\n\n \n#define MISDN_CTRL_GETOP\t\t0x0000\n#define MISDN_CTRL_LOOP\t\t\t0x0001\n#define MISDN_CTRL_CONNECT\t\t0x0002\n#define MISDN_CTRL_DISCONNECT\t\t0x0004\n#define MISDN_CTRL_RX_BUFFER\t\t0x0008\n#define MISDN_CTRL_PCMCONNECT\t\t0x0010\n#define MISDN_CTRL_PCMDISCONNECT\t0x0020\n#define MISDN_CTRL_SETPEER\t\t0x0040\n#define MISDN_CTRL_UNSETPEER\t\t0x0080\n#define MISDN_CTRL_RX_OFF\t\t0x0100\n#define MISDN_CTRL_FILL_EMPTY\t\t0x0200\n#define MISDN_CTRL_GETPEER\t\t0x0400\n#define MISDN_CTRL_L1_TIMER3\t\t0x0800\n#define MISDN_CTRL_HW_FEATURES_OP\t0x2000\n#define MISDN_CTRL_HW_FEATURES\t\t0x2001\n#define MISDN_CTRL_HFC_OP\t\t0x4000\n#define MISDN_CTRL_HFC_PCM_CONN\t\t0x4001\n#define MISDN_CTRL_HFC_PCM_DISC\t\t0x4002\n#define MISDN_CTRL_HFC_CONF_JOIN\t0x4003\n#define MISDN_CTRL_HFC_CONF_SPLIT\t0x4004\n#define MISDN_CTRL_HFC_RECEIVE_OFF\t0x4005\n#define MISDN_CTRL_HFC_RECEIVE_ON\t0x4006\n#define MISDN_CTRL_HFC_ECHOCAN_ON \t0x4007\n#define MISDN_CTRL_HFC_ECHOCAN_OFF \t0x4008\n#define MISDN_CTRL_HFC_WD_INIT\t\t0x4009\n#define MISDN_CTRL_HFC_WD_RESET\t\t0x400A\n\n \n#define MISDN_CTRL_RX_SIZE_IGNORE\t-1\n\n \n#define MISDN_TIME_STAMP\t\t0x0001\n\nstruct mISDN_ctrl_req {\n\tint\t\top;\n\tint\t\tchannel;\n\tint\t\tp1;\n\tint\t\tp2;\n};\n\n \n#define MISDN_OPT_ALL\t\t1\n#define MISDN_OPT_TEIMGR\t2\n\n#ifdef __KERNEL__\n#include <linux/list.h>\n#include <linux/skbuff.h>\n#include <linux/net.h>\n#include <net/sock.h>\n#include <linux/completion.h>\n\n#define DEBUG_CORE\t\t0x000000ff\n#define DEBUG_CORE_FUNC\t\t0x00000002\n#define DEBUG_SOCKET\t\t0x00000004\n#define DEBUG_MANAGER\t\t0x00000008\n#define DEBUG_SEND_ERR\t\t0x00000010\n#define DEBUG_MSG_THREAD\t0x00000020\n#define DEBUG_QUEUE_FUNC\t0x00000040\n#define DEBUG_L1\t\t0x0000ff00\n#define DEBUG_L1_FSM\t\t0x00000200\n#define DEBUG_L2\t\t0x00ff0000\n#define DEBUG_L2_FSM\t\t0x00020000\n#define DEBUG_L2_CTRL\t\t0x00040000\n#define DEBUG_L2_RECV\t\t0x00080000\n#define DEBUG_L2_TEI\t\t0x00100000\n#define DEBUG_L2_TEIFSM\t\t0x00200000\n#define DEBUG_TIMER\t\t0x01000000\n#define DEBUG_CLOCK\t\t0x02000000\n\n#define mISDN_HEAD_P(s)\t\t((struct mISDNhead *)&s->cb[0])\n#define mISDN_HEAD_PRIM(s)\t(((struct mISDNhead *)&s->cb[0])->prim)\n#define mISDN_HEAD_ID(s)\t(((struct mISDNhead *)&s->cb[0])->id)\n\n \n#define MISDN_OPEN\t1\n#define MISDN_BOUND\t2\n#define MISDN_CLOSED\t3\n\nstruct mISDNchannel;\nstruct mISDNdevice;\nstruct mISDNstack;\nstruct mISDNclock;\n\nstruct channel_req {\n\tu_int\t\t\tprotocol;\n\tstruct sockaddr_mISDN\tadr;\n\tstruct mISDNchannel\t*ch;\n};\n\ntypedef\tint\t(ctrl_func_t)(struct mISDNchannel *, u_int, void *);\ntypedef\tint\t(send_func_t)(struct mISDNchannel *, struct sk_buff *);\ntypedef int\t(create_func_t)(struct channel_req *);\n\nstruct Bprotocol {\n\tstruct list_head\tlist;\n\tchar\t\t\t*name;\n\tu_int\t\t\tBprotocols;\n\tcreate_func_t\t\t*create;\n};\n\nstruct mISDNchannel {\n\tstruct list_head\tlist;\n\tu_int\t\t\tprotocol;\n\tu_int\t\t\tnr;\n\tu_long\t\t\topt;\n\tu_int\t\t\taddr;\n\tstruct mISDNstack\t*st;\n\tstruct mISDNchannel\t*peer;\n\tsend_func_t\t\t*send;\n\tsend_func_t\t\t*recv;\n\tctrl_func_t\t\t*ctrl;\n};\n\nstruct mISDN_sock_list {\n\tstruct hlist_head\thead;\n\trwlock_t\t\tlock;\n};\n\nstruct mISDN_sock {\n\tstruct sock\t\tsk;\n\tstruct mISDNchannel\tch;\n\tu_int\t\t\tcmask;\n\tstruct mISDNdevice\t*dev;\n};\n\n\n\nstruct mISDNdevice {\n\tstruct mISDNchannel\tD;\n\tu_int\t\t\tid;\n\tu_int\t\t\tDprotocols;\n\tu_int\t\t\tBprotocols;\n\tu_int\t\t\tnrbchan;\n\tu_char\t\t\tchannelmap[MISDN_CHMAP_SIZE];\n\tstruct list_head\tbchannels;\n\tstruct mISDNchannel\t*teimgr;\n\tstruct device\t\tdev;\n};\n\nstruct mISDNstack {\n\tu_long\t\t\tstatus;\n\tstruct mISDNdevice\t*dev;\n\tstruct task_struct\t*thread;\n\tstruct completion\t*notify;\n\twait_queue_head_t\tworkq;\n\tstruct sk_buff_head\tmsgq;\n\tstruct list_head\tlayer2;\n\tstruct mISDNchannel\t*layer1;\n\tstruct mISDNchannel\town;\n\tstruct mutex\t\tlmutex;  \n\tstruct mISDN_sock_list\tl1sock;\n#ifdef MISDN_MSG_STATS\n\tu_int\t\t\tmsg_cnt;\n\tu_int\t\t\tsleep_cnt;\n\tu_int\t\t\tstopped_cnt;\n#endif\n};\n\ntypedef\tint\t(clockctl_func_t)(void *, int);\n\nstruct\tmISDNclock {\n\tstruct list_head\tlist;\n\tchar\t\t\tname[64];\n\tint\t\t\tpri;\n\tclockctl_func_t\t\t*ctl;\n\tvoid\t\t\t*priv;\n};\n\n \n\nstatic inline struct sk_buff *\nmI_alloc_skb(unsigned int len, gfp_t gfp_mask)\n{\n\tstruct sk_buff\t*skb;\n\n\tskb = alloc_skb(len + MISDN_HEADER_LEN, gfp_mask);\n\tif (likely(skb))\n\t\tskb_reserve(skb, MISDN_HEADER_LEN);\n\treturn skb;\n}\n\nstatic inline struct sk_buff *\n_alloc_mISDN_skb(u_int prim, u_int id, u_int len, void *dp, gfp_t gfp_mask)\n{\n\tstruct sk_buff\t*skb = mI_alloc_skb(len, gfp_mask);\n\tstruct mISDNhead *hh;\n\n\tif (!skb)\n\t\treturn NULL;\n\tif (len)\n\t\tskb_put_data(skb, dp, len);\n\thh = mISDN_HEAD_P(skb);\n\thh->prim = prim;\n\thh->id = id;\n\treturn skb;\n}\n\nstatic inline void\n_queue_data(struct mISDNchannel *ch, u_int prim,\n    u_int id, u_int len, void *dp, gfp_t gfp_mask)\n{\n\tstruct sk_buff\t\t*skb;\n\n\tif (!ch->peer)\n\t\treturn;\n\tskb = _alloc_mISDN_skb(prim, id, len, dp, gfp_mask);\n\tif (!skb)\n\t\treturn;\n\tif (ch->recv(ch->peer, skb))\n\t\tdev_kfree_skb(skb);\n}\n\n \n\nextern int\tmISDN_register_device(struct mISDNdevice *,\n\t\t\t\t\tstruct device *parent, char *name);\nextern void\tmISDN_unregister_device(struct mISDNdevice *);\nextern int\tmISDN_register_Bprotocol(struct Bprotocol *);\nextern void\tmISDN_unregister_Bprotocol(struct Bprotocol *);\nextern struct mISDNclock *mISDN_register_clock(char *, int, clockctl_func_t *,\n\t\t\t\t\t\tvoid *);\nextern void\tmISDN_unregister_clock(struct mISDNclock *);\n\nstatic inline struct mISDNdevice *dev_to_mISDN(const struct device *dev)\n{\n\tif (dev)\n\t\treturn dev_get_drvdata(dev);\n\telse\n\t\treturn NULL;\n}\n\nextern void\tset_channel_address(struct mISDNchannel *, u_int, u_int);\nextern void\tmISDN_clock_update(struct mISDNclock *, int, ktime_t *);\nextern unsigned short mISDN_clock_get(void);\nextern const char *mISDNDevName4ch(struct mISDNchannel *);\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}