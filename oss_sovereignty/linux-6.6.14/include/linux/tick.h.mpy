{
  "module_name": "tick.h",
  "hash_id": "13c5ba446897b32193c53352f9d47773e4acfc249a15bf0d72f97958bf2c53f5",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/tick.h",
  "human_readable_source": " \n \n#ifndef _LINUX_TICK_H\n#define _LINUX_TICK_H\n\n#include <linux/clockchips.h>\n#include <linux/irqflags.h>\n#include <linux/percpu.h>\n#include <linux/context_tracking_state.h>\n#include <linux/cpumask.h>\n#include <linux/sched.h>\n#include <linux/rcupdate.h>\n\n#ifdef CONFIG_GENERIC_CLOCKEVENTS\nextern void __init tick_init(void);\n \nextern void tick_suspend_local(void);\n \nextern void tick_resume_local(void);\nextern void tick_handover_do_timer(void);\nextern void tick_cleanup_dead_cpu(int cpu);\n#else  \nstatic inline void tick_init(void) { }\nstatic inline void tick_suspend_local(void) { }\nstatic inline void tick_resume_local(void) { }\nstatic inline void tick_handover_do_timer(void) { }\nstatic inline void tick_cleanup_dead_cpu(int cpu) { }\n#endif  \n\n#if defined(CONFIG_GENERIC_CLOCKEVENTS) && defined(CONFIG_SUSPEND)\nextern void tick_freeze(void);\nextern void tick_unfreeze(void);\n#else\nstatic inline void tick_freeze(void) { }\nstatic inline void tick_unfreeze(void) { }\n#endif\n\n#ifdef CONFIG_TICK_ONESHOT\nextern void tick_irq_enter(void);\n#  ifndef arch_needs_cpu\n#   define arch_needs_cpu() (0)\n#  endif\n# else\nstatic inline void tick_irq_enter(void) { }\n#endif\n\n#if defined(CONFIG_GENERIC_CLOCKEVENTS_BROADCAST) && defined(CONFIG_TICK_ONESHOT)\nextern void hotplug_cpu__broadcast_tick_pull(int dead_cpu);\n#else\nstatic inline void hotplug_cpu__broadcast_tick_pull(int dead_cpu) { }\n#endif\n\nenum tick_broadcast_mode {\n\tTICK_BROADCAST_OFF,\n\tTICK_BROADCAST_ON,\n\tTICK_BROADCAST_FORCE,\n};\n\nenum tick_broadcast_state {\n\tTICK_BROADCAST_EXIT,\n\tTICK_BROADCAST_ENTER,\n};\n\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\nextern void tick_broadcast_control(enum tick_broadcast_mode mode);\n#else\nstatic inline void tick_broadcast_control(enum tick_broadcast_mode mode) { }\n#endif  \n\n#if defined(CONFIG_GENERIC_CLOCKEVENTS_BROADCAST) && defined(CONFIG_HOTPLUG_CPU)\nextern void tick_offline_cpu(unsigned int cpu);\n#else\nstatic inline void tick_offline_cpu(unsigned int cpu) { }\n#endif\n\n#ifdef CONFIG_GENERIC_CLOCKEVENTS\nextern int tick_broadcast_oneshot_control(enum tick_broadcast_state state);\n#else\nstatic inline int tick_broadcast_oneshot_control(enum tick_broadcast_state state)\n{\n\treturn 0;\n}\n#endif\n\nstatic inline void tick_broadcast_enable(void)\n{\n\ttick_broadcast_control(TICK_BROADCAST_ON);\n}\nstatic inline void tick_broadcast_disable(void)\n{\n\ttick_broadcast_control(TICK_BROADCAST_OFF);\n}\nstatic inline void tick_broadcast_force(void)\n{\n\ttick_broadcast_control(TICK_BROADCAST_FORCE);\n}\nstatic inline int tick_broadcast_enter(void)\n{\n\treturn tick_broadcast_oneshot_control(TICK_BROADCAST_ENTER);\n}\nstatic inline void tick_broadcast_exit(void)\n{\n\ttick_broadcast_oneshot_control(TICK_BROADCAST_EXIT);\n}\n\nenum tick_dep_bits {\n\tTICK_DEP_BIT_POSIX_TIMER\t= 0,\n\tTICK_DEP_BIT_PERF_EVENTS\t= 1,\n\tTICK_DEP_BIT_SCHED\t\t= 2,\n\tTICK_DEP_BIT_CLOCK_UNSTABLE\t= 3,\n\tTICK_DEP_BIT_RCU\t\t= 4,\n\tTICK_DEP_BIT_RCU_EXP\t\t= 5\n};\n#define TICK_DEP_BIT_MAX TICK_DEP_BIT_RCU_EXP\n\n#define TICK_DEP_MASK_NONE\t\t0\n#define TICK_DEP_MASK_POSIX_TIMER\t(1 << TICK_DEP_BIT_POSIX_TIMER)\n#define TICK_DEP_MASK_PERF_EVENTS\t(1 << TICK_DEP_BIT_PERF_EVENTS)\n#define TICK_DEP_MASK_SCHED\t\t(1 << TICK_DEP_BIT_SCHED)\n#define TICK_DEP_MASK_CLOCK_UNSTABLE\t(1 << TICK_DEP_BIT_CLOCK_UNSTABLE)\n#define TICK_DEP_MASK_RCU\t\t(1 << TICK_DEP_BIT_RCU)\n#define TICK_DEP_MASK_RCU_EXP\t\t(1 << TICK_DEP_BIT_RCU_EXP)\n\n#ifdef CONFIG_NO_HZ_COMMON\nextern bool tick_nohz_enabled;\nextern bool tick_nohz_tick_stopped(void);\nextern bool tick_nohz_tick_stopped_cpu(int cpu);\nextern void tick_nohz_idle_stop_tick(void);\nextern void tick_nohz_idle_retain_tick(void);\nextern void tick_nohz_idle_restart_tick(void);\nextern void tick_nohz_idle_enter(void);\nextern void tick_nohz_idle_exit(void);\nextern void tick_nohz_irq_exit(void);\nextern bool tick_nohz_idle_got_tick(void);\nextern ktime_t tick_nohz_get_next_hrtimer(void);\nextern ktime_t tick_nohz_get_sleep_length(ktime_t *delta_next);\nextern unsigned long tick_nohz_get_idle_calls(void);\nextern unsigned long tick_nohz_get_idle_calls_cpu(int cpu);\nextern u64 get_cpu_idle_time_us(int cpu, u64 *last_update_time);\nextern u64 get_cpu_iowait_time_us(int cpu, u64 *last_update_time);\n\nstatic inline void tick_nohz_idle_stop_tick_protected(void)\n{\n\tlocal_irq_disable();\n\ttick_nohz_idle_stop_tick();\n\tlocal_irq_enable();\n}\n\n#else  \n#define tick_nohz_enabled (0)\nstatic inline int tick_nohz_tick_stopped(void) { return 0; }\nstatic inline int tick_nohz_tick_stopped_cpu(int cpu) { return 0; }\nstatic inline void tick_nohz_idle_stop_tick(void) { }\nstatic inline void tick_nohz_idle_retain_tick(void) { }\nstatic inline void tick_nohz_idle_restart_tick(void) { }\nstatic inline void tick_nohz_idle_enter(void) { }\nstatic inline void tick_nohz_idle_exit(void) { }\nstatic inline bool tick_nohz_idle_got_tick(void) { return false; }\nstatic inline ktime_t tick_nohz_get_next_hrtimer(void)\n{\n\t \n\treturn ktime_add(ktime_get(), TICK_NSEC);\n}\nstatic inline ktime_t tick_nohz_get_sleep_length(ktime_t *delta_next)\n{\n\t*delta_next = TICK_NSEC;\n\treturn *delta_next;\n}\nstatic inline u64 get_cpu_idle_time_us(int cpu, u64 *unused) { return -1; }\nstatic inline u64 get_cpu_iowait_time_us(int cpu, u64 *unused) { return -1; }\n\nstatic inline void tick_nohz_idle_stop_tick_protected(void) { }\n#endif  \n\n#ifdef CONFIG_NO_HZ_FULL\nextern bool tick_nohz_full_running;\nextern cpumask_var_t tick_nohz_full_mask;\n\nstatic inline bool tick_nohz_full_enabled(void)\n{\n\tif (!context_tracking_enabled())\n\t\treturn false;\n\n\treturn tick_nohz_full_running;\n}\n\n \n#define tick_nohz_full_cpu(_cpu) ({\t\t\t\t\t\\\n\tbool __ret = false;\t\t\t\t\t\t\\\n\tif (tick_nohz_full_enabled())\t\t\t\t\t\\\n\t\t__ret = cpumask_test_cpu((_cpu), tick_nohz_full_mask);\t\\\n\t__ret;\t\t\t\t\t\t\t\t\\\n})\n\nstatic inline void tick_nohz_full_add_cpus_to(struct cpumask *mask)\n{\n\tif (tick_nohz_full_enabled())\n\t\tcpumask_or(mask, mask, tick_nohz_full_mask);\n}\n\nextern void tick_nohz_dep_set(enum tick_dep_bits bit);\nextern void tick_nohz_dep_clear(enum tick_dep_bits bit);\nextern void tick_nohz_dep_set_cpu(int cpu, enum tick_dep_bits bit);\nextern void tick_nohz_dep_clear_cpu(int cpu, enum tick_dep_bits bit);\nextern void tick_nohz_dep_set_task(struct task_struct *tsk,\n\t\t\t\t   enum tick_dep_bits bit);\nextern void tick_nohz_dep_clear_task(struct task_struct *tsk,\n\t\t\t\t     enum tick_dep_bits bit);\nextern void tick_nohz_dep_set_signal(struct task_struct *tsk,\n\t\t\t\t     enum tick_dep_bits bit);\nextern void tick_nohz_dep_clear_signal(struct signal_struct *signal,\n\t\t\t\t       enum tick_dep_bits bit);\nextern bool tick_nohz_cpu_hotpluggable(unsigned int cpu);\n\n \nstatic inline void tick_dep_set(enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_set(bit);\n}\n\nstatic inline void tick_dep_clear(enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_clear(bit);\n}\n\nstatic inline void tick_dep_set_cpu(int cpu, enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_cpu(cpu))\n\t\ttick_nohz_dep_set_cpu(cpu, bit);\n}\n\nstatic inline void tick_dep_clear_cpu(int cpu, enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_cpu(cpu))\n\t\ttick_nohz_dep_clear_cpu(cpu, bit);\n}\n\nstatic inline void tick_dep_set_task(struct task_struct *tsk,\n\t\t\t\t     enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_set_task(tsk, bit);\n}\nstatic inline void tick_dep_clear_task(struct task_struct *tsk,\n\t\t\t\t       enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_clear_task(tsk, bit);\n}\nstatic inline void tick_dep_set_signal(struct task_struct *tsk,\n\t\t\t\t       enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_set_signal(tsk, bit);\n}\nstatic inline void tick_dep_clear_signal(struct signal_struct *signal,\n\t\t\t\t\t enum tick_dep_bits bit)\n{\n\tif (tick_nohz_full_enabled())\n\t\ttick_nohz_dep_clear_signal(signal, bit);\n}\n\nextern void tick_nohz_full_kick_cpu(int cpu);\nextern void __tick_nohz_task_switch(void);\nextern void __init tick_nohz_full_setup(cpumask_var_t cpumask);\n#else\nstatic inline bool tick_nohz_full_enabled(void) { return false; }\nstatic inline bool tick_nohz_full_cpu(int cpu) { return false; }\nstatic inline void tick_nohz_full_add_cpus_to(struct cpumask *mask) { }\n\nstatic inline void tick_nohz_dep_set_cpu(int cpu, enum tick_dep_bits bit) { }\nstatic inline void tick_nohz_dep_clear_cpu(int cpu, enum tick_dep_bits bit) { }\nstatic inline bool tick_nohz_cpu_hotpluggable(unsigned int cpu) { return true; }\n\nstatic inline void tick_dep_set(enum tick_dep_bits bit) { }\nstatic inline void tick_dep_clear(enum tick_dep_bits bit) { }\nstatic inline void tick_dep_set_cpu(int cpu, enum tick_dep_bits bit) { }\nstatic inline void tick_dep_clear_cpu(int cpu, enum tick_dep_bits bit) { }\nstatic inline void tick_dep_set_task(struct task_struct *tsk,\n\t\t\t\t     enum tick_dep_bits bit) { }\nstatic inline void tick_dep_clear_task(struct task_struct *tsk,\n\t\t\t\t       enum tick_dep_bits bit) { }\nstatic inline void tick_dep_set_signal(struct task_struct *tsk,\n\t\t\t\t       enum tick_dep_bits bit) { }\nstatic inline void tick_dep_clear_signal(struct signal_struct *signal,\n\t\t\t\t\t enum tick_dep_bits bit) { }\n\nstatic inline void tick_nohz_full_kick_cpu(int cpu) { }\nstatic inline void __tick_nohz_task_switch(void) { }\nstatic inline void tick_nohz_full_setup(cpumask_var_t cpumask) { }\n#endif\n\nstatic inline void tick_nohz_task_switch(void)\n{\n\tif (tick_nohz_full_enabled())\n\t\t__tick_nohz_task_switch();\n}\n\nstatic inline void tick_nohz_user_enter_prepare(void)\n{\n\tif (tick_nohz_full_cpu(smp_processor_id()))\n\t\trcu_nocb_flush_deferred_wakeup();\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}