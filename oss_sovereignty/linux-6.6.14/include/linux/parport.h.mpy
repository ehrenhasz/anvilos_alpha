{
  "module_name": "parport.h",
  "hash_id": "834ff4e6607c67451dac3984b408dd66b479169472858771e8143822f3b0cf52",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/parport.h",
  "human_readable_source": " \n#ifndef _PARPORT_H_\n#define _PARPORT_H_\n\n\n#include <linux/jiffies.h>\n#include <linux/proc_fs.h>\n#include <linux/spinlock.h>\n#include <linux/wait.h>\n#include <linux/irqreturn.h>\n#include <linux/semaphore.h>\n#include <linux/device.h>\n#include <asm/ptrace.h>\n#include <uapi/linux/parport.h>\n\n \nstruct parport;\nstruct pardevice;\n\nstruct pc_parport_state {\n\tunsigned int ctr;\n\tunsigned int ecr;\n};\n\nstruct ax_parport_state {\n\tunsigned int ctr;\n\tunsigned int ecr;\n\tunsigned int dcsr;\n};\n\n \nstruct amiga_parport_state {\n       unsigned char data;      \n       unsigned char datadir;   \n       unsigned char status;    \n       unsigned char statusdir; \n};\n\nstruct ip32_parport_state {\n\tunsigned int dcr;\n\tunsigned int ecr;\n};\n\nstruct parport_state {\n\tunion {\n\t\tstruct pc_parport_state pc;\n\t\t \n\t\tstruct ax_parport_state ax;\n\t\tstruct amiga_parport_state amiga;\n\t\t \n\t\tstruct ip32_parport_state ip32;\n\t\tvoid *misc; \n\t} u;\n};\n\nstruct parport_operations {\n\t \n\tvoid (*write_data)(struct parport *, unsigned char);\n\tunsigned char (*read_data)(struct parport *);\n\n\tvoid (*write_control)(struct parport *, unsigned char);\n\tunsigned char (*read_control)(struct parport *);\n\tunsigned char (*frob_control)(struct parport *, unsigned char mask,\n\t\t\t\t      unsigned char val);\n\n\tunsigned char (*read_status)(struct parport *);\n\n\t \n\tvoid (*enable_irq)(struct parport *);\n\tvoid (*disable_irq)(struct parport *);\n\n\t \n\tvoid (*data_forward) (struct parport *);\n\tvoid (*data_reverse) (struct parport *);\n\n\t \n\tvoid (*init_state)(struct pardevice *, struct parport_state *);\n\tvoid (*save_state)(struct parport *, struct parport_state *);\n\tvoid (*restore_state)(struct parport *, struct parport_state *);\n\n\t \n\tsize_t (*epp_write_data) (struct parport *port, const void *buf,\n\t\t\t\t  size_t len, int flags);\n\tsize_t (*epp_read_data) (struct parport *port, void *buf, size_t len,\n\t\t\t\t int flags);\n\tsize_t (*epp_write_addr) (struct parport *port, const void *buf,\n\t\t\t\t  size_t len, int flags);\n\tsize_t (*epp_read_addr) (struct parport *port, void *buf, size_t len,\n\t\t\t\t int flags);\n\n\tsize_t (*ecp_write_data) (struct parport *port, const void *buf,\n\t\t\t\t  size_t len, int flags);\n\tsize_t (*ecp_read_data) (struct parport *port, void *buf, size_t len,\n\t\t\t\t int flags);\n\tsize_t (*ecp_write_addr) (struct parport *port, const void *buf,\n\t\t\t\t  size_t len, int flags);\n\n\tsize_t (*compat_write_data) (struct parport *port, const void *buf,\n\t\t\t\t     size_t len, int flags);\n\tsize_t (*nibble_read_data) (struct parport *port, void *buf,\n\t\t\t\t    size_t len, int flags);\n\tsize_t (*byte_read_data) (struct parport *port, void *buf,\n\t\t\t\t  size_t len, int flags);\n\tstruct module *owner;\n};\n\nstruct parport_device_info {\n\tparport_device_class class;\n\tconst char *class_name;\n\tconst char *mfr;\n\tconst char *model;\n\tconst char *cmdset;\n\tconst char *description;\n};\n\n \n\n \nstruct pardevice {\n\tconst char *name;\n\tstruct parport *port;\n\tint daisy;\n\tint (*preempt)(void *);\n\tvoid (*wakeup)(void *);\n\tvoid *private;\n\tvoid (*irq_func)(void *);\n\tunsigned int flags;\n\tstruct pardevice *next;\n\tstruct pardevice *prev;\n\tstruct device dev;\n\tbool devmodel;\n\tstruct parport_state *state;      \n\twait_queue_head_t wait_q;\n\tunsigned long int time;\n\tunsigned long int timeslice;\n\tvolatile long int timeout;\n\tunsigned long waiting;\t\t  \n\tstruct pardevice *waitprev;\n\tstruct pardevice *waitnext;\n\tvoid * sysctl_table;\n};\n\n#define to_pardevice(n) container_of(n, struct pardevice, dev)\n\n \n\n \nenum ieee1284_phase {\n\tIEEE1284_PH_FWD_DATA,\n\tIEEE1284_PH_FWD_IDLE,\n\tIEEE1284_PH_TERMINATE,\n\tIEEE1284_PH_NEGOTIATION,\n\tIEEE1284_PH_HBUSY_DNA,\n\tIEEE1284_PH_REV_IDLE,\n\tIEEE1284_PH_HBUSY_DAVAIL,\n\tIEEE1284_PH_REV_DATA,\n\tIEEE1284_PH_ECP_SETUP,\n\tIEEE1284_PH_ECP_FWD_TO_REV,\n\tIEEE1284_PH_ECP_REV_TO_FWD,\n\tIEEE1284_PH_ECP_DIR_UNKNOWN,\n};\nstruct ieee1284_info {\n\tint mode;\n\tvolatile enum ieee1284_phase phase;\n\tstruct semaphore irq;\n};\n\n#define PARPORT_NAME_MAX_LEN 15\n\n \nstruct parport {\n\tunsigned long base;\t \n\tunsigned long base_hi;   \n\tunsigned int size;\t \n\tconst char *name;\n\tunsigned int modes;\n\tint irq;\t\t \n\tint dma;\n\tint muxport;\t\t \n\tint portnum;\t\t \n\tstruct device *dev;\t \n\tstruct device bus_dev;\t \n\tstruct parport *physport;\n\t\t\t\t \n\n\tstruct pardevice *devices;\n\tstruct pardevice *cad;\t \n\tint daisy;\t\t \n\tint muxsel;\t\t \n\n\tstruct pardevice *waithead;\n\tstruct pardevice *waittail;\n\n\tstruct list_head list;\n\tstruct timer_list timer;\n\tunsigned int flags;\n\n\tvoid *sysctl_table;\n\tstruct parport_device_info probe_info[5];  \n\tstruct ieee1284_info ieee1284;\n\n\tstruct parport_operations *ops;\n\tvoid *private_data;      \n\n\tint number;\t\t \n\tspinlock_t pardevice_lock;\n\tspinlock_t waitlist_lock;\n\trwlock_t cad_lock;\n\n\tint spintime;\n\tatomic_t ref_count;\n\n\tunsigned long devflags;\n#define PARPORT_DEVPROC_REGISTERED\t0\n\tstruct pardevice *proc_device;\t \n\n\tstruct list_head full_list;\n\tstruct parport *slaves[3];\n};\n\n#define to_parport_dev(n) container_of(n, struct parport, bus_dev)\n\n#define DEFAULT_SPIN_TIME 500  \n\nstruct parport_driver {\n\tconst char *name;\n\tvoid (*attach) (struct parport *);\n\tvoid (*detach) (struct parport *);\n\tvoid (*match_port)(struct parport *);\n\tint (*probe)(struct pardevice *);\n\tstruct device_driver driver;\n\tbool devmodel;\n\tstruct list_head list;\n};\n\n#define to_parport_driver(n) container_of(n, struct parport_driver, driver)\n\nint parport_bus_init(void);\nvoid parport_bus_exit(void);\n\n \nstruct parport *parport_register_port(unsigned long base, int irq, int dma,\n\t\t\t\t      struct parport_operations *ops);\n\n \nvoid parport_announce_port (struct parport *port);\n\n \nextern void parport_remove_port(struct parport *port);\n\n \n\nint __must_check __parport_register_driver(struct parport_driver *,\n\t\t\t\t\t   struct module *,\n\t\t\t\t\t   const char *mod_name);\n \n\n \n#define parport_register_driver(driver)             \\\n\t__parport_register_driver(driver, THIS_MODULE, KBUILD_MODNAME)\n\n \nvoid parport_unregister_driver(struct parport_driver *);\n\n \n#define module_parport_driver(__parport_driver) \\\n\tmodule_driver(__parport_driver, parport_register_driver, parport_unregister_driver)\n\n \nextern struct parport *parport_find_number (int);\nextern struct parport *parport_find_base (unsigned long);\n\n \nextern irqreturn_t parport_irq_handler(int irq, void *dev_id);\n\n \nextern struct parport *parport_get_port (struct parport *);\nextern void parport_put_port (struct parport *);\nvoid parport_del_port(struct parport *);\n\nstruct pardev_cb {\n\tint (*preempt)(void *);\n\tvoid (*wakeup)(void *);\n\tvoid *private;\n\tvoid (*irq_func)(void *);\n\tunsigned int flags;\n};\n\n \nstruct pardevice *\nparport_register_dev_model(struct parport *port, const char *name,\n\t\t\t   const struct pardev_cb *par_dev_cb, int cnt);\n\n \nextern void parport_unregister_device(struct pardevice *dev);\n\n \nextern int parport_claim(struct pardevice *dev);\n\n \nextern int parport_claim_or_block(struct pardevice *dev);\n\n \n\nextern void parport_release(struct pardevice *dev);\n\n \nstatic __inline__ int parport_yield(struct pardevice *dev)\n{\n\tunsigned long int timeslip = (jiffies - dev->time);\n\tif ((dev->port->waithead == NULL) || (timeslip < dev->timeslice))\n\t\treturn 0;\n\tparport_release(dev);\n\treturn parport_claim(dev);\n}\n\n \nstatic __inline__ int parport_yield_blocking(struct pardevice *dev)\n{\n\tunsigned long int timeslip = (jiffies - dev->time);\n\tif ((dev->port->waithead == NULL) || (timeslip < dev->timeslice))\n\t\treturn 0;\n\tparport_release(dev);\n\treturn parport_claim_or_block(dev);\n}\n\n \n#define PARPORT_DEV_TRAN\t\t0\t \n#define PARPORT_DEV_LURK\t\t(1<<0)\t \n#define PARPORT_DEV_EXCL\t\t(1<<1)\t \n\n#define PARPORT_FLAG_EXCL\t\t(1<<1)\t \n\n \nextern void parport_ieee1284_interrupt (void *);\nextern int parport_negotiate (struct parport *, int mode);\nextern ssize_t parport_write (struct parport *, const void *buf, size_t len);\nextern ssize_t parport_read (struct parport *, void *buf, size_t len);\n\n#define PARPORT_INACTIVITY_O_NONBLOCK 1\nextern long parport_set_timeout (struct pardevice *, long inactivity);\n\nextern int parport_wait_event (struct parport *, long timeout);\nextern int parport_wait_peripheral (struct parport *port,\n\t\t\t\t    unsigned char mask,\n\t\t\t\t    unsigned char val);\nextern int parport_poll_peripheral (struct parport *port,\n\t\t\t\t    unsigned char mask,\n\t\t\t\t    unsigned char val,\n\t\t\t\t    int usec);\n\n \nextern size_t parport_ieee1284_write_compat (struct parport *,\n\t\t\t\t\t     const void *, size_t, int);\nextern size_t parport_ieee1284_read_nibble (struct parport *,\n\t\t\t\t\t    void *, size_t, int);\nextern size_t parport_ieee1284_read_byte (struct parport *,\n\t\t\t\t\t  void *, size_t, int);\nextern size_t parport_ieee1284_ecp_read_data (struct parport *,\n\t\t\t\t\t      void *, size_t, int);\nextern size_t parport_ieee1284_ecp_write_data (struct parport *,\n\t\t\t\t\t       const void *, size_t, int);\nextern size_t parport_ieee1284_ecp_write_addr (struct parport *,\n\t\t\t\t\t       const void *, size_t, int);\nextern size_t parport_ieee1284_epp_write_data (struct parport *,\n\t\t\t\t\t       const void *, size_t, int);\nextern size_t parport_ieee1284_epp_read_data (struct parport *,\n\t\t\t\t\t      void *, size_t, int);\nextern size_t parport_ieee1284_epp_write_addr (struct parport *,\n\t\t\t\t\t       const void *, size_t, int);\nextern size_t parport_ieee1284_epp_read_addr (struct parport *,\n\t\t\t\t\t      void *, size_t, int);\n\n \n#define daisy_dev_name \"Device ID probe\"\nextern int parport_daisy_init (struct parport *port);\nextern void parport_daisy_fini (struct parport *port);\nextern struct pardevice *parport_open (int devnum, const char *name);\nextern void parport_close (struct pardevice *dev);\nextern ssize_t parport_device_id (int devnum, char *buffer, size_t len);\nextern void parport_daisy_deselect_all (struct parport *port);\nextern int parport_daisy_select (struct parport *port, int daisy, int mode);\n\n \nstatic inline void parport_generic_irq(struct parport *port)\n{\n\tparport_ieee1284_interrupt (port);\n\tread_lock(&port->cad_lock);\n\tif (port->cad && port->cad->irq_func)\n\t\tport->cad->irq_func(port->cad->private);\n\tread_unlock(&port->cad_lock);\n}\n\n \nextern int parport_proc_register(struct parport *pp);\nextern int parport_proc_unregister(struct parport *pp);\nextern int parport_device_proc_register(struct pardevice *device);\nextern int parport_device_proc_unregister(struct pardevice *device);\n\n \n#if !defined(CONFIG_PARPORT_NOT_PC) && defined(CONFIG_PARPORT_PC)\n\n#include <linux/parport_pc.h>\n#define parport_write_data(p,x)            parport_pc_write_data(p,x)\n#define parport_read_data(p)               parport_pc_read_data(p)\n#define parport_write_control(p,x)         parport_pc_write_control(p,x)\n#define parport_read_control(p)            parport_pc_read_control(p)\n#define parport_frob_control(p,m,v)        parport_pc_frob_control(p,m,v)\n#define parport_read_status(p)             parport_pc_read_status(p)\n#define parport_enable_irq(p)              parport_pc_enable_irq(p)\n#define parport_disable_irq(p)             parport_pc_disable_irq(p)\n#define parport_data_forward(p)            parport_pc_data_forward(p)\n#define parport_data_reverse(p)            parport_pc_data_reverse(p)\n\n#else   \n\n \n#define parport_write_data(p,x)            (p)->ops->write_data(p,x)\n#define parport_read_data(p)               (p)->ops->read_data(p)\n#define parport_write_control(p,x)         (p)->ops->write_control(p,x)\n#define parport_read_control(p)            (p)->ops->read_control(p)\n#define parport_frob_control(p,m,v)        (p)->ops->frob_control(p,m,v)\n#define parport_read_status(p)             (p)->ops->read_status(p)\n#define parport_enable_irq(p)              (p)->ops->enable_irq(p)\n#define parport_disable_irq(p)             (p)->ops->disable_irq(p)\n#define parport_data_forward(p)            (p)->ops->data_forward(p)\n#define parport_data_reverse(p)            (p)->ops->data_reverse(p)\n\n#endif  \n\nextern unsigned long parport_default_timeslice;\nextern int parport_default_spintime;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}