{
  "module_name": "binfmts.h",
  "hash_id": "e8da8ee74e86f19f4813618370a2c10d1731a0d5b3dd17b4ff9f5bbf0090f63a",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/binfmts.h",
  "human_readable_source": " \n#ifndef _LINUX_BINFMTS_H\n#define _LINUX_BINFMTS_H\n\n#include <linux/sched.h>\n#include <linux/unistd.h>\n#include <asm/exec.h>\n#include <uapi/linux/binfmts.h>\n\nstruct filename;\nstruct coredump_params;\n\n#define CORENAME_MAX_SIZE 128\n\n \nstruct linux_binprm {\n#ifdef CONFIG_MMU\n\tstruct vm_area_struct *vma;\n\tunsigned long vma_pages;\n#else\n# define MAX_ARG_PAGES\t32\n\tstruct page *page[MAX_ARG_PAGES];\n#endif\n\tstruct mm_struct *mm;\n\tunsigned long p;  \n\tunsigned long argmin;  \n\tunsigned int\n\t\t \n\t\thave_execfd:1,\n\n\t\t \n\t\texecfd_creds:1,\n\t\t \n\t\tsecureexec:1,\n\t\t \n\t\tpoint_of_no_return:1;\n\tstruct file *executable;  \n\tstruct file *interpreter;\n\tstruct file *file;\n\tstruct cred *cred;\t \n\tint unsafe;\t\t \n\tunsigned int per_clear;\t \n\tint argc, envc;\n\tconst char *filename;\t \n\tconst char *interp;\t \n\tconst char *fdpath;\t \n\tunsigned interp_flags;\n\tint execfd;\t\t \n\tunsigned long loader, exec;\n\n\tstruct rlimit rlim_stack;  \n\n\tchar buf[BINPRM_BUF_SIZE];\n} __randomize_layout;\n\n#define BINPRM_FLAGS_ENFORCE_NONDUMP_BIT 0\n#define BINPRM_FLAGS_ENFORCE_NONDUMP (1 << BINPRM_FLAGS_ENFORCE_NONDUMP_BIT)\n\n \n#define BINPRM_FLAGS_PATH_INACCESSIBLE_BIT 2\n#define BINPRM_FLAGS_PATH_INACCESSIBLE (1 << BINPRM_FLAGS_PATH_INACCESSIBLE_BIT)\n\n \n#define BINPRM_FLAGS_PRESERVE_ARGV0_BIT 3\n#define BINPRM_FLAGS_PRESERVE_ARGV0 (1 << BINPRM_FLAGS_PRESERVE_ARGV0_BIT)\n\n \nstruct linux_binfmt {\n\tstruct list_head lh;\n\tstruct module *module;\n\tint (*load_binary)(struct linux_binprm *);\n\tint (*load_shlib)(struct file *);\n#ifdef CONFIG_COREDUMP\n\tint (*core_dump)(struct coredump_params *cprm);\n\tunsigned long min_coredump;\t \n#endif\n} __randomize_layout;\n\nextern void __register_binfmt(struct linux_binfmt *fmt, int insert);\n\n \nstatic inline void register_binfmt(struct linux_binfmt *fmt)\n{\n\t__register_binfmt(fmt, 0);\n}\n \nstatic inline void insert_binfmt(struct linux_binfmt *fmt)\n{\n\t__register_binfmt(fmt, 1);\n}\n\nextern void unregister_binfmt(struct linux_binfmt *);\n\nextern int __must_check remove_arg_zero(struct linux_binprm *);\nextern int begin_new_exec(struct linux_binprm * bprm);\nextern void setup_new_exec(struct linux_binprm * bprm);\nextern void finalize_exec(struct linux_binprm *bprm);\nextern void would_dump(struct linux_binprm *, struct file *);\n\nextern int suid_dumpable;\n\n \n#define EXSTACK_DEFAULT   0\t \n#define EXSTACK_DISABLE_X 1\t \n#define EXSTACK_ENABLE_X  2\t \n\nextern int setup_arg_pages(struct linux_binprm * bprm,\n\t\t\t   unsigned long stack_top,\n\t\t\t   int executable_stack);\nextern int transfer_args_to_stack(struct linux_binprm *bprm,\n\t\t\t\t  unsigned long *sp_location);\nextern int bprm_change_interp(const char *interp, struct linux_binprm *bprm);\nint copy_string_kernel(const char *arg, struct linux_binprm *bprm);\nextern void set_binfmt(struct linux_binfmt *new);\nextern ssize_t read_code(struct file *, unsigned long, loff_t, size_t);\n\nint kernel_execve(const char *filename,\n\t\t  const char *const *argv, const char *const *envp);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}