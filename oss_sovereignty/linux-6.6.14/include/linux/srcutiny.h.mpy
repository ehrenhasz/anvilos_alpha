{
  "module_name": "srcutiny.h",
  "hash_id": "ec582319ae7a74c1fb86131c4b766e275a8965758952e03a878ef9794d6595bb",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/srcutiny.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_SRCU_TINY_H\n#define _LINUX_SRCU_TINY_H\n\n#include <linux/swait.h>\n\nstruct srcu_struct {\n\tshort srcu_lock_nesting[2];\t \n\tu8 srcu_gp_running;\t\t \n\tu8 srcu_gp_waiting;\t\t \n\tunsigned long srcu_idx;\t\t \n\tunsigned long srcu_idx_max;\t \n\tstruct swait_queue_head srcu_wq;\n\t\t\t\t\t \n\tstruct rcu_head *srcu_cb_head;\t \n\tstruct rcu_head **srcu_cb_tail;\t \n\tstruct work_struct srcu_work;\t \n#ifdef CONFIG_DEBUG_LOCK_ALLOC\n\tstruct lockdep_map dep_map;\n#endif  \n};\n\nvoid srcu_drive_gp(struct work_struct *wp);\n\n#define __SRCU_STRUCT_INIT(name, __ignored, ___ignored)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t.srcu_wq = __SWAIT_QUEUE_HEAD_INITIALIZER(name.srcu_wq),\t\\\n\t.srcu_cb_tail = &name.srcu_cb_head,\t\t\t\t\\\n\t.srcu_work = __WORK_INITIALIZER(name.srcu_work, srcu_drive_gp),\t\\\n\t__SRCU_DEP_MAP_INIT(name)\t\t\t\t\t\\\n}\n\n \n#define DEFINE_SRCU(name) \\\n\tstruct srcu_struct name = __SRCU_STRUCT_INIT(name, name, name)\n#define DEFINE_STATIC_SRCU(name) \\\n\tstatic struct srcu_struct name = __SRCU_STRUCT_INIT(name, name, name)\n\n\nstruct srcu_usage { };\n#define __SRCU_USAGE_INIT(name) { }\n\nvoid synchronize_srcu(struct srcu_struct *ssp);\n\n \nstatic inline int __srcu_read_lock(struct srcu_struct *ssp)\n{\n\tint idx;\n\n\tidx = ((READ_ONCE(ssp->srcu_idx) + 1) & 0x2) >> 1;\n\tWRITE_ONCE(ssp->srcu_lock_nesting[idx], READ_ONCE(ssp->srcu_lock_nesting[idx]) + 1);\n\treturn idx;\n}\n\nstatic inline void synchronize_srcu_expedited(struct srcu_struct *ssp)\n{\n\tsynchronize_srcu(ssp);\n}\n\nstatic inline void srcu_barrier(struct srcu_struct *ssp)\n{\n\tsynchronize_srcu(ssp);\n}\n\n \nstatic inline void srcu_torture_stats_print(struct srcu_struct *ssp,\n\t\t\t\t\t    char *tt, char *tf)\n{\n\tint idx;\n\n\tidx = ((data_race(READ_ONCE(ssp->srcu_idx)) + 1) & 0x2) >> 1;\n\tpr_alert(\"%s%s Tiny SRCU per-CPU(idx=%d): (%hd,%hd) gp: %lu->%lu\\n\",\n\t\t tt, tf, idx,\n\t\t data_race(READ_ONCE(ssp->srcu_lock_nesting[!idx])),\n\t\t data_race(READ_ONCE(ssp->srcu_lock_nesting[idx])),\n\t\t data_race(READ_ONCE(ssp->srcu_idx)),\n\t\t data_race(READ_ONCE(ssp->srcu_idx_max)));\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}