{
  "module_name": "rtc.h",
  "hash_id": "7283348003eb5b88133a3ca4b7570032107a2ad273a4935efd9cf242d4e9f24e",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/rtc.h",
  "human_readable_source": " \n \n#ifndef _LINUX_RTC_H_\n#define _LINUX_RTC_H_\n\n\n#include <linux/types.h>\n#include <linux/interrupt.h>\n#include <linux/nvmem-provider.h>\n#include <uapi/linux/rtc.h>\n\nextern int rtc_month_days(unsigned int month, unsigned int year);\nextern int rtc_year_days(unsigned int day, unsigned int month, unsigned int year);\nextern int rtc_valid_tm(struct rtc_time *tm);\nextern time64_t rtc_tm_to_time64(struct rtc_time *tm);\nextern void rtc_time64_to_tm(time64_t time, struct rtc_time *tm);\nktime_t rtc_tm_to_ktime(struct rtc_time tm);\nstruct rtc_time rtc_ktime_to_tm(ktime_t kt);\n\n \nstatic inline time64_t rtc_tm_sub(struct rtc_time *lhs, struct rtc_time *rhs)\n{\n\treturn rtc_tm_to_time64(lhs) - rtc_tm_to_time64(rhs);\n}\n\n#include <linux/device.h>\n#include <linux/seq_file.h>\n#include <linux/cdev.h>\n#include <linux/poll.h>\n#include <linux/mutex.h>\n#include <linux/timerqueue.h>\n#include <linux/workqueue.h>\n\nextern struct class *rtc_class;\n\n \nstruct rtc_class_ops {\n\tint (*ioctl)(struct device *, unsigned int, unsigned long);\n\tint (*read_time)(struct device *, struct rtc_time *);\n\tint (*set_time)(struct device *, struct rtc_time *);\n\tint (*read_alarm)(struct device *, struct rtc_wkalrm *);\n\tint (*set_alarm)(struct device *, struct rtc_wkalrm *);\n\tint (*proc)(struct device *, struct seq_file *);\n\tint (*alarm_irq_enable)(struct device *, unsigned int enabled);\n\tint (*read_offset)(struct device *, long *offset);\n\tint (*set_offset)(struct device *, long offset);\n\tint (*param_get)(struct device *, struct rtc_param *param);\n\tint (*param_set)(struct device *, struct rtc_param *param);\n};\n\nstruct rtc_device;\n\nstruct rtc_timer {\n\tstruct timerqueue_node node;\n\tktime_t period;\n\tvoid (*func)(struct rtc_device *rtc);\n\tstruct rtc_device *rtc;\n\tint enabled;\n};\n\n \n#define RTC_DEV_BUSY 0\n#define RTC_NO_CDEV  1\n\nstruct rtc_device {\n\tstruct device dev;\n\tstruct module *owner;\n\n\tint id;\n\n\tconst struct rtc_class_ops *ops;\n\tstruct mutex ops_lock;\n\n\tstruct cdev char_dev;\n\tunsigned long flags;\n\n\tunsigned long irq_data;\n\tspinlock_t irq_lock;\n\twait_queue_head_t irq_queue;\n\tstruct fasync_struct *async_queue;\n\n\tint irq_freq;\n\tint max_user_freq;\n\n\tstruct timerqueue_head timerqueue;\n\tstruct rtc_timer aie_timer;\n\tstruct rtc_timer uie_rtctimer;\n\tstruct hrtimer pie_timer;  \n\tint pie_enabled;\n\tstruct work_struct irqwork;\n\n\t \n\tunsigned long set_offset_nsec;\n\n\tunsigned long features[BITS_TO_LONGS(RTC_FEATURE_CNT)];\n\n\ttime64_t range_min;\n\ttimeu64_t range_max;\n\ttimeu64_t alarm_offset_max;\n\ttime64_t start_secs;\n\ttime64_t offset_secs;\n\tbool set_start_time;\n\n#ifdef CONFIG_RTC_INTF_DEV_UIE_EMUL\n\tstruct work_struct uie_task;\n\tstruct timer_list uie_timer;\n\t \n\tunsigned int oldsecs;\n\tunsigned int uie_irq_active:1;\n\tunsigned int stop_uie_polling:1;\n\tunsigned int uie_task_active:1;\n\tunsigned int uie_timer_active:1;\n#endif\n};\n#define to_rtc_device(d) container_of(d, struct rtc_device, dev)\n\n#define rtc_lock(d) mutex_lock(&d->ops_lock)\n#define rtc_unlock(d) mutex_unlock(&d->ops_lock)\n\n \n#define RTC_TIMESTAMP_BEGIN_0000\t-62167219200ULL  \n#define RTC_TIMESTAMP_BEGIN_1900\t-2208988800LL  \n#define RTC_TIMESTAMP_BEGIN_2000\t946684800LL  \n#define RTC_TIMESTAMP_END_2063\t\t2966371199LL  \n#define RTC_TIMESTAMP_END_2079\t\t3471292799LL  \n#define RTC_TIMESTAMP_END_2099\t\t4102444799LL  \n#define RTC_TIMESTAMP_END_2199\t\t7258118399LL  \n#define RTC_TIMESTAMP_END_9999\t\t253402300799LL  \n\nextern struct rtc_device *devm_rtc_device_register(struct device *dev,\n\t\t\t\t\tconst char *name,\n\t\t\t\t\tconst struct rtc_class_ops *ops,\n\t\t\t\t\tstruct module *owner);\nstruct rtc_device *devm_rtc_allocate_device(struct device *dev);\nint __devm_rtc_register_device(struct module *owner, struct rtc_device *rtc);\n\nextern int rtc_read_time(struct rtc_device *rtc, struct rtc_time *tm);\nextern int rtc_set_time(struct rtc_device *rtc, struct rtc_time *tm);\nint __rtc_read_alarm(struct rtc_device *rtc, struct rtc_wkalrm *alarm);\nextern int rtc_read_alarm(struct rtc_device *rtc,\n\t\t\tstruct rtc_wkalrm *alrm);\nextern int rtc_set_alarm(struct rtc_device *rtc,\n\t\t\t\tstruct rtc_wkalrm *alrm);\nextern int rtc_initialize_alarm(struct rtc_device *rtc,\n\t\t\t\tstruct rtc_wkalrm *alrm);\nextern void rtc_update_irq(struct rtc_device *rtc,\n\t\t\tunsigned long num, unsigned long events);\n\nextern struct rtc_device *rtc_class_open(const char *name);\nextern void rtc_class_close(struct rtc_device *rtc);\n\nextern int rtc_irq_set_state(struct rtc_device *rtc, int enabled);\nextern int rtc_irq_set_freq(struct rtc_device *rtc, int freq);\nextern int rtc_update_irq_enable(struct rtc_device *rtc, unsigned int enabled);\nextern int rtc_alarm_irq_enable(struct rtc_device *rtc, unsigned int enabled);\nextern int rtc_dev_update_irq_enable_emul(struct rtc_device *rtc,\n\t\t\t\t\t\tunsigned int enabled);\n\nvoid rtc_handle_legacy_irq(struct rtc_device *rtc, int num, int mode);\nvoid rtc_aie_update_irq(struct rtc_device *rtc);\nvoid rtc_uie_update_irq(struct rtc_device *rtc);\nenum hrtimer_restart rtc_pie_update_irq(struct hrtimer *timer);\n\nvoid rtc_timer_init(struct rtc_timer *timer, void (*f)(struct rtc_device *r),\n\t\t    struct rtc_device *rtc);\nint rtc_timer_start(struct rtc_device *rtc, struct rtc_timer *timer,\n\t\t    ktime_t expires, ktime_t period);\nvoid rtc_timer_cancel(struct rtc_device *rtc, struct rtc_timer *timer);\nint rtc_read_offset(struct rtc_device *rtc, long *offset);\nint rtc_set_offset(struct rtc_device *rtc, long offset);\nvoid rtc_timer_do_work(struct work_struct *work);\n\nstatic inline bool is_leap_year(unsigned int year)\n{\n\treturn (!(year % 4) && (year % 100)) || !(year % 400);\n}\n\n#define devm_rtc_register_device(device) \\\n\t__devm_rtc_register_device(THIS_MODULE, device)\n\n#ifdef CONFIG_RTC_HCTOSYS_DEVICE\nextern int rtc_hctosys_ret;\n#else\n#define rtc_hctosys_ret -ENODEV\n#endif\n\n#ifdef CONFIG_RTC_NVMEM\nint devm_rtc_nvmem_register(struct rtc_device *rtc,\n\t\t\t    struct nvmem_config *nvmem_config);\n#else\nstatic inline int devm_rtc_nvmem_register(struct rtc_device *rtc,\n\t\t\t\t\t  struct nvmem_config *nvmem_config)\n{\n\treturn 0;\n}\n#endif\n\n#ifdef CONFIG_RTC_INTF_SYSFS\nint rtc_add_group(struct rtc_device *rtc, const struct attribute_group *grp);\nint rtc_add_groups(struct rtc_device *rtc, const struct attribute_group **grps);\n#else\nstatic inline\nint rtc_add_group(struct rtc_device *rtc, const struct attribute_group *grp)\n{\n\treturn 0;\n}\n\nstatic inline\nint rtc_add_groups(struct rtc_device *rtc, const struct attribute_group **grps)\n{\n\treturn 0;\n}\n#endif\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}