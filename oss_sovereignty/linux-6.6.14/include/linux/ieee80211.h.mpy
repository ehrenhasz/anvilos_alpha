{
  "module_name": "ieee80211.h",
  "hash_id": "e48ae50c6d327b79082b10bf61a7c998b80c5130043c1a27ee584b86ea5dca96",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ieee80211.h",
  "human_readable_source": " \n \n\n#ifndef LINUX_IEEE80211_H\n#define LINUX_IEEE80211_H\n\n#include <linux/types.h>\n#include <linux/if_ether.h>\n#include <linux/etherdevice.h>\n#include <linux/bitfield.h>\n#include <asm/byteorder.h>\n#include <asm/unaligned.h>\n\n \n\n#define FCS_LEN 4\n\n#define IEEE80211_FCTL_VERS\t\t0x0003\n#define IEEE80211_FCTL_FTYPE\t\t0x000c\n#define IEEE80211_FCTL_STYPE\t\t0x00f0\n#define IEEE80211_FCTL_TODS\t\t0x0100\n#define IEEE80211_FCTL_FROMDS\t\t0x0200\n#define IEEE80211_FCTL_MOREFRAGS\t0x0400\n#define IEEE80211_FCTL_RETRY\t\t0x0800\n#define IEEE80211_FCTL_PM\t\t0x1000\n#define IEEE80211_FCTL_MOREDATA\t\t0x2000\n#define IEEE80211_FCTL_PROTECTED\t0x4000\n#define IEEE80211_FCTL_ORDER\t\t0x8000\n#define IEEE80211_FCTL_CTL_EXT\t\t0x0f00\n\n#define IEEE80211_SCTL_FRAG\t\t0x000F\n#define IEEE80211_SCTL_SEQ\t\t0xFFF0\n\n#define IEEE80211_FTYPE_MGMT\t\t0x0000\n#define IEEE80211_FTYPE_CTL\t\t0x0004\n#define IEEE80211_FTYPE_DATA\t\t0x0008\n#define IEEE80211_FTYPE_EXT\t\t0x000c\n\n \n#define IEEE80211_STYPE_ASSOC_REQ\t0x0000\n#define IEEE80211_STYPE_ASSOC_RESP\t0x0010\n#define IEEE80211_STYPE_REASSOC_REQ\t0x0020\n#define IEEE80211_STYPE_REASSOC_RESP\t0x0030\n#define IEEE80211_STYPE_PROBE_REQ\t0x0040\n#define IEEE80211_STYPE_PROBE_RESP\t0x0050\n#define IEEE80211_STYPE_BEACON\t\t0x0080\n#define IEEE80211_STYPE_ATIM\t\t0x0090\n#define IEEE80211_STYPE_DISASSOC\t0x00A0\n#define IEEE80211_STYPE_AUTH\t\t0x00B0\n#define IEEE80211_STYPE_DEAUTH\t\t0x00C0\n#define IEEE80211_STYPE_ACTION\t\t0x00D0\n\n \n#define IEEE80211_STYPE_TRIGGER\t\t0x0020\n#define IEEE80211_STYPE_CTL_EXT\t\t0x0060\n#define IEEE80211_STYPE_BACK_REQ\t0x0080\n#define IEEE80211_STYPE_BACK\t\t0x0090\n#define IEEE80211_STYPE_PSPOLL\t\t0x00A0\n#define IEEE80211_STYPE_RTS\t\t0x00B0\n#define IEEE80211_STYPE_CTS\t\t0x00C0\n#define IEEE80211_STYPE_ACK\t\t0x00D0\n#define IEEE80211_STYPE_CFEND\t\t0x00E0\n#define IEEE80211_STYPE_CFENDACK\t0x00F0\n\n \n#define IEEE80211_STYPE_DATA\t\t\t0x0000\n#define IEEE80211_STYPE_DATA_CFACK\t\t0x0010\n#define IEEE80211_STYPE_DATA_CFPOLL\t\t0x0020\n#define IEEE80211_STYPE_DATA_CFACKPOLL\t\t0x0030\n#define IEEE80211_STYPE_NULLFUNC\t\t0x0040\n#define IEEE80211_STYPE_CFACK\t\t\t0x0050\n#define IEEE80211_STYPE_CFPOLL\t\t\t0x0060\n#define IEEE80211_STYPE_CFACKPOLL\t\t0x0070\n#define IEEE80211_STYPE_QOS_DATA\t\t0x0080\n#define IEEE80211_STYPE_QOS_DATA_CFACK\t\t0x0090\n#define IEEE80211_STYPE_QOS_DATA_CFPOLL\t\t0x00A0\n#define IEEE80211_STYPE_QOS_DATA_CFACKPOLL\t0x00B0\n#define IEEE80211_STYPE_QOS_NULLFUNC\t\t0x00C0\n#define IEEE80211_STYPE_QOS_CFACK\t\t0x00D0\n#define IEEE80211_STYPE_QOS_CFPOLL\t\t0x00E0\n#define IEEE80211_STYPE_QOS_CFACKPOLL\t\t0x00F0\n\n \n#define IEEE80211_STYPE_DMG_BEACON\t\t0x0000\n#define IEEE80211_STYPE_S1G_BEACON\t\t0x0010\n\n \n#define IEEE80211_S1G_BCN_NEXT_TBTT\t0x100\n\n \n#define IEEE80211_S1G_1MHZ_NDP_BITS\t25\n#define IEEE80211_S1G_1MHZ_NDP_BYTES\t4\n#define IEEE80211_S1G_2MHZ_NDP_BITS\t37\n#define IEEE80211_S1G_2MHZ_NDP_BYTES\t5\n\n#define IEEE80211_NDP_FTYPE_CTS\t\t\t0\n#define IEEE80211_NDP_FTYPE_CF_END\t\t0\n#define IEEE80211_NDP_FTYPE_PS_POLL\t\t1\n#define IEEE80211_NDP_FTYPE_ACK\t\t\t2\n#define IEEE80211_NDP_FTYPE_PS_POLL_ACK\t\t3\n#define IEEE80211_NDP_FTYPE_BA\t\t\t4\n#define IEEE80211_NDP_FTYPE_BF_REPORT_POLL\t5\n#define IEEE80211_NDP_FTYPE_PAGING\t\t6\n#define IEEE80211_NDP_FTYPE_PREQ\t\t7\n\n#define SM64(f, v)\t((((u64)v) << f##_S) & f)\n\n \n#define IEEE80211_NDP_FTYPE                    0x0000000000000007\n#define IEEE80211_NDP_FTYPE_S                  0x0000000000000000\n\n \n#define IEEE80211_NDP_1M_PREQ_ANO      0x0000000000000008\n#define IEEE80211_NDP_1M_PREQ_ANO_S                     3\n#define IEEE80211_NDP_1M_PREQ_CSSID    0x00000000000FFFF0\n#define IEEE80211_NDP_1M_PREQ_CSSID_S                   4\n#define IEEE80211_NDP_1M_PREQ_RTYPE    0x0000000000100000\n#define IEEE80211_NDP_1M_PREQ_RTYPE_S                  20\n#define IEEE80211_NDP_1M_PREQ_RSV      0x0000000001E00000\n#define IEEE80211_NDP_1M_PREQ_RSV      0x0000000001E00000\n \n#define IEEE80211_NDP_2M_PREQ_ANO      0x0000000000000008\n#define IEEE80211_NDP_2M_PREQ_ANO_S                     3\n#define IEEE80211_NDP_2M_PREQ_CSSID    0x0000000FFFFFFFF0\n#define IEEE80211_NDP_2M_PREQ_CSSID_S                   4\n#define IEEE80211_NDP_2M_PREQ_RTYPE    0x0000001000000000\n#define IEEE80211_NDP_2M_PREQ_RTYPE_S                  36\n\n#define IEEE80211_ANO_NETTYPE_WILD              15\n\n \n#define IEEE80211_S1G_BCN_NEXT_TBTT    0x100\n\n \n#define IEEE80211_CTL_EXT_POLL\t\t0x2000\n#define IEEE80211_CTL_EXT_SPR\t\t0x3000\n#define IEEE80211_CTL_EXT_GRANT\t0x4000\n#define IEEE80211_CTL_EXT_DMG_CTS\t0x5000\n#define IEEE80211_CTL_EXT_DMG_DTS\t0x6000\n#define IEEE80211_CTL_EXT_SSW\t\t0x8000\n#define IEEE80211_CTL_EXT_SSW_FBACK\t0x9000\n#define IEEE80211_CTL_EXT_SSW_ACK\t0xa000\n\n\n#define IEEE80211_SN_MASK\t\t((IEEE80211_SCTL_SEQ) >> 4)\n#define IEEE80211_MAX_SN\t\tIEEE80211_SN_MASK\n#define IEEE80211_SN_MODULO\t\t(IEEE80211_MAX_SN + 1)\n\n\n \n#define IEEE80211_PV1_FCTL_VERS\t\t0x0003\n#define IEEE80211_PV1_FCTL_FTYPE\t0x001c\n#define IEEE80211_PV1_FCTL_STYPE\t0x00e0\n#define IEEE80211_PV1_FCTL_TODS\t\t0x0100\n#define IEEE80211_PV1_FCTL_MOREFRAGS\t0x0200\n#define IEEE80211_PV1_FCTL_PM\t\t0x0400\n#define IEEE80211_PV1_FCTL_MOREDATA\t0x0800\n#define IEEE80211_PV1_FCTL_PROTECTED\t0x1000\n#define IEEE80211_PV1_FCTL_END_SP       0x2000\n#define IEEE80211_PV1_FCTL_RELAYED      0x4000\n#define IEEE80211_PV1_FCTL_ACK_POLICY   0x8000\n#define IEEE80211_PV1_FCTL_CTL_EXT\t0x0f00\n\nstatic inline bool ieee80211_sn_less(u16 sn1, u16 sn2)\n{\n\treturn ((sn1 - sn2) & IEEE80211_SN_MASK) > (IEEE80211_SN_MODULO >> 1);\n}\n\nstatic inline u16 ieee80211_sn_add(u16 sn1, u16 sn2)\n{\n\treturn (sn1 + sn2) & IEEE80211_SN_MASK;\n}\n\nstatic inline u16 ieee80211_sn_inc(u16 sn)\n{\n\treturn ieee80211_sn_add(sn, 1);\n}\n\nstatic inline u16 ieee80211_sn_sub(u16 sn1, u16 sn2)\n{\n\treturn (sn1 - sn2) & IEEE80211_SN_MASK;\n}\n\n#define IEEE80211_SEQ_TO_SN(seq)\t(((seq) & IEEE80211_SCTL_SEQ) >> 4)\n#define IEEE80211_SN_TO_SEQ(ssn)\t(((ssn) << 4) & IEEE80211_SCTL_SEQ)\n\n \n#define IEEE80211_MAX_FRAG_THRESHOLD\t2352\n#define IEEE80211_MAX_RTS_THRESHOLD\t2353\n#define IEEE80211_MAX_AID\t\t2007\n#define IEEE80211_MAX_AID_S1G\t\t8191\n#define IEEE80211_MAX_TIM_LEN\t\t251\n#define IEEE80211_MAX_MESH_PEERINGS\t63\n \n#define IEEE80211_MAX_DATA_LEN\t\t2304\n \n#define IEEE80211_MAX_DATA_LEN_DMG\t7920\n \n#define IEEE80211_MAX_FRAME_LEN\t\t2352\n\n \n#define IEEE80211_MAX_MPDU_LEN_HT_BA\t\t4095\n\n \n#define IEEE80211_MAX_MPDU_LEN_HT_3839\t\t3839\n#define IEEE80211_MAX_MPDU_LEN_HT_7935\t\t7935\n\n#define IEEE80211_MAX_MPDU_LEN_VHT_3895\t\t3895\n#define IEEE80211_MAX_MPDU_LEN_VHT_7991\t\t7991\n#define IEEE80211_MAX_MPDU_LEN_VHT_11454\t11454\n\n#define IEEE80211_MAX_SSID_LEN\t\t32\n\n#define IEEE80211_MAX_MESH_ID_LEN\t32\n\n#define IEEE80211_FIRST_TSPEC_TSID\t8\n#define IEEE80211_NUM_TIDS\t\t16\n\n \n#define IEEE80211_NUM_UPS\t\t8\n \n#define IEEE80211_NUM_ACS\t\t4\n\n#define IEEE80211_QOS_CTL_LEN\t\t2\n \n#define IEEE80211_QOS_CTL_TAG1D_MASK\t\t0x0007\n \n#define IEEE80211_QOS_CTL_TID_MASK\t\t0x000f\n \n#define IEEE80211_QOS_CTL_EOSP\t\t\t0x0010\n \n#define IEEE80211_QOS_CTL_ACK_POLICY_NORMAL\t0x0000\n#define IEEE80211_QOS_CTL_ACK_POLICY_NOACK\t0x0020\n#define IEEE80211_QOS_CTL_ACK_POLICY_NO_EXPL\t0x0040\n#define IEEE80211_QOS_CTL_ACK_POLICY_BLOCKACK\t0x0060\n#define IEEE80211_QOS_CTL_ACK_POLICY_MASK\t0x0060\n \n#define IEEE80211_QOS_CTL_A_MSDU_PRESENT\t0x0080\n \n#define IEEE80211_QOS_CTL_MESH_CONTROL_PRESENT  0x0100\n\n \n#define IEEE80211_QOS_CTL_MESH_PS_LEVEL\t\t0x0200\n \n#define IEEE80211_QOS_CTL_RSPI\t\t\t0x0400\n\n \n#define IEEE80211_WMM_IE_AP_QOSINFO_UAPSD\t(1<<7)\n#define IEEE80211_WMM_IE_AP_QOSINFO_PARAM_SET_CNT_MASK\t0x0f\n\n \n#define IEEE80211_WMM_IE_STA_QOSINFO_AC_VO\t(1<<0)\n#define IEEE80211_WMM_IE_STA_QOSINFO_AC_VI\t(1<<1)\n#define IEEE80211_WMM_IE_STA_QOSINFO_AC_BK\t(1<<2)\n#define IEEE80211_WMM_IE_STA_QOSINFO_AC_BE\t(1<<3)\n#define IEEE80211_WMM_IE_STA_QOSINFO_AC_MASK\t0x0f\n\n \n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_ALL\t0x00\n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_2\t0x01\n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_4\t0x02\n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_6\t0x03\n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_MASK\t0x03\n#define IEEE80211_WMM_IE_STA_QOSINFO_SP_SHIFT\t5\n\n#define IEEE80211_HT_CTL_LEN\t\t4\n\n \n#define IEEE80211_TRIGGER_TYPE_MASK\t\t0xf\n#define IEEE80211_TRIGGER_TYPE_BASIC\t\t0x0\n#define IEEE80211_TRIGGER_TYPE_BFRP\t\t0x1\n#define IEEE80211_TRIGGER_TYPE_MU_BAR\t\t0x2\n#define IEEE80211_TRIGGER_TYPE_MU_RTS\t\t0x3\n#define IEEE80211_TRIGGER_TYPE_BSRP\t\t0x4\n#define IEEE80211_TRIGGER_TYPE_GCR_MU_BAR\t0x5\n#define IEEE80211_TRIGGER_TYPE_BQRP\t\t0x6\n#define IEEE80211_TRIGGER_TYPE_NFRP\t\t0x7\n\nstruct ieee80211_hdr {\n\t__le16 frame_control;\n\t__le16 duration_id;\n\tstruct_group(addrs,\n\t\tu8 addr1[ETH_ALEN];\n\t\tu8 addr2[ETH_ALEN];\n\t\tu8 addr3[ETH_ALEN];\n\t);\n\t__le16 seq_ctrl;\n\tu8 addr4[ETH_ALEN];\n} __packed __aligned(2);\n\nstruct ieee80211_hdr_3addr {\n\t__le16 frame_control;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctrl;\n} __packed __aligned(2);\n\nstruct ieee80211_qos_hdr {\n\t__le16 frame_control;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctrl;\n\t__le16 qos_ctrl;\n} __packed __aligned(2);\n\nstruct ieee80211_qos_hdr_4addr {\n\t__le16 frame_control;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctrl;\n\tu8 addr4[ETH_ALEN];\n\t__le16 qos_ctrl;\n} __packed __aligned(2);\n\nstruct ieee80211_trigger {\n\t__le16 frame_control;\n\t__le16 duration;\n\tu8 ra[ETH_ALEN];\n\tu8 ta[ETH_ALEN];\n\t__le64 common_info;\n\tu8 variable[];\n} __packed __aligned(2);\n\n \nstatic inline bool ieee80211_has_tods(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_TODS)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_fromds(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FROMDS)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_a4(__le16 fc)\n{\n\t__le16 tmp = cpu_to_le16(IEEE80211_FCTL_TODS | IEEE80211_FCTL_FROMDS);\n\treturn (fc & tmp) == tmp;\n}\n\n \nstatic inline bool ieee80211_has_morefrags(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_MOREFRAGS)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_retry(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_RETRY)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_pm(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_PM)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_moredata(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_MOREDATA)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_protected(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_PROTECTED)) != 0;\n}\n\n \nstatic inline bool ieee80211_has_order(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_ORDER)) != 0;\n}\n\n \nstatic inline bool ieee80211_is_mgmt(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT);\n}\n\n \nstatic inline bool ieee80211_is_ctl(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL);\n}\n\n \nstatic inline bool ieee80211_is_data(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_DATA);\n}\n\n \nstatic inline bool ieee80211_is_ext(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_EXT);\n}\n\n\n \nstatic inline bool ieee80211_is_data_qos(__le16 fc)\n{\n\t \n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_STYPE_QOS_DATA)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_DATA | IEEE80211_STYPE_QOS_DATA);\n}\n\n \nstatic inline bool ieee80211_is_data_present(__le16 fc)\n{\n\t \n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | 0x40)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_DATA);\n}\n\n \nstatic inline bool ieee80211_is_assoc_req(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_ASSOC_REQ);\n}\n\n \nstatic inline bool ieee80211_is_assoc_resp(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_ASSOC_RESP);\n}\n\n \nstatic inline bool ieee80211_is_reassoc_req(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_REASSOC_REQ);\n}\n\n \nstatic inline bool ieee80211_is_reassoc_resp(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_REASSOC_RESP);\n}\n\n \nstatic inline bool ieee80211_is_probe_req(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_PROBE_REQ);\n}\n\n \nstatic inline bool ieee80211_is_probe_resp(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_PROBE_RESP);\n}\n\n \nstatic inline bool ieee80211_is_beacon(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_BEACON);\n}\n\n \nstatic inline bool ieee80211_is_s1g_beacon(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE |\n\t\t\t\t IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_EXT | IEEE80211_STYPE_S1G_BEACON);\n}\n\n \nstatic inline bool ieee80211_next_tbtt_present(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_EXT | IEEE80211_STYPE_S1G_BEACON) &&\n\t       fc & cpu_to_le16(IEEE80211_S1G_BCN_NEXT_TBTT);\n}\n\n \nstatic inline bool ieee80211_is_s1g_short_beacon(__le16 fc)\n{\n\treturn ieee80211_is_s1g_beacon(fc) && ieee80211_next_tbtt_present(fc);\n}\n\n \nstatic inline bool ieee80211_is_atim(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_ATIM);\n}\n\n \nstatic inline bool ieee80211_is_disassoc(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_DISASSOC);\n}\n\n \nstatic inline bool ieee80211_is_auth(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_AUTH);\n}\n\n \nstatic inline bool ieee80211_is_deauth(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_DEAUTH);\n}\n\n \nstatic inline bool ieee80211_is_action(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_MGMT | IEEE80211_STYPE_ACTION);\n}\n\n \nstatic inline bool ieee80211_is_back_req(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_BACK_REQ);\n}\n\n \nstatic inline bool ieee80211_is_back(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_BACK);\n}\n\n \nstatic inline bool ieee80211_is_pspoll(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_PSPOLL);\n}\n\n \nstatic inline bool ieee80211_is_rts(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_RTS);\n}\n\n \nstatic inline bool ieee80211_is_cts(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_CTS);\n}\n\n \nstatic inline bool ieee80211_is_ack(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_ACK);\n}\n\n \nstatic inline bool ieee80211_is_cfend(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_CFEND);\n}\n\n \nstatic inline bool ieee80211_is_cfendack(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_CFENDACK);\n}\n\n \nstatic inline bool ieee80211_is_nullfunc(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_DATA | IEEE80211_STYPE_NULLFUNC);\n}\n\n \nstatic inline bool ieee80211_is_qos_nullfunc(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_DATA | IEEE80211_STYPE_QOS_NULLFUNC);\n}\n\n \nstatic inline bool ieee80211_is_trigger(__le16 fc)\n{\n\treturn (fc & cpu_to_le16(IEEE80211_FCTL_FTYPE | IEEE80211_FCTL_STYPE)) ==\n\t       cpu_to_le16(IEEE80211_FTYPE_CTL | IEEE80211_STYPE_TRIGGER);\n}\n\n \nstatic inline bool ieee80211_is_any_nullfunc(__le16 fc)\n{\n\treturn (ieee80211_is_nullfunc(fc) || ieee80211_is_qos_nullfunc(fc));\n}\n\n \nstatic inline bool ieee80211_is_first_frag(__le16 seq_ctrl)\n{\n\treturn (seq_ctrl & cpu_to_le16(IEEE80211_SCTL_FRAG)) == 0;\n}\n\n \nstatic inline bool ieee80211_is_frag(struct ieee80211_hdr *hdr)\n{\n\treturn ieee80211_has_morefrags(hdr->frame_control) ||\n\t       hdr->seq_ctrl & cpu_to_le16(IEEE80211_SCTL_FRAG);\n}\n\nstruct ieee80211s_hdr {\n\tu8 flags;\n\tu8 ttl;\n\t__le32 seqnum;\n\tu8 eaddr1[ETH_ALEN];\n\tu8 eaddr2[ETH_ALEN];\n} __packed __aligned(2);\n\n \n#define MESH_FLAGS_AE_A4 \t0x1\n#define MESH_FLAGS_AE_A5_A6\t0x2\n#define MESH_FLAGS_AE\t\t0x3\n#define MESH_FLAGS_PS_DEEP\t0x4\n\n \nenum ieee80211_preq_flags {\n\tIEEE80211_PREQ_PROACTIVE_PREP_FLAG\t= 1<<2,\n};\n\n \nenum ieee80211_preq_target_flags {\n\tIEEE80211_PREQ_TO_FLAG\t= 1<<0,\n\tIEEE80211_PREQ_USN_FLAG\t= 1<<2,\n};\n\n \nstruct ieee80211_quiet_ie {\n\tu8 count;\n\tu8 period;\n\t__le16 duration;\n\t__le16 offset;\n} __packed;\n\n \nstruct ieee80211_msrment_ie {\n\tu8 token;\n\tu8 mode;\n\tu8 type;\n\tu8 request[];\n} __packed;\n\n \nstruct ieee80211_channel_sw_ie {\n\tu8 mode;\n\tu8 new_ch_num;\n\tu8 count;\n} __packed;\n\n \nstruct ieee80211_ext_chansw_ie {\n\tu8 mode;\n\tu8 new_operating_class;\n\tu8 new_ch_num;\n\tu8 count;\n} __packed;\n\n \nstruct ieee80211_sec_chan_offs_ie {\n\tu8 sec_chan_offs;\n} __packed;\n\n \nstruct ieee80211_mesh_chansw_params_ie {\n\tu8 mesh_ttl;\n\tu8 mesh_flags;\n\t__le16 mesh_reason;\n\t__le16 mesh_pre_value;\n} __packed;\n\n \nstruct ieee80211_wide_bw_chansw_ie {\n\tu8 new_channel_width;\n\tu8 new_center_freq_seg0, new_center_freq_seg1;\n} __packed;\n\n \nstruct ieee80211_tim_ie {\n\tu8 dtim_count;\n\tu8 dtim_period;\n\tu8 bitmap_ctrl;\n\t \n\tu8 virtual_map[1];\n} __packed;\n\n \nstruct ieee80211_meshconf_ie {\n\tu8 meshconf_psel;\n\tu8 meshconf_pmetric;\n\tu8 meshconf_congest;\n\tu8 meshconf_synch;\n\tu8 meshconf_auth;\n\tu8 meshconf_form;\n\tu8 meshconf_cap;\n} __packed;\n\n \nenum mesh_config_capab_flags {\n\tIEEE80211_MESHCONF_CAPAB_ACCEPT_PLINKS\t\t= 0x01,\n\tIEEE80211_MESHCONF_CAPAB_FORWARDING\t\t= 0x08,\n\tIEEE80211_MESHCONF_CAPAB_TBTT_ADJUSTING\t\t= 0x20,\n\tIEEE80211_MESHCONF_CAPAB_POWER_SAVE_LEVEL\t= 0x40,\n};\n\n#define IEEE80211_MESHCONF_FORM_CONNECTED_TO_GATE 0x1\n\n \n#define WLAN_EID_CHAN_SWITCH_PARAM_TX_RESTRICT BIT(0)\n#define WLAN_EID_CHAN_SWITCH_PARAM_INITIATOR BIT(1)\n#define WLAN_EID_CHAN_SWITCH_PARAM_REASON BIT(2)\n\n \nstruct ieee80211_rann_ie {\n\tu8 rann_flags;\n\tu8 rann_hopcount;\n\tu8 rann_ttl;\n\tu8 rann_addr[ETH_ALEN];\n\t__le32 rann_seq;\n\t__le32 rann_interval;\n\t__le32 rann_metric;\n} __packed;\n\nenum ieee80211_rann_flags {\n\tRANN_FLAG_IS_GATE = 1 << 0,\n};\n\nenum ieee80211_ht_chanwidth_values {\n\tIEEE80211_HT_CHANWIDTH_20MHZ = 0,\n\tIEEE80211_HT_CHANWIDTH_ANY = 1,\n};\n\n \nenum ieee80211_vht_opmode_bits {\n\tIEEE80211_OPMODE_NOTIF_CHANWIDTH_MASK\t= 0x03,\n\tIEEE80211_OPMODE_NOTIF_CHANWIDTH_20MHZ\t= 0,\n\tIEEE80211_OPMODE_NOTIF_CHANWIDTH_40MHZ\t= 1,\n\tIEEE80211_OPMODE_NOTIF_CHANWIDTH_80MHZ\t= 2,\n\tIEEE80211_OPMODE_NOTIF_CHANWIDTH_160MHZ\t= 3,\n\tIEEE80211_OPMODE_NOTIF_BW_160_80P80\t= 0x04,\n\tIEEE80211_OPMODE_NOTIF_RX_NSS_MASK\t= 0x70,\n\tIEEE80211_OPMODE_NOTIF_RX_NSS_SHIFT\t= 4,\n\tIEEE80211_OPMODE_NOTIF_RX_NSS_TYPE_BF\t= 0x80,\n};\n\n \nenum ieee80211_s1g_chanwidth {\n\tIEEE80211_S1G_CHANWIDTH_1MHZ = 0,\n\tIEEE80211_S1G_CHANWIDTH_2MHZ = 1,\n\tIEEE80211_S1G_CHANWIDTH_4MHZ = 3,\n\tIEEE80211_S1G_CHANWIDTH_8MHZ = 7,\n\tIEEE80211_S1G_CHANWIDTH_16MHZ = 15,\n};\n\n#define WLAN_SA_QUERY_TR_ID_LEN 2\n#define WLAN_MEMBERSHIP_LEN 8\n#define WLAN_USER_POSITION_LEN 16\n\n \nstruct ieee80211_tpc_report_ie {\n\tu8 tx_power;\n\tu8 link_margin;\n} __packed;\n\n#define IEEE80211_ADDBA_EXT_FRAG_LEVEL_MASK\tGENMASK(2, 1)\n#define IEEE80211_ADDBA_EXT_FRAG_LEVEL_SHIFT\t1\n#define IEEE80211_ADDBA_EXT_NO_FRAG\t\tBIT(0)\n#define IEEE80211_ADDBA_EXT_BUF_SIZE_MASK\tGENMASK(7, 5)\n#define IEEE80211_ADDBA_EXT_BUF_SIZE_SHIFT\t10\n\nstruct ieee80211_addba_ext_ie {\n\tu8 data;\n} __packed;\n\n \nstruct ieee80211_s1g_bcn_compat_ie {\n\t__le16 compat_info;\n\t__le16 beacon_int;\n\t__le32 tsf_completion;\n} __packed;\n\n \nstruct ieee80211_s1g_oper_ie {\n\tu8 ch_width;\n\tu8 oper_class;\n\tu8 primary_ch;\n\tu8 oper_ch;\n\t__le16 basic_mcs_nss;\n} __packed;\n\n \nstruct ieee80211_aid_response_ie {\n\t__le16 aid;\n\tu8 switch_count;\n\t__le16 response_int;\n} __packed;\n\nstruct ieee80211_s1g_cap {\n\tu8 capab_info[10];\n\tu8 supp_mcs_nss[5];\n} __packed;\n\nstruct ieee80211_ext {\n\t__le16 frame_control;\n\t__le16 duration;\n\tunion {\n\t\tstruct {\n\t\t\tu8 sa[ETH_ALEN];\n\t\t\t__le32 timestamp;\n\t\t\tu8 change_seq;\n\t\t\tu8 variable[0];\n\t\t} __packed s1g_beacon;\n\t\tstruct {\n\t\t\tu8 sa[ETH_ALEN];\n\t\t\t__le32 timestamp;\n\t\t\tu8 change_seq;\n\t\t\tu8 next_tbtt[3];\n\t\t\tu8 variable[0];\n\t\t} __packed s1g_short_beacon;\n\t} u;\n} __packed __aligned(2);\n\n#define IEEE80211_TWT_CONTROL_NDP\t\t\tBIT(0)\n#define IEEE80211_TWT_CONTROL_RESP_MODE\t\t\tBIT(1)\n#define IEEE80211_TWT_CONTROL_NEG_TYPE_BROADCAST\tBIT(3)\n#define IEEE80211_TWT_CONTROL_RX_DISABLED\t\tBIT(4)\n#define IEEE80211_TWT_CONTROL_WAKE_DUR_UNIT\t\tBIT(5)\n\n#define IEEE80211_TWT_REQTYPE_REQUEST\t\t\tBIT(0)\n#define IEEE80211_TWT_REQTYPE_SETUP_CMD\t\t\tGENMASK(3, 1)\n#define IEEE80211_TWT_REQTYPE_TRIGGER\t\t\tBIT(4)\n#define IEEE80211_TWT_REQTYPE_IMPLICIT\t\t\tBIT(5)\n#define IEEE80211_TWT_REQTYPE_FLOWTYPE\t\t\tBIT(6)\n#define IEEE80211_TWT_REQTYPE_FLOWID\t\t\tGENMASK(9, 7)\n#define IEEE80211_TWT_REQTYPE_WAKE_INT_EXP\t\tGENMASK(14, 10)\n#define IEEE80211_TWT_REQTYPE_PROTECTION\t\tBIT(15)\n\nenum ieee80211_twt_setup_cmd {\n\tTWT_SETUP_CMD_REQUEST,\n\tTWT_SETUP_CMD_SUGGEST,\n\tTWT_SETUP_CMD_DEMAND,\n\tTWT_SETUP_CMD_GROUPING,\n\tTWT_SETUP_CMD_ACCEPT,\n\tTWT_SETUP_CMD_ALTERNATE,\n\tTWT_SETUP_CMD_DICTATE,\n\tTWT_SETUP_CMD_REJECT,\n};\n\nstruct ieee80211_twt_params {\n\t__le16 req_type;\n\t__le64 twt;\n\tu8 min_twt_dur;\n\t__le16 mantissa;\n\tu8 channel;\n} __packed;\n\nstruct ieee80211_twt_setup {\n\tu8 dialog_token;\n\tu8 element_id;\n\tu8 length;\n\tu8 control;\n\tu8 params[];\n} __packed;\n\nstruct ieee80211_mgmt {\n\t__le16 frame_control;\n\t__le16 duration;\n\tu8 da[ETH_ALEN];\n\tu8 sa[ETH_ALEN];\n\tu8 bssid[ETH_ALEN];\n\t__le16 seq_ctrl;\n\tunion {\n\t\tstruct {\n\t\t\t__le16 auth_alg;\n\t\t\t__le16 auth_transaction;\n\t\t\t__le16 status_code;\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed auth;\n\t\tstruct {\n\t\t\t__le16 reason_code;\n\t\t} __packed deauth;\n\t\tstruct {\n\t\t\t__le16 capab_info;\n\t\t\t__le16 listen_interval;\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed assoc_req;\n\t\tstruct {\n\t\t\t__le16 capab_info;\n\t\t\t__le16 status_code;\n\t\t\t__le16 aid;\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed assoc_resp, reassoc_resp;\n\t\tstruct {\n\t\t\t__le16 capab_info;\n\t\t\t__le16 status_code;\n\t\t\tu8 variable[];\n\t\t} __packed s1g_assoc_resp, s1g_reassoc_resp;\n\t\tstruct {\n\t\t\t__le16 capab_info;\n\t\t\t__le16 listen_interval;\n\t\t\tu8 current_ap[ETH_ALEN];\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed reassoc_req;\n\t\tstruct {\n\t\t\t__le16 reason_code;\n\t\t} __packed disassoc;\n\t\tstruct {\n\t\t\t__le64 timestamp;\n\t\t\t__le16 beacon_int;\n\t\t\t__le16 capab_info;\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed beacon;\n\t\tstruct {\n\t\t\t \n\t\t\tDECLARE_FLEX_ARRAY(u8, variable);\n\t\t} __packed probe_req;\n\t\tstruct {\n\t\t\t__le64 timestamp;\n\t\t\t__le16 beacon_int;\n\t\t\t__le16 capab_info;\n\t\t\t \n\t\t\tu8 variable[];\n\t\t} __packed probe_resp;\n\t\tstruct {\n\t\t\tu8 category;\n\t\t\tunion {\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\tu8 status_code;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed wme_action;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed chan_switch;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tstruct ieee80211_ext_chansw_ie data;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed ext_chan_switch;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\tu8 element_id;\n\t\t\t\t\tu8 length;\n\t\t\t\t\tstruct ieee80211_msrment_ie msr_elem;\n\t\t\t\t} __packed measurement;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\t__le16 capab;\n\t\t\t\t\t__le16 timeout;\n\t\t\t\t\t__le16 start_seq_num;\n\t\t\t\t\t \n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed addba_req;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\t__le16 status;\n\t\t\t\t\t__le16 capab;\n\t\t\t\t\t__le16 timeout;\n\t\t\t\t} __packed addba_resp;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\t__le16 params;\n\t\t\t\t\t__le16 reason_code;\n\t\t\t\t} __packed delba;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed self_prot;\n\t\t\t\tstruct{\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed mesh_action;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action;\n\t\t\t\t\tu8 trans_id[WLAN_SA_QUERY_TR_ID_LEN];\n\t\t\t\t} __packed sa_query;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action;\n\t\t\t\t\tu8 smps_control;\n\t\t\t\t} __packed ht_smps;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 chanwidth;\n\t\t\t\t} __packed ht_notify_cw;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\t__le16 capability;\n\t\t\t\t\tu8 variable[0];\n\t\t\t\t} __packed tdls_discover_resp;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 operating_mode;\n\t\t\t\t} __packed vht_opmode_notif;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 membership[WLAN_MEMBERSHIP_LEN];\n\t\t\t\t\tu8 position[WLAN_USER_POSITION_LEN];\n\t\t\t\t} __packed vht_group_notif;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\tu8 tpc_elem_id;\n\t\t\t\t\tu8 tpc_elem_length;\n\t\t\t\t\tstruct ieee80211_tpc_report_ie tpc;\n\t\t\t\t} __packed tpc_report;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\tu8 follow_up;\n\t\t\t\t\tu8 tod[6];\n\t\t\t\t\tu8 toa[6];\n\t\t\t\t\t__le16 tod_error;\n\t\t\t\t\t__le16 toa_error;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed ftm;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 variable[];\n\t\t\t\t} __packed s1g;\n\t\t\t\tstruct {\n\t\t\t\t\tu8 action_code;\n\t\t\t\t\tu8 dialog_token;\n\t\t\t\t\tu8 follow_up;\n\t\t\t\t\tu32 tod;\n\t\t\t\t\tu32 toa;\n\t\t\t\t\tu8 max_tod_error;\n\t\t\t\t\tu8 max_toa_error;\n\t\t\t\t} __packed wnm_timing_msr;\n\t\t\t} u;\n\t\t} __packed action;\n\t\tDECLARE_FLEX_ARRAY(u8, body);  \n\t} u;\n} __packed __aligned(2);\n\n \n#define BSS_MEMBERSHIP_SELECTOR_HT_PHY\t127\n#define BSS_MEMBERSHIP_SELECTOR_VHT_PHY\t126\n#define BSS_MEMBERSHIP_SELECTOR_GLK\t125\n#define BSS_MEMBERSHIP_SELECTOR_EPS\t124\n#define BSS_MEMBERSHIP_SELECTOR_SAE_H2E 123\n#define BSS_MEMBERSHIP_SELECTOR_HE_PHY\t122\n#define BSS_MEMBERSHIP_SELECTOR_EHT_PHY\t121\n\n \n#define IEEE80211_MIN_ACTION_SIZE offsetof(struct ieee80211_mgmt, u.action.u)\n\n\n \nstruct ieee80211_mmie {\n\tu8 element_id;\n\tu8 length;\n\t__le16 key_id;\n\tu8 sequence_number[6];\n\tu8 mic[8];\n} __packed;\n\n \nstruct ieee80211_mmie_16 {\n\tu8 element_id;\n\tu8 length;\n\t__le16 key_id;\n\tu8 sequence_number[6];\n\tu8 mic[16];\n} __packed;\n\nstruct ieee80211_vendor_ie {\n\tu8 element_id;\n\tu8 len;\n\tu8 oui[3];\n\tu8 oui_type;\n} __packed;\n\nstruct ieee80211_wmm_ac_param {\n\tu8 aci_aifsn;  \n\tu8 cw;  \n\t__le16 txop_limit;\n} __packed;\n\nstruct ieee80211_wmm_param_ie {\n\tu8 element_id;  \n\tu8 len;  \n\t \n\tu8 oui[3];  \n\tu8 oui_type;  \n\tu8 oui_subtype;  \n\tu8 version;  \n\tu8 qos_info;  \n\tu8 reserved;  \n\t \n\tstruct ieee80211_wmm_ac_param ac[4];\n} __packed;\n\n \nstruct ieee80211_rts {\n\t__le16 frame_control;\n\t__le16 duration;\n\tu8 ra[ETH_ALEN];\n\tu8 ta[ETH_ALEN];\n} __packed __aligned(2);\n\nstruct ieee80211_cts {\n\t__le16 frame_control;\n\t__le16 duration;\n\tu8 ra[ETH_ALEN];\n} __packed __aligned(2);\n\nstruct ieee80211_pspoll {\n\t__le16 frame_control;\n\t__le16 aid;\n\tu8 bssid[ETH_ALEN];\n\tu8 ta[ETH_ALEN];\n} __packed __aligned(2);\n\n \n\n \nstruct ieee80211_ch_switch_timing {\n\t__le16 switch_time;\n\t__le16 switch_timeout;\n} __packed;\n\n \nstruct ieee80211_tdls_lnkie {\n\tu8 ie_type;  \n\tu8 ie_len;\n\tu8 bssid[ETH_ALEN];\n\tu8 init_sta[ETH_ALEN];\n\tu8 resp_sta[ETH_ALEN];\n} __packed;\n\nstruct ieee80211_tdls_data {\n\tu8 da[ETH_ALEN];\n\tu8 sa[ETH_ALEN];\n\t__be16 ether_type;\n\tu8 payload_type;\n\tu8 category;\n\tu8 action_code;\n\tunion {\n\t\tstruct {\n\t\t\tu8 dialog_token;\n\t\t\t__le16 capability;\n\t\t\tu8 variable[0];\n\t\t} __packed setup_req;\n\t\tstruct {\n\t\t\t__le16 status_code;\n\t\t\tu8 dialog_token;\n\t\t\t__le16 capability;\n\t\t\tu8 variable[0];\n\t\t} __packed setup_resp;\n\t\tstruct {\n\t\t\t__le16 status_code;\n\t\t\tu8 dialog_token;\n\t\t\tu8 variable[0];\n\t\t} __packed setup_cfm;\n\t\tstruct {\n\t\t\t__le16 reason_code;\n\t\t\tu8 variable[0];\n\t\t} __packed teardown;\n\t\tstruct {\n\t\t\tu8 dialog_token;\n\t\t\tu8 variable[0];\n\t\t} __packed discover_req;\n\t\tstruct {\n\t\t\tu8 target_channel;\n\t\t\tu8 oper_class;\n\t\t\tu8 variable[0];\n\t\t} __packed chan_switch_req;\n\t\tstruct {\n\t\t\t__le16 status_code;\n\t\t\tu8 variable[0];\n\t\t} __packed chan_switch_resp;\n\t} u;\n} __packed;\n\n \n \nenum ieee80211_p2p_attr_id {\n\tIEEE80211_P2P_ATTR_STATUS = 0,\n\tIEEE80211_P2P_ATTR_MINOR_REASON,\n\tIEEE80211_P2P_ATTR_CAPABILITY,\n\tIEEE80211_P2P_ATTR_DEVICE_ID,\n\tIEEE80211_P2P_ATTR_GO_INTENT,\n\tIEEE80211_P2P_ATTR_GO_CONFIG_TIMEOUT,\n\tIEEE80211_P2P_ATTR_LISTEN_CHANNEL,\n\tIEEE80211_P2P_ATTR_GROUP_BSSID,\n\tIEEE80211_P2P_ATTR_EXT_LISTEN_TIMING,\n\tIEEE80211_P2P_ATTR_INTENDED_IFACE_ADDR,\n\tIEEE80211_P2P_ATTR_MANAGABILITY,\n\tIEEE80211_P2P_ATTR_CHANNEL_LIST,\n\tIEEE80211_P2P_ATTR_ABSENCE_NOTICE,\n\tIEEE80211_P2P_ATTR_DEVICE_INFO,\n\tIEEE80211_P2P_ATTR_GROUP_INFO,\n\tIEEE80211_P2P_ATTR_GROUP_ID,\n\tIEEE80211_P2P_ATTR_INTERFACE,\n\tIEEE80211_P2P_ATTR_OPER_CHANNEL,\n\tIEEE80211_P2P_ATTR_INVITE_FLAGS,\n\t \n\tIEEE80211_P2P_ATTR_VENDOR_SPECIFIC = 221,\n\n\tIEEE80211_P2P_ATTR_MAX\n};\n\n \n \n#define IEEE80211_P2P_NOA_DESC_MAX\t4\n\nstruct ieee80211_p2p_noa_desc {\n\tu8 count;\n\t__le32 duration;\n\t__le32 interval;\n\t__le32 start_time;\n} __packed;\n\nstruct ieee80211_p2p_noa_attr {\n\tu8 index;\n\tu8 oppps_ctwindow;\n\tstruct ieee80211_p2p_noa_desc desc[IEEE80211_P2P_NOA_DESC_MAX];\n} __packed;\n\n#define IEEE80211_P2P_OPPPS_ENABLE_BIT\t\tBIT(7)\n#define IEEE80211_P2P_OPPPS_CTWINDOW_MASK\t0x7F\n\n \nstruct ieee80211_bar {\n\t__le16 frame_control;\n\t__le16 duration;\n\t__u8 ra[ETH_ALEN];\n\t__u8 ta[ETH_ALEN];\n\t__le16 control;\n\t__le16 start_seq_num;\n} __packed;\n\n \n#define IEEE80211_BAR_CTRL_ACK_POLICY_NORMAL\t0x0000\n#define IEEE80211_BAR_CTRL_MULTI_TID\t\t0x0002\n#define IEEE80211_BAR_CTRL_CBMTID_COMPRESSED_BA\t0x0004\n#define IEEE80211_BAR_CTRL_TID_INFO_MASK\t0xf000\n#define IEEE80211_BAR_CTRL_TID_INFO_SHIFT\t12\n\n#define IEEE80211_HT_MCS_MASK_LEN\t\t10\n\n \nstruct ieee80211_mcs_info {\n\tu8 rx_mask[IEEE80211_HT_MCS_MASK_LEN];\n\t__le16 rx_highest;\n\tu8 tx_params;\n\tu8 reserved[3];\n} __packed;\n\n \n#define IEEE80211_HT_MCS_RX_HIGHEST_MASK\t0x3ff\n#define IEEE80211_HT_MCS_TX_DEFINED\t\t0x01\n#define IEEE80211_HT_MCS_TX_RX_DIFF\t\t0x02\n \n#define IEEE80211_HT_MCS_TX_MAX_STREAMS_MASK\t0x0C\n#define IEEE80211_HT_MCS_TX_MAX_STREAMS_SHIFT\t2\n#define\t\tIEEE80211_HT_MCS_TX_MAX_STREAMS\t4\n#define IEEE80211_HT_MCS_TX_UNEQUAL_MODULATION\t0x10\n\n \n#define IEEE80211_HT_MCS_UNEQUAL_MODULATION_START 33\n#define IEEE80211_HT_MCS_UNEQUAL_MODULATION_START_BYTE \\\n\t(IEEE80211_HT_MCS_UNEQUAL_MODULATION_START / 8)\n\n \nstruct ieee80211_ht_cap {\n\t__le16 cap_info;\n\tu8 ampdu_params_info;\n\n\t \n\tstruct ieee80211_mcs_info mcs;\n\n\t__le16 extended_ht_cap_info;\n\t__le32 tx_BF_cap_info;\n\tu8 antenna_selection_info;\n} __packed;\n\n \n#define IEEE80211_HT_CAP_LDPC_CODING\t\t0x0001\n#define IEEE80211_HT_CAP_SUP_WIDTH_20_40\t0x0002\n#define IEEE80211_HT_CAP_SM_PS\t\t\t0x000C\n#define\t\tIEEE80211_HT_CAP_SM_PS_SHIFT\t2\n#define IEEE80211_HT_CAP_GRN_FLD\t\t0x0010\n#define IEEE80211_HT_CAP_SGI_20\t\t\t0x0020\n#define IEEE80211_HT_CAP_SGI_40\t\t\t0x0040\n#define IEEE80211_HT_CAP_TX_STBC\t\t0x0080\n#define IEEE80211_HT_CAP_RX_STBC\t\t0x0300\n#define\t\tIEEE80211_HT_CAP_RX_STBC_SHIFT\t8\n#define IEEE80211_HT_CAP_DELAY_BA\t\t0x0400\n#define IEEE80211_HT_CAP_MAX_AMSDU\t\t0x0800\n#define IEEE80211_HT_CAP_DSSSCCK40\t\t0x1000\n#define IEEE80211_HT_CAP_RESERVED\t\t0x2000\n#define IEEE80211_HT_CAP_40MHZ_INTOLERANT\t0x4000\n#define IEEE80211_HT_CAP_LSIG_TXOP_PROT\t\t0x8000\n\n \n#define IEEE80211_HT_EXT_CAP_PCO\t\t0x0001\n#define IEEE80211_HT_EXT_CAP_PCO_TIME\t\t0x0006\n#define\t\tIEEE80211_HT_EXT_CAP_PCO_TIME_SHIFT\t1\n#define IEEE80211_HT_EXT_CAP_MCS_FB\t\t0x0300\n#define\t\tIEEE80211_HT_EXT_CAP_MCS_FB_SHIFT\t8\n#define IEEE80211_HT_EXT_CAP_HTC_SUP\t\t0x0400\n#define IEEE80211_HT_EXT_CAP_RD_RESPONDER\t0x0800\n\n \n#define IEEE80211_HT_AMPDU_PARM_FACTOR\t\t0x03\n#define IEEE80211_HT_AMPDU_PARM_DENSITY\t\t0x1C\n#define\t\tIEEE80211_HT_AMPDU_PARM_DENSITY_SHIFT\t2\n\n \nenum ieee80211_max_ampdu_length_exp {\n\tIEEE80211_HT_MAX_AMPDU_8K = 0,\n\tIEEE80211_HT_MAX_AMPDU_16K = 1,\n\tIEEE80211_HT_MAX_AMPDU_32K = 2,\n\tIEEE80211_HT_MAX_AMPDU_64K = 3\n};\n\n \nenum ieee80211_vht_max_ampdu_length_exp {\n\tIEEE80211_VHT_MAX_AMPDU_8K = 0,\n\tIEEE80211_VHT_MAX_AMPDU_16K = 1,\n\tIEEE80211_VHT_MAX_AMPDU_32K = 2,\n\tIEEE80211_VHT_MAX_AMPDU_64K = 3,\n\tIEEE80211_VHT_MAX_AMPDU_128K = 4,\n\tIEEE80211_VHT_MAX_AMPDU_256K = 5,\n\tIEEE80211_VHT_MAX_AMPDU_512K = 6,\n\tIEEE80211_VHT_MAX_AMPDU_1024K = 7\n};\n\n#define IEEE80211_HT_MAX_AMPDU_FACTOR 13\n\n \nenum ieee80211_min_mpdu_spacing {\n\tIEEE80211_HT_MPDU_DENSITY_NONE = 0,\t \n\tIEEE80211_HT_MPDU_DENSITY_0_25 = 1,\t \n\tIEEE80211_HT_MPDU_DENSITY_0_5 = 2,\t \n\tIEEE80211_HT_MPDU_DENSITY_1 = 3,\t \n\tIEEE80211_HT_MPDU_DENSITY_2 = 4,\t \n\tIEEE80211_HT_MPDU_DENSITY_4 = 5,\t \n\tIEEE80211_HT_MPDU_DENSITY_8 = 6,\t \n\tIEEE80211_HT_MPDU_DENSITY_16 = 7\t \n};\n\n \nstruct ieee80211_ht_operation {\n\tu8 primary_chan;\n\tu8 ht_param;\n\t__le16 operation_mode;\n\t__le16 stbc_param;\n\tu8 basic_set[16];\n} __packed;\n\n \n#define IEEE80211_HT_PARAM_CHA_SEC_OFFSET\t\t0x03\n#define\t\tIEEE80211_HT_PARAM_CHA_SEC_NONE\t\t0x00\n#define\t\tIEEE80211_HT_PARAM_CHA_SEC_ABOVE\t0x01\n#define\t\tIEEE80211_HT_PARAM_CHA_SEC_BELOW\t0x03\n#define IEEE80211_HT_PARAM_CHAN_WIDTH_ANY\t\t0x04\n#define IEEE80211_HT_PARAM_RIFS_MODE\t\t\t0x08\n\n \n#define IEEE80211_HT_OP_MODE_PROTECTION\t\t\t0x0003\n#define\t\tIEEE80211_HT_OP_MODE_PROTECTION_NONE\t\t0\n#define\t\tIEEE80211_HT_OP_MODE_PROTECTION_NONMEMBER\t1\n#define\t\tIEEE80211_HT_OP_MODE_PROTECTION_20MHZ\t\t2\n#define\t\tIEEE80211_HT_OP_MODE_PROTECTION_NONHT_MIXED\t3\n#define IEEE80211_HT_OP_MODE_NON_GF_STA_PRSNT\t\t0x0004\n#define IEEE80211_HT_OP_MODE_NON_HT_STA_PRSNT\t\t0x0010\n#define IEEE80211_HT_OP_MODE_CCFS2_SHIFT\t\t5\n#define IEEE80211_HT_OP_MODE_CCFS2_MASK\t\t\t0x1fe0\n\n \n#define IEEE80211_HT_STBC_PARAM_DUAL_BEACON\t\t0x0040\n#define IEEE80211_HT_STBC_PARAM_DUAL_CTS_PROT\t\t0x0080\n#define IEEE80211_HT_STBC_PARAM_STBC_BEACON\t\t0x0100\n#define IEEE80211_HT_STBC_PARAM_LSIG_TXOP_FULLPROT\t0x0200\n#define IEEE80211_HT_STBC_PARAM_PCO_ACTIVE\t\t0x0400\n#define IEEE80211_HT_STBC_PARAM_PCO_PHASE\t\t0x0800\n\n\n \n#define IEEE80211_ADDBA_PARAM_AMSDU_MASK 0x0001\n#define IEEE80211_ADDBA_PARAM_POLICY_MASK 0x0002\n#define IEEE80211_ADDBA_PARAM_TID_MASK 0x003C\n#define IEEE80211_ADDBA_PARAM_BUF_SIZE_MASK 0xFFC0\n#define IEEE80211_DELBA_PARAM_TID_MASK 0xF000\n#define IEEE80211_DELBA_PARAM_INITIATOR_MASK 0x0800\n\n \n#define IEEE80211_MIN_AMPDU_BUF\t\t0x8\n#define IEEE80211_MAX_AMPDU_BUF_HT\t0x40\n#define IEEE80211_MAX_AMPDU_BUF_HE\t0x100\n#define IEEE80211_MAX_AMPDU_BUF_EHT\t0x400\n\n\n \n#define WLAN_HT_CAP_SM_PS_STATIC\t0\n#define WLAN_HT_CAP_SM_PS_DYNAMIC\t1\n#define WLAN_HT_CAP_SM_PS_INVALID\t2\n#define WLAN_HT_CAP_SM_PS_DISABLED\t3\n\n \n#define WLAN_HT_SMPS_CONTROL_DISABLED\t0\n#define WLAN_HT_SMPS_CONTROL_STATIC\t1\n#define WLAN_HT_SMPS_CONTROL_DYNAMIC\t3\n\n \nstruct ieee80211_vht_mcs_info {\n\t__le16 rx_mcs_map;\n\t__le16 rx_highest;\n\t__le16 tx_mcs_map;\n\t__le16 tx_highest;\n} __packed;\n\n \n#define IEEE80211_VHT_MAX_NSTS_TOTAL_SHIFT\t13\n#define IEEE80211_VHT_MAX_NSTS_TOTAL_MASK\t(7 << IEEE80211_VHT_MAX_NSTS_TOTAL_SHIFT)\n\n \n#define IEEE80211_VHT_EXT_NSS_BW_CAPABLE\t(1 << 13)\n\n \nenum ieee80211_vht_mcs_support {\n\tIEEE80211_VHT_MCS_SUPPORT_0_7\t= 0,\n\tIEEE80211_VHT_MCS_SUPPORT_0_8\t= 1,\n\tIEEE80211_VHT_MCS_SUPPORT_0_9\t= 2,\n\tIEEE80211_VHT_MCS_NOT_SUPPORTED\t= 3,\n};\n\n \nstruct ieee80211_vht_cap {\n\t__le32 vht_cap_info;\n\tstruct ieee80211_vht_mcs_info supp_mcs;\n} __packed;\n\n \nenum ieee80211_vht_chanwidth {\n\tIEEE80211_VHT_CHANWIDTH_USE_HT\t\t= 0,\n\tIEEE80211_VHT_CHANWIDTH_80MHZ\t\t= 1,\n\tIEEE80211_VHT_CHANWIDTH_160MHZ\t\t= 2,\n\tIEEE80211_VHT_CHANWIDTH_80P80MHZ\t= 3,\n};\n\n \nstruct ieee80211_vht_operation {\n\tu8 chan_width;\n\tu8 center_freq_seg0_idx;\n\tu8 center_freq_seg1_idx;\n\t__le16 basic_mcs_set;\n} __packed;\n\n \nstruct ieee80211_he_cap_elem {\n\tu8 mac_cap_info[6];\n\tu8 phy_cap_info[11];\n} __packed;\n\n#define IEEE80211_TX_RX_MCS_NSS_DESC_MAX_LEN\t5\n\n \nenum ieee80211_he_mcs_support {\n\tIEEE80211_HE_MCS_SUPPORT_0_7\t= 0,\n\tIEEE80211_HE_MCS_SUPPORT_0_9\t= 1,\n\tIEEE80211_HE_MCS_SUPPORT_0_11\t= 2,\n\tIEEE80211_HE_MCS_NOT_SUPPORTED\t= 3,\n};\n\n \nstruct ieee80211_he_mcs_nss_supp {\n\t__le16 rx_mcs_80;\n\t__le16 tx_mcs_80;\n\t__le16 rx_mcs_160;\n\t__le16 tx_mcs_160;\n\t__le16 rx_mcs_80p80;\n\t__le16 tx_mcs_80p80;\n} __packed;\n\n \nstruct ieee80211_he_operation {\n\t__le32 he_oper_params;\n\t__le16 he_mcs_nss_set;\n\tu8 optional[];\n} __packed;\n\n \nstruct ieee80211_he_spr {\n\tu8 he_sr_control;\n\tu8 optional[];\n} __packed;\n\n \nstruct ieee80211_he_mu_edca_param_ac_rec {\n\tu8 aifsn;\n\tu8 ecw_min_max;\n\tu8 mu_edca_timer;\n} __packed;\n\n \nstruct ieee80211_mu_edca_param_set {\n\tu8 mu_qos_info;\n\tstruct ieee80211_he_mu_edca_param_ac_rec ac_be;\n\tstruct ieee80211_he_mu_edca_param_ac_rec ac_bk;\n\tstruct ieee80211_he_mu_edca_param_ac_rec ac_vi;\n\tstruct ieee80211_he_mu_edca_param_ac_rec ac_vo;\n} __packed;\n\n#define IEEE80211_EHT_MCS_NSS_RX 0x0f\n#define IEEE80211_EHT_MCS_NSS_TX 0xf0\n\n \nstruct ieee80211_eht_mcs_nss_supp_20mhz_only {\n\tunion {\n\t\tstruct {\n\t\t\tu8 rx_tx_mcs7_max_nss;\n\t\t\tu8 rx_tx_mcs9_max_nss;\n\t\t\tu8 rx_tx_mcs11_max_nss;\n\t\t\tu8 rx_tx_mcs13_max_nss;\n\t\t};\n\t\tu8 rx_tx_max_nss[4];\n\t};\n};\n\n \nstruct ieee80211_eht_mcs_nss_supp_bw {\n\tunion {\n\t\tstruct {\n\t\t\tu8 rx_tx_mcs9_max_nss;\n\t\t\tu8 rx_tx_mcs11_max_nss;\n\t\t\tu8 rx_tx_mcs13_max_nss;\n\t\t};\n\t\tu8 rx_tx_max_nss[3];\n\t};\n};\n\n \nstruct ieee80211_eht_cap_elem_fixed {\n\tu8 mac_cap_info[2];\n\tu8 phy_cap_info[9];\n} __packed;\n\n \nstruct ieee80211_eht_cap_elem {\n\tstruct ieee80211_eht_cap_elem_fixed fixed;\n\n\t \n\tu8 optional[];\n} __packed;\n\n#define IEEE80211_EHT_OPER_INFO_PRESENT\t                        0x01\n#define IEEE80211_EHT_OPER_DISABLED_SUBCHANNEL_BITMAP_PRESENT\t0x02\n#define IEEE80211_EHT_OPER_EHT_DEF_PE_DURATION\t                0x04\n#define IEEE80211_EHT_OPER_GROUP_ADDRESSED_BU_IND_LIMIT         0x08\n#define IEEE80211_EHT_OPER_GROUP_ADDRESSED_BU_IND_EXP_MASK      0x30\n\n \nstruct ieee80211_eht_operation {\n\tu8 params;\n\tstruct ieee80211_eht_mcs_nss_supp_20mhz_only basic_mcs_nss;\n\tu8 optional[];\n} __packed;\n\n \nstruct ieee80211_eht_operation_info {\n\tu8 control;\n\tu8 ccfs0;\n\tu8 ccfs1;\n\tu8 optional[];\n} __packed;\n\n \n#define IEEE80211_VHT_CAP_MAX_MPDU_LENGTH_3895\t\t\t0x00000000\n#define IEEE80211_VHT_CAP_MAX_MPDU_LENGTH_7991\t\t\t0x00000001\n#define IEEE80211_VHT_CAP_MAX_MPDU_LENGTH_11454\t\t\t0x00000002\n#define IEEE80211_VHT_CAP_MAX_MPDU_MASK\t\t\t\t0x00000003\n#define IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160MHZ\t\t0x00000004\n#define IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_160_80PLUS80MHZ\t0x00000008\n#define IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_MASK\t\t\t0x0000000C\n#define IEEE80211_VHT_CAP_SUPP_CHAN_WIDTH_SHIFT\t\t\t2\n#define IEEE80211_VHT_CAP_RXLDPC\t\t\t\t0x00000010\n#define IEEE80211_VHT_CAP_SHORT_GI_80\t\t\t\t0x00000020\n#define IEEE80211_VHT_CAP_SHORT_GI_160\t\t\t\t0x00000040\n#define IEEE80211_VHT_CAP_TXSTBC\t\t\t\t0x00000080\n#define IEEE80211_VHT_CAP_RXSTBC_1\t\t\t\t0x00000100\n#define IEEE80211_VHT_CAP_RXSTBC_2\t\t\t\t0x00000200\n#define IEEE80211_VHT_CAP_RXSTBC_3\t\t\t\t0x00000300\n#define IEEE80211_VHT_CAP_RXSTBC_4\t\t\t\t0x00000400\n#define IEEE80211_VHT_CAP_RXSTBC_MASK\t\t\t\t0x00000700\n#define IEEE80211_VHT_CAP_RXSTBC_SHIFT\t\t\t\t8\n#define IEEE80211_VHT_CAP_SU_BEAMFORMER_CAPABLE\t\t\t0x00000800\n#define IEEE80211_VHT_CAP_SU_BEAMFORMEE_CAPABLE\t\t\t0x00001000\n#define IEEE80211_VHT_CAP_BEAMFORMEE_STS_SHIFT                  13\n#define IEEE80211_VHT_CAP_BEAMFORMEE_STS_MASK\t\t\t\\\n\t\t(7 << IEEE80211_VHT_CAP_BEAMFORMEE_STS_SHIFT)\n#define IEEE80211_VHT_CAP_SOUNDING_DIMENSIONS_SHIFT\t\t16\n#define IEEE80211_VHT_CAP_SOUNDING_DIMENSIONS_MASK\t\t\\\n\t\t(7 << IEEE80211_VHT_CAP_SOUNDING_DIMENSIONS_SHIFT)\n#define IEEE80211_VHT_CAP_MU_BEAMFORMER_CAPABLE\t\t\t0x00080000\n#define IEEE80211_VHT_CAP_MU_BEAMFORMEE_CAPABLE\t\t\t0x00100000\n#define IEEE80211_VHT_CAP_VHT_TXOP_PS\t\t\t\t0x00200000\n#define IEEE80211_VHT_CAP_HTC_VHT\t\t\t\t0x00400000\n#define IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_SHIFT\t23\n#define IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_MASK\t\\\n\t\t(7 << IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_SHIFT)\n#define IEEE80211_VHT_CAP_VHT_LINK_ADAPTATION_VHT_UNSOL_MFB\t0x08000000\n#define IEEE80211_VHT_CAP_VHT_LINK_ADAPTATION_VHT_MRQ_MFB\t0x0c000000\n#define IEEE80211_VHT_CAP_RX_ANTENNA_PATTERN\t\t\t0x10000000\n#define IEEE80211_VHT_CAP_TX_ANTENNA_PATTERN\t\t\t0x20000000\n#define IEEE80211_VHT_CAP_EXT_NSS_BW_SHIFT\t\t\t30\n#define IEEE80211_VHT_CAP_EXT_NSS_BW_MASK\t\t\t0xc0000000\n\n \nint ieee80211_get_vht_max_nss(struct ieee80211_vht_cap *cap,\n\t\t\t      enum ieee80211_vht_chanwidth bw,\n\t\t\t      int mcs, bool ext_nss_bw_capable,\n\t\t\t      unsigned int max_vht_nss);\n\n \nenum ieee80211_ap_reg_power {\n\tIEEE80211_REG_UNSET_AP,\n\tIEEE80211_REG_LPI_AP,\n\tIEEE80211_REG_SP_AP,\n\tIEEE80211_REG_VLP_AP,\n\tIEEE80211_REG_AP_POWER_AFTER_LAST,\n\tIEEE80211_REG_AP_POWER_MAX =\n\t\tIEEE80211_REG_AP_POWER_AFTER_LAST - 1,\n};\n\n \nenum ieee80211_client_reg_power {\n\tIEEE80211_REG_UNSET_CLIENT,\n\tIEEE80211_REG_DEFAULT_CLIENT,\n\tIEEE80211_REG_SUBORDINATE_CLIENT,\n\tIEEE80211_REG_CLIENT_POWER_AFTER_LAST,\n\tIEEE80211_REG_CLIENT_POWER_MAX =\n\t\tIEEE80211_REG_CLIENT_POWER_AFTER_LAST - 1,\n};\n\n \n#define IEEE80211_HE_MAC_CAP0_HTC_HE\t\t\t\t0x01\n#define IEEE80211_HE_MAC_CAP0_TWT_REQ\t\t\t\t0x02\n#define IEEE80211_HE_MAC_CAP0_TWT_RES\t\t\t\t0x04\n#define IEEE80211_HE_MAC_CAP0_DYNAMIC_FRAG_NOT_SUPP\t\t0x00\n#define IEEE80211_HE_MAC_CAP0_DYNAMIC_FRAG_LEVEL_1\t\t0x08\n#define IEEE80211_HE_MAC_CAP0_DYNAMIC_FRAG_LEVEL_2\t\t0x10\n#define IEEE80211_HE_MAC_CAP0_DYNAMIC_FRAG_LEVEL_3\t\t0x18\n#define IEEE80211_HE_MAC_CAP0_DYNAMIC_FRAG_MASK\t\t\t0x18\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_1\t\t0x00\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_2\t\t0x20\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_4\t\t0x40\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_8\t\t0x60\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_16\t\t0x80\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_32\t\t0xa0\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_64\t\t0xc0\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_UNLIMITED\t0xe0\n#define IEEE80211_HE_MAC_CAP0_MAX_NUM_FRAG_MSDU_MASK\t\t0xe0\n\n#define IEEE80211_HE_MAC_CAP1_MIN_FRAG_SIZE_UNLIMITED\t\t0x00\n#define IEEE80211_HE_MAC_CAP1_MIN_FRAG_SIZE_128\t\t\t0x01\n#define IEEE80211_HE_MAC_CAP1_MIN_FRAG_SIZE_256\t\t\t0x02\n#define IEEE80211_HE_MAC_CAP1_MIN_FRAG_SIZE_512\t\t\t0x03\n#define IEEE80211_HE_MAC_CAP1_MIN_FRAG_SIZE_MASK\t\t0x03\n#define IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_0US\t\t0x00\n#define IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_8US\t\t0x04\n#define IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_16US\t\t0x08\n#define IEEE80211_HE_MAC_CAP1_TF_MAC_PAD_DUR_MASK\t\t0x0c\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_1\t\t0x00\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_2\t\t0x10\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_3\t\t0x20\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_4\t\t0x30\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_5\t\t0x40\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_6\t\t0x50\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_7\t\t0x60\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_8\t\t0x70\n#define IEEE80211_HE_MAC_CAP1_MULTI_TID_AGG_RX_QOS_MASK\t\t0x70\n\n \n#define IEEE80211_HE_MAC_CAP1_LINK_ADAPTATION\t\t\t0x80\n\n#define IEEE80211_HE_MAC_CAP2_LINK_ADAPTATION\t\t\t0x01\n#define IEEE80211_HE_MAC_CAP2_ALL_ACK\t\t\t\t0x02\n#define IEEE80211_HE_MAC_CAP2_TRS\t\t\t\t0x04\n#define IEEE80211_HE_MAC_CAP2_BSR\t\t\t\t0x08\n#define IEEE80211_HE_MAC_CAP2_BCAST_TWT\t\t\t\t0x10\n#define IEEE80211_HE_MAC_CAP2_32BIT_BA_BITMAP\t\t\t0x20\n#define IEEE80211_HE_MAC_CAP2_MU_CASCADING\t\t\t0x40\n#define IEEE80211_HE_MAC_CAP2_ACK_EN\t\t\t\t0x80\n\n#define IEEE80211_HE_MAC_CAP3_OMI_CONTROL\t\t\t0x02\n#define IEEE80211_HE_MAC_CAP3_OFDMA_RA\t\t\t\t0x04\n\n \n#define IEEE80211_HE_MAC_CAP3_MAX_AMPDU_LEN_EXP_EXT_0\t\t0x00\n#define IEEE80211_HE_MAC_CAP3_MAX_AMPDU_LEN_EXP_EXT_1\t\t0x08\n#define IEEE80211_HE_MAC_CAP3_MAX_AMPDU_LEN_EXP_EXT_2\t\t0x10\n#define IEEE80211_HE_MAC_CAP3_MAX_AMPDU_LEN_EXP_EXT_3\t\t0x18\n#define IEEE80211_HE_MAC_CAP3_MAX_AMPDU_LEN_EXP_MASK\t\t0x18\n#define IEEE80211_HE_MAC_CAP3_AMSDU_FRAG\t\t\t0x20\n#define IEEE80211_HE_MAC_CAP3_FLEX_TWT_SCHED\t\t\t0x40\n#define IEEE80211_HE_MAC_CAP3_RX_CTRL_FRAME_TO_MULTIBSS\t\t0x80\n\n#define IEEE80211_HE_MAC_CAP4_BSRP_BQRP_A_MPDU_AGG\t\t0x01\n#define IEEE80211_HE_MAC_CAP4_QTP\t\t\t\t0x02\n#define IEEE80211_HE_MAC_CAP4_BQR\t\t\t\t0x04\n#define IEEE80211_HE_MAC_CAP4_PSR_RESP\t\t\t\t0x08\n#define IEEE80211_HE_MAC_CAP4_NDP_FB_REP\t\t\t0x10\n#define IEEE80211_HE_MAC_CAP4_OPS\t\t\t\t0x20\n#define IEEE80211_HE_MAC_CAP4_AMSDU_IN_AMPDU\t\t\t0x40\n \n#define IEEE80211_HE_MAC_CAP4_MULTI_TID_AGG_TX_QOS_B39\t\t0x80\n\n#define IEEE80211_HE_MAC_CAP5_MULTI_TID_AGG_TX_QOS_B40\t\t0x01\n#define IEEE80211_HE_MAC_CAP5_MULTI_TID_AGG_TX_QOS_B41\t\t0x02\n#define IEEE80211_HE_MAC_CAP5_SUBCHAN_SELECTIVE_TRANSMISSION\t0x04\n#define IEEE80211_HE_MAC_CAP5_UL_2x996_TONE_RU\t\t\t0x08\n#define IEEE80211_HE_MAC_CAP5_OM_CTRL_UL_MU_DATA_DIS_RX\t\t0x10\n#define IEEE80211_HE_MAC_CAP5_HE_DYNAMIC_SM_PS\t\t\t0x20\n#define IEEE80211_HE_MAC_CAP5_PUNCTURED_SOUNDING\t\t0x40\n#define IEEE80211_HE_MAC_CAP5_HT_VHT_TRIG_FRAME_RX\t\t0x80\n\n#define IEEE80211_HE_VHT_MAX_AMPDU_FACTOR\t20\n#define IEEE80211_HE_HT_MAX_AMPDU_FACTOR\t16\n#define IEEE80211_HE_6GHZ_MAX_AMPDU_FACTOR\t13\n\n \n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_IN_2G\t\t0x02\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_80MHZ_IN_5G\t0x04\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_160MHZ_IN_5G\t\t0x08\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_80PLUS80_MHZ_IN_5G\t0x10\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_MASK_ALL\t\t0x1e\n\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_RU_MAPPING_IN_2G\t0x20\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_RU_MAPPING_IN_5G\t0x40\n#define IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_MASK\t\t\t0xfe\n\n#define IEEE80211_HE_PHY_CAP1_PREAMBLE_PUNC_RX_80MHZ_ONLY_SECOND_20MHZ\t0x01\n#define IEEE80211_HE_PHY_CAP1_PREAMBLE_PUNC_RX_80MHZ_ONLY_SECOND_40MHZ\t0x02\n#define IEEE80211_HE_PHY_CAP1_PREAMBLE_PUNC_RX_160MHZ_ONLY_SECOND_20MHZ\t0x04\n#define IEEE80211_HE_PHY_CAP1_PREAMBLE_PUNC_RX_160MHZ_ONLY_SECOND_40MHZ\t0x08\n#define IEEE80211_HE_PHY_CAP1_PREAMBLE_PUNC_RX_MASK\t\t\t0x0f\n#define IEEE80211_HE_PHY_CAP1_DEVICE_CLASS_A\t\t\t\t0x10\n#define IEEE80211_HE_PHY_CAP1_LDPC_CODING_IN_PAYLOAD\t\t\t0x20\n#define IEEE80211_HE_PHY_CAP1_HE_LTF_AND_GI_FOR_HE_PPDUS_0_8US\t\t0x40\n \n#define IEEE80211_HE_PHY_CAP1_MIDAMBLE_RX_TX_MAX_NSTS\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP2_MIDAMBLE_RX_TX_MAX_NSTS\t\t\t0x01\n#define IEEE80211_HE_PHY_CAP2_NDP_4x_LTF_AND_3_2US\t\t\t0x02\n#define IEEE80211_HE_PHY_CAP2_STBC_TX_UNDER_80MHZ\t\t\t0x04\n#define IEEE80211_HE_PHY_CAP2_STBC_RX_UNDER_80MHZ\t\t\t0x08\n#define IEEE80211_HE_PHY_CAP2_DOPPLER_TX\t\t\t\t0x10\n#define IEEE80211_HE_PHY_CAP2_DOPPLER_RX\t\t\t\t0x20\n\n \n#define IEEE80211_HE_PHY_CAP2_UL_MU_FULL_MU_MIMO\t\t\t0x40\n#define IEEE80211_HE_PHY_CAP2_UL_MU_PARTIAL_MU_MIMO\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_TX_NO_DCM\t\t\t0x00\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_TX_BPSK\t\t\t0x01\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_TX_QPSK\t\t\t0x02\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_TX_16_QAM\t\t\t0x03\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_TX_MASK\t\t\t0x03\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_TX_NSS_1\t\t\t\t0x00\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_TX_NSS_2\t\t\t\t0x04\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_RX_NO_DCM\t\t\t0x00\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_RX_BPSK\t\t\t0x08\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_RX_QPSK\t\t\t0x10\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_RX_16_QAM\t\t\t0x18\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_CONST_RX_MASK\t\t\t0x18\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_RX_NSS_1\t\t\t\t0x00\n#define IEEE80211_HE_PHY_CAP3_DCM_MAX_RX_NSS_2\t\t\t\t0x20\n#define IEEE80211_HE_PHY_CAP3_RX_PARTIAL_BW_SU_IN_20MHZ_MU\t\t0x40\n#define IEEE80211_HE_PHY_CAP3_SU_BEAMFORMER\t\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP4_SU_BEAMFORMEE\t\t\t\t0x01\n#define IEEE80211_HE_PHY_CAP4_MU_BEAMFORMER\t\t\t\t0x02\n\n \n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_4\t\t0x0c\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_5\t\t0x10\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_6\t\t0x14\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_7\t\t0x18\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_8\t\t0x1c\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_UNDER_80MHZ_MASK\t0x1c\n\n \n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_4\t\t0x60\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_5\t\t0x80\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_6\t\t0xa0\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_7\t\t0xc0\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_8\t\t0xe0\n#define IEEE80211_HE_PHY_CAP4_BEAMFORMEE_MAX_STS_ABOVE_80MHZ_MASK\t0xe0\n\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_1\t0x00\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_2\t0x01\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_3\t0x02\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_4\t0x03\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_5\t0x04\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_6\t0x05\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_7\t0x06\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_8\t0x07\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_UNDER_80MHZ_MASK\t0x07\n\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_1\t0x00\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_2\t0x08\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_3\t0x10\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_4\t0x18\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_5\t0x20\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_6\t0x28\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_7\t0x30\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_8\t0x38\n#define IEEE80211_HE_PHY_CAP5_BEAMFORMEE_NUM_SND_DIM_ABOVE_80MHZ_MASK\t0x38\n\n#define IEEE80211_HE_PHY_CAP5_NG16_SU_FEEDBACK\t\t\t\t0x40\n#define IEEE80211_HE_PHY_CAP5_NG16_MU_FEEDBACK\t\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP6_CODEBOOK_SIZE_42_SU\t\t\t0x01\n#define IEEE80211_HE_PHY_CAP6_CODEBOOK_SIZE_75_MU\t\t\t0x02\n#define IEEE80211_HE_PHY_CAP6_TRIG_SU_BEAMFORMING_FB\t\t\t0x04\n#define IEEE80211_HE_PHY_CAP6_TRIG_MU_BEAMFORMING_PARTIAL_BW_FB\t\t0x08\n#define IEEE80211_HE_PHY_CAP6_TRIG_CQI_FB\t\t\t\t0x10\n#define IEEE80211_HE_PHY_CAP6_PARTIAL_BW_EXT_RANGE\t\t\t0x20\n#define IEEE80211_HE_PHY_CAP6_PARTIAL_BANDWIDTH_DL_MUMIMO\t\t0x40\n#define IEEE80211_HE_PHY_CAP6_PPE_THRESHOLD_PRESENT\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP7_PSR_BASED_SR\t\t\t\t0x01\n#define IEEE80211_HE_PHY_CAP7_POWER_BOOST_FACTOR_SUPP\t\t\t0x02\n#define IEEE80211_HE_PHY_CAP7_HE_SU_MU_PPDU_4XLTF_AND_08_US_GI\t\t0x04\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_1\t\t\t\t\t0x08\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_2\t\t\t\t\t0x10\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_3\t\t\t\t\t0x18\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_4\t\t\t\t\t0x20\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_5\t\t\t\t\t0x28\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_6\t\t\t\t\t0x30\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_7\t\t\t\t\t0x38\n#define IEEE80211_HE_PHY_CAP7_MAX_NC_MASK\t\t\t\t0x38\n#define IEEE80211_HE_PHY_CAP7_STBC_TX_ABOVE_80MHZ\t\t\t0x40\n#define IEEE80211_HE_PHY_CAP7_STBC_RX_ABOVE_80MHZ\t\t\t0x80\n\n#define IEEE80211_HE_PHY_CAP8_HE_ER_SU_PPDU_4XLTF_AND_08_US_GI\t\t0x01\n#define IEEE80211_HE_PHY_CAP8_20MHZ_IN_40MHZ_HE_PPDU_IN_2G\t\t0x02\n#define IEEE80211_HE_PHY_CAP8_20MHZ_IN_160MHZ_HE_PPDU\t\t\t0x04\n#define IEEE80211_HE_PHY_CAP8_80MHZ_IN_160MHZ_HE_PPDU\t\t\t0x08\n#define IEEE80211_HE_PHY_CAP8_HE_ER_SU_1XLTF_AND_08_US_GI\t\t0x10\n#define IEEE80211_HE_PHY_CAP8_MIDAMBLE_RX_TX_2X_AND_1XLTF\t\t0x20\n#define IEEE80211_HE_PHY_CAP8_DCM_MAX_RU_242\t\t\t\t0x00\n#define IEEE80211_HE_PHY_CAP8_DCM_MAX_RU_484\t\t\t\t0x40\n#define IEEE80211_HE_PHY_CAP8_DCM_MAX_RU_996\t\t\t\t0x80\n#define IEEE80211_HE_PHY_CAP8_DCM_MAX_RU_2x996\t\t\t\t0xc0\n#define IEEE80211_HE_PHY_CAP8_DCM_MAX_RU_MASK\t\t\t\t0xc0\n\n#define IEEE80211_HE_PHY_CAP9_LONGER_THAN_16_SIGB_OFDM_SYM\t\t0x01\n#define IEEE80211_HE_PHY_CAP9_NON_TRIGGERED_CQI_FEEDBACK\t\t0x02\n#define IEEE80211_HE_PHY_CAP9_TX_1024_QAM_LESS_THAN_242_TONE_RU\t\t0x04\n#define IEEE80211_HE_PHY_CAP9_RX_1024_QAM_LESS_THAN_242_TONE_RU\t\t0x08\n#define IEEE80211_HE_PHY_CAP9_RX_FULL_BW_SU_USING_MU_WITH_COMP_SIGB\t0x10\n#define IEEE80211_HE_PHY_CAP9_RX_FULL_BW_SU_USING_MU_WITH_NON_COMP_SIGB\t0x20\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_0US\t\t\t0x0\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_8US\t\t\t0x1\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_16US\t\t\t0x2\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_RESERVED\t\t0x3\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_POS\t\t\t6\n#define IEEE80211_HE_PHY_CAP9_NOMINAL_PKT_PADDING_MASK\t\t\t0xc0\n\n#define IEEE80211_HE_PHY_CAP10_HE_MU_M1RU_MAX_LTF\t\t\t0x01\n\n \n#define IEEE80211_TX_RX_MCS_NSS_SUPP_HIGHEST_MCS_POS\t\t\t(3)\n#define IEEE80211_TX_RX_MCS_NSS_SUPP_TX_BITMAP_POS\t\t\t(6)\n#define IEEE80211_TX_RX_MCS_NSS_SUPP_RX_BITMAP_POS\t\t\t(11)\n#define IEEE80211_TX_RX_MCS_NSS_SUPP_TX_BITMAP_MASK\t\t\t0x07c0\n#define IEEE80211_TX_RX_MCS_NSS_SUPP_RX_BITMAP_MASK\t\t\t0xf800\n\n \nenum ieee80211_he_highest_mcs_supported_subfield_enc {\n\tHIGHEST_MCS_SUPPORTED_MCS7 = 0,\n\tHIGHEST_MCS_SUPPORTED_MCS8,\n\tHIGHEST_MCS_SUPPORTED_MCS9,\n\tHIGHEST_MCS_SUPPORTED_MCS10,\n\tHIGHEST_MCS_SUPPORTED_MCS11,\n};\n\n \nstatic inline u8\nieee80211_he_mcs_nss_size(const struct ieee80211_he_cap_elem *he_cap)\n{\n\tu8 count = 4;\n\n\tif (he_cap->phy_cap_info[0] &\n\t    IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_160MHZ_IN_5G)\n\t\tcount += 4;\n\n\tif (he_cap->phy_cap_info[0] &\n\t    IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_80PLUS80_MHZ_IN_5G)\n\t\tcount += 4;\n\n\treturn count;\n}\n\n \n#define IEEE80211_PPE_THRES_NSS_SUPPORT_2NSS\t\t\t(1)\n#define IEEE80211_PPE_THRES_NSS_POS\t\t\t\t(0)\n#define IEEE80211_PPE_THRES_NSS_MASK\t\t\t\t(7)\n#define IEEE80211_PPE_THRES_RU_INDEX_BITMASK_2x966_AND_966_RU\t\\\n\t(BIT(5) | BIT(6))\n#define IEEE80211_PPE_THRES_RU_INDEX_BITMASK_MASK\t\t0x78\n#define IEEE80211_PPE_THRES_RU_INDEX_BITMASK_POS\t\t(3)\n#define IEEE80211_PPE_THRES_INFO_PPET_SIZE\t\t\t(3)\n#define IEEE80211_HE_PPE_THRES_INFO_HEADER_SIZE\t\t\t(7)\n\n \nstatic inline u8\nieee80211_he_ppe_size(u8 ppe_thres_hdr, const u8 *phy_cap_info)\n{\n\tu8 n;\n\n\tif ((phy_cap_info[6] &\n\t     IEEE80211_HE_PHY_CAP6_PPE_THRESHOLD_PRESENT) == 0)\n\t\treturn 0;\n\n\tn = hweight8(ppe_thres_hdr &\n\t\t     IEEE80211_PPE_THRES_RU_INDEX_BITMASK_MASK);\n\tn *= (1 + ((ppe_thres_hdr & IEEE80211_PPE_THRES_NSS_MASK) >>\n\t\t   IEEE80211_PPE_THRES_NSS_POS));\n\n\t \n\tn = (n * IEEE80211_PPE_THRES_INFO_PPET_SIZE * 2) + 7;\n\tn = DIV_ROUND_UP(n, 8);\n\n\treturn n;\n}\n\nstatic inline bool ieee80211_he_capa_size_ok(const u8 *data, u8 len)\n{\n\tconst struct ieee80211_he_cap_elem *he_cap_ie_elem = (const void *)data;\n\tu8 needed = sizeof(*he_cap_ie_elem);\n\n\tif (len < needed)\n\t\treturn false;\n\n\tneeded += ieee80211_he_mcs_nss_size(he_cap_ie_elem);\n\tif (len < needed)\n\t\treturn false;\n\n\tif (he_cap_ie_elem->phy_cap_info[6] &\n\t\t\tIEEE80211_HE_PHY_CAP6_PPE_THRESHOLD_PRESENT) {\n\t\tif (len < needed + 1)\n\t\t\treturn false;\n\t\tneeded += ieee80211_he_ppe_size(data[needed],\n\t\t\t\t\t\the_cap_ie_elem->phy_cap_info);\n\t}\n\n\treturn len >= needed;\n}\n\n \n#define IEEE80211_HE_OPERATION_DFLT_PE_DURATION_MASK\t\t0x00000007\n#define IEEE80211_HE_OPERATION_TWT_REQUIRED\t\t\t0x00000008\n#define IEEE80211_HE_OPERATION_RTS_THRESHOLD_MASK\t\t0x00003ff0\n#define IEEE80211_HE_OPERATION_RTS_THRESHOLD_OFFSET\t\t4\n#define IEEE80211_HE_OPERATION_VHT_OPER_INFO\t\t\t0x00004000\n#define IEEE80211_HE_OPERATION_CO_HOSTED_BSS\t\t\t0x00008000\n#define IEEE80211_HE_OPERATION_ER_SU_DISABLE\t\t\t0x00010000\n#define IEEE80211_HE_OPERATION_6GHZ_OP_INFO\t\t\t0x00020000\n#define IEEE80211_HE_OPERATION_BSS_COLOR_MASK\t\t\t0x3f000000\n#define IEEE80211_HE_OPERATION_BSS_COLOR_OFFSET\t\t\t24\n#define IEEE80211_HE_OPERATION_PARTIAL_BSS_COLOR\t\t0x40000000\n#define IEEE80211_HE_OPERATION_BSS_COLOR_DISABLED\t\t0x80000000\n\n#define IEEE80211_6GHZ_CTRL_REG_LPI_AP\t0\n#define IEEE80211_6GHZ_CTRL_REG_SP_AP\t1\n\n \nstruct ieee80211_he_6ghz_oper {\n\tu8 primary;\n#define IEEE80211_HE_6GHZ_OPER_CTRL_CHANWIDTH\t0x3\n#define\t\tIEEE80211_HE_6GHZ_OPER_CTRL_CHANWIDTH_20MHZ\t0\n#define\t\tIEEE80211_HE_6GHZ_OPER_CTRL_CHANWIDTH_40MHZ\t1\n#define\t\tIEEE80211_HE_6GHZ_OPER_CTRL_CHANWIDTH_80MHZ\t2\n#define\t\tIEEE80211_HE_6GHZ_OPER_CTRL_CHANWIDTH_160MHZ\t3\n#define IEEE80211_HE_6GHZ_OPER_CTRL_DUP_BEACON\t0x4\n#define IEEE80211_HE_6GHZ_OPER_CTRL_REG_INFO\t0x38\n\tu8 control;\n\tu8 ccfs0;\n\tu8 ccfs1;\n\tu8 minrate;\n} __packed;\n\n \n#define IEEE80211_TPE_MAX_IE_COUNT\t8\n \n#define IEEE80211_MAX_NUM_PWR_LEVEL\t8\n\n#define IEEE80211_TPE_MAX_POWER_COUNT\t8\n\n \nenum ieee80211_tx_power_intrpt_type {\n\tIEEE80211_TPE_LOCAL_EIRP,\n\tIEEE80211_TPE_LOCAL_EIRP_PSD,\n\tIEEE80211_TPE_REG_CLIENT_EIRP,\n\tIEEE80211_TPE_REG_CLIENT_EIRP_PSD,\n};\n\n \nstruct ieee80211_tx_pwr_env {\n\tu8 tx_power_info;\n\ts8 tx_power[IEEE80211_TPE_MAX_POWER_COUNT];\n} __packed;\n\n#define IEEE80211_TX_PWR_ENV_INFO_COUNT 0x7\n#define IEEE80211_TX_PWR_ENV_INFO_INTERPRET 0x38\n#define IEEE80211_TX_PWR_ENV_INFO_CATEGORY 0xC0\n\n \nstatic inline u8\nieee80211_he_oper_size(const u8 *he_oper_ie)\n{\n\tconst struct ieee80211_he_operation *he_oper = (const void *)he_oper_ie;\n\tu8 oper_len = sizeof(struct ieee80211_he_operation);\n\tu32 he_oper_params;\n\n\t \n\tif (!he_oper_ie)\n\t\treturn 0;\n\n\t \n\the_oper_params = le32_to_cpu(he_oper->he_oper_params);\n\tif (he_oper_params & IEEE80211_HE_OPERATION_VHT_OPER_INFO)\n\t\toper_len += 3;\n\tif (he_oper_params & IEEE80211_HE_OPERATION_CO_HOSTED_BSS)\n\t\toper_len++;\n\tif (he_oper_params & IEEE80211_HE_OPERATION_6GHZ_OP_INFO)\n\t\toper_len += sizeof(struct ieee80211_he_6ghz_oper);\n\n\t \n\toper_len++;\n\n\treturn oper_len;\n}\n\n \nstatic inline const struct ieee80211_he_6ghz_oper *\nieee80211_he_6ghz_oper(const struct ieee80211_he_operation *he_oper)\n{\n\tconst u8 *ret;\n\tu32 he_oper_params;\n\n\tif (!he_oper)\n\t\treturn NULL;\n\n\tret = (const void *)&he_oper->optional;\n\n\the_oper_params = le32_to_cpu(he_oper->he_oper_params);\n\n\tif (!(he_oper_params & IEEE80211_HE_OPERATION_6GHZ_OP_INFO))\n\t\treturn NULL;\n\tif (he_oper_params & IEEE80211_HE_OPERATION_VHT_OPER_INFO)\n\t\tret += 3;\n\tif (he_oper_params & IEEE80211_HE_OPERATION_CO_HOSTED_BSS)\n\t\tret++;\n\n\treturn (const void *)ret;\n}\n\n \n#define IEEE80211_HE_SPR_PSR_DISALLOWED\t\t\t\tBIT(0)\n#define IEEE80211_HE_SPR_NON_SRG_OBSS_PD_SR_DISALLOWED\t\tBIT(1)\n#define IEEE80211_HE_SPR_NON_SRG_OFFSET_PRESENT\t\t\tBIT(2)\n#define IEEE80211_HE_SPR_SRG_INFORMATION_PRESENT\t\tBIT(3)\n#define IEEE80211_HE_SPR_HESIGA_SR_VAL15_ALLOWED\t\tBIT(4)\n\n \nstatic inline u8\nieee80211_he_spr_size(const u8 *he_spr_ie)\n{\n\tconst struct ieee80211_he_spr *he_spr = (const void *)he_spr_ie;\n\tu8 spr_len = sizeof(struct ieee80211_he_spr);\n\tu8 he_spr_params;\n\n\t \n\tif (!he_spr_ie)\n\t\treturn 0;\n\n\t \n\the_spr_params = he_spr->he_sr_control;\n\tif (he_spr_params & IEEE80211_HE_SPR_NON_SRG_OFFSET_PRESENT)\n\t\tspr_len++;\n\tif (he_spr_params & IEEE80211_HE_SPR_SRG_INFORMATION_PRESENT)\n\t\tspr_len += 18;\n\n\t \n\tspr_len++;\n\n\treturn spr_len;\n}\n\n \n#define IEEE80211_S1G_CAPABILITY_LEN\t15\n\n#define S1G_CAP0_S1G_LONG\tBIT(0)\n#define S1G_CAP0_SGI_1MHZ\tBIT(1)\n#define S1G_CAP0_SGI_2MHZ\tBIT(2)\n#define S1G_CAP0_SGI_4MHZ\tBIT(3)\n#define S1G_CAP0_SGI_8MHZ\tBIT(4)\n#define S1G_CAP0_SGI_16MHZ\tBIT(5)\n#define S1G_CAP0_SUPP_CH_WIDTH\tGENMASK(7, 6)\n\n#define S1G_SUPP_CH_WIDTH_2\t0\n#define S1G_SUPP_CH_WIDTH_4\t1\n#define S1G_SUPP_CH_WIDTH_8\t2\n#define S1G_SUPP_CH_WIDTH_16\t3\n#define S1G_SUPP_CH_WIDTH_MAX(cap) ((1 << FIELD_GET(S1G_CAP0_SUPP_CH_WIDTH, \\\n\t\t\t\t\t\t    cap[0])) << 1)\n\n#define S1G_CAP1_RX_LDPC\tBIT(0)\n#define S1G_CAP1_TX_STBC\tBIT(1)\n#define S1G_CAP1_RX_STBC\tBIT(2)\n#define S1G_CAP1_SU_BFER\tBIT(3)\n#define S1G_CAP1_SU_BFEE\tBIT(4)\n#define S1G_CAP1_BFEE_STS\tGENMASK(7, 5)\n\n#define S1G_CAP2_SOUNDING_DIMENSIONS\tGENMASK(2, 0)\n#define S1G_CAP2_MU_BFER\t\tBIT(3)\n#define S1G_CAP2_MU_BFEE\t\tBIT(4)\n#define S1G_CAP2_PLUS_HTC_VHT\t\tBIT(5)\n#define S1G_CAP2_TRAVELING_PILOT\tGENMASK(7, 6)\n\n#define S1G_CAP3_RD_RESPONDER\t\tBIT(0)\n#define S1G_CAP3_HT_DELAYED_BA\t\tBIT(1)\n#define S1G_CAP3_MAX_MPDU_LEN\t\tBIT(2)\n#define S1G_CAP3_MAX_AMPDU_LEN_EXP\tGENMASK(4, 3)\n#define S1G_CAP3_MIN_MPDU_START\t\tGENMASK(7, 5)\n\n#define S1G_CAP4_UPLINK_SYNC\tBIT(0)\n#define S1G_CAP4_DYNAMIC_AID\tBIT(1)\n#define S1G_CAP4_BAT\t\tBIT(2)\n#define S1G_CAP4_TIME_ADE\tBIT(3)\n#define S1G_CAP4_NON_TIM\tBIT(4)\n#define S1G_CAP4_GROUP_AID\tBIT(5)\n#define S1G_CAP4_STA_TYPE\tGENMASK(7, 6)\n\n#define S1G_CAP5_CENT_AUTH_CONTROL\tBIT(0)\n#define S1G_CAP5_DIST_AUTH_CONTROL\tBIT(1)\n#define S1G_CAP5_AMSDU\t\t\tBIT(2)\n#define S1G_CAP5_AMPDU\t\t\tBIT(3)\n#define S1G_CAP5_ASYMMETRIC_BA\t\tBIT(4)\n#define S1G_CAP5_FLOW_CONTROL\t\tBIT(5)\n#define S1G_CAP5_SECTORIZED_BEAM\tGENMASK(7, 6)\n\n#define S1G_CAP6_OBSS_MITIGATION\tBIT(0)\n#define S1G_CAP6_FRAGMENT_BA\t\tBIT(1)\n#define S1G_CAP6_NDP_PS_POLL\t\tBIT(2)\n#define S1G_CAP6_RAW_OPERATION\t\tBIT(3)\n#define S1G_CAP6_PAGE_SLICING\t\tBIT(4)\n#define S1G_CAP6_TXOP_SHARING_IMP_ACK\tBIT(5)\n#define S1G_CAP6_VHT_LINK_ADAPT\t\tGENMASK(7, 6)\n\n#define S1G_CAP7_TACK_AS_PS_POLL\t\tBIT(0)\n#define S1G_CAP7_DUP_1MHZ\t\t\tBIT(1)\n#define S1G_CAP7_MCS_NEGOTIATION\t\tBIT(2)\n#define S1G_CAP7_1MHZ_CTL_RESPONSE_PREAMBLE\tBIT(3)\n#define S1G_CAP7_NDP_BFING_REPORT_POLL\t\tBIT(4)\n#define S1G_CAP7_UNSOLICITED_DYN_AID\t\tBIT(5)\n#define S1G_CAP7_SECTOR_TRAINING_OPERATION\tBIT(6)\n#define S1G_CAP7_TEMP_PS_MODE_SWITCH\t\tBIT(7)\n\n#define S1G_CAP8_TWT_GROUPING\tBIT(0)\n#define S1G_CAP8_BDT\t\tBIT(1)\n#define S1G_CAP8_COLOR\t\tGENMASK(4, 2)\n#define S1G_CAP8_TWT_REQUEST\tBIT(5)\n#define S1G_CAP8_TWT_RESPOND\tBIT(6)\n#define S1G_CAP8_PV1_FRAME\tBIT(7)\n\n#define S1G_CAP9_LINK_ADAPT_PER_CONTROL_RESPONSE BIT(0)\n\n#define S1G_OPER_CH_WIDTH_PRIMARY_1MHZ\tBIT(0)\n#define S1G_OPER_CH_WIDTH_OPER\t\tGENMASK(4, 1)\n\n \n#define IEEE80211_EHT_MAC_CAP0_EPCS_PRIO_ACCESS\t\t\t0x01\n#define IEEE80211_EHT_MAC_CAP0_OM_CONTROL\t\t\t0x02\n#define IEEE80211_EHT_MAC_CAP0_TRIG_TXOP_SHARING_MODE1\t\t0x04\n#define IEEE80211_EHT_MAC_CAP0_TRIG_TXOP_SHARING_MODE2\t\t0x08\n#define IEEE80211_EHT_MAC_CAP0_RESTRICTED_TWT\t\t\t0x10\n#define IEEE80211_EHT_MAC_CAP0_SCS_TRAFFIC_DESC\t\t\t0x20\n#define IEEE80211_EHT_MAC_CAP0_MAX_MPDU_LEN_MASK\t\t0xc0\n#define\tIEEE80211_EHT_MAC_CAP0_MAX_MPDU_LEN_3895\t        0\n#define\tIEEE80211_EHT_MAC_CAP0_MAX_MPDU_LEN_7991\t        1\n#define\tIEEE80211_EHT_MAC_CAP0_MAX_MPDU_LEN_11454\t        2\n\n#define IEEE80211_EHT_MAC_CAP1_MAX_AMPDU_LEN_MASK\t\t0x01\n\n \n#define IEEE80211_EHT_PHY_CAP0_320MHZ_IN_6GHZ\t\t\t0x02\n#define IEEE80211_EHT_PHY_CAP0_242_TONE_RU_GT20MHZ\t\t0x04\n#define IEEE80211_EHT_PHY_CAP0_NDP_4_EHT_LFT_32_GI\t\t0x08\n#define IEEE80211_EHT_PHY_CAP0_PARTIAL_BW_UL_MU_MIMO\t\t0x10\n#define IEEE80211_EHT_PHY_CAP0_SU_BEAMFORMER\t\t\t0x20\n#define IEEE80211_EHT_PHY_CAP0_SU_BEAMFORMEE\t\t\t0x40\n\n \n#define IEEE80211_EHT_PHY_CAP0_BEAMFORMEE_SS_80MHZ_MASK\t\t0x80\n#define IEEE80211_EHT_PHY_CAP1_BEAMFORMEE_SS_80MHZ_MASK\t\t0x03\n\n#define IEEE80211_EHT_PHY_CAP1_BEAMFORMEE_SS_160MHZ_MASK\t0x1c\n#define IEEE80211_EHT_PHY_CAP1_BEAMFORMEE_SS_320MHZ_MASK\t0xe0\n\n#define IEEE80211_EHT_PHY_CAP2_SOUNDING_DIM_80MHZ_MASK\t\t0x07\n#define IEEE80211_EHT_PHY_CAP2_SOUNDING_DIM_160MHZ_MASK\t\t0x38\n\n \n#define IEEE80211_EHT_PHY_CAP2_SOUNDING_DIM_320MHZ_MASK\t\t0xc0\n#define IEEE80211_EHT_PHY_CAP3_SOUNDING_DIM_320MHZ_MASK\t\t0x01\n#define IEEE80211_EHT_PHY_CAP3_NG_16_SU_FEEDBACK\t\t0x02\n#define IEEE80211_EHT_PHY_CAP3_NG_16_MU_FEEDBACK\t\t0x04\n#define IEEE80211_EHT_PHY_CAP3_CODEBOOK_4_2_SU_FDBK\t\t0x08\n#define IEEE80211_EHT_PHY_CAP3_CODEBOOK_7_5_MU_FDBK\t\t0x10\n#define IEEE80211_EHT_PHY_CAP3_TRIG_SU_BF_FDBK\t\t\t0x20\n#define IEEE80211_EHT_PHY_CAP3_TRIG_MU_BF_PART_BW_FDBK\t\t0x40\n#define IEEE80211_EHT_PHY_CAP3_TRIG_CQI_FDBK\t\t\t0x80\n\n#define IEEE80211_EHT_PHY_CAP4_PART_BW_DL_MU_MIMO\t\t0x01\n#define IEEE80211_EHT_PHY_CAP4_PSR_SR_SUPP\t\t\t0x02\n#define IEEE80211_EHT_PHY_CAP4_POWER_BOOST_FACT_SUPP\t\t0x04\n#define IEEE80211_EHT_PHY_CAP4_EHT_MU_PPDU_4_EHT_LTF_08_GI\t0x08\n#define IEEE80211_EHT_PHY_CAP4_MAX_NC_MASK\t\t\t0xf0\n\n#define IEEE80211_EHT_PHY_CAP5_NON_TRIG_CQI_FEEDBACK\t\t0x01\n#define IEEE80211_EHT_PHY_CAP5_TX_LESS_242_TONE_RU_SUPP\t\t0x02\n#define IEEE80211_EHT_PHY_CAP5_RX_LESS_242_TONE_RU_SUPP\t\t0x04\n#define IEEE80211_EHT_PHY_CAP5_PPE_THRESHOLD_PRESENT\t\t0x08\n#define IEEE80211_EHT_PHY_CAP5_COMMON_NOMINAL_PKT_PAD_MASK\t0x30\n#define   IEEE80211_EHT_PHY_CAP5_COMMON_NOMINAL_PKT_PAD_0US\t0\n#define   IEEE80211_EHT_PHY_CAP5_COMMON_NOMINAL_PKT_PAD_8US\t1\n#define   IEEE80211_EHT_PHY_CAP5_COMMON_NOMINAL_PKT_PAD_16US\t2\n#define   IEEE80211_EHT_PHY_CAP5_COMMON_NOMINAL_PKT_PAD_20US\t3\n\n \n#define IEEE80211_EHT_PHY_CAP5_MAX_NUM_SUPP_EHT_LTF_MASK\t0xc0\n#define IEEE80211_EHT_PHY_CAP5_SUPP_EXTRA_EHT_LTF\t\t0x40\n#define IEEE80211_EHT_PHY_CAP6_MAX_NUM_SUPP_EHT_LTF_MASK\t0x07\n\n#define IEEE80211_EHT_PHY_CAP6_MCS15_SUPP_MASK\t\t\t0x78\n#define IEEE80211_EHT_PHY_CAP6_EHT_DUP_6GHZ_SUPP\t\t0x80\n\n#define IEEE80211_EHT_PHY_CAP7_20MHZ_STA_RX_NDP_WIDER_BW\t0x01\n#define IEEE80211_EHT_PHY_CAP7_NON_OFDMA_UL_MU_MIMO_80MHZ\t0x02\n#define IEEE80211_EHT_PHY_CAP7_NON_OFDMA_UL_MU_MIMO_160MHZ\t0x04\n#define IEEE80211_EHT_PHY_CAP7_NON_OFDMA_UL_MU_MIMO_320MHZ\t0x08\n#define IEEE80211_EHT_PHY_CAP7_MU_BEAMFORMER_80MHZ\t\t0x10\n#define IEEE80211_EHT_PHY_CAP7_MU_BEAMFORMER_160MHZ\t\t0x20\n#define IEEE80211_EHT_PHY_CAP7_MU_BEAMFORMER_320MHZ\t\t0x40\n#define IEEE80211_EHT_PHY_CAP7_TB_SOUNDING_FDBK_RATE_LIMIT\t0x80\n\n#define IEEE80211_EHT_PHY_CAP8_RX_1024QAM_WIDER_BW_DL_OFDMA\t0x01\n#define IEEE80211_EHT_PHY_CAP8_RX_4096QAM_WIDER_BW_DL_OFDMA\t0x02\n\n \n#define IEEE80211_EHT_OPER_CHAN_WIDTH\t\t0x7\n#define IEEE80211_EHT_OPER_CHAN_WIDTH_20MHZ\t0\n#define IEEE80211_EHT_OPER_CHAN_WIDTH_40MHZ\t1\n#define IEEE80211_EHT_OPER_CHAN_WIDTH_80MHZ\t2\n#define IEEE80211_EHT_OPER_CHAN_WIDTH_160MHZ\t3\n#define IEEE80211_EHT_OPER_CHAN_WIDTH_320MHZ\t4\n\n \nstatic inline u8\nieee80211_eht_mcs_nss_size(const struct ieee80211_he_cap_elem *he_cap,\n\t\t\t   const struct ieee80211_eht_cap_elem_fixed *eht_cap,\n\t\t\t   bool from_ap)\n{\n\tu8 count = 0;\n\n\t \n\tif (he_cap->phy_cap_info[0] &\n\t    IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_IN_2G)\n\t\treturn 3;\n\n\t \n\tif (he_cap->phy_cap_info[0] &\n\t    IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_40MHZ_80MHZ_IN_5G)\n\t\tcount += 3;\n\n\tif (he_cap->phy_cap_info[0] &\n\t    IEEE80211_HE_PHY_CAP0_CHANNEL_WIDTH_SET_160MHZ_IN_5G)\n\t\tcount += 3;\n\n\tif (eht_cap->phy_cap_info[0] & IEEE80211_EHT_PHY_CAP0_320MHZ_IN_6GHZ)\n\t\tcount += 3;\n\n\tif (count)\n\t\treturn count;\n\n\treturn from_ap ? 3 : 4;\n}\n\n \n#define IEEE80211_EHT_PPE_THRES_NSS_POS\t\t\t0\n#define IEEE80211_EHT_PPE_THRES_NSS_MASK\t\t0xf\n#define IEEE80211_EHT_PPE_THRES_RU_INDEX_BITMASK_MASK\t0x1f0\n#define IEEE80211_EHT_PPE_THRES_INFO_PPET_SIZE\t\t3\n#define IEEE80211_EHT_PPE_THRES_INFO_HEADER_SIZE\t9\n\n \nstatic inline u8\nieee80211_eht_ppe_size(u16 ppe_thres_hdr, const u8 *phy_cap_info)\n{\n\tu32 n;\n\n\tif (!(phy_cap_info[5] &\n\t      IEEE80211_EHT_PHY_CAP5_PPE_THRESHOLD_PRESENT))\n\t\treturn 0;\n\n\tn = hweight16(ppe_thres_hdr &\n\t\t      IEEE80211_EHT_PPE_THRES_RU_INDEX_BITMASK_MASK);\n\tn *= 1 + u16_get_bits(ppe_thres_hdr, IEEE80211_EHT_PPE_THRES_NSS_MASK);\n\n\t \n\tn = n * IEEE80211_EHT_PPE_THRES_INFO_PPET_SIZE * 2 +\n\t    IEEE80211_EHT_PPE_THRES_INFO_HEADER_SIZE;\n\treturn DIV_ROUND_UP(n, 8);\n}\n\nstatic inline bool\nieee80211_eht_capa_size_ok(const u8 *he_capa, const u8 *data, u8 len,\n\t\t\t   bool from_ap)\n{\n\tconst struct ieee80211_eht_cap_elem_fixed *elem = (const void *)data;\n\tu8 needed = sizeof(struct ieee80211_eht_cap_elem_fixed);\n\n\tif (len < needed || !he_capa)\n\t\treturn false;\n\n\tneeded += ieee80211_eht_mcs_nss_size((const void *)he_capa,\n\t\t\t\t\t     (const void *)data,\n\t\t\t\t\t     from_ap);\n\tif (len < needed)\n\t\treturn false;\n\n\tif (elem->phy_cap_info[5] &\n\t\t\tIEEE80211_EHT_PHY_CAP5_PPE_THRESHOLD_PRESENT) {\n\t\tu16 ppe_thres_hdr;\n\n\t\tif (len < needed + sizeof(ppe_thres_hdr))\n\t\t\treturn false;\n\n\t\tppe_thres_hdr = get_unaligned_le16(data + needed);\n\t\tneeded += ieee80211_eht_ppe_size(ppe_thres_hdr,\n\t\t\t\t\t\t elem->phy_cap_info);\n\t}\n\n\treturn len >= needed;\n}\n\nstatic inline bool\nieee80211_eht_oper_size_ok(const u8 *data, u8 len)\n{\n\tconst struct ieee80211_eht_operation *elem = (const void *)data;\n\tu8 needed = sizeof(*elem);\n\n\tif (len < needed)\n\t\treturn false;\n\n\tif (elem->params & IEEE80211_EHT_OPER_INFO_PRESENT) {\n\t\tneeded += 3;\n\n\t\tif (elem->params &\n\t\t    IEEE80211_EHT_OPER_DISABLED_SUBCHANNEL_BITMAP_PRESENT)\n\t\t\tneeded += 2;\n\t}\n\n\treturn len >= needed;\n}\n\n#define LISTEN_INT_USF\tGENMASK(15, 14)\n#define LISTEN_INT_UI\tGENMASK(13, 0)\n\n#define IEEE80211_MAX_USF\tFIELD_MAX(LISTEN_INT_USF)\n#define IEEE80211_MAX_UI\tFIELD_MAX(LISTEN_INT_UI)\n\n \n#define WLAN_AUTH_OPEN 0\n#define WLAN_AUTH_SHARED_KEY 1\n#define WLAN_AUTH_FT 2\n#define WLAN_AUTH_SAE 3\n#define WLAN_AUTH_FILS_SK 4\n#define WLAN_AUTH_FILS_SK_PFS 5\n#define WLAN_AUTH_FILS_PK 6\n#define WLAN_AUTH_LEAP 128\n\n#define WLAN_AUTH_CHALLENGE_LEN 128\n\n#define WLAN_CAPABILITY_ESS\t\t(1<<0)\n#define WLAN_CAPABILITY_IBSS\t\t(1<<1)\n\n \n#define WLAN_CAPABILITY_IS_STA_BSS(cap)\t\\\n\t(!((cap) & (WLAN_CAPABILITY_ESS | WLAN_CAPABILITY_IBSS)))\n\n#define WLAN_CAPABILITY_CF_POLLABLE\t(1<<2)\n#define WLAN_CAPABILITY_CF_POLL_REQUEST\t(1<<3)\n#define WLAN_CAPABILITY_PRIVACY\t\t(1<<4)\n#define WLAN_CAPABILITY_SHORT_PREAMBLE\t(1<<5)\n#define WLAN_CAPABILITY_PBCC\t\t(1<<6)\n#define WLAN_CAPABILITY_CHANNEL_AGILITY\t(1<<7)\n\n \n#define WLAN_CAPABILITY_SPECTRUM_MGMT\t(1<<8)\n#define WLAN_CAPABILITY_QOS\t\t(1<<9)\n#define WLAN_CAPABILITY_SHORT_SLOT_TIME\t(1<<10)\n#define WLAN_CAPABILITY_APSD\t\t(1<<11)\n#define WLAN_CAPABILITY_RADIO_MEASURE\t(1<<12)\n#define WLAN_CAPABILITY_DSSS_OFDM\t(1<<13)\n#define WLAN_CAPABILITY_DEL_BACK\t(1<<14)\n#define WLAN_CAPABILITY_IMM_BACK\t(1<<15)\n\n \n \n#define WLAN_CAPABILITY_DMG_TYPE_MASK\t\t(3<<0)\n#define WLAN_CAPABILITY_DMG_TYPE_IBSS\t\t(1<<0)  \n#define WLAN_CAPABILITY_DMG_TYPE_PBSS\t\t(2<<0)  \n#define WLAN_CAPABILITY_DMG_TYPE_AP\t\t(3<<0)  \n\n#define WLAN_CAPABILITY_DMG_CBAP_ONLY\t\t(1<<2)\n#define WLAN_CAPABILITY_DMG_CBAP_SOURCE\t\t(1<<3)\n#define WLAN_CAPABILITY_DMG_PRIVACY\t\t(1<<4)\n#define WLAN_CAPABILITY_DMG_ECPAC\t\t(1<<5)\n\n#define WLAN_CAPABILITY_DMG_SPECTRUM_MGMT\t(1<<8)\n#define WLAN_CAPABILITY_DMG_RADIO_MEASURE\t(1<<12)\n\n \n#define IEEE80211_SPCT_MSR_RPRT_MODE_LATE\t(1<<0)\n#define IEEE80211_SPCT_MSR_RPRT_MODE_INCAPABLE\t(1<<1)\n#define IEEE80211_SPCT_MSR_RPRT_MODE_REFUSED\t(1<<2)\n\n#define IEEE80211_SPCT_MSR_RPRT_TYPE_BASIC\t0\n#define IEEE80211_SPCT_MSR_RPRT_TYPE_CCA\t1\n#define IEEE80211_SPCT_MSR_RPRT_TYPE_RPI\t2\n#define IEEE80211_SPCT_MSR_RPRT_TYPE_LCI\t8\n#define IEEE80211_SPCT_MSR_RPRT_TYPE_CIVIC\t11\n\n \n#define WLAN_ERP_NON_ERP_PRESENT (1<<0)\n#define WLAN_ERP_USE_PROTECTION (1<<1)\n#define WLAN_ERP_BARKER_PREAMBLE (1<<2)\n\n \nenum {\n\tWLAN_ERP_PREAMBLE_SHORT = 0,\n\tWLAN_ERP_PREAMBLE_LONG = 1,\n};\n\n \nenum {\n\tIEEE80211_BANDID_TV_WS = 0,  \n\tIEEE80211_BANDID_SUB1  = 1,  \n\tIEEE80211_BANDID_2G    = 2,  \n\tIEEE80211_BANDID_3G    = 3,  \n\tIEEE80211_BANDID_5G    = 4,  \n\tIEEE80211_BANDID_60G   = 5,  \n};\n\n \nenum ieee80211_statuscode {\n\tWLAN_STATUS_SUCCESS = 0,\n\tWLAN_STATUS_UNSPECIFIED_FAILURE = 1,\n\tWLAN_STATUS_CAPS_UNSUPPORTED = 10,\n\tWLAN_STATUS_REASSOC_NO_ASSOC = 11,\n\tWLAN_STATUS_ASSOC_DENIED_UNSPEC = 12,\n\tWLAN_STATUS_NOT_SUPPORTED_AUTH_ALG = 13,\n\tWLAN_STATUS_UNKNOWN_AUTH_TRANSACTION = 14,\n\tWLAN_STATUS_CHALLENGE_FAIL = 15,\n\tWLAN_STATUS_AUTH_TIMEOUT = 16,\n\tWLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA = 17,\n\tWLAN_STATUS_ASSOC_DENIED_RATES = 18,\n\t \n\tWLAN_STATUS_ASSOC_DENIED_NOSHORTPREAMBLE = 19,\n\tWLAN_STATUS_ASSOC_DENIED_NOPBCC = 20,\n\tWLAN_STATUS_ASSOC_DENIED_NOAGILITY = 21,\n\t \n\tWLAN_STATUS_ASSOC_DENIED_NOSPECTRUM = 22,\n\tWLAN_STATUS_ASSOC_REJECTED_BAD_POWER = 23,\n\tWLAN_STATUS_ASSOC_REJECTED_BAD_SUPP_CHAN = 24,\n\t \n\tWLAN_STATUS_ASSOC_DENIED_NOSHORTTIME = 25,\n\tWLAN_STATUS_ASSOC_DENIED_NODSSSOFDM = 26,\n\t \n\tWLAN_STATUS_ASSOC_REJECTED_TEMPORARILY = 30,\n\tWLAN_STATUS_ROBUST_MGMT_FRAME_POLICY_VIOLATION = 31,\n\t \n\tWLAN_STATUS_INVALID_IE = 40,\n\tWLAN_STATUS_INVALID_GROUP_CIPHER = 41,\n\tWLAN_STATUS_INVALID_PAIRWISE_CIPHER = 42,\n\tWLAN_STATUS_INVALID_AKMP = 43,\n\tWLAN_STATUS_UNSUPP_RSN_VERSION = 44,\n\tWLAN_STATUS_INVALID_RSN_IE_CAP = 45,\n\tWLAN_STATUS_CIPHER_SUITE_REJECTED = 46,\n\t \n\tWLAN_STATUS_UNSPECIFIED_QOS = 32,\n\tWLAN_STATUS_ASSOC_DENIED_NOBANDWIDTH = 33,\n\tWLAN_STATUS_ASSOC_DENIED_LOWACK = 34,\n\tWLAN_STATUS_ASSOC_DENIED_UNSUPP_QOS = 35,\n\tWLAN_STATUS_REQUEST_DECLINED = 37,\n\tWLAN_STATUS_INVALID_QOS_PARAM = 38,\n\tWLAN_STATUS_CHANGE_TSPEC = 39,\n\tWLAN_STATUS_WAIT_TS_DELAY = 47,\n\tWLAN_STATUS_NO_DIRECT_LINK = 48,\n\tWLAN_STATUS_STA_NOT_PRESENT = 49,\n\tWLAN_STATUS_STA_NOT_QSTA = 50,\n\t \n\tWLAN_STATUS_ANTI_CLOG_REQUIRED = 76,\n\tWLAN_STATUS_FCG_NOT_SUPP = 78,\n\tWLAN_STATUS_STA_NO_TBTT = 78,\n\t \n\tWLAN_STATUS_REJECTED_WITH_SUGGESTED_CHANGES = 39,\n\tWLAN_STATUS_REJECTED_FOR_DELAY_PERIOD = 47,\n\tWLAN_STATUS_REJECT_WITH_SCHEDULE = 83,\n\tWLAN_STATUS_PENDING_ADMITTING_FST_SESSION = 86,\n\tWLAN_STATUS_PERFORMING_FST_NOW = 87,\n\tWLAN_STATUS_PENDING_GAP_IN_BA_WINDOW = 88,\n\tWLAN_STATUS_REJECT_U_PID_SETTING = 89,\n\tWLAN_STATUS_REJECT_DSE_BAND = 96,\n\tWLAN_STATUS_DENIED_WITH_SUGGESTED_BAND_AND_CHANNEL = 99,\n\tWLAN_STATUS_DENIED_DUE_TO_SPECTRUM_MANAGEMENT = 103,\n\t \n\tWLAN_STATUS_FILS_AUTHENTICATION_FAILURE = 108,\n\tWLAN_STATUS_UNKNOWN_AUTHENTICATION_SERVER = 109,\n\tWLAN_STATUS_SAE_HASH_TO_ELEMENT = 126,\n\tWLAN_STATUS_SAE_PK = 127,\n};\n\n\n \nenum ieee80211_reasoncode {\n\tWLAN_REASON_UNSPECIFIED = 1,\n\tWLAN_REASON_PREV_AUTH_NOT_VALID = 2,\n\tWLAN_REASON_DEAUTH_LEAVING = 3,\n\tWLAN_REASON_DISASSOC_DUE_TO_INACTIVITY = 4,\n\tWLAN_REASON_DISASSOC_AP_BUSY = 5,\n\tWLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA = 6,\n\tWLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA = 7,\n\tWLAN_REASON_DISASSOC_STA_HAS_LEFT = 8,\n\tWLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH = 9,\n\t \n\tWLAN_REASON_DISASSOC_BAD_POWER = 10,\n\tWLAN_REASON_DISASSOC_BAD_SUPP_CHAN = 11,\n\t \n\tWLAN_REASON_INVALID_IE = 13,\n\tWLAN_REASON_MIC_FAILURE = 14,\n\tWLAN_REASON_4WAY_HANDSHAKE_TIMEOUT = 15,\n\tWLAN_REASON_GROUP_KEY_HANDSHAKE_TIMEOUT = 16,\n\tWLAN_REASON_IE_DIFFERENT = 17,\n\tWLAN_REASON_INVALID_GROUP_CIPHER = 18,\n\tWLAN_REASON_INVALID_PAIRWISE_CIPHER = 19,\n\tWLAN_REASON_INVALID_AKMP = 20,\n\tWLAN_REASON_UNSUPP_RSN_VERSION = 21,\n\tWLAN_REASON_INVALID_RSN_IE_CAP = 22,\n\tWLAN_REASON_IEEE8021X_FAILED = 23,\n\tWLAN_REASON_CIPHER_SUITE_REJECTED = 24,\n\t \n\tWLAN_REASON_TDLS_TEARDOWN_UNREACHABLE = 25,\n\tWLAN_REASON_TDLS_TEARDOWN_UNSPECIFIED = 26,\n\t \n\tWLAN_REASON_DISASSOC_UNSPECIFIED_QOS = 32,\n\tWLAN_REASON_DISASSOC_QAP_NO_BANDWIDTH = 33,\n\tWLAN_REASON_DISASSOC_LOW_ACK = 34,\n\tWLAN_REASON_DISASSOC_QAP_EXCEED_TXOP = 35,\n\tWLAN_REASON_QSTA_LEAVE_QBSS = 36,\n\tWLAN_REASON_QSTA_NOT_USE = 37,\n\tWLAN_REASON_QSTA_REQUIRE_SETUP = 38,\n\tWLAN_REASON_QSTA_TIMEOUT = 39,\n\tWLAN_REASON_QSTA_CIPHER_NOT_SUPP = 45,\n\t \n\tWLAN_REASON_MESH_PEER_CANCELED = 52,\n\tWLAN_REASON_MESH_MAX_PEERS = 53,\n\tWLAN_REASON_MESH_CONFIG = 54,\n\tWLAN_REASON_MESH_CLOSE = 55,\n\tWLAN_REASON_MESH_MAX_RETRIES = 56,\n\tWLAN_REASON_MESH_CONFIRM_TIMEOUT = 57,\n\tWLAN_REASON_MESH_INVALID_GTK = 58,\n\tWLAN_REASON_MESH_INCONSISTENT_PARAM = 59,\n\tWLAN_REASON_MESH_INVALID_SECURITY = 60,\n\tWLAN_REASON_MESH_PATH_ERROR = 61,\n\tWLAN_REASON_MESH_PATH_NOFORWARD = 62,\n\tWLAN_REASON_MESH_PATH_DEST_UNREACHABLE = 63,\n\tWLAN_REASON_MAC_EXISTS_IN_MBSS = 64,\n\tWLAN_REASON_MESH_CHAN_REGULATORY = 65,\n\tWLAN_REASON_MESH_CHAN = 66,\n};\n\n\n \nenum ieee80211_eid {\n\tWLAN_EID_SSID = 0,\n\tWLAN_EID_SUPP_RATES = 1,\n\tWLAN_EID_FH_PARAMS = 2,  \n\tWLAN_EID_DS_PARAMS = 3,\n\tWLAN_EID_CF_PARAMS = 4,\n\tWLAN_EID_TIM = 5,\n\tWLAN_EID_IBSS_PARAMS = 6,\n\tWLAN_EID_COUNTRY = 7,\n\t \n\tWLAN_EID_REQUEST = 10,\n\tWLAN_EID_QBSS_LOAD = 11,\n\tWLAN_EID_EDCA_PARAM_SET = 12,\n\tWLAN_EID_TSPEC = 13,\n\tWLAN_EID_TCLAS = 14,\n\tWLAN_EID_SCHEDULE = 15,\n\tWLAN_EID_CHALLENGE = 16,\n\t \n\tWLAN_EID_PWR_CONSTRAINT = 32,\n\tWLAN_EID_PWR_CAPABILITY = 33,\n\tWLAN_EID_TPC_REQUEST = 34,\n\tWLAN_EID_TPC_REPORT = 35,\n\tWLAN_EID_SUPPORTED_CHANNELS = 36,\n\tWLAN_EID_CHANNEL_SWITCH = 37,\n\tWLAN_EID_MEASURE_REQUEST = 38,\n\tWLAN_EID_MEASURE_REPORT = 39,\n\tWLAN_EID_QUIET = 40,\n\tWLAN_EID_IBSS_DFS = 41,\n\tWLAN_EID_ERP_INFO = 42,\n\tWLAN_EID_TS_DELAY = 43,\n\tWLAN_EID_TCLAS_PROCESSING = 44,\n\tWLAN_EID_HT_CAPABILITY = 45,\n\tWLAN_EID_QOS_CAPA = 46,\n\t \n\tWLAN_EID_RSN = 48,\n\tWLAN_EID_802_15_COEX = 49,\n\tWLAN_EID_EXT_SUPP_RATES = 50,\n\tWLAN_EID_AP_CHAN_REPORT = 51,\n\tWLAN_EID_NEIGHBOR_REPORT = 52,\n\tWLAN_EID_RCPI = 53,\n\tWLAN_EID_MOBILITY_DOMAIN = 54,\n\tWLAN_EID_FAST_BSS_TRANSITION = 55,\n\tWLAN_EID_TIMEOUT_INTERVAL = 56,\n\tWLAN_EID_RIC_DATA = 57,\n\tWLAN_EID_DSE_REGISTERED_LOCATION = 58,\n\tWLAN_EID_SUPPORTED_REGULATORY_CLASSES = 59,\n\tWLAN_EID_EXT_CHANSWITCH_ANN = 60,\n\tWLAN_EID_HT_OPERATION = 61,\n\tWLAN_EID_SECONDARY_CHANNEL_OFFSET = 62,\n\tWLAN_EID_BSS_AVG_ACCESS_DELAY = 63,\n\tWLAN_EID_ANTENNA_INFO = 64,\n\tWLAN_EID_RSNI = 65,\n\tWLAN_EID_MEASUREMENT_PILOT_TX_INFO = 66,\n\tWLAN_EID_BSS_AVAILABLE_CAPACITY = 67,\n\tWLAN_EID_BSS_AC_ACCESS_DELAY = 68,\n\tWLAN_EID_TIME_ADVERTISEMENT = 69,\n\tWLAN_EID_RRM_ENABLED_CAPABILITIES = 70,\n\tWLAN_EID_MULTIPLE_BSSID = 71,\n\tWLAN_EID_BSS_COEX_2040 = 72,\n\tWLAN_EID_BSS_INTOLERANT_CHL_REPORT = 73,\n\tWLAN_EID_OVERLAP_BSS_SCAN_PARAM = 74,\n\tWLAN_EID_RIC_DESCRIPTOR = 75,\n\tWLAN_EID_MMIE = 76,\n\tWLAN_EID_ASSOC_COMEBACK_TIME = 77,\n\tWLAN_EID_EVENT_REQUEST = 78,\n\tWLAN_EID_EVENT_REPORT = 79,\n\tWLAN_EID_DIAGNOSTIC_REQUEST = 80,\n\tWLAN_EID_DIAGNOSTIC_REPORT = 81,\n\tWLAN_EID_LOCATION_PARAMS = 82,\n\tWLAN_EID_NON_TX_BSSID_CAP =  83,\n\tWLAN_EID_SSID_LIST = 84,\n\tWLAN_EID_MULTI_BSSID_IDX = 85,\n\tWLAN_EID_FMS_DESCRIPTOR = 86,\n\tWLAN_EID_FMS_REQUEST = 87,\n\tWLAN_EID_FMS_RESPONSE = 88,\n\tWLAN_EID_QOS_TRAFFIC_CAPA = 89,\n\tWLAN_EID_BSS_MAX_IDLE_PERIOD = 90,\n\tWLAN_EID_TSF_REQUEST = 91,\n\tWLAN_EID_TSF_RESPOSNE = 92,\n\tWLAN_EID_WNM_SLEEP_MODE = 93,\n\tWLAN_EID_TIM_BCAST_REQ = 94,\n\tWLAN_EID_TIM_BCAST_RESP = 95,\n\tWLAN_EID_COLL_IF_REPORT = 96,\n\tWLAN_EID_CHANNEL_USAGE = 97,\n\tWLAN_EID_TIME_ZONE = 98,\n\tWLAN_EID_DMS_REQUEST = 99,\n\tWLAN_EID_DMS_RESPONSE = 100,\n\tWLAN_EID_LINK_ID = 101,\n\tWLAN_EID_WAKEUP_SCHEDUL = 102,\n\t \n\tWLAN_EID_CHAN_SWITCH_TIMING = 104,\n\tWLAN_EID_PTI_CONTROL = 105,\n\tWLAN_EID_PU_BUFFER_STATUS = 106,\n\tWLAN_EID_INTERWORKING = 107,\n\tWLAN_EID_ADVERTISEMENT_PROTOCOL = 108,\n\tWLAN_EID_EXPEDITED_BW_REQ = 109,\n\tWLAN_EID_QOS_MAP_SET = 110,\n\tWLAN_EID_ROAMING_CONSORTIUM = 111,\n\tWLAN_EID_EMERGENCY_ALERT = 112,\n\tWLAN_EID_MESH_CONFIG = 113,\n\tWLAN_EID_MESH_ID = 114,\n\tWLAN_EID_LINK_METRIC_REPORT = 115,\n\tWLAN_EID_CONGESTION_NOTIFICATION = 116,\n\tWLAN_EID_PEER_MGMT = 117,\n\tWLAN_EID_CHAN_SWITCH_PARAM = 118,\n\tWLAN_EID_MESH_AWAKE_WINDOW = 119,\n\tWLAN_EID_BEACON_TIMING = 120,\n\tWLAN_EID_MCCAOP_SETUP_REQ = 121,\n\tWLAN_EID_MCCAOP_SETUP_RESP = 122,\n\tWLAN_EID_MCCAOP_ADVERT = 123,\n\tWLAN_EID_MCCAOP_TEARDOWN = 124,\n\tWLAN_EID_GANN = 125,\n\tWLAN_EID_RANN = 126,\n\tWLAN_EID_EXT_CAPABILITY = 127,\n\t \n\tWLAN_EID_PREQ = 130,\n\tWLAN_EID_PREP = 131,\n\tWLAN_EID_PERR = 132,\n\t \n\tWLAN_EID_PXU = 137,\n\tWLAN_EID_PXUC = 138,\n\tWLAN_EID_AUTH_MESH_PEER_EXCH = 139,\n\tWLAN_EID_MIC = 140,\n\tWLAN_EID_DESTINATION_URI = 141,\n\tWLAN_EID_UAPSD_COEX = 142,\n\tWLAN_EID_WAKEUP_SCHEDULE = 143,\n\tWLAN_EID_EXT_SCHEDULE = 144,\n\tWLAN_EID_STA_AVAILABILITY = 145,\n\tWLAN_EID_DMG_TSPEC = 146,\n\tWLAN_EID_DMG_AT = 147,\n\tWLAN_EID_DMG_CAP = 148,\n\t \n\tWLAN_EID_CISCO_VENDOR_SPECIFIC = 150,\n\tWLAN_EID_DMG_OPERATION = 151,\n\tWLAN_EID_DMG_BSS_PARAM_CHANGE = 152,\n\tWLAN_EID_DMG_BEAM_REFINEMENT = 153,\n\tWLAN_EID_CHANNEL_MEASURE_FEEDBACK = 154,\n\t \n\tWLAN_EID_AWAKE_WINDOW = 157,\n\tWLAN_EID_MULTI_BAND = 158,\n\tWLAN_EID_ADDBA_EXT = 159,\n\tWLAN_EID_NEXT_PCP_LIST = 160,\n\tWLAN_EID_PCP_HANDOVER = 161,\n\tWLAN_EID_DMG_LINK_MARGIN = 162,\n\tWLAN_EID_SWITCHING_STREAM = 163,\n\tWLAN_EID_SESSION_TRANSITION = 164,\n\tWLAN_EID_DYN_TONE_PAIRING_REPORT = 165,\n\tWLAN_EID_CLUSTER_REPORT = 166,\n\tWLAN_EID_RELAY_CAP = 167,\n\tWLAN_EID_RELAY_XFER_PARAM_SET = 168,\n\tWLAN_EID_BEAM_LINK_MAINT = 169,\n\tWLAN_EID_MULTIPLE_MAC_ADDR = 170,\n\tWLAN_EID_U_PID = 171,\n\tWLAN_EID_DMG_LINK_ADAPT_ACK = 172,\n\t \n\tWLAN_EID_MCCAOP_ADV_OVERVIEW = 174,\n\tWLAN_EID_QUIET_PERIOD_REQ = 175,\n\t \n\tWLAN_EID_QUIET_PERIOD_RESP = 177,\n\t \n\t \n\tWLAN_EID_EPAC_POLICY = 182,\n\tWLAN_EID_CLISTER_TIME_OFF = 183,\n\tWLAN_EID_INTER_AC_PRIO = 184,\n\tWLAN_EID_SCS_DESCRIPTOR = 185,\n\tWLAN_EID_QLOAD_REPORT = 186,\n\tWLAN_EID_HCCA_TXOP_UPDATE_COUNT = 187,\n\tWLAN_EID_HL_STREAM_ID = 188,\n\tWLAN_EID_GCR_GROUP_ADDR = 189,\n\tWLAN_EID_ANTENNA_SECTOR_ID_PATTERN = 190,\n\tWLAN_EID_VHT_CAPABILITY = 191,\n\tWLAN_EID_VHT_OPERATION = 192,\n\tWLAN_EID_EXTENDED_BSS_LOAD = 193,\n\tWLAN_EID_WIDE_BW_CHANNEL_SWITCH = 194,\n\tWLAN_EID_TX_POWER_ENVELOPE = 195,\n\tWLAN_EID_CHANNEL_SWITCH_WRAPPER = 196,\n\tWLAN_EID_AID = 197,\n\tWLAN_EID_QUIET_CHANNEL = 198,\n\tWLAN_EID_OPMODE_NOTIF = 199,\n\n\tWLAN_EID_REDUCED_NEIGHBOR_REPORT = 201,\n\n\tWLAN_EID_AID_REQUEST = 210,\n\tWLAN_EID_AID_RESPONSE = 211,\n\tWLAN_EID_S1G_BCN_COMPAT = 213,\n\tWLAN_EID_S1G_SHORT_BCN_INTERVAL = 214,\n\tWLAN_EID_S1G_TWT = 216,\n\tWLAN_EID_S1G_CAPABILITIES = 217,\n\tWLAN_EID_VENDOR_SPECIFIC = 221,\n\tWLAN_EID_QOS_PARAMETER = 222,\n\tWLAN_EID_S1G_OPERATION = 232,\n\tWLAN_EID_CAG_NUMBER = 237,\n\tWLAN_EID_AP_CSN = 239,\n\tWLAN_EID_FILS_INDICATION = 240,\n\tWLAN_EID_DILS = 241,\n\tWLAN_EID_FRAGMENT = 242,\n\tWLAN_EID_RSNX = 244,\n\tWLAN_EID_EXTENSION = 255\n};\n\n \nenum ieee80211_eid_ext {\n\tWLAN_EID_EXT_ASSOC_DELAY_INFO = 1,\n\tWLAN_EID_EXT_FILS_REQ_PARAMS = 2,\n\tWLAN_EID_EXT_FILS_KEY_CONFIRM = 3,\n\tWLAN_EID_EXT_FILS_SESSION = 4,\n\tWLAN_EID_EXT_FILS_HLP_CONTAINER = 5,\n\tWLAN_EID_EXT_FILS_IP_ADDR_ASSIGN = 6,\n\tWLAN_EID_EXT_KEY_DELIVERY = 7,\n\tWLAN_EID_EXT_FILS_WRAPPED_DATA = 8,\n\tWLAN_EID_EXT_FILS_PUBLIC_KEY = 12,\n\tWLAN_EID_EXT_FILS_NONCE = 13,\n\tWLAN_EID_EXT_FUTURE_CHAN_GUIDANCE = 14,\n\tWLAN_EID_EXT_HE_CAPABILITY = 35,\n\tWLAN_EID_EXT_HE_OPERATION = 36,\n\tWLAN_EID_EXT_UORA = 37,\n\tWLAN_EID_EXT_HE_MU_EDCA = 38,\n\tWLAN_EID_EXT_HE_SPR = 39,\n\tWLAN_EID_EXT_NDP_FEEDBACK_REPORT_PARAMSET = 41,\n\tWLAN_EID_EXT_BSS_COLOR_CHG_ANN = 42,\n\tWLAN_EID_EXT_QUIET_TIME_PERIOD_SETUP = 43,\n\tWLAN_EID_EXT_ESS_REPORT = 45,\n\tWLAN_EID_EXT_OPS = 46,\n\tWLAN_EID_EXT_HE_BSS_LOAD = 47,\n\tWLAN_EID_EXT_MAX_CHANNEL_SWITCH_TIME = 52,\n\tWLAN_EID_EXT_MULTIPLE_BSSID_CONFIGURATION = 55,\n\tWLAN_EID_EXT_NON_INHERITANCE = 56,\n\tWLAN_EID_EXT_KNOWN_BSSID = 57,\n\tWLAN_EID_EXT_SHORT_SSID_LIST = 58,\n\tWLAN_EID_EXT_HE_6GHZ_CAPA = 59,\n\tWLAN_EID_EXT_UL_MU_POWER_CAPA = 60,\n\tWLAN_EID_EXT_EHT_OPERATION = 106,\n\tWLAN_EID_EXT_EHT_MULTI_LINK = 107,\n\tWLAN_EID_EXT_EHT_CAPABILITY = 108,\n};\n\n \nenum ieee80211_category {\n\tWLAN_CATEGORY_SPECTRUM_MGMT = 0,\n\tWLAN_CATEGORY_QOS = 1,\n\tWLAN_CATEGORY_DLS = 2,\n\tWLAN_CATEGORY_BACK = 3,\n\tWLAN_CATEGORY_PUBLIC = 4,\n\tWLAN_CATEGORY_RADIO_MEASUREMENT = 5,\n\tWLAN_CATEGORY_FAST_BBS_TRANSITION = 6,\n\tWLAN_CATEGORY_HT = 7,\n\tWLAN_CATEGORY_SA_QUERY = 8,\n\tWLAN_CATEGORY_PROTECTED_DUAL_OF_ACTION = 9,\n\tWLAN_CATEGORY_WNM = 10,\n\tWLAN_CATEGORY_WNM_UNPROTECTED = 11,\n\tWLAN_CATEGORY_TDLS = 12,\n\tWLAN_CATEGORY_MESH_ACTION = 13,\n\tWLAN_CATEGORY_MULTIHOP_ACTION = 14,\n\tWLAN_CATEGORY_SELF_PROTECTED = 15,\n\tWLAN_CATEGORY_DMG = 16,\n\tWLAN_CATEGORY_WMM = 17,\n\tWLAN_CATEGORY_FST = 18,\n\tWLAN_CATEGORY_UNPROT_DMG = 20,\n\tWLAN_CATEGORY_VHT = 21,\n\tWLAN_CATEGORY_S1G = 22,\n\tWLAN_CATEGORY_VENDOR_SPECIFIC_PROTECTED = 126,\n\tWLAN_CATEGORY_VENDOR_SPECIFIC = 127,\n};\n\n \nenum ieee80211_spectrum_mgmt_actioncode {\n\tWLAN_ACTION_SPCT_MSR_REQ = 0,\n\tWLAN_ACTION_SPCT_MSR_RPRT = 1,\n\tWLAN_ACTION_SPCT_TPC_REQ = 2,\n\tWLAN_ACTION_SPCT_TPC_RPRT = 3,\n\tWLAN_ACTION_SPCT_CHL_SWITCH = 4,\n};\n\n \nenum ieee80211_ht_actioncode {\n\tWLAN_HT_ACTION_NOTIFY_CHANWIDTH = 0,\n\tWLAN_HT_ACTION_SMPS = 1,\n\tWLAN_HT_ACTION_PSMP = 2,\n\tWLAN_HT_ACTION_PCO_PHASE = 3,\n\tWLAN_HT_ACTION_CSI = 4,\n\tWLAN_HT_ACTION_NONCOMPRESSED_BF = 5,\n\tWLAN_HT_ACTION_COMPRESSED_BF = 6,\n\tWLAN_HT_ACTION_ASEL_IDX_FEEDBACK = 7,\n};\n\n \nenum ieee80211_vht_actioncode {\n\tWLAN_VHT_ACTION_COMPRESSED_BF = 0,\n\tWLAN_VHT_ACTION_GROUPID_MGMT = 1,\n\tWLAN_VHT_ACTION_OPMODE_NOTIF = 2,\n};\n\n \nenum ieee80211_self_protected_actioncode {\n\tWLAN_SP_RESERVED = 0,\n\tWLAN_SP_MESH_PEERING_OPEN = 1,\n\tWLAN_SP_MESH_PEERING_CONFIRM = 2,\n\tWLAN_SP_MESH_PEERING_CLOSE = 3,\n\tWLAN_SP_MGK_INFORM = 4,\n\tWLAN_SP_MGK_ACK = 5,\n};\n\n \nenum ieee80211_mesh_actioncode {\n\tWLAN_MESH_ACTION_LINK_METRIC_REPORT,\n\tWLAN_MESH_ACTION_HWMP_PATH_SELECTION,\n\tWLAN_MESH_ACTION_GATE_ANNOUNCEMENT,\n\tWLAN_MESH_ACTION_CONGESTION_CONTROL_NOTIFICATION,\n\tWLAN_MESH_ACTION_MCCA_SETUP_REQUEST,\n\tWLAN_MESH_ACTION_MCCA_SETUP_REPLY,\n\tWLAN_MESH_ACTION_MCCA_ADVERTISEMENT_REQUEST,\n\tWLAN_MESH_ACTION_MCCA_ADVERTISEMENT,\n\tWLAN_MESH_ACTION_MCCA_TEARDOWN,\n\tWLAN_MESH_ACTION_TBTT_ADJUSTMENT_REQUEST,\n\tWLAN_MESH_ACTION_TBTT_ADJUSTMENT_RESPONSE,\n};\n\n \nenum ieee80211_unprotected_wnm_actioncode {\n\tWLAN_UNPROTECTED_WNM_ACTION_TIM = 0,\n\tWLAN_UNPROTECTED_WNM_ACTION_TIMING_MEASUREMENT_RESPONSE = 1,\n};\n\n \nenum ieee80211_key_len {\n\tWLAN_KEY_LEN_WEP40 = 5,\n\tWLAN_KEY_LEN_WEP104 = 13,\n\tWLAN_KEY_LEN_CCMP = 16,\n\tWLAN_KEY_LEN_CCMP_256 = 32,\n\tWLAN_KEY_LEN_TKIP = 32,\n\tWLAN_KEY_LEN_AES_CMAC = 16,\n\tWLAN_KEY_LEN_SMS4 = 32,\n\tWLAN_KEY_LEN_GCMP = 16,\n\tWLAN_KEY_LEN_GCMP_256 = 32,\n\tWLAN_KEY_LEN_BIP_CMAC_256 = 32,\n\tWLAN_KEY_LEN_BIP_GMAC_128 = 16,\n\tWLAN_KEY_LEN_BIP_GMAC_256 = 32,\n};\n\nenum ieee80211_s1g_actioncode {\n\tWLAN_S1G_AID_SWITCH_REQUEST,\n\tWLAN_S1G_AID_SWITCH_RESPONSE,\n\tWLAN_S1G_SYNC_CONTROL,\n\tWLAN_S1G_STA_INFO_ANNOUNCE,\n\tWLAN_S1G_EDCA_PARAM_SET,\n\tWLAN_S1G_EL_OPERATION,\n\tWLAN_S1G_TWT_SETUP,\n\tWLAN_S1G_TWT_TEARDOWN,\n\tWLAN_S1G_SECT_GROUP_ID_LIST,\n\tWLAN_S1G_SECT_ID_FEEDBACK,\n\tWLAN_S1G_TWT_INFORMATION = 11,\n};\n\n#define IEEE80211_WEP_IV_LEN\t\t4\n#define IEEE80211_WEP_ICV_LEN\t\t4\n#define IEEE80211_CCMP_HDR_LEN\t\t8\n#define IEEE80211_CCMP_MIC_LEN\t\t8\n#define IEEE80211_CCMP_PN_LEN\t\t6\n#define IEEE80211_CCMP_256_HDR_LEN\t8\n#define IEEE80211_CCMP_256_MIC_LEN\t16\n#define IEEE80211_CCMP_256_PN_LEN\t6\n#define IEEE80211_TKIP_IV_LEN\t\t8\n#define IEEE80211_TKIP_ICV_LEN\t\t4\n#define IEEE80211_CMAC_PN_LEN\t\t6\n#define IEEE80211_GMAC_PN_LEN\t\t6\n#define IEEE80211_GCMP_HDR_LEN\t\t8\n#define IEEE80211_GCMP_MIC_LEN\t\t16\n#define IEEE80211_GCMP_PN_LEN\t\t6\n\n#define FILS_NONCE_LEN\t\t\t16\n#define FILS_MAX_KEK_LEN\t\t64\n\n#define FILS_ERP_MAX_USERNAME_LEN\t16\n#define FILS_ERP_MAX_REALM_LEN\t\t253\n#define FILS_ERP_MAX_RRK_LEN\t\t64\n\n#define PMK_MAX_LEN\t\t\t64\n#define SAE_PASSWORD_MAX_LEN\t\t128\n\n \nenum ieee80211_pub_actioncode {\n\tWLAN_PUB_ACTION_20_40_BSS_COEX = 0,\n\tWLAN_PUB_ACTION_DSE_ENABLEMENT = 1,\n\tWLAN_PUB_ACTION_DSE_DEENABLEMENT = 2,\n\tWLAN_PUB_ACTION_DSE_REG_LOC_ANN = 3,\n\tWLAN_PUB_ACTION_EXT_CHANSW_ANN = 4,\n\tWLAN_PUB_ACTION_DSE_MSMT_REQ = 5,\n\tWLAN_PUB_ACTION_DSE_MSMT_RESP = 6,\n\tWLAN_PUB_ACTION_MSMT_PILOT = 7,\n\tWLAN_PUB_ACTION_DSE_PC = 8,\n\tWLAN_PUB_ACTION_VENDOR_SPECIFIC = 9,\n\tWLAN_PUB_ACTION_GAS_INITIAL_REQ = 10,\n\tWLAN_PUB_ACTION_GAS_INITIAL_RESP = 11,\n\tWLAN_PUB_ACTION_GAS_COMEBACK_REQ = 12,\n\tWLAN_PUB_ACTION_GAS_COMEBACK_RESP = 13,\n\tWLAN_PUB_ACTION_TDLS_DISCOVER_RES = 14,\n\tWLAN_PUB_ACTION_LOC_TRACK_NOTI = 15,\n\tWLAN_PUB_ACTION_QAB_REQUEST_FRAME = 16,\n\tWLAN_PUB_ACTION_QAB_RESPONSE_FRAME = 17,\n\tWLAN_PUB_ACTION_QMF_POLICY = 18,\n\tWLAN_PUB_ACTION_QMF_POLICY_CHANGE = 19,\n\tWLAN_PUB_ACTION_QLOAD_REQUEST = 20,\n\tWLAN_PUB_ACTION_QLOAD_REPORT = 21,\n\tWLAN_PUB_ACTION_HCCA_TXOP_ADVERT = 22,\n\tWLAN_PUB_ACTION_HCCA_TXOP_RESPONSE = 23,\n\tWLAN_PUB_ACTION_PUBLIC_KEY = 24,\n\tWLAN_PUB_ACTION_CHANNEL_AVAIL_QUERY = 25,\n\tWLAN_PUB_ACTION_CHANNEL_SCHEDULE_MGMT = 26,\n\tWLAN_PUB_ACTION_CONTACT_VERI_SIGNAL = 27,\n\tWLAN_PUB_ACTION_GDD_ENABLEMENT_REQ = 28,\n\tWLAN_PUB_ACTION_GDD_ENABLEMENT_RESP = 29,\n\tWLAN_PUB_ACTION_NETWORK_CHANNEL_CONTROL = 30,\n\tWLAN_PUB_ACTION_WHITE_SPACE_MAP_ANN = 31,\n\tWLAN_PUB_ACTION_FTM_REQUEST = 32,\n\tWLAN_PUB_ACTION_FTM_RESPONSE = 33,\n\tWLAN_PUB_ACTION_FILS_DISCOVERY = 34,\n};\n\n \nenum ieee80211_tdls_actioncode {\n\tWLAN_TDLS_SETUP_REQUEST = 0,\n\tWLAN_TDLS_SETUP_RESPONSE = 1,\n\tWLAN_TDLS_SETUP_CONFIRM = 2,\n\tWLAN_TDLS_TEARDOWN = 3,\n\tWLAN_TDLS_PEER_TRAFFIC_INDICATION = 4,\n\tWLAN_TDLS_CHANNEL_SWITCH_REQUEST = 5,\n\tWLAN_TDLS_CHANNEL_SWITCH_RESPONSE = 6,\n\tWLAN_TDLS_PEER_PSM_REQUEST = 7,\n\tWLAN_TDLS_PEER_PSM_RESPONSE = 8,\n\tWLAN_TDLS_PEER_TRAFFIC_RESPONSE = 9,\n\tWLAN_TDLS_DISCOVERY_REQUEST = 10,\n};\n\n \n#define WLAN_EXT_CAPA1_EXT_CHANNEL_SWITCHING\tBIT(2)\n\n \n#define WLAN_EXT_CAPA3_MULTI_BSSID_SUPPORT\tBIT(6)\n\n \n#define WLAN_EXT_CAPA3_TIMING_MEASUREMENT_SUPPORT\tBIT(7)\n\n \n#define WLAN_EXT_CAPA4_TDLS_BUFFER_STA\t\tBIT(4)\n#define WLAN_EXT_CAPA4_TDLS_PEER_PSM\t\tBIT(5)\n#define WLAN_EXT_CAPA4_TDLS_CHAN_SWITCH\t\tBIT(6)\n\n \n#define WLAN_EXT_CAPA4_INTERWORKING_ENABLED\tBIT(7)\n\n \n#define WLAN_EXT_CAPA5_TDLS_ENABLED\tBIT(5)\n#define WLAN_EXT_CAPA5_TDLS_PROHIBITED\tBIT(6)\n#define WLAN_EXT_CAPA5_TDLS_CH_SW_PROHIBITED\tBIT(7)\n\n#define WLAN_EXT_CAPA8_TDLS_WIDE_BW_ENABLED\tBIT(5)\n#define WLAN_EXT_CAPA8_OPMODE_NOTIF\tBIT(6)\n\n \n#define WLAN_EXT_CAPA8_MAX_MSDU_IN_AMSDU_LSB\tBIT(7)\n#define WLAN_EXT_CAPA9_MAX_MSDU_IN_AMSDU_MSB\tBIT(0)\n\n \n#define WLAN_EXT_CAPA9_FTM_INITIATOR\tBIT(7)\n\n \n#define WLAN_EXT_CAPA10_TWT_REQUESTER_SUPPORT\tBIT(5)\n#define WLAN_EXT_CAPA10_TWT_RESPONDER_SUPPORT\tBIT(6)\n\n \n#define WLAN_EXT_CAPA10_OBSS_NARROW_BW_RU_TOLERANCE_SUPPORT BIT(7)\n\n \n#define WLAN_EXT_CAPA11_EMA_SUPPORT\tBIT(3)\n\n \n#define WLAN_TDLS_SNAP_RFTYPE\t0x2\n\n \n#define WLAN_BSS_COEX_INFORMATION_REQUEST\tBIT(0)\n\n \nenum ieee80211_mesh_sync_method {\n\tIEEE80211_SYNC_METHOD_NEIGHBOR_OFFSET = 1,\n\tIEEE80211_SYNC_METHOD_VENDOR = 255,\n};\n\n \nenum ieee80211_mesh_path_protocol {\n\tIEEE80211_PATH_PROTOCOL_HWMP = 1,\n\tIEEE80211_PATH_PROTOCOL_VENDOR = 255,\n};\n\n \nenum ieee80211_mesh_path_metric {\n\tIEEE80211_PATH_METRIC_AIRTIME = 1,\n\tIEEE80211_PATH_METRIC_VENDOR = 255,\n};\n\n \nenum ieee80211_root_mode_identifier {\n\tIEEE80211_ROOTMODE_NO_ROOT = 0,\n\tIEEE80211_ROOTMODE_ROOT = 1,\n\tIEEE80211_PROACTIVE_PREQ_NO_PREP = 2,\n\tIEEE80211_PROACTIVE_PREQ_WITH_PREP = 3,\n\tIEEE80211_PROACTIVE_RANN = 4,\n};\n\n \n\n \n#define IEEE80211_COUNTRY_IE_MIN_LEN\t6\n\n \n#define IEEE80211_COUNTRY_STRING_LEN\t3\n\n \n#define IEEE80211_COUNTRY_EXTENSION_ID 201\n\n \nstruct ieee80211_country_ie_triplet {\n\tunion {\n\t\tstruct {\n\t\t\tu8 first_channel;\n\t\t\tu8 num_channels;\n\t\t\ts8 max_power;\n\t\t} __packed chans;\n\t\tstruct {\n\t\t\tu8 reg_extension_id;\n\t\t\tu8 reg_class;\n\t\t\tu8 coverage_class;\n\t\t} __packed ext;\n\t};\n} __packed;\n\nenum ieee80211_timeout_interval_type {\n\tWLAN_TIMEOUT_REASSOC_DEADLINE = 1  ,\n\tWLAN_TIMEOUT_KEY_LIFETIME = 2  ,\n\tWLAN_TIMEOUT_ASSOC_COMEBACK = 3  ,\n};\n\n \nstruct ieee80211_timeout_interval_ie {\n\tu8 type;\n\t__le32 value;\n} __packed;\n\n \nenum ieee80211_idle_options {\n\tWLAN_IDLE_OPTIONS_PROTECTED_KEEP_ALIVE = BIT(0),\n};\n\n \nstruct ieee80211_bss_max_idle_period_ie {\n\t__le16 max_idle_period;\n\tu8 idle_options;\n} __packed;\n\n \nenum ieee80211_back_actioncode {\n\tWLAN_ACTION_ADDBA_REQ = 0,\n\tWLAN_ACTION_ADDBA_RESP = 1,\n\tWLAN_ACTION_DELBA = 2,\n};\n\n \nenum ieee80211_back_parties {\n\tWLAN_BACK_RECIPIENT = 0,\n\tWLAN_BACK_INITIATOR = 1,\n};\n\n \nenum ieee80211_sa_query_action {\n\tWLAN_ACTION_SA_QUERY_REQUEST = 0,\n\tWLAN_ACTION_SA_QUERY_RESPONSE = 1,\n};\n\n \nstruct ieee80211_bssid_index {\n\tu8 bssid_index;\n\tu8 dtim_period;\n\tu8 dtim_count;\n};\n\n \nstruct ieee80211_multiple_bssid_configuration {\n\tu8 bssid_count;\n\tu8 profile_periodicity;\n};\n\n#define SUITE(oui, id)\t(((oui) << 8) | (id))\n\n \n#define WLAN_CIPHER_SUITE_USE_GROUP\tSUITE(0x000FAC, 0)\n#define WLAN_CIPHER_SUITE_WEP40\t\tSUITE(0x000FAC, 1)\n#define WLAN_CIPHER_SUITE_TKIP\t\tSUITE(0x000FAC, 2)\n \n#define WLAN_CIPHER_SUITE_CCMP\t\tSUITE(0x000FAC, 4)\n#define WLAN_CIPHER_SUITE_WEP104\tSUITE(0x000FAC, 5)\n#define WLAN_CIPHER_SUITE_AES_CMAC\tSUITE(0x000FAC, 6)\n#define WLAN_CIPHER_SUITE_GCMP\t\tSUITE(0x000FAC, 8)\n#define WLAN_CIPHER_SUITE_GCMP_256\tSUITE(0x000FAC, 9)\n#define WLAN_CIPHER_SUITE_CCMP_256\tSUITE(0x000FAC, 10)\n#define WLAN_CIPHER_SUITE_BIP_GMAC_128\tSUITE(0x000FAC, 11)\n#define WLAN_CIPHER_SUITE_BIP_GMAC_256\tSUITE(0x000FAC, 12)\n#define WLAN_CIPHER_SUITE_BIP_CMAC_256\tSUITE(0x000FAC, 13)\n\n#define WLAN_CIPHER_SUITE_SMS4\t\tSUITE(0x001472, 1)\n\n \n#define WLAN_AKM_SUITE_8021X\t\t\tSUITE(0x000FAC, 1)\n#define WLAN_AKM_SUITE_PSK\t\t\tSUITE(0x000FAC, 2)\n#define WLAN_AKM_SUITE_FT_8021X\t\t\tSUITE(0x000FAC, 3)\n#define WLAN_AKM_SUITE_FT_PSK\t\t\tSUITE(0x000FAC, 4)\n#define WLAN_AKM_SUITE_8021X_SHA256\t\tSUITE(0x000FAC, 5)\n#define WLAN_AKM_SUITE_PSK_SHA256\t\tSUITE(0x000FAC, 6)\n#define WLAN_AKM_SUITE_TDLS\t\t\tSUITE(0x000FAC, 7)\n#define WLAN_AKM_SUITE_SAE\t\t\tSUITE(0x000FAC, 8)\n#define WLAN_AKM_SUITE_FT_OVER_SAE\t\tSUITE(0x000FAC, 9)\n#define WLAN_AKM_SUITE_AP_PEER_KEY\t\tSUITE(0x000FAC, 10)\n#define WLAN_AKM_SUITE_8021X_SUITE_B\t\tSUITE(0x000FAC, 11)\n#define WLAN_AKM_SUITE_8021X_SUITE_B_192\tSUITE(0x000FAC, 12)\n#define WLAN_AKM_SUITE_FT_8021X_SHA384\t\tSUITE(0x000FAC, 13)\n#define WLAN_AKM_SUITE_FILS_SHA256\t\tSUITE(0x000FAC, 14)\n#define WLAN_AKM_SUITE_FILS_SHA384\t\tSUITE(0x000FAC, 15)\n#define WLAN_AKM_SUITE_FT_FILS_SHA256\t\tSUITE(0x000FAC, 16)\n#define WLAN_AKM_SUITE_FT_FILS_SHA384\t\tSUITE(0x000FAC, 17)\n#define WLAN_AKM_SUITE_OWE\t\t\tSUITE(0x000FAC, 18)\n#define WLAN_AKM_SUITE_FT_PSK_SHA384\t\tSUITE(0x000FAC, 19)\n#define WLAN_AKM_SUITE_PSK_SHA384\t\tSUITE(0x000FAC, 20)\n\n#define WLAN_AKM_SUITE_WFA_DPP\t\t\tSUITE(WLAN_OUI_WFA, 2)\n\n#define WLAN_MAX_KEY_LEN\t\t32\n\n#define WLAN_PMK_NAME_LEN\t\t16\n#define WLAN_PMKID_LEN\t\t\t16\n#define WLAN_PMK_LEN_EAP_LEAP\t\t16\n#define WLAN_PMK_LEN\t\t\t32\n#define WLAN_PMK_LEN_SUITE_B_192\t48\n\n#define WLAN_OUI_WFA\t\t\t0x506f9a\n#define WLAN_OUI_TYPE_WFA_P2P\t\t9\n#define WLAN_OUI_TYPE_WFA_DPP\t\t0x1A\n#define WLAN_OUI_MICROSOFT\t\t0x0050f2\n#define WLAN_OUI_TYPE_MICROSOFT_WPA\t1\n#define WLAN_OUI_TYPE_MICROSOFT_WMM\t2\n#define WLAN_OUI_TYPE_MICROSOFT_WPS\t4\n#define WLAN_OUI_TYPE_MICROSOFT_TPC\t8\n\n \n#define IEEE80211_WMM_IE_TSPEC_TID_MASK\t\t0x0F\n#define IEEE80211_WMM_IE_TSPEC_TID_SHIFT\t1\n\nenum ieee80211_tspec_status_code {\n\tIEEE80211_TSPEC_STATUS_ADMISS_ACCEPTED = 0,\n\tIEEE80211_TSPEC_STATUS_ADDTS_INVAL_PARAMS = 0x1,\n};\n\nstruct ieee80211_tspec_ie {\n\tu8 element_id;\n\tu8 len;\n\tu8 oui[3];\n\tu8 oui_type;\n\tu8 oui_subtype;\n\tu8 version;\n\t__le16 tsinfo;\n\tu8 tsinfo_resvd;\n\t__le16 nominal_msdu;\n\t__le16 max_msdu;\n\t__le32 min_service_int;\n\t__le32 max_service_int;\n\t__le32 inactivity_int;\n\t__le32 suspension_int;\n\t__le32 service_start_time;\n\t__le32 min_data_rate;\n\t__le32 mean_data_rate;\n\t__le32 peak_data_rate;\n\t__le32 max_burst_size;\n\t__le32 delay_bound;\n\t__le32 min_phy_rate;\n\t__le16 sba;\n\t__le16 medium_time;\n} __packed;\n\nstruct ieee80211_he_6ghz_capa {\n\t \n\t__le16 capa;\n} __packed;\n\n \n \n#define IEEE80211_HE_6GHZ_CAP_MIN_MPDU_START\t0x0007\n \n#define IEEE80211_HE_6GHZ_CAP_MAX_AMPDU_LEN_EXP\t0x0038\n \n#define IEEE80211_HE_6GHZ_CAP_MAX_MPDU_LEN\t0x00c0\n \n#define IEEE80211_HE_6GHZ_CAP_SM_PS\t\t0x0600\n#define IEEE80211_HE_6GHZ_CAP_RD_RESPONDER\t0x0800\n#define IEEE80211_HE_6GHZ_CAP_RX_ANTPAT_CONS\t0x1000\n#define IEEE80211_HE_6GHZ_CAP_TX_ANTPAT_CONS\t0x2000\n\n \nstatic inline u8 *ieee80211_get_qos_ctl(struct ieee80211_hdr *hdr)\n{\n\tunion {\n\t\tstruct ieee80211_qos_hdr\taddr3;\n\t\tstruct ieee80211_qos_hdr_4addr\taddr4;\n\t} *qos;\n\n\tqos = (void *)hdr;\n\tif (ieee80211_has_a4(qos->addr3.frame_control))\n\t\treturn (u8 *)&qos->addr4.qos_ctrl;\n\telse\n\t\treturn (u8 *)&qos->addr3.qos_ctrl;\n}\n\n \nstatic inline u8 ieee80211_get_tid(struct ieee80211_hdr *hdr)\n{\n\tu8 *qc = ieee80211_get_qos_ctl(hdr);\n\n\treturn qc[0] & IEEE80211_QOS_CTL_TID_MASK;\n}\n\n \nstatic inline u8 *ieee80211_get_SA(struct ieee80211_hdr *hdr)\n{\n\tif (ieee80211_has_a4(hdr->frame_control))\n\t\treturn hdr->addr4;\n\tif (ieee80211_has_fromds(hdr->frame_control))\n\t\treturn hdr->addr3;\n\treturn hdr->addr2;\n}\n\n \nstatic inline u8 *ieee80211_get_DA(struct ieee80211_hdr *hdr)\n{\n\tif (ieee80211_has_tods(hdr->frame_control))\n\t\treturn hdr->addr3;\n\telse\n\t\treturn hdr->addr1;\n}\n\n \nstatic inline bool ieee80211_is_bufferable_mmpdu(struct sk_buff *skb)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)skb->data;\n\t__le16 fc = mgmt->frame_control;\n\n\t \n\tif (!ieee80211_is_mgmt(fc))\n\t\treturn false;\n\n\tif (ieee80211_is_disassoc(fc) || ieee80211_is_deauth(fc))\n\t\treturn true;\n\n\tif (!ieee80211_is_action(fc))\n\t\treturn false;\n\n\tif (skb->len < offsetofend(typeof(*mgmt), u.action.u.ftm.action_code))\n\t\treturn true;\n\n\t \n\n\tif (mgmt->u.action.category != WLAN_CATEGORY_PUBLIC &&\n\t    mgmt->u.action.category != WLAN_CATEGORY_PROTECTED_DUAL_OF_ACTION)\n\t\treturn true;\n\n\tif (mgmt->u.action.u.ftm.action_code == WLAN_PUB_ACTION_FTM_REQUEST ||\n\t    mgmt->u.action.u.ftm.action_code == WLAN_PUB_ACTION_FTM_RESPONSE)\n\t\treturn false;\n\n\treturn true;\n}\n\n \nstatic inline bool _ieee80211_is_robust_mgmt_frame(struct ieee80211_hdr *hdr)\n{\n\tif (ieee80211_is_disassoc(hdr->frame_control) ||\n\t    ieee80211_is_deauth(hdr->frame_control))\n\t\treturn true;\n\n\tif (ieee80211_is_action(hdr->frame_control)) {\n\t\tu8 *category;\n\n\t\t \n\t\tif (ieee80211_has_protected(hdr->frame_control))\n\t\t\treturn true;\n\t\tcategory = ((u8 *) hdr) + 24;\n\t\treturn *category != WLAN_CATEGORY_PUBLIC &&\n\t\t\t*category != WLAN_CATEGORY_HT &&\n\t\t\t*category != WLAN_CATEGORY_WNM_UNPROTECTED &&\n\t\t\t*category != WLAN_CATEGORY_SELF_PROTECTED &&\n\t\t\t*category != WLAN_CATEGORY_UNPROT_DMG &&\n\t\t\t*category != WLAN_CATEGORY_VHT &&\n\t\t\t*category != WLAN_CATEGORY_S1G &&\n\t\t\t*category != WLAN_CATEGORY_VENDOR_SPECIFIC;\n\t}\n\n\treturn false;\n}\n\n \nstatic inline bool ieee80211_is_robust_mgmt_frame(struct sk_buff *skb)\n{\n\tif (skb->len < IEEE80211_MIN_ACTION_SIZE)\n\t\treturn false;\n\treturn _ieee80211_is_robust_mgmt_frame((void *)skb->data);\n}\n\n \nstatic inline bool ieee80211_is_public_action(struct ieee80211_hdr *hdr,\n\t\t\t\t\t      size_t len)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)hdr;\n\n\tif (len < IEEE80211_MIN_ACTION_SIZE)\n\t\treturn false;\n\tif (!ieee80211_is_action(hdr->frame_control))\n\t\treturn false;\n\treturn mgmt->u.action.category == WLAN_CATEGORY_PUBLIC;\n}\n\n \nstatic inline bool\nieee80211_is_protected_dual_of_public_action(struct sk_buff *skb)\n{\n\tu8 action;\n\n\tif (!ieee80211_is_public_action((void *)skb->data, skb->len) ||\n\t    skb->len < IEEE80211_MIN_ACTION_SIZE + 1)\n\t\treturn false;\n\n\taction = *(u8 *)(skb->data + IEEE80211_MIN_ACTION_SIZE);\n\n\treturn action != WLAN_PUB_ACTION_20_40_BSS_COEX &&\n\t\taction != WLAN_PUB_ACTION_DSE_REG_LOC_ANN &&\n\t\taction != WLAN_PUB_ACTION_MSMT_PILOT &&\n\t\taction != WLAN_PUB_ACTION_TDLS_DISCOVER_RES &&\n\t\taction != WLAN_PUB_ACTION_LOC_TRACK_NOTI &&\n\t\taction != WLAN_PUB_ACTION_FTM_REQUEST &&\n\t\taction != WLAN_PUB_ACTION_FTM_RESPONSE &&\n\t\taction != WLAN_PUB_ACTION_FILS_DISCOVERY &&\n\t\taction != WLAN_PUB_ACTION_VENDOR_SPECIFIC;\n}\n\n \nstatic inline bool _ieee80211_is_group_privacy_action(struct ieee80211_hdr *hdr)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)hdr;\n\n\tif (!ieee80211_is_action(hdr->frame_control) ||\n\t    !is_multicast_ether_addr(hdr->addr1))\n\t\treturn false;\n\n\treturn mgmt->u.action.category == WLAN_CATEGORY_MESH_ACTION ||\n\t       mgmt->u.action.category == WLAN_CATEGORY_MULTIHOP_ACTION;\n}\n\n \nstatic inline bool ieee80211_is_group_privacy_action(struct sk_buff *skb)\n{\n\tif (skb->len < IEEE80211_MIN_ACTION_SIZE)\n\t\treturn false;\n\treturn _ieee80211_is_group_privacy_action((void *)skb->data);\n}\n\n \nstatic inline unsigned long ieee80211_tu_to_usec(unsigned long tu)\n{\n\treturn 1024 * tu;\n}\n\n \nstatic inline bool ieee80211_check_tim(const struct ieee80211_tim_ie *tim,\n\t\t\t\t       u8 tim_len, u16 aid)\n{\n\tu8 mask;\n\tu8 index, indexn1, indexn2;\n\n\tif (unlikely(!tim || tim_len < sizeof(*tim)))\n\t\treturn false;\n\n\taid &= 0x3fff;\n\tindex = aid / 8;\n\tmask  = 1 << (aid & 7);\n\n\tindexn1 = tim->bitmap_ctrl & 0xfe;\n\tindexn2 = tim_len + indexn1 - 4;\n\n\tif (index < indexn1 || index > indexn2)\n\t\treturn false;\n\n\tindex -= indexn1;\n\n\treturn !!(tim->virtual_map[index] & mask);\n}\n\n \nstatic inline int ieee80211_get_tdls_action(struct sk_buff *skb, u32 hdr_size)\n{\n\tif (!skb_is_nonlinear(skb) &&\n\t    skb->len > (skb_network_offset(skb) + 2)) {\n\t\t \n\t\tconst u8 *tdls_data = skb_network_header(skb) - 2;\n\n\t\tif (get_unaligned_be16(tdls_data) == ETH_P_TDLS &&\n\t\t    tdls_data[2] == WLAN_TDLS_SNAP_RFTYPE &&\n\t\t    tdls_data[3] == WLAN_CATEGORY_TDLS)\n\t\t\treturn tdls_data[4];\n\t}\n\n\treturn -1;\n}\n\n \n#define TU_TO_JIFFIES(x)\t(usecs_to_jiffies((x) * 1024))\n#define TU_TO_EXP_TIME(x)\t(jiffies + TU_TO_JIFFIES(x))\n\n \n#define MHZ_TO_KHZ(freq) ((freq) * 1000)\n#define KHZ_TO_MHZ(freq) ((freq) / 1000)\n#define PR_KHZ(f) KHZ_TO_MHZ(f), f % 1000\n#define KHZ_F \"%d.%03d\"\n\n \n#define DBI_TO_MBI(gain) ((gain) * 100)\n#define MBI_TO_DBI(gain) ((gain) / 100)\n#define DBM_TO_MBM(gain) ((gain) * 100)\n#define MBM_TO_DBM(gain) ((gain) / 100)\n\n \nstatic inline bool ieee80211_action_contains_tpc(struct sk_buff *skb)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)skb->data;\n\n\tif (!ieee80211_is_action(mgmt->frame_control))\n\t\treturn false;\n\n\tif (skb->len < IEEE80211_MIN_ACTION_SIZE +\n\t\t       sizeof(mgmt->u.action.u.tpc_report))\n\t\treturn false;\n\n\t \n\tif (mgmt->u.action.category != WLAN_CATEGORY_SPECTRUM_MGMT &&\n\t    mgmt->u.action.category != WLAN_CATEGORY_RADIO_MEASUREMENT)\n\t\treturn false;\n\n\t \n\tif (mgmt->u.action.u.tpc_report.action_code !=\n\t    WLAN_ACTION_SPCT_TPC_RPRT)\n\t\treturn false;\n\n\tif (mgmt->u.action.u.tpc_report.tpc_elem_id != WLAN_EID_TPC_REPORT ||\n\t    mgmt->u.action.u.tpc_report.tpc_elem_length !=\n\t    sizeof(struct ieee80211_tpc_report_ie))\n\t\treturn false;\n\n\treturn true;\n}\n\nstatic inline bool ieee80211_is_timing_measurement(struct sk_buff *skb)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)skb->data;\n\n\tif (skb->len < IEEE80211_MIN_ACTION_SIZE)\n\t\treturn false;\n\n\tif (!ieee80211_is_action(mgmt->frame_control))\n\t\treturn false;\n\n\tif (mgmt->u.action.category == WLAN_CATEGORY_WNM_UNPROTECTED &&\n\t    mgmt->u.action.u.wnm_timing_msr.action_code ==\n\t\tWLAN_UNPROTECTED_WNM_ACTION_TIMING_MEASUREMENT_RESPONSE &&\n\t    skb->len >= offsetofend(typeof(*mgmt), u.action.u.wnm_timing_msr))\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic inline bool ieee80211_is_ftm(struct sk_buff *skb)\n{\n\tstruct ieee80211_mgmt *mgmt = (void *)skb->data;\n\n\tif (!ieee80211_is_public_action((void *)mgmt, skb->len))\n\t\treturn false;\n\n\tif (mgmt->u.action.u.ftm.action_code ==\n\t\tWLAN_PUB_ACTION_FTM_RESPONSE &&\n\t    skb->len >= offsetofend(typeof(*mgmt), u.action.u.ftm))\n\t\treturn true;\n\n\treturn false;\n}\n\nstruct element {\n\tu8 id;\n\tu8 datalen;\n\tu8 data[];\n} __packed;\n\n \n#define for_each_element(_elem, _data, _datalen)\t\t\t\\\n\tfor (_elem = (const struct element *)(_data);\t\t\t\\\n\t     (const u8 *)(_data) + (_datalen) - (const u8 *)_elem >=\t\\\n\t\t(int)sizeof(*_elem) &&\t\t\t\t\t\\\n\t     (const u8 *)(_data) + (_datalen) - (const u8 *)_elem >=\t\\\n\t\t(int)sizeof(*_elem) + _elem->datalen;\t\t\t\\\n\t     _elem = (const struct element *)(_elem->data + _elem->datalen))\n\n#define for_each_element_id(element, _id, data, datalen)\t\t\\\n\tfor_each_element(element, data, datalen)\t\t\t\\\n\t\tif (element->id == (_id))\n\n#define for_each_element_extid(element, extid, _data, _datalen)\t\t\\\n\tfor_each_element(element, _data, _datalen)\t\t\t\\\n\t\tif (element->id == WLAN_EID_EXTENSION &&\t\t\\\n\t\t    element->datalen > 0 &&\t\t\t\t\\\n\t\t    element->data[0] == (extid))\n\n#define for_each_subelement(sub, element)\t\t\t\t\\\n\tfor_each_element(sub, (element)->data, (element)->datalen)\n\n#define for_each_subelement_id(sub, id, element)\t\t\t\\\n\tfor_each_element_id(sub, id, (element)->data, (element)->datalen)\n\n#define for_each_subelement_extid(sub, extid, element)\t\t\t\\\n\tfor_each_element_extid(sub, extid, (element)->data, (element)->datalen)\n\n \nstatic inline bool for_each_element_completed(const struct element *element,\n\t\t\t\t\t      const void *data, size_t datalen)\n{\n\treturn (const u8 *)element == (const u8 *)data + datalen;\n}\n\n \n#define WLAN_RSNX_CAPA_PROTECTED_TWT BIT(4)\n#define WLAN_RSNX_CAPA_SAE_H2E BIT(5)\n\n \n#define IEEE80211_AP_INFO_TBTT_HDR_TYPE\t\t\t\t0x03\n#define IEEE80211_AP_INFO_TBTT_HDR_FILTERED\t\t\t0x04\n#define IEEE80211_AP_INFO_TBTT_HDR_COLOC\t\t\t0x08\n#define IEEE80211_AP_INFO_TBTT_HDR_COUNT\t\t\t0xF0\n#define IEEE80211_TBTT_INFO_TYPE_TBTT\t\t\t\t0\n#define IEEE80211_TBTT_INFO_TYPE_MLD\t\t\t\t1\n\n#define IEEE80211_RNR_TBTT_PARAMS_OCT_RECOMMENDED\t\t0x01\n#define IEEE80211_RNR_TBTT_PARAMS_SAME_SSID\t\t\t0x02\n#define IEEE80211_RNR_TBTT_PARAMS_MULTI_BSSID\t\t\t0x04\n#define IEEE80211_RNR_TBTT_PARAMS_TRANSMITTED_BSSID\t\t0x08\n#define IEEE80211_RNR_TBTT_PARAMS_COLOC_ESS\t\t\t0x10\n#define IEEE80211_RNR_TBTT_PARAMS_PROBE_ACTIVE\t\t\t0x20\n#define IEEE80211_RNR_TBTT_PARAMS_COLOC_AP\t\t\t0x40\n\n#define IEEE80211_RNR_TBTT_PARAMS_PSD_NO_LIMIT\t\t\t127\n#define IEEE80211_RNR_TBTT_PARAMS_PSD_RESERVED\t\t\t-128\n\nstruct ieee80211_neighbor_ap_info {\n\tu8 tbtt_info_hdr;\n\tu8 tbtt_info_len;\n\tu8 op_class;\n\tu8 channel;\n} __packed;\n\nenum ieee80211_range_params_max_total_ltf {\n\tIEEE80211_RANGE_PARAMS_MAX_TOTAL_LTF_4 = 0,\n\tIEEE80211_RANGE_PARAMS_MAX_TOTAL_LTF_8,\n\tIEEE80211_RANGE_PARAMS_MAX_TOTAL_LTF_16,\n\tIEEE80211_RANGE_PARAMS_MAX_TOTAL_LTF_UNSPECIFIED,\n};\n\n \nstruct ieee80211_rnr_mld_params {\n\tu8 mld_id;\n\t__le16 params;\n} __packed;\n\n#define IEEE80211_RNR_MLD_PARAMS_LINK_ID\t\t\t0x000F\n#define IEEE80211_RNR_MLD_PARAMS_BSS_CHANGE_COUNT\t\t0x0FF0\n#define IEEE80211_RNR_MLD_PARAMS_UPDATES_INCLUDED\t\t0x1000\n#define IEEE80211_RNR_MLD_PARAMS_DISABLED_LINK\t\t\t0x2000\n\n \nstruct ieee80211_tbtt_info_7_8_9 {\n\tu8 tbtt_offset;\n\tu8 bssid[ETH_ALEN];\n\n\t \n\tu8 bss_params;\n\ts8 psd_20;\n} __packed;\n\n \nstruct ieee80211_tbtt_info_ge_11 {\n\tu8 tbtt_offset;\n\tu8 bssid[ETH_ALEN];\n\t__le32 short_ssid;\n\n\t \n\tu8 bss_params;\n\ts8 psd_20;\n\tstruct ieee80211_rnr_mld_params mld_params;\n} __packed;\n\n \n#define IEEE80211_MLD_MAX_NUM_LINKS\t15\n\n#define IEEE80211_ML_CONTROL_TYPE\t\t\t0x0007\n#define IEEE80211_ML_CONTROL_TYPE_BASIC\t\t\t0\n#define IEEE80211_ML_CONTROL_TYPE_PREQ\t\t\t1\n#define IEEE80211_ML_CONTROL_TYPE_RECONF\t\t2\n#define IEEE80211_ML_CONTROL_TYPE_TDLS\t\t\t3\n#define IEEE80211_ML_CONTROL_TYPE_PRIO_ACCESS\t\t4\n#define IEEE80211_ML_CONTROL_PRESENCE_MASK\t\t0xfff0\n\nstruct ieee80211_multi_link_elem {\n\t__le16 control;\n\tu8 variable[];\n} __packed;\n\n#define IEEE80211_MLC_BASIC_PRES_LINK_ID\t\t0x0010\n#define IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT\t0x0020\n#define IEEE80211_MLC_BASIC_PRES_MED_SYNC_DELAY\t\t0x0040\n#define IEEE80211_MLC_BASIC_PRES_EML_CAPA\t\t0x0080\n#define IEEE80211_MLC_BASIC_PRES_MLD_CAPA_OP\t\t0x0100\n#define IEEE80211_MLC_BASIC_PRES_MLD_ID\t\t\t0x0200\n\n#define IEEE80211_MED_SYNC_DELAY_DURATION\t\t0x00ff\n#define IEEE80211_MED_SYNC_DELAY_SYNC_OFDM_ED_THRESH\t0x0f00\n#define IEEE80211_MED_SYNC_DELAY_SYNC_MAX_NUM_TXOPS\t0xf000\n\n \n#define IEEE80211_MED_SYNC_DELAY_DEFAULT\t\t0x10ac\n\n#define IEEE80211_EML_CAP_EMLSR_SUPP\t\t\t0x0001\n#define IEEE80211_EML_CAP_EMLSR_PADDING_DELAY\t\t0x000e\n#define  IEEE80211_EML_CAP_EMLSR_PADDING_DELAY_0US\t\t0\n#define  IEEE80211_EML_CAP_EMLSR_PADDING_DELAY_32US\t\t1\n#define  IEEE80211_EML_CAP_EMLSR_PADDING_DELAY_64US\t\t2\n#define  IEEE80211_EML_CAP_EMLSR_PADDING_DELAY_128US\t\t3\n#define  IEEE80211_EML_CAP_EMLSR_PADDING_DELAY_256US\t\t4\n#define IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY\t0x0070\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_0US\t\t0\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_16US\t\t1\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_32US\t\t2\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_64US\t\t3\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_128US\t\t4\n#define  IEEE80211_EML_CAP_EMLSR_TRANSITION_DELAY_256US\t\t5\n#define IEEE80211_EML_CAP_EMLMR_SUPPORT\t\t\t0x0080\n#define IEEE80211_EML_CAP_EMLMR_DELAY\t\t\t0x0700\n#define  IEEE80211_EML_CAP_EMLMR_DELAY_0US\t\t\t0\n#define  IEEE80211_EML_CAP_EMLMR_DELAY_32US\t\t\t1\n#define  IEEE80211_EML_CAP_EMLMR_DELAY_64US\t\t\t2\n#define  IEEE80211_EML_CAP_EMLMR_DELAY_128US\t\t\t3\n#define  IEEE80211_EML_CAP_EMLMR_DELAY_256US\t\t\t4\n#define IEEE80211_EML_CAP_TRANSITION_TIMEOUT\t\t0x7800\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_0\t\t\t0\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_128US\t\t1\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_256US\t\t2\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_512US\t\t3\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_1TU\t\t4\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_2TU\t\t5\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_4TU\t\t6\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_8TU\t\t7\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_16TU\t\t8\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_32TU\t\t9\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_64TU\t\t10\n#define  IEEE80211_EML_CAP_TRANSITION_TIMEOUT_128TU\t\t11\n\n#define IEEE80211_MLD_CAP_OP_MAX_SIMUL_LINKS\t\t0x000f\n#define IEEE80211_MLD_CAP_OP_SRS_SUPPORT\t\t0x0010\n#define IEEE80211_MLD_CAP_OP_TID_TO_LINK_MAP_NEG_SUPP\t0x0060\n#define IEEE80211_MLD_CAP_OP_FREQ_SEP_TYPE_IND\t\t0x0f80\n#define IEEE80211_MLD_CAP_OP_AAR_SUPPORT\t\t0x1000\n\nstruct ieee80211_mle_basic_common_info {\n\tu8 len;\n\tu8 mld_mac_addr[ETH_ALEN];\n\tu8 variable[];\n} __packed;\n\n#define IEEE80211_MLC_PREQ_PRES_MLD_ID\t\t\t0x0010\n\nstruct ieee80211_mle_preq_common_info {\n\tu8 len;\n\tu8 variable[];\n} __packed;\n\n#define IEEE80211_MLC_RECONF_PRES_MLD_MAC_ADDR\t\t0x0010\n\n \n\nstruct ieee80211_mle_tdls_common_info {\n\tu8 len;\n\tu8 ap_mld_mac_addr[ETH_ALEN];\n} __packed;\n\n#define IEEE80211_MLC_PRIO_ACCESS_PRES_AP_MLD_MAC_ADDR\t0x0010\n\n \n\n \nstatic inline u8 ieee80211_mle_common_size(const u8 *data)\n{\n\tconst struct ieee80211_multi_link_elem *mle = (const void *)data;\n\tu16 control = le16_to_cpu(mle->control);\n\tu8 common = 0;\n\n\tswitch (u16_get_bits(control, IEEE80211_ML_CONTROL_TYPE)) {\n\tcase IEEE80211_ML_CONTROL_TYPE_BASIC:\n\tcase IEEE80211_ML_CONTROL_TYPE_PREQ:\n\tcase IEEE80211_ML_CONTROL_TYPE_TDLS:\n\tcase IEEE80211_ML_CONTROL_TYPE_RECONF:\n\t\t \n\t\tbreak;\n\tcase IEEE80211_ML_CONTROL_TYPE_PRIO_ACCESS:\n\t\tif (control & IEEE80211_MLC_PRIO_ACCESS_PRES_AP_MLD_MAC_ADDR)\n\t\t\tcommon += ETH_ALEN;\n\t\treturn common;\n\tdefault:\n\t\tWARN_ON(1);\n\t\treturn 0;\n\t}\n\n\treturn sizeof(*mle) + common + mle->variable[0];\n}\n\n \nstatic inline u8\nieee80211_mle_get_bss_param_ch_cnt(const struct ieee80211_multi_link_elem *mle)\n{\n\tu16 control = le16_to_cpu(mle->control);\n\tconst u8 *common = mle->variable;\n\n\t \n\tcommon += sizeof(struct ieee80211_mle_basic_common_info);\n\n\tif (!(control & IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT))\n\t\treturn 0;\n\n\tif (control & IEEE80211_MLC_BASIC_PRES_LINK_ID)\n\t\tcommon += 1;\n\n\treturn *common;\n}\n\n \nstatic inline u16 ieee80211_mle_get_eml_med_sync_delay(const u8 *data)\n{\n\tconst struct ieee80211_multi_link_elem *mle = (const void *)data;\n\tu16 control = le16_to_cpu(mle->control);\n\tconst u8 *common = mle->variable;\n\n\t \n\tcommon += sizeof(struct ieee80211_mle_basic_common_info);\n\n\tif (!(control & IEEE80211_MLC_BASIC_PRES_MED_SYNC_DELAY))\n\t\treturn IEEE80211_MED_SYNC_DELAY_DEFAULT;\n\n\tif (control & IEEE80211_MLC_BASIC_PRES_LINK_ID)\n\t\tcommon += 1;\n\tif (control & IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT)\n\t\tcommon += 1;\n\n\treturn get_unaligned_le16(common);\n}\n\n \nstatic inline u16 ieee80211_mle_get_eml_cap(const u8 *data)\n{\n\tconst struct ieee80211_multi_link_elem *mle = (const void *)data;\n\tu16 control = le16_to_cpu(mle->control);\n\tconst u8 *common = mle->variable;\n\n\t \n\tcommon += sizeof(struct ieee80211_mle_basic_common_info);\n\n\tif (!(control & IEEE80211_MLC_BASIC_PRES_EML_CAPA))\n\t\treturn 0;\n\n\tif (control & IEEE80211_MLC_BASIC_PRES_LINK_ID)\n\t\tcommon += 1;\n\tif (control & IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT)\n\t\tcommon += 1;\n\tif (control & IEEE80211_MLC_BASIC_PRES_MED_SYNC_DELAY)\n\t\tcommon += 2;\n\n\treturn get_unaligned_le16(common);\n}\n\n \nstatic inline bool ieee80211_mle_size_ok(const u8 *data, size_t len)\n{\n\tconst struct ieee80211_multi_link_elem *mle = (const void *)data;\n\tu8 fixed = sizeof(*mle);\n\tu8 common = 0;\n\tbool check_common_len = false;\n\tu16 control;\n\n\tif (len < fixed)\n\t\treturn false;\n\n\tcontrol = le16_to_cpu(mle->control);\n\n\tswitch (u16_get_bits(control, IEEE80211_ML_CONTROL_TYPE)) {\n\tcase IEEE80211_ML_CONTROL_TYPE_BASIC:\n\t\tcommon += sizeof(struct ieee80211_mle_basic_common_info);\n\t\tcheck_common_len = true;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_LINK_ID)\n\t\t\tcommon += 1;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_BSS_PARAM_CH_CNT)\n\t\t\tcommon += 1;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_MED_SYNC_DELAY)\n\t\t\tcommon += 2;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_EML_CAPA)\n\t\t\tcommon += 2;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_MLD_CAPA_OP)\n\t\t\tcommon += 2;\n\t\tif (control & IEEE80211_MLC_BASIC_PRES_MLD_ID)\n\t\t\tcommon += 1;\n\t\tbreak;\n\tcase IEEE80211_ML_CONTROL_TYPE_PREQ:\n\t\tcommon += sizeof(struct ieee80211_mle_preq_common_info);\n\t\tif (control & IEEE80211_MLC_PREQ_PRES_MLD_ID)\n\t\t\tcommon += 1;\n\t\tcheck_common_len = true;\n\t\tbreak;\n\tcase IEEE80211_ML_CONTROL_TYPE_RECONF:\n\t\tif (control & IEEE80211_MLC_RECONF_PRES_MLD_MAC_ADDR)\n\t\t\tcommon += ETH_ALEN;\n\t\tbreak;\n\tcase IEEE80211_ML_CONTROL_TYPE_TDLS:\n\t\tcommon += sizeof(struct ieee80211_mle_tdls_common_info);\n\t\tcheck_common_len = true;\n\t\tbreak;\n\tcase IEEE80211_ML_CONTROL_TYPE_PRIO_ACCESS:\n\t\tif (control & IEEE80211_MLC_PRIO_ACCESS_PRES_AP_MLD_MAC_ADDR)\n\t\t\tcommon += ETH_ALEN;\n\t\tbreak;\n\tdefault:\n\t\t \n\t\treturn true;\n\t}\n\n\tif (len < fixed + common)\n\t\treturn false;\n\n\tif (!check_common_len)\n\t\treturn true;\n\n\t \n\treturn mle->variable[0] >= common;\n}\n\n \nstatic inline bool ieee80211_mle_type_ok(const u8 *data, u8 type, size_t len)\n{\n\tconst struct ieee80211_multi_link_elem *mle = (const void *)data;\n\tu16 control;\n\n\tif (!ieee80211_mle_size_ok(data, len))\n\t\treturn false;\n\n\tcontrol = le16_to_cpu(mle->control);\n\n\tif (u16_get_bits(control, IEEE80211_ML_CONTROL_TYPE) == type)\n\t\treturn true;\n\n\treturn false;\n}\n\nenum ieee80211_mle_subelems {\n\tIEEE80211_MLE_SUBELEM_PER_STA_PROFILE\t\t= 0,\n\tIEEE80211_MLE_SUBELEM_FRAGMENT\t\t        = 254,\n};\n\n#define IEEE80211_MLE_STA_CONTROL_LINK_ID\t\t\t0x000f\n#define IEEE80211_MLE_STA_CONTROL_COMPLETE_PROFILE\t\t0x0010\n#define IEEE80211_MLE_STA_CONTROL_STA_MAC_ADDR_PRESENT\t\t0x0020\n#define IEEE80211_MLE_STA_CONTROL_BEACON_INT_PRESENT\t\t0x0040\n#define IEEE80211_MLE_STA_CONTROL_TSF_OFFS_PRESENT\t\t0x0080\n#define IEEE80211_MLE_STA_CONTROL_DTIM_INFO_PRESENT\t\t0x0100\n#define IEEE80211_MLE_STA_CONTROL_NSTR_LINK_PAIR_PRESENT\t0x0200\n#define IEEE80211_MLE_STA_CONTROL_NSTR_BITMAP_SIZE\t\t0x0400\n#define IEEE80211_MLE_STA_CONTROL_BSS_PARAM_CHANGE_CNT_PRESENT\t0x0800\n\nstruct ieee80211_mle_per_sta_profile {\n\t__le16 control;\n\tu8 sta_info_len;\n\tu8 variable[];\n} __packed;\n\n \nstatic inline bool ieee80211_mle_basic_sta_prof_size_ok(const u8 *data,\n\t\t\t\t\t\t\tsize_t len)\n{\n\tconst struct ieee80211_mle_per_sta_profile *prof = (const void *)data;\n\tu16 control;\n\tu8 fixed = sizeof(*prof);\n\tu8 info_len = 1;\n\n\tif (len < fixed)\n\t\treturn false;\n\n\tcontrol = le16_to_cpu(prof->control);\n\n\tif (control & IEEE80211_MLE_STA_CONTROL_STA_MAC_ADDR_PRESENT)\n\t\tinfo_len += 6;\n\tif (control & IEEE80211_MLE_STA_CONTROL_BEACON_INT_PRESENT)\n\t\tinfo_len += 2;\n\tif (control & IEEE80211_MLE_STA_CONTROL_TSF_OFFS_PRESENT)\n\t\tinfo_len += 8;\n\tif (control & IEEE80211_MLE_STA_CONTROL_DTIM_INFO_PRESENT)\n\t\tinfo_len += 2;\n\tif (control & IEEE80211_MLE_STA_CONTROL_COMPLETE_PROFILE &&\n\t    control & IEEE80211_MLE_STA_CONTROL_NSTR_LINK_PAIR_PRESENT) {\n\t\tif (control & IEEE80211_MLE_STA_CONTROL_NSTR_BITMAP_SIZE)\n\t\t\tinfo_len += 2;\n\t\telse\n\t\t\tinfo_len += 1;\n\t}\n\tif (control & IEEE80211_MLE_STA_CONTROL_BSS_PARAM_CHANGE_CNT_PRESENT)\n\t\tinfo_len += 1;\n\n\treturn prof->sta_info_len >= info_len &&\n\t       fixed + prof->sta_info_len <= len;\n}\n\n \nstatic inline u8\nieee80211_mle_basic_sta_prof_bss_param_ch_cnt(const struct ieee80211_mle_per_sta_profile *prof)\n{\n\tu16 control = le16_to_cpu(prof->control);\n\tconst u8 *pos = prof->variable;\n\n\tif (!(control & IEEE80211_MLE_STA_CONTROL_BSS_PARAM_CHANGE_CNT_PRESENT))\n\t\treturn 0;\n\n\tif (control & IEEE80211_MLE_STA_CONTROL_STA_MAC_ADDR_PRESENT)\n\t\tpos += 6;\n\tif (control & IEEE80211_MLE_STA_CONTROL_BEACON_INT_PRESENT)\n\t\tpos += 2;\n\tif (control & IEEE80211_MLE_STA_CONTROL_TSF_OFFS_PRESENT)\n\t\tpos += 8;\n\tif (control & IEEE80211_MLE_STA_CONTROL_DTIM_INFO_PRESENT)\n\t\tpos += 2;\n\tif (control & IEEE80211_MLE_STA_CONTROL_COMPLETE_PROFILE &&\n\t    control & IEEE80211_MLE_STA_CONTROL_NSTR_LINK_PAIR_PRESENT) {\n\t\tif (control & IEEE80211_MLE_STA_CONTROL_NSTR_BITMAP_SIZE)\n\t\t\tpos += 2;\n\t\telse\n\t\t\tpos += 1;\n\t}\n\n\treturn *pos;\n}\n\n#define IEEE80211_MLE_STA_RECONF_CONTROL_LINK_ID\t\t\t0x000f\n#define IEEE80211_MLE_STA_RECONF_CONTROL_COMPLETE_PROFILE\t\t0x0010\n#define IEEE80211_MLE_STA_RECONF_CONTROL_STA_MAC_ADDR_PRESENT\t\t0x0020\n#define IEEE80211_MLE_STA_RECONF_CONTROL_AP_REM_TIMER_PRESENT\t\t0x0040\n#define IEEE80211_MLE_STA_RECONF_CONTROL_OPERATION_UPDATE_TYPE\t\t0x0780\n#define IEEE80211_MLE_STA_RECONF_CONTROL_OPERATION_PARAMS_PRESENT\t0x0800\n\n \nstatic inline bool ieee80211_mle_reconf_sta_prof_size_ok(const u8 *data,\n\t\t\t\t\t\t\t size_t len)\n{\n\tconst struct ieee80211_mle_per_sta_profile *prof = (const void *)data;\n\tu16 control;\n\tu8 fixed = sizeof(*prof);\n\tu8 info_len = 1;\n\n\tif (len < fixed)\n\t\treturn false;\n\n\tcontrol = le16_to_cpu(prof->control);\n\n\tif (control & IEEE80211_MLE_STA_RECONF_CONTROL_STA_MAC_ADDR_PRESENT)\n\t\tinfo_len += ETH_ALEN;\n\tif (control & IEEE80211_MLE_STA_RECONF_CONTROL_AP_REM_TIMER_PRESENT)\n\t\tinfo_len += 2;\n\tif (control & IEEE80211_MLE_STA_RECONF_CONTROL_OPERATION_PARAMS_PRESENT)\n\t\tinfo_len += 2;\n\n\treturn prof->sta_info_len >= info_len &&\n\t       fixed + prof->sta_info_len - 1 <= len;\n}\n\n#define for_each_mle_subelement(_elem, _data, _len)\t\t\t\\\n\tif (ieee80211_mle_size_ok(_data, _len))\t\t\t\t\\\n\t\tfor_each_element(_elem,\t\t\t\t\t\\\n\t\t\t\t _data + ieee80211_mle_common_size(_data),\\\n\t\t\t\t _len - ieee80211_mle_common_size(_data))\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}