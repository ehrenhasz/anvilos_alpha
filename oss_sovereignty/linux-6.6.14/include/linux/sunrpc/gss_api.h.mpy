{
  "module_name": "gss_api.h",
  "hash_id": "58be6be331e5d0ee48d4f94ed2b4efef17c68590d9c7fce81380ec9c0aae3f85",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sunrpc/gss_api.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_SUNRPC_GSS_API_H\n#define _LINUX_SUNRPC_GSS_API_H\n\n#include <linux/sunrpc/xdr.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/uio.h>\n\n \nstruct gss_ctx {\n\tstruct gss_api_mech\t*mech_type;\n\tvoid\t\t\t*internal_ctx_id;\n\tunsigned int\t\tslack, align;\n};\n\n#define GSS_C_NO_BUFFER\t\t((struct xdr_netobj) 0)\n#define GSS_C_NO_CONTEXT\t((struct gss_ctx *) 0)\n#define GSS_C_QOP_DEFAULT\t(0)\n\n \n#define GSS_OID_MAX_LEN 32\nstruct rpcsec_gss_oid {\n\tunsigned int\tlen;\n\tu8\t\tdata[GSS_OID_MAX_LEN];\n};\n\n \nstruct rpcsec_gss_info {\n\tstruct rpcsec_gss_oid\toid;\n\tu32\t\t\tqop;\n\tu32\t\t\tservice;\n};\n\n \nint gss_import_sec_context(\n\t\tconst void*\t\tinput_token,\n\t\tsize_t\t\t\tbufsize,\n\t\tstruct gss_api_mech\t*mech,\n\t\tstruct gss_ctx\t\t**ctx_id,\n\t\ttime64_t\t\t*endtime,\n\t\tgfp_t\t\t\tgfp_mask);\nu32 gss_get_mic(\n\t\tstruct gss_ctx\t\t*ctx_id,\n\t\tstruct xdr_buf\t\t*message,\n\t\tstruct xdr_netobj\t*mic_token);\nu32 gss_verify_mic(\n\t\tstruct gss_ctx\t\t*ctx_id,\n\t\tstruct xdr_buf\t\t*message,\n\t\tstruct xdr_netobj\t*mic_token);\nu32 gss_wrap(\n\t\tstruct gss_ctx\t\t*ctx_id,\n\t\tint\t\t\toffset,\n\t\tstruct xdr_buf\t\t*outbuf,\n\t\tstruct page\t\t**inpages);\nu32 gss_unwrap(\n\t\tstruct gss_ctx\t\t*ctx_id,\n\t\tint\t\t\toffset,\n\t\tint\t\t\tlen,\n\t\tstruct xdr_buf\t\t*inbuf);\nu32 gss_delete_sec_context(\n\t\tstruct gss_ctx\t\t**ctx_id);\n\nrpc_authflavor_t gss_svc_to_pseudoflavor(struct gss_api_mech *, u32 qop,\n\t\t\t\t\tu32 service);\nu32 gss_pseudoflavor_to_service(struct gss_api_mech *, u32 pseudoflavor);\nbool gss_pseudoflavor_to_datatouch(struct gss_api_mech *, u32 pseudoflavor);\nchar *gss_service_to_auth_domain_name(struct gss_api_mech *, u32 service);\n\nstruct pf_desc {\n\tu32\tpseudoflavor;\n\tu32\tqop;\n\tu32\tservice;\n\tchar\t*name;\n\tchar\t*auth_domain_name;\n\tstruct auth_domain *domain;\n\tbool\tdatatouch;\n};\n\n \n\n \nstruct gss_api_mech {\n\tstruct list_head\tgm_list;\n\tstruct module\t\t*gm_owner;\n\tstruct rpcsec_gss_oid\tgm_oid;\n\tchar\t\t\t*gm_name;\n\tconst struct gss_api_ops *gm_ops;\n\t \n\tint\t\t\tgm_pf_num;\n\tstruct pf_desc *\tgm_pfs;\n\t \n\tconst char\t\t*gm_upcall_enctypes;\n};\n\n \nstruct gss_api_ops {\n\tint (*gss_import_sec_context)(\n\t\t\tconst void\t\t*input_token,\n\t\t\tsize_t\t\t\tbufsize,\n\t\t\tstruct gss_ctx\t\t*ctx_id,\n\t\t\ttime64_t\t\t*endtime,\n\t\t\tgfp_t\t\t\tgfp_mask);\n\tu32 (*gss_get_mic)(\n\t\t\tstruct gss_ctx\t\t*ctx_id,\n\t\t\tstruct xdr_buf\t\t*message,\n\t\t\tstruct xdr_netobj\t*mic_token);\n\tu32 (*gss_verify_mic)(\n\t\t\tstruct gss_ctx\t\t*ctx_id,\n\t\t\tstruct xdr_buf\t\t*message,\n\t\t\tstruct xdr_netobj\t*mic_token);\n\tu32 (*gss_wrap)(\n\t\t\tstruct gss_ctx\t\t*ctx_id,\n\t\t\tint\t\t\toffset,\n\t\t\tstruct xdr_buf\t\t*outbuf,\n\t\t\tstruct page\t\t**inpages);\n\tu32 (*gss_unwrap)(\n\t\t\tstruct gss_ctx\t\t*ctx_id,\n\t\t\tint\t\t\toffset,\n\t\t\tint\t\t\tlen,\n\t\t\tstruct xdr_buf\t\t*buf);\n\tvoid (*gss_delete_sec_context)(\n\t\t\tvoid\t\t\t*internal_ctx_id);\n};\n\nint gss_mech_register(struct gss_api_mech *);\nvoid gss_mech_unregister(struct gss_api_mech *);\n\n \nstruct gss_api_mech * gss_mech_get_by_OID(struct rpcsec_gss_oid *);\n\n \nrpc_authflavor_t gss_mech_info2flavor(struct rpcsec_gss_info *);\n\n \nint gss_mech_flavor2info(rpc_authflavor_t, struct rpcsec_gss_info *);\n\n \nstruct gss_api_mech *gss_mech_get_by_name(const char *);\n\n \nstruct gss_api_mech *gss_mech_get_by_pseudoflavor(u32);\n\nstruct gss_api_mech * gss_mech_get(struct gss_api_mech *);\n\n \nvoid gss_mech_put(struct gss_api_mech *);\n\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}