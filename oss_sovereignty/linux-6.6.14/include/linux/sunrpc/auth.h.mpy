{
  "module_name": "auth.h",
  "hash_id": "b13a27c2932f127c99af90ffaf3c3316a5a02eaf306c40ff14e837121a05a008",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sunrpc/auth.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_SUNRPC_AUTH_H\n#define _LINUX_SUNRPC_AUTH_H\n\n#include <linux/sunrpc/sched.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/xdr.h>\n\n#include <linux/atomic.h>\n#include <linux/rcupdate.h>\n#include <linux/uidgid.h>\n#include <linux/utsname.h>\n\n \n#define NUL_CALLSLACK\t(4)\n#define NUL_REPLYSLACK\t(2)\n\n \n#define UNX_MAXNODENAME\t__NEW_UTS_LEN\n#define UNX_CALLSLACK\t(21 + XDR_QUADLEN(UNX_MAXNODENAME))\n#define UNX_NGROUPS\t16\n\nstruct rpcsec_gss_info;\n\nstruct auth_cred {\n\tconst struct cred *cred;\n\tconst char *principal;\t \n};\n\n \nstruct rpc_auth;\nstruct rpc_credops;\nstruct rpc_cred {\n\tstruct hlist_node\tcr_hash;\t \n\tstruct list_head\tcr_lru;\t\t \n\tstruct rcu_head\t\tcr_rcu;\n\tstruct rpc_auth *\tcr_auth;\n\tconst struct rpc_credops *cr_ops;\n\tunsigned long\t\tcr_expire;\t \n\tunsigned long\t\tcr_flags;\t \n\trefcount_t\t\tcr_count;\t \n\tconst struct cred\t*cr_cred;\n\n\t \n};\n#define RPCAUTH_CRED_NEW\t0\n#define RPCAUTH_CRED_UPTODATE\t1\n#define RPCAUTH_CRED_HASHED\t2\n#define RPCAUTH_CRED_NEGATIVE\t3\n\nconst struct cred *rpc_machine_cred(void);\n\n \nstruct rpc_cred_cache;\nstruct rpc_authops;\nstruct rpc_auth {\n\tunsigned int\t\tau_cslack;\t \n\tunsigned int\t\tau_rslack;\t \n\tunsigned int\t\tau_verfsize;\t \n\tunsigned int\t\tau_ralign;\t \n\n\tunsigned long\t\tau_flags;\n\tconst struct rpc_authops *au_ops;\n\trpc_authflavor_t\tau_flavor;\t \n\trefcount_t\t\tau_count;\t \n\n\tstruct rpc_cred_cache *\tau_credcache;\n\t \n};\n\n \n#define RPCAUTH_AUTH_DATATOUCH\t\t(1)\n#define RPCAUTH_AUTH_UPDATE_SLACK\t(2)\n\nstruct rpc_auth_create_args {\n\trpc_authflavor_t pseudoflavor;\n\tconst char *target_name;\n};\n\n \n#define RPCAUTH_LOOKUP_NEW\t\t0x01\t \n#define RPCAUTH_LOOKUP_ASYNC\t\t0x02\t \n\n \nstruct rpc_authops {\n\tstruct module\t\t*owner;\n\trpc_authflavor_t\tau_flavor;\t \n\tchar *\t\t\tau_name;\n\tstruct rpc_auth *\t(*create)(const struct rpc_auth_create_args *,\n\t\t\t\t\t  struct rpc_clnt *);\n\tvoid\t\t\t(*destroy)(struct rpc_auth *);\n\n\tint\t\t\t(*hash_cred)(struct auth_cred *, unsigned int);\n\tstruct rpc_cred *\t(*lookup_cred)(struct rpc_auth *, struct auth_cred *, int);\n\tstruct rpc_cred *\t(*crcreate)(struct rpc_auth*, struct auth_cred *, int, gfp_t);\n\trpc_authflavor_t\t(*info2flavor)(struct rpcsec_gss_info *);\n\tint\t\t\t(*flavor2info)(rpc_authflavor_t,\n\t\t\t\t\t\tstruct rpcsec_gss_info *);\n\tint\t\t\t(*key_timeout)(struct rpc_auth *,\n\t\t\t\t\t\tstruct rpc_cred *);\n\tint\t\t\t(*ping)(struct rpc_clnt *clnt);\n};\n\nstruct rpc_credops {\n\tconst char *\t\tcr_name;\t \n\tint\t\t\t(*cr_init)(struct rpc_auth *, struct rpc_cred *);\n\tvoid\t\t\t(*crdestroy)(struct rpc_cred *);\n\n\tint\t\t\t(*crmatch)(struct auth_cred *, struct rpc_cred *, int);\n\tint\t\t\t(*crmarshal)(struct rpc_task *task,\n\t\t\t\t\t     struct xdr_stream *xdr);\n\tint\t\t\t(*crrefresh)(struct rpc_task *);\n\tint\t\t\t(*crvalidate)(struct rpc_task *task,\n\t\t\t\t\t      struct xdr_stream *xdr);\n\tint\t\t\t(*crwrap_req)(struct rpc_task *task,\n\t\t\t\t\t      struct xdr_stream *xdr);\n\tint\t\t\t(*crunwrap_resp)(struct rpc_task *task,\n\t\t\t\t\t\t struct xdr_stream *xdr);\n\tint\t\t\t(*crkey_timeout)(struct rpc_cred *);\n\tchar *\t\t\t(*crstringify_acceptor)(struct rpc_cred *);\n\tbool\t\t\t(*crneed_reencode)(struct rpc_task *);\n};\n\nextern const struct rpc_authops\tauthunix_ops;\nextern const struct rpc_authops\tauthnull_ops;\nextern const struct rpc_authops\tauthtls_ops;\n\nint __init\t\trpc_init_authunix(void);\nint __init\t\trpcauth_init_module(void);\nvoid\t\t\trpcauth_remove_module(void);\nvoid \t\t\trpc_destroy_authunix(void);\n\nint\t\t\trpcauth_register(const struct rpc_authops *);\nint\t\t\trpcauth_unregister(const struct rpc_authops *);\nstruct rpc_auth *\trpcauth_create(const struct rpc_auth_create_args *,\n\t\t\t\tstruct rpc_clnt *);\nvoid\t\t\trpcauth_release(struct rpc_auth *);\nrpc_authflavor_t\trpcauth_get_pseudoflavor(rpc_authflavor_t,\n\t\t\t\tstruct rpcsec_gss_info *);\nint\t\t\trpcauth_get_gssinfo(rpc_authflavor_t,\n\t\t\t\tstruct rpcsec_gss_info *);\nstruct rpc_cred *\trpcauth_lookup_credcache(struct rpc_auth *, struct auth_cred *, int, gfp_t);\nvoid\t\t\trpcauth_init_cred(struct rpc_cred *, const struct auth_cred *, struct rpc_auth *, const struct rpc_credops *);\nstruct rpc_cred *\trpcauth_lookupcred(struct rpc_auth *, int);\nvoid\t\t\tput_rpccred(struct rpc_cred *);\nint\t\t\trpcauth_marshcred(struct rpc_task *task,\n\t\t\t\t\t  struct xdr_stream *xdr);\nint\t\t\trpcauth_checkverf(struct rpc_task *task,\n\t\t\t\t\t  struct xdr_stream *xdr);\nint\t\t\trpcauth_wrap_req_encode(struct rpc_task *task,\n\t\t\t\t\t\tstruct xdr_stream *xdr);\nint\t\t\trpcauth_wrap_req(struct rpc_task *task,\n\t\t\t\t\t struct xdr_stream *xdr);\nint\t\t\trpcauth_unwrap_resp_decode(struct rpc_task *task,\n\t\t\t\t\t\t   struct xdr_stream *xdr);\nint\t\t\trpcauth_unwrap_resp(struct rpc_task *task,\n\t\t\t\t\t    struct xdr_stream *xdr);\nbool\t\t\trpcauth_xmit_need_reencode(struct rpc_task *task);\nint\t\t\trpcauth_refreshcred(struct rpc_task *);\nvoid\t\t\trpcauth_invalcred(struct rpc_task *);\nint\t\t\trpcauth_uptodatecred(struct rpc_task *);\nint\t\t\trpcauth_init_credcache(struct rpc_auth *);\nvoid\t\t\trpcauth_destroy_credcache(struct rpc_auth *);\nvoid\t\t\trpcauth_clear_credcache(struct rpc_cred_cache *);\nchar *\t\t\trpcauth_stringify_acceptor(struct rpc_cred *);\n\nstatic inline\nstruct rpc_cred *get_rpccred(struct rpc_cred *cred)\n{\n\tif (cred != NULL && refcount_inc_not_zero(&cred->cr_count))\n\t\treturn cred;\n\treturn NULL;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}