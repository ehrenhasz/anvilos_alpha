{
  "module_name": "addr.h",
  "hash_id": "c2fe47b9cb37e57e77746ec11b44d345d53fc1547b1520f419f73c5b63510cf3",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sunrpc/addr.h",
  "human_readable_source": " \n \n#ifndef _LINUX_SUNRPC_ADDR_H\n#define _LINUX_SUNRPC_ADDR_H\n\n#include <linux/socket.h>\n#include <linux/in.h>\n#include <linux/in6.h>\n#include <net/ipv6.h>\n\nsize_t\t\trpc_ntop(const struct sockaddr *, char *, const size_t);\nsize_t\t\trpc_pton(struct net *, const char *, const size_t,\n\t\t\t struct sockaddr *, const size_t);\nchar *\t\trpc_sockaddr2uaddr(const struct sockaddr *, gfp_t);\nsize_t\t\trpc_uaddr2sockaddr(struct net *, const char *, const size_t,\n\t\t\t\t   struct sockaddr *, const size_t);\n\nstatic inline unsigned short rpc_get_port(const struct sockaddr *sap)\n{\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\treturn ntohs(((struct sockaddr_in *)sap)->sin_port);\n\tcase AF_INET6:\n\t\treturn ntohs(((struct sockaddr_in6 *)sap)->sin6_port);\n\t}\n\treturn 0;\n}\n\nstatic inline void rpc_set_port(struct sockaddr *sap,\n\t\t\t\tconst unsigned short port)\n{\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\t((struct sockaddr_in *)sap)->sin_port = htons(port);\n\t\tbreak;\n\tcase AF_INET6:\n\t\t((struct sockaddr_in6 *)sap)->sin6_port = htons(port);\n\t\tbreak;\n\t}\n}\n\n#define IPV6_SCOPE_DELIMITER\t\t'%'\n#define IPV6_SCOPE_ID_LEN\t\tsizeof(\"%nnnnnnnnnn\")\n\nstatic inline bool rpc_cmp_addr4(const struct sockaddr *sap1,\n\t\t\t\t const struct sockaddr *sap2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sap1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sap2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}\n\nstatic inline bool __rpc_copy_addr4(struct sockaddr *dst,\n\t\t\t\t    const struct sockaddr *src)\n{\n\tconst struct sockaddr_in *ssin = (struct sockaddr_in *) src;\n\tstruct sockaddr_in *dsin = (struct sockaddr_in *) dst;\n\n\tdsin->sin_family = ssin->sin_family;\n\tdsin->sin_addr.s_addr = ssin->sin_addr.s_addr;\n\treturn true;\n}\n\n#if IS_ENABLED(CONFIG_IPV6)\nstatic inline bool rpc_cmp_addr6(const struct sockaddr *sap1,\n\t\t\t\t const struct sockaddr *sap2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sap1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sap2;\n\n\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\treturn false;\n\telse if (ipv6_addr_type(&sin1->sin6_addr) & IPV6_ADDR_LINKLOCAL)\n\t\treturn sin1->sin6_scope_id == sin2->sin6_scope_id;\n\n\treturn true;\n}\n\nstatic inline bool __rpc_copy_addr6(struct sockaddr *dst,\n\t\t\t\t    const struct sockaddr *src)\n{\n\tconst struct sockaddr_in6 *ssin6 = (const struct sockaddr_in6 *) src;\n\tstruct sockaddr_in6 *dsin6 = (struct sockaddr_in6 *) dst;\n\n\tdsin6->sin6_family = ssin6->sin6_family;\n\tdsin6->sin6_addr = ssin6->sin6_addr;\n\tdsin6->sin6_scope_id = ssin6->sin6_scope_id;\n\treturn true;\n}\n#else\t \nstatic inline bool rpc_cmp_addr6(const struct sockaddr *sap1,\n\t\t\t\t   const struct sockaddr *sap2)\n{\n\treturn false;\n}\n\nstatic inline bool __rpc_copy_addr6(struct sockaddr *dst,\n\t\t\t\t    const struct sockaddr *src)\n{\n\treturn false;\n}\n#endif\t \n\n \nstatic inline bool rpc_cmp_addr(const struct sockaddr *sap1,\n\t\t\t\tconst struct sockaddr *sap2)\n{\n\tif (sap1->sa_family == sap2->sa_family) {\n\t\tswitch (sap1->sa_family) {\n\t\tcase AF_INET:\n\t\t\treturn rpc_cmp_addr4(sap1, sap2);\n\t\tcase AF_INET6:\n\t\t\treturn rpc_cmp_addr6(sap1, sap2);\n\t\t}\n\t}\n\treturn false;\n}\n\n \nstatic inline bool rpc_cmp_addr_port(const struct sockaddr *sap1,\n\t\t\t\t     const struct sockaddr *sap2)\n{\n\tif (!rpc_cmp_addr(sap1, sap2))\n\t\treturn false;\n\treturn rpc_get_port(sap1) == rpc_get_port(sap2);\n}\n\n \nstatic inline bool rpc_copy_addr(struct sockaddr *dst,\n\t\t\t\t const struct sockaddr *src)\n{\n\tswitch (src->sa_family) {\n\tcase AF_INET:\n\t\treturn __rpc_copy_addr4(dst, src);\n\tcase AF_INET6:\n\t\treturn __rpc_copy_addr6(dst, src);\n\t}\n\treturn false;\n}\n\n \nstatic inline u32 rpc_get_scope_id(const struct sockaddr *sa)\n{\n\tif (sa->sa_family != AF_INET6)\n\t\treturn 0;\n\n\treturn ((struct sockaddr_in6 *) sa)->sin6_scope_id;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}