{
  "module_name": "svcauth.h",
  "hash_id": "cfa983fb556cbbe26d0522f77621066ec7b3ef79e6435000fefef23c88fb799e",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sunrpc/svcauth.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_SUNRPC_SVCAUTH_H_\n#define _LINUX_SUNRPC_SVCAUTH_H_\n\n#include <linux/string.h>\n#include <linux/sunrpc/msg_prot.h>\n#include <linux/sunrpc/cache.h>\n#include <linux/sunrpc/gss_api.h>\n#include <linux/hash.h>\n#include <linux/stringhash.h>\n#include <linux/cred.h>\n\nstruct svc_cred {\n\tkuid_t\t\t\tcr_uid;\n\tkgid_t\t\t\tcr_gid;\n\tstruct group_info\t*cr_group_info;\n\tu32\t\t\tcr_flavor;  \n\t \n\tchar\t\t\t*cr_raw_principal;\n\t \n\tchar\t\t\t*cr_principal;\n\tchar\t\t\t*cr_targ_princ;\n\tstruct gss_api_mech\t*cr_gss_mech;\n};\n\nstatic inline void init_svc_cred(struct svc_cred *cred)\n{\n\tcred->cr_group_info = NULL;\n\tcred->cr_raw_principal = NULL;\n\tcred->cr_principal = NULL;\n\tcred->cr_targ_princ = NULL;\n\tcred->cr_gss_mech = NULL;\n}\n\nstatic inline void free_svc_cred(struct svc_cred *cred)\n{\n\tif (cred->cr_group_info)\n\t\tput_group_info(cred->cr_group_info);\n\tkfree(cred->cr_raw_principal);\n\tkfree(cred->cr_principal);\n\tkfree(cred->cr_targ_princ);\n\tgss_mech_put(cred->cr_gss_mech);\n\tinit_svc_cred(cred);\n}\n\nstruct svc_rqst;\t\t \nstruct in6_addr;\n\n \nstruct auth_domain {\n\tstruct kref\t\tref;\n\tstruct hlist_node\thash;\n\tchar\t\t\t*name;\n\tstruct auth_ops\t\t*flavour;\n\tstruct rcu_head\t\trcu_head;\n};\n\nenum svc_auth_status {\n\tSVC_GARBAGE = 1,\n\tSVC_SYSERR,\n\tSVC_VALID,\n\tSVC_NEGATIVE,\n\tSVC_OK,\n\tSVC_DROP,\n\tSVC_CLOSE,\n\tSVC_DENIED,\n\tSVC_PENDING,\n\tSVC_COMPLETE,\n};\n\n \nstruct auth_ops {\n\tchar *\tname;\n\tstruct module *owner;\n\tint\tflavour;\n\n\tenum svc_auth_status\t(*accept)(struct svc_rqst *rqstp);\n\tint\t\t\t(*release)(struct svc_rqst *rqstp);\n\tvoid\t\t\t(*domain_release)(struct auth_domain *dom);\n\tenum svc_auth_status\t(*set_client)(struct svc_rqst *rqstp);\n};\n\nstruct svc_xprt;\n\nextern enum svc_auth_status svc_authenticate(struct svc_rqst *rqstp);\nextern int\tsvc_authorise(struct svc_rqst *rqstp);\nextern enum svc_auth_status svc_set_client(struct svc_rqst *rqstp);\nextern int\tsvc_auth_register(rpc_authflavor_t flavor, struct auth_ops *aops);\nextern void\tsvc_auth_unregister(rpc_authflavor_t flavor);\n\nextern struct auth_domain *unix_domain_find(char *name);\nextern void auth_domain_put(struct auth_domain *item);\nextern struct auth_domain *auth_domain_lookup(char *name, struct auth_domain *new);\nextern struct auth_domain *auth_domain_find(char *name);\nextern void svcauth_unix_purge(struct net *net);\nextern void svcauth_unix_info_release(struct svc_xprt *xpt);\nextern enum svc_auth_status svcauth_unix_set_client(struct svc_rqst *rqstp);\n\nextern int unix_gid_cache_create(struct net *net);\nextern void unix_gid_cache_destroy(struct net *net);\n\n \nstatic inline unsigned long hash_str(char const *name, int bits)\n{\n\treturn hashlen_hash(hashlen_string(NULL, name)) >> (32 - bits);\n}\n\nstatic inline unsigned long hash_mem(char const *buf, int length, int bits)\n{\n\treturn full_name_hash(NULL, buf, length) >> (32 - bits);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}