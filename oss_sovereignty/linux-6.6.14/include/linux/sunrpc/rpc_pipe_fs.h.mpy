{
  "module_name": "rpc_pipe_fs.h",
  "hash_id": "b6096c27da97291d82e28ff6c9183ea2f8f3a0ad6c8c54c065b0fc845e8eaf80",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sunrpc/rpc_pipe_fs.h",
  "human_readable_source": " \n#ifndef _LINUX_SUNRPC_RPC_PIPE_FS_H\n#define _LINUX_SUNRPC_RPC_PIPE_FS_H\n\n#include <linux/workqueue.h>\n\nstruct rpc_pipe_dir_head {\n\tstruct list_head pdh_entries;\n\tstruct dentry *pdh_dentry;\n};\n\nstruct rpc_pipe_dir_object_ops;\nstruct rpc_pipe_dir_object {\n\tstruct list_head pdo_head;\n\tconst struct rpc_pipe_dir_object_ops *pdo_ops;\n\n\tvoid *pdo_data;\n};\n\nstruct rpc_pipe_dir_object_ops {\n\tint (*create)(struct dentry *dir,\n\t\t\tstruct rpc_pipe_dir_object *pdo);\n\tvoid (*destroy)(struct dentry *dir,\n\t\t\tstruct rpc_pipe_dir_object *pdo);\n};\n\nstruct rpc_pipe_msg {\n\tstruct list_head list;\n\tvoid *data;\n\tsize_t len;\n\tsize_t copied;\n\tint errno;\n};\n\nstruct rpc_pipe_ops {\n\tssize_t (*upcall)(struct file *, struct rpc_pipe_msg *, char __user *, size_t);\n\tssize_t (*downcall)(struct file *, const char __user *, size_t);\n\tvoid (*release_pipe)(struct inode *);\n\tint (*open_pipe)(struct inode *);\n\tvoid (*destroy_msg)(struct rpc_pipe_msg *);\n};\n\nstruct rpc_pipe {\n\tstruct list_head pipe;\n\tstruct list_head in_upcall;\n\tstruct list_head in_downcall;\n\tint pipelen;\n\tint nreaders;\n\tint nwriters;\n#define RPC_PIPE_WAIT_FOR_OPEN\t1\n\tint flags;\n\tstruct delayed_work queue_timeout;\n\tconst struct rpc_pipe_ops *ops;\n\tspinlock_t lock;\n\tstruct dentry *dentry;\n};\n\nstruct rpc_inode {\n\tstruct inode vfs_inode;\n\tvoid *private;\n\tstruct rpc_pipe *pipe;\n\twait_queue_head_t waitq;\n};\n\nstatic inline struct rpc_inode *\nRPC_I(struct inode *inode)\n{\n\treturn container_of(inode, struct rpc_inode, vfs_inode);\n}\n\nenum {\n\tSUNRPC_PIPEFS_NFS_PRIO,\n\tSUNRPC_PIPEFS_RPC_PRIO,\n};\n\nextern int rpc_pipefs_notifier_register(struct notifier_block *);\nextern void rpc_pipefs_notifier_unregister(struct notifier_block *);\n\nenum {\n\tRPC_PIPEFS_MOUNT,\n\tRPC_PIPEFS_UMOUNT,\n};\n\nextern struct dentry *rpc_d_lookup_sb(const struct super_block *sb,\n\t\t\t\t      const unsigned char *dir_name);\nextern int rpc_pipefs_init_net(struct net *net);\nextern void rpc_pipefs_exit_net(struct net *net);\nextern struct super_block *rpc_get_sb_net(const struct net *net);\nextern void rpc_put_sb_net(const struct net *net);\n\nextern ssize_t rpc_pipe_generic_upcall(struct file *, struct rpc_pipe_msg *,\n\t\t\t\t       char __user *, size_t);\nextern int rpc_queue_upcall(struct rpc_pipe *, struct rpc_pipe_msg *);\n\n \nstatic inline bool rpc_msg_is_inflight(const struct rpc_pipe_msg *msg) {\n\treturn (msg->copied != 0 && list_empty(&msg->list));\n}\n\nstruct rpc_clnt;\nextern struct dentry *rpc_create_client_dir(struct dentry *, const char *, struct rpc_clnt *);\nextern int rpc_remove_client_dir(struct rpc_clnt *);\n\nextern void rpc_init_pipe_dir_head(struct rpc_pipe_dir_head *pdh);\nextern void rpc_init_pipe_dir_object(struct rpc_pipe_dir_object *pdo,\n\t\tconst struct rpc_pipe_dir_object_ops *pdo_ops,\n\t\tvoid *pdo_data);\nextern int rpc_add_pipe_dir_object(struct net *net,\n\t\tstruct rpc_pipe_dir_head *pdh,\n\t\tstruct rpc_pipe_dir_object *pdo);\nextern void rpc_remove_pipe_dir_object(struct net *net,\n\t\tstruct rpc_pipe_dir_head *pdh,\n\t\tstruct rpc_pipe_dir_object *pdo);\nextern struct rpc_pipe_dir_object *rpc_find_or_alloc_pipe_dir_object(\n\t\tstruct net *net,\n\t\tstruct rpc_pipe_dir_head *pdh,\n\t\tint (*match)(struct rpc_pipe_dir_object *, void *),\n\t\tstruct rpc_pipe_dir_object *(*alloc)(void *),\n\t\tvoid *data);\n\nstruct cache_detail;\nextern struct dentry *rpc_create_cache_dir(struct dentry *,\n\t\t\t\t\t   const char *,\n\t\t\t\t\t   umode_t umode,\n\t\t\t\t\t   struct cache_detail *);\nextern void rpc_remove_cache_dir(struct dentry *);\n\nstruct rpc_pipe *rpc_mkpipe_data(const struct rpc_pipe_ops *ops, int flags);\nvoid rpc_destroy_pipe_data(struct rpc_pipe *pipe);\nextern struct dentry *rpc_mkpipe_dentry(struct dentry *, const char *, void *,\n\t\t\t\t\tstruct rpc_pipe *);\nextern int rpc_unlink(struct dentry *);\nextern int register_rpc_pipefs(void);\nextern void unregister_rpc_pipefs(void);\n\nextern bool gssd_running(struct net *net);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}