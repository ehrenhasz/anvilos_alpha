{
  "module_name": "string_helpers.h",
  "hash_id": "4e43047399284cc78bc20a441bda539ef2e095479d281c4b09e65ae5a575d434",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/string_helpers.h",
  "human_readable_source": " \n#ifndef _LINUX_STRING_HELPERS_H_\n#define _LINUX_STRING_HELPERS_H_\n\n#include <linux/bits.h>\n#include <linux/ctype.h>\n#include <linux/string_choices.h>\n#include <linux/string.h>\n#include <linux/types.h>\n\nstruct device;\nstruct file;\nstruct task_struct;\n\nstatic inline bool string_is_terminated(const char *s, int len)\n{\n\treturn memchr(s, '\\0', len) ? true : false;\n}\n\n \nenum string_size_units {\n\tSTRING_UNITS_10,\t \n\tSTRING_UNITS_2,\t\t \n};\n\nvoid string_get_size(u64 size, u64 blk_size, enum string_size_units units,\n\t\t     char *buf, int len);\n\nint parse_int_array_user(const char __user *from, size_t count, int **array);\n\n#define UNESCAPE_SPACE\t\tBIT(0)\n#define UNESCAPE_OCTAL\t\tBIT(1)\n#define UNESCAPE_HEX\t\tBIT(2)\n#define UNESCAPE_SPECIAL\tBIT(3)\n#define UNESCAPE_ANY\t\t\\\n\t(UNESCAPE_SPACE | UNESCAPE_OCTAL | UNESCAPE_HEX | UNESCAPE_SPECIAL)\n\n#define UNESCAPE_ALL_MASK\tGENMASK(3, 0)\n\nint string_unescape(char *src, char *dst, size_t size, unsigned int flags);\n\nstatic inline int string_unescape_inplace(char *buf, unsigned int flags)\n{\n\treturn string_unescape(buf, buf, 0, flags);\n}\n\nstatic inline int string_unescape_any(char *src, char *dst, size_t size)\n{\n\treturn string_unescape(src, dst, size, UNESCAPE_ANY);\n}\n\nstatic inline int string_unescape_any_inplace(char *buf)\n{\n\treturn string_unescape_any(buf, buf, 0);\n}\n\n#define ESCAPE_SPACE\t\tBIT(0)\n#define ESCAPE_SPECIAL\t\tBIT(1)\n#define ESCAPE_NULL\t\tBIT(2)\n#define ESCAPE_OCTAL\t\tBIT(3)\n#define ESCAPE_ANY\t\t\\\n\t(ESCAPE_SPACE | ESCAPE_OCTAL | ESCAPE_SPECIAL | ESCAPE_NULL)\n#define ESCAPE_NP\t\tBIT(4)\n#define ESCAPE_ANY_NP\t\t(ESCAPE_ANY | ESCAPE_NP)\n#define ESCAPE_HEX\t\tBIT(5)\n#define ESCAPE_NA\t\tBIT(6)\n#define ESCAPE_NAP\t\tBIT(7)\n#define ESCAPE_APPEND\t\tBIT(8)\n\n#define ESCAPE_ALL_MASK\t\tGENMASK(8, 0)\n\nint string_escape_mem(const char *src, size_t isz, char *dst, size_t osz,\n\t\tunsigned int flags, const char *only);\n\nstatic inline int string_escape_mem_any_np(const char *src, size_t isz,\n\t\tchar *dst, size_t osz, const char *only)\n{\n\treturn string_escape_mem(src, isz, dst, osz, ESCAPE_ANY_NP, only);\n}\n\nstatic inline int string_escape_str(const char *src, char *dst, size_t sz,\n\t\tunsigned int flags, const char *only)\n{\n\treturn string_escape_mem(src, strlen(src), dst, sz, flags, only);\n}\n\nstatic inline int string_escape_str_any_np(const char *src, char *dst,\n\t\tsize_t sz, const char *only)\n{\n\treturn string_escape_str(src, dst, sz, ESCAPE_ANY_NP, only);\n}\n\nstatic inline void string_upper(char *dst, const char *src)\n{\n\tdo {\n\t\t*dst++ = toupper(*src);\n\t} while (*src++);\n}\n\nstatic inline void string_lower(char *dst, const char *src)\n{\n\tdo {\n\t\t*dst++ = tolower(*src);\n\t} while (*src++);\n}\n\nchar *kstrdup_quotable(const char *src, gfp_t gfp);\nchar *kstrdup_quotable_cmdline(struct task_struct *task, gfp_t gfp);\nchar *kstrdup_quotable_file(struct file *file, gfp_t gfp);\n\nchar *kstrdup_and_replace(const char *src, char old, char new, gfp_t gfp);\n\nchar **kasprintf_strarray(gfp_t gfp, const char *prefix, size_t n);\nvoid kfree_strarray(char **array, size_t n);\n\nchar **devm_kasprintf_strarray(struct device *dev, const char *prefix, size_t n);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}