{
  "module_name": "sh_clk.h",
  "hash_id": "84868d8e16f819d5039d21cfe37b6881f5e9e4b29ee8074f6b13a0c0c9614618",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sh_clk.h",
  "human_readable_source": " \n#ifndef __SH_CLOCK_H\n#define __SH_CLOCK_H\n\n#include <linux/list.h>\n#include <linux/seq_file.h>\n#include <linux/cpufreq.h>\n#include <linux/types.h>\n#include <linux/kref.h>\n#include <linux/clk.h>\n#include <linux/err.h>\n\nstruct clk;\n\nstruct clk_mapping {\n\tphys_addr_t\t\tphys;\n\tvoid __iomem\t\t*base;\n\tunsigned long\t\tlen;\n\tstruct kref\t\tref;\n};\n\nstruct sh_clk_ops {\n#ifdef CONFIG_SH_CLK_CPG_LEGACY\n\tvoid (*init)(struct clk *clk);\n#endif\n\tint (*enable)(struct clk *clk);\n\tvoid (*disable)(struct clk *clk);\n\tunsigned long (*recalc)(struct clk *clk);\n\tint (*set_rate)(struct clk *clk, unsigned long rate);\n\tint (*set_parent)(struct clk *clk, struct clk *parent);\n\tlong (*round_rate)(struct clk *clk, unsigned long rate);\n};\n\n#define SH_CLK_DIV_MSK(div)\t((1 << (div)) - 1)\n#define SH_CLK_DIV4_MSK\t\tSH_CLK_DIV_MSK(4)\n#define SH_CLK_DIV6_MSK\t\tSH_CLK_DIV_MSK(6)\n\nstruct clk {\n\tstruct list_head\tnode;\n\tstruct clk\t\t*parent;\n\tstruct clk\t\t**parent_table;\t \n\tunsigned short\t\tparent_num;\t \n\tunsigned char\t\tsrc_shift;\t \n\tunsigned char\t\tsrc_width;\t \n\tstruct sh_clk_ops\t*ops;\n\n\tstruct list_head\tchildren;\n\tstruct list_head\tsibling;\t \n\n\tint\t\t\tusecount;\n\n\tunsigned long\t\trate;\n\tunsigned long\t\tflags;\n\n\tvoid __iomem\t\t*enable_reg;\n\tvoid __iomem\t\t*status_reg;\n\tunsigned int\t\tenable_bit;\n\tvoid __iomem\t\t*mapped_reg;\n\n\tunsigned int\t\tdiv_mask;\n\tunsigned long\t\tarch_flags;\n\tvoid\t\t\t*priv;\n\tstruct clk_mapping\t*mapping;\n\tstruct cpufreq_frequency_table *freq_table;\n\tunsigned int\t\tnr_freqs;\n};\n\n#define CLK_ENABLE_ON_INIT\tBIT(0)\n\n#define CLK_ENABLE_REG_32BIT\tBIT(1)\t \n#define CLK_ENABLE_REG_16BIT\tBIT(2)\n#define CLK_ENABLE_REG_8BIT\tBIT(3)\n\n#define CLK_MASK_DIV_ON_DISABLE\tBIT(4)\n\n#define CLK_ENABLE_REG_MASK\t(CLK_ENABLE_REG_32BIT | \\\n\t\t\t\t CLK_ENABLE_REG_16BIT | \\\n\t\t\t\t CLK_ENABLE_REG_8BIT)\n\n \nunsigned long followparent_recalc(struct clk *);\nvoid recalculate_root_clocks(void);\nvoid propagate_rate(struct clk *);\nint clk_reparent(struct clk *child, struct clk *parent);\nint clk_register(struct clk *);\nvoid clk_unregister(struct clk *);\nvoid clk_enable_init_clocks(void);\n\nstruct clk_div_mult_table {\n\tunsigned int *divisors;\n\tunsigned int nr_divisors;\n\tunsigned int *multipliers;\n\tunsigned int nr_multipliers;\n};\n\nstruct cpufreq_frequency_table;\nvoid clk_rate_table_build(struct clk *clk,\n\t\t\t  struct cpufreq_frequency_table *freq_table,\n\t\t\t  int nr_freqs,\n\t\t\t  struct clk_div_mult_table *src_table,\n\t\t\t  unsigned long *bitmap);\n\nlong clk_rate_table_round(struct clk *clk,\n\t\t\t  struct cpufreq_frequency_table *freq_table,\n\t\t\t  unsigned long rate);\n\nint clk_rate_table_find(struct clk *clk,\n\t\t\tstruct cpufreq_frequency_table *freq_table,\n\t\t\tunsigned long rate);\n\nlong clk_rate_div_range_round(struct clk *clk, unsigned int div_min,\n\t\t\t      unsigned int div_max, unsigned long rate);\n\nlong clk_rate_mult_range_round(struct clk *clk, unsigned int mult_min,\n\t\t\t       unsigned int mult_max, unsigned long rate);\n\n#define SH_CLK_MSTP(_parent, _enable_reg, _enable_bit, _status_reg, _flags) \\\n{\t\t\t\t\t\t\t\t\t\\\n\t.parent\t\t= _parent,\t\t\t\t\t\\\n\t.enable_reg\t= (void __iomem *)_enable_reg,\t\t\t\\\n\t.enable_bit\t= _enable_bit,\t\t\t\t\t\\\n\t.status_reg\t= _status_reg,\t\t\t\t\t\\\n\t.flags\t\t= _flags,\t\t\t\t\t\\\n}\n\n#define SH_CLK_MSTP32(_p, _r, _b, _f)\t\t\t\t\\\n\tSH_CLK_MSTP(_p, _r, _b, 0, _f | CLK_ENABLE_REG_32BIT)\n\n#define SH_CLK_MSTP32_STS(_p, _r, _b, _s, _f)\t\t\t\\\n\tSH_CLK_MSTP(_p, _r, _b, _s, _f | CLK_ENABLE_REG_32BIT)\n\n#define SH_CLK_MSTP16(_p, _r, _b, _f)\t\t\t\t\\\n\tSH_CLK_MSTP(_p, _r, _b, 0, _f | CLK_ENABLE_REG_16BIT)\n\n#define SH_CLK_MSTP8(_p, _r, _b, _f)\t\t\t\t\\\n\tSH_CLK_MSTP(_p, _r, _b, 0, _f | CLK_ENABLE_REG_8BIT)\n\nint sh_clk_mstp_register(struct clk *clks, int nr);\n\n \nstatic inline int __deprecated sh_clk_mstp32_register(struct clk *clks, int nr)\n{\n\treturn sh_clk_mstp_register(clks, nr);\n}\n\n#define SH_CLK_DIV4(_parent, _reg, _shift, _div_bitmap, _flags)\t\\\n{\t\t\t\t\t\t\t\t\\\n\t.parent = _parent,\t\t\t\t\t\\\n\t.enable_reg = (void __iomem *)_reg,\t\t\t\\\n\t.enable_bit = _shift,\t\t\t\t\t\\\n\t.arch_flags = _div_bitmap,\t\t\t\t\\\n\t.div_mask = SH_CLK_DIV4_MSK,\t\t\t\t\\\n\t.flags = _flags,\t\t\t\t\t\\\n}\n\nstruct clk_div_table {\n\tstruct clk_div_mult_table *div_mult_table;\n\tvoid (*kick)(struct clk *clk);\n};\n\n#define clk_div4_table clk_div_table\n\nint sh_clk_div4_register(struct clk *clks, int nr,\n\t\t\t struct clk_div4_table *table);\nint sh_clk_div4_enable_register(struct clk *clks, int nr,\n\t\t\t struct clk_div4_table *table);\nint sh_clk_div4_reparent_register(struct clk *clks, int nr,\n\t\t\t struct clk_div4_table *table);\n\n#define SH_CLK_DIV6_EXT(_reg, _flags, _parents,\t\t\t\\\n\t\t\t_num_parents, _src_shift, _src_width)\t\\\n{\t\t\t\t\t\t\t\t\\\n\t.enable_reg = (void __iomem *)_reg,\t\t\t\\\n\t.enable_bit = 0,  \t\t\t\t\\\n\t.flags = _flags | CLK_MASK_DIV_ON_DISABLE,\t\t\\\n\t.div_mask = SH_CLK_DIV6_MSK,\t\t\t\t\\\n\t.parent_table = _parents,\t\t\t\t\\\n\t.parent_num = _num_parents,\t\t\t\t\\\n\t.src_shift = _src_shift,\t\t\t\t\\\n\t.src_width = _src_width,\t\t\t\t\\\n}\n\n#define SH_CLK_DIV6(_parent, _reg, _flags)\t\t\t\\\n{\t\t\t\t\t\t\t\t\\\n\t.parent\t\t= _parent,\t\t\t\t\\\n\t.enable_reg\t= (void __iomem *)_reg,\t\t\t\\\n\t.enable_bit\t= 0,\t \t\t\t\\\n\t.div_mask\t= SH_CLK_DIV6_MSK,\t\t\t\\\n\t.flags\t\t= _flags | CLK_MASK_DIV_ON_DISABLE,\t\\\n}\n\nint sh_clk_div6_register(struct clk *clks, int nr);\nint sh_clk_div6_reparent_register(struct clk *clks, int nr);\n\n#define CLKDEV_CON_ID(_id, _clk) { .con_id = _id, .clk = _clk }\n#define CLKDEV_DEV_ID(_id, _clk) { .dev_id = _id, .clk = _clk }\n#define CLKDEV_ICK_ID(_cid, _did, _clk) { .con_id = _cid, .dev_id = _did, .clk = _clk }\n\n \n#define SH_CLK_FSIDIV(_reg, _parent)\t\t\\\n{\t\t\t\t\t\t\\\n\t.enable_reg = (void __iomem *)_reg,\t\\\n\t.parent\t\t= _parent,\t\t\\\n}\n\nint sh_clk_fsidiv_register(struct clk *clks, int nr);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}