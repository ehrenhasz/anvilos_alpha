{
  "module_name": "ratelimit.h",
  "hash_id": "599973f866734f17858e1a6fb888f6377c4df6c7c08d0678b87a68d4155415d7",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ratelimit.h",
  "human_readable_source": " \n#ifndef _LINUX_RATELIMIT_H\n#define _LINUX_RATELIMIT_H\n\n#include <linux/ratelimit_types.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ratelimit_state_init(struct ratelimit_state *rs,\n\t\t\t\t\tint interval, int burst)\n{\n\tmemset(rs, 0, sizeof(*rs));\n\n\traw_spin_lock_init(&rs->lock);\n\trs->interval\t= interval;\n\trs->burst\t= burst;\n}\n\nstatic inline void ratelimit_default_init(struct ratelimit_state *rs)\n{\n\treturn ratelimit_state_init(rs, DEFAULT_RATELIMIT_INTERVAL,\n\t\t\t\t\tDEFAULT_RATELIMIT_BURST);\n}\n\nstatic inline void ratelimit_state_exit(struct ratelimit_state *rs)\n{\n\tif (!(rs->flags & RATELIMIT_MSG_ON_RELEASE))\n\t\treturn;\n\n\tif (rs->missed) {\n\t\tpr_warn(\"%s: %d output lines suppressed due to ratelimiting\\n\",\n\t\t\tcurrent->comm, rs->missed);\n\t\trs->missed = 0;\n\t}\n}\n\nstatic inline void\nratelimit_set_flags(struct ratelimit_state *rs, unsigned long flags)\n{\n\trs->flags = flags;\n}\n\nextern struct ratelimit_state printk_ratelimit_state;\n\n#ifdef CONFIG_PRINTK\n\n#define WARN_ON_RATELIMIT(condition, state)\t({\t\t\\\n\tbool __rtn_cond = !!(condition);\t\t\t\\\n\tWARN_ON(__rtn_cond && __ratelimit(state));\t\t\\\n\t__rtn_cond;\t\t\t\t\t\t\\\n})\n\n#define WARN_RATELIMIT(condition, format, ...)\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tstatic DEFINE_RATELIMIT_STATE(_rs,\t\t\t\\\n\t\t\t\t      DEFAULT_RATELIMIT_INTERVAL,\t\\\n\t\t\t\t      DEFAULT_RATELIMIT_BURST);\t\\\n\tint rtn = !!(condition);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\\\n\tif (unlikely(rtn && __ratelimit(&_rs)))\t\t\t\\\n\t\tWARN(rtn, format, ##__VA_ARGS__);\t\t\\\n\t\t\t\t\t\t\t\t\\\n\trtn;\t\t\t\t\t\t\t\\\n})\n\n#else\n\n#define WARN_ON_RATELIMIT(condition, state)\t\t\t\\\n\tWARN_ON(condition)\n\n#define WARN_RATELIMIT(condition, format, ...)\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\tint rtn = WARN(condition, format, ##__VA_ARGS__);\t\\\n\trtn;\t\t\t\t\t\t\t\\\n})\n\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}