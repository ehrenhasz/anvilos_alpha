{
  "module_name": "sysfs.h",
  "hash_id": "968554fda2e4691e820021edbf53e0f947c66489d99e7a84e9ca522b7b24e091",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sysfs.h",
  "human_readable_source": " \n \n\n#ifndef _SYSFS_H_\n#define _SYSFS_H_\n\n#include <linux/kernfs.h>\n#include <linux/compiler.h>\n#include <linux/errno.h>\n#include <linux/list.h>\n#include <linux/lockdep.h>\n#include <linux/kobject_ns.h>\n#include <linux/stat.h>\n#include <linux/atomic.h>\n\nstruct kobject;\nstruct module;\nstruct bin_attribute;\nenum kobj_ns_type;\n\nstruct attribute {\n\tconst char\t\t*name;\n\tumode_t\t\t\tmode;\n#ifdef CONFIG_DEBUG_LOCK_ALLOC\n\tbool\t\t\tignore_lockdep:1;\n\tstruct lock_class_key\t*key;\n\tstruct lock_class_key\tskey;\n#endif\n};\n\n \n#ifdef CONFIG_DEBUG_LOCK_ALLOC\n#define sysfs_attr_init(attr)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\\\n\tstatic struct lock_class_key __key;\t\t\\\n\t\t\t\t\t\t\t\\\n\t(attr)->key = &__key;\t\t\t\t\\\n} while (0)\n#else\n#define sysfs_attr_init(attr) do {} while (0)\n#endif\n\n \nstruct attribute_group {\n\tconst char\t\t*name;\n\tumode_t\t\t\t(*is_visible)(struct kobject *,\n\t\t\t\t\t      struct attribute *, int);\n\tumode_t\t\t\t(*is_bin_visible)(struct kobject *,\n\t\t\t\t\t\t  struct bin_attribute *, int);\n\tstruct attribute\t**attrs;\n\tstruct bin_attribute\t**bin_attrs;\n};\n\n \n\n#define SYSFS_PREALLOC 010000\n\n#define __ATTR(_name, _mode, _show, _store) {\t\t\t\t\\\n\t.attr = {.name = __stringify(_name),\t\t\t\t\\\n\t\t .mode = VERIFY_OCTAL_PERMISSIONS(_mode) },\t\t\\\n\t.show\t= _show,\t\t\t\t\t\t\\\n\t.store\t= _store,\t\t\t\t\t\t\\\n}\n\n#define __ATTR_PREALLOC(_name, _mode, _show, _store) {\t\t\t\\\n\t.attr = {.name = __stringify(_name),\t\t\t\t\\\n\t\t .mode = SYSFS_PREALLOC | VERIFY_OCTAL_PERMISSIONS(_mode) },\\\n\t.show\t= _show,\t\t\t\t\t\t\\\n\t.store\t= _store,\t\t\t\t\t\t\\\n}\n\n#define __ATTR_RO(_name) {\t\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name), .mode = 0444 },\t\t\\\n\t.show\t= _name##_show,\t\t\t\t\t\t\\\n}\n\n#define __ATTR_RO_MODE(_name, _mode) {\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name),\t\t\t\t\\\n\t\t    .mode = VERIFY_OCTAL_PERMISSIONS(_mode) },\t\t\\\n\t.show\t= _name##_show,\t\t\t\t\t\t\\\n}\n\n#define __ATTR_RW_MODE(_name, _mode) {\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name),\t\t\t\t\\\n\t\t    .mode = VERIFY_OCTAL_PERMISSIONS(_mode) },\t\t\\\n\t.show\t= _name##_show,\t\t\t\t\t\t\\\n\t.store\t= _name##_store,\t\t\t\t\t\\\n}\n\n#define __ATTR_WO(_name) {\t\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name), .mode = 0200 },\t\t\\\n\t.store\t= _name##_store,\t\t\t\t\t\\\n}\n\n#define __ATTR_RW(_name) __ATTR(_name, 0644, _name##_show, _name##_store)\n\n#define __ATTR_NULL { .attr = { .name = NULL } }\n\n#ifdef CONFIG_DEBUG_LOCK_ALLOC\n#define __ATTR_IGNORE_LOCKDEP(_name, _mode, _show, _store) {\t\\\n\t.attr = {.name = __stringify(_name), .mode = _mode,\t\\\n\t\t\t.ignore_lockdep = true },\t\t\\\n\t.show\t\t= _show,\t\t\t\t\\\n\t.store\t\t= _store,\t\t\t\t\\\n}\n#else\n#define __ATTR_IGNORE_LOCKDEP\t__ATTR\n#endif\n\n#define __ATTRIBUTE_GROUPS(_name)\t\t\t\t\\\nstatic const struct attribute_group *_name##_groups[] = {\t\\\n\t&_name##_group,\t\t\t\t\t\t\\\n\tNULL,\t\t\t\t\t\t\t\\\n}\n\n#define ATTRIBUTE_GROUPS(_name)\t\t\t\t\t\\\nstatic const struct attribute_group _name##_group = {\t\t\\\n\t.attrs = _name##_attrs,\t\t\t\t\t\\\n};\t\t\t\t\t\t\t\t\\\n__ATTRIBUTE_GROUPS(_name)\n\n#define BIN_ATTRIBUTE_GROUPS(_name)\t\t\t\t\\\nstatic const struct attribute_group _name##_group = {\t\t\\\n\t.bin_attrs = _name##_attrs,\t\t\t\t\\\n};\t\t\t\t\t\t\t\t\\\n__ATTRIBUTE_GROUPS(_name)\n\nstruct file;\nstruct vm_area_struct;\nstruct address_space;\n\nstruct bin_attribute {\n\tstruct attribute\tattr;\n\tsize_t\t\t\tsize;\n\tvoid\t\t\t*private;\n\tstruct address_space *(*f_mapping)(void);\n\tssize_t (*read)(struct file *, struct kobject *, struct bin_attribute *,\n\t\t\tchar *, loff_t, size_t);\n\tssize_t (*write)(struct file *, struct kobject *, struct bin_attribute *,\n\t\t\t char *, loff_t, size_t);\n\tint (*mmap)(struct file *, struct kobject *, struct bin_attribute *attr,\n\t\t    struct vm_area_struct *vma);\n};\n\n \n#define sysfs_bin_attr_init(bin_attr) sysfs_attr_init(&(bin_attr)->attr)\n\n \n#define __BIN_ATTR(_name, _mode, _read, _write, _size) {\t\t\\\n\t.attr = { .name = __stringify(_name), .mode = _mode },\t\t\\\n\t.read\t= _read,\t\t\t\t\t\t\\\n\t.write\t= _write,\t\t\t\t\t\t\\\n\t.size\t= _size,\t\t\t\t\t\t\\\n}\n\n#define __BIN_ATTR_RO(_name, _size) {\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name), .mode = 0444 },\t\t\\\n\t.read\t= _name##_read,\t\t\t\t\t\t\\\n\t.size\t= _size,\t\t\t\t\t\t\\\n}\n\n#define __BIN_ATTR_WO(_name, _size) {\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name), .mode = 0200 },\t\t\\\n\t.write\t= _name##_write,\t\t\t\t\t\\\n\t.size\t= _size,\t\t\t\t\t\t\\\n}\n\n#define __BIN_ATTR_RW(_name, _size)\t\t\t\t\t\\\n\t__BIN_ATTR(_name, 0644, _name##_read, _name##_write, _size)\n\n#define __BIN_ATTR_NULL __ATTR_NULL\n\n#define BIN_ATTR(_name, _mode, _read, _write, _size)\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR(_name, _mode, _read,\t\\\n\t\t\t\t\t_write, _size)\n\n#define BIN_ATTR_RO(_name, _size)\t\t\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR_RO(_name, _size)\n\n#define BIN_ATTR_WO(_name, _size)\t\t\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR_WO(_name, _size)\n\n#define BIN_ATTR_RW(_name, _size)\t\t\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR_RW(_name, _size)\n\n\n#define __BIN_ATTR_ADMIN_RO(_name, _size) {\t\t\t\t\t\\\n\t.attr\t= { .name = __stringify(_name), .mode = 0400 },\t\t\\\n\t.read\t= _name##_read,\t\t\t\t\t\t\\\n\t.size\t= _size,\t\t\t\t\t\t\\\n}\n\n#define __BIN_ATTR_ADMIN_RW(_name, _size)\t\t\t\t\t\\\n\t__BIN_ATTR(_name, 0600, _name##_read, _name##_write, _size)\n\n#define BIN_ATTR_ADMIN_RO(_name, _size)\t\t\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR_ADMIN_RO(_name, _size)\n\n#define BIN_ATTR_ADMIN_RW(_name, _size)\t\t\t\t\t\\\nstruct bin_attribute bin_attr_##_name = __BIN_ATTR_ADMIN_RW(_name, _size)\n\nstruct sysfs_ops {\n\tssize_t\t(*show)(struct kobject *, struct attribute *, char *);\n\tssize_t\t(*store)(struct kobject *, struct attribute *, const char *, size_t);\n};\n\n#ifdef CONFIG_SYSFS\n\nint __must_check sysfs_create_dir_ns(struct kobject *kobj, const void *ns);\nvoid sysfs_remove_dir(struct kobject *kobj);\nint __must_check sysfs_rename_dir_ns(struct kobject *kobj, const char *new_name,\n\t\t\t\t     const void *new_ns);\nint __must_check sysfs_move_dir_ns(struct kobject *kobj,\n\t\t\t\t   struct kobject *new_parent_kobj,\n\t\t\t\t   const void *new_ns);\nint __must_check sysfs_create_mount_point(struct kobject *parent_kobj,\n\t\t\t\t\t  const char *name);\nvoid sysfs_remove_mount_point(struct kobject *parent_kobj,\n\t\t\t      const char *name);\n\nint __must_check sysfs_create_file_ns(struct kobject *kobj,\n\t\t\t\t      const struct attribute *attr,\n\t\t\t\t      const void *ns);\nint __must_check sysfs_create_files(struct kobject *kobj,\n\t\t\t\t   const struct attribute * const *attr);\nint __must_check sysfs_chmod_file(struct kobject *kobj,\n\t\t\t\t  const struct attribute *attr, umode_t mode);\nstruct kernfs_node *sysfs_break_active_protection(struct kobject *kobj,\n\t\t\t\t\t\t  const struct attribute *attr);\nvoid sysfs_unbreak_active_protection(struct kernfs_node *kn);\nvoid sysfs_remove_file_ns(struct kobject *kobj, const struct attribute *attr,\n\t\t\t  const void *ns);\nbool sysfs_remove_file_self(struct kobject *kobj, const struct attribute *attr);\nvoid sysfs_remove_files(struct kobject *kobj, const struct attribute * const *attr);\n\nint __must_check sysfs_create_bin_file(struct kobject *kobj,\n\t\t\t\t       const struct bin_attribute *attr);\nvoid sysfs_remove_bin_file(struct kobject *kobj,\n\t\t\t   const struct bin_attribute *attr);\n\nint __must_check sysfs_create_link(struct kobject *kobj, struct kobject *target,\n\t\t\t\t   const char *name);\nint __must_check sysfs_create_link_nowarn(struct kobject *kobj,\n\t\t\t\t\t  struct kobject *target,\n\t\t\t\t\t  const char *name);\nvoid sysfs_remove_link(struct kobject *kobj, const char *name);\n\nint sysfs_rename_link_ns(struct kobject *kobj, struct kobject *target,\n\t\t\t const char *old_name, const char *new_name,\n\t\t\t const void *new_ns);\n\nvoid sysfs_delete_link(struct kobject *dir, struct kobject *targ,\n\t\t\tconst char *name);\n\nint __must_check sysfs_create_group(struct kobject *kobj,\n\t\t\t\t    const struct attribute_group *grp);\nint __must_check sysfs_create_groups(struct kobject *kobj,\n\t\t\t\t     const struct attribute_group **groups);\nint __must_check sysfs_update_groups(struct kobject *kobj,\n\t\t\t\t     const struct attribute_group **groups);\nint sysfs_update_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp);\nvoid sysfs_remove_group(struct kobject *kobj,\n\t\t\tconst struct attribute_group *grp);\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups);\nint sysfs_add_file_to_group(struct kobject *kobj,\n\t\t\tconst struct attribute *attr, const char *group);\nvoid sysfs_remove_file_from_group(struct kobject *kobj,\n\t\t\tconst struct attribute *attr, const char *group);\nint sysfs_merge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp);\nvoid sysfs_unmerge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp);\nint sysfs_add_link_to_group(struct kobject *kobj, const char *group_name,\n\t\t\t    struct kobject *target, const char *link_name);\nvoid sysfs_remove_link_from_group(struct kobject *kobj, const char *group_name,\n\t\t\t\t  const char *link_name);\nint compat_only_sysfs_link_entry_to_kobj(struct kobject *kobj,\n\t\t\t\t\t struct kobject *target_kobj,\n\t\t\t\t\t const char *target_name,\n\t\t\t\t\t const char *symlink_name);\n\nvoid sysfs_notify(struct kobject *kobj, const char *dir, const char *attr);\n\nint __must_check sysfs_init(void);\n\nstatic inline void sysfs_enable_ns(struct kernfs_node *kn)\n{\n\treturn kernfs_enable_ns(kn);\n}\n\nint sysfs_file_change_owner(struct kobject *kobj, const char *name, kuid_t kuid,\n\t\t\t    kgid_t kgid);\nint sysfs_change_owner(struct kobject *kobj, kuid_t kuid, kgid_t kgid);\nint sysfs_link_change_owner(struct kobject *kobj, struct kobject *targ,\n\t\t\t    const char *name, kuid_t kuid, kgid_t kgid);\nint sysfs_groups_change_owner(struct kobject *kobj,\n\t\t\t      const struct attribute_group **groups,\n\t\t\t      kuid_t kuid, kgid_t kgid);\nint sysfs_group_change_owner(struct kobject *kobj,\n\t\t\t     const struct attribute_group *groups, kuid_t kuid,\n\t\t\t     kgid_t kgid);\n__printf(2, 3)\nint sysfs_emit(char *buf, const char *fmt, ...);\n__printf(3, 4)\nint sysfs_emit_at(char *buf, int at, const char *fmt, ...);\n\n#else  \n\nstatic inline int sysfs_create_dir_ns(struct kobject *kobj, const void *ns)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_dir(struct kobject *kobj)\n{\n}\n\nstatic inline int sysfs_rename_dir_ns(struct kobject *kobj,\n\t\t\t\t      const char *new_name, const void *new_ns)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_move_dir_ns(struct kobject *kobj,\n\t\t\t\t    struct kobject *new_parent_kobj,\n\t\t\t\t    const void *new_ns)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_create_mount_point(struct kobject *parent_kobj,\n\t\t\t\t\t   const char *name)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_mount_point(struct kobject *parent_kobj,\n\t\t\t\t\t    const char *name)\n{\n}\n\nstatic inline int sysfs_create_file_ns(struct kobject *kobj,\n\t\t\t\t       const struct attribute *attr,\n\t\t\t\t       const void *ns)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_create_files(struct kobject *kobj,\n\t\t\t\t    const struct attribute * const *attr)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_chmod_file(struct kobject *kobj,\n\t\t\t\t   const struct attribute *attr, umode_t mode)\n{\n\treturn 0;\n}\n\nstatic inline struct kernfs_node *\nsysfs_break_active_protection(struct kobject *kobj,\n\t\t\t      const struct attribute *attr)\n{\n\treturn NULL;\n}\n\nstatic inline void sysfs_unbreak_active_protection(struct kernfs_node *kn)\n{\n}\n\nstatic inline void sysfs_remove_file_ns(struct kobject *kobj,\n\t\t\t\t\tconst struct attribute *attr,\n\t\t\t\t\tconst void *ns)\n{\n}\n\nstatic inline bool sysfs_remove_file_self(struct kobject *kobj,\n\t\t\t\t\t  const struct attribute *attr)\n{\n\treturn false;\n}\n\nstatic inline void sysfs_remove_files(struct kobject *kobj,\n\t\t\t\t     const struct attribute * const *attr)\n{\n}\n\nstatic inline int sysfs_create_bin_file(struct kobject *kobj,\n\t\t\t\t\tconst struct bin_attribute *attr)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_bin_file(struct kobject *kobj,\n\t\t\t\t\t const struct bin_attribute *attr)\n{\n}\n\nstatic inline int sysfs_create_link(struct kobject *kobj,\n\t\t\t\t    struct kobject *target, const char *name)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_create_link_nowarn(struct kobject *kobj,\n\t\t\t\t\t   struct kobject *target,\n\t\t\t\t\t   const char *name)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_link(struct kobject *kobj, const char *name)\n{\n}\n\nstatic inline int sysfs_rename_link_ns(struct kobject *k, struct kobject *t,\n\t\t\t\t       const char *old_name,\n\t\t\t\t       const char *new_name, const void *ns)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_delete_link(struct kobject *k, struct kobject *t,\n\t\t\t\t     const char *name)\n{\n}\n\nstatic inline int sysfs_create_group(struct kobject *kobj,\n\t\t\t\t     const struct attribute_group *grp)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_create_groups(struct kobject *kobj,\n\t\t\t\t      const struct attribute_group **groups)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_update_groups(struct kobject *kobj,\n\t\t\t\t      const struct attribute_group **groups)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_update_group(struct kobject *kobj,\n\t\t\t\tconst struct attribute_group *grp)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_group(struct kobject *kobj,\n\t\t\t\t      const struct attribute_group *grp)\n{\n}\n\nstatic inline void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t\t       const struct attribute_group **groups)\n{\n}\n\nstatic inline int sysfs_add_file_to_group(struct kobject *kobj,\n\t\tconst struct attribute *attr, const char *group)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_file_from_group(struct kobject *kobj,\n\t\tconst struct attribute *attr, const char *group)\n{\n}\n\nstatic inline int sysfs_merge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_unmerge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n}\n\nstatic inline int sysfs_add_link_to_group(struct kobject *kobj,\n\t\tconst char *group_name, struct kobject *target,\n\t\tconst char *link_name)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_remove_link_from_group(struct kobject *kobj,\n\t\tconst char *group_name, const char *link_name)\n{\n}\n\nstatic inline int compat_only_sysfs_link_entry_to_kobj(struct kobject *kobj,\n\t\t\t\t\t\t       struct kobject *target_kobj,\n\t\t\t\t\t\t       const char *target_name,\n\t\t\t\t\t\t       const char *symlink_name)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_notify(struct kobject *kobj, const char *dir,\n\t\t\t\tconst char *attr)\n{\n}\n\nstatic inline int __must_check sysfs_init(void)\n{\n\treturn 0;\n}\n\nstatic inline void sysfs_enable_ns(struct kernfs_node *kn)\n{\n}\n\nstatic inline int sysfs_file_change_owner(struct kobject *kobj,\n\t\t\t\t\t  const char *name, kuid_t kuid,\n\t\t\t\t\t  kgid_t kgid)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_link_change_owner(struct kobject *kobj,\n\t\t\t\t\t  struct kobject *targ,\n\t\t\t\t\t  const char *name, kuid_t kuid,\n\t\t\t\t\t  kgid_t kgid)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_change_owner(struct kobject *kobj, kuid_t kuid, kgid_t kgid)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_groups_change_owner(struct kobject *kobj,\n\t\t\t  const struct attribute_group **groups,\n\t\t\t  kuid_t kuid, kgid_t kgid)\n{\n\treturn 0;\n}\n\nstatic inline int sysfs_group_change_owner(struct kobject *kobj,\n\t\t\t\t\t   const struct attribute_group *groups,\n\t\t\t\t\t   kuid_t kuid, kgid_t kgid)\n{\n\treturn 0;\n}\n\n__printf(2, 3)\nstatic inline int sysfs_emit(char *buf, const char *fmt, ...)\n{\n\treturn 0;\n}\n\n__printf(3, 4)\nstatic inline int sysfs_emit_at(char *buf, int at, const char *fmt, ...)\n{\n\treturn 0;\n}\n#endif  \n\nstatic inline int __must_check sysfs_create_file(struct kobject *kobj,\n\t\t\t\t\t\t const struct attribute *attr)\n{\n\treturn sysfs_create_file_ns(kobj, attr, NULL);\n}\n\nstatic inline void sysfs_remove_file(struct kobject *kobj,\n\t\t\t\t     const struct attribute *attr)\n{\n\tsysfs_remove_file_ns(kobj, attr, NULL);\n}\n\nstatic inline int sysfs_rename_link(struct kobject *kobj, struct kobject *target,\n\t\t\t\t    const char *old_name, const char *new_name)\n{\n\treturn sysfs_rename_link_ns(kobj, target, old_name, new_name, NULL);\n}\n\nstatic inline void sysfs_notify_dirent(struct kernfs_node *kn)\n{\n\tkernfs_notify(kn);\n}\n\nstatic inline struct kernfs_node *sysfs_get_dirent(struct kernfs_node *parent,\n\t\t\t\t\t\t   const char *name)\n{\n\treturn kernfs_find_and_get(parent, name);\n}\n\nstatic inline struct kernfs_node *sysfs_get(struct kernfs_node *kn)\n{\n\tkernfs_get(kn);\n\treturn kn;\n}\n\nstatic inline void sysfs_put(struct kernfs_node *kn)\n{\n\tkernfs_put(kn);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}