{
  "module_name": "rethook.h",
  "hash_id": "8d03ef967df89485737e0393ccf5639cbfbba24c0157aaa410eab45a7c7d8b4d",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/rethook.h",
  "human_readable_source": " \n \n#ifndef _LINUX_RETHOOK_H\n#define _LINUX_RETHOOK_H\n\n#include <linux/compiler.h>\n#include <linux/freelist.h>\n#include <linux/kallsyms.h>\n#include <linux/llist.h>\n#include <linux/rcupdate.h>\n#include <linux/refcount.h>\n\nstruct rethook_node;\n\ntypedef void (*rethook_handler_t) (struct rethook_node *, void *, unsigned long, struct pt_regs *);\n\n \nstruct rethook {\n\tvoid\t\t\t*data;\n\t \n\tvoid (__rcu *handler) (struct rethook_node *, void *, unsigned long, struct pt_regs *);\n\tstruct freelist_head\tpool;\n\trefcount_t\t\tref;\n\tstruct rcu_head\t\trcu;\n};\n\n \nstruct rethook_node {\n\tunion {\n\t\tstruct freelist_node freelist;\n\t\tstruct rcu_head      rcu;\n\t};\n\tstruct llist_node\tllist;\n\tstruct rethook\t\t*rethook;\n\tunsigned long\t\tret_addr;\n\tunsigned long\t\tframe;\n};\n\nstruct rethook *rethook_alloc(void *data, rethook_handler_t handler);\nvoid rethook_stop(struct rethook *rh);\nvoid rethook_free(struct rethook *rh);\nvoid rethook_add_node(struct rethook *rh, struct rethook_node *node);\nstruct rethook_node *rethook_try_get(struct rethook *rh);\nvoid rethook_recycle(struct rethook_node *node);\nvoid rethook_hook(struct rethook_node *node, struct pt_regs *regs, bool mcount);\nunsigned long rethook_find_ret_addr(struct task_struct *tsk, unsigned long frame,\n\t\t\t\t    struct llist_node **cur);\n\n \nvoid arch_rethook_prepare(struct rethook_node *node, struct pt_regs *regs, bool mcount);\nvoid arch_rethook_trampoline(void);\n\n \nstatic inline bool is_rethook_trampoline(unsigned long addr)\n{\n\treturn addr == (unsigned long)dereference_symbol_descriptor(arch_rethook_trampoline);\n}\n\n \nvoid arch_rethook_fixup_return(struct pt_regs *regs,\n\t\t\t       unsigned long correct_ret_addr);\n\n \nunsigned long rethook_trampoline_handler(struct pt_regs *regs,\n\t\t\t\t\t unsigned long frame);\n\n#ifdef CONFIG_RETHOOK\nvoid rethook_flush_task(struct task_struct *tk);\n#else\n#define rethook_flush_task(tsk)\tdo { } while (0)\n#endif\n\n#endif\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}