{
  "module_name": "inet_diag.h",
  "hash_id": "17b713a3d23acec5887675f5f38c18aad041b339e548ba94d023916a219657d8",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/inet_diag.h",
  "human_readable_source": " \n#ifndef _INET_DIAG_H_\n#define _INET_DIAG_H_ 1\n\n#include <net/netlink.h>\n#include <uapi/linux/inet_diag.h>\n\nstruct inet_hashinfo;\n\nstruct inet_diag_handler {\n\tvoid\t\t(*dump)(struct sk_buff *skb,\n\t\t\t\tstruct netlink_callback *cb,\n\t\t\t\tconst struct inet_diag_req_v2 *r);\n\n\tint\t\t(*dump_one)(struct netlink_callback *cb,\n\t\t\t\t    const struct inet_diag_req_v2 *req);\n\n\tvoid\t\t(*idiag_get_info)(struct sock *sk,\n\t\t\t\t\t  struct inet_diag_msg *r,\n\t\t\t\t\t  void *info);\n\n\tint\t\t(*idiag_get_aux)(struct sock *sk,\n\t\t\t\t\t bool net_admin,\n\t\t\t\t\t struct sk_buff *skb);\n\n\tsize_t\t\t(*idiag_get_aux_size)(struct sock *sk,\n\t\t\t\t\t      bool net_admin);\n\n\tint\t\t(*destroy)(struct sk_buff *in_skb,\n\t\t\t\t   const struct inet_diag_req_v2 *req);\n\n\t__u16\t\tidiag_type;\n\t__u16\t\tidiag_info_size;\n};\n\nstruct bpf_sk_storage_diag;\nstruct inet_diag_dump_data {\n\tstruct nlattr *req_nlas[__INET_DIAG_REQ_MAX];\n#define inet_diag_nla_bc req_nlas[INET_DIAG_REQ_BYTECODE]\n#define inet_diag_nla_bpf_stgs req_nlas[INET_DIAG_REQ_SK_BPF_STORAGES]\n\n\tstruct bpf_sk_storage_diag *bpf_stg_diag;\n};\n\nstruct inet_connection_sock;\nint inet_sk_diag_fill(struct sock *sk, struct inet_connection_sock *icsk,\n\t\t      struct sk_buff *skb, struct netlink_callback *cb,\n\t\t      const struct inet_diag_req_v2 *req,\n\t\t      u16 nlmsg_flags, bool net_admin);\nvoid inet_diag_dump_icsk(struct inet_hashinfo *h, struct sk_buff *skb,\n\t\t\t struct netlink_callback *cb,\n\t\t\t const struct inet_diag_req_v2 *r);\nint inet_diag_dump_one_icsk(struct inet_hashinfo *hashinfo,\n\t\t\t    struct netlink_callback *cb,\n\t\t\t    const struct inet_diag_req_v2 *req);\n\nstruct sock *inet_diag_find_one_icsk(struct net *net,\n\t\t\t\t     struct inet_hashinfo *hashinfo,\n\t\t\t\t     const struct inet_diag_req_v2 *req);\n\nint inet_diag_bc_sk(const struct nlattr *_bc, struct sock *sk);\n\nvoid inet_diag_msg_common_fill(struct inet_diag_msg *r, struct sock *sk);\n\nstatic inline size_t inet_diag_msg_attrs_size(void)\n{\n\treturn\t  nla_total_size(1)   \n\t\t+ nla_total_size(1)   \n#if IS_ENABLED(CONFIG_IPV6)\n\t\t+ nla_total_size(1)   \n\t\t+ nla_total_size(1)   \n#endif\n\t\t+ nla_total_size(4)   \n\t\t+ nla_total_size(4)   \n#ifdef CONFIG_SOCK_CGROUP_DATA\n\t\t+ nla_total_size_64bit(sizeof(u64))   \n#endif\n\t\t+ nla_total_size(sizeof(struct inet_diag_sockopt))\n\t\t\t\t\t\t      \n\t\t;\n}\nint inet_diag_msg_attrs_fill(struct sock *sk, struct sk_buff *skb,\n\t\t\t     struct inet_diag_msg *r, int ext,\n\t\t\t     struct user_namespace *user_ns, bool net_admin);\n\nextern int  inet_diag_register(const struct inet_diag_handler *handler);\nextern void inet_diag_unregister(const struct inet_diag_handler *handler);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}