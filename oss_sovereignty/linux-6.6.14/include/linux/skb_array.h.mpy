{
  "module_name": "skb_array.h",
  "hash_id": "29bcc043ac3cbd213f0e7e7509c22eeeb57205df23cf88003391d5998c879a90",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/skb_array.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_SKB_ARRAY_H\n#define _LINUX_SKB_ARRAY_H 1\n\n#ifdef __KERNEL__\n#include <linux/ptr_ring.h>\n#include <linux/skbuff.h>\n#include <linux/if_vlan.h>\n#endif\n\nstruct skb_array {\n\tstruct ptr_ring ring;\n};\n\n \nstatic inline bool __skb_array_full(struct skb_array *a)\n{\n\treturn __ptr_ring_full(&a->ring);\n}\n\nstatic inline bool skb_array_full(struct skb_array *a)\n{\n\treturn ptr_ring_full(&a->ring);\n}\n\nstatic inline int skb_array_produce(struct skb_array *a, struct sk_buff *skb)\n{\n\treturn ptr_ring_produce(&a->ring, skb);\n}\n\nstatic inline int skb_array_produce_irq(struct skb_array *a, struct sk_buff *skb)\n{\n\treturn ptr_ring_produce_irq(&a->ring, skb);\n}\n\nstatic inline int skb_array_produce_bh(struct skb_array *a, struct sk_buff *skb)\n{\n\treturn ptr_ring_produce_bh(&a->ring, skb);\n}\n\nstatic inline int skb_array_produce_any(struct skb_array *a, struct sk_buff *skb)\n{\n\treturn ptr_ring_produce_any(&a->ring, skb);\n}\n\n \nstatic inline bool __skb_array_empty(struct skb_array *a)\n{\n\treturn __ptr_ring_empty(&a->ring);\n}\n\nstatic inline struct sk_buff *__skb_array_peek(struct skb_array *a)\n{\n\treturn __ptr_ring_peek(&a->ring);\n}\n\nstatic inline bool skb_array_empty(struct skb_array *a)\n{\n\treturn ptr_ring_empty(&a->ring);\n}\n\nstatic inline bool skb_array_empty_bh(struct skb_array *a)\n{\n\treturn ptr_ring_empty_bh(&a->ring);\n}\n\nstatic inline bool skb_array_empty_irq(struct skb_array *a)\n{\n\treturn ptr_ring_empty_irq(&a->ring);\n}\n\nstatic inline bool skb_array_empty_any(struct skb_array *a)\n{\n\treturn ptr_ring_empty_any(&a->ring);\n}\n\nstatic inline struct sk_buff *__skb_array_consume(struct skb_array *a)\n{\n\treturn __ptr_ring_consume(&a->ring);\n}\n\nstatic inline struct sk_buff *skb_array_consume(struct skb_array *a)\n{\n\treturn ptr_ring_consume(&a->ring);\n}\n\nstatic inline int skb_array_consume_batched(struct skb_array *a,\n\t\t\t\t\t    struct sk_buff **array, int n)\n{\n\treturn ptr_ring_consume_batched(&a->ring, (void **)array, n);\n}\n\nstatic inline struct sk_buff *skb_array_consume_irq(struct skb_array *a)\n{\n\treturn ptr_ring_consume_irq(&a->ring);\n}\n\nstatic inline int skb_array_consume_batched_irq(struct skb_array *a,\n\t\t\t\t\t\tstruct sk_buff **array, int n)\n{\n\treturn ptr_ring_consume_batched_irq(&a->ring, (void **)array, n);\n}\n\nstatic inline struct sk_buff *skb_array_consume_any(struct skb_array *a)\n{\n\treturn ptr_ring_consume_any(&a->ring);\n}\n\nstatic inline int skb_array_consume_batched_any(struct skb_array *a,\n\t\t\t\t\t\tstruct sk_buff **array, int n)\n{\n\treturn ptr_ring_consume_batched_any(&a->ring, (void **)array, n);\n}\n\n\nstatic inline struct sk_buff *skb_array_consume_bh(struct skb_array *a)\n{\n\treturn ptr_ring_consume_bh(&a->ring);\n}\n\nstatic inline int skb_array_consume_batched_bh(struct skb_array *a,\n\t\t\t\t\t       struct sk_buff **array, int n)\n{\n\treturn ptr_ring_consume_batched_bh(&a->ring, (void **)array, n);\n}\n\nstatic inline int __skb_array_len_with_tag(struct sk_buff *skb)\n{\n\tif (likely(skb)) {\n\t\tint len = skb->len;\n\n\t\tif (skb_vlan_tag_present(skb))\n\t\t\tlen += VLAN_HLEN;\n\n\t\treturn len;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nstatic inline int skb_array_peek_len(struct skb_array *a)\n{\n\treturn PTR_RING_PEEK_CALL(&a->ring, __skb_array_len_with_tag);\n}\n\nstatic inline int skb_array_peek_len_irq(struct skb_array *a)\n{\n\treturn PTR_RING_PEEK_CALL_IRQ(&a->ring, __skb_array_len_with_tag);\n}\n\nstatic inline int skb_array_peek_len_bh(struct skb_array *a)\n{\n\treturn PTR_RING_PEEK_CALL_BH(&a->ring, __skb_array_len_with_tag);\n}\n\nstatic inline int skb_array_peek_len_any(struct skb_array *a)\n{\n\treturn PTR_RING_PEEK_CALL_ANY(&a->ring, __skb_array_len_with_tag);\n}\n\nstatic inline int skb_array_init(struct skb_array *a, int size, gfp_t gfp)\n{\n\treturn ptr_ring_init(&a->ring, size, gfp);\n}\n\nstatic void __skb_array_destroy_skb(void *ptr)\n{\n\tkfree_skb(ptr);\n}\n\nstatic inline void skb_array_unconsume(struct skb_array *a,\n\t\t\t\t       struct sk_buff **skbs, int n)\n{\n\tptr_ring_unconsume(&a->ring, (void **)skbs, n, __skb_array_destroy_skb);\n}\n\nstatic inline int skb_array_resize(struct skb_array *a, int size, gfp_t gfp)\n{\n\treturn ptr_ring_resize(&a->ring, size, gfp, __skb_array_destroy_skb);\n}\n\nstatic inline int skb_array_resize_multiple(struct skb_array **rings,\n\t\t\t\t\t    int nrings, unsigned int size,\n\t\t\t\t\t    gfp_t gfp)\n{\n\tBUILD_BUG_ON(offsetof(struct skb_array, ring));\n\treturn ptr_ring_resize_multiple((struct ptr_ring **)rings,\n\t\t\t\t\tnrings, size, gfp,\n\t\t\t\t\t__skb_array_destroy_skb);\n}\n\nstatic inline void skb_array_cleanup(struct skb_array *a)\n{\n\tptr_ring_cleanup(&a->ring, __skb_array_destroy_skb);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}