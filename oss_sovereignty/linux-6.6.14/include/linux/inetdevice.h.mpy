{
  "module_name": "inetdevice.h",
  "hash_id": "ebeb822e5e23d84b841e9b598fe9e11292a53603267249b5e77f933ca63f9cf9",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/inetdevice.h",
  "human_readable_source": " \n#ifndef _LINUX_INETDEVICE_H\n#define _LINUX_INETDEVICE_H\n\n#ifdef __KERNEL__\n\n#include <linux/bitmap.h>\n#include <linux/if.h>\n#include <linux/ip.h>\n#include <linux/netdevice.h>\n#include <linux/rcupdate.h>\n#include <linux/timer.h>\n#include <linux/sysctl.h>\n#include <linux/rtnetlink.h>\n#include <linux/refcount.h>\n\nstruct ipv4_devconf {\n\tvoid\t*sysctl;\n\tint\tdata[IPV4_DEVCONF_MAX];\n\tDECLARE_BITMAP(state, IPV4_DEVCONF_MAX);\n};\n\n#define MC_HASH_SZ_LOG 9\n\nstruct in_device {\n\tstruct net_device\t*dev;\n\tnetdevice_tracker\tdev_tracker;\n\n\trefcount_t\t\trefcnt;\n\tint\t\t\tdead;\n\tstruct in_ifaddr\t__rcu *ifa_list; \n\n\tstruct ip_mc_list __rcu\t*mc_list;\t \n\tstruct ip_mc_list __rcu\t* __rcu *mc_hash;\n\n\tint\t\t\tmc_count;\t \n\tspinlock_t\t\tmc_tomb_lock;\n\tstruct ip_mc_list\t*mc_tomb;\n\tunsigned long\t\tmr_v1_seen;\n\tunsigned long\t\tmr_v2_seen;\n\tunsigned long\t\tmr_maxdelay;\n\tunsigned long\t\tmr_qi;\t\t \n\tunsigned long\t\tmr_qri;\t\t \n\tunsigned char\t\tmr_qrv;\t\t \n\tunsigned char\t\tmr_gq_running;\n\tu32\t\t\tmr_ifc_count;\n\tstruct timer_list\tmr_gq_timer;\t \n\tstruct timer_list\tmr_ifc_timer;\t \n\n\tstruct neigh_parms\t*arp_parms;\n\tstruct ipv4_devconf\tcnf;\n\tstruct rcu_head\t\trcu_head;\n};\n\n#define IPV4_DEVCONF(cnf, attr) ((cnf).data[IPV4_DEVCONF_ ## attr - 1])\n#define IPV4_DEVCONF_ALL(net, attr) \\\n\tIPV4_DEVCONF((*(net)->ipv4.devconf_all), attr)\n\nstatic inline int ipv4_devconf_get(struct in_device *in_dev, int index)\n{\n\tindex--;\n\treturn in_dev->cnf.data[index];\n}\n\nstatic inline void ipv4_devconf_set(struct in_device *in_dev, int index,\n\t\t\t\t    int val)\n{\n\tindex--;\n\tset_bit(index, in_dev->cnf.state);\n\tin_dev->cnf.data[index] = val;\n}\n\nstatic inline void ipv4_devconf_setall(struct in_device *in_dev)\n{\n\tbitmap_fill(in_dev->cnf.state, IPV4_DEVCONF_MAX);\n}\n\n#define IN_DEV_CONF_GET(in_dev, attr) \\\n\tipv4_devconf_get((in_dev), IPV4_DEVCONF_ ## attr)\n#define IN_DEV_CONF_SET(in_dev, attr, val) \\\n\tipv4_devconf_set((in_dev), IPV4_DEVCONF_ ## attr, (val))\n\n#define IN_DEV_ANDCONF(in_dev, attr) \\\n\t(IPV4_DEVCONF_ALL(dev_net(in_dev->dev), attr) && \\\n\t IN_DEV_CONF_GET((in_dev), attr))\n\n#define IN_DEV_NET_ORCONF(in_dev, net, attr) \\\n\t(IPV4_DEVCONF_ALL(net, attr) || \\\n\t IN_DEV_CONF_GET((in_dev), attr))\n\n#define IN_DEV_ORCONF(in_dev, attr) \\\n\tIN_DEV_NET_ORCONF(in_dev, dev_net(in_dev->dev), attr)\n\n#define IN_DEV_MAXCONF(in_dev, attr) \\\n\t(max(IPV4_DEVCONF_ALL(dev_net(in_dev->dev), attr), \\\n\t     IN_DEV_CONF_GET((in_dev), attr)))\n\n#define IN_DEV_FORWARD(in_dev)\t\tIN_DEV_CONF_GET((in_dev), FORWARDING)\n#define IN_DEV_MFORWARD(in_dev)\t\tIN_DEV_ANDCONF((in_dev), MC_FORWARDING)\n#define IN_DEV_BFORWARD(in_dev)\t\tIN_DEV_ANDCONF((in_dev), BC_FORWARDING)\n#define IN_DEV_RPFILTER(in_dev)\t\tIN_DEV_MAXCONF((in_dev), RP_FILTER)\n#define IN_DEV_SRC_VMARK(in_dev)    \tIN_DEV_ORCONF((in_dev), SRC_VMARK)\n#define IN_DEV_SOURCE_ROUTE(in_dev)\tIN_DEV_ANDCONF((in_dev), \\\n\t\t\t\t\t\t       ACCEPT_SOURCE_ROUTE)\n#define IN_DEV_ACCEPT_LOCAL(in_dev)\tIN_DEV_ORCONF((in_dev), ACCEPT_LOCAL)\n#define IN_DEV_BOOTP_RELAY(in_dev)\tIN_DEV_ANDCONF((in_dev), BOOTP_RELAY)\n\n#define IN_DEV_LOG_MARTIANS(in_dev)\tIN_DEV_ORCONF((in_dev), LOG_MARTIANS)\n#define IN_DEV_PROXY_ARP(in_dev)\tIN_DEV_ORCONF((in_dev), PROXY_ARP)\n#define IN_DEV_PROXY_ARP_PVLAN(in_dev)\tIN_DEV_ORCONF((in_dev), PROXY_ARP_PVLAN)\n#define IN_DEV_SHARED_MEDIA(in_dev)\tIN_DEV_ORCONF((in_dev), SHARED_MEDIA)\n#define IN_DEV_TX_REDIRECTS(in_dev)\tIN_DEV_ORCONF((in_dev), SEND_REDIRECTS)\n#define IN_DEV_SEC_REDIRECTS(in_dev)\tIN_DEV_ORCONF((in_dev), \\\n\t\t\t\t\t\t      SECURE_REDIRECTS)\n#define IN_DEV_IDTAG(in_dev)\t\tIN_DEV_CONF_GET(in_dev, TAG)\n#define IN_DEV_MEDIUM_ID(in_dev)\tIN_DEV_CONF_GET(in_dev, MEDIUM_ID)\n#define IN_DEV_PROMOTE_SECONDARIES(in_dev) \\\n\t\t\t\t\tIN_DEV_ORCONF((in_dev), \\\n\t\t\t\t\t\t      PROMOTE_SECONDARIES)\n#define IN_DEV_ROUTE_LOCALNET(in_dev)\tIN_DEV_ORCONF(in_dev, ROUTE_LOCALNET)\n#define IN_DEV_NET_ROUTE_LOCALNET(in_dev, net)\t\\\n\tIN_DEV_NET_ORCONF(in_dev, net, ROUTE_LOCALNET)\n\n#define IN_DEV_RX_REDIRECTS(in_dev) \\\n\t((IN_DEV_FORWARD(in_dev) && \\\n\t  IN_DEV_ANDCONF((in_dev), ACCEPT_REDIRECTS)) \\\n\t || (!IN_DEV_FORWARD(in_dev) && \\\n\t  IN_DEV_ORCONF((in_dev), ACCEPT_REDIRECTS)))\n\n#define IN_DEV_IGNORE_ROUTES_WITH_LINKDOWN(in_dev) \\\n\tIN_DEV_ORCONF((in_dev), IGNORE_ROUTES_WITH_LINKDOWN)\n\n#define IN_DEV_ARPFILTER(in_dev)\tIN_DEV_ORCONF((in_dev), ARPFILTER)\n#define IN_DEV_ARP_ACCEPT(in_dev)\tIN_DEV_MAXCONF((in_dev), ARP_ACCEPT)\n#define IN_DEV_ARP_ANNOUNCE(in_dev)\tIN_DEV_MAXCONF((in_dev), ARP_ANNOUNCE)\n#define IN_DEV_ARP_IGNORE(in_dev)\tIN_DEV_MAXCONF((in_dev), ARP_IGNORE)\n#define IN_DEV_ARP_NOTIFY(in_dev)\tIN_DEV_MAXCONF((in_dev), ARP_NOTIFY)\n#define IN_DEV_ARP_EVICT_NOCARRIER(in_dev) IN_DEV_ANDCONF((in_dev), \\\n\t\t\t\t\t\t\t  ARP_EVICT_NOCARRIER)\n\nstruct in_ifaddr {\n\tstruct hlist_node\thash;\n\tstruct in_ifaddr\t__rcu *ifa_next;\n\tstruct in_device\t*ifa_dev;\n\tstruct rcu_head\t\trcu_head;\n\t__be32\t\t\tifa_local;\n\t__be32\t\t\tifa_address;\n\t__be32\t\t\tifa_mask;\n\t__u32\t\t\tifa_rt_priority;\n\t__be32\t\t\tifa_broadcast;\n\tunsigned char\t\tifa_scope;\n\tunsigned char\t\tifa_prefixlen;\n\tunsigned char\t\tifa_proto;\n\t__u32\t\t\tifa_flags;\n\tchar\t\t\tifa_label[IFNAMSIZ];\n\n\t \n\t__u32\t\t\tifa_valid_lft;\n\t__u32\t\t\tifa_preferred_lft;\n\tunsigned long\t\tifa_cstamp;  \n\tunsigned long\t\tifa_tstamp;  \n};\n\nstruct in_validator_info {\n\t__be32\t\t\tivi_addr;\n\tstruct in_device\t*ivi_dev;\n\tstruct netlink_ext_ack\t*extack;\n};\n\nint register_inetaddr_notifier(struct notifier_block *nb);\nint unregister_inetaddr_notifier(struct notifier_block *nb);\nint register_inetaddr_validator_notifier(struct notifier_block *nb);\nint unregister_inetaddr_validator_notifier(struct notifier_block *nb);\n\nvoid inet_netconf_notify_devconf(struct net *net, int event, int type,\n\t\t\t\t int ifindex, struct ipv4_devconf *devconf);\n\nstruct net_device *__ip_dev_find(struct net *net, __be32 addr, bool devref);\nstatic inline struct net_device *ip_dev_find(struct net *net, __be32 addr)\n{\n\treturn __ip_dev_find(net, addr, true);\n}\n\nint inet_addr_onlink(struct in_device *in_dev, __be32 a, __be32 b);\nint devinet_ioctl(struct net *net, unsigned int cmd, struct ifreq *);\n#ifdef CONFIG_INET\nint inet_gifconf(struct net_device *dev, char __user *buf, int len, int size);\n#else\nstatic inline int inet_gifconf(struct net_device *dev, char __user *buf,\n\t\t\t       int len, int size)\n{\n\treturn 0;\n}\n#endif\nvoid devinet_init(void);\nstruct in_device *inetdev_by_index(struct net *, int);\n__be32 inet_select_addr(const struct net_device *dev, __be32 dst, int scope);\n__be32 inet_confirm_addr(struct net *net, struct in_device *in_dev, __be32 dst,\n\t\t\t __be32 local, int scope);\nstruct in_ifaddr *inet_ifa_byprefix(struct in_device *in_dev, __be32 prefix,\n\t\t\t\t    __be32 mask);\nstruct in_ifaddr *inet_lookup_ifaddr_rcu(struct net *net, __be32 addr);\nstatic inline bool inet_ifa_match(__be32 addr, const struct in_ifaddr *ifa)\n{\n\treturn !((addr^ifa->ifa_address)&ifa->ifa_mask);\n}\n\n \n \nstatic __inline__ bool bad_mask(__be32 mask, __be32 addr)\n{\n\t__u32 hmask;\n\tif (addr & (mask = ~mask))\n\t\treturn true;\n\thmask = ntohl(mask);\n\tif (hmask & (hmask+1))\n\t\treturn true;\n\treturn false;\n}\n\n#define in_dev_for_each_ifa_rtnl(ifa, in_dev)\t\t\t\\\n\tfor (ifa = rtnl_dereference((in_dev)->ifa_list); ifa;\t\\\n\t     ifa = rtnl_dereference(ifa->ifa_next))\n\n#define in_dev_for_each_ifa_rcu(ifa, in_dev)\t\t\t\\\n\tfor (ifa = rcu_dereference((in_dev)->ifa_list); ifa;\t\\\n\t     ifa = rcu_dereference(ifa->ifa_next))\n\nstatic inline struct in_device *__in_dev_get_rcu(const struct net_device *dev)\n{\n\treturn rcu_dereference(dev->ip_ptr);\n}\n\nstatic inline struct in_device *in_dev_get(const struct net_device *dev)\n{\n\tstruct in_device *in_dev;\n\n\trcu_read_lock();\n\tin_dev = __in_dev_get_rcu(dev);\n\tif (in_dev)\n\t\trefcount_inc(&in_dev->refcnt);\n\trcu_read_unlock();\n\treturn in_dev;\n}\n\nstatic inline struct in_device *__in_dev_get_rtnl(const struct net_device *dev)\n{\n\treturn rtnl_dereference(dev->ip_ptr);\n}\n\n \nstatic inline bool ip_ignore_linkdown(const struct net_device *dev)\n{\n\tstruct in_device *in_dev;\n\tbool rc = false;\n\n\tin_dev = rcu_dereference_rtnl(dev->ip_ptr);\n\tif (in_dev &&\n\t    IN_DEV_IGNORE_ROUTES_WITH_LINKDOWN(in_dev))\n\t\trc = true;\n\n\treturn rc;\n}\n\nstatic inline struct neigh_parms *__in_dev_arp_parms_get_rcu(const struct net_device *dev)\n{\n\tstruct in_device *in_dev = __in_dev_get_rcu(dev);\n\n\treturn in_dev ? in_dev->arp_parms : NULL;\n}\n\nvoid in_dev_finish_destroy(struct in_device *idev);\n\nstatic inline void in_dev_put(struct in_device *idev)\n{\n\tif (refcount_dec_and_test(&idev->refcnt))\n\t\tin_dev_finish_destroy(idev);\n}\n\n#define __in_dev_put(idev)  refcount_dec(&(idev)->refcnt)\n#define in_dev_hold(idev)   refcount_inc(&(idev)->refcnt)\n\n#endif  \n\nstatic __inline__ __be32 inet_make_mask(int logmask)\n{\n\tif (logmask)\n\t\treturn htonl(~((1U<<(32-logmask))-1));\n\treturn 0;\n}\n\nstatic __inline__ int inet_mask_len(__be32 mask)\n{\n\t__u32 hmask = ntohl(mask);\n\tif (!hmask)\n\t\treturn 0;\n\treturn 32 - ffz(~hmask);\n}\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}