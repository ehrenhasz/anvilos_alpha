{
  "module_name": "uidgid.h",
  "hash_id": "d720573307444058b43df6a84c15ac60c27fdafcac9f2688653dcfbf31c919e9",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/uidgid.h",
  "human_readable_source": " \n#ifndef _LINUX_UIDGID_H\n#define _LINUX_UIDGID_H\n\n \n#include <linux/types.h>\n#include <linux/highuid.h>\n\nstruct user_namespace;\nextern struct user_namespace init_user_ns;\n\ntypedef struct {\n\tuid_t val;\n} kuid_t;\n\n\ntypedef struct {\n\tgid_t val;\n} kgid_t;\n\n#define KUIDT_INIT(value) (kuid_t){ value }\n#define KGIDT_INIT(value) (kgid_t){ value }\n\n#ifdef CONFIG_MULTIUSER\nstatic inline uid_t __kuid_val(kuid_t uid)\n{\n\treturn uid.val;\n}\n\nstatic inline gid_t __kgid_val(kgid_t gid)\n{\n\treturn gid.val;\n}\n#else\nstatic inline uid_t __kuid_val(kuid_t uid)\n{\n\treturn 0;\n}\n\nstatic inline gid_t __kgid_val(kgid_t gid)\n{\n\treturn 0;\n}\n#endif\n\n#define GLOBAL_ROOT_UID KUIDT_INIT(0)\n#define GLOBAL_ROOT_GID KGIDT_INIT(0)\n\n#define INVALID_UID KUIDT_INIT(-1)\n#define INVALID_GID KGIDT_INIT(-1)\n\nstatic inline bool uid_eq(kuid_t left, kuid_t right)\n{\n\treturn __kuid_val(left) == __kuid_val(right);\n}\n\nstatic inline bool gid_eq(kgid_t left, kgid_t right)\n{\n\treturn __kgid_val(left) == __kgid_val(right);\n}\n\nstatic inline bool uid_gt(kuid_t left, kuid_t right)\n{\n\treturn __kuid_val(left) > __kuid_val(right);\n}\n\nstatic inline bool gid_gt(kgid_t left, kgid_t right)\n{\n\treturn __kgid_val(left) > __kgid_val(right);\n}\n\nstatic inline bool uid_gte(kuid_t left, kuid_t right)\n{\n\treturn __kuid_val(left) >= __kuid_val(right);\n}\n\nstatic inline bool gid_gte(kgid_t left, kgid_t right)\n{\n\treturn __kgid_val(left) >= __kgid_val(right);\n}\n\nstatic inline bool uid_lt(kuid_t left, kuid_t right)\n{\n\treturn __kuid_val(left) < __kuid_val(right);\n}\n\nstatic inline bool gid_lt(kgid_t left, kgid_t right)\n{\n\treturn __kgid_val(left) < __kgid_val(right);\n}\n\nstatic inline bool uid_lte(kuid_t left, kuid_t right)\n{\n\treturn __kuid_val(left) <= __kuid_val(right);\n}\n\nstatic inline bool gid_lte(kgid_t left, kgid_t right)\n{\n\treturn __kgid_val(left) <= __kgid_val(right);\n}\n\nstatic inline bool uid_valid(kuid_t uid)\n{\n\treturn __kuid_val(uid) != (uid_t) -1;\n}\n\nstatic inline bool gid_valid(kgid_t gid)\n{\n\treturn __kgid_val(gid) != (gid_t) -1;\n}\n\n#ifdef CONFIG_USER_NS\n\nextern kuid_t make_kuid(struct user_namespace *from, uid_t uid);\nextern kgid_t make_kgid(struct user_namespace *from, gid_t gid);\n\nextern uid_t from_kuid(struct user_namespace *to, kuid_t uid);\nextern gid_t from_kgid(struct user_namespace *to, kgid_t gid);\nextern uid_t from_kuid_munged(struct user_namespace *to, kuid_t uid);\nextern gid_t from_kgid_munged(struct user_namespace *to, kgid_t gid);\n\nstatic inline bool kuid_has_mapping(struct user_namespace *ns, kuid_t uid)\n{\n\treturn from_kuid(ns, uid) != (uid_t) -1;\n}\n\nstatic inline bool kgid_has_mapping(struct user_namespace *ns, kgid_t gid)\n{\n\treturn from_kgid(ns, gid) != (gid_t) -1;\n}\n\n#else\n\nstatic inline kuid_t make_kuid(struct user_namespace *from, uid_t uid)\n{\n\treturn KUIDT_INIT(uid);\n}\n\nstatic inline kgid_t make_kgid(struct user_namespace *from, gid_t gid)\n{\n\treturn KGIDT_INIT(gid);\n}\n\nstatic inline uid_t from_kuid(struct user_namespace *to, kuid_t kuid)\n{\n\treturn __kuid_val(kuid);\n}\n\nstatic inline gid_t from_kgid(struct user_namespace *to, kgid_t kgid)\n{\n\treturn __kgid_val(kgid);\n}\n\nstatic inline uid_t from_kuid_munged(struct user_namespace *to, kuid_t kuid)\n{\n\tuid_t uid = from_kuid(to, kuid);\n\tif (uid == (uid_t)-1)\n\t\tuid = overflowuid;\n\treturn uid;\n}\n\nstatic inline gid_t from_kgid_munged(struct user_namespace *to, kgid_t kgid)\n{\n\tgid_t gid = from_kgid(to, kgid);\n\tif (gid == (gid_t)-1)\n\t\tgid = overflowgid;\n\treturn gid;\n}\n\nstatic inline bool kuid_has_mapping(struct user_namespace *ns, kuid_t uid)\n{\n\treturn uid_valid(uid);\n}\n\nstatic inline bool kgid_has_mapping(struct user_namespace *ns, kgid_t gid)\n{\n\treturn gid_valid(gid);\n}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}