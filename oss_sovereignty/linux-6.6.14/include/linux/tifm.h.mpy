{
  "module_name": "tifm.h",
  "hash_id": "33054fbc037592d0674796872f8a57d6c8a3d572705be11bc0f86f7ae79cd3d4",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/tifm.h",
  "human_readable_source": " \n \n\n#ifndef _TIFM_H\n#define _TIFM_H\n\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/workqueue.h>\n\n \nenum {\n\tFM_SET_INTERRUPT_ENABLE   = 0x008,\n\tFM_CLEAR_INTERRUPT_ENABLE = 0x00c,\n\tFM_INTERRUPT_STATUS       = 0x014\n};\n\n \nenum {\n\tSOCK_CONTROL                   = 0x004,\n\tSOCK_PRESENT_STATE             = 0x008,\n\tSOCK_DMA_ADDRESS               = 0x00c,\n\tSOCK_DMA_CONTROL               = 0x010,\n\tSOCK_DMA_FIFO_INT_ENABLE_SET   = 0x014,\n\tSOCK_DMA_FIFO_INT_ENABLE_CLEAR = 0x018,\n\tSOCK_DMA_FIFO_STATUS           = 0x020,\n\tSOCK_FIFO_CONTROL              = 0x024,\n\tSOCK_FIFO_PAGE_SIZE            = 0x028,\n\tSOCK_MMCSD_COMMAND             = 0x104,\n\tSOCK_MMCSD_ARG_LOW             = 0x108,\n\tSOCK_MMCSD_ARG_HIGH            = 0x10c,\n\tSOCK_MMCSD_CONFIG              = 0x110,\n\tSOCK_MMCSD_STATUS              = 0x114,\n\tSOCK_MMCSD_INT_ENABLE          = 0x118,\n\tSOCK_MMCSD_COMMAND_TO          = 0x11c,\n\tSOCK_MMCSD_DATA_TO             = 0x120,\n\tSOCK_MMCSD_DATA                = 0x124,\n\tSOCK_MMCSD_BLOCK_LEN           = 0x128,\n\tSOCK_MMCSD_NUM_BLOCKS          = 0x12c,\n\tSOCK_MMCSD_BUFFER_CONFIG       = 0x130,\n\tSOCK_MMCSD_SPI_CONFIG          = 0x134,\n\tSOCK_MMCSD_SDIO_MODE_CONFIG    = 0x138,\n\tSOCK_MMCSD_RESPONSE            = 0x144,\n\tSOCK_MMCSD_SDIO_SR             = 0x164,\n\tSOCK_MMCSD_SYSTEM_CONTROL      = 0x168,\n\tSOCK_MMCSD_SYSTEM_STATUS       = 0x16c,\n\tSOCK_MS_COMMAND                = 0x184,\n\tSOCK_MS_DATA                   = 0x188,\n\tSOCK_MS_STATUS                 = 0x18c,\n\tSOCK_MS_SYSTEM                 = 0x190,\n\tSOCK_FIFO_ACCESS               = 0x200\n};\n\n#define TIFM_CTRL_LED             0x00000040\n#define TIFM_CTRL_FAST_CLK        0x00000100\n#define TIFM_CTRL_POWER_MASK      0x00000007\n\n#define TIFM_SOCK_STATE_OCCUPIED  0x00000008\n#define TIFM_SOCK_STATE_POWERED   0x00000080\n\n#define TIFM_FIFO_ENABLE          0x00000001\n#define TIFM_FIFO_READY           0x00000001\n#define TIFM_FIFO_MORE            0x00000008\n#define TIFM_FIFO_INT_SETALL      0x0000ffff\n#define TIFM_FIFO_INTMASK         0x00000005\n\n#define TIFM_DMA_RESET            0x00000002\n#define TIFM_DMA_TX               0x00008000\n#define TIFM_DMA_EN               0x00000001\n#define TIFM_DMA_TSIZE            0x0000007f\n\n#define TIFM_TYPE_XD 1\n#define TIFM_TYPE_MS 2\n#define TIFM_TYPE_SD 3\n\nstruct tifm_device_id {\n\tunsigned char type;\n};\n\nstruct tifm_driver;\nstruct tifm_dev {\n\tchar __iomem  *addr;\n\tspinlock_t    lock;\n\tunsigned char type;\n\tunsigned int  socket_id;\n\n\tvoid          (*card_event)(struct tifm_dev *sock);\n\tvoid          (*data_event)(struct tifm_dev *sock);\n\n\tstruct device dev;\n};\n\nstruct tifm_driver {\n\tstruct tifm_device_id *id_table;\n\tint                   (*probe)(struct tifm_dev *dev);\n\tvoid                  (*remove)(struct tifm_dev *dev);\n\tint                   (*suspend)(struct tifm_dev *dev,\n\t\t\t\t\t pm_message_t state);\n\tint                   (*resume)(struct tifm_dev *dev);\n\n\tstruct device_driver  driver;\n};\n\nstruct tifm_adapter {\n\tchar __iomem        *addr;\n\tspinlock_t          lock;\n\tunsigned int        irq_status;\n\tunsigned int        socket_change_set;\n\tunsigned int        id;\n\tunsigned int        num_sockets;\n\tstruct completion   *finish_me;\n\n\tstruct work_struct  media_switcher;\n\tstruct device\t    dev;\n\n\tvoid                (*eject)(struct tifm_adapter *fm,\n\t\t\t\t     struct tifm_dev *sock);\n\tint                 (*has_ms_pif)(struct tifm_adapter *fm,\n\t\t\t\t\t  struct tifm_dev *sock);\n\n\tstruct tifm_dev     *sockets[];\n};\n\nstruct tifm_adapter *tifm_alloc_adapter(unsigned int num_sockets,\n\t\t\t\t\tstruct device *dev);\nint tifm_add_adapter(struct tifm_adapter *fm);\nvoid tifm_remove_adapter(struct tifm_adapter *fm);\nvoid tifm_free_adapter(struct tifm_adapter *fm);\n\nvoid tifm_free_device(struct device *dev);\nstruct tifm_dev *tifm_alloc_device(struct tifm_adapter *fm, unsigned int id,\n\t\t\t\t   unsigned char type);\n\nint tifm_register_driver(struct tifm_driver *drv);\nvoid tifm_unregister_driver(struct tifm_driver *drv);\nvoid tifm_eject(struct tifm_dev *sock);\nint tifm_has_ms_pif(struct tifm_dev *sock);\nint tifm_map_sg(struct tifm_dev *sock, struct scatterlist *sg, int nents,\n\t\tint direction);\nvoid tifm_unmap_sg(struct tifm_dev *sock, struct scatterlist *sg, int nents,\n\t\t   int direction);\nvoid tifm_queue_work(struct work_struct *work);\n\nstatic inline void *tifm_get_drvdata(struct tifm_dev *dev)\n{\n\treturn dev_get_drvdata(&dev->dev);\n}\n\nstatic inline void tifm_set_drvdata(struct tifm_dev *dev, void *data)\n{\n\tdev_set_drvdata(&dev->dev, data);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}