{
  "module_name": "tty.h",
  "hash_id": "30068e5b1f950473daf26bf7b497a3a9bc8d68788bd68d0a3f455ff92df23f46",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/tty.h",
  "human_readable_source": " \n#ifndef _LINUX_TTY_H\n#define _LINUX_TTY_H\n\n#include <linux/fs.h>\n#include <linux/major.h>\n#include <linux/termios.h>\n#include <linux/workqueue.h>\n#include <linux/tty_buffer.h>\n#include <linux/tty_driver.h>\n#include <linux/tty_ldisc.h>\n#include <linux/tty_port.h>\n#include <linux/mutex.h>\n#include <linux/tty_flags.h>\n#include <uapi/linux/tty.h>\n#include <linux/rwsem.h>\n#include <linux/llist.h>\n\n\n \n#define NR_UNIX98_PTY_DEFAULT\t4096       \n#define NR_UNIX98_PTY_RESERVE\t1024\t   \n#define NR_UNIX98_PTY_MAX\t(1 << MINORBITS)  \n\n \n#define __DISABLED_CHAR '\\0'\n\n#define INTR_CHAR(tty) ((tty)->termios.c_cc[VINTR])\n#define QUIT_CHAR(tty) ((tty)->termios.c_cc[VQUIT])\n#define ERASE_CHAR(tty) ((tty)->termios.c_cc[VERASE])\n#define KILL_CHAR(tty) ((tty)->termios.c_cc[VKILL])\n#define EOF_CHAR(tty) ((tty)->termios.c_cc[VEOF])\n#define TIME_CHAR(tty) ((tty)->termios.c_cc[VTIME])\n#define MIN_CHAR(tty) ((tty)->termios.c_cc[VMIN])\n#define SWTC_CHAR(tty) ((tty)->termios.c_cc[VSWTC])\n#define START_CHAR(tty) ((tty)->termios.c_cc[VSTART])\n#define STOP_CHAR(tty) ((tty)->termios.c_cc[VSTOP])\n#define SUSP_CHAR(tty) ((tty)->termios.c_cc[VSUSP])\n#define EOL_CHAR(tty) ((tty)->termios.c_cc[VEOL])\n#define REPRINT_CHAR(tty) ((tty)->termios.c_cc[VREPRINT])\n#define DISCARD_CHAR(tty) ((tty)->termios.c_cc[VDISCARD])\n#define WERASE_CHAR(tty) ((tty)->termios.c_cc[VWERASE])\n#define LNEXT_CHAR(tty)\t((tty)->termios.c_cc[VLNEXT])\n#define EOL2_CHAR(tty) ((tty)->termios.c_cc[VEOL2])\n\n#define _I_FLAG(tty, f)\t((tty)->termios.c_iflag & (f))\n#define _O_FLAG(tty, f)\t((tty)->termios.c_oflag & (f))\n#define _C_FLAG(tty, f)\t((tty)->termios.c_cflag & (f))\n#define _L_FLAG(tty, f)\t((tty)->termios.c_lflag & (f))\n\n#define I_IGNBRK(tty)\t_I_FLAG((tty), IGNBRK)\n#define I_BRKINT(tty)\t_I_FLAG((tty), BRKINT)\n#define I_IGNPAR(tty)\t_I_FLAG((tty), IGNPAR)\n#define I_PARMRK(tty)\t_I_FLAG((tty), PARMRK)\n#define I_INPCK(tty)\t_I_FLAG((tty), INPCK)\n#define I_ISTRIP(tty)\t_I_FLAG((tty), ISTRIP)\n#define I_INLCR(tty)\t_I_FLAG((tty), INLCR)\n#define I_IGNCR(tty)\t_I_FLAG((tty), IGNCR)\n#define I_ICRNL(tty)\t_I_FLAG((tty), ICRNL)\n#define I_IUCLC(tty)\t_I_FLAG((tty), IUCLC)\n#define I_IXON(tty)\t_I_FLAG((tty), IXON)\n#define I_IXANY(tty)\t_I_FLAG((tty), IXANY)\n#define I_IXOFF(tty)\t_I_FLAG((tty), IXOFF)\n#define I_IMAXBEL(tty)\t_I_FLAG((tty), IMAXBEL)\n#define I_IUTF8(tty)\t_I_FLAG((tty), IUTF8)\n\n#define O_OPOST(tty)\t_O_FLAG((tty), OPOST)\n#define O_OLCUC(tty)\t_O_FLAG((tty), OLCUC)\n#define O_ONLCR(tty)\t_O_FLAG((tty), ONLCR)\n#define O_OCRNL(tty)\t_O_FLAG((tty), OCRNL)\n#define O_ONOCR(tty)\t_O_FLAG((tty), ONOCR)\n#define O_ONLRET(tty)\t_O_FLAG((tty), ONLRET)\n#define O_OFILL(tty)\t_O_FLAG((tty), OFILL)\n#define O_OFDEL(tty)\t_O_FLAG((tty), OFDEL)\n#define O_NLDLY(tty)\t_O_FLAG((tty), NLDLY)\n#define O_CRDLY(tty)\t_O_FLAG((tty), CRDLY)\n#define O_TABDLY(tty)\t_O_FLAG((tty), TABDLY)\n#define O_BSDLY(tty)\t_O_FLAG((tty), BSDLY)\n#define O_VTDLY(tty)\t_O_FLAG((tty), VTDLY)\n#define O_FFDLY(tty)\t_O_FLAG((tty), FFDLY)\n\n#define C_BAUD(tty)\t_C_FLAG((tty), CBAUD)\n#define C_CSIZE(tty)\t_C_FLAG((tty), CSIZE)\n#define C_CSTOPB(tty)\t_C_FLAG((tty), CSTOPB)\n#define C_CREAD(tty)\t_C_FLAG((tty), CREAD)\n#define C_PARENB(tty)\t_C_FLAG((tty), PARENB)\n#define C_PARODD(tty)\t_C_FLAG((tty), PARODD)\n#define C_HUPCL(tty)\t_C_FLAG((tty), HUPCL)\n#define C_CLOCAL(tty)\t_C_FLAG((tty), CLOCAL)\n#define C_CIBAUD(tty)\t_C_FLAG((tty), CIBAUD)\n#define C_CRTSCTS(tty)\t_C_FLAG((tty), CRTSCTS)\n#define C_CMSPAR(tty)\t_C_FLAG((tty), CMSPAR)\n\n#define L_ISIG(tty)\t_L_FLAG((tty), ISIG)\n#define L_ICANON(tty)\t_L_FLAG((tty), ICANON)\n#define L_XCASE(tty)\t_L_FLAG((tty), XCASE)\n#define L_ECHO(tty)\t_L_FLAG((tty), ECHO)\n#define L_ECHOE(tty)\t_L_FLAG((tty), ECHOE)\n#define L_ECHOK(tty)\t_L_FLAG((tty), ECHOK)\n#define L_ECHONL(tty)\t_L_FLAG((tty), ECHONL)\n#define L_NOFLSH(tty)\t_L_FLAG((tty), NOFLSH)\n#define L_TOSTOP(tty)\t_L_FLAG((tty), TOSTOP)\n#define L_ECHOCTL(tty)\t_L_FLAG((tty), ECHOCTL)\n#define L_ECHOPRT(tty)\t_L_FLAG((tty), ECHOPRT)\n#define L_ECHOKE(tty)\t_L_FLAG((tty), ECHOKE)\n#define L_FLUSHO(tty)\t_L_FLAG((tty), FLUSHO)\n#define L_PENDIN(tty)\t_L_FLAG((tty), PENDIN)\n#define L_IEXTEN(tty)\t_L_FLAG((tty), IEXTEN)\n#define L_EXTPROC(tty)\t_L_FLAG((tty), EXTPROC)\n\nstruct device;\nstruct signal_struct;\nstruct tty_operations;\n\n \nstruct tty_struct {\n\tstruct kref kref;\n\tint index;\n\tstruct device *dev;\n\tstruct tty_driver *driver;\n\tstruct tty_port *port;\n\tconst struct tty_operations *ops;\n\n\tstruct tty_ldisc *ldisc;\n\tstruct ld_semaphore ldisc_sem;\n\n\tstruct mutex atomic_write_lock;\n\tstruct mutex legacy_mutex;\n\tstruct mutex throttle_mutex;\n\tstruct rw_semaphore termios_rwsem;\n\tstruct mutex winsize_mutex;\n\tstruct ktermios termios, termios_locked;\n\tchar name[64];\n\tunsigned long flags;\n\tint count;\n\tunsigned int receive_room;\n\tstruct winsize winsize;\n\n\tstruct {\n\t\tspinlock_t lock;\n\t\tbool stopped;\n\t\tbool tco_stopped;\n\t\tunsigned long unused[0];\n\t} __aligned(sizeof(unsigned long)) flow;\n\n\tstruct {\n\t\tstruct pid *pgrp;\n\t\tstruct pid *session;\n\t\tspinlock_t lock;\n\t\tunsigned char pktstatus;\n\t\tbool packet;\n\t\tunsigned long unused[0];\n\t} __aligned(sizeof(unsigned long)) ctrl;\n\n\tbool hw_stopped;\n\tbool closing;\n\tint flow_change;\n\n\tstruct tty_struct *link;\n\tstruct fasync_struct *fasync;\n\twait_queue_head_t write_wait;\n\twait_queue_head_t read_wait;\n\tstruct work_struct hangup_work;\n\tvoid *disc_data;\n\tvoid *driver_data;\n\tspinlock_t files_lock;\n\tint write_cnt;\n\tunsigned char *write_buf;\n\n\tstruct list_head tty_files;\n\n#define N_TTY_BUF_SIZE 4096\n\tstruct work_struct SAK_work;\n} __randomize_layout;\n\n \nstruct tty_file_private {\n\tstruct tty_struct *tty;\n\tstruct file *file;\n\tstruct list_head list;\n};\n\n \n#define TTY_THROTTLED\t\t0\n#define TTY_IO_ERROR\t\t1\n#define TTY_OTHER_CLOSED\t2\n#define TTY_EXCLUSIVE\t\t3\n#define TTY_DO_WRITE_WAKEUP\t5\n#define TTY_LDISC_OPEN\t\t11\n#define TTY_PTY_LOCK\t\t16\n#define TTY_NO_WRITE_SPLIT\t17\n#define TTY_HUPPED\t\t18\n#define TTY_HUPPING\t\t19\n#define TTY_LDISC_CHANGING\t20\n#define TTY_LDISC_HALTED\t22\n\nstatic inline bool tty_io_nonblock(struct tty_struct *tty, struct file *file)\n{\n\treturn file->f_flags & O_NONBLOCK ||\n\t\ttest_bit(TTY_LDISC_CHANGING, &tty->flags);\n}\n\nstatic inline bool tty_io_error(struct tty_struct *tty)\n{\n\treturn test_bit(TTY_IO_ERROR, &tty->flags);\n}\n\nstatic inline bool tty_throttled(struct tty_struct *tty)\n{\n\treturn test_bit(TTY_THROTTLED, &tty->flags);\n}\n\n#ifdef CONFIG_TTY\nvoid tty_kref_put(struct tty_struct *tty);\nstruct pid *tty_get_pgrp(struct tty_struct *tty);\nvoid tty_vhangup_self(void);\nvoid disassociate_ctty(int priv);\ndev_t tty_devnum(struct tty_struct *tty);\nvoid proc_clear_tty(struct task_struct *p);\nstruct tty_struct *get_current_tty(void);\n \nint __init tty_init(void);\nconst char *tty_name(const struct tty_struct *tty);\nstruct tty_struct *tty_kopen_exclusive(dev_t device);\nstruct tty_struct *tty_kopen_shared(dev_t device);\nvoid tty_kclose(struct tty_struct *tty);\nint tty_dev_name_to_number(const char *name, dev_t *number);\n#else\nstatic inline void tty_kref_put(struct tty_struct *tty)\n{ }\nstatic inline struct pid *tty_get_pgrp(struct tty_struct *tty)\n{ return NULL; }\nstatic inline void tty_vhangup_self(void)\n{ }\nstatic inline void disassociate_ctty(int priv)\n{ }\nstatic inline dev_t tty_devnum(struct tty_struct *tty)\n{ return 0; }\nstatic inline void proc_clear_tty(struct task_struct *p)\n{ }\nstatic inline struct tty_struct *get_current_tty(void)\n{ return NULL; }\n \nstatic inline int __init tty_init(void)\n{ return 0; }\nstatic inline const char *tty_name(const struct tty_struct *tty)\n{ return \"(none)\"; }\nstatic inline struct tty_struct *tty_kopen_exclusive(dev_t device)\n{ return ERR_PTR(-ENODEV); }\nstatic inline void tty_kclose(struct tty_struct *tty)\n{ }\nstatic inline int tty_dev_name_to_number(const char *name, dev_t *number)\n{ return -ENOTSUPP; }\n#endif\n\nextern struct ktermios tty_std_termios;\n\nint vcs_init(void);\n\nextern const struct class tty_class;\n\n \n\nstatic inline struct tty_struct *tty_kref_get(struct tty_struct *tty)\n{\n\tif (tty)\n\t\tkref_get(&tty->kref);\n\treturn tty;\n}\n\nconst char *tty_driver_name(const struct tty_struct *tty);\nvoid tty_wait_until_sent(struct tty_struct *tty, long timeout);\nvoid stop_tty(struct tty_struct *tty);\nvoid start_tty(struct tty_struct *tty);\nvoid tty_write_message(struct tty_struct *tty, char *msg);\nint tty_send_xchar(struct tty_struct *tty, char ch);\nint tty_put_char(struct tty_struct *tty, unsigned char c);\nunsigned int tty_chars_in_buffer(struct tty_struct *tty);\nunsigned int tty_write_room(struct tty_struct *tty);\nvoid tty_driver_flush_buffer(struct tty_struct *tty);\nvoid tty_unthrottle(struct tty_struct *tty);\nint tty_throttle_safe(struct tty_struct *tty);\nint tty_unthrottle_safe(struct tty_struct *tty);\nint tty_do_resize(struct tty_struct *tty, struct winsize *ws);\nint tty_get_icount(struct tty_struct *tty,\n\t\tstruct serial_icounter_struct *icount);\nint is_current_pgrp_orphaned(void);\nvoid tty_hangup(struct tty_struct *tty);\nvoid tty_vhangup(struct tty_struct *tty);\nint tty_hung_up_p(struct file *filp);\nvoid do_SAK(struct tty_struct *tty);\nvoid __do_SAK(struct tty_struct *tty);\nvoid no_tty(void);\nspeed_t tty_termios_baud_rate(const struct ktermios *termios);\nvoid tty_termios_encode_baud_rate(struct ktermios *termios, speed_t ibaud,\n\t\tspeed_t obaud);\nvoid tty_encode_baud_rate(struct tty_struct *tty, speed_t ibaud,\n\t\tspeed_t obaud);\n\n \nstatic inline speed_t tty_get_baud_rate(struct tty_struct *tty)\n{\n\treturn tty_termios_baud_rate(&tty->termios);\n}\n\nunsigned char tty_get_char_size(unsigned int cflag);\nunsigned char tty_get_frame_size(unsigned int cflag);\n\nvoid tty_termios_copy_hw(struct ktermios *new, const struct ktermios *old);\nbool tty_termios_hw_change(const struct ktermios *a, const struct ktermios *b);\nint tty_set_termios(struct tty_struct *tty, struct ktermios *kt);\n\nvoid tty_wakeup(struct tty_struct *tty);\n\nint tty_mode_ioctl(struct tty_struct *tty, unsigned int cmd, unsigned long arg);\nint tty_perform_flush(struct tty_struct *tty, unsigned long arg);\nstruct tty_struct *tty_init_dev(struct tty_driver *driver, int idx);\nvoid tty_release_struct(struct tty_struct *tty, int idx);\nvoid tty_init_termios(struct tty_struct *tty);\nvoid tty_save_termios(struct tty_struct *tty);\nint tty_standard_install(struct tty_driver *driver,\n\t\tstruct tty_struct *tty);\n\nextern struct mutex tty_mutex;\n\n \nvoid n_tty_inherit_ops(struct tty_ldisc_ops *ops);\n#ifdef CONFIG_TTY\nvoid __init n_tty_init(void);\n#else\nstatic inline void n_tty_init(void) { }\n#endif\n\n \n#ifdef CONFIG_AUDIT\nvoid tty_audit_exit(void);\nvoid tty_audit_fork(struct signal_struct *sig);\nint tty_audit_push(void);\n#else\nstatic inline void tty_audit_exit(void)\n{\n}\nstatic inline void tty_audit_fork(struct signal_struct *sig)\n{\n}\nstatic inline int tty_audit_push(void)\n{\n\treturn 0;\n}\n#endif\n\n \nint n_tty_ioctl_helper(struct tty_struct *tty, unsigned int cmd,\n\t\tunsigned long arg);\n\n \n\nint vt_ioctl(struct tty_struct *tty, unsigned int cmd, unsigned long arg);\n\nlong vt_compat_ioctl(struct tty_struct *tty, unsigned int cmd,\n\t\tunsigned long arg);\n\n \n \nvoid tty_lock(struct tty_struct *tty);\nint  tty_lock_interruptible(struct tty_struct *tty);\nvoid tty_unlock(struct tty_struct *tty);\nvoid tty_lock_slave(struct tty_struct *tty);\nvoid tty_unlock_slave(struct tty_struct *tty);\nvoid tty_set_lock_subclass(struct tty_struct *tty);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}