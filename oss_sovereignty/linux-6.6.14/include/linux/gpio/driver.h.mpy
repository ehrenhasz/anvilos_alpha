{
  "module_name": "driver.h",
  "hash_id": "e1b626efbf61a8cd60108ce43b16ddde4af8aef53c265ba74be40d88c6f3a077",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/gpio/driver.h",
  "human_readable_source": " \n#ifndef __LINUX_GPIO_DRIVER_H\n#define __LINUX_GPIO_DRIVER_H\n\n#include <linux/bits.h>\n#include <linux/irqchip/chained_irq.h>\n#include <linux/irqdomain.h>\n#include <linux/irqhandler.h>\n#include <linux/lockdep.h>\n#include <linux/pinctrl/pinconf-generic.h>\n#include <linux/pinctrl/pinctrl.h>\n#include <linux/property.h>\n#include <linux/spinlock_types.h>\n#include <linux/types.h>\n\n#ifdef CONFIG_GENERIC_MSI_IRQ\n#include <asm/msi.h>\n#endif\n\nstruct device;\nstruct irq_chip;\nstruct irq_data;\nstruct module;\nstruct of_phandle_args;\nstruct pinctrl_dev;\nstruct seq_file;\n\nstruct gpio_chip;\nstruct gpio_desc;\nstruct gpio_device;\n\nenum gpio_lookup_flags;\nenum gpiod_flags;\n\nunion gpio_irq_fwspec {\n\tstruct irq_fwspec\tfwspec;\n#ifdef CONFIG_GENERIC_MSI_IRQ\n\tmsi_alloc_info_t\tmsiinfo;\n#endif\n};\n\n#define GPIO_LINE_DIRECTION_IN\t1\n#define GPIO_LINE_DIRECTION_OUT\t0\n\n \nstruct gpio_irq_chip {\n\t \n\tstruct irq_chip *chip;\n\n\t \n\tstruct irq_domain *domain;\n\n#ifdef CONFIG_IRQ_DOMAIN_HIERARCHY\n\t \n\tstruct fwnode_handle *fwnode;\n\n\t \n\tstruct irq_domain *parent_domain;\n\n\t \n\tint (*child_to_parent_hwirq)(struct gpio_chip *gc,\n\t\t\t\t     unsigned int child_hwirq,\n\t\t\t\t     unsigned int child_type,\n\t\t\t\t     unsigned int *parent_hwirq,\n\t\t\t\t     unsigned int *parent_type);\n\n\t \n\tint (*populate_parent_alloc_arg)(struct gpio_chip *gc,\n\t\t\t\t\t union gpio_irq_fwspec *fwspec,\n\t\t\t\t\t unsigned int parent_hwirq,\n\t\t\t\t\t unsigned int parent_type);\n\n\t \n\tunsigned int (*child_offset_to_irq)(struct gpio_chip *gc,\n\t\t\t\t\t    unsigned int pin);\n\n\t \n\tstruct irq_domain_ops child_irq_domain_ops;\n#endif\n\n\t \n\tirq_flow_handler_t handler;\n\n\t \n\tunsigned int default_type;\n\n\t \n\tstruct lock_class_key *lock_key;\n\n\t \n\tstruct lock_class_key *request_key;\n\n\t \n\tirq_flow_handler_t parent_handler;\n\n\tunion {\n\t\t \n\t\tvoid *parent_handler_data;\n\n\t\t \n\t\tvoid **parent_handler_data_array;\n\t};\n\n\t \n\tunsigned int num_parents;\n\n\t \n\tunsigned int *parents;\n\n\t \n\tunsigned int *map;\n\n\t \n\tbool threaded;\n\n\t \n\tbool per_parent_data;\n\n\t \n\tbool initialized;\n\n\t \n\tbool domain_is_allocated_externally;\n\n\t \n\tint (*init_hw)(struct gpio_chip *gc);\n\n\t \n\tvoid (*init_valid_mask)(struct gpio_chip *gc,\n\t\t\t\tunsigned long *valid_mask,\n\t\t\t\tunsigned int ngpios);\n\n\t \n\tunsigned long *valid_mask;\n\n\t \n\tunsigned int first;\n\n\t \n\tvoid\t\t(*irq_enable)(struct irq_data *data);\n\n\t \n\tvoid\t\t(*irq_disable)(struct irq_data *data);\n\t \n\tvoid\t\t(*irq_unmask)(struct irq_data *data);\n\n\t \n\tvoid\t\t(*irq_mask)(struct irq_data *data);\n};\n\n \nstruct gpio_chip {\n\tconst char\t\t*label;\n\tstruct gpio_device\t*gpiodev;\n\tstruct device\t\t*parent;\n\tstruct fwnode_handle\t*fwnode;\n\tstruct module\t\t*owner;\n\n\tint\t\t\t(*request)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\tvoid\t\t\t(*free)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\tint\t\t\t(*get_direction)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\tint\t\t\t(*direction_input)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\tint\t\t\t(*direction_output)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset, int value);\n\tint\t\t\t(*get)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\tint\t\t\t(*get_multiple)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned long *mask,\n\t\t\t\t\t\tunsigned long *bits);\n\tvoid\t\t\t(*set)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset, int value);\n\tvoid\t\t\t(*set_multiple)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned long *mask,\n\t\t\t\t\t\tunsigned long *bits);\n\tint\t\t\t(*set_config)(struct gpio_chip *gc,\n\t\t\t\t\t      unsigned int offset,\n\t\t\t\t\t      unsigned long config);\n\tint\t\t\t(*to_irq)(struct gpio_chip *gc,\n\t\t\t\t\t\tunsigned int offset);\n\n\tvoid\t\t\t(*dbg_show)(struct seq_file *s,\n\t\t\t\t\t\tstruct gpio_chip *gc);\n\n\tint\t\t\t(*init_valid_mask)(struct gpio_chip *gc,\n\t\t\t\t\t\t   unsigned long *valid_mask,\n\t\t\t\t\t\t   unsigned int ngpios);\n\n\tint\t\t\t(*add_pin_ranges)(struct gpio_chip *gc);\n\n\tint\t\t\t(*en_hw_timestamp)(struct gpio_chip *gc,\n\t\t\t\t\t\t   u32 offset,\n\t\t\t\t\t\t   unsigned long flags);\n\tint\t\t\t(*dis_hw_timestamp)(struct gpio_chip *gc,\n\t\t\t\t\t\t    u32 offset,\n\t\t\t\t\t\t    unsigned long flags);\n\tint\t\t\tbase;\n\tu16\t\t\tngpio;\n\tu16\t\t\toffset;\n\tconst char\t\t*const *names;\n\tbool\t\t\tcan_sleep;\n\n#if IS_ENABLED(CONFIG_GPIO_GENERIC)\n\tunsigned long (*read_reg)(void __iomem *reg);\n\tvoid (*write_reg)(void __iomem *reg, unsigned long data);\n\tbool be_bits;\n\tvoid __iomem *reg_dat;\n\tvoid __iomem *reg_set;\n\tvoid __iomem *reg_clr;\n\tvoid __iomem *reg_dir_out;\n\tvoid __iomem *reg_dir_in;\n\tbool bgpio_dir_unreadable;\n\tint bgpio_bits;\n\traw_spinlock_t bgpio_lock;\n\tunsigned long bgpio_data;\n\tunsigned long bgpio_dir;\n#endif  \n\n#ifdef CONFIG_GPIOLIB_IRQCHIP\n\t \n\n\t \n\tstruct gpio_irq_chip irq;\n#endif  \n\n\t \n\tunsigned long *valid_mask;\n\n#if defined(CONFIG_OF_GPIO)\n\t \n\n\t \n\tunsigned int of_gpio_n_cells;\n\n\t \n\tint (*of_xlate)(struct gpio_chip *gc,\n\t\t\tconst struct of_phandle_args *gpiospec, u32 *flags);\n#endif  \n};\n\nextern const char *gpiochip_is_requested(struct gpio_chip *gc,\n\t\t\tunsigned int offset);\n\n \n#define for_each_requested_gpio_in_range(chip, i, base, size, label)\t\t\t\\\n\tfor (i = 0; i < size; i++)\t\t\t\t\t\t\t\\\n\t\tif ((label = gpiochip_is_requested(chip, base + i)) == NULL) {} else\n\n \n#define for_each_requested_gpio(chip, i, label)\t\t\t\t\t\t\\\n\tfor_each_requested_gpio_in_range(chip, i, 0, chip->ngpio, label)\n\n \nextern int gpiochip_add_data_with_key(struct gpio_chip *gc, void *data,\n\t\t\t\t      struct lock_class_key *lock_key,\n\t\t\t\t      struct lock_class_key *request_key);\n\n \n#ifdef CONFIG_LOCKDEP\n#define gpiochip_add_data(gc, data) ({\t\t\\\n\t\tstatic struct lock_class_key lock_key;\t\\\n\t\tstatic struct lock_class_key request_key;\t  \\\n\t\tgpiochip_add_data_with_key(gc, data, &lock_key, \\\n\t\t\t\t\t   &request_key);\t  \\\n\t})\n#define devm_gpiochip_add_data(dev, gc, data) ({ \\\n\t\tstatic struct lock_class_key lock_key;\t\\\n\t\tstatic struct lock_class_key request_key;\t  \\\n\t\tdevm_gpiochip_add_data_with_key(dev, gc, data, &lock_key, \\\n\t\t\t\t\t   &request_key);\t  \\\n\t})\n#else\n#define gpiochip_add_data(gc, data) gpiochip_add_data_with_key(gc, data, NULL, NULL)\n#define devm_gpiochip_add_data(dev, gc, data) \\\n\tdevm_gpiochip_add_data_with_key(dev, gc, data, NULL, NULL)\n#endif  \n\nstatic inline int gpiochip_add(struct gpio_chip *gc)\n{\n\treturn gpiochip_add_data(gc, NULL);\n}\nextern void gpiochip_remove(struct gpio_chip *gc);\nextern int devm_gpiochip_add_data_with_key(struct device *dev, struct gpio_chip *gc, void *data,\n\t\t\t\t\t   struct lock_class_key *lock_key,\n\t\t\t\t\t   struct lock_class_key *request_key);\n\nextern struct gpio_chip *gpiochip_find(void *data,\n\t\t\t      int (*match)(struct gpio_chip *gc, void *data));\n\nstruct gpio_device *gpio_device_find(void *data,\n\t\t\t\tint (*match)(struct gpio_chip *gc, void *data));\n\nstruct gpio_device *gpio_device_get(struct gpio_device *gdev);\nvoid gpio_device_put(struct gpio_device *gdev);\n\nbool gpiochip_line_is_irq(struct gpio_chip *gc, unsigned int offset);\nint gpiochip_reqres_irq(struct gpio_chip *gc, unsigned int offset);\nvoid gpiochip_relres_irq(struct gpio_chip *gc, unsigned int offset);\nvoid gpiochip_disable_irq(struct gpio_chip *gc, unsigned int offset);\nvoid gpiochip_enable_irq(struct gpio_chip *gc, unsigned int offset);\n\n \nint gpiochip_irq_reqres(struct irq_data *data);\nvoid gpiochip_irq_relres(struct irq_data *data);\n\n \n#define\tGPIOCHIP_IRQ_RESOURCE_HELPERS\t\t\t\t\t\\\n\t\t.irq_request_resources  = gpiochip_irq_reqres,\t\t\\\n\t\t.irq_release_resources  = gpiochip_irq_relres\n\nstatic inline void gpio_irq_chip_set_chip(struct gpio_irq_chip *girq,\n\t\t\t\t\t  const struct irq_chip *chip)\n{\n\t \n\tgirq->chip = (struct irq_chip *)chip;\n}\n\n \nbool gpiochip_line_is_open_drain(struct gpio_chip *gc, unsigned int offset);\nbool gpiochip_line_is_open_source(struct gpio_chip *gc, unsigned int offset);\n\n \nbool gpiochip_line_is_persistent(struct gpio_chip *gc, unsigned int offset);\nbool gpiochip_line_is_valid(const struct gpio_chip *gc, unsigned int offset);\n\n \nvoid *gpiochip_get_data(struct gpio_chip *gc);\n\nstruct bgpio_pdata {\n\tconst char *label;\n\tint base;\n\tint ngpio;\n};\n\n#ifdef CONFIG_IRQ_DOMAIN_HIERARCHY\n\nint gpiochip_populate_parent_fwspec_twocell(struct gpio_chip *gc,\n\t\t\t\t\t    union gpio_irq_fwspec *gfwspec,\n\t\t\t\t\t    unsigned int parent_hwirq,\n\t\t\t\t\t    unsigned int parent_type);\nint gpiochip_populate_parent_fwspec_fourcell(struct gpio_chip *gc,\n\t\t\t\t\t     union gpio_irq_fwspec *gfwspec,\n\t\t\t\t\t     unsigned int parent_hwirq,\n\t\t\t\t\t     unsigned int parent_type);\n\n#endif  \n\nint bgpio_init(struct gpio_chip *gc, struct device *dev,\n\t       unsigned long sz, void __iomem *dat, void __iomem *set,\n\t       void __iomem *clr, void __iomem *dirout, void __iomem *dirin,\n\t       unsigned long flags);\n\n#define BGPIOF_BIG_ENDIAN\t\tBIT(0)\n#define BGPIOF_UNREADABLE_REG_SET\tBIT(1)  \n#define BGPIOF_UNREADABLE_REG_DIR\tBIT(2)  \n#define BGPIOF_BIG_ENDIAN_BYTE_ORDER\tBIT(3)\n#define BGPIOF_READ_OUTPUT_REG_SET\tBIT(4)  \n#define BGPIOF_NO_OUTPUT\t\tBIT(5)  \n#define BGPIOF_NO_SET_ON_INPUT\t\tBIT(6)\n\nint gpiochip_irq_map(struct irq_domain *d, unsigned int irq,\n\t\t     irq_hw_number_t hwirq);\nvoid gpiochip_irq_unmap(struct irq_domain *d, unsigned int irq);\n\nint gpiochip_irq_domain_activate(struct irq_domain *domain,\n\t\t\t\t struct irq_data *data, bool reserve);\nvoid gpiochip_irq_domain_deactivate(struct irq_domain *domain,\n\t\t\t\t    struct irq_data *data);\n\nbool gpiochip_irqchip_irq_valid(const struct gpio_chip *gc,\n\t\t\t\tunsigned int offset);\n\n#ifdef CONFIG_GPIOLIB_IRQCHIP\nint gpiochip_irqchip_add_domain(struct gpio_chip *gc,\n\t\t\t\tstruct irq_domain *domain);\n#else\n\n#include <asm/bug.h>\n#include <asm/errno.h>\n\nstatic inline int gpiochip_irqchip_add_domain(struct gpio_chip *gc,\n\t\t\t\t\t      struct irq_domain *domain)\n{\n\tWARN_ON(1);\n\treturn -EINVAL;\n}\n#endif\n\nint gpiochip_generic_request(struct gpio_chip *gc, unsigned int offset);\nvoid gpiochip_generic_free(struct gpio_chip *gc, unsigned int offset);\nint gpiochip_generic_config(struct gpio_chip *gc, unsigned int offset,\n\t\t\t    unsigned long config);\n\n \nstruct gpio_pin_range {\n\tstruct list_head node;\n\tstruct pinctrl_dev *pctldev;\n\tstruct pinctrl_gpio_range range;\n};\n\n#ifdef CONFIG_PINCTRL\n\nint gpiochip_add_pin_range(struct gpio_chip *gc, const char *pinctl_name,\n\t\t\t   unsigned int gpio_offset, unsigned int pin_offset,\n\t\t\t   unsigned int npins);\nint gpiochip_add_pingroup_range(struct gpio_chip *gc,\n\t\t\tstruct pinctrl_dev *pctldev,\n\t\t\tunsigned int gpio_offset, const char *pin_group);\nvoid gpiochip_remove_pin_ranges(struct gpio_chip *gc);\n\n#else  \n\nstatic inline int\ngpiochip_add_pin_range(struct gpio_chip *gc, const char *pinctl_name,\n\t\t       unsigned int gpio_offset, unsigned int pin_offset,\n\t\t       unsigned int npins)\n{\n\treturn 0;\n}\nstatic inline int\ngpiochip_add_pingroup_range(struct gpio_chip *gc,\n\t\t\tstruct pinctrl_dev *pctldev,\n\t\t\tunsigned int gpio_offset, const char *pin_group)\n{\n\treturn 0;\n}\n\nstatic inline void\ngpiochip_remove_pin_ranges(struct gpio_chip *gc)\n{\n}\n\n#endif  \n\nstruct gpio_desc *gpiochip_request_own_desc(struct gpio_chip *gc,\n\t\t\t\t\t    unsigned int hwnum,\n\t\t\t\t\t    const char *label,\n\t\t\t\t\t    enum gpio_lookup_flags lflags,\n\t\t\t\t\t    enum gpiod_flags dflags);\nvoid gpiochip_free_own_desc(struct gpio_desc *desc);\n\n#ifdef CONFIG_GPIOLIB\n\n \nint gpiochip_lock_as_irq(struct gpio_chip *gc, unsigned int offset);\nvoid gpiochip_unlock_as_irq(struct gpio_chip *gc, unsigned int offset);\n\n\nstruct gpio_chip *gpiod_to_chip(const struct gpio_desc *desc);\n\n#else  \n\n#include <linux/err.h>\n\n#include <asm/bug.h>\n\nstatic inline struct gpio_chip *gpiod_to_chip(const struct gpio_desc *desc)\n{\n\t \n\tWARN_ON(1);\n\treturn ERR_PTR(-ENODEV);\n}\n\nstatic inline int gpiochip_lock_as_irq(struct gpio_chip *gc,\n\t\t\t\t       unsigned int offset)\n{\n\tWARN_ON(1);\n\treturn -EINVAL;\n}\n\nstatic inline void gpiochip_unlock_as_irq(struct gpio_chip *gc,\n\t\t\t\t\t  unsigned int offset)\n{\n\tWARN_ON(1);\n}\n#endif  \n\n#define for_each_gpiochip_node(dev, child)\t\t\t\t\t\\\n\tdevice_for_each_child_node(dev, child)\t\t\t\t\t\\\n\t\tif (!fwnode_property_present(child, \"gpio-controller\")) {} else\n\nstatic inline unsigned int gpiochip_node_count(struct device *dev)\n{\n\tstruct fwnode_handle *child;\n\tunsigned int count = 0;\n\n\tfor_each_gpiochip_node(dev, child)\n\t\tcount++;\n\n\treturn count;\n}\n\nstatic inline struct fwnode_handle *gpiochip_node_get_first(struct device *dev)\n{\n\tstruct fwnode_handle *fwnode;\n\n\tfor_each_gpiochip_node(dev, fwnode)\n\t\treturn fwnode;\n\n\treturn NULL;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}