{
  "module_name": "hugetlb_cgroup.h",
  "hash_id": "b299e4c87313c0a5f4f4fe4f2a5c7622037540a816ce784ef7848d4293dbf0f2",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/hugetlb_cgroup.h",
  "human_readable_source": " \n\n#ifndef _LINUX_HUGETLB_CGROUP_H\n#define _LINUX_HUGETLB_CGROUP_H\n\n#include <linux/mmdebug.h>\n\nstruct hugetlb_cgroup;\nstruct resv_map;\nstruct file_region;\n\n#ifdef CONFIG_CGROUP_HUGETLB\n \n#define HUGETLB_CGROUP_MIN_ORDER order_base_2(__NR_USED_SUBPAGE)\n\nenum hugetlb_memory_event {\n\tHUGETLB_MAX,\n\tHUGETLB_NR_MEMORY_EVENTS,\n};\n\nstruct hugetlb_cgroup_per_node {\n\t \n\tunsigned long usage[HUGE_MAX_HSTATE];\n};\n\nstruct hugetlb_cgroup {\n\tstruct cgroup_subsys_state css;\n\n\t \n\tstruct page_counter hugepage[HUGE_MAX_HSTATE];\n\n\t \n\tstruct page_counter rsvd_hugepage[HUGE_MAX_HSTATE];\n\n\tatomic_long_t events[HUGE_MAX_HSTATE][HUGETLB_NR_MEMORY_EVENTS];\n\tatomic_long_t events_local[HUGE_MAX_HSTATE][HUGETLB_NR_MEMORY_EVENTS];\n\n\t \n\tstruct cgroup_file events_file[HUGE_MAX_HSTATE];\n\n\t \n\tstruct cgroup_file events_local_file[HUGE_MAX_HSTATE];\n\n\tstruct hugetlb_cgroup_per_node *nodeinfo[];\n};\n\nstatic inline struct hugetlb_cgroup *\n__hugetlb_cgroup_from_folio(struct folio *folio, bool rsvd)\n{\n\tVM_BUG_ON_FOLIO(!folio_test_hugetlb(folio), folio);\n\tif (folio_order(folio) < HUGETLB_CGROUP_MIN_ORDER)\n\t\treturn NULL;\n\tif (rsvd)\n\t\treturn folio->_hugetlb_cgroup_rsvd;\n\telse\n\t\treturn folio->_hugetlb_cgroup;\n}\n\nstatic inline struct hugetlb_cgroup *hugetlb_cgroup_from_folio(struct folio *folio)\n{\n\treturn __hugetlb_cgroup_from_folio(folio, false);\n}\n\nstatic inline struct hugetlb_cgroup *\nhugetlb_cgroup_from_folio_rsvd(struct folio *folio)\n{\n\treturn __hugetlb_cgroup_from_folio(folio, true);\n}\n\nstatic inline void __set_hugetlb_cgroup(struct folio *folio,\n\t\t\t\t       struct hugetlb_cgroup *h_cg, bool rsvd)\n{\n\tVM_BUG_ON_FOLIO(!folio_test_hugetlb(folio), folio);\n\tif (folio_order(folio) < HUGETLB_CGROUP_MIN_ORDER)\n\t\treturn;\n\tif (rsvd)\n\t\tfolio->_hugetlb_cgroup_rsvd = h_cg;\n\telse\n\t\tfolio->_hugetlb_cgroup = h_cg;\n}\n\nstatic inline void set_hugetlb_cgroup(struct folio *folio,\n\t\t\t\t     struct hugetlb_cgroup *h_cg)\n{\n\t__set_hugetlb_cgroup(folio, h_cg, false);\n}\n\nstatic inline void set_hugetlb_cgroup_rsvd(struct folio *folio,\n\t\t\t\t\t  struct hugetlb_cgroup *h_cg)\n{\n\t__set_hugetlb_cgroup(folio, h_cg, true);\n}\n\nstatic inline bool hugetlb_cgroup_disabled(void)\n{\n\treturn !cgroup_subsys_enabled(hugetlb_cgrp_subsys);\n}\n\nstatic inline void hugetlb_cgroup_put_rsvd_cgroup(struct hugetlb_cgroup *h_cg)\n{\n\tcss_put(&h_cg->css);\n}\n\nstatic inline void resv_map_dup_hugetlb_cgroup_uncharge_info(\n\t\t\t\t\t\tstruct resv_map *resv_map)\n{\n\tif (resv_map->css)\n\t\tcss_get(resv_map->css);\n}\n\nstatic inline void resv_map_put_hugetlb_cgroup_uncharge_info(\n\t\t\t\t\t\tstruct resv_map *resv_map)\n{\n\tif (resv_map->css)\n\t\tcss_put(resv_map->css);\n}\n\nextern int hugetlb_cgroup_charge_cgroup(int idx, unsigned long nr_pages,\n\t\t\t\t\tstruct hugetlb_cgroup **ptr);\nextern int hugetlb_cgroup_charge_cgroup_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t\t     struct hugetlb_cgroup **ptr);\nextern void hugetlb_cgroup_commit_charge(int idx, unsigned long nr_pages,\n\t\t\t\t\t struct hugetlb_cgroup *h_cg,\n\t\t\t\t\t struct folio *folio);\nextern void hugetlb_cgroup_commit_charge_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t\t      struct hugetlb_cgroup *h_cg,\n\t\t\t\t\t      struct folio *folio);\nextern void hugetlb_cgroup_uncharge_folio(int idx, unsigned long nr_pages,\n\t\t\t\t\t struct folio *folio);\nextern void hugetlb_cgroup_uncharge_folio_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t\t      struct folio *folio);\n\nextern void hugetlb_cgroup_uncharge_cgroup(int idx, unsigned long nr_pages,\n\t\t\t\t\t   struct hugetlb_cgroup *h_cg);\nextern void hugetlb_cgroup_uncharge_cgroup_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t\t\tstruct hugetlb_cgroup *h_cg);\nextern void hugetlb_cgroup_uncharge_counter(struct resv_map *resv,\n\t\t\t\t\t    unsigned long start,\n\t\t\t\t\t    unsigned long end);\n\nextern void hugetlb_cgroup_uncharge_file_region(struct resv_map *resv,\n\t\t\t\t\t\tstruct file_region *rg,\n\t\t\t\t\t\tunsigned long nr_pages,\n\t\t\t\t\t\tbool region_del);\n\nextern void hugetlb_cgroup_file_init(void) __init;\nextern void hugetlb_cgroup_migrate(struct folio *old_folio,\n\t\t\t\t   struct folio *new_folio);\n\n#else\nstatic inline void hugetlb_cgroup_uncharge_file_region(struct resv_map *resv,\n\t\t\t\t\t\t       struct file_region *rg,\n\t\t\t\t\t\t       unsigned long nr_pages,\n\t\t\t\t\t\t       bool region_del)\n{\n}\n\nstatic inline struct hugetlb_cgroup *hugetlb_cgroup_from_folio(struct folio *folio)\n{\n\treturn NULL;\n}\n\nstatic inline struct hugetlb_cgroup *\nhugetlb_cgroup_from_folio_rsvd(struct folio *folio)\n{\n\treturn NULL;\n}\n\nstatic inline void set_hugetlb_cgroup(struct folio *folio,\n\t\t\t\t     struct hugetlb_cgroup *h_cg)\n{\n}\n\nstatic inline void set_hugetlb_cgroup_rsvd(struct folio *folio,\n\t\t\t\t\t  struct hugetlb_cgroup *h_cg)\n{\n}\n\nstatic inline bool hugetlb_cgroup_disabled(void)\n{\n\treturn true;\n}\n\nstatic inline void hugetlb_cgroup_put_rsvd_cgroup(struct hugetlb_cgroup *h_cg)\n{\n}\n\nstatic inline void resv_map_dup_hugetlb_cgroup_uncharge_info(\n\t\t\t\t\t\tstruct resv_map *resv_map)\n{\n}\n\nstatic inline void resv_map_put_hugetlb_cgroup_uncharge_info(\n\t\t\t\t\t\tstruct resv_map *resv_map)\n{\n}\n\nstatic inline int hugetlb_cgroup_charge_cgroup(int idx, unsigned long nr_pages,\n\t\t\t\t\t       struct hugetlb_cgroup **ptr)\n{\n\treturn 0;\n}\n\nstatic inline int hugetlb_cgroup_charge_cgroup_rsvd(int idx,\n\t\t\t\t\t\t    unsigned long nr_pages,\n\t\t\t\t\t\t    struct hugetlb_cgroup **ptr)\n{\n\treturn 0;\n}\n\nstatic inline void hugetlb_cgroup_commit_charge(int idx, unsigned long nr_pages,\n\t\t\t\t\t\tstruct hugetlb_cgroup *h_cg,\n\t\t\t\t\t\tstruct folio *folio)\n{\n}\n\nstatic inline void\nhugetlb_cgroup_commit_charge_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t  struct hugetlb_cgroup *h_cg,\n\t\t\t\t  struct folio *folio)\n{\n}\n\nstatic inline void hugetlb_cgroup_uncharge_folio(int idx, unsigned long nr_pages,\n\t\t\t\t\t\tstruct folio *folio)\n{\n}\n\nstatic inline void hugetlb_cgroup_uncharge_folio_rsvd(int idx,\n\t\t\t\t\t\t     unsigned long nr_pages,\n\t\t\t\t\t\t     struct folio *folio)\n{\n}\nstatic inline void hugetlb_cgroup_uncharge_cgroup(int idx,\n\t\t\t\t\t\t  unsigned long nr_pages,\n\t\t\t\t\t\t  struct hugetlb_cgroup *h_cg)\n{\n}\n\nstatic inline void\nhugetlb_cgroup_uncharge_cgroup_rsvd(int idx, unsigned long nr_pages,\n\t\t\t\t    struct hugetlb_cgroup *h_cg)\n{\n}\n\nstatic inline void hugetlb_cgroup_uncharge_counter(struct resv_map *resv,\n\t\t\t\t\t\t   unsigned long start,\n\t\t\t\t\t\t   unsigned long end)\n{\n}\n\nstatic inline void hugetlb_cgroup_file_init(void)\n{\n}\n\nstatic inline void hugetlb_cgroup_migrate(struct folio *old_folio,\n\t\t\t\t\t  struct folio *new_folio)\n{\n}\n\n#endif   \n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}