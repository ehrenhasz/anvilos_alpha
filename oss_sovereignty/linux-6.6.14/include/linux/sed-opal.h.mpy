{
  "module_name": "sed-opal.h",
  "hash_id": "e9a7cbaaa7251e180ee10ed2eacb27dea75781746fb7990c61d74251b1eb7c86",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/sed-opal.h",
  "human_readable_source": " \n \n\n#ifndef LINUX_OPAL_H\n#define LINUX_OPAL_H\n\n#include <uapi/linux/sed-opal.h>\n#include <linux/compiler_types.h>\n#include <linux/types.h>\n\nstruct opal_dev;\n\ntypedef int (sec_send_recv)(void *data, u16 spsp, u8 secp, void *buffer,\n\t\tsize_t len, bool send);\n\n#ifdef CONFIG_BLK_SED_OPAL\nvoid free_opal_dev(struct opal_dev *dev);\nbool opal_unlock_from_suspend(struct opal_dev *dev);\nstruct opal_dev *init_opal_dev(void *data, sec_send_recv *send_recv);\nint sed_ioctl(struct opal_dev *dev, unsigned int cmd, void __user *ioctl_ptr);\n\n#define\tOPAL_AUTH_KEY           \"opal-boot-pin\"\n#define\tOPAL_AUTH_KEY_PREV      \"opal-boot-pin-prev\"\n\nstatic inline bool is_sed_ioctl(unsigned int cmd)\n{\n\tswitch (cmd) {\n\tcase IOC_OPAL_SAVE:\n\tcase IOC_OPAL_LOCK_UNLOCK:\n\tcase IOC_OPAL_TAKE_OWNERSHIP:\n\tcase IOC_OPAL_ACTIVATE_LSP:\n\tcase IOC_OPAL_SET_PW:\n\tcase IOC_OPAL_ACTIVATE_USR:\n\tcase IOC_OPAL_REVERT_TPR:\n\tcase IOC_OPAL_LR_SETUP:\n\tcase IOC_OPAL_ADD_USR_TO_LR:\n\tcase IOC_OPAL_ENABLE_DISABLE_MBR:\n\tcase IOC_OPAL_ERASE_LR:\n\tcase IOC_OPAL_SECURE_ERASE_LR:\n\tcase IOC_OPAL_PSID_REVERT_TPR:\n\tcase IOC_OPAL_MBR_DONE:\n\tcase IOC_OPAL_WRITE_SHADOW_MBR:\n\tcase IOC_OPAL_GENERIC_TABLE_RW:\n\tcase IOC_OPAL_GET_STATUS:\n\tcase IOC_OPAL_GET_LR_STATUS:\n\tcase IOC_OPAL_GET_GEOMETRY:\n\tcase IOC_OPAL_DISCOVERY:\n\tcase IOC_OPAL_REVERT_LSP:\n\t\treturn true;\n\t}\n\treturn false;\n}\n#else\nstatic inline void free_opal_dev(struct opal_dev *dev)\n{\n}\n\nstatic inline bool is_sed_ioctl(unsigned int cmd)\n{\n\treturn false;\n}\n\nstatic inline int sed_ioctl(struct opal_dev *dev, unsigned int cmd,\n\t\t\t    void __user *ioctl_ptr)\n{\n\treturn 0;\n}\nstatic inline bool opal_unlock_from_suspend(struct opal_dev *dev)\n{\n\treturn false;\n}\n#define init_opal_dev(data, send_recv)\t\tNULL\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}