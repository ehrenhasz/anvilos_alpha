{
  "module_name": "seccomp.h",
  "hash_id": "4fdd01b65a9e46d842db75c89647d52b8708417390d3bd442df50721687acffe",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/seccomp.h",
  "human_readable_source": " \n#ifndef _LINUX_SECCOMP_H\n#define _LINUX_SECCOMP_H\n\n#include <uapi/linux/seccomp.h>\n\n#define SECCOMP_FILTER_FLAG_MASK\t(SECCOMP_FILTER_FLAG_TSYNC | \\\n\t\t\t\t\t SECCOMP_FILTER_FLAG_LOG | \\\n\t\t\t\t\t SECCOMP_FILTER_FLAG_SPEC_ALLOW | \\\n\t\t\t\t\t SECCOMP_FILTER_FLAG_NEW_LISTENER | \\\n\t\t\t\t\t SECCOMP_FILTER_FLAG_TSYNC_ESRCH | \\\n\t\t\t\t\t SECCOMP_FILTER_FLAG_WAIT_KILLABLE_RECV)\n\n \n#define SECCOMP_NOTIFY_ADDFD_SIZE_VER0 24\n#define SECCOMP_NOTIFY_ADDFD_SIZE_LATEST SECCOMP_NOTIFY_ADDFD_SIZE_VER0\n\n#ifdef CONFIG_SECCOMP\n\n#include <linux/thread_info.h>\n#include <linux/atomic.h>\n#include <asm/seccomp.h>\n\nstruct seccomp_filter;\n \nstruct seccomp {\n\tint mode;\n\tatomic_t filter_count;\n\tstruct seccomp_filter *filter;\n};\n\n#ifdef CONFIG_HAVE_ARCH_SECCOMP_FILTER\nextern int __secure_computing(const struct seccomp_data *sd);\nstatic inline int secure_computing(void)\n{\n\tif (unlikely(test_syscall_work(SECCOMP)))\n\t\treturn  __secure_computing(NULL);\n\treturn 0;\n}\n#else\nextern void secure_computing_strict(int this_syscall);\n#endif\n\nextern long prctl_get_seccomp(void);\nextern long prctl_set_seccomp(unsigned long, void __user *);\n\nstatic inline int seccomp_mode(struct seccomp *s)\n{\n\treturn s->mode;\n}\n\n#else  \n\n#include <linux/errno.h>\n\nstruct seccomp { };\nstruct seccomp_filter { };\nstruct seccomp_data;\n\n#ifdef CONFIG_HAVE_ARCH_SECCOMP_FILTER\nstatic inline int secure_computing(void) { return 0; }\nstatic inline int __secure_computing(const struct seccomp_data *sd) { return 0; }\n#else\nstatic inline void secure_computing_strict(int this_syscall) { return; }\n#endif\n\nstatic inline long prctl_get_seccomp(void)\n{\n\treturn -EINVAL;\n}\n\nstatic inline long prctl_set_seccomp(unsigned long arg2, char __user *arg3)\n{\n\treturn -EINVAL;\n}\n\nstatic inline int seccomp_mode(struct seccomp *s)\n{\n\treturn SECCOMP_MODE_DISABLED;\n}\n#endif  \n\n#ifdef CONFIG_SECCOMP_FILTER\nextern void seccomp_filter_release(struct task_struct *tsk);\nextern void get_seccomp_filter(struct task_struct *tsk);\n#else   \nstatic inline void seccomp_filter_release(struct task_struct *tsk)\n{\n\treturn;\n}\nstatic inline void get_seccomp_filter(struct task_struct *tsk)\n{\n\treturn;\n}\n#endif  \n\n#if defined(CONFIG_SECCOMP_FILTER) && defined(CONFIG_CHECKPOINT_RESTORE)\nextern long seccomp_get_filter(struct task_struct *task,\n\t\t\t       unsigned long filter_off, void __user *data);\nextern long seccomp_get_metadata(struct task_struct *task,\n\t\t\t\t unsigned long filter_off, void __user *data);\n#else\nstatic inline long seccomp_get_filter(struct task_struct *task,\n\t\t\t\t      unsigned long n, void __user *data)\n{\n\treturn -EINVAL;\n}\nstatic inline long seccomp_get_metadata(struct task_struct *task,\n\t\t\t\t\tunsigned long filter_off,\n\t\t\t\t\tvoid __user *data)\n{\n\treturn -EINVAL;\n}\n#endif  \n\n#ifdef CONFIG_SECCOMP_CACHE_DEBUG\nstruct seq_file;\n\nint proc_pid_seccomp_cache(struct seq_file *m, struct pid_namespace *ns,\n\t\t\t   struct pid *pid, struct task_struct *task);\n#endif\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}