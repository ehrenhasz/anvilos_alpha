{
  "module_name": "evm.h",
  "hash_id": "641be50840e62f64adfa84ba036defb6cd132514fb1574e973331d4e93b474a1",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/evm.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_EVM_H\n#define _LINUX_EVM_H\n\n#include <linux/integrity.h>\n#include <linux/xattr.h>\n\nstruct integrity_iint_cache;\n\n#ifdef CONFIG_EVM\nextern int evm_set_key(void *key, size_t keylen);\nextern enum integrity_status evm_verifyxattr(struct dentry *dentry,\n\t\t\t\t\t     const char *xattr_name,\n\t\t\t\t\t     void *xattr_value,\n\t\t\t\t\t     size_t xattr_value_len,\n\t\t\t\t\t     struct integrity_iint_cache *iint);\nextern int evm_inode_setattr(struct mnt_idmap *idmap,\n\t\t\t     struct dentry *dentry, struct iattr *attr);\nextern void evm_inode_post_setattr(struct dentry *dentry, int ia_valid);\nextern int evm_inode_setxattr(struct mnt_idmap *idmap,\n\t\t\t      struct dentry *dentry, const char *name,\n\t\t\t      const void *value, size_t size);\nextern void evm_inode_post_setxattr(struct dentry *dentry,\n\t\t\t\t    const char *xattr_name,\n\t\t\t\t    const void *xattr_value,\n\t\t\t\t    size_t xattr_value_len);\nextern int evm_inode_removexattr(struct mnt_idmap *idmap,\n\t\t\t\t struct dentry *dentry, const char *xattr_name);\nextern void evm_inode_post_removexattr(struct dentry *dentry,\n\t\t\t\t       const char *xattr_name);\nstatic inline void evm_inode_post_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t\t     struct dentry *dentry,\n\t\t\t\t\t     const char *acl_name)\n{\n\tevm_inode_post_removexattr(dentry, acl_name);\n}\nextern int evm_inode_set_acl(struct mnt_idmap *idmap,\n\t\t\t     struct dentry *dentry, const char *acl_name,\n\t\t\t     struct posix_acl *kacl);\nstatic inline int evm_inode_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t       struct dentry *dentry,\n\t\t\t\t       const char *acl_name)\n{\n\treturn evm_inode_set_acl(idmap, dentry, acl_name, NULL);\n}\nstatic inline void evm_inode_post_set_acl(struct dentry *dentry,\n\t\t\t\t\t  const char *acl_name,\n\t\t\t\t\t  struct posix_acl *kacl)\n{\n\treturn evm_inode_post_setxattr(dentry, acl_name, NULL, 0);\n}\n\nint evm_inode_init_security(struct inode *inode, struct inode *dir,\n\t\t\t    const struct qstr *qstr, struct xattr *xattrs,\n\t\t\t    int *xattr_count);\nextern bool evm_revalidate_status(const char *xattr_name);\nextern int evm_protected_xattr_if_enabled(const char *req_xattr_name);\nextern int evm_read_protected_xattrs(struct dentry *dentry, u8 *buffer,\n\t\t\t\t     int buffer_size, char type,\n\t\t\t\t     bool canonical_fmt);\n#ifdef CONFIG_FS_POSIX_ACL\nextern int posix_xattr_acl(const char *xattrname);\n#else\nstatic inline int posix_xattr_acl(const char *xattrname)\n{\n\treturn 0;\n}\n#endif\n#else\n\nstatic inline int evm_set_key(void *key, size_t keylen)\n{\n\treturn -EOPNOTSUPP;\n}\n\n#ifdef CONFIG_INTEGRITY\nstatic inline enum integrity_status evm_verifyxattr(struct dentry *dentry,\n\t\t\t\t\t\t    const char *xattr_name,\n\t\t\t\t\t\t    void *xattr_value,\n\t\t\t\t\t\t    size_t xattr_value_len,\n\t\t\t\t\tstruct integrity_iint_cache *iint)\n{\n\treturn INTEGRITY_UNKNOWN;\n}\n#endif\n\nstatic inline int evm_inode_setattr(struct mnt_idmap *idmap,\n\t\t\t\t    struct dentry *dentry, struct iattr *attr)\n{\n\treturn 0;\n}\n\nstatic inline void evm_inode_post_setattr(struct dentry *dentry, int ia_valid)\n{\n\treturn;\n}\n\nstatic inline int evm_inode_setxattr(struct mnt_idmap *idmap,\n\t\t\t\t     struct dentry *dentry, const char *name,\n\t\t\t\t     const void *value, size_t size)\n{\n\treturn 0;\n}\n\nstatic inline void evm_inode_post_setxattr(struct dentry *dentry,\n\t\t\t\t\t   const char *xattr_name,\n\t\t\t\t\t   const void *xattr_value,\n\t\t\t\t\t   size_t xattr_value_len)\n{\n\treturn;\n}\n\nstatic inline int evm_inode_removexattr(struct mnt_idmap *idmap,\n\t\t\t\t\tstruct dentry *dentry,\n\t\t\t\t\tconst char *xattr_name)\n{\n\treturn 0;\n}\n\nstatic inline void evm_inode_post_removexattr(struct dentry *dentry,\n\t\t\t\t\t      const char *xattr_name)\n{\n\treturn;\n}\n\nstatic inline void evm_inode_post_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t\t     struct dentry *dentry,\n\t\t\t\t\t     const char *acl_name)\n{\n\treturn;\n}\n\nstatic inline int evm_inode_set_acl(struct mnt_idmap *idmap,\n\t\t\t\t    struct dentry *dentry, const char *acl_name,\n\t\t\t\t    struct posix_acl *kacl)\n{\n\treturn 0;\n}\n\nstatic inline int evm_inode_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t       struct dentry *dentry,\n\t\t\t\t       const char *acl_name)\n{\n\treturn 0;\n}\n\nstatic inline void evm_inode_post_set_acl(struct dentry *dentry,\n\t\t\t\t\t  const char *acl_name,\n\t\t\t\t\t  struct posix_acl *kacl)\n{\n\treturn;\n}\n\nstatic inline int evm_inode_init_security(struct inode *inode, struct inode *dir,\n\t\t\t\t\t  const struct qstr *qstr,\n\t\t\t\t\t  struct xattr *xattrs,\n\t\t\t\t\t  int *xattr_count)\n{\n\treturn 0;\n}\n\nstatic inline bool evm_revalidate_status(const char *xattr_name)\n{\n\treturn false;\n}\n\nstatic inline int evm_protected_xattr_if_enabled(const char *req_xattr_name)\n{\n\treturn false;\n}\n\nstatic inline int evm_read_protected_xattrs(struct dentry *dentry, u8 *buffer,\n\t\t\t\t\t    int buffer_size, char type,\n\t\t\t\t\t    bool canonical_fmt)\n{\n\treturn -EOPNOTSUPP;\n}\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}