{
  "module_name": "ipc_namespace.h",
  "hash_id": "333f7e4ab314fa333f30c37bc355220d461db41a549234c2395f62dcce9efcae",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ipc_namespace.h",
  "human_readable_source": " \n#ifndef __IPC_NAMESPACE_H__\n#define __IPC_NAMESPACE_H__\n\n#include <linux/err.h>\n#include <linux/idr.h>\n#include <linux/rwsem.h>\n#include <linux/notifier.h>\n#include <linux/nsproxy.h>\n#include <linux/ns_common.h>\n#include <linux/refcount.h>\n#include <linux/rhashtable-types.h>\n#include <linux/sysctl.h>\n#include <linux/percpu_counter.h>\n\nstruct user_namespace;\n\nstruct ipc_ids {\n\tint in_use;\n\tunsigned short seq;\n\tstruct rw_semaphore rwsem;\n\tstruct idr ipcs_idr;\n\tint max_idx;\n\tint last_idx;\t \n#ifdef CONFIG_CHECKPOINT_RESTORE\n\tint next_id;\n#endif\n\tstruct rhashtable key_ht;\n};\n\nstruct ipc_namespace {\n\tstruct ipc_ids\tids[3];\n\n\tint\t\tsem_ctls[4];\n\tint\t\tused_sems;\n\n\tunsigned int\tmsg_ctlmax;\n\tunsigned int\tmsg_ctlmnb;\n\tunsigned int\tmsg_ctlmni;\n\tstruct percpu_counter percpu_msg_bytes;\n\tstruct percpu_counter percpu_msg_hdrs;\n\n\tsize_t\t\tshm_ctlmax;\n\tsize_t\t\tshm_ctlall;\n\tunsigned long\tshm_tot;\n\tint\t\tshm_ctlmni;\n\t \n\tint\t\tshm_rmid_forced;\n\n\tstruct notifier_block ipcns_nb;\n\n\t \n\tstruct vfsmount\t*mq_mnt;\n\n\t \n\tunsigned int    mq_queues_count;\n\n\t \n\tunsigned int    mq_queues_max;    \n\tunsigned int    mq_msg_max;       \n\tunsigned int    mq_msgsize_max;   \n\tunsigned int    mq_msg_default;\n\tunsigned int    mq_msgsize_default;\n\n\tstruct ctl_table_set\tmq_set;\n\tstruct ctl_table_header\t*mq_sysctls;\n\n\tstruct ctl_table_set\tipc_set;\n\tstruct ctl_table_header\t*ipc_sysctls;\n\n\t \n\tstruct user_namespace *user_ns;\n\tstruct ucounts *ucounts;\n\n\tstruct llist_node mnt_llist;\n\n\tstruct ns_common ns;\n} __randomize_layout;\n\nextern struct ipc_namespace init_ipc_ns;\nextern spinlock_t mq_lock;\n\n#ifdef CONFIG_SYSVIPC\nextern void shm_destroy_orphaned(struct ipc_namespace *ns);\n#else  \nstatic inline void shm_destroy_orphaned(struct ipc_namespace *ns) {}\n#endif  \n\n#ifdef CONFIG_POSIX_MQUEUE\nextern int mq_init_ns(struct ipc_namespace *ns);\n \n#define DFLT_QUEUESMAX\t\t      256\n#define MIN_MSGMAX\t\t\t1\n#define DFLT_MSG\t\t       10U\n#define DFLT_MSGMAX\t\t       10\n#define HARD_MSGMAX\t\t    65536\n#define MIN_MSGSIZEMAX\t\t      128\n#define DFLT_MSGSIZE\t\t     8192U\n#define DFLT_MSGSIZEMAX\t\t     8192\n#define HARD_MSGSIZEMAX\t    (16*1024*1024)\n#else\nstatic inline int mq_init_ns(struct ipc_namespace *ns) { return 0; }\n#endif\n\n#if defined(CONFIG_IPC_NS)\nextern struct ipc_namespace *copy_ipcs(unsigned long flags,\n\tstruct user_namespace *user_ns, struct ipc_namespace *ns);\n\nstatic inline struct ipc_namespace *get_ipc_ns(struct ipc_namespace *ns)\n{\n\tif (ns)\n\t\trefcount_inc(&ns->ns.count);\n\treturn ns;\n}\n\nstatic inline struct ipc_namespace *get_ipc_ns_not_zero(struct ipc_namespace *ns)\n{\n\tif (ns) {\n\t\tif (refcount_inc_not_zero(&ns->ns.count))\n\t\t\treturn ns;\n\t}\n\n\treturn NULL;\n}\n\nextern void put_ipc_ns(struct ipc_namespace *ns);\n#else\nstatic inline struct ipc_namespace *copy_ipcs(unsigned long flags,\n\tstruct user_namespace *user_ns, struct ipc_namespace *ns)\n{\n\tif (flags & CLONE_NEWIPC)\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn ns;\n}\n\nstatic inline struct ipc_namespace *get_ipc_ns(struct ipc_namespace *ns)\n{\n\treturn ns;\n}\n\nstatic inline struct ipc_namespace *get_ipc_ns_not_zero(struct ipc_namespace *ns)\n{\n\treturn ns;\n}\n\nstatic inline void put_ipc_ns(struct ipc_namespace *ns)\n{\n}\n#endif\n\n#ifdef CONFIG_POSIX_MQUEUE_SYSCTL\n\nvoid retire_mq_sysctls(struct ipc_namespace *ns);\nbool setup_mq_sysctls(struct ipc_namespace *ns);\n\n#else  \n\nstatic inline void retire_mq_sysctls(struct ipc_namespace *ns)\n{\n}\n\nstatic inline bool setup_mq_sysctls(struct ipc_namespace *ns)\n{\n\treturn true;\n}\n\n#endif  \n\n#ifdef CONFIG_SYSVIPC_SYSCTL\n\nbool setup_ipc_sysctls(struct ipc_namespace *ns);\nvoid retire_ipc_sysctls(struct ipc_namespace *ns);\n\n#else  \n\nstatic inline void retire_ipc_sysctls(struct ipc_namespace *ns)\n{\n}\n\nstatic inline bool setup_ipc_sysctls(struct ipc_namespace *ns)\n{\n\treturn true;\n}\n\n#endif  \n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}