{
  "module_name": "xattr.h",
  "hash_id": "7aebcb303be09ab12951f46645adb5c1d44d54bc9386292195fc07a8cdf79efb",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/xattr.h",
  "human_readable_source": " \n \n#ifndef _LINUX_XATTR_H\n#define _LINUX_XATTR_H\n\n\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/user_namespace.h>\n#include <uapi/linux/xattr.h>\n\nstruct inode;\nstruct dentry;\n\nstatic inline bool is_posix_acl_xattr(const char *name)\n{\n\treturn (strcmp(name, XATTR_NAME_POSIX_ACL_ACCESS) == 0) ||\n\t       (strcmp(name, XATTR_NAME_POSIX_ACL_DEFAULT) == 0);\n}\n\n \nstruct xattr_handler {\n\tconst char *name;\n\tconst char *prefix;\n\tint flags;       \n\tbool (*list)(struct dentry *dentry);\n\tint (*get)(const struct xattr_handler *, struct dentry *dentry,\n\t\t   struct inode *inode, const char *name, void *buffer,\n\t\t   size_t size);\n\tint (*set)(const struct xattr_handler *,\n\t\t   struct mnt_idmap *idmap, struct dentry *dentry,\n\t\t   struct inode *inode, const char *name, const void *buffer,\n\t\t   size_t size, int flags);\n};\n\n \nstatic inline bool xattr_handler_can_list(const struct xattr_handler *handler,\n\t\t\t\t\t  struct dentry *dentry)\n{\n\treturn handler && (!handler->list || handler->list(dentry));\n}\n\nconst char *xattr_full_name(const struct xattr_handler *, const char *);\n\nstruct xattr {\n\tconst char *name;\n\tvoid *value;\n\tsize_t value_len;\n};\n\nssize_t __vfs_getxattr(struct dentry *, struct inode *, const char *, void *, size_t);\nssize_t vfs_getxattr(struct mnt_idmap *, struct dentry *, const char *,\n\t\t     void *, size_t);\nssize_t vfs_listxattr(struct dentry *d, char *list, size_t size);\nint __vfs_setxattr(struct mnt_idmap *, struct dentry *, struct inode *,\n\t\t   const char *, const void *, size_t, int);\nint __vfs_setxattr_noperm(struct mnt_idmap *, struct dentry *,\n\t\t\t  const char *, const void *, size_t, int);\nint __vfs_setxattr_locked(struct mnt_idmap *, struct dentry *,\n\t\t\t  const char *, const void *, size_t, int,\n\t\t\t  struct inode **);\nint vfs_setxattr(struct mnt_idmap *, struct dentry *, const char *,\n\t\t const void *, size_t, int);\nint __vfs_removexattr(struct mnt_idmap *, struct dentry *, const char *);\nint __vfs_removexattr_locked(struct mnt_idmap *, struct dentry *,\n\t\t\t     const char *, struct inode **);\nint vfs_removexattr(struct mnt_idmap *, struct dentry *, const char *);\n\nssize_t generic_listxattr(struct dentry *dentry, char *buffer, size_t buffer_size);\nint vfs_getxattr_alloc(struct mnt_idmap *idmap,\n\t\t       struct dentry *dentry, const char *name,\n\t\t       char **xattr_value, size_t size, gfp_t flags);\n\nint xattr_supports_user_prefix(struct inode *inode);\n\nstatic inline const char *xattr_prefix(const struct xattr_handler *handler)\n{\n\treturn handler->prefix ?: handler->name;\n}\n\nstruct simple_xattrs {\n\tstruct rb_root rb_root;\n\trwlock_t lock;\n};\n\nstruct simple_xattr {\n\tstruct rb_node rb_node;\n\tchar *name;\n\tsize_t size;\n\tchar value[];\n};\n\nvoid simple_xattrs_init(struct simple_xattrs *xattrs);\nvoid simple_xattrs_free(struct simple_xattrs *xattrs, size_t *freed_space);\nsize_t simple_xattr_space(const char *name, size_t size);\nstruct simple_xattr *simple_xattr_alloc(const void *value, size_t size);\nvoid simple_xattr_free(struct simple_xattr *xattr);\nint simple_xattr_get(struct simple_xattrs *xattrs, const char *name,\n\t\t     void *buffer, size_t size);\nstruct simple_xattr *simple_xattr_set(struct simple_xattrs *xattrs,\n\t\t\t\t      const char *name, const void *value,\n\t\t\t\t      size_t size, int flags);\nssize_t simple_xattr_list(struct inode *inode, struct simple_xattrs *xattrs,\n\t\t\t  char *buffer, size_t size);\nvoid simple_xattr_add(struct simple_xattrs *xattrs,\n\t\t      struct simple_xattr *new_xattr);\nint xattr_list_one(char **buffer, ssize_t *remaining_size, const char *name);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}