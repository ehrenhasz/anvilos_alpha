{
  "module_name": "pci-epc.h",
  "hash_id": "d41911e63f1922439f7d5bc88fd85d9b3aa301930076439d933efeeb49a6bf8b",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/pci-epc.h",
  "human_readable_source": " \n \n\n#ifndef __LINUX_PCI_EPC_H\n#define __LINUX_PCI_EPC_H\n\n#include <linux/pci-epf.h>\n\nstruct pci_epc;\n\nenum pci_epc_interface_type {\n\tUNKNOWN_INTERFACE = -1,\n\tPRIMARY_INTERFACE,\n\tSECONDARY_INTERFACE,\n};\n\nenum pci_epc_irq_type {\n\tPCI_EPC_IRQ_UNKNOWN,\n\tPCI_EPC_IRQ_LEGACY,\n\tPCI_EPC_IRQ_MSI,\n\tPCI_EPC_IRQ_MSIX,\n};\n\nstatic inline const char *\npci_epc_interface_string(enum pci_epc_interface_type type)\n{\n\tswitch (type) {\n\tcase PRIMARY_INTERFACE:\n\t\treturn \"primary\";\n\tcase SECONDARY_INTERFACE:\n\t\treturn \"secondary\";\n\tdefault:\n\t\treturn \"UNKNOWN interface\";\n\t}\n}\n\n \nstruct pci_epc_ops {\n\tint\t(*write_header)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t\tstruct pci_epf_header *hdr);\n\tint\t(*set_bar)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t   struct pci_epf_bar *epf_bar);\n\tvoid\t(*clear_bar)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t     struct pci_epf_bar *epf_bar);\n\tint\t(*map_addr)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t    phys_addr_t addr, u64 pci_addr, size_t size);\n\tvoid\t(*unmap_addr)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t      phys_addr_t addr);\n\tint\t(*set_msi)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t   u8 interrupts);\n\tint\t(*get_msi)(struct pci_epc *epc, u8 func_no, u8 vfunc_no);\n\tint\t(*set_msix)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t    u16 interrupts, enum pci_barno, u32 offset);\n\tint\t(*get_msix)(struct pci_epc *epc, u8 func_no, u8 vfunc_no);\n\tint\t(*raise_irq)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t     enum pci_epc_irq_type type, u16 interrupt_num);\n\tint\t(*map_msi_irq)(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t       phys_addr_t phys_addr, u8 interrupt_num,\n\t\t\t       u32 entry_size, u32 *msi_data,\n\t\t\t       u32 *msi_addr_offset);\n\tint\t(*start)(struct pci_epc *epc);\n\tvoid\t(*stop)(struct pci_epc *epc);\n\tconst struct pci_epc_features* (*get_features)(struct pci_epc *epc,\n\t\t\t\t\t\t       u8 func_no, u8 vfunc_no);\n\tstruct module *owner;\n};\n\n \nstruct pci_epc_mem_window {\n\tphys_addr_t\tphys_base;\n\tsize_t\t\tsize;\n\tsize_t\t\tpage_size;\n};\n\n \nstruct pci_epc_mem {\n\tstruct pci_epc_mem_window window;\n\tunsigned long\t*bitmap;\n\tint\t\tpages;\n\t \n\tstruct mutex\tlock;\n};\n\n \nstruct pci_epc {\n\tstruct device\t\t\tdev;\n\tstruct list_head\t\tpci_epf;\n\tstruct mutex\t\t\tlist_lock;\n\tconst struct pci_epc_ops\t*ops;\n\tstruct pci_epc_mem\t\t**windows;\n\tstruct pci_epc_mem\t\t*mem;\n\tunsigned int\t\t\tnum_windows;\n\tu8\t\t\t\tmax_functions;\n\tu8\t\t\t\t*max_vfs;\n\tstruct config_group\t\t*group;\n\t \n\tstruct mutex\t\t\tlock;\n\tunsigned long\t\t\tfunction_num_map;\n};\n\n \nstruct pci_epc_features {\n\tunsigned int\tlinkup_notifier : 1;\n\tunsigned int\tcore_init_notifier : 1;\n\tunsigned int\tmsi_capable : 1;\n\tunsigned int\tmsix_capable : 1;\n\tu8\treserved_bar;\n\tu8\tbar_fixed_64bit;\n\tu64\tbar_fixed_size[PCI_STD_NUM_BARS];\n\tsize_t\talign;\n};\n\n#define to_pci_epc(device) container_of((device), struct pci_epc, dev)\n\n#define pci_epc_create(dev, ops)    \\\n\t\t__pci_epc_create((dev), (ops), THIS_MODULE)\n#define devm_pci_epc_create(dev, ops)    \\\n\t\t__devm_pci_epc_create((dev), (ops), THIS_MODULE)\n\nstatic inline void epc_set_drvdata(struct pci_epc *epc, void *data)\n{\n\tdev_set_drvdata(&epc->dev, data);\n}\n\nstatic inline void *epc_get_drvdata(struct pci_epc *epc)\n{\n\treturn dev_get_drvdata(&epc->dev);\n}\n\nstruct pci_epc *\n__devm_pci_epc_create(struct device *dev, const struct pci_epc_ops *ops,\n\t\t      struct module *owner);\nstruct pci_epc *\n__pci_epc_create(struct device *dev, const struct pci_epc_ops *ops,\n\t\t struct module *owner);\nvoid devm_pci_epc_destroy(struct device *dev, struct pci_epc *epc);\nvoid pci_epc_destroy(struct pci_epc *epc);\nint pci_epc_add_epf(struct pci_epc *epc, struct pci_epf *epf,\n\t\t    enum pci_epc_interface_type type);\nvoid pci_epc_linkup(struct pci_epc *epc);\nvoid pci_epc_linkdown(struct pci_epc *epc);\nvoid pci_epc_init_notify(struct pci_epc *epc);\nvoid pci_epc_bme_notify(struct pci_epc *epc);\nvoid pci_epc_remove_epf(struct pci_epc *epc, struct pci_epf *epf,\n\t\t\tenum pci_epc_interface_type type);\nint pci_epc_write_header(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\t struct pci_epf_header *hdr);\nint pci_epc_set_bar(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t    struct pci_epf_bar *epf_bar);\nvoid pci_epc_clear_bar(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t       struct pci_epf_bar *epf_bar);\nint pci_epc_map_addr(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t     phys_addr_t phys_addr,\n\t\t     u64 pci_addr, size_t size);\nvoid pci_epc_unmap_addr(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\tphys_addr_t phys_addr);\nint pci_epc_set_msi(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t    u8 interrupts);\nint pci_epc_get_msi(struct pci_epc *epc, u8 func_no, u8 vfunc_no);\nint pci_epc_set_msix(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t     u16 interrupts, enum pci_barno, u32 offset);\nint pci_epc_get_msix(struct pci_epc *epc, u8 func_no, u8 vfunc_no);\nint pci_epc_map_msi_irq(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t\tphys_addr_t phys_addr, u8 interrupt_num,\n\t\t\tu32 entry_size, u32 *msi_data, u32 *msi_addr_offset);\nint pci_epc_raise_irq(struct pci_epc *epc, u8 func_no, u8 vfunc_no,\n\t\t      enum pci_epc_irq_type type, u16 interrupt_num);\nint pci_epc_start(struct pci_epc *epc);\nvoid pci_epc_stop(struct pci_epc *epc);\nconst struct pci_epc_features *pci_epc_get_features(struct pci_epc *epc,\n\t\t\t\t\t\t    u8 func_no, u8 vfunc_no);\nenum pci_barno\npci_epc_get_first_free_bar(const struct pci_epc_features *epc_features);\nenum pci_barno pci_epc_get_next_free_bar(const struct pci_epc_features\n\t\t\t\t\t *epc_features, enum pci_barno bar);\nstruct pci_epc *pci_epc_get(const char *epc_name);\nvoid pci_epc_put(struct pci_epc *epc);\n\nint pci_epc_mem_init(struct pci_epc *epc, phys_addr_t base,\n\t\t     size_t size, size_t page_size);\nint pci_epc_multi_mem_init(struct pci_epc *epc,\n\t\t\t   struct pci_epc_mem_window *window,\n\t\t\t   unsigned int num_windows);\nvoid pci_epc_mem_exit(struct pci_epc *epc);\nvoid __iomem *pci_epc_mem_alloc_addr(struct pci_epc *epc,\n\t\t\t\t     phys_addr_t *phys_addr, size_t size);\nvoid pci_epc_mem_free_addr(struct pci_epc *epc, phys_addr_t phys_addr,\n\t\t\t   void __iomem *virt_addr, size_t size);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}