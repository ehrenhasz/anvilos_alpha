{
  "module_name": "nd.h",
  "hash_id": "78ed1a26c4cb9afa6084007ad88c3ab967206c1f9c5b37588040efce769868eb",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/nd.h",
  "human_readable_source": " \n \n#ifndef __LINUX_ND_H__\n#define __LINUX_ND_H__\n#include <linux/fs.h>\n#include <linux/ndctl.h>\n#include <linux/device.h>\n#include <linux/badblocks.h>\n#include <linux/perf_event.h>\n\nenum nvdimm_event {\n\tNVDIMM_REVALIDATE_POISON,\n\tNVDIMM_REVALIDATE_REGION,\n};\n\nenum nvdimm_claim_class {\n\tNVDIMM_CCLASS_NONE,\n\tNVDIMM_CCLASS_BTT,\n\tNVDIMM_CCLASS_BTT2,\n\tNVDIMM_CCLASS_PFN,\n\tNVDIMM_CCLASS_DAX,\n\tNVDIMM_CCLASS_UNKNOWN,\n};\n\n#define NVDIMM_EVENT_VAR(_id)  event_attr_##_id\n#define NVDIMM_EVENT_PTR(_id)  (&event_attr_##_id.attr.attr)\n\n#define NVDIMM_EVENT_ATTR(_name, _id)\t\t\t\t\\\n\tPMU_EVENT_ATTR(_name, NVDIMM_EVENT_VAR(_id), _id,\t\\\n\t\t\tnvdimm_events_sysfs_show)\n\n \n#define NVDIMM_PMU_FORMAT_ATTR\t0\n#define NVDIMM_PMU_EVENT_ATTR\t1\n#define NVDIMM_PMU_CPUMASK_ATTR\t2\n#define NVDIMM_PMU_NULL_ATTR\t3\n\n \nstruct nvdimm_pmu {\n\tstruct pmu pmu;\n\tstruct device *dev;\n\tint cpu;\n\tstruct hlist_node node;\n\tenum cpuhp_state cpuhp_state;\n\t \n\tstruct cpumask arch_cpumask;\n};\n\nstruct platform_device;\n\n#ifdef CONFIG_PERF_EVENTS\nextern ssize_t nvdimm_events_sysfs_show(struct device *dev,\n\t\t\t\t\tstruct device_attribute *attr,\n\t\t\t\t\tchar *page);\n\nint register_nvdimm_pmu(struct nvdimm_pmu *nvdimm, struct platform_device *pdev);\nvoid unregister_nvdimm_pmu(struct nvdimm_pmu *nd_pmu);\n\n#else\nstatic inline int register_nvdimm_pmu(struct nvdimm_pmu *nvdimm, struct platform_device *pdev)\n{\n\treturn -ENXIO;\n}\n\nstatic inline void unregister_nvdimm_pmu(struct nvdimm_pmu *nd_pmu) { }\n#endif\n\nstruct nd_device_driver {\n\tstruct device_driver drv;\n\tunsigned long type;\n\tint (*probe)(struct device *dev);\n\tvoid (*remove)(struct device *dev);\n\tvoid (*shutdown)(struct device *dev);\n\tvoid (*notify)(struct device *dev, enum nvdimm_event event);\n};\n\nstatic inline struct nd_device_driver *to_nd_device_driver(\n\t\tstruct device_driver *drv)\n{\n\treturn container_of(drv, struct nd_device_driver, drv);\n};\n\n \nstruct nd_namespace_common {\n\tint force_raw;\n\tstruct device dev;\n\tstruct device *claim;\n\tenum nvdimm_claim_class claim_class;\n\tint (*rw_bytes)(struct nd_namespace_common *, resource_size_t offset,\n\t\t\tvoid *buf, size_t size, int rw, unsigned long flags);\n};\n\nstatic inline struct nd_namespace_common *to_ndns(struct device *dev)\n{\n\treturn container_of(dev, struct nd_namespace_common, dev);\n}\n\n \nstruct nd_namespace_io {\n\tstruct nd_namespace_common common;\n\tstruct resource res;\n\tresource_size_t size;\n\tvoid *addr;\n\tstruct badblocks bb;\n};\n\n \nstruct nd_namespace_pmem {\n\tstruct nd_namespace_io nsio;\n\tunsigned long lbasize;\n\tchar *alt_name;\n\tuuid_t *uuid;\n\tint id;\n};\n\nstatic inline struct nd_namespace_io *to_nd_namespace_io(const struct device *dev)\n{\n\treturn container_of(dev, struct nd_namespace_io, common.dev);\n}\n\nstatic inline struct nd_namespace_pmem *to_nd_namespace_pmem(const struct device *dev)\n{\n\tstruct nd_namespace_io *nsio = to_nd_namespace_io(dev);\n\n\treturn container_of(nsio, struct nd_namespace_pmem, nsio);\n}\n\n \nstatic inline int nvdimm_read_bytes(struct nd_namespace_common *ndns,\n\t\tresource_size_t offset, void *buf, size_t size,\n\t\tunsigned long flags)\n{\n\treturn ndns->rw_bytes(ndns, offset, buf, size, READ, flags);\n}\n\n \nstatic inline int nvdimm_write_bytes(struct nd_namespace_common *ndns,\n\t\tresource_size_t offset, void *buf, size_t size,\n\t\tunsigned long flags)\n{\n\treturn ndns->rw_bytes(ndns, offset, buf, size, WRITE, flags);\n}\n\n#define MODULE_ALIAS_ND_DEVICE(type) \\\n\tMODULE_ALIAS(\"nd:t\" __stringify(type) \"*\")\n#define ND_DEVICE_MODALIAS_FMT \"nd:t%d\"\n\nstruct nd_region;\nvoid nvdimm_region_notify(struct nd_region *nd_region, enum nvdimm_event event);\nint __must_check __nd_driver_register(struct nd_device_driver *nd_drv,\n\t\tstruct module *module, const char *mod_name);\nstatic inline void nd_driver_unregister(struct nd_device_driver *drv)\n{\n\tdriver_unregister(&drv->drv);\n}\n#define nd_driver_register(driver) \\\n\t__nd_driver_register(driver, THIS_MODULE, KBUILD_MODNAME)\n#define module_nd_driver(driver) \\\n\tmodule_driver(driver, nd_driver_register, nd_driver_unregister)\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}