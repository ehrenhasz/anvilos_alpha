{
  "module_name": "if_tap.h",
  "hash_id": "5e42aed01475b06db37b53e2a44342343a373ee0a2bb9dbd2d90730b31abc5dc",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/if_tap.h",
  "human_readable_source": " \n#ifndef _LINUX_IF_TAP_H_\n#define _LINUX_IF_TAP_H_\n\n#include <net/sock.h>\n#include <linux/skb_array.h>\n\nstruct file;\nstruct socket;\n\n#if IS_ENABLED(CONFIG_TAP)\nstruct socket *tap_get_socket(struct file *);\nstruct ptr_ring *tap_get_ptr_ring(struct file *file);\n#else\n#include <linux/err.h>\n#include <linux/errno.h>\nstatic inline struct socket *tap_get_socket(struct file *f)\n{\n\treturn ERR_PTR(-EINVAL);\n}\nstatic inline struct ptr_ring *tap_get_ptr_ring(struct file *f)\n{\n\treturn ERR_PTR(-EINVAL);\n}\n#endif  \n\n \n#define MAX_TAP_QUEUES 256\n\nstruct tap_queue;\n\nstruct tap_dev {\n\tstruct net_device\t*dev;\n\tu16\t\t\tflags;\n\t \n\tstruct tap_queue    __rcu *taps[MAX_TAP_QUEUES];\n\t \n\tstruct list_head\tqueue_list;\n\tint\t\t\tnumvtaps;\n\tint\t\t\tnumqueues;\n\tnetdev_features_t\ttap_features;\n\tint\t\t\tminor;\n\n\tvoid (*update_features)(struct tap_dev *tap, netdev_features_t features);\n\tvoid (*count_tx_dropped)(struct tap_dev *tap);\n\tvoid (*count_rx_dropped)(struct tap_dev *tap);\n};\n\n \n\nstruct tap_queue {\n\tstruct sock sk;\n\tstruct socket sock;\n\tint vnet_hdr_sz;\n\tstruct tap_dev __rcu *tap;\n\tstruct file *file;\n\tunsigned int flags;\n\tu16 queue_index;\n\tbool enabled;\n\tstruct list_head next;\n\tstruct ptr_ring ring;\n};\n\nrx_handler_result_t tap_handle_frame(struct sk_buff **pskb);\nvoid tap_del_queues(struct tap_dev *tap);\nint tap_get_minor(dev_t major, struct tap_dev *tap);\nvoid tap_free_minor(dev_t major, struct tap_dev *tap);\nint tap_queue_resize(struct tap_dev *tap);\nint tap_create_cdev(struct cdev *tap_cdev, dev_t *tap_major,\n\t\t    const char *device_name, struct module *module);\nvoid tap_destroy_cdev(dev_t major, struct cdev *tap_cdev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}