{
  "module_name": "cq.h",
  "hash_id": "13a1271917fdaa1286deda5c34580cd4b2714d0fc423fcfa451ba16ad3dc0748",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/mlx4/cq.h",
  "human_readable_source": " \n\n#ifndef MLX4_CQ_H\n#define MLX4_CQ_H\n\n#include <linux/types.h>\n#include <uapi/linux/if_ether.h>\n\n#include <linux/mlx4/device.h>\n#include <linux/mlx4/doorbell.h>\n\nstruct mlx4_cqe {\n\t__be32\t\t\tvlan_my_qpn;\n\t__be32\t\t\timmed_rss_invalid;\n\t__be32\t\t\tg_mlpath_rqpn;\n\t__be16\t\t\tsl_vid;\n\tunion {\n\t\tstruct {\n\t\t\t__be16\trlid;\n\t\t\t__be16  status;\n\t\t\tu8      ipv6_ext_mask;\n\t\t\tu8      badfcs_enc;\n\t\t};\n\t\tu8  smac[ETH_ALEN];\n\t};\n\t__be32\t\t\tbyte_cnt;\n\t__be16\t\t\twqe_index;\n\t__be16\t\t\tchecksum;\n\tu8\t\t\treserved[3];\n\tu8\t\t\towner_sr_opcode;\n};\n\nstruct mlx4_err_cqe {\n\t__be32\t\t\tmy_qpn;\n\tu32\t\t\treserved1[5];\n\t__be16\t\t\twqe_index;\n\tu8\t\t\tvendor_err_syndrome;\n\tu8\t\t\tsyndrome;\n\tu8\t\t\treserved2[3];\n\tu8\t\t\towner_sr_opcode;\n};\n\nstruct mlx4_ts_cqe {\n\t__be32\t\t\tvlan_my_qpn;\n\t__be32\t\t\timmed_rss_invalid;\n\t__be32\t\t\tg_mlpath_rqpn;\n\t__be32\t\t\ttimestamp_hi;\n\t__be16\t\t\tstatus;\n\tu8\t\t\tipv6_ext_mask;\n\tu8\t\t\tbadfcs_enc;\n\t__be32\t\t\tbyte_cnt;\n\t__be16\t\t\twqe_index;\n\t__be16\t\t\tchecksum;\n\tu8\t\t\treserved;\n\t__be16\t\t\ttimestamp_lo;\n\tu8\t\t\towner_sr_opcode;\n} __packed;\n\nenum {\n\tMLX4_CQE_L2_TUNNEL_IPOK\t\t= 1 << 31,\n\tMLX4_CQE_CVLAN_PRESENT_MASK\t= 1 << 29,\n\tMLX4_CQE_SVLAN_PRESENT_MASK\t= 1 << 30,\n\tMLX4_CQE_L2_TUNNEL\t\t= 1 << 27,\n\tMLX4_CQE_L2_TUNNEL_CSUM\t\t= 1 << 26,\n\tMLX4_CQE_L2_TUNNEL_IPV4\t\t= 1 << 25,\n\n\tMLX4_CQE_QPN_MASK\t\t= 0xffffff,\n\tMLX4_CQE_VID_MASK\t\t= 0xfff,\n};\n\nenum {\n\tMLX4_CQE_OWNER_MASK\t= 0x80,\n\tMLX4_CQE_IS_SEND_MASK\t= 0x40,\n\tMLX4_CQE_OPCODE_MASK\t= 0x1f\n};\n\nenum {\n\tMLX4_CQE_SYNDROME_LOCAL_LENGTH_ERR\t\t= 0x01,\n\tMLX4_CQE_SYNDROME_LOCAL_QP_OP_ERR\t\t= 0x02,\n\tMLX4_CQE_SYNDROME_LOCAL_PROT_ERR\t\t= 0x04,\n\tMLX4_CQE_SYNDROME_WR_FLUSH_ERR\t\t\t= 0x05,\n\tMLX4_CQE_SYNDROME_MW_BIND_ERR\t\t\t= 0x06,\n\tMLX4_CQE_SYNDROME_BAD_RESP_ERR\t\t\t= 0x10,\n\tMLX4_CQE_SYNDROME_LOCAL_ACCESS_ERR\t\t= 0x11,\n\tMLX4_CQE_SYNDROME_REMOTE_INVAL_REQ_ERR\t\t= 0x12,\n\tMLX4_CQE_SYNDROME_REMOTE_ACCESS_ERR\t\t= 0x13,\n\tMLX4_CQE_SYNDROME_REMOTE_OP_ERR\t\t\t= 0x14,\n\tMLX4_CQE_SYNDROME_TRANSPORT_RETRY_EXC_ERR\t= 0x15,\n\tMLX4_CQE_SYNDROME_RNR_RETRY_EXC_ERR\t\t= 0x16,\n\tMLX4_CQE_SYNDROME_REMOTE_ABORTED_ERR\t\t= 0x22,\n};\n\nenum {\n\tMLX4_CQE_STATUS_IPV4\t\t= 1 << 6,\n\tMLX4_CQE_STATUS_IPV4F\t\t= 1 << 7,\n\tMLX4_CQE_STATUS_IPV6\t\t= 1 << 8,\n\tMLX4_CQE_STATUS_IPV4OPT\t\t= 1 << 9,\n\tMLX4_CQE_STATUS_TCP\t\t= 1 << 10,\n\tMLX4_CQE_STATUS_UDP\t\t= 1 << 11,\n\tMLX4_CQE_STATUS_IPOK\t\t= 1 << 12,\n};\n\n \nenum {\n\tMLX4_CQE_STATUS_L4_CSUM\t\t= 1 << 2,\n};\n\nenum {\n\tMLX4_CQE_LLC                     = 1,\n\tMLX4_CQE_SNAP                    = 1 << 1,\n\tMLX4_CQE_BAD_FCS                 = 1 << 4,\n};\n\n#define MLX4_MAX_CQ_PERIOD (BIT(16) - 1)\n#define MLX4_MAX_CQ_COUNT (BIT(16) - 1)\n\nstatic inline void mlx4_cq_arm(struct mlx4_cq *cq, u32 cmd,\n\t\t\t       void __iomem *uar_page,\n\t\t\t       spinlock_t *doorbell_lock)\n{\n\t__be32 doorbell[2];\n\tu32 sn;\n\tu32 ci;\n\n\tsn = cq->arm_sn & 3;\n\tci = cq->cons_index & 0xffffff;\n\n\t*cq->arm_db = cpu_to_be32(sn << 28 | cmd | ci);\n\n\t \n\twmb();\n\n\tdoorbell[0] = cpu_to_be32(sn << 28 | cmd | cq->cqn);\n\tdoorbell[1] = cpu_to_be32(ci);\n\n\tmlx4_write64(doorbell, uar_page + MLX4_CQ_DOORBELL, doorbell_lock);\n}\n\nstatic inline void mlx4_cq_set_ci(struct mlx4_cq *cq)\n{\n\t*cq->set_ci_db = cpu_to_be32(cq->cons_index & 0xffffff);\n}\n\nenum {\n\tMLX4_CQ_DB_REQ_NOT_SOL\t\t= 1 << 24,\n\tMLX4_CQ_DB_REQ_NOT\t\t= 2 << 24\n};\n\nint mlx4_cq_modify(struct mlx4_dev *dev, struct mlx4_cq *cq,\n\t\t   u16 count, u16 period);\nint mlx4_cq_resize(struct mlx4_dev *dev, struct mlx4_cq *cq,\n\t\t   int entries, struct mlx4_mtt *mtt);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}