{
  "module_name": "fprobe.h",
  "hash_id": "0eee70523c3062813c8310f1ae1a05895c19bae16fed54037d5d75c06b224cef",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/fprobe.h",
  "human_readable_source": " \n \n#ifndef _LINUX_FPROBE_H\n#define _LINUX_FPROBE_H\n\n#include <linux/compiler.h>\n#include <linux/ftrace.h>\n#include <linux/rethook.h>\n\n \nstruct fprobe {\n#ifdef CONFIG_FUNCTION_TRACER\n\t \n\tstruct ftrace_ops\tops;\n#endif\n\tunsigned long\t\tnmissed;\n\tunsigned int\t\tflags;\n\tstruct rethook\t\t*rethook;\n\tsize_t\t\t\tentry_data_size;\n\tint\t\t\tnr_maxactive;\n\n\tint (*entry_handler)(struct fprobe *fp, unsigned long entry_ip,\n\t\t\t     unsigned long ret_ip, struct pt_regs *regs,\n\t\t\t     void *entry_data);\n\tvoid (*exit_handler)(struct fprobe *fp, unsigned long entry_ip,\n\t\t\t     unsigned long ret_ip, struct pt_regs *regs,\n\t\t\t     void *entry_data);\n};\n\n \n#define FPROBE_FL_DISABLED\t1\n\n \n#define FPROBE_FL_KPROBE_SHARED\t2\n\nstatic inline bool fprobe_disabled(struct fprobe *fp)\n{\n\treturn (fp) ? fp->flags & FPROBE_FL_DISABLED : false;\n}\n\nstatic inline bool fprobe_shared_with_kprobes(struct fprobe *fp)\n{\n\treturn (fp) ? fp->flags & FPROBE_FL_KPROBE_SHARED : false;\n}\n\n#ifdef CONFIG_FPROBE\nint register_fprobe(struct fprobe *fp, const char *filter, const char *notfilter);\nint register_fprobe_ips(struct fprobe *fp, unsigned long *addrs, int num);\nint register_fprobe_syms(struct fprobe *fp, const char **syms, int num);\nint unregister_fprobe(struct fprobe *fp);\nbool fprobe_is_registered(struct fprobe *fp);\n#else\nstatic inline int register_fprobe(struct fprobe *fp, const char *filter, const char *notfilter)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int register_fprobe_ips(struct fprobe *fp, unsigned long *addrs, int num)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int register_fprobe_syms(struct fprobe *fp, const char **syms, int num)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int unregister_fprobe(struct fprobe *fp)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline bool fprobe_is_registered(struct fprobe *fp)\n{\n\treturn false;\n}\n#endif\n\n \nstatic inline void disable_fprobe(struct fprobe *fp)\n{\n\tif (fp)\n\t\tfp->flags |= FPROBE_FL_DISABLED;\n}\n\n \nstatic inline void enable_fprobe(struct fprobe *fp)\n{\n\tif (fp)\n\t\tfp->flags &= ~FPROBE_FL_DISABLED;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}