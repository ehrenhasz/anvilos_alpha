{
  "module_name": "blk-crypto.h",
  "hash_id": "e113ecfcf9b218c13926b2f1093e131e6b442d1b7edddede9d96431544c2c9bd",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/blk-crypto.h",
  "human_readable_source": " \n \n\n#ifndef __LINUX_BLK_CRYPTO_H\n#define __LINUX_BLK_CRYPTO_H\n\n#include <linux/types.h>\n\nenum blk_crypto_mode_num {\n\tBLK_ENCRYPTION_MODE_INVALID,\n\tBLK_ENCRYPTION_MODE_AES_256_XTS,\n\tBLK_ENCRYPTION_MODE_AES_128_CBC_ESSIV,\n\tBLK_ENCRYPTION_MODE_ADIANTUM,\n\tBLK_ENCRYPTION_MODE_SM4_XTS,\n\tBLK_ENCRYPTION_MODE_MAX,\n};\n\n#define BLK_CRYPTO_MAX_KEY_SIZE\t\t64\n \nstruct blk_crypto_config {\n\tenum blk_crypto_mode_num crypto_mode;\n\tunsigned int data_unit_size;\n\tunsigned int dun_bytes;\n};\n\n \nstruct blk_crypto_key {\n\tstruct blk_crypto_config crypto_cfg;\n\tunsigned int data_unit_size_bits;\n\tunsigned int size;\n\tu8 raw[BLK_CRYPTO_MAX_KEY_SIZE];\n};\n\n#define BLK_CRYPTO_MAX_IV_SIZE\t\t32\n#define BLK_CRYPTO_DUN_ARRAY_SIZE\t(BLK_CRYPTO_MAX_IV_SIZE / sizeof(u64))\n\n \nstruct bio_crypt_ctx {\n\tconst struct blk_crypto_key\t*bc_key;\n\tu64\t\t\t\tbc_dun[BLK_CRYPTO_DUN_ARRAY_SIZE];\n};\n\n#include <linux/blk_types.h>\n#include <linux/blkdev.h>\n\n#ifdef CONFIG_BLK_INLINE_ENCRYPTION\n\nstatic inline bool bio_has_crypt_ctx(struct bio *bio)\n{\n\treturn bio->bi_crypt_context;\n}\n\nvoid bio_crypt_set_ctx(struct bio *bio, const struct blk_crypto_key *key,\n\t\t       const u64 dun[BLK_CRYPTO_DUN_ARRAY_SIZE],\n\t\t       gfp_t gfp_mask);\n\nbool bio_crypt_dun_is_contiguous(const struct bio_crypt_ctx *bc,\n\t\t\t\t unsigned int bytes,\n\t\t\t\t const u64 next_dun[BLK_CRYPTO_DUN_ARRAY_SIZE]);\n\nint blk_crypto_init_key(struct blk_crypto_key *blk_key, const u8 *raw_key,\n\t\t\tenum blk_crypto_mode_num crypto_mode,\n\t\t\tunsigned int dun_bytes,\n\t\t\tunsigned int data_unit_size);\n\nint blk_crypto_start_using_key(struct block_device *bdev,\n\t\t\t       const struct blk_crypto_key *key);\n\nvoid blk_crypto_evict_key(struct block_device *bdev,\n\t\t\t  const struct blk_crypto_key *key);\n\nbool blk_crypto_config_supported_natively(struct block_device *bdev,\n\t\t\t\t\t  const struct blk_crypto_config *cfg);\nbool blk_crypto_config_supported(struct block_device *bdev,\n\t\t\t\t const struct blk_crypto_config *cfg);\n\n#else  \n\nstatic inline bool bio_has_crypt_ctx(struct bio *bio)\n{\n\treturn false;\n}\n\n#endif  \n\nint __bio_crypt_clone(struct bio *dst, struct bio *src, gfp_t gfp_mask);\n \nstatic inline int bio_crypt_clone(struct bio *dst, struct bio *src,\n\t\t\t\t  gfp_t gfp_mask)\n{\n\tif (bio_has_crypt_ctx(src))\n\t\treturn __bio_crypt_clone(dst, src, gfp_mask);\n\treturn 0;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}