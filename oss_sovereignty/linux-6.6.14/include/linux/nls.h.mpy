{
  "module_name": "nls.h",
  "hash_id": "965e4d0bad37902682a402fffc7eff61848d4fdae2f1a8fd7a9ceb81b0a22c7a",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/nls.h",
  "human_readable_source": " \n#ifndef _LINUX_NLS_H\n#define _LINUX_NLS_H\n\n#include <linux/init.h>\n\n \n\n \ntypedef u16 wchar_t;\n#define MAX_WCHAR_T\t0xffff\n\n \ntypedef u32 unicode_t;\n\nstruct nls_table {\n\tconst char *charset;\n\tconst char *alias;\n\tint (*uni2char) (wchar_t uni, unsigned char *out, int boundlen);\n\tint (*char2uni) (const unsigned char *rawstring, int boundlen,\n\t\t\t wchar_t *uni);\n\tconst unsigned char *charset2lower;\n\tconst unsigned char *charset2upper;\n\tstruct module *owner;\n\tstruct nls_table *next;\n};\n\n \n#define NLS_MAX_CHARSET_SIZE 6  \n\n \nenum utf16_endian {\n\tUTF16_HOST_ENDIAN,\n\tUTF16_LITTLE_ENDIAN,\n\tUTF16_BIG_ENDIAN\n};\n\n \nextern int __register_nls(struct nls_table *, struct module *);\nextern int unregister_nls(struct nls_table *);\nextern struct nls_table *load_nls(const char *charset);\nextern void unload_nls(struct nls_table *);\nextern struct nls_table *load_nls_default(void);\n#define register_nls(nls) __register_nls((nls), THIS_MODULE)\n\nextern int utf8_to_utf32(const u8 *s, int len, unicode_t *pu);\nextern int utf32_to_utf8(unicode_t u, u8 *s, int maxlen);\nextern int utf8s_to_utf16s(const u8 *s, int len,\n\t\tenum utf16_endian endian, wchar_t *pwcs, int maxlen);\nextern int utf16s_to_utf8s(const wchar_t *pwcs, int len,\n\t\tenum utf16_endian endian, u8 *s, int maxlen);\n\nstatic inline unsigned char nls_tolower(struct nls_table *t, unsigned char c)\n{\n\tunsigned char nc = t->charset2lower[c];\n\n\treturn nc ? nc : c;\n}\n\nstatic inline unsigned char nls_toupper(struct nls_table *t, unsigned char c)\n{\n\tunsigned char nc = t->charset2upper[c];\n\n\treturn nc ? nc : c;\n}\n\nstatic inline int nls_strnicmp(struct nls_table *t, const unsigned char *s1,\n\t\tconst unsigned char *s2, int len)\n{\n\twhile (len--) {\n\t\tif (nls_tolower(t, *s1++) != nls_tolower(t, *s2++))\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n\n \nstatic inline int\nnls_nullsize(const struct nls_table *codepage)\n{\n\tint charlen;\n\tchar tmp[NLS_MAX_CHARSET_SIZE];\n\n\tcharlen = codepage->uni2char(0, tmp, NLS_MAX_CHARSET_SIZE);\n\n\treturn charlen > 0 ? charlen : 1;\n}\n\n#define MODULE_ALIAS_NLS(name)\tMODULE_ALIAS(\"nls_\" __stringify(name))\n\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}