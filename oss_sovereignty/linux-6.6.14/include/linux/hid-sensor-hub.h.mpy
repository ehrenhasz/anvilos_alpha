{
  "module_name": "hid-sensor-hub.h",
  "hash_id": "ba1972fec71af3611ab02f0ae3cc13498542ce0e26619f71996acb4d920b41ec",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/hid-sensor-hub.h",
  "human_readable_source": " \n \n#ifndef _HID_SENSORS_HUB_H\n#define _HID_SENSORS_HUB_H\n\n#include <linux/hid.h>\n#include <linux/hid-sensor-ids.h>\n#include <linux/iio/iio.h>\n#include <linux/iio/trigger.h>\n\n \nstruct hid_sensor_hub_attribute_info {\n\tu32 usage_id;\n\tu32 attrib_id;\n\ts32 report_id;\n\ts32 index;\n\ts32 units;\n\ts32 unit_expo;\n\ts32 size;\n\ts32 logical_minimum;\n\ts32 logical_maximum;\n};\n\n \nstruct sensor_hub_pending {\n\tbool status;\n\tstruct completion ready;\n\tu32 usage_id;\n\tu32 attr_usage_id;\n\tint raw_size;\n\tu8  *raw_data;\n};\n\n \nstruct hid_sensor_hub_device {\n\tstruct hid_device *hdev;\n\tu32 vendor_id;\n\tu32 product_id;\n\tu32 usage;\n\tint start_collection_index;\n\tint end_collection_index;\n\tstruct mutex *mutex_ptr;\n\tstruct sensor_hub_pending pending;\n};\n\n \nstruct hid_sensor_hub_callbacks {\n\tstruct platform_device *pdev;\n\tint (*suspend)(struct hid_sensor_hub_device *hsdev, void *priv);\n\tint (*resume)(struct hid_sensor_hub_device *hsdev, void *priv);\n\tint (*capture_sample)(struct hid_sensor_hub_device *hsdev,\n\t\t\tu32 usage_id, size_t raw_len, char *raw_data,\n\t\t\tvoid *priv);\n\tint (*send_event)(struct hid_sensor_hub_device *hsdev, u32 usage_id,\n\t\t\t void *priv);\n};\n\n \nint sensor_hub_device_open(struct hid_sensor_hub_device *hsdev);\n\n \nvoid sensor_hub_device_close(struct hid_sensor_hub_device *hsdev);\n\n \n\n \nint sensor_hub_register_callback(struct hid_sensor_hub_device *hsdev,\n\t\t\tu32 usage_id,\n\t\t\tstruct hid_sensor_hub_callbacks *usage_callback);\n\n \nint sensor_hub_remove_callback(struct hid_sensor_hub_device *hsdev,\n\t\t\tu32 usage_id);\n\n\n \n\n \nint sensor_hub_input_get_attribute_info(struct hid_sensor_hub_device *hsdev,\n\t\t\tu8 type,\n\t\t\tu32 usage_id, u32 attr_usage_id,\n\t\t\tstruct hid_sensor_hub_attribute_info *info);\n\n \n\nenum sensor_hub_read_flags {\n\tSENSOR_HUB_SYNC,\n\tSENSOR_HUB_ASYNC,\n};\n\nint sensor_hub_input_attr_get_raw_value(struct hid_sensor_hub_device *hsdev,\n \t\t\t\t\tu32 usage_id,\n \t\t\t\t\tu32 attr_usage_id, u32 report_id,\n\t\t\t\t\tenum sensor_hub_read_flags flag,\n\t\t\t\t\tbool is_signed\n);\n\n \nint sensor_hub_set_feature(struct hid_sensor_hub_device *hsdev, u32 report_id,\n\t\t\t   u32 field_index, int buffer_size, void *buffer);\n\n \nint sensor_hub_get_feature(struct hid_sensor_hub_device *hsdev, u32 report_id,\n\t\t\t   u32 field_index, int buffer_size, void *buffer);\n\n \n\n \nstruct hid_sensor_common {\n\tstruct hid_sensor_hub_device *hsdev;\n\tstruct platform_device *pdev;\n\tunsigned usage_id;\n\tatomic_t data_ready;\n\tatomic_t user_requested_state;\n\tatomic_t runtime_pm_enable;\n\tint poll_interval;\n\tint raw_hystersis;\n\tint latency_ms;\n\tstruct iio_trigger *trigger;\n\tint timestamp_ns_scale;\n\tstruct hid_sensor_hub_attribute_info poll;\n\tstruct hid_sensor_hub_attribute_info report_state;\n\tstruct hid_sensor_hub_attribute_info power_state;\n\tstruct hid_sensor_hub_attribute_info sensitivity;\n\tstruct hid_sensor_hub_attribute_info sensitivity_rel;\n\tstruct hid_sensor_hub_attribute_info report_latency;\n\tstruct work_struct work;\n};\n\n \nstatic inline int hid_sensor_convert_exponent(int unit_expo)\n{\n\tif (unit_expo < 0x08)\n\t\treturn unit_expo;\n\telse if (unit_expo <= 0x0f)\n\t\treturn -(0x0f-unit_expo+1);\n\telse\n\t\treturn 0;\n}\n\nint hid_sensor_parse_common_attributes(struct hid_sensor_hub_device *hsdev,\n\t\t\t\t\tu32 usage_id,\n\t\t\t\t\tstruct hid_sensor_common *st,\n\t\t\t\t\tconst u32 *sensitivity_addresses,\n\t\t\t\t\tu32 sensitivity_addresses_len);\nint hid_sensor_write_raw_hyst_value(struct hid_sensor_common *st,\n\t\t\t\t\tint val1, int val2);\nint hid_sensor_write_raw_hyst_rel_value(struct hid_sensor_common *st, int val1,\n\t\t\t\t\tint val2);\nint hid_sensor_read_raw_hyst_value(struct hid_sensor_common *st,\n\t\t\t\t\tint *val1, int *val2);\nint hid_sensor_read_raw_hyst_rel_value(struct hid_sensor_common *st,\n\t\t\t\t       int *val1, int *val2);\nint hid_sensor_write_samp_freq_value(struct hid_sensor_common *st,\n\t\t\t\t\tint val1, int val2);\nint hid_sensor_read_samp_freq_value(struct hid_sensor_common *st,\n\t\t\t\t\tint *val1, int *val2);\n\nint hid_sensor_get_usage_index(struct hid_sensor_hub_device *hsdev,\n\t\t\t\tu32 report_id, int field_index, u32 usage_id);\n\nint hid_sensor_format_scale(u32 usage_id,\n\t\t\t    struct hid_sensor_hub_attribute_info *attr_info,\n\t\t\t    int *val0, int *val1);\n\ns32 hid_sensor_read_poll_value(struct hid_sensor_common *st);\n\nint64_t hid_sensor_convert_timestamp(struct hid_sensor_common *st,\n\t\t\t\t     int64_t raw_value);\nbool hid_sensor_batch_mode_supported(struct hid_sensor_common *st);\nint hid_sensor_set_report_latency(struct hid_sensor_common *st, int latency);\nint hid_sensor_get_report_latency(struct hid_sensor_common *st);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}