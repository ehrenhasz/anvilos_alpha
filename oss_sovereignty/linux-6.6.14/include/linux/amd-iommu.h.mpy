{
  "module_name": "amd-iommu.h",
  "hash_id": "9e268fa9fa4076db887e93d5aac1abcefe6478f7f2a8b89e9ade5385e8b787a1",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/amd-iommu.h",
  "human_readable_source": " \n \n\n#ifndef _ASM_X86_AMD_IOMMU_H\n#define _ASM_X86_AMD_IOMMU_H\n\n#include <linux/types.h>\n\nstruct amd_iommu;\n\n \nstruct amd_iommu_pi_data {\n\tu32 ga_tag;\n\tu32 prev_ga_tag;\n\tu64 base;\n\tbool is_guest_mode;\n\tstruct vcpu_data *vcpu_data;\n\tvoid *ir_data;\n};\n\n#ifdef CONFIG_AMD_IOMMU\n\nstruct task_struct;\nstruct pci_dev;\n\nextern int amd_iommu_detect(void);\n\n \nextern int amd_iommu_init_device(struct pci_dev *pdev, int pasids);\n\n \nextern void amd_iommu_free_device(struct pci_dev *pdev);\n\n \nextern int amd_iommu_bind_pasid(struct pci_dev *pdev, u32 pasid,\n\t\t\t\tstruct task_struct *task);\n\n \nextern void amd_iommu_unbind_pasid(struct pci_dev *pdev, u32 pasid);\n\n \n#define AMD_IOMMU_INV_PRI_RSP_SUCCESS\t0\n#define AMD_IOMMU_INV_PRI_RSP_INVALID\t1\n#define AMD_IOMMU_INV_PRI_RSP_FAIL\t2\n\ntypedef int (*amd_iommu_invalid_ppr_cb)(struct pci_dev *pdev,\n\t\t\t\t\tu32 pasid,\n\t\t\t\t\tunsigned long address,\n\t\t\t\t\tu16);\n\nextern int amd_iommu_set_invalid_ppr_cb(struct pci_dev *pdev,\n\t\t\t\t\tamd_iommu_invalid_ppr_cb cb);\n\n#define PPR_FAULT_EXEC\t(1 << 1)\n#define PPR_FAULT_READ  (1 << 2)\n#define PPR_FAULT_WRITE (1 << 5)\n#define PPR_FAULT_USER  (1 << 6)\n#define PPR_FAULT_RSVD  (1 << 7)\n#define PPR_FAULT_GN    (1 << 8)\n\n \n\n#define AMD_IOMMU_DEVICE_FLAG_ATS_SUP     0x1     \n#define AMD_IOMMU_DEVICE_FLAG_PRI_SUP     0x2     \n#define AMD_IOMMU_DEVICE_FLAG_PASID_SUP   0x4     \n#define AMD_IOMMU_DEVICE_FLAG_EXEC_SUP    0x8     \n#define AMD_IOMMU_DEVICE_FLAG_PRIV_SUP   0x10     \n\nstruct amd_iommu_device_info {\n\tint max_pasids;\n\tu32 flags;\n};\n\nextern int amd_iommu_device_info(struct pci_dev *pdev,\n\t\t\t\t struct amd_iommu_device_info *info);\n\n \n\ntypedef void (*amd_iommu_invalidate_ctx)(struct pci_dev *pdev, u32 pasid);\n\nextern int amd_iommu_set_invalidate_ctx_cb(struct pci_dev *pdev,\n\t\t\t\t\t   amd_iommu_invalidate_ctx cb);\n#else  \n\nstatic inline int amd_iommu_detect(void) { return -ENODEV; }\n\n#endif  \n\n#if defined(CONFIG_AMD_IOMMU) && defined(CONFIG_IRQ_REMAP)\n\n \nextern int amd_iommu_register_ga_log_notifier(int (*notifier)(u32));\n\nextern int\namd_iommu_update_ga(int cpu, bool is_run, void *data);\n\nextern int amd_iommu_activate_guest_mode(void *data);\nextern int amd_iommu_deactivate_guest_mode(void *data);\n\n#else  \n\nstatic inline int\namd_iommu_register_ga_log_notifier(int (*notifier)(u32))\n{\n\treturn 0;\n}\n\nstatic inline int\namd_iommu_update_ga(int cpu, bool is_run, void *data)\n{\n\treturn 0;\n}\n\nstatic inline int amd_iommu_activate_guest_mode(void *data)\n{\n\treturn 0;\n}\n\nstatic inline int amd_iommu_deactivate_guest_mode(void *data)\n{\n\treturn 0;\n}\n#endif  \n\nint amd_iommu_get_num_iommus(void);\nbool amd_iommu_pc_supported(void);\nu8 amd_iommu_pc_get_max_banks(unsigned int idx);\nu8 amd_iommu_pc_get_max_counters(unsigned int idx);\nint amd_iommu_pc_set_reg(struct amd_iommu *iommu, u8 bank, u8 cntr, u8 fxn,\n\t\tu64 *value);\nint amd_iommu_pc_get_reg(struct amd_iommu *iommu, u8 bank, u8 cntr, u8 fxn,\n\t\tu64 *value);\nstruct amd_iommu *get_amd_iommu(unsigned int idx);\n\n#ifdef CONFIG_AMD_MEM_ENCRYPT\nint amd_iommu_snp_enable(void);\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}