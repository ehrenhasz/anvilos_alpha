{
  "module_name": "ima.h",
  "hash_id": "c03a0f0fc0980396bc4fa732c34f09c9cb4f80a9215da519edc89654e6b178e7",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/ima.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_IMA_H\n#define _LINUX_IMA_H\n\n#include <linux/kernel_read_file.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/kexec.h>\n#include <crypto/hash_info.h>\nstruct linux_binprm;\n\n#ifdef CONFIG_IMA\nextern enum hash_algo ima_get_current_hash_algo(void);\nextern int ima_bprm_check(struct linux_binprm *bprm);\nextern int ima_file_check(struct file *file, int mask);\nextern void ima_post_create_tmpfile(struct mnt_idmap *idmap,\n\t\t\t\t    struct inode *inode);\nextern void ima_file_free(struct file *file);\nextern int ima_file_mmap(struct file *file, unsigned long reqprot,\n\t\t\t unsigned long prot, unsigned long flags);\nextern int ima_file_mprotect(struct vm_area_struct *vma, unsigned long prot);\nextern int ima_load_data(enum kernel_load_data_id id, bool contents);\nextern int ima_post_load_data(char *buf, loff_t size,\n\t\t\t      enum kernel_load_data_id id, char *description);\nextern int ima_read_file(struct file *file, enum kernel_read_file_id id,\n\t\t\t bool contents);\nextern int ima_post_read_file(struct file *file, void *buf, loff_t size,\n\t\t\t      enum kernel_read_file_id id);\nextern void ima_post_path_mknod(struct mnt_idmap *idmap,\n\t\t\t\tstruct dentry *dentry);\nextern int ima_file_hash(struct file *file, char *buf, size_t buf_size);\nextern int ima_inode_hash(struct inode *inode, char *buf, size_t buf_size);\nextern void ima_kexec_cmdline(int kernel_fd, const void *buf, int size);\nextern int ima_measure_critical_data(const char *event_label,\n\t\t\t\t     const char *event_name,\n\t\t\t\t     const void *buf, size_t buf_len,\n\t\t\t\t     bool hash, u8 *digest, size_t digest_len);\n\n#ifdef CONFIG_IMA_APPRAISE_BOOTPARAM\nextern void ima_appraise_parse_cmdline(void);\n#else\nstatic inline void ima_appraise_parse_cmdline(void) {}\n#endif\n\n#ifdef CONFIG_IMA_KEXEC\nextern void ima_add_kexec_buffer(struct kimage *image);\n#endif\n\n#else\nstatic inline enum hash_algo ima_get_current_hash_algo(void)\n{\n\treturn HASH_ALGO__LAST;\n}\n\nstatic inline int ima_bprm_check(struct linux_binprm *bprm)\n{\n\treturn 0;\n}\n\nstatic inline int ima_file_check(struct file *file, int mask)\n{\n\treturn 0;\n}\n\nstatic inline void ima_post_create_tmpfile(struct mnt_idmap *idmap,\n\t\t\t\t\t   struct inode *inode)\n{\n}\n\nstatic inline void ima_file_free(struct file *file)\n{\n\treturn;\n}\n\nstatic inline int ima_file_mmap(struct file *file, unsigned long reqprot,\n\t\t\t\tunsigned long prot, unsigned long flags)\n{\n\treturn 0;\n}\n\nstatic inline int ima_file_mprotect(struct vm_area_struct *vma,\n\t\t\t\t    unsigned long prot)\n{\n\treturn 0;\n}\n\nstatic inline int ima_load_data(enum kernel_load_data_id id, bool contents)\n{\n\treturn 0;\n}\n\nstatic inline int ima_post_load_data(char *buf, loff_t size,\n\t\t\t\t     enum kernel_load_data_id id,\n\t\t\t\t     char *description)\n{\n\treturn 0;\n}\n\nstatic inline int ima_read_file(struct file *file, enum kernel_read_file_id id,\n\t\t\t\tbool contents)\n{\n\treturn 0;\n}\n\nstatic inline int ima_post_read_file(struct file *file, void *buf, loff_t size,\n\t\t\t\t     enum kernel_read_file_id id)\n{\n\treturn 0;\n}\n\nstatic inline void ima_post_path_mknod(struct mnt_idmap *idmap,\n\t\t\t\t       struct dentry *dentry)\n{\n\treturn;\n}\n\nstatic inline int ima_file_hash(struct file *file, char *buf, size_t buf_size)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int ima_inode_hash(struct inode *inode, char *buf, size_t buf_size)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void ima_kexec_cmdline(int kernel_fd, const void *buf, int size) {}\n\nstatic inline int ima_measure_critical_data(const char *event_label,\n\t\t\t\t\t     const char *event_name,\n\t\t\t\t\t     const void *buf, size_t buf_len,\n\t\t\t\t\t     bool hash, u8 *digest,\n\t\t\t\t\t     size_t digest_len)\n{\n\treturn -ENOENT;\n}\n\n#endif  \n\n#ifdef CONFIG_HAVE_IMA_KEXEC\nint __init ima_free_kexec_buffer(void);\nint __init ima_get_kexec_buffer(void **addr, size_t *size);\n#endif\n\n#ifdef CONFIG_IMA_SECURE_AND_OR_TRUSTED_BOOT\nextern bool arch_ima_get_secureboot(void);\nextern const char * const *arch_get_ima_policy(void);\n#else\nstatic inline bool arch_ima_get_secureboot(void)\n{\n\treturn false;\n}\n\nstatic inline const char * const *arch_get_ima_policy(void)\n{\n\treturn NULL;\n}\n#endif\n\n#ifndef CONFIG_IMA_KEXEC\nstruct kimage;\n\nstatic inline void ima_add_kexec_buffer(struct kimage *image)\n{}\n#endif\n\n#ifdef CONFIG_IMA_MEASURE_ASYMMETRIC_KEYS\nextern void ima_post_key_create_or_update(struct key *keyring,\n\t\t\t\t\t  struct key *key,\n\t\t\t\t\t  const void *payload, size_t plen,\n\t\t\t\t\t  unsigned long flags, bool create);\n#else\nstatic inline void ima_post_key_create_or_update(struct key *keyring,\n\t\t\t\t\t\t struct key *key,\n\t\t\t\t\t\t const void *payload,\n\t\t\t\t\t\t size_t plen,\n\t\t\t\t\t\t unsigned long flags,\n\t\t\t\t\t\t bool create) {}\n#endif   \n\n#ifdef CONFIG_IMA_APPRAISE\nextern bool is_ima_appraise_enabled(void);\nextern void ima_inode_post_setattr(struct mnt_idmap *idmap,\n\t\t\t\t   struct dentry *dentry);\nextern int ima_inode_setxattr(struct dentry *dentry, const char *xattr_name,\n\t\t       const void *xattr_value, size_t xattr_value_len);\nextern int ima_inode_set_acl(struct mnt_idmap *idmap,\n\t\t\t     struct dentry *dentry, const char *acl_name,\n\t\t\t     struct posix_acl *kacl);\nstatic inline int ima_inode_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t       struct dentry *dentry,\n\t\t\t\t       const char *acl_name)\n{\n\treturn ima_inode_set_acl(idmap, dentry, acl_name, NULL);\n}\nextern int ima_inode_removexattr(struct dentry *dentry, const char *xattr_name);\n#else\nstatic inline bool is_ima_appraise_enabled(void)\n{\n\treturn 0;\n}\n\nstatic inline void ima_inode_post_setattr(struct mnt_idmap *idmap,\n\t\t\t\t\t  struct dentry *dentry)\n{\n\treturn;\n}\n\nstatic inline int ima_inode_setxattr(struct dentry *dentry,\n\t\t\t\t     const char *xattr_name,\n\t\t\t\t     const void *xattr_value,\n\t\t\t\t     size_t xattr_value_len)\n{\n\treturn 0;\n}\n\nstatic inline int ima_inode_set_acl(struct mnt_idmap *idmap,\n\t\t\t\t    struct dentry *dentry, const char *acl_name,\n\t\t\t\t    struct posix_acl *kacl)\n{\n\n\treturn 0;\n}\n\nstatic inline int ima_inode_removexattr(struct dentry *dentry,\n\t\t\t\t\tconst char *xattr_name)\n{\n\treturn 0;\n}\n\nstatic inline int ima_inode_remove_acl(struct mnt_idmap *idmap,\n\t\t\t\t       struct dentry *dentry,\n\t\t\t\t       const char *acl_name)\n{\n\treturn 0;\n}\n#endif  \n\n#if defined(CONFIG_IMA_APPRAISE) && defined(CONFIG_INTEGRITY_TRUSTED_KEYRING)\nextern bool ima_appraise_signature(enum kernel_read_file_id func);\n#else\nstatic inline bool ima_appraise_signature(enum kernel_read_file_id func)\n{\n\treturn false;\n}\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}