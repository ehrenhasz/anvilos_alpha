{
  "module_name": "lsm_audit.h",
  "hash_id": "37f5f2bb77b680500be27018dfaccc26795bdfd89c97e27adebfa92ca071edc1",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/lsm_audit.h",
  "human_readable_source": " \n \n#ifndef _LSM_COMMON_LOGGING_\n#define _LSM_COMMON_LOGGING_\n\n#include <linux/stddef.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/kdev_t.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/audit.h>\n#include <linux/in6.h>\n#include <linux/path.h>\n#include <linux/key.h>\n#include <linux/skbuff.h>\n#include <rdma/ib_verbs.h>\n\nstruct lsm_network_audit {\n\tint netif;\n\tconst struct sock *sk;\n\tu16 family;\n\t__be16 dport;\n\t__be16 sport;\n\tunion {\n\t\tstruct {\n\t\t\t__be32 daddr;\n\t\t\t__be32 saddr;\n\t\t} v4;\n\t\tstruct {\n\t\t\tstruct in6_addr daddr;\n\t\t\tstruct in6_addr saddr;\n\t\t} v6;\n\t} fam;\n};\n\nstruct lsm_ioctlop_audit {\n\tstruct path path;\n\tu16 cmd;\n};\n\nstruct lsm_ibpkey_audit {\n\tu64 subnet_prefix;\n\tu16 pkey;\n};\n\nstruct lsm_ibendport_audit {\n\tconst char *dev_name;\n\tu8 port;\n};\n\n \nstruct common_audit_data {\n\tchar type;\n#define LSM_AUDIT_DATA_PATH\t1\n#define LSM_AUDIT_DATA_NET\t2\n#define LSM_AUDIT_DATA_CAP\t3\n#define LSM_AUDIT_DATA_IPC\t4\n#define LSM_AUDIT_DATA_TASK\t5\n#define LSM_AUDIT_DATA_KEY\t6\n#define LSM_AUDIT_DATA_NONE\t7\n#define LSM_AUDIT_DATA_KMOD\t8\n#define LSM_AUDIT_DATA_INODE\t9\n#define LSM_AUDIT_DATA_DENTRY\t10\n#define LSM_AUDIT_DATA_IOCTL_OP\t11\n#define LSM_AUDIT_DATA_FILE\t12\n#define LSM_AUDIT_DATA_IBPKEY\t13\n#define LSM_AUDIT_DATA_IBENDPORT 14\n#define LSM_AUDIT_DATA_LOCKDOWN 15\n#define LSM_AUDIT_DATA_NOTIFICATION 16\n#define LSM_AUDIT_DATA_ANONINODE\t17\n\tunion \t{\n\t\tstruct path path;\n\t\tstruct dentry *dentry;\n\t\tstruct inode *inode;\n\t\tstruct lsm_network_audit *net;\n\t\tint cap;\n\t\tint ipc_id;\n\t\tstruct task_struct *tsk;\n#ifdef CONFIG_KEYS\n\t\tstruct {\n\t\t\tkey_serial_t key;\n\t\t\tchar *key_desc;\n\t\t} key_struct;\n#endif\n\t\tchar *kmod_name;\n\t\tstruct lsm_ioctlop_audit *op;\n\t\tstruct file *file;\n\t\tstruct lsm_ibpkey_audit *ibpkey;\n\t\tstruct lsm_ibendport_audit *ibendport;\n\t\tint reason;\n\t\tconst char *anonclass;\n\t} u;\n\t \n\tunion {\n#ifdef CONFIG_SECURITY_SMACK\n\t\tstruct smack_audit_data *smack_audit_data;\n#endif\n#ifdef CONFIG_SECURITY_SELINUX\n\t\tstruct selinux_audit_data *selinux_audit_data;\n#endif\n#ifdef CONFIG_SECURITY_APPARMOR\n\t\tstruct apparmor_audit_data *apparmor_audit_data;\n#endif\n\t};  \n};\n\n#define v4info fam.v4\n#define v6info fam.v6\n\nint ipv4_skb_to_auditdata(struct sk_buff *skb,\n\t\tstruct common_audit_data *ad, u8 *proto);\n\nint ipv6_skb_to_auditdata(struct sk_buff *skb,\n\t\tstruct common_audit_data *ad, u8 *proto);\n\nvoid common_lsm_audit(struct common_audit_data *a,\n\tvoid (*pre_audit)(struct audit_buffer *, void *),\n\tvoid (*post_audit)(struct audit_buffer *, void *));\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}