{
  "module_name": "key-type.h",
  "hash_id": "4843b84800279ccd6e225d0d5f23df4596505da6747546c8952d3bfb1f45e83c",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/key-type.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_KEY_TYPE_H\n#define _LINUX_KEY_TYPE_H\n\n#include <linux/key.h>\n#include <linux/errno.h>\n\n#ifdef CONFIG_KEYS\n\nstruct kernel_pkey_query;\nstruct kernel_pkey_params;\n\n \nstruct key_preparsed_payload {\n\tconst char\t*orig_description;  \n\tchar\t\t*description;\t \n\tunion key_payload payload;\t \n\tconst void\t*data;\t\t \n\tsize_t\t\tdatalen;\t \n\tsize_t\t\tquotalen;\t \n\ttime64_t\texpiry;\t\t \n} __randomize_layout;\n\ntypedef int (*request_key_actor_t)(struct key *auth_key, void *aux);\n\n \nstruct key_match_data {\n\t \n\tbool (*cmp)(const struct key *key,\n\t\t    const struct key_match_data *match_data);\n\n\tconst void\t*raw_data;\t \n\tvoid\t\t*preparsed;\t \n\tunsigned\tlookup_type;\t \n#define KEYRING_SEARCH_LOOKUP_DIRECT\t0x0000\t \n#define KEYRING_SEARCH_LOOKUP_ITERATE\t0x0001\t \n};\n\n \nstruct key_type {\n\t \n\tconst char *name;\n\n\t \n\tsize_t def_datalen;\n\n\tunsigned int flags;\n#define KEY_TYPE_NET_DOMAIN\t0x00000001  \n#define KEY_TYPE_INSTANT_REAP\t0x00000002  \n\n\t \n\tint (*vet_description)(const char *description);\n\n\t \n\tint (*preparse)(struct key_preparsed_payload *prep);\n\n\t \n\tvoid (*free_preparse)(struct key_preparsed_payload *prep);\n\n\t \n\tint (*instantiate)(struct key *key, struct key_preparsed_payload *prep);\n\n\t \n\tint (*update)(struct key *key, struct key_preparsed_payload *prep);\n\n\t \n\tint (*match_preparse)(struct key_match_data *match_data);\n\n\t \n\tvoid (*match_free)(struct key_match_data *match_data);\n\n\t \n\tvoid (*revoke)(struct key *key);\n\n\t \n\tvoid (*destroy)(struct key *key);\n\n\t \n\tvoid (*describe)(const struct key *key, struct seq_file *p);\n\n\t \n\tlong (*read)(const struct key *key, char *buffer, size_t buflen);\n\n\t \n\trequest_key_actor_t request_key;\n\n\t \n\tstruct key_restriction *(*lookup_restriction)(const char *params);\n\n\t \n\tint (*asym_query)(const struct kernel_pkey_params *params,\n\t\t\t  struct kernel_pkey_query *info);\n\tint (*asym_eds_op)(struct kernel_pkey_params *params,\n\t\t\t   const void *in, void *out);\n\tint (*asym_verify_signature)(struct kernel_pkey_params *params,\n\t\t\t\t     const void *in, const void *in2);\n\n\t \n\tstruct list_head\tlink;\t\t \n\tstruct lock_class_key\tlock_class;\t \n} __randomize_layout;\n\nextern struct key_type key_type_keyring;\n\nextern int register_key_type(struct key_type *ktype);\nextern void unregister_key_type(struct key_type *ktype);\n\nextern int key_payload_reserve(struct key *key, size_t datalen);\nextern int key_instantiate_and_link(struct key *key,\n\t\t\t\t    const void *data,\n\t\t\t\t    size_t datalen,\n\t\t\t\t    struct key *keyring,\n\t\t\t\t    struct key *authkey);\nextern int key_reject_and_link(struct key *key,\n\t\t\t       unsigned timeout,\n\t\t\t       unsigned error,\n\t\t\t       struct key *keyring,\n\t\t\t       struct key *authkey);\nextern void complete_request_key(struct key *authkey, int error);\n\nstatic inline int key_negate_and_link(struct key *key,\n\t\t\t\t      unsigned timeout,\n\t\t\t\t      struct key *keyring,\n\t\t\t\t      struct key *authkey)\n{\n\treturn key_reject_and_link(key, timeout, ENOKEY, keyring, authkey);\n}\n\nextern int generic_key_instantiate(struct key *key, struct key_preparsed_payload *prep);\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}