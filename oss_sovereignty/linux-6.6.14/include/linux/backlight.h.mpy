{
  "module_name": "backlight.h",
  "hash_id": "c2a53ca8b8e12edbfa34e5864281ffe344eaaf3e7a413b87dbc2c60be2e7052d",
  "original_prompt": "Ingested from linux-6.6.14/include/linux/backlight.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_BACKLIGHT_H\n#define _LINUX_BACKLIGHT_H\n\n#include <linux/device.h>\n#include <linux/fb.h>\n#include <linux/mutex.h>\n#include <linux/notifier.h>\n\n \nenum backlight_update_reason {\n\t \n\tBACKLIGHT_UPDATE_HOTKEY,\n\n\t \n\tBACKLIGHT_UPDATE_SYSFS,\n};\n\n \nenum backlight_type {\n\t \n\tBACKLIGHT_RAW = 1,\n\n\t \n\tBACKLIGHT_PLATFORM,\n\n\t \n\tBACKLIGHT_FIRMWARE,\n\n\t \n\tBACKLIGHT_TYPE_MAX,\n};\n\n \nenum backlight_notification {\n\t \n\tBACKLIGHT_REGISTERED,\n\n\t \n\tBACKLIGHT_UNREGISTERED,\n};\n\n \nenum backlight_scale {\n\t \n\tBACKLIGHT_SCALE_UNKNOWN = 0,\n\n\t \n\tBACKLIGHT_SCALE_LINEAR,\n\n\t \n\tBACKLIGHT_SCALE_NON_LINEAR,\n};\n\nstruct backlight_device;\nstruct fb_info;\n\n \nstruct backlight_ops {\n\t \n\tunsigned int options;\n\n#define BL_CORE_SUSPENDRESUME\t(1 << 0)\n\n\t \n\tint (*update_status)(struct backlight_device *);\n\n\t \n\tint (*get_brightness)(struct backlight_device *);\n\n\t \n\tint (*check_fb)(struct backlight_device *bd, struct fb_info *info);\n};\n\n \nstruct backlight_properties {\n\t \n\tint brightness;\n\n\t \n\tint max_brightness;\n\n\t \n\tint power;\n\n\t \n\tint fb_blank;\n\n\t \n\tenum backlight_type type;\n\n\t \n\tunsigned int state;\n\n#define BL_CORE_SUSPENDED\t(1 << 0)\t \n#define BL_CORE_FBBLANK\t\t(1 << 1)\t \n\n\t \n\tenum backlight_scale scale;\n};\n\n \nstruct backlight_device {\n\t \n\tstruct backlight_properties props;\n\n\t \n\tstruct mutex update_lock;\n\n\t \n\tstruct mutex ops_lock;\n\n\t \n\tconst struct backlight_ops *ops;\n\n\t \n\tstruct notifier_block fb_notif;\n\n\t \n\tstruct list_head entry;\n\n\t \n\tstruct device dev;\n\n\t \n\tbool fb_bl_on[FB_MAX];\n\n\t \n\tint use_count;\n};\n\n \nstatic inline int backlight_update_status(struct backlight_device *bd)\n{\n\tint ret = -ENOENT;\n\n\tmutex_lock(&bd->update_lock);\n\tif (bd->ops && bd->ops->update_status)\n\t\tret = bd->ops->update_status(bd);\n\tmutex_unlock(&bd->update_lock);\n\n\treturn ret;\n}\n\n \nstatic inline int backlight_enable(struct backlight_device *bd)\n{\n\tif (!bd)\n\t\treturn 0;\n\n\tbd->props.power = FB_BLANK_UNBLANK;\n\tbd->props.fb_blank = FB_BLANK_UNBLANK;\n\tbd->props.state &= ~BL_CORE_FBBLANK;\n\n\treturn backlight_update_status(bd);\n}\n\n \nstatic inline int backlight_disable(struct backlight_device *bd)\n{\n\tif (!bd)\n\t\treturn 0;\n\n\tbd->props.power = FB_BLANK_POWERDOWN;\n\tbd->props.fb_blank = FB_BLANK_POWERDOWN;\n\tbd->props.state |= BL_CORE_FBBLANK;\n\n\treturn backlight_update_status(bd);\n}\n\n \nstatic inline bool backlight_is_blank(const struct backlight_device *bd)\n{\n\treturn bd->props.power != FB_BLANK_UNBLANK ||\n\t       bd->props.fb_blank != FB_BLANK_UNBLANK ||\n\t       bd->props.state & (BL_CORE_SUSPENDED | BL_CORE_FBBLANK);\n}\n\n \nstatic inline int backlight_get_brightness(const struct backlight_device *bd)\n{\n\tif (backlight_is_blank(bd))\n\t\treturn 0;\n\telse\n\t\treturn bd->props.brightness;\n}\n\nstruct backlight_device *\nbacklight_device_register(const char *name, struct device *dev, void *devdata,\n\t\t\t  const struct backlight_ops *ops,\n\t\t\t  const struct backlight_properties *props);\nstruct backlight_device *\ndevm_backlight_device_register(struct device *dev, const char *name,\n\t\t\t       struct device *parent, void *devdata,\n\t\t\t       const struct backlight_ops *ops,\n\t\t\t       const struct backlight_properties *props);\nvoid backlight_device_unregister(struct backlight_device *bd);\nvoid devm_backlight_device_unregister(struct device *dev,\n\t\t\t\t      struct backlight_device *bd);\nvoid backlight_force_update(struct backlight_device *bd,\n\t\t\t    enum backlight_update_reason reason);\nint backlight_register_notifier(struct notifier_block *nb);\nint backlight_unregister_notifier(struct notifier_block *nb);\nstruct backlight_device *backlight_device_get_by_name(const char *name);\nstruct backlight_device *backlight_device_get_by_type(enum backlight_type type);\nint backlight_device_set_brightness(struct backlight_device *bd,\n\t\t\t\t    unsigned long brightness);\n\n#define to_backlight_device(obj) container_of(obj, struct backlight_device, dev)\n\n \nstatic inline void * bl_get_data(struct backlight_device *bl_dev)\n{\n\treturn dev_get_drvdata(&bl_dev->dev);\n}\n\n#ifdef CONFIG_OF\nstruct backlight_device *of_find_backlight_by_node(struct device_node *node);\n#else\nstatic inline struct backlight_device *\nof_find_backlight_by_node(struct device_node *node)\n{\n\treturn NULL;\n}\n#endif\n\n#if IS_ENABLED(CONFIG_BACKLIGHT_CLASS_DEVICE)\nstruct backlight_device *devm_of_find_backlight(struct device *dev);\n#else\nstatic inline struct backlight_device *\ndevm_of_find_backlight(struct device *dev)\n{\n\treturn NULL;\n}\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}