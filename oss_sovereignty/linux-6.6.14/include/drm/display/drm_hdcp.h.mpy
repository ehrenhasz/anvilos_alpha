{
  "module_name": "drm_hdcp.h",
  "hash_id": "3392711f0305c805d951352e081135e8b2f4d49d366fc35af1656d1df7feaf2f",
  "original_prompt": "Ingested from linux-6.6.14/include/drm/display/drm_hdcp.h",
  "human_readable_source": " \n \n\n#ifndef _DRM_HDCP_H_\n#define _DRM_HDCP_H_\n\n#include <linux/types.h>\n\n \n#define DRM_HDCP_CHECK_PERIOD_MS\t\t(128 * 16)\n#define DRM_HDCP2_CHECK_PERIOD_MS\t\t500\n\n \n#define DRM_HDCP_AN_LEN\t\t\t\t8\n#define DRM_HDCP_BSTATUS_LEN\t\t\t2\n#define DRM_HDCP_KSV_LEN\t\t\t5\n#define DRM_HDCP_RI_LEN\t\t\t\t2\n#define DRM_HDCP_V_PRIME_PART_LEN\t\t4\n#define DRM_HDCP_V_PRIME_NUM_PARTS\t\t5\n#define DRM_HDCP_NUM_DOWNSTREAM(x)\t\t(x & 0x7f)\n#define DRM_HDCP_MAX_CASCADE_EXCEEDED(x)\t(x & BIT(3))\n#define DRM_HDCP_MAX_DEVICE_EXCEEDED(x)\t\t(x & BIT(7))\n\n \n#define DRM_HDCP_DDC_ADDR\t\t\t0x3A\n\n \n#define DRM_HDCP_SHA1_TERMINATOR\t\t0x80\n\n \n#define DRM_HDCP_DDC_BKSV\t\t\t0x00\n#define DRM_HDCP_DDC_RI_PRIME\t\t\t0x08\n#define DRM_HDCP_DDC_AKSV\t\t\t0x10\n#define DRM_HDCP_DDC_AN\t\t\t\t0x18\n#define DRM_HDCP_DDC_V_PRIME(h)\t\t\t(0x20 + h * 4)\n#define DRM_HDCP_DDC_BCAPS\t\t\t0x40\n#define  DRM_HDCP_DDC_BCAPS_REPEATER_PRESENT\tBIT(6)\n#define  DRM_HDCP_DDC_BCAPS_KSV_FIFO_READY\tBIT(5)\n#define DRM_HDCP_DDC_BSTATUS\t\t\t0x41\n#define DRM_HDCP_DDC_KSV_FIFO\t\t\t0x43\n\n#define DRM_HDCP_1_4_SRM_ID\t\t\t0x8\n#define DRM_HDCP_1_4_VRL_LENGTH_SIZE\t\t3\n#define DRM_HDCP_1_4_DCP_SIG_SIZE\t\t40\n\n \n \n#define HDCP_STREAM_TYPE0\t\t\t0x00\n#define HDCP_STREAM_TYPE1\t\t\t0x01\n\n \n#define HDCP_2_2_NULL_MSG\t\t\t1\n#define HDCP_2_2_AKE_INIT\t\t\t2\n#define HDCP_2_2_AKE_SEND_CERT\t\t\t3\n#define HDCP_2_2_AKE_NO_STORED_KM\t\t4\n#define HDCP_2_2_AKE_STORED_KM\t\t\t5\n#define HDCP_2_2_AKE_SEND_HPRIME\t\t7\n#define HDCP_2_2_AKE_SEND_PAIRING_INFO\t\t8\n#define HDCP_2_2_LC_INIT\t\t\t9\n#define HDCP_2_2_LC_SEND_LPRIME\t\t\t10\n#define HDCP_2_2_SKE_SEND_EKS\t\t\t11\n#define HDCP_2_2_REP_SEND_RECVID_LIST\t\t12\n#define HDCP_2_2_REP_SEND_ACK\t\t\t15\n#define HDCP_2_2_REP_STREAM_MANAGE\t\t16\n#define HDCP_2_2_REP_STREAM_READY\t\t17\n\n#define HDCP_2_2_RTX_LEN\t\t\t8\n#define HDCP_2_2_RRX_LEN\t\t\t8\n\n#define HDCP_2_2_K_PUB_RX_MOD_N_LEN\t\t128\n#define HDCP_2_2_K_PUB_RX_EXP_E_LEN\t\t3\n#define HDCP_2_2_K_PUB_RX_LEN\t\t\t(HDCP_2_2_K_PUB_RX_MOD_N_LEN + \\\n\t\t\t\t\t\t HDCP_2_2_K_PUB_RX_EXP_E_LEN)\n\n#define HDCP_2_2_DCP_LLC_SIG_LEN\t\t384\n\n#define HDCP_2_2_E_KPUB_KM_LEN\t\t\t128\n#define HDCP_2_2_E_KH_KM_M_LEN\t\t\t(16 + 16)\n#define HDCP_2_2_H_PRIME_LEN\t\t\t32\n#define HDCP_2_2_E_KH_KM_LEN\t\t\t16\n#define HDCP_2_2_RN_LEN\t\t\t\t8\n#define HDCP_2_2_L_PRIME_LEN\t\t\t32\n#define HDCP_2_2_E_DKEY_KS_LEN\t\t\t16\n#define HDCP_2_2_RIV_LEN\t\t\t8\n#define HDCP_2_2_SEQ_NUM_LEN\t\t\t3\n#define HDCP_2_2_V_PRIME_HALF_LEN\t\t(HDCP_2_2_L_PRIME_LEN / 2)\n#define HDCP_2_2_RECEIVER_ID_LEN\t\tDRM_HDCP_KSV_LEN\n#define HDCP_2_2_MAX_DEVICE_COUNT\t\t31\n#define HDCP_2_2_RECEIVER_IDS_MAX_LEN\t\t(HDCP_2_2_RECEIVER_ID_LEN * \\\n\t\t\t\t\t\t HDCP_2_2_MAX_DEVICE_COUNT)\n#define HDCP_2_2_MPRIME_LEN\t\t\t32\n\n \n \n#define HDCP_2_2_MAX_CONTENT_STREAMS_CNT\t4\n#define HDCP_2_2_TXCAP_MASK_LEN\t\t\t2\n#define HDCP_2_2_RXCAPS_LEN\t\t\t3\n#define HDCP_2_2_RX_REPEATER(x)\t\t\t((x) & BIT(0))\n#define HDCP_2_2_DP_HDCP_CAPABLE(x)\t\t((x) & BIT(1))\n#define HDCP_2_2_RXINFO_LEN\t\t\t2\n\n \n#define HDCP_2_2_HDCP1_DEVICE_CONNECTED(x)\t((x) & BIT(0))\n\n \n#define HDCP_2_2_HDCP_2_0_REP_CONNECTED(x)\t((x) & BIT(1))\n#define HDCP_2_2_MAX_CASCADE_EXCEEDED(x)\t((x) & BIT(2))\n#define HDCP_2_2_MAX_DEVS_EXCEEDED(x)\t\t((x) & BIT(3))\n#define HDCP_2_2_DEV_COUNT_LO(x)\t\t(((x) & (0xF << 4)) >> 4)\n#define HDCP_2_2_DEV_COUNT_HI(x)\t\t((x) & BIT(0))\n#define HDCP_2_2_DEPTH(x)\t\t\t(((x) & (0x7 << 1)) >> 1)\n\nstruct hdcp2_cert_rx {\n\tu8\treceiver_id[HDCP_2_2_RECEIVER_ID_LEN];\n\tu8\tkpub_rx[HDCP_2_2_K_PUB_RX_LEN];\n\tu8\treserved[2];\n\tu8\tdcp_signature[HDCP_2_2_DCP_LLC_SIG_LEN];\n} __packed;\n\nstruct hdcp2_streamid_type {\n\tu8\tstream_id;\n\tu8\tstream_type;\n} __packed;\n\n \nstruct hdcp2_tx_caps {\n\t \n\tu8\tversion;\n\n\t \n\tu8\ttx_cap_mask[HDCP_2_2_TXCAP_MASK_LEN];\n} __packed;\n\n \nstruct hdcp2_ake_init {\n\tu8\t\t\tmsg_id;\n\tu8\t\t\tr_tx[HDCP_2_2_RTX_LEN];\n\tstruct hdcp2_tx_caps\ttx_caps;\n} __packed;\n\nstruct hdcp2_ake_send_cert {\n\tu8\t\t\tmsg_id;\n\tstruct hdcp2_cert_rx\tcert_rx;\n\tu8\t\t\tr_rx[HDCP_2_2_RRX_LEN];\n\tu8\t\t\trx_caps[HDCP_2_2_RXCAPS_LEN];\n} __packed;\n\nstruct hdcp2_ake_no_stored_km {\n\tu8\tmsg_id;\n\tu8\te_kpub_km[HDCP_2_2_E_KPUB_KM_LEN];\n} __packed;\n\nstruct hdcp2_ake_stored_km {\n\tu8\tmsg_id;\n\tu8\te_kh_km_m[HDCP_2_2_E_KH_KM_M_LEN];\n} __packed;\n\nstruct hdcp2_ake_send_hprime {\n\tu8\tmsg_id;\n\tu8\th_prime[HDCP_2_2_H_PRIME_LEN];\n} __packed;\n\nstruct hdcp2_ake_send_pairing_info {\n\tu8\tmsg_id;\n\tu8\te_kh_km[HDCP_2_2_E_KH_KM_LEN];\n} __packed;\n\nstruct hdcp2_lc_init {\n\tu8\tmsg_id;\n\tu8\tr_n[HDCP_2_2_RN_LEN];\n} __packed;\n\nstruct hdcp2_lc_send_lprime {\n\tu8\tmsg_id;\n\tu8\tl_prime[HDCP_2_2_L_PRIME_LEN];\n} __packed;\n\nstruct hdcp2_ske_send_eks {\n\tu8\tmsg_id;\n\tu8\te_dkey_ks[HDCP_2_2_E_DKEY_KS_LEN];\n\tu8\triv[HDCP_2_2_RIV_LEN];\n} __packed;\n\nstruct hdcp2_rep_send_receiverid_list {\n\tu8\tmsg_id;\n\tu8\trx_info[HDCP_2_2_RXINFO_LEN];\n\tu8\tseq_num_v[HDCP_2_2_SEQ_NUM_LEN];\n\tu8\tv_prime[HDCP_2_2_V_PRIME_HALF_LEN];\n\tu8\treceiver_ids[HDCP_2_2_RECEIVER_IDS_MAX_LEN];\n} __packed;\n\nstruct hdcp2_rep_send_ack {\n\tu8\tmsg_id;\n\tu8\tv[HDCP_2_2_V_PRIME_HALF_LEN];\n} __packed;\n\nstruct hdcp2_rep_stream_manage {\n\tu8\t\t\tmsg_id;\n\tu8\t\t\tseq_num_m[HDCP_2_2_SEQ_NUM_LEN];\n\t__be16\t\t\tk;\n\tstruct hdcp2_streamid_type streams[HDCP_2_2_MAX_CONTENT_STREAMS_CNT];\n} __packed;\n\nstruct hdcp2_rep_stream_ready {\n\tu8\tmsg_id;\n\tu8\tm_prime[HDCP_2_2_MPRIME_LEN];\n} __packed;\n\n \n#define HDCP_2_2_CERT_TIMEOUT_MS\t\t100\n#define HDCP_2_2_DP_CERT_READ_TIMEOUT_MS\t110\n#define HDCP_2_2_HPRIME_NO_PAIRED_TIMEOUT_MS\t1000\n#define HDCP_2_2_HPRIME_PAIRED_TIMEOUT_MS\t200\n#define HDCP_2_2_DP_HPRIME_READ_TIMEOUT_MS\t7\n#define HDCP_2_2_PAIRING_TIMEOUT_MS\t\t200\n#define HDCP_2_2_DP_PAIRING_READ_TIMEOUT_MS\t5\n#define\tHDCP_2_2_HDMI_LPRIME_TIMEOUT_MS\t\t20\n#define HDCP_2_2_DP_LPRIME_TIMEOUT_MS\t\t16\n#define HDCP_2_2_RECVID_LIST_TIMEOUT_MS\t\t3000\n#define HDCP_2_2_STREAM_READY_TIMEOUT_MS\t100\n\n \n#define HDCP_2_2_HDMI_REG_VER_OFFSET\t\t0x50\n#define HDCP_2_2_HDMI_REG_WR_MSG_OFFSET\t\t0x60\n#define HDCP_2_2_HDMI_REG_RXSTATUS_OFFSET\t0x70\n#define HDCP_2_2_HDMI_REG_RD_MSG_OFFSET\t\t0x80\n#define HDCP_2_2_HDMI_REG_DBG_OFFSET\t\t0xC0\n\n#define HDCP_2_2_HDMI_SUPPORT_MASK\t\tBIT(2)\n#define HDCP_2_2_RX_CAPS_VERSION_VAL\t\t0x02\n#define HDCP_2_2_SEQ_NUM_MAX\t\t\t0xFFFFFF\n#define\tHDCP_2_2_DELAY_BEFORE_ENCRYPTION_EN\t200\n\n \n#define HDCP_2_2_HDMI_RXSTATUS_LEN\t\t2\n#define HDCP_2_2_HDMI_RXSTATUS_MSG_SZ_HI(x)\t((x) & 0x3)\n#define HDCP_2_2_HDMI_RXSTATUS_READY(x)\t\t((x) & BIT(2))\n#define HDCP_2_2_HDMI_RXSTATUS_REAUTH_REQ(x)\t((x) & BIT(3))\n\n \nstatic inline\nu32 drm_hdcp_be24_to_cpu(const u8 seq_num[HDCP_2_2_SEQ_NUM_LEN])\n{\n\treturn (u32)(seq_num[2] | seq_num[1] << 8 | seq_num[0] << 16);\n}\n\nstatic inline\nvoid drm_hdcp_cpu_to_be24(u8 seq_num[HDCP_2_2_SEQ_NUM_LEN], u32 val)\n{\n\tseq_num[0] = val >> 16;\n\tseq_num[1] = val >> 8;\n\tseq_num[2] = val;\n}\n\n#define DRM_HDCP_SRM_GEN1_MAX_BYTES\t\t(5 * 1024)\n#define DRM_HDCP_1_4_SRM_ID\t\t\t0x8\n#define DRM_HDCP_SRM_ID_MASK\t\t\t(0xF << 4)\n#define DRM_HDCP_1_4_VRL_LENGTH_SIZE\t\t3\n#define DRM_HDCP_1_4_DCP_SIG_SIZE\t\t40\n#define DRM_HDCP_2_SRM_ID\t\t\t0x9\n#define DRM_HDCP_2_INDICATOR\t\t\t0x1\n#define DRM_HDCP_2_INDICATOR_MASK\t\t0xF\n#define DRM_HDCP_2_VRL_LENGTH_SIZE\t\t3\n#define DRM_HDCP_2_DCP_SIG_SIZE\t\t\t384\n#define DRM_HDCP_2_NO_OF_DEV_PLUS_RESERVED_SZ\t4\n#define DRM_HDCP_2_KSV_COUNT_2_LSBITS(byte)\t(((byte) & 0xC0) >> 6)\n\nstruct hdcp_srm_header {\n\tu8 srm_id;\n\tu8 reserved;\n\t__be16 srm_version;\n\tu8 srm_gen_no;\n} __packed;\n\n \n#define DRM_MODE_HDCP_CONTENT_TYPE0\t\t0\n#define DRM_MODE_HDCP_CONTENT_TYPE1\t\t1\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}