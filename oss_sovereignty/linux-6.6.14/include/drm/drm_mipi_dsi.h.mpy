{
  "module_name": "drm_mipi_dsi.h",
  "hash_id": "af2c2bb84730a5a0c4b7021a511e6dc6932ce37e9de6fc91d9eb5651fa916bed",
  "original_prompt": "Ingested from linux-6.6.14/include/drm/drm_mipi_dsi.h",
  "human_readable_source": " \n \n\n#ifndef __DRM_MIPI_DSI_H__\n#define __DRM_MIPI_DSI_H__\n\n#include <linux/device.h>\n\nstruct mipi_dsi_host;\nstruct mipi_dsi_device;\nstruct drm_dsc_picture_parameter_set;\n\n \n#define MIPI_DSI_MSG_REQ_ACK\tBIT(0)\n \n#define MIPI_DSI_MSG_USE_LPM\tBIT(1)\n\n \nstruct mipi_dsi_msg {\n\tu8 channel;\n\tu8 type;\n\tu16 flags;\n\n\tsize_t tx_len;\n\tconst void *tx_buf;\n\n\tsize_t rx_len;\n\tvoid *rx_buf;\n};\n\nbool mipi_dsi_packet_format_is_short(u8 type);\nbool mipi_dsi_packet_format_is_long(u8 type);\n\n \nstruct mipi_dsi_packet {\n\tsize_t size;\n\tu8 header[4];\n\tsize_t payload_length;\n\tconst u8 *payload;\n};\n\nint mipi_dsi_create_packet(struct mipi_dsi_packet *packet,\n\t\t\t   const struct mipi_dsi_msg *msg);\n\n \nstruct mipi_dsi_host_ops {\n\tint (*attach)(struct mipi_dsi_host *host,\n\t\t      struct mipi_dsi_device *dsi);\n\tint (*detach)(struct mipi_dsi_host *host,\n\t\t      struct mipi_dsi_device *dsi);\n\tssize_t (*transfer)(struct mipi_dsi_host *host,\n\t\t\t    const struct mipi_dsi_msg *msg);\n};\n\n \nstruct mipi_dsi_host {\n\tstruct device *dev;\n\tconst struct mipi_dsi_host_ops *ops;\n\tstruct list_head list;\n};\n\nint mipi_dsi_host_register(struct mipi_dsi_host *host);\nvoid mipi_dsi_host_unregister(struct mipi_dsi_host *host);\nstruct mipi_dsi_host *of_find_mipi_dsi_host_by_node(struct device_node *node);\n\n \n\n \n#define MIPI_DSI_MODE_VIDEO\t\tBIT(0)\n \n#define MIPI_DSI_MODE_VIDEO_BURST\tBIT(1)\n \n#define MIPI_DSI_MODE_VIDEO_SYNC_PULSE\tBIT(2)\n \n#define MIPI_DSI_MODE_VIDEO_AUTO_VERT\tBIT(3)\n \n#define MIPI_DSI_MODE_VIDEO_HSE\t\tBIT(4)\n \n#define MIPI_DSI_MODE_VIDEO_NO_HFP\tBIT(5)\n \n#define MIPI_DSI_MODE_VIDEO_NO_HBP\tBIT(6)\n \n#define MIPI_DSI_MODE_VIDEO_NO_HSA\tBIT(7)\n \n#define MIPI_DSI_MODE_VSYNC_FLUSH\tBIT(8)\n \n#define MIPI_DSI_MODE_NO_EOT_PACKET\tBIT(9)\n \n#define MIPI_DSI_CLOCK_NON_CONTINUOUS\tBIT(10)\n \n#define MIPI_DSI_MODE_LPM\t\tBIT(11)\n \n#define MIPI_DSI_HS_PKT_END_ALIGNED\tBIT(12)\n\nenum mipi_dsi_pixel_format {\n\tMIPI_DSI_FMT_RGB888,\n\tMIPI_DSI_FMT_RGB666,\n\tMIPI_DSI_FMT_RGB666_PACKED,\n\tMIPI_DSI_FMT_RGB565,\n};\n\n#define DSI_DEV_NAME_SIZE\t\t20\n\n \nstruct mipi_dsi_device_info {\n\tchar type[DSI_DEV_NAME_SIZE];\n\tu32 channel;\n\tstruct device_node *node;\n};\n\n \nstruct mipi_dsi_device {\n\tstruct mipi_dsi_host *host;\n\tstruct device dev;\n\n\tchar name[DSI_DEV_NAME_SIZE];\n\tunsigned int channel;\n\tunsigned int lanes;\n\tenum mipi_dsi_pixel_format format;\n\tunsigned long mode_flags;\n\tunsigned long hs_rate;\n\tunsigned long lp_rate;\n\tstruct drm_dsc_config *dsc;\n};\n\n#define MIPI_DSI_MODULE_PREFIX \"mipi-dsi:\"\n\n#define to_mipi_dsi_device(__dev)\tcontainer_of_const(__dev, struct mipi_dsi_device, dev)\n\n \nstatic inline int mipi_dsi_pixel_format_to_bpp(enum mipi_dsi_pixel_format fmt)\n{\n\tswitch (fmt) {\n\tcase MIPI_DSI_FMT_RGB888:\n\tcase MIPI_DSI_FMT_RGB666:\n\t\treturn 24;\n\n\tcase MIPI_DSI_FMT_RGB666_PACKED:\n\t\treturn 18;\n\n\tcase MIPI_DSI_FMT_RGB565:\n\t\treturn 16;\n\t}\n\n\treturn -EINVAL;\n}\n\nstruct mipi_dsi_device *\nmipi_dsi_device_register_full(struct mipi_dsi_host *host,\n\t\t\t      const struct mipi_dsi_device_info *info);\nvoid mipi_dsi_device_unregister(struct mipi_dsi_device *dsi);\nstruct mipi_dsi_device *\ndevm_mipi_dsi_device_register_full(struct device *dev, struct mipi_dsi_host *host,\n\t\t\t\t   const struct mipi_dsi_device_info *info);\nstruct mipi_dsi_device *of_find_mipi_dsi_device_by_node(struct device_node *np);\nint mipi_dsi_attach(struct mipi_dsi_device *dsi);\nint mipi_dsi_detach(struct mipi_dsi_device *dsi);\nint devm_mipi_dsi_attach(struct device *dev, struct mipi_dsi_device *dsi);\nint mipi_dsi_shutdown_peripheral(struct mipi_dsi_device *dsi);\nint mipi_dsi_turn_on_peripheral(struct mipi_dsi_device *dsi);\nint mipi_dsi_set_maximum_return_packet_size(struct mipi_dsi_device *dsi,\n\t\t\t\t\t    u16 value);\nssize_t mipi_dsi_compression_mode(struct mipi_dsi_device *dsi, bool enable);\nssize_t mipi_dsi_picture_parameter_set(struct mipi_dsi_device *dsi,\n\t\t\t\t       const struct drm_dsc_picture_parameter_set *pps);\n\nssize_t mipi_dsi_generic_write(struct mipi_dsi_device *dsi, const void *payload,\n\t\t\t       size_t size);\nssize_t mipi_dsi_generic_read(struct mipi_dsi_device *dsi, const void *params,\n\t\t\t      size_t num_params, void *data, size_t size);\n\n \nenum mipi_dsi_dcs_tear_mode {\n\tMIPI_DSI_DCS_TEAR_MODE_VBLANK,\n\tMIPI_DSI_DCS_TEAR_MODE_VHBLANK,\n};\n\n#define MIPI_DSI_DCS_POWER_MODE_DISPLAY (1 << 2)\n#define MIPI_DSI_DCS_POWER_MODE_NORMAL  (1 << 3)\n#define MIPI_DSI_DCS_POWER_MODE_SLEEP   (1 << 4)\n#define MIPI_DSI_DCS_POWER_MODE_PARTIAL (1 << 5)\n#define MIPI_DSI_DCS_POWER_MODE_IDLE    (1 << 6)\n\nssize_t mipi_dsi_dcs_write_buffer(struct mipi_dsi_device *dsi,\n\t\t\t\t  const void *data, size_t len);\nssize_t mipi_dsi_dcs_write(struct mipi_dsi_device *dsi, u8 cmd,\n\t\t\t   const void *data, size_t len);\nssize_t mipi_dsi_dcs_read(struct mipi_dsi_device *dsi, u8 cmd, void *data,\n\t\t\t  size_t len);\nint mipi_dsi_dcs_nop(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_soft_reset(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_get_power_mode(struct mipi_dsi_device *dsi, u8 *mode);\nint mipi_dsi_dcs_get_pixel_format(struct mipi_dsi_device *dsi, u8 *format);\nint mipi_dsi_dcs_enter_sleep_mode(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_exit_sleep_mode(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_set_display_off(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_set_display_on(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_set_column_address(struct mipi_dsi_device *dsi, u16 start,\n\t\t\t\t    u16 end);\nint mipi_dsi_dcs_set_page_address(struct mipi_dsi_device *dsi, u16 start,\n\t\t\t\t  u16 end);\nint mipi_dsi_dcs_set_tear_off(struct mipi_dsi_device *dsi);\nint mipi_dsi_dcs_set_tear_on(struct mipi_dsi_device *dsi,\n\t\t\t     enum mipi_dsi_dcs_tear_mode mode);\nint mipi_dsi_dcs_set_pixel_format(struct mipi_dsi_device *dsi, u8 format);\nint mipi_dsi_dcs_set_tear_scanline(struct mipi_dsi_device *dsi, u16 scanline);\nint mipi_dsi_dcs_set_display_brightness(struct mipi_dsi_device *dsi,\n\t\t\t\t\tu16 brightness);\nint mipi_dsi_dcs_get_display_brightness(struct mipi_dsi_device *dsi,\n\t\t\t\t\tu16 *brightness);\nint mipi_dsi_dcs_set_display_brightness_large(struct mipi_dsi_device *dsi,\n\t\t\t\t\t     u16 brightness);\nint mipi_dsi_dcs_get_display_brightness_large(struct mipi_dsi_device *dsi,\n\t\t\t\t\t     u16 *brightness);\n\n \n#define mipi_dsi_generic_write_seq(dsi, seq...)                                \\\n\tdo {                                                                   \\\n\t\tstatic const u8 d[] = { seq };                                 \\\n\t\tstruct device *dev = &dsi->dev;                                \\\n\t\tint ret;                                                       \\\n\t\tret = mipi_dsi_generic_write(dsi, d, ARRAY_SIZE(d));           \\\n\t\tif (ret < 0) {                                                 \\\n\t\t\tdev_err_ratelimited(dev, \"transmit data failed: %d\\n\", \\\n\t\t\t\t\t    ret);                              \\\n\t\t\treturn ret;                                            \\\n\t\t}                                                              \\\n\t} while (0)\n\n \n#define mipi_dsi_dcs_write_seq(dsi, cmd, seq...)                           \\\n\tdo {                                                               \\\n\t\tstatic const u8 d[] = { cmd, seq };                        \\\n\t\tstruct device *dev = &dsi->dev;                            \\\n\t\tint ret;                                                   \\\n\t\tret = mipi_dsi_dcs_write_buffer(dsi, d, ARRAY_SIZE(d));    \\\n\t\tif (ret < 0) {                                             \\\n\t\t\tdev_err_ratelimited(                               \\\n\t\t\t\tdev, \"sending command %#02x failed: %d\\n\", \\\n\t\t\t\tcmd, ret);                                 \\\n\t\t\treturn ret;                                        \\\n\t\t}                                                          \\\n\t} while (0)\n\n \nstruct mipi_dsi_driver {\n\tstruct device_driver driver;\n\tint(*probe)(struct mipi_dsi_device *dsi);\n\tvoid (*remove)(struct mipi_dsi_device *dsi);\n\tvoid (*shutdown)(struct mipi_dsi_device *dsi);\n};\n\nstatic inline struct mipi_dsi_driver *\nto_mipi_dsi_driver(struct device_driver *driver)\n{\n\treturn container_of(driver, struct mipi_dsi_driver, driver);\n}\n\nstatic inline void *mipi_dsi_get_drvdata(const struct mipi_dsi_device *dsi)\n{\n\treturn dev_get_drvdata(&dsi->dev);\n}\n\nstatic inline void mipi_dsi_set_drvdata(struct mipi_dsi_device *dsi, void *data)\n{\n\tdev_set_drvdata(&dsi->dev, data);\n}\n\nint mipi_dsi_driver_register_full(struct mipi_dsi_driver *driver,\n\t\t\t\t  struct module *owner);\nvoid mipi_dsi_driver_unregister(struct mipi_dsi_driver *driver);\n\n#define mipi_dsi_driver_register(driver) \\\n\tmipi_dsi_driver_register_full(driver, THIS_MODULE)\n\n#define module_mipi_dsi_driver(__mipi_dsi_driver) \\\n\tmodule_driver(__mipi_dsi_driver, mipi_dsi_driver_register, \\\n\t\t\tmipi_dsi_driver_unregister)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}