{
  "module_name": "drm_framebuffer.h",
  "hash_id": "c55e8d989d024fbe94905467009e92c103ef0db945784a80cd6ccf59eb46b393",
  "original_prompt": "Ingested from linux-6.6.14/include/drm/drm_framebuffer.h",
  "human_readable_source": " \n\n#ifndef __DRM_FRAMEBUFFER_H__\n#define __DRM_FRAMEBUFFER_H__\n\n#include <linux/ctype.h>\n#include <linux/list.h>\n#include <linux/sched.h>\n\n#include <drm/drm_fourcc.h>\n#include <drm/drm_mode_object.h>\n\nstruct drm_clip_rect;\nstruct drm_device;\nstruct drm_file;\nstruct drm_framebuffer;\nstruct drm_gem_object;\n\n \nstruct drm_framebuffer_funcs {\n\t \n\tvoid (*destroy)(struct drm_framebuffer *framebuffer);\n\n\t \n\tint (*create_handle)(struct drm_framebuffer *fb,\n\t\t\t     struct drm_file *file_priv,\n\t\t\t     unsigned int *handle);\n\t \n\tint (*dirty)(struct drm_framebuffer *framebuffer,\n\t\t     struct drm_file *file_priv, unsigned flags,\n\t\t     unsigned color, struct drm_clip_rect *clips,\n\t\t     unsigned num_clips);\n};\n\n \nstruct drm_framebuffer {\n\t \n\tstruct drm_device *dev;\n\t \n\tstruct list_head head;\n\n\t \n\tstruct drm_mode_object base;\n\n\t \n\tchar comm[TASK_COMM_LEN];\n\n\t \n\tconst struct drm_format_info *format;\n\t \n\tconst struct drm_framebuffer_funcs *funcs;\n\t \n\tunsigned int pitches[DRM_FORMAT_MAX_PLANES];\n\t \n\tunsigned int offsets[DRM_FORMAT_MAX_PLANES];\n\t \n\tuint64_t modifier;\n\t \n\tunsigned int width;\n\t \n\tunsigned int height;\n\t \n\tint flags;\n\t \n\tint hot_x;\n\t \n\tint hot_y;\n\t \n\tstruct list_head filp_head;\n\t \n\tstruct drm_gem_object *obj[DRM_FORMAT_MAX_PLANES];\n};\n\n#define obj_to_fb(x) container_of(x, struct drm_framebuffer, base)\n\nint drm_framebuffer_init(struct drm_device *dev,\n\t\t\t struct drm_framebuffer *fb,\n\t\t\t const struct drm_framebuffer_funcs *funcs);\nstruct drm_framebuffer *drm_framebuffer_lookup(struct drm_device *dev,\n\t\t\t\t\t       struct drm_file *file_priv,\n\t\t\t\t\t       uint32_t id);\nvoid drm_framebuffer_remove(struct drm_framebuffer *fb);\nvoid drm_framebuffer_cleanup(struct drm_framebuffer *fb);\nvoid drm_framebuffer_unregister_private(struct drm_framebuffer *fb);\n\n \nstatic inline void drm_framebuffer_get(struct drm_framebuffer *fb)\n{\n\tdrm_mode_object_get(&fb->base);\n}\n\n \nstatic inline void drm_framebuffer_put(struct drm_framebuffer *fb)\n{\n\tdrm_mode_object_put(&fb->base);\n}\n\n \nstatic inline uint32_t drm_framebuffer_read_refcount(const struct drm_framebuffer *fb)\n{\n\treturn kref_read(&fb->base.refcount);\n}\n\n \nstatic inline void drm_framebuffer_assign(struct drm_framebuffer **p,\n\t\t\t\t\t  struct drm_framebuffer *fb)\n{\n\tif (fb)\n\t\tdrm_framebuffer_get(fb);\n\tif (*p)\n\t\tdrm_framebuffer_put(*p);\n\t*p = fb;\n}\n\n \n#define drm_for_each_fb(fb, dev) \\\n\tfor (WARN_ON(!mutex_is_locked(&(dev)->mode_config.fb_lock)),\t\t\\\n\t     fb = list_first_entry(&(dev)->mode_config.fb_list,\t\\\n\t\t\t\t\t  struct drm_framebuffer, head);\t\\\n\t     &fb->head != (&(dev)->mode_config.fb_list);\t\t\t\\\n\t     fb = list_next_entry(fb, head))\n\nint drm_framebuffer_plane_width(int width,\n\t\t\t\tconst struct drm_framebuffer *fb, int plane);\nint drm_framebuffer_plane_height(int height,\n\t\t\t\t const struct drm_framebuffer *fb, int plane);\n\n \nstruct drm_afbc_framebuffer {\n\t \n\tstruct drm_framebuffer base;\n\t \n\tu32 block_width;\n\t \n\tu32 block_height;\n\t \n\tu32 aligned_width;\n\t \n\tu32 aligned_height;\n\t \n\tu32 offset;\n\t \n\tu32 afbc_size;\n};\n\n#define fb_to_afbc_fb(x) container_of(x, struct drm_afbc_framebuffer, base)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}