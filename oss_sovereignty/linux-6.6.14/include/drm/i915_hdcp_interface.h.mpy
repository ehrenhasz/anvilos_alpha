{
  "module_name": "i915_hdcp_interface.h",
  "hash_id": "1a30747311736dc1634245a30ee2d3c111c1cf91fd56f12ef5ecd9cfcd084854",
  "original_prompt": "Ingested from linux-6.6.14/include/drm/i915_hdcp_interface.h",
  "human_readable_source": " \n \n\n#ifndef _I915_HDCP_INTERFACE_H_\n#define _I915_HDCP_INTERFACE_H_\n\n#include <linux/mutex.h>\n#include <linux/device.h>\n#include <drm/display/drm_hdcp.h>\n\n \nenum hdcp_port_type {\n\tHDCP_PORT_TYPE_INVALID,\n\tHDCP_PORT_TYPE_INTEGRATED,\n\tHDCP_PORT_TYPE_LSPCON,\n\tHDCP_PORT_TYPE_CPDP\n};\n\n \nenum hdcp_wired_protocol {\n\tHDCP_PROTOCOL_INVALID,\n\tHDCP_PROTOCOL_HDMI,\n\tHDCP_PROTOCOL_DP\n};\n\nenum hdcp_ddi {\n\tHDCP_DDI_INVALID_PORT = 0x0,\n\n\tHDCP_DDI_B = 1,\n\tHDCP_DDI_C,\n\tHDCP_DDI_D,\n\tHDCP_DDI_E,\n\tHDCP_DDI_F,\n\tHDCP_DDI_A = 7,\n\tHDCP_DDI_RANGE_END = HDCP_DDI_A,\n};\n\n \nenum hdcp_transcoder {\n\tHDCP_INVALID_TRANSCODER = 0x00,\n\tHDCP_TRANSCODER_EDP,\n\tHDCP_TRANSCODER_DSI0,\n\tHDCP_TRANSCODER_DSI1,\n\tHDCP_TRANSCODER_A = 0x10,\n\tHDCP_TRANSCODER_B,\n\tHDCP_TRANSCODER_C,\n\tHDCP_TRANSCODER_D\n};\n\n \nstruct hdcp_port_data {\n\tenum hdcp_ddi hdcp_ddi;\n\tenum hdcp_transcoder hdcp_transcoder;\n\tu8 port_type;\n\tu8 protocol;\n\tu16 k;\n\tu32 seq_num_m;\n\tstruct hdcp2_streamid_type *streams;\n};\n\n \nstruct i915_hdcp_ops {\n\t \n\tstruct module *owner;\n\n\tint (*initiate_hdcp2_session)(struct device *dev,\n\t\t\t\t      struct hdcp_port_data *data,\n\t\t\t\t      struct hdcp2_ake_init *ake_data);\n\tint (*verify_receiver_cert_prepare_km)(struct device *dev,\n\t\t\t\t\t       struct hdcp_port_data *data,\n\t\t\t\t\t       struct hdcp2_ake_send_cert\n\t\t\t\t\t\t\t\t*rx_cert,\n\t\t\t\t\t       bool *km_stored,\n\t\t\t\t\t       struct hdcp2_ake_no_stored_km\n\t\t\t\t\t\t\t\t*ek_pub_km,\n\t\t\t\t\t       size_t *msg_sz);\n\tint (*verify_hprime)(struct device *dev,\n\t\t\t     struct hdcp_port_data *data,\n\t\t\t     struct hdcp2_ake_send_hprime *rx_hprime);\n\tint (*store_pairing_info)(struct device *dev,\n\t\t\t\t  struct hdcp_port_data *data,\n\t\t\t\t  struct hdcp2_ake_send_pairing_info\n\t\t\t\t\t\t\t\t*pairing_info);\n\tint (*initiate_locality_check)(struct device *dev,\n\t\t\t\t       struct hdcp_port_data *data,\n\t\t\t\t       struct hdcp2_lc_init *lc_init_data);\n\tint (*verify_lprime)(struct device *dev,\n\t\t\t     struct hdcp_port_data *data,\n\t\t\t     struct hdcp2_lc_send_lprime *rx_lprime);\n\tint (*get_session_key)(struct device *dev,\n\t\t\t       struct hdcp_port_data *data,\n\t\t\t       struct hdcp2_ske_send_eks *ske_data);\n\tint (*repeater_check_flow_prepare_ack)(struct device *dev,\n\t\t\t\t\t       struct hdcp_port_data *data,\n\t\t\t\t\t       struct hdcp2_rep_send_receiverid_list\n\t\t\t\t\t\t\t\t*rep_topology,\n\t\t\t\t\t       struct hdcp2_rep_send_ack\n\t\t\t\t\t\t\t\t*rep_send_ack);\n\tint (*verify_mprime)(struct device *dev,\n\t\t\t     struct hdcp_port_data *data,\n\t\t\t     struct hdcp2_rep_stream_ready *stream_ready);\n\tint (*enable_hdcp_authentication)(struct device *dev,\n\t\t\t\t\t  struct hdcp_port_data *data);\n\tint (*close_hdcp_session)(struct device *dev,\n\t\t\t\t  struct hdcp_port_data *data);\n};\n\n \nstruct i915_hdcp_arbiter {\n\tstruct device *hdcp_dev;\n\tconst struct i915_hdcp_ops *ops;\n\n\t \n\tstruct mutex mutex;\n};\n\n \nenum fw_hdcp_status {\n\tFW_HDCP_STATUS_SUCCESS\t\t\t= 0x0000,\n\n\t \n\tFW_HDCP_STATUS_INTERNAL_ERROR\t\t= 0x1000,\n\tFW_HDCP_STATUS_UNKNOWN_ERROR\t\t= 0x1001,\n\tFW_HDCP_STATUS_INCORRECT_API_VERSION\t= 0x1002,\n\tFW_HDCP_STATUS_INVALID_FUNCTION\t\t= 0x1003,\n\tFW_HDCP_STATUS_INVALID_BUFFER_LENGTH\t= 0x1004,\n\tFW_HDCP_STATUS_INVALID_PARAMS\t\t= 0x1005,\n\tFW_HDCP_STATUS_AUTHENTICATION_FAILED\t= 0x1006,\n\n\t \n\tFW_HDCP_INVALID_SESSION_STATE\t\t= 0x6000,\n\tFW_HDCP_SRM_FRAGMENT_UNEXPECTED\t\t= 0x6001,\n\tFW_HDCP_SRM_INVALID_LENGTH\t\t= 0x6002,\n\tFW_HDCP_SRM_FRAGMENT_OFFSET_INVALID\t= 0x6003,\n\tFW_HDCP_SRM_VERIFICATION_FAILED\t\t= 0x6004,\n\tFW_HDCP_SRM_VERSION_TOO_OLD\t\t= 0x6005,\n\tFW_HDCP_RX_CERT_VERIFICATION_FAILED\t= 0x6006,\n\tFW_HDCP_RX_REVOKED\t\t\t= 0x6007,\n\tFW_HDCP_H_VERIFICATION_FAILED\t\t= 0x6008,\n\tFW_HDCP_REPEATER_CHECK_UNEXPECTED\t= 0x6009,\n\tFW_HDCP_TOPOLOGY_MAX_EXCEEDED\t\t= 0x600A,\n\tFW_HDCP_V_VERIFICATION_FAILED\t\t= 0x600B,\n\tFW_HDCP_L_VERIFICATION_FAILED\t\t= 0x600C,\n\tFW_HDCP_STREAM_KEY_ALLOC_FAILED\t\t= 0x600D,\n\tFW_HDCP_BASE_KEY_RESET_FAILED\t\t= 0x600E,\n\tFW_HDCP_NONCE_GENERATION_FAILED\t\t= 0x600F,\n\tFW_HDCP_STATUS_INVALID_E_KEY_STATE\t= 0x6010,\n\tFW_HDCP_STATUS_INVALID_CS_ICV\t\t= 0x6011,\n\tFW_HDCP_STATUS_INVALID_KB_KEY_STATE\t= 0x6012,\n\tFW_HDCP_STATUS_INVALID_PAVP_MODE_ICV\t= 0x6013,\n\tFW_HDCP_STATUS_INVALID_PAVP_MODE\t= 0x6014,\n\tFW_HDCP_STATUS_LC_MAX_ATTEMPTS\t\t= 0x6015,\n\n\t \n\tFW_HDCP_STATUS_MISMATCH_IN_M\t\t= 0x6016,\n\n\t \n\tFW_HDCP_STATUS_RX_PROV_NOT_ALLOWED\t= 0x6017,\n\tFW_HDCP_STATUS_RX_PROV_WRONG_SUBJECT\t= 0x6018,\n\tFW_HDCP_RX_NEEDS_PROVISIONING\t\t= 0x6019,\n\tFW_HDCP_BKSV_ICV_AUTH_FAILED\t\t= 0x6020,\n\tFW_HDCP_STATUS_INVALID_STREAM_ID\t= 0x6021,\n\tFW_HDCP_STATUS_CHAIN_NOT_INITIALIZED\t= 0x6022,\n\tFW_HDCP_FAIL_NOT_EXPECTED\t\t= 0x6023,\n\tFW_HDCP_FAIL_HDCP_OFF\t\t\t= 0x6024,\n\tFW_HDCP_FAIL_INVALID_PAVP_MEMORY_MODE\t= 0x6025,\n\tFW_HDCP_FAIL_AES_ECB_FAILURE\t\t= 0x6026,\n\tFW_HDCP_FEATURE_NOT_SUPPORTED\t\t= 0x6027,\n\tFW_HDCP_DMA_READ_ERROR\t\t\t= 0x6028,\n\tFW_HDCP_DMA_WRITE_ERROR\t\t\t= 0x6029,\n\tFW_HDCP_FAIL_INVALID_PACKET_SIZE\t= 0x6030,\n\tFW_HDCP_H264_PARSING_ERROR\t\t= 0x6031,\n\tFW_HDCP_HDCP2_ERRATA_VIDEO_VIOLATION\t= 0x6032,\n\tFW_HDCP_HDCP2_ERRATA_AUDIO_VIOLATION\t= 0x6033,\n\tFW_HDCP_TX_ACTIVE_ERROR\t\t\t= 0x6034,\n\tFW_HDCP_MODE_CHANGE_ERROR\t\t= 0x6035,\n\tFW_HDCP_STREAM_TYPE_ERROR\t\t= 0x6036,\n\tFW_HDCP_STREAM_MANAGE_NOT_POSSIBLE\t= 0x6037,\n\n\tFW_HDCP_STATUS_PORT_INVALID_COMMAND\t= 0x6038,\n\tFW_HDCP_STATUS_UNSUPPORTED_PROTOCOL\t= 0x6039,\n\tFW_HDCP_STATUS_INVALID_PORT_INDEX\t= 0x603a,\n\tFW_HDCP_STATUS_TX_AUTH_NEEDED\t\t= 0x603b,\n\tFW_HDCP_STATUS_NOT_INTEGRATED_PORT\t= 0x603c,\n\tFW_HDCP_STATUS_SESSION_MAX_REACHED\t= 0x603d,\n\n\t \n\tFW_HDCP_STATUS_NOT_HDCP_CAPABLE\t\t= 0x6041,\n\n\tFW_HDCP_STATUS_INVALID_STREAM_COUNT\t= 0x6042,\n};\n\n#define HDCP_API_VERSION\t\t\t\t0x00010000\n\n#define HDCP_M_LEN\t\t\t\t\t16\n#define HDCP_KH_LEN\t\t\t\t\t16\n\n \n \n#define\tWIRED_CMD_BUF_LEN_INITIATE_HDCP2_SESSION_IN\t(4 + 1)\n#define\tWIRED_CMD_BUF_LEN_INITIATE_HDCP2_SESSION_OUT\t(4 + 8 + 3)\n\n#define\tWIRED_CMD_BUF_LEN_VERIFY_RECEIVER_CERT_IN\t(4 + 522 + 8 + 3)\n#define\tWIRED_CMD_BUF_LEN_VERIFY_RECEIVER_CERT_MIN_OUT\t(4 + 1 + 3 + 16 + 16)\n#define\tWIRED_CMD_BUF_LEN_VERIFY_RECEIVER_CERT_MAX_OUT\t(4 + 1 + 3 + 128)\n\n#define\tWIRED_CMD_BUF_LEN_AKE_SEND_HPRIME_IN\t\t(4 + 32)\n#define\tWIRED_CMD_BUF_LEN_AKE_SEND_HPRIME_OUT\t\t(4)\n\n#define\tWIRED_CMD_BUF_LEN_SEND_PAIRING_INFO_IN\t\t(4 + 16)\n#define\tWIRED_CMD_BUF_LEN_SEND_PAIRING_INFO_OUT\t\t(4)\n\n#define\tWIRED_CMD_BUF_LEN_CLOSE_SESSION_IN\t\t(4)\n#define\tWIRED_CMD_BUF_LEN_CLOSE_SESSION_OUT\t\t(4)\n\n \n#define\tWIRED_CMD_BUF_LEN_INIT_LOCALITY_CHECK_IN\t(4)\n#define\tWIRED_CMD_BUF_LEN_INIT_LOCALITY_CHECK_OUT\t(4 + 8)\n\n#define\tWIRED_CMD_BUF_LEN_VALIDATE_LOCALITY_IN\t\t(4 + 32)\n#define\tWIRED_CMD_BUF_LEN_VALIDATE_LOCALITY_OUT\t\t(4)\n\n \n#define\tWIRED_CMD_BUF_LEN_GET_SESSION_KEY_IN\t\t(4)\n#define\tWIRED_CMD_BUF_LEN_GET_SESSION_KEY_OUT\t\t(4 + 16 + 8)\n\n \n#define\tWIRED_CMD_BUF_LEN_ENABLE_AUTH_IN\t\t(4 + 1)\n#define\tWIRED_CMD_BUF_LEN_ENABLE_AUTH_OUT\t\t(4)\n\n \n#define\tWIRED_CMD_BUF_LEN_VERIFY_REPEATER_IN\t\t(4 + 2 + 3 + 16 + 155)\n#define\tWIRED_CMD_BUF_LEN_VERIFY_REPEATER_OUT\t\t(4 + 1 + 16)\n\n#define\tWIRED_CMD_BUF_LEN_REPEATER_AUTH_STREAM_REQ_MIN_IN\t(4 + 3 + \\\n\t\t\t\t\t\t\t\t32 + 2 + 2)\n\n#define\tWIRED_CMD_BUF_LEN_REPEATER_AUTH_STREAM_REQ_OUT\t\t(4)\n\n \nenum hdcp_command_id {\n\t_WIDI_COMMAND_BASE\t\t= 0x00030000,\n\tWIDI_INITIATE_HDCP2_SESSION\t= _WIDI_COMMAND_BASE,\n\tHDCP_GET_SRM_STATUS,\n\tHDCP_SEND_SRM_FRAGMENT,\n\n\t \n\t_WIRED_COMMAND_BASE\t\t= 0x00031000,\n\tWIRED_INITIATE_HDCP2_SESSION\t= _WIRED_COMMAND_BASE,\n\tWIRED_VERIFY_RECEIVER_CERT,\n\tWIRED_AKE_SEND_HPRIME,\n\tWIRED_AKE_SEND_PAIRING_INFO,\n\tWIRED_INIT_LOCALITY_CHECK,\n\tWIRED_VALIDATE_LOCALITY,\n\tWIRED_GET_SESSION_KEY,\n\tWIRED_ENABLE_AUTH,\n\tWIRED_VERIFY_REPEATER,\n\tWIRED_REPEATER_AUTH_STREAM_REQ,\n\tWIRED_CLOSE_SESSION,\n\n\t_WIRED_COMMANDS_COUNT,\n};\n\nunion encrypted_buff {\n\tu8\t\te_kpub_km[HDCP_2_2_E_KPUB_KM_LEN];\n\tu8\t\te_kh_km_m[HDCP_2_2_E_KH_KM_M_LEN];\n\tstruct {\n\t\tu8\te_kh_km[HDCP_KH_LEN];\n\t\tu8\tm[HDCP_M_LEN];\n\t} __packed;\n};\n\n \nstruct hdcp_cmd_header {\n\tu32\t\t\tapi_version;\n\tu32\t\t\tcommand_id;\n\tenum fw_hdcp_status\tstatus;\n\t \n\tu32\t\t\tbuffer_len;\n} __packed;\n\n \nstruct hdcp_cmd_no_data {\n\tstruct hdcp_cmd_header header;\n} __packed;\n\n \nstruct hdcp_port_id {\n\tu8\tintegrated_port_type;\n\t \n\tu8\tphysical_port;\n\t \n\tu8\tattached_transcoder;\n\tu8\treserved;\n} __packed;\n\n \n \nstruct wired_cmd_initiate_hdcp2_session_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tprotocol;  \n} __packed;\n\nstruct wired_cmd_initiate_hdcp2_session_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tr_tx[HDCP_2_2_RTX_LEN];\n\tstruct hdcp2_tx_caps\ttx_caps;\n} __packed;\n\n \nstruct wired_cmd_close_session_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\nstruct wired_cmd_close_session_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n \nstruct wired_cmd_verify_receiver_cert_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tstruct hdcp2_cert_rx\tcert_rx;\n\tu8\t\t\tr_rx[HDCP_2_2_RRX_LEN];\n\tu8\t\t\trx_caps[HDCP_2_2_RXCAPS_LEN];\n} __packed;\n\nstruct wired_cmd_verify_receiver_cert_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tkm_stored;\n\tu8\t\t\treserved[3];\n\tunion encrypted_buff\tekm_buff;\n} __packed;\n\n \nstruct wired_cmd_ake_send_hprime_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\th_prime[HDCP_2_2_H_PRIME_LEN];\n} __packed;\n\nstruct wired_cmd_ake_send_hprime_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n \nstruct wired_cmd_ake_send_pairing_info_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\te_kh_km[HDCP_2_2_E_KH_KM_LEN];\n} __packed;\n\nstruct wired_cmd_ake_send_pairing_info_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n \n \nstruct wired_cmd_init_locality_check_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\nstruct wired_cmd_init_locality_check_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tr_n[HDCP_2_2_RN_LEN];\n} __packed;\n\n \nstruct wired_cmd_validate_locality_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tl_prime[HDCP_2_2_L_PRIME_LEN];\n} __packed;\n\nstruct wired_cmd_validate_locality_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n \n \nstruct wired_cmd_get_session_key_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\nstruct wired_cmd_get_session_key_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\te_dkey_ks[HDCP_2_2_E_DKEY_KS_LEN];\n\tu8\t\t\tr_iv[HDCP_2_2_RIV_LEN];\n} __packed;\n\n \nstruct wired_cmd_enable_auth_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tstream_type;\n} __packed;\n\nstruct wired_cmd_enable_auth_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n \n \nstruct wired_cmd_verify_repeater_in {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\trx_info[HDCP_2_2_RXINFO_LEN];\n\tu8\t\t\tseq_num_v[HDCP_2_2_SEQ_NUM_LEN];\n\tu8\t\t\tv_prime[HDCP_2_2_V_PRIME_HALF_LEN];\n\tu8\t\t\treceiver_ids[HDCP_2_2_RECEIVER_IDS_MAX_LEN];\n} __packed;\n\nstruct wired_cmd_verify_repeater_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n\tu8\t\t\tcontent_type_supported;\n\tu8\t\t\tv[HDCP_2_2_V_PRIME_HALF_LEN];\n} __packed;\n\n \nstruct wired_cmd_repeater_auth_stream_req_in {\n\tstruct hdcp_cmd_header\t\theader;\n\tstruct hdcp_port_id\t\tport;\n\tu8\t\t\t\tseq_num_m[HDCP_2_2_SEQ_NUM_LEN];\n\tu8\t\t\t\tm_prime[HDCP_2_2_MPRIME_LEN];\n\t__be16\t\t\t\tk;\n\tstruct hdcp2_streamid_type\tstreams[];\n} __packed;\n\nstruct wired_cmd_repeater_auth_stream_req_out {\n\tstruct hdcp_cmd_header\theader;\n\tstruct hdcp_port_id\tport;\n} __packed;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}