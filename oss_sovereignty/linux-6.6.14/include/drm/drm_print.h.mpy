{
  "module_name": "drm_print.h",
  "hash_id": "d0ff32de28df24dddbc03b434b0d00a9ff069a0aebb6711bf4895dca7515568c",
  "original_prompt": "Ingested from linux-6.6.14/include/drm/drm_print.h",
  "human_readable_source": " \n\n#ifndef DRM_PRINT_H_\n#define DRM_PRINT_H_\n\n#include <linux/compiler.h>\n#include <linux/printk.h>\n#include <linux/seq_file.h>\n#include <linux/device.h>\n#include <linux/debugfs.h>\n#include <linux/dynamic_debug.h>\n\n#include <drm/drm.h>\n\n \nextern unsigned long __drm_debug;\n\n \n\n \nstruct drm_printer {\n\t \n\tvoid (*printfn)(struct drm_printer *p, struct va_format *vaf);\n\tvoid (*puts)(struct drm_printer *p, const char *str);\n\tvoid *arg;\n\tconst char *prefix;\n};\n\nvoid __drm_printfn_coredump(struct drm_printer *p, struct va_format *vaf);\nvoid __drm_puts_coredump(struct drm_printer *p, const char *str);\nvoid __drm_printfn_seq_file(struct drm_printer *p, struct va_format *vaf);\nvoid __drm_puts_seq_file(struct drm_printer *p, const char *str);\nvoid __drm_printfn_info(struct drm_printer *p, struct va_format *vaf);\nvoid __drm_printfn_debug(struct drm_printer *p, struct va_format *vaf);\nvoid __drm_printfn_err(struct drm_printer *p, struct va_format *vaf);\n\n__printf(2, 3)\nvoid drm_printf(struct drm_printer *p, const char *f, ...);\nvoid drm_puts(struct drm_printer *p, const char *str);\nvoid drm_print_regset32(struct drm_printer *p, struct debugfs_regset32 *regset);\nvoid drm_print_bits(struct drm_printer *p, unsigned long value,\n\t\t    const char * const bits[], unsigned int nbits);\n\n__printf(2, 0)\n \nstatic inline void\ndrm_vprintf(struct drm_printer *p, const char *fmt, va_list *va)\n{\n\tstruct va_format vaf = { .fmt = fmt, .va = va };\n\n\tp->printfn(p, &vaf);\n}\n\n \n#define drm_printf_indent(printer, indent, fmt, ...) \\\n\tdrm_printf((printer), \"%.*s\" fmt, (indent), \"\\t\\t\\t\\t\\tX\", ##__VA_ARGS__)\n\n \nstruct drm_print_iterator {\n\tvoid *data;\n\tssize_t start;\n\tssize_t remain;\n\t \n\tssize_t offset;\n};\n\n \nstatic inline struct drm_printer\ndrm_coredump_printer(struct drm_print_iterator *iter)\n{\n\tstruct drm_printer p = {\n\t\t.printfn = __drm_printfn_coredump,\n\t\t.puts = __drm_puts_coredump,\n\t\t.arg = iter,\n\t};\n\n\t \n\titer->offset = 0;\n\n\treturn p;\n}\n\n \nstatic inline struct drm_printer drm_seq_file_printer(struct seq_file *f)\n{\n\tstruct drm_printer p = {\n\t\t.printfn = __drm_printfn_seq_file,\n\t\t.puts = __drm_puts_seq_file,\n\t\t.arg = f,\n\t};\n\treturn p;\n}\n\n \nstatic inline struct drm_printer drm_info_printer(struct device *dev)\n{\n\tstruct drm_printer p = {\n\t\t.printfn = __drm_printfn_info,\n\t\t.arg = dev,\n\t};\n\treturn p;\n}\n\n \nstatic inline struct drm_printer drm_debug_printer(const char *prefix)\n{\n\tstruct drm_printer p = {\n\t\t.printfn = __drm_printfn_debug,\n\t\t.prefix = prefix\n\t};\n\treturn p;\n}\n\n \nstatic inline struct drm_printer drm_err_printer(const char *prefix)\n{\n\tstruct drm_printer p = {\n\t\t.printfn = __drm_printfn_err,\n\t\t.prefix = prefix\n\t};\n\treturn p;\n}\n\n \nenum drm_debug_category {\n\t \n\t \n\tDRM_UT_CORE,\n\t \n\tDRM_UT_DRIVER,\n\t \n\tDRM_UT_KMS,\n\t \n\tDRM_UT_PRIME,\n\t \n\tDRM_UT_ATOMIC,\n\t \n\tDRM_UT_VBL,\n\t \n\tDRM_UT_STATE,\n\t \n\tDRM_UT_LEASE,\n\t \n\tDRM_UT_DP,\n\t \n\tDRM_UT_DRMRES\n};\n\nstatic inline bool drm_debug_enabled_raw(enum drm_debug_category category)\n{\n\treturn unlikely(__drm_debug & BIT(category));\n}\n\n#define drm_debug_enabled_instrumented(category)\t\t\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tpr_debug(\"todo: is this frequent enough to optimize ?\\n\"); \\\n\t\tdrm_debug_enabled_raw(category);\t\t\t\\\n\t})\n\n#if defined(CONFIG_DRM_USE_DYNAMIC_DEBUG)\n \n#define __drm_debug_enabled(category)\ttrue\n#define drm_debug_enabled(category)\tdrm_debug_enabled_instrumented(category)\n#else\n#define __drm_debug_enabled(category)\tdrm_debug_enabled_raw(category)\n#define drm_debug_enabled(category)\tdrm_debug_enabled_raw(category)\n#endif\n\n \n\n__printf(3, 4)\nvoid drm_dev_printk(const struct device *dev, const char *level,\n\t\t    const char *format, ...);\nstruct _ddebug;\n__printf(4, 5)\nvoid __drm_dev_dbg(struct _ddebug *desc, const struct device *dev,\n\t\t   enum drm_debug_category category, const char *format, ...);\n\n \n#define DRM_DEV_ERROR(dev, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_printk(dev, KERN_ERR, \"*ERROR* \" fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEV_ERROR_RATELIMITED(dev, fmt, ...)\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tstatic DEFINE_RATELIMIT_STATE(_rs,\t\t\t\t\\\n\t\t\t\t      DEFAULT_RATELIMIT_INTERVAL,\t\\\n\t\t\t\t      DEFAULT_RATELIMIT_BURST);\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tif (__ratelimit(&_rs))\t\t\t\t\t\t\\\n\t\tDRM_DEV_ERROR(dev, fmt, ##__VA_ARGS__);\t\t\t\\\n})\n\n \n#define DRM_DEV_INFO(dev, fmt, ...)\t\t\t\t\\\n\tdrm_dev_printk(dev, KERN_INFO, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEV_INFO_ONCE(dev, fmt, ...)\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tstatic bool __print_once __read_mostly;\t\t\t\t\\\n\tif (!__print_once) {\t\t\t\t\t\t\\\n\t\t__print_once = true;\t\t\t\t\t\\\n\t\tDRM_DEV_INFO(dev, fmt, ##__VA_ARGS__);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n})\n\n#if !defined(CONFIG_DRM_USE_DYNAMIC_DEBUG)\n#define drm_dev_dbg(dev, cat, fmt, ...)\t\t\t\t\\\n\t__drm_dev_dbg(NULL, dev, cat, fmt, ##__VA_ARGS__)\n#else\n#define drm_dev_dbg(dev, cat, fmt, ...)\t\t\t\t\\\n\t_dynamic_func_call_cls(cat, fmt, __drm_dev_dbg,\t\t\\\n\t\t\t       dev, cat, fmt, ##__VA_ARGS__)\n#endif\n\n \n#define DRM_DEV_DEBUG(dev, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg(dev, DRM_UT_CORE, fmt, ##__VA_ARGS__)\n \n#define DRM_DEV_DEBUG_DRIVER(dev, fmt, ...)\t\t\t\t\\\n\tdrm_dev_dbg(dev, DRM_UT_DRIVER,\tfmt, ##__VA_ARGS__)\n \n#define DRM_DEV_DEBUG_KMS(dev, fmt, ...)\t\t\t\t\\\n\tdrm_dev_dbg(dev, DRM_UT_KMS, fmt, ##__VA_ARGS__)\n\n \n\n \n#define __drm_printk(drm, level, type, fmt, ...)\t\t\t\\\n\tdev_##level##type((drm)->dev, \"[drm] \" fmt, ##__VA_ARGS__)\n\n\n#define drm_info(drm, fmt, ...)\t\t\t\t\t\\\n\t__drm_printk((drm), info,, fmt, ##__VA_ARGS__)\n\n#define drm_notice(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), notice,, fmt, ##__VA_ARGS__)\n\n#define drm_warn(drm, fmt, ...)\t\t\t\t\t\\\n\t__drm_printk((drm), warn,, fmt, ##__VA_ARGS__)\n\n#define drm_err(drm, fmt, ...)\t\t\t\t\t\\\n\t__drm_printk((drm), err,, \"*ERROR* \" fmt, ##__VA_ARGS__)\n\n\n#define drm_info_once(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), info, _once, fmt, ##__VA_ARGS__)\n\n#define drm_notice_once(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), notice, _once, fmt, ##__VA_ARGS__)\n\n#define drm_warn_once(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), warn, _once, fmt, ##__VA_ARGS__)\n\n#define drm_err_once(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), err, _once, \"*ERROR* \" fmt, ##__VA_ARGS__)\n\n\n#define drm_err_ratelimited(drm, fmt, ...)\t\t\t\t\\\n\t__drm_printk((drm), err, _ratelimited, \"*ERROR* \" fmt, ##__VA_ARGS__)\n\n\n#define drm_dbg_core(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_CORE, fmt, ##__VA_ARGS__)\n#define drm_dbg_driver(drm, fmt, ...)\t\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_DRIVER, fmt, ##__VA_ARGS__)\n#define drm_dbg_kms(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_KMS, fmt, ##__VA_ARGS__)\n#define drm_dbg_prime(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_PRIME, fmt, ##__VA_ARGS__)\n#define drm_dbg_atomic(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_ATOMIC, fmt, ##__VA_ARGS__)\n#define drm_dbg_vbl(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_VBL, fmt, ##__VA_ARGS__)\n#define drm_dbg_state(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_STATE, fmt, ##__VA_ARGS__)\n#define drm_dbg_lease(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_LEASE, fmt, ##__VA_ARGS__)\n#define drm_dbg_dp(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_DP, fmt, ##__VA_ARGS__)\n#define drm_dbg_drmres(drm, fmt, ...)\t\t\t\t\t\\\n\tdrm_dev_dbg((drm) ? (drm)->dev : NULL, DRM_UT_DRMRES, fmt, ##__VA_ARGS__)\n\n#define drm_dbg(drm, fmt, ...)\tdrm_dbg_driver(drm, fmt, ##__VA_ARGS__)\n\n \n\n__printf(3, 4)\nvoid ___drm_dbg(struct _ddebug *desc, enum drm_debug_category category, const char *format, ...);\n__printf(1, 2)\nvoid __drm_err(const char *format, ...);\n\n#if !defined(CONFIG_DRM_USE_DYNAMIC_DEBUG)\n#define __drm_dbg(cat, fmt, ...)\t\t___drm_dbg(NULL, cat, fmt, ##__VA_ARGS__)\n#else\n#define __drm_dbg(cat, fmt, ...)\t\t\t\t\t\\\n\t_dynamic_func_call_cls(cat, fmt, ___drm_dbg,\t\t\t\\\n\t\t\t       cat, fmt, ##__VA_ARGS__)\n#endif\n\n \n\n#define _DRM_PRINTK(once, level, fmt, ...)\t\t\t\t\\\n\tprintk##once(KERN_##level \"[\" DRM_NAME \"] \" fmt, ##__VA_ARGS__)\n\n \n#define DRM_INFO(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(, INFO, fmt, ##__VA_ARGS__)\n \n#define DRM_NOTE(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(, NOTICE, fmt, ##__VA_ARGS__)\n \n#define DRM_WARN(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(, WARNING, fmt, ##__VA_ARGS__)\n\n \n#define DRM_INFO_ONCE(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(_once, INFO, fmt, ##__VA_ARGS__)\n \n#define DRM_NOTE_ONCE(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(_once, NOTICE, fmt, ##__VA_ARGS__)\n \n#define DRM_WARN_ONCE(fmt, ...)\t\t\t\t\t\t\\\n\t_DRM_PRINTK(_once, WARNING, fmt, ##__VA_ARGS__)\n\n \n#define DRM_ERROR(fmt, ...)\t\t\t\t\t\t\\\n\t__drm_err(fmt, ##__VA_ARGS__)\n\n \n#define DRM_ERROR_RATELIMITED(fmt, ...)\t\t\t\t\t\\\n\tDRM_DEV_ERROR_RATELIMITED(NULL, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG(fmt, ...)\t\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_CORE, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_DRIVER(fmt, ...)\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_DRIVER, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_KMS(fmt, ...)\t\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_KMS, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_PRIME(fmt, ...)\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_PRIME, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_ATOMIC(fmt, ...)\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_ATOMIC, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_VBL(fmt, ...)\t\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_VBL, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_LEASE(fmt, ...)\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_LEASE, fmt, ##__VA_ARGS__)\n\n \n#define DRM_DEBUG_DP(fmt, ...)\t\t\t\t\t\t\\\n\t__drm_dbg(DRM_UT_DP, fmt, ## __VA_ARGS__)\n\n#define __DRM_DEFINE_DBG_RATELIMITED(category, drm, fmt, ...)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\t\t\t\\\n\tstatic DEFINE_RATELIMIT_STATE(rs_, DEFAULT_RATELIMIT_INTERVAL, DEFAULT_RATELIMIT_BURST);\\\n\tconst struct drm_device *drm_ = (drm);\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\t\t\\\n\tif (drm_debug_enabled(DRM_UT_ ## category) && __ratelimit(&rs_))\t\t\t\\\n\t\tdrm_dev_printk(drm_ ? drm_->dev : NULL, KERN_DEBUG, fmt, ## __VA_ARGS__);\t\\\n})\n\n#define drm_dbg_kms_ratelimited(drm, fmt, ...) \\\n\t__DRM_DEFINE_DBG_RATELIMITED(KMS, drm, fmt, ## __VA_ARGS__)\n\n \n\n \n#define drm_WARN(drm, condition, format, arg...)\t\t\t\\\n\tWARN(condition, \"%s %s: \" format,\t\t\t\t\\\n\t\t\tdev_driver_string((drm)->dev),\t\t\t\\\n\t\t\tdev_name((drm)->dev), ## arg)\n\n#define drm_WARN_ONCE(drm, condition, format, arg...)\t\t\t\\\n\tWARN_ONCE(condition, \"%s %s: \" format,\t\t\t\t\\\n\t\t\tdev_driver_string((drm)->dev),\t\t\t\\\n\t\t\tdev_name((drm)->dev), ## arg)\n\n#define drm_WARN_ON(drm, x)\t\t\t\t\t\t\\\n\tdrm_WARN((drm), (x), \"%s\",\t\t\t\t\t\\\n\t\t \"drm_WARN_ON(\" __stringify(x) \")\")\n\n#define drm_WARN_ON_ONCE(drm, x)\t\t\t\t\t\\\n\tdrm_WARN_ONCE((drm), (x), \"%s\",\t\t\t\t\t\\\n\t\t      \"drm_WARN_ON_ONCE(\" __stringify(x) \")\")\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}