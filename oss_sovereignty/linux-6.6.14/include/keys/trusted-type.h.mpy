{
  "module_name": "trusted-type.h",
  "hash_id": "2cc14651557c843310c4db06599a4a25898e3291ba223bcfb7b8fd34bc5f352c",
  "original_prompt": "Ingested from linux-6.6.14/include/keys/trusted-type.h",
  "human_readable_source": " \n \n\n#ifndef _KEYS_TRUSTED_TYPE_H\n#define _KEYS_TRUSTED_TYPE_H\n\n#include <linux/key.h>\n#include <linux/rcupdate.h>\n#include <linux/tpm.h>\n\n#ifdef pr_fmt\n#undef pr_fmt\n#endif\n\n#define pr_fmt(fmt) \"trusted_key: \" fmt\n\n#define MIN_KEY_SIZE\t\t\t32\n#define MAX_KEY_SIZE\t\t\t128\n#define MAX_BLOB_SIZE\t\t\t512\n#define MAX_PCRINFO_SIZE\t\t64\n#define MAX_DIGEST_SIZE\t\t\t64\n\nstruct trusted_key_payload {\n\tstruct rcu_head rcu;\n\tunsigned int key_len;\n\tunsigned int blob_len;\n\tunsigned char migratable;\n\tunsigned char old_format;\n\tunsigned char key[MAX_KEY_SIZE + 1];\n\tunsigned char blob[MAX_BLOB_SIZE];\n};\n\nstruct trusted_key_options {\n\tuint16_t keytype;\n\tuint32_t keyhandle;\n\tunsigned char keyauth[TPM_DIGEST_SIZE];\n\tuint32_t blobauth_len;\n\tunsigned char blobauth[TPM_DIGEST_SIZE];\n\tuint32_t pcrinfo_len;\n\tunsigned char pcrinfo[MAX_PCRINFO_SIZE];\n\tint pcrlock;\n\tuint32_t hash;\n\tuint32_t policydigest_len;\n\tunsigned char policydigest[MAX_DIGEST_SIZE];\n\tuint32_t policyhandle;\n};\n\nstruct trusted_key_ops {\n\t \n\tunsigned char migratable;\n\n\t \n\tint (*init)(void);\n\n\t \n\tint (*seal)(struct trusted_key_payload *p, char *datablob);\n\n\t \n\tint (*unseal)(struct trusted_key_payload *p, char *datablob);\n\n\t \n\tint (*get_random)(unsigned char *key, size_t key_len);\n\n\t \n\tvoid (*exit)(void);\n};\n\nstruct trusted_key_source {\n\tchar *name;\n\tstruct trusted_key_ops *ops;\n};\n\nextern struct key_type key_type_trusted;\n\n#define TRUSTED_DEBUG 0\n\n#if TRUSTED_DEBUG\nstatic inline void dump_payload(struct trusted_key_payload *p)\n{\n\tpr_info(\"key_len %d\\n\", p->key_len);\n\tprint_hex_dump(KERN_INFO, \"key \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->key, p->key_len, 0);\n\tpr_info(\"bloblen %d\\n\", p->blob_len);\n\tprint_hex_dump(KERN_INFO, \"blob \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->blob, p->blob_len, 0);\n\tpr_info(\"migratable %d\\n\", p->migratable);\n}\n#else\nstatic inline void dump_payload(struct trusted_key_payload *p)\n{\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}