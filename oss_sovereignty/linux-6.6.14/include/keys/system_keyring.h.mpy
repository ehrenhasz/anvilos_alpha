{
  "module_name": "system_keyring.h",
  "hash_id": "0f671839a258aa2d52f063374396e9526a3026cf46c86537f85e0c995ee5dab4",
  "original_prompt": "Ingested from linux-6.6.14/include/keys/system_keyring.h",
  "human_readable_source": " \n \n\n#ifndef _KEYS_SYSTEM_KEYRING_H\n#define _KEYS_SYSTEM_KEYRING_H\n\n#include <linux/key.h>\n\nenum blacklist_hash_type {\n\t \n\tBLACKLIST_HASH_X509_TBS = 1,\n\t \n\tBLACKLIST_HASH_BINARY = 2,\n};\n\n#ifdef CONFIG_SYSTEM_TRUSTED_KEYRING\n\nextern int restrict_link_by_builtin_trusted(struct key *keyring,\n\t\t\t\t\t    const struct key_type *type,\n\t\t\t\t\t    const union key_payload *payload,\n\t\t\t\t\t    struct key *restriction_key);\nint restrict_link_by_digsig_builtin(struct key *dest_keyring,\n\t\t\t\t    const struct key_type *type,\n\t\t\t\t    const union key_payload *payload,\n\t\t\t\t    struct key *restriction_key);\nextern __init int load_module_cert(struct key *keyring);\n\n#else\n#define restrict_link_by_builtin_trusted restrict_link_reject\n#define restrict_link_by_digsig_builtin restrict_link_reject\n\nstatic inline __init int load_module_cert(struct key *keyring)\n{\n\treturn 0;\n}\n\n#endif\n\n#ifdef CONFIG_SECONDARY_TRUSTED_KEYRING\nextern int restrict_link_by_builtin_and_secondary_trusted(\n\tstruct key *keyring,\n\tconst struct key_type *type,\n\tconst union key_payload *payload,\n\tstruct key *restriction_key);\nint restrict_link_by_digsig_builtin_and_secondary(struct key *keyring,\n\t\t\t\t\t\t  const struct key_type *type,\n\t\t\t\t\t\t  const union key_payload *payload,\n\t\t\t\t\t\t  struct key *restriction_key);\nvoid __init add_to_secondary_keyring(const char *source, const void *data, size_t len);\n#else\n#define restrict_link_by_builtin_and_secondary_trusted restrict_link_by_builtin_trusted\n#define restrict_link_by_digsig_builtin_and_secondary restrict_link_by_digsig_builtin\nstatic inline void __init add_to_secondary_keyring(const char *source, const void *data, size_t len)\n{\n}\n#endif\n\n#ifdef CONFIG_INTEGRITY_MACHINE_KEYRING\nextern int restrict_link_by_builtin_secondary_and_machine(\n\tstruct key *dest_keyring,\n\tconst struct key_type *type,\n\tconst union key_payload *payload,\n\tstruct key *restrict_key);\nextern void __init set_machine_trusted_keys(struct key *keyring);\n#else\n#define restrict_link_by_builtin_secondary_and_machine restrict_link_by_builtin_trusted\nstatic inline void __init set_machine_trusted_keys(struct key *keyring)\n{\n}\n#endif\n\nextern struct pkcs7_message *pkcs7;\n#ifdef CONFIG_SYSTEM_BLACKLIST_KEYRING\nextern int mark_hash_blacklisted(const u8 *hash, size_t hash_len,\n\t\t\t       enum blacklist_hash_type hash_type);\nextern int is_hash_blacklisted(const u8 *hash, size_t hash_len,\n\t\t\t       enum blacklist_hash_type hash_type);\nextern int is_binary_blacklisted(const u8 *hash, size_t hash_len);\n#else\nstatic inline int is_hash_blacklisted(const u8 *hash, size_t hash_len,\n\t\t\t\t      enum blacklist_hash_type hash_type)\n{\n\treturn 0;\n}\n\nstatic inline int is_binary_blacklisted(const u8 *hash, size_t hash_len)\n{\n\treturn 0;\n}\n#endif\n\n#ifdef CONFIG_SYSTEM_REVOCATION_LIST\nextern int add_key_to_revocation_list(const char *data, size_t size);\nextern int is_key_on_revocation_list(struct pkcs7_message *pkcs7);\n#else\nstatic inline int add_key_to_revocation_list(const char *data, size_t size)\n{\n\treturn 0;\n}\nstatic inline int is_key_on_revocation_list(struct pkcs7_message *pkcs7)\n{\n\treturn -ENOKEY;\n}\n#endif\n\n#ifdef CONFIG_IMA_BLACKLIST_KEYRING\nextern struct key *ima_blacklist_keyring;\n\nstatic inline struct key *get_ima_blacklist_keyring(void)\n{\n\treturn ima_blacklist_keyring;\n}\n#else\nstatic inline struct key *get_ima_blacklist_keyring(void)\n{\n\treturn NULL;\n}\n#endif  \n\n#if defined(CONFIG_INTEGRITY_PLATFORM_KEYRING) && \\\n\tdefined(CONFIG_SYSTEM_TRUSTED_KEYRING)\nextern void __init set_platform_trusted_keys(struct key *keyring);\n#else\nstatic inline void set_platform_trusted_keys(struct key *keyring)\n{\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}