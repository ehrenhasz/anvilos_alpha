{
  "module_name": "Kconfig",
  "hash_id": "3ecd77924830ff0470322e0e6eb08008861e41b0ba59be40dc7642e0c735ee7f",
  "original_prompt": "Ingested from linux-6.6.14/certs/Kconfig",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\nmenu \"Certificates for signature checking\"\n\nconfig MODULE_SIG_KEY\n\tstring \"File name or PKCS#11 URI of module signing key\"\n\tdefault \"certs/signing_key.pem\"\n\tdepends on MODULE_SIG || (IMA_APPRAISE_MODSIG && MODULES)\n\thelp\n         Provide the file name of a private key/certificate in PEM format,\n         or a PKCS#11 URI according to RFC7512. The file should contain, or\n         the URI should identify, both the certificate and its corresponding\n         private key.\n\n         If this option is unchanged from its default \"certs/signing_key.pem\",\n         then the kernel will automatically generate the private key and\n         certificate as described in Documentation/admin-guide/module-signing.rst\n\nchoice\n\tprompt \"Type of module signing key to be generated\"\n\tdepends on MODULE_SIG || (IMA_APPRAISE_MODSIG && MODULES)\n\thelp\n\t The type of module signing key type to generate. This option\n\t does not apply if a #PKCS11 URI is used.\n\nconfig MODULE_SIG_KEY_TYPE_RSA\n\tbool \"RSA\"\n\thelp\n\t Use an RSA key for module signing.\n\nconfig MODULE_SIG_KEY_TYPE_ECDSA\n\tbool \"ECDSA\"\n\tselect CRYPTO_ECDSA\n\thelp\n\t Use an elliptic curve key (NIST P384) for module signing. Consider\n\t using a strong hash like sha256 or sha384 for hashing modules.\n\n\t Note: Remove all ECDSA signing keys, e.g. certs/signing_key.pem,\n\t when falling back to building Linux 5.14 and older kernels.\n\nendchoice\n\nconfig SYSTEM_TRUSTED_KEYRING\n\tbool \"Provide system-wide ring of trusted keys\"\n\tdepends on KEYS\n\tdepends on ASYMMETRIC_KEY_TYPE\n\tdepends on X509_CERTIFICATE_PARSER = y\n\thelp\n\t  Provide a system keyring to which trusted keys can be added.  Keys in\n\t  the keyring are considered to be trusted.  Keys may be added at will\n\t  by the kernel from compiled-in data and from hardware key stores, but\n\t  userspace may only add extra keys if those keys can be verified by\n\t  keys already in the keyring.\n\n\t  Keys in this keyring are used by module signature checking.\n\nconfig SYSTEM_TRUSTED_KEYS\n\tstring \"Additional X.509 keys for default system keyring\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\thelp\n\t  If set, this option should be the filename of a PEM-formatted file\n\t  containing trusted X.509 certificates to be included in the default\n\t  system keyring. Any certificate used for module signing is implicitly\n\t  also trusted.\n\n\t  NOTE: If you previously provided keys for the system keyring in the\n\t  form of DER-encoded *.x509 files in the top-level build directory,\n\t  those are no longer used. You will need to set this option instead.\n\nconfig SYSTEM_EXTRA_CERTIFICATE\n\tbool \"Reserve area for inserting a certificate without recompiling\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\thelp\n\t  If set, space for an extra certificate will be reserved in the kernel\n\t  image. This allows introducing a trusted certificate to the default\n\t  system keyring without recompiling the kernel.\n\nconfig SYSTEM_EXTRA_CERTIFICATE_SIZE\n\tint \"Number of bytes to reserve for the extra certificate\"\n\tdepends on SYSTEM_EXTRA_CERTIFICATE\n\tdefault 4096\n\thelp\n\t  This is the number of bytes reserved in the kernel image for a\n\t  certificate to be inserted.\n\nconfig SECONDARY_TRUSTED_KEYRING\n\tbool \"Provide a keyring to which extra trustable keys may be added\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\thelp\n\t  If set, provide a keyring to which extra keys may be added, provided\n\t  those keys are not blacklisted and are vouched for by a key built\n\t  into the kernel or already in the secondary trusted keyring.\n\nconfig SYSTEM_BLACKLIST_KEYRING\n\tbool \"Provide system-wide ring of blacklisted keys\"\n\tdepends on KEYS\n\thelp\n\t  Provide a system keyring to which blacklisted keys can be added.\n\t  Keys in the keyring are considered entirely untrusted.  Keys in this\n\t  keyring are used by the module signature checking to reject loading\n\t  of modules signed with a blacklisted key.\n\nconfig SYSTEM_BLACKLIST_HASH_LIST\n\tstring \"Hashes to be preloaded into the system blacklist keyring\"\n\tdepends on SYSTEM_BLACKLIST_KEYRING\n\thelp\n\t  If set, this option should be the filename of a list of hashes in the\n\t  form \"<hash>\", \"<hash>\", ... .  This will be included into a C\n\t  wrapper to incorporate the list into the kernel.  Each <hash> must be a\n\t  string starting with a prefix (\"tbs\" or \"bin\"), then a colon (\":\"), and\n\t  finally an even number of hexadecimal lowercase characters (up to 128).\n\t  Certificate hashes can be generated with\n\t  tools/certs/print-cert-tbs-hash.sh .\n\nconfig SYSTEM_REVOCATION_LIST\n\tbool \"Provide system-wide ring of revocation certificates\"\n\tdepends on SYSTEM_BLACKLIST_KEYRING\n\tdepends on PKCS7_MESSAGE_PARSER=y\n\thelp\n\t  If set, this allows revocation certificates to be stored in the\n\t  blacklist keyring and implements a hook whereby a PKCS#7 message can\n\t  be checked to see if it matches such a certificate.\n\nconfig SYSTEM_REVOCATION_KEYS\n\tstring \"X.509 certificates to be preloaded into the system blacklist keyring\"\n\tdepends on SYSTEM_REVOCATION_LIST\n\thelp\n\t  If set, this option should be the filename of a PEM-formatted file\n\t  containing X.509 certificates to be included in the default blacklist\n\t  keyring.\n\nconfig SYSTEM_BLACKLIST_AUTH_UPDATE\n\tbool \"Allow root to add signed blacklist keys\"\n\tdepends on SYSTEM_BLACKLIST_KEYRING\n\tdepends on SYSTEM_DATA_VERIFICATION\n\thelp\n\t  If set, provide the ability to load new blacklist keys at run time if\n\t  they are signed and vouched by a certificate from the builtin trusted\n\t  keyring.  The PKCS#7 signature of the description is set in the key\n\t  payload.  Blacklist keys cannot be removed.\n\nendmenu\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}