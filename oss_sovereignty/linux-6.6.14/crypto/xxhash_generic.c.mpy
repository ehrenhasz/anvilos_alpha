{
  "module_name": "xxhash_generic.c",
  "hash_id": "cc48216ca16cb1417c8b9f34c32bbb5853870071c9041ab59d0a8b84be0d7da4",
  "original_prompt": "Ingested from linux-6.6.14/crypto/xxhash_generic.c",
  "human_readable_source": "\n\n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/xxhash.h>\n#include <asm/unaligned.h>\n\n#define XXHASH64_BLOCK_SIZE\t32\n#define XXHASH64_DIGEST_SIZE\t8\n\nstruct xxhash64_tfm_ctx {\n\tu64 seed;\n};\n\nstruct xxhash64_desc_ctx {\n\tstruct xxh64_state xxhstate;\n};\n\nstatic int xxhash64_setkey(struct crypto_shash *tfm, const u8 *key,\n\t\t\t unsigned int keylen)\n{\n\tstruct xxhash64_tfm_ctx *tctx = crypto_shash_ctx(tfm);\n\n\tif (keylen != sizeof(tctx->seed))\n\t\treturn -EINVAL;\n\ttctx->seed = get_unaligned_le64(key);\n\treturn 0;\n}\n\nstatic int xxhash64_init(struct shash_desc *desc)\n{\n\tstruct xxhash64_tfm_ctx *tctx = crypto_shash_ctx(desc->tfm);\n\tstruct xxhash64_desc_ctx *dctx = shash_desc_ctx(desc);\n\n\txxh64_reset(&dctx->xxhstate, tctx->seed);\n\n\treturn 0;\n}\n\nstatic int xxhash64_update(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length)\n{\n\tstruct xxhash64_desc_ctx *dctx = shash_desc_ctx(desc);\n\n\txxh64_update(&dctx->xxhstate, data, length);\n\n\treturn 0;\n}\n\nstatic int xxhash64_final(struct shash_desc *desc, u8 *out)\n{\n\tstruct xxhash64_desc_ctx *dctx = shash_desc_ctx(desc);\n\n\tput_unaligned_le64(xxh64_digest(&dctx->xxhstate), out);\n\n\treturn 0;\n}\n\nstatic int xxhash64_digest(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length, u8 *out)\n{\n\tstruct xxhash64_tfm_ctx *tctx = crypto_shash_ctx(desc->tfm);\n\n\tput_unaligned_le64(xxh64(data, length, tctx->seed), out);\n\n\treturn 0;\n}\n\nstatic struct shash_alg alg = {\n\t.digestsize\t= XXHASH64_DIGEST_SIZE,\n\t.setkey\t\t= xxhash64_setkey,\n\t.init\t\t= xxhash64_init,\n\t.update\t\t= xxhash64_update,\n\t.final\t\t= xxhash64_final,\n\t.digest\t\t= xxhash64_digest,\n\t.descsize\t= sizeof(struct xxhash64_desc_ctx),\n\t.base\t\t= {\n\t\t.cra_name\t = \"xxhash64\",\n\t\t.cra_driver_name = \"xxhash64-generic\",\n\t\t.cra_priority\t = 100,\n\t\t.cra_flags\t = CRYPTO_ALG_OPTIONAL_KEY,\n\t\t.cra_blocksize\t = XXHASH64_BLOCK_SIZE,\n\t\t.cra_ctxsize\t = sizeof(struct xxhash64_tfm_ctx),\n\t\t.cra_module\t = THIS_MODULE,\n\t}\n};\n\nstatic int __init xxhash_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit xxhash_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(xxhash_mod_init);\nmodule_exit(xxhash_mod_fini);\n\nMODULE_AUTHOR(\"Nikolay Borisov <nborisov@suse.com>\");\nMODULE_DESCRIPTION(\"xxhash calculations wrapper for lib/xxhash.c\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_CRYPTO(\"xxhash64\");\nMODULE_ALIAS_CRYPTO(\"xxhash64-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}