{
  "module_name": "sha1_generic.c",
  "hash_id": "10e5ffb7a7df84dd20ef8358f0bfe3d11ceaaa5b91441d306e0027b0eb6fef9c",
  "original_prompt": "Ingested from linux-6.6.14/crypto/sha1_generic.c",
  "human_readable_source": "\n \n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <crypto/sha1.h>\n#include <crypto/sha1_base.h>\n#include <asm/byteorder.h>\n\nconst u8 sha1_zero_message_hash[SHA1_DIGEST_SIZE] = {\n\t0xda, 0x39, 0xa3, 0xee, 0x5e, 0x6b, 0x4b, 0x0d,\n\t0x32, 0x55, 0xbf, 0xef, 0x95, 0x60, 0x18, 0x90,\n\t0xaf, 0xd8, 0x07, 0x09\n};\nEXPORT_SYMBOL_GPL(sha1_zero_message_hash);\n\nstatic void sha1_generic_block_fn(struct sha1_state *sst, u8 const *src,\n\t\t\t\t  int blocks)\n{\n\tu32 temp[SHA1_WORKSPACE_WORDS];\n\n\twhile (blocks--) {\n\t\tsha1_transform(sst->state, src, temp);\n\t\tsrc += SHA1_BLOCK_SIZE;\n\t}\n\tmemzero_explicit(temp, sizeof(temp));\n}\n\nint crypto_sha1_update(struct shash_desc *desc, const u8 *data,\n\t\t       unsigned int len)\n{\n\treturn sha1_base_do_update(desc, data, len, sha1_generic_block_fn);\n}\nEXPORT_SYMBOL(crypto_sha1_update);\n\nstatic int sha1_final(struct shash_desc *desc, u8 *out)\n{\n\tsha1_base_do_finalize(desc, sha1_generic_block_fn);\n\treturn sha1_base_finish(desc, out);\n}\n\nint crypto_sha1_finup(struct shash_desc *desc, const u8 *data,\n\t\t      unsigned int len, u8 *out)\n{\n\tsha1_base_do_update(desc, data, len, sha1_generic_block_fn);\n\treturn sha1_final(desc, out);\n}\nEXPORT_SYMBOL(crypto_sha1_finup);\n\nstatic struct shash_alg alg = {\n\t.digestsize\t=\tSHA1_DIGEST_SIZE,\n\t.init\t\t=\tsha1_base_init,\n\t.update\t\t=\tcrypto_sha1_update,\n\t.final\t\t=\tsha1_final,\n\t.finup\t\t=\tcrypto_sha1_finup,\n\t.descsize\t=\tsizeof(struct sha1_state),\n\t.base\t\t=\t{\n\t\t.cra_name\t=\t\"sha1\",\n\t\t.cra_driver_name=\t\"sha1-generic\",\n\t\t.cra_priority\t=\t100,\n\t\t.cra_blocksize\t=\tSHA1_BLOCK_SIZE,\n\t\t.cra_module\t=\tTHIS_MODULE,\n\t}\n};\n\nstatic int __init sha1_generic_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit sha1_generic_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(sha1_generic_mod_init);\nmodule_exit(sha1_generic_mod_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"SHA1 Secure Hash Algorithm\");\n\nMODULE_ALIAS_CRYPTO(\"sha1\");\nMODULE_ALIAS_CRYPTO(\"sha1-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}