{
  "module_name": "camellia_generic.c",
  "hash_id": "d9924c73f2c100e9b17a99335c6ba5ab9b5c866e04d5870645fefdc042277c6e",
  "original_prompt": "Ingested from linux-6.6.14/crypto/camellia_generic.c",
  "human_readable_source": "\n \n\n \n\n#include <crypto/algapi.h>\n#include <linux/errno.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n\nstatic const u32 camellia_sp1110[256] = {\n\t0x70707000, 0x82828200, 0x2c2c2c00, 0xececec00,\n\t0xb3b3b300, 0x27272700, 0xc0c0c000, 0xe5e5e500,\n\t0xe4e4e400, 0x85858500, 0x57575700, 0x35353500,\n\t0xeaeaea00, 0x0c0c0c00, 0xaeaeae00, 0x41414100,\n\t0x23232300, 0xefefef00, 0x6b6b6b00, 0x93939300,\n\t0x45454500, 0x19191900, 0xa5a5a500, 0x21212100,\n\t0xededed00, 0x0e0e0e00, 0x4f4f4f00, 0x4e4e4e00,\n\t0x1d1d1d00, 0x65656500, 0x92929200, 0xbdbdbd00,\n\t0x86868600, 0xb8b8b800, 0xafafaf00, 0x8f8f8f00,\n\t0x7c7c7c00, 0xebebeb00, 0x1f1f1f00, 0xcecece00,\n\t0x3e3e3e00, 0x30303000, 0xdcdcdc00, 0x5f5f5f00,\n\t0x5e5e5e00, 0xc5c5c500, 0x0b0b0b00, 0x1a1a1a00,\n\t0xa6a6a600, 0xe1e1e100, 0x39393900, 0xcacaca00,\n\t0xd5d5d500, 0x47474700, 0x5d5d5d00, 0x3d3d3d00,\n\t0xd9d9d900, 0x01010100, 0x5a5a5a00, 0xd6d6d600,\n\t0x51515100, 0x56565600, 0x6c6c6c00, 0x4d4d4d00,\n\t0x8b8b8b00, 0x0d0d0d00, 0x9a9a9a00, 0x66666600,\n\t0xfbfbfb00, 0xcccccc00, 0xb0b0b000, 0x2d2d2d00,\n\t0x74747400, 0x12121200, 0x2b2b2b00, 0x20202000,\n\t0xf0f0f000, 0xb1b1b100, 0x84848400, 0x99999900,\n\t0xdfdfdf00, 0x4c4c4c00, 0xcbcbcb00, 0xc2c2c200,\n\t0x34343400, 0x7e7e7e00, 0x76767600, 0x05050500,\n\t0x6d6d6d00, 0xb7b7b700, 0xa9a9a900, 0x31313100,\n\t0xd1d1d100, 0x17171700, 0x04040400, 0xd7d7d700,\n\t0x14141400, 0x58585800, 0x3a3a3a00, 0x61616100,\n\t0xdedede00, 0x1b1b1b00, 0x11111100, 0x1c1c1c00,\n\t0x32323200, 0x0f0f0f00, 0x9c9c9c00, 0x16161600,\n\t0x53535300, 0x18181800, 0xf2f2f200, 0x22222200,\n\t0xfefefe00, 0x44444400, 0xcfcfcf00, 0xb2b2b200,\n\t0xc3c3c300, 0xb5b5b500, 0x7a7a7a00, 0x91919100,\n\t0x24242400, 0x08080800, 0xe8e8e800, 0xa8a8a800,\n\t0x60606000, 0xfcfcfc00, 0x69696900, 0x50505000,\n\t0xaaaaaa00, 0xd0d0d000, 0xa0a0a000, 0x7d7d7d00,\n\t0xa1a1a100, 0x89898900, 0x62626200, 0x97979700,\n\t0x54545400, 0x5b5b5b00, 0x1e1e1e00, 0x95959500,\n\t0xe0e0e000, 0xffffff00, 0x64646400, 0xd2d2d200,\n\t0x10101000, 0xc4c4c400, 0x00000000, 0x48484800,\n\t0xa3a3a300, 0xf7f7f700, 0x75757500, 0xdbdbdb00,\n\t0x8a8a8a00, 0x03030300, 0xe6e6e600, 0xdadada00,\n\t0x09090900, 0x3f3f3f00, 0xdddddd00, 0x94949400,\n\t0x87878700, 0x5c5c5c00, 0x83838300, 0x02020200,\n\t0xcdcdcd00, 0x4a4a4a00, 0x90909000, 0x33333300,\n\t0x73737300, 0x67676700, 0xf6f6f600, 0xf3f3f300,\n\t0x9d9d9d00, 0x7f7f7f00, 0xbfbfbf00, 0xe2e2e200,\n\t0x52525200, 0x9b9b9b00, 0xd8d8d800, 0x26262600,\n\t0xc8c8c800, 0x37373700, 0xc6c6c600, 0x3b3b3b00,\n\t0x81818100, 0x96969600, 0x6f6f6f00, 0x4b4b4b00,\n\t0x13131300, 0xbebebe00, 0x63636300, 0x2e2e2e00,\n\t0xe9e9e900, 0x79797900, 0xa7a7a700, 0x8c8c8c00,\n\t0x9f9f9f00, 0x6e6e6e00, 0xbcbcbc00, 0x8e8e8e00,\n\t0x29292900, 0xf5f5f500, 0xf9f9f900, 0xb6b6b600,\n\t0x2f2f2f00, 0xfdfdfd00, 0xb4b4b400, 0x59595900,\n\t0x78787800, 0x98989800, 0x06060600, 0x6a6a6a00,\n\t0xe7e7e700, 0x46464600, 0x71717100, 0xbababa00,\n\t0xd4d4d400, 0x25252500, 0xababab00, 0x42424200,\n\t0x88888800, 0xa2a2a200, 0x8d8d8d00, 0xfafafa00,\n\t0x72727200, 0x07070700, 0xb9b9b900, 0x55555500,\n\t0xf8f8f800, 0xeeeeee00, 0xacacac00, 0x0a0a0a00,\n\t0x36363600, 0x49494900, 0x2a2a2a00, 0x68686800,\n\t0x3c3c3c00, 0x38383800, 0xf1f1f100, 0xa4a4a400,\n\t0x40404000, 0x28282800, 0xd3d3d300, 0x7b7b7b00,\n\t0xbbbbbb00, 0xc9c9c900, 0x43434300, 0xc1c1c100,\n\t0x15151500, 0xe3e3e300, 0xadadad00, 0xf4f4f400,\n\t0x77777700, 0xc7c7c700, 0x80808000, 0x9e9e9e00,\n};\n\nstatic const u32 camellia_sp0222[256] = {\n\t0x00e0e0e0, 0x00050505, 0x00585858, 0x00d9d9d9,\n\t0x00676767, 0x004e4e4e, 0x00818181, 0x00cbcbcb,\n\t0x00c9c9c9, 0x000b0b0b, 0x00aeaeae, 0x006a6a6a,\n\t0x00d5d5d5, 0x00181818, 0x005d5d5d, 0x00828282,\n\t0x00464646, 0x00dfdfdf, 0x00d6d6d6, 0x00272727,\n\t0x008a8a8a, 0x00323232, 0x004b4b4b, 0x00424242,\n\t0x00dbdbdb, 0x001c1c1c, 0x009e9e9e, 0x009c9c9c,\n\t0x003a3a3a, 0x00cacaca, 0x00252525, 0x007b7b7b,\n\t0x000d0d0d, 0x00717171, 0x005f5f5f, 0x001f1f1f,\n\t0x00f8f8f8, 0x00d7d7d7, 0x003e3e3e, 0x009d9d9d,\n\t0x007c7c7c, 0x00606060, 0x00b9b9b9, 0x00bebebe,\n\t0x00bcbcbc, 0x008b8b8b, 0x00161616, 0x00343434,\n\t0x004d4d4d, 0x00c3c3c3, 0x00727272, 0x00959595,\n\t0x00ababab, 0x008e8e8e, 0x00bababa, 0x007a7a7a,\n\t0x00b3b3b3, 0x00020202, 0x00b4b4b4, 0x00adadad,\n\t0x00a2a2a2, 0x00acacac, 0x00d8d8d8, 0x009a9a9a,\n\t0x00171717, 0x001a1a1a, 0x00353535, 0x00cccccc,\n\t0x00f7f7f7, 0x00999999, 0x00616161, 0x005a5a5a,\n\t0x00e8e8e8, 0x00242424, 0x00565656, 0x00404040,\n\t0x00e1e1e1, 0x00636363, 0x00090909, 0x00333333,\n\t0x00bfbfbf, 0x00989898, 0x00979797, 0x00858585,\n\t0x00686868, 0x00fcfcfc, 0x00ececec, 0x000a0a0a,\n\t0x00dadada, 0x006f6f6f, 0x00535353, 0x00626262,\n\t0x00a3a3a3, 0x002e2e2e, 0x00080808, 0x00afafaf,\n\t0x00282828, 0x00b0b0b0, 0x00747474, 0x00c2c2c2,\n\t0x00bdbdbd, 0x00363636, 0x00222222, 0x00383838,\n\t0x00646464, 0x001e1e1e, 0x00393939, 0x002c2c2c,\n\t0x00a6a6a6, 0x00303030, 0x00e5e5e5, 0x00444444,\n\t0x00fdfdfd, 0x00888888, 0x009f9f9f, 0x00656565,\n\t0x00878787, 0x006b6b6b, 0x00f4f4f4, 0x00232323,\n\t0x00484848, 0x00101010, 0x00d1d1d1, 0x00515151,\n\t0x00c0c0c0, 0x00f9f9f9, 0x00d2d2d2, 0x00a0a0a0,\n\t0x00555555, 0x00a1a1a1, 0x00414141, 0x00fafafa,\n\t0x00434343, 0x00131313, 0x00c4c4c4, 0x002f2f2f,\n\t0x00a8a8a8, 0x00b6b6b6, 0x003c3c3c, 0x002b2b2b,\n\t0x00c1c1c1, 0x00ffffff, 0x00c8c8c8, 0x00a5a5a5,\n\t0x00202020, 0x00898989, 0x00000000, 0x00909090,\n\t0x00474747, 0x00efefef, 0x00eaeaea, 0x00b7b7b7,\n\t0x00151515, 0x00060606, 0x00cdcdcd, 0x00b5b5b5,\n\t0x00121212, 0x007e7e7e, 0x00bbbbbb, 0x00292929,\n\t0x000f0f0f, 0x00b8b8b8, 0x00070707, 0x00040404,\n\t0x009b9b9b, 0x00949494, 0x00212121, 0x00666666,\n\t0x00e6e6e6, 0x00cecece, 0x00ededed, 0x00e7e7e7,\n\t0x003b3b3b, 0x00fefefe, 0x007f7f7f, 0x00c5c5c5,\n\t0x00a4a4a4, 0x00373737, 0x00b1b1b1, 0x004c4c4c,\n\t0x00919191, 0x006e6e6e, 0x008d8d8d, 0x00767676,\n\t0x00030303, 0x002d2d2d, 0x00dedede, 0x00969696,\n\t0x00262626, 0x007d7d7d, 0x00c6c6c6, 0x005c5c5c,\n\t0x00d3d3d3, 0x00f2f2f2, 0x004f4f4f, 0x00191919,\n\t0x003f3f3f, 0x00dcdcdc, 0x00797979, 0x001d1d1d,\n\t0x00525252, 0x00ebebeb, 0x00f3f3f3, 0x006d6d6d,\n\t0x005e5e5e, 0x00fbfbfb, 0x00696969, 0x00b2b2b2,\n\t0x00f0f0f0, 0x00313131, 0x000c0c0c, 0x00d4d4d4,\n\t0x00cfcfcf, 0x008c8c8c, 0x00e2e2e2, 0x00757575,\n\t0x00a9a9a9, 0x004a4a4a, 0x00575757, 0x00848484,\n\t0x00111111, 0x00454545, 0x001b1b1b, 0x00f5f5f5,\n\t0x00e4e4e4, 0x000e0e0e, 0x00737373, 0x00aaaaaa,\n\t0x00f1f1f1, 0x00dddddd, 0x00595959, 0x00141414,\n\t0x006c6c6c, 0x00929292, 0x00545454, 0x00d0d0d0,\n\t0x00787878, 0x00707070, 0x00e3e3e3, 0x00494949,\n\t0x00808080, 0x00505050, 0x00a7a7a7, 0x00f6f6f6,\n\t0x00777777, 0x00939393, 0x00868686, 0x00838383,\n\t0x002a2a2a, 0x00c7c7c7, 0x005b5b5b, 0x00e9e9e9,\n\t0x00eeeeee, 0x008f8f8f, 0x00010101, 0x003d3d3d,\n};\n\nstatic const u32 camellia_sp3033[256] = {\n\t0x38003838, 0x41004141, 0x16001616, 0x76007676,\n\t0xd900d9d9, 0x93009393, 0x60006060, 0xf200f2f2,\n\t0x72007272, 0xc200c2c2, 0xab00abab, 0x9a009a9a,\n\t0x75007575, 0x06000606, 0x57005757, 0xa000a0a0,\n\t0x91009191, 0xf700f7f7, 0xb500b5b5, 0xc900c9c9,\n\t0xa200a2a2, 0x8c008c8c, 0xd200d2d2, 0x90009090,\n\t0xf600f6f6, 0x07000707, 0xa700a7a7, 0x27002727,\n\t0x8e008e8e, 0xb200b2b2, 0x49004949, 0xde00dede,\n\t0x43004343, 0x5c005c5c, 0xd700d7d7, 0xc700c7c7,\n\t0x3e003e3e, 0xf500f5f5, 0x8f008f8f, 0x67006767,\n\t0x1f001f1f, 0x18001818, 0x6e006e6e, 0xaf00afaf,\n\t0x2f002f2f, 0xe200e2e2, 0x85008585, 0x0d000d0d,\n\t0x53005353, 0xf000f0f0, 0x9c009c9c, 0x65006565,\n\t0xea00eaea, 0xa300a3a3, 0xae00aeae, 0x9e009e9e,\n\t0xec00ecec, 0x80008080, 0x2d002d2d, 0x6b006b6b,\n\t0xa800a8a8, 0x2b002b2b, 0x36003636, 0xa600a6a6,\n\t0xc500c5c5, 0x86008686, 0x4d004d4d, 0x33003333,\n\t0xfd00fdfd, 0x66006666, 0x58005858, 0x96009696,\n\t0x3a003a3a, 0x09000909, 0x95009595, 0x10001010,\n\t0x78007878, 0xd800d8d8, 0x42004242, 0xcc00cccc,\n\t0xef00efef, 0x26002626, 0xe500e5e5, 0x61006161,\n\t0x1a001a1a, 0x3f003f3f, 0x3b003b3b, 0x82008282,\n\t0xb600b6b6, 0xdb00dbdb, 0xd400d4d4, 0x98009898,\n\t0xe800e8e8, 0x8b008b8b, 0x02000202, 0xeb00ebeb,\n\t0x0a000a0a, 0x2c002c2c, 0x1d001d1d, 0xb000b0b0,\n\t0x6f006f6f, 0x8d008d8d, 0x88008888, 0x0e000e0e,\n\t0x19001919, 0x87008787, 0x4e004e4e, 0x0b000b0b,\n\t0xa900a9a9, 0x0c000c0c, 0x79007979, 0x11001111,\n\t0x7f007f7f, 0x22002222, 0xe700e7e7, 0x59005959,\n\t0xe100e1e1, 0xda00dada, 0x3d003d3d, 0xc800c8c8,\n\t0x12001212, 0x04000404, 0x74007474, 0x54005454,\n\t0x30003030, 0x7e007e7e, 0xb400b4b4, 0x28002828,\n\t0x55005555, 0x68006868, 0x50005050, 0xbe00bebe,\n\t0xd000d0d0, 0xc400c4c4, 0x31003131, 0xcb00cbcb,\n\t0x2a002a2a, 0xad00adad, 0x0f000f0f, 0xca00caca,\n\t0x70007070, 0xff00ffff, 0x32003232, 0x69006969,\n\t0x08000808, 0x62006262, 0x00000000, 0x24002424,\n\t0xd100d1d1, 0xfb00fbfb, 0xba00baba, 0xed00eded,\n\t0x45004545, 0x81008181, 0x73007373, 0x6d006d6d,\n\t0x84008484, 0x9f009f9f, 0xee00eeee, 0x4a004a4a,\n\t0xc300c3c3, 0x2e002e2e, 0xc100c1c1, 0x01000101,\n\t0xe600e6e6, 0x25002525, 0x48004848, 0x99009999,\n\t0xb900b9b9, 0xb300b3b3, 0x7b007b7b, 0xf900f9f9,\n\t0xce00cece, 0xbf00bfbf, 0xdf00dfdf, 0x71007171,\n\t0x29002929, 0xcd00cdcd, 0x6c006c6c, 0x13001313,\n\t0x64006464, 0x9b009b9b, 0x63006363, 0x9d009d9d,\n\t0xc000c0c0, 0x4b004b4b, 0xb700b7b7, 0xa500a5a5,\n\t0x89008989, 0x5f005f5f, 0xb100b1b1, 0x17001717,\n\t0xf400f4f4, 0xbc00bcbc, 0xd300d3d3, 0x46004646,\n\t0xcf00cfcf, 0x37003737, 0x5e005e5e, 0x47004747,\n\t0x94009494, 0xfa00fafa, 0xfc00fcfc, 0x5b005b5b,\n\t0x97009797, 0xfe00fefe, 0x5a005a5a, 0xac00acac,\n\t0x3c003c3c, 0x4c004c4c, 0x03000303, 0x35003535,\n\t0xf300f3f3, 0x23002323, 0xb800b8b8, 0x5d005d5d,\n\t0x6a006a6a, 0x92009292, 0xd500d5d5, 0x21002121,\n\t0x44004444, 0x51005151, 0xc600c6c6, 0x7d007d7d,\n\t0x39003939, 0x83008383, 0xdc00dcdc, 0xaa00aaaa,\n\t0x7c007c7c, 0x77007777, 0x56005656, 0x05000505,\n\t0x1b001b1b, 0xa400a4a4, 0x15001515, 0x34003434,\n\t0x1e001e1e, 0x1c001c1c, 0xf800f8f8, 0x52005252,\n\t0x20002020, 0x14001414, 0xe900e9e9, 0xbd00bdbd,\n\t0xdd00dddd, 0xe400e4e4, 0xa100a1a1, 0xe000e0e0,\n\t0x8a008a8a, 0xf100f1f1, 0xd600d6d6, 0x7a007a7a,\n\t0xbb00bbbb, 0xe300e3e3, 0x40004040, 0x4f004f4f,\n};\n\nstatic const u32 camellia_sp4404[256] = {\n\t0x70700070, 0x2c2c002c, 0xb3b300b3, 0xc0c000c0,\n\t0xe4e400e4, 0x57570057, 0xeaea00ea, 0xaeae00ae,\n\t0x23230023, 0x6b6b006b, 0x45450045, 0xa5a500a5,\n\t0xeded00ed, 0x4f4f004f, 0x1d1d001d, 0x92920092,\n\t0x86860086, 0xafaf00af, 0x7c7c007c, 0x1f1f001f,\n\t0x3e3e003e, 0xdcdc00dc, 0x5e5e005e, 0x0b0b000b,\n\t0xa6a600a6, 0x39390039, 0xd5d500d5, 0x5d5d005d,\n\t0xd9d900d9, 0x5a5a005a, 0x51510051, 0x6c6c006c,\n\t0x8b8b008b, 0x9a9a009a, 0xfbfb00fb, 0xb0b000b0,\n\t0x74740074, 0x2b2b002b, 0xf0f000f0, 0x84840084,\n\t0xdfdf00df, 0xcbcb00cb, 0x34340034, 0x76760076,\n\t0x6d6d006d, 0xa9a900a9, 0xd1d100d1, 0x04040004,\n\t0x14140014, 0x3a3a003a, 0xdede00de, 0x11110011,\n\t0x32320032, 0x9c9c009c, 0x53530053, 0xf2f200f2,\n\t0xfefe00fe, 0xcfcf00cf, 0xc3c300c3, 0x7a7a007a,\n\t0x24240024, 0xe8e800e8, 0x60600060, 0x69690069,\n\t0xaaaa00aa, 0xa0a000a0, 0xa1a100a1, 0x62620062,\n\t0x54540054, 0x1e1e001e, 0xe0e000e0, 0x64640064,\n\t0x10100010, 0x00000000, 0xa3a300a3, 0x75750075,\n\t0x8a8a008a, 0xe6e600e6, 0x09090009, 0xdddd00dd,\n\t0x87870087, 0x83830083, 0xcdcd00cd, 0x90900090,\n\t0x73730073, 0xf6f600f6, 0x9d9d009d, 0xbfbf00bf,\n\t0x52520052, 0xd8d800d8, 0xc8c800c8, 0xc6c600c6,\n\t0x81810081, 0x6f6f006f, 0x13130013, 0x63630063,\n\t0xe9e900e9, 0xa7a700a7, 0x9f9f009f, 0xbcbc00bc,\n\t0x29290029, 0xf9f900f9, 0x2f2f002f, 0xb4b400b4,\n\t0x78780078, 0x06060006, 0xe7e700e7, 0x71710071,\n\t0xd4d400d4, 0xabab00ab, 0x88880088, 0x8d8d008d,\n\t0x72720072, 0xb9b900b9, 0xf8f800f8, 0xacac00ac,\n\t0x36360036, 0x2a2a002a, 0x3c3c003c, 0xf1f100f1,\n\t0x40400040, 0xd3d300d3, 0xbbbb00bb, 0x43430043,\n\t0x15150015, 0xadad00ad, 0x77770077, 0x80800080,\n\t0x82820082, 0xecec00ec, 0x27270027, 0xe5e500e5,\n\t0x85850085, 0x35350035, 0x0c0c000c, 0x41410041,\n\t0xefef00ef, 0x93930093, 0x19190019, 0x21210021,\n\t0x0e0e000e, 0x4e4e004e, 0x65650065, 0xbdbd00bd,\n\t0xb8b800b8, 0x8f8f008f, 0xebeb00eb, 0xcece00ce,\n\t0x30300030, 0x5f5f005f, 0xc5c500c5, 0x1a1a001a,\n\t0xe1e100e1, 0xcaca00ca, 0x47470047, 0x3d3d003d,\n\t0x01010001, 0xd6d600d6, 0x56560056, 0x4d4d004d,\n\t0x0d0d000d, 0x66660066, 0xcccc00cc, 0x2d2d002d,\n\t0x12120012, 0x20200020, 0xb1b100b1, 0x99990099,\n\t0x4c4c004c, 0xc2c200c2, 0x7e7e007e, 0x05050005,\n\t0xb7b700b7, 0x31310031, 0x17170017, 0xd7d700d7,\n\t0x58580058, 0x61610061, 0x1b1b001b, 0x1c1c001c,\n\t0x0f0f000f, 0x16160016, 0x18180018, 0x22220022,\n\t0x44440044, 0xb2b200b2, 0xb5b500b5, 0x91910091,\n\t0x08080008, 0xa8a800a8, 0xfcfc00fc, 0x50500050,\n\t0xd0d000d0, 0x7d7d007d, 0x89890089, 0x97970097,\n\t0x5b5b005b, 0x95950095, 0xffff00ff, 0xd2d200d2,\n\t0xc4c400c4, 0x48480048, 0xf7f700f7, 0xdbdb00db,\n\t0x03030003, 0xdada00da, 0x3f3f003f, 0x94940094,\n\t0x5c5c005c, 0x02020002, 0x4a4a004a, 0x33330033,\n\t0x67670067, 0xf3f300f3, 0x7f7f007f, 0xe2e200e2,\n\t0x9b9b009b, 0x26260026, 0x37370037, 0x3b3b003b,\n\t0x96960096, 0x4b4b004b, 0xbebe00be, 0x2e2e002e,\n\t0x79790079, 0x8c8c008c, 0x6e6e006e, 0x8e8e008e,\n\t0xf5f500f5, 0xb6b600b6, 0xfdfd00fd, 0x59590059,\n\t0x98980098, 0x6a6a006a, 0x46460046, 0xbaba00ba,\n\t0x25250025, 0x42420042, 0xa2a200a2, 0xfafa00fa,\n\t0x07070007, 0x55550055, 0xeeee00ee, 0x0a0a000a,\n\t0x49490049, 0x68680068, 0x38380038, 0xa4a400a4,\n\t0x28280028, 0x7b7b007b, 0xc9c900c9, 0xc1c100c1,\n\t0xe3e300e3, 0xf4f400f4, 0xc7c700c7, 0x9e9e009e,\n};\n\n\n#define CAMELLIA_MIN_KEY_SIZE        16\n#define CAMELLIA_MAX_KEY_SIZE        32\n#define CAMELLIA_BLOCK_SIZE          16\n#define CAMELLIA_TABLE_BYTE_LEN     272\n\n \n\n\n \n\n#define CAMELLIA_SIGMA1L (0xA09E667FL)\n#define CAMELLIA_SIGMA1R (0x3BCC908BL)\n#define CAMELLIA_SIGMA2L (0xB67AE858L)\n#define CAMELLIA_SIGMA2R (0x4CAA73B2L)\n#define CAMELLIA_SIGMA3L (0xC6EF372FL)\n#define CAMELLIA_SIGMA3R (0xE94F82BEL)\n#define CAMELLIA_SIGMA4L (0x54FF53A5L)\n#define CAMELLIA_SIGMA4R (0xF1D36F1CL)\n#define CAMELLIA_SIGMA5L (0x10E527FAL)\n#define CAMELLIA_SIGMA5R (0xDE682D1DL)\n#define CAMELLIA_SIGMA6L (0xB05688C2L)\n#define CAMELLIA_SIGMA6R (0xB3E6C1FDL)\n\n \n#define ROLDQ(ll, lr, rl, rr, w0, w1, bits) ({\t\t\\\n\tw0 = ll;\t\t\t\t\t\\\n\tll = (ll << bits) + (lr >> (32 - bits));\t\\\n\tlr = (lr << bits) + (rl >> (32 - bits));\t\\\n\trl = (rl << bits) + (rr >> (32 - bits));\t\\\n\trr = (rr << bits) + (w0 >> (32 - bits));\t\\\n})\n\n#define ROLDQo32(ll, lr, rl, rr, w0, w1, bits) ({\t\\\n\tw0 = ll;\t\t\t\t\t\\\n\tw1 = lr;\t\t\t\t\t\\\n\tll = (lr << (bits - 32)) + (rl >> (64 - bits));\t\\\n\tlr = (rl << (bits - 32)) + (rr >> (64 - bits));\t\\\n\trl = (rr << (bits - 32)) + (w0 >> (64 - bits));\t\\\n\trr = (w0 << (bits - 32)) + (w1 >> (64 - bits));\t\\\n})\n\n#define CAMELLIA_F(xl, xr, kl, kr, yl, yr, il, ir, t0, t1) ({\t\\\n\til = xl ^ kl;\t\t\t\t\t\t\\\n\tir = xr ^ kr;\t\t\t\t\t\t\\\n\tt0 = il >> 16;\t\t\t\t\t\t\\\n\tt1 = ir >> 16;\t\t\t\t\t\t\\\n\tyl = camellia_sp1110[(u8)(ir)]\t\t\t\t\\\n\t   ^ camellia_sp0222[(u8)(t1 >> 8)]\t\t\t\\\n\t   ^ camellia_sp3033[(u8)(t1)]\t\t\t\t\\\n\t   ^ camellia_sp4404[(u8)(ir >> 8)];\t\t\t\\\n\tyr = camellia_sp1110[(u8)(t0 >> 8)]\t\t\t\\\n\t   ^ camellia_sp0222[(u8)(t0)]\t\t\t\t\\\n\t   ^ camellia_sp3033[(u8)(il >> 8)]\t\t\t\\\n\t   ^ camellia_sp4404[(u8)(il)];\t\t\t\t\\\n\tyl ^= yr;\t\t\t\t\t\t\\\n\tyr = ror32(yr, 8);\t\t\t\t\t\\\n\tyr ^= yl;\t\t\t\t\t\t\\\n})\n\n#define SUBKEY_L(INDEX) (subkey[(INDEX)*2])\n#define SUBKEY_R(INDEX) (subkey[(INDEX)*2 + 1])\n\nstatic void camellia_setup_tail(u32 *subkey, u32 *subL, u32 *subR, int max)\n{\n\tu32 dw, tl, tr;\n\tu32 kw4l, kw4r;\n\n\t \n\t \n\tsubL[3] ^= subL[1]; subR[3] ^= subR[1];\n\t \n\tsubL[5] ^= subL[1]; subR[5] ^= subR[1];\n\t \n\tsubL[7] ^= subL[1]; subR[7] ^= subR[1];\n\tsubL[1] ^= subR[1] & ~subR[9];\n\tdw = subL[1] & subL[9];\n\tsubR[1] ^= rol32(dw, 1);  \n\t \n\tsubL[11] ^= subL[1]; subR[11] ^= subR[1];\n\t \n\tsubL[13] ^= subL[1]; subR[13] ^= subR[1];\n\t \n\tsubL[15] ^= subL[1]; subR[15] ^= subR[1];\n\tsubL[1] ^= subR[1] & ~subR[17];\n\tdw = subL[1] & subL[17];\n\tsubR[1] ^= rol32(dw, 1);  \n\t \n\tsubL[19] ^= subL[1]; subR[19] ^= subR[1];\n\t \n\tsubL[21] ^= subL[1]; subR[21] ^= subR[1];\n\t \n\tsubL[23] ^= subL[1]; subR[23] ^= subR[1];\n\tif (max == 24) {\n\t\t \n\t\tsubL[24] ^= subL[1]; subR[24] ^= subR[1];\n\n\t \n\t\tkw4l = subL[25]; kw4r = subR[25];\n\t} else {\n\t\tsubL[1] ^= subR[1] & ~subR[25];\n\t\tdw = subL[1] & subL[25];\n\t\tsubR[1] ^= rol32(dw, 1);  \n\t\t \n\t\tsubL[27] ^= subL[1]; subR[27] ^= subR[1];\n\t\t \n\t\tsubL[29] ^= subL[1]; subR[29] ^= subR[1];\n\t\t \n\t\tsubL[31] ^= subL[1]; subR[31] ^= subR[1];\n\t\t \n\t\tsubL[32] ^= subL[1]; subR[32] ^= subR[1];\n\n\t \n\t\tkw4l = subL[33]; kw4r = subR[33];\n\t\t \n\t\tsubL[30] ^= kw4l; subR[30] ^= kw4r;\n\t\t \n\t\tsubL[28] ^= kw4l; subR[28] ^= kw4r;\n\t\t \n\t\tsubL[26] ^= kw4l; subR[26] ^= kw4r;\n\t\tkw4l ^= kw4r & ~subR[24];\n\t\tdw = kw4l & subL[24];\n\t\tkw4r ^= rol32(dw, 1);  \n\t}\n\t \n\tsubL[22] ^= kw4l; subR[22] ^= kw4r;\n\t \n\tsubL[20] ^= kw4l; subR[20] ^= kw4r;\n\t \n\tsubL[18] ^= kw4l; subR[18] ^= kw4r;\n\tkw4l ^= kw4r & ~subR[16];\n\tdw = kw4l & subL[16];\n\tkw4r ^= rol32(dw, 1);  \n\t \n\tsubL[14] ^= kw4l; subR[14] ^= kw4r;\n\t \n\tsubL[12] ^= kw4l; subR[12] ^= kw4r;\n\t \n\tsubL[10] ^= kw4l; subR[10] ^= kw4r;\n\tkw4l ^= kw4r & ~subR[8];\n\tdw = kw4l & subL[8];\n\tkw4r ^= rol32(dw, 1);  \n\t \n\tsubL[6] ^= kw4l; subR[6] ^= kw4r;\n\t \n\tsubL[4] ^= kw4l; subR[4] ^= kw4r;\n\t \n\tsubL[2] ^= kw4l; subR[2] ^= kw4r;\n\t \n\tsubL[0] ^= kw4l; subR[0] ^= kw4r;\n\n\t \n\tSUBKEY_L(0) = subL[0] ^ subL[2]; \n\tSUBKEY_R(0) = subR[0] ^ subR[2];\n\tSUBKEY_L(2) = subL[3];        \n\tSUBKEY_R(2) = subR[3];\n\tSUBKEY_L(3) = subL[2] ^ subL[4];  \n\tSUBKEY_R(3) = subR[2] ^ subR[4];\n\tSUBKEY_L(4) = subL[3] ^ subL[5];  \n\tSUBKEY_R(4) = subR[3] ^ subR[5];\n\tSUBKEY_L(5) = subL[4] ^ subL[6];  \n\tSUBKEY_R(5) = subR[4] ^ subR[6];\n\tSUBKEY_L(6) = subL[5] ^ subL[7];  \n\tSUBKEY_R(6) = subR[5] ^ subR[7];\n\ttl = subL[10] ^ (subR[10] & ~subR[8]);\n\tdw = tl & subL[8];   \n\ttr = subR[10] ^ rol32(dw, 1);\n\tSUBKEY_L(7) = subL[6] ^ tl;  \n\tSUBKEY_R(7) = subR[6] ^ tr;\n\tSUBKEY_L(8) = subL[8];        \n\tSUBKEY_R(8) = subR[8];\n\tSUBKEY_L(9) = subL[9];        \n\tSUBKEY_R(9) = subR[9];\n\ttl = subL[7] ^ (subR[7] & ~subR[9]);\n\tdw = tl & subL[9];   \n\ttr = subR[7] ^ rol32(dw, 1);\n\tSUBKEY_L(10) = tl ^ subL[11];  \n\tSUBKEY_R(10) = tr ^ subR[11];\n\tSUBKEY_L(11) = subL[10] ^ subL[12];  \n\tSUBKEY_R(11) = subR[10] ^ subR[12];\n\tSUBKEY_L(12) = subL[11] ^ subL[13];  \n\tSUBKEY_R(12) = subR[11] ^ subR[13];\n\tSUBKEY_L(13) = subL[12] ^ subL[14];  \n\tSUBKEY_R(13) = subR[12] ^ subR[14];\n\tSUBKEY_L(14) = subL[13] ^ subL[15];  \n\tSUBKEY_R(14) = subR[13] ^ subR[15];\n\ttl = subL[18] ^ (subR[18] & ~subR[16]);\n\tdw = tl & subL[16];  \n\ttr = subR[18] ^ rol32(dw, 1);\n\tSUBKEY_L(15) = subL[14] ^ tl;  \n\tSUBKEY_R(15) = subR[14] ^ tr;\n\tSUBKEY_L(16) = subL[16];      \n\tSUBKEY_R(16) = subR[16];\n\tSUBKEY_L(17) = subL[17];      \n\tSUBKEY_R(17) = subR[17];\n\ttl = subL[15] ^ (subR[15] & ~subR[17]);\n\tdw = tl & subL[17];  \n\ttr = subR[15] ^ rol32(dw, 1);\n\tSUBKEY_L(18) = tl ^ subL[19];  \n\tSUBKEY_R(18) = tr ^ subR[19];\n\tSUBKEY_L(19) = subL[18] ^ subL[20];  \n\tSUBKEY_R(19) = subR[18] ^ subR[20];\n\tSUBKEY_L(20) = subL[19] ^ subL[21];  \n\tSUBKEY_R(20) = subR[19] ^ subR[21];\n\tSUBKEY_L(21) = subL[20] ^ subL[22];  \n\tSUBKEY_R(21) = subR[20] ^ subR[22];\n\tSUBKEY_L(22) = subL[21] ^ subL[23];  \n\tSUBKEY_R(22) = subR[21] ^ subR[23];\n\tif (max == 24) {\n\t\tSUBKEY_L(23) = subL[22];      \n\t\tSUBKEY_R(23) = subR[22];\n\t\tSUBKEY_L(24) = subL[24] ^ subL[23];  \n\t\tSUBKEY_R(24) = subR[24] ^ subR[23];\n\t} else {\n\t\ttl = subL[26] ^ (subR[26] & ~subR[24]);\n\t\tdw = tl & subL[24];  \n\t\ttr = subR[26] ^ rol32(dw, 1);\n\t\tSUBKEY_L(23) = subL[22] ^ tl;  \n\t\tSUBKEY_R(23) = subR[22] ^ tr;\n\t\tSUBKEY_L(24) = subL[24];      \n\t\tSUBKEY_R(24) = subR[24];\n\t\tSUBKEY_L(25) = subL[25];      \n\t\tSUBKEY_R(25) = subR[25];\n\t\ttl = subL[23] ^ (subR[23] & ~subR[25]);\n\t\tdw = tl & subL[25];  \n\t\ttr = subR[23] ^ rol32(dw, 1);\n\t\tSUBKEY_L(26) = tl ^ subL[27];  \n\t\tSUBKEY_R(26) = tr ^ subR[27];\n\t\tSUBKEY_L(27) = subL[26] ^ subL[28];  \n\t\tSUBKEY_R(27) = subR[26] ^ subR[28];\n\t\tSUBKEY_L(28) = subL[27] ^ subL[29];  \n\t\tSUBKEY_R(28) = subR[27] ^ subR[29];\n\t\tSUBKEY_L(29) = subL[28] ^ subL[30];  \n\t\tSUBKEY_R(29) = subR[28] ^ subR[30];\n\t\tSUBKEY_L(30) = subL[29] ^ subL[31];  \n\t\tSUBKEY_R(30) = subR[29] ^ subR[31];\n\t\tSUBKEY_L(31) = subL[30];      \n\t\tSUBKEY_R(31) = subR[30];\n\t\tSUBKEY_L(32) = subL[32] ^ subL[31];  \n\t\tSUBKEY_R(32) = subR[32] ^ subR[31];\n\t}\n}\n\nstatic void camellia_setup128(const unsigned char *key, u32 *subkey)\n{\n\tu32 kll, klr, krl, krr;\n\tu32 il, ir, t0, t1, w0, w1;\n\tu32 subL[26];\n\tu32 subR[26];\n\n\t \n\tkll = get_unaligned_be32(key);\n\tklr = get_unaligned_be32(key + 4);\n\tkrl = get_unaligned_be32(key + 8);\n\tkrr = get_unaligned_be32(key + 12);\n\n\t \n\t \n\tsubL[0] = kll; subR[0] = klr;\n\t \n\tsubL[1] = krl; subR[1] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[4] = kll; subR[4] = klr;\n\t \n\tsubL[5] = krl; subR[5] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 30);\n\t \n\tsubL[10] = kll; subR[10] = klr;\n\t \n\tsubL[11] = krl; subR[11] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[13] = krl; subR[13] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 17);\n\t \n\tsubL[16] = kll; subR[16] = klr;\n\t \n\tsubL[17] = krl; subR[17] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 17);\n\t \n\tsubL[18] = kll; subR[18] = klr;\n\t \n\tsubL[19] = krl; subR[19] = krr;\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 17);\n\t \n\tsubL[22] = kll; subR[22] = klr;\n\t \n\tsubL[23] = krl; subR[23] = krr;\n\n\t \n\tkll = subL[0]; klr = subR[0];\n\tkrl = subL[1]; krr = subR[1];\n\tCAMELLIA_F(kll, klr,\n\t\t   CAMELLIA_SIGMA1L, CAMELLIA_SIGMA1R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkrl ^= w0; krr ^= w1;\n\tCAMELLIA_F(krl, krr,\n\t\t   CAMELLIA_SIGMA2L, CAMELLIA_SIGMA2R,\n\t\t   kll, klr, il, ir, t0, t1);\n\t \n\tCAMELLIA_F(kll, klr,\n\t\t   CAMELLIA_SIGMA3L, CAMELLIA_SIGMA3R,\n\t\t   krl, krr, il, ir, t0, t1);\n\tkrl ^= w0; krr ^= w1;\n\tCAMELLIA_F(krl, krr,\n\t\t   CAMELLIA_SIGMA4L, CAMELLIA_SIGMA4R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkll ^= w0; klr ^= w1;\n\n\t \n\t \n\tsubL[2] = kll; subR[2] = klr;\n\tsubL[3] = krl; subR[3] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[6] = kll; subR[6] = klr;\n\tsubL[7] = krl; subR[7] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[8] = kll; subR[8] = klr;\n\tsubL[9] = krl; subR[9] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[12] = kll; subR[12] = klr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[14] = kll; subR[14] = klr;\n\tsubL[15] = krl; subR[15] = krr;\n\tROLDQo32(kll, klr, krl, krr, w0, w1, 34);\n\t \n\tsubL[20] = kll; subR[20] = klr;\n\tsubL[21] = krl; subR[21] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 17);\n\t \n\tsubL[24] = kll; subR[24] = klr;\n\tsubL[25] = krl; subR[25] = krr;\n\n\tcamellia_setup_tail(subkey, subL, subR, 24);\n}\n\nstatic void camellia_setup256(const unsigned char *key, u32 *subkey)\n{\n\tu32 kll, klr, krl, krr;         \n\tu32 krll, krlr, krrl, krrr;     \n\tu32 il, ir, t0, t1, w0, w1;     \n\tu32 subL[34];\n\tu32 subR[34];\n\n\t \n\tkll = get_unaligned_be32(key);\n\tklr = get_unaligned_be32(key + 4);\n\tkrl = get_unaligned_be32(key + 8);\n\tkrr = get_unaligned_be32(key + 12);\n\tkrll = get_unaligned_be32(key + 16);\n\tkrlr = get_unaligned_be32(key + 20);\n\tkrrl = get_unaligned_be32(key + 24);\n\tkrrr = get_unaligned_be32(key + 28);\n\n\t \n\t \n\tsubL[0] = kll; subR[0] = klr;\n\t \n\tsubL[1] = krl; subR[1] = krr;\n\tROLDQo32(kll, klr, krl, krr, w0, w1, 45);\n\t \n\tsubL[12] = kll; subR[12] = klr;\n\t \n\tsubL[13] = krl; subR[13] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[16] = kll; subR[16] = klr;\n\t \n\tsubL[17] = krl; subR[17] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 17);\n\t \n\tsubL[22] = kll; subR[22] = klr;\n\t \n\tsubL[23] = krl; subR[23] = krr;\n\tROLDQo32(kll, klr, krl, krr, w0, w1, 34);\n\t \n\tsubL[30] = kll; subR[30] = klr;\n\t \n\tsubL[31] = krl; subR[31] = krr;\n\n\t \n\tROLDQ(krll, krlr, krrl, krrr, w0, w1, 15);\n\t \n\tsubL[4] = krll; subR[4] = krlr;\n\t \n\tsubL[5] = krrl; subR[5] = krrr;\n\tROLDQ(krll, krlr, krrl, krrr, w0, w1, 15);\n\t \n\tsubL[8] = krll; subR[8] = krlr;\n\t \n\tsubL[9] = krrl; subR[9] = krrr;\n\tROLDQ(krll, krlr, krrl, krrr, w0, w1, 30);\n\t \n\tsubL[18] = krll; subR[18] = krlr;\n\t \n\tsubL[19] = krrl; subR[19] = krrr;\n\tROLDQo32(krll, krlr, krrl, krrr, w0, w1, 34);\n\t \n\tsubL[26] = krll; subR[26] = krlr;\n\t \n\tsubL[27] = krrl; subR[27] = krrr;\n\tROLDQo32(krll, krlr, krrl, krrr, w0, w1, 34);\n\n\t \n\tkll = subL[0] ^ krll; klr = subR[0] ^ krlr;\n\tkrl = subL[1] ^ krrl; krr = subR[1] ^ krrr;\n\tCAMELLIA_F(kll, klr,\n\t\t   CAMELLIA_SIGMA1L, CAMELLIA_SIGMA1R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkrl ^= w0; krr ^= w1;\n\tCAMELLIA_F(krl, krr,\n\t\t   CAMELLIA_SIGMA2L, CAMELLIA_SIGMA2R,\n\t\t   kll, klr, il, ir, t0, t1);\n\tkll ^= krll; klr ^= krlr;\n\tCAMELLIA_F(kll, klr,\n\t\t   CAMELLIA_SIGMA3L, CAMELLIA_SIGMA3R,\n\t\t   krl, krr, il, ir, t0, t1);\n\tkrl ^= w0 ^ krrl; krr ^= w1 ^ krrr;\n\tCAMELLIA_F(krl, krr,\n\t\t   CAMELLIA_SIGMA4L, CAMELLIA_SIGMA4R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkll ^= w0; klr ^= w1;\n\n\t \n\tkrll ^= kll; krlr ^= klr;\n\tkrrl ^= krl; krrr ^= krr;\n\tCAMELLIA_F(krll, krlr,\n\t\t   CAMELLIA_SIGMA5L, CAMELLIA_SIGMA5R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkrrl ^= w0; krrr ^= w1;\n\tCAMELLIA_F(krrl, krrr,\n\t\t   CAMELLIA_SIGMA6L, CAMELLIA_SIGMA6R,\n\t\t   w0, w1, il, ir, t0, t1);\n\tkrll ^= w0; krlr ^= w1;\n\n\t \n\tROLDQ(kll, klr, krl, krr, w0, w1, 15);\n\t \n\tsubL[6] = kll; subR[6] = klr;\n\t \n\tsubL[7] = krl; subR[7] = krr;\n\tROLDQ(kll, klr, krl, krr, w0, w1, 30);\n\t \n\tsubL[14] = kll; subR[14] = klr;\n\t \n\tsubL[15] = krl; subR[15] = krr;\n\t \n\t \n\tsubL[24] = klr; subR[24] = krl;\n\t \n\tsubL[25] = krr; subR[25] = kll;\n\t \n\tROLDQo32(kll, klr, krl, krr, w0, w1, 49);\n\t \n\tsubL[28] = kll; subR[28] = klr;\n\t \n\tsubL[29] = krl; subR[29] = krr;\n\n\t \n\t \n\tsubL[2] = krll; subR[2] = krlr;\n\t \n\tsubL[3] = krrl; subR[3] = krrr;\n\tROLDQ(krll, krlr, krrl, krrr, w0, w1, 30);\n\t \n\tsubL[10] = krll; subR[10] = krlr;\n\t \n\tsubL[11] = krrl; subR[11] = krrr;\n\tROLDQ(krll, krlr, krrl, krrr, w0, w1, 30);\n\t \n\tsubL[20] = krll; subR[20] = krlr;\n\t \n\tsubL[21] = krrl; subR[21] = krrr;\n\tROLDQo32(krll, krlr, krrl, krrr, w0, w1, 51);\n\t \n\tsubL[32] = krll; subR[32] = krlr;\n\t \n\tsubL[33] = krrl; subR[33] = krrr;\n\n\tcamellia_setup_tail(subkey, subL, subR, 32);\n}\n\nstatic void camellia_setup192(const unsigned char *key, u32 *subkey)\n{\n\tunsigned char kk[32];\n\tu32 krll, krlr, krrl, krrr;\n\n\tmemcpy(kk, key, 24);\n\tmemcpy((unsigned char *)&krll, key+16, 4);\n\tmemcpy((unsigned char *)&krlr, key+20, 4);\n\tkrrl = ~krll;\n\tkrrr = ~krlr;\n\tmemcpy(kk+24, (unsigned char *)&krrl, 4);\n\tmemcpy(kk+28, (unsigned char *)&krrr, 4);\n\tcamellia_setup256(kk, subkey);\n}\n\n\n \n#define CAMELLIA_FLS(ll, lr, rl, rr, kll, klr, krl, krr, t0, t1, t2, t3) ({ \\\n\tt0 = kll;\t\t\t\t\t\t\t\\\n\tt2 = krr;\t\t\t\t\t\t\t\\\n\tt0 &= ll;\t\t\t\t\t\t\t\\\n\tt2 |= rr;\t\t\t\t\t\t\t\\\n\trl ^= t2;\t\t\t\t\t\t\t\\\n\tlr ^= rol32(t0, 1);\t\t\t\t\t\t\\\n\tt3 = krl;\t\t\t\t\t\t\t\\\n\tt1 = klr;\t\t\t\t\t\t\t\\\n\tt3 &= rl;\t\t\t\t\t\t\t\\\n\tt1 |= lr;\t\t\t\t\t\t\t\\\n\tll ^= t1;\t\t\t\t\t\t\t\\\n\trr ^= rol32(t3, 1);\t\t\t\t\t\t\\\n})\n\n#define CAMELLIA_ROUNDSM(xl, xr, kl, kr, yl, yr, il, ir) ({\t\t\\\n\tyl ^= kl;\t\t\t\t\t\t\t\\\n\tyr ^= kr;\t\t\t\t\t\t\t\\\n\tir =  camellia_sp1110[(u8)xr];\t\t\t\t\t\\\n\til =  camellia_sp1110[(u8)(xl >> 24)];\t\t\t\t\\\n\tir ^= camellia_sp0222[(u8)(xr >> 24)];\t\t\t\t\\\n\til ^= camellia_sp0222[(u8)(xl >> 16)];\t\t\t\t\\\n\tir ^= camellia_sp3033[(u8)(xr >> 16)];\t\t\t\t\\\n\til ^= camellia_sp3033[(u8)(xl >> 8)];\t\t\t\t\\\n\tir ^= camellia_sp4404[(u8)(xr >> 8)];\t\t\t\t\\\n\til ^= camellia_sp4404[(u8)xl];\t\t\t\t\t\\\n\tir ^= il;\t\t\t\t\t\t\t\\\n\tyl ^= ir;\t\t\t\t\t\t\t\\\n\tyr ^= ror32(il, 8) ^ ir;\t\t\t\t\t\\\n})\n\n \nstatic void camellia_do_encrypt(const u32 *subkey, u32 *io, unsigned max)\n{\n\tu32 il, ir, t0, t1;             \n\n\t \n\tio[0] ^= SUBKEY_L(0);\n\tio[1] ^= SUBKEY_R(0);\n\n\t \n#define ROUNDS(i) ({ \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 2), SUBKEY_R(i + 2), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 3), SUBKEY_R(i + 3), \\\n\t\t\t io[0], io[1], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 4), SUBKEY_R(i + 4), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 5), SUBKEY_R(i + 5), \\\n\t\t\t io[0], io[1], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 6), SUBKEY_R(i + 6), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 7), SUBKEY_R(i + 7), \\\n\t\t\t io[0], io[1], il, ir); \\\n})\n#define FLS(i) ({ \\\n\tCAMELLIA_FLS(io[0], io[1], io[2], io[3], \\\n\t\t     SUBKEY_L(i + 0), SUBKEY_R(i + 0), \\\n\t\t     SUBKEY_L(i + 1), SUBKEY_R(i + 1), \\\n\t\t     t0, t1, il, ir); \\\n})\n\n\tROUNDS(0);\n\tFLS(8);\n\tROUNDS(8);\n\tFLS(16);\n\tROUNDS(16);\n\tif (max == 32) {\n\t\tFLS(24);\n\t\tROUNDS(24);\n\t}\n\n#undef ROUNDS\n#undef FLS\n\n\t \n\tio[2] ^= SUBKEY_L(max);\n\tio[3] ^= SUBKEY_R(max);\n\t \n}\n\nstatic void camellia_do_decrypt(const u32 *subkey, u32 *io, unsigned i)\n{\n\tu32 il, ir, t0, t1;             \n\n\t \n\tio[0] ^= SUBKEY_L(i);\n\tio[1] ^= SUBKEY_R(i);\n\n\t \n#define ROUNDS(i) ({ \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 7), SUBKEY_R(i + 7), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 6), SUBKEY_R(i + 6), \\\n\t\t\t io[0], io[1], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 5), SUBKEY_R(i + 5), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 4), SUBKEY_R(i + 4), \\\n\t\t\t io[0], io[1], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[0], io[1], \\\n\t\t\t SUBKEY_L(i + 3), SUBKEY_R(i + 3), \\\n\t\t\t io[2], io[3], il, ir); \\\n\tCAMELLIA_ROUNDSM(io[2], io[3], \\\n\t\t\t SUBKEY_L(i + 2), SUBKEY_R(i + 2), \\\n\t\t\t io[0], io[1], il, ir); \\\n})\n#define FLS(i) ({ \\\n\tCAMELLIA_FLS(io[0], io[1], io[2], io[3], \\\n\t\t     SUBKEY_L(i + 1), SUBKEY_R(i + 1), \\\n\t\t     SUBKEY_L(i + 0), SUBKEY_R(i + 0), \\\n\t\t     t0, t1, il, ir); \\\n})\n\n\tif (i == 32) {\n\t\tROUNDS(24);\n\t\tFLS(24);\n\t}\n\tROUNDS(16);\n\tFLS(16);\n\tROUNDS(8);\n\tFLS(8);\n\tROUNDS(0);\n\n#undef ROUNDS\n#undef FLS\n\n\t \n\tio[2] ^= SUBKEY_L(0);\n\tio[3] ^= SUBKEY_R(0);\n\t \n}\n\n\nstruct camellia_ctx {\n\tint key_length;\n\tu32 key_table[CAMELLIA_TABLE_BYTE_LEN / sizeof(u32)];\n};\n\nstatic int\ncamellia_set_key(struct crypto_tfm *tfm, const u8 *in_key,\n\t\t unsigned int key_len)\n{\n\tstruct camellia_ctx *cctx = crypto_tfm_ctx(tfm);\n\tconst unsigned char *key = (const unsigned char *)in_key;\n\n\tif (key_len != 16 && key_len != 24 && key_len != 32)\n\t\treturn -EINVAL;\n\n\tcctx->key_length = key_len;\n\n\tswitch (key_len) {\n\tcase 16:\n\t\tcamellia_setup128(key, cctx->key_table);\n\t\tbreak;\n\tcase 24:\n\t\tcamellia_setup192(key, cctx->key_table);\n\t\tbreak;\n\tcase 32:\n\t\tcamellia_setup256(key, cctx->key_table);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic void camellia_encrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct camellia_ctx *cctx = crypto_tfm_ctx(tfm);\n\tunsigned int max;\n\n\tu32 tmp[4];\n\n\ttmp[0] = get_unaligned_be32(in);\n\ttmp[1] = get_unaligned_be32(in + 4);\n\ttmp[2] = get_unaligned_be32(in + 8);\n\ttmp[3] = get_unaligned_be32(in + 12);\n\n\tif (cctx->key_length == 16)\n\t\tmax = 24;\n\telse\n\t\tmax = 32;  \n\n\tcamellia_do_encrypt(cctx->key_table, tmp, max);\n\n\t \n\tput_unaligned_be32(tmp[2], out);\n\tput_unaligned_be32(tmp[3], out + 4);\n\tput_unaligned_be32(tmp[0], out + 8);\n\tput_unaligned_be32(tmp[1], out + 12);\n}\n\nstatic void camellia_decrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct camellia_ctx *cctx = crypto_tfm_ctx(tfm);\n\tunsigned int max;\n\n\tu32 tmp[4];\n\n\ttmp[0] = get_unaligned_be32(in);\n\ttmp[1] = get_unaligned_be32(in + 4);\n\ttmp[2] = get_unaligned_be32(in + 8);\n\ttmp[3] = get_unaligned_be32(in + 12);\n\n\tif (cctx->key_length == 16)\n\t\tmax = 24;\n\telse\n\t\tmax = 32;  \n\n\tcamellia_do_decrypt(cctx->key_table, tmp, max);\n\n\t \n\tput_unaligned_be32(tmp[2], out);\n\tput_unaligned_be32(tmp[3], out + 4);\n\tput_unaligned_be32(tmp[0], out + 8);\n\tput_unaligned_be32(tmp[1], out + 12);\n}\n\nstatic struct crypto_alg camellia_alg = {\n\t.cra_name\t\t=\t\"camellia\",\n\t.cra_driver_name\t=\t\"camellia-generic\",\n\t.cra_priority\t\t=\t100,\n\t.cra_flags\t\t=\tCRYPTO_ALG_TYPE_CIPHER,\n\t.cra_blocksize\t\t=\tCAMELLIA_BLOCK_SIZE,\n\t.cra_ctxsize\t\t=\tsizeof(struct camellia_ctx),\n\t.cra_module\t\t=\tTHIS_MODULE,\n\t.cra_u\t\t\t=\t{\n\t\t.cipher = {\n\t\t\t.cia_min_keysize\t=\tCAMELLIA_MIN_KEY_SIZE,\n\t\t\t.cia_max_keysize\t=\tCAMELLIA_MAX_KEY_SIZE,\n\t\t\t.cia_setkey\t\t=\tcamellia_set_key,\n\t\t\t.cia_encrypt\t\t=\tcamellia_encrypt,\n\t\t\t.cia_decrypt\t\t=\tcamellia_decrypt\n\t\t}\n\t}\n};\n\nstatic int __init camellia_init(void)\n{\n\treturn crypto_register_alg(&camellia_alg);\n}\n\nstatic void __exit camellia_fini(void)\n{\n\tcrypto_unregister_alg(&camellia_alg);\n}\n\nsubsys_initcall(camellia_init);\nmodule_exit(camellia_fini);\n\nMODULE_DESCRIPTION(\"Camellia Cipher Algorithm\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_CRYPTO(\"camellia\");\nMODULE_ALIAS_CRYPTO(\"camellia-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}