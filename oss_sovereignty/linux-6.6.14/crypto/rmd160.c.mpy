{
  "module_name": "rmd160.c",
  "hash_id": "cde9ca56c2c6b588849675ee06d3f52a553ca3ba2a64914537edf9a22a055b6f",
  "original_prompt": "Ingested from linux-6.6.14/crypto/rmd160.c",
  "human_readable_source": "\n \n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <asm/byteorder.h>\n\n#include \"ripemd.h\"\n\nstruct rmd160_ctx {\n\tu64 byte_count;\n\tu32 state[5];\n\t__le32 buffer[16];\n};\n\n#define K1  RMD_K1\n#define K2  RMD_K2\n#define K3  RMD_K3\n#define K4  RMD_K4\n#define K5  RMD_K5\n#define KK1 RMD_K6\n#define KK2 RMD_K7\n#define KK3 RMD_K8\n#define KK4 RMD_K9\n#define KK5 RMD_K1\n\n#define F1(x, y, z) (x ^ y ^ z)\t\t \n#define F2(x, y, z) (z ^ (x & (y ^ z)))\t \n#define F3(x, y, z) ((x | ~y) ^ z)\n#define F4(x, y, z) (y ^ (z & (x ^ y)))\t \n#define F5(x, y, z) (x ^ (y | ~z))\n\n#define ROUND(a, b, c, d, e, f, k, x, s)  { \\\n\t(a) += f((b), (c), (d)) + le32_to_cpup(&(x)) + (k); \\\n\t(a) = rol32((a), (s)) + (e); \\\n\t(c) = rol32((c), 10); \\\n}\n\nstatic void rmd160_transform(u32 *state, const __le32 *in)\n{\n\tu32 aa, bb, cc, dd, ee, aaa, bbb, ccc, ddd, eee;\n\n\t \n\taa = state[0];\n\tbb = state[1];\n\tcc = state[2];\n\tdd = state[3];\n\tee = state[4];\n\n\t \n\taaa = state[0];\n\tbbb = state[1];\n\tccc = state[2];\n\tddd = state[3];\n\teee = state[4];\n\n\t \n\tROUND(aa, bb, cc, dd, ee, F1, K1, in[0],  11);\n\tROUND(ee, aa, bb, cc, dd, F1, K1, in[1],  14);\n\tROUND(dd, ee, aa, bb, cc, F1, K1, in[2],  15);\n\tROUND(cc, dd, ee, aa, bb, F1, K1, in[3],  12);\n\tROUND(bb, cc, dd, ee, aa, F1, K1, in[4],   5);\n\tROUND(aa, bb, cc, dd, ee, F1, K1, in[5],   8);\n\tROUND(ee, aa, bb, cc, dd, F1, K1, in[6],   7);\n\tROUND(dd, ee, aa, bb, cc, F1, K1, in[7],   9);\n\tROUND(cc, dd, ee, aa, bb, F1, K1, in[8],  11);\n\tROUND(bb, cc, dd, ee, aa, F1, K1, in[9],  13);\n\tROUND(aa, bb, cc, dd, ee, F1, K1, in[10], 14);\n\tROUND(ee, aa, bb, cc, dd, F1, K1, in[11], 15);\n\tROUND(dd, ee, aa, bb, cc, F1, K1, in[12],  6);\n\tROUND(cc, dd, ee, aa, bb, F1, K1, in[13],  7);\n\tROUND(bb, cc, dd, ee, aa, F1, K1, in[14],  9);\n\tROUND(aa, bb, cc, dd, ee, F1, K1, in[15],  8);\n\n\t \n\tROUND(ee, aa, bb, cc, dd, F2, K2, in[7],   7);\n\tROUND(dd, ee, aa, bb, cc, F2, K2, in[4],   6);\n\tROUND(cc, dd, ee, aa, bb, F2, K2, in[13],  8);\n\tROUND(bb, cc, dd, ee, aa, F2, K2, in[1],  13);\n\tROUND(aa, bb, cc, dd, ee, F2, K2, in[10], 11);\n\tROUND(ee, aa, bb, cc, dd, F2, K2, in[6],   9);\n\tROUND(dd, ee, aa, bb, cc, F2, K2, in[15],  7);\n\tROUND(cc, dd, ee, aa, bb, F2, K2, in[3],  15);\n\tROUND(bb, cc, dd, ee, aa, F2, K2, in[12],  7);\n\tROUND(aa, bb, cc, dd, ee, F2, K2, in[0],  12);\n\tROUND(ee, aa, bb, cc, dd, F2, K2, in[9],  15);\n\tROUND(dd, ee, aa, bb, cc, F2, K2, in[5],   9);\n\tROUND(cc, dd, ee, aa, bb, F2, K2, in[2],  11);\n\tROUND(bb, cc, dd, ee, aa, F2, K2, in[14],  7);\n\tROUND(aa, bb, cc, dd, ee, F2, K2, in[11], 13);\n\tROUND(ee, aa, bb, cc, dd, F2, K2, in[8],  12);\n\n\t \n\tROUND(dd, ee, aa, bb, cc, F3, K3, in[3],  11);\n\tROUND(cc, dd, ee, aa, bb, F3, K3, in[10], 13);\n\tROUND(bb, cc, dd, ee, aa, F3, K3, in[14],  6);\n\tROUND(aa, bb, cc, dd, ee, F3, K3, in[4],   7);\n\tROUND(ee, aa, bb, cc, dd, F3, K3, in[9],  14);\n\tROUND(dd, ee, aa, bb, cc, F3, K3, in[15],  9);\n\tROUND(cc, dd, ee, aa, bb, F3, K3, in[8],  13);\n\tROUND(bb, cc, dd, ee, aa, F3, K3, in[1],  15);\n\tROUND(aa, bb, cc, dd, ee, F3, K3, in[2],  14);\n\tROUND(ee, aa, bb, cc, dd, F3, K3, in[7],   8);\n\tROUND(dd, ee, aa, bb, cc, F3, K3, in[0],  13);\n\tROUND(cc, dd, ee, aa, bb, F3, K3, in[6],   6);\n\tROUND(bb, cc, dd, ee, aa, F3, K3, in[13],  5);\n\tROUND(aa, bb, cc, dd, ee, F3, K3, in[11], 12);\n\tROUND(ee, aa, bb, cc, dd, F3, K3, in[5],   7);\n\tROUND(dd, ee, aa, bb, cc, F3, K3, in[12],  5);\n\n\t \n\tROUND(cc, dd, ee, aa, bb, F4, K4, in[1],  11);\n\tROUND(bb, cc, dd, ee, aa, F4, K4, in[9],  12);\n\tROUND(aa, bb, cc, dd, ee, F4, K4, in[11], 14);\n\tROUND(ee, aa, bb, cc, dd, F4, K4, in[10], 15);\n\tROUND(dd, ee, aa, bb, cc, F4, K4, in[0],  14);\n\tROUND(cc, dd, ee, aa, bb, F4, K4, in[8],  15);\n\tROUND(bb, cc, dd, ee, aa, F4, K4, in[12],  9);\n\tROUND(aa, bb, cc, dd, ee, F4, K4, in[4],   8);\n\tROUND(ee, aa, bb, cc, dd, F4, K4, in[13],  9);\n\tROUND(dd, ee, aa, bb, cc, F4, K4, in[3],  14);\n\tROUND(cc, dd, ee, aa, bb, F4, K4, in[7],   5);\n\tROUND(bb, cc, dd, ee, aa, F4, K4, in[15],  6);\n\tROUND(aa, bb, cc, dd, ee, F4, K4, in[14],  8);\n\tROUND(ee, aa, bb, cc, dd, F4, K4, in[5],   6);\n\tROUND(dd, ee, aa, bb, cc, F4, K4, in[6],   5);\n\tROUND(cc, dd, ee, aa, bb, F4, K4, in[2],  12);\n\n\t \n\tROUND(bb, cc, dd, ee, aa, F5, K5, in[4],   9);\n\tROUND(aa, bb, cc, dd, ee, F5, K5, in[0],  15);\n\tROUND(ee, aa, bb, cc, dd, F5, K5, in[5],   5);\n\tROUND(dd, ee, aa, bb, cc, F5, K5, in[9],  11);\n\tROUND(cc, dd, ee, aa, bb, F5, K5, in[7],   6);\n\tROUND(bb, cc, dd, ee, aa, F5, K5, in[12],  8);\n\tROUND(aa, bb, cc, dd, ee, F5, K5, in[2],  13);\n\tROUND(ee, aa, bb, cc, dd, F5, K5, in[10], 12);\n\tROUND(dd, ee, aa, bb, cc, F5, K5, in[14],  5);\n\tROUND(cc, dd, ee, aa, bb, F5, K5, in[1],  12);\n\tROUND(bb, cc, dd, ee, aa, F5, K5, in[3],  13);\n\tROUND(aa, bb, cc, dd, ee, F5, K5, in[8],  14);\n\tROUND(ee, aa, bb, cc, dd, F5, K5, in[11], 11);\n\tROUND(dd, ee, aa, bb, cc, F5, K5, in[6],   8);\n\tROUND(cc, dd, ee, aa, bb, F5, K5, in[15],  5);\n\tROUND(bb, cc, dd, ee, aa, F5, K5, in[13],  6);\n\n\t \n\tROUND(aaa, bbb, ccc, ddd, eee, F5, KK1, in[5],   8);\n\tROUND(eee, aaa, bbb, ccc, ddd, F5, KK1, in[14],  9);\n\tROUND(ddd, eee, aaa, bbb, ccc, F5, KK1, in[7],   9);\n\tROUND(ccc, ddd, eee, aaa, bbb, F5, KK1, in[0],  11);\n\tROUND(bbb, ccc, ddd, eee, aaa, F5, KK1, in[9],  13);\n\tROUND(aaa, bbb, ccc, ddd, eee, F5, KK1, in[2],  15);\n\tROUND(eee, aaa, bbb, ccc, ddd, F5, KK1, in[11], 15);\n\tROUND(ddd, eee, aaa, bbb, ccc, F5, KK1, in[4],   5);\n\tROUND(ccc, ddd, eee, aaa, bbb, F5, KK1, in[13],  7);\n\tROUND(bbb, ccc, ddd, eee, aaa, F5, KK1, in[6],   7);\n\tROUND(aaa, bbb, ccc, ddd, eee, F5, KK1, in[15],  8);\n\tROUND(eee, aaa, bbb, ccc, ddd, F5, KK1, in[8],  11);\n\tROUND(ddd, eee, aaa, bbb, ccc, F5, KK1, in[1],  14);\n\tROUND(ccc, ddd, eee, aaa, bbb, F5, KK1, in[10], 14);\n\tROUND(bbb, ccc, ddd, eee, aaa, F5, KK1, in[3],  12);\n\tROUND(aaa, bbb, ccc, ddd, eee, F5, KK1, in[12],  6);\n\n\t \n\tROUND(eee, aaa, bbb, ccc, ddd, F4, KK2, in[6],   9);\n\tROUND(ddd, eee, aaa, bbb, ccc, F4, KK2, in[11], 13);\n\tROUND(ccc, ddd, eee, aaa, bbb, F4, KK2, in[3],  15);\n\tROUND(bbb, ccc, ddd, eee, aaa, F4, KK2, in[7],   7);\n\tROUND(aaa, bbb, ccc, ddd, eee, F4, KK2, in[0],  12);\n\tROUND(eee, aaa, bbb, ccc, ddd, F4, KK2, in[13],  8);\n\tROUND(ddd, eee, aaa, bbb, ccc, F4, KK2, in[5],   9);\n\tROUND(ccc, ddd, eee, aaa, bbb, F4, KK2, in[10], 11);\n\tROUND(bbb, ccc, ddd, eee, aaa, F4, KK2, in[14],  7);\n\tROUND(aaa, bbb, ccc, ddd, eee, F4, KK2, in[15],  7);\n\tROUND(eee, aaa, bbb, ccc, ddd, F4, KK2, in[8],  12);\n\tROUND(ddd, eee, aaa, bbb, ccc, F4, KK2, in[12],  7);\n\tROUND(ccc, ddd, eee, aaa, bbb, F4, KK2, in[4],   6);\n\tROUND(bbb, ccc, ddd, eee, aaa, F4, KK2, in[9],  15);\n\tROUND(aaa, bbb, ccc, ddd, eee, F4, KK2, in[1],  13);\n\tROUND(eee, aaa, bbb, ccc, ddd, F4, KK2, in[2],  11);\n\n\t \n\tROUND(ddd, eee, aaa, bbb, ccc, F3, KK3, in[15],  9);\n\tROUND(ccc, ddd, eee, aaa, bbb, F3, KK3, in[5],   7);\n\tROUND(bbb, ccc, ddd, eee, aaa, F3, KK3, in[1],  15);\n\tROUND(aaa, bbb, ccc, ddd, eee, F3, KK3, in[3],  11);\n\tROUND(eee, aaa, bbb, ccc, ddd, F3, KK3, in[7],   8);\n\tROUND(ddd, eee, aaa, bbb, ccc, F3, KK3, in[14],  6);\n\tROUND(ccc, ddd, eee, aaa, bbb, F3, KK3, in[6],   6);\n\tROUND(bbb, ccc, ddd, eee, aaa, F3, KK3, in[9],  14);\n\tROUND(aaa, bbb, ccc, ddd, eee, F3, KK3, in[11], 12);\n\tROUND(eee, aaa, bbb, ccc, ddd, F3, KK3, in[8],  13);\n\tROUND(ddd, eee, aaa, bbb, ccc, F3, KK3, in[12],  5);\n\tROUND(ccc, ddd, eee, aaa, bbb, F3, KK3, in[2],  14);\n\tROUND(bbb, ccc, ddd, eee, aaa, F3, KK3, in[10], 13);\n\tROUND(aaa, bbb, ccc, ddd, eee, F3, KK3, in[0],  13);\n\tROUND(eee, aaa, bbb, ccc, ddd, F3, KK3, in[4],   7);\n\tROUND(ddd, eee, aaa, bbb, ccc, F3, KK3, in[13],  5);\n\n\t \n\tROUND(ccc, ddd, eee, aaa, bbb, F2, KK4, in[8],  15);\n\tROUND(bbb, ccc, ddd, eee, aaa, F2, KK4, in[6],   5);\n\tROUND(aaa, bbb, ccc, ddd, eee, F2, KK4, in[4],   8);\n\tROUND(eee, aaa, bbb, ccc, ddd, F2, KK4, in[1],  11);\n\tROUND(ddd, eee, aaa, bbb, ccc, F2, KK4, in[3],  14);\n\tROUND(ccc, ddd, eee, aaa, bbb, F2, KK4, in[11], 14);\n\tROUND(bbb, ccc, ddd, eee, aaa, F2, KK4, in[15],  6);\n\tROUND(aaa, bbb, ccc, ddd, eee, F2, KK4, in[0],  14);\n\tROUND(eee, aaa, bbb, ccc, ddd, F2, KK4, in[5],   6);\n\tROUND(ddd, eee, aaa, bbb, ccc, F2, KK4, in[12],  9);\n\tROUND(ccc, ddd, eee, aaa, bbb, F2, KK4, in[2],  12);\n\tROUND(bbb, ccc, ddd, eee, aaa, F2, KK4, in[13],  9);\n\tROUND(aaa, bbb, ccc, ddd, eee, F2, KK4, in[9],  12);\n\tROUND(eee, aaa, bbb, ccc, ddd, F2, KK4, in[7],   5);\n\tROUND(ddd, eee, aaa, bbb, ccc, F2, KK4, in[10], 15);\n\tROUND(ccc, ddd, eee, aaa, bbb, F2, KK4, in[14],  8);\n\n\t \n\tROUND(bbb, ccc, ddd, eee, aaa, F1, KK5, in[12],  8);\n\tROUND(aaa, bbb, ccc, ddd, eee, F1, KK5, in[15],  5);\n\tROUND(eee, aaa, bbb, ccc, ddd, F1, KK5, in[10], 12);\n\tROUND(ddd, eee, aaa, bbb, ccc, F1, KK5, in[4],   9);\n\tROUND(ccc, ddd, eee, aaa, bbb, F1, KK5, in[1],  12);\n\tROUND(bbb, ccc, ddd, eee, aaa, F1, KK5, in[5],   5);\n\tROUND(aaa, bbb, ccc, ddd, eee, F1, KK5, in[8],  14);\n\tROUND(eee, aaa, bbb, ccc, ddd, F1, KK5, in[7],   6);\n\tROUND(ddd, eee, aaa, bbb, ccc, F1, KK5, in[6],   8);\n\tROUND(ccc, ddd, eee, aaa, bbb, F1, KK5, in[2],  13);\n\tROUND(bbb, ccc, ddd, eee, aaa, F1, KK5, in[13],  6);\n\tROUND(aaa, bbb, ccc, ddd, eee, F1, KK5, in[14],  5);\n\tROUND(eee, aaa, bbb, ccc, ddd, F1, KK5, in[0],  15);\n\tROUND(ddd, eee, aaa, bbb, ccc, F1, KK5, in[3],  13);\n\tROUND(ccc, ddd, eee, aaa, bbb, F1, KK5, in[9],  11);\n\tROUND(bbb, ccc, ddd, eee, aaa, F1, KK5, in[11], 11);\n\n\t \n\tddd += cc + state[1];\t\t \n\tstate[1] = state[2] + dd + eee;\n\tstate[2] = state[3] + ee + aaa;\n\tstate[3] = state[4] + aa + bbb;\n\tstate[4] = state[0] + bb + ccc;\n\tstate[0] = ddd;\n}\n\nstatic int rmd160_init(struct shash_desc *desc)\n{\n\tstruct rmd160_ctx *rctx = shash_desc_ctx(desc);\n\n\trctx->byte_count = 0;\n\n\trctx->state[0] = RMD_H0;\n\trctx->state[1] = RMD_H1;\n\trctx->state[2] = RMD_H2;\n\trctx->state[3] = RMD_H3;\n\trctx->state[4] = RMD_H4;\n\n\tmemset(rctx->buffer, 0, sizeof(rctx->buffer));\n\n\treturn 0;\n}\n\nstatic int rmd160_update(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int len)\n{\n\tstruct rmd160_ctx *rctx = shash_desc_ctx(desc);\n\tconst u32 avail = sizeof(rctx->buffer) - (rctx->byte_count & 0x3f);\n\n\trctx->byte_count += len;\n\n\t \n\tif (avail > len) {\n\t\tmemcpy((char *)rctx->buffer + (sizeof(rctx->buffer) - avail),\n\t\t       data, len);\n\t\tgoto out;\n\t}\n\n\tmemcpy((char *)rctx->buffer + (sizeof(rctx->buffer) - avail),\n\t       data, avail);\n\n\trmd160_transform(rctx->state, rctx->buffer);\n\tdata += avail;\n\tlen -= avail;\n\n\twhile (len >= sizeof(rctx->buffer)) {\n\t\tmemcpy(rctx->buffer, data, sizeof(rctx->buffer));\n\t\trmd160_transform(rctx->state, rctx->buffer);\n\t\tdata += sizeof(rctx->buffer);\n\t\tlen -= sizeof(rctx->buffer);\n\t}\n\n\tmemcpy(rctx->buffer, data, len);\n\nout:\n\treturn 0;\n}\n\n \nstatic int rmd160_final(struct shash_desc *desc, u8 *out)\n{\n\tstruct rmd160_ctx *rctx = shash_desc_ctx(desc);\n\tu32 i, index, padlen;\n\t__le64 bits;\n\t__le32 *dst = (__le32 *)out;\n\tstatic const u8 padding[64] = { 0x80, };\n\n\tbits = cpu_to_le64(rctx->byte_count << 3);\n\n\t \n\tindex = rctx->byte_count & 0x3f;\n\tpadlen = (index < 56) ? (56 - index) : ((64+56) - index);\n\trmd160_update(desc, padding, padlen);\n\n\t \n\trmd160_update(desc, (const u8 *)&bits, sizeof(bits));\n\n\t \n\tfor (i = 0; i < 5; i++)\n\t\tdst[i] = cpu_to_le32p(&rctx->state[i]);\n\n\t \n\tmemset(rctx, 0, sizeof(*rctx));\n\n\treturn 0;\n}\n\nstatic struct shash_alg alg = {\n\t.digestsize\t=\tRMD160_DIGEST_SIZE,\n\t.init\t\t=\trmd160_init,\n\t.update\t\t=\trmd160_update,\n\t.final\t\t=\trmd160_final,\n\t.descsize\t=\tsizeof(struct rmd160_ctx),\n\t.base\t\t=\t{\n\t\t.cra_name\t =\t\"rmd160\",\n\t\t.cra_driver_name =\t\"rmd160-generic\",\n\t\t.cra_blocksize\t =\tRMD160_BLOCK_SIZE,\n\t\t.cra_module\t =\tTHIS_MODULE,\n\t}\n};\n\nstatic int __init rmd160_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit rmd160_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(rmd160_mod_init);\nmodule_exit(rmd160_mod_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Adrian-Ken Rueegsegger <ken@codelabs.ch>\");\nMODULE_DESCRIPTION(\"RIPEMD-160 Message Digest\");\nMODULE_ALIAS_CRYPTO(\"rmd160\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}