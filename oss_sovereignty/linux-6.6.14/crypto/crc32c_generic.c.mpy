{
  "module_name": "crc32c_generic.c",
  "hash_id": "9487c8792e8532c8cd8134097a40b43c47a1e22a80ddd79a66e3aeba7f3a682b",
  "original_prompt": "Ingested from linux-6.6.14/crypto/crc32c_generic.c",
  "human_readable_source": "\n \n\n#include <asm/unaligned.h>\n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/crc32.h>\n\n#define CHKSUM_BLOCK_SIZE\t1\n#define CHKSUM_DIGEST_SIZE\t4\n\nstruct chksum_ctx {\n\tu32 key;\n};\n\nstruct chksum_desc_ctx {\n\tu32 crc;\n};\n\n \n\nstatic int chksum_init(struct shash_desc *desc)\n{\n\tstruct chksum_ctx *mctx = crypto_shash_ctx(desc->tfm);\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\tctx->crc = mctx->key;\n\n\treturn 0;\n}\n\n \nstatic int chksum_setkey(struct crypto_shash *tfm, const u8 *key,\n\t\t\t unsigned int keylen)\n{\n\tstruct chksum_ctx *mctx = crypto_shash_ctx(tfm);\n\n\tif (keylen != sizeof(mctx->key))\n\t\treturn -EINVAL;\n\tmctx->key = get_unaligned_le32(key);\n\treturn 0;\n}\n\nstatic int chksum_update(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\tctx->crc = __crc32c_le(ctx->crc, data, length);\n\treturn 0;\n}\n\nstatic int chksum_final(struct shash_desc *desc, u8 *out)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\tput_unaligned_le32(~ctx->crc, out);\n\treturn 0;\n}\n\nstatic int __chksum_finup(u32 *crcp, const u8 *data, unsigned int len, u8 *out)\n{\n\tput_unaligned_le32(~__crc32c_le(*crcp, data, len), out);\n\treturn 0;\n}\n\nstatic int chksum_finup(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *out)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\treturn __chksum_finup(&ctx->crc, data, len, out);\n}\n\nstatic int chksum_digest(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length, u8 *out)\n{\n\tstruct chksum_ctx *mctx = crypto_shash_ctx(desc->tfm);\n\n\treturn __chksum_finup(&mctx->key, data, length, out);\n}\n\nstatic int crc32c_cra_init(struct crypto_tfm *tfm)\n{\n\tstruct chksum_ctx *mctx = crypto_tfm_ctx(tfm);\n\n\tmctx->key = ~0;\n\treturn 0;\n}\n\nstatic struct shash_alg alg = {\n\t.digestsize\t\t=\tCHKSUM_DIGEST_SIZE,\n\t.setkey\t\t\t=\tchksum_setkey,\n\t.init\t\t=\tchksum_init,\n\t.update\t\t=\tchksum_update,\n\t.final\t\t=\tchksum_final,\n\t.finup\t\t=\tchksum_finup,\n\t.digest\t\t=\tchksum_digest,\n\t.descsize\t\t=\tsizeof(struct chksum_desc_ctx),\n\t.base\t\t\t=\t{\n\t\t.cra_name\t\t=\t\"crc32c\",\n\t\t.cra_driver_name\t=\t\"crc32c-generic\",\n\t\t.cra_priority\t\t=\t100,\n\t\t.cra_flags\t\t=\tCRYPTO_ALG_OPTIONAL_KEY,\n\t\t.cra_blocksize\t\t=\tCHKSUM_BLOCK_SIZE,\n\t\t.cra_ctxsize\t\t=\tsizeof(struct chksum_ctx),\n\t\t.cra_module\t\t=\tTHIS_MODULE,\n\t\t.cra_init\t\t=\tcrc32c_cra_init,\n\t}\n};\n\nstatic int __init crc32c_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit crc32c_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(crc32c_mod_init);\nmodule_exit(crc32c_mod_fini);\n\nMODULE_AUTHOR(\"Clay Haapala <chaapala@cisco.com>\");\nMODULE_DESCRIPTION(\"CRC32c (Castagnoli) calculations wrapper for lib/crc32c\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_CRYPTO(\"crc32c\");\nMODULE_ALIAS_CRYPTO(\"crc32c-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}