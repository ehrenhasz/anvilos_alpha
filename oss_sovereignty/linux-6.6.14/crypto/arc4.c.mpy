{
  "module_name": "arc4.c",
  "hash_id": "893f3118b3e635cca7f2ef1933079f225d5039718388eb51c41b7b9988d4f673",
  "original_prompt": "Ingested from linux-6.6.14/crypto/arc4.c",
  "human_readable_source": "\n \n\n#include <crypto/algapi.h>\n#include <crypto/arc4.h>\n#include <crypto/internal/skcipher.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n\nstatic int crypto_arc4_setkey(struct crypto_skcipher *tfm, const u8 *in_key,\n\t\t\t      unsigned int key_len)\n{\n\tstruct arc4_ctx *ctx = crypto_skcipher_ctx(tfm);\n\n\treturn arc4_setkey(ctx, in_key, key_len);\n}\n\nstatic int crypto_arc4_crypt(struct skcipher_request *req)\n{\n\tstruct crypto_skcipher *tfm = crypto_skcipher_reqtfm(req);\n\tstruct arc4_ctx *ctx = crypto_skcipher_ctx(tfm);\n\tstruct skcipher_walk walk;\n\tint err;\n\n\terr = skcipher_walk_virt(&walk, req, false);\n\n\twhile (walk.nbytes > 0) {\n\t\tarc4_crypt(ctx, walk.dst.virt.addr, walk.src.virt.addr,\n\t\t\t   walk.nbytes);\n\t\terr = skcipher_walk_done(&walk, 0);\n\t}\n\n\treturn err;\n}\n\nstatic int crypto_arc4_init(struct crypto_skcipher *tfm)\n{\n\tpr_warn_ratelimited(\"\\\"%s\\\" (%ld) uses obsolete ecb(arc4) skcipher\\n\",\n\t\t\t    current->comm, (unsigned long)current->pid);\n\n\treturn 0;\n}\n\nstatic struct skcipher_alg arc4_alg = {\n\t \n\t.base.cra_name\t\t=\t\"ecb(arc4)\",\n\t.base.cra_driver_name\t=\t\"ecb(arc4)-generic\",\n\t.base.cra_priority\t=\t100,\n\t.base.cra_blocksize\t=\tARC4_BLOCK_SIZE,\n\t.base.cra_ctxsize\t=\tsizeof(struct arc4_ctx),\n\t.base.cra_module\t=\tTHIS_MODULE,\n\t.min_keysize\t\t=\tARC4_MIN_KEY_SIZE,\n\t.max_keysize\t\t=\tARC4_MAX_KEY_SIZE,\n\t.setkey\t\t\t=\tcrypto_arc4_setkey,\n\t.encrypt\t\t=\tcrypto_arc4_crypt,\n\t.decrypt\t\t=\tcrypto_arc4_crypt,\n\t.init\t\t\t=\tcrypto_arc4_init,\n};\n\nstatic int __init arc4_init(void)\n{\n\treturn crypto_register_skcipher(&arc4_alg);\n}\n\nstatic void __exit arc4_exit(void)\n{\n\tcrypto_unregister_skcipher(&arc4_alg);\n}\n\nsubsys_initcall(arc4_init);\nmodule_exit(arc4_exit);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"ARC4 Cipher Algorithm\");\nMODULE_AUTHOR(\"Jon Oberheide <jon@oberheide.org>\");\nMODULE_ALIAS_CRYPTO(\"ecb(arc4)\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}