{
  "module_name": "x509_loader.c",
  "hash_id": "407a0651d7196164da07cf3a150e9eb86092995347afe0f067c6d7767d8a3d3b",
  "original_prompt": "Ingested from linux-6.6.14/crypto/asymmetric_keys/x509_loader.c",
  "human_readable_source": "\n\n#include <linux/kernel.h>\n#include <linux/key.h>\n#include <keys/asymmetric-type.h>\n\nint x509_load_certificate_list(const u8 cert_list[],\n\t\t\t       const unsigned long list_size,\n\t\t\t       const struct key *keyring)\n{\n\tkey_ref_t key;\n\tconst u8 *p, *end;\n\tsize_t plen;\n\n\tp = cert_list;\n\tend = p + list_size;\n\twhile (p < end) {\n\t\t \n\t\tif (end - p < 4)\n\t\t\tgoto dodgy_cert;\n\t\tif (p[0] != 0x30 &&\n\t\t    p[1] != 0x82)\n\t\t\tgoto dodgy_cert;\n\t\tplen = (p[2] << 8) | p[3];\n\t\tplen += 4;\n\t\tif (plen > end - p)\n\t\t\tgoto dodgy_cert;\n\n\t\tkey = key_create_or_update(make_key_ref(keyring, 1),\n\t\t\t\t\t   \"asymmetric\",\n\t\t\t\t\t   NULL,\n\t\t\t\t\t   p,\n\t\t\t\t\t   plen,\n\t\t\t\t\t   ((KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\t\t   KEY_USR_VIEW | KEY_USR_READ),\n\t\t\t\t\t   KEY_ALLOC_NOT_IN_QUOTA |\n\t\t\t\t\t   KEY_ALLOC_BUILT_IN |\n\t\t\t\t\t   KEY_ALLOC_BYPASS_RESTRICTION);\n\t\tif (IS_ERR(key)) {\n\t\t\tpr_err(\"Problem loading in-kernel X.509 certificate (%ld)\\n\",\n\t\t\t       PTR_ERR(key));\n\t\t} else {\n\t\t\tpr_notice(\"Loaded X.509 cert '%s'\\n\",\n\t\t\t\t  key_ref_to_ptr(key)->description);\n\t\t\tkey_ref_put(key);\n\t\t}\n\t\tp += plen;\n\t}\n\n\treturn 0;\n\ndodgy_cert:\n\tpr_err(\"Problem parsing in-kernel X.509 certificate list\\n\");\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(x509_load_certificate_list);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}