{
  "module_name": "sm4_generic.c",
  "hash_id": "260e66d73c2174295cc14253eafa0c4bc2e53183a3ecdbe218f5637e72617bab",
  "original_prompt": "Ingested from linux-6.6.14/crypto/sm4_generic.c",
  "human_readable_source": "\n\n \n\n#include <crypto/algapi.h>\n#include <crypto/sm4.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/errno.h>\n#include <asm/byteorder.h>\n#include <asm/unaligned.h>\n\n \nstatic int sm4_setkey(struct crypto_tfm *tfm, const u8 *in_key,\n\t\t       unsigned int key_len)\n{\n\tstruct sm4_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\treturn sm4_expandkey(ctx, in_key, key_len);\n}\n\n \n\nstatic void sm4_encrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct sm4_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\tsm4_crypt_block(ctx->rkey_enc, out, in);\n}\n\n \n\nstatic void sm4_decrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct sm4_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\tsm4_crypt_block(ctx->rkey_dec, out, in);\n}\n\nstatic struct crypto_alg sm4_alg = {\n\t.cra_name\t\t=\t\"sm4\",\n\t.cra_driver_name\t=\t\"sm4-generic\",\n\t.cra_priority\t\t=\t100,\n\t.cra_flags\t\t=\tCRYPTO_ALG_TYPE_CIPHER,\n\t.cra_blocksize\t\t=\tSM4_BLOCK_SIZE,\n\t.cra_ctxsize\t\t=\tsizeof(struct sm4_ctx),\n\t.cra_module\t\t=\tTHIS_MODULE,\n\t.cra_u\t\t\t=\t{\n\t\t.cipher = {\n\t\t\t.cia_min_keysize\t=\tSM4_KEY_SIZE,\n\t\t\t.cia_max_keysize\t=\tSM4_KEY_SIZE,\n\t\t\t.cia_setkey\t\t=\tsm4_setkey,\n\t\t\t.cia_encrypt\t\t=\tsm4_encrypt,\n\t\t\t.cia_decrypt\t\t=\tsm4_decrypt\n\t\t}\n\t}\n};\n\nstatic int __init sm4_init(void)\n{\n\treturn crypto_register_alg(&sm4_alg);\n}\n\nstatic void __exit sm4_fini(void)\n{\n\tcrypto_unregister_alg(&sm4_alg);\n}\n\nsubsys_initcall(sm4_init);\nmodule_exit(sm4_fini);\n\nMODULE_DESCRIPTION(\"SM4 Cipher Algorithm\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_ALIAS_CRYPTO(\"sm4\");\nMODULE_ALIAS_CRYPTO(\"sm4-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}