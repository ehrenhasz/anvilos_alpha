{
  "module_name": "serpent_generic.c",
  "hash_id": "7d80481967fc0368eb488f5d06da51b15f5dd0a43b34b46581f6edef4b52dae1",
  "original_prompt": "Ingested from linux-6.6.14/crypto/serpent_generic.c",
  "human_readable_source": "\n \n\n#include <crypto/algapi.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <asm/unaligned.h>\n#include <linux/types.h>\n#include <crypto/serpent.h>\n\n \n\n#define PHI 0x9e3779b9UL\n\n#define keyiter(a, b, c, d, i, j) \\\n\t({ b ^= d; b ^= c; b ^= a; b ^= PHI ^ i; b = rol32(b, 11); k[j] = b; })\n\n#define loadkeys(x0, x1, x2, x3, i) \\\n\t({ x0 = k[i]; x1 = k[i+1]; x2 = k[i+2]; x3 = k[i+3]; })\n\n#define storekeys(x0, x1, x2, x3, i) \\\n\t({ k[i] = x0; k[i+1] = x1; k[i+2] = x2; k[i+3] = x3; })\n\n#define store_and_load_keys(x0, x1, x2, x3, s, l) \\\n\t({ storekeys(x0, x1, x2, x3, s); loadkeys(x0, x1, x2, x3, l); })\n\n#define K(x0, x1, x2, x3, i) ({\t\t\t\t\\\n\tx3 ^= k[4*(i)+3];        x2 ^= k[4*(i)+2];\t\\\n\tx1 ^= k[4*(i)+1];        x0 ^= k[4*(i)+0];\t\\\n\t})\n\n#define LK(x0, x1, x2, x3, x4, i) ({\t\t\t\t\t   \\\n\t\t\t\t\t\t\tx0 = rol32(x0, 13);\\\n\tx2 = rol32(x2, 3);\tx1 ^= x0;\t\tx4  = x0 << 3;\t   \\\n\tx3 ^= x2;\t\tx1 ^= x2;\t\t\t\t   \\\n\tx1 = rol32(x1, 1);\tx3 ^= x4;\t\t\t\t   \\\n\tx3 = rol32(x3, 7);\tx4  = x1;\t\t\t\t   \\\n\tx0 ^= x1;\t\tx4 <<= 7;\t\tx2 ^= x3;\t   \\\n\tx0 ^= x3;\t\tx2 ^= x4;\t\tx3 ^= k[4*i+3];\t   \\\n\tx1 ^= k[4*i+1];\t\tx0 = rol32(x0, 5);\tx2 = rol32(x2, 22);\\\n\tx0 ^= k[4*i+0];\t\tx2 ^= k[4*i+2];\t\t\t\t   \\\n\t})\n\n#define KL(x0, x1, x2, x3, x4, i) ({\t\t\t\t\t   \\\n\tx0 ^= k[4*i+0];\t\tx1 ^= k[4*i+1];\t\tx2 ^= k[4*i+2];\t   \\\n\tx3 ^= k[4*i+3];\t\tx0 = ror32(x0, 5);\tx2 = ror32(x2, 22);\\\n\tx4 =  x1;\t\tx2 ^= x3;\t\tx0 ^= x3;\t   \\\n\tx4 <<= 7;\t\tx0 ^= x1;\t\tx1 = ror32(x1, 1); \\\n\tx2 ^= x4;\t\tx3 = ror32(x3, 7);\tx4 = x0 << 3;\t   \\\n\tx1 ^= x0;\t\tx3 ^= x4;\t\tx0 = ror32(x0, 13);\\\n\tx1 ^= x2;\t\tx3 ^= x2;\t\tx2 = ror32(x2, 3); \\\n\t})\n\n#define S0(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx4  = x3;\t\\\n\tx3 |= x0;\tx0 ^= x4;\tx4 ^= x2;\t\\\n\tx4 = ~x4;\tx3 ^= x1;\tx1 &= x0;\t\\\n\tx1 ^= x4;\tx2 ^= x0;\tx0 ^= x3;\t\\\n\tx4 |= x0;\tx0 ^= x2;\tx2 &= x1;\t\\\n\tx3 ^= x2;\tx1 = ~x1;\tx2 ^= x4;\t\\\n\tx1 ^= x2;\t\t\t\t\t\\\n\t})\n\n#define S1(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx4  = x1;\t\\\n\tx1 ^= x0;\tx0 ^= x3;\tx3 = ~x3;\t\\\n\tx4 &= x1;\tx0 |= x1;\tx3 ^= x2;\t\\\n\tx0 ^= x3;\tx1 ^= x3;\tx3 ^= x4;\t\\\n\tx1 |= x4;\tx4 ^= x2;\tx2 &= x0;\t\\\n\tx2 ^= x1;\tx1 |= x0;\tx0 = ~x0;\t\\\n\tx0 ^= x2;\tx4 ^= x1;\t\t\t\\\n\t})\n\n#define S2(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx3 = ~x3;\t\\\n\tx1 ^= x0;\tx4  = x0;\tx0 &= x2;\t\\\n\tx0 ^= x3;\tx3 |= x4;\tx2 ^= x1;\t\\\n\tx3 ^= x1;\tx1 &= x0;\tx0 ^= x2;\t\\\n\tx2 &= x3;\tx3 |= x1;\tx0 = ~x0;\t\\\n\tx3 ^= x0;\tx4 ^= x0;\tx0 ^= x2;\t\\\n\tx1 |= x2;\t\t\t\t\t\\\n\t})\n\n#define S3(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx4  = x1;\t\\\n\tx1 ^= x3;\tx3 |= x0;\tx4 &= x0;\t\\\n\tx0 ^= x2;\tx2 ^= x1;\tx1 &= x3;\t\\\n\tx2 ^= x3;\tx0 |= x4;\tx4 ^= x3;\t\\\n\tx1 ^= x0;\tx0 &= x3;\tx3 &= x4;\t\\\n\tx3 ^= x2;\tx4 |= x1;\tx2 &= x1;\t\\\n\tx4 ^= x3;\tx0 ^= x3;\tx3 ^= x2;\t\\\n\t})\n\n#define S4(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx4  = x3;\t\\\n\tx3 &= x0;\tx0 ^= x4;\t\t\t\\\n\tx3 ^= x2;\tx2 |= x4;\tx0 ^= x1;\t\\\n\tx4 ^= x3;\tx2 |= x0;\t\t\t\\\n\tx2 ^= x1;\tx1 &= x0;\t\t\t\\\n\tx1 ^= x4;\tx4 &= x2;\tx2 ^= x3;\t\\\n\tx4 ^= x0;\tx3 |= x1;\tx1 = ~x1;\t\\\n\tx3 ^= x0;\t\t\t\t\t\\\n\t})\n\n#define S5(x0, x1, x2, x3, x4) ({\t\t\t\\\n\tx4  = x1;\tx1 |= x0;\t\t\t\\\n\tx2 ^= x1;\tx3 = ~x3;\tx4 ^= x0;\t\\\n\tx0 ^= x2;\tx1 &= x4;\tx4 |= x3;\t\\\n\tx4 ^= x0;\tx0 &= x3;\tx1 ^= x3;\t\\\n\tx3 ^= x2;\tx0 ^= x1;\tx2 &= x4;\t\\\n\tx1 ^= x2;\tx2 &= x0;\t\t\t\\\n\tx3 ^= x2;\t\t\t\t\t\\\n\t})\n\n#define S6(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx4  = x1;\t\\\n\tx3 ^= x0;\tx1 ^= x2;\tx2 ^= x0;\t\\\n\tx0 &= x3;\tx1 |= x3;\tx4 = ~x4;\t\\\n\tx0 ^= x1;\tx1 ^= x2;\t\t\t\\\n\tx3 ^= x4;\tx4 ^= x0;\tx2 &= x0;\t\\\n\tx4 ^= x1;\tx2 ^= x3;\tx3 &= x1;\t\\\n\tx3 ^= x0;\tx1 ^= x2;\t\t\t\\\n\t})\n\n#define S7(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx1 = ~x1;\t\\\n\tx4  = x1;\tx0 = ~x0;\tx1 &= x2;\t\\\n\tx1 ^= x3;\tx3 |= x4;\tx4 ^= x2;\t\\\n\tx2 ^= x3;\tx3 ^= x0;\tx0 |= x1;\t\\\n\tx2 &= x0;\tx0 ^= x4;\tx4 ^= x3;\t\\\n\tx3 &= x0;\tx4 ^= x1;\t\t\t\\\n\tx2 ^= x4;\tx3 ^= x1;\tx4 |= x0;\t\\\n\tx4 ^= x1;\t\t\t\t\t\\\n\t})\n\n#define SI0(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\tx4  = x3;\tx1 ^= x0;\t\\\n\tx3 |= x1;\tx4 ^= x1;\tx0 = ~x0;\t\\\n\tx2 ^= x3;\tx3 ^= x0;\tx0 &= x1;\t\\\n\tx0 ^= x2;\tx2 &= x3;\tx3 ^= x4;\t\\\n\tx2 ^= x3;\tx1 ^= x3;\tx3 &= x0;\t\\\n\tx1 ^= x0;\tx0 ^= x2;\tx4 ^= x3;\t\\\n\t})\n\n#define SI1(x0, x1, x2, x3, x4) ({\t\t\t\\\n\tx1 ^= x3;\tx4  = x0;\t\t\t\\\n\tx0 ^= x2;\tx2 = ~x2;\tx4 |= x1;\t\\\n\tx4 ^= x3;\tx3 &= x1;\tx1 ^= x2;\t\\\n\tx2 &= x4;\tx4 ^= x1;\tx1 |= x3;\t\\\n\tx3 ^= x0;\tx2 ^= x0;\tx0 |= x4;\t\\\n\tx2 ^= x4;\tx1 ^= x0;\t\t\t\\\n\tx4 ^= x1;\t\t\t\t\t\\\n\t})\n\n#define SI2(x0, x1, x2, x3, x4) ({\t\t\t\\\n\tx2 ^= x1;\tx4  = x3;\tx3 = ~x3;\t\\\n\tx3 |= x2;\tx2 ^= x4;\tx4 ^= x0;\t\\\n\tx3 ^= x1;\tx1 |= x2;\tx2 ^= x0;\t\\\n\tx1 ^= x4;\tx4 |= x3;\tx2 ^= x3;\t\\\n\tx4 ^= x2;\tx2 &= x1;\t\t\t\\\n\tx2 ^= x3;\tx3 ^= x4;\tx4 ^= x0;\t\\\n\t})\n\n#define SI3(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\t\t\tx2 ^= x1;\t\\\n\tx4  = x1;\tx1 &= x2;\t\t\t\\\n\tx1 ^= x0;\tx0 |= x4;\tx4 ^= x3;\t\\\n\tx0 ^= x3;\tx3 |= x1;\tx1 ^= x2;\t\\\n\tx1 ^= x3;\tx0 ^= x2;\tx2 ^= x3;\t\\\n\tx3 &= x1;\tx1 ^= x0;\tx0 &= x2;\t\\\n\tx4 ^= x3;\tx3 ^= x0;\tx0 ^= x1;\t\\\n\t})\n\n#define SI4(x0, x1, x2, x3, x4) ({\t\t\t\\\n\tx2 ^= x3;\tx4  = x0;\tx0 &= x1;\t\\\n\tx0 ^= x2;\tx2 |= x3;\tx4 = ~x4;\t\\\n\tx1 ^= x0;\tx0 ^= x2;\tx2 &= x4;\t\\\n\tx2 ^= x0;\tx0 |= x4;\t\t\t\\\n\tx0 ^= x3;\tx3 &= x2;\t\t\t\\\n\tx4 ^= x3;\tx3 ^= x1;\tx1 &= x0;\t\\\n\tx4 ^= x1;\tx0 ^= x3;\t\t\t\\\n\t})\n\n#define SI5(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\tx4  = x1;\tx1 |= x2;\t\\\n\tx2 ^= x4;\tx1 ^= x3;\tx3 &= x4;\t\\\n\tx2 ^= x3;\tx3 |= x0;\tx0 = ~x0;\t\\\n\tx3 ^= x2;\tx2 |= x0;\tx4 ^= x1;\t\\\n\tx2 ^= x4;\tx4 &= x0;\tx0 ^= x1;\t\\\n\tx1 ^= x3;\tx0 &= x2;\tx2 ^= x3;\t\\\n\tx0 ^= x2;\tx2 ^= x4;\tx4 ^= x3;\t\\\n\t})\n\n#define SI6(x0, x1, x2, x3, x4) ({\t\t\t\\\n\t\t\tx0 ^= x2;\t\t\t\\\n\tx4  = x0;\tx0 &= x3;\tx2 ^= x3;\t\\\n\tx0 ^= x2;\tx3 ^= x1;\tx2 |= x4;\t\\\n\tx2 ^= x3;\tx3 &= x0;\tx0 = ~x0;\t\\\n\tx3 ^= x1;\tx1 &= x2;\tx4 ^= x0;\t\\\n\tx3 ^= x4;\tx4 ^= x2;\tx0 ^= x1;\t\\\n\tx2 ^= x0;\t\t\t\t\t\\\n\t})\n\n#define SI7(x0, x1, x2, x3, x4) ({\t\t\t\\\n\tx4  = x3;\tx3 &= x0;\tx0 ^= x2;\t\\\n\tx2 |= x4;\tx4 ^= x1;\tx0 = ~x0;\t\\\n\tx1 |= x3;\tx4 ^= x0;\tx0 &= x2;\t\\\n\tx0 ^= x1;\tx1 &= x2;\tx3 ^= x2;\t\\\n\tx4 ^= x3;\tx2 &= x3;\tx3 |= x0;\t\\\n\tx1 ^= x4;\tx3 ^= x4;\tx4 &= x0;\t\\\n\tx4 ^= x2;\t\t\t\t\t\\\n\t})\n\n \nstatic noinline void __serpent_setkey_sbox(u32 r0, u32 r1, u32 r2,\n\t\t\t\t\t   u32 r3, u32 r4, u32 *k)\n{\n\tk += 100;\n\tS3(r3, r4, r0, r1, r2); store_and_load_keys(r1, r2, r4, r3, 28, 24);\n\tS4(r1, r2, r4, r3, r0); store_and_load_keys(r2, r4, r3, r0, 24, 20);\n\tS5(r2, r4, r3, r0, r1); store_and_load_keys(r1, r2, r4, r0, 20, 16);\n\tS6(r1, r2, r4, r0, r3); store_and_load_keys(r4, r3, r2, r0, 16, 12);\n\tS7(r4, r3, r2, r0, r1); store_and_load_keys(r1, r2, r0, r4, 12, 8);\n\tS0(r1, r2, r0, r4, r3); store_and_load_keys(r0, r2, r4, r1, 8, 4);\n\tS1(r0, r2, r4, r1, r3); store_and_load_keys(r3, r4, r1, r0, 4, 0);\n\tS2(r3, r4, r1, r0, r2); store_and_load_keys(r2, r4, r3, r0, 0, -4);\n\tS3(r2, r4, r3, r0, r1); store_and_load_keys(r0, r1, r4, r2, -4, -8);\n\tS4(r0, r1, r4, r2, r3); store_and_load_keys(r1, r4, r2, r3, -8, -12);\n\tS5(r1, r4, r2, r3, r0); store_and_load_keys(r0, r1, r4, r3, -12, -16);\n\tS6(r0, r1, r4, r3, r2); store_and_load_keys(r4, r2, r1, r3, -16, -20);\n\tS7(r4, r2, r1, r3, r0); store_and_load_keys(r0, r1, r3, r4, -20, -24);\n\tS0(r0, r1, r3, r4, r2); store_and_load_keys(r3, r1, r4, r0, -24, -28);\n\tk -= 50;\n\tS1(r3, r1, r4, r0, r2); store_and_load_keys(r2, r4, r0, r3, 22, 18);\n\tS2(r2, r4, r0, r3, r1); store_and_load_keys(r1, r4, r2, r3, 18, 14);\n\tS3(r1, r4, r2, r3, r0); store_and_load_keys(r3, r0, r4, r1, 14, 10);\n\tS4(r3, r0, r4, r1, r2); store_and_load_keys(r0, r4, r1, r2, 10, 6);\n\tS5(r0, r4, r1, r2, r3); store_and_load_keys(r3, r0, r4, r2, 6, 2);\n\tS6(r3, r0, r4, r2, r1); store_and_load_keys(r4, r1, r0, r2, 2, -2);\n\tS7(r4, r1, r0, r2, r3); store_and_load_keys(r3, r0, r2, r4, -2, -6);\n\tS0(r3, r0, r2, r4, r1); store_and_load_keys(r2, r0, r4, r3, -6, -10);\n\tS1(r2, r0, r4, r3, r1); store_and_load_keys(r1, r4, r3, r2, -10, -14);\n\tS2(r1, r4, r3, r2, r0); store_and_load_keys(r0, r4, r1, r2, -14, -18);\n\tS3(r0, r4, r1, r2, r3); store_and_load_keys(r2, r3, r4, r0, -18, -22);\n\tk -= 50;\n\tS4(r2, r3, r4, r0, r1); store_and_load_keys(r3, r4, r0, r1, 28, 24);\n\tS5(r3, r4, r0, r1, r2); store_and_load_keys(r2, r3, r4, r1, 24, 20);\n\tS6(r2, r3, r4, r1, r0); store_and_load_keys(r4, r0, r3, r1, 20, 16);\n\tS7(r4, r0, r3, r1, r2); store_and_load_keys(r2, r3, r1, r4, 16, 12);\n\tS0(r2, r3, r1, r4, r0); store_and_load_keys(r1, r3, r4, r2, 12, 8);\n\tS1(r1, r3, r4, r2, r0); store_and_load_keys(r0, r4, r2, r1, 8, 4);\n\tS2(r0, r4, r2, r1, r3); store_and_load_keys(r3, r4, r0, r1, 4, 0);\n\tS3(r3, r4, r0, r1, r2); storekeys(r1, r2, r4, r3, 0);\n}\n\nint __serpent_setkey(struct serpent_ctx *ctx, const u8 *key,\n\t\t     unsigned int keylen)\n{\n\tu32 *k = ctx->expkey;\n\tu8  *k8 = (u8 *)k;\n\tu32 r0, r1, r2, r3, r4;\n\t__le32 *lk;\n\tint i;\n\n\t \n\n\tfor (i = 0; i < keylen; ++i)\n\t\tk8[i] = key[i];\n\tif (i < SERPENT_MAX_KEY_SIZE)\n\t\tk8[i++] = 1;\n\twhile (i < SERPENT_MAX_KEY_SIZE)\n\t\tk8[i++] = 0;\n\n\tlk = (__le32 *)k;\n\tk[0] = le32_to_cpu(lk[0]);\n\tk[1] = le32_to_cpu(lk[1]);\n\tk[2] = le32_to_cpu(lk[2]);\n\tk[3] = le32_to_cpu(lk[3]);\n\tk[4] = le32_to_cpu(lk[4]);\n\tk[5] = le32_to_cpu(lk[5]);\n\tk[6] = le32_to_cpu(lk[6]);\n\tk[7] = le32_to_cpu(lk[7]);\n\n\t \n\n\tr0 = k[3];\n\tr1 = k[4];\n\tr2 = k[5];\n\tr3 = k[6];\n\tr4 = k[7];\n\n\tkeyiter(k[0], r0, r4, r2, 0, 0);\n\tkeyiter(k[1], r1, r0, r3, 1, 1);\n\tkeyiter(k[2], r2, r1, r4, 2, 2);\n\tkeyiter(k[3], r3, r2, r0, 3, 3);\n\tkeyiter(k[4], r4, r3, r1, 4, 4);\n\tkeyiter(k[5], r0, r4, r2, 5, 5);\n\tkeyiter(k[6], r1, r0, r3, 6, 6);\n\tkeyiter(k[7], r2, r1, r4, 7, 7);\n\n\tkeyiter(k[0], r3, r2, r0, 8, 8);\n\tkeyiter(k[1], r4, r3, r1, 9, 9);\n\tkeyiter(k[2], r0, r4, r2, 10, 10);\n\tkeyiter(k[3], r1, r0, r3, 11, 11);\n\tkeyiter(k[4], r2, r1, r4, 12, 12);\n\tkeyiter(k[5], r3, r2, r0, 13, 13);\n\tkeyiter(k[6], r4, r3, r1, 14, 14);\n\tkeyiter(k[7], r0, r4, r2, 15, 15);\n\tkeyiter(k[8], r1, r0, r3, 16, 16);\n\tkeyiter(k[9], r2, r1, r4, 17, 17);\n\tkeyiter(k[10], r3, r2, r0, 18, 18);\n\tkeyiter(k[11], r4, r3, r1, 19, 19);\n\tkeyiter(k[12], r0, r4, r2, 20, 20);\n\tkeyiter(k[13], r1, r0, r3, 21, 21);\n\tkeyiter(k[14], r2, r1, r4, 22, 22);\n\tkeyiter(k[15], r3, r2, r0, 23, 23);\n\tkeyiter(k[16], r4, r3, r1, 24, 24);\n\tkeyiter(k[17], r0, r4, r2, 25, 25);\n\tkeyiter(k[18], r1, r0, r3, 26, 26);\n\tkeyiter(k[19], r2, r1, r4, 27, 27);\n\tkeyiter(k[20], r3, r2, r0, 28, 28);\n\tkeyiter(k[21], r4, r3, r1, 29, 29);\n\tkeyiter(k[22], r0, r4, r2, 30, 30);\n\tkeyiter(k[23], r1, r0, r3, 31, 31);\n\n\tk += 50;\n\n\tkeyiter(k[-26], r2, r1, r4, 32, -18);\n\tkeyiter(k[-25], r3, r2, r0, 33, -17);\n\tkeyiter(k[-24], r4, r3, r1, 34, -16);\n\tkeyiter(k[-23], r0, r4, r2, 35, -15);\n\tkeyiter(k[-22], r1, r0, r3, 36, -14);\n\tkeyiter(k[-21], r2, r1, r4, 37, -13);\n\tkeyiter(k[-20], r3, r2, r0, 38, -12);\n\tkeyiter(k[-19], r4, r3, r1, 39, -11);\n\tkeyiter(k[-18], r0, r4, r2, 40, -10);\n\tkeyiter(k[-17], r1, r0, r3, 41, -9);\n\tkeyiter(k[-16], r2, r1, r4, 42, -8);\n\tkeyiter(k[-15], r3, r2, r0, 43, -7);\n\tkeyiter(k[-14], r4, r3, r1, 44, -6);\n\tkeyiter(k[-13], r0, r4, r2, 45, -5);\n\tkeyiter(k[-12], r1, r0, r3, 46, -4);\n\tkeyiter(k[-11], r2, r1, r4, 47, -3);\n\tkeyiter(k[-10], r3, r2, r0, 48, -2);\n\tkeyiter(k[-9], r4, r3, r1, 49, -1);\n\tkeyiter(k[-8], r0, r4, r2, 50, 0);\n\tkeyiter(k[-7], r1, r0, r3, 51, 1);\n\tkeyiter(k[-6], r2, r1, r4, 52, 2);\n\tkeyiter(k[-5], r3, r2, r0, 53, 3);\n\tkeyiter(k[-4], r4, r3, r1, 54, 4);\n\tkeyiter(k[-3], r0, r4, r2, 55, 5);\n\tkeyiter(k[-2], r1, r0, r3, 56, 6);\n\tkeyiter(k[-1], r2, r1, r4, 57, 7);\n\tkeyiter(k[0], r3, r2, r0, 58, 8);\n\tkeyiter(k[1], r4, r3, r1, 59, 9);\n\tkeyiter(k[2], r0, r4, r2, 60, 10);\n\tkeyiter(k[3], r1, r0, r3, 61, 11);\n\tkeyiter(k[4], r2, r1, r4, 62, 12);\n\tkeyiter(k[5], r3, r2, r0, 63, 13);\n\tkeyiter(k[6], r4, r3, r1, 64, 14);\n\tkeyiter(k[7], r0, r4, r2, 65, 15);\n\tkeyiter(k[8], r1, r0, r3, 66, 16);\n\tkeyiter(k[9], r2, r1, r4, 67, 17);\n\tkeyiter(k[10], r3, r2, r0, 68, 18);\n\tkeyiter(k[11], r4, r3, r1, 69, 19);\n\tkeyiter(k[12], r0, r4, r2, 70, 20);\n\tkeyiter(k[13], r1, r0, r3, 71, 21);\n\tkeyiter(k[14], r2, r1, r4, 72, 22);\n\tkeyiter(k[15], r3, r2, r0, 73, 23);\n\tkeyiter(k[16], r4, r3, r1, 74, 24);\n\tkeyiter(k[17], r0, r4, r2, 75, 25);\n\tkeyiter(k[18], r1, r0, r3, 76, 26);\n\tkeyiter(k[19], r2, r1, r4, 77, 27);\n\tkeyiter(k[20], r3, r2, r0, 78, 28);\n\tkeyiter(k[21], r4, r3, r1, 79, 29);\n\tkeyiter(k[22], r0, r4, r2, 80, 30);\n\tkeyiter(k[23], r1, r0, r3, 81, 31);\n\n\tk += 50;\n\n\tkeyiter(k[-26], r2, r1, r4, 82, -18);\n\tkeyiter(k[-25], r3, r2, r0, 83, -17);\n\tkeyiter(k[-24], r4, r3, r1, 84, -16);\n\tkeyiter(k[-23], r0, r4, r2, 85, -15);\n\tkeyiter(k[-22], r1, r0, r3, 86, -14);\n\tkeyiter(k[-21], r2, r1, r4, 87, -13);\n\tkeyiter(k[-20], r3, r2, r0, 88, -12);\n\tkeyiter(k[-19], r4, r3, r1, 89, -11);\n\tkeyiter(k[-18], r0, r4, r2, 90, -10);\n\tkeyiter(k[-17], r1, r0, r3, 91, -9);\n\tkeyiter(k[-16], r2, r1, r4, 92, -8);\n\tkeyiter(k[-15], r3, r2, r0, 93, -7);\n\tkeyiter(k[-14], r4, r3, r1, 94, -6);\n\tkeyiter(k[-13], r0, r4, r2, 95, -5);\n\tkeyiter(k[-12], r1, r0, r3, 96, -4);\n\tkeyiter(k[-11], r2, r1, r4, 97, -3);\n\tkeyiter(k[-10], r3, r2, r0, 98, -2);\n\tkeyiter(k[-9], r4, r3, r1, 99, -1);\n\tkeyiter(k[-8], r0, r4, r2, 100, 0);\n\tkeyiter(k[-7], r1, r0, r3, 101, 1);\n\tkeyiter(k[-6], r2, r1, r4, 102, 2);\n\tkeyiter(k[-5], r3, r2, r0, 103, 3);\n\tkeyiter(k[-4], r4, r3, r1, 104, 4);\n\tkeyiter(k[-3], r0, r4, r2, 105, 5);\n\tkeyiter(k[-2], r1, r0, r3, 106, 6);\n\tkeyiter(k[-1], r2, r1, r4, 107, 7);\n\tkeyiter(k[0], r3, r2, r0, 108, 8);\n\tkeyiter(k[1], r4, r3, r1, 109, 9);\n\tkeyiter(k[2], r0, r4, r2, 110, 10);\n\tkeyiter(k[3], r1, r0, r3, 111, 11);\n\tkeyiter(k[4], r2, r1, r4, 112, 12);\n\tkeyiter(k[5], r3, r2, r0, 113, 13);\n\tkeyiter(k[6], r4, r3, r1, 114, 14);\n\tkeyiter(k[7], r0, r4, r2, 115, 15);\n\tkeyiter(k[8], r1, r0, r3, 116, 16);\n\tkeyiter(k[9], r2, r1, r4, 117, 17);\n\tkeyiter(k[10], r3, r2, r0, 118, 18);\n\tkeyiter(k[11], r4, r3, r1, 119, 19);\n\tkeyiter(k[12], r0, r4, r2, 120, 20);\n\tkeyiter(k[13], r1, r0, r3, 121, 21);\n\tkeyiter(k[14], r2, r1, r4, 122, 22);\n\tkeyiter(k[15], r3, r2, r0, 123, 23);\n\tkeyiter(k[16], r4, r3, r1, 124, 24);\n\tkeyiter(k[17], r0, r4, r2, 125, 25);\n\tkeyiter(k[18], r1, r0, r3, 126, 26);\n\tkeyiter(k[19], r2, r1, r4, 127, 27);\n\tkeyiter(k[20], r3, r2, r0, 128, 28);\n\tkeyiter(k[21], r4, r3, r1, 129, 29);\n\tkeyiter(k[22], r0, r4, r2, 130, 30);\n\tkeyiter(k[23], r1, r0, r3, 131, 31);\n\n\t \n\t__serpent_setkey_sbox(r0, r1, r2, r3, r4, ctx->expkey);\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(__serpent_setkey);\n\nint serpent_setkey(struct crypto_tfm *tfm, const u8 *key, unsigned int keylen)\n{\n\treturn __serpent_setkey(crypto_tfm_ctx(tfm), key, keylen);\n}\nEXPORT_SYMBOL_GPL(serpent_setkey);\n\nvoid __serpent_encrypt(const void *c, u8 *dst, const u8 *src)\n{\n\tconst struct serpent_ctx *ctx = c;\n\tconst u32 *k = ctx->expkey;\n\tu32\tr0, r1, r2, r3, r4;\n\n\tr0 = get_unaligned_le32(src);\n\tr1 = get_unaligned_le32(src + 4);\n\tr2 = get_unaligned_le32(src + 8);\n\tr3 = get_unaligned_le32(src + 12);\n\n\t\t\t\t\tK(r0, r1, r2, r3, 0);\n\tS0(r0, r1, r2, r3, r4);\t\tLK(r2, r1, r3, r0, r4, 1);\n\tS1(r2, r1, r3, r0, r4);\t\tLK(r4, r3, r0, r2, r1, 2);\n\tS2(r4, r3, r0, r2, r1);\t\tLK(r1, r3, r4, r2, r0, 3);\n\tS3(r1, r3, r4, r2, r0);\t\tLK(r2, r0, r3, r1, r4, 4);\n\tS4(r2, r0, r3, r1, r4);\t\tLK(r0, r3, r1, r4, r2, 5);\n\tS5(r0, r3, r1, r4, r2);\t\tLK(r2, r0, r3, r4, r1, 6);\n\tS6(r2, r0, r3, r4, r1);\t\tLK(r3, r1, r0, r4, r2, 7);\n\tS7(r3, r1, r0, r4, r2);\t\tLK(r2, r0, r4, r3, r1, 8);\n\tS0(r2, r0, r4, r3, r1);\t\tLK(r4, r0, r3, r2, r1, 9);\n\tS1(r4, r0, r3, r2, r1);\t\tLK(r1, r3, r2, r4, r0, 10);\n\tS2(r1, r3, r2, r4, r0);\t\tLK(r0, r3, r1, r4, r2, 11);\n\tS3(r0, r3, r1, r4, r2);\t\tLK(r4, r2, r3, r0, r1, 12);\n\tS4(r4, r2, r3, r0, r1);\t\tLK(r2, r3, r0, r1, r4, 13);\n\tS5(r2, r3, r0, r1, r4);\t\tLK(r4, r2, r3, r1, r0, 14);\n\tS6(r4, r2, r3, r1, r0);\t\tLK(r3, r0, r2, r1, r4, 15);\n\tS7(r3, r0, r2, r1, r4);\t\tLK(r4, r2, r1, r3, r0, 16);\n\tS0(r4, r2, r1, r3, r0);\t\tLK(r1, r2, r3, r4, r0, 17);\n\tS1(r1, r2, r3, r4, r0);\t\tLK(r0, r3, r4, r1, r2, 18);\n\tS2(r0, r3, r4, r1, r2);\t\tLK(r2, r3, r0, r1, r4, 19);\n\tS3(r2, r3, r0, r1, r4);\t\tLK(r1, r4, r3, r2, r0, 20);\n\tS4(r1, r4, r3, r2, r0);\t\tLK(r4, r3, r2, r0, r1, 21);\n\tS5(r4, r3, r2, r0, r1);\t\tLK(r1, r4, r3, r0, r2, 22);\n\tS6(r1, r4, r3, r0, r2);\t\tLK(r3, r2, r4, r0, r1, 23);\n\tS7(r3, r2, r4, r0, r1);\t\tLK(r1, r4, r0, r3, r2, 24);\n\tS0(r1, r4, r0, r3, r2);\t\tLK(r0, r4, r3, r1, r2, 25);\n\tS1(r0, r4, r3, r1, r2);\t\tLK(r2, r3, r1, r0, r4, 26);\n\tS2(r2, r3, r1, r0, r4);\t\tLK(r4, r3, r2, r0, r1, 27);\n\tS3(r4, r3, r2, r0, r1);\t\tLK(r0, r1, r3, r4, r2, 28);\n\tS4(r0, r1, r3, r4, r2);\t\tLK(r1, r3, r4, r2, r0, 29);\n\tS5(r1, r3, r4, r2, r0);\t\tLK(r0, r1, r3, r2, r4, 30);\n\tS6(r0, r1, r3, r2, r4);\t\tLK(r3, r4, r1, r2, r0, 31);\n\tS7(r3, r4, r1, r2, r0);\t\tK(r0, r1, r2, r3, 32);\n\n\tput_unaligned_le32(r0, dst);\n\tput_unaligned_le32(r1, dst + 4);\n\tput_unaligned_le32(r2, dst + 8);\n\tput_unaligned_le32(r3, dst + 12);\n}\nEXPORT_SYMBOL_GPL(__serpent_encrypt);\n\nstatic void serpent_encrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\n{\n\tstruct serpent_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\t__serpent_encrypt(ctx, dst, src);\n}\n\nvoid __serpent_decrypt(const void *c, u8 *dst, const u8 *src)\n{\n\tconst struct serpent_ctx *ctx = c;\n\tconst u32 *k = ctx->expkey;\n\tu32\tr0, r1, r2, r3, r4;\n\n\tr0 = get_unaligned_le32(src);\n\tr1 = get_unaligned_le32(src + 4);\n\tr2 = get_unaligned_le32(src + 8);\n\tr3 = get_unaligned_le32(src + 12);\n\n\t\t\t\t\tK(r0, r1, r2, r3, 32);\n\tSI7(r0, r1, r2, r3, r4);\tKL(r1, r3, r0, r4, r2, 31);\n\tSI6(r1, r3, r0, r4, r2);\tKL(r0, r2, r4, r1, r3, 30);\n\tSI5(r0, r2, r4, r1, r3);\tKL(r2, r3, r0, r4, r1, 29);\n\tSI4(r2, r3, r0, r4, r1);\tKL(r2, r0, r1, r4, r3, 28);\n\tSI3(r2, r0, r1, r4, r3);\tKL(r1, r2, r3, r4, r0, 27);\n\tSI2(r1, r2, r3, r4, r0);\tKL(r2, r0, r4, r3, r1, 26);\n\tSI1(r2, r0, r4, r3, r1);\tKL(r1, r0, r4, r3, r2, 25);\n\tSI0(r1, r0, r4, r3, r2);\tKL(r4, r2, r0, r1, r3, 24);\n\tSI7(r4, r2, r0, r1, r3);\tKL(r2, r1, r4, r3, r0, 23);\n\tSI6(r2, r1, r4, r3, r0);\tKL(r4, r0, r3, r2, r1, 22);\n\tSI5(r4, r0, r3, r2, r1);\tKL(r0, r1, r4, r3, r2, 21);\n\tSI4(r0, r1, r4, r3, r2);\tKL(r0, r4, r2, r3, r1, 20);\n\tSI3(r0, r4, r2, r3, r1);\tKL(r2, r0, r1, r3, r4, 19);\n\tSI2(r2, r0, r1, r3, r4);\tKL(r0, r4, r3, r1, r2, 18);\n\tSI1(r0, r4, r3, r1, r2);\tKL(r2, r4, r3, r1, r0, 17);\n\tSI0(r2, r4, r3, r1, r0);\tKL(r3, r0, r4, r2, r1, 16);\n\tSI7(r3, r0, r4, r2, r1);\tKL(r0, r2, r3, r1, r4, 15);\n\tSI6(r0, r2, r3, r1, r4);\tKL(r3, r4, r1, r0, r2, 14);\n\tSI5(r3, r4, r1, r0, r2);\tKL(r4, r2, r3, r1, r0, 13);\n\tSI4(r4, r2, r3, r1, r0);\tKL(r4, r3, r0, r1, r2, 12);\n\tSI3(r4, r3, r0, r1, r2);\tKL(r0, r4, r2, r1, r3, 11);\n\tSI2(r0, r4, r2, r1, r3);\tKL(r4, r3, r1, r2, r0, 10);\n\tSI1(r4, r3, r1, r2, r0);\tKL(r0, r3, r1, r2, r4, 9);\n\tSI0(r0, r3, r1, r2, r4);\tKL(r1, r4, r3, r0, r2, 8);\n\tSI7(r1, r4, r3, r0, r2);\tKL(r4, r0, r1, r2, r3, 7);\n\tSI6(r4, r0, r1, r2, r3);\tKL(r1, r3, r2, r4, r0, 6);\n\tSI5(r1, r3, r2, r4, r0);\tKL(r3, r0, r1, r2, r4, 5);\n\tSI4(r3, r0, r1, r2, r4);\tKL(r3, r1, r4, r2, r0, 4);\n\tSI3(r3, r1, r4, r2, r0);\tKL(r4, r3, r0, r2, r1, 3);\n\tSI2(r4, r3, r0, r2, r1);\tKL(r3, r1, r2, r0, r4, 2);\n\tSI1(r3, r1, r2, r0, r4);\tKL(r4, r1, r2, r0, r3, 1);\n\tSI0(r4, r1, r2, r0, r3);\tK(r2, r3, r1, r4, 0);\n\n\tput_unaligned_le32(r2, dst);\n\tput_unaligned_le32(r3, dst + 4);\n\tput_unaligned_le32(r1, dst + 8);\n\tput_unaligned_le32(r4, dst + 12);\n}\nEXPORT_SYMBOL_GPL(__serpent_decrypt);\n\nstatic void serpent_decrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\n{\n\tstruct serpent_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\t__serpent_decrypt(ctx, dst, src);\n}\n\nstatic struct crypto_alg srp_alg = {\n\t.cra_name\t\t=\t\"serpent\",\n\t.cra_driver_name\t=\t\"serpent-generic\",\n\t.cra_priority\t\t=\t100,\n\t.cra_flags\t\t=\tCRYPTO_ALG_TYPE_CIPHER,\n\t.cra_blocksize\t\t=\tSERPENT_BLOCK_SIZE,\n\t.cra_ctxsize\t\t=\tsizeof(struct serpent_ctx),\n\t.cra_module\t\t=\tTHIS_MODULE,\n\t.cra_u\t\t\t=\t{ .cipher = {\n\t.cia_min_keysize\t=\tSERPENT_MIN_KEY_SIZE,\n\t.cia_max_keysize\t=\tSERPENT_MAX_KEY_SIZE,\n\t.cia_setkey\t\t=\tserpent_setkey,\n\t.cia_encrypt\t\t=\tserpent_encrypt,\n\t.cia_decrypt\t\t=\tserpent_decrypt } }\n};\n\nstatic int __init serpent_mod_init(void)\n{\n\treturn crypto_register_alg(&srp_alg);\n}\n\nstatic void __exit serpent_mod_fini(void)\n{\n\tcrypto_unregister_alg(&srp_alg);\n}\n\nsubsys_initcall(serpent_mod_init);\nmodule_exit(serpent_mod_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"Serpent Cipher Algorithm\");\nMODULE_AUTHOR(\"Dag Arne Osvik <osvik@ii.uib.no>\");\nMODULE_ALIAS_CRYPTO(\"serpent\");\nMODULE_ALIAS_CRYPTO(\"serpent-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}