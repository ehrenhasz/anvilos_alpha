{
  "module_name": "fcrypt.c",
  "hash_id": "e6435d3aad168d2e00d08cd253a421f22a6a45905684d05c9bee31fd54a2fa10",
  "original_prompt": "Ingested from linux-6.6.14/crypto/fcrypt.c",
  "human_readable_source": " \n\n#include <asm/byteorder.h>\n#include <crypto/algapi.h>\n#include <linux/bitops.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define ROUNDS 16\n\nstruct fcrypt_ctx {\n\t__be32 sched[ROUNDS];\n};\n\n \n#define ror56(hi, lo, n)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\tu32 t = lo & ((1 << n) - 1);\t\t\t\t\\\n\tlo = (lo >> n) | ((hi & ((1 << n) - 1)) << (32 - n));\t\\\n\thi = (hi >> n) | (t << (24-n));\t\t\t\t\\\n} while (0)\n\n \n#define ror56_64(k, n) (k = (k >> n) | ((k & ((1 << n) - 1)) << (56 - n)))\n\n \n#undef Z\n#define Z(x) cpu_to_be32(x << 3)\nstatic const __be32 sbox0[256] = {\n\tZ(0xea), Z(0x7f), Z(0xb2), Z(0x64), Z(0x9d), Z(0xb0), Z(0xd9), Z(0x11),\n\tZ(0xcd), Z(0x86), Z(0x86), Z(0x91), Z(0x0a), Z(0xb2), Z(0x93), Z(0x06),\n\tZ(0x0e), Z(0x06), Z(0xd2), Z(0x65), Z(0x73), Z(0xc5), Z(0x28), Z(0x60),\n\tZ(0xf2), Z(0x20), Z(0xb5), Z(0x38), Z(0x7e), Z(0xda), Z(0x9f), Z(0xe3),\n\tZ(0xd2), Z(0xcf), Z(0xc4), Z(0x3c), Z(0x61), Z(0xff), Z(0x4a), Z(0x4a),\n\tZ(0x35), Z(0xac), Z(0xaa), Z(0x5f), Z(0x2b), Z(0xbb), Z(0xbc), Z(0x53),\n\tZ(0x4e), Z(0x9d), Z(0x78), Z(0xa3), Z(0xdc), Z(0x09), Z(0x32), Z(0x10),\n\tZ(0xc6), Z(0x6f), Z(0x66), Z(0xd6), Z(0xab), Z(0xa9), Z(0xaf), Z(0xfd),\n\tZ(0x3b), Z(0x95), Z(0xe8), Z(0x34), Z(0x9a), Z(0x81), Z(0x72), Z(0x80),\n\tZ(0x9c), Z(0xf3), Z(0xec), Z(0xda), Z(0x9f), Z(0x26), Z(0x76), Z(0x15),\n\tZ(0x3e), Z(0x55), Z(0x4d), Z(0xde), Z(0x84), Z(0xee), Z(0xad), Z(0xc7),\n\tZ(0xf1), Z(0x6b), Z(0x3d), Z(0xd3), Z(0x04), Z(0x49), Z(0xaa), Z(0x24),\n\tZ(0x0b), Z(0x8a), Z(0x83), Z(0xba), Z(0xfa), Z(0x85), Z(0xa0), Z(0xa8),\n\tZ(0xb1), Z(0xd4), Z(0x01), Z(0xd8), Z(0x70), Z(0x64), Z(0xf0), Z(0x51),\n\tZ(0xd2), Z(0xc3), Z(0xa7), Z(0x75), Z(0x8c), Z(0xa5), Z(0x64), Z(0xef),\n\tZ(0x10), Z(0x4e), Z(0xb7), Z(0xc6), Z(0x61), Z(0x03), Z(0xeb), Z(0x44),\n\tZ(0x3d), Z(0xe5), Z(0xb3), Z(0x5b), Z(0xae), Z(0xd5), Z(0xad), Z(0x1d),\n\tZ(0xfa), Z(0x5a), Z(0x1e), Z(0x33), Z(0xab), Z(0x93), Z(0xa2), Z(0xb7),\n\tZ(0xe7), Z(0xa8), Z(0x45), Z(0xa4), Z(0xcd), Z(0x29), Z(0x63), Z(0x44),\n\tZ(0xb6), Z(0x69), Z(0x7e), Z(0x2e), Z(0x62), Z(0x03), Z(0xc8), Z(0xe0),\n\tZ(0x17), Z(0xbb), Z(0xc7), Z(0xf3), Z(0x3f), Z(0x36), Z(0xba), Z(0x71),\n\tZ(0x8e), Z(0x97), Z(0x65), Z(0x60), Z(0x69), Z(0xb6), Z(0xf6), Z(0xe6),\n\tZ(0x6e), Z(0xe0), Z(0x81), Z(0x59), Z(0xe8), Z(0xaf), Z(0xdd), Z(0x95),\n\tZ(0x22), Z(0x99), Z(0xfd), Z(0x63), Z(0x19), Z(0x74), Z(0x61), Z(0xb1),\n\tZ(0xb6), Z(0x5b), Z(0xae), Z(0x54), Z(0xb3), Z(0x70), Z(0xff), Z(0xc6),\n\tZ(0x3b), Z(0x3e), Z(0xc1), Z(0xd7), Z(0xe1), Z(0x0e), Z(0x76), Z(0xe5),\n\tZ(0x36), Z(0x4f), Z(0x59), Z(0xc7), Z(0x08), Z(0x6e), Z(0x82), Z(0xa6),\n\tZ(0x93), Z(0xc4), Z(0xaa), Z(0x26), Z(0x49), Z(0xe0), Z(0x21), Z(0x64),\n\tZ(0x07), Z(0x9f), Z(0x64), Z(0x81), Z(0x9c), Z(0xbf), Z(0xf9), Z(0xd1),\n\tZ(0x43), Z(0xf8), Z(0xb6), Z(0xb9), Z(0xf1), Z(0x24), Z(0x75), Z(0x03),\n\tZ(0xe4), Z(0xb0), Z(0x99), Z(0x46), Z(0x3d), Z(0xf5), Z(0xd1), Z(0x39),\n\tZ(0x72), Z(0x12), Z(0xf6), Z(0xba), Z(0x0c), Z(0x0d), Z(0x42), Z(0x2e)\n};\n\n#undef Z\n#define Z(x) cpu_to_be32(((x & 0x1f) << 27) | (x >> 5))\nstatic const __be32 sbox1[256] = {\n\tZ(0x77), Z(0x14), Z(0xa6), Z(0xfe), Z(0xb2), Z(0x5e), Z(0x8c), Z(0x3e),\n\tZ(0x67), Z(0x6c), Z(0xa1), Z(0x0d), Z(0xc2), Z(0xa2), Z(0xc1), Z(0x85),\n\tZ(0x6c), Z(0x7b), Z(0x67), Z(0xc6), Z(0x23), Z(0xe3), Z(0xf2), Z(0x89),\n\tZ(0x50), Z(0x9c), Z(0x03), Z(0xb7), Z(0x73), Z(0xe6), Z(0xe1), Z(0x39),\n\tZ(0x31), Z(0x2c), Z(0x27), Z(0x9f), Z(0xa5), Z(0x69), Z(0x44), Z(0xd6),\n\tZ(0x23), Z(0x83), Z(0x98), Z(0x7d), Z(0x3c), Z(0xb4), Z(0x2d), Z(0x99),\n\tZ(0x1c), Z(0x1f), Z(0x8c), Z(0x20), Z(0x03), Z(0x7c), Z(0x5f), Z(0xad),\n\tZ(0xf4), Z(0xfa), Z(0x95), Z(0xca), Z(0x76), Z(0x44), Z(0xcd), Z(0xb6),\n\tZ(0xb8), Z(0xa1), Z(0xa1), Z(0xbe), Z(0x9e), Z(0x54), Z(0x8f), Z(0x0b),\n\tZ(0x16), Z(0x74), Z(0x31), Z(0x8a), Z(0x23), Z(0x17), Z(0x04), Z(0xfa),\n\tZ(0x79), Z(0x84), Z(0xb1), Z(0xf5), Z(0x13), Z(0xab), Z(0xb5), Z(0x2e),\n\tZ(0xaa), Z(0x0c), Z(0x60), Z(0x6b), Z(0x5b), Z(0xc4), Z(0x4b), Z(0xbc),\n\tZ(0xe2), Z(0xaf), Z(0x45), Z(0x73), Z(0xfa), Z(0xc9), Z(0x49), Z(0xcd),\n\tZ(0x00), Z(0x92), Z(0x7d), Z(0x97), Z(0x7a), Z(0x18), Z(0x60), Z(0x3d),\n\tZ(0xcf), Z(0x5b), Z(0xde), Z(0xc6), Z(0xe2), Z(0xe6), Z(0xbb), Z(0x8b),\n\tZ(0x06), Z(0xda), Z(0x08), Z(0x15), Z(0x1b), Z(0x88), Z(0x6a), Z(0x17),\n\tZ(0x89), Z(0xd0), Z(0xa9), Z(0xc1), Z(0xc9), Z(0x70), Z(0x6b), Z(0xe5),\n\tZ(0x43), Z(0xf4), Z(0x68), Z(0xc8), Z(0xd3), Z(0x84), Z(0x28), Z(0x0a),\n\tZ(0x52), Z(0x66), Z(0xa3), Z(0xca), Z(0xf2), Z(0xe3), Z(0x7f), Z(0x7a),\n\tZ(0x31), Z(0xf7), Z(0x88), Z(0x94), Z(0x5e), Z(0x9c), Z(0x63), Z(0xd5),\n\tZ(0x24), Z(0x66), Z(0xfc), Z(0xb3), Z(0x57), Z(0x25), Z(0xbe), Z(0x89),\n\tZ(0x44), Z(0xc4), Z(0xe0), Z(0x8f), Z(0x23), Z(0x3c), Z(0x12), Z(0x52),\n\tZ(0xf5), Z(0x1e), Z(0xf4), Z(0xcb), Z(0x18), Z(0x33), Z(0x1f), Z(0xf8),\n\tZ(0x69), Z(0x10), Z(0x9d), Z(0xd3), Z(0xf7), Z(0x28), Z(0xf8), Z(0x30),\n\tZ(0x05), Z(0x5e), Z(0x32), Z(0xc0), Z(0xd5), Z(0x19), Z(0xbd), Z(0x45),\n\tZ(0x8b), Z(0x5b), Z(0xfd), Z(0xbc), Z(0xe2), Z(0x5c), Z(0xa9), Z(0x96),\n\tZ(0xef), Z(0x70), Z(0xcf), Z(0xc2), Z(0x2a), Z(0xb3), Z(0x61), Z(0xad),\n\tZ(0x80), Z(0x48), Z(0x81), Z(0xb7), Z(0x1d), Z(0x43), Z(0xd9), Z(0xd7),\n\tZ(0x45), Z(0xf0), Z(0xd8), Z(0x8a), Z(0x59), Z(0x7c), Z(0x57), Z(0xc1),\n\tZ(0x79), Z(0xc7), Z(0x34), Z(0xd6), Z(0x43), Z(0xdf), Z(0xe4), Z(0x78),\n\tZ(0x16), Z(0x06), Z(0xda), Z(0x92), Z(0x76), Z(0x51), Z(0xe1), Z(0xd4),\n\tZ(0x70), Z(0x03), Z(0xe0), Z(0x2f), Z(0x96), Z(0x91), Z(0x82), Z(0x80)\n};\n\n#undef Z\n#define Z(x) cpu_to_be32(x << 11)\nstatic const __be32 sbox2[256] = {\n\tZ(0xf0), Z(0x37), Z(0x24), Z(0x53), Z(0x2a), Z(0x03), Z(0x83), Z(0x86),\n\tZ(0xd1), Z(0xec), Z(0x50), Z(0xf0), Z(0x42), Z(0x78), Z(0x2f), Z(0x6d),\n\tZ(0xbf), Z(0x80), Z(0x87), Z(0x27), Z(0x95), Z(0xe2), Z(0xc5), Z(0x5d),\n\tZ(0xf9), Z(0x6f), Z(0xdb), Z(0xb4), Z(0x65), Z(0x6e), Z(0xe7), Z(0x24),\n\tZ(0xc8), Z(0x1a), Z(0xbb), Z(0x49), Z(0xb5), Z(0x0a), Z(0x7d), Z(0xb9),\n\tZ(0xe8), Z(0xdc), Z(0xb7), Z(0xd9), Z(0x45), Z(0x20), Z(0x1b), Z(0xce),\n\tZ(0x59), Z(0x9d), Z(0x6b), Z(0xbd), Z(0x0e), Z(0x8f), Z(0xa3), Z(0xa9),\n\tZ(0xbc), Z(0x74), Z(0xa6), Z(0xf6), Z(0x7f), Z(0x5f), Z(0xb1), Z(0x68),\n\tZ(0x84), Z(0xbc), Z(0xa9), Z(0xfd), Z(0x55), Z(0x50), Z(0xe9), Z(0xb6),\n\tZ(0x13), Z(0x5e), Z(0x07), Z(0xb8), Z(0x95), Z(0x02), Z(0xc0), Z(0xd0),\n\tZ(0x6a), Z(0x1a), Z(0x85), Z(0xbd), Z(0xb6), Z(0xfd), Z(0xfe), Z(0x17),\n\tZ(0x3f), Z(0x09), Z(0xa3), Z(0x8d), Z(0xfb), Z(0xed), Z(0xda), Z(0x1d),\n\tZ(0x6d), Z(0x1c), Z(0x6c), Z(0x01), Z(0x5a), Z(0xe5), Z(0x71), Z(0x3e),\n\tZ(0x8b), Z(0x6b), Z(0xbe), Z(0x29), Z(0xeb), Z(0x12), Z(0x19), Z(0x34),\n\tZ(0xcd), Z(0xb3), Z(0xbd), Z(0x35), Z(0xea), Z(0x4b), Z(0xd5), Z(0xae),\n\tZ(0x2a), Z(0x79), Z(0x5a), Z(0xa5), Z(0x32), Z(0x12), Z(0x7b), Z(0xdc),\n\tZ(0x2c), Z(0xd0), Z(0x22), Z(0x4b), Z(0xb1), Z(0x85), Z(0x59), Z(0x80),\n\tZ(0xc0), Z(0x30), Z(0x9f), Z(0x73), Z(0xd3), Z(0x14), Z(0x48), Z(0x40),\n\tZ(0x07), Z(0x2d), Z(0x8f), Z(0x80), Z(0x0f), Z(0xce), Z(0x0b), Z(0x5e),\n\tZ(0xb7), Z(0x5e), Z(0xac), Z(0x24), Z(0x94), Z(0x4a), Z(0x18), Z(0x15),\n\tZ(0x05), Z(0xe8), Z(0x02), Z(0x77), Z(0xa9), Z(0xc7), Z(0x40), Z(0x45),\n\tZ(0x89), Z(0xd1), Z(0xea), Z(0xde), Z(0x0c), Z(0x79), Z(0x2a), Z(0x99),\n\tZ(0x6c), Z(0x3e), Z(0x95), Z(0xdd), Z(0x8c), Z(0x7d), Z(0xad), Z(0x6f),\n\tZ(0xdc), Z(0xff), Z(0xfd), Z(0x62), Z(0x47), Z(0xb3), Z(0x21), Z(0x8a),\n\tZ(0xec), Z(0x8e), Z(0x19), Z(0x18), Z(0xb4), Z(0x6e), Z(0x3d), Z(0xfd),\n\tZ(0x74), Z(0x54), Z(0x1e), Z(0x04), Z(0x85), Z(0xd8), Z(0xbc), Z(0x1f),\n\tZ(0x56), Z(0xe7), Z(0x3a), Z(0x56), Z(0x67), Z(0xd6), Z(0xc8), Z(0xa5),\n\tZ(0xf3), Z(0x8e), Z(0xde), Z(0xae), Z(0x37), Z(0x49), Z(0xb7), Z(0xfa),\n\tZ(0xc8), Z(0xf4), Z(0x1f), Z(0xe0), Z(0x2a), Z(0x9b), Z(0x15), Z(0xd1),\n\tZ(0x34), Z(0x0e), Z(0xb5), Z(0xe0), Z(0x44), Z(0x78), Z(0x84), Z(0x59),\n\tZ(0x56), Z(0x68), Z(0x77), Z(0xa5), Z(0x14), Z(0x06), Z(0xf5), Z(0x2f),\n\tZ(0x8c), Z(0x8a), Z(0x73), Z(0x80), Z(0x76), Z(0xb4), Z(0x10), Z(0x86)\n};\n\n#undef Z\n#define Z(x) cpu_to_be32(x << 19)\nstatic const __be32 sbox3[256] = {\n\tZ(0xa9), Z(0x2a), Z(0x48), Z(0x51), Z(0x84), Z(0x7e), Z(0x49), Z(0xe2),\n\tZ(0xb5), Z(0xb7), Z(0x42), Z(0x33), Z(0x7d), Z(0x5d), Z(0xa6), Z(0x12),\n\tZ(0x44), Z(0x48), Z(0x6d), Z(0x28), Z(0xaa), Z(0x20), Z(0x6d), Z(0x57),\n\tZ(0xd6), Z(0x6b), Z(0x5d), Z(0x72), Z(0xf0), Z(0x92), Z(0x5a), Z(0x1b),\n\tZ(0x53), Z(0x80), Z(0x24), Z(0x70), Z(0x9a), Z(0xcc), Z(0xa7), Z(0x66),\n\tZ(0xa1), Z(0x01), Z(0xa5), Z(0x41), Z(0x97), Z(0x41), Z(0x31), Z(0x82),\n\tZ(0xf1), Z(0x14), Z(0xcf), Z(0x53), Z(0x0d), Z(0xa0), Z(0x10), Z(0xcc),\n\tZ(0x2a), Z(0x7d), Z(0xd2), Z(0xbf), Z(0x4b), Z(0x1a), Z(0xdb), Z(0x16),\n\tZ(0x47), Z(0xf6), Z(0x51), Z(0x36), Z(0xed), Z(0xf3), Z(0xb9), Z(0x1a),\n\tZ(0xa7), Z(0xdf), Z(0x29), Z(0x43), Z(0x01), Z(0x54), Z(0x70), Z(0xa4),\n\tZ(0xbf), Z(0xd4), Z(0x0b), Z(0x53), Z(0x44), Z(0x60), Z(0x9e), Z(0x23),\n\tZ(0xa1), Z(0x18), Z(0x68), Z(0x4f), Z(0xf0), Z(0x2f), Z(0x82), Z(0xc2),\n\tZ(0x2a), Z(0x41), Z(0xb2), Z(0x42), Z(0x0c), Z(0xed), Z(0x0c), Z(0x1d),\n\tZ(0x13), Z(0x3a), Z(0x3c), Z(0x6e), Z(0x35), Z(0xdc), Z(0x60), Z(0x65),\n\tZ(0x85), Z(0xe9), Z(0x64), Z(0x02), Z(0x9a), Z(0x3f), Z(0x9f), Z(0x87),\n\tZ(0x96), Z(0xdf), Z(0xbe), Z(0xf2), Z(0xcb), Z(0xe5), Z(0x6c), Z(0xd4),\n\tZ(0x5a), Z(0x83), Z(0xbf), Z(0x92), Z(0x1b), Z(0x94), Z(0x00), Z(0x42),\n\tZ(0xcf), Z(0x4b), Z(0x00), Z(0x75), Z(0xba), Z(0x8f), Z(0x76), Z(0x5f),\n\tZ(0x5d), Z(0x3a), Z(0x4d), Z(0x09), Z(0x12), Z(0x08), Z(0x38), Z(0x95),\n\tZ(0x17), Z(0xe4), Z(0x01), Z(0x1d), Z(0x4c), Z(0xa9), Z(0xcc), Z(0x85),\n\tZ(0x82), Z(0x4c), Z(0x9d), Z(0x2f), Z(0x3b), Z(0x66), Z(0xa1), Z(0x34),\n\tZ(0x10), Z(0xcd), Z(0x59), Z(0x89), Z(0xa5), Z(0x31), Z(0xcf), Z(0x05),\n\tZ(0xc8), Z(0x84), Z(0xfa), Z(0xc7), Z(0xba), Z(0x4e), Z(0x8b), Z(0x1a),\n\tZ(0x19), Z(0xf1), Z(0xa1), Z(0x3b), Z(0x18), Z(0x12), Z(0x17), Z(0xb0),\n\tZ(0x98), Z(0x8d), Z(0x0b), Z(0x23), Z(0xc3), Z(0x3a), Z(0x2d), Z(0x20),\n\tZ(0xdf), Z(0x13), Z(0xa0), Z(0xa8), Z(0x4c), Z(0x0d), Z(0x6c), Z(0x2f),\n\tZ(0x47), Z(0x13), Z(0x13), Z(0x52), Z(0x1f), Z(0x2d), Z(0xf5), Z(0x79),\n\tZ(0x3d), Z(0xa2), Z(0x54), Z(0xbd), Z(0x69), Z(0xc8), Z(0x6b), Z(0xf3),\n\tZ(0x05), Z(0x28), Z(0xf1), Z(0x16), Z(0x46), Z(0x40), Z(0xb0), Z(0x11),\n\tZ(0xd3), Z(0xb7), Z(0x95), Z(0x49), Z(0xcf), Z(0xc3), Z(0x1d), Z(0x8f),\n\tZ(0xd8), Z(0xe1), Z(0x73), Z(0xdb), Z(0xad), Z(0xc8), Z(0xc9), Z(0xa9),\n\tZ(0xa1), Z(0xc2), Z(0xc5), Z(0xe3), Z(0xba), Z(0xfc), Z(0x0e), Z(0x25)\n};\n\n \n#define F_ENCRYPT(R, L, sched)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tunion lc4 { __be32 l; u8 c[4]; } u;\t\t\t\t\\\n\tu.l = sched ^ R;\t\t\t\t\t\t\\\n\tL ^= sbox0[u.c[0]] ^ sbox1[u.c[1]] ^ sbox2[u.c[2]] ^ sbox3[u.c[3]]; \\\n} while (0)\n\n \nstatic void fcrypt_encrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\n{\n\tconst struct fcrypt_ctx *ctx = crypto_tfm_ctx(tfm);\n\tstruct {\n\t\t__be32 l, r;\n\t} X;\n\n\tmemcpy(&X, src, sizeof(X));\n\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x0]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x1]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x2]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x3]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x4]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x5]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x6]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x7]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x8]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x9]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xa]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xb]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xc]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xd]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xe]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xf]);\n\n\tmemcpy(dst, &X, sizeof(X));\n}\n\n \nstatic void fcrypt_decrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\n{\n\tconst struct fcrypt_ctx *ctx = crypto_tfm_ctx(tfm);\n\tstruct {\n\t\t__be32 l, r;\n\t} X;\n\n\tmemcpy(&X, src, sizeof(X));\n\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xf]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xe]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xd]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xc]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0xb]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0xa]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x9]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x8]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x7]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x6]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x5]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x4]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x3]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x2]);\n\tF_ENCRYPT(X.l, X.r, ctx->sched[0x1]);\n\tF_ENCRYPT(X.r, X.l, ctx->sched[0x0]);\n\n\tmemcpy(dst, &X, sizeof(X));\n}\n\n \nstatic int fcrypt_setkey(struct crypto_tfm *tfm, const u8 *key, unsigned int keylen)\n{\n\tstruct fcrypt_ctx *ctx = crypto_tfm_ctx(tfm);\n\n#if BITS_PER_LONG == 64   \n\n\tu64 k;\t \n\n\t \n\tk = (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key++) >> 1;\n\tk <<= 7;\n\tk |= (*key) >> 1;\n\n\t \n\tctx->sched[0x0] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x1] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x2] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x3] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x4] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x5] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x6] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x7] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x8] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0x9] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xa] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xb] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xc] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xd] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xe] = cpu_to_be32(k); ror56_64(k, 11);\n\tctx->sched[0xf] = cpu_to_be32(k);\n\n\treturn 0;\n#else\n\tu32 hi, lo;\t\t \n\n\t \n\tlo = (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\thi = lo >> 4;\n\tlo &= 0xf;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key++) >> 1;\n\tlo <<= 7;\n\tlo |= (*key) >> 1;\n\n\t \n\tctx->sched[0x0] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x1] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x2] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x3] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x4] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x5] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x6] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x7] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x8] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0x9] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xa] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xb] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xc] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xd] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xe] = cpu_to_be32(lo); ror56(hi, lo, 11);\n\tctx->sched[0xf] = cpu_to_be32(lo);\n\treturn 0;\n#endif\n}\n\nstatic struct crypto_alg fcrypt_alg = {\n\t.cra_name\t\t=\t\"fcrypt\",\n\t.cra_driver_name\t=\t\"fcrypt-generic\",\n\t.cra_flags\t\t=\tCRYPTO_ALG_TYPE_CIPHER,\n\t.cra_blocksize\t\t=\t8,\n\t.cra_ctxsize\t\t=\tsizeof(struct fcrypt_ctx),\n\t.cra_module\t\t=\tTHIS_MODULE,\n\t.cra_u\t\t\t=\t{ .cipher = {\n\t.cia_min_keysize\t=\t8,\n\t.cia_max_keysize\t=\t8,\n\t.cia_setkey\t\t=\tfcrypt_setkey,\n\t.cia_encrypt\t\t=\tfcrypt_encrypt,\n\t.cia_decrypt\t\t=\tfcrypt_decrypt } }\n};\n\nstatic int __init fcrypt_mod_init(void)\n{\n\treturn crypto_register_alg(&fcrypt_alg);\n}\n\nstatic void __exit fcrypt_mod_fini(void)\n{\n\tcrypto_unregister_alg(&fcrypt_alg);\n}\n\nsubsys_initcall(fcrypt_mod_init);\nmodule_exit(fcrypt_mod_fini);\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\nMODULE_DESCRIPTION(\"FCrypt Cipher Algorithm\");\nMODULE_AUTHOR(\"David Howells <dhowells@redhat.com>\");\nMODULE_ALIAS_CRYPTO(\"fcrypt\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}