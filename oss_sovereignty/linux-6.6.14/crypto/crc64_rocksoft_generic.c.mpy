{
  "module_name": "crc64_rocksoft_generic.c",
  "hash_id": "99304e192f1f77fde83691cafe4f85e87d80d05bca0173041a062afa24e04920",
  "original_prompt": "Ingested from linux-6.6.14/crypto/crc64_rocksoft_generic.c",
  "human_readable_source": "\n\n#include <linux/crc64.h>\n#include <linux/module.h>\n#include <crypto/internal/hash.h>\n#include <asm/unaligned.h>\n\nstatic int chksum_init(struct shash_desc *desc)\n{\n\tu64 *crc = shash_desc_ctx(desc);\n\n\t*crc = 0;\n\n\treturn 0;\n}\n\nstatic int chksum_update(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length)\n{\n\tu64 *crc = shash_desc_ctx(desc);\n\n\t*crc = crc64_rocksoft_generic(*crc, data, length);\n\n\treturn 0;\n}\n\nstatic int chksum_final(struct shash_desc *desc, u8 *out)\n{\n\tu64 *crc = shash_desc_ctx(desc);\n\n\tput_unaligned_le64(*crc, out);\n\treturn 0;\n}\n\nstatic int __chksum_finup(u64 crc, const u8 *data, unsigned int len, u8 *out)\n{\n\tcrc = crc64_rocksoft_generic(crc, data, len);\n\tput_unaligned_le64(crc, out);\n\treturn 0;\n}\n\nstatic int chksum_finup(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *out)\n{\n\tu64 *crc = shash_desc_ctx(desc);\n\n\treturn __chksum_finup(*crc, data, len, out);\n}\n\nstatic int chksum_digest(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length, u8 *out)\n{\n\treturn __chksum_finup(0, data, length, out);\n}\n\nstatic struct shash_alg alg = {\n\t.digestsize\t= \tsizeof(u64),\n\t.init\t\t=\tchksum_init,\n\t.update\t\t=\tchksum_update,\n\t.final\t\t=\tchksum_final,\n\t.finup\t\t=\tchksum_finup,\n\t.digest\t\t=\tchksum_digest,\n\t.descsize\t=\tsizeof(u64),\n\t.base\t\t=\t{\n\t\t.cra_name\t\t=\tCRC64_ROCKSOFT_STRING,\n\t\t.cra_driver_name\t=\t\"crc64-rocksoft-generic\",\n\t\t.cra_priority\t\t=\t200,\n\t\t.cra_blocksize\t\t=\t1,\n\t\t.cra_module\t\t=\tTHIS_MODULE,\n\t}\n};\n\nstatic int __init crc64_rocksoft_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit crc64_rocksoft_exit(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nmodule_init(crc64_rocksoft_init);\nmodule_exit(crc64_rocksoft_exit);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"Rocksoft model CRC64 calculation.\");\nMODULE_ALIAS_CRYPTO(\"crc64-rocksoft\");\nMODULE_ALIAS_CRYPTO(\"crc64-rocksoft-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}