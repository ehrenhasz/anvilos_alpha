{
  "module_name": "crct10dif_generic.c",
  "hash_id": "22b3f1d5352aaa8f01b2a865a005cf308d74032b87d8ada57baacb6ce74e170c",
  "original_prompt": "Ingested from linux-6.6.14/crypto/crct10dif_generic.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/crc-t10dif.h>\n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n\nstruct chksum_desc_ctx {\n\t__u16 crc;\n};\n\n \n\nstatic int chksum_init(struct shash_desc *desc)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\tctx->crc = 0;\n\n\treturn 0;\n}\n\nstatic int chksum_update(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\tctx->crc = crc_t10dif_generic(ctx->crc, data, length);\n\treturn 0;\n}\n\nstatic int chksum_final(struct shash_desc *desc, u8 *out)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\t*(__u16 *)out = ctx->crc;\n\treturn 0;\n}\n\nstatic int __chksum_finup(__u16 crc, const u8 *data, unsigned int len, u8 *out)\n{\n\t*(__u16 *)out = crc_t10dif_generic(crc, data, len);\n\treturn 0;\n}\n\nstatic int chksum_finup(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *out)\n{\n\tstruct chksum_desc_ctx *ctx = shash_desc_ctx(desc);\n\n\treturn __chksum_finup(ctx->crc, data, len, out);\n}\n\nstatic int chksum_digest(struct shash_desc *desc, const u8 *data,\n\t\t\t unsigned int length, u8 *out)\n{\n\treturn __chksum_finup(0, data, length, out);\n}\n\nstatic struct shash_alg alg = {\n\t.digestsize\t\t=\tCRC_T10DIF_DIGEST_SIZE,\n\t.init\t\t=\tchksum_init,\n\t.update\t\t=\tchksum_update,\n\t.final\t\t=\tchksum_final,\n\t.finup\t\t=\tchksum_finup,\n\t.digest\t\t=\tchksum_digest,\n\t.descsize\t\t=\tsizeof(struct chksum_desc_ctx),\n\t.base\t\t\t=\t{\n\t\t.cra_name\t\t=\t\"crct10dif\",\n\t\t.cra_driver_name\t=\t\"crct10dif-generic\",\n\t\t.cra_priority\t\t=\t100,\n\t\t.cra_blocksize\t\t=\tCRC_T10DIF_BLOCK_SIZE,\n\t\t.cra_module\t\t=\tTHIS_MODULE,\n\t}\n};\n\nstatic int __init crct10dif_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit crct10dif_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(crct10dif_mod_init);\nmodule_exit(crct10dif_mod_fini);\n\nMODULE_AUTHOR(\"Tim Chen <tim.c.chen@linux.intel.com>\");\nMODULE_DESCRIPTION(\"T10 DIF CRC calculation.\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_CRYPTO(\"crct10dif\");\nMODULE_ALIAS_CRYPTO(\"crct10dif-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}