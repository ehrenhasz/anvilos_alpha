{
  "module_name": "fips.c",
  "hash_id": "31e40d3839de40d29e0f4ac4b2e31832cbb48739b657ab5e9f5772d692ffa510",
  "original_prompt": "Ingested from linux-6.6.14/crypto/fips.c",
  "human_readable_source": "\n \n\n#include <linux/export.h>\n#include <linux/fips.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/sysctl.h>\n#include <linux/notifier.h>\n#include <generated/utsrelease.h>\n\nint fips_enabled;\nEXPORT_SYMBOL_GPL(fips_enabled);\n\nATOMIC_NOTIFIER_HEAD(fips_fail_notif_chain);\nEXPORT_SYMBOL_GPL(fips_fail_notif_chain);\n\n \nstatic int fips_enable(char *str)\n{\n\tfips_enabled = !!simple_strtol(str, NULL, 0);\n\tprintk(KERN_INFO \"fips mode: %s\\n\",\n\t\tfips_enabled ? \"enabled\" : \"disabled\");\n\treturn 1;\n}\n\n__setup(\"fips=\", fips_enable);\n\n#define FIPS_MODULE_NAME CONFIG_CRYPTO_FIPS_NAME\n#ifdef CONFIG_CRYPTO_FIPS_CUSTOM_VERSION\n#define FIPS_MODULE_VERSION CONFIG_CRYPTO_FIPS_VERSION\n#else\n#define FIPS_MODULE_VERSION UTS_RELEASE\n#endif\n\nstatic char fips_name[] = FIPS_MODULE_NAME;\nstatic char fips_version[] = FIPS_MODULE_VERSION;\n\nstatic struct ctl_table crypto_sysctl_table[] = {\n\t{\n\t\t.procname\t= \"fips_enabled\",\n\t\t.data\t\t= &fips_enabled,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0444,\n\t\t.proc_handler\t= proc_dointvec\n\t},\n\t{\n\t\t.procname\t= \"fips_name\",\n\t\t.data\t\t= &fips_name,\n\t\t.maxlen\t\t= 64,\n\t\t.mode\t\t= 0444,\n\t\t.proc_handler\t= proc_dostring\n\t},\n\t{\n\t\t.procname\t= \"fips_version\",\n\t\t.data\t\t= &fips_version,\n\t\t.maxlen\t\t= 64,\n\t\t.mode\t\t= 0444,\n\t\t.proc_handler\t= proc_dostring\n\t},\n\t{}\n};\n\nstatic struct ctl_table_header *crypto_sysctls;\n\nstatic void crypto_proc_fips_init(void)\n{\n\tcrypto_sysctls = register_sysctl(\"crypto\", crypto_sysctl_table);\n}\n\nstatic void crypto_proc_fips_exit(void)\n{\n\tunregister_sysctl_table(crypto_sysctls);\n}\n\nvoid fips_fail_notify(void)\n{\n\tif (fips_enabled)\n\t\tatomic_notifier_call_chain(&fips_fail_notif_chain, 0, NULL);\n}\nEXPORT_SYMBOL_GPL(fips_fail_notify);\n\nstatic int __init fips_init(void)\n{\n\tcrypto_proc_fips_init();\n\treturn 0;\n}\n\nstatic void __exit fips_exit(void)\n{\n\tcrypto_proc_fips_exit();\n}\n\nsubsys_initcall(fips_init);\nmodule_exit(fips_exit);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}