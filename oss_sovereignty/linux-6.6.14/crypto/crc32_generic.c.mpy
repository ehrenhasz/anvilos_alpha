{
  "module_name": "crc32_generic.c",
  "hash_id": "32760a7d14a6a322188d8088cd9ad49077f24526d6f9b07e88d872683fd434de",
  "original_prompt": "Ingested from linux-6.6.14/crypto/crc32_generic.c",
  "human_readable_source": "\n \n\n \n\n#include <asm/unaligned.h>\n#include <linux/crc32.h>\n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\n#define CHKSUM_BLOCK_SIZE\t1\n#define CHKSUM_DIGEST_SIZE\t4\n\n \nstatic int crc32_cra_init(struct crypto_tfm *tfm)\n{\n\tu32 *key = crypto_tfm_ctx(tfm);\n\n\t*key = 0;\n\n\treturn 0;\n}\n\n \nstatic int crc32_setkey(struct crypto_shash *hash, const u8 *key,\n\t\t\tunsigned int keylen)\n{\n\tu32 *mctx = crypto_shash_ctx(hash);\n\n\tif (keylen != sizeof(u32))\n\t\treturn -EINVAL;\n\t*mctx = get_unaligned_le32(key);\n\treturn 0;\n}\n\nstatic int crc32_init(struct shash_desc *desc)\n{\n\tu32 *mctx = crypto_shash_ctx(desc->tfm);\n\tu32 *crcp = shash_desc_ctx(desc);\n\n\t*crcp = *mctx;\n\n\treturn 0;\n}\n\nstatic int crc32_update(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len)\n{\n\tu32 *crcp = shash_desc_ctx(desc);\n\n\t*crcp = crc32_le(*crcp, data, len);\n\treturn 0;\n}\n\n \nstatic int __crc32_finup(u32 *crcp, const u8 *data, unsigned int len,\n\t\t\t u8 *out)\n{\n\tput_unaligned_le32(crc32_le(*crcp, data, len), out);\n\treturn 0;\n}\n\nstatic int crc32_finup(struct shash_desc *desc, const u8 *data,\n\t\t       unsigned int len, u8 *out)\n{\n\treturn __crc32_finup(shash_desc_ctx(desc), data, len, out);\n}\n\nstatic int crc32_final(struct shash_desc *desc, u8 *out)\n{\n\tu32 *crcp = shash_desc_ctx(desc);\n\n\tput_unaligned_le32(*crcp, out);\n\treturn 0;\n}\n\nstatic int crc32_digest(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *out)\n{\n\treturn __crc32_finup(crypto_shash_ctx(desc->tfm), data, len,\n\t\t\t     out);\n}\nstatic struct shash_alg alg = {\n\t.setkey\t\t= crc32_setkey,\n\t.init\t\t= crc32_init,\n\t.update\t\t= crc32_update,\n\t.final\t\t= crc32_final,\n\t.finup\t\t= crc32_finup,\n\t.digest\t\t= crc32_digest,\n\t.descsize\t= sizeof(u32),\n\t.digestsize\t= CHKSUM_DIGEST_SIZE,\n\t.base\t\t= {\n\t\t.cra_name\t\t= \"crc32\",\n\t\t.cra_driver_name\t= \"crc32-generic\",\n\t\t.cra_priority\t\t= 100,\n\t\t.cra_flags\t\t= CRYPTO_ALG_OPTIONAL_KEY,\n\t\t.cra_blocksize\t\t= CHKSUM_BLOCK_SIZE,\n\t\t.cra_ctxsize\t\t= sizeof(u32),\n\t\t.cra_module\t\t= THIS_MODULE,\n\t\t.cra_init\t\t= crc32_cra_init,\n\t}\n};\n\nstatic int __init crc32_mod_init(void)\n{\n\treturn crypto_register_shash(&alg);\n}\n\nstatic void __exit crc32_mod_fini(void)\n{\n\tcrypto_unregister_shash(&alg);\n}\n\nsubsys_initcall(crc32_mod_init);\nmodule_exit(crc32_mod_fini);\n\nMODULE_AUTHOR(\"Alexander Boyko <alexander_boyko@xyratex.com>\");\nMODULE_DESCRIPTION(\"CRC32 calculations wrapper for lib/crc32\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_CRYPTO(\"crc32\");\nMODULE_ALIAS_CRYPTO(\"crc32-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}