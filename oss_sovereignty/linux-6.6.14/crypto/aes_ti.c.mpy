{
  "module_name": "aes_ti.c",
  "hash_id": "55414f3753571088bc831e1652806b00a96fa21e5c572c54ef48ab3f8b769ae1",
  "original_prompt": "Ingested from linux-6.6.14/crypto/aes_ti.c",
  "human_readable_source": "\n \n\n#include <crypto/aes.h>\n#include <crypto/algapi.h>\n#include <linux/module.h>\n\nstatic int aesti_set_key(struct crypto_tfm *tfm, const u8 *in_key,\n\t\t\t unsigned int key_len)\n{\n\tstruct crypto_aes_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\treturn aes_expandkey(ctx, in_key, key_len);\n}\n\nstatic void aesti_encrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct crypto_aes_ctx *ctx = crypto_tfm_ctx(tfm);\n\tunsigned long flags;\n\n\t \n\tlocal_irq_save(flags);\n\n\taes_encrypt(ctx, out, in);\n\n\tlocal_irq_restore(flags);\n}\n\nstatic void aesti_decrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\n{\n\tconst struct crypto_aes_ctx *ctx = crypto_tfm_ctx(tfm);\n\tunsigned long flags;\n\n\t \n\tlocal_irq_save(flags);\n\n\taes_decrypt(ctx, out, in);\n\n\tlocal_irq_restore(flags);\n}\n\nstatic struct crypto_alg aes_alg = {\n\t.cra_name\t\t\t= \"aes\",\n\t.cra_driver_name\t\t= \"aes-fixed-time\",\n\t.cra_priority\t\t\t= 100 + 1,\n\t.cra_flags\t\t\t= CRYPTO_ALG_TYPE_CIPHER,\n\t.cra_blocksize\t\t\t= AES_BLOCK_SIZE,\n\t.cra_ctxsize\t\t\t= sizeof(struct crypto_aes_ctx),\n\t.cra_module\t\t\t= THIS_MODULE,\n\n\t.cra_cipher.cia_min_keysize\t= AES_MIN_KEY_SIZE,\n\t.cra_cipher.cia_max_keysize\t= AES_MAX_KEY_SIZE,\n\t.cra_cipher.cia_setkey\t\t= aesti_set_key,\n\t.cra_cipher.cia_encrypt\t\t= aesti_encrypt,\n\t.cra_cipher.cia_decrypt\t\t= aesti_decrypt\n};\n\nstatic int __init aes_init(void)\n{\n\treturn crypto_register_alg(&aes_alg);\n}\n\nstatic void __exit aes_fini(void)\n{\n\tcrypto_unregister_alg(&aes_alg);\n}\n\nmodule_init(aes_init);\nmodule_exit(aes_fini);\n\nMODULE_DESCRIPTION(\"Generic fixed time AES\");\nMODULE_AUTHOR(\"Ard Biesheuvel <ard.biesheuvel@linaro.org>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}