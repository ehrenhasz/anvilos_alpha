{
  "module_name": "sha256_generic.c",
  "hash_id": "e54685cf894fb42a63712531f70a4873b51a48c8789f921eac48362833fcaf60",
  "original_prompt": "Ingested from linux-6.6.14/crypto/sha256_generic.c",
  "human_readable_source": "\n \n#include <crypto/internal/hash.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <crypto/sha2.h>\n#include <crypto/sha256_base.h>\n#include <asm/byteorder.h>\n#include <asm/unaligned.h>\n\nconst u8 sha224_zero_message_hash[SHA224_DIGEST_SIZE] = {\n\t0xd1, 0x4a, 0x02, 0x8c, 0x2a, 0x3a, 0x2b, 0xc9, 0x47,\n\t0x61, 0x02, 0xbb, 0x28, 0x82, 0x34, 0xc4, 0x15, 0xa2,\n\t0xb0, 0x1f, 0x82, 0x8e, 0xa6, 0x2a, 0xc5, 0xb3, 0xe4,\n\t0x2f\n};\nEXPORT_SYMBOL_GPL(sha224_zero_message_hash);\n\nconst u8 sha256_zero_message_hash[SHA256_DIGEST_SIZE] = {\n\t0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14,\n\t0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24,\n\t0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c,\n\t0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55\n};\nEXPORT_SYMBOL_GPL(sha256_zero_message_hash);\n\nint crypto_sha256_update(struct shash_desc *desc, const u8 *data,\n\t\t\t  unsigned int len)\n{\n\tsha256_update(shash_desc_ctx(desc), data, len);\n\treturn 0;\n}\nEXPORT_SYMBOL(crypto_sha256_update);\n\nstatic int crypto_sha256_final(struct shash_desc *desc, u8 *out)\n{\n\tif (crypto_shash_digestsize(desc->tfm) == SHA224_DIGEST_SIZE)\n\t\tsha224_final(shash_desc_ctx(desc), out);\n\telse\n\t\tsha256_final(shash_desc_ctx(desc), out);\n\treturn 0;\n}\n\nint crypto_sha256_finup(struct shash_desc *desc, const u8 *data,\n\t\t\tunsigned int len, u8 *hash)\n{\n\tsha256_update(shash_desc_ctx(desc), data, len);\n\treturn crypto_sha256_final(desc, hash);\n}\nEXPORT_SYMBOL(crypto_sha256_finup);\n\nstatic struct shash_alg sha256_algs[2] = { {\n\t.digestsize\t=\tSHA256_DIGEST_SIZE,\n\t.init\t\t=\tsha256_base_init,\n\t.update\t\t=\tcrypto_sha256_update,\n\t.final\t\t=\tcrypto_sha256_final,\n\t.finup\t\t=\tcrypto_sha256_finup,\n\t.descsize\t=\tsizeof(struct sha256_state),\n\t.base\t\t=\t{\n\t\t.cra_name\t=\t\"sha256\",\n\t\t.cra_driver_name=\t\"sha256-generic\",\n\t\t.cra_priority\t=\t100,\n\t\t.cra_blocksize\t=\tSHA256_BLOCK_SIZE,\n\t\t.cra_module\t=\tTHIS_MODULE,\n\t}\n}, {\n\t.digestsize\t=\tSHA224_DIGEST_SIZE,\n\t.init\t\t=\tsha224_base_init,\n\t.update\t\t=\tcrypto_sha256_update,\n\t.final\t\t=\tcrypto_sha256_final,\n\t.finup\t\t=\tcrypto_sha256_finup,\n\t.descsize\t=\tsizeof(struct sha256_state),\n\t.base\t\t=\t{\n\t\t.cra_name\t=\t\"sha224\",\n\t\t.cra_driver_name=\t\"sha224-generic\",\n\t\t.cra_priority\t=\t100,\n\t\t.cra_blocksize\t=\tSHA224_BLOCK_SIZE,\n\t\t.cra_module\t=\tTHIS_MODULE,\n\t}\n} };\n\nstatic int __init sha256_generic_mod_init(void)\n{\n\treturn crypto_register_shashes(sha256_algs, ARRAY_SIZE(sha256_algs));\n}\n\nstatic void __exit sha256_generic_mod_fini(void)\n{\n\tcrypto_unregister_shashes(sha256_algs, ARRAY_SIZE(sha256_algs));\n}\n\nsubsys_initcall(sha256_generic_mod_init);\nmodule_exit(sha256_generic_mod_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"SHA-224 and SHA-256 Secure Hash Algorithm\");\n\nMODULE_ALIAS_CRYPTO(\"sha224\");\nMODULE_ALIAS_CRYPTO(\"sha224-generic\");\nMODULE_ALIAS_CRYPTO(\"sha256\");\nMODULE_ALIAS_CRYPTO(\"sha256-generic\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}