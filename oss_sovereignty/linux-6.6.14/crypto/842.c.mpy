{
  "module_name": "842.c",
  "hash_id": "752c114b2242114d36be71189dd65b0ba62fdffba21599be688984cd4c7a7415",
  "original_prompt": "Ingested from linux-6.6.14/crypto/842.c",
  "human_readable_source": "\n \n\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/crypto.h>\n#include <linux/sw842.h>\n#include <crypto/internal/scompress.h>\n\nstruct crypto842_ctx {\n\tvoid *wmem;\t \n};\n\nstatic void *crypto842_alloc_ctx(struct crypto_scomp *tfm)\n{\n\tvoid *ctx;\n\n\tctx = kmalloc(SW842_MEM_COMPRESS, GFP_KERNEL);\n\tif (!ctx)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\treturn ctx;\n}\n\nstatic int crypto842_init(struct crypto_tfm *tfm)\n{\n\tstruct crypto842_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\tctx->wmem = crypto842_alloc_ctx(NULL);\n\tif (IS_ERR(ctx->wmem))\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}\n\nstatic void crypto842_free_ctx(struct crypto_scomp *tfm, void *ctx)\n{\n\tkfree(ctx);\n}\n\nstatic void crypto842_exit(struct crypto_tfm *tfm)\n{\n\tstruct crypto842_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\tcrypto842_free_ctx(NULL, ctx->wmem);\n}\n\nstatic int crypto842_compress(struct crypto_tfm *tfm,\n\t\t\t      const u8 *src, unsigned int slen,\n\t\t\t      u8 *dst, unsigned int *dlen)\n{\n\tstruct crypto842_ctx *ctx = crypto_tfm_ctx(tfm);\n\n\treturn sw842_compress(src, slen, dst, dlen, ctx->wmem);\n}\n\nstatic int crypto842_scompress(struct crypto_scomp *tfm,\n\t\t\t       const u8 *src, unsigned int slen,\n\t\t\t       u8 *dst, unsigned int *dlen, void *ctx)\n{\n\treturn sw842_compress(src, slen, dst, dlen, ctx);\n}\n\nstatic int crypto842_decompress(struct crypto_tfm *tfm,\n\t\t\t\tconst u8 *src, unsigned int slen,\n\t\t\t\tu8 *dst, unsigned int *dlen)\n{\n\treturn sw842_decompress(src, slen, dst, dlen);\n}\n\nstatic int crypto842_sdecompress(struct crypto_scomp *tfm,\n\t\t\t\t const u8 *src, unsigned int slen,\n\t\t\t\t u8 *dst, unsigned int *dlen, void *ctx)\n{\n\treturn sw842_decompress(src, slen, dst, dlen);\n}\n\nstatic struct crypto_alg alg = {\n\t.cra_name\t\t= \"842\",\n\t.cra_driver_name\t= \"842-generic\",\n\t.cra_priority\t\t= 100,\n\t.cra_flags\t\t= CRYPTO_ALG_TYPE_COMPRESS,\n\t.cra_ctxsize\t\t= sizeof(struct crypto842_ctx),\n\t.cra_module\t\t= THIS_MODULE,\n\t.cra_init\t\t= crypto842_init,\n\t.cra_exit\t\t= crypto842_exit,\n\t.cra_u\t\t\t= { .compress = {\n\t.coa_compress\t\t= crypto842_compress,\n\t.coa_decompress\t\t= crypto842_decompress } }\n};\n\nstatic struct scomp_alg scomp = {\n\t.alloc_ctx\t\t= crypto842_alloc_ctx,\n\t.free_ctx\t\t= crypto842_free_ctx,\n\t.compress\t\t= crypto842_scompress,\n\t.decompress\t\t= crypto842_sdecompress,\n\t.base\t\t\t= {\n\t\t.cra_name\t= \"842\",\n\t\t.cra_driver_name = \"842-scomp\",\n\t\t.cra_priority\t = 100,\n\t\t.cra_module\t = THIS_MODULE,\n\t}\n};\n\nstatic int __init crypto842_mod_init(void)\n{\n\tint ret;\n\n\tret = crypto_register_alg(&alg);\n\tif (ret)\n\t\treturn ret;\n\n\tret = crypto_register_scomp(&scomp);\n\tif (ret) {\n\t\tcrypto_unregister_alg(&alg);\n\t\treturn ret;\n\t}\n\n\treturn ret;\n}\nsubsys_initcall(crypto842_mod_init);\n\nstatic void __exit crypto842_mod_exit(void)\n{\n\tcrypto_unregister_alg(&alg);\n\tcrypto_unregister_scomp(&scomp);\n}\nmodule_exit(crypto842_mod_exit);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"842 Software Compression Algorithm\");\nMODULE_ALIAS_CRYPTO(\"842\");\nMODULE_ALIAS_CRYPTO(\"842-generic\");\nMODULE_AUTHOR(\"Dan Streetman <ddstreet@ieee.org>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}