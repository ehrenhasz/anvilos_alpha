{
  "module_name": "tcrypt.c",
  "hash_id": "6bf17ffa74ae28b1a1efbc872870e5933fd221a9a609886561e4317907b016fd",
  "original_prompt": "Ingested from linux-6.6.14/crypto/tcrypt.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <crypto/aead.h>\n#include <crypto/hash.h>\n#include <crypto/skcipher.h>\n#include <linux/err.h>\n#include <linux/fips.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/scatterlist.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/timex.h>\n\n#include \"internal.h\"\n#include \"tcrypt.h\"\n\n \n#define TVMEMSIZE\t4\n\n \n#define ENCRYPT 1\n#define DECRYPT 0\n\n#define MAX_DIGEST_SIZE\t\t64\n\n \n#define get_driver_name(tfm_type, tfm) crypto_tfm_alg_driver_name(tfm_type ## _tfm(tfm))\n\n \nstatic unsigned int sec;\n\nstatic char *alg;\nstatic u32 type;\nstatic u32 mask;\nstatic int mode;\nstatic u32 num_mb = 8;\nstatic unsigned int klen;\nstatic char *tvmem[TVMEMSIZE];\n\nstatic const int block_sizes[] = { 16, 64, 128, 256, 1024, 1420, 4096, 0 };\nstatic const int aead_sizes[] = { 16, 64, 256, 512, 1024, 1420, 4096, 8192, 0 };\n\n#define XBUFSIZE 8\n#define MAX_IVLEN 32\n\nstatic int testmgr_alloc_buf(char *buf[XBUFSIZE])\n{\n\tint i;\n\n\tfor (i = 0; i < XBUFSIZE; i++) {\n\t\tbuf[i] = (void *)__get_free_page(GFP_KERNEL);\n\t\tif (!buf[i])\n\t\t\tgoto err_free_buf;\n\t}\n\n\treturn 0;\n\nerr_free_buf:\n\twhile (i-- > 0)\n\t\tfree_page((unsigned long)buf[i]);\n\n\treturn -ENOMEM;\n}\n\nstatic void testmgr_free_buf(char *buf[XBUFSIZE])\n{\n\tint i;\n\n\tfor (i = 0; i < XBUFSIZE; i++)\n\t\tfree_page((unsigned long)buf[i]);\n}\n\nstatic void sg_init_aead(struct scatterlist *sg, char *xbuf[XBUFSIZE],\n\t\t\t unsigned int buflen, const void *assoc,\n\t\t\t unsigned int aad_size)\n{\n\tint np = (buflen + PAGE_SIZE - 1)/PAGE_SIZE;\n\tint k, rem;\n\n\tif (np > XBUFSIZE) {\n\t\trem = PAGE_SIZE;\n\t\tnp = XBUFSIZE;\n\t} else {\n\t\trem = buflen % PAGE_SIZE;\n\t}\n\n\tsg_init_table(sg, np + 1);\n\n\tsg_set_buf(&sg[0], assoc, aad_size);\n\n\tif (rem)\n\t\tnp--;\n\tfor (k = 0; k < np; k++)\n\t\tsg_set_buf(&sg[k + 1], xbuf[k], PAGE_SIZE);\n\n\tif (rem)\n\t\tsg_set_buf(&sg[k + 1], xbuf[k], rem);\n}\n\nstatic inline int do_one_aead_op(struct aead_request *req, int ret)\n{\n\tstruct crypto_wait *wait = req->base.data;\n\n\treturn crypto_wait_req(ret, wait);\n}\n\nstruct test_mb_aead_data {\n\tstruct scatterlist sg[XBUFSIZE];\n\tstruct scatterlist sgout[XBUFSIZE];\n\tstruct aead_request *req;\n\tstruct crypto_wait wait;\n\tchar *xbuf[XBUFSIZE];\n\tchar *xoutbuf[XBUFSIZE];\n\tchar *axbuf[XBUFSIZE];\n};\n\nstatic int do_mult_aead_op(struct test_mb_aead_data *data, int enc,\n\t\t\t\tu32 num_mb, int *rc)\n{\n\tint i, err = 0;\n\n\t \n\tfor (i = 0; i < num_mb; i++) {\n\t\tif (enc == ENCRYPT)\n\t\t\trc[i] = crypto_aead_encrypt(data[i].req);\n\t\telse\n\t\t\trc[i] = crypto_aead_decrypt(data[i].req);\n\t}\n\n\t \n\tfor (i = 0; i < num_mb; i++) {\n\t\trc[i] = crypto_wait_req(rc[i], &data[i].wait);\n\n\t\tif (rc[i]) {\n\t\t\tpr_info(\"concurrent request %d error %d\\n\", i, rc[i]);\n\t\t\terr = rc[i];\n\t\t}\n\t}\n\n\treturn err;\n}\n\nstatic int test_mb_aead_jiffies(struct test_mb_aead_data *data, int enc,\n\t\t\t\tint blen, int secs, u32 num_mb)\n{\n\tunsigned long start, end;\n\tint bcount;\n\tint ret = 0;\n\tint *rc;\n\n\trc = kcalloc(num_mb, sizeof(*rc), GFP_KERNEL);\n\tif (!rc)\n\t\treturn -ENOMEM;\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tret = do_mult_aead_op(data, enc, num_mb, rc);\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\tpr_cont(\"%d operations in %d seconds (%llu bytes)\\n\",\n\t\tbcount * num_mb, secs, (u64)bcount * blen * num_mb);\n\nout:\n\tkfree(rc);\n\treturn ret;\n}\n\nstatic int test_mb_aead_cycles(struct test_mb_aead_data *data, int enc,\n\t\t\t       int blen, u32 num_mb)\n{\n\tunsigned long cycles = 0;\n\tint ret = 0;\n\tint i;\n\tint *rc;\n\n\trc = kcalloc(num_mb, sizeof(*rc), GFP_KERNEL);\n\tif (!rc)\n\t\treturn -ENOMEM;\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tret = do_mult_aead_op(data, enc, num_mb, rc);\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\t\tret = do_mult_aead_op(data, enc, num_mb, rc);\n\t\tend = get_cycles();\n\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tcycles += end - start;\n\t}\n\n\tpr_cont(\"1 operation in %lu cycles (%d bytes)\\n\",\n\t\t(cycles + 4) / (8 * num_mb), blen);\n\nout:\n\tkfree(rc);\n\treturn ret;\n}\n\nstatic void test_mb_aead_speed(const char *algo, int enc, int secs,\n\t\t\t       struct aead_speed_template *template,\n\t\t\t       unsigned int tcount, u8 authsize,\n\t\t\t       unsigned int aad_size, u8 *keysize, u32 num_mb)\n{\n\tstruct test_mb_aead_data *data;\n\tstruct crypto_aead *tfm;\n\tunsigned int i, j, iv_len;\n\tconst int *b_size;\n\tconst char *key;\n\tconst char *e;\n\tvoid *assoc;\n\tchar *iv;\n\tint ret;\n\n\n\tif (aad_size >= PAGE_SIZE) {\n\t\tpr_err(\"associate data length (%u) too big\\n\", aad_size);\n\t\treturn;\n\t}\n\n\tiv = kzalloc(MAX_IVLEN, GFP_KERNEL);\n\tif (!iv)\n\t\treturn;\n\n\tif (enc == ENCRYPT)\n\t\te = \"encryption\";\n\telse\n\t\te = \"decryption\";\n\n\tdata = kcalloc(num_mb, sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\tgoto out_free_iv;\n\n\ttfm = crypto_alloc_aead(algo, 0, 0);\n\tif (IS_ERR(tfm)) {\n\t\tpr_err(\"failed to load transform for %s: %ld\\n\",\n\t\t\talgo, PTR_ERR(tfm));\n\t\tgoto out_free_data;\n\t}\n\n\tret = crypto_aead_setauthsize(tfm, authsize);\n\tif (ret) {\n\t\tpr_err(\"alg: aead: Failed to setauthsize for %s: %d\\n\", algo,\n\t\t       ret);\n\t\tgoto out_free_tfm;\n\t}\n\n\tfor (i = 0; i < num_mb; ++i)\n\t\tif (testmgr_alloc_buf(data[i].xbuf)) {\n\t\t\twhile (i--)\n\t\t\t\ttestmgr_free_buf(data[i].xbuf);\n\t\t\tgoto out_free_tfm;\n\t\t}\n\n\tfor (i = 0; i < num_mb; ++i)\n\t\tif (testmgr_alloc_buf(data[i].axbuf)) {\n\t\t\twhile (i--)\n\t\t\t\ttestmgr_free_buf(data[i].axbuf);\n\t\t\tgoto out_free_xbuf;\n\t\t}\n\n\tfor (i = 0; i < num_mb; ++i)\n\t\tif (testmgr_alloc_buf(data[i].xoutbuf)) {\n\t\t\twhile (i--)\n\t\t\t\ttestmgr_free_buf(data[i].xoutbuf);\n\t\t\tgoto out_free_axbuf;\n\t\t}\n\n\tfor (i = 0; i < num_mb; ++i) {\n\t\tdata[i].req = aead_request_alloc(tfm, GFP_KERNEL);\n\t\tif (!data[i].req) {\n\t\t\tpr_err(\"alg: aead: Failed to allocate request for %s\\n\",\n\t\t\t       algo);\n\t\t\twhile (i--)\n\t\t\t\taead_request_free(data[i].req);\n\t\t\tgoto out_free_xoutbuf;\n\t\t}\n\t}\n\n\tfor (i = 0; i < num_mb; ++i) {\n\t\tcrypto_init_wait(&data[i].wait);\n\t\taead_request_set_callback(data[i].req,\n\t\t\t\t\t  CRYPTO_TFM_REQ_MAY_BACKLOG,\n\t\t\t\t\t  crypto_req_done, &data[i].wait);\n\t}\n\n\tpr_info(\"testing speed of multibuffer %s (%s) %s\\n\", algo,\n\t\tget_driver_name(crypto_aead, tfm), e);\n\n\ti = 0;\n\tdo {\n\t\tb_size = aead_sizes;\n\t\tdo {\n\t\t\tint bs = round_up(*b_size, crypto_aead_blocksize(tfm));\n\n\t\t\tif (bs + authsize > XBUFSIZE * PAGE_SIZE) {\n\t\t\t\tpr_err(\"template (%u) too big for buffer (%lu)\\n\",\n\t\t\t\t       authsize + bs,\n\t\t\t\t       XBUFSIZE * PAGE_SIZE);\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tpr_info(\"test %u (%d bit key, %d byte blocks): \", i,\n\t\t\t\t*keysize * 8, bs);\n\n\t\t\t \n\n\t\t\tmemset(tvmem[0], 0xff, PAGE_SIZE);\n\t\t\tkey = tvmem[0];\n\t\t\tfor (j = 0; j < tcount; j++) {\n\t\t\t\tif (template[j].klen == *keysize) {\n\t\t\t\t\tkey = template[j].key;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcrypto_aead_clear_flags(tfm, ~0);\n\n\t\t\tret = crypto_aead_setkey(tfm, key, *keysize);\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"setkey() failed flags=%x\\n\",\n\t\t\t\t       crypto_aead_get_flags(tfm));\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tiv_len = crypto_aead_ivsize(tfm);\n\t\t\tif (iv_len)\n\t\t\t\tmemset(iv, 0xff, iv_len);\n\n\t\t\t \n\n\t\t\tfor (j = 0; j < num_mb; ++j) {\n\t\t\t\tstruct test_mb_aead_data *cur = &data[j];\n\n\t\t\t\tassoc = cur->axbuf[0];\n\t\t\t\tmemset(assoc, 0xff, aad_size);\n\n\t\t\t\tsg_init_aead(cur->sg, cur->xbuf,\n\t\t\t\t\t     bs + (enc ? 0 : authsize),\n\t\t\t\t\t     assoc, aad_size);\n\n\t\t\t\tsg_init_aead(cur->sgout, cur->xoutbuf,\n\t\t\t\t\t     bs + (enc ? authsize : 0),\n\t\t\t\t\t     assoc, aad_size);\n\n\t\t\t\taead_request_set_ad(cur->req, aad_size);\n\n\t\t\t\tif (!enc) {\n\n\t\t\t\t\taead_request_set_crypt(cur->req,\n\t\t\t\t\t\t\t       cur->sgout,\n\t\t\t\t\t\t\t       cur->sg,\n\t\t\t\t\t\t\t       bs, iv);\n\t\t\t\t\tret = crypto_aead_encrypt(cur->req);\n\t\t\t\t\tret = do_one_aead_op(cur->req, ret);\n\n\t\t\t\t\tif (ret) {\n\t\t\t\t\t\tpr_err(\"calculating auth failed (%d)\\n\",\n\t\t\t\t\t\t       ret);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\taead_request_set_crypt(cur->req, cur->sg,\n\t\t\t\t\t\t       cur->sgout, bs +\n\t\t\t\t\t\t       (enc ? 0 : authsize),\n\t\t\t\t\t\t       iv);\n\n\t\t\t}\n\n\t\t\tif (secs) {\n\t\t\t\tret = test_mb_aead_jiffies(data, enc, bs,\n\t\t\t\t\t\t\t   secs, num_mb);\n\t\t\t\tcond_resched();\n\t\t\t} else {\n\t\t\t\tret = test_mb_aead_cycles(data, enc, bs,\n\t\t\t\t\t\t\t  num_mb);\n\t\t\t}\n\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"%s() failed return code=%d\\n\", e, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tb_size++;\n\t\t\ti++;\n\t\t} while (*b_size);\n\t\tkeysize++;\n\t} while (*keysize);\n\nout:\n\tfor (i = 0; i < num_mb; ++i)\n\t\taead_request_free(data[i].req);\nout_free_xoutbuf:\n\tfor (i = 0; i < num_mb; ++i)\n\t\ttestmgr_free_buf(data[i].xoutbuf);\nout_free_axbuf:\n\tfor (i = 0; i < num_mb; ++i)\n\t\ttestmgr_free_buf(data[i].axbuf);\nout_free_xbuf:\n\tfor (i = 0; i < num_mb; ++i)\n\t\ttestmgr_free_buf(data[i].xbuf);\nout_free_tfm:\n\tcrypto_free_aead(tfm);\nout_free_data:\n\tkfree(data);\nout_free_iv:\n\tkfree(iv);\n}\n\nstatic int test_aead_jiffies(struct aead_request *req, int enc,\n\t\t\t\tint blen, int secs)\n{\n\tunsigned long start, end;\n\tint bcount;\n\tint ret;\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tif (enc)\n\t\t\tret = do_one_aead_op(req, crypto_aead_encrypt(req));\n\t\telse\n\t\t\tret = do_one_aead_op(req, crypto_aead_decrypt(req));\n\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tpr_cont(\"%d operations in %d seconds (%llu bytes)\\n\",\n\t        bcount, secs, (u64)bcount * blen);\n\treturn 0;\n}\n\nstatic int test_aead_cycles(struct aead_request *req, int enc, int blen)\n{\n\tunsigned long cycles = 0;\n\tint ret = 0;\n\tint i;\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tif (enc)\n\t\t\tret = do_one_aead_op(req, crypto_aead_encrypt(req));\n\t\telse\n\t\t\tret = do_one_aead_op(req, crypto_aead_decrypt(req));\n\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\t\tif (enc)\n\t\t\tret = do_one_aead_op(req, crypto_aead_encrypt(req));\n\t\telse\n\t\t\tret = do_one_aead_op(req, crypto_aead_decrypt(req));\n\t\tend = get_cycles();\n\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tcycles += end - start;\n\t}\n\nout:\n\tif (ret == 0)\n\t\tpr_cont(\"1 operation in %lu cycles (%d bytes)\\n\",\n\t\t\t(cycles + 4) / 8, blen);\n\n\treturn ret;\n}\n\nstatic void test_aead_speed(const char *algo, int enc, unsigned int secs,\n\t\t\t    struct aead_speed_template *template,\n\t\t\t    unsigned int tcount, u8 authsize,\n\t\t\t    unsigned int aad_size, u8 *keysize)\n{\n\tunsigned int i, j;\n\tstruct crypto_aead *tfm;\n\tint ret = -ENOMEM;\n\tconst char *key;\n\tstruct aead_request *req;\n\tstruct scatterlist *sg;\n\tstruct scatterlist *sgout;\n\tconst char *e;\n\tvoid *assoc;\n\tchar *iv;\n\tchar *xbuf[XBUFSIZE];\n\tchar *xoutbuf[XBUFSIZE];\n\tchar *axbuf[XBUFSIZE];\n\tconst int *b_size;\n\tunsigned int iv_len;\n\tstruct crypto_wait wait;\n\n\tiv = kzalloc(MAX_IVLEN, GFP_KERNEL);\n\tif (!iv)\n\t\treturn;\n\n\tif (aad_size >= PAGE_SIZE) {\n\t\tpr_err(\"associate data length (%u) too big\\n\", aad_size);\n\t\tgoto out_noxbuf;\n\t}\n\n\tif (enc == ENCRYPT)\n\t\te = \"encryption\";\n\telse\n\t\te = \"decryption\";\n\n\tif (testmgr_alloc_buf(xbuf))\n\t\tgoto out_noxbuf;\n\tif (testmgr_alloc_buf(axbuf))\n\t\tgoto out_noaxbuf;\n\tif (testmgr_alloc_buf(xoutbuf))\n\t\tgoto out_nooutbuf;\n\n\tsg = kmalloc(sizeof(*sg) * 9 * 2, GFP_KERNEL);\n\tif (!sg)\n\t\tgoto out_nosg;\n\tsgout = &sg[9];\n\n\ttfm = crypto_alloc_aead(algo, 0, 0);\n\tif (IS_ERR(tfm)) {\n\t\tpr_err(\"alg: aead: Failed to load transform for %s: %ld\\n\", algo,\n\t\t       PTR_ERR(tfm));\n\t\tgoto out_notfm;\n\t}\n\n\tret = crypto_aead_setauthsize(tfm, authsize);\n\tif (ret) {\n\t\tpr_err(\"alg: aead: Failed to setauthsize for %s: %d\\n\", algo,\n\t\t       ret);\n\t\tgoto out_noreq;\n\t}\n\n\tcrypto_init_wait(&wait);\n\tpr_info(\"testing speed of %s (%s) %s\\n\", algo,\n\t\tget_driver_name(crypto_aead, tfm), e);\n\n\treq = aead_request_alloc(tfm, GFP_KERNEL);\n\tif (!req) {\n\t\tpr_err(\"alg: aead: Failed to allocate request for %s\\n\",\n\t\t       algo);\n\t\tgoto out_noreq;\n\t}\n\n\taead_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,\n\t\t\t\t  crypto_req_done, &wait);\n\n\ti = 0;\n\tdo {\n\t\tb_size = aead_sizes;\n\t\tdo {\n\t\t\tu32 bs = round_up(*b_size, crypto_aead_blocksize(tfm));\n\n\t\t\tassoc = axbuf[0];\n\t\t\tmemset(assoc, 0xff, aad_size);\n\n\t\t\tif ((*keysize + bs) > TVMEMSIZE * PAGE_SIZE) {\n\t\t\t\tpr_err(\"template (%u) too big for tvmem (%lu)\\n\",\n\t\t\t\t       *keysize + bs,\n\t\t\t\t\tTVMEMSIZE * PAGE_SIZE);\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tkey = tvmem[0];\n\t\t\tfor (j = 0; j < tcount; j++) {\n\t\t\t\tif (template[j].klen == *keysize) {\n\t\t\t\t\tkey = template[j].key;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tret = crypto_aead_setkey(tfm, key, *keysize);\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"setkey() failed flags=%x: %d\\n\",\n\t\t\t\t\tcrypto_aead_get_flags(tfm), ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tiv_len = crypto_aead_ivsize(tfm);\n\t\t\tif (iv_len)\n\t\t\t\tmemset(iv, 0xff, iv_len);\n\n\t\t\tcrypto_aead_clear_flags(tfm, ~0);\n\t\t\tpr_info(\"test %u (%d bit key, %d byte blocks): \",\n\t\t\t\ti, *keysize * 8, bs);\n\n\t\t\tmemset(tvmem[0], 0xff, PAGE_SIZE);\n\n\t\t\tsg_init_aead(sg, xbuf, bs + (enc ? 0 : authsize),\n\t\t\t\t     assoc, aad_size);\n\n\t\t\tsg_init_aead(sgout, xoutbuf,\n\t\t\t\t     bs + (enc ? authsize : 0), assoc,\n\t\t\t\t     aad_size);\n\n\t\t\taead_request_set_ad(req, aad_size);\n\n\t\t\tif (!enc) {\n\n\t\t\t\t \n\t\t\t\taead_request_set_crypt(req, sgout, sg,\n\t\t\t\t\t\t       bs, iv);\n\t\t\t\tret = do_one_aead_op(req,\n\t\t\t\t\t\t     crypto_aead_encrypt(req));\n\n\t\t\t\tif (ret) {\n\t\t\t\t\tpr_err(\"calculating auth failed (%d)\\n\",\n\t\t\t\t\t       ret);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taead_request_set_crypt(req, sg, sgout,\n\t\t\t\t\t       bs + (enc ? 0 : authsize),\n\t\t\t\t\t       iv);\n\n\t\t\tif (secs) {\n\t\t\t\tret = test_aead_jiffies(req, enc, bs,\n\t\t\t\t\t\t\tsecs);\n\t\t\t\tcond_resched();\n\t\t\t} else {\n\t\t\t\tret = test_aead_cycles(req, enc, bs);\n\t\t\t}\n\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"%s() failed return code=%d\\n\", e, ret);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tb_size++;\n\t\t\ti++;\n\t\t} while (*b_size);\n\t\tkeysize++;\n\t} while (*keysize);\n\nout:\n\taead_request_free(req);\nout_noreq:\n\tcrypto_free_aead(tfm);\nout_notfm:\n\tkfree(sg);\nout_nosg:\n\ttestmgr_free_buf(xoutbuf);\nout_nooutbuf:\n\ttestmgr_free_buf(axbuf);\nout_noaxbuf:\n\ttestmgr_free_buf(xbuf);\nout_noxbuf:\n\tkfree(iv);\n}\n\nstatic void test_hash_sg_init(struct scatterlist *sg)\n{\n\tint i;\n\n\tsg_init_table(sg, TVMEMSIZE);\n\tfor (i = 0; i < TVMEMSIZE; i++) {\n\t\tsg_set_buf(sg + i, tvmem[i], PAGE_SIZE);\n\t\tmemset(tvmem[i], 0xff, PAGE_SIZE);\n\t}\n}\n\nstatic inline int do_one_ahash_op(struct ahash_request *req, int ret)\n{\n\tstruct crypto_wait *wait = req->base.data;\n\n\treturn crypto_wait_req(ret, wait);\n}\n\nstatic int test_ahash_jiffies_digest(struct ahash_request *req, int blen,\n\t\t\t\t     char *out, int secs)\n{\n\tunsigned long start, end;\n\tint bcount;\n\tint ret;\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tret = do_one_ahash_op(req, crypto_ahash_digest(req));\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tpr_cont(\"%6u opers/sec, %9lu bytes/sec\\n\",\n\t\tbcount / secs, ((long)bcount * blen) / secs);\n\n\treturn 0;\n}\n\nstatic int test_ahash_jiffies(struct ahash_request *req, int blen,\n\t\t\t      int plen, char *out, int secs)\n{\n\tunsigned long start, end;\n\tint bcount, pcount;\n\tint ret;\n\n\tif (plen == blen)\n\t\treturn test_ahash_jiffies_digest(req, blen, out, secs);\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tret = do_one_ahash_op(req, crypto_ahash_init(req));\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tfor (pcount = 0; pcount < blen; pcount += plen) {\n\t\t\tret = do_one_ahash_op(req, crypto_ahash_update(req));\n\t\t\tif (ret)\n\t\t\t\treturn ret;\n\t\t}\n\t\t \n\t\tret = do_one_ahash_op(req, crypto_ahash_final(req));\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tpr_cont(\"%6u opers/sec, %9lu bytes/sec\\n\",\n\t\tbcount / secs, ((long)bcount * blen) / secs);\n\n\treturn 0;\n}\n\nstatic int test_ahash_cycles_digest(struct ahash_request *req, int blen,\n\t\t\t\t    char *out)\n{\n\tunsigned long cycles = 0;\n\tint ret, i;\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tret = do_one_ahash_op(req, crypto_ahash_digest(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\n\t\tret = do_one_ahash_op(req, crypto_ahash_digest(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tend = get_cycles();\n\n\t\tcycles += end - start;\n\t}\n\nout:\n\tif (ret)\n\t\treturn ret;\n\n\tpr_cont(\"%6lu cycles/operation, %4lu cycles/byte\\n\",\n\t\tcycles / 8, cycles / (8 * blen));\n\n\treturn 0;\n}\n\nstatic int test_ahash_cycles(struct ahash_request *req, int blen,\n\t\t\t     int plen, char *out)\n{\n\tunsigned long cycles = 0;\n\tint i, pcount, ret;\n\n\tif (plen == blen)\n\t\treturn test_ahash_cycles_digest(req, blen, out);\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tret = do_one_ahash_op(req, crypto_ahash_init(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tfor (pcount = 0; pcount < blen; pcount += plen) {\n\t\t\tret = do_one_ahash_op(req, crypto_ahash_update(req));\n\t\t\tif (ret)\n\t\t\t\tgoto out;\n\t\t}\n\t\tret = do_one_ahash_op(req, crypto_ahash_final(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\n\t\tret = do_one_ahash_op(req, crypto_ahash_init(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\t\tfor (pcount = 0; pcount < blen; pcount += plen) {\n\t\t\tret = do_one_ahash_op(req, crypto_ahash_update(req));\n\t\t\tif (ret)\n\t\t\t\tgoto out;\n\t\t}\n\t\tret = do_one_ahash_op(req, crypto_ahash_final(req));\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tend = get_cycles();\n\n\t\tcycles += end - start;\n\t}\n\nout:\n\tif (ret)\n\t\treturn ret;\n\n\tpr_cont(\"%6lu cycles/operation, %4lu cycles/byte\\n\",\n\t\tcycles / 8, cycles / (8 * blen));\n\n\treturn 0;\n}\n\nstatic void test_ahash_speed_common(const char *algo, unsigned int secs,\n\t\t\t\t    struct hash_speed *speed, unsigned mask)\n{\n\tstruct scatterlist sg[TVMEMSIZE];\n\tstruct crypto_wait wait;\n\tstruct ahash_request *req;\n\tstruct crypto_ahash *tfm;\n\tchar *output;\n\tint i, ret;\n\n\ttfm = crypto_alloc_ahash(algo, 0, mask);\n\tif (IS_ERR(tfm)) {\n\t\tpr_err(\"failed to load transform for %s: %ld\\n\",\n\t\t       algo, PTR_ERR(tfm));\n\t\treturn;\n\t}\n\n\tpr_info(\"testing speed of async %s (%s)\\n\", algo,\n\t\tget_driver_name(crypto_ahash, tfm));\n\n\tif (crypto_ahash_digestsize(tfm) > MAX_DIGEST_SIZE) {\n\t\tpr_err(\"digestsize(%u) > %d\\n\", crypto_ahash_digestsize(tfm),\n\t\t       MAX_DIGEST_SIZE);\n\t\tgoto out;\n\t}\n\n\ttest_hash_sg_init(sg);\n\treq = ahash_request_alloc(tfm, GFP_KERNEL);\n\tif (!req) {\n\t\tpr_err(\"ahash request allocation failure\\n\");\n\t\tgoto out;\n\t}\n\n\tcrypto_init_wait(&wait);\n\tahash_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,\n\t\t\t\t   crypto_req_done, &wait);\n\n\toutput = kmalloc(MAX_DIGEST_SIZE, GFP_KERNEL);\n\tif (!output)\n\t\tgoto out_nomem;\n\n\tfor (i = 0; speed[i].blen != 0; i++) {\n\t\tif (speed[i].blen > TVMEMSIZE * PAGE_SIZE) {\n\t\t\tpr_err(\"template (%u) too big for tvmem (%lu)\\n\",\n\t\t\t       speed[i].blen, TVMEMSIZE * PAGE_SIZE);\n\t\t\tbreak;\n\t\t}\n\n\t\tif (klen)\n\t\t\tcrypto_ahash_setkey(tfm, tvmem[0], klen);\n\n\t\tpr_info(\"test%3u \"\n\t\t\t\"(%5u byte blocks,%5u bytes per update,%4u updates): \",\n\t\t\ti, speed[i].blen, speed[i].plen, speed[i].blen / speed[i].plen);\n\n\t\tahash_request_set_crypt(req, sg, output, speed[i].plen);\n\n\t\tif (secs) {\n\t\t\tret = test_ahash_jiffies(req, speed[i].blen,\n\t\t\t\t\t\t speed[i].plen, output, secs);\n\t\t\tcond_resched();\n\t\t} else {\n\t\t\tret = test_ahash_cycles(req, speed[i].blen,\n\t\t\t\t\t\tspeed[i].plen, output);\n\t\t}\n\n\t\tif (ret) {\n\t\t\tpr_err(\"hashing failed ret=%d\\n\", ret);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tkfree(output);\n\nout_nomem:\n\tahash_request_free(req);\n\nout:\n\tcrypto_free_ahash(tfm);\n}\n\nstatic void test_ahash_speed(const char *algo, unsigned int secs,\n\t\t\t     struct hash_speed *speed)\n{\n\treturn test_ahash_speed_common(algo, secs, speed, 0);\n}\n\nstatic void test_hash_speed(const char *algo, unsigned int secs,\n\t\t\t    struct hash_speed *speed)\n{\n\treturn test_ahash_speed_common(algo, secs, speed, CRYPTO_ALG_ASYNC);\n}\n\nstruct test_mb_skcipher_data {\n\tstruct scatterlist sg[XBUFSIZE];\n\tstruct skcipher_request *req;\n\tstruct crypto_wait wait;\n\tchar *xbuf[XBUFSIZE];\n};\n\nstatic int do_mult_acipher_op(struct test_mb_skcipher_data *data, int enc,\n\t\t\t\tu32 num_mb, int *rc)\n{\n\tint i, err = 0;\n\n\t \n\tfor (i = 0; i < num_mb; i++) {\n\t\tif (enc == ENCRYPT)\n\t\t\trc[i] = crypto_skcipher_encrypt(data[i].req);\n\t\telse\n\t\t\trc[i] = crypto_skcipher_decrypt(data[i].req);\n\t}\n\n\t \n\tfor (i = 0; i < num_mb; i++) {\n\t\trc[i] = crypto_wait_req(rc[i], &data[i].wait);\n\n\t\tif (rc[i]) {\n\t\t\tpr_info(\"concurrent request %d error %d\\n\", i, rc[i]);\n\t\t\terr = rc[i];\n\t\t}\n\t}\n\n\treturn err;\n}\n\nstatic int test_mb_acipher_jiffies(struct test_mb_skcipher_data *data, int enc,\n\t\t\t\tint blen, int secs, u32 num_mb)\n{\n\tunsigned long start, end;\n\tint bcount;\n\tint ret = 0;\n\tint *rc;\n\n\trc = kcalloc(num_mb, sizeof(*rc), GFP_KERNEL);\n\tif (!rc)\n\t\treturn -ENOMEM;\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tret = do_mult_acipher_op(data, enc, num_mb, rc);\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\tpr_cont(\"%d operations in %d seconds (%llu bytes)\\n\",\n\t\tbcount * num_mb, secs, (u64)bcount * blen * num_mb);\n\nout:\n\tkfree(rc);\n\treturn ret;\n}\n\nstatic int test_mb_acipher_cycles(struct test_mb_skcipher_data *data, int enc,\n\t\t\t       int blen, u32 num_mb)\n{\n\tunsigned long cycles = 0;\n\tint ret = 0;\n\tint i;\n\tint *rc;\n\n\trc = kcalloc(num_mb, sizeof(*rc), GFP_KERNEL);\n\tif (!rc)\n\t\treturn -ENOMEM;\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tret = do_mult_acipher_op(data, enc, num_mb, rc);\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\t\tret = do_mult_acipher_op(data, enc, num_mb, rc);\n\t\tend = get_cycles();\n\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tcycles += end - start;\n\t}\n\n\tpr_cont(\"1 operation in %lu cycles (%d bytes)\\n\",\n\t\t(cycles + 4) / (8 * num_mb), blen);\n\nout:\n\tkfree(rc);\n\treturn ret;\n}\n\nstatic void test_mb_skcipher_speed(const char *algo, int enc, int secs,\n\t\t\t\t   struct cipher_speed_template *template,\n\t\t\t\t   unsigned int tcount, u8 *keysize, u32 num_mb)\n{\n\tstruct test_mb_skcipher_data *data;\n\tstruct crypto_skcipher *tfm;\n\tunsigned int i, j, iv_len;\n\tconst int *b_size;\n\tconst char *key;\n\tconst char *e;\n\tchar iv[128];\n\tint ret;\n\n\tif (enc == ENCRYPT)\n\t\te = \"encryption\";\n\telse\n\t\te = \"decryption\";\n\n\tdata = kcalloc(num_mb, sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\treturn;\n\n\ttfm = crypto_alloc_skcipher(algo, 0, 0);\n\tif (IS_ERR(tfm)) {\n\t\tpr_err(\"failed to load transform for %s: %ld\\n\",\n\t\t\talgo, PTR_ERR(tfm));\n\t\tgoto out_free_data;\n\t}\n\n\tfor (i = 0; i < num_mb; ++i)\n\t\tif (testmgr_alloc_buf(data[i].xbuf)) {\n\t\t\twhile (i--)\n\t\t\t\ttestmgr_free_buf(data[i].xbuf);\n\t\t\tgoto out_free_tfm;\n\t\t}\n\n\tfor (i = 0; i < num_mb; ++i) {\n\t\tdata[i].req = skcipher_request_alloc(tfm, GFP_KERNEL);\n\t\tif (!data[i].req) {\n\t\t\tpr_err(\"alg: skcipher: Failed to allocate request for %s\\n\",\n\t\t\t       algo);\n\t\t\twhile (i--)\n\t\t\t\tskcipher_request_free(data[i].req);\n\t\t\tgoto out_free_xbuf;\n\t\t}\n\t}\n\n\tfor (i = 0; i < num_mb; ++i) {\n\t\tskcipher_request_set_callback(data[i].req,\n\t\t\t\t\t      CRYPTO_TFM_REQ_MAY_BACKLOG,\n\t\t\t\t\t      crypto_req_done, &data[i].wait);\n\t\tcrypto_init_wait(&data[i].wait);\n\t}\n\n\tpr_info(\"testing speed of multibuffer %s (%s) %s\\n\", algo,\n\t\tget_driver_name(crypto_skcipher, tfm), e);\n\n\ti = 0;\n\tdo {\n\t\tb_size = block_sizes;\n\t\tdo {\n\t\t\tu32 bs = round_up(*b_size, crypto_skcipher_blocksize(tfm));\n\n\t\t\tif (bs > XBUFSIZE * PAGE_SIZE) {\n\t\t\t\tpr_err(\"template (%u) too big for buffer (%lu)\\n\",\n\t\t\t\t       bs, XBUFSIZE * PAGE_SIZE);\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tpr_info(\"test %u (%d bit key, %d byte blocks): \", i,\n\t\t\t\t*keysize * 8, bs);\n\n\t\t\t \n\n\t\t\tmemset(tvmem[0], 0xff, PAGE_SIZE);\n\t\t\tkey = tvmem[0];\n\t\t\tfor (j = 0; j < tcount; j++) {\n\t\t\t\tif (template[j].klen == *keysize) {\n\t\t\t\t\tkey = template[j].key;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcrypto_skcipher_clear_flags(tfm, ~0);\n\n\t\t\tret = crypto_skcipher_setkey(tfm, key, *keysize);\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"setkey() failed flags=%x\\n\",\n\t\t\t\t       crypto_skcipher_get_flags(tfm));\n\t\t\t\tgoto out;\n\t\t\t}\n\n\t\t\tiv_len = crypto_skcipher_ivsize(tfm);\n\t\t\tif (iv_len)\n\t\t\t\tmemset(&iv, 0xff, iv_len);\n\n\t\t\t \n\n\t\t\tfor (j = 0; j < num_mb; ++j) {\n\t\t\t\tstruct test_mb_skcipher_data *cur = &data[j];\n\t\t\t\tunsigned int k = bs;\n\t\t\t\tunsigned int pages = DIV_ROUND_UP(k, PAGE_SIZE);\n\t\t\t\tunsigned int p = 0;\n\n\t\t\t\tsg_init_table(cur->sg, pages);\n\n\t\t\t\twhile (k > PAGE_SIZE) {\n\t\t\t\t\tsg_set_buf(cur->sg + p, cur->xbuf[p],\n\t\t\t\t\t\t   PAGE_SIZE);\n\t\t\t\t\tmemset(cur->xbuf[p], 0xff, PAGE_SIZE);\n\t\t\t\t\tp++;\n\t\t\t\t\tk -= PAGE_SIZE;\n\t\t\t\t}\n\n\t\t\t\tsg_set_buf(cur->sg + p, cur->xbuf[p], k);\n\t\t\t\tmemset(cur->xbuf[p], 0xff, k);\n\n\t\t\t\tskcipher_request_set_crypt(cur->req, cur->sg,\n\t\t\t\t\t\t\t   cur->sg, bs, iv);\n\t\t\t}\n\n\t\t\tif (secs) {\n\t\t\t\tret = test_mb_acipher_jiffies(data, enc,\n\t\t\t\t\t\t\t      bs, secs,\n\t\t\t\t\t\t\t      num_mb);\n\t\t\t\tcond_resched();\n\t\t\t} else {\n\t\t\t\tret = test_mb_acipher_cycles(data, enc,\n\t\t\t\t\t\t\t     bs, num_mb);\n\t\t\t}\n\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"%s() failed flags=%x\\n\", e,\n\t\t\t\t       crypto_skcipher_get_flags(tfm));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tb_size++;\n\t\t\ti++;\n\t\t} while (*b_size);\n\t\tkeysize++;\n\t} while (*keysize);\n\nout:\n\tfor (i = 0; i < num_mb; ++i)\n\t\tskcipher_request_free(data[i].req);\nout_free_xbuf:\n\tfor (i = 0; i < num_mb; ++i)\n\t\ttestmgr_free_buf(data[i].xbuf);\nout_free_tfm:\n\tcrypto_free_skcipher(tfm);\nout_free_data:\n\tkfree(data);\n}\n\nstatic inline int do_one_acipher_op(struct skcipher_request *req, int ret)\n{\n\tstruct crypto_wait *wait = req->base.data;\n\n\treturn crypto_wait_req(ret, wait);\n}\n\nstatic int test_acipher_jiffies(struct skcipher_request *req, int enc,\n\t\t\t\tint blen, int secs)\n{\n\tunsigned long start, end;\n\tint bcount;\n\tint ret;\n\n\tfor (start = jiffies, end = start + secs * HZ, bcount = 0;\n\t     time_before(jiffies, end); bcount++) {\n\t\tif (enc)\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_encrypt(req));\n\t\telse\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_decrypt(req));\n\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tpr_cont(\"%d operations in %d seconds (%llu bytes)\\n\",\n\t\tbcount, secs, (u64)bcount * blen);\n\treturn 0;\n}\n\nstatic int test_acipher_cycles(struct skcipher_request *req, int enc,\n\t\t\t       int blen)\n{\n\tunsigned long cycles = 0;\n\tint ret = 0;\n\tint i;\n\n\t \n\tfor (i = 0; i < 4; i++) {\n\t\tif (enc)\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_encrypt(req));\n\t\telse\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_decrypt(req));\n\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tcycles_t start, end;\n\n\t\tstart = get_cycles();\n\t\tif (enc)\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_encrypt(req));\n\t\telse\n\t\t\tret = do_one_acipher_op(req,\n\t\t\t\t\t\tcrypto_skcipher_decrypt(req));\n\t\tend = get_cycles();\n\n\t\tif (ret)\n\t\t\tgoto out;\n\n\t\tcycles += end - start;\n\t}\n\nout:\n\tif (ret == 0)\n\t\tpr_cont(\"1 operation in %lu cycles (%d bytes)\\n\",\n\t\t\t(cycles + 4) / 8, blen);\n\n\treturn ret;\n}\n\nstatic void test_skcipher_speed(const char *algo, int enc, unsigned int secs,\n\t\t\t\tstruct cipher_speed_template *template,\n\t\t\t\tunsigned int tcount, u8 *keysize, bool async)\n{\n\tunsigned int ret, i, j, k, iv_len;\n\tstruct crypto_wait wait;\n\tconst char *key;\n\tchar iv[128];\n\tstruct skcipher_request *req;\n\tstruct crypto_skcipher *tfm;\n\tconst int *b_size;\n\tconst char *e;\n\n\tif (enc == ENCRYPT)\n\t\te = \"encryption\";\n\telse\n\t\te = \"decryption\";\n\n\tcrypto_init_wait(&wait);\n\n\ttfm = crypto_alloc_skcipher(algo, 0, async ? 0 : CRYPTO_ALG_ASYNC);\n\n\tif (IS_ERR(tfm)) {\n\t\tpr_err(\"failed to load transform for %s: %ld\\n\", algo,\n\t\t       PTR_ERR(tfm));\n\t\treturn;\n\t}\n\n\tpr_info(\"testing speed of %s %s (%s) %s\\n\", async ? \"async\" : \"sync\",\n\t\talgo, get_driver_name(crypto_skcipher, tfm), e);\n\n\treq = skcipher_request_alloc(tfm, GFP_KERNEL);\n\tif (!req) {\n\t\tpr_err(\"skcipher: Failed to allocate request for %s\\n\", algo);\n\t\tgoto out;\n\t}\n\n\tskcipher_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,\n\t\t\t\t      crypto_req_done, &wait);\n\n\ti = 0;\n\tdo {\n\t\tb_size = block_sizes;\n\n\t\tdo {\n\t\t\tu32 bs = round_up(*b_size, crypto_skcipher_blocksize(tfm));\n\t\t\tstruct scatterlist sg[TVMEMSIZE];\n\n\t\t\tif ((*keysize + bs) > TVMEMSIZE * PAGE_SIZE) {\n\t\t\t\tpr_err(\"template (%u) too big for \"\n\t\t\t\t       \"tvmem (%lu)\\n\", *keysize + bs,\n\t\t\t\t       TVMEMSIZE * PAGE_SIZE);\n\t\t\t\tgoto out_free_req;\n\t\t\t}\n\n\t\t\tpr_info(\"test %u (%d bit key, %d byte blocks): \", i,\n\t\t\t\t*keysize * 8, bs);\n\n\t\t\tmemset(tvmem[0], 0xff, PAGE_SIZE);\n\n\t\t\t \n\t\t\tkey = tvmem[0];\n\t\t\tfor (j = 0; j < tcount; j++) {\n\t\t\t\tif (template[j].klen == *keysize) {\n\t\t\t\t\tkey = template[j].key;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcrypto_skcipher_clear_flags(tfm, ~0);\n\n\t\t\tret = crypto_skcipher_setkey(tfm, key, *keysize);\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"setkey() failed flags=%x\\n\",\n\t\t\t\t\tcrypto_skcipher_get_flags(tfm));\n\t\t\t\tgoto out_free_req;\n\t\t\t}\n\n\t\t\tk = *keysize + bs;\n\t\t\tsg_init_table(sg, DIV_ROUND_UP(k, PAGE_SIZE));\n\n\t\t\tif (k > PAGE_SIZE) {\n\t\t\t\tsg_set_buf(sg, tvmem[0] + *keysize,\n\t\t\t\t   PAGE_SIZE - *keysize);\n\t\t\t\tk -= PAGE_SIZE;\n\t\t\t\tj = 1;\n\t\t\t\twhile (k > PAGE_SIZE) {\n\t\t\t\t\tsg_set_buf(sg + j, tvmem[j], PAGE_SIZE);\n\t\t\t\t\tmemset(tvmem[j], 0xff, PAGE_SIZE);\n\t\t\t\t\tj++;\n\t\t\t\t\tk -= PAGE_SIZE;\n\t\t\t\t}\n\t\t\t\tsg_set_buf(sg + j, tvmem[j], k);\n\t\t\t\tmemset(tvmem[j], 0xff, k);\n\t\t\t} else {\n\t\t\t\tsg_set_buf(sg, tvmem[0] + *keysize, bs);\n\t\t\t}\n\n\t\t\tiv_len = crypto_skcipher_ivsize(tfm);\n\t\t\tif (iv_len)\n\t\t\t\tmemset(&iv, 0xff, iv_len);\n\n\t\t\tskcipher_request_set_crypt(req, sg, sg, bs, iv);\n\n\t\t\tif (secs) {\n\t\t\t\tret = test_acipher_jiffies(req, enc,\n\t\t\t\t\t\t\t   bs, secs);\n\t\t\t\tcond_resched();\n\t\t\t} else {\n\t\t\t\tret = test_acipher_cycles(req, enc,\n\t\t\t\t\t\t\t  bs);\n\t\t\t}\n\n\t\t\tif (ret) {\n\t\t\t\tpr_err(\"%s() failed flags=%x\\n\", e,\n\t\t\t\t       crypto_skcipher_get_flags(tfm));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tb_size++;\n\t\t\ti++;\n\t\t} while (*b_size);\n\t\tkeysize++;\n\t} while (*keysize);\n\nout_free_req:\n\tskcipher_request_free(req);\nout:\n\tcrypto_free_skcipher(tfm);\n}\n\nstatic void test_acipher_speed(const char *algo, int enc, unsigned int secs,\n\t\t\t       struct cipher_speed_template *template,\n\t\t\t       unsigned int tcount, u8 *keysize)\n{\n\treturn test_skcipher_speed(algo, enc, secs, template, tcount, keysize,\n\t\t\t\t   true);\n}\n\nstatic void test_cipher_speed(const char *algo, int enc, unsigned int secs,\n\t\t\t      struct cipher_speed_template *template,\n\t\t\t      unsigned int tcount, u8 *keysize)\n{\n\treturn test_skcipher_speed(algo, enc, secs, template, tcount, keysize,\n\t\t\t\t   false);\n}\n\nstatic inline int tcrypt_test(const char *alg)\n{\n\tint ret;\n\n\tpr_debug(\"testing %s\\n\", alg);\n\n\tret = alg_test(alg, alg, 0, 0);\n\t \n\tif (fips_enabled && (ret == -EINVAL || ret == -ECANCELED))\n\t\tret = 0;\n\treturn ret;\n}\n\nstatic int do_test(const char *alg, u32 type, u32 mask, int m, u32 num_mb)\n{\n\tint i;\n\tint ret = 0;\n\n\tswitch (m) {\n\tcase 0:\n\t\tif (alg) {\n\t\t\tif (!crypto_has_alg(alg, type,\n\t\t\t\t\t    mask ?: CRYPTO_ALG_TYPE_MASK))\n\t\t\t\tret = -ENOENT;\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 1; i < 200; i++)\n\t\t\tret = min(ret, do_test(NULL, 0, 0, i, num_mb));\n\t\tbreak;\n\n\tcase 1:\n\t\tret = min(ret, tcrypt_test(\"md5\"));\n\t\tbreak;\n\n\tcase 2:\n\t\tret = min(ret, tcrypt_test(\"sha1\"));\n\t\tbreak;\n\n\tcase 3:\n\t\tret = min(ret, tcrypt_test(\"ecb(des)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(des)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(des)\"));\n\t\tbreak;\n\n\tcase 4:\n\t\tret = min(ret, tcrypt_test(\"ecb(des3_ede)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(des3_ede)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(des3_ede)\"));\n\t\tbreak;\n\n\tcase 5:\n\t\tret = min(ret, tcrypt_test(\"md4\"));\n\t\tbreak;\n\n\tcase 6:\n\t\tret = min(ret, tcrypt_test(\"sha256\"));\n\t\tbreak;\n\n\tcase 7:\n\t\tret = min(ret, tcrypt_test(\"ecb(blowfish)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(blowfish)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(blowfish)\"));\n\t\tbreak;\n\n\tcase 8:\n\t\tret = min(ret, tcrypt_test(\"ecb(twofish)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(twofish)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(twofish)\"));\n\t\tret = min(ret, tcrypt_test(\"lrw(twofish)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(twofish)\"));\n\t\tbreak;\n\n\tcase 9:\n\t\tret = min(ret, tcrypt_test(\"ecb(serpent)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(serpent)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(serpent)\"));\n\t\tret = min(ret, tcrypt_test(\"lrw(serpent)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(serpent)\"));\n\t\tbreak;\n\n\tcase 10:\n\t\tret = min(ret, tcrypt_test(\"ecb(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"lrw(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"rfc3686(ctr(aes))\"));\n\t\tret = min(ret, tcrypt_test(\"ofb(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"cfb(aes)\"));\n\t\tret = min(ret, tcrypt_test(\"xctr(aes)\"));\n\t\tbreak;\n\n\tcase 11:\n\t\tret = min(ret, tcrypt_test(\"sha384\"));\n\t\tbreak;\n\n\tcase 12:\n\t\tret = min(ret, tcrypt_test(\"sha512\"));\n\t\tbreak;\n\n\tcase 13:\n\t\tret = min(ret, tcrypt_test(\"deflate\"));\n\t\tbreak;\n\n\tcase 14:\n\t\tret = min(ret, tcrypt_test(\"ecb(cast5)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(cast5)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(cast5)\"));\n\t\tbreak;\n\n\tcase 15:\n\t\tret = min(ret, tcrypt_test(\"ecb(cast6)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(cast6)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(cast6)\"));\n\t\tret = min(ret, tcrypt_test(\"lrw(cast6)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(cast6)\"));\n\t\tbreak;\n\n\tcase 16:\n\t\tret = min(ret, tcrypt_test(\"ecb(arc4)\"));\n\t\tbreak;\n\n\tcase 17:\n\t\tret = min(ret, tcrypt_test(\"michael_mic\"));\n\t\tbreak;\n\n\tcase 18:\n\t\tret = min(ret, tcrypt_test(\"crc32c\"));\n\t\tbreak;\n\n\tcase 19:\n\t\tret = min(ret, tcrypt_test(\"ecb(tea)\"));\n\t\tbreak;\n\n\tcase 20:\n\t\tret = min(ret, tcrypt_test(\"ecb(xtea)\"));\n\t\tbreak;\n\n\tcase 21:\n\t\tret = min(ret, tcrypt_test(\"ecb(khazad)\"));\n\t\tbreak;\n\n\tcase 22:\n\t\tret = min(ret, tcrypt_test(\"wp512\"));\n\t\tbreak;\n\n\tcase 23:\n\t\tret = min(ret, tcrypt_test(\"wp384\"));\n\t\tbreak;\n\n\tcase 24:\n\t\tret = min(ret, tcrypt_test(\"wp256\"));\n\t\tbreak;\n\n\tcase 26:\n\t\tret = min(ret, tcrypt_test(\"ecb(anubis)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(anubis)\"));\n\t\tbreak;\n\n\tcase 30:\n\t\tret = min(ret, tcrypt_test(\"ecb(xeta)\"));\n\t\tbreak;\n\n\tcase 31:\n\t\tret = min(ret, tcrypt_test(\"pcbc(fcrypt)\"));\n\t\tbreak;\n\n\tcase 32:\n\t\tret = min(ret, tcrypt_test(\"ecb(camellia)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(camellia)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(camellia)\"));\n\t\tret = min(ret, tcrypt_test(\"lrw(camellia)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(camellia)\"));\n\t\tbreak;\n\n\tcase 33:\n\t\tret = min(ret, tcrypt_test(\"sha224\"));\n\t\tbreak;\n\n\tcase 35:\n\t\tret = min(ret, tcrypt_test(\"gcm(aes)\"));\n\t\tbreak;\n\n\tcase 36:\n\t\tret = min(ret, tcrypt_test(\"lzo\"));\n\t\tbreak;\n\n\tcase 37:\n\t\tret = min(ret, tcrypt_test(\"ccm(aes)\"));\n\t\tbreak;\n\n\tcase 38:\n\t\tret = min(ret, tcrypt_test(\"cts(cbc(aes))\"));\n\t\tbreak;\n\n        case 39:\n\t\tret = min(ret, tcrypt_test(\"xxhash64\"));\n\t\tbreak;\n\n        case 40:\n\t\tret = min(ret, tcrypt_test(\"rmd160\"));\n\t\tbreak;\n\n\tcase 42:\n\t\tret = min(ret, tcrypt_test(\"blake2b-512\"));\n\t\tbreak;\n\n\tcase 43:\n\t\tret = min(ret, tcrypt_test(\"ecb(seed)\"));\n\t\tbreak;\n\n\tcase 45:\n\t\tret = min(ret, tcrypt_test(\"rfc4309(ccm(aes))\"));\n\t\tbreak;\n\n\tcase 46:\n\t\tret = min(ret, tcrypt_test(\"ghash\"));\n\t\tbreak;\n\n\tcase 47:\n\t\tret = min(ret, tcrypt_test(\"crct10dif\"));\n\t\tbreak;\n\n\tcase 48:\n\t\tret = min(ret, tcrypt_test(\"sha3-224\"));\n\t\tbreak;\n\n\tcase 49:\n\t\tret = min(ret, tcrypt_test(\"sha3-256\"));\n\t\tbreak;\n\n\tcase 50:\n\t\tret = min(ret, tcrypt_test(\"sha3-384\"));\n\t\tbreak;\n\n\tcase 51:\n\t\tret = min(ret, tcrypt_test(\"sha3-512\"));\n\t\tbreak;\n\n\tcase 52:\n\t\tret = min(ret, tcrypt_test(\"sm3\"));\n\t\tbreak;\n\n\tcase 53:\n\t\tret = min(ret, tcrypt_test(\"streebog256\"));\n\t\tbreak;\n\n\tcase 54:\n\t\tret = min(ret, tcrypt_test(\"streebog512\"));\n\t\tbreak;\n\n\tcase 55:\n\t\tret = min(ret, tcrypt_test(\"gcm(sm4)\"));\n\t\tbreak;\n\n\tcase 56:\n\t\tret = min(ret, tcrypt_test(\"ccm(sm4)\"));\n\t\tbreak;\n\n\tcase 57:\n\t\tret = min(ret, tcrypt_test(\"polyval\"));\n\t\tbreak;\n\n\tcase 58:\n\t\tret = min(ret, tcrypt_test(\"gcm(aria)\"));\n\t\tbreak;\n\n\tcase 59:\n\t\tret = min(ret, tcrypt_test(\"cts(cbc(sm4))\"));\n\t\tbreak;\n\n\tcase 100:\n\t\tret = min(ret, tcrypt_test(\"hmac(md5)\"));\n\t\tbreak;\n\n\tcase 101:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha1)\"));\n\t\tbreak;\n\n\tcase 102:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha256)\"));\n\t\tbreak;\n\n\tcase 103:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha384)\"));\n\t\tbreak;\n\n\tcase 104:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha512)\"));\n\t\tbreak;\n\n\tcase 105:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha224)\"));\n\t\tbreak;\n\n\tcase 106:\n\t\tret = min(ret, tcrypt_test(\"xcbc(aes)\"));\n\t\tbreak;\n\n\tcase 108:\n\t\tret = min(ret, tcrypt_test(\"hmac(rmd160)\"));\n\t\tbreak;\n\n\tcase 109:\n\t\tret = min(ret, tcrypt_test(\"vmac64(aes)\"));\n\t\tbreak;\n\n\tcase 111:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha3-224)\"));\n\t\tbreak;\n\n\tcase 112:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha3-256)\"));\n\t\tbreak;\n\n\tcase 113:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha3-384)\"));\n\t\tbreak;\n\n\tcase 114:\n\t\tret = min(ret, tcrypt_test(\"hmac(sha3-512)\"));\n\t\tbreak;\n\n\tcase 115:\n\t\tret = min(ret, tcrypt_test(\"hmac(streebog256)\"));\n\t\tbreak;\n\n\tcase 116:\n\t\tret = min(ret, tcrypt_test(\"hmac(streebog512)\"));\n\t\tbreak;\n\n\tcase 150:\n\t\tret = min(ret, tcrypt_test(\"ansi_cprng\"));\n\t\tbreak;\n\n\tcase 151:\n\t\tret = min(ret, tcrypt_test(\"rfc4106(gcm(aes))\"));\n\t\tbreak;\n\n\tcase 152:\n\t\tret = min(ret, tcrypt_test(\"rfc4543(gcm(aes))\"));\n\t\tbreak;\n\n\tcase 153:\n\t\tret = min(ret, tcrypt_test(\"cmac(aes)\"));\n\t\tbreak;\n\n\tcase 154:\n\t\tret = min(ret, tcrypt_test(\"cmac(des3_ede)\"));\n\t\tbreak;\n\n\tcase 155:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha1),cbc(aes))\"));\n\t\tbreak;\n\n\tcase 156:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(md5),ecb(cipher_null))\"));\n\t\tbreak;\n\n\tcase 157:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha1),ecb(cipher_null))\"));\n\t\tbreak;\n\n\tcase 158:\n\t\tret = min(ret, tcrypt_test(\"cbcmac(sm4)\"));\n\t\tbreak;\n\n\tcase 159:\n\t\tret = min(ret, tcrypt_test(\"cmac(sm4)\"));\n\t\tbreak;\n\n\tcase 160:\n\t\tret = min(ret, tcrypt_test(\"xcbc(sm4)\"));\n\t\tbreak;\n\n\tcase 181:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha1),cbc(des))\"));\n\t\tbreak;\n\tcase 182:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha1),cbc(des3_ede))\"));\n\t\tbreak;\n\tcase 183:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha224),cbc(des))\"));\n\t\tbreak;\n\tcase 184:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha224),cbc(des3_ede))\"));\n\t\tbreak;\n\tcase 185:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha256),cbc(des))\"));\n\t\tbreak;\n\tcase 186:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha256),cbc(des3_ede))\"));\n\t\tbreak;\n\tcase 187:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha384),cbc(des))\"));\n\t\tbreak;\n\tcase 188:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha384),cbc(des3_ede))\"));\n\t\tbreak;\n\tcase 189:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha512),cbc(des))\"));\n\t\tbreak;\n\tcase 190:\n\t\tret = min(ret, tcrypt_test(\"authenc(hmac(sha512),cbc(des3_ede))\"));\n\t\tbreak;\n\tcase 191:\n\t\tret = min(ret, tcrypt_test(\"ecb(sm4)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(sm4)\"));\n\t\tret = min(ret, tcrypt_test(\"cfb(sm4)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(sm4)\"));\n\t\tret = min(ret, tcrypt_test(\"xts(sm4)\"));\n\t\tbreak;\n\tcase 192:\n\t\tret = min(ret, tcrypt_test(\"ecb(aria)\"));\n\t\tret = min(ret, tcrypt_test(\"cbc(aria)\"));\n\t\tret = min(ret, tcrypt_test(\"cfb(aria)\"));\n\t\tret = min(ret, tcrypt_test(\"ctr(aria)\"));\n\t\tbreak;\n\tcase 200:\n\t\ttest_cipher_speed(\"ecb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ecb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"lrw(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"lrw(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"xts(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_64);\n\t\ttest_cipher_speed(\"xts(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_64);\n\t\ttest_cipher_speed(\"cts(cbc(aes))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cts(cbc(aes))\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cfb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cfb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\tbreak;\n\n\tcase 201:\n\t\ttest_cipher_speed(\"ecb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\ttest_cipher_speed(\"ecb(des3_ede)\", DECRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\ttest_cipher_speed(\"cbc(des3_ede)\", ENCRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\ttest_cipher_speed(\"cbc(des3_ede)\", DECRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\ttest_cipher_speed(\"ctr(des3_ede)\", ENCRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\ttest_cipher_speed(\"ctr(des3_ede)\", DECRYPT, sec,\n\t\t\t\tdes3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\tspeed_template_24);\n\t\tbreak;\n\n\tcase 202:\n\t\ttest_cipher_speed(\"ecb(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ecb(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"lrw(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"lrw(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"xts(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_48_64);\n\t\ttest_cipher_speed(\"xts(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_48_64);\n\t\tbreak;\n\n\tcase 203:\n\t\ttest_cipher_speed(\"ecb(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\ttest_cipher_speed(\"ecb(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\ttest_cipher_speed(\"cbc(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\ttest_cipher_speed(\"cbc(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\ttest_cipher_speed(\"ctr(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\ttest_cipher_speed(\"ctr(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_32);\n\t\tbreak;\n\n\tcase 204:\n\t\ttest_cipher_speed(\"ecb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8);\n\t\ttest_cipher_speed(\"ecb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8);\n\t\ttest_cipher_speed(\"cbc(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8);\n\t\ttest_cipher_speed(\"cbc(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8);\n\t\tbreak;\n\n\tcase 205:\n\t\ttest_cipher_speed(\"ecb(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ecb(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16_24_32);\n\t\ttest_cipher_speed(\"lrw(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"lrw(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_40_48);\n\t\ttest_cipher_speed(\"xts(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_48_64);\n\t\ttest_cipher_speed(\"xts(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32_48_64);\n\t\tbreak;\n\n\tcase 207:\n\t\ttest_cipher_speed(\"ecb(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ecb(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"cbc(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"cbc(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ctr(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ctr(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"lrw(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_48);\n\t\ttest_cipher_speed(\"lrw(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_48);\n\t\ttest_cipher_speed(\"xts(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_64);\n\t\ttest_cipher_speed(\"xts(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_64);\n\t\tbreak;\n\n\tcase 208:\n\t\ttest_cipher_speed(\"ecb(arc4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8);\n\t\tbreak;\n\n\tcase 209:\n\t\ttest_cipher_speed(\"ecb(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\ttest_cipher_speed(\"ecb(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\ttest_cipher_speed(\"cbc(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\ttest_cipher_speed(\"cbc(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\ttest_cipher_speed(\"ctr(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\ttest_cipher_speed(\"ctr(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_8_16);\n\t\tbreak;\n\n\tcase 210:\n\t\ttest_cipher_speed(\"ecb(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ecb(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"cbc(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"cbc(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ctr(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"ctr(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_32);\n\t\ttest_cipher_speed(\"lrw(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_48);\n\t\ttest_cipher_speed(\"lrw(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_48);\n\t\ttest_cipher_speed(\"xts(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_64);\n\t\ttest_cipher_speed(\"xts(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32_64);\n\t\tbreak;\n\n\tcase 211:\n\t\ttest_aead_speed(\"rfc4106(gcm(aes))\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_20_28_36);\n\t\ttest_aead_speed(\"gcm(aes)\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16_24_32);\n\t\ttest_aead_speed(\"rfc4106(gcm(aes))\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_20_28_36);\n\t\ttest_aead_speed(\"gcm(aes)\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16_24_32);\n\t\tbreak;\n\n\tcase 212:\n\t\ttest_aead_speed(\"rfc4309(ccm(aes))\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_19);\n\t\ttest_aead_speed(\"rfc4309(ccm(aes))\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_19);\n\t\tbreak;\n\n\tcase 213:\n\t\ttest_aead_speed(\"rfc7539esp(chacha20,poly1305)\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, aead_speed_template_36);\n\t\ttest_aead_speed(\"rfc7539esp(chacha20,poly1305)\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, aead_speed_template_36);\n\t\tbreak;\n\n\tcase 214:\n\t\ttest_cipher_speed(\"chacha20\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_32);\n\t\tbreak;\n\n\tcase 215:\n\t\ttest_mb_aead_speed(\"rfc4106(gcm(aes))\", ENCRYPT, sec, NULL,\n\t\t\t\t   0, 16, 16, aead_speed_template_20_28_36, num_mb);\n\t\ttest_mb_aead_speed(\"gcm(aes)\", ENCRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16_24_32, num_mb);\n\t\ttest_mb_aead_speed(\"rfc4106(gcm(aes))\", DECRYPT, sec, NULL,\n\t\t\t\t   0, 16, 16, aead_speed_template_20_28_36, num_mb);\n\t\ttest_mb_aead_speed(\"gcm(aes)\", DECRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16_24_32, num_mb);\n\t\tbreak;\n\n\tcase 216:\n\t\ttest_mb_aead_speed(\"rfc4309(ccm(aes))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   16, 16, aead_speed_template_19, num_mb);\n\t\ttest_mb_aead_speed(\"rfc4309(ccm(aes))\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   16, 16, aead_speed_template_19, num_mb);\n\t\tbreak;\n\n\tcase 217:\n\t\ttest_mb_aead_speed(\"rfc7539esp(chacha20,poly1305)\", ENCRYPT,\n\t\t\t\t   sec, NULL, 0, 16, 8, aead_speed_template_36,\n\t\t\t\t   num_mb);\n\t\ttest_mb_aead_speed(\"rfc7539esp(chacha20,poly1305)\", DECRYPT,\n\t\t\t\t   sec, NULL, 0, 16, 8, aead_speed_template_36,\n\t\t\t\t   num_mb);\n\t\tbreak;\n\n\tcase 218:\n\t\ttest_cipher_speed(\"ecb(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"ecb(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cbc(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cbc(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cts(cbc(sm4))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cts(cbc(sm4))\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cfb(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"cfb(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"ctr(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"ctr(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_cipher_speed(\"xts(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32);\n\t\ttest_cipher_speed(\"xts(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32);\n\t\tbreak;\n\n\tcase 219:\n\t\ttest_cipher_speed(\"adiantum(xchacha12,aes)\", ENCRYPT, sec, NULL,\n\t\t\t\t  0, speed_template_32);\n\t\ttest_cipher_speed(\"adiantum(xchacha12,aes)\", DECRYPT, sec, NULL,\n\t\t\t\t  0, speed_template_32);\n\t\ttest_cipher_speed(\"adiantum(xchacha20,aes)\", ENCRYPT, sec, NULL,\n\t\t\t\t  0, speed_template_32);\n\t\ttest_cipher_speed(\"adiantum(xchacha20,aes)\", DECRYPT, sec, NULL,\n\t\t\t\t  0, speed_template_32);\n\t\tbreak;\n\n\tcase 220:\n\t\ttest_acipher_speed(\"essiv(cbc(aes),sha256)\",\n\t\t\t\t  ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_acipher_speed(\"essiv(cbc(aes),sha256)\",\n\t\t\t\t  DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\tbreak;\n\n\tcase 221:\n\t\ttest_aead_speed(\"aegis128\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16);\n\t\ttest_aead_speed(\"aegis128\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16);\n\t\tbreak;\n\n\tcase 222:\n\t\ttest_aead_speed(\"gcm(sm4)\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16);\n\t\ttest_aead_speed(\"gcm(sm4)\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16);\n\t\tbreak;\n\n\tcase 223:\n\t\ttest_aead_speed(\"rfc4309(ccm(sm4))\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_19);\n\t\ttest_aead_speed(\"rfc4309(ccm(sm4))\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 16, aead_speed_template_19);\n\t\tbreak;\n\n\tcase 224:\n\t\ttest_mb_aead_speed(\"gcm(sm4)\", ENCRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16, num_mb);\n\t\ttest_mb_aead_speed(\"gcm(sm4)\", DECRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16, num_mb);\n\t\tbreak;\n\n\tcase 225:\n\t\ttest_mb_aead_speed(\"rfc4309(ccm(sm4))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   16, 16, aead_speed_template_19, num_mb);\n\t\ttest_mb_aead_speed(\"rfc4309(ccm(sm4))\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   16, 16, aead_speed_template_19, num_mb);\n\t\tbreak;\n\n\tcase 226:\n\t\ttest_cipher_speed(\"hctr2(aes)\", ENCRYPT, sec, NULL,\n\t\t\t\t  0, speed_template_32);\n\t\tbreak;\n\n\tcase 227:\n\t\ttest_cipher_speed(\"ecb(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"ecb(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"cbc(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"cfb(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"cfb(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\ttest_cipher_speed(\"ctr(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t  speed_template_16_24_32);\n\t\tbreak;\n\n\tcase 228:\n\t\ttest_aead_speed(\"gcm(aria)\", ENCRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16_24_32);\n\t\ttest_aead_speed(\"gcm(aria)\", DECRYPT, sec,\n\t\t\t\tNULL, 0, 16, 8, speed_template_16_24_32);\n\t\tbreak;\n\n\tcase 229:\n\t\ttest_mb_aead_speed(\"gcm(aria)\", ENCRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16, num_mb);\n\t\ttest_mb_aead_speed(\"gcm(aria)\", DECRYPT, sec, NULL, 0, 16, 8,\n\t\t\t\t   speed_template_16, num_mb);\n\t\tbreak;\n\n\tcase 300:\n\t\tif (alg) {\n\t\t\ttest_hash_speed(alg, sec, generic_hash_speed_template);\n\t\t\tbreak;\n\t\t}\n\t\tfallthrough;\n\tcase 301:\n\t\ttest_hash_speed(\"md4\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 302:\n\t\ttest_hash_speed(\"md5\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 303:\n\t\ttest_hash_speed(\"sha1\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 304:\n\t\ttest_hash_speed(\"sha256\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 305:\n\t\ttest_hash_speed(\"sha384\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 306:\n\t\ttest_hash_speed(\"sha512\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 307:\n\t\ttest_hash_speed(\"wp256\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 308:\n\t\ttest_hash_speed(\"wp384\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 309:\n\t\ttest_hash_speed(\"wp512\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 313:\n\t\ttest_hash_speed(\"sha224\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 314:\n\t\ttest_hash_speed(\"xxhash64\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 315:\n\t\ttest_hash_speed(\"rmd160\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 317:\n\t\ttest_hash_speed(\"blake2b-512\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 318:\n\t\tklen = 16;\n\t\ttest_hash_speed(\"ghash\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 319:\n\t\ttest_hash_speed(\"crc32c\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 320:\n\t\ttest_hash_speed(\"crct10dif\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 321:\n\t\ttest_hash_speed(\"poly1305\", sec, poly1305_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 322:\n\t\ttest_hash_speed(\"sha3-224\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 323:\n\t\ttest_hash_speed(\"sha3-256\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 324:\n\t\ttest_hash_speed(\"sha3-384\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 325:\n\t\ttest_hash_speed(\"sha3-512\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 326:\n\t\ttest_hash_speed(\"sm3\", sec, generic_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 327:\n\t\ttest_hash_speed(\"streebog256\", sec,\n\t\t\t\tgeneric_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 328:\n\t\ttest_hash_speed(\"streebog512\", sec,\n\t\t\t\tgeneric_hash_speed_template);\n\t\tif (mode > 300 && mode < 400) break;\n\t\tfallthrough;\n\tcase 399:\n\t\tbreak;\n\n\tcase 400:\n\t\tif (alg) {\n\t\t\ttest_ahash_speed(alg, sec, generic_hash_speed_template);\n\t\t\tbreak;\n\t\t}\n\t\tfallthrough;\n\tcase 401:\n\t\ttest_ahash_speed(\"md4\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 402:\n\t\ttest_ahash_speed(\"md5\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 403:\n\t\ttest_ahash_speed(\"sha1\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 404:\n\t\ttest_ahash_speed(\"sha256\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 405:\n\t\ttest_ahash_speed(\"sha384\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 406:\n\t\ttest_ahash_speed(\"sha512\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 407:\n\t\ttest_ahash_speed(\"wp256\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 408:\n\t\ttest_ahash_speed(\"wp384\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 409:\n\t\ttest_ahash_speed(\"wp512\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 413:\n\t\ttest_ahash_speed(\"sha224\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 414:\n\t\ttest_ahash_speed(\"xxhash64\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 415:\n\t\ttest_ahash_speed(\"rmd160\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 417:\n\t\ttest_ahash_speed(\"blake2b-512\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 418:\n\t\ttest_ahash_speed(\"sha3-224\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 419:\n\t\ttest_ahash_speed(\"sha3-256\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 420:\n\t\ttest_ahash_speed(\"sha3-384\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 421:\n\t\ttest_ahash_speed(\"sha3-512\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 422:\n\t\ttest_ahash_speed(\"sm3\", sec, generic_hash_speed_template);\n\t\tif (mode > 400 && mode < 500) break;\n\t\tfallthrough;\n\tcase 499:\n\t\tbreak;\n\n\tcase 500:\n\t\ttest_acipher_speed(\"ecb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ecb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cbc(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cbc(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"lrw(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_40_48);\n\t\ttest_acipher_speed(\"lrw(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_40_48);\n\t\ttest_acipher_speed(\"xts(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\ttest_acipher_speed(\"xts(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\ttest_acipher_speed(\"cts(cbc(aes))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cts(cbc(aes))\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cfb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cfb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ofb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ofb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"rfc3686(ctr(aes))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_20_28_36);\n\t\ttest_acipher_speed(\"rfc3686(ctr(aes))\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_20_28_36);\n\t\tbreak;\n\n\tcase 501:\n\t\ttest_acipher_speed(\"ecb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"ecb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"cbc(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"cbc(des3_ede)\", DECRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"cfb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"cfb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"ofb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\ttest_acipher_speed(\"ofb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t   des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t   speed_template_24);\n\t\tbreak;\n\n\tcase 502:\n\t\ttest_acipher_speed(\"ecb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"ecb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"cbc(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"cbc(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"cfb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"cfb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"ofb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\ttest_acipher_speed(\"ofb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\tbreak;\n\n\tcase 503:\n\t\ttest_acipher_speed(\"ecb(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ecb(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"lrw(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"lrw(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"xts(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\ttest_acipher_speed(\"xts(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\tbreak;\n\n\tcase 504:\n\t\ttest_acipher_speed(\"ecb(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ecb(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cbc(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"cbc(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"lrw(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_40_48);\n\t\ttest_acipher_speed(\"lrw(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_40_48);\n\t\ttest_acipher_speed(\"xts(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48_64);\n\t\ttest_acipher_speed(\"xts(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48_64);\n\t\tbreak;\n\n\tcase 505:\n\t\ttest_acipher_speed(\"ecb(arc4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8);\n\t\tbreak;\n\n\tcase 506:\n\t\ttest_acipher_speed(\"ecb(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\ttest_acipher_speed(\"ecb(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\ttest_acipher_speed(\"cbc(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\ttest_acipher_speed(\"cbc(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\ttest_acipher_speed(\"ctr(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\ttest_acipher_speed(\"ctr(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_16);\n\t\tbreak;\n\n\tcase 507:\n\t\ttest_acipher_speed(\"ecb(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ecb(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"lrw(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"lrw(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"xts(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\ttest_acipher_speed(\"xts(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\tbreak;\n\n\tcase 508:\n\t\ttest_acipher_speed(\"ecb(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ecb(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"cbc(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"ctr(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_32);\n\t\ttest_acipher_speed(\"lrw(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"lrw(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_48);\n\t\ttest_acipher_speed(\"xts(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\ttest_acipher_speed(\"xts(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_32_64);\n\t\tbreak;\n\n\tcase 509:\n\t\ttest_acipher_speed(\"ecb(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\ttest_acipher_speed(\"ecb(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\ttest_acipher_speed(\"cbc(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\ttest_acipher_speed(\"cbc(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\ttest_acipher_speed(\"ctr(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\ttest_acipher_speed(\"ctr(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_8_32);\n\t\tbreak;\n\n\tcase 518:\n\t\ttest_acipher_speed(\"ecb(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"ecb(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"cbc(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"cbc(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"cfb(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"cfb(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"ctr(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"ctr(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_16);\n\t\ttest_acipher_speed(\"xts(sm4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32);\n\t\ttest_acipher_speed(\"xts(sm4)\", DECRYPT, sec, NULL, 0,\n\t\t\t\tspeed_template_32);\n\t\tbreak;\n\n\tcase 519:\n\t\ttest_acipher_speed(\"ecb(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ecb(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\ttest_acipher_speed(\"ctr(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t   speed_template_16_24_32);\n\t\tbreak;\n\n\tcase 600:\n\t\ttest_mb_skcipher_speed(\"ecb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_40_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_40_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"cts(cbc(aes))\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cts(cbc(aes))\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(aes)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(aes)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"rfc3686(ctr(aes))\", ENCRYPT, sec, NULL,\n\t\t\t\t       0, speed_template_20_28_36, num_mb);\n\t\ttest_mb_skcipher_speed(\"rfc3686(ctr(aes))\", DECRYPT, sec, NULL,\n\t\t\t\t       0, speed_template_20_28_36, num_mb);\n\t\tbreak;\n\n\tcase 601:\n\t\ttest_mb_skcipher_speed(\"ecb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(des3_ede)\", DECRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(des3_ede)\", ENCRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(des3_ede)\", DECRYPT, sec,\n\t\t\t\t       des3_speed_template, DES3_SPEED_VECTORS,\n\t\t\t\t       speed_template_24, num_mb);\n\t\tbreak;\n\n\tcase 602:\n\t\ttest_mb_skcipher_speed(\"ecb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"cfb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(des)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\ttest_mb_skcipher_speed(\"ofb(des)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\tbreak;\n\n\tcase 603:\n\t\ttest_mb_skcipher_speed(\"ecb(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(serpent)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(serpent)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\tbreak;\n\n\tcase 604:\n\t\ttest_mb_skcipher_speed(\"ecb(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_24_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_40_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_40_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(twofish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(twofish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48_64, num_mb);\n\t\tbreak;\n\n\tcase 605:\n\t\ttest_mb_skcipher_speed(\"ecb(arc4)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8, num_mb);\n\t\tbreak;\n\n\tcase 606:\n\t\ttest_mb_skcipher_speed(\"ecb(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(cast5)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(cast5)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_16, num_mb);\n\t\tbreak;\n\n\tcase 607:\n\t\ttest_mb_skcipher_speed(\"ecb(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(cast6)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(cast6)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\tbreak;\n\n\tcase 608:\n\t\ttest_mb_skcipher_speed(\"ecb(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"lrw(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_48, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(camellia)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\ttest_mb_skcipher_speed(\"xts(camellia)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_32_64, num_mb);\n\t\tbreak;\n\n\tcase 609:\n\t\ttest_mb_skcipher_speed(\"ecb(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"cbc(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(blowfish)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(blowfish)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_8_32, num_mb);\n\t\tbreak;\n\n\tcase 610:\n\t\ttest_mb_skcipher_speed(\"ecb(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ecb(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(aria)\", ENCRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\ttest_mb_skcipher_speed(\"ctr(aria)\", DECRYPT, sec, NULL, 0,\n\t\t\t\t       speed_template_16_32, num_mb);\n\t\tbreak;\n\n\t}\n\n\treturn ret;\n}\n\nstatic int __init tcrypt_mod_init(void)\n{\n\tint err = -ENOMEM;\n\tint i;\n\n\tfor (i = 0; i < TVMEMSIZE; i++) {\n\t\ttvmem[i] = (void *)__get_free_page(GFP_KERNEL);\n\t\tif (!tvmem[i])\n\t\t\tgoto err_free_tv;\n\t}\n\n\terr = do_test(alg, type, mask, mode, num_mb);\n\n\tif (err) {\n\t\tpr_err(\"one or more tests failed!\\n\");\n\t\tgoto err_free_tv;\n\t} else {\n\t\tpr_debug(\"all tests passed\\n\");\n\t}\n\n\t \n\tif (!fips_enabled)\n\t\terr = -EAGAIN;\n\nerr_free_tv:\n\tfor (i = 0; i < TVMEMSIZE && tvmem[i]; i++)\n\t\tfree_page((unsigned long)tvmem[i]);\n\n\treturn err;\n}\n\n \nstatic void __exit tcrypt_mod_fini(void) { }\n\nlate_initcall(tcrypt_mod_init);\nmodule_exit(tcrypt_mod_fini);\n\nmodule_param(alg, charp, 0);\nmodule_param(type, uint, 0);\nmodule_param(mask, uint, 0);\nmodule_param(mode, int, 0);\nmodule_param(sec, uint, 0);\nMODULE_PARM_DESC(sec, \"Length in seconds of speed tests \"\n\t\t      \"(defaults to zero which uses CPU cycles instead)\");\nmodule_param(num_mb, uint, 0000);\nMODULE_PARM_DESC(num_mb, \"Number of concurrent requests to be used in mb speed tests (defaults to 8)\");\nmodule_param(klen, uint, 0);\nMODULE_PARM_DESC(klen, \"Key length (defaults to 0)\");\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"Quick & dirty crypto testing module\");\nMODULE_AUTHOR(\"James Morris <jmorris@intercode.com.au>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}