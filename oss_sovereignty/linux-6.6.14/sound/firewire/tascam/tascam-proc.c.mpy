{
  "module_name": "tascam-proc.c",
  "hash_id": "9f7b69e0955a001e7b188ab8aa5e1e090e868f6c0ce7aa097f67df8b1272531d",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/tascam/tascam-proc.c",
  "human_readable_source": "\n \n\n#include \"./tascam.h\"\n\nstatic void proc_read_firmware(struct snd_info_entry *entry,\n\t\t\t       struct snd_info_buffer *buffer)\n{\n\tstruct snd_tscm *tscm = entry->private_data;\n\t__be32 data;\n\tunsigned int reg, fpga, arm, hw;\n\tint err;\n\n\terr = snd_fw_transaction(tscm->unit, TCODE_READ_QUADLET_REQUEST,\n\t\t\tTSCM_ADDR_BASE + TSCM_OFFSET_FIRMWARE_REGISTER,\n\t\t\t&data, sizeof(data), 0);\n\tif (err < 0)\n\t\treturn;\n\treg = be32_to_cpu(data);\n\n\terr = snd_fw_transaction(tscm->unit, TCODE_READ_QUADLET_REQUEST,\n\t\t\tTSCM_ADDR_BASE + TSCM_OFFSET_FIRMWARE_FPGA,\n\t\t\t&data, sizeof(data), 0);\n\tif (err < 0)\n\t\treturn;\n\tfpga = be32_to_cpu(data);\n\n\terr = snd_fw_transaction(tscm->unit, TCODE_READ_QUADLET_REQUEST,\n\t\t\tTSCM_ADDR_BASE + TSCM_OFFSET_FIRMWARE_ARM,\n\t\t\t&data, sizeof(data), 0);\n\tif (err < 0)\n\t\treturn;\n\tarm = be32_to_cpu(data);\n\n\terr = snd_fw_transaction(tscm->unit, TCODE_READ_QUADLET_REQUEST,\n\t\t\tTSCM_ADDR_BASE + TSCM_OFFSET_FIRMWARE_HW,\n\t\t\t&data, sizeof(data), 0);\n\tif (err < 0)\n\t\treturn;\n\thw = be32_to_cpu(data);\n\n\tsnd_iprintf(buffer, \"Register: %d (0x%08x)\\n\", reg & 0xffff, reg);\n\tsnd_iprintf(buffer, \"FPGA:     %d (0x%08x)\\n\", fpga & 0xffff, fpga);\n\tsnd_iprintf(buffer, \"ARM:      %d (0x%08x)\\n\", arm & 0xffff, arm);\n\tsnd_iprintf(buffer, \"Hardware: %d (0x%08x)\\n\", hw >> 16, hw);\n}\n\nstatic void add_node(struct snd_tscm *tscm, struct snd_info_entry *root,\n\t\t     const char *name,\n\t\t     void (*op)(struct snd_info_entry *e,\n\t\t\t\tstruct snd_info_buffer *b))\n{\n\tstruct snd_info_entry *entry;\n\n\tentry = snd_info_create_card_entry(tscm->card, name, root);\n\tif (entry)\n\t\tsnd_info_set_text_ops(entry, tscm, op);\n}\n\nvoid snd_tscm_proc_init(struct snd_tscm *tscm)\n{\n\tstruct snd_info_entry *root;\n\n\t \n\troot = snd_info_create_card_entry(tscm->card, \"firewire\",\n\t\t\t\t\t  tscm->card->proc_root);\n\tif (root == NULL)\n\t\treturn;\n\troot->mode = S_IFDIR | 0555;\n\n\tadd_node(tscm, root, \"firmware\", proc_read_firmware);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}