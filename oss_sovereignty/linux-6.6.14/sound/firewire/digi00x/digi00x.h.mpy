{
  "module_name": "digi00x.h",
  "hash_id": "e38237010000aa038c9fc39ea61900c038d09300f850e8f9573cc55b5cd2f3a7",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/digi00x/digi00x.h",
  "human_readable_source": " \n \n\n#ifndef SOUND_DIGI00X_H_INCLUDED\n#define SOUND_DIGI00X_H_INCLUDED\n\n#include <linux/compat.h>\n#include <linux/device.h>\n#include <linux/firewire.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n\n#include <sound/core.h>\n#include <sound/initval.h>\n#include <sound/info.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/firewire.h>\n#include <sound/hwdep.h>\n#include <sound/rawmidi.h>\n\n#include \"../lib.h\"\n#include \"../iso-resources.h\"\n#include \"../amdtp-stream.h\"\n\nstruct snd_dg00x {\n\tstruct snd_card *card;\n\tstruct fw_unit *unit;\n\n\tstruct mutex mutex;\n\tspinlock_t lock;\n\n\tstruct amdtp_stream tx_stream;\n\tstruct fw_iso_resources tx_resources;\n\n\tstruct amdtp_stream rx_stream;\n\tstruct fw_iso_resources rx_resources;\n\n\tunsigned int substreams_counter;\n\n\t \n\tint dev_lock_count;\n\tbool dev_lock_changed;\n\twait_queue_head_t hwdep_wait;\n\n\t \n\tstruct fw_address_handler async_handler;\n\tu32 msg;\n\n\t \n\tbool is_console;\n\n\tstruct amdtp_domain domain;\n};\n\n#define DG00X_ADDR_BASE\t\t0xffffe0000000ull\n\n#define DG00X_OFFSET_STREAMING_STATE\t0x0000\n#define DG00X_OFFSET_STREAMING_SET\t0x0004\n \n \n \n#define DG00X_OFFSET_MESSAGE_ADDR\t0x0014\n \n \n \n \n#define DG00X_OFFSET_ISOC_CHANNELS\t0x0100\n \n \n \n#define DG00X_OFFSET_LOCAL_RATE\t\t0x0110\n#define DG00X_OFFSET_EXTERNAL_RATE\t0x0114\n#define DG00X_OFFSET_CLOCK_SOURCE\t0x0118\n#define DG00X_OFFSET_OPT_IFACE_MODE\t0x011c\n \n \n \n#define DG00X_OFFSET_DETECT_EXTERNAL\t0x012c\n \n#define DG00X_OFFSET_MMC\t\t0x0400\n\nenum snd_dg00x_rate {\n\tSND_DG00X_RATE_44100 = 0,\n\tSND_DG00X_RATE_48000,\n\tSND_DG00X_RATE_88200,\n\tSND_DG00X_RATE_96000,\n\tSND_DG00X_RATE_COUNT,\n};\n\nenum snd_dg00x_clock {\n\tSND_DG00X_CLOCK_INTERNAL = 0,\n\tSND_DG00X_CLOCK_SPDIF,\n\tSND_DG00X_CLOCK_ADAT,\n\tSND_DG00X_CLOCK_WORD,\n\tSND_DG00X_CLOCK_COUNT,\n};\n\nenum snd_dg00x_optical_mode {\n\tSND_DG00X_OPT_IFACE_MODE_ADAT = 0,\n\tSND_DG00X_OPT_IFACE_MODE_SPDIF,\n\tSND_DG00X_OPT_IFACE_MODE_COUNT,\n};\n\n#define DOT_MIDI_IN_PORTS\t1\n#define DOT_MIDI_OUT_PORTS\t2\n\nint amdtp_dot_init(struct amdtp_stream *s, struct fw_unit *unit,\n\t\t   enum amdtp_stream_direction dir);\nint amdtp_dot_set_parameters(struct amdtp_stream *s, unsigned int rate,\n\t\t\t     unsigned int pcm_channels);\nvoid amdtp_dot_reset(struct amdtp_stream *s);\nint amdtp_dot_add_pcm_hw_constraints(struct amdtp_stream *s,\n\t\t\t\t     struct snd_pcm_runtime *runtime);\nvoid amdtp_dot_midi_trigger(struct amdtp_stream *s, unsigned int port,\n\t\t\t  struct snd_rawmidi_substream *midi);\n\nint snd_dg00x_transaction_register(struct snd_dg00x *dg00x);\nint snd_dg00x_transaction_reregister(struct snd_dg00x *dg00x);\nvoid snd_dg00x_transaction_unregister(struct snd_dg00x *dg00x);\n\nextern const unsigned int snd_dg00x_stream_rates[SND_DG00X_RATE_COUNT];\nextern const unsigned int snd_dg00x_stream_pcm_channels[SND_DG00X_RATE_COUNT];\nint snd_dg00x_stream_get_external_rate(struct snd_dg00x *dg00x,\n\t\t\t\t       unsigned int *rate);\nint snd_dg00x_stream_get_local_rate(struct snd_dg00x *dg00x,\n\t\t\t\t    unsigned int *rate);\nint snd_dg00x_stream_set_local_rate(struct snd_dg00x *dg00x, unsigned int rate);\nint snd_dg00x_stream_get_clock(struct snd_dg00x *dg00x,\n\t\t\t       enum snd_dg00x_clock *clock);\nint snd_dg00x_stream_check_external_clock(struct snd_dg00x *dg00x,\n\t\t\t\t\t  bool *detect);\nint snd_dg00x_stream_init_duplex(struct snd_dg00x *dg00x);\nint snd_dg00x_stream_reserve_duplex(struct snd_dg00x *dg00x, unsigned int rate,\n\t\t\t\t    unsigned int frames_per_period,\n\t\t\t\t    unsigned int frames_per_buffer);\nint snd_dg00x_stream_start_duplex(struct snd_dg00x *dg00x);\nvoid snd_dg00x_stream_stop_duplex(struct snd_dg00x *dg00x);\nvoid snd_dg00x_stream_update_duplex(struct snd_dg00x *dg00x);\nvoid snd_dg00x_stream_destroy_duplex(struct snd_dg00x *dg00x);\n\nvoid snd_dg00x_stream_lock_changed(struct snd_dg00x *dg00x);\nint snd_dg00x_stream_lock_try(struct snd_dg00x *dg00x);\nvoid snd_dg00x_stream_lock_release(struct snd_dg00x *dg00x);\n\nvoid snd_dg00x_proc_init(struct snd_dg00x *dg00x);\n\nint snd_dg00x_create_pcm_devices(struct snd_dg00x *dg00x);\n\nint snd_dg00x_create_midi_devices(struct snd_dg00x *dg00x);\n\nint snd_dg00x_create_hwdep_device(struct snd_dg00x *dg00x);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}