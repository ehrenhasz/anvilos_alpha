{
  "module_name": "fireworks.h",
  "hash_id": "73a9f0b48f12c76f4a80a87da89978eb4bbdda246eb2235a38f182542e477802",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/fireworks/fireworks.h",
  "human_readable_source": " \n \n#ifndef SOUND_FIREWORKS_H_INCLUDED\n#define SOUND_FIREWORKS_H_INCLUDED\n\n#include <linux/compat.h>\n#include <linux/device.h>\n#include <linux/firewire.h>\n#include <linux/firewire-constants.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n\n#include <sound/core.h>\n#include <sound/initval.h>\n#include <sound/pcm.h>\n#include <sound/info.h>\n#include <sound/rawmidi.h>\n#include <sound/pcm_params.h>\n#include <sound/firewire.h>\n#include <sound/hwdep.h>\n\n#include \"../packets-buffer.h\"\n#include \"../iso-resources.h\"\n#include \"../amdtp-am824.h\"\n#include \"../cmp.h\"\n#include \"../lib.h\"\n\n#define SND_EFW_MAX_MIDI_OUT_PORTS\t2\n#define SND_EFW_MAX_MIDI_IN_PORTS\t2\n\n#define SND_EFW_MULTIPLIER_MODES\t3\n#define HWINFO_NAME_SIZE_BYTES\t\t32\n#define HWINFO_MAX_CAPS_GROUPS\t\t8\n\n \n#define SND_EFW_RESPONSE_MAXIMUM_BYTES\t0x200U\n\nextern unsigned int snd_efw_resp_buf_size;\nextern bool snd_efw_resp_buf_debug;\n\nstruct snd_efw_phys_grp {\n\tu8 type;\t \n\tu8 count;\n} __packed;\n\nstruct snd_efw {\n\tstruct snd_card *card;\n\tstruct fw_unit *unit;\n\tint card_index;\n\n\tstruct mutex mutex;\n\tspinlock_t lock;\n\n\t \n\tu32 seqnum;\n\tbool resp_addr_changable;\n\n\t \n\tbool is_af9;\n\tbool is_fireworks3;\n\tu32 firmware_version;\n\n\tunsigned int midi_in_ports;\n\tunsigned int midi_out_ports;\n\n\tunsigned int supported_sampling_rate;\n\tunsigned int pcm_capture_channels[SND_EFW_MULTIPLIER_MODES];\n\tunsigned int pcm_playback_channels[SND_EFW_MULTIPLIER_MODES];\n\n\tstruct amdtp_stream tx_stream;\n\tstruct amdtp_stream rx_stream;\n\tstruct cmp_connection out_conn;\n\tstruct cmp_connection in_conn;\n\tunsigned int substreams_counter;\n\n\t \n\tunsigned int phys_out;\n\tunsigned int phys_in;\n\tunsigned int phys_out_grp_count;\n\tunsigned int phys_in_grp_count;\n\tstruct snd_efw_phys_grp phys_out_grps[HWINFO_MAX_CAPS_GROUPS];\n\tstruct snd_efw_phys_grp phys_in_grps[HWINFO_MAX_CAPS_GROUPS];\n\n\t \n\tint dev_lock_count;\n\tbool dev_lock_changed;\n\twait_queue_head_t hwdep_wait;\n\n\t \n\tu8 *resp_buf;\n\tu8 *pull_ptr;\n\tu8 *push_ptr;\n\n\tstruct amdtp_domain domain;\n};\n\nint snd_efw_transaction_cmd(struct fw_unit *unit,\n\t\t\t    const void *cmd, unsigned int size);\nint snd_efw_transaction_run(struct fw_unit *unit,\n\t\t\t    const void *cmd, unsigned int cmd_size,\n\t\t\t    void *resp, unsigned int resp_size);\nint snd_efw_transaction_register(void);\nvoid snd_efw_transaction_unregister(void);\nvoid snd_efw_transaction_bus_reset(struct fw_unit *unit);\nvoid snd_efw_transaction_add_instance(struct snd_efw *efw);\nvoid snd_efw_transaction_remove_instance(struct snd_efw *efw);\n\nstruct snd_efw_hwinfo {\n\tu32 flags;\n\tu32 guid_hi;\n\tu32 guid_lo;\n\tu32 type;\n\tu32 version;\n\tchar vendor_name[HWINFO_NAME_SIZE_BYTES];\n\tchar model_name[HWINFO_NAME_SIZE_BYTES];\n\tu32 supported_clocks;\n\tu32 amdtp_rx_pcm_channels;\n\tu32 amdtp_tx_pcm_channels;\n\tu32 phys_out;\n\tu32 phys_in;\n\tu32 phys_out_grp_count;\n\tstruct snd_efw_phys_grp phys_out_grps[HWINFO_MAX_CAPS_GROUPS];\n\tu32 phys_in_grp_count;\n\tstruct snd_efw_phys_grp phys_in_grps[HWINFO_MAX_CAPS_GROUPS];\n\tu32 midi_out_ports;\n\tu32 midi_in_ports;\n\tu32 max_sample_rate;\n\tu32 min_sample_rate;\n\tu32 dsp_version;\n\tu32 arm_version;\n\tu32 mixer_playback_channels;\n\tu32 mixer_capture_channels;\n\tu32 fpga_version;\n\tu32 amdtp_rx_pcm_channels_2x;\n\tu32 amdtp_tx_pcm_channels_2x;\n\tu32 amdtp_rx_pcm_channels_4x;\n\tu32 amdtp_tx_pcm_channels_4x;\n\tu32 reserved[16];\n} __packed;\nenum snd_efw_grp_type {\n\tSND_EFW_CH_TYPE_ANALOG\t\t\t= 0,\n\tSND_EFW_CH_TYPE_SPDIF\t\t\t= 1,\n\tSND_EFW_CH_TYPE_ADAT\t\t\t= 2,\n\tSND_EFW_CH_TYPE_SPDIF_OR_ADAT\t\t= 3,\n\tSND_EFW_CH_TYPE_ANALOG_MIRRORING\t= 4,\n\tSND_EFW_CH_TYPE_HEADPHONES\t\t= 5,\n\tSND_EFW_CH_TYPE_I2S\t\t\t= 6,\n\tSND_EFW_CH_TYPE_GUITAR\t\t\t= 7,\n\tSND_EFW_CH_TYPE_PIEZO_GUITAR\t\t= 8,\n\tSND_EFW_CH_TYPE_GUITAR_STRING\t\t= 9,\n\tSND_EFW_CH_TYPE_DUMMY\n};\nstruct snd_efw_phys_meters {\n\tu32 status;\t \n\tu32 reserved0;\n\tu32 reserved1;\n\tu32 reserved2;\n\tu32 reserved3;\n\tu32 out_meters;\n\tu32 in_meters;\n\tu32 reserved4;\n\tu32 reserved5;\n\tu32 values[];\n} __packed;\nenum snd_efw_clock_source {\n\tSND_EFW_CLOCK_SOURCE_INTERNAL\t= 0,\n\t\n\tSND_EFW_CLOCK_SOURCE_WORDCLOCK\t= 2,\n\tSND_EFW_CLOCK_SOURCE_SPDIF\t= 3,\n\tSND_EFW_CLOCK_SOURCE_ADAT_1\t= 4,\n\tSND_EFW_CLOCK_SOURCE_ADAT_2\t= 5,\n\tSND_EFW_CLOCK_SOURCE_CONTINUOUS\t= 6\t \n};\nenum snd_efw_transport_mode {\n\tSND_EFW_TRANSPORT_MODE_WINDOWS\t= 0,\n\tSND_EFW_TRANSPORT_MODE_IEC61883\t= 1,\n};\nint snd_efw_command_set_resp_addr(struct snd_efw *efw,\n\t\t\t\t  u16 addr_high, u32 addr_low);\nint snd_efw_command_set_tx_mode(struct snd_efw *efw,\n\t\t\t\tenum snd_efw_transport_mode mode);\nint snd_efw_command_get_hwinfo(struct snd_efw *efw,\n\t\t\t       struct snd_efw_hwinfo *hwinfo);\nint snd_efw_command_get_phys_meters(struct snd_efw *efw,\n\t\t\t\t    struct snd_efw_phys_meters *meters,\n\t\t\t\t    unsigned int len);\nint snd_efw_command_get_clock_source(struct snd_efw *efw,\n\t\t\t\t     enum snd_efw_clock_source *source);\nint snd_efw_command_get_sampling_rate(struct snd_efw *efw, unsigned int *rate);\nint snd_efw_command_set_sampling_rate(struct snd_efw *efw, unsigned int rate);\n\nint snd_efw_stream_init_duplex(struct snd_efw *efw);\nint snd_efw_stream_reserve_duplex(struct snd_efw *efw, unsigned int rate,\n\t\t\t\t  unsigned int frames_per_period,\n\t\t\t\t  unsigned int frames_per_buffer);\nint snd_efw_stream_start_duplex(struct snd_efw *efw);\nvoid snd_efw_stream_stop_duplex(struct snd_efw *efw);\nvoid snd_efw_stream_update_duplex(struct snd_efw *efw);\nvoid snd_efw_stream_destroy_duplex(struct snd_efw *efw);\nvoid snd_efw_stream_lock_changed(struct snd_efw *efw);\nint snd_efw_stream_lock_try(struct snd_efw *efw);\nvoid snd_efw_stream_lock_release(struct snd_efw *efw);\n\nvoid snd_efw_proc_init(struct snd_efw *efw);\n\nint snd_efw_create_midi_devices(struct snd_efw *efw);\n\nint snd_efw_create_pcm_devices(struct snd_efw *efw);\nint snd_efw_get_multiplier_mode(unsigned int sampling_rate, unsigned int *mode);\n\nint snd_efw_create_hwdep_device(struct snd_efw *efw);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}