{
  "module_name": "motu-proc.c",
  "hash_id": "4ecd2415b075bac29fedd7881ef9b70d4b51cc169f66f2596d94351ff15b4d1b",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/motu/motu-proc.c",
  "human_readable_source": "\n \n\n#include \"./motu.h\"\n\nstatic const char *const clock_names[] = {\n\t[SND_MOTU_CLOCK_SOURCE_INTERNAL] = \"Internal\",\n\t[SND_MOTU_CLOCK_SOURCE_ADAT_ON_DSUB] = \"ADAT on Dsub-9pin interface\",\n\t[SND_MOTU_CLOCK_SOURCE_ADAT_ON_OPT] = \"ADAT on optical interface\",\n\t[SND_MOTU_CLOCK_SOURCE_ADAT_ON_OPT_A] = \"ADAT on optical interface A\",\n\t[SND_MOTU_CLOCK_SOURCE_ADAT_ON_OPT_B] = \"ADAT on optical interface B\",\n\t[SND_MOTU_CLOCK_SOURCE_SPDIF_ON_OPT] = \"S/PDIF on optical interface\",\n\t[SND_MOTU_CLOCK_SOURCE_SPDIF_ON_OPT_A] = \"S/PDIF on optical interface A\",\n\t[SND_MOTU_CLOCK_SOURCE_SPDIF_ON_OPT_B] = \"S/PDIF on optical interface B\",\n\t[SND_MOTU_CLOCK_SOURCE_SPDIF_ON_COAX] = \"S/PDIF on coaxial interface\",\n\t[SND_MOTU_CLOCK_SOURCE_AESEBU_ON_XLR] = \"AESEBU on XLR interface\",\n\t[SND_MOTU_CLOCK_SOURCE_WORD_ON_BNC] = \"Word clock on BNC interface\",\n\t[SND_MOTU_CLOCK_SOURCE_SPH] = \"Source packet header\",\n\t[SND_MOTU_CLOCK_SOURCE_UNKNOWN] = \"Unknown\",\n};\n\nstatic void proc_read_clock(struct snd_info_entry *entry,\n\t\t\t    struct snd_info_buffer *buffer)\n{\n\n\tstruct snd_motu *motu = entry->private_data;\n\tunsigned int rate;\n\tenum snd_motu_clock_source source;\n\n\tif (snd_motu_protocol_get_clock_rate(motu, &rate) < 0)\n\t\treturn;\n\tif (snd_motu_protocol_get_clock_source(motu, &source) < 0)\n\t\treturn;\n\n\tsnd_iprintf(buffer, \"Rate:\\t%d\\n\", rate);\n\tsnd_iprintf(buffer, \"Source:\\t%s\\n\", clock_names[source]);\n}\n\nstatic void proc_read_format(struct snd_info_entry *entry,\n\t\t\t     struct snd_info_buffer *buffer)\n{\n\tstruct snd_motu *motu = entry->private_data;\n\tunsigned int mode;\n\tstruct snd_motu_packet_format *formats;\n\tint i;\n\n\tif (snd_motu_protocol_cache_packet_formats(motu) < 0)\n\t\treturn;\n\n\tsnd_iprintf(buffer, \"tx:\\tmsg\\tfixed\\ttotal\\n\");\n\tfor (i = 0; i < SND_MOTU_CLOCK_RATE_COUNT; ++i) {\n\t\tmode = i >> 1;\n\n\t\tformats = &motu->tx_packet_formats;\n\t\tsnd_iprintf(buffer,\n\t\t\t    \"%u:\\t%u\\t%u\\t%u\\n\",\n\t\t\t    snd_motu_clock_rates[i],\n\t\t\t    formats->msg_chunks,\n\t\t\t    motu->spec->tx_fixed_pcm_chunks[mode],\n\t\t\t    formats->pcm_chunks[mode]);\n\t}\n\n\tsnd_iprintf(buffer, \"rx:\\tmsg\\tfixed\\ttotal\\n\");\n\tfor (i = 0; i < SND_MOTU_CLOCK_RATE_COUNT; ++i) {\n\t\tmode = i >> 1;\n\n\t\tformats = &motu->rx_packet_formats;\n\t\tsnd_iprintf(buffer,\n\t\t\t    \"%u:\\t%u\\t%u\\t%u\\n\",\n\t\t\t    snd_motu_clock_rates[i],\n\t\t\t    formats->msg_chunks,\n\t\t\t    motu->spec->rx_fixed_pcm_chunks[mode],\n\t\t\t    formats->pcm_chunks[mode]);\n\t}\n}\n\nstatic void add_node(struct snd_motu *motu, struct snd_info_entry *root,\n\t\t     const char *name,\n\t\t     void (*op)(struct snd_info_entry *e,\n\t\t\t\tstruct snd_info_buffer *b))\n{\n\tstruct snd_info_entry *entry;\n\n\tentry = snd_info_create_card_entry(motu->card, name, root);\n\tif (entry)\n\t\tsnd_info_set_text_ops(entry, motu, op);\n}\n\nvoid snd_motu_proc_init(struct snd_motu *motu)\n{\n\tstruct snd_info_entry *root;\n\n\t \n\troot = snd_info_create_card_entry(motu->card, \"firewire\",\n\t\t\t\t\t  motu->card->proc_root);\n\tif (root == NULL)\n\t\treturn;\n\troot->mode = S_IFDIR | 0555;\n\n\tadd_node(motu, root, \"clock\", proc_read_clock);\n\tadd_node(motu, root, \"format\", proc_read_format);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}