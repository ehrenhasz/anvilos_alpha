{
  "module_name": "oxfw-proc.c",
  "hash_id": "9b791e0e04f4be1af1d7c73af6b9d3e4cb8a4085b7823f392e71b7394e08b542",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/oxfw/oxfw-proc.c",
  "human_readable_source": "\n \n\n#include \"./oxfw.h\"\n\nstatic void proc_read_formation(struct snd_info_entry *entry,\n\t\t\t\tstruct snd_info_buffer *buffer)\n{\n\tstruct snd_oxfw *oxfw = entry->private_data;\n\tstruct snd_oxfw_stream_formation formation, curr;\n\tu8 *format;\n\tchar flag;\n\tint i, err;\n\n\t \n\terr = snd_oxfw_stream_get_current_formation(oxfw,\n\t\t\t\t\t\t    AVC_GENERAL_PLUG_DIR_IN,\n\t\t\t\t\t\t    &curr);\n\tif (err < 0)\n\t\treturn;\n\n\tsnd_iprintf(buffer, \"Input Stream to device:\\n\");\n\tsnd_iprintf(buffer, \"\\tRate\\tPCM\\tMIDI\\n\");\n\tfor (i = 0; i < SND_OXFW_STREAM_FORMAT_ENTRIES; i++) {\n\t\tformat = oxfw->rx_stream_formats[i];\n\t\tif (format == NULL)\n\t\t\tcontinue;\n\n\t\terr = snd_oxfw_stream_parse_format(format, &formation);\n\t\tif (err < 0)\n\t\t\tcontinue;\n\n\t\tif (memcmp(&formation, &curr, sizeof(curr)) == 0)\n\t\t\tflag = '*';\n\t\telse\n\t\t\tflag = ' ';\n\n\t\tsnd_iprintf(buffer, \"%c\\t%d\\t%d\\t%d\\n\", flag,\n\t\t\t    formation.rate, formation.pcm, formation.midi);\n\t}\n\n\tif (!oxfw->has_output)\n\t\treturn;\n\n\t \n\terr = snd_oxfw_stream_get_current_formation(oxfw,\n\t\t\t\t\t\t    AVC_GENERAL_PLUG_DIR_OUT,\n\t\t\t\t\t\t    &curr);\n\tif (err < 0)\n\t\treturn;\n\n\tsnd_iprintf(buffer, \"Output Stream from device:\\n\");\n\tsnd_iprintf(buffer, \"\\tRate\\tPCM\\tMIDI\\n\");\n\tfor (i = 0; i < SND_OXFW_STREAM_FORMAT_ENTRIES; i++) {\n\t\tformat = oxfw->tx_stream_formats[i];\n\t\tif (format == NULL)\n\t\t\tcontinue;\n\n\t\terr = snd_oxfw_stream_parse_format(format, &formation);\n\t\tif (err < 0)\n\t\t\tcontinue;\n\n\t\tif (memcmp(&formation, &curr, sizeof(curr)) == 0)\n\t\t\tflag = '*';\n\t\telse\n\t\t\tflag = ' ';\n\n\t\tsnd_iprintf(buffer, \"%c\\t%d\\t%d\\t%d\\n\", flag,\n\t\t\t    formation.rate, formation.pcm, formation.midi);\n\t}\n}\n\nstatic void add_node(struct snd_oxfw *oxfw, struct snd_info_entry *root,\n\t\t     const char *name,\n\t\t     void (*op)(struct snd_info_entry *e,\n\t\t\t\tstruct snd_info_buffer *b))\n{\n\tstruct snd_info_entry *entry;\n\n\tentry = snd_info_create_card_entry(oxfw->card, name, root);\n\tif (entry)\n\t\tsnd_info_set_text_ops(entry, oxfw, op);\n}\n\nvoid snd_oxfw_proc_init(struct snd_oxfw *oxfw)\n{\n\tstruct snd_info_entry *root;\n\n\t \n\troot = snd_info_create_card_entry(oxfw->card, \"firewire\",\n\t\t\t\t\t  oxfw->card->proc_root);\n\tif (root == NULL)\n\t\treturn;\n\troot->mode = S_IFDIR | 0555;\n\n\tadd_node(oxfw, root, \"formation\", proc_read_formation);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}