{
  "module_name": "oxfw.h",
  "hash_id": "921b2f2400543e4ef3734e927cc5a4e64ee7bb488c91959fde686b0b8975ab36",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/oxfw/oxfw.h",
  "human_readable_source": " \n \n\n#include <linux/device.h>\n#include <linux/firewire.h>\n#include <linux/firewire-constants.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/compat.h>\n#include <linux/sched/signal.h>\n\n#include <sound/control.h>\n#include <sound/core.h>\n#include <sound/initval.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/info.h>\n#include <sound/rawmidi.h>\n#include <sound/firewire.h>\n#include <sound/hwdep.h>\n\n#include \"../lib.h\"\n#include \"../fcp.h\"\n#include \"../packets-buffer.h\"\n#include \"../iso-resources.h\"\n#include \"../amdtp-am824.h\"\n#include \"../cmp.h\"\n\nenum snd_oxfw_quirk {\n\t\n\t\n\tSND_OXFW_QUIRK_JUMBO_PAYLOAD = 0x01,\n\t\n\tSND_OXFW_QUIRK_WRONG_DBS = 0x02,\n\t\n\tSND_OXFW_QUIRK_BLOCKING_TRANSMISSION = 0x04,\n\t\n\tSND_OXFW_QUIRK_SCS_TRANSACTION = 0x08,\n\t\n\t\n\t\n\t\n\tSND_OXFW_QUIRK_IGNORE_NO_INFO_PACKET = 0x10,\n\t\n\t\n\t\n\t\n\tSND_OXFW_QUIRK_VOLUNTARY_RECOVERY = 0x20,\n};\n\n \n#define\tSND_OXFW_STREAM_FORMAT_ENTRIES\t10\nstruct snd_oxfw {\n\tstruct snd_card *card;\n\tstruct fw_unit *unit;\n\tstruct mutex mutex;\n\tspinlock_t lock;\n\n\t\n\tunsigned int quirks;\n\tbool has_output;\n\tbool has_input;\n\tu8 *tx_stream_formats[SND_OXFW_STREAM_FORMAT_ENTRIES];\n\tu8 *rx_stream_formats[SND_OXFW_STREAM_FORMAT_ENTRIES];\n\tbool assumed;\n\tstruct cmp_connection out_conn;\n\tstruct cmp_connection in_conn;\n\tstruct amdtp_stream tx_stream;\n\tstruct amdtp_stream rx_stream;\n\tunsigned int substreams_count;\n\n\tunsigned int midi_input_ports;\n\tunsigned int midi_output_ports;\n\n\tint dev_lock_count;\n\tbool dev_lock_changed;\n\twait_queue_head_t hwdep_wait;\n\n\tvoid *spec;\n\n\tstruct amdtp_domain domain;\n};\n\n \nint avc_stream_set_format(struct fw_unit *unit, enum avc_general_plug_dir dir,\n\t\t\t  unsigned int pid, u8 *format, unsigned int len);\nint avc_stream_get_format(struct fw_unit *unit,\n\t\t\t  enum avc_general_plug_dir dir, unsigned int pid,\n\t\t\t  u8 *buf, unsigned int *len, unsigned int eid);\nstatic inline int\navc_stream_get_format_single(struct fw_unit *unit,\n\t\t\t     enum avc_general_plug_dir dir, unsigned int pid,\n\t\t\t     u8 *buf, unsigned int *len)\n{\n\treturn avc_stream_get_format(unit, dir, pid, buf, len, 0xff);\n}\nstatic inline int\navc_stream_get_format_list(struct fw_unit *unit,\n\t\t\t   enum avc_general_plug_dir dir, unsigned int pid,\n\t\t\t   u8 *buf, unsigned int *len,\n\t\t\t   unsigned int eid)\n{\n\treturn avc_stream_get_format(unit, dir, pid, buf, len, eid);\n}\n\n \nint avc_general_inquiry_sig_fmt(struct fw_unit *unit, unsigned int rate,\n\t\t\t\tenum avc_general_plug_dir dir,\n\t\t\t\tunsigned short pid);\n\nint snd_oxfw_stream_init_duplex(struct snd_oxfw *oxfw);\nint snd_oxfw_stream_reserve_duplex(struct snd_oxfw *oxfw,\n\t\t\t\t   struct amdtp_stream *stream,\n\t\t\t\t   unsigned int rate, unsigned int pcm_channels,\n\t\t\t\t   unsigned int frames_per_period,\n\t\t\t\t   unsigned int frames_per_buffer);\nint snd_oxfw_stream_start_duplex(struct snd_oxfw *oxfw);\nvoid snd_oxfw_stream_stop_duplex(struct snd_oxfw *oxfw);\nvoid snd_oxfw_stream_destroy_duplex(struct snd_oxfw *oxfw);\nvoid snd_oxfw_stream_update_duplex(struct snd_oxfw *oxfw);\n\nstruct snd_oxfw_stream_formation {\n\tunsigned int rate;\n\tunsigned int pcm;\n\tunsigned int midi;\n};\nint snd_oxfw_stream_parse_format(u8 *format,\n\t\t\t\t struct snd_oxfw_stream_formation *formation);\nint snd_oxfw_stream_get_current_formation(struct snd_oxfw *oxfw,\n\t\t\t\tenum avc_general_plug_dir dir,\n\t\t\t\tstruct snd_oxfw_stream_formation *formation);\n\nint snd_oxfw_stream_discover(struct snd_oxfw *oxfw);\n\nvoid snd_oxfw_stream_lock_changed(struct snd_oxfw *oxfw);\nint snd_oxfw_stream_lock_try(struct snd_oxfw *oxfw);\nvoid snd_oxfw_stream_lock_release(struct snd_oxfw *oxfw);\n\nint snd_oxfw_create_pcm(struct snd_oxfw *oxfw);\n\nvoid snd_oxfw_proc_init(struct snd_oxfw *oxfw);\n\nint snd_oxfw_create_midi(struct snd_oxfw *oxfw);\n\nint snd_oxfw_create_hwdep(struct snd_oxfw *oxfw);\n\nint snd_oxfw_add_spkr(struct snd_oxfw *oxfw, bool is_lacie);\nint snd_oxfw_scs1x_add(struct snd_oxfw *oxfw);\nvoid snd_oxfw_scs1x_update(struct snd_oxfw *oxfw);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}