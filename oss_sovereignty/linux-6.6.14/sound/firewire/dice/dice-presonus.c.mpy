{
  "module_name": "dice-presonus.c",
  "hash_id": "fd17a05d27121c3712f61d0219e022561338c30168700a4a1a2561a3a595e768",
  "original_prompt": "Ingested from linux-6.6.14/sound/firewire/dice/dice-presonus.c",
  "human_readable_source": "\n\n\n\n\n#include \"dice.h\"\n\nstruct dice_presonus_spec {\n\tunsigned int tx_pcm_chs[MAX_STREAMS][SND_DICE_RATE_MODE_COUNT];\n\tunsigned int rx_pcm_chs[MAX_STREAMS][SND_DICE_RATE_MODE_COUNT];\n\tbool has_midi;\n};\n\nstatic const struct dice_presonus_spec dice_presonus_firesutio = {\n\t.tx_pcm_chs = {{16, 16, 0}, {10, 2, 0} },\n\t.rx_pcm_chs = {{16, 16, 0}, {10, 2, 0} },\n\t.has_midi = true,\n};\n\nint snd_dice_detect_presonus_formats(struct snd_dice *dice)\n{\n\tstatic const struct {\n\t\tu32 model_id;\n\t\tconst struct dice_presonus_spec *spec;\n\t} *entry, entries[] = {\n\t\t{0x000008, &dice_presonus_firesutio},\n\t};\n\tstruct fw_csr_iterator it;\n\tint key, val, model_id;\n\tint i;\n\n\tmodel_id = 0;\n\tfw_csr_iterator_init(&it, dice->unit->directory);\n\twhile (fw_csr_iterator_next(&it, &key, &val)) {\n\t\tif (key == CSR_MODEL) {\n\t\t\tmodel_id = val;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(entries); ++i) {\n\t\tentry = entries + i;\n\t\tif (entry->model_id == model_id)\n\t\t\tbreak;\n\t}\n\tif (i == ARRAY_SIZE(entries))\n\t\treturn -ENODEV;\n\n\tmemcpy(dice->tx_pcm_chs, entry->spec->tx_pcm_chs,\n\t       MAX_STREAMS * SND_DICE_RATE_MODE_COUNT * sizeof(unsigned int));\n\tmemcpy(dice->rx_pcm_chs, entry->spec->rx_pcm_chs,\n\t       MAX_STREAMS * SND_DICE_RATE_MODE_COUNT * sizeof(unsigned int));\n\n\tif (entry->spec->has_midi) {\n\t\tdice->tx_midi_ports[0] = 1;\n\t\tdice->rx_midi_ports[0] = 1;\n\t}\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}