{
  "module_name": "adlib.c",
  "hash_id": "ef5f03f712c1e005694f55b979e7a19c0395f14dc3d8fa4e9354bedd81b0e018",
  "original_prompt": "Ingested from linux-6.6.14/sound/isa/adlib.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/isa.h>\n#include <sound/core.h>\n#include <sound/initval.h>\n#include <sound/opl3.h>\n\n#define CRD_NAME \"AdLib FM\"\n#define DEV_NAME \"adlib\"\n\nMODULE_DESCRIPTION(CRD_NAME);\nMODULE_AUTHOR(\"Rene Herman\");\nMODULE_LICENSE(\"GPL\");\n\nstatic int index[SNDRV_CARDS] = SNDRV_DEFAULT_IDX;\nstatic char *id[SNDRV_CARDS] = SNDRV_DEFAULT_STR;\nstatic bool enable[SNDRV_CARDS] = SNDRV_DEFAULT_ENABLE;\nstatic long port[SNDRV_CARDS] = SNDRV_DEFAULT_PORT;\n\nmodule_param_array(index, int, NULL, 0444);\nMODULE_PARM_DESC(index, \"Index value for \" CRD_NAME \" soundcard.\");\nmodule_param_array(id, charp, NULL, 0444);\nMODULE_PARM_DESC(id, \"ID string for \" CRD_NAME \" soundcard.\");\nmodule_param_array(enable, bool, NULL, 0444);\nMODULE_PARM_DESC(enable, \"Enable \" CRD_NAME \" soundcard.\");\nmodule_param_hw_array(port, long, ioport, NULL, 0444);\nMODULE_PARM_DESC(port, \"Port # for \" CRD_NAME \" driver.\");\n\nstatic int snd_adlib_match(struct device *dev, unsigned int n)\n{\n\tif (!enable[n])\n\t\treturn 0;\n\n\tif (port[n] == SNDRV_AUTO_PORT) {\n\t\tdev_err(dev, \"please specify port\\n\");\n\t\treturn 0;\n\t}\n\treturn 1;\n}\n\nstatic int snd_adlib_probe(struct device *dev, unsigned int n)\n{\n\tstruct snd_card *card;\n\tstruct snd_opl3 *opl3;\n\tint error;\n\n\terror = snd_devm_card_new(dev, index[n], id[n], THIS_MODULE, 0, &card);\n\tif (error < 0) {\n\t\tdev_err(dev, \"could not create card\\n\");\n\t\treturn error;\n\t}\n\n\tcard->private_data = devm_request_region(dev, port[n], 4, CRD_NAME);\n\tif (!card->private_data) {\n\t\tdev_err(dev, \"could not grab ports\\n\");\n\t\treturn -EBUSY;\n\t}\n\n\tstrcpy(card->driver, DEV_NAME);\n\tstrcpy(card->shortname, CRD_NAME);\n\tsprintf(card->longname, CRD_NAME \" at %#lx\", port[n]);\n\n\terror = snd_opl3_create(card, port[n], port[n] + 2, OPL3_HW_AUTO, 1, &opl3);\n\tif (error < 0) {\n\t\tdev_err(dev, \"could not create OPL\\n\");\n\t\treturn error;\n\t}\n\n\terror = snd_opl3_hwdep_new(opl3, 0, 0, NULL);\n\tif (error < 0) {\n\t\tdev_err(dev, \"could not create FM\\n\");\n\t\treturn error;\n\t}\n\n\terror = snd_card_register(card);\n\tif (error < 0) {\n\t\tdev_err(dev, \"could not register card\\n\");\n\t\treturn error;\n\t}\n\n\tdev_set_drvdata(dev, card);\n\treturn 0;\n}\n\nstatic struct isa_driver snd_adlib_driver = {\n\t.match\t\t= snd_adlib_match,\n\t.probe\t\t= snd_adlib_probe,\n\n\t.driver\t\t= {\n\t\t.name\t= DEV_NAME\n\t}\n};\n\nmodule_isa_driver(snd_adlib_driver, SNDRV_CARDS);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}