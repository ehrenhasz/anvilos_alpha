{
  "module_name": "emu8000_synth.c",
  "hash_id": "ba230da890e6e942c40e10fd4c871c914014c57a4da76c807298200fa0a83f60",
  "original_prompt": "Ingested from linux-6.6.14/sound/isa/sb/emu8000_synth.c",
  "human_readable_source": "\n \n\n#include \"emu8000_local.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <sound/initval.h>\n\nMODULE_AUTHOR(\"Takashi Iwai, Steve Ratcliffe\");\nMODULE_DESCRIPTION(\"Emu8000 synth plug-in routine\");\nMODULE_LICENSE(\"GPL\");\n\n \n\n \nstatic int snd_emu8000_probe(struct device *_dev)\n{\n\tstruct snd_seq_device *dev = to_seq_dev(_dev);\n\tstruct snd_emu8000 *hw;\n\tstruct snd_emux *emu;\n\n\thw = *(struct snd_emu8000**)SNDRV_SEQ_DEVICE_ARGPTR(dev);\n\tif (hw == NULL)\n\t\treturn -EINVAL;\n\n\tif (hw->emu)\n\t\treturn -EBUSY;  \n\n\tif (snd_emux_new(&emu) < 0)\n\t\treturn -ENOMEM;\n\n\thw->emu = emu;\n\tsnd_emu8000_ops_setup(hw);\n\n\temu->hw = hw;\n\temu->max_voices = EMU8000_DRAM_VOICES;\n\temu->num_ports = hw->seq_ports;\n\n\tif (hw->memhdr) {\n\t\tsnd_printk(KERN_ERR \"memhdr is already initialized!?\\n\");\n\t\tsnd_util_memhdr_free(hw->memhdr);\n\t}\n\thw->memhdr = snd_util_memhdr_new(hw->mem_size);\n\tif (hw->memhdr == NULL) {\n\t\tsnd_emux_free(emu);\n\t\thw->emu = NULL;\n\t\treturn -ENOMEM;\n\t}\n\n\temu->memhdr = hw->memhdr;\n\temu->midi_ports = hw->seq_ports < 2 ? hw->seq_ports : 2;  \n\temu->midi_devidx = 1;\n\temu->linear_panning = 1;\n\temu->hwdep_idx = 2;  \n\n\tif (snd_emux_register(emu, dev->card, hw->index, \"Emu8000\") < 0) {\n\t\tsnd_emux_free(emu);\n\t\tsnd_util_memhdr_free(hw->memhdr);\n\t\thw->emu = NULL;\n\t\thw->memhdr = NULL;\n\t\treturn -ENOMEM;\n\t}\n\n\tif (hw->mem_size > 0)\n\t\tsnd_emu8000_pcm_new(dev->card, hw, 1);\n\n\tdev->driver_data = hw;\n\n\treturn 0;\n}\n\n\n \nstatic int snd_emu8000_remove(struct device *_dev)\n{\n\tstruct snd_seq_device *dev = to_seq_dev(_dev);\n\tstruct snd_emu8000 *hw;\n\n\tif (dev->driver_data == NULL)\n\t\treturn 0;  \n\n\thw = dev->driver_data;\n\tif (hw->pcm)\n\t\tsnd_device_free(dev->card, hw->pcm);\n\tsnd_emux_free(hw->emu);\n\tsnd_util_memhdr_free(hw->memhdr);\n\thw->emu = NULL;\n\thw->memhdr = NULL;\n\treturn 0;\n}\n\n \n\nstatic struct snd_seq_driver emu8000_driver = {\n\t.driver = {\n\t\t.name = KBUILD_MODNAME,\n\t\t.probe = snd_emu8000_probe,\n\t\t.remove = snd_emu8000_remove,\n\t},\n\t.id = SNDRV_SEQ_DEV_ID_EMU8000,\n\t.argsize = sizeof(struct snd_emu8000 *),\n};\n\nmodule_snd_seq_driver(emu8000_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}