{
  "module_name": "skl-sst-cldma.h",
  "hash_id": "94081e3c0164525363efcaacf1b843ebfe46a5f667b1afe5ead56bdf5c906672",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/intel/skylake/skl-sst-cldma.h",
  "human_readable_source": " \n \n\n#ifndef SKL_SST_CLDMA_H_\n#define SKL_SST_CLDMA_H_\n\n#define FW_CL_STREAM_NUMBER\t\t0x1\n\n#define DMA_ADDRESS_128_BITS_ALIGNMENT\t7\n#define BDL_ALIGN(x)\t\t\t(x >> DMA_ADDRESS_128_BITS_ALIGNMENT)\n\n#define SKL_ADSPIC_CL_DMA\t\t\t0x2\n#define SKL_ADSPIS_CL_DMA\t\t\t0x2\n#define SKL_CL_DMA_SD_INT_DESC_ERR\t\t0x10  \n#define SKL_CL_DMA_SD_INT_FIFO_ERR\t\t0x08  \n#define SKL_CL_DMA_SD_INT_COMPLETE\t\t0x04  \n\n \n\n#define HDA_ADSP_LOADER_BASE\t\t0x80\n\n \n#define SKL_ADSP_REG_CL_SD_CTL\t\t\t(HDA_ADSP_LOADER_BASE + 0x00)\n#define SKL_ADSP_REG_CL_SD_STS\t\t\t(HDA_ADSP_LOADER_BASE + 0x03)\n#define SKL_ADSP_REG_CL_SD_LPIB\t\t\t(HDA_ADSP_LOADER_BASE + 0x04)\n#define SKL_ADSP_REG_CL_SD_CBL\t\t\t(HDA_ADSP_LOADER_BASE + 0x08)\n#define SKL_ADSP_REG_CL_SD_LVI\t\t\t(HDA_ADSP_LOADER_BASE + 0x0c)\n#define SKL_ADSP_REG_CL_SD_FIFOW\t\t(HDA_ADSP_LOADER_BASE + 0x0e)\n#define SKL_ADSP_REG_CL_SD_FIFOSIZE\t\t(HDA_ADSP_LOADER_BASE + 0x10)\n#define SKL_ADSP_REG_CL_SD_FORMAT\t\t(HDA_ADSP_LOADER_BASE + 0x12)\n#define SKL_ADSP_REG_CL_SD_FIFOL\t\t(HDA_ADSP_LOADER_BASE + 0x14)\n#define SKL_ADSP_REG_CL_SD_BDLPL\t\t(HDA_ADSP_LOADER_BASE + 0x18)\n#define SKL_ADSP_REG_CL_SD_BDLPU\t\t(HDA_ADSP_LOADER_BASE + 0x1c)\n\n \n#define SKL_ADSP_REG_CL_SPBFIFO\t\t\t(HDA_ADSP_LOADER_BASE + 0x20)\n#define SKL_ADSP_REG_CL_SPBFIFO_SPBFCH\t\t(SKL_ADSP_REG_CL_SPBFIFO + 0x0)\n#define SKL_ADSP_REG_CL_SPBFIFO_SPBFCCTL\t(SKL_ADSP_REG_CL_SPBFIFO + 0x4)\n#define SKL_ADSP_REG_CL_SPBFIFO_SPIB\t\t(SKL_ADSP_REG_CL_SPBFIFO + 0x8)\n#define SKL_ADSP_REG_CL_SPBFIFO_MAXFIFOS\t(SKL_ADSP_REG_CL_SPBFIFO + 0xc)\n\n \n\n \n#define CL_SD_CTL_SRST_SHIFT\t\t0\n#define CL_SD_CTL_SRST_MASK\t\t(1 << CL_SD_CTL_SRST_SHIFT)\n#define CL_SD_CTL_SRST(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_SRST_SHIFT) & CL_SD_CTL_SRST_MASK)\n\n \n#define CL_SD_CTL_RUN_SHIFT\t\t1\n#define CL_SD_CTL_RUN_MASK\t\t(1 << CL_SD_CTL_RUN_SHIFT)\n#define CL_SD_CTL_RUN(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_RUN_SHIFT) & CL_SD_CTL_RUN_MASK)\n\n \n#define CL_SD_CTL_IOCE_SHIFT\t\t2\n#define CL_SD_CTL_IOCE_MASK\t\t(1 << CL_SD_CTL_IOCE_SHIFT)\n#define CL_SD_CTL_IOCE(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_IOCE_SHIFT) & CL_SD_CTL_IOCE_MASK)\n\n \n#define CL_SD_CTL_FEIE_SHIFT\t\t3\n#define CL_SD_CTL_FEIE_MASK\t\t(1 << CL_SD_CTL_FEIE_SHIFT)\n#define CL_SD_CTL_FEIE(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_FEIE_SHIFT) & CL_SD_CTL_FEIE_MASK)\n\n \n#define CL_SD_CTL_DEIE_SHIFT\t\t4\n#define CL_SD_CTL_DEIE_MASK\t\t(1 << CL_SD_CTL_DEIE_SHIFT)\n#define CL_SD_CTL_DEIE(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_DEIE_SHIFT) & CL_SD_CTL_DEIE_MASK)\n\n \n#define CL_SD_CTL_FIFOLC_SHIFT\t\t5\n#define CL_SD_CTL_FIFOLC_MASK\t\t(1 << CL_SD_CTL_FIFOLC_SHIFT)\n#define CL_SD_CTL_FIFOLC(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_FIFOLC_SHIFT) & CL_SD_CTL_FIFOLC_MASK)\n\n \n#define CL_SD_CTL_STRIPE_SHIFT\t\t16\n#define CL_SD_CTL_STRIPE_MASK\t\t(0x3 << CL_SD_CTL_STRIPE_SHIFT)\n#define CL_SD_CTL_STRIPE(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_STRIPE_SHIFT) & CL_SD_CTL_STRIPE_MASK)\n\n \n#define CL_SD_CTL_TP_SHIFT\t\t18\n#define CL_SD_CTL_TP_MASK\t\t(1 << CL_SD_CTL_TP_SHIFT)\n#define CL_SD_CTL_TP(x)\t\t\t\\\n\t\t\t((x << CL_SD_CTL_TP_SHIFT) & CL_SD_CTL_TP_MASK)\n\n \n#define CL_SD_CTL_DIR_SHIFT\t\t19\n#define CL_SD_CTL_DIR_MASK\t\t(1 << CL_SD_CTL_DIR_SHIFT)\n#define CL_SD_CTL_DIR(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_DIR_SHIFT) & CL_SD_CTL_DIR_MASK)\n\n \n#define CL_SD_CTL_STRM_SHIFT\t\t20\n#define CL_SD_CTL_STRM_MASK\t\t(0xf << CL_SD_CTL_STRM_SHIFT)\n#define CL_SD_CTL_STRM(x)\t\t\\\n\t\t\t((x << CL_SD_CTL_STRM_SHIFT) & CL_SD_CTL_STRM_MASK)\n\n \n\n \n#define CL_SD_STS_BCIS(x)\t\tCL_SD_CTL_IOCE(x)\n\n \n#define CL_SD_STS_FIFOE(x)\t\tCL_SD_CTL_FEIE(x)\n\n \n#define CL_SD_STS_DESE(x)\t\tCL_SD_CTL_DEIE(x)\n\n \n#define CL_SD_STS_FIFORDY(x)\tCL_SD_CTL_FIFOLC(x)\n\n\n \n#define CL_SD_LVI_SHIFT\t\t\t0\n#define CL_SD_LVI_MASK\t\t\t(0xff << CL_SD_LVI_SHIFT)\n#define CL_SD_LVI(x)\t\t\t((x << CL_SD_LVI_SHIFT) & CL_SD_LVI_MASK)\n\n \n#define CL_SD_FIFOW_SHIFT\t\t0\n#define CL_SD_FIFOW_MASK\t\t(0x7 << CL_SD_FIFOW_SHIFT)\n#define CL_SD_FIFOW(x)\t\t\t\\\n\t\t\t((x << CL_SD_FIFOW_SHIFT) & CL_SD_FIFOW_MASK)\n\n \n\n \n#define CL_SD_BDLPLBA_PROT_SHIFT\t0\n#define CL_SD_BDLPLBA_PROT_MASK\t\t(1 << CL_SD_BDLPLBA_PROT_SHIFT)\n#define CL_SD_BDLPLBA_PROT(x)\t\t\\\n\t\t((x << CL_SD_BDLPLBA_PROT_SHIFT) & CL_SD_BDLPLBA_PROT_MASK)\n\n \n#define CL_SD_BDLPLBA_SHIFT\t\t7\n#define CL_SD_BDLPLBA_MASK\t\t(0x1ffffff << CL_SD_BDLPLBA_SHIFT)\n#define CL_SD_BDLPLBA(x)\t\t\\\n\t((BDL_ALIGN(lower_32_bits(x)) << CL_SD_BDLPLBA_SHIFT) & CL_SD_BDLPLBA_MASK)\n\n \n#define CL_SD_BDLPUBA_SHIFT\t\t0\n#define CL_SD_BDLPUBA_MASK\t\t(0xffffffff << CL_SD_BDLPUBA_SHIFT)\n#define CL_SD_BDLPUBA(x)\t\t\\\n\t\t((upper_32_bits(x) << CL_SD_BDLPUBA_SHIFT) & CL_SD_BDLPUBA_MASK)\n\n \n\n \n#define CL_SPBFIFO_SPBFCH_PTR_SHIFT\t0\n#define CL_SPBFIFO_SPBFCH_PTR_MASK\t(0xff << CL_SPBFIFO_SPBFCH_PTR_SHIFT)\n#define CL_SPBFIFO_SPBFCH_PTR(x)\t\\\n\t\t((x << CL_SPBFIFO_SPBFCH_PTR_SHIFT) & CL_SPBFIFO_SPBFCH_PTR_MASK)\n\n \n#define CL_SPBFIFO_SPBFCH_ID_SHIFT\t16\n#define CL_SPBFIFO_SPBFCH_ID_MASK\t(0xfff << CL_SPBFIFO_SPBFCH_ID_SHIFT)\n#define CL_SPBFIFO_SPBFCH_ID(x)\t\t\\\n\t\t((x << CL_SPBFIFO_SPBFCH_ID_SHIFT) & CL_SPBFIFO_SPBFCH_ID_MASK)\n\n \n#define CL_SPBFIFO_SPBFCH_VER_SHIFT\t28\n#define CL_SPBFIFO_SPBFCH_VER_MASK\t(0xf << CL_SPBFIFO_SPBFCH_VER_SHIFT)\n#define CL_SPBFIFO_SPBFCH_VER(x)\t\\\n\t((x << CL_SPBFIFO_SPBFCH_VER_SHIFT) & CL_SPBFIFO_SPBFCH_VER_MASK)\n\n \n#define CL_SPBFIFO_SPBFCCTL_SPIBE_SHIFT\t0\n#define CL_SPBFIFO_SPBFCCTL_SPIBE_MASK\t(1 << CL_SPBFIFO_SPBFCCTL_SPIBE_SHIFT)\n#define CL_SPBFIFO_SPBFCCTL_SPIBE(x)\t\\\n\t((x << CL_SPBFIFO_SPBFCCTL_SPIBE_SHIFT) & CL_SPBFIFO_SPBFCCTL_SPIBE_MASK)\n\n \n#define SKL_WAIT_TIMEOUT\t\t500\t \n#define SKL_MAX_BUFFER_SIZE\t\t(32 * PAGE_SIZE)\n\nenum skl_cl_dma_wake_states {\n\tSKL_CL_DMA_STATUS_NONE = 0,\n\tSKL_CL_DMA_BUF_COMPLETE,\n\tSKL_CL_DMA_ERR,\t \n};\n\nstruct sst_dsp;\n\nstruct skl_cl_dev_ops {\n\tvoid (*cl_setup_bdle)(struct sst_dsp *ctx,\n\t\t\tstruct snd_dma_buffer *dmab_data,\n\t\t\t__le32 **bdlp, int size, int with_ioc);\n\tvoid (*cl_setup_controller)(struct sst_dsp *ctx,\n\t\t\tstruct snd_dma_buffer *dmab_bdl,\n\t\t\tunsigned int max_size, u32 page_count);\n\tvoid (*cl_setup_spb)(struct sst_dsp  *ctx,\n\t\t\tunsigned int size, bool enable);\n\tvoid (*cl_cleanup_spb)(struct sst_dsp  *ctx);\n\tvoid (*cl_trigger)(struct sst_dsp  *ctx, bool enable);\n\tvoid (*cl_cleanup_controller)(struct sst_dsp  *ctx);\n\tint (*cl_copy_to_dmabuf)(struct sst_dsp *ctx,\n\t\t\tconst void *bin, u32 size, bool wait);\n\tvoid (*cl_stop_dma)(struct sst_dsp *ctx);\n};\n\n \nstruct skl_cl_dev {\n\tstruct snd_dma_buffer dmab_data;\n\tstruct snd_dma_buffer dmab_bdl;\n\n\tunsigned int bufsize;\n\tunsigned int frags;\n\n\tunsigned int curr_spib_pos;\n\tunsigned int dma_buffer_offset;\n\tstruct skl_cl_dev_ops ops;\n\n\twait_queue_head_t wait_queue;\n\tint wake_status;\n\tbool wait_condition;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}