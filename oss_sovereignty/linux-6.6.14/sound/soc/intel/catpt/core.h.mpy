{
  "module_name": "core.h",
  "hash_id": "5f7ff856b8eccaaef7e9de338270cf0f682ac3d637407307c854a1dcb07119a8",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/intel/catpt/core.h",
  "human_readable_source": " \n \n\n#ifndef __SND_SOC_INTEL_CATPT_CORE_H\n#define __SND_SOC_INTEL_CATPT_CORE_H\n\n#include <linux/dma/dw.h>\n#include <linux/irqreturn.h>\n#include \"messages.h\"\n#include \"registers.h\"\n\nstruct catpt_dev;\n\nextern const struct attribute_group *catpt_attr_groups[];\n\nvoid catpt_sram_init(struct resource *sram, u32 start, u32 size);\nvoid catpt_sram_free(struct resource *sram);\nstruct resource *\ncatpt_request_region(struct resource *root, resource_size_t size);\n\nstruct catpt_ipc_msg {\n\tunion {\n\t\tu32 header;\n\t\tunion catpt_global_msg rsp;\n\t};\n\tvoid *data;\n\tsize_t size;\n};\n\nstruct catpt_ipc {\n\tstruct device *dev;\n\n\tstruct catpt_ipc_msg rx;\n\tstruct catpt_fw_ready config;\n\tu32 default_timeout;\n\tbool ready;\n\n\tspinlock_t lock;\n\tstruct mutex mutex;\n\tstruct completion done_completion;\n\tstruct completion busy_completion;\n};\n\nvoid catpt_ipc_init(struct catpt_ipc *ipc, struct device *dev);\n\nstruct catpt_module_type {\n\tbool loaded;\n\tu32 entry_point;\n\tu32 persistent_size;\n\tu32 scratch_size;\n\t \n\tu32 state_offset;\n\tu32 state_size;\n\n\tstruct list_head node;\n};\n\nstruct catpt_spec {\n\tstruct snd_soc_acpi_mach *machines;\n\tu8 core_id;\n\tu32 host_dram_offset;\n\tu32 host_iram_offset;\n\tu32 host_shim_offset;\n\tu32 host_dma_offset[CATPT_DMA_COUNT];\n\tu32 host_ssp_offset[CATPT_SSP_COUNT];\n\tu32 dram_mask;\n\tu32 iram_mask;\n\tu32 d3srampgd_bit;\n\tu32 d3pgd_bit;\n\tvoid (*pll_shutdown)(struct catpt_dev *cdev, bool enable);\n};\n\nstruct catpt_dev {\n\tstruct device *dev;\n\tstruct dw_dma_chip *dmac;\n\tstruct catpt_ipc ipc;\n\n\tvoid __iomem *pci_ba;\n\tvoid __iomem *lpe_ba;\n\tu32 lpe_base;\n\tint irq;\n\n\tconst struct catpt_spec *spec;\n\tstruct completion fw_ready;\n\n\tstruct resource dram;\n\tstruct resource iram;\n\tstruct resource *scratch;\n\n\tstruct catpt_mixer_stream_info mixer;\n\tstruct catpt_module_type modules[CATPT_MODULE_COUNT];\n\tstruct catpt_ssp_device_format devfmt[CATPT_SSP_COUNT];\n\tstruct list_head stream_list;\n\tspinlock_t list_lock;\n\tstruct mutex clk_mutex;\n\n\tstruct catpt_dx_context dx_ctx;\n\tvoid *dxbuf_vaddr;\n\tdma_addr_t dxbuf_paddr;\n};\n\nint catpt_dmac_probe(struct catpt_dev *cdev);\nvoid catpt_dmac_remove(struct catpt_dev *cdev);\nstruct dma_chan *catpt_dma_request_config_chan(struct catpt_dev *cdev);\nint catpt_dma_memcpy_todsp(struct catpt_dev *cdev, struct dma_chan *chan,\n\t\t\t   dma_addr_t dst_addr, dma_addr_t src_addr,\n\t\t\t   size_t size);\nint catpt_dma_memcpy_fromdsp(struct catpt_dev *cdev, struct dma_chan *chan,\n\t\t\t     dma_addr_t dst_addr, dma_addr_t src_addr,\n\t\t\t     size_t size);\n\nvoid lpt_dsp_pll_shutdown(struct catpt_dev *cdev, bool enable);\nvoid wpt_dsp_pll_shutdown(struct catpt_dev *cdev, bool enable);\nint catpt_dsp_power_up(struct catpt_dev *cdev);\nint catpt_dsp_power_down(struct catpt_dev *cdev);\nint catpt_dsp_stall(struct catpt_dev *cdev, bool stall);\nvoid catpt_dsp_update_srampge(struct catpt_dev *cdev, struct resource *sram,\n\t\t\t      unsigned long mask);\nint catpt_dsp_update_lpclock(struct catpt_dev *cdev);\nirqreturn_t catpt_dsp_irq_handler(int irq, void *dev_id);\nirqreturn_t catpt_dsp_irq_thread(int irq, void *dev_id);\n\n \n#define CATPT_IPC_ERROR(err) (((err) < 0) ? (err) : -EREMOTEIO)\n\nint catpt_dsp_send_msg_timeout(struct catpt_dev *cdev,\n\t\t\t       struct catpt_ipc_msg request,\n\t\t\t       struct catpt_ipc_msg *reply, int timeout);\nint catpt_dsp_send_msg(struct catpt_dev *cdev, struct catpt_ipc_msg request,\n\t\t       struct catpt_ipc_msg *reply);\n\nint catpt_first_boot_firmware(struct catpt_dev *cdev);\nint catpt_boot_firmware(struct catpt_dev *cdev, bool restore);\nint catpt_store_streams_context(struct catpt_dev *cdev, struct dma_chan *chan);\nint catpt_store_module_states(struct catpt_dev *cdev, struct dma_chan *chan);\nint catpt_store_memdumps(struct catpt_dev *cdev, struct dma_chan *chan);\nint catpt_coredump(struct catpt_dev *cdev);\n\n#include <sound/memalloc.h>\n#include <uapi/sound/asound.h>\n\nstruct snd_pcm_substream;\nstruct catpt_stream_template;\n\nstruct catpt_stream_runtime {\n\tstruct snd_pcm_substream *substream;\n\n\tstruct catpt_stream_template *template;\n\tstruct catpt_stream_info info;\n\tstruct resource *persistent;\n\tstruct snd_dma_buffer pgtbl;\n\n\tbool allocated;\n\tbool prepared;\n\n\tstruct list_head node;\n};\n\nint catpt_register_plat_component(struct catpt_dev *cdev);\nvoid catpt_stream_update_position(struct catpt_dev *cdev,\n\t\t\t\t  struct catpt_stream_runtime *stream,\n\t\t\t\t  struct catpt_notify_position *pos);\nstruct catpt_stream_runtime *\ncatpt_stream_find(struct catpt_dev *cdev, u8 stream_hw_id);\nint catpt_arm_stream_templates(struct catpt_dev *cdev);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}