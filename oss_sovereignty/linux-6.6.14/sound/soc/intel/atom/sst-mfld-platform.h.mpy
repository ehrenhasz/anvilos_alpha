{
  "module_name": "sst-mfld-platform.h",
  "hash_id": "4646b71123e6ec31150062c9320242b747030ab7079b125c7658adf72bfb0444",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/intel/atom/sst-mfld-platform.h",
  "human_readable_source": " \n \n\n#ifndef __SST_PLATFORMDRV_H__\n#define __SST_PLATFORMDRV_H__\n\n#include \"sst-mfld-dsp.h\"\n#include \"sst-atom-controls.h\"\n\nextern struct sst_device *sst;\nextern const struct snd_compress_ops sst_platform_compress_ops;\n\n#define DRV_NAME \"sst\"\n\n#define SST_MONO\t\t1\n#define SST_STEREO\t\t2\n#define SST_MAX_CAP\t\t5\n\n#define SST_MAX_BUFFER\t\t(800*1024)\n#define SST_MIN_BUFFER\t\t(800*1024)\n#define SST_MIN_PERIOD_BYTES\t32\n#define SST_MAX_PERIOD_BYTES\tSST_MAX_BUFFER\n#define SST_MIN_PERIODS\t\t2\n#define SST_MAX_PERIODS\t\t(1024*2)\n#define SST_FIFO_SIZE\t\t0\n\nstruct pcm_stream_info {\n\tint str_id;\n\tvoid *arg;\n\tvoid (*period_elapsed) (void *arg);\n\tunsigned long long buffer_ptr;\n\tunsigned long long pcm_delay;\n\tint sfreq;\n};\n\nenum sst_drv_status {\n\tSST_PLATFORM_INIT = 1,\n\tSST_PLATFORM_STARTED,\n\tSST_PLATFORM_RUNNING,\n\tSST_PLATFORM_PAUSED,\n\tSST_PLATFORM_DROPPED,\n};\n\nenum sst_stream_ops {\n\tSTREAM_OPS_PLAYBACK = 0,\n\tSTREAM_OPS_CAPTURE,\n};\n\nenum sst_audio_device_type {\n\tSND_SST_DEVICE_HEADSET = 1,\n\tSND_SST_DEVICE_IHF,\n\tSND_SST_DEVICE_VIBRA,\n\tSND_SST_DEVICE_HAPTIC,\n\tSND_SST_DEVICE_CAPTURE,\n\tSND_SST_DEVICE_COMPRESS,\n};\n\n \nstruct sst_pcm_params {\n\tu16 codec;\t \n\tu8 num_chan;\t \n\tu8 pcm_wd_sz;\t \n\tu32 reserved;\t \n\tu32 sfreq;\t \n\tu32 ring_buffer_size;\n\tu32 period_count;\t \n\tu32 ring_buffer_addr;\n};\n\nstruct sst_stream_params {\n\tu32 result;\n\tu32 stream_id;\n\tu8 codec;\n\tu8 ops;\n\tu8 stream_type;\n\tu8 device_type;\n\tstruct sst_pcm_params sparams;\n};\n\nstruct sst_compress_cb {\n\tvoid *param;\n\tvoid (*compr_cb)(void *param);\n\tvoid *drain_cb_param;\n\tvoid (*drain_notify)(void *param);\n};\n\nstruct compress_sst_ops {\n\tconst char *name;\n\tint (*open)(struct device *dev,\n\t\tstruct snd_sst_params *str_params, struct sst_compress_cb *cb);\n\tint (*stream_start)(struct device *dev, unsigned int str_id);\n\tint (*stream_drop)(struct device *dev, unsigned int str_id);\n\tint (*stream_drain)(struct device *dev, unsigned int str_id);\n\tint (*stream_partial_drain)(struct device *dev,\tunsigned int str_id);\n\tint (*stream_pause)(struct device *dev, unsigned int str_id);\n\tint (*stream_pause_release)(struct device *dev,\tunsigned int str_id);\n\n\tint (*tstamp)(struct device *dev, unsigned int str_id,\n\t\t\tstruct snd_compr_tstamp *tstamp);\n\tint (*ack)(struct device *dev, unsigned int str_id,\n\t\t\tunsigned long bytes);\n\tint (*close)(struct device *dev, unsigned int str_id);\n\tint (*get_caps)(struct snd_compr_caps *caps);\n\tint (*get_codec_caps)(struct snd_compr_codec_caps *codec);\n\tint (*set_metadata)(struct device *dev,\tunsigned int str_id,\n\t\t\tstruct snd_compr_metadata *mdata);\n\tint (*power)(struct device *dev, bool state);\n};\n\nstruct sst_ops {\n\tint (*open)(struct device *dev, struct snd_sst_params *str_param);\n\tint (*stream_init)(struct device *dev, struct pcm_stream_info *str_info);\n\tint (*stream_start)(struct device *dev, int str_id);\n\tint (*stream_drop)(struct device *dev, int str_id);\n\tint (*stream_pause)(struct device *dev, int str_id);\n\tint (*stream_pause_release)(struct device *dev, int str_id);\n\tint (*stream_read_tstamp)(struct device *dev, struct pcm_stream_info *str_info);\n\tint (*send_byte_stream)(struct device *dev, struct snd_sst_bytes_v2 *bytes);\n\tint (*close)(struct device *dev, unsigned int str_id);\n\tint (*power)(struct device *dev, bool state);\n};\n\nstruct sst_runtime_stream {\n\tint     stream_status;\n\tunsigned int id;\n\tsize_t bytes_written;\n\tstruct pcm_stream_info stream_info;\n\tstruct sst_ops *ops;\n\tstruct compress_sst_ops *compr_ops;\n\tspinlock_t\tstatus_lock;\n};\n\nstruct sst_device {\n\tchar *name;\n\tstruct device *dev;\n\tstruct sst_ops *ops;\n\tstruct platform_device *pdev;\n\tstruct compress_sst_ops *compr_ops;\n};\n\nstruct sst_data;\n\nint sst_dsp_init_v2_dpcm(struct snd_soc_component *component);\nint sst_send_pipe_gains(struct snd_soc_dai *dai, int stream, int mute);\nint send_ssp_cmd(struct snd_soc_dai *dai, const char *id, bool enable);\nint sst_handle_vb_timer(struct snd_soc_dai *dai, bool enable);\n\nvoid sst_set_stream_status(struct sst_runtime_stream *stream, int state);\nint sst_fill_stream_params(void *substream, const struct sst_data *ctx,\n\t\t\t   struct snd_sst_params *str_params, bool is_compress);\n\nstruct sst_algo_int_control_v2 {\n\tstruct soc_mixer_control mc;\n\tu16 module_id;  \n\tu16 pipe_id;  \n\tu16 instance_id;\n\tunsigned int value;  \n};\nstruct sst_data {\n\tstruct platform_device *pdev;\n\tstruct sst_platform_data *pdata;\n\tstruct snd_sst_bytes_v2 *byte_stream;\n\tstruct mutex lock;\n\tstruct snd_soc_card *soc_card;\n\tstruct sst_cmd_sba_hw_set_ssp ssp_cmd;\n};\nint sst_register_dsp(struct sst_device *dev);\nint sst_unregister_dsp(struct sst_device *dev);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}