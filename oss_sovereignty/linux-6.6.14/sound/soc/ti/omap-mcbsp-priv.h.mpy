{
  "module_name": "omap-mcbsp-priv.h",
  "hash_id": "d0a8818cbe585efda9c7e2ae12bf273bed4e942a9252cc9286b0b392fac1bde2",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/ti/omap-mcbsp-priv.h",
  "human_readable_source": " \n \n\n#ifndef __OMAP_MCBSP_PRIV_H__\n#define __OMAP_MCBSP_PRIV_H__\n\n#include <linux/platform_data/asoc-ti-mcbsp.h>\n\n#ifdef CONFIG_ARCH_OMAP1\n#define mcbsp_omap1()\t1\n#else\n#define mcbsp_omap1()\t0\n#endif\n\n \nenum {\n\t \n\tOMAP_MCBSP_REG_SPCR2 = 4,\n\tOMAP_MCBSP_REG_SPCR1,\n\tOMAP_MCBSP_REG_RCR2,\n\tOMAP_MCBSP_REG_RCR1,\n\tOMAP_MCBSP_REG_XCR2,\n\tOMAP_MCBSP_REG_XCR1,\n\tOMAP_MCBSP_REG_SRGR2,\n\tOMAP_MCBSP_REG_SRGR1,\n\tOMAP_MCBSP_REG_MCR2,\n\tOMAP_MCBSP_REG_MCR1,\n\tOMAP_MCBSP_REG_RCERA,\n\tOMAP_MCBSP_REG_RCERB,\n\tOMAP_MCBSP_REG_XCERA,\n\tOMAP_MCBSP_REG_XCERB,\n\tOMAP_MCBSP_REG_PCR0,\n\tOMAP_MCBSP_REG_RCERC,\n\tOMAP_MCBSP_REG_RCERD,\n\tOMAP_MCBSP_REG_XCERC,\n\tOMAP_MCBSP_REG_XCERD,\n\tOMAP_MCBSP_REG_RCERE,\n\tOMAP_MCBSP_REG_RCERF,\n\tOMAP_MCBSP_REG_XCERE,\n\tOMAP_MCBSP_REG_XCERF,\n\tOMAP_MCBSP_REG_RCERG,\n\tOMAP_MCBSP_REG_RCERH,\n\tOMAP_MCBSP_REG_XCERG,\n\tOMAP_MCBSP_REG_XCERH,\n\n\t \n\tOMAP_MCBSP_REG_DRR2 = 0,\n\tOMAP_MCBSP_REG_DRR1,\n\tOMAP_MCBSP_REG_DXR2,\n\tOMAP_MCBSP_REG_DXR1,\n\n\t \n\tOMAP_MCBSP_REG_DRR = 0,\n\tOMAP_MCBSP_REG_DXR = 2,\n\tOMAP_MCBSP_REG_SYSCON =\t35,\n\tOMAP_MCBSP_REG_THRSH2,\n\tOMAP_MCBSP_REG_THRSH1,\n\tOMAP_MCBSP_REG_IRQST = 40,\n\tOMAP_MCBSP_REG_IRQEN,\n\tOMAP_MCBSP_REG_WAKEUPEN,\n\tOMAP_MCBSP_REG_XCCR,\n\tOMAP_MCBSP_REG_RCCR,\n\tOMAP_MCBSP_REG_XBUFFSTAT,\n\tOMAP_MCBSP_REG_RBUFFSTAT,\n\tOMAP_MCBSP_REG_SSELCR,\n};\n\n \n#define RRST\t\t\tBIT(0)\n#define RRDY\t\t\tBIT(1)\n#define RFULL\t\t\tBIT(2)\n#define RSYNC_ERR\t\tBIT(3)\n#define RINTM(value)\t\t(((value) & 0x3) << 4)\t \n#define ABIS\t\t\tBIT(6)\n#define DXENA\t\t\tBIT(7)\n#define CLKSTP(value)\t\t(((value) & 0x3) << 11)\t \n#define RJUST(value)\t\t(((value) & 0x3) << 13)\t \n#define ALB\t\t\tBIT(15)\n#define DLB\t\t\tBIT(15)\n\n \n#define XRST\t\t\tBIT(0)\n#define XRDY\t\t\tBIT(1)\n#define XEMPTY\t\t\tBIT(2)\n#define XSYNC_ERR\t\tBIT(3)\n#define XINTM(value)\t\t(((value) & 0x3) << 4)\t \n#define GRST\t\t\tBIT(6)\n#define FRST\t\t\tBIT(7)\n#define SOFT\t\t\tBIT(8)\n#define FREE\t\t\tBIT(9)\n\n \n#define CLKRP\t\t\tBIT(0)\n#define CLKXP\t\t\tBIT(1)\n#define FSRP\t\t\tBIT(2)\n#define FSXP\t\t\tBIT(3)\n#define DR_STAT\t\t\tBIT(4)\n#define DX_STAT\t\t\tBIT(5)\n#define CLKS_STAT\t\tBIT(6)\n#define SCLKME\t\t\tBIT(7)\n#define CLKRM\t\t\tBIT(8)\n#define CLKXM\t\t\tBIT(9)\n#define FSRM\t\t\tBIT(10)\n#define FSXM\t\t\tBIT(11)\n#define RIOEN\t\t\tBIT(12)\n#define XIOEN\t\t\tBIT(13)\n#define IDLE_EN\t\t\tBIT(14)\n\n \n#define RWDLEN1(value)\t\t(((value) & 0x7) << 5)\t \n#define RFRLEN1(value)\t\t(((value) & 0x7f) << 8)\t \n\n \n#define XWDLEN1(value)\t\t(((value) & 0x7) << 5)\t \n#define XFRLEN1(value)\t\t(((value) & 0x7f) << 8)\t \n\n \n#define RDATDLY(value)\t\t((value) & 0x3)\t\t \n#define RFIG\t\t\tBIT(2)\n#define RCOMPAND(value)\t\t(((value) & 0x3) << 3)\t \n#define RWDLEN2(value)\t\t(((value) & 0x7) << 5)\t \n#define RFRLEN2(value)\t\t(((value) & 0x7f) << 8)\t \n#define RPHASE\t\t\tBIT(15)\n\n \n#define XDATDLY(value)\t\t((value) & 0x3)\t\t \n#define XFIG\t\t\tBIT(2)\n#define XCOMPAND(value)\t\t(((value) & 0x3) << 3)\t \n#define XWDLEN2(value)\t\t(((value) & 0x7) << 5)\t \n#define XFRLEN2(value)\t\t(((value) & 0x7f) << 8)\t \n#define XPHASE\t\t\tBIT(15)\n\n \n#define CLKGDV(value)\t\t((value) & 0x7f)\t\t \n#define FWID(value)\t\t(((value) & 0xff) << 8)\t \n\n \n#define FPER(value)\t\t((value) & 0x0fff)\t \n#define FSGM\t\t\tBIT(12)\n#define CLKSM\t\t\tBIT(13)\n#define CLKSP\t\t\tBIT(14)\n#define GSYNC\t\t\tBIT(15)\n\n \n#define RMCM\t\t\tBIT(0)\n#define RCBLK(value)\t\t(((value) & 0x7) << 2)\t \n#define RPABLK(value)\t\t(((value) & 0x3) << 5)\t \n#define RPBBLK(value)\t\t(((value) & 0x3) << 7)\t \n\n \n#define XMCM(value)\t\t((value) & 0x3)\t\t \n#define XCBLK(value)\t\t(((value) & 0x7) << 2)\t \n#define XPABLK(value)\t\t(((value) & 0x3) << 5)\t \n#define XPBBLK(value)\t\t(((value) & 0x3) << 7)\t \n\n \n#define XDISABLE\t\tBIT(0)\n#define XDMAEN\t\t\tBIT(3)\n#define DILB\t\t\tBIT(5)\n#define XFULL_CYCLE\t\tBIT(11)\n#define DXENDLY(value)\t\t(((value) & 0x3) << 12)\t \n#define PPCONNECT\t\tBIT(14)\n#define EXTCLKGATE\t\tBIT(15)\n\n \n#define RDISABLE\t\tBIT(0)\n#define RDMAEN\t\t\tBIT(3)\n#define RFULL_CYCLE\t\tBIT(11)\n\n \n#define SOFTRST\t\t\tBIT(1)\n#define ENAWAKEUP\t\tBIT(2)\n#define SIDLEMODE(value)\t(((value) & 0x3) << 3)\n#define CLOCKACTIVITY(value)\t(((value) & 0x3) << 8)\n\n \n#define MCBSP_DMA_MODE_ELEMENT\t\t0\n#define MCBSP_DMA_MODE_THRESHOLD\t1\n\n \n#define RSYNCERREN\t\tBIT(0)\n#define RFSREN\t\t\tBIT(1)\n#define REOFEN\t\t\tBIT(2)\n#define RRDYEN\t\t\tBIT(3)\n#define RUNDFLEN\t\tBIT(4)\n#define ROVFLEN\t\t\tBIT(5)\n#define XSYNCERREN\t\tBIT(7)\n#define XFSXEN\t\t\tBIT(8)\n#define XEOFEN\t\t\tBIT(9)\n#define XRDYEN\t\t\tBIT(10)\n#define XUNDFLEN\t\tBIT(11)\n#define XOVFLEN\t\t\tBIT(12)\n#define XEMPTYEOFEN\t\tBIT(14)\n\n \n#define CLKR_SRC_CLKR\t\t0  \n#define CLKR_SRC_CLKX\t\t1  \n#define FSR_SRC_FSR\t\t2  \n#define FSR_SRC_FSX\t\t3  \n\n \n#define MCBSP_CLKS_PRCM_SRC\t0\n#define MCBSP_CLKS_PAD_SRC\t1\n\n \nstruct omap_mcbsp_reg_cfg {\n\tu16 spcr2;\n\tu16 spcr1;\n\tu16 rcr2;\n\tu16 rcr1;\n\tu16 xcr2;\n\tu16 xcr1;\n\tu16 srgr2;\n\tu16 srgr1;\n\tu16 mcr2;\n\tu16 mcr1;\n\tu16 pcr0;\n\tu16 rcerc;\n\tu16 rcerd;\n\tu16 xcerc;\n\tu16 xcerd;\n\tu16 rcere;\n\tu16 rcerf;\n\tu16 xcere;\n\tu16 xcerf;\n\tu16 rcerg;\n\tu16 rcerh;\n\tu16 xcerg;\n\tu16 xcerh;\n\tu16 xccr;\n\tu16 rccr;\n};\n\nstruct omap_mcbsp_st_data;\n\nstruct omap_mcbsp {\n\tstruct device *dev;\n\tstruct clk *fclk;\n\tspinlock_t lock;\n\tunsigned long phys_base;\n\tunsigned long phys_dma_base;\n\tvoid __iomem *io_base;\n\tu8 id;\n\t \n\tint active;\n\tint configured;\n\tu8 free;\n\n\tint irq;\n\tint rx_irq;\n\tint tx_irq;\n\n\t \n\tstruct omap_mcbsp_platform_data *pdata;\n\tstruct omap_mcbsp_st_data *st_data;\n\tstruct omap_mcbsp_reg_cfg cfg_regs;\n\tstruct snd_dmaengine_dai_dma_data dma_data[2];\n\tunsigned int dma_req[2];\n\tint dma_op_mode;\n\tu16 max_tx_thres;\n\tu16 max_rx_thres;\n\tvoid *reg_cache;\n\tint reg_cache_size;\n\n\tunsigned int fmt;\n\tunsigned int in_freq;\n\tunsigned int latency[2];\n\tint clk_div;\n\tint wlen;\n\n\tstruct pm_qos_request pm_qos_req;\n};\n\nstatic inline void omap_mcbsp_write(struct omap_mcbsp *mcbsp, u16 reg, u32 val)\n{\n\tvoid __iomem *addr = mcbsp->io_base + reg * mcbsp->pdata->reg_step;\n\n\tif (mcbsp->pdata->reg_size == 2) {\n\t\t((u16 *)mcbsp->reg_cache)[reg] = (u16)val;\n\t\twritew_relaxed((u16)val, addr);\n\t} else {\n\t\t((u32 *)mcbsp->reg_cache)[reg] = val;\n\t\twritel_relaxed(val, addr);\n\t}\n}\n\nstatic inline int omap_mcbsp_read(struct omap_mcbsp *mcbsp, u16 reg,\n\t\t\t\t  bool from_cache)\n{\n\tvoid __iomem *addr = mcbsp->io_base + reg * mcbsp->pdata->reg_step;\n\n\tif (mcbsp->pdata->reg_size == 2) {\n\t\treturn !from_cache ? readw_relaxed(addr) :\n\t\t\t\t     ((u16 *)mcbsp->reg_cache)[reg];\n\t} else {\n\t\treturn !from_cache ? readl_relaxed(addr) :\n\t\t\t\t     ((u32 *)mcbsp->reg_cache)[reg];\n\t}\n}\n\n#define MCBSP_READ(mcbsp, reg) \\\n\t\tomap_mcbsp_read(mcbsp, OMAP_MCBSP_REG_##reg, 0)\n#define MCBSP_WRITE(mcbsp, reg, val) \\\n\t\tomap_mcbsp_write(mcbsp, OMAP_MCBSP_REG_##reg, val)\n#define MCBSP_READ_CACHE(mcbsp, reg) \\\n\t\tomap_mcbsp_read(mcbsp, OMAP_MCBSP_REG_##reg, 1)\n\n\n \nint omap_mcbsp_st_init(struct platform_device *pdev);\nint omap_mcbsp_st_start(struct omap_mcbsp *mcbsp);\nint omap_mcbsp_st_stop(struct omap_mcbsp *mcbsp);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}