{
  "module_name": "audio-graph-card2-custom-sample.c",
  "hash_id": "08a15aee47990fb8ab554d167746149227ef0342bdbe67bde61776f54c3f7a86",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/generic/audio-graph-card2-custom-sample.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include <linux/module.h>\n#include <linux/of_gpio.h>\n#include <linux/platform_device.h>\n#include <sound/graph_card.h>\n\n \nstruct custom_priv {\n\tstruct asoc_simple_priv simple_priv;\n\n\t \n\tint custom_params;\n};\n\n \n#define simple_to_custom(simple) container_of((simple), struct custom_priv, simple_priv)\n\nstatic int custom_card_probe(struct snd_soc_card *card)\n{\n\tstruct asoc_simple_priv *simple_priv = snd_soc_card_get_drvdata(card);\n\tstruct custom_priv *custom_priv = simple_to_custom(simple_priv);\n\tstruct device *dev = simple_priv_to_dev(simple_priv);\n\n\tdev_info(dev, \"custom probe\\n\");\n\n\tcustom_priv->custom_params = 1;\n\n\t \n\treturn asoc_graph_card_probe(card);\n}\n\nstatic int custom_hook_pre(struct asoc_simple_priv *priv)\n{\n\tstruct device *dev = simple_priv_to_dev(priv);\n\n\t \n\tdev_info(dev, \"hook : %s\\n\", __func__);\n\n\treturn 0;\n}\n\nstatic int custom_hook_post(struct asoc_simple_priv *priv)\n{\n\tstruct device *dev = simple_priv_to_dev(priv);\n\tstruct snd_soc_card *card;\n\n\t \n\tdev_info(dev, \"hook : %s\\n\", __func__);\n\n\t \n\tcard = simple_priv_to_card(priv);\n\tcard->probe = custom_card_probe;\n\n\treturn 0;\n}\n\nstatic int custom_normal(struct asoc_simple_priv *priv,\n\t\t\t struct device_node *lnk,\n\t\t\t struct link_info *li)\n{\n\tstruct device *dev = simple_priv_to_dev(priv);\n\n\t \n\tdev_info(dev, \"hook : %s\\n\", __func__);\n\n\treturn audio_graph2_link_normal(priv, lnk, li);\n}\n\nstatic int custom_dpcm(struct asoc_simple_priv *priv,\n\t\t       struct device_node *lnk,\n\t\t       struct link_info *li)\n{\n\tstruct device *dev = simple_priv_to_dev(priv);\n\n\t \n\tdev_info(dev, \"hook : %s\\n\", __func__);\n\n\treturn audio_graph2_link_dpcm(priv, lnk, li);\n}\n\nstatic int custom_c2c(struct asoc_simple_priv *priv,\n\t\t      struct device_node *lnk,\n\t\t      struct link_info *li)\n{\n\tstruct device *dev = simple_priv_to_dev(priv);\n\n\t \n\tdev_info(dev, \"hook : %s\\n\", __func__);\n\n\treturn audio_graph2_link_c2c(priv, lnk, li);\n}\n\n \nstatic struct graph2_custom_hooks custom_hooks = {\n\t.hook_pre\t= custom_hook_pre,\n\t.hook_post\t= custom_hook_post,\n\t.custom_normal\t= custom_normal,\n\t.custom_dpcm\t= custom_dpcm,\n\t.custom_c2c\t= custom_c2c,\n};\n\nstatic int custom_startup(struct snd_pcm_substream *substream)\n{\n\tstruct snd_soc_pcm_runtime *rtd = asoc_substream_to_rtd(substream);\n\tstruct asoc_simple_priv *priv = snd_soc_card_get_drvdata(rtd->card);\n\tstruct device *dev = simple_priv_to_dev(priv);\n\n\tdev_info(dev, \"custom startup\\n\");\n\n\treturn asoc_simple_startup(substream);\n}\n\n \nstatic const struct snd_soc_ops custom_ops = {\n\t.startup\t= custom_startup,\n\t.shutdown\t= asoc_simple_shutdown,\n\t.hw_params\t= asoc_simple_hw_params,\n};\n\nstatic int custom_probe(struct platform_device *pdev)\n{\n\tstruct custom_priv *custom_priv;\n\tstruct asoc_simple_priv *simple_priv;\n\tstruct device *dev = &pdev->dev;\n\tint ret;\n\n\tcustom_priv = devm_kzalloc(dev, sizeof(*custom_priv), GFP_KERNEL);\n\tif (!custom_priv)\n\t\treturn -ENOMEM;\n\n\tsimple_priv\t\t= &custom_priv->simple_priv;\n\tsimple_priv->ops\t= &custom_ops;  \n\n\t \n\tsimple_priv->snd_card.name = \"card2-custom\";\n\n\t \n\tret = audio_graph2_parse_of(simple_priv, dev, &custom_hooks);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\n\treturn 0;\n}\n\nstatic const struct of_device_id custom_of_match[] = {\n\t{ .compatible = \"audio-graph-card2-custom-sample\", },\n\t{},\n};\nMODULE_DEVICE_TABLE(of, custom_of_match);\n\nstatic struct platform_driver custom_card = {\n\t.driver = {\n\t\t.name = \"audio-graph-card2-custom-sample\",\n\t\t.of_match_table = custom_of_match,\n\t},\n\t.probe\t= custom_probe,\n\t.remove\t= asoc_simple_remove,\n};\nmodule_platform_driver(custom_card);\n\nMODULE_ALIAS(\"platform:asoc-audio-graph-card2-custom-sample\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_DESCRIPTION(\"ASoC Audio Graph Card2 Custom Sample\");\nMODULE_AUTHOR(\"Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}