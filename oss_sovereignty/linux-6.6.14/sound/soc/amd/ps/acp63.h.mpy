{
  "module_name": "acp63.h",
  "hash_id": "2d3cfa3a302f96b1de9a078f7f5e360f381f4319826b0976966974f9e2be3773",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/amd/ps/acp63.h",
  "human_readable_source": " \n \n\n#include <sound/acp63_chip_offset_byte.h>\n\n#define ACP_DEVICE_ID 0x15E2\n#define ACP63_REG_START\t\t0x1240000\n#define ACP63_REG_END\t\t0x1250200\n#define ACP63_DEVS\t\t5\n\n#define ACP_SOFT_RESET_SOFTRESET_AUDDONE_MASK\t0x00010001\n#define ACP_PGFSM_CNTL_POWER_ON_MASK\t1\n#define ACP_PGFSM_CNTL_POWER_OFF_MASK\t0\n#define ACP_PGFSM_STATUS_MASK\t\t3\n#define ACP_POWERED_ON\t\t\t0\n#define ACP_POWER_ON_IN_PROGRESS\t1\n#define ACP_POWERED_OFF\t\t2\n#define ACP_POWER_OFF_IN_PROGRESS\t3\n\n#define ACP_ERROR_MASK 0x20000000\n#define ACP_EXT_INTR_STAT_CLEAR_MASK 0xFFFFFFFF\n#define PDM_DMA_STAT 0x10\n\n#define PDM_DMA_INTR_MASK\t0x10000\n#define ACP_ERROR_STAT\t29\n#define PDM_DECIMATION_FACTOR\t2\n#define ACP_PDM_CLK_FREQ_MASK\t7\n#define ACP_WOV_GAIN_CONTROL\tGENMASK(4, 3)\n#define ACP_PDM_ENABLE\t\t1\n#define ACP_PDM_DISABLE\t\t0\n#define ACP_PDM_DMA_EN_STATUS\t2\n#define TWO_CH\t\t2\n#define DELAY_US\t5\n#define ACP_COUNTER\t20000\n\n#define ACP_SRAM_PTE_OFFSET\t0x03800000\n#define PAGE_SIZE_4K_ENABLE\t2\n#define PDM_PTE_OFFSET\t\t0\n#define PDM_MEM_WINDOW_START\t0x4000000\n\n#define CAPTURE_MIN_NUM_PERIODS     4\n#define CAPTURE_MAX_NUM_PERIODS     4\n#define CAPTURE_MAX_PERIOD_SIZE     8192\n#define CAPTURE_MIN_PERIOD_SIZE     4096\n\n#define MAX_BUFFER (CAPTURE_MAX_PERIOD_SIZE * CAPTURE_MAX_NUM_PERIODS)\n#define MIN_BUFFER MAX_BUFFER\n\n \n#define ACP_SUSPEND_DELAY_MS\t2000\n\n#define ACP_DMIC_DEV\t2\n\n \n#define ACP63_PDM_MODE_DEVS\t\t3\n\n \n#define ACP63_SDW0_MODE_DEVS\t\t2\n\n \n#define ACP63_SDW0_SDW1_MODE_DEVS\t3\n\n \n#define ACP63_SDW0_PDM_MODE_DEVS\t4\n\n \n#define ACP63_SDW0_SDW1_PDM_MODE_DEVS   5\n#define ACP63_DMIC_ADDR\t\t\t2\n#define ACP63_SDW_ADDR\t\t\t5\n#define AMD_SDW_MAX_MANAGERS\t\t2\n\n \n#define ACP_TIMEOUT\t\t500\n\n \n#define ACP63_PDM_DEV_CONFIG\t\tBIT(0)\n\n \n#define ACP63_SDW_DEV_CONFIG\t\tBIT(1)\n\n \n#define ACP63_SDW_PDM_DEV_CONFIG\tGENMASK(1, 0)\n#define ACP_SDW0_STAT\t\t\tBIT(21)\n#define ACP_SDW1_STAT\t\t\tBIT(2)\n#define ACP_ERROR_IRQ\t\t\tBIT(29)\n\n#define ACP_AUDIO0_TX_THRESHOLD\t\t0x1c\n#define ACP_AUDIO1_TX_THRESHOLD\t\t0x1a\n#define ACP_AUDIO2_TX_THRESHOLD\t\t0x18\n#define ACP_AUDIO0_RX_THRESHOLD\t\t0x1b\n#define ACP_AUDIO1_RX_THRESHOLD\t\t0x19\n#define ACP_AUDIO2_RX_THRESHOLD\t\t0x17\n#define ACP_P1_AUDIO1_TX_THRESHOLD\tBIT(6)\n#define ACP_P1_AUDIO1_RX_THRESHOLD\tBIT(5)\n#define ACP_SDW_DMA_IRQ_MASK\t\t0x1F800000\n#define ACP_P1_SDW_DMA_IRQ_MASK\t\t0x60\n#define ACP63_SDW0_DMA_MAX_STREAMS\t6\n#define ACP63_SDW1_DMA_MAX_STREAMS\t2\n#define ACP_P1_AUDIO_TX_THRESHOLD\t6\n\n \n#define SDW0_DMA_TX_IRQ_MASK(i)\t(ACP_AUDIO0_TX_THRESHOLD - (2 * (i)))\n#define SDW0_DMA_RX_IRQ_MASK(i)\t(ACP_AUDIO0_RX_THRESHOLD - (2 * ((i) - 3)))\n\n \n#define SDW1_DMA_IRQ_MASK(i)\t(ACP_P1_AUDIO_TX_THRESHOLD - (i))\n\n#define ACP_DELAY_US\t\t5\n#define ACP_SDW_RING_BUFF_ADDR_OFFSET (128 * 1024)\n#define SDW0_MEM_WINDOW_START\t0x4800000\n#define ACP_SDW_SRAM_PTE_OFFSET\t0x03800400\n#define SDW0_PTE_OFFSET\t\t0x400\n#define SDW_FIFO_SIZE\t\t0x100\n#define SDW_DMA_SIZE\t\t0x40\n#define ACP_SDW0_FIFO_OFFSET\t0x100\n#define ACP_SDW_PTE_OFFSET\t0x100\n#define SDW_FIFO_OFFSET\t\t0x100\n#define SDW_PTE_OFFSET(i)\t(SDW0_PTE_OFFSET + ((i) * 0x600))\n#define ACP_SDW_FIFO_OFFSET(i)\t(ACP_SDW0_FIFO_OFFSET + ((i) * 0x500))\n#define SDW_MEM_WINDOW_START(i)\t(SDW0_MEM_WINDOW_START + ((i) * 0xC0000))\n\n#define SDW_PLAYBACK_MIN_NUM_PERIODS    2\n#define SDW_PLAYBACK_MAX_NUM_PERIODS    8\n#define SDW_PLAYBACK_MAX_PERIOD_SIZE    8192\n#define SDW_PLAYBACK_MIN_PERIOD_SIZE    1024\n#define SDW_CAPTURE_MIN_NUM_PERIODS     2\n#define SDW_CAPTURE_MAX_NUM_PERIODS     8\n#define SDW_CAPTURE_MAX_PERIOD_SIZE     8192\n#define SDW_CAPTURE_MIN_PERIOD_SIZE     1024\n\n#define SDW_MAX_BUFFER (SDW_PLAYBACK_MAX_PERIOD_SIZE * SDW_PLAYBACK_MAX_NUM_PERIODS)\n#define SDW_MIN_BUFFER SDW_MAX_BUFFER\n\nenum acp_config {\n\tACP_CONFIG_0 = 0,\n\tACP_CONFIG_1,\n\tACP_CONFIG_2,\n\tACP_CONFIG_3,\n\tACP_CONFIG_4,\n\tACP_CONFIG_5,\n\tACP_CONFIG_6,\n\tACP_CONFIG_7,\n\tACP_CONFIG_8,\n\tACP_CONFIG_9,\n\tACP_CONFIG_10,\n\tACP_CONFIG_11,\n\tACP_CONFIG_12,\n\tACP_CONFIG_13,\n\tACP_CONFIG_14,\n\tACP_CONFIG_15,\n};\n\nenum amd_sdw0_channel {\n\tACP_SDW0_AUDIO0_TX = 0,\n\tACP_SDW0_AUDIO1_TX,\n\tACP_SDW0_AUDIO2_TX,\n\tACP_SDW0_AUDIO0_RX,\n\tACP_SDW0_AUDIO1_RX,\n\tACP_SDW0_AUDIO2_RX,\n};\n\nenum amd_sdw1_channel {\n\tACP_SDW1_AUDIO1_TX,\n\tACP_SDW1_AUDIO1_RX,\n};\n\nstruct pdm_stream_instance {\n\tu16 num_pages;\n\tu16 channels;\n\tdma_addr_t dma_addr;\n\tu64 bytescount;\n\tvoid __iomem *acp63_base;\n};\n\nstruct pdm_dev_data {\n\tu32 pdm_irq;\n\tvoid __iomem *acp63_base;\n\tstruct mutex *acp_lock;\n\tstruct snd_pcm_substream *capture_stream;\n};\n\nstruct sdw_dma_dev_data {\n\tvoid __iomem *acp_base;\n\tstruct mutex *acp_lock;  \n\tstruct snd_pcm_substream *sdw0_dma_stream[ACP63_SDW0_DMA_MAX_STREAMS];\n\tstruct snd_pcm_substream *sdw1_dma_stream[ACP63_SDW1_DMA_MAX_STREAMS];\n};\n\nstruct acp_sdw_dma_stream {\n\tu16 num_pages;\n\tu16 channels;\n\tu32 stream_id;\n\tu32 instance;\n\tdma_addr_t dma_addr;\n\tu64 bytescount;\n};\n\nunion acp_sdw_dma_count {\n\tstruct {\n\t\tu32 low;\n\t\tu32 high;\n\t} bcount;\n\tu64 bytescount;\n};\n\nstruct sdw_dma_ring_buf_reg {\n\tu32 reg_dma_size;\n\tu32 reg_fifo_addr;\n\tu32 reg_fifo_size;\n\tu32 reg_ring_buf_size;\n\tu32 reg_ring_buf_addr;\n\tu32 water_mark_size_reg;\n\tu32 pos_low_reg;\n\tu32 pos_high_reg;\n};\n\n \n\nstruct acp63_dev_data {\n\tvoid __iomem *acp63_base;\n\tstruct resource *res;\n\tstruct platform_device *pdev[ACP63_DEVS];\n\tstruct mutex acp_lock;  \n\tstruct fwnode_handle *sdw_fw_node;\n\tu16 pdev_config;\n\tu16 pdev_count;\n\tu16 pdm_dev_index;\n\tu8 sdw_manager_count;\n\tu16 sdw0_dev_index;\n\tu16 sdw1_dev_index;\n\tu16 sdw_dma_dev_index;\n\tu16 sdw0_dma_intr_stat[ACP63_SDW0_DMA_MAX_STREAMS];\n\tu16 sdw1_dma_intr_stat[ACP63_SDW1_DMA_MAX_STREAMS];\n\tbool acp_reset;\n};\n\nint snd_amd_acp_find_config(struct pci_dev *pci);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}