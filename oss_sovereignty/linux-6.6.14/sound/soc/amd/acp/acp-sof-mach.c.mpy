{
  "module_name": "acp-sof-mach.c",
  "hash_id": "7271e04bd996c3c85da4a047dcdd0256094005f63bab3bcc31ed3c03b842891d",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/amd/acp/acp-sof-mach.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n\n\n \n\n#include <sound/core.h>\n#include <sound/pcm_params.h>\n#include <sound/soc-acpi.h>\n#include <sound/soc-dapm.h>\n#include <linux/dmi.h>\n#include <linux/module.h>\n\n#include \"acp-mach.h\"\n\nstatic struct acp_card_drvdata sof_rt5682_rt1019_data = {\n\t.hs_cpu_id = I2S_SP,\n\t.amp_cpu_id = I2S_SP,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = RT5682,\n\t.amp_codec_id = RT1019,\n\t.dmic_codec_id = DMIC,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_rt5682_max_data = {\n\t.hs_cpu_id = I2S_SP,\n\t.amp_cpu_id = I2S_SP,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = RT5682,\n\t.amp_codec_id = MAX98360A,\n\t.dmic_codec_id = DMIC,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_rt5682s_rt1019_data = {\n\t.hs_cpu_id = I2S_SP,\n\t.amp_cpu_id = I2S_SP,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = RT5682S,\n\t.amp_codec_id = RT1019,\n\t.dmic_codec_id = DMIC,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_rt5682s_max_data = {\n\t.hs_cpu_id = I2S_SP,\n\t.amp_cpu_id = I2S_SP,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = RT5682S,\n\t.amp_codec_id = MAX98360A,\n\t.dmic_codec_id = DMIC,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_nau8825_data = {\n\t.hs_cpu_id = I2S_HS,\n\t.amp_cpu_id = I2S_HS,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = NAU8825,\n\t.amp_codec_id = MAX98360A,\n\t.dmic_codec_id = DMIC,\n\t.soc_mclk = true,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_rt5682s_hs_rt1019_data = {\n\t.hs_cpu_id = I2S_HS,\n\t.amp_cpu_id = I2S_HS,\n\t.dmic_cpu_id = DMIC,\n\t.hs_codec_id = RT5682S,\n\t.amp_codec_id = RT1019,\n\t.dmic_codec_id = DMIC,\n\t.soc_mclk = true,\n\t.tdm_mode = false,\n};\n\nstatic struct acp_card_drvdata sof_nau8821_max98388_data = {\n\t.hs_cpu_id = I2S_SP,\n\t.amp_cpu_id = I2S_HS,\n\t.dmic_cpu_id = NONE,\n\t.hs_codec_id = NAU8821,\n\t.amp_codec_id = MAX98388,\n\t.dmic_codec_id = NONE,\n\t.soc_mclk = true,\n\t.tdm_mode = false,\n};\n\nstatic int acp_sof_probe(struct platform_device *pdev)\n{\n\tstruct snd_soc_card *card = NULL;\n\tstruct device *dev = &pdev->dev;\n\tconst struct dmi_system_id *dmi_id;\n\tstruct acp_card_drvdata *acp_card_drvdata;\n\tint ret;\n\n\tif (!pdev->id_entry)\n\t\treturn -EINVAL;\n\n\tcard = devm_kzalloc(dev, sizeof(*card), GFP_KERNEL);\n\tif (!card)\n\t\treturn -ENOMEM;\n\n\tcard->dev = dev;\n\tcard->owner = THIS_MODULE;\n\tcard->name = pdev->id_entry->name;\n\tcard->drvdata = (struct acp_card_drvdata *)pdev->id_entry->driver_data;\n\t \n\n\tacp_card_drvdata = card->drvdata;\n\tdmi_id = dmi_first_match(acp_quirk_table);\n\tif (dmi_id && dmi_id->driver_data)\n\t\tacp_card_drvdata->tdm_mode = dmi_id->driver_data;\n\n\tacp_sofdsp_dai_links_create(card);\n\n\tret = devm_snd_soc_register_card(&pdev->dev, card);\n\tif (ret) {\n\t\tdev_err(&pdev->dev,\n\t\t\t\t\"devm_snd_soc_register_card(%s) failed: %d\\n\",\n\t\t\t\tcard->name, ret);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct platform_device_id board_ids[] = {\n\t{\n\t\t.name = \"rt5682-rt1019\",\n\t\t.driver_data = (kernel_ulong_t)&sof_rt5682_rt1019_data\n\t},\n\t{\n\t\t.name = \"rt5682-max\",\n\t\t.driver_data = (kernel_ulong_t)&sof_rt5682_max_data\n\t},\n\t{\n\t\t.name = \"rt5682s-max\",\n\t\t.driver_data = (kernel_ulong_t)&sof_rt5682s_max_data\n\t},\n\t{\n\t\t.name = \"rt5682s-rt1019\",\n\t\t.driver_data = (kernel_ulong_t)&sof_rt5682s_rt1019_data\n\t},\n\t{\n\t\t.name = \"nau8825-max\",\n\t\t.driver_data = (kernel_ulong_t)&sof_nau8825_data\n\t},\n\t{\n\t\t.name = \"rt5682s-hs-rt1019\",\n\t\t.driver_data = (kernel_ulong_t)&sof_rt5682s_hs_rt1019_data\n\t},\n\t{\n\t\t.name = \"nau8821-max\",\n\t\t.driver_data = (kernel_ulong_t)&sof_nau8821_max98388_data\n\t},\n\t{ }\n};\nstatic struct platform_driver acp_asoc_audio = {\n\t.driver = {\n\t\t.name = \"sof_mach\",\n\t\t.pm = &snd_soc_pm_ops,\n\t},\n\t.probe = acp_sof_probe,\n\t.id_table = board_ids,\n};\n\nmodule_platform_driver(acp_asoc_audio);\n\nMODULE_IMPORT_NS(SND_SOC_AMD_MACH);\nMODULE_DESCRIPTION(\"ACP chrome SOF audio support\");\nMODULE_ALIAS(\"platform:rt5682-rt1019\");\nMODULE_ALIAS(\"platform:rt5682-max\");\nMODULE_ALIAS(\"platform:rt5682s-max\");\nMODULE_ALIAS(\"platform:rt5682s-rt1019\");\nMODULE_ALIAS(\"platform:nau8825-max\");\nMODULE_ALIAS(\"platform:rt5682s-hs-rt1019\");\nMODULE_ALIAS(\"platform:nau8821-max\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}