{
  "module_name": "mt8186-afe-control.c",
  "hash_id": "677d6beb5f129a956f34bf42d587751af6a14c4f698a78589fa2ac9d5a5c6a16",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/mediatek/mt8186/mt8186-afe-control.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include \"mt8186-afe-common.h\"\n\nenum {\n\tMTK_AFE_RATE_8K = 0,\n\tMTK_AFE_RATE_11K,\n\tMTK_AFE_RATE_12K,\n\tMTK_AFE_RATE_384K,\n\tMTK_AFE_RATE_16K,\n\tMTK_AFE_RATE_22K,\n\tMTK_AFE_RATE_24K,\n\tMTK_AFE_RATE_352K,\n\tMTK_AFE_RATE_32K,\n\tMTK_AFE_RATE_44K,\n\tMTK_AFE_RATE_48K,\n\tMTK_AFE_RATE_88K,\n\tMTK_AFE_RATE_96K,\n\tMTK_AFE_RATE_176K,\n\tMTK_AFE_RATE_192K,\n\tMTK_AFE_RATE_260K,\n};\n\nenum {\n\tMTK_AFE_PCM_RATE_8K = 0,\n\tMTK_AFE_PCM_RATE_16K,\n\tMTK_AFE_PCM_RATE_32K,\n\tMTK_AFE_PCM_RATE_48K,\n};\n\nenum {\n\tMTK_AFE_TDM_RATE_8K = 0,\n\tMTK_AFE_TDM_RATE_12K,\n\tMTK_AFE_TDM_RATE_16K,\n\tMTK_AFE_TDM_RATE_24K,\n\tMTK_AFE_TDM_RATE_32K,\n\tMTK_AFE_TDM_RATE_48K,\n\tMTK_AFE_TDM_RATE_64K,\n\tMTK_AFE_TDM_RATE_96K,\n\tMTK_AFE_TDM_RATE_128K,\n\tMTK_AFE_TDM_RATE_192K,\n\tMTK_AFE_TDM_RATE_256K,\n\tMTK_AFE_TDM_RATE_384K,\n\tMTK_AFE_TDM_RATE_11K,\n\tMTK_AFE_TDM_RATE_22K,\n\tMTK_AFE_TDM_RATE_44K,\n\tMTK_AFE_TDM_RATE_88K,\n\tMTK_AFE_TDM_RATE_176K,\n\tMTK_AFE_TDM_RATE_352K,\n};\n\nenum {\n\tMTK_AFE_TDM_RELATCH_RATE_8K = 0,\n\tMTK_AFE_TDM_RELATCH_RATE_11K,\n\tMTK_AFE_TDM_RELATCH_RATE_12K,\n\tMTK_AFE_TDM_RELATCH_RATE_16K,\n\tMTK_AFE_TDM_RELATCH_RATE_22K,\n\tMTK_AFE_TDM_RELATCH_RATE_24K,\n\tMTK_AFE_TDM_RELATCH_RATE_32K,\n\tMTK_AFE_TDM_RELATCH_RATE_44K,\n\tMTK_AFE_TDM_RELATCH_RATE_48K,\n\tMTK_AFE_TDM_RELATCH_RATE_88K,\n\tMTK_AFE_TDM_RELATCH_RATE_96K,\n\tMTK_AFE_TDM_RELATCH_RATE_176K,\n\tMTK_AFE_TDM_RELATCH_RATE_192K,\n\tMTK_AFE_TDM_RELATCH_RATE_352K,\n\tMTK_AFE_TDM_RELATCH_RATE_384K,\n};\n\nunsigned int mt8186_general_rate_transform(struct device *dev, unsigned int rate)\n{\n\tswitch (rate) {\n\tcase 8000:\n\t\treturn MTK_AFE_RATE_8K;\n\tcase 11025:\n\t\treturn MTK_AFE_RATE_11K;\n\tcase 12000:\n\t\treturn MTK_AFE_RATE_12K;\n\tcase 16000:\n\t\treturn MTK_AFE_RATE_16K;\n\tcase 22050:\n\t\treturn MTK_AFE_RATE_22K;\n\tcase 24000:\n\t\treturn MTK_AFE_RATE_24K;\n\tcase 32000:\n\t\treturn MTK_AFE_RATE_32K;\n\tcase 44100:\n\t\treturn MTK_AFE_RATE_44K;\n\tcase 48000:\n\t\treturn MTK_AFE_RATE_48K;\n\tcase 88200:\n\t\treturn MTK_AFE_RATE_88K;\n\tcase 96000:\n\t\treturn MTK_AFE_RATE_96K;\n\tcase 176400:\n\t\treturn MTK_AFE_RATE_176K;\n\tcase 192000:\n\t\treturn MTK_AFE_RATE_192K;\n\tcase 260000:\n\t\treturn MTK_AFE_RATE_260K;\n\tcase 352800:\n\t\treturn MTK_AFE_RATE_352K;\n\tcase 384000:\n\t\treturn MTK_AFE_RATE_384K;\n\tdefault:\n\t\tdev_err(dev, \"%s(), rate %u invalid, use %d!!!\\n\",\n\t\t\t__func__, rate, MTK_AFE_RATE_48K);\n\t}\n\n\treturn MTK_AFE_RATE_48K;\n}\n\nstatic unsigned int tdm_rate_transform(struct device *dev, unsigned int rate)\n{\n\tswitch (rate) {\n\tcase 8000:\n\t\treturn MTK_AFE_TDM_RATE_8K;\n\tcase 11025:\n\t\treturn MTK_AFE_TDM_RATE_11K;\n\tcase 12000:\n\t\treturn MTK_AFE_TDM_RATE_12K;\n\tcase 16000:\n\t\treturn MTK_AFE_TDM_RATE_16K;\n\tcase 22050:\n\t\treturn MTK_AFE_TDM_RATE_22K;\n\tcase 24000:\n\t\treturn MTK_AFE_TDM_RATE_24K;\n\tcase 32000:\n\t\treturn MTK_AFE_TDM_RATE_32K;\n\tcase 44100:\n\t\treturn MTK_AFE_TDM_RATE_44K;\n\tcase 48000:\n\t\treturn MTK_AFE_TDM_RATE_48K;\n\tcase 64000:\n\t\treturn MTK_AFE_TDM_RATE_64K;\n\tcase 88200:\n\t\treturn MTK_AFE_TDM_RATE_88K;\n\tcase 96000:\n\t\treturn MTK_AFE_TDM_RATE_96K;\n\tcase 128000:\n\t\treturn MTK_AFE_TDM_RATE_128K;\n\tcase 176400:\n\t\treturn MTK_AFE_TDM_RATE_176K;\n\tcase 192000:\n\t\treturn MTK_AFE_TDM_RATE_192K;\n\tcase 256000:\n\t\treturn MTK_AFE_TDM_RATE_256K;\n\tcase 352800:\n\t\treturn MTK_AFE_TDM_RATE_352K;\n\tcase 384000:\n\t\treturn MTK_AFE_TDM_RATE_384K;\n\tdefault:\n\t\tdev_err(dev, \"%s(), rate %u invalid, use %d!!!\\n\",\n\t\t\t__func__, rate, MTK_AFE_TDM_RATE_48K);\n\t}\n\n\treturn MTK_AFE_TDM_RATE_48K;\n}\n\nstatic unsigned int pcm_rate_transform(struct device *dev, unsigned int rate)\n{\n\tswitch (rate) {\n\tcase 8000:\n\t\treturn MTK_AFE_PCM_RATE_8K;\n\tcase 16000:\n\t\treturn MTK_AFE_PCM_RATE_16K;\n\tcase 32000:\n\t\treturn MTK_AFE_PCM_RATE_32K;\n\tcase 48000:\n\t\treturn MTK_AFE_PCM_RATE_48K;\n\tdefault:\n\t\tdev_err(dev, \"%s(), rate %u invalid, use %d!!!\\n\",\n\t\t\t__func__, rate, MTK_AFE_PCM_RATE_48K);\n\t}\n\n\treturn MTK_AFE_PCM_RATE_48K;\n}\n\nunsigned int mt8186_tdm_relatch_rate_transform(struct device *dev, unsigned int rate)\n{\n\tswitch (rate) {\n\tcase 8000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_8K;\n\tcase 11025:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_11K;\n\tcase 12000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_12K;\n\tcase 16000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_16K;\n\tcase 22050:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_22K;\n\tcase 24000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_24K;\n\tcase 32000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_32K;\n\tcase 44100:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_44K;\n\tcase 48000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_48K;\n\tcase 88200:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_88K;\n\tcase 96000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_96K;\n\tcase 176400:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_176K;\n\tcase 192000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_192K;\n\tcase 352800:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_352K;\n\tcase 384000:\n\t\treturn MTK_AFE_TDM_RELATCH_RATE_384K;\n\tdefault:\n\t\tdev_err(dev, \"%s(), rate %u invalid, use %d!!!\\n\",\n\t\t\t__func__, rate, MTK_AFE_TDM_RELATCH_RATE_48K);\n\t}\n\n\treturn MTK_AFE_TDM_RELATCH_RATE_48K;\n}\n\nunsigned int mt8186_rate_transform(struct device *dev, unsigned int rate, int aud_blk)\n{\n\tswitch (aud_blk) {\n\tcase MT8186_DAI_PCM:\n\t\treturn pcm_rate_transform(dev, rate);\n\tcase MT8186_DAI_TDM_IN:\n\t\treturn tdm_rate_transform(dev, rate);\n\tdefault:\n\t\treturn mt8186_general_rate_transform(dev, rate);\n\t}\n}\n\nint mt8186_dai_set_priv(struct mtk_base_afe *afe, int id, int priv_size, const void *priv_data)\n{\n\tstruct mt8186_afe_private *afe_priv = afe->platform_priv;\n\tvoid *temp_data;\n\n\ttemp_data = devm_kzalloc(afe->dev,\n\t\t\t\t priv_size,\n\t\t\t\t GFP_KERNEL);\n\tif (!temp_data)\n\t\treturn -ENOMEM;\n\n\tif (priv_data)\n\t\tmemcpy(temp_data, priv_data, priv_size);\n\n\tafe_priv->dai_priv[id] = temp_data;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}