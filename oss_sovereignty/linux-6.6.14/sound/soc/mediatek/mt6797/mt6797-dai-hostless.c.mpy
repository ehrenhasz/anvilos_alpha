{
  "module_name": "mt6797-dai-hostless.c",
  "hash_id": "7b62d4d7fb3dbab266ac6e66ba47cfa61f1d5f1b766ccb869fd1fc47df0fa763",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/mediatek/mt6797/mt6797-dai-hostless.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include \"mt6797-afe-common.h\"\n\n \nstatic const struct snd_soc_dapm_route mtk_dai_hostless_routes[] = {\n\t \n\t{\"ADDA_DL_CH1\", \"ADDA_UL_CH1\", \"Hostless LPBK DL\"},\n\t{\"ADDA_DL_CH1\", \"ADDA_UL_CH2\", \"Hostless LPBK DL\"},\n\t{\"ADDA_DL_CH2\", \"ADDA_UL_CH1\", \"Hostless LPBK DL\"},\n\t{\"ADDA_DL_CH2\", \"ADDA_UL_CH2\", \"Hostless LPBK DL\"},\n\t{\"Hostless LPBK UL\", NULL, \"ADDA Capture\"},\n\n\t \n\t{\"ADDA_DL_CH1\", \"PCM_1_CAP_CH1\", \"Hostless Speech DL\"},\n\t{\"ADDA_DL_CH2\", \"PCM_1_CAP_CH1\", \"Hostless Speech DL\"},\n\t{\"ADDA_DL_CH2\", \"PCM_1_CAP_CH2\", \"Hostless Speech DL\"},\n\t{\"ADDA_DL_CH1\", \"PCM_2_CAP_CH1\", \"Hostless Speech DL\"},\n\t{\"ADDA_DL_CH2\", \"PCM_2_CAP_CH1\", \"Hostless Speech DL\"},\n\t{\"ADDA_DL_CH2\", \"PCM_2_CAP_CH2\", \"Hostless Speech DL\"},\n\t{\"PCM_1_PB_CH1\", \"ADDA_UL_CH1\", \"Hostless Speech DL\"},\n\t{\"PCM_1_PB_CH2\", \"ADDA_UL_CH2\", \"Hostless Speech DL\"},\n\t{\"PCM_2_PB_CH1\", \"ADDA_UL_CH1\", \"Hostless Speech DL\"},\n\t{\"PCM_2_PB_CH2\", \"ADDA_UL_CH2\", \"Hostless Speech DL\"},\n\n\t{\"Hostless Speech UL\", NULL, \"PCM 1 Capture\"},\n\t{\"Hostless Speech UL\", NULL, \"PCM 2 Capture\"},\n\t{\"Hostless Speech UL\", NULL, \"ADDA Capture\"},\n};\n\n \nstatic int mtk_dai_hostless_startup(struct snd_pcm_substream *substream,\n\t\t\t\t    struct snd_soc_dai *dai)\n{\n\tstruct mtk_base_afe *afe = snd_soc_dai_get_drvdata(dai);\n\n\treturn snd_soc_set_runtime_hwparams(substream, afe->mtk_afe_hardware);\n}\n\nstatic const struct snd_soc_dai_ops mtk_dai_hostless_ops = {\n\t.startup = mtk_dai_hostless_startup,\n};\n\n \n#define MTK_HOSTLESS_RATES (SNDRV_PCM_RATE_8000_48000 |\\\n\t\t\t   SNDRV_PCM_RATE_88200 |\\\n\t\t\t   SNDRV_PCM_RATE_96000 |\\\n\t\t\t   SNDRV_PCM_RATE_176400 |\\\n\t\t\t   SNDRV_PCM_RATE_192000)\n\n#define MTK_HOSTLESS_FORMATS (SNDRV_PCM_FMTBIT_S16_LE |\\\n\t\t\t     SNDRV_PCM_FMTBIT_S24_LE |\\\n\t\t\t     SNDRV_PCM_FMTBIT_S32_LE)\n\nstatic struct snd_soc_dai_driver mtk_dai_hostless_driver[] = {\n\t{\n\t\t.name = \"Hostless LPBK DAI\",\n\t\t.id = MT6797_DAI_HOSTLESS_LPBK,\n\t\t.playback = {\n\t\t\t.stream_name = \"Hostless LPBK DL\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MTK_HOSTLESS_RATES,\n\t\t\t.formats = MTK_HOSTLESS_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"Hostless LPBK UL\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MTK_HOSTLESS_RATES,\n\t\t\t.formats = MTK_HOSTLESS_FORMATS,\n\t\t},\n\t\t.ops = &mtk_dai_hostless_ops,\n\t},\n\t{\n\t\t.name = \"Hostless Speech DAI\",\n\t\t.id = MT6797_DAI_HOSTLESS_SPEECH,\n\t\t.playback = {\n\t\t\t.stream_name = \"Hostless Speech DL\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MTK_HOSTLESS_RATES,\n\t\t\t.formats = MTK_HOSTLESS_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"Hostless Speech UL\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MTK_HOSTLESS_RATES,\n\t\t\t.formats = MTK_HOSTLESS_FORMATS,\n\t\t},\n\t\t.ops = &mtk_dai_hostless_ops,\n\t},\n};\n\nint mt6797_dai_hostless_register(struct mtk_base_afe *afe)\n{\n\tstruct mtk_base_afe_dai *dai;\n\n\tdai = devm_kzalloc(afe->dev, sizeof(*dai), GFP_KERNEL);\n\tif (!dai)\n\t\treturn -ENOMEM;\n\n\tlist_add(&dai->list, &afe->sub_dais);\n\n\tdai->dai_drivers = mtk_dai_hostless_driver;\n\tdai->num_dai_drivers = ARRAY_SIZE(mtk_dai_hostless_driver);\n\n\tdai->dapm_routes = mtk_dai_hostless_routes;\n\tdai->num_dapm_routes = ARRAY_SIZE(mtk_dai_hostless_routes);\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}