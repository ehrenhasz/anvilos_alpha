{
  "module_name": "cq93vc.c",
  "hash_id": "ebe762be05446ad66188f1925ba1483af024685442c6168378655e07dbaa9a3f",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/cq93vc.c",
  "human_readable_source": "\n \n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/init.h>\n#include <linux/io.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/platform_device.h>\n#include <linux/device.h>\n#include <linux/slab.h>\n#include <linux/clk.h>\n#include <linux/mfd/davinci_voicecodec.h>\n#include <linux/spi/spi.h>\n\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/initval.h>\n\nstatic const struct snd_kcontrol_new cq93vc_snd_controls[] = {\n\tSOC_SINGLE(\"PGA Capture Volume\", DAVINCI_VC_REG05, 0, 0x03, 0),\n\tSOC_SINGLE(\"Mono DAC Playback Volume\", DAVINCI_VC_REG09, 0, 0x3f, 0),\n};\n\nstatic int cq93vc_mute(struct snd_soc_dai *dai, int mute, int direction)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tu8 reg;\n\n\tif (mute)\n\t\treg = DAVINCI_VC_REG09_MUTE;\n\telse\n\t\treg = 0;\n\n\tsnd_soc_component_update_bits(component, DAVINCI_VC_REG09, DAVINCI_VC_REG09_MUTE,\n\t\t\t    reg);\n\n\treturn 0;\n}\n\nstatic int cq93vc_set_dai_sysclk(struct snd_soc_dai *codec_dai,\n\t\t\t\t int clk_id, unsigned int freq, int dir)\n{\n\tswitch (freq) {\n\tcase 22579200:\n\tcase 27000000:\n\tcase 33868800:\n\t\treturn 0;\n\t}\n\n\treturn -EINVAL;\n}\n\nstatic int cq93vc_set_bias_level(struct snd_soc_component *component,\n\t\t\t\tenum snd_soc_bias_level level)\n{\n\tswitch (level) {\n\tcase SND_SOC_BIAS_ON:\n\t\tsnd_soc_component_write(component, DAVINCI_VC_REG12,\n\t\t\t     DAVINCI_VC_REG12_POWER_ALL_ON);\n\t\tbreak;\n\tcase SND_SOC_BIAS_PREPARE:\n\t\tbreak;\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tsnd_soc_component_write(component, DAVINCI_VC_REG12,\n\t\t\t     DAVINCI_VC_REG12_POWER_ALL_OFF);\n\t\tbreak;\n\tcase SND_SOC_BIAS_OFF:\n\t\t \n\t\tsnd_soc_component_write(component, DAVINCI_VC_REG12,\n\t\t\t     DAVINCI_VC_REG12_POWER_ALL_OFF);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n#define CQ93VC_RATES\t(SNDRV_PCM_RATE_8000 | SNDRV_PCM_RATE_16000)\n#define CQ93VC_FORMATS\t(SNDRV_PCM_FMTBIT_U8 | SNDRV_PCM_FMTBIT_S16_LE)\n\nstatic const struct snd_soc_dai_ops cq93vc_dai_ops = {\n\t.mute_stream\t= cq93vc_mute,\n\t.set_sysclk\t= cq93vc_set_dai_sysclk,\n\t.no_capture_mute = 1,\n};\n\nstatic struct snd_soc_dai_driver cq93vc_dai = {\n\t.name = \"cq93vc-hifi\",\n\t.playback = {\n\t\t.stream_name = \"Playback\",\n\t\t.channels_min = 1,\n\t\t.channels_max = 2,\n\t\t.rates = CQ93VC_RATES,\n\t\t.formats = CQ93VC_FORMATS,},\n\t.capture = {\n\t\t.stream_name = \"Capture\",\n\t\t.channels_min = 1,\n\t\t.channels_max = 2,\n\t\t.rates = CQ93VC_RATES,\n\t\t.formats = CQ93VC_FORMATS,},\n\t.ops = &cq93vc_dai_ops,\n};\n\nstatic int cq93vc_probe(struct snd_soc_component *component)\n{\n\tstruct davinci_vc *davinci_vc = component->dev->platform_data;\n\n\tsnd_soc_component_init_regmap(component, davinci_vc->regmap);\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_component_driver soc_component_dev_cq93vc = {\n\t.set_bias_level\t\t= cq93vc_set_bias_level,\n\t.probe\t\t\t= cq93vc_probe,\n\t.controls\t\t= cq93vc_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(cq93vc_snd_controls),\n\t.idle_bias_on\t\t= 1,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic int cq93vc_platform_probe(struct platform_device *pdev)\n{\n\treturn devm_snd_soc_register_component(&pdev->dev,\n\t\t\t&soc_component_dev_cq93vc, &cq93vc_dai, 1);\n}\n\nstatic struct platform_driver cq93vc_codec_driver = {\n\t.driver = {\n\t\t\t.name = \"cq93vc-codec\",\n\t},\n\n\t.probe = cq93vc_platform_probe,\n};\n\nmodule_platform_driver(cq93vc_codec_driver);\n\nMODULE_DESCRIPTION(\"Texas Instruments DaVinci ASoC CQ0093 Voice Codec Driver\");\nMODULE_AUTHOR(\"Miguel Aguilar\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}