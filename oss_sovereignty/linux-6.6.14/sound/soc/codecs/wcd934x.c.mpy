{
  "module_name": "wcd934x.c",
  "hash_id": "e1b94f4a65a103c1747620e0b6ebc909864a88714879ead6816420266aab6688",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/wcd934x.c",
  "human_readable_source": "\n\n\n#include <linux/clk.h>\n#include <linux/clk-provider.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/mfd/wcd934x/registers.h>\n#include <linux/mfd/wcd934x/wcd934x.h>\n#include <linux/module.h>\n#include <linux/mutex.h>\n#include <linux/of_clk.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n#include <linux/regulator/consumer.h>\n#include <linux/slab.h>\n#include <linux/slimbus.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/soc-dapm.h>\n#include <sound/tlv.h>\n#include \"wcd-clsh-v2.h\"\n#include \"wcd-mbhc-v2.h\"\n\n#define WCD934X_RATES_MASK (SNDRV_PCM_RATE_8000 | SNDRV_PCM_RATE_16000 |\\\n\t\t\t    SNDRV_PCM_RATE_32000 | SNDRV_PCM_RATE_48000 |\\\n\t\t\t    SNDRV_PCM_RATE_96000 | SNDRV_PCM_RATE_192000)\n \n#define WCD934X_FRAC_RATES_MASK (SNDRV_PCM_RATE_44100 | SNDRV_PCM_RATE_88200 |\\\n\t\t\t\t SNDRV_PCM_RATE_176400)\n#define WCD934X_FORMATS_S16_S24_LE (SNDRV_PCM_FMTBIT_S16_LE | \\\n\t\t\t\t    SNDRV_PCM_FMTBIT_S24_LE)\n\n \n#define SLAVE_PORT_WATER_MARK_6BYTES\t0\n#define SLAVE_PORT_WATER_MARK_9BYTES\t1\n#define SLAVE_PORT_WATER_MARK_12BYTES\t2\n#define SLAVE_PORT_WATER_MARK_15BYTES\t3\n#define SLAVE_PORT_WATER_MARK_SHIFT\t1\n#define SLAVE_PORT_ENABLE\t\t1\n#define SLAVE_PORT_DISABLE\t\t0\n#define WCD934X_SLIM_WATER_MARK_VAL \\\n\t((SLAVE_PORT_WATER_MARK_12BYTES << SLAVE_PORT_WATER_MARK_SHIFT) | \\\n\t (SLAVE_PORT_ENABLE))\n\n#define WCD934X_SLIM_NUM_PORT_REG\t3\n#define WCD934X_SLIM_PGD_PORT_INT_TX_EN0 (WCD934X_SLIM_PGD_PORT_INT_EN0 + 2)\n#define WCD934X_SLIM_IRQ_OVERFLOW\tBIT(0)\n#define WCD934X_SLIM_IRQ_UNDERFLOW\tBIT(1)\n#define WCD934X_SLIM_IRQ_PORT_CLOSED\tBIT(2)\n\n#define WCD934X_MCLK_CLK_12P288MHZ\t12288000\n#define WCD934X_MCLK_CLK_9P6MHZ\t\t9600000\n\n \n#define WCD9XXX_DMIC_SAMPLE_RATE_2P4MHZ 2400000\n#define WCD9XXX_DMIC_SAMPLE_RATE_4P8MHZ 4800000\n\n \n#define WCD9XXX_DMIC_SAMPLE_RATE_4P096MHZ 4096000\n\n#define WCD934X_DMIC_CLK_DIV_2\t\t0x0\n#define WCD934X_DMIC_CLK_DIV_3\t\t0x1\n#define WCD934X_DMIC_CLK_DIV_4\t\t0x2\n#define WCD934X_DMIC_CLK_DIV_6\t\t0x3\n#define WCD934X_DMIC_CLK_DIV_8\t\t0x4\n#define WCD934X_DMIC_CLK_DIV_16\t\t0x5\n#define WCD934X_DMIC_CLK_DRIVE_DEFAULT 0x02\n\n#define TX_HPF_CUT_OFF_FREQ_MASK\t0x60\n#define CF_MIN_3DB_4HZ\t\t\t0x0\n#define CF_MIN_3DB_75HZ\t\t\t0x1\n#define CF_MIN_3DB_150HZ\t\t0x2\n\n#define WCD934X_RX_START\t\t16\n#define WCD934X_NUM_INTERPOLATORS\t9\n#define WCD934X_RX_PATH_CTL_OFFSET\t20\n#define WCD934X_MAX_VALID_ADC_MUX\t13\n#define WCD934X_INVALID_ADC_MUX\t\t9\n\n#define WCD934X_SLIM_RX_CH(p) \\\n\t{.port = p + WCD934X_RX_START, .shift = p,}\n\n#define WCD934X_SLIM_TX_CH(p) \\\n\t{.port = p, .shift = p,}\n\n \n#define DSD_DISABLED_MASK   0\n#define SLNQ_DISABLED_MASK  1\n\n#define DSD_DISABLED   BIT(DSD_DISABLED_MASK)\n#define SLNQ_DISABLED  BIT(SLNQ_DISABLED_MASK)\n\n \n#define WCD_VERSION_WCD9340_1_0     0x400\n#define WCD_VERSION_WCD9341_1_0     0x410\n#define WCD_VERSION_WCD9340_1_1     0x401\n#define WCD_VERSION_WCD9341_1_1     0x411\n#define WCD934X_AMIC_PWR_LEVEL_LP\t0\n#define WCD934X_AMIC_PWR_LEVEL_DEFAULT\t1\n#define WCD934X_AMIC_PWR_LEVEL_HP\t2\n#define WCD934X_AMIC_PWR_LEVEL_HYBRID\t3\n#define WCD934X_AMIC_PWR_LVL_MASK\t0x60\n#define WCD934X_AMIC_PWR_LVL_SHIFT\t0x5\n\n#define WCD934X_DEC_PWR_LVL_MASK\t0x06\n#define WCD934X_DEC_PWR_LVL_LP\t\t0x02\n#define WCD934X_DEC_PWR_LVL_HP\t\t0x04\n#define WCD934X_DEC_PWR_LVL_DF\t\t0x00\n#define WCD934X_DEC_PWR_LVL_HYBRID WCD934X_DEC_PWR_LVL_DF\n\n#define WCD934X_DEF_MICBIAS_MV\t1800\n#define WCD934X_MAX_MICBIAS_MV\t2850\n\n#define WCD_IIR_FILTER_SIZE\t(sizeof(u32) * BAND_MAX)\n\n#define WCD_IIR_FILTER_CTL(xname, iidx, bidx) \\\n{ \\\n\t.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \\\n\t.info = wcd934x_iir_filter_info, \\\n\t.get = wcd934x_get_iir_band_audio_mixer, \\\n\t.put = wcd934x_put_iir_band_audio_mixer, \\\n\t.private_value = (unsigned long)&(struct wcd_iir_filter_ctl) { \\\n\t\t.iir_idx = iidx, \\\n\t\t.band_idx = bidx, \\\n\t\t.bytes_ext = {.max = WCD_IIR_FILTER_SIZE, }, \\\n\t} \\\n}\n\n \n#define WCD934X_ZDET_VAL_32             32000\n#define WCD934X_ZDET_VAL_400            400000\n#define WCD934X_ZDET_VAL_1200           1200000\n#define WCD934X_ZDET_VAL_100K           100000000\n \n#define WCD934X_ZDET_FLOATING_IMPEDANCE 0x0FFFFFFE\n\n#define WCD934X_ZDET_NUM_MEASUREMENTS   900\n#define WCD934X_MBHC_GET_C1(c)          ((c & 0xC000) >> 14)\n#define WCD934X_MBHC_GET_X1(x)          (x & 0x3FFF)\n \n#define WCD934X_MBHC_IS_SECOND_RAMP_REQUIRED(z) ((z > 400000) || (z < 32000))\n#define WCD934X_MBHC_ZDET_CONST         (86 * 16384)\n#define WCD934X_MBHC_MOISTURE_RREF      R_24_KOHM\n#define WCD934X_MBHC_MAX_BUTTONS\t(8)\n#define WCD_MBHC_HS_V_MAX           1600\n\n#define WCD934X_INTERPOLATOR_PATH(id)\t\t\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"IIR0\", \"IIR0\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP0\", \"IIR1\", \"IIR1\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"IIR0\", \"IIR0\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP1\", \"IIR1\", \"IIR1\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"IIR0\", \"IIR0\"},\t\t\\\n\t{\"RX INT\" #id \"_1 MIX1 INP2\", \"IIR1\", \"IIR1\"},\t\t\\\n\t{\"RX INT\" #id \"_1 MIX1\", NULL, \"RX INT\" #id \"_1 MIX1 INP0\"}, \\\n\t{\"RX INT\" #id \"_1 MIX1\", NULL, \"RX INT\" #id \"_1 MIX1 INP1\"}, \\\n\t{\"RX INT\" #id \"_1 MIX1\", NULL, \"RX INT\" #id \"_1 MIX1 INP2\"}, \\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"RX INT\" #id \"_2 MUX\", NULL, \"INT\" #id \"_CLK\"}, \\\n\t{\"RX INT\" #id \"_2 MUX\", NULL, \"DSMDEM\" #id \"_CLK\"}, \\\n\t{\"RX INT\" #id \"_2 INTERP\", NULL, \"RX INT\" #id \"_2 MUX\"},\t\\\n\t{\"RX INT\" #id \" SEC MIX\", NULL, \"RX INT\" #id \"_2 INTERP\"},\t\\\n\t{\"RX INT\" #id \"_1 INTERP\", NULL, \"RX INT\" #id \"_1 MIX1\"},\t\\\n\t{\"RX INT\" #id \"_1 INTERP\", NULL, \"INT\" #id \"_CLK\"},\t\\\n\t{\"RX INT\" #id \"_1 INTERP\", NULL, \"DSMDEM\" #id \"_CLK\"},\t\\\n\t{\"RX INT\" #id \" SEC MIX\", NULL, \"RX INT\" #id \"_1 INTERP\"}\n\n#define WCD934X_INTERPOLATOR_MIX2(id)\t\t\t\\\n\t{\"RX INT\" #id \" MIX2\", NULL, \"RX INT\" #id \" SEC MIX\"}, \\\n\t{\"RX INT\" #id \" MIX2\", NULL, \"RX INT\" #id \" MIX2 INP\"}\n\n#define WCD934X_SLIM_RX_AIF_PATH(id)\t\\\n\t{\"SLIM RX\"#id\" MUX\", \"AIF1_PB\", \"AIF1 PB\"},\t\\\n\t{\"SLIM RX\"#id\" MUX\", \"AIF2_PB\", \"AIF2 PB\"},\t\\\n\t{\"SLIM RX\"#id\" MUX\", \"AIF3_PB\", \"AIF3 PB\"},\t\\\n\t{\"SLIM RX\"#id\" MUX\", \"AIF4_PB\", \"AIF4 PB\"},   \\\n\t{\"SLIM RX\"#id, NULL, \"SLIM RX\"#id\" MUX\"}\n\n#define WCD934X_ADC_MUX(id) \\\n\t{\"ADC MUX\" #id, \"DMIC\", \"DMIC MUX\" #id },\t\\\n\t{\"ADC MUX\" #id, \"AMIC\", \"AMIC MUX\" #id },\t\\\n\t{\"DMIC MUX\" #id, \"DMIC0\", \"DMIC0\"},\t\t\\\n\t{\"DMIC MUX\" #id, \"DMIC1\", \"DMIC1\"},\t\t\\\n\t{\"DMIC MUX\" #id, \"DMIC2\", \"DMIC2\"},\t\t\\\n\t{\"DMIC MUX\" #id, \"DMIC3\", \"DMIC3\"},\t\t\\\n\t{\"DMIC MUX\" #id, \"DMIC4\", \"DMIC4\"},\t\t\\\n\t{\"DMIC MUX\" #id, \"DMIC5\", \"DMIC5\"},\t\t\\\n\t{\"AMIC MUX\" #id, \"ADC1\", \"ADC1\"},\t\t\\\n\t{\"AMIC MUX\" #id, \"ADC2\", \"ADC2\"},\t\t\\\n\t{\"AMIC MUX\" #id, \"ADC3\", \"ADC3\"},\t\t\\\n\t{\"AMIC MUX\" #id, \"ADC4\", \"ADC4\"}\n\n#define WCD934X_IIR_INP_MUX(id) \\\n\t{\"IIR\" #id, NULL, \"IIR\" #id \" INP0 MUX\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC0\", \"ADC MUX0\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC1\", \"ADC MUX1\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC2\", \"ADC MUX2\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC3\", \"ADC MUX3\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC4\", \"ADC MUX4\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC5\", \"ADC MUX5\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC6\", \"ADC MUX6\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC7\", \"ADC MUX7\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"DEC8\", \"ADC MUX8\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"IIR\" #id \" INP0 MUX\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"IIR\" #id, NULL, \"IIR\" #id \" INP1 MUX\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC0\", \"ADC MUX0\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC1\", \"ADC MUX1\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC2\", \"ADC MUX2\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC3\", \"ADC MUX3\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC4\", \"ADC MUX4\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC5\", \"ADC MUX5\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC6\", \"ADC MUX6\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC7\", \"ADC MUX7\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"DEC8\", \"ADC MUX8\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"IIR\" #id \" INP1 MUX\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"IIR\" #id, NULL, \"IIR\" #id \" INP2 MUX\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC0\", \"ADC MUX0\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC1\", \"ADC MUX1\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC2\", \"ADC MUX2\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC3\", \"ADC MUX3\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC4\", \"ADC MUX4\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC5\", \"ADC MUX5\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC6\", \"ADC MUX6\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC7\", \"ADC MUX7\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"DEC8\", \"ADC MUX8\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"IIR\" #id \" INP2 MUX\", \"RX7\", \"SLIM RX7\"},\t\\\n\t{\"IIR\" #id, NULL, \"IIR\" #id \" INP3 MUX\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC0\", \"ADC MUX0\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC1\", \"ADC MUX1\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC2\", \"ADC MUX2\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC3\", \"ADC MUX3\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC4\", \"ADC MUX4\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC5\", \"ADC MUX5\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC6\", \"ADC MUX6\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC7\", \"ADC MUX7\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"DEC8\", \"ADC MUX8\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX0\", \"SLIM RX0\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX1\", \"SLIM RX1\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX2\", \"SLIM RX2\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX3\", \"SLIM RX3\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX4\", \"SLIM RX4\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX5\", \"SLIM RX5\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX6\", \"SLIM RX6\"},\t\\\n\t{\"IIR\" #id \" INP3 MUX\", \"RX7\", \"SLIM RX7\"}\n\n#define WCD934X_SLIM_TX_AIF_PATH(id)\t\\\n\t{\"AIF1_CAP Mixer\", \"SLIM TX\" #id, \"SLIM TX\" #id },\t\\\n\t{\"AIF2_CAP Mixer\", \"SLIM TX\" #id, \"SLIM TX\" #id },\t\\\n\t{\"AIF3_CAP Mixer\", \"SLIM TX\" #id, \"SLIM TX\" #id },\t\\\n\t{\"SLIM TX\" #id, NULL, \"CDC_IF TX\" #id \" MUX\"}\n\n#define WCD934X_MAX_MICBIAS\tMIC_BIAS_4\n\nenum {\n\tSIDO_SOURCE_INTERNAL,\n\tSIDO_SOURCE_RCO_BG,\n};\n\nenum {\n\tINTERP_EAR = 0,\n\tINTERP_HPHL,\n\tINTERP_HPHR,\n\tINTERP_LO1,\n\tINTERP_LO2,\n\tINTERP_LO3_NA,  \n\tINTERP_LO4_NA,\n\tINTERP_SPKR1,  \n\tINTERP_SPKR2,  \n\tINTERP_MAX,\n};\n\nenum {\n\tWCD934X_RX0 = 0,\n\tWCD934X_RX1,\n\tWCD934X_RX2,\n\tWCD934X_RX3,\n\tWCD934X_RX4,\n\tWCD934X_RX5,\n\tWCD934X_RX6,\n\tWCD934X_RX7,\n\tWCD934X_RX8,\n\tWCD934X_RX9,\n\tWCD934X_RX10,\n\tWCD934X_RX11,\n\tWCD934X_RX12,\n\tWCD934X_RX_MAX,\n};\n\nenum {\n\tWCD934X_TX0 = 0,\n\tWCD934X_TX1,\n\tWCD934X_TX2,\n\tWCD934X_TX3,\n\tWCD934X_TX4,\n\tWCD934X_TX5,\n\tWCD934X_TX6,\n\tWCD934X_TX7,\n\tWCD934X_TX8,\n\tWCD934X_TX9,\n\tWCD934X_TX10,\n\tWCD934X_TX11,\n\tWCD934X_TX12,\n\tWCD934X_TX13,\n\tWCD934X_TX14,\n\tWCD934X_TX15,\n\tWCD934X_TX_MAX,\n};\n\nstruct wcd934x_slim_ch {\n\tu32 ch_num;\n\tu16 port;\n\tu16 shift;\n\tstruct list_head list;\n};\n\nstatic const struct wcd934x_slim_ch wcd934x_tx_chs[WCD934X_TX_MAX] = {\n\tWCD934X_SLIM_TX_CH(0),\n\tWCD934X_SLIM_TX_CH(1),\n\tWCD934X_SLIM_TX_CH(2),\n\tWCD934X_SLIM_TX_CH(3),\n\tWCD934X_SLIM_TX_CH(4),\n\tWCD934X_SLIM_TX_CH(5),\n\tWCD934X_SLIM_TX_CH(6),\n\tWCD934X_SLIM_TX_CH(7),\n\tWCD934X_SLIM_TX_CH(8),\n\tWCD934X_SLIM_TX_CH(9),\n\tWCD934X_SLIM_TX_CH(10),\n\tWCD934X_SLIM_TX_CH(11),\n\tWCD934X_SLIM_TX_CH(12),\n\tWCD934X_SLIM_TX_CH(13),\n\tWCD934X_SLIM_TX_CH(14),\n\tWCD934X_SLIM_TX_CH(15),\n};\n\nstatic const struct wcd934x_slim_ch wcd934x_rx_chs[WCD934X_RX_MAX] = {\n\tWCD934X_SLIM_RX_CH(0),\t  \n\tWCD934X_SLIM_RX_CH(1),\t  \n\tWCD934X_SLIM_RX_CH(2),\n\tWCD934X_SLIM_RX_CH(3),\n\tWCD934X_SLIM_RX_CH(4),\n\tWCD934X_SLIM_RX_CH(5),\n\tWCD934X_SLIM_RX_CH(6),\n\tWCD934X_SLIM_RX_CH(7),\n\tWCD934X_SLIM_RX_CH(8),\n\tWCD934X_SLIM_RX_CH(9),\n\tWCD934X_SLIM_RX_CH(10),\n\tWCD934X_SLIM_RX_CH(11),\n\tWCD934X_SLIM_RX_CH(12),\n};\n\n \nenum {\n\tIIR0 = 0,\n\tIIR1,\n\tIIR_MAX,\n};\n\n \nenum {\n\tBAND1 = 0,\n\tBAND2,\n\tBAND3,\n\tBAND4,\n\tBAND5,\n\tBAND_MAX,\n};\n\nenum {\n\tCOMPANDER_1,  \n\tCOMPANDER_2,  \n\tCOMPANDER_3,  \n\tCOMPANDER_4,  \n\tCOMPANDER_5,  \n\tCOMPANDER_6,  \n\tCOMPANDER_7,  \n\tCOMPANDER_8,  \n\tCOMPANDER_MAX,\n};\n\nenum {\n\tAIF1_PB = 0,\n\tAIF1_CAP,\n\tAIF2_PB,\n\tAIF2_CAP,\n\tAIF3_PB,\n\tAIF3_CAP,\n\tAIF4_PB,\n\tAIF4_VIFEED,\n\tAIF4_MAD_TX,\n\tNUM_CODEC_DAIS,\n};\n\nenum {\n\tINTn_1_INP_SEL_ZERO = 0,\n\tINTn_1_INP_SEL_DEC0,\n\tINTn_1_INP_SEL_DEC1,\n\tINTn_1_INP_SEL_IIR0,\n\tINTn_1_INP_SEL_IIR1,\n\tINTn_1_INP_SEL_RX0,\n\tINTn_1_INP_SEL_RX1,\n\tINTn_1_INP_SEL_RX2,\n\tINTn_1_INP_SEL_RX3,\n\tINTn_1_INP_SEL_RX4,\n\tINTn_1_INP_SEL_RX5,\n\tINTn_1_INP_SEL_RX6,\n\tINTn_1_INP_SEL_RX7,\n};\n\nenum {\n\tINTn_2_INP_SEL_ZERO = 0,\n\tINTn_2_INP_SEL_RX0,\n\tINTn_2_INP_SEL_RX1,\n\tINTn_2_INP_SEL_RX2,\n\tINTn_2_INP_SEL_RX3,\n\tINTn_2_INP_SEL_RX4,\n\tINTn_2_INP_SEL_RX5,\n\tINTn_2_INP_SEL_RX6,\n\tINTn_2_INP_SEL_RX7,\n\tINTn_2_INP_SEL_PROXIMITY,\n};\n\nenum {\n\tINTERP_MAIN_PATH,\n\tINTERP_MIX_PATH,\n};\n\nstruct interp_sample_rate {\n\tint sample_rate;\n\tint rate_val;\n};\n\nstatic struct interp_sample_rate sr_val_tbl[] = {\n\t{8000, 0x0},\n\t{16000, 0x1},\n\t{32000, 0x3},\n\t{48000, 0x4},\n\t{96000, 0x5},\n\t{192000, 0x6},\n\t{384000, 0x7},\n\t{44100, 0x9},\n\t{88200, 0xA},\n\t{176400, 0xB},\n\t{352800, 0xC},\n};\n\nstruct wcd934x_mbhc_zdet_param {\n\tu16 ldo_ctl;\n\tu16 noff;\n\tu16 nshift;\n\tu16 btn5;\n\tu16 btn6;\n\tu16 btn7;\n};\n\nstruct wcd_slim_codec_dai_data {\n\tstruct list_head slim_ch_list;\n\tstruct slim_stream_config sconfig;\n\tstruct slim_stream_runtime *sruntime;\n};\n\nstatic const struct regmap_range_cfg wcd934x_ifc_ranges[] = {\n\t{\n\t\t.name = \"WCD9335-IFC-DEV\",\n\t\t.range_min =  0x0,\n\t\t.range_max = 0xffff,\n\t\t.selector_reg = 0x800,\n\t\t.selector_mask = 0xfff,\n\t\t.selector_shift = 0,\n\t\t.window_start = 0x800,\n\t\t.window_len = 0x400,\n\t},\n};\n\nstatic struct regmap_config wcd934x_ifc_regmap_config = {\n\t.reg_bits = 16,\n\t.val_bits = 8,\n\t.max_register = 0xffff,\n\t.ranges = wcd934x_ifc_ranges,\n\t.num_ranges = ARRAY_SIZE(wcd934x_ifc_ranges),\n};\n\nstruct wcd934x_codec {\n\tstruct device *dev;\n\tstruct clk_hw hw;\n\tstruct clk *extclk;\n\tstruct regmap *regmap;\n\tstruct regmap *if_regmap;\n\tstruct slim_device *sdev;\n\tstruct slim_device *sidev;\n\tstruct wcd_clsh_ctrl *clsh_ctrl;\n\tstruct snd_soc_component *component;\n\tstruct wcd934x_slim_ch rx_chs[WCD934X_RX_MAX];\n\tstruct wcd934x_slim_ch tx_chs[WCD934X_TX_MAX];\n\tstruct wcd_slim_codec_dai_data dai[NUM_CODEC_DAIS];\n\tint rate;\n\tu32 version;\n\tu32 hph_mode;\n\tint num_rx_port;\n\tint num_tx_port;\n\tu32 tx_port_value[WCD934X_TX_MAX];\n\tu32 rx_port_value[WCD934X_RX_MAX];\n\tint sido_input_src;\n\tint dmic_0_1_clk_cnt;\n\tint dmic_2_3_clk_cnt;\n\tint dmic_4_5_clk_cnt;\n\tint dmic_sample_rate;\n\tint comp_enabled[COMPANDER_MAX];\n\tint sysclk_users;\n\tstruct mutex sysclk_mutex;\n\t \n\tstruct wcd_mbhc *mbhc;\n\tstruct wcd_mbhc_config mbhc_cfg;\n\tstruct wcd_mbhc_intr intr_ids;\n\tbool mbhc_started;\n\tstruct mutex micb_lock;\n\tu32 micb_ref[WCD934X_MAX_MICBIAS];\n\tu32 pullup_ref[WCD934X_MAX_MICBIAS];\n\tu32 micb1_mv;\n\tu32 micb2_mv;\n\tu32 micb3_mv;\n\tu32 micb4_mv;\n};\n\n#define to_wcd934x_codec(_hw) container_of(_hw, struct wcd934x_codec, hw)\n\nstruct wcd_iir_filter_ctl {\n\tunsigned int iir_idx;\n\tunsigned int band_idx;\n\tstruct soc_bytes_ext bytes_ext;\n};\n\nstatic const DECLARE_TLV_DB_SCALE(digital_gain, -8400, 100, -8400);\nstatic const DECLARE_TLV_DB_SCALE(line_gain, 0, 7, 1);\nstatic const DECLARE_TLV_DB_SCALE(analog_gain, 0, 25, 1);\nstatic const DECLARE_TLV_DB_SCALE(ear_pa_gain, 0, 150, 0);\n\n \nstatic const char * const cf_text[] = {\n\t\"CF_NEG_3DB_4HZ\", \"CF_NEG_3DB_75HZ\", \"CF_NEG_3DB_150HZ\"\n};\n\nstatic const char * const rx_cf_text[] = {\n\t\"CF_NEG_3DB_4HZ\", \"CF_NEG_3DB_75HZ\", \"CF_NEG_3DB_150HZ\",\n\t\"CF_NEG_3DB_0P48HZ\"\n};\n\nstatic const char * const rx_hph_mode_mux_text[] = {\n\t\"Class H Invalid\", \"Class-H Hi-Fi\", \"Class-H Low Power\", \"Class-AB\",\n\t\"Class-H Hi-Fi Low Power\"\n};\n\nstatic const char *const slim_rx_mux_text[] = {\n\t\"ZERO\", \"AIF1_PB\", \"AIF2_PB\", \"AIF3_PB\", \"AIF4_PB\",\n};\n\nstatic const char * const rx_int0_7_mix_mux_text[] = {\n\t\"ZERO\", \"RX0\", \"RX1\", \"RX2\", \"RX3\", \"RX4\", \"RX5\",\n\t\"RX6\", \"RX7\", \"PROXIMITY\"\n};\n\nstatic const char * const rx_int_mix_mux_text[] = {\n\t\"ZERO\", \"RX0\", \"RX1\", \"RX2\", \"RX3\", \"RX4\", \"RX5\",\n\t\"RX6\", \"RX7\"\n};\n\nstatic const char * const rx_prim_mix_text[] = {\n\t\"ZERO\", \"DEC0\", \"DEC1\", \"IIR0\", \"IIR1\", \"RX0\", \"RX1\", \"RX2\",\n\t\"RX3\", \"RX4\", \"RX5\", \"RX6\", \"RX7\"\n};\n\nstatic const char * const rx_sidetone_mix_text[] = {\n\t\"ZERO\", \"SRC0\", \"SRC1\", \"SRC_SUM\"\n};\n\nstatic const char * const iir_inp_mux_text[] = {\n\t\"ZERO\", \"DEC0\", \"DEC1\", \"DEC2\", \"DEC3\", \"DEC4\", \"DEC5\", \"DEC6\",\n\t\"DEC7\", \"DEC8\", \"RX0\", \"RX1\", \"RX2\", \"RX3\", \"RX4\", \"RX5\", \"RX6\", \"RX7\"\n};\n\nstatic const char * const rx_int_dem_inp_mux_text[] = {\n\t\"NORMAL_DSM_OUT\", \"CLSH_DSM_OUT\",\n};\n\nstatic const char * const rx_int0_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT0_1 MIX1\",\n};\n\nstatic const char * const rx_int1_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT1_1 MIX1\",\n};\n\nstatic const char * const rx_int2_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT2_1 MIX1\",\n};\n\nstatic const char * const rx_int3_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT3_1 MIX1\",\n};\n\nstatic const char * const rx_int4_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT4_1 MIX1\",\n};\n\nstatic const char * const rx_int7_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT7_1 MIX1\",\n};\n\nstatic const char * const rx_int8_1_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT8_1 MIX1\",\n};\n\nstatic const char * const rx_int0_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT0_2 MUX\",\n};\n\nstatic const char * const rx_int1_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT1_2 MUX\",\n};\n\nstatic const char * const rx_int2_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT2_2 MUX\",\n};\n\nstatic const char * const rx_int3_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT3_2 MUX\",\n};\n\nstatic const char * const rx_int4_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT4_2 MUX\",\n};\n\nstatic const char * const rx_int7_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT7_2 MUX\",\n};\n\nstatic const char * const rx_int8_2_interp_mux_text[] = {\n\t\"ZERO\", \"RX INT8_2 MUX\",\n};\n\nstatic const char * const dmic_mux_text[] = {\n\t\"ZERO\", \"DMIC0\", \"DMIC1\", \"DMIC2\", \"DMIC3\", \"DMIC4\", \"DMIC5\"\n};\n\nstatic const char * const amic_mux_text[] = {\n\t\"ZERO\", \"ADC1\", \"ADC2\", \"ADC3\", \"ADC4\"\n};\n\nstatic const char * const amic4_5_sel_text[] = {\n\t\"AMIC4\", \"AMIC5\"\n};\n\nstatic const char * const adc_mux_text[] = {\n\t\"DMIC\", \"AMIC\", \"ANC_FB_TUNE1\", \"ANC_FB_TUNE2\"\n};\n\nstatic const char * const cdc_if_tx0_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX0\", \"DEC0\", \"DEC0_192\"\n};\n\nstatic const char * const cdc_if_tx1_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX1\", \"DEC1\", \"DEC1_192\"\n};\n\nstatic const char * const cdc_if_tx2_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX2\", \"DEC2\", \"DEC2_192\"\n};\n\nstatic const char * const cdc_if_tx3_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX3\", \"DEC3\", \"DEC3_192\"\n};\n\nstatic const char * const cdc_if_tx4_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX4\", \"DEC4\", \"DEC4_192\"\n};\n\nstatic const char * const cdc_if_tx5_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX5\", \"DEC5\", \"DEC5_192\"\n};\n\nstatic const char * const cdc_if_tx6_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX6\", \"DEC6\", \"DEC6_192\"\n};\n\nstatic const char * const cdc_if_tx7_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX7\", \"DEC7\", \"DEC7_192\"\n};\n\nstatic const char * const cdc_if_tx8_mux_text[] = {\n\t\"ZERO\", \"RX_MIX_TX8\", \"DEC8\", \"DEC8_192\"\n};\n\nstatic const char * const cdc_if_tx9_mux_text[] = {\n\t\"ZERO\", \"DEC7\", \"DEC7_192\"\n};\n\nstatic const char * const cdc_if_tx10_mux_text[] = {\n\t\"ZERO\", \"DEC6\", \"DEC6_192\"\n};\n\nstatic const char * const cdc_if_tx11_mux_text[] = {\n\t\"DEC_0_5\", \"DEC_9_12\", \"MAD_AUDIO\", \"MAD_BRDCST\"\n};\n\nstatic const char * const cdc_if_tx11_inp1_mux_text[] = {\n\t\"ZERO\", \"DEC0\", \"DEC1\", \"DEC2\", \"DEC3\", \"DEC4\",\n\t\"DEC5\", \"RX_MIX_TX5\", \"DEC9_10\", \"DEC11_12\"\n};\n\nstatic const char * const cdc_if_tx13_mux_text[] = {\n\t\"CDC_DEC_5\", \"MAD_BRDCST\"\n};\n\nstatic const char * const cdc_if_tx13_inp1_mux_text[] = {\n\t\"ZERO\", \"DEC5\", \"DEC5_192\"\n};\n\nstatic const struct soc_enum cf_dec0_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX0_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX1_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec2_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX2_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec3_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX3_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec4_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX4_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec5_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX5_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec6_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX6_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec7_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX7_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_dec8_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX8_TX_PATH_CFG0, 5, 3, cf_text);\n\nstatic const struct soc_enum cf_int0_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX0_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int0_2_enum, WCD934X_CDC_RX0_RX_PATH_MIX_CFG, 2,\n\t\t     rx_cf_text);\n\nstatic const struct soc_enum cf_int1_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX1_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int1_2_enum, WCD934X_CDC_RX1_RX_PATH_MIX_CFG, 2,\n\t\t     rx_cf_text);\n\nstatic const struct soc_enum cf_int2_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX2_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int2_2_enum, WCD934X_CDC_RX2_RX_PATH_MIX_CFG, 2,\n\t\t     rx_cf_text);\n\nstatic const struct soc_enum cf_int3_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX3_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int3_2_enum, WCD934X_CDC_RX3_RX_PATH_MIX_CFG, 2,\n\t\t\t    rx_cf_text);\n\nstatic const struct soc_enum cf_int4_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX4_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int4_2_enum, WCD934X_CDC_RX4_RX_PATH_MIX_CFG, 2,\n\t\t\t    rx_cf_text);\n\nstatic const struct soc_enum cf_int7_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX7_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int7_2_enum, WCD934X_CDC_RX7_RX_PATH_MIX_CFG, 2,\n\t\t\t    rx_cf_text);\n\nstatic const struct soc_enum cf_int8_1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX8_RX_PATH_CFG2, 0, 4, rx_cf_text);\n\nstatic SOC_ENUM_SINGLE_DECL(cf_int8_2_enum, WCD934X_CDC_RX8_RX_PATH_MIX_CFG, 2,\n\t\t\t    rx_cf_text);\n\nstatic const struct soc_enum rx_hph_mode_mux_enum =\n\tSOC_ENUM_SINGLE_EXT(ARRAY_SIZE(rx_hph_mode_mux_text),\n\t\t\t    rx_hph_mode_mux_text);\n\nstatic const struct soc_enum slim_rx_mux_enum =\n\tSOC_ENUM_SINGLE_EXT(ARRAY_SIZE(slim_rx_mux_text), slim_rx_mux_text);\n\nstatic const struct soc_enum rx_int0_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT0_CFG1, 0, 10,\n\t\t\trx_int0_7_mix_mux_text);\n\nstatic const struct soc_enum rx_int1_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT1_CFG1, 0, 9,\n\t\t\trx_int_mix_mux_text);\n\nstatic const struct soc_enum rx_int2_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT2_CFG1, 0, 9,\n\t\t\trx_int_mix_mux_text);\n\nstatic const struct soc_enum rx_int3_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT3_CFG1, 0, 9,\n\t\t\trx_int_mix_mux_text);\n\nstatic const struct soc_enum rx_int4_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT4_CFG1, 0, 9,\n\t\t\trx_int_mix_mux_text);\n\nstatic const struct soc_enum rx_int7_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT7_CFG1, 0, 10,\n\t\t\trx_int0_7_mix_mux_text);\n\nstatic const struct soc_enum rx_int8_2_mux_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT8_CFG1, 0, 9,\n\t\t\trx_int_mix_mux_text);\n\nstatic const struct soc_enum rx_int0_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT0_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int0_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT0_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int0_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT0_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int1_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT1_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int1_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT1_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int1_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT1_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int2_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT2_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int2_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT2_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int2_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT2_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int3_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT3_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int3_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT3_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int3_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT3_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int4_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT4_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int4_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT4_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int4_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT4_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int7_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT7_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int7_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT7_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int7_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT7_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int8_1_mix_inp0_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT8_CFG0, 0, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int8_1_mix_inp1_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT8_CFG0, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int8_1_mix_inp2_chain_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_RX_INT8_CFG1, 4, 13,\n\t\t\trx_prim_mix_text);\n\nstatic const struct soc_enum rx_int0_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG0, 0, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum rx_int1_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG0, 2, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum rx_int2_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG0, 4, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum rx_int3_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG0, 6, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum rx_int4_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG1, 0, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum rx_int7_mix2_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX_INP_MUX_SIDETONE_SRC_CFG1, 2, 4,\n\t\t\trx_sidetone_mix_text);\n\nstatic const struct soc_enum iir0_inp0_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR0_MIX_CFG0,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir0_inp1_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR0_MIX_CFG1,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir0_inp2_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR0_MIX_CFG2,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir0_inp3_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR0_MIX_CFG3,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir1_inp0_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR1_MIX_CFG0,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir1_inp1_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR1_MIX_CFG1,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir1_inp2_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR1_MIX_CFG2,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum iir1_inp3_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_SIDETONE_IIR_INP_MUX_IIR1_MIX_CFG3,\n\t\t\t0, 18, iir_inp_mux_text);\n\nstatic const struct soc_enum rx_int0_dem_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX0_RX_PATH_SEC0, 0,\n\t\t\tARRAY_SIZE(rx_int_dem_inp_mux_text),\n\t\t\trx_int_dem_inp_mux_text);\n\nstatic const struct soc_enum rx_int1_dem_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX1_RX_PATH_SEC0, 0,\n\t\t\tARRAY_SIZE(rx_int_dem_inp_mux_text),\n\t\t\trx_int_dem_inp_mux_text);\n\nstatic const struct soc_enum rx_int2_dem_inp_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_RX2_RX_PATH_SEC0, 0,\n\t\t\tARRAY_SIZE(rx_int_dem_inp_mux_text),\n\t\t\trx_int_dem_inp_mux_text);\n\nstatic const struct soc_enum tx_adc_mux0_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1, 0,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG1, 0,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux2_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX2_CFG1, 0,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux3_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1, 0,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux4_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1, 2,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux5_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG1, 2,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux6_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX2_CFG1, 2,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux7_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1, 2,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\nstatic const struct soc_enum tx_adc_mux8_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG1, 4,\n\t\t\tARRAY_SIZE(adc_mux_text), adc_mux_text);\n\nstatic const struct soc_enum rx_int0_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2,\n\t\t\trx_int0_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int1_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2,\n\t\t\trx_int1_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int2_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2,\n\t\t\trx_int2_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int3_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int3_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int4_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int4_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int7_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int7_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int8_1_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int8_1_interp_mux_text);\n\nstatic const struct soc_enum rx_int0_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int0_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int1_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int1_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int2_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int2_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int3_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int3_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int4_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int4_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int7_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int7_2_interp_mux_text);\n\nstatic const struct soc_enum rx_int8_2_interp_mux_enum =\n\tSOC_ENUM_SINGLE(SND_SOC_NOPM,\t0, 2, rx_int8_2_interp_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux0_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux2_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX2_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux3_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux4_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux5_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX5_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux6_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX6_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux7_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX7_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_dmic_mux8_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX8_CFG0, 3, 7,\n\t\t\tdmic_mux_text);\n\nstatic const struct soc_enum tx_amic_mux0_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux1_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux2_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX2_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux3_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux4_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux5_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX5_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux6_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX6_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux7_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX7_CFG0, 0, 5,\n\t\t\tamic_mux_text);\nstatic const struct soc_enum tx_amic_mux8_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_TX_INP_MUX_ADC_MUX8_CFG0, 0, 5,\n\t\t\tamic_mux_text);\n\nstatic const struct soc_enum tx_amic4_5_enum =\n\tSOC_ENUM_SINGLE(WCD934X_TX_NEW_AMIC_4_5_SEL, 7, 2, amic4_5_sel_text);\n\nstatic const struct soc_enum cdc_if_tx0_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG0, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx0_mux_text), cdc_if_tx0_mux_text);\nstatic const struct soc_enum cdc_if_tx1_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG0, 2,\n\t\t\tARRAY_SIZE(cdc_if_tx1_mux_text), cdc_if_tx1_mux_text);\nstatic const struct soc_enum cdc_if_tx2_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG0, 4,\n\t\t\tARRAY_SIZE(cdc_if_tx2_mux_text), cdc_if_tx2_mux_text);\nstatic const struct soc_enum cdc_if_tx3_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG0, 6,\n\t\t\tARRAY_SIZE(cdc_if_tx3_mux_text), cdc_if_tx3_mux_text);\nstatic const struct soc_enum cdc_if_tx4_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG1, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx4_mux_text), cdc_if_tx4_mux_text);\nstatic const struct soc_enum cdc_if_tx5_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG1, 2,\n\t\t\tARRAY_SIZE(cdc_if_tx5_mux_text), cdc_if_tx5_mux_text);\nstatic const struct soc_enum cdc_if_tx6_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG1, 4,\n\t\t\tARRAY_SIZE(cdc_if_tx6_mux_text), cdc_if_tx6_mux_text);\nstatic const struct soc_enum cdc_if_tx7_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG1, 6,\n\t\t\tARRAY_SIZE(cdc_if_tx7_mux_text), cdc_if_tx7_mux_text);\nstatic const struct soc_enum cdc_if_tx8_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG2, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx8_mux_text), cdc_if_tx8_mux_text);\nstatic const struct soc_enum cdc_if_tx9_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG2, 2,\n\t\t\tARRAY_SIZE(cdc_if_tx9_mux_text), cdc_if_tx9_mux_text);\nstatic const struct soc_enum cdc_if_tx10_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG2, 4,\n\t\t\tARRAY_SIZE(cdc_if_tx10_mux_text), cdc_if_tx10_mux_text);\nstatic const struct soc_enum cdc_if_tx11_inp1_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG3, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx11_inp1_mux_text),\n\t\t\tcdc_if_tx11_inp1_mux_text);\nstatic const struct soc_enum cdc_if_tx11_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_DATA_HUB_SB_TX11_INP_CFG, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx11_mux_text), cdc_if_tx11_mux_text);\nstatic const struct soc_enum cdc_if_tx13_inp1_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_CDC_IF_ROUTER_TX_MUX_CFG3, 4,\n\t\t\tARRAY_SIZE(cdc_if_tx13_inp1_mux_text),\n\t\t\tcdc_if_tx13_inp1_mux_text);\nstatic const struct soc_enum cdc_if_tx13_mux_enum =\n\tSOC_ENUM_SINGLE(WCD934X_DATA_HUB_SB_TX13_INP_CFG, 0,\n\t\t\tARRAY_SIZE(cdc_if_tx13_mux_text), cdc_if_tx13_mux_text);\n\nstatic struct wcd_mbhc_field wcd_mbhc_fields[WCD_MBHC_REG_FUNC_MAX] = {\n\tWCD_MBHC_FIELD(WCD_MBHC_L_DET_EN, WCD934X_ANA_MBHC_MECH, 0x80),\n\tWCD_MBHC_FIELD(WCD_MBHC_GND_DET_EN, WCD934X_ANA_MBHC_MECH, 0x40),\n\tWCD_MBHC_FIELD(WCD_MBHC_MECH_DETECTION_TYPE, WCD934X_ANA_MBHC_MECH, 0x20),\n\tWCD_MBHC_FIELD(WCD_MBHC_MIC_CLAMP_CTL, WCD934X_MBHC_NEW_PLUG_DETECT_CTL, 0x30),\n\tWCD_MBHC_FIELD(WCD_MBHC_ELECT_DETECTION_TYPE, WCD934X_ANA_MBHC_ELECT, 0x08),\n\tWCD_MBHC_FIELD(WCD_MBHC_HS_L_DET_PULL_UP_CTRL, WCD934X_MBHC_NEW_PLUG_DETECT_CTL, 0xC0),\n\tWCD_MBHC_FIELD(WCD_MBHC_HS_L_DET_PULL_UP_COMP_CTRL, WCD934X_ANA_MBHC_MECH, 0x04),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_PLUG_TYPE, WCD934X_ANA_MBHC_MECH, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_GND_PLUG_TYPE, WCD934X_ANA_MBHC_MECH, 0x08),\n\tWCD_MBHC_FIELD(WCD_MBHC_SW_HPH_LP_100K_TO_GND, WCD934X_ANA_MBHC_MECH, 0x01),\n\tWCD_MBHC_FIELD(WCD_MBHC_ELECT_SCHMT_ISRC, WCD934X_ANA_MBHC_ELECT, 0x06),\n\tWCD_MBHC_FIELD(WCD_MBHC_FSM_EN, WCD934X_ANA_MBHC_ELECT, 0x80),\n\tWCD_MBHC_FIELD(WCD_MBHC_INSREM_DBNC, WCD934X_MBHC_NEW_PLUG_DETECT_CTL, 0x0F),\n\tWCD_MBHC_FIELD(WCD_MBHC_BTN_DBNC, WCD934X_MBHC_NEW_CTL_1, 0x03),\n\tWCD_MBHC_FIELD(WCD_MBHC_HS_VREF, WCD934X_MBHC_NEW_CTL_2, 0x03),\n\tWCD_MBHC_FIELD(WCD_MBHC_HS_COMP_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0x08),\n\tWCD_MBHC_FIELD(WCD_MBHC_IN2P_CLAMP_STATE, WCD934X_ANA_MBHC_RESULT_3, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_MIC_SCHMT_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0x20),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_SCHMT_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0x80),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHR_SCHMT_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0x40),\n\tWCD_MBHC_FIELD(WCD_MBHC_OCP_FSM_EN, WCD934X_HPH_OCP_CTL, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_BTN_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0x07),\n\tWCD_MBHC_FIELD(WCD_MBHC_BTN_ISRC_CTL, WCD934X_ANA_MBHC_ELECT, 0x70),\n\tWCD_MBHC_FIELD(WCD_MBHC_ELECT_RESULT, WCD934X_ANA_MBHC_RESULT_3, 0xFF),\n\tWCD_MBHC_FIELD(WCD_MBHC_MICB_CTRL, WCD934X_ANA_MICB2, 0xC0),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPH_CNP_WG_TIME, WCD934X_HPH_CNP_WG_TIME, 0xFF),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHR_PA_EN, WCD934X_ANA_HPH, 0x40),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_PA_EN, WCD934X_ANA_HPH, 0x80),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPH_PA_EN, WCD934X_ANA_HPH, 0xC0),\n\tWCD_MBHC_FIELD(WCD_MBHC_SWCH_LEVEL_REMOVE, WCD934X_ANA_MBHC_RESULT_3, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_ANC_DET_EN, WCD934X_MBHC_CTL_BCS, 0x02),\n\tWCD_MBHC_FIELD(WCD_MBHC_FSM_STATUS, WCD934X_MBHC_STATUS_SPARE_1, 0x01),\n\tWCD_MBHC_FIELD(WCD_MBHC_MUX_CTL, WCD934X_MBHC_NEW_CTL_2, 0x70),\n\tWCD_MBHC_FIELD(WCD_MBHC_MOISTURE_STATUS, WCD934X_MBHC_NEW_FSM_STATUS, 0x20),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHR_GND, WCD934X_HPH_PA_CTL2, 0x40),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_GND, WCD934X_HPH_PA_CTL2, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_OCP_DET_EN, WCD934X_HPH_L_TEST, 0x01),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHR_OCP_DET_EN, WCD934X_HPH_R_TEST, 0x01),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHL_OCP_STATUS, WCD934X_INTR_PIN1_STATUS0, 0x04),\n\tWCD_MBHC_FIELD(WCD_MBHC_HPHR_OCP_STATUS, WCD934X_INTR_PIN1_STATUS0, 0x08),\n\tWCD_MBHC_FIELD(WCD_MBHC_ADC_EN, WCD934X_MBHC_NEW_CTL_1, 0x08),\n\tWCD_MBHC_FIELD(WCD_MBHC_ADC_COMPLETE, WCD934X_MBHC_NEW_FSM_STATUS, 0x40),\n\tWCD_MBHC_FIELD(WCD_MBHC_ADC_TIMEOUT, WCD934X_MBHC_NEW_FSM_STATUS, 0x80),\n\tWCD_MBHC_FIELD(WCD_MBHC_ADC_RESULT, WCD934X_MBHC_NEW_ADC_RESULT, 0xFF),\n\tWCD_MBHC_FIELD(WCD_MBHC_MICB2_VOUT, WCD934X_ANA_MICB2, 0x3F),\n\tWCD_MBHC_FIELD(WCD_MBHC_ADC_MODE, WCD934X_MBHC_NEW_CTL_1, 0x10),\n\tWCD_MBHC_FIELD(WCD_MBHC_DETECTION_DONE, WCD934X_MBHC_NEW_CTL_1, 0x04),\n\tWCD_MBHC_FIELD(WCD_MBHC_ELECT_ISRC_EN, WCD934X_ANA_MBHC_ZDET, 0x02),\n};\n\nstatic int wcd934x_set_sido_input_src(struct wcd934x_codec *wcd, int sido_src)\n{\n\tif (sido_src == wcd->sido_input_src)\n\t\treturn 0;\n\n\tif (sido_src == SIDO_SOURCE_RCO_BG) {\n\t\tregmap_update_bits(wcd->regmap, WCD934X_ANA_RCO,\n\t\t\t\t   WCD934X_ANA_RCO_BG_EN_MASK,\n\t\t\t\t   WCD934X_ANA_RCO_BG_ENABLE);\n\t\tusleep_range(100, 110);\n\t}\n\twcd->sido_input_src = sido_src;\n\n\treturn 0;\n}\n\nstatic int wcd934x_enable_ana_bias_and_sysclk(struct wcd934x_codec *wcd)\n{\n\tmutex_lock(&wcd->sysclk_mutex);\n\n\tif (++wcd->sysclk_users != 1) {\n\t\tmutex_unlock(&wcd->sysclk_mutex);\n\t\treturn 0;\n\t}\n\tmutex_unlock(&wcd->sysclk_mutex);\n\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_BIAS_EN_MASK,\n\t\t\t   WCD934X_ANA_BIAS_EN);\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_PRECHRG_EN_MASK,\n\t\t\t   WCD934X_ANA_PRECHRG_EN);\n\t \n\tusleep_range(1000, 1100);\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_PRECHRG_EN_MASK, 0);\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_PRECHRG_MODE_MASK, 0);\n\n\t \n\n\tregmap_update_bits(wcd->regmap, WCD934X_CLK_SYS_MCLK_PRG,\n\t\t\t   WCD934X_EXT_CLK_BUF_EN_MASK,\n\t\t\t   WCD934X_EXT_CLK_BUF_EN);\n\tregmap_update_bits(wcd->regmap, WCD934X_CLK_SYS_MCLK_PRG,\n\t\t\t   WCD934X_EXT_CLK_DIV_RATIO_MASK,\n\t\t\t   WCD934X_EXT_CLK_DIV_BY_2);\n\tregmap_update_bits(wcd->regmap, WCD934X_CLK_SYS_MCLK_PRG,\n\t\t\t   WCD934X_MCLK_SRC_MASK,\n\t\t\t   WCD934X_MCLK_SRC_EXT_CLK);\n\tregmap_update_bits(wcd->regmap, WCD934X_CLK_SYS_MCLK_PRG,\n\t\t\t   WCD934X_MCLK_EN_MASK, WCD934X_MCLK_EN);\n\tregmap_update_bits(wcd->regmap,\n\t\t\t   WCD934X_CDC_CLK_RST_CTRL_FS_CNT_CONTROL,\n\t\t\t   WCD934X_CDC_FS_MCLK_CNT_EN_MASK,\n\t\t\t   WCD934X_CDC_FS_MCLK_CNT_ENABLE);\n\tregmap_update_bits(wcd->regmap,\n\t\t\t   WCD934X_CDC_CLK_RST_CTRL_MCLK_CONTROL,\n\t\t\t   WCD934X_MCLK_EN_MASK,\n\t\t\t   WCD934X_MCLK_EN);\n\tregmap_update_bits(wcd->regmap, WCD934X_CODEC_RPM_CLK_GATE,\n\t\t\t   WCD934X_CODEC_RPM_CLK_GATE_MASK, 0x0);\n\t \n\tusleep_range(10, 15);\n\n\twcd934x_set_sido_input_src(wcd, SIDO_SOURCE_RCO_BG);\n\n\treturn 0;\n}\n\nstatic int wcd934x_disable_ana_bias_and_syclk(struct wcd934x_codec *wcd)\n{\n\tmutex_lock(&wcd->sysclk_mutex);\n\tif (--wcd->sysclk_users != 0) {\n\t\tmutex_unlock(&wcd->sysclk_mutex);\n\t\treturn 0;\n\t}\n\tmutex_unlock(&wcd->sysclk_mutex);\n\n\tregmap_update_bits(wcd->regmap, WCD934X_CLK_SYS_MCLK_PRG,\n\t\t\t   WCD934X_EXT_CLK_BUF_EN_MASK |\n\t\t\t   WCD934X_MCLK_EN_MASK, 0x0);\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_BIAS_EN_MASK, 0);\n\tregmap_update_bits(wcd->regmap, WCD934X_ANA_BIAS,\n\t\t\t   WCD934X_ANA_PRECHRG_EN_MASK, 0);\n\n\treturn 0;\n}\n\nstatic int __wcd934x_cdc_mclk_enable(struct wcd934x_codec *wcd, bool enable)\n{\n\tint ret = 0;\n\n\tif (enable) {\n\t\tret = clk_prepare_enable(wcd->extclk);\n\n\t\tif (ret) {\n\t\t\tdev_err(wcd->dev, \"%s: ext clk enable failed\\n\",\n\t\t\t\t__func__);\n\t\t\treturn ret;\n\t\t}\n\t\tret = wcd934x_enable_ana_bias_and_sysclk(wcd);\n\t} else {\n\t\tint val;\n\n\t\tregmap_read(wcd->regmap, WCD934X_CDC_CLK_RST_CTRL_SWR_CONTROL,\n\t\t\t    &val);\n\n\t\t \n\t\tif (val & WCD934X_CDC_SWR_CLK_EN_MASK)\n\t\t\treturn 0;\n\n\t\twcd934x_disable_ana_bias_and_syclk(wcd);\n\t\tclk_disable_unprepare(wcd->extclk);\n\t}\n\n\treturn ret;\n}\n\nstatic int wcd934x_codec_enable_mclk(struct snd_soc_dapm_widget *w,\n\t\t\t\t     struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\treturn __wcd934x_cdc_mclk_enable(wcd, true);\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\treturn __wcd934x_cdc_mclk_enable(wcd, false);\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_get_version(struct wcd934x_codec *wcd)\n{\n\tint val1, val2, ver, ret;\n\tstruct regmap *regmap;\n\tu16 id_minor;\n\tu32 version_mask = 0;\n\n\tregmap = wcd->regmap;\n\tver = 0;\n\n\tret = regmap_bulk_read(regmap, WCD934X_CHIP_TIER_CTRL_CHIP_ID_BYTE0,\n\t\t\t       (u8 *)&id_minor, sizeof(u16));\n\n\tif (ret)\n\t\treturn ret;\n\n\tregmap_read(regmap, WCD934X_CHIP_TIER_CTRL_EFUSE_VAL_OUT14, &val1);\n\tregmap_read(regmap, WCD934X_CHIP_TIER_CTRL_EFUSE_VAL_OUT15, &val2);\n\n\tversion_mask |= (!!((u8)val1 & 0x80)) << DSD_DISABLED_MASK;\n\tversion_mask |= (!!((u8)val2 & 0x01)) << SLNQ_DISABLED_MASK;\n\n\tswitch (version_mask) {\n\tcase DSD_DISABLED | SLNQ_DISABLED:\n\t\tif (id_minor == 0)\n\t\t\tver = WCD_VERSION_WCD9340_1_0;\n\t\telse if (id_minor == 0x01)\n\t\t\tver = WCD_VERSION_WCD9340_1_1;\n\t\tbreak;\n\tcase SLNQ_DISABLED:\n\t\tif (id_minor == 0)\n\t\t\tver = WCD_VERSION_WCD9341_1_0;\n\t\telse if (id_minor == 0x01)\n\t\t\tver = WCD_VERSION_WCD9341_1_1;\n\t\tbreak;\n\t}\n\n\twcd->version = ver;\n\tdev_info(wcd->dev, \"WCD934X Minor:0x%x Version:0x%x\\n\", id_minor, ver);\n\n\treturn 0;\n}\n\nstatic void wcd934x_enable_efuse_sensing(struct wcd934x_codec *wcd)\n{\n\tint rc, val;\n\n\t__wcd934x_cdc_mclk_enable(wcd, true);\n\n\tregmap_update_bits(wcd->regmap,\n\t\t\t   WCD934X_CHIP_TIER_CTRL_EFUSE_CTL,\n\t\t\t   WCD934X_EFUSE_SENSE_STATE_MASK,\n\t\t\t   WCD934X_EFUSE_SENSE_STATE_DEF);\n\tregmap_update_bits(wcd->regmap,\n\t\t\t   WCD934X_CHIP_TIER_CTRL_EFUSE_CTL,\n\t\t\t   WCD934X_EFUSE_SENSE_EN_MASK,\n\t\t\t   WCD934X_EFUSE_SENSE_ENABLE);\n\t \n\tusleep_range(5000, 5500);\n\twcd934x_set_sido_input_src(wcd, SIDO_SOURCE_RCO_BG);\n\n\trc = regmap_read(wcd->regmap,\n\t\t\t WCD934X_CHIP_TIER_CTRL_EFUSE_STATUS, &val);\n\tif (rc || (!(val & 0x01)))\n\t\tWARN(1, \"%s: Efuse sense is not complete val=%x, ret=%d\\n\",\n\t\t     __func__, val, rc);\n\n\t__wcd934x_cdc_mclk_enable(wcd, false);\n}\n\nstatic int wcd934x_swrm_clock(struct wcd934x_codec *wcd, bool enable)\n{\n\tif (enable) {\n\t\t__wcd934x_cdc_mclk_enable(wcd, true);\n\t\tregmap_update_bits(wcd->regmap,\n\t\t\t\t   WCD934X_CDC_CLK_RST_CTRL_SWR_CONTROL,\n\t\t\t\t   WCD934X_CDC_SWR_CLK_EN_MASK,\n\t\t\t\t   WCD934X_CDC_SWR_CLK_ENABLE);\n\t} else {\n\t\tregmap_update_bits(wcd->regmap,\n\t\t\t\t   WCD934X_CDC_CLK_RST_CTRL_SWR_CONTROL,\n\t\t\t\t   WCD934X_CDC_SWR_CLK_EN_MASK, 0);\n\t\t__wcd934x_cdc_mclk_enable(wcd, false);\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_set_prim_interpolator_rate(struct snd_soc_dai *dai,\n\t\t\t\t\t      u8 rate_val, u32 rate)\n{\n\tstruct snd_soc_component *comp = dai->component;\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tstruct wcd934x_slim_ch *ch;\n\tu8 cfg0, cfg1, inp0_sel, inp1_sel, inp2_sel;\n\tint inp, j;\n\n\tlist_for_each_entry(ch, &wcd->dai[dai->id].slim_ch_list, list) {\n\t\tinp = ch->shift + INTn_1_INP_SEL_RX0;\n\t\t \n\t\tfor (j = 0; j < WCD934X_NUM_INTERPOLATORS; j++) {\n\t\t\t \n\t\t\tif (j == INTERP_LO3_NA || j == INTERP_LO4_NA)\n\t\t\t\tcontinue;\n\n\t\t\tcfg0 = snd_soc_component_read(comp,\n\t\t\t\t\tWCD934X_CDC_RX_INP_MUX_RX_INT_CFG0(j));\n\t\t\tcfg1 = snd_soc_component_read(comp,\n\t\t\t\t\tWCD934X_CDC_RX_INP_MUX_RX_INT_CFG1(j));\n\n\t\t\tinp0_sel = cfg0 &\n\t\t\t\t WCD934X_CDC_RX_INP_MUX_RX_INT_SEL_MASK;\n\t\t\tinp1_sel = (cfg0 >> 4) &\n\t\t\t\t WCD934X_CDC_RX_INP_MUX_RX_INT_SEL_MASK;\n\t\t\tinp2_sel = (cfg1 >> 4) &\n\t\t\t\t WCD934X_CDC_RX_INP_MUX_RX_INT_SEL_MASK;\n\n\t\t\tif ((inp0_sel == inp) ||  (inp1_sel == inp) ||\n\t\t\t    (inp2_sel == inp)) {\n\t\t\t\t \n\t\t\t\t \n\t\t\t\tif ((j == INTERP_EAR || j == INTERP_SPKR1 ||\n\t\t\t\t     j == INTERP_SPKR2) && rate == 44100)\n\t\t\t\t\tdev_err(wcd->dev,\n\t\t\t\t\t\t\"Cannot set 44.1KHz on INT%d\\n\",\n\t\t\t\t\t\tj);\n\t\t\t\telse\n\t\t\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\t      WCD934X_CDC_RX_PATH_CTL(j),\n\t\t\t\t\t      WCD934X_CDC_MIX_PCM_RATE_MASK,\n\t\t\t\t\t      rate_val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_set_mix_interpolator_rate(struct snd_soc_dai *dai,\n\t\t\t\t\t     int rate_val, u32 rate)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tstruct wcd934x_slim_ch *ch;\n\tint val, j;\n\n\tlist_for_each_entry(ch, &wcd->dai[dai->id].slim_ch_list, list) {\n\t\tfor (j = 0; j < WCD934X_NUM_INTERPOLATORS; j++) {\n\t\t\t \n\t\t\tif (j == INTERP_LO3_NA || j == INTERP_LO4_NA)\n\t\t\t\tcontinue;\n\t\t\tval = snd_soc_component_read(component,\n\t\t\t\t\tWCD934X_CDC_RX_INP_MUX_RX_INT_CFG1(j)) &\n\t\t\t\t\tWCD934X_CDC_RX_INP_MUX_RX_INT_SEL_MASK;\n\n\t\t\tif (val == (ch->shift + INTn_2_INP_SEL_RX0)) {\n\t\t\t\t \n\t\t\t\tif ((j == INTERP_EAR) &&\n\t\t\t\t    (rate_val < 0x4 ||\n\t\t\t\t     rate_val > 0x7)) {\n\t\t\t\t\tdev_err(component->dev,\n\t\t\t\t\t\t\"Invalid rate for AIF_PB DAI(%d)\\n\",\n\t\t\t\t\t\tdai->id);\n\t\t\t\t\treturn -EINVAL;\n\t\t\t\t}\n\n\t\t\t\tsnd_soc_component_update_bits(component,\n\t\t\t\t\t      WCD934X_CDC_RX_PATH_MIX_CTL(j),\n\t\t\t\t\t      WCD934X_CDC_MIX_PCM_RATE_MASK,\n\t\t\t\t\t      rate_val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_set_interpolator_rate(struct snd_soc_dai *dai,\n\t\t\t\t\t u32 sample_rate)\n{\n\tint rate_val = 0;\n\tint i, ret;\n\n\tfor (i = 0; i < ARRAY_SIZE(sr_val_tbl); i++) {\n\t\tif (sample_rate == sr_val_tbl[i].sample_rate) {\n\t\t\trate_val = sr_val_tbl[i].rate_val;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif ((i == ARRAY_SIZE(sr_val_tbl)) || (rate_val < 0)) {\n\t\tdev_err(dai->dev, \"Unsupported sample rate: %d\\n\", sample_rate);\n\t\treturn -EINVAL;\n\t}\n\n\tret = wcd934x_set_prim_interpolator_rate(dai, (u8)rate_val,\n\t\t\t\t\t\t sample_rate);\n\tif (ret)\n\t\treturn ret;\n\tret = wcd934x_set_mix_interpolator_rate(dai, (u8)rate_val,\n\t\t\t\t\t\tsample_rate);\n\n\treturn ret;\n}\n\nstatic int wcd934x_set_decimator_rate(struct snd_soc_dai *dai,\n\t\t\t\t      u8 rate_val, u32 rate)\n{\n\tstruct snd_soc_component *comp = dai->component;\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(comp);\n\tu8 shift = 0, shift_val = 0, tx_mux_sel;\n\tstruct wcd934x_slim_ch *ch;\n\tint tx_port, tx_port_reg;\n\tint decimator = -1;\n\n\tlist_for_each_entry(ch, &wcd->dai[dai->id].slim_ch_list, list) {\n\t\ttx_port = ch->port;\n\t\t \n\t\tswitch (tx_port) {\n\t\tcase 0 ...  3:\n\t\t\ttx_port_reg = WCD934X_CDC_IF_ROUTER_TX_MUX_CFG0;\n\t\t\tshift = (tx_port << 1);\n\t\t\tshift_val = 0x03;\n\t\t\tbreak;\n\t\tcase 4 ... 7:\n\t\t\ttx_port_reg = WCD934X_CDC_IF_ROUTER_TX_MUX_CFG1;\n\t\t\tshift = ((tx_port - 4) << 1);\n\t\t\tshift_val = 0x03;\n\t\t\tbreak;\n\t\tcase 8 ... 10:\n\t\t\ttx_port_reg = WCD934X_CDC_IF_ROUTER_TX_MUX_CFG2;\n\t\t\tshift = ((tx_port - 8) << 1);\n\t\t\tshift_val = 0x03;\n\t\t\tbreak;\n\t\tcase 11:\n\t\t\ttx_port_reg = WCD934X_CDC_IF_ROUTER_TX_MUX_CFG3;\n\t\t\tshift = 0;\n\t\t\tshift_val = 0x0F;\n\t\t\tbreak;\n\t\tcase 13:\n\t\t\ttx_port_reg = WCD934X_CDC_IF_ROUTER_TX_MUX_CFG3;\n\t\t\tshift = 4;\n\t\t\tshift_val = 0x03;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(wcd->dev, \"Invalid SLIM TX%u port DAI ID:%d\\n\",\n\t\t\t\ttx_port, dai->id);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\ttx_mux_sel = snd_soc_component_read(comp, tx_port_reg) &\n\t\t\t\t\t\t      (shift_val << shift);\n\n\t\ttx_mux_sel = tx_mux_sel >> shift;\n\t\tswitch (tx_port) {\n\t\tcase 0 ... 8:\n\t\t\tif ((tx_mux_sel == 0x2) || (tx_mux_sel == 0x3))\n\t\t\t\tdecimator = tx_port;\n\t\t\tbreak;\n\t\tcase 9 ... 10:\n\t\t\tif ((tx_mux_sel == 0x1) || (tx_mux_sel == 0x2))\n\t\t\t\tdecimator = ((tx_port == 9) ? 7 : 6);\n\t\t\tbreak;\n\t\tcase 11:\n\t\t\tif ((tx_mux_sel >= 1) && (tx_mux_sel < 7))\n\t\t\t\tdecimator = tx_mux_sel - 1;\n\t\t\tbreak;\n\t\tcase 13:\n\t\t\tif ((tx_mux_sel == 0x1) || (tx_mux_sel == 0x2))\n\t\t\t\tdecimator = 5;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(wcd->dev, \"ERROR: Invalid tx_port: %d\\n\",\n\t\t\t\ttx_port);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_CDC_TX_PATH_CTL(decimator),\n\t\t\t\t      WCD934X_CDC_TX_PATH_CTL_PCM_RATE_MASK,\n\t\t\t\t      rate_val);\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_slim_set_hw_params(struct wcd934x_codec *wcd,\n\t\t\t\t      struct wcd_slim_codec_dai_data *dai_data,\n\t\t\t\t      int direction)\n{\n\tstruct list_head *slim_ch_list = &dai_data->slim_ch_list;\n\tstruct slim_stream_config *cfg = &dai_data->sconfig;\n\tstruct wcd934x_slim_ch *ch;\n\tu16 payload = 0;\n\tint ret, i;\n\n\tcfg->ch_count = 0;\n\tcfg->direction = direction;\n\tcfg->port_mask = 0;\n\n\t \n\tlist_for_each_entry(ch, slim_ch_list, list) {\n\t\tcfg->ch_count++;\n\t\tpayload |= 1 << ch->shift;\n\t\tcfg->port_mask |= BIT(ch->port);\n\t}\n\n\tcfg->chs = kcalloc(cfg->ch_count, sizeof(unsigned int), GFP_KERNEL);\n\tif (!cfg->chs)\n\t\treturn -ENOMEM;\n\n\ti = 0;\n\tlist_for_each_entry(ch, slim_ch_list, list) {\n\t\tcfg->chs[i++] = ch->ch_num;\n\t\tif (direction == SNDRV_PCM_STREAM_PLAYBACK) {\n\t\t\t \n\t\t\tret = regmap_write(wcd->if_regmap,\n\t\t\t   WCD934X_SLIM_PGD_RX_PORT_MULTI_CHNL_0(ch->port),\n\t\t\t   payload);\n\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err;\n\n\t\t\t \n\t\t\tret = regmap_write(wcd->if_regmap,\n\t\t\t\t\tWCD934X_SLIM_PGD_RX_PORT_CFG(ch->port),\n\t\t\t\t\tWCD934X_SLIM_WATER_MARK_VAL);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err;\n\t\t} else {\n\t\t\tret = regmap_write(wcd->if_regmap,\n\t\t\t\tWCD934X_SLIM_PGD_TX_PORT_MULTI_CHNL_0(ch->port),\n\t\t\t\tpayload & 0x00FF);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err;\n\n\t\t\t \n\t\t\tret = regmap_write(wcd->if_regmap,\n\t\t\t\tWCD934X_SLIM_PGD_TX_PORT_MULTI_CHNL_1(ch->port),\n\t\t\t\t(payload & 0xFF00) >> 8);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err;\n\n\t\t\t \n\t\t\tret = regmap_write(wcd->if_regmap,\n\t\t\t\t\tWCD934X_SLIM_PGD_TX_PORT_CFG(ch->port),\n\t\t\t\t\tWCD934X_SLIM_WATER_MARK_VAL);\n\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err;\n\t\t}\n\t}\n\n\tdai_data->sruntime = slim_stream_allocate(wcd->sdev, \"WCD934x-SLIM\");\n\n\treturn 0;\n\nerr:\n\tdev_err(wcd->dev, \"Error Setting slim hw params\\n\");\n\tkfree(cfg->chs);\n\tcfg->chs = NULL;\n\n\treturn ret;\n}\n\nstatic int wcd934x_hw_params(struct snd_pcm_substream *substream,\n\t\t\t     struct snd_pcm_hw_params *params,\n\t\t\t     struct snd_soc_dai *dai)\n{\n\tstruct wcd934x_codec *wcd;\n\tint ret, tx_fs_rate = 0;\n\n\twcd = snd_soc_component_get_drvdata(dai->component);\n\n\tswitch (substream->stream) {\n\tcase SNDRV_PCM_STREAM_PLAYBACK:\n\t\tret = wcd934x_set_interpolator_rate(dai, params_rate(params));\n\t\tif (ret) {\n\t\t\tdev_err(wcd->dev, \"cannot set sample rate: %u\\n\",\n\t\t\t\tparams_rate(params));\n\t\t\treturn ret;\n\t\t}\n\t\tswitch (params_width(params)) {\n\t\tcase 16 ... 24:\n\t\t\twcd->dai[dai->id].sconfig.bps = params_width(params);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(wcd->dev, \"Invalid format 0x%x\\n\",\n\t\t\t\tparams_width(params));\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\n\tcase SNDRV_PCM_STREAM_CAPTURE:\n\t\tswitch (params_rate(params)) {\n\t\tcase 8000:\n\t\t\ttx_fs_rate = 0;\n\t\t\tbreak;\n\t\tcase 16000:\n\t\t\ttx_fs_rate = 1;\n\t\t\tbreak;\n\t\tcase 32000:\n\t\t\ttx_fs_rate = 3;\n\t\t\tbreak;\n\t\tcase 48000:\n\t\t\ttx_fs_rate = 4;\n\t\t\tbreak;\n\t\tcase 96000:\n\t\t\ttx_fs_rate = 5;\n\t\t\tbreak;\n\t\tcase 192000:\n\t\t\ttx_fs_rate = 6;\n\t\t\tbreak;\n\t\tcase 384000:\n\t\t\ttx_fs_rate = 7;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(wcd->dev, \"Invalid TX sample rate: %d\\n\",\n\t\t\t\tparams_rate(params));\n\t\t\treturn -EINVAL;\n\n\t\t}\n\n\t\tret = wcd934x_set_decimator_rate(dai, tx_fs_rate,\n\t\t\t\t\t\t params_rate(params));\n\t\tif (ret < 0) {\n\t\t\tdev_err(wcd->dev, \"Cannot set TX Decimator rate\\n\");\n\t\t\treturn ret;\n\t\t}\n\t\tswitch (params_width(params)) {\n\t\tcase 16 ... 32:\n\t\t\twcd->dai[dai->id].sconfig.bps = params_width(params);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(wcd->dev, \"Invalid format 0x%x\\n\",\n\t\t\t\tparams_width(params));\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tdev_err(wcd->dev, \"Invalid stream type %d\\n\",\n\t\t\tsubstream->stream);\n\t\treturn -EINVAL;\n\t}\n\n\twcd->dai[dai->id].sconfig.rate = params_rate(params);\n\n\treturn wcd934x_slim_set_hw_params(wcd, &wcd->dai[dai->id], substream->stream);\n}\n\nstatic int wcd934x_hw_free(struct snd_pcm_substream *substream,\n\t\t\t   struct snd_soc_dai *dai)\n{\n\tstruct wcd_slim_codec_dai_data *dai_data;\n\tstruct wcd934x_codec *wcd;\n\n\twcd = snd_soc_component_get_drvdata(dai->component);\n\n\tdai_data = &wcd->dai[dai->id];\n\n\tkfree(dai_data->sconfig.chs);\n\n\treturn 0;\n}\n\nstatic int wcd934x_trigger(struct snd_pcm_substream *substream, int cmd,\n\t\t\t   struct snd_soc_dai *dai)\n{\n\tstruct wcd_slim_codec_dai_data *dai_data;\n\tstruct wcd934x_codec *wcd;\n\tstruct slim_stream_config *cfg;\n\n\twcd = snd_soc_component_get_drvdata(dai->component);\n\n\tdai_data = &wcd->dai[dai->id];\n\n\tswitch (cmd) {\n\tcase SNDRV_PCM_TRIGGER_START:\n\tcase SNDRV_PCM_TRIGGER_RESUME:\n\tcase SNDRV_PCM_TRIGGER_PAUSE_RELEASE:\n\t\tcfg = &dai_data->sconfig;\n\t\tslim_stream_prepare(dai_data->sruntime, cfg);\n\t\tslim_stream_enable(dai_data->sruntime);\n\t\tbreak;\n\tcase SNDRV_PCM_TRIGGER_STOP:\n\tcase SNDRV_PCM_TRIGGER_SUSPEND:\n\tcase SNDRV_PCM_TRIGGER_PAUSE_PUSH:\n\t\tslim_stream_disable(dai_data->sruntime);\n\t\tslim_stream_unprepare(dai_data->sruntime);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_set_channel_map(struct snd_soc_dai *dai,\n\t\t\t\t   unsigned int tx_num, unsigned int *tx_slot,\n\t\t\t\t   unsigned int rx_num, unsigned int *rx_slot)\n{\n\tstruct wcd934x_codec *wcd;\n\tint i;\n\n\twcd = snd_soc_component_get_drvdata(dai->component);\n\n\tif (tx_num > WCD934X_TX_MAX || rx_num > WCD934X_RX_MAX) {\n\t\tdev_err(wcd->dev, \"Invalid tx %d or rx %d channel count\\n\",\n\t\t\ttx_num, rx_num);\n\t\treturn -EINVAL;\n\t}\n\n\tif (!tx_slot || !rx_slot) {\n\t\tdev_err(wcd->dev, \"Invalid tx_slot=%p, rx_slot=%p\\n\",\n\t\t\ttx_slot, rx_slot);\n\t\treturn -EINVAL;\n\t}\n\n\twcd->num_rx_port = rx_num;\n\tfor (i = 0; i < rx_num; i++) {\n\t\twcd->rx_chs[i].ch_num = rx_slot[i];\n\t\tINIT_LIST_HEAD(&wcd->rx_chs[i].list);\n\t}\n\n\twcd->num_tx_port = tx_num;\n\tfor (i = 0; i < tx_num; i++) {\n\t\twcd->tx_chs[i].ch_num = tx_slot[i];\n\t\tINIT_LIST_HEAD(&wcd->tx_chs[i].list);\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_get_channel_map(struct snd_soc_dai *dai,\n\t\t\t\t   unsigned int *tx_num, unsigned int *tx_slot,\n\t\t\t\t   unsigned int *rx_num, unsigned int *rx_slot)\n{\n\tstruct wcd934x_slim_ch *ch;\n\tstruct wcd934x_codec *wcd;\n\tint i = 0;\n\n\twcd = snd_soc_component_get_drvdata(dai->component);\n\n\tswitch (dai->id) {\n\tcase AIF1_PB:\n\tcase AIF2_PB:\n\tcase AIF3_PB:\n\tcase AIF4_PB:\n\t\tif (!rx_slot || !rx_num) {\n\t\t\tdev_err(wcd->dev, \"Invalid rx_slot %p or rx_num %p\\n\",\n\t\t\t\trx_slot, rx_num);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tlist_for_each_entry(ch, &wcd->dai[dai->id].slim_ch_list, list)\n\t\t\trx_slot[i++] = ch->ch_num;\n\n\t\t*rx_num = i;\n\t\tbreak;\n\tcase AIF1_CAP:\n\tcase AIF2_CAP:\n\tcase AIF3_CAP:\n\t\tif (!tx_slot || !tx_num) {\n\t\t\tdev_err(wcd->dev, \"Invalid tx_slot %p or tx_num %p\\n\",\n\t\t\t\ttx_slot, tx_num);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tlist_for_each_entry(ch, &wcd->dai[dai->id].slim_ch_list, list)\n\t\t\ttx_slot[i++] = ch->ch_num;\n\n\t\t*tx_num = i;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(wcd->dev, \"Invalid DAI ID %x\\n\", dai->id);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops wcd934x_dai_ops = {\n\t.hw_params = wcd934x_hw_params,\n\t.hw_free = wcd934x_hw_free,\n\t.trigger = wcd934x_trigger,\n\t.set_channel_map = wcd934x_set_channel_map,\n\t.get_channel_map = wcd934x_get_channel_map,\n};\n\nstatic struct snd_soc_dai_driver wcd934x_slim_dais[] = {\n\t[0] = {\n\t\t.name = \"wcd934x_rx1\",\n\t\t.id = AIF1_PB,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF1 Playback\",\n\t\t\t.rates = WCD934X_RATES_MASK | WCD934X_FRAC_RATES_MASK,\n\t\t\t.formats = WCD934X_FORMATS_S16_S24_LE,\n\t\t\t.rate_max = 192000,\n\t\t\t.rate_min = 8000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[1] = {\n\t\t.name = \"wcd934x_tx1\",\n\t\t.id = AIF1_CAP,\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF1 Capture\",\n\t\t\t.rates = WCD934X_RATES_MASK,\n\t\t\t.formats = SNDRV_PCM_FMTBIT_S16_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[2] = {\n\t\t.name = \"wcd934x_rx2\",\n\t\t.id = AIF2_PB,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF2 Playback\",\n\t\t\t.rates = WCD934X_RATES_MASK | WCD934X_FRAC_RATES_MASK,\n\t\t\t.formats = WCD934X_FORMATS_S16_S24_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[3] = {\n\t\t.name = \"wcd934x_tx2\",\n\t\t.id = AIF2_CAP,\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF2 Capture\",\n\t\t\t.rates = WCD934X_RATES_MASK,\n\t\t\t.formats = SNDRV_PCM_FMTBIT_S16_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[4] = {\n\t\t.name = \"wcd934x_rx3\",\n\t\t.id = AIF3_PB,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF3 Playback\",\n\t\t\t.rates = WCD934X_RATES_MASK | WCD934X_FRAC_RATES_MASK,\n\t\t\t.formats = WCD934X_FORMATS_S16_S24_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[5] = {\n\t\t.name = \"wcd934x_tx3\",\n\t\t.id = AIF3_CAP,\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF3 Capture\",\n\t\t\t.rates = WCD934X_RATES_MASK,\n\t\t\t.formats = SNDRV_PCM_FMTBIT_S16_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n\t[6] = {\n\t\t.name = \"wcd934x_rx4\",\n\t\t.id = AIF4_PB,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF4 Playback\",\n\t\t\t.rates = WCD934X_RATES_MASK | WCD934X_FRAC_RATES_MASK,\n\t\t\t.formats = WCD934X_FORMATS_S16_S24_LE,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 192000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t},\n\t\t.ops = &wcd934x_dai_ops,\n\t},\n};\n\nstatic int swclk_gate_enable(struct clk_hw *hw)\n{\n\treturn wcd934x_swrm_clock(to_wcd934x_codec(hw), true);\n}\n\nstatic void swclk_gate_disable(struct clk_hw *hw)\n{\n\twcd934x_swrm_clock(to_wcd934x_codec(hw), false);\n}\n\nstatic int swclk_gate_is_enabled(struct clk_hw *hw)\n{\n\tstruct wcd934x_codec *wcd = to_wcd934x_codec(hw);\n\tint ret, val;\n\n\tregmap_read(wcd->regmap, WCD934X_CDC_CLK_RST_CTRL_SWR_CONTROL, &val);\n\tret = val & WCD934X_CDC_SWR_CLK_EN_MASK;\n\n\treturn ret;\n}\n\nstatic unsigned long swclk_recalc_rate(struct clk_hw *hw,\n\t\t\t\t       unsigned long parent_rate)\n{\n\treturn parent_rate / 2;\n}\n\nstatic const struct clk_ops swclk_gate_ops = {\n\t.prepare = swclk_gate_enable,\n\t.unprepare = swclk_gate_disable,\n\t.is_enabled = swclk_gate_is_enabled,\n\t.recalc_rate = swclk_recalc_rate,\n\n};\n\nstatic struct clk *wcd934x_register_mclk_output(struct wcd934x_codec *wcd)\n{\n\tstruct clk *parent = wcd->extclk;\n\tstruct device *dev = wcd->dev;\n\tstruct device_node *np = dev->parent->of_node;\n\tconst char *parent_clk_name = NULL;\n\tconst char *clk_name = \"mclk\";\n\tstruct clk_hw *hw;\n\tstruct clk_init_data init;\n\tint ret;\n\n\tif (of_property_read_u32(np, \"clock-frequency\", &wcd->rate))\n\t\treturn NULL;\n\n\tparent_clk_name = __clk_get_name(parent);\n\n\tof_property_read_string(np, \"clock-output-names\", &clk_name);\n\n\tinit.name = clk_name;\n\tinit.ops = &swclk_gate_ops;\n\tinit.flags = 0;\n\tinit.parent_names = &parent_clk_name;\n\tinit.num_parents = 1;\n\twcd->hw.init = &init;\n\n\thw = &wcd->hw;\n\tret = devm_clk_hw_register(wcd->dev->parent, hw);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tret = devm_of_clk_add_hw_provider(dev, of_clk_hw_simple_get, hw);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\treturn NULL;\n}\n\nstatic int wcd934x_get_micbias_val(struct device *dev, const char *micbias,\n\t\t\t\t   u32 *micb_mv)\n{\n\tint mv;\n\n\tif (of_property_read_u32(dev->parent->of_node, micbias, &mv)) {\n\t\tdev_err(dev, \"%s value not found, using default\\n\", micbias);\n\t\tmv = WCD934X_DEF_MICBIAS_MV;\n\t} else {\n\t\t \n\t\tmv = mv/1000;\n\t}\n\n\tif (mv < 1000 || mv > 2850) {\n\t\tdev_err(dev, \"%s value not in valid range, using default\\n\",\n\t\t\tmicbias);\n\t\tmv = WCD934X_DEF_MICBIAS_MV;\n\t}\n\n\t*micb_mv = mv;\n\n\treturn (mv - 1000) / 50;\n}\n\nstatic int wcd934x_init_dmic(struct snd_soc_component *comp)\n{\n\tint vout_ctl_1, vout_ctl_2, vout_ctl_3, vout_ctl_4;\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tu32 def_dmic_rate, dmic_clk_drv;\n\n\tvout_ctl_1 = wcd934x_get_micbias_val(comp->dev,\n\t\t\t\t\t     \"qcom,micbias1-microvolt\",\n\t\t\t\t\t     &wcd->micb1_mv);\n\tvout_ctl_2 = wcd934x_get_micbias_val(comp->dev,\n\t\t\t\t\t     \"qcom,micbias2-microvolt\",\n\t\t\t\t\t     &wcd->micb2_mv);\n\tvout_ctl_3 = wcd934x_get_micbias_val(comp->dev,\n\t\t\t\t\t     \"qcom,micbias3-microvolt\",\n\t\t\t\t\t     &wcd->micb3_mv);\n\tvout_ctl_4 = wcd934x_get_micbias_val(comp->dev,\n\t\t\t\t\t     \"qcom,micbias4-microvolt\",\n\t\t\t\t\t     &wcd->micb4_mv);\n\n\tsnd_soc_component_update_bits(comp, WCD934X_ANA_MICB1,\n\t\t\t\t      WCD934X_MICB_VAL_MASK, vout_ctl_1);\n\tsnd_soc_component_update_bits(comp, WCD934X_ANA_MICB2,\n\t\t\t\t      WCD934X_MICB_VAL_MASK, vout_ctl_2);\n\tsnd_soc_component_update_bits(comp, WCD934X_ANA_MICB3,\n\t\t\t\t      WCD934X_MICB_VAL_MASK, vout_ctl_3);\n\tsnd_soc_component_update_bits(comp, WCD934X_ANA_MICB4,\n\t\t\t\t      WCD934X_MICB_VAL_MASK, vout_ctl_4);\n\n\tif (wcd->rate == WCD934X_MCLK_CLK_9P6MHZ)\n\t\tdef_dmic_rate = WCD9XXX_DMIC_SAMPLE_RATE_4P8MHZ;\n\telse\n\t\tdef_dmic_rate = WCD9XXX_DMIC_SAMPLE_RATE_4P096MHZ;\n\n\twcd->dmic_sample_rate = def_dmic_rate;\n\n\tdmic_clk_drv = 0;\n\tsnd_soc_component_update_bits(comp, WCD934X_TEST_DEBUG_PAD_DRVCTL_0,\n\t\t\t\t      0x0C, dmic_clk_drv << 2);\n\n\treturn 0;\n}\n\nstatic void wcd934x_hw_init(struct wcd934x_codec *wcd)\n{\n\tstruct regmap *rm = wcd->regmap;\n\n\t \n\tregmap_update_bits(rm, WCD934X_CDC_RX7_RX_PATH_CFG1, 0x08, 0x08);\n\tregmap_update_bits(rm, WCD934X_CDC_RX8_RX_PATH_CFG1, 0x08, 0x08);\n\n\t \n\tregmap_update_bits(rm, WCD934X_CPE_SS_DMIC_CFG, 0x80, 0x00);\n}\n\nstatic int wcd934x_comp_init(struct snd_soc_component *component)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\n\twcd934x_hw_init(wcd);\n\twcd934x_enable_efuse_sensing(wcd);\n\twcd934x_get_version(wcd);\n\n\treturn 0;\n}\n\nstatic irqreturn_t wcd934x_slim_irq_handler(int irq, void *data)\n{\n\tstruct wcd934x_codec *wcd = data;\n\tunsigned long status = 0;\n\tint i, j, port_id;\n\tunsigned int val, int_val = 0;\n\tirqreturn_t ret = IRQ_NONE;\n\tbool tx;\n\tunsigned short reg = 0;\n\n\tfor (i = WCD934X_SLIM_PGD_PORT_INT_STATUS_RX_0, j = 0;\n\t     i <= WCD934X_SLIM_PGD_PORT_INT_STATUS_TX_1; i++, j++) {\n\t\tregmap_read(wcd->if_regmap, i, &val);\n\t\tstatus |= ((u32)val << (8 * j));\n\t}\n\n\tfor_each_set_bit(j, &status, 32) {\n\t\ttx = false;\n\t\tport_id = j;\n\n\t\tif (j >= 16) {\n\t\t\ttx = true;\n\t\t\tport_id = j - 16;\n\t\t}\n\n\t\tregmap_read(wcd->if_regmap,\n\t\t\t    WCD934X_SLIM_PGD_PORT_INT_RX_SOURCE0 + j, &val);\n\t\tif (val) {\n\t\t\tif (!tx)\n\t\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_EN0 +\n\t\t\t\t\t(port_id / 8);\n\t\t\telse\n\t\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_TX_EN0 +\n\t\t\t\t\t(port_id / 8);\n\t\t\tregmap_read(wcd->if_regmap, reg, &int_val);\n\t\t}\n\n\t\tif (val & WCD934X_SLIM_IRQ_OVERFLOW)\n\t\t\tdev_err_ratelimited(wcd->dev,\n\t\t\t\t\t    \"overflow error on %s port %d, value %x\\n\",\n\t\t\t\t\t    (tx ? \"TX\" : \"RX\"), port_id, val);\n\n\t\tif (val & WCD934X_SLIM_IRQ_UNDERFLOW)\n\t\t\tdev_err_ratelimited(wcd->dev,\n\t\t\t\t\t    \"underflow error on %s port %d, value %x\\n\",\n\t\t\t\t\t    (tx ? \"TX\" : \"RX\"), port_id, val);\n\n\t\tif ((val & WCD934X_SLIM_IRQ_OVERFLOW) ||\n\t\t    (val & WCD934X_SLIM_IRQ_UNDERFLOW)) {\n\t\t\tif (!tx)\n\t\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_EN0 +\n\t\t\t\t\t(port_id / 8);\n\t\t\telse\n\t\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_TX_EN0 +\n\t\t\t\t\t(port_id / 8);\n\t\t\tregmap_read(\n\t\t\t\twcd->if_regmap, reg, &int_val);\n\t\t\tif (int_val & (1 << (port_id % 8))) {\n\t\t\t\tint_val = int_val ^ (1 << (port_id % 8));\n\t\t\t\tregmap_write(wcd->if_regmap,\n\t\t\t\t\t     reg, int_val);\n\t\t\t}\n\t\t}\n\n\t\tif (val & WCD934X_SLIM_IRQ_PORT_CLOSED)\n\t\t\tdev_err_ratelimited(wcd->dev,\n\t\t\t\t\t    \"Port Closed %s port %d, value %x\\n\",\n\t\t\t\t\t    (tx ? \"TX\" : \"RX\"), port_id, val);\n\n\t\tregmap_write(wcd->if_regmap,\n\t\t\t     WCD934X_SLIM_PGD_PORT_INT_CLR_RX_0 + (j / 8),\n\t\t\t\tBIT(j % 8));\n\t\tret = IRQ_HANDLED;\n\t}\n\n\treturn ret;\n}\n\nstatic void wcd934x_mbhc_clk_setup(struct snd_soc_component *component,\n\t\t\t\t   bool enable)\n{\n\tsnd_soc_component_write_field(component, WCD934X_MBHC_NEW_CTL_1,\n\t\t\t\t      WCD934X_MBHC_CTL_RCO_EN_MASK, enable);\n}\n\nstatic void wcd934x_mbhc_mbhc_bias_control(struct snd_soc_component *component,\n\t\t\t\t\t   bool enable)\n{\n\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_ELECT,\n\t\t\t\t      WCD934X_ANA_MBHC_BIAS_EN, enable);\n}\n\nstatic void wcd934x_mbhc_program_btn_thr(struct snd_soc_component *component,\n\t\t\t\t\t int *btn_low, int *btn_high,\n\t\t\t\t\t int num_btn, bool is_micbias)\n{\n\tint i, vth;\n\n\tif (num_btn > WCD_MBHC_DEF_BUTTONS) {\n\t\tdev_err(component->dev, \"%s: invalid number of buttons: %d\\n\",\n\t\t\t__func__, num_btn);\n\t\treturn;\n\t}\n\n\tfor (i = 0; i < num_btn; i++) {\n\t\tvth = ((btn_high[i] * 2) / 25) & 0x3F;\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_BTN0 + i,\n\t\t\t\t\t   WCD934X_MBHC_BTN_VTH_MASK, vth);\n\t}\n}\n\nstatic bool wcd934x_mbhc_micb_en_status(struct snd_soc_component *component, int micb_num)\n{\n\tu8 val;\n\n\tif (micb_num == MIC_BIAS_2) {\n\t\tval = snd_soc_component_read_field(component, WCD934X_ANA_MICB2,\n\t\t\t\t\t\t   WCD934X_ANA_MICB2_ENABLE_MASK);\n\t\tif (val == WCD934X_MICB_ENABLE)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic void wcd934x_mbhc_hph_l_pull_up_control(struct snd_soc_component *component,\n\t\t\t\t\t       enum mbhc_hs_pullup_iref pull_up_cur)\n{\n\t \n\tif (pull_up_cur < I_OFF || pull_up_cur > I_3P0_UA ||\n\t    pull_up_cur == I_DEFAULT)\n\t\tpull_up_cur = I_2P0_UA;\n\n\n\tsnd_soc_component_write_field(component, WCD934X_MBHC_NEW_PLUG_DETECT_CTL,\n\t\t\t\t      WCD934X_HSDET_PULLUP_C_MASK, pull_up_cur);\n}\n\nstatic int wcd934x_micbias_control(struct snd_soc_component *component,\n\t\t\t    int micb_num, int req, bool is_dapm)\n{\n\tstruct wcd934x_codec *wcd934x = snd_soc_component_get_drvdata(component);\n\tint micb_index = micb_num - 1;\n\tu16 micb_reg;\n\n\tswitch (micb_num) {\n\tcase MIC_BIAS_1:\n\t\tmicb_reg = WCD934X_ANA_MICB1;\n\t\tbreak;\n\tcase MIC_BIAS_2:\n\t\tmicb_reg = WCD934X_ANA_MICB2;\n\t\tbreak;\n\tcase MIC_BIAS_3:\n\t\tmicb_reg = WCD934X_ANA_MICB3;\n\t\tbreak;\n\tcase MIC_BIAS_4:\n\t\tmicb_reg = WCD934X_ANA_MICB4;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"%s: Invalid micbias number: %d\\n\",\n\t\t\t__func__, micb_num);\n\t\treturn -EINVAL;\n\t}\n\tmutex_lock(&wcd934x->micb_lock);\n\n\tswitch (req) {\n\tcase MICB_PULLUP_ENABLE:\n\t\twcd934x->pullup_ref[micb_index]++;\n\t\tif ((wcd934x->pullup_ref[micb_index] == 1) &&\n\t\t    (wcd934x->micb_ref[micb_index] == 0))\n\t\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK,\n\t\t\t\t\t\t      WCD934X_MICB_PULL_UP);\n\t\tbreak;\n\tcase MICB_PULLUP_DISABLE:\n\t\tif (wcd934x->pullup_ref[micb_index] > 0)\n\t\t\twcd934x->pullup_ref[micb_index]--;\n\n\t\tif ((wcd934x->pullup_ref[micb_index] == 0) &&\n\t\t    (wcd934x->micb_ref[micb_index] == 0))\n\t\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK, 0);\n\t\tbreak;\n\tcase MICB_ENABLE:\n\t\twcd934x->micb_ref[micb_index]++;\n\t\tif (wcd934x->micb_ref[micb_index] == 1) {\n\t\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK,\n\t\t\t\t\t\t      WCD934X_MICB_ENABLE);\n\t\t\tif (micb_num  == MIC_BIAS_2)\n\t\t\t\twcd_mbhc_event_notify(wcd934x->mbhc,\n\t\t\t\t\t\t      WCD_EVENT_POST_MICBIAS_2_ON);\n\t\t}\n\n\t\tif (micb_num  == MIC_BIAS_2 && is_dapm)\n\t\t\twcd_mbhc_event_notify(wcd934x->mbhc,\n\t\t\t\t\t      WCD_EVENT_POST_DAPM_MICBIAS_2_ON);\n\t\tbreak;\n\tcase MICB_DISABLE:\n\t\tif (wcd934x->micb_ref[micb_index] > 0)\n\t\t\twcd934x->micb_ref[micb_index]--;\n\n\t\tif ((wcd934x->micb_ref[micb_index] == 0) &&\n\t\t    (wcd934x->pullup_ref[micb_index] > 0))\n\t\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK,\n\t\t\t\t\t\t      WCD934X_MICB_PULL_UP);\n\t\telse if ((wcd934x->micb_ref[micb_index] == 0) &&\n\t\t\t (wcd934x->pullup_ref[micb_index] == 0)) {\n\t\t\tif (micb_num  == MIC_BIAS_2)\n\t\t\t\twcd_mbhc_event_notify(wcd934x->mbhc,\n\t\t\t\t\t\t      WCD_EVENT_PRE_MICBIAS_2_OFF);\n\n\t\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK, 0);\n\t\t\tif (micb_num  == MIC_BIAS_2)\n\t\t\t\twcd_mbhc_event_notify(wcd934x->mbhc,\n\t\t\t\t\t\t      WCD_EVENT_POST_MICBIAS_2_OFF);\n\t\t}\n\t\tif (is_dapm && micb_num  == MIC_BIAS_2)\n\t\t\twcd_mbhc_event_notify(wcd934x->mbhc,\n\t\t\t\t\t      WCD_EVENT_POST_DAPM_MICBIAS_2_OFF);\n\t\tbreak;\n\t}\n\n\tmutex_unlock(&wcd934x->micb_lock);\n\n\treturn 0;\n}\n\nstatic int wcd934x_mbhc_request_micbias(struct snd_soc_component *component,\n\t\t\t\t\tint micb_num, int req)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tint ret;\n\n\tif (req == MICB_ENABLE)\n\t\t__wcd934x_cdc_mclk_enable(wcd, true);\n\n\tret = wcd934x_micbias_control(component, micb_num, req, false);\n\n\tif (req == MICB_DISABLE)\n\t\t__wcd934x_cdc_mclk_enable(wcd, false);\n\n\treturn ret;\n}\n\nstatic void wcd934x_mbhc_micb_ramp_control(struct snd_soc_component *component,\n\t\t\t\t\t   bool enable)\n{\n\tif (enable) {\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MICB2_RAMP,\n\t\t\t\t    WCD934X_RAMP_SHIFT_CTRL_MASK, 0x3);\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MICB2_RAMP,\n\t\t\t\t    WCD934X_RAMP_EN_MASK, 1);\n\t} else {\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MICB2_RAMP,\n\t\t\t\t    WCD934X_RAMP_EN_MASK, 0);\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MICB2_RAMP,\n\t\t\t\t    WCD934X_RAMP_SHIFT_CTRL_MASK, 0);\n\t}\n}\n\nstatic int wcd934x_get_micb_vout_ctl_val(u32 micb_mv)\n{\n\t \n\tif (micb_mv < 1000 || micb_mv > 2850)\n\t\treturn -EINVAL;\n\n\treturn (micb_mv - 1000) / 50;\n}\n\nstatic int wcd934x_mbhc_micb_adjust_voltage(struct snd_soc_component *component,\n\t\t\t\t\t    int req_volt, int micb_num)\n{\n\tstruct wcd934x_codec *wcd934x = snd_soc_component_get_drvdata(component);\n\tint cur_vout_ctl, req_vout_ctl, micb_reg, micb_en, ret = 0;\n\n\tswitch (micb_num) {\n\tcase MIC_BIAS_1:\n\t\tmicb_reg = WCD934X_ANA_MICB1;\n\t\tbreak;\n\tcase MIC_BIAS_2:\n\t\tmicb_reg = WCD934X_ANA_MICB2;\n\t\tbreak;\n\tcase MIC_BIAS_3:\n\t\tmicb_reg = WCD934X_ANA_MICB3;\n\t\tbreak;\n\tcase MIC_BIAS_4:\n\t\tmicb_reg = WCD934X_ANA_MICB4;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tmutex_lock(&wcd934x->micb_lock);\n\t \n\tmicb_en = snd_soc_component_read_field(component, micb_reg,\n\t\t\t\t\t\tWCD934X_ANA_MICB_EN_MASK);\n\tcur_vout_ctl = snd_soc_component_read_field(component, micb_reg,\n\t\t\t\t\t\t    WCD934X_MICB_VAL_MASK);\n\n\treq_vout_ctl = wcd934x_get_micb_vout_ctl_val(req_volt);\n\tif (req_vout_ctl < 0) {\n\t\tret = -EINVAL;\n\t\tgoto exit;\n\t}\n\n\tif (cur_vout_ctl == req_vout_ctl) {\n\t\tret = 0;\n\t\tgoto exit;\n\t}\n\n\tif (micb_en == WCD934X_MICB_ENABLE)\n\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK,\n\t\t\t\t\t      WCD934X_MICB_PULL_UP);\n\n\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t      WCD934X_MICB_VAL_MASK,\n\t\t\t\t      req_vout_ctl);\n\n\tif (micb_en == WCD934X_MICB_ENABLE) {\n\t\tsnd_soc_component_write_field(component, micb_reg,\n\t\t\t\t\t      WCD934X_ANA_MICB_EN_MASK,\n\t\t\t\t\t      WCD934X_MICB_ENABLE);\n\t\t \n\t\tusleep_range(2000, 2100);\n\t}\nexit:\n\tmutex_unlock(&wcd934x->micb_lock);\n\treturn ret;\n}\n\nstatic int wcd934x_mbhc_micb_ctrl_threshold_mic(struct snd_soc_component *component,\n\t\t\t\t\t\tint micb_num, bool req_en)\n{\n\tstruct wcd934x_codec *wcd934x = snd_soc_component_get_drvdata(component);\n\tint rc, micb_mv;\n\n\tif (micb_num != MIC_BIAS_2)\n\t\treturn -EINVAL;\n\t \n\tif (wcd934x->micb2_mv >= WCD_MBHC_THR_HS_MICB_MV)\n\t\treturn 0;\n\n\tmicb_mv = req_en ? WCD_MBHC_THR_HS_MICB_MV : wcd934x->micb2_mv;\n\n\trc = wcd934x_mbhc_micb_adjust_voltage(component, micb_mv, MIC_BIAS_2);\n\n\treturn rc;\n}\n\nstatic void wcd934x_mbhc_get_result_params(struct wcd934x_codec *wcd934x,\n\t\t\t\t\t\ts16 *d1_a, u16 noff,\n\t\t\t\t\t\tint32_t *zdet)\n{\n\tint i;\n\tint val, val1;\n\ts16 c1;\n\ts32 x1, d1;\n\tint32_t denom;\n\tint minCode_param[] = {\n\t\t\t3277, 1639, 820, 410, 205, 103, 52, 26\n\t};\n\n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x20, 0x20);\n\tfor (i = 0; i < WCD934X_ZDET_NUM_MEASUREMENTS; i++) {\n\t\tregmap_read(wcd934x->regmap, WCD934X_ANA_MBHC_RESULT_2, &val);\n\t\tif (val & 0x80)\n\t\t\tbreak;\n\t}\n\tval = val << 0x8;\n\tregmap_read(wcd934x->regmap, WCD934X_ANA_MBHC_RESULT_1, &val1);\n\tval |= val1;\n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x20, 0x00);\n\tx1 = WCD934X_MBHC_GET_X1(val);\n\tc1 = WCD934X_MBHC_GET_C1(val);\n\t \n\tif ((c1 < 2) && x1)\n\t\tusleep_range(5000, 5050);\n\n\tif (!c1 || !x1) {\n\t\tdev_err(wcd934x->dev, \"%s: Impedance detect ramp error, c1=%d, x1=0x%x\\n\",\n\t\t\t__func__, c1, x1);\n\t\tgoto ramp_down;\n\t}\n\td1 = d1_a[c1];\n\tdenom = (x1 * d1) - (1 << (14 - noff));\n\tif (denom > 0)\n\t\t*zdet = (WCD934X_MBHC_ZDET_CONST * 1000) / denom;\n\telse if (x1 < minCode_param[noff])\n\t\t*zdet = WCD934X_ZDET_FLOATING_IMPEDANCE;\n\n\tdev_dbg(wcd934x->dev, \"%s: d1=%d, c1=%d, x1=0x%x, z_val=%di (milliohm)\\n\",\n\t\t__func__, d1, c1, x1, *zdet);\nramp_down:\n\ti = 0;\n\n\twhile (x1) {\n\t\tregmap_read(wcd934x->regmap, WCD934X_ANA_MBHC_RESULT_1, &val);\n\t\tregmap_read(wcd934x->regmap, WCD934X_ANA_MBHC_RESULT_2, &val1);\n\t\tval = val << 0x08;\n\t\tval |= val1;\n\t\tx1 = WCD934X_MBHC_GET_X1(val);\n\t\ti++;\n\t\tif (i == WCD934X_ZDET_NUM_MEASUREMENTS)\n\t\t\tbreak;\n\t}\n}\n\nstatic void wcd934x_mbhc_zdet_ramp(struct snd_soc_component *component,\n\t\t\t\t struct wcd934x_mbhc_zdet_param *zdet_param,\n\t\t\t\t int32_t *zl, int32_t *zr, s16 *d1_a)\n{\n\tstruct wcd934x_codec *wcd934x = dev_get_drvdata(component->dev);\n\tint32_t zdet = 0;\n\n\tsnd_soc_component_write_field(component, WCD934X_MBHC_NEW_ZDET_ANA_CTL,\n\t\t\t\tWCD934X_ZDET_MAXV_CTL_MASK, zdet_param->ldo_ctl);\n\tsnd_soc_component_update_bits(component, WCD934X_ANA_MBHC_BTN5,\n\t\t\t\t    WCD934X_VTH_MASK, zdet_param->btn5);\n\tsnd_soc_component_update_bits(component, WCD934X_ANA_MBHC_BTN6,\n\t\t\t\t      WCD934X_VTH_MASK, zdet_param->btn6);\n\tsnd_soc_component_update_bits(component, WCD934X_ANA_MBHC_BTN7,\n\t\t\t\t     WCD934X_VTH_MASK, zdet_param->btn7);\n\tsnd_soc_component_write_field(component, WCD934X_MBHC_NEW_ZDET_ANA_CTL,\n\t\t\t\tWCD934X_ZDET_RANGE_CTL_MASK, zdet_param->noff);\n\tsnd_soc_component_update_bits(component, WCD934X_MBHC_NEW_ZDET_RAMP_CTL,\n\t\t\t\t0x0F, zdet_param->nshift);\n\n\tif (!zl)\n\t\tgoto z_right;\n\t \n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x80, 0x80);\n\twcd934x_mbhc_get_result_params(wcd934x, d1_a, zdet_param->noff, &zdet);\n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x80, 0x00);\n\n\t*zl = zdet;\n\nz_right:\n\tif (!zr)\n\t\treturn;\n\t \n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x40, 0x40);\n\twcd934x_mbhc_get_result_params(wcd934x, d1_a, zdet_param->noff, &zdet);\n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ZDET, 0x40, 0x00);\n\n\t*zr = zdet;\n}\n\nstatic void wcd934x_wcd_mbhc_qfuse_cal(struct snd_soc_component *component,\n\t\t\t\t\tint32_t *z_val, int flag_l_r)\n{\n\ts16 q1;\n\tint q1_cal;\n\n\tif (*z_val < (WCD934X_ZDET_VAL_400/1000))\n\t\tq1 = snd_soc_component_read(component,\n\t\t\tWCD934X_CHIP_TIER_CTRL_EFUSE_VAL_OUT1 + (2 * flag_l_r));\n\telse\n\t\tq1 = snd_soc_component_read(component,\n\t\t\tWCD934X_CHIP_TIER_CTRL_EFUSE_VAL_OUT2 + (2 * flag_l_r));\n\tif (q1 & 0x80)\n\t\tq1_cal = (10000 - ((q1 & 0x7F) * 25));\n\telse\n\t\tq1_cal = (10000 + (q1 * 25));\n\tif (q1_cal > 0)\n\t\t*z_val = ((*z_val) * 10000) / q1_cal;\n}\n\nstatic void wcd934x_wcd_mbhc_calc_impedance(struct snd_soc_component *component,\n\t\t\t\t\t    uint32_t *zl, uint32_t *zr)\n{\n\tstruct wcd934x_codec *wcd934x = dev_get_drvdata(component->dev);\n\ts16 reg0, reg1, reg2, reg3, reg4;\n\tint32_t z1L, z1R, z1Ls;\n\tint zMono, z_diff1, z_diff2;\n\tbool is_fsm_disable = false;\n\tstruct wcd934x_mbhc_zdet_param zdet_param[] = {\n\t\t{4, 0, 4, 0x08, 0x14, 0x18},  \n\t\t{2, 0, 3, 0x18, 0x7C, 0x90},  \n\t\t{1, 4, 5, 0x18, 0x7C, 0x90},  \n\t\t{1, 6, 7, 0x18, 0x7C, 0x90},  \n\t};\n\tstruct wcd934x_mbhc_zdet_param *zdet_param_ptr = NULL;\n\ts16 d1_a[][4] = {\n\t\t{0, 30, 90, 30},\n\t\t{0, 30, 30, 5},\n\t\t{0, 30, 30, 5},\n\t\t{0, 30, 30, 5},\n\t};\n\ts16 *d1 = NULL;\n\n\treg0 = snd_soc_component_read(component, WCD934X_ANA_MBHC_BTN5);\n\treg1 = snd_soc_component_read(component, WCD934X_ANA_MBHC_BTN6);\n\treg2 = snd_soc_component_read(component, WCD934X_ANA_MBHC_BTN7);\n\treg3 = snd_soc_component_read(component, WCD934X_MBHC_CTL_CLK);\n\treg4 = snd_soc_component_read(component, WCD934X_MBHC_NEW_ZDET_ANA_CTL);\n\n\tif (snd_soc_component_read(component, WCD934X_ANA_MBHC_ELECT) & 0x80) {\n\t\tis_fsm_disable = true;\n\t\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ELECT, 0x80, 0x00);\n\t}\n\n\t \n\tif (wcd934x->mbhc_cfg.hphl_swh)\n\t\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_MECH, 0x80, 0x00);\n\n\t \n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_MECH, 0x01, 0x00);\n\n\t \n\td1 = d1_a[1];\n\tzdet_param_ptr = &zdet_param[1];\n\twcd934x_mbhc_zdet_ramp(component, zdet_param_ptr, &z1L, NULL, d1);\n\n\tif (!WCD934X_MBHC_IS_SECOND_RAMP_REQUIRED(z1L))\n\t\tgoto left_ch_impedance;\n\n\t \n\tif (z1L < WCD934X_ZDET_VAL_32) {\n\t\tzdet_param_ptr = &zdet_param[0];\n\t\td1 = d1_a[0];\n\t} else if ((z1L > WCD934X_ZDET_VAL_400) &&\n\t\t  (z1L <= WCD934X_ZDET_VAL_1200)) {\n\t\tzdet_param_ptr = &zdet_param[2];\n\t\td1 = d1_a[2];\n\t} else if (z1L > WCD934X_ZDET_VAL_1200) {\n\t\tzdet_param_ptr = &zdet_param[3];\n\t\td1 = d1_a[3];\n\t}\n\twcd934x_mbhc_zdet_ramp(component, zdet_param_ptr, &z1L, NULL, d1);\n\nleft_ch_impedance:\n\tif ((z1L == WCD934X_ZDET_FLOATING_IMPEDANCE) ||\n\t\t(z1L > WCD934X_ZDET_VAL_100K)) {\n\t\t*zl = WCD934X_ZDET_FLOATING_IMPEDANCE;\n\t\tzdet_param_ptr = &zdet_param[1];\n\t\td1 = d1_a[1];\n\t} else {\n\t\t*zl = z1L/1000;\n\t\twcd934x_wcd_mbhc_qfuse_cal(component, zl, 0);\n\t}\n\tdev_info(component->dev, \"%s: impedance on HPH_L = %d(ohms)\\n\",\n\t\t__func__, *zl);\n\n\t \n\twcd934x_mbhc_zdet_ramp(component, zdet_param_ptr, NULL, &z1R, d1);\n\tif (WCD934X_MBHC_IS_SECOND_RAMP_REQUIRED(z1R)) {\n\t\tif (((z1R > WCD934X_ZDET_VAL_1200) &&\n\t\t\t(zdet_param_ptr->noff == 0x6)) ||\n\t\t\t((*zl) != WCD934X_ZDET_FLOATING_IMPEDANCE))\n\t\t\tgoto right_ch_impedance;\n\t\t \n\t\tif (z1R < WCD934X_ZDET_VAL_32) {\n\t\t\tzdet_param_ptr = &zdet_param[0];\n\t\t\td1 = d1_a[0];\n\t\t} else if ((z1R > WCD934X_ZDET_VAL_400) &&\n\t\t\t(z1R <= WCD934X_ZDET_VAL_1200)) {\n\t\t\tzdet_param_ptr = &zdet_param[2];\n\t\t\td1 = d1_a[2];\n\t\t} else if (z1R > WCD934X_ZDET_VAL_1200) {\n\t\t\tzdet_param_ptr = &zdet_param[3];\n\t\t\td1 = d1_a[3];\n\t\t}\n\t\twcd934x_mbhc_zdet_ramp(component, zdet_param_ptr, NULL, &z1R, d1);\n\t}\nright_ch_impedance:\n\tif ((z1R == WCD934X_ZDET_FLOATING_IMPEDANCE) ||\n\t\t(z1R > WCD934X_ZDET_VAL_100K)) {\n\t\t*zr = WCD934X_ZDET_FLOATING_IMPEDANCE;\n\t} else {\n\t\t*zr = z1R/1000;\n\t\twcd934x_wcd_mbhc_qfuse_cal(component, zr, 1);\n\t}\n\tdev_err(component->dev, \"%s: impedance on HPH_R = %d(ohms)\\n\",\n\t\t__func__, *zr);\n\n\t \n\tif ((*zl == WCD934X_ZDET_FLOATING_IMPEDANCE) &&\n\t\t(*zr == WCD934X_ZDET_FLOATING_IMPEDANCE)) {\n\t\tdev_dbg(component->dev,\n\t\t\t\"%s: plug type is invalid or extension cable\\n\",\n\t\t\t__func__);\n\t\tgoto zdet_complete;\n\t}\n\tif ((*zl == WCD934X_ZDET_FLOATING_IMPEDANCE) ||\n\t    (*zr == WCD934X_ZDET_FLOATING_IMPEDANCE) ||\n\t    ((*zl < WCD_MONO_HS_MIN_THR) && (*zr > WCD_MONO_HS_MIN_THR)) ||\n\t    ((*zl > WCD_MONO_HS_MIN_THR) && (*zr < WCD_MONO_HS_MIN_THR))) {\n\t\tdev_dbg(component->dev,\n\t\t\t\"%s: Mono plug type with one ch floating or shorted to GND\\n\",\n\t\t\t__func__);\n\t\twcd_mbhc_set_hph_type(wcd934x->mbhc, WCD_MBHC_HPH_MONO);\n\t\tgoto zdet_complete;\n\t}\n\tsnd_soc_component_write_field(component, WCD934X_HPH_R_ATEST,\n\t\t\t\t      WCD934X_HPHPA_GND_OVR_MASK, 1);\n\tsnd_soc_component_write_field(component, WCD934X_HPH_PA_CTL2,\n\t\t\t\t      WCD934X_HPHPA_GND_R_MASK, 1);\n\tif (*zl < (WCD934X_ZDET_VAL_32/1000))\n\t\twcd934x_mbhc_zdet_ramp(component, &zdet_param[0], &z1Ls, NULL, d1);\n\telse\n\t\twcd934x_mbhc_zdet_ramp(component, &zdet_param[1], &z1Ls, NULL, d1);\n\tsnd_soc_component_write_field(component, WCD934X_HPH_PA_CTL2,\n\t\t\t\t      WCD934X_HPHPA_GND_R_MASK, 0);\n\tsnd_soc_component_write_field(component, WCD934X_HPH_R_ATEST,\n\t\t\t\t      WCD934X_HPHPA_GND_OVR_MASK, 0);\n\tz1Ls /= 1000;\n\twcd934x_wcd_mbhc_qfuse_cal(component, &z1Ls, 0);\n\t \n\tzMono = ((*zl) * 9) / ((*zl) + 9);\n\tz_diff1 = (z1Ls > zMono) ? (z1Ls - zMono) : (zMono - z1Ls);\n\tz_diff2 = ((*zl) > z1Ls) ? ((*zl) - z1Ls) : (z1Ls - (*zl));\n\tif ((z_diff1 * (*zl + z1Ls)) > (z_diff2 * (z1Ls + zMono))) {\n\t\tdev_err(component->dev, \"%s: stereo plug type detected\\n\",\n\t\t\t__func__);\n\t\twcd_mbhc_set_hph_type(wcd934x->mbhc, WCD_MBHC_HPH_STEREO);\n\t} else {\n\t\tdev_err(component->dev, \"%s: MONO plug type detected\\n\",\n\t\t\t__func__);\n\t\twcd_mbhc_set_hph_type(wcd934x->mbhc, WCD_MBHC_HPH_MONO);\n\t}\n\nzdet_complete:\n\tsnd_soc_component_write(component, WCD934X_ANA_MBHC_BTN5, reg0);\n\tsnd_soc_component_write(component, WCD934X_ANA_MBHC_BTN6, reg1);\n\tsnd_soc_component_write(component, WCD934X_ANA_MBHC_BTN7, reg2);\n\t \n\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_MECH, 0x01, 0x01);\n\n\t \n\tif (wcd934x->mbhc_cfg.hphl_swh)\n\t\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_MECH, 0x80, 0x80);\n\n\tsnd_soc_component_write(component, WCD934X_MBHC_NEW_ZDET_ANA_CTL, reg4);\n\tsnd_soc_component_write(component, WCD934X_MBHC_CTL_CLK, reg3);\n\tif (is_fsm_disable)\n\t\tregmap_update_bits(wcd934x->regmap, WCD934X_ANA_MBHC_ELECT, 0x80, 0x80);\n}\n\nstatic void wcd934x_mbhc_gnd_det_ctrl(struct snd_soc_component *component,\n\t\t\tbool enable)\n{\n\tif (enable) {\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_MECH,\n\t\t\t\t\t      WCD934X_MBHC_HSG_PULLUP_COMP_EN, 1);\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_MECH,\n\t\t\t\t\t      WCD934X_MBHC_GND_DET_EN_MASK, 1);\n\t} else {\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_MECH,\n\t\t\t\t\t      WCD934X_MBHC_GND_DET_EN_MASK, 0);\n\t\tsnd_soc_component_write_field(component, WCD934X_ANA_MBHC_MECH,\n\t\t\t\t\t      WCD934X_MBHC_HSG_PULLUP_COMP_EN, 0);\n\t}\n}\n\nstatic void wcd934x_mbhc_hph_pull_down_ctrl(struct snd_soc_component *component,\n\t\t\t\t\t  bool enable)\n{\n\tsnd_soc_component_write_field(component, WCD934X_HPH_PA_CTL2,\n\t\t\t\t      WCD934X_HPHPA_GND_R_MASK, enable);\n\tsnd_soc_component_write_field(component, WCD934X_HPH_PA_CTL2,\n\t\t\t\t      WCD934X_HPHPA_GND_L_MASK, enable);\n}\n\nstatic const struct wcd_mbhc_cb mbhc_cb = {\n\t.clk_setup = wcd934x_mbhc_clk_setup,\n\t.mbhc_bias = wcd934x_mbhc_mbhc_bias_control,\n\t.set_btn_thr = wcd934x_mbhc_program_btn_thr,\n\t.micbias_enable_status = wcd934x_mbhc_micb_en_status,\n\t.hph_pull_up_control = wcd934x_mbhc_hph_l_pull_up_control,\n\t.mbhc_micbias_control = wcd934x_mbhc_request_micbias,\n\t.mbhc_micb_ramp_control = wcd934x_mbhc_micb_ramp_control,\n\t.mbhc_micb_ctrl_thr_mic = wcd934x_mbhc_micb_ctrl_threshold_mic,\n\t.compute_impedance = wcd934x_wcd_mbhc_calc_impedance,\n\t.mbhc_gnd_det_ctrl = wcd934x_mbhc_gnd_det_ctrl,\n\t.hph_pull_down_ctrl = wcd934x_mbhc_hph_pull_down_ctrl,\n};\n\nstatic int wcd934x_get_hph_type(struct snd_kcontrol *kcontrol,\n\t\t\t      struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.integer.value[0] = wcd_mbhc_get_hph_type(wcd->mbhc);\n\n\treturn 0;\n}\n\nstatic int wcd934x_hph_impedance_get(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tuint32_t zl, zr;\n\tbool hphr;\n\tstruct soc_mixer_control *mc;\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(component);\n\n\tmc = (struct soc_mixer_control *)(kcontrol->private_value);\n\thphr = mc->shift;\n\twcd_mbhc_get_impedance(wcd->mbhc, &zl, &zr);\n\tdev_dbg(component->dev, \"%s: zl=%u(ohms), zr=%u(ohms)\\n\", __func__, zl, zr);\n\tucontrol->value.integer.value[0] = hphr ? zr : zl;\n\n\treturn 0;\n}\nstatic const struct snd_kcontrol_new hph_type_detect_controls[] = {\n\tSOC_SINGLE_EXT(\"HPH Type\", 0, 0, WCD_MBHC_HPH_STEREO, 0,\n\t\t       wcd934x_get_hph_type, NULL),\n};\n\nstatic const struct snd_kcontrol_new impedance_detect_controls[] = {\n\tSOC_SINGLE_EXT(\"HPHL Impedance\", 0, 0, INT_MAX, 0,\n\t\t       wcd934x_hph_impedance_get, NULL),\n\tSOC_SINGLE_EXT(\"HPHR Impedance\", 0, 1, INT_MAX, 0,\n\t\t       wcd934x_hph_impedance_get, NULL),\n};\n\nstatic int wcd934x_mbhc_init(struct snd_soc_component *component)\n{\n\tstruct wcd934x_ddata *data = dev_get_drvdata(component->dev->parent);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(component);\n\tstruct wcd_mbhc_intr *intr_ids = &wcd->intr_ids;\n\n\tintr_ids->mbhc_sw_intr = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t     WCD934X_IRQ_MBHC_SW_DET);\n\tintr_ids->mbhc_btn_press_intr = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t\t    WCD934X_IRQ_MBHC_BUTTON_PRESS_DET);\n\tintr_ids->mbhc_btn_release_intr = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t\t      WCD934X_IRQ_MBHC_BUTTON_RELEASE_DET);\n\tintr_ids->mbhc_hs_ins_intr = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t\t WCD934X_IRQ_MBHC_ELECT_INS_REM_LEG_DET);\n\tintr_ids->mbhc_hs_rem_intr = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t\t WCD934X_IRQ_MBHC_ELECT_INS_REM_DET);\n\tintr_ids->hph_left_ocp = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t     WCD934X_IRQ_HPH_PA_OCPL_FAULT);\n\tintr_ids->hph_right_ocp = regmap_irq_get_virq(data->irq_data,\n\t\t\t\t\t\t      WCD934X_IRQ_HPH_PA_OCPR_FAULT);\n\n\twcd->mbhc = wcd_mbhc_init(component, &mbhc_cb, intr_ids, wcd_mbhc_fields, true);\n\tif (IS_ERR(wcd->mbhc)) {\n\t\twcd->mbhc = NULL;\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_add_component_controls(component, impedance_detect_controls,\n\t\t\t\t       ARRAY_SIZE(impedance_detect_controls));\n\tsnd_soc_add_component_controls(component, hph_type_detect_controls,\n\t\t\t\t       ARRAY_SIZE(hph_type_detect_controls));\n\n\treturn 0;\n}\n\nstatic void wcd934x_mbhc_deinit(struct snd_soc_component *component)\n{\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(component);\n\n\tif (!wcd->mbhc)\n\t\treturn;\n\n\twcd_mbhc_deinit(wcd->mbhc);\n}\n\nstatic int wcd934x_comp_probe(struct snd_soc_component *component)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tint i;\n\n\tsnd_soc_component_init_regmap(component, wcd->regmap);\n\twcd->component = component;\n\n\t \n\twcd->clsh_ctrl = wcd_clsh_ctrl_alloc(component, wcd->version);\n\tif (IS_ERR(wcd->clsh_ctrl))\n\t\treturn PTR_ERR(wcd->clsh_ctrl);\n\n\t \n\twcd->hph_mode = CLS_H_LOHIFI;\n\n\twcd934x_comp_init(component);\n\n\tfor (i = 0; i < NUM_CODEC_DAIS; i++)\n\t\tINIT_LIST_HEAD(&wcd->dai[i].slim_ch_list);\n\n\twcd934x_init_dmic(component);\n\n\tif (wcd934x_mbhc_init(component))\n\t\tdev_err(component->dev, \"Failed to Initialize MBHC\\n\");\n\n\treturn 0;\n}\n\nstatic void wcd934x_comp_remove(struct snd_soc_component *comp)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\n\twcd934x_mbhc_deinit(comp);\n\twcd_clsh_ctrl_free(wcd->clsh_ctrl);\n}\n\nstatic int wcd934x_comp_set_sysclk(struct snd_soc_component *comp,\n\t\t\t\t   int clk_id, int source,\n\t\t\t\t   unsigned int freq, int dir)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tint val = WCD934X_CODEC_RPM_CLK_MCLK_CFG_9P6MHZ;\n\n\twcd->rate = freq;\n\n\tif (wcd->rate == WCD934X_MCLK_CLK_12P288MHZ)\n\t\tval = WCD934X_CODEC_RPM_CLK_MCLK_CFG_12P288MHZ;\n\n\tsnd_soc_component_update_bits(comp, WCD934X_CODEC_RPM_CLK_MCLK_CFG,\n\t\t\t\t      WCD934X_CODEC_RPM_CLK_MCLK_CFG_MCLK_MASK,\n\t\t\t\t      val);\n\n\treturn clk_set_rate(wcd->extclk, freq);\n}\n\nstatic uint32_t get_iir_band_coeff(struct snd_soc_component *component,\n\t\t\t\t   int iir_idx, int band_idx, int coeff_idx)\n{\n\tu32 value = 0;\n\tint reg, b2_reg;\n\n\t \n\treg = WCD934X_CDC_SIDETONE_IIR0_IIR_COEF_B1_CTL + 16 * iir_idx;\n\tb2_reg = WCD934X_CDC_SIDETONE_IIR0_IIR_COEF_B2_CTL + 16 * iir_idx;\n\n\tsnd_soc_component_write(component, reg,\n\t\t\t\t((band_idx * BAND_MAX + coeff_idx) *\n\t\t\t\t sizeof(uint32_t)) & 0x7F);\n\n\tvalue |= snd_soc_component_read(component, b2_reg);\n\tsnd_soc_component_write(component, reg,\n\t\t\t\t((band_idx * BAND_MAX + coeff_idx)\n\t\t\t\t * sizeof(uint32_t) + 1) & 0x7F);\n\n\tvalue |= (snd_soc_component_read(component, b2_reg) << 8);\n\tsnd_soc_component_write(component, reg,\n\t\t\t\t((band_idx * BAND_MAX + coeff_idx)\n\t\t\t\t * sizeof(uint32_t) + 2) & 0x7F);\n\n\tvalue |= (snd_soc_component_read(component, b2_reg) << 16);\n\tsnd_soc_component_write(component, reg,\n\t\t((band_idx * BAND_MAX + coeff_idx)\n\t\t* sizeof(uint32_t) + 3) & 0x7F);\n\n\t \n\tvalue |= (snd_soc_component_read(component, b2_reg) << 24);\n\treturn value;\n}\n\nstatic void set_iir_band_coeff(struct snd_soc_component *component,\n\t\t\t       int iir_idx, int band_idx, uint32_t value)\n{\n\tint reg = WCD934X_CDC_SIDETONE_IIR0_IIR_COEF_B2_CTL + 16 * iir_idx;\n\n\tsnd_soc_component_write(component, reg, (value & 0xFF));\n\tsnd_soc_component_write(component, reg, (value >> 8) & 0xFF);\n\tsnd_soc_component_write(component, reg, (value >> 16) & 0xFF);\n\t \n\tsnd_soc_component_write(component, reg, (value >> 24) & 0x3F);\n}\n\nstatic int wcd934x_put_iir_band_audio_mixer(\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct wcd_iir_filter_ctl *ctl =\n\t\t\t(struct wcd_iir_filter_ctl *)kcontrol->private_value;\n\tstruct soc_bytes_ext *params = &ctl->bytes_ext;\n\tint iir_idx = ctl->iir_idx;\n\tint band_idx = ctl->band_idx;\n\tu32 coeff[BAND_MAX];\n\tint reg = WCD934X_CDC_SIDETONE_IIR0_IIR_COEF_B1_CTL + 16 * iir_idx;\n\n\tmemcpy(&coeff[0], ucontrol->value.bytes.data, params->max);\n\n\t \n\t \n\tsnd_soc_component_write(component, reg, (band_idx * BAND_MAX *\n\t\t\t\t\t\t sizeof(uint32_t)) & 0x7F);\n\n\tset_iir_band_coeff(component, iir_idx, band_idx, coeff[0]);\n\tset_iir_band_coeff(component, iir_idx, band_idx, coeff[1]);\n\tset_iir_band_coeff(component, iir_idx, band_idx, coeff[2]);\n\tset_iir_band_coeff(component, iir_idx, band_idx, coeff[3]);\n\tset_iir_band_coeff(component, iir_idx, band_idx, coeff[4]);\n\n\treturn 0;\n}\n\nstatic int wcd934x_get_iir_band_audio_mixer(struct snd_kcontrol *kcontrol,\n\t\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct wcd_iir_filter_ctl *ctl =\n\t\t\t(struct wcd_iir_filter_ctl *)kcontrol->private_value;\n\tstruct soc_bytes_ext *params = &ctl->bytes_ext;\n\tint iir_idx = ctl->iir_idx;\n\tint band_idx = ctl->band_idx;\n\tu32 coeff[BAND_MAX];\n\n\tcoeff[0] = get_iir_band_coeff(component, iir_idx, band_idx, 0);\n\tcoeff[1] = get_iir_band_coeff(component, iir_idx, band_idx, 1);\n\tcoeff[2] = get_iir_band_coeff(component, iir_idx, band_idx, 2);\n\tcoeff[3] = get_iir_band_coeff(component, iir_idx, band_idx, 3);\n\tcoeff[4] = get_iir_band_coeff(component, iir_idx, band_idx, 4);\n\n\tmemcpy(ucontrol->value.bytes.data, &coeff[0], params->max);\n\n\treturn 0;\n}\n\nstatic int wcd934x_iir_filter_info(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_info *ucontrol)\n{\n\tstruct wcd_iir_filter_ctl *ctl =\n\t\t(struct wcd_iir_filter_ctl *)kcontrol->private_value;\n\tstruct soc_bytes_ext *params = &ctl->bytes_ext;\n\n\tucontrol->type = SNDRV_CTL_ELEM_TYPE_BYTES;\n\tucontrol->count = params->max;\n\n\treturn 0;\n}\n\nstatic int wcd934x_compander_get(struct snd_kcontrol *kc,\n\t\t\t\t struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kc);\n\tint comp = ((struct soc_mixer_control *)kc->private_value)->shift;\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\n\tucontrol->value.integer.value[0] = wcd->comp_enabled[comp];\n\n\treturn 0;\n}\n\nstatic int wcd934x_compander_set(struct snd_kcontrol *kc,\n\t\t\t\t struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tint comp = ((struct soc_mixer_control *)kc->private_value)->shift;\n\tint value = ucontrol->value.integer.value[0];\n\tint sel;\n\n\tif (wcd->comp_enabled[comp] == value)\n\t\treturn 0;\n\n\twcd->comp_enabled[comp] = value;\n\tsel = value ? WCD934X_HPH_GAIN_SRC_SEL_COMPANDER :\n\t\tWCD934X_HPH_GAIN_SRC_SEL_REGISTER;\n\n\t \n\tswitch (comp) {\n\tcase COMPANDER_1:\n\t\t \n\t\tsnd_soc_component_update_bits(component, WCD934X_HPH_L_EN,\n\t\t\t\t\t      WCD934X_HPH_GAIN_SRC_SEL_MASK,\n\t\t\t\t\t      sel);\n\t\tbreak;\n\tcase COMPANDER_2:\n\t\tsnd_soc_component_update_bits(component, WCD934X_HPH_R_EN,\n\t\t\t\t\t      WCD934X_HPH_GAIN_SRC_SEL_MASK,\n\t\t\t\t\t      sel);\n\t\tbreak;\n\tcase COMPANDER_3:\n\tcase COMPANDER_4:\n\tcase COMPANDER_7:\n\tcase COMPANDER_8:\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}\n\nstatic int wcd934x_rx_hph_mode_get(struct snd_kcontrol *kc,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\n\tucontrol->value.enumerated.item[0] = wcd->hph_mode;\n\n\treturn 0;\n}\n\nstatic int wcd934x_rx_hph_mode_put(struct snd_kcontrol *kc,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tu32 mode_val;\n\n\tmode_val = ucontrol->value.enumerated.item[0];\n\n\tif (mode_val == wcd->hph_mode)\n\t\treturn 0;\n\n\tif (mode_val == 0) {\n\t\tdev_err(wcd->dev, \"Invalid HPH Mode, default to ClSH HiFi\\n\");\n\t\tmode_val = CLS_H_LOHIFI;\n\t}\n\twcd->hph_mode = mode_val;\n\n\treturn 1;\n}\n\nstatic int slim_rx_mux_get(struct snd_kcontrol *kc,\n\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_dapm_kcontrol_dapm(kc);\n\tstruct snd_soc_dapm_widget *w = snd_soc_dapm_kcontrol_widget(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(dapm->dev);\n\n\tucontrol->value.enumerated.item[0] = wcd->rx_port_value[w->shift];\n\n\treturn 0;\n}\n\nstatic int slim_rx_mux_to_dai_id(int mux)\n{\n\tint aif_id;\n\n\tswitch (mux) {\n\tcase 1:\n\t\taif_id = AIF1_PB;\n\t\tbreak;\n\tcase 2:\n\t\taif_id = AIF2_PB;\n\t\tbreak;\n\tcase 3:\n\t\taif_id = AIF3_PB;\n\t\tbreak;\n\tcase 4:\n\t\taif_id = AIF4_PB;\n\t\tbreak;\n\tdefault:\n\t\taif_id = -1;\n\t\tbreak;\n\t}\n\n\treturn aif_id;\n}\n\nstatic int slim_rx_mux_put(struct snd_kcontrol *kc,\n\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_dapm_widget *w = snd_soc_dapm_kcontrol_widget(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(w->dapm->dev);\n\tstruct soc_enum *e = (struct soc_enum *)kc->private_value;\n\tstruct snd_soc_dapm_update *update = NULL;\n\tstruct wcd934x_slim_ch *ch, *c;\n\tu32 port_id = w->shift;\n\tbool found = false;\n\tint mux_idx;\n\tint prev_mux_idx = wcd->rx_port_value[port_id];\n\tint aif_id;\n\n\tmux_idx = ucontrol->value.enumerated.item[0];\n\n\tif (mux_idx == prev_mux_idx)\n\t\treturn 0;\n\n\tswitch(mux_idx) {\n\tcase 0:\n\t\taif_id = slim_rx_mux_to_dai_id(prev_mux_idx);\n\t\tif (aif_id < 0)\n\t\t\treturn 0;\n\n\t\tlist_for_each_entry_safe(ch, c, &wcd->dai[aif_id].slim_ch_list, list) {\n\t\t\tif (ch->port == port_id + WCD934X_RX_START) {\n\t\t\t\tfound = true;\n\t\t\t\tlist_del_init(&ch->list);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!found)\n\t\t\treturn 0;\n\n\t\tbreak;\n\tcase 1 ... 4:\n\t\taif_id = slim_rx_mux_to_dai_id(mux_idx);\n\t\tif (aif_id < 0)\n\t\t\treturn 0;\n\n\t\tif (list_empty(&wcd->rx_chs[port_id].list)) {\n\t\t\tlist_add_tail(&wcd->rx_chs[port_id].list,\n\t\t\t\t      &wcd->dai[aif_id].slim_ch_list);\n\t\t} else {\n\t\t\tdev_err(wcd->dev ,\"SLIM_RX%d PORT is busy\\n\", port_id);\n\t\t\treturn 0;\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tdev_err(wcd->dev, \"Unknown AIF %d\\n\", mux_idx);\n\t\tgoto err;\n\t}\n\n\twcd->rx_port_value[port_id] = mux_idx;\n\tsnd_soc_dapm_mux_update_power(w->dapm, kc, wcd->rx_port_value[port_id],\n\t\t\t\t      e, update);\n\n\treturn 1;\nerr:\n\treturn -EINVAL;\n}\n\nstatic int wcd934x_int_dem_inp_mux_put(struct snd_kcontrol *kc,\n\t\t\t\t       struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_enum *e = (struct soc_enum *)kc->private_value;\n\tstruct snd_soc_component *component;\n\tint reg, val;\n\n\tcomponent = snd_soc_dapm_kcontrol_component(kc);\n\tval = ucontrol->value.enumerated.item[0];\n\tif (e->reg == WCD934X_CDC_RX0_RX_PATH_SEC0)\n\t\treg = WCD934X_CDC_RX0_RX_PATH_CFG0;\n\telse if (e->reg == WCD934X_CDC_RX1_RX_PATH_SEC0)\n\t\treg = WCD934X_CDC_RX1_RX_PATH_CFG0;\n\telse if (e->reg == WCD934X_CDC_RX2_RX_PATH_SEC0)\n\t\treg = WCD934X_CDC_RX2_RX_PATH_CFG0;\n\telse\n\t\treturn -EINVAL;\n\n\t \n\tif (val)\n\t\tsnd_soc_component_update_bits(component, reg,\n\t\t\t\t\t      WCD934X_RX_DLY_ZN_EN_MASK,\n\t\t\t\t\t      WCD934X_RX_DLY_ZN_ENABLE);\n\telse\n\t\tsnd_soc_component_update_bits(component, reg,\n\t\t\t\t\t      WCD934X_RX_DLY_ZN_EN_MASK,\n\t\t\t\t\t      WCD934X_RX_DLY_ZN_DISABLE);\n\n\treturn snd_soc_dapm_put_enum_double(kc, ucontrol);\n}\n\nstatic int wcd934x_dec_enum_put(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *comp;\n\tstruct soc_enum *e = (struct soc_enum *)kcontrol->private_value;\n\tunsigned int val;\n\tu16 mic_sel_reg = 0;\n\tu8 mic_sel;\n\n\tcomp = snd_soc_dapm_kcontrol_component(kcontrol);\n\n\tval = ucontrol->value.enumerated.item[0];\n\tif (val > e->items - 1)\n\t\treturn -EINVAL;\n\n\tswitch (e->reg) {\n\tcase WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1:\n\t\tif (e->shift_l == 0)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX0_TX_PATH_CFG0;\n\t\telse if (e->shift_l == 2)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX4_TX_PATH_CFG0;\n\t\telse if (e->shift_l == 4)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX8_TX_PATH_CFG0;\n\t\tbreak;\n\tcase WCD934X_CDC_TX_INP_MUX_ADC_MUX1_CFG1:\n\t\tif (e->shift_l == 0)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX1_TX_PATH_CFG0;\n\t\telse if (e->shift_l == 2)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX5_TX_PATH_CFG0;\n\t\tbreak;\n\tcase WCD934X_CDC_TX_INP_MUX_ADC_MUX2_CFG1:\n\t\tif (e->shift_l == 0)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX2_TX_PATH_CFG0;\n\t\telse if (e->shift_l == 2)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX6_TX_PATH_CFG0;\n\t\tbreak;\n\tcase WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1:\n\t\tif (e->shift_l == 0)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX3_TX_PATH_CFG0;\n\t\telse if (e->shift_l == 2)\n\t\t\tmic_sel_reg = WCD934X_CDC_TX7_TX_PATH_CFG0;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(comp->dev, \"%s: e->reg: 0x%x not expected\\n\",\n\t\t\t__func__, e->reg);\n\t\treturn -EINVAL;\n\t}\n\n\t \n\tmic_sel = val ? 0x0 : 0x1;\n\tif (mic_sel_reg)\n\t\tsnd_soc_component_update_bits(comp, mic_sel_reg, BIT(7),\n\t\t\t\t\t      mic_sel << 7);\n\n\treturn snd_soc_dapm_put_enum_double(kcontrol, ucontrol);\n}\n\nstatic const struct snd_kcontrol_new rx_int0_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_2 MUX Mux\", rx_int0_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_2 MUX Mux\", rx_int1_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_2 MUX Mux\", rx_int2_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_2 MUX Mux\", rx_int3_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_2 MUX Mux\", rx_int4_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_2 MUX Mux\", rx_int7_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_2_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_2 MUX Mux\", rx_int8_2_mux_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int0_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_1 MIX1 INP0 Mux\", rx_int0_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int0_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_1 MIX1 INP1 Mux\", rx_int0_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int0_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_1 MIX1 INP2 Mux\", rx_int0_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_1 MIX1 INP0 Mux\", rx_int1_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_1 MIX1 INP1 Mux\", rx_int1_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_1 MIX1 INP2 Mux\", rx_int1_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_1 MIX1 INP0 Mux\", rx_int2_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_1 MIX1 INP1 Mux\", rx_int2_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_1 MIX1 INP2 Mux\", rx_int2_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_1 MIX1 INP0 Mux\", rx_int3_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_1 MIX1 INP1 Mux\", rx_int3_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_1 MIX1 INP2 Mux\", rx_int3_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_1 MIX1 INP0 Mux\", rx_int4_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_1 MIX1 INP1 Mux\", rx_int4_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_1 MIX1 INP2 Mux\", rx_int4_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_1 MIX1 INP0 Mux\", rx_int7_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_1 MIX1 INP1 Mux\", rx_int7_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_1 MIX1 INP2 Mux\", rx_int7_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_1_mix_inp0_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_1 MIX1 INP0 Mux\", rx_int8_1_mix_inp0_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_1_mix_inp1_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_1 MIX1 INP1 Mux\", rx_int8_1_mix_inp1_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_1_mix_inp2_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_1 MIX1 INP2 Mux\", rx_int8_1_mix_inp2_chain_enum);\n\nstatic const struct snd_kcontrol_new rx_int0_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT0 MIX2 INP Mux\", rx_int0_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT1 MIX2 INP Mux\", rx_int1_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT2 MIX2 INP Mux\", rx_int2_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT3 MIX2 INP Mux\", rx_int3_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT4 MIX2 INP Mux\", rx_int4_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_mix2_inp_mux =\n\tSOC_DAPM_ENUM(\"RX INT7 MIX2 INP Mux\", rx_int7_mix2_inp_mux_enum);\n\nstatic const struct snd_kcontrol_new iir0_inp0_mux =\n\tSOC_DAPM_ENUM(\"IIR0 INP0 Mux\", iir0_inp0_mux_enum);\nstatic const struct snd_kcontrol_new iir0_inp1_mux =\n\tSOC_DAPM_ENUM(\"IIR0 INP1 Mux\", iir0_inp1_mux_enum);\nstatic const struct snd_kcontrol_new iir0_inp2_mux =\n\tSOC_DAPM_ENUM(\"IIR0 INP2 Mux\", iir0_inp2_mux_enum);\nstatic const struct snd_kcontrol_new iir0_inp3_mux =\n\tSOC_DAPM_ENUM(\"IIR0 INP3 Mux\", iir0_inp3_mux_enum);\n\nstatic const struct snd_kcontrol_new iir1_inp0_mux =\n\tSOC_DAPM_ENUM(\"IIR1 INP0 Mux\", iir1_inp0_mux_enum);\nstatic const struct snd_kcontrol_new iir1_inp1_mux =\n\tSOC_DAPM_ENUM(\"IIR1 INP1 Mux\", iir1_inp1_mux_enum);\nstatic const struct snd_kcontrol_new iir1_inp2_mux =\n\tSOC_DAPM_ENUM(\"IIR1 INP2 Mux\", iir1_inp2_mux_enum);\nstatic const struct snd_kcontrol_new iir1_inp3_mux =\n\tSOC_DAPM_ENUM(\"IIR1 INP3 Mux\", iir1_inp3_mux_enum);\n\nstatic const struct snd_kcontrol_new slim_rx_mux[WCD934X_RX_MAX] = {\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX0 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX1 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX2 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX3 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX4 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX5 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX6 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n\tSOC_DAPM_ENUM_EXT(\"SLIM RX7 Mux\", slim_rx_mux_enum,\n\t\t\t  slim_rx_mux_get, slim_rx_mux_put),\n};\n\nstatic const struct snd_kcontrol_new rx_int1_asrc_switch[] = {\n\tSOC_DAPM_SINGLE(\"HPHL Switch\", SND_SOC_NOPM, 0, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new rx_int2_asrc_switch[] = {\n\tSOC_DAPM_SINGLE(\"HPHR Switch\", SND_SOC_NOPM, 0, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new rx_int3_asrc_switch[] = {\n\tSOC_DAPM_SINGLE(\"LO1 Switch\", SND_SOC_NOPM, 0, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new rx_int4_asrc_switch[] = {\n\tSOC_DAPM_SINGLE(\"LO2 Switch\", SND_SOC_NOPM, 0, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new rx_int0_dem_inp_mux =\n\tSOC_DAPM_ENUM_EXT(\"RX INT0 DEM MUX Mux\", rx_int0_dem_inp_mux_enum,\n\t\t\t  snd_soc_dapm_get_enum_double,\n\t\t\t  wcd934x_int_dem_inp_mux_put);\n\nstatic const struct snd_kcontrol_new rx_int1_dem_inp_mux =\n\tSOC_DAPM_ENUM_EXT(\"RX INT1 DEM MUX Mux\", rx_int1_dem_inp_mux_enum,\n\t\t\t  snd_soc_dapm_get_enum_double,\n\t\t\t  wcd934x_int_dem_inp_mux_put);\n\nstatic const struct snd_kcontrol_new rx_int2_dem_inp_mux =\n\tSOC_DAPM_ENUM_EXT(\"RX INT2 DEM MUX Mux\", rx_int2_dem_inp_mux_enum,\n\t\t\t  snd_soc_dapm_get_enum_double,\n\t\t\t  wcd934x_int_dem_inp_mux_put);\n\nstatic const struct snd_kcontrol_new rx_int0_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_1 INTERP Mux\", rx_int0_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_1 INTERP Mux\", rx_int1_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_1 INTERP Mux\", rx_int2_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_1 INTERP Mux\", rx_int3_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_1 INTERP Mux\", rx_int4_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_1 INTERP Mux\", rx_int7_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_1_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_1 INTERP Mux\", rx_int8_1_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int0_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT0_2 INTERP Mux\", rx_int0_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int1_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT1_2 INTERP Mux\", rx_int1_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int2_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT2_2 INTERP Mux\", rx_int2_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int3_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT3_2 INTERP Mux\", rx_int3_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int4_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT4_2 INTERP Mux\", rx_int4_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int7_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT7_2 INTERP Mux\", rx_int7_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new rx_int8_2_interp_mux =\n\tSOC_DAPM_ENUM(\"RX INT8_2 INTERP Mux\", rx_int8_2_interp_mux_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux0 =\n\tSOC_DAPM_ENUM(\"DMIC MUX0 Mux\", tx_dmic_mux0_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux1 =\n\tSOC_DAPM_ENUM(\"DMIC MUX1 Mux\", tx_dmic_mux1_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux2 =\n\tSOC_DAPM_ENUM(\"DMIC MUX2 Mux\", tx_dmic_mux2_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux3 =\n\tSOC_DAPM_ENUM(\"DMIC MUX3 Mux\", tx_dmic_mux3_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux4 =\n\tSOC_DAPM_ENUM(\"DMIC MUX4 Mux\", tx_dmic_mux4_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux5 =\n\tSOC_DAPM_ENUM(\"DMIC MUX5 Mux\", tx_dmic_mux5_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux6 =\n\tSOC_DAPM_ENUM(\"DMIC MUX6 Mux\", tx_dmic_mux6_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux7 =\n\tSOC_DAPM_ENUM(\"DMIC MUX7 Mux\", tx_dmic_mux7_enum);\n\nstatic const struct snd_kcontrol_new tx_dmic_mux8 =\n\tSOC_DAPM_ENUM(\"DMIC MUX8 Mux\", tx_dmic_mux8_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux0 =\n\tSOC_DAPM_ENUM(\"AMIC MUX0 Mux\", tx_amic_mux0_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux1 =\n\tSOC_DAPM_ENUM(\"AMIC MUX1 Mux\", tx_amic_mux1_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux2 =\n\tSOC_DAPM_ENUM(\"AMIC MUX2 Mux\", tx_amic_mux2_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux3 =\n\tSOC_DAPM_ENUM(\"AMIC MUX3 Mux\", tx_amic_mux3_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux4 =\n\tSOC_DAPM_ENUM(\"AMIC MUX4 Mux\", tx_amic_mux4_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux5 =\n\tSOC_DAPM_ENUM(\"AMIC MUX5 Mux\", tx_amic_mux5_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux6 =\n\tSOC_DAPM_ENUM(\"AMIC MUX6 Mux\", tx_amic_mux6_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux7 =\n\tSOC_DAPM_ENUM(\"AMIC MUX7 Mux\", tx_amic_mux7_enum);\n\nstatic const struct snd_kcontrol_new tx_amic_mux8 =\n\tSOC_DAPM_ENUM(\"AMIC MUX8 Mux\", tx_amic_mux8_enum);\n\nstatic const struct snd_kcontrol_new tx_amic4_5 =\n\tSOC_DAPM_ENUM(\"AMIC4_5 SEL Mux\", tx_amic4_5_enum);\n\nstatic const struct snd_kcontrol_new tx_adc_mux0_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX0 Mux\", tx_adc_mux0_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux1_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX1 Mux\", tx_adc_mux1_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux2_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX2 Mux\", tx_adc_mux2_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux3_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX3 Mux\", tx_adc_mux3_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux4_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX4 Mux\", tx_adc_mux4_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux5_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX5 Mux\", tx_adc_mux5_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux6_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX6 Mux\", tx_adc_mux6_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux7_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX7 Mux\", tx_adc_mux7_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\nstatic const struct snd_kcontrol_new tx_adc_mux8_mux =\n\tSOC_DAPM_ENUM_EXT(\"ADC MUX8 Mux\", tx_adc_mux8_enum,\n\t\t\t  snd_soc_dapm_get_enum_double, wcd934x_dec_enum_put);\n\nstatic const struct snd_kcontrol_new cdc_if_tx0_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX0 MUX Mux\", cdc_if_tx0_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx1_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX1 MUX Mux\", cdc_if_tx1_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx2_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX2 MUX Mux\", cdc_if_tx2_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx3_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX3 MUX Mux\", cdc_if_tx3_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx4_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX4 MUX Mux\", cdc_if_tx4_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx5_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX5 MUX Mux\", cdc_if_tx5_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx6_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX6 MUX Mux\", cdc_if_tx6_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx7_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX7 MUX Mux\", cdc_if_tx7_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx8_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX8 MUX Mux\", cdc_if_tx8_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx9_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX9 MUX Mux\", cdc_if_tx9_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx10_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX10 MUX Mux\", cdc_if_tx10_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx11_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX11 MUX Mux\", cdc_if_tx11_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx11_inp1_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX11 INP1 MUX Mux\", cdc_if_tx11_inp1_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx13_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX13 MUX Mux\", cdc_if_tx13_mux_enum);\nstatic const struct snd_kcontrol_new cdc_if_tx13_inp1_mux =\n\tSOC_DAPM_ENUM(\"CDC_IF TX13 INP1 MUX Mux\", cdc_if_tx13_inp1_mux_enum);\n\nstatic int slim_tx_mixer_get(struct snd_kcontrol *kc,\n\t\t\t     struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_dapm_kcontrol_dapm(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(dapm->dev);\n\tstruct soc_mixer_control *mixer =\n\t\t\t(struct soc_mixer_control *)kc->private_value;\n\tint port_id = mixer->shift;\n\n\tucontrol->value.integer.value[0] = wcd->tx_port_value[port_id];\n\n\treturn 0;\n}\n\nstatic int slim_tx_mixer_put(struct snd_kcontrol *kc,\n\t\t\t     struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_dapm_widget *widget = snd_soc_dapm_kcontrol_widget(kc);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(widget->dapm->dev);\n\tstruct snd_soc_dapm_update *update = NULL;\n\tstruct soc_mixer_control *mixer =\n\t\t\t(struct soc_mixer_control *)kc->private_value;\n\tint enable = ucontrol->value.integer.value[0];\n\tstruct wcd934x_slim_ch *ch, *c;\n\tint dai_id = widget->shift;\n\tint port_id = mixer->shift;\n\n\t \n\tif (enable == wcd->tx_port_value[port_id])\n\t\treturn 0;\n\n\tif (enable) {\n\t\tif (list_empty(&wcd->tx_chs[port_id].list)) {\n\t\t\tlist_add_tail(&wcd->tx_chs[port_id].list,\n\t\t\t\t      &wcd->dai[dai_id].slim_ch_list);\n\t\t} else {\n\t\t\tdev_err(wcd->dev ,\"SLIM_TX%d PORT is busy\\n\", port_id);\n\t\t\treturn 0;\n\t\t}\n\t } else {\n\t\tbool found = false;\n\n\t\tlist_for_each_entry_safe(ch, c, &wcd->dai[dai_id].slim_ch_list, list) {\n\t\t\tif (ch->port == port_id) {\n\t\t\t\tfound = true;\n\t\t\t\tlist_del_init(&wcd->tx_chs[port_id].list);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!found)\n\t\t\treturn 0;\n\t }\n\n\twcd->tx_port_value[port_id] = enable;\n\tsnd_soc_dapm_mixer_update_power(widget->dapm, kc, enable, update);\n\n\treturn 1;\n}\n\nstatic const struct snd_kcontrol_new aif1_slim_cap_mixer[] = {\n\tSOC_SINGLE_EXT(\"SLIM TX0\", SND_SOC_NOPM, WCD934X_TX0, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX1\", SND_SOC_NOPM, WCD934X_TX1, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX2\", SND_SOC_NOPM, WCD934X_TX2, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX3\", SND_SOC_NOPM, WCD934X_TX3, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX4\", SND_SOC_NOPM, WCD934X_TX4, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX5\", SND_SOC_NOPM, WCD934X_TX5, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX6\", SND_SOC_NOPM, WCD934X_TX6, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX7\", SND_SOC_NOPM, WCD934X_TX7, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX8\", SND_SOC_NOPM, WCD934X_TX8, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX9\", SND_SOC_NOPM, WCD934X_TX9, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX10\", SND_SOC_NOPM, WCD934X_TX10, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX11\", SND_SOC_NOPM, WCD934X_TX11, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX13\", SND_SOC_NOPM, WCD934X_TX13, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n};\n\nstatic const struct snd_kcontrol_new aif2_slim_cap_mixer[] = {\n\tSOC_SINGLE_EXT(\"SLIM TX0\", SND_SOC_NOPM, WCD934X_TX0, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX1\", SND_SOC_NOPM, WCD934X_TX1, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX2\", SND_SOC_NOPM, WCD934X_TX2, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX3\", SND_SOC_NOPM, WCD934X_TX3, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX4\", SND_SOC_NOPM, WCD934X_TX4, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX5\", SND_SOC_NOPM, WCD934X_TX5, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX6\", SND_SOC_NOPM, WCD934X_TX6, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX7\", SND_SOC_NOPM, WCD934X_TX7, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX8\", SND_SOC_NOPM, WCD934X_TX8, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX9\", SND_SOC_NOPM, WCD934X_TX9, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX10\", SND_SOC_NOPM, WCD934X_TX10, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX11\", SND_SOC_NOPM, WCD934X_TX11, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX13\", SND_SOC_NOPM, WCD934X_TX13, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n};\n\nstatic const struct snd_kcontrol_new aif3_slim_cap_mixer[] = {\n\tSOC_SINGLE_EXT(\"SLIM TX0\", SND_SOC_NOPM, WCD934X_TX0, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX1\", SND_SOC_NOPM, WCD934X_TX1, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX2\", SND_SOC_NOPM, WCD934X_TX2, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX3\", SND_SOC_NOPM, WCD934X_TX3, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX4\", SND_SOC_NOPM, WCD934X_TX4, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX5\", SND_SOC_NOPM, WCD934X_TX5, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX6\", SND_SOC_NOPM, WCD934X_TX6, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX7\", SND_SOC_NOPM, WCD934X_TX7, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX8\", SND_SOC_NOPM, WCD934X_TX8, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX9\", SND_SOC_NOPM, WCD934X_TX9, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX10\", SND_SOC_NOPM, WCD934X_TX10, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX11\", SND_SOC_NOPM, WCD934X_TX11, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n\tSOC_SINGLE_EXT(\"SLIM TX13\", SND_SOC_NOPM, WCD934X_TX13, 1, 0,\n\t\t       slim_tx_mixer_get, slim_tx_mixer_put),\n};\n\nstatic const struct snd_kcontrol_new wcd934x_snd_controls[] = {\n\t \n\tSOC_SINGLE_TLV(\"EAR PA Volume\", WCD934X_ANA_EAR, 4, 4, 1, ear_pa_gain),\n\tSOC_SINGLE_TLV(\"HPHL Volume\", WCD934X_HPH_L_EN, 0, 24, 1, line_gain),\n\tSOC_SINGLE_TLV(\"HPHR Volume\", WCD934X_HPH_R_EN, 0, 24, 1, line_gain),\n\tSOC_SINGLE_TLV(\"LINEOUT1 Volume\", WCD934X_DIFF_LO_LO1_COMPANDER,\n\t\t       3, 16, 1, line_gain),\n\tSOC_SINGLE_TLV(\"LINEOUT2 Volume\", WCD934X_DIFF_LO_LO2_COMPANDER,\n\t\t       3, 16, 1, line_gain),\n\n\tSOC_SINGLE_TLV(\"ADC1 Volume\", WCD934X_ANA_AMIC1, 0, 20, 0, analog_gain),\n\tSOC_SINGLE_TLV(\"ADC2 Volume\", WCD934X_ANA_AMIC2, 0, 20, 0, analog_gain),\n\tSOC_SINGLE_TLV(\"ADC3 Volume\", WCD934X_ANA_AMIC3, 0, 20, 0, analog_gain),\n\tSOC_SINGLE_TLV(\"ADC4 Volume\", WCD934X_ANA_AMIC4, 0, 20, 0, analog_gain),\n\n\tSOC_SINGLE_S8_TLV(\"RX0 Digital Volume\", WCD934X_CDC_RX0_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),  \n\tSOC_SINGLE_S8_TLV(\"RX1 Digital Volume\", WCD934X_CDC_RX1_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX2 Digital Volume\", WCD934X_CDC_RX2_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX3 Digital Volume\", WCD934X_CDC_RX3_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX4 Digital Volume\", WCD934X_CDC_RX4_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX7 Digital Volume\", WCD934X_CDC_RX7_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX8 Digital Volume\", WCD934X_CDC_RX8_RX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX0 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX0_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX1 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX1_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX2 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX2_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX3 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX3_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX4 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX4_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX7 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX7_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"RX8 Mix Digital Volume\",\n\t\t\t  WCD934X_CDC_RX8_RX_VOL_MIX_CTL,\n\t\t\t  -84, 40, digital_gain),\n\n\tSOC_SINGLE_S8_TLV(\"DEC0 Volume\", WCD934X_CDC_TX0_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC1 Volume\", WCD934X_CDC_TX1_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC2 Volume\", WCD934X_CDC_TX2_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC3 Volume\", WCD934X_CDC_TX3_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC4 Volume\", WCD934X_CDC_TX4_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC5 Volume\", WCD934X_CDC_TX5_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC6 Volume\", WCD934X_CDC_TX6_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC7 Volume\", WCD934X_CDC_TX7_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\tSOC_SINGLE_S8_TLV(\"DEC8 Volume\", WCD934X_CDC_TX8_TX_VOL_CTL,\n\t\t\t  -84, 40, digital_gain),\n\n\tSOC_SINGLE_S8_TLV(\"IIR0 INP0 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR0_IIR_GAIN_B1_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR0 INP1 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR0_IIR_GAIN_B2_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR0 INP2 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR0_IIR_GAIN_B3_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR0 INP3 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR0_IIR_GAIN_B4_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR1 INP0 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR1_IIR_GAIN_B1_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR1 INP1 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR1_IIR_GAIN_B2_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR1 INP2 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR1_IIR_GAIN_B3_CTL, -84, 40,\n\t\t\t  digital_gain),\n\tSOC_SINGLE_S8_TLV(\"IIR1 INP3 Volume\",\n\t\t\t  WCD934X_CDC_SIDETONE_IIR1_IIR_GAIN_B4_CTL, -84, 40,\n\t\t\t  digital_gain),\n\n\tSOC_ENUM(\"TX0 HPF cut off\", cf_dec0_enum),\n\tSOC_ENUM(\"TX1 HPF cut off\", cf_dec1_enum),\n\tSOC_ENUM(\"TX2 HPF cut off\", cf_dec2_enum),\n\tSOC_ENUM(\"TX3 HPF cut off\", cf_dec3_enum),\n\tSOC_ENUM(\"TX4 HPF cut off\", cf_dec4_enum),\n\tSOC_ENUM(\"TX5 HPF cut off\", cf_dec5_enum),\n\tSOC_ENUM(\"TX6 HPF cut off\", cf_dec6_enum),\n\tSOC_ENUM(\"TX7 HPF cut off\", cf_dec7_enum),\n\tSOC_ENUM(\"TX8 HPF cut off\", cf_dec8_enum),\n\n\tSOC_ENUM(\"RX INT0_1 HPF cut off\", cf_int0_1_enum),\n\tSOC_ENUM(\"RX INT0_2 HPF cut off\", cf_int0_2_enum),\n\tSOC_ENUM(\"RX INT1_1 HPF cut off\", cf_int1_1_enum),\n\tSOC_ENUM(\"RX INT1_2 HPF cut off\", cf_int1_2_enum),\n\tSOC_ENUM(\"RX INT2_1 HPF cut off\", cf_int2_1_enum),\n\tSOC_ENUM(\"RX INT2_2 HPF cut off\", cf_int2_2_enum),\n\tSOC_ENUM(\"RX INT3_1 HPF cut off\", cf_int3_1_enum),\n\tSOC_ENUM(\"RX INT3_2 HPF cut off\", cf_int3_2_enum),\n\tSOC_ENUM(\"RX INT4_1 HPF cut off\", cf_int4_1_enum),\n\tSOC_ENUM(\"RX INT4_2 HPF cut off\", cf_int4_2_enum),\n\tSOC_ENUM(\"RX INT7_1 HPF cut off\", cf_int7_1_enum),\n\tSOC_ENUM(\"RX INT7_2 HPF cut off\", cf_int7_2_enum),\n\tSOC_ENUM(\"RX INT8_1 HPF cut off\", cf_int8_1_enum),\n\tSOC_ENUM(\"RX INT8_2 HPF cut off\", cf_int8_2_enum),\n\n\tSOC_ENUM_EXT(\"RX HPH Mode\", rx_hph_mode_mux_enum,\n\t\t     wcd934x_rx_hph_mode_get, wcd934x_rx_hph_mode_put),\n\n\tSOC_SINGLE(\"IIR1 Band1 Switch\", WCD934X_CDC_SIDETONE_IIR0_IIR_CTL,\n\t\t   0, 1, 0),\n\tSOC_SINGLE(\"IIR1 Band2 Switch\", WCD934X_CDC_SIDETONE_IIR0_IIR_CTL,\n\t\t   1, 1, 0),\n\tSOC_SINGLE(\"IIR1 Band3 Switch\", WCD934X_CDC_SIDETONE_IIR0_IIR_CTL,\n\t\t   2, 1, 0),\n\tSOC_SINGLE(\"IIR1 Band4 Switch\", WCD934X_CDC_SIDETONE_IIR0_IIR_CTL,\n\t\t   3, 1, 0),\n\tSOC_SINGLE(\"IIR1 Band5 Switch\", WCD934X_CDC_SIDETONE_IIR0_IIR_CTL,\n\t\t   4, 1, 0),\n\tSOC_SINGLE(\"IIR2 Band1 Switch\", WCD934X_CDC_SIDETONE_IIR1_IIR_CTL,\n\t\t   0, 1, 0),\n\tSOC_SINGLE(\"IIR2 Band2 Switch\", WCD934X_CDC_SIDETONE_IIR1_IIR_CTL,\n\t\t   1, 1, 0),\n\tSOC_SINGLE(\"IIR2 Band3 Switch\", WCD934X_CDC_SIDETONE_IIR1_IIR_CTL,\n\t\t   2, 1, 0),\n\tSOC_SINGLE(\"IIR2 Band4 Switch\", WCD934X_CDC_SIDETONE_IIR1_IIR_CTL,\n\t\t   3, 1, 0),\n\tSOC_SINGLE(\"IIR2 Band5 Switch\", WCD934X_CDC_SIDETONE_IIR1_IIR_CTL,\n\t\t   4, 1, 0),\n\tWCD_IIR_FILTER_CTL(\"IIR0 Band1\", IIR0, BAND1),\n\tWCD_IIR_FILTER_CTL(\"IIR0 Band2\", IIR0, BAND2),\n\tWCD_IIR_FILTER_CTL(\"IIR0 Band3\", IIR0, BAND3),\n\tWCD_IIR_FILTER_CTL(\"IIR0 Band4\", IIR0, BAND4),\n\tWCD_IIR_FILTER_CTL(\"IIR0 Band5\", IIR0, BAND5),\n\n\tWCD_IIR_FILTER_CTL(\"IIR1 Band1\", IIR1, BAND1),\n\tWCD_IIR_FILTER_CTL(\"IIR1 Band2\", IIR1, BAND2),\n\tWCD_IIR_FILTER_CTL(\"IIR1 Band3\", IIR1, BAND3),\n\tWCD_IIR_FILTER_CTL(\"IIR1 Band4\", IIR1, BAND4),\n\tWCD_IIR_FILTER_CTL(\"IIR1 Band5\", IIR1, BAND5),\n\n\tSOC_SINGLE_EXT(\"COMP1 Switch\", SND_SOC_NOPM, COMPANDER_1, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n\tSOC_SINGLE_EXT(\"COMP2 Switch\", SND_SOC_NOPM, COMPANDER_2, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n\tSOC_SINGLE_EXT(\"COMP3 Switch\", SND_SOC_NOPM, COMPANDER_3, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n\tSOC_SINGLE_EXT(\"COMP4 Switch\", SND_SOC_NOPM, COMPANDER_4, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n\tSOC_SINGLE_EXT(\"COMP7 Switch\", SND_SOC_NOPM, COMPANDER_7, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n\tSOC_SINGLE_EXT(\"COMP8 Switch\", SND_SOC_NOPM, COMPANDER_8, 1, 0,\n\t\t       wcd934x_compander_get, wcd934x_compander_set),\n};\n\nstatic void wcd934x_codec_enable_int_port(struct wcd_slim_codec_dai_data *dai,\n\t\t\t\t\t  struct snd_soc_component *component)\n{\n\tint port_num = 0;\n\tunsigned short reg = 0;\n\tunsigned int val = 0;\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(component->dev);\n\tstruct wcd934x_slim_ch *ch;\n\n\tlist_for_each_entry(ch, &dai->slim_ch_list, list) {\n\t\tif (ch->port >= WCD934X_RX_START) {\n\t\t\tport_num = ch->port - WCD934X_RX_START;\n\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_EN0 + (port_num / 8);\n\t\t} else {\n\t\t\tport_num = ch->port;\n\t\t\treg = WCD934X_SLIM_PGD_PORT_INT_TX_EN0 + (port_num / 8);\n\t\t}\n\n\t\tregmap_read(wcd->if_regmap, reg, &val);\n\t\tif (!(val & BIT(port_num % 8)))\n\t\t\tregmap_write(wcd->if_regmap, reg,\n\t\t\t\t     val | BIT(port_num % 8));\n\t}\n}\n\nstatic int wcd934x_codec_enable_slim(struct snd_soc_dapm_widget *w,\n\t\t\t\t     struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(comp);\n\tstruct wcd_slim_codec_dai_data *dai = &wcd->dai[w->shift];\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\twcd934x_codec_enable_int_port(dai, comp);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic void wcd934x_codec_hd2_control(struct snd_soc_component *component,\n\t\t\t\t      u16 interp_idx, int event)\n{\n\tu16 hd2_scale_reg;\n\tu16 hd2_enable_reg = 0;\n\n\tswitch (interp_idx) {\n\tcase INTERP_HPHL:\n\t\thd2_scale_reg = WCD934X_CDC_RX1_RX_PATH_SEC3;\n\t\thd2_enable_reg = WCD934X_CDC_RX1_RX_PATH_CFG0;\n\t\tbreak;\n\tcase INTERP_HPHR:\n\t\thd2_scale_reg = WCD934X_CDC_RX2_RX_PATH_SEC3;\n\t\thd2_enable_reg = WCD934X_CDC_RX2_RX_PATH_CFG0;\n\t\tbreak;\n\tdefault:\n\t\treturn;\n\t}\n\n\tif (SND_SOC_DAPM_EVENT_ON(event)) {\n\t\tsnd_soc_component_update_bits(component, hd2_scale_reg,\n\t\t\t\t      WCD934X_CDC_RX_PATH_SEC_HD2_ALPHA_MASK,\n\t\t\t\t      WCD934X_CDC_RX_PATH_SEC_HD2_ALPHA_0P3125);\n\t\tsnd_soc_component_update_bits(component, hd2_enable_reg,\n\t\t\t\t      WCD934X_CDC_RX_PATH_CFG_HD2_EN_MASK,\n\t\t\t\t      WCD934X_CDC_RX_PATH_CFG_HD2_ENABLE);\n\t}\n\n\tif (SND_SOC_DAPM_EVENT_OFF(event)) {\n\t\tsnd_soc_component_update_bits(component, hd2_enable_reg,\n\t\t\t\t      WCD934X_CDC_RX_PATH_CFG_HD2_EN_MASK,\n\t\t\t\t      WCD934X_CDC_RX_PATH_CFG_HD2_DISABLE);\n\t\tsnd_soc_component_update_bits(component, hd2_scale_reg,\n\t\t\t\t      WCD934X_CDC_RX_PATH_SEC_HD2_ALPHA_MASK,\n\t\t\t\t      WCD934X_CDC_RX_PATH_SEC_HD2_ALPHA_0P0000);\n\t}\n}\n\nstatic void wcd934x_codec_hphdelay_lutbypass(struct snd_soc_component *comp,\n\t\t\t\t\t     u16 interp_idx, int event)\n{\n\tu8 hph_dly_mask;\n\tu16 hph_lut_bypass_reg = 0;\n\n\tswitch (interp_idx) {\n\tcase INTERP_HPHL:\n\t\thph_dly_mask = 1;\n\t\thph_lut_bypass_reg = WCD934X_CDC_TOP_HPHL_COMP_LUT;\n\t\tbreak;\n\tcase INTERP_HPHR:\n\t\thph_dly_mask = 2;\n\t\thph_lut_bypass_reg = WCD934X_CDC_TOP_HPHR_COMP_LUT;\n\t\tbreak;\n\tdefault:\n\t\treturn;\n\t}\n\n\tif (SND_SOC_DAPM_EVENT_ON(event)) {\n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_CLSH_TEST0,\n\t\t\t\t\t      hph_dly_mask, 0x0);\n\t\tsnd_soc_component_update_bits(comp, hph_lut_bypass_reg,\n\t\t\t\t\t      WCD934X_HPH_LUT_BYPASS_MASK,\n\t\t\t\t\t      WCD934X_HPH_LUT_BYPASS_ENABLE);\n\t}\n\n\tif (SND_SOC_DAPM_EVENT_OFF(event)) {\n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_CLSH_TEST0,\n\t\t\t\t\t      hph_dly_mask, hph_dly_mask);\n\t\tsnd_soc_component_update_bits(comp, hph_lut_bypass_reg,\n\t\t\t\t\t      WCD934X_HPH_LUT_BYPASS_MASK,\n\t\t\t\t\t      WCD934X_HPH_LUT_BYPASS_DISABLE);\n\t}\n}\n\nstatic int wcd934x_config_compander(struct snd_soc_component *comp,\n\t\t\t\t    int interp_n, int event)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tint compander;\n\tu16 comp_ctl0_reg, rx_path_cfg0_reg;\n\n\t \n\tif (!interp_n)\n\t\treturn 0;\n\n\tcompander = interp_n - 1;\n\tif (!wcd->comp_enabled[compander])\n\t\treturn 0;\n\n\tcomp_ctl0_reg = WCD934X_CDC_COMPANDER1_CTL0 + (compander * 8);\n\trx_path_cfg0_reg = WCD934X_CDC_RX1_RX_PATH_CFG0 + (compander * 20);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_CLK_EN_MASK,\n\t\t\t\t\t      WCD934X_COMP_CLK_ENABLE);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_MASK,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_ENABLE);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_MASK,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_DISABLE);\n\t\tsnd_soc_component_update_bits(comp, rx_path_cfg0_reg,\n\t\t\t\t\t      WCD934X_HPH_CMP_EN_MASK,\n\t\t\t\t\t      WCD934X_HPH_CMP_ENABLE);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tsnd_soc_component_update_bits(comp, rx_path_cfg0_reg,\n\t\t\t\t\t      WCD934X_HPH_CMP_EN_MASK,\n\t\t\t\t\t      WCD934X_HPH_CMP_DISABLE);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_HALT_MASK,\n\t\t\t\t\t      WCD934X_COMP_HALT);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_MASK,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_ENABLE);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_MASK,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_DISABLE);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_CLK_EN_MASK, 0x0);\n\t\tsnd_soc_component_update_bits(comp, comp_ctl0_reg,\n\t\t\t\t\t      WCD934X_COMP_SOFT_RST_MASK, 0x0);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_interp_clk(struct snd_soc_dapm_widget *w,\n\t\t\t\t\t struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tint interp_idx = w->shift;\n\tu16 main_reg = WCD934X_CDC_RX0_RX_PATH_CTL + (interp_idx * 20);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tsnd_soc_component_update_bits(comp, main_reg,\n\t\t\t\t\t     WCD934X_RX_CLK_EN_MASK,\n\t\t\t\t\t     WCD934X_RX_CLK_ENABLE);\n\t\twcd934x_codec_hd2_control(comp, interp_idx, event);\n\t\twcd934x_codec_hphdelay_lutbypass(comp, interp_idx, event);\n\t\twcd934x_config_compander(comp, interp_idx, event);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\twcd934x_config_compander(comp, interp_idx, event);\n\t\twcd934x_codec_hphdelay_lutbypass(comp, interp_idx, event);\n\t\twcd934x_codec_hd2_control(comp, interp_idx, event);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, main_reg,\n\t\t\t\t\t     WCD934X_RX_CLK_EN_MASK, 0);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, main_reg,\n\t\t\t\t\t      WCD934X_RX_RESET_MASK,\n\t\t\t\t\t      WCD934X_RX_RESET_ENABLE);\n\t\tsnd_soc_component_update_bits(comp, main_reg,\n\t\t\t\t\t      WCD934X_RX_RESET_MASK,\n\t\t\t\t\t      WCD934X_RX_RESET_DISABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, main_reg,\n\t\t\t\t\t      WCD934X_RX_PCM_RATE_MASK,\n\t\t\t\t\t      WCD934X_RX_PCM_RATE_F_48K);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_mix_path(struct snd_soc_dapm_widget *w,\n\t\t\t\t\t struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tint offset_val = 0;\n\tu16 gain_reg, mix_reg;\n\tint val = 0;\n\n\tgain_reg = WCD934X_CDC_RX0_RX_VOL_MIX_CTL +\n\t\t\t\t\t(w->shift * WCD934X_RX_PATH_CTL_OFFSET);\n\tmix_reg = WCD934X_CDC_RX0_RX_PATH_MIX_CTL +\n\t\t\t\t\t(w->shift * WCD934X_RX_PATH_CTL_OFFSET);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tsnd_soc_component_update_bits(comp, mix_reg,\n\t\t\t\t\t      WCD934X_CDC_RX_MIX_CLK_EN_MASK,\n\t\t\t\t\t      WCD934X_CDC_RX_MIX_CLK_ENABLE);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tval = snd_soc_component_read(comp, gain_reg);\n\t\tval += offset_val;\n\t\tsnd_soc_component_write(comp, gain_reg, val);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_set_iir_gain(struct snd_soc_dapm_widget *w,\n\t\t\t\t      struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tint reg = w->reg;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tsnd_soc_component_write(comp, reg,\n\t\t\t\t\tsnd_soc_component_read(comp, reg));\n\t\t \n\t\treg++;\n\t\tsnd_soc_component_write(comp, reg,\n\t\t\t\t\tsnd_soc_component_read(comp, reg));\n\t\t \n\t\treg++;\n\t\tsnd_soc_component_write(comp, reg,\n\t\t\t\t\tsnd_soc_component_read(comp, reg));\n\t\t \n\t\treg++;\n\t\tsnd_soc_component_write(comp, reg,\n\t\t\t\t\tsnd_soc_component_read(comp, reg));\n\t\t \n\t\treg++;\n\t\tsnd_soc_component_write(comp, reg,\n\t\t\t\t\tsnd_soc_component_read(comp, reg));\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_main_path(struct snd_soc_dapm_widget *w,\n\t\t\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t\t\t  int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tu16 gain_reg;\n\n\tgain_reg = WCD934X_CDC_RX0_RX_VOL_CTL + (w->shift *\n\t\t\t\t\t\t WCD934X_RX_PATH_CTL_OFFSET);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tsnd_soc_component_write(comp, gain_reg,\n\t\t\t\tsnd_soc_component_read(comp, gain_reg));\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_ear_dac_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t       struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_HPH_NEW_INT_HPH_TIMER1,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_EN_MASK, 0x0);\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_PRE_DAC,\n\t\t\t\t\tWCD_CLSH_STATE_EAR, CLS_H_NORMAL);\n\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_POST_PA,\n\t\t\t\t\tWCD_CLSH_STATE_EAR, CLS_H_NORMAL);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_hphl_dac_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tint event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tint hph_mode = wcd->hph_mode;\n\tu8 dem_inp;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tdem_inp = snd_soc_component_read(comp,\n\t\t\t\t   WCD934X_CDC_RX1_RX_PATH_SEC0) & 0x03;\n\n\t\tif (((hph_mode == CLS_H_HIFI) || (hph_mode == CLS_H_LOHIFI) ||\n\t\t     (hph_mode == CLS_H_LP)) && (dem_inp != 0x01)) {\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tif (hph_mode != CLS_H_LP)\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\tWCD934X_SIDO_NEW_VOUT_D_FREQ2,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_EN_MASK,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_HPH_NEW_INT_HPH_TIMER1,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_EN_MASK, 0x0);\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_PRE_DAC,\n\t\t\t\t\tWCD_CLSH_STATE_HPHL, hph_mode);\n\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tusleep_range(1000, 1100);\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_POST_PA,\n\t\t\t\t\tWCD_CLSH_STATE_HPHL, hph_mode);\n\t\tif (hph_mode != CLS_H_LP)\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\tWCD934X_SIDO_NEW_VOUT_D_FREQ2,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_EN_MASK, 0x0);\n\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_hphr_dac_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tint event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tint hph_mode = wcd->hph_mode;\n\tu8 dem_inp;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tdem_inp = snd_soc_component_read(comp,\n\t\t\t\t\tWCD934X_CDC_RX2_RX_PATH_SEC0) & 0x03;\n\t\tif (((hph_mode == CLS_H_HIFI) || (hph_mode == CLS_H_LOHIFI) ||\n\t\t     (hph_mode == CLS_H_LP)) && (dem_inp != 0x01)) {\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tif (hph_mode != CLS_H_LP)\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\tWCD934X_SIDO_NEW_VOUT_D_FREQ2,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_EN_MASK,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_HPH_NEW_INT_HPH_TIMER1,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_EN_MASK, 0x0);\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_PRE_DAC,\n\t\t\t\t\tWCD_CLSH_STATE_HPHR,\n\t\t\t     hph_mode);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tusleep_range(1000, 1100);\n\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_POST_PA,\n\t\t\t\t\tWCD_CLSH_STATE_HPHR, hph_mode);\n\t\tif (hph_mode != CLS_H_LP)\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\tWCD934X_SIDO_NEW_VOUT_D_FREQ2,\n\t\t\t\t\tWCD934X_SIDO_RIPPLE_FREQ_EN_MASK, 0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_lineout_dac_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t\t   struct snd_kcontrol *kc, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_PRE_DAC,\n\t\t\t\t\tWCD_CLSH_STATE_LO, CLS_AB);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\twcd_clsh_ctrl_set_state(wcd->clsh_ctrl, WCD_CLSH_EVENT_POST_PA,\n\t\t\t\t\tWCD_CLSH_STATE_LO, CLS_AB);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_hphl_pa(struct snd_soc_dapm_widget *w,\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tint event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(comp);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tusleep_range(20000, 20100);\n\n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_L_TEST,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_MASK,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_RX1_RX_PATH_CTL,\n\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_EN_MASK,\n\t\t\t\t      0);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_CNP_WG_CTL,\n\t\t\t\t\t      WCD934X_HPH_GM3_BOOST_EN_MASK,\n\t\t\t\t\t      WCD934X_HPH_GM3_BOOST_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_HPH_NEW_INT_HPH_TIMER1,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_EN_MASK,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\tWCD934X_CDC_RX1_RX_PATH_MIX_CTL,\n\t\t\t\tWCD934X_CDC_RX_PGA_MUTE_EN_MASK, 0x00);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\twcd_mbhc_event_notify(wcd->mbhc, WCD_EVENT_POST_HPHL_PA_OFF);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_L_TEST,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_MASK,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_DISABLE);\n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_RX1_RX_PATH_CTL,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_ENABLE);\n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\t      WCD934X_CDC_RX1_RX_PATH_MIX_CTL,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_ENABLE);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tusleep_range(20000, 20100);\n\t\twcd_mbhc_event_notify(wcd->mbhc, WCD_EVENT_POST_HPHL_PA_OFF);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_hphr_pa(struct snd_soc_dapm_widget *w,\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tint event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = snd_soc_component_get_drvdata(comp);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tusleep_range(20000, 20100);\n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_R_TEST,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_MASK,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_RX2_RX_PATH_CTL,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      0);\n\t\t \n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_CNP_WG_CTL,\n\t\t\t\t\t      WCD934X_HPH_GM3_BOOST_EN_MASK,\n\t\t\t\t\t      WCD934X_HPH_GM3_BOOST_ENABLE);\n\t\t \n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t      WCD934X_HPH_NEW_INT_HPH_TIMER1,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_EN_MASK,\n\t\t\t\t      WCD934X_HPH_AUTOCHOP_TIMER_ENABLE);\n\t\t \n\t\tif ((snd_soc_component_read(comp,\n\t\t\t\t      WCD934X_CDC_RX2_RX_PATH_MIX_CTL)) & 0x10)\n\t\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\t      WCD934X_CDC_RX2_RX_PATH_MIX_CTL,\n\t\t\t\t\t      WCD934X_CDC_RX_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      WCD934X_CDC_RX_PGA_MUTE_DISABLE);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\twcd_mbhc_event_notify(wcd->mbhc, WCD_EVENT_PRE_HPHR_PA_OFF);\n\t\tsnd_soc_component_update_bits(comp, WCD934X_HPH_R_TEST,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_MASK,\n\t\t\t\t\t      WCD934X_HPH_OCP_DET_DISABLE);\n\t\tsnd_soc_component_update_bits(comp, WCD934X_CDC_RX2_RX_PATH_CTL,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      WCD934X_RX_PATH_PGA_MUTE_ENABLE);\n\t\tsnd_soc_component_update_bits(comp,\n\t\t\t\t\t      WCD934X_CDC_RX2_RX_PATH_MIX_CTL,\n\t\t\t\t\t      WCD934X_CDC_RX_PGA_MUTE_EN_MASK,\n\t\t\t\t\t      WCD934X_CDC_RX_PGA_MUTE_ENABLE);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tusleep_range(20000, 20100);\n\t\twcd_mbhc_event_notify(wcd->mbhc, WCD_EVENT_POST_HPHR_PA_OFF);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic u32 wcd934x_get_dmic_sample_rate(struct snd_soc_component *comp,\n\t\t\t\t\tunsigned int dmic,\n\t\t\t\t      struct wcd934x_codec *wcd)\n{\n\tu8 tx_stream_fs;\n\tu8 adc_mux_index = 0, adc_mux_sel = 0;\n\tbool dec_found = false;\n\tu16 adc_mux_ctl_reg, tx_fs_reg;\n\tu32 dmic_fs;\n\n\twhile (!dec_found && adc_mux_index < WCD934X_MAX_VALID_ADC_MUX) {\n\t\tif (adc_mux_index < 4) {\n\t\t\tadc_mux_ctl_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG0 +\n\t\t\t\t\t\t(adc_mux_index * 2);\n\t\t} else if (adc_mux_index < WCD934X_INVALID_ADC_MUX) {\n\t\t\tadc_mux_ctl_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t\t\tadc_mux_index - 4;\n\t\t} else if (adc_mux_index == WCD934X_INVALID_ADC_MUX) {\n\t\t\t++adc_mux_index;\n\t\t\tcontinue;\n\t\t}\n\t\tadc_mux_sel = ((snd_soc_component_read(comp, adc_mux_ctl_reg)\n\t\t\t       & 0xF8) >> 3) - 1;\n\n\t\tif (adc_mux_sel == dmic) {\n\t\t\tdec_found = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t++adc_mux_index;\n\t}\n\n\tif (dec_found && adc_mux_index <= 8) {\n\t\ttx_fs_reg = WCD934X_CDC_TX0_TX_PATH_CTL + (16 * adc_mux_index);\n\t\ttx_stream_fs = snd_soc_component_read(comp, tx_fs_reg) & 0x0F;\n\t\tif (tx_stream_fs <= 4)\n\t\t\tdmic_fs = min(wcd->dmic_sample_rate, WCD9XXX_DMIC_SAMPLE_RATE_2P4MHZ);\n\t\telse\n\t\t\tdmic_fs = WCD9XXX_DMIC_SAMPLE_RATE_4P8MHZ;\n\t} else {\n\t\tdmic_fs = wcd->dmic_sample_rate;\n\t}\n\n\treturn dmic_fs;\n}\n\nstatic u8 wcd934x_get_dmic_clk_val(struct snd_soc_component *comp,\n\t\t\t\t   u32 mclk_rate, u32 dmic_clk_rate)\n{\n\tu32 div_factor;\n\tu8 dmic_ctl_val;\n\n\t \n\tif (mclk_rate == WCD934X_MCLK_CLK_9P6MHZ)\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_2;\n\telse\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_3;\n\n\tif (dmic_clk_rate == 0) {\n\t\tdev_err(comp->dev,\n\t\t\t\"%s: dmic_sample_rate cannot be 0\\n\",\n\t\t\t__func__);\n\t\tgoto done;\n\t}\n\n\tdiv_factor = mclk_rate / dmic_clk_rate;\n\tswitch (div_factor) {\n\tcase 2:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_2;\n\t\tbreak;\n\tcase 3:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_3;\n\t\tbreak;\n\tcase 4:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_4;\n\t\tbreak;\n\tcase 6:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_6;\n\t\tbreak;\n\tcase 8:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_8;\n\t\tbreak;\n\tcase 16:\n\t\tdmic_ctl_val = WCD934X_DMIC_CLK_DIV_16;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(comp->dev,\n\t\t\t\"%s: Invalid div_factor %u, clk_rate(%u), dmic_rate(%u)\\n\",\n\t\t\t__func__, div_factor, mclk_rate, dmic_clk_rate);\n\t\tbreak;\n\t}\n\ndone:\n\treturn dmic_ctl_val;\n}\n\nstatic int wcd934x_codec_enable_dmic(struct snd_soc_dapm_widget *w,\n\t\t\t\t     struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tu8  dmic_clk_en = 0x01;\n\tu16 dmic_clk_reg;\n\ts32 *dmic_clk_cnt;\n\tu8 dmic_rate_val, dmic_rate_shift = 1;\n\tunsigned int dmic;\n\tu32 dmic_sample_rate;\n\tint ret;\n\tchar *wname;\n\n\twname = strpbrk(w->name, \"012345\");\n\tif (!wname) {\n\t\tdev_err(comp->dev, \"%s: widget not found\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\n\tret = kstrtouint(wname, 10, &dmic);\n\tif (ret < 0) {\n\t\tdev_err(comp->dev, \"%s: Invalid DMIC line on the codec\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (dmic) {\n\tcase 0:\n\tcase 1:\n\t\tdmic_clk_cnt = &wcd->dmic_0_1_clk_cnt;\n\t\tdmic_clk_reg = WCD934X_CPE_SS_DMIC0_CTL;\n\t\tbreak;\n\tcase 2:\n\tcase 3:\n\t\tdmic_clk_cnt = &wcd->dmic_2_3_clk_cnt;\n\t\tdmic_clk_reg = WCD934X_CPE_SS_DMIC1_CTL;\n\t\tbreak;\n\tcase 4:\n\tcase 5:\n\t\tdmic_clk_cnt = &wcd->dmic_4_5_clk_cnt;\n\t\tdmic_clk_reg = WCD934X_CPE_SS_DMIC2_CTL;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(comp->dev, \"%s: Invalid DMIC Selection\\n\",\n\t\t\t__func__);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tdmic_sample_rate = wcd934x_get_dmic_sample_rate(comp, dmic,\n\t\t\t\t\t\t\t\twcd);\n\t\tdmic_rate_val = wcd934x_get_dmic_clk_val(comp, wcd->rate,\n\t\t\t\t\t\t\t dmic_sample_rate);\n\t\t(*dmic_clk_cnt)++;\n\t\tif (*dmic_clk_cnt == 1) {\n\t\t\tdmic_rate_val = dmic_rate_val << dmic_rate_shift;\n\t\t\tsnd_soc_component_update_bits(comp, dmic_clk_reg,\n\t\t\t\t\t\t      WCD934X_DMIC_RATE_MASK,\n\t\t\t\t\t\t      dmic_rate_val);\n\t\t\tsnd_soc_component_update_bits(comp, dmic_clk_reg,\n\t\t\t\t\t\t      dmic_clk_en, dmic_clk_en);\n\t\t}\n\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t(*dmic_clk_cnt)--;\n\t\tif (*dmic_clk_cnt == 0)\n\t\t\tsnd_soc_component_update_bits(comp, dmic_clk_reg,\n\t\t\t\t\t\t      dmic_clk_en, 0);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_find_amic_input(struct snd_soc_component *comp,\n\t\t\t\t\t int adc_mux_n)\n{\n\tu16 mask, shift, adc_mux_in_reg;\n\tu16 amic_mux_sel_reg;\n\tbool is_amic;\n\n\tif (adc_mux_n < 0 || adc_mux_n > WCD934X_MAX_VALID_ADC_MUX ||\n\t    adc_mux_n == WCD934X_INVALID_ADC_MUX)\n\t\treturn 0;\n\n\tif (adc_mux_n < 3) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1 +\n\t\t\t\t adc_mux_n;\n\t\tmask = 0x03;\n\t\tshift = 0;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG0 +\n\t\t\t\t   2 * adc_mux_n;\n\t} else if (adc_mux_n < 4) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1;\n\t\tmask = 0x03;\n\t\tshift = 0;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG0 +\n\t\t\t\t   2 * adc_mux_n;\n\t} else if (adc_mux_n < 7) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1 +\n\t\t\t\t (adc_mux_n - 4);\n\t\tmask = 0x0C;\n\t\tshift = 2;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t   adc_mux_n - 4;\n\t} else if (adc_mux_n < 8) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1;\n\t\tmask = 0x0C;\n\t\tshift = 2;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t   adc_mux_n - 4;\n\t} else if (adc_mux_n < 12) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1 +\n\t\t\t\t ((adc_mux_n == 8) ? (adc_mux_n - 8) :\n\t\t\t\t  (adc_mux_n - 9));\n\t\tmask = 0x30;\n\t\tshift = 4;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t   adc_mux_n - 4;\n\t} else if (adc_mux_n < 13) {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX3_CFG1;\n\t\tmask = 0x30;\n\t\tshift = 4;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t   adc_mux_n - 4;\n\t} else {\n\t\tadc_mux_in_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX0_CFG1;\n\t\tmask = 0xC0;\n\t\tshift = 6;\n\t\tamic_mux_sel_reg = WCD934X_CDC_TX_INP_MUX_ADC_MUX4_CFG0 +\n\t\t\t\t   adc_mux_n - 4;\n\t}\n\n\tis_amic = (((snd_soc_component_read(comp, adc_mux_in_reg)\n\t\t     & mask) >> shift) == 1);\n\tif (!is_amic)\n\t\treturn 0;\n\n\treturn snd_soc_component_read(comp, amic_mux_sel_reg) & 0x07;\n}\n\nstatic u16 wcd934x_codec_get_amic_pwlvl_reg(struct snd_soc_component *comp,\n\t\t\t\t\t    int amic)\n{\n\tu16 pwr_level_reg = 0;\n\n\tswitch (amic) {\n\tcase 1:\n\tcase 2:\n\t\tpwr_level_reg = WCD934X_ANA_AMIC1;\n\t\tbreak;\n\n\tcase 3:\n\tcase 4:\n\t\tpwr_level_reg = WCD934X_ANA_AMIC3;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn pwr_level_reg;\n}\n\nstatic int wcd934x_codec_enable_dec(struct snd_soc_dapm_widget *w,\n\t\t\t\t    struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\tunsigned int decimator;\n\tchar *dec_adc_mux_name = NULL;\n\tchar *widget_name = NULL;\n\tchar *wname;\n\tint ret = 0, amic_n;\n\tu16 tx_vol_ctl_reg, pwr_level_reg = 0, dec_cfg_reg, hpf_gate_reg;\n\tu16 tx_gain_ctl_reg;\n\tchar *dec;\n\tu8 hpf_coff_freq;\n\n\twidget_name = kstrndup(w->name, 15, GFP_KERNEL);\n\tif (!widget_name)\n\t\treturn -ENOMEM;\n\n\twname = widget_name;\n\tdec_adc_mux_name = strsep(&widget_name, \" \");\n\tif (!dec_adc_mux_name) {\n\t\tdev_err(comp->dev, \"%s: Invalid decimator = %s\\n\",\n\t\t\t__func__, w->name);\n\t\tret =  -EINVAL;\n\t\tgoto out;\n\t}\n\tdec_adc_mux_name = widget_name;\n\n\tdec = strpbrk(dec_adc_mux_name, \"012345678\");\n\tif (!dec) {\n\t\tdev_err(comp->dev, \"%s: decimator index not found\\n\",\n\t\t\t__func__);\n\t\tret =  -EINVAL;\n\t\tgoto out;\n\t}\n\n\tret = kstrtouint(dec, 10, &decimator);\n\tif (ret < 0) {\n\t\tdev_err(comp->dev, \"%s: Invalid decimator = %s\\n\",\n\t\t\t__func__, wname);\n\t\tret =  -EINVAL;\n\t\tgoto out;\n\t}\n\n\ttx_vol_ctl_reg = WCD934X_CDC_TX0_TX_PATH_CTL + 16 * decimator;\n\thpf_gate_reg = WCD934X_CDC_TX0_TX_PATH_SEC2 + 16 * decimator;\n\tdec_cfg_reg = WCD934X_CDC_TX0_TX_PATH_CFG0 + 16 * decimator;\n\ttx_gain_ctl_reg = WCD934X_CDC_TX0_TX_VOL_CTL + 16 * decimator;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tamic_n = wcd934x_codec_find_amic_input(comp, decimator);\n\t\tif (amic_n)\n\t\t\tpwr_level_reg = wcd934x_codec_get_amic_pwlvl_reg(comp,\n\t\t\t\t\t\t\t\t amic_n);\n\n\t\tif (!pwr_level_reg)\n\t\t\tbreak;\n\n\t\tswitch ((snd_soc_component_read(comp, pwr_level_reg) &\n\t\t\t\t      WCD934X_AMIC_PWR_LVL_MASK) >>\n\t\t\t\t      WCD934X_AMIC_PWR_LVL_SHIFT) {\n\t\tcase WCD934X_AMIC_PWR_LEVEL_LP:\n\t\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_MASK,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_LP);\n\t\t\tbreak;\n\t\tcase WCD934X_AMIC_PWR_LEVEL_HP:\n\t\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_MASK,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_HP);\n\t\t\tbreak;\n\t\tcase WCD934X_AMIC_PWR_LEVEL_DEFAULT:\n\t\tcase WCD934X_AMIC_PWR_LEVEL_HYBRID:\n\t\tdefault:\n\t\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_MASK,\n\t\t\t\t\tWCD934X_DEC_PWR_LVL_DF);\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\thpf_coff_freq = (snd_soc_component_read(comp, dec_cfg_reg) &\n\t\t\t\t TX_HPF_CUT_OFF_FREQ_MASK) >> 5;\n\t\tif (hpf_coff_freq != CF_MIN_3DB_150HZ) {\n\t\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\t\t      TX_HPF_CUT_OFF_FREQ_MASK,\n\t\t\t\t\t\t      CF_MIN_3DB_150HZ << 5);\n\t\t\tsnd_soc_component_update_bits(comp, hpf_gate_reg,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ_MASK,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ);\n\t\t\t \n\t\t\tusleep_range(1000, 1010);\n\t\t\tsnd_soc_component_update_bits(comp, hpf_gate_reg,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ_MASK,\n\t\t\t\t      0);\n\t\t}\n\t\t \n\t\tsnd_soc_component_write(comp, tx_gain_ctl_reg,\n\t\t\t\t\tsnd_soc_component_read(comp,\n\t\t\t\t\t\t\t tx_gain_ctl_reg));\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\thpf_coff_freq = (snd_soc_component_read(comp, dec_cfg_reg) &\n\t\t\t\t TX_HPF_CUT_OFF_FREQ_MASK) >> 5;\n\n\t\tif (hpf_coff_freq != CF_MIN_3DB_150HZ) {\n\t\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\t\t      TX_HPF_CUT_OFF_FREQ_MASK,\n\t\t\t\t\t\t      hpf_coff_freq << 5);\n\t\t\tsnd_soc_component_update_bits(comp, hpf_gate_reg,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ_MASK,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ);\n\t\t\t\t \n\t\t\tusleep_range(1000, 1010);\n\t\t\tsnd_soc_component_update_bits(comp, hpf_gate_reg,\n\t\t\t\t      WCD934X_HPH_CUTOFF_FREQ_CHANGE_REQ_MASK,\n\t\t\t\t      0);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tsnd_soc_component_update_bits(comp, tx_vol_ctl_reg,\n\t\t\t\t\t      0x10, 0x00);\n\t\tsnd_soc_component_update_bits(comp, dec_cfg_reg,\n\t\t\t\t\t      WCD934X_DEC_PWR_LVL_MASK,\n\t\t\t\t\t      WCD934X_DEC_PWR_LVL_DF);\n\t\tbreak;\n\t}\nout:\n\tkfree(wname);\n\treturn ret;\n}\n\nstatic void wcd934x_codec_set_tx_hold(struct snd_soc_component *comp,\n\t\t\t\t      u16 amic_reg, bool set)\n{\n\tu8 mask = 0x20;\n\tu8 val;\n\n\tif (amic_reg == WCD934X_ANA_AMIC1 ||\n\t    amic_reg == WCD934X_ANA_AMIC3)\n\t\tmask = 0x40;\n\n\tval = set ? mask : 0x00;\n\n\tswitch (amic_reg) {\n\tcase WCD934X_ANA_AMIC1:\n\tcase WCD934X_ANA_AMIC2:\n\t\tsnd_soc_component_update_bits(comp, WCD934X_ANA_AMIC2,\n\t\t\t\t\t      mask, val);\n\t\tbreak;\n\tcase WCD934X_ANA_AMIC3:\n\tcase WCD934X_ANA_AMIC4:\n\t\tsnd_soc_component_update_bits(comp, WCD934X_ANA_AMIC4,\n\t\t\t\t\t      mask, val);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n}\n\nstatic int wcd934x_codec_enable_adc(struct snd_soc_dapm_widget *w,\n\t\t\t\t    struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *comp = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\twcd934x_codec_set_tx_hold(comp, w->reg, true);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_enable_micbias(struct snd_soc_dapm_widget *w,\n\t\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\t\tint event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tint micb_num = w->shift;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\twcd934x_micbias_control(component, micb_num, MICB_ENABLE, true);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tusleep_range(1000, 1100);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\twcd934x_micbias_control(component, micb_num, MICB_DISABLE, true);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget wcd934x_dapm_widgets[] = {\n\t \n\tSND_SOC_DAPM_OUTPUT(\"EAR\"),\n\tSND_SOC_DAPM_OUTPUT(\"HPHL\"),\n\tSND_SOC_DAPM_OUTPUT(\"HPHR\"),\n\tSND_SOC_DAPM_OUTPUT(\"LINEOUT1\"),\n\tSND_SOC_DAPM_OUTPUT(\"LINEOUT2\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPK1 OUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPK2 OUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"ANC EAR\"),\n\tSND_SOC_DAPM_OUTPUT(\"ANC HPHL\"),\n\tSND_SOC_DAPM_OUTPUT(\"ANC HPHR\"),\n\tSND_SOC_DAPM_OUTPUT(\"WDMA3_OUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"MAD_CPE_OUT1\"),\n\tSND_SOC_DAPM_OUTPUT(\"MAD_CPE_OUT2\"),\n\tSND_SOC_DAPM_AIF_IN_E(\"AIF1 PB\", \"AIF1 Playback\", 0, SND_SOC_NOPM,\n\t\t\t      AIF1_PB, 0, wcd934x_codec_enable_slim,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_AIF_IN_E(\"AIF2 PB\", \"AIF2 Playback\", 0, SND_SOC_NOPM,\n\t\t\t      AIF2_PB, 0, wcd934x_codec_enable_slim,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_AIF_IN_E(\"AIF3 PB\", \"AIF3 Playback\", 0, SND_SOC_NOPM,\n\t\t\t      AIF3_PB, 0, wcd934x_codec_enable_slim,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_AIF_IN_E(\"AIF4 PB\", \"AIF4 Playback\", 0, SND_SOC_NOPM,\n\t\t\t      AIF4_PB, 0, wcd934x_codec_enable_slim,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"SLIM RX0 MUX\", SND_SOC_NOPM, WCD934X_RX0, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX0]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX1 MUX\", SND_SOC_NOPM, WCD934X_RX1, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX1]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX2 MUX\", SND_SOC_NOPM, WCD934X_RX2, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX2]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX3 MUX\", SND_SOC_NOPM, WCD934X_RX3, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX3]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX4 MUX\", SND_SOC_NOPM, WCD934X_RX4, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX4]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX5 MUX\", SND_SOC_NOPM, WCD934X_RX5, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX5]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX6 MUX\", SND_SOC_NOPM, WCD934X_RX6, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX6]),\n\tSND_SOC_DAPM_MUX(\"SLIM RX7 MUX\", SND_SOC_NOPM, WCD934X_RX7, 0,\n\t\t\t &slim_rx_mux[WCD934X_RX7]),\n\n\tSND_SOC_DAPM_MIXER(\"SLIM RX0\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX4\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX5\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX6\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM RX7\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MUX_E(\"RX INT0_2 MUX\", SND_SOC_NOPM, INTERP_EAR, 0,\n\t\t\t   &rx_int0_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT1_2 MUX\", SND_SOC_NOPM, INTERP_HPHL, 0,\n\t\t\t   &rx_int1_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT2_2 MUX\", SND_SOC_NOPM, INTERP_HPHR, 0,\n\t\t\t   &rx_int2_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT3_2 MUX\", SND_SOC_NOPM, INTERP_LO1, 0,\n\t\t\t   &rx_int3_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT4_2 MUX\", SND_SOC_NOPM, INTERP_LO2, 0,\n\t\t\t   &rx_int4_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT7_2 MUX\", SND_SOC_NOPM, INTERP_SPKR1, 0,\n\t\t\t   &rx_int7_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT8_2 MUX\", SND_SOC_NOPM, INTERP_SPKR2, 0,\n\t\t\t   &rx_int8_2_mux, wcd934x_codec_enable_mix_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"RX INT0_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int0_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT0_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int0_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT0_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int0_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT1_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int1_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT1_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int1_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT1_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int1_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT2_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int2_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT2_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int2_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT2_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int2_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT3_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int3_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT3_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int3_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT3_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int3_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT4_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int4_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT4_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int4_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT4_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int4_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT7_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int7_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT7_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int7_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT7_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int7_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT8_1 MIX1 INP0\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int8_1_mix_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT8_1 MIX1 INP1\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int8_1_mix_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT8_1 MIX1 INP2\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rx_int8_1_mix_inp2_mux),\n\tSND_SOC_DAPM_MIXER(\"RX INT0_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT0 SEC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT1_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT1 SEC MIX\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rx_int1_asrc_switch,\n\t\t\t   ARRAY_SIZE(rx_int1_asrc_switch)),\n\tSND_SOC_DAPM_MIXER(\"RX INT2_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT2 SEC MIX\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rx_int2_asrc_switch,\n\t\t\t   ARRAY_SIZE(rx_int2_asrc_switch)),\n\tSND_SOC_DAPM_MIXER(\"RX INT3_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT3 SEC MIX\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rx_int3_asrc_switch,\n\t\t\t   ARRAY_SIZE(rx_int3_asrc_switch)),\n\tSND_SOC_DAPM_MIXER(\"RX INT4_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT4 SEC MIX\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rx_int4_asrc_switch,\n\t\t\t   ARRAY_SIZE(rx_int4_asrc_switch)),\n\tSND_SOC_DAPM_MIXER(\"RX INT7_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT7 SEC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT8_1 MIX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT8 SEC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT0 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT1 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT1 MIX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT2 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT2 MIX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT3 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT3 MIX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT4 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"RX INT4 MIX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MIXER(\"RX INT7 MIX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"RX INT7 CHAIN\", SND_SOC_NOPM, 0, 0,\n\t\t\t     NULL, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"RX INT8 CHAIN\", SND_SOC_NOPM, 0, 0,\n\t\t\t     NULL, 0, NULL, 0),\n\tSND_SOC_DAPM_MUX_E(\"RX INT0 MIX2 INP\", WCD934X_CDC_RX0_RX_PATH_CFG0, 4,\n\t\t\t   0,  &rx_int0_mix2_inp_mux, NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT1 MIX2 INP\", WCD934X_CDC_RX1_RX_PATH_CFG0, 4,\n\t\t\t   0, &rx_int1_mix2_inp_mux,  NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT2 MIX2 INP\", WCD934X_CDC_RX2_RX_PATH_CFG0, 4,\n\t\t\t   0, &rx_int2_mix2_inp_mux, NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT3 MIX2 INP\", WCD934X_CDC_RX3_RX_PATH_CFG0, 4,\n\t\t\t   0, &rx_int3_mix2_inp_mux, NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT4 MIX2 INP\", WCD934X_CDC_RX4_RX_PATH_CFG0, 4,\n\t\t\t   0, &rx_int4_mix2_inp_mux, NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT7 MIX2 INP\", WCD934X_CDC_RX7_RX_PATH_CFG0, 4,\n\t\t\t   0, &rx_int7_mix2_inp_mux, NULL,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"IIR0 INP0 MUX\", SND_SOC_NOPM, 0, 0, &iir0_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"IIR0 INP1 MUX\", SND_SOC_NOPM, 0, 0, &iir0_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"IIR0 INP2 MUX\", SND_SOC_NOPM, 0, 0, &iir0_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"IIR0 INP3 MUX\", SND_SOC_NOPM, 0, 0, &iir0_inp3_mux),\n\tSND_SOC_DAPM_MUX(\"IIR1 INP0 MUX\", SND_SOC_NOPM, 0, 0, &iir1_inp0_mux),\n\tSND_SOC_DAPM_MUX(\"IIR1 INP1 MUX\", SND_SOC_NOPM, 0, 0, &iir1_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"IIR1 INP2 MUX\", SND_SOC_NOPM, 0, 0, &iir1_inp2_mux),\n\tSND_SOC_DAPM_MUX(\"IIR1 INP3 MUX\", SND_SOC_NOPM, 0, 0, &iir1_inp3_mux),\n\n\tSND_SOC_DAPM_PGA_E(\"IIR0\", WCD934X_CDC_SIDETONE_IIR0_IIR_GAIN_B1_CTL,\n\t\t\t   0, 0, NULL, 0, wcd934x_codec_set_iir_gain,\n\t\t\t   SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_PGA_E(\"IIR1\", WCD934X_CDC_SIDETONE_IIR1_IIR_GAIN_B1_CTL,\n\t\t\t   1, 0, NULL, 0, wcd934x_codec_set_iir_gain,\n\t\t\t   SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_MIXER(\"SRC0\", WCD934X_CDC_SIDETONE_SRC0_ST_SRC_PATH_CTL,\n\t\t\t   4, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SRC1\", WCD934X_CDC_SIDETONE_SRC1_ST_SRC_PATH_CTL,\n\t\t\t   4, 0, NULL, 0),\n\tSND_SOC_DAPM_MUX(\"RX INT0 DEM MUX\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int0_dem_inp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT1 DEM MUX\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int1_dem_inp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT2 DEM MUX\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int2_dem_inp_mux),\n\n\tSND_SOC_DAPM_MUX_E(\"RX INT0_1 INTERP\", SND_SOC_NOPM, INTERP_EAR, 0,\n\t\t\t   &rx_int0_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT1_1 INTERP\", SND_SOC_NOPM, INTERP_HPHL, 0,\n\t\t\t   &rx_int1_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT2_1 INTERP\", SND_SOC_NOPM, INTERP_HPHR, 0,\n\t\t\t   &rx_int2_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT3_1 INTERP\", SND_SOC_NOPM, INTERP_LO1, 0,\n\t\t\t   &rx_int3_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT4_1 INTERP\", SND_SOC_NOPM, INTERP_LO2, 0,\n\t\t\t   &rx_int4_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT7_1 INTERP\", SND_SOC_NOPM, INTERP_SPKR1, 0,\n\t\t\t   &rx_int7_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"RX INT8_1 INTERP\", SND_SOC_NOPM, INTERP_SPKR2, 0,\n\t\t\t   &rx_int8_1_interp_mux,\n\t\t\t   wcd934x_codec_enable_main_path,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"RX INT0_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int0_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT1_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int1_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT2_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int2_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT3_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int3_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT4_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int4_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT7_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int7_2_interp_mux),\n\tSND_SOC_DAPM_MUX(\"RX INT8_2 INTERP\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rx_int8_2_interp_mux),\n\tSND_SOC_DAPM_DAC_E(\"RX INT0 DAC\", NULL, SND_SOC_NOPM,\n\t\t\t   0, 0, wcd934x_codec_ear_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_DAC_E(\"RX INT1 DAC\", NULL, WCD934X_ANA_HPH,\n\t\t\t   5, 0, wcd934x_codec_hphl_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_DAC_E(\"RX INT2 DAC\", NULL, WCD934X_ANA_HPH,\n\t\t\t   4, 0, wcd934x_codec_hphr_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_DAC_E(\"RX INT3 DAC\", NULL, SND_SOC_NOPM,\n\t\t\t   0, 0, wcd934x_codec_lineout_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_DAC_E(\"RX INT4 DAC\", NULL, SND_SOC_NOPM,\n\t\t\t   0, 0, wcd934x_codec_lineout_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_PGA_E(\"EAR PA\", WCD934X_ANA_EAR, 7, 0, NULL, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA_E(\"HPHL PA\", WCD934X_ANA_HPH, 7, 0, NULL, 0,\n\t\t\t   wcd934x_codec_enable_hphl_pa,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_PGA_E(\"HPHR PA\", WCD934X_ANA_HPH, 6, 0, NULL, 0,\n\t\t\t   wcd934x_codec_enable_hphr_pa,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_PGA_E(\"LINEOUT1 PA\", WCD934X_ANA_LO_1_2, 7, 0, NULL, 0,\n\t\t\t   NULL, 0),\n\tSND_SOC_DAPM_PGA_E(\"LINEOUT2 PA\", WCD934X_ANA_LO_1_2, 6, 0, NULL, 0,\n\t\t\t   NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"RX_BIAS\", WCD934X_ANA_RX_SUPPLIES, 0, 0, NULL,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"SBOOST0\", WCD934X_CDC_RX7_RX_PATH_CFG1,\n\t\t\t 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"SBOOST0_CLK\", WCD934X_CDC_BOOST0_BOOST_PATH_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"SBOOST1\", WCD934X_CDC_RX8_RX_PATH_CFG1,\n\t\t\t 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"SBOOST1_CLK\", WCD934X_CDC_BOOST1_BOOST_PATH_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"INT0_CLK\", SND_SOC_NOPM, INTERP_EAR, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT1_CLK\", SND_SOC_NOPM, INTERP_HPHL, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT2_CLK\", SND_SOC_NOPM, INTERP_HPHR, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT3_CLK\", SND_SOC_NOPM, INTERP_LO1, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT4_CLK\", SND_SOC_NOPM, INTERP_LO2, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT7_CLK\", SND_SOC_NOPM, INTERP_SPKR1, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"INT8_CLK\", SND_SOC_NOPM, INTERP_SPKR2, 0,\n\t\t\t    wcd934x_codec_enable_interp_clk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM0_CLK\", WCD934X_CDC_RX0_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM1_CLK\", WCD934X_CDC_RX1_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM2_CLK\", WCD934X_CDC_RX2_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM3_CLK\", WCD934X_CDC_RX3_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM4_CLK\", WCD934X_CDC_RX4_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM7_CLK\", WCD934X_CDC_RX7_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DSMDEM8_CLK\", WCD934X_CDC_RX8_RX_PATH_DSMDEM_CTL,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"MCLK\", SND_SOC_NOPM, 0, 0,\n\t\t\t    wcd934x_codec_enable_mclk,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_INPUT(\"AMIC1\"),\n\tSND_SOC_DAPM_INPUT(\"AMIC2\"),\n\tSND_SOC_DAPM_INPUT(\"AMIC3\"),\n\tSND_SOC_DAPM_INPUT(\"AMIC4\"),\n\tSND_SOC_DAPM_INPUT(\"AMIC5\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC0 Pin\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC1 Pin\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC2 Pin\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC3 Pin\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC4 Pin\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC5 Pin\"),\n\n\tSND_SOC_DAPM_AIF_OUT_E(\"AIF1 CAP\", \"AIF1 Capture\", 0, SND_SOC_NOPM,\n\t\t\t       AIF1_CAP, 0, wcd934x_codec_enable_slim,\n\t\t\t       SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_AIF_OUT_E(\"AIF2 CAP\", \"AIF2 Capture\", 0, SND_SOC_NOPM,\n\t\t\t       AIF2_CAP, 0, wcd934x_codec_enable_slim,\n\t\t\t       SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_AIF_OUT_E(\"AIF3 CAP\", \"AIF3 Capture\", 0, SND_SOC_NOPM,\n\t\t\t       AIF3_CAP, 0, wcd934x_codec_enable_slim,\n\t\t\t       SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MIXER(\"SLIM TX0\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX4\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX5\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX6\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX7\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX8\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX9\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX10\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX11\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"SLIM TX13\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_ADC_E(\"DMIC0\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"DMIC1\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"DMIC2\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"DMIC3\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"DMIC4\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"DMIC5\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   wcd934x_codec_enable_dmic,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX0\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux0),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX1\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux1),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX2\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux2),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX3\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux3),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX4\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux4),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX5\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux5),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX6\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux6),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX7\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux7),\n\tSND_SOC_DAPM_MUX(\"DMIC MUX8\", SND_SOC_NOPM, 0, 0, &tx_dmic_mux8),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX0\", SND_SOC_NOPM, 0, 0, &tx_amic_mux0),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX1\", SND_SOC_NOPM, 0, 0, &tx_amic_mux1),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX2\", SND_SOC_NOPM, 0, 0, &tx_amic_mux2),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX3\", SND_SOC_NOPM, 0, 0, &tx_amic_mux3),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX4\", SND_SOC_NOPM, 0, 0, &tx_amic_mux4),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX5\", SND_SOC_NOPM, 0, 0, &tx_amic_mux5),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX6\", SND_SOC_NOPM, 0, 0, &tx_amic_mux6),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX7\", SND_SOC_NOPM, 0, 0, &tx_amic_mux7),\n\tSND_SOC_DAPM_MUX(\"AMIC MUX8\", SND_SOC_NOPM, 0, 0, &tx_amic_mux8),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX0\", WCD934X_CDC_TX0_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux0_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX1\", WCD934X_CDC_TX1_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux1_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX2\", WCD934X_CDC_TX2_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux2_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX3\", WCD934X_CDC_TX3_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux3_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX4\", WCD934X_CDC_TX4_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux4_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX5\", WCD934X_CDC_TX5_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux5_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX6\", WCD934X_CDC_TX6_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux6_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX7\", WCD934X_CDC_TX7_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux7_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_MUX_E(\"ADC MUX8\", WCD934X_CDC_TX8_TX_PATH_CTL, 5, 0,\n\t\t\t   &tx_adc_mux8_mux, wcd934x_codec_enable_dec,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_ADC_E(\"ADC1\", NULL, WCD934X_ANA_AMIC1, 7, 0,\n\t\t\t   wcd934x_codec_enable_adc, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_ADC_E(\"ADC2\", NULL, WCD934X_ANA_AMIC2, 7, 0,\n\t\t\t   wcd934x_codec_enable_adc, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_ADC_E(\"ADC3\", NULL, WCD934X_ANA_AMIC3, 7, 0,\n\t\t\t   wcd934x_codec_enable_adc, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_ADC_E(\"ADC4\", NULL, WCD934X_ANA_AMIC4, 7, 0,\n\t\t\t   wcd934x_codec_enable_adc, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_SUPPLY(\"MIC BIAS1\", SND_SOC_NOPM, MIC_BIAS_1, 0,\n\t\t\t    wcd934x_codec_enable_micbias, SND_SOC_DAPM_PRE_PMU |\n\t\t\t    SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"MIC BIAS2\", SND_SOC_NOPM, MIC_BIAS_2, 0,\n\t\t\t    wcd934x_codec_enable_micbias, SND_SOC_DAPM_PRE_PMU |\n\t\t\t    SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"MIC BIAS3\", SND_SOC_NOPM, MIC_BIAS_3, 0,\n\t\t\t    wcd934x_codec_enable_micbias, SND_SOC_DAPM_PRE_PMU |\n\t\t\t    SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"MIC BIAS4\", SND_SOC_NOPM, MIC_BIAS_4, 0,\n\t\t\t    wcd934x_codec_enable_micbias, SND_SOC_DAPM_PRE_PMU |\n\t\t\t    SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"AMIC4_5 SEL\", SND_SOC_NOPM, 0, 0, &tx_amic4_5),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX0 MUX\", SND_SOC_NOPM, WCD934X_TX0, 0,\n\t\t\t &cdc_if_tx0_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX1 MUX\", SND_SOC_NOPM, WCD934X_TX1, 0,\n\t\t\t &cdc_if_tx1_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX2 MUX\", SND_SOC_NOPM, WCD934X_TX2, 0,\n\t\t\t &cdc_if_tx2_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX3 MUX\", SND_SOC_NOPM, WCD934X_TX3, 0,\n\t\t\t &cdc_if_tx3_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX4 MUX\", SND_SOC_NOPM, WCD934X_TX4, 0,\n\t\t\t &cdc_if_tx4_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX5 MUX\", SND_SOC_NOPM, WCD934X_TX5, 0,\n\t\t\t &cdc_if_tx5_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX6 MUX\", SND_SOC_NOPM, WCD934X_TX6, 0,\n\t\t\t &cdc_if_tx6_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX7 MUX\", SND_SOC_NOPM, WCD934X_TX7, 0,\n\t\t\t &cdc_if_tx7_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX8 MUX\", SND_SOC_NOPM, WCD934X_TX8, 0,\n\t\t\t &cdc_if_tx8_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX9 MUX\", SND_SOC_NOPM, WCD934X_TX9, 0,\n\t\t\t &cdc_if_tx9_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX10 MUX\", SND_SOC_NOPM, WCD934X_TX10, 0,\n\t\t\t &cdc_if_tx10_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX11 MUX\", SND_SOC_NOPM, WCD934X_TX11, 0,\n\t\t\t &cdc_if_tx11_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX11 INP1 MUX\", SND_SOC_NOPM, WCD934X_TX11, 0,\n\t\t\t &cdc_if_tx11_inp1_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX13 MUX\", SND_SOC_NOPM, WCD934X_TX13, 0,\n\t\t\t &cdc_if_tx13_mux),\n\tSND_SOC_DAPM_MUX(\"CDC_IF TX13 INP1 MUX\", SND_SOC_NOPM, WCD934X_TX13, 0,\n\t\t\t &cdc_if_tx13_inp1_mux),\n\tSND_SOC_DAPM_MIXER(\"AIF1_CAP Mixer\", SND_SOC_NOPM, AIF1_CAP, 0,\n\t\t\t   aif1_slim_cap_mixer,\n\t\t\t   ARRAY_SIZE(aif1_slim_cap_mixer)),\n\tSND_SOC_DAPM_MIXER(\"AIF2_CAP Mixer\", SND_SOC_NOPM, AIF2_CAP, 0,\n\t\t\t   aif2_slim_cap_mixer,\n\t\t\t   ARRAY_SIZE(aif2_slim_cap_mixer)),\n\tSND_SOC_DAPM_MIXER(\"AIF3_CAP Mixer\", SND_SOC_NOPM, AIF3_CAP, 0,\n\t\t\t   aif3_slim_cap_mixer,\n\t\t\t   ARRAY_SIZE(aif3_slim_cap_mixer)),\n};\n\nstatic const struct snd_soc_dapm_route wcd934x_audio_map[] = {\n\t \n\tWCD934X_SLIM_RX_AIF_PATH(0),\n\tWCD934X_SLIM_RX_AIF_PATH(1),\n\tWCD934X_SLIM_RX_AIF_PATH(2),\n\tWCD934X_SLIM_RX_AIF_PATH(3),\n\tWCD934X_SLIM_RX_AIF_PATH(4),\n\tWCD934X_SLIM_RX_AIF_PATH(5),\n\tWCD934X_SLIM_RX_AIF_PATH(6),\n\tWCD934X_SLIM_RX_AIF_PATH(7),\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(0),\n\tWCD934X_INTERPOLATOR_MIX2(0),\n\t{\"RX INT0 DEM MUX\", \"CLSH_DSM_OUT\", \"RX INT0 MIX2\"},\n\t{\"RX INT0 DAC\", NULL, \"RX INT0 DEM MUX\"},\n\t{\"RX INT0 DAC\", NULL, \"RX_BIAS\"},\n\t{\"EAR PA\", NULL, \"RX INT0 DAC\"},\n\t{\"EAR\", NULL, \"EAR PA\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(1),\n\tWCD934X_INTERPOLATOR_MIX2(1),\n\t{\"RX INT1 MIX3\", NULL, \"RX INT1 MIX2\"},\n\t{\"RX INT1 DEM MUX\", \"CLSH_DSM_OUT\", \"RX INT1 MIX3\"},\n\t{\"RX INT1 DAC\", NULL, \"RX INT1 DEM MUX\"},\n\t{\"RX INT1 DAC\", NULL, \"RX_BIAS\"},\n\t{\"HPHL PA\", NULL, \"RX INT1 DAC\"},\n\t{\"HPHL\", NULL, \"HPHL PA\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(2),\n\tWCD934X_INTERPOLATOR_MIX2(2),\n\t{\"RX INT2 MIX3\", NULL, \"RX INT2 MIX2\"},\n\t{\"RX INT2 DEM MUX\", \"CLSH_DSM_OUT\", \"RX INT2 MIX3\"},\n\t{\"RX INT2 DAC\", NULL, \"RX INT2 DEM MUX\"},\n\t{\"RX INT2 DAC\", NULL, \"RX_BIAS\"},\n\t{\"HPHR PA\", NULL, \"RX INT2 DAC\"},\n\t{\"HPHR\", NULL, \"HPHR PA\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(3),\n\tWCD934X_INTERPOLATOR_MIX2(3),\n\t{\"RX INT3 MIX3\", NULL, \"RX INT3 MIX2\"},\n\t{\"RX INT3 DAC\", NULL, \"RX INT3 MIX3\"},\n\t{\"RX INT3 DAC\", NULL, \"RX_BIAS\"},\n\t{\"LINEOUT1 PA\", NULL, \"RX INT3 DAC\"},\n\t{\"LINEOUT1\", NULL, \"LINEOUT1 PA\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(4),\n\tWCD934X_INTERPOLATOR_MIX2(4),\n\t{\"RX INT4 MIX3\", NULL, \"RX INT4 MIX2\"},\n\t{\"RX INT4 DAC\", NULL, \"RX INT4 MIX3\"},\n\t{\"RX INT4 DAC\", NULL, \"RX_BIAS\"},\n\t{\"LINEOUT2 PA\", NULL, \"RX INT4 DAC\"},\n\t{\"LINEOUT2\", NULL, \"LINEOUT2 PA\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(7),\n\tWCD934X_INTERPOLATOR_MIX2(7),\n\t{\"RX INT7 CHAIN\", NULL, \"RX INT7 MIX2\"},\n\t{\"RX INT7 CHAIN\", NULL, \"RX_BIAS\"},\n\t{\"RX INT7 CHAIN\", NULL, \"SBOOST0\"},\n\t{\"RX INT7 CHAIN\", NULL, \"SBOOST0_CLK\"},\n\t{\"SPK1 OUT\", NULL, \"RX INT7 CHAIN\"},\n\n\t \n\tWCD934X_INTERPOLATOR_PATH(8),\n\t{\"RX INT8 CHAIN\", NULL, \"RX INT8 SEC MIX\"},\n\t{\"RX INT8 CHAIN\", NULL, \"RX_BIAS\"},\n\t{\"RX INT8 CHAIN\", NULL, \"SBOOST1\"},\n\t{\"RX INT8 CHAIN\", NULL, \"SBOOST1_CLK\"},\n\t{\"SPK2 OUT\", NULL, \"RX INT8 CHAIN\"},\n\n\t \n\t{\"AIF1 CAP\", NULL, \"AIF1_CAP Mixer\"},\n\t{\"AIF2 CAP\", NULL, \"AIF2_CAP Mixer\"},\n\t{\"AIF3 CAP\", NULL, \"AIF3_CAP Mixer\"},\n\n\tWCD934X_SLIM_TX_AIF_PATH(0),\n\tWCD934X_SLIM_TX_AIF_PATH(1),\n\tWCD934X_SLIM_TX_AIF_PATH(2),\n\tWCD934X_SLIM_TX_AIF_PATH(3),\n\tWCD934X_SLIM_TX_AIF_PATH(4),\n\tWCD934X_SLIM_TX_AIF_PATH(5),\n\tWCD934X_SLIM_TX_AIF_PATH(6),\n\tWCD934X_SLIM_TX_AIF_PATH(7),\n\tWCD934X_SLIM_TX_AIF_PATH(8),\n\n\tWCD934X_ADC_MUX(0),\n\tWCD934X_ADC_MUX(1),\n\tWCD934X_ADC_MUX(2),\n\tWCD934X_ADC_MUX(3),\n\tWCD934X_ADC_MUX(4),\n\tWCD934X_ADC_MUX(5),\n\tWCD934X_ADC_MUX(6),\n\tWCD934X_ADC_MUX(7),\n\tWCD934X_ADC_MUX(8),\n\n\t{\"CDC_IF TX0 MUX\", \"DEC0\", \"ADC MUX0\"},\n\t{\"CDC_IF TX1 MUX\", \"DEC1\", \"ADC MUX1\"},\n\t{\"CDC_IF TX2 MUX\", \"DEC2\", \"ADC MUX2\"},\n\t{\"CDC_IF TX3 MUX\", \"DEC3\", \"ADC MUX3\"},\n\t{\"CDC_IF TX4 MUX\", \"DEC4\", \"ADC MUX4\"},\n\t{\"CDC_IF TX5 MUX\", \"DEC5\", \"ADC MUX5\"},\n\t{\"CDC_IF TX6 MUX\", \"DEC6\", \"ADC MUX6\"},\n\t{\"CDC_IF TX7 MUX\", \"DEC7\", \"ADC MUX7\"},\n\t{\"CDC_IF TX8 MUX\", \"DEC8\", \"ADC MUX8\"},\n\n\t{\"AMIC4_5 SEL\", \"AMIC4\", \"AMIC4\"},\n\t{\"AMIC4_5 SEL\", \"AMIC5\", \"AMIC5\"},\n\n\t{ \"DMIC0\", NULL, \"DMIC0 Pin\" },\n\t{ \"DMIC1\", NULL, \"DMIC1 Pin\" },\n\t{ \"DMIC2\", NULL, \"DMIC2 Pin\" },\n\t{ \"DMIC3\", NULL, \"DMIC3 Pin\" },\n\t{ \"DMIC4\", NULL, \"DMIC4 Pin\" },\n\t{ \"DMIC5\", NULL, \"DMIC5 Pin\" },\n\n\t{\"ADC1\", NULL, \"AMIC1\"},\n\t{\"ADC2\", NULL, \"AMIC2\"},\n\t{\"ADC3\", NULL, \"AMIC3\"},\n\t{\"ADC4\", NULL, \"AMIC4_5 SEL\"},\n\n\tWCD934X_IIR_INP_MUX(0),\n\tWCD934X_IIR_INP_MUX(1),\n\n\t{\"SRC0\", NULL, \"IIR0\"},\n\t{\"SRC1\", NULL, \"IIR1\"},\n};\n\nstatic int wcd934x_codec_set_jack(struct snd_soc_component *comp,\n\t\t\t\t  struct snd_soc_jack *jack, void *data)\n{\n\tstruct wcd934x_codec *wcd = dev_get_drvdata(comp->dev);\n\tint ret = 0;\n\n\tif (!wcd->mbhc)\n\t\treturn -ENOTSUPP;\n\n\tif (jack && !wcd->mbhc_started) {\n\t\tret = wcd_mbhc_start(wcd->mbhc, &wcd->mbhc_cfg, jack);\n\t\twcd->mbhc_started = true;\n\t} else if (wcd->mbhc_started) {\n\t\twcd_mbhc_stop(wcd->mbhc);\n\t\twcd->mbhc_started = false;\n\t}\n\n\treturn ret;\n}\n\nstatic const struct snd_soc_component_driver wcd934x_component_drv = {\n\t.probe = wcd934x_comp_probe,\n\t.remove = wcd934x_comp_remove,\n\t.set_sysclk = wcd934x_comp_set_sysclk,\n\t.controls = wcd934x_snd_controls,\n\t.num_controls = ARRAY_SIZE(wcd934x_snd_controls),\n\t.dapm_widgets = wcd934x_dapm_widgets,\n\t.num_dapm_widgets = ARRAY_SIZE(wcd934x_dapm_widgets),\n\t.dapm_routes = wcd934x_audio_map,\n\t.num_dapm_routes = ARRAY_SIZE(wcd934x_audio_map),\n\t.set_jack = wcd934x_codec_set_jack,\n\t.endianness = 1,\n};\n\nstatic int wcd934x_codec_parse_data(struct wcd934x_codec *wcd)\n{\n\tstruct device *dev = &wcd->sdev->dev;\n\tstruct wcd_mbhc_config *cfg = &wcd->mbhc_cfg;\n\tstruct device_node *ifc_dev_np;\n\n\tifc_dev_np = of_parse_phandle(dev->of_node, \"slim-ifc-dev\", 0);\n\tif (!ifc_dev_np) {\n\t\tdev_err(dev, \"No Interface device found\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\twcd->sidev = of_slim_get_device(wcd->sdev->ctrl, ifc_dev_np);\n\tof_node_put(ifc_dev_np);\n\tif (!wcd->sidev) {\n\t\tdev_err(dev, \"Unable to get SLIM Interface device\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tslim_get_logical_addr(wcd->sidev);\n\twcd->if_regmap = regmap_init_slimbus(wcd->sidev,\n\t\t\t\t  &wcd934x_ifc_regmap_config);\n\tif (IS_ERR(wcd->if_regmap))\n\t\treturn dev_err_probe(dev, PTR_ERR(wcd->if_regmap),\n\t\t\t\t     \"Failed to allocate ifc register map\\n\");\n\n\tof_property_read_u32(dev->parent->of_node, \"qcom,dmic-sample-rate\",\n\t\t\t     &wcd->dmic_sample_rate);\n\n\tcfg->mbhc_micbias = MIC_BIAS_2;\n\tcfg->anc_micbias = MIC_BIAS_2;\n\tcfg->v_hs_max = WCD_MBHC_HS_V_MAX;\n\tcfg->num_btn = WCD934X_MBHC_MAX_BUTTONS;\n\tcfg->micb_mv = wcd->micb2_mv;\n\tcfg->linein_th = 5000;\n\tcfg->hs_thr = 1700;\n\tcfg->hph_thr = 50;\n\n\twcd_dt_parse_mbhc_data(dev, cfg);\n\n\n\treturn 0;\n}\n\nstatic int wcd934x_codec_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct wcd934x_ddata *data = dev_get_drvdata(dev->parent);\n\tstruct wcd934x_codec *wcd;\n\tint ret, irq;\n\n\twcd = devm_kzalloc(dev, sizeof(*wcd), GFP_KERNEL);\n\tif (!wcd)\n\t\treturn -ENOMEM;\n\n\twcd->dev = dev;\n\twcd->regmap = data->regmap;\n\twcd->extclk = data->extclk;\n\twcd->sdev = to_slim_device(data->dev);\n\tmutex_init(&wcd->sysclk_mutex);\n\tmutex_init(&wcd->micb_lock);\n\n\tret = wcd934x_codec_parse_data(wcd);\n\tif (ret) {\n\t\tdev_err(wcd->dev, \"Failed to get SLIM IRQ\\n\");\n\t\treturn ret;\n\t}\n\n\t \n\tregmap_update_bits(wcd->regmap, WCD934X_CODEC_RPM_CLK_MCLK_CFG,\n\t\t\t   WCD934X_CODEC_RPM_CLK_MCLK_CFG_MCLK_MASK,\n\t\t\t   WCD934X_CODEC_RPM_CLK_MCLK_CFG_9P6MHZ);\n\tmemcpy(wcd->rx_chs, wcd934x_rx_chs, sizeof(wcd934x_rx_chs));\n\tmemcpy(wcd->tx_chs, wcd934x_tx_chs, sizeof(wcd934x_tx_chs));\n\n\tirq = regmap_irq_get_virq(data->irq_data, WCD934X_IRQ_SLIMBUS);\n\tif (irq < 0)\n\t\treturn dev_err_probe(wcd->dev, irq, \"Failed to get SLIM IRQ\\n\");\n\n\tret = devm_request_threaded_irq(dev, irq, NULL,\n\t\t\t\t\twcd934x_slim_irq_handler,\n\t\t\t\t\tIRQF_TRIGGER_RISING | IRQF_ONESHOT,\n\t\t\t\t\t\"slim\", wcd);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to request slimbus irq\\n\");\n\n\twcd934x_register_mclk_output(wcd);\n\tplatform_set_drvdata(pdev, wcd);\n\n\treturn devm_snd_soc_register_component(dev, &wcd934x_component_drv,\n\t\t\t\t\t       wcd934x_slim_dais,\n\t\t\t\t\t       ARRAY_SIZE(wcd934x_slim_dais));\n}\n\nstatic const struct platform_device_id wcd934x_driver_id[] = {\n\t{\n\t\t.name = \"wcd934x-codec\",\n\t},\n\t{},\n};\nMODULE_DEVICE_TABLE(platform, wcd934x_driver_id);\n\nstatic struct platform_driver wcd934x_codec_driver = {\n\t.probe\t= &wcd934x_codec_probe,\n\t.id_table = wcd934x_driver_id,\n\t.driver = {\n\t\t.name\t= \"wcd934x-codec\",\n\t}\n};\n\nMODULE_ALIAS(\"platform:wcd934x-codec\");\nmodule_platform_driver(wcd934x_codec_driver);\nMODULE_DESCRIPTION(\"WCD934x codec driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}