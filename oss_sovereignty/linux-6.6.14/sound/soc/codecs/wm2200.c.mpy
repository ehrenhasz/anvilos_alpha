{
  "module_name": "wm2200.c",
  "hash_id": "8e42396097edf976a957bd92793d0b8c7cb922699c9adc9302af4e738f9cd1a6",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/wm2200.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/firmware.h>\n#include <linux/gcd.h>\n#include <linux/gpio.h>\n#include <linux/i2c.h>\n#include <linux/pm_runtime.h>\n#include <linux/regulator/consumer.h>\n#include <linux/regulator/fixed.h>\n#include <linux/slab.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/jack.h>\n#include <sound/initval.h>\n#include <sound/tlv.h>\n#include <sound/wm2200.h>\n\n#include \"wm2200.h\"\n#include \"wm_adsp.h\"\n\n#define WM2200_DSP_CONTROL_1                   0x00\n#define WM2200_DSP_CONTROL_2                   0x02\n#define WM2200_DSP_CONTROL_3                   0x03\n#define WM2200_DSP_CONTROL_4                   0x04\n#define WM2200_DSP_CONTROL_5                   0x06\n#define WM2200_DSP_CONTROL_6                   0x07\n#define WM2200_DSP_CONTROL_7                   0x08\n#define WM2200_DSP_CONTROL_8                   0x09\n#define WM2200_DSP_CONTROL_9                   0x0A\n#define WM2200_DSP_CONTROL_10                  0x0B\n#define WM2200_DSP_CONTROL_11                  0x0C\n#define WM2200_DSP_CONTROL_12                  0x0D\n#define WM2200_DSP_CONTROL_13                  0x0F\n#define WM2200_DSP_CONTROL_14                  0x10\n#define WM2200_DSP_CONTROL_15                  0x11\n#define WM2200_DSP_CONTROL_16                  0x12\n#define WM2200_DSP_CONTROL_17                  0x13\n#define WM2200_DSP_CONTROL_18                  0x14\n#define WM2200_DSP_CONTROL_19                  0x16\n#define WM2200_DSP_CONTROL_20                  0x17\n#define WM2200_DSP_CONTROL_21                  0x18\n#define WM2200_DSP_CONTROL_22                  0x1A\n#define WM2200_DSP_CONTROL_23                  0x1B\n#define WM2200_DSP_CONTROL_24                  0x1C\n#define WM2200_DSP_CONTROL_25                  0x1E\n#define WM2200_DSP_CONTROL_26                  0x20\n#define WM2200_DSP_CONTROL_27                  0x21\n#define WM2200_DSP_CONTROL_28                  0x22\n#define WM2200_DSP_CONTROL_29                  0x23\n#define WM2200_DSP_CONTROL_30                  0x24\n#define WM2200_DSP_CONTROL_31                  0x26\n\n \n#define WM2200_NUM_CORE_SUPPLIES 2\nstatic const char *wm2200_core_supply_names[WM2200_NUM_CORE_SUPPLIES] = {\n\t\"DBVDD\",\n\t\"LDOVDD\",\n};\n\n \nstruct wm2200_priv {\n\tstruct wm_adsp dsp[2];\n\tstruct regmap *regmap;\n\tstruct device *dev;\n\tstruct snd_soc_component *component;\n\tstruct wm2200_pdata pdata;\n\tstruct regulator_bulk_data core_supplies[WM2200_NUM_CORE_SUPPLIES];\n\n\tstruct completion fll_lock;\n\tint fll_fout;\n\tint fll_fref;\n\tint fll_src;\n\n\tint rev;\n\tint sysclk;\n\n\tunsigned int symmetric_rates:1;\n};\n\n#define WM2200_DSP_RANGE_BASE (WM2200_MAX_REGISTER + 1)\n#define WM2200_DSP_SPACING 12288\n\n#define WM2200_DSP1_DM_BASE (WM2200_DSP_RANGE_BASE + (0 * WM2200_DSP_SPACING))\n#define WM2200_DSP1_PM_BASE (WM2200_DSP_RANGE_BASE + (1 * WM2200_DSP_SPACING))\n#define WM2200_DSP1_ZM_BASE (WM2200_DSP_RANGE_BASE + (2 * WM2200_DSP_SPACING))\n#define WM2200_DSP2_DM_BASE (WM2200_DSP_RANGE_BASE + (3 * WM2200_DSP_SPACING))\n#define WM2200_DSP2_PM_BASE (WM2200_DSP_RANGE_BASE + (4 * WM2200_DSP_SPACING))\n#define WM2200_DSP2_ZM_BASE (WM2200_DSP_RANGE_BASE + (5 * WM2200_DSP_SPACING))\n\nstatic const struct regmap_range_cfg wm2200_ranges[] = {\n\t{ .name = \"DSP1DM\", .range_min = WM2200_DSP1_DM_BASE,\n\t  .range_max = WM2200_DSP1_DM_BASE + 12287,\n\t  .selector_reg = WM2200_DSP1_CONTROL_3,\n\t  .selector_mask = WM2200_DSP1_PAGE_BASE_DM_0_MASK,\n\t  .selector_shift = WM2200_DSP1_PAGE_BASE_DM_0_SHIFT,\n\t  .window_start = WM2200_DSP1_DM_0, .window_len = 2048, },\n\n\t{ .name = \"DSP1PM\", .range_min = WM2200_DSP1_PM_BASE,\n\t  .range_max = WM2200_DSP1_PM_BASE + 12287,\n\t  .selector_reg = WM2200_DSP1_CONTROL_2,\n\t  .selector_mask = WM2200_DSP1_PAGE_BASE_PM_0_MASK,\n\t  .selector_shift = WM2200_DSP1_PAGE_BASE_PM_0_SHIFT,\n\t  .window_start = WM2200_DSP1_PM_0, .window_len = 768, },\n\n\t{ .name = \"DSP1ZM\", .range_min = WM2200_DSP1_ZM_BASE,\n\t  .range_max = WM2200_DSP1_ZM_BASE + 2047,\n\t  .selector_reg = WM2200_DSP1_CONTROL_4,\n\t  .selector_mask = WM2200_DSP1_PAGE_BASE_ZM_0_MASK,\n\t  .selector_shift = WM2200_DSP1_PAGE_BASE_ZM_0_SHIFT,\n\t  .window_start = WM2200_DSP1_ZM_0, .window_len = 1024, },\n\n\t{ .name = \"DSP2DM\", .range_min = WM2200_DSP2_DM_BASE,\n\t  .range_max = WM2200_DSP2_DM_BASE + 4095,\n\t  .selector_reg = WM2200_DSP2_CONTROL_3,\n\t  .selector_mask = WM2200_DSP2_PAGE_BASE_DM_0_MASK,\n\t  .selector_shift = WM2200_DSP2_PAGE_BASE_DM_0_SHIFT,\n\t  .window_start = WM2200_DSP2_DM_0, .window_len = 2048, },\n\n\t{ .name = \"DSP2PM\", .range_min = WM2200_DSP2_PM_BASE,\n\t  .range_max = WM2200_DSP2_PM_BASE + 11287,\n\t  .selector_reg = WM2200_DSP2_CONTROL_2,\n\t  .selector_mask = WM2200_DSP2_PAGE_BASE_PM_0_MASK,\n\t  .selector_shift = WM2200_DSP2_PAGE_BASE_PM_0_SHIFT,\n\t  .window_start = WM2200_DSP2_PM_0, .window_len = 768, },\n\n\t{ .name = \"DSP2ZM\", .range_min = WM2200_DSP2_ZM_BASE,\n\t  .range_max = WM2200_DSP2_ZM_BASE + 2047,\n\t  .selector_reg = WM2200_DSP2_CONTROL_4,\n\t  .selector_mask = WM2200_DSP2_PAGE_BASE_ZM_0_MASK,\n\t  .selector_shift = WM2200_DSP2_PAGE_BASE_ZM_0_SHIFT,\n\t  .window_start = WM2200_DSP2_ZM_0, .window_len = 1024, },\n};\n\nstatic const struct cs_dsp_region wm2200_dsp1_regions[] = {\n\t{ .type = WMFW_ADSP1_PM, .base = WM2200_DSP1_PM_BASE },\n\t{ .type = WMFW_ADSP1_DM, .base = WM2200_DSP1_DM_BASE },\n\t{ .type = WMFW_ADSP1_ZM, .base = WM2200_DSP1_ZM_BASE },\n};\n\nstatic const struct cs_dsp_region wm2200_dsp2_regions[] = {\n\t{ .type = WMFW_ADSP1_PM, .base = WM2200_DSP2_PM_BASE },\n\t{ .type = WMFW_ADSP1_DM, .base = WM2200_DSP2_DM_BASE },\n\t{ .type = WMFW_ADSP1_ZM, .base = WM2200_DSP2_ZM_BASE },\n};\n\nstatic const struct reg_default wm2200_reg_defaults[] = {\n\t{ 0x000B, 0x0000 },    \n\t{ 0x0102, 0x0000 },    \n\t{ 0x0103, 0x0011 },    \n\t{ 0x0111, 0x0000 },    \n\t{ 0x0112, 0x0000 },    \n\t{ 0x0113, 0x0000 },    \n\t{ 0x0114, 0x0000 },    \n\t{ 0x0116, 0x0177 },    \n\t{ 0x0117, 0x0004 },    \n\t{ 0x0119, 0x0000 },    \n\t{ 0x011A, 0x0002 },    \n\t{ 0x0200, 0x0000 },    \n\t{ 0x0201, 0x03FF },    \n\t{ 0x0202, 0x9BDE },    \n\t{ 0x020C, 0x0000 },    \n\t{ 0x020D, 0x0000 },    \n\t{ 0x020F, 0x0000 },    \n\t{ 0x0210, 0x0000 },    \n\t{ 0x0301, 0x0000 },    \n\t{ 0x0302, 0x2240 },    \n\t{ 0x0303, 0x0040 },    \n\t{ 0x0304, 0x2240 },    \n\t{ 0x0305, 0x0040 },    \n\t{ 0x0306, 0x2240 },    \n\t{ 0x0307, 0x0040 },    \n\t{ 0x030A, 0x0000 },    \n\t{ 0x030B, 0x0022 },    \n\t{ 0x030C, 0x0180 },    \n\t{ 0x030D, 0x0180 },    \n\t{ 0x030E, 0x0180 },    \n\t{ 0x030F, 0x0180 },    \n\t{ 0x0310, 0x0180 },    \n\t{ 0x0311, 0x0180 },    \n\t{ 0x0400, 0x0000 },    \n\t{ 0x0401, 0x0000 },    \n\t{ 0x0402, 0x0000 },    \n\t{ 0x0403, 0x0000 },    \n\t{ 0x0404, 0x0000 },    \n\t{ 0x0409, 0x0000 },    \n\t{ 0x040A, 0x0022 },    \n\t{ 0x040B, 0x0180 },    \n\t{ 0x040C, 0x0180 },    \n\t{ 0x040D, 0x0180 },    \n\t{ 0x040E, 0x0180 },    \n\t{ 0x0417, 0x0069 },    \n\t{ 0x0418, 0x0000 },    \n\t{ 0x0500, 0x0000 },    \n\t{ 0x0501, 0x0008 },    \n\t{ 0x0502, 0x0000 },    \n\t{ 0x0503, 0x0000 },    \n\t{ 0x0504, 0x0000 },    \n\t{ 0x0505, 0x0001 },    \n\t{ 0x0506, 0x0001 },    \n\t{ 0x0507, 0x0000 },    \n\t{ 0x0508, 0x0000 },    \n\t{ 0x0509, 0x0000 },    \n\t{ 0x050A, 0x0000 },    \n\t{ 0x050B, 0x0000 },    \n\t{ 0x050C, 0x0000 },    \n\t{ 0x050D, 0x0000 },    \n\t{ 0x050E, 0x0000 },    \n\t{ 0x050F, 0x0000 },    \n\t{ 0x0510, 0x0000 },    \n\t{ 0x0511, 0x0000 },    \n\t{ 0x0512, 0x0000 },    \n\t{ 0x0513, 0x0000 },    \n\t{ 0x0514, 0x0000 },    \n\t{ 0x0515, 0x0001 },    \n\t{ 0x0600, 0x0000 },    \n\t{ 0x0601, 0x0080 },    \n\t{ 0x0602, 0x0000 },    \n\t{ 0x0603, 0x0080 },    \n\t{ 0x0604, 0x0000 },    \n\t{ 0x0605, 0x0080 },    \n\t{ 0x0606, 0x0000 },    \n\t{ 0x0607, 0x0080 },    \n\t{ 0x0608, 0x0000 },    \n\t{ 0x0609, 0x0080 },    \n\t{ 0x060A, 0x0000 },    \n\t{ 0x060B, 0x0080 },    \n\t{ 0x060C, 0x0000 },    \n\t{ 0x060D, 0x0080 },    \n\t{ 0x060E, 0x0000 },    \n\t{ 0x060F, 0x0080 },    \n\t{ 0x0610, 0x0000 },    \n\t{ 0x0611, 0x0080 },    \n\t{ 0x0612, 0x0000 },    \n\t{ 0x0613, 0x0080 },    \n\t{ 0x0614, 0x0000 },    \n\t{ 0x0615, 0x0080 },    \n\t{ 0x0616, 0x0000 },    \n\t{ 0x0617, 0x0080 },    \n\t{ 0x0618, 0x0000 },    \n\t{ 0x0619, 0x0080 },    \n\t{ 0x061A, 0x0000 },    \n\t{ 0x061B, 0x0080 },    \n\t{ 0x061C, 0x0000 },    \n\t{ 0x061D, 0x0080 },    \n\t{ 0x061E, 0x0000 },    \n\t{ 0x061F, 0x0080 },    \n\t{ 0x0620, 0x0000 },    \n\t{ 0x0621, 0x0080 },    \n\t{ 0x0622, 0x0000 },    \n\t{ 0x0623, 0x0080 },    \n\t{ 0x0624, 0x0000 },    \n\t{ 0x0625, 0x0080 },    \n\t{ 0x0626, 0x0000 },    \n\t{ 0x0627, 0x0080 },    \n\t{ 0x0628, 0x0000 },    \n\t{ 0x0629, 0x0080 },    \n\t{ 0x062A, 0x0000 },    \n\t{ 0x062B, 0x0080 },    \n\t{ 0x062C, 0x0000 },    \n\t{ 0x062D, 0x0080 },    \n\t{ 0x062E, 0x0000 },    \n\t{ 0x062F, 0x0080 },    \n\t{ 0x0630, 0x0000 },    \n\t{ 0x0631, 0x0080 },    \n\t{ 0x0632, 0x0000 },    \n\t{ 0x0633, 0x0080 },    \n\t{ 0x0634, 0x0000 },    \n\t{ 0x0635, 0x0080 },    \n\t{ 0x0636, 0x0000 },    \n\t{ 0x0637, 0x0080 },    \n\t{ 0x0638, 0x0000 },    \n\t{ 0x0639, 0x0080 },    \n\t{ 0x063A, 0x0000 },    \n\t{ 0x063B, 0x0080 },    \n\t{ 0x063C, 0x0000 },    \n\t{ 0x063D, 0x0080 },    \n\t{ 0x063E, 0x0000 },    \n\t{ 0x063F, 0x0080 },    \n\t{ 0x0640, 0x0000 },    \n\t{ 0x0641, 0x0080 },    \n\t{ 0x0642, 0x0000 },    \n\t{ 0x0643, 0x0080 },    \n\t{ 0x0644, 0x0000 },    \n\t{ 0x0645, 0x0080 },    \n\t{ 0x0646, 0x0000 },    \n\t{ 0x0647, 0x0080 },    \n\t{ 0x0648, 0x0000 },    \n\t{ 0x0649, 0x0080 },    \n\t{ 0x064A, 0x0000 },    \n\t{ 0x064B, 0x0080 },    \n\t{ 0x064C, 0x0000 },    \n\t{ 0x064D, 0x0080 },    \n\t{ 0x064E, 0x0000 },    \n\t{ 0x064F, 0x0080 },    \n\t{ 0x0650, 0x0000 },    \n\t{ 0x0651, 0x0080 },    \n\t{ 0x0652, 0x0000 },    \n\t{ 0x0653, 0x0080 },    \n\t{ 0x0654, 0x0000 },    \n\t{ 0x0655, 0x0080 },    \n\t{ 0x0656, 0x0000 },    \n\t{ 0x0657, 0x0080 },    \n\t{ 0x0658, 0x0000 },    \n\t{ 0x0659, 0x0080 },    \n\t{ 0x065A, 0x0000 },    \n\t{ 0x065B, 0x0080 },    \n\t{ 0x065C, 0x0000 },    \n\t{ 0x065D, 0x0080 },    \n\t{ 0x065E, 0x0000 },    \n\t{ 0x065F, 0x0080 },    \n\t{ 0x0660, 0x0000 },    \n\t{ 0x0661, 0x0080 },    \n\t{ 0x0662, 0x0000 },    \n\t{ 0x0663, 0x0080 },    \n\t{ 0x0664, 0x0000 },    \n\t{ 0x0665, 0x0080 },    \n\t{ 0x0666, 0x0000 },    \n\t{ 0x0667, 0x0080 },    \n\t{ 0x0668, 0x0000 },    \n\t{ 0x0669, 0x0080 },    \n\t{ 0x066A, 0x0000 },    \n\t{ 0x066B, 0x0080 },    \n\t{ 0x066C, 0x0000 },    \n\t{ 0x066D, 0x0080 },    \n\t{ 0x066E, 0x0000 },    \n\t{ 0x066F, 0x0080 },    \n\t{ 0x0670, 0x0000 },    \n\t{ 0x0671, 0x0080 },    \n\t{ 0x0672, 0x0000 },    \n\t{ 0x0673, 0x0080 },    \n\t{ 0x0674, 0x0000 },    \n\t{ 0x0675, 0x0080 },    \n\t{ 0x0676, 0x0000 },    \n\t{ 0x0677, 0x0080 },    \n\t{ 0x0678, 0x0000 },    \n\t{ 0x0679, 0x0080 },    \n\t{ 0x067A, 0x0000 },    \n\t{ 0x067B, 0x0080 },    \n\t{ 0x067C, 0x0000 },    \n\t{ 0x067D, 0x0080 },    \n\t{ 0x067E, 0x0000 },    \n\t{ 0x067F, 0x0080 },    \n\t{ 0x0680, 0x0000 },    \n\t{ 0x0681, 0x0000 },    \n\t{ 0x0682, 0x0000 },    \n\t{ 0x0683, 0x0000 },    \n\t{ 0x0684, 0x0000 },    \n\t{ 0x0685, 0x0000 },    \n\t{ 0x0686, 0x0000 },    \n\t{ 0x0687, 0x0080 },    \n\t{ 0x0688, 0x0000 },    \n\t{ 0x0689, 0x0080 },    \n\t{ 0x068A, 0x0000 },    \n\t{ 0x068B, 0x0080 },    \n\t{ 0x068C, 0x0000 },    \n\t{ 0x068D, 0x0080 },    \n\t{ 0x068E, 0x0000 },    \n\t{ 0x068F, 0x0080 },    \n\t{ 0x0690, 0x0000 },    \n\t{ 0x0691, 0x0080 },    \n\t{ 0x0692, 0x0000 },    \n\t{ 0x0693, 0x0080 },    \n\t{ 0x0694, 0x0000 },    \n\t{ 0x0695, 0x0080 },    \n\t{ 0x0696, 0x0000 },    \n\t{ 0x0697, 0x0000 },    \n\t{ 0x0698, 0x0000 },    \n\t{ 0x0699, 0x0000 },    \n\t{ 0x069A, 0x0000 },    \n\t{ 0x069B, 0x0000 },    \n\t{ 0x0700, 0xA101 },    \n\t{ 0x0701, 0xA101 },    \n\t{ 0x0702, 0xA101 },    \n\t{ 0x0703, 0xA101 },    \n\t{ 0x0709, 0x0000 },    \n\t{ 0x0801, 0x00FF },    \n\t{ 0x0804, 0xFFFF },    \n\t{ 0x0808, 0x0000 },    \n\t{ 0x0900, 0x0000 },    \n\t{ 0x0901, 0x0000 },    \n\t{ 0x0902, 0x0000 },    \n\t{ 0x0903, 0x0000 },    \n\t{ 0x0904, 0x0000 },    \n\t{ 0x0905, 0x0000 },    \n\t{ 0x0906, 0x0000 },    \n\t{ 0x0907, 0x0000 },    \n\t{ 0x0908, 0x0000 },    \n\t{ 0x0909, 0x0000 },    \n\t{ 0x090A, 0x0000 },    \n\t{ 0x090B, 0x0000 },    \n\t{ 0x090C, 0x0000 },    \n\t{ 0x090D, 0x0000 },    \n\t{ 0x090E, 0x0000 },    \n\t{ 0x090F, 0x0000 },    \n\t{ 0x0910, 0x0000 },    \n\t{ 0x0911, 0x0000 },    \n\t{ 0x0912, 0x0000 },    \n\t{ 0x0913, 0x0000 },    \n\t{ 0x0916, 0x0000 },    \n\t{ 0x0917, 0x0000 },    \n\t{ 0x0918, 0x0000 },    \n\t{ 0x0919, 0x0000 },    \n\t{ 0x091A, 0x0000 },    \n\t{ 0x091B, 0x0000 },    \n\t{ 0x091C, 0x0000 },    \n\t{ 0x091D, 0x0000 },    \n\t{ 0x091E, 0x0000 },    \n\t{ 0x091F, 0x0000 },    \n\t{ 0x0920, 0x0000 },    \n\t{ 0x0921, 0x0000 },    \n\t{ 0x0922, 0x0000 },    \n\t{ 0x0923, 0x0000 },    \n\t{ 0x0924, 0x0000 },    \n\t{ 0x0925, 0x0000 },    \n\t{ 0x0926, 0x0000 },    \n\t{ 0x0927, 0x0000 },    \n\t{ 0x0928, 0x0000 },    \n\t{ 0x0929, 0x0000 },    \n\t{ 0x093E, 0x0000 },    \n\t{ 0x093F, 0x0000 },    \n\t{ 0x0942, 0x0000 },    \n\t{ 0x0943, 0x0000 },    \n\t{ 0x0A00, 0x0000 },    \n\t{ 0x0A02, 0x0000 },    \n\t{ 0x0A03, 0x0000 },    \n\t{ 0x0A04, 0x0000 },    \n\t{ 0x0A06, 0x0000 },    \n\t{ 0x0A07, 0x0000 },    \n\t{ 0x0A08, 0x0000 },    \n\t{ 0x0A09, 0x0000 },    \n\t{ 0x0A0A, 0x0000 },    \n\t{ 0x0A0B, 0x0000 },    \n\t{ 0x0A0C, 0x0000 },    \n\t{ 0x0A0D, 0x0000 },    \n\t{ 0x0A0F, 0x0000 },    \n\t{ 0x0A10, 0x0000 },    \n\t{ 0x0A11, 0x0000 },    \n\t{ 0x0A12, 0x0000 },    \n\t{ 0x0A13, 0x0000 },    \n\t{ 0x0A14, 0x0000 },    \n\t{ 0x0A16, 0x0000 },    \n\t{ 0x0A17, 0x0000 },    \n\t{ 0x0A18, 0x0000 },    \n\t{ 0x0A1A, 0x1800 },    \n\t{ 0x0A1B, 0x1000 },    \n\t{ 0x0A1C, 0x0400 },    \n\t{ 0x0A1E, 0x0000 },    \n\t{ 0x0A20, 0x0000 },    \n\t{ 0x0A21, 0x0000 },    \n\t{ 0x0A22, 0x0000 },    \n\t{ 0x0A23, 0x0000 },    \n\t{ 0x0A24, 0x0000 },    \n\t{ 0x0A26, 0x0000 },    \n\t{ 0x0B00, 0x0000 },    \n\t{ 0x0B02, 0x0000 },    \n\t{ 0x0B03, 0x0000 },    \n\t{ 0x0B04, 0x0000 },    \n\t{ 0x0B06, 0x0000 },    \n\t{ 0x0B07, 0x0000 },    \n\t{ 0x0B08, 0x0000 },    \n\t{ 0x0B09, 0x0000 },    \n\t{ 0x0B0A, 0x0000 },    \n\t{ 0x0B0B, 0x0000 },    \n\t{ 0x0B0C, 0x0000 },    \n\t{ 0x0B0D, 0x0000 },    \n\t{ 0x0B0F, 0x0000 },    \n\t{ 0x0B10, 0x0000 },    \n\t{ 0x0B11, 0x0000 },    \n\t{ 0x0B12, 0x0000 },    \n\t{ 0x0B13, 0x0000 },    \n\t{ 0x0B14, 0x0000 },    \n\t{ 0x0B16, 0x0000 },    \n\t{ 0x0B17, 0x0000 },    \n\t{ 0x0B18, 0x0000 },    \n\t{ 0x0B1A, 0x0800 },    \n\t{ 0x0B1B, 0x1000 },    \n\t{ 0x0B1C, 0x0400 },    \n\t{ 0x0B1E, 0x0000 },    \n\t{ 0x0B20, 0x0000 },    \n\t{ 0x0B21, 0x0000 },    \n\t{ 0x0B22, 0x0000 },    \n\t{ 0x0B23, 0x0000 },    \n\t{ 0x0B24, 0x0000 },    \n\t{ 0x0B26, 0x0000 },    \n};\n\nstatic bool wm2200_volatile_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200_ranges); i++)\n\t\tif ((reg >= wm2200_ranges[i].window_start &&\n\t\t     reg <= wm2200_ranges[i].window_start +\n\t\t     wm2200_ranges[i].window_len) ||\n\t\t    (reg >= wm2200_ranges[i].range_min &&\n\t\t     reg <= wm2200_ranges[i].range_max))\n\t\t\treturn true;\n\n\tswitch (reg) {\n\tcase WM2200_SOFTWARE_RESET:\n\tcase WM2200_DEVICE_REVISION:\n\tcase WM2200_ADPS1_IRQ0:\n\tcase WM2200_ADPS1_IRQ1:\n\tcase WM2200_INTERRUPT_STATUS_1:\n\tcase WM2200_INTERRUPT_STATUS_2:\n\tcase WM2200_INTERRUPT_RAW_STATUS_2:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic bool wm2200_readable_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200_ranges); i++)\n\t\tif ((reg >= wm2200_ranges[i].window_start &&\n\t\t     reg <= wm2200_ranges[i].window_start +\n\t\t     wm2200_ranges[i].window_len) ||\n\t\t    (reg >= wm2200_ranges[i].range_min &&\n\t\t     reg <= wm2200_ranges[i].range_max))\n\t\t\treturn true;\n\n\tswitch (reg) {\n\tcase WM2200_SOFTWARE_RESET:\n\tcase WM2200_DEVICE_REVISION:\n\tcase WM2200_TONE_GENERATOR_1:\n\tcase WM2200_CLOCKING_3:\n\tcase WM2200_CLOCKING_4:\n\tcase WM2200_FLL_CONTROL_1:\n\tcase WM2200_FLL_CONTROL_2:\n\tcase WM2200_FLL_CONTROL_3:\n\tcase WM2200_FLL_CONTROL_4:\n\tcase WM2200_FLL_CONTROL_6:\n\tcase WM2200_FLL_CONTROL_7:\n\tcase WM2200_FLL_EFS_1:\n\tcase WM2200_FLL_EFS_2:\n\tcase WM2200_MIC_CHARGE_PUMP_1:\n\tcase WM2200_MIC_CHARGE_PUMP_2:\n\tcase WM2200_DM_CHARGE_PUMP_1:\n\tcase WM2200_MIC_BIAS_CTRL_1:\n\tcase WM2200_MIC_BIAS_CTRL_2:\n\tcase WM2200_EAR_PIECE_CTRL_1:\n\tcase WM2200_EAR_PIECE_CTRL_2:\n\tcase WM2200_INPUT_ENABLES:\n\tcase WM2200_IN1L_CONTROL:\n\tcase WM2200_IN1R_CONTROL:\n\tcase WM2200_IN2L_CONTROL:\n\tcase WM2200_IN2R_CONTROL:\n\tcase WM2200_IN3L_CONTROL:\n\tcase WM2200_IN3R_CONTROL:\n\tcase WM2200_RXANC_SRC:\n\tcase WM2200_INPUT_VOLUME_RAMP:\n\tcase WM2200_ADC_DIGITAL_VOLUME_1L:\n\tcase WM2200_ADC_DIGITAL_VOLUME_1R:\n\tcase WM2200_ADC_DIGITAL_VOLUME_2L:\n\tcase WM2200_ADC_DIGITAL_VOLUME_2R:\n\tcase WM2200_ADC_DIGITAL_VOLUME_3L:\n\tcase WM2200_ADC_DIGITAL_VOLUME_3R:\n\tcase WM2200_OUTPUT_ENABLES:\n\tcase WM2200_DAC_VOLUME_LIMIT_1L:\n\tcase WM2200_DAC_VOLUME_LIMIT_1R:\n\tcase WM2200_DAC_VOLUME_LIMIT_2L:\n\tcase WM2200_DAC_VOLUME_LIMIT_2R:\n\tcase WM2200_DAC_AEC_CONTROL_1:\n\tcase WM2200_OUTPUT_VOLUME_RAMP:\n\tcase WM2200_DAC_DIGITAL_VOLUME_1L:\n\tcase WM2200_DAC_DIGITAL_VOLUME_1R:\n\tcase WM2200_DAC_DIGITAL_VOLUME_2L:\n\tcase WM2200_DAC_DIGITAL_VOLUME_2R:\n\tcase WM2200_PDM_1:\n\tcase WM2200_PDM_2:\n\tcase WM2200_AUDIO_IF_1_1:\n\tcase WM2200_AUDIO_IF_1_2:\n\tcase WM2200_AUDIO_IF_1_3:\n\tcase WM2200_AUDIO_IF_1_4:\n\tcase WM2200_AUDIO_IF_1_5:\n\tcase WM2200_AUDIO_IF_1_6:\n\tcase WM2200_AUDIO_IF_1_7:\n\tcase WM2200_AUDIO_IF_1_8:\n\tcase WM2200_AUDIO_IF_1_9:\n\tcase WM2200_AUDIO_IF_1_10:\n\tcase WM2200_AUDIO_IF_1_11:\n\tcase WM2200_AUDIO_IF_1_12:\n\tcase WM2200_AUDIO_IF_1_13:\n\tcase WM2200_AUDIO_IF_1_14:\n\tcase WM2200_AUDIO_IF_1_15:\n\tcase WM2200_AUDIO_IF_1_16:\n\tcase WM2200_AUDIO_IF_1_17:\n\tcase WM2200_AUDIO_IF_1_18:\n\tcase WM2200_AUDIO_IF_1_19:\n\tcase WM2200_AUDIO_IF_1_20:\n\tcase WM2200_AUDIO_IF_1_21:\n\tcase WM2200_AUDIO_IF_1_22:\n\tcase WM2200_OUT1LMIX_INPUT_1_SOURCE:\n\tcase WM2200_OUT1LMIX_INPUT_1_VOLUME:\n\tcase WM2200_OUT1LMIX_INPUT_2_SOURCE:\n\tcase WM2200_OUT1LMIX_INPUT_2_VOLUME:\n\tcase WM2200_OUT1LMIX_INPUT_3_SOURCE:\n\tcase WM2200_OUT1LMIX_INPUT_3_VOLUME:\n\tcase WM2200_OUT1LMIX_INPUT_4_SOURCE:\n\tcase WM2200_OUT1LMIX_INPUT_4_VOLUME:\n\tcase WM2200_OUT1RMIX_INPUT_1_SOURCE:\n\tcase WM2200_OUT1RMIX_INPUT_1_VOLUME:\n\tcase WM2200_OUT1RMIX_INPUT_2_SOURCE:\n\tcase WM2200_OUT1RMIX_INPUT_2_VOLUME:\n\tcase WM2200_OUT1RMIX_INPUT_3_SOURCE:\n\tcase WM2200_OUT1RMIX_INPUT_3_VOLUME:\n\tcase WM2200_OUT1RMIX_INPUT_4_SOURCE:\n\tcase WM2200_OUT1RMIX_INPUT_4_VOLUME:\n\tcase WM2200_OUT2LMIX_INPUT_1_SOURCE:\n\tcase WM2200_OUT2LMIX_INPUT_1_VOLUME:\n\tcase WM2200_OUT2LMIX_INPUT_2_SOURCE:\n\tcase WM2200_OUT2LMIX_INPUT_2_VOLUME:\n\tcase WM2200_OUT2LMIX_INPUT_3_SOURCE:\n\tcase WM2200_OUT2LMIX_INPUT_3_VOLUME:\n\tcase WM2200_OUT2LMIX_INPUT_4_SOURCE:\n\tcase WM2200_OUT2LMIX_INPUT_4_VOLUME:\n\tcase WM2200_OUT2RMIX_INPUT_1_SOURCE:\n\tcase WM2200_OUT2RMIX_INPUT_1_VOLUME:\n\tcase WM2200_OUT2RMIX_INPUT_2_SOURCE:\n\tcase WM2200_OUT2RMIX_INPUT_2_VOLUME:\n\tcase WM2200_OUT2RMIX_INPUT_3_SOURCE:\n\tcase WM2200_OUT2RMIX_INPUT_3_VOLUME:\n\tcase WM2200_OUT2RMIX_INPUT_4_SOURCE:\n\tcase WM2200_OUT2RMIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX1MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX1MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX1MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX1MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX1MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX1MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX1MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX1MIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX2MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX2MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX2MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX2MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX2MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX2MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX2MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX2MIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX3MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX3MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX3MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX3MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX3MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX3MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX3MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX3MIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX4MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX4MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX4MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX4MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX4MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX4MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX4MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX4MIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX5MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX5MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX5MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX5MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX5MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX5MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX5MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX5MIX_INPUT_4_VOLUME:\n\tcase WM2200_AIF1TX6MIX_INPUT_1_SOURCE:\n\tcase WM2200_AIF1TX6MIX_INPUT_1_VOLUME:\n\tcase WM2200_AIF1TX6MIX_INPUT_2_SOURCE:\n\tcase WM2200_AIF1TX6MIX_INPUT_2_VOLUME:\n\tcase WM2200_AIF1TX6MIX_INPUT_3_SOURCE:\n\tcase WM2200_AIF1TX6MIX_INPUT_3_VOLUME:\n\tcase WM2200_AIF1TX6MIX_INPUT_4_SOURCE:\n\tcase WM2200_AIF1TX6MIX_INPUT_4_VOLUME:\n\tcase WM2200_EQLMIX_INPUT_1_SOURCE:\n\tcase WM2200_EQLMIX_INPUT_1_VOLUME:\n\tcase WM2200_EQLMIX_INPUT_2_SOURCE:\n\tcase WM2200_EQLMIX_INPUT_2_VOLUME:\n\tcase WM2200_EQLMIX_INPUT_3_SOURCE:\n\tcase WM2200_EQLMIX_INPUT_3_VOLUME:\n\tcase WM2200_EQLMIX_INPUT_4_SOURCE:\n\tcase WM2200_EQLMIX_INPUT_4_VOLUME:\n\tcase WM2200_EQRMIX_INPUT_1_SOURCE:\n\tcase WM2200_EQRMIX_INPUT_1_VOLUME:\n\tcase WM2200_EQRMIX_INPUT_2_SOURCE:\n\tcase WM2200_EQRMIX_INPUT_2_VOLUME:\n\tcase WM2200_EQRMIX_INPUT_3_SOURCE:\n\tcase WM2200_EQRMIX_INPUT_3_VOLUME:\n\tcase WM2200_EQRMIX_INPUT_4_SOURCE:\n\tcase WM2200_EQRMIX_INPUT_4_VOLUME:\n\tcase WM2200_LHPF1MIX_INPUT_1_SOURCE:\n\tcase WM2200_LHPF1MIX_INPUT_1_VOLUME:\n\tcase WM2200_LHPF1MIX_INPUT_2_SOURCE:\n\tcase WM2200_LHPF1MIX_INPUT_2_VOLUME:\n\tcase WM2200_LHPF1MIX_INPUT_3_SOURCE:\n\tcase WM2200_LHPF1MIX_INPUT_3_VOLUME:\n\tcase WM2200_LHPF1MIX_INPUT_4_SOURCE:\n\tcase WM2200_LHPF1MIX_INPUT_4_VOLUME:\n\tcase WM2200_LHPF2MIX_INPUT_1_SOURCE:\n\tcase WM2200_LHPF2MIX_INPUT_1_VOLUME:\n\tcase WM2200_LHPF2MIX_INPUT_2_SOURCE:\n\tcase WM2200_LHPF2MIX_INPUT_2_VOLUME:\n\tcase WM2200_LHPF2MIX_INPUT_3_SOURCE:\n\tcase WM2200_LHPF2MIX_INPUT_3_VOLUME:\n\tcase WM2200_LHPF2MIX_INPUT_4_SOURCE:\n\tcase WM2200_LHPF2MIX_INPUT_4_VOLUME:\n\tcase WM2200_DSP1LMIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1LMIX_INPUT_1_VOLUME:\n\tcase WM2200_DSP1LMIX_INPUT_2_SOURCE:\n\tcase WM2200_DSP1LMIX_INPUT_2_VOLUME:\n\tcase WM2200_DSP1LMIX_INPUT_3_SOURCE:\n\tcase WM2200_DSP1LMIX_INPUT_3_VOLUME:\n\tcase WM2200_DSP1LMIX_INPUT_4_SOURCE:\n\tcase WM2200_DSP1LMIX_INPUT_4_VOLUME:\n\tcase WM2200_DSP1RMIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1RMIX_INPUT_1_VOLUME:\n\tcase WM2200_DSP1RMIX_INPUT_2_SOURCE:\n\tcase WM2200_DSP1RMIX_INPUT_2_VOLUME:\n\tcase WM2200_DSP1RMIX_INPUT_3_SOURCE:\n\tcase WM2200_DSP1RMIX_INPUT_3_VOLUME:\n\tcase WM2200_DSP1RMIX_INPUT_4_SOURCE:\n\tcase WM2200_DSP1RMIX_INPUT_4_VOLUME:\n\tcase WM2200_DSP1AUX1MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1AUX2MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1AUX3MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1AUX4MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1AUX5MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP1AUX6MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2LMIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2LMIX_INPUT_1_VOLUME:\n\tcase WM2200_DSP2LMIX_INPUT_2_SOURCE:\n\tcase WM2200_DSP2LMIX_INPUT_2_VOLUME:\n\tcase WM2200_DSP2LMIX_INPUT_3_SOURCE:\n\tcase WM2200_DSP2LMIX_INPUT_3_VOLUME:\n\tcase WM2200_DSP2LMIX_INPUT_4_SOURCE:\n\tcase WM2200_DSP2LMIX_INPUT_4_VOLUME:\n\tcase WM2200_DSP2RMIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2RMIX_INPUT_1_VOLUME:\n\tcase WM2200_DSP2RMIX_INPUT_2_SOURCE:\n\tcase WM2200_DSP2RMIX_INPUT_2_VOLUME:\n\tcase WM2200_DSP2RMIX_INPUT_3_SOURCE:\n\tcase WM2200_DSP2RMIX_INPUT_3_VOLUME:\n\tcase WM2200_DSP2RMIX_INPUT_4_SOURCE:\n\tcase WM2200_DSP2RMIX_INPUT_4_VOLUME:\n\tcase WM2200_DSP2AUX1MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2AUX2MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2AUX3MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2AUX4MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2AUX5MIX_INPUT_1_SOURCE:\n\tcase WM2200_DSP2AUX6MIX_INPUT_1_SOURCE:\n\tcase WM2200_GPIO_CTRL_1:\n\tcase WM2200_GPIO_CTRL_2:\n\tcase WM2200_GPIO_CTRL_3:\n\tcase WM2200_GPIO_CTRL_4:\n\tcase WM2200_ADPS1_IRQ0:\n\tcase WM2200_ADPS1_IRQ1:\n\tcase WM2200_MISC_PAD_CTRL_1:\n\tcase WM2200_INTERRUPT_STATUS_1:\n\tcase WM2200_INTERRUPT_STATUS_1_MASK:\n\tcase WM2200_INTERRUPT_STATUS_2:\n\tcase WM2200_INTERRUPT_RAW_STATUS_2:\n\tcase WM2200_INTERRUPT_STATUS_2_MASK:\n\tcase WM2200_INTERRUPT_CONTROL:\n\tcase WM2200_EQL_1:\n\tcase WM2200_EQL_2:\n\tcase WM2200_EQL_3:\n\tcase WM2200_EQL_4:\n\tcase WM2200_EQL_5:\n\tcase WM2200_EQL_6:\n\tcase WM2200_EQL_7:\n\tcase WM2200_EQL_8:\n\tcase WM2200_EQL_9:\n\tcase WM2200_EQL_10:\n\tcase WM2200_EQL_11:\n\tcase WM2200_EQL_12:\n\tcase WM2200_EQL_13:\n\tcase WM2200_EQL_14:\n\tcase WM2200_EQL_15:\n\tcase WM2200_EQL_16:\n\tcase WM2200_EQL_17:\n\tcase WM2200_EQL_18:\n\tcase WM2200_EQL_19:\n\tcase WM2200_EQL_20:\n\tcase WM2200_EQR_1:\n\tcase WM2200_EQR_2:\n\tcase WM2200_EQR_3:\n\tcase WM2200_EQR_4:\n\tcase WM2200_EQR_5:\n\tcase WM2200_EQR_6:\n\tcase WM2200_EQR_7:\n\tcase WM2200_EQR_8:\n\tcase WM2200_EQR_9:\n\tcase WM2200_EQR_10:\n\tcase WM2200_EQR_11:\n\tcase WM2200_EQR_12:\n\tcase WM2200_EQR_13:\n\tcase WM2200_EQR_14:\n\tcase WM2200_EQR_15:\n\tcase WM2200_EQR_16:\n\tcase WM2200_EQR_17:\n\tcase WM2200_EQR_18:\n\tcase WM2200_EQR_19:\n\tcase WM2200_EQR_20:\n\tcase WM2200_HPLPF1_1:\n\tcase WM2200_HPLPF1_2:\n\tcase WM2200_HPLPF2_1:\n\tcase WM2200_HPLPF2_2:\n\tcase WM2200_DSP1_CONTROL_1:\n\tcase WM2200_DSP1_CONTROL_2:\n\tcase WM2200_DSP1_CONTROL_3:\n\tcase WM2200_DSP1_CONTROL_4:\n\tcase WM2200_DSP1_CONTROL_5:\n\tcase WM2200_DSP1_CONTROL_6:\n\tcase WM2200_DSP1_CONTROL_7:\n\tcase WM2200_DSP1_CONTROL_8:\n\tcase WM2200_DSP1_CONTROL_9:\n\tcase WM2200_DSP1_CONTROL_10:\n\tcase WM2200_DSP1_CONTROL_11:\n\tcase WM2200_DSP1_CONTROL_12:\n\tcase WM2200_DSP1_CONTROL_13:\n\tcase WM2200_DSP1_CONTROL_14:\n\tcase WM2200_DSP1_CONTROL_15:\n\tcase WM2200_DSP1_CONTROL_16:\n\tcase WM2200_DSP1_CONTROL_17:\n\tcase WM2200_DSP1_CONTROL_18:\n\tcase WM2200_DSP1_CONTROL_19:\n\tcase WM2200_DSP1_CONTROL_20:\n\tcase WM2200_DSP1_CONTROL_21:\n\tcase WM2200_DSP1_CONTROL_22:\n\tcase WM2200_DSP1_CONTROL_23:\n\tcase WM2200_DSP1_CONTROL_24:\n\tcase WM2200_DSP1_CONTROL_25:\n\tcase WM2200_DSP1_CONTROL_26:\n\tcase WM2200_DSP1_CONTROL_27:\n\tcase WM2200_DSP1_CONTROL_28:\n\tcase WM2200_DSP1_CONTROL_29:\n\tcase WM2200_DSP1_CONTROL_30:\n\tcase WM2200_DSP1_CONTROL_31:\n\tcase WM2200_DSP2_CONTROL_1:\n\tcase WM2200_DSP2_CONTROL_2:\n\tcase WM2200_DSP2_CONTROL_3:\n\tcase WM2200_DSP2_CONTROL_4:\n\tcase WM2200_DSP2_CONTROL_5:\n\tcase WM2200_DSP2_CONTROL_6:\n\tcase WM2200_DSP2_CONTROL_7:\n\tcase WM2200_DSP2_CONTROL_8:\n\tcase WM2200_DSP2_CONTROL_9:\n\tcase WM2200_DSP2_CONTROL_10:\n\tcase WM2200_DSP2_CONTROL_11:\n\tcase WM2200_DSP2_CONTROL_12:\n\tcase WM2200_DSP2_CONTROL_13:\n\tcase WM2200_DSP2_CONTROL_14:\n\tcase WM2200_DSP2_CONTROL_15:\n\tcase WM2200_DSP2_CONTROL_16:\n\tcase WM2200_DSP2_CONTROL_17:\n\tcase WM2200_DSP2_CONTROL_18:\n\tcase WM2200_DSP2_CONTROL_19:\n\tcase WM2200_DSP2_CONTROL_20:\n\tcase WM2200_DSP2_CONTROL_21:\n\tcase WM2200_DSP2_CONTROL_22:\n\tcase WM2200_DSP2_CONTROL_23:\n\tcase WM2200_DSP2_CONTROL_24:\n\tcase WM2200_DSP2_CONTROL_25:\n\tcase WM2200_DSP2_CONTROL_26:\n\tcase WM2200_DSP2_CONTROL_27:\n\tcase WM2200_DSP2_CONTROL_28:\n\tcase WM2200_DSP2_CONTROL_29:\n\tcase WM2200_DSP2_CONTROL_30:\n\tcase WM2200_DSP2_CONTROL_31:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic const struct reg_sequence wm2200_reva_patch[] = {\n\t{ 0x07, 0x0003 },\n\t{ 0x102, 0x0200 },\n\t{ 0x203, 0x0084 },\n\t{ 0x201, 0x83FF },\n\t{ 0x20C, 0x0062 },\n\t{ 0x20D, 0x0062 },\n\t{ 0x207, 0x2002 },\n\t{ 0x208, 0x20C0 },\n\t{ 0x21D, 0x01C0 },\n\t{ 0x50A, 0x0001 },\n\t{ 0x50B, 0x0002 },\n\t{ 0x50C, 0x0003 },\n\t{ 0x50D, 0x0004 },\n\t{ 0x50E, 0x0005 },\n\t{ 0x510, 0x0001 },\n\t{ 0x511, 0x0002 },\n\t{ 0x512, 0x0003 },\n\t{ 0x513, 0x0004 },\n\t{ 0x514, 0x0005 },\n\t{ 0x515, 0x0000 },\n\t{ 0x201, 0x8084 },\n\t{ 0x202, 0xBBDE },\n\t{ 0x203, 0x00EC },\n\t{ 0x500, 0x8000 },\n\t{ 0x507, 0x1820 },\n\t{ 0x508, 0x1820 },\n\t{ 0x505, 0x0300 },\n\t{ 0x506, 0x0300 },\n\t{ 0x302, 0x2280 },\n\t{ 0x303, 0x0080 },\n\t{ 0x304, 0x2280 },\n\t{ 0x305, 0x0080 },\n\t{ 0x306, 0x2280 },\n\t{ 0x307, 0x0080 },\n\t{ 0x401, 0x0080 },\n\t{ 0x402, 0x0080 },\n\t{ 0x417, 0x3069 },\n\t{ 0x900, 0x6318 },\n\t{ 0x901, 0x6300 },\n\t{ 0x902, 0x0FC8 },\n\t{ 0x903, 0x03FE },\n\t{ 0x904, 0x00E0 },\n\t{ 0x905, 0x1EC4 },\n\t{ 0x906, 0xF136 },\n\t{ 0x907, 0x0409 },\n\t{ 0x908, 0x04CC },\n\t{ 0x909, 0x1C9B },\n\t{ 0x90A, 0xF337 },\n\t{ 0x90B, 0x040B },\n\t{ 0x90C, 0x0CBB },\n\t{ 0x90D, 0x16F8 },\n\t{ 0x90E, 0xF7D9 },\n\t{ 0x90F, 0x040A },\n\t{ 0x910, 0x1F14 },\n\t{ 0x911, 0x058C },\n\t{ 0x912, 0x0563 },\n\t{ 0x913, 0x4000 },\n\t{ 0x916, 0x6318 },\n\t{ 0x917, 0x6300 },\n\t{ 0x918, 0x0FC8 },\n\t{ 0x919, 0x03FE },\n\t{ 0x91A, 0x00E0 },\n\t{ 0x91B, 0x1EC4 },\n\t{ 0x91C, 0xF136 },\n\t{ 0x91D, 0x0409 },\n\t{ 0x91E, 0x04CC },\n\t{ 0x91F, 0x1C9B },\n\t{ 0x920, 0xF337 },\n\t{ 0x921, 0x040B },\n\t{ 0x922, 0x0CBB },\n\t{ 0x923, 0x16F8 },\n\t{ 0x924, 0xF7D9 },\n\t{ 0x925, 0x040A },\n\t{ 0x926, 0x1F14 },\n\t{ 0x927, 0x058C },\n\t{ 0x928, 0x0563 },\n\t{ 0x929, 0x4000 },\n\t{ 0x709, 0x2000 },\n\t{ 0x207, 0x200E },\n\t{ 0x208, 0x20D4 },\n\t{ 0x20A, 0x0080 },\n\t{ 0x07, 0x0000 },\n};\n\nstatic int wm2200_reset(struct wm2200_priv *wm2200)\n{\n\tif (wm2200->pdata.reset) {\n\t\tgpio_set_value_cansleep(wm2200->pdata.reset, 0);\n\t\tgpio_set_value_cansleep(wm2200->pdata.reset, 1);\n\n\t\treturn 0;\n\t} else {\n\t\treturn regmap_write(wm2200->regmap, WM2200_SOFTWARE_RESET,\n\t\t\t\t    0x2200);\n\t}\n}\n\nstatic DECLARE_TLV_DB_SCALE(in_tlv, -6300, 100, 0);\nstatic DECLARE_TLV_DB_SCALE(digital_tlv, -6400, 50, 0);\nstatic DECLARE_TLV_DB_SCALE(out_tlv, -6400, 100, 0);\n\nstatic const char * const wm2200_mixer_texts[] = {\n\t\"None\",\n\t\"Tone Generator\",\n\t\"AEC Loopback\",\n\t\"IN1L\",\n\t\"IN1R\",\n\t\"IN2L\",\n\t\"IN2R\",\n\t\"IN3L\",\n\t\"IN3R\",\n\t\"AIF1RX1\",\n\t\"AIF1RX2\",\n\t\"AIF1RX3\",\n\t\"AIF1RX4\",\n\t\"AIF1RX5\",\n\t\"AIF1RX6\",\n\t\"EQL\",\n\t\"EQR\",\n\t\"LHPF1\",\n\t\"LHPF2\",\n\t\"DSP1.1\",\n\t\"DSP1.2\",\n\t\"DSP1.3\",\n\t\"DSP1.4\",\n\t\"DSP1.5\",\n\t\"DSP1.6\",\n\t\"DSP2.1\",\n\t\"DSP2.2\",\n\t\"DSP2.3\",\n\t\"DSP2.4\",\n\t\"DSP2.5\",\n\t\"DSP2.6\",\n};\n\nstatic unsigned int wm2200_mixer_values[] = {\n\t0x00,\n\t0x04,    \n\t0x08,    \n\t0x10,    \n\t0x11,\n\t0x12,\n\t0x13,\n\t0x14,\n\t0x15,\n\t0x20,    \n\t0x21,\n\t0x22,\n\t0x23,\n\t0x24,\n\t0x25,\n\t0x50,    \n\t0x51,\n\t0x60,    \n\t0x61,    \n\t0x68,    \n\t0x69,\n\t0x6a,\n\t0x6b,\n\t0x6c,\n\t0x6d,\n\t0x70,    \n\t0x71,\n\t0x72,\n\t0x73,\n\t0x74,\n\t0x75,\n};\n\n#define WM2200_MIXER_CONTROLS(name, base) \\\n\tSOC_SINGLE_TLV(name \" Input 1 Volume\", base + 1 , \\\n\t\t       WM2200_MIXER_VOL_SHIFT, 80, 0, mixer_tlv), \\\n\tSOC_SINGLE_TLV(name \" Input 2 Volume\", base + 3 , \\\n\t\t       WM2200_MIXER_VOL_SHIFT, 80, 0, mixer_tlv), \\\n\tSOC_SINGLE_TLV(name \" Input 3 Volume\", base + 5 , \\\n\t\t       WM2200_MIXER_VOL_SHIFT, 80, 0, mixer_tlv), \\\n\tSOC_SINGLE_TLV(name \" Input 4 Volume\", base + 7 , \\\n\t\t       WM2200_MIXER_VOL_SHIFT, 80, 0, mixer_tlv)\n\n#define WM2200_MUX_ENUM_DECL(name, reg) \\\n\tSOC_VALUE_ENUM_SINGLE_DECL(name, reg, 0, 0xff, \t\t\t\\\n\t\t\t\t   wm2200_mixer_texts, wm2200_mixer_values)\n\n#define WM2200_MUX_CTL_DECL(name) \\\n\tconst struct snd_kcontrol_new name##_mux =\t\\\n\t\tSOC_DAPM_ENUM(\"Route\", name##_enum)\n\n#define WM2200_MIXER_ENUMS(name, base_reg) \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_in1_enum, base_reg);\t     \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_in2_enum, base_reg + 2);  \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_in3_enum, base_reg + 4);  \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_in4_enum, base_reg + 6);  \\\n\tstatic WM2200_MUX_CTL_DECL(name##_in1); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_in2); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_in3); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_in4)\n\n#define WM2200_DSP_ENUMS(name, base_reg) \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux1_enum, base_reg);     \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux2_enum, base_reg + 1); \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux3_enum, base_reg + 2); \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux4_enum, base_reg + 3); \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux5_enum, base_reg + 4); \\\n\tstatic WM2200_MUX_ENUM_DECL(name##_aux6_enum, base_reg + 5); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux1); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux2); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux3); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux4); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux5); \\\n\tstatic WM2200_MUX_CTL_DECL(name##_aux6);\n\nstatic const char *wm2200_rxanc_input_sel_texts[] = {\n\t\"None\", \"IN1\", \"IN2\", \"IN3\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(wm2200_rxanc_input_sel,\n\t\t\t    WM2200_RXANC_SRC,\n\t\t\t    WM2200_IN_RXANC_SEL_SHIFT,\n\t\t\t    wm2200_rxanc_input_sel_texts);\n\nstatic const struct snd_kcontrol_new wm2200_snd_controls[] = {\nSOC_SINGLE(\"IN1 High Performance Switch\", WM2200_IN1L_CONTROL,\n\t   WM2200_IN1_OSR_SHIFT, 1, 0),\nSOC_SINGLE(\"IN2 High Performance Switch\", WM2200_IN2L_CONTROL,\n\t   WM2200_IN2_OSR_SHIFT, 1, 0),\nSOC_SINGLE(\"IN3 High Performance Switch\", WM2200_IN3L_CONTROL,\n\t   WM2200_IN3_OSR_SHIFT, 1, 0),\n\nSOC_DOUBLE_R_TLV(\"IN1 Volume\", WM2200_IN1L_CONTROL, WM2200_IN1R_CONTROL,\n\t\t WM2200_IN1L_PGA_VOL_SHIFT, 0x5f, 0, in_tlv),\nSOC_DOUBLE_R_TLV(\"IN2 Volume\", WM2200_IN2L_CONTROL, WM2200_IN2R_CONTROL,\n\t\t WM2200_IN2L_PGA_VOL_SHIFT, 0x5f, 0, in_tlv),\nSOC_DOUBLE_R_TLV(\"IN3 Volume\", WM2200_IN3L_CONTROL, WM2200_IN3R_CONTROL,\n\t\t WM2200_IN3L_PGA_VOL_SHIFT, 0x5f, 0, in_tlv),\n\nSOC_DOUBLE_R(\"IN1 Digital Switch\", WM2200_ADC_DIGITAL_VOLUME_1L,\n\t     WM2200_ADC_DIGITAL_VOLUME_1R, WM2200_IN1L_MUTE_SHIFT, 1, 1),\nSOC_DOUBLE_R(\"IN2 Digital Switch\", WM2200_ADC_DIGITAL_VOLUME_2L,\n\t     WM2200_ADC_DIGITAL_VOLUME_2R, WM2200_IN2L_MUTE_SHIFT, 1, 1),\nSOC_DOUBLE_R(\"IN3 Digital Switch\", WM2200_ADC_DIGITAL_VOLUME_3L,\n\t     WM2200_ADC_DIGITAL_VOLUME_3R, WM2200_IN3L_MUTE_SHIFT, 1, 1),\n\nSOC_DOUBLE_R_TLV(\"IN1 Digital Volume\", WM2200_ADC_DIGITAL_VOLUME_1L,\n\t\t WM2200_ADC_DIGITAL_VOLUME_1R, WM2200_IN1L_DIG_VOL_SHIFT,\n\t\t 0xbf, 0, digital_tlv),\nSOC_DOUBLE_R_TLV(\"IN2 Digital Volume\", WM2200_ADC_DIGITAL_VOLUME_2L,\n\t\t WM2200_ADC_DIGITAL_VOLUME_2R, WM2200_IN2L_DIG_VOL_SHIFT,\n\t\t 0xbf, 0, digital_tlv),\nSOC_DOUBLE_R_TLV(\"IN3 Digital Volume\", WM2200_ADC_DIGITAL_VOLUME_3L,\n\t\t WM2200_ADC_DIGITAL_VOLUME_3R, WM2200_IN3L_DIG_VOL_SHIFT,\n\t\t 0xbf, 0, digital_tlv),\n\nSND_SOC_BYTES_MASK(\"EQL Coefficients\", WM2200_EQL_1, 20, WM2200_EQL_ENA),\nSND_SOC_BYTES_MASK(\"EQR Coefficients\", WM2200_EQR_1, 20, WM2200_EQR_ENA),\n\nSND_SOC_BYTES(\"LHPF1 Coefficients\", WM2200_HPLPF1_2, 1),\nSND_SOC_BYTES(\"LHPF2 Coefficients\", WM2200_HPLPF2_2, 1),\n\nSOC_SINGLE(\"OUT1 High Performance Switch\", WM2200_DAC_DIGITAL_VOLUME_1L,\n\t   WM2200_OUT1_OSR_SHIFT, 1, 0),\nSOC_SINGLE(\"OUT2 High Performance Switch\", WM2200_DAC_DIGITAL_VOLUME_2L,\n\t   WM2200_OUT2_OSR_SHIFT, 1, 0),\n\nSOC_DOUBLE_R(\"OUT1 Digital Switch\", WM2200_DAC_DIGITAL_VOLUME_1L,\n\t     WM2200_DAC_DIGITAL_VOLUME_1R, WM2200_OUT1L_MUTE_SHIFT, 1, 1),\nSOC_DOUBLE_R_TLV(\"OUT1 Digital Volume\", WM2200_DAC_DIGITAL_VOLUME_1L,\n\t\t WM2200_DAC_DIGITAL_VOLUME_1R, WM2200_OUT1L_VOL_SHIFT, 0x9f, 0,\n\t\t digital_tlv),\nSOC_DOUBLE_R_TLV(\"OUT1 Volume\", WM2200_DAC_VOLUME_LIMIT_1L,\n\t\t WM2200_DAC_VOLUME_LIMIT_1R, WM2200_OUT1L_PGA_VOL_SHIFT,\n\t\t 0x46, 0, out_tlv),\n\nSOC_DOUBLE_R(\"OUT2 Digital Switch\", WM2200_DAC_DIGITAL_VOLUME_2L,\n\t     WM2200_DAC_DIGITAL_VOLUME_2R, WM2200_OUT2L_MUTE_SHIFT, 1, 1),\nSOC_DOUBLE_R_TLV(\"OUT2 Digital Volume\", WM2200_DAC_DIGITAL_VOLUME_2L,\n\t\t WM2200_DAC_DIGITAL_VOLUME_2R, WM2200_OUT2L_VOL_SHIFT, 0x9f, 0,\n\t\t digital_tlv),\nSOC_DOUBLE(\"OUT2 Switch\", WM2200_PDM_1, WM2200_SPK1L_MUTE_SHIFT,\n\t   WM2200_SPK1R_MUTE_SHIFT, 1, 1),\nSOC_ENUM(\"RxANC Src\", wm2200_rxanc_input_sel),\n\nWM_ADSP_FW_CONTROL(\"DSP1\", 0),\nWM_ADSP_FW_CONTROL(\"DSP2\", 1),\n};\n\nWM2200_MIXER_ENUMS(OUT1L, WM2200_OUT1LMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(OUT1R, WM2200_OUT1RMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(OUT2L, WM2200_OUT2LMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(OUT2R, WM2200_OUT2RMIX_INPUT_1_SOURCE);\n\nWM2200_MIXER_ENUMS(AIF1TX1, WM2200_AIF1TX1MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(AIF1TX2, WM2200_AIF1TX2MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(AIF1TX3, WM2200_AIF1TX3MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(AIF1TX4, WM2200_AIF1TX4MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(AIF1TX5, WM2200_AIF1TX5MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(AIF1TX6, WM2200_AIF1TX6MIX_INPUT_1_SOURCE);\n\nWM2200_MIXER_ENUMS(EQL, WM2200_EQLMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(EQR, WM2200_EQRMIX_INPUT_1_SOURCE);\n\nWM2200_MIXER_ENUMS(DSP1L, WM2200_DSP1LMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(DSP1R, WM2200_DSP1RMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(DSP2L, WM2200_DSP2LMIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(DSP2R, WM2200_DSP2RMIX_INPUT_1_SOURCE);\n\nWM2200_DSP_ENUMS(DSP1, WM2200_DSP1AUX1MIX_INPUT_1_SOURCE);\nWM2200_DSP_ENUMS(DSP2, WM2200_DSP2AUX1MIX_INPUT_1_SOURCE);\n\nWM2200_MIXER_ENUMS(LHPF1, WM2200_LHPF1MIX_INPUT_1_SOURCE);\nWM2200_MIXER_ENUMS(LHPF2, WM2200_LHPF2MIX_INPUT_1_SOURCE);\n\n#define WM2200_MUX(name, ctrl) \\\n\tSND_SOC_DAPM_MUX(name, SND_SOC_NOPM, 0, 0, ctrl)\n\n#define WM2200_MIXER_WIDGETS(name, name_str)\t\\\n\tWM2200_MUX(name_str \" Input 1\", &name##_in1_mux), \\\n\tWM2200_MUX(name_str \" Input 2\", &name##_in2_mux), \\\n\tWM2200_MUX(name_str \" Input 3\", &name##_in3_mux), \\\n\tWM2200_MUX(name_str \" Input 4\", &name##_in4_mux), \\\n\tSND_SOC_DAPM_MIXER(name_str \" Mixer\", SND_SOC_NOPM, 0, 0, NULL, 0)\n\n#define WM2200_DSP_WIDGETS(name, name_str) \\\n\tWM2200_MIXER_WIDGETS(name##L, name_str \"L\"), \\\n\tWM2200_MIXER_WIDGETS(name##R, name_str \"R\"), \\\n\tWM2200_MUX(name_str \" Aux 1\", &name##_aux1_mux), \\\n\tWM2200_MUX(name_str \" Aux 2\", &name##_aux2_mux), \\\n\tWM2200_MUX(name_str \" Aux 3\", &name##_aux3_mux), \\\n\tWM2200_MUX(name_str \" Aux 4\", &name##_aux4_mux), \\\n\tWM2200_MUX(name_str \" Aux 5\", &name##_aux5_mux), \\\n\tWM2200_MUX(name_str \" Aux 6\", &name##_aux6_mux)\n\n#define WM2200_MIXER_INPUT_ROUTES(name)\t\\\n\t{ name, \"Tone Generator\", \"Tone Generator\" }, \\\n\t{ name, \"AEC Loopback\", \"AEC Loopback\" }, \\\n        { name, \"IN1L\", \"IN1L PGA\" }, \\\n        { name, \"IN1R\", \"IN1R PGA\" }, \\\n        { name, \"IN2L\", \"IN2L PGA\" }, \\\n        { name, \"IN2R\", \"IN2R PGA\" }, \\\n        { name, \"IN3L\", \"IN3L PGA\" }, \\\n        { name, \"IN3R\", \"IN3R PGA\" }, \\\n        { name, \"DSP1.1\", \"DSP1\" }, \\\n        { name, \"DSP1.2\", \"DSP1\" }, \\\n        { name, \"DSP1.3\", \"DSP1\" }, \\\n        { name, \"DSP1.4\", \"DSP1\" }, \\\n        { name, \"DSP1.5\", \"DSP1\" }, \\\n        { name, \"DSP1.6\", \"DSP1\" }, \\\n        { name, \"DSP2.1\", \"DSP2\" }, \\\n        { name, \"DSP2.2\", \"DSP2\" }, \\\n        { name, \"DSP2.3\", \"DSP2\" }, \\\n        { name, \"DSP2.4\", \"DSP2\" }, \\\n        { name, \"DSP2.5\", \"DSP2\" }, \\\n        { name, \"DSP2.6\", \"DSP2\" }, \\\n        { name, \"AIF1RX1\", \"AIF1RX1\" }, \\\n        { name, \"AIF1RX2\", \"AIF1RX2\" }, \\\n        { name, \"AIF1RX3\", \"AIF1RX3\" }, \\\n        { name, \"AIF1RX4\", \"AIF1RX4\" }, \\\n        { name, \"AIF1RX5\", \"AIF1RX5\" }, \\\n        { name, \"AIF1RX6\", \"AIF1RX6\" }, \\\n        { name, \"EQL\", \"EQL\" }, \\\n        { name, \"EQR\", \"EQR\" }, \\\n        { name, \"LHPF1\", \"LHPF1\" }, \\\n        { name, \"LHPF2\", \"LHPF2\" }\n\n#define WM2200_MIXER_ROUTES(widget, name) \\\n\t{ widget, NULL, name \" Mixer\" },         \\\n\t{ name \" Mixer\", NULL, name \" Input 1\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 2\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 3\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 4\" }, \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Input 1\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Input 2\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Input 3\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Input 4\")\n\n#define WM2200_DSP_AUX_ROUTES(name) \\\n\t{ name, NULL, name \" Aux 1\" }, \\\n\t{ name, NULL, name \" Aux 2\" }, \\\n\t{ name, NULL, name \" Aux 3\" }, \\\n\t{ name, NULL, name \" Aux 4\" }, \\\n\t{ name, NULL, name \" Aux 5\" }, \\\n\t{ name, NULL, name \" Aux 6\" }, \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 1\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 2\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 3\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 4\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 5\"), \\\n\tWM2200_MIXER_INPUT_ROUTES(name \" Aux 6\")\n\nstatic const char *wm2200_aec_loopback_texts[] = {\n\t\"OUT1L\", \"OUT1R\", \"OUT2L\", \"OUT2R\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(wm2200_aec_loopback,\n\t\t\t    WM2200_DAC_AEC_CONTROL_1,\n\t\t\t    WM2200_AEC_LOOPBACK_SRC_SHIFT,\n\t\t\t    wm2200_aec_loopback_texts);\n\nstatic const struct snd_kcontrol_new wm2200_aec_loopback_mux =\n\tSOC_DAPM_ENUM(\"AEC Loopback\", wm2200_aec_loopback);\n\nstatic const struct snd_soc_dapm_widget wm2200_dapm_widgets[] = {\nSND_SOC_DAPM_SUPPLY(\"SYSCLK\", WM2200_CLOCKING_3, WM2200_SYSCLK_ENA_SHIFT, 0,\n\t\t    NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"CP1\", WM2200_DM_CHARGE_PUMP_1, WM2200_CPDM_ENA_SHIFT, 0,\n\t\t    NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"CP2\", WM2200_MIC_CHARGE_PUMP_1, WM2200_CPMIC_ENA_SHIFT, 0,\n\t\t    NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"MICBIAS1\", WM2200_MIC_BIAS_CTRL_1, WM2200_MICB1_ENA_SHIFT,\n\t\t    0, NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"MICBIAS2\", WM2200_MIC_BIAS_CTRL_2, WM2200_MICB2_ENA_SHIFT,\n\t\t    0, NULL, 0),\nSND_SOC_DAPM_REGULATOR_SUPPLY(\"CPVDD\", 20, 0),\nSND_SOC_DAPM_REGULATOR_SUPPLY(\"AVDD\", 20, 0),\n\nSND_SOC_DAPM_INPUT(\"IN1L\"),\nSND_SOC_DAPM_INPUT(\"IN1R\"),\nSND_SOC_DAPM_INPUT(\"IN2L\"),\nSND_SOC_DAPM_INPUT(\"IN2R\"),\nSND_SOC_DAPM_INPUT(\"IN3L\"),\nSND_SOC_DAPM_INPUT(\"IN3R\"),\n\nSND_SOC_DAPM_SIGGEN(\"TONE\"),\nSND_SOC_DAPM_PGA(\"Tone Generator\", WM2200_TONE_GENERATOR_1,\n\t\t WM2200_TONE_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"IN1L PGA\", WM2200_INPUT_ENABLES, WM2200_IN1L_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"IN1R PGA\", WM2200_INPUT_ENABLES, WM2200_IN1R_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"IN2L PGA\", WM2200_INPUT_ENABLES, WM2200_IN2L_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"IN2R PGA\", WM2200_INPUT_ENABLES, WM2200_IN2R_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"IN3L PGA\", WM2200_INPUT_ENABLES, WM2200_IN3L_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"IN3R PGA\", WM2200_INPUT_ENABLES, WM2200_IN3R_ENA_SHIFT, 0,\n\t\t NULL, 0),\n\nSND_SOC_DAPM_AIF_IN(\"AIF1RX1\", \"Playback\", 0,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX2\", \"Playback\", 1,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX3\", \"Playback\", 2,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX4\", \"Playback\", 3,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX4_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX5\", \"Playback\", 4,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX5_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX6\", \"Playback\", 5,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1RX6_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_PGA(\"EQL\", WM2200_EQL_1, WM2200_EQL_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"EQR\", WM2200_EQR_1, WM2200_EQR_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"LHPF1\", WM2200_HPLPF1_1, WM2200_LHPF1_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"LHPF2\", WM2200_HPLPF2_1, WM2200_LHPF2_ENA_SHIFT, 0,\n\t\t NULL, 0),\n\nWM_ADSP1(\"DSP1\", 0),\nWM_ADSP1(\"DSP2\", 1),\n\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX1\", \"Capture\", 0,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX2\", \"Capture\", 1,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX3\", \"Capture\", 2,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX4\", \"Capture\", 3,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX4_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX5\", \"Capture\", 4,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX5_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX6\", \"Capture\", 5,\n\t\t    WM2200_AUDIO_IF_1_22, WM2200_AIF1TX6_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_MUX(\"AEC Loopback\", WM2200_DAC_AEC_CONTROL_1,\n\t\t WM2200_AEC_LOOPBACK_ENA_SHIFT, 0, &wm2200_aec_loopback_mux),\n\nSND_SOC_DAPM_PGA_S(\"OUT1L\", 0, WM2200_OUTPUT_ENABLES,\n\t\t   WM2200_OUT1L_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"OUT1R\", 0, WM2200_OUTPUT_ENABLES,\n\t\t   WM2200_OUT1R_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA_S(\"EPD_LP\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_LP_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_OUTP_LP\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_OUTP_LP_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_RMV_SHRT_LP\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_RMV_SHRT_LP_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA_S(\"EPD_LN\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_LN_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_OUTP_LN\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_OUTP_LN_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_RMV_SHRT_LN\", 1, WM2200_EAR_PIECE_CTRL_1,\n\t\t   WM2200_EPD_RMV_SHRT_LN_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA_S(\"EPD_RP\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_RP_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_OUTP_RP\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_OUTP_RP_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_RMV_SHRT_RP\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_RMV_SHRT_RP_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA_S(\"EPD_RN\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_RN_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_OUTP_RN\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_OUTP_RN_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA_S(\"EPD_RMV_SHRT_RN\", 1, WM2200_EAR_PIECE_CTRL_2,\n\t\t   WM2200_EPD_RMV_SHRT_RN_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"OUT2L\", WM2200_OUTPUT_ENABLES, WM2200_OUT2L_ENA_SHIFT,\n\t\t 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"OUT2R\", WM2200_OUTPUT_ENABLES, WM2200_OUT2R_ENA_SHIFT,\n\t\t 0, NULL, 0),\n\nSND_SOC_DAPM_OUTPUT(\"EPOUTLN\"),\nSND_SOC_DAPM_OUTPUT(\"EPOUTLP\"),\nSND_SOC_DAPM_OUTPUT(\"EPOUTRN\"),\nSND_SOC_DAPM_OUTPUT(\"EPOUTRP\"),\nSND_SOC_DAPM_OUTPUT(\"SPK\"),\n\nWM2200_MIXER_WIDGETS(EQL, \"EQL\"),\nWM2200_MIXER_WIDGETS(EQR, \"EQR\"),\n\nWM2200_MIXER_WIDGETS(LHPF1, \"LHPF1\"),\nWM2200_MIXER_WIDGETS(LHPF2, \"LHPF2\"),\n\nWM2200_DSP_WIDGETS(DSP1, \"DSP1\"),\nWM2200_DSP_WIDGETS(DSP2, \"DSP2\"),\n\nWM2200_MIXER_WIDGETS(AIF1TX1, \"AIF1TX1\"),\nWM2200_MIXER_WIDGETS(AIF1TX2, \"AIF1TX2\"),\nWM2200_MIXER_WIDGETS(AIF1TX3, \"AIF1TX3\"),\nWM2200_MIXER_WIDGETS(AIF1TX4, \"AIF1TX4\"),\nWM2200_MIXER_WIDGETS(AIF1TX5, \"AIF1TX5\"),\nWM2200_MIXER_WIDGETS(AIF1TX6, \"AIF1TX6\"),\n\nWM2200_MIXER_WIDGETS(OUT1L, \"OUT1L\"),\nWM2200_MIXER_WIDGETS(OUT1R, \"OUT1R\"),\nWM2200_MIXER_WIDGETS(OUT2L, \"OUT2L\"),\nWM2200_MIXER_WIDGETS(OUT2R, \"OUT2R\"),\n};\n\nstatic const struct snd_soc_dapm_route wm2200_dapm_routes[] = {\n\t \n\t{ \"IN1L\", NULL, \"SYSCLK\" },\n\t{ \"IN1R\", NULL, \"SYSCLK\" },\n\t{ \"IN2L\", NULL, \"SYSCLK\" },\n\t{ \"IN2R\", NULL, \"SYSCLK\" },\n\t{ \"IN3L\", NULL, \"SYSCLK\" },\n\t{ \"IN3R\", NULL, \"SYSCLK\" },\n\t{ \"OUT1L\", NULL, \"SYSCLK\" },\n\t{ \"OUT1R\", NULL, \"SYSCLK\" },\n\t{ \"OUT2L\", NULL, \"SYSCLK\" },\n\t{ \"OUT2R\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX1\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX2\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX3\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX4\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX5\", NULL, \"SYSCLK\" },\n\t{ \"AIF1RX6\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX1\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX2\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX3\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX4\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX5\", NULL, \"SYSCLK\" },\n\t{ \"AIF1TX6\", NULL, \"SYSCLK\" },\n\n\t{ \"IN1L\", NULL, \"AVDD\" },\n\t{ \"IN1R\", NULL, \"AVDD\" },\n\t{ \"IN2L\", NULL, \"AVDD\" },\n\t{ \"IN2R\", NULL, \"AVDD\" },\n\t{ \"IN3L\", NULL, \"AVDD\" },\n\t{ \"IN3R\", NULL, \"AVDD\" },\n\t{ \"OUT1L\", NULL, \"AVDD\" },\n\t{ \"OUT1R\", NULL, \"AVDD\" },\n\n\t{ \"IN1L PGA\", NULL, \"IN1L\" },\n\t{ \"IN1R PGA\", NULL, \"IN1R\" },\n\t{ \"IN2L PGA\", NULL, \"IN2L\" },\n\t{ \"IN2R PGA\", NULL, \"IN2R\" },\n\t{ \"IN3L PGA\", NULL, \"IN3L\" },\n\t{ \"IN3R PGA\", NULL, \"IN3R\" },\n\n\t{ \"Tone Generator\", NULL, \"TONE\" },\n\n\t{ \"CP2\", NULL, \"CPVDD\" },\n\t{ \"MICBIAS1\", NULL, \"CP2\" },\n\t{ \"MICBIAS2\", NULL, \"CP2\" },\n\n\t{ \"CP1\", NULL, \"CPVDD\" },\n\t{ \"EPD_LN\", NULL, \"CP1\" },\n\t{ \"EPD_LP\", NULL, \"CP1\" },\n\t{ \"EPD_RN\", NULL, \"CP1\" },\n\t{ \"EPD_RP\", NULL, \"CP1\" },\n\n\t{ \"EPD_LP\", NULL, \"OUT1L\" },\n\t{ \"EPD_OUTP_LP\", NULL, \"EPD_LP\" },\n\t{ \"EPD_RMV_SHRT_LP\", NULL, \"EPD_OUTP_LP\" },\n\t{ \"EPOUTLP\", NULL, \"EPD_RMV_SHRT_LP\" },\n\n\t{ \"EPD_LN\", NULL, \"OUT1L\" },\n\t{ \"EPD_OUTP_LN\", NULL, \"EPD_LN\" },\n\t{ \"EPD_RMV_SHRT_LN\", NULL, \"EPD_OUTP_LN\" },\n\t{ \"EPOUTLN\", NULL, \"EPD_RMV_SHRT_LN\" },\n\n\t{ \"EPD_RP\", NULL, \"OUT1R\" },\n\t{ \"EPD_OUTP_RP\", NULL, \"EPD_RP\" },\n\t{ \"EPD_RMV_SHRT_RP\", NULL, \"EPD_OUTP_RP\" },\n\t{ \"EPOUTRP\", NULL, \"EPD_RMV_SHRT_RP\" },\n\n\t{ \"EPD_RN\", NULL, \"OUT1R\" },\n\t{ \"EPD_OUTP_RN\", NULL, \"EPD_RN\" },\n\t{ \"EPD_RMV_SHRT_RN\", NULL, \"EPD_OUTP_RN\" },\n\t{ \"EPOUTRN\", NULL, \"EPD_RMV_SHRT_RN\" },\n\n\t{ \"SPK\", NULL, \"OUT2L\" },\n\t{ \"SPK\", NULL, \"OUT2R\" },\n\n\t{ \"AEC Loopback\", \"OUT1L\", \"OUT1L\" },\n\t{ \"AEC Loopback\", \"OUT1R\", \"OUT1R\" },\n\t{ \"AEC Loopback\", \"OUT2L\", \"OUT2L\" },\n\t{ \"AEC Loopback\", \"OUT2R\", \"OUT2R\" },\n\n\tWM2200_MIXER_ROUTES(\"DSP1\", \"DSP1L\"),\n\tWM2200_MIXER_ROUTES(\"DSP1\", \"DSP1R\"),\n\tWM2200_MIXER_ROUTES(\"DSP2\", \"DSP2L\"),\n\tWM2200_MIXER_ROUTES(\"DSP2\", \"DSP2R\"),\n\n\tWM2200_DSP_AUX_ROUTES(\"DSP1\"),\n\tWM2200_DSP_AUX_ROUTES(\"DSP2\"),\n\n\tWM2200_MIXER_ROUTES(\"OUT1L\", \"OUT1L\"),\n\tWM2200_MIXER_ROUTES(\"OUT1R\", \"OUT1R\"),\n\tWM2200_MIXER_ROUTES(\"OUT2L\", \"OUT2L\"),\n\tWM2200_MIXER_ROUTES(\"OUT2R\", \"OUT2R\"),\n\n\tWM2200_MIXER_ROUTES(\"AIF1TX1\", \"AIF1TX1\"),\n\tWM2200_MIXER_ROUTES(\"AIF1TX2\", \"AIF1TX2\"),\n\tWM2200_MIXER_ROUTES(\"AIF1TX3\", \"AIF1TX3\"),\n\tWM2200_MIXER_ROUTES(\"AIF1TX4\", \"AIF1TX4\"),\n\tWM2200_MIXER_ROUTES(\"AIF1TX5\", \"AIF1TX5\"),\n\tWM2200_MIXER_ROUTES(\"AIF1TX6\", \"AIF1TX6\"),\n\n\tWM2200_MIXER_ROUTES(\"EQL\", \"EQL\"),\n\tWM2200_MIXER_ROUTES(\"EQR\", \"EQR\"),\n\n\tWM2200_MIXER_ROUTES(\"LHPF1\", \"LHPF1\"),\n\tWM2200_MIXER_ROUTES(\"LHPF2\", \"LHPF2\"),\n};\n\nstatic int wm2200_probe(struct snd_soc_component *component)\n{\n\tstruct wm2200_priv *wm2200 = snd_soc_component_get_drvdata(component);\n\n\twm2200->component = component;\n\n\treturn 0;\n}\n\nstatic int wm2200_set_fmt(struct snd_soc_dai *dai, unsigned int fmt)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tint lrclk, bclk, fmt_val;\n\n\tlrclk = 0;\n\tbclk = 0;\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_DSP_A:\n\t\tfmt_val = 0;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_I2S:\n\t\tfmt_val = 2;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Unsupported DAI format %d\\n\",\n\t\t\tfmt & SND_SOC_DAIFMT_FORMAT_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_MASTER_MASK) {\n\tcase SND_SOC_DAIFMT_CBS_CFS:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBS_CFM:\n\t\tlrclk |= WM2200_AIF1TX_LRCLK_MSTR;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBM_CFS:\n\t\tbclk |= WM2200_AIF1_BCLK_MSTR;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBM_CFM:\n\t\tlrclk |= WM2200_AIF1TX_LRCLK_MSTR;\n\t\tbclk |= WM2200_AIF1_BCLK_MSTR;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Unsupported master mode %d\\n\",\n\t\t\tfmt & SND_SOC_DAIFMT_MASTER_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_INV_MASK) {\n\tcase SND_SOC_DAIFMT_NB_NF:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_IF:\n\t\tbclk |= WM2200_AIF1_BCLK_INV;\n\t\tlrclk |= WM2200_AIF1TX_LRCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_NF:\n\t\tbclk |= WM2200_AIF1_BCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_NB_IF:\n\t\tlrclk |= WM2200_AIF1TX_LRCLK_INV;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_1, WM2200_AIF1_BCLK_MSTR |\n\t\t\t    WM2200_AIF1_BCLK_INV, bclk);\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_2,\n\t\t\t    WM2200_AIF1TX_LRCLK_MSTR | WM2200_AIF1TX_LRCLK_INV,\n\t\t\t    lrclk);\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_3,\n\t\t\t    WM2200_AIF1TX_LRCLK_MSTR | WM2200_AIF1TX_LRCLK_INV,\n\t\t\t    lrclk);\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_5,\n\t\t\t    WM2200_AIF1_FMT_MASK, fmt_val);\n\n\treturn 0;\n}\n\nstatic int wm2200_sr_code[] = {\n\t0,\n\t12000,\n\t24000,\n\t48000,\n\t96000,\n\t192000,\n\t384000,\n\t768000,\n\t0,\n\t11025,\n\t22050,\n\t44100,\n\t88200,\n\t176400,\n\t352800,\n\t705600,\n\t4000,\n\t8000,\n\t16000,\n\t32000,\n\t64000,\n\t128000,\n\t256000,\n\t512000,\n};\n\n#define WM2200_NUM_BCLK_RATES 12\n\nstatic int wm2200_bclk_rates_dat[WM2200_NUM_BCLK_RATES] = {\n\t6144000,\n\t3072000,\n\t2048000,\n\t1536000,\n\t768000,\n\t512000,\n\t384000,\n\t256000,\n\t192000,\n\t128000,\n\t96000,\n\t64000,\n};\t\n\nstatic int wm2200_bclk_rates_cd[WM2200_NUM_BCLK_RATES] = {\n\t5644800,\n\t3763200,\n\t2882400,\n\t1881600,\n\t1411200,\n\t705600,\n\t470400,\n\t352800,\n\t176400,\n\t117600,\n\t88200,\n\t58800,\n};\n\nstatic int wm2200_hw_params(struct snd_pcm_substream *substream,\n\t\t\t    struct snd_pcm_hw_params *params,\n\t\t\t    struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct wm2200_priv *wm2200 = snd_soc_component_get_drvdata(component);\n\tint i, bclk, lrclk, wl, fl, sr_code;\n\tint *bclk_rates;\n\n\t \n\twl = params_width(params);\n\tif (wl < 0)\n\t\treturn wl;\n\tfl = snd_soc_params_to_frame_size(params);\n\tif (fl < 0)\n\t\treturn fl;\n\n\tdev_dbg(component->dev, \"Word length %d bits, frame length %d bits\\n\",\n\t\twl, fl);\n\n\t \n\tbclk = snd_soc_params_to_bclk(params);\n\tif (bclk < 0)\n\t\treturn bclk;\n\n\tif (!wm2200->sysclk) {\n\t\tdev_err(component->dev, \"SYSCLK has no rate set\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200_sr_code); i++)\n\t\tif (wm2200_sr_code[i] == params_rate(params))\n\t\t\tbreak;\n\tif (i == ARRAY_SIZE(wm2200_sr_code)) {\n\t\tdev_err(component->dev, \"Unsupported sample rate: %dHz\\n\",\n\t\t\tparams_rate(params));\n\t\treturn -EINVAL;\n\t}\n\tsr_code = i;\n\n\tdev_dbg(component->dev, \"Target BCLK is %dHz, using %dHz SYSCLK\\n\",\n\t\tbclk, wm2200->sysclk);\n\n\tif (wm2200->sysclk % 4000)\n\t\tbclk_rates = wm2200_bclk_rates_cd;\n\telse\n\t\tbclk_rates = wm2200_bclk_rates_dat;\n\n\tfor (i = 0; i < WM2200_NUM_BCLK_RATES; i++)\n\t\tif (bclk_rates[i] >= bclk && (bclk_rates[i] % bclk == 0))\n\t\t\tbreak;\n\tif (i == WM2200_NUM_BCLK_RATES) {\n\t\tdev_err(component->dev,\n\t\t\t\"No valid BCLK for %dHz found from %dHz SYSCLK\\n\",\n\t\t\tbclk, wm2200->sysclk);\n\t\treturn -EINVAL;\n\t}\n\n\tbclk = i;\n\tdev_dbg(component->dev, \"Setting %dHz BCLK\\n\", bclk_rates[bclk]);\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_1,\n\t\t\t    WM2200_AIF1_BCLK_DIV_MASK, bclk);\n\n\tlrclk = bclk_rates[bclk] / params_rate(params);\n\tdev_dbg(component->dev, \"Setting %dHz LRCLK\\n\", bclk_rates[bclk] / lrclk);\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK ||\n\t    wm2200->symmetric_rates)\n\t\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_7,\n\t\t\t\t    WM2200_AIF1RX_BCPF_MASK, lrclk);\n\telse\n\t\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_6,\n\t\t\t\t    WM2200_AIF1TX_BCPF_MASK, lrclk);\n\n\ti = (wl << WM2200_AIF1TX_WL_SHIFT) | wl;\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\n\t\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_9,\n\t\t\t\t    WM2200_AIF1RX_WL_MASK |\n\t\t\t\t    WM2200_AIF1RX_SLOT_LEN_MASK, i);\n\telse\n\t\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_8,\n\t\t\t\t    WM2200_AIF1TX_WL_MASK |\n\t\t\t\t    WM2200_AIF1TX_SLOT_LEN_MASK, i);\n\n\tsnd_soc_component_update_bits(component, WM2200_CLOCKING_4,\n\t\t\t    WM2200_SAMPLE_RATE_1_MASK, sr_code);\n\n\treturn 0;\n}\n\nstatic int wm2200_set_sysclk(struct snd_soc_component *component, int clk_id,\n\t\t\t     int source, unsigned int freq, int dir)\n{\n\tstruct wm2200_priv *wm2200 = snd_soc_component_get_drvdata(component);\n\tint fval;\n\n\tswitch (clk_id) {\n\tcase WM2200_CLK_SYSCLK:\n\t\tbreak;\n\n\tdefault:\n\t\tdev_err(component->dev, \"Unknown clock %d\\n\", clk_id);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (source) {\n\tcase WM2200_CLKSRC_MCLK1:\n\tcase WM2200_CLKSRC_MCLK2:\n\tcase WM2200_CLKSRC_FLL:\n\tcase WM2200_CLKSRC_BCLK1:\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid source %d\\n\", source);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (freq) {\n\tcase 22579200:\n\tcase 24576000:\n\t\tfval = 2;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid clock rate: %d\\n\", freq);\n\t\treturn -EINVAL;\n\t}\n\n\t \n\n\tsnd_soc_component_update_bits(component, WM2200_CLOCKING_3, WM2200_SYSCLK_FREQ_MASK |\n\t\t\t    WM2200_SYSCLK_SRC_MASK,\n\t\t\t    fval << WM2200_SYSCLK_FREQ_SHIFT | source);\n\n\twm2200->sysclk = freq;\n\n\treturn 0;\n}\n\nstruct _fll_div {\n\tu16 fll_fratio;\n\tu16 fll_outdiv;\n\tu16 fll_refclk_div;\n\tu16 n;\n\tu16 theta;\n\tu16 lambda;\n};\n\nstatic struct {\n\tunsigned int min;\n\tunsigned int max;\n\tu16 fll_fratio;\n\tint ratio;\n} fll_fratios[] = {\n\t{       0,    64000, 4, 16 },\n\t{   64000,   128000, 3,  8 },\n\t{  128000,   256000, 2,  4 },\n\t{  256000,  1000000, 1,  2 },\n\t{ 1000000, 13500000, 0,  1 },\n};\n\nstatic int fll_factors(struct _fll_div *fll_div, unsigned int Fref,\n\t\t       unsigned int Fout)\n{\n\tunsigned int target;\n\tunsigned int div;\n\tunsigned int fratio, gcd_fll;\n\tint i;\n\n\t \n\tdiv = 1;\n\tfll_div->fll_refclk_div = 0;\n\twhile ((Fref / div) > 13500000) {\n\t\tdiv *= 2;\n\t\tfll_div->fll_refclk_div++;\n\n\t\tif (div > 8) {\n\t\t\tpr_err(\"Can't scale %dMHz input down to <=13.5MHz\\n\",\n\t\t\t       Fref);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\tpr_debug(\"FLL Fref=%u Fout=%u\\n\", Fref, Fout);\n\n\t \n\tFref /= div;\n\n\t \n\tdiv = 2;\n\twhile (Fout * div < 90000000) {\n\t\tdiv++;\n\t\tif (div > 64) {\n\t\t\tpr_err(\"Unable to find FLL_OUTDIV for Fout=%uHz\\n\",\n\t\t\t       Fout);\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\ttarget = Fout * div;\n\tfll_div->fll_outdiv = div - 1;\n\n\tpr_debug(\"FLL Fvco=%dHz\\n\", target);\n\n\t \n\tfor (i = 0; i < ARRAY_SIZE(fll_fratios); i++) {\n\t\tif (fll_fratios[i].min <= Fref && Fref <= fll_fratios[i].max) {\n\t\t\tfll_div->fll_fratio = fll_fratios[i].fll_fratio;\n\t\t\tfratio = fll_fratios[i].ratio;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (i == ARRAY_SIZE(fll_fratios)) {\n\t\tpr_err(\"Unable to find FLL_FRATIO for Fref=%uHz\\n\", Fref);\n\t\treturn -EINVAL;\n\t}\n\n\tfll_div->n = target / (fratio * Fref);\n\n\tif (target % Fref == 0) {\n\t\tfll_div->theta = 0;\n\t\tfll_div->lambda = 0;\n\t} else {\n\t\tgcd_fll = gcd(target, fratio * Fref);\n\n\t\tfll_div->theta = (target - (fll_div->n * fratio * Fref))\n\t\t\t/ gcd_fll;\n\t\tfll_div->lambda = (fratio * Fref) / gcd_fll;\n\t}\n\n\tpr_debug(\"FLL N=%x THETA=%x LAMBDA=%x\\n\",\n\t\t fll_div->n, fll_div->theta, fll_div->lambda);\n\tpr_debug(\"FLL_FRATIO=%x(%d) FLL_OUTDIV=%x FLL_REFCLK_DIV=%x\\n\",\n\t\t fll_div->fll_fratio, fratio, fll_div->fll_outdiv,\n\t\t fll_div->fll_refclk_div);\n\n\treturn 0;\n}\n\nstatic int wm2200_set_fll(struct snd_soc_component *component, int fll_id, int source,\n\t\t\t  unsigned int Fref, unsigned int Fout)\n{\n\tstruct i2c_client *i2c = to_i2c_client(component->dev);\n\tstruct wm2200_priv *wm2200 = snd_soc_component_get_drvdata(component);\n\tstruct _fll_div factors;\n\tint ret, i, timeout;\n\tunsigned long time_left;\n\n\tif (!Fout) {\n\t\tdev_dbg(component->dev, \"FLL disabled\");\n\n\t\tif (wm2200->fll_fout)\n\t\t\tpm_runtime_put(component->dev);\n\n\t\twm2200->fll_fout = 0;\n\t\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_1,\n\t\t\t\t    WM2200_FLL_ENA, 0);\n\t\treturn 0;\n\t}\n\n\tswitch (source) {\n\tcase WM2200_FLL_SRC_MCLK1:\n\tcase WM2200_FLL_SRC_MCLK2:\n\tcase WM2200_FLL_SRC_BCLK:\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid FLL source %d\\n\", source);\n\t\treturn -EINVAL;\n\t}\n\n\tret = fll_factors(&factors, Fref, Fout);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_1, WM2200_FLL_ENA, 0);\n\n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_2,\n\t\t\t    WM2200_FLL_OUTDIV_MASK | WM2200_FLL_FRATIO_MASK,\n\t\t\t    (factors.fll_outdiv << WM2200_FLL_OUTDIV_SHIFT) |\n\t\t\t    factors.fll_fratio);\n\tif (factors.theta) {\n\t\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_3,\n\t\t\t\t    WM2200_FLL_FRACN_ENA,\n\t\t\t\t    WM2200_FLL_FRACN_ENA);\n\t\tsnd_soc_component_update_bits(component, WM2200_FLL_EFS_2,\n\t\t\t\t    WM2200_FLL_EFS_ENA,\n\t\t\t\t    WM2200_FLL_EFS_ENA);\n\t} else {\n\t\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_3,\n\t\t\t\t    WM2200_FLL_FRACN_ENA, 0);\n\t\tsnd_soc_component_update_bits(component, WM2200_FLL_EFS_2,\n\t\t\t\t    WM2200_FLL_EFS_ENA, 0);\n\t}\n\n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_4, WM2200_FLL_THETA_MASK,\n\t\t\t    factors.theta);\n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_6, WM2200_FLL_N_MASK,\n\t\t\t    factors.n);\n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_7,\n\t\t\t    WM2200_FLL_CLK_REF_DIV_MASK |\n\t\t\t    WM2200_FLL_CLK_REF_SRC_MASK,\n\t\t\t    (factors.fll_refclk_div\n\t\t\t     << WM2200_FLL_CLK_REF_DIV_SHIFT) | source);\n\tsnd_soc_component_update_bits(component, WM2200_FLL_EFS_1,\n\t\t\t    WM2200_FLL_LAMBDA_MASK, factors.lambda);\n\n\t \n\ttry_wait_for_completion(&wm2200->fll_lock);\n\n\tpm_runtime_get_sync(component->dev);\n\n\tsnd_soc_component_update_bits(component, WM2200_FLL_CONTROL_1,\n\t\t\t    WM2200_FLL_ENA, WM2200_FLL_ENA);\n\n\tif (i2c->irq)\n\t\ttimeout = 2;\n\telse\n\t\ttimeout = 50;\n\n\tsnd_soc_component_update_bits(component, WM2200_CLOCKING_3, WM2200_SYSCLK_ENA,\n\t\t\t    WM2200_SYSCLK_ENA);\n\n\t \n\tfor (i = 0; i < timeout; i++) {\n\t\tif (i2c->irq) {\n\t\t\ttime_left = wait_for_completion_timeout(\n\t\t\t\t\t\t\t&wm2200->fll_lock,\n\t\t\t\t\t\t\tmsecs_to_jiffies(25));\n\t\t\tif (time_left > 0)\n\t\t\t\tbreak;\n\t\t} else {\n\t\t\tmsleep(1);\n\t\t}\n\n\t\tret = snd_soc_component_read(component,\n\t\t\t\t   WM2200_INTERRUPT_RAW_STATUS_2);\n\t\tif (ret < 0) {\n\t\t\tdev_err(component->dev,\n\t\t\t\t\"Failed to read FLL status: %d\\n\",\n\t\t\t\tret);\n\t\t\tcontinue;\n\t\t}\n\t\tif (ret & WM2200_FLL_LOCK_STS)\n\t\t\tbreak;\n\t}\n\tif (i == timeout) {\n\t\tdev_err(component->dev, \"FLL lock timed out\\n\");\n\t\tpm_runtime_put(component->dev);\n\t\treturn -ETIMEDOUT;\n\t}\n\n\twm2200->fll_src = source;\n\twm2200->fll_fref = Fref;\n\twm2200->fll_fout = Fout;\n\n\tdev_dbg(component->dev, \"FLL running %dHz->%dHz\\n\", Fref, Fout);\n\n\treturn 0;\n}\n\nstatic int wm2200_dai_probe(struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct wm2200_priv *wm2200 = snd_soc_component_get_drvdata(component);\n\tunsigned int val = 0;\n\tint ret;\n\n\tret = snd_soc_component_read(component, WM2200_GPIO_CTRL_1);\n\tif (ret >= 0) {\n\t\tif ((ret & WM2200_GP1_FN_MASK) != 0) {\n\t\t\twm2200->symmetric_rates = true;\n\t\t\tval = WM2200_AIF1TX_LRCLK_SRC;\n\t\t}\n\t} else {\n\t\tdev_err(component->dev, \"Failed to read GPIO 1 config: %d\\n\", ret);\n\t}\n\n\tsnd_soc_component_update_bits(component, WM2200_AUDIO_IF_1_2,\n\t\t\t    WM2200_AIF1TX_LRCLK_SRC, val);\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops wm2200_dai_ops = {\n\t.probe = wm2200_dai_probe,\n\t.set_fmt = wm2200_set_fmt,\n\t.hw_params = wm2200_hw_params,\n};\n\n#define WM2200_RATES SNDRV_PCM_RATE_8000_48000\n\n#define WM2200_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S20_3LE |\\\n\t\t\tSNDRV_PCM_FMTBIT_S24_LE | SNDRV_PCM_FMTBIT_S32_LE)\n\nstatic struct snd_soc_dai_driver wm2200_dai = {\n\t.name = \"wm2200\",\n\t.playback = {\n\t\t.stream_name = \"Playback\",\n\t\t.channels_min = 2,\n\t\t.channels_max = 2,\n\t\t.rates = WM2200_RATES,\n\t\t.formats = WM2200_FORMATS,\n\t},\n\t.capture = {\n\t\t .stream_name = \"Capture\",\n\t\t .channels_min = 2,\n\t\t .channels_max = 2,\n\t\t .rates = WM2200_RATES,\n\t\t .formats = WM2200_FORMATS,\n\t },\n\t.ops = &wm2200_dai_ops,\n};\n\nstatic const struct snd_soc_component_driver soc_component_wm2200 = {\n\t.probe\t\t\t= wm2200_probe,\n\t.set_sysclk\t\t= wm2200_set_sysclk,\n\t.set_pll\t\t= wm2200_set_fll,\n\t.controls\t\t= wm2200_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(wm2200_snd_controls),\n\t.dapm_widgets\t\t= wm2200_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(wm2200_dapm_widgets),\n\t.dapm_routes\t\t= wm2200_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(wm2200_dapm_routes),\n\t.endianness\t\t= 1,\n};\n\nstatic irqreturn_t wm2200_irq(int irq, void *data)\n{\n\tstruct wm2200_priv *wm2200 = data;\n\tunsigned int val, mask;\n\tint ret;\n\n\tret = regmap_read(wm2200->regmap, WM2200_INTERRUPT_STATUS_2, &val);\n\tif (ret != 0) {\n\t\tdev_err(wm2200->dev, \"Failed to read IRQ status: %d\\n\", ret);\n\t\treturn IRQ_NONE;\n\t}\n\n\tret = regmap_read(wm2200->regmap, WM2200_INTERRUPT_STATUS_2_MASK,\n\t\t\t   &mask);\n\tif (ret != 0) {\n\t\tdev_warn(wm2200->dev, \"Failed to read IRQ mask: %d\\n\", ret);\n\t\tmask = 0;\n\t}\n\n\tval &= ~mask;\n\n\tif (val & WM2200_FLL_LOCK_EINT) {\n\t\tdev_dbg(wm2200->dev, \"FLL locked\\n\");\n\t\tcomplete(&wm2200->fll_lock);\n\t}\n\n\tif (val) {\n\t\tregmap_write(wm2200->regmap, WM2200_INTERRUPT_STATUS_2, val);\n\t\t\n\t\treturn IRQ_HANDLED;\n\t} else {\n\t\treturn IRQ_NONE;\n\t}\n}\n\nstatic const struct regmap_config wm2200_regmap = {\n\t.reg_bits = 16,\n\t.val_bits = 16,\n\n\t.max_register = WM2200_MAX_REGISTER + (ARRAY_SIZE(wm2200_ranges) *\n\t\t\t\t\t       WM2200_DSP_SPACING),\n\t.reg_defaults = wm2200_reg_defaults,\n\t.num_reg_defaults = ARRAY_SIZE(wm2200_reg_defaults),\n\t.volatile_reg = wm2200_volatile_register,\n\t.readable_reg = wm2200_readable_register,\n\t.cache_type = REGCACHE_MAPLE,\n\t.ranges = wm2200_ranges,\n\t.num_ranges = ARRAY_SIZE(wm2200_ranges),\n};\n\nstatic const unsigned int wm2200_dig_vu[] = {\n\tWM2200_DAC_DIGITAL_VOLUME_1L,\n\tWM2200_DAC_DIGITAL_VOLUME_1R,\n\tWM2200_DAC_DIGITAL_VOLUME_2L,\n\tWM2200_DAC_DIGITAL_VOLUME_2R,\n\tWM2200_ADC_DIGITAL_VOLUME_1L,\n\tWM2200_ADC_DIGITAL_VOLUME_1R,\n\tWM2200_ADC_DIGITAL_VOLUME_2L,\n\tWM2200_ADC_DIGITAL_VOLUME_2R,\n\tWM2200_ADC_DIGITAL_VOLUME_3L,\n\tWM2200_ADC_DIGITAL_VOLUME_3R,\n};\n\nstatic const unsigned int wm2200_mic_ctrl_reg[] = {\n\tWM2200_IN1L_CONTROL,\n\tWM2200_IN2L_CONTROL,\n\tWM2200_IN3L_CONTROL,\n};\n\nstatic int wm2200_i2c_probe(struct i2c_client *i2c)\n{\n\tstruct wm2200_pdata *pdata = dev_get_platdata(&i2c->dev);\n\tstruct wm2200_priv *wm2200;\n\tunsigned int reg;\n\tint ret, i;\n\tint val;\n\n\twm2200 = devm_kzalloc(&i2c->dev, sizeof(struct wm2200_priv),\n\t\t\t      GFP_KERNEL);\n\tif (wm2200 == NULL)\n\t\treturn -ENOMEM;\n\n\twm2200->dev = &i2c->dev;\n\tinit_completion(&wm2200->fll_lock);\n\n\twm2200->regmap = devm_regmap_init_i2c(i2c, &wm2200_regmap);\n\tif (IS_ERR(wm2200->regmap)) {\n\t\tret = PTR_ERR(wm2200->regmap);\n\t\tdev_err(&i2c->dev, \"Failed to allocate register map: %d\\n\",\n\t\t\tret);\n\t\treturn ret;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\twm2200->dsp[i].cs_dsp.type = WMFW_ADSP1;\n\t\twm2200->dsp[i].part = \"wm2200\";\n\t\twm2200->dsp[i].cs_dsp.num = i + 1;\n\t\twm2200->dsp[i].cs_dsp.dev = &i2c->dev;\n\t\twm2200->dsp[i].cs_dsp.regmap = wm2200->regmap;\n\t\twm2200->dsp[i].cs_dsp.sysclk_reg = WM2200_CLOCKING_3;\n\t\twm2200->dsp[i].cs_dsp.sysclk_mask = WM2200_SYSCLK_FREQ_MASK;\n\t\twm2200->dsp[i].cs_dsp.sysclk_shift =  WM2200_SYSCLK_FREQ_SHIFT;\n\t}\n\n\twm2200->dsp[0].cs_dsp.base = WM2200_DSP1_CONTROL_1;\n\twm2200->dsp[0].cs_dsp.mem = wm2200_dsp1_regions;\n\twm2200->dsp[0].cs_dsp.num_mems = ARRAY_SIZE(wm2200_dsp1_regions);\n\n\twm2200->dsp[1].cs_dsp.base = WM2200_DSP2_CONTROL_1;\n\twm2200->dsp[1].cs_dsp.mem = wm2200_dsp2_regions;\n\twm2200->dsp[1].cs_dsp.num_mems = ARRAY_SIZE(wm2200_dsp2_regions);\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200->dsp); i++)\n\t\twm_adsp1_init(&wm2200->dsp[i]);\n\n\tif (pdata)\n\t\twm2200->pdata = *pdata;\n\n\ti2c_set_clientdata(i2c, wm2200);\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200->core_supplies); i++)\n\t\twm2200->core_supplies[i].supply = wm2200_core_supply_names[i];\n\n\tret = devm_regulator_bulk_get(&i2c->dev,\n\t\t\t\t      ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t\t      wm2200->core_supplies);\n\tif (ret != 0) {\n\t\tdev_err(&i2c->dev, \"Failed to request core supplies: %d\\n\",\n\t\t\tret);\n\t\treturn ret;\n\t}\n\n\tret = regulator_bulk_enable(ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t\t    wm2200->core_supplies);\n\tif (ret != 0) {\n\t\tdev_err(&i2c->dev, \"Failed to enable core supplies: %d\\n\",\n\t\t\tret);\n\t\treturn ret;\n\t}\n\n\tif (wm2200->pdata.ldo_ena) {\n\t\tret = devm_gpio_request_one(&i2c->dev, wm2200->pdata.ldo_ena,\n\t\t\t\t\t    GPIOF_OUT_INIT_HIGH,\n\t\t\t\t\t    \"WM2200 LDOENA\");\n\t\tif (ret < 0) {\n\t\t\tdev_err(&i2c->dev, \"Failed to request LDOENA %d: %d\\n\",\n\t\t\t\twm2200->pdata.ldo_ena, ret);\n\t\t\tgoto err_enable;\n\t\t}\n\t\tmsleep(2);\n\t}\n\n\tif (wm2200->pdata.reset) {\n\t\tret = devm_gpio_request_one(&i2c->dev, wm2200->pdata.reset,\n\t\t\t\t\t    GPIOF_OUT_INIT_HIGH,\n\t\t\t\t\t    \"WM2200 /RESET\");\n\t\tif (ret < 0) {\n\t\t\tdev_err(&i2c->dev, \"Failed to request /RESET %d: %d\\n\",\n\t\t\t\twm2200->pdata.reset, ret);\n\t\t\tgoto err_ldo;\n\t\t}\n\t}\n\n\tret = regmap_read(wm2200->regmap, WM2200_SOFTWARE_RESET, &reg);\n\tif (ret < 0) {\n\t\tdev_err(&i2c->dev, \"Failed to read ID register: %d\\n\", ret);\n\t\tgoto err_reset;\n\t}\n\tswitch (reg) {\n\tcase 0x2200:\n\t\tbreak;\n\n\tdefault:\n\t\tdev_err(&i2c->dev, \"Device is not a WM2200, ID is %x\\n\", reg);\n\t\tret = -EINVAL;\n\t\tgoto err_reset;\n\t}\n\n\tret = regmap_read(wm2200->regmap, WM2200_DEVICE_REVISION, &reg);\n\tif (ret < 0) {\n\t\tdev_err(&i2c->dev, \"Failed to read revision register\\n\");\n\t\tgoto err_reset;\n\t}\n\n\twm2200->rev = reg & WM2200_DEVICE_REVISION_MASK;\n\n\tdev_info(&i2c->dev, \"revision %c\\n\", wm2200->rev + 'A');\n\n\tswitch (wm2200->rev) {\n\tcase 0:\n\tcase 1:\n\t\tret = regmap_register_patch(wm2200->regmap, wm2200_reva_patch,\n\t\t\t\t\t    ARRAY_SIZE(wm2200_reva_patch));\n\t\tif (ret != 0) {\n\t\t\tdev_err(&i2c->dev, \"Failed to register patch: %d\\n\",\n\t\t\t\tret);\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\tret = wm2200_reset(wm2200);\n\tif (ret < 0) {\n\t\tdev_err(&i2c->dev, \"Failed to issue reset\\n\");\n\t\tgoto err_reset;\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200->pdata.gpio_defaults); i++) {\n\t\tif (!wm2200->pdata.gpio_defaults[i])\n\t\t\tcontinue;\n\n\t\tregmap_write(wm2200->regmap, WM2200_GPIO_CTRL_1 + i,\n\t\t\t     wm2200->pdata.gpio_defaults[i]);\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200_dig_vu); i++)\n\t\tregmap_update_bits(wm2200->regmap, wm2200_dig_vu[i],\n\t\t\t\t   WM2200_OUT_VU, WM2200_OUT_VU);\n\n\t \n\tfor (i = 0; i < 6; i++) {\n\t\tregmap_write(wm2200->regmap, WM2200_AUDIO_IF_1_10 + i, i);\n\t\tregmap_write(wm2200->regmap, WM2200_AUDIO_IF_1_16 + i, i);\n\t}\n\n\tfor (i = 0; i < WM2200_MAX_MICBIAS; i++) {\n\t\tif (!wm2200->pdata.micbias[i].mb_lvl &&\n\t\t    !wm2200->pdata.micbias[i].bypass)\n\t\t\tcontinue;\n\n\t\t \n\t\tif (!wm2200->pdata.micbias[i].mb_lvl)\n\t\t\twm2200->pdata.micbias[i].mb_lvl\n\t\t\t\t\t= WM2200_MBIAS_LVL_1V5;\n\n\t\tval = (wm2200->pdata.micbias[i].mb_lvl -1)\n\t\t\t\t\t<< WM2200_MICB1_LVL_SHIFT;\n\n\t\tif (wm2200->pdata.micbias[i].discharge)\n\t\t\tval |= WM2200_MICB1_DISCH;\n\n\t\tif (wm2200->pdata.micbias[i].fast_start)\n\t\t\tval |= WM2200_MICB1_RATE;\n\n\t\tif (wm2200->pdata.micbias[i].bypass)\n\t\t\tval |= WM2200_MICB1_MODE;\n\n\t\tregmap_update_bits(wm2200->regmap,\n\t\t\t\t   WM2200_MIC_BIAS_CTRL_1 + i,\n\t\t\t\t   WM2200_MICB1_LVL_MASK |\n\t\t\t\t   WM2200_MICB1_DISCH |\n\t\t\t\t   WM2200_MICB1_MODE |\n\t\t\t\t   WM2200_MICB1_RATE, val);\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(wm2200->pdata.in_mode); i++) {\n\t\tregmap_update_bits(wm2200->regmap, wm2200_mic_ctrl_reg[i],\n\t\t\t\t   WM2200_IN1_MODE_MASK |\n\t\t\t\t   WM2200_IN1_DMIC_SUP_MASK,\n\t\t\t\t   (wm2200->pdata.in_mode[i] <<\n\t\t\t\t    WM2200_IN1_MODE_SHIFT) |\n\t\t\t\t   (wm2200->pdata.dmic_sup[i] <<\n\t\t\t\t    WM2200_IN1_DMIC_SUP_SHIFT));\n\t}\n\n\tif (i2c->irq) {\n\t\tret = request_threaded_irq(i2c->irq, NULL, wm2200_irq,\n\t\t\t\t\t   IRQF_TRIGGER_HIGH | IRQF_ONESHOT,\n\t\t\t\t\t   \"wm2200\", wm2200);\n\t\tif (ret == 0)\n\t\t\tregmap_update_bits(wm2200->regmap,\n\t\t\t\t\t   WM2200_INTERRUPT_STATUS_2_MASK,\n\t\t\t\t\t   WM2200_FLL_LOCK_EINT, 0);\n\t\telse\n\t\t\tdev_err(&i2c->dev, \"Failed to request IRQ %d: %d\\n\",\n\t\t\t\ti2c->irq, ret);\n\t}\n\n\tpm_runtime_set_active(&i2c->dev);\n\tpm_runtime_enable(&i2c->dev);\n\tpm_request_idle(&i2c->dev);\n\n\tret = devm_snd_soc_register_component(&i2c->dev, &soc_component_wm2200,\n\t\t\t\t     &wm2200_dai, 1);\n\tif (ret != 0) {\n\t\tdev_err(&i2c->dev, \"Failed to register CODEC: %d\\n\", ret);\n\t\tgoto err_pm_runtime;\n\t}\n\n\treturn 0;\n\nerr_pm_runtime:\n\tpm_runtime_disable(&i2c->dev);\n\tif (i2c->irq)\n\t\tfree_irq(i2c->irq, wm2200);\nerr_reset:\n\tif (wm2200->pdata.reset)\n\t\tgpio_set_value_cansleep(wm2200->pdata.reset, 0);\nerr_ldo:\n\tif (wm2200->pdata.ldo_ena)\n\t\tgpio_set_value_cansleep(wm2200->pdata.ldo_ena, 0);\nerr_enable:\n\tregulator_bulk_disable(ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t       wm2200->core_supplies);\n\treturn ret;\n}\n\nstatic void wm2200_i2c_remove(struct i2c_client *i2c)\n{\n\tstruct wm2200_priv *wm2200 = i2c_get_clientdata(i2c);\n\n\tpm_runtime_disable(&i2c->dev);\n\tif (i2c->irq)\n\t\tfree_irq(i2c->irq, wm2200);\n\tif (wm2200->pdata.reset)\n\t\tgpio_set_value_cansleep(wm2200->pdata.reset, 0);\n\tif (wm2200->pdata.ldo_ena)\n\t\tgpio_set_value_cansleep(wm2200->pdata.ldo_ena, 0);\n\tregulator_bulk_disable(ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t       wm2200->core_supplies);\n}\n\n#ifdef CONFIG_PM\nstatic int wm2200_runtime_suspend(struct device *dev)\n{\n\tstruct wm2200_priv *wm2200 = dev_get_drvdata(dev);\n\n\tregcache_cache_only(wm2200->regmap, true);\n\tregcache_mark_dirty(wm2200->regmap);\n\tif (wm2200->pdata.ldo_ena)\n\t\tgpio_set_value_cansleep(wm2200->pdata.ldo_ena, 0);\n\tregulator_bulk_disable(ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t       wm2200->core_supplies);\n\n\treturn 0;\n}\n\nstatic int wm2200_runtime_resume(struct device *dev)\n{\n\tstruct wm2200_priv *wm2200 = dev_get_drvdata(dev);\n\tint ret;\n\n\tret = regulator_bulk_enable(ARRAY_SIZE(wm2200->core_supplies),\n\t\t\t\t    wm2200->core_supplies);\n\tif (ret != 0) {\n\t\tdev_err(dev, \"Failed to enable supplies: %d\\n\",\n\t\t\tret);\n\t\treturn ret;\n\t}\n\n\tif (wm2200->pdata.ldo_ena) {\n\t\tgpio_set_value_cansleep(wm2200->pdata.ldo_ena, 1);\n\t\tmsleep(2);\n\t}\n\n\tregcache_cache_only(wm2200->regmap, false);\n\tregcache_sync(wm2200->regmap);\n\n\treturn 0;\n}\n#endif\n\nstatic const struct dev_pm_ops wm2200_pm = {\n\tSET_RUNTIME_PM_OPS(wm2200_runtime_suspend, wm2200_runtime_resume,\n\t\t\t   NULL)\n};\n\nstatic const struct i2c_device_id wm2200_i2c_id[] = {\n\t{ \"wm2200\", 0 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, wm2200_i2c_id);\n\nstatic struct i2c_driver wm2200_i2c_driver = {\n\t.driver = {\n\t\t.name = \"wm2200\",\n\t\t.pm = &wm2200_pm,\n\t},\n\t.probe =    wm2200_i2c_probe,\n\t.remove =   wm2200_i2c_remove,\n\t.id_table = wm2200_i2c_id,\n};\n\nmodule_i2c_driver(wm2200_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC WM2200 driver\");\nMODULE_AUTHOR(\"Mark Brown <broonie@opensource.wolfsonmicro.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}