{
  "module_name": "cs42l43-sdw.c",
  "hash_id": "8fbc18efc265d9c4bd86fe6a367d53087dce97ebe507b62bba9d21196bd3edd3",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/cs42l43-sdw.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include <linux/errno.h>\n#include <linux/mfd/cs42l43.h>\n#include <linux/mfd/cs42l43-regs.h>\n#include <linux/module.h>\n#include <sound/pcm.h>\n#include <sound/sdw.h>\n#include <sound/soc-component.h>\n#include <sound/soc-dai.h>\n#include <sound/soc.h>\n\n#include \"cs42l43.h\"\n\nint cs42l43_sdw_add_peripheral(struct snd_pcm_substream *substream,\n\t\t\t       struct snd_pcm_hw_params *params, struct snd_soc_dai *dai)\n{\n\tstruct cs42l43_codec *priv = snd_soc_component_get_drvdata(dai->component);\n\tstruct sdw_stream_runtime *sdw_stream = snd_soc_dai_get_dma_data(dai, substream);\n\tstruct sdw_slave *sdw = dev_to_sdw_dev(priv->dev->parent);\n\tstruct sdw_stream_config sconfig = {0};\n\tstruct sdw_port_config pconfig = {0};\n\tint ret;\n\n\tif (!sdw_stream)\n\t\treturn -EINVAL;\n\n\tsnd_sdw_params_to_config(substream, params, &sconfig, &pconfig);\n\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\n\t\tpconfig.num = dai->id;\n\telse\n\t\tpconfig.num = dai->id;\n\n\tret = sdw_stream_add_slave(sdw, &sconfig, &pconfig, 1, sdw_stream);\n\tif (ret) {\n\t\tdev_err(priv->dev, \"Failed to add sdw stream: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\nEXPORT_SYMBOL_NS_GPL(cs42l43_sdw_add_peripheral, SND_SOC_CS42L43);\n\nint cs42l43_sdw_remove_peripheral(struct snd_pcm_substream *substream,\n\t\t\t\t  struct snd_soc_dai *dai)\n{\n\tstruct cs42l43_codec *priv = snd_soc_component_get_drvdata(dai->component);\n\tstruct sdw_stream_runtime *sdw_stream = snd_soc_dai_get_dma_data(dai, substream);\n\tstruct sdw_slave *sdw = dev_to_sdw_dev(priv->dev->parent);\n\n\tif (!sdw_stream)\n\t\treturn -EINVAL;\n\n\treturn sdw_stream_remove_slave(sdw, sdw_stream);\n}\nEXPORT_SYMBOL_NS_GPL(cs42l43_sdw_remove_peripheral, SND_SOC_CS42L43);\n\nint cs42l43_sdw_set_stream(struct snd_soc_dai *dai, void *sdw_stream, int direction)\n{\n\tsnd_soc_dai_dma_data_set(dai, direction, sdw_stream);\n\n\treturn 0;\n}\nEXPORT_SYMBOL_NS_GPL(cs42l43_sdw_set_stream, SND_SOC_CS42L43);\n\nMODULE_DESCRIPTION(\"CS42L43 CODEC SoundWire Driver\");\nMODULE_AUTHOR(\"Charles Keepax <ckeepax@opensource.cirrus.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}