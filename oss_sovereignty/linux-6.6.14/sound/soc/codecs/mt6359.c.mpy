{
  "module_name": "mt6359.c",
  "hash_id": "9d6d4ae55d750c36a8b10241fc5e905247e13b7923092c72bb34c4ef3b7f3c7b",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/mt6359.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/mfd/mt6397/core.h>\n#include <linux/module.h>\n#include <linux/of_device.h>\n#include <linux/platform_device.h>\n#include <linux/regulator/consumer.h>\n#include <linux/sched.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n\n#include \"mt6359.h\"\n\nstatic void mt6359_set_gpio_smt(struct mt6359_priv *priv)\n{\n\t \n\tregmap_update_bits(priv->regmap, MT6359_SMT_CON1, 0x3ff0, 0x3ff0);\n}\n\nstatic void mt6359_set_gpio_driving(struct mt6359_priv *priv)\n{\n\t \n\tregmap_update_bits(priv->regmap, MT6359_DRV_CON2, 0xffff, 0x8888);\n\tregmap_update_bits(priv->regmap, MT6359_DRV_CON3, 0xffff, 0x8888);\n\tregmap_update_bits(priv->regmap, MT6359_DRV_CON4, 0x00ff, 0x88);\n}\n\nstatic void mt6359_set_playback_gpio(struct mt6359_priv *priv)\n{\n\t \n\tregmap_write(priv->regmap, MT6359_GPIO_MODE2_CLR, 0x0ffe);\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE2_SET, 0x0249);\n\n\t \n\tregmap_write(priv->regmap, MT6359_GPIO_MODE3_CLR, 0x6);\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE3_SET, 0x1);\n}\n\nstatic void mt6359_reset_playback_gpio(struct mt6359_priv *priv)\n{\n\t \n\tregmap_write(priv->regmap, MT6359_GPIO_MODE2_CLR, 0x0ff8);\n\tregmap_update_bits(priv->regmap, MT6359_GPIO_DIR0, 0x7 << 9, 0x0);\n}\n\nstatic void mt6359_set_capture_gpio(struct mt6359_priv *priv)\n{\n\t \n\tregmap_write(priv->regmap, MT6359_GPIO_MODE3_CLR, 0x0e00);\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE3_SET, 0x0200);\n\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE4_CLR, 0x003f);\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE4_SET, 0x0009);\n}\n\nstatic void mt6359_reset_capture_gpio(struct mt6359_priv *priv)\n{\n\t \n\tregmap_write(priv->regmap, MT6359_GPIO_MODE3_CLR, 0x0e00);\n\n\tregmap_write(priv->regmap, MT6359_GPIO_MODE4_CLR, 0x003f);\n\n\tregmap_update_bits(priv->regmap, MT6359_GPIO_DIR0,\n\t\t\t   0x7 << 13, 0x0);\n\tregmap_update_bits(priv->regmap, MT6359_GPIO_DIR1,\n\t\t\t   0x3 << 0, 0x0);\n}\n\n \nstatic void mt6359_set_dcxo(struct mt6359_priv *priv, bool enable)\n{\n\tregmap_update_bits(priv->regmap, MT6359_DCXO_CW12,\n\t\t\t   0x1 << RG_XO_AUDIO_EN_M_SFT,\n\t\t\t   (enable ? 1 : 0) << RG_XO_AUDIO_EN_M_SFT);\n}\n\n \nstatic void mt6359_set_clksq(struct mt6359_priv *priv, bool enable)\n{\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON23,\n\t\t\t   RG_CLKSQ_EN_MASK_SFT,\n\t\t\t   (enable ? 1 : 0) << RG_CLKSQ_EN_SFT);\n}\n\n \nstatic void mt6359_set_aud_global_bias(struct mt6359_priv *priv, bool enable)\n{\n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON13,\n\t\t\t   RG_AUDGLB_PWRDN_VA32_MASK_SFT,\n\t\t\t   (enable ? 0 : 1) << RG_AUDGLB_PWRDN_VA32_SFT);\n}\n\n \nstatic void mt6359_set_topck(struct mt6359_priv *priv, bool enable)\n{\n\tregmap_update_bits(priv->regmap, MT6359_AUD_TOP_CKPDN_CON0,\n\t\t\t   0x0066, enable ? 0x0 : 0x66);\n}\n\nstatic void mt6359_set_decoder_clk(struct mt6359_priv *priv, bool enable)\n{\n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON13,\n\t\t\t   RG_RSTB_DECODER_VA32_MASK_SFT,\n\t\t\t   (enable ? 1 : 0) << RG_RSTB_DECODER_VA32_SFT);\n}\n\nstatic void mt6359_mtkaif_tx_enable(struct mt6359_priv *priv)\n{\n\tswitch (priv->mtkaif_protocol) {\n\tcase MT6359_MTKAIF_PROTOCOL_2_CLK_P2:\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_ADDA_MTKAIF_CFG0,\n\t\t\t\t   0xffff, 0x0210);\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_AUD_PAD_TOP,\n\t\t\t\t   0xff00, 0x3800);\n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_AUD_PAD_TOP,\n\t\t\t\t   0xff00, 0x3900);\n\t\tbreak;\n\tcase MT6359_MTKAIF_PROTOCOL_2:\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_ADDA_MTKAIF_CFG0,\n\t\t\t\t   0xffff, 0x0210);\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_AUD_PAD_TOP,\n\t\t\t\t   0xff00, 0x3100);\n\t\tbreak;\n\tcase MT6359_MTKAIF_PROTOCOL_1:\n\tdefault:\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_ADDA_MTKAIF_CFG0,\n\t\t\t\t   0xffff, 0x0000);\n\t\t \n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AFE_AUD_PAD_TOP,\n\t\t\t\t   0xff00, 0x3100);\n\t\tbreak;\n\t}\n}\n\nstatic void mt6359_mtkaif_tx_disable(struct mt6359_priv *priv)\n{\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AFE_AUD_PAD_TOP,\n\t\t\t   0xff00, 0x3000);\n}\n\nvoid mt6359_set_mtkaif_protocol(struct snd_soc_component *cmpnt,\n\t\t\t\tint mtkaif_protocol)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tpriv->mtkaif_protocol = mtkaif_protocol;\n}\nEXPORT_SYMBOL_GPL(mt6359_set_mtkaif_protocol);\n\nvoid mt6359_mtkaif_calibration_enable(struct snd_soc_component *cmpnt)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tmt6359_set_playback_gpio(priv);\n\tmt6359_set_capture_gpio(priv);\n\tmt6359_mtkaif_tx_enable(priv);\n\n\tmt6359_set_dcxo(priv, true);\n\tmt6359_set_aud_global_bias(priv, true);\n\tmt6359_set_clksq(priv, true);\n\tmt6359_set_topck(priv, true);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO2_LOOPBACK_MASK_SFT,\n\t\t\t   1 << RG_AUD_PAD_TOP_DAT_MISO2_LOOPBACK_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO_LOOPBACK_MASK_SFT,\n\t\t\t   1 << RG_AUD_PAD_TOP_DAT_MISO_LOOPBACK_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG1,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO3_LOOPBACK_MASK_SFT,\n\t\t\t   1 << RG_AUD_PAD_TOP_DAT_MISO3_LOOPBACK_SFT);\n}\nEXPORT_SYMBOL_GPL(mt6359_mtkaif_calibration_enable);\n\nvoid mt6359_mtkaif_calibration_disable(struct snd_soc_component *cmpnt)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO2_LOOPBACK_MASK_SFT,\n\t\t\t   0 << RG_AUD_PAD_TOP_DAT_MISO2_LOOPBACK_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO_LOOPBACK_MASK_SFT,\n\t\t\t   0 << RG_AUD_PAD_TOP_DAT_MISO_LOOPBACK_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG1,\n\t\t\t   RG_AUD_PAD_TOP_DAT_MISO3_LOOPBACK_MASK_SFT,\n\t\t\t   0 << RG_AUD_PAD_TOP_DAT_MISO3_LOOPBACK_SFT);\n\n\tmt6359_set_topck(priv, false);\n\tmt6359_set_clksq(priv, false);\n\tmt6359_set_aud_global_bias(priv, false);\n\tmt6359_set_dcxo(priv, false);\n\n\tmt6359_mtkaif_tx_disable(priv);\n\tmt6359_reset_playback_gpio(priv);\n\tmt6359_reset_capture_gpio(priv);\n}\nEXPORT_SYMBOL_GPL(mt6359_mtkaif_calibration_disable);\n\nvoid mt6359_set_mtkaif_calibration_phase(struct snd_soc_component *cmpnt,\n\t\t\t\t\t int phase_1, int phase_2, int phase_3)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_PHASE_MODE_MASK_SFT,\n\t\t\t   phase_1 << RG_AUD_PAD_TOP_PHASE_MODE_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG,\n\t\t\t   RG_AUD_PAD_TOP_PHASE_MODE2_MASK_SFT,\n\t\t\t   phase_2 << RG_AUD_PAD_TOP_PHASE_MODE2_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDIO_DIG_CFG1,\n\t\t\t   RG_AUD_PAD_TOP_PHASE_MODE3_MASK_SFT,\n\t\t\t   phase_3 << RG_AUD_PAD_TOP_PHASE_MODE3_SFT);\n}\nEXPORT_SYMBOL_GPL(mt6359_set_mtkaif_calibration_phase);\n\nstatic void zcd_disable(struct mt6359_priv *priv)\n{\n\tregmap_write(priv->regmap, MT6359_ZCD_CON0, 0x0000);\n}\n\nstatic void hp_main_output_ramp(struct mt6359_priv *priv, bool up)\n{\n\tint i, stage;\n\tint target = 7;\n\n\t \n\tfor (i = 0; i <= target; i++) {\n\t\tstage = up ? i : target - i;\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1,\n\t\t\t\t   RG_HPLOUTSTGCTRL_VAUDP32_MASK_SFT,\n\t\t\t\t   stage << RG_HPLOUTSTGCTRL_VAUDP32_SFT);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1,\n\t\t\t\t   RG_HPROUTSTGCTRL_VAUDP32_MASK_SFT,\n\t\t\t\t   stage << RG_HPROUTSTGCTRL_VAUDP32_SFT);\n\t\tusleep_range(600, 650);\n\t}\n}\n\nstatic void hp_aux_feedback_loop_gain_ramp(struct mt6359_priv *priv, bool up)\n{\n\tint i, stage;\n\tint target = 0xf;\n\n\t \n\tfor (i = 0; i <= target; i++) {\n\t\tstage = up ? i : target - i;\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON9,\n\t\t\t\t   0xf << 12, stage << 12);\n\t\tusleep_range(600, 650);\n\t}\n}\n\nstatic void hp_in_pair_current(struct mt6359_priv *priv, bool increase)\n{\n\tint i, stage;\n\tint target = 0x3;\n\n\t \n\tif (priv->hp_hifi_mode) {\n\t\t \n\t\tfor (i = 0; i <= target; i++) {\n\t\t\tstage = increase ? i : target - i;\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDDEC_ANA_CON10,\n\t\t\t\t\t   0x3 << 3, stage << 3);\n\t\t\tusleep_range(100, 150);\n\t\t}\n\t}\n}\n\nstatic void hp_pull_down(struct mt6359_priv *priv, bool enable)\n{\n\tint i;\n\n\tif (enable) {\n\t\tfor (i = 0x0; i <= 0x7; i++) {\n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON2,\n\t\t\t\t\t   RG_HPPSHORT2VCM_VAUDP32_MASK_SFT,\n\t\t\t\t\t   i << RG_HPPSHORT2VCM_VAUDP32_SFT);\n\t\t\tusleep_range(100, 150);\n\t\t}\n\t} else {\n\t\tfor (i = 0x7; i >= 0x0; i--) {\n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON2,\n\t\t\t\t\t   RG_HPPSHORT2VCM_VAUDP32_MASK_SFT,\n\t\t\t\t\t   i << RG_HPPSHORT2VCM_VAUDP32_SFT);\n\t\t\tusleep_range(100, 150);\n\t\t}\n\t}\n}\n\nstatic bool is_valid_hp_pga_idx(int reg_idx)\n{\n\treturn (reg_idx >= DL_GAIN_8DB && reg_idx <= DL_GAIN_N_22DB) ||\n\t       reg_idx == DL_GAIN_N_40DB;\n}\n\nstatic void headset_volume_ramp(struct mt6359_priv *priv,\n\t\t\t\tint from, int to)\n{\n\tint offset = 0, count = 1, reg_idx;\n\n\tif (!is_valid_hp_pga_idx(from) || !is_valid_hp_pga_idx(to)) {\n\t\tdev_warn(priv->dev, \"%s(), volume index is not valid, from %d, to %d\\n\",\n\t\t\t __func__, from, to);\n\t\treturn;\n\t}\n\n\tdev_dbg(priv->dev, \"%s(), from %d, to %d\\n\", __func__, from, to);\n\n\tif (to > from)\n\t\toffset = to - from;\n\telse\n\t\toffset = from - to;\n\n\twhile (offset > 0) {\n\t\tif (to > from)\n\t\t\treg_idx = from + count;\n\t\telse\n\t\t\treg_idx = from - count;\n\n\t\tif (is_valid_hp_pga_idx(reg_idx)) {\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_ZCD_CON2,\n\t\t\t\t\t   DL_GAIN_REG_MASK,\n\t\t\t\t\t   (reg_idx << 7) | reg_idx);\n\t\t\tusleep_range(600, 650);\n\t\t}\n\t\toffset--;\n\t\tcount++;\n\t}\n}\n\nstatic int mt6359_put_volsw(struct snd_kcontrol *kcontrol,\n\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(component);\n\tstruct soc_mixer_control *mc =\n\t\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\tunsigned int reg = 0;\n\tint index = ucontrol->value.integer.value[0];\n\tint orig_gain[2], new_gain[2];\n\tint ret;\n\n\tswitch (mc->reg) {\n\tcase MT6359_ZCD_CON2:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL];\n\t\torig_gain[1] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON1:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTL];\n\t\torig_gain[1] = priv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON3:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HSOUTL];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON0:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP1];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON1:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP2];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON2:\n\t\torig_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP3];\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tret = snd_soc_put_volsw(kcontrol, ucontrol);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tswitch (mc->reg) {\n\tcase MT6359_ZCD_CON2:\n\t\tregmap_read(priv->regmap, MT6359_ZCD_CON2, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL] =\n\t\t\t(reg >> RG_AUDHPLGAIN_SFT) & RG_AUDHPLGAIN_MASK;\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTR] =\n\t\t\t(reg >> RG_AUDHPRGAIN_SFT) & RG_AUDHPRGAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL];\n\t\tnew_gain[1] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON1:\n\t\tregmap_read(priv->regmap, MT6359_ZCD_CON1, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTL] =\n\t\t\t(reg >> RG_AUDLOLGAIN_SFT) & RG_AUDLOLGAIN_MASK;\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTR] =\n\t\t\t(reg >> RG_AUDLORGAIN_SFT) & RG_AUDLORGAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTL];\n\t\tnew_gain[1] = priv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON3:\n\t\tregmap_read(priv->regmap, MT6359_ZCD_CON3, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HSOUTL] =\n\t\t\t(reg >> RG_AUDHSGAIN_SFT) & RG_AUDHSGAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_HSOUTL];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON0:\n\t\tregmap_read(priv->regmap, MT6359_AUDENC_ANA_CON0, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP1] =\n\t\t\t(reg >> RG_AUDPREAMPLGAIN_SFT) & RG_AUDPREAMPLGAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP1];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON1:\n\t\tregmap_read(priv->regmap, MT6359_AUDENC_ANA_CON1, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP2] =\n\t\t\t(reg >> RG_AUDPREAMPRGAIN_SFT) & RG_AUDPREAMPRGAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP2];\n\t\tbreak;\n\tcase MT6359_AUDENC_ANA_CON2:\n\t\tregmap_read(priv->regmap, MT6359_AUDENC_ANA_CON2, &reg);\n\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP3] =\n\t\t\t(reg >> RG_AUDPREAMP3GAIN_SFT) & RG_AUDPREAMP3GAIN_MASK;\n\t\tnew_gain[0] = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP3];\n\t\tbreak;\n\t}\n\n\tret = 0;\n\tif (orig_gain[0] != new_gain[0]) {\n\t\tret = 1;\n\t} else if (snd_soc_volsw_is_stereo(mc)) {\n\t\tif (orig_gain[1] != new_gain[1])\n\t\t\tret = 1;\n\t}\n\n\tdev_dbg(priv->dev, \"%s(), name %s, reg(0x%x) = 0x%x, set index = %x\\n\",\n\t\t__func__, kcontrol->id.name, mc->reg, reg, index);\n\n\treturn ret;\n}\n\nstatic int mt6359_get_playback_volsw(struct snd_kcontrol *kcontrol,\n\t\t\t\t     struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(component);\n\tstruct soc_mixer_control *mc =\n\t\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\n\tswitch (mc->reg) {\n\tcase MT6359_ZCD_CON2:\n\t\tucontrol->value.integer.value[0] =\n\t\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL];\n\t\tucontrol->value.integer.value[1] =\n\t\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON1:\n\t\tucontrol->value.integer.value[0] =\n\t\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTL];\n\t\tucontrol->value.integer.value[1] =\n\t\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTR];\n\t\tbreak;\n\tcase MT6359_ZCD_CON3:\n\t\tucontrol->value.integer.value[0] =\n\t\t\tpriv->ana_gain[AUDIO_ANALOG_VOLUME_HSOUTL];\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\n \n\n \nstatic const char * const lo_in_mux_map[] = {\n\t\"Open\", \"Playback_L_DAC\", \"Playback\", \"Test Mode\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(lo_in_mux_map_enum, SND_SOC_NOPM, 0, lo_in_mux_map);\n\nstatic const struct snd_kcontrol_new lo_in_mux_control =\n\tSOC_DAPM_ENUM(\"LO Select\", lo_in_mux_map_enum);\n\n \nstatic const char * const hp_in_mux_map[] = {\n\t\"Open\",\n\t\"LoudSPK Playback\",\n\t\"Audio Playback\",\n\t\"Test Mode\",\n\t\"HP Impedance\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(hp_in_mux_map_enum,\n\t\t\t\t  SND_SOC_NOPM,\n\t\t\t\t  0,\n\t\t\t\t  hp_in_mux_map);\n\nstatic const struct snd_kcontrol_new hp_in_mux_control =\n\tSOC_DAPM_ENUM(\"HP Select\", hp_in_mux_map_enum);\n\n \nstatic const char * const rcv_in_mux_map[] = {\n\t\"Open\", \"Mute\", \"Voice Playback\", \"Test Mode\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rcv_in_mux_map_enum,\n\t\t\t\t  SND_SOC_NOPM,\n\t\t\t\t  0,\n\t\t\t\t  rcv_in_mux_map);\n\nstatic const struct snd_kcontrol_new rcv_in_mux_control =\n\tSOC_DAPM_ENUM(\"RCV Select\", rcv_in_mux_map_enum);\n\n \nstatic const char * const dac_in_mux_map[] = {\n\t\"Normal Path\", \"Sgen\"\n};\n\nstatic int dac_in_mux_map_value[] = {\n\t0x0, 0x1,\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(dac_in_mux_map_enum,\n\t\t\t\t  MT6359_AFE_TOP_CON0,\n\t\t\t\t  DL_SINE_ON_SFT,\n\t\t\t\t  DL_SINE_ON_MASK,\n\t\t\t\t  dac_in_mux_map,\n\t\t\t\t  dac_in_mux_map_value);\n\nstatic const struct snd_kcontrol_new dac_in_mux_control =\n\tSOC_DAPM_ENUM(\"DAC Select\", dac_in_mux_map_enum);\n\n \nstatic SOC_VALUE_ENUM_SINGLE_DECL(aif_out_mux_map_enum,\n\t\t\t\t  MT6359_AFE_TOP_CON0,\n\t\t\t\t  UL_SINE_ON_SFT,\n\t\t\t\t  UL_SINE_ON_MASK,\n\t\t\t\t  dac_in_mux_map,\n\t\t\t\t  dac_in_mux_map_value);\n\nstatic const struct snd_kcontrol_new aif_out_mux_control =\n\tSOC_DAPM_ENUM(\"AIF Out Select\", aif_out_mux_map_enum);\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(aif2_out_mux_map_enum,\n\t\t\t\t  MT6359_AFE_TOP_CON0,\n\t\t\t\t  ADDA6_UL_SINE_ON_SFT,\n\t\t\t\t  ADDA6_UL_SINE_ON_MASK,\n\t\t\t\t  dac_in_mux_map,\n\t\t\t\t  dac_in_mux_map_value);\n\nstatic const struct snd_kcontrol_new aif2_out_mux_control =\n\tSOC_DAPM_ENUM(\"AIF Out Select\", aif2_out_mux_map_enum);\n\nstatic const char * const ul_src_mux_map[] = {\n\t\"AMIC\",\n\t\"DMIC\",\n};\n\nstatic int ul_src_mux_map_value[] = {\n\tUL_SRC_MUX_AMIC,\n\tUL_SRC_MUX_DMIC,\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(ul_src_mux_map_enum,\n\t\t\t\t  MT6359_AFE_UL_SRC_CON0_L,\n\t\t\t\t  UL_SDM_3_LEVEL_CTL_SFT,\n\t\t\t\t  UL_SDM_3_LEVEL_CTL_MASK,\n\t\t\t\t  ul_src_mux_map,\n\t\t\t\t  ul_src_mux_map_value);\n\nstatic const struct snd_kcontrol_new ul_src_mux_control =\n\tSOC_DAPM_ENUM(\"UL_SRC_MUX Select\", ul_src_mux_map_enum);\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(ul2_src_mux_map_enum,\n\t\t\t\t  MT6359_AFE_ADDA6_UL_SRC_CON0_L,\n\t\t\t\t  ADDA6_UL_SDM_3_LEVEL_CTL_SFT,\n\t\t\t\t  ADDA6_UL_SDM_3_LEVEL_CTL_MASK,\n\t\t\t\t  ul_src_mux_map,\n\t\t\t\t  ul_src_mux_map_value);\n\nstatic const struct snd_kcontrol_new ul2_src_mux_control =\n\tSOC_DAPM_ENUM(\"UL_SRC_MUX Select\", ul2_src_mux_map_enum);\n\nstatic const char * const miso_mux_map[] = {\n\t\"UL1_CH1\",\n\t\"UL1_CH2\",\n\t\"UL2_CH1\",\n\t\"UL2_CH2\",\n};\n\nstatic int miso_mux_map_value[] = {\n\tMISO_MUX_UL1_CH1,\n\tMISO_MUX_UL1_CH2,\n\tMISO_MUX_UL2_CH1,\n\tMISO_MUX_UL2_CH2,\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(miso0_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MTKAIF_MUX_CFG,\n\t\t\t\t  RG_ADDA_CH1_SEL_SFT,\n\t\t\t\t  RG_ADDA_CH1_SEL_MASK,\n\t\t\t\t  miso_mux_map,\n\t\t\t\t  miso_mux_map_value);\n\nstatic const struct snd_kcontrol_new miso0_mux_control =\n\tSOC_DAPM_ENUM(\"MISO_MUX Select\", miso0_mux_map_enum);\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(miso1_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MTKAIF_MUX_CFG,\n\t\t\t\t  RG_ADDA_CH2_SEL_SFT,\n\t\t\t\t  RG_ADDA_CH2_SEL_MASK,\n\t\t\t\t  miso_mux_map,\n\t\t\t\t  miso_mux_map_value);\n\nstatic const struct snd_kcontrol_new miso1_mux_control =\n\tSOC_DAPM_ENUM(\"MISO_MUX Select\", miso1_mux_map_enum);\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(miso2_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MTKAIF_MUX_CFG,\n\t\t\t\t  RG_ADDA6_CH1_SEL_SFT,\n\t\t\t\t  RG_ADDA6_CH1_SEL_MASK,\n\t\t\t\t  miso_mux_map,\n\t\t\t\t  miso_mux_map_value);\n\nstatic const struct snd_kcontrol_new miso2_mux_control =\n\tSOC_DAPM_ENUM(\"MISO_MUX Select\", miso2_mux_map_enum);\n\nstatic const char * const dmic_mux_map[] = {\n\t\"DMIC_DATA0\",\n\t\"DMIC_DATA1_L\",\n\t\"DMIC_DATA1_L_1\",\n\t\"DMIC_DATA1_R\",\n};\n\nstatic int dmic_mux_map_value[] = {\n\tDMIC_MUX_DMIC_DATA0,\n\tDMIC_MUX_DMIC_DATA1_L,\n\tDMIC_MUX_DMIC_DATA1_L_1,\n\tDMIC_MUX_DMIC_DATA1_R,\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(dmic0_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MIC_ARRAY_CFG,\n\t\t\t\t  RG_DMIC_ADC1_SOURCE_SEL_SFT,\n\t\t\t\t  RG_DMIC_ADC1_SOURCE_SEL_MASK,\n\t\t\t\t  dmic_mux_map,\n\t\t\t\t  dmic_mux_map_value);\n\nstatic const struct snd_kcontrol_new dmic0_mux_control =\n\tSOC_DAPM_ENUM(\"DMIC_MUX Select\", dmic0_mux_map_enum);\n\n \nstatic SOC_VALUE_ENUM_SINGLE_DECL(dmic1_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MIC_ARRAY_CFG,\n\t\t\t\t  RG_DMIC_ADC3_SOURCE_SEL_SFT,\n\t\t\t\t  RG_DMIC_ADC3_SOURCE_SEL_MASK,\n\t\t\t\t  dmic_mux_map,\n\t\t\t\t  dmic_mux_map_value);\n\nstatic const struct snd_kcontrol_new dmic1_mux_control =\n\tSOC_DAPM_ENUM(\"DMIC_MUX Select\", dmic1_mux_map_enum);\n\n \nstatic SOC_VALUE_ENUM_SINGLE_DECL(dmic2_mux_map_enum,\n\t\t\t\t  MT6359_AFE_MIC_ARRAY_CFG,\n\t\t\t\t  RG_DMIC_ADC2_SOURCE_SEL_SFT,\n\t\t\t\t  RG_DMIC_ADC2_SOURCE_SEL_MASK,\n\t\t\t\t  dmic_mux_map,\n\t\t\t\t  dmic_mux_map_value);\n\nstatic const struct snd_kcontrol_new dmic2_mux_control =\n\tSOC_DAPM_ENUM(\"DMIC_MUX Select\", dmic2_mux_map_enum);\n\n \nstatic const char * const adc_left_mux_map[] = {\n\t\"Idle\", \"AIN0\", \"Left Preamplifier\", \"Idle_1\"\n};\n\nstatic int adc_mux_map_value[] = {\n\tADC_MUX_IDLE,\n\tADC_MUX_AIN0,\n\tADC_MUX_PREAMPLIFIER,\n\tADC_MUX_IDLE1,\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(adc_left_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON0,\n\t\t\t\t  RG_AUDADCLINPUTSEL_SFT,\n\t\t\t\t  RG_AUDADCLINPUTSEL_MASK,\n\t\t\t\t  adc_left_mux_map,\n\t\t\t\t  adc_mux_map_value);\n\nstatic const struct snd_kcontrol_new adc_left_mux_control =\n\tSOC_DAPM_ENUM(\"ADC L Select\", adc_left_mux_map_enum);\n\n \nstatic const char * const adc_right_mux_map[] = {\n\t\"Idle\", \"AIN0\", \"Right Preamplifier\", \"Idle_1\"\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(adc_right_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON1,\n\t\t\t\t  RG_AUDADCRINPUTSEL_SFT,\n\t\t\t\t  RG_AUDADCRINPUTSEL_MASK,\n\t\t\t\t  adc_right_mux_map,\n\t\t\t\t  adc_mux_map_value);\n\nstatic const struct snd_kcontrol_new adc_right_mux_control =\n\tSOC_DAPM_ENUM(\"ADC R Select\", adc_right_mux_map_enum);\n\n \nstatic const char * const adc_3_mux_map[] = {\n\t\"Idle\", \"AIN0\", \"Preamplifier\", \"Idle_1\"\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(adc_3_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON2,\n\t\t\t\t  RG_AUDADC3INPUTSEL_SFT,\n\t\t\t\t  RG_AUDADC3INPUTSEL_MASK,\n\t\t\t\t  adc_3_mux_map,\n\t\t\t\t  adc_mux_map_value);\n\nstatic const struct snd_kcontrol_new adc_3_mux_control =\n\tSOC_DAPM_ENUM(\"ADC 3 Select\", adc_3_mux_map_enum);\n\nstatic const char * const pga_l_mux_map[] = {\n\t\"None\", \"AIN0\", \"AIN1\"\n};\n\nstatic int pga_l_mux_map_value[] = {\n\tPGA_L_MUX_NONE,\n\tPGA_L_MUX_AIN0,\n\tPGA_L_MUX_AIN1\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(pga_left_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON0,\n\t\t\t\t  RG_AUDPREAMPLINPUTSEL_SFT,\n\t\t\t\t  RG_AUDPREAMPLINPUTSEL_MASK,\n\t\t\t\t  pga_l_mux_map,\n\t\t\t\t  pga_l_mux_map_value);\n\nstatic const struct snd_kcontrol_new pga_left_mux_control =\n\tSOC_DAPM_ENUM(\"PGA L Select\", pga_left_mux_map_enum);\n\nstatic const char * const pga_r_mux_map[] = {\n\t\"None\", \"AIN2\", \"AIN3\", \"AIN0\"\n};\n\nstatic int pga_r_mux_map_value[] = {\n\tPGA_R_MUX_NONE,\n\tPGA_R_MUX_AIN2,\n\tPGA_R_MUX_AIN3,\n\tPGA_R_MUX_AIN0\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(pga_right_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON1,\n\t\t\t\t  RG_AUDPREAMPRINPUTSEL_SFT,\n\t\t\t\t  RG_AUDPREAMPRINPUTSEL_MASK,\n\t\t\t\t  pga_r_mux_map,\n\t\t\t\t  pga_r_mux_map_value);\n\nstatic const struct snd_kcontrol_new pga_right_mux_control =\n\tSOC_DAPM_ENUM(\"PGA R Select\", pga_right_mux_map_enum);\n\nstatic const char * const pga_3_mux_map[] = {\n\t\"None\", \"AIN3\", \"AIN2\"\n};\n\nstatic int pga_3_mux_map_value[] = {\n\tPGA_3_MUX_NONE,\n\tPGA_3_MUX_AIN3,\n\tPGA_3_MUX_AIN2\n};\n\nstatic SOC_VALUE_ENUM_SINGLE_DECL(pga_3_mux_map_enum,\n\t\t\t\t  MT6359_AUDENC_ANA_CON2,\n\t\t\t\t  RG_AUDPREAMP3INPUTSEL_SFT,\n\t\t\t\t  RG_AUDPREAMP3INPUTSEL_MASK,\n\t\t\t\t  pga_3_mux_map,\n\t\t\t\t  pga_3_mux_map_value);\n\nstatic const struct snd_kcontrol_new pga_3_mux_control =\n\tSOC_DAPM_ENUM(\"PGA 3 Select\", pga_3_mux_map_enum);\n\nstatic int mt_sgen_event(struct snd_soc_dapm_widget *w,\n\t\t\t struct snd_kcontrol *kcontrol,\n\t\t\t int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON2, 0x0006);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON0, 0xcba1);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON2, 0x0003);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON2, 0x000b);\n\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_SGEN_CFG0,\n\t\t\t\t   0xff3f,\n\t\t\t\t   0x0000);\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_SGEN_CFG1,\n\t\t\t\t   0xffff,\n\t\t\t\t   0x0001);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON2, 0x0000);\n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON0, 0xcba0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic void mtk_hp_enable(struct mt6359_priv *priv)\n{\n\tif (priv->hp_hifi_mode) {\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON11,\n\t\t\t\t   DRBIAS_HP_MASK_SFT,\n\t\t\t\t   DRBIAS_6UA << DRBIAS_HP_SFT);\n\t\t \n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_ZCD_MASK_SFT,\n\t\t\t\t   IBIAS_ZCD_4UA << IBIAS_ZCD_SFT);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_HP_MASK_SFT,\n\t\t\t\t   IBIAS_5UA << IBIAS_HP_SFT);\n\t} else {\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON11,\n\t\t\t\t   DRBIAS_HP_MASK_SFT,\n\t\t\t\t   DRBIAS_5UA << DRBIAS_HP_SFT);\n\t\t \n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_ZCD_MASK_SFT,\n\t\t\t\t   IBIAS_ZCD_3UA << IBIAS_ZCD_SFT);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_HP_MASK_SFT,\n\t\t\t\t   IBIAS_4UA << IBIAS_HP_SFT);\n\t}\n\n\t \n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON10, 0x0087);\n\n\t \n\t \n\tif (priv->dl_rate[MT6359_AIF_1] >= 96000)\n\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t   MT6359_AUDDEC_ANA_CON4,\n\t\t\t\t   RG_AUDHPHFCOMPBUFGAINSEL_VAUDP32_MASK_SFT,\n\t\t\t\t   0x1 << RG_AUDHPHFCOMPBUFGAINSEL_VAUDP32_SFT);\n\telse\n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON4, 0x0000);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON2, 0xf133);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x000c);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x003c);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0c00);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x30c0);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x30f0);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x00fc);\n\n\t \n\thp_in_pair_current(priv, true);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0e00);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0200);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x00ff);\n\t \n\thp_main_output_ramp(priv, true);\n\n\t \n\thp_aux_feedback_loop_gain_ramp(priv, true);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x77cf);\n\n\t \n\theadset_volume_ramp(priv,\n\t\t\t    DL_GAIN_N_22DB,\n\t\t\t    priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL]);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x77c3);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x7703);\n\tusleep_range(100, 120);\n\n\t \n\tmt6359_set_decoder_clk(priv, true);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x30ff);\n\tif (priv->hp_hifi_mode) {\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0xf201);\n\t} else {\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0xf200);\n\t}\n\tusleep_range(100, 120);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x32ff);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x3aff);\n\n\t \n\thp_pull_down(priv, false);\n}\n\nstatic void mtk_hp_disable(struct mt6359_priv *priv)\n{\n\t \n\thp_pull_down(priv, true);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   0x0f00, 0x0000);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON9,\n\t\t\t   0x0001, 0x0000);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   0x000f, 0x0000);\n\n\t \n\tmt6359_set_decoder_clk(priv, false);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x77c3);\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x77cf);\n\n\t \n\theadset_volume_ramp(priv,\n\t\t\t    priv->ana_gain[AUDIO_ANALOG_VOLUME_HPOUTL],\n\t\t\t    DL_GAIN_N_22DB);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x77ff);\n\n\t \n\thp_aux_feedback_loop_gain_ramp(priv, false);\n\n\t \n\thp_main_output_ramp(priv, false);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1, 0x3, 0x0);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0e01);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0c01);\n\n\t \n\thp_in_pair_current(priv, false);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1,\n\t\t\t   0x3 << 6, 0x0);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   0x3 << 4, 0x0);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   0x3 << 6, 0x0);\n\n\t \n\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x201);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1,\n\t\t\t   0x3 << 4, 0x0);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON1,\n\t\t\t   0x3 << 2, 0x0);\n}\n\nstatic int mt_hp_event(struct snd_soc_dapm_widget *w,\n\t\t       struct snd_kcontrol *kcontrol,\n\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mux = dapm_kcontrol_get_value(w->kcontrols[0]);\n\tint device = DEVICE_HP;\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, dev_counter[DEV_HP] %d, mux %u\\n\",\n\t\t__func__, event, priv->dev_counter[device], mux);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tpriv->dev_counter[device]++;\n\t\tif (mux == HP_MUX_HP)\n\t\t\tmtk_hp_enable(priv);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tpriv->dev_counter[device]--;\n\t\tif (mux == HP_MUX_HP)\n\t\t\tmtk_hp_disable(priv);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_rcv_event(struct snd_soc_dapm_widget *w,\n\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\tint event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, mux %u\\n\",\n\t\t__func__, event, dapm_kcontrol_get_value(w->kcontrols[0]));\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON6, 0x0010);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON11,\n\t\t\t\t   DRBIAS_HS_MASK_SFT,\n\t\t\t\t   DRBIAS_6UA << DRBIAS_HS_SFT);\n\t\t \n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_ZCD_MASK_SFT,\n\t\t\t\t   IBIAS_ZCD_4UA << IBIAS_ZCD_SFT);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_HS_MASK_SFT,\n\t\t\t\t   IBIAS_5UA << IBIAS_HS_SFT);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON6, 0x0090);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON10, 0x7000);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON6, 0x0092);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON6, 0x0093);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON3,\n\t\t\t     priv->ana_gain[AUDIO_ANALOG_VOLUME_HSOUTL]);\n\n\t\t \n\t\tmt6359_set_decoder_clk(priv, true);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x0009);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0001);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON6, 0x009b);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON6,\n\t\t\t\t   RG_AUDHSMUXINPUTSEL_VAUDP32_MASK_SFT,\n\t\t\t\t   RCV_MUX_OPEN);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t\t   0x000f, 0x0000);\n\n\t\t \n\t\tmt6359_set_decoder_clk(priv, false);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON3, DL_GAIN_N_40DB);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON6,\n\t\t\t\t   RG_AUDHSPWRUP_VAUDP32_MASK_SFT, 0x0);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON6,\n\t\t\t\t   RG_AUDHSPWRUP_IBIAS_VAUDP32_MASK_SFT, 0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_lo_event(struct snd_soc_dapm_widget *w,\n\t\t       struct snd_kcontrol *kcontrol,\n\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mux = dapm_kcontrol_get_value(w->kcontrols[0]);\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, mux %u\\n\",\n\t\t__func__, event, mux);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x0010);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON11,\n\t\t\t\t   DRBIAS_LO_MASK_SFT,\n\t\t\t\t   DRBIAS_6UA << DRBIAS_LO_SFT);\n\t\t \n\t\t \n\t\tif (priv->dev_counter[DEVICE_HP] == 0)\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t\t   IBIAS_ZCD_MASK_SFT,\n\t\t\t\t\t   IBIAS_ZCD_4UA << IBIAS_ZCD_SFT);\n\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON12,\n\t\t\t\t   IBIAS_LO_MASK_SFT,\n\t\t\t\t   IBIAS_5UA << IBIAS_LO_SFT);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x0110);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x0112);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x0113);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON1,\n\t\t\t     priv->ana_gain[AUDIO_ANALOG_VOLUME_LINEOUTL]);\n\n\t\t \n\t\tmt6359_set_decoder_clk(priv, true);\n\n\t\t \n\t\tif (mux == LO_MUX_L_DAC) {\n\t\t\tif (priv->dev_counter[DEVICE_HP] > 0) {\n\t\t\t\tdev_info(priv->dev, \"%s(), can not enable DAC, hp count %d\\n\",\n\t\t\t\t\t __func__, priv->dev_counter[DEVICE_HP]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t \n\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON0, 0x3009);\n\t\t\t \n\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0xf200);\n\t\t\tusleep_range(100, 120);\n\t\t\t \n\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x0117);\n\t\t} else if (mux == LO_MUX_3RD_DAC) {\n\t\t\t \n\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x3113);\n\t\t\t \n\t\t\tif (priv->dev_counter[DEVICE_HP] == 0)\n\t\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON9, 0x0001);\n\t\t\t \n\t\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON7, 0x311b);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON7,\n\t\t\t\t   RG_AUDLOLMUXINPUTSEL_VAUDP32_MASK_SFT,\n\t\t\t\t   LO_MUX_OPEN);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t\t   0x000f, 0x0000);\n\n\t\tif (mux == LO_MUX_L_DAC) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t\t\t   0x3 << 4, 0x0);\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t\t\t   0x3 << 6, 0x0);\n\t\t}\n\n\t\t \n\t\tmt6359_set_decoder_clk(priv, false);\n\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON1, DL_GAIN_N_40DB);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON7,\n\t\t\t\t   RG_AUDLOLPWRUP_VAUDP32_MASK_SFT, 0x0);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON7,\n\t\t\t\t   RG_AUDLOLPWRUP_IBIAS_VAUDP32_MASK_SFT, 0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_adc_clk_gen_event(struct snd_soc_dapm_widget *w,\n\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\tint event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKRSTB_MASK_SFT,\n\t\t\t\t   0x1 << RG_AUDADCCLKRSTB_SFT);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKSOURCE_MASK_SFT, 0x0);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKSEL_MASK_SFT, 0x0);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKGENMODE_MASK_SFT,\n\t\t\t\t   0x1 << RG_AUDADCCLKGENMODE_SFT);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKSOURCE_MASK_SFT, 0x0);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKSEL_MASK_SFT, 0x0);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKGENMODE_MASK_SFT, 0x0);\n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON5,\n\t\t\t\t   RG_AUDADCCLKRSTB_MASK_SFT, 0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_dcc_clk_event(struct snd_soc_dapm_widget *w,\n\t\t\t    struct snd_kcontrol *kcontrol,\n\t\t\t    int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_DCCLK_CFG0,\n\t\t\t\t   0xfff7, 0x2062);\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_DCCLK_CFG0,\n\t\t\t\t   0xfff7, 0x2060);\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_DCCLK_CFG0,\n\t\t\t\t   0xfff7, 0x2061);\n\n\t\tregmap_write(priv->regmap, MT6359_AFE_DCCLK_CFG1, 0x0100);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_DCCLK_CFG0,\n\t\t\t\t   0xfff7, 0x2060);\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_DCCLK_CFG0,\n\t\t\t\t   0xfff7, 0x2062);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_mic_bias_0_event(struct snd_soc_dapm_widget *w,\n\t\t\t       struct snd_kcontrol *kcontrol,\n\t\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mic_type = priv->mux_select[MUX_MIC_TYPE_0];\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, mic_type %d\\n\",\n\t\t__func__, event, mic_type);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tswitch (mic_type) {\n\t\tcase MIC_TYPE_MUX_DCC_ECM_DIFF:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON15,\n\t\t\t\t\t   0xff00, 0x7700);\n\t\t\tbreak;\n\t\tcase MIC_TYPE_MUX_DCC_ECM_SINGLE:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON15,\n\t\t\t\t\t   0xff00, 0x1100);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON15,\n\t\t\t\t\t   0xff00, 0x0000);\n\t\t\tbreak;\n\t\t}\n\n\t\t \n\t\tregmap_write(priv->regmap,\n\t\t\t     MT6359_AUDENC_ANA_CON14, 0x0004);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON15,\n\t\t\t\t   RG_AUDMICBIAS0VREF_MASK_SFT,\n\t\t\t\t   MIC_BIAS_1P9 << RG_AUDMICBIAS0VREF_SFT);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON15,\n\t\t\t\t   RG_AUDMICBIAS0LOWPEN_MASK_SFT,\n\t\t\t\t   0 << RG_AUDMICBIAS0LOWPEN_SFT);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDENC_ANA_CON15, 0x0000);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_mic_bias_1_event(struct snd_soc_dapm_widget *w,\n\t\t\t       struct snd_kcontrol *kcontrol,\n\t\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mic_type = priv->mux_select[MUX_MIC_TYPE_1];\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, mic_type %d\\n\",\n\t\t__func__, event, mic_type);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tif (mic_type == MIC_TYPE_MUX_DCC_ECM_SINGLE)\n\t\t\tregmap_write(priv->regmap,\n\t\t\t\t     MT6359_AUDENC_ANA_CON16, 0x0160);\n\t\telse\n\t\t\tregmap_write(priv->regmap,\n\t\t\t\t     MT6359_AUDENC_ANA_CON16, 0x0060);\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON16,\n\t\t\t\t   RG_AUDMICBIAS1LOWPEN_MASK_SFT,\n\t\t\t\t   0 << RG_AUDMICBIAS1LOWPEN_SFT);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_mic_bias_2_event(struct snd_soc_dapm_widget *w,\n\t\t\t       struct snd_kcontrol *kcontrol,\n\t\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mic_type = priv->mux_select[MUX_MIC_TYPE_2];\n\n\tdev_dbg(priv->dev, \"%s(), event 0x%x, mic_type %d\\n\",\n\t\t__func__, event, mic_type);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tswitch (mic_type) {\n\t\tcase MIC_TYPE_MUX_DCC_ECM_DIFF:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON17,\n\t\t\t\t\t   0xff00, 0x7700);\n\t\t\tbreak;\n\t\tcase MIC_TYPE_MUX_DCC_ECM_SINGLE:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON17,\n\t\t\t\t\t   0xff00, 0x1100);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tregmap_update_bits(priv->regmap,\n\t\t\t\t\t   MT6359_AUDENC_ANA_CON17,\n\t\t\t\t\t   0xff00, 0x0000);\n\t\t\tbreak;\n\t\t}\n\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON17,\n\t\t\t\t   RG_AUDMICBIAS2VREF_MASK_SFT,\n\t\t\t\t   MIC_BIAS_1P9 << RG_AUDMICBIAS2VREF_SFT);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON17,\n\t\t\t\t   RG_AUDMICBIAS2LOWPEN_MASK_SFT,\n\t\t\t\t   0 << RG_AUDMICBIAS2LOWPEN_SFT);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDENC_ANA_CON17, 0x0000);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_mtkaif_tx_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tmt6359_mtkaif_tx_enable(priv);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tmt6359_mtkaif_tx_disable(priv);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_ul_src_dmic_event(struct snd_soc_dapm_widget *w,\n\t\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\t\tint event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tif (priv->dmic_one_wire_mode)\n\t\t\tregmap_write(priv->regmap, MT6359_AFE_UL_SRC_CON0_H,\n\t\t\t\t     0x0400);\n\t\telse\n\t\t\tregmap_write(priv->regmap, MT6359_AFE_UL_SRC_CON0_H,\n\t\t\t\t     0x0080);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_UL_SRC_CON0_L,\n\t\t\t\t   0xfffc, 0x0000);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tregmap_write(priv->regmap,\n\t\t\t     MT6359_AFE_UL_SRC_CON0_H, 0x0000);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_ul_src_34_dmic_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t   struct snd_kcontrol *kcontrol,\n\t\t\t\t   int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap,\n\t\t\t     MT6359_AFE_ADDA6_L_SRC_CON0_H, 0x0080);\n\t\tregmap_update_bits(priv->regmap, MT6359_AFE_ADDA6_UL_SRC_CON0_L,\n\t\t\t\t   0xfffc, 0x0000);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tregmap_write(priv->regmap,\n\t\t\t     MT6359_AFE_ADDA6_L_SRC_CON0_H, 0x0000);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_adc_l_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tusleep_range(100, 120);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON0,\n\t\t\t\t   RG_AUDPREAMPLDCPRECHARGE_MASK_SFT,\n\t\t\t\t   0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_adc_r_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tusleep_range(100, 120);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON1,\n\t\t\t\t   RG_AUDPREAMPRDCPRECHARGE_MASK_SFT,\n\t\t\t\t   0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_adc_3_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s(), event = 0x%x\\n\", __func__, event);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tusleep_range(100, 120);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON2,\n\t\t\t\t   RG_AUDPREAMP3DCPRECHARGE_MASK_SFT,\n\t\t\t\t   0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_pga_l_mux_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mux = dapm_kcontrol_get_value(w->kcontrols[0]);\n\n\tdev_dbg(priv->dev, \"%s(), mux %d\\n\", __func__, mux);\n\tpriv->mux_select[MUX_PGA_L] = mux >> RG_AUDPREAMPLINPUTSEL_SFT;\n\treturn 0;\n}\n\nstatic int mt_pga_r_mux_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mux = dapm_kcontrol_get_value(w->kcontrols[0]);\n\n\tdev_dbg(priv->dev, \"%s(), mux %d\\n\", __func__, mux);\n\tpriv->mux_select[MUX_PGA_R] = mux >> RG_AUDPREAMPRINPUTSEL_SFT;\n\treturn 0;\n}\n\nstatic int mt_pga_3_mux_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int mux = dapm_kcontrol_get_value(w->kcontrols[0]);\n\n\tdev_dbg(priv->dev, \"%s(), mux %d\\n\", __func__, mux);\n\tpriv->mux_select[MUX_PGA_3] = mux >> RG_AUDPREAMP3INPUTSEL_SFT;\n\treturn 0;\n}\n\nstatic int mt_pga_l_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tint mic_gain_l = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP1];\n\tunsigned int mux_pga = priv->mux_select[MUX_PGA_L];\n\tunsigned int mic_type;\n\n\tswitch (mux_pga) {\n\tcase PGA_L_MUX_AIN0:\n\t\tmic_type = priv->mux_select[MUX_MIC_TYPE_0];\n\t\tbreak;\n\tcase PGA_L_MUX_AIN1:\n\t\tmic_type = priv->mux_select[MUX_MIC_TYPE_1];\n\t\tbreak;\n\tdefault:\n\t\tdev_err(priv->dev, \"%s(), invalid pga mux %d\\n\",\n\t\t\t__func__, mux_pga);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON0,\n\t\t\t\t\t   RG_AUDPREAMPLDCPRECHARGE_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMPLDCPRECHARGE_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON0,\n\t\t\t\t   RG_AUDPREAMPLGAIN_MASK_SFT,\n\t\t\t\t   mic_gain_l << RG_AUDPREAMPLGAIN_SFT);\n\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON0,\n\t\t\t\t\t   RG_AUDPREAMPLDCCEN_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMPLDCCEN_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON0,\n\t\t\t\t   RG_AUDPREAMPLDCCEN_MASK_SFT,\n\t\t\t\t   0x0 << RG_AUDPREAMPLDCCEN_SFT);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_pga_r_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tint mic_gain_r = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP2];\n\tunsigned int mux_pga = priv->mux_select[MUX_PGA_R];\n\tunsigned int mic_type;\n\n\tswitch (mux_pga) {\n\tcase PGA_R_MUX_AIN0:\n\t\tmic_type = priv->mux_select[MUX_MIC_TYPE_0];\n\t\tbreak;\n\tcase PGA_R_MUX_AIN2:\n\tcase PGA_R_MUX_AIN3:\n\t\tmic_type = priv->mux_select[MUX_MIC_TYPE_2];\n\t\tbreak;\n\tdefault:\n\t\tdev_err(priv->dev, \"%s(), invalid pga mux %d\\n\",\n\t\t\t__func__, mux_pga);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON1,\n\t\t\t\t\t   RG_AUDPREAMPRDCPRECHARGE_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMPRDCPRECHARGE_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON1,\n\t\t\t\t   RG_AUDPREAMPRGAIN_MASK_SFT,\n\t\t\t\t   mic_gain_r << RG_AUDPREAMPRGAIN_SFT);\n\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON1,\n\t\t\t\t\t   RG_AUDPREAMPRDCCEN_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMPRDCCEN_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON1,\n\t\t\t\t   RG_AUDPREAMPRDCCEN_MASK_SFT,\n\t\t\t\t   0x0 << RG_AUDPREAMPRDCCEN_SFT);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_pga_3_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol,\n\t\t\t  int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tint mic_gain_3 = priv->ana_gain[AUDIO_ANALOG_VOLUME_MICAMP3];\n\tunsigned int mux_pga = priv->mux_select[MUX_PGA_3];\n\tunsigned int mic_type;\n\n\tswitch (mux_pga) {\n\tcase PGA_3_MUX_AIN2:\n\tcase PGA_3_MUX_AIN3:\n\t\tmic_type = priv->mux_select[MUX_MIC_TYPE_2];\n\t\tbreak;\n\tdefault:\n\t\tdev_err(priv->dev, \"%s(), invalid pga mux %d\\n\",\n\t\t\t__func__, mux_pga);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON2,\n\t\t\t\t\t   RG_AUDPREAMP3DCPRECHARGE_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMP3DCPRECHARGE_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON2,\n\t\t\t\t   RG_AUDPREAMP3GAIN_MASK_SFT,\n\t\t\t\t   mic_gain_3 << RG_AUDPREAMP3GAIN_SFT);\n\n\t\tif (IS_DCC_BASE(mic_type)) {\n\t\t\t \n\t\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON2,\n\t\t\t\t\t   RG_AUDPREAMP3DCCEN_MASK_SFT,\n\t\t\t\t\t   0x1 << RG_AUDPREAMP3DCCEN_SFT);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON2,\n\t\t\t\t   RG_AUDPREAMP3DCCEN_MASK_SFT,\n\t\t\t\t   0x0 << RG_AUDPREAMP3DCCEN_SFT);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n \nstatic int mt_delay_250_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tusleep_range(250, 270);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_delay_100_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol,\n\t\t\t      int event)\n{\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tusleep_range(100, 120);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_hp_pull_down_event(struct snd_soc_dapm_widget *w,\n\t\t\t\t struct snd_kcontrol *kcontrol,\n\t\t\t\t int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\thp_pull_down(priv, true);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\thp_pull_down(priv, false);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_hp_mute_event(struct snd_soc_dapm_widget *w,\n\t\t\t    struct snd_kcontrol *kcontrol,\n\t\t\t    int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON2, DL_GAIN_N_22DB_REG);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_ZCD_CON2, DL_GAIN_N_40DB_REG);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_hp_damp_event(struct snd_soc_dapm_widget *w,\n\t\t\t    struct snd_kcontrol *kcontrol,\n\t\t\t    int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AUDDEC_ANA_CON10, 0x0000);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_esd_resist_event(struct snd_soc_dapm_widget *w,\n\t\t\t       struct snd_kcontrol *kcontrol,\n\t\t\t       int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON2,\n\t\t\t\t   RG_AUDREFN_DERES_EN_VAUDP32_MASK_SFT,\n\t\t\t\t   0x1 << RG_AUDREFN_DERES_EN_VAUDP32_SFT);\n\t\tusleep_range(250, 270);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON2,\n\t\t\t\t   RG_AUDREFN_DERES_EN_VAUDP32_MASK_SFT, 0x0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_sdm_event(struct snd_soc_dapm_widget *w,\n\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\tint event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFUNC_AUD_CON2,\n\t\t\t\t   0xfffd, 0x0006);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON0, 0xcba1);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFUNC_AUD_CON2,\n\t\t\t\t   0xfffd, 0x0003);\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFUNC_AUD_CON2,\n\t\t\t\t   0xfffd, 0x000B);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_update_bits(priv->regmap, MT6359_AFUNC_AUD_CON2,\n\t\t\t\t   0xfffd, 0x0000);\n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON0, 0xcba0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_sdm_3rd_event(struct snd_soc_dapm_widget *w,\n\t\t\t    struct snd_kcontrol *kcontrol,\n\t\t\t    int event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON11, 0x0006);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON9, 0xcba1);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON11, 0x0003);\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON11, 0x000b);\n\t\tbreak;\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\t \n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON11, 0x0000);\n\t\tregmap_write(priv->regmap, MT6359_AFUNC_AUD_CON9, 0xcba0);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt_ncp_event(struct snd_soc_dapm_widget *w,\n\t\t\tstruct snd_kcontrol *kcontrol,\n\t\t\tint event)\n{\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tregmap_write(priv->regmap, MT6359_AFE_NCP_CFG0, 0xc800);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n \nstatic const struct snd_soc_dapm_widget mt6359_dapm_widgets[] = {\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"CLK_BUF\", SUPPLY_SEQ_CLK_BUF,\n\t\t\t      MT6359_DCXO_CW12,\n\t\t\t      RG_XO_AUDIO_EN_M_SFT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDGLB\", SUPPLY_SEQ_AUD_GLB,\n\t\t\t      MT6359_AUDDEC_ANA_CON13,\n\t\t\t      RG_AUDGLB_PWRDN_VA32_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"CLKSQ Audio\", SUPPLY_SEQ_CLKSQ,\n\t\t\t      MT6359_AUDENC_ANA_CON23,\n\t\t\t      RG_CLKSQ_EN_SFT, 0, NULL, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDNCP_CK\", SUPPLY_SEQ_TOP_CK,\n\t\t\t      MT6359_AUD_TOP_CKPDN_CON0,\n\t\t\t      RG_AUDNCP_CK_PDN_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ZCD13M_CK\", SUPPLY_SEQ_TOP_CK,\n\t\t\t      MT6359_AUD_TOP_CKPDN_CON0,\n\t\t\t      RG_ZCD13M_CK_PDN_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUD_CK\", SUPPLY_SEQ_TOP_CK_LAST,\n\t\t\t      MT6359_AUD_TOP_CKPDN_CON0,\n\t\t\t      RG_AUD_CK_PDN_SFT, 1, mt_delay_250_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIF_CK\", SUPPLY_SEQ_TOP_CK,\n\t\t\t      MT6359_AUD_TOP_CKPDN_CON0,\n\t\t\t      RG_AUDIF_CK_PDN_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_REGULATOR_SUPPLY(\"vaud18\", 0, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_AFE_CTL\", SUPPLY_SEQ_AUD_TOP_LAST,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_AFE_CTL_SFT, 1,\n\t\t\t      mt_delay_250_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_DAC_CTL\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_DAC_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_ADC_CTL\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_ADC_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_ADDA6_ADC_CTL\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_ADDA6_ADC_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_I2S_DL\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_I2S_DL_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_PWR_CLK\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PWR_CLK_DIS_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_PDN_AFE_TESTMODEL\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_AFE_TESTMODEL_CTL_SFT, 1, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"AUDIO_TOP_PDN_RESERVED\", SUPPLY_SEQ_AUD_TOP,\n\t\t\t      MT6359_AUDIO_TOP_CON0,\n\t\t\t      PDN_RESERVED_SFT, 1, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"SDM\", SUPPLY_SEQ_DL_SDM,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_sdm_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"SDM_3RD\", SUPPLY_SEQ_DL_SDM,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_sdm_3rd_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"SDM_FIFO_CLK\", SUPPLY_SEQ_DL_SDM_FIFO_CLK,\n\t\t\t      MT6359_AFUNC_AUD_CON2,\n\t\t\t      CCI_AFIFO_CLK_PWDB_SFT, 0,\n\t\t\t      NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"NCP\", SUPPLY_SEQ_DL_NCP,\n\t\t\t      MT6359_AFE_NCP_CFG0,\n\t\t\t      RG_NCP_ON_SFT, 0,\n\t\t\t      mt_ncp_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU),\n\n\tSND_SOC_DAPM_SUPPLY(\"DL Digital Clock\", SND_SOC_NOPM,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DL Digital Clock CH_1_2\", SND_SOC_NOPM,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DL Digital Clock CH_3\", SND_SOC_NOPM,\n\t\t\t    0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"AFE_ON\", SUPPLY_SEQ_AFE,\n\t\t\t      MT6359_AFE_UL_DL_CON0, AFE_ON_SFT, 0,\n\t\t\t      NULL, 0),\n\n\t \n\tSND_SOC_DAPM_AIF_IN(\"AIF_RX\", \"AIF1 Playback\", 0,\n\t\t\t    SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_AIF_IN(\"AIF2_RX\", \"AIF2 Playback\", 0,\n\t\t\t    SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"AFE_DL_SRC\", SUPPLY_SEQ_DL_SRC,\n\t\t\t      MT6359_AFE_DL_SRC2_CON0_L,\n\t\t\t      DL_2_SRC_ON_TMP_CTL_PRE_SFT, 0,\n\t\t\t      NULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"DL Power Supply\", SND_SOC_NOPM,\n\t\t\t    0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"ESD_RESIST\", SUPPLY_SEQ_DL_ESD_RESIST,\n\t\t\t      SND_SOC_NOPM,\n\t\t\t      0, 0,\n\t\t\t      mt_esd_resist_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"LDO\", SUPPLY_SEQ_DL_LDO,\n\t\t\t      MT6359_AUDDEC_ANA_CON14,\n\t\t\t      RG_LCLDO_DEC_EN_VA32_SFT, 0,\n\t\t\t      NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"LDO_REMOTE\", SUPPLY_SEQ_DL_LDO_REMOTE_SENSE,\n\t\t\t      MT6359_AUDDEC_ANA_CON14,\n\t\t\t      RG_LCLDO_DEC_REMOTE_SENSE_VA18_SFT, 0,\n\t\t\t      NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"NV_REGULATOR\", SUPPLY_SEQ_DL_NV,\n\t\t\t      MT6359_AUDDEC_ANA_CON14,\n\t\t\t      RG_NVREG_EN_VAUDP32_SFT, 0,\n\t\t\t      mt_delay_100_event, SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_SUPPLY_S(\"IBIST\", SUPPLY_SEQ_DL_IBIST,\n\t\t\t      MT6359_AUDDEC_ANA_CON12,\n\t\t\t      RG_AUDIBIASPWRDN_VAUDP32_SFT, 1,\n\t\t\t      NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"DAC In Mux\", SND_SOC_NOPM, 0, 0, &dac_in_mux_control),\n\n\tSND_SOC_DAPM_DAC(\"DACL\", NULL, SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_DAC(\"DACR\", NULL, SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_DAC(\"DAC_3RD\", NULL, SND_SOC_NOPM, 0, 0),\n\n\t \n\tSND_SOC_DAPM_MUX_E(\"HP Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &hp_in_mux_control,\n\t\t\t   mt_hp_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD),\n\n\tSND_SOC_DAPM_SUPPLY(\"HP_Supply\", SND_SOC_NOPM,\n\t\t\t    0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"HP_PULL_DOWN\", SUPPLY_SEQ_HP_PULL_DOWN,\n\t\t\t      SND_SOC_NOPM,\n\t\t\t      0, 0,\n\t\t\t      mt_hp_pull_down_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"HP_MUTE\", SUPPLY_SEQ_HP_MUTE,\n\t\t\t      SND_SOC_NOPM,\n\t\t\t      0, 0,\n\t\t\t      mt_hp_mute_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"HP_DAMP\", SUPPLY_SEQ_HP_DAMPING_OFF_RESET_CMFB,\n\t\t\t      SND_SOC_NOPM,\n\t\t\t      0, 0,\n\t\t\t      mt_hp_damp_event,\n\t\t\t      SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_MUX_E(\"RCV Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &rcv_in_mux_control,\n\t\t\t   mt_rcv_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD),\n\n\t \n\tSND_SOC_DAPM_MUX_E(\"LOL Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &lo_in_mux_control,\n\t\t\t   mt_lo_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD),\n\n\t \n\tSND_SOC_DAPM_OUTPUT(\"Receiver\"),\n\tSND_SOC_DAPM_OUTPUT(\"Headphone L\"),\n\tSND_SOC_DAPM_OUTPUT(\"Headphone R\"),\n\tSND_SOC_DAPM_OUTPUT(\"Headphone L Ext Spk Amp\"),\n\tSND_SOC_DAPM_OUTPUT(\"Headphone R Ext Spk Amp\"),\n\tSND_SOC_DAPM_OUTPUT(\"LINEOUT L\"),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"SGEN DL Enable\", MT6359_AFE_SGEN_CFG0,\n\t\t\t    SGEN_DAC_EN_CTL_SFT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"SGEN MUTE\", MT6359_AFE_SGEN_CFG0,\n\t\t\t    SGEN_MUTE_SW_CTL_SFT, 1,\n\t\t\t    mt_sgen_event,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"SGEN DL SRC\", MT6359_AFE_DL_SRC2_CON0_L,\n\t\t\t    DL_2_SRC_ON_TMP_CTL_PRE_SFT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_INPUT(\"SGEN DL\"),\n\n\t \n\tSND_SOC_DAPM_AIF_OUT(\"AIF1TX\", \"AIF1 Capture\", 0,\n\t\t\t     SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AIF2TX\", \"AIF2 Capture\", 0,\n\t\t\t     SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC_CLKGEN\", SUPPLY_SEQ_ADC_CLKGEN,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_adc_clk_gen_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_PRE_PMD),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"DCC_CLK\", SUPPLY_SEQ_DCC_CLK,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_dcc_clk_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_MUX(\"AIF Out Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &aif_out_mux_control),\n\n\tSND_SOC_DAPM_MUX(\"AIF2 Out Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &aif2_out_mux_control),\n\n\tSND_SOC_DAPM_SUPPLY(\"AIFTX_Supply\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"MTKAIF_TX\", SUPPLY_SEQ_UL_MTKAIF,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_mtkaif_tx_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"UL_SRC\", SUPPLY_SEQ_UL_SRC,\n\t\t\t      MT6359_AFE_UL_SRC_CON0_L,\n\t\t\t      UL_SRC_ON_TMP_CTL_SFT, 0,\n\t\t\t      NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"UL_SRC_DMIC\", SUPPLY_SEQ_UL_SRC_DMIC,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_ul_src_dmic_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"UL_SRC_34\", SUPPLY_SEQ_UL_SRC,\n\t\t\t      MT6359_AFE_ADDA6_UL_SRC_CON0_L,\n\t\t\t      ADDA6_UL_SRC_ON_TMP_CTL_SFT, 0,\n\t\t\t      NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"UL_SRC_34_DMIC\", SUPPLY_SEQ_UL_SRC_DMIC,\n\t\t\t      SND_SOC_NOPM, 0, 0,\n\t\t\t      mt_ul_src_34_dmic_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\tSND_SOC_DAPM_MUX(\"MISO0_MUX\", SND_SOC_NOPM, 0, 0, &miso0_mux_control),\n\tSND_SOC_DAPM_MUX(\"MISO1_MUX\", SND_SOC_NOPM, 0, 0, &miso1_mux_control),\n\tSND_SOC_DAPM_MUX(\"MISO2_MUX\", SND_SOC_NOPM, 0, 0, &miso2_mux_control),\n\n\tSND_SOC_DAPM_MUX(\"UL_SRC_MUX\", SND_SOC_NOPM, 0, 0,\n\t\t\t &ul_src_mux_control),\n\tSND_SOC_DAPM_MUX(\"UL2_SRC_MUX\", SND_SOC_NOPM, 0, 0,\n\t\t\t &ul2_src_mux_control),\n\n\tSND_SOC_DAPM_MUX(\"DMIC0_MUX\", SND_SOC_NOPM, 0, 0, &dmic0_mux_control),\n\tSND_SOC_DAPM_MUX(\"DMIC1_MUX\", SND_SOC_NOPM, 0, 0, &dmic1_mux_control),\n\tSND_SOC_DAPM_MUX(\"DMIC2_MUX\", SND_SOC_NOPM, 0, 0, &dmic2_mux_control),\n\n\tSND_SOC_DAPM_MUX_E(\"ADC_L_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &adc_left_mux_control, NULL, 0),\n\tSND_SOC_DAPM_MUX_E(\"ADC_R_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &adc_right_mux_control, NULL, 0),\n\tSND_SOC_DAPM_MUX_E(\"ADC_3_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &adc_3_mux_control, NULL, 0),\n\n\tSND_SOC_DAPM_ADC(\"ADC_L\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_ADC(\"ADC_R\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_ADC(\"ADC_3\", NULL, SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC_L_EN\", SUPPLY_SEQ_UL_ADC,\n\t\t\t      MT6359_AUDENC_ANA_CON0,\n\t\t\t      RG_AUDADCLPWRUP_SFT, 0,\n\t\t\t      mt_adc_l_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC_R_EN\", SUPPLY_SEQ_UL_ADC,\n\t\t\t      MT6359_AUDENC_ANA_CON1,\n\t\t\t      RG_AUDADCRPWRUP_SFT, 0,\n\t\t\t      mt_adc_r_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC_3_EN\", SUPPLY_SEQ_UL_ADC,\n\t\t\t      MT6359_AUDENC_ANA_CON2,\n\t\t\t      RG_AUDADC3PWRUP_SFT, 0,\n\t\t\t      mt_adc_3_event,\n\t\t\t      SND_SOC_DAPM_POST_PMU),\n\n\tSND_SOC_DAPM_MUX_E(\"PGA_L_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &pga_left_mux_control,\n\t\t\t   mt_pga_l_mux_event,\n\t\t\t   SND_SOC_DAPM_WILL_PMU),\n\tSND_SOC_DAPM_MUX_E(\"PGA_R_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &pga_right_mux_control,\n\t\t\t   mt_pga_r_mux_event,\n\t\t\t   SND_SOC_DAPM_WILL_PMU),\n\tSND_SOC_DAPM_MUX_E(\"PGA_3_Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t   &pga_3_mux_control,\n\t\t\t   mt_pga_3_mux_event,\n\t\t\t   SND_SOC_DAPM_WILL_PMU),\n\n\tSND_SOC_DAPM_PGA(\"PGA_L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"PGA_R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"PGA_3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY_S(\"PGA_L_EN\", SUPPLY_SEQ_UL_PGA,\n\t\t\t      MT6359_AUDENC_ANA_CON0,\n\t\t\t      RG_AUDPREAMPLON_SFT, 0,\n\t\t\t      mt_pga_l_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"PGA_R_EN\", SUPPLY_SEQ_UL_PGA,\n\t\t\t      MT6359_AUDENC_ANA_CON1,\n\t\t\t      RG_AUDPREAMPRON_SFT, 0,\n\t\t\t      mt_pga_r_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"PGA_3_EN\", SUPPLY_SEQ_UL_PGA,\n\t\t\t      MT6359_AUDENC_ANA_CON2,\n\t\t\t      RG_AUDPREAMP3ON_SFT, 0,\n\t\t\t      mt_pga_3_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMU |\n\t\t\t      SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_INPUT(\"AIN0\"),\n\tSND_SOC_DAPM_INPUT(\"AIN1\"),\n\tSND_SOC_DAPM_INPUT(\"AIN2\"),\n\tSND_SOC_DAPM_INPUT(\"AIN3\"),\n\n\tSND_SOC_DAPM_INPUT(\"AIN0_DMIC\"),\n\tSND_SOC_DAPM_INPUT(\"AIN2_DMIC\"),\n\tSND_SOC_DAPM_INPUT(\"AIN3_DMIC\"),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"MIC_BIAS_0\", SUPPLY_SEQ_MIC_BIAS,\n\t\t\t      MT6359_AUDENC_ANA_CON15,\n\t\t\t      RG_AUDPWDBMICBIAS0_SFT, 0,\n\t\t\t      mt_mic_bias_0_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY_S(\"MIC_BIAS_1\", SUPPLY_SEQ_MIC_BIAS,\n\t\t\t      MT6359_AUDENC_ANA_CON16,\n\t\t\t      RG_AUDPWDBMICBIAS1_SFT, 0,\n\t\t\t      mt_mic_bias_1_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_SUPPLY_S(\"MIC_BIAS_2\", SUPPLY_SEQ_MIC_BIAS,\n\t\t\t      MT6359_AUDENC_ANA_CON17,\n\t\t\t      RG_AUDPWDBMICBIAS2_SFT, 0,\n\t\t\t      mt_mic_bias_2_event,\n\t\t\t      SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC_0\", SUPPLY_SEQ_DMIC,\n\t\t\t      MT6359_AUDENC_ANA_CON13,\n\t\t\t      RG_AUDDIGMICEN_SFT, 0,\n\t\t\t      NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC_1\", SUPPLY_SEQ_DMIC,\n\t\t\t      MT6359_AUDENC_ANA_CON14,\n\t\t\t      RG_AUDDIGMIC1EN_SFT, 0,\n\t\t\t      NULL, 0),\n};\n\nstatic int mt_dcc_clk_connect(struct snd_soc_dapm_widget *source,\n\t\t\t      struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_dapm_widget *w = sink;\n\tstruct snd_soc_component *cmpnt = snd_soc_dapm_to_component(w->dapm);\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tif (IS_DCC_BASE(priv->mux_select[MUX_MIC_TYPE_0]) ||\n\t    IS_DCC_BASE(priv->mux_select[MUX_MIC_TYPE_1]) ||\n\t    IS_DCC_BASE(priv->mux_select[MUX_MIC_TYPE_2]))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_route mt6359_dapm_routes[] = {\n\t \n\t{\"AIFTX_Supply\", NULL, \"CLK_BUF\"},\n\t{\"AIFTX_Supply\", NULL, \"vaud18\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDGLB\"},\n\t{\"AIFTX_Supply\", NULL, \"CLKSQ Audio\"},\n\t{\"AIFTX_Supply\", NULL, \"AUD_CK\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIF_CK\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_AFE_CTL\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_PWR_CLK\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_PDN_RESERVED\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_I2S_DL\"},\n\t \n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_ADC_CTL\"},\n\t{\"AIFTX_Supply\", NULL, \"AUDIO_TOP_ADDA6_ADC_CTL\"},\n\t{\"AIFTX_Supply\", NULL, \"AFE_ON\"},\n\n\t \n\t{\"AIF1TX\", NULL, \"AIF Out Mux\"},\n\t{\"AIF1TX\", NULL, \"AIFTX_Supply\"},\n\t{\"AIF1TX\", NULL, \"MTKAIF_TX\"},\n\n\t{\"AIF2TX\", NULL, \"AIF2 Out Mux\"},\n\t{\"AIF2TX\", NULL, \"AIFTX_Supply\"},\n\t{\"AIF2TX\", NULL, \"MTKAIF_TX\"},\n\n\t{\"AIF Out Mux\", \"Normal Path\", \"MISO0_MUX\"},\n\t{\"AIF Out Mux\", \"Normal Path\", \"MISO1_MUX\"},\n\t{\"AIF2 Out Mux\", \"Normal Path\", \"MISO2_MUX\"},\n\n\t{\"MISO0_MUX\", \"UL1_CH1\", \"UL_SRC_MUX\"},\n\t{\"MISO0_MUX\", \"UL1_CH2\", \"UL_SRC_MUX\"},\n\t{\"MISO0_MUX\", \"UL2_CH1\", \"UL2_SRC_MUX\"},\n\t{\"MISO0_MUX\", \"UL2_CH2\", \"UL2_SRC_MUX\"},\n\n\t{\"MISO1_MUX\", \"UL1_CH1\", \"UL_SRC_MUX\"},\n\t{\"MISO1_MUX\", \"UL1_CH2\", \"UL_SRC_MUX\"},\n\t{\"MISO1_MUX\", \"UL2_CH1\", \"UL2_SRC_MUX\"},\n\t{\"MISO1_MUX\", \"UL2_CH2\", \"UL2_SRC_MUX\"},\n\n\t{\"MISO2_MUX\", \"UL1_CH1\", \"UL_SRC_MUX\"},\n\t{\"MISO2_MUX\", \"UL1_CH2\", \"UL_SRC_MUX\"},\n\t{\"MISO2_MUX\", \"UL2_CH1\", \"UL2_SRC_MUX\"},\n\t{\"MISO2_MUX\", \"UL2_CH2\", \"UL2_SRC_MUX\"},\n\n\t{\"MISO0_MUX\", NULL, \"UL_SRC\"},\n\t{\"MISO1_MUX\", NULL, \"UL_SRC\"},\n\t{\"MISO2_MUX\", NULL, \"UL_SRC_34\"},\n\n\t{\"UL_SRC_MUX\", \"AMIC\", \"ADC_L\"},\n\t{\"UL_SRC_MUX\", \"AMIC\", \"ADC_R\"},\n\t{\"UL_SRC_MUX\", \"DMIC\", \"DMIC0_MUX\"},\n\t{\"UL_SRC_MUX\", \"DMIC\", \"DMIC1_MUX\"},\n\t{\"UL_SRC_MUX\", NULL, \"UL_SRC\"},\n\n\t{\"UL2_SRC_MUX\", \"AMIC\", \"ADC_3\"},\n\t{\"UL2_SRC_MUX\", \"DMIC\", \"DMIC2_MUX\"},\n\t{\"UL2_SRC_MUX\", NULL, \"UL_SRC_34\"},\n\n\t{\"DMIC0_MUX\", \"DMIC_DATA0\", \"AIN0_DMIC\"},\n\t{\"DMIC0_MUX\", \"DMIC_DATA1_L\", \"AIN2_DMIC\"},\n\t{\"DMIC0_MUX\", \"DMIC_DATA1_L_1\", \"AIN2_DMIC\"},\n\t{\"DMIC0_MUX\", \"DMIC_DATA1_R\", \"AIN3_DMIC\"},\n\t{\"DMIC1_MUX\", \"DMIC_DATA0\", \"AIN0_DMIC\"},\n\t{\"DMIC1_MUX\", \"DMIC_DATA1_L\", \"AIN2_DMIC\"},\n\t{\"DMIC1_MUX\", \"DMIC_DATA1_L_1\", \"AIN2_DMIC\"},\n\t{\"DMIC1_MUX\", \"DMIC_DATA1_R\", \"AIN3_DMIC\"},\n\t{\"DMIC2_MUX\", \"DMIC_DATA0\", \"AIN0_DMIC\"},\n\t{\"DMIC2_MUX\", \"DMIC_DATA1_L\", \"AIN2_DMIC\"},\n\t{\"DMIC2_MUX\", \"DMIC_DATA1_L_1\", \"AIN2_DMIC\"},\n\t{\"DMIC2_MUX\", \"DMIC_DATA1_R\", \"AIN3_DMIC\"},\n\n\t{\"DMIC0_MUX\", NULL, \"UL_SRC_DMIC\"},\n\t{\"DMIC1_MUX\", NULL, \"UL_SRC_DMIC\"},\n\t{\"DMIC2_MUX\", NULL, \"UL_SRC_34_DMIC\"},\n\n\t{\"AIN0_DMIC\", NULL, \"DMIC_0\"},\n\t{\"AIN2_DMIC\", NULL, \"DMIC_1\"},\n\t{\"AIN3_DMIC\", NULL, \"DMIC_1\"},\n\t{\"AIN0_DMIC\", NULL, \"MIC_BIAS_0\"},\n\t{\"AIN2_DMIC\", NULL, \"MIC_BIAS_2\"},\n\t{\"AIN3_DMIC\", NULL, \"MIC_BIAS_2\"},\n\n\t \n\t{\"ADC_L\", NULL, \"ADC_L_Mux\"},\n\t{\"ADC_L\", NULL, \"ADC_CLKGEN\"},\n\t{\"ADC_L\", NULL, \"ADC_L_EN\"},\n\t{\"ADC_R\", NULL, \"ADC_R_Mux\"},\n\t{\"ADC_R\", NULL, \"ADC_CLKGEN\"},\n\t{\"ADC_R\", NULL, \"ADC_R_EN\"},\n\t \n\t{\"ADC_R\", NULL, \"ADC_L_EN\"},\n\t{\"ADC_3\", NULL, \"ADC_3_Mux\"},\n\t{\"ADC_3\", NULL, \"ADC_CLKGEN\"},\n\t{\"ADC_3\", NULL, \"ADC_3_EN\"},\n\n\t{\"ADC_L_Mux\", \"Left Preamplifier\", \"PGA_L\"},\n\t{\"ADC_R_Mux\", \"Right Preamplifier\", \"PGA_R\"},\n\t{\"ADC_3_Mux\", \"Preamplifier\", \"PGA_3\"},\n\n\t{\"PGA_L\", NULL, \"PGA_L_Mux\"},\n\t{\"PGA_L\", NULL, \"PGA_L_EN\"},\n\t{\"PGA_R\", NULL, \"PGA_R_Mux\"},\n\t{\"PGA_R\", NULL, \"PGA_R_EN\"},\n\t{\"PGA_3\", NULL, \"PGA_3_Mux\"},\n\t{\"PGA_3\", NULL, \"PGA_3_EN\"},\n\n\t{\"PGA_L\", NULL, \"DCC_CLK\", mt_dcc_clk_connect},\n\t{\"PGA_R\", NULL, \"DCC_CLK\", mt_dcc_clk_connect},\n\t{\"PGA_3\", NULL, \"DCC_CLK\", mt_dcc_clk_connect},\n\n\t{\"PGA_L_Mux\", \"AIN0\", \"AIN0\"},\n\t{\"PGA_L_Mux\", \"AIN1\", \"AIN1\"},\n\n\t{\"PGA_R_Mux\", \"AIN0\", \"AIN0\"},\n\t{\"PGA_R_Mux\", \"AIN2\", \"AIN2\"},\n\t{\"PGA_R_Mux\", \"AIN3\", \"AIN3\"},\n\n\t{\"PGA_3_Mux\", \"AIN2\", \"AIN2\"},\n\t{\"PGA_3_Mux\", \"AIN3\", \"AIN3\"},\n\n\t{\"AIN0\", NULL, \"MIC_BIAS_0\"},\n\t{\"AIN1\", NULL, \"MIC_BIAS_1\"},\n\t{\"AIN2\", NULL, \"MIC_BIAS_0\"},\n\t{\"AIN2\", NULL, \"MIC_BIAS_2\"},\n\t{\"AIN3\", NULL, \"MIC_BIAS_2\"},\n\n\t \n\t{\"DL Power Supply\", NULL, \"CLK_BUF\"},\n\t{\"DL Power Supply\", NULL, \"vaud18\"},\n\t{\"DL Power Supply\", NULL, \"AUDGLB\"},\n\t{\"DL Power Supply\", NULL, \"CLKSQ Audio\"},\n\t{\"DL Power Supply\", NULL, \"AUDNCP_CK\"},\n\t{\"DL Power Supply\", NULL, \"ZCD13M_CK\"},\n\t{\"DL Power Supply\", NULL, \"AUD_CK\"},\n\t{\"DL Power Supply\", NULL, \"AUDIF_CK\"},\n\t{\"DL Power Supply\", NULL, \"ESD_RESIST\"},\n\t{\"DL Power Supply\", NULL, \"LDO\"},\n\t{\"DL Power Supply\", NULL, \"LDO_REMOTE\"},\n\t{\"DL Power Supply\", NULL, \"NV_REGULATOR\"},\n\t{\"DL Power Supply\", NULL, \"IBIST\"},\n\n\t \n\t{\"DL Digital Clock\", NULL, \"AUDIO_TOP_AFE_CTL\"},\n\t{\"DL Digital Clock\", NULL, \"AUDIO_TOP_DAC_CTL\"},\n\t{\"DL Digital Clock\", NULL, \"AUDIO_TOP_PWR_CLK\"},\n\t{\"DL Digital Clock\", NULL, \"AUDIO_TOP_PDN_RESERVED\"},\n\t{\"DL Digital Clock\", NULL, \"SDM_FIFO_CLK\"},\n\t{\"DL Digital Clock\", NULL, \"NCP\"},\n\t{\"DL Digital Clock\", NULL, \"AFE_ON\"},\n\t{\"DL Digital Clock\", NULL, \"AFE_DL_SRC\"},\n\n\t{\"DL Digital Clock CH_1_2\", NULL, \"DL Digital Clock\"},\n\t{\"DL Digital Clock CH_1_2\", NULL, \"SDM\"},\n\n\t{\"DL Digital Clock CH_3\", NULL, \"DL Digital Clock\"},\n\t{\"DL Digital Clock CH_3\", NULL, \"SDM_3RD\"},\n\n\t{\"AIF_RX\", NULL, \"DL Digital Clock CH_1_2\"},\n\n\t{\"AIF2_RX\", NULL, \"DL Digital Clock CH_3\"},\n\n\t \n\t{\"DAC In Mux\", \"Normal Path\", \"AIF_RX\"},\n\t{\"DAC In Mux\", \"Sgen\", \"SGEN DL\"},\n\t{\"SGEN DL\", NULL, \"SGEN DL SRC\"},\n\t{\"SGEN DL\", NULL, \"SGEN MUTE\"},\n\t{\"SGEN DL\", NULL, \"SGEN DL Enable\"},\n\t{\"SGEN DL\", NULL, \"DL Digital Clock CH_1_2\"},\n\t{\"SGEN DL\", NULL, \"DL Digital Clock CH_3\"},\n\t{\"SGEN DL\", NULL, \"AUDIO_TOP_PDN_AFE_TESTMODEL\"},\n\n\t{\"DACL\", NULL, \"DAC In Mux\"},\n\t{\"DACL\", NULL, \"DL Power Supply\"},\n\n\t{\"DACR\", NULL, \"DAC In Mux\"},\n\t{\"DACR\", NULL, \"DL Power Supply\"},\n\n\t \n\t{\"DAC In Mux\", \"Normal Path\", \"AIF2_RX\"},\n\t{\"DAC_3RD\", NULL, \"DAC In Mux\"},\n\t{\"DAC_3RD\", NULL, \"DL Power Supply\"},\n\n\t \n\t{\"LOL Mux\", \"Playback\", \"DAC_3RD\"},\n\t{\"LOL Mux\", \"Playback_L_DAC\", \"DACL\"},\n\t{\"LINEOUT L\", NULL, \"LOL Mux\"},\n\n\t \n\t{\"HP_Supply\", NULL, \"HP_PULL_DOWN\"},\n\t{\"HP_Supply\", NULL, \"HP_MUTE\"},\n\t{\"HP_Supply\", NULL, \"HP_DAMP\"},\n\t{\"HP Mux\", NULL, \"HP_Supply\"},\n\n\t{\"HP Mux\", \"Audio Playback\", \"DACL\"},\n\t{\"HP Mux\", \"Audio Playback\", \"DACR\"},\n\t{\"HP Mux\", \"HP Impedance\", \"DACL\"},\n\t{\"HP Mux\", \"HP Impedance\", \"DACR\"},\n\t{\"HP Mux\", \"LoudSPK Playback\", \"DACL\"},\n\t{\"HP Mux\", \"LoudSPK Playback\", \"DACR\"},\n\n\t{\"Headphone L\", NULL, \"HP Mux\"},\n\t{\"Headphone R\", NULL, \"HP Mux\"},\n\t{\"Headphone L Ext Spk Amp\", NULL, \"HP Mux\"},\n\t{\"Headphone R Ext Spk Amp\", NULL, \"HP Mux\"},\n\n\t \n\t{\"RCV Mux\", \"Voice Playback\", \"DACL\"},\n\t{\"Receiver\", NULL, \"RCV Mux\"},\n};\n\nstatic int mt6359_codec_dai_hw_params(struct snd_pcm_substream *substream,\n\t\t\t\t      struct snd_pcm_hw_params *params,\n\t\t\t\t      struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *cmpnt = dai->component;\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\tunsigned int rate = params_rate(params);\n\tint id = dai->id;\n\n\tdev_dbg(priv->dev, \"%s(), id %d, substream->stream %d, rate %d, number %d\\n\",\n\t\t__func__, id, substream->stream, rate, substream->number);\n\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\n\t\tpriv->dl_rate[id] = rate;\n\telse if (substream->stream == SNDRV_PCM_STREAM_CAPTURE)\n\t\tpriv->ul_rate[id] = rate;\n\n\treturn 0;\n}\n\nstatic int mt6359_codec_dai_startup(struct snd_pcm_substream *substream,\n\t\t\t\t    struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *cmpnt = dai->component;\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s stream %d\\n\", __func__, substream->stream);\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\n\t\tmt6359_set_playback_gpio(priv);\n\telse if (substream->stream == SNDRV_PCM_STREAM_CAPTURE)\n\t\tmt6359_set_capture_gpio(priv);\n\n\treturn 0;\n}\n\nstatic void mt6359_codec_dai_shutdown(struct snd_pcm_substream *substream,\n\t\t\t\t      struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *cmpnt = dai->component;\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tdev_dbg(priv->dev, \"%s stream %d\\n\", __func__, substream->stream);\n\tif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\n\t\tmt6359_reset_playback_gpio(priv);\n\telse if (substream->stream == SNDRV_PCM_STREAM_CAPTURE)\n\t\tmt6359_reset_capture_gpio(priv);\n}\n\nstatic const struct snd_soc_dai_ops mt6359_codec_dai_ops = {\n\t.hw_params = mt6359_codec_dai_hw_params,\n\t.startup = mt6359_codec_dai_startup,\n\t.shutdown = mt6359_codec_dai_shutdown,\n};\n\n#define MT6359_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_U16_LE |\\\n\t\t\tSNDRV_PCM_FMTBIT_S24_LE | SNDRV_PCM_FMTBIT_U24_LE |\\\n\t\t\tSNDRV_PCM_FMTBIT_S32_LE | SNDRV_PCM_FMTBIT_U32_LE)\n\nstatic struct snd_soc_dai_driver mt6359_dai_driver[] = {\n\t{\n\t\t.id = MT6359_AIF_1,\n\t\t.name = \"mt6359-snd-codec-aif1\",\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF1 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = SNDRV_PCM_RATE_8000_48000 |\n\t\t\t\t SNDRV_PCM_RATE_96000 |\n\t\t\t\t SNDRV_PCM_RATE_192000,\n\t\t\t.formats = MT6359_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF1 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = SNDRV_PCM_RATE_8000 |\n\t\t\t\t SNDRV_PCM_RATE_16000 |\n\t\t\t\t SNDRV_PCM_RATE_32000 |\n\t\t\t\t SNDRV_PCM_RATE_48000 |\n\t\t\t\t SNDRV_PCM_RATE_96000 |\n\t\t\t\t SNDRV_PCM_RATE_192000,\n\t\t\t.formats = MT6359_FORMATS,\n\t\t},\n\t\t.ops = &mt6359_codec_dai_ops,\n\t},\n\t{\n\t\t.id = MT6359_AIF_2,\n\t\t.name = \"mt6359-snd-codec-aif2\",\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF2 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = SNDRV_PCM_RATE_8000_48000 |\n\t\t\t\t SNDRV_PCM_RATE_96000 |\n\t\t\t\t SNDRV_PCM_RATE_192000,\n\t\t\t.formats = MT6359_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF2 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = SNDRV_PCM_RATE_8000 |\n\t\t\t\t SNDRV_PCM_RATE_16000 |\n\t\t\t\t SNDRV_PCM_RATE_32000 |\n\t\t\t\t SNDRV_PCM_RATE_48000,\n\t\t\t.formats = MT6359_FORMATS,\n\t\t},\n\t\t.ops = &mt6359_codec_dai_ops,\n\t},\n};\n\nstatic int mt6359_codec_init_reg(struct snd_soc_component *cmpnt)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_DCXO_CW12,\n\t\t\t   0x1 << RG_XO_AUDIO_EN_M_SFT,\n\t\t\t   0x1 << RG_XO_AUDIO_EN_M_SFT);\n\n\t \n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDENC_ANA_CON23,\n\t\t\t   RG_CLKSQ_IN_SEL_TEST_MASK_SFT,\n\t\t\t   0x0);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   RG_AUDHPLSCDISABLE_VAUDP32_MASK_SFT,\n\t\t\t   0x1 << RG_AUDHPLSCDISABLE_VAUDP32_SFT);\n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON0,\n\t\t\t   RG_AUDHPRSCDISABLE_VAUDP32_MASK_SFT,\n\t\t\t   0x1 << RG_AUDHPRSCDISABLE_VAUDP32_SFT);\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON6,\n\t\t\t   RG_AUDHSSCDISABLE_VAUDP32_MASK_SFT,\n\t\t\t   0x1 << RG_AUDHSSCDISABLE_VAUDP32_SFT);\n\t \n\tregmap_update_bits(priv->regmap, MT6359_AUDDEC_ANA_CON7,\n\t\t\t   RG_AUDLOLSCDISABLE_VAUDP32_MASK_SFT,\n\t\t\t   0x1 << RG_AUDLOLSCDISABLE_VAUDP32_SFT);\n\n\t \n\tmt6359_set_gpio_smt(priv);\n\tmt6359_set_gpio_driving(priv);\n\tmt6359_reset_playback_gpio(priv);\n\tmt6359_reset_capture_gpio(priv);\n\n\t \n\tpriv->hp_hifi_mode = 0;\n\n\t \n\tzcd_disable(priv);\n\n\t \n\tregmap_update_bits(priv->regmap, MT6359_DCXO_CW12,\n\t\t\t   0x1 << RG_XO_AUDIO_EN_M_SFT,\n\t\t\t   0x0 << RG_XO_AUDIO_EN_M_SFT);\n\n\treturn 0;\n}\n\nstatic int mt6359_codec_probe(struct snd_soc_component *cmpnt)\n{\n\tstruct mt6359_priv *priv = snd_soc_component_get_drvdata(cmpnt);\n\n\tsnd_soc_component_init_regmap(cmpnt, priv->regmap);\n\n\treturn mt6359_codec_init_reg(cmpnt);\n}\n\nstatic void mt6359_codec_remove(struct snd_soc_component *cmpnt)\n{\n\tcmpnt->regmap = NULL;\n}\n\nstatic const DECLARE_TLV_DB_SCALE(playback_tlv, -1000, 100, 0);\nstatic const DECLARE_TLV_DB_SCALE(capture_tlv, 0, 600, 0);\n\nstatic const struct snd_kcontrol_new mt6359_snd_controls[] = {\n\t \n\tSOC_DOUBLE_EXT_TLV(\"Headset Volume\",\n\t\t\t   MT6359_ZCD_CON2, 0, 7, 0x12, 0,\n\t\t\t   mt6359_get_playback_volsw, mt6359_put_volsw,\n\t\t\t   playback_tlv),\n\tSOC_DOUBLE_EXT_TLV(\"Lineout Volume\",\n\t\t\t   MT6359_ZCD_CON1, 0, 7, 0x12, 0,\n\t\t\t   mt6359_get_playback_volsw, mt6359_put_volsw,\n\t\t\t   playback_tlv),\n\tSOC_SINGLE_EXT_TLV(\"Handset Volume\",\n\t\t\t   MT6359_ZCD_CON3, 0, 0x12, 0,\n\t\t\t   mt6359_get_playback_volsw, mt6359_put_volsw,\n\t\t\t   playback_tlv),\n\n\t \n\tSOC_SINGLE_EXT_TLV(\"PGA1 Volume\",\n\t\t\t   MT6359_AUDENC_ANA_CON0, RG_AUDPREAMPLGAIN_SFT, 4, 0,\n\t\t\t   snd_soc_get_volsw, mt6359_put_volsw, capture_tlv),\n\tSOC_SINGLE_EXT_TLV(\"PGA2 Volume\",\n\t\t\t   MT6359_AUDENC_ANA_CON1, RG_AUDPREAMPRGAIN_SFT, 4, 0,\n\t\t\t   snd_soc_get_volsw, mt6359_put_volsw, capture_tlv),\n\tSOC_SINGLE_EXT_TLV(\"PGA3 Volume\",\n\t\t\t   MT6359_AUDENC_ANA_CON2, RG_AUDPREAMP3GAIN_SFT, 4, 0,\n\t\t\t   snd_soc_get_volsw, mt6359_put_volsw, capture_tlv),\n};\n\nstatic const struct snd_soc_component_driver mt6359_soc_component_driver = {\n\t.name = CODEC_MT6359_NAME,\n\t.probe = mt6359_codec_probe,\n\t.remove = mt6359_codec_remove,\n\t.controls = mt6359_snd_controls,\n\t.num_controls = ARRAY_SIZE(mt6359_snd_controls),\n\t.dapm_widgets = mt6359_dapm_widgets,\n\t.num_dapm_widgets = ARRAY_SIZE(mt6359_dapm_widgets),\n\t.dapm_routes = mt6359_dapm_routes,\n\t.num_dapm_routes = ARRAY_SIZE(mt6359_dapm_routes),\n\t.endianness = 1,\n};\n\nstatic int mt6359_parse_dt(struct mt6359_priv *priv)\n{\n\tint ret;\n\tstruct device *dev = priv->dev;\n\tstruct device_node *np;\n\n\tnp = of_get_child_by_name(dev->parent->of_node, \"mt6359codec\");\n\tif (!np)\n\t\treturn -EINVAL;\n\n\tret = of_property_read_u32(np, \"mediatek,dmic-mode\",\n\t\t\t\t   &priv->dmic_one_wire_mode);\n\tif (ret) {\n\t\tdev_info(priv->dev,\n\t\t\t \"%s() failed to read dmic-mode, use default (0)\\n\",\n\t\t\t __func__);\n\t\tpriv->dmic_one_wire_mode = 0;\n\t}\n\n\tret = of_property_read_u32(np, \"mediatek,mic-type-0\",\n\t\t\t\t   &priv->mux_select[MUX_MIC_TYPE_0]);\n\tif (ret) {\n\t\tdev_info(priv->dev,\n\t\t\t \"%s() failed to read mic-type-0, use default (%d)\\n\",\n\t\t\t __func__, MIC_TYPE_MUX_IDLE);\n\t\tpriv->mux_select[MUX_MIC_TYPE_0] = MIC_TYPE_MUX_IDLE;\n\t}\n\n\tret = of_property_read_u32(np, \"mediatek,mic-type-1\",\n\t\t\t\t   &priv->mux_select[MUX_MIC_TYPE_1]);\n\tif (ret) {\n\t\tdev_info(priv->dev,\n\t\t\t \"%s() failed to read mic-type-1, use default (%d)\\n\",\n\t\t\t __func__, MIC_TYPE_MUX_IDLE);\n\t\tpriv->mux_select[MUX_MIC_TYPE_1] = MIC_TYPE_MUX_IDLE;\n\t}\n\n\tret = of_property_read_u32(np, \"mediatek,mic-type-2\",\n\t\t\t\t   &priv->mux_select[MUX_MIC_TYPE_2]);\n\tof_node_put(np);\n\tif (ret) {\n\t\tdev_info(priv->dev,\n\t\t\t \"%s() failed to read mic-type-2, use default (%d)\\n\",\n\t\t\t __func__, MIC_TYPE_MUX_IDLE);\n\t\tpriv->mux_select[MUX_MIC_TYPE_2] = MIC_TYPE_MUX_IDLE;\n\t}\n\n\treturn 0;\n}\n\nstatic int mt6359_platform_driver_probe(struct platform_device *pdev)\n{\n\tstruct mt6359_priv *priv;\n\tint ret;\n\tstruct mt6397_chip *mt6397 = dev_get_drvdata(pdev->dev.parent);\n\n\tdev_dbg(&pdev->dev, \"%s(), dev name %s\\n\",\n\t\t__func__, dev_name(&pdev->dev));\n\n\tpriv = devm_kzalloc(&pdev->dev, sizeof(*priv), GFP_KERNEL);\n\tif (!priv)\n\t\treturn -ENOMEM;\n\n\tpriv->regmap = mt6397->regmap;\n\tif (IS_ERR(priv->regmap))\n\t\treturn PTR_ERR(priv->regmap);\n\n\tdev_set_drvdata(&pdev->dev, priv);\n\tpriv->dev = &pdev->dev;\n\n\tret = mt6359_parse_dt(priv);\n\tif (ret) {\n\t\tdev_warn(&pdev->dev, \"%s() failed to parse dts\\n\", __func__);\n\t\treturn ret;\n\t}\n\n\treturn devm_snd_soc_register_component(&pdev->dev,\n\t\t\t\t\t       &mt6359_soc_component_driver,\n\t\t\t\t\t       mt6359_dai_driver,\n\t\t\t\t\t       ARRAY_SIZE(mt6359_dai_driver));\n}\n\nstatic struct platform_driver mt6359_platform_driver = {\n\t.driver = {\n\t\t.name = \"mt6359-sound\",\n\t},\n\t.probe = mt6359_platform_driver_probe,\n};\n\nmodule_platform_driver(mt6359_platform_driver)\n\n \nMODULE_DESCRIPTION(\"MT6359 ALSA SoC codec driver\");\nMODULE_AUTHOR(\"KaiChieh Chuang <kaichieh.chuang@mediatek.com>\");\nMODULE_AUTHOR(\"Eason Yen <eason.yen@mediatek.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}