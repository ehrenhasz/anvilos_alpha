{
  "module_name": "adau1781.c",
  "hash_id": "a88c599b0f137b24a533f7f92facab25e8bc7f98550391911475832ba7664085",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/adau1781.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/i2c.h>\n#include <linux/spi/spi.h>\n#include <linux/slab.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n#include <linux/platform_data/adau17x1.h>\n\n#include \"adau17x1.h\"\n#include \"adau1781.h\"\n\n#define ADAU1781_DMIC_BEEP_CTRL\t\t0x4008\n#define ADAU1781_LEFT_PGA\t\t0x400e\n#define ADAU1781_RIGHT_PGA\t\t0x400f\n#define ADAU1781_LEFT_PLAYBACK_MIXER\t0x401c\n#define ADAU1781_RIGHT_PLAYBACK_MIXER\t0x401e\n#define ADAU1781_MONO_PLAYBACK_MIXER\t0x401f\n#define ADAU1781_LEFT_LINEOUT\t\t0x4025\n#define ADAU1781_RIGHT_LINEOUT\t\t0x4026\n#define ADAU1781_SPEAKER\t\t0x4027\n#define ADAU1781_BEEP_ZC\t\t0x4028\n#define ADAU1781_DEJITTER\t\t0x4032\n#define ADAU1781_DIG_PWDN0\t\t0x4080\n#define ADAU1781_DIG_PWDN1\t\t0x4081\n\n#define ADAU1781_INPUT_DIFFERNTIAL BIT(3)\n\n#define ADAU1381_FIRMWARE \"adau1381.bin\"\n#define ADAU1781_FIRMWARE \"adau1781.bin\"\n\nstatic const struct reg_default adau1781_reg_defaults[] = {\n\t{ ADAU1781_DMIC_BEEP_CTRL,\t\t0x00 },\n\t{ ADAU1781_LEFT_PGA,\t\t\t0xc7 },\n\t{ ADAU1781_RIGHT_PGA,\t\t\t0xc7 },\n\t{ ADAU1781_LEFT_PLAYBACK_MIXER,\t\t0x00 },\n\t{ ADAU1781_RIGHT_PLAYBACK_MIXER,\t0x00 },\n\t{ ADAU1781_MONO_PLAYBACK_MIXER,\t\t0x00 },\n\t{ ADAU1781_LEFT_LINEOUT,\t\t0x00 },\n\t{ ADAU1781_RIGHT_LINEOUT,\t\t0x00 },\n\t{ ADAU1781_SPEAKER,\t\t\t0x00 },\n\t{ ADAU1781_BEEP_ZC,\t\t\t0x19 },\n\t{ ADAU1781_DEJITTER,\t\t\t0x60 },\n\t{ ADAU1781_DIG_PWDN1,\t\t\t0x0c },\n\t{ ADAU1781_DIG_PWDN1,\t\t\t0x00 },\n\t{ ADAU17X1_CLOCK_CONTROL,\t\t0x00 },\n\t{ ADAU17X1_PLL_CONTROL,\t\t\t0x00 },\n\t{ ADAU17X1_REC_POWER_MGMT,\t\t0x00 },\n\t{ ADAU17X1_MICBIAS,\t\t\t0x04 },\n\t{ ADAU17X1_SERIAL_PORT0,\t\t0x00 },\n\t{ ADAU17X1_SERIAL_PORT1,\t\t0x00 },\n\t{ ADAU17X1_CONVERTER0,\t\t\t0x00 },\n\t{ ADAU17X1_CONVERTER1,\t\t\t0x00 },\n\t{ ADAU17X1_LEFT_INPUT_DIGITAL_VOL,\t0x00 },\n\t{ ADAU17X1_RIGHT_INPUT_DIGITAL_VOL,\t0x00 },\n\t{ ADAU17X1_ADC_CONTROL,\t\t\t0x00 },\n\t{ ADAU17X1_PLAY_POWER_MGMT,\t\t0x00 },\n\t{ ADAU17X1_DAC_CONTROL0,\t\t0x00 },\n\t{ ADAU17X1_DAC_CONTROL1,\t\t0x00 },\n\t{ ADAU17X1_DAC_CONTROL2,\t\t0x00 },\n\t{ ADAU17X1_SERIAL_PORT_PAD,\t\t0x00 },\n\t{ ADAU17X1_CONTROL_PORT_PAD0,\t\t0x00 },\n\t{ ADAU17X1_CONTROL_PORT_PAD1,\t\t0x00 },\n\t{ ADAU17X1_DSP_SAMPLING_RATE,\t\t0x01 },\n\t{ ADAU17X1_SERIAL_INPUT_ROUTE,\t\t0x00 },\n\t{ ADAU17X1_SERIAL_OUTPUT_ROUTE,\t\t0x00 },\n\t{ ADAU17X1_DSP_ENABLE,\t\t\t0x00 },\n\t{ ADAU17X1_DSP_RUN,\t\t\t0x00 },\n\t{ ADAU17X1_SERIAL_SAMPLING_RATE,\t0x00 },\n};\n\nstatic const DECLARE_TLV_DB_SCALE(adau1781_speaker_tlv, 0, 200, 0);\n\nstatic const DECLARE_TLV_DB_RANGE(adau1781_pga_tlv,\n\t0, 1, TLV_DB_SCALE_ITEM(0, 600, 0),\n\t2, 3, TLV_DB_SCALE_ITEM(1000, 400, 0),\n\t4, 4, TLV_DB_SCALE_ITEM(1700, 0, 0),\n\t5, 7, TLV_DB_SCALE_ITEM(2000, 600, 0)\n);\n\nstatic const DECLARE_TLV_DB_RANGE(adau1781_beep_tlv,\n\t0, 1, TLV_DB_SCALE_ITEM(0, 600, 0),\n\t2, 3, TLV_DB_SCALE_ITEM(1000, 400, 0),\n\t4, 4, TLV_DB_SCALE_ITEM(-2300, 0, 0),\n\t5, 7, TLV_DB_SCALE_ITEM(2000, 600, 0)\n);\n\nstatic const DECLARE_TLV_DB_SCALE(adau1781_sidetone_tlv, -1800, 300, 1);\n\nstatic const char * const adau1781_speaker_bias_select_text[] = {\n\t\"Normal operation\", \"Power saving\", \"Enhanced performance\",\n};\n\nstatic const char * const adau1781_bias_select_text[] = {\n\t\"Normal operation\", \"Extreme power saving\", \"Power saving\",\n\t\"Enhanced performance\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(adau1781_adc_bias_enum,\n\t\tADAU17X1_REC_POWER_MGMT, 3, adau1781_bias_select_text);\nstatic SOC_ENUM_SINGLE_DECL(adau1781_speaker_bias_enum,\n\t\tADAU17X1_PLAY_POWER_MGMT, 6, adau1781_speaker_bias_select_text);\nstatic SOC_ENUM_SINGLE_DECL(adau1781_dac_bias_enum,\n\t\tADAU17X1_PLAY_POWER_MGMT, 4, adau1781_bias_select_text);\nstatic SOC_ENUM_SINGLE_DECL(adau1781_playback_bias_enum,\n\t\tADAU17X1_PLAY_POWER_MGMT, 2, adau1781_bias_select_text);\nstatic SOC_ENUM_SINGLE_DECL(adau1781_capture_bias_enum,\n\t\tADAU17X1_REC_POWER_MGMT, 1, adau1781_bias_select_text);\n\nstatic const struct snd_kcontrol_new adau1781_controls[] = {\n\tSOC_SINGLE_TLV(\"Beep Capture Volume\", ADAU1781_DMIC_BEEP_CTRL, 0, 7, 0,\n\t\tadau1781_beep_tlv),\n\tSOC_DOUBLE_R_TLV(\"PGA Capture Volume\", ADAU1781_LEFT_PGA,\n\t\tADAU1781_RIGHT_PGA, 5, 7, 0, adau1781_pga_tlv),\n\tSOC_DOUBLE_R(\"PGA Capture Switch\", ADAU1781_LEFT_PGA,\n\t\tADAU1781_RIGHT_PGA, 1, 1, 0),\n\n\tSOC_DOUBLE_R(\"Lineout Playback Switch\", ADAU1781_LEFT_LINEOUT,\n\t\tADAU1781_RIGHT_LINEOUT, 1, 1, 0),\n\tSOC_SINGLE(\"Beep ZC Switch\", ADAU1781_BEEP_ZC, 0, 1, 0),\n\n\tSOC_SINGLE(\"Mono Playback Switch\", ADAU1781_MONO_PLAYBACK_MIXER,\n\t\t0, 1, 0),\n\tSOC_SINGLE_TLV(\"Mono Playback Volume\", ADAU1781_SPEAKER, 6, 3, 0,\n\t\tadau1781_speaker_tlv),\n\n\tSOC_ENUM(\"ADC Bias\", adau1781_adc_bias_enum),\n\tSOC_ENUM(\"DAC Bias\", adau1781_dac_bias_enum),\n\tSOC_ENUM(\"Capture Bias\", adau1781_capture_bias_enum),\n\tSOC_ENUM(\"Playback Bias\", adau1781_playback_bias_enum),\n\tSOC_ENUM(\"Speaker Bias\", adau1781_speaker_bias_enum),\n};\n\nstatic const struct snd_kcontrol_new adau1781_beep_mixer_controls[] = {\n\tSOC_DAPM_SINGLE(\"Beep Capture Switch\", ADAU1781_DMIC_BEEP_CTRL,\n\t\t3, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new adau1781_left_mixer_controls[] = {\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\",\n\t\tADAU1781_LEFT_PLAYBACK_MIXER, 5, 1, 0),\n\tSOC_DAPM_SINGLE_TLV(\"Beep Playback Volume\",\n\t\tADAU1781_LEFT_PLAYBACK_MIXER, 1, 8, 0, adau1781_sidetone_tlv),\n};\n\nstatic const struct snd_kcontrol_new adau1781_right_mixer_controls[] = {\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\",\n\t\tADAU1781_RIGHT_PLAYBACK_MIXER, 6, 1, 0),\n\tSOC_DAPM_SINGLE_TLV(\"Beep Playback Volume\",\n\t\tADAU1781_LEFT_PLAYBACK_MIXER, 1, 8, 0, adau1781_sidetone_tlv),\n};\n\nstatic const struct snd_kcontrol_new adau1781_mono_mixer_controls[] = {\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Left Switch\",\n\t\tADAU1781_MONO_PLAYBACK_MIXER, 7, 1, 0),\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Right Switch\",\n\t\t ADAU1781_MONO_PLAYBACK_MIXER, 6, 1, 0),\n\tSOC_DAPM_SINGLE_TLV(\"Beep Playback Volume\",\n\t\tADAU1781_MONO_PLAYBACK_MIXER, 2, 8, 0, adau1781_sidetone_tlv),\n};\n\nstatic int adau1781_dejitter_fixup(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct adau *adau = snd_soc_component_get_drvdata(component);\n\n\t \n\tregmap_write(adau->regmap, ADAU1781_DEJITTER, 0);\n\tif (!adau->master)\n\t\tregmap_write(adau->regmap, ADAU1781_DEJITTER, 5);\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget adau1781_dapm_widgets[] = {\n\tSND_SOC_DAPM_PGA(\"Left PGA\", ADAU1781_LEFT_PGA, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Right PGA\", ADAU1781_RIGHT_PGA, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_OUT_DRV(\"Speaker\", ADAU1781_SPEAKER, 0, 0, NULL, 0),\n\n\tSOC_MIXER_NAMED_CTL_ARRAY(\"Beep Mixer\", ADAU17X1_MICBIAS, 4, 0,\n\t\tadau1781_beep_mixer_controls),\n\n\tSOC_MIXER_ARRAY(\"Left Lineout Mixer\", SND_SOC_NOPM, 0, 0,\n\t\tadau1781_left_mixer_controls),\n\tSOC_MIXER_ARRAY(\"Right Lineout Mixer\", SND_SOC_NOPM, 0, 0,\n\t\tadau1781_right_mixer_controls),\n\tSOC_MIXER_ARRAY(\"Mono Mixer\", SND_SOC_NOPM, 0, 0,\n\t\tadau1781_mono_mixer_controls),\n\n\tSND_SOC_DAPM_SUPPLY(\"Serial Input Routing\", ADAU1781_DIG_PWDN0,\n\t\t2, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Serial Output Routing\", ADAU1781_DIG_PWDN0,\n\t\t3, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Clock Domain Transfer\", ADAU1781_DIG_PWDN0,\n\t\t5, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Serial Ports\", ADAU1781_DIG_PWDN0, 4, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"ADC Engine\", ADAU1781_DIG_PWDN0, 7, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DAC Engine\", ADAU1781_DIG_PWDN1, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Digital Mic\", ADAU1781_DIG_PWDN1, 1, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"Sound Engine\", ADAU1781_DIG_PWDN0, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"SYSCLK\", 1, ADAU1781_DIG_PWDN0, 1, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"Zero Crossing Detector\", ADAU1781_DIG_PWDN1, 2, 0,\n\t\tNULL, 0),\n\n\tSND_SOC_DAPM_POST(\"Dejitter fixup\", adau1781_dejitter_fixup),\n\n\tSND_SOC_DAPM_INPUT(\"BEEP\"),\n\n\tSND_SOC_DAPM_OUTPUT(\"AOUTL\"),\n\tSND_SOC_DAPM_OUTPUT(\"AOUTR\"),\n\tSND_SOC_DAPM_OUTPUT(\"SP\"),\n\tSND_SOC_DAPM_INPUT(\"LMIC\"),\n\tSND_SOC_DAPM_INPUT(\"RMIC\"),\n};\n\nstatic const struct snd_soc_dapm_route adau1781_dapm_routes[] = {\n\t{ \"Left Lineout Mixer\", NULL, \"Left Playback Enable\" },\n\t{ \"Right Lineout Mixer\", NULL, \"Right Playback Enable\" },\n\n\t{ \"Left Lineout Mixer\", \"Beep Playback Volume\", \"Beep Mixer\" },\n\t{ \"Left Lineout Mixer\", \"Switch\", \"Left DAC\" },\n\n\t{ \"Right Lineout Mixer\", \"Beep Playback Volume\", \"Beep Mixer\" },\n\t{ \"Right Lineout Mixer\", \"Switch\", \"Right DAC\" },\n\n\t{ \"Mono Mixer\", \"Beep Playback Volume\", \"Beep Mixer\" },\n\t{ \"Mono Mixer\", \"Right Switch\", \"Right DAC\" },\n\t{ \"Mono Mixer\", \"Left Switch\", \"Left DAC\" },\n\t{ \"Speaker\", NULL, \"Mono Mixer\" },\n\n\t{ \"Mono Mixer\", NULL, \"SYSCLK\" },\n\t{ \"Left Lineout Mixer\", NULL, \"SYSCLK\" },\n\t{ \"Left Lineout Mixer\", NULL, \"SYSCLK\" },\n\n\t{ \"Beep Mixer\", \"Beep Capture Switch\", \"BEEP\" },\n\t{ \"Beep Mixer\", NULL, \"Zero Crossing Detector\" },\n\n\t{ \"Left DAC\", NULL, \"DAC Engine\" },\n\t{ \"Right DAC\", NULL, \"DAC Engine\" },\n\n\t{ \"Sound Engine\", NULL, \"SYSCLK\" },\n\t{ \"DSP\", NULL, \"Sound Engine\" },\n\n\t{ \"Left Decimator\", NULL, \"ADC Engine\" },\n\t{ \"Right Decimator\", NULL, \"ADC Engine\" },\n\n\t{ \"AIFCLK\", NULL, \"SYSCLK\" },\n\n\t{ \"Playback\", NULL, \"Serial Input Routing\" },\n\t{ \"Playback\", NULL, \"Serial Ports\" },\n\t{ \"Playback\", NULL, \"Clock Domain Transfer\" },\n\t{ \"Capture\", NULL, \"Serial Output Routing\" },\n\t{ \"Capture\", NULL, \"Serial Ports\" },\n\t{ \"Capture\", NULL, \"Clock Domain Transfer\" },\n\n\t{ \"AOUTL\", NULL, \"Left Lineout Mixer\" },\n\t{ \"AOUTR\", NULL, \"Right Lineout Mixer\" },\n\t{ \"SP\", NULL, \"Speaker\" },\n};\n\nstatic const struct snd_soc_dapm_route adau1781_adc_dapm_routes[] = {\n\t{ \"Left PGA\", NULL, \"LMIC\" },\n\t{ \"Right PGA\", NULL, \"RMIC\" },\n\n\t{ \"Left Decimator\", NULL, \"Left PGA\" },\n\t{ \"Right Decimator\", NULL, \"Right PGA\" },\n};\n\nstatic const char * const adau1781_dmic_select_text[] = {\n\t\"DMIC1\", \"DMIC2\",\n};\n\nstatic SOC_ENUM_SINGLE_VIRT_DECL(adau1781_dmic_select_enum,\n\tadau1781_dmic_select_text);\n\nstatic const struct snd_kcontrol_new adau1781_dmic_mux =\n\tSOC_DAPM_ENUM(\"DMIC Select\", adau1781_dmic_select_enum);\n\nstatic const struct snd_soc_dapm_widget adau1781_dmic_dapm_widgets[] = {\n\tSND_SOC_DAPM_MUX(\"DMIC Select\", SND_SOC_NOPM, 0, 0, &adau1781_dmic_mux),\n\n\tSND_SOC_DAPM_ADC(\"DMIC1\", NULL, ADAU1781_DMIC_BEEP_CTRL, 4, 0),\n\tSND_SOC_DAPM_ADC(\"DMIC2\", NULL, ADAU1781_DMIC_BEEP_CTRL, 5, 0),\n};\n\nstatic const struct snd_soc_dapm_route adau1781_dmic_dapm_routes[] = {\n\t{ \"DMIC1\", NULL, \"LMIC\" },\n\t{ \"DMIC2\", NULL, \"RMIC\" },\n\n\t{ \"DMIC1\", NULL, \"Digital Mic\" },\n\t{ \"DMIC2\", NULL, \"Digital Mic\" },\n\n\t{ \"DMIC Select\", \"DMIC1\", \"DMIC1\" },\n\t{ \"DMIC Select\", \"DMIC2\", \"DMIC2\" },\n\n\t{ \"Left Decimator\", NULL, \"DMIC Select\" },\n\t{ \"Right Decimator\", NULL, \"DMIC Select\" },\n};\n\nstatic int adau1781_set_bias_level(struct snd_soc_component *component,\n\t\tenum snd_soc_bias_level level)\n{\n\tstruct adau *adau = snd_soc_component_get_drvdata(component);\n\n\tswitch (level) {\n\tcase SND_SOC_BIAS_ON:\n\t\tbreak;\n\tcase SND_SOC_BIAS_PREPARE:\n\t\tbreak;\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tregmap_update_bits(adau->regmap, ADAU17X1_CLOCK_CONTROL,\n\t\t\tADAU17X1_CLOCK_CONTROL_SYSCLK_EN,\n\t\t\tADAU17X1_CLOCK_CONTROL_SYSCLK_EN);\n\n\t\t \n\t\tregmap_update_bits(adau->regmap, ADAU1781_DIG_PWDN1, 0x8, 0x8);\n\t\tbreak;\n\tcase SND_SOC_BIAS_OFF:\n\t\tregmap_update_bits(adau->regmap, ADAU1781_DIG_PWDN1, 0xc, 0x0);\n\t\tregmap_update_bits(adau->regmap, ADAU17X1_CLOCK_CONTROL,\n\t\t\tADAU17X1_CLOCK_CONTROL_SYSCLK_EN, 0);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic bool adau1781_readable_register(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase ADAU1781_DMIC_BEEP_CTRL:\n\tcase ADAU1781_LEFT_PGA:\n\tcase ADAU1781_RIGHT_PGA:\n\tcase ADAU1781_LEFT_PLAYBACK_MIXER:\n\tcase ADAU1781_RIGHT_PLAYBACK_MIXER:\n\tcase ADAU1781_MONO_PLAYBACK_MIXER:\n\tcase ADAU1781_LEFT_LINEOUT:\n\tcase ADAU1781_RIGHT_LINEOUT:\n\tcase ADAU1781_SPEAKER:\n\tcase ADAU1781_BEEP_ZC:\n\tcase ADAU1781_DEJITTER:\n\tcase ADAU1781_DIG_PWDN0:\n\tcase ADAU1781_DIG_PWDN1:\n\t\treturn true;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn adau17x1_readable_register(dev, reg);\n}\n\nstatic int adau1781_set_input_mode(struct adau *adau, unsigned int reg,\n\tbool differential)\n{\n\tunsigned int val;\n\n\tif (differential)\n\t\tval = ADAU1781_INPUT_DIFFERNTIAL;\n\telse\n\t\tval = 0;\n\n\treturn regmap_update_bits(adau->regmap, reg,\n\t\tADAU1781_INPUT_DIFFERNTIAL, val);\n}\n\nstatic int adau1781_component_probe(struct snd_soc_component *component)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct adau1781_platform_data *pdata = dev_get_platdata(component->dev);\n\tstruct adau *adau = snd_soc_component_get_drvdata(component);\n\tint ret;\n\n\tret = adau17x1_add_widgets(component);\n\tif (ret)\n\t\treturn ret;\n\n\tif (pdata) {\n\t\tret = adau1781_set_input_mode(adau, ADAU1781_LEFT_PGA,\n\t\t\tpdata->left_input_differential);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = adau1781_set_input_mode(adau, ADAU1781_RIGHT_PGA,\n\t\t\tpdata->right_input_differential);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tif (pdata && pdata->use_dmic) {\n\t\tret = snd_soc_dapm_new_controls(dapm,\n\t\t\tadau1781_dmic_dapm_widgets,\n\t\t\tARRAY_SIZE(adau1781_dmic_dapm_widgets));\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = snd_soc_dapm_add_routes(dapm, adau1781_dmic_dapm_routes,\n\t\t\tARRAY_SIZE(adau1781_dmic_dapm_routes));\n\t\tif (ret)\n\t\t\treturn ret;\n\t} else {\n\t\tret = snd_soc_dapm_add_routes(dapm, adau1781_adc_dapm_routes,\n\t\t\tARRAY_SIZE(adau1781_adc_dapm_routes));\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tret = adau17x1_add_routes(component);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_component_driver adau1781_component_driver = {\n\t.probe\t\t\t= adau1781_component_probe,\n\t.resume\t\t\t= adau17x1_resume,\n\t.set_bias_level\t\t= adau1781_set_bias_level,\n\t.controls\t\t= adau1781_controls,\n\t.num_controls\t\t= ARRAY_SIZE(adau1781_controls),\n\t.dapm_widgets\t\t= adau1781_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(adau1781_dapm_widgets),\n\t.dapm_routes\t\t= adau1781_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(adau1781_dapm_routes),\n\t.suspend_bias_off\t= 1,\n\t.idle_bias_on\t\t= 1,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\n#define ADAU1781_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S24_LE | \\\n\tSNDRV_PCM_FMTBIT_S32_LE)\n\nstatic struct snd_soc_dai_driver adau1781_dai_driver = {\n\t.name = \"adau-hifi\",\n\t.playback = {\n\t\t.stream_name = \"Playback\",\n\t\t.channels_min = 2,\n\t\t.channels_max = 8,\n\t\t.rates = SNDRV_PCM_RATE_8000_96000,\n\t\t.formats = ADAU1781_FORMATS,\n\t},\n\t.capture = {\n\t\t.stream_name = \"Capture\",\n\t\t.channels_min = 2,\n\t\t.channels_max = 8,\n\t\t.rates = SNDRV_PCM_RATE_8000_96000,\n\t\t.formats = ADAU1781_FORMATS,\n\t},\n\t.ops = &adau17x1_dai_ops,\n};\n\nconst struct regmap_config adau1781_regmap_config = {\n\t.val_bits\t\t= 8,\n\t.reg_bits\t\t= 16,\n\t.max_register\t\t= 0x40f8,\n\t.reg_defaults\t\t= adau1781_reg_defaults,\n\t.num_reg_defaults\t= ARRAY_SIZE(adau1781_reg_defaults),\n\t.readable_reg\t\t= adau1781_readable_register,\n\t.volatile_reg\t\t= adau17x1_volatile_register,\n\t.precious_reg\t\t= adau17x1_precious_register,\n\t.cache_type\t\t= REGCACHE_MAPLE,\n};\nEXPORT_SYMBOL_GPL(adau1781_regmap_config);\n\nint adau1781_probe(struct device *dev, struct regmap *regmap,\n\tenum adau17x1_type type, void (*switch_mode)(struct device *dev))\n{\n\tconst char *firmware_name;\n\tint ret;\n\n\tswitch (type) {\n\tcase ADAU1381:\n\t\tfirmware_name = ADAU1381_FIRMWARE;\n\t\tbreak;\n\tcase ADAU1781:\n\t\tfirmware_name = ADAU1781_FIRMWARE;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tret = adau17x1_probe(dev, regmap, type, switch_mode, firmware_name);\n\tif (ret)\n\t\treturn ret;\n\n\treturn devm_snd_soc_register_component(dev, &adau1781_component_driver,\n\t\t&adau1781_dai_driver, 1);\n}\nEXPORT_SYMBOL_GPL(adau1781_probe);\n\nMODULE_DESCRIPTION(\"ASoC ADAU1381/ADAU1781 driver\");\nMODULE_AUTHOR(\"Lars-Peter Clausen <lars@metafoo.de>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}