{
  "module_name": "max9877.c",
  "hash_id": "a9c80e786f302c4c11c47f7daa1244ddf77109b946307cec8f99225c39bcbe7d",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/max9877.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/i2c.h>\n#include <linux/regmap.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n\n#include \"max9877.h\"\n\nstatic const struct reg_default max9877_regs[] = {\n\t{ 0, 0x40 },\n\t{ 1, 0x00 },\n\t{ 2, 0x00 },\n\t{ 3, 0x00 },\n\t{ 4, 0x49 },\n};\n\nstatic const DECLARE_TLV_DB_RANGE(max9877_pgain_tlv,\n\t0, 1, TLV_DB_SCALE_ITEM(0, 900, 0),\n\t2, 2, TLV_DB_SCALE_ITEM(2000, 0, 0)\n);\n\nstatic const DECLARE_TLV_DB_RANGE(max9877_output_tlv,\n\t0, 7, TLV_DB_SCALE_ITEM(-7900, 400, 1),\n\t8, 15, TLV_DB_SCALE_ITEM(-4700, 300, 0),\n\t16, 23, TLV_DB_SCALE_ITEM(-2300, 200, 0),\n\t24, 31, TLV_DB_SCALE_ITEM(-700, 100, 0)\n);\n\nstatic const char *max9877_out_mode[] = {\n\t\"INA -> SPK\",\n\t\"INA -> HP\",\n\t\"INA -> SPK and HP\",\n\t\"INB -> SPK\",\n\t\"INB -> HP\",\n\t\"INB -> SPK and HP\",\n\t\"INA + INB -> SPK\",\n\t\"INA + INB -> HP\",\n\t\"INA + INB -> SPK and HP\",\n};\n\nstatic const char *max9877_osc_mode[] = {\n\t\"1176KHz\",\n\t\"1100KHz\",\n\t\"700KHz\",\n};\n\nstatic const struct soc_enum max9877_enum[] = {\n\tSOC_ENUM_SINGLE(MAX9877_OUTPUT_MODE, 0, ARRAY_SIZE(max9877_out_mode),\n\t\t\tmax9877_out_mode),\n\tSOC_ENUM_SINGLE(MAX9877_OUTPUT_MODE, MAX9877_OSC_OFFSET,\n\t\t\tARRAY_SIZE(max9877_osc_mode), max9877_osc_mode),\n};\n\nstatic const struct snd_kcontrol_new max9877_controls[] = {\n\tSOC_SINGLE_TLV(\"MAX9877 PGAINA Playback Volume\",\n\t\t       MAX9877_INPUT_MODE, 0, 2, 0, max9877_pgain_tlv),\n\tSOC_SINGLE_TLV(\"MAX9877 PGAINB Playback Volume\",\n\t\t       MAX9877_INPUT_MODE, 2, 2, 0, max9877_pgain_tlv),\n\tSOC_SINGLE_TLV(\"MAX9877 Amp Speaker Playback Volume\",\n\t\t       MAX9877_SPK_VOLUME, 0, 31, 0, max9877_output_tlv),\n\tSOC_DOUBLE_R_TLV(\"MAX9877 Amp HP Playback Volume\",\n\t\t\t MAX9877_HPL_VOLUME, MAX9877_HPR_VOLUME, 0, 31, 0,\n\t\t\t max9877_output_tlv),\n\tSOC_SINGLE(\"MAX9877 INB Stereo Switch\",\n\t\t   MAX9877_INPUT_MODE, 4, 1, 1),\n\tSOC_SINGLE(\"MAX9877 INA Stereo Switch\",\n\t\t   MAX9877_INPUT_MODE, 5, 1, 1),\n\tSOC_SINGLE(\"MAX9877 Zero-crossing detection Switch\",\n\t\t   MAX9877_INPUT_MODE, 6, 1, 0),\n\tSOC_SINGLE(\"MAX9877 Bypass Mode Switch\",\n\t\t   MAX9877_OUTPUT_MODE, 6, 1, 0),\n\tSOC_ENUM(\"MAX9877 Output Mode\", max9877_enum[0]),\n\tSOC_ENUM(\"MAX9877 Oscillator Mode\", max9877_enum[1]),\n};\n\nstatic const struct snd_soc_dapm_widget max9877_dapm_widgets[] = {\nSND_SOC_DAPM_INPUT(\"INA1\"),\nSND_SOC_DAPM_INPUT(\"INA2\"),\nSND_SOC_DAPM_INPUT(\"INB1\"),\nSND_SOC_DAPM_INPUT(\"INB2\"),\nSND_SOC_DAPM_INPUT(\"RXIN+\"),\nSND_SOC_DAPM_INPUT(\"RXIN-\"),\n\nSND_SOC_DAPM_PGA(\"SHDN\", MAX9877_OUTPUT_MODE, 7, 1, NULL, 0),\n\nSND_SOC_DAPM_OUTPUT(\"OUT+\"),\nSND_SOC_DAPM_OUTPUT(\"OUT-\"),\nSND_SOC_DAPM_OUTPUT(\"HPL\"),\nSND_SOC_DAPM_OUTPUT(\"HPR\"),\n};\n\nstatic const struct snd_soc_dapm_route max9877_dapm_routes[] = {\n\t{ \"SHDN\", NULL, \"INA1\" },\n\t{ \"SHDN\", NULL, \"INA2\" },\n\t{ \"SHDN\", NULL, \"INB1\" },\n\t{ \"SHDN\", NULL, \"INB2\" },\n\n\t{ \"OUT+\", NULL, \"RXIN+\" },\n\t{ \"OUT+\", NULL, \"SHDN\" },\n\n\t{ \"OUT-\", NULL, \"SHDN\" },\n\t{ \"OUT-\", NULL, \"RXIN-\" },\n\n\t{ \"HPL\", NULL, \"SHDN\" },\n\t{ \"HPR\", NULL, \"SHDN\" },\n};\n\nstatic const struct snd_soc_component_driver max9877_component_driver = {\n\t.controls = max9877_controls,\n\t.num_controls = ARRAY_SIZE(max9877_controls),\n\n\t.dapm_widgets = max9877_dapm_widgets,\n\t.num_dapm_widgets = ARRAY_SIZE(max9877_dapm_widgets),\n\t.dapm_routes = max9877_dapm_routes,\n\t.num_dapm_routes = ARRAY_SIZE(max9877_dapm_routes),\n};\n\nstatic const struct regmap_config max9877_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\n\t.reg_defaults = max9877_regs,\n\t.num_reg_defaults = ARRAY_SIZE(max9877_regs),\n\t.cache_type = REGCACHE_RBTREE,\n};\n\nstatic int max9877_i2c_probe(struct i2c_client *client)\n{\n\tstruct regmap *regmap;\n\tint i;\n\n\tregmap = devm_regmap_init_i2c(client, &max9877_regmap);\n\tif (IS_ERR(regmap))\n\t\treturn PTR_ERR(regmap);\n\n\t \n\tfor (i = 0; i < ARRAY_SIZE(max9877_regs); i++)\n\t\tregmap_write(regmap, max9877_regs[i].reg, max9877_regs[i].def);\n\n\treturn devm_snd_soc_register_component(&client->dev,\n\t\t\t&max9877_component_driver, NULL, 0);\n}\n\nstatic const struct i2c_device_id max9877_i2c_id[] = {\n\t{ \"max9877\", 0 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, max9877_i2c_id);\n\nstatic struct i2c_driver max9877_i2c_driver = {\n\t.driver = {\n\t\t.name = \"max9877\",\n\t},\n\t.probe = max9877_i2c_probe,\n\t.id_table = max9877_i2c_id,\n};\n\nmodule_i2c_driver(max9877_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC MAX9877 amp driver\");\nMODULE_AUTHOR(\"Joonyoung Shim <jy0922.shim@samsung.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}