{
  "module_name": "rt5645.c",
  "hash_id": "a2a58b03edc1a9eefc7861391d8570de98c016bc7957057cd97dbb5946c6702f",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/rt5645.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/i2c.h>\n#include <linux/platform_device.h>\n#include <linux/spi/spi.h>\n#include <linux/gpio/consumer.h>\n#include <linux/acpi.h>\n#include <linux/dmi.h>\n#include <linux/regulator/consumer.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/jack.h>\n#include <sound/soc.h>\n#include <sound/soc-dapm.h>\n#include <sound/initval.h>\n#include <sound/tlv.h>\n\n#include \"rl6231.h\"\n#include \"rt5645.h\"\n\n#define QUIRK_INV_JD1_1(q)\t((q) & 1)\n#define QUIRK_LEVEL_IRQ(q)\t(((q) >> 1) & 1)\n#define QUIRK_IN2_DIFF(q)\t(((q) >> 2) & 1)\n#define QUIRK_INV_HP_POL(q)\t(((q) >> 3) & 1)\n#define QUIRK_JD_MODE(q)\t(((q) >> 4) & 7)\n#define QUIRK_DMIC1_DATA_PIN(q)\t(((q) >> 8) & 3)\n#define QUIRK_DMIC2_DATA_PIN(q)\t(((q) >> 12) & 3)\n\nstatic unsigned int quirk = -1;\nmodule_param(quirk, uint, 0444);\nMODULE_PARM_DESC(quirk, \"RT5645 pdata quirk override\");\n\nstatic const struct acpi_gpio_mapping *cht_rt5645_gpios;\n\n#define RT5645_DEVICE_ID 0x6308\n#define RT5650_DEVICE_ID 0x6419\n\n#define RT5645_PR_RANGE_BASE (0xff + 1)\n#define RT5645_PR_SPACING 0x100\n\n#define RT5645_PR_BASE (RT5645_PR_RANGE_BASE + (0 * RT5645_PR_SPACING))\n\n#define RT5645_HWEQ_NUM 57\n\n#define TIME_TO_POWER_MS 400\n\nstatic const struct regmap_range_cfg rt5645_ranges[] = {\n\t{\n\t\t.name = \"PR\",\n\t\t.range_min = RT5645_PR_BASE,\n\t\t.range_max = RT5645_PR_BASE + 0xf8,\n\t\t.selector_reg = RT5645_PRIV_INDEX,\n\t\t.selector_mask = 0xff,\n\t\t.selector_shift = 0x0,\n\t\t.window_start = RT5645_PRIV_DATA,\n\t\t.window_len = 0x1,\n\t},\n};\n\nstatic const struct reg_sequence init_list[] = {\n\t{RT5645_PR_BASE + 0x3d,\t0x3600},\n\t{RT5645_PR_BASE + 0x1c,\t0xfd70},\n\t{RT5645_PR_BASE + 0x20,\t0x611f},\n\t{RT5645_PR_BASE + 0x21,\t0x4040},\n\t{RT5645_PR_BASE + 0x23,\t0x0004},\n\t{RT5645_ASRC_4, 0x0120},\n};\n\nstatic const struct reg_sequence rt5650_init_list[] = {\n\t{0xf6,\t0x0100},\n\t{RT5645_PWR_ANLG1, 0x02},\n};\n\nstatic const struct reg_default rt5645_reg[] = {\n\t{ 0x00, 0x0000 },\n\t{ 0x01, 0xc8c8 },\n\t{ 0x02, 0xc8c8 },\n\t{ 0x03, 0xc8c8 },\n\t{ 0x0a, 0x0002 },\n\t{ 0x0b, 0x2827 },\n\t{ 0x0c, 0xe000 },\n\t{ 0x0d, 0x0000 },\n\t{ 0x0e, 0x0000 },\n\t{ 0x0f, 0x0808 },\n\t{ 0x14, 0x3333 },\n\t{ 0x16, 0x4b00 },\n\t{ 0x18, 0x018b },\n\t{ 0x19, 0xafaf },\n\t{ 0x1a, 0xafaf },\n\t{ 0x1b, 0x0001 },\n\t{ 0x1c, 0x2f2f },\n\t{ 0x1d, 0x2f2f },\n\t{ 0x1e, 0x0000 },\n\t{ 0x20, 0x0000 },\n\t{ 0x27, 0x7060 },\n\t{ 0x28, 0x7070 },\n\t{ 0x29, 0x8080 },\n\t{ 0x2a, 0x5656 },\n\t{ 0x2b, 0x5454 },\n\t{ 0x2c, 0xaaa0 },\n\t{ 0x2d, 0x0000 },\n\t{ 0x2f, 0x1002 },\n\t{ 0x31, 0x5000 },\n\t{ 0x32, 0x0000 },\n\t{ 0x33, 0x0000 },\n\t{ 0x34, 0x0000 },\n\t{ 0x35, 0x0000 },\n\t{ 0x3b, 0x0000 },\n\t{ 0x3c, 0x007f },\n\t{ 0x3d, 0x0000 },\n\t{ 0x3e, 0x007f },\n\t{ 0x3f, 0x0000 },\n\t{ 0x40, 0x001f },\n\t{ 0x41, 0x0000 },\n\t{ 0x42, 0x001f },\n\t{ 0x45, 0x6000 },\n\t{ 0x46, 0x003e },\n\t{ 0x47, 0x003e },\n\t{ 0x48, 0xf807 },\n\t{ 0x4a, 0x0004 },\n\t{ 0x4d, 0x0000 },\n\t{ 0x4e, 0x0000 },\n\t{ 0x4f, 0x01ff },\n\t{ 0x50, 0x0000 },\n\t{ 0x51, 0x0000 },\n\t{ 0x52, 0x01ff },\n\t{ 0x53, 0xf000 },\n\t{ 0x56, 0x0111 },\n\t{ 0x57, 0x0064 },\n\t{ 0x58, 0xef0e },\n\t{ 0x59, 0xf0f0 },\n\t{ 0x5a, 0xef0e },\n\t{ 0x5b, 0xf0f0 },\n\t{ 0x5c, 0xef0e },\n\t{ 0x5d, 0xf0f0 },\n\t{ 0x5e, 0xf000 },\n\t{ 0x5f, 0x0000 },\n\t{ 0x61, 0x0300 },\n\t{ 0x62, 0x0000 },\n\t{ 0x63, 0x00c2 },\n\t{ 0x64, 0x0000 },\n\t{ 0x65, 0x0000 },\n\t{ 0x66, 0x0000 },\n\t{ 0x6a, 0x0000 },\n\t{ 0x6c, 0x0aaa },\n\t{ 0x70, 0x8000 },\n\t{ 0x71, 0x8000 },\n\t{ 0x72, 0x8000 },\n\t{ 0x73, 0x7770 },\n\t{ 0x74, 0x3e00 },\n\t{ 0x75, 0x2409 },\n\t{ 0x76, 0x000a },\n\t{ 0x77, 0x0c00 },\n\t{ 0x78, 0x0000 },\n\t{ 0x79, 0x0123 },\n\t{ 0x80, 0x0000 },\n\t{ 0x81, 0x0000 },\n\t{ 0x82, 0x0000 },\n\t{ 0x83, 0x0000 },\n\t{ 0x84, 0x0000 },\n\t{ 0x85, 0x0000 },\n\t{ 0x8a, 0x0120 },\n\t{ 0x8e, 0x0004 },\n\t{ 0x8f, 0x1100 },\n\t{ 0x90, 0x0646 },\n\t{ 0x91, 0x0c06 },\n\t{ 0x93, 0x0000 },\n\t{ 0x94, 0x0200 },\n\t{ 0x95, 0x0000 },\n\t{ 0x9a, 0x2184 },\n\t{ 0x9b, 0x010a },\n\t{ 0x9c, 0x0aea },\n\t{ 0x9d, 0x000c },\n\t{ 0x9e, 0x0400 },\n\t{ 0xa0, 0xa0a8 },\n\t{ 0xa1, 0x0059 },\n\t{ 0xa2, 0x0001 },\n\t{ 0xae, 0x6000 },\n\t{ 0xaf, 0x0000 },\n\t{ 0xb0, 0x6000 },\n\t{ 0xb1, 0x0000 },\n\t{ 0xb2, 0x0000 },\n\t{ 0xb3, 0x001f },\n\t{ 0xb4, 0x020c },\n\t{ 0xb5, 0x1f00 },\n\t{ 0xb6, 0x0000 },\n\t{ 0xbb, 0x0000 },\n\t{ 0xbc, 0x0000 },\n\t{ 0xbd, 0x0000 },\n\t{ 0xbe, 0x0000 },\n\t{ 0xbf, 0x3100 },\n\t{ 0xc0, 0x0000 },\n\t{ 0xc1, 0x0000 },\n\t{ 0xc2, 0x0000 },\n\t{ 0xc3, 0x2000 },\n\t{ 0xcd, 0x0000 },\n\t{ 0xce, 0x0000 },\n\t{ 0xcf, 0x1813 },\n\t{ 0xd0, 0x0690 },\n\t{ 0xd1, 0x1c17 },\n\t{ 0xd3, 0xb320 },\n\t{ 0xd4, 0x0000 },\n\t{ 0xd6, 0x0400 },\n\t{ 0xd9, 0x0809 },\n\t{ 0xda, 0x0000 },\n\t{ 0xdb, 0x0003 },\n\t{ 0xdc, 0x0049 },\n\t{ 0xdd, 0x001b },\n\t{ 0xdf, 0x0008 },\n\t{ 0xe0, 0x4000 },\n\t{ 0xe6, 0x8000 },\n\t{ 0xe7, 0x0200 },\n\t{ 0xec, 0xb300 },\n\t{ 0xed, 0x0000 },\n\t{ 0xf0, 0x001f },\n\t{ 0xf1, 0x020c },\n\t{ 0xf2, 0x1f00 },\n\t{ 0xf3, 0x0000 },\n\t{ 0xf4, 0x4000 },\n\t{ 0xf8, 0x0000 },\n\t{ 0xf9, 0x0000 },\n\t{ 0xfa, 0x2060 },\n\t{ 0xfb, 0x4040 },\n\t{ 0xfc, 0x0000 },\n\t{ 0xfd, 0x0002 },\n\t{ 0xfe, 0x10ec },\n\t{ 0xff, 0x6308 },\n};\n\nstatic const struct reg_default rt5650_reg[] = {\n\t{ 0x00, 0x0000 },\n\t{ 0x01, 0xc8c8 },\n\t{ 0x02, 0xc8c8 },\n\t{ 0x03, 0xc8c8 },\n\t{ 0x0a, 0x0002 },\n\t{ 0x0b, 0x2827 },\n\t{ 0x0c, 0xe000 },\n\t{ 0x0d, 0x0000 },\n\t{ 0x0e, 0x0000 },\n\t{ 0x0f, 0x0808 },\n\t{ 0x14, 0x3333 },\n\t{ 0x16, 0x4b00 },\n\t{ 0x18, 0x018b },\n\t{ 0x19, 0xafaf },\n\t{ 0x1a, 0xafaf },\n\t{ 0x1b, 0x0001 },\n\t{ 0x1c, 0x2f2f },\n\t{ 0x1d, 0x2f2f },\n\t{ 0x1e, 0x0000 },\n\t{ 0x20, 0x0000 },\n\t{ 0x27, 0x7060 },\n\t{ 0x28, 0x7070 },\n\t{ 0x29, 0x8080 },\n\t{ 0x2a, 0x5656 },\n\t{ 0x2b, 0x5454 },\n\t{ 0x2c, 0xaaa0 },\n\t{ 0x2d, 0x0000 },\n\t{ 0x2f, 0x5002 },\n\t{ 0x31, 0x5000 },\n\t{ 0x32, 0x0000 },\n\t{ 0x33, 0x0000 },\n\t{ 0x34, 0x0000 },\n\t{ 0x35, 0x0000 },\n\t{ 0x3b, 0x0000 },\n\t{ 0x3c, 0x007f },\n\t{ 0x3d, 0x0000 },\n\t{ 0x3e, 0x007f },\n\t{ 0x3f, 0x0000 },\n\t{ 0x40, 0x001f },\n\t{ 0x41, 0x0000 },\n\t{ 0x42, 0x001f },\n\t{ 0x45, 0x6000 },\n\t{ 0x46, 0x003e },\n\t{ 0x47, 0x003e },\n\t{ 0x48, 0xf807 },\n\t{ 0x4a, 0x0004 },\n\t{ 0x4d, 0x0000 },\n\t{ 0x4e, 0x0000 },\n\t{ 0x4f, 0x01ff },\n\t{ 0x50, 0x0000 },\n\t{ 0x51, 0x0000 },\n\t{ 0x52, 0x01ff },\n\t{ 0x53, 0xf000 },\n\t{ 0x56, 0x0111 },\n\t{ 0x57, 0x0064 },\n\t{ 0x58, 0xef0e },\n\t{ 0x59, 0xf0f0 },\n\t{ 0x5a, 0xef0e },\n\t{ 0x5b, 0xf0f0 },\n\t{ 0x5c, 0xef0e },\n\t{ 0x5d, 0xf0f0 },\n\t{ 0x5e, 0xf000 },\n\t{ 0x5f, 0x0000 },\n\t{ 0x61, 0x0300 },\n\t{ 0x62, 0x0000 },\n\t{ 0x63, 0x00c2 },\n\t{ 0x64, 0x0000 },\n\t{ 0x65, 0x0000 },\n\t{ 0x66, 0x0000 },\n\t{ 0x6a, 0x0000 },\n\t{ 0x6c, 0x0aaa },\n\t{ 0x70, 0x8000 },\n\t{ 0x71, 0x8000 },\n\t{ 0x72, 0x8000 },\n\t{ 0x73, 0x7770 },\n\t{ 0x74, 0x3e00 },\n\t{ 0x75, 0x2409 },\n\t{ 0x76, 0x000a },\n\t{ 0x77, 0x0c00 },\n\t{ 0x78, 0x0000 },\n\t{ 0x79, 0x0123 },\n\t{ 0x7a, 0x0123 },\n\t{ 0x80, 0x0000 },\n\t{ 0x81, 0x0000 },\n\t{ 0x82, 0x0000 },\n\t{ 0x83, 0x0000 },\n\t{ 0x84, 0x0000 },\n\t{ 0x85, 0x0000 },\n\t{ 0x8a, 0x0120 },\n\t{ 0x8e, 0x0004 },\n\t{ 0x8f, 0x1100 },\n\t{ 0x90, 0x0646 },\n\t{ 0x91, 0x0c06 },\n\t{ 0x93, 0x0000 },\n\t{ 0x94, 0x0200 },\n\t{ 0x95, 0x0000 },\n\t{ 0x9a, 0x2184 },\n\t{ 0x9b, 0x010a },\n\t{ 0x9c, 0x0aea },\n\t{ 0x9d, 0x000c },\n\t{ 0x9e, 0x0400 },\n\t{ 0xa0, 0xa0a8 },\n\t{ 0xa1, 0x0059 },\n\t{ 0xa2, 0x0001 },\n\t{ 0xae, 0x6000 },\n\t{ 0xaf, 0x0000 },\n\t{ 0xb0, 0x6000 },\n\t{ 0xb1, 0x0000 },\n\t{ 0xb2, 0x0000 },\n\t{ 0xb3, 0x001f },\n\t{ 0xb4, 0x020c },\n\t{ 0xb5, 0x1f00 },\n\t{ 0xb6, 0x0000 },\n\t{ 0xbb, 0x0000 },\n\t{ 0xbc, 0x0000 },\n\t{ 0xbd, 0x0000 },\n\t{ 0xbe, 0x0000 },\n\t{ 0xbf, 0x3100 },\n\t{ 0xc0, 0x0000 },\n\t{ 0xc1, 0x0000 },\n\t{ 0xc2, 0x0000 },\n\t{ 0xc3, 0x2000 },\n\t{ 0xcd, 0x0000 },\n\t{ 0xce, 0x0000 },\n\t{ 0xcf, 0x1813 },\n\t{ 0xd0, 0x0690 },\n\t{ 0xd1, 0x1c17 },\n\t{ 0xd3, 0xb320 },\n\t{ 0xd4, 0x0000 },\n\t{ 0xd6, 0x0400 },\n\t{ 0xd9, 0x0809 },\n\t{ 0xda, 0x0000 },\n\t{ 0xdb, 0x0003 },\n\t{ 0xdc, 0x0049 },\n\t{ 0xdd, 0x001b },\n\t{ 0xdf, 0x0008 },\n\t{ 0xe0, 0x4000 },\n\t{ 0xe6, 0x8000 },\n\t{ 0xe7, 0x0200 },\n\t{ 0xec, 0xb300 },\n\t{ 0xed, 0x0000 },\n\t{ 0xf0, 0x001f },\n\t{ 0xf1, 0x020c },\n\t{ 0xf2, 0x1f00 },\n\t{ 0xf3, 0x0000 },\n\t{ 0xf4, 0x4000 },\n\t{ 0xf8, 0x0000 },\n\t{ 0xf9, 0x0000 },\n\t{ 0xfa, 0x2060 },\n\t{ 0xfb, 0x4040 },\n\t{ 0xfc, 0x0000 },\n\t{ 0xfd, 0x0002 },\n\t{ 0xfe, 0x10ec },\n\t{ 0xff, 0x6308 },\n};\n\nstruct rt5645_eq_param_s {\n\tunsigned short reg;\n\tunsigned short val;\n};\n\nstruct rt5645_eq_param_s_be16 {\n\t__be16 reg;\n\t__be16 val;\n};\n\nstatic const char *const rt5645_supply_names[] = {\n\t\"avdd\",\n\t\"cpvdd\",\n};\n\nstruct rt5645_platform_data {\n\t \n\tbool in2_diff;\n\n\tunsigned int dmic1_data_pin;\n\t \n\tunsigned int dmic2_data_pin;\n\t \n\n\tunsigned int jd_mode;\n\t \n\tbool level_trigger_irq;\n\t \n\tbool inv_jd1_1;\n\t \n\tbool inv_hp_pol;\n\n\t \n\tconst char *long_name;\n\n\t \n\tbool no_headset_mic;\n};\n\nstruct rt5645_priv {\n\tstruct snd_soc_component *component;\n\tstruct rt5645_platform_data pdata;\n\tstruct regmap *regmap;\n\tstruct i2c_client *i2c;\n\tstruct gpio_desc *gpiod_hp_det;\n\tstruct snd_soc_jack *hp_jack;\n\tstruct snd_soc_jack *mic_jack;\n\tstruct snd_soc_jack *btn_jack;\n\tstruct delayed_work jack_detect_work, rcclock_work;\n\tstruct regulator_bulk_data supplies[ARRAY_SIZE(rt5645_supply_names)];\n\tstruct rt5645_eq_param_s *eq_param;\n\tstruct timer_list btn_check_timer;\n\tstruct mutex jd_mutex;\n\n\tint codec_type;\n\tint sysclk;\n\tint sysclk_src;\n\tint lrck[RT5645_AIFS];\n\tint bclk[RT5645_AIFS];\n\tint master[RT5645_AIFS];\n\n\tint pll_src;\n\tint pll_in;\n\tint pll_out;\n\n\tint jack_type;\n\tbool en_button_func;\n\tint v_id;\n};\n\nstatic int rt5645_reset(struct snd_soc_component *component)\n{\n\treturn snd_soc_component_write(component, RT5645_RESET, 0);\n}\n\nstatic bool rt5645_volatile_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rt5645_ranges); i++) {\n\t\tif (reg >= rt5645_ranges[i].range_min &&\n\t\t\treg <= rt5645_ranges[i].range_max) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tswitch (reg) {\n\tcase RT5645_RESET:\n\tcase RT5645_PRIV_INDEX:\n\tcase RT5645_PRIV_DATA:\n\tcase RT5645_IN1_CTRL1:\n\tcase RT5645_IN1_CTRL2:\n\tcase RT5645_IN1_CTRL3:\n\tcase RT5645_A_JD_CTRL1:\n\tcase RT5645_ADC_EQ_CTRL1:\n\tcase RT5645_EQ_CTRL1:\n\tcase RT5645_ALC_CTRL_1:\n\tcase RT5645_IRQ_CTRL2:\n\tcase RT5645_IRQ_CTRL3:\n\tcase RT5645_INT_IRQ_ST:\n\tcase RT5645_IL_CMD:\n\tcase RT5650_4BTN_IL_CMD1:\n\tcase RT5645_VENDOR_ID:\n\tcase RT5645_VENDOR_ID1:\n\tcase RT5645_VENDOR_ID2:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic bool rt5645_readable_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rt5645_ranges); i++) {\n\t\tif (reg >= rt5645_ranges[i].range_min &&\n\t\t\treg <= rt5645_ranges[i].range_max) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tswitch (reg) {\n\tcase RT5645_RESET:\n\tcase RT5645_SPK_VOL:\n\tcase RT5645_HP_VOL:\n\tcase RT5645_LOUT1:\n\tcase RT5645_IN1_CTRL1:\n\tcase RT5645_IN1_CTRL2:\n\tcase RT5645_IN1_CTRL3:\n\tcase RT5645_IN2_CTRL:\n\tcase RT5645_INL1_INR1_VOL:\n\tcase RT5645_SPK_FUNC_LIM:\n\tcase RT5645_ADJ_HPF_CTRL:\n\tcase RT5645_DAC1_DIG_VOL:\n\tcase RT5645_DAC2_DIG_VOL:\n\tcase RT5645_DAC_CTRL:\n\tcase RT5645_STO1_ADC_DIG_VOL:\n\tcase RT5645_MONO_ADC_DIG_VOL:\n\tcase RT5645_ADC_BST_VOL1:\n\tcase RT5645_ADC_BST_VOL2:\n\tcase RT5645_STO1_ADC_MIXER:\n\tcase RT5645_MONO_ADC_MIXER:\n\tcase RT5645_AD_DA_MIXER:\n\tcase RT5645_STO_DAC_MIXER:\n\tcase RT5645_MONO_DAC_MIXER:\n\tcase RT5645_DIG_MIXER:\n\tcase RT5650_A_DAC_SOUR:\n\tcase RT5645_DIG_INF1_DATA:\n\tcase RT5645_PDM_OUT_CTRL:\n\tcase RT5645_REC_L1_MIXER:\n\tcase RT5645_REC_L2_MIXER:\n\tcase RT5645_REC_R1_MIXER:\n\tcase RT5645_REC_R2_MIXER:\n\tcase RT5645_HPMIXL_CTRL:\n\tcase RT5645_HPOMIXL_CTRL:\n\tcase RT5645_HPMIXR_CTRL:\n\tcase RT5645_HPOMIXR_CTRL:\n\tcase RT5645_HPO_MIXER:\n\tcase RT5645_SPK_L_MIXER:\n\tcase RT5645_SPK_R_MIXER:\n\tcase RT5645_SPO_MIXER:\n\tcase RT5645_SPO_CLSD_RATIO:\n\tcase RT5645_OUT_L1_MIXER:\n\tcase RT5645_OUT_R1_MIXER:\n\tcase RT5645_OUT_L_GAIN1:\n\tcase RT5645_OUT_L_GAIN2:\n\tcase RT5645_OUT_R_GAIN1:\n\tcase RT5645_OUT_R_GAIN2:\n\tcase RT5645_LOUT_MIXER:\n\tcase RT5645_HAPTIC_CTRL1:\n\tcase RT5645_HAPTIC_CTRL2:\n\tcase RT5645_HAPTIC_CTRL3:\n\tcase RT5645_HAPTIC_CTRL4:\n\tcase RT5645_HAPTIC_CTRL5:\n\tcase RT5645_HAPTIC_CTRL6:\n\tcase RT5645_HAPTIC_CTRL7:\n\tcase RT5645_HAPTIC_CTRL8:\n\tcase RT5645_HAPTIC_CTRL9:\n\tcase RT5645_HAPTIC_CTRL10:\n\tcase RT5645_PWR_DIG1:\n\tcase RT5645_PWR_DIG2:\n\tcase RT5645_PWR_ANLG1:\n\tcase RT5645_PWR_ANLG2:\n\tcase RT5645_PWR_MIXER:\n\tcase RT5645_PWR_VOL:\n\tcase RT5645_PRIV_INDEX:\n\tcase RT5645_PRIV_DATA:\n\tcase RT5645_I2S1_SDP:\n\tcase RT5645_I2S2_SDP:\n\tcase RT5645_ADDA_CLK1:\n\tcase RT5645_ADDA_CLK2:\n\tcase RT5645_DMIC_CTRL1:\n\tcase RT5645_DMIC_CTRL2:\n\tcase RT5645_TDM_CTRL_1:\n\tcase RT5645_TDM_CTRL_2:\n\tcase RT5645_TDM_CTRL_3:\n\tcase RT5650_TDM_CTRL_4:\n\tcase RT5645_GLB_CLK:\n\tcase RT5645_PLL_CTRL1:\n\tcase RT5645_PLL_CTRL2:\n\tcase RT5645_ASRC_1:\n\tcase RT5645_ASRC_2:\n\tcase RT5645_ASRC_3:\n\tcase RT5645_ASRC_4:\n\tcase RT5645_DEPOP_M1:\n\tcase RT5645_DEPOP_M2:\n\tcase RT5645_DEPOP_M3:\n\tcase RT5645_CHARGE_PUMP:\n\tcase RT5645_MICBIAS:\n\tcase RT5645_A_JD_CTRL1:\n\tcase RT5645_VAD_CTRL4:\n\tcase RT5645_CLSD_OUT_CTRL:\n\tcase RT5645_ADC_EQ_CTRL1:\n\tcase RT5645_ADC_EQ_CTRL2:\n\tcase RT5645_EQ_CTRL1:\n\tcase RT5645_EQ_CTRL2:\n\tcase RT5645_ALC_CTRL_1:\n\tcase RT5645_ALC_CTRL_2:\n\tcase RT5645_ALC_CTRL_3:\n\tcase RT5645_ALC_CTRL_4:\n\tcase RT5645_ALC_CTRL_5:\n\tcase RT5645_JD_CTRL:\n\tcase RT5645_IRQ_CTRL1:\n\tcase RT5645_IRQ_CTRL2:\n\tcase RT5645_IRQ_CTRL3:\n\tcase RT5645_INT_IRQ_ST:\n\tcase RT5645_GPIO_CTRL1:\n\tcase RT5645_GPIO_CTRL2:\n\tcase RT5645_GPIO_CTRL3:\n\tcase RT5645_BASS_BACK:\n\tcase RT5645_MP3_PLUS1:\n\tcase RT5645_MP3_PLUS2:\n\tcase RT5645_ADJ_HPF1:\n\tcase RT5645_ADJ_HPF2:\n\tcase RT5645_HP_CALIB_AMP_DET:\n\tcase RT5645_SV_ZCD1:\n\tcase RT5645_SV_ZCD2:\n\tcase RT5645_IL_CMD:\n\tcase RT5645_IL_CMD2:\n\tcase RT5645_IL_CMD3:\n\tcase RT5650_4BTN_IL_CMD1:\n\tcase RT5650_4BTN_IL_CMD2:\n\tcase RT5645_DRC1_HL_CTRL1:\n\tcase RT5645_DRC2_HL_CTRL1:\n\tcase RT5645_ADC_MONO_HP_CTRL1:\n\tcase RT5645_ADC_MONO_HP_CTRL2:\n\tcase RT5645_DRC2_CTRL1:\n\tcase RT5645_DRC2_CTRL2:\n\tcase RT5645_DRC2_CTRL3:\n\tcase RT5645_DRC2_CTRL4:\n\tcase RT5645_DRC2_CTRL5:\n\tcase RT5645_JD_CTRL3:\n\tcase RT5645_JD_CTRL4:\n\tcase RT5645_GEN_CTRL1:\n\tcase RT5645_GEN_CTRL2:\n\tcase RT5645_GEN_CTRL3:\n\tcase RT5645_VENDOR_ID:\n\tcase RT5645_VENDOR_ID1:\n\tcase RT5645_VENDOR_ID2:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic const DECLARE_TLV_DB_SCALE(out_vol_tlv, -4650, 150, 0);\nstatic const DECLARE_TLV_DB_SCALE(dac_vol_tlv, -6525, 75, 0);\nstatic const DECLARE_TLV_DB_SCALE(in_vol_tlv, -3450, 150, 0);\nstatic const DECLARE_TLV_DB_SCALE(adc_vol_tlv, -1725, 75, 0);\nstatic const DECLARE_TLV_DB_SCALE(adc_bst_tlv, 0, 1200, 0);\n\n \nstatic const DECLARE_TLV_DB_RANGE(bst_tlv,\n\t0, 0, TLV_DB_SCALE_ITEM(0, 0, 0),\n\t1, 1, TLV_DB_SCALE_ITEM(2000, 0, 0),\n\t2, 2, TLV_DB_SCALE_ITEM(2400, 0, 0),\n\t3, 5, TLV_DB_SCALE_ITEM(3000, 500, 0),\n\t6, 6, TLV_DB_SCALE_ITEM(4400, 0, 0),\n\t7, 7, TLV_DB_SCALE_ITEM(5000, 0, 0),\n\t8, 8, TLV_DB_SCALE_ITEM(5200, 0, 0)\n);\n\n \nstatic const DECLARE_TLV_DB_RANGE(spk_clsd_tlv,\n\t0, 4, TLV_DB_SCALE_ITEM(-600, 150, 0),\n\t5, 5, TLV_DB_SCALE_ITEM(82, 0, 0),\n\t6, 6, TLV_DB_SCALE_ITEM(158, 0, 0),\n\t7, 7, TLV_DB_SCALE_ITEM(228, 0, 0)\n);\n\nstatic int rt5645_hweq_info(struct snd_kcontrol *kcontrol,\n\t\t\t struct snd_ctl_elem_info *uinfo)\n{\n\tuinfo->type = SNDRV_CTL_ELEM_TYPE_BYTES;\n\tuinfo->count = RT5645_HWEQ_NUM * sizeof(struct rt5645_eq_param_s);\n\n\treturn 0;\n}\n\nstatic int rt5645_hweq_get(struct snd_kcontrol *kcontrol,\n\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_kcontrol_chip(kcontrol);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tstruct rt5645_eq_param_s_be16 *eq_param =\n\t\t(struct rt5645_eq_param_s_be16 *)ucontrol->value.bytes.data;\n\tint i;\n\n\tfor (i = 0; i < RT5645_HWEQ_NUM; i++) {\n\t\teq_param[i].reg = cpu_to_be16(rt5645->eq_param[i].reg);\n\t\teq_param[i].val = cpu_to_be16(rt5645->eq_param[i].val);\n\t}\n\n\treturn 0;\n}\n\nstatic bool rt5645_validate_hweq(unsigned short reg)\n{\n\tif ((reg >= 0x1a4 && reg <= 0x1cd) || (reg >= 0x1e5 && reg <= 0x1f8) ||\n\t\t(reg == RT5645_EQ_CTRL2))\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic int rt5645_hweq_put(struct snd_kcontrol *kcontrol,\n\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_kcontrol_chip(kcontrol);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tstruct rt5645_eq_param_s_be16 *eq_param =\n\t\t(struct rt5645_eq_param_s_be16 *)ucontrol->value.bytes.data;\n\tint i;\n\n\tfor (i = 0; i < RT5645_HWEQ_NUM; i++) {\n\t\trt5645->eq_param[i].reg = be16_to_cpu(eq_param[i].reg);\n\t\trt5645->eq_param[i].val = be16_to_cpu(eq_param[i].val);\n\t}\n\n\t \n\tfor (i = RT5645_HWEQ_NUM - 1; i >= 0; i--) {\n\t\tif (rt5645->eq_param[i].reg == 0)\n\t\t\tcontinue;\n\t\telse if (rt5645->eq_param[i].reg != RT5645_EQ_CTRL2)\n\t\t\treturn 0;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (i = 0; i < RT5645_HWEQ_NUM; i++) {\n\t\tif (!rt5645_validate_hweq(rt5645->eq_param[i].reg) &&\n\t\t    rt5645->eq_param[i].reg != 0)\n\t\t\treturn 0;\n\t\telse if (rt5645->eq_param[i].reg == 0)\n\t\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n#define RT5645_HWEQ(xname) \\\n{\t.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname, \\\n\t.info = rt5645_hweq_info, \\\n\t.get = rt5645_hweq_get, \\\n\t.put = rt5645_hweq_put \\\n}\n\nstatic int rt5645_spk_put_volsw(struct snd_kcontrol *kcontrol,\n\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_kcontrol_chip(kcontrol);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tint ret;\n\n\tregmap_update_bits(rt5645->regmap, RT5645_MICBIAS,\n\t\tRT5645_PWR_CLK25M_MASK, RT5645_PWR_CLK25M_PU);\n\n\tret = snd_soc_put_volsw(kcontrol, ucontrol);\n\n\tmod_delayed_work(system_power_efficient_wq, &rt5645->rcclock_work,\n\t\tmsecs_to_jiffies(200));\n\n\treturn ret;\n}\n\nstatic const char * const rt5645_dac1_vol_ctrl_mode_text[] = {\n\t\"immediately\", \"zero crossing\", \"soft ramp\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_dac1_vol_ctrl_mode, RT5645_PR_BASE,\n\tRT5645_DA1_ZDET_SFT, rt5645_dac1_vol_ctrl_mode_text);\n\nstatic const struct snd_kcontrol_new rt5645_snd_controls[] = {\n\t \n\tSOC_DOUBLE(\"Speaker Channel Switch\", RT5645_SPK_VOL,\n\t\tRT5645_VOL_L_SFT, RT5645_VOL_R_SFT, 1, 1),\n\tSOC_DOUBLE_EXT_TLV(\"Speaker Playback Volume\", RT5645_SPK_VOL,\n\t\tRT5645_L_VOL_SFT, RT5645_R_VOL_SFT, 39, 1, snd_soc_get_volsw,\n\t\trt5645_spk_put_volsw, out_vol_tlv),\n\n\t \n\tSOC_SINGLE_TLV(\"Speaker ClassD Playback Volume\", RT5645_SPO_CLSD_RATIO,\n\t\tRT5645_SPK_G_CLSD_SFT, 7, 0, spk_clsd_tlv),\n\n\t \n\tSOC_DOUBLE(\"Headphone Channel Switch\", RT5645_HP_VOL,\n\t\tRT5645_VOL_L_SFT, RT5645_VOL_R_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"Headphone Playback Volume\", RT5645_HP_VOL,\n\t\tRT5645_L_VOL_SFT, RT5645_R_VOL_SFT, 39, 1, out_vol_tlv),\n\n\t \n\tSOC_DOUBLE(\"OUT Playback Switch\", RT5645_LOUT1,\n\t\tRT5645_L_MUTE_SFT, RT5645_R_MUTE_SFT, 1, 1),\n\tSOC_DOUBLE(\"OUT Channel Switch\", RT5645_LOUT1,\n\t\tRT5645_VOL_L_SFT, RT5645_VOL_R_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"OUT Playback Volume\", RT5645_LOUT1,\n\t\tRT5645_L_VOL_SFT, RT5645_R_VOL_SFT, 39, 1, out_vol_tlv),\n\n\t \n\tSOC_DOUBLE(\"DAC2 Playback Switch\", RT5645_DAC_CTRL,\n\t\tRT5645_M_DAC_L2_VOL_SFT, RT5645_M_DAC_R2_VOL_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"DAC1 Playback Volume\", RT5645_DAC1_DIG_VOL,\n\t\tRT5645_L_VOL_SFT + 1, RT5645_R_VOL_SFT + 1, 87, 0, dac_vol_tlv),\n\tSOC_DOUBLE_TLV(\"Mono DAC Playback Volume\", RT5645_DAC2_DIG_VOL,\n\t\tRT5645_L_VOL_SFT + 1, RT5645_R_VOL_SFT + 1, 87, 0, dac_vol_tlv),\n\n\t \n\tSOC_SINGLE_TLV(\"IN1 Boost\", RT5645_IN1_CTRL1,\n\t\tRT5645_BST_SFT1, 12, 0, bst_tlv),\n\tSOC_SINGLE_TLV(\"IN2 Boost\", RT5645_IN2_CTRL,\n\t\tRT5645_BST_SFT2, 8, 0, bst_tlv),\n\n\t \n\tSOC_DOUBLE_TLV(\"IN Capture Volume\", RT5645_INL1_INR1_VOL,\n\t\tRT5645_INL_VOL_SFT, RT5645_INR_VOL_SFT, 31, 1, in_vol_tlv),\n\n\t \n\tSOC_DOUBLE(\"ADC Capture Switch\", RT5645_STO1_ADC_DIG_VOL,\n\t\tRT5645_L_MUTE_SFT, RT5645_R_MUTE_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"ADC Capture Volume\", RT5645_STO1_ADC_DIG_VOL,\n\t\tRT5645_L_VOL_SFT + 1, RT5645_R_VOL_SFT + 1, 63, 0, adc_vol_tlv),\n\tSOC_DOUBLE(\"Mono ADC Capture Switch\", RT5645_MONO_ADC_DIG_VOL,\n\t\tRT5645_L_MUTE_SFT, RT5645_R_MUTE_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"Mono ADC Capture Volume\", RT5645_MONO_ADC_DIG_VOL,\n\t\tRT5645_L_VOL_SFT + 1, RT5645_R_VOL_SFT + 1, 63, 0, adc_vol_tlv),\n\n\t \n\tSOC_DOUBLE_TLV(\"ADC Boost Capture Volume\", RT5645_ADC_BST_VOL1,\n\t\tRT5645_STO1_ADC_L_BST_SFT, RT5645_STO1_ADC_R_BST_SFT, 3, 0,\n\t\tadc_bst_tlv),\n\tSOC_DOUBLE_TLV(\"Mono ADC Boost Capture Volume\", RT5645_ADC_BST_VOL2,\n\t\tRT5645_MONO_ADC_L_BST_SFT, RT5645_MONO_ADC_R_BST_SFT, 3, 0,\n\t\tadc_bst_tlv),\n\n\t \n\tSOC_SINGLE(\"I2S2 Func Switch\", RT5645_GPIO_CTRL1, RT5645_I2S2_SEL_SFT,\n\t\t1, 1),\n\tRT5645_HWEQ(\"Speaker HWEQ\"),\n\n\t \n\tSOC_ENUM(\"DAC1 Digital Volume Control Func\", rt5645_dac1_vol_ctrl_mode),\n};\n\n \nstatic int set_dmic_clk(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tint idx, rate;\n\n\trate = rt5645->sysclk / rl6231_get_pre_div(rt5645->regmap,\n\t\tRT5645_ADDA_CLK1, RT5645_I2S_PD1_SFT);\n\tidx = rl6231_calc_dmic_clk(rate);\n\tif (idx < 0)\n\t\tdev_err(component->dev, \"Failed to set DMIC clock\\n\");\n\telse\n\t\tsnd_soc_component_update_bits(component, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_CLK_MASK, idx << RT5645_DMIC_CLK_SFT);\n\treturn idx;\n}\n\nstatic int is_sys_clk_from_pll(struct snd_soc_dapm_widget *source,\n\t\t\t struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(source->dapm);\n\tunsigned int val;\n\n\tval = snd_soc_component_read(component, RT5645_GLB_CLK);\n\tval &= RT5645_SCLK_SRC_MASK;\n\tif (val == RT5645_SCLK_SRC_PLL1)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nstatic int is_using_asrc(struct snd_soc_dapm_widget *source,\n\t\t\t struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(source->dapm);\n\tunsigned int reg, shift, val;\n\n\tswitch (source->shift) {\n\tcase 0:\n\t\treg = RT5645_ASRC_3;\n\t\tshift = 0;\n\t\tbreak;\n\tcase 1:\n\t\treg = RT5645_ASRC_3;\n\t\tshift = 4;\n\t\tbreak;\n\tcase 3:\n\t\treg = RT5645_ASRC_2;\n\t\tshift = 0;\n\t\tbreak;\n\tcase 8:\n\t\treg = RT5645_ASRC_2;\n\t\tshift = 4;\n\t\tbreak;\n\tcase 9:\n\t\treg = RT5645_ASRC_2;\n\t\tshift = 8;\n\t\tbreak;\n\tcase 10:\n\t\treg = RT5645_ASRC_2;\n\t\tshift = 12;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tval = (snd_soc_component_read(component, reg) >> shift) & 0xf;\n\tswitch (val) {\n\tcase 1:\n\tcase 2:\n\tcase 3:\n\tcase 4:\n\t\treturn 1;\n\tdefault:\n\t\treturn 0;\n\t}\n\n}\n\nstatic int rt5645_enable_hweq(struct snd_soc_component *component)\n{\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tint i;\n\n\tfor (i = 0; i < RT5645_HWEQ_NUM; i++) {\n\t\tif (rt5645_validate_hweq(rt5645->eq_param[i].reg))\n\t\t\tregmap_write(rt5645->regmap, rt5645->eq_param[i].reg,\n\t\t\t\t\trt5645->eq_param[i].val);\n\t\telse\n\t\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n \nint rt5645_sel_asrc_clk_src(struct snd_soc_component *component,\n\t\tunsigned int filter_mask, unsigned int clk_src)\n{\n\tunsigned int asrc2_mask = 0;\n\tunsigned int asrc2_value = 0;\n\tunsigned int asrc3_mask = 0;\n\tunsigned int asrc3_value = 0;\n\n\tswitch (clk_src) {\n\tcase RT5645_CLK_SEL_SYS:\n\tcase RT5645_CLK_SEL_I2S1_ASRC:\n\tcase RT5645_CLK_SEL_I2S2_ASRC:\n\tcase RT5645_CLK_SEL_SYS2:\n\t\tbreak;\n\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tif (filter_mask & RT5645_DA_STEREO_FILTER) {\n\t\tasrc2_mask |= RT5645_DA_STO_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5645_DA_STO_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_DA_STO_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5645_DA_MONO_L_FILTER) {\n\t\tasrc2_mask |= RT5645_DA_MONOL_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5645_DA_MONOL_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_DA_MONOL_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5645_DA_MONO_R_FILTER) {\n\t\tasrc2_mask |= RT5645_DA_MONOR_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5645_DA_MONOR_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_DA_MONOR_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5645_AD_STEREO_FILTER) {\n\t\tasrc2_mask |= RT5645_AD_STO1_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5645_AD_STO1_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_AD_STO1_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5645_AD_MONO_L_FILTER) {\n\t\tasrc3_mask |= RT5645_AD_MONOL_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5645_AD_MONOL_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_AD_MONOL_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5645_AD_MONO_R_FILTER)  {\n\t\tasrc3_mask |= RT5645_AD_MONOR_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5645_AD_MONOR_CLK_SEL_MASK)\n\t\t\t| (clk_src << RT5645_AD_MONOR_CLK_SEL_SFT);\n\t}\n\n\tif (asrc2_mask)\n\t\tsnd_soc_component_update_bits(component, RT5645_ASRC_2,\n\t\t\tasrc2_mask, asrc2_value);\n\n\tif (asrc3_mask)\n\t\tsnd_soc_component_update_bits(component, RT5645_ASRC_3,\n\t\t\tasrc3_mask, asrc3_value);\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(rt5645_sel_asrc_clk_src);\n\n \nstatic const struct snd_kcontrol_new rt5645_sto1_adc_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5645_STO1_ADC_MIXER,\n\t\t\tRT5645_M_ADC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5645_STO1_ADC_MIXER,\n\t\t\tRT5645_M_ADC_L2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_sto1_adc_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5645_STO1_ADC_MIXER,\n\t\t\tRT5645_M_ADC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5645_STO1_ADC_MIXER,\n\t\t\tRT5645_M_ADC_R2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5645_MONO_ADC_MIXER,\n\t\t\tRT5645_M_MONO_ADC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5645_MONO_ADC_MIXER,\n\t\t\tRT5645_M_MONO_ADC_L2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5645_MONO_ADC_MIXER,\n\t\t\tRT5645_M_MONO_ADC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5645_MONO_ADC_MIXER,\n\t\t\tRT5645_M_MONO_ADC_R2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"Stereo ADC Switch\", RT5645_AD_DA_MIXER,\n\t\t\tRT5645_M_ADCMIX_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"DAC1 Switch\", RT5645_AD_DA_MIXER,\n\t\t\tRT5645_M_DAC1_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"Stereo ADC Switch\", RT5645_AD_DA_MIXER,\n\t\t\tRT5645_M_ADCMIX_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"DAC1 Switch\", RT5645_AD_DA_MIXER,\n\t\t\tRT5645_M_DAC1_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_sto_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L2_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R1_STO_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_sto_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R2_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_STO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L1_STO_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_mono_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L1_MONO_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L2_MONO_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R2_MONO_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_mono_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R1_MONO_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_R2_MONO_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_MONO_DAC_MIXER,\n\t\t\tRT5645_M_DAC_L2_MONO_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_dig_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"Sto DAC Mix L Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_STO_L_DAC_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_DAC_L2_DAC_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_DAC_R2_DAC_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_dig_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"Sto DAC Mix R Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_STO_R_DAC_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_DAC_R2_DAC_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_DIG_MIXER,\n\t\t\tRT5645_M_DAC_L2_DAC_R_SFT, 1, 1),\n};\n\n \nstatic const struct snd_kcontrol_new rt5645_rec_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"HPOL Switch\", RT5645_REC_L2_MIXER,\n\t\t\tRT5645_M_HP_L_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5645_REC_L2_MIXER,\n\t\t\tRT5645_M_IN_L_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5645_REC_L2_MIXER,\n\t\t\tRT5645_M_BST2_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5645_REC_L2_MIXER,\n\t\t\tRT5645_M_BST1_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUT MIXL Switch\", RT5645_REC_L2_MIXER,\n\t\t\tRT5645_M_OM_L_RM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_rec_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"HPOR Switch\", RT5645_REC_R2_MIXER,\n\t\t\tRT5645_M_HP_R_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5645_REC_R2_MIXER,\n\t\t\tRT5645_M_IN_R_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5645_REC_R2_MIXER,\n\t\t\tRT5645_M_BST2_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5645_REC_R2_MIXER,\n\t\t\tRT5645_M_BST1_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUT MIXR Switch\", RT5645_REC_R2_MIXER,\n\t\t\tRT5645_M_OM_R_RM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_spk_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_SPK_L_MIXER,\n\t\t\tRT5645_M_DAC_L1_SM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_SPK_L_MIXER,\n\t\t\tRT5645_M_DAC_L2_SM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5645_SPK_L_MIXER,\n\t\t\tRT5645_M_IN_L_SM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5645_SPK_L_MIXER,\n\t\t\tRT5645_M_BST1_L_SM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_spk_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_SPK_R_MIXER,\n\t\t\tRT5645_M_DAC_R1_SM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_SPK_R_MIXER,\n\t\t\tRT5645_M_DAC_R2_SM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5645_SPK_R_MIXER,\n\t\t\tRT5645_M_IN_R_SM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5645_SPK_R_MIXER,\n\t\t\tRT5645_M_BST2_R_SM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_out_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5645_OUT_L1_MIXER,\n\t\t\tRT5645_M_BST1_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5645_OUT_L1_MIXER,\n\t\t\tRT5645_M_IN_L_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5645_OUT_L1_MIXER,\n\t\t\tRT5645_M_DAC_L2_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_OUT_L1_MIXER,\n\t\t\tRT5645_M_DAC_L1_OM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_out_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5645_OUT_R1_MIXER,\n\t\t\tRT5645_M_BST2_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5645_OUT_R1_MIXER,\n\t\t\tRT5645_M_IN_R_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5645_OUT_R1_MIXER,\n\t\t\tRT5645_M_DAC_R2_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_OUT_R1_MIXER,\n\t\t\tRT5645_M_DAC_R1_OM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_spo_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_DAC_R1_SPM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_DAC_L1_SPM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"SPKVOL R Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_SV_R_SPM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"SPKVOL L Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_SV_L_SPM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_spo_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_DAC_R1_SPM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"SPKVOL R Switch\", RT5645_SPO_MIXER,\n\t\t\tRT5645_M_SV_R_SPM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_hpo_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5645_HPO_MIXER,\n\t\t\tRT5645_M_DAC1_HM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"HPVOL Switch\", RT5645_HPO_MIXER,\n\t\t\tRT5645_M_HPVOL_HM_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_hpvoll_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5645_HPOMIXL_CTRL,\n\t\t\tRT5645_M_DAC1_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC2 Switch\", RT5645_HPOMIXL_CTRL,\n\t\t\tRT5645_M_DAC2_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5645_HPOMIXL_CTRL,\n\t\t\tRT5645_M_IN_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5645_HPOMIXL_CTRL,\n\t\t\tRT5645_M_BST1_HV_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_hpvolr_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5645_HPOMIXR_CTRL,\n\t\t\tRT5645_M_DAC1_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC2 Switch\", RT5645_HPOMIXR_CTRL,\n\t\t\tRT5645_M_DAC2_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5645_HPOMIXR_CTRL,\n\t\t\tRT5645_M_IN_HV_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5645_HPOMIXR_CTRL,\n\t\t\tRT5645_M_BST2_HV_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5645_lout_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5645_LOUT_MIXER,\n\t\t\tRT5645_M_DAC_L1_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5645_LOUT_MIXER,\n\t\t\tRT5645_M_DAC_R1_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUTMIX L Switch\", RT5645_LOUT_MIXER,\n\t\t\tRT5645_M_OV_L_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUTMIX R Switch\", RT5645_LOUT_MIXER,\n\t\t\tRT5645_M_OV_R_LM_SFT, 1, 1),\n};\n\n   \nstatic const char * const rt5645_dac1_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\", \"IF3 DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_dac1l_enum, RT5645_AD_DA_MIXER,\n\tRT5645_DAC1_L_SEL_SFT, rt5645_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5645_dac1l_mux =\n\tSOC_DAPM_ENUM(\"DAC1 L source\", rt5645_dac1l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_dac1r_enum, RT5645_AD_DA_MIXER,\n\tRT5645_DAC1_R_SEL_SFT, rt5645_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5645_dac1r_mux =\n\tSOC_DAPM_ENUM(\"DAC1 R source\", rt5645_dac1r_enum);\n\n   \nstatic const char * const rt5645_dac12_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\", \"IF3 DAC\", \"Mono ADC\", \"VAD_ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_dac2l_enum, RT5645_DAC_CTRL,\n\tRT5645_DAC2_L_SEL_SFT, rt5645_dac12_src);\n\nstatic const struct snd_kcontrol_new rt5645_dac_l2_mux =\n\tSOC_DAPM_ENUM(\"DAC2 L source\", rt5645_dac2l_enum);\n\nstatic const char * const rt5645_dacr2_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\", \"IF3 DAC\", \"Mono ADC\", \"Haptic\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_dac2r_enum, RT5645_DAC_CTRL,\n\tRT5645_DAC2_R_SEL_SFT, rt5645_dacr2_src);\n\nstatic const struct snd_kcontrol_new rt5645_dac_r2_mux =\n\tSOC_DAPM_ENUM(\"DAC2 R source\", rt5645_dac2r_enum);\n\n \n \nstatic const char * const rt5645_stereo_adc1_src[] = {\n\t\"DAC MIX\", \"ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_stereo1_adc1_enum, RT5645_STO1_ADC_MIXER,\n\tRT5645_ADC_1_SRC_SFT, rt5645_stereo_adc1_src);\n\nstatic const struct snd_kcontrol_new rt5645_sto_adc1_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 ADC1 Mux\", rt5645_stereo1_adc1_enum);\n\n \nstatic const char * const rt5645_stereo_adc2_src[] = {\n\t\"DAC MIX\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_stereo1_adc2_enum, RT5645_STO1_ADC_MIXER,\n\tRT5645_ADC_2_SRC_SFT, rt5645_stereo_adc2_src);\n\nstatic const struct snd_kcontrol_new rt5645_sto_adc2_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 ADC2 Mux\", rt5645_stereo1_adc2_enum);\n\n \nstatic const char * const rt5645_stereo_dmic_src[] = {\n\t\"DMIC1\", \"DMIC2\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_stereo1_dmic_enum, RT5645_STO1_ADC_MIXER,\n\tRT5645_DMIC_SRC_SFT, rt5645_stereo_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5645_sto1_dmic_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 DMIC source\", rt5645_stereo1_dmic_enum);\n\n \n \nstatic const char * const rt5645_mono_adc_l1_src[] = {\n\t\"Mono DAC MIXL\", \"ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_adc_l1_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_ADC_L1_SRC_SFT, rt5645_mono_adc_l1_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_l1_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC1 left source\", rt5645_mono_adc_l1_enum);\n \nstatic const char * const rt5645_mono_adc_l2_src[] = {\n\t\"Mono DAC MIXL\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_adc_l2_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_ADC_L2_SRC_SFT, rt5645_mono_adc_l2_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_l2_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC2 left source\", rt5645_mono_adc_l2_enum);\n\n \nstatic const char * const rt5645_mono_dmic_src[] = {\n\t\"DMIC1\", \"DMIC2\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_dmic_l_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_DMIC_L_SRC_SFT, rt5645_mono_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_dmic_l_mux =\n\tSOC_DAPM_ENUM(\"Mono DMIC left source\", rt5645_mono_dmic_l_enum);\n \nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_dmic_r_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_DMIC_R_SRC_SFT, rt5645_mono_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_dmic_r_mux =\n\tSOC_DAPM_ENUM(\"Mono DMIC Right source\", rt5645_mono_dmic_r_enum);\n \nstatic const char * const rt5645_mono_adc_r1_src[] = {\n\t\"Mono DAC MIXR\", \"ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_adc_r1_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_ADC_R1_SRC_SFT, rt5645_mono_adc_r1_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_r1_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC1 right source\", rt5645_mono_adc_r1_enum);\n \nstatic const char * const rt5645_mono_adc_r2_src[] = {\n\t\"Mono DAC MIXR\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_mono_adc_r2_enum, RT5645_MONO_ADC_MIXER,\n\tRT5645_MONO_ADC_R2_SRC_SFT, rt5645_mono_adc_r2_src);\n\nstatic const struct snd_kcontrol_new rt5645_mono_adc_r2_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC2 right source\", rt5645_mono_adc_r2_enum);\n\n \nstatic const char * const rt5645_if1_adc_in_src[] = {\n\t\"IF_ADC1/IF_ADC2/VAD_ADC\", \"IF_ADC2/IF_ADC1/VAD_ADC\",\n\t\"VAD_ADC/IF_ADC1/IF_ADC2\", \"VAD_ADC/IF_ADC2/IF_ADC1\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_if1_adc_in_enum, RT5645_TDM_CTRL_1,\n\tRT5645_IF1_ADC_IN_SFT, rt5645_if1_adc_in_src);\n\nstatic const struct snd_kcontrol_new rt5645_if1_adc_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC IN source\", rt5645_if1_adc_in_enum);\n\n \nstatic const char * const rt5650_if1_adc_in_src[] = {\n\t\"IF_ADC1/IF_ADC2/DAC_REF/Null\",\n\t\"IF_ADC1/IF_ADC2/Null/DAC_REF\",\n\t\"IF_ADC1/DAC_REF/IF_ADC2/Null\",\n\t\"IF_ADC1/DAC_REF/Null/IF_ADC2\",\n\t\"IF_ADC1/Null/DAC_REF/IF_ADC2\",\n\t\"IF_ADC1/Null/IF_ADC2/DAC_REF\",\n\n\t\"IF_ADC2/IF_ADC1/DAC_REF/Null\",\n\t\"IF_ADC2/IF_ADC1/Null/DAC_REF\",\n\t\"IF_ADC2/DAC_REF/IF_ADC1/Null\",\n\t\"IF_ADC2/DAC_REF/Null/IF_ADC1\",\n\t\"IF_ADC2/Null/DAC_REF/IF_ADC1\",\n\t\"IF_ADC2/Null/IF_ADC1/DAC_REF\",\n\n\t\"DAC_REF/IF_ADC1/IF_ADC2/Null\",\n\t\"DAC_REF/IF_ADC1/Null/IF_ADC2\",\n\t\"DAC_REF/IF_ADC2/IF_ADC1/Null\",\n\t\"DAC_REF/IF_ADC2/Null/IF_ADC1\",\n\t\"DAC_REF/Null/IF_ADC1/IF_ADC2\",\n\t\"DAC_REF/Null/IF_ADC2/IF_ADC1\",\n\n\t\"Null/IF_ADC1/IF_ADC2/DAC_REF\",\n\t\"Null/IF_ADC1/DAC_REF/IF_ADC2\",\n\t\"Null/IF_ADC2/IF_ADC1/DAC_REF\",\n\t\"Null/IF_ADC2/DAC_REF/IF_ADC1\",\n\t\"Null/DAC_REF/IF_ADC1/IF_ADC2\",\n\t\"Null/DAC_REF/IF_ADC2/IF_ADC1\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5650_if1_adc_in_enum, RT5645_TDM_CTRL_2,\n\t0, rt5650_if1_adc_in_src);\n\nstatic const struct snd_kcontrol_new rt5650_if1_adc_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC IN source\", rt5650_if1_adc_in_enum);\n\n \nstatic const char * const rt5645_tdm_adc_swap_select[] = {\n\t\"L/R\", \"R/L\", \"L/L\", \"R/R\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_adc_slot0_1_enum,\n\tRT5645_TDM_CTRL_2, 14, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_adc1_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC1 IN source\", rt5650_tdm_adc_slot0_1_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_adc_slot2_3_enum,\n\tRT5645_TDM_CTRL_2, 12, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_adc2_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC2 IN source\", rt5650_tdm_adc_slot2_3_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_adc_slot4_5_enum,\n\tRT5645_TDM_CTRL_2, 10, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_adc3_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC3 IN source\", rt5650_tdm_adc_slot4_5_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_adc_slot0_1_enum,\n\tRT5645_TDM_CTRL_1, 6, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_adc1_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC1 IN source\", rt5645_tdm_adc_slot0_1_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_adc_slot2_3_enum,\n\tRT5645_TDM_CTRL_1, 4, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_adc2_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC2 IN source\", rt5645_tdm_adc_slot2_3_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_adc_slot4_5_enum,\n\tRT5645_TDM_CTRL_1, 2, rt5645_tdm_adc_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_adc3_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC3 IN source\", rt5645_tdm_adc_slot4_5_enum);\n\n \nstatic const char * const rt5645_tdm_dac_swap_select[] = {\n\t\"Slot0\", \"Slot1\", \"Slot2\", \"Slot3\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_dac0_enum,\n\tRT5645_TDM_CTRL_3, 12, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_dac0_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC0 source\", rt5645_tdm_dac0_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_dac1_enum,\n\tRT5645_TDM_CTRL_3, 8, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_dac1_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC1 source\", rt5645_tdm_dac1_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_dac2_enum,\n\tRT5645_TDM_CTRL_3, 4, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_dac2_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC2 source\", rt5645_tdm_dac2_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5645_tdm_dac3_enum,\n\tRT5645_TDM_CTRL_3, 0, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5645_if1_dac3_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC3 source\", rt5645_tdm_dac3_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_dac0_enum,\n\tRT5650_TDM_CTRL_4, 12, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_dac0_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC0 source\", rt5650_tdm_dac0_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_dac1_enum,\n\tRT5650_TDM_CTRL_4, 8, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_dac1_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC1 source\", rt5650_tdm_dac1_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_dac2_enum,\n\tRT5650_TDM_CTRL_4, 4, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_dac2_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC2 source\", rt5650_tdm_dac2_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5650_tdm_dac3_enum,\n\tRT5650_TDM_CTRL_4, 0, rt5645_tdm_dac_swap_select);\n\nstatic const struct snd_kcontrol_new rt5650_if1_dac3_tdm_sel_mux =\n\tSOC_DAPM_ENUM(\"IF1 DAC3 source\", rt5650_tdm_dac3_enum);\n\n \nstatic const char * const rt5650_a_dac1_src[] = {\n\t\"DAC1\", \"Stereo DAC Mixer\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5650_a_dac1_l_enum, RT5650_A_DAC_SOUR,\n\tRT5650_A_DAC1_L_IN_SFT, rt5650_a_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5650_a_dac1_l_mux =\n\tSOC_DAPM_ENUM(\"A DAC1 L source\", rt5650_a_dac1_l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5650_a_dac1_r_enum, RT5650_A_DAC_SOUR,\n\tRT5650_A_DAC1_R_IN_SFT, rt5650_a_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5650_a_dac1_r_mux =\n\tSOC_DAPM_ENUM(\"A DAC1 R source\", rt5650_a_dac1_r_enum);\n\n \nstatic const char * const rt5650_a_dac2_src[] = {\n\t\"Stereo DAC Mixer\", \"Mono DAC Mixer\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5650_a_dac2_l_enum, RT5650_A_DAC_SOUR,\n\tRT5650_A_DAC2_L_IN_SFT, rt5650_a_dac2_src);\n\nstatic const struct snd_kcontrol_new rt5650_a_dac2_l_mux =\n\tSOC_DAPM_ENUM(\"A DAC2 L source\", rt5650_a_dac2_l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5650_a_dac2_r_enum, RT5650_A_DAC_SOUR,\n\tRT5650_A_DAC2_R_IN_SFT, rt5650_a_dac2_src);\n\nstatic const struct snd_kcontrol_new rt5650_a_dac2_r_mux =\n\tSOC_DAPM_ENUM(\"A DAC2 R source\", rt5650_a_dac2_r_enum);\n\n \nstatic const char * const rt5645_if2_adc_in_src[] = {\n\t\"IF_ADC1\", \"IF_ADC2\", \"VAD_ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_if2_adc_in_enum, RT5645_DIG_INF1_DATA,\n\tRT5645_IF2_ADC_IN_SFT, rt5645_if2_adc_in_src);\n\nstatic const struct snd_kcontrol_new rt5645_if2_adc_in_mux =\n\tSOC_DAPM_ENUM(\"IF2 ADC IN source\", rt5645_if2_adc_in_enum);\n\n \nstatic const char * const rt5645_pdm_src[] = {\n\t\"Mono DAC\", \"Stereo DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_pdm1_l_enum, RT5645_PDM_OUT_CTRL,\n\tRT5645_PDM1_L_SFT, rt5645_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5645_pdm1_l_mux =\n\tSOC_DAPM_ENUM(\"PDM1 L source\", rt5645_pdm1_l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_pdm1_r_enum, RT5645_PDM_OUT_CTRL,\n\tRT5645_PDM1_R_SFT, rt5645_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5645_pdm1_r_mux =\n\tSOC_DAPM_ENUM(\"PDM1 R source\", rt5645_pdm1_r_enum);\n\n \nstatic const char * const rt5645_vad_adc_src[] = {\n\t\"Sto1 ADC L\", \"Mono ADC L\", \"Mono ADC R\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(\n\trt5645_vad_adc_enum, RT5645_VAD_CTRL4,\n\tRT5645_VAD_SEL_SFT, rt5645_vad_adc_src);\n\nstatic const struct snd_kcontrol_new rt5645_vad_adc_mux =\n\tSOC_DAPM_ENUM(\"VAD ADC source\", rt5645_vad_adc_enum);\n\nstatic const struct snd_kcontrol_new spk_l_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_SPK_VOL,\n\t\tRT5645_L_MUTE_SFT, 1, 1);\n\nstatic const struct snd_kcontrol_new spk_r_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_SPK_VOL,\n\t\tRT5645_R_MUTE_SFT, 1, 1);\n\nstatic const struct snd_kcontrol_new hp_l_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_HP_VOL,\n\t\tRT5645_L_MUTE_SFT, 1, 1);\n\nstatic const struct snd_kcontrol_new hp_r_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_HP_VOL,\n\t\tRT5645_R_MUTE_SFT, 1, 1);\n\nstatic const struct snd_kcontrol_new pdm1_l_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_PDM_OUT_CTRL,\n\t\tRT5645_M_PDM1_L, 1, 1);\n\nstatic const struct snd_kcontrol_new pdm1_r_vol_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5645_PDM_OUT_CTRL,\n\t\tRT5645_M_PDM1_R, 1, 1);\n\nstatic void hp_amp_power(struct snd_soc_component *component, int on)\n{\n\tstatic int hp_amp_power_count;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tint i, val;\n\n\tif (on) {\n\t\tif (hp_amp_power_count <= 0) {\n\t\t\tif (rt5645->codec_type == CODEC_TYPE_RT5650) {\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M2, 0x3100);\n\t\t\t\tsnd_soc_component_write(component, RT5645_CHARGE_PUMP,\n\t\t\t\t\t0x0e06);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M1, 0x000d);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\tRT5645_HP_DCC_INT1, 0x9f01);\n\t\t\t\tfor (i = 0; i < 20; i++) {\n\t\t\t\t\tusleep_range(1000, 1500);\n\t\t\t\t\tregmap_read(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\t\tRT5645_HP_DCC_INT1, &val);\n\t\t\t\t\tif (!(val & 0x8000))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\t\tRT5645_HP_CO_MASK, RT5645_HP_CO_EN);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\t0x3e, 0x7400);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M3, 0x0737);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\tRT5645_MAMP_INT_REG2, 0xfc00);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M2, 0x1140);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R);\n\t\t\t\tmsleep(90);\n\t\t\t} else {\n\t\t\t\t \n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M2,\n\t\t\t\t\tRT5645_DEPOP_MASK, RT5645_DEPOP_MAN);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M1, 0x000d);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\tRT5645_HP_DCC_INT1, 0x9f01);\n\t\t\t\tmdelay(150);\n\t\t\t\t \n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2, 0);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_VOL,\n\t\t\t\t\tRT5645_PWR_HV_L | RT5645_PWR_HV_R,\n\t\t\t\t\tRT5645_PWR_HV_L | RT5645_PWR_HV_R);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R |\n\t\t\t\t\tRT5645_PWR_HA,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R |\n\t\t\t\t\tRT5645_PWR_HA);\n\t\t\t\tmdelay(5);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2,\n\t\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2);\n\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\t\tRT5645_HP_CO_MASK | RT5645_HP_SG_MASK,\n\t\t\t\t\tRT5645_HP_CO_EN | RT5645_HP_SG_EN);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\t0x14, 0x1aaa);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\t0x24, 0x0430);\n\t\t\t}\n\t\t}\n\t\thp_amp_power_count++;\n\t} else {\n\t\thp_amp_power_count--;\n\t\tif (hp_amp_power_count <= 0) {\n\t\t\tif (rt5645->codec_type == CODEC_TYPE_RT5650) {\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\t0x3e, 0x7400);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M3, 0x0737);\n\t\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\t\tRT5645_MAMP_INT_REG2, 0xfc00);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M2, 0x1140);\n\t\t\t\tmsleep(100);\n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M1, 0x0001);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R, 0);\n\t\t\t} else {\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\t\tRT5645_HP_SG_MASK |\n\t\t\t\t\tRT5645_HP_L_SMT_MASK |\n\t\t\t\t\tRT5645_HP_R_SMT_MASK,\n\t\t\t\t\tRT5645_HP_SG_DIS |\n\t\t\t\t\tRT5645_HP_L_SMT_DIS |\n\t\t\t\t\tRT5645_HP_R_SMT_DIS);\n\t\t\t\t \n\t\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M1, 0x0000);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\t\tRT5645_PWR_HP_L | RT5645_PWR_HP_R |\n\t\t\t\t\tRT5645_PWR_HA, 0);\n\t\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M2,\n\t\t\t\t\tRT5645_DEPOP_MASK, 0);\n\t\t\t}\n\t\t}\n\t}\n}\n\nstatic int rt5645_hp_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\thp_amp_power(component, 1);\n\t\t \n\t\tif (rt5645->codec_type == CODEC_TYPE_RT5645) {\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M3,\n\t\t\t\tRT5645_CP_FQ1_MASK | RT5645_CP_FQ2_MASK |\n\t\t\t\tRT5645_CP_FQ3_MASK,\n\t\t\t\t(RT5645_CP_FQ_192_KHZ << RT5645_CP_FQ1_SFT) |\n\t\t\t\t(RT5645_CP_FQ_12_KHZ << RT5645_CP_FQ2_SFT) |\n\t\t\t\t(RT5645_CP_FQ_192_KHZ << RT5645_CP_FQ3_SFT));\n\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\tRT5645_MAMP_INT_REG2, 0xfc00);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_SMT_TRIG_MASK, RT5645_SMT_TRIG_EN);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_RSTN_MASK, RT5645_RSTN_EN);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_RSTN_MASK | RT5645_HP_L_SMT_MASK |\n\t\t\t\tRT5645_HP_R_SMT_MASK, RT5645_RSTN_DIS |\n\t\t\t\tRT5645_HP_L_SMT_EN | RT5645_HP_R_SMT_EN);\n\t\t\tmsleep(40);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_HP_SG_MASK | RT5645_HP_L_SMT_MASK |\n\t\t\t\tRT5645_HP_R_SMT_MASK, RT5645_HP_SG_DIS |\n\t\t\t\tRT5645_HP_L_SMT_DIS | RT5645_HP_R_SMT_DIS);\n\t\t}\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\t \n\t\tif (rt5645->codec_type == CODEC_TYPE_RT5645) {\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M3,\n\t\t\t\tRT5645_CP_FQ1_MASK | RT5645_CP_FQ2_MASK |\n\t\t\t\tRT5645_CP_FQ3_MASK,\n\t\t\t\t(RT5645_CP_FQ_96_KHZ << RT5645_CP_FQ1_SFT) |\n\t\t\t\t(RT5645_CP_FQ_12_KHZ << RT5645_CP_FQ2_SFT) |\n\t\t\t\t(RT5645_CP_FQ_96_KHZ << RT5645_CP_FQ3_SFT));\n\t\t\tregmap_write(rt5645->regmap, RT5645_PR_BASE +\n\t\t\t\tRT5645_MAMP_INT_REG2, 0xfc00);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_HP_SG_MASK, RT5645_HP_SG_EN);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_RSTP_MASK, RT5645_RSTP_EN);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_RSTP_MASK | RT5645_HP_L_SMT_MASK |\n\t\t\t\tRT5645_HP_R_SMT_MASK, RT5645_RSTP_DIS |\n\t\t\t\tRT5645_HP_L_SMT_EN | RT5645_HP_R_SMT_EN);\n\t\t\tmsleep(30);\n\t\t}\n\t\thp_amp_power(component, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_spk_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\trt5645_enable_hweq(component);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_DIG1,\n\t\t\tRT5645_PWR_CLS_D | RT5645_PWR_CLS_D_R |\n\t\t\tRT5645_PWR_CLS_D_L,\n\t\t\tRT5645_PWR_CLS_D | RT5645_PWR_CLS_D_R |\n\t\t\tRT5645_PWR_CLS_D_L);\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL3,\n\t\t\tRT5645_DET_CLK_MASK, RT5645_DET_CLK_MODE1);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL3,\n\t\t\tRT5645_DET_CLK_MASK, RT5645_DET_CLK_DIS);\n\t\tsnd_soc_component_write(component, RT5645_EQ_CTRL2, 0);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_DIG1,\n\t\t\tRT5645_PWR_CLS_D | RT5645_PWR_CLS_D_R |\n\t\t\tRT5645_PWR_CLS_D_L, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_lout_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\thp_amp_power(component, 1);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\tRT5645_PWR_LM, RT5645_PWR_LM);\n\t\tsnd_soc_component_update_bits(component, RT5645_LOUT1,\n\t\t\tRT5645_L_MUTE | RT5645_R_MUTE, 0);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5645_LOUT1,\n\t\t\tRT5645_L_MUTE | RT5645_R_MUTE,\n\t\t\tRT5645_L_MUTE | RT5645_R_MUTE);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\tRT5645_PWR_LM, 0);\n\t\thp_amp_power(component, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_bst2_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG2,\n\t\t\tRT5645_PWR_BST2_P, RT5645_PWR_BST2_P);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG2,\n\t\t\tRT5645_PWR_BST2_P, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_set_micbias1_event(struct snd_soc_dapm_widget *w,\n\t\tstruct snd_kcontrol *k, int  event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL2,\n\t\t\tRT5645_MICBIAS1_POW_CTRL_SEL_MASK,\n\t\t\tRT5645_MICBIAS1_POW_CTRL_SEL_M);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL2,\n\t\t\tRT5645_MICBIAS1_POW_CTRL_SEL_MASK,\n\t\t\tRT5645_MICBIAS1_POW_CTRL_SEL_A);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_set_micbias2_event(struct snd_soc_dapm_widget *w,\n\t\tstruct snd_kcontrol *k, int  event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL2,\n\t\t\tRT5645_MICBIAS2_POW_CTRL_SEL_MASK,\n\t\t\tRT5645_MICBIAS2_POW_CTRL_SEL_M);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_POST_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL2,\n\t\t\tRT5645_MICBIAS2_POW_CTRL_SEL_MASK,\n\t\t\tRT5645_MICBIAS2_POW_CTRL_SEL_A);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget rt5645_dapm_widgets[] = {\n\tSND_SOC_DAPM_SUPPLY(\"LDO2\", RT5645_PWR_MIXER,\n\t\tRT5645_PWR_LDO2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"PLL1\", RT5645_PWR_ANLG2,\n\t\tRT5645_PWR_PLL_BIT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"JD Power\", RT5645_PWR_ANLG2,\n\t\tRT5645_PWR_JD1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Mic Det Power\", RT5645_PWR_VOL,\n\t\tRT5645_PWR_MIC_DET_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"I2S1 ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      11, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"I2S2 ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      12, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC STO ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      10, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC MONO L ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      9, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC MONO R ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      8, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC STO1 ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      7, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC MONO L ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      5, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC MONO R ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      4, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC STO1 ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      3, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC MONO L ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      1, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC MONO R ASRC\", 1, RT5645_ASRC_1,\n\t\t\t      0, 0, NULL, 0),\n\n\t \n\t \n\tSND_SOC_DAPM_SUPPLY(\"micbias1\", RT5645_PWR_ANLG2,\n\t\t\tRT5645_PWR_MB1_BIT, 0, rt5645_set_micbias1_event,\n\t\t\tSND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"micbias2\", RT5645_PWR_ANLG2,\n\t\t\tRT5645_PWR_MB2_BIT, 0, rt5645_set_micbias2_event,\n\t\t\tSND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\t \n\tSND_SOC_DAPM_INPUT(\"DMIC L1\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC R1\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC L2\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC R2\"),\n\n\tSND_SOC_DAPM_INPUT(\"IN1P\"),\n\tSND_SOC_DAPM_INPUT(\"IN1N\"),\n\tSND_SOC_DAPM_INPUT(\"IN2P\"),\n\tSND_SOC_DAPM_INPUT(\"IN2N\"),\n\n\tSND_SOC_DAPM_INPUT(\"Haptic Generator\"),\n\n\tSND_SOC_DAPM_PGA(\"DMIC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DMIC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC CLK\", SND_SOC_NOPM, 0, 0,\n\t\tset_dmic_clk, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC1 Power\", RT5645_DMIC_CTRL1,\n\t\tRT5645_DMIC_1_EN_SFT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC2 Power\", RT5645_DMIC_CTRL1,\n\t\tRT5645_DMIC_2_EN_SFT, 0, NULL, 0),\n\t \n\tSND_SOC_DAPM_PGA(\"BST1\", RT5645_PWR_ANLG2,\n\t\tRT5645_PWR_BST1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA_E(\"BST2\", RT5645_PWR_ANLG2,\n\t\tRT5645_PWR_BST2_BIT, 0, NULL, 0, rt5645_bst2_event,\n\t\tSND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\t \n\tSND_SOC_DAPM_PGA(\"INL VOL\", RT5645_PWR_VOL,\n\t\tRT5645_PWR_IN_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"INR VOL\", RT5645_PWR_VOL,\n\t\tRT5645_PWR_IN_R_BIT, 0, NULL, 0),\n\t \n\tSND_SOC_DAPM_MIXER(\"RECMIXL\", RT5645_PWR_MIXER, RT5645_PWR_RM_L_BIT,\n\t\t\t0, rt5645_rec_l_mix, ARRAY_SIZE(rt5645_rec_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"RECMIXR\", RT5645_PWR_MIXER, RT5645_PWR_RM_R_BIT,\n\t\t\t0, rt5645_rec_r_mix, ARRAY_SIZE(rt5645_rec_r_mix)),\n\t \n\tSND_SOC_DAPM_ADC(\"ADC L\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_ADC(\"ADC R\", NULL, SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"ADC L power\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_ADC_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"ADC R power\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_ADC_R_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"Stereo1 DMIC Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_sto1_dmic_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_sto_adc2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_sto_adc2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC L1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_sto_adc1_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC R1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_sto_adc1_mux),\n\tSND_SOC_DAPM_MUX(\"Mono DMIC L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_dmic_l_mux),\n\tSND_SOC_DAPM_MUX(\"Mono DMIC R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_dmic_r_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_adc_l2_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC L1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_adc_l1_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC R1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_adc_r1_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_mono_adc_r2_mux),\n\t \n\n\tSND_SOC_DAPM_SUPPLY_S(\"adc stereo1 filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_ADC_S1F_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"Sto1 ADC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_sto1_adc_l_mix, ARRAY_SIZE(rt5645_sto1_adc_l_mix),\n\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"Sto1 ADC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_sto1_adc_r_mix, ARRAY_SIZE(rt5645_sto1_adc_r_mix),\n\t\tNULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"adc mono left filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_ADC_MF_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"Mono ADC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_mono_adc_l_mix, ARRAY_SIZE(rt5645_mono_adc_l_mix),\n\t\tNULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"adc mono right filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_ADC_MF_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER_E(\"Mono ADC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_mono_adc_r_mix, ARRAY_SIZE(rt5645_mono_adc_r_mix),\n\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_PGA(\"Stereo1 ADC MIXL\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo1 ADC MIXR\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Sto2 ADC LR MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"VAD_ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF_ADC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF_ADC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC4\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"IF2 ADC Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_if2_adc_in_mux),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"I2S1\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_I2S1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC0\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"I2S2\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_I2S2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"VAD ADC Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_vad_adc_mux),\n\n\t \n\tSND_SOC_DAPM_AIF_IN(\"AIF1RX\", \"AIF1 Playback\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AIF1TX\", \"AIF1 Capture\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"AIF2RX\", \"AIF2 Playback\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AIF2TX\", \"AIF2 Capture\", 0, SND_SOC_NOPM, 0, 0),\n\n\t \n\t \n\tSND_SOC_DAPM_MIXER(\"DAC1 MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_dac_l_mix, ARRAY_SIZE(rt5645_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC1 MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_dac_r_mix, ARRAY_SIZE(rt5645_dac_r_mix)),\n\n\t \n\tSND_SOC_DAPM_MUX(\"DAC L2 Mux\", SND_SOC_NOPM, 0, 0, &rt5645_dac_l2_mux),\n\tSND_SOC_DAPM_MUX(\"DAC R2 Mux\", SND_SOC_NOPM, 0, 0, &rt5645_dac_r2_mux),\n\tSND_SOC_DAPM_PGA(\"DAC L2 Volume\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_DAC_L2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DAC R2 Volume\", RT5645_PWR_DIG1,\n\t\tRT5645_PWR_DAC_R2_BIT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MUX(\"DAC1 L Mux\", SND_SOC_NOPM, 0, 0, &rt5645_dac1l_mux),\n\tSND_SOC_DAPM_MUX(\"DAC1 R Mux\", SND_SOC_NOPM, 0, 0, &rt5645_dac1r_mux),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"dac stereo1 filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_DAC_S1F_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"dac mono left filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_DAC_MF_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"dac mono right filter\", 1, RT5645_PWR_DIG2,\n\t\tRT5645_PWR_DAC_MF_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"Stereo DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_sto_dac_l_mix, ARRAY_SIZE(rt5645_sto_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Stereo DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_sto_dac_r_mix, ARRAY_SIZE(rt5645_sto_dac_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"Mono DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_mono_dac_l_mix, ARRAY_SIZE(rt5645_mono_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Mono DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_mono_dac_r_mix, ARRAY_SIZE(rt5645_mono_dac_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_dig_l_mix, ARRAY_SIZE(rt5645_dig_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\trt5645_dig_r_mix, ARRAY_SIZE(rt5645_dig_r_mix)),\n\n\t \n\tSND_SOC_DAPM_DAC(\"DAC L1\", NULL, RT5645_PWR_DIG1, RT5645_PWR_DAC_L1_BIT,\n\t\t0),\n\tSND_SOC_DAPM_DAC(\"DAC L2\", NULL, RT5645_PWR_DIG1, RT5645_PWR_DAC_L2_BIT,\n\t\t0),\n\tSND_SOC_DAPM_DAC(\"DAC R1\", NULL, RT5645_PWR_DIG1, RT5645_PWR_DAC_R1_BIT,\n\t\t0),\n\tSND_SOC_DAPM_DAC(\"DAC R2\", NULL, RT5645_PWR_DIG1, RT5645_PWR_DAC_R2_BIT,\n\t\t0),\n\t \n\tSND_SOC_DAPM_MIXER(\"SPK MIXL\", RT5645_PWR_MIXER, RT5645_PWR_SM_L_BIT,\n\t\t0, rt5645_spk_l_mix, ARRAY_SIZE(rt5645_spk_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"SPK MIXR\", RT5645_PWR_MIXER, RT5645_PWR_SM_R_BIT,\n\t\t0, rt5645_spk_r_mix, ARRAY_SIZE(rt5645_spk_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"OUT MIXL\", RT5645_PWR_MIXER, RT5645_PWR_OM_L_BIT,\n\t\t0, rt5645_out_l_mix, ARRAY_SIZE(rt5645_out_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"OUT MIXR\", RT5645_PWR_MIXER, RT5645_PWR_OM_R_BIT,\n\t\t0, rt5645_out_r_mix, ARRAY_SIZE(rt5645_out_r_mix)),\n\t \n\tSND_SOC_DAPM_SWITCH(\"SPKVOL L\", RT5645_PWR_VOL, RT5645_PWR_SV_L_BIT, 0,\n\t\t&spk_l_vol_control),\n\tSND_SOC_DAPM_SWITCH(\"SPKVOL R\", RT5645_PWR_VOL, RT5645_PWR_SV_R_BIT, 0,\n\t\t&spk_r_vol_control),\n\tSND_SOC_DAPM_MIXER(\"HPOVOL MIXL\", RT5645_PWR_VOL, RT5645_PWR_HV_L_BIT,\n\t\t0, rt5645_hpvoll_mix, ARRAY_SIZE(rt5645_hpvoll_mix)),\n\tSND_SOC_DAPM_MIXER(\"HPOVOL MIXR\", RT5645_PWR_VOL, RT5645_PWR_HV_R_BIT,\n\t\t0, rt5645_hpvolr_mix, ARRAY_SIZE(rt5645_hpvolr_mix)),\n\tSND_SOC_DAPM_SUPPLY(\"HPOVOL MIXL Power\", RT5645_PWR_MIXER,\n\t\tRT5645_PWR_HM_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"HPOVOL MIXR Power\", RT5645_PWR_MIXER,\n\t\tRT5645_PWR_HM_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DAC 1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DAC 2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"HPOVOL\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SWITCH(\"HPOVOL L\", SND_SOC_NOPM, 0, 0, &hp_l_vol_control),\n\tSND_SOC_DAPM_SWITCH(\"HPOVOL R\", SND_SOC_NOPM, 0, 0, &hp_r_vol_control),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"SPOL MIX\", SND_SOC_NOPM, 0, 0, rt5645_spo_l_mix,\n\t\tARRAY_SIZE(rt5645_spo_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"SPOR MIX\", SND_SOC_NOPM, 0, 0, rt5645_spo_r_mix,\n\t\tARRAY_SIZE(rt5645_spo_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"HPO MIX\", SND_SOC_NOPM, 0, 0, rt5645_hpo_mix,\n\t\tARRAY_SIZE(rt5645_hpo_mix)),\n\tSND_SOC_DAPM_MIXER(\"LOUT MIX\", SND_SOC_NOPM, 0, 0, rt5645_lout_mix,\n\t\tARRAY_SIZE(rt5645_lout_mix)),\n\n\tSND_SOC_DAPM_PGA_S(\"HP amp\", 1, SND_SOC_NOPM, 0, 0, rt5645_hp_event,\n\t\tSND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_PGA_S(\"LOUT amp\", 1, SND_SOC_NOPM, 0, 0, rt5645_lout_event,\n\t\tSND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_PGA_S(\"SPK amp\", 2, SND_SOC_NOPM, 0, 0, rt5645_spk_event,\n\t\tSND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"PDM1 Power\", RT5645_PWR_DIG2, RT5645_PWR_PDM1_BIT,\n\t\t0, NULL, 0),\n\tSND_SOC_DAPM_MUX(\"PDM1 L Mux\", SND_SOC_NOPM, 0, 0, &rt5645_pdm1_l_mux),\n\tSND_SOC_DAPM_MUX(\"PDM1 R Mux\", SND_SOC_NOPM, 0, 0, &rt5645_pdm1_r_mux),\n\n\tSND_SOC_DAPM_SWITCH(\"PDM1 L\", SND_SOC_NOPM, 0, 0, &pdm1_l_vol_control),\n\tSND_SOC_DAPM_SWITCH(\"PDM1 R\", SND_SOC_NOPM, 0, 0, &pdm1_r_vol_control),\n\n\t \n\tSND_SOC_DAPM_OUTPUT(\"HPOL\"),\n\tSND_SOC_DAPM_OUTPUT(\"HPOR\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOUTL\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOUTR\"),\n\tSND_SOC_DAPM_OUTPUT(\"PDM1L\"),\n\tSND_SOC_DAPM_OUTPUT(\"PDM1R\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPOL\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPOR\"),\n};\n\nstatic const struct snd_soc_dapm_widget rt5645_specific_dapm_widgets[] = {\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 DAC1 L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_if1_dac0_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 DAC1 R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_if1_dac1_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 DAC2 L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_if1_dac2_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 DAC2 R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5645_if1_dac3_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 ADC Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_if1_adc_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 ADC1 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_if1_adc1_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 ADC2 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_if1_adc2_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5645 IF1 ADC3 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5645_if1_adc3_in_mux),\n};\n\nstatic const struct snd_soc_dapm_widget rt5650_specific_dapm_widgets[] = {\n\tSND_SOC_DAPM_MUX(\"A DAC1 L Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_a_dac1_l_mux),\n\tSND_SOC_DAPM_MUX(\"A DAC1 R Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_a_dac1_r_mux),\n\tSND_SOC_DAPM_MUX(\"A DAC2 L Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_a_dac2_l_mux),\n\tSND_SOC_DAPM_MUX(\"A DAC2 R Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_a_dac2_r_mux),\n\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 ADC1 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_if1_adc1_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 ADC2 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_if1_adc2_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 ADC3 Swap Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_if1_adc3_in_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 ADC Mux\", SND_SOC_NOPM,\n\t\t0, 0, &rt5650_if1_adc_in_mux),\n\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 DAC1 L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5650_if1_dac0_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 DAC1 R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5650_if1_dac1_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 DAC2 L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5650_if1_dac2_tdm_sel_mux),\n\tSND_SOC_DAPM_MUX(\"RT5650 IF1 DAC2 R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t&rt5650_if1_dac3_tdm_sel_mux),\n};\n\nstatic const struct snd_soc_dapm_route rt5645_dapm_routes[] = {\n\t{ \"adc stereo1 filter\", NULL, \"ADC STO1 ASRC\", is_using_asrc },\n\t{ \"adc mono left filter\", NULL, \"ADC MONO L ASRC\", is_using_asrc },\n\t{ \"adc mono right filter\", NULL, \"ADC MONO R ASRC\", is_using_asrc },\n\t{ \"dac mono left filter\", NULL, \"DAC MONO L ASRC\", is_using_asrc },\n\t{ \"dac mono right filter\", NULL, \"DAC MONO R ASRC\", is_using_asrc },\n\t{ \"dac stereo1 filter\", NULL, \"DAC STO ASRC\", is_using_asrc },\n\n\t{ \"I2S1\", NULL, \"I2S1 ASRC\" },\n\t{ \"I2S2\", NULL, \"I2S2 ASRC\" },\n\n\t{ \"IN1P\", NULL, \"LDO2\" },\n\t{ \"IN2P\", NULL, \"LDO2\" },\n\n\t{ \"DMIC1\", NULL, \"DMIC L1\" },\n\t{ \"DMIC1\", NULL, \"DMIC R1\" },\n\t{ \"DMIC2\", NULL, \"DMIC L2\" },\n\t{ \"DMIC2\", NULL, \"DMIC R2\" },\n\n\t{ \"BST1\", NULL, \"IN1P\" },\n\t{ \"BST1\", NULL, \"IN1N\" },\n\t{ \"BST1\", NULL, \"JD Power\" },\n\t{ \"BST1\", NULL, \"Mic Det Power\" },\n\t{ \"BST2\", NULL, \"IN2P\" },\n\t{ \"BST2\", NULL, \"IN2N\" },\n\n\t{ \"INL VOL\", NULL, \"IN2P\" },\n\t{ \"INR VOL\", NULL, \"IN2N\" },\n\n\t{ \"RECMIXL\", \"HPOL Switch\", \"HPOL\" },\n\t{ \"RECMIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"RECMIXL\", \"BST2 Switch\", \"BST2\" },\n\t{ \"RECMIXL\", \"BST1 Switch\", \"BST1\" },\n\t{ \"RECMIXL\", \"OUT MIXL Switch\", \"OUT MIXL\" },\n\n\t{ \"RECMIXR\", \"HPOR Switch\", \"HPOR\" },\n\t{ \"RECMIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"RECMIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"RECMIXR\", \"BST1 Switch\", \"BST1\" },\n\t{ \"RECMIXR\", \"OUT MIXR Switch\", \"OUT MIXR\" },\n\n\t{ \"ADC L\", NULL, \"RECMIXL\" },\n\t{ \"ADC L\", NULL, \"ADC L power\" },\n\t{ \"ADC R\", NULL, \"RECMIXR\" },\n\t{ \"ADC R\", NULL, \"ADC R power\" },\n\n\t{\"DMIC L1\", NULL, \"DMIC CLK\"},\n\t{\"DMIC L1\", NULL, \"DMIC1 Power\"},\n\t{\"DMIC R1\", NULL, \"DMIC CLK\"},\n\t{\"DMIC R1\", NULL, \"DMIC1 Power\"},\n\t{\"DMIC L2\", NULL, \"DMIC CLK\"},\n\t{\"DMIC L2\", NULL, \"DMIC2 Power\"},\n\t{\"DMIC R2\", NULL, \"DMIC CLK\"},\n\t{\"DMIC R2\", NULL, \"DMIC2 Power\"},\n\n\t{ \"Stereo1 DMIC Mux\", \"DMIC1\", \"DMIC1\" },\n\t{ \"Stereo1 DMIC Mux\", \"DMIC2\", \"DMIC2\" },\n\t{ \"Stereo1 DMIC Mux\", NULL, \"DMIC STO1 ASRC\" },\n\n\t{ \"Mono DMIC L Mux\", \"DMIC1\", \"DMIC L1\" },\n\t{ \"Mono DMIC L Mux\", \"DMIC2\", \"DMIC L2\" },\n\t{ \"Mono DMIC L Mux\", NULL, \"DMIC MONO L ASRC\" },\n\n\t{ \"Mono DMIC R Mux\", \"DMIC1\", \"DMIC R1\" },\n\t{ \"Mono DMIC R Mux\", \"DMIC2\", \"DMIC R2\" },\n\t{ \"Mono DMIC R Mux\", NULL, \"DMIC MONO R ASRC\" },\n\n\t{ \"Stereo1 ADC L2 Mux\", \"DMIC\", \"Stereo1 DMIC Mux\" },\n\t{ \"Stereo1 ADC L2 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\t{ \"Stereo1 ADC L1 Mux\", \"ADC\", \"ADC L\" },\n\t{ \"Stereo1 ADC L1 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\n\t{ \"Stereo1 ADC R1 Mux\", \"ADC\", \"ADC R\" },\n\t{ \"Stereo1 ADC R1 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\t{ \"Stereo1 ADC R2 Mux\", \"DMIC\", \"Stereo1 DMIC Mux\" },\n\t{ \"Stereo1 ADC R2 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\n\t{ \"Mono ADC L2 Mux\", \"DMIC\", \"Mono DMIC L Mux\" },\n\t{ \"Mono ADC L2 Mux\", \"Mono DAC MIXL\", \"Mono DAC MIXL\" },\n\t{ \"Mono ADC L1 Mux\", \"Mono DAC MIXL\", \"Mono DAC MIXL\" },\n\t{ \"Mono ADC L1 Mux\", \"ADC\", \"ADC L\" },\n\n\t{ \"Mono ADC R1 Mux\", \"Mono DAC MIXR\", \"Mono DAC MIXR\" },\n\t{ \"Mono ADC R1 Mux\", \"ADC\", \"ADC R\" },\n\t{ \"Mono ADC R2 Mux\", \"DMIC\", \"Mono DMIC R Mux\" },\n\t{ \"Mono ADC R2 Mux\", \"Mono DAC MIXR\", \"Mono DAC MIXR\" },\n\n\t{ \"Sto1 ADC MIXL\", \"ADC1 Switch\", \"Stereo1 ADC L1 Mux\" },\n\t{ \"Sto1 ADC MIXL\", \"ADC2 Switch\", \"Stereo1 ADC L2 Mux\" },\n\t{ \"Sto1 ADC MIXR\", \"ADC1 Switch\", \"Stereo1 ADC R1 Mux\" },\n\t{ \"Sto1 ADC MIXR\", \"ADC2 Switch\", \"Stereo1 ADC R2 Mux\" },\n\n\t{ \"Stereo1 ADC MIXL\", NULL, \"Sto1 ADC MIXL\" },\n\t{ \"Stereo1 ADC MIXL\", NULL, \"adc stereo1 filter\" },\n\t{ \"adc stereo1 filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Stereo1 ADC MIXR\", NULL, \"Sto1 ADC MIXR\" },\n\t{ \"Stereo1 ADC MIXR\", NULL, \"adc stereo1 filter\" },\n\t{ \"adc stereo1 filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Mono ADC MIXL\", \"ADC1 Switch\", \"Mono ADC L1 Mux\" },\n\t{ \"Mono ADC MIXL\", \"ADC2 Switch\", \"Mono ADC L2 Mux\" },\n\t{ \"Mono ADC MIXL\", NULL, \"adc mono left filter\" },\n\t{ \"adc mono left filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Mono ADC MIXR\", \"ADC1 Switch\", \"Mono ADC R1 Mux\" },\n\t{ \"Mono ADC MIXR\", \"ADC2 Switch\", \"Mono ADC R2 Mux\" },\n\t{ \"Mono ADC MIXR\", NULL, \"adc mono right filter\" },\n\t{ \"adc mono right filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"VAD ADC Mux\", \"Sto1 ADC L\", \"Stereo1 ADC MIXL\" },\n\t{ \"VAD ADC Mux\", \"Mono ADC L\", \"Mono ADC MIXL\" },\n\t{ \"VAD ADC Mux\", \"Mono ADC R\", \"Mono ADC MIXR\" },\n\n\t{ \"IF_ADC1\", NULL, \"Stereo1 ADC MIXL\" },\n\t{ \"IF_ADC1\", NULL, \"Stereo1 ADC MIXR\" },\n\t{ \"IF_ADC2\", NULL, \"Mono ADC MIXL\" },\n\t{ \"IF_ADC2\", NULL, \"Mono ADC MIXR\" },\n\t{ \"VAD_ADC\", NULL, \"VAD ADC Mux\" },\n\n\t{ \"IF2 ADC Mux\", \"IF_ADC1\", \"IF_ADC1\" },\n\t{ \"IF2 ADC Mux\", \"IF_ADC2\", \"IF_ADC2\" },\n\t{ \"IF2 ADC Mux\", \"VAD_ADC\", \"VAD_ADC\" },\n\n\t{ \"IF1 ADC\", NULL, \"I2S1\" },\n\t{ \"IF2 ADC\", NULL, \"I2S2\" },\n\t{ \"IF2 ADC\", NULL, \"IF2 ADC Mux\" },\n\n\t{ \"AIF2TX\", NULL, \"IF2 ADC\" },\n\n\t{ \"IF1 DAC0\", NULL, \"AIF1RX\" },\n\t{ \"IF1 DAC1\", NULL, \"AIF1RX\" },\n\t{ \"IF1 DAC2\", NULL, \"AIF1RX\" },\n\t{ \"IF1 DAC3\", NULL, \"AIF1RX\" },\n\t{ \"IF2 DAC\", NULL, \"AIF2RX\" },\n\n\t{ \"IF1 DAC0\", NULL, \"I2S1\" },\n\t{ \"IF1 DAC1\", NULL, \"I2S1\" },\n\t{ \"IF1 DAC2\", NULL, \"I2S1\" },\n\t{ \"IF1 DAC3\", NULL, \"I2S1\" },\n\t{ \"IF2 DAC\", NULL, \"I2S2\" },\n\n\t{ \"IF2 DAC L\", NULL, \"IF2 DAC\" },\n\t{ \"IF2 DAC R\", NULL, \"IF2 DAC\" },\n\n\t{ \"DAC1 L Mux\", \"IF2 DAC\", \"IF2 DAC L\" },\n\t{ \"DAC1 R Mux\", \"IF2 DAC\", \"IF2 DAC R\" },\n\n\t{ \"DAC1 MIXL\", \"Stereo ADC Switch\", \"Stereo1 ADC MIXL\" },\n\t{ \"DAC1 MIXL\", \"DAC1 Switch\", \"DAC1 L Mux\" },\n\t{ \"DAC1 MIXL\", NULL, \"dac stereo1 filter\" },\n\t{ \"DAC1 MIXR\", \"Stereo ADC Switch\", \"Stereo1 ADC MIXR\" },\n\t{ \"DAC1 MIXR\", \"DAC1 Switch\", \"DAC1 R Mux\" },\n\t{ \"DAC1 MIXR\", NULL, \"dac stereo1 filter\" },\n\n\t{ \"DAC L2 Mux\", \"IF2 DAC\", \"IF2 DAC L\" },\n\t{ \"DAC L2 Mux\", \"Mono ADC\", \"Mono ADC MIXL\" },\n\t{ \"DAC L2 Mux\", \"VAD_ADC\", \"VAD_ADC\" },\n\t{ \"DAC L2 Volume\", NULL, \"DAC L2 Mux\" },\n\t{ \"DAC L2 Volume\", NULL, \"dac mono left filter\" },\n\n\t{ \"DAC R2 Mux\", \"IF2 DAC\", \"IF2 DAC R\" },\n\t{ \"DAC R2 Mux\", \"Mono ADC\", \"Mono ADC MIXR\" },\n\t{ \"DAC R2 Mux\", \"Haptic\", \"Haptic Generator\" },\n\t{ \"DAC R2 Volume\", NULL, \"DAC R2 Mux\" },\n\t{ \"DAC R2 Volume\", NULL, \"dac mono right filter\" },\n\n\t{ \"Stereo DAC MIXL\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Stereo DAC MIXL\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Stereo DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Stereo DAC MIXL\", NULL, \"dac stereo1 filter\" },\n\t{ \"Stereo DAC MIXR\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Stereo DAC MIXR\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Stereo DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Stereo DAC MIXR\", NULL, \"dac stereo1 filter\" },\n\n\t{ \"Mono DAC MIXL\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Mono DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Mono DAC MIXL\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Mono DAC MIXL\", NULL, \"dac mono left filter\" },\n\t{ \"Mono DAC MIXR\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Mono DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Mono DAC MIXR\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Mono DAC MIXR\", NULL, \"dac mono right filter\" },\n\n\t{ \"DAC MIXL\", \"Sto DAC Mix L Switch\", \"Stereo DAC MIXL\" },\n\t{ \"DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"DAC MIXL\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"DAC MIXR\", \"Sto DAC Mix R Switch\", \"Stereo DAC MIXR\" },\n\t{ \"DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"DAC MIXR\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\n\t{ \"DAC L1\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\t{ \"DAC R1\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\t{ \"DAC L2\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\t{ \"DAC R2\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"SPK MIXL\", \"BST1 Switch\", \"BST1\" },\n\t{ \"SPK MIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"SPK MIXL\", \"DAC L1 Switch\", \"DAC L1\" },\n\t{ \"SPK MIXL\", \"DAC L2 Switch\", \"DAC L2\" },\n\t{ \"SPK MIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"SPK MIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"SPK MIXR\", \"DAC R1 Switch\", \"DAC R1\" },\n\t{ \"SPK MIXR\", \"DAC R2 Switch\", \"DAC R2\" },\n\n\t{ \"OUT MIXL\", \"BST1 Switch\", \"BST1\" },\n\t{ \"OUT MIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"OUT MIXL\", \"DAC L2 Switch\", \"DAC L2\" },\n\t{ \"OUT MIXL\", \"DAC L1 Switch\", \"DAC L1\" },\n\n\t{ \"OUT MIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"OUT MIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"OUT MIXR\", \"DAC R2 Switch\", \"DAC R2\" },\n\t{ \"OUT MIXR\", \"DAC R1 Switch\", \"DAC R1\" },\n\n\t{ \"HPOVOL MIXL\", \"DAC1 Switch\", \"DAC L1\" },\n\t{ \"HPOVOL MIXL\", \"DAC2 Switch\", \"DAC L2\" },\n\t{ \"HPOVOL MIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"HPOVOL MIXL\", \"BST1 Switch\", \"BST1\" },\n\t{ \"HPOVOL MIXL\", NULL, \"HPOVOL MIXL Power\" },\n\t{ \"HPOVOL MIXR\", \"DAC1 Switch\", \"DAC R1\" },\n\t{ \"HPOVOL MIXR\", \"DAC2 Switch\", \"DAC R2\" },\n\t{ \"HPOVOL MIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"HPOVOL MIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"HPOVOL MIXR\", NULL, \"HPOVOL MIXR Power\" },\n\n\t{ \"DAC 2\", NULL, \"DAC L2\" },\n\t{ \"DAC 2\", NULL, \"DAC R2\" },\n\t{ \"DAC 1\", NULL, \"DAC L1\" },\n\t{ \"DAC 1\", NULL, \"DAC R1\" },\n\t{ \"HPOVOL L\", \"Switch\", \"HPOVOL MIXL\" },\n\t{ \"HPOVOL R\", \"Switch\", \"HPOVOL MIXR\" },\n\t{ \"HPOVOL\", NULL, \"HPOVOL L\" },\n\t{ \"HPOVOL\", NULL, \"HPOVOL R\" },\n\t{ \"HPO MIX\", \"DAC1 Switch\", \"DAC 1\" },\n\t{ \"HPO MIX\", \"HPVOL Switch\", \"HPOVOL\" },\n\n\t{ \"SPKVOL L\", \"Switch\", \"SPK MIXL\" },\n\t{ \"SPKVOL R\", \"Switch\", \"SPK MIXR\" },\n\n\t{ \"SPOL MIX\", \"DAC L1 Switch\", \"DAC L1\" },\n\t{ \"SPOL MIX\", \"SPKVOL L Switch\", \"SPKVOL L\" },\n\t{ \"SPOR MIX\", \"DAC R1 Switch\", \"DAC R1\" },\n\t{ \"SPOR MIX\", \"SPKVOL R Switch\", \"SPKVOL R\" },\n\n\t{ \"LOUT MIX\", \"DAC L1 Switch\", \"DAC L1\" },\n\t{ \"LOUT MIX\", \"DAC R1 Switch\", \"DAC R1\" },\n\t{ \"LOUT MIX\", \"OUTMIX L Switch\", \"OUT MIXL\" },\n\t{ \"LOUT MIX\", \"OUTMIX R Switch\", \"OUT MIXR\" },\n\n\t{ \"PDM1 L Mux\", \"Stereo DAC\", \"Stereo DAC MIXL\" },\n\t{ \"PDM1 L Mux\", \"Mono DAC\", \"Mono DAC MIXL\" },\n\t{ \"PDM1 L Mux\", NULL, \"PDM1 Power\" },\n\t{ \"PDM1 R Mux\", \"Stereo DAC\", \"Stereo DAC MIXR\" },\n\t{ \"PDM1 R Mux\", \"Mono DAC\", \"Mono DAC MIXR\" },\n\t{ \"PDM1 R Mux\", NULL, \"PDM1 Power\" },\n\n\t{ \"HP amp\", NULL, \"HPO MIX\" },\n\t{ \"HP amp\", NULL, \"JD Power\" },\n\t{ \"HP amp\", NULL, \"Mic Det Power\" },\n\t{ \"HP amp\", NULL, \"LDO2\" },\n\t{ \"HPOL\", NULL, \"HP amp\" },\n\t{ \"HPOR\", NULL, \"HP amp\" },\n\n\t{ \"LOUT amp\", NULL, \"LOUT MIX\" },\n\t{ \"LOUTL\", NULL, \"LOUT amp\" },\n\t{ \"LOUTR\", NULL, \"LOUT amp\" },\n\n\t{ \"PDM1 L\", \"Switch\", \"PDM1 L Mux\" },\n\t{ \"PDM1 R\", \"Switch\", \"PDM1 R Mux\" },\n\n\t{ \"PDM1L\", NULL, \"PDM1 L\" },\n\t{ \"PDM1R\", NULL, \"PDM1 R\" },\n\n\t{ \"SPK amp\", NULL, \"SPOL MIX\" },\n\t{ \"SPK amp\", NULL, \"SPOR MIX\" },\n\t{ \"SPOL\", NULL, \"SPK amp\" },\n\t{ \"SPOR\", NULL, \"SPK amp\" },\n};\n\nstatic const struct snd_soc_dapm_route rt5650_specific_dapm_routes[] = {\n\t{ \"A DAC1 L Mux\", \"DAC1\",  \"DAC1 MIXL\"},\n\t{ \"A DAC1 L Mux\", \"Stereo DAC Mixer\", \"Stereo DAC MIXL\"},\n\t{ \"A DAC1 R Mux\", \"DAC1\",  \"DAC1 MIXR\"},\n\t{ \"A DAC1 R Mux\", \"Stereo DAC Mixer\", \"Stereo DAC MIXR\"},\n\n\t{ \"A DAC2 L Mux\", \"Stereo DAC Mixer\", \"Stereo DAC MIXL\"},\n\t{ \"A DAC2 L Mux\", \"Mono DAC Mixer\", \"Mono DAC MIXL\"},\n\t{ \"A DAC2 R Mux\", \"Stereo DAC Mixer\", \"Stereo DAC MIXR\"},\n\t{ \"A DAC2 R Mux\", \"Mono DAC Mixer\", \"Mono DAC MIXR\"},\n\n\t{ \"DAC L1\", NULL, \"A DAC1 L Mux\" },\n\t{ \"DAC R1\", NULL, \"A DAC1 R Mux\" },\n\t{ \"DAC L2\", NULL, \"A DAC2 L Mux\" },\n\t{ \"DAC R2\", NULL, \"A DAC2 R Mux\" },\n\n\t{ \"RT5650 IF1 ADC1 Swap Mux\", \"L/R\", \"IF_ADC1\" },\n\t{ \"RT5650 IF1 ADC1 Swap Mux\", \"R/L\", \"IF_ADC1\" },\n\t{ \"RT5650 IF1 ADC1 Swap Mux\", \"L/L\", \"IF_ADC1\" },\n\t{ \"RT5650 IF1 ADC1 Swap Mux\", \"R/R\", \"IF_ADC1\" },\n\n\t{ \"RT5650 IF1 ADC2 Swap Mux\", \"L/R\", \"IF_ADC2\" },\n\t{ \"RT5650 IF1 ADC2 Swap Mux\", \"R/L\", \"IF_ADC2\" },\n\t{ \"RT5650 IF1 ADC2 Swap Mux\", \"L/L\", \"IF_ADC2\" },\n\t{ \"RT5650 IF1 ADC2 Swap Mux\", \"R/R\", \"IF_ADC2\" },\n\n\t{ \"RT5650 IF1 ADC3 Swap Mux\", \"L/R\", \"VAD_ADC\" },\n\t{ \"RT5650 IF1 ADC3 Swap Mux\", \"R/L\", \"VAD_ADC\" },\n\t{ \"RT5650 IF1 ADC3 Swap Mux\", \"L/L\", \"VAD_ADC\" },\n\t{ \"RT5650 IF1 ADC3 Swap Mux\", \"R/R\", \"VAD_ADC\" },\n\n\t{ \"IF1 ADC\", NULL, \"RT5650 IF1 ADC1 Swap Mux\" },\n\t{ \"IF1 ADC\", NULL, \"RT5650 IF1 ADC2 Swap Mux\" },\n\t{ \"IF1 ADC\", NULL, \"RT5650 IF1 ADC3 Swap Mux\" },\n\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/IF_ADC2/DAC_REF/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/IF_ADC2/Null/DAC_REF\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/DAC_REF/IF_ADC2/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/DAC_REF/Null/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/Null/DAC_REF/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC1/Null/IF_ADC2/DAC_REF\", \"IF1 ADC\" },\n\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/IF_ADC1/DAC_REF/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/IF_ADC1/Null/DAC_REF\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/DAC_REF/IF_ADC1/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/DAC_REF/Null/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/Null/DAC_REF/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"IF_ADC2/Null/IF_ADC1/DAC_REF\", \"IF1 ADC\" },\n\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/IF_ADC1/IF_ADC2/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/IF_ADC1/Null/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/IF_ADC2/IF_ADC1/Null\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/IF_ADC2/Null/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/Null/IF_ADC1/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"DAC_REF/Null/IF_ADC2/IF_ADC1\", \"IF1 ADC\" },\n\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/IF_ADC1/IF_ADC2/DAC_REF\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/IF_ADC1/DAC_REF/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/IF_ADC2/IF_ADC1/DAC_REF\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/IF_ADC2/DAC_REF/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/DAC_REF/IF_ADC1/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5650 IF1 ADC Mux\", \"Null/DAC_REF/IF_ADC2/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"AIF1TX\", NULL, \"RT5650 IF1 ADC Mux\" },\n\n\t{ \"RT5650 IF1 DAC1 L Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5650 IF1 DAC1 L Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5650 IF1 DAC1 L Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5650 IF1 DAC1 L Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5650 IF1 DAC1 R Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5650 IF1 DAC1 R Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5650 IF1 DAC1 R Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5650 IF1 DAC1 R Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5650 IF1 DAC2 L Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5650 IF1 DAC2 L Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5650 IF1 DAC2 L Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5650 IF1 DAC2 L Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5650 IF1 DAC2 R Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5650 IF1 DAC2 R Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5650 IF1 DAC2 R Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5650 IF1 DAC2 R Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"DAC1 L Mux\", \"IF1 DAC\", \"RT5650 IF1 DAC1 L Mux\" },\n\t{ \"DAC1 R Mux\", \"IF1 DAC\", \"RT5650 IF1 DAC1 R Mux\" },\n\n\t{ \"DAC L2 Mux\", \"IF1 DAC\", \"RT5650 IF1 DAC2 L Mux\" },\n\t{ \"DAC R2 Mux\", \"IF1 DAC\", \"RT5650 IF1 DAC2 R Mux\" },\n};\n\nstatic const struct snd_soc_dapm_route rt5645_specific_dapm_routes[] = {\n\t{ \"DAC L1\", NULL, \"Stereo DAC MIXL\" },\n\t{ \"DAC R1\", NULL, \"Stereo DAC MIXR\" },\n\t{ \"DAC L2\", NULL, \"Mono DAC MIXL\" },\n\t{ \"DAC R2\", NULL, \"Mono DAC MIXR\" },\n\n\t{ \"RT5645 IF1 ADC1 Swap Mux\", \"L/R\", \"IF_ADC1\" },\n\t{ \"RT5645 IF1 ADC1 Swap Mux\", \"R/L\", \"IF_ADC1\" },\n\t{ \"RT5645 IF1 ADC1 Swap Mux\", \"L/L\", \"IF_ADC1\" },\n\t{ \"RT5645 IF1 ADC1 Swap Mux\", \"R/R\", \"IF_ADC1\" },\n\n\t{ \"RT5645 IF1 ADC2 Swap Mux\", \"L/R\", \"IF_ADC2\" },\n\t{ \"RT5645 IF1 ADC2 Swap Mux\", \"R/L\", \"IF_ADC2\" },\n\t{ \"RT5645 IF1 ADC2 Swap Mux\", \"L/L\", \"IF_ADC2\" },\n\t{ \"RT5645 IF1 ADC2 Swap Mux\", \"R/R\", \"IF_ADC2\" },\n\n\t{ \"RT5645 IF1 ADC3 Swap Mux\", \"L/R\", \"VAD_ADC\" },\n\t{ \"RT5645 IF1 ADC3 Swap Mux\", \"R/L\", \"VAD_ADC\" },\n\t{ \"RT5645 IF1 ADC3 Swap Mux\", \"L/L\", \"VAD_ADC\" },\n\t{ \"RT5645 IF1 ADC3 Swap Mux\", \"R/R\", \"VAD_ADC\" },\n\n\t{ \"IF1 ADC\", NULL, \"RT5645 IF1 ADC1 Swap Mux\" },\n\t{ \"IF1 ADC\", NULL, \"RT5645 IF1 ADC2 Swap Mux\" },\n\t{ \"IF1 ADC\", NULL, \"RT5645 IF1 ADC3 Swap Mux\" },\n\n\t{ \"RT5645 IF1 ADC Mux\", \"IF_ADC1/IF_ADC2/VAD_ADC\", \"IF1 ADC\" },\n\t{ \"RT5645 IF1 ADC Mux\", \"IF_ADC2/IF_ADC1/VAD_ADC\", \"IF1 ADC\" },\n\t{ \"RT5645 IF1 ADC Mux\", \"VAD_ADC/IF_ADC1/IF_ADC2\", \"IF1 ADC\" },\n\t{ \"RT5645 IF1 ADC Mux\", \"VAD_ADC/IF_ADC2/IF_ADC1\", \"IF1 ADC\" },\n\t{ \"AIF1TX\", NULL, \"RT5645 IF1 ADC Mux\" },\n\n\t{ \"RT5645 IF1 DAC1 L Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5645 IF1 DAC1 L Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5645 IF1 DAC1 L Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5645 IF1 DAC1 L Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5645 IF1 DAC1 R Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5645 IF1 DAC1 R Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5645 IF1 DAC1 R Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5645 IF1 DAC1 R Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5645 IF1 DAC2 L Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5645 IF1 DAC2 L Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5645 IF1 DAC2 L Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5645 IF1 DAC2 L Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"RT5645 IF1 DAC2 R Mux\", \"Slot0\", \"IF1 DAC0\" },\n\t{ \"RT5645 IF1 DAC2 R Mux\", \"Slot1\", \"IF1 DAC1\" },\n\t{ \"RT5645 IF1 DAC2 R Mux\", \"Slot2\", \"IF1 DAC2\" },\n\t{ \"RT5645 IF1 DAC2 R Mux\", \"Slot3\", \"IF1 DAC3\" },\n\n\t{ \"DAC1 L Mux\", \"IF1 DAC\", \"RT5645 IF1 DAC1 L Mux\" },\n\t{ \"DAC1 R Mux\", \"IF1 DAC\", \"RT5645 IF1 DAC1 R Mux\" },\n\n\t{ \"DAC L2 Mux\", \"IF1 DAC\", \"RT5645 IF1 DAC2 L Mux\" },\n\t{ \"DAC R2 Mux\", \"IF1 DAC\", \"RT5645 IF1 DAC2 R Mux\" },\n};\n\nstatic const struct snd_soc_dapm_route rt5645_old_dapm_routes[] = {\n\t{ \"SPOL MIX\", \"DAC R1 Switch\", \"DAC R1\" },\n\t{ \"SPOL MIX\", \"SPKVOL R Switch\", \"SPKVOL R\" },\n};\n\nstatic int rt5645_hw_params(struct snd_pcm_substream *substream,\n\tstruct snd_pcm_hw_params *params, struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tunsigned int val_len = 0, val_clk, mask_clk, dl_sft;\n\tint pre_div, bclk_ms, frame_size;\n\n\trt5645->lrck[dai->id] = params_rate(params);\n\tpre_div = rl6231_get_clk_info(rt5645->sysclk, rt5645->lrck[dai->id]);\n\tif (pre_div < 0) {\n\t\tdev_err(component->dev, \"Unsupported clock setting\\n\");\n\t\treturn -EINVAL;\n\t}\n\tframe_size = snd_soc_params_to_frame_size(params);\n\tif (frame_size < 0) {\n\t\tdev_err(component->dev, \"Unsupported frame size: %d\\n\", frame_size);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (rt5645->codec_type) {\n\tcase CODEC_TYPE_RT5650:\n\t\tdl_sft = 4;\n\t\tbreak;\n\tdefault:\n\t\tdl_sft = 2;\n\t\tbreak;\n\t}\n\n\tbclk_ms = frame_size > 32;\n\trt5645->bclk[dai->id] = rt5645->lrck[dai->id] * (32 << bclk_ms);\n\n\tdev_dbg(dai->dev, \"bclk is %dHz and lrck is %dHz\\n\",\n\t\trt5645->bclk[dai->id], rt5645->lrck[dai->id]);\n\tdev_dbg(dai->dev, \"bclk_ms is %d and pre_div is %d for iis %d\\n\",\n\t\t\t\tbclk_ms, pre_div, dai->id);\n\n\tswitch (params_width(params)) {\n\tcase 16:\n\t\tbreak;\n\tcase 20:\n\t\tval_len = 0x1;\n\t\tbreak;\n\tcase 24:\n\t\tval_len = 0x2;\n\t\tbreak;\n\tcase 8:\n\t\tval_len = 0x3;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (dai->id) {\n\tcase RT5645_AIF1:\n\t\tmask_clk = RT5645_I2S_PD1_MASK;\n\t\tval_clk = pre_div << RT5645_I2S_PD1_SFT;\n\t\tsnd_soc_component_update_bits(component, RT5645_I2S1_SDP,\n\t\t\t(0x3 << dl_sft), (val_len << dl_sft));\n\t\tsnd_soc_component_update_bits(component, RT5645_ADDA_CLK1, mask_clk, val_clk);\n\t\tbreak;\n\tcase  RT5645_AIF2:\n\t\tmask_clk = RT5645_I2S_BCLK_MS2_MASK | RT5645_I2S_PD2_MASK;\n\t\tval_clk = bclk_ms << RT5645_I2S_BCLK_MS2_SFT |\n\t\t\tpre_div << RT5645_I2S_PD2_SFT;\n\t\tsnd_soc_component_update_bits(component, RT5645_I2S2_SDP,\n\t\t\t(0x3 << dl_sft), (val_len << dl_sft));\n\t\tsnd_soc_component_update_bits(component, RT5645_ADDA_CLK1, mask_clk, val_clk);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5645_set_dai_fmt(struct snd_soc_dai *dai, unsigned int fmt)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tunsigned int reg_val = 0, pol_sft;\n\n\tswitch (rt5645->codec_type) {\n\tcase CODEC_TYPE_RT5650:\n\t\tpol_sft = 8;\n\t\tbreak;\n\tdefault:\n\t\tpol_sft = 7;\n\t\tbreak;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_MASTER_MASK) {\n\tcase SND_SOC_DAIFMT_CBM_CFM:\n\t\trt5645->master[dai->id] = 1;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBS_CFS:\n\t\treg_val |= RT5645_I2S_MS_S;\n\t\trt5645->master[dai->id] = 0;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_INV_MASK) {\n\tcase SND_SOC_DAIFMT_NB_NF:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_NF:\n\t\treg_val |= (1 << pol_sft);\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_LEFT_J:\n\t\treg_val |= RT5645_I2S_DF_LEFT;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_A:\n\t\treg_val |= RT5645_I2S_DF_PCM_A;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_B:\n\t\treg_val |= RT5645_I2S_DF_PCM_B;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tswitch (dai->id) {\n\tcase RT5645_AIF1:\n\t\tsnd_soc_component_update_bits(component, RT5645_I2S1_SDP,\n\t\t\tRT5645_I2S_MS_MASK | (1 << pol_sft) |\n\t\t\tRT5645_I2S_DF_MASK, reg_val);\n\t\tbreak;\n\tcase RT5645_AIF2:\n\t\tsnd_soc_component_update_bits(component, RT5645_I2S2_SDP,\n\t\t\tRT5645_I2S_MS_MASK | (1 << pol_sft) |\n\t\t\tRT5645_I2S_DF_MASK, reg_val);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\treturn -EINVAL;\n\t}\n\treturn 0;\n}\n\nstatic int rt5645_set_dai_sysclk(struct snd_soc_dai *dai,\n\t\tint clk_id, unsigned int freq, int dir)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tunsigned int reg_val = 0;\n\n\tif (freq == rt5645->sysclk && clk_id == rt5645->sysclk_src)\n\t\treturn 0;\n\n\tswitch (clk_id) {\n\tcase RT5645_SCLK_S_MCLK:\n\t\treg_val |= RT5645_SCLK_SRC_MCLK;\n\t\tbreak;\n\tcase RT5645_SCLK_S_PLL1:\n\t\treg_val |= RT5645_SCLK_SRC_PLL1;\n\t\tbreak;\n\tcase RT5645_SCLK_S_RCCLK:\n\t\treg_val |= RT5645_SCLK_SRC_RCCLK;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid clock id (%d)\\n\", clk_id);\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, RT5645_GLB_CLK,\n\t\tRT5645_SCLK_SRC_MASK, reg_val);\n\trt5645->sysclk = freq;\n\trt5645->sysclk_src = clk_id;\n\n\tdev_dbg(dai->dev, \"Sysclk is %dHz and clock id is %d\\n\", freq, clk_id);\n\n\treturn 0;\n}\n\nstatic int rt5645_set_dai_pll(struct snd_soc_dai *dai, int pll_id, int source,\n\t\t\tunsigned int freq_in, unsigned int freq_out)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tstruct rl6231_pll_code pll_code;\n\tint ret;\n\n\tif (source == rt5645->pll_src && freq_in == rt5645->pll_in &&\n\t    freq_out == rt5645->pll_out)\n\t\treturn 0;\n\n\tif (!freq_in || !freq_out) {\n\t\tdev_dbg(component->dev, \"PLL disabled\\n\");\n\n\t\trt5645->pll_in = 0;\n\t\trt5645->pll_out = 0;\n\t\tsnd_soc_component_update_bits(component, RT5645_GLB_CLK,\n\t\t\tRT5645_SCLK_SRC_MASK, RT5645_SCLK_SRC_MCLK);\n\t\treturn 0;\n\t}\n\n\tswitch (source) {\n\tcase RT5645_PLL1_S_MCLK:\n\t\tsnd_soc_component_update_bits(component, RT5645_GLB_CLK,\n\t\t\tRT5645_PLL1_SRC_MASK, RT5645_PLL1_SRC_MCLK);\n\t\tbreak;\n\tcase RT5645_PLL1_S_BCLK1:\n\tcase RT5645_PLL1_S_BCLK2:\n\t\tswitch (dai->id) {\n\t\tcase RT5645_AIF1:\n\t\t\tsnd_soc_component_update_bits(component, RT5645_GLB_CLK,\n\t\t\t\tRT5645_PLL1_SRC_MASK, RT5645_PLL1_SRC_BCLK1);\n\t\t\tbreak;\n\t\tcase  RT5645_AIF2:\n\t\t\tsnd_soc_component_update_bits(component, RT5645_GLB_CLK,\n\t\t\t\tRT5645_PLL1_SRC_MASK, RT5645_PLL1_SRC_BCLK2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Unknown PLL source %d\\n\", source);\n\t\treturn -EINVAL;\n\t}\n\n\tret = rl6231_pll_calc(freq_in, freq_out, &pll_code);\n\tif (ret < 0) {\n\t\tdev_err(component->dev, \"Unsupported input clock %d\\n\", freq_in);\n\t\treturn ret;\n\t}\n\n\tdev_dbg(component->dev, \"bypass=%d m=%d n=%d k=%d\\n\",\n\t\tpll_code.m_bp, (pll_code.m_bp ? 0 : pll_code.m_code),\n\t\tpll_code.n_code, pll_code.k_code);\n\n\tsnd_soc_component_write(component, RT5645_PLL_CTRL1,\n\t\tpll_code.n_code << RT5645_PLL_N_SFT | pll_code.k_code);\n\tsnd_soc_component_write(component, RT5645_PLL_CTRL2,\n\t\t((pll_code.m_bp ? 0 : pll_code.m_code) << RT5645_PLL_M_SFT) |\n\t\t(pll_code.m_bp << RT5645_PLL_M_BP_SFT));\n\n\trt5645->pll_in = freq_in;\n\trt5645->pll_out = freq_out;\n\trt5645->pll_src = source;\n\n\treturn 0;\n}\n\nstatic int rt5645_set_tdm_slot(struct snd_soc_dai *dai, unsigned int tx_mask,\n\t\t\tunsigned int rx_mask, int slots, int slot_width)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tunsigned int i_slot_sft, o_slot_sft, i_width_sht, o_width_sht, en_sft;\n\tunsigned int mask, val = 0;\n\n\tswitch (rt5645->codec_type) {\n\tcase CODEC_TYPE_RT5650:\n\t\ten_sft = 15;\n\t\ti_slot_sft = 10;\n\t\to_slot_sft = 8;\n\t\ti_width_sht = 6;\n\t\to_width_sht = 4;\n\t\tmask = 0x8ff0;\n\t\tbreak;\n\tdefault:\n\t\ten_sft = 14;\n\t\ti_slot_sft = o_slot_sft = 12;\n\t\ti_width_sht = o_width_sht = 10;\n\t\tmask = 0x7c00;\n\t\tbreak;\n\t}\n\tif (rx_mask || tx_mask) {\n\t\tval |= (1 << en_sft);\n\t\tif (rt5645->codec_type == CODEC_TYPE_RT5645)\n\t\t\tsnd_soc_component_update_bits(component, RT5645_BASS_BACK,\n\t\t\t\tRT5645_G_BB_BST_MASK, RT5645_G_BB_BST_25DB);\n\t}\n\n\tswitch (slots) {\n\tcase 4:\n\t\tval |= (1 << i_slot_sft) | (1 << o_slot_sft);\n\t\tbreak;\n\tcase 6:\n\t\tval |= (2 << i_slot_sft) | (2 << o_slot_sft);\n\t\tbreak;\n\tcase 8:\n\t\tval |= (3 << i_slot_sft) | (3 << o_slot_sft);\n\t\tbreak;\n\tcase 2:\n\tdefault:\n\t\tbreak;\n\t}\n\n\tswitch (slot_width) {\n\tcase 20:\n\t\tval |= (1 << i_width_sht) | (1 << o_width_sht);\n\t\tbreak;\n\tcase 24:\n\t\tval |= (2 << i_width_sht) | (2 << o_width_sht);\n\t\tbreak;\n\tcase 32:\n\t\tval |= (3 << i_width_sht) | (3 << o_width_sht);\n\t\tbreak;\n\tcase 16:\n\tdefault:\n\t\tbreak;\n\t}\n\n\tsnd_soc_component_update_bits(component, RT5645_TDM_CTRL_1, mask, val);\n\n\treturn 0;\n}\n\nstatic int rt5645_set_bias_level(struct snd_soc_component *component,\n\t\t\tenum snd_soc_bias_level level)\n{\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\tswitch (level) {\n\tcase SND_SOC_BIAS_PREPARE:\n\t\tif (SND_SOC_BIAS_STANDBY == snd_soc_component_get_bias_level(component)) {\n\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\tRT5645_PWR_VREF1 | RT5645_PWR_MB |\n\t\t\t\tRT5645_PWR_BG | RT5645_PWR_VREF2,\n\t\t\t\tRT5645_PWR_VREF1 | RT5645_PWR_MB |\n\t\t\t\tRT5645_PWR_BG | RT5645_PWR_VREF2);\n\t\t\tmdelay(10);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2,\n\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2);\n\t\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL1,\n\t\t\t\tRT5645_DIG_GATE_CTRL, RT5645_DIG_GATE_CTRL);\n\t\t}\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\tRT5645_PWR_VREF1 | RT5645_PWR_MB |\n\t\t\tRT5645_PWR_BG | RT5645_PWR_VREF2,\n\t\t\tRT5645_PWR_VREF1 | RT5645_PWR_MB |\n\t\t\tRT5645_PWR_BG | RT5645_PWR_VREF2);\n\t\tmdelay(10);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2,\n\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2);\n\t\tif (snd_soc_component_get_bias_level(component) == SND_SOC_BIAS_OFF) {\n\t\t\tsnd_soc_component_write(component, RT5645_DEPOP_M2, 0x1140);\n\t\t\tmsleep(40);\n\t\t\tif (rt5645->en_button_func)\n\t\t\t\tqueue_delayed_work(system_power_efficient_wq,\n\t\t\t\t\t&rt5645->jack_detect_work,\n\t\t\t\t\tmsecs_to_jiffies(0));\n\t\t}\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_OFF:\n\t\tsnd_soc_component_write(component, RT5645_DEPOP_M2, 0x1100);\n\t\tif (!rt5645->en_button_func)\n\t\t\tsnd_soc_component_update_bits(component, RT5645_GEN_CTRL1,\n\t\t\t\t\tRT5645_DIG_GATE_CTRL, 0);\n\t\tsnd_soc_component_update_bits(component, RT5645_PWR_ANLG1,\n\t\t\t\tRT5645_PWR_VREF1 | RT5645_PWR_MB |\n\t\t\t\tRT5645_PWR_BG | RT5645_PWR_VREF2 |\n\t\t\t\tRT5645_PWR_FV1 | RT5645_PWR_FV2, 0x0);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic void rt5645_enable_push_button_irq(struct snd_soc_component *component,\n\tbool enable)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\n\tif (enable) {\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"ADC L power\");\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"ADC R power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\n\t\tsnd_soc_component_update_bits(component, RT5650_4BTN_IL_CMD1, 0x3, 0x3);\n\t\tsnd_soc_component_update_bits(component,\n\t\t\t\t\tRT5645_INT_IRQ_ST, 0x8, 0x8);\n\t\tsnd_soc_component_update_bits(component,\n\t\t\t\t\tRT5650_4BTN_IL_CMD2, 0x8000, 0x8000);\n\t\tsnd_soc_component_read(component, RT5650_4BTN_IL_CMD1);\n\t\tpr_debug(\"%s read %x = %x\\n\", __func__, RT5650_4BTN_IL_CMD1,\n\t\t\tsnd_soc_component_read(component, RT5650_4BTN_IL_CMD1));\n\t} else {\n\t\tsnd_soc_component_update_bits(component, RT5650_4BTN_IL_CMD2, 0x8000, 0x0);\n\t\tsnd_soc_component_update_bits(component, RT5645_INT_IRQ_ST, 0x8, 0x0);\n\n\t\tsnd_soc_dapm_disable_pin(dapm, \"ADC L power\");\n\t\tsnd_soc_dapm_disable_pin(dapm, \"ADC R power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t}\n}\n\nstatic int rt5645_jack_detect(struct snd_soc_component *component, int jack_insert)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\tunsigned int val;\n\n\tif (jack_insert) {\n\t\tregmap_write(rt5645->regmap, RT5645_CHARGE_PUMP, 0x0206);\n\n\t\t \n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"LDO2\");\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"Mic Det Power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t\tif (!snd_soc_card_is_instantiated(dapm->card)) {\n\t\t\t \n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_PWR_ANLG1,\n\t\t\t\tRT5645_PWR_MB | RT5645_PWR_VREF2,\n\t\t\t\tRT5645_PWR_MB | RT5645_PWR_VREF2);\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_PWR_MIXER,\n\t\t\t\tRT5645_PWR_LDO2, RT5645_PWR_LDO2);\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_PWR_VOL,\n\t\t\t\tRT5645_PWR_MIC_DET, RT5645_PWR_MIC_DET);\n\t\t}\n\n\t\tregmap_write(rt5645->regmap, RT5645_JD_CTRL3, 0x00f0);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL2,\n\t\t\tRT5645_CBJ_MN_JD, RT5645_CBJ_MN_JD);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL1,\n\t\t\tRT5645_CBJ_BST1_EN, RT5645_CBJ_BST1_EN);\n\t\tmsleep(100);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL2,\n\t\t\tRT5645_CBJ_MN_JD, 0);\n\n\t\tmsleep(600);\n\t\tregmap_read(rt5645->regmap, RT5645_IN1_CTRL3, &val);\n\t\tval &= 0x7;\n\t\tdev_dbg(component->dev, \"val = %d\\n\", val);\n\n\t\tif ((val == 1 || val == 2) && !rt5645->pdata.no_headset_mic) {\n\t\t\trt5645->jack_type = SND_JACK_HEADSET;\n\t\t\tif (rt5645->en_button_func) {\n\t\t\t\trt5645_enable_push_button_irq(component, true);\n\t\t\t}\n\t\t} else {\n\t\t\tif (rt5645->en_button_func)\n\t\t\t\trt5645_enable_push_button_irq(component, false);\n\t\t\tsnd_soc_dapm_disable_pin(dapm, \"Mic Det Power\");\n\t\t\tsnd_soc_dapm_sync(dapm);\n\t\t\trt5645->jack_type = SND_JACK_HEADPHONE;\n\t\t}\n\t\tif (rt5645->pdata.level_trigger_irq)\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_IRQ_CTRL2,\n\t\t\t\tRT5645_JD_1_1_MASK, RT5645_JD_1_1_NOR);\n\n\t\tregmap_write(rt5645->regmap, RT5645_CHARGE_PUMP, 0x0e06);\n\t} else {  \n\t\trt5645->jack_type = 0;\n\n\t\tregmap_update_bits(rt5645->regmap, RT5645_HP_VOL,\n\t\t\tRT5645_L_MUTE | RT5645_R_MUTE,\n\t\t\tRT5645_L_MUTE | RT5645_R_MUTE);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL2,\n\t\t\tRT5645_CBJ_MN_JD, RT5645_CBJ_MN_JD);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL1,\n\t\t\tRT5645_CBJ_BST1_EN, 0);\n\n\t\tif (rt5645->en_button_func)\n\t\t\trt5645_enable_push_button_irq(component, false);\n\n\t\tif (rt5645->pdata.jd_mode == 0)\n\t\t\tsnd_soc_dapm_disable_pin(dapm, \"LDO2\");\n\t\tsnd_soc_dapm_disable_pin(dapm, \"Mic Det Power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t\tif (rt5645->pdata.level_trigger_irq)\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_IRQ_CTRL2,\n\t\t\t\tRT5645_JD_1_1_MASK, RT5645_JD_1_1_INV);\n\t}\n\n\treturn rt5645->jack_type;\n}\n\nstatic int rt5645_button_detect(struct snd_soc_component *component)\n{\n\tint btn_type, val;\n\n\tval = snd_soc_component_read(component, RT5650_4BTN_IL_CMD1);\n\tpr_debug(\"val=0x%x\\n\", val);\n\tbtn_type = val & 0xfff0;\n\tsnd_soc_component_write(component, RT5650_4BTN_IL_CMD1, val);\n\n\treturn btn_type;\n}\n\nstatic irqreturn_t rt5645_irq(int irq, void *data);\n\nint rt5645_set_jack_detect(struct snd_soc_component *component,\n\tstruct snd_soc_jack *hp_jack, struct snd_soc_jack *mic_jack,\n\tstruct snd_soc_jack *btn_jack)\n{\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\trt5645->hp_jack = hp_jack;\n\trt5645->mic_jack = mic_jack;\n\trt5645->btn_jack = btn_jack;\n\tif (rt5645->btn_jack && rt5645->codec_type == CODEC_TYPE_RT5650) {\n\t\trt5645->en_button_func = true;\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\t\tRT5645_GP1_PIN_IRQ, RT5645_GP1_PIN_IRQ);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GEN_CTRL1,\n\t\t\t\tRT5645_DIG_GATE_CTRL, RT5645_DIG_GATE_CTRL);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DEPOP_M1,\n\t\t\t\tRT5645_HP_CB_MASK, RT5645_HP_CB_PU);\n\t}\n\trt5645_irq(0, rt5645);\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(rt5645_set_jack_detect);\n\nstatic int rt5645_component_set_jack(struct snd_soc_component *component,\n\tstruct snd_soc_jack *hs_jack, void *data)\n{\n\tstruct snd_soc_jack *mic_jack = NULL;\n\tstruct snd_soc_jack *btn_jack = NULL;\n\tint type;\n\n\tif (hs_jack) {\n\t\ttype = *(int *)data;\n\n\t\tif (type & SND_JACK_MICROPHONE)\n\t\t\tmic_jack = hs_jack;\n\t\tif (type & (SND_JACK_BTN_0 | SND_JACK_BTN_1 |\n\t\t\tSND_JACK_BTN_2 | SND_JACK_BTN_3))\n\t\t\tbtn_jack = hs_jack;\n\t}\n\n\treturn rt5645_set_jack_detect(component, hs_jack, mic_jack, btn_jack);\n}\n\nstatic void rt5645_jack_detect_work(struct work_struct *work)\n{\n\tstruct rt5645_priv *rt5645 =\n\t\tcontainer_of(work, struct rt5645_priv, jack_detect_work.work);\n\tint val, btn_type, gpio_state = 0, report = 0;\n\n\tif (!rt5645->component)\n\t\treturn;\n\n\tmutex_lock(&rt5645->jd_mutex);\n\n\tswitch (rt5645->pdata.jd_mode) {\n\tcase 0:  \n\t\tif (rt5645->gpiod_hp_det) {\n\t\t\tgpio_state = gpiod_get_value(rt5645->gpiod_hp_det);\n\t\t\tif (rt5645->pdata.inv_hp_pol)\n\t\t\t\tgpio_state ^= 1;\n\t\t\tdev_dbg(rt5645->component->dev, \"gpio_state = %d\\n\",\n\t\t\t\tgpio_state);\n\t\t\treport = rt5645_jack_detect(rt5645->component, gpio_state);\n\t\t}\n\t\tsnd_soc_jack_report(rt5645->hp_jack,\n\t\t\t\t    report, SND_JACK_HEADPHONE);\n\t\tsnd_soc_jack_report(rt5645->mic_jack,\n\t\t\t\t    report, SND_JACK_MICROPHONE);\n\t\treturn;\n\tcase 4:\n\t\tval = snd_soc_component_read(rt5645->component, RT5645_A_JD_CTRL1) & 0x0020;\n\t\tbreak;\n\tdefault:  \n\t\tval = snd_soc_component_read(rt5645->component, RT5645_INT_IRQ_ST) & 0x1000;\n\t\tbreak;\n\n\t}\n\n\tif (!val && (rt5645->jack_type == 0)) {  \n\t\treport = rt5645_jack_detect(rt5645->component, 1);\n\t} else if (!val && rt5645->jack_type == SND_JACK_HEADSET) {\n\t\t \n\t\tbtn_type = 0;\n\t\tif (snd_soc_component_read(rt5645->component, RT5645_INT_IRQ_ST) & 0x4) {\n\t\t\t \n\t\t\treport = SND_JACK_HEADSET;\n\t\t\tbtn_type = rt5645_button_detect(rt5645->component);\n\t\t\t \n\t\t\tswitch (btn_type) {\n\t\t\tcase 0x8000:\n\t\t\tcase 0x4000:\n\t\t\tcase 0x2000:\n\t\t\t\treport |= SND_JACK_BTN_0;\n\t\t\t\tbreak;\n\t\t\tcase 0x1000:\n\t\t\tcase 0x0800:\n\t\t\tcase 0x0400:\n\t\t\t\treport |= SND_JACK_BTN_1;\n\t\t\t\tbreak;\n\t\t\tcase 0x0200:\n\t\t\tcase 0x0100:\n\t\t\tcase 0x0080:\n\t\t\t\treport |= SND_JACK_BTN_2;\n\t\t\t\tbreak;\n\t\t\tcase 0x0040:\n\t\t\tcase 0x0020:\n\t\t\tcase 0x0010:\n\t\t\t\treport |= SND_JACK_BTN_3;\n\t\t\t\tbreak;\n\t\t\tcase 0x0000:  \n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdev_err(rt5645->component->dev,\n\t\t\t\t\t\"Unexpected button code 0x%04x\\n\",\n\t\t\t\t\tbtn_type);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (btn_type == 0) \n\t\t\treport =  rt5645->jack_type;\n\t\telse {\n\t\t\tmod_timer(&rt5645->btn_check_timer,\n\t\t\t\tmsecs_to_jiffies(100));\n\t\t}\n\t} else {\n\t\t \n\t\treport = 0;\n\t\tsnd_soc_component_update_bits(rt5645->component,\n\t\t\t\t    RT5645_INT_IRQ_ST, 0x1, 0x0);\n\t\trt5645_jack_detect(rt5645->component, 0);\n\t}\n\n\tmutex_unlock(&rt5645->jd_mutex);\n\n\tsnd_soc_jack_report(rt5645->hp_jack, report, SND_JACK_HEADPHONE);\n\tsnd_soc_jack_report(rt5645->mic_jack, report, SND_JACK_MICROPHONE);\n\tif (rt5645->en_button_func)\n\t\tsnd_soc_jack_report(rt5645->btn_jack,\n\t\t\treport, SND_JACK_BTN_0 | SND_JACK_BTN_1 |\n\t\t\t\tSND_JACK_BTN_2 | SND_JACK_BTN_3);\n}\n\nstatic void rt5645_rcclock_work(struct work_struct *work)\n{\n\tstruct rt5645_priv *rt5645 =\n\t\tcontainer_of(work, struct rt5645_priv, rcclock_work.work);\n\n\tregmap_update_bits(rt5645->regmap, RT5645_MICBIAS,\n\t\tRT5645_PWR_CLK25M_MASK, RT5645_PWR_CLK25M_PD);\n}\n\nstatic irqreturn_t rt5645_irq(int irq, void *data)\n{\n\tstruct rt5645_priv *rt5645 = data;\n\n\tqueue_delayed_work(system_power_efficient_wq,\n\t\t\t   &rt5645->jack_detect_work, msecs_to_jiffies(250));\n\n\treturn IRQ_HANDLED;\n}\n\nstatic void rt5645_btn_check_callback(struct timer_list *t)\n{\n\tstruct rt5645_priv *rt5645 = from_timer(rt5645, t, btn_check_timer);\n\n\tqueue_delayed_work(system_power_efficient_wq,\n\t\t   &rt5645->jack_detect_work, msecs_to_jiffies(5));\n}\n\nstatic int rt5645_probe(struct snd_soc_component *component)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\trt5645->component = component;\n\n\tswitch (rt5645->codec_type) {\n\tcase CODEC_TYPE_RT5645:\n\t\tsnd_soc_dapm_new_controls(dapm,\n\t\t\trt5645_specific_dapm_widgets,\n\t\t\tARRAY_SIZE(rt5645_specific_dapm_widgets));\n\t\tsnd_soc_dapm_add_routes(dapm,\n\t\t\trt5645_specific_dapm_routes,\n\t\t\tARRAY_SIZE(rt5645_specific_dapm_routes));\n\t\tif (rt5645->v_id < 3) {\n\t\t\tsnd_soc_dapm_add_routes(dapm,\n\t\t\t\trt5645_old_dapm_routes,\n\t\t\t\tARRAY_SIZE(rt5645_old_dapm_routes));\n\t\t}\n\t\tbreak;\n\tcase CODEC_TYPE_RT5650:\n\t\tsnd_soc_dapm_new_controls(dapm,\n\t\t\trt5650_specific_dapm_widgets,\n\t\t\tARRAY_SIZE(rt5650_specific_dapm_widgets));\n\t\tsnd_soc_dapm_add_routes(dapm,\n\t\t\trt5650_specific_dapm_routes,\n\t\t\tARRAY_SIZE(rt5650_specific_dapm_routes));\n\t\tbreak;\n\t}\n\n\tsnd_soc_component_force_bias_level(component, SND_SOC_BIAS_OFF);\n\n\t \n\tif (rt5645->pdata.jd_mode) {\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"JD Power\");\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"LDO2\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t}\n\n\tif (rt5645->pdata.long_name)\n\t\tcomponent->card->long_name = rt5645->pdata.long_name;\n\n\trt5645->eq_param = devm_kcalloc(component->dev,\n\t\tRT5645_HWEQ_NUM, sizeof(struct rt5645_eq_param_s),\n\t\tGFP_KERNEL);\n\n\tif (!rt5645->eq_param)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}\n\nstatic void rt5645_remove(struct snd_soc_component *component)\n{\n\trt5645_reset(component);\n}\n\n#ifdef CONFIG_PM\nstatic int rt5645_suspend(struct snd_soc_component *component)\n{\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\tregcache_cache_only(rt5645->regmap, true);\n\tregcache_mark_dirty(rt5645->regmap);\n\n\treturn 0;\n}\n\nstatic int rt5645_resume(struct snd_soc_component *component)\n{\n\tstruct rt5645_priv *rt5645 = snd_soc_component_get_drvdata(component);\n\n\tregcache_cache_only(rt5645->regmap, false);\n\tregcache_sync(rt5645->regmap);\n\n\treturn 0;\n}\n#else\n#define rt5645_suspend NULL\n#define rt5645_resume NULL\n#endif\n\n#define RT5645_STEREO_RATES SNDRV_PCM_RATE_8000_96000\n#define RT5645_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S20_3LE | \\\n\t\t\tSNDRV_PCM_FMTBIT_S24_LE | SNDRV_PCM_FMTBIT_S8)\n\nstatic const struct snd_soc_dai_ops rt5645_aif_dai_ops = {\n\t.hw_params = rt5645_hw_params,\n\t.set_fmt = rt5645_set_dai_fmt,\n\t.set_sysclk = rt5645_set_dai_sysclk,\n\t.set_tdm_slot = rt5645_set_tdm_slot,\n\t.set_pll = rt5645_set_dai_pll,\n};\n\nstatic struct snd_soc_dai_driver rt5645_dai[] = {\n\t{\n\t\t.name = \"rt5645-aif1\",\n\t\t.id = RT5645_AIF1,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF1 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5645_STEREO_RATES,\n\t\t\t.formats = RT5645_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF1 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t\t.rates = RT5645_STEREO_RATES,\n\t\t\t.formats = RT5645_FORMATS,\n\t\t},\n\t\t.ops = &rt5645_aif_dai_ops,\n\t},\n\t{\n\t\t.name = \"rt5645-aif2\",\n\t\t.id = RT5645_AIF2,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF2 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5645_STEREO_RATES,\n\t\t\t.formats = RT5645_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF2 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5645_STEREO_RATES,\n\t\t\t.formats = RT5645_FORMATS,\n\t\t},\n\t\t.ops = &rt5645_aif_dai_ops,\n\t},\n};\n\nstatic const struct snd_soc_component_driver soc_component_dev_rt5645 = {\n\t.probe\t\t\t= rt5645_probe,\n\t.remove\t\t\t= rt5645_remove,\n\t.suspend\t\t= rt5645_suspend,\n\t.resume\t\t\t= rt5645_resume,\n\t.set_bias_level\t\t= rt5645_set_bias_level,\n\t.controls\t\t= rt5645_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(rt5645_snd_controls),\n\t.dapm_widgets\t\t= rt5645_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(rt5645_dapm_widgets),\n\t.dapm_routes\t\t= rt5645_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(rt5645_dapm_routes),\n\t.set_jack\t\t= rt5645_component_set_jack,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic const struct regmap_config rt5645_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 16,\n\t.use_single_read = true,\n\t.use_single_write = true,\n\t.max_register = RT5645_VENDOR_ID2 + 1 + (ARRAY_SIZE(rt5645_ranges) *\n\t\t\t\t\t       RT5645_PR_SPACING),\n\t.volatile_reg = rt5645_volatile_register,\n\t.readable_reg = rt5645_readable_register,\n\n\t.cache_type = REGCACHE_MAPLE,\n\t.reg_defaults = rt5645_reg,\n\t.num_reg_defaults = ARRAY_SIZE(rt5645_reg),\n\t.ranges = rt5645_ranges,\n\t.num_ranges = ARRAY_SIZE(rt5645_ranges),\n};\n\nstatic const struct regmap_config rt5650_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 16,\n\t.use_single_read = true,\n\t.use_single_write = true,\n\t.max_register = RT5645_VENDOR_ID2 + 1 + (ARRAY_SIZE(rt5645_ranges) *\n\t\t\t\t\t       RT5645_PR_SPACING),\n\t.volatile_reg = rt5645_volatile_register,\n\t.readable_reg = rt5645_readable_register,\n\n\t.cache_type = REGCACHE_MAPLE,\n\t.reg_defaults = rt5650_reg,\n\t.num_reg_defaults = ARRAY_SIZE(rt5650_reg),\n\t.ranges = rt5645_ranges,\n\t.num_ranges = ARRAY_SIZE(rt5645_ranges),\n};\n\nstatic const struct regmap_config temp_regmap = {\n\t.name=\"nocache\",\n\t.reg_bits = 8,\n\t.val_bits = 16,\n\t.use_single_read = true,\n\t.use_single_write = true,\n\t.max_register = RT5645_VENDOR_ID2 + 1,\n\t.cache_type = REGCACHE_NONE,\n};\n\nstatic const struct i2c_device_id rt5645_i2c_id[] = {\n\t{ \"rt5645\", 0 },\n\t{ \"rt5650\", 0 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, rt5645_i2c_id);\n\n#ifdef CONFIG_OF\nstatic const struct of_device_id rt5645_of_match[] = {\n\t{ .compatible = \"realtek,rt5645\", },\n\t{ .compatible = \"realtek,rt5650\", },\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, rt5645_of_match);\n#endif\n\n#ifdef CONFIG_ACPI\nstatic const struct acpi_device_id rt5645_acpi_match[] = {\n\t{ \"10EC5645\", 0 },\n\t{ \"10EC5648\", 0 },\n\t{ \"10EC5650\", 0 },\n\t{ \"10EC5640\", 0 },\n\t{ \"10EC3270\", 0 },\n\t{},\n};\nMODULE_DEVICE_TABLE(acpi, rt5645_acpi_match);\n#endif\n\nstatic const struct rt5645_platform_data intel_braswell_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC1_DISABLE,\n\t.dmic2_data_pin = RT5645_DMIC_DATA_IN2P,\n\t.jd_mode = 3,\n};\n\nstatic const struct rt5645_platform_data buddy_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC_DATA_GPIO5,\n\t.dmic2_data_pin = RT5645_DMIC_DATA_IN2P,\n\t.jd_mode = 4,\n\t.level_trigger_irq = true,\n};\n\nstatic const struct rt5645_platform_data gpd_win_platform_data = {\n\t.jd_mode = 3,\n\t.inv_jd1_1 = true,\n\t.long_name = \"gpd-win-pocket-rt5645\",\n\t \n\t.in2_diff = true,\n};\n\nstatic const struct rt5645_platform_data asus_t100ha_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC_DATA_IN2N,\n\t.dmic2_data_pin = RT5645_DMIC2_DISABLE,\n\t.jd_mode = 3,\n\t.inv_jd1_1 = true,\n};\n\nstatic const struct rt5645_platform_data asus_t101ha_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC_DATA_IN2N,\n\t.dmic2_data_pin = RT5645_DMIC2_DISABLE,\n\t.jd_mode = 3,\n};\n\nstatic const struct rt5645_platform_data lenovo_ideapad_miix_310_pdata = {\n\t.jd_mode = 3,\n\t.in2_diff = true,\n};\n\nstatic const struct rt5645_platform_data jd_mode3_platform_data = {\n\t.jd_mode = 3,\n};\n\nstatic const struct rt5645_platform_data lattepanda_board_platform_data = {\n\t.jd_mode = 2,\n\t.inv_jd1_1 = true\n};\n\nstatic const struct rt5645_platform_data kahlee_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC_DATA_GPIO5,\n\t.dmic2_data_pin = RT5645_DMIC_DATA_IN2P,\n\t.jd_mode = 3,\n};\n\nstatic const struct rt5645_platform_data ecs_ef20_platform_data = {\n\t.dmic1_data_pin = RT5645_DMIC1_DISABLE,\n\t.dmic2_data_pin = RT5645_DMIC_DATA_IN2P,\n\t.inv_hp_pol = 1,\n};\n\nstatic const struct acpi_gpio_params ef20_hp_detect = { 1, 0, false };\n\nstatic const struct acpi_gpio_mapping cht_rt5645_ef20_gpios[] = {\n\t{ \"hp-detect-gpios\", &ef20_hp_detect, 1 },\n\t{ },\n};\n\nstatic int cht_rt5645_ef20_quirk_cb(const struct dmi_system_id *id)\n{\n\tcht_rt5645_gpios = cht_rt5645_ef20_gpios;\n\treturn 1;\n}\n\nstatic const struct dmi_system_id dmi_platform_data[] = {\n\t{\n\t\t.ident = \"Chrome Buddy\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Buddy\"),\n\t\t},\n\t\t.driver_data = (void *)&buddy_platform_data,\n\t},\n\t{\n\t\t.ident = \"Intel Strago\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Strago\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t.ident = \"Google Chrome\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"GOOGLE\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t.ident = \"Google Setzer\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Setzer\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t.ident = \"Microsoft Surface 3\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Surface 3\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t \n\t\t.ident = \"GPD Win / Pocket\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"AMI Corporation\"),\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"Default string\"),\n\t\t\tDMI_MATCH(DMI_BOARD_SERIAL, \"Default string\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Default string\"),\n\t\t},\n\t\t.driver_data = (void *)&gpd_win_platform_data,\n\t},\n\t{\n\t\t.ident = \"ASUS T100HAN\",\n\t\t.matches = {\n\t\t\tDMI_EXACT_MATCH(DMI_SYS_VENDOR, \"ASUSTeK COMPUTER INC.\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"T100HAN\"),\n\t\t},\n\t\t.driver_data = (void *)&asus_t100ha_platform_data,\n\t},\n\t{\n\t\t.ident = \"ASUS T101HA\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"ASUSTeK COMPUTER INC.\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"T101HA\"),\n\t\t},\n\t\t.driver_data = (void *)&asus_t101ha_platform_data,\n\t},\n\t{\n\t\t.ident = \"MINIX Z83-4\",\n\t\t.matches = {\n\t\t\tDMI_EXACT_MATCH(DMI_SYS_VENDOR, \"MINIX\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Z83-4\"),\n\t\t},\n\t\t.driver_data = (void *)&jd_mode3_platform_data,\n\t},\n\t{\n\t\t.ident = \"Teclast X80 Pro\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"TECLAST\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"X80 Pro\"),\n\t\t},\n\t\t.driver_data = (void *)&jd_mode3_platform_data,\n\t},\n\t{\n\t\t.ident = \"Lenovo Ideapad Miix 310\",\n\t\t.matches = {\n\t\t  DMI_EXACT_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t  DMI_EXACT_MATCH(DMI_PRODUCT_NAME, \"80SG\"),\n\t\t  DMI_EXACT_MATCH(DMI_PRODUCT_VERSION, \"MIIX 310-10ICR\"),\n\t\t},\n\t\t.driver_data = (void *)&lenovo_ideapad_miix_310_pdata,\n\t},\n\t{\n\t\t.ident = \"Lenovo Ideapad Miix 320\",\n\t\t.matches = {\n\t\t  DMI_EXACT_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t  DMI_EXACT_MATCH(DMI_PRODUCT_NAME, \"80XF\"),\n\t\t  DMI_EXACT_MATCH(DMI_PRODUCT_VERSION, \"Lenovo MIIX 320-10ICR\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t.ident = \"LattePanda board\",\n\t\t.matches = {\n\t\t  DMI_EXACT_MATCH(DMI_BOARD_VENDOR, \"AMI Corporation\"),\n\t\t  DMI_EXACT_MATCH(DMI_BOARD_NAME, \"Cherry Trail CR\"),\n\t\t  DMI_EXACT_MATCH(DMI_BOARD_VERSION, \"Default string\"),\n\t\t},\n\t\t.driver_data = (void *)&lattepanda_board_platform_data,\n\t},\n\t{\n\t\t.ident = \"Chrome Kahlee\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Kahlee\"),\n\t\t},\n\t\t.driver_data = (void *)&kahlee_platform_data,\n\t},\n\t{\n\t\t.ident = \"Medion E1239T\",\n\t\t.matches = {\n\t\t\tDMI_EXACT_MATCH(DMI_SYS_VENDOR, \"MEDION\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"E1239T MD60568\"),\n\t\t},\n\t\t.driver_data = (void *)&intel_braswell_platform_data,\n\t},\n\t{\n\t\t.ident = \"EF20\",\n\t\t.callback = cht_rt5645_ef20_quirk_cb,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"EF20\"),\n\t\t},\n\t\t.driver_data = (void *)&ecs_ef20_platform_data,\n\t},\n\t{ }\n};\n\nstatic bool rt5645_check_dp(struct device *dev)\n{\n\tif (device_property_present(dev, \"realtek,in2-differential\") ||\n\t    device_property_present(dev, \"realtek,dmic1-data-pin\") ||\n\t    device_property_present(dev, \"realtek,dmic2-data-pin\") ||\n\t    device_property_present(dev, \"realtek,jd-mode\"))\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic int rt5645_parse_dt(struct rt5645_priv *rt5645, struct device *dev)\n{\n\trt5645->pdata.in2_diff = device_property_read_bool(dev,\n\t\t\"realtek,in2-differential\");\n\tdevice_property_read_u32(dev,\n\t\t\"realtek,dmic1-data-pin\", &rt5645->pdata.dmic1_data_pin);\n\tdevice_property_read_u32(dev,\n\t\t\"realtek,dmic2-data-pin\", &rt5645->pdata.dmic2_data_pin);\n\tdevice_property_read_u32(dev,\n\t\t\"realtek,jd-mode\", &rt5645->pdata.jd_mode);\n\n\treturn 0;\n}\n\nstatic int rt5645_i2c_probe(struct i2c_client *i2c)\n{\n\tstruct rt5645_platform_data *pdata = NULL;\n\tconst struct dmi_system_id *dmi_data;\n\tstruct rt5645_priv *rt5645;\n\tint ret, i;\n\tunsigned int val;\n\tstruct regmap *regmap;\n\n\trt5645 = devm_kzalloc(&i2c->dev, sizeof(struct rt5645_priv),\n\t\t\t\tGFP_KERNEL);\n\tif (rt5645 == NULL)\n\t\treturn -ENOMEM;\n\n\trt5645->i2c = i2c;\n\ti2c_set_clientdata(i2c, rt5645);\n\n\tdmi_data = dmi_first_match(dmi_platform_data);\n\tif (dmi_data) {\n\t\tdev_info(&i2c->dev, \"Detected %s platform\\n\", dmi_data->ident);\n\t\tpdata = dmi_data->driver_data;\n\t}\n\n\tif (pdata)\n\t\trt5645->pdata = *pdata;\n\telse if (rt5645_check_dp(&i2c->dev))\n\t\trt5645_parse_dt(rt5645, &i2c->dev);\n\telse\n\t\trt5645->pdata = jd_mode3_platform_data;\n\n\tif (quirk != -1) {\n\t\trt5645->pdata.in2_diff = QUIRK_IN2_DIFF(quirk);\n\t\trt5645->pdata.level_trigger_irq = QUIRK_LEVEL_IRQ(quirk);\n\t\trt5645->pdata.inv_jd1_1 = QUIRK_INV_JD1_1(quirk);\n\t\trt5645->pdata.inv_hp_pol = QUIRK_INV_HP_POL(quirk);\n\t\trt5645->pdata.jd_mode = QUIRK_JD_MODE(quirk);\n\t\trt5645->pdata.dmic1_data_pin = QUIRK_DMIC1_DATA_PIN(quirk);\n\t\trt5645->pdata.dmic2_data_pin = QUIRK_DMIC2_DATA_PIN(quirk);\n\t}\n\n\tif (has_acpi_companion(&i2c->dev)) {\n\t\tif (cht_rt5645_gpios) {\n\t\t\tif (devm_acpi_dev_add_driver_gpios(&i2c->dev, cht_rt5645_gpios))\n\t\t\t\tdev_dbg(&i2c->dev, \"Failed to add driver gpios\\n\");\n\t\t}\n\n\t\t \n\t\tif (acpi_dev_hid_uid_match(ACPI_COMPANION(&i2c->dev), \"10EC3270\", NULL))\n\t\t\trt5645->pdata.no_headset_mic = true;\n\t}\n\n\trt5645->gpiod_hp_det = devm_gpiod_get_optional(&i2c->dev, \"hp-detect\",\n\t\t\t\t\t\t       GPIOD_IN);\n\n\tif (IS_ERR(rt5645->gpiod_hp_det)) {\n\t\tdev_info(&i2c->dev, \"failed to initialize gpiod\\n\");\n\t\tret = PTR_ERR(rt5645->gpiod_hp_det);\n\t\t \n\t\tif (ret != -ENOENT)\n\t\t\treturn ret;\n\t}\n\n\tfor (i = 0; i < ARRAY_SIZE(rt5645->supplies); i++)\n\t\trt5645->supplies[i].supply = rt5645_supply_names[i];\n\n\tret = devm_regulator_bulk_get(&i2c->dev,\n\t\t\t\t      ARRAY_SIZE(rt5645->supplies),\n\t\t\t\t      rt5645->supplies);\n\tif (ret) {\n\t\tdev_err(&i2c->dev, \"Failed to request supplies: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = regulator_bulk_enable(ARRAY_SIZE(rt5645->supplies),\n\t\t\t\t    rt5645->supplies);\n\tif (ret) {\n\t\tdev_err(&i2c->dev, \"Failed to enable supplies: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tregmap = devm_regmap_init_i2c(i2c, &temp_regmap);\n\tif (IS_ERR(regmap)) {\n\t\tret = PTR_ERR(regmap);\n\t\tdev_err(&i2c->dev, \"Failed to allocate temp register map: %d\\n\",\n\t\t\tret);\n\t\tgoto err_enable;\n\t}\n\n\t \n\tmsleep(TIME_TO_POWER_MS);\n\tret = regmap_read(regmap, RT5645_VENDOR_ID2, &val);\n\tif (ret < 0) {\n\t\tdev_err(&i2c->dev, \"Failed to read: 0x%02X\\n, ret = %d\", RT5645_VENDOR_ID2, ret);\n\t\tgoto err_enable;\n\t}\n\n\tswitch (val) {\n\tcase RT5645_DEVICE_ID:\n\t\trt5645->regmap = devm_regmap_init_i2c(i2c, &rt5645_regmap);\n\t\trt5645->codec_type = CODEC_TYPE_RT5645;\n\t\tbreak;\n\tcase RT5650_DEVICE_ID:\n\t\trt5645->regmap = devm_regmap_init_i2c(i2c, &rt5650_regmap);\n\t\trt5645->codec_type = CODEC_TYPE_RT5650;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(&i2c->dev,\n\t\t\t\"Device with ID register %#x is not rt5645 or rt5650\\n\",\n\t\t\tval);\n\t\tret = -ENODEV;\n\t\tgoto err_enable;\n\t}\n\n\tif (IS_ERR(rt5645->regmap)) {\n\t\tret = PTR_ERR(rt5645->regmap);\n\t\tdev_err(&i2c->dev, \"Failed to allocate register map: %d\\n\",\n\t\t\tret);\n\t\tgoto err_enable;\n\t}\n\n\tregmap_write(rt5645->regmap, RT5645_RESET, 0);\n\n\tregmap_read(regmap, RT5645_VENDOR_ID, &val);\n\trt5645->v_id = val & 0xff;\n\n\tregmap_write(rt5645->regmap, RT5645_AD_DA_MIXER, 0x8080);\n\n\tret = regmap_multi_reg_write(rt5645->regmap, init_list,\n\t\t\t\t    ARRAY_SIZE(init_list));\n\tif (ret != 0)\n\t\tdev_warn(&i2c->dev, \"Failed to apply regmap patch: %d\\n\", ret);\n\n\tif (rt5645->codec_type == CODEC_TYPE_RT5650) {\n\t\tret = regmap_multi_reg_write(rt5645->regmap, rt5650_init_list,\n\t\t\t\t    ARRAY_SIZE(rt5650_init_list));\n\t\tif (ret != 0)\n\t\t\tdev_warn(&i2c->dev, \"Apply rt5650 patch failed: %d\\n\",\n\t\t\t\t\t   ret);\n\t}\n\n\tregmap_update_bits(rt5645->regmap, RT5645_CLSD_OUT_CTRL, 0xc0, 0xc0);\n\n\tif (rt5645->pdata.in2_diff)\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IN2_CTRL,\n\t\t\t\t\tRT5645_IN_DF2, RT5645_IN_DF2);\n\n\tif (rt5645->pdata.dmic1_data_pin || rt5645->pdata.dmic2_data_pin) {\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP2_PIN_MASK, RT5645_GP2_PIN_DMIC1_SCL);\n\t}\n\tswitch (rt5645->pdata.dmic1_data_pin) {\n\tcase RT5645_DMIC_DATA_IN2N:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_1_DP_MASK, RT5645_DMIC_1_DP_IN2N);\n\t\tbreak;\n\n\tcase RT5645_DMIC_DATA_GPIO5:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_I2S2_DAC_PIN_MASK, RT5645_I2S2_DAC_PIN_GPIO);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_1_DP_MASK, RT5645_DMIC_1_DP_GPIO5);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP5_PIN_MASK, RT5645_GP5_PIN_DMIC1_SDA);\n\t\tbreak;\n\n\tcase RT5645_DMIC_DATA_GPIO11:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_1_DP_MASK, RT5645_DMIC_1_DP_GPIO11);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP11_PIN_MASK,\n\t\t\tRT5645_GP11_PIN_DMIC1_SDA);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\tswitch (rt5645->pdata.dmic2_data_pin) {\n\tcase RT5645_DMIC_DATA_IN2P:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_2_DP_MASK, RT5645_DMIC_2_DP_IN2P);\n\t\tbreak;\n\n\tcase RT5645_DMIC_DATA_GPIO6:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_2_DP_MASK, RT5645_DMIC_2_DP_GPIO6);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP6_PIN_MASK, RT5645_GP6_PIN_DMIC2_SDA);\n\t\tbreak;\n\n\tcase RT5645_DMIC_DATA_GPIO10:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_2_DP_MASK, RT5645_DMIC_2_DP_GPIO10);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP10_PIN_MASK,\n\t\t\tRT5645_GP10_PIN_DMIC2_SDA);\n\t\tbreak;\n\n\tcase RT5645_DMIC_DATA_GPIO12:\n\t\tregmap_update_bits(rt5645->regmap, RT5645_DMIC_CTRL1,\n\t\t\tRT5645_DMIC_2_DP_MASK, RT5645_DMIC_2_DP_GPIO12);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\tRT5645_GP12_PIN_MASK,\n\t\t\tRT5645_GP12_PIN_DMIC2_SDA);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\tif (rt5645->pdata.jd_mode) {\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GEN_CTRL3,\n\t\t\t\t   RT5645_IRQ_CLK_GATE_CTRL,\n\t\t\t\t   RT5645_IRQ_CLK_GATE_CTRL);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_MICBIAS,\n\t\t\t\t   RT5645_IRQ_CLK_INT, RT5645_IRQ_CLK_INT);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IRQ_CTRL2,\n\t\t\t\t   RT5645_IRQ_JD_1_1_EN, RT5645_IRQ_JD_1_1_EN);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GEN_CTRL3,\n\t\t\t\t   RT5645_JD_PSV_MODE, RT5645_JD_PSV_MODE);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_HPO_MIXER,\n\t\t\t\t   RT5645_IRQ_PSV_MODE, RT5645_IRQ_PSV_MODE);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_MICBIAS,\n\t\t\t\t   RT5645_MIC2_OVCD_EN, RT5645_MIC2_OVCD_EN);\n\t\tregmap_update_bits(rt5645->regmap, RT5645_GPIO_CTRL1,\n\t\t\t\t   RT5645_GP1_PIN_IRQ, RT5645_GP1_PIN_IRQ);\n\t\tswitch (rt5645->pdata.jd_mode) {\n\t\tcase 1:\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_A_JD_CTRL1,\n\t\t\t\t\t   RT5645_JD1_MODE_MASK,\n\t\t\t\t\t   RT5645_JD1_MODE_0);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_A_JD_CTRL1,\n\t\t\t\t\t   RT5645_JD1_MODE_MASK,\n\t\t\t\t\t   RT5645_JD1_MODE_1);\n\t\t\tbreak;\n\t\tcase 3:\n\t\tcase 4:\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_A_JD_CTRL1,\n\t\t\t\t\t   RT5645_JD1_MODE_MASK,\n\t\t\t\t\t   RT5645_JD1_MODE_2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t\tif (rt5645->pdata.inv_jd1_1) {\n\t\t\tregmap_update_bits(rt5645->regmap, RT5645_IRQ_CTRL2,\n\t\t\t\tRT5645_JD_1_1_MASK, RT5645_JD_1_1_INV);\n\t\t}\n\t}\n\n\tregmap_update_bits(rt5645->regmap, RT5645_ADDA_CLK1,\n\t\tRT5645_I2S_PD1_MASK, RT5645_I2S_PD1_2);\n\n\tif (rt5645->pdata.level_trigger_irq) {\n\t\tregmap_update_bits(rt5645->regmap, RT5645_IRQ_CTRL2,\n\t\t\tRT5645_JD_1_1_MASK, RT5645_JD_1_1_INV);\n\t}\n\ttimer_setup(&rt5645->btn_check_timer, rt5645_btn_check_callback, 0);\n\n\tmutex_init(&rt5645->jd_mutex);\n\tINIT_DELAYED_WORK(&rt5645->jack_detect_work, rt5645_jack_detect_work);\n\tINIT_DELAYED_WORK(&rt5645->rcclock_work, rt5645_rcclock_work);\n\n\tif (rt5645->i2c->irq) {\n\t\tret = request_threaded_irq(rt5645->i2c->irq, NULL, rt5645_irq,\n\t\t\tIRQF_TRIGGER_RISING | IRQF_TRIGGER_FALLING\n\t\t\t| IRQF_ONESHOT, \"rt5645\", rt5645);\n\t\tif (ret) {\n\t\t\tdev_err(&i2c->dev, \"Failed to reguest IRQ: %d\\n\", ret);\n\t\t\tgoto err_enable;\n\t\t}\n\t}\n\n\tret = devm_snd_soc_register_component(&i2c->dev, &soc_component_dev_rt5645,\n\t\t\t\t     rt5645_dai, ARRAY_SIZE(rt5645_dai));\n\tif (ret)\n\t\tgoto err_irq;\n\n\treturn 0;\n\nerr_irq:\n\tif (rt5645->i2c->irq)\n\t\tfree_irq(rt5645->i2c->irq, rt5645);\nerr_enable:\n\tregulator_bulk_disable(ARRAY_SIZE(rt5645->supplies), rt5645->supplies);\n\treturn ret;\n}\n\nstatic void rt5645_i2c_remove(struct i2c_client *i2c)\n{\n\tstruct rt5645_priv *rt5645 = i2c_get_clientdata(i2c);\n\n\tif (i2c->irq)\n\t\tfree_irq(i2c->irq, rt5645);\n\n\t \n\tdel_timer_sync(&rt5645->btn_check_timer);\n\n\tcancel_delayed_work_sync(&rt5645->jack_detect_work);\n\tcancel_delayed_work_sync(&rt5645->rcclock_work);\n\n\tregulator_bulk_disable(ARRAY_SIZE(rt5645->supplies), rt5645->supplies);\n}\n\nstatic void rt5645_i2c_shutdown(struct i2c_client *i2c)\n{\n\tstruct rt5645_priv *rt5645 = i2c_get_clientdata(i2c);\n\n\tregmap_update_bits(rt5645->regmap, RT5645_GEN_CTRL3,\n\t\tRT5645_RING2_SLEEVE_GND, RT5645_RING2_SLEEVE_GND);\n\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL2, RT5645_CBJ_MN_JD,\n\t\tRT5645_CBJ_MN_JD);\n\tregmap_update_bits(rt5645->regmap, RT5645_IN1_CTRL1, RT5645_CBJ_BST1_EN,\n\t\t0);\n\tmsleep(20);\n\tregmap_write(rt5645->regmap, RT5645_RESET, 0);\n}\n\nstatic int __maybe_unused rt5645_sys_suspend(struct device *dev)\n{\n\tstruct rt5645_priv *rt5645 = dev_get_drvdata(dev);\n\n\tdel_timer_sync(&rt5645->btn_check_timer);\n\tcancel_delayed_work_sync(&rt5645->jack_detect_work);\n\tcancel_delayed_work_sync(&rt5645->rcclock_work);\n\n\tregcache_cache_only(rt5645->regmap, true);\n\tregcache_mark_dirty(rt5645->regmap);\n\treturn 0;\n}\n\nstatic int __maybe_unused rt5645_sys_resume(struct device *dev)\n{\n\tstruct rt5645_priv *rt5645 = dev_get_drvdata(dev);\n\n\tregcache_cache_only(rt5645->regmap, false);\n\tregcache_sync(rt5645->regmap);\n\n\tif (rt5645->hp_jack) {\n\t\trt5645->jack_type = 0;\n\t\trt5645_jack_detect_work(&rt5645->jack_detect_work.work);\n\t}\n\treturn 0;\n}\n\nstatic const struct dev_pm_ops rt5645_pm = {\n\tSET_SYSTEM_SLEEP_PM_OPS(rt5645_sys_suspend, rt5645_sys_resume)\n};\n\nstatic struct i2c_driver rt5645_i2c_driver = {\n\t.driver = {\n\t\t.name = \"rt5645\",\n\t\t.of_match_table = of_match_ptr(rt5645_of_match),\n\t\t.acpi_match_table = ACPI_PTR(rt5645_acpi_match),\n\t\t.pm = &rt5645_pm,\n\t},\n\t.probe = rt5645_i2c_probe,\n\t.remove = rt5645_i2c_remove,\n\t.shutdown = rt5645_i2c_shutdown,\n\t.id_table = rt5645_i2c_id,\n};\nmodule_i2c_driver(rt5645_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC RT5645 driver\");\nMODULE_AUTHOR(\"Bard Liao <bardliao@realtek.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}