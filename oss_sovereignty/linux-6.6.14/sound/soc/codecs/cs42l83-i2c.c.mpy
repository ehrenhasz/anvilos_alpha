{
  "module_name": "cs42l83-i2c.c",
  "hash_id": "73712fdf3bfcd9519a2029ba0041285a040ea6d98c146aeeae2cc6bd239ed87e",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/cs42l83-i2c.c",
  "human_readable_source": "\n \n\n#include <linux/i2c.h>\n#include <linux/module.h>\n#include <linux/regmap.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#include \"cs42l42.h\"\n\nstatic const struct reg_default cs42l83_reg_defaults[] = {\n\t{ CS42L42_FRZ_CTL,\t\t\t0x00 },\n\t{ CS42L42_SRC_CTL,\t\t\t0x10 },\n\t{ CS42L42_MCLK_CTL,\t\t\t0x00 },  \n\t{ CS42L42_SFTRAMP_RATE,\t\t\t0xA4 },\n\t{ CS42L42_SLOW_START_ENABLE,\t\t0x70 },\n\t{ CS42L42_I2C_DEBOUNCE,\t\t\t0x88 },\n\t{ CS42L42_I2C_STRETCH,\t\t\t0x03 },\n\t{ CS42L42_I2C_TIMEOUT,\t\t\t0xB7 },\n\t{ CS42L42_PWR_CTL1,\t\t\t0xFF },\n\t{ CS42L42_PWR_CTL2,\t\t\t0x84 },\n\t{ CS42L42_PWR_CTL3,\t\t\t0x20 },\n\t{ CS42L42_RSENSE_CTL1,\t\t\t0x40 },\n\t{ CS42L42_RSENSE_CTL2,\t\t\t0x00 },\n\t{ CS42L42_OSC_SWITCH,\t\t\t0x00 },\n\t{ CS42L42_RSENSE_CTL3,\t\t\t0x1B },\n\t{ CS42L42_TSENSE_CTL,\t\t\t0x1B },\n\t{ CS42L42_TSRS_INT_DISABLE,\t\t0x00 },\n\t{ CS42L42_HSDET_CTL1,\t\t\t0x77 },\n\t{ CS42L42_HSDET_CTL2,\t\t\t0x00 },\n\t{ CS42L42_HS_SWITCH_CTL,\t\t0xF3 },\n\t{ CS42L42_HS_CLAMP_DISABLE,\t\t0x00 },\n\t{ CS42L42_MCLK_SRC_SEL,\t\t\t0x00 },\n\t{ CS42L42_SPDIF_CLK_CFG,\t\t0x00 },\n\t{ CS42L42_FSYNC_PW_LOWER,\t\t0x00 },\n\t{ CS42L42_FSYNC_PW_UPPER,\t\t0x00 },\n\t{ CS42L42_FSYNC_P_LOWER,\t\t0xF9 },\n\t{ CS42L42_FSYNC_P_UPPER,\t\t0x00 },\n\t{ CS42L42_ASP_CLK_CFG,\t\t\t0x00 },\n\t{ CS42L42_ASP_FRM_CFG,\t\t\t0x10 },\n\t{ CS42L42_FS_RATE_EN,\t\t\t0x00 },\n\t{ CS42L42_IN_ASRC_CLK,\t\t\t0x00 },\n\t{ CS42L42_OUT_ASRC_CLK,\t\t\t0x00 },\n\t{ CS42L42_PLL_DIV_CFG1,\t\t\t0x00 },\n\t{ CS42L42_ADC_OVFL_INT_MASK,\t\t0x01 },\n\t{ CS42L42_MIXER_INT_MASK,\t\t0x0F },\n\t{ CS42L42_SRC_INT_MASK,\t\t\t0x0F },\n\t{ CS42L42_ASP_RX_INT_MASK,\t\t0x1F },\n\t{ CS42L42_ASP_TX_INT_MASK,\t\t0x0F },\n\t{ CS42L42_CODEC_INT_MASK,\t\t0x03 },\n\t{ CS42L42_SRCPL_INT_MASK,\t\t0x7F },\n\t{ CS42L42_VPMON_INT_MASK,\t\t0x01 },\n\t{ CS42L42_PLL_LOCK_INT_MASK,\t\t0x01 },\n\t{ CS42L42_TSRS_PLUG_INT_MASK,\t\t0x0F },\n\t{ CS42L42_PLL_CTL1,\t\t\t0x00 },\n\t{ CS42L42_PLL_DIV_FRAC0,\t\t0x00 },\n\t{ CS42L42_PLL_DIV_FRAC1,\t\t0x00 },\n\t{ CS42L42_PLL_DIV_FRAC2,\t\t0x00 },\n\t{ CS42L42_PLL_DIV_INT,\t\t\t0x40 },\n\t{ CS42L42_PLL_CTL3,\t\t\t0x10 },\n\t{ CS42L42_PLL_CAL_RATIO,\t\t0x80 },\n\t{ CS42L42_PLL_CTL4,\t\t\t0x03 },\n\t{ CS42L42_LOAD_DET_EN,\t\t\t0x00 },\n\t{ CS42L42_HSBIAS_SC_AUTOCTL,\t\t0x03 },\n\t{ CS42L42_WAKE_CTL,\t\t\t0xC0 },\n\t{ CS42L42_ADC_DISABLE_MUTE,\t\t0x00 },\n\t{ CS42L42_TIPSENSE_CTL,\t\t\t0x02 },\n\t{ CS42L42_MISC_DET_CTL,\t\t\t0x03 },\n\t{ CS42L42_MIC_DET_CTL1,\t\t\t0x1F },\n\t{ CS42L42_MIC_DET_CTL2,\t\t\t0x2F },\n\t{ CS42L42_DET_INT1_MASK,\t\t0xE0 },\n\t{ CS42L42_DET_INT2_MASK,\t\t0xFF },\n\t{ CS42L42_HS_BIAS_CTL,\t\t\t0xC2 },\n\t{ CS42L42_ADC_CTL,\t\t\t0x00 },\n\t{ CS42L42_ADC_VOLUME,\t\t\t0x00 },\n\t{ CS42L42_ADC_WNF_HPF_CTL,\t\t0x71 },\n\t{ CS42L42_DAC_CTL1,\t\t\t0x00 },\n\t{ CS42L42_DAC_CTL2,\t\t\t0x02 },\n\t{ CS42L42_HP_CTL,\t\t\t0x0D },\n\t{ CS42L42_CLASSH_CTL,\t\t\t0x07 },\n\t{ CS42L42_MIXER_CHA_VOL,\t\t0x3F },\n\t{ CS42L42_MIXER_ADC_VOL,\t\t0x3F },\n\t{ CS42L42_MIXER_CHB_VOL,\t\t0x3F },\n\t{ CS42L42_EQ_COEF_IN0,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_IN1,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_IN2,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_IN3,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_RW,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_OUT0,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_OUT1,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_OUT2,\t\t\t0x00 },\n\t{ CS42L42_EQ_COEF_OUT3,\t\t\t0x00 },\n\t{ CS42L42_EQ_INIT_STAT,\t\t\t0x00 },\n\t{ CS42L42_EQ_START_FILT,\t\t0x00 },\n\t{ CS42L42_EQ_MUTE_CTL,\t\t\t0x00 },\n\t{ CS42L42_SP_RX_CH_SEL,\t\t\t0x04 },\n\t{ CS42L42_SP_RX_ISOC_CTL,\t\t0x04 },\n\t{ CS42L42_SP_RX_FS,\t\t\t0x8C },\n\t{ CS42l42_SPDIF_CH_SEL,\t\t\t0x0E },\n\t{ CS42L42_SP_TX_ISOC_CTL,\t\t0x04 },\n\t{ CS42L42_SP_TX_FS,\t\t\t0xCC },\n\t{ CS42L42_SPDIF_SW_CTL1,\t\t0x3F },\n\t{ CS42L42_SRC_SDIN_FS,\t\t\t0x40 },\n\t{ CS42L42_SRC_SDOUT_FS,\t\t\t0x40 },\n\t{ CS42L42_SPDIF_CTL1,\t\t\t0x01 },\n\t{ CS42L42_SPDIF_CTL2,\t\t\t0x00 },\n\t{ CS42L42_SPDIF_CTL3,\t\t\t0x00 },\n\t{ CS42L42_SPDIF_CTL4,\t\t\t0x42 },\n\t{ CS42L42_ASP_TX_SZ_EN,\t\t\t0x00 },\n\t{ CS42L42_ASP_TX_CH_EN,\t\t\t0x00 },\n\t{ CS42L42_ASP_TX_CH_AP_RES,\t\t0x0F },\n\t{ CS42L42_ASP_TX_CH1_BIT_MSB,\t\t0x00 },\n\t{ CS42L42_ASP_TX_CH1_BIT_LSB,\t\t0x00 },\n\t{ CS42L42_ASP_TX_HIZ_DLY_CFG,\t\t0x00 },\n\t{ CS42L42_ASP_TX_CH2_BIT_MSB,\t\t0x00 },\n\t{ CS42L42_ASP_TX_CH2_BIT_LSB,\t\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_EN,\t\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH1_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI0_CH1_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH1_BIT_LSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH2_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI0_CH2_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH2_BIT_LSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH3_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI0_CH3_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH3_BIT_LSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH4_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI0_CH4_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI0_CH4_BIT_LSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI1_CH1_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI1_CH1_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI1_CH1_BIT_LSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI1_CH2_AP_RES,\t0x03 },\n\t{ CS42L42_ASP_RX_DAI1_CH2_BIT_MSB,\t0x00 },\n\t{ CS42L42_ASP_RX_DAI1_CH2_BIT_LSB,\t0x00 },\n};\n\n \nstatic const struct regmap_config cs42l83_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\n\t.readable_reg = cs42l42_readable_register,\n\t.volatile_reg = cs42l42_volatile_register,\n\n\t.ranges = &cs42l42_page_range,\n\t.num_ranges = 1,\n\n\t.max_register = CS42L42_MAX_REGISTER,\n\t.reg_defaults = cs42l83_reg_defaults,\n\t.num_reg_defaults = ARRAY_SIZE(cs42l83_reg_defaults),\n\t.cache_type = REGCACHE_MAPLE,\n\n\t.use_single_read = true,\n\t.use_single_write = true,\n};\n\nstatic int cs42l83_i2c_probe(struct i2c_client *i2c_client)\n{\n\tstruct device *dev = &i2c_client->dev;\n\tstruct cs42l42_private *cs42l83;\n\tstruct regmap *regmap;\n\tint ret;\n\n\tcs42l83 = devm_kzalloc(dev, sizeof(*cs42l83), GFP_KERNEL);\n\tif (!cs42l83)\n\t\treturn -ENOMEM;\n\n\tregmap = devm_regmap_init_i2c(i2c_client, &cs42l83_regmap);\n\tif (IS_ERR(regmap))\n\t\treturn dev_err_probe(&i2c_client->dev, PTR_ERR(regmap),\n\t\t\t\t     \"regmap_init() failed\\n\");\n\n\tcs42l83->devid = CS42L83_CHIP_ID;\n\tcs42l83->dev = dev;\n\tcs42l83->regmap = regmap;\n\tcs42l83->irq = i2c_client->irq;\n\n\tret = cs42l42_common_probe(cs42l83, &cs42l42_soc_component, &cs42l42_dai);\n\tif (ret)\n\t\treturn ret;\n\n\treturn cs42l42_init(cs42l83);\n}\n\nstatic void cs42l83_i2c_remove(struct i2c_client *i2c_client)\n{\n\tstruct cs42l42_private *cs42l83 = dev_get_drvdata(&i2c_client->dev);\n\n\tcs42l42_common_remove(cs42l83);\n}\n\nstatic int __maybe_unused cs42l83_i2c_resume(struct device *dev)\n{\n\tint ret;\n\n\tret = cs42l42_resume(dev);\n\tif (ret)\n\t\treturn ret;\n\n\tcs42l42_resume_restore(dev);\n\n\treturn 0;\n}\n\nstatic const struct dev_pm_ops cs42l83_i2c_pm_ops = {\n\tSET_SYSTEM_SLEEP_PM_OPS(cs42l42_suspend, cs42l83_i2c_resume)\n};\n\nstatic const struct of_device_id __maybe_unused cs42l83_of_match[] = {\n\t{ .compatible = \"cirrus,cs42l83\", },\n\t{}\n};\nMODULE_DEVICE_TABLE(of, cs42l83_of_match);\n\nstatic struct i2c_driver cs42l83_i2c_driver = {\n\t.driver = {\n\t\t.name = \"cs42l83\",\n\t\t.pm = &cs42l83_i2c_pm_ops,\n\t\t.of_match_table = of_match_ptr(cs42l83_of_match),\n\t\t},\n\t.probe = cs42l83_i2c_probe,\n\t.remove = cs42l83_i2c_remove,\n};\n\nmodule_i2c_driver(cs42l83_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC CS42L83 I2C driver\");\nMODULE_AUTHOR(\"Martin Povi\u0161er <povik+lin@cutebit.org>\");\nMODULE_LICENSE(\"GPL\");\nMODULE_IMPORT_NS(SND_SOC_CS42L42_CORE);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}