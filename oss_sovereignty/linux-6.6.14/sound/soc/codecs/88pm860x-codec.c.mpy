{
  "module_name": "88pm860x-codec.c",
  "hash_id": "e0306f8893a718cab7101abdc444c5829dff45ec2f9cfc539566683fe2cc9711",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/88pm860x-codec.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/i2c.h>\n#include <linux/platform_device.h>\n#include <linux/mfd/88pm860x.h>\n#include <linux/slab.h>\n#include <linux/delay.h>\n#include <linux/regmap.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n#include <sound/initval.h>\n#include <sound/jack.h>\n#include <trace/events/asoc.h>\n\n#include \"88pm860x-codec.h\"\n\n#define MAX_NAME_LEN\t\t20\n#define REG_CACHE_SIZE\t\t0x40\n#define REG_CACHE_BASE\t\t0xb0\n\n \n#define REG_STATUS_1\t\t0x01\n#define MIC_STATUS\t\t(1 << 7)\n#define HOOK_STATUS\t\t(1 << 6)\n#define HEADSET_STATUS\t\t(1 << 5)\n\n \n#define REG_MIC_DET\t\t0x37\n#define CONTINUOUS_POLLING\t(3 << 1)\n#define EN_MIC_DET\t\t(1 << 0)\n#define MICDET_MASK\t\t0x07\n\n \n#define REG_HS_DET\t\t0x38\n#define EN_HS_DET\t\t(1 << 0)\n\n \n#define REG_MISC2\t\t0x42\n#define AUDIO_PLL\t\t(1 << 5)\n#define AUDIO_SECTION_RESET\t(1 << 4)\n#define AUDIO_SECTION_ON\t(1 << 3)\n\n \n#define PCM_INF2_BCLK\t\t(1 << 6)\t \n#define PCM_INF2_FS\t\t(1 << 5)\t \n#define PCM_INF2_MASTER\t\t(1 << 4)\t \n#define PCM_INF2_18WL\t\t(1 << 3)\t \n#define PCM_GENERAL_I2S\t\t0\n#define PCM_EXACT_I2S\t\t1\n#define PCM_LEFT_I2S\t\t2\n#define PCM_RIGHT_I2S\t\t3\n#define PCM_SHORT_FS\t\t4\n#define PCM_LONG_FS\t\t5\n#define PCM_MODE_MASK\t\t7\n\n \n#define I2S_EQU_BYP\t\t(1 << 6)\n\n \n#define DAC_MUTE\t\t(1 << 7)\n#define MUTE_LEFT\t\t(1 << 6)\n#define MUTE_RIGHT\t\t(1 << 2)\n\n \n#define REG_ADC_ANA_1\t\t0xd0\n#define MIC1BIAS_MASK\t\t0x60\n\n \n#define REG_EAR2\t\t0xda\n#define RSYNC_CHANGE\t\t(1 << 2)\n\n \n#define REG_SUPPLIES2\t\t0xdc\n#define LDO15_READY\t\t(1 << 4)\n#define LDO15_EN\t\t(1 << 3)\n#define CPUMP_READY\t\t(1 << 2)\n#define CPUMP_EN\t\t(1 << 1)\n#define AUDIO_EN\t\t(1 << 0)\n#define SUPPLY_MASK\t\t(LDO15_EN | CPUMP_EN | AUDIO_EN)\n\n \n#define ADC_MOD_RIGHT\t\t(1 << 1)\n#define ADC_MOD_LEFT\t\t(1 << 0)\n\n \n#define ADC_LEFT\t\t(1 << 5)\n#define ADC_RIGHT\t\t(1 << 4)\n\n \n#define DAC_LEFT\t\t(1 << 5)\n#define DAC_RIGHT\t\t(1 << 4)\n#define MODULATOR\t\t(1 << 3)\n\n \n#define REG_SHORTS\t\t0xeb\n#define CLR_SHORT_LO2\t\t(1 << 7)\n#define SHORT_LO2\t\t(1 << 6)\n#define CLR_SHORT_LO1\t\t(1 << 5)\n#define SHORT_LO1\t\t(1 << 4)\n#define CLR_SHORT_HS2\t\t(1 << 3)\n#define SHORT_HS2\t\t(1 << 2)\n#define CLR_SHORT_HS1\t\t(1 << 1)\n#define SHORT_HS1\t\t(1 << 0)\n\n \n#define PM860X_DAPM_OUTPUT(wname, wevent)\t\\\n\tSND_SOC_DAPM_PGA_E(wname, SND_SOC_NOPM, 0, 0, NULL, 0, wevent, \\\n\t\t\t    SND_SOC_DAPM_POST_PMU | SND_SOC_DAPM_POST_PMD)\n\nstruct pm860x_det {\n\tstruct snd_soc_jack\t*hp_jack;\n\tstruct snd_soc_jack\t*mic_jack;\n\tint\t\t\thp_det;\n\tint\t\t\tmic_det;\n\tint\t\t\thook_det;\n\tint\t\t\ths_shrt;\n\tint\t\t\tlo_shrt;\n};\n\nstruct pm860x_priv {\n\tunsigned int\t\tsysclk;\n\tunsigned int\t\tpcmclk;\n\tunsigned int\t\tdir;\n\tunsigned int\t\tfilter;\n\tstruct snd_soc_component *component;\n\tstruct i2c_client\t*i2c;\n\tstruct regmap\t\t*regmap;\n\tstruct pm860x_chip\t*chip;\n\tstruct pm860x_det\tdet;\n\n\tint\t\t\tirq[4];\n\tunsigned char\t\tname[4][MAX_NAME_LEN];\n};\n\n \nstatic const DECLARE_TLV_DB_SCALE(dpga_tlv, -9450, 150, 1);\n\n \nstatic const DECLARE_TLV_DB_SCALE(adc_tlv, -900, 300, 0);\n\n \nstatic const DECLARE_TLV_DB_RANGE(mic_tlv,\n\t0, 0, TLV_DB_SCALE_ITEM(-2300, 0, 0),\n\t1, 1, TLV_DB_SCALE_ITEM(-1700, 0, 0),\n\t2, 2, TLV_DB_SCALE_ITEM(-1350, 0, 0),\n\t3, 3, TLV_DB_SCALE_ITEM(-1100, 0, 0),\n\t4, 7, TLV_DB_SCALE_ITEM(-900, 300, 0)\n);\n\n \nstatic const DECLARE_TLV_DB_RANGE(aux_tlv,\n\t0, 2, TLV_DB_SCALE_ITEM(0, 0, 0),\n\t3, 7, TLV_DB_SCALE_ITEM(-600, 600, 0)\n);\n\n \nstatic const DECLARE_TLV_DB_RANGE(out_tlv,\n\t0, 3, TLV_DB_SCALE_ITEM(-1600, 300, 1),\n\t4, 4, TLV_DB_SCALE_ITEM(-520, 0, 0),\n\t5, 5, TLV_DB_SCALE_ITEM(-330, 0, 0),\n\t6, 7, TLV_DB_SCALE_ITEM(-220, 220, 0)\n);\n\nstatic const DECLARE_TLV_DB_RANGE(st_tlv,\n\t0, 1, TLV_DB_SCALE_ITEM(-12041, 602, 0),\n\t2, 3, TLV_DB_SCALE_ITEM(-11087, 250, 0),\n\t4, 5, TLV_DB_SCALE_ITEM(-10643, 158, 0),\n\t6, 7, TLV_DB_SCALE_ITEM(-10351, 116, 0),\n\t8, 9, TLV_DB_SCALE_ITEM(-10133, 92, 0),\n\t10, 13, TLV_DB_SCALE_ITEM(-9958, 70, 0),\n\t14, 17, TLV_DB_SCALE_ITEM(-9689, 53, 0),\n\t18, 271, TLV_DB_SCALE_ITEM(-9484, 37, 0)\n);\n\n \nstruct st_gain {\n\tunsigned int\tdb;\n\tunsigned int\tm;\n\tunsigned int\tn;\n};\n\nstatic struct st_gain st_table[] = {\n\t{-12041,  1, 15}, {-11439,  1, 14}, {-11087,  3, 15}, {-10837,  1, 13},\n\t{-10643,  5, 15}, {-10485,  3, 14}, {-10351,  7, 15}, {-10235,  1, 12},\n\t{-10133,  9, 15}, {-10041,  5, 14}, { -9958, 11, 15}, { -9883,  3, 13},\n\t{ -9813, 13, 15}, { -9749,  7, 14}, { -9689, 15, 15}, { -9633,  1, 11},\n\t{ -9580, 17, 15}, { -9531,  9, 14}, { -9484, 19, 15}, { -9439,  5, 13},\n\t{ -9397, 21, 15}, { -9356, 11, 14}, { -9318, 23, 15}, { -9281,  3, 12},\n\t{ -9245, 25, 15}, { -9211, 13, 14}, { -9178, 27, 15}, { -9147,  7, 13},\n\t{ -9116, 29, 15}, { -9087, 15, 14}, { -9058, 31, 15}, { -9031,  1, 10},\n\t{ -8978, 17, 14}, { -8929,  9, 13}, { -8882, 19, 14}, { -8837,  5, 12},\n\t{ -8795, 21, 14}, { -8754, 11, 13}, { -8716, 23, 14}, { -8679,  3, 11},\n\t{ -8643, 25, 14}, { -8609, 13, 13}, { -8576, 27, 14}, { -8545,  7, 12},\n\t{ -8514, 29, 14}, { -8485, 15, 13}, { -8456, 31, 14}, { -8429,  1,  9},\n\t{ -8376, 17, 13}, { -8327,  9, 12}, { -8280, 19, 13}, { -8235,  5, 11},\n\t{ -8193, 21, 13}, { -8152, 11, 12}, { -8114, 23, 13}, { -8077,  3, 10},\n\t{ -8041, 25, 13}, { -8007, 13, 12}, { -7974, 27, 13}, { -7943,  7, 11},\n\t{ -7912, 29, 13}, { -7883, 15, 12}, { -7854, 31, 13}, { -7827,  1,  8},\n\t{ -7774, 17, 12}, { -7724,  9, 11}, { -7678, 19, 12}, { -7633,  5, 10},\n\t{ -7591, 21, 12}, { -7550, 11, 11}, { -7512, 23, 12}, { -7475,  3,  9},\n\t{ -7439, 25, 12}, { -7405, 13, 11}, { -7372, 27, 12}, { -7341,  7, 10},\n\t{ -7310, 29, 12}, { -7281, 15, 11}, { -7252, 31, 12}, { -7225,  1,  7},\n\t{ -7172, 17, 11}, { -7122,  9, 10}, { -7075, 19, 11}, { -7031,  5,  9},\n\t{ -6989, 21, 11}, { -6948, 11, 10}, { -6910, 23, 11}, { -6873,  3,  8},\n\t{ -6837, 25, 11}, { -6803, 13, 10}, { -6770, 27, 11}, { -6739,  7,  9},\n\t{ -6708, 29, 11}, { -6679, 15, 10}, { -6650, 31, 11}, { -6623,  1,  6},\n\t{ -6570, 17, 10}, { -6520,  9,  9}, { -6473, 19, 10}, { -6429,  5,  8},\n\t{ -6386, 21, 10}, { -6346, 11,  9}, { -6307, 23, 10}, { -6270,  3,  7},\n\t{ -6235, 25, 10}, { -6201, 13,  9}, { -6168, 27, 10}, { -6137,  7,  8},\n\t{ -6106, 29, 10}, { -6077, 15,  9}, { -6048, 31, 10}, { -6021,  1,  5},\n\t{ -5968, 17,  9}, { -5918,  9,  8}, { -5871, 19,  9}, { -5827,  5,  7},\n\t{ -5784, 21,  9}, { -5744, 11,  8}, { -5705, 23,  9}, { -5668,  3,  6},\n\t{ -5633, 25,  9}, { -5599, 13,  8}, { -5566, 27,  9}, { -5535,  7,  7},\n\t{ -5504, 29,  9}, { -5475, 15,  8}, { -5446, 31,  9}, { -5419,  1,  4},\n\t{ -5366, 17,  8}, { -5316,  9,  7}, { -5269, 19,  8}, { -5225,  5,  6},\n\t{ -5182, 21,  8}, { -5142, 11,  7}, { -5103, 23,  8}, { -5066,  3,  5},\n\t{ -5031, 25,  8}, { -4997, 13,  7}, { -4964, 27,  8}, { -4932,  7,  6},\n\t{ -4902, 29,  8}, { -4873, 15,  7}, { -4844, 31,  8}, { -4816,  1,  3},\n\t{ -4764, 17,  7}, { -4714,  9,  6}, { -4667, 19,  7}, { -4623,  5,  5},\n\t{ -4580, 21,  7}, { -4540, 11,  6}, { -4501, 23,  7}, { -4464,  3,  4},\n\t{ -4429, 25,  7}, { -4395, 13,  6}, { -4362, 27,  7}, { -4330,  7,  5},\n\t{ -4300, 29,  7}, { -4270, 15,  6}, { -4242, 31,  7}, { -4214,  1,  2},\n\t{ -4162, 17,  6}, { -4112,  9,  5}, { -4065, 19,  6}, { -4021,  5,  4},\n\t{ -3978, 21,  6}, { -3938, 11,  5}, { -3899, 23,  6}, { -3862,  3,  3},\n\t{ -3827, 25,  6}, { -3793, 13,  5}, { -3760, 27,  6}, { -3728,  7,  4},\n\t{ -3698, 29,  6}, { -3668, 15,  5}, { -3640, 31,  6}, { -3612,  1,  1},\n\t{ -3560, 17,  5}, { -3510,  9,  4}, { -3463, 19,  5}, { -3419,  5,  3},\n\t{ -3376, 21,  5}, { -3336, 11,  4}, { -3297, 23,  5}, { -3260,  3,  2},\n\t{ -3225, 25,  5}, { -3191, 13,  4}, { -3158, 27,  5}, { -3126,  7,  3},\n\t{ -3096, 29,  5}, { -3066, 15,  4}, { -3038, 31,  5}, { -3010,  1,  0},\n\t{ -2958, 17,  4}, { -2908,  9,  3}, { -2861, 19,  4}, { -2816,  5,  2},\n\t{ -2774, 21,  4}, { -2734, 11,  3}, { -2695, 23,  4}, { -2658,  3,  1},\n\t{ -2623, 25,  4}, { -2589, 13,  3}, { -2556, 27,  4}, { -2524,  7,  2},\n\t{ -2494, 29,  4}, { -2464, 15,  3}, { -2436, 31,  4}, { -2408,  2,  0},\n\t{ -2356, 17,  3}, { -2306,  9,  2}, { -2259, 19,  3}, { -2214,  5,  1},\n\t{ -2172, 21,  3}, { -2132, 11,  2}, { -2093, 23,  3}, { -2056,  3,  0},\n\t{ -2021, 25,  3}, { -1987, 13,  2}, { -1954, 27,  3}, { -1922,  7,  1},\n\t{ -1892, 29,  3}, { -1862, 15,  2}, { -1834, 31,  3}, { -1806,  4,  0},\n\t{ -1754, 17,  2}, { -1704,  9,  1}, { -1657, 19,  2}, { -1612,  5,  0},\n\t{ -1570, 21,  2}, { -1530, 11,  1}, { -1491, 23,  2}, { -1454,  6,  0},\n\t{ -1419, 25,  2}, { -1384, 13,  1}, { -1352, 27,  2}, { -1320,  7,  0},\n\t{ -1290, 29,  2}, { -1260, 15,  1}, { -1232, 31,  2}, { -1204,  8,  0},\n\t{ -1151, 17,  1}, { -1102,  9,  0}, { -1055, 19,  1}, { -1010, 10,  0},\n\t{  -968, 21,  1}, {  -928, 11,  0}, {  -889, 23,  1}, {  -852, 12,  0},\n\t{  -816, 25,  1}, {  -782, 13,  0}, {  -750, 27,  1}, {  -718, 14,  0},\n\t{  -688, 29,  1}, {  -658, 15,  0}, {  -630, 31,  1}, {  -602, 16,  0},\n\t{  -549, 17,  0}, {  -500, 18,  0}, {  -453, 19,  0}, {  -408, 20,  0},\n\t{  -366, 21,  0}, {  -325, 22,  0}, {  -287, 23,  0}, {  -250, 24,  0},\n\t{  -214, 25,  0}, {  -180, 26,  0}, {  -148, 27,  0}, {  -116, 28,  0},\n\t{   -86, 29,  0}, {   -56, 30,  0}, {   -28, 31,  0}, {     0,  0,  0},\n};\n\nstatic int snd_soc_get_volsw_2r_st(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_mixer_control *mc =\n\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tunsigned int reg = mc->reg;\n\tunsigned int reg2 = mc->rreg;\n\tint val[2], val2[2], i;\n\n\tval[0] = snd_soc_component_read(component, reg) & 0x3f;\n\tval[1] = (snd_soc_component_read(component, PM860X_SIDETONE_SHIFT) >> 4) & 0xf;\n\tval2[0] = snd_soc_component_read(component, reg2) & 0x3f;\n\tval2[1] = (snd_soc_component_read(component, PM860X_SIDETONE_SHIFT)) & 0xf;\n\n\tfor (i = 0; i < ARRAY_SIZE(st_table); i++) {\n\t\tif ((st_table[i].m == val[0]) && (st_table[i].n == val[1]))\n\t\t\tucontrol->value.integer.value[0] = i;\n\t\tif ((st_table[i].m == val2[0]) && (st_table[i].n == val2[1]))\n\t\t\tucontrol->value.integer.value[1] = i;\n\t}\n\treturn 0;\n}\n\nstatic int snd_soc_put_volsw_2r_st(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_mixer_control *mc =\n\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tunsigned int reg = mc->reg;\n\tunsigned int reg2 = mc->rreg;\n\tint err;\n\tunsigned int val, val2;\n\n\tval = ucontrol->value.integer.value[0];\n\tval2 = ucontrol->value.integer.value[1];\n\n\tif (val >= ARRAY_SIZE(st_table) || val2 >= ARRAY_SIZE(st_table))\n\t\treturn -EINVAL;\n\n\terr = snd_soc_component_update_bits(component, reg, 0x3f, st_table[val].m);\n\tif (err < 0)\n\t\treturn err;\n\terr = snd_soc_component_update_bits(component, PM860X_SIDETONE_SHIFT, 0xf0,\n\t\t\t\t  st_table[val].n << 4);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = snd_soc_component_update_bits(component, reg2, 0x3f, st_table[val2].m);\n\tif (err < 0)\n\t\treturn err;\n\terr = snd_soc_component_update_bits(component, PM860X_SIDETONE_SHIFT, 0x0f,\n\t\t\t\t  st_table[val2].n);\n\treturn err;\n}\n\nstatic int snd_soc_get_volsw_2r_out(struct snd_kcontrol *kcontrol,\n\t\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_mixer_control *mc =\n\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tunsigned int reg = mc->reg;\n\tunsigned int reg2 = mc->rreg;\n\tunsigned int shift = mc->shift;\n\tint max = mc->max, val, val2;\n\tunsigned int mask = (1 << fls(max)) - 1;\n\n\tval = snd_soc_component_read(component, reg) >> shift;\n\tval2 = snd_soc_component_read(component, reg2) >> shift;\n\tucontrol->value.integer.value[0] = (max - val) & mask;\n\tucontrol->value.integer.value[1] = (max - val2) & mask;\n\n\treturn 0;\n}\n\nstatic int snd_soc_put_volsw_2r_out(struct snd_kcontrol *kcontrol,\n\t\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_mixer_control *mc =\n\t\t(struct soc_mixer_control *)kcontrol->private_value;\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tunsigned int reg = mc->reg;\n\tunsigned int reg2 = mc->rreg;\n\tunsigned int shift = mc->shift;\n\tint max = mc->max;\n\tunsigned int mask = (1 << fls(max)) - 1;\n\tint err;\n\tunsigned int val, val2, val_mask;\n\n\tval_mask = mask << shift;\n\tval = ((max - ucontrol->value.integer.value[0]) & mask);\n\tval2 = ((max - ucontrol->value.integer.value[1]) & mask);\n\n\tval = val << shift;\n\tval2 = val2 << shift;\n\n\terr = snd_soc_component_update_bits(component, reg, val_mask, val);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = snd_soc_component_update_bits(component, reg2, val_mask, val2);\n\treturn err;\n}\n\n \n \nstatic int pm860x_rsync_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\t \n\tsnd_soc_component_update_bits(component, PM860X_DAC_OFFSET, DAC_MUTE, 0);\n\tsnd_soc_component_update_bits(component, PM860X_EAR_CTRL_2,\n\t\t\t    RSYNC_CHANGE, RSYNC_CHANGE);\n\treturn 0;\n}\n\nstatic int pm860x_dac_event(struct snd_soc_dapm_widget *w,\n\t\t\t    struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tunsigned int dac = 0;\n\tint data;\n\n\tif (!strcmp(w->name, \"Left DAC\"))\n\t\tdac = DAC_LEFT;\n\tif (!strcmp(w->name, \"Right DAC\"))\n\t\tdac = DAC_RIGHT;\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tif (dac) {\n\t\t\t \n\t\t\tdac |= MODULATOR;\n\t\t\tsnd_soc_component_update_bits(component, PM860X_DAC_OFFSET,\n\t\t\t\t\t    DAC_MUTE, DAC_MUTE);\n\t\t\tsnd_soc_component_update_bits(component, PM860X_EAR_CTRL_2,\n\t\t\t\t\t    RSYNC_CHANGE, RSYNC_CHANGE);\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(component, PM860X_DAC_EN_2,\n\t\t\t\t\t    dac, dac);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tif (dac) {\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(component, PM860X_DAC_OFFSET,\n\t\t\t\t\t    DAC_MUTE, DAC_MUTE);\n\t\t\tsnd_soc_component_update_bits(component, PM860X_EAR_CTRL_2,\n\t\t\t\t\t    RSYNC_CHANGE, RSYNC_CHANGE);\n\t\t\t \n\t\t\tdata = snd_soc_component_read(component, PM860X_DAC_EN_2);\n\t\t\tdata &= ~dac;\n\t\t\tif (!(data & (DAC_LEFT | DAC_RIGHT)))\n\t\t\t\tdata &= ~MODULATOR;\n\t\t\tsnd_soc_component_write(component, PM860X_DAC_EN_2, data);\n\t\t}\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic const char *pm860x_opamp_texts[] = {\"-50%\", \"-25%\", \"0%\", \"75%\"};\n\nstatic const char *pm860x_pa_texts[] = {\"-33%\", \"0%\", \"33%\", \"66%\"};\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_hs1_opamp_enum,\n\t\t\t    PM860X_HS1_CTRL, 5, pm860x_opamp_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_hs2_opamp_enum,\n\t\t\t    PM860X_HS2_CTRL, 5, pm860x_opamp_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_hs1_pa_enum,\n\t\t\t    PM860X_HS1_CTRL, 3, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_hs2_pa_enum,\n\t\t\t    PM860X_HS2_CTRL, 3, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_lo1_opamp_enum,\n\t\t\t    PM860X_LO1_CTRL, 5, pm860x_opamp_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_lo2_opamp_enum,\n\t\t\t    PM860X_LO2_CTRL, 5, pm860x_opamp_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_lo1_pa_enum,\n\t\t\t    PM860X_LO1_CTRL, 3, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_lo2_pa_enum,\n\t\t\t    PM860X_LO2_CTRL, 3, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_spk_pa_enum,\n\t\t\t    PM860X_EAR_CTRL_1, 5, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_ear_pa_enum,\n\t\t\t    PM860X_EAR_CTRL_2, 0, pm860x_pa_texts);\n\nstatic SOC_ENUM_SINGLE_DECL(pm860x_spk_ear_opamp_enum,\n\t\t\t    PM860X_EAR_CTRL_1, 3, pm860x_opamp_texts);\n\nstatic const struct snd_kcontrol_new pm860x_snd_controls[] = {\n\tSOC_DOUBLE_R_TLV(\"ADC Capture Volume\", PM860X_ADC_ANA_2,\n\t\t\tPM860X_ADC_ANA_3, 6, 3, 0, adc_tlv),\n\tSOC_DOUBLE_TLV(\"AUX Capture Volume\", PM860X_ADC_ANA_3, 0, 3, 7, 0,\n\t\t\taux_tlv),\n\tSOC_SINGLE_TLV(\"MIC1 Capture Volume\", PM860X_ADC_ANA_2, 0, 7, 0,\n\t\t\tmic_tlv),\n\tSOC_SINGLE_TLV(\"MIC3 Capture Volume\", PM860X_ADC_ANA_2, 3, 7, 0,\n\t\t\tmic_tlv),\n\tSOC_DOUBLE_R_EXT_TLV(\"Sidetone Volume\", PM860X_SIDETONE_L_GAIN,\n\t\t\t     PM860X_SIDETONE_R_GAIN, 0, ARRAY_SIZE(st_table)-1,\n\t\t\t     0, snd_soc_get_volsw_2r_st,\n\t\t\t     snd_soc_put_volsw_2r_st, st_tlv),\n\tSOC_SINGLE_TLV(\"Speaker Playback Volume\", PM860X_EAR_CTRL_1,\n\t\t\t0, 7, 0, out_tlv),\n\tSOC_DOUBLE_R_TLV(\"Line Playback Volume\", PM860X_LO1_CTRL,\n\t\t\t PM860X_LO2_CTRL, 0, 7, 0, out_tlv),\n\tSOC_DOUBLE_R_TLV(\"Headset Playback Volume\", PM860X_HS1_CTRL,\n\t\t\t PM860X_HS2_CTRL, 0, 7, 0, out_tlv),\n\tSOC_DOUBLE_R_EXT_TLV(\"Hifi Left Playback Volume\",\n\t\t\t     PM860X_HIFIL_GAIN_LEFT,\n\t\t\t     PM860X_HIFIL_GAIN_RIGHT, 0, 63, 0,\n\t\t\t     snd_soc_get_volsw_2r_out,\n\t\t\t     snd_soc_put_volsw_2r_out, dpga_tlv),\n\tSOC_DOUBLE_R_EXT_TLV(\"Hifi Right Playback Volume\",\n\t\t\t     PM860X_HIFIR_GAIN_LEFT,\n\t\t\t     PM860X_HIFIR_GAIN_RIGHT, 0, 63, 0,\n\t\t\t     snd_soc_get_volsw_2r_out,\n\t\t\t     snd_soc_put_volsw_2r_out, dpga_tlv),\n\tSOC_DOUBLE_R_EXT_TLV(\"Lofi Playback Volume\", PM860X_LOFI_GAIN_LEFT,\n\t\t\t     PM860X_LOFI_GAIN_RIGHT, 0, 63, 0,\n\t\t\t     snd_soc_get_volsw_2r_out,\n\t\t\t     snd_soc_put_volsw_2r_out, dpga_tlv),\n\tSOC_ENUM(\"Headset1 Operational Amplifier Current\",\n\t\t pm860x_hs1_opamp_enum),\n\tSOC_ENUM(\"Headset2 Operational Amplifier Current\",\n\t\t pm860x_hs2_opamp_enum),\n\tSOC_ENUM(\"Headset1 Amplifier Current\", pm860x_hs1_pa_enum),\n\tSOC_ENUM(\"Headset2 Amplifier Current\", pm860x_hs2_pa_enum),\n\tSOC_ENUM(\"Lineout1 Operational Amplifier Current\",\n\t\t pm860x_lo1_opamp_enum),\n\tSOC_ENUM(\"Lineout2 Operational Amplifier Current\",\n\t\t pm860x_lo2_opamp_enum),\n\tSOC_ENUM(\"Lineout1 Amplifier Current\", pm860x_lo1_pa_enum),\n\tSOC_ENUM(\"Lineout2 Amplifier Current\", pm860x_lo2_pa_enum),\n\tSOC_ENUM(\"Speaker Operational Amplifier Current\",\n\t\t pm860x_spk_ear_opamp_enum),\n\tSOC_ENUM(\"Speaker Amplifier Current\", pm860x_spk_pa_enum),\n\tSOC_ENUM(\"Earpiece Amplifier Current\", pm860x_ear_pa_enum),\n};\n\n \n\n \nstatic const struct snd_kcontrol_new aux1_switch_controls =\n\tSOC_DAPM_SINGLE(\"Switch\", PM860X_ANA_TO_ANA, 4, 1, 0);\n\n \nstatic const struct snd_kcontrol_new aux2_switch_controls =\n\tSOC_DAPM_SINGLE(\"Switch\", PM860X_ANA_TO_ANA, 5, 1, 0);\n\n \nstatic const struct snd_kcontrol_new lepa_switch_controls =\n\tSOC_DAPM_SINGLE(\"Switch\", PM860X_DAC_EN_2, 2, 1, 0);\n\n \nstatic const struct snd_kcontrol_new repa_switch_controls =\n\tSOC_DAPM_SINGLE(\"Switch\", PM860X_DAC_EN_2, 1, 1, 0);\n\n \nstatic const char *i2s_din_text[] = {\n\t\"DIN\", \"DIN1\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(i2s_din_enum,\n\t\t\t    PM860X_I2S_IFACE_3, 1, i2s_din_text);\n\nstatic const struct snd_kcontrol_new i2s_din_mux =\n\tSOC_DAPM_ENUM(\"I2S DIN Mux\", i2s_din_enum);\n\n \nstatic const char *i2s_mic_text[] = {\n\t\"Ex PA\", \"ADC\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(i2s_mic_enum,\n\t\t\t    PM860X_I2S_IFACE_3, 4, i2s_mic_text);\n\nstatic const struct snd_kcontrol_new i2s_mic_mux =\n\tSOC_DAPM_ENUM(\"I2S Mic Mux\", i2s_mic_enum);\n\n \nstatic const char *adcl_text[] = {\n\t\"ADCR\", \"ADCL\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(adcl_enum,\n\t\t\t    PM860X_PCM_IFACE_3, 4, adcl_text);\n\nstatic const struct snd_kcontrol_new adcl_mux =\n\tSOC_DAPM_ENUM(\"ADC Left Mux\", adcl_enum);\n\n \nstatic const char *adcr_text[] = {\n\t\"ADCL\", \"ADCR\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(adcr_enum,\n\t\t\t    PM860X_PCM_IFACE_3, 2, adcr_text);\n\nstatic const struct snd_kcontrol_new adcr_mux =\n\tSOC_DAPM_ENUM(\"ADC Right Mux\", adcr_enum);\n\n \nstatic const char *adcr_ec_text[] = {\n\t\"ADCR\", \"EC\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(adcr_ec_enum,\n\t\t\t    PM860X_ADC_EN_2, 3, adcr_ec_text);\n\nstatic const struct snd_kcontrol_new adcr_ec_mux =\n\tSOC_DAPM_ENUM(\"ADCR EC Mux\", adcr_ec_enum);\n\n \nstatic const char *ec_text[] = {\n\t\"Left\", \"Right\", \"Left + Right\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(ec_enum,\n\t\t\t    PM860X_EC_PATH, 1, ec_text);\n\nstatic const struct snd_kcontrol_new ec_mux =\n\tSOC_DAPM_ENUM(\"EC Mux\", ec_enum);\n\nstatic const char *dac_text[] = {\n\t\"No input\", \"Right\", \"Left\", \"No input\",\n};\n\n \nstatic SOC_ENUM_SINGLE_DECL(dac_hs1_enum,\n\t\t\t    PM860X_ANA_INPUT_SEL_1, 0, dac_text);\n\nstatic const struct snd_kcontrol_new dac_hs1_mux =\n\tSOC_DAPM_ENUM(\"DAC HS1 Mux\", dac_hs1_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(dac_hs2_enum,\n\t\t\t    PM860X_ANA_INPUT_SEL_1, 2, dac_text);\n\nstatic const struct snd_kcontrol_new dac_hs2_mux =\n\tSOC_DAPM_ENUM(\"DAC HS2 Mux\", dac_hs2_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(dac_lo1_enum,\n\t\t\t    PM860X_ANA_INPUT_SEL_1, 4, dac_text);\n\nstatic const struct snd_kcontrol_new dac_lo1_mux =\n\tSOC_DAPM_ENUM(\"DAC LO1 Mux\", dac_lo1_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(dac_lo2_enum,\n\t\t\t    PM860X_ANA_INPUT_SEL_1, 6, dac_text);\n\nstatic const struct snd_kcontrol_new dac_lo2_mux =\n\tSOC_DAPM_ENUM(\"DAC LO2 Mux\", dac_lo2_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(dac_spk_ear_enum,\n\t\t\t    PM860X_ANA_INPUT_SEL_2, 0, dac_text);\n\nstatic const struct snd_kcontrol_new dac_spk_ear_mux =\n\tSOC_DAPM_ENUM(\"DAC SP Mux\", dac_spk_ear_enum);\n\n \nstatic const char *in_text[] = {\n\t\"Digital\", \"Analog\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(hs1_enum,\n\t\t\t    PM860X_ANA_TO_ANA, 0, in_text);\n\nstatic const struct snd_kcontrol_new hs1_mux =\n\tSOC_DAPM_ENUM(\"Headset1 Mux\", hs1_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(hs2_enum,\n\t\t\t    PM860X_ANA_TO_ANA, 1, in_text);\n\nstatic const struct snd_kcontrol_new hs2_mux =\n\tSOC_DAPM_ENUM(\"Headset2 Mux\", hs2_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(lo1_enum,\n\t\t\t    PM860X_ANA_TO_ANA, 2, in_text);\n\nstatic const struct snd_kcontrol_new lo1_mux =\n\tSOC_DAPM_ENUM(\"Lineout1 Mux\", lo1_enum);\n\n \nstatic SOC_ENUM_SINGLE_DECL(lo2_enum,\n\t\t\t    PM860X_ANA_TO_ANA, 3, in_text);\n\nstatic const struct snd_kcontrol_new lo2_mux =\n\tSOC_DAPM_ENUM(\"Lineout2 Mux\", lo2_enum);\n\n \nstatic const char *spk_text[] = {\n\t\"Earpiece\", \"Speaker\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(spk_enum,\n\t\t\t    PM860X_ANA_TO_ANA, 6, spk_text);\n\nstatic const struct snd_kcontrol_new spk_demux =\n\tSOC_DAPM_ENUM(\"Speaker Earpiece Demux\", spk_enum);\n\n \nstatic const char *mic_text[] = {\n\t\"Mic 1\", \"Mic 2\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(mic_enum,\n\t\t\t    PM860X_ADC_ANA_4, 4, mic_text);\n\nstatic const struct snd_kcontrol_new mic_mux =\n\tSOC_DAPM_ENUM(\"MIC Mux\", mic_enum);\n\nstatic const struct snd_soc_dapm_widget pm860x_dapm_widgets[] = {\n\tSND_SOC_DAPM_AIF_IN(\"PCM SDI\", \"PCM Playback\", 0,\n\t\t\t    PM860X_ADC_EN_2, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"PCM SDO\", \"PCM Capture\", 0,\n\t\t\t     PM860X_PCM_IFACE_3, 1, 1),\n\n\n\tSND_SOC_DAPM_AIF_IN(\"I2S DIN\", \"I2S Playback\", 0,\n\t\t\t    SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"I2S DIN1\", \"I2S Playback\", 0,\n\t\t\t    SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"I2S DOUT\", \"I2S Capture\", 0,\n\t\t\t     PM860X_I2S_IFACE_3, 5, 1),\n\tSND_SOC_DAPM_SUPPLY(\"I2S CLK\", PM860X_DAC_EN_2, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_MUX(\"I2S Mic Mux\", SND_SOC_NOPM, 0, 0, &i2s_mic_mux),\n\tSND_SOC_DAPM_MUX(\"ADC Left Mux\", SND_SOC_NOPM, 0, 0, &adcl_mux),\n\tSND_SOC_DAPM_MUX(\"ADC Right Mux\", SND_SOC_NOPM, 0, 0, &adcr_mux),\n\tSND_SOC_DAPM_MUX(\"EC Mux\", SND_SOC_NOPM, 0, 0, &ec_mux),\n\tSND_SOC_DAPM_MUX(\"ADCR EC Mux\", SND_SOC_NOPM, 0, 0, &adcr_ec_mux),\n\tSND_SOC_DAPM_SWITCH(\"Left EPA\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &lepa_switch_controls),\n\tSND_SOC_DAPM_SWITCH(\"Right EPA\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &repa_switch_controls),\n\n\tSND_SOC_DAPM_REG(snd_soc_dapm_supply, \"Left ADC MOD\", PM860X_ADC_EN_1,\n\t\t\t 0, 1, 1, 0),\n\tSND_SOC_DAPM_REG(snd_soc_dapm_supply, \"Right ADC MOD\", PM860X_ADC_EN_1,\n\t\t\t 1, 1, 1, 0),\n\tSND_SOC_DAPM_ADC(\"Left ADC\", NULL, PM860X_ADC_EN_2, 5, 0),\n\tSND_SOC_DAPM_ADC(\"Right ADC\", NULL, PM860X_ADC_EN_2, 4, 0),\n\n\tSND_SOC_DAPM_SWITCH(\"AUX1 Switch\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &aux1_switch_controls),\n\tSND_SOC_DAPM_SWITCH(\"AUX2 Switch\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &aux2_switch_controls),\n\n\tSND_SOC_DAPM_MUX(\"MIC Mux\", SND_SOC_NOPM, 0, 0, &mic_mux),\n\tSND_SOC_DAPM_MICBIAS(\"Mic1 Bias\", PM860X_ADC_ANA_1, 2, 0),\n\tSND_SOC_DAPM_MICBIAS(\"Mic3 Bias\", PM860X_ADC_ANA_1, 7, 0),\n\tSND_SOC_DAPM_PGA(\"MIC1 Volume\", PM860X_ADC_EN_1, 2, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"MIC3 Volume\", PM860X_ADC_EN_1, 3, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"AUX1 Volume\", PM860X_ADC_EN_1, 4, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"AUX2 Volume\", PM860X_ADC_EN_1, 5, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Sidetone PGA\", PM860X_ADC_EN_2, 1, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Lofi PGA\", PM860X_ADC_EN_2, 2, 0, NULL, 0),\n\n\tSND_SOC_DAPM_INPUT(\"AUX1\"),\n\tSND_SOC_DAPM_INPUT(\"AUX2\"),\n\tSND_SOC_DAPM_INPUT(\"MIC1P\"),\n\tSND_SOC_DAPM_INPUT(\"MIC1N\"),\n\tSND_SOC_DAPM_INPUT(\"MIC2P\"),\n\tSND_SOC_DAPM_INPUT(\"MIC2N\"),\n\tSND_SOC_DAPM_INPUT(\"MIC3P\"),\n\tSND_SOC_DAPM_INPUT(\"MIC3N\"),\n\n\tSND_SOC_DAPM_DAC_E(\"Left DAC\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   pm860x_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD),\n\tSND_SOC_DAPM_DAC_E(\"Right DAC\", NULL, SND_SOC_NOPM, 0, 0,\n\t\t\t   pm860x_dac_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_PRE_PMD),\n\n\tSND_SOC_DAPM_MUX(\"I2S DIN Mux\", SND_SOC_NOPM, 0, 0, &i2s_din_mux),\n\tSND_SOC_DAPM_MUX(\"DAC HS1 Mux\", SND_SOC_NOPM, 0, 0, &dac_hs1_mux),\n\tSND_SOC_DAPM_MUX(\"DAC HS2 Mux\", SND_SOC_NOPM, 0, 0, &dac_hs2_mux),\n\tSND_SOC_DAPM_MUX(\"DAC LO1 Mux\", SND_SOC_NOPM, 0, 0, &dac_lo1_mux),\n\tSND_SOC_DAPM_MUX(\"DAC LO2 Mux\", SND_SOC_NOPM, 0, 0, &dac_lo2_mux),\n\tSND_SOC_DAPM_MUX(\"DAC SP Mux\", SND_SOC_NOPM, 0, 0, &dac_spk_ear_mux),\n\tSND_SOC_DAPM_MUX(\"Headset1 Mux\", SND_SOC_NOPM, 0, 0, &hs1_mux),\n\tSND_SOC_DAPM_MUX(\"Headset2 Mux\", SND_SOC_NOPM, 0, 0, &hs2_mux),\n\tSND_SOC_DAPM_MUX(\"Lineout1 Mux\", SND_SOC_NOPM, 0, 0, &lo1_mux),\n\tSND_SOC_DAPM_MUX(\"Lineout2 Mux\", SND_SOC_NOPM, 0, 0, &lo2_mux),\n\tSND_SOC_DAPM_MUX(\"Speaker Earpiece Demux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &spk_demux),\n\n\n\tSND_SOC_DAPM_PGA(\"Headset1 PGA\", PM860X_DAC_EN_1, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Headset2 PGA\", PM860X_DAC_EN_1, 1, 0, NULL, 0),\n\tSND_SOC_DAPM_OUTPUT(\"HS1\"),\n\tSND_SOC_DAPM_OUTPUT(\"HS2\"),\n\tSND_SOC_DAPM_PGA(\"Lineout1 PGA\", PM860X_DAC_EN_1, 2, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Lineout2 PGA\", PM860X_DAC_EN_1, 3, 0, NULL, 0),\n\tSND_SOC_DAPM_OUTPUT(\"LINEOUT1\"),\n\tSND_SOC_DAPM_OUTPUT(\"LINEOUT2\"),\n\tSND_SOC_DAPM_PGA(\"Earpiece PGA\", PM860X_DAC_EN_1, 4, 0, NULL, 0),\n\tSND_SOC_DAPM_OUTPUT(\"EARP\"),\n\tSND_SOC_DAPM_OUTPUT(\"EARN\"),\n\tSND_SOC_DAPM_PGA(\"Speaker PGA\", PM860X_DAC_EN_1, 5, 0, NULL, 0),\n\tSND_SOC_DAPM_OUTPUT(\"LSP\"),\n\tSND_SOC_DAPM_OUTPUT(\"LSN\"),\n\tSND_SOC_DAPM_REG(snd_soc_dapm_supply, \"VCODEC\", PM860X_AUDIO_SUPPLIES_2,\n\t\t\t 0, SUPPLY_MASK, SUPPLY_MASK, 0),\n\n\tPM860X_DAPM_OUTPUT(\"RSYNC\", pm860x_rsync_event),\n};\n\nstatic const struct snd_soc_dapm_route pm860x_dapm_routes[] = {\n\t \n\t{\"Left DAC\", NULL, \"VCODEC\"},\n\t{\"Right DAC\", NULL, \"VCODEC\"},\n\t{\"Left ADC\", NULL, \"VCODEC\"},\n\t{\"Right ADC\", NULL, \"VCODEC\"},\n\t{\"Left ADC\", NULL, \"Left ADC MOD\"},\n\t{\"Right ADC\", NULL, \"Right ADC MOD\"},\n\n\t \n\t{\"I2S DIN\", NULL, \"I2S CLK\"},\n\t{\"I2S DIN1\", NULL, \"I2S CLK\"},\n\t{\"I2S DOUT\", NULL, \"I2S CLK\"},\n\n\t \n\t{\"PCM SDO\", NULL, \"ADC Left Mux\"},\n\t{\"PCM SDO\", NULL, \"ADCR EC Mux\"},\n\n\t \n\t{\"Lofi PGA\", NULL, \"PCM SDI\"},\n\t{\"Lofi PGA\", NULL, \"Sidetone PGA\"},\n\t{\"Left DAC\", NULL, \"Lofi PGA\"},\n\t{\"Right DAC\", NULL, \"Lofi PGA\"},\n\n\t \n\t{\"MIC Mux\", \"Mic 1\", \"MIC1P\"},\n\t{\"MIC Mux\", \"Mic 1\", \"MIC1N\"},\n\t{\"MIC Mux\", \"Mic 2\", \"MIC2P\"},\n\t{\"MIC Mux\", \"Mic 2\", \"MIC2N\"},\n\t{\"MIC1 Volume\", NULL, \"MIC Mux\"},\n\t{\"MIC3 Volume\", NULL, \"MIC3P\"},\n\t{\"MIC3 Volume\", NULL, \"MIC3N\"},\n\t{\"Left ADC\", NULL, \"MIC1 Volume\"},\n\t{\"Right ADC\", NULL, \"MIC3 Volume\"},\n\t{\"ADC Left Mux\", \"ADCR\", \"Right ADC\"},\n\t{\"ADC Left Mux\", \"ADCL\", \"Left ADC\"},\n\t{\"ADC Right Mux\", \"ADCL\", \"Left ADC\"},\n\t{\"ADC Right Mux\", \"ADCR\", \"Right ADC\"},\n\t{\"Left EPA\", \"Switch\", \"Left DAC\"},\n\t{\"Right EPA\", \"Switch\", \"Right DAC\"},\n\t{\"EC Mux\", \"Left\", \"Left DAC\"},\n\t{\"EC Mux\", \"Right\", \"Right DAC\"},\n\t{\"EC Mux\", \"Left + Right\", \"Left DAC\"},\n\t{\"EC Mux\", \"Left + Right\", \"Right DAC\"},\n\t{\"ADCR EC Mux\", \"ADCR\", \"ADC Right Mux\"},\n\t{\"ADCR EC Mux\", \"EC\", \"EC Mux\"},\n\t{\"I2S Mic Mux\", \"Ex PA\", \"Left EPA\"},\n\t{\"I2S Mic Mux\", \"Ex PA\", \"Right EPA\"},\n\t{\"I2S Mic Mux\", \"ADC\", \"ADC Left Mux\"},\n\t{\"I2S Mic Mux\", \"ADC\", \"ADCR EC Mux\"},\n\t{\"I2S DOUT\", NULL, \"I2S Mic Mux\"},\n\n\t \n\t{\"I2S DIN Mux\", \"DIN\", \"I2S DIN\"},\n\t{\"I2S DIN Mux\", \"DIN1\", \"I2S DIN1\"},\n\t{\"Left DAC\", NULL, \"I2S DIN Mux\"},\n\t{\"Right DAC\", NULL, \"I2S DIN Mux\"},\n\t{\"DAC HS1 Mux\", \"Left\", \"Left DAC\"},\n\t{\"DAC HS1 Mux\", \"Right\", \"Right DAC\"},\n\t{\"DAC HS2 Mux\", \"Left\", \"Left DAC\"},\n\t{\"DAC HS2 Mux\", \"Right\", \"Right DAC\"},\n\t{\"DAC LO1 Mux\", \"Left\", \"Left DAC\"},\n\t{\"DAC LO1 Mux\", \"Right\", \"Right DAC\"},\n\t{\"DAC LO2 Mux\", \"Left\", \"Left DAC\"},\n\t{\"DAC LO2 Mux\", \"Right\", \"Right DAC\"},\n\t{\"Headset1 Mux\", \"Digital\", \"DAC HS1 Mux\"},\n\t{\"Headset2 Mux\", \"Digital\", \"DAC HS2 Mux\"},\n\t{\"Lineout1 Mux\", \"Digital\", \"DAC LO1 Mux\"},\n\t{\"Lineout2 Mux\", \"Digital\", \"DAC LO2 Mux\"},\n\t{\"Headset1 PGA\", NULL, \"Headset1 Mux\"},\n\t{\"Headset2 PGA\", NULL, \"Headset2 Mux\"},\n\t{\"Lineout1 PGA\", NULL, \"Lineout1 Mux\"},\n\t{\"Lineout2 PGA\", NULL, \"Lineout2 Mux\"},\n\t{\"DAC SP Mux\", \"Left\", \"Left DAC\"},\n\t{\"DAC SP Mux\", \"Right\", \"Right DAC\"},\n\t{\"Speaker Earpiece Demux\", \"Speaker\", \"DAC SP Mux\"},\n\t{\"Speaker PGA\", NULL, \"Speaker Earpiece Demux\"},\n\t{\"Earpiece PGA\", NULL, \"Speaker Earpiece Demux\"},\n\n\t{\"RSYNC\", NULL, \"Headset1 PGA\"},\n\t{\"RSYNC\", NULL, \"Headset2 PGA\"},\n\t{\"RSYNC\", NULL, \"Lineout1 PGA\"},\n\t{\"RSYNC\", NULL, \"Lineout2 PGA\"},\n\t{\"RSYNC\", NULL, \"Speaker PGA\"},\n\t{\"RSYNC\", NULL, \"Speaker PGA\"},\n\t{\"RSYNC\", NULL, \"Earpiece PGA\"},\n\t{\"RSYNC\", NULL, \"Earpiece PGA\"},\n\n\t{\"HS1\", NULL, \"RSYNC\"},\n\t{\"HS2\", NULL, \"RSYNC\"},\n\t{\"LINEOUT1\", NULL, \"RSYNC\"},\n\t{\"LINEOUT2\", NULL, \"RSYNC\"},\n\t{\"LSP\", NULL, \"RSYNC\"},\n\t{\"LSN\", NULL, \"RSYNC\"},\n\t{\"EARP\", NULL, \"RSYNC\"},\n\t{\"EARN\", NULL, \"RSYNC\"},\n};\n\n \nstatic int pm860x_mute_stream(struct snd_soc_dai *codec_dai, int mute, int direction)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tint data = 0, mask = MUTE_LEFT | MUTE_RIGHT;\n\n\tif (mute)\n\t\tdata = mask;\n\tsnd_soc_component_update_bits(component, PM860X_DAC_OFFSET, mask, data);\n\tsnd_soc_component_update_bits(component, PM860X_EAR_CTRL_2,\n\t\t\t    RSYNC_CHANGE, RSYNC_CHANGE);\n\treturn 0;\n}\n\nstatic int pm860x_pcm_hw_params(struct snd_pcm_substream *substream,\n\t\t\t\tstruct snd_pcm_hw_params *params,\n\t\t\t\tstruct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tunsigned char inf = 0, mask = 0;\n\n\t \n\tswitch (params_width(params)) {\n\tcase 16:\n\t\tinf &= ~PCM_INF2_18WL;\n\t\tbreak;\n\tcase 18:\n\t\tinf |= PCM_INF2_18WL;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tmask |= PCM_INF2_18WL;\n\tsnd_soc_component_update_bits(component, PM860X_PCM_IFACE_2, mask, inf);\n\n\t \n\tswitch (params_rate(params)) {\n\tcase 8000:\n\t\tinf = 0;\n\t\tbreak;\n\tcase 16000:\n\t\tinf = 3;\n\t\tbreak;\n\tcase 32000:\n\t\tinf = 6;\n\t\tbreak;\n\tcase 48000:\n\t\tinf = 8;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, PM860X_PCM_RATE, 0x0f, inf);\n\n\treturn 0;\n}\n\nstatic int pm860x_pcm_set_dai_fmt(struct snd_soc_dai *codec_dai,\n\t\t\t\t  unsigned int fmt)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tunsigned char inf = 0, mask = 0;\n\tint ret = -EINVAL;\n\n\tmask |= PCM_INF2_BCLK | PCM_INF2_FS | PCM_INF2_MASTER;\n\n\t \n\tswitch (fmt & SND_SOC_DAIFMT_CLOCK_PROVIDER_MASK) {\n\tcase SND_SOC_DAIFMT_CBP_CFP:\n\tcase SND_SOC_DAIFMT_CBP_CFC:\n\t\tif (pm860x->dir == PM860X_CLK_DIR_OUT) {\n\t\t\tinf |= PCM_INF2_MASTER;\n\t\t\tret = 0;\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBC_CFC:\n\t\tif (pm860x->dir == PM860X_CLK_DIR_IN) {\n\t\t\tinf &= ~PCM_INF2_MASTER;\n\t\t\tret = 0;\n\t\t}\n\t\tbreak;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:\n\t\tinf |= PCM_EXACT_I2S;\n\t\tret = 0;\n\t\tbreak;\n\t}\n\tmask |= PCM_MODE_MASK;\n\tif (ret)\n\t\treturn ret;\n\tsnd_soc_component_update_bits(component, PM860X_PCM_IFACE_2, mask, inf);\n\treturn 0;\n}\n\nstatic int pm860x_set_dai_sysclk(struct snd_soc_dai *codec_dai,\n\t\t\t\t int clk_id, unsigned int freq, int dir)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\n\tif (dir == PM860X_CLK_DIR_OUT)\n\t\tpm860x->dir = PM860X_CLK_DIR_OUT;\n\telse\t \n\t\treturn -EINVAL;\n\n\treturn 0;\n}\n\nstatic int pm860x_i2s_hw_params(struct snd_pcm_substream *substream,\n\t\t\t\tstruct snd_pcm_hw_params *params,\n\t\t\t\tstruct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tunsigned char inf;\n\n\t \n\tswitch (params_width(params)) {\n\tcase 16:\n\t\tinf = 0;\n\t\tbreak;\n\tcase 18:\n\t\tinf = PCM_INF2_18WL;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, PM860X_I2S_IFACE_2, PCM_INF2_18WL, inf);\n\n\t \n\tswitch (params_rate(params)) {\n\tcase 8000:\n\t\tinf = 0;\n\t\tbreak;\n\tcase 11025:\n\t\tinf = 1;\n\t\tbreak;\n\tcase 16000:\n\t\tinf = 3;\n\t\tbreak;\n\tcase 22050:\n\t\tinf = 4;\n\t\tbreak;\n\tcase 32000:\n\t\tinf = 6;\n\t\tbreak;\n\tcase 44100:\n\t\tinf = 7;\n\t\tbreak;\n\tcase 48000:\n\t\tinf = 8;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, PM860X_I2S_IFACE_4, 0xf, inf);\n\n\treturn 0;\n}\n\nstatic int pm860x_i2s_set_dai_fmt(struct snd_soc_dai *codec_dai,\n\t\t\t\t  unsigned int fmt)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tunsigned char inf = 0, mask = 0;\n\n\tmask |= PCM_INF2_BCLK | PCM_INF2_FS | PCM_INF2_MASTER;\n\n\t \n\tswitch (fmt & SND_SOC_DAIFMT_CLOCK_PROVIDER_MASK) {\n\tcase SND_SOC_DAIFMT_CBP_CFP:\n\t\tif (pm860x->dir == PM860X_CLK_DIR_OUT)\n\t\t\tinf |= PCM_INF2_MASTER;\n\t\telse\n\t\t\treturn -EINVAL;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBC_CFC:\n\t\tif (pm860x->dir == PM860X_CLK_DIR_IN)\n\t\t\tinf &= ~PCM_INF2_MASTER;\n\t\telse\n\t\t\treturn -EINVAL;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:\n\t\tinf |= PCM_EXACT_I2S;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\tmask |= PCM_MODE_MASK;\n\tsnd_soc_component_update_bits(component, PM860X_I2S_IFACE_2, mask, inf);\n\treturn 0;\n}\n\nstatic int pm860x_set_bias_level(struct snd_soc_component *component,\n\t\t\t\t enum snd_soc_bias_level level)\n{\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tint data;\n\n\tswitch (level) {\n\tcase SND_SOC_BIAS_ON:\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_PREPARE:\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tif (snd_soc_component_get_bias_level(component) == SND_SOC_BIAS_OFF) {\n\t\t\t \n\t\t\tdata = AUDIO_PLL | AUDIO_SECTION_ON;\n\t\t\tpm860x_reg_write(pm860x->i2c, REG_MISC2, data);\n\t\t\tudelay(300);\n\t\t\tdata = AUDIO_PLL | AUDIO_SECTION_RESET\n\t\t\t\t| AUDIO_SECTION_ON;\n\t\t\tpm860x_reg_write(pm860x->i2c, REG_MISC2, data);\n\t\t}\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_OFF:\n\t\tdata = AUDIO_PLL | AUDIO_SECTION_RESET | AUDIO_SECTION_ON;\n\t\tpm860x_set_bits(pm860x->i2c, REG_MISC2, data, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops pm860x_pcm_dai_ops = {\n\t.mute_stream\t= pm860x_mute_stream,\n\t.hw_params\t= pm860x_pcm_hw_params,\n\t.set_fmt\t= pm860x_pcm_set_dai_fmt,\n\t.set_sysclk\t= pm860x_set_dai_sysclk,\n\t.no_capture_mute = 1,\n};\n\nstatic const struct snd_soc_dai_ops pm860x_i2s_dai_ops = {\n\t.mute_stream\t= pm860x_mute_stream,\n\t.hw_params\t= pm860x_i2s_hw_params,\n\t.set_fmt\t= pm860x_i2s_set_dai_fmt,\n\t.set_sysclk\t= pm860x_set_dai_sysclk,\n\t.no_capture_mute = 1,\n};\n\n#define PM860X_RATES\t(SNDRV_PCM_RATE_8000 | SNDRV_PCM_RATE_16000 |\t\\\n\t\t\t SNDRV_PCM_RATE_32000 | SNDRV_PCM_RATE_48000)\n\nstatic struct snd_soc_dai_driver pm860x_dai[] = {\n\t{\n\t\t \n\t\t.name\t= \"88pm860x-pcm\",\n\t\t.id\t= 1,\n\t\t.playback = {\n\t\t\t.stream_name\t= \"PCM Playback\",\n\t\t\t.channels_min\t= 2,\n\t\t\t.channels_max\t= 2,\n\t\t\t.rates\t\t= PM860X_RATES,\n\t\t\t.formats\t= SNDRV_PCM_FMTBIT_S16_LE | \\\n\t\t\t\t\t  SNDRV_PCM_FMTBIT_S18_3LE,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name\t= \"PCM Capture\",\n\t\t\t.channels_min\t= 2,\n\t\t\t.channels_max\t= 2,\n\t\t\t.rates\t\t= PM860X_RATES,\n\t\t\t.formats\t= SNDRV_PCM_FMTBIT_S16_LE | \\\n\t\t\t\t\t  SNDRV_PCM_FMTBIT_S18_3LE,\n\t\t},\n\t\t.ops\t= &pm860x_pcm_dai_ops,\n\t}, {\n\t\t \n\t\t.name\t= \"88pm860x-i2s\",\n\t\t.id\t= 2,\n\t\t.playback = {\n\t\t\t.stream_name\t= \"I2S Playback\",\n\t\t\t.channels_min\t= 2,\n\t\t\t.channels_max\t= 2,\n\t\t\t.rates\t\t= SNDRV_PCM_RATE_8000_48000,\n\t\t\t.formats\t= SNDRV_PCM_FMTBIT_S16_LE | \\\n\t\t\t\t\t  SNDRV_PCM_FMTBIT_S18_3LE,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name\t= \"I2S Capture\",\n\t\t\t.channels_min\t= 2,\n\t\t\t.channels_max\t= 2,\n\t\t\t.rates\t\t= SNDRV_PCM_RATE_8000_48000,\n\t\t\t.formats\t= SNDRV_PCM_FMTBIT_S16_LE | \\\n\t\t\t\t\t  SNDRV_PCM_FMTBIT_S18_3LE,\n\t\t},\n\t\t.ops\t= &pm860x_i2s_dai_ops,\n\t},\n};\n\nstatic irqreturn_t pm860x_component_handler(int irq, void *data)\n{\n\tstruct pm860x_priv *pm860x = data;\n\tint status, shrt, report = 0, mic_report = 0;\n\tint mask;\n\n\tstatus = pm860x_reg_read(pm860x->i2c, REG_STATUS_1);\n\tshrt = pm860x_reg_read(pm860x->i2c, REG_SHORTS);\n\tmask = pm860x->det.hs_shrt | pm860x->det.hook_det | pm860x->det.lo_shrt\n\t\t| pm860x->det.hp_det;\n\n#ifndef CONFIG_SND_SOC_88PM860X_MODULE\n\tif (status & (HEADSET_STATUS | MIC_STATUS | SHORT_HS1 | SHORT_HS2 |\n\t\t      SHORT_LO1 | SHORT_LO2))\n\t\ttrace_snd_soc_jack_irq(dev_name(pm860x->component->dev));\n#endif\n\n\tif ((pm860x->det.hp_det & SND_JACK_HEADPHONE)\n\t\t&& (status & HEADSET_STATUS))\n\t\treport |= SND_JACK_HEADPHONE;\n\n\tif ((pm860x->det.mic_det & SND_JACK_MICROPHONE)\n\t\t&& (status & MIC_STATUS))\n\t\tmic_report |= SND_JACK_MICROPHONE;\n\n\tif (pm860x->det.hs_shrt && (shrt & (SHORT_HS1 | SHORT_HS2)))\n\t\treport |= pm860x->det.hs_shrt;\n\n\tif (pm860x->det.hook_det && (status & HOOK_STATUS))\n\t\treport |= pm860x->det.hook_det;\n\n\tif (pm860x->det.lo_shrt && (shrt & (SHORT_LO1 | SHORT_LO2)))\n\t\treport |= pm860x->det.lo_shrt;\n\n\tif (report)\n\t\tsnd_soc_jack_report(pm860x->det.hp_jack, report, mask);\n\tif (mic_report)\n\t\tsnd_soc_jack_report(pm860x->det.mic_jack, SND_JACK_MICROPHONE,\n\t\t\t\t    SND_JACK_MICROPHONE);\n\n\tdev_dbg(pm860x->component->dev, \"headphone report:0x%x, mask:%x\\n\",\n\t\treport, mask);\n\tdev_dbg(pm860x->component->dev, \"microphone report:0x%x\\n\", mic_report);\n\treturn IRQ_HANDLED;\n}\n\nint pm860x_hs_jack_detect(struct snd_soc_component *component,\n\t\t\t  struct snd_soc_jack *jack,\n\t\t\t  int det, int hook, int hs_shrt, int lo_shrt)\n{\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tint data;\n\n\tpm860x->det.hp_jack = jack;\n\tpm860x->det.hp_det = det;\n\tpm860x->det.hook_det = hook;\n\tpm860x->det.hs_shrt = hs_shrt;\n\tpm860x->det.lo_shrt = lo_shrt;\n\n\tif (det & SND_JACK_HEADPHONE)\n\t\tpm860x_set_bits(pm860x->i2c, REG_HS_DET,\n\t\t\t\tEN_HS_DET, EN_HS_DET);\n\t \n\tif (hs_shrt) {\n\t\tdata = CLR_SHORT_HS2 | CLR_SHORT_HS1;\n\t\tpm860x_set_bits(pm860x->i2c, REG_SHORTS, data, data);\n\t}\n\t \n\tif (lo_shrt) {\n\t\tdata = CLR_SHORT_LO2 | CLR_SHORT_LO1;\n\t\tpm860x_set_bits(pm860x->i2c, REG_SHORTS, data, data);\n\t}\n\n\t \n\tpm860x_component_handler(0, pm860x);\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(pm860x_hs_jack_detect);\n\nint pm860x_mic_jack_detect(struct snd_soc_component *component,\n\t\t\t   struct snd_soc_jack *jack, int det)\n{\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\n\tpm860x->det.mic_jack = jack;\n\tpm860x->det.mic_det = det;\n\n\tif (det & SND_JACK_MICROPHONE)\n\t\tpm860x_set_bits(pm860x->i2c, REG_MIC_DET,\n\t\t\t\tMICDET_MASK, MICDET_MASK);\n\n\t \n\tpm860x_component_handler(0, pm860x);\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(pm860x_mic_jack_detect);\n\nstatic int pm860x_probe(struct snd_soc_component *component)\n{\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tint i, ret;\n\n\tpm860x->component = component;\n\tsnd_soc_component_init_regmap(component,  pm860x->regmap);\n\n\tfor (i = 0; i < 4; i++) {\n\t\tret = request_threaded_irq(pm860x->irq[i], NULL,\n\t\t\t\t\t   pm860x_component_handler, IRQF_ONESHOT,\n\t\t\t\t\t   pm860x->name[i], pm860x);\n\t\tif (ret < 0) {\n\t\t\tdev_err(component->dev, \"Failed to request IRQ!\\n\");\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\treturn 0;\n\nout:\n\twhile (--i >= 0)\n\t\tfree_irq(pm860x->irq[i], pm860x);\n\treturn ret;\n}\n\nstatic void pm860x_remove(struct snd_soc_component *component)\n{\n\tstruct pm860x_priv *pm860x = snd_soc_component_get_drvdata(component);\n\tint i;\n\n\tfor (i = 3; i >= 0; i--)\n\t\tfree_irq(pm860x->irq[i], pm860x);\n}\n\nstatic const struct snd_soc_component_driver soc_component_dev_pm860x = {\n\t.probe\t\t\t= pm860x_probe,\n\t.remove\t\t\t= pm860x_remove,\n\t.set_bias_level\t\t= pm860x_set_bias_level,\n\t.controls\t\t= pm860x_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(pm860x_snd_controls),\n\t.dapm_widgets\t\t= pm860x_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(pm860x_dapm_widgets),\n\t.dapm_routes\t\t= pm860x_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(pm860x_dapm_routes),\n\t.idle_bias_on\t\t= 1,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic int pm860x_codec_probe(struct platform_device *pdev)\n{\n\tstruct pm860x_chip *chip = dev_get_drvdata(pdev->dev.parent);\n\tstruct pm860x_priv *pm860x;\n\tstruct resource *res;\n\tint i, ret;\n\n\tpm860x = devm_kzalloc(&pdev->dev, sizeof(struct pm860x_priv),\n\t\t\t      GFP_KERNEL);\n\tif (pm860x == NULL)\n\t\treturn -ENOMEM;\n\n\tpm860x->chip = chip;\n\tpm860x->i2c = (chip->id == CHIP_PM8607) ? chip->client\n\t\t\t: chip->companion;\n\tpm860x->regmap = (chip->id == CHIP_PM8607) ? chip->regmap\n\t\t\t: chip->regmap_companion;\n\tplatform_set_drvdata(pdev, pm860x);\n\n\tfor (i = 0; i < 4; i++) {\n\t\tres = platform_get_resource(pdev, IORESOURCE_IRQ, i);\n\t\tif (!res) {\n\t\t\tdev_err(&pdev->dev, \"Failed to get IRQ resources\\n\");\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tpm860x->irq[i] = res->start + chip->irq_base;\n\t\tstrscpy(pm860x->name[i], res->name, MAX_NAME_LEN);\n\t}\n\n\tret = devm_snd_soc_register_component(&pdev->dev,\n\t\t\t\t     &soc_component_dev_pm860x,\n\t\t\t\t     pm860x_dai, ARRAY_SIZE(pm860x_dai));\n\tif (ret) {\n\t\tdev_err(&pdev->dev, \"Failed to register component\\n\");\n\t\treturn -EINVAL;\n\t}\n\treturn ret;\n}\n\nstatic struct platform_driver pm860x_codec_driver = {\n\t.driver\t= {\n\t\t.name\t= \"88pm860x-codec\",\n\t},\n\t.probe\t= pm860x_codec_probe,\n};\n\nmodule_platform_driver(pm860x_codec_driver);\n\nMODULE_DESCRIPTION(\"ASoC 88PM860x driver\");\nMODULE_AUTHOR(\"Haojian Zhuang <haojian.zhuang@marvell.com>\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"platform:88pm860x-codec\");\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}