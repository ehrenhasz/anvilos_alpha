{
  "module_name": "wm8991.c",
  "hash_id": "6a7250dcc916d6319d3355c8e4af6eec1f15096c06b45b907ca94eedbe7fdd19",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/wm8991.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/i2c.h>\n#include <linux/regmap.h>\n#include <linux/slab.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/soc-dapm.h>\n#include <sound/initval.h>\n#include <sound/tlv.h>\n#include <asm/div64.h>\n\n#include \"wm8991.h\"\n\nstruct wm8991_priv {\n\tstruct regmap *regmap;\n\tunsigned int pcmclk;\n};\n\nstatic const struct reg_default wm8991_reg_defaults[] = {\n\t{  1, 0x0000 },      \n\t{  2, 0x6000 },      \n\t{  3, 0x0000 },      \n\t{  4, 0x4050 },      \n\t{  5, 0x4000 },      \n\t{  6, 0x01C8 },      \n\t{  7, 0x0000 },      \n\t{  8, 0x0040 },      \n\t{  9, 0x0040 },      \n\t{ 10, 0x0004 },      \n\t{ 11, 0x00C0 },      \n\t{ 12, 0x00C0 },      \n\t{ 13, 0x0000 },      \n\t{ 14, 0x0100 },      \n\t{ 15, 0x00C0 },      \n\t{ 16, 0x00C0 },      \n\n\t{ 18, 0x0000 },      \n\t{ 19, 0x1000 },      \n\t{ 20, 0x1010 },      \n\t{ 21, 0x1010 },      \n\t{ 22, 0x8000 },      \n\t{ 23, 0x0800 },      \n\t{ 24, 0x008B },      \n\t{ 25, 0x008B },      \n\t{ 26, 0x008B },      \n\t{ 27, 0x008B },      \n\t{ 28, 0x0000 },      \n\t{ 29, 0x0000 },      \n\t{ 30, 0x0066 },      \n\t{ 31, 0x0022 },      \n\t{ 32, 0x0079 },      \n\t{ 33, 0x0079 },      \n\t{ 34, 0x0003 },      \n\t{ 35, 0x0003 },      \n\n\t{ 37, 0x0100 },      \n\n\t{ 39, 0x0000 },      \n\t{ 40, 0x0000 },      \n\t{ 41, 0x0000 },      \n\t{ 42, 0x0000 },      \n\t{ 43, 0x0000 },      \n\t{ 44, 0x0000 },      \n\t{ 45, 0x0000 },      \n\t{ 46, 0x0000 },      \n\t{ 47, 0x0000 },      \n\t{ 48, 0x0000 },      \n\t{ 49, 0x0000 },      \n\t{ 50, 0x0000 },      \n\t{ 51, 0x0180 },      \n\t{ 52, 0x0000 },      \n\t{ 53, 0x0000 },      \n\t{ 54, 0x0000 },      \n\t{ 55, 0x0000 },      \n\t{ 56, 0x0000 },      \n\t{ 57, 0x0000 },      \n\t{ 58, 0x0000 },      \n\n\t{ 60, 0x0008 },      \n\t{ 61, 0x0031 },      \n\t{ 62, 0x0026 },      \n};\n\nstatic bool wm8991_volatile(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase WM8991_RESET:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_SCALE(in_pga_tlv, -1650, 150, 0);\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_SCALE(out_mix_tlv, -2100, 300, 0);\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_RANGE(out_pga_tlv,\n\t0x00, 0x2f, SNDRV_CTL_TLVD_DB_SCALE_ITEM(SNDRV_CTL_TLVD_DB_GAIN_MUTE, 0, 1),\n\t0x30, 0x7f, SNDRV_CTL_TLVD_DB_SCALE_ITEM(-7300, 100, 0),\n);\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_RANGE(out_dac_tlv,\n\t0x00, 0xbf, SNDRV_CTL_TLVD_DB_SCALE_ITEM(-71625, 375, 1),\n\t0xc0, 0xff, SNDRV_CTL_TLVD_DB_SCALE_ITEM(0, 0, 0),\n);\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_RANGE(in_adc_tlv,\n\t0x00, 0xef, SNDRV_CTL_TLVD_DB_SCALE_ITEM(-71625, 375, 1),\n\t0xf0, 0xff, SNDRV_CTL_TLVD_DB_SCALE_ITEM(17625, 0, 0),\n);\nstatic const SNDRV_CTL_TLVD_DECLARE_DB_RANGE(out_sidetone_tlv,\n\t0x00, 0x0c, SNDRV_CTL_TLVD_DB_SCALE_ITEM(-3600, 300, 0),\n\t0x0d, 0x0f, SNDRV_CTL_TLVD_DB_SCALE_ITEM(0, 0, 0),\n);\n\nstatic int wm899x_outpga_put_volsw_vu(struct snd_kcontrol *kcontrol,\n\t\t\t\t      struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tint reg = kcontrol->private_value & 0xff;\n\tint ret;\n\tu16 val;\n\n\tret = snd_soc_put_volsw(kcontrol, ucontrol);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tval = snd_soc_component_read(component, reg);\n\treturn snd_soc_component_write(component, reg, val | 0x0100);\n}\n\nstatic const char *wm8991_digital_sidetone[] =\n{\"None\", \"Left ADC\", \"Right ADC\", \"Reserved\"};\n\nstatic SOC_ENUM_SINGLE_DECL(wm8991_left_digital_sidetone_enum,\n\t\t\t    WM8991_DIGITAL_SIDE_TONE,\n\t\t\t    WM8991_ADC_TO_DACL_SHIFT,\n\t\t\t    wm8991_digital_sidetone);\n\nstatic SOC_ENUM_SINGLE_DECL(wm8991_right_digital_sidetone_enum,\n\t\t\t    WM8991_DIGITAL_SIDE_TONE,\n\t\t\t    WM8991_ADC_TO_DACR_SHIFT,\n\t\t\t    wm8991_digital_sidetone);\n\nstatic const char *wm8991_adcmode[] =\n{\"Hi-fi mode\", \"Voice mode 1\", \"Voice mode 2\", \"Voice mode 3\"};\n\nstatic SOC_ENUM_SINGLE_DECL(wm8991_right_adcmode_enum,\n\t\t\t    WM8991_ADC_CTRL,\n\t\t\t    WM8991_ADC_HPF_CUT_SHIFT,\n\t\t\t    wm8991_adcmode);\n\nstatic const struct snd_kcontrol_new wm8991_snd_controls[] = {\n\t \n\tSOC_SINGLE(\"LIN12 PGA Boost\", WM8991_INPUT_MIXER3, WM8991_L12MNBST_BIT, 1, 0),\n\tSOC_SINGLE(\"LIN34 PGA Boost\", WM8991_INPUT_MIXER3, WM8991_L34MNBST_BIT, 1, 0),\n\t \n\tSOC_SINGLE(\"RIN12 PGA Boost\", WM8991_INPUT_MIXER3, WM8991_R12MNBST_BIT, 1, 0),\n\tSOC_SINGLE(\"RIN34 PGA Boost\", WM8991_INPUT_MIXER3, WM8991_R34MNBST_BIT, 1, 0),\n\n\t \n\tSOC_SINGLE_TLV(\"LOMIX LIN3 Bypass Volume\", WM8991_OUTPUT_MIXER3,\n\t\tWM8991_LLI3LOVOL_SHIFT, WM8991_LLI3LOVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"LOMIX RIN12 PGA Bypass Volume\", WM8991_OUTPUT_MIXER3,\n\t\tWM8991_LR12LOVOL_SHIFT, WM8991_LR12LOVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"LOMIX LIN12 PGA Bypass Volume\", WM8991_OUTPUT_MIXER3,\n\t\tWM8991_LL12LOVOL_SHIFT, WM8991_LL12LOVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"LOMIX RIN3 Bypass Volume\", WM8991_OUTPUT_MIXER5,\n\t\tWM8991_LRI3LOVOL_SHIFT, WM8991_LRI3LOVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"LOMIX AINRMUX Bypass Volume\", WM8991_OUTPUT_MIXER5,\n\t\tWM8991_LRBLOVOL_SHIFT, WM8991_LRBLOVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"LOMIX AINLMUX Bypass Volume\", WM8991_OUTPUT_MIXER5,\n\t\tWM8991_LRBLOVOL_SHIFT, WM8991_LRBLOVOL_MASK, 1, out_mix_tlv),\n\n\t \n\tSOC_SINGLE_TLV(\"ROMIX RIN3 Bypass Volume\", WM8991_OUTPUT_MIXER4,\n\t\tWM8991_RRI3ROVOL_SHIFT, WM8991_RRI3ROVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"ROMIX LIN12 PGA Bypass Volume\", WM8991_OUTPUT_MIXER4,\n\t\tWM8991_RL12ROVOL_SHIFT, WM8991_RL12ROVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"ROMIX RIN12 PGA Bypass Volume\", WM8991_OUTPUT_MIXER4,\n\t\tWM8991_RR12ROVOL_SHIFT, WM8991_RR12ROVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"ROMIX LIN3 Bypass Volume\", WM8991_OUTPUT_MIXER6,\n\t\tWM8991_RLI3ROVOL_SHIFT, WM8991_RLI3ROVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"ROMIX AINLMUX Bypass Volume\", WM8991_OUTPUT_MIXER6,\n\t\tWM8991_RLBROVOL_SHIFT, WM8991_RLBROVOL_MASK, 1, out_mix_tlv),\n\tSOC_SINGLE_TLV(\"ROMIX AINRMUX Bypass Volume\", WM8991_OUTPUT_MIXER6,\n\t\tWM8991_RRBROVOL_SHIFT, WM8991_RRBROVOL_MASK, 1, out_mix_tlv),\n\n\t \n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"LOUT Volume\", WM8991_LEFT_OUTPUT_VOLUME,\n\t\tWM8991_LOUTVOL_SHIFT, WM8991_LOUTVOL_MASK, 0, out_pga_tlv),\n\tSOC_SINGLE(\"LOUT ZC\", WM8991_LEFT_OUTPUT_VOLUME, WM8991_LOZC_BIT, 1, 0),\n\n\t \n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"ROUT Volume\", WM8991_RIGHT_OUTPUT_VOLUME,\n\t\tWM8991_ROUTVOL_SHIFT, WM8991_ROUTVOL_MASK, 0, out_pga_tlv),\n\tSOC_SINGLE(\"ROUT ZC\", WM8991_RIGHT_OUTPUT_VOLUME, WM8991_ROZC_BIT, 1, 0),\n\n\t \n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"LOPGA Volume\", WM8991_LEFT_OPGA_VOLUME,\n\t\tWM8991_LOPGAVOL_SHIFT, WM8991_LOPGAVOL_MASK, 0, out_pga_tlv),\n\tSOC_SINGLE(\"LOPGA ZC Switch\", WM8991_LEFT_OPGA_VOLUME,\n\t\tWM8991_LOPGAZC_BIT, 1, 0),\n\n\t \n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"ROPGA Volume\", WM8991_RIGHT_OPGA_VOLUME,\n\t\tWM8991_ROPGAVOL_SHIFT, WM8991_ROPGAVOL_MASK, 0, out_pga_tlv),\n\tSOC_SINGLE(\"ROPGA ZC Switch\", WM8991_RIGHT_OPGA_VOLUME,\n\t\tWM8991_ROPGAZC_BIT, 1, 0),\n\n\tSOC_SINGLE(\"LON Mute Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_LONMUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"LOP Mute Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_LOPMUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"LOP Attenuation Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_LOATTN_BIT, 1, 0),\n\tSOC_SINGLE(\"RON Mute Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_RONMUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"ROP Mute Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_ROPMUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"ROP Attenuation Switch\", WM8991_LINE_OUTPUTS_VOLUME,\n\t\tWM8991_ROATTN_BIT, 1, 0),\n\n\tSOC_SINGLE(\"OUT3 Mute Switch\", WM8991_OUT3_4_VOLUME,\n\t\tWM8991_OUT3MUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"OUT3 Attenuation Switch\", WM8991_OUT3_4_VOLUME,\n\t\tWM8991_OUT3ATTN_BIT, 1, 0),\n\n\tSOC_SINGLE(\"OUT4 Mute Switch\", WM8991_OUT3_4_VOLUME,\n\t\tWM8991_OUT4MUTE_BIT, 1, 0),\n\tSOC_SINGLE(\"OUT4 Attenuation Switch\", WM8991_OUT3_4_VOLUME,\n\t\tWM8991_OUT4ATTN_BIT, 1, 0),\n\n\tSOC_SINGLE(\"Speaker Mode Switch\", WM8991_CLASSD1,\n\t\tWM8991_CDMODE_BIT, 1, 0),\n\n\tSOC_SINGLE(\"Speaker Output Attenuation Volume\", WM8991_SPEAKER_VOLUME,\n\t\tWM8991_SPKVOL_SHIFT, WM8991_SPKVOL_MASK, 0),\n\tSOC_SINGLE(\"Speaker DC Boost Volume\", WM8991_CLASSD3,\n\t\tWM8991_DCGAIN_SHIFT, WM8991_DCGAIN_MASK, 0),\n\tSOC_SINGLE(\"Speaker AC Boost Volume\", WM8991_CLASSD3,\n\t\tWM8991_ACGAIN_SHIFT, WM8991_ACGAIN_MASK, 0),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"Left DAC Digital Volume\",\n\t\tWM8991_LEFT_DAC_DIGITAL_VOLUME,\n\t\tWM8991_DACL_VOL_SHIFT,\n\t\tWM8991_DACL_VOL_MASK,\n\t\t0,\n\t\tout_dac_tlv),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"Right DAC Digital Volume\",\n\t\tWM8991_RIGHT_DAC_DIGITAL_VOLUME,\n\t\tWM8991_DACR_VOL_SHIFT,\n\t\tWM8991_DACR_VOL_MASK,\n\t\t0,\n\t\tout_dac_tlv),\n\n\tSOC_ENUM(\"Left Digital Sidetone\", wm8991_left_digital_sidetone_enum),\n\tSOC_ENUM(\"Right Digital Sidetone\", wm8991_right_digital_sidetone_enum),\n\n\tSOC_SINGLE_TLV(\"Left Digital Sidetone Volume\", WM8991_DIGITAL_SIDE_TONE,\n\t\tWM8991_ADCL_DAC_SVOL_SHIFT, WM8991_ADCL_DAC_SVOL_MASK, 0,\n\t\tout_sidetone_tlv),\n\tSOC_SINGLE_TLV(\"Right Digital Sidetone Volume\", WM8991_DIGITAL_SIDE_TONE,\n\t\tWM8991_ADCR_DAC_SVOL_SHIFT, WM8991_ADCR_DAC_SVOL_MASK, 0,\n\t\tout_sidetone_tlv),\n\n\tSOC_SINGLE(\"ADC Digital High Pass Filter Switch\", WM8991_ADC_CTRL,\n\t\tWM8991_ADC_HPF_ENA_BIT, 1, 0),\n\n\tSOC_ENUM(\"ADC HPF Mode\", wm8991_right_adcmode_enum),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"Left ADC Digital Volume\",\n\t\tWM8991_LEFT_ADC_DIGITAL_VOLUME,\n\t\tWM8991_ADCL_VOL_SHIFT,\n\t\tWM8991_ADCL_VOL_MASK,\n\t\t0,\n\t\tin_adc_tlv),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"Right ADC Digital Volume\",\n\t\tWM8991_RIGHT_ADC_DIGITAL_VOLUME,\n\t\tWM8991_ADCR_VOL_SHIFT,\n\t\tWM8991_ADCR_VOL_MASK,\n\t\t0,\n\t\tin_adc_tlv),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"LIN12 Volume\",\n\t\tWM8991_LEFT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_LIN12VOL_SHIFT,\n\t\tWM8991_LIN12VOL_MASK,\n\t\t0,\n\t\tin_pga_tlv),\n\n\tSOC_SINGLE(\"LIN12 ZC Switch\", WM8991_LEFT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_LI12ZC_BIT, 1, 0),\n\n\tSOC_SINGLE(\"LIN12 Mute Switch\", WM8991_LEFT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_LI12MUTE_BIT, 1, 0),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"LIN34 Volume\",\n\t\tWM8991_LEFT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_LIN34VOL_SHIFT,\n\t\tWM8991_LIN34VOL_MASK,\n\t\t0,\n\t\tin_pga_tlv),\n\n\tSOC_SINGLE(\"LIN34 ZC Switch\", WM8991_LEFT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_LI34ZC_BIT, 1, 0),\n\n\tSOC_SINGLE(\"LIN34 Mute Switch\", WM8991_LEFT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_LI34MUTE_BIT, 1, 0),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"RIN12 Volume\",\n\t\tWM8991_RIGHT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_RIN12VOL_SHIFT,\n\t\tWM8991_RIN12VOL_MASK,\n\t\t0,\n\t\tin_pga_tlv),\n\n\tSOC_SINGLE(\"RIN12 ZC Switch\", WM8991_RIGHT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_RI12ZC_BIT, 1, 0),\n\n\tSOC_SINGLE(\"RIN12 Mute Switch\", WM8991_RIGHT_LINE_INPUT_1_2_VOLUME,\n\t\tWM8991_RI12MUTE_BIT, 1, 0),\n\n\tSOC_WM899X_OUTPGA_SINGLE_R_TLV(\"RIN34 Volume\",\n\t\tWM8991_RIGHT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_RIN34VOL_SHIFT,\n\t\tWM8991_RIN34VOL_MASK,\n\t\t0,\n\t\tin_pga_tlv),\n\n\tSOC_SINGLE(\"RIN34 ZC Switch\", WM8991_RIGHT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_RI34ZC_BIT, 1, 0),\n\n\tSOC_SINGLE(\"RIN34 Mute Switch\", WM8991_RIGHT_LINE_INPUT_3_4_VOLUME,\n\t\tWM8991_RI34MUTE_BIT, 1, 0),\n};\n\n \nstatic int outmixer_event(struct snd_soc_dapm_widget *w,\n\t\t\t  struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tu32 reg_shift = kcontrol->private_value & 0xfff;\n\tint ret = 0;\n\tu16 reg;\n\n\tswitch (reg_shift) {\n\tcase WM8991_SPEAKER_MIXER | (WM8991_LDSPK_BIT << 8):\n\t\treg = snd_soc_component_read(component, WM8991_OUTPUT_MIXER1);\n\t\tif (reg & WM8991_LDLO) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Cannot set as Output Mixer 1 LDLO Set\\n\");\n\t\t\tret = -1;\n\t\t}\n\t\tbreak;\n\n\tcase WM8991_SPEAKER_MIXER | (WM8991_RDSPK_BIT << 8):\n\t\treg = snd_soc_component_read(component, WM8991_OUTPUT_MIXER2);\n\t\tif (reg & WM8991_RDRO) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Cannot set as Output Mixer 2 RDRO Set\\n\");\n\t\t\tret = -1;\n\t\t}\n\t\tbreak;\n\n\tcase WM8991_OUTPUT_MIXER1 | (WM8991_LDLO_BIT << 8):\n\t\treg = snd_soc_component_read(component, WM8991_SPEAKER_MIXER);\n\t\tif (reg & WM8991_LDSPK) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Cannot set as Speaker Mixer LDSPK Set\\n\");\n\t\t\tret = -1;\n\t\t}\n\t\tbreak;\n\n\tcase WM8991_OUTPUT_MIXER2 | (WM8991_RDRO_BIT << 8):\n\t\treg = snd_soc_component_read(component, WM8991_SPEAKER_MIXER);\n\t\tif (reg & WM8991_RDSPK) {\n\t\t\tprintk(KERN_WARNING\n\t\t\t       \"Cannot set as Speaker Mixer RDSPK Set\\n\");\n\t\t\tret = -1;\n\t\t}\n\t\tbreak;\n\t}\n\n\treturn ret;\n}\n\n \nstatic const SNDRV_CTL_TLVD_DECLARE_DB_SCALE(in_mix_tlv, -1200, 300, 1);\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_lin12_pga_controls[] = {\n\tSOC_DAPM_SINGLE(\"LIN1 Switch\", WM8991_INPUT_MIXER2, WM8991_LMN1_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LIN2 Switch\", WM8991_INPUT_MIXER2, WM8991_LMP2_BIT, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new wm8991_dapm_lin34_pga_controls[] = {\n\tSOC_DAPM_SINGLE(\"LIN3 Switch\", WM8991_INPUT_MIXER2, WM8991_LMN3_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LIN4 Switch\", WM8991_INPUT_MIXER2, WM8991_LMP4_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_rin12_pga_controls[] = {\n\tSOC_DAPM_SINGLE(\"RIN1 Switch\", WM8991_INPUT_MIXER2, WM8991_RMN1_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"RIN2 Switch\", WM8991_INPUT_MIXER2, WM8991_RMP2_BIT, 1, 0),\n};\n\nstatic const struct snd_kcontrol_new wm8991_dapm_rin34_pga_controls[] = {\n\tSOC_DAPM_SINGLE(\"RIN3 Switch\", WM8991_INPUT_MIXER2, WM8991_RMN3_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"RIN4 Switch\", WM8991_INPUT_MIXER2, WM8991_RMP4_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_inmixl_controls[] = {\n\tSOC_DAPM_SINGLE_TLV(\"Record Left Volume\", WM8991_INPUT_MIXER3,\n\t\tWM8991_LDBVOL_SHIFT, WM8991_LDBVOL_MASK, 0, in_mix_tlv),\n\tSOC_DAPM_SINGLE_TLV(\"LIN2 Volume\", WM8991_INPUT_MIXER5, WM8991_LI2BVOL_SHIFT,\n\t\t7, 0, in_mix_tlv),\n\tSOC_DAPM_SINGLE(\"LINPGA12 Switch\", WM8991_INPUT_MIXER3, WM8991_L12MNB_BIT,\n\t\t1, 0),\n\tSOC_DAPM_SINGLE(\"LINPGA34 Switch\", WM8991_INPUT_MIXER3, WM8991_L34MNB_BIT,\n\t\t1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_inmixr_controls[] = {\n\tSOC_DAPM_SINGLE_TLV(\"Record Right Volume\", WM8991_INPUT_MIXER4,\n\t\tWM8991_RDBVOL_SHIFT, WM8991_RDBVOL_MASK, 0, in_mix_tlv),\n\tSOC_DAPM_SINGLE_TLV(\"RIN2 Volume\", WM8991_INPUT_MIXER6, WM8991_RI2BVOL_SHIFT,\n\t\t7, 0, in_mix_tlv),\n\tSOC_DAPM_SINGLE(\"RINPGA12 Switch\", WM8991_INPUT_MIXER3, WM8991_L12MNB_BIT,\n\t\t1, 0),\n\tSOC_DAPM_SINGLE(\"RINPGA34 Switch\", WM8991_INPUT_MIXER3, WM8991_L34MNB_BIT,\n\t\t1, 0),\n};\n\n \nstatic const char *wm8991_ainlmux[] =\n{\"INMIXL Mix\", \"RXVOICE Mix\", \"DIFFINL Mix\"};\n\nstatic SOC_ENUM_SINGLE_DECL(wm8991_ainlmux_enum,\n\t\t\t    WM8991_INPUT_MIXER1, WM8991_AINLMODE_SHIFT,\n\t\t\t    wm8991_ainlmux);\n\nstatic const struct snd_kcontrol_new wm8991_dapm_ainlmux_controls =\n\tSOC_DAPM_ENUM(\"Route\", wm8991_ainlmux_enum);\n\n \n\n \nstatic const char *wm8991_ainrmux[] =\n{\"INMIXR Mix\", \"RXVOICE Mix\", \"DIFFINR Mix\"};\n\nstatic SOC_ENUM_SINGLE_DECL(wm8991_ainrmux_enum,\n\t\t\t    WM8991_INPUT_MIXER1, WM8991_AINRMODE_SHIFT,\n\t\t\t    wm8991_ainrmux);\n\nstatic const struct snd_kcontrol_new wm8991_dapm_ainrmux_controls =\n\tSOC_DAPM_ENUM(\"Route\", wm8991_ainrmux_enum);\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_lomix_controls[] = {\n\tSOC_DAPM_SINGLE(\"LOMIX Right ADC Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LRBLO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX Left ADC Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LLBLO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX RIN3 Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LRI3LO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX LIN3 Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LLI3LO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX RIN12 PGA Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LR12LO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX LIN12 PGA Bypass Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LL12LO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOMIX Left DAC Switch\", WM8991_OUTPUT_MIXER1,\n\t\tWM8991_LDLO_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_romix_controls[] = {\n\tSOC_DAPM_SINGLE(\"ROMIX Left ADC Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RLBRO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX Right ADC Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RRBRO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX LIN3 Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RLI3RO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX RIN3 Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RRI3RO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX LIN12 PGA Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RL12RO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX RIN12 PGA Bypass Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RR12RO_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROMIX Right DAC Switch\", WM8991_OUTPUT_MIXER2,\n\t\tWM8991_RDRO_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_lonmix_controls[] = {\n\tSOC_DAPM_SINGLE(\"LONMIX Left Mixer PGA Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LLOPGALON_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LONMIX Right Mixer PGA Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LROPGALON_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LONMIX Inverted LOP Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LOPLON_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_lopmix_controls[] = {\n\tSOC_DAPM_SINGLE(\"LOPMIX Right Mic Bypass Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LR12LOP_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOPMIX Left Mic Bypass Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LL12LOP_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"LOPMIX Left Mixer PGA Switch\", WM8991_LINE_MIXER1,\n\t\tWM8991_LLOPGALOP_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_ronmix_controls[] = {\n\tSOC_DAPM_SINGLE(\"RONMIX Right Mixer PGA Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_RROPGARON_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"RONMIX Left Mixer PGA Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_RLOPGARON_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"RONMIX Inverted ROP Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_ROPRON_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_ropmix_controls[] = {\n\tSOC_DAPM_SINGLE(\"ROPMIX Left Mic Bypass Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_RL12ROP_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROPMIX Right Mic Bypass Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_RR12ROP_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"ROPMIX Right Mixer PGA Switch\", WM8991_LINE_MIXER2,\n\t\tWM8991_RROPGAROP_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_out3mix_controls[] = {\n\tSOC_DAPM_SINGLE(\"OUT3MIX LIN4RXN Bypass Switch\", WM8991_OUT3_4_MIXER,\n\t\tWM8991_LI4O3_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"OUT3MIX Left Out PGA Switch\", WM8991_OUT3_4_MIXER,\n\t\tWM8991_LPGAO3_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_out4mix_controls[] = {\n\tSOC_DAPM_SINGLE(\"OUT4MIX Right Out PGA Switch\", WM8991_OUT3_4_MIXER,\n\t\tWM8991_RPGAO4_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"OUT4MIX RIN4RXP Bypass Switch\", WM8991_OUT3_4_MIXER,\n\t\tWM8991_RI4O4_BIT, 1, 0),\n};\n\n \nstatic const struct snd_kcontrol_new wm8991_dapm_spkmix_controls[] = {\n\tSOC_DAPM_SINGLE(\"SPKMIX LIN2 Bypass Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_LI2SPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX LADC Bypass Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_LB2SPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX Left Mixer PGA Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_LOPGASPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX Left DAC Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_LDSPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX Right DAC Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_RDSPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX Right Mixer PGA Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_ROPGASPK_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX RADC Bypass Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_RL12ROP_BIT, 1, 0),\n\tSOC_DAPM_SINGLE(\"SPKMIX RIN2 Bypass Switch\", WM8991_SPEAKER_MIXER,\n\t\tWM8991_RI2SPK_BIT, 1, 0),\n};\n\nstatic const struct snd_soc_dapm_widget wm8991_dapm_widgets[] = {\n\t \n\t \n\tSND_SOC_DAPM_INPUT(\"LIN1\"),\n\tSND_SOC_DAPM_INPUT(\"LIN2\"),\n\tSND_SOC_DAPM_INPUT(\"LIN3\"),\n\tSND_SOC_DAPM_INPUT(\"LIN4RXN\"),\n\tSND_SOC_DAPM_INPUT(\"RIN3\"),\n\tSND_SOC_DAPM_INPUT(\"RIN4RXP\"),\n\tSND_SOC_DAPM_INPUT(\"RIN1\"),\n\tSND_SOC_DAPM_INPUT(\"RIN2\"),\n\tSND_SOC_DAPM_INPUT(\"Internal ADC Source\"),\n\n\tSND_SOC_DAPM_SUPPLY(\"INL\", WM8991_POWER_MANAGEMENT_2,\n\t\t\t    WM8991_AINL_ENA_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"INR\", WM8991_POWER_MANAGEMENT_2,\n\t\t\t    WM8991_AINR_ENA_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_ADC(\"Left ADC\", \"Left Capture\", WM8991_POWER_MANAGEMENT_2,\n\t\tWM8991_ADCL_ENA_BIT, 0),\n\tSND_SOC_DAPM_ADC(\"Right ADC\", \"Right Capture\", WM8991_POWER_MANAGEMENT_2,\n\t\tWM8991_ADCR_ENA_BIT, 0),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"LIN12 PGA\", WM8991_POWER_MANAGEMENT_2, WM8991_LIN12_ENA_BIT,\n\t\t0, &wm8991_dapm_lin12_pga_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_lin12_pga_controls)),\n\tSND_SOC_DAPM_MIXER(\"LIN34 PGA\", WM8991_POWER_MANAGEMENT_2, WM8991_LIN34_ENA_BIT,\n\t\t0, &wm8991_dapm_lin34_pga_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_lin34_pga_controls)),\n\tSND_SOC_DAPM_MIXER(\"RIN12 PGA\", WM8991_POWER_MANAGEMENT_2, WM8991_RIN12_ENA_BIT,\n\t\t0, &wm8991_dapm_rin12_pga_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_rin12_pga_controls)),\n\tSND_SOC_DAPM_MIXER(\"RIN34 PGA\", WM8991_POWER_MANAGEMENT_2, WM8991_RIN34_ENA_BIT,\n\t\t0, &wm8991_dapm_rin34_pga_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_rin34_pga_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"INMIXL\", SND_SOC_NOPM, 0, 0,\n\t\t&wm8991_dapm_inmixl_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_inmixl_controls)),\n\n\t \n\tSND_SOC_DAPM_MUX(\"AINLMUX\", SND_SOC_NOPM, 0, 0,\n\t\t&wm8991_dapm_ainlmux_controls),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"INMIXR\", SND_SOC_NOPM, 0, 0,\n\t\t&wm8991_dapm_inmixr_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_inmixr_controls)),\n\n\t \n\tSND_SOC_DAPM_MUX(\"AINRMUX\", SND_SOC_NOPM, 0, 0,\n\t\t&wm8991_dapm_ainrmux_controls),\n\n\t \n\t \n\tSND_SOC_DAPM_DAC(\"Left DAC\", \"Left Playback\", WM8991_POWER_MANAGEMENT_3,\n\t\tWM8991_DACL_ENA_BIT, 0),\n\tSND_SOC_DAPM_DAC(\"Right DAC\", \"Right Playback\", WM8991_POWER_MANAGEMENT_3,\n\t\tWM8991_DACR_ENA_BIT, 0),\n\n\t \n\tSND_SOC_DAPM_MIXER_E(\"LOMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_LOMIX_ENA_BIT,\n\t\t0, &wm8991_dapm_lomix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_lomix_controls),\n\t\toutmixer_event, SND_SOC_DAPM_PRE_REG),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"LONMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_LON_ENA_BIT, 0,\n\t\t&wm8991_dapm_lonmix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_lonmix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"LOPMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_LOP_ENA_BIT, 0,\n\t\t&wm8991_dapm_lopmix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_lopmix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"OUT3MIX\", WM8991_POWER_MANAGEMENT_1, WM8991_OUT3_ENA_BIT, 0,\n\t\t&wm8991_dapm_out3mix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_out3mix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER_E(\"SPKMIX\", WM8991_POWER_MANAGEMENT_1, WM8991_SPK_ENA_BIT, 0,\n\t\t&wm8991_dapm_spkmix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_spkmix_controls), outmixer_event,\n\t\tSND_SOC_DAPM_PRE_REG),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"OUT4MIX\", WM8991_POWER_MANAGEMENT_1, WM8991_OUT4_ENA_BIT, 0,\n\t\t&wm8991_dapm_out4mix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_out4mix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"ROPMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_ROP_ENA_BIT, 0,\n\t\t&wm8991_dapm_ropmix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_ropmix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"RONMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_RON_ENA_BIT, 0,\n\t\t&wm8991_dapm_ronmix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_ronmix_controls)),\n\n\t \n\tSND_SOC_DAPM_MIXER_E(\"ROMIX\", WM8991_POWER_MANAGEMENT_3, WM8991_ROMIX_ENA_BIT,\n\t\t0, &wm8991_dapm_romix_controls[0],\n\t\tARRAY_SIZE(wm8991_dapm_romix_controls),\n\t\toutmixer_event, SND_SOC_DAPM_PRE_REG),\n\n\t \n\tSND_SOC_DAPM_PGA(\"LOUT PGA\", WM8991_POWER_MANAGEMENT_1, WM8991_LOUT_ENA_BIT, 0,\n\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_PGA(\"ROUT PGA\", WM8991_POWER_MANAGEMENT_1, WM8991_ROUT_ENA_BIT, 0,\n\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_PGA(\"LOPGA\", WM8991_POWER_MANAGEMENT_3, WM8991_LOPGA_ENA_BIT, 0,\n\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_PGA(\"ROPGA\", WM8991_POWER_MANAGEMENT_3, WM8991_ROPGA_ENA_BIT, 0,\n\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"MICBIAS\", WM8991_POWER_MANAGEMENT_1,\n\t\t\t    WM8991_MICBIAS_ENA_BIT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"LON\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOP\"),\n\tSND_SOC_DAPM_OUTPUT(\"OUT3\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPKN\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPKP\"),\n\tSND_SOC_DAPM_OUTPUT(\"ROUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"OUT4\"),\n\tSND_SOC_DAPM_OUTPUT(\"ROP\"),\n\tSND_SOC_DAPM_OUTPUT(\"RON\"),\n\tSND_SOC_DAPM_OUTPUT(\"OUT\"),\n\n\tSND_SOC_DAPM_OUTPUT(\"Internal DAC Sink\"),\n};\n\nstatic const struct snd_soc_dapm_route wm8991_dapm_routes[] = {\n\t \n\t{\"Internal DAC Sink\", NULL, \"Left DAC\"},\n\t{\"Internal DAC Sink\", NULL, \"Right DAC\"},\n\n\t \n\t{\"Left ADC\", NULL, \"Internal ADC Source\"},\n\t{\"Right ADC\", NULL, \"Internal ADC Source\"},\n\n\t \n\t{\"INMIXL\", NULL, \"INL\"},\n\t{\"AINLMUX\", NULL, \"INL\"},\n\t{\"INMIXR\", NULL, \"INR\"},\n\t{\"AINRMUX\", NULL, \"INR\"},\n\t \n\t{\"LIN12 PGA\", \"LIN1 Switch\", \"LIN1\"},\n\t{\"LIN12 PGA\", \"LIN2 Switch\", \"LIN2\"},\n\t \n\t{\"LIN34 PGA\", \"LIN3 Switch\", \"LIN3\"},\n\t{\"LIN34 PGA\", \"LIN4 Switch\", \"LIN4RXN\"},\n\t \n\t{\"INMIXL\", \"Record Left Volume\", \"LOMIX\"},\n\t{\"INMIXL\", \"LIN2 Volume\", \"LIN2\"},\n\t{\"INMIXL\", \"LINPGA12 Switch\", \"LIN12 PGA\"},\n\t{\"INMIXL\", \"LINPGA34 Switch\", \"LIN34 PGA\"},\n\t \n\t{\"AINLMUX\", \"INMIXL Mix\", \"INMIXL\"},\n\t{\"AINLMUX\", \"DIFFINL Mix\", \"LIN12 PGA\"},\n\t{\"AINLMUX\", \"DIFFINL Mix\", \"LIN34 PGA\"},\n\t{\"AINLMUX\", \"RXVOICE Mix\", \"LIN4RXN\"},\n\t{\"AINLMUX\", \"RXVOICE Mix\", \"RIN4RXP\"},\n\t \n\t{\"Left ADC\", NULL, \"AINLMUX\"},\n\n\t \n\t{\"RIN12 PGA\", \"RIN1 Switch\", \"RIN1\"},\n\t{\"RIN12 PGA\", \"RIN2 Switch\", \"RIN2\"},\n\t \n\t{\"RIN34 PGA\", \"RIN3 Switch\", \"RIN3\"},\n\t{\"RIN34 PGA\", \"RIN4 Switch\", \"RIN4RXP\"},\n\t \n\t{\"INMIXR\", \"Record Right Volume\", \"ROMIX\"},\n\t{\"INMIXR\", \"RIN2 Volume\", \"RIN2\"},\n\t{\"INMIXR\", \"RINPGA12 Switch\", \"RIN12 PGA\"},\n\t{\"INMIXR\", \"RINPGA34 Switch\", \"RIN34 PGA\"},\n\t \n\t{\"AINRMUX\", \"INMIXR Mix\", \"INMIXR\"},\n\t{\"AINRMUX\", \"DIFFINR Mix\", \"RIN12 PGA\"},\n\t{\"AINRMUX\", \"DIFFINR Mix\", \"RIN34 PGA\"},\n\t{\"AINRMUX\", \"RXVOICE Mix\", \"LIN4RXN\"},\n\t{\"AINRMUX\", \"RXVOICE Mix\", \"RIN4RXP\"},\n\t \n\t{\"Right ADC\", NULL, \"AINRMUX\"},\n\n\t \n\t{\"LOMIX\", \"LOMIX RIN3 Bypass Switch\", \"RIN3\"},\n\t{\"LOMIX\", \"LOMIX LIN3 Bypass Switch\", \"LIN3\"},\n\t{\"LOMIX\", \"LOMIX LIN12 PGA Bypass Switch\", \"LIN12 PGA\"},\n\t{\"LOMIX\", \"LOMIX RIN12 PGA Bypass Switch\", \"RIN12 PGA\"},\n\t{\"LOMIX\", \"LOMIX Right ADC Bypass Switch\", \"AINRMUX\"},\n\t{\"LOMIX\", \"LOMIX Left ADC Bypass Switch\", \"AINLMUX\"},\n\t{\"LOMIX\", \"LOMIX Left DAC Switch\", \"Left DAC\"},\n\n\t \n\t{\"ROMIX\", \"ROMIX RIN3 Bypass Switch\", \"RIN3\"},\n\t{\"ROMIX\", \"ROMIX LIN3 Bypass Switch\", \"LIN3\"},\n\t{\"ROMIX\", \"ROMIX LIN12 PGA Bypass Switch\", \"LIN12 PGA\"},\n\t{\"ROMIX\", \"ROMIX RIN12 PGA Bypass Switch\", \"RIN12 PGA\"},\n\t{\"ROMIX\", \"ROMIX Right ADC Bypass Switch\", \"AINRMUX\"},\n\t{\"ROMIX\", \"ROMIX Left ADC Bypass Switch\", \"AINLMUX\"},\n\t{\"ROMIX\", \"ROMIX Right DAC Switch\", \"Right DAC\"},\n\n\t \n\t{\"SPKMIX\", \"SPKMIX LIN2 Bypass Switch\", \"LIN2\"},\n\t{\"SPKMIX\", \"SPKMIX RIN2 Bypass Switch\", \"RIN2\"},\n\t{\"SPKMIX\", \"SPKMIX LADC Bypass Switch\", \"AINLMUX\"},\n\t{\"SPKMIX\", \"SPKMIX RADC Bypass Switch\", \"AINRMUX\"},\n\t{\"SPKMIX\", \"SPKMIX Left Mixer PGA Switch\", \"LOPGA\"},\n\t{\"SPKMIX\", \"SPKMIX Right Mixer PGA Switch\", \"ROPGA\"},\n\t{\"SPKMIX\", \"SPKMIX Right DAC Switch\", \"Right DAC\"},\n\t{\"SPKMIX\", \"SPKMIX Left DAC Switch\", \"Right DAC\"},\n\n\t \n\t{\"LONMIX\", \"LONMIX Left Mixer PGA Switch\", \"LOPGA\"},\n\t{\"LONMIX\", \"LONMIX Right Mixer PGA Switch\", \"ROPGA\"},\n\t{\"LONMIX\", \"LONMIX Inverted LOP Switch\", \"LOPMIX\"},\n\n\t \n\t{\"LOPMIX\", \"LOPMIX Right Mic Bypass Switch\", \"RIN12 PGA\"},\n\t{\"LOPMIX\", \"LOPMIX Left Mic Bypass Switch\", \"LIN12 PGA\"},\n\t{\"LOPMIX\", \"LOPMIX Left Mixer PGA Switch\", \"LOPGA\"},\n\n\t \n\t{\"OUT3MIX\", \"OUT3MIX LIN4RXN Bypass Switch\", \"LIN4RXN\"},\n\t{\"OUT3MIX\", \"OUT3MIX Left Out PGA Switch\", \"LOPGA\"},\n\n\t \n\t{\"OUT4MIX\", \"OUT4MIX Right Out PGA Switch\", \"ROPGA\"},\n\t{\"OUT4MIX\", \"OUT4MIX RIN4RXP Bypass Switch\", \"RIN4RXP\"},\n\n\t \n\t{\"RONMIX\", \"RONMIX Right Mixer PGA Switch\", \"ROPGA\"},\n\t{\"RONMIX\", \"RONMIX Left Mixer PGA Switch\", \"LOPGA\"},\n\t{\"RONMIX\", \"RONMIX Inverted ROP Switch\", \"ROPMIX\"},\n\n\t \n\t{\"ROPMIX\", \"ROPMIX Left Mic Bypass Switch\", \"LIN12 PGA\"},\n\t{\"ROPMIX\", \"ROPMIX Right Mic Bypass Switch\", \"RIN12 PGA\"},\n\t{\"ROPMIX\", \"ROPMIX Right Mixer PGA Switch\", \"ROPGA\"},\n\n\t \n\t{\"LOPGA\", NULL, \"LOMIX\"},\n\t{\"ROPGA\", NULL, \"ROMIX\"},\n\n\t{\"LOUT PGA\", NULL, \"LOMIX\"},\n\t{\"ROUT PGA\", NULL, \"ROMIX\"},\n\n\t \n\t{\"LON\", NULL, \"LONMIX\"},\n\t{\"LOP\", NULL, \"LOPMIX\"},\n\t{\"OUT\", NULL, \"OUT3MIX\"},\n\t{\"LOUT\", NULL, \"LOUT PGA\"},\n\t{\"SPKN\", NULL, \"SPKMIX\"},\n\t{\"ROUT\", NULL, \"ROUT PGA\"},\n\t{\"OUT4\", NULL, \"OUT4MIX\"},\n\t{\"ROP\", NULL, \"ROPMIX\"},\n\t{\"RON\", NULL, \"RONMIX\"},\n};\n\n \nstruct _pll_div {\n\tu32 div2;\n\tu32 n;\n\tu32 k;\n};\n\n \n#define FIXED_PLL_SIZE ((1 << 16) * 10)\n\nstatic void pll_factors(struct _pll_div *pll_div, unsigned int target,\n\t\t\tunsigned int source)\n{\n\tu64 Kpart;\n\tunsigned int K, Ndiv, Nmod;\n\n\n\tNdiv = target / source;\n\tif (Ndiv < 6) {\n\t\tsource >>= 1;\n\t\tpll_div->div2 = 1;\n\t\tNdiv = target / source;\n\t} else\n\t\tpll_div->div2 = 0;\n\n\tif ((Ndiv < 6) || (Ndiv > 12))\n\t\tprintk(KERN_WARNING\n\t\t       \"WM8991 N value outwith recommended range! N = %d\\n\", Ndiv);\n\n\tpll_div->n = Ndiv;\n\tNmod = target % source;\n\tKpart = FIXED_PLL_SIZE * (long long)Nmod;\n\n\tdo_div(Kpart, source);\n\n\tK = Kpart & 0xFFFFFFFF;\n\n\t \n\tif ((K % 10) >= 5)\n\t\tK += 5;\n\n\t \n\tK /= 10;\n\n\tpll_div->k = K;\n}\n\nstatic int wm8991_set_dai_pll(struct snd_soc_dai *codec_dai,\n\t\t\t      int pll_id, int src, unsigned int freq_in, unsigned int freq_out)\n{\n\tu16 reg;\n\tstruct snd_soc_component *component = codec_dai->component;\n\tstruct _pll_div pll_div;\n\n\tif (freq_in && freq_out) {\n\t\tpll_factors(&pll_div, freq_out * 4, freq_in);\n\n\t\t \n\t\treg = snd_soc_component_read(component, WM8991_POWER_MANAGEMENT_2);\n\t\treg |= WM8991_PLL_ENA;\n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_2, reg);\n\n\t\t \n\t\treg = snd_soc_component_read(component, WM8991_CLOCKING_2);\n\t\tsnd_soc_component_write(component, WM8991_CLOCKING_2, reg | WM8991_SYSCLK_SRC);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_PLL1, pll_div.n | WM8991_SDM |\n\t\t\t      (pll_div.div2 ? WM8991_PRESCALE : 0));\n\t\tsnd_soc_component_write(component, WM8991_PLL2, (u8)(pll_div.k>>8));\n\t\tsnd_soc_component_write(component, WM8991_PLL3, (u8)(pll_div.k & 0xFF));\n\t} else {\n\t\t \n\t\treg = snd_soc_component_read(component, WM8991_POWER_MANAGEMENT_2);\n\t\treg &= ~WM8991_PLL_ENA;\n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_2, reg);\n\t}\n\treturn 0;\n}\n\n \nstatic int wm8991_set_dai_fmt(struct snd_soc_dai *codec_dai,\n\t\t\t      unsigned int fmt)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tu16 audio1, audio3;\n\n\taudio1 = snd_soc_component_read(component, WM8991_AUDIO_INTERFACE_1);\n\taudio3 = snd_soc_component_read(component, WM8991_AUDIO_INTERFACE_3);\n\n\t \n\tswitch (fmt & SND_SOC_DAIFMT_MASTER_MASK) {\n\tcase SND_SOC_DAIFMT_CBS_CFS:\n\t\taudio3 &= ~WM8991_AIF_MSTR1;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBM_CFM:\n\t\taudio3 |= WM8991_AIF_MSTR1;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\taudio1 &= ~WM8991_AIF_FMT_MASK;\n\n\t \n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:\n\t\taudio1 |= WM8991_AIF_TMF_I2S;\n\t\taudio1 &= ~WM8991_AIF_LRCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_RIGHT_J:\n\t\taudio1 |= WM8991_AIF_TMF_RIGHTJ;\n\t\taudio1 &= ~WM8991_AIF_LRCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_LEFT_J:\n\t\taudio1 |= WM8991_AIF_TMF_LEFTJ;\n\t\taudio1 &= ~WM8991_AIF_LRCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_A:\n\t\taudio1 |= WM8991_AIF_TMF_DSP;\n\t\taudio1 &= ~WM8991_AIF_LRCLK_INV;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_B:\n\t\taudio1 |= WM8991_AIF_TMF_DSP | WM8991_AIF_LRCLK_INV;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_write(component, WM8991_AUDIO_INTERFACE_1, audio1);\n\tsnd_soc_component_write(component, WM8991_AUDIO_INTERFACE_3, audio3);\n\treturn 0;\n}\n\nstatic int wm8991_set_dai_clkdiv(struct snd_soc_dai *codec_dai,\n\t\t\t\t int div_id, int div)\n{\n\tstruct snd_soc_component *component = codec_dai->component;\n\tu16 reg;\n\n\tswitch (div_id) {\n\tcase WM8991_MCLK_DIV:\n\t\treg = snd_soc_component_read(component, WM8991_CLOCKING_2) &\n\t\t      ~WM8991_MCLK_DIV_MASK;\n\t\tsnd_soc_component_write(component, WM8991_CLOCKING_2, reg | div);\n\t\tbreak;\n\tcase WM8991_DACCLK_DIV:\n\t\treg = snd_soc_component_read(component, WM8991_CLOCKING_2) &\n\t\t      ~WM8991_DAC_CLKDIV_MASK;\n\t\tsnd_soc_component_write(component, WM8991_CLOCKING_2, reg | div);\n\t\tbreak;\n\tcase WM8991_ADCCLK_DIV:\n\t\treg = snd_soc_component_read(component, WM8991_CLOCKING_2) &\n\t\t      ~WM8991_ADC_CLKDIV_MASK;\n\t\tsnd_soc_component_write(component, WM8991_CLOCKING_2, reg | div);\n\t\tbreak;\n\tcase WM8991_BCLK_DIV:\n\t\treg = snd_soc_component_read(component, WM8991_CLOCKING_1) &\n\t\t      ~WM8991_BCLK_DIV_MASK;\n\t\tsnd_soc_component_write(component, WM8991_CLOCKING_1, reg | div);\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\n \nstatic int wm8991_hw_params(struct snd_pcm_substream *substream,\n\t\t\t    struct snd_pcm_hw_params *params,\n\t\t\t    struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tu16 audio1 = snd_soc_component_read(component, WM8991_AUDIO_INTERFACE_1);\n\n\taudio1 &= ~WM8991_AIF_WL_MASK;\n\t \n\tswitch (params_width(params)) {\n\tcase 16:\n\t\tbreak;\n\tcase 20:\n\t\taudio1 |= WM8991_AIF_WL_20BITS;\n\t\tbreak;\n\tcase 24:\n\t\taudio1 |= WM8991_AIF_WL_24BITS;\n\t\tbreak;\n\tcase 32:\n\t\taudio1 |= WM8991_AIF_WL_32BITS;\n\t\tbreak;\n\t}\n\n\tsnd_soc_component_write(component, WM8991_AUDIO_INTERFACE_1, audio1);\n\treturn 0;\n}\n\nstatic int wm8991_mute(struct snd_soc_dai *dai, int mute, int direction)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tu16 val;\n\n\tval  = snd_soc_component_read(component, WM8991_DAC_CTRL) & ~WM8991_DAC_MUTE;\n\tif (mute)\n\t\tsnd_soc_component_write(component, WM8991_DAC_CTRL, val | WM8991_DAC_MUTE);\n\telse\n\t\tsnd_soc_component_write(component, WM8991_DAC_CTRL, val);\n\treturn 0;\n}\n\nstatic int wm8991_set_bias_level(struct snd_soc_component *component,\n\t\t\t\t enum snd_soc_bias_level level)\n{\n\tstruct wm8991_priv *wm8991 = snd_soc_component_get_drvdata(component);\n\tu16 val;\n\n\tswitch (level) {\n\tcase SND_SOC_BIAS_ON:\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_PREPARE:\n\t\t \n\t\tval = snd_soc_component_read(component, WM8991_POWER_MANAGEMENT_1) &\n\t\t      ~WM8991_VMID_MODE_MASK;\n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, val | 0x2);\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tif (snd_soc_component_get_bias_level(component) == SND_SOC_BIAS_OFF) {\n\t\t\tregcache_sync(wm8991->regmap);\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP1, WM8991_DIS_LLINE |\n\t\t\t\t      WM8991_DIS_RLINE | WM8991_DIS_OUT3 |\n\t\t\t\t      WM8991_DIS_OUT4 | WM8991_DIS_LOUT |\n\t\t\t\t      WM8991_DIS_ROUT);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_SOFTST |\n\t\t\t\t      WM8991_BUFDCOPEN | WM8991_POBCTRL |\n\t\t\t\t      WM8991_VMIDTOG);\n\n\t\t\t \n\t\t\tmsleep(300);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_SOFTST |\n\t\t\t\t      WM8991_BUFDCOPEN | WM8991_POBCTRL);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP1, 0);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x1b00);\n\n\t\t\tmsleep(50);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x1f02);\n\n\t\t\tmsleep(100);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x1f03);\n\n\t\t\tmsleep(600);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_SOFTST |\n\t\t\t\t      WM8991_BUFDCOPEN | WM8991_POBCTRL |\n\t\t\t\t      WM8991_BUFIOEN);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x3);\n\n\t\t\t \n\t\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_BUFIOEN);\n\t\t}\n\n\t\t \n\t\tval = snd_soc_component_read(component, WM8991_POWER_MANAGEMENT_1) &\n\t\t      ~WM8991_VMID_MODE_MASK;\n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, val | 0x4);\n\t\tbreak;\n\n\tcase SND_SOC_BIAS_OFF:\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_SOFTST |\n\t\t\t      WM8991_POBCTRL | WM8991_BUFIOEN);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, WM8991_SOFTST |\n\t\t\t      WM8991_BUFDCOPEN | WM8991_POBCTRL |\n\t\t\t      WM8991_BUFIOEN);\n\n\t\t \n\t\tval = snd_soc_component_read(component, WM8991_DAC_CTRL);\n\t\tsnd_soc_component_write(component, WM8991_DAC_CTRL, val | WM8991_DAC_MUTE);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x1f03);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x1f01);\n\n\t\tmsleep(300);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_ANTIPOP1, WM8991_DIS_LLINE |\n\t\t\t      WM8991_DIS_RLINE | WM8991_DIS_OUT3 |\n\t\t\t      WM8991_DIS_OUT4 | WM8991_DIS_LOUT |\n\t\t\t      WM8991_DIS_ROUT);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_POWER_MANAGEMENT_1, 0x0);\n\n\t\t \n\t\tsnd_soc_component_write(component, WM8991_ANTIPOP2, 0x0);\n\t\tregcache_mark_dirty(wm8991->regmap);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n#define WM8991_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S20_3LE |\\\n\t\t\tSNDRV_PCM_FMTBIT_S24_LE)\n\nstatic const struct snd_soc_dai_ops wm8991_ops = {\n\t.hw_params = wm8991_hw_params,\n\t.mute_stream = wm8991_mute,\n\t.set_fmt = wm8991_set_dai_fmt,\n\t.set_clkdiv = wm8991_set_dai_clkdiv,\n\t.set_pll = wm8991_set_dai_pll,\n\t.no_capture_mute = 1,\n};\n\n \nstatic struct snd_soc_dai_driver wm8991_dai = {\n\t \n\t.name = \"wm8991\",\n\t.id = 1,\n\t.playback = {\n\t\t.stream_name = \"Playback\",\n\t\t.channels_min = 1,\n\t\t.channels_max = 2,\n\t\t.rates = SNDRV_PCM_RATE_8000_96000,\n\t\t.formats = WM8991_FORMATS\n\t},\n\t.capture = {\n\t\t.stream_name = \"Capture\",\n\t\t.channels_min = 1,\n\t\t.channels_max = 2,\n\t\t.rates = SNDRV_PCM_RATE_8000_96000,\n\t\t.formats = WM8991_FORMATS\n\t},\n\t.ops = &wm8991_ops\n};\n\nstatic const struct snd_soc_component_driver soc_component_dev_wm8991 = {\n\t.set_bias_level\t\t= wm8991_set_bias_level,\n\t.controls\t\t= wm8991_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(wm8991_snd_controls),\n\t.dapm_widgets\t\t= wm8991_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(wm8991_dapm_widgets),\n\t.dapm_routes\t\t= wm8991_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(wm8991_dapm_routes),\n\t.suspend_bias_off\t= 1,\n\t.idle_bias_on\t\t= 1,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic const struct regmap_config wm8991_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 16,\n\n\t.max_register = WM8991_PLL3,\n\t.volatile_reg = wm8991_volatile,\n\t.reg_defaults = wm8991_reg_defaults,\n\t.num_reg_defaults = ARRAY_SIZE(wm8991_reg_defaults),\n\t.cache_type = REGCACHE_MAPLE,\n};\n\nstatic int wm8991_i2c_probe(struct i2c_client *i2c)\n{\n\tstruct wm8991_priv *wm8991;\n\tunsigned int val;\n\tint ret;\n\n\twm8991 = devm_kzalloc(&i2c->dev, sizeof(*wm8991), GFP_KERNEL);\n\tif (!wm8991)\n\t\treturn -ENOMEM;\n\n\twm8991->regmap = devm_regmap_init_i2c(i2c, &wm8991_regmap);\n\tif (IS_ERR(wm8991->regmap))\n\t\treturn PTR_ERR(wm8991->regmap);\n\n\ti2c_set_clientdata(i2c, wm8991);\n\n\tret = regmap_read(wm8991->regmap, WM8991_RESET, &val);\n\tif (ret != 0) {\n\t\tdev_err(&i2c->dev, \"Failed to read device ID: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\tif (val != 0x8991) {\n\t\tdev_err(&i2c->dev, \"Device with ID %x is not a WM8991\\n\", val);\n\t\treturn -EINVAL;\n\t}\n\n\tret = regmap_write(wm8991->regmap, WM8991_RESET, 0);\n\tif (ret < 0) {\n\t\tdev_err(&i2c->dev, \"Failed to issue reset: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tregmap_update_bits(wm8991->regmap, WM8991_AUDIO_INTERFACE_4,\n\t\t\t   WM8991_ALRCGPIO1, WM8991_ALRCGPIO1);\n\n\tregmap_update_bits(wm8991->regmap, WM8991_GPIO1_GPIO2,\n\t\t\t   WM8991_GPIO1_SEL_MASK, 1);\n\n\tregmap_update_bits(wm8991->regmap, WM8991_POWER_MANAGEMENT_1,\n\t\t\t   WM8991_VREF_ENA | WM8991_VMID_MODE_MASK,\n\t\t\t   WM8991_VREF_ENA | WM8991_VMID_MODE_MASK);\n\n\tregmap_update_bits(wm8991->regmap, WM8991_POWER_MANAGEMENT_2,\n\t\t\t   WM8991_OPCLK_ENA, WM8991_OPCLK_ENA);\n\n\tregmap_write(wm8991->regmap, WM8991_DAC_CTRL, 0);\n\tregmap_write(wm8991->regmap, WM8991_LEFT_OUTPUT_VOLUME,\n\t\t     0x50 | (1<<8));\n\tregmap_write(wm8991->regmap, WM8991_RIGHT_OUTPUT_VOLUME,\n\t\t     0x50 | (1<<8));\n\n\tret = devm_snd_soc_register_component(&i2c->dev,\n\t\t\t\t     &soc_component_dev_wm8991, &wm8991_dai, 1);\n\n\treturn ret;\n}\n\nstatic const struct i2c_device_id wm8991_i2c_id[] = {\n\t{ \"wm8991\", 0 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, wm8991_i2c_id);\n\nstatic struct i2c_driver wm8991_i2c_driver = {\n\t.driver = {\n\t\t.name = \"wm8991\",\n\t},\n\t.probe = wm8991_i2c_probe,\n\t.id_table = wm8991_i2c_id,\n};\n\nmodule_i2c_driver(wm8991_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC WM8991 driver\");\nMODULE_AUTHOR(\"Graeme Gregory\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}