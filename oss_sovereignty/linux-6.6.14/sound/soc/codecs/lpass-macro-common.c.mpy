{
  "module_name": "lpass-macro-common.c",
  "hash_id": "022b8774ed2d22626bbd3d48d3974c7d403ed6776d5cf27a2f1f123de846f9f5",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/lpass-macro-common.c",
  "human_readable_source": "\n\n\n#include <linux/export.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/of_platform.h>\n#include <linux/platform_device.h>\n#include <linux/pm_domain.h>\n#include <linux/pm_runtime.h>\n\n#include \"lpass-macro-common.h\"\n\nstruct lpass_macro *lpass_macro_pds_init(struct device *dev)\n{\n\tstruct lpass_macro *l_pds;\n\tint ret;\n\n\tif (!of_property_present(dev->of_node, \"power-domains\"))\n\t\treturn NULL;\n\n\tl_pds = devm_kzalloc(dev, sizeof(*l_pds), GFP_KERNEL);\n\tif (!l_pds)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tl_pds->macro_pd = dev_pm_domain_attach_by_name(dev, \"macro\");\n\tif (IS_ERR_OR_NULL(l_pds->macro_pd)) {\n\t\tret = l_pds->macro_pd ? PTR_ERR(l_pds->macro_pd) : -ENODATA;\n\t\tgoto macro_err;\n\t}\n\n\tret = pm_runtime_resume_and_get(l_pds->macro_pd);\n\tif (ret < 0)\n\t\tgoto macro_sync_err;\n\n\tl_pds->dcodec_pd = dev_pm_domain_attach_by_name(dev, \"dcodec\");\n\tif (IS_ERR_OR_NULL(l_pds->dcodec_pd)) {\n\t\tret = l_pds->dcodec_pd ? PTR_ERR(l_pds->dcodec_pd) : -ENODATA;\n\t\tgoto dcodec_err;\n\t}\n\n\tret = pm_runtime_resume_and_get(l_pds->dcodec_pd);\n\tif (ret < 0)\n\t\tgoto dcodec_sync_err;\n\treturn l_pds;\n\ndcodec_sync_err:\n\tdev_pm_domain_detach(l_pds->dcodec_pd, false);\ndcodec_err:\n\tpm_runtime_put(l_pds->macro_pd);\nmacro_sync_err:\n\tdev_pm_domain_detach(l_pds->macro_pd, false);\nmacro_err:\n\treturn ERR_PTR(ret);\n}\nEXPORT_SYMBOL_GPL(lpass_macro_pds_init);\n\nvoid lpass_macro_pds_exit(struct lpass_macro *pds)\n{\n\tif (pds) {\n\t\tpm_runtime_put(pds->macro_pd);\n\t\tdev_pm_domain_detach(pds->macro_pd, false);\n\t\tpm_runtime_put(pds->dcodec_pd);\n\t\tdev_pm_domain_detach(pds->dcodec_pd, false);\n\t}\n}\nEXPORT_SYMBOL_GPL(lpass_macro_pds_exit);\n\nMODULE_DESCRIPTION(\"Common macro driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}