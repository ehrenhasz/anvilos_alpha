{
  "module_name": "arizona.h",
  "hash_id": "95dcd037ba7379eda670e25948e7c061fbc330b15ec6f09d0679640544b1c326",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/arizona.h",
  "human_readable_source": " \n \n\n#ifndef _ASOC_ARIZONA_H\n#define _ASOC_ARIZONA_H\n\n#include <linux/completion.h>\n#include <linux/notifier.h>\n#include <linux/mfd/arizona/core.h>\n\n#include <sound/soc.h>\n\n#include \"wm_adsp.h\"\n\n#define ARIZONA_CLK_SYSCLK         1\n#define ARIZONA_CLK_ASYNCCLK       2\n#define ARIZONA_CLK_OPCLK          3\n#define ARIZONA_CLK_ASYNC_OPCLK    4\n\n#define ARIZONA_CLK_SRC_MCLK1    0x0\n#define ARIZONA_CLK_SRC_MCLK2    0x1\n#define ARIZONA_CLK_SRC_FLL1     0x4\n#define ARIZONA_CLK_SRC_FLL2     0x5\n#define ARIZONA_CLK_SRC_AIF1BCLK 0x8\n#define ARIZONA_CLK_SRC_AIF2BCLK 0x9\n#define ARIZONA_CLK_SRC_AIF3BCLK 0xa\n\n#define ARIZONA_FLL_SRC_NONE      -1\n#define ARIZONA_FLL_SRC_MCLK1      0\n#define ARIZONA_FLL_SRC_MCLK2      1\n#define ARIZONA_FLL_SRC_SLIMCLK    3\n#define ARIZONA_FLL_SRC_FLL1       4\n#define ARIZONA_FLL_SRC_FLL2       5\n#define ARIZONA_FLL_SRC_AIF1BCLK   8\n#define ARIZONA_FLL_SRC_AIF2BCLK   9\n#define ARIZONA_FLL_SRC_AIF3BCLK  10\n#define ARIZONA_FLL_SRC_AIF1LRCLK 12\n#define ARIZONA_FLL_SRC_AIF2LRCLK 13\n#define ARIZONA_FLL_SRC_AIF3LRCLK 14\n\n#define ARIZONA_MIXER_VOL_MASK             0x00FE\n#define ARIZONA_MIXER_VOL_SHIFT                 1\n#define ARIZONA_MIXER_VOL_WIDTH                 7\n\n#define ARIZONA_CLK_6MHZ   0\n#define ARIZONA_CLK_12MHZ  1\n#define ARIZONA_CLK_24MHZ  2\n#define ARIZONA_CLK_49MHZ  3\n#define ARIZONA_CLK_73MHZ  4\n#define ARIZONA_CLK_98MHZ  5\n#define ARIZONA_CLK_147MHZ 6\n\n#define ARIZONA_MAX_DAI  10\n#define ARIZONA_MAX_ADSP 4\n\n#define ARIZONA_DVFS_SR1_RQ\t0x001\n#define ARIZONA_DVFS_ADSP1_RQ\t0x100\n\n \n#define ARIZONA_NOTIFY_VOICE_TRIGGER   0x1\n\nstruct wm_adsp;\n\nstruct arizona_dai_priv {\n\tint clk;\n\n\tstruct snd_pcm_hw_constraint_list constraint;\n};\n\nstruct arizona_priv {\n\tstruct wm_adsp adsp[ARIZONA_MAX_ADSP];\n\tstruct arizona *arizona;\n\tint sysclk;\n\tint asyncclk;\n\tstruct arizona_dai_priv dai[ARIZONA_MAX_DAI];\n\n\tint num_inputs;\n\tunsigned int in_pending;\n\n\tunsigned int out_up_pending;\n\tunsigned int out_up_delay;\n\tunsigned int out_down_pending;\n\tunsigned int out_down_delay;\n\n\tunsigned int dvfs_reqs;\n\tstruct mutex dvfs_lock;\n\tbool dvfs_cached;\n\n\t \n\tstruct mutex lock;\n\tstruct delayed_work hpdet_work;\n\tstruct delayed_work micd_detect_work;\n\tstruct delayed_work micd_timeout_work;\n\tstruct snd_soc_jack *jack;\n\tstruct regulator *micvdd;\n\tstruct gpio_desc *micd_pol_gpio;\n\n\tu16 last_jackdet;\n\n\tint micd_mode;\n\tconst struct arizona_micd_config *micd_modes;\n\tint micd_num_modes;\n\n\tint micd_button_mask;\n\tconst struct arizona_micd_range *micd_ranges;\n\tint num_micd_ranges;\n\n\tbool micd_reva;\n\tbool micd_clamp;\n\n\tbool hpdet_active;\n\tbool hpdet_done;\n\tbool hpdet_retried;\n\n\tbool mic;\n\tbool detecting;\n\n\tint num_hpdet_res;\n\tunsigned int hpdet_res[3];\n\n\tint jack_flips;\n\tint hpdet_ip_version;\n};\n\nstruct arizona_voice_trigger_info {\n\tint core;\n};\n\n#define ARIZONA_NUM_MIXER_INPUTS 104\n\nextern const unsigned int arizona_mixer_tlv[];\nextern const char * const arizona_mixer_texts[ARIZONA_NUM_MIXER_INPUTS];\nextern unsigned int arizona_mixer_values[ARIZONA_NUM_MIXER_INPUTS];\n\n#define ARIZONA_GAINMUX_CONTROLS(name, base) \\\n\tSOC_SINGLE_RANGE_TLV(name \" Input Volume\", base + 1,\t\t\\\n\t\t\t     ARIZONA_MIXER_VOL_SHIFT, 0x20, 0x50, 0,\t\\\n\t\t\t     arizona_mixer_tlv)\n\n#define ARIZONA_MIXER_CONTROLS(name, base) \\\n\tSOC_SINGLE_RANGE_TLV(name \" Input 1 Volume\", base + 1,\t\t\\\n\t\t\t     ARIZONA_MIXER_VOL_SHIFT, 0x20, 0x50, 0,\t\\\n\t\t\t     arizona_mixer_tlv),\t\t\t\\\n\tSOC_SINGLE_RANGE_TLV(name \" Input 2 Volume\", base + 3,\t\t\\\n\t\t\t     ARIZONA_MIXER_VOL_SHIFT, 0x20, 0x50, 0,\t\\\n\t\t\t     arizona_mixer_tlv),\t\t\t\\\n\tSOC_SINGLE_RANGE_TLV(name \" Input 3 Volume\", base + 5,\t\t\\\n\t\t\t     ARIZONA_MIXER_VOL_SHIFT, 0x20, 0x50, 0,\t\\\n\t\t\t     arizona_mixer_tlv),\t\t\t\\\n\tSOC_SINGLE_RANGE_TLV(name \" Input 4 Volume\", base + 7,\t\t\\\n\t\t\t     ARIZONA_MIXER_VOL_SHIFT, 0x20, 0x50, 0,\t\\\n\t\t\t     arizona_mixer_tlv)\n\n#define ARIZONA_MUX_ENUM_DECL(name, reg) \\\n\tSOC_VALUE_ENUM_SINGLE_AUTODISABLE_DECL( \\\n\t\tname, reg, 0, 0xff, arizona_mixer_texts, arizona_mixer_values)\n\n#define ARIZONA_MUX_CTL_DECL(name) \\\n\tconst struct snd_kcontrol_new name##_mux =\t\\\n\t\tSOC_DAPM_ENUM(\"Route\", name##_enum)\n\n#define ARIZONA_MUX_ENUMS(name, base_reg) \\\n\tstatic ARIZONA_MUX_ENUM_DECL(name##_enum, base_reg);      \\\n\tstatic ARIZONA_MUX_CTL_DECL(name)\n\n#define ARIZONA_MIXER_ENUMS(name, base_reg) \\\n\tARIZONA_MUX_ENUMS(name##_in1, base_reg);     \\\n\tARIZONA_MUX_ENUMS(name##_in2, base_reg + 2); \\\n\tARIZONA_MUX_ENUMS(name##_in3, base_reg + 4); \\\n\tARIZONA_MUX_ENUMS(name##_in4, base_reg + 6)\n\n#define ARIZONA_DSP_AUX_ENUMS(name, base_reg) \\\n\tARIZONA_MUX_ENUMS(name##_aux1, base_reg);\t\\\n\tARIZONA_MUX_ENUMS(name##_aux2, base_reg + 8);\t\\\n\tARIZONA_MUX_ENUMS(name##_aux3, base_reg + 16);\t\\\n\tARIZONA_MUX_ENUMS(name##_aux4, base_reg + 24);\t\\\n\tARIZONA_MUX_ENUMS(name##_aux5, base_reg + 32);\t\\\n\tARIZONA_MUX_ENUMS(name##_aux6, base_reg + 40)\n\n#define ARIZONA_MUX(name, ctrl) \\\n\tSND_SOC_DAPM_MUX(name, SND_SOC_NOPM, 0, 0, ctrl)\n\n#define ARIZONA_MUX_WIDGETS(name, name_str) \\\n\tARIZONA_MUX(name_str \" Input\", &name##_mux)\n\n#define ARIZONA_MIXER_WIDGETS(name, name_str)\t\\\n\tARIZONA_MUX(name_str \" Input 1\", &name##_in1_mux), \\\n\tARIZONA_MUX(name_str \" Input 2\", &name##_in2_mux), \\\n\tARIZONA_MUX(name_str \" Input 3\", &name##_in3_mux), \\\n\tARIZONA_MUX(name_str \" Input 4\", &name##_in4_mux), \\\n\tSND_SOC_DAPM_MIXER(name_str \" Mixer\", SND_SOC_NOPM, 0, 0, NULL, 0)\n\n#define ARIZONA_DSP_WIDGETS(name, name_str) \\\n\tARIZONA_MIXER_WIDGETS(name##L, name_str \"L\"), \\\n\tARIZONA_MIXER_WIDGETS(name##R, name_str \"R\"), \\\n\tARIZONA_MUX(name_str \" Aux 1\", &name##_aux1_mux), \\\n\tARIZONA_MUX(name_str \" Aux 2\", &name##_aux2_mux), \\\n\tARIZONA_MUX(name_str \" Aux 3\", &name##_aux3_mux), \\\n\tARIZONA_MUX(name_str \" Aux 4\", &name##_aux4_mux), \\\n\tARIZONA_MUX(name_str \" Aux 5\", &name##_aux5_mux), \\\n\tARIZONA_MUX(name_str \" Aux 6\", &name##_aux6_mux)\n\n#define ARIZONA_MUX_ROUTES(widget, name) \\\n\t{ widget, NULL, name \" Input\" }, \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Input\")\n\n#define ARIZONA_MIXER_ROUTES(widget, name) \\\n\t{ widget, NULL, name \" Mixer\" },         \\\n\t{ name \" Mixer\", NULL, name \" Input 1\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 2\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 3\" }, \\\n\t{ name \" Mixer\", NULL, name \" Input 4\" }, \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Input 1\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Input 2\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Input 3\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Input 4\")\n\n#define ARIZONA_DSP_ROUTES(name) \\\n\t{ name, NULL, name \" Preloader\"}, \\\n\t{ name \" Preloader\", NULL, \"SYSCLK\" }, \\\n\t{ name \" Preload\", NULL, name \" Preloader\"}, \\\n\t{ name, NULL, name \" Aux 1\" }, \\\n\t{ name, NULL, name \" Aux 2\" }, \\\n\t{ name, NULL, name \" Aux 3\" }, \\\n\t{ name, NULL, name \" Aux 4\" }, \\\n\t{ name, NULL, name \" Aux 5\" }, \\\n\t{ name, NULL, name \" Aux 6\" }, \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 1\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 2\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 3\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 4\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 5\"), \\\n\tARIZONA_MIXER_INPUT_ROUTES(name \" Aux 6\"), \\\n\tARIZONA_MIXER_ROUTES(name, name \"L\"), \\\n\tARIZONA_MIXER_ROUTES(name, name \"R\")\n\n#define ARIZONA_EQ_CONTROL(xname, xbase)                      \\\n{\t.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname,   \\\n\t.info = snd_soc_bytes_info, .get = snd_soc_bytes_get, \\\n\t.put = arizona_eq_coeff_put, .private_value =         \\\n\t((unsigned long)&(struct soc_bytes) { .base = xbase,  \\\n\t .num_regs = 20, .mask = ~ARIZONA_EQ1_B1_MODE }) }\n\n#define ARIZONA_LHPF_CONTROL(xname, xbase)                    \\\n{\t.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = xname,   \\\n\t.info = snd_soc_bytes_info, .get = snd_soc_bytes_get, \\\n\t.put = arizona_lhpf_coeff_put, .private_value =       \\\n\t((unsigned long)&(struct soc_bytes) { .base = xbase,  \\\n\t .num_regs = 1 }) }\n\n#define ARIZONA_RATE_ENUM_SIZE 4\n#define ARIZONA_SAMPLE_RATE_ENUM_SIZE 14\n\n \n#define ARIZONA_JACK_MASK  (SND_JACK_HEADSET | SND_JACK_LINEOUT | SND_JACK_MECHANICAL)\n\nextern const char * const arizona_rate_text[ARIZONA_RATE_ENUM_SIZE];\nextern const unsigned int arizona_rate_val[ARIZONA_RATE_ENUM_SIZE];\nextern const char * const arizona_sample_rate_text[ARIZONA_SAMPLE_RATE_ENUM_SIZE];\nextern const unsigned int arizona_sample_rate_val[ARIZONA_SAMPLE_RATE_ENUM_SIZE];\n\nextern const struct soc_enum arizona_isrc_fsl[];\nextern const struct soc_enum arizona_isrc_fsh[];\nextern const struct soc_enum arizona_asrc_rate1;\n\nextern const struct soc_enum arizona_in_vi_ramp;\nextern const struct soc_enum arizona_in_vd_ramp;\n\nextern const struct soc_enum arizona_out_vi_ramp;\nextern const struct soc_enum arizona_out_vd_ramp;\n\nextern const struct soc_enum arizona_lhpf1_mode;\nextern const struct soc_enum arizona_lhpf2_mode;\nextern const struct soc_enum arizona_lhpf3_mode;\nextern const struct soc_enum arizona_lhpf4_mode;\n\nextern const struct soc_enum arizona_ng_hold;\nextern const struct soc_enum arizona_in_hpf_cut_enum;\nextern const struct soc_enum arizona_in_dmic_osr[];\n\nextern const struct snd_kcontrol_new arizona_adsp2_rate_controls[];\n\nextern const struct soc_enum arizona_anc_input_src[];\nextern const struct soc_enum arizona_anc_ng_enum;\nextern const struct soc_enum arizona_output_anc_src[];\n\nextern const struct snd_kcontrol_new arizona_voice_trigger_switch[];\n\nint arizona_in_ev(struct snd_soc_dapm_widget *w, struct snd_kcontrol *kcontrol,\n\t\t  int event);\nint arizona_out_ev(struct snd_soc_dapm_widget *w, struct snd_kcontrol *kcontrol,\n\t\t   int event);\nint arizona_hp_ev(struct snd_soc_dapm_widget *w, struct snd_kcontrol *kcontrol,\n\t\t  int event);\nint arizona_anc_ev(struct snd_soc_dapm_widget *w, struct snd_kcontrol *kcontrol,\n\t\t   int event);\n\nint arizona_eq_coeff_put(struct snd_kcontrol *kcontrol,\n\t\t\t struct snd_ctl_elem_value *ucontrol);\nint arizona_lhpf_coeff_put(struct snd_kcontrol *kcontrol,\n\t\t\t   struct snd_ctl_elem_value *ucontrol);\n\nint arizona_clk_ev(struct snd_soc_dapm_widget *w, struct snd_kcontrol *kcontrol,\n\t\t   int event);\nint arizona_set_sysclk(struct snd_soc_component *component, int clk_id, int source,\n\t\t       unsigned int freq, int dir);\n\nextern const struct snd_soc_dai_ops arizona_dai_ops;\nextern const struct snd_soc_dai_ops arizona_simple_dai_ops;\n\n#define ARIZONA_FLL_NAME_LEN 20\n\nstruct arizona_fll {\n\tstruct arizona *arizona;\n\tint id;\n\tunsigned int base;\n\tunsigned int vco_mult;\n\n\tunsigned int fout;\n\tint sync_src;\n\tunsigned int sync_freq;\n\tint ref_src;\n\tunsigned int ref_freq;\n\n\tchar lock_name[ARIZONA_FLL_NAME_LEN];\n\tchar clock_ok_name[ARIZONA_FLL_NAME_LEN];\n};\n\nint arizona_dvfs_up(struct snd_soc_component *component, unsigned int flags);\nint arizona_dvfs_down(struct snd_soc_component *component, unsigned int flags);\nint arizona_dvfs_sysclk_ev(struct snd_soc_dapm_widget *w,\n\t\t\t   struct snd_kcontrol *kcontrol, int event);\nvoid arizona_init_dvfs(struct arizona_priv *priv);\n\nint arizona_init_fll(struct arizona *arizona, int id, int base,\n\t\t     int lock_irq, int ok_irq, struct arizona_fll *fll);\nint arizona_set_fll_refclk(struct arizona_fll *fll, int source,\n\t\t\t   unsigned int Fref, unsigned int Fout);\nint arizona_set_fll(struct arizona_fll *fll, int source,\n\t\t    unsigned int Fref, unsigned int Fout);\n\nint arizona_init_spk(struct snd_soc_component *component);\nint arizona_init_gpio(struct snd_soc_component *component);\nint arizona_init_mono(struct snd_soc_component *component);\n\nint arizona_init_common(struct arizona *arizona);\nint arizona_init_vol_limit(struct arizona *arizona);\n\nint arizona_init_spk_irqs(struct arizona *arizona);\nint arizona_free_spk_irqs(struct arizona *arizona);\n\nint arizona_init_dai(struct arizona_priv *priv, int id);\n\nint arizona_set_output_mode(struct snd_soc_component *component, int output,\n\t\t\t    bool diff);\n\nbool arizona_input_analog(struct snd_soc_component *component, int shift);\n\nconst char *arizona_sample_rate_val_to_name(unsigned int rate_val);\n\nstatic inline int arizona_register_notifier(struct snd_soc_component *component,\n\t\t\t\t\t    struct notifier_block *nb,\n\t\t\t\t\t    int (*notify)\n\t\t\t\t\t    (struct notifier_block *nb,\n\t\t\t\t\t    unsigned long action, void *data))\n{\n\tstruct arizona_priv *priv = snd_soc_component_get_drvdata(component);\n\tstruct arizona *arizona = priv->arizona;\n\n\tnb->notifier_call = notify;\n\n\treturn blocking_notifier_chain_register(&arizona->notifier, nb);\n}\n\nstatic inline int arizona_unregister_notifier(struct snd_soc_component *component,\n\t\t\t\t\t      struct notifier_block *nb)\n{\n\tstruct arizona_priv *priv = snd_soc_component_get_drvdata(component);\n\tstruct arizona *arizona = priv->arizona;\n\n\treturn blocking_notifier_chain_unregister(&arizona->notifier, nb);\n}\n\nint arizona_of_get_audio_pdata(struct arizona *arizona);\n\nint arizona_jack_codec_dev_probe(struct arizona_priv *info, struct device *dev);\nint arizona_jack_codec_dev_remove(struct arizona_priv *info);\n\nint arizona_jack_set_jack(struct snd_soc_component *component,\n\t\t\t  struct snd_soc_jack *jack, void *data);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}