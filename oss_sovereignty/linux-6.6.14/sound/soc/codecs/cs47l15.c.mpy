{
  "module_name": "cs47l15.c",
  "hash_id": "814299d9d8e788c5660f43e8e0d83599b5fb2768ac13d45b78898aff60c9b5f8",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/cs47l15.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/device.h>\n#include <linux/delay.h>\n#include <linux/init.h>\n#include <linux/pm.h>\n#include <linux/pm_runtime.h>\n#include <linux/regmap.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n\n#include <linux/irqchip/irq-madera.h>\n#include <linux/mfd/madera/core.h>\n#include <linux/mfd/madera/registers.h>\n\n#include \"madera.h\"\n#include \"wm_adsp.h\"\n\n#define CS47L15_NUM_ADSP 1\n#define CS47L15_MONO_OUTPUTS 1\n\n \n#define CS47L15_ADC_INT_BIAS_MASK\t0x3800\n#define CS47L15_ADC_INT_BIAS_SHIFT\t11\n#define CS47L15_PGA_BIAS_SEL_MASK\t0x03\n#define CS47L15_PGA_BIAS_SEL_SHIFT\t0\n\n#define DRV_NAME \"cs47l15-codec\"\n\nstruct cs47l15 {\n\tstruct madera_priv core;\n\tstruct madera_fll fll[2];\n\n\tbool in1_lp_mode;\n};\n\nstatic const struct cs_dsp_region cs47l15_dsp1_regions[] = {\n\t{ .type = WMFW_ADSP2_PM, .base = 0x080000 },\n\t{ .type = WMFW_ADSP2_ZM, .base = 0x0e0000 },\n\t{ .type = WMFW_ADSP2_XM, .base = 0x0a0000 },\n\t{ .type = WMFW_ADSP2_YM, .base = 0x0c0000 },\n};\n\nstatic const char * const cs47l15_outdemux_texts[] = {\n\t\"HPOUT\",\n\t\"EPOUT\",\n};\n\nstatic SOC_ENUM_SINGLE_DECL(cs47l15_outdemux_enum, SND_SOC_NOPM, 0,\n\t\t\t    cs47l15_outdemux_texts);\n\nstatic const struct snd_kcontrol_new cs47l15_outdemux =\n\tSOC_DAPM_ENUM_EXT(\"HPOUT1 Demux\", cs47l15_outdemux_enum,\n\t\t\t  madera_out1_demux_get, madera_out1_demux_put);\n\nstatic int cs47l15_adsp_power_ev(struct snd_soc_dapm_widget *w,\n\t\t\t\t struct snd_kcontrol *kcontrol,\n\t\t\t\t int event)\n{\n\tstruct snd_soc_component *component =\n\t\tsnd_soc_dapm_to_component(w->dapm);\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\tstruct madera_priv *priv = &cs47l15->core;\n\tstruct madera *madera = priv->madera;\n\tunsigned int freq;\n\tint ret;\n\n\tret = regmap_read(madera->regmap, MADERA_DSP_CLOCK_2, &freq);\n\tif (ret != 0) {\n\t\tdev_err(madera->dev,\n\t\t\t\"Failed to read MADERA_DSP_CLOCK_2: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_PRE_PMU:\n\t\tret = madera_set_adsp_clk(&cs47l15->core, w->shift, freq);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn wm_adsp_early_event(w, kcontrol, event);\n}\n\n#define CS47L15_NG_SRC(name, base) \\\n\tSOC_SINGLE(name \" NG HPOUT1L Switch\",  base,  0, 1, 0), \\\n\tSOC_SINGLE(name \" NG HPOUT1R Switch\",  base,  1, 1, 0), \\\n\tSOC_SINGLE(name \" NG SPKOUTL Switch\",  base,  6, 1, 0), \\\n\tSOC_SINGLE(name \" NG SPKDAT1L Switch\", base,  8, 1, 0), \\\n\tSOC_SINGLE(name \" NG SPKDAT1R Switch\", base,  9, 1, 0)\n\nstatic int cs47l15_in1_adc_get(struct snd_kcontrol *kcontrol,\n\t\t\t       struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.integer.value[0] = !!cs47l15->in1_lp_mode;\n\n\treturn 0;\n}\n\nstatic int cs47l15_in1_adc_put(struct snd_kcontrol *kcontrol,\n\t\t\t       struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component =\n\t\tsnd_soc_kcontrol_component(kcontrol);\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\n\tif (!!ucontrol->value.integer.value[0] == cs47l15->in1_lp_mode)\n\t\treturn 0;\n\n\tswitch (ucontrol->value.integer.value[0]) {\n\tcase 0:\n\t\t \n\t\tsnd_soc_component_update_bits(component, MADERA_DMIC1L_CONTROL,\n\t\t\t\t\t      MADERA_IN1_OSR_MASK,\n\t\t\t\t\t      5 << MADERA_IN1_OSR_SHIFT);\n\t\tsnd_soc_component_update_bits(component, CS47L15_ADC_INT_BIAS,\n\t\t\t\t\t      CS47L15_ADC_INT_BIAS_MASK,\n\t\t\t\t\t      4 << CS47L15_ADC_INT_BIAS_SHIFT);\n\t\tsnd_soc_component_update_bits(component, CS47L15_PGA_BIAS_SEL,\n\t\t\t\t\t      CS47L15_PGA_BIAS_SEL_MASK, 0);\n\t\tcs47l15->in1_lp_mode = false;\n\t\tbreak;\n\tdefault:\n\t\t \n\t\tsnd_soc_component_update_bits(component, MADERA_DMIC1L_CONTROL,\n\t\t\t\t\t      MADERA_IN1_OSR_MASK,\n\t\t\t\t\t      4 << MADERA_IN1_OSR_SHIFT);\n\t\tsnd_soc_component_update_bits(component, CS47L15_ADC_INT_BIAS,\n\t\t\t\t\t      CS47L15_ADC_INT_BIAS_MASK,\n\t\t\t\t\t      1 << CS47L15_ADC_INT_BIAS_SHIFT);\n\t\tsnd_soc_component_update_bits(component, CS47L15_PGA_BIAS_SEL,\n\t\t\t\t\t      CS47L15_PGA_BIAS_SEL_MASK,\n\t\t\t\t\t      3 << CS47L15_PGA_BIAS_SEL_SHIFT);\n\t\tcs47l15->in1_lp_mode = true;\n\t\tbreak;\n\t}\n\n\treturn 1;\n}\n\nstatic const struct snd_kcontrol_new cs47l15_snd_controls[] = {\nSOC_ENUM(\"IN1 OSR\", madera_in_dmic_osr[0]),\nSOC_ENUM(\"IN2 OSR\", madera_in_dmic_osr[1]),\n\nSOC_SINGLE_RANGE_TLV(\"IN1L Volume\", MADERA_IN1L_CONTROL,\n\t\t     MADERA_IN1L_PGA_VOL_SHIFT, 0x40, 0x5f, 0, madera_ana_tlv),\nSOC_SINGLE_RANGE_TLV(\"IN1R Volume\", MADERA_IN1R_CONTROL,\n\t\t     MADERA_IN1R_PGA_VOL_SHIFT, 0x40, 0x5f, 0, madera_ana_tlv),\n\nSOC_ENUM(\"IN HPF Cutoff Frequency\", madera_in_hpf_cut_enum),\n\nSOC_SINGLE(\"IN1L HPF Switch\", MADERA_IN1L_CONTROL, MADERA_IN1L_HPF_SHIFT, 1, 0),\nSOC_SINGLE(\"IN1R HPF Switch\", MADERA_IN1R_CONTROL, MADERA_IN1R_HPF_SHIFT, 1, 0),\nSOC_SINGLE(\"IN2L HPF Switch\", MADERA_IN2L_CONTROL, MADERA_IN2L_HPF_SHIFT, 1, 0),\nSOC_SINGLE(\"IN2R HPF Switch\", MADERA_IN2R_CONTROL, MADERA_IN2R_HPF_SHIFT, 1, 0),\n\nSOC_SINGLE_TLV(\"IN1L Digital Volume\", MADERA_ADC_DIGITAL_VOLUME_1L,\n\t       MADERA_IN1L_DIG_VOL_SHIFT, 0xbf, 0, madera_digital_tlv),\nSOC_SINGLE_TLV(\"IN1R Digital Volume\", MADERA_ADC_DIGITAL_VOLUME_1R,\n\t       MADERA_IN1R_DIG_VOL_SHIFT, 0xbf, 0, madera_digital_tlv),\nSOC_SINGLE_TLV(\"IN2L Digital Volume\", MADERA_ADC_DIGITAL_VOLUME_2L,\n\t       MADERA_IN2L_DIG_VOL_SHIFT, 0xbf, 0, madera_digital_tlv),\nSOC_SINGLE_TLV(\"IN2R Digital Volume\", MADERA_ADC_DIGITAL_VOLUME_2R,\n\t       MADERA_IN2R_DIG_VOL_SHIFT, 0xbf, 0, madera_digital_tlv),\n\nSOC_ENUM(\"Input Ramp Up\", madera_in_vi_ramp),\nSOC_ENUM(\"Input Ramp Down\", madera_in_vd_ramp),\n\nMADERA_MIXER_CONTROLS(\"EQ1\", MADERA_EQ1MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"EQ2\", MADERA_EQ2MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"EQ3\", MADERA_EQ3MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"EQ4\", MADERA_EQ4MIX_INPUT_1_SOURCE),\n\nMADERA_EQ_CONTROL(\"EQ1 Coefficients\", MADERA_EQ1_2),\nSOC_SINGLE_TLV(\"EQ1 B1 Volume\", MADERA_EQ1_1, MADERA_EQ1_B1_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ1 B2 Volume\", MADERA_EQ1_1, MADERA_EQ1_B2_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ1 B3 Volume\", MADERA_EQ1_1, MADERA_EQ1_B3_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ1 B4 Volume\", MADERA_EQ1_2, MADERA_EQ1_B4_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ1 B5 Volume\", MADERA_EQ1_2, MADERA_EQ1_B5_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\n\nMADERA_EQ_CONTROL(\"EQ2 Coefficients\", MADERA_EQ2_2),\nSOC_SINGLE_TLV(\"EQ2 B1 Volume\", MADERA_EQ2_1, MADERA_EQ2_B1_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ2 B2 Volume\", MADERA_EQ2_1, MADERA_EQ2_B2_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ2 B3 Volume\", MADERA_EQ2_1, MADERA_EQ2_B3_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ2 B4 Volume\", MADERA_EQ2_2, MADERA_EQ2_B4_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ2 B5 Volume\", MADERA_EQ2_2, MADERA_EQ2_B5_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\n\nMADERA_EQ_CONTROL(\"EQ3 Coefficients\", MADERA_EQ3_2),\nSOC_SINGLE_TLV(\"EQ3 B1 Volume\", MADERA_EQ3_1, MADERA_EQ3_B1_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ3 B2 Volume\", MADERA_EQ3_1, MADERA_EQ3_B2_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ3 B3 Volume\", MADERA_EQ3_1, MADERA_EQ3_B3_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ3 B4 Volume\", MADERA_EQ3_2, MADERA_EQ3_B4_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ3 B5 Volume\", MADERA_EQ3_2, MADERA_EQ3_B5_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\n\nMADERA_EQ_CONTROL(\"EQ4 Coefficients\", MADERA_EQ4_2),\nSOC_SINGLE_TLV(\"EQ4 B1 Volume\", MADERA_EQ4_1, MADERA_EQ4_B1_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ4 B2 Volume\", MADERA_EQ4_1, MADERA_EQ4_B2_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ4 B3 Volume\", MADERA_EQ4_1, MADERA_EQ4_B3_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ4 B4 Volume\", MADERA_EQ4_2, MADERA_EQ4_B4_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\nSOC_SINGLE_TLV(\"EQ4 B5 Volume\", MADERA_EQ4_2, MADERA_EQ4_B5_GAIN_SHIFT,\n\t       24, 0, madera_eq_tlv),\n\nMADERA_MIXER_CONTROLS(\"DRC1L\", MADERA_DRC1LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"DRC1R\", MADERA_DRC1RMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"DRC2L\", MADERA_DRC2LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"DRC2R\", MADERA_DRC2RMIX_INPUT_1_SOURCE),\n\nSND_SOC_BYTES_MASK(\"DRC1\", MADERA_DRC1_CTRL1, 5,\n\t\t   MADERA_DRC1R_ENA | MADERA_DRC1L_ENA),\nSND_SOC_BYTES_MASK(\"DRC2\", MADERA_DRC2_CTRL1, 5,\n\t\t   MADERA_DRC2R_ENA | MADERA_DRC2L_ENA),\n\nMADERA_MIXER_CONTROLS(\"LHPF1\", MADERA_HPLP1MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"LHPF2\", MADERA_HPLP2MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"LHPF3\", MADERA_HPLP3MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"LHPF4\", MADERA_HPLP4MIX_INPUT_1_SOURCE),\n\nMADERA_LHPF_CONTROL(\"LHPF1 Coefficients\", MADERA_HPLPF1_2),\nMADERA_LHPF_CONTROL(\"LHPF2 Coefficients\", MADERA_HPLPF2_2),\nMADERA_LHPF_CONTROL(\"LHPF3 Coefficients\", MADERA_HPLPF3_2),\nMADERA_LHPF_CONTROL(\"LHPF4 Coefficients\", MADERA_HPLPF4_2),\n\nSOC_ENUM(\"LHPF1 Mode\", madera_lhpf1_mode),\nSOC_ENUM(\"LHPF2 Mode\", madera_lhpf2_mode),\nSOC_ENUM(\"LHPF3 Mode\", madera_lhpf3_mode),\nSOC_ENUM(\"LHPF4 Mode\", madera_lhpf4_mode),\n\nMADERA_RATE_ENUM(\"ISRC1 FSL\", madera_isrc_fsl[0]),\nMADERA_RATE_ENUM(\"ISRC2 FSL\", madera_isrc_fsl[1]),\nMADERA_RATE_ENUM(\"ISRC1 FSH\", madera_isrc_fsh[0]),\nMADERA_RATE_ENUM(\"ISRC2 FSH\", madera_isrc_fsh[1]),\n\nWM_ADSP2_PRELOAD_SWITCH(\"DSP1\", 1),\n\nMADERA_MIXER_CONTROLS(\"DSP1L\", MADERA_DSP1LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"DSP1R\", MADERA_DSP1RMIX_INPUT_1_SOURCE),\n\nSOC_SINGLE_TLV(\"Noise Generator Volume\", MADERA_COMFORT_NOISE_GENERATOR,\n\t       MADERA_NOISE_GEN_GAIN_SHIFT, 0x16, 0, madera_noise_tlv),\n\nMADERA_MIXER_CONTROLS(\"HPOUT1L\", MADERA_OUT1LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"HPOUT1R\", MADERA_OUT1RMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"SPKOUTL\", MADERA_OUT4LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"SPKDAT1L\", MADERA_OUT5LMIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"SPKDAT1R\", MADERA_OUT5RMIX_INPUT_1_SOURCE),\n\nSOC_SINGLE(\"HPOUT1 SC Protect Switch\", MADERA_HP1_SHORT_CIRCUIT_CTRL,\n\t   MADERA_HP1_SC_ENA_SHIFT, 1, 0),\n\nSOC_SINGLE(\"SPKDAT1 High Performance Switch\", MADERA_OUTPUT_PATH_CONFIG_5L,\n\t   MADERA_OUT5_OSR_SHIFT, 1, 0),\n\nSOC_DOUBLE_R(\"HPOUT1 Digital Switch\", MADERA_DAC_DIGITAL_VOLUME_1L,\n\t     MADERA_DAC_DIGITAL_VOLUME_1R, MADERA_OUT1L_MUTE_SHIFT, 1, 1),\nSOC_SINGLE(\"Speaker Digital Switch\", MADERA_DAC_DIGITAL_VOLUME_4L,\n\t   MADERA_OUT4L_MUTE_SHIFT, 1, 1),\nSOC_DOUBLE_R(\"SPKDAT1 Digital Switch\", MADERA_DAC_DIGITAL_VOLUME_5L,\n\t     MADERA_DAC_DIGITAL_VOLUME_5R, MADERA_OUT5L_MUTE_SHIFT, 1, 1),\n\nSOC_DOUBLE_R_TLV(\"HPOUT1 Digital Volume\", MADERA_DAC_DIGITAL_VOLUME_1L,\n\t\t MADERA_DAC_DIGITAL_VOLUME_1R, MADERA_OUT1L_VOL_SHIFT,\n\t\t 0xbf, 0, madera_digital_tlv),\nSOC_SINGLE_TLV(\"Speaker Digital Volume\", MADERA_DAC_DIGITAL_VOLUME_4L,\n\t       MADERA_OUT4L_VOL_SHIFT, 0xbf, 0, madera_digital_tlv),\nSOC_DOUBLE_R_TLV(\"SPKDAT1 Digital Volume\", MADERA_DAC_DIGITAL_VOLUME_5L,\n\t\t MADERA_DAC_DIGITAL_VOLUME_5R, MADERA_OUT5L_VOL_SHIFT,\n\t\t 0xbf, 0, madera_digital_tlv),\n\nSOC_DOUBLE(\"SPKDAT1 Switch\", MADERA_PDM_SPK1_CTRL_1, MADERA_SPK1L_MUTE_SHIFT,\n\t   MADERA_SPK1R_MUTE_SHIFT, 1, 1),\n\nSOC_ENUM(\"Output Ramp Up\", madera_out_vi_ramp),\nSOC_ENUM(\"Output Ramp Down\", madera_out_vd_ramp),\n\nSOC_SINGLE(\"Noise Gate Switch\", MADERA_NOISE_GATE_CONTROL,\n\t   MADERA_NGATE_ENA_SHIFT, 1, 0),\nSOC_SINGLE_TLV(\"Noise Gate Threshold Volume\", MADERA_NOISE_GATE_CONTROL,\n\t       MADERA_NGATE_THR_SHIFT, 7, 1, madera_ng_tlv),\nSOC_ENUM(\"Noise Gate Hold\", madera_ng_hold),\n\nSOC_SINGLE_BOOL_EXT(\"IN1 LP Mode Switch\", 0,\n\t\t    cs47l15_in1_adc_get, cs47l15_in1_adc_put),\n\nCS47L15_NG_SRC(\"HPOUT1L\", MADERA_NOISE_GATE_SELECT_1L),\nCS47L15_NG_SRC(\"HPOUT1R\", MADERA_NOISE_GATE_SELECT_1R),\nCS47L15_NG_SRC(\"SPKOUTL\", MADERA_NOISE_GATE_SELECT_4L),\nCS47L15_NG_SRC(\"SPKDAT1L\", MADERA_NOISE_GATE_SELECT_5L),\nCS47L15_NG_SRC(\"SPKDAT1R\", MADERA_NOISE_GATE_SELECT_5R),\n\nMADERA_MIXER_CONTROLS(\"AIF1TX1\", MADERA_AIF1TX1MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF1TX2\", MADERA_AIF1TX2MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF1TX3\", MADERA_AIF1TX3MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF1TX4\", MADERA_AIF1TX4MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF1TX5\", MADERA_AIF1TX5MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF1TX6\", MADERA_AIF1TX6MIX_INPUT_1_SOURCE),\n\nMADERA_MIXER_CONTROLS(\"AIF2TX1\", MADERA_AIF2TX1MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF2TX2\", MADERA_AIF2TX2MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF2TX3\", MADERA_AIF2TX3MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF2TX4\", MADERA_AIF2TX4MIX_INPUT_1_SOURCE),\n\nMADERA_MIXER_CONTROLS(\"AIF3TX1\", MADERA_AIF3TX1MIX_INPUT_1_SOURCE),\nMADERA_MIXER_CONTROLS(\"AIF3TX2\", MADERA_AIF3TX2MIX_INPUT_1_SOURCE),\n\nMADERA_GAINMUX_CONTROLS(\"SPDIF1TX1\", MADERA_SPDIF1TX1MIX_INPUT_1_SOURCE),\nMADERA_GAINMUX_CONTROLS(\"SPDIF1TX2\", MADERA_SPDIF1TX2MIX_INPUT_1_SOURCE),\n\nWM_ADSP_FW_CONTROL(\"DSP1\", 0),\n};\n\nMADERA_MIXER_ENUMS(EQ1, MADERA_EQ1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(EQ2, MADERA_EQ2MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(EQ3, MADERA_EQ3MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(EQ4, MADERA_EQ4MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(DRC1L, MADERA_DRC1LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(DRC1R, MADERA_DRC1RMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(DRC2L, MADERA_DRC2LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(DRC2R, MADERA_DRC2RMIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(LHPF1, MADERA_HPLP1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(LHPF2, MADERA_HPLP2MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(LHPF3, MADERA_HPLP3MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(LHPF4, MADERA_HPLP4MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(DSP1L, MADERA_DSP1LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(DSP1R, MADERA_DSP1RMIX_INPUT_1_SOURCE);\nMADERA_DSP_AUX_ENUMS(DSP1, MADERA_DSP1AUX1MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(PWM1, MADERA_PWM1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(PWM2, MADERA_PWM2MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(OUT1L, MADERA_OUT1LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(OUT1R, MADERA_OUT1RMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(SPKOUTL, MADERA_OUT4LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(SPKDAT1L, MADERA_OUT5LMIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(SPKDAT1R, MADERA_OUT5RMIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(AIF1TX1, MADERA_AIF1TX1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF1TX2, MADERA_AIF1TX2MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF1TX3, MADERA_AIF1TX3MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF1TX4, MADERA_AIF1TX4MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF1TX5, MADERA_AIF1TX5MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF1TX6, MADERA_AIF1TX6MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(AIF2TX1, MADERA_AIF2TX1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF2TX2, MADERA_AIF2TX2MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF2TX3, MADERA_AIF2TX3MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF2TX4, MADERA_AIF2TX4MIX_INPUT_1_SOURCE);\n\nMADERA_MIXER_ENUMS(AIF3TX1, MADERA_AIF3TX1MIX_INPUT_1_SOURCE);\nMADERA_MIXER_ENUMS(AIF3TX2, MADERA_AIF3TX2MIX_INPUT_1_SOURCE);\n\nMADERA_MUX_ENUMS(SPD1TX1, MADERA_SPDIF1TX1MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(SPD1TX2, MADERA_SPDIF1TX2MIX_INPUT_1_SOURCE);\n\nMADERA_MUX_ENUMS(ISRC1INT1, MADERA_ISRC1INT1MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1INT2, MADERA_ISRC1INT2MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1INT3, MADERA_ISRC1INT3MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1INT4, MADERA_ISRC1INT4MIX_INPUT_1_SOURCE);\n\nMADERA_MUX_ENUMS(ISRC1DEC1, MADERA_ISRC1DEC1MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1DEC2, MADERA_ISRC1DEC2MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1DEC3, MADERA_ISRC1DEC3MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC1DEC4, MADERA_ISRC1DEC4MIX_INPUT_1_SOURCE);\n\nMADERA_MUX_ENUMS(ISRC2INT1, MADERA_ISRC2INT1MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2INT2, MADERA_ISRC2INT2MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2INT3, MADERA_ISRC2INT3MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2INT4, MADERA_ISRC2INT4MIX_INPUT_1_SOURCE);\n\nMADERA_MUX_ENUMS(ISRC2DEC1, MADERA_ISRC2DEC1MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2DEC2, MADERA_ISRC2DEC2MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2DEC3, MADERA_ISRC2DEC3MIX_INPUT_1_SOURCE);\nMADERA_MUX_ENUMS(ISRC2DEC4, MADERA_ISRC2DEC4MIX_INPUT_1_SOURCE);\n\nstatic const char * const cs47l15_aec_loopback_texts[] = {\n\t\"HPOUT1L\", \"HPOUT1R\", \"SPKOUTL\", \"SPKDAT1L\", \"SPKDAT1R\",\n};\n\nstatic const unsigned int cs47l15_aec_loopback_values[] = {\n\t0, 1, 6, 8, 9,\n};\n\nstatic const struct soc_enum cs47l15_aec1_loopback =\n\tSOC_VALUE_ENUM_SINGLE(MADERA_DAC_AEC_CONTROL_1,\n\t\t\t      MADERA_AEC1_LOOPBACK_SRC_SHIFT, 0xf,\n\t\t\t      ARRAY_SIZE(cs47l15_aec_loopback_texts),\n\t\t\t      cs47l15_aec_loopback_texts,\n\t\t\t      cs47l15_aec_loopback_values);\n\nstatic const struct soc_enum cs47l15_aec2_loopback =\n\tSOC_VALUE_ENUM_SINGLE(MADERA_DAC_AEC_CONTROL_2,\n\t\t\t      MADERA_AEC2_LOOPBACK_SRC_SHIFT, 0xf,\n\t\t\t      ARRAY_SIZE(cs47l15_aec_loopback_texts),\n\t\t\t      cs47l15_aec_loopback_texts,\n\t\t\t      cs47l15_aec_loopback_values);\n\nstatic const struct snd_kcontrol_new cs47l15_aec_loopback_mux[] = {\n\tSOC_DAPM_ENUM(\"AEC1 Loopback\", cs47l15_aec1_loopback),\n\tSOC_DAPM_ENUM(\"AEC2 Loopback\", cs47l15_aec2_loopback),\n};\n\nstatic const struct snd_soc_dapm_widget cs47l15_dapm_widgets[] = {\nSND_SOC_DAPM_SUPPLY(\"SYSCLK\", MADERA_SYSTEM_CLOCK_1, MADERA_SYSCLK_ENA_SHIFT,\n\t\t    0, madera_sysclk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU |\n\t\t    SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"OPCLK\", MADERA_OUTPUT_SYSTEM_CLOCK,\n\t\t    MADERA_OPCLK_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"DSPCLK\", MADERA_DSP_CLOCK_1, MADERA_DSP_CLK_ENA_SHIFT,\n\t\t    0, madera_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\nSND_SOC_DAPM_REGULATOR_SUPPLY(\"CPVDD1\", 20, 0),\nSND_SOC_DAPM_REGULATOR_SUPPLY(\"MICVDD\", 0, SND_SOC_DAPM_REGULATOR_BYPASS),\nSND_SOC_DAPM_REGULATOR_SUPPLY(\"SPKVDD\", 0, 0),\n\nSND_SOC_DAPM_SUPPLY(\"MICBIAS1\", MADERA_MIC_BIAS_CTRL_1,\n\t\t    MADERA_MICB1_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_SUPPLY(\"MICBIAS1A\", MADERA_MIC_BIAS_CTRL_5,\n\t\t    MADERA_MICB1A_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"MICBIAS1B\", MADERA_MIC_BIAS_CTRL_5,\n\t\t    MADERA_MICB1B_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_SUPPLY(\"MICBIAS1C\", MADERA_MIC_BIAS_CTRL_5,\n\t\t    MADERA_MICB1C_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_SUPPLY(\"FXCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_FX, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"ISRC1CLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_ISRC1, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"ISRC2CLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_ISRC2, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"OUTCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_OUT, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"SPDCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_SPD, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"DSP1CLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_DSP1, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"AIF1TXCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_AIF1, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"AIF2TXCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_AIF2, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"AIF3TXCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_AIF3, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\nSND_SOC_DAPM_SUPPLY(\"PWMCLK\", SND_SOC_NOPM,\n\t\t    MADERA_DOM_GRP_PWM, 0,\n\t\t    madera_domain_clk_ev,\n\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\nSND_SOC_DAPM_SIGGEN(\"TONE\"),\nSND_SOC_DAPM_SIGGEN(\"NOISE\"),\n\nSND_SOC_DAPM_INPUT(\"IN1ALN\"),\nSND_SOC_DAPM_INPUT(\"IN1ALP\"),\nSND_SOC_DAPM_INPUT(\"IN1BLN\"),\nSND_SOC_DAPM_INPUT(\"IN1BLP\"),\nSND_SOC_DAPM_INPUT(\"IN1ARN\"),\nSND_SOC_DAPM_INPUT(\"IN1ARP\"),\nSND_SOC_DAPM_INPUT(\"IN1BRN\"),\nSND_SOC_DAPM_INPUT(\"IN1BRP\"),\nSND_SOC_DAPM_INPUT(\"IN2N\"),\nSND_SOC_DAPM_INPUT(\"IN2P\"),\nSND_SOC_DAPM_INPUT(\"SPKRXDAT\"),\n\nSND_SOC_DAPM_MUX(\"IN1L Analog Mux\", SND_SOC_NOPM, 0, 0, &madera_inmux[0]),\nSND_SOC_DAPM_MUX(\"IN1R Analog Mux\", SND_SOC_NOPM, 0, 0, &madera_inmux[1]),\n\nSND_SOC_DAPM_MUX(\"IN1L Mode\", SND_SOC_NOPM, 0, 0, &madera_inmode[0]),\nSND_SOC_DAPM_MUX(\"IN1R Mode\", SND_SOC_NOPM, 0, 0, &madera_inmode[0]),\n\nSND_SOC_DAPM_MUX(\"IN2L Mode\", SND_SOC_NOPM, 0, 0, &madera_inmode[1]),\nSND_SOC_DAPM_MUX(\"IN2R Mode\", SND_SOC_NOPM, 0, 0, &madera_inmode[1]),\n\nSND_SOC_DAPM_OUTPUT(\"DRC1 Signal Activity\"),\nSND_SOC_DAPM_OUTPUT(\"DRC2 Signal Activity\"),\n\nSND_SOC_DAPM_OUTPUT(\"DSP Trigger Out\"),\n\nSND_SOC_DAPM_DEMUX(\"HPOUT1 Demux\", SND_SOC_NOPM, 0, 0, &cs47l15_outdemux),\nSND_SOC_DAPM_MUX(\"HPOUT1 Mono Mux\", SND_SOC_NOPM, 0, 0, &cs47l15_outdemux),\n\nSND_SOC_DAPM_PGA(\"PWM1 Driver\", MADERA_PWM_DRIVE_1, MADERA_PWM1_ENA_SHIFT,\n\t\t 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"PWM2 Driver\", MADERA_PWM_DRIVE_1, MADERA_PWM2_ENA_SHIFT,\n\t\t 0, NULL, 0),\n\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX1\", NULL, 0,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX2\", NULL, 1,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX3\", NULL, 2,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX4\", NULL, 3,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX4_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX5\", NULL, 4,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX5_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF1TX6\", NULL, 5,\n\t\t     MADERA_AIF1_TX_ENABLES, MADERA_AIF1TX6_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_AIF_OUT(\"AIF2TX1\", NULL, 0,\n\t\t     MADERA_AIF2_TX_ENABLES, MADERA_AIF2TX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF2TX2\", NULL, 1,\n\t\t     MADERA_AIF2_TX_ENABLES, MADERA_AIF2TX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF2TX3\", NULL, 2,\n\t\t     MADERA_AIF2_TX_ENABLES, MADERA_AIF2TX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF2TX4\", NULL, 3,\n\t\t     MADERA_AIF2_TX_ENABLES, MADERA_AIF2TX4_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_AIF_OUT(\"AIF3TX1\", NULL, 0,\n\t\t     MADERA_AIF3_TX_ENABLES, MADERA_AIF3TX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_OUT(\"AIF3TX2\", NULL, 1,\n\t\t     MADERA_AIF3_TX_ENABLES, MADERA_AIF3TX2_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_PGA_E(\"OUT1L\", SND_SOC_NOPM,\n\t\t   MADERA_OUT1L_ENA_SHIFT, 0, NULL, 0, madera_hp_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"OUT1R\", SND_SOC_NOPM,\n\t\t   MADERA_OUT1R_ENA_SHIFT, 0, NULL, 0, madera_hp_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"OUT4L\", SND_SOC_NOPM,\n\t\t   MADERA_OUT4L_ENA_SHIFT, 0, NULL, 0, madera_spk_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"OUT5L\", MADERA_OUTPUT_ENABLES_1,\n\t\t   MADERA_OUT5L_ENA_SHIFT, 0, NULL, 0, madera_out_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"OUT5R\", MADERA_OUTPUT_ENABLES_1,\n\t\t   MADERA_OUT5R_ENA_SHIFT, 0, NULL, 0, madera_out_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\nSND_SOC_DAPM_PGA(\"SPD1TX1\", MADERA_SPD1_TX_CONTROL,\n\t\t MADERA_SPD1_VAL1_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"SPD1TX2\", MADERA_SPD1_TX_CONTROL,\n\t\t MADERA_SPD1_VAL2_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_OUT_DRV(\"SPD1\", MADERA_SPD1_TX_CONTROL,\n\t\t     MADERA_SPD1_ENA_SHIFT, 0, NULL, 0),\n\n \n\nSND_SOC_DAPM_PGA(\"Noise Generator\", MADERA_COMFORT_NOISE_GENERATOR,\n\t\t MADERA_NOISE_GEN_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"Tone Generator 1\", MADERA_TONE_GENERATOR_1,\n\t\t MADERA_TONE1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"Tone Generator 2\", MADERA_TONE_GENERATOR_1,\n\t\t MADERA_TONE2_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_SIGGEN(\"HAPTICS\"),\n\nSND_SOC_DAPM_MUX(\"AEC1 Loopback\", MADERA_DAC_AEC_CONTROL_1,\n\t\t MADERA_AEC1_LOOPBACK_ENA_SHIFT, 0,\n\t\t &cs47l15_aec_loopback_mux[0]),\nSND_SOC_DAPM_MUX(\"AEC2 Loopback\", MADERA_DAC_AEC_CONTROL_2,\n\t\t MADERA_AEC2_LOOPBACK_ENA_SHIFT, 0,\n\t\t &cs47l15_aec_loopback_mux[1]),\n\nSND_SOC_DAPM_PGA_E(\"IN1L\", MADERA_INPUT_ENABLES, MADERA_IN1L_ENA_SHIFT,\n\t\t   0, NULL, 0, madera_in_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"IN1R\", MADERA_INPUT_ENABLES, MADERA_IN1R_ENA_SHIFT,\n\t\t   0, NULL, 0, madera_in_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"IN2L\", MADERA_INPUT_ENABLES, MADERA_IN2L_ENA_SHIFT,\n\t\t   0, NULL, 0, madera_in_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\nSND_SOC_DAPM_PGA_E(\"IN2R\", MADERA_INPUT_ENABLES, MADERA_IN2R_ENA_SHIFT,\n\t\t   0, NULL, 0, madera_in_ev,\n\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMD |\n\t\t   SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMU),\n\nSND_SOC_DAPM_AIF_IN(\"AIF1RX1\", NULL, 0,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX2\", NULL, 1,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX3\", NULL, 2,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX4\", NULL, 3,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX4_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX5\", NULL, 4,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX5_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF1RX6\", NULL, 5,\n\t\t    MADERA_AIF1_RX_ENABLES, MADERA_AIF1RX6_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_AIF_IN(\"AIF2RX1\", NULL, 0,\n\t\t    MADERA_AIF2_RX_ENABLES, MADERA_AIF2RX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF2RX2\", NULL, 1,\n\t\t    MADERA_AIF2_RX_ENABLES, MADERA_AIF2RX2_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF2RX3\", NULL, 2,\n\t\t    MADERA_AIF2_RX_ENABLES, MADERA_AIF2RX3_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF2RX4\", NULL, 3,\n\t\t    MADERA_AIF2_RX_ENABLES, MADERA_AIF2RX4_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_AIF_IN(\"AIF3RX1\", NULL, 0,\n\t\t    MADERA_AIF3_RX_ENABLES, MADERA_AIF3RX1_ENA_SHIFT, 0),\nSND_SOC_DAPM_AIF_IN(\"AIF3RX2\", NULL, 1,\n\t\t    MADERA_AIF3_RX_ENABLES, MADERA_AIF3RX2_ENA_SHIFT, 0),\n\nSND_SOC_DAPM_PGA(\"EQ1\", MADERA_EQ1_1, MADERA_EQ1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"EQ2\", MADERA_EQ2_1, MADERA_EQ2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"EQ3\", MADERA_EQ3_1, MADERA_EQ3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"EQ4\", MADERA_EQ4_1, MADERA_EQ4_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"DRC1L\", MADERA_DRC1_CTRL1, MADERA_DRC1L_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"DRC1R\", MADERA_DRC1_CTRL1, MADERA_DRC1R_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"DRC2L\", MADERA_DRC2_CTRL1, MADERA_DRC2L_ENA_SHIFT, 0,\n\t\t NULL, 0),\nSND_SOC_DAPM_PGA(\"DRC2R\", MADERA_DRC2_CTRL1, MADERA_DRC2R_ENA_SHIFT, 0,\n\t\t NULL, 0),\n\nSND_SOC_DAPM_PGA(\"LHPF1\", MADERA_HPLPF1_1, MADERA_LHPF1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"LHPF2\", MADERA_HPLPF2_1, MADERA_LHPF2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"LHPF3\", MADERA_HPLPF3_1, MADERA_LHPF3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"LHPF4\", MADERA_HPLPF4_1, MADERA_LHPF4_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"ISRC1DEC1\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_DEC1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1DEC2\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_DEC2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1DEC3\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_DEC3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1DEC4\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_DEC4_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"ISRC1INT1\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_INT1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1INT2\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_INT2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1INT3\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_INT3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC1INT4\", MADERA_ISRC_1_CTRL_3,\n\t\t MADERA_ISRC1_INT4_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"ISRC2DEC1\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_DEC1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2DEC2\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_DEC2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2DEC3\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_DEC3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2DEC4\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_DEC4_ENA_SHIFT, 0, NULL, 0),\n\nSND_SOC_DAPM_PGA(\"ISRC2INT1\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_INT1_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2INT2\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_INT2_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2INT3\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_INT3_ENA_SHIFT, 0, NULL, 0),\nSND_SOC_DAPM_PGA(\"ISRC2INT4\", MADERA_ISRC_2_CTRL_3,\n\t\t MADERA_ISRC2_INT4_ENA_SHIFT, 0, NULL, 0),\n\nWM_ADSP2(\"DSP1\", 0, cs47l15_adsp_power_ev),\n\n \n\nMADERA_MIXER_WIDGETS(EQ1, \"EQ1\"),\nMADERA_MIXER_WIDGETS(EQ2, \"EQ2\"),\nMADERA_MIXER_WIDGETS(EQ3, \"EQ3\"),\nMADERA_MIXER_WIDGETS(EQ4, \"EQ4\"),\n\nMADERA_MIXER_WIDGETS(DRC1L, \"DRC1L\"),\nMADERA_MIXER_WIDGETS(DRC1R, \"DRC1R\"),\nMADERA_MIXER_WIDGETS(DRC2L, \"DRC2L\"),\nMADERA_MIXER_WIDGETS(DRC2R, \"DRC2R\"),\n\nSND_SOC_DAPM_SWITCH(\"DRC1 Activity Output\", SND_SOC_NOPM, 0, 0,\n\t\t    &madera_drc_activity_output_mux[0]),\nSND_SOC_DAPM_SWITCH(\"DRC2 Activity Output\", SND_SOC_NOPM, 0, 0,\n\t\t    &madera_drc_activity_output_mux[1]),\n\nMADERA_MIXER_WIDGETS(LHPF1, \"LHPF1\"),\nMADERA_MIXER_WIDGETS(LHPF2, \"LHPF2\"),\nMADERA_MIXER_WIDGETS(LHPF3, \"LHPF3\"),\nMADERA_MIXER_WIDGETS(LHPF4, \"LHPF4\"),\n\nMADERA_MIXER_WIDGETS(PWM1, \"PWM1\"),\nMADERA_MIXER_WIDGETS(PWM2, \"PWM2\"),\n\nMADERA_MIXER_WIDGETS(OUT1L, \"HPOUT1L\"),\nMADERA_MIXER_WIDGETS(OUT1R, \"HPOUT1R\"),\nMADERA_MIXER_WIDGETS(SPKOUTL, \"SPKOUTL\"),\nMADERA_MIXER_WIDGETS(SPKDAT1L, \"SPKDAT1L\"),\nMADERA_MIXER_WIDGETS(SPKDAT1R, \"SPKDAT1R\"),\n\nMADERA_MIXER_WIDGETS(AIF1TX1, \"AIF1TX1\"),\nMADERA_MIXER_WIDGETS(AIF1TX2, \"AIF1TX2\"),\nMADERA_MIXER_WIDGETS(AIF1TX3, \"AIF1TX3\"),\nMADERA_MIXER_WIDGETS(AIF1TX4, \"AIF1TX4\"),\nMADERA_MIXER_WIDGETS(AIF1TX5, \"AIF1TX5\"),\nMADERA_MIXER_WIDGETS(AIF1TX6, \"AIF1TX6\"),\n\nMADERA_MIXER_WIDGETS(AIF2TX1, \"AIF2TX1\"),\nMADERA_MIXER_WIDGETS(AIF2TX2, \"AIF2TX2\"),\nMADERA_MIXER_WIDGETS(AIF2TX3, \"AIF2TX3\"),\nMADERA_MIXER_WIDGETS(AIF2TX4, \"AIF2TX4\"),\n\nMADERA_MIXER_WIDGETS(AIF3TX1, \"AIF3TX1\"),\nMADERA_MIXER_WIDGETS(AIF3TX2, \"AIF3TX2\"),\n\nMADERA_MUX_WIDGETS(SPD1TX1, \"SPDIF1TX1\"),\nMADERA_MUX_WIDGETS(SPD1TX2, \"SPDIF1TX2\"),\n\nMADERA_DSP_WIDGETS(DSP1, \"DSP1\"),\n\nSND_SOC_DAPM_SWITCH(\"DSP1 Trigger Output\", SND_SOC_NOPM, 0, 0,\n\t\t    &madera_dsp_trigger_output_mux[0]),\n\nMADERA_MUX_WIDGETS(ISRC1DEC1, \"ISRC1DEC1\"),\nMADERA_MUX_WIDGETS(ISRC1DEC2, \"ISRC1DEC2\"),\nMADERA_MUX_WIDGETS(ISRC1DEC3, \"ISRC1DEC3\"),\nMADERA_MUX_WIDGETS(ISRC1DEC4, \"ISRC1DEC4\"),\n\nMADERA_MUX_WIDGETS(ISRC1INT1, \"ISRC1INT1\"),\nMADERA_MUX_WIDGETS(ISRC1INT2, \"ISRC1INT2\"),\nMADERA_MUX_WIDGETS(ISRC1INT3, \"ISRC1INT3\"),\nMADERA_MUX_WIDGETS(ISRC1INT4, \"ISRC1INT4\"),\n\nMADERA_MUX_WIDGETS(ISRC2DEC1, \"ISRC2DEC1\"),\nMADERA_MUX_WIDGETS(ISRC2DEC2, \"ISRC2DEC2\"),\nMADERA_MUX_WIDGETS(ISRC2DEC3, \"ISRC2DEC3\"),\nMADERA_MUX_WIDGETS(ISRC2DEC4, \"ISRC2DEC4\"),\n\nMADERA_MUX_WIDGETS(ISRC2INT1, \"ISRC2INT1\"),\nMADERA_MUX_WIDGETS(ISRC2INT2, \"ISRC2INT2\"),\nMADERA_MUX_WIDGETS(ISRC2INT3, \"ISRC2INT3\"),\nMADERA_MUX_WIDGETS(ISRC2INT4, \"ISRC2INT4\"),\n\nSND_SOC_DAPM_OUTPUT(\"HPOUTL\"),\nSND_SOC_DAPM_OUTPUT(\"HPOUTR\"),\nSND_SOC_DAPM_OUTPUT(\"EPOUTP\"),\nSND_SOC_DAPM_OUTPUT(\"EPOUTN\"),\nSND_SOC_DAPM_OUTPUT(\"SPKOUTN\"),\nSND_SOC_DAPM_OUTPUT(\"SPKOUTP\"),\nSND_SOC_DAPM_OUTPUT(\"SPKDAT1L\"),\nSND_SOC_DAPM_OUTPUT(\"SPKDAT1R\"),\nSND_SOC_DAPM_OUTPUT(\"SPDIF1\"),\n\nSND_SOC_DAPM_OUTPUT(\"MICSUPP\"),\n};\n\n#define MADERA_MIXER_INPUT_ROUTES(name)\t\\\n\t{ name, \"Noise Generator\", \"Noise Generator\" }, \\\n\t{ name, \"Tone Generator 1\", \"Tone Generator 1\" }, \\\n\t{ name, \"Tone Generator 2\", \"Tone Generator 2\" }, \\\n\t{ name, \"Haptics\", \"HAPTICS\" }, \\\n\t{ name, \"AEC1\", \"AEC1 Loopback\" }, \\\n\t{ name, \"AEC2\", \"AEC2 Loopback\" }, \\\n\t{ name, \"IN1L\", \"IN1L\" }, \\\n\t{ name, \"IN1R\", \"IN1R\" }, \\\n\t{ name, \"IN2L\", \"IN2L\" }, \\\n\t{ name, \"IN2R\", \"IN2R\" }, \\\n\t{ name, \"AIF1RX1\", \"AIF1RX1\" }, \\\n\t{ name, \"AIF1RX2\", \"AIF1RX2\" }, \\\n\t{ name, \"AIF1RX3\", \"AIF1RX3\" }, \\\n\t{ name, \"AIF1RX4\", \"AIF1RX4\" }, \\\n\t{ name, \"AIF1RX5\", \"AIF1RX5\" }, \\\n\t{ name, \"AIF1RX6\", \"AIF1RX6\" }, \\\n\t{ name, \"AIF2RX1\", \"AIF2RX1\" }, \\\n\t{ name, \"AIF2RX2\", \"AIF2RX2\" }, \\\n\t{ name, \"AIF2RX3\", \"AIF2RX3\" }, \\\n\t{ name, \"AIF2RX4\", \"AIF2RX4\" }, \\\n\t{ name, \"AIF3RX1\", \"AIF3RX1\" }, \\\n\t{ name, \"AIF3RX2\", \"AIF3RX2\" }, \\\n\t{ name, \"EQ1\", \"EQ1\" }, \\\n\t{ name, \"EQ2\", \"EQ2\" }, \\\n\t{ name, \"EQ3\", \"EQ3\" }, \\\n\t{ name, \"EQ4\", \"EQ4\" }, \\\n\t{ name, \"DRC1L\", \"DRC1L\" }, \\\n\t{ name, \"DRC1R\", \"DRC1R\" }, \\\n\t{ name, \"DRC2L\", \"DRC2L\" }, \\\n\t{ name, \"DRC2R\", \"DRC2R\" }, \\\n\t{ name, \"LHPF1\", \"LHPF1\" }, \\\n\t{ name, \"LHPF2\", \"LHPF2\" }, \\\n\t{ name, \"LHPF3\", \"LHPF3\" }, \\\n\t{ name, \"LHPF4\", \"LHPF4\" }, \\\n\t{ name, \"ISRC1DEC1\", \"ISRC1DEC1\" }, \\\n\t{ name, \"ISRC1DEC2\", \"ISRC1DEC2\" }, \\\n\t{ name, \"ISRC1DEC3\", \"ISRC1DEC3\" }, \\\n\t{ name, \"ISRC1DEC4\", \"ISRC1DEC4\" }, \\\n\t{ name, \"ISRC1INT1\", \"ISRC1INT1\" }, \\\n\t{ name, \"ISRC1INT2\", \"ISRC1INT2\" }, \\\n\t{ name, \"ISRC1INT3\", \"ISRC1INT3\" }, \\\n\t{ name, \"ISRC1INT4\", \"ISRC1INT4\" }, \\\n\t{ name, \"ISRC2DEC1\", \"ISRC2DEC1\" }, \\\n\t{ name, \"ISRC2DEC2\", \"ISRC2DEC2\" }, \\\n\t{ name, \"ISRC2DEC3\", \"ISRC2DEC3\" }, \\\n\t{ name, \"ISRC2DEC4\", \"ISRC2DEC4\" }, \\\n\t{ name, \"ISRC2INT1\", \"ISRC2INT1\" }, \\\n\t{ name, \"ISRC2INT2\", \"ISRC2INT2\" }, \\\n\t{ name, \"ISRC2INT3\", \"ISRC2INT3\" }, \\\n\t{ name, \"ISRC2INT4\", \"ISRC2INT4\" }, \\\n\t{ name, \"DSP1.1\", \"DSP1\" }, \\\n\t{ name, \"DSP1.2\", \"DSP1\" }, \\\n\t{ name, \"DSP1.3\", \"DSP1\" }, \\\n\t{ name, \"DSP1.4\", \"DSP1\" }, \\\n\t{ name, \"DSP1.5\", \"DSP1\" }, \\\n\t{ name, \"DSP1.6\", \"DSP1\" }\n\nstatic const struct snd_soc_dapm_route cs47l15_dapm_routes[] = {\n\t \n\t{ \"EQ1\", NULL, \"FXCLK\" },\n\t{ \"EQ2\", NULL, \"FXCLK\" },\n\t{ \"EQ3\", NULL, \"FXCLK\" },\n\t{ \"EQ4\", NULL, \"FXCLK\" },\n\t{ \"DRC1L\", NULL, \"FXCLK\" },\n\t{ \"DRC1R\", NULL, \"FXCLK\" },\n\t{ \"DRC2L\", NULL, \"FXCLK\" },\n\t{ \"DRC2R\", NULL, \"FXCLK\" },\n\t{ \"LHPF1\", NULL, \"FXCLK\" },\n\t{ \"LHPF2\", NULL, \"FXCLK\" },\n\t{ \"LHPF3\", NULL, \"FXCLK\" },\n\t{ \"LHPF4\", NULL, \"FXCLK\" },\n\t{ \"PWM1 Mixer\", NULL, \"PWMCLK\" },\n\t{ \"PWM2 Mixer\", NULL, \"PWMCLK\" },\n\t{ \"OUT1L\", NULL, \"OUTCLK\" },\n\t{ \"OUT1R\", NULL, \"OUTCLK\" },\n\t{ \"OUT4L\", NULL, \"OUTCLK\" },\n\t{ \"OUT5L\", NULL, \"OUTCLK\" },\n\t{ \"OUT5R\", NULL, \"OUTCLK\" },\n\t{ \"AIF1TX1\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF1TX2\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF1TX3\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF1TX4\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF1TX5\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF1TX6\", NULL, \"AIF1TXCLK\" },\n\t{ \"AIF2TX1\", NULL, \"AIF2TXCLK\" },\n\t{ \"AIF2TX2\", NULL, \"AIF2TXCLK\" },\n\t{ \"AIF2TX3\", NULL, \"AIF2TXCLK\" },\n\t{ \"AIF2TX4\", NULL, \"AIF2TXCLK\" },\n\t{ \"AIF3TX1\", NULL, \"AIF3TXCLK\" },\n\t{ \"AIF3TX2\", NULL, \"AIF3TXCLK\" },\n\t{ \"SPD1TX1\", NULL, \"SPDCLK\" },\n\t{ \"SPD1TX2\", NULL, \"SPDCLK\" },\n\t{ \"DSP1\", NULL, \"DSP1CLK\" },\n\t{ \"ISRC1DEC1\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1DEC2\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1DEC3\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1DEC4\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1INT1\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1INT2\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1INT3\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC1INT4\", NULL, \"ISRC1CLK\" },\n\t{ \"ISRC2DEC1\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2DEC2\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2DEC3\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2DEC4\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2INT1\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2INT2\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2INT3\", NULL, \"ISRC2CLK\" },\n\t{ \"ISRC2INT4\", NULL, \"ISRC2CLK\" },\n\n\t{ \"OUT1L\", NULL, \"CPVDD1\" },\n\t{ \"OUT1R\", NULL, \"CPVDD1\" },\n\t{ \"OUT4L\", NULL, \"SPKVDD\" },\n\n\t{ \"OUT1L\", NULL, \"SYSCLK\" },\n\t{ \"OUT1R\", NULL, \"SYSCLK\" },\n\t{ \"OUT4L\", NULL, \"SYSCLK\" },\n\t{ \"OUT5L\", NULL, \"SYSCLK\" },\n\t{ \"OUT5R\", NULL, \"SYSCLK\" },\n\n\t{ \"SPD1\", NULL, \"SYSCLK\" },\n\t{ \"SPD1\", NULL, \"SPD1TX1\" },\n\t{ \"SPD1\", NULL, \"SPD1TX2\" },\n\n\t{ \"IN1L\", NULL, \"SYSCLK\" },\n\t{ \"IN1R\", NULL, \"SYSCLK\" },\n\t{ \"IN2L\", NULL, \"SYSCLK\" },\n\t{ \"IN2R\", NULL, \"SYSCLK\" },\n\n\t{ \"MICBIAS1\", NULL, \"MICVDD\" },\n\n\t{ \"MICBIAS1A\", NULL, \"MICBIAS1\" },\n\t{ \"MICBIAS1B\", NULL, \"MICBIAS1\" },\n\t{ \"MICBIAS1C\", NULL, \"MICBIAS1\" },\n\n\t{ \"Noise Generator\", NULL, \"SYSCLK\" },\n\t{ \"Tone Generator 1\", NULL, \"SYSCLK\" },\n\t{ \"Tone Generator 2\", NULL, \"SYSCLK\" },\n\n\t{ \"Noise Generator\", NULL, \"NOISE\" },\n\t{ \"Tone Generator 1\", NULL, \"TONE\" },\n\t{ \"Tone Generator 2\", NULL, \"TONE\" },\n\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX1\" },\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX2\" },\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX3\" },\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX4\" },\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX5\" },\n\t{ \"AIF1 Capture\", NULL, \"AIF1TX6\" },\n\n\t{ \"AIF1RX1\", NULL, \"AIF1 Playback\" },\n\t{ \"AIF1RX2\", NULL, \"AIF1 Playback\" },\n\t{ \"AIF1RX3\", NULL, \"AIF1 Playback\" },\n\t{ \"AIF1RX4\", NULL, \"AIF1 Playback\" },\n\t{ \"AIF1RX5\", NULL, \"AIF1 Playback\" },\n\t{ \"AIF1RX6\", NULL, \"AIF1 Playback\" },\n\n\t{ \"AIF2 Capture\", NULL, \"AIF2TX1\" },\n\t{ \"AIF2 Capture\", NULL, \"AIF2TX2\" },\n\t{ \"AIF2 Capture\", NULL, \"AIF2TX3\" },\n\t{ \"AIF2 Capture\", NULL, \"AIF2TX4\" },\n\n\t{ \"AIF2RX1\", NULL, \"AIF2 Playback\" },\n\t{ \"AIF2RX2\", NULL, \"AIF2 Playback\" },\n\t{ \"AIF2RX3\", NULL, \"AIF2 Playback\" },\n\t{ \"AIF2RX4\", NULL, \"AIF2 Playback\" },\n\n\t{ \"AIF3 Capture\", NULL, \"AIF3TX1\" },\n\t{ \"AIF3 Capture\", NULL, \"AIF3TX2\" },\n\n\t{ \"AIF3RX1\", NULL, \"AIF3 Playback\" },\n\t{ \"AIF3RX2\", NULL, \"AIF3 Playback\" },\n\n\t{ \"AIF1 Playback\", NULL, \"SYSCLK\" },\n\t{ \"AIF2 Playback\", NULL, \"SYSCLK\" },\n\t{ \"AIF3 Playback\", NULL, \"SYSCLK\" },\n\n\t{ \"AIF1 Capture\", NULL, \"SYSCLK\" },\n\t{ \"AIF2 Capture\", NULL, \"SYSCLK\" },\n\t{ \"AIF3 Capture\", NULL, \"SYSCLK\" },\n\n\t{ \"Audio Trace DSP\", NULL, \"DSP1\" },\n\n\t{ \"IN1L Analog Mux\", \"A\", \"IN1ALN\" },\n\t{ \"IN1L Analog Mux\", \"A\", \"IN1ALP\" },\n\t{ \"IN1L Analog Mux\", \"B\", \"IN1BLN\" },\n\t{ \"IN1L Analog Mux\", \"B\", \"IN1BLP\" },\n\t{ \"IN1R Analog Mux\", \"A\", \"IN1ARN\" },\n\t{ \"IN1R Analog Mux\", \"A\", \"IN1ARP\" },\n\t{ \"IN1R Analog Mux\", \"B\", \"IN1BRN\" },\n\t{ \"IN1R Analog Mux\", \"B\", \"IN1BRP\" },\n\n\t{ \"IN1L Mode\", \"Analog\", \"IN1L Analog Mux\" },\n\t{ \"IN1R Mode\", \"Analog\", \"IN1R Analog Mux\" },\n\n\t{ \"IN1L Mode\", \"Digital\", \"IN1ALN\" },\n\t{ \"IN1L Mode\", \"Digital\", \"IN1ALP\" },\n\t{ \"IN1R Mode\", \"Digital\", \"IN1ALN\" },\n\t{ \"IN1R Mode\", \"Digital\", \"IN1ALP\" },\n\n\t{ \"IN1L\", NULL, \"IN1L Mode\" },\n\t{ \"IN1R\", NULL, \"IN1R Mode\" },\n\n\t{ \"IN2L Mode\", \"Analog\", \"IN2N\" },\n\t{ \"IN2L Mode\", \"Analog\", \"IN2P\" },\n\n\t{ \"IN2L Mode\", \"Digital\", \"SPKRXDAT\" },\n\t{ \"IN2R Mode\", \"Digital\", \"SPKRXDAT\" },\n\n\t{ \"IN2L\", NULL, \"IN2L Mode\" },\n\t{ \"IN2R\", NULL, \"IN2R Mode\" },\n\n\tMADERA_MIXER_ROUTES(\"OUT1L\", \"HPOUT1L\"),\n\tMADERA_MIXER_ROUTES(\"OUT1R\", \"HPOUT1R\"),\n\tMADERA_MIXER_ROUTES(\"OUT4L\", \"SPKOUTL\"),\n\tMADERA_MIXER_ROUTES(\"OUT5L\", \"SPKDAT1L\"),\n\tMADERA_MIXER_ROUTES(\"OUT5R\", \"SPKDAT1R\"),\n\n\tMADERA_MIXER_ROUTES(\"PWM1 Driver\", \"PWM1\"),\n\tMADERA_MIXER_ROUTES(\"PWM2 Driver\", \"PWM2\"),\n\n\tMADERA_MIXER_ROUTES(\"AIF1TX1\", \"AIF1TX1\"),\n\tMADERA_MIXER_ROUTES(\"AIF1TX2\", \"AIF1TX2\"),\n\tMADERA_MIXER_ROUTES(\"AIF1TX3\", \"AIF1TX3\"),\n\tMADERA_MIXER_ROUTES(\"AIF1TX4\", \"AIF1TX4\"),\n\tMADERA_MIXER_ROUTES(\"AIF1TX5\", \"AIF1TX5\"),\n\tMADERA_MIXER_ROUTES(\"AIF1TX6\", \"AIF1TX6\"),\n\n\tMADERA_MIXER_ROUTES(\"AIF2TX1\", \"AIF2TX1\"),\n\tMADERA_MIXER_ROUTES(\"AIF2TX2\", \"AIF2TX2\"),\n\tMADERA_MIXER_ROUTES(\"AIF2TX3\", \"AIF2TX3\"),\n\tMADERA_MIXER_ROUTES(\"AIF2TX4\", \"AIF2TX4\"),\n\n\tMADERA_MIXER_ROUTES(\"AIF3TX1\", \"AIF3TX1\"),\n\tMADERA_MIXER_ROUTES(\"AIF3TX2\", \"AIF3TX2\"),\n\n\tMADERA_MUX_ROUTES(\"SPD1TX1\", \"SPDIF1TX1\"),\n\tMADERA_MUX_ROUTES(\"SPD1TX2\", \"SPDIF1TX2\"),\n\n\tMADERA_MIXER_ROUTES(\"EQ1\", \"EQ1\"),\n\tMADERA_MIXER_ROUTES(\"EQ2\", \"EQ2\"),\n\tMADERA_MIXER_ROUTES(\"EQ3\", \"EQ3\"),\n\tMADERA_MIXER_ROUTES(\"EQ4\", \"EQ4\"),\n\n\tMADERA_MIXER_ROUTES(\"DRC1L\", \"DRC1L\"),\n\tMADERA_MIXER_ROUTES(\"DRC1R\", \"DRC1R\"),\n\tMADERA_MIXER_ROUTES(\"DRC2L\", \"DRC2L\"),\n\tMADERA_MIXER_ROUTES(\"DRC2R\", \"DRC2R\"),\n\n\tMADERA_MIXER_ROUTES(\"LHPF1\", \"LHPF1\"),\n\tMADERA_MIXER_ROUTES(\"LHPF2\", \"LHPF2\"),\n\tMADERA_MIXER_ROUTES(\"LHPF3\", \"LHPF3\"),\n\tMADERA_MIXER_ROUTES(\"LHPF4\", \"LHPF4\"),\n\n\tMADERA_DSP_ROUTES(\"DSP1\"),\n\n\t{ \"DSP Trigger Out\", NULL, \"DSP1 Trigger Output\" },\n\n\t{ \"DSP1 Trigger Output\", \"Switch\", \"DSP1\" },\n\n\tMADERA_MUX_ROUTES(\"ISRC1INT1\", \"ISRC1INT1\"),\n\tMADERA_MUX_ROUTES(\"ISRC1INT2\", \"ISRC1INT2\"),\n\tMADERA_MUX_ROUTES(\"ISRC1INT3\", \"ISRC1INT3\"),\n\tMADERA_MUX_ROUTES(\"ISRC1INT4\", \"ISRC1INT4\"),\n\n\tMADERA_MUX_ROUTES(\"ISRC1DEC1\", \"ISRC1DEC1\"),\n\tMADERA_MUX_ROUTES(\"ISRC1DEC2\", \"ISRC1DEC2\"),\n\tMADERA_MUX_ROUTES(\"ISRC1DEC3\", \"ISRC1DEC3\"),\n\tMADERA_MUX_ROUTES(\"ISRC1DEC4\", \"ISRC1DEC4\"),\n\n\tMADERA_MUX_ROUTES(\"ISRC2INT1\", \"ISRC2INT1\"),\n\tMADERA_MUX_ROUTES(\"ISRC2INT2\", \"ISRC2INT2\"),\n\tMADERA_MUX_ROUTES(\"ISRC2INT3\", \"ISRC2INT3\"),\n\tMADERA_MUX_ROUTES(\"ISRC2INT4\", \"ISRC2INT4\"),\n\n\tMADERA_MUX_ROUTES(\"ISRC2DEC1\", \"ISRC2DEC1\"),\n\tMADERA_MUX_ROUTES(\"ISRC2DEC2\", \"ISRC2DEC2\"),\n\tMADERA_MUX_ROUTES(\"ISRC2DEC3\", \"ISRC2DEC3\"),\n\tMADERA_MUX_ROUTES(\"ISRC2DEC4\", \"ISRC2DEC4\"),\n\n\t{ \"AEC1 Loopback\", \"HPOUT1L\", \"OUT1L\" },\n\t{ \"AEC1 Loopback\", \"HPOUT1R\", \"OUT1R\" },\n\t{ \"AEC2 Loopback\", \"HPOUT1L\", \"OUT1L\" },\n\t{ \"AEC2 Loopback\", \"HPOUT1R\", \"OUT1R\" },\n\t{ \"HPOUT1 Demux\", NULL, \"OUT1L\" },\n\t{ \"HPOUT1 Demux\", NULL, \"OUT1R\" },\n\n\t{ \"OUT1R\", NULL, \"HPOUT1 Mono Mux\" },\n\t{ \"HPOUT1 Mono Mux\", \"EPOUT\", \"OUT1L\" },\n\n\t{ \"HPOUTL\", \"HPOUT\", \"HPOUT1 Demux\" },\n\t{ \"HPOUTR\", \"HPOUT\", \"HPOUT1 Demux\" },\n\t{ \"EPOUTP\", \"EPOUT\", \"HPOUT1 Demux\" },\n\t{ \"EPOUTN\", \"EPOUT\", \"HPOUT1 Demux\" },\n\n\t{ \"AEC1 Loopback\", \"SPKOUTL\", \"OUT4L\" },\n\t{ \"AEC2 Loopback\", \"SPKOUTL\", \"OUT4L\" },\n\t{ \"SPKOUTN\", NULL, \"OUT4L\" },\n\t{ \"SPKOUTP\", NULL, \"OUT4L\" },\n\n\t{ \"AEC1 Loopback\", \"SPKDAT1L\", \"OUT5L\" },\n\t{ \"AEC1 Loopback\", \"SPKDAT1R\", \"OUT5R\" },\n\t{ \"AEC2 Loopback\", \"SPKDAT1L\", \"OUT5L\" },\n\t{ \"AEC2 Loopback\", \"SPKDAT1R\", \"OUT5R\" },\n\t{ \"SPKDAT1L\", NULL, \"OUT5L\" },\n\t{ \"SPKDAT1R\", NULL, \"OUT5R\" },\n\n\t{ \"SPDIF1\", NULL, \"SPD1\" },\n\n\t{ \"MICSUPP\", NULL, \"SYSCLK\" },\n\n\t{ \"DRC1 Signal Activity\", NULL, \"DRC1 Activity Output\" },\n\t{ \"DRC2 Signal Activity\", NULL, \"DRC2 Activity Output\" },\n\t{ \"DRC1 Activity Output\", \"Switch\", \"DRC1L\" },\n\t{ \"DRC1 Activity Output\", \"Switch\", \"DRC1R\" },\n\t{ \"DRC2 Activity Output\", \"Switch\", \"DRC2L\" },\n\t{ \"DRC2 Activity Output\", \"Switch\", \"DRC2R\" },\n};\n\nstatic int cs47l15_set_fll(struct snd_soc_component *component, int fll_id,\n\t\t\t   int source, unsigned int fref, unsigned int fout)\n{\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\n\tswitch (fll_id) {\n\tcase MADERA_FLL1_REFCLK:\n\t\treturn madera_set_fll_refclk(&cs47l15->fll[0], source, fref,\n\t\t\t\t\t     fout);\n\tcase MADERA_FLLAO_REFCLK:\n\t\treturn madera_set_fll_ao_refclk(&cs47l15->fll[1], source, fref,\n\t\t\t\t\t\tfout);\n\tcase MADERA_FLL1_SYNCCLK:\n\t\treturn madera_set_fll_syncclk(&cs47l15->fll[0], source, fref,\n\t\t\t\t\t      fout);\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\nstatic const struct snd_soc_dai_ops cs47l15_dai_ops = {\n\t.compress_new = snd_soc_new_compress,\n};\n\nstatic struct snd_soc_dai_driver cs47l15_dai[] = {\n\t{\n\t\t.name = \"cs47l15-aif1\",\n\t\t.id = 1,\n\t\t.base = MADERA_AIF1_BCLK_CTRL,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF1 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 6,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF1 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 6,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t },\n\t\t.ops = &madera_dai_ops,\n\t\t.symmetric_rate = 1,\n\t\t.symmetric_sample_bits = 1,\n\t},\n\t{\n\t\t.name = \"cs47l15-aif2\",\n\t\t.id = 2,\n\t\t.base = MADERA_AIF2_BCLK_CTRL,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF2 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF2 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 4,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t },\n\t\t.ops = &madera_dai_ops,\n\t\t.symmetric_rate = 1,\n\t\t.symmetric_sample_bits = 1,\n\t},\n\t{\n\t\t.name = \"cs47l15-aif3\",\n\t\t.id = 3,\n\t\t.base = MADERA_AIF3_BCLK_CTRL,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF3 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF3 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t },\n\t\t.ops = &madera_dai_ops,\n\t\t.symmetric_rate = 1,\n\t\t.symmetric_sample_bits = 1,\n\t},\n\t{\n\t\t.name = \"cs47l15-cpu-trace\",\n\t\t.capture = {\n\t\t\t.stream_name = \"Audio Trace CPU\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 6,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t},\n\t\t.ops = &cs47l15_dai_ops,\n\t},\n\t{\n\t\t.name = \"cs47l15-dsp-trace\",\n\t\t.capture = {\n\t\t\t.stream_name = \"Audio Trace DSP\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 6,\n\t\t\t.rates = MADERA_RATES,\n\t\t\t.formats = MADERA_FORMATS,\n\t\t},\n\t},\n};\n\nstatic int cs47l15_open(struct snd_soc_component *component,\n\t\t\tstruct snd_compr_stream *stream)\n{\n\tstruct snd_soc_pcm_runtime *rtd = stream->private_data;\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\tstruct madera_priv *priv = &cs47l15->core;\n\tstruct madera *madera = priv->madera;\n\tint n_adsp;\n\n\tif (strcmp(asoc_rtd_to_codec(rtd, 0)->name, \"cs47l15-dsp-trace\") == 0) {\n\t\tn_adsp = 0;\n\t} else {\n\t\tdev_err(madera->dev,\n\t\t\t\"No suitable compressed stream for DAI '%s'\\n\",\n\t\t\tasoc_rtd_to_codec(rtd, 0)->name);\n\t\treturn -EINVAL;\n\t}\n\n\treturn wm_adsp_compr_open(&priv->adsp[n_adsp], stream);\n}\n\nstatic irqreturn_t cs47l15_adsp2_irq(int irq, void *data)\n{\n\tstruct cs47l15 *cs47l15 = data;\n\tstruct madera_priv *priv = &cs47l15->core;\n\tstruct madera *madera = priv->madera;\n\tint ret;\n\n\tret = wm_adsp_compr_handle_irq(&priv->adsp[0]);\n\tif (ret == -ENODEV) {\n\t\tdev_err(madera->dev, \"Spurious compressed data IRQ\\n\");\n\t\treturn IRQ_NONE;\n\t}\n\n\treturn IRQ_HANDLED;\n}\n\nstatic const struct snd_soc_dapm_route cs47l15_mono_routes[] = {\n\t{ \"HPOUT1 Mono Mux\", \"HPOUT\", \"OUT1L\" },\n};\n\nstatic int cs47l15_component_probe(struct snd_soc_component *component)\n{\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\tstruct madera *madera = cs47l15->core.madera;\n\tint ret;\n\n\tsnd_soc_component_init_regmap(component, madera->regmap);\n\n\tmutex_lock(&madera->dapm_ptr_lock);\n\tmadera->dapm = snd_soc_component_get_dapm(component);\n\tmutex_unlock(&madera->dapm_ptr_lock);\n\n\tret = madera_init_inputs(component);\n\tif (ret)\n\t\treturn ret;\n\n\tret = madera_init_outputs(component, cs47l15_mono_routes,\n\t\t\t\t  ARRAY_SIZE(cs47l15_mono_routes),\n\t\t\t\t  CS47L15_MONO_OUTPUTS);\n\tif (ret)\n\t\treturn ret;\n\n\tsnd_soc_component_disable_pin(component, \"HAPTICS\");\n\n\tret = snd_soc_add_component_controls(component,\n\t\t\t\t\t     madera_adsp_rate_controls,\n\t\t\t\t\t     CS47L15_NUM_ADSP);\n\tif (ret)\n\t\treturn ret;\n\n\twm_adsp2_component_probe(&cs47l15->core.adsp[0], component);\n\n\treturn 0;\n}\n\nstatic void cs47l15_component_remove(struct snd_soc_component *component)\n{\n\tstruct cs47l15 *cs47l15 = snd_soc_component_get_drvdata(component);\n\tstruct madera *madera = cs47l15->core.madera;\n\n\tmutex_lock(&madera->dapm_ptr_lock);\n\tmadera->dapm = NULL;\n\tmutex_unlock(&madera->dapm_ptr_lock);\n\n\twm_adsp2_component_remove(&cs47l15->core.adsp[0], component);\n}\n\n#define CS47L15_DIG_VU 0x0200\n\nstatic unsigned int cs47l15_digital_vu[] = {\n\tMADERA_DAC_DIGITAL_VOLUME_1L,\n\tMADERA_DAC_DIGITAL_VOLUME_1R,\n\tMADERA_DAC_DIGITAL_VOLUME_4L,\n\tMADERA_DAC_DIGITAL_VOLUME_5L,\n\tMADERA_DAC_DIGITAL_VOLUME_5R,\n};\n\nstatic const struct snd_compress_ops cs47l15_compress_ops = {\n\t.open = &cs47l15_open,\n\t.free = &wm_adsp_compr_free,\n\t.set_params = &wm_adsp_compr_set_params,\n\t.get_caps = &wm_adsp_compr_get_caps,\n\t.trigger = &wm_adsp_compr_trigger,\n\t.pointer = &wm_adsp_compr_pointer,\n\t.copy = &wm_adsp_compr_copy,\n};\n\nstatic const struct snd_soc_component_driver soc_component_dev_cs47l15 = {\n\t.probe\t\t\t= &cs47l15_component_probe,\n\t.remove\t\t\t= &cs47l15_component_remove,\n\t.set_sysclk\t\t= &madera_set_sysclk,\n\t.set_pll\t\t= &cs47l15_set_fll,\n\t.name\t\t\t= DRV_NAME,\n\t.compress_ops\t\t= &cs47l15_compress_ops,\n\t.controls\t\t= cs47l15_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(cs47l15_snd_controls),\n\t.dapm_widgets\t\t= cs47l15_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(cs47l15_dapm_widgets),\n\t.dapm_routes\t\t= cs47l15_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(cs47l15_dapm_routes),\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic int cs47l15_probe(struct platform_device *pdev)\n{\n\tstruct madera *madera = dev_get_drvdata(pdev->dev.parent);\n\tstruct cs47l15 *cs47l15;\n\tint i, ret;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(cs47l15_dai) > MADERA_MAX_DAI);\n\n\t \n\tif (!madera->irq_dev) {\n\t\tdev_dbg(&pdev->dev, \"irqchip driver not ready\\n\");\n\t\treturn -EPROBE_DEFER;\n\t}\n\n\tcs47l15 = devm_kzalloc(&pdev->dev, sizeof(struct cs47l15),\n\t\t\t       GFP_KERNEL);\n\tif (!cs47l15)\n\t\treturn -ENOMEM;\n\n\tplatform_set_drvdata(pdev, cs47l15);\n\n\tcs47l15->core.madera = madera;\n\tcs47l15->core.dev = &pdev->dev;\n\tcs47l15->core.num_inputs = 4;\n\n\tret = madera_core_init(&cs47l15->core);\n\tif (ret)\n\t\treturn ret;\n\n\tret = madera_init_overheat(&cs47l15->core);\n\tif (ret)\n\t\tgoto error_core;\n\n\tret = madera_request_irq(madera, MADERA_IRQ_DSP_IRQ1,\n\t\t\t\t \"ADSP2 Compressed IRQ\", cs47l15_adsp2_irq,\n\t\t\t\t cs47l15);\n\tif (ret != 0) {\n\t\tdev_err(&pdev->dev, \"Failed to request DSP IRQ: %d\\n\", ret);\n\t\tgoto error_overheat;\n\t}\n\n\tret = madera_set_irq_wake(madera, MADERA_IRQ_DSP_IRQ1, 1);\n\tif (ret)\n\t\tdev_warn(&pdev->dev, \"Failed to set DSP IRQ wake: %d\\n\", ret);\n\n\tcs47l15->core.adsp[0].part = \"cs47l15\";\n\tcs47l15->core.adsp[0].cs_dsp.num = 1;\n\tcs47l15->core.adsp[0].cs_dsp.type = WMFW_ADSP2;\n\tcs47l15->core.adsp[0].cs_dsp.rev = 2;\n\tcs47l15->core.adsp[0].cs_dsp.dev = madera->dev;\n\tcs47l15->core.adsp[0].cs_dsp.regmap = madera->regmap_32bit;\n\n\tcs47l15->core.adsp[0].cs_dsp.base = MADERA_DSP1_CONFIG_1;\n\tcs47l15->core.adsp[0].cs_dsp.mem = cs47l15_dsp1_regions;\n\tcs47l15->core.adsp[0].cs_dsp.num_mems = ARRAY_SIZE(cs47l15_dsp1_regions);\n\n\tcs47l15->core.adsp[0].cs_dsp.lock_regions =\n\t\tCS_ADSP2_REGION_1 | CS_ADSP2_REGION_2 | CS_ADSP2_REGION_3;\n\n\tret = wm_adsp2_init(&cs47l15->core.adsp[0]);\n\tif (ret != 0)\n\t\tgoto error_dsp_irq;\n\n\tret = madera_init_bus_error_irq(&cs47l15->core, 0, wm_adsp2_bus_error);\n\tif (ret)\n\t\tgoto error_adsp;\n\n\tmadera_init_fll(madera, 1, MADERA_FLL1_CONTROL_1 - 1,\n\t\t\t&cs47l15->fll[0]);\n\tmadera_init_fll(madera, 4, MADERA_FLLAO_CONTROL_1 - 1,\n\t\t\t&cs47l15->fll[1]);\n\n\tfor (i = 0; i < ARRAY_SIZE(cs47l15_dai); i++)\n\t\tmadera_init_dai(&cs47l15->core, i);\n\n\t \n\tfor (i = 0; i < ARRAY_SIZE(cs47l15_digital_vu); i++)\n\t\tregmap_update_bits(madera->regmap, cs47l15_digital_vu[i],\n\t\t\t\t   CS47L15_DIG_VU, CS47L15_DIG_VU);\n\n\tpm_runtime_enable(&pdev->dev);\n\tpm_runtime_idle(&pdev->dev);\n\n\tret = devm_snd_soc_register_component(&pdev->dev,\n\t\t\t\t\t      &soc_component_dev_cs47l15,\n\t\t\t\t\t      cs47l15_dai,\n\t\t\t\t\t      ARRAY_SIZE(cs47l15_dai));\n\tif (ret < 0) {\n\t\tdev_err(&pdev->dev, \"Failed to register component: %d\\n\", ret);\n\t\tgoto error_pm_runtime;\n\t}\n\n\treturn ret;\n\nerror_pm_runtime:\n\tpm_runtime_disable(&pdev->dev);\n\tmadera_free_bus_error_irq(&cs47l15->core, 0);\nerror_adsp:\n\twm_adsp2_remove(&cs47l15->core.adsp[0]);\nerror_dsp_irq:\n\tmadera_set_irq_wake(madera, MADERA_IRQ_DSP_IRQ1, 0);\n\tmadera_free_irq(madera, MADERA_IRQ_DSP_IRQ1, cs47l15);\nerror_overheat:\n\tmadera_free_overheat(&cs47l15->core);\nerror_core:\n\tmadera_core_free(&cs47l15->core);\n\n\treturn ret;\n}\n\nstatic void cs47l15_remove(struct platform_device *pdev)\n{\n\tstruct cs47l15 *cs47l15 = platform_get_drvdata(pdev);\n\n\tpm_runtime_disable(&pdev->dev);\n\n\tmadera_free_bus_error_irq(&cs47l15->core, 0);\n\n\twm_adsp2_remove(&cs47l15->core.adsp[0]);\n\n\tmadera_set_irq_wake(cs47l15->core.madera, MADERA_IRQ_DSP_IRQ1, 0);\n\tmadera_free_irq(cs47l15->core.madera, MADERA_IRQ_DSP_IRQ1, cs47l15);\n\tmadera_free_overheat(&cs47l15->core);\n\tmadera_core_free(&cs47l15->core);\n}\n\nstatic struct platform_driver cs47l15_codec_driver = {\n\t.driver = {\n\t\t.name = \"cs47l15-codec\",\n\t},\n\t.probe = &cs47l15_probe,\n\t.remove_new = cs47l15_remove,\n};\n\nmodule_platform_driver(cs47l15_codec_driver);\n\nMODULE_SOFTDEP(\"pre: madera irq-madera arizona-micsupp\");\nMODULE_DESCRIPTION(\"ASoC CS47L15 driver\");\nMODULE_AUTHOR(\"Richard Fitzgerald <rf@opensource.cirrus.com>\");\nMODULE_AUTHOR(\"Jaswinder Jassal <jjassal@opensource.cirrus.com>\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_ALIAS(\"platform:cs47l15-codec\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}