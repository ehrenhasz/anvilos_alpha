{
  "module_name": "wsa884x.c",
  "hash_id": "026574dc25ced8fc252e61ca5b032bc22a1be194d2583c54204a29491f62d1bf",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/wsa884x.c",
  "human_readable_source": "\n \n\n#include <linux/bitfield.h>\n#include <linux/device.h>\n#include <linux/gpio/consumer.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/pm_runtime.h>\n#include <linux/regmap.h>\n#include <linux/regulator/consumer.h>\n#include <linux/slab.h>\n#include <linux/soundwire/sdw.h>\n#include <linux/soundwire/sdw_registers.h>\n#include <linux/soundwire/sdw_type.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc-dapm.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n\n#define WSA884X_BASE\t\t\t0x3000\n#define WSA884X_ANA_BG_TSADC_BASE       (WSA884X_BASE + 0x0001)\n#define WSA884X_BG_CTRL\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x00)\n#define WSA884X_ADC_CTRL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x01)\n#define WSA884X_BOP1_PROG\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x02)\n#define WSA884X_BOP2_PROG\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x03)\n#define WSA884X_BOP2_PROG_BOP2_VTH_MASK\t\t\t\t0xf0\n#define WSA884X_BOP2_PROG_BOP2_VTH_SHIFT\t\t\t4\n#define WSA884X_BOP2_PROG_BOP2_HYST_MASK\t\t\t0x0f\n#define WSA884X_BOP2_PROG_BOP2_HYST_SHIFT\t\t\t0\n#define WSA884X_UVLO_PROG\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x04)\n#define WSA884X_UVLO_PROG1\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x05)\n#define WSA884X_SPARE_CTRL_0\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x06)\n#define WSA884X_SPARE_CTRL_1\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x07)\n#define WSA884X_SPARE_CTRL_2\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x08)\n#define WSA884X_SPARE_CTRL_3\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x09)\n#define WSA884X_REF_CTRL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0a)\n#define WSA884X_REF_CTRL_BG_RDY_SEL_MASK\t\t\t0x03\n#define WSA884X_REF_CTRL_BG_RDY_SEL_SHIFT\t\t\t0\n#define WSA884X_BG_TEST_CTL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0b)\n#define WSA884X_BG_BIAS\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0c)\n#define WSA884X_ADC_PROG\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0d)\n#define WSA884X_ADC_IREF_CTL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0e)\n#define WSA884X_ADC_ISENS_CTL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x0f)\n#define WSA884X_ADC_CLK_CTL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x10)\n#define WSA884X_ADC_TEST_CTL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x11)\n#define WSA884X_ADC_BIAS\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x12)\n#define WSA884X_VBAT_SNS\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x13)\n#define WSA884X_DOUT_MSB\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x14)\n#define WSA884X_DOUT_LSB\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x15)\n#define WSA884X_BOP_ATEST_SEL\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x16)\n#define WSA884X_MISC0\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x17)\n#define WSA884X_MISC1\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x18)\n#define WSA884X_MISC2\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x19)\n#define WSA884X_MISC3\t\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x1a)\n#define WSA884X_SPARE_TSBG_0\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x1b)\n#define WSA884X_SPARE_TUNE_0\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x1c)\n#define WSA884X_SPARE_TUNE_1\t\t(WSA884X_ANA_BG_TSADC_BASE + 0x1d)\n\n#define WSA884X_ANA_IVSENSE_BASE\t(WSA884X_BASE + 0x0020)\n#define WSA884X_VSENSE1\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x00)\n#define WSA884X_VSENSE1_GAIN_VSENSE_FE_MASK\t\t\t0xe0\n#define WSA884X_VSENSE1_GAIN_VSENSE_FE_SHIFT\t\t\t5\n#define WSA884X_ISENSE2\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x01)\n#define WSA884X_ISENSE2_ISENSE_GAIN_CTL_MASK\t\t\t0xe0\n#define WSA884X_ISENSE2_ISENSE_GAIN_CTL_SHIFT\t\t\t5\n\n#define WSA884X_SPARE_CTL_1\t\t(WSA884X_ANA_IVSENSE_BASE + 0x02)\n#define WSA884X_SPARE_CTL_2\t\t(WSA884X_ANA_IVSENSE_BASE + 0x03)\n#define WSA884X_SPARE_CTL_3\t\t(WSA884X_ANA_IVSENSE_BASE + 0x04)\n#define WSA884X_SPARE_CTL_4\t\t(WSA884X_ANA_IVSENSE_BASE + 0x05)\n#define WSA884X_EN\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x06)\n#define WSA884X_OVERRIDE1\t\t(WSA884X_ANA_IVSENSE_BASE + 0x07)\n#define WSA884X_OVERRIDE2\t\t(WSA884X_ANA_IVSENSE_BASE + 0x08)\n#define WSA884X_ISENSE1\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x09)\n#define WSA884X_ISENSE_CAL\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0a)\n#define WSA884X_MISC\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0b)\n#define WSA884X_ADC_0\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0c)\n#define WSA884X_ADC_1\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0d)\n#define WSA884X_ADC_2\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0e)\n#define WSA884X_ADC_3\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x0f)\n#define WSA884X_ADC_4\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x10)\n#define WSA884X_ADC_5\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x11)\n#define WSA884X_ADC_6\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x12)\n#define WSA884X_ADC_7\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x13)\n#define WSA884X_STATUS\t\t\t(WSA884X_ANA_IVSENSE_BASE + 0x14)\n#define WSA884X_IVSENSE_SPARE_TUNE_1\t(WSA884X_ANA_IVSENSE_BASE + 0x15)\n#define WSA884X_SPARE_TUNE_2\t\t(WSA884X_ANA_IVSENSE_BASE + 0x16)\n#define WSA884X_SPARE_TUNE_3\t\t(WSA884X_ANA_IVSENSE_BASE + 0x17)\n#define WSA884X_SPARE_TUNE_4\t\t(WSA884X_ANA_IVSENSE_BASE + 0x18)\n\n#define WSA884X_ANA_SPK_TOP_BASE\t(WSA884X_BASE + 0x0040)\n#define WSA884X_TOP_CTRL1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x00)\n#define WSA884X_TOP_CTRL1_OCP_LOWVBAT_ITH_EN_MASK\t0x01\n#define WSA884X_CLIP_DET_CTRL1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x01)\n#define WSA884X_CLIP_DET_CTRL2\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x02)\n#define WSA884X_DAC_CTRL1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x03)\n#define WSA884X_DAC_VCM_CTRL_REG1\t(WSA884X_ANA_SPK_TOP_BASE + 0x04)\n#define WSA884X_DAC_VCM_CTRL_REG2\t(WSA884X_ANA_SPK_TOP_BASE + 0x05)\n#define WSA884X_DAC_VCM_CTRL_REG3\t(WSA884X_ANA_SPK_TOP_BASE + 0x06)\n#define WSA884X_DAC_VCM_CTRL_REG4\t(WSA884X_ANA_SPK_TOP_BASE + 0x07)\n#define WSA884X_DAC_VCM_CTRL_REG5\t(WSA884X_ANA_SPK_TOP_BASE + 0x08)\n#define WSA884X_DAC_VCM_CTRL_REG6\t(WSA884X_ANA_SPK_TOP_BASE + 0x09)\n#define WSA884X_PWM_CLK_CTL\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x0a)\n#define WSA884X_PWM_CLK_CTL_VCMO_INT1_IDLE_MODE_OVRT_MASK\t0x80\n#define WSA884X_PWM_CLK_CTL_VCMO_INT1_IDLE_MODE_OVRT_SHIFT\t7\n#define WSA884X_PWM_CLK_CTL_REG_MCLK_DIV_RATIO_MASK\t\t0x40\n#define WSA884X_PWM_CLK_CTL_REG_MCLK_DIV_RATIO_SHIFT\t\t6\n#define WSA884X_PWM_CLK_CTL_PWM_DEGLITCH_CLK_DELAY_CTRL_MASK\t0x30\n#define WSA884X_PWM_CLK_CTL_PWM_DEGLITCH_CLK_DELAY_CTRL_SHIFT\t4\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_FREQ_SEL_MASK\t\t0x08\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_FREQ_SEL_SHIFT\t\t3\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_DIV_RATIO_MASK\t\t0x06\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_DIV_RATIO_SHIFT\t\t1\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_DIV_BYPASS_MASK\t\t0x01\n#define WSA884X_PWM_CLK_CTL_PWM_CLK_DIV_BYPASS_SHIFT\t\t0\n#define WSA884X_DRV_LF_LDO_SEL\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x0b)\n#define WSA884X_OCP_CTL\t\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x0c)\n#define WSA884X_PDRV_HS_CTL\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x0d)\n#define WSA884X_PDRV_LS_CTL\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x0e)\n#define WSA884X_SPK_TOP_SPARE_CTL_1\t(WSA884X_ANA_SPK_TOP_BASE + 0x0f)\n#define WSA884X_SPK_TOP_SPARE_CTL_2\t(WSA884X_ANA_SPK_TOP_BASE + 0x10)\n#define WSA884X_SPK_TOP_SPARE_CTL_3\t(WSA884X_ANA_SPK_TOP_BASE + 0x11)\n#define WSA884X_SPK_TOP_SPARE_CTL_4\t(WSA884X_ANA_SPK_TOP_BASE + 0x12)\n#define WSA884X_SPARE_CTL_5\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x13)\n#define WSA884X_DAC_EN_DEBUG_REG\t(WSA884X_ANA_SPK_TOP_BASE + 0x14)\n#define WSA884X_DAC_OPAMP_BIAS1_REG\t(WSA884X_ANA_SPK_TOP_BASE + 0x15)\n#define WSA884X_DAC_OPAMP_BIAS2_REG\t(WSA884X_ANA_SPK_TOP_BASE + 0x16)\n#define WSA884X_DAC_TUNE1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x17)\n#define WSA884X_DAC_VOLTAGE_CTRL_REG\t(WSA884X_ANA_SPK_TOP_BASE + 0x18)\n#define WSA884X_ATEST1_REG\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x19)\n#define WSA884X_ATEST2_REG\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1a)\n#define WSA884X_TOP_BIAS_REG1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1b)\n#define WSA884X_TOP_BIAS_REG2\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1c)\n#define WSA884X_TOP_BIAS_REG3\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1d)\n#define WSA884X_TOP_BIAS_REG4\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1e)\n#define WSA884X_PWRSTG_DBG2\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x1f)\n#define WSA884X_DRV_LF_BLK_EN\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x20)\n#define WSA884X_DRV_LF_EN\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x21)\n#define WSA884X_DRV_LF_MASK_DCC_CTL\t(WSA884X_ANA_SPK_TOP_BASE + 0x22)\n#define WSA884X_DRV_LF_MISC_CTL1\t(WSA884X_ANA_SPK_TOP_BASE + 0x23)\n#define WSA884X_DRV_LF_REG_GAIN\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x24)\n#define WSA884X_DRV_OS_CAL_CTL\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x25)\n#define WSA884X_DRV_OS_CAL_CTL1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x26)\n#define WSA884X_PWRSTG_DBG\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x27)\n#define WSA884X_BBM_CTL\t\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x28)\n#define WSA884X_TOP_MISC1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x29)\n#define WSA884X_DAC_VCM_CTRL_REG7\t(WSA884X_ANA_SPK_TOP_BASE + 0x2a)\n#define WSA884X_TOP_BIAS_REG5\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x2b)\n#define WSA884X_DRV_LF_MISC_CTL2\t(WSA884X_ANA_SPK_TOP_BASE + 0x2c)\n#define WSA884X_SPK_TOP_SPARE_TUNE_2\t(WSA884X_ANA_SPK_TOP_BASE + 0x2d)\n#define WSA884X_SPK_TOP_SPARE_TUNE_3\t(WSA884X_ANA_SPK_TOP_BASE + 0x2e)\n#define WSA884X_SPK_TOP_SPARE_TUNE_4\t(WSA884X_ANA_SPK_TOP_BASE + 0x2f)\n#define WSA884X_SPARE_TUNE_5\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x30)\n#define WSA884X_SPARE_TUNE_6\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x31)\n#define WSA884X_SPARE_TUNE_7\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x32)\n#define WSA884X_SPARE_TUNE_8\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x33)\n#define WSA884X_SPARE_TUNE_9\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x34)\n#define WSA884X_SPARE_TUNE_10\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x35)\n#define WSA884X_PA_STATUS0\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x36)\n#define WSA884X_PA_STATUS1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x37)\n#define WSA884X_PA_STATUS2\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x38)\n#define WSA884X_PA_STATUS3\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x39)\n#define WSA884X_PA_STATUS4\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x3a)\n#define WSA884X_PA_STATUS5\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x3b)\n#define WSA884X_SPARE_RO_1\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x3c)\n#define WSA884X_SPARE_RO_2\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x3d)\n#define WSA884X_SPARE_RO_3\t\t(WSA884X_ANA_SPK_TOP_BASE + 0x3e)\n\n#define WSA884X_ANA_BOOST_BASE\t\t(WSA884X_BASE + 0x0090)\n#define WSA884X_STB_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x00)\n#define WSA884X_STB_CTRL1_SLOPE_COMP_CURRENT_MASK\t\t0xf8\n#define WSA884X_STB_CTRL1_SLOPE_COMP_CURRENT_SHIFT\t\t3\n#define WSA884X_STB_CTRL1_VOUT_FS_MASK\t\t\t\t0x07\n#define WSA884X_STB_CTRL1_VOUT_FS_SHIFT\t\t\t\t0\n#define WSA884X_CURRENT_LIMIT\t\t(WSA884X_ANA_BOOST_BASE + 0x01)\n#define WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_OVRD_EN_MASK\t0x80\n#define WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_OVRD_EN_SHIFT\t7\n#define WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_MASK\t\t0x7c\n#define WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_SHIFT\t\t2\n#define WSA884X_CURRENT_LIMIT_CLK_PHASE_SHIFT\t\t\t0\n#define WSA884X_BYP_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x02)\n#define WSA884X_SPARE_CTL_0\t\t(WSA884X_ANA_BOOST_BASE + 0x03)\n#define WSA884X_BOOST_SPARE_CTL_1\t(WSA884X_ANA_BOOST_BASE + 0x04)\n#define WSA884X_SPARE_RO_0\t\t(WSA884X_ANA_BOOST_BASE + 0x05)\n#define WSA884X_BOOST_SPARE_RO_1\t(WSA884X_ANA_BOOST_BASE + 0x06)\n#define WSA884X_IBIAS1\t\t\t(WSA884X_ANA_BOOST_BASE + 0x07)\n#define WSA884X_IBIAS2\t\t\t(WSA884X_ANA_BOOST_BASE + 0x08)\n#define WSA884X_IBIAS3\t\t\t(WSA884X_ANA_BOOST_BASE + 0x09)\n#define WSA884X_EN_CTRL\t\t\t(WSA884X_ANA_BOOST_BASE + 0x0a)\n#define WSA884X_STB_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x0b)\n#define WSA884X_STB_CTRL3\t\t(WSA884X_ANA_BOOST_BASE + 0x0c)\n#define WSA884X_STB_CTRL4\t\t(WSA884X_ANA_BOOST_BASE + 0x0d)\n#define WSA884X_BYP_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x0e)\n#define WSA884X_BYP_CTRL3\t\t(WSA884X_ANA_BOOST_BASE + 0x0f)\n#define WSA884X_ZX_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x10)\n#define WSA884X_ZX_CTRL1_ZX_DET_EN_MASK\t\t\t\t0x80\n#define WSA884X_ZX_CTRL1_ZX_DET_EN_SHIFT\t\t\t7\n#define WSA884X_ZX_CTRL1_ZX_DET_SW_EN_MASK\t\t\t0x40\n#define WSA884X_ZX_CTRL1_ZX_DET_SW_EN_SHIFT\t\t\t6\n#define WSA884X_ZX_CTRL1_ZX_DET_STAGE_DEFAULT_MASK\t\t0x20\n#define WSA884X_ZX_CTRL1_ZX_DET_STAGE_DEFAULT_SHIFT\t\t5\n#define WSA884X_ZX_CTRL1_ZX_DET_SW_SEL_MASK\t\t\t0x18\n#define WSA884X_ZX_CTRL1_ZX_DET_SW_SEL_SHIFT\t\t\t3\n#define WSA884X_ZX_CTRL1_ZX_BYP_MASK_IGNORE_MASK\t\t0x04\n#define WSA884X_ZX_CTRL1_ZX_BYP_MASK_IGNORE_SHIFT\t\t2\n#define WSA884X_ZX_CTRL1_ZX_BYP_MASK_DEL_MASK\t\t\t0x02\n#define WSA884X_ZX_CTRL1_ZX_BYP_MASK_DEL_SHIFT\t\t\t1\n#define WSA884X_ZX_CTRL1_BOOTCAP_REFRESH_DIS_MASK\t\t0x01\n#define WSA884X_ZX_CTRL1_BOOTCAP_REFRESH_DIS_SHIFT\t\t0\n#define WSA884X_ZX_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x11)\n#define WSA884X_BLEEDER_CTRL\t\t(WSA884X_ANA_BOOST_BASE + 0x12)\n#define WSA884X_BOOST_MISC\t\t(WSA884X_ANA_BOOST_BASE + 0x13)\n#define WSA884X_PWRSTAGE_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x14)\n#define WSA884X_PWRSTAGE_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x15)\n#define WSA884X_PWRSTAGE_CTRL3\t\t(WSA884X_ANA_BOOST_BASE + 0x16)\n#define WSA884X_PWRSTAGE_CTRL4\t\t(WSA884X_ANA_BOOST_BASE + 0x17)\n#define WSA884X_MAXD_REG1\t\t(WSA884X_ANA_BOOST_BASE + 0x18)\n#define WSA884X_MAXD_REG2\t\t(WSA884X_ANA_BOOST_BASE + 0x19)\n#define WSA884X_ILIM_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x1a)\n#define WSA884X_ILIM_CTRL1_EN_AUTO_MAXD_SEL_MASK\t\t0x80\n#define WSA884X_ILIM_CTRL1_EN_AUTO_MAXD_SEL_SHIFT\t\t0x07\n#define WSA884X_ILIM_CTRL1_EN_ILIM_SW_CLH_MASK\t\t\t0x40\n#define WSA884X_ILIM_CTRL1_EN_ILIM_SW_CLH_SHIFT\t\t\t0x06\n#define WSA884X_ILIM_CTRL1_ILIM_OFFSET_CLH_MASK\t\t\t0x38\n#define WSA884X_ILIM_CTRL1_ILIM_OFFSET_CLH_SHIFT\t\t0x03\n#define WSA884X_ILIM_CTRL1_ILIM_OFFSET_PB_MASK\t\t\t0x07\n#define WSA884X_ILIM_CTRL1_ILIM_OFFSET_PB_SHIFT\t\t\t0x00\n#define WSA884X_ILIM_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x1b)\n#define WSA884X_TEST_CTRL1\t\t(WSA884X_ANA_BOOST_BASE + 0x1c)\n#define WSA884X_TEST_CTRL2\t\t(WSA884X_ANA_BOOST_BASE + 0x1d)\n#define WSA884X_SPARE1\t\t\t(WSA884X_ANA_BOOST_BASE + 0x1e)\n#define WSA884X_BOOT_CAP_CHECK\t\t(WSA884X_ANA_BOOST_BASE + 0x1f)\n\n#define WSA884X_ANA_PON_LDOL_BASE       (WSA884X_BASE + 0x00b0)\n#define WSA884X_PON_CTL_0\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x00)\n#define WSA884X_PWRSAV_CTL\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x01)\n#define WSA884X_PON_LDOL_SPARE_CTL_0\t(WSA884X_ANA_PON_LDOL_BASE + 0x02)\n#define WSA884X_PON_LDOL_SPARE_CTL_1\t(WSA884X_ANA_PON_LDOL_BASE + 0x03)\n#define WSA884X_PON_LDOL_SPARE_CTL_2\t(WSA884X_ANA_PON_LDOL_BASE + 0x04)\n#define WSA884X_PON_LDOL_SPARE_CTL_3\t(WSA884X_ANA_PON_LDOL_BASE + 0x05)\n#define WSA884X_PON_CLT_1\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x06)\n#define WSA884X_PON_CTL_2\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x07)\n#define WSA884X_PON_CTL_3\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x08)\n#define WSA884X_CKWD_CTL_0\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x09)\n#define WSA884X_CKWD_CTL_1\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0a)\n#define WSA884X_CKWD_CTL_1_VPP_SW_CTL_MASK\t\t0x20\n#define WSA884X_CKWD_CTL_1_VPP_SW_CTL_SHIFT\t\t5\n#define WSA884X_CKWD_CTL_1_CKWD_VCOMP_VREF_SEL_MASK\t0x1f\n#define WSA884X_CKWD_CTL_1_CKWD_VCOMP_VREF_SEL_SHIFT\t0\n#define WSA884X_CKWD_CTL_2\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0b)\n#define WSA884X_CKSK_CTL_0\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0c)\n#define WSA884X_PADSW_CTL_0\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0d)\n#define WSA884X_TEST_0\t\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0e)\n#define WSA884X_TEST_1\t\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x0f)\n#define WSA884X_STATUS_0\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x10)\n#define WSA884X_STATUS_1\t\t(WSA884X_ANA_PON_LDOL_BASE + 0x11)\n#define WSA884X_PON_LDOL_SPARE_TUNE_0\t(WSA884X_ANA_PON_LDOL_BASE + 0x12)\n#define WSA884X_PON_LDOL_SPARE_TUNE_1\t(WSA884X_ANA_PON_LDOL_BASE + 0x13)\n#define WSA884X_PON_LDOL_SPARE_TUNE_2\t(WSA884X_ANA_PON_LDOL_BASE + 0x14)\n#define WSA884X_PON_LDOL_SPARE_TUNE_3\t(WSA884X_ANA_PON_LDOL_BASE + 0x15)\n#define WSA884X_PON_LDOL_SPARE_TUNE_4\t(WSA884X_ANA_PON_LDOL_BASE + 0x16)\n\n#define WSA884X_DIG_CTRL0_BASE\t\t(WSA884X_BASE + 0x0400)\n#define WSA884X_DIG_CTRL0_PAGE\t\t(WSA884X_DIG_CTRL0_BASE + 0x00)\n#define WSA884X_CHIP_ID0\t\t(WSA884X_DIG_CTRL0_BASE + 0x01)\n#define WSA884X_CHIP_ID1\t\t(WSA884X_DIG_CTRL0_BASE + 0x02)\n#define WSA884X_CHIP_ID2\t\t(WSA884X_DIG_CTRL0_BASE + 0x03)\n#define WSA884X_CHIP_ID3\t\t(WSA884X_DIG_CTRL0_BASE + 0x04)\n#define WSA884X_BUS_ID\t\t\t(WSA884X_DIG_CTRL0_BASE + 0x05)\n#define WSA884X_CDC_RST_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x10)\n#define WSA884X_SWR_RESET_EN\t\t(WSA884X_DIG_CTRL0_BASE + 0x14)\n#define WSA884X_TOP_CLK_CFG\t\t(WSA884X_DIG_CTRL0_BASE + 0x18)\n#define WSA884X_SWR_CLK_RATE\t\t(WSA884X_DIG_CTRL0_BASE + 0x19)\n#define WSA884X_CDC_PATH_MODE\t\t(WSA884X_DIG_CTRL0_BASE + 0x1a)\n#define WSA884X_CDC_PATH_MODE_RXD_MODE_MASK\t\t0x02\n#define WSA884X_CDC_PATH_MODE_RXD_MODE_SHIFT\t\t0\n#define WSA884X_CDC_PATH_MODE_TXD_MODE_MASK\t\t0x01\n#define WSA884X_CDC_PATH_MODE_TXD_MODE_SHIFT\t\t0\n#define WSA884X_CDC_CLK_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x1c)\n#define WSA884X_PA_FSM_EN\t\t(WSA884X_DIG_CTRL0_BASE + 0x30)\n#define WSA884X_PA_FSM_EN_GLOBAL_PA_EN_MASK\t\t0x01\n#define WSA884X_PA_FSM_EN_GLOBAL_PA_EN_SHIFT\t\t0\n#define WSA884X_PA_FSM_CTL0\t\t(WSA884X_DIG_CTRL0_BASE + 0x31)\n#define WSA884X_PA_FSM_CTL1\t\t(WSA884X_DIG_CTRL0_BASE + 0x32)\n#define WSA884X_PA_FSM_CTL1_NOISE_GATE_BLOCK_MASK\t0x38\n#define WSA884X_PA_FSM_TIMER0\t\t(WSA884X_DIG_CTRL0_BASE + 0x33)\n#define WSA884X_PA_FSM_TIMER1\t\t(WSA884X_DIG_CTRL0_BASE + 0x34)\n#define WSA884X_PA_FSM_STA0\t\t(WSA884X_DIG_CTRL0_BASE + 0x35)\n#define WSA884X_PA_FSM_STA1\t\t(WSA884X_DIG_CTRL0_BASE + 0x36)\n#define WSA884X_PA_FSM_ERR_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x37)\n#define WSA884X_PA_FSM_ERR_COND0\t(WSA884X_DIG_CTRL0_BASE + 0x38)\n#define WSA884X_PA_FSM_ERR_COND1\t(WSA884X_DIG_CTRL0_BASE + 0x39)\n#define WSA884X_PA_FSM_MSK0\t\t(WSA884X_DIG_CTRL0_BASE + 0x3a)\n#define WSA884X_PA_FSM_MSK1\t\t(WSA884X_DIG_CTRL0_BASE + 0x3b)\n#define WSA884X_PA_FSM_BYP_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x3c)\n#define WSA884X_PA_FSM_BYP0\t\t(WSA884X_DIG_CTRL0_BASE + 0x3d)\n#define WSA884X_PA_FSM_BYP1\t\t(WSA884X_DIG_CTRL0_BASE + 0x3e)\n#define WSA884X_TADC_VALUE_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x50)\n#define WSA884X_TEMP_DETECT_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x51)\n#define WSA884X_TEMP_DIN_MSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x52)\n#define WSA884X_TEMP_DIN_LSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x53)\n#define WSA884X_TEMP_DOUT_MSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x54)\n#define WSA884X_TEMP_DOUT_LSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x55)\n#define WSA884X_TEMP_CONFIG0\t\t(WSA884X_DIG_CTRL0_BASE + 0x56)\n#define WSA884X_TEMP_CONFIG1\t\t(WSA884X_DIG_CTRL0_BASE + 0x57)\n#define WSA884X_VBAT_THRM_FLT_CTL\t(WSA884X_DIG_CTRL0_BASE + 0x58)\n#define WSA884X_VBAT_THRM_FLT_CTL_THRM_COEF_SEL_MASK\t\t0xe0\n#define WSA884X_VBAT_THRM_FLT_CTL_THRM_COEF_SEL_SHIFT\t\t5\n#define WSA884X_VBAT_THRM_FLT_CTL_THRM_FLT_EN_SHIFT\t\t4\n#define WSA884X_VBAT_THRM_FLT_CTL_VBAT_COEF_SEL_MASK\t\t0x0e\n#define WSA884X_VBAT_THRM_FLT_CTL_VBAT_COEF_SEL_SHIFT\t\t1\n#define WSA884X_VBAT_THRM_FLT_CTL_VBAT_FLT_EN_SHIFT\t\t0\n#define WSA884X_VBAT_CAL_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x59)\n#define WSA884X_VBAT_CAL_CTL_RESERVE_MASK\t\t\t0x0e\n#define WSA884X_VBAT_CAL_CTL_VBAT_CAL_EN_MASK\t\t\t0x01\n#define WSA884X_VBAT_DIN_MSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5a)\n#define WSA884X_VBAT_DIN_LSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5b)\n#define WSA884X_VBAT_DOUT_MSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5c)\n#define WSA884X_VBAT_DOUT_LSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5d)\n#define WSA884X_VBAT_CAL_MSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5e)\n#define WSA884X_VBAT_CAL_LSB\t\t(WSA884X_DIG_CTRL0_BASE + 0x5f)\n#define WSA884X_UVLO_DEGLITCH_CTL\t(WSA884X_DIG_CTRL0_BASE + 0x60)\n#define WSA884X_BOP_DEGLITCH_CTL\t(WSA884X_DIG_CTRL0_BASE + 0x61)\n#define WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_SETTING_MASK\t0x1e\n#define WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_SETTING_SHIFT\t1\n#define WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_EN_MASK\t\t0x1\n#define WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_EN_SHIFT\t\t0\n#define WSA884X_VBAT_ZONE_DETC_CTL\t(WSA884X_DIG_CTRL0_BASE + 0x64)\n#define WSA884X_CPS_CTL\t\t\t(WSA884X_DIG_CTRL0_BASE + 0x68)\n#define WSA884X_CDC_RX_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x70)\n#define WSA884X_CDC_SPK_DSM_A1_0\t(WSA884X_DIG_CTRL0_BASE + 0x71)\n#define WSA884X_CDC_SPK_DSM_A1_1\t(WSA884X_DIG_CTRL0_BASE + 0x72)\n#define WSA884X_CDC_SPK_DSM_A2_0\t(WSA884X_DIG_CTRL0_BASE + 0x73)\n#define WSA884X_CDC_SPK_DSM_A2_1\t(WSA884X_DIG_CTRL0_BASE + 0x74)\n#define WSA884X_CDC_SPK_DSM_A3_0\t(WSA884X_DIG_CTRL0_BASE + 0x75)\n#define WSA884X_CDC_SPK_DSM_A3_1\t(WSA884X_DIG_CTRL0_BASE + 0x76)\n#define WSA884X_CDC_SPK_DSM_A4_0\t(WSA884X_DIG_CTRL0_BASE + 0x77)\n#define WSA884X_CDC_SPK_DSM_A4_1\t(WSA884X_DIG_CTRL0_BASE + 0x78)\n#define WSA884X_CDC_SPK_DSM_A5_0\t(WSA884X_DIG_CTRL0_BASE + 0x79)\n#define WSA884X_CDC_SPK_DSM_A5_1\t(WSA884X_DIG_CTRL0_BASE + 0x7a)\n#define WSA884X_CDC_SPK_DSM_A6_0\t(WSA884X_DIG_CTRL0_BASE + 0x7b)\n#define WSA884X_CDC_SPK_DSM_A7_0\t(WSA884X_DIG_CTRL0_BASE + 0x7c)\n#define WSA884X_CDC_SPK_DSM_C_0\t\t(WSA884X_DIG_CTRL0_BASE + 0x7d)\n#define WSA884X_CDC_SPK_DSM_C_0_COEF_C3_MASK\t\t0xf0\n#define WSA884X_CDC_SPK_DSM_C_0_COEF_C3_SHIFT\t\t4\n#define WSA884X_CDC_SPK_DSM_C_0_COEF_C2_MASK\t\t0x0f\n#define WSA884X_CDC_SPK_DSM_C_0_COEF_C2_SHIFT\t\t0\n#define WSA884X_CDC_SPK_DSM_C_1\t\t(WSA884X_DIG_CTRL0_BASE + 0x7e)\n#define WSA884X_CDC_SPK_DSM_C_2\t\t(WSA884X_DIG_CTRL0_BASE + 0x7f)\n#define WSA884X_CDC_SPK_DSM_C_2_COEF_C7_MASK\t\t0xf0\n#define WSA884X_CDC_SPK_DSM_C_2_COEF_C7_SHIFT\t\t4\n#define WSA884X_CDC_SPK_DSM_C_2_COEF_C6_MASK\t\t0x0f\n#define WSA884X_CDC_SPK_DSM_C_2_COEF_C6_SHIFT\t\t0\n#define WSA884X_CDC_SPK_DSM_C_3\t\t(WSA884X_DIG_CTRL0_BASE + 0x80)\n#define WSA884X_CDC_SPK_DSM_C_3_COEF_C7_MASK\t\t0x3f\n#define WSA884X_CDC_SPK_DSM_C_3_COEF_C7_SHIFT\t\t0\n#define WSA884X_CDC_SPK_DSM_R1\t\t(WSA884X_DIG_CTRL0_BASE + 0x81)\n#define WSA884X_CDC_SPK_DSM_R2\t\t(WSA884X_DIG_CTRL0_BASE + 0x82)\n#define WSA884X_CDC_SPK_DSM_R3\t\t(WSA884X_DIG_CTRL0_BASE + 0x83)\n#define WSA884X_CDC_SPK_DSM_R4\t\t(WSA884X_DIG_CTRL0_BASE + 0x84)\n#define WSA884X_CDC_SPK_DSM_R5\t\t(WSA884X_DIG_CTRL0_BASE + 0x85)\n#define WSA884X_CDC_SPK_DSM_R6\t\t(WSA884X_DIG_CTRL0_BASE + 0x86)\n#define WSA884X_CDC_SPK_DSM_R7\t\t(WSA884X_DIG_CTRL0_BASE + 0x87)\n#define WSA884X_CDC_SPK_GAIN_PDM_0\t(WSA884X_DIG_CTRL0_BASE + 0x88)\n#define WSA884X_CDC_SPK_GAIN_PDM_1\t(WSA884X_DIG_CTRL0_BASE + 0x89)\n#define WSA884X_CDC_SPK_GAIN_PDM_2\t(WSA884X_DIG_CTRL0_BASE + 0x8a)\n#define WSA884X_PDM_WD_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0x8b)\n#define WSA884X_PDM_WD_CTL_HOLD_OFF_MASK\t\t0x04\n#define WSA884X_PDM_WD_CTL_HOLD_OFF_SHIFT\t\t2\n#define WSA884X_PDM_WD_CTL_TIME_OUT_SEL_MASK\t\t0x02\n#define WSA884X_PDM_WD_CTL_TIME_OUT_SEL_SHIFT\t\t1\n#define WSA884X_PDM_WD_CTL_PDM_WD_EN_MASK\t\t0x01\n#define WSA884X_PDM_WD_CTL_PDM_WD_EN_SHIFT\t\t0\n#define WSA884X_DEM_BYPASS_DATA0\t(WSA884X_DIG_CTRL0_BASE + 0x90)\n#define WSA884X_DEM_BYPASS_DATA1\t(WSA884X_DIG_CTRL0_BASE + 0x91)\n#define WSA884X_DEM_BYPASS_DATA2\t(WSA884X_DIG_CTRL0_BASE + 0x92)\n#define WSA884X_DEM_BYPASS_DATA3\t(WSA884X_DIG_CTRL0_BASE + 0x93)\n#define WSA884X_DRE_CTL_0\t\t(WSA884X_DIG_CTRL0_BASE + 0xb0)\n#define WSA884X_DRE_CTL_0_PROG_DELAY_MASK\t\t0xf0\n#define WSA884X_DRE_CTL_0_PROG_DELAY_SHIFT\t\t4\n#define WSA884X_DRE_CTL_0_OFFSET_MASK\t\t\t0x07\n#define WSA884X_DRE_CTL_0_OFFSET_SHIFT\t\t\t0\n#define WSA884X_DRE_CTL_1\t\t(WSA884X_DIG_CTRL0_BASE + 0xb1)\n#define WSA884X_DRE_CTL_1_CSR_GAIN_MASK\t\t\t0x3e\n#define WSA884X_DRE_CTL_1_CSR_GAIN_SHIFT\t\t1\n#define WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK\t\t0x01\n#define WSA884X_DRE_CTL_1_CSR_GAIN_EN_SHIFT\t\t0\n#define WSA884X_DRE_IDLE_DET_CTL\t(WSA884X_DIG_CTRL0_BASE + 0xb2)\n#define WSA884X_GAIN_RAMPING_CTL\t(WSA884X_DIG_CTRL0_BASE + 0xb8)\n#define WSA884X_GAIN_RAMPING_MIN\t(WSA884X_DIG_CTRL0_BASE + 0xb9)\n#define WSA884X_GAIN_RAMPING_MIN_MIN_GAIN_MASK\t\t0x1f\n#define WSA884X_GAIN_RAMPING_MIN_MIN_GAIN_SHIFT\t\t0\n#define WSA884X_TAGC_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0xc0)\n#define WSA884X_TAGC_TIME\t\t(WSA884X_DIG_CTRL0_BASE + 0xc1)\n#define WSA884X_TAGC_FORCE_VAL\t\t(WSA884X_DIG_CTRL0_BASE + 0xc2)\n#define WSA884X_VAGC_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0xc8)\n#define WSA884X_VAGC_TIME\t\t(WSA884X_DIG_CTRL0_BASE + 0xc9)\n#define WSA884X_VAGC_ATTN_LVL_1\t\t(WSA884X_DIG_CTRL0_BASE + 0xca)\n#define WSA884X_VAGC_ATTN_LVL_2\t\t(WSA884X_DIG_CTRL0_BASE + 0xcb)\n#define WSA884X_VAGC_ATTN_LVL_3\t\t(WSA884X_DIG_CTRL0_BASE + 0xcc)\n#define WSA884X_CLSH_CTL_0\t\t(WSA884X_DIG_CTRL0_BASE + 0xd0)\n#define WSA884X_CLSH_CTL_0_CSR_GAIN_EN_SHIFT\t\t7\n#define WSA884X_CLSH_CTL_0_DLY_CODE_MASK\t\t0x70\n#define WSA884X_CLSH_CTL_0_DLY_CODE_SHIFT\t\t4\n#define WSA884X_CLSH_CTL_0_DLY_RST_SHIFT\t\t3\n#define WSA884X_CLSH_CTL_0_DLY_EN_SHIFT\t\t\t2\n#define WSA884X_CLSH_CTL_0_INPUT_EN_SHIFT\t\t1\n#define WSA884X_CLSH_CTL_0_CLSH_EN_SHIFT\t\t0\n#define WSA884X_CLSH_CTL_1\t\t(WSA884X_DIG_CTRL0_BASE + 0xd1)\n#define WSA884X_CLSH_V_HD_PA\t\t(WSA884X_DIG_CTRL0_BASE + 0xd2)\n#define WSA884X_CLSH_V_PA_MIN\t\t(WSA884X_DIG_CTRL0_BASE + 0xd3)\n#define WSA884X_CLSH_OVRD_VAL\t\t(WSA884X_DIG_CTRL0_BASE + 0xd4)\n#define WSA884X_CLSH_HARD_MAX\t\t(WSA884X_DIG_CTRL0_BASE + 0xd5)\n#define WSA884X_CLSH_SOFT_MAX\t\t(WSA884X_DIG_CTRL0_BASE + 0xd6)\n#define WSA884X_CLSH_SIG_DP\t\t(WSA884X_DIG_CTRL0_BASE + 0xd7)\n#define WSA884X_PBR_DELAY_CTL\t\t(WSA884X_DIG_CTRL0_BASE + 0xd8)\n#define WSA884X_CLSH_SRL_MAX_PBR\t(WSA884X_DIG_CTRL0_BASE + 0xe0)\n#define WSA884X_PBR_MAX_VOLTAGE\t\t20\n#define WSA884X_PBR_MAX_CODE\t\t255\n#define WSA884X_VTH_TO_REG(vth) \\\n\t((vth) != 0 ? (((vth) - 150) * WSA884X_PBR_MAX_CODE / (WSA884X_PBR_MAX_VOLTAGE * 100) + 1) : 0)\n#define WSA884X_CLSH_VTH1\t\t(WSA884X_DIG_CTRL0_BASE + 0xe1)\n#define WSA884X_CLSH_VTH2\t\t(WSA884X_DIG_CTRL0_BASE + 0xe2)\n#define WSA884X_CLSH_VTH3\t\t(WSA884X_DIG_CTRL0_BASE + 0xe3)\n#define WSA884X_CLSH_VTH4\t\t(WSA884X_DIG_CTRL0_BASE + 0xe4)\n#define WSA884X_CLSH_VTH5\t\t(WSA884X_DIG_CTRL0_BASE + 0xe5)\n#define WSA884X_CLSH_VTH6\t\t(WSA884X_DIG_CTRL0_BASE + 0xe6)\n#define WSA884X_CLSH_VTH7\t\t(WSA884X_DIG_CTRL0_BASE + 0xe7)\n#define WSA884X_CLSH_VTH8\t\t(WSA884X_DIG_CTRL0_BASE + 0xe8)\n#define WSA884X_CLSH_VTH9\t\t(WSA884X_DIG_CTRL0_BASE + 0xe9)\n#define WSA884X_CLSH_VTH10\t\t(WSA884X_DIG_CTRL0_BASE + 0xea)\n#define WSA884X_CLSH_VTH11\t\t(WSA884X_DIG_CTRL0_BASE + 0xeb)\n#define WSA884X_CLSH_VTH12\t\t(WSA884X_DIG_CTRL0_BASE + 0xec)\n#define WSA884X_CLSH_VTH13\t\t(WSA884X_DIG_CTRL0_BASE + 0xed)\n#define WSA884X_CLSH_VTH14\t\t(WSA884X_DIG_CTRL0_BASE + 0xee)\n#define WSA884X_CLSH_VTH15\t\t(WSA884X_DIG_CTRL0_BASE + 0xef)\n\n#define WSA884X_DIG_CTRL1_BASE\t\t(WSA884X_BASE + 0x0500)\n#define WSA884X_DIG_CTRL1_PAGE\t\t(WSA884X_DIG_CTRL1_BASE + 0x00)\n#define WSA884X_VPHX_SYS_EN_STATUS\t(WSA884X_DIG_CTRL1_BASE + 0x01)\n#define WSA884X_ANA_WO_CTL_0\t\t(WSA884X_DIG_CTRL1_BASE + 0x04)\n#define WSA884X_ANA_WO_CTL_0_MODE_SHIFT\t\t0\n#define WSA884X_ANA_WO_CTL_0_VPHX_SYS_EN_MASK\t\t\t0xc0\n#define WSA884X_ANA_WO_CTL_0_PA_AUX_DISABLE\t\t\t0x0\n#define WSA884X_ANA_WO_CTL_0_PA_AUX_18_DB\t\t\t0xa\n#define WSA884X_ANA_WO_CTL_0_PA_AUX_0_DB\t\t\t0x7\n#define WSA884X_ANA_WO_CTL_0_PA_AUX_GAIN_MASK\t\t\t0x3c\n#define WSA884X_ANA_WO_CTL_0_PA_MIN_GAIN_BYP_MASK\t\t0x02\n#define WSA884X_ANA_WO_CTL_0_DAC_CM_CLAMP_EN_MODE_SPEAKER\t0x1\n#define WSA884X_ANA_WO_CTL_0_DAC_CM_CLAMP_EN_MASK\t\t0x01\n#define WSA884X_ANA_WO_CTL_1\t\t(WSA884X_DIG_CTRL1_BASE + 0x05)\n#define WSA884X_PIN_CTL\t\t\t(WSA884X_DIG_CTRL1_BASE + 0x10)\n#define WSA884X_PIN_CTL_OE\t\t(WSA884X_DIG_CTRL1_BASE + 0x11)\n#define WSA884X_PIN_WDATA_IOPAD\t\t(WSA884X_DIG_CTRL1_BASE + 0x12)\n#define WSA884X_PIN_STATUS\t\t(WSA884X_DIG_CTRL1_BASE + 0x13)\n#define WSA884X_I2C_SLAVE_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0x14)\n#define WSA884X_SPMI_PAD_CTL0\t\t(WSA884X_DIG_CTRL1_BASE + 0x15)\n#define WSA884X_SPMI_PAD_CTL1\t\t(WSA884X_DIG_CTRL1_BASE + 0x16)\n#define WSA884X_SPMI_PAD_CTL2\t\t(WSA884X_DIG_CTRL1_BASE + 0x17)\n#define WSA884X_MEM_CTL\t\t\t(WSA884X_DIG_CTRL1_BASE + 0x18)\n#define WSA884X_SWR_HM_TEST0\t\t(WSA884X_DIG_CTRL1_BASE + 0x19)\n#define WSA884X_SWR_HM_TEST1\t\t(WSA884X_DIG_CTRL1_BASE + 0x1a)\n#define WSA884X_OTP_CTRL0\t\t(WSA884X_DIG_CTRL1_BASE + 0x30)\n#define WSA884X_OTP_CTRL1\t\t(WSA884X_DIG_CTRL1_BASE + 0x31)\n#define WSA884X_OTP_CTRL2\t\t(WSA884X_DIG_CTRL1_BASE + 0x32)\n#define WSA884X_OTP_STAT\t\t(WSA884X_DIG_CTRL1_BASE + 0x33)\n#define WSA884X_OTP_PRG_TCSP0\t\t(WSA884X_DIG_CTRL1_BASE + 0x34)\n#define WSA884X_OTP_PRG_TCSP1\t\t(WSA884X_DIG_CTRL1_BASE + 0x35)\n#define WSA884X_OTP_PRG_TPPS\t\t(WSA884X_DIG_CTRL1_BASE + 0x36)\n#define WSA884X_OTP_PRG_TVPS\t\t(WSA884X_DIG_CTRL1_BASE + 0x37)\n#define WSA884X_OTP_PRG_TVPH\t\t(WSA884X_DIG_CTRL1_BASE + 0x38)\n#define WSA884X_OTP_PRG_TPPR0\t\t(WSA884X_DIG_CTRL1_BASE + 0x39)\n#define WSA884X_OTP_PRG_TPPR1\t\t(WSA884X_DIG_CTRL1_BASE + 0x3a)\n#define WSA884X_OTP_PRG_TPPH\t\t(WSA884X_DIG_CTRL1_BASE + 0x3b)\n#define WSA884X_OTP_PRG_END\t\t(WSA884X_DIG_CTRL1_BASE + 0x3c)\n#define WSA884X_WAVG_PLAY\t\t(WSA884X_DIG_CTRL1_BASE + 0x40)\n#define WSA884X_WAVG_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0x41)\n#define WSA884X_WAVG_LRA_PER_0\t\t(WSA884X_DIG_CTRL1_BASE + 0x43)\n#define WSA884X_WAVG_LRA_PER_1\t\t(WSA884X_DIG_CTRL1_BASE + 0x44)\n#define WSA884X_WAVG_DELTA_THETA_0\t(WSA884X_DIG_CTRL1_BASE + 0x45)\n#define WSA884X_WAVG_DELTA_THETA_1\t(WSA884X_DIG_CTRL1_BASE + 0x46)\n#define WSA884X_WAVG_DIRECT_AMP_0\t(WSA884X_DIG_CTRL1_BASE + 0x47)\n#define WSA884X_WAVG_DIRECT_AMP_1\t(WSA884X_DIG_CTRL1_BASE + 0x48)\n#define WSA884X_WAVG_PTRN_AMP0_0\t(WSA884X_DIG_CTRL1_BASE + 0x49)\n#define WSA884X_WAVG_PTRN_AMP0_1\t(WSA884X_DIG_CTRL1_BASE + 0x4a)\n#define WSA884X_WAVG_PTRN_AMP1_0\t(WSA884X_DIG_CTRL1_BASE + 0x4b)\n#define WSA884X_WAVG_PTRN_AMP1_1\t(WSA884X_DIG_CTRL1_BASE + 0x4c)\n#define WSA884X_WAVG_PTRN_AMP2_0\t(WSA884X_DIG_CTRL1_BASE + 0x4d)\n#define WSA884X_WAVG_PTRN_AMP2_1\t(WSA884X_DIG_CTRL1_BASE + 0x4e)\n#define WSA884X_WAVG_PTRN_AMP3_0\t(WSA884X_DIG_CTRL1_BASE + 0x4f)\n#define WSA884X_WAVG_PTRN_AMP3_1\t(WSA884X_DIG_CTRL1_BASE + 0x50)\n#define WSA884X_WAVG_PTRN_AMP4_0\t(WSA884X_DIG_CTRL1_BASE + 0x51)\n#define WSA884X_WAVG_PTRN_AMP4_1\t(WSA884X_DIG_CTRL1_BASE + 0x52)\n#define WSA884X_WAVG_PTRN_AMP5_0\t(WSA884X_DIG_CTRL1_BASE + 0x53)\n#define WSA884X_WAVG_PTRN_AMP5_1\t(WSA884X_DIG_CTRL1_BASE + 0x54)\n#define WSA884X_WAVG_PTRN_AMP6_0\t(WSA884X_DIG_CTRL1_BASE + 0x55)\n#define WSA884X_WAVG_PTRN_AMP6_1\t(WSA884X_DIG_CTRL1_BASE + 0x56)\n#define WSA884X_WAVG_PTRN_AMP7_0\t(WSA884X_DIG_CTRL1_BASE + 0x57)\n#define WSA884X_WAVG_PTRN_AMP7_1\t(WSA884X_DIG_CTRL1_BASE + 0x58)\n#define WSA884X_WAVG_PER_0_1\t\t(WSA884X_DIG_CTRL1_BASE + 0x59)\n#define WSA884X_WAVG_PER_2_3\t\t(WSA884X_DIG_CTRL1_BASE + 0x5a)\n#define WSA884X_WAVG_PER_4_5\t\t(WSA884X_DIG_CTRL1_BASE + 0x5b)\n#define WSA884X_WAVG_PER_6_7\t\t(WSA884X_DIG_CTRL1_BASE + 0x5c)\n#define WSA884X_WAVG_STA\t\t(WSA884X_DIG_CTRL1_BASE + 0x5d)\n#define WSA884X_INTR_MODE\t\t(WSA884X_DIG_CTRL1_BASE + 0x80)\n#define WSA884X_INTR_MASK0\t\t(WSA884X_DIG_CTRL1_BASE + 0x81)\n#define WSA884X_INTR_MASK1\t\t(WSA884X_DIG_CTRL1_BASE + 0x82)\n#define WSA884X_INTR_STATUS0\t\t(WSA884X_DIG_CTRL1_BASE + 0x83)\n#define WSA884X_INTR_STATUS1\t\t(WSA884X_DIG_CTRL1_BASE + 0x84)\n#define WSA884X_INTR_CLEAR0\t\t(WSA884X_DIG_CTRL1_BASE + 0x85)\n#define WSA884X_INTR_CLEAR1\t\t(WSA884X_DIG_CTRL1_BASE + 0x86)\n#define WSA884X_INTR_LEVEL0\t\t(WSA884X_DIG_CTRL1_BASE + 0x87)\n#define WSA884X_INTR_LEVEL1\t\t(WSA884X_DIG_CTRL1_BASE + 0x88)\n#define WSA884X_INTR_SET0\t\t(WSA884X_DIG_CTRL1_BASE + 0x89)\n#define WSA884X_INTR_SET1\t\t(WSA884X_DIG_CTRL1_BASE + 0x8a)\n#define WSA884X_INTR_TEST0\t\t(WSA884X_DIG_CTRL1_BASE + 0x8b)\n#define WSA884X_INTR_TEST1\t\t(WSA884X_DIG_CTRL1_BASE + 0x8c)\n#define WSA884X_PDM_TEST_MODE\t\t(WSA884X_DIG_CTRL1_BASE + 0xc0)\n#define WSA884X_ATE_TEST_MODE\t\t(WSA884X_DIG_CTRL1_BASE + 0xc1)\n#define WSA884X_PA_FSM_DBG\t\t(WSA884X_DIG_CTRL1_BASE + 0xc2)\n#define WSA884X_DIG_DEBUG_MODE\t\t(WSA884X_DIG_CTRL1_BASE + 0xc3)\n#define WSA884X_DIG_DEBUG_SEL\t\t(WSA884X_DIG_CTRL1_BASE + 0xc4)\n#define WSA884X_DIG_DEBUG_EN\t\t(WSA884X_DIG_CTRL1_BASE + 0xc5)\n#define WSA884X_TADC_DETECT_DBG_CTL\t(WSA884X_DIG_CTRL1_BASE + 0xc9)\n#define WSA884X_TADC_DEBUG_MSB\t\t(WSA884X_DIG_CTRL1_BASE + 0xca)\n#define WSA884X_TADC_DEBUG_LSB\t\t(WSA884X_DIG_CTRL1_BASE + 0xcb)\n#define WSA884X_SAMPLE_EDGE_SEL\t\t(WSA884X_DIG_CTRL1_BASE + 0xcc)\n#define WSA884X_SWR_EDGE_SEL\t\t(WSA884X_DIG_CTRL1_BASE + 0xcd)\n#define WSA884X_TEST_MODE_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0xce)\n#define WSA884X_IOPAD_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0xcf)\n#define WSA884X_ANA_CSR_DBG_ADD\t\t(WSA884X_DIG_CTRL1_BASE + 0xd0)\n#define WSA884X_ANA_CSR_DBG_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0xd1)\n#define WSA884X_CLK_DBG_CTL\t\t(WSA884X_DIG_CTRL1_BASE + 0xd2)\n#define WSA884X_SPARE_R\t\t\t(WSA884X_DIG_CTRL1_BASE + 0xf0)\n#define WSA884X_SPARE_0\t\t\t(WSA884X_DIG_CTRL1_BASE + 0xf1)\n#define WSA884X_SPARE_1\t\t\t(WSA884X_DIG_CTRL1_BASE + 0xf2)\n#define WSA884X_SPARE_2\t\t\t(WSA884X_DIG_CTRL1_BASE + 0xf3)\n#define WSA884X_SCODE\t\t\t(WSA884X_DIG_CTRL1_BASE + 0xff)\n\n#define WSA884X_DIG_TRIM_BASE\t\t(WSA884X_BASE + 0x0800)\n#define WSA884X_DIG_TRIM_PAGE\t\t(WSA884X_DIG_TRIM_BASE + 0x00)\n#define WSA884X_OTP_REG_0\t\t(WSA884X_DIG_TRIM_BASE + 0x80)\n#define WSA884X_OTP_ID_WSA8840\t\t0x0\n#define WSA884X_OTP_ID_WSA8845\t\t0x5\n#define WSA884X_OTP_ID_WSA8845H\t\t0xc\n#define WSA884X_OTP_REG_0_ID_MASK\t0x0f\n#define WSA884X_OTP_REG_1\t\t(WSA884X_DIG_TRIM_BASE + 0x81)\n#define WSA884X_OTP_REG_2\t\t(WSA884X_DIG_TRIM_BASE + 0x82)\n#define WSA884X_OTP_REG_3\t\t(WSA884X_DIG_TRIM_BASE + 0x83)\n#define WSA884X_OTP_REG_4\t\t(WSA884X_DIG_TRIM_BASE + 0x84)\n#define WSA884X_OTP_REG_5\t\t(WSA884X_DIG_TRIM_BASE + 0x85)\n#define WSA884X_OTP_REG_6\t\t(WSA884X_DIG_TRIM_BASE + 0x86)\n#define WSA884X_OTP_REG_7\t\t(WSA884X_DIG_TRIM_BASE + 0x87)\n#define WSA884X_OTP_REG_8\t\t(WSA884X_DIG_TRIM_BASE + 0x88)\n#define WSA884X_OTP_REG_9\t\t(WSA884X_DIG_TRIM_BASE + 0x89)\n#define WSA884X_OTP_REG_10\t\t(WSA884X_DIG_TRIM_BASE + 0x8a)\n#define WSA884X_OTP_REG_11\t\t(WSA884X_DIG_TRIM_BASE + 0x8b)\n#define WSA884X_OTP_REG_12\t\t(WSA884X_DIG_TRIM_BASE + 0x8c)\n#define WSA884X_OTP_REG_13\t\t(WSA884X_DIG_TRIM_BASE + 0x8d)\n#define WSA884X_OTP_REG_14\t\t(WSA884X_DIG_TRIM_BASE + 0x8e)\n#define WSA884X_OTP_REG_15\t\t(WSA884X_DIG_TRIM_BASE + 0x8f)\n#define WSA884X_OTP_REG_16\t\t(WSA884X_DIG_TRIM_BASE + 0x90)\n#define WSA884X_OTP_REG_17\t\t(WSA884X_DIG_TRIM_BASE + 0x91)\n#define WSA884X_OTP_REG_18\t\t(WSA884X_DIG_TRIM_BASE + 0x92)\n#define WSA884X_OTP_REG_19\t\t(WSA884X_DIG_TRIM_BASE + 0x93)\n#define WSA884X_OTP_REG_20\t\t(WSA884X_DIG_TRIM_BASE + 0x94)\n#define WSA884X_OTP_REG_21\t\t(WSA884X_DIG_TRIM_BASE + 0x95)\n#define WSA884X_OTP_REG_22\t\t(WSA884X_DIG_TRIM_BASE + 0x96)\n#define WSA884X_OTP_REG_23\t\t(WSA884X_DIG_TRIM_BASE + 0x97)\n#define WSA884X_OTP_REG_24\t\t(WSA884X_DIG_TRIM_BASE + 0x98)\n#define WSA884X_OTP_REG_25\t\t(WSA884X_DIG_TRIM_BASE + 0x99)\n#define WSA884X_OTP_REG_26\t\t(WSA884X_DIG_TRIM_BASE + 0x9a)\n#define WSA884X_OTP_REG_27\t\t(WSA884X_DIG_TRIM_BASE + 0x9b)\n#define WSA884X_OTP_REG_28\t\t(WSA884X_DIG_TRIM_BASE + 0x9c)\n#define WSA884X_OTP_REG_29\t\t(WSA884X_DIG_TRIM_BASE + 0x9d)\n#define WSA884X_OTP_REG_30\t\t(WSA884X_DIG_TRIM_BASE + 0x9e)\n#define WSA884X_OTP_REG_31\t\t(WSA884X_DIG_TRIM_BASE + 0x9f)\n#define WSA884X_OTP_REG_32\t\t(WSA884X_DIG_TRIM_BASE + 0xa0)\n#define WSA884X_OTP_REG_33\t\t(WSA884X_DIG_TRIM_BASE + 0xa1)\n#define WSA884X_OTP_REG_34\t\t(WSA884X_DIG_TRIM_BASE + 0xa2)\n#define WSA884X_OTP_REG_35\t\t(WSA884X_DIG_TRIM_BASE + 0xa3)\n#define WSA884X_OTP_REG_36\t\t(WSA884X_DIG_TRIM_BASE + 0xa4)\n#define WSA884X_OTP_REG_37\t\t(WSA884X_DIG_TRIM_BASE + 0xa5)\n#define WSA884X_OTP_REG_38\t\t(WSA884X_DIG_TRIM_BASE + 0xa6)\n#define WSA884X_OTP_REG_38_RESERVER_MASK\t\t0xf0\n#define WSA884X_OTP_REG_38_RESERVER_SHIFT\t\t4\n#define WSA884X_OTP_REG_38_BST_CFG_SEL_MASK\t\t0x08\n#define WSA884X_OTP_REG_38_BST_CFG_SEL_SHIFT\t\t3\n#define WSA884X_OTP_REG_38_BOOST_ILIM_TUNE_MASK\t\t0x07\n#define WSA884X_OTP_REG_38_BOOST_ILIM_TUNE_SHIFT\t0\n#define WSA884X_OTP_REG_39\t\t(WSA884X_DIG_TRIM_BASE + 0xa7)\n#define WSA884X_OTP_REG_40\t\t(WSA884X_DIG_TRIM_BASE + 0xa8)\n#define WSA884X_OTP_REG_40_SPARE_TYPE2_MASK\t\t0xc0\n#define WSA884X_OTP_REG_40_SPARE_TYPE2_SHIFT\t\t6\n#define WSA884X_OTP_REG_40_ISENSE_RESCAL_MASK\t\t0x3c\n#define WSA884X_OTP_REG_40_ISENSE_RESCAL_SHIFT\t\t2\n#define WSA884X_OTP_REG_40_ATE_BOOST_RDSON_TEST_MASK\t0x2\n#define WSA884X_OTP_REG_40_ATE_BOOST_RDSON_TEST_SHIFT\t1\n#define WSA884X_OTP_REG_40_ATE_CLASSD_RDSON_TEST_MASK\t0x1\n#define WSA884X_OTP_REG_40_ATE_CLASSD_RDSON_TEST_SHIFT\t0\n#define WSA884X_OTP_REG_41\t\t(WSA884X_DIG_TRIM_BASE + 0xa9)\n#define WSA884X_OTP_REG_63\t\t(WSA884X_DIG_TRIM_BASE + 0xbf)\n\n#define WSA884X_DIG_EMEM_BASE\t\t(WSA884X_BASE + 0x08C0)\n#define WSA884X_EMEM_0\t\t\t(WSA884X_DIG_EMEM_BASE + 0x00)\n#define WSA884X_EMEM_1\t\t\t(WSA884X_DIG_EMEM_BASE + 0x01)\n#define WSA884X_EMEM_2\t\t\t(WSA884X_DIG_EMEM_BASE + 0x02)\n#define WSA884X_EMEM_3\t\t\t(WSA884X_DIG_EMEM_BASE + 0x03)\n#define WSA884X_EMEM_4\t\t\t(WSA884X_DIG_EMEM_BASE + 0x04)\n#define WSA884X_EMEM_5\t\t\t(WSA884X_DIG_EMEM_BASE + 0x05)\n#define WSA884X_EMEM_6\t\t\t(WSA884X_DIG_EMEM_BASE + 0x06)\n#define WSA884X_EMEM_7\t\t\t(WSA884X_DIG_EMEM_BASE + 0x07)\n#define WSA884X_EMEM_8\t\t\t(WSA884X_DIG_EMEM_BASE + 0x08)\n#define WSA884X_EMEM_9\t\t\t(WSA884X_DIG_EMEM_BASE + 0x09)\n#define WSA884X_EMEM_10\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0a)\n#define WSA884X_EMEM_11\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0b)\n#define WSA884X_EMEM_12\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0c)\n#define WSA884X_EMEM_13\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0d)\n#define WSA884X_EMEM_14\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0e)\n#define WSA884X_EMEM_15\t\t\t(WSA884X_DIG_EMEM_BASE + 0x0f)\n#define WSA884X_EMEM_16\t\t\t(WSA884X_DIG_EMEM_BASE + 0x10)\n#define WSA884X_EMEM_17\t\t\t(WSA884X_DIG_EMEM_BASE + 0x11)\n#define WSA884X_EMEM_18\t\t\t(WSA884X_DIG_EMEM_BASE + 0x12)\n#define WSA884X_EMEM_19\t\t\t(WSA884X_DIG_EMEM_BASE + 0x13)\n#define WSA884X_EMEM_20\t\t\t(WSA884X_DIG_EMEM_BASE + 0x14)\n#define WSA884X_EMEM_21\t\t\t(WSA884X_DIG_EMEM_BASE + 0x15)\n#define WSA884X_EMEM_22\t\t\t(WSA884X_DIG_EMEM_BASE + 0x16)\n#define WSA884X_EMEM_23\t\t\t(WSA884X_DIG_EMEM_BASE + 0x17)\n#define WSA884X_EMEM_24\t\t\t(WSA884X_DIG_EMEM_BASE + 0x18)\n#define WSA884X_EMEM_25\t\t\t(WSA884X_DIG_EMEM_BASE + 0x19)\n#define WSA884X_EMEM_26\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1a)\n#define WSA884X_EMEM_27\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1b)\n#define WSA884X_EMEM_28\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1c)\n#define WSA884X_EMEM_29\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1d)\n#define WSA884X_EMEM_30\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1e)\n#define WSA884X_EMEM_31\t\t\t(WSA884X_DIG_EMEM_BASE + 0x1f)\n#define WSA884X_EMEM_32\t\t\t(WSA884X_DIG_EMEM_BASE + 0x20)\n#define WSA884X_EMEM_33\t\t\t(WSA884X_DIG_EMEM_BASE + 0x21)\n#define WSA884X_EMEM_34\t\t\t(WSA884X_DIG_EMEM_BASE + 0x22)\n#define WSA884X_EMEM_35\t\t\t(WSA884X_DIG_EMEM_BASE + 0x23)\n#define WSA884X_EMEM_36\t\t\t(WSA884X_DIG_EMEM_BASE + 0x24)\n#define WSA884X_EMEM_37\t\t\t(WSA884X_DIG_EMEM_BASE + 0x25)\n#define WSA884X_EMEM_38\t\t\t(WSA884X_DIG_EMEM_BASE + 0x26)\n#define WSA884X_EMEM_39\t\t\t(WSA884X_DIG_EMEM_BASE + 0x27)\n#define WSA884X_EMEM_40\t\t\t(WSA884X_DIG_EMEM_BASE + 0x28)\n#define WSA884X_EMEM_41\t\t\t(WSA884X_DIG_EMEM_BASE + 0x29)\n#define WSA884X_EMEM_42\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2a)\n#define WSA884X_EMEM_43\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2b)\n#define WSA884X_EMEM_44\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2c)\n#define WSA884X_EMEM_45\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2d)\n#define WSA884X_EMEM_46\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2e)\n#define WSA884X_EMEM_47\t\t\t(WSA884X_DIG_EMEM_BASE + 0x2f)\n#define WSA884X_EMEM_48\t\t\t(WSA884X_DIG_EMEM_BASE + 0x30)\n#define WSA884X_EMEM_49\t\t\t(WSA884X_DIG_EMEM_BASE + 0x31)\n#define WSA884X_EMEM_50\t\t\t(WSA884X_DIG_EMEM_BASE + 0x32)\n#define WSA884X_EMEM_51\t\t\t(WSA884X_DIG_EMEM_BASE + 0x33)\n#define WSA884X_EMEM_52\t\t\t(WSA884X_DIG_EMEM_BASE + 0x34)\n#define WSA884X_EMEM_53\t\t\t(WSA884X_DIG_EMEM_BASE + 0x35)\n#define WSA884X_EMEM_54\t\t\t(WSA884X_DIG_EMEM_BASE + 0x36)\n#define WSA884X_EMEM_55\t\t\t(WSA884X_DIG_EMEM_BASE + 0x37)\n#define WSA884X_EMEM_56\t\t\t(WSA884X_DIG_EMEM_BASE + 0x38)\n#define WSA884X_EMEM_57\t\t\t(WSA884X_DIG_EMEM_BASE + 0x39)\n#define WSA884X_EMEM_58\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3a)\n#define WSA884X_EMEM_59\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3b)\n#define WSA884X_EMEM_60\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3c)\n#define WSA884X_EMEM_61\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3d)\n#define WSA884X_EMEM_62\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3e)\n#define WSA884X_EMEM_63\t\t\t(WSA884X_DIG_EMEM_BASE + 0x3f)\n\n#define WSA884X_NUM_REGISTERS\t\t(WSA884X_EMEM_63 + 1)\n#define WSA884X_MAX_REGISTER\t\t(WSA884X_NUM_REGISTERS - 1)\n\n#define WSA884X_SUPPLIES_NUM\t\t2\n#define WSA884X_MAX_SWR_PORTS\t\t6\n#define WSA884X_RATES (SNDRV_PCM_RATE_8000 | SNDRV_PCM_RATE_16000 |\\\n\t\t\tSNDRV_PCM_RATE_32000 | SNDRV_PCM_RATE_48000 |\\\n\t\t\tSNDRV_PCM_RATE_96000 | SNDRV_PCM_RATE_192000 |\\\n\t\t\tSNDRV_PCM_RATE_384000)\n \n#define WSA884X_FRAC_RATES (SNDRV_PCM_RATE_44100 | SNDRV_PCM_RATE_88200 |\\\n\t\t\t\tSNDRV_PCM_RATE_176400 | SNDRV_PCM_RATE_352800)\n\n#define WSA884X_FORMATS (SNDRV_PCM_FMTBIT_S16_LE |\\\n\t\tSNDRV_PCM_FMTBIT_S24_LE |\\\n\t\tSNDRV_PCM_FMTBIT_S24_3LE | SNDRV_PCM_FMTBIT_S32_LE)\n\nstruct wsa884x_priv {\n\tstruct regmap *regmap;\n\tstruct device *dev;\n\tstruct regulator_bulk_data supplies[WSA884X_SUPPLIES_NUM];\n\tstruct sdw_slave *slave;\n\tstruct sdw_stream_config sconfig;\n\tstruct sdw_stream_runtime *sruntime;\n\tstruct sdw_port_config port_config[WSA884X_MAX_SWR_PORTS];\n\tstruct gpio_desc *sd_n;\n\tbool port_prepared[WSA884X_MAX_SWR_PORTS];\n\tbool port_enable[WSA884X_MAX_SWR_PORTS];\n\tunsigned int variant;\n\tint active_ports;\n\tint dev_mode;\n\tbool hw_init;\n};\n\nenum {\n\tCOMP_OFFSET0,\n\tCOMP_OFFSET1,\n\tCOMP_OFFSET2,\n\tCOMP_OFFSET3,\n\tCOMP_OFFSET4,\n};\n\nenum wsa884x_gain {\n\tG_21_DB = 0,\n\tG_19P5_DB,\n\tG_18_DB,\n\tG_16P5_DB,\n\tG_15_DB,\n\tG_13P5_DB,\n\tG_12_DB,\n\tG_10P5_DB,\n\tG_9_DB,\n\tG_7P5_DB,\n\tG_6_DB,\n\tG_4P5_DB,\n\tG_3_DB,\n\tG_1P5_DB,\n\tG_0_DB,\n\tG_M1P5_DB,\n\tG_M3_DB,\n\tG_M4P5_DB,\n\tG_M6_DB,\n\tG_MAX_DB,\n};\n\nenum wsa884x_isense {\n\tISENSE_6_DB = 0,\n\tISENSE_12_DB,\n\tISENSE_15_DB,\n\tISENSE_18_DB,\n};\n\nenum wsa884x_vsense {\n\tVSENSE_M12_DB = 0,\n\tVSENSE_M15_DB,\n\tVSENSE_M18_DB,\n\tVSENSE_M21_DB,\n\tVSENSE_M24_DB,\n};\n\nenum wsa884x_port_ids {\n\tWSA884X_PORT_DAC,\n\tWSA884X_PORT_COMP,\n\tWSA884X_PORT_BOOST,\n\tWSA884X_PORT_PBR,\n\tWSA884X_PORT_VISENSE,\n\tWSA884X_PORT_CPS,\n};\n\nstatic const char * const wsa884x_supply_name[] = {\n\t\"vdd-io\",\n\t\"vdd-1p8\",\n};\n\nstatic const char * const wsa884x_dev_mode_text[] = {\n\t\"Speaker\", \"Receiver\"\n};\n\nenum wsa884x_mode {\n\tWSA884X_SPEAKER,\n\tWSA884X_RECEIVER,\n};\n\nstatic const struct soc_enum wsa884x_dev_mode_enum =\n\tSOC_ENUM_SINGLE_EXT(ARRAY_SIZE(wsa884x_dev_mode_text), wsa884x_dev_mode_text);\n\nstatic struct sdw_dpn_prop wsa884x_sink_dpn_prop[WSA884X_MAX_SWR_PORTS] = {\n\t{\n\t\t.num = WSA884X_PORT_DAC + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t.num = WSA884X_PORT_COMP + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t.num = WSA884X_PORT_BOOST + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t.num = WSA884X_PORT_PBR + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t.num = WSA884X_PORT_VISENSE + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t.num = WSA884X_PORT_CPS + 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}\n};\n\nstatic const struct sdw_port_config wsa884x_pconfig[WSA884X_MAX_SWR_PORTS] = {\n\t{\n\t\t.num = WSA884X_PORT_DAC + 1,\n\t\t.ch_mask = 0x1,\n\t}, {\n\t\t.num = WSA884X_PORT_COMP + 1,\n\t\t.ch_mask = 0xf,\n\t}, {\n\t\t.num = WSA884X_PORT_BOOST + 1,\n\t\t.ch_mask = 0x3,\n\t}, {\n\t\t.num = WSA884X_PORT_PBR + 1,\n\t\t.ch_mask = 0x1,\n\t}, {\n\t\t.num = WSA884X_PORT_VISENSE + 1,\n\t\t.ch_mask = 0x3,\n\t}, {\n\t\t.num = WSA884X_PORT_CPS + 1,\n\t\t.ch_mask = 0x3,\n\t},\n};\n\nstatic struct reg_default wsa884x_defaults[] = {\n\t{ WSA884X_BG_CTRL,\t\t\t0xa5 },\n\t{ WSA884X_ADC_CTRL,\t\t\t0x00 },\n\t{ WSA884X_BOP1_PROG,\t\t\t0x22 },\n\t{ WSA884X_BOP2_PROG,\t\t\t0x44 },\n\t{ WSA884X_UVLO_PROG,\t\t\t0x99 },\n\t{ WSA884X_UVLO_PROG1,\t\t\t0x70 },\n\t{ WSA884X_SPARE_CTRL_0,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTRL_1,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTRL_2,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTRL_3,\t\t\t0x00 },\n\t{ WSA884X_REF_CTRL,\t\t\t0xd2 },\n\t{ WSA884X_BG_TEST_CTL,\t\t\t0x06 },\n\t{ WSA884X_BG_BIAS,\t\t\t0xd7 },\n\t{ WSA884X_ADC_PROG,\t\t\t0x08 },\n\t{ WSA884X_ADC_IREF_CTL,\t\t\t0x57 },\n\t{ WSA884X_ADC_ISENS_CTL,\t\t0x47 },\n\t{ WSA884X_ADC_CLK_CTL,\t\t\t0x87 },\n\t{ WSA884X_ADC_TEST_CTL,\t\t\t0x00 },\n\t{ WSA884X_ADC_BIAS,\t\t\t0x51 },\n\t{ WSA884X_VBAT_SNS,\t\t\t0xa0 },\n\t{ WSA884X_BOP_ATEST_SEL,\t\t0x00 },\n\t{ WSA884X_MISC0,\t\t\t0x04 },\n\t{ WSA884X_MISC1,\t\t\t0x75 },\n\t{ WSA884X_MISC2,\t\t\t0x00 },\n\t{ WSA884X_MISC3,\t\t\t0x10 },\n\t{ WSA884X_SPARE_TSBG_0,\t\t\t0x00 },\n\t{ WSA884X_SPARE_TUNE_0,\t\t\t0x00 },\n\t{ WSA884X_SPARE_TUNE_1,\t\t\t0x00 },\n\t{ WSA884X_VSENSE1,\t\t\t0xe7 },\n\t{ WSA884X_ISENSE2,\t\t\t0x27 },\n\t{ WSA884X_SPARE_CTL_1,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTL_2,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTL_3,\t\t\t0x00 },\n\t{ WSA884X_SPARE_CTL_4,\t\t\t0x00 },\n\t{ WSA884X_EN,\t\t\t\t0x10 },\n\t{ WSA884X_OVERRIDE1,\t\t\t0x00 },\n\t{ WSA884X_OVERRIDE2,\t\t\t0x08 },\n\t{ WSA884X_ISENSE1,\t\t\t0xd4 },\n\t{ WSA884X_ISENSE_CAL,\t\t\t0x00 },\n\t{ WSA884X_MISC,\t\t\t\t0x00 },\n\t{ WSA884X_ADC_0,\t\t\t0x00 },\n\t{ WSA884X_ADC_1,\t\t\t0x00 },\n\t{ WSA884X_ADC_2,\t\t\t0x40 },\n\t{ WSA884X_ADC_3,\t\t\t0x80 },\n\t{ WSA884X_ADC_4,\t\t\t0x25 },\n\t{ WSA884X_ADC_5,\t\t\t0x24 },\n\t{ WSA884X_ADC_6,\t\t\t0x0a },\n\t{ WSA884X_ADC_7,\t\t\t0x81 },\n\t{ WSA884X_IVSENSE_SPARE_TUNE_1,\t\t0x00 },\n\t{ WSA884X_SPARE_TUNE_2,\t\t\t0x00 },\n\t{ WSA884X_SPARE_TUNE_3,\t\t\t0x00 },\n\t{ WSA884X_SPARE_TUNE_4,\t\t\t0x00 },\n\t{ WSA884X_TOP_CTRL1,\t\t\t0xd3 },\n\t{ WSA884X_CLIP_DET_CTRL1,\t\t0x7e },\n\t{ WSA884X_CLIP_DET_CTRL2,\t\t0x4c },\n\t{ WSA884X_DAC_CTRL1,\t\t\t0xa4 },\n\t{ WSA884X_DAC_VCM_CTRL_REG1,\t\t0x02 },\n\t{ WSA884X_DAC_VCM_CTRL_REG2,\t\t0x00 },\n\t{ WSA884X_DAC_VCM_CTRL_REG3,\t\t0x00 },\n\t{ WSA884X_DAC_VCM_CTRL_REG4,\t\t0x00 },\n\t{ WSA884X_DAC_VCM_CTRL_REG5,\t\t0x00 },\n\t{ WSA884X_DAC_VCM_CTRL_REG6,\t\t0x00 },\n\t{ WSA884X_PWM_CLK_CTL,\t\t\t0x20 },\n\t{ WSA884X_DRV_LF_LDO_SEL,\t\t0xaa },\n\t{ WSA884X_OCP_CTL,\t\t\t0xc6 },\n\t{ WSA884X_PDRV_HS_CTL,\t\t\t0x52 },\n\t{ WSA884X_PDRV_LS_CTL,\t\t\t0x4a },\n\t{ WSA884X_SPK_TOP_SPARE_CTL_1,\t\t0x00 },\n\t{ WSA884X_SPK_TOP_SPARE_CTL_2,\t\t0x00 },\n\t{ WSA884X_SPK_TOP_SPARE_CTL_3,\t\t0x00 },\n\t{ WSA884X_SPK_TOP_SPARE_CTL_4,\t\t0x00 },\n\t{ WSA884X_SPARE_CTL_5,\t\t\t0x00 },\n\t{ WSA884X_DAC_EN_DEBUG_REG,\t\t0x00 },\n\t{ WSA884X_DAC_OPAMP_BIAS1_REG,\t\t0x48 },\n\t{ WSA884X_DAC_OPAMP_BIAS2_REG,\t\t0x48 },\n\t{ WSA884X_DAC_TUNE1,\t\t\t0x02 },\n\t{ WSA884X_DAC_VOLTAGE_CTRL_REG,\t\t0x05 },\n\t{ WSA884X_ATEST1_REG,\t\t\t0x00 },\n\t{ WSA884X_ATEST2_REG,\t\t\t0x00 },\n\t{ WSA884X_TOP_BIAS_REG1,\t\t0x6a },\n\t{ WSA884X_TOP_BIAS_REG2,\t\t0x65 },\n\t{ WSA884X_TOP_BIAS_REG3,\t\t0x55 },\n\t{ WSA884X_TOP_BIAS_REG4,\t\t0xa9 },\n\t{ WSA884X_PWRSTG_DBG2,\t\t\t0x21 },\n\t{ WSA884X_DRV_LF_BLK_EN,\t\t0x0f },\n\t{ WSA884X_DRV_LF_EN,\t\t\t0x0a },\n\t{ WSA884X_DRV_LF_MASK_DCC_CTL,\t\t0x08 },\n\t{ WSA884X_DRV_LF_MISC_CTL1,\t\t0x30 },\n\t{ WSA884X_DRV_LF_REG_GAIN,\t\t0x00 },\n\t{ WSA884X_DRV_OS_CAL_CTL,\t\t0x00 },\n\t{ WSA884X_DRV_OS_CAL_CTL1,\t\t0x90 },\n\t{ WSA884X_PWRSTG_DBG,\t\t\t0x08 },\n\t{ WSA884X_BBM_CTL,\t\t\t0x92 },\n\t{ WSA884X_TOP_MISC1,\t\t\t0x00 },\n\t{ WSA884X_DAC_VCM_CTRL_REG7,\t\t0x00 },\n\t{ WSA884X_TOP_BIAS_REG5,\t\t0x15 },\n\t{ WSA884X_DRV_LF_MISC_CTL2,\t\t0x00 },\n\t{ WSA884X_STB_CTRL1,\t\t\t0x42 },\n\t{ WSA884X_CURRENT_LIMIT,\t\t0x54 },\n\t{ WSA884X_BYP_CTRL1,\t\t\t0x01 },\n\t{ WSA884X_SPARE_CTL_0,\t\t\t0x00 },\n\t{ WSA884X_BOOST_SPARE_CTL_1,\t\t0x00 },\n\t{ WSA884X_IBIAS1,\t\t\t0x00 },\n\t{ WSA884X_IBIAS2,\t\t\t0x00 },\n\t{ WSA884X_IBIAS3,\t\t\t0x00 },\n\t{ WSA884X_EN_CTRL,\t\t\t0x42 },\n\t{ WSA884X_STB_CTRL2,\t\t\t0x03 },\n\t{ WSA884X_STB_CTRL3,\t\t\t0x3c },\n\t{ WSA884X_STB_CTRL4,\t\t\t0x30 },\n\t{ WSA884X_BYP_CTRL2,\t\t\t0x97 },\n\t{ WSA884X_BYP_CTRL3,\t\t\t0x11 },\n\t{ WSA884X_ZX_CTRL1,\t\t\t0xf0 },\n\t{ WSA884X_ZX_CTRL2,\t\t\t0x04 },\n\t{ WSA884X_BLEEDER_CTRL,\t\t\t0x04 },\n\t{ WSA884X_BOOST_MISC,\t\t\t0x62 },\n\t{ WSA884X_PWRSTAGE_CTRL1,\t\t0x00 },\n\t{ WSA884X_PWRSTAGE_CTRL2,\t\t0x31 },\n\t{ WSA884X_PWRSTAGE_CTRL3,\t\t0x81 },\n\t{ WSA884X_PWRSTAGE_CTRL4,\t\t0x5f },\n\t{ WSA884X_MAXD_REG1,\t\t\t0x00 },\n\t{ WSA884X_MAXD_REG2,\t\t\t0x5b },\n\t{ WSA884X_ILIM_CTRL1,\t\t\t0xe2 },\n\t{ WSA884X_ILIM_CTRL2,\t\t\t0x90 },\n\t{ WSA884X_TEST_CTRL1,\t\t\t0x00 },\n\t{ WSA884X_TEST_CTRL2,\t\t\t0x00 },\n\t{ WSA884X_SPARE1,\t\t\t0x00 },\n\t{ WSA884X_BOOT_CAP_CHECK,\t\t0x01 },\n\t{ WSA884X_PON_CTL_0,\t\t\t0x12 },\n\t{ WSA884X_PWRSAV_CTL,\t\t\t0xaa },\n\t{ WSA884X_PON_LDOL_SPARE_CTL_0,\t\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_CTL_1,\t\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_CTL_2,\t\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_CTL_3,\t\t0x00 },\n\t{ WSA884X_PON_CLT_1,\t\t\t0xe1 },\n\t{ WSA884X_PON_CTL_2,\t\t\t0x00 },\n\t{ WSA884X_PON_CTL_3,\t\t\t0x70 },\n\t{ WSA884X_CKWD_CTL_0,\t\t\t0x14 },\n\t{ WSA884X_CKWD_CTL_1,\t\t\t0x3b },\n\t{ WSA884X_CKWD_CTL_2,\t\t\t0x00 },\n\t{ WSA884X_CKSK_CTL_0,\t\t\t0x00 },\n\t{ WSA884X_PADSW_CTL_0,\t\t\t0x00 },\n\t{ WSA884X_TEST_0,\t\t\t0x00 },\n\t{ WSA884X_TEST_1,\t\t\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_TUNE_0,\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_TUNE_1,\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_TUNE_2,\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_TUNE_3,\t0x00 },\n\t{ WSA884X_PON_LDOL_SPARE_TUNE_4,\t0x00 },\n\t{ WSA884X_DIG_CTRL0_PAGE,\t\t0x00 },\n\t{ WSA884X_CDC_RST_CTL,\t\t\t0x01 },\n\t{ WSA884X_SWR_RESET_EN,\t\t\t0x00 },\n\t{ WSA884X_TOP_CLK_CFG,\t\t\t0x00 },\n\t{ WSA884X_SWR_CLK_RATE,\t\t\t0x00 },\n\t{ WSA884X_CDC_PATH_MODE,\t\t0x00 },\n\t{ WSA884X_CDC_CLK_CTL,\t\t\t0x1f },\n\t{ WSA884X_PA_FSM_EN,\t\t\t0x00 },\n\t{ WSA884X_PA_FSM_CTL0,\t\t\t0x00 },\n\t{ WSA884X_PA_FSM_CTL1,\t\t\t0xfe },\n\t{ WSA884X_PA_FSM_TIMER0,\t\t0x80 },\n\t{ WSA884X_PA_FSM_TIMER1,\t\t0x80 },\n\t{ WSA884X_PA_FSM_ERR_CTL,\t\t0x00 },\n\t{ WSA884X_PA_FSM_MSK0,\t\t\t0x00 },\n\t{ WSA884X_PA_FSM_MSK1,\t\t\t0x00 },\n\t{ WSA884X_PA_FSM_BYP_CTL,\t\t0x00 },\n\t{ WSA884X_PA_FSM_BYP0,\t\t\t0x00 },\n\t{ WSA884X_PA_FSM_BYP1,\t\t\t0x00 },\n\t{ WSA884X_TADC_VALUE_CTL,\t\t0x03 },\n\t{ WSA884X_TEMP_DETECT_CTL,\t\t0x01 },\n\t{ WSA884X_TEMP_CONFIG0,\t\t\t0x00 },\n\t{ WSA884X_TEMP_CONFIG1,\t\t\t0x00 },\n\t{ WSA884X_VBAT_THRM_FLT_CTL,\t\t0x7f },\n\t{ WSA884X_VBAT_CAL_CTL,\t\t\t0x01 },\n\t{ WSA884X_UVLO_DEGLITCH_CTL,\t\t0x05 },\n\t{ WSA884X_BOP_DEGLITCH_CTL,\t\t0x05 },\n\t{ WSA884X_VBAT_ZONE_DETC_CTL,\t\t0x31 },\n\t{ WSA884X_CPS_CTL,\t\t\t0x00 },\n\t{ WSA884X_CDC_RX_CTL,\t\t\t0xfe },\n\t{ WSA884X_CDC_SPK_DSM_A1_0,\t\t0x00 },\n\t{ WSA884X_CDC_SPK_DSM_A1_1,\t\t0x01 },\n\t{ WSA884X_CDC_SPK_DSM_A2_0,\t\t0x96 },\n\t{ WSA884X_CDC_SPK_DSM_A2_1,\t\t0x09 },\n\t{ WSA884X_CDC_SPK_DSM_A3_0,\t\t0xab },\n\t{ WSA884X_CDC_SPK_DSM_A3_1,\t\t0x05 },\n\t{ WSA884X_CDC_SPK_DSM_A4_0,\t\t0x1c },\n\t{ WSA884X_CDC_SPK_DSM_A4_1,\t\t0x02 },\n\t{ WSA884X_CDC_SPK_DSM_A5_0,\t\t0x17 },\n\t{ WSA884X_CDC_SPK_DSM_A5_1,\t\t0x02 },\n\t{ WSA884X_CDC_SPK_DSM_A6_0,\t\t0xaa },\n\t{ WSA884X_CDC_SPK_DSM_A7_0,\t\t0xe3 },\n\t{ WSA884X_CDC_SPK_DSM_C_0,\t\t0x69 },\n\t{ WSA884X_CDC_SPK_DSM_C_1,\t\t0x54 },\n\t{ WSA884X_CDC_SPK_DSM_C_2,\t\t0x02 },\n\t{ WSA884X_CDC_SPK_DSM_C_3,\t\t0x15 },\n\t{ WSA884X_CDC_SPK_DSM_R1,\t\t0xa4 },\n\t{ WSA884X_CDC_SPK_DSM_R2,\t\t0xb5 },\n\t{ WSA884X_CDC_SPK_DSM_R3,\t\t0x86 },\n\t{ WSA884X_CDC_SPK_DSM_R4,\t\t0x85 },\n\t{ WSA884X_CDC_SPK_DSM_R5,\t\t0xaa },\n\t{ WSA884X_CDC_SPK_DSM_R6,\t\t0xe2 },\n\t{ WSA884X_CDC_SPK_DSM_R7,\t\t0x62 },\n\t{ WSA884X_CDC_SPK_GAIN_PDM_0,\t\t0x00 },\n\t{ WSA884X_CDC_SPK_GAIN_PDM_1,\t\t0xfc },\n\t{ WSA884X_CDC_SPK_GAIN_PDM_2,\t\t0x05 },\n\t{ WSA884X_PDM_WD_CTL,\t\t\t0x00 },\n\t{ WSA884X_DEM_BYPASS_DATA0,\t\t0x00 },\n\t{ WSA884X_DEM_BYPASS_DATA1,\t\t0x00 },\n\t{ WSA884X_DEM_BYPASS_DATA2,\t\t0x00 },\n\t{ WSA884X_DEM_BYPASS_DATA3,\t\t0x00 },\n\t{ WSA884X_DRE_CTL_0,\t\t\t0x70 },\n\t{ WSA884X_DRE_CTL_1,\t\t\t0x04 },\n\t{ WSA884X_DRE_IDLE_DET_CTL,\t\t0x2f },\n\t{ WSA884X_GAIN_RAMPING_CTL,\t\t0x50 },\n\t{ WSA884X_GAIN_RAMPING_MIN,\t\t0x12 },\n\t{ WSA884X_TAGC_CTL,\t\t\t0x15 },\n\t{ WSA884X_TAGC_TIME,\t\t\t0xbc },\n\t{ WSA884X_TAGC_FORCE_VAL,\t\t0x00 },\n\t{ WSA884X_VAGC_CTL,\t\t\t0x01 },\n\t{ WSA884X_VAGC_TIME,\t\t\t0x0f },\n\t{ WSA884X_VAGC_ATTN_LVL_1,\t\t0x03 },\n\t{ WSA884X_VAGC_ATTN_LVL_2,\t\t0x06 },\n\t{ WSA884X_VAGC_ATTN_LVL_3,\t\t0x09 },\n\t{ WSA884X_CLSH_CTL_0,\t\t\t0x37 },\n\t{ WSA884X_CLSH_CTL_1,\t\t\t0x81 },\n\t{ WSA884X_CLSH_V_HD_PA,\t\t\t0x0c },\n\t{ WSA884X_CLSH_V_PA_MIN,\t\t0x00 },\n\t{ WSA884X_CLSH_OVRD_VAL,\t\t0x00 },\n\t{ WSA884X_CLSH_HARD_MAX,\t\t0xff },\n\t{ WSA884X_CLSH_SOFT_MAX,\t\t0xf5 },\n\t{ WSA884X_CLSH_SIG_DP,\t\t\t0x00 },\n\t{ WSA884X_PBR_DELAY_CTL,\t\t0x07 },\n\t{ WSA884X_CLSH_SRL_MAX_PBR,\t\t0x02 },\n\t{ WSA884X_CLSH_VTH1,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH2,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH3,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH4,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH5,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH6,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH7,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH8,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH9,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH10,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH11,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH12,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH13,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH14,\t\t\t0x00 },\n\t{ WSA884X_CLSH_VTH15,\t\t\t0x00 },\n\t{ WSA884X_DIG_CTRL1_PAGE,\t\t0x00 },\n\t{ WSA884X_PIN_CTL,\t\t\t0x04 },\n\t{ WSA884X_PIN_CTL_OE,\t\t\t0x00 },\n\t{ WSA884X_PIN_WDATA_IOPAD,\t\t0x00 },\n\t{ WSA884X_I2C_SLAVE_CTL,\t\t0x00 },\n\t{ WSA884X_SPMI_PAD_CTL0,\t\t0x2f },\n\t{ WSA884X_SPMI_PAD_CTL1,\t\t0x2f },\n\t{ WSA884X_SPMI_PAD_CTL2,\t\t0x2f },\n\t{ WSA884X_MEM_CTL,\t\t\t0x00 },\n\t{ WSA884X_SWR_HM_TEST0,\t\t\t0x08 },\n\t{ WSA884X_OTP_CTRL0,\t\t\t0x00 },\n\t{ WSA884X_OTP_CTRL2,\t\t\t0x00 },\n\t{ WSA884X_OTP_PRG_TCSP0,\t\t0x77 },\n\t{ WSA884X_OTP_PRG_TCSP1,\t\t0x00 },\n\t{ WSA884X_OTP_PRG_TPPS,\t\t\t0x47 },\n\t{ WSA884X_OTP_PRG_TVPS,\t\t\t0x3b },\n\t{ WSA884X_OTP_PRG_TVPH,\t\t\t0x47 },\n\t{ WSA884X_OTP_PRG_TPPR0,\t\t0x47 },\n\t{ WSA884X_OTP_PRG_TPPR1,\t\t0x00 },\n\t{ WSA884X_OTP_PRG_TPPH,\t\t\t0x47 },\n\t{ WSA884X_OTP_PRG_END,\t\t\t0x47 },\n\t{ WSA884X_WAVG_PLAY,\t\t\t0x00 },\n\t{ WSA884X_WAVG_CTL,\t\t\t0x06 },\n\t{ WSA884X_WAVG_LRA_PER_0,\t\t0xd1 },\n\t{ WSA884X_WAVG_LRA_PER_1,\t\t0x00 },\n\t{ WSA884X_WAVG_DELTA_THETA_0,\t\t0xe6 },\n\t{ WSA884X_WAVG_DELTA_THETA_1,\t\t0x04 },\n\t{ WSA884X_WAVG_DIRECT_AMP_0,\t\t0x50 },\n\t{ WSA884X_WAVG_DIRECT_AMP_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP0_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP0_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP1_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP1_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP2_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP2_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP3_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP3_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP4_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP4_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP5_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP5_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP6_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP6_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PTRN_AMP7_0,\t\t0x50 },\n\t{ WSA884X_WAVG_PTRN_AMP7_1,\t\t0x00 },\n\t{ WSA884X_WAVG_PER_0_1,\t\t\t0x88 },\n\t{ WSA884X_WAVG_PER_2_3,\t\t\t0x88 },\n\t{ WSA884X_WAVG_PER_4_5,\t\t\t0x88 },\n\t{ WSA884X_WAVG_PER_6_7,\t\t\t0x88 },\n\t{ WSA884X_INTR_MODE,\t\t\t0x00 },\n\t{ WSA884X_INTR_MASK0,\t\t\t0x90 },\n\t{ WSA884X_INTR_MASK1,\t\t\t0x00 },\n\t{ WSA884X_INTR_CLEAR0,\t\t\t0x00 },\n\t{ WSA884X_INTR_CLEAR1,\t\t\t0x00 },\n\t{ WSA884X_INTR_LEVEL0,\t\t\t0x04 },\n\t{ WSA884X_INTR_LEVEL1,\t\t\t0x00 },\n\t{ WSA884X_INTR_SET0,\t\t\t0x00 },\n\t{ WSA884X_INTR_SET1,\t\t\t0x00 },\n\t{ WSA884X_INTR_TEST0,\t\t\t0x00 },\n\t{ WSA884X_INTR_TEST1,\t\t\t0x00 },\n\t{ WSA884X_PDM_TEST_MODE,\t\t0x00 },\n\t{ WSA884X_PA_FSM_DBG,\t\t\t0x00 },\n\t{ WSA884X_DIG_DEBUG_MODE,\t\t0x00 },\n\t{ WSA884X_DIG_DEBUG_SEL,\t\t0x00 },\n\t{ WSA884X_DIG_DEBUG_EN,\t\t\t0x00 },\n\t{ WSA884X_TADC_DETECT_DBG_CTL,\t\t0x00 },\n\t{ WSA884X_TADC_DEBUG_MSB,\t\t0x00 },\n\t{ WSA884X_TADC_DEBUG_LSB,\t\t0x00 },\n\t{ WSA884X_SAMPLE_EDGE_SEL,\t\t0x7f },\n\t{ WSA884X_SWR_EDGE_SEL,\t\t\t0x00 },\n\t{ WSA884X_TEST_MODE_CTL,\t\t0x05 },\n\t{ WSA884X_IOPAD_CTL,\t\t\t0x00 },\n\t{ WSA884X_ANA_CSR_DBG_ADD,\t\t0x00 },\n\t{ WSA884X_ANA_CSR_DBG_CTL,\t\t0x12 },\n\t{ WSA884X_CLK_DBG_CTL,\t\t\t0x00 },\n\t{ WSA884X_SPARE_0,\t\t\t0x00 },\n\t{ WSA884X_SPARE_1,\t\t\t0x00 },\n\t{ WSA884X_SPARE_2,\t\t\t0x00 },\n\t{ WSA884X_SCODE,\t\t\t0x00 },\n\t{ WSA884X_DIG_TRIM_PAGE,\t\t0x00 },\n\t{ WSA884X_EMEM_0,\t\t\t0x00 },\n\t{ WSA884X_EMEM_1,\t\t\t0x00 },\n\t{ WSA884X_EMEM_2,\t\t\t0x00 },\n\t{ WSA884X_EMEM_3,\t\t\t0x00 },\n\t{ WSA884X_EMEM_4,\t\t\t0x00 },\n\t{ WSA884X_EMEM_5,\t\t\t0x00 },\n\t{ WSA884X_EMEM_6,\t\t\t0x00 },\n\t{ WSA884X_EMEM_7,\t\t\t0x00 },\n\t{ WSA884X_EMEM_8,\t\t\t0x00 },\n\t{ WSA884X_EMEM_9,\t\t\t0x00 },\n\t{ WSA884X_EMEM_10,\t\t\t0x00 },\n\t{ WSA884X_EMEM_11,\t\t\t0x00 },\n\t{ WSA884X_EMEM_12,\t\t\t0x00 },\n\t{ WSA884X_EMEM_13,\t\t\t0x00 },\n\t{ WSA884X_EMEM_14,\t\t\t0x00 },\n\t{ WSA884X_EMEM_15,\t\t\t0x00 },\n\t{ WSA884X_EMEM_16,\t\t\t0x00 },\n\t{ WSA884X_EMEM_17,\t\t\t0x00 },\n\t{ WSA884X_EMEM_18,\t\t\t0x00 },\n\t{ WSA884X_EMEM_19,\t\t\t0x00 },\n\t{ WSA884X_EMEM_20,\t\t\t0x00 },\n\t{ WSA884X_EMEM_21,\t\t\t0x00 },\n\t{ WSA884X_EMEM_22,\t\t\t0x00 },\n\t{ WSA884X_EMEM_23,\t\t\t0x00 },\n\t{ WSA884X_EMEM_24,\t\t\t0x00 },\n\t{ WSA884X_EMEM_25,\t\t\t0x00 },\n\t{ WSA884X_EMEM_26,\t\t\t0x00 },\n\t{ WSA884X_EMEM_27,\t\t\t0x00 },\n\t{ WSA884X_EMEM_28,\t\t\t0x00 },\n\t{ WSA884X_EMEM_29,\t\t\t0x00 },\n\t{ WSA884X_EMEM_30,\t\t\t0x00 },\n\t{ WSA884X_EMEM_31,\t\t\t0x00 },\n\t{ WSA884X_EMEM_32,\t\t\t0x00 },\n\t{ WSA884X_EMEM_33,\t\t\t0x00 },\n\t{ WSA884X_EMEM_34,\t\t\t0x00 },\n\t{ WSA884X_EMEM_35,\t\t\t0x00 },\n\t{ WSA884X_EMEM_36,\t\t\t0x00 },\n\t{ WSA884X_EMEM_37,\t\t\t0x00 },\n\t{ WSA884X_EMEM_38,\t\t\t0x00 },\n\t{ WSA884X_EMEM_39,\t\t\t0x00 },\n\t{ WSA884X_EMEM_40,\t\t\t0x00 },\n\t{ WSA884X_EMEM_41,\t\t\t0x00 },\n\t{ WSA884X_EMEM_42,\t\t\t0x00 },\n\t{ WSA884X_EMEM_43,\t\t\t0x00 },\n\t{ WSA884X_EMEM_44,\t\t\t0x00 },\n\t{ WSA884X_EMEM_45,\t\t\t0x00 },\n\t{ WSA884X_EMEM_46,\t\t\t0x00 },\n\t{ WSA884X_EMEM_47,\t\t\t0x00 },\n\t{ WSA884X_EMEM_48,\t\t\t0x00 },\n\t{ WSA884X_EMEM_49,\t\t\t0x00 },\n\t{ WSA884X_EMEM_50,\t\t\t0x00 },\n\t{ WSA884X_EMEM_51,\t\t\t0x00 },\n\t{ WSA884X_EMEM_52,\t\t\t0x00 },\n\t{ WSA884X_EMEM_53,\t\t\t0x00 },\n\t{ WSA884X_EMEM_54,\t\t\t0x00 },\n\t{ WSA884X_EMEM_55,\t\t\t0x00 },\n\t{ WSA884X_EMEM_56,\t\t\t0x00 },\n\t{ WSA884X_EMEM_57,\t\t\t0x00 },\n\t{ WSA884X_EMEM_58,\t\t\t0x00 },\n\t{ WSA884X_EMEM_59,\t\t\t0x00 },\n\t{ WSA884X_EMEM_60,\t\t\t0x00 },\n\t{ WSA884X_EMEM_61,\t\t\t0x00 },\n\t{ WSA884X_EMEM_62,\t\t\t0x00 },\n\t{ WSA884X_EMEM_63,\t\t\t0x00 },\n};\n\nstatic bool wsa884x_readonly_register(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase WSA884X_DOUT_MSB:\n\tcase WSA884X_DOUT_LSB:\n\tcase WSA884X_STATUS:\n\tcase WSA884X_SPK_TOP_SPARE_TUNE_2:\n\tcase WSA884X_SPK_TOP_SPARE_TUNE_3:\n\tcase WSA884X_SPK_TOP_SPARE_TUNE_4:\n\tcase WSA884X_SPARE_TUNE_5:\n\tcase WSA884X_SPARE_TUNE_6:\n\tcase WSA884X_SPARE_TUNE_7:\n\tcase WSA884X_SPARE_TUNE_8:\n\tcase WSA884X_SPARE_TUNE_9:\n\tcase WSA884X_SPARE_TUNE_10:\n\tcase WSA884X_PA_STATUS0:\n\tcase WSA884X_PA_STATUS1:\n\tcase WSA884X_PA_STATUS2:\n\tcase WSA884X_PA_STATUS3:\n\tcase WSA884X_PA_STATUS4:\n\tcase WSA884X_PA_STATUS5:\n\tcase WSA884X_SPARE_RO_1:\n\tcase WSA884X_SPARE_RO_2:\n\tcase WSA884X_SPARE_RO_3:\n\tcase WSA884X_SPARE_RO_0:\n\tcase WSA884X_BOOST_SPARE_RO_1:\n\tcase WSA884X_STATUS_0:\n\tcase WSA884X_STATUS_1:\n\tcase WSA884X_CHIP_ID0:\n\tcase WSA884X_CHIP_ID1:\n\tcase WSA884X_CHIP_ID2:\n\tcase WSA884X_CHIP_ID3:\n\tcase WSA884X_BUS_ID:\n\tcase WSA884X_PA_FSM_STA0:\n\tcase WSA884X_PA_FSM_STA1:\n\tcase WSA884X_PA_FSM_ERR_COND0:\n\tcase WSA884X_PA_FSM_ERR_COND1:\n\tcase WSA884X_TEMP_DIN_MSB:\n\tcase WSA884X_TEMP_DIN_LSB:\n\tcase WSA884X_TEMP_DOUT_MSB:\n\tcase WSA884X_TEMP_DOUT_LSB:\n\tcase WSA884X_VBAT_DIN_MSB:\n\tcase WSA884X_VBAT_DIN_LSB:\n\tcase WSA884X_VBAT_DOUT_MSB:\n\tcase WSA884X_VBAT_DOUT_LSB:\n\tcase WSA884X_VBAT_CAL_MSB:\n\tcase WSA884X_VBAT_CAL_LSB:\n\tcase WSA884X_VPHX_SYS_EN_STATUS:\n\tcase WSA884X_PIN_STATUS:\n\tcase WSA884X_SWR_HM_TEST1:\n\tcase WSA884X_OTP_CTRL1:\n\tcase WSA884X_OTP_STAT:\n\tcase WSA884X_WAVG_STA:\n\tcase WSA884X_INTR_STATUS0:\n\tcase WSA884X_INTR_STATUS1:\n\tcase WSA884X_ATE_TEST_MODE:\n\tcase WSA884X_SPARE_R:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic bool wsa884x_writeable_register(struct device *dev, unsigned int reg)\n{\n\treturn !wsa884x_readonly_register(dev, reg);\n}\n\nstatic bool wsa884x_volatile_register(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase WSA884X_ANA_WO_CTL_0:\n\tcase WSA884X_ANA_WO_CTL_1:\n\t\treturn true;\n\t}\n\treturn wsa884x_readonly_register(dev, reg);\n}\n\nstatic struct regmap_config wsa884x_regmap_config = {\n\t.reg_bits = 32,\n\t.val_bits = 8,\n\t.cache_type = REGCACHE_MAPLE,\n\t.reg_defaults = wsa884x_defaults,\n\t.max_register = WSA884X_MAX_REGISTER,\n\t.num_reg_defaults = ARRAY_SIZE(wsa884x_defaults),\n\t.volatile_reg = wsa884x_volatile_register,\n\t.writeable_reg = wsa884x_writeable_register,\n\t.reg_format_endian = REGMAP_ENDIAN_NATIVE,\n\t.val_format_endian = REGMAP_ENDIAN_NATIVE,\n\t.use_single_read = true,\n};\n\nstatic const struct reg_sequence wsa884x_reg_init[] = {\n\t{ WSA884X_BOP2_PROG, FIELD_PREP_CONST(WSA884X_BOP2_PROG_BOP2_VTH_MASK, 0x6) |\n\t\t\t     FIELD_PREP_CONST(WSA884X_BOP2_PROG_BOP2_HYST_MASK, 0x6) },\n\t{ WSA884X_REF_CTRL, (0xd2 & ~WSA884X_REF_CTRL_BG_RDY_SEL_MASK) |\n\t\t\t    FIELD_PREP_CONST(WSA884X_REF_CTRL_BG_RDY_SEL_MASK, 0x1) },\n\t \n\t{ WSA884X_STB_CTRL1, (0x42 & ~WSA884X_STB_CTRL1_SLOPE_COMP_CURRENT_MASK) |\n\t\t\t     FIELD_PREP_CONST(WSA884X_STB_CTRL1_SLOPE_COMP_CURRENT_MASK, 0xd) },\n\t{ WSA884X_CURRENT_LIMIT, (0x54 & ~WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_MASK) |\n\t\t\t\t FIELD_PREP_CONST(WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_MASK, 0x9) },\n\t{ WSA884X_ZX_CTRL1, (0xf0 & ~WSA884X_ZX_CTRL1_ZX_DET_SW_SEL_MASK) |\n\t\t\t    FIELD_PREP_CONST(WSA884X_ZX_CTRL1_ZX_DET_SW_SEL_MASK, 0x3) },\n\t{ WSA884X_ILIM_CTRL1, (0xe2 & ~WSA884X_ILIM_CTRL1_ILIM_OFFSET_PB_MASK) |\n\t\t\t      FIELD_PREP_CONST(WSA884X_ILIM_CTRL1_ILIM_OFFSET_PB_MASK, 0x3) },\n\t{ WSA884X_CKWD_CTL_1, FIELD_PREP_CONST(WSA884X_CKWD_CTL_1_VPP_SW_CTL_MASK, 0x0) |\n\t\t\t      FIELD_PREP_CONST(WSA884X_CKWD_CTL_1_CKWD_VCOMP_VREF_SEL_MASK, 0x13) },\n\t{ WSA884X_PA_FSM_CTL1, (0xfe & ~WSA884X_PA_FSM_CTL1_NOISE_GATE_BLOCK_MASK) |\n\t\t\t       FIELD_PREP_CONST(WSA884X_PA_FSM_CTL1_NOISE_GATE_BLOCK_MASK, 0x4) },  \n\t{ WSA884X_VBAT_THRM_FLT_CTL, (0x7f & ~WSA884X_VBAT_THRM_FLT_CTL_VBAT_COEF_SEL_MASK) |\n\t\t\t\t     FIELD_PREP_CONST(WSA884X_VBAT_THRM_FLT_CTL_VBAT_COEF_SEL_MASK, 0x4) },\n\t{ WSA884X_VBAT_CAL_CTL, FIELD_PREP_CONST(WSA884X_VBAT_CAL_CTL_RESERVE_MASK, 0x2) |\n\t\t\t\tFIELD_PREP_CONST(WSA884X_VBAT_CAL_CTL_VBAT_CAL_EN_MASK, 0x1) },\n\t{ WSA884X_BOP_DEGLITCH_CTL, FIELD_PREP_CONST(WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_SETTING_MASK, 0x8) |\n\t\t\t\t    FIELD_PREP_CONST(WSA884X_BOP_DEGLITCH_CTL_BOP_DEGLITCH_EN_MASK, 0x1) },\n\t{ WSA884X_CDC_SPK_DSM_A2_0, 0x0a },\n\t{ WSA884X_CDC_SPK_DSM_A2_1, 0x08 },\n\t{ WSA884X_CDC_SPK_DSM_A3_0, 0xf3 },\n\t{ WSA884X_CDC_SPK_DSM_A3_1, 0x07 },\n\t{ WSA884X_CDC_SPK_DSM_A4_0, 0x79 },\n\t{ WSA884X_CDC_SPK_DSM_A5_0, 0x0b },\n\t{ WSA884X_CDC_SPK_DSM_A6_0, 0x8a },\n\t{ WSA884X_CDC_SPK_DSM_A7_0, 0x9b },\n\t{ WSA884X_CDC_SPK_DSM_C_0, FIELD_PREP_CONST(WSA884X_CDC_SPK_DSM_C_0_COEF_C3_MASK, 0x6) |\n\t\t\t\t   FIELD_PREP_CONST(WSA884X_CDC_SPK_DSM_C_0_COEF_C2_MASK, 0x8) },\n\t{ WSA884X_CDC_SPK_DSM_C_2, FIELD_PREP_CONST(WSA884X_CDC_SPK_DSM_C_2_COEF_C7_MASK, 0xf) },\n\t{ WSA884X_CDC_SPK_DSM_C_3, FIELD_PREP_CONST(WSA884X_CDC_SPK_DSM_C_3_COEF_C7_MASK, 0x20) },\n\t{ WSA884X_CDC_SPK_DSM_R1, 0x83 },\n\t{ WSA884X_CDC_SPK_DSM_R2, 0x7f },\n\t{ WSA884X_CDC_SPK_DSM_R3, 0x9d },\n\t{ WSA884X_CDC_SPK_DSM_R4, 0x82 },\n\t{ WSA884X_CDC_SPK_DSM_R5, 0x8b },\n\t{ WSA884X_CDC_SPK_DSM_R6, 0x9b },\n\t{ WSA884X_CDC_SPK_DSM_R7, 0x3f },\n\t \n\t{ WSA884X_DRE_CTL_0, FIELD_PREP_CONST(WSA884X_DRE_CTL_0_PROG_DELAY_MASK, 0x7) },\n\t{ WSA884X_CLSH_CTL_0, (0x37 & ~WSA884X_CLSH_CTL_0_DLY_CODE_MASK) |\n\t\t\t      FIELD_PREP_CONST(WSA884X_CLSH_CTL_0_DLY_CODE_MASK, 0x6) },\n\t \n\t{ WSA884X_CLSH_VTH1, WSA884X_VTH_TO_REG(863), },\n\t{ WSA884X_CLSH_VTH2, WSA884X_VTH_TO_REG(918), },\n\t{ WSA884X_CLSH_VTH3, WSA884X_VTH_TO_REG(980), },\n\t{ WSA884X_CLSH_VTH4, WSA884X_VTH_TO_REG(1043), },\n\t{ WSA884X_CLSH_VTH5, WSA884X_VTH_TO_REG(1098), },\n\t{ WSA884X_CLSH_VTH6, WSA884X_VTH_TO_REG(1137), },\n\t{ WSA884X_CLSH_VTH7, WSA884X_VTH_TO_REG(1184), },\n\t{ WSA884X_CLSH_VTH8, WSA884X_VTH_TO_REG(1239), },\n\t{ WSA884X_CLSH_VTH9, WSA884X_VTH_TO_REG(1278), },\n\t{ WSA884X_CLSH_VTH10, WSA884X_VTH_TO_REG(1380), },\n\t{ WSA884X_CLSH_VTH11, WSA884X_VTH_TO_REG(1482), },\n\t{ WSA884X_CLSH_VTH12, WSA884X_VTH_TO_REG(1584), },\n\t{ WSA884X_CLSH_VTH13, WSA884X_VTH_TO_REG(1663), },\n\t{ WSA884X_CLSH_VTH14, WSA884X_VTH_TO_REG(1780), },\n\t{ WSA884X_CLSH_VTH15, WSA884X_VTH_TO_REG(2000), },\n\t{ WSA884X_ANA_WO_CTL_1, 0x00 },\n\t{ WSA884X_OTP_REG_38, 0x00 },\n\t{ WSA884X_OTP_REG_40, FIELD_PREP_CONST(WSA884X_OTP_REG_40_ISENSE_RESCAL_MASK, 0x8) },\n};\n\nstatic void wsa884x_set_gain_parameters(struct wsa884x_priv *wsa884x)\n{\n\tstruct regmap *regmap = wsa884x->regmap;\n\tunsigned int min_gain, igain, vgain, comp_offset;\n\n\t \n\tif (wsa884x->dev_mode == WSA884X_RECEIVER) {\n\t\tcomp_offset = COMP_OFFSET4;\n\t\tmin_gain = G_M6_DB;\n\t\tigain = ISENSE_18_DB;\n\t\tvgain = VSENSE_M12_DB;\n\t} else {\n\t\t \n\t\tcomp_offset = COMP_OFFSET0;\n\t\tmin_gain = G_0_DB;\n\t\tigain = ISENSE_12_DB;\n\t\tvgain = VSENSE_M24_DB;\n\t}\n\n\tregmap_update_bits(regmap, WSA884X_ISENSE2,\n\t\t\t   WSA884X_ISENSE2_ISENSE_GAIN_CTL_MASK,\n\t\t\t   FIELD_PREP(WSA884X_ISENSE2_ISENSE_GAIN_CTL_MASK, igain));\n\tregmap_update_bits(regmap, WSA884X_VSENSE1,\n\t\t\t   WSA884X_VSENSE1_GAIN_VSENSE_FE_MASK,\n\t\t\t   FIELD_PREP(WSA884X_VSENSE1_GAIN_VSENSE_FE_MASK, vgain));\n\tregmap_update_bits(regmap, WSA884X_GAIN_RAMPING_MIN,\n\t\t\t   WSA884X_GAIN_RAMPING_MIN_MIN_GAIN_MASK,\n\t\t\t   FIELD_PREP(WSA884X_GAIN_RAMPING_MIN_MIN_GAIN_MASK, min_gain));\n\n\tif (wsa884x->port_enable[WSA884X_PORT_COMP]) {\n\t\tregmap_update_bits(regmap, WSA884X_DRE_CTL_0,\n\t\t\t\t   WSA884X_DRE_CTL_0_OFFSET_MASK,\n\t\t\t\t   FIELD_PREP(WSA884X_DRE_CTL_0_OFFSET_MASK, comp_offset));\n\n\t\tregmap_update_bits(regmap, WSA884X_DRE_CTL_1,\n\t\t\t\t   WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK,\n\t\t\t\t   FIELD_PREP(WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK, 0x0));\n\t} else {\n\t\tregmap_update_bits(regmap, WSA884X_DRE_CTL_1,\n\t\t\t\t   WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK,\n\t\t\t\t   FIELD_PREP(WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK, 0x1));\n\t}\n}\n\nstatic void wsa884x_init(struct wsa884x_priv *wsa884x)\n{\n\tunsigned int wo_ctl_0;\n\tunsigned int variant = 0;\n\n\tif (!regmap_read(wsa884x->regmap, WSA884X_OTP_REG_0, &variant))\n\t\twsa884x->variant = variant & WSA884X_OTP_REG_0_ID_MASK;\n\n\tregmap_multi_reg_write(wsa884x->regmap, wsa884x_reg_init,\n\t\t\t       ARRAY_SIZE(wsa884x_reg_init));\n\n\two_ctl_0 = 0xc;\n\two_ctl_0 |= FIELD_PREP(WSA884X_ANA_WO_CTL_0_DAC_CM_CLAMP_EN_MASK,\n\t\t\t       WSA884X_ANA_WO_CTL_0_DAC_CM_CLAMP_EN_MODE_SPEAKER);\n\t \n\tif (wsa884x->variant == WSA884X_OTP_ID_WSA8845H)\n\t\two_ctl_0 |= FIELD_PREP(WSA884X_ANA_WO_CTL_0_PA_AUX_GAIN_MASK,\n\t\t\t\t       WSA884X_ANA_WO_CTL_0_PA_AUX_18_DB);\n\telse\n\t\two_ctl_0 |= FIELD_PREP(WSA884X_ANA_WO_CTL_0_PA_AUX_GAIN_MASK,\n\t\t\t\t       WSA884X_ANA_WO_CTL_0_PA_AUX_0_DB);\n\tregmap_write(wsa884x->regmap, WSA884X_ANA_WO_CTL_0, wo_ctl_0);\n\n\twsa884x_set_gain_parameters(wsa884x);\n\n\twsa884x->hw_init = false;\n}\n\nstatic int wsa884x_update_status(struct sdw_slave *slave,\n\t\t\t\t enum sdw_slave_status status)\n{\n\tstruct wsa884x_priv *wsa884x = dev_get_drvdata(&slave->dev);\n\tint ret;\n\n\tif (status == SDW_SLAVE_UNATTACHED) {\n\t\twsa884x->hw_init = false;\n\t\tregcache_cache_only(wsa884x->regmap, true);\n\t\tregcache_mark_dirty(wsa884x->regmap);\n\t\treturn 0;\n\t}\n\n\tif (wsa884x->hw_init || status != SDW_SLAVE_ATTACHED)\n\t\treturn 0;\n\n\tregcache_cache_only(wsa884x->regmap, false);\n\tret = regcache_sync(wsa884x->regmap);\n\tif (ret < 0) {\n\t\tdev_err(&slave->dev, \"Cannot sync regmap cache\\n\");\n\t\treturn ret;\n\t}\n\n\twsa884x_init(wsa884x);\n\n\treturn 0;\n}\n\nstatic int wsa884x_port_prep(struct sdw_slave *slave,\n\t\t\t     struct sdw_prepare_ch *prepare_ch,\n\t\t\t     enum sdw_port_prep_ops state)\n{\n\tstruct wsa884x_priv *wsa884x = dev_get_drvdata(&slave->dev);\n\n\tif (state == SDW_OPS_PORT_POST_PREP)\n\t\twsa884x->port_prepared[prepare_ch->num - 1] = true;\n\telse\n\t\twsa884x->port_prepared[prepare_ch->num - 1] = false;\n\n\treturn 0;\n}\n\nstatic const struct sdw_slave_ops wsa884x_slave_ops = {\n\t.update_status = wsa884x_update_status,\n\t.port_prep = wsa884x_port_prep,\n};\n\nstatic int wsa884x_dev_mode_get(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.enumerated.item[0] = wsa884x->dev_mode;\n\n\treturn 0;\n}\n\nstatic int wsa884x_dev_mode_put(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(component);\n\n\tif (wsa884x->dev_mode == ucontrol->value.enumerated.item[0])\n\t\treturn 0;\n\n\twsa884x->dev_mode = ucontrol->value.enumerated.item[0];\n\n\treturn 1;\n}\n\nstatic int wsa884x_get_swr_port(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *comp = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(comp);\n\tstruct soc_mixer_control *mixer = (struct soc_mixer_control *)kcontrol->private_value;\n\tint portidx = mixer->reg;\n\n\tucontrol->value.integer.value[0] = wsa884x->port_enable[portidx];\n\n\treturn 0;\n}\n\nstatic int wsa884x_set_swr_port(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *comp = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(comp);\n\tstruct soc_mixer_control *mixer = (struct soc_mixer_control *)kcontrol->private_value;\n\tint portidx = mixer->reg;\n\n\tif (ucontrol->value.integer.value[0]) {\n\t\tif (wsa884x->port_enable[portidx])\n\t\t\treturn 0;\n\n\t\twsa884x->port_enable[portidx] = true;\n\t} else {\n\t\tif (!wsa884x->port_enable[portidx])\n\t\t\treturn 0;\n\n\t\twsa884x->port_enable[portidx] = false;\n\t}\n\n\treturn 1;\n}\n\nstatic int wsa884x_codec_probe(struct snd_soc_component *comp)\n{\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(comp);\n\n\tsnd_soc_component_init_regmap(comp, wsa884x->regmap);\n\n\treturn 0;\n}\n\nstatic void wsa884x_spkr_post_pmu(struct snd_soc_component *component,\n\t\t\t\t  struct wsa884x_priv *wsa884x)\n{\n\tunsigned int curr_limit, curr_ovrd_en;\n\n\twsa884x_set_gain_parameters(wsa884x);\n\tif (wsa884x->dev_mode == WSA884X_RECEIVER) {\n\t\tsnd_soc_component_write_field(component, WSA884X_DRE_CTL_0,\n\t\t\t\t\t      WSA884X_DRE_CTL_0_PROG_DELAY_MASK, 0x3);\n\t\tsnd_soc_component_write_field(component, WSA884X_CDC_PATH_MODE,\n\t\t\t\t\t      WSA884X_CDC_PATH_MODE_RXD_MODE_MASK,\n\t\t\t\t\t      0x1);\n\t\tsnd_soc_component_write_field(component, WSA884X_PWM_CLK_CTL,\n\t\t\t\t\t      WSA884X_PWM_CLK_CTL_PWM_CLK_FREQ_SEL_MASK,\n\t\t\t\t\t      0x1);\n\t} else {\n\t\t \n\t\tsnd_soc_component_write_field(component, WSA884X_DRE_CTL_0,\n\t\t\t\t\t      WSA884X_DRE_CTL_0_PROG_DELAY_MASK, 0xf);\n\t}\n\n\tif (wsa884x->port_enable[WSA884X_PORT_PBR]) {\n\t\tcurr_ovrd_en = 0x0;\n\t\tcurr_limit = 0x15;\n\t} else {\n\t\tcurr_ovrd_en = 0x1;\n\t\tif (wsa884x->dev_mode == WSA884X_RECEIVER)\n\t\t\tcurr_limit = 0x9;\n\t\telse\n\t\t\tcurr_limit = 0x15;\n\t}\n\tsnd_soc_component_write_field(component, WSA884X_CURRENT_LIMIT,\n\t\t\t\t      WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_OVRD_EN_MASK,\n\t\t\t\t      curr_ovrd_en);\n\tsnd_soc_component_write_field(component, WSA884X_CURRENT_LIMIT,\n\t\t\t\t      WSA884X_CURRENT_LIMIT_CURRENT_LIMIT_MASK,\n\t\t\t\t      curr_limit);\n}\n\nstatic int wsa884x_spkr_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct wsa884x_priv *wsa884x = snd_soc_component_get_drvdata(component);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\twsa884x_spkr_post_pmu(component, wsa884x);\n\n\t\tsnd_soc_component_write_field(component, WSA884X_PDM_WD_CTL,\n\t\t\t\t\t      WSA884X_PDM_WD_CTL_PDM_WD_EN_MASK,\n\t\t\t\t\t      0x1);\n\t\tsnd_soc_component_write_field(component, WSA884X_PA_FSM_EN,\n\t\t\t\t\t      WSA884X_PA_FSM_EN_GLOBAL_PA_EN_MASK,\n\t\t\t\t\t      0x1);\n\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_write_field(component, WSA884X_PA_FSM_EN,\n\t\t\t\t\t      WSA884X_PA_FSM_EN_GLOBAL_PA_EN_MASK,\n\t\t\t\t\t      0x0);\n\t\tsnd_soc_component_write_field(component, WSA884X_PDM_WD_CTL,\n\t\t\t\t\t      WSA884X_PDM_WD_CTL_PDM_WD_EN_MASK,\n\t\t\t\t\t      0x0);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget wsa884x_dapm_widgets[] = {\n\tSND_SOC_DAPM_INPUT(\"IN\"),\n\tSND_SOC_DAPM_SPK(\"SPKR\", wsa884x_spkr_event),\n};\n\nstatic const DECLARE_TLV_DB_SCALE(pa_gain, -900, 150, -900);\n\nstatic const struct snd_kcontrol_new wsa884x_snd_controls[] = {\n\tSOC_SINGLE_RANGE_TLV(\"PA Volume\", WSA884X_DRE_CTL_1,\n\t\t\t     WSA884X_DRE_CTL_1_CSR_GAIN_SHIFT,\n\t\t\t     0x0, 0x1f, 1, pa_gain),\n\tSOC_ENUM_EXT(\"WSA MODE\", wsa884x_dev_mode_enum,\n\t\t     wsa884x_dev_mode_get, wsa884x_dev_mode_put),\n\tSOC_SINGLE_EXT(\"DAC Switch\", WSA884X_PORT_DAC, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n\tSOC_SINGLE_EXT(\"COMP Switch\", WSA884X_PORT_COMP, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n\tSOC_SINGLE_EXT(\"BOOST Switch\", WSA884X_PORT_BOOST, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n\tSOC_SINGLE_EXT(\"PBR Switch\", WSA884X_PORT_PBR, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n\tSOC_SINGLE_EXT(\"VISENSE Switch\", WSA884X_PORT_VISENSE, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n\tSOC_SINGLE_EXT(\"CPS Switch\", WSA884X_PORT_CPS, 0, 1, 0,\n\t\t       wsa884x_get_swr_port, wsa884x_set_swr_port),\n};\n\nstatic const struct snd_soc_dapm_route wsa884x_audio_map[] = {\n\t{\"SPKR\", NULL, \"IN\"},\n};\n\nstatic const struct snd_soc_component_driver wsa884x_component_drv = {\n\t.name = \"WSA884x\",\n\t.probe = wsa884x_codec_probe,\n\t.controls = wsa884x_snd_controls,\n\t.num_controls = ARRAY_SIZE(wsa884x_snd_controls),\n\t.dapm_widgets = wsa884x_dapm_widgets,\n\t.num_dapm_widgets = ARRAY_SIZE(wsa884x_dapm_widgets),\n\t.dapm_routes = wsa884x_audio_map,\n\t.num_dapm_routes = ARRAY_SIZE(wsa884x_audio_map),\n};\n\nstatic int wsa884x_hw_params(struct snd_pcm_substream *substream,\n\t\t\t     struct snd_pcm_hw_params *params,\n\t\t\t     struct snd_soc_dai *dai)\n{\n\tstruct wsa884x_priv *wsa884x = dev_get_drvdata(dai->dev);\n\tint i;\n\n\twsa884x->active_ports = 0;\n\tfor (i = 0; i < WSA884X_MAX_SWR_PORTS; i++) {\n\t\tif (!wsa884x->port_enable[i])\n\t\t\tcontinue;\n\n\t\twsa884x->port_config[wsa884x->active_ports] = wsa884x_pconfig[i];\n\t\twsa884x->active_ports++;\n\t}\n\n\twsa884x->sconfig.frame_rate = params_rate(params);\n\n\treturn sdw_stream_add_slave(wsa884x->slave, &wsa884x->sconfig,\n\t\t\t\t    wsa884x->port_config, wsa884x->active_ports,\n\t\t\t\t    wsa884x->sruntime);\n}\n\nstatic int wsa884x_hw_free(struct snd_pcm_substream *substream,\n\t\t\t   struct snd_soc_dai *dai)\n{\n\tstruct wsa884x_priv *wsa884x = dev_get_drvdata(dai->dev);\n\n\tsdw_stream_remove_slave(wsa884x->slave, wsa884x->sruntime);\n\n\treturn 0;\n}\n\nstatic int wsa884x_mute_stream(struct snd_soc_dai *dai, int mute, int stream)\n{\n\tstruct snd_soc_component *component = dai->component;\n\n\tif (mute) {\n\t\tsnd_soc_component_write_field(component, WSA884X_DRE_CTL_1,\n\t\t\t\t\t      WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK,\n\t\t\t\t\t      0x0);\n\t\tsnd_soc_component_write_field(component, WSA884X_PA_FSM_EN,\n\t\t\t\t\t      WSA884X_PA_FSM_EN_GLOBAL_PA_EN_MASK,\n\t\t\t\t\t      0x0);\n\n\t} else {\n\t\tsnd_soc_component_write_field(component, WSA884X_DRE_CTL_1,\n\t\t\t\t\t      WSA884X_DRE_CTL_1_CSR_GAIN_EN_MASK,\n\t\t\t\t\t      0x1);\n\t\tsnd_soc_component_write_field(component, WSA884X_PA_FSM_EN,\n\t\t\t\t\t      WSA884X_PA_FSM_EN_GLOBAL_PA_EN_MASK,\n\t\t\t\t\t      0x1);\n\t}\n\n\treturn 0;\n}\n\nstatic int wsa884x_set_stream(struct snd_soc_dai *dai,\n\t\t\t      void *stream, int direction)\n{\n\tstruct wsa884x_priv *wsa884x = dev_get_drvdata(dai->dev);\n\n\twsa884x->sruntime = stream;\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops wsa884x_dai_ops = {\n\t.hw_params = wsa884x_hw_params,\n\t.hw_free = wsa884x_hw_free,\n\t.mute_stream = wsa884x_mute_stream,\n\t.set_stream = wsa884x_set_stream,\n};\n\nstatic struct snd_soc_dai_driver wsa884x_dais[] = {\n\t{\n\t\t.name = \"SPKR\",\n\t\t.playback = {\n\t\t\t.stream_name = \"SPKR Playback\",\n\t\t\t.rates = WSA884X_RATES | WSA884X_FRAC_RATES,\n\t\t\t.formats = WSA884X_FORMATS,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 384000,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 1,\n\t\t},\n\t\t.ops = &wsa884x_dai_ops,\n\t},\n};\n\nstatic void wsa884x_gpio_powerdown(void *data)\n{\n\tgpiod_direction_output(data, 1);\n}\n\nstatic void wsa884x_regulator_disable(void *data)\n{\n\tregulator_bulk_disable(WSA884X_SUPPLIES_NUM, data);\n}\n\nstatic int wsa884x_probe(struct sdw_slave *pdev,\n\t\t\t const struct sdw_device_id *id)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct wsa884x_priv *wsa884x;\n\tunsigned int i;\n\tint ret;\n\n\twsa884x = devm_kzalloc(dev, sizeof(*wsa884x), GFP_KERNEL);\n\tif (!wsa884x)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < WSA884X_SUPPLIES_NUM; i++)\n\t\twsa884x->supplies[i].supply = wsa884x_supply_name[i];\n\n\tret = devm_regulator_bulk_get(dev, WSA884X_SUPPLIES_NUM,\n\t\t\t\t      wsa884x->supplies);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to get regulators\\n\");\n\n\tret = regulator_bulk_enable(WSA884X_SUPPLIES_NUM, wsa884x->supplies);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to enable regulators\\n\");\n\n\tret = devm_add_action_or_reset(dev, wsa884x_regulator_disable,\n\t\t\t\t       wsa884x->supplies);\n\tif (ret)\n\t\treturn ret;\n\n\twsa884x->sd_n = devm_gpiod_get_optional(dev, \"powerdown\",\n\t\t\t\t\t\tGPIOD_OUT_HIGH);\n\tif (IS_ERR(wsa884x->sd_n))\n\t\treturn dev_err_probe(dev, PTR_ERR(wsa884x->sd_n),\n\t\t\t\t     \"Shutdown Control GPIO not found\\n\");\n\n\tdev_set_drvdata(dev, wsa884x);\n\twsa884x->slave = pdev;\n\twsa884x->dev = dev;\n\twsa884x->dev_mode = WSA884X_SPEAKER;\n\twsa884x->sconfig.ch_count = 1;\n\twsa884x->sconfig.bps = 1;\n\twsa884x->sconfig.direction = SDW_DATA_DIR_RX;\n\twsa884x->sconfig.type = SDW_STREAM_PDM;\n\n\tpdev->prop.sink_ports = GENMASK(WSA884X_MAX_SWR_PORTS, 0);\n\tpdev->prop.simple_clk_stop_capable = true;\n\tpdev->prop.sink_dpn_prop = wsa884x_sink_dpn_prop;\n\tpdev->prop.scp_int1_mask = SDW_SCP_INT1_BUS_CLASH | SDW_SCP_INT1_PARITY;\n\n\t \n\tgpiod_direction_output(wsa884x->sd_n, 0);\n\tret = devm_add_action_or_reset(dev, wsa884x_gpio_powerdown, wsa884x->sd_n);\n\tif (ret)\n\t\treturn ret;\n\n\twsa884x->regmap = devm_regmap_init_sdw(pdev, &wsa884x_regmap_config);\n\tif (IS_ERR(wsa884x->regmap))\n\t\treturn dev_err_probe(dev, PTR_ERR(wsa884x->regmap),\n\t\t\t\t     \"regmap_init failed\\n\");\n\n\t \n\tregcache_cache_only(wsa884x->regmap, true);\n\twsa884x->hw_init = true;\n\n\tpm_runtime_set_autosuspend_delay(dev, 3000);\n\tpm_runtime_use_autosuspend(dev);\n\tpm_runtime_mark_last_busy(dev);\n\tpm_runtime_set_active(dev);\n\tpm_runtime_enable(dev);\n\n\treturn devm_snd_soc_register_component(dev,\n\t\t\t\t\t       &wsa884x_component_drv,\n\t\t\t\t\t       wsa884x_dais,\n\t\t\t\t\t       ARRAY_SIZE(wsa884x_dais));\n}\n\nstatic int __maybe_unused wsa884x_runtime_suspend(struct device *dev)\n{\n\tstruct regmap *regmap = dev_get_regmap(dev, NULL);\n\n\tregcache_cache_only(regmap, true);\n\tregcache_mark_dirty(regmap);\n\n\treturn 0;\n}\n\nstatic int __maybe_unused wsa884x_runtime_resume(struct device *dev)\n{\n\tstruct regmap *regmap = dev_get_regmap(dev, NULL);\n\n\tregcache_cache_only(regmap, false);\n\tregcache_sync(regmap);\n\n\treturn 0;\n}\n\nstatic const struct dev_pm_ops wsa884x_pm_ops = {\n\tSET_RUNTIME_PM_OPS(wsa884x_runtime_suspend, wsa884x_runtime_resume, NULL)\n};\n\nstatic const struct sdw_device_id wsa884x_swr_id[] = {\n\tSDW_SLAVE_ENTRY(0x0217, 0x204, 0),\n\t{},\n};\nMODULE_DEVICE_TABLE(sdw, wsa884x_swr_id);\n\nstatic struct sdw_driver wsa884x_codec_driver = {\n\t.driver = {\n\t\t.name = \"wsa884x-codec\",\n\t\t.pm = &wsa884x_pm_ops,\n\t},\n\t.probe = wsa884x_probe,\n\t.ops = &wsa884x_slave_ops,\n\t.id_table = wsa884x_swr_id,\n};\nmodule_sdw_driver(wsa884x_codec_driver);\n\nMODULE_AUTHOR(\"Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>\");\nMODULE_DESCRIPTION(\"WSA884x codec driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}