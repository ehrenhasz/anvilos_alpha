{
  "module_name": "ab8500-codec.c",
  "hash_id": "7d5d660b15c9124f9ac7473313a9668e83283073faa83b5a45ad63bb3f06a0dd",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/ab8500-codec.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/device.h>\n#include <linux/slab.h>\n#include <linux/moduleparam.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/platform_device.h>\n#include <linux/mutex.h>\n#include <linux/mfd/abx500/ab8500.h>\n#include <linux/mfd/abx500.h>\n#include <linux/mfd/abx500/ab8500-sysctrl.h>\n#include <linux/mfd/abx500/ab8500-codec.h>\n#include <linux/regulator/consumer.h>\n#include <linux/of.h>\n\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/initval.h>\n#include <sound/soc.h>\n#include <sound/soc-dapm.h>\n#include <sound/tlv.h>\n\n#include \"ab8500-codec.h\"\n\n \n#define CLK_32K_OUT2_DISABLE\t\t\t0x01\n#define INACTIVE_RESET_AUDIO\t\t\t0x02\n#define ENABLE_AUDIO_CLK_TO_AUDIO_BLK\t\t0x10\n#define ENABLE_VINTCORE12_SUPPLY\t\t0x04\n#define GPIO27_DIR_OUTPUT\t\t\t0x04\n#define GPIO29_DIR_OUTPUT\t\t\t0x10\n#define GPIO31_DIR_OUTPUT\t\t\t0x40\n\n \n#define AB8500_GPIO_DIR4_REG\t\t\t0x13  \n\n \n#define AB8500_NR_OF_ANC_COEFF_BANKS\t\t2\n\n \n#define AB8500_ANC_SM_DELAY\t\t\t2000\n\n#define AB8500_FILTER_CONTROL(xname, xcount, xmin, xmax) \\\n{\t.iface = SNDRV_CTL_ELEM_IFACE_MIXER, .name = (xname), \\\n\t.info = filter_control_info, \\\n\t.get = filter_control_get, .put = filter_control_put, \\\n\t.private_value = (unsigned long)&(struct filter_control) \\\n\t\t{.count = xcount, .min = xmin, .max = xmax} }\n\nstruct filter_control {\n\tlong min, max;\n\tunsigned int count;\n\tlong value[128];\n};\n\n \nstatic const char * const enum_sid_state[] = {\n\t\"Unconfigured\",\n\t\"Apply FIR\",\n\t\"FIR is configured\",\n};\nenum sid_state {\n\tSID_UNCONFIGURED = 0,\n\tSID_APPLY_FIR = 1,\n\tSID_FIR_CONFIGURED = 2,\n};\n\nstatic const char * const enum_anc_state[] = {\n\t\"Unconfigured\",\n\t\"Apply FIR and IIR\",\n\t\"FIR and IIR are configured\",\n\t\"Apply FIR\",\n\t\"FIR is configured\",\n\t\"Apply IIR\",\n\t\"IIR is configured\"\n};\nenum anc_state {\n\tANC_UNCONFIGURED = 0,\n\tANC_APPLY_FIR_IIR = 1,\n\tANC_FIR_IIR_CONFIGURED = 2,\n\tANC_APPLY_FIR = 3,\n\tANC_FIR_CONFIGURED = 4,\n\tANC_APPLY_IIR = 5,\n\tANC_IIR_CONFIGURED = 6\n};\n\n \nenum amic_idx {\n\tAMIC_IDX_1A,\n\tAMIC_IDX_1B,\n\tAMIC_IDX_2\n};\n\n \nstruct ab8500_codec_drvdata {\n\tstruct regmap *regmap;\n\tstruct mutex ctrl_lock;\n\n\t \n\tlong *sid_fir_values;\n\tenum sid_state sid_status;\n\n\t \n\tlong *anc_fir_values;\n\tlong *anc_iir_values;\n\tenum anc_state anc_status;\n};\n\nstatic inline const char *amic_micbias_str(enum amic_micbias micbias)\n{\n\tswitch (micbias) {\n\tcase AMIC_MICBIAS_VAMIC1:\n\t\treturn \"VAMIC1\";\n\tcase AMIC_MICBIAS_VAMIC2:\n\t\treturn \"VAMIC2\";\n\tdefault:\n\t\treturn \"Unknown\";\n\t}\n}\n\nstatic inline const char *amic_type_str(enum amic_type type)\n{\n\tswitch (type) {\n\tcase AMIC_TYPE_DIFFERENTIAL:\n\t\treturn \"DIFFERENTIAL\";\n\tcase AMIC_TYPE_SINGLE_ENDED:\n\t\treturn \"SINGLE ENDED\";\n\tdefault:\n\t\treturn \"Unknown\";\n\t}\n}\n\n \n\n \nstatic int ab8500_codec_read_reg(void *context, unsigned int reg,\n\t\t\t\t unsigned int *value)\n{\n\tstruct device *dev = context;\n\tint status;\n\n\tu8 value8;\n\tstatus = abx500_get_register_interruptible(dev, AB8500_AUDIO,\n\t\t\t\t\t\t   reg, &value8);\n\t*value = (unsigned int)value8;\n\n\treturn status;\n}\n\n \nstatic int ab8500_codec_write_reg(void *context, unsigned int reg,\n\t\t\t\t  unsigned int value)\n{\n\tstruct device *dev = context;\n\n\treturn abx500_set_register_interruptible(dev, AB8500_AUDIO,\n\t\t\t\t\t\t reg, value);\n}\n\nstatic const struct regmap_config ab8500_codec_regmap = {\n\t.reg_read = ab8500_codec_read_reg,\n\t.reg_write = ab8500_codec_write_reg,\n};\n\n \n\n \n\n \nstatic const char * const enum_ear_lineout_source[] = {\"Headset Left\",\n\t\t\t\t\t\t\"Speaker Left\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ear_lineout_source, AB8500_DMICFILTCONF,\n\t\t\tAB8500_DMICFILTCONF_DA3TOEAR, enum_ear_lineout_source);\nstatic const struct snd_kcontrol_new dapm_ear_lineout_source =\n\tSOC_DAPM_ENUM(\"Earpiece or LineOut Mono Source\",\n\t\tdapm_enum_ear_lineout_source);\n\n \n\n \nstatic const char * const enum_lineout_source[] = {\"Mono Path\", \"Stereo Path\"};\nstatic SOC_ENUM_DOUBLE_DECL(dapm_enum_lineout_source, AB8500_ANACONF5,\n\t\t\tAB8500_ANACONF5_HSLDACTOLOL,\n\t\t\tAB8500_ANACONF5_HSRDACTOLOR, enum_lineout_source);\nstatic const struct snd_kcontrol_new dapm_lineout_source[] = {\n\tSOC_DAPM_ENUM(\"LineOut Source\", dapm_enum_lineout_source),\n};\n\n \n\n \nstatic const char * const enum_HFx_sel[] = {\"Audio Path\", \"ANC\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_HFl_sel, AB8500_DIGMULTCONF2,\n\t\t\tAB8500_DIGMULTCONF2_HFLSEL, enum_HFx_sel);\nstatic const struct snd_kcontrol_new dapm_HFl_select[] = {\n\tSOC_DAPM_ENUM(\"Speaker Left Source\", dapm_enum_HFl_sel),\n};\n\n \nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_HFr_sel, AB8500_DIGMULTCONF2,\n\t\t\tAB8500_DIGMULTCONF2_HFRSEL, enum_HFx_sel);\nstatic const struct snd_kcontrol_new dapm_HFr_select[] = {\n\tSOC_DAPM_ENUM(\"Speaker Right Source\", dapm_enum_HFr_sel),\n};\n\n \n\n \nstatic const char * const enum_mic1ab_sel[] = {\"Mic 1b\", \"Mic 1a\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_mic1ab_sel, AB8500_ANACONF3,\n\t\t\tAB8500_ANACONF3_MIC1SEL, enum_mic1ab_sel);\nstatic const struct snd_kcontrol_new dapm_mic1ab_mux[] = {\n\tSOC_DAPM_ENUM(\"Mic 1a or 1b Select\", dapm_enum_mic1ab_sel),\n};\n\n \nstatic const char * const enum_ad3_sel[] = {\"Mic 1\", \"DMic 3\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ad3_sel, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_AD3SEL, enum_ad3_sel);\nstatic const struct snd_kcontrol_new dapm_ad3_select[] = {\n\tSOC_DAPM_ENUM(\"AD3 Source Select\", dapm_enum_ad3_sel),\n};\n\n \nstatic const char * const enum_ad6_sel[] = {\"Mic 1\", \"DMic 6\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ad6_sel, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_AD6SEL, enum_ad6_sel);\nstatic const struct snd_kcontrol_new dapm_ad6_select[] = {\n\tSOC_DAPM_ENUM(\"AD6 Source Select\", dapm_enum_ad6_sel),\n};\n\n \n\n \nstatic const char * const enum_ad5_sel[] = {\"Mic 2\", \"DMic 5\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ad5_sel, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_AD5SEL, enum_ad5_sel);\nstatic const struct snd_kcontrol_new dapm_ad5_select[] = {\n\tSOC_DAPM_ENUM(\"AD5 Source Select\", dapm_enum_ad5_sel),\n};\n\n \n\n \nstatic const char * const enum_ad1_sel[] = {\"LineIn Left\", \"DMic 1\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ad1_sel, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_AD1SEL, enum_ad1_sel);\nstatic const struct snd_kcontrol_new dapm_ad1_select[] = {\n\tSOC_DAPM_ENUM(\"AD1 Source Select\", dapm_enum_ad1_sel),\n};\n\n \nstatic const char * const enum_mic2lr_sel[] = {\"Mic 2\", \"LineIn Right\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_mic2lr_sel, AB8500_ANACONF3,\n\t\t\tAB8500_ANACONF3_LINRSEL, enum_mic2lr_sel);\nstatic const struct snd_kcontrol_new dapm_mic2lr_select[] = {\n\tSOC_DAPM_ENUM(\"Mic 2 or LINR Select\", dapm_enum_mic2lr_sel),\n};\n\n \nstatic const char * const enum_ad2_sel[] = {\"LineIn Right\", \"DMic 2\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_ad2_sel, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_AD2SEL, enum_ad2_sel);\nstatic const struct snd_kcontrol_new dapm_ad2_select[] = {\n\tSOC_DAPM_ENUM(\"AD2 Source Select\", dapm_enum_ad2_sel),\n};\n\n\n \n\nstatic const char * const enum_anc_in_sel[] = {\"Mic 1 / DMic 6\",\n\t\t\t\t\t\"Mic 2 / DMic 5\"};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_anc_in_sel, AB8500_DMICFILTCONF,\n\t\t\tAB8500_DMICFILTCONF_ANCINSEL, enum_anc_in_sel);\nstatic const struct snd_kcontrol_new dapm_anc_in_select[] = {\n\tSOC_DAPM_ENUM(\"ANC Source\", dapm_enum_anc_in_sel),\n};\n\n \nstatic const struct snd_kcontrol_new dapm_anc_enable[] = {\n\tSOC_DAPM_SINGLE(\"Switch\", AB8500_ANCCONF1,\n\t\t\tAB8500_ANCCONF1_ENANC, 0, 0),\n};\n\n \nstatic const struct snd_kcontrol_new dapm_anc_ear_mute[] = {\n\tSOC_DAPM_SINGLE(\"Switch\", AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_ANCSEL, 1, 0),\n};\n\n\n\n \n\n \nstatic const char * const enum_stfir1_in_sel[] = {\n\t\"LineIn Left\", \"LineIn Right\", \"Mic 1\", \"Headset Left\"\n};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_stfir1_in_sel, AB8500_DIGMULTCONF2,\n\t\t\tAB8500_DIGMULTCONF2_FIRSID1SEL, enum_stfir1_in_sel);\nstatic const struct snd_kcontrol_new dapm_stfir1_in_select[] = {\n\tSOC_DAPM_ENUM(\"Sidetone Left Source\", dapm_enum_stfir1_in_sel),\n};\n\n \n\n \nstatic const char * const enum_stfir2_in_sel[] = {\n\t\"LineIn Right\", \"Mic 1\", \"DMic 4\", \"Headset Right\"\n};\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_stfir2_in_sel, AB8500_DIGMULTCONF2,\n\t\t\tAB8500_DIGMULTCONF2_FIRSID2SEL, enum_stfir2_in_sel);\nstatic const struct snd_kcontrol_new dapm_stfir2_in_select[] = {\n\tSOC_DAPM_ENUM(\"Sidetone Right Source\", dapm_enum_stfir2_in_sel),\n};\n\n \n\nstatic const char * const enum_pwm2vibx[] = {\"Audio Path\", \"PWM Generator\"};\n\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_pwm2vib1, AB8500_PWMGENCONF1,\n\t\t\tAB8500_PWMGENCONF1_PWMTOVIB1, enum_pwm2vibx);\n\nstatic const struct snd_kcontrol_new dapm_pwm2vib1[] = {\n\tSOC_DAPM_ENUM(\"Vibra 1 Controller\", dapm_enum_pwm2vib1),\n};\n\nstatic SOC_ENUM_SINGLE_DECL(dapm_enum_pwm2vib2, AB8500_PWMGENCONF1,\n\t\t\tAB8500_PWMGENCONF1_PWMTOVIB2, enum_pwm2vibx);\n\nstatic const struct snd_kcontrol_new dapm_pwm2vib2[] = {\n\tSOC_DAPM_ENUM(\"Vibra 2 Controller\", dapm_enum_pwm2vib2),\n};\n\n \n\nstatic const struct snd_soc_dapm_widget ab8500_dapm_widgets[] = {\n\n\t \n\tSND_SOC_DAPM_CLOCK_SUPPLY(\"audioclk\"),\n\n\t \n\tSND_SOC_DAPM_REGULATOR_SUPPLY(\"V-AUD\", 0, 0),\n\tSND_SOC_DAPM_REGULATOR_SUPPLY(\"V-AMIC1\", 0, 0),\n\tSND_SOC_DAPM_REGULATOR_SUPPLY(\"V-AMIC2\", 0, 0),\n\tSND_SOC_DAPM_REGULATOR_SUPPLY(\"V-DMIC\", 0, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"Audio Power\",\n\t\t\tAB8500_POWERUP, AB8500_POWERUP_POWERUP, 0,\n\t\t\tNULL, SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"Audio Analog Power\",\n\t\t\tAB8500_POWERUP, AB8500_POWERUP_ENANA, 0,\n\t\t\tNULL, SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"Main Supply\", SND_SOC_NOPM, 0, 0,\n\t\t\tNULL, SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"ADC Input\"),\n\tSND_SOC_DAPM_ADC(\"ADC\", \"ab8500_0c\", SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_DAC(\"DAC\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_OUTPUT(\"DAC Output\"),\n\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN1\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN2\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN3\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN4\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN5\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"DA_IN6\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT1\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT2\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT3\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT4\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT57\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AD_OUT68\", NULL, 0, SND_SOC_NOPM, 0, 0),\n\n\t \n\n\tSND_SOC_DAPM_SUPPLY(\"Charge Pump\", AB8500_ANACONF5,\n\t\t\tAB8500_ANACONF5_ENCPHS, 0, NULL, 0),\n\n\tSND_SOC_DAPM_DAC(\"DA1 Enable\", \"ab8500_0p\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA1, 0),\n\tSND_SOC_DAPM_DAC(\"DA2 Enable\", \"ab8500_0p\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA2, 0),\n\n\tSND_SOC_DAPM_PGA(\"HSL Digital Volume\", SND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_PGA(\"HSR Digital Volume\", SND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_DAC(\"HSL DAC\", \"ab8500_0p\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACHSL, 0),\n\tSND_SOC_DAPM_DAC(\"HSR DAC\", \"ab8500_0p\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACHSR, 0),\n\tSND_SOC_DAPM_MIXER(\"HSL DAC Mute\", AB8500_MUTECONF,\n\t\t\tAB8500_MUTECONF_MUTDACHSL, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HSR DAC Mute\", AB8500_MUTECONF,\n\t\t\tAB8500_MUTECONF_MUTDACHSR, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_DAC(\"HSL DAC Driver\", \"ab8500_0p\",\n\t\t\tAB8500_ANACONF3, AB8500_ANACONF3_ENDRVHSL, 0),\n\tSND_SOC_DAPM_DAC(\"HSR DAC Driver\", \"ab8500_0p\",\n\t\t\tAB8500_ANACONF3, AB8500_ANACONF3_ENDRVHSR, 0),\n\n\tSND_SOC_DAPM_MIXER(\"HSL Mute\",\n\t\t\tAB8500_MUTECONF, AB8500_MUTECONF_MUTHSL, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HSR Mute\",\n\t\t\tAB8500_MUTECONF, AB8500_MUTECONF_MUTHSR, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HSL Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHSL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HSR Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHSR, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_PGA(\"HSL Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_PGA(\"HSR Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"Headset Left\"),\n\tSND_SOC_DAPM_OUTPUT(\"Headset Right\"),\n\n\t \n\n\tSND_SOC_DAPM_MUX(\"LineOut Source\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_lineout_source),\n\n\tSND_SOC_DAPM_MIXER(\"LOL Disable HFL\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHFL, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LOR Disable HFR\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHFR, 1,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_MIXER(\"LOL Enable\",\n\t\t\tAB8500_ANACONF5, AB8500_ANACONF5_ENLOL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LOR Enable\",\n\t\t\tAB8500_ANACONF5, AB8500_ANACONF5_ENLOR, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"LineOut Left\"),\n\tSND_SOC_DAPM_OUTPUT(\"LineOut Right\"),\n\n\t \n\n\tSND_SOC_DAPM_MUX(\"Earpiece or LineOut Mono Source\",\n\t\t\tSND_SOC_NOPM, 0, 0, &dapm_ear_lineout_source),\n\tSND_SOC_DAPM_MIXER(\"EAR DAC\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACEAR, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"EAR Mute\",\n\t\t\tAB8500_MUTECONF, AB8500_MUTECONF_MUTEAR, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"EAR Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENEAR, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"Earpiece\"),\n\n\t \n\n\tSND_SOC_DAPM_MIXER(\"DA3 Channel Volume\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA3, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DA4 Channel Volume\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA4, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MUX(\"Speaker Left Source\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_HFl_select),\n\tSND_SOC_DAPM_MUX(\"Speaker Right Source\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_HFr_select),\n\tSND_SOC_DAPM_MIXER(\"HFL DAC\", AB8500_DAPATHCONF,\n\t\t\tAB8500_DAPATHCONF_ENDACHFL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HFR DAC\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACHFR, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DA4 or ANC path to HfR\",\n\t\t\tAB8500_DIGMULTCONF2, AB8500_DIGMULTCONF2_DATOHFREN, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DA3 or ANC path to HfL\",\n\t\t\tAB8500_DIGMULTCONF2, AB8500_DIGMULTCONF2_DATOHFLEN, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HFL Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHFL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"HFR Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENHFR, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"Speaker Left\"),\n\tSND_SOC_DAPM_OUTPUT(\"Speaker Right\"),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"PWMGEN1\"),\n\tSND_SOC_DAPM_INPUT(\"PWMGEN2\"),\n\n\tSND_SOC_DAPM_MIXER(\"DA5 Channel Volume\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA5, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DA6 Channel Volume\",\n\t\t\tAB8500_DAPATHENA, AB8500_DAPATHENA_ENDA6, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"VIB1 DAC\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACVIB1, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"VIB2 DAC\",\n\t\t\tAB8500_DAPATHCONF, AB8500_DAPATHCONF_ENDACVIB2, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MUX(\"Vibra 1 Controller\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_pwm2vib1),\n\tSND_SOC_DAPM_MUX(\"Vibra 2 Controller\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_pwm2vib2),\n\tSND_SOC_DAPM_MIXER(\"VIB1 Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENVIB1, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"VIB2 Enable\",\n\t\t\tAB8500_ANACONF4, AB8500_ANACONF4_ENVIB2, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_OUTPUT(\"Vibra 1\"),\n\tSND_SOC_DAPM_OUTPUT(\"Vibra 2\"),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"Mic 1\"),\n\n\tSND_SOC_DAPM_MUX(\"Mic 1a or 1b Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_mic1ab_mux),\n\tSND_SOC_DAPM_MIXER(\"MIC1 Mute\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_MUTMIC1, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"MIC1A V-AMICx Enable\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_ENMIC1, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"MIC1B V-AMICx Enable\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_ENMIC1, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"MIC1 ADC\",\n\t\t\tAB8500_ANACONF3, AB8500_ANACONF3_ENADCMIC, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MUX(\"AD3 Source Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_ad3_select),\n\tSND_SOC_DAPM_MIXER(\"AD3 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD3 Enable\",\n\t\t\tAB8500_ADPATHENA, AB8500_ADPATHENA_ENAD34, 0,\n\t\t\tNULL, 0),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"Mic 2\"),\n\n\tSND_SOC_DAPM_MIXER(\"MIC2 Mute\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_MUTMIC2, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"MIC2 V-AMICx Enable\", AB8500_ANACONF2,\n\t\t\tAB8500_ANACONF2_ENMIC2, 0,\n\t\t\tNULL, 0),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"LineIn Left\"),\n\tSND_SOC_DAPM_INPUT(\"LineIn Right\"),\n\n\tSND_SOC_DAPM_MIXER(\"LINL Mute\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_MUTLINL, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LINR Mute\",\n\t\t\tAB8500_ANACONF2, AB8500_ANACONF2_MUTLINR, 1,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LINL Enable\", AB8500_ANACONF2,\n\t\t\tAB8500_ANACONF2_ENLINL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LINR Enable\", AB8500_ANACONF2,\n\t\t\tAB8500_ANACONF2_ENLINR, 0,\n\t\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"LINL to HSL Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LINR to HSR Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"Mic 2 or LINR Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_mic2lr_select),\n\tSND_SOC_DAPM_MIXER(\"LINL ADC\", AB8500_ANACONF3,\n\t\t\tAB8500_ANACONF3_ENADCLINL, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"LINR ADC\", AB8500_ANACONF3,\n\t\t\tAB8500_ANACONF3_ENADCLINR, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MUX(\"AD1 Source Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_ad1_select),\n\tSND_SOC_DAPM_MUX(\"AD2 Source Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_ad2_select),\n\tSND_SOC_DAPM_MIXER(\"AD1 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD2 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\n\tSND_SOC_DAPM_MIXER(\"AD12 Enable\",\n\t\t\tAB8500_ADPATHENA, AB8500_ADPATHENA_ENAD12, 0,\n\t\t\tNULL, 0),\n\n\t \n\n\tSND_SOC_DAPM_MUX(\"AD5 Source Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_ad5_select),\n\tSND_SOC_DAPM_MUX(\"AD6 Source Select\",\n\t\t\tSND_SOC_NOPM, 0, 0, dapm_ad6_select),\n\tSND_SOC_DAPM_MIXER(\"AD5 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD6 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD57 Enable\",\n\t\t\tAB8500_ADPATHENA, AB8500_ADPATHENA_ENAD5768, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD68 Enable\",\n\t\t\tAB8500_ADPATHENA, AB8500_ADPATHENA_ENAD5768, 0,\n\t\t\tNULL, 0),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"DMic 1\"),\n\tSND_SOC_DAPM_INPUT(\"DMic 2\"),\n\tSND_SOC_DAPM_INPUT(\"DMic 3\"),\n\tSND_SOC_DAPM_INPUT(\"DMic 4\"),\n\tSND_SOC_DAPM_INPUT(\"DMic 5\"),\n\tSND_SOC_DAPM_INPUT(\"DMic 6\"),\n\n\tSND_SOC_DAPM_MIXER(\"DMIC1\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC1, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DMIC2\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC2, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DMIC3\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC3, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DMIC4\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC4, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DMIC5\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC5, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"DMIC6\",\n\t\t\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_ENDMIC6, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD4 Channel Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"AD4 Enable\",\n\t\t\tAB8500_ADPATHENA, AB8500_ADPATHENA_ENAD34,\n\t\t\t0, NULL, 0),\n\n\t \n\n\tSND_SOC_DAPM_INPUT(\"ANC Configure Input\"),\n\tSND_SOC_DAPM_OUTPUT(\"ANC Configure Output\"),\n\n\tSND_SOC_DAPM_MUX(\"ANC Source\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tdapm_anc_in_select),\n\tSND_SOC_DAPM_SWITCH(\"ANC\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tdapm_anc_enable),\n\tSND_SOC_DAPM_SWITCH(\"ANC to Earpiece\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tdapm_anc_ear_mute),\n\n\t \n\n\tSND_SOC_DAPM_MUX(\"Sidetone Left Source\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tdapm_stfir1_in_select),\n\tSND_SOC_DAPM_MUX(\"Sidetone Right Source\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tdapm_stfir2_in_select),\n\tSND_SOC_DAPM_MIXER(\"STFIR1 Control\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"STFIR2 Control\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"STFIR1 Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n\tSND_SOC_DAPM_MIXER(\"STFIR2 Volume\",\n\t\t\tSND_SOC_NOPM, 0, 0,\n\t\t\tNULL, 0),\n};\n\n \nstatic const struct snd_soc_dapm_route ab8500_dapm_routes[] = {\n\t \n\t{\"Main Supply\", NULL, \"V-AUD\"},\n\t{\"Main Supply\", NULL, \"audioclk\"},\n\t{\"Main Supply\", NULL, \"Audio Power\"},\n\t{\"Main Supply\", NULL, \"Audio Analog Power\"},\n\n\t{\"DAC\", NULL, \"ab8500_0p\"},\n\t{\"DAC\", NULL, \"Main Supply\"},\n\t{\"ADC\", NULL, \"ab8500_0c\"},\n\t{\"ADC\", NULL, \"Main Supply\"},\n\n\t \n\t{\"ANC Configure Input\", NULL, \"Main Supply\"},\n\t{\"ANC Configure Output\", NULL, \"ANC Configure Input\"},\n\n\t \n\t{\"ADC\", NULL, \"ADC Input\"},\n\t{\"DAC Output\", NULL, \"DAC\"},\n\n\t \n\n\t{\"DA_IN1\", NULL, \"ab8500_0p\"},\n\t{\"DA_IN1\", NULL, \"Charge Pump\"},\n\t{\"DA_IN2\", NULL, \"ab8500_0p\"},\n\t{\"DA_IN2\", NULL, \"Charge Pump\"},\n\n\t \n\n\t{\"DA1 Enable\", NULL, \"DA_IN1\"},\n\t{\"DA2 Enable\", NULL, \"DA_IN2\"},\n\n\t{\"HSL Digital Volume\", NULL, \"DA1 Enable\"},\n\t{\"HSR Digital Volume\", NULL, \"DA2 Enable\"},\n\n\t{\"HSL DAC\", NULL, \"HSL Digital Volume\"},\n\t{\"HSR DAC\", NULL, \"HSR Digital Volume\"},\n\n\t{\"HSL DAC Mute\", NULL, \"HSL DAC\"},\n\t{\"HSR DAC Mute\", NULL, \"HSR DAC\"},\n\n\t{\"HSL DAC Driver\", NULL, \"HSL DAC Mute\"},\n\t{\"HSR DAC Driver\", NULL, \"HSR DAC Mute\"},\n\n\t{\"HSL Mute\", NULL, \"HSL DAC Driver\"},\n\t{\"HSR Mute\", NULL, \"HSR DAC Driver\"},\n\n\t{\"HSL Enable\", NULL, \"HSL Mute\"},\n\t{\"HSR Enable\", NULL, \"HSR Mute\"},\n\n\t{\"HSL Volume\", NULL, \"HSL Enable\"},\n\t{\"HSR Volume\", NULL, \"HSR Enable\"},\n\n\t{\"Headset Left\", NULL, \"HSL Volume\"},\n\t{\"Headset Right\", NULL, \"HSR Volume\"},\n\n\t \n\n\t{\"DA_IN3\", NULL, \"ab8500_0p\"},\n\t{\"DA3 Channel Volume\", NULL, \"DA_IN3\"},\n\t{\"DA_IN4\", NULL, \"ab8500_0p\"},\n\t{\"DA4 Channel Volume\", NULL, \"DA_IN4\"},\n\n\t{\"Speaker Left Source\", \"Audio Path\", \"DA3 Channel Volume\"},\n\t{\"Speaker Right Source\", \"Audio Path\", \"DA4 Channel Volume\"},\n\n\t{\"DA3 or ANC path to HfL\", NULL, \"Speaker Left Source\"},\n\t{\"DA4 or ANC path to HfR\", NULL, \"Speaker Right Source\"},\n\n\t \n\n\t{\"HFL DAC\", NULL, \"DA3 or ANC path to HfL\"},\n\t{\"HFR DAC\", NULL, \"DA4 or ANC path to HfR\"},\n\n\t{\"HFL Enable\", NULL, \"HFL DAC\"},\n\t{\"HFR Enable\", NULL, \"HFR DAC\"},\n\n\t{\"Speaker Left\", NULL, \"HFL Enable\"},\n\t{\"Speaker Right\", NULL, \"HFR Enable\"},\n\n\t \n\n\t{\"Earpiece or LineOut Mono Source\", \"Headset Left\",\n\t\t\"HSL Digital Volume\"},\n\t{\"Earpiece or LineOut Mono Source\", \"Speaker Left\",\n\t\t\"DA3 or ANC path to HfL\"},\n\n\t{\"EAR DAC\", NULL, \"Earpiece or LineOut Mono Source\"},\n\n\t{\"EAR Mute\", NULL, \"EAR DAC\"},\n\n\t{\"EAR Enable\", NULL, \"EAR Mute\"},\n\n\t{\"Earpiece\", NULL, \"EAR Enable\"},\n\n\t \n\n\t{\"LineOut Source\", \"Stereo Path\", \"HSL DAC Driver\"},\n\t{\"LineOut Source\", \"Stereo Path\", \"HSR DAC Driver\"},\n\n\t \n\n\t{\"LineOut Source\", \"Mono Path\", \"EAR DAC\"},\n\n\t \n\n\t{\"LOL Disable HFL\", NULL, \"LineOut Source\"},\n\t{\"LOR Disable HFR\", NULL, \"LineOut Source\"},\n\n\t{\"LOL Enable\", NULL, \"LOL Disable HFL\"},\n\t{\"LOR Enable\", NULL, \"LOR Disable HFR\"},\n\n\t{\"LineOut Left\", NULL, \"LOL Enable\"},\n\t{\"LineOut Right\", NULL, \"LOR Enable\"},\n\n\t \n\n\t{\"DA_IN5\", NULL, \"ab8500_0p\"},\n\t{\"DA5 Channel Volume\", NULL, \"DA_IN5\"},\n\t{\"DA_IN6\", NULL, \"ab8500_0p\"},\n\t{\"DA6 Channel Volume\", NULL, \"DA_IN6\"},\n\n\t{\"VIB1 DAC\", NULL, \"DA5 Channel Volume\"},\n\t{\"VIB2 DAC\", NULL, \"DA6 Channel Volume\"},\n\n\t{\"Vibra 1 Controller\", \"Audio Path\", \"VIB1 DAC\"},\n\t{\"Vibra 2 Controller\", \"Audio Path\", \"VIB2 DAC\"},\n\t{\"Vibra 1 Controller\", \"PWM Generator\", \"PWMGEN1\"},\n\t{\"Vibra 2 Controller\", \"PWM Generator\", \"PWMGEN2\"},\n\n\t{\"VIB1 Enable\", NULL, \"Vibra 1 Controller\"},\n\t{\"VIB2 Enable\", NULL, \"Vibra 2 Controller\"},\n\n\t{\"Vibra 1\", NULL, \"VIB1 Enable\"},\n\t{\"Vibra 2\", NULL, \"VIB2 Enable\"},\n\n\n\t \n\n\t{\"MIC2 V-AMICx Enable\", NULL, \"Mic 2\"},\n\n\t \n\t{\"LINL Mute\", NULL, \"LineIn Left\"},\n\t{\"LINR Mute\", NULL, \"LineIn Right\"},\n\n\t{\"LINL Enable\", NULL, \"LINL Mute\"},\n\t{\"LINR Enable\", NULL, \"LINR Mute\"},\n\n\t \n\t{\"Mic 2 or LINR Select\", \"LineIn Right\", \"LINR Enable\"},\n\t{\"Mic 2 or LINR Select\", \"Mic 2\", \"MIC2 V-AMICx Enable\"},\n\n\t{\"LINL ADC\", NULL, \"LINL Enable\"},\n\t{\"LINR ADC\", NULL, \"Mic 2 or LINR Select\"},\n\n\t{\"AD1 Source Select\", \"LineIn Left\", \"LINL ADC\"},\n\t{\"AD2 Source Select\", \"LineIn Right\", \"LINR ADC\"},\n\n\t{\"AD1 Channel Volume\", NULL, \"AD1 Source Select\"},\n\t{\"AD2 Channel Volume\", NULL, \"AD2 Source Select\"},\n\n\t{\"AD12 Enable\", NULL, \"AD1 Channel Volume\"},\n\t{\"AD12 Enable\", NULL, \"AD2 Channel Volume\"},\n\n\t{\"AD_OUT1\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT1\", NULL, \"AD12 Enable\"},\n\t{\"AD_OUT2\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT2\", NULL, \"AD12 Enable\"},\n\n\t \n\n\t{\"MIC1 Mute\", NULL, \"Mic 1\"},\n\n\t{\"MIC1A V-AMICx Enable\", NULL, \"MIC1 Mute\"},\n\t{\"MIC1B V-AMICx Enable\", NULL, \"MIC1 Mute\"},\n\n\t{\"Mic 1a or 1b Select\", \"Mic 1a\", \"MIC1A V-AMICx Enable\"},\n\t{\"Mic 1a or 1b Select\", \"Mic 1b\", \"MIC1B V-AMICx Enable\"},\n\n\t{\"MIC1 ADC\", NULL, \"Mic 1a or 1b Select\"},\n\n\t{\"AD3 Source Select\", \"Mic 1\", \"MIC1 ADC\"},\n\n\t{\"AD3 Channel Volume\", NULL, \"AD3 Source Select\"},\n\n\t{\"AD3 Enable\", NULL, \"AD3 Channel Volume\"},\n\n\t{\"AD_OUT3\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT3\", NULL, \"AD3 Enable\"},\n\n\t \n\n\t{\"AD5 Source Select\", \"Mic 2\", \"LINR ADC\"},\n\t{\"AD6 Source Select\", \"Mic 1\", \"MIC1 ADC\"},\n\n\t{\"AD5 Channel Volume\", NULL, \"AD5 Source Select\"},\n\t{\"AD6 Channel Volume\", NULL, \"AD6 Source Select\"},\n\n\t{\"AD57 Enable\", NULL, \"AD5 Channel Volume\"},\n\t{\"AD68 Enable\", NULL, \"AD6 Channel Volume\"},\n\n\t{\"AD_OUT57\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT57\", NULL, \"AD57 Enable\"},\n\t{\"AD_OUT68\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT68\", NULL, \"AD68 Enable\"},\n\n\t \n\n\t{\"DMic 1\", NULL, \"V-DMIC\"},\n\t{\"DMic 2\", NULL, \"V-DMIC\"},\n\t{\"DMic 3\", NULL, \"V-DMIC\"},\n\t{\"DMic 4\", NULL, \"V-DMIC\"},\n\t{\"DMic 5\", NULL, \"V-DMIC\"},\n\t{\"DMic 6\", NULL, \"V-DMIC\"},\n\n\t{\"AD1 Source Select\", NULL, \"DMic 1\"},\n\t{\"AD2 Source Select\", NULL, \"DMic 2\"},\n\t{\"AD3 Source Select\", NULL, \"DMic 3\"},\n\t{\"AD5 Source Select\", NULL, \"DMic 5\"},\n\t{\"AD6 Source Select\", NULL, \"DMic 6\"},\n\n\t{\"AD4 Channel Volume\", NULL, \"DMic 4\"},\n\t{\"AD4 Enable\", NULL, \"AD4 Channel Volume\"},\n\n\t{\"AD_OUT4\", NULL, \"ab8500_0c\"},\n\t{\"AD_OUT4\", NULL, \"AD4 Enable\"},\n\n\t \n\n\t{\"LINL to HSL Volume\", NULL, \"LINL Enable\"},\n\t{\"LINR to HSR Volume\", NULL, \"LINR Enable\"},\n\n\t{\"HSL DAC Driver\", NULL, \"LINL to HSL Volume\"},\n\t{\"HSR DAC Driver\", NULL, \"LINR to HSR Volume\"},\n\n\t \n\n\t{\"ANC Source\", \"Mic 2 / DMic 5\", \"AD5 Channel Volume\"},\n\t{\"ANC Source\", \"Mic 1 / DMic 6\", \"AD6 Channel Volume\"},\n\n\t{\"ANC\", \"Switch\", \"ANC Source\"},\n\n\t{\"Speaker Left Source\", \"ANC\", \"ANC\"},\n\t{\"Speaker Right Source\", \"ANC\", \"ANC\"},\n\t{\"ANC to Earpiece\", \"Switch\", \"ANC\"},\n\n\t{\"HSL Digital Volume\", NULL, \"ANC to Earpiece\"},\n\n\t \n\n\t{\"Sidetone Left Source\", \"LineIn Left\", \"AD12 Enable\"},\n\t{\"Sidetone Left Source\", \"LineIn Right\", \"AD12 Enable\"},\n\t{\"Sidetone Left Source\", \"Mic 1\", \"AD3 Enable\"},\n\t{\"Sidetone Left Source\", \"Headset Left\", \"DA_IN1\"},\n\t{\"Sidetone Right Source\", \"LineIn Right\", \"AD12 Enable\"},\n\t{\"Sidetone Right Source\", \"Mic 1\", \"AD3 Enable\"},\n\t{\"Sidetone Right Source\", \"DMic 4\", \"AD4 Enable\"},\n\t{\"Sidetone Right Source\", \"Headset Right\", \"DA_IN2\"},\n\n\t{\"STFIR1 Control\", NULL, \"Sidetone Left Source\"},\n\t{\"STFIR2 Control\", NULL, \"Sidetone Right Source\"},\n\n\t{\"STFIR1 Volume\", NULL, \"STFIR1 Control\"},\n\t{\"STFIR2 Volume\", NULL, \"STFIR2 Control\"},\n\n\t{\"DA1 Enable\", NULL, \"STFIR1 Volume\"},\n\t{\"DA2 Enable\", NULL, \"STFIR2 Volume\"},\n};\n\nstatic const struct snd_soc_dapm_route ab8500_dapm_routes_mic1a_vamicx[] = {\n\t{\"MIC1A V-AMICx Enable\", NULL, \"V-AMIC1\"},\n\t{\"MIC1A V-AMICx Enable\", NULL, \"V-AMIC2\"},\n};\n\nstatic const struct snd_soc_dapm_route ab8500_dapm_routes_mic1b_vamicx[] = {\n\t{\"MIC1B V-AMICx Enable\", NULL, \"V-AMIC1\"},\n\t{\"MIC1B V-AMICx Enable\", NULL, \"V-AMIC2\"},\n};\n\nstatic const struct snd_soc_dapm_route ab8500_dapm_routes_mic2_vamicx[] = {\n\t{\"MIC2 V-AMICx Enable\", NULL, \"V-AMIC1\"},\n\t{\"MIC2 V-AMICx Enable\", NULL, \"V-AMIC2\"},\n};\n\n \nstatic void anc_fir(struct snd_soc_component *component,\n\t\tunsigned int bnk, unsigned int par, unsigned int val)\n{\n\tif (par == 0 && bnk == 0)\n\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\tBIT(AB8500_ANCCONF1_ANCFIRUPDATE),\n\t\t\tBIT(AB8500_ANCCONF1_ANCFIRUPDATE));\n\n\tsnd_soc_component_write(component, AB8500_ANCCONF5, val >> 8 & 0xff);\n\tsnd_soc_component_write(component, AB8500_ANCCONF6, val &  0xff);\n\n\tif (par == AB8500_ANC_FIR_COEFFS - 1 && bnk == 1)\n\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\tBIT(AB8500_ANCCONF1_ANCFIRUPDATE), 0);\n}\n\n \nstatic void anc_iir(struct snd_soc_component *component, unsigned int bnk,\n\t\tunsigned int par, unsigned int val)\n{\n\tif (par == 0) {\n\t\tif (bnk == 0) {\n\t\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\t\t\tBIT(AB8500_ANCCONF1_ANCIIRINIT),\n\t\t\t\t\tBIT(AB8500_ANCCONF1_ANCIIRINIT));\n\t\t\tusleep_range(AB8500_ANC_SM_DELAY, AB8500_ANC_SM_DELAY*2);\n\t\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\t\t\tBIT(AB8500_ANCCONF1_ANCIIRINIT), 0);\n\t\t\tusleep_range(AB8500_ANC_SM_DELAY, AB8500_ANC_SM_DELAY*2);\n\t\t} else {\n\t\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\t\t\tBIT(AB8500_ANCCONF1_ANCIIRUPDATE),\n\t\t\t\t\tBIT(AB8500_ANCCONF1_ANCIIRUPDATE));\n\t\t}\n\t} else if (par > 3) {\n\t\tsnd_soc_component_write(component, AB8500_ANCCONF7, 0);\n\t\tsnd_soc_component_write(component, AB8500_ANCCONF8, val >> 16 & 0xff);\n\t}\n\n\tsnd_soc_component_write(component, AB8500_ANCCONF7, val >> 8 & 0xff);\n\tsnd_soc_component_write(component, AB8500_ANCCONF8, val & 0xff);\n\n\tif (par == AB8500_ANC_IIR_COEFFS - 1 && bnk == 1)\n\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\tBIT(AB8500_ANCCONF1_ANCIIRUPDATE), 0);\n}\n\n \nstatic void anc_configure(struct snd_soc_component *component,\n\t\t\tbool apply_fir, bool apply_iir)\n{\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(component->dev);\n\tunsigned int bnk, par, val;\n\n\tdev_dbg(component->dev, \"%s: Enter.\\n\", __func__);\n\n\tif (apply_fir)\n\t\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\t\tBIT(AB8500_ANCCONF1_ENANC), 0);\n\n\tsnd_soc_component_update_bits(component, AB8500_ANCCONF1,\n\t\tBIT(AB8500_ANCCONF1_ENANC), BIT(AB8500_ANCCONF1_ENANC));\n\n\tif (apply_fir)\n\t\tfor (bnk = 0; bnk < AB8500_NR_OF_ANC_COEFF_BANKS; bnk++)\n\t\t\tfor (par = 0; par < AB8500_ANC_FIR_COEFFS; par++) {\n\t\t\t\tval = snd_soc_component_read(component,\n\t\t\t\t\t\tdrvdata->anc_fir_values[par]);\n\t\t\t\tanc_fir(component, bnk, par, val);\n\t\t\t}\n\n\tif (apply_iir)\n\t\tfor (bnk = 0; bnk < AB8500_NR_OF_ANC_COEFF_BANKS; bnk++)\n\t\t\tfor (par = 0; par < AB8500_ANC_IIR_COEFFS; par++) {\n\t\t\t\tval = snd_soc_component_read(component,\n\t\t\t\t\t\tdrvdata->anc_iir_values[par]);\n\t\t\t\tanc_iir(component, bnk, par, val);\n\t\t\t}\n\n\tdev_dbg(component->dev, \"%s: Exit.\\n\", __func__);\n}\n\n \n\nstatic int sid_status_control_get(struct snd_kcontrol *kcontrol,\n\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(component->dev);\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\tucontrol->value.enumerated.item[0] = drvdata->sid_status;\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\treturn 0;\n}\n\n \nstatic int sid_status_control_put(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(component->dev);\n\tunsigned int param, sidconf, val;\n\tint status = 1;\n\n\tdev_dbg(component->dev, \"%s: Enter\\n\", __func__);\n\n\tif (ucontrol->value.enumerated.item[0] != SID_APPLY_FIR) {\n\t\tdev_err(component->dev,\n\t\t\t\"%s: ERROR: This control supports '%s' only!\\n\",\n\t\t\t__func__, enum_sid_state[SID_APPLY_FIR]);\n\t\treturn -EIO;\n\t}\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\n\tsidconf = snd_soc_component_read(component, AB8500_SIDFIRCONF);\n\tif (((sidconf & BIT(AB8500_SIDFIRCONF_FIRSIDBUSY)) != 0)) {\n\t\tif ((sidconf & BIT(AB8500_SIDFIRCONF_ENFIRSIDS)) == 0) {\n\t\t\tdev_err(component->dev, \"%s: Sidetone busy while off!\\n\",\n\t\t\t\t__func__);\n\t\t\tstatus = -EPERM;\n\t\t} else {\n\t\t\tstatus = -EBUSY;\n\t\t}\n\t\tgoto out;\n\t}\n\n\tsnd_soc_component_write(component, AB8500_SIDFIRADR, 0);\n\n\tfor (param = 0; param < AB8500_SID_FIR_COEFFS; param++) {\n\t\tval = snd_soc_component_read(component, drvdata->sid_fir_values[param]);\n\t\tsnd_soc_component_write(component, AB8500_SIDFIRCOEF1, val >> 8 & 0xff);\n\t\tsnd_soc_component_write(component, AB8500_SIDFIRCOEF2, val & 0xff);\n\t}\n\n\tsnd_soc_component_update_bits(component, AB8500_SIDFIRADR,\n\t\tBIT(AB8500_SIDFIRADR_FIRSIDSET),\n\t\tBIT(AB8500_SIDFIRADR_FIRSIDSET));\n\tsnd_soc_component_update_bits(component, AB8500_SIDFIRADR,\n\t\tBIT(AB8500_SIDFIRADR_FIRSIDSET), 0);\n\n\tdrvdata->sid_status = SID_FIR_CONFIGURED;\n\nout:\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\tdev_dbg(component->dev, \"%s: Exit\\n\", __func__);\n\n\treturn status;\n}\n\nstatic int anc_status_control_get(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(component->dev);\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\tucontrol->value.enumerated.item[0] = drvdata->anc_status;\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\treturn 0;\n}\n\nstatic int anc_status_control_put(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(component->dev);\n\tstruct device *dev = component->dev;\n\tbool apply_fir, apply_iir;\n\tunsigned int req;\n\tint status;\n\n\tdev_dbg(dev, \"%s: Enter.\\n\", __func__);\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\n\treq = ucontrol->value.enumerated.item[0];\n\tif (req >= ARRAY_SIZE(enum_anc_state)) {\n\t\tstatus = -EINVAL;\n\t\tgoto cleanup;\n\t}\n\tif (req != ANC_APPLY_FIR_IIR && req != ANC_APPLY_FIR &&\n\t\treq != ANC_APPLY_IIR) {\n\t\tdev_err(dev, \"%s: ERROR: Unsupported status to set '%s'!\\n\",\n\t\t\t__func__, enum_anc_state[req]);\n\t\tstatus = -EINVAL;\n\t\tgoto cleanup;\n\t}\n\tapply_fir = req == ANC_APPLY_FIR || req == ANC_APPLY_FIR_IIR;\n\tapply_iir = req == ANC_APPLY_IIR || req == ANC_APPLY_FIR_IIR;\n\n\tstatus = snd_soc_dapm_force_enable_pin(dapm, \"ANC Configure Input\");\n\tif (status < 0) {\n\t\tdev_err(dev,\n\t\t\t\"%s: ERROR: Failed to enable power (status = %d)!\\n\",\n\t\t\t__func__, status);\n\t\tgoto cleanup;\n\t}\n\tsnd_soc_dapm_sync(dapm);\n\n\tanc_configure(component, apply_fir, apply_iir);\n\n\tif (apply_fir) {\n\t\tif (drvdata->anc_status == ANC_IIR_CONFIGURED)\n\t\t\tdrvdata->anc_status = ANC_FIR_IIR_CONFIGURED;\n\t\telse if (drvdata->anc_status != ANC_FIR_IIR_CONFIGURED)\n\t\t\tdrvdata->anc_status =  ANC_FIR_CONFIGURED;\n\t}\n\tif (apply_iir) {\n\t\tif (drvdata->anc_status == ANC_FIR_CONFIGURED)\n\t\t\tdrvdata->anc_status = ANC_FIR_IIR_CONFIGURED;\n\t\telse if (drvdata->anc_status != ANC_FIR_IIR_CONFIGURED)\n\t\t\tdrvdata->anc_status =  ANC_IIR_CONFIGURED;\n\t}\n\n\tstatus = snd_soc_dapm_disable_pin(dapm, \"ANC Configure Input\");\n\tsnd_soc_dapm_sync(dapm);\n\ncleanup:\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\tif (status < 0)\n\t\tdev_err(dev, \"%s: Unable to configure ANC! (status = %d)\\n\",\n\t\t\t__func__, status);\n\n\tdev_dbg(dev, \"%s: Exit.\\n\", __func__);\n\n\treturn (status < 0) ? status : 1;\n}\n\nstatic int filter_control_info(struct snd_kcontrol *kcontrol,\n\t\t\tstruct snd_ctl_elem_info *uinfo)\n{\n\tstruct filter_control *fc =\n\t\t\t(struct filter_control *)kcontrol->private_value;\n\n\tuinfo->type = SNDRV_CTL_ELEM_TYPE_INTEGER;\n\tuinfo->count = fc->count;\n\tuinfo->value.integer.min = fc->min;\n\tuinfo->value.integer.max = fc->max;\n\n\treturn 0;\n}\n\nstatic int filter_control_get(struct snd_kcontrol *kcontrol,\n\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct ab8500_codec_drvdata *drvdata = snd_soc_component_get_drvdata(component);\n\tstruct filter_control *fc =\n\t\t\t(struct filter_control *)kcontrol->private_value;\n\tunsigned int i;\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\tfor (i = 0; i < fc->count; i++)\n\t\tucontrol->value.integer.value[i] = fc->value[i];\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\treturn 0;\n}\n\nstatic int filter_control_put(struct snd_kcontrol *kcontrol,\n\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct ab8500_codec_drvdata *drvdata = snd_soc_component_get_drvdata(component);\n\tstruct filter_control *fc =\n\t\t\t(struct filter_control *)kcontrol->private_value;\n\tunsigned int i;\n\n\tmutex_lock(&drvdata->ctrl_lock);\n\tfor (i = 0; i < fc->count; i++)\n\t\tfc->value[i] = ucontrol->value.integer.value[i];\n\tmutex_unlock(&drvdata->ctrl_lock);\n\n\treturn 0;\n}\n\n \n\nstatic DECLARE_TLV_DB_SCALE(adx_dig_gain_tlv, -3200, 100, 1);\n \n\nstatic DECLARE_TLV_DB_SCALE(dax_dig_gain_tlv, -6300, 100, 1);\n \n\nstatic DECLARE_TLV_DB_SCALE(hs_ear_dig_gain_tlv, -100, 100, 1);\n \n\nstatic const DECLARE_TLV_DB_RANGE(hs_gain_tlv,\n\t0, 3, TLV_DB_SCALE_ITEM(-3200, 400, 0),\n\t4, 15, TLV_DB_SCALE_ITEM(-1800, 200, 0)\n);\n\nstatic DECLARE_TLV_DB_SCALE(mic_gain_tlv, 0, 100, 0);\n\nstatic DECLARE_TLV_DB_SCALE(lin_gain_tlv, -1000, 200, 0);\n\nstatic DECLARE_TLV_DB_SCALE(lin2hs_gain_tlv, -3800, 200, 1);\n \n\nstatic const char * const enum_hsfadspeed[] = {\"2ms\", \"0.5ms\", \"10.6ms\",\n\t\t\t\t\t\"5ms\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_hsfadspeed,\n\tAB8500_DIGMICCONF, AB8500_DIGMICCONF_HSFADSPEED, enum_hsfadspeed);\n\nstatic const char * const enum_envdetthre[] = {\n\t\"250mV\", \"300mV\", \"350mV\", \"400mV\",\n\t\"450mV\", \"500mV\", \"550mV\", \"600mV\",\n\t\"650mV\", \"700mV\", \"750mV\", \"800mV\",\n\t\"850mV\", \"900mV\", \"950mV\", \"1.00V\" };\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_envdeththre,\n\tAB8500_ENVCPCONF, AB8500_ENVCPCONF_ENVDETHTHRE, enum_envdetthre);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_envdetlthre,\n\tAB8500_ENVCPCONF, AB8500_ENVCPCONF_ENVDETLTHRE, enum_envdetthre);\nstatic const char * const enum_envdettime[] = {\n\t\"26.6us\", \"53.2us\", \"106us\",  \"213us\",\n\t\"426us\",  \"851us\",  \"1.70ms\", \"3.40ms\",\n\t\"6.81ms\", \"13.6ms\", \"27.2ms\", \"54.5ms\",\n\t\"109ms\",  \"218ms\",  \"436ms\",  \"872ms\" };\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_envdettime,\n\tAB8500_SIGENVCONF, AB8500_SIGENVCONF_ENVDETTIME, enum_envdettime);\n\nstatic const char * const enum_sinc31[] = {\"Sinc 3\", \"Sinc 1\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_hsesinc, AB8500_HSLEARDIGGAIN,\n\t\t\tAB8500_HSLEARDIGGAIN_HSSINC1, enum_sinc31);\n\nstatic const char * const enum_fadespeed[] = {\"1ms\", \"4ms\", \"8ms\", \"16ms\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_fadespeed, AB8500_HSRDIGGAIN,\n\t\t\tAB8500_HSRDIGGAIN_FADESPEED, enum_fadespeed);\n\n \n\nstatic const char * const enum_lowpow[] = {\"Normal\", \"Low Power\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_eardaclowpow, AB8500_ANACONF1,\n\t\t\tAB8500_ANACONF1_EARDACLOWPOW, enum_lowpow);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_eardrvlowpow, AB8500_ANACONF1,\n\t\t\tAB8500_ANACONF1_EARDRVLOWPOW, enum_lowpow);\n\nstatic const char * const enum_av_mode[] = {\"Audio\", \"Voice\"};\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_ad12voice, AB8500_ADFILTCONF,\n\tAB8500_ADFILTCONF_AD1VOICE, AB8500_ADFILTCONF_AD2VOICE, enum_av_mode);\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_ad34voice, AB8500_ADFILTCONF,\n\tAB8500_ADFILTCONF_AD3VOICE, AB8500_ADFILTCONF_AD4VOICE, enum_av_mode);\n\n \n\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da12voice,\n\t\t\tAB8500_DASLOTCONF1, AB8500_DASLOTCONF1_DA12VOICE,\n\t\t\tenum_av_mode);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da34voice,\n\t\t\tAB8500_DASLOTCONF3, AB8500_DASLOTCONF3_DA34VOICE,\n\t\t\tenum_av_mode);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da56voice,\n\t\t\tAB8500_DASLOTCONF5, AB8500_DASLOTCONF5_DA56VOICE,\n\t\t\tenum_av_mode);\n\nstatic const char * const enum_da2hslr[] = {\"Sidetone\", \"Audio Path\"};\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_da2hslr, AB8500_DIGMULTCONF1,\n\t\t\tAB8500_DIGMULTCONF1_DATOHSLEN,\n\t\t\tAB8500_DIGMULTCONF1_DATOHSREN, enum_da2hslr);\n\nstatic const char * const enum_sinc53[] = {\"Sinc 5\", \"Sinc 3\"};\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_dmic12sinc, AB8500_DMICFILTCONF,\n\t\t\tAB8500_DMICFILTCONF_DMIC1SINC3,\n\t\t\tAB8500_DMICFILTCONF_DMIC2SINC3, enum_sinc53);\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_dmic34sinc, AB8500_DMICFILTCONF,\n\t\t\tAB8500_DMICFILTCONF_DMIC3SINC3,\n\t\t\tAB8500_DMICFILTCONF_DMIC4SINC3, enum_sinc53);\nstatic SOC_ENUM_DOUBLE_DECL(soc_enum_dmic56sinc, AB8500_DMICFILTCONF,\n\t\t\tAB8500_DMICFILTCONF_DMIC5SINC3,\n\t\t\tAB8500_DMICFILTCONF_DMIC6SINC3, enum_sinc53);\n\n \nstatic const char * const enum_da_from_slot_map[] = {\"SLOT0\",\n\t\t\t\t\t\"SLOT1\",\n\t\t\t\t\t\"SLOT2\",\n\t\t\t\t\t\"SLOT3\",\n\t\t\t\t\t\"SLOT4\",\n\t\t\t\t\t\"SLOT5\",\n\t\t\t\t\t\"SLOT6\",\n\t\t\t\t\t\"SLOT7\",\n\t\t\t\t\t\"SLOT8\",\n\t\t\t\t\t\"SLOT9\",\n\t\t\t\t\t\"SLOT10\",\n\t\t\t\t\t\"SLOT11\",\n\t\t\t\t\t\"SLOT12\",\n\t\t\t\t\t\"SLOT13\",\n\t\t\t\t\t\"SLOT14\",\n\t\t\t\t\t\"SLOT15\",\n\t\t\t\t\t\"SLOT16\",\n\t\t\t\t\t\"SLOT17\",\n\t\t\t\t\t\"SLOT18\",\n\t\t\t\t\t\"SLOT19\",\n\t\t\t\t\t\"SLOT20\",\n\t\t\t\t\t\"SLOT21\",\n\t\t\t\t\t\"SLOT22\",\n\t\t\t\t\t\"SLOT23\",\n\t\t\t\t\t\"SLOT24\",\n\t\t\t\t\t\"SLOT25\",\n\t\t\t\t\t\"SLOT26\",\n\t\t\t\t\t\"SLOT27\",\n\t\t\t\t\t\"SLOT28\",\n\t\t\t\t\t\"SLOT29\",\n\t\t\t\t\t\"SLOT30\",\n\t\t\t\t\t\"SLOT31\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da1slotmap,\n\t\t\tAB8500_DASLOTCONF1, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da2slotmap,\n\t\t\tAB8500_DASLOTCONF2, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da3slotmap,\n\t\t\tAB8500_DASLOTCONF3, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da4slotmap,\n\t\t\tAB8500_DASLOTCONF4, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da5slotmap,\n\t\t\tAB8500_DASLOTCONF5, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da6slotmap,\n\t\t\tAB8500_DASLOTCONF6, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da7slotmap,\n\t\t\tAB8500_DASLOTCONF7, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_da8slotmap,\n\t\t\tAB8500_DASLOTCONF8, AB8500_DASLOTCONFX_SLTODAX_SHIFT,\n\t\t\tenum_da_from_slot_map);\n\n \nstatic const char * const enum_ad_to_slot_map[] = {\"AD_OUT1\",\n\t\t\t\t\t\"AD_OUT2\",\n\t\t\t\t\t\"AD_OUT3\",\n\t\t\t\t\t\"AD_OUT4\",\n\t\t\t\t\t\"AD_OUT5\",\n\t\t\t\t\t\"AD_OUT6\",\n\t\t\t\t\t\"AD_OUT7\",\n\t\t\t\t\t\"AD_OUT8\",\n\t\t\t\t\t\"zeroes\",\n\t\t\t\t\t\"zeroes\",\n\t\t\t\t\t\"zeroes\",\n\t\t\t\t\t\"zeroes\",\n\t\t\t\t\t\"tristate\",\n\t\t\t\t\t\"tristate\",\n\t\t\t\t\t\"tristate\",\n\t\t\t\t\t\"tristate\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot0map,\n\t\t\tAB8500_ADSLOTSEL1, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot1map,\n\t\t\tAB8500_ADSLOTSEL1, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot2map,\n\t\t\tAB8500_ADSLOTSEL2, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot3map,\n\t\t\tAB8500_ADSLOTSEL2, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot4map,\n\t\t\tAB8500_ADSLOTSEL3, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot5map,\n\t\t\tAB8500_ADSLOTSEL3, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot6map,\n\t\t\tAB8500_ADSLOTSEL4, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot7map,\n\t\t\tAB8500_ADSLOTSEL4, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot8map,\n\t\t\tAB8500_ADSLOTSEL5, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot9map,\n\t\t\tAB8500_ADSLOTSEL5, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot10map,\n\t\t\tAB8500_ADSLOTSEL6, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot11map,\n\t\t\tAB8500_ADSLOTSEL6, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot12map,\n\t\t\tAB8500_ADSLOTSEL7, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot13map,\n\t\t\tAB8500_ADSLOTSEL7, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot14map,\n\t\t\tAB8500_ADSLOTSEL8, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot15map,\n\t\t\tAB8500_ADSLOTSEL8, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot16map,\n\t\t\tAB8500_ADSLOTSEL9, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot17map,\n\t\t\tAB8500_ADSLOTSEL9, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot18map,\n\t\t\tAB8500_ADSLOTSEL10, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot19map,\n\t\t\tAB8500_ADSLOTSEL10, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot20map,\n\t\t\tAB8500_ADSLOTSEL11, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot21map,\n\t\t\tAB8500_ADSLOTSEL11, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot22map,\n\t\t\tAB8500_ADSLOTSEL12, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot23map,\n\t\t\tAB8500_ADSLOTSEL12, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot24map,\n\t\t\tAB8500_ADSLOTSEL13, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot25map,\n\t\t\tAB8500_ADSLOTSEL13, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot26map,\n\t\t\tAB8500_ADSLOTSEL14, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot27map,\n\t\t\tAB8500_ADSLOTSEL14, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot28map,\n\t\t\tAB8500_ADSLOTSEL15, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot29map,\n\t\t\tAB8500_ADSLOTSEL15, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot30map,\n\t\t\tAB8500_ADSLOTSEL16, AB8500_ADSLOTSELX_EVEN_SHIFT,\n\t\t\tenum_ad_to_slot_map);\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_adslot31map,\n\t\t\tAB8500_ADSLOTSEL16, AB8500_ADSLOTSELX_ODD_SHIFT,\n\t\t\tenum_ad_to_slot_map);\n\n \nstatic const char * const enum_mask[] = {\"Unmasked\", \"Masked\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_bfifomask,\n\t\t\tAB8500_FIFOCONF1, AB8500_FIFOCONF1_BFIFOMASK,\n\t\t\tenum_mask);\nstatic const char * const enum_bitclk0[] = {\"19_2_MHz\", \"38_4_MHz\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_bfifo19m2,\n\t\t\tAB8500_FIFOCONF1, AB8500_FIFOCONF1_BFIFO19M2,\n\t\t\tenum_bitclk0);\nstatic const char * const enum_slavemaster[] = {\"Slave\", \"Master\"};\nstatic SOC_ENUM_SINGLE_DECL(soc_enum_bfifomast,\n\t\t\tAB8500_FIFOCONF3, AB8500_FIFOCONF3_BFIFOMAST_SHIFT,\n\t\t\tenum_slavemaster);\n\n \nstatic SOC_ENUM_SINGLE_EXT_DECL(soc_enum_sidstate, enum_sid_state);\n\n \nstatic SOC_ENUM_SINGLE_EXT_DECL(soc_enum_ancstate, enum_anc_state);\n\nstatic struct snd_kcontrol_new ab8500_ctrls[] = {\n\t \n\tSOC_ENUM(\"Charge Pump High Threshold For Low Voltage\",\n\t\tsoc_enum_envdeththre),\n\tSOC_ENUM(\"Charge Pump Low Threshold For Low Voltage\",\n\t\tsoc_enum_envdetlthre),\n\tSOC_SINGLE(\"Charge Pump Envelope Detection Switch\",\n\t\tAB8500_SIGENVCONF, AB8500_SIGENVCONF_ENVDETCPEN,\n\t\t1, 0),\n\tSOC_ENUM(\"Charge Pump Envelope Detection Decay Time\",\n\t\tsoc_enum_envdettime),\n\n\t \n\tSOC_ENUM(\"Headset Mode\", soc_enum_da12voice),\n\tSOC_SINGLE(\"Headset High Pass Switch\",\n\t\tAB8500_ANACONF1, AB8500_ANACONF1_HSHPEN,\n\t\t1, 0),\n\tSOC_SINGLE(\"Headset Low Power Switch\",\n\t\tAB8500_ANACONF1, AB8500_ANACONF1_HSLOWPOW,\n\t\t1, 0),\n\tSOC_SINGLE(\"Headset DAC Low Power Switch\",\n\t\tAB8500_ANACONF1, AB8500_ANACONF1_DACLOWPOW1,\n\t\t1, 0),\n\tSOC_SINGLE(\"Headset DAC Drv Low Power Switch\",\n\t\tAB8500_ANACONF1, AB8500_ANACONF1_DACLOWPOW0,\n\t\t1, 0),\n\tSOC_ENUM(\"Headset Fade Speed\", soc_enum_hsfadspeed),\n\tSOC_ENUM(\"Headset Source\", soc_enum_da2hslr),\n\tSOC_ENUM(\"Headset Filter\", soc_enum_hsesinc),\n\tSOC_DOUBLE_R_TLV(\"Headset Master Volume\",\n\t\tAB8500_DADIGGAIN1, AB8500_DADIGGAIN2,\n\t\t0, AB8500_DADIGGAINX_DAXGAIN_MAX, 1, dax_dig_gain_tlv),\n\tSOC_DOUBLE_R_TLV(\"Headset Digital Volume\",\n\t\tAB8500_HSLEARDIGGAIN, AB8500_HSRDIGGAIN,\n\t\t0, AB8500_HSLEARDIGGAIN_HSLDGAIN_MAX, 1, hs_ear_dig_gain_tlv),\n\tSOC_DOUBLE_TLV(\"Headset Volume\",\n\t\tAB8500_ANAGAIN3,\n\t\tAB8500_ANAGAIN3_HSLGAIN, AB8500_ANAGAIN3_HSRGAIN,\n\t\tAB8500_ANAGAIN3_HSXGAIN_MAX, 1, hs_gain_tlv),\n\n\t \n\tSOC_ENUM(\"Earpiece DAC Mode\",\n\t\tsoc_enum_eardaclowpow),\n\tSOC_ENUM(\"Earpiece DAC Drv Mode\",\n\t\tsoc_enum_eardrvlowpow),\n\n\t \n\tSOC_ENUM(\"HF Mode\", soc_enum_da34voice),\n\tSOC_SINGLE(\"HF and Headset Swap Switch\",\n\t\tAB8500_DASLOTCONF1, AB8500_DASLOTCONF1_SWAPDA12_34,\n\t\t1, 0),\n\tSOC_DOUBLE(\"HF Low EMI Mode Switch\",\n\t\tAB8500_CLASSDCONF1,\n\t\tAB8500_CLASSDCONF1_HFLSWAPEN, AB8500_CLASSDCONF1_HFRSWAPEN,\n\t\t1, 0),\n\tSOC_DOUBLE(\"HF FIR Bypass Switch\",\n\t\tAB8500_CLASSDCONF2,\n\t\tAB8500_CLASSDCONF2_FIRBYP0, AB8500_CLASSDCONF2_FIRBYP1,\n\t\t1, 0),\n\tSOC_DOUBLE(\"HF High Volume Switch\",\n\t\tAB8500_CLASSDCONF2,\n\t\tAB8500_CLASSDCONF2_HIGHVOLEN0, AB8500_CLASSDCONF2_HIGHVOLEN1,\n\t\t1, 0),\n\tSOC_SINGLE(\"HF L and R Bridge Switch\",\n\t\tAB8500_CLASSDCONF1, AB8500_CLASSDCONF1_PARLHF,\n\t\t1, 0),\n\tSOC_DOUBLE_R_TLV(\"HF Master Volume\",\n\t\tAB8500_DADIGGAIN3, AB8500_DADIGGAIN4,\n\t\t0, AB8500_DADIGGAINX_DAXGAIN_MAX, 1, dax_dig_gain_tlv),\n\n\t \n\tSOC_DOUBLE(\"Vibra High Volume Switch\",\n\t\tAB8500_CLASSDCONF2,\n\t\tAB8500_CLASSDCONF2_HIGHVOLEN2, AB8500_CLASSDCONF2_HIGHVOLEN3,\n\t\t1, 0),\n\tSOC_DOUBLE(\"Vibra Low EMI Mode Switch\",\n\t\tAB8500_CLASSDCONF1,\n\t\tAB8500_CLASSDCONF1_VIB1SWAPEN, AB8500_CLASSDCONF1_VIB2SWAPEN,\n\t\t1, 0),\n\tSOC_DOUBLE(\"Vibra FIR Bypass Switch\",\n\t\tAB8500_CLASSDCONF2,\n\t\tAB8500_CLASSDCONF2_FIRBYP2, AB8500_CLASSDCONF2_FIRBYP3,\n\t\t1, 0),\n\tSOC_ENUM(\"Vibra Mode\", soc_enum_da56voice),\n\tSOC_DOUBLE_R(\"Vibra PWM Duty Cycle N\",\n\t\tAB8500_PWMGENCONF3, AB8500_PWMGENCONF5,\n\t\tAB8500_PWMGENCONFX_PWMVIBXDUTCYC,\n\t\tAB8500_PWMGENCONFX_PWMVIBXDUTCYC_MAX, 0),\n\tSOC_DOUBLE_R(\"Vibra PWM Duty Cycle P\",\n\t\tAB8500_PWMGENCONF2, AB8500_PWMGENCONF4,\n\t\tAB8500_PWMGENCONFX_PWMVIBXDUTCYC,\n\t\tAB8500_PWMGENCONFX_PWMVIBXDUTCYC_MAX, 0),\n\tSOC_SINGLE(\"Vibra 1 and 2 Bridge Switch\",\n\t\tAB8500_CLASSDCONF1, AB8500_CLASSDCONF1_PARLVIB,\n\t\t1, 0),\n\tSOC_DOUBLE_R_TLV(\"Vibra Master Volume\",\n\t\tAB8500_DADIGGAIN5, AB8500_DADIGGAIN6,\n\t\t0, AB8500_DADIGGAINX_DAXGAIN_MAX, 1, dax_dig_gain_tlv),\n\n\t \n\tSOC_SINGLE(\"ClassD High Pass Volume\",\n\t\tAB8500_CLASSDCONF3, AB8500_CLASSDCONF3_DITHHPGAIN,\n\t\tAB8500_CLASSDCONF3_DITHHPGAIN_MAX, 0),\n\tSOC_SINGLE(\"ClassD White Volume\",\n\t\tAB8500_CLASSDCONF3, AB8500_CLASSDCONF3_DITHWGAIN,\n\t\tAB8500_CLASSDCONF3_DITHWGAIN_MAX, 0),\n\n\t \n\tSOC_DOUBLE_R_TLV(\"Mic Master Volume\",\n\t\tAB8500_ADDIGGAIN3, AB8500_ADDIGGAIN4,\n\t\t0, AB8500_ADDIGGAINX_ADXGAIN_MAX, 1, adx_dig_gain_tlv),\n\n\t \n\tSOC_SINGLE_TLV(\"Mic 1\",\n\t\tAB8500_ANAGAIN1,\n\t\tAB8500_ANAGAINX_MICXGAIN,\n\t\tAB8500_ANAGAINX_MICXGAIN_MAX, 0, mic_gain_tlv),\n\tSOC_SINGLE(\"Mic 1 Low Power Switch\",\n\t\tAB8500_ANAGAIN1, AB8500_ANAGAINX_LOWPOWMICX,\n\t\t1, 0),\n\n\t \n\tSOC_DOUBLE(\"Mic High Pass Switch\",\n\t\tAB8500_ADFILTCONF,\n\t\tAB8500_ADFILTCONF_AD3NH, AB8500_ADFILTCONF_AD4NH,\n\t\t1, 1),\n\tSOC_ENUM(\"Mic Mode\", soc_enum_ad34voice),\n\tSOC_ENUM(\"Mic Filter\", soc_enum_dmic34sinc),\n\tSOC_SINGLE_TLV(\"Mic 2\",\n\t\tAB8500_ANAGAIN2,\n\t\tAB8500_ANAGAINX_MICXGAIN,\n\t\tAB8500_ANAGAINX_MICXGAIN_MAX, 0, mic_gain_tlv),\n\tSOC_SINGLE(\"Mic 2 Low Power Switch\",\n\t\tAB8500_ANAGAIN2, AB8500_ANAGAINX_LOWPOWMICX,\n\t\t1, 0),\n\n\t \n\tSOC_DOUBLE(\"LineIn High Pass Switch\",\n\t\tAB8500_ADFILTCONF,\n\t\tAB8500_ADFILTCONF_AD1NH, AB8500_ADFILTCONF_AD2NH,\n\t\t1, 1),\n\tSOC_ENUM(\"LineIn Filter\", soc_enum_dmic12sinc),\n\tSOC_ENUM(\"LineIn Mode\", soc_enum_ad12voice),\n\tSOC_DOUBLE_R_TLV(\"LineIn Master Volume\",\n\t\tAB8500_ADDIGGAIN1, AB8500_ADDIGGAIN2,\n\t\t0, AB8500_ADDIGGAINX_ADXGAIN_MAX, 1, adx_dig_gain_tlv),\n\tSOC_DOUBLE_TLV(\"LineIn\",\n\t\tAB8500_ANAGAIN4,\n\t\tAB8500_ANAGAIN4_LINLGAIN, AB8500_ANAGAIN4_LINRGAIN,\n\t\tAB8500_ANAGAIN4_LINXGAIN_MAX, 0, lin_gain_tlv),\n\tSOC_DOUBLE_R_TLV(\"LineIn to Headset Volume\",\n\t\tAB8500_DIGLINHSLGAIN, AB8500_DIGLINHSRGAIN,\n\t\tAB8500_DIGLINHSXGAIN_LINTOHSXGAIN,\n\t\tAB8500_DIGLINHSXGAIN_LINTOHSXGAIN_MAX,\n\t\t1, lin2hs_gain_tlv),\n\n\t \n\tSOC_ENUM(\"DMic Filter\", soc_enum_dmic56sinc),\n\tSOC_DOUBLE_R_TLV(\"DMic Master Volume\",\n\t\tAB8500_ADDIGGAIN5, AB8500_ADDIGGAIN6,\n\t\t0, AB8500_ADDIGGAINX_ADXGAIN_MAX, 1, adx_dig_gain_tlv),\n\n\t \n\tSOC_ENUM(\"Digital Gain Fade Speed\", soc_enum_fadespeed),\n\n\t \n\tSOC_DOUBLE_R_TLV(\"Analog Loopback Volume\",\n\t\tAB8500_ADDIGLOOPGAIN1, AB8500_ADDIGLOOPGAIN2,\n\t\t0, AB8500_ADDIGLOOPGAINX_ADXLBGAIN_MAX, 1, dax_dig_gain_tlv),\n\n\t \n\tSOC_ENUM(\"Digital Interface DA 1 From Slot Map\", soc_enum_da1slotmap),\n\tSOC_ENUM(\"Digital Interface DA 2 From Slot Map\", soc_enum_da2slotmap),\n\tSOC_ENUM(\"Digital Interface DA 3 From Slot Map\", soc_enum_da3slotmap),\n\tSOC_ENUM(\"Digital Interface DA 4 From Slot Map\", soc_enum_da4slotmap),\n\tSOC_ENUM(\"Digital Interface DA 5 From Slot Map\", soc_enum_da5slotmap),\n\tSOC_ENUM(\"Digital Interface DA 6 From Slot Map\", soc_enum_da6slotmap),\n\tSOC_ENUM(\"Digital Interface DA 7 From Slot Map\", soc_enum_da7slotmap),\n\tSOC_ENUM(\"Digital Interface DA 8 From Slot Map\", soc_enum_da8slotmap),\n\n\t \n\tSOC_ENUM(\"Digital Interface AD To Slot 0 Map\", soc_enum_adslot0map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 1 Map\", soc_enum_adslot1map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 2 Map\", soc_enum_adslot2map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 3 Map\", soc_enum_adslot3map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 4 Map\", soc_enum_adslot4map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 5 Map\", soc_enum_adslot5map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 6 Map\", soc_enum_adslot6map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 7 Map\", soc_enum_adslot7map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 8 Map\", soc_enum_adslot8map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 9 Map\", soc_enum_adslot9map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 10 Map\", soc_enum_adslot10map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 11 Map\", soc_enum_adslot11map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 12 Map\", soc_enum_adslot12map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 13 Map\", soc_enum_adslot13map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 14 Map\", soc_enum_adslot14map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 15 Map\", soc_enum_adslot15map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 16 Map\", soc_enum_adslot16map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 17 Map\", soc_enum_adslot17map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 18 Map\", soc_enum_adslot18map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 19 Map\", soc_enum_adslot19map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 20 Map\", soc_enum_adslot20map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 21 Map\", soc_enum_adslot21map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 22 Map\", soc_enum_adslot22map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 23 Map\", soc_enum_adslot23map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 24 Map\", soc_enum_adslot24map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 25 Map\", soc_enum_adslot25map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 26 Map\", soc_enum_adslot26map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 27 Map\", soc_enum_adslot27map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 28 Map\", soc_enum_adslot28map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 29 Map\", soc_enum_adslot29map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 30 Map\", soc_enum_adslot30map),\n\tSOC_ENUM(\"Digital Interface AD To Slot 31 Map\", soc_enum_adslot31map),\n\n\t \n\tSOC_SINGLE(\"Digital Interface AD 1 Loopback Switch\",\n\t\tAB8500_DASLOTCONF1, AB8500_DASLOTCONF1_DAI7TOADO1,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 2 Loopback Switch\",\n\t\tAB8500_DASLOTCONF2, AB8500_DASLOTCONF2_DAI8TOADO2,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 3 Loopback Switch\",\n\t\tAB8500_DASLOTCONF3, AB8500_DASLOTCONF3_DAI7TOADO3,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 4 Loopback Switch\",\n\t\tAB8500_DASLOTCONF4, AB8500_DASLOTCONF4_DAI8TOADO4,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 5 Loopback Switch\",\n\t\tAB8500_DASLOTCONF5, AB8500_DASLOTCONF5_DAI7TOADO5,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 6 Loopback Switch\",\n\t\tAB8500_DASLOTCONF6, AB8500_DASLOTCONF6_DAI8TOADO6,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 7 Loopback Switch\",\n\t\tAB8500_DASLOTCONF7, AB8500_DASLOTCONF7_DAI8TOADO7,\n\t\t1, 0),\n\tSOC_SINGLE(\"Digital Interface AD 8 Loopback Switch\",\n\t\tAB8500_DASLOTCONF8, AB8500_DASLOTCONF8_DAI7TOADO8,\n\t\t1, 0),\n\n\t \n\tSOC_SINGLE(\"Digital Interface 0 FIFO Enable Switch\",\n\t\tAB8500_DIGIFCONF3, AB8500_DIGIFCONF3_IF0BFIFOEN,\n\t\t1, 0),\n\tSOC_ENUM(\"Burst FIFO Mask\", soc_enum_bfifomask),\n\tSOC_ENUM(\"Burst FIFO Bit-clock Frequency\", soc_enum_bfifo19m2),\n\tSOC_SINGLE(\"Burst FIFO Threshold\",\n\t\tAB8500_FIFOCONF1, AB8500_FIFOCONF1_BFIFOINT_SHIFT,\n\t\tAB8500_FIFOCONF1_BFIFOINT_MAX, 0),\n\tSOC_SINGLE(\"Burst FIFO Length\",\n\t\tAB8500_FIFOCONF2, AB8500_FIFOCONF2_BFIFOTX_SHIFT,\n\t\tAB8500_FIFOCONF2_BFIFOTX_MAX, 0),\n\tSOC_SINGLE(\"Burst FIFO EOS Extra Slots\",\n\t\tAB8500_FIFOCONF3, AB8500_FIFOCONF3_BFIFOEXSL_SHIFT,\n\t\tAB8500_FIFOCONF3_BFIFOEXSL_MAX, 0),\n\tSOC_SINGLE(\"Burst FIFO FS Extra Bit-clocks\",\n\t\tAB8500_FIFOCONF3, AB8500_FIFOCONF3_PREBITCLK0_SHIFT,\n\t\tAB8500_FIFOCONF3_PREBITCLK0_MAX, 0),\n\tSOC_ENUM(\"Burst FIFO Interface Mode\", soc_enum_bfifomast),\n\n\tSOC_SINGLE(\"Burst FIFO Interface Switch\",\n\t\tAB8500_FIFOCONF3, AB8500_FIFOCONF3_BFIFORUN_SHIFT,\n\t\t1, 0),\n\tSOC_SINGLE(\"Burst FIFO Switch Frame Number\",\n\t\tAB8500_FIFOCONF4, AB8500_FIFOCONF4_BFIFOFRAMSW_SHIFT,\n\t\tAB8500_FIFOCONF4_BFIFOFRAMSW_MAX, 0),\n\tSOC_SINGLE(\"Burst FIFO Wake Up Delay\",\n\t\tAB8500_FIFOCONF5, AB8500_FIFOCONF5_BFIFOWAKEUP_SHIFT,\n\t\tAB8500_FIFOCONF5_BFIFOWAKEUP_MAX, 0),\n\tSOC_SINGLE(\"Burst FIFO Samples In FIFO\",\n\t\tAB8500_FIFOCONF6, AB8500_FIFOCONF6_BFIFOSAMPLE_SHIFT,\n\t\tAB8500_FIFOCONF6_BFIFOSAMPLE_MAX, 0),\n\n\t \n\tSOC_ENUM_EXT(\"ANC Status\", soc_enum_ancstate,\n\t\tanc_status_control_get, anc_status_control_put),\n\tSOC_SINGLE_XR_SX(\"ANC Warp Delay Shift\",\n\t\tAB8500_ANCCONF2, 1, AB8500_ANCCONF2_SHIFT,\n\t\tAB8500_ANCCONF2_MIN, AB8500_ANCCONF2_MAX, 0),\n\tSOC_SINGLE_XR_SX(\"ANC FIR Output Shift\",\n\t\tAB8500_ANCCONF3, 1, AB8500_ANCCONF3_SHIFT,\n\t\tAB8500_ANCCONF3_MIN, AB8500_ANCCONF3_MAX, 0),\n\tSOC_SINGLE_XR_SX(\"ANC IIR Output Shift\",\n\t\tAB8500_ANCCONF4, 1, AB8500_ANCCONF4_SHIFT,\n\t\tAB8500_ANCCONF4_MIN, AB8500_ANCCONF4_MAX, 0),\n\tSOC_SINGLE_XR_SX(\"ANC Warp Delay\",\n\t\tAB8500_ANCCONF9, 2, AB8500_ANC_WARP_DELAY_SHIFT,\n\t\tAB8500_ANC_WARP_DELAY_MIN, AB8500_ANC_WARP_DELAY_MAX, 0),\n\n\t \n\tSOC_ENUM_EXT(\"Sidetone Status\", soc_enum_sidstate,\n\t\tsid_status_control_get, sid_status_control_put),\n\tSOC_SINGLE_STROBE(\"Sidetone Reset\",\n\t\tAB8500_SIDFIRADR, AB8500_SIDFIRADR_FIRSIDSET, 0),\n};\n\nstatic struct snd_kcontrol_new ab8500_filter_controls[] = {\n\tAB8500_FILTER_CONTROL(\"ANC FIR Coefficients\", AB8500_ANC_FIR_COEFFS,\n\t\tAB8500_ANC_FIR_COEFF_MIN, AB8500_ANC_FIR_COEFF_MAX),\n\tAB8500_FILTER_CONTROL(\"ANC IIR Coefficients\", AB8500_ANC_IIR_COEFFS,\n\t\tAB8500_ANC_IIR_COEFF_MIN, AB8500_ANC_IIR_COEFF_MAX),\n\tAB8500_FILTER_CONTROL(\"Sidetone FIR Coefficients\",\n\t\t\tAB8500_SID_FIR_COEFFS, AB8500_SID_FIR_COEFF_MIN,\n\t\t\tAB8500_SID_FIR_COEFF_MAX)\n};\nenum ab8500_filter {\n\tAB8500_FILTER_ANC_FIR = 0,\n\tAB8500_FILTER_ANC_IIR = 1,\n\tAB8500_FILTER_SID_FIR = 2,\n};\n\n \n\nstatic int ab8500_audio_init_audioblock(struct snd_soc_component *component)\n{\n\tint status;\n\n\tdev_dbg(component->dev, \"%s: Enter.\\n\", __func__);\n\n\t \n\tstatus = ab8500_sysctrl_write(AB8500_STW4500CTRL3,\n\t\t\t\tAB8500_STW4500CTRL3_CLK32KOUT2DIS |\n\t\t\t\t\tAB8500_STW4500CTRL3_RESETAUDN,\n\t\t\t\tAB8500_STW4500CTRL3_RESETAUDN);\n\tif (status < 0)\n\t\treturn status;\n\n\treturn 0;\n}\n\nstatic int ab8500_audio_setup_mics(struct snd_soc_component *component,\n\t\t\tstruct amic_settings *amics)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tu8 value8;\n\tunsigned int value;\n\tint status;\n\tconst struct snd_soc_dapm_route *route;\n\n\tdev_dbg(component->dev, \"%s: Enter.\\n\", __func__);\n\n\t \n\tstatus = abx500_get_register_interruptible(component->dev, AB8500_MISC,\n\t\t\t\t\t\tAB8500_GPIO_DIR4_REG,\n\t\t\t\t\t\t&value8);\n\tif (status < 0)\n\t\treturn status;\n\tvalue = value8 | GPIO27_DIR_OUTPUT | GPIO29_DIR_OUTPUT |\n\t\tGPIO31_DIR_OUTPUT;\n\tstatus = abx500_set_register_interruptible(component->dev,\n\t\t\t\t\t\tAB8500_MISC,\n\t\t\t\t\t\tAB8500_GPIO_DIR4_REG,\n\t\t\t\t\t\tvalue);\n\tif (status < 0)\n\t\treturn status;\n\n\t \n\tdev_dbg(component->dev, \"%s: Mic 1a regulator: %s\\n\", __func__,\n\t\tamic_micbias_str(amics->mic1a_micbias));\n\troute = &ab8500_dapm_routes_mic1a_vamicx[amics->mic1a_micbias];\n\tstatus = snd_soc_dapm_add_routes(dapm, route, 1);\n\tdev_dbg(component->dev, \"%s: Mic 1b regulator: %s\\n\", __func__,\n\t\tamic_micbias_str(amics->mic1b_micbias));\n\troute = &ab8500_dapm_routes_mic1b_vamicx[amics->mic1b_micbias];\n\tstatus |= snd_soc_dapm_add_routes(dapm, route, 1);\n\tdev_dbg(component->dev, \"%s: Mic 2 regulator: %s\\n\", __func__,\n\t\tamic_micbias_str(amics->mic2_micbias));\n\troute = &ab8500_dapm_routes_mic2_vamicx[amics->mic2_micbias];\n\tstatus |= snd_soc_dapm_add_routes(dapm, route, 1);\n\tif (status < 0) {\n\t\tdev_err(component->dev,\n\t\t\t\"%s: Failed to add AMic-regulator DAPM-routes (%d).\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\n\t \n\tdev_dbg(component->dev, \"%s: Mic 1 mic-type: %s\\n\", __func__,\n\t\tamic_type_str(amics->mic1_type));\n\tsnd_soc_component_update_bits(component, AB8500_ANAGAIN1, AB8500_ANAGAINX_ENSEMICX,\n\t\t\tamics->mic1_type == AMIC_TYPE_DIFFERENTIAL ?\n\t\t\t\t0 : AB8500_ANAGAINX_ENSEMICX);\n\tdev_dbg(component->dev, \"%s: Mic 2 mic-type: %s\\n\", __func__,\n\t\tamic_type_str(amics->mic2_type));\n\tsnd_soc_component_update_bits(component, AB8500_ANAGAIN2, AB8500_ANAGAINX_ENSEMICX,\n\t\t\tamics->mic2_type == AMIC_TYPE_DIFFERENTIAL ?\n\t\t\t\t0 : AB8500_ANAGAINX_ENSEMICX);\n\n\treturn 0;\n}\n\nstatic int ab8500_audio_set_ear_cmv(struct snd_soc_component *component,\n\t\t\t\tenum ear_cm_voltage ear_cmv)\n{\n\tchar *cmv_str;\n\n\tswitch (ear_cmv) {\n\tcase EAR_CMV_0_95V:\n\t\tcmv_str = \"0.95V\";\n\t\tbreak;\n\tcase EAR_CMV_1_10V:\n\t\tcmv_str = \"1.10V\";\n\t\tbreak;\n\tcase EAR_CMV_1_27V:\n\t\tcmv_str = \"1.27V\";\n\t\tbreak;\n\tcase EAR_CMV_1_58V:\n\t\tcmv_str = \"1.58V\";\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev,\n\t\t\t\"%s: Unknown earpiece CM-voltage (%d)!\\n\",\n\t\t\t__func__, (int)ear_cmv);\n\t\treturn -EINVAL;\n\t}\n\tdev_dbg(component->dev, \"%s: Earpiece CM-voltage: %s\\n\", __func__,\n\t\tcmv_str);\n\tsnd_soc_component_update_bits(component, AB8500_ANACONF1, AB8500_ANACONF1_EARSELCM,\n\t\t\tear_cmv);\n\n\treturn 0;\n}\n\nstatic int ab8500_audio_set_bit_delay(struct snd_soc_dai *dai,\n\t\t\t\tunsigned int delay)\n{\n\tunsigned int mask, val;\n\tstruct snd_soc_component *component = dai->component;\n\n\tmask = BIT(AB8500_DIGIFCONF2_IF0DEL);\n\tval = 0;\n\n\tswitch (delay) {\n\tcase 0:\n\t\tbreak;\n\tcase 1:\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0DEL);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Unsupported bit-delay (0x%x)!\\n\",\n\t\t\t__func__, delay);\n\t\treturn -EINVAL;\n\t}\n\n\tdev_dbg(dai->component->dev, \"%s: IF0 Bit-delay: %d bits.\\n\",\n\t\t__func__, delay);\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF2, mask, val);\n\n\treturn 0;\n}\n\n \nstatic int ab8500_codec_set_dai_clock_gate(struct snd_soc_component *component,\n\t\t\t\t\tunsigned int fmt)\n{\n\tunsigned int mask;\n\tunsigned int val;\n\n\tmask = BIT(AB8500_DIGIFCONF1_ENMASTGEN) |\n\t\t\tBIT(AB8500_DIGIFCONF1_ENFSBITCLK0);\n\n\tval = BIT(AB8500_DIGIFCONF1_ENMASTGEN);\n\n\tswitch (fmt & SND_SOC_DAIFMT_CLOCK_MASK) {\n\tcase SND_SOC_DAIFMT_CONT:  \n\t\tdev_dbg(component->dev, \"%s: IF0 Clock is continuous.\\n\",\n\t\t\t__func__);\n\t\tval |= BIT(AB8500_DIGIFCONF1_ENFSBITCLK0);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_GATED:  \n\t\tdev_dbg(component->dev, \"%s: IF0 Clock is gated.\\n\",\n\t\t\t__func__);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev,\n\t\t\t\"%s: ERROR: Unsupported clock mask (0x%x)!\\n\",\n\t\t\t__func__, fmt & SND_SOC_DAIFMT_CLOCK_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF1, mask, val);\n\n\treturn 0;\n}\n\nstatic int ab8500_codec_set_dai_fmt(struct snd_soc_dai *dai, unsigned int fmt)\n{\n\tunsigned int mask;\n\tunsigned int val;\n\tstruct snd_soc_component *component = dai->component;\n\tint status;\n\n\tdev_dbg(component->dev, \"%s: Enter (fmt = 0x%x)\\n\", __func__, fmt);\n\n\tmask = BIT(AB8500_DIGIFCONF3_IF1DATOIF0AD) |\n\t\t\tBIT(AB8500_DIGIFCONF3_IF1CLKTOIF0CLK) |\n\t\t\tBIT(AB8500_DIGIFCONF3_IF0BFIFOEN) |\n\t\t\tBIT(AB8500_DIGIFCONF3_IF0MASTER);\n\tval = 0;\n\n\tswitch (fmt & SND_SOC_DAIFMT_CLOCK_PROVIDER_MASK) {\n\tcase SND_SOC_DAIFMT_CBP_CFP:\n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0 Master-mode: AB8500 provider.\\n\", __func__);\n\t\tval |= BIT(AB8500_DIGIFCONF3_IF0MASTER);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBC_CFC:\n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0 Master-mode: AB8500 consumer.\\n\", __func__);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBC_CFP:\n\tcase SND_SOC_DAIFMT_CBP_CFC:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: The device is either a provider or a consumer.\\n\",\n\t\t\t__func__);\n\t\tfallthrough;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Unsupporter clocking mask 0x%x\\n\",\n\t\t\t__func__, fmt & SND_SOC_DAIFMT_CLOCK_PROVIDER_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF3, mask, val);\n\n\t \n\tstatus = ab8500_codec_set_dai_clock_gate(component, fmt);\n\tif (status) {\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Failed to set clock gate (%d).\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\n\t \n\n\tmask = BIT(AB8500_DIGIFCONF2_IF0FORMAT0) |\n\t\tBIT(AB8500_DIGIFCONF2_IF0FORMAT1) |\n\t\tBIT(AB8500_DIGIFCONF2_FSYNC0P) |\n\t\tBIT(AB8500_DIGIFCONF2_BITCLK0P);\n\tval = 0;\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:  \n\t\tdev_dbg(dai->component->dev, \"%s: IF0 Protocol: I2S\\n\", __func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0FORMAT1);\n\t\tab8500_audio_set_bit_delay(dai, 0);\n\t\tbreak;\n\n\tcase SND_SOC_DAIFMT_DSP_A:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0 Protocol: DSP A (TDM)\\n\", __func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0FORMAT0);\n\t\tab8500_audio_set_bit_delay(dai, 1);\n\t\tbreak;\n\n\tcase SND_SOC_DAIFMT_DSP_B:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0 Protocol: DSP B (TDM)\\n\", __func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0FORMAT0);\n\t\tab8500_audio_set_bit_delay(dai, 0);\n\t\tbreak;\n\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Unsupported format (0x%x)!\\n\",\n\t\t\t__func__, fmt & SND_SOC_DAIFMT_FORMAT_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_INV_MASK) {\n\tcase SND_SOC_DAIFMT_NB_NF:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0: Normal bit clock, normal frame\\n\",\n\t\t\t__func__);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_NB_IF:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0: Normal bit clock, inverted frame\\n\",\n\t\t\t__func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_FSYNC0P);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_NF:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0: Inverted bit clock, normal frame\\n\",\n\t\t\t__func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_BITCLK0P);\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_IF:  \n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: IF0: Inverted bit clock, inverted frame\\n\",\n\t\t\t__func__);\n\t\tval |= BIT(AB8500_DIGIFCONF2_FSYNC0P);\n\t\tval |= BIT(AB8500_DIGIFCONF2_BITCLK0P);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Unsupported INV mask 0x%x\\n\",\n\t\t\t__func__, fmt & SND_SOC_DAIFMT_INV_MASK);\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF2, mask, val);\n\n\treturn 0;\n}\n\nstatic int ab8500_codec_set_dai_tdm_slot(struct snd_soc_dai *dai,\n\t\tunsigned int tx_mask, unsigned int rx_mask,\n\t\tint slots, int slot_width)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tunsigned int val, mask, slot, slots_active;\n\n\tmask = BIT(AB8500_DIGIFCONF2_IF0WL0) |\n\t\tBIT(AB8500_DIGIFCONF2_IF0WL1);\n\tval = 0;\n\n\tswitch (slot_width) {\n\tcase 16:\n\t\tbreak;\n\tcase 20:\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0WL0);\n\t\tbreak;\n\tcase 24:\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0WL1);\n\t\tbreak;\n\tcase 32:\n\t\tval |= BIT(AB8500_DIGIFCONF2_IF0WL1) |\n\t\t\tBIT(AB8500_DIGIFCONF2_IF0WL0);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev, \"%s: Unsupported slot-width 0x%x\\n\",\n\t\t\t__func__, slot_width);\n\t\treturn -EINVAL;\n\t}\n\n\tdev_dbg(dai->component->dev, \"%s: IF0 slot-width: %d bits.\\n\",\n\t\t__func__, slot_width);\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF2, mask, val);\n\n\t \n\tdev_dbg(dai->component->dev, \"%s: Slots, total: %d\\n\", __func__, slots);\n\tmask = BIT(AB8500_DIGIFCONF1_IF0BITCLKOS0) |\n\t\t\tBIT(AB8500_DIGIFCONF1_IF0BITCLKOS1);\n\tswitch (slots) {\n\tcase 2:\n\t\tval = AB8500_MASK_NONE;\n\t\tbreak;\n\tcase 4:\n\t\tval = BIT(AB8500_DIGIFCONF1_IF0BITCLKOS0);\n\t\tbreak;\n\tcase 8:\n\t\tval = BIT(AB8500_DIGIFCONF1_IF0BITCLKOS1);\n\t\tbreak;\n\tcase 16:\n\t\tval = BIT(AB8500_DIGIFCONF1_IF0BITCLKOS0) |\n\t\t\tBIT(AB8500_DIGIFCONF1_IF0BITCLKOS1);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: ERROR: Unsupported number of slots (%d)!\\n\",\n\t\t\t__func__, slots);\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, AB8500_DIGIFCONF1, mask, val);\n\n\t \n\n\tif (tx_mask & ~0xff)\n\t\treturn -EINVAL;\n\n\tmask = AB8500_DASLOTCONFX_SLTODAX_MASK;\n\ttx_mask = tx_mask << AB8500_DA_DATA0_OFFSET;\n\tslots_active = hweight32(tx_mask);\n\n\tdev_dbg(dai->component->dev, \"%s: Slots, active, TX: %d\\n\", __func__,\n\t\tslots_active);\n\n\tswitch (slots_active) {\n\tcase 0:\n\t\tbreak;\n\tcase 1:\n\t\tslot = ffs(tx_mask);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF1, mask, slot);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF3, mask, slot);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF2, mask, slot);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF4, mask, slot);\n\t\tbreak;\n\tcase 2:\n\t\tslot = ffs(tx_mask);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF1, mask, slot);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF3, mask, slot);\n\t\tslot = fls(tx_mask);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF2, mask, slot);\n\t\tsnd_soc_component_update_bits(component, AB8500_DASLOTCONF4, mask, slot);\n\t\tbreak;\n\tcase 8:\n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: In 8-channel mode DA-from-slot mapping is set manually.\",\n\t\t\t__func__);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: Unsupported number of active TX-slots (%d)!\\n\",\n\t\t\t__func__, slots_active);\n\t\treturn -EINVAL;\n\t}\n\n\t \n\n\tif (rx_mask & ~0xff)\n\t\treturn -EINVAL;\n\n\trx_mask = rx_mask << AB8500_AD_DATA0_OFFSET;\n\tslots_active = hweight32(rx_mask);\n\n\tdev_dbg(dai->component->dev, \"%s: Slots, active, RX: %d\\n\", __func__,\n\t\tslots_active);\n\n\tswitch (slots_active) {\n\tcase 0:\n\t\tbreak;\n\tcase 1:\n\t\tslot = ffs(rx_mask);\n\t\tsnd_soc_component_update_bits(component, AB8500_ADSLOTSEL(slot),\n\t\t\t\tAB8500_MASK_SLOT(slot),\n\t\t\t\tAB8500_ADSLOTSELX_AD_OUT_TO_SLOT(AB8500_AD_OUT3, slot));\n\t\tbreak;\n\tcase 2:\n\t\tslot = ffs(rx_mask);\n\t\tsnd_soc_component_update_bits(component,\n\t\t\t\tAB8500_ADSLOTSEL(slot),\n\t\t\t\tAB8500_MASK_SLOT(slot),\n\t\t\t\tAB8500_ADSLOTSELX_AD_OUT_TO_SLOT(AB8500_AD_OUT3, slot));\n\t\tslot = fls(rx_mask);\n\t\tsnd_soc_component_update_bits(component,\n\t\t\t\tAB8500_ADSLOTSEL(slot),\n\t\t\t\tAB8500_MASK_SLOT(slot),\n\t\t\t\tAB8500_ADSLOTSELX_AD_OUT_TO_SLOT(AB8500_AD_OUT2, slot));\n\t\tbreak;\n\tcase 8:\n\t\tdev_dbg(dai->component->dev,\n\t\t\t\"%s: In 8-channel mode AD-to-slot mapping is set manually.\",\n\t\t\t__func__);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(dai->component->dev,\n\t\t\t\"%s: Unsupported number of active RX-slots (%d)!\\n\",\n\t\t\t__func__, slots_active);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops ab8500_codec_ops = {\n\t.set_fmt = ab8500_codec_set_dai_fmt,\n\t.set_tdm_slot = ab8500_codec_set_dai_tdm_slot,\n};\n\nstatic struct snd_soc_dai_driver ab8500_codec_dai[] = {\n\t{\n\t\t.name = \"ab8500-codec-dai.0\",\n\t\t.id = 0,\n\t\t.playback = {\n\t\t\t.stream_name = \"ab8500_0p\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 8,\n\t\t\t.rates = AB8500_SUPPORTED_RATE,\n\t\t\t.formats = AB8500_SUPPORTED_FMT,\n\t\t},\n\t\t.ops = &ab8500_codec_ops,\n\t\t.symmetric_rate = 1\n\t},\n\t{\n\t\t.name = \"ab8500-codec-dai.1\",\n\t\t.id = 1,\n\t\t.capture = {\n\t\t\t.stream_name = \"ab8500_0c\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 8,\n\t\t\t.rates = AB8500_SUPPORTED_RATE,\n\t\t\t.formats = AB8500_SUPPORTED_FMT,\n\t\t},\n\t\t.ops = &ab8500_codec_ops,\n\t\t.symmetric_rate = 1\n\t}\n};\n\nstatic void ab8500_codec_of_probe(struct device *dev, struct device_node *np,\n\t\t\t\tstruct ab8500_codec_platform_data *codec)\n{\n\tu32 value;\n\n\tif (of_property_read_bool(np, \"stericsson,amic1-type-single-ended\"))\n\t\tcodec->amics.mic1_type = AMIC_TYPE_SINGLE_ENDED;\n\telse\n\t\tcodec->amics.mic1_type = AMIC_TYPE_DIFFERENTIAL;\n\n\tif (of_property_read_bool(np, \"stericsson,amic2-type-single-ended\"))\n\t\tcodec->amics.mic2_type = AMIC_TYPE_SINGLE_ENDED;\n\telse\n\t\tcodec->amics.mic2_type = AMIC_TYPE_DIFFERENTIAL;\n\n\t \n\tif (of_property_read_bool(np, \"stericsson,amic1a-bias-vamic2\"))\n\t\tcodec->amics.mic1a_micbias = AMIC_MICBIAS_VAMIC2;\n\telse\n\t\tcodec->amics.mic1a_micbias = AMIC_MICBIAS_VAMIC1;\n\n\tif (of_property_read_bool(np, \"stericsson,amic1b-bias-vamic2\"))\n\t\tcodec->amics.mic1b_micbias = AMIC_MICBIAS_VAMIC2;\n\telse\n\t\tcodec->amics.mic1b_micbias = AMIC_MICBIAS_VAMIC1;\n\n\tif (of_property_read_bool(np, \"stericsson,amic2-bias-vamic1\"))\n\t\tcodec->amics.mic2_micbias = AMIC_MICBIAS_VAMIC1;\n\telse\n\t\tcodec->amics.mic2_micbias = AMIC_MICBIAS_VAMIC2;\n\n\tif (!of_property_read_u32(np, \"stericsson,earpeice-cmv\", &value)) {\n\t\tswitch (value) {\n\t\tcase 950 :\n\t\t\tcodec->ear_cmv = EAR_CMV_0_95V;\n\t\t\tbreak;\n\t\tcase 1100 :\n\t\t\tcodec->ear_cmv = EAR_CMV_1_10V;\n\t\t\tbreak;\n\t\tcase 1270 :\n\t\t\tcodec->ear_cmv = EAR_CMV_1_27V;\n\t\t\tbreak;\n\t\tcase 1580 :\n\t\t\tcodec->ear_cmv = EAR_CMV_1_58V;\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tcodec->ear_cmv = EAR_CMV_UNKNOWN;\n\t\t\tdev_err(dev, \"Unsuitable earpiece voltage found in DT\\n\");\n\t\t}\n\t} else {\n\t\tdev_warn(dev, \"No earpiece voltage found in DT - using default\\n\");\n\t\tcodec->ear_cmv = EAR_CMV_0_95V;\n\t}\n}\n\nstatic int ab8500_codec_probe(struct snd_soc_component *component)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct device *dev = component->dev;\n\tstruct device_node *np = dev->of_node;\n\tstruct ab8500_codec_drvdata *drvdata = dev_get_drvdata(dev);\n\tstruct ab8500_codec_platform_data codec_pdata;\n\tstruct filter_control *fc;\n\tint status;\n\n\tdev_dbg(dev, \"%s: Enter.\\n\", __func__);\n\n\tab8500_codec_of_probe(dev, np, &codec_pdata);\n\n\tstatus = ab8500_audio_setup_mics(component, &codec_pdata.amics);\n\tif (status < 0) {\n\t\tpr_err(\"%s: Failed to setup mics (%d)!\\n\", __func__, status);\n\t\treturn status;\n\t}\n\tstatus = ab8500_audio_set_ear_cmv(component, codec_pdata.ear_cmv);\n\tif (status < 0) {\n\t\tpr_err(\"%s: Failed to set earpiece CM-voltage (%d)!\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\n\tstatus = ab8500_audio_init_audioblock(component);\n\tif (status < 0) {\n\t\tdev_err(dev, \"%s: failed to init audio-block (%d)!\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\n\t \n\tsnd_soc_component_write(component, AB8500_ANACONF5,\n\t\t      BIT(AB8500_ANACONF5_HSAUTOEN));\n\tsnd_soc_component_write(component, AB8500_SHORTCIRCONF,\n\t\t      BIT(AB8500_SHORTCIRCONF_HSZCDDIS));\n\n\t \n\tstatus = snd_soc_add_component_controls(component, ab8500_filter_controls,\n\t\t\t\tARRAY_SIZE(ab8500_filter_controls));\n\tif (status < 0) {\n\t\tdev_err(dev,\n\t\t\t\"%s: failed to add ab8500 filter controls (%d).\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\tfc = (struct filter_control *)\n\t\t&ab8500_filter_controls[AB8500_FILTER_ANC_FIR].private_value;\n\tdrvdata->anc_fir_values = (long *)fc->value;\n\tfc = (struct filter_control *)\n\t\t&ab8500_filter_controls[AB8500_FILTER_ANC_IIR].private_value;\n\tdrvdata->anc_iir_values = (long *)fc->value;\n\tfc = (struct filter_control *)\n\t\t&ab8500_filter_controls[AB8500_FILTER_SID_FIR].private_value;\n\tdrvdata->sid_fir_values = (long *)fc->value;\n\n\tsnd_soc_dapm_disable_pin(dapm, \"ANC Configure Input\");\n\n\tmutex_init(&drvdata->ctrl_lock);\n\n\treturn status;\n}\n\nstatic const struct snd_soc_component_driver ab8500_component_driver = {\n\t.probe\t\t\t= ab8500_codec_probe,\n\t.controls\t\t= ab8500_ctrls,\n\t.num_controls\t\t= ARRAY_SIZE(ab8500_ctrls),\n\t.dapm_widgets\t\t= ab8500_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(ab8500_dapm_widgets),\n\t.dapm_routes\t\t= ab8500_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(ab8500_dapm_routes),\n\t.idle_bias_on\t\t= 1,\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic int ab8500_codec_driver_probe(struct platform_device *pdev)\n{\n\tint status;\n\tstruct ab8500_codec_drvdata *drvdata;\n\n\tdev_dbg(&pdev->dev, \"%s: Enter.\\n\", __func__);\n\n\t \n\tdrvdata = devm_kzalloc(&pdev->dev, sizeof(struct ab8500_codec_drvdata),\n\t\t\tGFP_KERNEL);\n\tif (!drvdata)\n\t\treturn -ENOMEM;\n\tdrvdata->sid_status = SID_UNCONFIGURED;\n\tdrvdata->anc_status = ANC_UNCONFIGURED;\n\tdev_set_drvdata(&pdev->dev, drvdata);\n\n\tdrvdata->regmap = devm_regmap_init(&pdev->dev, NULL, &pdev->dev,\n\t\t\t\t\t   &ab8500_codec_regmap);\n\tif (IS_ERR(drvdata->regmap)) {\n\t\tstatus = PTR_ERR(drvdata->regmap);\n\t\tdev_err(&pdev->dev, \"%s: Failed to allocate regmap: %d\\n\",\n\t\t\t__func__, status);\n\t\treturn status;\n\t}\n\n\tdev_dbg(&pdev->dev, \"%s: Register codec.\\n\", __func__);\n\tstatus = devm_snd_soc_register_component(&pdev->dev,\n\t\t\t\t&ab8500_component_driver,\n\t\t\t\tab8500_codec_dai,\n\t\t\t\tARRAY_SIZE(ab8500_codec_dai));\n\tif (status < 0)\n\t\tdev_err(&pdev->dev,\n\t\t\t\"%s: Error: Failed to register codec (%d).\\n\",\n\t\t\t__func__, status);\n\n\treturn status;\n}\n\nstatic struct platform_driver ab8500_codec_platform_driver = {\n\t.driver\t= {\n\t\t.name\t= \"ab8500-codec\",\n\t},\n\t.probe\t\t= ab8500_codec_driver_probe,\n};\nmodule_platform_driver(ab8500_codec_platform_driver);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}