{
  "module_name": "wsa883x.c",
  "hash_id": "f465ee939e0c1106dcf628322aeb6e5c128ac4d97348a787edcb35dd9956bbea",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/wsa883x.c",
  "human_readable_source": "\n \n\n#include <linux/bitops.h>\n#include <linux/device.h>\n#include <linux/gpio/consumer.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/of_gpio.h>\n#include <linux/pm_runtime.h>\n#include <linux/printk.h>\n#include <linux/regmap.h>\n#include <linux/regulator/consumer.h>\n#include <linux/slab.h>\n#include <linux/soundwire/sdw.h>\n#include <linux/soundwire/sdw_registers.h>\n#include <linux/soundwire/sdw_type.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/soc-dapm.h>\n#include <sound/soc.h>\n#include <sound/tlv.h>\n\n#define WSA883X_BASE                    0x3000\n#define WSA883X_ANA_BG_TSADC_BASE       (WSA883X_BASE + 0x00000001)\n#define WSA883X_REF_CTRL                (WSA883X_ANA_BG_TSADC_BASE + 0x0000)\n#define WSA883X_TEST_CTL_0              (WSA883X_ANA_BG_TSADC_BASE + 0x0001)\n#define WSA883X_BIAS_0                  (WSA883X_ANA_BG_TSADC_BASE + 0x0002)\n#define WSA883X_OP_CTL                  (WSA883X_ANA_BG_TSADC_BASE + 0x0003)\n#define WSA883X_IREF_CTL                (WSA883X_ANA_BG_TSADC_BASE + 0x0004)\n#define WSA883X_ISENS_CTL               (WSA883X_ANA_BG_TSADC_BASE + 0x0005)\n#define WSA883X_CLK_CTL                 (WSA883X_ANA_BG_TSADC_BASE + 0x0006)\n#define WSA883X_TEST_CTL_1              (WSA883X_ANA_BG_TSADC_BASE + 0x0007)\n#define WSA883X_BIAS_1                  (WSA883X_ANA_BG_TSADC_BASE + 0x0008)\n#define WSA883X_ADC_CTL                 (WSA883X_ANA_BG_TSADC_BASE + 0x0009)\n#define WSA883X_DOUT_MSB                (WSA883X_ANA_BG_TSADC_BASE + 0x000A)\n#define WSA883X_DOUT_LSB                (WSA883X_ANA_BG_TSADC_BASE + 0x000B)\n#define WSA883X_VBAT_SNS                (WSA883X_ANA_BG_TSADC_BASE + 0x000C)\n#define WSA883X_ITRIM_CODE              (WSA883X_ANA_BG_TSADC_BASE + 0x000D)\n\n#define WSA883X_ANA_IVSENSE_BASE        (WSA883X_BASE + 0x0000000F)\n#define WSA883X_EN                      (WSA883X_ANA_IVSENSE_BASE + 0x0000)\n#define WSA883X_OVERRIDE1               (WSA883X_ANA_IVSENSE_BASE + 0x0001)\n#define WSA883X_OVERRIDE2               (WSA883X_ANA_IVSENSE_BASE + 0x0002)\n#define WSA883X_VSENSE1                 (WSA883X_ANA_IVSENSE_BASE + 0x0003)\n#define WSA883X_ISENSE1                 (WSA883X_ANA_IVSENSE_BASE + 0x0004)\n#define WSA883X_ISENSE2                 (WSA883X_ANA_IVSENSE_BASE + 0x0005)\n#define WSA883X_ISENSE_CAL              (WSA883X_ANA_IVSENSE_BASE + 0x0006)\n#define WSA883X_MISC                    (WSA883X_ANA_IVSENSE_BASE + 0x0007)\n#define WSA883X_ADC_0                   (WSA883X_ANA_IVSENSE_BASE + 0x0008)\n#define WSA883X_ADC_1                   (WSA883X_ANA_IVSENSE_BASE + 0x0009)\n#define WSA883X_ADC_2                   (WSA883X_ANA_IVSENSE_BASE + 0x000A)\n#define WSA883X_ADC_3                   (WSA883X_ANA_IVSENSE_BASE + 0x000B)\n#define WSA883X_ADC_4                   (WSA883X_ANA_IVSENSE_BASE + 0x000C)\n#define WSA883X_ADC_5                   (WSA883X_ANA_IVSENSE_BASE + 0x000D)\n#define WSA883X_ADC_6                   (WSA883X_ANA_IVSENSE_BASE + 0x000E)\n#define WSA883X_ADC_7                   (WSA883X_ANA_IVSENSE_BASE + 0x000F)\n#define WSA883X_STATUS                  (WSA883X_ANA_IVSENSE_BASE + 0x0010)\n\n#define WSA883X_ANA_SPK_TOP_BASE        (WSA883X_BASE + 0x00000025)\n#define WSA883X_DAC_CTRL_REG            (WSA883X_ANA_SPK_TOP_BASE + 0x0000)\n#define WSA883X_DAC_EN_DEBUG_REG        (WSA883X_ANA_SPK_TOP_BASE + 0x0001)\n#define WSA883X_DAC_OPAMP_BIAS1_REG     (WSA883X_ANA_SPK_TOP_BASE + 0x0002)\n#define WSA883X_DAC_OPAMP_BIAS2_REG     (WSA883X_ANA_SPK_TOP_BASE + 0x0003)\n#define WSA883X_DAC_VCM_CTRL_REG        (WSA883X_ANA_SPK_TOP_BASE + 0x0004)\n#define WSA883X_DAC_VOLTAGE_CTRL_REG    (WSA883X_ANA_SPK_TOP_BASE + 0x0005)\n#define WSA883X_ATEST1_REG              (WSA883X_ANA_SPK_TOP_BASE + 0x0006)\n#define WSA883X_ATEST2_REG              (WSA883X_ANA_SPK_TOP_BASE + 0x0007)\n#define WSA883X_SPKR_TOP_BIAS_REG1      (WSA883X_ANA_SPK_TOP_BASE + 0x0008)\n#define WSA883X_SPKR_TOP_BIAS_REG2      (WSA883X_ANA_SPK_TOP_BASE + 0x0009)\n#define WSA883X_SPKR_TOP_BIAS_REG3      (WSA883X_ANA_SPK_TOP_BASE + 0x000A)\n#define WSA883X_SPKR_TOP_BIAS_REG4      (WSA883X_ANA_SPK_TOP_BASE + 0x000B)\n#define WSA883X_SPKR_CLIP_DET_REG       (WSA883X_ANA_SPK_TOP_BASE + 0x000C)\n#define WSA883X_SPKR_DRV_LF_BLK_EN      (WSA883X_ANA_SPK_TOP_BASE + 0x000D)\n#define WSA883X_SPKR_DRV_LF_EN          (WSA883X_ANA_SPK_TOP_BASE + 0x000E)\n#define WSA883X_SPKR_DRV_LF_MASK_DCC_CTL (WSA883X_ANA_SPK_TOP_BASE + 0x000F)\n#define WSA883X_SPKR_DRV_LF_MISC_CTL    (WSA883X_ANA_SPK_TOP_BASE + 0x0010)\n#define WSA883X_SPKR_DRV_LF_REG_GAIN    (WSA883X_ANA_SPK_TOP_BASE + 0x0011)\n#define WSA883X_SPKR_DRV_OS_CAL_CTL     (WSA883X_ANA_SPK_TOP_BASE + 0x0012)\n#define WSA883X_SPKR_DRV_OS_CAL_CTL1     (WSA883X_ANA_SPK_TOP_BASE + 0x0013)\n#define WSA883X_SPKR_PWM_CLK_CTL        (WSA883X_ANA_SPK_TOP_BASE + 0x0014)\n#define WSA883X_SPKR_PWM_FREQ_SEL_MASK\tBIT(3)\n#define WSA883X_SPKR_PWM_FREQ_F300KHZ\t0\n#define WSA883X_SPKR_PWM_FREQ_F600KHZ\t1\n#define WSA883X_SPKR_PDRV_HS_CTL        (WSA883X_ANA_SPK_TOP_BASE + 0x0015)\n#define WSA883X_SPKR_PDRV_LS_CTL        (WSA883X_ANA_SPK_TOP_BASE + 0x0016)\n#define WSA883X_SPKR_PWRSTG_DBG         (WSA883X_ANA_SPK_TOP_BASE + 0x0017)\n#define WSA883X_SPKR_OCP_CTL            (WSA883X_ANA_SPK_TOP_BASE + 0x0018)\n#define WSA883X_SPKR_BBM_CTL            (WSA883X_ANA_SPK_TOP_BASE + 0x0019)\n#define WSA883X_PA_STATUS0              (WSA883X_ANA_SPK_TOP_BASE + 0x001A)\n#define WSA883X_PA_STATUS1              (WSA883X_ANA_SPK_TOP_BASE + 0x001B)\n#define WSA883X_PA_STATUS2              (WSA883X_ANA_SPK_TOP_BASE + 0x001C)\n\n#define WSA883X_ANA_BOOST_BASE          (WSA883X_BASE + 0x00000043)\n#define WSA883X_EN_CTRL                 (WSA883X_ANA_BOOST_BASE + 0x0000)\n#define WSA883X_CURRENT_LIMIT           (WSA883X_ANA_BOOST_BASE + 0x0001)\n#define WSA883X_IBIAS1                  (WSA883X_ANA_BOOST_BASE + 0x0002)\n#define WSA883X_IBIAS2                  (WSA883X_ANA_BOOST_BASE + 0x0003)\n#define WSA883X_IBIAS3                  (WSA883X_ANA_BOOST_BASE + 0x0004)\n#define WSA883X_LDO_PROG                (WSA883X_ANA_BOOST_BASE + 0x0005)\n#define WSA883X_STABILITY_CTRL1         (WSA883X_ANA_BOOST_BASE + 0x0006)\n#define WSA883X_STABILITY_CTRL2         (WSA883X_ANA_BOOST_BASE + 0x0007)\n#define WSA883X_PWRSTAGE_CTRL1          (WSA883X_ANA_BOOST_BASE + 0x0008)\n#define WSA883X_PWRSTAGE_CTRL2          (WSA883X_ANA_BOOST_BASE + 0x0009)\n#define WSA883X_BYPASS_1                (WSA883X_ANA_BOOST_BASE + 0x000A)\n#define WSA883X_BYPASS_2                (WSA883X_ANA_BOOST_BASE + 0x000B)\n#define WSA883X_ZX_CTRL_1               (WSA883X_ANA_BOOST_BASE + 0x000C)\n#define WSA883X_ZX_CTRL_2               (WSA883X_ANA_BOOST_BASE + 0x000D)\n#define WSA883X_MISC1                   (WSA883X_ANA_BOOST_BASE + 0x000E)\n#define WSA883X_MISC2                   (WSA883X_ANA_BOOST_BASE + 0x000F)\n#define WSA883X_GMAMP_SUP1              (WSA883X_ANA_BOOST_BASE + 0x0010)\n#define WSA883X_PWRSTAGE_CTRL3          (WSA883X_ANA_BOOST_BASE + 0x0011)\n#define WSA883X_PWRSTAGE_CTRL4          (WSA883X_ANA_BOOST_BASE + 0x0012)\n#define WSA883X_TEST1                   (WSA883X_ANA_BOOST_BASE + 0x0013)\n#define WSA883X_SPARE1                  (WSA883X_ANA_BOOST_BASE + 0x0014)\n#define WSA883X_SPARE2                  (WSA883X_ANA_BOOST_BASE + 0x0015)\n\n#define WSA883X_ANA_PON_LDOL_BASE       (WSA883X_BASE + 0x00000059)\n#define WSA883X_PON_CTL_0               (WSA883X_ANA_PON_LDOL_BASE + 0x0000)\n#define WSA883X_PON_CLT_1               (WSA883X_ANA_PON_LDOL_BASE + 0x0001)\n#define WSA883X_PON_CTL_2               (WSA883X_ANA_PON_LDOL_BASE + 0x0002)\n#define WSA883X_PON_CTL_3               (WSA883X_ANA_PON_LDOL_BASE + 0x0003)\n#define WSA883X_CKWD_CTL_0              (WSA883X_ANA_PON_LDOL_BASE + 0x0004)\n#define WSA883X_CKWD_CTL_1              (WSA883X_ANA_PON_LDOL_BASE + 0x0005)\n#define WSA883X_CKWD_CTL_2              (WSA883X_ANA_PON_LDOL_BASE + 0x0006)\n#define WSA883X_CKSK_CTL_0              (WSA883X_ANA_PON_LDOL_BASE + 0x0007)\n#define WSA883X_PADSW_CTL_0             (WSA883X_ANA_PON_LDOL_BASE + 0x0008)\n#define WSA883X_TEST_0                  (WSA883X_ANA_PON_LDOL_BASE + 0x0009)\n#define WSA883X_TEST_1                  (WSA883X_ANA_PON_LDOL_BASE + 0x000A)\n#define WSA883X_STATUS_0                (WSA883X_ANA_PON_LDOL_BASE + 0x000B)\n#define WSA883X_STATUS_1                (WSA883X_ANA_PON_LDOL_BASE + 0x000C)\n\n#define WSA883X_DIG_CTRL_BASE           (WSA883X_BASE + 0x00000400)\n#define WSA883X_CHIP_ID0                (WSA883X_DIG_CTRL_BASE + 0x0001)\n#define WSA883X_CHIP_ID1                (WSA883X_DIG_CTRL_BASE + 0x0002)\n#define WSA883X_CHIP_ID2                (WSA883X_DIG_CTRL_BASE + 0x0003)\n#define WSA883X_CHIP_ID3                (WSA883X_DIG_CTRL_BASE + 0x0004)\n#define WSA883X_BUS_ID                  (WSA883X_DIG_CTRL_BASE + 0x0005)\n#define WSA883X_CDC_RST_CTL             (WSA883X_DIG_CTRL_BASE + 0x0006)\n#define WSA883X_TOP_CLK_CFG             (WSA883X_DIG_CTRL_BASE + 0x0007)\n#define WSA883X_CDC_PATH_MODE           (WSA883X_DIG_CTRL_BASE + 0x0008)\n#define WSA883X_RXD_MODE_MASK\t\tBIT(1)\n#define WSA883X_RXD_MODE_NORMAL\t\t0\n#define WSA883X_RXD_MODE_HIFI\t\t1\n#define WSA883X_CDC_CLK_CTL             (WSA883X_DIG_CTRL_BASE + 0x0009)\n#define WSA883X_SWR_RESET_EN            (WSA883X_DIG_CTRL_BASE + 0x000A)\n#define WSA883X_RESET_CTL               (WSA883X_DIG_CTRL_BASE + 0x000B)\n#define WSA883X_PA_FSM_CTL              (WSA883X_DIG_CTRL_BASE + 0x0010)\n#define WSA883X_GLOBAL_PA_EN_MASK\tBIT(0)\n#define WSA883X_GLOBAL_PA_ENABLE\t1\n#define WSA883X_PA_FSM_TIMER0           (WSA883X_DIG_CTRL_BASE + 0x0011)\n#define WSA883X_PA_FSM_TIMER1           (WSA883X_DIG_CTRL_BASE + 0x0012)\n#define WSA883X_PA_FSM_STA              (WSA883X_DIG_CTRL_BASE + 0x0013)\n#define WSA883X_PA_FSM_ERR_COND         (WSA883X_DIG_CTRL_BASE + 0x0014)\n#define WSA883X_PA_FSM_MSK              (WSA883X_DIG_CTRL_BASE + 0x0015)\n#define WSA883X_PA_FSM_BYP              (WSA883X_DIG_CTRL_BASE + 0x0016)\n#define WSA883X_PA_FSM_DBG              (WSA883X_DIG_CTRL_BASE + 0x0017)\n#define WSA883X_TADC_VALUE_CTL          (WSA883X_DIG_CTRL_BASE + 0x0020)\n#define WSA883X_TEMP_DETECT_CTL         (WSA883X_DIG_CTRL_BASE + 0x0021)\n#define WSA883X_TEMP_MSB                (WSA883X_DIG_CTRL_BASE + 0x0022)\n#define WSA883X_TEMP_LSB                (WSA883X_DIG_CTRL_BASE + 0x0023)\n#define WSA883X_TEMP_CONFIG0            (WSA883X_DIG_CTRL_BASE + 0x0024)\n#define WSA883X_TEMP_CONFIG1            (WSA883X_DIG_CTRL_BASE + 0x0025)\n#define WSA883X_VBAT_ADC_FLT_CTL        (WSA883X_DIG_CTRL_BASE + 0x0026)\n#define WSA883X_VBAT_ADC_FLT_EN_MASK\tBIT(0)\n#define WSA883X_VBAT_ADC_COEF_SEL_MASK\tGENMASK(3, 1)\n#define WSA883X_VBAT_ADC_COEF_F_1DIV2\t0x0\n#define WSA883X_VBAT_ADC_COEF_F_1DIV16\t0x3\n#define WSA883X_VBAT_DIN_MSB            (WSA883X_DIG_CTRL_BASE + 0x0027)\n#define WSA883X_VBAT_DIN_LSB            (WSA883X_DIG_CTRL_BASE + 0x0028)\n#define WSA883X_VBAT_DOUT               (WSA883X_DIG_CTRL_BASE + 0x0029)\n#define WSA883X_SDM_PDM9_LSB            (WSA883X_DIG_CTRL_BASE + 0x002A)\n#define WSA883X_SDM_PDM9_MSB            (WSA883X_DIG_CTRL_BASE + 0x002B)\n#define WSA883X_CDC_RX_CTL              (WSA883X_DIG_CTRL_BASE + 0x0030)\n#define WSA883X_CDC_SPK_DSM_A1_0        (WSA883X_DIG_CTRL_BASE + 0x0031)\n#define WSA883X_CDC_SPK_DSM_A1_1        (WSA883X_DIG_CTRL_BASE + 0x0032)\n#define WSA883X_CDC_SPK_DSM_A2_0        (WSA883X_DIG_CTRL_BASE + 0x0033)\n#define WSA883X_CDC_SPK_DSM_A2_1        (WSA883X_DIG_CTRL_BASE + 0x0034)\n#define WSA883X_CDC_SPK_DSM_A3_0        (WSA883X_DIG_CTRL_BASE + 0x0035)\n#define WSA883X_CDC_SPK_DSM_A3_1        (WSA883X_DIG_CTRL_BASE + 0x0036)\n#define WSA883X_CDC_SPK_DSM_A4_0        (WSA883X_DIG_CTRL_BASE + 0x0037)\n#define WSA883X_CDC_SPK_DSM_A4_1        (WSA883X_DIG_CTRL_BASE + 0x0038)\n#define WSA883X_CDC_SPK_DSM_A5_0        (WSA883X_DIG_CTRL_BASE + 0x0039)\n#define WSA883X_CDC_SPK_DSM_A5_1        (WSA883X_DIG_CTRL_BASE + 0x003A)\n#define WSA883X_CDC_SPK_DSM_A6_0        (WSA883X_DIG_CTRL_BASE + 0x003B)\n#define WSA883X_CDC_SPK_DSM_A7_0        (WSA883X_DIG_CTRL_BASE + 0x003C)\n#define WSA883X_CDC_SPK_DSM_C_0         (WSA883X_DIG_CTRL_BASE + 0x003D)\n#define WSA883X_CDC_SPK_DSM_C_1         (WSA883X_DIG_CTRL_BASE + 0x003E)\n#define WSA883X_CDC_SPK_DSM_C_2         (WSA883X_DIG_CTRL_BASE + 0x003F)\n#define WSA883X_CDC_SPK_DSM_C_3         (WSA883X_DIG_CTRL_BASE + 0x0040)\n#define WSA883X_CDC_SPK_DSM_R1          (WSA883X_DIG_CTRL_BASE + 0x0041)\n#define WSA883X_CDC_SPK_DSM_R2          (WSA883X_DIG_CTRL_BASE + 0x0042)\n#define WSA883X_CDC_SPK_DSM_R3          (WSA883X_DIG_CTRL_BASE + 0x0043)\n#define WSA883X_CDC_SPK_DSM_R4          (WSA883X_DIG_CTRL_BASE + 0x0044)\n#define WSA883X_CDC_SPK_DSM_R5          (WSA883X_DIG_CTRL_BASE + 0x0045)\n#define WSA883X_CDC_SPK_DSM_R6          (WSA883X_DIG_CTRL_BASE + 0x0046)\n#define WSA883X_CDC_SPK_DSM_R7          (WSA883X_DIG_CTRL_BASE + 0x0047)\n#define WSA883X_CDC_SPK_GAIN_PDM_0      (WSA883X_DIG_CTRL_BASE + 0x0048)\n#define WSA883X_CDC_SPK_GAIN_PDM_1      (WSA883X_DIG_CTRL_BASE + 0x0049)\n#define WSA883X_CDC_SPK_GAIN_PDM_2      (WSA883X_DIG_CTRL_BASE + 0x004A)\n#define WSA883X_PDM_WD_CTL              (WSA883X_DIG_CTRL_BASE + 0x004B)\n#define WSA883X_PDM_EN_MASK\t\tBIT(0)\n#define WSA883X_PDM_ENABLE\t\tBIT(0)\n#define WSA883X_DEM_BYPASS_DATA0        (WSA883X_DIG_CTRL_BASE + 0x004C)\n#define WSA883X_DEM_BYPASS_DATA1        (WSA883X_DIG_CTRL_BASE + 0x004D)\n#define WSA883X_DEM_BYPASS_DATA2        (WSA883X_DIG_CTRL_BASE + 0x004E)\n#define WSA883X_DEM_BYPASS_DATA3        (WSA883X_DIG_CTRL_BASE + 0x004F)\n#define WSA883X_WAVG_CTL                (WSA883X_DIG_CTRL_BASE + 0x0050)\n#define WSA883X_WAVG_LRA_PER_0          (WSA883X_DIG_CTRL_BASE + 0x0051)\n#define WSA883X_WAVG_LRA_PER_1          (WSA883X_DIG_CTRL_BASE + 0x0052)\n#define WSA883X_WAVG_DELTA_THETA_0      (WSA883X_DIG_CTRL_BASE + 0x0053)\n#define WSA883X_WAVG_DELTA_THETA_1      (WSA883X_DIG_CTRL_BASE + 0x0054)\n#define WSA883X_WAVG_DIRECT_AMP_0       (WSA883X_DIG_CTRL_BASE + 0x0055)\n#define WSA883X_WAVG_DIRECT_AMP_1       (WSA883X_DIG_CTRL_BASE + 0x0056)\n#define WSA883X_WAVG_PTRN_AMP0_0        (WSA883X_DIG_CTRL_BASE + 0x0057)\n#define WSA883X_WAVG_PTRN_AMP0_1        (WSA883X_DIG_CTRL_BASE + 0x0058)\n#define WSA883X_WAVG_PTRN_AMP1_0        (WSA883X_DIG_CTRL_BASE + 0x0059)\n#define WSA883X_WAVG_PTRN_AMP1_1        (WSA883X_DIG_CTRL_BASE + 0x005A)\n#define WSA883X_WAVG_PTRN_AMP2_0        (WSA883X_DIG_CTRL_BASE + 0x005B)\n#define WSA883X_WAVG_PTRN_AMP2_1        (WSA883X_DIG_CTRL_BASE + 0x005C)\n#define WSA883X_WAVG_PTRN_AMP3_0        (WSA883X_DIG_CTRL_BASE + 0x005D)\n#define WSA883X_WAVG_PTRN_AMP3_1        (WSA883X_DIG_CTRL_BASE + 0x005E)\n#define WSA883X_WAVG_PTRN_AMP4_0        (WSA883X_DIG_CTRL_BASE + 0x005F)\n#define WSA883X_WAVG_PTRN_AMP4_1        (WSA883X_DIG_CTRL_BASE + 0x0060)\n#define WSA883X_WAVG_PTRN_AMP5_0        (WSA883X_DIG_CTRL_BASE + 0x0061)\n#define WSA883X_WAVG_PTRN_AMP5_1        (WSA883X_DIG_CTRL_BASE + 0x0062)\n#define WSA883X_WAVG_PTRN_AMP6_0        (WSA883X_DIG_CTRL_BASE + 0x0063)\n#define WSA883X_WAVG_PTRN_AMP6_1        (WSA883X_DIG_CTRL_BASE + 0x0064)\n#define WSA883X_WAVG_PTRN_AMP7_0        (WSA883X_DIG_CTRL_BASE + 0x0065)\n#define WSA883X_WAVG_PTRN_AMP7_1        (WSA883X_DIG_CTRL_BASE + 0x0066)\n#define WSA883X_WAVG_PER_0_1            (WSA883X_DIG_CTRL_BASE + 0x0067)\n#define WSA883X_WAVG_PER_2_3            (WSA883X_DIG_CTRL_BASE + 0x0068)\n#define WSA883X_WAVG_PER_4_5            (WSA883X_DIG_CTRL_BASE + 0x0069)\n#define WSA883X_WAVG_PER_6_7            (WSA883X_DIG_CTRL_BASE + 0x006A)\n#define WSA883X_WAVG_STA                (WSA883X_DIG_CTRL_BASE + 0x006B)\n#define WSA883X_DRE_CTL_0               (WSA883X_DIG_CTRL_BASE + 0x006C)\n#define WSA883X_DRE_OFFSET_MASK\t\tGENMASK(2, 0)\n#define WSA883X_DRE_PROG_DELAY_MASK\tGENMASK(7, 4)\n#define WSA883X_DRE_CTL_1               (WSA883X_DIG_CTRL_BASE + 0x006D)\n#define WSA883X_DRE_GAIN_EN_MASK\tBIT(0)\n#define WSA883X_DRE_GAIN_FROM_CSR\t1\n#define WSA883X_DRE_IDLE_DET_CTL        (WSA883X_DIG_CTRL_BASE + 0x006E)\n#define WSA883X_CLSH_CTL_0              (WSA883X_DIG_CTRL_BASE + 0x0070)\n#define WSA883X_CLSH_CTL_1              (WSA883X_DIG_CTRL_BASE + 0x0071)\n#define WSA883X_CLSH_V_HD_PA            (WSA883X_DIG_CTRL_BASE + 0x0072)\n#define WSA883X_CLSH_V_PA_MIN           (WSA883X_DIG_CTRL_BASE + 0x0073)\n#define WSA883X_CLSH_OVRD_VAL           (WSA883X_DIG_CTRL_BASE + 0x0074)\n#define WSA883X_CLSH_HARD_MAX           (WSA883X_DIG_CTRL_BASE + 0x0075)\n#define WSA883X_CLSH_SOFT_MAX           (WSA883X_DIG_CTRL_BASE + 0x0076)\n#define WSA883X_CLSH_SIG_DP             (WSA883X_DIG_CTRL_BASE + 0x0077)\n#define WSA883X_TAGC_CTL                (WSA883X_DIG_CTRL_BASE + 0x0078)\n#define WSA883X_TAGC_TIME               (WSA883X_DIG_CTRL_BASE + 0x0079)\n#define WSA883X_TAGC_E2E_GAIN           (WSA883X_DIG_CTRL_BASE + 0x007A)\n#define WSA883X_TAGC_FORCE_VAL          (WSA883X_DIG_CTRL_BASE + 0x007B)\n#define WSA883X_VAGC_CTL                (WSA883X_DIG_CTRL_BASE + 0x007C)\n#define WSA883X_VAGC_TIME               (WSA883X_DIG_CTRL_BASE + 0x007D)\n#define WSA883X_VAGC_ATTN_LVL_1_2       (WSA883X_DIG_CTRL_BASE + 0x007E)\n#define WSA883X_VAGC_ATTN_LVL_3         (WSA883X_DIG_CTRL_BASE + 0x007F)\n#define WSA883X_INTR_MODE               (WSA883X_DIG_CTRL_BASE + 0x0080)\n#define WSA883X_INTR_MASK0              (WSA883X_DIG_CTRL_BASE + 0x0081)\n#define WSA883X_INTR_MASK1              (WSA883X_DIG_CTRL_BASE + 0x0082)\n#define WSA883X_INTR_STATUS0            (WSA883X_DIG_CTRL_BASE + 0x0083)\n#define WSA883X_INTR_STATUS1            (WSA883X_DIG_CTRL_BASE + 0x0084)\n#define WSA883X_INTR_CLEAR0             (WSA883X_DIG_CTRL_BASE + 0x0085)\n#define WSA883X_INTR_CLEAR1             (WSA883X_DIG_CTRL_BASE + 0x0086)\n#define WSA883X_INTR_LEVEL0             (WSA883X_DIG_CTRL_BASE + 0x0087)\n#define WSA883X_INTR_LEVEL1             (WSA883X_DIG_CTRL_BASE + 0x0088)\n#define WSA883X_INTR_SET0               (WSA883X_DIG_CTRL_BASE + 0x0089)\n#define WSA883X_INTR_SET1               (WSA883X_DIG_CTRL_BASE + 0x008A)\n#define WSA883X_INTR_TEST0              (WSA883X_DIG_CTRL_BASE + 0x008B)\n#define WSA883X_INTR_TEST1              (WSA883X_DIG_CTRL_BASE + 0x008C)\n#define WSA883X_OTP_CTRL0               (WSA883X_DIG_CTRL_BASE + 0x0090)\n#define WSA883X_OTP_CTRL1               (WSA883X_DIG_CTRL_BASE + 0x0091)\n#define WSA883X_HDRIVE_CTL_GROUP1       (WSA883X_DIG_CTRL_BASE + 0x0092)\n#define WSA883X_PIN_CTL                 (WSA883X_DIG_CTRL_BASE + 0x0093)\n#define WSA883X_PIN_CTL_OE              (WSA883X_DIG_CTRL_BASE + 0x0094)\n#define WSA883X_PIN_WDATA_IOPAD         (WSA883X_DIG_CTRL_BASE + 0x0095)\n#define WSA883X_PIN_STATUS              (WSA883X_DIG_CTRL_BASE + 0x0096)\n#define WSA883X_I2C_SLAVE_CTL           (WSA883X_DIG_CTRL_BASE + 0x0097)\n#define WSA883X_PDM_TEST_MODE           (WSA883X_DIG_CTRL_BASE + 0x00A0)\n#define WSA883X_ATE_TEST_MODE           (WSA883X_DIG_CTRL_BASE + 0x00A1)\n#define WSA883X_DIG_DEBUG_MODE          (WSA883X_DIG_CTRL_BASE + 0x00A3)\n#define WSA883X_DIG_DEBUG_SEL           (WSA883X_DIG_CTRL_BASE + 0x00A4)\n#define WSA883X_DIG_DEBUG_EN            (WSA883X_DIG_CTRL_BASE + 0x00A5)\n#define WSA883X_SWR_HM_TEST0            (WSA883X_DIG_CTRL_BASE + 0x00A6)\n#define WSA883X_SWR_HM_TEST1            (WSA883X_DIG_CTRL_BASE + 0x00A7)\n#define WSA883X_SWR_PAD_CTL             (WSA883X_DIG_CTRL_BASE + 0x00A8)\n#define WSA883X_TADC_DETECT_DBG_CTL     (WSA883X_DIG_CTRL_BASE + 0x00A9)\n#define WSA883X_TADC_DEBUG_MSB          (WSA883X_DIG_CTRL_BASE + 0x00AA)\n#define WSA883X_TADC_DEBUG_LSB          (WSA883X_DIG_CTRL_BASE + 0x00AB)\n#define WSA883X_SAMPLE_EDGE_SEL         (WSA883X_DIG_CTRL_BASE + 0x00AC)\n#define WSA883X_SWR_EDGE_SEL            (WSA883X_DIG_CTRL_BASE + 0x00AD)\n#define WSA883X_TEST_MODE_CTL           (WSA883X_DIG_CTRL_BASE + 0x00AE)\n#define WSA883X_IOPAD_CTL               (WSA883X_DIG_CTRL_BASE + 0x00AF)\n#define WSA883X_ANA_CSR_DBG_ADD         (WSA883X_DIG_CTRL_BASE + 0x00B0)\n#define WSA883X_ANA_CSR_DBG_CTL         (WSA883X_DIG_CTRL_BASE + 0x00B1)\n#define WSA883X_SPARE_R                 (WSA883X_DIG_CTRL_BASE + 0x00BC)\n#define WSA883X_SPARE_0                 (WSA883X_DIG_CTRL_BASE + 0x00BD)\n#define WSA883X_SPARE_1                 (WSA883X_DIG_CTRL_BASE + 0x00BE)\n#define WSA883X_SPARE_2                 (WSA883X_DIG_CTRL_BASE + 0x00BF)\n#define WSA883X_SCODE                   (WSA883X_DIG_CTRL_BASE + 0x00C0)\n\n#define WSA883X_DIG_TRIM_BASE           (WSA883X_BASE + 0x00000500)\n#define WSA883X_OTP_REG_0               (WSA883X_DIG_TRIM_BASE + 0x0080)\n#define WSA883X_ID_MASK\t\t\tGENMASK(3, 0)\n#define WSA883X_OTP_REG_1               (WSA883X_DIG_TRIM_BASE + 0x0081)\n#define WSA883X_OTP_REG_2               (WSA883X_DIG_TRIM_BASE + 0x0082)\n#define WSA883X_OTP_REG_3               (WSA883X_DIG_TRIM_BASE + 0x0083)\n#define WSA883X_OTP_REG_4               (WSA883X_DIG_TRIM_BASE + 0x0084)\n#define WSA883X_OTP_REG_5               (WSA883X_DIG_TRIM_BASE + 0x0085)\n#define WSA883X_OTP_REG_6               (WSA883X_DIG_TRIM_BASE + 0x0086)\n#define WSA883X_OTP_REG_7               (WSA883X_DIG_TRIM_BASE + 0x0087)\n#define WSA883X_OTP_REG_8               (WSA883X_DIG_TRIM_BASE + 0x0088)\n#define WSA883X_OTP_REG_9               (WSA883X_DIG_TRIM_BASE + 0x0089)\n#define WSA883X_OTP_REG_10              (WSA883X_DIG_TRIM_BASE + 0x008A)\n#define WSA883X_OTP_REG_11              (WSA883X_DIG_TRIM_BASE + 0x008B)\n#define WSA883X_OTP_REG_12              (WSA883X_DIG_TRIM_BASE + 0x008C)\n#define WSA883X_OTP_REG_13              (WSA883X_DIG_TRIM_BASE + 0x008D)\n#define WSA883X_OTP_REG_14              (WSA883X_DIG_TRIM_BASE + 0x008E)\n#define WSA883X_OTP_REG_15              (WSA883X_DIG_TRIM_BASE + 0x008F)\n#define WSA883X_OTP_REG_16              (WSA883X_DIG_TRIM_BASE + 0x0090)\n#define WSA883X_OTP_REG_17              (WSA883X_DIG_TRIM_BASE + 0x0091)\n#define WSA883X_OTP_REG_18              (WSA883X_DIG_TRIM_BASE + 0x0092)\n#define WSA883X_OTP_REG_19              (WSA883X_DIG_TRIM_BASE + 0x0093)\n#define WSA883X_OTP_REG_20              (WSA883X_DIG_TRIM_BASE + 0x0094)\n#define WSA883X_OTP_REG_21              (WSA883X_DIG_TRIM_BASE + 0x0095)\n#define WSA883X_OTP_REG_22              (WSA883X_DIG_TRIM_BASE + 0x0096)\n#define WSA883X_OTP_REG_23              (WSA883X_DIG_TRIM_BASE + 0x0097)\n#define WSA883X_OTP_REG_24              (WSA883X_DIG_TRIM_BASE + 0x0098)\n#define WSA883X_OTP_REG_25              (WSA883X_DIG_TRIM_BASE + 0x0099)\n#define WSA883X_OTP_REG_26              (WSA883X_DIG_TRIM_BASE + 0x009A)\n#define WSA883X_OTP_REG_27              (WSA883X_DIG_TRIM_BASE + 0x009B)\n#define WSA883X_OTP_REG_28              (WSA883X_DIG_TRIM_BASE + 0x009C)\n#define WSA883X_OTP_REG_29              (WSA883X_DIG_TRIM_BASE + 0x009D)\n#define WSA883X_OTP_REG_30              (WSA883X_DIG_TRIM_BASE + 0x009E)\n#define WSA883X_OTP_REG_31              (WSA883X_DIG_TRIM_BASE + 0x009F)\n#define WSA883X_OTP_REG_32              (WSA883X_DIG_TRIM_BASE + 0x00A0)\n#define WSA883X_OTP_REG_33              (WSA883X_DIG_TRIM_BASE + 0x00A1)\n#define WSA883X_OTP_REG_34              (WSA883X_DIG_TRIM_BASE + 0x00A2)\n#define WSA883X_OTP_REG_35              (WSA883X_DIG_TRIM_BASE + 0x00A3)\n#define WSA883X_OTP_REG_63              (WSA883X_DIG_TRIM_BASE + 0x00BF)\n\n#define WSA883X_DIG_EMEM_BASE           (WSA883X_BASE + 0x000005C0)\n#define WSA883X_EMEM_0                  (WSA883X_DIG_EMEM_BASE + 0x0000)\n#define WSA883X_EMEM_1                  (WSA883X_DIG_EMEM_BASE + 0x0001)\n#define WSA883X_EMEM_2                  (WSA883X_DIG_EMEM_BASE + 0x0002)\n#define WSA883X_EMEM_3                  (WSA883X_DIG_EMEM_BASE + 0x0003)\n#define WSA883X_EMEM_4                  (WSA883X_DIG_EMEM_BASE + 0x0004)\n#define WSA883X_EMEM_5                  (WSA883X_DIG_EMEM_BASE + 0x0005)\n#define WSA883X_EMEM_6                  (WSA883X_DIG_EMEM_BASE + 0x0006)\n#define WSA883X_EMEM_7                  (WSA883X_DIG_EMEM_BASE + 0x0007)\n#define WSA883X_EMEM_8                  (WSA883X_DIG_EMEM_BASE + 0x0008)\n#define WSA883X_EMEM_9                  (WSA883X_DIG_EMEM_BASE + 0x0009)\n#define WSA883X_EMEM_10                 (WSA883X_DIG_EMEM_BASE + 0x000A)\n#define WSA883X_EMEM_11                 (WSA883X_DIG_EMEM_BASE + 0x000B)\n#define WSA883X_EMEM_12                 (WSA883X_DIG_EMEM_BASE + 0x000C)\n#define WSA883X_EMEM_13                 (WSA883X_DIG_EMEM_BASE + 0x000D)\n#define WSA883X_EMEM_14                 (WSA883X_DIG_EMEM_BASE + 0x000E)\n#define WSA883X_EMEM_15                 (WSA883X_DIG_EMEM_BASE + 0x000F)\n#define WSA883X_EMEM_16                 (WSA883X_DIG_EMEM_BASE + 0x0010)\n#define WSA883X_EMEM_17                 (WSA883X_DIG_EMEM_BASE + 0x0011)\n#define WSA883X_EMEM_18                 (WSA883X_DIG_EMEM_BASE + 0x0012)\n#define WSA883X_EMEM_19                 (WSA883X_DIG_EMEM_BASE + 0x0013)\n#define WSA883X_EMEM_20                 (WSA883X_DIG_EMEM_BASE + 0x0014)\n#define WSA883X_EMEM_21                 (WSA883X_DIG_EMEM_BASE + 0x0015)\n#define WSA883X_EMEM_22                 (WSA883X_DIG_EMEM_BASE + 0x0016)\n#define WSA883X_EMEM_23                 (WSA883X_DIG_EMEM_BASE + 0x0017)\n#define WSA883X_EMEM_24                 (WSA883X_DIG_EMEM_BASE + 0x0018)\n#define WSA883X_EMEM_25                 (WSA883X_DIG_EMEM_BASE + 0x0019)\n#define WSA883X_EMEM_26                 (WSA883X_DIG_EMEM_BASE + 0x001A)\n#define WSA883X_EMEM_27                 (WSA883X_DIG_EMEM_BASE + 0x001B)\n#define WSA883X_EMEM_28                 (WSA883X_DIG_EMEM_BASE + 0x001C)\n#define WSA883X_EMEM_29                 (WSA883X_DIG_EMEM_BASE + 0x001D)\n#define WSA883X_EMEM_30                 (WSA883X_DIG_EMEM_BASE + 0x001E)\n#define WSA883X_EMEM_31                 (WSA883X_DIG_EMEM_BASE + 0x001F)\n#define WSA883X_EMEM_32                 (WSA883X_DIG_EMEM_BASE + 0x0020)\n#define WSA883X_EMEM_33                 (WSA883X_DIG_EMEM_BASE + 0x0021)\n#define WSA883X_EMEM_34                 (WSA883X_DIG_EMEM_BASE + 0x0022)\n#define WSA883X_EMEM_35                 (WSA883X_DIG_EMEM_BASE + 0x0023)\n#define WSA883X_EMEM_36                 (WSA883X_DIG_EMEM_BASE + 0x0024)\n#define WSA883X_EMEM_37                 (WSA883X_DIG_EMEM_BASE + 0x0025)\n#define WSA883X_EMEM_38                 (WSA883X_DIG_EMEM_BASE + 0x0026)\n#define WSA883X_EMEM_39                 (WSA883X_DIG_EMEM_BASE + 0x0027)\n#define WSA883X_EMEM_40                 (WSA883X_DIG_EMEM_BASE + 0x0028)\n#define WSA883X_EMEM_41                 (WSA883X_DIG_EMEM_BASE + 0x0029)\n#define WSA883X_EMEM_42                 (WSA883X_DIG_EMEM_BASE + 0x002A)\n#define WSA883X_EMEM_43                 (WSA883X_DIG_EMEM_BASE + 0x002B)\n#define WSA883X_EMEM_44                 (WSA883X_DIG_EMEM_BASE + 0x002C)\n#define WSA883X_EMEM_45                 (WSA883X_DIG_EMEM_BASE + 0x002D)\n#define WSA883X_EMEM_46                 (WSA883X_DIG_EMEM_BASE + 0x002E)\n#define WSA883X_EMEM_47                 (WSA883X_DIG_EMEM_BASE + 0x002F)\n#define WSA883X_EMEM_48                 (WSA883X_DIG_EMEM_BASE + 0x0030)\n#define WSA883X_EMEM_49                 (WSA883X_DIG_EMEM_BASE + 0x0031)\n#define WSA883X_EMEM_50                 (WSA883X_DIG_EMEM_BASE + 0x0032)\n#define WSA883X_EMEM_51                 (WSA883X_DIG_EMEM_BASE + 0x0033)\n#define WSA883X_EMEM_52                 (WSA883X_DIG_EMEM_BASE + 0x0034)\n#define WSA883X_EMEM_53                 (WSA883X_DIG_EMEM_BASE + 0x0035)\n#define WSA883X_EMEM_54                 (WSA883X_DIG_EMEM_BASE + 0x0036)\n#define WSA883X_EMEM_55                 (WSA883X_DIG_EMEM_BASE + 0x0037)\n#define WSA883X_EMEM_56                 (WSA883X_DIG_EMEM_BASE + 0x0038)\n#define WSA883X_EMEM_57                 (WSA883X_DIG_EMEM_BASE + 0x0039)\n#define WSA883X_EMEM_58                 (WSA883X_DIG_EMEM_BASE + 0x003A)\n#define WSA883X_EMEM_59                 (WSA883X_DIG_EMEM_BASE + 0x003B)\n#define WSA883X_EMEM_60                 (WSA883X_DIG_EMEM_BASE + 0x003C)\n#define WSA883X_EMEM_61                 (WSA883X_DIG_EMEM_BASE + 0x003D)\n#define WSA883X_EMEM_62                 (WSA883X_DIG_EMEM_BASE + 0x003E)\n#define WSA883X_EMEM_63                 (WSA883X_DIG_EMEM_BASE + 0x003F)\n\n#define WSA883X_NUM_REGISTERS           (WSA883X_EMEM_63 + 1)\n#define WSA883X_MAX_REGISTER            (WSA883X_NUM_REGISTERS - 1)\n\n#define WSA883X_VERSION_1_0 0\n#define WSA883X_VERSION_1_1 1\n\n#define WSA883X_MAX_SWR_PORTS   4\n#define WSA883X_RATES (SNDRV_PCM_RATE_8000 | SNDRV_PCM_RATE_16000 |\\\n\t\t\tSNDRV_PCM_RATE_32000 | SNDRV_PCM_RATE_48000 |\\\n\t\t\tSNDRV_PCM_RATE_96000 | SNDRV_PCM_RATE_192000 |\\\n\t\t\tSNDRV_PCM_RATE_384000)\n \n#define WSA883X_FRAC_RATES (SNDRV_PCM_RATE_44100 | SNDRV_PCM_RATE_88200 |\\\n\t\t\t\tSNDRV_PCM_RATE_176400 | SNDRV_PCM_RATE_352800)\n\n#define WSA883X_FORMATS (SNDRV_PCM_FMTBIT_S16_LE |\\\n\t\tSNDRV_PCM_FMTBIT_S24_LE |\\\n\t\tSNDRV_PCM_FMTBIT_S24_3LE | SNDRV_PCM_FMTBIT_S32_LE)\n\nstruct wsa883x_priv {\n\tstruct regmap *regmap;\n\tstruct device *dev;\n\tstruct regulator *vdd;\n\tstruct sdw_slave *slave;\n\tstruct sdw_stream_config sconfig;\n\tstruct sdw_stream_runtime *sruntime;\n\tstruct sdw_port_config port_config[WSA883X_MAX_SWR_PORTS];\n\tstruct gpio_desc *sd_n;\n\tbool port_prepared[WSA883X_MAX_SWR_PORTS];\n\tbool port_enable[WSA883X_MAX_SWR_PORTS];\n\tint version;\n\tint variant;\n\tint active_ports;\n\tint dev_mode;\n\tint comp_offset;\n};\n\nenum {\n\tWSA8830 = 0,\n\tWSA8835,\n\tWSA8832,\n\tWSA8835_V2 = 5,\n};\n\nenum {\n\tCOMP_OFFSET0,\n\tCOMP_OFFSET1,\n\tCOMP_OFFSET2,\n\tCOMP_OFFSET3,\n\tCOMP_OFFSET4,\n};\n\nenum wsa_port_ids {\n\tWSA883X_PORT_DAC,\n\tWSA883X_PORT_COMP,\n\tWSA883X_PORT_BOOST,\n\tWSA883X_PORT_VISENSE,\n};\n\nstatic const char * const wsa_dev_mode_text[] = {\n\t\"Speaker\", \"Receiver\", \"Ultrasound\"\n};\n\nenum {\n\tSPEAKER,\n\tRECEIVER,\n\tULTRASOUND,\n};\n\nstatic const struct soc_enum wsa_dev_mode_enum =\n\tSOC_ENUM_SINGLE_EXT(ARRAY_SIZE(wsa_dev_mode_text), wsa_dev_mode_text);\n\n \nstatic struct sdw_dpn_prop wsa_sink_dpn_prop[WSA883X_MAX_SWR_PORTS] = {\n\t{\n\t\t \n\t\t.num = 1,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t \n\t\t.num = 2,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t \n\t\t.num = 3,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}, {\n\t\t \n\t\t.num = 4,\n\t\t.type = SDW_DPN_SIMPLE,\n\t\t.min_ch = 1,\n\t\t.max_ch = 1,\n\t\t.simple_ch_prep_sm = true,\n\t\t.read_only_wordlength = true,\n\t}\n};\n\nstatic const struct sdw_port_config wsa883x_pconfig[WSA883X_MAX_SWR_PORTS] = {\n\t{\n\t\t.num = 1,\n\t\t.ch_mask = 0x1,\n\t}, {\n\t\t.num = 2,\n\t\t.ch_mask = 0xf,\n\t}, {\n\t\t.num = 3,\n\t\t.ch_mask = 0x3,\n\t}, {\t \n\t\t.num = 4,\n\t\t.ch_mask = 0x3,\n\t},\n};\n\nstatic struct reg_default wsa883x_defaults[] = {\n\t{ WSA883X_REF_CTRL, 0xD5 },\n\t{ WSA883X_TEST_CTL_0, 0x06 },\n\t{ WSA883X_BIAS_0, 0xD2 },\n\t{ WSA883X_OP_CTL, 0xE0 },\n\t{ WSA883X_IREF_CTL, 0x57 },\n\t{ WSA883X_ISENS_CTL, 0x47 },\n\t{ WSA883X_CLK_CTL, 0x87 },\n\t{ WSA883X_TEST_CTL_1, 0x00 },\n\t{ WSA883X_BIAS_1, 0x51 },\n\t{ WSA883X_ADC_CTL, 0x01 },\n\t{ WSA883X_DOUT_MSB, 0x00 },\n\t{ WSA883X_DOUT_LSB, 0x00 },\n\t{ WSA883X_VBAT_SNS, 0x40 },\n\t{ WSA883X_ITRIM_CODE, 0x9F },\n\t{ WSA883X_EN, 0x20 },\n\t{ WSA883X_OVERRIDE1, 0x00 },\n\t{ WSA883X_OVERRIDE2, 0x08 },\n\t{ WSA883X_VSENSE1, 0xD3 },\n\t{ WSA883X_ISENSE1, 0xD4 },\n\t{ WSA883X_ISENSE2, 0x20 },\n\t{ WSA883X_ISENSE_CAL, 0x00 },\n\t{ WSA883X_MISC, 0x08 },\n\t{ WSA883X_ADC_0, 0x00 },\n\t{ WSA883X_ADC_1, 0x00 },\n\t{ WSA883X_ADC_2, 0x40 },\n\t{ WSA883X_ADC_3, 0x80 },\n\t{ WSA883X_ADC_4, 0x25 },\n\t{ WSA883X_ADC_5, 0x25 },\n\t{ WSA883X_ADC_6, 0x08 },\n\t{ WSA883X_ADC_7, 0x81 },\n\t{ WSA883X_STATUS, 0x00 },\n\t{ WSA883X_DAC_CTRL_REG, 0x53 },\n\t{ WSA883X_DAC_EN_DEBUG_REG, 0x00 },\n\t{ WSA883X_DAC_OPAMP_BIAS1_REG, 0x48 },\n\t{ WSA883X_DAC_OPAMP_BIAS2_REG, 0x48 },\n\t{ WSA883X_DAC_VCM_CTRL_REG, 0x88 },\n\t{ WSA883X_DAC_VOLTAGE_CTRL_REG, 0xA5 },\n\t{ WSA883X_ATEST1_REG, 0x00 },\n\t{ WSA883X_ATEST2_REG, 0x00 },\n\t{ WSA883X_SPKR_TOP_BIAS_REG1, 0x6A },\n\t{ WSA883X_SPKR_TOP_BIAS_REG2, 0x65 },\n\t{ WSA883X_SPKR_TOP_BIAS_REG3, 0x55 },\n\t{ WSA883X_SPKR_TOP_BIAS_REG4, 0xA9 },\n\t{ WSA883X_SPKR_CLIP_DET_REG, 0x9C },\n\t{ WSA883X_SPKR_DRV_LF_BLK_EN, 0x0F },\n\t{ WSA883X_SPKR_DRV_LF_EN, 0x0A },\n\t{ WSA883X_SPKR_DRV_LF_MASK_DCC_CTL, 0x00 },\n\t{ WSA883X_SPKR_DRV_LF_MISC_CTL, 0x3A },\n\t{ WSA883X_SPKR_DRV_LF_REG_GAIN, 0x00 },\n\t{ WSA883X_SPKR_DRV_OS_CAL_CTL, 0x00 },\n\t{ WSA883X_SPKR_DRV_OS_CAL_CTL1, 0x90 },\n\t{ WSA883X_SPKR_PWM_CLK_CTL, 0x00 },\n\t{ WSA883X_SPKR_PDRV_HS_CTL, 0x52 },\n\t{ WSA883X_SPKR_PDRV_LS_CTL, 0x48 },\n\t{ WSA883X_SPKR_PWRSTG_DBG, 0x08 },\n\t{ WSA883X_SPKR_OCP_CTL, 0xE2 },\n\t{ WSA883X_SPKR_BBM_CTL, 0x92 },\n\t{ WSA883X_PA_STATUS0, 0x00 },\n\t{ WSA883X_PA_STATUS1, 0x00 },\n\t{ WSA883X_PA_STATUS2, 0x80 },\n\t{ WSA883X_EN_CTRL, 0x44 },\n\t{ WSA883X_CURRENT_LIMIT, 0xCC },\n\t{ WSA883X_IBIAS1, 0x00 },\n\t{ WSA883X_IBIAS2, 0x00 },\n\t{ WSA883X_IBIAS3, 0x00 },\n\t{ WSA883X_LDO_PROG, 0x02 },\n\t{ WSA883X_STABILITY_CTRL1, 0x8E },\n\t{ WSA883X_STABILITY_CTRL2, 0x10 },\n\t{ WSA883X_PWRSTAGE_CTRL1, 0x06 },\n\t{ WSA883X_PWRSTAGE_CTRL2, 0x00 },\n\t{ WSA883X_BYPASS_1, 0x19 },\n\t{ WSA883X_BYPASS_2, 0x13 },\n\t{ WSA883X_ZX_CTRL_1, 0xF0 },\n\t{ WSA883X_ZX_CTRL_2, 0x04 },\n\t{ WSA883X_MISC1, 0x06 },\n\t{ WSA883X_MISC2, 0xA0 },\n\t{ WSA883X_GMAMP_SUP1, 0x82 },\n\t{ WSA883X_PWRSTAGE_CTRL3, 0x39 },\n\t{ WSA883X_PWRSTAGE_CTRL4, 0x5F },\n\t{ WSA883X_TEST1, 0x00 },\n\t{ WSA883X_SPARE1, 0x00 },\n\t{ WSA883X_SPARE2, 0x00 },\n\t{ WSA883X_PON_CTL_0, 0x10 },\n\t{ WSA883X_PON_CLT_1, 0xE0 },\n\t{ WSA883X_PON_CTL_2, 0x90 },\n\t{ WSA883X_PON_CTL_3, 0x70 },\n\t{ WSA883X_CKWD_CTL_0, 0x34 },\n\t{ WSA883X_CKWD_CTL_1, 0x0F },\n\t{ WSA883X_CKWD_CTL_2, 0x00 },\n\t{ WSA883X_CKSK_CTL_0, 0x00 },\n\t{ WSA883X_PADSW_CTL_0, 0x00 },\n\t{ WSA883X_TEST_0, 0x00 },\n\t{ WSA883X_TEST_1, 0x00 },\n\t{ WSA883X_STATUS_0, 0x00 },\n\t{ WSA883X_STATUS_1, 0x00 },\n\t{ WSA883X_CHIP_ID0, 0x00 },\n\t{ WSA883X_CHIP_ID1, 0x00 },\n\t{ WSA883X_CHIP_ID2, 0x02 },\n\t{ WSA883X_CHIP_ID3, 0x02 },\n\t{ WSA883X_BUS_ID, 0x00 },\n\t{ WSA883X_CDC_RST_CTL, 0x01 },\n\t{ WSA883X_TOP_CLK_CFG, 0x00 },\n\t{ WSA883X_CDC_PATH_MODE, 0x00 },\n\t{ WSA883X_CDC_CLK_CTL, 0xFF },\n\t{ WSA883X_SWR_RESET_EN, 0x00 },\n\t{ WSA883X_RESET_CTL, 0x00 },\n\t{ WSA883X_PA_FSM_CTL, 0x00 },\n\t{ WSA883X_PA_FSM_TIMER0, 0x80 },\n\t{ WSA883X_PA_FSM_TIMER1, 0x80 },\n\t{ WSA883X_PA_FSM_STA, 0x00 },\n\t{ WSA883X_PA_FSM_ERR_COND, 0x00 },\n\t{ WSA883X_PA_FSM_MSK, 0x00 },\n\t{ WSA883X_PA_FSM_BYP, 0x01 },\n\t{ WSA883X_PA_FSM_DBG, 0x00 },\n\t{ WSA883X_TADC_VALUE_CTL, 0x03 },\n\t{ WSA883X_TEMP_DETECT_CTL, 0x01 },\n\t{ WSA883X_TEMP_MSB, 0x00 },\n\t{ WSA883X_TEMP_LSB, 0x00 },\n\t{ WSA883X_TEMP_CONFIG0, 0x00 },\n\t{ WSA883X_TEMP_CONFIG1, 0x00 },\n\t{ WSA883X_VBAT_ADC_FLT_CTL, 0x00 },\n\t{ WSA883X_VBAT_DIN_MSB, 0x00 },\n\t{ WSA883X_VBAT_DIN_LSB, 0x00 },\n\t{ WSA883X_VBAT_DOUT, 0x00 },\n\t{ WSA883X_SDM_PDM9_LSB, 0x00 },\n\t{ WSA883X_SDM_PDM9_MSB, 0x00 },\n\t{ WSA883X_CDC_RX_CTL, 0xFE },\n\t{ WSA883X_CDC_SPK_DSM_A1_0, 0x00 },\n\t{ WSA883X_CDC_SPK_DSM_A1_1, 0x01 },\n\t{ WSA883X_CDC_SPK_DSM_A2_0, 0x96 },\n\t{ WSA883X_CDC_SPK_DSM_A2_1, 0x09 },\n\t{ WSA883X_CDC_SPK_DSM_A3_0, 0xAB },\n\t{ WSA883X_CDC_SPK_DSM_A3_1, 0x05 },\n\t{ WSA883X_CDC_SPK_DSM_A4_0, 0x1C },\n\t{ WSA883X_CDC_SPK_DSM_A4_1, 0x02 },\n\t{ WSA883X_CDC_SPK_DSM_A5_0, 0x17 },\n\t{ WSA883X_CDC_SPK_DSM_A5_1, 0x02 },\n\t{ WSA883X_CDC_SPK_DSM_A6_0, 0xAA },\n\t{ WSA883X_CDC_SPK_DSM_A7_0, 0xE3 },\n\t{ WSA883X_CDC_SPK_DSM_C_0, 0x69 },\n\t{ WSA883X_CDC_SPK_DSM_C_1, 0x54 },\n\t{ WSA883X_CDC_SPK_DSM_C_2, 0x02 },\n\t{ WSA883X_CDC_SPK_DSM_C_3, 0x15 },\n\t{ WSA883X_CDC_SPK_DSM_R1, 0xA4 },\n\t{ WSA883X_CDC_SPK_DSM_R2, 0xB5 },\n\t{ WSA883X_CDC_SPK_DSM_R3, 0x86 },\n\t{ WSA883X_CDC_SPK_DSM_R4, 0x85 },\n\t{ WSA883X_CDC_SPK_DSM_R5, 0xAA },\n\t{ WSA883X_CDC_SPK_DSM_R6, 0xE2 },\n\t{ WSA883X_CDC_SPK_DSM_R7, 0x62 },\n\t{ WSA883X_CDC_SPK_GAIN_PDM_0, 0x00 },\n\t{ WSA883X_CDC_SPK_GAIN_PDM_1, 0xFC },\n\t{ WSA883X_CDC_SPK_GAIN_PDM_2, 0x05 },\n\t{ WSA883X_PDM_WD_CTL, 0x00 },\n\t{ WSA883X_DEM_BYPASS_DATA0, 0x00 },\n\t{ WSA883X_DEM_BYPASS_DATA1, 0x00 },\n\t{ WSA883X_DEM_BYPASS_DATA2, 0x00 },\n\t{ WSA883X_DEM_BYPASS_DATA3, 0x00 },\n\t{ WSA883X_WAVG_CTL, 0x06 },\n\t{ WSA883X_WAVG_LRA_PER_0, 0xD1 },\n\t{ WSA883X_WAVG_LRA_PER_1, 0x00 },\n\t{ WSA883X_WAVG_DELTA_THETA_0, 0xE6 },\n\t{ WSA883X_WAVG_DELTA_THETA_1, 0x04 },\n\t{ WSA883X_WAVG_DIRECT_AMP_0, 0x50 },\n\t{ WSA883X_WAVG_DIRECT_AMP_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP0_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP0_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP1_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP1_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP2_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP2_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP3_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP3_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP4_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP4_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP5_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP5_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP6_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP6_1, 0x00 },\n\t{ WSA883X_WAVG_PTRN_AMP7_0, 0x50 },\n\t{ WSA883X_WAVG_PTRN_AMP7_1, 0x00 },\n\t{ WSA883X_WAVG_PER_0_1, 0x88 },\n\t{ WSA883X_WAVG_PER_2_3, 0x88 },\n\t{ WSA883X_WAVG_PER_4_5, 0x88 },\n\t{ WSA883X_WAVG_PER_6_7, 0x88 },\n\t{ WSA883X_WAVG_STA, 0x00 },\n\t{ WSA883X_DRE_CTL_0, 0x70 },\n\t{ WSA883X_DRE_CTL_1, 0x08 },\n\t{ WSA883X_DRE_IDLE_DET_CTL, 0x1F },\n\t{ WSA883X_CLSH_CTL_0, 0x37 },\n\t{ WSA883X_CLSH_CTL_1, 0x81 },\n\t{ WSA883X_CLSH_V_HD_PA, 0x0F },\n\t{ WSA883X_CLSH_V_PA_MIN, 0x00 },\n\t{ WSA883X_CLSH_OVRD_VAL, 0x00 },\n\t{ WSA883X_CLSH_HARD_MAX, 0xFF },\n\t{ WSA883X_CLSH_SOFT_MAX, 0xF5 },\n\t{ WSA883X_CLSH_SIG_DP, 0x00 },\n\t{ WSA883X_TAGC_CTL, 0x10 },\n\t{ WSA883X_TAGC_TIME, 0x20 },\n\t{ WSA883X_TAGC_E2E_GAIN, 0x02 },\n\t{ WSA883X_TAGC_FORCE_VAL, 0x00 },\n\t{ WSA883X_VAGC_CTL, 0x00 },\n\t{ WSA883X_VAGC_TIME, 0x08 },\n\t{ WSA883X_VAGC_ATTN_LVL_1_2, 0x21 },\n\t{ WSA883X_VAGC_ATTN_LVL_3, 0x03 },\n\t{ WSA883X_INTR_MODE, 0x00 },\n\t{ WSA883X_INTR_MASK0, 0x90 },\n\t{ WSA883X_INTR_MASK1, 0x00 },\n\t{ WSA883X_INTR_STATUS0, 0x00 },\n\t{ WSA883X_INTR_STATUS1, 0x00 },\n\t{ WSA883X_INTR_CLEAR0, 0x00 },\n\t{ WSA883X_INTR_CLEAR1, 0x00 },\n\t{ WSA883X_INTR_LEVEL0, 0x00 },\n\t{ WSA883X_INTR_LEVEL1, 0x00 },\n\t{ WSA883X_INTR_SET0, 0x00 },\n\t{ WSA883X_INTR_SET1, 0x00 },\n\t{ WSA883X_INTR_TEST0, 0x00 },\n\t{ WSA883X_INTR_TEST1, 0x00 },\n\t{ WSA883X_OTP_CTRL0, 0x00 },\n\t{ WSA883X_OTP_CTRL1, 0x00 },\n\t{ WSA883X_HDRIVE_CTL_GROUP1, 0x00 },\n\t{ WSA883X_PIN_CTL, 0x04 },\n\t{ WSA883X_PIN_CTL_OE, 0x00 },\n\t{ WSA883X_PIN_WDATA_IOPAD, 0x00 },\n\t{ WSA883X_PIN_STATUS, 0x00 },\n\t{ WSA883X_I2C_SLAVE_CTL, 0x00 },\n\t{ WSA883X_PDM_TEST_MODE, 0x00 },\n\t{ WSA883X_ATE_TEST_MODE, 0x00 },\n\t{ WSA883X_DIG_DEBUG_MODE, 0x00 },\n\t{ WSA883X_DIG_DEBUG_SEL, 0x00 },\n\t{ WSA883X_DIG_DEBUG_EN, 0x00 },\n\t{ WSA883X_SWR_HM_TEST0, 0x08 },\n\t{ WSA883X_SWR_HM_TEST1, 0x00 },\n\t{ WSA883X_SWR_PAD_CTL, 0x37 },\n\t{ WSA883X_TADC_DETECT_DBG_CTL, 0x00 },\n\t{ WSA883X_TADC_DEBUG_MSB, 0x00 },\n\t{ WSA883X_TADC_DEBUG_LSB, 0x00 },\n\t{ WSA883X_SAMPLE_EDGE_SEL, 0x7F },\n\t{ WSA883X_SWR_EDGE_SEL, 0x00 },\n\t{ WSA883X_TEST_MODE_CTL, 0x04 },\n\t{ WSA883X_IOPAD_CTL, 0x00 },\n\t{ WSA883X_ANA_CSR_DBG_ADD, 0x00 },\n\t{ WSA883X_ANA_CSR_DBG_CTL, 0x12 },\n\t{ WSA883X_SPARE_R, 0x00 },\n\t{ WSA883X_SPARE_0, 0x00 },\n\t{ WSA883X_SPARE_1, 0x00 },\n\t{ WSA883X_SPARE_2, 0x00 },\n\t{ WSA883X_SCODE, 0x00 },\n\t{ WSA883X_OTP_REG_0, 0x05 },\n\t{ WSA883X_OTP_REG_1, 0xFF },\n\t{ WSA883X_OTP_REG_2, 0xC0 },\n\t{ WSA883X_OTP_REG_3, 0xFF },\n\t{ WSA883X_OTP_REG_4, 0xC0 },\n\t{ WSA883X_OTP_REG_5, 0xFF },\n\t{ WSA883X_OTP_REG_6, 0xFF },\n\t{ WSA883X_OTP_REG_7, 0xFF },\n\t{ WSA883X_OTP_REG_8, 0xFF },\n\t{ WSA883X_OTP_REG_9, 0xFF },\n\t{ WSA883X_OTP_REG_10, 0xFF },\n\t{ WSA883X_OTP_REG_11, 0xFF },\n\t{ WSA883X_OTP_REG_12, 0xFF },\n\t{ WSA883X_OTP_REG_13, 0xFF },\n\t{ WSA883X_OTP_REG_14, 0xFF },\n\t{ WSA883X_OTP_REG_15, 0xFF },\n\t{ WSA883X_OTP_REG_16, 0xFF },\n\t{ WSA883X_OTP_REG_17, 0xFF },\n\t{ WSA883X_OTP_REG_18, 0xFF },\n\t{ WSA883X_OTP_REG_19, 0xFF },\n\t{ WSA883X_OTP_REG_20, 0xFF },\n\t{ WSA883X_OTP_REG_21, 0xFF },\n\t{ WSA883X_OTP_REG_22, 0xFF },\n\t{ WSA883X_OTP_REG_23, 0xFF },\n\t{ WSA883X_OTP_REG_24, 0x37 },\n\t{ WSA883X_OTP_REG_25, 0x3F },\n\t{ WSA883X_OTP_REG_26, 0x03 },\n\t{ WSA883X_OTP_REG_27, 0x00 },\n\t{ WSA883X_OTP_REG_28, 0x00 },\n\t{ WSA883X_OTP_REG_29, 0x00 },\n\t{ WSA883X_OTP_REG_30, 0x00 },\n\t{ WSA883X_OTP_REG_31, 0x03 },\n\t{ WSA883X_OTP_REG_32, 0x00 },\n\t{ WSA883X_OTP_REG_33, 0xFF },\n\t{ WSA883X_OTP_REG_34, 0x00 },\n\t{ WSA883X_OTP_REG_35, 0x00 },\n\t{ WSA883X_OTP_REG_63, 0x40 },\n\t{ WSA883X_EMEM_0, 0x00 },\n\t{ WSA883X_EMEM_1, 0x00 },\n\t{ WSA883X_EMEM_2, 0x00 },\n\t{ WSA883X_EMEM_3, 0x00 },\n\t{ WSA883X_EMEM_4, 0x00 },\n\t{ WSA883X_EMEM_5, 0x00 },\n\t{ WSA883X_EMEM_6, 0x00 },\n\t{ WSA883X_EMEM_7, 0x00 },\n\t{ WSA883X_EMEM_8, 0x00 },\n\t{ WSA883X_EMEM_9, 0x00 },\n\t{ WSA883X_EMEM_10, 0x00 },\n\t{ WSA883X_EMEM_11, 0x00 },\n\t{ WSA883X_EMEM_12, 0x00 },\n\t{ WSA883X_EMEM_13, 0x00 },\n\t{ WSA883X_EMEM_14, 0x00 },\n\t{ WSA883X_EMEM_15, 0x00 },\n\t{ WSA883X_EMEM_16, 0x00 },\n\t{ WSA883X_EMEM_17, 0x00 },\n\t{ WSA883X_EMEM_18, 0x00 },\n\t{ WSA883X_EMEM_19, 0x00 },\n\t{ WSA883X_EMEM_20, 0x00 },\n\t{ WSA883X_EMEM_21, 0x00 },\n\t{ WSA883X_EMEM_22, 0x00 },\n\t{ WSA883X_EMEM_23, 0x00 },\n\t{ WSA883X_EMEM_24, 0x00 },\n\t{ WSA883X_EMEM_25, 0x00 },\n\t{ WSA883X_EMEM_26, 0x00 },\n\t{ WSA883X_EMEM_27, 0x00 },\n\t{ WSA883X_EMEM_28, 0x00 },\n\t{ WSA883X_EMEM_29, 0x00 },\n\t{ WSA883X_EMEM_30, 0x00 },\n\t{ WSA883X_EMEM_31, 0x00 },\n\t{ WSA883X_EMEM_32, 0x00 },\n\t{ WSA883X_EMEM_33, 0x00 },\n\t{ WSA883X_EMEM_34, 0x00 },\n\t{ WSA883X_EMEM_35, 0x00 },\n\t{ WSA883X_EMEM_36, 0x00 },\n\t{ WSA883X_EMEM_37, 0x00 },\n\t{ WSA883X_EMEM_38, 0x00 },\n\t{ WSA883X_EMEM_39, 0x00 },\n\t{ WSA883X_EMEM_40, 0x00 },\n\t{ WSA883X_EMEM_41, 0x00 },\n\t{ WSA883X_EMEM_42, 0x00 },\n\t{ WSA883X_EMEM_43, 0x00 },\n\t{ WSA883X_EMEM_44, 0x00 },\n\t{ WSA883X_EMEM_45, 0x00 },\n\t{ WSA883X_EMEM_46, 0x00 },\n\t{ WSA883X_EMEM_47, 0x00 },\n\t{ WSA883X_EMEM_48, 0x00 },\n\t{ WSA883X_EMEM_49, 0x00 },\n\t{ WSA883X_EMEM_50, 0x00 },\n\t{ WSA883X_EMEM_51, 0x00 },\n\t{ WSA883X_EMEM_52, 0x00 },\n\t{ WSA883X_EMEM_53, 0x00 },\n\t{ WSA883X_EMEM_54, 0x00 },\n\t{ WSA883X_EMEM_55, 0x00 },\n\t{ WSA883X_EMEM_56, 0x00 },\n\t{ WSA883X_EMEM_57, 0x00 },\n\t{ WSA883X_EMEM_58, 0x00 },\n\t{ WSA883X_EMEM_59, 0x00 },\n\t{ WSA883X_EMEM_60, 0x00 },\n\t{ WSA883X_EMEM_61, 0x00 },\n\t{ WSA883X_EMEM_62, 0x00 },\n\t{ WSA883X_EMEM_63, 0x00 },\n};\n\nstatic bool wsa883x_readonly_register(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase WSA883X_DOUT_MSB:\n\tcase WSA883X_DOUT_LSB:\n\tcase WSA883X_STATUS:\n\tcase WSA883X_PA_STATUS0:\n\tcase WSA883X_PA_STATUS1:\n\tcase WSA883X_PA_STATUS2:\n\tcase WSA883X_STATUS_0:\n\tcase WSA883X_STATUS_1:\n\tcase WSA883X_CHIP_ID0:\n\tcase WSA883X_CHIP_ID1:\n\tcase WSA883X_CHIP_ID2:\n\tcase WSA883X_CHIP_ID3:\n\tcase WSA883X_BUS_ID:\n\tcase WSA883X_PA_FSM_STA:\n\tcase WSA883X_PA_FSM_ERR_COND:\n\tcase WSA883X_TEMP_MSB:\n\tcase WSA883X_TEMP_LSB:\n\tcase WSA883X_VBAT_DIN_MSB:\n\tcase WSA883X_VBAT_DIN_LSB:\n\tcase WSA883X_VBAT_DOUT:\n\tcase WSA883X_SDM_PDM9_LSB:\n\tcase WSA883X_SDM_PDM9_MSB:\n\tcase WSA883X_WAVG_STA:\n\tcase WSA883X_INTR_STATUS0:\n\tcase WSA883X_INTR_STATUS1:\n\tcase WSA883X_OTP_CTRL1:\n\tcase WSA883X_PIN_STATUS:\n\tcase WSA883X_ATE_TEST_MODE:\n\tcase WSA883X_SWR_HM_TEST1:\n\tcase WSA883X_SPARE_R:\n\tcase WSA883X_OTP_REG_0:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic bool wsa883x_writeable_register(struct device *dev, unsigned int reg)\n{\n\treturn !wsa883x_readonly_register(dev, reg);\n}\n\nstatic bool wsa883x_volatile_register(struct device *dev, unsigned int reg)\n{\n\treturn wsa883x_readonly_register(dev, reg);\n}\n\nstatic struct regmap_config wsa883x_regmap_config = {\n\t.reg_bits = 32,\n\t.val_bits = 8,\n\t.cache_type = REGCACHE_MAPLE,\n\t.reg_defaults = wsa883x_defaults,\n\t.max_register = WSA883X_MAX_REGISTER,\n\t.num_reg_defaults = ARRAY_SIZE(wsa883x_defaults),\n\t.volatile_reg = wsa883x_volatile_register,\n\t.writeable_reg = wsa883x_writeable_register,\n\t.reg_format_endian = REGMAP_ENDIAN_NATIVE,\n\t.val_format_endian = REGMAP_ENDIAN_NATIVE,\n\t.use_single_read = true,\n};\n\nstatic const struct reg_sequence reg_init[] = {\n\t{WSA883X_PA_FSM_BYP, 0x00},\n\t{WSA883X_ADC_6, 0x02},\n\t{WSA883X_CDC_SPK_DSM_A2_0, 0x0A},\n\t{WSA883X_CDC_SPK_DSM_A2_1, 0x08},\n\t{WSA883X_CDC_SPK_DSM_A3_0, 0xF3},\n\t{WSA883X_CDC_SPK_DSM_A3_1, 0x07},\n\t{WSA883X_CDC_SPK_DSM_A4_0, 0x79},\n\t{WSA883X_CDC_SPK_DSM_A4_1, 0x02},\n\t{WSA883X_CDC_SPK_DSM_A5_0, 0x0B},\n\t{WSA883X_CDC_SPK_DSM_A5_1, 0x02},\n\t{WSA883X_CDC_SPK_DSM_A6_0, 0x8A},\n\t{WSA883X_CDC_SPK_DSM_A7_0, 0x9B},\n\t{WSA883X_CDC_SPK_DSM_C_0, 0x68},\n\t{WSA883X_CDC_SPK_DSM_C_1, 0x54},\n\t{WSA883X_CDC_SPK_DSM_C_2, 0xF2},\n\t{WSA883X_CDC_SPK_DSM_C_3, 0x20},\n\t{WSA883X_CDC_SPK_DSM_R1, 0x83},\n\t{WSA883X_CDC_SPK_DSM_R2, 0x7F},\n\t{WSA883X_CDC_SPK_DSM_R3, 0x9D},\n\t{WSA883X_CDC_SPK_DSM_R4, 0x82},\n\t{WSA883X_CDC_SPK_DSM_R5, 0x8B},\n\t{WSA883X_CDC_SPK_DSM_R6, 0x9B},\n\t{WSA883X_CDC_SPK_DSM_R7, 0x3F},\n\t{WSA883X_VBAT_SNS, 0x20},\n\t{WSA883X_DRE_CTL_0, 0x92},\n\t{WSA883X_DRE_IDLE_DET_CTL, 0x0F},\n\t{WSA883X_CURRENT_LIMIT, 0xC4},\n\t{WSA883X_VAGC_TIME, 0x0F},\n\t{WSA883X_VAGC_ATTN_LVL_1_2, 0x00},\n\t{WSA883X_VAGC_ATTN_LVL_3, 0x01},\n\t{WSA883X_VAGC_CTL, 0x01},\n\t{WSA883X_TAGC_CTL, 0x1A},\n\t{WSA883X_TAGC_TIME, 0x2C},\n\t{WSA883X_TEMP_CONFIG0, 0x02},\n\t{WSA883X_TEMP_CONFIG1, 0x02},\n\t{WSA883X_OTP_REG_1, 0x49},\n\t{WSA883X_OTP_REG_2, 0x80},\n\t{WSA883X_OTP_REG_3, 0xC9},\n\t{WSA883X_OTP_REG_4, 0x40},\n\t{WSA883X_TAGC_CTL, 0x1B},\n\t{WSA883X_ADC_2, 0x00},\n\t{WSA883X_ADC_7, 0x85},\n\t{WSA883X_ADC_7, 0x87},\n\t{WSA883X_CKWD_CTL_0, 0x14},\n\t{WSA883X_CKWD_CTL_1, 0x1B},\n\t{WSA883X_GMAMP_SUP1, 0xE2},\n};\n\nstatic void wsa883x_init(struct wsa883x_priv *wsa883x)\n{\n\tstruct regmap *regmap = wsa883x->regmap;\n\tint variant, version;\n\n\tregmap_read(regmap, WSA883X_OTP_REG_0, &variant);\n\twsa883x->variant = variant & WSA883X_ID_MASK;\n\n\tregmap_read(regmap, WSA883X_CHIP_ID0, &version);\n\twsa883x->version = version;\n\n\tswitch (wsa883x->variant) {\n\tcase WSA8830:\n\t\tdev_info(wsa883x->dev, \"WSA883X Version 1_%d, Variant: WSA8830\\n\",\n\t\t\t wsa883x->version);\n\t\tbreak;\n\tcase WSA8835:\n\t\tdev_info(wsa883x->dev, \"WSA883X Version 1_%d, Variant: WSA8835\\n\",\n\t\t\t wsa883x->version);\n\t\tbreak;\n\tcase WSA8832:\n\t\tdev_info(wsa883x->dev, \"WSA883X Version 1_%d, Variant: WSA8832\\n\",\n\t\t\t wsa883x->version);\n\t\tbreak;\n\tcase WSA8835_V2:\n\t\tdev_info(wsa883x->dev, \"WSA883X Version 1_%d, Variant: WSA8835_V2\\n\",\n\t\t\t wsa883x->version);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\twsa883x->comp_offset = COMP_OFFSET2;\n\n\t \n\tregmap_multi_reg_write(regmap, reg_init, ARRAY_SIZE(reg_init));\n\n\tif (wsa883x->variant == WSA8830 || wsa883x->variant == WSA8832) {\n\t\twsa883x->comp_offset = COMP_OFFSET3;\n\t\tregmap_update_bits(regmap, WSA883X_DRE_CTL_0,\n\t\t\t\t   WSA883X_DRE_OFFSET_MASK,\n\t\t\t\t   wsa883x->comp_offset);\n\t}\n}\n\nstatic int wsa883x_update_status(struct sdw_slave *slave,\n\t\t\t\t enum sdw_slave_status status)\n{\n\tstruct wsa883x_priv *wsa883x = dev_get_drvdata(&slave->dev);\n\n\tif (status == SDW_SLAVE_ATTACHED && slave->dev_num > 0)\n\t\twsa883x_init(wsa883x);\n\n\treturn 0;\n}\n\nstatic int wsa883x_port_prep(struct sdw_slave *slave,\n\t\t\t     struct sdw_prepare_ch *prepare_ch,\n\t\t\t     enum sdw_port_prep_ops state)\n{\n\tstruct wsa883x_priv *wsa883x = dev_get_drvdata(&slave->dev);\n\n\tif (state == SDW_OPS_PORT_POST_PREP)\n\t\twsa883x->port_prepared[prepare_ch->num - 1] = true;\n\telse\n\t\twsa883x->port_prepared[prepare_ch->num - 1] = false;\n\n\treturn 0;\n}\n\nstatic const struct sdw_slave_ops wsa883x_slave_ops = {\n\t.update_status = wsa883x_update_status,\n\t.port_prep = wsa883x_port_prep,\n};\n\nstatic int wsa_dev_mode_get(struct snd_kcontrol *kcontrol,\n\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.enumerated.item[0] = wsa883x->dev_mode;\n\n\treturn 0;\n}\n\nstatic int wsa_dev_mode_put(struct snd_kcontrol *kcontrol,\n\t\t\t    struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(component);\n\n\tif (wsa883x->dev_mode == ucontrol->value.enumerated.item[0])\n\t\treturn 0;\n\n\twsa883x->dev_mode = ucontrol->value.enumerated.item[0];\n\n\treturn 1;\n}\n\nstatic const DECLARE_TLV_DB_SCALE(pa_gain, -300, 150, -300);\n\nstatic int wsa883x_get_swr_port(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *comp = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *data = snd_soc_component_get_drvdata(comp);\n\tstruct soc_mixer_control *mixer = (struct soc_mixer_control *)kcontrol->private_value;\n\tint portidx = mixer->reg;\n\n\tucontrol->value.integer.value[0] = data->port_enable[portidx];\n\n\treturn 0;\n}\n\nstatic int wsa883x_set_swr_port(struct snd_kcontrol *kcontrol,\n\t\t\t\tstruct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *comp = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *data = snd_soc_component_get_drvdata(comp);\n\tstruct soc_mixer_control *mixer = (struct soc_mixer_control *)kcontrol->private_value;\n\tint portidx = mixer->reg;\n\n\tif (ucontrol->value.integer.value[0]) {\n\t\tif (data->port_enable[portidx])\n\t\t\treturn 0;\n\n\t\tdata->port_enable[portidx] = true;\n\t} else {\n\t\tif (!data->port_enable[portidx])\n\t\t\treturn 0;\n\n\t\tdata->port_enable[portidx] = false;\n\t}\n\n\treturn 1;\n}\n\nstatic int wsa883x_get_comp_offset(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.integer.value[0] = wsa883x->comp_offset;\n\n\treturn 0;\n}\n\nstatic int wsa883x_set_comp_offset(struct snd_kcontrol *kcontrol,\n\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(component);\n\n\tif (wsa883x->comp_offset == ucontrol->value.integer.value[0])\n\t\treturn 0;\n\n\twsa883x->comp_offset = ucontrol->value.integer.value[0];\n\n\treturn 1;\n}\n\nstatic int wsa883x_codec_probe(struct snd_soc_component *comp)\n{\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(comp);\n\n\tsnd_soc_component_init_regmap(comp, wsa883x->regmap);\n\n\treturn 0;\n}\n\nstatic int wsa883x_spkr_event(struct snd_soc_dapm_widget *w,\n\t\t\t      struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct wsa883x_priv *wsa883x = snd_soc_component_get_drvdata(component);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tswitch (wsa883x->dev_mode) {\n\t\tcase RECEIVER:\n\t\t\tsnd_soc_component_write_field(component, WSA883X_CDC_PATH_MODE,\n\t\t\t\t\t\t      WSA883X_RXD_MODE_MASK,\n\t\t\t\t\t\t      WSA883X_RXD_MODE_HIFI);\n\t\t\tsnd_soc_component_write_field(component, WSA883X_SPKR_PWM_CLK_CTL,\n\t\t\t\t\t\t      WSA883X_SPKR_PWM_FREQ_SEL_MASK,\n\t\t\t\t\t\t      WSA883X_SPKR_PWM_FREQ_F600KHZ);\n\t\t\tsnd_soc_component_write_field(component, WSA883X_DRE_CTL_0,\n\t\t\t\t\t\t       WSA883X_DRE_PROG_DELAY_MASK, 0x0);\n\t\t\tbreak;\n\t\tcase SPEAKER:\n\t\t\tsnd_soc_component_write_field(component, WSA883X_CDC_PATH_MODE,\n\t\t\t\t\t\t      WSA883X_RXD_MODE_MASK,\n\t\t\t\t\t\t      WSA883X_RXD_MODE_NORMAL);\n\t\t\tsnd_soc_component_write_field(component, WSA883X_SPKR_PWM_CLK_CTL,\n\t\t\t\t\t\t      WSA883X_SPKR_PWM_FREQ_SEL_MASK,\n\t\t\t\t\t\t      WSA883X_SPKR_PWM_FREQ_F300KHZ);\n\t\t\tsnd_soc_component_write_field(component, WSA883X_DRE_CTL_0,\n\t\t\t\t\t\t       WSA883X_DRE_PROG_DELAY_MASK, 0x9);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t\tif (wsa883x->port_enable[WSA883X_PORT_COMP])\n\t\t\tsnd_soc_component_write_field(component, WSA883X_DRE_CTL_0,\n\t\t\t\t\t\t      WSA883X_DRE_OFFSET_MASK,\n\t\t\t\t\t\t      wsa883x->comp_offset);\n\t\tsnd_soc_component_write_field(component, WSA883X_VBAT_ADC_FLT_CTL,\n\t\t\t\t\t      WSA883X_VBAT_ADC_COEF_SEL_MASK,\n\t\t\t\t\t      WSA883X_VBAT_ADC_COEF_F_1DIV16);\n\t\tsnd_soc_component_write_field(component, WSA883X_VBAT_ADC_FLT_CTL,\n\t\t\t\t\t      WSA883X_VBAT_ADC_FLT_EN_MASK, 0x1);\n\t\tsnd_soc_component_write_field(component, WSA883X_PDM_WD_CTL,\n\t\t\t\t\t      WSA883X_PDM_EN_MASK,\n\t\t\t\t\t      WSA883X_PDM_ENABLE);\n\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_write_field(component, WSA883X_VBAT_ADC_FLT_CTL,\n\t\t\t\t\t      WSA883X_VBAT_ADC_FLT_EN_MASK, 0x0);\n\t\tsnd_soc_component_write_field(component, WSA883X_VBAT_ADC_FLT_CTL,\n\t\t\t\t\t      WSA883X_VBAT_ADC_COEF_SEL_MASK,\n\t\t\t\t\t      WSA883X_VBAT_ADC_COEF_F_1DIV2);\n\t\tsnd_soc_component_write_field(component, WSA883X_PA_FSM_CTL,\n\t\t\t\t\t      WSA883X_GLOBAL_PA_EN_MASK, 0);\n\t\tsnd_soc_component_write_field(component, WSA883X_PDM_WD_CTL,\n\t\t\t\t\t      WSA883X_PDM_EN_MASK, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget wsa883x_dapm_widgets[] = {\n\tSND_SOC_DAPM_INPUT(\"IN\"),\n\tSND_SOC_DAPM_SPK(\"SPKR\", wsa883x_spkr_event),\n};\n\nstatic const struct snd_kcontrol_new wsa883x_snd_controls[] = {\n\tSOC_SINGLE_RANGE_TLV(\"PA Volume\", WSA883X_DRE_CTL_1, 1,\n\t\t\t     0x0, 0x1f, 1, pa_gain),\n\tSOC_ENUM_EXT(\"WSA MODE\", wsa_dev_mode_enum,\n\t\t     wsa_dev_mode_get, wsa_dev_mode_put),\n\tSOC_SINGLE_EXT(\"COMP Offset\", SND_SOC_NOPM, 0, 4, 0,\n\t\t       wsa883x_get_comp_offset, wsa883x_set_comp_offset),\n\tSOC_SINGLE_EXT(\"DAC Switch\", WSA883X_PORT_DAC, 0, 1, 0,\n\t\t       wsa883x_get_swr_port, wsa883x_set_swr_port),\n\tSOC_SINGLE_EXT(\"COMP Switch\", WSA883X_PORT_COMP, 0, 1, 0,\n\t\t       wsa883x_get_swr_port, wsa883x_set_swr_port),\n\tSOC_SINGLE_EXT(\"BOOST Switch\", WSA883X_PORT_BOOST, 0, 1, 0,\n\t\t       wsa883x_get_swr_port, wsa883x_set_swr_port),\n\tSOC_SINGLE_EXT(\"VISENSE Switch\", WSA883X_PORT_VISENSE, 0, 1, 0,\n\t\t       wsa883x_get_swr_port, wsa883x_set_swr_port),\n};\n\nstatic const struct snd_soc_dapm_route wsa883x_audio_map[] = {\n\t{\"SPKR\", NULL, \"IN\"},\n};\n\nstatic const struct snd_soc_component_driver wsa883x_component_drv = {\n\t.name = \"WSA883x\",\n\t.probe = wsa883x_codec_probe,\n\t.controls = wsa883x_snd_controls,\n\t.num_controls = ARRAY_SIZE(wsa883x_snd_controls),\n\t.dapm_widgets = wsa883x_dapm_widgets,\n\t.num_dapm_widgets = ARRAY_SIZE(wsa883x_dapm_widgets),\n\t.dapm_routes = wsa883x_audio_map,\n\t.num_dapm_routes = ARRAY_SIZE(wsa883x_audio_map),\n};\n\nstatic int wsa883x_hw_params(struct snd_pcm_substream *substream,\n\t\t\t     struct snd_pcm_hw_params *params,\n\t\t\t     struct snd_soc_dai *dai)\n{\n\tstruct wsa883x_priv *wsa883x = dev_get_drvdata(dai->dev);\n\tint i;\n\n\twsa883x->active_ports = 0;\n\tfor (i = 0; i < WSA883X_MAX_SWR_PORTS; i++) {\n\t\tif (!wsa883x->port_enable[i])\n\t\t\tcontinue;\n\n\t\twsa883x->port_config[wsa883x->active_ports] = wsa883x_pconfig[i];\n\t\twsa883x->active_ports++;\n\t}\n\n\twsa883x->sconfig.frame_rate = params_rate(params);\n\n\treturn sdw_stream_add_slave(wsa883x->slave, &wsa883x->sconfig,\n\t\t\t\t    wsa883x->port_config, wsa883x->active_ports,\n\t\t\t\t    wsa883x->sruntime);\n}\n\nstatic int wsa883x_hw_free(struct snd_pcm_substream *substream,\n\t\t\t   struct snd_soc_dai *dai)\n{\n\tstruct wsa883x_priv *wsa883x = dev_get_drvdata(dai->dev);\n\n\tsdw_stream_remove_slave(wsa883x->slave, wsa883x->sruntime);\n\n\treturn 0;\n}\n\nstatic int wsa883x_set_sdw_stream(struct snd_soc_dai *dai,\n\t\t\t\t  void *stream, int direction)\n{\n\tstruct wsa883x_priv *wsa883x = dev_get_drvdata(dai->dev);\n\n\twsa883x->sruntime = stream;\n\n\treturn 0;\n}\n\nstatic int wsa883x_digital_mute(struct snd_soc_dai *dai, int mute, int stream)\n{\n\tstruct snd_soc_component *component = dai->component;\n\n\tif (mute) {\n\t\tsnd_soc_component_write_field(component, WSA883X_DRE_CTL_1,\n\t\t\t\t\t      WSA883X_DRE_GAIN_EN_MASK, 0);\n\t\tsnd_soc_component_write_field(component, WSA883X_PA_FSM_CTL,\n\t\t\t\t\t      WSA883X_GLOBAL_PA_EN_MASK, 0);\n\n\t} else {\n\t\tsnd_soc_component_write_field(component, WSA883X_DRE_CTL_1,\n\t\t\t\t\t      WSA883X_DRE_GAIN_EN_MASK,\n\t\t\t\t\t      WSA883X_DRE_GAIN_FROM_CSR);\n\t\tsnd_soc_component_write_field(component, WSA883X_PA_FSM_CTL,\n\t\t\t\t\t      WSA883X_GLOBAL_PA_EN_MASK,\n\t\t\t\t\t      WSA883X_GLOBAL_PA_ENABLE);\n\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dai_ops wsa883x_dai_ops = {\n\t.hw_params = wsa883x_hw_params,\n\t.hw_free = wsa883x_hw_free,\n\t.mute_stream = wsa883x_digital_mute,\n\t.set_stream = wsa883x_set_sdw_stream,\n\t.mute_unmute_on_trigger = true,\n};\n\nstatic struct snd_soc_dai_driver wsa883x_dais[] = {\n\t{\n\t\t.name = \"SPKR\",\n\t\t.playback = {\n\t\t\t.stream_name = \"SPKR Playback\",\n\t\t\t.rates = WSA883X_RATES | WSA883X_FRAC_RATES,\n\t\t\t.formats = WSA883X_FORMATS,\n\t\t\t.rate_min = 8000,\n\t\t\t.rate_max = 352800,\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 1,\n\t\t},\n\t\t.ops = &wsa883x_dai_ops,\n\t},\n};\n\nstatic int wsa883x_probe(struct sdw_slave *pdev,\n\t\t\t const struct sdw_device_id *id)\n{\n\tstruct wsa883x_priv *wsa883x;\n\tstruct device *dev = &pdev->dev;\n\tint ret;\n\n\twsa883x = devm_kzalloc(dev, sizeof(*wsa883x), GFP_KERNEL);\n\tif (!wsa883x)\n\t\treturn -ENOMEM;\n\n\twsa883x->vdd = devm_regulator_get(dev, \"vdd\");\n\tif (IS_ERR(wsa883x->vdd))\n\t\treturn dev_err_probe(dev, PTR_ERR(wsa883x->vdd),\n\t\t\t\t     \"No vdd regulator found\\n\");\n\n\tret = regulator_enable(wsa883x->vdd);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to enable vdd regulator\\n\");\n\n\twsa883x->sd_n = devm_gpiod_get_optional(dev, \"powerdown\",\n\t\t\t\t\t\tGPIOD_FLAGS_BIT_NONEXCLUSIVE | GPIOD_OUT_HIGH);\n\tif (IS_ERR(wsa883x->sd_n)) {\n\t\tret = dev_err_probe(dev, PTR_ERR(wsa883x->sd_n),\n\t\t\t\t    \"Shutdown Control GPIO not found\\n\");\n\t\tgoto err;\n\t}\n\n\tdev_set_drvdata(dev, wsa883x);\n\twsa883x->slave = pdev;\n\twsa883x->dev = dev;\n\twsa883x->sconfig.ch_count = 1;\n\twsa883x->sconfig.bps = 1;\n\twsa883x->sconfig.direction = SDW_DATA_DIR_RX;\n\twsa883x->sconfig.type = SDW_STREAM_PDM;\n\n\tpdev->prop.sink_ports = GENMASK(WSA883X_MAX_SWR_PORTS, 0);\n\tpdev->prop.simple_clk_stop_capable = true;\n\tpdev->prop.sink_dpn_prop = wsa_sink_dpn_prop;\n\tpdev->prop.scp_int1_mask = SDW_SCP_INT1_BUS_CLASH | SDW_SCP_INT1_PARITY;\n\tgpiod_direction_output(wsa883x->sd_n, 0);\n\n\twsa883x->regmap = devm_regmap_init_sdw(pdev, &wsa883x_regmap_config);\n\tif (IS_ERR(wsa883x->regmap)) {\n\t\tgpiod_direction_output(wsa883x->sd_n, 1);\n\t\tret = dev_err_probe(dev, PTR_ERR(wsa883x->regmap),\n\t\t\t\t    \"regmap_init failed\\n\");\n\t\tgoto err;\n\t}\n\tpm_runtime_set_autosuspend_delay(dev, 3000);\n\tpm_runtime_use_autosuspend(dev);\n\tpm_runtime_mark_last_busy(dev);\n\tpm_runtime_set_active(dev);\n\tpm_runtime_enable(dev);\n\n\tret = devm_snd_soc_register_component(dev,\n\t\t\t\t\t      &wsa883x_component_drv,\n\t\t\t\t\t       wsa883x_dais,\n\t\t\t\t\t       ARRAY_SIZE(wsa883x_dais));\nerr:\n\tif (ret)\n\t\tregulator_disable(wsa883x->vdd);\n\n\treturn ret;\n\n}\n\nstatic int __maybe_unused wsa883x_runtime_suspend(struct device *dev)\n{\n\tstruct regmap *regmap = dev_get_regmap(dev, NULL);\n\n\tregcache_cache_only(regmap, true);\n\tregcache_mark_dirty(regmap);\n\n\treturn 0;\n}\n\nstatic int __maybe_unused wsa883x_runtime_resume(struct device *dev)\n{\n\tstruct regmap *regmap = dev_get_regmap(dev, NULL);\n\n\tregcache_cache_only(regmap, false);\n\tregcache_sync(regmap);\n\n\treturn 0;\n}\n\nstatic const struct dev_pm_ops wsa883x_pm_ops = {\n\tSET_RUNTIME_PM_OPS(wsa883x_runtime_suspend, wsa883x_runtime_resume, NULL)\n};\n\nstatic const struct sdw_device_id wsa883x_swr_id[] = {\n\tSDW_SLAVE_ENTRY(0x0217, 0x0202, 0),\n\t{},\n};\n\nMODULE_DEVICE_TABLE(sdw, wsa883x_swr_id);\n\nstatic struct sdw_driver wsa883x_codec_driver = {\n\t.driver = {\n\t\t.name = \"wsa883x-codec\",\n\t\t.pm = &wsa883x_pm_ops,\n\t\t.suppress_bind_attrs = true,\n\t},\n\t.probe = wsa883x_probe,\n\t.ops = &wsa883x_slave_ops,\n\t.id_table = wsa883x_swr_id,\n};\n\nmodule_sdw_driver(wsa883x_codec_driver);\n\nMODULE_DESCRIPTION(\"WSA883x codec driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}