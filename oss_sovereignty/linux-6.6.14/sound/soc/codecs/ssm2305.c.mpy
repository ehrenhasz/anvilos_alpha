{
  "module_name": "ssm2305.c",
  "hash_id": "7e9a8ebfc29b7ee5ff008398fa614858bf69d99bd5dd793b260074e4e195f0fe",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/ssm2305.c",
  "human_readable_source": "\n\n\n\n\n\n\n#include <linux/gpio/consumer.h>\n#include <linux/module.h>\n#include <sound/soc.h>\n\n#define DRV_NAME \"ssm2305\"\n\nstruct ssm2305 {\n\t \n\tstruct gpio_desc *gpiod_shutdown;\n};\n\nstatic int ssm2305_power_event(struct snd_soc_dapm_widget *w,\n\t\t\t       struct snd_kcontrol *kctrl, int event)\n{\n\tstruct snd_soc_component *c = snd_soc_dapm_to_component(w->dapm);\n\tstruct ssm2305 *data = snd_soc_component_get_drvdata(c);\n\n\tgpiod_set_value_cansleep(data->gpiod_shutdown,\n\t\t\t\t SND_SOC_DAPM_EVENT_ON(event));\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget ssm2305_dapm_widgets[] = {\n\t \n\tSND_SOC_DAPM_INPUT(\"L_IN\"),\n\tSND_SOC_DAPM_INPUT(\"R_IN\"),\n\tSND_SOC_DAPM_OUTPUT(\"L_OUT\"),\n\tSND_SOC_DAPM_OUTPUT(\"R_OUT\"),\n\n\tSND_SOC_DAPM_SUPPLY(\"Power\", SND_SOC_NOPM, 0, 0, ssm2305_power_event,\n\t\t\t    SND_SOC_DAPM_PRE_PMU | SND_SOC_DAPM_POST_PMD),\n};\n\nstatic const struct snd_soc_dapm_route ssm2305_dapm_routes[] = {\n\t{ \"L_OUT\", NULL, \"L_IN\" },\n\t{ \"R_OUT\", NULL, \"R_IN\" },\n\t{ \"L_IN\", NULL, \"Power\" },\n\t{ \"R_IN\", NULL, \"Power\" },\n};\n\nstatic const struct snd_soc_component_driver ssm2305_component_driver = {\n\t.dapm_widgets\t\t= ssm2305_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(ssm2305_dapm_widgets),\n\t.dapm_routes\t\t= ssm2305_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(ssm2305_dapm_routes),\n};\n\nstatic int ssm2305_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct ssm2305 *priv;\n\n\t \n\tpriv = devm_kzalloc(dev, sizeof(*priv), GFP_KERNEL);\n\tif (!priv)\n\t\treturn -ENOMEM;\n\n\tplatform_set_drvdata(pdev, priv);\n\n\t \n\tpriv->gpiod_shutdown = devm_gpiod_get(dev, \"shutdown\",\n\t\t\t\t\t      GPIOD_OUT_LOW);\n\tif (IS_ERR(priv->gpiod_shutdown))\n\t\treturn dev_err_probe(dev, PTR_ERR(priv->gpiod_shutdown),\n\t\t\t\t     \"Failed to get 'shutdown' gpio\\n\");\n\n\treturn devm_snd_soc_register_component(dev, &ssm2305_component_driver,\n\t\t\t\t\t       NULL, 0);\n}\n\n#ifdef CONFIG_OF\nstatic const struct of_device_id ssm2305_of_match[] = {\n\t{ .compatible = \"adi,ssm2305\", },\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, ssm2305_of_match);\n#endif\n\nstatic struct platform_driver ssm2305_driver = {\n\t.driver = {\n\t\t.name = DRV_NAME,\n\t\t.of_match_table = of_match_ptr(ssm2305_of_match),\n\t},\n\t.probe = ssm2305_probe,\n};\n\nmodule_platform_driver(ssm2305_driver);\n\nMODULE_DESCRIPTION(\"ASoC SSM2305 amplifier driver\");\nMODULE_AUTHOR(\"Marco Felsch <m.felsch@pengutronix.de>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}