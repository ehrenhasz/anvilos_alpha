{
  "module_name": "rt5670.c",
  "hash_id": "5a3d372563cfecbf9eb35ac319cc0b5fbf5bd98116df537cdaf829670701e151",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/codecs/rt5670.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/pm.h>\n#include <linux/pm_runtime.h>\n#include <linux/i2c.h>\n#include <linux/platform_device.h>\n#include <linux/acpi.h>\n#include <linux/spi/spi.h>\n#include <linux/dmi.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/pcm_params.h>\n#include <sound/jack.h>\n#include <sound/soc.h>\n#include <sound/soc-dapm.h>\n#include <sound/initval.h>\n#include <sound/tlv.h>\n\n#include \"rl6231.h\"\n#include \"rt5670.h\"\n#include \"rt5670-dsp.h\"\n\n#define RT5670_GPIO1_IS_IRQ\t\t\tBIT(0)\n#define RT5670_IN2_DIFF\t\t\tBIT(1)\n#define RT5670_DMIC_EN\t\t\tBIT(2)\n#define RT5670_DMIC1_IN2P\t\tBIT(3)\n#define RT5670_DMIC1_GPIO6\t\tBIT(4)\n#define RT5670_DMIC1_GPIO7\t\tBIT(5)\n#define RT5670_DMIC2_INR\t\tBIT(6)\n#define RT5670_DMIC2_GPIO8\t\tBIT(7)\n#define RT5670_DMIC3_GPIO5\t\tBIT(8)\n#define RT5670_JD_MODE1\t\t\tBIT(9)\n#define RT5670_JD_MODE2\t\t\tBIT(10)\n#define RT5670_JD_MODE3\t\t\tBIT(11)\n#define RT5670_GPIO1_IS_EXT_SPK_EN\tBIT(12)\n\nstatic unsigned long rt5670_quirk;\nstatic unsigned int quirk_override;\nmodule_param_named(quirk, quirk_override, uint, 0444);\nMODULE_PARM_DESC(quirk, \"Board-specific quirk override\");\n\n#define RT5670_DEVICE_ID 0x6271\n\n#define RT5670_PR_RANGE_BASE (0xff + 1)\n#define RT5670_PR_SPACING 0x100\n\n#define RT5670_PR_BASE (RT5670_PR_RANGE_BASE + (0 * RT5670_PR_SPACING))\n\nstatic const struct regmap_range_cfg rt5670_ranges[] = {\n\t{ .name = \"PR\", .range_min = RT5670_PR_BASE,\n\t  .range_max = RT5670_PR_BASE + 0xf8,\n\t  .selector_reg = RT5670_PRIV_INDEX,\n\t  .selector_mask = 0xff,\n\t  .selector_shift = 0x0,\n\t  .window_start = RT5670_PRIV_DATA,\n\t  .window_len = 0x1, },\n};\n\nstatic const struct reg_sequence init_list[] = {\n\t{ RT5670_PR_BASE + 0x14, 0x9a8a },\n\t{ RT5670_PR_BASE + 0x38, 0x1fe1 },\n\t{ RT5670_PR_BASE + 0x3d, 0x3640 },\n\t{ 0x8a, 0x0123 },\n};\n\nstatic const struct reg_default rt5670_reg[] = {\n\t{ 0x00, 0x0000 },\n\t{ 0x02, 0x8888 },\n\t{ 0x03, 0x8888 },\n\t{ 0x0a, 0x0001 },\n\t{ 0x0b, 0x0827 },\n\t{ 0x0c, 0x0000 },\n\t{ 0x0d, 0x0008 },\n\t{ 0x0e, 0x0000 },\n\t{ 0x0f, 0x0808 },\n\t{ 0x19, 0xafaf },\n\t{ 0x1a, 0xafaf },\n\t{ 0x1b, 0x0011 },\n\t{ 0x1c, 0x2f2f },\n\t{ 0x1d, 0x2f2f },\n\t{ 0x1e, 0x0000 },\n\t{ 0x1f, 0x2f2f },\n\t{ 0x20, 0x0000 },\n\t{ 0x26, 0x7860 },\n\t{ 0x27, 0x7860 },\n\t{ 0x28, 0x7871 },\n\t{ 0x29, 0x8080 },\n\t{ 0x2a, 0x5656 },\n\t{ 0x2b, 0x5454 },\n\t{ 0x2c, 0xaaa0 },\n\t{ 0x2d, 0x0000 },\n\t{ 0x2e, 0x2f2f },\n\t{ 0x2f, 0x1002 },\n\t{ 0x30, 0x0000 },\n\t{ 0x31, 0x5f00 },\n\t{ 0x32, 0x0000 },\n\t{ 0x33, 0x0000 },\n\t{ 0x34, 0x0000 },\n\t{ 0x35, 0x0000 },\n\t{ 0x36, 0x0000 },\n\t{ 0x37, 0x0000 },\n\t{ 0x38, 0x0000 },\n\t{ 0x3b, 0x0000 },\n\t{ 0x3c, 0x007f },\n\t{ 0x3d, 0x0000 },\n\t{ 0x3e, 0x007f },\n\t{ 0x45, 0xe00f },\n\t{ 0x4c, 0x5380 },\n\t{ 0x4f, 0x0073 },\n\t{ 0x52, 0x00d3 },\n\t{ 0x53, 0xf000 },\n\t{ 0x61, 0x0000 },\n\t{ 0x62, 0x0001 },\n\t{ 0x63, 0x00c3 },\n\t{ 0x64, 0x0000 },\n\t{ 0x65, 0x0001 },\n\t{ 0x66, 0x0000 },\n\t{ 0x6f, 0x8000 },\n\t{ 0x70, 0x8000 },\n\t{ 0x71, 0x8000 },\n\t{ 0x72, 0x8000 },\n\t{ 0x73, 0x7770 },\n\t{ 0x74, 0x0e00 },\n\t{ 0x75, 0x1505 },\n\t{ 0x76, 0x0015 },\n\t{ 0x77, 0x0c00 },\n\t{ 0x78, 0x4000 },\n\t{ 0x79, 0x0123 },\n\t{ 0x7f, 0x1100 },\n\t{ 0x80, 0x0000 },\n\t{ 0x81, 0x0000 },\n\t{ 0x82, 0x0000 },\n\t{ 0x83, 0x0000 },\n\t{ 0x84, 0x0000 },\n\t{ 0x85, 0x0000 },\n\t{ 0x86, 0x0004 },\n\t{ 0x87, 0x0000 },\n\t{ 0x88, 0x0000 },\n\t{ 0x89, 0x0000 },\n\t{ 0x8a, 0x0123 },\n\t{ 0x8b, 0x0000 },\n\t{ 0x8c, 0x0003 },\n\t{ 0x8d, 0x0000 },\n\t{ 0x8e, 0x0004 },\n\t{ 0x8f, 0x1100 },\n\t{ 0x90, 0x0646 },\n\t{ 0x91, 0x0c06 },\n\t{ 0x93, 0x0000 },\n\t{ 0x94, 0x1270 },\n\t{ 0x95, 0x1000 },\n\t{ 0x97, 0x0000 },\n\t{ 0x98, 0x0000 },\n\t{ 0x99, 0x0000 },\n\t{ 0x9a, 0x2184 },\n\t{ 0x9b, 0x010a },\n\t{ 0x9c, 0x0aea },\n\t{ 0x9d, 0x000c },\n\t{ 0x9e, 0x0400 },\n\t{ 0xae, 0x7000 },\n\t{ 0xaf, 0x0000 },\n\t{ 0xb0, 0x7000 },\n\t{ 0xb1, 0x0000 },\n\t{ 0xb2, 0x0000 },\n\t{ 0xb3, 0x001f },\n\t{ 0xb4, 0x220c },\n\t{ 0xb5, 0x1f00 },\n\t{ 0xb6, 0x0000 },\n\t{ 0xb7, 0x0000 },\n\t{ 0xbb, 0x0000 },\n\t{ 0xbc, 0x0000 },\n\t{ 0xbd, 0x0000 },\n\t{ 0xbe, 0x0000 },\n\t{ 0xbf, 0x0000 },\n\t{ 0xc0, 0x0000 },\n\t{ 0xc1, 0x0000 },\n\t{ 0xc2, 0x0000 },\n\t{ 0xcd, 0x0000 },\n\t{ 0xce, 0x0000 },\n\t{ 0xcf, 0x1813 },\n\t{ 0xd0, 0x0690 },\n\t{ 0xd1, 0x1c17 },\n\t{ 0xd3, 0xa220 },\n\t{ 0xd4, 0x0000 },\n\t{ 0xd6, 0x0400 },\n\t{ 0xd9, 0x0809 },\n\t{ 0xda, 0x0000 },\n\t{ 0xdb, 0x0001 },\n\t{ 0xdc, 0x0049 },\n\t{ 0xdd, 0x0024 },\n\t{ 0xe6, 0x8000 },\n\t{ 0xe7, 0x0000 },\n\t{ 0xec, 0xa200 },\n\t{ 0xed, 0x0000 },\n\t{ 0xee, 0xa200 },\n\t{ 0xef, 0x0000 },\n\t{ 0xf8, 0x0000 },\n\t{ 0xf9, 0x0000 },\n\t{ 0xfa, 0x8010 },\n\t{ 0xfb, 0x0033 },\n\t{ 0xfc, 0x0100 },\n};\n\nstatic bool rt5670_volatile_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rt5670_ranges); i++) {\n\t\tif ((reg >= rt5670_ranges[i].window_start &&\n\t\t     reg <= rt5670_ranges[i].window_start +\n\t\t     rt5670_ranges[i].window_len) ||\n\t\t    (reg >= rt5670_ranges[i].range_min &&\n\t\t     reg <= rt5670_ranges[i].range_max)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tswitch (reg) {\n\tcase RT5670_RESET:\n\tcase RT5670_PDM_DATA_CTRL1:\n\tcase RT5670_PDM1_DATA_CTRL4:\n\tcase RT5670_PDM2_DATA_CTRL4:\n\tcase RT5670_PRIV_DATA:\n\tcase RT5670_ASRC_5:\n\tcase RT5670_CJ_CTRL1:\n\tcase RT5670_CJ_CTRL2:\n\tcase RT5670_CJ_CTRL3:\n\tcase RT5670_A_JD_CTRL1:\n\tcase RT5670_A_JD_CTRL2:\n\tcase RT5670_VAD_CTRL5:\n\tcase RT5670_ADC_EQ_CTRL1:\n\tcase RT5670_EQ_CTRL1:\n\tcase RT5670_ALC_CTRL_1:\n\tcase RT5670_IRQ_CTRL2:\n\tcase RT5670_INT_IRQ_ST:\n\tcase RT5670_IL_CMD:\n\tcase RT5670_DSP_CTRL1:\n\tcase RT5670_DSP_CTRL2:\n\tcase RT5670_DSP_CTRL3:\n\tcase RT5670_DSP_CTRL4:\n\tcase RT5670_DSP_CTRL5:\n\tcase RT5670_VENDOR_ID:\n\tcase RT5670_VENDOR_ID1:\n\tcase RT5670_VENDOR_ID2:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic bool rt5670_readable_register(struct device *dev, unsigned int reg)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rt5670_ranges); i++) {\n\t\tif ((reg >= rt5670_ranges[i].window_start &&\n\t\t     reg <= rt5670_ranges[i].window_start +\n\t\t     rt5670_ranges[i].window_len) ||\n\t\t    (reg >= rt5670_ranges[i].range_min &&\n\t\t     reg <= rt5670_ranges[i].range_max)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tswitch (reg) {\n\tcase RT5670_RESET:\n\tcase RT5670_HP_VOL:\n\tcase RT5670_LOUT1:\n\tcase RT5670_CJ_CTRL1:\n\tcase RT5670_CJ_CTRL2:\n\tcase RT5670_CJ_CTRL3:\n\tcase RT5670_IN2:\n\tcase RT5670_INL1_INR1_VOL:\n\tcase RT5670_DAC1_DIG_VOL:\n\tcase RT5670_DAC2_DIG_VOL:\n\tcase RT5670_DAC_CTRL:\n\tcase RT5670_STO1_ADC_DIG_VOL:\n\tcase RT5670_MONO_ADC_DIG_VOL:\n\tcase RT5670_STO2_ADC_DIG_VOL:\n\tcase RT5670_ADC_BST_VOL1:\n\tcase RT5670_ADC_BST_VOL2:\n\tcase RT5670_STO2_ADC_MIXER:\n\tcase RT5670_STO1_ADC_MIXER:\n\tcase RT5670_MONO_ADC_MIXER:\n\tcase RT5670_AD_DA_MIXER:\n\tcase RT5670_STO_DAC_MIXER:\n\tcase RT5670_DD_MIXER:\n\tcase RT5670_DIG_MIXER:\n\tcase RT5670_DSP_PATH1:\n\tcase RT5670_DSP_PATH2:\n\tcase RT5670_DIG_INF1_DATA:\n\tcase RT5670_DIG_INF2_DATA:\n\tcase RT5670_PDM_OUT_CTRL:\n\tcase RT5670_PDM_DATA_CTRL1:\n\tcase RT5670_PDM1_DATA_CTRL2:\n\tcase RT5670_PDM1_DATA_CTRL3:\n\tcase RT5670_PDM1_DATA_CTRL4:\n\tcase RT5670_PDM2_DATA_CTRL2:\n\tcase RT5670_PDM2_DATA_CTRL3:\n\tcase RT5670_PDM2_DATA_CTRL4:\n\tcase RT5670_REC_L1_MIXER:\n\tcase RT5670_REC_L2_MIXER:\n\tcase RT5670_REC_R1_MIXER:\n\tcase RT5670_REC_R2_MIXER:\n\tcase RT5670_HPO_MIXER:\n\tcase RT5670_MONO_MIXER:\n\tcase RT5670_OUT_L1_MIXER:\n\tcase RT5670_OUT_R1_MIXER:\n\tcase RT5670_LOUT_MIXER:\n\tcase RT5670_PWR_DIG1:\n\tcase RT5670_PWR_DIG2:\n\tcase RT5670_PWR_ANLG1:\n\tcase RT5670_PWR_ANLG2:\n\tcase RT5670_PWR_MIXER:\n\tcase RT5670_PWR_VOL:\n\tcase RT5670_PRIV_INDEX:\n\tcase RT5670_PRIV_DATA:\n\tcase RT5670_I2S4_SDP:\n\tcase RT5670_I2S1_SDP:\n\tcase RT5670_I2S2_SDP:\n\tcase RT5670_I2S3_SDP:\n\tcase RT5670_ADDA_CLK1:\n\tcase RT5670_ADDA_CLK2:\n\tcase RT5670_DMIC_CTRL1:\n\tcase RT5670_DMIC_CTRL2:\n\tcase RT5670_TDM_CTRL_1:\n\tcase RT5670_TDM_CTRL_2:\n\tcase RT5670_TDM_CTRL_3:\n\tcase RT5670_DSP_CLK:\n\tcase RT5670_GLB_CLK:\n\tcase RT5670_PLL_CTRL1:\n\tcase RT5670_PLL_CTRL2:\n\tcase RT5670_ASRC_1:\n\tcase RT5670_ASRC_2:\n\tcase RT5670_ASRC_3:\n\tcase RT5670_ASRC_4:\n\tcase RT5670_ASRC_5:\n\tcase RT5670_ASRC_7:\n\tcase RT5670_ASRC_8:\n\tcase RT5670_ASRC_9:\n\tcase RT5670_ASRC_10:\n\tcase RT5670_ASRC_11:\n\tcase RT5670_ASRC_12:\n\tcase RT5670_ASRC_13:\n\tcase RT5670_ASRC_14:\n\tcase RT5670_DEPOP_M1:\n\tcase RT5670_DEPOP_M2:\n\tcase RT5670_DEPOP_M3:\n\tcase RT5670_CHARGE_PUMP:\n\tcase RT5670_MICBIAS:\n\tcase RT5670_A_JD_CTRL1:\n\tcase RT5670_A_JD_CTRL2:\n\tcase RT5670_VAD_CTRL1:\n\tcase RT5670_VAD_CTRL2:\n\tcase RT5670_VAD_CTRL3:\n\tcase RT5670_VAD_CTRL4:\n\tcase RT5670_VAD_CTRL5:\n\tcase RT5670_ADC_EQ_CTRL1:\n\tcase RT5670_ADC_EQ_CTRL2:\n\tcase RT5670_EQ_CTRL1:\n\tcase RT5670_EQ_CTRL2:\n\tcase RT5670_ALC_DRC_CTRL1:\n\tcase RT5670_ALC_DRC_CTRL2:\n\tcase RT5670_ALC_CTRL_1:\n\tcase RT5670_ALC_CTRL_2:\n\tcase RT5670_ALC_CTRL_3:\n\tcase RT5670_JD_CTRL:\n\tcase RT5670_IRQ_CTRL1:\n\tcase RT5670_IRQ_CTRL2:\n\tcase RT5670_INT_IRQ_ST:\n\tcase RT5670_GPIO_CTRL1:\n\tcase RT5670_GPIO_CTRL2:\n\tcase RT5670_GPIO_CTRL3:\n\tcase RT5670_SCRABBLE_FUN:\n\tcase RT5670_SCRABBLE_CTRL:\n\tcase RT5670_BASE_BACK:\n\tcase RT5670_MP3_PLUS1:\n\tcase RT5670_MP3_PLUS2:\n\tcase RT5670_ADJ_HPF1:\n\tcase RT5670_ADJ_HPF2:\n\tcase RT5670_HP_CALIB_AMP_DET:\n\tcase RT5670_SV_ZCD1:\n\tcase RT5670_SV_ZCD2:\n\tcase RT5670_IL_CMD:\n\tcase RT5670_IL_CMD2:\n\tcase RT5670_IL_CMD3:\n\tcase RT5670_DRC_HL_CTRL1:\n\tcase RT5670_DRC_HL_CTRL2:\n\tcase RT5670_ADC_MONO_HP_CTRL1:\n\tcase RT5670_ADC_MONO_HP_CTRL2:\n\tcase RT5670_ADC_STO2_HP_CTRL1:\n\tcase RT5670_ADC_STO2_HP_CTRL2:\n\tcase RT5670_JD_CTRL3:\n\tcase RT5670_JD_CTRL4:\n\tcase RT5670_DIG_MISC:\n\tcase RT5670_DSP_CTRL1:\n\tcase RT5670_DSP_CTRL2:\n\tcase RT5670_DSP_CTRL3:\n\tcase RT5670_DSP_CTRL4:\n\tcase RT5670_DSP_CTRL5:\n\tcase RT5670_GEN_CTRL2:\n\tcase RT5670_GEN_CTRL3:\n\tcase RT5670_VENDOR_ID:\n\tcase RT5670_VENDOR_ID1:\n\tcase RT5670_VENDOR_ID2:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\n \n\nstatic int rt5670_headset_detect(struct snd_soc_component *component, int jack_insert)\n{\n\tint val;\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (jack_insert) {\n\t\tsnd_soc_dapm_force_enable_pin(dapm, \"Mic Det Power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t\tsnd_soc_component_update_bits(component, RT5670_GEN_CTRL3, 0x4, 0x0);\n\t\tsnd_soc_component_update_bits(component, RT5670_CJ_CTRL2,\n\t\t\tRT5670_CBJ_DET_MODE | RT5670_CBJ_MN_JD,\n\t\t\tRT5670_CBJ_MN_JD);\n\t\tsnd_soc_component_write(component, RT5670_GPIO_CTRL2, 0x0004);\n\t\tsnd_soc_component_update_bits(component, RT5670_GPIO_CTRL1,\n\t\t\tRT5670_GP1_PIN_MASK, RT5670_GP1_PIN_IRQ);\n\t\tsnd_soc_component_update_bits(component, RT5670_CJ_CTRL1,\n\t\t\tRT5670_CBJ_BST1_EN, RT5670_CBJ_BST1_EN);\n\t\tsnd_soc_component_write(component, RT5670_JD_CTRL3, 0x00f0);\n\t\tsnd_soc_component_update_bits(component, RT5670_CJ_CTRL2,\n\t\t\tRT5670_CBJ_MN_JD, RT5670_CBJ_MN_JD);\n\t\tsnd_soc_component_update_bits(component, RT5670_CJ_CTRL2,\n\t\t\tRT5670_CBJ_MN_JD, 0);\n\t\tmsleep(300);\n\t\tval = snd_soc_component_read(component, RT5670_CJ_CTRL3) & 0x7;\n\t\tif (val == 0x1 || val == 0x2) {\n\t\t\trt5670->jack_type = SND_JACK_HEADSET;\n\t\t\t \n\t\t\tsnd_soc_component_update_bits(component, RT5670_INT_IRQ_ST, 0x8, 0x8);\n\t\t\tsnd_soc_component_update_bits(component, RT5670_IL_CMD, 0x40, 0x40);\n\t\t\tsnd_soc_component_read(component, RT5670_IL_CMD);\n\t\t} else {\n\t\t\tsnd_soc_component_update_bits(component, RT5670_GEN_CTRL3, 0x4, 0x4);\n\t\t\trt5670->jack_type = SND_JACK_HEADPHONE;\n\t\t\tsnd_soc_dapm_disable_pin(dapm, \"Mic Det Power\");\n\t\t\tsnd_soc_dapm_sync(dapm);\n\t\t}\n\t} else {\n\t\tsnd_soc_component_update_bits(component, RT5670_INT_IRQ_ST, 0x8, 0x0);\n\t\tsnd_soc_component_update_bits(component, RT5670_GEN_CTRL3, 0x4, 0x4);\n\t\trt5670->jack_type = 0;\n\t\tsnd_soc_dapm_disable_pin(dapm, \"Mic Det Power\");\n\t\tsnd_soc_dapm_sync(dapm);\n\t}\n\n\treturn rt5670->jack_type;\n}\n\nvoid rt5670_jack_suspend(struct snd_soc_component *component)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\trt5670->jack_type_saved = rt5670->jack_type;\n\trt5670_headset_detect(component, 0);\n}\nEXPORT_SYMBOL_GPL(rt5670_jack_suspend);\n\nvoid rt5670_jack_resume(struct snd_soc_component *component)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (rt5670->jack_type_saved)\n\t\trt5670_headset_detect(component, 1);\n}\nEXPORT_SYMBOL_GPL(rt5670_jack_resume);\n\nstatic int rt5670_button_detect(struct snd_soc_component *component)\n{\n\tint btn_type, val;\n\n\tval = snd_soc_component_read(component, RT5670_IL_CMD);\n\tbtn_type = val & 0xff80;\n\tsnd_soc_component_write(component, RT5670_IL_CMD, val);\n\tif (btn_type != 0) {\n\t\tmsleep(20);\n\t\tval = snd_soc_component_read(component, RT5670_IL_CMD);\n\t\tsnd_soc_component_write(component, RT5670_IL_CMD, val);\n\t}\n\n\treturn btn_type;\n}\n\nstatic int rt5670_irq_detection(void *data)\n{\n\tstruct rt5670_priv *rt5670 = (struct rt5670_priv *)data;\n\tstruct snd_soc_jack_gpio *gpio = &rt5670->hp_gpio;\n\tstruct snd_soc_jack *jack = rt5670->jack;\n\tint val, btn_type, report = jack->status;\n\n\tif (rt5670->jd_mode == 1)  \n\t\tval = snd_soc_component_read(rt5670->component, RT5670_A_JD_CTRL1) & 0x0070;\n\telse\n\t\tval = snd_soc_component_read(rt5670->component, RT5670_A_JD_CTRL1) & 0x0020;\n\n\tswitch (val) {\n\t \n\tcase 0x30:  \n\tcase 0x0:  \n\t\tif (rt5670->jack_type == 0) {\n\t\t\treport = rt5670_headset_detect(rt5670->component, 1);\n\t\t\t \n\t\t\tgpio->debounce_time = 25;\n\t\t\tbreak;\n\t\t}\n\t\tbtn_type = 0;\n\t\tif (snd_soc_component_read(rt5670->component, RT5670_INT_IRQ_ST) & 0x4) {\n\t\t\t \n\t\t\treport = SND_JACK_HEADSET;\n\t\t\tbtn_type = rt5670_button_detect(rt5670->component);\n\t\t\tswitch (btn_type) {\n\t\t\tcase 0x2000:  \n\t\t\t\treport |= SND_JACK_BTN_1;\n\t\t\t\tbreak;\n\t\t\tcase 0x0400:  \n\t\t\t\treport |= SND_JACK_BTN_0;\n\t\t\t\tbreak;\n\t\t\tcase 0x0080:  \n\t\t\t\treport |= SND_JACK_BTN_2;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdev_err(rt5670->component->dev,\n\t\t\t\t\t\"Unexpected button code 0x%04x\\n\",\n\t\t\t\t\tbtn_type);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (btn_type == 0) \n\t\t\treport =  rt5670->jack_type;\n\n\t\tbreak;\n\t \n\tcase 0x70:  \n\tcase 0x10:  \n\tcase 0x20:  \n\t\treport = 0;\n\t\tsnd_soc_component_update_bits(rt5670->component, RT5670_INT_IRQ_ST, 0x1, 0x0);\n\t\trt5670_headset_detect(rt5670->component, 0);\n\t\tgpio->debounce_time = 150;  \n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn report;\n}\n\nint rt5670_set_jack_detect(struct snd_soc_component *component,\n\tstruct snd_soc_jack *jack)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tint ret;\n\n\trt5670->jack = jack;\n\trt5670->hp_gpio.gpiod_dev = component->dev;\n\trt5670->hp_gpio.name = \"headset\";\n\trt5670->hp_gpio.report = SND_JACK_HEADSET |\n\t\tSND_JACK_BTN_0 | SND_JACK_BTN_1 | SND_JACK_BTN_2;\n\trt5670->hp_gpio.debounce_time = 150;\n\trt5670->hp_gpio.wake = true;\n\trt5670->hp_gpio.data = (struct rt5670_priv *)rt5670;\n\trt5670->hp_gpio.jack_status_check = rt5670_irq_detection;\n\n\tret = snd_soc_jack_add_gpios(rt5670->jack, 1,\n\t\t\t&rt5670->hp_gpio);\n\tif (ret) {\n\t\tdev_err(component->dev, \"Adding jack GPIO failed\\n\");\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(rt5670_set_jack_detect);\n\nstatic const DECLARE_TLV_DB_SCALE(out_vol_tlv, -4650, 150, 0);\nstatic const DECLARE_TLV_DB_MINMAX(dac_vol_tlv, -6562, 0);\nstatic const DECLARE_TLV_DB_SCALE(in_vol_tlv, -3450, 150, 0);\nstatic const DECLARE_TLV_DB_MINMAX(adc_vol_tlv, -1762, 3000);\nstatic const DECLARE_TLV_DB_SCALE(adc_bst_tlv, 0, 1200, 0);\n\n \nstatic const DECLARE_TLV_DB_RANGE(bst_tlv,\n\t0, 0, TLV_DB_SCALE_ITEM(0, 0, 0),\n\t1, 1, TLV_DB_SCALE_ITEM(2000, 0, 0),\n\t2, 2, TLV_DB_SCALE_ITEM(2400, 0, 0),\n\t3, 5, TLV_DB_SCALE_ITEM(3000, 500, 0),\n\t6, 6, TLV_DB_SCALE_ITEM(4400, 0, 0),\n\t7, 7, TLV_DB_SCALE_ITEM(5000, 0, 0),\n\t8, 8, TLV_DB_SCALE_ITEM(5200, 0, 0)\n);\n\n \nstatic const char * const rt5670_data_select[] = {\n\t\"Normal\", \"Swap\", \"left copy to right\", \"right copy to left\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if2_dac_enum, RT5670_DIG_INF1_DATA,\n\t\t\t\tRT5670_IF2_DAC_SEL_SFT, rt5670_data_select);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if2_adc_enum, RT5670_DIG_INF1_DATA,\n\t\t\t\tRT5670_IF2_ADC_SEL_SFT, rt5670_data_select);\n\n \nstatic void rt5670_update_ad_da_mixer_dac1_m_bits(struct rt5670_priv *rt5670)\n{\n\tint val = RT5670_M_DAC1_L | RT5670_M_DAC1_R;\n\n\tif (rt5670->dac1_mixl_dac1_switch && rt5670->dac1_playback_switch_l)\n\t\tval &= ~RT5670_M_DAC1_L;\n\n\tif (rt5670->dac1_mixr_dac1_switch && rt5670->dac1_playback_switch_r)\n\t\tval &= ~RT5670_M_DAC1_R;\n\n\tregmap_update_bits(rt5670->regmap, RT5670_AD_DA_MIXER,\n\t\t\t   RT5670_M_DAC1_L | RT5670_M_DAC1_R, val);\n}\n\nstatic int rt5670_dac1_playback_switch_get(struct snd_kcontrol *kcontrol,\n\t\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tucontrol->value.integer.value[0] = rt5670->dac1_playback_switch_l;\n\tucontrol->value.integer.value[1] = rt5670->dac1_playback_switch_r;\n\n\treturn 0;\n}\n\nstatic int rt5670_dac1_playback_switch_put(struct snd_kcontrol *kcontrol,\n\t\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct snd_soc_component *component = snd_soc_kcontrol_component(kcontrol);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (rt5670->dac1_playback_switch_l == ucontrol->value.integer.value[0] &&\n\t    rt5670->dac1_playback_switch_r == ucontrol->value.integer.value[1])\n\t\treturn 0;\n\n\trt5670->dac1_playback_switch_l = ucontrol->value.integer.value[0];\n\trt5670->dac1_playback_switch_r = ucontrol->value.integer.value[1];\n\n\trt5670_update_ad_da_mixer_dac1_m_bits(rt5670);\n\n\treturn 1;\n}\n\nstatic const struct snd_kcontrol_new rt5670_snd_controls[] = {\n\t \n\tSOC_DOUBLE_TLV(\"HP Playback Volume\", RT5670_HP_VOL,\n\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT,\n\t\t39, 1, out_vol_tlv),\n\t \n\tSOC_DOUBLE_TLV(\"OUT Playback Volume\", RT5670_LOUT1,\n\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT, 39, 1, out_vol_tlv),\n\t \n\tSOC_DOUBLE(\"DAC2 Playback Switch\", RT5670_DAC_CTRL,\n\t\tRT5670_M_DAC_L2_VOL_SFT, RT5670_M_DAC_R2_VOL_SFT, 1, 1),\n\tSOC_DOUBLE_EXT(\"DAC1 Playback Switch\", SND_SOC_NOPM, 0, 1, 1, 0,\n\t\t\trt5670_dac1_playback_switch_get, rt5670_dac1_playback_switch_put),\n\tSOC_DOUBLE_TLV(\"DAC1 Playback Volume\", RT5670_DAC1_DIG_VOL,\n\t\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT,\n\t\t\t175, 0, dac_vol_tlv),\n\tSOC_DOUBLE_TLV(\"Mono DAC Playback Volume\", RT5670_DAC2_DIG_VOL,\n\t\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT,\n\t\t\t175, 0, dac_vol_tlv),\n\t \n\tSOC_SINGLE_TLV(\"IN1 Boost Volume\", RT5670_CJ_CTRL1,\n\t\tRT5670_BST_SFT1, 8, 0, bst_tlv),\n\tSOC_SINGLE_TLV(\"IN2 Boost Volume\", RT5670_IN2,\n\t\tRT5670_BST_SFT1, 8, 0, bst_tlv),\n\t \n\tSOC_DOUBLE_TLV(\"IN Capture Volume\", RT5670_INL1_INR1_VOL,\n\t\t\tRT5670_INL_VOL_SFT, RT5670_INR_VOL_SFT,\n\t\t\t31, 1, in_vol_tlv),\n\t \n\tSOC_DOUBLE(\"ADC Capture Switch\", RT5670_STO1_ADC_DIG_VOL,\n\t\tRT5670_L_MUTE_SFT, RT5670_R_MUTE_SFT, 1, 1),\n\tSOC_DOUBLE_TLV(\"ADC Capture Volume\", RT5670_STO1_ADC_DIG_VOL,\n\t\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT,\n\t\t\t127, 0, adc_vol_tlv),\n\n\tSOC_DOUBLE_TLV(\"Mono ADC Capture Volume\", RT5670_MONO_ADC_DIG_VOL,\n\t\t\tRT5670_L_VOL_SFT, RT5670_R_VOL_SFT,\n\t\t\t127, 0, adc_vol_tlv),\n\n\t \n\tSOC_DOUBLE_TLV(\"STO1 ADC Boost Gain Volume\", RT5670_ADC_BST_VOL1,\n\t\t\tRT5670_STO1_ADC_L_BST_SFT, RT5670_STO1_ADC_R_BST_SFT,\n\t\t\t3, 0, adc_bst_tlv),\n\n\tSOC_DOUBLE_TLV(\"STO2 ADC Boost Gain Volume\", RT5670_ADC_BST_VOL1,\n\t\t\tRT5670_STO2_ADC_L_BST_SFT, RT5670_STO2_ADC_R_BST_SFT,\n\t\t\t3, 0, adc_bst_tlv),\n\n\tSOC_ENUM(\"ADC IF2 Data Switch\", rt5670_if2_adc_enum),\n\tSOC_ENUM(\"DAC IF2 Data Switch\", rt5670_if2_dac_enum),\n};\n\n \nstatic int set_dmic_clk(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tint idx, rate;\n\n\trate = rt5670->sysclk / rl6231_get_pre_div(rt5670->regmap,\n\t\tRT5670_ADDA_CLK1, RT5670_I2S_PD1_SFT);\n\tidx = rl6231_calc_dmic_clk(rate);\n\tif (idx < 0)\n\t\tdev_err(component->dev, \"Failed to set DMIC clock\\n\");\n\telse\n\t\tsnd_soc_component_update_bits(component, RT5670_DMIC_CTRL1,\n\t\t\tRT5670_DMIC_CLK_MASK, idx << RT5670_DMIC_CLK_SFT);\n\treturn idx;\n}\n\nstatic int is_sys_clk_from_pll(struct snd_soc_dapm_widget *source,\n\t\t\t struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(source->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (rt5670->sysclk_src == RT5670_SCLK_S_PLL1)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nstatic int is_using_asrc(struct snd_soc_dapm_widget *source,\n\t\t\t struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(source->dapm);\n\tunsigned int reg, shift, val;\n\n\tswitch (source->shift) {\n\tcase 0:\n\t\treg = RT5670_ASRC_3;\n\t\tshift = 0;\n\t\tbreak;\n\tcase 1:\n\t\treg = RT5670_ASRC_3;\n\t\tshift = 4;\n\t\tbreak;\n\tcase 2:\n\t\treg = RT5670_ASRC_5;\n\t\tshift = 12;\n\t\tbreak;\n\tcase 3:\n\t\treg = RT5670_ASRC_2;\n\t\tshift = 0;\n\t\tbreak;\n\tcase 8:\n\t\treg = RT5670_ASRC_2;\n\t\tshift = 4;\n\t\tbreak;\n\tcase 9:\n\t\treg = RT5670_ASRC_2;\n\t\tshift = 8;\n\t\tbreak;\n\tcase 10:\n\t\treg = RT5670_ASRC_2;\n\t\tshift = 12;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tval = (snd_soc_component_read(component, reg) >> shift) & 0xf;\n\tswitch (val) {\n\tcase 1:\n\tcase 2:\n\tcase 3:\n\tcase 4:\n\t\treturn 1;\n\tdefault:\n\t\treturn 0;\n\t}\n\n}\n\nstatic int can_use_asrc(struct snd_soc_dapm_widget *source,\n\t\t\t struct snd_soc_dapm_widget *sink)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(source->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (rt5670->sysclk > rt5670->lrck[RT5670_AIF1] * 384)\n\t\treturn 1;\n\n\treturn 0;\n}\n\n\n \nint rt5670_sel_asrc_clk_src(struct snd_soc_component *component,\n\t\t\t    unsigned int filter_mask, unsigned int clk_src)\n{\n\tunsigned int asrc2_mask = 0, asrc2_value = 0;\n\tunsigned int asrc3_mask = 0, asrc3_value = 0;\n\n\tif (clk_src > RT5670_CLK_SEL_SYS3)\n\t\treturn -EINVAL;\n\n\tif (filter_mask & RT5670_DA_STEREO_FILTER) {\n\t\tasrc2_mask |= RT5670_DA_STO_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5670_DA_STO_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_DA_STO_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_DA_MONO_L_FILTER) {\n\t\tasrc2_mask |= RT5670_DA_MONOL_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5670_DA_MONOL_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_DA_MONOL_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_DA_MONO_R_FILTER) {\n\t\tasrc2_mask |= RT5670_DA_MONOR_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5670_DA_MONOR_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_DA_MONOR_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_AD_STEREO_FILTER) {\n\t\tasrc2_mask |= RT5670_AD_STO1_CLK_SEL_MASK;\n\t\tasrc2_value = (asrc2_value & ~RT5670_AD_STO1_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_AD_STO1_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_AD_MONO_L_FILTER) {\n\t\tasrc3_mask |= RT5670_AD_MONOL_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5670_AD_MONOL_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_AD_MONOL_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_AD_MONO_R_FILTER)  {\n\t\tasrc3_mask |= RT5670_AD_MONOR_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5670_AD_MONOR_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_AD_MONOR_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_UP_RATE_FILTER) {\n\t\tasrc3_mask |= RT5670_UP_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5670_UP_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_UP_CLK_SEL_SFT);\n\t}\n\n\tif (filter_mask & RT5670_DOWN_RATE_FILTER) {\n\t\tasrc3_mask |= RT5670_DOWN_CLK_SEL_MASK;\n\t\tasrc3_value = (asrc3_value & ~RT5670_DOWN_CLK_SEL_MASK)\n\t\t\t\t| (clk_src <<  RT5670_DOWN_CLK_SEL_SFT);\n\t}\n\n\tif (asrc2_mask)\n\t\tsnd_soc_component_update_bits(component, RT5670_ASRC_2,\n\t\t\t\t    asrc2_mask, asrc2_value);\n\n\tif (asrc3_mask)\n\t\tsnd_soc_component_update_bits(component, RT5670_ASRC_3,\n\t\t\t\t    asrc3_mask, asrc3_value);\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(rt5670_sel_asrc_clk_src);\n\n \nstatic const struct snd_kcontrol_new rt5670_sto1_adc_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_STO1_ADC_MIXER,\n\t\t\tRT5670_M_ADC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_STO1_ADC_MIXER,\n\t\t\tRT5670_M_ADC_L2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_sto1_adc_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_STO1_ADC_MIXER,\n\t\t\tRT5670_M_ADC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_STO1_ADC_MIXER,\n\t\t\tRT5670_M_ADC_R2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_sto2_adc_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_STO2_ADC_MIXER,\n\t\t\tRT5670_M_ADC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_STO2_ADC_MIXER,\n\t\t\tRT5670_M_ADC_L2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_sto2_adc_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_STO2_ADC_MIXER,\n\t\t\tRT5670_M_ADC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_STO2_ADC_MIXER,\n\t\t\tRT5670_M_ADC_R2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_MONO_ADC_MIXER,\n\t\t\tRT5670_M_MONO_ADC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_MONO_ADC_MIXER,\n\t\t\tRT5670_M_MONO_ADC_L2_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"ADC1 Switch\", RT5670_MONO_ADC_MIXER,\n\t\t\tRT5670_M_MONO_ADC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"ADC2 Switch\", RT5670_MONO_ADC_MIXER,\n\t\t\tRT5670_M_MONO_ADC_R2_SFT, 1, 1),\n};\n\n \nstatic int rt5670_put_dac1_mix_dac1_switch(struct snd_kcontrol *kcontrol,\n\t\t\t\t\t   struct snd_ctl_elem_value *ucontrol)\n{\n\tstruct soc_mixer_control *mc = (struct soc_mixer_control *)kcontrol->private_value;\n\tstruct snd_soc_component *component = snd_soc_dapm_kcontrol_component(kcontrol);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tint ret;\n\n\tif (mc->shift == 0)\n\t\trt5670->dac1_mixl_dac1_switch = ucontrol->value.integer.value[0];\n\telse\n\t\trt5670->dac1_mixr_dac1_switch = ucontrol->value.integer.value[0];\n\n\t \n\tret = snd_soc_dapm_put_volsw(kcontrol, ucontrol);\n\tif (ret == 0)\n\t\treturn 0;\n\n\trt5670_update_ad_da_mixer_dac1_m_bits(rt5670);\n\n\treturn 1;\n}\n\n#define SOC_DAPM_SINGLE_RT5670_DAC1_SW(name, shift) \\\n\tSOC_SINGLE_EXT(name, SND_SOC_NOPM, shift, 1, 0, \\\n\t\t       snd_soc_dapm_get_volsw, rt5670_put_dac1_mix_dac1_switch)\n\nstatic const struct snd_kcontrol_new rt5670_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"Stereo ADC Switch\", RT5670_AD_DA_MIXER,\n\t\t\tRT5670_M_ADCMIX_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE_RT5670_DAC1_SW(\"DAC1 Switch\", 0),\n};\n\nstatic const struct snd_kcontrol_new rt5670_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"Stereo ADC Switch\", RT5670_AD_DA_MIXER,\n\t\t\tRT5670_M_ADCMIX_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE_RT5670_DAC1_SW(\"DAC1 Switch\", 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_sto_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_L1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_L2_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_R1_STO_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_sto_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_R1_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_R2_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5670_STO_DAC_MIXER,\n\t\t\tRT5670_M_DAC_L1_STO_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_mono_dac_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_L1_MONO_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_L2_MONO_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_R2_MONO_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_mono_dac_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_R1_MONO_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_R2_MONO_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_DD_MIXER,\n\t\t\tRT5670_M_DAC_L2_MONO_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_dig_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"Sto DAC Mix L Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_STO_L_DAC_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_DAC_L2_DAC_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_DAC_R2_DAC_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_dig_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"Sto DAC Mix R Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_STO_R_DAC_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_DAC_R2_DAC_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_DIG_MIXER,\n\t\t\tRT5670_M_DAC_L2_DAC_R_SFT, 1, 1),\n};\n\n \nstatic const struct snd_kcontrol_new rt5670_rec_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5670_REC_L2_MIXER,\n\t\t\tRT5670_M_IN_L_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5670_REC_L2_MIXER,\n\t\t\tRT5670_M_BST2_RM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5670_REC_L2_MIXER,\n\t\t\tRT5670_M_BST1_RM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_rec_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5670_REC_R2_MIXER,\n\t\t\tRT5670_M_IN_R_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5670_REC_R2_MIXER,\n\t\t\tRT5670_M_BST2_RM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5670_REC_R2_MIXER,\n\t\t\tRT5670_M_BST1_RM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_out_l_mix[] = {\n\tSOC_DAPM_SINGLE(\"BST1 Switch\", RT5670_OUT_L1_MIXER,\n\t\t\tRT5670_M_BST1_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5670_OUT_L1_MIXER,\n\t\t\tRT5670_M_IN_L_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L2 Switch\", RT5670_OUT_L1_MIXER,\n\t\t\tRT5670_M_DAC_L2_OM_L_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5670_OUT_L1_MIXER,\n\t\t\tRT5670_M_DAC_L1_OM_L_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_out_r_mix[] = {\n\tSOC_DAPM_SINGLE(\"BST2 Switch\", RT5670_OUT_R1_MIXER,\n\t\t\tRT5670_M_BST2_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5670_OUT_R1_MIXER,\n\t\t\tRT5670_M_IN_R_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R2 Switch\", RT5670_OUT_R1_MIXER,\n\t\t\tRT5670_M_DAC_R2_OM_R_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5670_OUT_R1_MIXER,\n\t\t\tRT5670_M_DAC_R1_OM_R_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_hpo_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_DAC1_HM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"HPVOL Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_HPVOL_HM_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_hpvoll_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_DACL1_HML_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INL Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_INL1_HML_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_hpvolr_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC1 Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_DACR1_HMR_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"INR Switch\", RT5670_HPO_MIXER,\n\t\t\tRT5670_M_INR1_HMR_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new rt5670_lout_mix[] = {\n\tSOC_DAPM_SINGLE(\"DAC L1 Switch\", RT5670_LOUT_MIXER,\n\t\t\tRT5670_M_DAC_L1_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"DAC R1 Switch\", RT5670_LOUT_MIXER,\n\t\t\tRT5670_M_DAC_R1_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUTMIX L Switch\", RT5670_LOUT_MIXER,\n\t\t\tRT5670_M_OV_L_LM_SFT, 1, 1),\n\tSOC_DAPM_SINGLE(\"OUTMIX R Switch\", RT5670_LOUT_MIXER,\n\t\t\tRT5670_M_OV_R_LM_SFT, 1, 1),\n};\n\nstatic const struct snd_kcontrol_new lout_l_enable_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5670_LOUT1,\n\t\tRT5670_L_MUTE_SFT, 1, 1);\n\nstatic const struct snd_kcontrol_new lout_r_enable_control =\n\tSOC_DAPM_SINGLE_AUTODISABLE(\"Switch\", RT5670_LOUT1,\n\t\tRT5670_R_MUTE_SFT, 1, 1);\n\n   \nstatic const char * const rt5670_dac1_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dac1l_enum, RT5670_AD_DA_MIXER,\n\tRT5670_DAC1_L_SEL_SFT, rt5670_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5670_dac1l_mux =\n\tSOC_DAPM_ENUM(\"DAC1 L source\", rt5670_dac1l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dac1r_enum, RT5670_AD_DA_MIXER,\n\tRT5670_DAC1_R_SEL_SFT, rt5670_dac1_src);\n\nstatic const struct snd_kcontrol_new rt5670_dac1r_mux =\n\tSOC_DAPM_ENUM(\"DAC1 R source\", rt5670_dac1r_enum);\n\n   \n \nstatic const char * const rt5670_dac12_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\", \"IF3 DAC\", \"TxDC DAC\",\n\t\"Bass\", \"VAD_ADC\", \"IF4 DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dac2l_enum, RT5670_DAC_CTRL,\n\tRT5670_DAC2_L_SEL_SFT, rt5670_dac12_src);\n\nstatic const struct snd_kcontrol_new rt5670_dac_l2_mux =\n\tSOC_DAPM_ENUM(\"DAC2 L source\", rt5670_dac2l_enum);\n\nstatic const char * const rt5670_dacr2_src[] = {\n\t\"IF1 DAC\", \"IF2 DAC\", \"IF3 DAC\", \"TxDC DAC\", \"TxDP ADC\", \"IF4 DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dac2r_enum, RT5670_DAC_CTRL,\n\tRT5670_DAC2_R_SEL_SFT, rt5670_dacr2_src);\n\nstatic const struct snd_kcontrol_new rt5670_dac_r2_mux =\n\tSOC_DAPM_ENUM(\"DAC2 R source\", rt5670_dac2r_enum);\n\n   \nstatic const char * const rt5670_rxdp_src[] = {\n\t\"IF2 DAC\", \"IF1 DAC\", \"STO1 ADC Mixer\", \"STO2 ADC Mixer\",\n\t\"Mono ADC Mixer L\", \"Mono ADC Mixer R\", \"DAC1\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_rxdp_enum, RT5670_DSP_PATH1,\n\tRT5670_RXDP_SEL_SFT, rt5670_rxdp_src);\n\nstatic const struct snd_kcontrol_new rt5670_rxdp_mux =\n\tSOC_DAPM_ENUM(\"DAC2 L source\", rt5670_rxdp_enum);\n\n \nstatic const char * const rt5670_dsp_bypass_src[] = {\n\t\"DSP\", \"Bypass\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dsp_ul_enum, RT5670_DSP_PATH1,\n\tRT5670_DSP_UL_SFT, rt5670_dsp_bypass_src);\n\nstatic const struct snd_kcontrol_new rt5670_dsp_ul_mux =\n\tSOC_DAPM_ENUM(\"DSP UL source\", rt5670_dsp_ul_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_dsp_dl_enum, RT5670_DSP_PATH1,\n\tRT5670_DSP_DL_SFT, rt5670_dsp_bypass_src);\n\nstatic const struct snd_kcontrol_new rt5670_dsp_dl_mux =\n\tSOC_DAPM_ENUM(\"DSP DL source\", rt5670_dsp_dl_enum);\n\n \n \nstatic const char * const rt5670_stereo2_adc_lr_src[] = {\n\t\"L\", \"LR\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo2_adc_lr_enum, RT5670_STO2_ADC_MIXER,\n\tRT5670_STO2_ADC_SRC_SFT, rt5670_stereo2_adc_lr_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto2_adc_lr_mux =\n\tSOC_DAPM_ENUM(\"Stereo2 ADC LR source\", rt5670_stereo2_adc_lr_enum);\n\n \n \nstatic const char * const rt5670_stereo_adc1_src[] = {\n\t\"DAC MIX\", \"ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo1_adc1_enum, RT5670_STO1_ADC_MIXER,\n\tRT5670_ADC_1_SRC_SFT, rt5670_stereo_adc1_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto_adc_1_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 ADC 1 Mux\", rt5670_stereo1_adc1_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo2_adc1_enum, RT5670_STO2_ADC_MIXER,\n\tRT5670_ADC_1_SRC_SFT, rt5670_stereo_adc1_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto2_adc_1_mux =\n\tSOC_DAPM_ENUM(\"Stereo2 ADC 1 Mux\", rt5670_stereo2_adc1_enum);\n\n\n \nstatic const char * const rt5670_stereo_adc2_src[] = {\n\t\"DAC MIX\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo1_adc2_enum, RT5670_STO1_ADC_MIXER,\n\tRT5670_ADC_2_SRC_SFT, rt5670_stereo_adc2_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto_adc_2_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 ADC 2 Mux\", rt5670_stereo1_adc2_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo2_adc2_enum, RT5670_STO2_ADC_MIXER,\n\tRT5670_ADC_2_SRC_SFT, rt5670_stereo_adc2_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto2_adc_2_mux =\n\tSOC_DAPM_ENUM(\"Stereo2 ADC 2 Mux\", rt5670_stereo2_adc2_enum);\n\n \nstatic const char * const rt5670_stereo_dmic_src[] = {\n\t\"DMIC1\", \"DMIC2\", \"DMIC3\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo1_dmic_enum, RT5670_STO1_ADC_MIXER,\n\tRT5670_DMIC_SRC_SFT, rt5670_stereo_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto1_dmic_mux =\n\tSOC_DAPM_ENUM(\"Stereo1 DMIC source\", rt5670_stereo1_dmic_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_stereo2_dmic_enum, RT5670_STO2_ADC_MIXER,\n\tRT5670_DMIC_SRC_SFT, rt5670_stereo_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5670_sto2_dmic_mux =\n\tSOC_DAPM_ENUM(\"Stereo2 DMIC source\", rt5670_stereo2_dmic_enum);\n\n \n \nstatic const char * const rt5670_mono_adc_l1_src[] = {\n\t\"Mono DAC MIXL\", \"ADC1\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_adc_l1_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_ADC_L1_SRC_SFT, rt5670_mono_adc_l1_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_l1_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC1 left source\", rt5670_mono_adc_l1_enum);\n \nstatic const char * const rt5670_mono_adc_l2_src[] = {\n\t\"Mono DAC MIXL\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_adc_l2_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_ADC_L2_SRC_SFT, rt5670_mono_adc_l2_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_l2_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC2 left source\", rt5670_mono_adc_l2_enum);\n\n \nstatic const char * const rt5670_mono_dmic_src[] = {\n\t\"DMIC1\", \"DMIC2\", \"DMIC3\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_dmic_l_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_DMIC_L_SRC_SFT, rt5670_mono_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_dmic_l_mux =\n\tSOC_DAPM_ENUM(\"Mono DMIC left source\", rt5670_mono_dmic_l_enum);\n \nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_dmic_r_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_DMIC_R_SRC_SFT, rt5670_mono_dmic_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_dmic_r_mux =\n\tSOC_DAPM_ENUM(\"Mono DMIC Right source\", rt5670_mono_dmic_r_enum);\n \nstatic const char * const rt5670_mono_adc_r1_src[] = {\n\t\"Mono DAC MIXR\", \"ADC2\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_adc_r1_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_ADC_R1_SRC_SFT, rt5670_mono_adc_r1_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_r1_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC1 right source\", rt5670_mono_adc_r1_enum);\n \nstatic const char * const rt5670_mono_adc_r2_src[] = {\n\t\"Mono DAC MIXR\", \"DMIC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_mono_adc_r2_enum, RT5670_MONO_ADC_MIXER,\n\tRT5670_MONO_ADC_R2_SRC_SFT, rt5670_mono_adc_r2_src);\n\nstatic const struct snd_kcontrol_new rt5670_mono_adc_r2_mux =\n\tSOC_DAPM_ENUM(\"Mono ADC2 right source\", rt5670_mono_adc_r2_enum);\n\n \nstatic const char * const rt5670_txdp_slot_src[] = {\n\t\"Slot 0-1\", \"Slot 2-3\", \"Slot 4-5\", \"Slot 6-7\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_txdp_slot_enum, RT5670_DSP_PATH1,\n\tRT5670_TXDP_SLOT_SEL_SFT, rt5670_txdp_slot_src);\n\nstatic const struct snd_kcontrol_new rt5670_txdp_slot_mux =\n\tSOC_DAPM_ENUM(\"TxDP Slot source\", rt5670_txdp_slot_enum);\n\n \nstatic const char * const rt5670_if1_adc2_in_src[] = {\n\t\"IF_ADC2\", \"VAD_ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if1_adc2_in_enum, RT5670_DIG_INF1_DATA,\n\tRT5670_IF1_ADC2_IN_SFT, rt5670_if1_adc2_in_src);\n\nstatic const struct snd_kcontrol_new rt5670_if1_adc2_in_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC2 IN source\", rt5670_if1_adc2_in_enum);\n\n \nstatic const char * const rt5670_if2_adc_in_src[] = {\n\t\"IF_ADC1\", \"IF_ADC2\", \"IF_ADC3\", \"TxDC_DAC\", \"TxDP_ADC\", \"VAD_ADC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if2_adc_in_enum, RT5670_DIG_INF1_DATA,\n\tRT5670_IF2_ADC_IN_SFT, rt5670_if2_adc_in_src);\n\nstatic const struct snd_kcontrol_new rt5670_if2_adc_in_mux =\n\tSOC_DAPM_ENUM(\"IF2 ADC IN source\", rt5670_if2_adc_in_enum);\n\n \nstatic const char * const rt5670_pdm_src[] = {\n\t\"Mono DAC\", \"Stereo DAC\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_pdm1_l_enum, RT5670_PDM_OUT_CTRL,\n\tRT5670_PDM1_L_SFT, rt5670_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5670_pdm1_l_mux =\n\tSOC_DAPM_ENUM(\"PDM1 L source\", rt5670_pdm1_l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_pdm1_r_enum, RT5670_PDM_OUT_CTRL,\n\tRT5670_PDM1_R_SFT, rt5670_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5670_pdm1_r_mux =\n\tSOC_DAPM_ENUM(\"PDM1 R source\", rt5670_pdm1_r_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_pdm2_l_enum, RT5670_PDM_OUT_CTRL,\n\tRT5670_PDM2_L_SFT, rt5670_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5670_pdm2_l_mux =\n\tSOC_DAPM_ENUM(\"PDM2 L source\", rt5670_pdm2_l_enum);\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_pdm2_r_enum, RT5670_PDM_OUT_CTRL,\n\tRT5670_PDM2_R_SFT, rt5670_pdm_src);\n\nstatic const struct snd_kcontrol_new rt5670_pdm2_r_mux =\n\tSOC_DAPM_ENUM(\"PDM2 R source\", rt5670_pdm2_r_enum);\n\n \nstatic const char * const rt5670_if1_adc1_in1_src[] = {\n\t\"IF_ADC1\", \"IF1_ADC3\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if1_adc1_in1_enum, RT5670_DIG_MISC,\n\tRT5670_IF1_ADC1_IN1_SFT, rt5670_if1_adc1_in1_src);\n\nstatic const struct snd_kcontrol_new rt5670_if1_adc1_in1_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC1 IN1 source\", rt5670_if1_adc1_in1_enum);\n\n \nstatic const char * const rt5670_if1_adc1_in2_src[] = {\n\t\"IF1_ADC1_IN1\", \"IF1_ADC4\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if1_adc1_in2_enum, RT5670_DIG_MISC,\n\tRT5670_IF1_ADC1_IN2_SFT, rt5670_if1_adc1_in2_src);\n\nstatic const struct snd_kcontrol_new rt5670_if1_adc1_in2_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC1 IN2 source\", rt5670_if1_adc1_in2_enum);\n\n \nstatic const char * const rt5670_if1_adc2_in1_src[] = {\n\t\"IF1_ADC2_IN\", \"IF1_ADC4\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_if1_adc2_in1_enum, RT5670_DIG_MISC,\n\tRT5670_IF1_ADC2_IN1_SFT, rt5670_if1_adc2_in1_src);\n\nstatic const struct snd_kcontrol_new rt5670_if1_adc2_in1_mux =\n\tSOC_DAPM_ENUM(\"IF1 ADC2 IN1 source\", rt5670_if1_adc2_in1_enum);\n\n \nstatic const char * const rt5670_vad_adc_src[] = {\n\t\"Sto1 ADC L\", \"Mono ADC L\", \"Mono ADC R\", \"Sto2 ADC L\"\n};\n\nstatic SOC_ENUM_SINGLE_DECL(rt5670_vad_adc_enum, RT5670_VAD_CTRL4,\n\tRT5670_VAD_SEL_SFT, rt5670_vad_adc_src);\n\nstatic const struct snd_kcontrol_new rt5670_vad_adc_mux =\n\tSOC_DAPM_ENUM(\"VAD ADC source\", rt5670_vad_adc_enum);\n\nstatic int rt5670_hp_power_event(struct snd_soc_dapm_widget *w,\n\t\t\t   struct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tregmap_update_bits(rt5670->regmap, RT5670_CHARGE_PUMP,\n\t\t\tRT5670_PM_HP_MASK, RT5670_PM_HP_HV);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GEN_CTRL2,\n\t\t\t0x0400, 0x0400);\n\t\t \n\t\tregmap_update_bits(rt5670->regmap, RT5670_PWR_ANLG1,\n\t\t\tRT5670_PWR_HA |\tRT5670_PWR_FV1 |\n\t\t\tRT5670_PWR_FV2,\tRT5670_PWR_HA |\n\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2);\n\t\t \n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M2, 0x3100);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x8009);\n\t\tregmap_write(rt5670->regmap, RT5670_PR_BASE +\n\t\t\tRT5670_HP_DCC_INT1, 0x9f00);\n\t\tmdelay(20);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x8019);\n\t\tbreak;\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x0004);\n\t\tmsleep(30);\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_hp_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\t \n\t\tregmap_write(rt5670->regmap, RT5670_PR_BASE +\n\t\t\t\tRT5670_MAMP_INT_REG2, 0xb400);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M3, 0x0772);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x805d);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x831d);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GEN_CTRL2,\n\t\t\t\t0x0300, 0x0300);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_HP_VOL,\n\t\t\tRT5670_L_MUTE | RT5670_R_MUTE, 0);\n\t\tmsleep(80);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x8019);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\t \n\t\tregmap_write(rt5670->regmap, RT5670_PR_BASE +\n\t\t\t\tRT5670_MAMP_INT_REG2, 0xb400);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M3, 0x0772);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x803d);\n\t\tmdelay(10);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x831d);\n\t\tmdelay(10);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_HP_VOL,\n\t\t\t\t   RT5670_L_MUTE | RT5670_R_MUTE,\n\t\t\t\t   RT5670_L_MUTE | RT5670_R_MUTE);\n\t\tmsleep(20);\n\t\tregmap_update_bits(rt5670->regmap,\n\t\t\t\t   RT5670_GEN_CTRL2, 0x0300, 0x0);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M1, 0x8019);\n\t\tregmap_write(rt5670->regmap, RT5670_DEPOP_M3, 0x0707);\n\t\tregmap_write(rt5670->regmap, RT5670_PR_BASE +\n\t\t\t\tRT5670_MAMP_INT_REG2, 0xfc00);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_spk_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tif (!rt5670->gpio1_is_ext_spk_en)\n\t\treturn 0;\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL2,\n\t\t\t\t   RT5670_GP1_OUT_MASK, RT5670_GP1_OUT_HI);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL2,\n\t\t\t\t   RT5670_GP1_OUT_MASK, RT5670_GP1_OUT_LO);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_bst1_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG2,\n\t\t\t\t    RT5670_PWR_BST1_P, RT5670_PWR_BST1_P);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG2,\n\t\t\t\t    RT5670_PWR_BST1_P, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_bst2_event(struct snd_soc_dapm_widget *w,\n\tstruct snd_kcontrol *kcontrol, int event)\n{\n\tstruct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);\n\n\tswitch (event) {\n\tcase SND_SOC_DAPM_POST_PMU:\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG2,\n\t\t\t\t    RT5670_PWR_BST2_P, RT5670_PWR_BST2_P);\n\t\tbreak;\n\n\tcase SND_SOC_DAPM_PRE_PMD:\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG2,\n\t\t\t\t    RT5670_PWR_BST2_P, 0);\n\t\tbreak;\n\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct snd_soc_dapm_widget rt5670_dapm_widgets[] = {\n\tSND_SOC_DAPM_SUPPLY(\"PLL1\", RT5670_PWR_ANLG2,\n\t\t\t    RT5670_PWR_PLL_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"I2S DSP\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_I2S_DSP_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"Mic Det Power\", RT5670_PWR_VOL,\n\t\t\t    RT5670_PWR_MIC_DET_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY_S(\"I2S1 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      11, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"I2S2 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      12, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC STO ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      10, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC MONO L ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      9, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DAC MONO R ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      8, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC STO1 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      7, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC STO2 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      6, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC MONO L ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      5, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"DMIC MONO R ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      4, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC STO1 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      3, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC STO2 ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      2, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC MONO L ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      1, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY_S(\"ADC MONO R ASRC\", 1, RT5670_ASRC_1,\n\t\t\t      0, 0, NULL, 0),\n\n\t \n\t \n\tSND_SOC_DAPM_SUPPLY(\"MICBIAS1\", RT5670_PWR_ANLG2,\n\t\t\t     RT5670_PWR_MB1_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_INPUT(\"DMIC L1\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC R1\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC L2\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC R2\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC L3\"),\n\tSND_SOC_DAPM_INPUT(\"DMIC R3\"),\n\n\tSND_SOC_DAPM_INPUT(\"IN1P\"),\n\tSND_SOC_DAPM_INPUT(\"IN1N\"),\n\tSND_SOC_DAPM_INPUT(\"IN2P\"),\n\tSND_SOC_DAPM_INPUT(\"IN2N\"),\n\n\tSND_SOC_DAPM_PGA(\"DMIC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DMIC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DMIC3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"DMIC CLK\", SND_SOC_NOPM, 0, 0,\n\t\t\t    set_dmic_clk, SND_SOC_DAPM_PRE_PMU),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC1 Power\", RT5670_DMIC_CTRL1,\n\t\t\t    RT5670_DMIC_1_EN_SFT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC2 Power\", RT5670_DMIC_CTRL1,\n\t\t\t    RT5670_DMIC_2_EN_SFT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DMIC3 Power\", RT5670_DMIC_CTRL1,\n\t\t\t    RT5670_DMIC_3_EN_SFT, 0, NULL, 0),\n\t \n\tSND_SOC_DAPM_PGA_E(\"BST1\", RT5670_PWR_ANLG2, RT5670_PWR_BST1_BIT,\n\t\t\t   0, NULL, 0, rt5670_bst1_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_PGA_E(\"BST2\", RT5670_PWR_ANLG2, RT5670_PWR_BST2_BIT,\n\t\t\t   0, NULL, 0, rt5670_bst2_event,\n\t\t\t   SND_SOC_DAPM_PRE_PMD | SND_SOC_DAPM_POST_PMU),\n\t \n\tSND_SOC_DAPM_PGA(\"INL VOL\", RT5670_PWR_VOL,\n\t\t\t RT5670_PWR_IN_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"INR VOL\", RT5670_PWR_VOL,\n\t\t\t RT5670_PWR_IN_R_BIT, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"RECMIXL\", RT5670_PWR_MIXER, RT5670_PWR_RM_L_BIT, 0,\n\t\t\t   rt5670_rec_l_mix, ARRAY_SIZE(rt5670_rec_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"RECMIXR\", RT5670_PWR_MIXER, RT5670_PWR_RM_R_BIT, 0,\n\t\t\t   rt5670_rec_r_mix, ARRAY_SIZE(rt5670_rec_r_mix)),\n\t \n\tSND_SOC_DAPM_ADC(\"ADC 1\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_ADC(\"ADC 2\", NULL, SND_SOC_NOPM, 0, 0),\n\n\tSND_SOC_DAPM_PGA(\"ADC 1_2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_SUPPLY(\"ADC 1 power\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_ADC_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"ADC 2 power\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_ADC_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"ADC clock\", RT5670_PR_BASE +\n\t\t\t    RT5670_CHOP_DAC_ADC, 12, 0, NULL, 0),\n\t \n\tSND_SOC_DAPM_MUX(\"Stereo1 DMIC Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto1_dmic_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto_adc_2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto_adc_2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC L1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto_adc_1_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo1 ADC R1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto_adc_1_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 DMIC Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_dmic_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 ADC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_adc_2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 ADC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_adc_2_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 ADC L1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_adc_1_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 ADC R1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_adc_1_mux),\n\tSND_SOC_DAPM_MUX(\"Stereo2 ADC LR Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_sto2_adc_lr_mux),\n\tSND_SOC_DAPM_MUX(\"Mono DMIC L Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_dmic_l_mux),\n\tSND_SOC_DAPM_MUX(\"Mono DMIC R Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_dmic_r_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_adc_l2_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC L1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_adc_l1_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC R1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_adc_r1_mux),\n\tSND_SOC_DAPM_MUX(\"Mono ADC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_mono_adc_r2_mux),\n\t \n\tSND_SOC_DAPM_SUPPLY(\"ADC Stereo1 Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_ADC_S1F_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"ADC Stereo2 Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_ADC_S2F_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"Sto1 ADC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto1_adc_l_mix, ARRAY_SIZE(rt5670_sto1_adc_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Sto1 ADC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto1_adc_r_mix, ARRAY_SIZE(rt5670_sto1_adc_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"Sto2 ADC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto2_adc_l_mix,\n\t\t\t   ARRAY_SIZE(rt5670_sto2_adc_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Sto2 ADC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto2_adc_r_mix,\n\t\t\t   ARRAY_SIZE(rt5670_sto2_adc_r_mix)),\n\tSND_SOC_DAPM_SUPPLY(\"ADC Mono Left Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_ADC_MF_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"Mono ADC MIXL\", RT5670_MONO_ADC_DIG_VOL,\n\t\t\t   RT5670_L_MUTE_SFT, 1, rt5670_mono_adc_l_mix,\n\t\t\t   ARRAY_SIZE(rt5670_mono_adc_l_mix)),\n\tSND_SOC_DAPM_SUPPLY(\"ADC Mono Right Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_ADC_MF_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"Mono ADC MIXR\", RT5670_MONO_ADC_DIG_VOL,\n\t\t\t   RT5670_R_MUTE_SFT, 1, rt5670_mono_adc_r_mix,\n\t\t\t   ARRAY_SIZE(rt5670_mono_adc_r_mix)),\n\n\t \n\tSND_SOC_DAPM_PGA(\"Stereo1 ADC MIXL\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo1 ADC MIXR\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo2 ADC MIXL\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo2 ADC MIXR\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Sto2 ADC LR MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo1 ADC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Stereo2 ADC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"Mono ADC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"VAD_ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF_ADC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF_ADC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF_ADC3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1_ADC3\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_PGA(\"TxDP_ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"TxDP_ADC_L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"TxDP_ADC_R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"TxDC_DAC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MUX(\"TDM Data Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_txdp_slot_mux),\n\n\tSND_SOC_DAPM_MUX(\"DSP UL Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_dsp_ul_mux),\n\tSND_SOC_DAPM_MUX(\"DSP DL Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_dsp_dl_mux),\n\n\tSND_SOC_DAPM_MUX(\"RxDP Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_rxdp_mux),\n\n\t \n\tSND_SOC_DAPM_MUX(\"IF2 ADC Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_if2_adc_in_mux),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"I2S1\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_I2S1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC2\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC1 L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC1 R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC2 L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 DAC2 R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF1 ADC R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"I2S2\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_I2S2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 DAC R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 ADC\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 ADC L\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"IF2 ADC R\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"IF1 ADC1 IN1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_if1_adc1_in1_mux),\n\tSND_SOC_DAPM_MUX(\"IF1 ADC1 IN2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_if1_adc1_in2_mux),\n\tSND_SOC_DAPM_MUX(\"IF1 ADC2 IN Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_if1_adc2_in_mux),\n\tSND_SOC_DAPM_MUX(\"IF1 ADC2 IN1 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_if1_adc2_in1_mux),\n\tSND_SOC_DAPM_MUX(\"VAD ADC Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_vad_adc_mux),\n\n\t \n\tSND_SOC_DAPM_AIF_IN(\"AIF1RX\", \"AIF1 Playback\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AIF1TX\", \"AIF1 Capture\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_IN(\"AIF2RX\", \"AIF2 Playback\", 0, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_AIF_OUT(\"AIF2TX\", \"AIF2 Capture\", 0,\n\t\t\t     RT5670_GPIO_CTRL1, RT5670_I2S2_PIN_SFT, 1),\n\n\t \n\tSND_SOC_DAPM_PGA(\"Audio DSP\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\t \n\tSND_SOC_DAPM_MIXER(\"DAC1 MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_dac_l_mix, ARRAY_SIZE(rt5670_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC1 MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_dac_r_mix, ARRAY_SIZE(rt5670_dac_r_mix)),\n\tSND_SOC_DAPM_PGA(\"DAC MIX\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MUX(\"DAC L2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_dac_l2_mux),\n\tSND_SOC_DAPM_MUX(\"DAC R2 Mux\", SND_SOC_NOPM, 0, 0,\n\t\t\t &rt5670_dac_r2_mux),\n\tSND_SOC_DAPM_PGA(\"DAC L2 Volume\", RT5670_PWR_DIG1,\n\t\t\t RT5670_PWR_DAC_L2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DAC R2 Volume\", RT5670_PWR_DIG1,\n\t\t\t RT5670_PWR_DAC_R2_BIT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MUX(\"DAC1 L Mux\", SND_SOC_NOPM, 0, 0, &rt5670_dac1l_mux),\n\tSND_SOC_DAPM_MUX(\"DAC1 R Mux\", SND_SOC_NOPM, 0, 0, &rt5670_dac1r_mux),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"DAC Stereo1 Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_DAC_S1F_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DAC Mono Left Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_DAC_MF_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DAC Mono Right Filter\", RT5670_PWR_DIG2,\n\t\t\t    RT5670_PWR_DAC_MF_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MIXER(\"Stereo DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto_dac_l_mix,\n\t\t\t   ARRAY_SIZE(rt5670_sto_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Stereo DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_sto_dac_r_mix,\n\t\t\t   ARRAY_SIZE(rt5670_sto_dac_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"Mono DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_mono_dac_l_mix,\n\t\t\t   ARRAY_SIZE(rt5670_mono_dac_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"Mono DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_mono_dac_r_mix,\n\t\t\t   ARRAY_SIZE(rt5670_mono_dac_r_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC MIXL\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_dig_l_mix,\n\t\t\t   ARRAY_SIZE(rt5670_dig_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"DAC MIXR\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_dig_r_mix,\n\t\t\t   ARRAY_SIZE(rt5670_dig_r_mix)),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"DAC L1 Power\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_DAC_L1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"DAC R1 Power\", RT5670_PWR_DIG1,\n\t\t\t    RT5670_PWR_DAC_R1_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_DAC(\"DAC L1\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_DAC(\"DAC R1\", NULL, SND_SOC_NOPM, 0, 0),\n\tSND_SOC_DAPM_DAC(\"DAC L2\", NULL, RT5670_PWR_DIG1,\n\t\t\t RT5670_PWR_DAC_L2_BIT, 0),\n\n\tSND_SOC_DAPM_DAC(\"DAC R2\", NULL, RT5670_PWR_DIG1,\n\t\t\t RT5670_PWR_DAC_R2_BIT, 0),\n\t \n\n\tSND_SOC_DAPM_MIXER(\"OUT MIXL\", RT5670_PWR_MIXER, RT5670_PWR_OM_L_BIT,\n\t\t\t   0, rt5670_out_l_mix, ARRAY_SIZE(rt5670_out_l_mix)),\n\tSND_SOC_DAPM_MIXER(\"OUT MIXR\", RT5670_PWR_MIXER, RT5670_PWR_OM_R_BIT,\n\t\t\t   0, rt5670_out_r_mix, ARRAY_SIZE(rt5670_out_r_mix)),\n\t \n\tSND_SOC_DAPM_MIXER(\"HPOVOL MIXL\", RT5670_PWR_VOL,\n\t\t\t   RT5670_PWR_HV_L_BIT, 0,\n\t\t\t   rt5670_hpvoll_mix, ARRAY_SIZE(rt5670_hpvoll_mix)),\n\tSND_SOC_DAPM_MIXER(\"HPOVOL MIXR\", RT5670_PWR_VOL,\n\t\t\t   RT5670_PWR_HV_R_BIT, 0,\n\t\t\t   rt5670_hpvolr_mix, ARRAY_SIZE(rt5670_hpvolr_mix)),\n\tSND_SOC_DAPM_PGA(\"DAC 1\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"DAC 2\", SND_SOC_NOPM,\t0, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA(\"HPOVOL\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_MIXER(\"HPO MIX\", SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_hpo_mix, ARRAY_SIZE(rt5670_hpo_mix)),\n\tSND_SOC_DAPM_MIXER(\"LOUT MIX\", RT5670_PWR_ANLG1, RT5670_PWR_LM_BIT,\n\t\t\t   0, rt5670_lout_mix, ARRAY_SIZE(rt5670_lout_mix)),\n\tSND_SOC_DAPM_SUPPLY_S(\"Improve HP Amp Drv\", 1, SND_SOC_NOPM, 0, 0,\n\t\t\t      rt5670_hp_power_event, SND_SOC_DAPM_POST_PMU |\n\t\t\t      SND_SOC_DAPM_PRE_PMD),\n\tSND_SOC_DAPM_SUPPLY(\"HP L Amp\", RT5670_PWR_ANLG1,\n\t\t\t    RT5670_PWR_HP_L_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_SUPPLY(\"HP R Amp\", RT5670_PWR_ANLG1,\n\t\t\t    RT5670_PWR_HP_R_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_PGA_S(\"HP Amp\", 1, SND_SOC_NOPM, 0, 0,\n\t\t\t   rt5670_hp_event, SND_SOC_DAPM_PRE_PMD |\n\t\t\t   SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_SWITCH(\"LOUT L Playback\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &lout_l_enable_control),\n\tSND_SOC_DAPM_SWITCH(\"LOUT R Playback\", SND_SOC_NOPM, 0, 0,\n\t\t\t    &lout_r_enable_control),\n\tSND_SOC_DAPM_PGA(\"LOUT Amp\", SND_SOC_NOPM, 0, 0, NULL, 0),\n\n\t \n\tSND_SOC_DAPM_SUPPLY(\"PDM1 Power\", RT5670_PWR_DIG2,\n\t\tRT5670_PWR_PDM1_BIT, 0, NULL, 0),\n\n\tSND_SOC_DAPM_MUX(\"PDM1 L Mux\", RT5670_PDM_OUT_CTRL,\n\t\t\t RT5670_M_PDM1_L_SFT, 1, &rt5670_pdm1_l_mux),\n\tSND_SOC_DAPM_MUX(\"PDM1 R Mux\", RT5670_PDM_OUT_CTRL,\n\t\t\t RT5670_M_PDM1_R_SFT, 1, &rt5670_pdm1_r_mux),\n\n\t \n\tSND_SOC_DAPM_OUTPUT(\"HPOL\"),\n\tSND_SOC_DAPM_OUTPUT(\"HPOR\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOUTL\"),\n\tSND_SOC_DAPM_OUTPUT(\"LOUTR\"),\n};\n\nstatic const struct snd_soc_dapm_widget rt5670_specific_dapm_widgets[] = {\n\tSND_SOC_DAPM_SUPPLY(\"PDM2 Power\", RT5670_PWR_DIG2,\n\t\tRT5670_PWR_PDM2_BIT, 0, NULL, 0),\n\tSND_SOC_DAPM_MUX(\"PDM2 L Mux\", RT5670_PDM_OUT_CTRL,\n\t\t\t RT5670_M_PDM2_L_SFT, 1, &rt5670_pdm2_l_mux),\n\tSND_SOC_DAPM_MUX(\"PDM2 R Mux\", RT5670_PDM_OUT_CTRL,\n\t\t\t RT5670_M_PDM2_R_SFT, 1, &rt5670_pdm2_r_mux),\n\tSND_SOC_DAPM_OUTPUT(\"PDM1L\"),\n\tSND_SOC_DAPM_OUTPUT(\"PDM1R\"),\n\tSND_SOC_DAPM_OUTPUT(\"PDM2L\"),\n\tSND_SOC_DAPM_OUTPUT(\"PDM2R\"),\n};\n\nstatic const struct snd_soc_dapm_widget rt5672_specific_dapm_widgets[] = {\n\tSND_SOC_DAPM_PGA_E(\"SPO Amp\", SND_SOC_NOPM, 0, 0, NULL, 0,\n\t\t\t   rt5670_spk_event, SND_SOC_DAPM_PRE_PMD |\n\t\t\t   SND_SOC_DAPM_POST_PMU),\n\tSND_SOC_DAPM_OUTPUT(\"SPOLP\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPOLN\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPORP\"),\n\tSND_SOC_DAPM_OUTPUT(\"SPORN\"),\n};\n\nstatic const struct snd_soc_dapm_route rt5670_dapm_routes[] = {\n\t{ \"ADC Stereo1 Filter\", NULL, \"ADC STO1 ASRC\", is_using_asrc },\n\t{ \"ADC Stereo2 Filter\", NULL, \"ADC STO2 ASRC\", is_using_asrc },\n\t{ \"ADC Mono Left Filter\", NULL, \"ADC MONO L ASRC\", is_using_asrc },\n\t{ \"ADC Mono Right Filter\", NULL, \"ADC MONO R ASRC\", is_using_asrc },\n\t{ \"DAC Mono Left Filter\", NULL, \"DAC MONO L ASRC\", is_using_asrc },\n\t{ \"DAC Mono Right Filter\", NULL, \"DAC MONO R ASRC\", is_using_asrc },\n\t{ \"DAC Stereo1 Filter\", NULL, \"DAC STO ASRC\", is_using_asrc },\n\t{ \"Stereo1 DMIC Mux\", NULL, \"DMIC STO1 ASRC\", can_use_asrc },\n\t{ \"Stereo2 DMIC Mux\", NULL, \"DMIC STO2 ASRC\", can_use_asrc },\n\t{ \"Mono DMIC L Mux\", NULL, \"DMIC MONO L ASRC\", can_use_asrc },\n\t{ \"Mono DMIC R Mux\", NULL, \"DMIC MONO R ASRC\", can_use_asrc },\n\n\t{ \"I2S1\", NULL, \"I2S1 ASRC\", can_use_asrc},\n\t{ \"I2S2\", NULL, \"I2S2 ASRC\", can_use_asrc},\n\n\t{ \"DMIC1\", NULL, \"DMIC L1\" },\n\t{ \"DMIC1\", NULL, \"DMIC R1\" },\n\t{ \"DMIC2\", NULL, \"DMIC L2\" },\n\t{ \"DMIC2\", NULL, \"DMIC R2\" },\n\t{ \"DMIC3\", NULL, \"DMIC L3\" },\n\t{ \"DMIC3\", NULL, \"DMIC R3\" },\n\n\t{ \"BST1\", NULL, \"IN1P\" },\n\t{ \"BST1\", NULL, \"IN1N\" },\n\t{ \"BST1\", NULL, \"Mic Det Power\" },\n\t{ \"BST2\", NULL, \"IN2P\" },\n\t{ \"BST2\", NULL, \"IN2N\" },\n\n\t{ \"INL VOL\", NULL, \"IN2P\" },\n\t{ \"INR VOL\", NULL, \"IN2N\" },\n\n\t{ \"RECMIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"RECMIXL\", \"BST2 Switch\", \"BST2\" },\n\t{ \"RECMIXL\", \"BST1 Switch\", \"BST1\" },\n\n\t{ \"RECMIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"RECMIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"RECMIXR\", \"BST1 Switch\", \"BST1\" },\n\n\t{ \"ADC 1\", NULL, \"RECMIXL\" },\n\t{ \"ADC 1\", NULL, \"ADC 1 power\" },\n\t{ \"ADC 1\", NULL, \"ADC clock\" },\n\t{ \"ADC 2\", NULL, \"RECMIXR\" },\n\t{ \"ADC 2\", NULL, \"ADC 2 power\" },\n\t{ \"ADC 2\", NULL, \"ADC clock\" },\n\n\t{ \"DMIC L1\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC L1\", NULL, \"DMIC1 Power\" },\n\t{ \"DMIC R1\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC R1\", NULL, \"DMIC1 Power\" },\n\t{ \"DMIC L2\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC L2\", NULL, \"DMIC2 Power\" },\n\t{ \"DMIC R2\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC R2\", NULL, \"DMIC2 Power\" },\n\t{ \"DMIC L3\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC L3\", NULL, \"DMIC3 Power\" },\n\t{ \"DMIC R3\", NULL, \"DMIC CLK\" },\n\t{ \"DMIC R3\", NULL, \"DMIC3 Power\" },\n\n\t{ \"Stereo1 DMIC Mux\", \"DMIC1\", \"DMIC1\" },\n\t{ \"Stereo1 DMIC Mux\", \"DMIC2\", \"DMIC2\" },\n\t{ \"Stereo1 DMIC Mux\", \"DMIC3\", \"DMIC3\" },\n\n\t{ \"Stereo2 DMIC Mux\", \"DMIC1\", \"DMIC1\" },\n\t{ \"Stereo2 DMIC Mux\", \"DMIC2\", \"DMIC2\" },\n\t{ \"Stereo2 DMIC Mux\", \"DMIC3\", \"DMIC3\" },\n\n\t{ \"Mono DMIC L Mux\", \"DMIC1\", \"DMIC L1\" },\n\t{ \"Mono DMIC L Mux\", \"DMIC2\", \"DMIC L2\" },\n\t{ \"Mono DMIC L Mux\", \"DMIC3\", \"DMIC L3\" },\n\n\t{ \"Mono DMIC R Mux\", \"DMIC1\", \"DMIC R1\" },\n\t{ \"Mono DMIC R Mux\", \"DMIC2\", \"DMIC R2\" },\n\t{ \"Mono DMIC R Mux\", \"DMIC3\", \"DMIC R3\" },\n\n\t{ \"ADC 1_2\", NULL, \"ADC 1\" },\n\t{ \"ADC 1_2\", NULL, \"ADC 2\" },\n\n\t{ \"Stereo1 ADC L2 Mux\", \"DMIC\", \"Stereo1 DMIC Mux\" },\n\t{ \"Stereo1 ADC L2 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\t{ \"Stereo1 ADC L1 Mux\", \"ADC\", \"ADC 1_2\" },\n\t{ \"Stereo1 ADC L1 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\n\t{ \"Stereo1 ADC R1 Mux\", \"ADC\", \"ADC 1_2\" },\n\t{ \"Stereo1 ADC R1 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\t{ \"Stereo1 ADC R2 Mux\", \"DMIC\", \"Stereo1 DMIC Mux\" },\n\t{ \"Stereo1 ADC R2 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\n\t{ \"Mono ADC L2 Mux\", \"DMIC\", \"Mono DMIC L Mux\" },\n\t{ \"Mono ADC L2 Mux\", \"Mono DAC MIXL\", \"Mono DAC MIXL\" },\n\t{ \"Mono ADC L1 Mux\", \"Mono DAC MIXL\", \"Mono DAC MIXL\" },\n\t{ \"Mono ADC L1 Mux\", \"ADC1\",  \"ADC 1\" },\n\n\t{ \"Mono ADC R1 Mux\", \"Mono DAC MIXR\", \"Mono DAC MIXR\" },\n\t{ \"Mono ADC R1 Mux\", \"ADC2\", \"ADC 2\" },\n\t{ \"Mono ADC R2 Mux\", \"DMIC\", \"Mono DMIC R Mux\" },\n\t{ \"Mono ADC R2 Mux\", \"Mono DAC MIXR\", \"Mono DAC MIXR\" },\n\n\t{ \"Sto1 ADC MIXL\", \"ADC1 Switch\", \"Stereo1 ADC L1 Mux\" },\n\t{ \"Sto1 ADC MIXL\", \"ADC2 Switch\", \"Stereo1 ADC L2 Mux\" },\n\t{ \"Sto1 ADC MIXR\", \"ADC1 Switch\", \"Stereo1 ADC R1 Mux\" },\n\t{ \"Sto1 ADC MIXR\", \"ADC2 Switch\", \"Stereo1 ADC R2 Mux\" },\n\n\t{ \"Stereo1 ADC MIXL\", NULL, \"Sto1 ADC MIXL\" },\n\t{ \"Stereo1 ADC MIXL\", NULL, \"ADC Stereo1 Filter\" },\n\n\t{ \"Stereo1 ADC MIXR\", NULL, \"Sto1 ADC MIXR\" },\n\t{ \"Stereo1 ADC MIXR\", NULL, \"ADC Stereo1 Filter\" },\n\t{ \"ADC Stereo1 Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Mono ADC MIXL\", \"ADC1 Switch\", \"Mono ADC L1 Mux\" },\n\t{ \"Mono ADC MIXL\", \"ADC2 Switch\", \"Mono ADC L2 Mux\" },\n\t{ \"Mono ADC MIXL\", NULL, \"ADC Mono Left Filter\" },\n\t{ \"ADC Mono Left Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Mono ADC MIXR\", \"ADC1 Switch\", \"Mono ADC R1 Mux\" },\n\t{ \"Mono ADC MIXR\", \"ADC2 Switch\", \"Mono ADC R2 Mux\" },\n\t{ \"Mono ADC MIXR\", NULL, \"ADC Mono Right Filter\" },\n\t{ \"ADC Mono Right Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"Stereo2 ADC L2 Mux\", \"DMIC\", \"Stereo2 DMIC Mux\" },\n\t{ \"Stereo2 ADC L2 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\t{ \"Stereo2 ADC L1 Mux\", \"ADC\", \"ADC 1_2\" },\n\t{ \"Stereo2 ADC L1 Mux\", \"DAC MIX\", \"DAC MIXL\" },\n\n\t{ \"Stereo2 ADC R1 Mux\", \"ADC\", \"ADC 1_2\" },\n\t{ \"Stereo2 ADC R1 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\t{ \"Stereo2 ADC R2 Mux\", \"DMIC\", \"Stereo2 DMIC Mux\" },\n\t{ \"Stereo2 ADC R2 Mux\", \"DAC MIX\", \"DAC MIXR\" },\n\n\t{ \"Sto2 ADC MIXL\", \"ADC1 Switch\", \"Stereo2 ADC L1 Mux\" },\n\t{ \"Sto2 ADC MIXL\", \"ADC2 Switch\", \"Stereo2 ADC L2 Mux\" },\n\t{ \"Sto2 ADC MIXR\", \"ADC1 Switch\", \"Stereo2 ADC R1 Mux\" },\n\t{ \"Sto2 ADC MIXR\", \"ADC2 Switch\", \"Stereo2 ADC R2 Mux\" },\n\n\t{ \"Sto2 ADC LR MIX\", NULL, \"Sto2 ADC MIXL\" },\n\t{ \"Sto2 ADC LR MIX\", NULL, \"Sto2 ADC MIXR\" },\n\n\t{ \"Stereo2 ADC LR Mux\", \"L\", \"Sto2 ADC MIXL\" },\n\t{ \"Stereo2 ADC LR Mux\", \"LR\", \"Sto2 ADC LR MIX\" },\n\n\t{ \"Stereo2 ADC MIXL\", NULL, \"Stereo2 ADC LR Mux\" },\n\t{ \"Stereo2 ADC MIXL\", NULL, \"ADC Stereo2 Filter\" },\n\n\t{ \"Stereo2 ADC MIXR\", NULL, \"Sto2 ADC MIXR\" },\n\t{ \"Stereo2 ADC MIXR\", NULL, \"ADC Stereo2 Filter\" },\n\t{ \"ADC Stereo2 Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"VAD ADC Mux\", \"Sto1 ADC L\", \"Stereo1 ADC MIXL\" },\n\t{ \"VAD ADC Mux\", \"Mono ADC L\", \"Mono ADC MIXL\" },\n\t{ \"VAD ADC Mux\", \"Mono ADC R\", \"Mono ADC MIXR\" },\n\t{ \"VAD ADC Mux\", \"Sto2 ADC L\", \"Sto2 ADC MIXL\" },\n\n\t{ \"VAD_ADC\", NULL, \"VAD ADC Mux\" },\n\n\t{ \"IF_ADC1\", NULL, \"Stereo1 ADC MIXL\" },\n\t{ \"IF_ADC1\", NULL, \"Stereo1 ADC MIXR\" },\n\t{ \"IF_ADC2\", NULL, \"Mono ADC MIXL\" },\n\t{ \"IF_ADC2\", NULL, \"Mono ADC MIXR\" },\n\t{ \"IF_ADC3\", NULL, \"Stereo2 ADC MIXL\" },\n\t{ \"IF_ADC3\", NULL, \"Stereo2 ADC MIXR\" },\n\n\t{ \"IF1 ADC1 IN1 Mux\", \"IF_ADC1\", \"IF_ADC1\" },\n\t{ \"IF1 ADC1 IN1 Mux\", \"IF1_ADC3\", \"IF1_ADC3\" },\n\n\t{ \"IF1 ADC1 IN2 Mux\", \"IF1_ADC1_IN1\", \"IF1 ADC1 IN1 Mux\" },\n\t{ \"IF1 ADC1 IN2 Mux\", \"IF1_ADC4\", \"TxDP_ADC\" },\n\n\t{ \"IF1 ADC2 IN Mux\", \"IF_ADC2\", \"IF_ADC2\" },\n\t{ \"IF1 ADC2 IN Mux\", \"VAD_ADC\", \"VAD_ADC\" },\n\n\t{ \"IF1 ADC2 IN1 Mux\", \"IF1_ADC2_IN\", \"IF1 ADC2 IN Mux\" },\n\t{ \"IF1 ADC2 IN1 Mux\", \"IF1_ADC4\", \"TxDP_ADC\" },\n\n\t{ \"IF1_ADC1\" , NULL, \"IF1 ADC1 IN2 Mux\" },\n\t{ \"IF1_ADC2\" , NULL, \"IF1 ADC2 IN1 Mux\" },\n\n\t{ \"Stereo1 ADC MIX\", NULL, \"Stereo1 ADC MIXL\" },\n\t{ \"Stereo1 ADC MIX\", NULL, \"Stereo1 ADC MIXR\" },\n\t{ \"Stereo2 ADC MIX\", NULL, \"Sto2 ADC MIXL\" },\n\t{ \"Stereo2 ADC MIX\", NULL, \"Sto2 ADC MIXR\" },\n\t{ \"Mono ADC MIX\", NULL, \"Mono ADC MIXL\" },\n\t{ \"Mono ADC MIX\", NULL, \"Mono ADC MIXR\" },\n\n\t{ \"RxDP Mux\", \"IF2 DAC\", \"IF2 DAC\" },\n\t{ \"RxDP Mux\", \"IF1 DAC\", \"IF1 DAC2\" },\n\t{ \"RxDP Mux\", \"STO1 ADC Mixer\", \"Stereo1 ADC MIX\" },\n\t{ \"RxDP Mux\", \"STO2 ADC Mixer\", \"Stereo2 ADC MIX\" },\n\t{ \"RxDP Mux\", \"Mono ADC Mixer L\", \"Mono ADC MIXL\" },\n\t{ \"RxDP Mux\", \"Mono ADC Mixer R\", \"Mono ADC MIXR\" },\n\t{ \"RxDP Mux\", \"DAC1\", \"DAC MIX\" },\n\n\t{ \"TDM Data Mux\", \"Slot 0-1\", \"Stereo1 ADC MIX\" },\n\t{ \"TDM Data Mux\", \"Slot 2-3\", \"Mono ADC MIX\" },\n\t{ \"TDM Data Mux\", \"Slot 4-5\", \"Stereo2 ADC MIX\" },\n\t{ \"TDM Data Mux\", \"Slot 6-7\", \"IF2 DAC\" },\n\n\t{ \"DSP UL Mux\", \"Bypass\", \"TDM Data Mux\" },\n\t{ \"DSP UL Mux\", NULL, \"I2S DSP\" },\n\t{ \"DSP DL Mux\", \"Bypass\", \"RxDP Mux\" },\n\t{ \"DSP DL Mux\", NULL, \"I2S DSP\" },\n\n\t{ \"TxDP_ADC_L\", NULL, \"DSP UL Mux\" },\n\t{ \"TxDP_ADC_R\", NULL, \"DSP UL Mux\" },\n\t{ \"TxDC_DAC\", NULL, \"DSP DL Mux\" },\n\n\t{ \"TxDP_ADC\", NULL, \"TxDP_ADC_L\" },\n\t{ \"TxDP_ADC\", NULL, \"TxDP_ADC_R\" },\n\n\t{ \"IF1 ADC\", NULL, \"I2S1\" },\n\t{ \"IF1 ADC\", NULL, \"IF1_ADC1\" },\n\t{ \"IF1 ADC\", NULL, \"IF1_ADC2\" },\n\t{ \"IF1 ADC\", NULL, \"IF_ADC3\" },\n\t{ \"IF1 ADC\", NULL, \"TxDP_ADC\" },\n\n\t{ \"IF2 ADC Mux\", \"IF_ADC1\", \"IF_ADC1\" },\n\t{ \"IF2 ADC Mux\", \"IF_ADC2\", \"IF_ADC2\" },\n\t{ \"IF2 ADC Mux\", \"IF_ADC3\", \"IF_ADC3\" },\n\t{ \"IF2 ADC Mux\", \"TxDC_DAC\", \"TxDC_DAC\" },\n\t{ \"IF2 ADC Mux\", \"TxDP_ADC\", \"TxDP_ADC\" },\n\t{ \"IF2 ADC Mux\", \"VAD_ADC\", \"VAD_ADC\" },\n\n\t{ \"IF2 ADC L\", NULL, \"IF2 ADC Mux\" },\n\t{ \"IF2 ADC R\", NULL, \"IF2 ADC Mux\" },\n\n\t{ \"IF2 ADC\", NULL, \"I2S2\" },\n\t{ \"IF2 ADC\", NULL, \"IF2 ADC L\" },\n\t{ \"IF2 ADC\", NULL, \"IF2 ADC R\" },\n\n\t{ \"AIF1TX\", NULL, \"IF1 ADC\" },\n\t{ \"AIF2TX\", NULL, \"IF2 ADC\" },\n\n\t{ \"IF1 DAC1\", NULL, \"AIF1RX\" },\n\t{ \"IF1 DAC2\", NULL, \"AIF1RX\" },\n\t{ \"IF2 DAC\", NULL, \"AIF2RX\" },\n\n\t{ \"IF1 DAC1\", NULL, \"I2S1\" },\n\t{ \"IF1 DAC2\", NULL, \"I2S1\" },\n\t{ \"IF2 DAC\", NULL, \"I2S2\" },\n\n\t{ \"IF1 DAC2 L\", NULL, \"IF1 DAC2\" },\n\t{ \"IF1 DAC2 R\", NULL, \"IF1 DAC2\" },\n\t{ \"IF1 DAC1 L\", NULL, \"IF1 DAC1\" },\n\t{ \"IF1 DAC1 R\", NULL, \"IF1 DAC1\" },\n\t{ \"IF2 DAC L\", NULL, \"IF2 DAC\" },\n\t{ \"IF2 DAC R\", NULL, \"IF2 DAC\" },\n\n\t{ \"DAC1 L Mux\", \"IF1 DAC\", \"IF1 DAC1 L\" },\n\t{ \"DAC1 L Mux\", \"IF2 DAC\", \"IF2 DAC L\" },\n\n\t{ \"DAC1 R Mux\", \"IF1 DAC\", \"IF1 DAC1 R\" },\n\t{ \"DAC1 R Mux\", \"IF2 DAC\", \"IF2 DAC R\" },\n\n\t{ \"DAC1 MIXL\", \"Stereo ADC Switch\", \"Stereo1 ADC MIXL\" },\n\t{ \"DAC1 MIXL\", \"DAC1 Switch\", \"DAC1 L Mux\" },\n\t{ \"DAC1 MIXL\", NULL, \"DAC Stereo1 Filter\" },\n\t{ \"DAC1 MIXR\", \"Stereo ADC Switch\", \"Stereo1 ADC MIXR\" },\n\t{ \"DAC1 MIXR\", \"DAC1 Switch\", \"DAC1 R Mux\" },\n\t{ \"DAC1 MIXR\", NULL, \"DAC Stereo1 Filter\" },\n\n\t{ \"DAC Stereo1 Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\t{ \"DAC Mono Left Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\t{ \"DAC Mono Right Filter\", NULL, \"PLL1\", is_sys_clk_from_pll },\n\n\t{ \"DAC MIX\", NULL, \"DAC1 MIXL\" },\n\t{ \"DAC MIX\", NULL, \"DAC1 MIXR\" },\n\n\t{ \"Audio DSP\", NULL, \"DAC1 MIXL\" },\n\t{ \"Audio DSP\", NULL, \"DAC1 MIXR\" },\n\n\t{ \"DAC L2 Mux\", \"IF1 DAC\", \"IF1 DAC2 L\" },\n\t{ \"DAC L2 Mux\", \"IF2 DAC\", \"IF2 DAC L\" },\n\t{ \"DAC L2 Mux\", \"TxDC DAC\", \"TxDC_DAC\" },\n\t{ \"DAC L2 Mux\", \"VAD_ADC\", \"VAD_ADC\" },\n\t{ \"DAC L2 Volume\", NULL, \"DAC L2 Mux\" },\n\t{ \"DAC L2 Volume\", NULL, \"DAC Mono Left Filter\" },\n\n\t{ \"DAC R2 Mux\", \"IF1 DAC\", \"IF1 DAC2 R\" },\n\t{ \"DAC R2 Mux\", \"IF2 DAC\", \"IF2 DAC R\" },\n\t{ \"DAC R2 Mux\", \"TxDC DAC\", \"TxDC_DAC\" },\n\t{ \"DAC R2 Mux\", \"TxDP ADC\", \"TxDP_ADC\" },\n\t{ \"DAC R2 Volume\", NULL, \"DAC R2 Mux\" },\n\t{ \"DAC R2 Volume\", NULL, \"DAC Mono Right Filter\" },\n\n\t{ \"Stereo DAC MIXL\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Stereo DAC MIXL\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Stereo DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Stereo DAC MIXL\", NULL, \"DAC Stereo1 Filter\" },\n\t{ \"Stereo DAC MIXL\", NULL, \"DAC L1 Power\" },\n\t{ \"Stereo DAC MIXR\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Stereo DAC MIXR\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Stereo DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Stereo DAC MIXR\", NULL, \"DAC Stereo1 Filter\" },\n\t{ \"Stereo DAC MIXR\", NULL, \"DAC R1 Power\" },\n\n\t{ \"Mono DAC MIXL\", \"DAC L1 Switch\", \"DAC1 MIXL\" },\n\t{ \"Mono DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Mono DAC MIXL\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Mono DAC MIXL\", NULL, \"DAC Mono Left Filter\" },\n\t{ \"Mono DAC MIXR\", \"DAC R1 Switch\", \"DAC1 MIXR\" },\n\t{ \"Mono DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"Mono DAC MIXR\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"Mono DAC MIXR\", NULL, \"DAC Mono Right Filter\" },\n\n\t{ \"DAC MIXL\", \"Sto DAC Mix L Switch\", \"Stereo DAC MIXL\" },\n\t{ \"DAC MIXL\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\t{ \"DAC MIXL\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"DAC MIXR\", \"Sto DAC Mix R Switch\", \"Stereo DAC MIXR\" },\n\t{ \"DAC MIXR\", \"DAC R2 Switch\", \"DAC R2 Volume\" },\n\t{ \"DAC MIXR\", \"DAC L2 Switch\", \"DAC L2 Volume\" },\n\n\t{ \"DAC L1\", NULL, \"DAC L1 Power\" },\n\t{ \"DAC L1\", NULL, \"Stereo DAC MIXL\" },\n\t{ \"DAC R1\", NULL, \"DAC R1 Power\" },\n\t{ \"DAC R1\", NULL, \"Stereo DAC MIXR\" },\n\t{ \"DAC L2\", NULL, \"Mono DAC MIXL\" },\n\t{ \"DAC R2\", NULL, \"Mono DAC MIXR\" },\n\n\t{ \"OUT MIXL\", \"BST1 Switch\", \"BST1\" },\n\t{ \"OUT MIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"OUT MIXL\", \"DAC L2 Switch\", \"DAC L2\" },\n\t{ \"OUT MIXL\", \"DAC L1 Switch\", \"DAC L1\" },\n\n\t{ \"OUT MIXR\", \"BST2 Switch\", \"BST2\" },\n\t{ \"OUT MIXR\", \"INR Switch\", \"INR VOL\" },\n\t{ \"OUT MIXR\", \"DAC R2 Switch\", \"DAC R2\" },\n\t{ \"OUT MIXR\", \"DAC R1 Switch\", \"DAC R1\" },\n\n\t{ \"HPOVOL MIXL\", \"DAC1 Switch\", \"DAC L1\" },\n\t{ \"HPOVOL MIXL\", \"INL Switch\", \"INL VOL\" },\n\t{ \"HPOVOL MIXR\", \"DAC1 Switch\", \"DAC R1\" },\n\t{ \"HPOVOL MIXR\", \"INR Switch\", \"INR VOL\" },\n\n\t{ \"DAC 2\", NULL, \"DAC L2\" },\n\t{ \"DAC 2\", NULL, \"DAC R2\" },\n\t{ \"DAC 1\", NULL, \"DAC L1\" },\n\t{ \"DAC 1\", NULL, \"DAC R1\" },\n\t{ \"HPOVOL\", NULL, \"HPOVOL MIXL\" },\n\t{ \"HPOVOL\", NULL, \"HPOVOL MIXR\" },\n\t{ \"HPO MIX\", \"DAC1 Switch\", \"DAC 1\" },\n\t{ \"HPO MIX\", \"HPVOL Switch\", \"HPOVOL\" },\n\n\t{ \"LOUT MIX\", \"DAC L1 Switch\", \"DAC L1\" },\n\t{ \"LOUT MIX\", \"DAC R1 Switch\", \"DAC R1\" },\n\t{ \"LOUT MIX\", \"OUTMIX L Switch\", \"OUT MIXL\" },\n\t{ \"LOUT MIX\", \"OUTMIX R Switch\", \"OUT MIXR\" },\n\n\t{ \"PDM1 L Mux\", \"Stereo DAC\", \"Stereo DAC MIXL\" },\n\t{ \"PDM1 L Mux\", \"Mono DAC\", \"Mono DAC MIXL\" },\n\t{ \"PDM1 L Mux\", NULL, \"PDM1 Power\" },\n\t{ \"PDM1 R Mux\", \"Stereo DAC\", \"Stereo DAC MIXR\" },\n\t{ \"PDM1 R Mux\", \"Mono DAC\", \"Mono DAC MIXR\" },\n\t{ \"PDM1 R Mux\", NULL, \"PDM1 Power\" },\n\n\t{ \"HP Amp\", NULL, \"HPO MIX\" },\n\t{ \"HP Amp\", NULL, \"Mic Det Power\" },\n\t{ \"HPOL\", NULL, \"HP Amp\" },\n\t{ \"HPOL\", NULL, \"HP L Amp\" },\n\t{ \"HPOL\", NULL, \"Improve HP Amp Drv\" },\n\t{ \"HPOR\", NULL, \"HP Amp\" },\n\t{ \"HPOR\", NULL, \"HP R Amp\" },\n\t{ \"HPOR\", NULL, \"Improve HP Amp Drv\" },\n\n\t{ \"LOUT Amp\", NULL, \"LOUT MIX\" },\n\t{ \"LOUT L Playback\", \"Switch\", \"LOUT Amp\" },\n\t{ \"LOUT R Playback\", \"Switch\", \"LOUT Amp\" },\n\t{ \"LOUTL\", NULL, \"LOUT L Playback\" },\n\t{ \"LOUTR\", NULL, \"LOUT R Playback\" },\n\t{ \"LOUTL\", NULL, \"Improve HP Amp Drv\" },\n\t{ \"LOUTR\", NULL, \"Improve HP Amp Drv\" },\n};\n\nstatic const struct snd_soc_dapm_route rt5670_specific_dapm_routes[] = {\n\t{ \"PDM2 L Mux\", \"Stereo DAC\", \"Stereo DAC MIXL\" },\n\t{ \"PDM2 L Mux\", \"Mono DAC\", \"Mono DAC MIXL\" },\n\t{ \"PDM2 L Mux\", NULL, \"PDM2 Power\" },\n\t{ \"PDM2 R Mux\", \"Stereo DAC\", \"Stereo DAC MIXR\" },\n\t{ \"PDM2 R Mux\", \"Mono DAC\", \"Mono DAC MIXR\" },\n\t{ \"PDM2 R Mux\", NULL, \"PDM2 Power\" },\n\t{ \"PDM1L\", NULL, \"PDM1 L Mux\" },\n\t{ \"PDM1R\", NULL, \"PDM1 R Mux\" },\n\t{ \"PDM2L\", NULL, \"PDM2 L Mux\" },\n\t{ \"PDM2R\", NULL, \"PDM2 R Mux\" },\n};\n\nstatic const struct snd_soc_dapm_route rt5672_specific_dapm_routes[] = {\n\t{ \"SPO Amp\", NULL, \"PDM1 L Mux\" },\n\t{ \"SPO Amp\", NULL, \"PDM1 R Mux\" },\n\t{ \"SPOLP\", NULL, \"SPO Amp\" },\n\t{ \"SPOLN\", NULL, \"SPO Amp\" },\n\t{ \"SPORP\", NULL, \"SPO Amp\" },\n\t{ \"SPORN\", NULL, \"SPO Amp\" },\n};\n\nstatic int rt5670_hw_params(struct snd_pcm_substream *substream,\n\tstruct snd_pcm_hw_params *params, struct snd_soc_dai *dai)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tunsigned int val_len = 0, val_clk, mask_clk;\n\tint pre_div, bclk_ms, frame_size;\n\n\trt5670->lrck[dai->id] = params_rate(params);\n\tpre_div = rl6231_get_clk_info(rt5670->sysclk, rt5670->lrck[dai->id]);\n\tif (pre_div < 0) {\n\t\tdev_err(component->dev, \"Unsupported clock setting %d for DAI %d\\n\",\n\t\t\trt5670->lrck[dai->id], dai->id);\n\t\treturn -EINVAL;\n\t}\n\tframe_size = snd_soc_params_to_frame_size(params);\n\tif (frame_size < 0) {\n\t\tdev_err(component->dev, \"Unsupported frame size: %d\\n\", frame_size);\n\t\treturn -EINVAL;\n\t}\n\tbclk_ms = frame_size > 32;\n\trt5670->bclk[dai->id] = rt5670->lrck[dai->id] * (32 << bclk_ms);\n\n\tdev_dbg(dai->dev, \"bclk is %dHz and lrck is %dHz\\n\",\n\t\trt5670->bclk[dai->id], rt5670->lrck[dai->id]);\n\tdev_dbg(dai->dev, \"bclk_ms is %d and pre_div is %d for iis %d\\n\",\n\t\t\t\tbclk_ms, pre_div, dai->id);\n\n\tswitch (params_width(params)) {\n\tcase 16:\n\t\tbreak;\n\tcase 20:\n\t\tval_len |= RT5670_I2S_DL_20;\n\t\tbreak;\n\tcase 24:\n\t\tval_len |= RT5670_I2S_DL_24;\n\t\tbreak;\n\tcase 8:\n\t\tval_len |= RT5670_I2S_DL_8;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (dai->id) {\n\tcase RT5670_AIF1:\n\t\tmask_clk = RT5670_I2S_BCLK_MS1_MASK | RT5670_I2S_PD1_MASK;\n\t\tval_clk = bclk_ms << RT5670_I2S_BCLK_MS1_SFT |\n\t\t\tpre_div << RT5670_I2S_PD1_SFT;\n\t\tsnd_soc_component_update_bits(component, RT5670_I2S1_SDP,\n\t\t\tRT5670_I2S_DL_MASK, val_len);\n\t\tsnd_soc_component_update_bits(component, RT5670_ADDA_CLK1, mask_clk, val_clk);\n\t\tbreak;\n\tcase RT5670_AIF2:\n\t\tmask_clk = RT5670_I2S_BCLK_MS2_MASK | RT5670_I2S_PD2_MASK;\n\t\tval_clk = bclk_ms << RT5670_I2S_BCLK_MS2_SFT |\n\t\t\tpre_div << RT5670_I2S_PD2_SFT;\n\t\tsnd_soc_component_update_bits(component, RT5670_I2S2_SDP,\n\t\t\tRT5670_I2S_DL_MASK, val_len);\n\t\tsnd_soc_component_update_bits(component, RT5670_ADDA_CLK1, mask_clk, val_clk);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_set_dai_fmt(struct snd_soc_dai *dai, unsigned int fmt)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tunsigned int reg_val = 0;\n\n\tswitch (fmt & SND_SOC_DAIFMT_MASTER_MASK) {\n\tcase SND_SOC_DAIFMT_CBM_CFM:\n\t\trt5670->master[dai->id] = 1;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_CBS_CFS:\n\t\treg_val |= RT5670_I2S_MS_S;\n\t\trt5670->master[dai->id] = 0;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_INV_MASK) {\n\tcase SND_SOC_DAIFMT_NB_NF:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_IB_NF:\n\t\treg_val |= RT5670_I2S_BP_INV;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (fmt & SND_SOC_DAIFMT_FORMAT_MASK) {\n\tcase SND_SOC_DAIFMT_I2S:\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_LEFT_J:\n\t\treg_val |= RT5670_I2S_DF_LEFT;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_A:\n\t\treg_val |= RT5670_I2S_DF_PCM_A;\n\t\tbreak;\n\tcase SND_SOC_DAIFMT_DSP_B:\n\t\treg_val |= RT5670_I2S_DF_PCM_B;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (dai->id) {\n\tcase RT5670_AIF1:\n\t\tsnd_soc_component_update_bits(component, RT5670_I2S1_SDP,\n\t\t\tRT5670_I2S_MS_MASK | RT5670_I2S_BP_MASK |\n\t\t\tRT5670_I2S_DF_MASK, reg_val);\n\t\tbreak;\n\tcase RT5670_AIF2:\n\t\tsnd_soc_component_update_bits(component, RT5670_I2S2_SDP,\n\t\t\tRT5670_I2S_MS_MASK | RT5670_I2S_BP_MASK |\n\t\t\tRT5670_I2S_DF_MASK, reg_val);\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\treturn -EINVAL;\n\t}\n\treturn 0;\n}\n\nstatic int rt5670_set_codec_sysclk(struct snd_soc_component *component, int clk_id,\n\t\t\t\t   int source, unsigned int freq, int dir)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tunsigned int reg_val = 0;\n\n\tswitch (clk_id) {\n\tcase RT5670_SCLK_S_MCLK:\n\t\treg_val |= RT5670_SCLK_SRC_MCLK;\n\t\tbreak;\n\tcase RT5670_SCLK_S_PLL1:\n\t\treg_val |= RT5670_SCLK_SRC_PLL1;\n\t\tbreak;\n\tcase RT5670_SCLK_S_RCCLK:\n\t\treg_val |= RT5670_SCLK_SRC_RCCLK;\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Invalid clock id (%d)\\n\", clk_id);\n\t\treturn -EINVAL;\n\t}\n\tsnd_soc_component_update_bits(component, RT5670_GLB_CLK,\n\t\tRT5670_SCLK_SRC_MASK, reg_val);\n\trt5670->sysclk = freq;\n\tif (clk_id != RT5670_SCLK_S_RCCLK)\n\t\trt5670->sysclk_src = clk_id;\n\n\tdev_dbg(component->dev, \"Sysclk : %dHz clock id : %d\\n\", freq, clk_id);\n\n\treturn 0;\n}\n\nstatic int rt5670_set_dai_pll(struct snd_soc_dai *dai, int pll_id, int source,\n\t\t\tunsigned int freq_in, unsigned int freq_out)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\tstruct rl6231_pll_code pll_code;\n\tint ret;\n\n\tif (source == rt5670->pll_src && freq_in == rt5670->pll_in &&\n\t    freq_out == rt5670->pll_out)\n\t\treturn 0;\n\n\tif (!freq_in || !freq_out) {\n\t\tdev_dbg(component->dev, \"PLL disabled\\n\");\n\n\t\trt5670->pll_in = 0;\n\t\trt5670->pll_out = 0;\n\t\tsnd_soc_component_update_bits(component, RT5670_GLB_CLK,\n\t\t\tRT5670_SCLK_SRC_MASK, RT5670_SCLK_SRC_MCLK);\n\t\treturn 0;\n\t}\n\n\tswitch (source) {\n\tcase RT5670_PLL1_S_MCLK:\n\t\tsnd_soc_component_update_bits(component, RT5670_GLB_CLK,\n\t\t\tRT5670_PLL1_SRC_MASK, RT5670_PLL1_SRC_MCLK);\n\t\tbreak;\n\tcase RT5670_PLL1_S_BCLK1:\n\tcase RT5670_PLL1_S_BCLK2:\n\tcase RT5670_PLL1_S_BCLK3:\n\tcase RT5670_PLL1_S_BCLK4:\n\t\tswitch (dai->id) {\n\t\tcase RT5670_AIF1:\n\t\t\tsnd_soc_component_update_bits(component, RT5670_GLB_CLK,\n\t\t\t\tRT5670_PLL1_SRC_MASK, RT5670_PLL1_SRC_BCLK1);\n\t\t\tbreak;\n\t\tcase RT5670_AIF2:\n\t\t\tsnd_soc_component_update_bits(component, RT5670_GLB_CLK,\n\t\t\t\tRT5670_PLL1_SRC_MASK, RT5670_PLL1_SRC_BCLK2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdev_err(component->dev, \"Invalid dai->id: %d\\n\", dai->id);\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev, \"Unknown PLL source %d\\n\", source);\n\t\treturn -EINVAL;\n\t}\n\n\tret = rl6231_pll_calc(freq_in, freq_out, &pll_code);\n\tif (ret < 0) {\n\t\tdev_err(component->dev, \"Unsupported input clock %d\\n\", freq_in);\n\t\treturn ret;\n\t}\n\n\tdev_dbg(component->dev, \"bypass=%d m=%d n=%d k=%d\\n\",\n\t\tpll_code.m_bp, (pll_code.m_bp ? 0 : pll_code.m_code),\n\t\tpll_code.n_code, pll_code.k_code);\n\n\tsnd_soc_component_write(component, RT5670_PLL_CTRL1,\n\t\tpll_code.n_code << RT5670_PLL_N_SFT | pll_code.k_code);\n\tsnd_soc_component_write(component, RT5670_PLL_CTRL2,\n\t\t((pll_code.m_bp ? 0 : pll_code.m_code) << RT5670_PLL_M_SFT) |\n\t\t(pll_code.m_bp << RT5670_PLL_M_BP_SFT));\n\n\trt5670->pll_in = freq_in;\n\trt5670->pll_out = freq_out;\n\trt5670->pll_src = source;\n\n\treturn 0;\n}\n\nstatic int rt5670_set_tdm_slot(struct snd_soc_dai *dai, unsigned int tx_mask,\n\t\t\tunsigned int rx_mask, int slots, int slot_width)\n{\n\tstruct snd_soc_component *component = dai->component;\n\tunsigned int val = 0;\n\n\tif (rx_mask || tx_mask)\n\t\tval |= (1 << 14);\n\n\tswitch (slots) {\n\tcase 4:\n\t\tval |= (1 << 12);\n\t\tbreak;\n\tcase 6:\n\t\tval |= (2 << 12);\n\t\tbreak;\n\tcase 8:\n\t\tval |= (3 << 12);\n\t\tbreak;\n\tcase 2:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tswitch (slot_width) {\n\tcase 20:\n\t\tval |= (1 << 10);\n\t\tbreak;\n\tcase 24:\n\t\tval |= (2 << 10);\n\t\tbreak;\n\tcase 32:\n\t\tval |= (3 << 10);\n\t\tbreak;\n\tcase 16:\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tsnd_soc_component_update_bits(component, RT5670_TDM_CTRL_1, 0x7c00, val);\n\n\treturn 0;\n}\n\nstatic int rt5670_set_bclk_ratio(struct snd_soc_dai *dai, unsigned int ratio)\n{\n\tstruct snd_soc_component *component = dai->component;\n\n\tdev_dbg(component->dev, \"%s ratio=%d\\n\", __func__, ratio);\n\tif (dai->id != RT5670_AIF1)\n\t\treturn 0;\n\n\tif ((ratio % 50) == 0)\n\t\tsnd_soc_component_update_bits(component, RT5670_GEN_CTRL3,\n\t\t\tRT5670_TDM_DATA_MODE_SEL, RT5670_TDM_DATA_MODE_50FS);\n\telse\n\t\tsnd_soc_component_update_bits(component, RT5670_GEN_CTRL3,\n\t\t\tRT5670_TDM_DATA_MODE_SEL, RT5670_TDM_DATA_MODE_NOR);\n\n\treturn 0;\n}\n\nstatic int rt5670_set_bias_level(struct snd_soc_component *component,\n\t\t\tenum snd_soc_bias_level level)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tswitch (level) {\n\tcase SND_SOC_BIAS_PREPARE:\n\t\tif (SND_SOC_BIAS_STANDBY == snd_soc_component_get_bias_level(component)) {\n\t\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_PWR_VREF1 | RT5670_PWR_MB |\n\t\t\t\tRT5670_PWR_BG | RT5670_PWR_VREF2,\n\t\t\t\tRT5670_PWR_VREF1 | RT5670_PWR_MB |\n\t\t\t\tRT5670_PWR_BG | RT5670_PWR_VREF2);\n\t\t\tmdelay(10);\n\t\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2,\n\t\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2);\n\t\t\tsnd_soc_component_update_bits(component, RT5670_CHARGE_PUMP,\n\t\t\t\tRT5670_OSW_L_MASK | RT5670_OSW_R_MASK,\n\t\t\t\tRT5670_OSW_L_DIS | RT5670_OSW_R_DIS);\n\t\t\tsnd_soc_component_update_bits(component, RT5670_DIG_MISC, 0x1, 0x1);\n\t\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_LDO_SEL_MASK, 0x5);\n\t\t}\n\t\tbreak;\n\tcase SND_SOC_BIAS_STANDBY:\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_PWR_VREF1 | RT5670_PWR_VREF2 |\n\t\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2, 0);\n\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_LDO_SEL_MASK, 0x3);\n\t\tbreak;\n\tcase SND_SOC_BIAS_OFF:\n\t\tif (rt5670->jd_mode)\n\t\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_PWR_VREF1 | RT5670_PWR_MB |\n\t\t\t\tRT5670_PWR_BG | RT5670_PWR_VREF2 |\n\t\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2,\n\t\t\t\tRT5670_PWR_MB | RT5670_PWR_BG);\n\t\telse\n\t\t\tsnd_soc_component_update_bits(component, RT5670_PWR_ANLG1,\n\t\t\t\tRT5670_PWR_VREF1 | RT5670_PWR_MB |\n\t\t\t\tRT5670_PWR_BG | RT5670_PWR_VREF2 |\n\t\t\t\tRT5670_PWR_FV1 | RT5670_PWR_FV2, 0);\n\n\t\tsnd_soc_component_update_bits(component, RT5670_DIG_MISC, 0x1, 0x0);\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic int rt5670_probe(struct snd_soc_component *component)\n{\n\tstruct snd_soc_dapm_context *dapm = snd_soc_component_get_dapm(component);\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tswitch (snd_soc_component_read(component, RT5670_RESET) & RT5670_ID_MASK) {\n\tcase RT5670_ID_5670:\n\tcase RT5670_ID_5671:\n\t\tsnd_soc_dapm_new_controls(dapm,\n\t\t\trt5670_specific_dapm_widgets,\n\t\t\tARRAY_SIZE(rt5670_specific_dapm_widgets));\n\t\tsnd_soc_dapm_add_routes(dapm,\n\t\t\trt5670_specific_dapm_routes,\n\t\t\tARRAY_SIZE(rt5670_specific_dapm_routes));\n\t\tbreak;\n\tcase RT5670_ID_5672:\n\t\tsnd_soc_dapm_new_controls(dapm,\n\t\t\trt5672_specific_dapm_widgets,\n\t\t\tARRAY_SIZE(rt5672_specific_dapm_widgets));\n\t\tsnd_soc_dapm_add_routes(dapm,\n\t\t\trt5672_specific_dapm_routes,\n\t\t\tARRAY_SIZE(rt5672_specific_dapm_routes));\n\t\tbreak;\n\tdefault:\n\t\tdev_err(component->dev,\n\t\t\t\"The driver is for RT5670 RT5671 or RT5672 only\\n\");\n\t\treturn -ENODEV;\n\t}\n\trt5670->component = component;\n\n\treturn 0;\n}\n\nstatic void rt5670_remove(struct snd_soc_component *component)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tregmap_write(rt5670->regmap, RT5670_RESET, 0);\n\tsnd_soc_jack_free_gpios(rt5670->jack, 1, &rt5670->hp_gpio);\n}\n\n#ifdef CONFIG_PM\nstatic int rt5670_suspend(struct snd_soc_component *component)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tregcache_cache_only(rt5670->regmap, true);\n\tregcache_mark_dirty(rt5670->regmap);\n\treturn 0;\n}\n\nstatic int rt5670_resume(struct snd_soc_component *component)\n{\n\tstruct rt5670_priv *rt5670 = snd_soc_component_get_drvdata(component);\n\n\tregcache_cache_only(rt5670->regmap, false);\n\tregcache_sync(rt5670->regmap);\n\n\treturn 0;\n}\n#else\n#define rt5670_suspend NULL\n#define rt5670_resume NULL\n#endif\n\n#define RT5670_STEREO_RATES SNDRV_PCM_RATE_8000_96000\n#define RT5670_FORMATS (SNDRV_PCM_FMTBIT_S16_LE | SNDRV_PCM_FMTBIT_S20_3LE | \\\n\t\t\tSNDRV_PCM_FMTBIT_S24_LE | SNDRV_PCM_FMTBIT_S8)\n\nstatic const struct snd_soc_dai_ops rt5670_aif_dai_ops = {\n\t.hw_params = rt5670_hw_params,\n\t.set_fmt = rt5670_set_dai_fmt,\n\t.set_tdm_slot = rt5670_set_tdm_slot,\n\t.set_pll = rt5670_set_dai_pll,\n\t.set_bclk_ratio = rt5670_set_bclk_ratio,\n};\n\nstatic struct snd_soc_dai_driver rt5670_dai[] = {\n\t{\n\t\t.name = \"rt5670-aif1\",\n\t\t.id = RT5670_AIF1,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF1 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5670_STEREO_RATES,\n\t\t\t.formats = RT5670_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF1 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5670_STEREO_RATES,\n\t\t\t.formats = RT5670_FORMATS,\n\t\t},\n\t\t.ops = &rt5670_aif_dai_ops,\n\t\t.symmetric_rate = 1,\n\t},\n\t{\n\t\t.name = \"rt5670-aif2\",\n\t\t.id = RT5670_AIF2,\n\t\t.playback = {\n\t\t\t.stream_name = \"AIF2 Playback\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5670_STEREO_RATES,\n\t\t\t.formats = RT5670_FORMATS,\n\t\t},\n\t\t.capture = {\n\t\t\t.stream_name = \"AIF2 Capture\",\n\t\t\t.channels_min = 1,\n\t\t\t.channels_max = 2,\n\t\t\t.rates = RT5670_STEREO_RATES,\n\t\t\t.formats = RT5670_FORMATS,\n\t\t},\n\t\t.ops = &rt5670_aif_dai_ops,\n\t\t.symmetric_rate = 1,\n\t},\n};\n\nstatic const struct snd_soc_component_driver soc_component_dev_rt5670 = {\n\t.probe\t\t\t= rt5670_probe,\n\t.remove\t\t\t= rt5670_remove,\n\t.suspend\t\t= rt5670_suspend,\n\t.resume\t\t\t= rt5670_resume,\n\t.set_bias_level\t\t= rt5670_set_bias_level,\n\t.set_sysclk\t\t= rt5670_set_codec_sysclk,\n\t.controls\t\t= rt5670_snd_controls,\n\t.num_controls\t\t= ARRAY_SIZE(rt5670_snd_controls),\n\t.dapm_widgets\t\t= rt5670_dapm_widgets,\n\t.num_dapm_widgets\t= ARRAY_SIZE(rt5670_dapm_widgets),\n\t.dapm_routes\t\t= rt5670_dapm_routes,\n\t.num_dapm_routes\t= ARRAY_SIZE(rt5670_dapm_routes),\n\t.use_pmdown_time\t= 1,\n\t.endianness\t\t= 1,\n};\n\nstatic const struct regmap_config rt5670_regmap = {\n\t.reg_bits = 8,\n\t.val_bits = 16,\n\t.use_single_read = true,\n\t.use_single_write = true,\n\t.max_register = RT5670_VENDOR_ID2 + 1 + (ARRAY_SIZE(rt5670_ranges) *\n\t\t\t\t\t       RT5670_PR_SPACING),\n\t.volatile_reg = rt5670_volatile_register,\n\t.readable_reg = rt5670_readable_register,\n\t.cache_type = REGCACHE_MAPLE,\n\t.reg_defaults = rt5670_reg,\n\t.num_reg_defaults = ARRAY_SIZE(rt5670_reg),\n\t.ranges = rt5670_ranges,\n\t.num_ranges = ARRAY_SIZE(rt5670_ranges),\n};\n\nstatic const struct i2c_device_id rt5670_i2c_id[] = {\n\t{ \"rt5670\", 0 },\n\t{ \"rt5671\", 0 },\n\t{ \"rt5672\", 0 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, rt5670_i2c_id);\n\n#ifdef CONFIG_ACPI\nstatic const struct acpi_device_id rt5670_acpi_match[] = {\n\t{ \"10EC5670\", 0},\n\t{ \"10EC5672\", 0},\n\t{ \"10EC5640\", 0},  \n\t{ },\n};\nMODULE_DEVICE_TABLE(acpi, rt5670_acpi_match);\n#endif\n\nstatic int rt5670_quirk_cb(const struct dmi_system_id *id)\n{\n\trt5670_quirk = (unsigned long)id->driver_data;\n\treturn 1;\n}\n\nstatic const struct dmi_system_id dmi_platform_intel_quirks[] = {\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Intel Braswell\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"Intel Corporation\"),\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"Braswell CRB\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC1_IN2P |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Dell Wyse 3040\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"Dell Inc.\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Wyse 3040\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC1_IN2P |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Lenovo Thinkpad Tablet 8\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_VERSION, \"ThinkPad 8\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC2_INR |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Lenovo Thinkpad Tablet 10\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_VERSION, \"ThinkPad 10\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC1_IN2P |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Lenovo Thinkpad Tablet 10\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_VERSION, \"ThinkPad Tablet B\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC1_IN2P |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Lenovo Miix 2 10\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"LENOVO\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_VERSION, \"Lenovo Miix 2 10\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC1_IN2P |\n\t\t\t\t\t\t RT5670_GPIO1_IS_EXT_SPK_EN |\n\t\t\t\t\t\t RT5670_JD_MODE2),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Dell Venue 8 Pro 5855\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"Dell Inc.\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Venue 8 Pro 5855\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC2_INR |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE3),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Dell Venue 10 Pro 5055\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"Dell Inc.\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"Venue 10 Pro 5055\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC2_INR |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE1),\n\t},\n\t{\n\t\t.callback = rt5670_quirk_cb,\n\t\t.ident = \"Aegex 10 tablet (RU2)\",\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_SYS_VENDOR, \"AEGEX\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_VERSION, \"RU2\"),\n\t\t},\n\t\t.driver_data = (unsigned long *)(RT5670_DMIC_EN |\n\t\t\t\t\t\t RT5670_DMIC2_INR |\n\t\t\t\t\t\t RT5670_GPIO1_IS_IRQ |\n\t\t\t\t\t\t RT5670_JD_MODE3),\n\t},\n\t{}\n};\n\nconst char *rt5670_components(void)\n{\n\tunsigned long quirk;\n\tbool dmic1 = false;\n\tbool dmic2 = false;\n\tbool dmic3 = false;\n\n\tif (quirk_override) {\n\t\tquirk = quirk_override;\n\t} else {\n\t\tdmi_check_system(dmi_platform_intel_quirks);\n\t\tquirk = rt5670_quirk;\n\t}\n\n\tif ((quirk & RT5670_DMIC1_IN2P) ||\n\t    (quirk & RT5670_DMIC1_GPIO6) ||\n\t    (quirk & RT5670_DMIC1_GPIO7))\n\t\tdmic1 = true;\n\n\tif ((quirk & RT5670_DMIC2_INR) ||\n\t    (quirk & RT5670_DMIC2_GPIO8))\n\t\tdmic2 = true;\n\n\tif (quirk & RT5670_DMIC3_GPIO5)\n\t\tdmic3 = true;\n\n\tif (dmic1 && dmic2)\n\t\treturn \"cfg-spk:2 cfg-mic:dmics12\";\n\telse if (dmic1)\n\t\treturn \"cfg-spk:2 cfg-mic:dmic1\";\n\telse if (dmic2)\n\t\treturn \"cfg-spk:2 cfg-mic:dmic2\";\n\telse if (dmic3)\n\t\treturn \"cfg-spk:2 cfg-mic:dmic3\";\n\n\treturn NULL;\n}\nEXPORT_SYMBOL_GPL(rt5670_components);\n\nstatic int rt5670_i2c_probe(struct i2c_client *i2c)\n{\n\tstruct rt5670_priv *rt5670;\n\tint ret;\n\tunsigned int val;\n\n\trt5670 = devm_kzalloc(&i2c->dev,\n\t\t\t\tsizeof(struct rt5670_priv),\n\t\t\t\tGFP_KERNEL);\n\tif (NULL == rt5670)\n\t\treturn -ENOMEM;\n\n\ti2c_set_clientdata(i2c, rt5670);\n\n\tdmi_check_system(dmi_platform_intel_quirks);\n\tif (quirk_override) {\n\t\tdev_info(&i2c->dev, \"Overriding quirk 0x%x => 0x%x\\n\",\n\t\t\t (unsigned int)rt5670_quirk, quirk_override);\n\t\trt5670_quirk = quirk_override;\n\t}\n\n\tif (rt5670_quirk & RT5670_GPIO1_IS_IRQ) {\n\t\trt5670->gpio1_is_irq = true;\n\t\tdev_info(&i2c->dev, \"quirk GPIO1 is IRQ\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_GPIO1_IS_EXT_SPK_EN) {\n\t\trt5670->gpio1_is_ext_spk_en = true;\n\t\tdev_info(&i2c->dev, \"quirk GPIO1 is external speaker enable\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_IN2_DIFF) {\n\t\trt5670->in2_diff = true;\n\t\tdev_info(&i2c->dev, \"quirk IN2_DIFF\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC_EN) {\n\t\trt5670->dmic_en = true;\n\t\tdev_info(&i2c->dev, \"quirk DMIC enabled\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC1_IN2P) {\n\t\trt5670->dmic1_data_pin = RT5670_DMIC_DATA_IN2P;\n\t\tdev_info(&i2c->dev, \"quirk DMIC1 on IN2P pin\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC1_GPIO6) {\n\t\trt5670->dmic1_data_pin = RT5670_DMIC_DATA_GPIO6;\n\t\tdev_info(&i2c->dev, \"quirk DMIC1 on GPIO6 pin\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC1_GPIO7) {\n\t\trt5670->dmic1_data_pin = RT5670_DMIC_DATA_GPIO7;\n\t\tdev_info(&i2c->dev, \"quirk DMIC1 on GPIO7 pin\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC2_INR) {\n\t\trt5670->dmic2_data_pin = RT5670_DMIC_DATA_IN3N;\n\t\tdev_info(&i2c->dev, \"quirk DMIC2 on INR pin\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC2_GPIO8) {\n\t\trt5670->dmic2_data_pin = RT5670_DMIC_DATA_GPIO8;\n\t\tdev_info(&i2c->dev, \"quirk DMIC2 on GPIO8 pin\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_DMIC3_GPIO5) {\n\t\trt5670->dmic3_data_pin = RT5670_DMIC_DATA_GPIO5;\n\t\tdev_info(&i2c->dev, \"quirk DMIC3 on GPIO5 pin\\n\");\n\t}\n\n\tif (rt5670_quirk & RT5670_JD_MODE1) {\n\t\trt5670->jd_mode = 1;\n\t\tdev_info(&i2c->dev, \"quirk JD mode 1\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_JD_MODE2) {\n\t\trt5670->jd_mode = 2;\n\t\tdev_info(&i2c->dev, \"quirk JD mode 2\\n\");\n\t}\n\tif (rt5670_quirk & RT5670_JD_MODE3) {\n\t\trt5670->jd_mode = 3;\n\t\tdev_info(&i2c->dev, \"quirk JD mode 3\\n\");\n\t}\n\n\t \n\trt5670->dac1_playback_switch_l = true;\n\trt5670->dac1_playback_switch_r = true;\n\t \n\trt5670->dac1_mixl_dac1_switch = true;\n\trt5670->dac1_mixr_dac1_switch = true;\n\n\trt5670->regmap = devm_regmap_init_i2c(i2c, &rt5670_regmap);\n\tif (IS_ERR(rt5670->regmap)) {\n\t\tret = PTR_ERR(rt5670->regmap);\n\t\tdev_err(&i2c->dev, \"Failed to allocate register map: %d\\n\",\n\t\t\tret);\n\t\treturn ret;\n\t}\n\n\tregmap_read(rt5670->regmap, RT5670_VENDOR_ID2, &val);\n\tif (val != RT5670_DEVICE_ID) {\n\t\tdev_err(&i2c->dev,\n\t\t\t\"Device with ID register %#x is not rt5670/72\\n\", val);\n\t\treturn -ENODEV;\n\t}\n\n\tregmap_write(rt5670->regmap, RT5670_RESET, 0);\n\tregmap_update_bits(rt5670->regmap, RT5670_PWR_ANLG1,\n\t\tRT5670_PWR_HP_L | RT5670_PWR_HP_R |\n\t\tRT5670_PWR_VREF2, RT5670_PWR_VREF2);\n\tmsleep(100);\n\n\tregmap_write(rt5670->regmap, RT5670_RESET, 0);\n\n\tregmap_read(rt5670->regmap, RT5670_VENDOR_ID, &val);\n\tif (val >= 4)\n\t\tregmap_write(rt5670->regmap, RT5670_GPIO_CTRL3, 0x0980);\n\telse\n\t\tregmap_write(rt5670->regmap, RT5670_GPIO_CTRL3, 0x0d00);\n\n\tret = regmap_register_patch(rt5670->regmap, init_list,\n\t\t\t\t    ARRAY_SIZE(init_list));\n\tif (ret != 0)\n\t\tdev_warn(&i2c->dev, \"Failed to apply regmap patch: %d\\n\", ret);\n\n\tregmap_update_bits(rt5670->regmap, RT5670_DIG_MISC,\n\t\t\t\t RT5670_MCLK_DET, RT5670_MCLK_DET);\n\n\tif (rt5670->in2_diff)\n\t\tregmap_update_bits(rt5670->regmap, RT5670_IN2,\n\t\t\t\t\tRT5670_IN_DF2, RT5670_IN_DF2);\n\n\tif (rt5670->gpio1_is_irq) {\n\t\t \n\t\tregmap_write(rt5670->regmap, RT5670_IL_CMD, 0x0000);\n\t\tregmap_write(rt5670->regmap, RT5670_IL_CMD2, 0x0010);\n\t\tregmap_write(rt5670->regmap, RT5670_IL_CMD3, 0x0014);\n\t\t \n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t   RT5670_GP1_PIN_MASK, RT5670_GP1_PIN_IRQ);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL2,\n\t\t\t\t   RT5670_GP1_PF_MASK, RT5670_GP1_PF_OUT);\n\t}\n\n\tif (rt5670->gpio1_is_ext_spk_en) {\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t   RT5670_GP1_PIN_MASK, RT5670_GP1_PIN_GPIO1);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL2,\n\t\t\t\t   RT5670_GP1_PF_MASK, RT5670_GP1_PF_OUT);\n\t}\n\n\tif (rt5670->jd_mode) {\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GLB_CLK,\n\t\t\t\t   RT5670_SCLK_SRC_MASK, RT5670_SCLK_SRC_RCCLK);\n\t\trt5670->sysclk = 0;\n\t\trt5670->sysclk_src = RT5670_SCLK_S_RCCLK;\n\t\tregmap_update_bits(rt5670->regmap, RT5670_PWR_ANLG1,\n\t\t\t\t   RT5670_PWR_MB, RT5670_PWR_MB);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_PWR_ANLG2,\n\t\t\t\t   RT5670_PWR_JD1, RT5670_PWR_JD1);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_IRQ_CTRL1,\n\t\t\t\t   RT5670_JD1_1_EN_MASK, RT5670_JD1_1_EN);\n\t\tregmap_update_bits(rt5670->regmap, RT5670_JD_CTRL3,\n\t\t\t\t   RT5670_JD_TRI_CBJ_SEL_MASK |\n\t\t\t\t   RT5670_JD_TRI_HPO_SEL_MASK,\n\t\t\t\t   RT5670_JD_CBJ_JD1_1 | RT5670_JD_HPO_JD1_1);\n\t\tswitch (rt5670->jd_mode) {\n\t\tcase 1:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_A_JD_CTRL1,\n\t\t\t\t\t   RT5670_JD1_MODE_MASK,\n\t\t\t\t\t   RT5670_JD1_MODE_0);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_A_JD_CTRL1,\n\t\t\t\t\t   RT5670_JD1_MODE_MASK,\n\t\t\t\t\t   RT5670_JD1_MODE_1);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_A_JD_CTRL1,\n\t\t\t\t\t   RT5670_JD1_MODE_MASK,\n\t\t\t\t\t   RT5670_JD1_MODE_2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (rt5670->dmic_en) {\n\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t   RT5670_GP2_PIN_MASK,\n\t\t\t\t   RT5670_GP2_PIN_DMIC1_SCL);\n\n\t\tswitch (rt5670->dmic1_data_pin) {\n\t\tcase RT5670_DMIC_DATA_IN2P:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL1,\n\t\t\t\t\t   RT5670_DMIC_1_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_1_DP_IN2P);\n\t\t\tbreak;\n\n\t\tcase RT5670_DMIC_DATA_GPIO6:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL1,\n\t\t\t\t\t   RT5670_DMIC_1_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_1_DP_GPIO6);\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t\t   RT5670_GP6_PIN_MASK,\n\t\t\t\t\t   RT5670_GP6_PIN_DMIC1_SDA);\n\t\t\tbreak;\n\n\t\tcase RT5670_DMIC_DATA_GPIO7:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL1,\n\t\t\t\t\t   RT5670_DMIC_1_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_1_DP_GPIO7);\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t\t   RT5670_GP7_PIN_MASK,\n\t\t\t\t\t   RT5670_GP7_PIN_DMIC1_SDA);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch (rt5670->dmic2_data_pin) {\n\t\tcase RT5670_DMIC_DATA_IN3N:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL1,\n\t\t\t\t\t   RT5670_DMIC_2_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_2_DP_IN3N);\n\t\t\tbreak;\n\n\t\tcase RT5670_DMIC_DATA_GPIO8:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL1,\n\t\t\t\t\t   RT5670_DMIC_2_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_2_DP_GPIO8);\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t\t   RT5670_GP8_PIN_MASK,\n\t\t\t\t\t   RT5670_GP8_PIN_DMIC2_SDA);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch (rt5670->dmic3_data_pin) {\n\t\tcase RT5670_DMIC_DATA_GPIO5:\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_DMIC_CTRL2,\n\t\t\t\t\t   RT5670_DMIC_3_DP_MASK,\n\t\t\t\t\t   RT5670_DMIC_3_DP_GPIO5);\n\t\t\tregmap_update_bits(rt5670->regmap, RT5670_GPIO_CTRL1,\n\t\t\t\t\t   RT5670_GP5_PIN_MASK,\n\t\t\t\t\t   RT5670_GP5_PIN_DMIC3_SDA);\n\t\t\tbreak;\n\n\t\tcase RT5670_DMIC_DATA_GPIO9:\n\t\tcase RT5670_DMIC_DATA_GPIO10:\n\t\t\tdev_err(&i2c->dev,\n\t\t\t\t\"Always use GPIO5 as DMIC3 data pin\\n\");\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t}\n\n\tpm_runtime_enable(&i2c->dev);\n\tpm_request_idle(&i2c->dev);\n\n\tret = devm_snd_soc_register_component(&i2c->dev,\n\t\t\t&soc_component_dev_rt5670,\n\t\t\trt5670_dai, ARRAY_SIZE(rt5670_dai));\n\tif (ret < 0)\n\t\tgoto err;\n\n\treturn 0;\nerr:\n\tpm_runtime_disable(&i2c->dev);\n\n\treturn ret;\n}\n\nstatic void rt5670_i2c_remove(struct i2c_client *i2c)\n{\n\tpm_runtime_disable(&i2c->dev);\n}\n\nstatic struct i2c_driver rt5670_i2c_driver = {\n\t.driver = {\n\t\t.name = \"rt5670\",\n\t\t.acpi_match_table = ACPI_PTR(rt5670_acpi_match),\n\t},\n\t.probe    = rt5670_i2c_probe,\n\t.remove   = rt5670_i2c_remove,\n\t.id_table = rt5670_i2c_id,\n};\n\nmodule_i2c_driver(rt5670_i2c_driver);\n\nMODULE_DESCRIPTION(\"ASoC RT5670 driver\");\nMODULE_AUTHOR(\"Bard Liao <bardliao@realtek.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}