{
  "module_name": "lpass.h",
  "hash_id": "ddc6bbfe4365834027a250adb98ea7883ebff0049f00592e8b85cc264936d0fa",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/qcom/lpass.h",
  "human_readable_source": " \n \n\n#ifndef __LPASS_H__\n#define __LPASS_H__\n\n#include <linux/clk.h>\n#include <linux/compiler.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n#include <dt-bindings/sound/qcom,lpass.h>\n#include \"lpass-hdmi.h\"\n\n#define LPASS_AHBIX_CLOCK_FREQUENCY\t\t131072000\n#define LPASS_MAX_PORTS\t\t\t(LPASS_CDC_DMA_VA_TX8 + 1)\n#define LPASS_MAX_MI2S_PORTS\t\t\t(8)\n#define LPASS_MAX_DMA_CHANNELS\t\t\t(8)\n#define LPASS_MAX_HDMI_DMA_CHANNELS\t\t(4)\n#define LPASS_MAX_CDC_DMA_CHANNELS\t\t(8)\n#define LPASS_MAX_VA_CDC_DMA_CHANNELS\t\t(8)\n#define LPASS_CDC_DMA_INTF_ONE_CHANNEL\t\t(0x01)\n#define LPASS_CDC_DMA_INTF_TWO_CHANNEL\t\t(0x03)\n#define LPASS_CDC_DMA_INTF_FOUR_CHANNEL\t\t(0x0F)\n#define LPASS_CDC_DMA_INTF_SIX_CHANNEL\t\t(0x3F)\n#define LPASS_CDC_DMA_INTF_EIGHT_CHANNEL\t(0xFF)\n\n#define LPASS_ACTIVE_PDS\t\t\t(4)\n#define LPASS_PROXY_PDS\t\t\t(8)\n\n#define QCOM_REGMAP_FIELD_ALLOC(d, m, f, mf)    \\\n\tdo { \\\n\t\tmf = devm_regmap_field_alloc(d, m, f);     \\\n\t\tif (IS_ERR(mf))                \\\n\t\t\treturn -EINVAL;         \\\n\t} while (0)\n\nstatic inline bool is_cdc_dma_port(int dai_id)\n{\n\tswitch (dai_id) {\n\tcase LPASS_CDC_DMA_RX0 ... LPASS_CDC_DMA_RX9:\n\tcase LPASS_CDC_DMA_TX0 ... LPASS_CDC_DMA_TX8:\n\tcase LPASS_CDC_DMA_VA_TX0 ... LPASS_CDC_DMA_VA_TX8:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic inline bool is_rxtx_cdc_dma_port(int dai_id)\n{\n\tswitch (dai_id) {\n\tcase LPASS_CDC_DMA_RX0 ... LPASS_CDC_DMA_RX9:\n\tcase LPASS_CDC_DMA_TX0 ... LPASS_CDC_DMA_TX8:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstruct lpaif_i2sctl {\n\tstruct regmap_field *loopback;\n\tstruct regmap_field *spken;\n\tstruct regmap_field *spkmode;\n\tstruct regmap_field *spkmono;\n\tstruct regmap_field *micen;\n\tstruct regmap_field *micmode;\n\tstruct regmap_field *micmono;\n\tstruct regmap_field *wssrc;\n\tstruct regmap_field *bitwidth;\n};\n\n\nstruct lpaif_dmactl {\n\tstruct regmap_field *intf;\n\tstruct regmap_field *bursten;\n\tstruct regmap_field *wpscnt;\n\tstruct regmap_field *fifowm;\n\tstruct regmap_field *enable;\n\tstruct regmap_field *dyncclk;\n\tstruct regmap_field *burst8;\n\tstruct regmap_field *burst16;\n\tstruct regmap_field *dynburst;\n\tstruct regmap_field *codec_enable;\n\tstruct regmap_field *codec_pack;\n\tstruct regmap_field *codec_intf;\n\tstruct regmap_field *codec_fs_sel;\n\tstruct regmap_field *codec_channel;\n\tstruct regmap_field *codec_fs_delay;\n};\n\n \nstruct lpass_data {\n\n\t \n\tstruct clk *ahbix_clk;\n\n\t \n\tstruct clk *mi2s_osr_clk[LPASS_MAX_MI2S_PORTS];\n\n\t \n\tstruct clk *mi2s_bit_clk[LPASS_MAX_MI2S_PORTS];\n\n\tstruct clk *codec_mem0;\n\tstruct clk *codec_mem1;\n\tstruct clk *codec_mem2;\n\tstruct clk *va_mem0;\n\n\t \n\tunsigned int mi2s_playback_sd_mode[LPASS_MAX_MI2S_PORTS];\n\tunsigned int mi2s_capture_sd_mode[LPASS_MAX_MI2S_PORTS];\n\n\t \n\tbool mi2s_was_prepared[LPASS_MAX_MI2S_PORTS];\n\n\tint hdmi_port_enable;\n\tint codec_dma_enable;\n\n\t \n\tvoid __iomem *lpaif;\n\tvoid __iomem *hdmiif;\n\tvoid __iomem *rxtx_lpaif;\n\tvoid __iomem *va_lpaif;\n\n\tu32 rxtx_cdc_dma_lpm_buf;\n\tu32 va_cdc_dma_lpm_buf;\n\n\t \n\tstruct regmap *lpaif_map;\n\tstruct regmap *hdmiif_map;\n\tstruct regmap *rxtx_lpaif_map;\n\tstruct regmap *va_lpaif_map;\n\n\t \n\tint lpaif_irq;\n\tint hdmiif_irq;\n\tint rxtxif_irq;\n\tint vaif_irq;\n\n\t \n\tstruct lpass_variant *variant;\n\n\t \n\tunsigned long dma_ch_bit_map;\n\tunsigned long hdmi_dma_ch_bit_map;\n\tunsigned long rxtx_dma_ch_bit_map;\n\tunsigned long va_dma_ch_bit_map;\n\n\t \n\tstruct snd_pcm_substream *substream[LPASS_MAX_DMA_CHANNELS];\n\tstruct snd_pcm_substream *hdmi_substream[LPASS_MAX_HDMI_DMA_CHANNELS];\n\tstruct snd_pcm_substream *rxtx_substream[LPASS_MAX_CDC_DMA_CHANNELS];\n\tstruct snd_pcm_substream *va_substream[LPASS_MAX_CDC_DMA_CHANNELS];\n\n\t \n\tstruct clk_bulk_data *clks;\n\tint num_clks;\n\n\t \n\tstruct lpaif_i2sctl *i2sctl;\n\tstruct lpaif_dmactl *rd_dmactl;\n\tstruct lpaif_dmactl *wr_dmactl;\n\tstruct lpaif_dmactl *hdmi_rd_dmactl;\n\n\t \n\tstruct lpaif_dmactl *rxtx_rd_dmactl;\n\tstruct lpaif_dmactl *rxtx_wr_dmactl;\n\tstruct lpaif_dmactl *va_wr_dmactl;\n\n\t \n\tstruct regmap_field *hdmitx_legacy_en;\n\tstruct regmap_field *hdmitx_parity_calc_en;\n\tstruct regmap_field *hdmitx_ch_msb[LPASS_MAX_HDMI_DMA_CHANNELS];\n\tstruct regmap_field *hdmitx_ch_lsb[LPASS_MAX_HDMI_DMA_CHANNELS];\n\tstruct lpass_hdmi_tx_ctl *tx_ctl;\n\tstruct lpass_vbit_ctrl *vbit_ctl;\n\tstruct lpass_hdmitx_dmactl *hdmi_tx_dmactl[LPASS_MAX_HDMI_DMA_CHANNELS];\n\tstruct lpass_dp_metadata_ctl *meta_ctl;\n\tstruct lpass_sstream_ctl *sstream_ctl;\n};\n\n \nstruct lpass_variant {\n\tu32\tirq_reg_base;\n\tu32\tirq_reg_stride;\n\tu32\tirq_ports;\n\tu32\trdma_reg_base;\n\tu32\trdma_reg_stride;\n\tu32\trdma_channels;\n\tu32\thdmi_rdma_reg_base;\n\tu32\thdmi_rdma_reg_stride;\n\tu32\thdmi_rdma_channels;\n\tu32\twrdma_reg_base;\n\tu32\twrdma_reg_stride;\n\tu32\twrdma_channels;\n\tu32\trxtx_irq_reg_base;\n\tu32\trxtx_irq_reg_stride;\n\tu32\trxtx_irq_ports;\n\tu32\trxtx_rdma_reg_base;\n\tu32\trxtx_rdma_reg_stride;\n\tu32\trxtx_rdma_channels;\n\tu32\trxtx_wrdma_reg_base;\n\tu32\trxtx_wrdma_reg_stride;\n\tu32\trxtx_wrdma_channels;\n\tu32\tva_irq_reg_base;\n\tu32\tva_irq_reg_stride;\n\tu32\tva_irq_ports;\n\tu32\tva_rdma_reg_base;\n\tu32\tva_rdma_reg_stride;\n\tu32\tva_rdma_channels;\n\tu32\tva_wrdma_reg_base;\n\tu32\tva_wrdma_reg_stride;\n\tu32\tva_wrdma_channels;\n\tu32\ti2sctrl_reg_base;\n\tu32\ti2sctrl_reg_stride;\n\tu32\ti2s_ports;\n\n\t \n\tstruct reg_field loopback;\n\tstruct reg_field spken;\n\tstruct reg_field spkmode;\n\tstruct reg_field spkmono;\n\tstruct reg_field micen;\n\tstruct reg_field micmode;\n\tstruct reg_field micmono;\n\tstruct reg_field wssrc;\n\tstruct reg_field bitwidth;\n\n\tu32\thdmi_irq_reg_base;\n\tu32\thdmi_irq_reg_stride;\n\tu32\thdmi_irq_ports;\n\n\t \n\tu32\thdmi_tx_ctl_addr;\n\tu32\thdmi_legacy_addr;\n\tu32\thdmi_vbit_addr;\n\tu32\thdmi_ch_lsb_addr;\n\tu32\thdmi_ch_msb_addr;\n\tu32\tch_stride;\n\tu32\thdmi_parity_addr;\n\tu32\thdmi_dmactl_addr;\n\tu32\thdmi_dma_stride;\n\tu32\thdmi_DP_addr;\n\tu32\thdmi_sstream_addr;\n\n\t \n\tstruct reg_field sstream_en;\n\tstruct reg_field dma_sel;\n\tstruct reg_field auto_bbit_en;\n\tstruct reg_field layout;\n\tstruct reg_field layout_sp;\n\tstruct reg_field set_sp_on_en;\n\tstruct reg_field dp_audio;\n\tstruct reg_field dp_staffing_en;\n\tstruct reg_field dp_sp_b_hw_en;\n\n\t \n\tstruct reg_field mute;\n\tstruct reg_field as_sdp_cc;\n\tstruct reg_field as_sdp_ct;\n\tstruct reg_field aif_db4;\n\tstruct reg_field frequency;\n\tstruct reg_field mst_index;\n\tstruct reg_field dptx_index;\n\n\t \n\tstruct reg_field soft_reset;\n\tstruct reg_field force_reset;\n\n\t \n\tstruct reg_field use_hw_chs;\n\tstruct reg_field use_hw_usr;\n\tstruct reg_field hw_chs_sel;\n\tstruct reg_field hw_usr_sel;\n\n\t \n\tstruct reg_field replace_vbit;\n\tstruct reg_field vbit_stream;\n\n\t \n\tstruct reg_field legacy_en;\n\n\t \n\tstruct reg_field calc_en;\n\n\t \n\tstruct reg_field lsb_bits;\n\n\t \n\tstruct reg_field msb_bits;\n\n\tstruct reg_field hdmi_rdma_bursten;\n\tstruct reg_field hdmi_rdma_wpscnt;\n\tstruct reg_field hdmi_rdma_fifowm;\n\tstruct reg_field hdmi_rdma_enable;\n\tstruct reg_field hdmi_rdma_dyncclk;\n\tstruct reg_field hdmi_rdma_burst8;\n\tstruct reg_field hdmi_rdma_burst16;\n\tstruct reg_field hdmi_rdma_dynburst;\n\n\t \n\tstruct reg_field rdma_intf;\n\tstruct reg_field rdma_bursten;\n\tstruct reg_field rdma_wpscnt;\n\tstruct reg_field rdma_fifowm;\n\tstruct reg_field rdma_enable;\n\tstruct reg_field rdma_dyncclk;\n\n\t \n\tstruct reg_field wrdma_intf;\n\tstruct reg_field wrdma_bursten;\n\tstruct reg_field wrdma_wpscnt;\n\tstruct reg_field wrdma_fifowm;\n\tstruct reg_field wrdma_enable;\n\tstruct reg_field wrdma_dyncclk;\n\n\t \n\tstruct reg_field rxtx_rdma_intf;\n\tstruct reg_field rxtx_rdma_bursten;\n\tstruct reg_field rxtx_rdma_wpscnt;\n\tstruct reg_field rxtx_rdma_fifowm;\n\tstruct reg_field rxtx_rdma_enable;\n\tstruct reg_field rxtx_rdma_dyncclk;\n\tstruct reg_field rxtx_rdma_burst8;\n\tstruct reg_field rxtx_rdma_burst16;\n\tstruct reg_field rxtx_rdma_dynburst;\n\tstruct reg_field rxtx_rdma_codec_enable;\n\tstruct reg_field rxtx_rdma_codec_pack;\n\tstruct reg_field rxtx_rdma_codec_intf;\n\tstruct reg_field rxtx_rdma_codec_fs_sel;\n\tstruct reg_field rxtx_rdma_codec_ch;\n\tstruct reg_field rxtx_rdma_codec_fs_delay;\n\n\t \n\tstruct reg_field rxtx_wrdma_intf;\n\tstruct reg_field rxtx_wrdma_bursten;\n\tstruct reg_field rxtx_wrdma_wpscnt;\n\tstruct reg_field rxtx_wrdma_fifowm;\n\tstruct reg_field rxtx_wrdma_enable;\n\tstruct reg_field rxtx_wrdma_dyncclk;\n\tstruct reg_field rxtx_wrdma_burst8;\n\tstruct reg_field rxtx_wrdma_burst16;\n\tstruct reg_field rxtx_wrdma_dynburst;\n\tstruct reg_field rxtx_wrdma_codec_enable;\n\tstruct reg_field rxtx_wrdma_codec_pack;\n\tstruct reg_field rxtx_wrdma_codec_intf;\n\tstruct reg_field rxtx_wrdma_codec_fs_sel;\n\tstruct reg_field rxtx_wrdma_codec_ch;\n\tstruct reg_field rxtx_wrdma_codec_fs_delay;\n\n\t \n\tstruct reg_field va_wrdma_intf;\n\tstruct reg_field va_wrdma_bursten;\n\tstruct reg_field va_wrdma_wpscnt;\n\tstruct reg_field va_wrdma_fifowm;\n\tstruct reg_field va_wrdma_enable;\n\tstruct reg_field va_wrdma_dyncclk;\n\tstruct reg_field va_wrdma_burst8;\n\tstruct reg_field va_wrdma_burst16;\n\tstruct reg_field va_wrdma_dynburst;\n\tstruct reg_field va_wrdma_codec_enable;\n\tstruct reg_field va_wrdma_codec_pack;\n\tstruct reg_field va_wrdma_codec_intf;\n\tstruct reg_field va_wrdma_codec_fs_sel;\n\tstruct reg_field va_wrdma_codec_ch;\n\tstruct reg_field va_wrdma_codec_fs_delay;\n\n\t \n\tu32\tdmactl_audif_start;\n\tu32\twrdma_channel_start;\n\tu32\trxtx_wrdma_channel_start;\n\tu32\tva_wrdma_channel_start;\n\n\t \n\tint (*init)(struct platform_device *pdev);\n\tint (*exit)(struct platform_device *pdev);\n\tint (*alloc_dma_channel)(struct lpass_data *data, int direction, unsigned int dai_id);\n\tint (*free_dma_channel)(struct lpass_data *data, int ch, unsigned int dai_id);\n\n\t \n\tstruct snd_soc_dai_driver *dai_driver;\n\tint num_dai;\n\tconst char * const *dai_osr_clk_names;\n\tconst char * const *dai_bit_clk_names;\n\n\t \n\tconst char **clk_name;\n\tint num_clks;\n};\n\nstruct lpass_pcm_data {\n\tint dma_ch;\n\tint i2s_port;\n};\n\n \nint asoc_qcom_lpass_platform_register(struct platform_device *);\nint asoc_qcom_lpass_cpu_platform_remove(struct platform_device *pdev);\nvoid asoc_qcom_lpass_cpu_platform_shutdown(struct platform_device *pdev);\nint asoc_qcom_lpass_cpu_platform_probe(struct platform_device *pdev);\nextern const struct snd_soc_dai_ops asoc_qcom_lpass_cpu_dai_ops;\nextern const struct snd_soc_dai_ops asoc_qcom_lpass_cpu_dai_ops2;\nextern const struct snd_soc_dai_ops asoc_qcom_lpass_cdc_dma_dai_ops;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}