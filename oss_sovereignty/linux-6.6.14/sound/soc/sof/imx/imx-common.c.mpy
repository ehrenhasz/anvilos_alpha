{
  "module_name": "imx-common.c",
  "hash_id": "dd19e328c94fabb03eb87ad732c1297a11d7ce2318fbc24cf30f6ee74da6cecf",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/sof/imx/imx-common.c",
  "human_readable_source": "\n\n\n\n\n\n#include <linux/module.h>\n#include <sound/sof/xtensa.h>\n#include \"../ops.h\"\n\n#include \"imx-common.h\"\n\n \nvoid imx8_get_registers(struct snd_sof_dev *sdev,\n\t\t\tstruct sof_ipc_dsp_oops_xtensa *xoops,\n\t\t\tstruct sof_ipc_panic_info *panic_info,\n\t\t\tu32 *stack, size_t stack_words)\n{\n\tu32 offset = sdev->dsp_oops_offset;\n\n\t \n\tsof_mailbox_read(sdev, offset, xoops, sizeof(*xoops));\n\n\t \n\tif (xoops->arch_hdr.totalsize > EXCEPT_MAX_HDR_SIZE) {\n\t\tdev_err(sdev->dev, \"invalid header size 0x%x. FW oops is bogus\\n\",\n\t\t\txoops->arch_hdr.totalsize);\n\t\treturn;\n\t}\n\toffset += xoops->arch_hdr.totalsize;\n\tsof_mailbox_read(sdev, offset, panic_info, sizeof(*panic_info));\n\n\t \n\toffset += sizeof(*panic_info);\n\tsof_mailbox_read(sdev, offset, stack, stack_words * sizeof(u32));\n}\n\n \nvoid imx8_dump(struct snd_sof_dev *sdev, u32 flags)\n{\n\tstruct sof_ipc_dsp_oops_xtensa xoops;\n\tstruct sof_ipc_panic_info panic_info;\n\tu32 stack[IMX8_STACK_DUMP_SIZE];\n\tu32 status;\n\n\t \n\tsof_mailbox_read(sdev, sdev->debug_box.offset + 0x4, &status, 4);\n\n\t \n\timx8_get_registers(sdev, &xoops, &panic_info, stack,\n\t\t\t   IMX8_STACK_DUMP_SIZE);\n\n\t \n\tsof_print_oops_and_stack(sdev, KERN_ERR, status, status, &xoops,\n\t\t\t\t &panic_info, stack, IMX8_STACK_DUMP_SIZE);\n}\nEXPORT_SYMBOL(imx8_dump);\n\nint imx8_parse_clocks(struct snd_sof_dev *sdev, struct imx_clocks *clks)\n{\n\tint ret;\n\n\tret = devm_clk_bulk_get(sdev->dev, clks->num_dsp_clks, clks->dsp_clks);\n\tif (ret)\n\t\tdev_err(sdev->dev, \"Failed to request DSP clocks\\n\");\n\n\treturn ret;\n}\nEXPORT_SYMBOL(imx8_parse_clocks);\n\nint imx8_enable_clocks(struct snd_sof_dev *sdev, struct imx_clocks *clks)\n{\n\treturn clk_bulk_prepare_enable(clks->num_dsp_clks, clks->dsp_clks);\n}\nEXPORT_SYMBOL(imx8_enable_clocks);\n\nvoid imx8_disable_clocks(struct snd_sof_dev *sdev, struct imx_clocks *clks)\n{\n\tclk_bulk_disable_unprepare(clks->num_dsp_clks, clks->dsp_clks);\n}\nEXPORT_SYMBOL(imx8_disable_clocks);\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}