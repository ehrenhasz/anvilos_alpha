{
  "module_name": "skl.c",
  "hash_id": "49654bd10bc7f29831a5619a26c38afa575f3d74d62100abf4c32c6b9210362a",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/sof/intel/skl.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n \n\n#include <linux/delay.h>\n#include <linux/device.h>\n#include <linux/dma-mapping.h>\n#include <linux/firmware.h>\n#include <linux/fs.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/pci.h>\n#include <sound/hdaudio_ext.h>\n#include <sound/pcm_params.h>\n#include <sound/sof.h>\n#include <sound/sof/ext_manifest4.h>\n\n#include \"../sof-priv.h\"\n#include \"../ipc4-priv.h\"\n#include \"../ops.h\"\n#include \"hda.h\"\n#include \"../sof-audio.h\"\n\n#define SRAM_MEMORY_WINDOW_BASE 0x8000\n\nstatic const __maybe_unused struct snd_sof_debugfs_map skl_dsp_debugfs[] = {\n\t{\"hda\", HDA_DSP_HDA_BAR, 0, 0x4000},\n\t{\"pp\", HDA_DSP_PP_BAR,  0, 0x1000},\n\t{\"dsp\", HDA_DSP_BAR,  0, 0x10000},\n};\n\nstatic int skl_dsp_ipc_get_window_offset(struct snd_sof_dev *sdev, u32 id)\n{\n\treturn SRAM_MEMORY_WINDOW_BASE + (0x2000 * id);\n}\n\nstatic int skl_dsp_ipc_get_mailbox_offset(struct snd_sof_dev *sdev)\n{\n\treturn SRAM_MEMORY_WINDOW_BASE + 0x1000;\n}\n\n \nstruct snd_sof_dsp_ops sof_skl_ops;\nEXPORT_SYMBOL_NS(sof_skl_ops, SND_SOC_SOF_INTEL_HDA_COMMON);\n\nint sof_skl_ops_init(struct snd_sof_dev *sdev)\n{\n\tstruct sof_ipc4_fw_data *ipc4_data;\n\n\t \n\tmemcpy(&sof_skl_ops, &sof_hda_common_ops, sizeof(struct snd_sof_dsp_ops));\n\n\t \n\tsof_skl_ops.shutdown\t= hda_dsp_shutdown;\n\n\tsdev->private = devm_kzalloc(sdev->dev, sizeof(*ipc4_data), GFP_KERNEL);\n\tif (!sdev->private)\n\t\treturn -ENOMEM;\n\n\tipc4_data = sdev->private;\n\tipc4_data->manifest_fw_hdr_offset = SOF_MAN4_FW_HDR_OFFSET_CAVS_1_5;\n\n\tipc4_data->mtrace_type = SOF_IPC4_MTRACE_INTEL_CAVS_1_5;\n\n\tsof_skl_ops.get_window_offset = skl_dsp_ipc_get_window_offset;\n\tsof_skl_ops.get_mailbox_offset = skl_dsp_ipc_get_mailbox_offset;\n\n\t \n\tsof_skl_ops.irq_thread\t= hda_dsp_ipc4_irq_thread;\n\n\t \n\tsof_skl_ops.send_msg\t= hda_dsp_ipc4_send_msg;\n\n\t \n\thda_set_dai_drv_ops(sdev, &sof_skl_ops);\n\n\t \n\tsof_skl_ops.debug_map\t= skl_dsp_debugfs;\n\tsof_skl_ops.debug_map_count\t= ARRAY_SIZE(skl_dsp_debugfs);\n\tsof_skl_ops.ipc_dump\t= hda_ipc4_dump;\n\n\t \n\tsof_skl_ops.run = hda_dsp_cl_boot_firmware_skl;\n\n\t \n\tsof_skl_ops.post_fw_run = hda_dsp_post_fw_run;\n\n\treturn 0;\n};\nEXPORT_SYMBOL_NS(sof_skl_ops_init, SND_SOC_SOF_INTEL_HDA_COMMON);\n\nconst struct sof_intel_dsp_desc skl_chip_info = {\n\t.cores_num = 2,\n\t.init_core_mask = 1,\n\t.host_managed_cores_mask = GENMASK(1, 0),\n\t.ipc_req = HDA_DSP_REG_HIPCI,\n\t.ipc_req_mask = HDA_DSP_REG_HIPCI_BUSY,\n\t.ipc_ack = HDA_DSP_REG_HIPCIE,\n\t.ipc_ack_mask = HDA_DSP_REG_HIPCIE_DONE,\n\t.ipc_ctl = HDA_DSP_REG_HIPCCTL,\n\t.rom_status_reg = HDA_DSP_SRAM_REG_ROM_STATUS_SKL,\n\t.rom_init_timeout\t= 300,\n\t.check_ipc_irq\t= hda_dsp_check_ipc_irq,\n\t.power_down_dsp = hda_power_down_dsp,\n\t.disable_interrupts = hda_dsp_disable_interrupts,\n\t.hw_ip_version = SOF_INTEL_CAVS_1_5,\n};\nEXPORT_SYMBOL_NS(skl_chip_info, SND_SOC_SOF_INTEL_HDA_COMMON);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}