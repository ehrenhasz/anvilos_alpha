{
  "module_name": "pci-rmb.c",
  "hash_id": "7e7e40b0770905a7be43c0f827d92f01a8637b7357b0fabf289f2a81a25135e9",
  "original_prompt": "Ingested from linux-6.6.14/sound/soc/sof/amd/pci-rmb.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n\n \n\n#include <linux/module.h>\n#include <linux/pci.h>\n#include <linux/platform_device.h>\n#include <sound/sof.h>\n#include <sound/soc-acpi.h>\n\n#include \"../ops.h\"\n#include \"../sof-pci-dev.h\"\n#include \"../../amd/mach-config.h\"\n#include \"acp.h\"\n#include \"acp-dsp-offset.h\"\n\n#define ACP6x_REG_START\t\t0x1240000\n#define ACP6x_REG_END\t\t0x125C000\n#define ACP6X_FUTURE_REG_ACLK_0\t0x1854\n\nstatic const struct sof_amd_acp_desc rembrandt_chip_info = {\n\t.rev\t\t= 6,\n\t.host_bridge_id = HOST_BRIDGE_RMB,\n\t.pgfsm_base\t= ACP6X_PGFSM_BASE,\n\t.ext_intr_stat\t= ACP6X_EXT_INTR_STAT,\n\t.dsp_intr_base\t= ACP6X_DSP_SW_INTR_BASE,\n\t.sram_pte_offset = ACP6X_SRAM_PTE_OFFSET,\n\t.hw_semaphore_offset = ACP6X_AXI2DAGB_SEM_0,\n\t.fusion_dsp_offset = ACP6X_DSP_FUSION_RUNSTALL,\n\t.probe_reg_offset = ACP6X_FUTURE_REG_ACLK_0,\n};\n\nstatic const struct sof_dev_desc rembrandt_desc = {\n\t.machines\t\t= snd_soc_acpi_amd_rmb_sof_machines,\n\t.resindex_lpe_base\t= 0,\n\t.resindex_pcicfg_base\t= -1,\n\t.resindex_imr_base\t= -1,\n\t.irqindex_host_ipc\t= -1,\n\t.chip_info\t\t= &rembrandt_chip_info,\n\t.ipc_supported_mask     = BIT(SOF_IPC),\n\t.ipc_default            = SOF_IPC,\n\t.default_fw_path\t= {\n\t\t[SOF_IPC] = \"amd/sof\",\n\t},\n\t.default_tplg_path\t= {\n\t\t[SOF_IPC] = \"amd/sof-tplg\",\n\t},\n\t.default_fw_filename\t= {\n\t\t[SOF_IPC] = \"sof-rmb.ri\",\n\t},\n\t.nocodec_tplg_filename\t= \"sof-acp.tplg\",\n\t.ops\t\t\t= &sof_rembrandt_ops,\n\t.ops_init\t\t= sof_rembrandt_ops_init,\n};\n\nstatic int acp_pci_rmb_probe(struct pci_dev *pci, const struct pci_device_id *pci_id)\n{\n\tunsigned int flag;\n\n\tif (pci->revision != ACP_RMB_PCI_ID)\n\t\treturn -ENODEV;\n\n\tflag = snd_amd_acp_find_config(pci);\n\tif (flag != FLAG_AMD_SOF && flag != FLAG_AMD_SOF_ONLY_DMIC)\n\t\treturn -ENODEV;\n\n\treturn sof_pci_probe(pci, pci_id);\n};\n\nstatic void acp_pci_rmb_remove(struct pci_dev *pci)\n{\n\tsof_pci_remove(pci);\n}\n\n \nstatic const struct pci_device_id rmb_pci_ids[] = {\n\t\t{ PCI_DEVICE(PCI_VENDOR_ID_AMD, ACP_PCI_DEV_ID),\n\t\t.driver_data = (unsigned long)&rembrandt_desc},\n\t\t{ 0, }\n};\nMODULE_DEVICE_TABLE(pci, rmb_pci_ids);\n\n \nstatic struct pci_driver snd_sof_pci_amd_rmb_driver = {\n\t.name = KBUILD_MODNAME,\n\t.id_table = rmb_pci_ids,\n\t.probe = acp_pci_rmb_probe,\n\t.remove = acp_pci_rmb_remove,\n};\nmodule_pci_driver(snd_sof_pci_amd_rmb_driver);\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\nMODULE_IMPORT_NS(SND_SOC_SOF_AMD_COMMON);\nMODULE_IMPORT_NS(SND_SOC_SOF_PCI_DEV);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}