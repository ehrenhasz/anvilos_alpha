{
  "module_name": "vx_hwdep.c",
  "hash_id": "fb1215865ccc3a84f01d8273491fc8b0f015c7aff2f52ad92bccb97631ef7163",
  "original_prompt": "Ingested from linux-6.6.14/sound/drivers/vx/vx_hwdep.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/firmware.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <sound/core.h>\n#include <sound/hwdep.h>\n#include <sound/vx_core.h>\n\nMODULE_FIRMWARE(\"vx/bx_1_vxp.b56\");\nMODULE_FIRMWARE(\"vx/bx_1_vp4.b56\");\nMODULE_FIRMWARE(\"vx/x1_1_vx2.xlx\");\nMODULE_FIRMWARE(\"vx/x1_2_v22.xlx\");\nMODULE_FIRMWARE(\"vx/x1_1_vxp.xlx\");\nMODULE_FIRMWARE(\"vx/x1_1_vp4.xlx\");\nMODULE_FIRMWARE(\"vx/bd56002.boot\");\nMODULE_FIRMWARE(\"vx/bd563v2.boot\");\nMODULE_FIRMWARE(\"vx/bd563s3.boot\");\nMODULE_FIRMWARE(\"vx/l_1_vx2.d56\");\nMODULE_FIRMWARE(\"vx/l_1_v22.d56\");\nMODULE_FIRMWARE(\"vx/l_1_vxp.d56\");\nMODULE_FIRMWARE(\"vx/l_1_vp4.d56\");\n\nint snd_vx_setup_firmware(struct vx_core *chip)\n{\n\tstatic const char * const fw_files[VX_TYPE_NUMS][4] = {\n\t\t[VX_TYPE_BOARD] = {\n\t\t\tNULL, \"x1_1_vx2.xlx\", \"bd56002.boot\", \"l_1_vx2.d56\",\n\t\t},\n\t\t[VX_TYPE_V2] = {\n\t\t\tNULL, \"x1_2_v22.xlx\", \"bd563v2.boot\", \"l_1_v22.d56\",\n\t\t},\n\t\t[VX_TYPE_MIC] = {\n\t\t\tNULL, \"x1_2_v22.xlx\", \"bd563v2.boot\", \"l_1_v22.d56\",\n\t\t},\n\t\t[VX_TYPE_VXPOCKET] = {\n\t\t\t\"bx_1_vxp.b56\", \"x1_1_vxp.xlx\", \"bd563s3.boot\", \"l_1_vxp.d56\"\n\t\t},\n\t\t[VX_TYPE_VXP440] = {\n\t\t\t\"bx_1_vp4.b56\", \"x1_1_vp4.xlx\", \"bd563s3.boot\", \"l_1_vp4.d56\"\n\t\t},\n\t};\n\n\tint i, err;\n\n\tfor (i = 0; i < 4; i++) {\n\t\tchar path[32];\n\t\tconst struct firmware *fw;\n\t\tif (! fw_files[chip->type][i])\n\t\t\tcontinue;\n\t\tsprintf(path, \"vx/%s\", fw_files[chip->type][i]);\n\t\tif (request_firmware(&fw, path, chip->dev)) {\n\t\t\tsnd_printk(KERN_ERR \"vx: can't load firmware %s\\n\", path);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\terr = chip->ops->load_dsp(chip, i, fw);\n\t\tif (err < 0) {\n\t\t\trelease_firmware(fw);\n\t\t\treturn err;\n\t\t}\n\t\tif (i == 1)\n\t\t\tchip->chip_status |= VX_STAT_XILINX_LOADED;\n#ifdef CONFIG_PM\n\t\tchip->firmware[i] = fw;\n#else\n\t\trelease_firmware(fw);\n#endif\n\t}\n\n\t \n\t \n\terr = snd_vx_pcm_new(chip);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = snd_vx_mixer_new(chip);\n\tif (err < 0)\n\t\treturn err;\n\n\tif (chip->ops->add_controls) {\n\t\terr = chip->ops->add_controls(chip);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t}\n\n\tchip->chip_status |= VX_STAT_DEVICE_INIT;\n\tchip->chip_status |= VX_STAT_CHIP_INIT;\n\n\treturn snd_card_register(chip->card);\n}\n\n \nvoid snd_vx_free_firmware(struct vx_core *chip)\n{\n#ifdef CONFIG_PM\n\tint i;\n\tfor (i = 0; i < 4; i++)\n\t\trelease_firmware(chip->firmware[i]);\n#endif\n}\n\nEXPORT_SYMBOL(snd_vx_setup_firmware);\nEXPORT_SYMBOL(snd_vx_free_firmware);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}