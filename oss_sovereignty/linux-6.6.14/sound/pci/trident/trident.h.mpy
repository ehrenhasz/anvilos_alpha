{
  "module_name": "trident.h",
  "hash_id": "a60a8d8b76e39e8e9a56cd81936786bd3d0e8c4d08d1cefeb707af52b9454996",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/trident/trident.h",
  "human_readable_source": " \n#ifndef __SOUND_TRIDENT_H\n#define __SOUND_TRIDENT_H\n\n \n\n#include <sound/pcm.h>\n#include <sound/mpu401.h>\n#include <sound/ac97_codec.h>\n#include <sound/util_mem.h>\n\n#define TRIDENT_DEVICE_ID_DX\t\t((PCI_VENDOR_ID_TRIDENT<<16)|PCI_DEVICE_ID_TRIDENT_4DWAVE_DX)\n#define TRIDENT_DEVICE_ID_NX\t\t((PCI_VENDOR_ID_TRIDENT<<16)|PCI_DEVICE_ID_TRIDENT_4DWAVE_NX)\n#define TRIDENT_DEVICE_ID_SI7018\t((PCI_VENDOR_ID_SI<<16)|PCI_DEVICE_ID_SI_7018)\n\n#define SNDRV_TRIDENT_VOICE_TYPE_PCM\t\t0\n#define SNDRV_TRIDENT_VOICE_TYPE_SYNTH\t\t1\n#define SNDRV_TRIDENT_VOICE_TYPE_MIDI\t\t2\n\n#define SNDRV_TRIDENT_VFLG_RUNNING\t\t(1<<0)\n\n \n#define SNDRV_TRIDENT_PAGE_SIZE\t\t\t4096\n#define SNDRV_TRIDENT_PAGE_SHIFT\t\t\t12\n#define SNDRV_TRIDENT_PAGE_MASK\t\t\t((1<<SNDRV_TRIDENT_PAGE_SHIFT)-1)\n#define SNDRV_TRIDENT_MAX_PAGES\t\t\t4096\n\n \n\n#define TRID_REG(trident, x) ((trident)->port + (x))\n\n#define ID_4DWAVE_DX        0x2000\n#define ID_4DWAVE_NX        0x2001\n\n \n\n#define T4D_BANK_A\t0\n#define T4D_BANK_B\t1\n#define T4D_NUM_BANKS\t2\n\n \n\n \n\nenum global_control_bits {\n\tCHANNEL_IDX\t= 0x0000003f,\n\tOVERRUN_IE\t= 0x00000400,\t \n\tUNDERRUN_IE\t= 0x00000800,\t \n\tENDLP_IE\t= 0x00001000,\t \n\tMIDLP_IE\t= 0x00002000,\t \n\tETOG_IE\t\t= 0x00004000,\t \n\tEDROP_IE\t= 0x00008000,\t \n\tBANK_B_EN\t= 0x00010000,\t \n\tPCMIN_B_MIX\t= 0x00020000,\t \n\tI2S_OUT_ASSIGN\t= 0x00040000,\t \n\tSPDIF_OUT_ASSIGN= 0x00080000,\t \n\tMAIN_OUT_ASSIGN = 0x00100000,\t \n};\n\nenum miscint_bits {\n\tPB_UNDERRUN_IRQ = 0x00000001, REC_OVERRUN_IRQ = 0x00000002,\n\tSB_IRQ\t\t= 0x00000004, MPU401_IRQ      = 0x00000008,\n\tOPL3_IRQ        = 0x00000010, ADDRESS_IRQ     = 0x00000020,\n\tENVELOPE_IRQ    = 0x00000040, PB_UNDERRUN     = 0x00000100,\n\tREC_OVERRUN\t= 0x00000200, MIXER_UNDERFLOW = 0x00000400,\n\tMIXER_OVERFLOW  = 0x00000800, NX_SB_IRQ_DISABLE = 0x00001000,\n        ST_TARGET_REACHED = 0x00008000,\n\tPB_24K_MODE     = 0x00010000, ST_IRQ_EN       = 0x00800000,\n\tACGPIO_IRQ\t= 0x01000000\n};\n\n \n#define LEGACY_DMAR0                0x00  \n#define LEGACY_DMAR4                0x04  \n#define LEGACY_DMAR6\t\t    0x06  \n#define LEGACY_DMAR11               0x0b  \n#define LEGACY_DMAR15               0x0f  \n\n#define T4D_START_A\t\t     0x80\n#define T4D_STOP_A\t\t     0x84\n#define T4D_DLY_A\t\t     0x88\n#define T4D_SIGN_CSO_A\t\t     0x8c\n#define T4D_CSPF_A\t\t     0x90\n#define T4D_CSPF_B\t\t     0xbc\n#define T4D_CEBC_A\t\t     0x94\n#define T4D_AINT_A\t\t     0x98\n#define T4D_AINTEN_A\t\t     0x9c\n#define T4D_LFO_GC_CIR               0xa0\n#define T4D_MUSICVOL_WAVEVOL         0xa8\n#define T4D_SBDELTA_DELTA_R          0xac\n#define T4D_MISCINT                  0xb0\n#define T4D_START_B                  0xb4\n#define T4D_STOP_B                   0xb8\n#define T4D_SBBL_SBCL                0xc0\n#define T4D_SBCTRL_SBE2R_SBDD        0xc4\n#define T4D_STIMER\t\t     0xc8\n#define T4D_AINT_B                   0xd8\n#define T4D_AINTEN_B                 0xdc\n#define T4D_RCI                      0x70\n\n \n#define T4D_MPU401_BASE             0x20\n#define T4D_MPUR0                   0x20\n#define T4D_MPUR1                   0x21\n#define T4D_MPUR2                   0x22\n#define T4D_MPUR3                   0x23\n\n \n#define NX_SPCTRL_SPCSO             0x24\n#define NX_SPLBA                    0x28\n#define NX_SPESO                    0x2c\n#define NX_SPCSTATUS                0x64\n\n \n#define GAMEPORT_GCR                0x30\n#define GAMEPORT_MODE_ADC           0x80\n#define GAMEPORT_LEGACY             0x31\n#define GAMEPORT_AXES               0x34\n\n \n#define NX_TLBC                     0x6c\n\n \n\n#define CH_START\t\t    0xe0\n\n#define CH_DX_CSO_ALPHA_FMS         0xe0\n#define CH_DX_ESO_DELTA             0xe8\n#define CH_DX_FMC_RVOL_CVOL         0xec\n\n#define CH_NX_DELTA_CSO             0xe0\n#define CH_NX_DELTA_ESO             0xe8\n#define CH_NX_ALPHA_FMS_FMC_RVOL_CVOL 0xec\n\n#define CH_LBA                      0xe4\n#define CH_GVSEL_PAN_VOL_CTRL_EC    0xf0\n#define CH_EBUF1                    0xf4\n#define CH_EBUF2                    0xf8\n\n \n\n#define DX_ACR0_AC97_W              0x40\n#define DX_ACR1_AC97_R              0x44\n#define DX_ACR2_AC97_COM_STAT       0x48\n\n#define NX_ACR0_AC97_COM_STAT       0x40\n#define NX_ACR1_AC97_W              0x44\n#define NX_ACR2_AC97_R_PRIMARY      0x48\n#define NX_ACR3_AC97_R_SECONDARY    0x4c\n\n#define SI_AC97_WRITE\t\t    0x40\n#define SI_AC97_READ\t\t    0x44\n#define SI_SERIAL_INTF_CTRL\t    0x48\n#define SI_AC97_GPIO\t\t    0x4c\n#define SI_ASR0\t\t\t    0x50\n#define SI_SPDIF_CS\t\t    0x70\n#define SI_GPIO\t\t\t    0x7c\n\nenum trident_nx_ac97_bits {\n\t \n\tNX_AC97_BUSY_WRITE \t= 0x0800,\n\tNX_AC97_BUSY_READ\t= 0x0800,\n\tNX_AC97_BUSY_DATA \t= 0x0400,\n\tNX_AC97_WRITE_SECONDARY = 0x0100,\n\t \n\tNX_AC97_SECONDARY_READY = 0x0040,\n\tNX_AC97_SECONDARY_RECORD = 0x0020,\n\tNX_AC97_SURROUND_OUTPUT = 0x0010,\n\tNX_AC97_PRIMARY_READY\t= 0x0008,\n\tNX_AC97_PRIMARY_RECORD\t= 0x0004,\n\tNX_AC97_PCM_OUTPUT\t= 0x0002,\n\tNX_AC97_WARM_RESET\t= 0x0001\n};\n\nenum trident_dx_ac97_bits {\n\tDX_AC97_BUSY_WRITE\t= 0x8000,\n\tDX_AC97_BUSY_READ\t= 0x8000,\n\tDX_AC97_READY\t\t= 0x0010,\n\tDX_AC97_RECORD\t\t= 0x0008,\n\tDX_AC97_PLAYBACK\t= 0x0002\n};\n\nenum sis7018_ac97_bits {\n\tSI_AC97_BUSY_WRITE =\t0x00008000,\n\tSI_AC97_AUDIO_BUSY =\t0x00004000,\n\tSI_AC97_MODEM_BUSY =\t0x00002000,\n\tSI_AC97_BUSY_READ =\t0x00008000,\n\tSI_AC97_SECONDARY =\t0x00000080,\n};\n\nenum serial_intf_ctrl_bits {\n\tWARM_RESET\t= 0x00000001,\n\tCOLD_RESET\t= 0x00000002,\n\tI2S_CLOCK\t= 0x00000004,\n\tPCM_SEC_AC97\t= 0x00000008,\n\tAC97_DBL_RATE\t= 0x00000010,\n\tSPDIF_EN\t= 0x00000020,\n\tI2S_OUTPUT_EN\t= 0x00000040,\n\tI2S_INPUT_EN\t= 0x00000080,\n\tPCMIN\t\t= 0x00000100,\n\tLINE1IN\t\t= 0x00000200,\n\tMICIN\t\t= 0x00000400,\n\tLINE2IN\t\t= 0x00000800,\n\tHEAD_SET_IN\t= 0x00001000,\n\tGPIOIN\t\t= 0x00002000,\n\t \n\tSECONDARY_ID\t= 0x00004000,\n\tPCMOUT\t\t= 0x00010000,\n\tSURROUT\t\t= 0x00020000,\n\tCENTEROUT\t= 0x00040000,\n\tLFEOUT\t\t= 0x00080000,\n\tLINE1OUT\t= 0x00100000,\n\tLINE2OUT\t= 0x00200000,\n\tGPIOOUT\t\t= 0x00400000,\n\tSI_AC97_PRIMARY_READY = 0x01000000,\n\tSI_AC97_SECONDARY_READY = 0x02000000,\n\tSI_AC97_POWERDOWN = 0x04000000,\n};\n                                                                                                                                   \n \n\n#define T4D_DEFAULT_PCM_VOL\t10\t \n#define T4D_DEFAULT_PCM_PAN\t0\t \n#define T4D_DEFAULT_PCM_RVOL\t127\t \n#define T4D_DEFAULT_PCM_CVOL\t127\t \n\nstruct snd_trident;\nstruct snd_trident_voice;\nstruct snd_trident_pcm_mixer;\n\nstruct snd_trident_port {\n\tstruct snd_midi_channel_set * chset;\n\tstruct snd_trident * trident;\n\tint mode;\t\t \n\tint client;\t\t \n\tint port;\t\t \n\tunsigned int midi_has_voices: 1;\n};\n\nstruct snd_trident_memblk_arg {\n\tshort first_page, last_page;\n};\n\nstruct snd_trident_tlb {\n\t__le32 *entries;\t\t \n\tdma_addr_t entries_dmaaddr;\t \n\tstruct snd_dma_buffer *buffer;\n\tstruct snd_util_memhdr * memhdr;\t \n\tstruct snd_dma_buffer *silent_page;\n};\n\nstruct snd_trident_voice {\n\tunsigned int number;\n\tunsigned int use: 1,\n\t    pcm: 1,\n\t    synth:1,\n\t    midi: 1;\n\tunsigned int flags;\n\tunsigned char client;\n\tunsigned char port;\n\tunsigned char index;\n\n\tstruct snd_trident_sample_ops *sample_ops;\n\n\t \n\tunsigned int CSO;\t\t \n\tunsigned int ESO;\t\t \n\tunsigned int LBA;\t\t \n\tunsigned short EC;\t\t \n\tunsigned short Alpha;\t\t \n\tunsigned short Delta;\t\t \n\tunsigned short Attribute;\t \n\tunsigned short Vol;\t\t \n\tunsigned char Pan;\t\t \n\tunsigned char GVSel;\t\t \n\tunsigned char RVol;\t\t \n\tunsigned char CVol;\t\t \n\tunsigned char FMC;\t\t \n\tunsigned char CTRL;\t\t \n\tunsigned char FMS;\t\t \n\tunsigned char LFO;\t\t \n\n\tunsigned int negCSO;\t \n\n\tstruct snd_util_memblk *memblk;\t \n\n\t \n\n\tstruct snd_trident *trident;\n\tstruct snd_pcm_substream *substream;\n\tstruct snd_trident_voice *extra;\t \n\tunsigned int running: 1,\n            capture: 1,\n            spdif: 1,\n            foldback: 1,\n            isync: 1,\n            isync2: 1,\n            isync3: 1;\n\tint foldback_chan;\t\t \n\tunsigned int stimer;\t\t \n\tunsigned int spurious_threshold;  \n\tunsigned int isync_mark;\n\tunsigned int isync_max;\n\tunsigned int isync_ESO;\n\n\t \n\n\tvoid *private_data;\n\tvoid (*private_free)(struct snd_trident_voice *voice);\n};\n\nstruct snd_4dwave {\n\tint seq_client;\n\n\tstruct snd_trident_port seq_ports[4];\n\tstruct snd_trident_voice voices[64];\t\n\n\tint ChanSynthCount;\t\t \n\tint max_size;\t\t\t \n\tint current_size;\t\t \n};\n\nstruct snd_trident_pcm_mixer {\n\tstruct snd_trident_voice *voice;\t \n\tunsigned short vol;\t\t \n\tunsigned char pan;\t\t \n\tunsigned char rvol;\t\t \n\tunsigned char cvol;\t\t \n\tunsigned char pad;\n};\n\nstruct snd_trident {\n\tint irq;\n\n\tunsigned int device;\t \n\n        unsigned char  bDMAStart;\n\n\tunsigned long port;\n\tunsigned long midi_port;\n\n\tunsigned int spurious_irq_count;\n\tunsigned int spurious_irq_max_delta;\n\n        struct snd_trident_tlb tlb;\t \n\n\tunsigned char spdif_ctrl;\n\tunsigned char spdif_pcm_ctrl;\n\tunsigned int spdif_bits;\n\tunsigned int spdif_pcm_bits;\n\tstruct snd_kcontrol *spdif_pcm_ctl;\t \n\tunsigned int ac97_ctrl;\n        \n        unsigned int ChanMap[2];\t \n        \n        int ChanPCM;\t\t\t \n\tint ChanPCMcnt;\t\t\t \n\n\tunsigned int ac97_detect: 1;\t \n\tunsigned int in_suspend: 1;\t \n\n\tstruct snd_4dwave synth;\t \n\n\tspinlock_t event_lock;\n\tspinlock_t voice_alloc;\n\n\tstruct snd_dma_device dma_dev;\n\n\tstruct pci_dev *pci;\n\tstruct snd_card *card;\n\tstruct snd_pcm *pcm;\t\t \n\tstruct snd_pcm *foldback;\t \n\tstruct snd_pcm *spdif;\t \n\tstruct snd_rawmidi *rmidi;\n\n\tstruct snd_ac97_bus *ac97_bus;\n\tstruct snd_ac97 *ac97;\n\tstruct snd_ac97 *ac97_sec;\n\n\tunsigned int musicvol_wavevol;\n\tstruct snd_trident_pcm_mixer pcm_mixer[32];\n\tstruct snd_kcontrol *ctl_vol;\t \n\tstruct snd_kcontrol *ctl_pan;\t \n\tstruct snd_kcontrol *ctl_rvol;\t \n\tstruct snd_kcontrol *ctl_cvol;\t \n\n\tspinlock_t reg_lock;\n\n\tstruct gameport *gameport;\n};\n\nint snd_trident_create(struct snd_card *card,\n\t\t       struct pci_dev *pci,\n\t\t       int pcm_streams,\n\t\t       int pcm_spdif_device,\n\t\t       int max_wavetable_size);\nint snd_trident_create_gameport(struct snd_trident *trident);\n\nint snd_trident_pcm(struct snd_trident *trident, int device);\nint snd_trident_foldback_pcm(struct snd_trident *trident, int device);\nint snd_trident_spdif_pcm(struct snd_trident *trident, int device);\nint snd_trident_attach_synthesizer(struct snd_trident * trident);\nstruct snd_trident_voice *snd_trident_alloc_voice(struct snd_trident * trident, int type,\n\t\t\t\t\t     int client, int port);\nvoid snd_trident_free_voice(struct snd_trident * trident, struct snd_trident_voice *voice);\nvoid snd_trident_start_voice(struct snd_trident * trident, unsigned int voice);\nvoid snd_trident_stop_voice(struct snd_trident * trident, unsigned int voice);\nvoid snd_trident_write_voice_regs(struct snd_trident * trident, struct snd_trident_voice *voice);\nextern const struct dev_pm_ops snd_trident_pm;\n\n \nstruct snd_util_memblk *snd_trident_alloc_pages(struct snd_trident *trident,\n\t\t\t\t\t\tstruct snd_pcm_substream *substream);\nint snd_trident_free_pages(struct snd_trident *trident, struct snd_util_memblk *blk);\nstruct snd_util_memblk *snd_trident_synth_alloc(struct snd_trident *trident, unsigned int size);\nint snd_trident_synth_free(struct snd_trident *trident, struct snd_util_memblk *blk);\nint snd_trident_synth_copy_from_user(struct snd_trident *trident, struct snd_util_memblk *blk,\n\t\t\t\t     int offset, const char __user *data, int size);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}