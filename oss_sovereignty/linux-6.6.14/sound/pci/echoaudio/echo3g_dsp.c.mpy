{
  "module_name": "echo3g_dsp.c",
  "hash_id": "6dc9263de0ab02925ff5cfa937cf87eb3627522ad3e484302d9bd1ec28ebac11",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/echoaudio/echo3g_dsp.c",
  "human_readable_source": " \n\nstatic int load_asic(struct echoaudio *chip);\nstatic int dsp_set_digital_mode(struct echoaudio *chip, u8 mode);\nstatic int set_digital_mode(struct echoaudio *chip, u8 mode);\nstatic int check_asic_status(struct echoaudio *chip);\nstatic int set_sample_rate(struct echoaudio *chip, u32 rate);\nstatic int set_input_clock(struct echoaudio *chip, u16 clock);\nstatic int set_professional_spdif(struct echoaudio *chip, char prof);\nstatic int set_phantom_power(struct echoaudio *chip, char on);\nstatic int write_control_reg(struct echoaudio *chip, u32 ctl, u32 frq,\n\t\t\t     char force);\n\n#include <linux/interrupt.h>\n\nstatic int init_hw(struct echoaudio *chip, u16 device_id, u16 subdevice_id)\n{\n\tint err;\n\n\tlocal_irq_enable();\n\tif (snd_BUG_ON((subdevice_id & 0xfff0) != ECHO3G))\n\t\treturn -ENODEV;\n\n\terr = init_dsp_comm_page(chip);\n\tif (err) {\n\t\tdev_err(chip->card->dev,\n\t\t\t\"init_hw - could not initialize DSP comm page\\n\");\n\t\treturn err;\n\t}\n\n\tchip->comm_page->e3g_frq_register =\n\t\tcpu_to_le32((E3G_MAGIC_NUMBER / 48000) - 2);\n\tchip->device_id = device_id;\n\tchip->subdevice_id = subdevice_id;\n\tchip->bad_board = true;\n\tchip->has_midi = true;\n\tchip->dsp_code_to_load = FW_ECHO3G_DSP;\n\n\t \n\terr = load_firmware(chip);\n\n\tif (err < 0) {\n\t\treturn err;\n\t} else if (err == E3G_GINA3G_BOX_TYPE) {\n\t\tchip->input_clock_types =\tECHO_CLOCK_BIT_INTERNAL |\n\t\t\t\t\t\tECHO_CLOCK_BIT_SPDIF |\n\t\t\t\t\t\tECHO_CLOCK_BIT_ADAT;\n\t\tchip->card_name = \"Gina3G\";\n\t\tchip->px_digital_out = chip->bx_digital_out = 6;\n\t\tchip->px_analog_in = chip->bx_analog_in = 14;\n\t\tchip->px_digital_in = chip->bx_digital_in = 16;\n\t\tchip->px_num = chip->bx_num = 24;\n\t\tchip->has_phantom_power = true;\n\t\tchip->hasnt_input_nominal_level = true;\n\t} else if (err == E3G_LAYLA3G_BOX_TYPE) {\n\t\tchip->input_clock_types =\tECHO_CLOCK_BIT_INTERNAL |\n\t\t\t\t\t\tECHO_CLOCK_BIT_SPDIF |\n\t\t\t\t\t\tECHO_CLOCK_BIT_ADAT |\n\t\t\t\t\t\tECHO_CLOCK_BIT_WORD;\n\t\tchip->card_name = \"Layla3G\";\n\t\tchip->px_digital_out = chip->bx_digital_out = 8;\n\t\tchip->px_analog_in = chip->bx_analog_in = 16;\n\t\tchip->px_digital_in = chip->bx_digital_in = 24;\n\t\tchip->px_num = chip->bx_num = 32;\n\t} else {\n\t\treturn -ENODEV;\n\t}\n\n\tchip->digital_modes =\tECHOCAPS_HAS_DIGITAL_MODE_SPDIF_RCA |\n\t\t\t\tECHOCAPS_HAS_DIGITAL_MODE_SPDIF_OPTICAL |\n\t\t\t\tECHOCAPS_HAS_DIGITAL_MODE_ADAT;\n\n\treturn err;\n}\n\n\n\nstatic int set_mixer_defaults(struct echoaudio *chip)\n{\n\tchip->digital_mode = DIGITAL_MODE_SPDIF_RCA;\n\tchip->professional_spdif = false;\n\tchip->non_audio_spdif = false;\n\tchip->bad_board = false;\n\tchip->phantom_power = false;\n\treturn init_line_levels(chip);\n}\n\n\n\nstatic int set_phantom_power(struct echoaudio *chip, char on)\n{\n\tu32 control_reg = le32_to_cpu(chip->comm_page->control_register);\n\n\tif (on)\n\t\tcontrol_reg |= E3G_PHANTOM_POWER;\n\telse\n\t\tcontrol_reg &= ~E3G_PHANTOM_POWER;\n\n\tchip->phantom_power = on;\n\treturn write_control_reg(chip, control_reg,\n\t\t\t\t le32_to_cpu(chip->comm_page->e3g_frq_register),\n\t\t\t\t 0);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}