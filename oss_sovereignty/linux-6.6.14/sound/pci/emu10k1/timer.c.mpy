{
  "module_name": "timer.c",
  "hash_id": "ccbf5eaa4874145668c0ad85196abd774b0bc520cfe4f896004204a08d5bb1ea",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/emu10k1/timer.c",
  "human_readable_source": "\n \n\n#include <linux/time.h>\n#include <sound/core.h>\n#include <sound/emu10k1.h>\n\nstatic int snd_emu10k1_timer_start(struct snd_timer *timer)\n{\n\tstruct snd_emu10k1 *emu;\n\tunsigned int delay;\n\n\temu = snd_timer_chip(timer);\n\tdelay = timer->sticks - 1;\n\tif (delay < 5 )  \n\t\tdelay = 5;\n\tsnd_emu10k1_intr_enable(emu, INTE_INTERVALTIMERENB);\n\toutw(delay & TIMER_RATE_MASK, emu->port + TIMER);\n\treturn 0;\n}\n\nstatic int snd_emu10k1_timer_stop(struct snd_timer *timer)\n{\n\tstruct snd_emu10k1 *emu;\n\n\temu = snd_timer_chip(timer);\n\tsnd_emu10k1_intr_disable(emu, INTE_INTERVALTIMERENB);\n\treturn 0;\n}\n\nstatic unsigned long snd_emu10k1_timer_c_resolution(struct snd_timer *timer)\n{\n\tstruct snd_emu10k1 *emu = snd_timer_chip(timer);\n\n\tif (emu->card_capabilities->emu_model &&\n\t    emu->emu1010.word_clock == 44100)\n\t\treturn 22676;  \n\telse\n\t\treturn 20833;  \n}\n\nstatic int snd_emu10k1_timer_precise_resolution(struct snd_timer *timer,\n\t\t\t\t\t       unsigned long *num, unsigned long *den)\n{\n\tstruct snd_emu10k1 *emu = snd_timer_chip(timer);\n\n\t*num = 1;\n\tif (emu->card_capabilities->emu_model)\n\t\t*den = emu->emu1010.word_clock;\n\telse\n\t\t*den = 48000;\n\treturn 0;\n}\n\nstatic const struct snd_timer_hardware snd_emu10k1_timer_hw = {\n\t.flags = SNDRV_TIMER_HW_AUTO,\n\t.ticks = 1024,\n\t.start = snd_emu10k1_timer_start,\n\t.stop = snd_emu10k1_timer_stop,\n\t.c_resolution = snd_emu10k1_timer_c_resolution,\n\t.precise_resolution = snd_emu10k1_timer_precise_resolution,\n};\n\nint snd_emu10k1_timer(struct snd_emu10k1 *emu, int device)\n{\n\tstruct snd_timer *timer = NULL;\n\tstruct snd_timer_id tid;\n\tint err;\n\n\ttid.dev_class = SNDRV_TIMER_CLASS_CARD;\n\ttid.dev_sclass = SNDRV_TIMER_SCLASS_NONE;\n\ttid.card = emu->card->number;\n\ttid.device = device;\n\ttid.subdevice = 0;\n\terr = snd_timer_new(emu->card, \"EMU10K1\", &tid, &timer);\n\tif (err >= 0) {\n\t\tstrcpy(timer->name, \"EMU10K1 timer\");\n\t\ttimer->private_data = emu;\n\t\ttimer->hw = snd_emu10k1_timer_hw;\n\t}\n\temu->timer = timer;\n\treturn err;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}