{
  "module_name": "hpimsginit.c",
  "hash_id": "95288cef5a372f0ad807b9af6b57a55f0e6ffb1eef4cd43651b0e338b9447ac9",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/asihpi/hpimsginit.c",
  "human_readable_source": "\n \n\n#include \"hpi_internal.h\"\n#include \"hpimsginit.h\"\n#include <linux/nospec.h>\n\n \nstatic u16 msg_size[HPI_OBJ_MAXINDEX + 1] = HPI_MESSAGE_SIZE_BY_OBJECT;\n \nstatic u16 res_size[HPI_OBJ_MAXINDEX + 1] = HPI_RESPONSE_SIZE_BY_OBJECT;\n \nstatic u16 gwSSX2_bypass;\n\n \nstatic void hpi_init_message(struct hpi_message *phm, u16 object,\n\tu16 function)\n{\n\tu16 size;\n\n\tif ((object > 0) && (object <= HPI_OBJ_MAXINDEX)) {\n\t\tobject = array_index_nospec(object, HPI_OBJ_MAXINDEX + 1);\n\t\tsize = msg_size[object];\n\t} else {\n\t\tsize = sizeof(*phm);\n\t}\n\n\tmemset(phm, 0, size);\n\tphm->size = size;\n\n\tif (gwSSX2_bypass)\n\t\tphm->type = HPI_TYPE_SSX2BYPASS_MESSAGE;\n\telse\n\t\tphm->type = HPI_TYPE_REQUEST;\n\tphm->object = object;\n\tphm->function = function;\n\tphm->version = 0;\n\tphm->adapter_index = HPI_ADAPTER_INDEX_INVALID;\n\t \n}\n\n \nvoid hpi_init_response(struct hpi_response *phr, u16 object, u16 function,\n\tu16 error)\n{\n\tu16 size;\n\n\tif ((object > 0) && (object <= HPI_OBJ_MAXINDEX)) {\n\t\tobject = array_index_nospec(object, HPI_OBJ_MAXINDEX + 1);\n\t\tsize = res_size[object];\n\t} else {\n\t\tsize = sizeof(*phr);\n\t}\n\n\tmemset(phr, 0, sizeof(*phr));\n\tphr->size = size;\n\tphr->type = HPI_TYPE_RESPONSE;\n\tphr->object = object;\n\tphr->function = function;\n\tphr->error = error;\n\tphr->specific_error = 0;\n\tphr->version = 0;\n}\n\nvoid hpi_init_message_response(struct hpi_message *phm,\n\tstruct hpi_response *phr, u16 object, u16 function)\n{\n\thpi_init_message(phm, object, function);\n\t \n\thpi_init_response(phr, object, function,\n\t\tHPI_ERROR_PROCESSING_MESSAGE);\n}\n\nstatic void hpi_init_messageV1(struct hpi_message_header *phm, u16 size,\n\tu16 object, u16 function)\n{\n\tmemset(phm, 0, size);\n\tif ((object > 0) && (object <= HPI_OBJ_MAXINDEX)) {\n\t\tphm->size = size;\n\t\tphm->type = HPI_TYPE_REQUEST;\n\t\tphm->object = object;\n\t\tphm->function = function;\n\t\tphm->version = 1;\n\t\t \n\t}\n}\n\nvoid hpi_init_responseV1(struct hpi_response_header *phr, u16 size,\n\tu16 object, u16 function)\n{\n\t(void)object;\n\t(void)function;\n\tmemset(phr, 0, size);\n\tphr->size = size;\n\tphr->version = 1;\n\tphr->type = HPI_TYPE_RESPONSE;\n\tphr->error = HPI_ERROR_PROCESSING_MESSAGE;\n}\n\nvoid hpi_init_message_responseV1(struct hpi_message_header *phm, u16 msg_size,\n\tstruct hpi_response_header *phr, u16 res_size, u16 object,\n\tu16 function)\n{\n\thpi_init_messageV1(phm, msg_size, object, function);\n\thpi_init_responseV1(phr, res_size, object, function);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}