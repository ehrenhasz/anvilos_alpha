{
  "module_name": "lola.h",
  "hash_id": "41dae20a29db32c956c453c4557b5ba0b72a6006618ec6c081c03021af87da66",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/lola/lola.h",
  "human_readable_source": " \n \n\n#ifndef _LOLA_H\n#define _LOLA_H\n\n#define DRVNAME\t\"snd-lola\"\n#define SFX\tDRVNAME \": \"\n\n \n#define LOLA_BAR0_GCAP\t\t0x00\n#define LOLA_BAR0_VMIN\t\t0x02\n#define LOLA_BAR0_VMAJ\t\t0x03\n#define LOLA_BAR0_OUTPAY\t0x04\n#define LOLA_BAR0_INPAY\t\t0x06\n#define LOLA_BAR0_GCTL\t\t0x08\n#define LOLA_BAR0_WAKEEN\t0x0c\n#define LOLA_BAR0_STATESTS\t0x0e\n#define LOLA_BAR0_GSTS\t\t0x10\n#define LOLA_BAR0_OUTSTRMPAY\t0x18\n#define LOLA_BAR0_INSTRMPAY\t0x1a\n#define LOLA_BAR0_INTCTL\t0x20\n#define LOLA_BAR0_INTSTS\t0x24\n#define LOLA_BAR0_WALCLK\t0x30\n#define LOLA_BAR0_SSYNC\t\t0x38\n\n#define LOLA_BAR0_CORBLBASE\t0x40\n#define LOLA_BAR0_CORBUBASE\t0x44\n#define LOLA_BAR0_CORBWP\t0x48\t \n#define LOLA_BAR0_CORBRP\t0x4a\t \n#define LOLA_BAR0_CORBCTL\t0x4c\t \n#define LOLA_BAR0_CORBSTS\t0x4d\t \n#define LOLA_BAR0_CORBSIZE\t0x4e\t \n\n#define LOLA_BAR0_RIRBLBASE\t0x50\n#define LOLA_BAR0_RIRBUBASE\t0x54\n#define LOLA_BAR0_RIRBWP\t0x58\n#define LOLA_BAR0_RINTCNT\t0x5a\t \n#define LOLA_BAR0_RIRBCTL\t0x5c\n#define LOLA_BAR0_RIRBSTS\t0x5d\t \n#define LOLA_BAR0_RIRBSIZE\t0x5e\t \n\n#define LOLA_BAR0_ICW\t\t0x60\n#define LOLA_BAR0_IRR\t\t0x64\n#define LOLA_BAR0_ICS\t\t0x68\n#define LOLA_BAR0_DPLBASE\t0x70\n#define LOLA_BAR0_DPUBASE\t0x74\n\n \n#define LOLA_BAR0_SD0_OFFSET\t0x80\n#define LOLA_REG0_SD_CTL\t0x00\n#define LOLA_REG0_SD_STS\t0x03\n#define LOLA_REG0_SD_LPIB\t0x04\n#define LOLA_REG0_SD_CBL\t0x08\n#define LOLA_REG0_SD_LVI\t0x0c\n#define LOLA_REG0_SD_FIFOW\t0x0e\n#define LOLA_REG0_SD_FIFOSIZE\t0x10\n#define LOLA_REG0_SD_FORMAT\t0x12\n#define LOLA_REG0_SD_BDLPL\t0x18\n#define LOLA_REG0_SD_BDLPU\t0x1c\n\n \n#define LOLA_BAR1_FPGAVER\t0x00\n#define LOLA_BAR1_DEVER\t\t0x04\n#define LOLA_BAR1_UCBMV\t\t0x08\n#define LOLA_BAR1_JTAG\t\t0x0c\n#define LOLA_BAR1_UARTRX\t0x10\n#define LOLA_BAR1_UARTTX\t0x14\n#define LOLA_BAR1_UARTCR\t0x18\n#define LOLA_BAR1_NVRAMVER\t0x1c\n#define LOLA_BAR1_CTRLSPI\t0x20\n#define LOLA_BAR1_DSPI\t\t0x24\n#define LOLA_BAR1_AISPI\t\t0x28\n#define LOLA_BAR1_GRAN\t\t0x2c\n\n#define LOLA_BAR1_DINTCTL\t0x80\n#define LOLA_BAR1_DIINTCTL\t0x84\n#define LOLA_BAR1_DOINTCTL\t0x88\n#define LOLA_BAR1_LRC\t\t0x90\n#define LOLA_BAR1_DINTSTS\t0x94\n#define LOLA_BAR1_DIINTSTS\t0x98\n#define LOLA_BAR1_DOINTSTS\t0x9c\n\n#define LOLA_BAR1_DSD0_OFFSET\t0xa0\n#define LOLA_BAR1_DSD_SIZE\t0x18\n\n#define LOLA_BAR1_DSDnSTS       0x00\n#define LOLA_BAR1_DSDnLPIB      0x04\n#define LOLA_BAR1_DSDnCTL       0x08\n#define LOLA_BAR1_DSDnLVI       0x0c\n#define LOLA_BAR1_DSDnBDPL      0x10\n#define LOLA_BAR1_DSDnBDPU      0x14\n\n#define LOLA_BAR1_SSYNC\t\t0x03e8\n\n#define LOLA_BAR1_BOARD_CTRL\t0x0f00\n#define LOLA_BAR1_BOARD_MODE\t0x0f02\n\n#define LOLA_BAR1_SOURCE_GAIN_ENABLE\t\t0x1000\n#define LOLA_BAR1_DEST00_MIX_GAIN_ENABLE\t0x1004\n#define LOLA_BAR1_DEST31_MIX_GAIN_ENABLE\t0x1080\n#define LOLA_BAR1_SOURCE00_01_GAIN\t\t0x1084\n#define LOLA_BAR1_SOURCE30_31_GAIN\t\t0x10c0\n#define LOLA_BAR1_SOURCE_GAIN(src) \\\n\t(LOLA_BAR1_SOURCE00_01_GAIN + (src) * 2)\n#define LOLA_BAR1_DEST00_MIX00_01_GAIN\t\t0x10c4\n#define LOLA_BAR1_DEST00_MIX30_31_GAIN\t\t0x1100\n#define LOLA_BAR1_DEST01_MIX00_01_GAIN\t\t0x1104\n#define LOLA_BAR1_DEST01_MIX30_31_GAIN\t\t0x1140\n#define LOLA_BAR1_DEST31_MIX00_01_GAIN\t\t0x1884\n#define LOLA_BAR1_DEST31_MIX30_31_GAIN\t\t0x18c0\n#define LOLA_BAR1_MIX_GAIN(dest, mix) \\\n\t(LOLA_BAR1_DEST00_MIX00_01_GAIN + (dest) * 0x40 + (mix) * 2)\n#define LOLA_BAR1_ANALOG_CLIP_IN\t\t0x18c4\n#define LOLA_BAR1_PEAKMETERS_SOURCE00_01\t0x18c8\n#define LOLA_BAR1_PEAKMETERS_SOURCE30_31\t0x1904\n#define LOLA_BAR1_PEAKMETERS_SOURCE(src) \\\n\t(LOLA_BAR1_PEAKMETERS_SOURCE00_01 + (src) * 2)\n#define LOLA_BAR1_PEAKMETERS_DEST00_01\t\t0x1908\n#define LOLA_BAR1_PEAKMETERS_DEST30_31\t\t0x1944\n#define LOLA_BAR1_PEAKMETERS_DEST(dest) \\\n\t(LOLA_BAR1_PEAKMETERS_DEST00_01 + (dest) * 2)\n#define LOLA_BAR1_PEAKMETERS_AGC00_01\t\t0x1948\n#define LOLA_BAR1_PEAKMETERS_AGC14_15\t\t0x1964\n#define LOLA_BAR1_PEAKMETERS_AGC(x) \\\n\t(LOLA_BAR1_PEAKMETERS_AGC00_01 + (x) * 2)\n\n \n#define LOLA_GCTL_RESET\t\t(1 << 0)\n \n#define LOLA_GCTL_UREN\t\t(1 << 8)\n\n \n#define LOLA_RBCTL_DMA_EN\t0x02\t \n#define LOLA_RBCTL_IRQ_EN\t0x01\t \n#define LOLA_RBRWP_CLR\t\t0x8000\t \n\n#define LOLA_RIRB_EX_UNSOL_EV\t0x40000000\n#define LOLA_RIRB_EX_ERROR\t0x80000000\n\n \n#define LOLA_CORB_INT_CMEI\t0x01\n#define LOLA_CORB_INT_MASK\tLOLA_CORB_INT_CMEI\n\n \n#define LOLA_RIRB_INT_RESPONSE\t0x01\n#define LOLA_RIRB_INT_OVERRUN\t0x04\n#define LOLA_RIRB_INT_MASK\t(LOLA_RIRB_INT_RESPONSE | LOLA_RIRB_INT_OVERRUN)\n\n \n#define LOLA_DINT_GLOBAL\t0x80000000  \n#define LOLA_DINT_CTRL\t\t0x40000000  \n#define LOLA_DINT_FIFOERR\t0x20000000  \n#define LOLA_DINT_MUERR\t\t0x10000000  \n\n \n#define LOLA_DSD_CTL_SRST\t0x01\t \n#define LOLA_DSD_CTL_SRUN\t0x02\t \n#define LOLA_DSD_CTL_IOCE\t0x04\t \n#define LOLA_DSD_CTL_DEIE\t0x10\t \n#define LOLA_DSD_CTL_VLRCV\t0x20\t \n#define LOLA_LRC_MASK\t\t0xffffff00\n\n \n#define LOLA_DSD_STS_BCIS\t0x04\t \n#define LOLA_DSD_STS_DESE\t0x10\t \n#define LOLA_DSD_STS_FIFORDY\t0x20\t \n\n#define LOLA_CORB_ENTRIES\t256\n\n#define MAX_STREAM_IN_COUNT\t16\n#define MAX_STREAM_OUT_COUNT\t16\n#define MAX_STREAM_COUNT\t16\n#define MAX_PINS\t\tMAX_STREAM_COUNT\n#define MAX_STREAM_BUFFER_COUNT\t16\n#define MAX_AUDIO_INOUT_COUNT\t16\n\n#define LOLA_CLOCK_TYPE_INTERNAL    0\n#define LOLA_CLOCK_TYPE_AES         1\n#define LOLA_CLOCK_TYPE_AES_SYNC    2\n#define LOLA_CLOCK_TYPE_WORDCLOCK   3\n#define LOLA_CLOCK_TYPE_ETHERSOUND  4\n#define LOLA_CLOCK_TYPE_VIDEO       5\n\n#define LOLA_CLOCK_FORMAT_NONE      0\n#define LOLA_CLOCK_FORMAT_NTSC      1\n#define LOLA_CLOCK_FORMAT_PAL       2\n\n#define MAX_SAMPLE_CLOCK_COUNT  48\n\n \n#define LOLA_PEAK_METER_CAN_AGC_MASK\t\t1\n#define LOLA_PEAK_METER_CAN_ANALOG_CLIP_MASK\t2\n\nstruct lola_bar {\n\tunsigned long addr;\n\tvoid __iomem *remap_addr;\n};\n\n \nstruct lola_rb {\n\t__le32 *buf;\t\t \n\tdma_addr_t addr;\t \n\tunsigned short rp, wp;\t \n\tint cmds;\t\t \n};\n\n \nstruct lola_pin {\n\tunsigned int nid;\n\tbool is_analog;\n\tunsigned int amp_mute;\n\tunsigned int amp_step_size;\n\tunsigned int amp_num_steps;\n\tunsigned int amp_offset;\n\tunsigned int max_level;\n\tunsigned int config_default_reg;\n\tunsigned int fixed_gain_list_len;\n\tunsigned int cur_gain_step;\n};\n\nstruct lola_pin_array {\n\tunsigned int num_pins;\n\tunsigned int num_analog_pins;\n\tstruct lola_pin pins[MAX_PINS];\n};\n\n \nstruct lola_sample_clock {\n\tunsigned int type;\n\tunsigned int format;\n\tunsigned int freq;\n};\n\nstruct lola_clock_widget {\n\tunsigned int nid;\n\tunsigned int items;\n\tunsigned int cur_index;\n\tunsigned int cur_freq;\n\tbool cur_valid;\n\tstruct lola_sample_clock sample_clock[MAX_SAMPLE_CLOCK_COUNT];\n\tunsigned int idx_lookup[MAX_SAMPLE_CLOCK_COUNT];\n};\n\n#define LOLA_MIXER_DIM      32\nstruct lola_mixer_array {\n\tu32 src_gain_enable;\n\tu32 dest_mix_gain_enable[LOLA_MIXER_DIM];\n\tu16 src_gain[LOLA_MIXER_DIM];\n\tu16 dest_mix_gain[LOLA_MIXER_DIM][LOLA_MIXER_DIM];\n};\n\n \nstruct lola_mixer_widget {\n\tunsigned int nid;\n\tunsigned int caps;\n\tstruct lola_mixer_array __iomem *array;\n\tstruct lola_mixer_array *array_saved;\n\tunsigned int src_stream_outs;\n\tunsigned int src_phys_ins;\n\tunsigned int dest_stream_ins;\n\tunsigned int dest_phys_outs;\n\tunsigned int src_stream_out_ofs;\n\tunsigned int dest_phys_out_ofs;\n\tunsigned int src_mask;\n\tunsigned int dest_mask;\n};\n\n \nstruct lola_stream {\n\tunsigned int nid;\t \n\tunsigned int index;\t \n\tunsigned int dsd;\t \n\tbool can_float;\n\tstruct snd_pcm_substream *substream;  \n\tstruct lola_stream *master;\t \n\n\t \n\tunsigned int bufsize;\n\tunsigned int period_bytes;\n\tunsigned int frags;\n\n\t \n\tunsigned int format_verb;\n\n\t \n\tunsigned int opened:1;\n\tunsigned int prepared:1;\n\tunsigned int paused:1;\n\tunsigned int running:1;\n};\n\n#define PLAY\tSNDRV_PCM_STREAM_PLAYBACK\n#define CAPT\tSNDRV_PCM_STREAM_CAPTURE\n\nstruct lola_pcm {\n\tunsigned int num_streams;\n\tstruct snd_dma_buffer *bdl;  \n\tstruct lola_stream streams[MAX_STREAM_COUNT];\n};\n\n \nstruct lola {\n\tstruct snd_card *card;\n\tstruct pci_dev *pci;\n\n\t \n\tstruct lola_bar bar[2];\n\tint irq;\n\n\t \n\tspinlock_t reg_lock;\n\tstruct mutex open_mutex;\n\n\t \n\tstruct lola_rb corb;\n\tstruct lola_rb rirb;\n\tunsigned int res, res_ex;\t \n\t \n\tunsigned int last_cmd_nid, last_verb, last_data, last_extdata;\n\n\t \n\tstruct snd_dma_buffer *rb;\n\n\t \n\tunsigned int last_unsol_res;\n\n\t \n\tstruct lola_pcm pcm[2];\n\n\t \n\tunsigned int input_src_caps_mask;\n\tunsigned int input_src_mask;\n\n\t \n\tstruct lola_pin_array pin[2];\n\n\t \n\tstruct lola_clock_widget clock;\n\tint ref_count_rate;\n\tunsigned int sample_rate;\n\n\t \n\tstruct lola_mixer_widget mixer;\n\n\t \n\tunsigned int version;\n\tunsigned int lola_caps;\n\n\t \n\tunsigned int granularity;\n\tunsigned int sample_rate_min;\n\tunsigned int sample_rate_max;\n\n\t \n\tunsigned int initialized:1;\n\tunsigned int cold_reset:1;\n\tunsigned int polling_mode:1;\n\n\t \n\tunsigned int debug_res;\n\tunsigned int debug_res_ex;\n};\n\n#define BAR0\t0\n#define BAR1\t1\n\n \n#define lola_readl(chip, idx, name) \\\n\treadl((chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n#define lola_readw(chip, idx, name) \\\n\treadw((chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n#define lola_readb(chip, idx, name) \\\n\treadb((chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n#define lola_writel(chip, idx, name, val) \\\n\twritel((val), (chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n#define lola_writew(chip, idx, name, val) \\\n\twritew((val), (chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n#define lola_writeb(chip, idx, name, val) \\\n\twriteb((val), (chip)->bar[idx].remap_addr + LOLA_##idx##_##name)\n\n#define lola_dsd_read(chip, dsd, name) \\\n\treadl((chip)->bar[BAR1].remap_addr + LOLA_BAR1_DSD0_OFFSET + \\\n\t      (LOLA_BAR1_DSD_SIZE * (dsd)) + LOLA_BAR1_DSDn##name)\n#define lola_dsd_write(chip, dsd, name, val) \\\n\twritel((val), (chip)->bar[BAR1].remap_addr + LOLA_BAR1_DSD0_OFFSET + \\\n\t       (LOLA_BAR1_DSD_SIZE * (dsd)) + LOLA_BAR1_DSDn##name)\n\n \n#define LOLA_VERB_GET_STREAM_FORMAT\t\t0xa00\n#define LOLA_VERB_GET_AMP_GAIN_MUTE\t\t0xb00\n#define LOLA_VERB_PARAMETERS\t\t\t0xf00\n#define LOLA_VERB_GET_POWER_STATE\t\t0xf05\n#define LOLA_VERB_GET_CONV\t\t\t0xf06\n#define LOLA_VERB_GET_UNSOLICITED_RESPONSE\t0xf08\n#define LOLA_VERB_GET_DIGI_CONVERT_1\t\t0xf0d\n#define LOLA_VERB_GET_CONFIG_DEFAULT\t\t0xf1c\n#define LOLA_VERB_GET_SUBSYSTEM_ID\t\t0xf20\n \n#define LOLA_VERB_GET_FIXED_GAIN\t\t0xfc0\n#define LOLA_VERB_GET_GAIN_SELECT\t\t0xfc1\n#define LOLA_VERB_GET_MAX_LEVEL\t\t\t0xfc2\n#define LOLA_VERB_GET_CLOCK_LIST\t\t0xfc3\n#define LOLA_VERB_GET_CLOCK_SELECT\t\t0xfc4\n#define LOLA_VERB_GET_CLOCK_STATUS\t\t0xfc5\n\n \n#define LOLA_VERB_SET_STREAM_FORMAT\t\t0x200\n#define LOLA_VERB_SET_AMP_GAIN_MUTE\t\t0x300\n#define LOLA_VERB_SET_POWER_STATE\t\t0x705\n#define LOLA_VERB_SET_CHANNEL_STREAMID\t\t0x706\n#define LOLA_VERB_SET_UNSOLICITED_ENABLE\t0x708\n#define LOLA_VERB_SET_DIGI_CONVERT_1\t\t0x70d\n \n#define LOLA_VERB_SET_GAIN_SELECT\t\t0xf81\n#define LOLA_VERB_SET_CLOCK_SELECT\t\t0xf84\n#define LOLA_VERB_SET_GRANULARITY_STEPS\t\t0xf86\n#define LOLA_VERB_SET_SOURCE_GAIN\t\t0xf87\n#define LOLA_VERB_SET_MIX_GAIN\t\t\t0xf88\n#define LOLA_VERB_SET_DESTINATION_GAIN\t\t0xf89\n#define LOLA_VERB_SET_SRC\t\t\t0xf8a\n\n \n#define LOLA_PAR_VENDOR_ID\t\t\t0x00\n#define LOLA_PAR_FUNCTION_TYPE\t\t\t0x05\n#define LOLA_PAR_AUDIO_WIDGET_CAP\t\t0x09\n#define LOLA_PAR_PCM\t\t\t\t0x0a\n#define LOLA_PAR_STREAM_FORMATS\t\t\t0x0b\n#define LOLA_PAR_PIN_CAP\t\t\t0x0c\n#define LOLA_PAR_AMP_IN_CAP\t\t\t0x0d\n#define LOLA_PAR_CONNLIST_LEN\t\t\t0x0e\n#define LOLA_PAR_POWER_STATE\t\t\t0x0f\n#define LOLA_PAR_GPIO_CAP\t\t\t0x11\n#define LOLA_PAR_AMP_OUT_CAP\t\t\t0x12\n#define LOLA_PAR_SPECIFIC_CAPS\t\t\t0x80\n#define LOLA_PAR_FIXED_GAIN_LIST\t\t0x81\n\n \n#define LOLA_AFG_MIXER_WIDGET_PRESENT(res)\t((res & (1 << 21)) != 0)\n#define LOLA_AFG_CLOCK_WIDGET_PRESENT(res)\t((res & (1 << 20)) != 0)\n#define LOLA_AFG_INPUT_PIN_COUNT(res)\t\t((res >> 10) & 0x2ff)\n#define LOLA_AFG_OUTPUT_PIN_COUNT(res)\t\t((res) & 0x2ff)\n\n \n#define LOLA_AMP_MUTE_CAPABLE(res)\t\t((res & (1 << 31)) != 0)\n#define LOLA_AMP_STEP_SIZE(res)\t\t\t((res >> 24) & 0x7f)\n#define LOLA_AMP_NUM_STEPS(res)\t\t\t((res >> 12) & 0x3ff)\n#define LOLA_AMP_OFFSET(res)\t\t\t((res) & 0x3ff)\n\n#define LOLA_GRANULARITY_MIN\t\t8\n#define LOLA_GRANULARITY_MAX\t\t32\n#define LOLA_GRANULARITY_STEP\t\t8\n\n \n#define LOLA_UNSOLICITED_TAG_MASK\t0x3f\n#define LOLA_UNSOLICITED_TAG\t\t0x1a\n#define LOLA_UNSOLICITED_ENABLE\t\t0x80\n#define LOLA_UNSOL_RESP_TAG_OFFSET\t26\n\n \n#define LOLA_MIXER_SRC_INPUT_PLAY_SEPARATION(res)   ((res >> 2) & 0x1f)\n#define LOLA_MIXER_DEST_REC_OUTPUT_SEPARATION(res)  ((res >> 7) & 0x1f)\n\nint lola_codec_write(struct lola *chip, unsigned int nid, unsigned int verb,\n\t\t     unsigned int data, unsigned int extdata);\nint lola_codec_read(struct lola *chip, unsigned int nid, unsigned int verb,\n\t\t    unsigned int data, unsigned int extdata,\n\t\t    unsigned int *val, unsigned int *extval);\nint lola_codec_flush(struct lola *chip);\n#define lola_read_param(chip, nid, param, val) \\\n\tlola_codec_read(chip, nid, LOLA_VERB_PARAMETERS, param, 0, val, NULL)\n\n \nint lola_create_pcm(struct lola *chip);\nint lola_init_pcm(struct lola *chip, int dir, int *nidp);\nvoid lola_pcm_update(struct lola *chip, struct lola_pcm *pcm, unsigned int bits);\n\n \nint lola_init_clock_widget(struct lola *chip, int nid);\nint lola_set_granularity(struct lola *chip, unsigned int val, bool force);\nint lola_enable_clock_events(struct lola *chip);\nint lola_set_clock_index(struct lola *chip, unsigned int idx);\nint lola_set_clock(struct lola *chip, int idx);\nint lola_set_sample_rate(struct lola *chip, int rate);\nbool lola_update_ext_clock_freq(struct lola *chip, unsigned int val);\nunsigned int lola_sample_rate_convert(unsigned int coded);\n\n \nint lola_init_pins(struct lola *chip, int dir, int *nidp);\nint lola_init_mixer_widget(struct lola *chip, int nid);\nvoid lola_free_mixer(struct lola *chip);\nint lola_create_mixer(struct lola *chip);\nint lola_setup_all_analog_gains(struct lola *chip, int dir, bool mute);\nvoid lola_save_mixer(struct lola *chip);\nvoid lola_restore_mixer(struct lola *chip);\nint lola_set_src_config(struct lola *chip, unsigned int src_mask, bool update);\n\n \n#ifdef CONFIG_SND_DEBUG\nvoid lola_proc_debug_new(struct lola *chip);\n#else\n#define lola_proc_debug_new(chip)\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}