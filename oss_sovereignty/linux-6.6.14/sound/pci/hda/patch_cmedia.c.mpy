{
  "module_name": "patch_cmedia.c",
  "hash_id": "a42786b5d93e8af2176413d9bcc07d0fa449a31514a2c0951fb8da3cb8ff9a99",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/hda/patch_cmedia.c",
  "human_readable_source": "\n \n\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <sound/core.h>\n#include <sound/hda_codec.h>\n#include \"hda_local.h\"\n#include \"hda_auto_parser.h\"\n#include \"hda_jack.h\"\n#include \"hda_generic.h\"\n\nstruct cmi_spec {\n\tstruct hda_gen_spec gen;\n};\n\n \nstatic const struct hda_codec_ops cmi_auto_patch_ops = {\n\t.build_controls = snd_hda_gen_build_controls,\n\t.build_pcms = snd_hda_gen_build_pcms,\n\t.init = snd_hda_gen_init,\n\t.free = snd_hda_gen_free,\n\t.unsol_event = snd_hda_jack_unsol_event,\n};\n\nstatic int patch_cmi9880(struct hda_codec *codec)\n{\n\tstruct cmi_spec *spec;\n\tstruct auto_pin_cfg *cfg;\n\tint err;\n\n\tspec = kzalloc(sizeof(*spec), GFP_KERNEL);\n\tif (spec == NULL)\n\t\treturn -ENOMEM;\n\n\tcodec->spec = spec;\n\tcodec->patch_ops = cmi_auto_patch_ops;\n\tcfg = &spec->gen.autocfg;\n\tsnd_hda_gen_spec_init(&spec->gen);\n\n\terr = snd_hda_parse_pin_defcfg(codec, cfg, NULL, 0);\n\tif (err < 0)\n\t\tgoto error;\n\terr = snd_hda_gen_parse_auto_config(codec, cfg);\n\tif (err < 0)\n\t\tgoto error;\n\n\treturn 0;\n\n error:\n\tsnd_hda_gen_free(codec);\n\treturn err;\n}\n\nstatic int patch_cmi8888(struct hda_codec *codec)\n{\n\tstruct cmi_spec *spec;\n\tstruct auto_pin_cfg *cfg;\n\tint err;\n\n\tspec = kzalloc(sizeof(*spec), GFP_KERNEL);\n\tif (!spec)\n\t\treturn -ENOMEM;\n\n\tcodec->spec = spec;\n\tcodec->patch_ops = cmi_auto_patch_ops;\n\tcfg = &spec->gen.autocfg;\n\tsnd_hda_gen_spec_init(&spec->gen);\n\n\t \n\tspec->gen.out_vol_mask = (1ULL << 0x10);\n\n\terr = snd_hda_parse_pin_defcfg(codec, cfg, NULL, 0);\n\tif (err < 0)\n\t\tgoto error;\n\terr = snd_hda_gen_parse_auto_config(codec, cfg);\n\tif (err < 0)\n\t\tgoto error;\n\n\tif (get_defcfg_device(snd_hda_codec_get_pincfg(codec, 0x10)) ==\n\t    AC_JACK_HP_OUT) {\n\t\tstatic const struct snd_kcontrol_new amp_kctl =\n\t\t\tHDA_CODEC_VOLUME(\"Headphone Amp Playback Volume\",\n\t\t\t\t\t 0x10, 0, HDA_OUTPUT);\n\t\tif (!snd_hda_gen_add_kctl(&spec->gen, NULL, &amp_kctl)) {\n\t\t\terr = -ENOMEM;\n\t\t\tgoto error;\n\t\t}\n\t}\n\n\treturn 0;\n\n error:\n\tsnd_hda_gen_free(codec);\n\treturn err;\n}\n\n \nstatic const struct hda_device_id snd_hda_id_cmedia[] = {\n\tHDA_CODEC_ENTRY(0x13f68888, \"CMI8888\", patch_cmi8888),\n\tHDA_CODEC_ENTRY(0x13f69880, \"CMI9880\", patch_cmi9880),\n\tHDA_CODEC_ENTRY(0x434d4980, \"CMI9880\", patch_cmi9880),\n\t{}  \n};\nMODULE_DEVICE_TABLE(hdaudio, snd_hda_id_cmedia);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"C-Media HD-audio codec\");\n\nstatic struct hda_codec_driver cmedia_driver = {\n\t.id = snd_hda_id_cmedia,\n};\n\nmodule_hda_codec_driver(cmedia_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}