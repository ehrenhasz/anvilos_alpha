{
  "module_name": "hda_controller.h",
  "hash_id": "b27abd69967a354b2e8707a3f6e3f1fedf78fe16797ee6fd153d57042a9689fa",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/hda/hda_controller.h",
  "human_readable_source": " \n \n\n#ifndef __SOUND_HDA_CONTROLLER_H\n#define __SOUND_HDA_CONTROLLER_H\n\n#include <linux/timecounter.h>\n#include <linux/interrupt.h>\n#include <sound/core.h>\n#include <sound/pcm.h>\n#include <sound/initval.h>\n#include <sound/hda_codec.h>\n#include <sound/hda_register.h>\n\n#define AZX_MAX_CODECS\t\tHDA_MAX_CODECS\n#define AZX_DEFAULT_CODECS\t4\n\n \n \n#define AZX_DCAPS_NO_TCSEL\t(1 << 8)\t \n#define AZX_DCAPS_NO_MSI\t(1 << 9)\t \n#define AZX_DCAPS_SNOOP_MASK\t(3 << 10)\t \n#define AZX_DCAPS_SNOOP_OFF\t(1 << 12)\t \n#ifdef CONFIG_SND_HDA_I915\n#define AZX_DCAPS_I915_COMPONENT (1 << 13)\t \n#else\n#define AZX_DCAPS_I915_COMPONENT 0\t\t \n#endif\n \n#define AZX_DCAPS_CTX_WORKAROUND (1 << 15)\t \n#define AZX_DCAPS_POSFIX_LPIB\t(1 << 16)\t \n#define AZX_DCAPS_AMD_WORKAROUND (1 << 17)\t \n#define AZX_DCAPS_NO_64BIT\t(1 << 18)\t \n \n#define AZX_DCAPS_OLD_SSYNC\t(1 << 20)\t \n#define AZX_DCAPS_NO_ALIGN_BUFSIZE (1 << 21)\t \n \n#define AZX_DCAPS_4K_BDLE_BOUNDARY (1 << 23)\t \n \n#define AZX_DCAPS_COUNT_LPIB_DELAY  (1 << 25)\t \n#define AZX_DCAPS_PM_RUNTIME\t(1 << 26)\t \n#define AZX_DCAPS_RETRY_PROBE\t(1 << 27)\t \n#define AZX_DCAPS_CORBRP_SELF_CLEAR (1 << 28)\t \n#define AZX_DCAPS_NO_MSI64      (1 << 29)\t \n#define AZX_DCAPS_SEPARATE_STREAM_TAG\t(1 << 30)  \n\nenum {\n\tAZX_SNOOP_TYPE_NONE,\n\tAZX_SNOOP_TYPE_SCH,\n\tAZX_SNOOP_TYPE_ATI,\n\tAZX_SNOOP_TYPE_NVIDIA,\n};\n\nstruct azx_dev {\n\tstruct hdac_stream core;\n\n\tunsigned int irq_pending:1;\n\t \n\tunsigned int insufficient:1;\n};\n\n#define azx_stream(dev)\t\t(&(dev)->core)\n#define stream_to_azx_dev(s)\tcontainer_of(s, struct azx_dev, core)\n\nstruct azx;\n\n \nstruct hda_controller_ops {\n\t \n\tint (*disable_msi_reset_irq)(struct azx *);\n\t \n\tint (*position_check)(struct azx *chip, struct azx_dev *azx_dev);\n\t \n\tint (*link_power)(struct azx *chip, bool enable);\n};\n\nstruct azx_pcm {\n\tstruct azx *chip;\n\tstruct snd_pcm *pcm;\n\tstruct hda_codec *codec;\n\tstruct hda_pcm *info;\n\tstruct list_head list;\n};\n\ntypedef unsigned int (*azx_get_pos_callback_t)(struct azx *, struct azx_dev *);\ntypedef int (*azx_get_delay_callback_t)(struct azx *, struct azx_dev *, unsigned int pos);\n\nstruct azx {\n\tstruct hda_bus bus;\n\n\tstruct snd_card *card;\n\tstruct pci_dev *pci;\n\tint dev_index;\n\n\t \n\tint driver_type;\n\tunsigned int driver_caps;\n\tint playback_streams;\n\tint playback_index_offset;\n\tint capture_streams;\n\tint capture_index_offset;\n\tint num_streams;\n\tint jackpoll_interval;  \n\n\t \n\tconst struct hda_controller_ops *ops;\n\n\t \n\tazx_get_pos_callback_t get_position[2];\n\tazx_get_delay_callback_t get_delay[2];\n\n\t \n\tstruct mutex open_mutex;  \n\n\t \n\tstruct list_head pcm_list;  \n\n\t \n\tint  codec_probe_mask;  \n\tunsigned int beep_mode;\n\tbool ctl_dev_id;\n\n#ifdef CONFIG_SND_HDA_PATCH_LOADER\n\tconst struct firmware *fw;\n#endif\n\n\t \n\tint bdl_pos_adj;\n\tunsigned int running:1;\n\tunsigned int fallback_to_single_cmd:1;\n\tunsigned int single_cmd:1;\n\tunsigned int msi:1;\n\tunsigned int probing:1;  \n\tunsigned int snoop:1;\n\tunsigned int uc_buffer:1;  \n\tunsigned int align_buffer_size:1;\n\tunsigned int disabled:1;  \n\tunsigned int pm_prepared:1;\n\n\t \n\tunsigned int gts_present:1;\n\n#ifdef CONFIG_SND_HDA_DSP_LOADER\n\tstruct azx_dev saved_azx_dev;\n#endif\n};\n\n#define azx_bus(chip)\t(&(chip)->bus.core)\n#define bus_to_azx(_bus)\tcontainer_of(_bus, struct azx, bus.core)\n\nstatic inline bool azx_snoop(struct azx *chip)\n{\n\treturn !IS_ENABLED(CONFIG_X86) || chip->snoop;\n}\n\n \n\n#define azx_writel(chip, reg, value) \\\n\tsnd_hdac_chip_writel(azx_bus(chip), reg, value)\n#define azx_readl(chip, reg) \\\n\tsnd_hdac_chip_readl(azx_bus(chip), reg)\n#define azx_writew(chip, reg, value) \\\n\tsnd_hdac_chip_writew(azx_bus(chip), reg, value)\n#define azx_readw(chip, reg) \\\n\tsnd_hdac_chip_readw(azx_bus(chip), reg)\n#define azx_writeb(chip, reg, value) \\\n\tsnd_hdac_chip_writeb(azx_bus(chip), reg, value)\n#define azx_readb(chip, reg) \\\n\tsnd_hdac_chip_readb(azx_bus(chip), reg)\n\n#define azx_has_pm_runtime(chip) \\\n\t((chip)->driver_caps & AZX_DCAPS_PM_RUNTIME)\n\n \nstatic inline struct azx_dev *get_azx_dev(struct snd_pcm_substream *substream)\n{\n\treturn substream->runtime->private_data;\n}\nunsigned int azx_get_position(struct azx *chip, struct azx_dev *azx_dev);\nunsigned int azx_get_pos_lpib(struct azx *chip, struct azx_dev *azx_dev);\nunsigned int azx_get_pos_posbuf(struct azx *chip, struct azx_dev *azx_dev);\n\n \nvoid azx_stop_all_streams(struct azx *chip);\n\n \n#define azx_alloc_stream_pages(chip) \\\n\tsnd_hdac_bus_alloc_stream_pages(azx_bus(chip))\n#define azx_free_stream_pages(chip) \\\n\tsnd_hdac_bus_free_stream_pages(azx_bus(chip))\n\n \nvoid azx_init_chip(struct azx *chip, bool full_reset);\nvoid azx_stop_chip(struct azx *chip);\n#define azx_enter_link_reset(chip) \\\n\tsnd_hdac_bus_enter_link_reset(azx_bus(chip))\nirqreturn_t azx_interrupt(int irq, void *dev_id);\n\n \nint azx_bus_init(struct azx *chip, const char *model);\nint azx_probe_codecs(struct azx *chip, unsigned int max_slots);\nint azx_codec_configure(struct azx *chip);\nint azx_init_streams(struct azx *chip);\nvoid azx_free_streams(struct azx *chip);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}