{
  "module_name": "ice1712.h",
  "hash_id": "a580c6dac65f50ef97289e44e731528c93ebc510562b7c192ee36717b6383fa7",
  "original_prompt": "Ingested from linux-6.6.14/sound/pci/ice1712/ice1712.h",
  "human_readable_source": " \n#ifndef __SOUND_ICE1712_H\n#define __SOUND_ICE1712_H\n\n \n\n#include <linux/io.h>\n#include <sound/control.h>\n#include <sound/ac97_codec.h>\n#include <sound/rawmidi.h>\n#include <sound/i2c.h>\n#include <sound/ak4xxx-adda.h>\n#include <sound/ak4114.h>\n#include <sound/pt2258.h>\n#include <sound/pcm.h>\n#include <sound/mpu401.h>\n\n\n \n\n#define ICEREG(ice, x) ((ice)->port + ICE1712_REG_##x)\n\n#define ICE1712_REG_CONTROL\t\t0x00\t \n#define   ICE1712_RESET\t\t\t0x80\t \n#define   ICE1712_SERR_ASSERT_DS_DMA\t0x40     \n#define   ICE1712_DOS_VOL\t\t0x10     \n#define   ICE1712_SERR_LEVEL\t\t0x08\t \n#define   ICE1712_SERR_ASSERT_SB\t0x02\t \n#define   ICE1712_NATIVE\t\t0x01\t \n#define ICE1712_REG_IRQMASK\t\t0x01\t \n#define   ICE1712_IRQ_MPU1\t\t0x80\t \n#define   ICE1712_IRQ_TIMER\t\t0x40\t \n#define   ICE1712_IRQ_MPU2\t\t0x20\t \n#define   ICE1712_IRQ_PROPCM\t\t0x10\t \n#define   ICE1712_IRQ_FM\t\t0x08\t \n#define   ICE1712_IRQ_PBKDS\t\t0x04\t \n#define   ICE1712_IRQ_CONCAP\t\t0x02\t \n#define   ICE1712_IRQ_CONPBK\t\t0x01\t \n#define ICE1712_REG_IRQSTAT\t\t0x02\t \n \n#define ICE1712_REG_INDEX\t\t0x03\t \n#define ICE1712_REG_DATA\t\t0x04\t \n#define ICE1712_REG_NMI_STAT1\t\t0x05\t \n#define ICE1712_REG_NMI_DATA\t\t0x06\t \n#define ICE1712_REG_NMI_INDEX\t\t0x07\t \n#define ICE1712_REG_AC97_INDEX\t\t0x08\t \n#define ICE1712_REG_AC97_CMD\t\t0x09\t \n#define   ICE1712_AC97_COLD\t\t0x80\t \n#define   ICE1712_AC97_WARM\t\t0x40\t \n#define   ICE1712_AC97_WRITE\t\t0x20\t \n#define   ICE1712_AC97_READ\t\t0x10\t \n#define   ICE1712_AC97_READY\t\t0x08\t \n#define   ICE1712_AC97_PBK_VSR\t\t0x02\t \n#define   ICE1712_AC97_CAP_VSR\t\t0x01\t \n#define ICE1712_REG_AC97_DATA\t\t0x0a\t \n#define ICE1712_REG_MPU1_CTRL\t\t0x0c\t \n#define ICE1712_REG_MPU1_DATA\t\t0x0d\t \n#define ICE1712_REG_I2C_DEV_ADDR\t0x10\t \n#define   ICE1712_I2C_WRITE\t\t0x01\t \n#define ICE1712_REG_I2C_BYTE_ADDR\t0x11\t \n#define ICE1712_REG_I2C_DATA\t\t0x12\t \n#define ICE1712_REG_I2C_CTRL\t\t0x13\t \n#define   ICE1712_I2C_EEPROM\t\t0x80\t \n#define   ICE1712_I2C_BUSY\t\t0x01\t \n#define ICE1712_REG_CONCAP_ADDR\t\t0x14\t \n#define ICE1712_REG_CONCAP_COUNT\t0x18\t \n#define ICE1712_REG_SERR_SHADOW\t\t0x1b\t \n#define ICE1712_REG_MPU2_CTRL\t\t0x1c\t \n#define ICE1712_REG_MPU2_DATA\t\t0x1d\t \n#define ICE1712_REG_TIMER\t\t0x1e\t \n\n \n\n#define ICE1712_IREG_PBK_COUNT_LO\t0x00\n#define ICE1712_IREG_PBK_COUNT_HI\t0x01\n#define ICE1712_IREG_PBK_CTRL\t\t0x02\n#define ICE1712_IREG_PBK_LEFT\t\t0x03\t \n#define ICE1712_IREG_PBK_RIGHT\t\t0x04\t \n#define ICE1712_IREG_PBK_SOFT\t\t0x05\t \n#define ICE1712_IREG_PBK_RATE_LO\t0x06\n#define ICE1712_IREG_PBK_RATE_MID\t0x07\n#define ICE1712_IREG_PBK_RATE_HI\t0x08\n#define ICE1712_IREG_CAP_COUNT_LO\t0x10\n#define ICE1712_IREG_CAP_COUNT_HI\t0x11\n#define ICE1712_IREG_CAP_CTRL\t\t0x12\n#define ICE1712_IREG_GPIO_DATA\t\t0x20\n#define ICE1712_IREG_GPIO_WRITE_MASK\t0x21\n#define ICE1712_IREG_GPIO_DIRECTION\t0x22\n#define ICE1712_IREG_CONSUMER_POWERDOWN\t0x30\n#define ICE1712_IREG_PRO_POWERDOWN\t0x31\n\n \n\n#define ICEDS(ice, x) ((ice)->dmapath_port + ICE1712_DS_##x)\n\n#define ICE1712_DS_INTMASK\t\t0x00\t \n#define ICE1712_DS_INTSTAT\t\t0x02\t \n#define ICE1712_DS_DATA\t\t\t0x04\t \n#define ICE1712_DS_INDEX\t\t0x08\t \n\n \n\n#define ICE1712_DSC_ADDR0\t\t0x00\t \n#define ICE1712_DSC_COUNT0\t\t0x01\t \n#define ICE1712_DSC_ADDR1\t\t0x02\t \n#define ICE1712_DSC_COUNT1\t\t0x03\t \n#define ICE1712_DSC_CONTROL\t\t0x04\t \n#define   ICE1712_BUFFER1\t\t0x80\t \n#define   ICE1712_BUFFER1_AUTO\t\t0x40\t \n#define   ICE1712_BUFFER0_AUTO\t\t0x20\t \n#define   ICE1712_FLUSH\t\t\t0x10\t \n#define   ICE1712_STEREO\t\t0x08\t \n#define   ICE1712_16BIT\t\t\t0x04\t \n#define   ICE1712_PAUSE\t\t\t0x02\t \n#define   ICE1712_START\t\t\t0x01\t \n#define ICE1712_DSC_RATE\t\t0x05\t \n#define ICE1712_DSC_VOLUME\t\t0x06\t \n\n \n\n#define ICEMT(ice, x) ((ice)->profi_port + ICE1712_MT_##x)\n\n#define ICE1712_MT_IRQ\t\t\t0x00\t \n#define   ICE1712_MULTI_CAPTURE\t\t0x80\t \n#define   ICE1712_MULTI_PLAYBACK\t0x40\t \n#define   ICE1712_MULTI_CAPSTATUS\t0x02\t \n#define   ICE1712_MULTI_PBKSTATUS\t0x01\t \n#define ICE1712_MT_RATE\t\t\t0x01\t \n#define   ICE1712_SPDIF_MASTER\t\t0x10\t \n#define ICE1712_MT_I2S_FORMAT\t\t0x02\t \n#define ICE1712_MT_AC97_INDEX\t\t0x04\t \n#define ICE1712_MT_AC97_CMD\t\t0x05\t \n \n#define ICE1712_MT_AC97_DATA\t\t0x06\t \n#define ICE1712_MT_PLAYBACK_ADDR\t0x10\t \n#define ICE1712_MT_PLAYBACK_SIZE\t0x14\t \n#define ICE1712_MT_PLAYBACK_COUNT\t0x16\t \n#define ICE1712_MT_PLAYBACK_CONTROL\t0x18\t \n#define   ICE1712_CAPTURE_START_SHADOW\t0x04\t \n#define   ICE1712_PLAYBACK_PAUSE\t0x02\t \n#define   ICE1712_PLAYBACK_START\t0x01\t \n#define ICE1712_MT_CAPTURE_ADDR\t\t0x20\t \n#define ICE1712_MT_CAPTURE_SIZE\t\t0x24\t \n#define ICE1712_MT_CAPTURE_COUNT\t0x26\t \n#define ICE1712_MT_CAPTURE_CONTROL\t0x28\t \n#define   ICE1712_CAPTURE_START\t\t0x01\t \n#define ICE1712_MT_ROUTE_PSDOUT03\t0x30\t \n#define ICE1712_MT_ROUTE_SPDOUT\t\t0x32\t \n#define ICE1712_MT_ROUTE_CAPTURE\t0x34\t \n#define ICE1712_MT_MONITOR_VOLUME\t0x38\t \n#define ICE1712_MT_MONITOR_INDEX\t0x3a\t \n#define ICE1712_MT_MONITOR_RATE\t\t0x3b\t \n#define ICE1712_MT_MONITOR_ROUTECTRL\t0x3c\t \n#define   ICE1712_ROUTE_AC97\t\t0x01\t \n#define ICE1712_MT_MONITOR_PEAKINDEX\t0x3e\t \n#define ICE1712_MT_MONITOR_PEAKDATA\t0x3f\t \n\n \n\n \n#define ICE1712_CFG_CLOCK\t0xc0\n#define   ICE1712_CFG_CLOCK512\t0x00\t \n#define   ICE1712_CFG_CLOCK384  0x40\t \n#define   ICE1712_CFG_EXT\t0x80\t \n#define ICE1712_CFG_2xMPU401\t0x20\t \n#define ICE1712_CFG_NO_CON_AC97 0x10\t \n#define ICE1712_CFG_ADC_MASK\t0x0c\t \n#define ICE1712_CFG_DAC_MASK\t0x03\t \n \n#define ICE1712_CFG_PRO_I2S\t0x80\t \n#define ICE1712_CFG_AC97_PACKED\t0x01\t \n \n#define ICE1712_CFG_I2S_VOLUME\t0x80\t \n#define ICE1712_CFG_I2S_96KHZ\t0x40\t \n#define ICE1712_CFG_I2S_RESMASK\t0x30\t \n#define ICE1712_CFG_I2S_OTHER\t0x0f\t \n \n#define ICE1712_CFG_I2S_CHIPID\t0xfc\t \n#define ICE1712_CFG_SPDIF_IN\t0x02\t \n#define ICE1712_CFG_SPDIF_OUT\t0x01\t \n\n \n#define ICE1712_DMA_MODE_WRITE\t\t0x48\n#define ICE1712_DMA_AUTOINIT\t\t0x10\n\n\n \n#define ICE_I2C_EEPROM_ADDR\t\t0xA0\n\nstruct snd_ice1712;\n\nstruct snd_ice1712_eeprom {\n\tunsigned int subvendor;\t \n\tunsigned char size;\t \n\tunsigned char version;\t \n\tunsigned char data[32];\n\tunsigned int gpiomask;\n\tunsigned int gpiostate;\n\tunsigned int gpiodir;\n};\n\nenum {\n\tICE_EEP1_CODEC = 0,\t \n\tICE_EEP1_ACLINK,\t \n\tICE_EEP1_I2SID,\t\t \n\tICE_EEP1_SPDIF,\t\t \n\tICE_EEP1_GPIO_MASK,\t \n\tICE_EEP1_GPIO_STATE,\t \n\tICE_EEP1_GPIO_DIR,\t \n\tICE_EEP1_AC97_MAIN_LO,\t \n\tICE_EEP1_AC97_MAIN_HI,\t \n\tICE_EEP1_AC97_PCM_LO,\t \n\tICE_EEP1_AC97_PCM_HI,\t \n\tICE_EEP1_AC97_REC_LO,\t \n\tICE_EEP1_AC97_REC_HI,\t \n\tICE_EEP1_AC97_RECSRC,\t \n\tICE_EEP1_DAC_ID,\t \n\tICE_EEP1_DAC_ID1,\n\tICE_EEP1_DAC_ID2,\n\tICE_EEP1_DAC_ID3,\n\tICE_EEP1_ADC_ID,\t \n\tICE_EEP1_ADC_ID1,\n\tICE_EEP1_ADC_ID2,\n\tICE_EEP1_ADC_ID3\n};\n\n#define ice_has_con_ac97(ice)\t(!((ice)->eeprom.data[ICE_EEP1_CODEC] & ICE1712_CFG_NO_CON_AC97))\n\n\nstruct snd_ak4xxx_private {\n\tunsigned int cif:1;\t\t \n\tunsigned char caddr;\t\t \n\tunsigned int data_mask;\t\t \n\tunsigned int clk_mask;\t\t \n\tunsigned int cs_mask;\t\t \n\tunsigned int cs_addr;\t\t \n\tunsigned int cs_none;\t\t \n\tunsigned int add_flags;\t\t \n\tunsigned int mask_flags;\t \n\tstruct snd_akm4xxx_ops {\n\t\tvoid (*set_rate_val)(struct snd_akm4xxx *ak, unsigned int rate);\n\t} ops;\n};\n\nstruct snd_ice1712_spdif {\n\tunsigned char cs8403_bits;\n\tunsigned char cs8403_stream_bits;\n\tstruct snd_kcontrol *stream_ctl;\n\n\tstruct snd_ice1712_spdif_ops {\n\t\tvoid (*open)(struct snd_ice1712 *, struct snd_pcm_substream *);\n\t\tvoid (*setup_rate)(struct snd_ice1712 *, int rate);\n\t\tvoid (*close)(struct snd_ice1712 *, struct snd_pcm_substream *);\n\t\tvoid (*default_get)(struct snd_ice1712 *, struct snd_ctl_elem_value *ucontrol);\n\t\tint (*default_put)(struct snd_ice1712 *, struct snd_ctl_elem_value *ucontrol);\n\t\tvoid (*stream_get)(struct snd_ice1712 *, struct snd_ctl_elem_value *ucontrol);\n\t\tint (*stream_put)(struct snd_ice1712 *, struct snd_ctl_elem_value *ucontrol);\n\t} ops;\n};\n\nstruct snd_ice1712_card_info;\n\nstruct snd_ice1712 {\n\tunsigned long conp_dma_size;\n\tunsigned long conc_dma_size;\n\tunsigned long prop_dma_size;\n\tunsigned long proc_dma_size;\n\tint irq;\n\n\tunsigned long port;\n\tunsigned long ddma_port;\n\tunsigned long dmapath_port;\n\tunsigned long profi_port;\n\n\tstruct pci_dev *pci;\n\tstruct snd_card *card;\n\tstruct snd_pcm *pcm;\n\tstruct snd_pcm *pcm_ds;\n\tstruct snd_pcm *pcm_pro;\n\tstruct snd_pcm_substream *playback_con_substream;\n\tstruct snd_pcm_substream *playback_con_substream_ds[6];\n\tstruct snd_pcm_substream *capture_con_substream;\n\tstruct snd_pcm_substream *playback_pro_substream;\n\tstruct snd_pcm_substream *capture_pro_substream;\n\tunsigned int playback_pro_size;\n\tunsigned int capture_pro_size;\n\tunsigned int playback_con_virt_addr[6];\n\tunsigned int playback_con_active_buf[6];\n\tunsigned int capture_con_virt_addr;\n\tunsigned int ac97_ext_id;\n\tstruct snd_ac97 *ac97;\n\tstruct snd_rawmidi *rmidi[2];\n\n\tspinlock_t reg_lock;\n\tstruct snd_info_entry *proc_entry;\n\n\tstruct snd_ice1712_eeprom eeprom;\n\tconst struct snd_ice1712_card_info *card_info;\n\n\tunsigned int pro_volumes[20];\n\tunsigned int omni:1;\t\t \n\tunsigned int dxr_enable:1;\t \n\tunsigned int vt1724:1;\n\tunsigned int vt1720:1;\n\tunsigned int has_spdif:1;\t \n\tunsigned int force_pdma4:1;\t \n\tunsigned int force_rdma1:1;\t \n\tunsigned int midi_output:1;\t \n\tunsigned int midi_input:1;\t \n\tunsigned int own_routing:1;\t \n\tunsigned int num_total_dacs;\t \n\tunsigned int num_total_adcs;\t \n\tunsigned int cur_rate;\t\t \n\n\tstruct mutex open_mutex;\n\tstruct snd_pcm_substream *pcm_reserved[4];\n\tconst struct snd_pcm_hw_constraint_list *hw_rates;  \n\n\tunsigned int akm_codecs;\n\tstruct snd_akm4xxx *akm;\n\tstruct snd_ice1712_spdif spdif;\n\n\tstruct mutex i2c_mutex;\t \n\tstruct snd_i2c_bus *i2c;\t\t \n\tstruct snd_i2c_device *cs8427;\t \n\tunsigned int cs8427_timeout;\t \n\n\tstruct ice1712_gpio {\n\t\tunsigned int direction;\t\t \n\t\tunsigned int write_mask;\t \n\t\tunsigned int saved[2];\t\t \n\t\t \n\t\tvoid (*set_mask)(struct snd_ice1712 *ice, unsigned int data);\n\t\tunsigned int (*get_mask)(struct snd_ice1712 *ice);\n\t\tvoid (*set_dir)(struct snd_ice1712 *ice, unsigned int data);\n\t\tunsigned int (*get_dir)(struct snd_ice1712 *ice);\n\t\tvoid (*set_data)(struct snd_ice1712 *ice, unsigned int data);\n\t\tunsigned int (*get_data)(struct snd_ice1712 *ice);\n\t\t \n\t\tvoid (*set_pro_rate)(struct snd_ice1712 *ice, unsigned int rate);\n\t\tvoid (*i2s_mclk_changed)(struct snd_ice1712 *ice);\n\t} gpio;\n\tstruct mutex gpio_mutex;\n\n\t \n\tvoid *spec;\n\n\t \n\tint pro_rate_default;\n\tint (*is_spdif_master)(struct snd_ice1712 *ice);\n\tunsigned int (*get_rate)(struct snd_ice1712 *ice);\n\tvoid (*set_rate)(struct snd_ice1712 *ice, unsigned int rate);\n\tunsigned char (*set_mclk)(struct snd_ice1712 *ice, unsigned int rate);\n\tint (*set_spdif_clock)(struct snd_ice1712 *ice, int type);\n\tint (*get_spdif_master_type)(struct snd_ice1712 *ice);\n\tconst char * const *ext_clock_names;\n\tint ext_clock_count;\n\tvoid (*pro_open)(struct snd_ice1712 *, struct snd_pcm_substream *);\n#ifdef CONFIG_PM_SLEEP\n\tint (*pm_suspend)(struct snd_ice1712 *);\n\tint (*pm_resume)(struct snd_ice1712 *);\n\tunsigned int pm_suspend_enabled:1;\n\tunsigned int pm_saved_is_spdif_master:1;\n\tunsigned int pm_saved_spdif_ctrl;\n\tunsigned char pm_saved_spdif_cfg;\n\tunsigned int pm_saved_route;\n#endif\n};\n\n\n \nstatic inline void snd_ice1712_gpio_set_dir(struct snd_ice1712 *ice, unsigned int bits)\n{\n\tice->gpio.set_dir(ice, bits);\n}\n\nstatic inline unsigned int snd_ice1712_gpio_get_dir(struct snd_ice1712 *ice)\n{\n\treturn ice->gpio.get_dir(ice);\n}\n\nstatic inline void snd_ice1712_gpio_set_mask(struct snd_ice1712 *ice, unsigned int bits)\n{\n\tice->gpio.set_mask(ice, bits);\n}\n\nstatic inline void snd_ice1712_gpio_write(struct snd_ice1712 *ice, unsigned int val)\n{\n\tice->gpio.set_data(ice, val);\n}\n\nstatic inline unsigned int snd_ice1712_gpio_read(struct snd_ice1712 *ice)\n{\n\treturn ice->gpio.get_data(ice);\n}\n\n \nstatic inline void snd_ice1712_save_gpio_status(struct snd_ice1712 *ice)\n{\n\tmutex_lock(&ice->gpio_mutex);\n\tice->gpio.saved[0] = ice->gpio.direction;\n\tice->gpio.saved[1] = ice->gpio.write_mask;\n}\n\nstatic inline void snd_ice1712_restore_gpio_status(struct snd_ice1712 *ice)\n{\n\tice->gpio.set_dir(ice, ice->gpio.saved[0]);\n\tice->gpio.set_mask(ice, ice->gpio.saved[1]);\n\tice->gpio.direction = ice->gpio.saved[0];\n\tice->gpio.write_mask = ice->gpio.saved[1];\n\tmutex_unlock(&ice->gpio_mutex);\n}\n\n \n#define ICE1712_GPIO(xiface, xname, xindex, mask, invert, xaccess) \\\n{ .iface = xiface, .name = xname, .access = xaccess, .info = snd_ctl_boolean_mono_info, \\\n  .get = snd_ice1712_gpio_get, .put = snd_ice1712_gpio_put, \\\n  .private_value = mask | (invert << 24) }\n\nint snd_ice1712_gpio_get(struct snd_kcontrol *kcontrol, struct snd_ctl_elem_value *ucontrol);\nint snd_ice1712_gpio_put(struct snd_kcontrol *kcontrol, struct snd_ctl_elem_value *ucontrol);\n\n \nstatic inline void snd_ice1712_gpio_write_bits(struct snd_ice1712 *ice,\n\t\t\t\t\t       unsigned int mask, unsigned int bits)\n{\n\tunsigned val;\n\n\tice->gpio.direction |= mask;\n\tsnd_ice1712_gpio_set_dir(ice, ice->gpio.direction);\n\tval = snd_ice1712_gpio_read(ice);\n\tval &= ~mask;\n\tval |= mask & bits;\n\tsnd_ice1712_gpio_write(ice, val);\n}\n\nstatic inline int snd_ice1712_gpio_read_bits(struct snd_ice1712 *ice,\n\t\t\t\t\t      unsigned int mask)\n{\n\tice->gpio.direction &= ~mask;\n\tsnd_ice1712_gpio_set_dir(ice, ice->gpio.direction);\n\treturn  snd_ice1712_gpio_read(ice) & mask;\n}\n\n \nint snd_ice1724_get_route_val(struct snd_ice1712 *ice, int shift);\nint snd_ice1724_put_route_val(struct snd_ice1712 *ice, unsigned int val,\n\t\t\t\t\t\t\t\tint shift);\n\nint snd_ice1712_spdif_build_controls(struct snd_ice1712 *ice);\n\nint snd_ice1712_akm4xxx_init(struct snd_akm4xxx *ak,\n\t\t\t     const struct snd_akm4xxx *template,\n\t\t\t     const struct snd_ak4xxx_private *priv,\n\t\t\t     struct snd_ice1712 *ice);\nvoid snd_ice1712_akm4xxx_free(struct snd_ice1712 *ice);\nint snd_ice1712_akm4xxx_build_controls(struct snd_ice1712 *ice);\n\nint snd_ice1712_init_cs8427(struct snd_ice1712 *ice, int addr);\n\nstatic inline void snd_ice1712_write(struct snd_ice1712 *ice, u8 addr, u8 data)\n{\n\toutb(addr, ICEREG(ice, INDEX));\n\toutb(data, ICEREG(ice, DATA));\n}\n\nstatic inline u8 snd_ice1712_read(struct snd_ice1712 *ice, u8 addr)\n{\n\toutb(addr, ICEREG(ice, INDEX));\n\treturn inb(ICEREG(ice, DATA));\n}\n\n\n \n\nstruct snd_ice1712_card_info {\n\tunsigned int subvendor;\n\tconst char *name;\n\tconst char *model;\n\tconst char *driver;\n\tint (*chip_init)(struct snd_ice1712 *);\n\tvoid (*chip_exit)(struct snd_ice1712 *);\n\tint (*build_controls)(struct snd_ice1712 *);\n\tunsigned int no_mpu401:1;\n\tunsigned int mpu401_1_info_flags;\n\tunsigned int mpu401_2_info_flags;\n\tconst char *mpu401_1_name;\n\tconst char *mpu401_2_name;\n\tconst unsigned int eeprom_size;\n\tconst unsigned char *eeprom_data;\n};\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}