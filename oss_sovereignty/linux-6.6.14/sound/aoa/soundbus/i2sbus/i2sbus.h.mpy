{
  "module_name": "i2sbus.h",
  "hash_id": "21ccca2b4f2be929239273ce1c04b9466fd53e8822687f0208a839fcace9c095",
  "original_prompt": "Ingested from linux-6.6.14/sound/aoa/soundbus/i2sbus/i2sbus.h",
  "human_readable_source": " \n \n#ifndef __I2SBUS_H\n#define __I2SBUS_H\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/mutex.h>\n#include <linux/completion.h>\n\n#include <sound/pcm.h>\n\n#include <asm/prom.h>\n#include <asm/pmac_feature.h>\n#include <asm/dbdma.h>\n\n#include \"interface.h\"\n#include \"../soundbus.h\"\n\nstruct i2sbus_control {\n\tstruct list_head list;\n\tstruct macio_chip *macio;\n};\n\n#define MAX_DBDMA_COMMANDS\t32\n\nstruct dbdma_command_mem {\n\tdma_addr_t bus_addr;\n\tdma_addr_t bus_cmd_start;\n\tstruct dbdma_cmd *cmds;\n\tvoid *space;\n\tint size;\n\tu32 running:1;\n\tu32 stopping:1;\n};\n\nstruct pcm_info {\n\tu32 created:1,  \n\t    active:1;   \n\t \n\tstruct snd_pcm_substream *substream;\n\tint current_period;\n\tu32 frame_count;\n\tstruct dbdma_command_mem dbdma_ring;\n\tvolatile struct dbdma_regs __iomem *dbdma;\n\tstruct completion *stop_completion;\n};\n\nenum {\n\taoa_resource_i2smmio = 0,\n\taoa_resource_txdbdma,\n\taoa_resource_rxdbdma,\n};\n\nstruct i2sbus_dev {\n\tstruct soundbus_dev sound;\n\tstruct macio_dev *macio;\n\tstruct i2sbus_control *control;\n\tvolatile struct i2s_interface_regs __iomem *intfregs;\n\n\tstruct resource resources[3];\n\tstruct resource *allocated_resource[3];\n\tint interrupts[3];\n\tchar rnames[3][32];\n\n\t \n\tstruct pcm_info out, in;\n\tsnd_pcm_format_t format;\n\tunsigned int rate;\n\n\t \n\tstruct list_head item;\n\t \n\tint bus_number;\n\t \n\tstruct pmf_function *enable,\n\t\t\t    *cell_enable,\n\t\t\t    *cell_disable,\n\t\t\t    *clock_enable,\n\t\t\t    *clock_disable;\n\n\t \n\t \n\tspinlock_t low_lock;\n\t \n\tstruct mutex lock;\n};\n\n#define soundbus_dev_to_i2sbus_dev(sdev) \\\n\t\tcontainer_of(sdev, struct i2sbus_dev, sound)\n\n \nextern int\ni2sbus_attach_codec(struct soundbus_dev *dev, struct snd_card *card,\n\t\t    struct codec_info *ci, void *data);\nextern void\ni2sbus_detach_codec(struct soundbus_dev *dev, void *data);\nextern irqreturn_t\ni2sbus_tx_intr(int irq, void *devid);\nextern irqreturn_t\ni2sbus_rx_intr(int irq, void *devid);\n\nextern void i2sbus_wait_for_stop_both(struct i2sbus_dev *i2sdev);\nextern void i2sbus_pcm_prepare_both(struct i2sbus_dev *i2sdev);\n\n \nextern int i2sbus_control_init(struct macio_dev* dev,\n\t\t\t       struct i2sbus_control **c);\nextern void i2sbus_control_destroy(struct i2sbus_control *c);\nextern int i2sbus_control_add_dev(struct i2sbus_control *c,\n\t\t\t\t  struct i2sbus_dev *i2sdev);\nextern void i2sbus_control_remove_dev(struct i2sbus_control *c,\n\t\t\t\t      struct i2sbus_dev *i2sdev);\nextern int i2sbus_control_enable(struct i2sbus_control *c,\n\t\t\t\t struct i2sbus_dev *i2sdev);\nextern int i2sbus_control_cell(struct i2sbus_control *c,\n\t\t\t       struct i2sbus_dev *i2sdev,\n\t\t\t       int enable);\nextern int i2sbus_control_clock(struct i2sbus_control *c,\n\t\t\t\tstruct i2sbus_dev *i2sdev,\n\t\t\t\tint enable);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}