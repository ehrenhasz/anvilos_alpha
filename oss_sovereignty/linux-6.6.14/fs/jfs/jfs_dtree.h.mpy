{
  "module_name": "jfs_dtree.h",
  "hash_id": "eaf3296a9155591d7c0d7c7598a2b2cfa865eea1387900ef7cc446e04b0da3d7",
  "original_prompt": "Ingested from linux-6.6.14/fs/jfs/jfs_dtree.h",
  "human_readable_source": " \n \n#ifndef _H_JFS_DTREE\n#define\t_H_JFS_DTREE\n\n \n\n#include \"jfs_btree.h\"\n\ntypedef union {\n\tstruct {\n\t\ttid_t tid;\n\t\tstruct inode *ip;\n\t\tu32 ino;\n\t} leaf;\n\tpxd_t xd;\n} ddata_t;\n\n\n \n \nstruct dtslot {\n\ts8 next;\t\t \n\ts8 cnt;\t\t\t \n\t__le16 name[15];\t \n};\t\t\t\t \n\n\n#define DATASLOTSIZE\t16\n#define L2DATASLOTSIZE\t4\n#define\tDTSLOTSIZE\t32\n#define\tL2DTSLOTSIZE\t5\n#define DTSLOTHDRSIZE\t2\n#define DTSLOTDATASIZE\t30\n#define DTSLOTDATALEN\t15\n\n \nstruct idtentry {\n\tpxd_t xd;\t\t \n\n\ts8 next;\t\t \n\tu8 namlen;\t\t \n\t__le16 name[11];\t \n};\t\t\t\t \n\n#define DTIHDRSIZE\t10\n#define DTIHDRDATALEN\t11\n\n \n#define\tNDTINTERNAL(klen) (DIV_ROUND_UP((4 + (klen)), 15))\n\n\n \nstruct ldtentry {\n\t__le32 inumber;\t\t \n\ts8 next;\t\t \n\tu8 namlen;\t\t \n\t__le16 name[11];\t \n\t__le32 index;\t\t \n};\t\t\t\t \n\n#define DTLHDRSIZE\t6\n#define DTLHDRDATALEN_LEGACY\t13\t \n#define DTLHDRDATALEN\t11\n\n \n\n \n#define DO_INDEX(INODE) (JFS_SBI((INODE)->i_sb)->mntflag & JFS_DIR_INDEX)\n\n \n#define MAX_INLINE_DIRTABLE_ENTRY 13\n\nstruct dir_table_slot {\n\tu8 rsrvd;\t\t \n\tu8 flag;\t\t \n\tu8 slot;\t\t \n\tu8 addr1;\t\t \n\t__le32 addr2;\t\t \n};\t\t\t\t \n\n \n#define DIR_INDEX_VALID 1\n#define DIR_INDEX_FREE 0\n\n#define DTSaddress(dir_table_slot, address64)\\\n{\\\n\t(dir_table_slot)->addr1 = ((u64)address64) >> 32;\\\n\t(dir_table_slot)->addr2 = __cpu_to_le32((address64) & 0xffffffff);\\\n}\n\n#define addressDTS(dts)\\\n\t( ((s64)((dts)->addr1)) << 32 | __le32_to_cpu((dts)->addr2) )\n\n \n#define\tNDTLEAF_LEGACY(klen)\t(DIV_ROUND_UP((2 + (klen)), 15))\n#define\tNDTLEAF\tNDTINTERNAL\n\n\n \ntypedef union {\n\tstruct {\n\t\tstruct dasd DASD;  \n\n\t\tu8 flag;\t \n\t\tu8 nextindex;\t \n\t\ts8 freecnt;\t \n\t\ts8 freelist;\t \n\n\t\t__le32 idotdot;\t \n\n\t\ts8 stbl[8];\t \n\t} header;\t\t \n\n\tstruct dtslot slot[9];\n} dtroot_t;\n\n#define PARENT(IP) \\\n\t(le32_to_cpu(JFS_IP(IP)->i_dtroot.header.idotdot))\n\n#define DTROOTMAXSLOT\t9\n\n#define\tdtEmpty(IP) (JFS_IP(IP)->i_dtroot.header.nextindex == 0)\n\n\n \ntypedef union {\n\tstruct {\n\t\t__le64 next;\t \n\t\t__le64 prev;\t \n\n\t\tu8 flag;\t \n\t\tu8 nextindex;\t \n\t\ts8 freecnt;\t \n\t\ts8 freelist;\t \n\n\t\tu8 maxslot;\t \n\t\tu8 stblindex;\t \n\t\tu8 rsrvd[2];\t \n\n\t\tpxd_t self;\t \n\t} header;\t\t \n\n\tstruct dtslot slot[128];\n} dtpage_t;\n\n#define DTPAGEMAXSLOT        128\n\n#define DT8THPGNODEBYTES     512\n#define DT8THPGNODETSLOTS      1\n#define DT8THPGNODESLOTS      16\n\n#define DTQTRPGNODEBYTES    1024\n#define DTQTRPGNODETSLOTS      1\n#define DTQTRPGNODESLOTS      32\n\n#define DTHALFPGNODEBYTES   2048\n#define DTHALFPGNODETSLOTS     2\n#define DTHALFPGNODESLOTS     64\n\n#define DTFULLPGNODEBYTES   4096\n#define DTFULLPGNODETSLOTS     4\n#define DTFULLPGNODESLOTS    128\n\n#define DTENTRYSTART\t1\n\n \n#define DT_GETSTBL(p) ( ((p)->header.flag & BT_ROOT) ?\\\n\t((dtroot_t *)(p))->header.stbl : \\\n\t(s8 *)&(p)->slot[(p)->header.stblindex] )\n\n \n#define JFS_CREATE 1\n#define JFS_LOOKUP 2\n#define JFS_REMOVE 3\n#define JFS_RENAME 4\n\n \n#define DIREND\tINT_MAX\n\n \nextern void dtInitRoot(tid_t tid, struct inode *ip, u32 idotdot);\n\nextern int dtSearch(struct inode *ip, struct component_name * key,\n\t\t    ino_t * data, struct btstack * btstack, int flag);\n\nextern int dtInsert(tid_t tid, struct inode *ip, struct component_name * key,\n\t\t    ino_t * ino, struct btstack * btstack);\n\nextern int dtDelete(tid_t tid, struct inode *ip, struct component_name * key,\n\t\t    ino_t * data, int flag);\n\nextern int dtModify(tid_t tid, struct inode *ip, struct component_name * key,\n\t\t    ino_t * orig_ino, ino_t new_ino, int flag);\n\nextern int jfs_readdir(struct file *file, struct dir_context *ctx);\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}