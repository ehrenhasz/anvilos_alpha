{
  "module_name": "jfs_metapage.h",
  "hash_id": "97ca8aa31122822c4028e9630c3408f7b588b6315a81f607a2a74dd94b17fe66",
  "original_prompt": "Ingested from linux-6.6.14/fs/jfs/jfs_metapage.h",
  "human_readable_source": " \n \n#ifndef\t_H_JFS_METAPAGE\n#define _H_JFS_METAPAGE\n\n#include <linux/pagemap.h>\n\nstruct metapage {\n\t \n\tu16 xflag;\n\tu16 unused;\n\tlid_t lid;\n\tint lsn;\n\tstruct list_head synclist;\n\t \n\n\tunsigned long flag;\t \n\tunsigned long count;\t \n\tvoid *data;\t\t \n\tsector_t index;\t\t \n\twait_queue_head_t wait;\n\n\t \n\tstruct page *page;\n\tstruct super_block *sb;\n\tunsigned int logical_size;\n\n\t \n\tint clsn;\n\tint nohomeok;\n\tstruct jfs_log *log;\n};\n\n \n#define META_locked\t0\n#define META_dirty\t2\n#define META_sync\t3\n#define META_discard\t4\n#define META_forcewrite\t5\n#define META_io\t\t6\n\n#define mark_metapage_dirty(mp) set_bit(META_dirty, &(mp)->flag)\n\n \nextern int metapage_init(void);\nextern void metapage_exit(void);\nextern struct metapage *__get_metapage(struct inode *inode,\n\t\t\t\t  unsigned long lblock, unsigned int size,\n\t\t\t\t  int absolute, unsigned long new);\n\n#define read_metapage(inode, lblock, size, absolute)\\\n\t __get_metapage(inode, lblock, size, absolute, false)\n\n#define get_metapage(inode, lblock, size, absolute)\\\n\t __get_metapage(inode, lblock, size, absolute, true)\n\nextern void release_metapage(struct metapage *);\nextern void grab_metapage(struct metapage *);\nextern void force_metapage(struct metapage *);\n\n \nextern void hold_metapage(struct metapage *);\nextern void put_metapage(struct metapage *);\n\nstatic inline void write_metapage(struct metapage *mp)\n{\n\tset_bit(META_dirty, &mp->flag);\n\trelease_metapage(mp);\n}\n\nstatic inline void flush_metapage(struct metapage *mp)\n{\n\tset_bit(META_sync, &mp->flag);\n\twrite_metapage(mp);\n}\n\nstatic inline void discard_metapage(struct metapage *mp)\n{\n\tclear_bit(META_dirty, &mp->flag);\n\tset_bit(META_discard, &mp->flag);\n\trelease_metapage(mp);\n}\n\nstatic inline void metapage_nohomeok(struct metapage *mp)\n{\n\tstruct page *page = mp->page;\n\tlock_page(page);\n\tif (!mp->nohomeok++) {\n\t\tmark_metapage_dirty(mp);\n\t\tget_page(page);\n\t\twait_on_page_writeback(page);\n\t}\n\tunlock_page(page);\n}\n\n \nstatic inline void metapage_wait_for_io(struct metapage *mp)\n{\n\tif (test_bit(META_io, &mp->flag))\n\t\twait_on_page_writeback(mp->page);\n}\n\n \nstatic inline void _metapage_homeok(struct metapage *mp)\n{\n\tif (!--mp->nohomeok)\n\t\tput_page(mp->page);\n}\n\nstatic inline void metapage_homeok(struct metapage *mp)\n{\n\thold_metapage(mp);\n\t_metapage_homeok(mp);\n\tput_metapage(mp);\n}\n\nextern const struct address_space_operations jfs_metapage_aops;\n\n \nextern void __invalidate_metapages(struct inode *, s64, int);\n#define invalidate_pxd_metapages(ip, pxd) \\\n\t__invalidate_metapages((ip), addressPXD(&(pxd)), lengthPXD(&(pxd)))\n#define invalidate_dxd_metapages(ip, dxd) \\\n\t__invalidate_metapages((ip), addressDXD(&(dxd)), lengthDXD(&(dxd)))\n#define invalidate_xad_metapages(ip, xad) \\\n\t__invalidate_metapages((ip), addressXAD(&(xad)), lengthXAD(&(xad)))\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}