{
  "module_name": "vfs_dentry.c",
  "hash_id": "0b2f7706bee141b0b7aac86578c633e54be0f011c46f00d4ec6c0f786347cb36",
  "original_prompt": "Ingested from linux-6.6.14/fs/9p/vfs_dentry.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <net/9p/9p.h>\n#include <net/9p/client.h>\n\n#include \"v9fs.h\"\n#include \"v9fs_vfs.h\"\n#include \"fid.h\"\n\n \nstatic int v9fs_cached_dentry_delete(const struct dentry *dentry)\n{\n\tp9_debug(P9_DEBUG_VFS, \" dentry: %pd (%p)\\n\",\n\t\t dentry, dentry);\n\n\t \n\tif (d_really_is_negative(dentry))\n\t\treturn 1;\n\treturn 0;\n}\n\n \n\nstatic void v9fs_dentry_release(struct dentry *dentry)\n{\n\tstruct hlist_node *p, *n;\n\n\tp9_debug(P9_DEBUG_VFS, \" dentry: %pd (%p)\\n\",\n\t\t dentry, dentry);\n\thlist_for_each_safe(p, n, (struct hlist_head *)&dentry->d_fsdata)\n\t\tp9_fid_put(hlist_entry(p, struct p9_fid, dlist));\n\tdentry->d_fsdata = NULL;\n}\n\nstatic int v9fs_lookup_revalidate(struct dentry *dentry, unsigned int flags)\n{\n\tstruct p9_fid *fid;\n\tstruct inode *inode;\n\tstruct v9fs_inode *v9inode;\n\n\tif (flags & LOOKUP_RCU)\n\t\treturn -ECHILD;\n\n\tinode = d_inode(dentry);\n\tif (!inode)\n\t\tgoto out_valid;\n\n\tv9inode = V9FS_I(inode);\n\tif (v9inode->cache_validity & V9FS_INO_INVALID_ATTR) {\n\t\tint retval;\n\t\tstruct v9fs_session_info *v9ses;\n\n\t\tfid = v9fs_fid_lookup(dentry);\n\t\tif (IS_ERR(fid))\n\t\t\treturn PTR_ERR(fid);\n\n\t\tv9ses = v9fs_inode2v9ses(inode);\n\t\tif (v9fs_proto_dotl(v9ses))\n\t\t\tretval = v9fs_refresh_inode_dotl(fid, inode);\n\t\telse\n\t\t\tretval = v9fs_refresh_inode(fid, inode);\n\t\tp9_fid_put(fid);\n\n\t\tif (retval == -ENOENT)\n\t\t\treturn 0;\n\t\tif (retval < 0)\n\t\t\treturn retval;\n\t}\nout_valid:\n\treturn 1;\n}\n\nconst struct dentry_operations v9fs_cached_dentry_operations = {\n\t.d_revalidate = v9fs_lookup_revalidate,\n\t.d_weak_revalidate = v9fs_lookup_revalidate,\n\t.d_delete = v9fs_cached_dentry_delete,\n\t.d_release = v9fs_dentry_release,\n};\n\nconst struct dentry_operations v9fs_dentry_operations = {\n\t.d_delete = always_delete_dentry,\n\t.d_release = v9fs_dentry_release,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}