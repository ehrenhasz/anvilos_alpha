{
  "module_name": "cache.c",
  "hash_id": "d15fdced444bf8014aa01ec1469b03551cf74d4262f8ad7cbae4c78cade3672b",
  "original_prompt": "Ingested from linux-6.6.14/fs/9p/cache.c",
  "human_readable_source": "\n \n\n#include <linux/jiffies.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <net/9p/9p.h>\n\n#include \"v9fs.h\"\n#include \"cache.h\"\n\nint v9fs_cache_session_get_cookie(struct v9fs_session_info *v9ses,\n\t\t\t\t  const char *dev_name)\n{\n\tstruct fscache_volume *vcookie;\n\tchar *name, *p;\n\n\tname = kasprintf(GFP_KERNEL, \"9p,%s,%s\",\n\t\t\t dev_name, v9ses->cachetag ?: v9ses->aname);\n\tif (!name)\n\t\treturn -ENOMEM;\n\n\tfor (p = name; *p; p++)\n\t\tif (*p == '/')\n\t\t\t*p = ';';\n\n\tvcookie = fscache_acquire_volume(name, NULL, NULL, 0);\n\tp9_debug(P9_DEBUG_FSC, \"session %p get volume %p (%s)\\n\",\n\t\t v9ses, vcookie, name);\n\tif (IS_ERR(vcookie)) {\n\t\tif (vcookie != ERR_PTR(-EBUSY)) {\n\t\t\tkfree(name);\n\t\t\treturn PTR_ERR(vcookie);\n\t\t}\n\t\tpr_err(\"Cache volume key already in use (%s)\\n\", name);\n\t\tvcookie = NULL;\n\t}\n\tv9ses->fscache = vcookie;\n\tkfree(name);\n\treturn 0;\n}\n\nvoid v9fs_cache_inode_get_cookie(struct inode *inode)\n{\n\tstruct v9fs_inode *v9inode = V9FS_I(inode);\n\tstruct v9fs_session_info *v9ses;\n\t__le32 version;\n\t__le64 path;\n\n\tif (!S_ISREG(inode->i_mode))\n\t\treturn;\n\tif (WARN_ON(v9fs_inode_cookie(v9inode)))\n\t\treturn;\n\n\tversion = cpu_to_le32(v9inode->qid.version);\n\tpath = cpu_to_le64(v9inode->qid.path);\n\tv9ses = v9fs_inode2v9ses(inode);\n\tv9inode->netfs.cache =\n\t\tfscache_acquire_cookie(v9fs_session_cache(v9ses),\n\t\t\t\t       0,\n\t\t\t\t       &path, sizeof(path),\n\t\t\t\t       &version, sizeof(version),\n\t\t\t\t       i_size_read(&v9inode->netfs.inode));\n\tif (v9inode->netfs.cache)\n\t\tmapping_set_release_always(inode->i_mapping);\n\n\tp9_debug(P9_DEBUG_FSC, \"inode %p get cookie %p\\n\",\n\t\t inode, v9fs_inode_cookie(v9inode));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}