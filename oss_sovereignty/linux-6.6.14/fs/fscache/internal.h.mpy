{
  "module_name": "internal.h",
  "hash_id": "239c79412519796c0acaf07a7b4358df6baf8a3b07270a844ba83b6855a548c2",
  "original_prompt": "Ingested from linux-6.6.14/fs/fscache/internal.h",
  "human_readable_source": " \n \n\n#ifdef pr_fmt\n#undef pr_fmt\n#endif\n\n#define pr_fmt(fmt) \"FS-Cache: \" fmt\n\n#include <linux/slab.h>\n#include <linux/fscache-cache.h>\n#include <trace/events/fscache.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n\n \n#ifdef CONFIG_PROC_FS\nextern const struct seq_operations fscache_caches_seq_ops;\n#endif\nbool fscache_begin_cache_access(struct fscache_cache *cache, enum fscache_access_trace why);\nvoid fscache_end_cache_access(struct fscache_cache *cache, enum fscache_access_trace why);\nstruct fscache_cache *fscache_lookup_cache(const char *name, bool is_cache);\nvoid fscache_put_cache(struct fscache_cache *cache, enum fscache_cache_trace where);\n\nstatic inline enum fscache_cache_state fscache_cache_state(const struct fscache_cache *cache)\n{\n\treturn smp_load_acquire(&cache->state);\n}\n\nstatic inline bool fscache_cache_is_live(const struct fscache_cache *cache)\n{\n\treturn fscache_cache_state(cache) == FSCACHE_CACHE_IS_ACTIVE;\n}\n\nstatic inline void fscache_set_cache_state(struct fscache_cache *cache,\n\t\t\t\t\t   enum fscache_cache_state new_state)\n{\n\tsmp_store_release(&cache->state, new_state);\n\n}\n\nstatic inline bool fscache_set_cache_state_maybe(struct fscache_cache *cache,\n\t\t\t\t\t\t enum fscache_cache_state old_state,\n\t\t\t\t\t\t enum fscache_cache_state new_state)\n{\n\treturn try_cmpxchg_release(&cache->state, &old_state, new_state);\n}\n\n \nextern struct kmem_cache *fscache_cookie_jar;\n#ifdef CONFIG_PROC_FS\nextern const struct seq_operations fscache_cookies_seq_ops;\n#endif\nextern struct timer_list fscache_cookie_lru_timer;\n\nextern void fscache_print_cookie(struct fscache_cookie *cookie, char prefix);\nextern bool fscache_begin_cookie_access(struct fscache_cookie *cookie,\n\t\t\t\t\tenum fscache_access_trace why);\n\nstatic inline void fscache_see_cookie(struct fscache_cookie *cookie,\n\t\t\t\t      enum fscache_cookie_trace where)\n{\n\ttrace_fscache_cookie(cookie->debug_id, refcount_read(&cookie->ref),\n\t\t\t     where);\n}\n\n \nextern unsigned fscache_debug;\n\nextern unsigned int fscache_hash(unsigned int salt, const void *data, size_t len);\n\n \n#ifdef CONFIG_PROC_FS\nextern int __init fscache_proc_init(void);\nextern void fscache_proc_cleanup(void);\n#else\n#define fscache_proc_init()\t(0)\n#define fscache_proc_cleanup()\tdo {} while (0)\n#endif\n\n \n#ifdef CONFIG_FSCACHE_STATS\nextern atomic_t fscache_n_volumes;\nextern atomic_t fscache_n_volumes_collision;\nextern atomic_t fscache_n_volumes_nomem;\nextern atomic_t fscache_n_cookies;\nextern atomic_t fscache_n_cookies_lru;\nextern atomic_t fscache_n_cookies_lru_expired;\nextern atomic_t fscache_n_cookies_lru_removed;\nextern atomic_t fscache_n_cookies_lru_dropped;\n\nextern atomic_t fscache_n_acquires;\nextern atomic_t fscache_n_acquires_ok;\nextern atomic_t fscache_n_acquires_oom;\n\nextern atomic_t fscache_n_invalidates;\n\nextern atomic_t fscache_n_relinquishes;\nextern atomic_t fscache_n_relinquishes_retire;\nextern atomic_t fscache_n_relinquishes_dropped;\n\nextern atomic_t fscache_n_resizes;\nextern atomic_t fscache_n_resizes_null;\n\nstatic inline void fscache_stat(atomic_t *stat)\n{\n\tatomic_inc(stat);\n}\n\nstatic inline void fscache_stat_d(atomic_t *stat)\n{\n\tatomic_dec(stat);\n}\n\n#define __fscache_stat(stat) (stat)\n\nint fscache_stats_show(struct seq_file *m, void *v);\n#else\n\n#define __fscache_stat(stat) (NULL)\n#define fscache_stat(stat) do {} while (0)\n#define fscache_stat_d(stat) do {} while (0)\n#endif\n\n \n#ifdef CONFIG_PROC_FS\nextern const struct seq_operations fscache_volumes_seq_ops;\n#endif\n\nstruct fscache_volume *fscache_get_volume(struct fscache_volume *volume,\n\t\t\t\t\t  enum fscache_volume_trace where);\nvoid fscache_put_volume(struct fscache_volume *volume,\n\t\t\tenum fscache_volume_trace where);\nbool fscache_begin_volume_access(struct fscache_volume *volume,\n\t\t\t\t struct fscache_cookie *cookie,\n\t\t\t\t enum fscache_access_trace why);\nvoid fscache_create_volume(struct fscache_volume *volume, bool wait);\n\n\n \n \n#define dbgprintk(FMT, ...) \\\n\tprintk(\"[%-6.6s] \"FMT\"\\n\", current->comm, ##__VA_ARGS__)\n\n#define kenter(FMT, ...) dbgprintk(\"==> %s(\"FMT\")\", __func__, ##__VA_ARGS__)\n#define kleave(FMT, ...) dbgprintk(\"<== %s()\"FMT\"\", __func__, ##__VA_ARGS__)\n#define kdebug(FMT, ...) dbgprintk(FMT, ##__VA_ARGS__)\n\n#define kjournal(FMT, ...) no_printk(FMT, ##__VA_ARGS__)\n\n#ifdef __KDEBUG\n#define _enter(FMT, ...) kenter(FMT, ##__VA_ARGS__)\n#define _leave(FMT, ...) kleave(FMT, ##__VA_ARGS__)\n#define _debug(FMT, ...) kdebug(FMT, ##__VA_ARGS__)\n\n#elif defined(CONFIG_FSCACHE_DEBUG)\n#define _enter(FMT, ...)\t\t\t\\\ndo {\t\t\t\t\t\t\\\n\tif (__do_kdebug(ENTER))\t\t\t\\\n\t\tkenter(FMT, ##__VA_ARGS__);\t\\\n} while (0)\n\n#define _leave(FMT, ...)\t\t\t\\\ndo {\t\t\t\t\t\t\\\n\tif (__do_kdebug(LEAVE))\t\t\t\\\n\t\tkleave(FMT, ##__VA_ARGS__);\t\\\n} while (0)\n\n#define _debug(FMT, ...)\t\t\t\\\ndo {\t\t\t\t\t\t\\\n\tif (__do_kdebug(DEBUG))\t\t\t\\\n\t\tkdebug(FMT, ##__VA_ARGS__);\t\\\n} while (0)\n\n#else\n#define _enter(FMT, ...) no_printk(\"==> %s(\"FMT\")\", __func__, ##__VA_ARGS__)\n#define _leave(FMT, ...) no_printk(\"<== %s()\"FMT\"\", __func__, ##__VA_ARGS__)\n#define _debug(FMT, ...) no_printk(FMT, ##__VA_ARGS__)\n#endif\n\n \n#define ____do_kdebug(LEVEL, POINT) \\\n\tunlikely((fscache_debug & \\\n\t\t  (FSCACHE_POINT_##POINT << (FSCACHE_DEBUG_ ## LEVEL * 3))))\n#define ___do_kdebug(LEVEL, POINT) \\\n\t____do_kdebug(LEVEL, POINT)\n#define __do_kdebug(POINT) \\\n\t___do_kdebug(FSCACHE_DEBUG_LEVEL, POINT)\n\n#define FSCACHE_DEBUG_CACHE\t0\n#define FSCACHE_DEBUG_COOKIE\t1\n#define FSCACHE_DEBUG_OBJECT\t2\n#define FSCACHE_DEBUG_OPERATION\t3\n\n#define FSCACHE_POINT_ENTER\t1\n#define FSCACHE_POINT_LEAVE\t2\n#define FSCACHE_POINT_DEBUG\t4\n\n#ifndef FSCACHE_DEBUG_LEVEL\n#define FSCACHE_DEBUG_LEVEL CACHE\n#endif\n\n \n#if 1  \n\n#define ASSERT(X)\t\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (unlikely(!(X))) {\t\t\t\t\t\t\\\n\t\tpr_err(\"\\n\");\t\t\t\t\t\\\n\t\tpr_err(\"Assertion failed\\n\");\t\\\n\t\tBUG();\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define ASSERTCMP(X, OP, Y)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (unlikely(!((X) OP (Y)))) {\t\t\t\t\t\\\n\t\tpr_err(\"\\n\");\t\t\t\t\t\\\n\t\tpr_err(\"Assertion failed\\n\");\t\\\n\t\tpr_err(\"%lx \" #OP \" %lx is false\\n\",\t\t\\\n\t\t       (unsigned long)(X), (unsigned long)(Y));\t\t\\\n\t\tBUG();\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define ASSERTIF(C, X)\t\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (unlikely((C) && !(X))) {\t\t\t\t\t\\\n\t\tpr_err(\"\\n\");\t\t\t\t\t\\\n\t\tpr_err(\"Assertion failed\\n\");\t\\\n\t\tBUG();\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define ASSERTIFCMP(C, X, OP, Y)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (unlikely((C) && !((X) OP (Y)))) {\t\t\t\t\\\n\t\tpr_err(\"\\n\");\t\t\t\t\t\\\n\t\tpr_err(\"Assertion failed\\n\");\t\\\n\t\tpr_err(\"%lx \" #OP \" %lx is false\\n\",\t\t\\\n\t\t       (unsigned long)(X), (unsigned long)(Y));\t\t\\\n\t\tBUG();\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#else\n\n#define ASSERT(X)\t\t\tdo {} while (0)\n#define ASSERTCMP(X, OP, Y)\t\tdo {} while (0)\n#define ASSERTIF(C, X)\t\t\tdo {} while (0)\n#define ASSERTIFCMP(C, X, OP, Y)\tdo {} while (0)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}