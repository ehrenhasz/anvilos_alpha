{
  "module_name": "dir.h",
  "hash_id": "9be63d2de415ce1dc0ce282b3a29ff94accb36b696c762d15194f0ff6583b76d",
  "original_prompt": "Ingested from linux-6.6.14/fs/gfs2/dir.h",
  "human_readable_source": " \n \n\n#ifndef __DIR_DOT_H__\n#define __DIR_DOT_H__\n\n#include <linux/dcache.h>\n#include <linux/crc32.h>\n\nstruct inode;\nstruct gfs2_inode;\nstruct gfs2_inum;\nstruct buffer_head;\nstruct gfs2_dirent;\n\nstruct gfs2_diradd {\n\tunsigned nr_blocks;\n\tstruct gfs2_dirent *dent;\n\tstruct buffer_head *bh;\n\tint save_loc;\n};\n\nextern struct inode *gfs2_dir_search(struct inode *dir,\n\t\t\t\t     const struct qstr *filename,\n\t\t\t\t     bool fail_on_exist);\nextern int gfs2_dir_check(struct inode *dir, const struct qstr *filename,\n\t\t\t  const struct gfs2_inode *ip);\nextern int gfs2_dir_add(struct inode *inode, const struct qstr *filename,\n\t\t\tconst struct gfs2_inode *ip, struct gfs2_diradd *da);\nstatic inline void gfs2_dir_no_add(struct gfs2_diradd *da)\n{\n\tbrelse(da->bh);\n\tda->bh = NULL;\n}\nextern int gfs2_dir_del(struct gfs2_inode *dip, const struct dentry *dentry);\nextern int gfs2_dir_read(struct inode *inode, struct dir_context *ctx,\n\t\t\t struct file_ra_state *f_ra);\nextern int gfs2_dir_mvino(struct gfs2_inode *dip, const struct qstr *filename,\n\t\t\t  const struct gfs2_inode *nip, unsigned int new_type);\n\nextern int gfs2_dir_exhash_dealloc(struct gfs2_inode *dip);\n\nextern int gfs2_diradd_alloc_required(struct inode *dir,\n\t\t\t\t      const struct qstr *filename,\n\t\t\t\t      struct gfs2_diradd *da);\nextern int gfs2_dir_get_new_buffer(struct gfs2_inode *ip, u64 block,\n\t\t\t\t   struct buffer_head **bhp);\nextern void gfs2_dir_hash_inval(struct gfs2_inode *ip);\n\nstatic inline u32 gfs2_disk_hash(const char *data, int len)\n{\n        return crc32_le((u32)~0, data, len) ^ (u32)~0;\n}\n\n\nstatic inline void gfs2_str2qstr(struct qstr *name, const char *fname)\n{\n\tname->name = fname;\n\tname->len = strlen(fname);\n\tname->hash = gfs2_disk_hash(name->name, name->len);\n}\n\n \nstatic inline void gfs2_qstr2dirent(const struct qstr *name, u16 reclen, struct gfs2_dirent *dent)\n{\n\tdent->de_inum.no_addr = cpu_to_be64(0);\n\tdent->de_inum.no_formal_ino = cpu_to_be64(0);\n\tdent->de_hash = cpu_to_be32(name->hash);\n\tdent->de_rec_len = cpu_to_be16(reclen);\n\tdent->de_name_len = cpu_to_be16(name->len);\n\tdent->de_type = cpu_to_be16(0);\n\tmemset(dent->__pad, 0, sizeof(dent->__pad));\n\tmemcpy(dent + 1, name->name, name->len);\n}\n\nextern struct qstr gfs2_qdot;\nextern struct qstr gfs2_qdotdot;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}