{
  "module_name": "shfl_hostintf.h",
  "hash_id": "ff56a3c5ee44405d7670e6b01316367b4d574dbb43224d6d80f5e1fb5f52f94d",
  "original_prompt": "Ingested from linux-6.6.14/fs/vboxsf/shfl_hostintf.h",
  "human_readable_source": " \n \n\n#ifndef SHFL_HOSTINTF_H\n#define SHFL_HOSTINTF_H\n\n#include <linux/vbox_vmmdev_types.h>\n\n \n#define SHFL_MAX_RW_COUNT           (16 * SZ_1M)\n\n \n\nenum {\n\tSHFL_FN_QUERY_MAPPINGS = 1,\t \n\tSHFL_FN_QUERY_MAP_NAME = 2,\t \n\tSHFL_FN_CREATE = 3,\t\t \n\tSHFL_FN_CLOSE = 4,\t\t \n\tSHFL_FN_READ = 5,\t\t \n\tSHFL_FN_WRITE = 6,\t\t \n\tSHFL_FN_LOCK = 7,\t\t \n\tSHFL_FN_LIST = 8,\t\t \n\tSHFL_FN_INFORMATION = 9,\t \n\t \n\tSHFL_FN_REMOVE = 11,\t\t \n\tSHFL_FN_MAP_FOLDER_OLD = 12,\t \n\tSHFL_FN_UNMAP_FOLDER = 13,\t \n\tSHFL_FN_RENAME = 14,\t\t \n\tSHFL_FN_FLUSH = 15,\t\t \n\tSHFL_FN_SET_UTF8 = 16,\t\t \n\tSHFL_FN_MAP_FOLDER = 17,\t \n\tSHFL_FN_READLINK = 18,\t\t \n\tSHFL_FN_SYMLINK = 19,\t\t \n\tSHFL_FN_SET_SYMLINKS = 20,\t \n};\n\n \n#define SHFL_ROOT_NIL\t\tUINT_MAX\n\n \n#define SHFL_HANDLE_NIL\t\tULLONG_MAX\n\n \n#define SHFL_MAX_LEN         (256)\n \n#define SHFL_MAX_MAPPINGS    (64)\n\n \nstruct shfl_string {\n\t \n\tu16 size;\n\n\t \n\tu16 length;\n\n\t \n\tunion {\n\t\tu8 legacy_padding[2];\n\t\tDECLARE_FLEX_ARRAY(u8, utf8);\n\t\tDECLARE_FLEX_ARRAY(u16, utf16);\n\t} string;\n};\nVMMDEV_ASSERT_SIZE(shfl_string, 6);\n\n \n#define SHFLSTRING_HEADER_SIZE  4\n\n \nstatic inline u32 shfl_string_buf_size(const struct shfl_string *string)\n{\n\treturn string ? SHFLSTRING_HEADER_SIZE + string->size : 0;\n}\n\n \n#define SHFL_UNIX_ISUID             0004000U\n \n#define SHFL_UNIX_ISGID             0002000U\n \n#define SHFL_UNIX_ISTXT             0001000U\n\n \n#define SHFL_UNIX_IRUSR             0000400U\n \n#define SHFL_UNIX_IWUSR             0000200U\n \n#define SHFL_UNIX_IXUSR             0000100U\n\n \n#define SHFL_UNIX_IRGRP             0000040U\n \n#define SHFL_UNIX_IWGRP             0000020U\n \n#define SHFL_UNIX_IXGRP             0000010U\n\n \n#define SHFL_UNIX_IROTH             0000004U\n \n#define SHFL_UNIX_IWOTH             0000002U\n \n#define SHFL_UNIX_IXOTH             0000001U\n\n \n#define SHFL_TYPE_FIFO              0010000U\n \n#define SHFL_TYPE_DEV_CHAR          0020000U\n \n#define SHFL_TYPE_DIRECTORY         0040000U\n \n#define SHFL_TYPE_DEV_BLOCK         0060000U\n \n#define SHFL_TYPE_FILE              0100000U\n \n#define SHFL_TYPE_SYMLINK           0120000U\n \n#define SHFL_TYPE_SOCKET            0140000U\n \n#define SHFL_TYPE_WHITEOUT          0160000U\n \n#define SHFL_TYPE_MASK              0170000U\n\n \n#define SHFL_IS_DIRECTORY(m)   (((m) & SHFL_TYPE_MASK) == SHFL_TYPE_DIRECTORY)\n \n#define SHFL_IS_SYMLINK(m)     (((m) & SHFL_TYPE_MASK) == SHFL_TYPE_SYMLINK)\n\n \nenum shfl_fsobjattr_add {\n\t \n\tSHFLFSOBJATTRADD_NOTHING = 1,\n\t \n\tSHFLFSOBJATTRADD_UNIX,\n\t \n\tSHFLFSOBJATTRADD_EASIZE,\n\t \n\tSHFLFSOBJATTRADD_LAST = SHFLFSOBJATTRADD_EASIZE,\n\n\t \n\tSHFLFSOBJATTRADD_32BIT_SIZE_HACK = 0x7fffffff\n};\n\n \nstruct shfl_fsobjattr_unix {\n\t \n\tu32 uid;\n\n\t \n\tu32 gid;\n\n\t \n\tu32 hardlinks;\n\n\t \n\tu32 inode_id_device;\n\n\t \n\tu64 inode_id;\n\n\t \n\tu32 flags;\n\n\t \n\tu32 generation_id;\n\n\t \n\tu32 device;\n} __packed;\n\n \nstruct shfl_fsobjattr_easize {\n\t \n\ts64 cb;\n} __packed;\n\n \nstruct shfl_fsobjattr {\n\t \n\tu32 mode;\n\n\t \n\tenum shfl_fsobjattr_add additional;\n\n\t \n\tunion {\n\t\tstruct shfl_fsobjattr_unix unix_attr;\n\t\tstruct shfl_fsobjattr_easize size;\n\t} __packed u;\n} __packed;\nVMMDEV_ASSERT_SIZE(shfl_fsobjattr, 44);\n\nstruct shfl_timespec {\n\ts64 ns_relative_to_unix_epoch;\n};\n\n \nstruct shfl_fsobjinfo {\n\t \n\ts64 size;\n\n\t \n\ts64 allocated;\n\n\t \n\tstruct shfl_timespec access_time;\n\n\t \n\tstruct shfl_timespec modification_time;\n\n\t \n\tstruct shfl_timespec change_time;\n\n\t \n\tstruct shfl_timespec birth_time;\n\n\t \n\tstruct shfl_fsobjattr attr;\n\n} __packed;\nVMMDEV_ASSERT_SIZE(shfl_fsobjinfo, 92);\n\n \nenum shfl_create_result {\n\tSHFL_NO_RESULT,\n\t \n\tSHFL_PATH_NOT_FOUND,\n\t \n\tSHFL_FILE_NOT_FOUND,\n\t \n\tSHFL_FILE_EXISTS,\n\t \n\tSHFL_FILE_CREATED,\n\t \n\tSHFL_FILE_REPLACED\n};\n\n \n#define SHFL_CF_NONE                  (0x00000000)\n\n \n#define SHFL_CF_LOOKUP                (0x00000001)\n\n \n#define SHFL_CF_OPEN_TARGET_DIRECTORY (0x00000002)\n\n \n#define SHFL_CF_DIRECTORY             (0x00000004)\n\n \n#define SHFL_CF_ACT_MASK_IF_EXISTS      (0x000000f0)\n#define SHFL_CF_ACT_MASK_IF_NEW         (0x00000f00)\n\n \n#define SHFL_CF_ACT_OPEN_IF_EXISTS      (0x00000000)\n#define SHFL_CF_ACT_FAIL_IF_EXISTS      (0x00000010)\n#define SHFL_CF_ACT_REPLACE_IF_EXISTS   (0x00000020)\n#define SHFL_CF_ACT_OVERWRITE_IF_EXISTS (0x00000030)\n\n \n#define SHFL_CF_ACT_CREATE_IF_NEW       (0x00000000)\n#define SHFL_CF_ACT_FAIL_IF_NEW         (0x00000100)\n\n \n#define SHFL_CF_ACCESS_MASK_RW          (0x00003000)\n\n \n#define SHFL_CF_ACCESS_NONE             (0x00000000)\n \n#define SHFL_CF_ACCESS_READ             (0x00001000)\n \n#define SHFL_CF_ACCESS_WRITE            (0x00002000)\n \n#define SHFL_CF_ACCESS_READWRITE\t(0x00003000)\n\n \n#define SHFL_CF_ACCESS_MASK_DENY        (0x0000c000)\n\n \n#define SHFL_CF_ACCESS_DENYNONE         (0x00000000)\n \n#define SHFL_CF_ACCESS_DENYREAD         (0x00004000)\n \n#define SHFL_CF_ACCESS_DENYWRITE        (0x00008000)\n \n#define SHFL_CF_ACCESS_DENYALL          (0x0000c000)\n\n \n#define SHFL_CF_ACCESS_MASK_ATTR        (0x00030000)\n\n \n#define SHFL_CF_ACCESS_ATTR_NONE        (0x00000000)\n \n#define SHFL_CF_ACCESS_ATTR_READ        (0x00010000)\n \n#define SHFL_CF_ACCESS_ATTR_WRITE       (0x00020000)\n \n#define SHFL_CF_ACCESS_ATTR_READWRITE   (0x00030000)\n\n \n#define SHFL_CF_ACCESS_APPEND           (0x00040000)\n\n \nstruct shfl_createparms {\n\t \n\tu64 handle;\n\n\t \n\tenum shfl_create_result result;\n\n\t \n\tu32 create_flags;\n\n\t \n\tstruct shfl_fsobjinfo info;\n} __packed;\n\n \nstruct shfl_dirinfo {\n\t \n\tstruct shfl_fsobjinfo info;\n\t \n\tu16 short_name_len;\n\t \n\tu16 short_name[14];\n\tstruct shfl_string name;\n};\n\n \nstruct shfl_fsproperties {\n\t \n\tu32 max_component_len;\n\n\t \n\tbool remote;\n\n\t \n\tbool case_sensitive;\n\n\t \n\tbool read_only;\n\n\t \n\tbool supports_unicode;\n\n\t \n\tbool compressed;\n\n\t \n\tbool file_compression;\n};\nVMMDEV_ASSERT_SIZE(shfl_fsproperties, 12);\n\nstruct shfl_volinfo {\n\ts64 total_allocation_bytes;\n\ts64 available_allocation_bytes;\n\tu32 bytes_per_allocation_unit;\n\tu32 bytes_per_sector;\n\tu32 serial;\n\tstruct shfl_fsproperties properties;\n};\n\n\n \nstruct shfl_map_folder {\n\t \n\tstruct vmmdev_hgcm_function_parameter path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter delimiter;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter case_sensitive;\n\n};\n\n \n#define SHFL_CPARMS_MAP_FOLDER (4)\n\n\n \nstruct shfl_unmap_folder {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n};\n\n \n#define SHFL_CPARMS_UNMAP_FOLDER (1)\n\n\n \nstruct shfl_create {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter parms;\n\n};\n\n \n#define SHFL_CPARMS_CREATE (3)\n\n\n \nstruct shfl_close {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter handle;\n\n};\n\n \n#define SHFL_CPARMS_CLOSE (2)\n\n\n \nstruct shfl_read {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter handle;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter offset;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter cb;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter buffer;\n\n};\n\n \n#define SHFL_CPARMS_READ (5)\n\n\n \nstruct shfl_write {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter handle;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter offset;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter cb;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter buffer;\n\n};\n\n \n#define SHFL_CPARMS_WRITE (5)\n\n\n \n\n#define SHFL_LIST_NONE\t\t\t0\n#define SHFL_LIST_RETURN_ONE\t\t1\n\n \nstruct shfl_list {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter handle;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter flags;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter cb;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter buffer;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter resume_point;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter file_count;\n};\n\n \n#define SHFL_CPARMS_LIST (8)\n\n\n \nstruct shfl_readLink {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter buffer;\n\n};\n\n \n#define SHFL_CPARMS_READLINK (3)\n\n\n \n\n \n#define SHFL_INFO_MODE_MASK    (0x1)\n \n#define SHFL_INFO_GET          (0x0)\n \n#define SHFL_INFO_SET          (0x1)\n\n \n#define SHFL_INFO_NAME         (0x2)\n \n#define SHFL_INFO_SIZE         (0x4)\n \n#define SHFL_INFO_FILE         (0x8)\n \n#define SHFL_INFO_VOLUME       (0x10)\n\n \nstruct shfl_information {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter handle;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter flags;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter cb;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter info;\n\n};\n\n \n#define SHFL_CPARMS_INFORMATION (5)\n\n\n \n\n#define SHFL_REMOVE_FILE        (0x1)\n#define SHFL_REMOVE_DIR         (0x2)\n#define SHFL_REMOVE_SYMLINK     (0x4)\n\n \nstruct shfl_remove {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter flags;\n\n};\n\n#define SHFL_CPARMS_REMOVE  (3)\n\n\n \n\n#define SHFL_RENAME_FILE                (0x1)\n#define SHFL_RENAME_DIR                 (0x2)\n#define SHFL_RENAME_REPLACE_IF_EXISTS   (0x4)\n\n \nstruct shfl_rename {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter src;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter dest;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter flags;\n\n};\n\n#define SHFL_CPARMS_RENAME  (4)\n\n\n \nstruct shfl_symlink {\n\t \n\tstruct vmmdev_hgcm_function_parameter root;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter new_path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter old_path;\n\n\t \n\tstruct vmmdev_hgcm_function_parameter info;\n\n};\n\n#define SHFL_CPARMS_SYMLINK  (4)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}