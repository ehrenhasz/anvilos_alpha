{
  "module_name": "xattr_trusted.c",
  "hash_id": "2bbf6652cfabb1ff26b841af53b7e1a6723f2d9af1da5cce19ef80b7b2c16c7d",
  "original_prompt": "Ingested from linux-6.6.14/fs/jffs2/xattr_trusted.c",
  "human_readable_source": " \n\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/jffs2.h>\n#include <linux/xattr.h>\n#include <linux/mtd/mtd.h>\n#include \"nodelist.h\"\n\nstatic int jffs2_trusted_getxattr(const struct xattr_handler *handler,\n\t\t\t\t  struct dentry *unused, struct inode *inode,\n\t\t\t\t  const char *name, void *buffer, size_t size)\n{\n\treturn do_jffs2_getxattr(inode, JFFS2_XPREFIX_TRUSTED,\n\t\t\t\t name, buffer, size);\n}\n\nstatic int jffs2_trusted_setxattr(const struct xattr_handler *handler,\n\t\t\t\t  struct mnt_idmap *idmap,\n\t\t\t\t  struct dentry *unused, struct inode *inode,\n\t\t\t\t  const char *name, const void *buffer,\n\t\t\t\t  size_t size, int flags)\n{\n\treturn do_jffs2_setxattr(inode, JFFS2_XPREFIX_TRUSTED,\n\t\t\t\t name, buffer, size, flags);\n}\n\nstatic bool jffs2_trusted_listxattr(struct dentry *dentry)\n{\n\treturn capable(CAP_SYS_ADMIN);\n}\n\nconst struct xattr_handler jffs2_trusted_xattr_handler = {\n\t.prefix = XATTR_TRUSTED_PREFIX,\n\t.list = jffs2_trusted_listxattr,\n\t.set = jffs2_trusted_setxattr,\n\t.get = jffs2_trusted_getxattr\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}