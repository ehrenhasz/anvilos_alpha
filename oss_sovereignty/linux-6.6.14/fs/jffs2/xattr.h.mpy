{
  "module_name": "xattr.h",
  "hash_id": "69bfef37caf8042820987a33de33fc15576f9df659381f94cf7827cf0c8da54f",
  "original_prompt": "Ingested from linux-6.6.14/fs/jffs2/xattr.h",
  "human_readable_source": " \n\n#ifndef _JFFS2_FS_XATTR_H_\n#define _JFFS2_FS_XATTR_H_\n\n#include <linux/xattr.h>\n#include <linux/list.h>\n\n#define JFFS2_XFLAGS_HOT\t(0x01)\t \n#define JFFS2_XFLAGS_BIND\t(0x02)\t \n#define JFFS2_XFLAGS_DEAD\t(0x40)\t \n#define JFFS2_XFLAGS_INVALID\t(0x80)\t \n\nstruct jffs2_xattr_datum\n{\n\tvoid *always_null;\n\tstruct jffs2_raw_node_ref *node;\n\tuint8_t class;\n\tuint8_t flags;\n\tuint16_t xprefix;\t\t \n\n\tstruct list_head xindex;\t \n\tatomic_t refcnt;\t\t \n\tuint32_t xid;\n\tuint32_t version;\n\n\tuint32_t data_crc;\n\tuint32_t hashkey;\n\tchar *xname;\t\t \n\tuint32_t name_len;\t \n\tchar *xvalue;\t\t \n\tuint32_t value_len;\t \n};\n\nstruct jffs2_inode_cache;\nstruct jffs2_xattr_ref\n{\n\tvoid *always_null;\n\tstruct jffs2_raw_node_ref *node;\n\tuint8_t class;\n\tuint8_t flags;\t\t \n\tu16 unused;\n\n\tuint32_t xseqno;\n\tunion {\n\t\tstruct jffs2_inode_cache *ic;\t \n\t\tuint32_t ino;\t\t\t \n\t};\n\tunion {\n\t\tstruct jffs2_xattr_datum *xd;\t \n\t\tuint32_t xid;\t\t\t \n\t};\n\tstruct jffs2_xattr_ref *next;\t\t \n};\n\n#define XREF_DELETE_MARKER\t(0x00000001)\nstatic inline int is_xattr_ref_dead(struct jffs2_xattr_ref *ref)\n{\n\treturn ((ref->xseqno & XREF_DELETE_MARKER) != 0);\n}\n\n#ifdef CONFIG_JFFS2_FS_XATTR\n\nextern void jffs2_init_xattr_subsystem(struct jffs2_sb_info *c);\nextern int jffs2_build_xattr_subsystem(struct jffs2_sb_info *c);\nextern void jffs2_clear_xattr_subsystem(struct jffs2_sb_info *c);\n\nextern struct jffs2_xattr_datum *jffs2_setup_xattr_datum(struct jffs2_sb_info *c,\n\t\t\t\t\t\t\t uint32_t xid, uint32_t version);\n\nextern void jffs2_xattr_do_crccheck_inode(struct jffs2_sb_info *c, struct jffs2_inode_cache *ic);\nextern void jffs2_xattr_delete_inode(struct jffs2_sb_info *c, struct jffs2_inode_cache *ic);\nextern void jffs2_xattr_free_inode(struct jffs2_sb_info *c, struct jffs2_inode_cache *ic);\n\nextern int jffs2_garbage_collect_xattr_datum(struct jffs2_sb_info *c, struct jffs2_xattr_datum *xd,\n\t\t\t\t\t     struct jffs2_raw_node_ref *raw);\nextern int jffs2_garbage_collect_xattr_ref(struct jffs2_sb_info *c, struct jffs2_xattr_ref *ref,\n\t\t\t\t\t   struct jffs2_raw_node_ref *raw);\nextern int jffs2_verify_xattr(struct jffs2_sb_info *c);\nextern void jffs2_release_xattr_datum(struct jffs2_sb_info *c, struct jffs2_xattr_datum *xd);\nextern void jffs2_release_xattr_ref(struct jffs2_sb_info *c, struct jffs2_xattr_ref *ref);\n\nextern int do_jffs2_getxattr(struct inode *inode, int xprefix, const char *xname,\n\t\t\t     char *buffer, size_t size);\nextern int do_jffs2_setxattr(struct inode *inode, int xprefix, const char *xname,\n\t\t\t     const char *buffer, size_t size, int flags);\n\nextern const struct xattr_handler *jffs2_xattr_handlers[];\nextern const struct xattr_handler jffs2_user_xattr_handler;\nextern const struct xattr_handler jffs2_trusted_xattr_handler;\n\nextern ssize_t jffs2_listxattr(struct dentry *, char *, size_t);\n\n#else\n\n#define jffs2_init_xattr_subsystem(c)\n#define jffs2_build_xattr_subsystem(c)\t\t(0)\n#define jffs2_clear_xattr_subsystem(c)\n\n#define jffs2_xattr_do_crccheck_inode(c, ic)\n#define jffs2_xattr_delete_inode(c, ic)\n#define jffs2_xattr_free_inode(c, ic)\n#define jffs2_verify_xattr(c)\t\t\t(1)\n\n#define jffs2_xattr_handlers\tNULL\n#define jffs2_listxattr\t\tNULL\n\n#endif  \n\n#ifdef CONFIG_JFFS2_FS_SECURITY\nextern int jffs2_init_security(struct inode *inode, struct inode *dir,\n\t\t\t       const struct qstr *qstr);\nextern const struct xattr_handler jffs2_security_xattr_handler;\n#else\n#define jffs2_init_security(inode,dir,qstr)\t(0)\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}