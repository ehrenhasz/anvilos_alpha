{
  "module_name": "security.c",
  "hash_id": "21cd2157b6fe916fcab58c4fac73983a7051e4dfb0b335919a35c6798764832a",
  "original_prompt": "Ingested from linux-6.6.14/fs/jffs2/security.c",
  "human_readable_source": " \n\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/crc32.h>\n#include <linux/jffs2.h>\n#include <linux/xattr.h>\n#include <linux/mtd/mtd.h>\n#include <linux/security.h>\n#include \"nodelist.h\"\n\n \nstatic int jffs2_initxattrs(struct inode *inode,\n\t\t\t    const struct xattr *xattr_array, void *fs_info)\n{\n\tconst struct xattr *xattr;\n\tint err = 0;\n\n\tfor (xattr = xattr_array; xattr->name != NULL; xattr++) {\n\t\terr = do_jffs2_setxattr(inode, JFFS2_XPREFIX_SECURITY,\n\t\t\t\t\txattr->name, xattr->value,\n\t\t\t\t\txattr->value_len, 0);\n\t\tif (err < 0)\n\t\t\tbreak;\n\t}\n\treturn err;\n}\n\n \nint jffs2_init_security(struct inode *inode, struct inode *dir,\n\t\t\tconst struct qstr *qstr)\n{\n\treturn security_inode_init_security(inode, dir, qstr,\n\t\t\t\t\t    &jffs2_initxattrs, NULL);\n}\n\n \nstatic int jffs2_security_getxattr(const struct xattr_handler *handler,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, void *buffer, size_t size)\n{\n\treturn do_jffs2_getxattr(inode, JFFS2_XPREFIX_SECURITY,\n\t\t\t\t name, buffer, size);\n}\n\nstatic int jffs2_security_setxattr(const struct xattr_handler *handler,\n\t\t\t\t   struct mnt_idmap *idmap,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, const void *buffer,\n\t\t\t\t   size_t size, int flags)\n{\n\treturn do_jffs2_setxattr(inode, JFFS2_XPREFIX_SECURITY,\n\t\t\t\t name, buffer, size, flags);\n}\n\nconst struct xattr_handler jffs2_security_xattr_handler = {\n\t.prefix = XATTR_SECURITY_PREFIX,\n\t.set = jffs2_security_setxattr,\n\t.get = jffs2_security_getxattr\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}