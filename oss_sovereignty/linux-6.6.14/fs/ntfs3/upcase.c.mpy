{
  "module_name": "upcase.c",
  "hash_id": "83ca9d41dc680e3bc1933f57d111046d78d290db6277ec9cd481ea57dece35c3",
  "original_prompt": "Ingested from linux-6.6.14/fs/ntfs3/upcase.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/types.h>\n\n#include \"ntfs_fs.h\"\n\nstatic inline u16 upcase_unicode_char(const u16 *upcase, u16 chr)\n{\n\tif (chr < 'a')\n\t\treturn chr;\n\n\tif (chr <= 'z')\n\t\treturn chr - ('a' - 'A');\n\n\treturn upcase[chr];\n}\n\n \nint ntfs_cmp_names(const __le16 *s1, size_t l1, const __le16 *s2, size_t l2,\n\t\t   const u16 *upcase, bool bothcase)\n{\n\tint diff1 = 0;\n\tint diff2;\n\tsize_t len = min(l1, l2);\n\n\tif (!bothcase && upcase)\n\t\tgoto case_insentive;\n\n\tfor (; len; s1++, s2++, len--) {\n\t\tdiff1 = le16_to_cpu(*s1) - le16_to_cpu(*s2);\n\t\tif (diff1) {\n\t\t\tif (bothcase && upcase)\n\t\t\t\tgoto case_insentive;\n\n\t\t\treturn diff1;\n\t\t}\n\t}\n\treturn l1 - l2;\n\ncase_insentive:\n\tfor (; len; s1++, s2++, len--) {\n\t\tdiff2 = upcase_unicode_char(upcase, le16_to_cpu(*s1)) -\n\t\t\tupcase_unicode_char(upcase, le16_to_cpu(*s2));\n\t\tif (diff2)\n\t\t\treturn diff2;\n\t}\n\n\tdiff2 = l1 - l2;\n\treturn diff2 ? diff2 : diff1;\n}\n\nint ntfs_cmp_names_cpu(const struct cpu_str *uni1, const struct le_str *uni2,\n\t\t       const u16 *upcase, bool bothcase)\n{\n\tconst u16 *s1 = uni1->name;\n\tconst __le16 *s2 = uni2->name;\n\tsize_t l1 = uni1->len;\n\tsize_t l2 = uni2->len;\n\tsize_t len = min(l1, l2);\n\tint diff1 = 0;\n\tint diff2;\n\n\tif (!bothcase && upcase)\n\t\tgoto case_insentive;\n\n\tfor (; len; s1++, s2++, len--) {\n\t\tdiff1 = *s1 - le16_to_cpu(*s2);\n\t\tif (diff1) {\n\t\t\tif (bothcase && upcase)\n\t\t\t\tgoto case_insentive;\n\n\t\t\treturn diff1;\n\t\t}\n\t}\n\treturn l1 - l2;\n\ncase_insentive:\n\tfor (; len; s1++, s2++, len--) {\n\t\tdiff2 = upcase_unicode_char(upcase, *s1) -\n\t\t\tupcase_unicode_char(upcase, le16_to_cpu(*s2));\n\t\tif (diff2)\n\t\t\treturn diff2;\n\t}\n\n\tdiff2 = l1 - l2;\n\treturn diff2 ? diff2 : diff1;\n}\n\n \nunsigned long ntfs_names_hash(const u16 *name, size_t len, const u16 *upcase,\n\t\t\t      unsigned long hash)\n{\n\twhile (len--) {\n\t\tunsigned int c = upcase_unicode_char(upcase, *name++);\n\t\thash = partial_name_hash(c, hash);\n\t}\n\n\treturn hash;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}