{
  "module_name": "hfsplus_raw.h",
  "hash_id": "190b0f90b2add389f90dbdf1f104da4c90200cf0ef40db5e719cded4927278f1",
  "original_prompt": "Ingested from linux-6.6.14/fs/hfsplus/hfsplus_raw.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_HFSPLUS_RAW_H\n#define _LINUX_HFSPLUS_RAW_H\n\n#include <linux/types.h>\n\n \n#define HFSPLUS_SECTOR_SIZE        512\n#define HFSPLUS_SECTOR_SHIFT         9\n#define HFSPLUS_VOLHEAD_SECTOR       2\n#define HFSPLUS_VOLHEAD_SIG     0x482b\n#define HFSPLUS_VOLHEAD_SIGX    0x4858\n#define HFSPLUS_SUPER_MAGIC     0x482b\n#define HFSPLUS_MIN_VERSION          4\n#define HFSPLUS_CURRENT_VERSION      5\n\n#define HFSP_WRAP_MAGIC         0x4244\n#define HFSP_WRAP_ATTRIB_SLOCK  0x8000\n#define HFSP_WRAP_ATTRIB_SPARED 0x0200\n\n#define HFSP_WRAPOFF_SIG          0x00\n#define HFSP_WRAPOFF_ATTRIB       0x0A\n#define HFSP_WRAPOFF_ABLKSIZE     0x14\n#define HFSP_WRAPOFF_ABLKSTART    0x1C\n#define HFSP_WRAPOFF_EMBEDSIG     0x7C\n#define HFSP_WRAPOFF_EMBEDEXT     0x7E\n\n#define HFSP_HIDDENDIR_NAME \\\n\t\"\\xe2\\x90\\x80\\xe2\\x90\\x80\\xe2\\x90\\x80\\xe2\\x90\\x80HFS+ Private Data\"\n\n#define HFSP_HARDLINK_TYPE\t0x686c6e6b\t \n#define HFSP_HFSPLUS_CREATOR\t0x6866732b\t \n\n#define HFSP_SYMLINK_TYPE\t0x736c6e6b\t \n#define HFSP_SYMLINK_CREATOR\t0x72686170\t \n\n#define HFSP_MOUNT_VERSION\t0x482b4c78\t \n\n \n\ntypedef __be32 hfsplus_cnid;\ntypedef __be16 hfsplus_unichr;\n\n#define HFSPLUS_MAX_STRLEN 255\n#define HFSPLUS_ATTR_MAX_STRLEN 127\n\n \nstruct hfsplus_unistr {\n\t__be16 length;\n\thfsplus_unichr unicode[HFSPLUS_MAX_STRLEN];\n} __packed;\n\n \nstruct hfsplus_attr_unistr {\n\t__be16 length;\n\thfsplus_unichr unicode[HFSPLUS_ATTR_MAX_STRLEN];\n} __packed;\n\n \nstruct hfsplus_perm {\n\t__be32 owner;\n\t__be32 group;\n\tu8  rootflags;\n\tu8  userflags;\n\t__be16 mode;\n\t__be32 dev;\n} __packed;\n\n#define HFSPLUS_FLG_NODUMP\t0x01\n#define HFSPLUS_FLG_IMMUTABLE\t0x02\n#define HFSPLUS_FLG_APPEND\t0x04\n\n \nstruct hfsplus_extent {\n\t__be32 start_block;\n\t__be32 block_count;\n} __packed;\ntypedef struct hfsplus_extent hfsplus_extent_rec[8];\n\n \nstruct hfsplus_fork_raw {\n\t__be64 total_size;\n\t__be32 clump_size;\n\t__be32 total_blocks;\n\thfsplus_extent_rec extents;\n} __packed;\n\n \nstruct hfsplus_vh {\n\t__be16 signature;\n\t__be16 version;\n\t__be32 attributes;\n\t__be32 last_mount_vers;\n\tu32 reserved;\n\n\t__be32 create_date;\n\t__be32 modify_date;\n\t__be32 backup_date;\n\t__be32 checked_date;\n\n\t__be32 file_count;\n\t__be32 folder_count;\n\n\t__be32 blocksize;\n\t__be32 total_blocks;\n\t__be32 free_blocks;\n\n\t__be32 next_alloc;\n\t__be32 rsrc_clump_sz;\n\t__be32 data_clump_sz;\n\thfsplus_cnid next_cnid;\n\n\t__be32 write_count;\n\t__be64 encodings_bmp;\n\n\tu32 finder_info[8];\n\n\tstruct hfsplus_fork_raw alloc_file;\n\tstruct hfsplus_fork_raw ext_file;\n\tstruct hfsplus_fork_raw cat_file;\n\tstruct hfsplus_fork_raw attr_file;\n\tstruct hfsplus_fork_raw start_file;\n} __packed;\n\n \n#define HFSPLUS_VOL_UNMNT\t\t(1 << 8)\n#define HFSPLUS_VOL_SPARE_BLK\t\t(1 << 9)\n#define HFSPLUS_VOL_NOCACHE\t\t(1 << 10)\n#define HFSPLUS_VOL_INCNSTNT\t\t(1 << 11)\n#define HFSPLUS_VOL_NODEID_REUSED\t(1 << 12)\n#define HFSPLUS_VOL_JOURNALED\t\t(1 << 13)\n#define HFSPLUS_VOL_SOFTLOCK\t\t(1 << 15)\n#define HFSPLUS_VOL_UNUSED_NODE_FIX\t(1 << 31)\n\n \nstruct hfs_bnode_desc {\n\t__be32 next;\n\t__be32 prev;\n\ts8 type;\n\tu8 height;\n\t__be16 num_recs;\n\tu16 reserved;\n} __packed;\n\n \n#define HFS_NODE_INDEX\t0x00\t \n#define HFS_NODE_HEADER\t0x01\t \n#define HFS_NODE_MAP\t0x02\t \n#define HFS_NODE_LEAF\t0xFF\t \n\n \nstruct hfs_btree_header_rec {\n\t__be16 depth;\n\t__be32 root;\n\t__be32 leaf_count;\n\t__be32 leaf_head;\n\t__be32 leaf_tail;\n\t__be16 node_size;\n\t__be16 max_key_len;\n\t__be32 node_count;\n\t__be32 free_nodes;\n\tu16 reserved1;\n\t__be32 clump_size;\n\tu8 btree_type;\n\tu8 key_type;\n\t__be32 attributes;\n\tu32 reserved3[16];\n} __packed;\n\n \n#define HFS_TREE_BIGKEYS\t2\n#define HFS_TREE_VARIDXKEYS\t4\n\n \n#define HFSPLUS_TREE_HEAD 0\n#define HFSPLUS_NODE_MXSZ 32768\n#define HFSPLUS_ATTR_TREE_NODE_SIZE\t\t8192\n#define HFSPLUS_BTREE_HDR_NODE_RECS_COUNT\t3\n#define HFSPLUS_BTREE_HDR_USER_BYTES\t\t128\n\n \n#define HFSPLUS_POR_CNID\t\t1\t \n#define HFSPLUS_ROOT_CNID\t\t2\t \n#define HFSPLUS_EXT_CNID\t\t3\t \n#define HFSPLUS_CAT_CNID\t\t4\t \n#define HFSPLUS_BAD_CNID\t\t5\t \n#define HFSPLUS_ALLOC_CNID\t\t6\t \n#define HFSPLUS_START_CNID\t\t7\t \n#define HFSPLUS_ATTR_CNID\t\t8\t \n#define HFSPLUS_EXCH_CNID\t\t15\t \n#define HFSPLUS_FIRSTUSER_CNID\t\t16\t \n\n \n#define HFSPLUS_KEY_CASEFOLDING\t\t0xCF\t \n#define HFSPLUS_KEY_BINARY\t\t0xBC\t \n\n \nstruct hfsplus_cat_key {\n\t__be16 key_len;\n\thfsplus_cnid parent;\n\tstruct hfsplus_unistr name;\n} __packed;\n\n#define HFSPLUS_CAT_KEYLEN\t(sizeof(struct hfsplus_cat_key))\n\n \nstruct hfsp_point {\n\t__be16 v;\n\t__be16 h;\n} __packed;\n\nstruct hfsp_rect {\n\t__be16 top;\n\t__be16 left;\n\t__be16 bottom;\n\t__be16 right;\n} __packed;\n\n\n \nstruct DInfo {\n\tstruct hfsp_rect frRect;\n\t__be16 frFlags;\n\tstruct hfsp_point frLocation;\n\t__be16 frView;\n} __packed;\n\nstruct DXInfo {\n\tstruct hfsp_point frScroll;\n\t__be32 frOpenChain;\n\t__be16 frUnused;\n\t__be16 frComment;\n\t__be32 frPutAway;\n} __packed;\n\n \nstruct hfsplus_cat_folder {\n\t__be16 type;\n\t__be16 flags;\n\t__be32 valence;\n\thfsplus_cnid id;\n\t__be32 create_date;\n\t__be32 content_mod_date;\n\t__be32 attribute_mod_date;\n\t__be32 access_date;\n\t__be32 backup_date;\n\tstruct hfsplus_perm permissions;\n\tstruct_group_attr(info, __packed,\n\t\tstruct DInfo user_info;\n\t\tstruct DXInfo finder_info;\n\t);\n\t__be32 text_encoding;\n\t__be32 subfolders;\t \n} __packed;\n\n \nstruct FInfo {\n\t__be32 fdType;\n\t__be32 fdCreator;\n\t__be16 fdFlags;\n\tstruct hfsp_point fdLocation;\n\t__be16 fdFldr;\n} __packed;\n\nstruct FXInfo {\n\t__be16 fdIconID;\n\tu8 fdUnused[8];\n\t__be16 fdComment;\n\t__be32 fdPutAway;\n} __packed;\n\n \nstruct hfsplus_cat_file {\n\t__be16 type;\n\t__be16 flags;\n\tu32 reserved1;\n\thfsplus_cnid id;\n\t__be32 create_date;\n\t__be32 content_mod_date;\n\t__be32 attribute_mod_date;\n\t__be32 access_date;\n\t__be32 backup_date;\n\tstruct hfsplus_perm permissions;\n\tstruct_group_attr(info, __packed,\n\t\tstruct FInfo user_info;\n\t\tstruct FXInfo finder_info;\n\t);\n\t__be32 text_encoding;\n\tu32 reserved2;\n\n\tstruct hfsplus_fork_raw data_fork;\n\tstruct hfsplus_fork_raw rsrc_fork;\n} __packed;\n\n \n#define HFSPLUS_FILE_LOCKED\t\t0x0001\n#define HFSPLUS_FILE_THREAD_EXISTS\t0x0002\n#define HFSPLUS_XATTR_EXISTS\t\t0x0004\n#define HFSPLUS_ACL_EXISTS\t\t0x0008\n#define HFSPLUS_HAS_FOLDER_COUNT\t0x0010\t \n\n \nstruct hfsplus_cat_thread {\n\t__be16 type;\n\ts16 reserved;\n\thfsplus_cnid parentID;\n\tstruct hfsplus_unistr nodeName;\n} __packed;\n\n#define HFSPLUS_MIN_THREAD_SZ 10\n\n \ntypedef union {\n\t__be16 type;\n\tstruct hfsplus_cat_folder folder;\n\tstruct hfsplus_cat_file file;\n\tstruct hfsplus_cat_thread thread;\n} __packed hfsplus_cat_entry;\n\n \n#define HFSPLUS_FOLDER         0x0001\n#define HFSPLUS_FILE           0x0002\n#define HFSPLUS_FOLDER_THREAD  0x0003\n#define HFSPLUS_FILE_THREAD    0x0004\n\n \nstruct hfsplus_ext_key {\n\t__be16 key_len;\n\tu8 fork_type;\n\tu8 pad;\n\thfsplus_cnid cnid;\n\t__be32 start_block;\n} __packed;\n\n#define HFSPLUS_EXT_KEYLEN\tsizeof(struct hfsplus_ext_key)\n\n#define HFSPLUS_XATTR_FINDER_INFO_NAME \"com.apple.FinderInfo\"\n#define HFSPLUS_XATTR_ACL_NAME \"com.apple.system.Security\"\n\n#define HFSPLUS_ATTR_INLINE_DATA 0x10\n#define HFSPLUS_ATTR_FORK_DATA   0x20\n#define HFSPLUS_ATTR_EXTENTS     0x30\n\n \nstruct hfsplus_attr_key {\n\t__be16 key_len;\n\t__be16 pad;\n\thfsplus_cnid cnid;\n\t__be32 start_block;\n\tstruct hfsplus_attr_unistr key_name;\n} __packed;\n\n#define HFSPLUS_ATTR_KEYLEN\tsizeof(struct hfsplus_attr_key)\n\n \nstruct hfsplus_attr_fork_data {\n\t__be32 record_type;\n\t__be32 reserved;\n\tstruct hfsplus_fork_raw the_fork;\n} __packed;\n\n \nstruct hfsplus_attr_extents {\n\t__be32 record_type;\n\t__be32 reserved;\n\tstruct hfsplus_extent extents;\n} __packed;\n\n#define HFSPLUS_MAX_INLINE_DATA_SIZE 3802\n\n \nstruct hfsplus_attr_inline_data {\n\t__be32 record_type;\n\t__be32 reserved1;\n\tu8 reserved2[6];\n\t__be16 length;\n\tu8 raw_bytes[HFSPLUS_MAX_INLINE_DATA_SIZE];\n} __packed;\n\n \ntypedef union {\n\t__be32 record_type;\n\tstruct hfsplus_attr_fork_data fork_data;\n\tstruct hfsplus_attr_extents extents;\n\tstruct hfsplus_attr_inline_data inline_data;\n} __packed hfsplus_attr_entry;\n\n \ntypedef union {\n\t__be16 key_len;\n\tstruct hfsplus_cat_key cat;\n\tstruct hfsplus_ext_key ext;\n\tstruct hfsplus_attr_key attr;\n} __packed hfsplus_btree_key;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}