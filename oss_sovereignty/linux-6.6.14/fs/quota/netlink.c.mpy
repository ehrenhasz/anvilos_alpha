{
  "module_name": "netlink.c",
  "hash_id": "8dc84afc2ca14bc330b0b855dd402c257392a01ec91905baa5f72e40fea3066b",
  "original_prompt": "Ingested from linux-6.6.14/fs/quota/netlink.c",
  "human_readable_source": "\n#include <linux/cred.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/quotaops.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <net/netlink.h>\n#include <net/genetlink.h>\n\nstatic const struct genl_multicast_group quota_mcgrps[] = {\n\t{ .name = \"events\", },\n};\n\n \nstatic struct genl_family quota_genl_family __ro_after_init = {\n\t.module = THIS_MODULE,\n\t.hdrsize = 0,\n\t.name = \"VFS_DQUOT\",\n\t.version = 1,\n\t.maxattr = QUOTA_NL_A_MAX,\n\t.mcgrps = quota_mcgrps,\n\t.n_mcgrps = ARRAY_SIZE(quota_mcgrps),\n};\n\n \n\nvoid quota_send_warning(struct kqid qid, dev_t dev,\n\t\t\tconst char warntype)\n{\n\tstatic atomic_t seq;\n\tstruct sk_buff *skb;\n\tvoid *msg_head;\n\tint ret;\n\tint msg_size = 4 * nla_total_size(sizeof(u32)) +\n\t\t       2 * nla_total_size_64bit(sizeof(u64));\n\n\t \n\tskb = genlmsg_new(msg_size, GFP_NOFS);\n\tif (!skb) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Not enough memory to send quota warning.\\n\");\n\t\treturn;\n\t}\n\tmsg_head = genlmsg_put(skb, 0, atomic_add_return(1, &seq),\n\t\t\t&quota_genl_family, 0, QUOTA_NL_C_WARNING);\n\tif (!msg_head) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Cannot store netlink header in quota warning.\\n\");\n\t\tgoto err_out;\n\t}\n\tret = nla_put_u32(skb, QUOTA_NL_A_QTYPE, qid.type);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64_64bit(skb, QUOTA_NL_A_EXCESS_ID,\n\t\t\t\tfrom_kqid_munged(&init_user_ns, qid),\n\t\t\t\tQUOTA_NL_A_PAD);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_WARNING, warntype);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MAJOR, MAJOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MINOR, MINOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64_64bit(skb, QUOTA_NL_A_CAUSED_ID,\n\t\t\t\tfrom_kuid_munged(&init_user_ns, current_uid()),\n\t\t\t\tQUOTA_NL_A_PAD);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tgenlmsg_end(skb, msg_head);\n\n\tgenlmsg_multicast(&quota_genl_family, skb, 0, 0, GFP_NOFS);\n\treturn;\nattr_err_out:\n\tprintk(KERN_ERR \"VFS: Not enough space to compose quota message!\\n\");\nerr_out:\n\tkfree_skb(skb);\n}\nEXPORT_SYMBOL(quota_send_warning);\n\nstatic int __init quota_init(void)\n{\n\tif (genl_register_family(&quota_genl_family) != 0)\n\t\tprintk(KERN_ERR\n\t\t       \"VFS: Failed to create quota netlink interface.\\n\");\n\treturn 0;\n};\nfs_initcall(quota_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}