{
  "module_name": "inotify.h",
  "hash_id": "b49974310f770384f07f48541baf6794846fdaf5c2f7a77ef4665f3b2d9bbcb0",
  "original_prompt": "Ingested from linux-6.6.14/fs/notify/inotify/inotify.h",
  "human_readable_source": " \n#include <linux/fsnotify_backend.h>\n#include <linux/inotify.h>\n#include <linux/slab.h>  \n\nstruct inotify_event_info {\n\tstruct fsnotify_event fse;\n\tu32 mask;\n\tint wd;\n\tu32 sync_cookie;\n\tint name_len;\n\tchar name[];\n};\n\nstruct inotify_inode_mark {\n\tstruct fsnotify_mark fsn_mark;\n\tint wd;\n};\n\nstatic inline struct inotify_event_info *INOTIFY_E(struct fsnotify_event *fse)\n{\n\treturn container_of(fse, struct inotify_event_info, fse);\n}\n\n \n#define INOTIFY_USER_MASK (IN_ALL_EVENTS)\n\nstatic inline __u32 inotify_mark_user_mask(struct fsnotify_mark *fsn_mark)\n{\n\t__u32 mask = fsn_mark->mask & INOTIFY_USER_MASK;\n\n\tif (fsn_mark->flags & FSNOTIFY_MARK_FLAG_EXCL_UNLINK)\n\t\tmask |= IN_EXCL_UNLINK;\n\tif (fsn_mark->flags & FSNOTIFY_MARK_FLAG_IN_ONESHOT)\n\t\tmask |= IN_ONESHOT;\n\n\treturn mask;\n}\n\nextern void inotify_ignored_and_remove_idr(struct fsnotify_mark *fsn_mark,\n\t\t\t\t\t   struct fsnotify_group *group);\nextern int inotify_handle_inode_event(struct fsnotify_mark *inode_mark,\n\t\t\t\t      u32 mask, struct inode *inode,\n\t\t\t\t      struct inode *dir,\n\t\t\t\t      const struct qstr *name, u32 cookie);\n\nextern const struct fsnotify_ops inotify_fsnotify_ops;\nextern struct kmem_cache *inotify_inode_mark_cachep;\n\n#ifdef CONFIG_INOTIFY_USER\nstatic inline void dec_inotify_instances(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_INOTIFY_INSTANCES);\n}\n\nstatic inline struct ucounts *inc_inotify_watches(struct ucounts *ucounts)\n{\n\treturn inc_ucount(ucounts->ns, ucounts->uid, UCOUNT_INOTIFY_WATCHES);\n}\n\nstatic inline void dec_inotify_watches(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_INOTIFY_WATCHES);\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}