{
  "module_name": "tcp.h",
  "hash_id": "4ebad254f33346dc9bfdec1a3995e6693ca788764ac53236067c95142467fb0d",
  "original_prompt": "Ingested from linux-6.6.14/fs/ocfs2/cluster/tcp.h",
  "human_readable_source": " \n \n\n#ifndef O2CLUSTER_TCP_H\n#define O2CLUSTER_TCP_H\n\n#include <linux/socket.h>\n#ifdef __KERNEL__\n#include <net/sock.h>\n#include <linux/tcp.h>\n#else\n#include <sys/socket.h>\n#endif\n#include <linux/inet.h>\n#include <linux/in.h>\n\nstruct o2net_msg\n{\n\t__be16 magic;\n\t__be16 data_len;\n\t__be16 msg_type;\n\t__be16 pad1;\n\t__be32 sys_status;\n\t__be32 status;\n\t__be32 key;\n\t__be32 msg_num;\n\t__u8  buf[];\n};\n\ntypedef int (o2net_msg_handler_func)(struct o2net_msg *msg, u32 len, void *data,\n\t\t\t\t     void **ret_data);\ntypedef void (o2net_post_msg_handler_func)(int status, void *data,\n\t\t\t\t\t   void *ret_data);\n\n#define O2NET_MAX_PAYLOAD_BYTES  (4096 - sizeof(struct o2net_msg))\n\n \n#define O2NET_RECONNECT_DELAY_MS_DEFAULT\t2000\n\n#define O2NET_KEEPALIVE_DELAY_MS_DEFAULT\t2000\n#define O2NET_IDLE_TIMEOUT_MS_DEFAULT\t\t30000\n\n#define O2NET_TCP_USER_TIMEOUT\t\t\t0x7fffffff\n\n \nstatic inline int o2net_link_down(int err, struct socket *sock)\n{\n\tif (sock) {\n\t\tif (sock->sk->sk_state != TCP_ESTABLISHED &&\n\t    \t    sock->sk->sk_state != TCP_CLOSE_WAIT)\n\t\t\treturn 1;\n\t}\n\n\tif (err >= 0)\n\t\treturn 0;\n\tswitch (err) {\n\t\t \n\t\tcase -ERESTARTSYS:\n\t\tcase -EBADF:\n\t\t \n\t\tcase -ECONNREFUSED:\n\t\tcase -ENOTCONN:\n\t\tcase -ECONNRESET:\n\t\tcase -EPIPE:\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nenum {\n\tO2NET_DRIVER_UNINITED,\n\tO2NET_DRIVER_READY,\n};\n\nint o2net_send_message(u32 msg_type, u32 key, void *data, u32 len,\n\t\t       u8 target_node, int *status);\nint o2net_send_message_vec(u32 msg_type, u32 key, struct kvec *vec,\n\t\t\t   size_t veclen, u8 target_node, int *status);\n\nint o2net_register_handler(u32 msg_type, u32 key, u32 max_len,\n\t\t\t   o2net_msg_handler_func *func, void *data,\n\t\t\t   o2net_post_msg_handler_func *post_func,\n\t\t\t   struct list_head *unreg_list);\nvoid o2net_unregister_handler_list(struct list_head *list);\n\nvoid o2net_fill_node_map(unsigned long *map, unsigned bytes);\n\nstruct o2nm_node;\nint o2net_register_hb_callbacks(void);\nvoid o2net_unregister_hb_callbacks(void);\nint o2net_start_listening(struct o2nm_node *node);\nvoid o2net_stop_listening(struct o2nm_node *node);\nvoid o2net_disconnect_node(struct o2nm_node *node);\nint o2net_num_connected_peers(void);\n\nint o2net_init(void);\nvoid o2net_exit(void);\n\nstruct o2net_send_tracking;\nstruct o2net_sock_container;\n\n#ifdef CONFIG_DEBUG_FS\nvoid o2net_debugfs_init(void);\nvoid o2net_debugfs_exit(void);\nvoid o2net_debug_add_nst(struct o2net_send_tracking *nst);\nvoid o2net_debug_del_nst(struct o2net_send_tracking *nst);\nvoid o2net_debug_add_sc(struct o2net_sock_container *sc);\nvoid o2net_debug_del_sc(struct o2net_sock_container *sc);\n#else\nstatic inline void o2net_debugfs_init(void)\n{\n}\nstatic inline void o2net_debugfs_exit(void)\n{\n}\nstatic inline void o2net_debug_add_nst(struct o2net_send_tracking *nst)\n{\n}\nstatic inline void o2net_debug_del_nst(struct o2net_send_tracking *nst)\n{\n}\nstatic inline void o2net_debug_add_sc(struct o2net_sock_container *sc)\n{\n}\nstatic inline void o2net_debug_del_sc(struct o2net_sock_container *sc)\n{\n}\n#endif\t \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}