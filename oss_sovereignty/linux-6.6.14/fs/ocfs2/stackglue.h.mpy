{
  "module_name": "stackglue.h",
  "hash_id": "41b17e80e425135f7ad8e37f83c06e1f5731fa7f4690dde00e2362b917b0f29f",
  "original_prompt": "Ingested from linux-6.6.14/fs/ocfs2/stackglue.h",
  "human_readable_source": " \n \n\n\n#ifndef STACKGLUE_H\n#define STACKGLUE_H\n\n#include <linux/types.h>\n#include <linux/list.h>\n#include <linux/dlmconstants.h>\n\n#include \"dlm/dlmapi.h\"\n#include <linux/dlm.h>\n\n \nstruct file;\nstruct file_lock;\n\n \n#define DLM_LKF_LOCAL\t\t0x00100000\n\n \n#define GROUP_NAME_MAX\t\t64\n\n \n#define CLUSTER_NAME_MAX\t16\n\n\n \nstruct ocfs2_protocol_version {\n\tu8 pv_major;\n\tu8 pv_minor;\n};\n\n \nstruct fsdlm_lksb_plus_lvb {\n\tstruct dlm_lksb lksb;\n\tchar lvb[DLM_LVB_LEN];\n};\n\n \nstruct ocfs2_cluster_connection;\nstruct ocfs2_dlm_lksb {\n\t union {\n\t\t struct dlm_lockstatus lksb_o2dlm;\n\t\t struct dlm_lksb lksb_fsdlm;\n\t\t struct fsdlm_lksb_plus_lvb padding;\n\t };\n\t struct ocfs2_cluster_connection *lksb_conn;\n};\n\n \nstruct ocfs2_locking_protocol {\n\tstruct ocfs2_protocol_version lp_max_version;\n\tvoid (*lp_lock_ast)(struct ocfs2_dlm_lksb *lksb);\n\tvoid (*lp_blocking_ast)(struct ocfs2_dlm_lksb *lksb, int level);\n\tvoid (*lp_unlock_ast)(struct ocfs2_dlm_lksb *lksb, int error);\n};\n\n\n \nstruct ocfs2_cluster_connection {\n\tchar cc_name[GROUP_NAME_MAX + 1];\n\tint cc_namelen;\n\tchar cc_cluster_name[CLUSTER_NAME_MAX + 1];\n\tint cc_cluster_name_len;\n\tstruct ocfs2_protocol_version cc_version;\n\tstruct ocfs2_locking_protocol *cc_proto;\n\tvoid (*cc_recovery_handler)(int node_num, void *recovery_data);\n\tvoid *cc_recovery_data;\n\tvoid *cc_lockspace;\n\tvoid *cc_private;\n};\n\n \nstruct ocfs2_stack_operations {\n\t \n\tint (*connect)(struct ocfs2_cluster_connection *conn);\n\n\t \n\tint (*disconnect)(struct ocfs2_cluster_connection *conn);\n\n\t \n\tint (*this_node)(struct ocfs2_cluster_connection *conn,\n\t\t\t unsigned int *node);\n\n\t \n\tint (*dlm_lock)(struct ocfs2_cluster_connection *conn,\n\t\t\tint mode,\n\t\t\tstruct ocfs2_dlm_lksb *lksb,\n\t\t\tu32 flags,\n\t\t\tvoid *name,\n\t\t\tunsigned int namelen);\n\n\t \n\tint (*dlm_unlock)(struct ocfs2_cluster_connection *conn,\n\t\t\t  struct ocfs2_dlm_lksb *lksb,\n\t\t\t  u32 flags);\n\n\t \n\tint (*lock_status)(struct ocfs2_dlm_lksb *lksb);\n\n\t \n\tint (*lvb_valid)(struct ocfs2_dlm_lksb *lksb);\n\n\t \n\tvoid *(*lock_lvb)(struct ocfs2_dlm_lksb *lksb);\n\n\t \n\tint (*plock)(struct ocfs2_cluster_connection *conn,\n\t\t     u64 ino,\n\t\t     struct file *file,\n\t\t     int cmd,\n\t\t     struct file_lock *fl);\n\n\t \n\tvoid (*dump_lksb)(struct ocfs2_dlm_lksb *lksb);\n};\n\n \nstruct ocfs2_stack_plugin {\n\tchar *sp_name;\n\tstruct ocfs2_stack_operations *sp_ops;\n\tstruct module *sp_owner;\n\n\t \n\tstruct list_head sp_list;\n\tunsigned int sp_count;\n\tstruct ocfs2_protocol_version sp_max_proto;\n};\n\n\n \nint ocfs2_cluster_connect(const char *stack_name,\n\t\t\t  const char *cluster_name,\n\t\t\t  int cluster_name_len,\n\t\t\t  const char *group,\n\t\t\t  int grouplen,\n\t\t\t  struct ocfs2_locking_protocol *lproto,\n\t\t\t  void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t   void *recovery_data),\n\t\t\t  void *recovery_data,\n\t\t\t  struct ocfs2_cluster_connection **conn);\n \nint ocfs2_cluster_connect_agnostic(const char *group,\n\t\t\t\t   int grouplen,\n\t\t\t\t   struct ocfs2_locking_protocol *lproto,\n\t\t\t\t   void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t\t    void *recovery_data),\n\t\t\t\t   void *recovery_data,\n\t\t\t\t   struct ocfs2_cluster_connection **conn);\nint ocfs2_cluster_disconnect(struct ocfs2_cluster_connection *conn,\n\t\t\t     int hangup_pending);\nvoid ocfs2_cluster_hangup(const char *group, int grouplen);\nint ocfs2_cluster_this_node(struct ocfs2_cluster_connection *conn,\n\t\t\t    unsigned int *node);\n\nstruct ocfs2_lock_res;\nint ocfs2_dlm_lock(struct ocfs2_cluster_connection *conn,\n\t\t   int mode,\n\t\t   struct ocfs2_dlm_lksb *lksb,\n\t\t   u32 flags,\n\t\t   void *name,\n\t\t   unsigned int namelen);\nint ocfs2_dlm_unlock(struct ocfs2_cluster_connection *conn,\n\t\t     struct ocfs2_dlm_lksb *lksb,\n\t\t     u32 flags);\n\nint ocfs2_dlm_lock_status(struct ocfs2_dlm_lksb *lksb);\nint ocfs2_dlm_lvb_valid(struct ocfs2_dlm_lksb *lksb);\nvoid *ocfs2_dlm_lvb(struct ocfs2_dlm_lksb *lksb);\nvoid ocfs2_dlm_dump_lksb(struct ocfs2_dlm_lksb *lksb);\n\nint ocfs2_stack_supports_plocks(void);\nint ocfs2_plock(struct ocfs2_cluster_connection *conn, u64 ino,\n\t\tstruct file *file, int cmd, struct file_lock *fl);\n\nvoid ocfs2_stack_glue_set_max_proto_version(struct ocfs2_protocol_version *max_proto);\n\n\n \nint ocfs2_stack_glue_register(struct ocfs2_stack_plugin *plugin);\nvoid ocfs2_stack_glue_unregister(struct ocfs2_stack_plugin *plugin);\n\nextern struct kset *ocfs2_kset;\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}