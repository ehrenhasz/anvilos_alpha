{
  "module_name": "ovl_entry.h",
  "hash_id": "32ad309d4e5114b3750dcb985023b6dbb75eee9724c0517d428fc25dc06aca36",
  "original_prompt": "Ingested from linux-6.6.14/fs/overlayfs/ovl_entry.h",
  "human_readable_source": " \n \n\nstruct ovl_config {\n\tchar *upperdir;\n\tchar *workdir;\n\tchar **lowerdirs;\n\tbool default_permissions;\n\tint redirect_mode;\n\tint verity_mode;\n\tbool index;\n\tint uuid;\n\tbool nfs_export;\n\tint xino;\n\tbool metacopy;\n\tbool userxattr;\n\tbool ovl_volatile;\n};\n\nstruct ovl_sb {\n\tstruct super_block *sb;\n\tdev_t pseudo_dev;\n\t \n\tbool bad_uuid;\n\t \n\tbool is_lower;\n};\n\nstruct ovl_layer {\n\t \n\tstruct vfsmount *mnt;\n\t \n\tstruct inode *trap;\n\tstruct ovl_sb *fs;\n\t \n\tint idx;\n\t \n\tint fsid;\n};\n\nstruct ovl_path {\n\tconst struct ovl_layer *layer;\n\tstruct dentry *dentry;\n};\n\nstruct ovl_entry {\n\tunsigned int __numlower;\n\tstruct ovl_path __lowerstack[];\n};\n\n \nstruct ovl_fs {\n\tunsigned int numlayer;\n\t \n\tunsigned int numfs;\n\t \n\tunsigned int numdatalayer;\n\tconst struct ovl_layer *layers;\n\tstruct ovl_sb *fs;\n\t \n\tstruct dentry *workbasedir;\n\t \n\tstruct dentry *workdir;\n\t \n\tstruct dentry *indexdir;\n\tlong namelen;\n\t \n\tstruct ovl_config config;\n\t \n\tconst struct cred *creator_cred;\n\tbool tmpfile;\n\tbool noxattr;\n\tbool nofh;\n\t \n\tbool upperdir_locked;\n\tbool workdir_locked;\n\t \n\tstruct inode *workbasedir_trap;\n\tstruct inode *workdir_trap;\n\tstruct inode *indexdir_trap;\n\t \n\tint xino_mode;\n\t \n\tatomic_long_t last_ino;\n\t \n\tstruct dentry *whiteout;\n\tbool no_shared_whiteout;\n\t \n\terrseq_t errseq;\n};\n\n \nstatic inline unsigned int ovl_numlowerlayer(struct ovl_fs *ofs)\n{\n\treturn ofs->numlayer - ofs->numdatalayer - 1;\n}\n\nstatic inline struct vfsmount *ovl_upper_mnt(struct ovl_fs *ofs)\n{\n\treturn ofs->layers[0].mnt;\n}\n\nstatic inline struct mnt_idmap *ovl_upper_mnt_idmap(struct ovl_fs *ofs)\n{\n\treturn mnt_idmap(ovl_upper_mnt(ofs));\n}\n\nextern struct file_system_type ovl_fs_type;\n\nstatic inline struct ovl_fs *OVL_FS(struct super_block *sb)\n{\n\tif (IS_ENABLED(CONFIG_OVERLAY_FS_DEBUG))\n\t\tWARN_ON_ONCE(sb->s_type != &ovl_fs_type);\n\n\treturn (struct ovl_fs *)sb->s_fs_info;\n}\n\nstatic inline bool ovl_should_sync(struct ovl_fs *ofs)\n{\n\treturn !ofs->config.ovl_volatile;\n}\n\nstatic inline unsigned int ovl_numlower(struct ovl_entry *oe)\n{\n\treturn oe ? oe->__numlower : 0;\n}\n\nstatic inline struct ovl_path *ovl_lowerstack(struct ovl_entry *oe)\n{\n\treturn ovl_numlower(oe) ? oe->__lowerstack : NULL;\n}\n\nstatic inline struct ovl_path *ovl_lowerpath(struct ovl_entry *oe)\n{\n\treturn ovl_lowerstack(oe);\n}\n\nstatic inline struct ovl_path *ovl_lowerdata(struct ovl_entry *oe)\n{\n\tstruct ovl_path *lowerstack = ovl_lowerstack(oe);\n\n\treturn lowerstack ? &lowerstack[oe->__numlower - 1] : NULL;\n}\n\n \nstatic inline struct dentry *ovl_lowerdata_dentry(struct ovl_entry *oe)\n{\n\tstruct ovl_path *lowerdata = ovl_lowerdata(oe);\n\n\treturn lowerdata ? READ_ONCE(lowerdata->dentry) : NULL;\n}\n\n \nstatic inline unsigned long *OVL_E_FLAGS(struct dentry *dentry)\n{\n\treturn (unsigned long *) &dentry->d_fsdata;\n}\n\nstruct ovl_inode {\n\tunion {\n\t\tstruct ovl_dir_cache *cache;\t \n\t\tconst char *lowerdata_redirect;\t \n\t};\n\tconst char *redirect;\n\tu64 version;\n\tunsigned long flags;\n\tstruct inode vfs_inode;\n\tstruct dentry *__upperdentry;\n\tstruct ovl_entry *oe;\n\n\t \n\tstruct mutex lock;\n};\n\nstatic inline struct ovl_inode *OVL_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ovl_inode, vfs_inode);\n}\n\nstatic inline struct ovl_entry *OVL_I_E(struct inode *inode)\n{\n\treturn inode ? OVL_I(inode)->oe : NULL;\n}\n\nstatic inline struct ovl_entry *OVL_E(struct dentry *dentry)\n{\n\treturn OVL_I_E(d_inode(dentry));\n}\n\nstatic inline struct dentry *ovl_upperdentry_dereference(struct ovl_inode *oi)\n{\n\treturn READ_ONCE(oi->__upperdentry);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}