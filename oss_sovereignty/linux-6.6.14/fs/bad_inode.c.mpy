{
  "module_name": "bad_inode.c",
  "hash_id": "f53fae16760b9a4fa54e87a584485dd85a6997dfc711a621a824af46a63fbff3",
  "original_prompt": "Ingested from linux-6.6.14/fs/bad_inode.c",
  "human_readable_source": "\n \n\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/stat.h>\n#include <linux/time.h>\n#include <linux/namei.h>\n#include <linux/poll.h>\n#include <linux/fiemap.h>\n\nstatic int bad_file_open(struct inode *inode, struct file *filp)\n{\n\treturn -EIO;\n}\n\nstatic const struct file_operations bad_file_ops =\n{\n\t.open\t\t= bad_file_open,\n};\n\nstatic int bad_inode_create(struct mnt_idmap *idmap,\n\t\t\t    struct inode *dir, struct dentry *dentry,\n\t\t\t    umode_t mode, bool excl)\n{\n\treturn -EIO;\n}\n\nstatic struct dentry *bad_inode_lookup(struct inode *dir,\n\t\t\tstruct dentry *dentry, unsigned int flags)\n{\n\treturn ERR_PTR(-EIO);\n}\n\nstatic int bad_inode_link (struct dentry *old_dentry, struct inode *dir,\n\t\tstruct dentry *dentry)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_unlink(struct inode *dir, struct dentry *dentry)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_symlink(struct mnt_idmap *idmap,\n\t\t\t     struct inode *dir, struct dentry *dentry,\n\t\t\t     const char *symname)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_mkdir(struct mnt_idmap *idmap, struct inode *dir,\n\t\t\t   struct dentry *dentry, umode_t mode)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_rmdir (struct inode *dir, struct dentry *dentry)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_mknod(struct mnt_idmap *idmap, struct inode *dir,\n\t\t\t   struct dentry *dentry, umode_t mode, dev_t rdev)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_rename2(struct mnt_idmap *idmap,\n\t\t\t     struct inode *old_dir, struct dentry *old_dentry,\n\t\t\t     struct inode *new_dir, struct dentry *new_dentry,\n\t\t\t     unsigned int flags)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_readlink(struct dentry *dentry, char __user *buffer,\n\t\tint buflen)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_permission(struct mnt_idmap *idmap,\n\t\t\t\tstruct inode *inode, int mask)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_getattr(struct mnt_idmap *idmap,\n\t\t\t     const struct path *path, struct kstat *stat,\n\t\t\t     u32 request_mask, unsigned int query_flags)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_setattr(struct mnt_idmap *idmap,\n\t\t\t     struct dentry *direntry, struct iattr *attrs)\n{\n\treturn -EIO;\n}\n\nstatic ssize_t bad_inode_listxattr(struct dentry *dentry, char *buffer,\n\t\t\tsize_t buffer_size)\n{\n\treturn -EIO;\n}\n\nstatic const char *bad_inode_get_link(struct dentry *dentry,\n\t\t\t\t      struct inode *inode,\n\t\t\t\t      struct delayed_call *done)\n{\n\treturn ERR_PTR(-EIO);\n}\n\nstatic struct posix_acl *bad_inode_get_acl(struct inode *inode, int type, bool rcu)\n{\n\treturn ERR_PTR(-EIO);\n}\n\nstatic int bad_inode_fiemap(struct inode *inode,\n\t\t\t    struct fiemap_extent_info *fieinfo, u64 start,\n\t\t\t    u64 len)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_update_time(struct inode *inode, int flags)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_atomic_open(struct inode *inode, struct dentry *dentry,\n\t\t\t\t struct file *file, unsigned int open_flag,\n\t\t\t\t umode_t create_mode)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_tmpfile(struct mnt_idmap *idmap,\n\t\t\t     struct inode *inode, struct file *file,\n\t\t\t     umode_t mode)\n{\n\treturn -EIO;\n}\n\nstatic int bad_inode_set_acl(struct mnt_idmap *idmap,\n\t\t\t     struct dentry *dentry, struct posix_acl *acl,\n\t\t\t     int type)\n{\n\treturn -EIO;\n}\n\nstatic const struct inode_operations bad_inode_ops =\n{\n\t.create\t\t= bad_inode_create,\n\t.lookup\t\t= bad_inode_lookup,\n\t.link\t\t= bad_inode_link,\n\t.unlink\t\t= bad_inode_unlink,\n\t.symlink\t= bad_inode_symlink,\n\t.mkdir\t\t= bad_inode_mkdir,\n\t.rmdir\t\t= bad_inode_rmdir,\n\t.mknod\t\t= bad_inode_mknod,\n\t.rename\t\t= bad_inode_rename2,\n\t.readlink\t= bad_inode_readlink,\n\t.permission\t= bad_inode_permission,\n\t.getattr\t= bad_inode_getattr,\n\t.setattr\t= bad_inode_setattr,\n\t.listxattr\t= bad_inode_listxattr,\n\t.get_link\t= bad_inode_get_link,\n\t.get_inode_acl\t= bad_inode_get_acl,\n\t.fiemap\t\t= bad_inode_fiemap,\n\t.update_time\t= bad_inode_update_time,\n\t.atomic_open\t= bad_inode_atomic_open,\n\t.tmpfile\t= bad_inode_tmpfile,\n\t.set_acl\t= bad_inode_set_acl,\n};\n\n\n \n \n \n \nvoid make_bad_inode(struct inode *inode)\n{\n\tremove_inode_hash(inode);\n\n\tinode->i_mode = S_IFREG;\n\tinode->i_atime = inode->i_mtime = inode_set_ctime_current(inode);\n\tinode->i_op = &bad_inode_ops;\t\n\tinode->i_opflags &= ~IOP_XATTR;\n\tinode->i_fop = &bad_file_ops;\t\n}\nEXPORT_SYMBOL(make_bad_inode);\n\n \n \n \n \nbool is_bad_inode(struct inode *inode)\n{\n\treturn (inode->i_op == &bad_inode_ops);\t\n}\n\nEXPORT_SYMBOL(is_bad_inode);\n\n \nvoid iget_failed(struct inode *inode)\n{\n\tmake_bad_inode(inode);\n\tunlock_new_inode(inode);\n\tiput(inode);\n}\nEXPORT_SYMBOL(iget_failed);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}