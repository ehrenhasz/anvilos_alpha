{
  "module_name": "fsverity_private.h",
  "hash_id": "77ea6ca3abe4b59dcb64ddc72dbbc6fdc8e3968bf2e3a05e83860c03a86393e5",
  "original_prompt": "Ingested from linux-6.6.14/fs/verity/fsverity_private.h",
  "human_readable_source": " \n \n\n#ifndef _FSVERITY_PRIVATE_H\n#define _FSVERITY_PRIVATE_H\n\n#define pr_fmt(fmt) \"fs-verity: \" fmt\n\n#include <linux/fsverity.h>\n\n \n#define FS_VERITY_MAX_LEVELS\t\t8\n\n \nstruct fsverity_hash_alg {\n\tstruct crypto_shash *tfm;  \n\tconst char *name;\t   \n\tunsigned int digest_size;  \n\tunsigned int block_size;   \n\t \n\tenum hash_algo algo_id;\n};\n\n \nstruct merkle_tree_params {\n\tconst struct fsverity_hash_alg *hash_alg;  \n\tconst u8 *hashstate;\t\t \n\tunsigned int digest_size;\t \n\tunsigned int block_size;\t \n\tunsigned int hashes_per_block;\t \n\tunsigned int blocks_per_page;\t \n\tu8 log_digestsize;\t\t \n\tu8 log_blocksize;\t\t \n\tu8 log_arity;\t\t\t \n\tu8 log_blocks_per_page;\t\t \n\tunsigned int num_levels;\t \n\tu64 tree_size;\t\t\t \n\tunsigned long tree_pages;\t \n\n\t \n\tunsigned long level_start[FS_VERITY_MAX_LEVELS];\n};\n\n \nstruct fsverity_info {\n\tstruct merkle_tree_params tree_params;\n\tu8 root_hash[FS_VERITY_MAX_DIGEST_SIZE];\n\tu8 file_digest[FS_VERITY_MAX_DIGEST_SIZE];\n\tconst struct inode *inode;\n\tunsigned long *hash_block_verified;\n\tspinlock_t hash_page_init_lock;\n};\n\n#define FS_VERITY_MAX_SIGNATURE_SIZE\t(FS_VERITY_MAX_DESCRIPTOR_SIZE - \\\n\t\t\t\t\t sizeof(struct fsverity_descriptor))\n\n \n\nextern struct fsverity_hash_alg fsverity_hash_algs[];\n\nconst struct fsverity_hash_alg *fsverity_get_hash_alg(const struct inode *inode,\n\t\t\t\t\t\t      unsigned int num);\nconst u8 *fsverity_prepare_hash_state(const struct fsverity_hash_alg *alg,\n\t\t\t\t      const u8 *salt, size_t salt_size);\nint fsverity_hash_block(const struct merkle_tree_params *params,\n\t\t\tconst struct inode *inode, const void *data, u8 *out);\nint fsverity_hash_buffer(const struct fsverity_hash_alg *alg,\n\t\t\t const void *data, size_t size, u8 *out);\nvoid __init fsverity_check_hash_algs(void);\n\n \n\nvoid __printf(3, 4) __cold\nfsverity_msg(const struct inode *inode, const char *level,\n\t     const char *fmt, ...);\n\n#define fsverity_warn(inode, fmt, ...)\t\t\\\n\tfsverity_msg((inode), KERN_WARNING, fmt, ##__VA_ARGS__)\n#define fsverity_err(inode, fmt, ...)\t\t\\\n\tfsverity_msg((inode), KERN_ERR, fmt, ##__VA_ARGS__)\n\n \n\nint fsverity_init_merkle_tree_params(struct merkle_tree_params *params,\n\t\t\t\t     const struct inode *inode,\n\t\t\t\t     unsigned int hash_algorithm,\n\t\t\t\t     unsigned int log_blocksize,\n\t\t\t\t     const u8 *salt, size_t salt_size);\n\nstruct fsverity_info *fsverity_create_info(const struct inode *inode,\n\t\t\t\t\t   struct fsverity_descriptor *desc);\n\nvoid fsverity_set_info(struct inode *inode, struct fsverity_info *vi);\n\nvoid fsverity_free_info(struct fsverity_info *vi);\n\nint fsverity_get_descriptor(struct inode *inode,\n\t\t\t    struct fsverity_descriptor **desc_ret);\n\nvoid __init fsverity_init_info_cache(void);\n\n \n\n#ifdef CONFIG_FS_VERITY_BUILTIN_SIGNATURES\nextern int fsverity_require_signatures;\nint fsverity_verify_signature(const struct fsverity_info *vi,\n\t\t\t      const u8 *signature, size_t sig_size);\n\nvoid __init fsverity_init_signature(void);\n#else  \nstatic inline int\nfsverity_verify_signature(const struct fsverity_info *vi,\n\t\t\t  const u8 *signature, size_t sig_size)\n{\n\treturn 0;\n}\n\nstatic inline void fsverity_init_signature(void)\n{\n}\n#endif  \n\n \n\nvoid __init fsverity_init_workqueue(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}