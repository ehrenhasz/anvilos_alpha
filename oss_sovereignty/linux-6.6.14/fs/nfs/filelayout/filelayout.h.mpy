{
  "module_name": "filelayout.h",
  "hash_id": "f01adfafea1e1d4de3466dbdb6615c0f6b67322f3dcad9508a24d2076a66ce8e",
  "original_prompt": "Ingested from linux-6.6.14/fs/nfs/filelayout/filelayout.h",
  "human_readable_source": " \n\n#ifndef FS_NFS_NFS4FILELAYOUT_H\n#define FS_NFS_NFS4FILELAYOUT_H\n\n#include \"../pnfs.h\"\n\n \n#define NFS4_PNFS_MAX_STRIPE_CNT 4096\n#define NFS4_PNFS_MAX_MULTI_CNT  256  \n\nenum stripetype4 {\n\tSTRIPE_SPARSE = 1,\n\tSTRIPE_DENSE = 2\n};\n\nstruct nfs4_file_layout_dsaddr {\n\tstruct nfs4_deviceid_node\tid_node;\n\tu32\t\t\t\tstripe_count;\n\tu8\t\t\t\t*stripe_indices;\n\tu32\t\t\t\tds_num;\n\tstruct nfs4_pnfs_ds\t\t*ds_list[];\n};\n\nstruct nfs4_filelayout_segment {\n\tstruct pnfs_layout_segment\tgeneric_hdr;\n\tu32\t\t\t\tstripe_type;\n\tu32\t\t\t\tcommit_through_mds;\n\tu32\t\t\t\tstripe_unit;\n\tu32\t\t\t\tfirst_stripe_index;\n\tu64\t\t\t\tpattern_offset;\n\tstruct nfs4_deviceid\t\tdeviceid;\n\tstruct nfs4_file_layout_dsaddr\t*dsaddr;  \n\tunsigned int\t\t\tnum_fh;\n\tstruct nfs_fh\t\t\t**fh_array;\n};\n\nstruct nfs4_filelayout {\n\tstruct pnfs_layout_hdr generic_hdr;\n\tstruct pnfs_ds_commit_info commit_info;\n};\n\nstatic inline struct nfs4_filelayout *\nFILELAYOUT_FROM_HDR(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct nfs4_filelayout, generic_hdr);\n}\n\nstatic inline struct nfs4_filelayout_segment *\nFILELAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_filelayout_segment,\n\t\t\t    generic_hdr);\n}\n\nstatic inline struct nfs4_deviceid_node *\nFILELAYOUT_DEVID_NODE(struct pnfs_layout_segment *lseg)\n{\n\treturn &FILELAYOUT_LSEG(lseg)->dsaddr->id_node;\n}\n\nstatic inline bool\nfilelayout_test_devid_invalid(struct nfs4_deviceid_node *node)\n{\n\treturn test_bit(NFS_DEVICEID_INVALID, &node->flags);\n}\n\nextern bool\nfilelayout_test_devid_unavailable(struct nfs4_deviceid_node *node);\n\nextern struct nfs_fh *\nnfs4_fl_select_ds_fh(struct pnfs_layout_segment *lseg, u32 j);\n\nu32 nfs4_fl_calc_j_index(struct pnfs_layout_segment *lseg, loff_t offset);\nu32 nfs4_fl_calc_ds_index(struct pnfs_layout_segment *lseg, u32 j);\nstruct nfs4_pnfs_ds *nfs4_fl_prepare_ds(struct pnfs_layout_segment *lseg,\n\t\t\t\t\tu32 ds_idx);\n\nextern struct nfs4_file_layout_dsaddr *\nnfs4_fl_alloc_deviceid_node(struct nfs_server *server,\n\tstruct pnfs_device *pdev, gfp_t gfp_flags);\nextern void nfs4_fl_put_deviceid(struct nfs4_file_layout_dsaddr *dsaddr);\nextern void nfs4_fl_free_deviceid(struct nfs4_file_layout_dsaddr *dsaddr);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}