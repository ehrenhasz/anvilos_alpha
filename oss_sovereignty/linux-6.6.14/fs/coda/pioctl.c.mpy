{
  "module_name": "pioctl.c",
  "hash_id": "3c809d1afd4a82ce656a189caba4f260ff606e58aa2e50cbdcf72522adfbcc44",
  "original_prompt": "Ingested from linux-6.6.14/fs/coda/pioctl.c",
  "human_readable_source": "\n \n\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/fs.h>\n#include <linux/stat.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n\n#include <linux/coda.h>\n#include \"coda_psdev.h\"\n#include \"coda_linux.h\"\n\n \nstatic int coda_ioctl_permission(struct mnt_idmap *idmap,\n\t\t\t\t struct inode *inode, int mask);\nstatic long coda_pioctl(struct file *filp, unsigned int cmd,\n\t\t\tunsigned long user_data);\n\n \nconst struct inode_operations coda_ioctl_inode_operations = {\n\t.permission\t= coda_ioctl_permission,\n\t.setattr\t= coda_setattr,\n};\n\nconst struct file_operations coda_ioctl_operations = {\n\t.unlocked_ioctl\t= coda_pioctl,\n\t.llseek\t\t= noop_llseek,\n};\n\n \nstatic int coda_ioctl_permission(struct mnt_idmap *idmap,\n\t\t\t\t struct inode *inode, int mask)\n{\n\treturn (mask & MAY_EXEC) ? -EACCES : 0;\n}\n\nstatic long coda_pioctl(struct file *filp, unsigned int cmd,\n\t\t\tunsigned long user_data)\n{\n\tstruct path path;\n\tint error;\n\tstruct PioctlData data;\n\tstruct inode *inode = file_inode(filp);\n\tstruct inode *target_inode = NULL;\n\tstruct coda_inode_info *cnp;\n\n\t \n\tif (copy_from_user(&data, (void __user *)user_data, sizeof(data)))\n\t\treturn -EINVAL;\n\n\t \n\terror = user_path_at(AT_FDCWD, data.path,\n\t\t\t     data.follow ? LOOKUP_FOLLOW : 0, &path);\n\tif (error)\n\t\treturn error;\n\n\ttarget_inode = d_inode(path.dentry);\n\n\t \n\tif (target_inode->i_sb != inode->i_sb) {\n\t\terror = -EINVAL;\n\t\tgoto out;\n\t}\n\n\t \n\tcnp = ITOC(target_inode);\n\n\terror = venus_pioctl(inode->i_sb, &(cnp->c_fid), cmd, &data);\nout:\n\tpath_put(&path);\n\treturn error;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}