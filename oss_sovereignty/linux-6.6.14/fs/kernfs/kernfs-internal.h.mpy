{
  "module_name": "kernfs-internal.h",
  "hash_id": "61d2dede48f4e76bd20d368690acdf0820ced56b83cb1b40239cfc0e5a9806a2",
  "original_prompt": "Ingested from linux-6.6.14/fs/kernfs/kernfs-internal.h",
  "human_readable_source": " \n \n\n#ifndef __KERNFS_INTERNAL_H\n#define __KERNFS_INTERNAL_H\n\n#include <linux/lockdep.h>\n#include <linux/fs.h>\n#include <linux/mutex.h>\n#include <linux/rwsem.h>\n#include <linux/xattr.h>\n\n#include <linux/kernfs.h>\n#include <linux/fs_context.h>\n\nstruct kernfs_iattrs {\n\tkuid_t\t\t\tia_uid;\n\tkgid_t\t\t\tia_gid;\n\tstruct timespec64\tia_atime;\n\tstruct timespec64\tia_mtime;\n\tstruct timespec64\tia_ctime;\n\n\tstruct simple_xattrs\txattrs;\n\tatomic_t\t\tnr_user_xattrs;\n\tatomic_t\t\tuser_xattr_size;\n};\n\nstruct kernfs_root {\n\t \n\tstruct kernfs_node\t*kn;\n\tunsigned int\t\tflags;\t \n\n\t \n\tstruct idr\t\tino_idr;\n\tu32\t\t\tlast_id_lowbits;\n\tu32\t\t\tid_highbits;\n\tstruct kernfs_syscall_ops *syscall_ops;\n\n\t \n\tstruct list_head\tsupers;\n\n\twait_queue_head_t\tdeactivate_waitq;\n\tstruct rw_semaphore\tkernfs_rwsem;\n\tstruct rw_semaphore\tkernfs_iattr_rwsem;\n\tstruct rw_semaphore\tkernfs_supers_rwsem;\n};\n\n \n#define KN_DEACTIVATED_BIAS\t\t(INT_MIN + 1)\n\n \n\n \nstatic inline struct kernfs_root *kernfs_root(struct kernfs_node *kn)\n{\n\t \n\tif (kn->parent)\n\t\tkn = kn->parent;\n\treturn kn->dir.root;\n}\n\n \nstruct kernfs_super_info {\n\tstruct super_block\t*sb;\n\n\t \n\tstruct kernfs_root\t*root;\n\n\t \n\tconst void\t\t*ns;\n\n\t \n\tstruct list_head\tnode;\n};\n#define kernfs_info(SB) ((struct kernfs_super_info *)(SB->s_fs_info))\n\nstatic inline struct kernfs_node *kernfs_dentry_node(struct dentry *dentry)\n{\n\tif (d_really_is_negative(dentry))\n\t\treturn NULL;\n\treturn d_inode(dentry)->i_private;\n}\n\nstatic inline void kernfs_set_rev(struct kernfs_node *parent,\n\t\t\t\t  struct dentry *dentry)\n{\n\tdentry->d_time = parent->dir.rev;\n}\n\nstatic inline void kernfs_inc_rev(struct kernfs_node *parent)\n{\n\tparent->dir.rev++;\n}\n\nstatic inline bool kernfs_dir_changed(struct kernfs_node *parent,\n\t\t\t\t      struct dentry *dentry)\n{\n\tif (parent->dir.rev != dentry->d_time)\n\t\treturn true;\n\treturn false;\n}\n\nextern const struct super_operations kernfs_sops;\nextern struct kmem_cache *kernfs_node_cache, *kernfs_iattrs_cache;\n\n \nextern const struct xattr_handler *kernfs_xattr_handlers[];\nvoid kernfs_evict_inode(struct inode *inode);\nint kernfs_iop_permission(struct mnt_idmap *idmap,\n\t\t\t  struct inode *inode, int mask);\nint kernfs_iop_setattr(struct mnt_idmap *idmap, struct dentry *dentry,\n\t\t       struct iattr *iattr);\nint kernfs_iop_getattr(struct mnt_idmap *idmap,\n\t\t       const struct path *path, struct kstat *stat,\n\t\t       u32 request_mask, unsigned int query_flags);\nssize_t kernfs_iop_listxattr(struct dentry *dentry, char *buf, size_t size);\nint __kernfs_setattr(struct kernfs_node *kn, const struct iattr *iattr);\n\n \nextern const struct dentry_operations kernfs_dops;\nextern const struct file_operations kernfs_dir_fops;\nextern const struct inode_operations kernfs_dir_iops;\n\nstruct kernfs_node *kernfs_get_active(struct kernfs_node *kn);\nvoid kernfs_put_active(struct kernfs_node *kn);\nint kernfs_add_one(struct kernfs_node *kn);\nstruct kernfs_node *kernfs_new_node(struct kernfs_node *parent,\n\t\t\t\t    const char *name, umode_t mode,\n\t\t\t\t    kuid_t uid, kgid_t gid,\n\t\t\t\t    unsigned flags);\n\n \nextern const struct file_operations kernfs_file_fops;\n\nbool kernfs_should_drain_open_files(struct kernfs_node *kn);\nvoid kernfs_drain_open_files(struct kernfs_node *kn);\n\n \nextern const struct inode_operations kernfs_symlink_iops;\n\n \nextern struct kernfs_global_locks *kernfs_locks;\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}