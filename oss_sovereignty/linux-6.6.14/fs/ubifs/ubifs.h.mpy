{
  "module_name": "ubifs.h",
  "hash_id": "0d71eec3cd33eb0d737993189df6fd500dfd452539b2013fc8e71f5849e26cb1",
  "original_prompt": "Ingested from linux-6.6.14/fs/ubifs/ubifs.h",
  "human_readable_source": " \n \n\n#ifndef __UBIFS_H__\n#define __UBIFS_H__\n\n#include <asm/div64.h>\n#include <linux/statfs.h>\n#include <linux/fs.h>\n#include <linux/err.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/mutex.h>\n#include <linux/rwsem.h>\n#include <linux/mtd/ubi.h>\n#include <linux/pagemap.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/xattr.h>\n#include <linux/random.h>\n#include <linux/sysfs.h>\n#include <linux/completion.h>\n#include <crypto/hash_info.h>\n#include <crypto/hash.h>\n#include <crypto/algapi.h>\n\n#include <linux/fscrypt.h>\n\n#include \"ubifs-media.h\"\n\n \n#define UBIFS_VERSION 1\n\n \n#define UBIFS_SUPER_MAGIC 0x24051905\n\n \n#define UBIFS_BLOCKS_PER_PAGE (PAGE_SIZE / UBIFS_BLOCK_SIZE)\n#define UBIFS_BLOCKS_PER_PAGE_SHIFT (PAGE_SHIFT - UBIFS_BLOCK_SHIFT)\n\n \n#define SQNUM_WARN_WATERMARK 0xFFFFFFFF00000000ULL\n#define SQNUM_WATERMARK      0xFFFFFFFFFF000000ULL\n\n \n#define MIN_INDEX_LEBS 2\n\n \n#define MIN_WRITE_SZ (UBIFS_DATA_NODE_SZ + 8)\n\n \n#define INUM_WARN_WATERMARK 0xFFF00000\n#define INUM_WATERMARK      0xFFFFFF00\n\n \n#define LPT_HEAP_SZ 256\n\n \n#define BGT_NAME_PATTERN \"ubifs_bgt%d_%d\"\n\n \n#define MAX_INUM 0xFFFFFFFF\n\n \n#define NONDATA_JHEADS_CNT 2\n\n \n#define GCHD   UBIFS_GC_HEAD\n#define BASEHD UBIFS_BASE_HEAD\n#define DATAHD UBIFS_DATA_HEAD\n\n \n#define LPROPS_NC 0x80000001\n\n \n#define UBIFS_TRUN_KEY    UBIFS_KEY_TYPES_CNT\n#define UBIFS_INVALID_KEY UBIFS_KEY_TYPES_CNT\n\n \n#define CALC_DENT_SIZE(name_len) ALIGN(UBIFS_DENT_NODE_SZ + (name_len) + 1, 8)\n\n \n#define CALC_XATTR_BYTES(data_len) ALIGN(UBIFS_INO_NODE_SZ + (data_len) + 1, 8)\n\n \n#define OLD_ZNODE_AGE 20\n#define YOUNG_ZNODE_AGE 5\n\n \n#define WORST_COMPR_FACTOR 2\n\n#ifdef CONFIG_FS_ENCRYPTION\n#define UBIFS_CIPHER_BLOCK_SIZE FSCRYPT_CONTENTS_ALIGNMENT\n#else\n#define UBIFS_CIPHER_BLOCK_SIZE 0\n#endif\n\n \n#define COMPRESSED_DATA_NODE_BUF_SZ \\\n\t(UBIFS_DATA_NODE_SZ + UBIFS_BLOCK_SIZE * WORST_COMPR_FACTOR)\n\n \n#define BOTTOM_UP_HEIGHT 64\n\n \n#define UBIFS_MAX_BULK_READ 32\n\n#ifdef CONFIG_UBIFS_FS_AUTHENTICATION\n#define UBIFS_HASH_ARR_SZ UBIFS_MAX_HASH_LEN\n#define UBIFS_HMAC_ARR_SZ UBIFS_MAX_HMAC_LEN\n#else\n#define UBIFS_HASH_ARR_SZ 0\n#define UBIFS_HMAC_ARR_SZ 0\n#endif\n\n \n#define UBIFS_DFS_DIR_NAME \"ubi%d_%d\"\n#define UBIFS_DFS_DIR_LEN  (3 + 1 + 2*2 + 1)\n\n \nenum {\n\tWB_MUTEX_1 = 0,\n\tWB_MUTEX_2 = 1,\n\tWB_MUTEX_3 = 2,\n\tWB_MUTEX_4 = 3,\n};\n\n \nenum {\n\tDIRTY_ZNODE    = 0,\n\tCOW_ZNODE      = 1,\n\tOBSOLETE_ZNODE = 2,\n};\n\n \nenum {\n\tCOMMIT_RESTING = 0,\n\tCOMMIT_BACKGROUND,\n\tCOMMIT_REQUIRED,\n\tCOMMIT_RUNNING_BACKGROUND,\n\tCOMMIT_RUNNING_REQUIRED,\n\tCOMMIT_BROKEN,\n};\n\n \nenum {\n\tSCANNED_GARBAGE        = 0,\n\tSCANNED_EMPTY_SPACE    = -1,\n\tSCANNED_A_NODE         = -2,\n\tSCANNED_A_CORRUPT_NODE = -3,\n\tSCANNED_A_BAD_PAD_NODE = -4,\n};\n\n \nenum {\n\tDIRTY_CNODE    = 0,\n\tOBSOLETE_CNODE = 1,\n\tCOW_CNODE      = 2,\n};\n\n \nenum {\n\tLTAB_DIRTY  = 1,\n\tLSAVE_DIRTY = 2,\n};\n\n \nenum {\n\tLEB_FREED,\n\tLEB_FREED_IDX,\n\tLEB_RETAINED,\n};\n\n \nenum {\n\tASSACT_REPORT = 0,\n\tASSACT_RO,\n\tASSACT_PANIC,\n};\n\n \nstruct ubifs_old_idx {\n\tstruct rb_node rb;\n\tint lnum;\n\tint offs;\n};\n\n \nunion ubifs_key {\n\tuint8_t u8[UBIFS_SK_LEN];\n\tuint32_t u32[UBIFS_SK_LEN/4];\n\tuint64_t u64[UBIFS_SK_LEN/8];\n\t__le32 j32[UBIFS_SK_LEN/4];\n};\n\n \nstruct ubifs_scan_node {\n\tstruct list_head list;\n\tunion ubifs_key key;\n\tunsigned long long sqnum;\n\tint type;\n\tint offs;\n\tint len;\n\tvoid *node;\n};\n\n \nstruct ubifs_scan_leb {\n\tint lnum;\n\tint nodes_cnt;\n\tstruct list_head nodes;\n\tint endpt;\n\tvoid *buf;\n};\n\n \nstruct ubifs_gced_idx_leb {\n\tstruct list_head list;\n\tint lnum;\n\tint unmap;\n};\n\n \nstruct ubifs_inode {\n\tstruct inode vfs_inode;\n\tunsigned long long creat_sqnum;\n\tunsigned long long del_cmtno;\n\tunsigned int xattr_size;\n\tunsigned int xattr_cnt;\n\tunsigned int xattr_names;\n\tunsigned int dirty:1;\n\tunsigned int xattr:1;\n\tunsigned int bulk_read:1;\n\tunsigned int compr_type:2;\n\tstruct mutex ui_mutex;\n\tstruct rw_semaphore xattr_sem;\n\tspinlock_t ui_lock;\n\tloff_t synced_i_size;\n\tloff_t ui_size;\n\tint flags;\n\tpgoff_t last_page_read;\n\tpgoff_t read_in_a_row;\n\tint data_len;\n\tvoid *data;\n};\n\n \nstruct ubifs_unclean_leb {\n\tstruct list_head list;\n\tint lnum;\n\tint endpt;\n};\n\n \nenum {\n\tLPROPS_UNCAT     =  0,\n\tLPROPS_DIRTY     =  1,\n\tLPROPS_DIRTY_IDX =  2,\n\tLPROPS_FREE      =  3,\n\tLPROPS_HEAP_CNT  =  3,\n\tLPROPS_EMPTY     =  4,\n\tLPROPS_FREEABLE  =  5,\n\tLPROPS_FRDI_IDX  =  6,\n\tLPROPS_CAT_MASK  = 15,\n\tLPROPS_TAKEN     = 16,\n\tLPROPS_INDEX     = 32,\n};\n\n \nstruct ubifs_lprops {\n\tint free;\n\tint dirty;\n\tint flags;\n\tint lnum;\n\tunion {\n\t\tstruct list_head list;\n\t\tint hpos;\n\t};\n};\n\n \nstruct ubifs_lpt_lprops {\n\tint free;\n\tint dirty;\n\tunsigned tgc:1;\n\tunsigned cmt:1;\n};\n\n \nstruct ubifs_lp_stats {\n\tint empty_lebs;\n\tint taken_empty_lebs;\n\tint idx_lebs;\n\tlong long total_free;\n\tlong long total_dirty;\n\tlong long total_used;\n\tlong long total_dead;\n\tlong long total_dark;\n};\n\nstruct ubifs_nnode;\n\n \nstruct ubifs_cnode {\n\tstruct ubifs_nnode *parent;\n\tstruct ubifs_cnode *cnext;\n\tunsigned long flags;\n\tint iip;\n\tint level;\n\tint num;\n};\n\n \nstruct ubifs_pnode {\n\tstruct ubifs_nnode *parent;\n\tstruct ubifs_cnode *cnext;\n\tunsigned long flags;\n\tint iip;\n\tint level;\n\tint num;\n\tstruct ubifs_lprops lprops[UBIFS_LPT_FANOUT];\n};\n\n \nstruct ubifs_nbranch {\n\tint lnum;\n\tint offs;\n\tunion {\n\t\tstruct ubifs_nnode *nnode;\n\t\tstruct ubifs_pnode *pnode;\n\t\tstruct ubifs_cnode *cnode;\n\t};\n};\n\n \nstruct ubifs_nnode {\n\tstruct ubifs_nnode *parent;\n\tstruct ubifs_cnode *cnext;\n\tunsigned long flags;\n\tint iip;\n\tint level;\n\tint num;\n\tstruct ubifs_nbranch nbranch[UBIFS_LPT_FANOUT];\n};\n\n \nstruct ubifs_lpt_heap {\n\tstruct ubifs_lprops **arr;\n\tint cnt;\n\tint max_cnt;\n};\n\n \nenum {\n\tLPT_SCAN_CONTINUE = 0,\n\tLPT_SCAN_ADD = 1,\n\tLPT_SCAN_STOP = 2,\n};\n\nstruct ubifs_info;\n\n \ntypedef int (*ubifs_lpt_scan_callback)(struct ubifs_info *c,\n\t\t\t\t       const struct ubifs_lprops *lprops,\n\t\t\t\t       int in_tree, void *data);\n\n \nstruct ubifs_wbuf {\n\tstruct ubifs_info *c;\n\tvoid *buf;\n\tint lnum;\n\tint offs;\n\tint avail;\n\tint used;\n\tint size;\n\tint jhead;\n\tint (*sync_callback)(struct ubifs_info *c, int lnum, int free, int pad);\n\tstruct mutex io_mutex;\n\tspinlock_t lock;\n\tstruct hrtimer timer;\n\tunsigned int no_timer:1;\n\tunsigned int need_sync:1;\n\tint next_ino;\n\tino_t *inodes;\n};\n\n \nstruct ubifs_bud {\n\tint lnum;\n\tint start;\n\tint jhead;\n\tstruct list_head list;\n\tstruct rb_node rb;\n\tstruct shash_desc *log_hash;\n};\n\n \nstruct ubifs_jhead {\n\tstruct ubifs_wbuf wbuf;\n\tstruct list_head buds_list;\n\tunsigned int grouped:1;\n\tstruct shash_desc *log_hash;\n};\n\n \nstruct ubifs_zbranch {\n\tunion ubifs_key key;\n\tunion {\n\t\tstruct ubifs_znode *znode;\n\t\tvoid *leaf;\n\t};\n\tint lnum;\n\tint offs;\n\tint len;\n\tu8 hash[UBIFS_HASH_ARR_SZ];\n};\n\n \nstruct ubifs_znode {\n\tstruct ubifs_znode *parent;\n\tstruct ubifs_znode *cnext;\n\tstruct ubifs_znode *cparent;\n\tint ciip;\n\tunsigned long flags;\n\ttime64_t time;\n\tint level;\n\tint child_cnt;\n\tint iip;\n\tint alt;\n\tint lnum;\n\tint offs;\n\tint len;\n\tstruct ubifs_zbranch zbranch[];\n};\n\n \nstruct bu_info {\n\tunion ubifs_key key;\n\tstruct ubifs_zbranch zbranch[UBIFS_MAX_BULK_READ];\n\tvoid *buf;\n\tint buf_len;\n\tint gc_seq;\n\tint cnt;\n\tint blk_cnt;\n\tint eof;\n};\n\n \nstruct ubifs_node_range {\n\tunion {\n\t\tint len;\n\t\tint min_len;\n\t};\n\tint max_len;\n};\n\n \nstruct ubifs_compressor {\n\tint compr_type;\n\tstruct crypto_comp *cc;\n\tstruct mutex *comp_mutex;\n\tstruct mutex *decomp_mutex;\n\tconst char *name;\n\tconst char *capi_name;\n};\n\n \nstruct ubifs_budget_req {\n\tunsigned int fast:1;\n\tunsigned int recalculate:1;\n#ifndef UBIFS_DEBUG\n\tunsigned int new_page:1;\n\tunsigned int dirtied_page:1;\n\tunsigned int new_dent:1;\n\tunsigned int mod_dent:1;\n\tunsigned int new_ino:1;\n\tunsigned int new_ino_d:13;\n\tunsigned int dirtied_ino:4;\n\tunsigned int dirtied_ino_d:15;\n#else\n\t \n\tunsigned int new_page;\n\tunsigned int dirtied_page;\n\tunsigned int new_dent;\n\tunsigned int mod_dent;\n\tunsigned int new_ino;\n\tunsigned int new_ino_d;\n\tunsigned int dirtied_ino;\n\tunsigned int dirtied_ino_d;\n#endif\n\tint idx_growth;\n\tint data_growth;\n\tint dd_growth;\n};\n\n \nstruct ubifs_orphan {\n\tstruct rb_node rb;\n\tstruct list_head list;\n\tstruct list_head new_list;\n\tstruct list_head child_list;\n\tstruct ubifs_orphan *cnext;\n\tstruct ubifs_orphan *dnext;\n\tino_t inum;\n\tunsigned new:1;\n\tunsigned cmt:1;\n\tunsigned del:1;\n};\n\n \nstruct ubifs_mount_opts {\n\tunsigned int unmount_mode:2;\n\tunsigned int bulk_read:2;\n\tunsigned int chk_data_crc:2;\n\tunsigned int override_compr:1;\n\tunsigned int compr_type:2;\n};\n\n \nstruct ubifs_budg_info {\n\tlong long idx_growth;\n\tlong long data_growth;\n\tlong long dd_growth;\n\tlong long uncommitted_idx;\n\tunsigned long long old_idx_sz;\n\tint min_idx_lebs;\n\tunsigned int nospace:1;\n\tunsigned int nospace_rp:1;\n\tint page_budget;\n\tint inode_budget;\n\tint dent_budget;\n};\n\n \nstruct ubifs_stats_info {\n\tunsigned int magic_errors;\n\tunsigned int node_errors;\n\tunsigned int crc_errors;\n};\n\nstruct ubifs_debug_info;\n\n \nstruct ubifs_info {\n\tstruct super_block *vfs_sb;\n\tstruct ubifs_sb_node *sup_node;\n\n\tino_t highest_inum;\n\tunsigned long long max_sqnum;\n\tunsigned long long cmt_no;\n\tspinlock_t cnt_lock;\n\tint fmt_version;\n\tint ro_compat_version;\n\tunsigned char uuid[16];\n\n\tint lhead_lnum;\n\tint lhead_offs;\n\tint ltail_lnum;\n\tstruct mutex log_mutex;\n\tint min_log_bytes;\n\tlong long cmt_bud_bytes;\n\n\tstruct rb_root buds;\n\tlong long bud_bytes;\n\tspinlock_t buds_lock;\n\tint jhead_cnt;\n\tstruct ubifs_jhead *jheads;\n\tlong long max_bud_bytes;\n\tlong long bg_bud_bytes;\n\tstruct list_head old_buds;\n\tint max_bud_cnt;\n\n\tstruct rw_semaphore commit_sem;\n\tint cmt_state;\n\tspinlock_t cs_lock;\n\twait_queue_head_t cmt_wq;\n\n\tstruct kobject kobj;\n\tstruct completion kobj_unregister;\n\n\tunsigned int big_lpt:1;\n\tunsigned int space_fixup:1;\n\tunsigned int double_hash:1;\n\tunsigned int encrypted:1;\n\tunsigned int no_chk_data_crc:1;\n\tunsigned int bulk_read:1;\n\tunsigned int default_compr:2;\n\tunsigned int rw_incompat:1;\n\tunsigned int assert_action:2;\n\tunsigned int authenticated:1;\n\tunsigned int superblock_need_write:1;\n\n\tstruct mutex tnc_mutex;\n\tstruct ubifs_zbranch zroot;\n\tstruct ubifs_znode *cnext;\n\tstruct ubifs_znode *enext;\n\tint *gap_lebs;\n\tvoid *cbuf;\n\tvoid *ileb_buf;\n\tint ileb_len;\n\tint ihead_lnum;\n\tint ihead_offs;\n\tint *ilebs;\n\tint ileb_cnt;\n\tint ileb_nxt;\n\tstruct rb_root old_idx;\n\tint *bottom_up_buf;\n\n\tstruct ubifs_mst_node *mst_node;\n\tint mst_offs;\n\n\tint max_bu_buf_len;\n\tstruct mutex bu_mutex;\n\tstruct bu_info bu;\n\n\tstruct mutex write_reserve_mutex;\n\tvoid *write_reserve_buf;\n\n\tint log_lebs;\n\tlong long log_bytes;\n\tint log_last;\n\tint lpt_lebs;\n\tint lpt_first;\n\tint lpt_last;\n\tint orph_lebs;\n\tint orph_first;\n\tint orph_last;\n\tint main_lebs;\n\tint main_first;\n\tlong long main_bytes;\n\n\tuint8_t key_hash_type;\n\tuint32_t (*key_hash)(const char *str, int len);\n\tint key_fmt;\n\tint key_len;\n\tint hash_len;\n\tint fanout;\n\n\tint min_io_size;\n\tint min_io_shift;\n\tint max_write_size;\n\tint max_write_shift;\n\tint leb_size;\n\tint leb_start;\n\tint half_leb_size;\n\tint idx_leb_size;\n\tint leb_cnt;\n\tint max_leb_cnt;\n\tunsigned int ro_media:1;\n\tunsigned int ro_mount:1;\n\tunsigned int ro_error:1;\n\n\tatomic_long_t dirty_pg_cnt;\n\tatomic_long_t dirty_zn_cnt;\n\tatomic_long_t clean_zn_cnt;\n\n\tspinlock_t space_lock;\n\tstruct ubifs_lp_stats lst;\n\tstruct ubifs_budg_info bi;\n\tunsigned long long calc_idx_sz;\n\n\tint ref_node_alsz;\n\tint mst_node_alsz;\n\tint min_idx_node_sz;\n\tint max_idx_node_sz;\n\tlong long max_inode_sz;\n\tint max_znode_sz;\n\n\tint leb_overhead;\n\tint dead_wm;\n\tint dark_wm;\n\tint block_cnt;\n\n\tstruct ubifs_node_range ranges[UBIFS_NODE_TYPES_CNT];\n\tstruct ubi_volume_desc *ubi;\n\tstruct ubi_device_info di;\n\tstruct ubi_volume_info vi;\n\n\tstruct rb_root orph_tree;\n\tstruct list_head orph_list;\n\tstruct list_head orph_new;\n\tstruct ubifs_orphan *orph_cnext;\n\tstruct ubifs_orphan *orph_dnext;\n\tspinlock_t orphan_lock;\n\tvoid *orph_buf;\n\tint new_orphans;\n\tint cmt_orphans;\n\tint tot_orphans;\n\tint max_orphans;\n\tint ohead_lnum;\n\tint ohead_offs;\n\tint no_orphs;\n\n\tstruct task_struct *bgt;\n\tchar bgt_name[sizeof(BGT_NAME_PATTERN) + 9];\n\tint need_bgt;\n\tint need_wbuf_sync;\n\n\tint gc_lnum;\n\tvoid *sbuf;\n\tstruct list_head idx_gc;\n\tint idx_gc_cnt;\n\tint gc_seq;\n\tint gced_lnum;\n\n\tstruct list_head infos_list;\n\tstruct mutex umount_mutex;\n\tunsigned int shrinker_run_no;\n\n\tint space_bits;\n\tint lpt_lnum_bits;\n\tint lpt_offs_bits;\n\tint lpt_spc_bits;\n\tint pcnt_bits;\n\tint lnum_bits;\n\tint nnode_sz;\n\tint pnode_sz;\n\tint ltab_sz;\n\tint lsave_sz;\n\tint pnode_cnt;\n\tint nnode_cnt;\n\tint lpt_hght;\n\tint pnodes_have;\n\n\tstruct mutex lp_mutex;\n\tint lpt_lnum;\n\tint lpt_offs;\n\tint nhead_lnum;\n\tint nhead_offs;\n\tint lpt_drty_flgs;\n\tint dirty_nn_cnt;\n\tint dirty_pn_cnt;\n\tint check_lpt_free;\n\tlong long lpt_sz;\n\tvoid *lpt_nod_buf;\n\tvoid *lpt_buf;\n\tstruct ubifs_nnode *nroot;\n\tstruct ubifs_cnode *lpt_cnext;\n\tstruct ubifs_lpt_heap lpt_heap[LPROPS_HEAP_CNT];\n\tstruct ubifs_lpt_heap dirty_idx;\n\tstruct list_head uncat_list;\n\tstruct list_head empty_list;\n\tstruct list_head freeable_list;\n\tstruct list_head frdi_idx_list;\n\tint freeable_cnt;\n\tint in_a_category_cnt;\n\n\tint ltab_lnum;\n\tint ltab_offs;\n\tstruct ubifs_lpt_lprops *ltab;\n\tstruct ubifs_lpt_lprops *ltab_cmt;\n\tint lsave_cnt;\n\tint lsave_lnum;\n\tint lsave_offs;\n\tint *lsave;\n\tint lscan_lnum;\n\n\tlong long rp_size;\n\tlong long report_rp_size;\n\tkuid_t rp_uid;\n\tkgid_t rp_gid;\n\n\tstruct crypto_shash *hash_tfm;\n\tstruct crypto_shash *hmac_tfm;\n\tint hmac_desc_len;\n\tchar *auth_key_name;\n\tchar *auth_hash_name;\n\tenum hash_algo auth_hash_algo;\n\n\tstruct shash_desc *log_hash;\n\n\t \n\tunsigned int empty:1;\n\tunsigned int need_recovery:1;\n\tunsigned int replaying:1;\n\tunsigned int mounting:1;\n\tunsigned int remounting_rw:1;\n\tunsigned int probing:1;\n\tstruct list_head replay_list;\n\tstruct list_head replay_buds;\n\tunsigned long long cs_sqnum;\n\tstruct list_head unclean_leb_list;\n\tstruct ubifs_mst_node *rcvrd_mst_node;\n\tstruct rb_root size_tree;\n\tstruct ubifs_mount_opts mount_opts;\n\n\tstruct ubifs_debug_info *dbg;\n\tstruct ubifs_stats_info *stats;\n};\n\nextern struct list_head ubifs_infos;\nextern spinlock_t ubifs_infos_lock;\nextern atomic_long_t ubifs_clean_zn_cnt;\nextern const struct super_operations ubifs_super_operations;\nextern const struct address_space_operations ubifs_file_address_operations;\nextern const struct file_operations ubifs_file_operations;\nextern const struct inode_operations ubifs_file_inode_operations;\nextern const struct file_operations ubifs_dir_operations;\nextern const struct inode_operations ubifs_dir_inode_operations;\nextern const struct inode_operations ubifs_symlink_inode_operations;\nextern struct ubifs_compressor *ubifs_compressors[UBIFS_COMPR_TYPES_CNT];\nextern int ubifs_default_version;\n\n \nstatic inline int ubifs_authenticated(const struct ubifs_info *c)\n{\n\treturn (IS_ENABLED(CONFIG_UBIFS_FS_AUTHENTICATION)) && c->authenticated;\n}\n\nstruct shash_desc *__ubifs_hash_get_desc(const struct ubifs_info *c);\nstatic inline struct shash_desc *ubifs_hash_get_desc(const struct ubifs_info *c)\n{\n\treturn ubifs_authenticated(c) ? __ubifs_hash_get_desc(c) : NULL;\n}\n\nstatic inline int ubifs_shash_init(const struct ubifs_info *c,\n\t\t\t\t   struct shash_desc *desc)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn crypto_shash_init(desc);\n\telse\n\t\treturn 0;\n}\n\nstatic inline int ubifs_shash_update(const struct ubifs_info *c,\n\t\t\t\t      struct shash_desc *desc, const void *buf,\n\t\t\t\t      unsigned int len)\n{\n\tint err = 0;\n\n\tif (ubifs_authenticated(c)) {\n\t\terr = crypto_shash_update(desc, buf, len);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nstatic inline int ubifs_shash_final(const struct ubifs_info *c,\n\t\t\t\t    struct shash_desc *desc, u8 *out)\n{\n\treturn ubifs_authenticated(c) ? crypto_shash_final(desc, out) : 0;\n}\n\nint __ubifs_node_calc_hash(const struct ubifs_info *c, const void *buf,\n\t\t\t  u8 *hash);\nstatic inline int ubifs_node_calc_hash(const struct ubifs_info *c,\n\t\t\t\t\tconst void *buf, u8 *hash)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn __ubifs_node_calc_hash(c, buf, hash);\n\telse\n\t\treturn 0;\n}\n\nint ubifs_prepare_auth_node(struct ubifs_info *c, void *node,\n\t\t\t     struct shash_desc *inhash);\n\n \nstatic inline int ubifs_check_hash(const struct ubifs_info *c,\n\t\t\t\t   const u8 *expected, const u8 *got)\n{\n\treturn crypto_memneq(expected, got, c->hash_len);\n}\n\n \nstatic inline int ubifs_check_hmac(const struct ubifs_info *c,\n\t\t\t\t   const u8 *expected, const u8 *got)\n{\n\treturn crypto_memneq(expected, got, c->hmac_desc_len);\n}\n\n#ifdef CONFIG_UBIFS_FS_AUTHENTICATION\nvoid ubifs_bad_hash(const struct ubifs_info *c, const void *node,\n\t\t    const u8 *hash, int lnum, int offs);\n#else\nstatic inline void ubifs_bad_hash(const struct ubifs_info *c, const void *node,\n\t\t\t\t  const u8 *hash, int lnum, int offs) {};\n#endif\n\nint __ubifs_node_check_hash(const struct ubifs_info *c, const void *buf,\n\t\t\t  const u8 *expected);\nstatic inline int ubifs_node_check_hash(const struct ubifs_info *c,\n\t\t\t\t\tconst void *buf, const u8 *expected)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn __ubifs_node_check_hash(c, buf, expected);\n\telse\n\t\treturn 0;\n}\n\nint ubifs_init_authentication(struct ubifs_info *c);\nvoid __ubifs_exit_authentication(struct ubifs_info *c);\nstatic inline void ubifs_exit_authentication(struct ubifs_info *c)\n{\n\tif (ubifs_authenticated(c))\n\t\t__ubifs_exit_authentication(c);\n}\n\n \nstatic inline u8 *ubifs_branch_hash(struct ubifs_info *c,\n\t\t\t\t    struct ubifs_branch *br)\n{\n\treturn (void *)br + sizeof(*br) + c->key_len;\n}\n\n \nstatic inline void ubifs_copy_hash(const struct ubifs_info *c, const u8 *from,\n\t\t\t\t   u8 *to)\n{\n\tif (ubifs_authenticated(c))\n\t\tmemcpy(to, from, c->hash_len);\n}\n\nint __ubifs_node_insert_hmac(const struct ubifs_info *c, void *buf,\n\t\t\t      int len, int ofs_hmac);\nstatic inline int ubifs_node_insert_hmac(const struct ubifs_info *c, void *buf,\n\t\t\t\t\t  int len, int ofs_hmac)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn __ubifs_node_insert_hmac(c, buf, len, ofs_hmac);\n\telse\n\t\treturn 0;\n}\n\nint __ubifs_node_verify_hmac(const struct ubifs_info *c, const void *buf,\n\t\t\t     int len, int ofs_hmac);\nstatic inline int ubifs_node_verify_hmac(const struct ubifs_info *c,\n\t\t\t\t\t const void *buf, int len, int ofs_hmac)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn __ubifs_node_verify_hmac(c, buf, len, ofs_hmac);\n\telse\n\t\treturn 0;\n}\n\n \nstatic inline int ubifs_auth_node_sz(const struct ubifs_info *c)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn sizeof(struct ubifs_auth_node) + c->hmac_desc_len;\n\telse\n\t\treturn 0;\n}\nint ubifs_sb_verify_signature(struct ubifs_info *c,\n\t\t\t      const struct ubifs_sb_node *sup);\nbool ubifs_hmac_zero(struct ubifs_info *c, const u8 *hmac);\n\nint ubifs_hmac_wkm(struct ubifs_info *c, u8 *hmac);\n\nint __ubifs_shash_copy_state(const struct ubifs_info *c, struct shash_desc *src,\n\t\t\t     struct shash_desc *target);\nstatic inline int ubifs_shash_copy_state(const struct ubifs_info *c,\n\t\t\t\t\t   struct shash_desc *src,\n\t\t\t\t\t   struct shash_desc *target)\n{\n\tif (ubifs_authenticated(c))\n\t\treturn __ubifs_shash_copy_state(c, src, target);\n\telse\n\t\treturn 0;\n}\n\n \nvoid ubifs_ro_mode(struct ubifs_info *c, int err);\nint ubifs_leb_read(const struct ubifs_info *c, int lnum, void *buf, int offs,\n\t\t   int len, int even_ebadmsg);\nint ubifs_leb_write(struct ubifs_info *c, int lnum, const void *buf, int offs,\n\t\t    int len);\nint ubifs_leb_change(struct ubifs_info *c, int lnum, const void *buf, int len);\nint ubifs_leb_unmap(struct ubifs_info *c, int lnum);\nint ubifs_leb_map(struct ubifs_info *c, int lnum);\nint ubifs_is_mapped(const struct ubifs_info *c, int lnum);\nint ubifs_wbuf_write_nolock(struct ubifs_wbuf *wbuf, void *buf, int len);\nint ubifs_wbuf_seek_nolock(struct ubifs_wbuf *wbuf, int lnum, int offs);\nint ubifs_wbuf_init(struct ubifs_info *c, struct ubifs_wbuf *wbuf);\nint ubifs_read_node(const struct ubifs_info *c, void *buf, int type, int len,\n\t\t    int lnum, int offs);\nint ubifs_read_node_wbuf(struct ubifs_wbuf *wbuf, void *buf, int type, int len,\n\t\t\t int lnum, int offs);\nint ubifs_write_node(struct ubifs_info *c, void *node, int len, int lnum,\n\t\t     int offs);\nint ubifs_write_node_hmac(struct ubifs_info *c, void *buf, int len, int lnum,\n\t\t\t  int offs, int hmac_offs);\nint ubifs_check_node(const struct ubifs_info *c, const void *buf, int len,\n\t\t     int lnum, int offs, int quiet, int must_chk_crc);\nvoid ubifs_init_node(struct ubifs_info *c, void *buf, int len, int pad);\nvoid ubifs_crc_node(struct ubifs_info *c, void *buf, int len);\nvoid ubifs_prepare_node(struct ubifs_info *c, void *buf, int len, int pad);\nint ubifs_prepare_node_hmac(struct ubifs_info *c, void *node, int len,\n\t\t\t    int hmac_offs, int pad);\nvoid ubifs_prep_grp_node(struct ubifs_info *c, void *node, int len, int last);\nint ubifs_io_init(struct ubifs_info *c);\nvoid ubifs_pad(const struct ubifs_info *c, void *buf, int pad);\nint ubifs_wbuf_sync_nolock(struct ubifs_wbuf *wbuf);\nint ubifs_bg_wbufs_sync(struct ubifs_info *c);\nvoid ubifs_wbuf_add_ino_nolock(struct ubifs_wbuf *wbuf, ino_t inum);\nint ubifs_sync_wbufs_by_inode(struct ubifs_info *c, struct inode *inode);\n\n \nstruct ubifs_scan_leb *ubifs_scan(const struct ubifs_info *c, int lnum,\n\t\t\t\t  int offs, void *sbuf, int quiet);\nvoid ubifs_scan_destroy(struct ubifs_scan_leb *sleb);\nint ubifs_scan_a_node(const struct ubifs_info *c, void *buf, int len, int lnum,\n\t\t      int offs, int quiet);\nstruct ubifs_scan_leb *ubifs_start_scan(const struct ubifs_info *c, int lnum,\n\t\t\t\t\tint offs, void *sbuf);\nvoid ubifs_end_scan(const struct ubifs_info *c, struct ubifs_scan_leb *sleb,\n\t\t    int lnum, int offs);\nint ubifs_add_snod(const struct ubifs_info *c, struct ubifs_scan_leb *sleb,\n\t\t   void *buf, int offs);\nvoid ubifs_scanned_corruption(const struct ubifs_info *c, int lnum, int offs,\n\t\t\t      void *buf);\n\n \nvoid ubifs_add_bud(struct ubifs_info *c, struct ubifs_bud *bud);\nvoid ubifs_create_buds_lists(struct ubifs_info *c);\nint ubifs_add_bud_to_log(struct ubifs_info *c, int jhead, int lnum, int offs);\nstruct ubifs_bud *ubifs_search_bud(struct ubifs_info *c, int lnum);\nstruct ubifs_wbuf *ubifs_get_wbuf(struct ubifs_info *c, int lnum);\nint ubifs_log_start_commit(struct ubifs_info *c, int *ltail_lnum);\nint ubifs_log_end_commit(struct ubifs_info *c, int new_ltail_lnum);\nint ubifs_log_post_commit(struct ubifs_info *c, int old_ltail_lnum);\nint ubifs_consolidate_log(struct ubifs_info *c);\n\n \nint ubifs_jnl_update(struct ubifs_info *c, const struct inode *dir,\n\t\t     const struct fscrypt_name *nm, const struct inode *inode,\n\t\t     int deletion, int xent);\nint ubifs_jnl_write_data(struct ubifs_info *c, const struct inode *inode,\n\t\t\t const union ubifs_key *key, const void *buf, int len);\nint ubifs_jnl_write_inode(struct ubifs_info *c, const struct inode *inode);\nint ubifs_jnl_delete_inode(struct ubifs_info *c, const struct inode *inode);\nint ubifs_jnl_xrename(struct ubifs_info *c, const struct inode *fst_dir,\n\t\t      const struct inode *fst_inode,\n\t\t      const struct fscrypt_name *fst_nm,\n\t\t      const struct inode *snd_dir,\n\t\t      const struct inode *snd_inode,\n\t\t      const struct fscrypt_name *snd_nm, int sync);\nint ubifs_jnl_rename(struct ubifs_info *c, const struct inode *old_dir,\n\t\t     const struct inode *old_inode,\n\t\t     const struct fscrypt_name *old_nm,\n\t\t     const struct inode *new_dir,\n\t\t     const struct inode *new_inode,\n\t\t     const struct fscrypt_name *new_nm,\n\t\t     const struct inode *whiteout, int sync);\nint ubifs_jnl_truncate(struct ubifs_info *c, const struct inode *inode,\n\t\t       loff_t old_size, loff_t new_size);\nint ubifs_jnl_delete_xattr(struct ubifs_info *c, const struct inode *host,\n\t\t\t   const struct inode *inode, const struct fscrypt_name *nm);\nint ubifs_jnl_change_xattr(struct ubifs_info *c, const struct inode *inode1,\n\t\t\t   const struct inode *inode2);\n\n \nint ubifs_budget_space(struct ubifs_info *c, struct ubifs_budget_req *req);\nvoid ubifs_release_budget(struct ubifs_info *c, struct ubifs_budget_req *req);\nvoid ubifs_release_dirty_inode_budget(struct ubifs_info *c,\n\t\t\t\t      struct ubifs_inode *ui);\nint ubifs_budget_inode_op(struct ubifs_info *c, struct inode *inode,\n\t\t\t  struct ubifs_budget_req *req);\nvoid ubifs_release_ino_dirty(struct ubifs_info *c, struct inode *inode,\n\t\t\t\tstruct ubifs_budget_req *req);\nvoid ubifs_cancel_ino_op(struct ubifs_info *c, struct inode *inode,\n\t\t\t struct ubifs_budget_req *req);\nlong long ubifs_get_free_space(struct ubifs_info *c);\nlong long ubifs_get_free_space_nolock(struct ubifs_info *c);\nint ubifs_calc_min_idx_lebs(struct ubifs_info *c);\nvoid ubifs_convert_page_budget(struct ubifs_info *c);\nlong long ubifs_reported_space(const struct ubifs_info *c, long long free);\nlong long ubifs_calc_available(const struct ubifs_info *c, int min_idx_lebs);\n\n \nint ubifs_find_free_space(struct ubifs_info *c, int min_space, int *offs,\n\t\t\t  int squeeze);\nint ubifs_find_free_leb_for_idx(struct ubifs_info *c);\nint ubifs_find_dirty_leb(struct ubifs_info *c, struct ubifs_lprops *ret_lp,\n\t\t\t int min_space, int pick_free);\nint ubifs_find_dirty_idx_leb(struct ubifs_info *c);\nint ubifs_save_dirty_idx_lnums(struct ubifs_info *c);\n\n \nint ubifs_lookup_level0(struct ubifs_info *c, const union ubifs_key *key,\n\t\t\tstruct ubifs_znode **zn, int *n);\nint ubifs_tnc_lookup_nm(struct ubifs_info *c, const union ubifs_key *key,\n\t\t\tvoid *node, const struct fscrypt_name *nm);\nint ubifs_tnc_lookup_dh(struct ubifs_info *c, const union ubifs_key *key,\n\t\t\tvoid *node, uint32_t secondary_hash);\nint ubifs_tnc_locate(struct ubifs_info *c, const union ubifs_key *key,\n\t\t     void *node, int *lnum, int *offs);\nint ubifs_tnc_add(struct ubifs_info *c, const union ubifs_key *key, int lnum,\n\t\t  int offs, int len, const u8 *hash);\nint ubifs_tnc_replace(struct ubifs_info *c, const union ubifs_key *key,\n\t\t      int old_lnum, int old_offs, int lnum, int offs, int len);\nint ubifs_tnc_add_nm(struct ubifs_info *c, const union ubifs_key *key,\n\t\t     int lnum, int offs, int len, const u8 *hash,\n\t\t     const struct fscrypt_name *nm);\nint ubifs_tnc_remove(struct ubifs_info *c, const union ubifs_key *key);\nint ubifs_tnc_remove_nm(struct ubifs_info *c, const union ubifs_key *key,\n\t\t\tconst struct fscrypt_name *nm);\nint ubifs_tnc_remove_dh(struct ubifs_info *c, const union ubifs_key *key,\n\t\t\tuint32_t cookie);\nint ubifs_tnc_remove_range(struct ubifs_info *c, union ubifs_key *from_key,\n\t\t\t   union ubifs_key *to_key);\nint ubifs_tnc_remove_ino(struct ubifs_info *c, ino_t inum);\nstruct ubifs_dent_node *ubifs_tnc_next_ent(struct ubifs_info *c,\n\t\t\t\t\t   union ubifs_key *key,\n\t\t\t\t\t   const struct fscrypt_name *nm);\nvoid ubifs_tnc_close(struct ubifs_info *c);\nint ubifs_tnc_has_node(struct ubifs_info *c, union ubifs_key *key, int level,\n\t\t       int lnum, int offs, int is_idx);\nint ubifs_dirty_idx_node(struct ubifs_info *c, union ubifs_key *key, int level,\n\t\t\t int lnum, int offs);\n \nvoid destroy_old_idx(struct ubifs_info *c);\nint is_idx_node_in_tnc(struct ubifs_info *c, union ubifs_key *key, int level,\n\t\t       int lnum, int offs);\nint insert_old_idx_znode(struct ubifs_info *c, struct ubifs_znode *znode);\nint ubifs_tnc_get_bu_keys(struct ubifs_info *c, struct bu_info *bu);\nint ubifs_tnc_bulk_read(struct ubifs_info *c, struct bu_info *bu);\n\n \nstruct ubifs_znode *ubifs_tnc_levelorder_next(const struct ubifs_info *c,\n\t\t\t\t\t      struct ubifs_znode *zr,\n\t\t\t\t\t      struct ubifs_znode *znode);\nint ubifs_search_zbranch(const struct ubifs_info *c,\n\t\t\t const struct ubifs_znode *znode,\n\t\t\t const union ubifs_key *key, int *n);\nstruct ubifs_znode *ubifs_tnc_postorder_first(struct ubifs_znode *znode);\nstruct ubifs_znode *ubifs_tnc_postorder_next(const struct ubifs_info *c,\n\t\t\t\t\t     struct ubifs_znode *znode);\nlong ubifs_destroy_tnc_subtree(const struct ubifs_info *c,\n\t\t\t       struct ubifs_znode *zr);\nstruct ubifs_znode *ubifs_load_znode(struct ubifs_info *c,\n\t\t\t\t     struct ubifs_zbranch *zbr,\n\t\t\t\t     struct ubifs_znode *parent, int iip);\nint ubifs_tnc_read_node(struct ubifs_info *c, struct ubifs_zbranch *zbr,\n\t\t\tvoid *node);\n\n \nint ubifs_tnc_start_commit(struct ubifs_info *c, struct ubifs_zbranch *zroot);\nint ubifs_tnc_end_commit(struct ubifs_info *c);\n\n \nunsigned long ubifs_shrink_scan(struct shrinker *shrink,\n\t\t\t\tstruct shrink_control *sc);\nunsigned long ubifs_shrink_count(struct shrinker *shrink,\n\t\t\t\t struct shrink_control *sc);\n\n \nint ubifs_bg_thread(void *info);\nvoid ubifs_commit_required(struct ubifs_info *c);\nvoid ubifs_request_bg_commit(struct ubifs_info *c);\nint ubifs_run_commit(struct ubifs_info *c);\nvoid ubifs_recovery_commit(struct ubifs_info *c);\nint ubifs_gc_should_commit(struct ubifs_info *c);\nvoid ubifs_wait_for_commit(struct ubifs_info *c);\n\n \nint ubifs_compare_master_node(struct ubifs_info *c, void *m1, void *m2);\nint ubifs_read_master(struct ubifs_info *c);\nint ubifs_write_master(struct ubifs_info *c);\n\n \nint ubifs_read_superblock(struct ubifs_info *c);\nint ubifs_write_sb_node(struct ubifs_info *c, struct ubifs_sb_node *sup);\nint ubifs_fixup_free_space(struct ubifs_info *c);\nint ubifs_enable_encryption(struct ubifs_info *c);\n\n \nint ubifs_validate_entry(struct ubifs_info *c,\n\t\t\t const struct ubifs_dent_node *dent);\nint ubifs_replay_journal(struct ubifs_info *c);\n\n \nint ubifs_garbage_collect(struct ubifs_info *c, int anyway);\nint ubifs_gc_start_commit(struct ubifs_info *c);\nint ubifs_gc_end_commit(struct ubifs_info *c);\nvoid ubifs_destroy_idx_gc(struct ubifs_info *c);\nint ubifs_get_idx_gc_leb(struct ubifs_info *c);\nint ubifs_garbage_collect_leb(struct ubifs_info *c, struct ubifs_lprops *lp);\n\n \nint ubifs_add_orphan(struct ubifs_info *c, ino_t inum);\nvoid ubifs_delete_orphan(struct ubifs_info *c, ino_t inum);\nint ubifs_orphan_start_commit(struct ubifs_info *c);\nint ubifs_orphan_end_commit(struct ubifs_info *c);\nint ubifs_mount_orphans(struct ubifs_info *c, int unclean, int read_only);\nint ubifs_clear_orphans(struct ubifs_info *c);\n\n \nint ubifs_calc_lpt_geom(struct ubifs_info *c);\nint ubifs_create_dflt_lpt(struct ubifs_info *c, int *main_lebs, int lpt_first,\n\t\t\t  int *lpt_lebs, int *big_lpt, u8 *hash);\nint ubifs_lpt_init(struct ubifs_info *c, int rd, int wr);\nstruct ubifs_lprops *ubifs_lpt_lookup(struct ubifs_info *c, int lnum);\nstruct ubifs_lprops *ubifs_lpt_lookup_dirty(struct ubifs_info *c, int lnum);\nint ubifs_lpt_scan_nolock(struct ubifs_info *c, int start_lnum, int end_lnum,\n\t\t\t  ubifs_lpt_scan_callback scan_cb, void *data);\n\n \nvoid ubifs_pack_lsave(struct ubifs_info *c, void *buf, int *lsave);\nvoid ubifs_pack_ltab(struct ubifs_info *c, void *buf,\n\t\t     struct ubifs_lpt_lprops *ltab);\nvoid ubifs_pack_pnode(struct ubifs_info *c, void *buf,\n\t\t      struct ubifs_pnode *pnode);\nvoid ubifs_pack_nnode(struct ubifs_info *c, void *buf,\n\t\t      struct ubifs_nnode *nnode);\nstruct ubifs_pnode *ubifs_get_pnode(struct ubifs_info *c,\n\t\t\t\t    struct ubifs_nnode *parent, int iip);\nstruct ubifs_nnode *ubifs_get_nnode(struct ubifs_info *c,\n\t\t\t\t    struct ubifs_nnode *parent, int iip);\nstruct ubifs_pnode *ubifs_pnode_lookup(struct ubifs_info *c, int i);\nint ubifs_read_nnode(struct ubifs_info *c, struct ubifs_nnode *parent, int iip);\nvoid ubifs_add_lpt_dirt(struct ubifs_info *c, int lnum, int dirty);\nvoid ubifs_add_nnode_dirt(struct ubifs_info *c, struct ubifs_nnode *nnode);\nuint32_t ubifs_unpack_bits(const struct ubifs_info *c, uint8_t **addr, int *pos, int nrbits);\nstruct ubifs_nnode *ubifs_first_nnode(struct ubifs_info *c, int *hght);\n \nint ubifs_unpack_nnode(const struct ubifs_info *c, void *buf,\n\t\t       struct ubifs_nnode *nnode);\nint ubifs_lpt_calc_hash(struct ubifs_info *c, u8 *hash);\n\n \nint ubifs_lpt_start_commit(struct ubifs_info *c);\nint ubifs_lpt_end_commit(struct ubifs_info *c);\nint ubifs_lpt_post_commit(struct ubifs_info *c);\nvoid ubifs_lpt_free(struct ubifs_info *c, int wr_only);\n\n \nconst struct ubifs_lprops *ubifs_change_lp(struct ubifs_info *c,\n\t\t\t\t\t   const struct ubifs_lprops *lp,\n\t\t\t\t\t   int free, int dirty, int flags,\n\t\t\t\t\t   int idx_gc_cnt);\nvoid ubifs_get_lp_stats(struct ubifs_info *c, struct ubifs_lp_stats *lst);\nvoid ubifs_add_to_cat(struct ubifs_info *c, struct ubifs_lprops *lprops,\n\t\t      int cat);\nvoid ubifs_replace_cat(struct ubifs_info *c, struct ubifs_lprops *old_lprops,\n\t\t       struct ubifs_lprops *new_lprops);\nvoid ubifs_ensure_cat(struct ubifs_info *c, struct ubifs_lprops *lprops);\nint ubifs_categorize_lprops(const struct ubifs_info *c,\n\t\t\t    const struct ubifs_lprops *lprops);\nint ubifs_change_one_lp(struct ubifs_info *c, int lnum, int free, int dirty,\n\t\t\tint flags_set, int flags_clean, int idx_gc_cnt);\nint ubifs_update_one_lp(struct ubifs_info *c, int lnum, int free, int dirty,\n\t\t\tint flags_set, int flags_clean);\nint ubifs_read_one_lp(struct ubifs_info *c, int lnum, struct ubifs_lprops *lp);\nconst struct ubifs_lprops *ubifs_fast_find_free(struct ubifs_info *c);\nconst struct ubifs_lprops *ubifs_fast_find_empty(struct ubifs_info *c);\nconst struct ubifs_lprops *ubifs_fast_find_freeable(struct ubifs_info *c);\nconst struct ubifs_lprops *ubifs_fast_find_frdi_idx(struct ubifs_info *c);\nint ubifs_calc_dark(const struct ubifs_info *c, int spc);\n\n \nint ubifs_fsync(struct file *file, loff_t start, loff_t end, int datasync);\nint ubifs_setattr(struct mnt_idmap *idmap, struct dentry *dentry,\n\t\t  struct iattr *attr);\nint ubifs_update_time(struct inode *inode, int flags);\n\n \nstruct inode *ubifs_new_inode(struct ubifs_info *c, struct inode *dir,\n\t\t\t      umode_t mode, bool is_xattr);\nint ubifs_getattr(struct mnt_idmap *idmap, const struct path *path,\n\t\t  struct kstat *stat, u32 request_mask, unsigned int flags);\nint ubifs_check_dir_empty(struct inode *dir);\n\n \nint ubifs_xattr_set(struct inode *host, const char *name, const void *value,\n\t\t    size_t size, int flags, bool check_lock);\nssize_t ubifs_xattr_get(struct inode *host, const char *name, void *buf,\n\t\t\tsize_t size);\n\n#ifdef CONFIG_UBIFS_FS_XATTR\nextern const struct xattr_handler *ubifs_xattr_handlers[];\nssize_t ubifs_listxattr(struct dentry *dentry, char *buffer, size_t size);\nvoid ubifs_evict_xattr_inode(struct ubifs_info *c, ino_t xattr_inum);\nint ubifs_purge_xattrs(struct inode *host);\n#else\n#define ubifs_listxattr NULL\n#define ubifs_xattr_handlers NULL\nstatic inline void ubifs_evict_xattr_inode(struct ubifs_info *c,\n\t\t\t\t\t   ino_t xattr_inum) { }\nstatic inline int ubifs_purge_xattrs(struct inode *host)\n{\n\treturn 0;\n}\n#endif\n\n#ifdef CONFIG_UBIFS_FS_SECURITY\nextern int ubifs_init_security(struct inode *dentry, struct inode *inode,\n\t\t\tconst struct qstr *qstr);\n#else\nstatic inline int ubifs_init_security(struct inode *dentry,\n\t\t\tstruct inode *inode, const struct qstr *qstr)\n{\n\treturn 0;\n}\n#endif\n\n\n \nstruct inode *ubifs_iget(struct super_block *sb, unsigned long inum);\n\n \nint ubifs_recover_master_node(struct ubifs_info *c);\nint ubifs_write_rcvrd_mst_node(struct ubifs_info *c);\nstruct ubifs_scan_leb *ubifs_recover_leb(struct ubifs_info *c, int lnum,\n\t\t\t\t\t int offs, void *sbuf, int jhead);\nstruct ubifs_scan_leb *ubifs_recover_log_leb(struct ubifs_info *c, int lnum,\n\t\t\t\t\t     int offs, void *sbuf);\nint ubifs_recover_inl_heads(struct ubifs_info *c, void *sbuf);\nint ubifs_clean_lebs(struct ubifs_info *c, void *sbuf);\nint ubifs_rcvry_gc_commit(struct ubifs_info *c);\nint ubifs_recover_size_accum(struct ubifs_info *c, union ubifs_key *key,\n\t\t\t     int deletion, loff_t new_size);\nint ubifs_recover_size(struct ubifs_info *c, bool in_place);\nvoid ubifs_destroy_size_tree(struct ubifs_info *c);\n\n \nint ubifs_fileattr_get(struct dentry *dentry, struct fileattr *fa);\nint ubifs_fileattr_set(struct mnt_idmap *idmap,\n\t\t       struct dentry *dentry, struct fileattr *fa);\nlong ubifs_ioctl(struct file *file, unsigned int cmd, unsigned long arg);\nvoid ubifs_set_inode_flags(struct inode *inode);\n#ifdef CONFIG_COMPAT\nlong ubifs_compat_ioctl(struct file *file, unsigned int cmd, unsigned long arg);\n#endif\n\n \nint __init ubifs_compressors_init(void);\nvoid ubifs_compressors_exit(void);\nvoid ubifs_compress(const struct ubifs_info *c, const void *in_buf, int in_len,\n\t\t    void *out_buf, int *out_len, int *compr_type);\nint ubifs_decompress(const struct ubifs_info *c, const void *buf, int len,\n\t\t     void *out, int *out_len, int compr_type);\n\n \nint ubifs_sysfs_init(void);\nvoid ubifs_sysfs_exit(void);\nint ubifs_sysfs_register(struct ubifs_info *c);\nvoid ubifs_sysfs_unregister(struct ubifs_info *c);\n\n#include \"debug.h\"\n#include \"misc.h\"\n#include \"key.h\"\n\n#ifndef CONFIG_FS_ENCRYPTION\nstatic inline int ubifs_encrypt(const struct inode *inode,\n\t\t\t\tstruct ubifs_data_node *dn,\n\t\t\t\tunsigned int in_len, unsigned int *out_len,\n\t\t\t\tint block)\n{\n\tstruct ubifs_info *c = inode->i_sb->s_fs_info;\n\tubifs_assert(c, 0);\n\treturn -EOPNOTSUPP;\n}\nstatic inline int ubifs_decrypt(const struct inode *inode,\n\t\t\t\tstruct ubifs_data_node *dn,\n\t\t\t\tunsigned int *out_len, int block)\n{\n\tstruct ubifs_info *c = inode->i_sb->s_fs_info;\n\tubifs_assert(c, 0);\n\treturn -EOPNOTSUPP;\n}\n#else\n \nint ubifs_encrypt(const struct inode *inode, struct ubifs_data_node *dn,\n\t\t  unsigned int in_len, unsigned int *out_len, int block);\nint ubifs_decrypt(const struct inode *inode, struct ubifs_data_node *dn,\n\t\t  unsigned int *out_len, int block);\n#endif\n\nextern const struct fscrypt_operations ubifs_crypt_operations;\n\n \n__printf(2, 3)\nvoid ubifs_msg(const struct ubifs_info *c, const char *fmt, ...);\n__printf(2, 3)\nvoid ubifs_err(const struct ubifs_info *c, const char *fmt, ...);\n__printf(2, 3)\nvoid ubifs_warn(const struct ubifs_info *c, const char *fmt, ...);\n \n#define ubifs_errc(c, fmt, ...)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (!(c)->probing)\t\t\t\t\t\t\\\n\t\tubifs_err(c, fmt, ##__VA_ARGS__);\t\t\t\\\n} while (0)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}