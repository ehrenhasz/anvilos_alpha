{
  "module_name": "debug.h",
  "hash_id": "5eb73ac80526d30ee812e10ae580649f7bc57677d8f92f98ed1f875a92b4bab5",
  "original_prompt": "Ingested from linux-6.6.14/fs/ubifs/debug.h",
  "human_readable_source": " \n \n\n#ifndef __UBIFS_DEBUG_H__\n#define __UBIFS_DEBUG_H__\n\n \ntypedef int (*dbg_leaf_callback)(struct ubifs_info *c,\n\t\t\t\t struct ubifs_zbranch *zbr, void *priv);\ntypedef int (*dbg_znode_callback)(struct ubifs_info *c,\n\t\t\t\t  struct ubifs_znode *znode, void *priv);\n\n \n#define UBIFS_DFS_DIR_NAME \"ubi%d_%d\"\n#define UBIFS_DFS_DIR_LEN  (3 + 1 + 2*2 + 1)\n\n \nstruct ubifs_debug_info {\n\tstruct ubifs_zbranch old_zroot;\n\tint old_zroot_level;\n\tunsigned long long old_zroot_sqnum;\n\n\tint pc_happened;\n\tint pc_delay;\n\tunsigned long pc_timeout;\n\tunsigned int pc_cnt;\n\tunsigned int pc_cnt_max;\n\n\tlong long chk_lpt_sz;\n\tlong long chk_lpt_sz2;\n\tlong long chk_lpt_wastage;\n\tint chk_lpt_lebs;\n\tint new_nhead_offs;\n\tint new_ihead_lnum;\n\tint new_ihead_offs;\n\n\tstruct ubifs_lp_stats saved_lst;\n\tstruct ubifs_budg_info saved_bi;\n\tlong long saved_free;\n\tint saved_idx_gc_cnt;\n\n\tunsigned int chk_gen:1;\n\tunsigned int chk_index:1;\n\tunsigned int chk_orph:1;\n\tunsigned int chk_lprops:1;\n\tunsigned int chk_fs:1;\n\tunsigned int tst_rcvry:1;\n\n\tchar dfs_dir_name[UBIFS_DFS_DIR_LEN + 1];\n\tstruct dentry *dfs_dir;\n\tstruct dentry *dfs_dump_lprops;\n\tstruct dentry *dfs_dump_budg;\n\tstruct dentry *dfs_dump_tnc;\n\tstruct dentry *dfs_chk_gen;\n\tstruct dentry *dfs_chk_index;\n\tstruct dentry *dfs_chk_orph;\n\tstruct dentry *dfs_chk_lprops;\n\tstruct dentry *dfs_chk_fs;\n\tstruct dentry *dfs_tst_rcvry;\n\tstruct dentry *dfs_ro_error;\n};\n\n \nstruct ubifs_global_debug_info {\n\tunsigned int chk_gen:1;\n\tunsigned int chk_index:1;\n\tunsigned int chk_orph:1;\n\tunsigned int chk_lprops:1;\n\tunsigned int chk_fs:1;\n\tunsigned int tst_rcvry:1;\n};\n\nvoid ubifs_assert_failed(struct ubifs_info *c, const char *expr,\n\tconst char *file, int line);\n\n#define ubifs_assert(c, expr) do {                                             \\\n\tif (unlikely(!(expr))) {                                               \\\n\t\tubifs_assert_failed((struct ubifs_info *)c, #expr, __FILE__,   \\\n\t\t __LINE__);                                                    \\\n\t}                                                                      \\\n} while (0)\n\n#define ubifs_assert_cmt_locked(c) do {                                        \\\n\tif (unlikely(down_write_trylock(&(c)->commit_sem))) {                  \\\n\t\tup_write(&(c)->commit_sem);                                    \\\n\t\tubifs_err(c, \"commit lock is not locked!\\n\");                  \\\n\t\tubifs_assert(c, 0);                                            \\\n\t}                                                                      \\\n} while (0)\n\n#define ubifs_dbg_msg(type, fmt, ...) \\\n\tpr_debug(\"UBIFS DBG \" type \" (pid %d): \" fmt \"\\n\", current->pid,       \\\n\t\t ##__VA_ARGS__)\n\n#define DBG_KEY_BUF_LEN 48\n#define ubifs_dbg_msg_key(type, key, fmt, ...) do {                            \\\n\tchar __tmp_key_buf[DBG_KEY_BUF_LEN];                                   \\\n\tpr_debug(\"UBIFS DBG \" type \" (pid %d): \" fmt \"%s\\n\", current->pid,     \\\n\t\t ##__VA_ARGS__,                                                \\\n\t\t dbg_snprintf_key(c, key, __tmp_key_buf, DBG_KEY_BUF_LEN));    \\\n} while (0)\n\n \n#define dbg_gen(fmt, ...)   ubifs_dbg_msg(\"gen\", fmt, ##__VA_ARGS__)\n \n#define dbg_jnl(fmt, ...)   ubifs_dbg_msg(\"jnl\", fmt, ##__VA_ARGS__)\n#define dbg_jnlk(key, fmt, ...) \\\n\tubifs_dbg_msg_key(\"jnl\", key, fmt, ##__VA_ARGS__)\n \n#define dbg_tnc(fmt, ...)   ubifs_dbg_msg(\"tnc\", fmt, ##__VA_ARGS__)\n#define dbg_tnck(key, fmt, ...) \\\n\tubifs_dbg_msg_key(\"tnc\", key, fmt, ##__VA_ARGS__)\n \n#define dbg_lp(fmt, ...)    ubifs_dbg_msg(\"lp\", fmt, ##__VA_ARGS__)\n \n#define dbg_find(fmt, ...)  ubifs_dbg_msg(\"find\", fmt, ##__VA_ARGS__)\n \n#define dbg_mnt(fmt, ...)   ubifs_dbg_msg(\"mnt\", fmt, ##__VA_ARGS__)\n#define dbg_mntk(key, fmt, ...) \\\n\tubifs_dbg_msg_key(\"mnt\", key, fmt, ##__VA_ARGS__)\n \n#define dbg_io(fmt, ...)    ubifs_dbg_msg(\"io\", fmt, ##__VA_ARGS__)\n \n#define dbg_cmt(fmt, ...)   ubifs_dbg_msg(\"cmt\", fmt, ##__VA_ARGS__)\n \n#define dbg_budg(fmt, ...)  ubifs_dbg_msg(\"budg\", fmt, ##__VA_ARGS__)\n \n#define dbg_log(fmt, ...)   ubifs_dbg_msg(\"log\", fmt, ##__VA_ARGS__)\n \n#define dbg_gc(fmt, ...)    ubifs_dbg_msg(\"gc\", fmt, ##__VA_ARGS__)\n \n#define dbg_scan(fmt, ...)  ubifs_dbg_msg(\"scan\", fmt, ##__VA_ARGS__)\n \n#define dbg_rcvry(fmt, ...) ubifs_dbg_msg(\"rcvry\", fmt, ##__VA_ARGS__)\n\nextern struct ubifs_global_debug_info ubifs_dbg;\n\nstatic inline int dbg_is_chk_gen(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.chk_gen || c->dbg->chk_gen);\n}\nstatic inline int dbg_is_chk_index(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.chk_index || c->dbg->chk_index);\n}\nstatic inline int dbg_is_chk_orph(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.chk_orph || c->dbg->chk_orph);\n}\nstatic inline int dbg_is_chk_lprops(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.chk_lprops || c->dbg->chk_lprops);\n}\nstatic inline int dbg_is_chk_fs(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.chk_fs || c->dbg->chk_fs);\n}\nstatic inline int dbg_is_tst_rcvry(const struct ubifs_info *c)\n{\n\treturn !!(ubifs_dbg.tst_rcvry || c->dbg->tst_rcvry);\n}\nstatic inline int dbg_is_power_cut(const struct ubifs_info *c)\n{\n\treturn !!c->dbg->pc_happened;\n}\n\nint ubifs_debugging_init(struct ubifs_info *c);\nvoid ubifs_debugging_exit(struct ubifs_info *c);\n\n \nconst char *dbg_ntype(int type);\nconst char *dbg_cstate(int cmt_state);\nconst char *dbg_jhead(int jhead);\nconst char *dbg_get_key_dump(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key);\nconst char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len);\nvoid ubifs_dump_inode(struct ubifs_info *c, const struct inode *inode);\nvoid ubifs_dump_node(const struct ubifs_info *c, const void *node,\n\t\t     int node_len);\nvoid ubifs_dump_budget_req(const struct ubifs_budget_req *req);\nvoid ubifs_dump_lstats(const struct ubifs_lp_stats *lst);\nvoid ubifs_dump_budg(struct ubifs_info *c, const struct ubifs_budg_info *bi);\nvoid ubifs_dump_lprop(const struct ubifs_info *c,\n\t\t      const struct ubifs_lprops *lp);\nvoid ubifs_dump_lprops(struct ubifs_info *c);\nvoid ubifs_dump_lpt_info(struct ubifs_info *c);\nvoid ubifs_dump_leb(const struct ubifs_info *c, int lnum);\nvoid ubifs_dump_znode(const struct ubifs_info *c,\n\t\t      const struct ubifs_znode *znode);\nvoid ubifs_dump_heap(struct ubifs_info *c, struct ubifs_lpt_heap *heap,\n\t\t     int cat);\nvoid ubifs_dump_pnode(struct ubifs_info *c, struct ubifs_pnode *pnode,\n\t\t      struct ubifs_nnode *parent, int iip);\nvoid ubifs_dump_tnc(struct ubifs_info *c);\nvoid ubifs_dump_index(struct ubifs_info *c);\nvoid ubifs_dump_lpt_lebs(const struct ubifs_info *c);\n\nint dbg_walk_index(struct ubifs_info *c, dbg_leaf_callback leaf_cb,\n\t\t   dbg_znode_callback znode_cb, void *priv);\n\n \nvoid dbg_save_space_info(struct ubifs_info *c);\nint dbg_check_space_info(struct ubifs_info *c);\nint dbg_check_lprops(struct ubifs_info *c);\nint dbg_old_index_check_init(struct ubifs_info *c, struct ubifs_zbranch *zroot);\nint dbg_check_old_index(struct ubifs_info *c, struct ubifs_zbranch *zroot);\nint dbg_check_cats(struct ubifs_info *c);\nint dbg_check_ltab(struct ubifs_info *c);\nint dbg_chk_lpt_free_spc(struct ubifs_info *c);\nint dbg_chk_lpt_sz(struct ubifs_info *c, int action, int len);\nint dbg_check_synced_i_size(const struct ubifs_info *c, struct inode *inode);\nint dbg_check_dir(struct ubifs_info *c, const struct inode *dir);\nint dbg_check_tnc(struct ubifs_info *c, int extra);\nint dbg_check_idx_size(struct ubifs_info *c, long long idx_size);\nint dbg_check_filesystem(struct ubifs_info *c);\nvoid dbg_check_heap(struct ubifs_info *c, struct ubifs_lpt_heap *heap, int cat,\n\t\t    int add_pos);\nint dbg_check_lpt_nodes(struct ubifs_info *c, struct ubifs_cnode *cnode,\n\t\t\tint row, int col);\nint dbg_check_inode_size(struct ubifs_info *c, const struct inode *inode,\n\t\t\t loff_t size);\nint dbg_check_data_nodes_order(struct ubifs_info *c, struct list_head *head);\nint dbg_check_nondata_nodes_order(struct ubifs_info *c, struct list_head *head);\n\nint dbg_leb_write(struct ubifs_info *c, int lnum, const void *buf, int offs,\n\t\t  int len);\nint dbg_leb_change(struct ubifs_info *c, int lnum, const void *buf, int len);\nint dbg_leb_unmap(struct ubifs_info *c, int lnum);\nint dbg_leb_map(struct ubifs_info *c, int lnum);\n\n \nvoid dbg_debugfs_init(void);\nvoid dbg_debugfs_exit(void);\nvoid dbg_debugfs_init_fs(struct ubifs_info *c);\nvoid dbg_debugfs_exit_fs(struct ubifs_info *c);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}