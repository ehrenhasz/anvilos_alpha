{
  "module_name": "ubifs-media.h",
  "hash_id": "0a75ee53d2fcbf267261f0cd8fcef138d8a35d1e764c0b489a4310fb151eada4",
  "original_prompt": "Ingested from linux-6.6.14/fs/ubifs/ubifs-media.h",
  "human_readable_source": " \n \n\n \n\n#ifndef __UBIFS_MEDIA_H__\n#define __UBIFS_MEDIA_H__\n\n \n#define UBIFS_NODE_MAGIC  0x06101831\n\n \n#define UBIFS_FORMAT_VERSION 5\n\n \n#define UBIFS_RO_COMPAT_VERSION 0\n\n \n#define UBIFS_MIN_LEB_SZ (15*1024)\n\n \n#define UBIFS_CRC32_INIT 0xFFFFFFFFU\n\n \n#define UBIFS_MIN_COMPR_LEN 128\n\n \n#define UBIFS_MIN_COMPRESS_DIFF 64\n\n \n#define UBIFS_ROOT_INO 1\n\n \n#define UBIFS_FIRST_INO 64\n\n \n#define UBIFS_MAX_NLEN 255\n\n \n#define UBIFS_MAX_JHEADS 1\n\n \n#define UBIFS_BLOCK_SIZE  4096\n#define UBIFS_BLOCK_SHIFT 12\n\n \n#define UBIFS_PADDING_BYTE 0xCE\n\n \n#define UBIFS_MAX_KEY_LEN 16\n\n \n#define UBIFS_SK_LEN 8\n\n \n#define UBIFS_MIN_FANOUT 3\n\n \n#define UBIFS_MAX_LEVELS 512\n\n \n#define UBIFS_MAX_INO_DATA UBIFS_BLOCK_SIZE\n\n \n#define UBIFS_LPT_FANOUT 4\n#define UBIFS_LPT_FANOUT_SHIFT 2\n\n \n#define UBIFS_LPT_CRC_BITS 16\n#define UBIFS_LPT_CRC_BYTES 2\n#define UBIFS_LPT_TYPE_BITS 4\n\n \n#define UBIFS_KEY_OFFSET offsetof(struct ubifs_ino_node, key)\n\n \n#define UBIFS_GC_HEAD   0\n \n#define UBIFS_BASE_HEAD 1\n \n#define UBIFS_DATA_HEAD 2\n\n \nenum {\n\tUBIFS_LPT_PNODE,\n\tUBIFS_LPT_NNODE,\n\tUBIFS_LPT_LTAB,\n\tUBIFS_LPT_LSAVE,\n\tUBIFS_LPT_NODE_CNT,\n\tUBIFS_LPT_NOT_A_NODE = (1 << UBIFS_LPT_TYPE_BITS) - 1,\n};\n\n \nenum {\n\tUBIFS_ITYPE_REG,\n\tUBIFS_ITYPE_DIR,\n\tUBIFS_ITYPE_LNK,\n\tUBIFS_ITYPE_BLK,\n\tUBIFS_ITYPE_CHR,\n\tUBIFS_ITYPE_FIFO,\n\tUBIFS_ITYPE_SOCK,\n\tUBIFS_ITYPES_CNT,\n};\n\n \nenum {\n\tUBIFS_KEY_HASH_R5,\n\tUBIFS_KEY_HASH_TEST,\n};\n\n \nenum {\n\tUBIFS_SIMPLE_KEY_FMT,\n};\n\n \n#define UBIFS_S_KEY_BLOCK_BITS 29\n#define UBIFS_S_KEY_BLOCK_MASK 0x1FFFFFFF\n#define UBIFS_S_KEY_HASH_BITS  UBIFS_S_KEY_BLOCK_BITS\n#define UBIFS_S_KEY_HASH_MASK  UBIFS_S_KEY_BLOCK_MASK\n\n \nenum {\n\tUBIFS_INO_KEY,\n\tUBIFS_DATA_KEY,\n\tUBIFS_DENT_KEY,\n\tUBIFS_XENT_KEY,\n\tUBIFS_KEY_TYPES_CNT,\n};\n\n \n#define UBIFS_SB_LEBS 1\n \n#define UBIFS_MST_LEBS 2\n\n \n#define UBIFS_SB_LNUM 0\n \n#define UBIFS_MST_LNUM (UBIFS_SB_LNUM + UBIFS_SB_LEBS)\n \n#define UBIFS_LOG_LNUM (UBIFS_MST_LNUM + UBIFS_MST_LEBS)\n\n \n\n \n#define UBIFS_MIN_LOG_LEBS 2\n \n#define UBIFS_MIN_BUD_LEBS 3\n \n#define UBIFS_MIN_JNL_LEBS (UBIFS_MIN_LOG_LEBS + UBIFS_MIN_BUD_LEBS)\n \n#define UBIFS_MIN_LPT_LEBS 2\n \n#define UBIFS_MIN_ORPH_LEBS 1\n \n#define UBIFS_MIN_MAIN_LEBS (UBIFS_MIN_BUD_LEBS + 6)\n\n \n#define UBIFS_MIN_LEB_CNT (UBIFS_SB_LEBS + UBIFS_MST_LEBS + \\\n\t\t\t   UBIFS_MIN_LOG_LEBS + UBIFS_MIN_LPT_LEBS + \\\n\t\t\t   UBIFS_MIN_ORPH_LEBS + UBIFS_MIN_MAIN_LEBS)\n\n \n#define UBIFS_CH_SZ        sizeof(struct ubifs_ch)\n#define UBIFS_INO_NODE_SZ  sizeof(struct ubifs_ino_node)\n#define UBIFS_DATA_NODE_SZ sizeof(struct ubifs_data_node)\n#define UBIFS_DENT_NODE_SZ sizeof(struct ubifs_dent_node)\n#define UBIFS_TRUN_NODE_SZ sizeof(struct ubifs_trun_node)\n#define UBIFS_PAD_NODE_SZ  sizeof(struct ubifs_pad_node)\n#define UBIFS_SB_NODE_SZ   sizeof(struct ubifs_sb_node)\n#define UBIFS_MST_NODE_SZ  sizeof(struct ubifs_mst_node)\n#define UBIFS_REF_NODE_SZ  sizeof(struct ubifs_ref_node)\n#define UBIFS_IDX_NODE_SZ  sizeof(struct ubifs_idx_node)\n#define UBIFS_CS_NODE_SZ   sizeof(struct ubifs_cs_node)\n#define UBIFS_ORPH_NODE_SZ sizeof(struct ubifs_orph_node)\n#define UBIFS_AUTH_NODE_SZ sizeof(struct ubifs_auth_node)\n#define UBIFS_SIG_NODE_SZ  sizeof(struct ubifs_sig_node)\n\n \n#define UBIFS_XENT_NODE_SZ UBIFS_DENT_NODE_SZ\n \n#define UBIFS_BRANCH_SZ    sizeof(struct ubifs_branch)\n\n \n#define UBIFS_MAX_DATA_NODE_SZ  (UBIFS_DATA_NODE_SZ + UBIFS_BLOCK_SIZE)\n#define UBIFS_MAX_INO_NODE_SZ   (UBIFS_INO_NODE_SZ + UBIFS_MAX_INO_DATA)\n#define UBIFS_MAX_DENT_NODE_SZ  (UBIFS_DENT_NODE_SZ + UBIFS_MAX_NLEN + 1)\n#define UBIFS_MAX_XENT_NODE_SZ  UBIFS_MAX_DENT_NODE_SZ\n\n \n#define UBIFS_MAX_NODE_SZ UBIFS_MAX_INO_NODE_SZ\n\n \n#define UBIFS_MAX_HASH_LEN 64\n\n \n#define UBIFS_MAX_HMAC_LEN 64\n\n \n#define UBIFS_XATTR_NAME_ENCRYPTION_CONTEXT \"c\"\n\n \n#define UBIFS_SIGNATURE_TYPE_PKCS7\t1\n\n \nenum {\n\tUBIFS_COMPR_FL     = 0x01,\n\tUBIFS_SYNC_FL      = 0x02,\n\tUBIFS_IMMUTABLE_FL = 0x04,\n\tUBIFS_APPEND_FL    = 0x08,\n\tUBIFS_DIRSYNC_FL   = 0x10,\n\tUBIFS_XATTR_FL     = 0x20,\n\tUBIFS_CRYPT_FL     = 0x40,\n};\n\n \n#define UBIFS_FL_MASK 0x0000001F\n\n \nenum {\n\tUBIFS_COMPR_NONE,\n\tUBIFS_COMPR_LZO,\n\tUBIFS_COMPR_ZLIB,\n\tUBIFS_COMPR_ZSTD,\n\tUBIFS_COMPR_TYPES_CNT,\n};\n\n \nenum {\n\tUBIFS_INO_NODE,\n\tUBIFS_DATA_NODE,\n\tUBIFS_DENT_NODE,\n\tUBIFS_XENT_NODE,\n\tUBIFS_TRUN_NODE,\n\tUBIFS_PAD_NODE,\n\tUBIFS_SB_NODE,\n\tUBIFS_MST_NODE,\n\tUBIFS_REF_NODE,\n\tUBIFS_IDX_NODE,\n\tUBIFS_CS_NODE,\n\tUBIFS_ORPH_NODE,\n\tUBIFS_AUTH_NODE,\n\tUBIFS_SIG_NODE,\n\tUBIFS_NODE_TYPES_CNT,\n};\n\n \nenum {\n\tUBIFS_MST_DIRTY = 1,\n\tUBIFS_MST_NO_ORPHS = 2,\n\tUBIFS_MST_RCVRY = 4,\n};\n\n \nenum {\n\tUBIFS_NO_NODE_GROUP = 0,\n\tUBIFS_IN_NODE_GROUP,\n\tUBIFS_LAST_OF_NODE_GROUP,\n};\n\n \nenum {\n\tUBIFS_FLG_BIGLPT = 0x02,\n\tUBIFS_FLG_SPACE_FIXUP = 0x04,\n\tUBIFS_FLG_DOUBLE_HASH = 0x08,\n\tUBIFS_FLG_ENCRYPTION = 0x10,\n\tUBIFS_FLG_AUTHENTICATION = 0x20,\n};\n\n#define UBIFS_FLG_MASK (UBIFS_FLG_BIGLPT | UBIFS_FLG_SPACE_FIXUP | \\\n\t\tUBIFS_FLG_DOUBLE_HASH | UBIFS_FLG_ENCRYPTION | \\\n\t\tUBIFS_FLG_AUTHENTICATION)\n\n \nstruct ubifs_ch {\n\t__le32 magic;\n\t__le32 crc;\n\t__le64 sqnum;\n\t__le32 len;\n\t__u8 node_type;\n\t__u8 group_type;\n\t__u8 padding[2];\n} __packed;\n\n \nunion ubifs_dev_desc {\n\t__le32 new;\n\t__le64 huge;\n} __packed;\n\n \nstruct ubifs_ino_node {\n\tstruct ubifs_ch ch;\n\t__u8 key[UBIFS_MAX_KEY_LEN];\n\t__le64 creat_sqnum;\n\t__le64 size;\n\t__le64 atime_sec;\n\t__le64 ctime_sec;\n\t__le64 mtime_sec;\n\t__le32 atime_nsec;\n\t__le32 ctime_nsec;\n\t__le32 mtime_nsec;\n\t__le32 nlink;\n\t__le32 uid;\n\t__le32 gid;\n\t__le32 mode;\n\t__le32 flags;\n\t__le32 data_len;\n\t__le32 xattr_cnt;\n\t__le32 xattr_size;\n\t__u8 padding1[4];  \n\t__le32 xattr_names;\n\t__le16 compr_type;\n\t__u8 padding2[26];  \n\t__u8 data[];\n} __packed;\n\n \nstruct ubifs_dent_node {\n\tstruct ubifs_ch ch;\n\t__u8 key[UBIFS_MAX_KEY_LEN];\n\t__le64 inum;\n\t__u8 padding1;\n\t__u8 type;\n\t__le16 nlen;\n\t__le32 cookie;\n\t__u8 name[];\n} __packed;\n\n \nstruct ubifs_data_node {\n\tstruct ubifs_ch ch;\n\t__u8 key[UBIFS_MAX_KEY_LEN];\n\t__le32 size;\n\t__le16 compr_type;\n\t__le16 compr_size;\n\t__u8 data[];\n} __packed;\n\n \nstruct ubifs_trun_node {\n\tstruct ubifs_ch ch;\n\t__le32 inum;\n\t__u8 padding[12];  \n\t__le64 old_size;\n\t__le64 new_size;\n} __packed;\n\n \nstruct ubifs_pad_node {\n\tstruct ubifs_ch ch;\n\t__le32 pad_len;\n} __packed;\n\n \nstruct ubifs_sb_node {\n\tstruct ubifs_ch ch;\n\t__u8 padding[2];\n\t__u8 key_hash;\n\t__u8 key_fmt;\n\t__le32 flags;\n\t__le32 min_io_size;\n\t__le32 leb_size;\n\t__le32 leb_cnt;\n\t__le32 max_leb_cnt;\n\t__le64 max_bud_bytes;\n\t__le32 log_lebs;\n\t__le32 lpt_lebs;\n\t__le32 orph_lebs;\n\t__le32 jhead_cnt;\n\t__le32 fanout;\n\t__le32 lsave_cnt;\n\t__le32 fmt_version;\n\t__le16 default_compr;\n\t__u8 padding1[2];\n\t__le32 rp_uid;\n\t__le32 rp_gid;\n\t__le64 rp_size;\n\t__le32 time_gran;\n\t__u8 uuid[16];\n\t__le32 ro_compat_version;\n\t__u8 hmac[UBIFS_MAX_HMAC_LEN];\n\t__u8 hmac_wkm[UBIFS_MAX_HMAC_LEN];\n\t__le16 hash_algo;\n\t__u8 hash_mst[UBIFS_MAX_HASH_LEN];\n\t__u8 padding2[3774];\n} __packed;\n\n \nstruct ubifs_mst_node {\n\tstruct ubifs_ch ch;\n\t__le64 highest_inum;\n\t__le64 cmt_no;\n\t__le32 flags;\n\t__le32 log_lnum;\n\t__le32 root_lnum;\n\t__le32 root_offs;\n\t__le32 root_len;\n\t__le32 gc_lnum;\n\t__le32 ihead_lnum;\n\t__le32 ihead_offs;\n\t__le64 index_size;\n\t__le64 total_free;\n\t__le64 total_dirty;\n\t__le64 total_used;\n\t__le64 total_dead;\n\t__le64 total_dark;\n\t__le32 lpt_lnum;\n\t__le32 lpt_offs;\n\t__le32 nhead_lnum;\n\t__le32 nhead_offs;\n\t__le32 ltab_lnum;\n\t__le32 ltab_offs;\n\t__le32 lsave_lnum;\n\t__le32 lsave_offs;\n\t__le32 lscan_lnum;\n\t__le32 empty_lebs;\n\t__le32 idx_lebs;\n\t__le32 leb_cnt;\n\t__u8 hash_root_idx[UBIFS_MAX_HASH_LEN];\n\t__u8 hash_lpt[UBIFS_MAX_HASH_LEN];\n\t__u8 hmac[UBIFS_MAX_HMAC_LEN];\n\t__u8 padding[152];\n} __packed;\n\n \nstruct ubifs_ref_node {\n\tstruct ubifs_ch ch;\n\t__le32 lnum;\n\t__le32 offs;\n\t__le32 jhead;\n\t__u8 padding[28];\n} __packed;\n\n \nstruct ubifs_auth_node {\n\tstruct ubifs_ch ch;\n\t__u8 hmac[];\n} __packed;\n\n \nstruct ubifs_sig_node {\n\tstruct ubifs_ch ch;\n\t__le32 type;\n\t__le32 len;\n\t__u8 padding[32];\n\t__u8 sig[];\n} __packed;\n\n \nstruct ubifs_branch {\n\t__le32 lnum;\n\t__le32 offs;\n\t__le32 len;\n\t__u8 key[];\n} __packed;\n\n \nstruct ubifs_idx_node {\n\tstruct ubifs_ch ch;\n\t__le16 child_cnt;\n\t__le16 level;\n\t__u8 branches[];\n} __packed;\n\n \nstruct ubifs_cs_node {\n\tstruct ubifs_ch ch;\n\t__le64 cmt_no;\n} __packed;\n\n \nstruct ubifs_orph_node {\n\tstruct ubifs_ch ch;\n\t__le64 cmt_no;\n\t__le64 inos[];\n} __packed;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}