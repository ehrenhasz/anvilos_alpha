{
  "module_name": "ecryptfs_kernel.h",
  "hash_id": "f870b8c7f62b59c559ab762499412670a7e49783c4fd1764c7cddf48b6d4df29",
  "original_prompt": "Ingested from linux-6.6.14/fs/ecryptfs/ecryptfs_kernel.h",
  "human_readable_source": " \n \n\n#ifndef ECRYPTFS_KERNEL_H\n#define ECRYPTFS_KERNEL_H\n\n#include <crypto/skcipher.h>\n#include <keys/user-type.h>\n#include <keys/encrypted-type.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/fs_stack.h>\n#include <linux/namei.h>\n#include <linux/scatterlist.h>\n#include <linux/hash.h>\n#include <linux/nsproxy.h>\n#include <linux/backing-dev.h>\n#include <linux/ecryptfs.h>\n\n#define ECRYPTFS_DEFAULT_IV_BYTES 16\n#define ECRYPTFS_DEFAULT_EXTENT_SIZE 4096\n#define ECRYPTFS_MINIMUM_HEADER_EXTENT_SIZE 8192\n#define ECRYPTFS_DEFAULT_MSG_CTX_ELEMS 32\n#define ECRYPTFS_DEFAULT_SEND_TIMEOUT HZ\n#define ECRYPTFS_MAX_MSG_CTX_TTL (HZ*3)\n#define ECRYPTFS_DEFAULT_NUM_USERS 4\n#define ECRYPTFS_MAX_NUM_USERS 32768\n#define ECRYPTFS_XATTR_NAME \"user.ecryptfs\"\n\nvoid ecryptfs_dump_auth_tok(struct ecryptfs_auth_tok *auth_tok);\nstatic inline void\necryptfs_to_hex(char *dst, char *src, size_t src_size)\n{\n\tchar *end = bin2hex(dst, src, src_size);\n\t*end = '\\0';\n}\n\nextern void ecryptfs_from_hex(char *dst, char *src, int dst_size);\n\nstruct ecryptfs_key_record {\n\tunsigned char type;\n\tsize_t enc_key_size;\n\tunsigned char sig[ECRYPTFS_SIG_SIZE];\n\tunsigned char enc_key[ECRYPTFS_MAX_ENCRYPTED_KEY_BYTES];\n};\n\nstruct ecryptfs_auth_tok_list {\n\tstruct ecryptfs_auth_tok *auth_tok;\n\tstruct list_head list;\n};\n\nstruct ecryptfs_crypt_stat;\nstruct ecryptfs_mount_crypt_stat;\n\nstruct ecryptfs_page_crypt_context {\n\tstruct page *page;\n#define ECRYPTFS_PREPARE_COMMIT_MODE 0\n#define ECRYPTFS_WRITEPAGE_MODE      1\n\tunsigned int mode;\n\tunion {\n\t\tstruct file *lower_file;\n\t\tstruct writeback_control *wbc;\n\t} param;\n};\n\n#if defined(CONFIG_ENCRYPTED_KEYS) || defined(CONFIG_ENCRYPTED_KEYS_MODULE)\nstatic inline struct ecryptfs_auth_tok *\necryptfs_get_encrypted_key_payload_data(struct key *key)\n{\n\tstruct encrypted_key_payload *payload;\n\n\tif (key->type != &key_type_encrypted)\n\t\treturn NULL;\n\n\tpayload = key->payload.data[0];\n\tif (!payload)\n\t\treturn ERR_PTR(-EKEYREVOKED);\n\n\treturn (struct ecryptfs_auth_tok *)payload->payload_data;\n}\n\nstatic inline struct key *ecryptfs_get_encrypted_key(char *sig)\n{\n\treturn request_key(&key_type_encrypted, sig, NULL);\n}\n\n#else\nstatic inline struct ecryptfs_auth_tok *\necryptfs_get_encrypted_key_payload_data(struct key *key)\n{\n\treturn NULL;\n}\n\nstatic inline struct key *ecryptfs_get_encrypted_key(char *sig)\n{\n\treturn ERR_PTR(-ENOKEY);\n}\n\n#endif  \n\nstatic inline struct ecryptfs_auth_tok *\necryptfs_get_key_payload_data(struct key *key)\n{\n\tstruct ecryptfs_auth_tok *auth_tok;\n\tstruct user_key_payload *ukp;\n\n\tauth_tok = ecryptfs_get_encrypted_key_payload_data(key);\n\tif (auth_tok)\n\t\treturn auth_tok;\n\n\tukp = user_key_payload_locked(key);\n\tif (!ukp)\n\t\treturn ERR_PTR(-EKEYREVOKED);\n\n\treturn (struct ecryptfs_auth_tok *)ukp->data;\n}\n\n#define ECRYPTFS_MAX_KEYSET_SIZE 1024\n#define ECRYPTFS_MAX_CIPHER_NAME_SIZE 31\n#define ECRYPTFS_MAX_NUM_ENC_KEYS 64\n#define ECRYPTFS_MAX_IV_BYTES 16\t \n#define ECRYPTFS_SALT_BYTES 2\n#define MAGIC_ECRYPTFS_MARKER 0x3c81b7f5\n#define MAGIC_ECRYPTFS_MARKER_SIZE_BYTES 8\t \n#define ECRYPTFS_FILE_SIZE_BYTES (sizeof(u64))\n#define ECRYPTFS_SIZE_AND_MARKER_BYTES (ECRYPTFS_FILE_SIZE_BYTES \\\n\t\t\t\t\t+ MAGIC_ECRYPTFS_MARKER_SIZE_BYTES)\n#define ECRYPTFS_DEFAULT_CIPHER \"aes\"\n#define ECRYPTFS_DEFAULT_KEY_BYTES 16\n#define ECRYPTFS_DEFAULT_HASH \"md5\"\n#define ECRYPTFS_TAG_70_DIGEST ECRYPTFS_DEFAULT_HASH\n#define ECRYPTFS_TAG_1_PACKET_TYPE 0x01\n#define ECRYPTFS_TAG_3_PACKET_TYPE 0x8C\n#define ECRYPTFS_TAG_11_PACKET_TYPE 0xED\n#define ECRYPTFS_TAG_64_PACKET_TYPE 0x40\n#define ECRYPTFS_TAG_65_PACKET_TYPE 0x41\n#define ECRYPTFS_TAG_66_PACKET_TYPE 0x42\n#define ECRYPTFS_TAG_67_PACKET_TYPE 0x43\n#define ECRYPTFS_TAG_70_PACKET_TYPE 0x46  \n#define ECRYPTFS_TAG_71_PACKET_TYPE 0x47  \n#define ECRYPTFS_TAG_72_PACKET_TYPE 0x48  \n#define ECRYPTFS_TAG_73_PACKET_TYPE 0x49  \n#define ECRYPTFS_MIN_PKT_LEN_SIZE 1  \n#define ECRYPTFS_MAX_PKT_LEN_SIZE 2  \n \n#define ECRYPTFS_FILENAME_MIN_RANDOM_PREPEND_BYTES 16\n#define ECRYPTFS_NON_NULL 0x42  \n#define MD5_DIGEST_SIZE 16\n#define ECRYPTFS_TAG_70_DIGEST_SIZE MD5_DIGEST_SIZE\n#define ECRYPTFS_TAG_70_MIN_METADATA_SIZE (1 + ECRYPTFS_MIN_PKT_LEN_SIZE \\\n\t\t\t\t\t   + ECRYPTFS_SIG_SIZE + 1 + 1)\n#define ECRYPTFS_TAG_70_MAX_METADATA_SIZE (1 + ECRYPTFS_MAX_PKT_LEN_SIZE \\\n\t\t\t\t\t   + ECRYPTFS_SIG_SIZE + 1 + 1)\n#define ECRYPTFS_FEK_ENCRYPTED_FILENAME_PREFIX \"ECRYPTFS_FEK_ENCRYPTED.\"\n#define ECRYPTFS_FEK_ENCRYPTED_FILENAME_PREFIX_SIZE 23\n#define ECRYPTFS_FNEK_ENCRYPTED_FILENAME_PREFIX \"ECRYPTFS_FNEK_ENCRYPTED.\"\n#define ECRYPTFS_FNEK_ENCRYPTED_FILENAME_PREFIX_SIZE 24\n#define ECRYPTFS_ENCRYPTED_DENTRY_NAME_LEN (18 + 1 + 4 + 1 + 32)\n\n#ifdef CONFIG_ECRYPT_FS_MESSAGING\n# define ECRYPTFS_VERSIONING_MASK_MESSAGING (ECRYPTFS_VERSIONING_DEVMISC \\\n\t\t\t\t\t     | ECRYPTFS_VERSIONING_PUBKEY)\n#else\n# define ECRYPTFS_VERSIONING_MASK_MESSAGING 0\n#endif\n\n#define ECRYPTFS_VERSIONING_MASK (ECRYPTFS_VERSIONING_PASSPHRASE \\\n\t\t\t\t  | ECRYPTFS_VERSIONING_PLAINTEXT_PASSTHROUGH \\\n\t\t\t\t  | ECRYPTFS_VERSIONING_XATTR \\\n\t\t\t\t  | ECRYPTFS_VERSIONING_MULTKEY \\\n\t\t\t\t  | ECRYPTFS_VERSIONING_MASK_MESSAGING \\\n\t\t\t\t  | ECRYPTFS_VERSIONING_FILENAME_ENCRYPTION)\nstruct ecryptfs_key_sig {\n\tstruct list_head crypt_stat_list;\n\tchar keysig[ECRYPTFS_SIG_SIZE_HEX + 1];\n};\n\nstruct ecryptfs_filename {\n\tstruct list_head crypt_stat_list;\n#define ECRYPTFS_FILENAME_CONTAINS_DECRYPTED 0x00000001\n\tu32 flags;\n\tu32 seq_no;\n\tchar *filename;\n\tchar *encrypted_filename;\n\tsize_t filename_size;\n\tsize_t encrypted_filename_size;\n\tchar fnek_sig[ECRYPTFS_SIG_SIZE_HEX];\n\tchar dentry_name[ECRYPTFS_ENCRYPTED_DENTRY_NAME_LEN + 1];\n};\n\n \nstruct ecryptfs_crypt_stat {\n#define ECRYPTFS_STRUCT_INITIALIZED   0x00000001\n#define ECRYPTFS_POLICY_APPLIED       0x00000002\n#define ECRYPTFS_ENCRYPTED            0x00000004\n#define ECRYPTFS_SECURITY_WARNING     0x00000008\n#define ECRYPTFS_ENABLE_HMAC          0x00000010\n#define ECRYPTFS_ENCRYPT_IV_PAGES     0x00000020\n#define ECRYPTFS_KEY_VALID            0x00000040\n#define ECRYPTFS_METADATA_IN_XATTR    0x00000080\n#define ECRYPTFS_VIEW_AS_ENCRYPTED    0x00000100\n#define ECRYPTFS_KEY_SET              0x00000200\n#define ECRYPTFS_ENCRYPT_FILENAMES    0x00000400\n#define ECRYPTFS_ENCFN_USE_MOUNT_FNEK 0x00000800\n#define ECRYPTFS_ENCFN_USE_FEK        0x00001000\n#define ECRYPTFS_UNLINK_SIGS          0x00002000\n#define ECRYPTFS_I_SIZE_INITIALIZED   0x00004000\n\tu32 flags;\n\tunsigned int file_version;\n\tsize_t iv_bytes;\n\tsize_t metadata_size;\n\tsize_t extent_size;  \n\tsize_t key_size;\n\tsize_t extent_shift;\n\tunsigned int extent_mask;\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat;\n\tstruct crypto_skcipher *tfm;\n\tstruct crypto_shash *hash_tfm;  \n\tunsigned char cipher[ECRYPTFS_MAX_CIPHER_NAME_SIZE + 1];\n\tunsigned char key[ECRYPTFS_MAX_KEY_BYTES];\n\tunsigned char root_iv[ECRYPTFS_MAX_IV_BYTES];\n\tstruct list_head keysig_list;\n\tstruct mutex keysig_list_mutex;\n\tstruct mutex cs_tfm_mutex;\n\tstruct mutex cs_mutex;\n};\n\n \nstruct ecryptfs_inode_info {\n\tstruct inode vfs_inode;\n\tstruct inode *wii_inode;\n\tstruct mutex lower_file_mutex;\n\tatomic_t lower_file_count;\n\tstruct file *lower_file;\n\tstruct ecryptfs_crypt_stat crypt_stat;\n};\n\n \nstruct ecryptfs_dentry_info {\n\tstruct path lower_path;\n\tstruct rcu_head rcu;\n};\n\n \nstruct ecryptfs_global_auth_tok {\n#define ECRYPTFS_AUTH_TOK_INVALID 0x00000001\n#define ECRYPTFS_AUTH_TOK_FNEK    0x00000002\n\tu32 flags;\n\tstruct list_head mount_crypt_stat_list;\n\tstruct key *global_auth_tok_key;\n\tunsigned char sig[ECRYPTFS_SIG_SIZE_HEX + 1];\n};\n\n \nstruct ecryptfs_key_tfm {\n\tstruct crypto_skcipher *key_tfm;\n\tsize_t key_size;\n\tstruct mutex key_tfm_mutex;\n\tstruct list_head key_tfm_list;\n\tunsigned char cipher_name[ECRYPTFS_MAX_CIPHER_NAME_SIZE + 1];\n};\n\nextern struct mutex key_tfm_list_mutex;\n\n \nstruct ecryptfs_mount_crypt_stat {\n\t \n#define ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED 0x00000001\n#define ECRYPTFS_XATTR_METADATA_ENABLED        0x00000002\n#define ECRYPTFS_ENCRYPTED_VIEW_ENABLED        0x00000004\n#define ECRYPTFS_MOUNT_CRYPT_STAT_INITIALIZED  0x00000008\n#define ECRYPTFS_GLOBAL_ENCRYPT_FILENAMES      0x00000010\n#define ECRYPTFS_GLOBAL_ENCFN_USE_MOUNT_FNEK   0x00000020\n#define ECRYPTFS_GLOBAL_ENCFN_USE_FEK          0x00000040\n#define ECRYPTFS_GLOBAL_MOUNT_AUTH_TOK_ONLY    0x00000080\n\tu32 flags;\n\tstruct list_head global_auth_tok_list;\n\tstruct mutex global_auth_tok_list_mutex;\n\tsize_t global_default_cipher_key_size;\n\tsize_t global_default_fn_cipher_key_bytes;\n\tunsigned char global_default_cipher_name[ECRYPTFS_MAX_CIPHER_NAME_SIZE\n\t\t\t\t\t\t + 1];\n\tunsigned char global_default_fn_cipher_name[\n\t\tECRYPTFS_MAX_CIPHER_NAME_SIZE + 1];\n\tchar global_default_fnek_sig[ECRYPTFS_SIG_SIZE_HEX + 1];\n};\n\n \nstruct ecryptfs_sb_info {\n\tstruct super_block *wsi_sb;\n\tstruct ecryptfs_mount_crypt_stat mount_crypt_stat;\n};\n\n \nstruct ecryptfs_file_info {\n\tstruct file *wfi_file;\n\tstruct ecryptfs_crypt_stat *crypt_stat;\n};\n\n \nstruct ecryptfs_auth_tok_list_item {\n\tunsigned char encrypted_session_key[ECRYPTFS_MAX_KEY_BYTES];\n\tstruct list_head list;\n\tstruct ecryptfs_auth_tok auth_tok;\n};\n\nstruct ecryptfs_message {\n\t \n\t \n\t \n\tu32 index;\n\tu32 data_len;\n\tu8 data[];\n};\n\nstruct ecryptfs_msg_ctx {\n#define ECRYPTFS_MSG_CTX_STATE_FREE     0x01\n#define ECRYPTFS_MSG_CTX_STATE_PENDING  0x02\n#define ECRYPTFS_MSG_CTX_STATE_DONE     0x03\n#define ECRYPTFS_MSG_CTX_STATE_NO_REPLY 0x04\n\tu8 state;\n#define ECRYPTFS_MSG_HELO 100\n#define ECRYPTFS_MSG_QUIT 101\n#define ECRYPTFS_MSG_REQUEST 102\n#define ECRYPTFS_MSG_RESPONSE 103\n\tu8 type;\n\tu32 index;\n\t \n\tu32 counter;\n\tsize_t msg_size;\n\tstruct ecryptfs_message *msg;\n\tstruct task_struct *task;\n\tstruct list_head node;\n\tstruct list_head daemon_out_list;\n\tstruct mutex mux;\n};\n\nstruct ecryptfs_daemon {\n#define ECRYPTFS_DAEMON_IN_READ      0x00000001\n#define ECRYPTFS_DAEMON_IN_POLL      0x00000002\n#define ECRYPTFS_DAEMON_ZOMBIE       0x00000004\n#define ECRYPTFS_DAEMON_MISCDEV_OPEN 0x00000008\n\tu32 flags;\n\tu32 num_queued_msg_ctx;\n\tstruct file *file;\n\tstruct mutex mux;\n\tstruct list_head msg_ctx_out_queue;\n\twait_queue_head_t wait;\n\tstruct hlist_node euid_chain;\n};\n\n#ifdef CONFIG_ECRYPT_FS_MESSAGING\nextern struct mutex ecryptfs_daemon_hash_mux;\n#endif\n\nstatic inline size_t\necryptfs_lower_header_size(struct ecryptfs_crypt_stat *crypt_stat)\n{\n\tif (crypt_stat->flags & ECRYPTFS_METADATA_IN_XATTR)\n\t\treturn 0;\n\treturn crypt_stat->metadata_size;\n}\n\nstatic inline struct ecryptfs_file_info *\necryptfs_file_to_private(struct file *file)\n{\n\treturn file->private_data;\n}\n\nstatic inline void\necryptfs_set_file_private(struct file *file,\n\t\t\t  struct ecryptfs_file_info *file_info)\n{\n\tfile->private_data = file_info;\n}\n\nstatic inline struct file *ecryptfs_file_to_lower(struct file *file)\n{\n\treturn ((struct ecryptfs_file_info *)file->private_data)->wfi_file;\n}\n\nstatic inline void\necryptfs_set_file_lower(struct file *file, struct file *lower_file)\n{\n\t((struct ecryptfs_file_info *)file->private_data)->wfi_file =\n\t\tlower_file;\n}\n\nstatic inline struct ecryptfs_inode_info *\necryptfs_inode_to_private(struct inode *inode)\n{\n\treturn container_of(inode, struct ecryptfs_inode_info, vfs_inode);\n}\n\nstatic inline struct inode *ecryptfs_inode_to_lower(struct inode *inode)\n{\n\treturn ecryptfs_inode_to_private(inode)->wii_inode;\n}\n\nstatic inline void\necryptfs_set_inode_lower(struct inode *inode, struct inode *lower_inode)\n{\n\tecryptfs_inode_to_private(inode)->wii_inode = lower_inode;\n}\n\nstatic inline struct ecryptfs_sb_info *\necryptfs_superblock_to_private(struct super_block *sb)\n{\n\treturn (struct ecryptfs_sb_info *)sb->s_fs_info;\n}\n\nstatic inline void\necryptfs_set_superblock_private(struct super_block *sb,\n\t\t\t\tstruct ecryptfs_sb_info *sb_info)\n{\n\tsb->s_fs_info = sb_info;\n}\n\nstatic inline struct super_block *\necryptfs_superblock_to_lower(struct super_block *sb)\n{\n\treturn ((struct ecryptfs_sb_info *)sb->s_fs_info)->wsi_sb;\n}\n\nstatic inline void\necryptfs_set_superblock_lower(struct super_block *sb,\n\t\t\t      struct super_block *lower_sb)\n{\n\t((struct ecryptfs_sb_info *)sb->s_fs_info)->wsi_sb = lower_sb;\n}\n\nstatic inline void\necryptfs_set_dentry_private(struct dentry *dentry,\n\t\t\t    struct ecryptfs_dentry_info *dentry_info)\n{\n\tdentry->d_fsdata = dentry_info;\n}\n\nstatic inline struct dentry *\necryptfs_dentry_to_lower(struct dentry *dentry)\n{\n\treturn ((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path.dentry;\n}\n\nstatic inline const struct path *\necryptfs_dentry_to_lower_path(struct dentry *dentry)\n{\n\treturn &((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path;\n}\n\n#define ecryptfs_printk(type, fmt, arg...) \\\n        __ecryptfs_printk(type \"%s: \" fmt, __func__, ## arg)\n__printf(1, 2)\nvoid __ecryptfs_printk(const char *fmt, ...);\n\nextern const struct file_operations ecryptfs_main_fops;\nextern const struct file_operations ecryptfs_dir_fops;\nextern const struct inode_operations ecryptfs_main_iops;\nextern const struct inode_operations ecryptfs_dir_iops;\nextern const struct inode_operations ecryptfs_symlink_iops;\nextern const struct super_operations ecryptfs_sops;\nextern const struct dentry_operations ecryptfs_dops;\nextern const struct address_space_operations ecryptfs_aops;\nextern int ecryptfs_verbosity;\nextern unsigned int ecryptfs_message_buf_len;\nextern signed long ecryptfs_message_wait_timeout;\nextern unsigned int ecryptfs_number_of_users;\n\nextern struct kmem_cache *ecryptfs_auth_tok_list_item_cache;\nextern struct kmem_cache *ecryptfs_file_info_cache;\nextern struct kmem_cache *ecryptfs_dentry_info_cache;\nextern struct kmem_cache *ecryptfs_inode_info_cache;\nextern struct kmem_cache *ecryptfs_sb_info_cache;\nextern struct kmem_cache *ecryptfs_header_cache;\nextern struct kmem_cache *ecryptfs_xattr_cache;\nextern struct kmem_cache *ecryptfs_key_record_cache;\nextern struct kmem_cache *ecryptfs_key_sig_cache;\nextern struct kmem_cache *ecryptfs_global_auth_tok_cache;\nextern struct kmem_cache *ecryptfs_key_tfm_cache;\n\nstruct inode *ecryptfs_get_inode(struct inode *lower_inode,\n\t\t\t\t struct super_block *sb);\nvoid ecryptfs_i_size_init(const char *page_virt, struct inode *inode);\nint ecryptfs_initialize_file(struct dentry *ecryptfs_dentry,\n\t\t\t     struct inode *ecryptfs_inode);\nint ecryptfs_decode_and_decrypt_filename(char **decrypted_name,\n\t\t\t\t\t size_t *decrypted_name_size,\n\t\t\t\t\t struct super_block *sb,\n\t\t\t\t\t const char *name, size_t name_size);\nint ecryptfs_fill_zeros(struct file *file, loff_t new_length);\nint ecryptfs_encrypt_and_encode_filename(\n\tchar **encoded_name,\n\tsize_t *encoded_name_size,\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat,\n\tconst char *name, size_t name_size);\nstruct dentry *ecryptfs_lower_dentry(struct dentry *this_dentry);\nvoid ecryptfs_dump_hex(char *data, int bytes);\nint virt_to_scatterlist(const void *addr, int size, struct scatterlist *sg,\n\t\t\tint sg_size);\nint ecryptfs_compute_root_iv(struct ecryptfs_crypt_stat *crypt_stat);\nvoid ecryptfs_rotate_iv(unsigned char *iv);\nint ecryptfs_init_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat);\nvoid ecryptfs_destroy_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat);\nvoid ecryptfs_destroy_mount_crypt_stat(\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat);\nint ecryptfs_init_crypt_ctx(struct ecryptfs_crypt_stat *crypt_stat);\nint ecryptfs_write_inode_size_to_metadata(struct inode *ecryptfs_inode);\nint ecryptfs_encrypt_page(struct page *page);\nint ecryptfs_decrypt_page(struct page *page);\nint ecryptfs_write_metadata(struct dentry *ecryptfs_dentry,\n\t\t\t    struct inode *ecryptfs_inode);\nint ecryptfs_read_metadata(struct dentry *ecryptfs_dentry);\nint ecryptfs_new_file_context(struct inode *ecryptfs_inode);\nvoid ecryptfs_write_crypt_stat_flags(char *page_virt,\n\t\t\t\t     struct ecryptfs_crypt_stat *crypt_stat,\n\t\t\t\t     size_t *written);\nint ecryptfs_read_and_validate_header_region(struct inode *inode);\nint ecryptfs_read_and_validate_xattr_region(struct dentry *dentry,\n\t\t\t\t\t    struct inode *inode);\nu8 ecryptfs_code_for_cipher_string(char *cipher_name, size_t key_bytes);\nint ecryptfs_cipher_code_to_string(char *str, u8 cipher_code);\nvoid ecryptfs_set_default_sizes(struct ecryptfs_crypt_stat *crypt_stat);\nint ecryptfs_generate_key_packet_set(char *dest_base,\n\t\t\t\t     struct ecryptfs_crypt_stat *crypt_stat,\n\t\t\t\t     struct dentry *ecryptfs_dentry,\n\t\t\t\t     size_t *len, size_t max);\nint\necryptfs_parse_packet_set(struct ecryptfs_crypt_stat *crypt_stat,\n\t\t\t  unsigned char *src, struct dentry *ecryptfs_dentry);\nint ecryptfs_truncate(struct dentry *dentry, loff_t new_length);\nssize_t\necryptfs_getxattr_lower(struct dentry *lower_dentry, struct inode *lower_inode,\n\t\t\tconst char *name, void *value, size_t size);\nint\necryptfs_setxattr(struct dentry *dentry, struct inode *inode, const char *name,\n\t\t  const void *value, size_t size, int flags);\nint ecryptfs_read_xattr_region(char *page_virt, struct inode *ecryptfs_inode);\n#ifdef CONFIG_ECRYPT_FS_MESSAGING\nint ecryptfs_process_response(struct ecryptfs_daemon *daemon,\n\t\t\t      struct ecryptfs_message *msg, u32 seq);\nint ecryptfs_send_message(char *data, int data_len,\n\t\t\t  struct ecryptfs_msg_ctx **msg_ctx);\nint ecryptfs_wait_for_response(struct ecryptfs_msg_ctx *msg_ctx,\n\t\t\t       struct ecryptfs_message **emsg);\nint ecryptfs_init_messaging(void);\nvoid ecryptfs_release_messaging(void);\n#else\nstatic inline int ecryptfs_init_messaging(void)\n{\n\treturn 0;\n}\nstatic inline void ecryptfs_release_messaging(void)\n{ }\nstatic inline int ecryptfs_send_message(char *data, int data_len,\n\t\t\t\t\tstruct ecryptfs_msg_ctx **msg_ctx)\n{\n\treturn -ENOTCONN;\n}\nstatic inline int ecryptfs_wait_for_response(struct ecryptfs_msg_ctx *msg_ctx,\n\t\t\t\t\t     struct ecryptfs_message **emsg)\n{\n\treturn -ENOMSG;\n}\n#endif\n\nvoid\necryptfs_write_header_metadata(char *virt,\n\t\t\t       struct ecryptfs_crypt_stat *crypt_stat,\n\t\t\t       size_t *written);\nint ecryptfs_add_keysig(struct ecryptfs_crypt_stat *crypt_stat, char *sig);\nint\necryptfs_add_global_auth_tok(struct ecryptfs_mount_crypt_stat *mount_crypt_stat,\n\t\t\t   char *sig, u32 global_auth_tok_flags);\nint ecryptfs_get_global_auth_tok_for_sig(\n\tstruct ecryptfs_global_auth_tok **global_auth_tok,\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat, char *sig);\nint\necryptfs_add_new_key_tfm(struct ecryptfs_key_tfm **key_tfm, char *cipher_name,\n\t\t\t size_t key_size);\nint ecryptfs_init_crypto(void);\nint ecryptfs_destroy_crypto(void);\nint ecryptfs_tfm_exists(char *cipher_name, struct ecryptfs_key_tfm **key_tfm);\nint ecryptfs_get_tfm_and_mutex_for_cipher_name(struct crypto_skcipher **tfm,\n\t\t\t\t\t       struct mutex **tfm_mutex,\n\t\t\t\t\t       char *cipher_name);\nint ecryptfs_keyring_auth_tok_for_sig(struct key **auth_tok_key,\n\t\t\t\t      struct ecryptfs_auth_tok **auth_tok,\n\t\t\t\t      char *sig);\nint ecryptfs_write_lower(struct inode *ecryptfs_inode, char *data,\n\t\t\t loff_t offset, size_t size);\nint ecryptfs_write_lower_page_segment(struct inode *ecryptfs_inode,\n\t\t\t\t      struct page *page_for_lower,\n\t\t\t\t      size_t offset_in_page, size_t size);\nint ecryptfs_write(struct inode *inode, char *data, loff_t offset, size_t size);\nint ecryptfs_read_lower(char *data, loff_t offset, size_t size,\n\t\t\tstruct inode *ecryptfs_inode);\nint ecryptfs_read_lower_page_segment(struct page *page_for_ecryptfs,\n\t\t\t\t     pgoff_t page_index,\n\t\t\t\t     size_t offset_in_page, size_t size,\n\t\t\t\t     struct inode *ecryptfs_inode);\nstruct page *ecryptfs_get_locked_page(struct inode *inode, loff_t index);\nint ecryptfs_parse_packet_length(unsigned char *data, size_t *size,\n\t\t\t\t size_t *length_size);\nint ecryptfs_write_packet_length(char *dest, size_t size,\n\t\t\t\t size_t *packet_size_length);\n#ifdef CONFIG_ECRYPT_FS_MESSAGING\nint ecryptfs_init_ecryptfs_miscdev(void);\nvoid ecryptfs_destroy_ecryptfs_miscdev(void);\nint ecryptfs_send_miscdev(char *data, size_t data_size,\n\t\t\t  struct ecryptfs_msg_ctx *msg_ctx, u8 msg_type,\n\t\t\t  u16 msg_flags, struct ecryptfs_daemon *daemon);\nvoid ecryptfs_msg_ctx_alloc_to_free(struct ecryptfs_msg_ctx *msg_ctx);\nint\necryptfs_spawn_daemon(struct ecryptfs_daemon **daemon, struct file *file);\nint ecryptfs_exorcise_daemon(struct ecryptfs_daemon *daemon);\nint ecryptfs_find_daemon_by_euid(struct ecryptfs_daemon **daemon);\n#endif\nint ecryptfs_init_kthread(void);\nvoid ecryptfs_destroy_kthread(void);\nint ecryptfs_privileged_open(struct file **lower_file,\n\t\t\t     struct dentry *lower_dentry,\n\t\t\t     struct vfsmount *lower_mnt,\n\t\t\t     const struct cred *cred);\nint ecryptfs_get_lower_file(struct dentry *dentry, struct inode *inode);\nvoid ecryptfs_put_lower_file(struct inode *inode);\nint\necryptfs_write_tag_70_packet(char *dest, size_t *remaining_bytes,\n\t\t\t     size_t *packet_size,\n\t\t\t     struct ecryptfs_mount_crypt_stat *mount_crypt_stat,\n\t\t\t     char *filename, size_t filename_size);\nint\necryptfs_parse_tag_70_packet(char **filename, size_t *filename_size,\n\t\t\t     size_t *packet_size,\n\t\t\t     struct ecryptfs_mount_crypt_stat *mount_crypt_stat,\n\t\t\t     char *data, size_t max_packet_size);\nint ecryptfs_set_f_namelen(long *namelen, long lower_namelen,\n\t\t\t   struct ecryptfs_mount_crypt_stat *mount_crypt_stat);\nint ecryptfs_derive_iv(char *iv, struct ecryptfs_crypt_stat *crypt_stat,\n\t\t       loff_t offset);\n\nextern const struct xattr_handler *ecryptfs_xattr_handlers[];\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}