{
  "module_name": "debug.c",
  "hash_id": "b77abdb97630d3ff2be220f025573234284af7df566aeab99f8a81919be98930",
  "original_prompt": "Ingested from linux-6.6.14/fs/ecryptfs/debug.c",
  "human_readable_source": "\n \n\n#include \"ecryptfs_kernel.h\"\n\n \nvoid ecryptfs_dump_auth_tok(struct ecryptfs_auth_tok *auth_tok)\n{\n\tchar salt[ECRYPTFS_SALT_SIZE * 2 + 1];\n\tchar sig[ECRYPTFS_SIG_SIZE_HEX + 1];\n\n\tecryptfs_printk(KERN_DEBUG, \"Auth tok at mem loc [%p]:\\n\",\n\t\t\tauth_tok);\n\tif (auth_tok->flags & ECRYPTFS_PRIVATE_KEY) {\n\t\tecryptfs_printk(KERN_DEBUG, \" * private key type\\n\");\n\t} else {\n\t\tecryptfs_printk(KERN_DEBUG, \" * passphrase type\\n\");\n\t\tecryptfs_to_hex(salt, auth_tok->token.password.salt,\n\t\t\t\tECRYPTFS_SALT_SIZE);\n\t\tsalt[ECRYPTFS_SALT_SIZE * 2] = '\\0';\n\t\tecryptfs_printk(KERN_DEBUG, \" * salt = [%s]\\n\", salt);\n\t\tif (auth_tok->token.password.flags &\n\t\t    ECRYPTFS_PERSISTENT_PASSWORD) {\n\t\t\tecryptfs_printk(KERN_DEBUG, \" * persistent\\n\");\n\t\t}\n\t\tmemcpy(sig, auth_tok->token.password.signature,\n\t\t       ECRYPTFS_SIG_SIZE_HEX);\n\t\tsig[ECRYPTFS_SIG_SIZE_HEX] = '\\0';\n\t\tecryptfs_printk(KERN_DEBUG, \" * signature = [%s]\\n\", sig);\n\t}\n\tecryptfs_printk(KERN_DEBUG, \" * session_key.flags = [0x%x]\\n\",\n\t\t\tauth_tok->session_key.flags);\n\tif (auth_tok->session_key.flags\n\t    & ECRYPTFS_USERSPACE_SHOULD_TRY_TO_DECRYPT)\n\t\tecryptfs_printk(KERN_DEBUG,\n\t\t\t\t\" * Userspace decrypt request set\\n\");\n\tif (auth_tok->session_key.flags\n\t    & ECRYPTFS_USERSPACE_SHOULD_TRY_TO_ENCRYPT)\n\t\tecryptfs_printk(KERN_DEBUG,\n\t\t\t\t\" * Userspace encrypt request set\\n\");\n\tif (auth_tok->session_key.flags & ECRYPTFS_CONTAINS_DECRYPTED_KEY) {\n\t\tecryptfs_printk(KERN_DEBUG, \" * Contains decrypted key\\n\");\n\t\tecryptfs_printk(KERN_DEBUG,\n\t\t\t\t\" * session_key.decrypted_key_size = [0x%x]\\n\",\n\t\t\t\tauth_tok->session_key.decrypted_key_size);\n\t\tecryptfs_printk(KERN_DEBUG, \" * Decrypted session key \"\n\t\t\t\t\"dump:\\n\");\n\t\tif (ecryptfs_verbosity > 0)\n\t\t\tecryptfs_dump_hex(auth_tok->session_key.decrypted_key,\n\t\t\t\t\t  ECRYPTFS_DEFAULT_KEY_BYTES);\n\t}\n\tif (auth_tok->session_key.flags & ECRYPTFS_CONTAINS_ENCRYPTED_KEY) {\n\t\tecryptfs_printk(KERN_DEBUG, \" * Contains encrypted key\\n\");\n\t\tecryptfs_printk(KERN_DEBUG,\n\t\t\t\t\" * session_key.encrypted_key_size = [0x%x]\\n\",\n\t\t\t\tauth_tok->session_key.encrypted_key_size);\n\t\tecryptfs_printk(KERN_DEBUG, \" * Encrypted session key \"\n\t\t\t\t\"dump:\\n\");\n\t\tif (ecryptfs_verbosity > 0)\n\t\t\tecryptfs_dump_hex(auth_tok->session_key.encrypted_key,\n\t\t\t\t\t  auth_tok->session_key.\n\t\t\t\t\t  encrypted_key_size);\n\t}\n}\n\n \nvoid ecryptfs_dump_hex(char *data, int bytes)\n{\n\tif (ecryptfs_verbosity < 1)\n\t\treturn;\n\n\tprint_hex_dump(KERN_DEBUG, \"ecryptfs: \", DUMP_PREFIX_OFFSET, 16, 1,\n\t\t       data, bytes, false);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}