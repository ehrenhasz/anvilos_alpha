{
  "module_name": "xfs_trans_priv.h",
  "hash_id": "a247bea8a20182f7e1e50a006b5ad321aff898061e32caaf02a208ebace0f291",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/xfs_trans_priv.h",
  "human_readable_source": "\n \n#ifndef __XFS_TRANS_PRIV_H__\n#define\t__XFS_TRANS_PRIV_H__\n\nstruct xlog;\nstruct xfs_log_item;\nstruct xfs_mount;\nstruct xfs_trans;\nstruct xfs_ail;\nstruct xfs_log_vec;\n\n\nvoid\txfs_trans_init(struct xfs_mount *);\nvoid\txfs_trans_add_item(struct xfs_trans *, struct xfs_log_item *);\nvoid\txfs_trans_del_item(struct xfs_log_item *);\nvoid\txfs_trans_unreserve_and_mod_sb(struct xfs_trans *tp);\n\nvoid\txfs_trans_committed_bulk(struct xfs_ail *ailp,\n\t\t\t\tstruct list_head *lv_chain,\n\t\t\t\txfs_lsn_t commit_lsn, bool aborted);\n \nstruct xfs_ail_cursor {\n\tstruct list_head\tlist;\n\tstruct xfs_log_item\t*item;\n};\n\n \nstruct xfs_ail {\n\tstruct xlog\t\t*ail_log;\n\tstruct task_struct\t*ail_task;\n\tstruct list_head\tail_head;\n\txfs_lsn_t\t\tail_target;\n\txfs_lsn_t\t\tail_target_prev;\n\tstruct list_head\tail_cursors;\n\tspinlock_t\t\tail_lock;\n\txfs_lsn_t\t\tail_last_pushed_lsn;\n\tint\t\t\tail_log_flush;\n\tstruct list_head\tail_buf_list;\n\twait_queue_head_t\tail_empty;\n};\n\n \nvoid\txfs_trans_ail_update_bulk(struct xfs_ail *ailp,\n\t\t\t\tstruct xfs_ail_cursor *cur,\n\t\t\t\tstruct xfs_log_item **log_items, int nr_items,\n\t\t\t\txfs_lsn_t lsn) __releases(ailp->ail_lock);\n \nstatic inline struct xfs_log_item *\nxfs_ail_min(\n\tstruct xfs_ail  *ailp)\n{\n\treturn list_first_entry_or_null(&ailp->ail_head, struct xfs_log_item,\n\t\t\t\t\tli_ail);\n}\n\nstatic inline void\nxfs_trans_ail_update(\n\tstruct xfs_ail\t\t*ailp,\n\tstruct xfs_log_item\t*lip,\n\txfs_lsn_t\t\tlsn) __releases(ailp->ail_lock)\n{\n\txfs_trans_ail_update_bulk(ailp, NULL, &lip, 1, lsn);\n}\n\nvoid xfs_trans_ail_insert(struct xfs_ail *ailp, struct xfs_log_item *lip,\n\t\txfs_lsn_t lsn);\n\nxfs_lsn_t xfs_ail_delete_one(struct xfs_ail *ailp, struct xfs_log_item *lip);\nvoid xfs_ail_update_finish(struct xfs_ail *ailp, xfs_lsn_t old_lsn)\n\t\t\t__releases(ailp->ail_lock);\nvoid xfs_trans_ail_delete(struct xfs_log_item *lip, int shutdown_type);\n\nvoid\t\t\txfs_ail_push(struct xfs_ail *, xfs_lsn_t);\nvoid\t\t\txfs_ail_push_all(struct xfs_ail *);\nvoid\t\t\txfs_ail_push_all_sync(struct xfs_ail *);\nstruct xfs_log_item\t*xfs_ail_min(struct xfs_ail  *ailp);\nxfs_lsn_t\t\txfs_ail_min_lsn(struct xfs_ail *ailp);\n\nstruct xfs_log_item *\txfs_trans_ail_cursor_first(struct xfs_ail *ailp,\n\t\t\t\t\tstruct xfs_ail_cursor *cur,\n\t\t\t\t\txfs_lsn_t lsn);\nstruct xfs_log_item *\txfs_trans_ail_cursor_last(struct xfs_ail *ailp,\n\t\t\t\t\tstruct xfs_ail_cursor *cur,\n\t\t\t\t\txfs_lsn_t lsn);\nstruct xfs_log_item *\txfs_trans_ail_cursor_next(struct xfs_ail *ailp,\n\t\t\t\t\tstruct xfs_ail_cursor *cur);\nvoid\t\t\txfs_trans_ail_cursor_done(struct xfs_ail_cursor *cur);\n\n#if BITS_PER_LONG != 64\nstatic inline void\nxfs_trans_ail_copy_lsn(\n\tstruct xfs_ail\t*ailp,\n\txfs_lsn_t\t*dst,\n\txfs_lsn_t\t*src)\n{\n\tASSERT(sizeof(xfs_lsn_t) == 8);\t \n\tspin_lock(&ailp->ail_lock);\n\t*dst = *src;\n\tspin_unlock(&ailp->ail_lock);\n}\n#else\nstatic inline void\nxfs_trans_ail_copy_lsn(\n\tstruct xfs_ail\t*ailp,\n\txfs_lsn_t\t*dst,\n\txfs_lsn_t\t*src)\n{\n\tASSERT(sizeof(xfs_lsn_t) == 8);\n\t*dst = *src;\n}\n#endif\n\nstatic inline void\nxfs_clear_li_failed(\n\tstruct xfs_log_item\t*lip)\n{\n\tstruct xfs_buf\t*bp = lip->li_buf;\n\n\tASSERT(test_bit(XFS_LI_IN_AIL, &lip->li_flags));\n\tlockdep_assert_held(&lip->li_ailp->ail_lock);\n\n\tif (test_and_clear_bit(XFS_LI_FAILED, &lip->li_flags)) {\n\t\tlip->li_buf = NULL;\n\t\txfs_buf_rele(bp);\n\t}\n}\n\nstatic inline void\nxfs_set_li_failed(\n\tstruct xfs_log_item\t*lip,\n\tstruct xfs_buf\t\t*bp)\n{\n\tlockdep_assert_held(&lip->li_ailp->ail_lock);\n\n\tif (!test_and_set_bit(XFS_LI_FAILED, &lip->li_flags)) {\n\t\txfs_buf_hold(bp);\n\t\tlip->li_buf = bp;\n\t}\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}