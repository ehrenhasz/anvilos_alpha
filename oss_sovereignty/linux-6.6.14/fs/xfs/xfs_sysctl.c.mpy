{
  "module_name": "xfs_sysctl.c",
  "hash_id": "68aa581ae28497e8087db7dbb7ae242722a2747069caf0d060f93e50a9cc947c",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/xfs_sysctl.c",
  "human_readable_source": "\n \n#include \"xfs.h\"\n#include \"xfs_error.h\"\n\nstatic struct ctl_table_header *xfs_table_header;\n\n#ifdef CONFIG_PROC_FS\nSTATIC int\nxfs_stats_clear_proc_handler(\n\tstruct ctl_table\t*ctl,\n\tint\t\t\twrite,\n\tvoid\t\t\t*buffer,\n\tsize_t\t\t\t*lenp,\n\tloff_t\t\t\t*ppos)\n{\n\tint\t\tret, *valp = ctl->data;\n\n\tret = proc_dointvec_minmax(ctl, write, buffer, lenp, ppos);\n\n\tif (!ret && write && *valp) {\n\t\txfs_stats_clearall(xfsstats.xs_stats);\n\t\txfs_stats_clear = 0;\n\t}\n\n\treturn ret;\n}\n\nSTATIC int\nxfs_panic_mask_proc_handler(\n\tstruct ctl_table\t*ctl,\n\tint\t\t\twrite,\n\tvoid\t\t\t*buffer,\n\tsize_t\t\t\t*lenp,\n\tloff_t\t\t\t*ppos)\n{\n\tint\t\tret, *valp = ctl->data;\n\n\tret = proc_dointvec_minmax(ctl, write, buffer, lenp, ppos);\n\tif (!ret && write) {\n\t\txfs_panic_mask = *valp;\n#ifdef DEBUG\n\t\txfs_panic_mask |= (XFS_PTAG_SHUTDOWN_CORRUPT | XFS_PTAG_LOGRES);\n#endif\n\t}\n\treturn ret;\n}\n#endif  \n\nSTATIC int\nxfs_deprecated_dointvec_minmax(\n\tstruct ctl_table\t*ctl,\n\tint\t\t\twrite,\n\tvoid\t\t\t*buffer,\n\tsize_t\t\t\t*lenp,\n\tloff_t\t\t\t*ppos)\n{\n\tif (write) {\n\t\tprintk_ratelimited(KERN_WARNING\n\t\t\t\t\"XFS: %s sysctl option is deprecated.\\n\",\n\t\t\t\tctl->procname);\n\t}\n\treturn proc_dointvec_minmax(ctl, write, buffer, lenp, ppos);\n}\n\nstatic struct ctl_table xfs_table[] = {\n\t{\n\t\t.procname\t= \"irix_sgid_inherit\",\n\t\t.data\t\t= &xfs_params.sgid_inherit.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= xfs_deprecated_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.sgid_inherit.min,\n\t\t.extra2\t\t= &xfs_params.sgid_inherit.max\n\t},\n\t{\n\t\t.procname\t= \"irix_symlink_mode\",\n\t\t.data\t\t= &xfs_params.symlink_mode.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= xfs_deprecated_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.symlink_mode.min,\n\t\t.extra2\t\t= &xfs_params.symlink_mode.max\n\t},\n\t{\n\t\t.procname\t= \"panic_mask\",\n\t\t.data\t\t= &xfs_params.panic_mask.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= xfs_panic_mask_proc_handler,\n\t\t.extra1\t\t= &xfs_params.panic_mask.min,\n\t\t.extra2\t\t= &xfs_params.panic_mask.max\n\t},\n\n\t{\n\t\t.procname\t= \"error_level\",\n\t\t.data\t\t= &xfs_params.error_level.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.error_level.min,\n\t\t.extra2\t\t= &xfs_params.error_level.max\n\t},\n\t{\n\t\t.procname\t= \"xfssyncd_centisecs\",\n\t\t.data\t\t= &xfs_params.syncd_timer.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.syncd_timer.min,\n\t\t.extra2\t\t= &xfs_params.syncd_timer.max\n\t},\n\t{\n\t\t.procname\t= \"inherit_sync\",\n\t\t.data\t\t= &xfs_params.inherit_sync.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.inherit_sync.min,\n\t\t.extra2\t\t= &xfs_params.inherit_sync.max\n\t},\n\t{\n\t\t.procname\t= \"inherit_nodump\",\n\t\t.data\t\t= &xfs_params.inherit_nodump.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.inherit_nodump.min,\n\t\t.extra2\t\t= &xfs_params.inherit_nodump.max\n\t},\n\t{\n\t\t.procname\t= \"inherit_noatime\",\n\t\t.data\t\t= &xfs_params.inherit_noatim.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.inherit_noatim.min,\n\t\t.extra2\t\t= &xfs_params.inherit_noatim.max\n\t},\n\t{\n\t\t.procname\t= \"inherit_nosymlinks\",\n\t\t.data\t\t= &xfs_params.inherit_nosym.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.inherit_nosym.min,\n\t\t.extra2\t\t= &xfs_params.inherit_nosym.max\n\t},\n\t{\n\t\t.procname\t= \"rotorstep\",\n\t\t.data\t\t= &xfs_params.rotorstep.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.rotorstep.min,\n\t\t.extra2\t\t= &xfs_params.rotorstep.max\n\t},\n\t{\n\t\t.procname\t= \"inherit_nodefrag\",\n\t\t.data\t\t= &xfs_params.inherit_nodfrg.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.inherit_nodfrg.min,\n\t\t.extra2\t\t= &xfs_params.inherit_nodfrg.max\n\t},\n\t{\n\t\t.procname\t= \"filestream_centisecs\",\n\t\t.data\t\t= &xfs_params.fstrm_timer.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.fstrm_timer.min,\n\t\t.extra2\t\t= &xfs_params.fstrm_timer.max,\n\t},\n\t{\n\t\t.procname\t= \"speculative_prealloc_lifetime\",\n\t\t.data\t\t= &xfs_params.blockgc_timer.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.blockgc_timer.min,\n\t\t.extra2\t\t= &xfs_params.blockgc_timer.max,\n\t},\n\t{\n\t\t.procname\t= \"speculative_cow_prealloc_lifetime\",\n\t\t.data\t\t= &xfs_params.blockgc_timer.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= xfs_deprecated_dointvec_minmax,\n\t\t.extra1\t\t= &xfs_params.blockgc_timer.min,\n\t\t.extra2\t\t= &xfs_params.blockgc_timer.max,\n\t},\n\t \n#ifdef CONFIG_PROC_FS\n\t{\n\t\t.procname\t= \"stats_clear\",\n\t\t.data\t\t= &xfs_params.stats_clear.val,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= xfs_stats_clear_proc_handler,\n\t\t.extra1\t\t= &xfs_params.stats_clear.min,\n\t\t.extra2\t\t= &xfs_params.stats_clear.max\n\t},\n#endif  \n\n\t{}\n};\n\nint\nxfs_sysctl_register(void)\n{\n\txfs_table_header = register_sysctl(\"fs/xfs\", xfs_table);\n\tif (!xfs_table_header)\n\t\treturn -ENOMEM;\n\treturn 0;\n}\n\nvoid\nxfs_sysctl_unregister(void)\n{\n\tunregister_sysctl_table(xfs_table_header);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}