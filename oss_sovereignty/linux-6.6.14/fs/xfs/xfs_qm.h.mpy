{
  "module_name": "xfs_qm.h",
  "hash_id": "a09d4a98108d9f14eedf18bc2330a757c14b3cfe1f18c974531b79b340b3250a",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/xfs_qm.h",
  "human_readable_source": "\n \n#ifndef __XFS_QM_H__\n#define __XFS_QM_H__\n\n#include \"xfs_dquot_item.h\"\n#include \"xfs_dquot.h\"\n\nstruct xfs_inode;\n\nextern struct kmem_cache\t*xfs_dqtrx_cache;\n\n \n#define XFS_DQITER_MAP_SIZE\t10\n\n#define XFS_IS_DQUOT_UNINITIALIZED(dqp) ( \\\n\t!dqp->q_blk.hardlimit && \\\n\t!dqp->q_blk.softlimit && \\\n\t!dqp->q_rtb.hardlimit && \\\n\t!dqp->q_rtb.softlimit && \\\n\t!dqp->q_ino.hardlimit && \\\n\t!dqp->q_ino.softlimit && \\\n\t!dqp->q_blk.count && \\\n\t!dqp->q_rtb.count && \\\n\t!dqp->q_ino.count)\n\nstruct xfs_quota_limits {\n\txfs_qcnt_t\t\thard;\t \n\txfs_qcnt_t\t\tsoft;\t \n\ttime64_t\t\ttime;\t \n};\n\n \nstruct xfs_def_quota {\n\tstruct xfs_quota_limits\tblk;\n\tstruct xfs_quota_limits\tino;\n\tstruct xfs_quota_limits\trtb;\n};\n\n \nstruct xfs_quotainfo {\n\tstruct radix_tree_root\tqi_uquota_tree;\n\tstruct radix_tree_root\tqi_gquota_tree;\n\tstruct radix_tree_root\tqi_pquota_tree;\n\tstruct mutex\t\tqi_tree_lock;\n\tstruct xfs_inode\t*qi_uquotaip;\t \n\tstruct xfs_inode\t*qi_gquotaip;\t \n\tstruct xfs_inode\t*qi_pquotaip;\t \n\tstruct list_lru\t\tqi_lru;\n\tint\t\t\tqi_dquots;\n\tstruct mutex\t\tqi_quotaofflock; \n\txfs_filblks_t\t\tqi_dqchunklen;\t \n\tuint\t\t\tqi_dqperchunk;\t \n\tstruct xfs_def_quota\tqi_usr_default;\n\tstruct xfs_def_quota\tqi_grp_default;\n\tstruct xfs_def_quota\tqi_prj_default;\n\tstruct shrinker\t\tqi_shrinker;\n\n\t \n\ttime64_t\t\tqi_expiry_min;\n\ttime64_t\t\tqi_expiry_max;\n};\n\nstatic inline struct radix_tree_root *\nxfs_dquot_tree(\n\tstruct xfs_quotainfo\t*qi,\n\txfs_dqtype_t\t\ttype)\n{\n\tswitch (type) {\n\tcase XFS_DQTYPE_USER:\n\t\treturn &qi->qi_uquota_tree;\n\tcase XFS_DQTYPE_GROUP:\n\t\treturn &qi->qi_gquota_tree;\n\tcase XFS_DQTYPE_PROJ:\n\t\treturn &qi->qi_pquota_tree;\n\tdefault:\n\t\tASSERT(0);\n\t}\n\treturn NULL;\n}\n\nstatic inline struct xfs_inode *\nxfs_quota_inode(struct xfs_mount *mp, xfs_dqtype_t type)\n{\n\tswitch (type) {\n\tcase XFS_DQTYPE_USER:\n\t\treturn mp->m_quotainfo->qi_uquotaip;\n\tcase XFS_DQTYPE_GROUP:\n\t\treturn mp->m_quotainfo->qi_gquotaip;\n\tcase XFS_DQTYPE_PROJ:\n\t\treturn mp->m_quotainfo->qi_pquotaip;\n\tdefault:\n\t\tASSERT(0);\n\t}\n\treturn NULL;\n}\n\nextern void\txfs_trans_mod_dquot(struct xfs_trans *tp, struct xfs_dquot *dqp,\n\t\t\t\t    uint field, int64_t delta);\nextern void\txfs_trans_dqjoin(struct xfs_trans *, struct xfs_dquot *);\nextern void\txfs_trans_log_dquot(struct xfs_trans *, struct xfs_dquot *);\n\n \nenum {\n\tXFS_QM_TRANS_USR = 0,\n\tXFS_QM_TRANS_GRP,\n\tXFS_QM_TRANS_PRJ,\n\tXFS_QM_TRANS_DQTYPES\n};\n#define XFS_QM_TRANS_MAXDQS\t\t2\nstruct xfs_dquot_acct {\n\tstruct xfs_dqtrx\tdqs[XFS_QM_TRANS_DQTYPES][XFS_QM_TRANS_MAXDQS];\n};\n\n \n#define XFS_QM_BTIMELIMIT\t(7 * 24*60*60)           \n#define XFS_QM_RTBTIMELIMIT\t(7 * 24*60*60)           \n#define XFS_QM_ITIMELIMIT\t(7 * 24*60*60)           \n\nextern void\t\txfs_qm_destroy_quotainfo(struct xfs_mount *);\n\n \nextern int\t\txfs_qm_scall_trunc_qfiles(struct xfs_mount *, uint);\nextern int\t\txfs_qm_scall_getquota(struct xfs_mount *mp,\n\t\t\t\t\txfs_dqid_t id,\n\t\t\t\t\txfs_dqtype_t type,\n\t\t\t\t\tstruct qc_dqblk *dst);\nextern int\t\txfs_qm_scall_getquota_next(struct xfs_mount *mp,\n\t\t\t\t\txfs_dqid_t *id,\n\t\t\t\t\txfs_dqtype_t type,\n\t\t\t\t\tstruct qc_dqblk *dst);\nextern int\t\txfs_qm_scall_setqlim(struct xfs_mount *mp,\n\t\t\t\t\txfs_dqid_t id,\n\t\t\t\t\txfs_dqtype_t type,\n\t\t\t\t\tstruct qc_dqblk *newlim);\nextern int\t\txfs_qm_scall_quotaon(struct xfs_mount *, uint);\nextern int\t\txfs_qm_scall_quotaoff(struct xfs_mount *, uint);\n\nstatic inline struct xfs_def_quota *\nxfs_get_defquota(struct xfs_quotainfo *qi, xfs_dqtype_t type)\n{\n\tswitch (type) {\n\tcase XFS_DQTYPE_USER:\n\t\treturn &qi->qi_usr_default;\n\tcase XFS_DQTYPE_GROUP:\n\t\treturn &qi->qi_grp_default;\n\tcase XFS_DQTYPE_PROJ:\n\t\treturn &qi->qi_prj_default;\n\tdefault:\n\t\tASSERT(0);\n\t\treturn NULL;\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}