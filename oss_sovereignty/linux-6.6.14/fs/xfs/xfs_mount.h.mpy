{
  "module_name": "xfs_mount.h",
  "hash_id": "5ed2ad6d66916f62b28b375b2107fa7e3e2e50e0ebdaca77d328bb936c37980a",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/xfs_mount.h",
  "human_readable_source": "\n \n#ifndef __XFS_MOUNT_H__\n#define\t__XFS_MOUNT_H__\n\nstruct xlog;\nstruct xfs_inode;\nstruct xfs_mru_cache;\nstruct xfs_ail;\nstruct xfs_quotainfo;\nstruct xfs_da_geometry;\nstruct xfs_perag;\n\n \nenum {\n\tXFS_LOWSP_1_PCNT = 0,\n\tXFS_LOWSP_2_PCNT,\n\tXFS_LOWSP_3_PCNT,\n\tXFS_LOWSP_4_PCNT,\n\tXFS_LOWSP_5_PCNT,\n\tXFS_LOWSP_MAX,\n};\n\n \nenum {\n\tXFS_ERR_METADATA,\n\tXFS_ERR_CLASS_MAX,\n};\nenum {\n\tXFS_ERR_DEFAULT,\n\tXFS_ERR_EIO,\n\tXFS_ERR_ENOSPC,\n\tXFS_ERR_ENODEV,\n\tXFS_ERR_ERRNO_MAX,\n};\n\n#define XFS_ERR_RETRY_FOREVER\t-1\n\n \nstruct xfs_error_cfg {\n\tstruct xfs_kobj\tkobj;\n\tint\t\tmax_retries;\n\tlong\t\tretry_timeout;\t \n};\n\n \nstruct xfs_inodegc {\n\tstruct xfs_mount\t*mp;\n\tstruct llist_head\tlist;\n\tstruct delayed_work\twork;\n\tint\t\t\terror;\n\n\t \n\tunsigned int\t\titems;\n\tunsigned int\t\tshrinker_hits;\n\tunsigned int\t\tcpu;\n};\n\n \ntypedef struct xfs_mount {\n\tstruct xfs_sb\t\tm_sb;\t\t \n\tstruct super_block\t*m_super;\n\tstruct xfs_ail\t\t*m_ail;\t\t \n\tstruct xfs_buf\t\t*m_sb_bp;\t \n\tchar\t\t\t*m_rtname;\t \n\tchar\t\t\t*m_logname;\t \n\tstruct xfs_da_geometry\t*m_dir_geo;\t \n\tstruct xfs_da_geometry\t*m_attr_geo;\t \n\tstruct xlog\t\t*m_log;\t\t \n\tstruct xfs_inode\t*m_rbmip;\t \n\tstruct xfs_inode\t*m_rsumip;\t \n\tstruct xfs_inode\t*m_rootip;\t \n\tstruct xfs_quotainfo\t*m_quotainfo;\t \n\txfs_buftarg_t\t\t*m_ddev_targp;\t \n\txfs_buftarg_t\t\t*m_logdev_targp; \n\txfs_buftarg_t\t\t*m_rtdev_targp;\t \n\tvoid __percpu\t\t*m_inodegc;\t \n\n\t \n\tuint8_t\t\t\t*m_rsum_cache;\n\tstruct xfs_mru_cache\t*m_filestream;   \n\tstruct workqueue_struct *m_buf_workqueue;\n\tstruct workqueue_struct\t*m_unwritten_workqueue;\n\tstruct workqueue_struct\t*m_reclaim_workqueue;\n\tstruct workqueue_struct\t*m_sync_workqueue;\n\tstruct workqueue_struct *m_blockgc_wq;\n\tstruct workqueue_struct *m_inodegc_wq;\n\n\tint\t\t\tm_bsize;\t \n\tuint8_t\t\t\tm_blkbit_log;\t \n\tuint8_t\t\t\tm_blkbb_log;\t \n\tuint8_t\t\t\tm_agno_log;\t \n\tuint8_t\t\t\tm_sectbb_log;\t \n\tuint\t\t\tm_blockmask;\t \n\tuint\t\t\tm_blockwsize;\t \n\tuint\t\t\tm_blockwmask;\t \n\tuint\t\t\tm_alloc_mxr[2];\t \n\tuint\t\t\tm_alloc_mnr[2];\t \n\tuint\t\t\tm_bmap_dmxr[2];\t \n\tuint\t\t\tm_bmap_dmnr[2];\t \n\tuint\t\t\tm_rmap_mxr[2];\t \n\tuint\t\t\tm_rmap_mnr[2];\t \n\tuint\t\t\tm_refc_mxr[2];\t \n\tuint\t\t\tm_refc_mnr[2];\t \n\tuint\t\t\tm_alloc_maxlevels;  \n\tuint\t\t\tm_bm_maxlevels[2];  \n\tuint\t\t\tm_rmap_maxlevels;  \n\tuint\t\t\tm_refc_maxlevels;  \n\tunsigned int\t\tm_agbtree_maxlevels;  \n\txfs_extlen_t\t\tm_ag_prealloc_blocks;  \n\tuint\t\t\tm_alloc_set_aside;  \n\tuint\t\t\tm_ag_max_usable;  \n\tint\t\t\tm_dalign;\t \n\tint\t\t\tm_swidth;\t \n\txfs_agnumber_t\t\tm_maxagi;\t \n\tuint\t\t\tm_allocsize_log; \n\tuint\t\t\tm_allocsize_blocks;  \n\tint\t\t\tm_logbufs;\t \n\tint\t\t\tm_logbsize;\t \n\tuint\t\t\tm_rsumlevels;\t \n\tuint\t\t\tm_rsumsize;\t \n\tint\t\t\tm_fixedfsid[2];\t \n\tuint\t\t\tm_qflags;\t \n\tuint64_t\t\tm_features;\t \n\tuint64_t\t\tm_low_space[XFS_LOWSP_MAX];\n\tuint64_t\t\tm_low_rtexts[XFS_LOWSP_MAX];\n\tstruct xfs_ino_geometry\tm_ino_geo;\t \n\tstruct xfs_trans_resv\tm_resv;\t\t \n\t\t\t\t\t\t \n\tunsigned long\t\tm_opstate;\t \n\tbool\t\t\tm_always_cow;\n\tbool\t\t\tm_fail_unmount;\n\tbool\t\t\tm_finobt_nores;  \n\tbool\t\t\tm_update_sb;\t \n\n\t \n\tuint8_t\t\t\tm_fs_checked;\n\tuint8_t\t\t\tm_fs_sick;\n\t \n\tuint8_t\t\t\tm_rt_checked;\n\tuint8_t\t\t\tm_rt_sick;\n\n\t \n\n\tspinlock_t ____cacheline_aligned m_sb_lock;  \n\tstruct percpu_counter\tm_icount;\t \n\tstruct percpu_counter\tm_ifree;\t \n\tstruct percpu_counter\tm_fdblocks;\t \n\tstruct percpu_counter\tm_frextents;\t \n\n\t \n\tstruct percpu_counter\tm_delalloc_blks;\n\t \n\tatomic64_t\t\tm_allocbt_blks;\n\n\tstruct radix_tree_root\tm_perag_tree;\t \n\tspinlock_t\t\tm_perag_lock;\t \n\tuint64_t\t\tm_resblks;\t \n\tuint64_t\t\tm_resblks_avail; \n\tuint64_t\t\tm_resblks_save;\t \n\tstruct delayed_work\tm_reclaim_work;\t \n\tstruct dentry\t\t*m_debugfs;\t \n\tstruct xfs_kobj\t\tm_kobj;\n\tstruct xfs_kobj\t\tm_error_kobj;\n\tstruct xfs_kobj\t\tm_error_meta_kobj;\n\tstruct xfs_error_cfg\tm_error_cfg[XFS_ERR_CLASS_MAX][XFS_ERR_ERRNO_MAX];\n\tstruct xstats\t\tm_stats;\t \n#ifdef CONFIG_XFS_ONLINE_SCRUB_STATS\n\tstruct xchk_stats\t*m_scrub_stats;\n#endif\n\txfs_agnumber_t\t\tm_agfrotor;\t \n\tatomic_t\t\tm_agirotor;\t \n\n\t \n\tstruct shrinker\t\tm_inodegc_shrinker;\n\t \n\tstruct work_struct\tm_flush_inodes_work;\n\n\t \n\tuint32_t\t\tm_generation;\n\tstruct mutex\t\tm_growlock;\t \n\n#ifdef DEBUG\n\t \n\tunsigned int\t\t*m_errortag;\n\tstruct xfs_kobj\t\tm_errortag_kobj;\n#endif\n\n\t \n\tstruct cpumask\t\tm_inodegc_cpumask;\n} xfs_mount_t;\n\n#define M_IGEO(mp)\t\t(&(mp)->m_ino_geo)\n\n \n#define XFS_FEAT_ATTR\t\t(1ULL << 0)\t \n#define XFS_FEAT_NLINK\t\t(1ULL << 1)\t \n#define XFS_FEAT_QUOTA\t\t(1ULL << 2)\t \n#define XFS_FEAT_ALIGN\t\t(1ULL << 3)\t \n#define XFS_FEAT_DALIGN\t\t(1ULL << 4)\t \n#define XFS_FEAT_LOGV2\t\t(1ULL << 5)\t \n#define XFS_FEAT_SECTOR\t\t(1ULL << 6)\t \n#define XFS_FEAT_EXTFLG\t\t(1ULL << 7)\t \n#define XFS_FEAT_ASCIICI\t(1ULL << 8)\t \n#define XFS_FEAT_LAZYSBCOUNT\t(1ULL << 9)\t \n#define XFS_FEAT_ATTR2\t\t(1ULL << 10)\t \n#define XFS_FEAT_PARENT\t\t(1ULL << 11)\t \n#define XFS_FEAT_PROJID32\t(1ULL << 12)\t \n#define XFS_FEAT_CRC\t\t(1ULL << 13)\t \n#define XFS_FEAT_V3INODES\t(1ULL << 14)\t \n#define XFS_FEAT_PQUOTINO\t(1ULL << 15)\t \n#define XFS_FEAT_FTYPE\t\t(1ULL << 16)\t \n#define XFS_FEAT_FINOBT\t\t(1ULL << 17)\t \n#define XFS_FEAT_RMAPBT\t\t(1ULL << 18)\t \n#define XFS_FEAT_REFLINK\t(1ULL << 19)\t \n#define XFS_FEAT_SPINODES\t(1ULL << 20)\t \n#define XFS_FEAT_META_UUID\t(1ULL << 21)\t \n#define XFS_FEAT_REALTIME\t(1ULL << 22)\t \n#define XFS_FEAT_INOBTCNT\t(1ULL << 23)\t \n#define XFS_FEAT_BIGTIME\t(1ULL << 24)\t \n#define XFS_FEAT_NEEDSREPAIR\t(1ULL << 25)\t \n#define XFS_FEAT_NREXT64\t(1ULL << 26)\t \n\n \n#define XFS_FEAT_NOATTR2\t(1ULL << 48)\t \n#define XFS_FEAT_NOALIGN\t(1ULL << 49)\t \n#define XFS_FEAT_ALLOCSIZE\t(1ULL << 50)\t \n#define XFS_FEAT_LARGE_IOSIZE\t(1ULL << 51)\t \n#define XFS_FEAT_WSYNC\t\t(1ULL << 52)\t \n#define XFS_FEAT_DIRSYNC\t(1ULL << 53)\t \n#define XFS_FEAT_DISCARD\t(1ULL << 54)\t \n#define XFS_FEAT_GRPID\t\t(1ULL << 55)\t \n#define XFS_FEAT_SMALL_INUMS\t(1ULL << 56)\t \n#define XFS_FEAT_IKEEP\t\t(1ULL << 57)\t \n#define XFS_FEAT_SWALLOC\t(1ULL << 58)\t \n#define XFS_FEAT_FILESTREAMS\t(1ULL << 59)\t \n#define XFS_FEAT_DAX_ALWAYS\t(1ULL << 60)\t \n#define XFS_FEAT_DAX_NEVER\t(1ULL << 61)\t \n#define XFS_FEAT_NORECOVERY\t(1ULL << 62)\t \n#define XFS_FEAT_NOUUID\t\t(1ULL << 63)\t \n\n#define __XFS_HAS_FEAT(name, NAME) \\\nstatic inline bool xfs_has_ ## name (struct xfs_mount *mp) \\\n{ \\\n\treturn mp->m_features & XFS_FEAT_ ## NAME; \\\n}\n\n \n#define __XFS_ADD_FEAT(name, NAME) \\\n\t__XFS_HAS_FEAT(name, NAME); \\\nstatic inline void xfs_add_ ## name (struct xfs_mount *mp) \\\n{ \\\n\tmp->m_features |= XFS_FEAT_ ## NAME; \\\n\txfs_sb_version_add ## name(&mp->m_sb); \\\n}\n\n \n__XFS_ADD_FEAT(attr, ATTR)\n__XFS_HAS_FEAT(nlink, NLINK)\n__XFS_ADD_FEAT(quota, QUOTA)\n__XFS_HAS_FEAT(align, ALIGN)\n__XFS_HAS_FEAT(dalign, DALIGN)\n__XFS_HAS_FEAT(logv2, LOGV2)\n__XFS_HAS_FEAT(sector, SECTOR)\n__XFS_HAS_FEAT(extflg, EXTFLG)\n__XFS_HAS_FEAT(asciici, ASCIICI)\n__XFS_HAS_FEAT(lazysbcount, LAZYSBCOUNT)\n__XFS_ADD_FEAT(attr2, ATTR2)\n__XFS_HAS_FEAT(parent, PARENT)\n__XFS_ADD_FEAT(projid32, PROJID32)\n__XFS_HAS_FEAT(crc, CRC)\n__XFS_HAS_FEAT(v3inodes, V3INODES)\n__XFS_HAS_FEAT(pquotino, PQUOTINO)\n__XFS_HAS_FEAT(ftype, FTYPE)\n__XFS_HAS_FEAT(finobt, FINOBT)\n__XFS_HAS_FEAT(rmapbt, RMAPBT)\n__XFS_HAS_FEAT(reflink, REFLINK)\n__XFS_HAS_FEAT(sparseinodes, SPINODES)\n__XFS_HAS_FEAT(metauuid, META_UUID)\n__XFS_HAS_FEAT(realtime, REALTIME)\n__XFS_HAS_FEAT(inobtcounts, INOBTCNT)\n__XFS_HAS_FEAT(bigtime, BIGTIME)\n__XFS_HAS_FEAT(needsrepair, NEEDSREPAIR)\n__XFS_HAS_FEAT(large_extent_counts, NREXT64)\n\n \n__XFS_HAS_FEAT(noattr2, NOATTR2)\n__XFS_HAS_FEAT(noalign, NOALIGN)\n__XFS_HAS_FEAT(allocsize, ALLOCSIZE)\n__XFS_HAS_FEAT(large_iosize, LARGE_IOSIZE)\n__XFS_HAS_FEAT(wsync, WSYNC)\n__XFS_HAS_FEAT(dirsync, DIRSYNC)\n__XFS_HAS_FEAT(discard, DISCARD)\n__XFS_HAS_FEAT(grpid, GRPID)\n__XFS_HAS_FEAT(small_inums, SMALL_INUMS)\n__XFS_HAS_FEAT(ikeep, IKEEP)\n__XFS_HAS_FEAT(swalloc, SWALLOC)\n__XFS_HAS_FEAT(filestreams, FILESTREAMS)\n__XFS_HAS_FEAT(dax_always, DAX_ALWAYS)\n__XFS_HAS_FEAT(dax_never, DAX_NEVER)\n__XFS_HAS_FEAT(norecovery, NORECOVERY)\n__XFS_HAS_FEAT(nouuid, NOUUID)\n\n \n#define XFS_OPSTATE_UNMOUNTING\t\t0\t \n#define XFS_OPSTATE_CLEAN\t\t1\t \n#define XFS_OPSTATE_SHUTDOWN\t\t2\t \n#define XFS_OPSTATE_INODE32\t\t3\t \n#define XFS_OPSTATE_READONLY\t\t4\t \n\n \n#define XFS_OPSTATE_INODEGC_ENABLED\t5\n \n#define XFS_OPSTATE_BLOCKGC_ENABLED\t6\n\n \n#define XFS_OPSTATE_WARNED_SCRUB\t7\n \n#define XFS_OPSTATE_WARNED_SHRINK\t8\n \n#define XFS_OPSTATE_WARNED_LARP\t\t9\n \n#define XFS_OPSTATE_QUOTACHECK_RUNNING\t10\n\n#define __XFS_IS_OPSTATE(name, NAME) \\\nstatic inline bool xfs_is_ ## name (struct xfs_mount *mp) \\\n{ \\\n\treturn test_bit(XFS_OPSTATE_ ## NAME, &mp->m_opstate); \\\n} \\\nstatic inline bool xfs_clear_ ## name (struct xfs_mount *mp) \\\n{ \\\n\treturn test_and_clear_bit(XFS_OPSTATE_ ## NAME, &mp->m_opstate); \\\n} \\\nstatic inline bool xfs_set_ ## name (struct xfs_mount *mp) \\\n{ \\\n\treturn test_and_set_bit(XFS_OPSTATE_ ## NAME, &mp->m_opstate); \\\n}\n\n__XFS_IS_OPSTATE(unmounting, UNMOUNTING)\n__XFS_IS_OPSTATE(clean, CLEAN)\n__XFS_IS_OPSTATE(shutdown, SHUTDOWN)\n__XFS_IS_OPSTATE(inode32, INODE32)\n__XFS_IS_OPSTATE(readonly, READONLY)\n__XFS_IS_OPSTATE(inodegc_enabled, INODEGC_ENABLED)\n__XFS_IS_OPSTATE(blockgc_enabled, BLOCKGC_ENABLED)\n#ifdef CONFIG_XFS_QUOTA\n__XFS_IS_OPSTATE(quotacheck_running, QUOTACHECK_RUNNING)\n#else\n# define xfs_is_quotacheck_running(mp)\t(false)\n#endif\n\nstatic inline bool\nxfs_should_warn(struct xfs_mount *mp, long nr)\n{\n\treturn !test_and_set_bit(nr, &mp->m_opstate);\n}\n\n#define XFS_OPSTATE_STRINGS \\\n\t{ (1UL << XFS_OPSTATE_UNMOUNTING),\t\t\"unmounting\" }, \\\n\t{ (1UL << XFS_OPSTATE_CLEAN),\t\t\t\"clean\" }, \\\n\t{ (1UL << XFS_OPSTATE_SHUTDOWN),\t\t\"shutdown\" }, \\\n\t{ (1UL << XFS_OPSTATE_INODE32),\t\t\t\"inode32\" }, \\\n\t{ (1UL << XFS_OPSTATE_READONLY),\t\t\"read_only\" }, \\\n\t{ (1UL << XFS_OPSTATE_INODEGC_ENABLED),\t\t\"inodegc\" }, \\\n\t{ (1UL << XFS_OPSTATE_BLOCKGC_ENABLED),\t\t\"blockgc\" }, \\\n\t{ (1UL << XFS_OPSTATE_WARNED_SCRUB),\t\t\"wscrub\" }, \\\n\t{ (1UL << XFS_OPSTATE_WARNED_SHRINK),\t\t\"wshrink\" }, \\\n\t{ (1UL << XFS_OPSTATE_WARNED_LARP),\t\t\"wlarp\" }, \\\n\t{ (1UL << XFS_OPSTATE_QUOTACHECK_RUNNING),\t\"quotacheck\" }\n\n \n#define XFS_MAX_IO_LOG\t\t30\t \n#define XFS_MIN_IO_LOG\t\tPAGE_SHIFT\n\nvoid xfs_do_force_shutdown(struct xfs_mount *mp, uint32_t flags, char *fname,\n\t\tint lnnum);\n#define xfs_force_shutdown(m,f)\t\\\n\txfs_do_force_shutdown(m, f, __FILE__, __LINE__)\n\n#define SHUTDOWN_META_IO_ERROR\t(1u << 0)  \n#define SHUTDOWN_LOG_IO_ERROR\t(1u << 1)  \n#define SHUTDOWN_FORCE_UMOUNT\t(1u << 2)  \n#define SHUTDOWN_CORRUPT_INCORE\t(1u << 3)  \n#define SHUTDOWN_CORRUPT_ONDISK\t(1u << 4)   \n#define SHUTDOWN_DEVICE_REMOVED\t(1u << 5)  \n\n#define XFS_SHUTDOWN_STRINGS \\\n\t{ SHUTDOWN_META_IO_ERROR,\t\"metadata_io\" }, \\\n\t{ SHUTDOWN_LOG_IO_ERROR,\t\"log_io\" }, \\\n\t{ SHUTDOWN_FORCE_UMOUNT,\t\"force_umount\" }, \\\n\t{ SHUTDOWN_CORRUPT_INCORE,\t\"corruption\" }, \\\n\t{ SHUTDOWN_DEVICE_REMOVED,\t\"device_removed\" }\n\n \n#define XFS_MFSI_QUIET\t\t0x40\t \n\nstatic inline xfs_agnumber_t\nxfs_daddr_to_agno(struct xfs_mount *mp, xfs_daddr_t d)\n{\n\txfs_rfsblock_t ld = XFS_BB_TO_FSBT(mp, d);\n\tdo_div(ld, mp->m_sb.sb_agblocks);\n\treturn (xfs_agnumber_t) ld;\n}\n\nstatic inline xfs_agblock_t\nxfs_daddr_to_agbno(struct xfs_mount *mp, xfs_daddr_t d)\n{\n\txfs_rfsblock_t ld = XFS_BB_TO_FSBT(mp, d);\n\treturn (xfs_agblock_t) do_div(ld, mp->m_sb.sb_agblocks);\n}\n\nint xfs_buf_hash_init(struct xfs_perag *pag);\nvoid xfs_buf_hash_destroy(struct xfs_perag *pag);\n\nextern void\txfs_uuid_table_free(void);\nextern uint64_t xfs_default_resblks(xfs_mount_t *mp);\nextern int\txfs_mountfs(xfs_mount_t *mp);\nextern void\txfs_unmountfs(xfs_mount_t *);\n\n \n#define XFS_FDBLOCKS_BATCH\t1024\n\n \nstatic inline uint64_t\nxfs_fdblocks_unavailable(\n\tstruct xfs_mount\t*mp)\n{\n\treturn mp->m_alloc_set_aside + atomic64_read(&mp->m_allocbt_blks);\n}\n\nint xfs_mod_freecounter(struct xfs_mount *mp, struct percpu_counter *counter,\n\t\tint64_t delta, bool rsvd);\n\nstatic inline int\nxfs_mod_fdblocks(struct xfs_mount *mp, int64_t delta, bool reserved)\n{\n\treturn xfs_mod_freecounter(mp, &mp->m_fdblocks, delta, reserved);\n}\n\nstatic inline int\nxfs_mod_frextents(struct xfs_mount *mp, int64_t delta)\n{\n\treturn xfs_mod_freecounter(mp, &mp->m_frextents, delta, false);\n}\n\nextern int\txfs_readsb(xfs_mount_t *, int);\nextern void\txfs_freesb(xfs_mount_t *);\nextern bool\txfs_fs_writable(struct xfs_mount *mp, int level);\nextern int\txfs_sb_validate_fsb_count(struct xfs_sb *, uint64_t);\n\nextern int\txfs_dev_is_read_only(struct xfs_mount *, char *);\n\nextern void\txfs_set_low_space_thresholds(struct xfs_mount *);\n\nint\txfs_zero_extent(struct xfs_inode *ip, xfs_fsblock_t start_fsb,\n\t\t\txfs_off_t count_fsb);\n\nstruct xfs_error_cfg * xfs_error_get_cfg(struct xfs_mount *mp,\n\t\tint error_class, int error);\nvoid xfs_force_summary_recalc(struct xfs_mount *mp);\nint xfs_add_incompat_log_feature(struct xfs_mount *mp, uint32_t feature);\nbool xfs_clear_incompat_log_features(struct xfs_mount *mp);\nvoid xfs_mod_delalloc(struct xfs_mount *mp, int64_t delta);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}