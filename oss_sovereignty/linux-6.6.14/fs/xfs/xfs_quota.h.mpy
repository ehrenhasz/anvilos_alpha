{
  "module_name": "xfs_quota.h",
  "hash_id": "f8c4198ce06b718971e46cc20dda004208b5f182ca991d301d448b2663e64ec4",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/xfs_quota.h",
  "human_readable_source": "\n \n#ifndef __XFS_QUOTA_H__\n#define __XFS_QUOTA_H__\n\n#include \"xfs_quota_defs.h\"\n\n \n\nstruct xfs_trans;\nstruct xfs_buf;\n\n \n#define XFS_NOT_DQATTACHED(mp, ip) \\\n\t((XFS_IS_UQUOTA_ON(mp) && (ip)->i_udquot == NULL) || \\\n\t (XFS_IS_GQUOTA_ON(mp) && (ip)->i_gdquot == NULL) || \\\n\t (XFS_IS_PQUOTA_ON(mp) && (ip)->i_pdquot == NULL))\n\n#define XFS_QM_NEED_QUOTACHECK(mp) \\\n\t((XFS_IS_UQUOTA_ON(mp) && \\\n\t\t(mp->m_sb.sb_qflags & XFS_UQUOTA_CHKD) == 0) || \\\n\t (XFS_IS_GQUOTA_ON(mp) && \\\n\t\t(mp->m_sb.sb_qflags & XFS_GQUOTA_CHKD) == 0) || \\\n\t (XFS_IS_PQUOTA_ON(mp) && \\\n\t\t(mp->m_sb.sb_qflags & XFS_PQUOTA_CHKD) == 0))\n\nstatic inline uint\nxfs_quota_chkd_flag(\n\txfs_dqtype_t\t\ttype)\n{\n\tswitch (type) {\n\tcase XFS_DQTYPE_USER:\n\t\treturn XFS_UQUOTA_CHKD;\n\tcase XFS_DQTYPE_GROUP:\n\t\treturn XFS_GQUOTA_CHKD;\n\tcase XFS_DQTYPE_PROJ:\n\t\treturn XFS_PQUOTA_CHKD;\n\tdefault:\n\t\treturn 0;\n\t}\n}\n\n \nstruct xfs_dqtrx {\n\tstruct xfs_dquot *qt_dquot;\t   \n\n\tuint64_t\tqt_blk_res;\t   \n\tint64_t\t\tqt_bcount_delta;   \n\tint64_t\t\tqt_delbcnt_delta;  \n\n\tuint64_t\tqt_rtblk_res;\t   \n\tuint64_t\tqt_rtblk_res_used; \n\tint64_t\t\tqt_rtbcount_delta; \n\tint64_t\t\tqt_delrtb_delta;   \n\n\tuint64_t\tqt_ino_res;\t   \n\tuint64_t\tqt_ino_res_used;   \n\tint64_t\t\tqt_icount_delta;   \n};\n\n#ifdef CONFIG_XFS_QUOTA\nextern void xfs_trans_dup_dqinfo(struct xfs_trans *, struct xfs_trans *);\nextern void xfs_trans_free_dqinfo(struct xfs_trans *);\nextern void xfs_trans_mod_dquot_byino(struct xfs_trans *, struct xfs_inode *,\n\t\tuint, int64_t);\nextern void xfs_trans_apply_dquot_deltas(struct xfs_trans *);\nextern void xfs_trans_unreserve_and_mod_dquots(struct xfs_trans *);\nint xfs_trans_reserve_quota_nblks(struct xfs_trans *tp, struct xfs_inode *ip,\n\t\tint64_t dblocks, int64_t rblocks, bool force);\nextern int xfs_trans_reserve_quota_bydquots(struct xfs_trans *,\n\t\tstruct xfs_mount *, struct xfs_dquot *,\n\t\tstruct xfs_dquot *, struct xfs_dquot *, int64_t, long, uint);\nint xfs_trans_reserve_quota_icreate(struct xfs_trans *tp,\n\t\tstruct xfs_dquot *udqp, struct xfs_dquot *gdqp,\n\t\tstruct xfs_dquot *pdqp, int64_t dblocks);\n\nextern int xfs_qm_vop_dqalloc(struct xfs_inode *, kuid_t, kgid_t,\n\t\tprid_t, uint, struct xfs_dquot **, struct xfs_dquot **,\n\t\tstruct xfs_dquot **);\nextern void xfs_qm_vop_create_dqattach(struct xfs_trans *, struct xfs_inode *,\n\t\tstruct xfs_dquot *, struct xfs_dquot *, struct xfs_dquot *);\nextern int xfs_qm_vop_rename_dqattach(struct xfs_inode **);\nextern struct xfs_dquot *xfs_qm_vop_chown(struct xfs_trans *,\n\t\tstruct xfs_inode *, struct xfs_dquot **, struct xfs_dquot *);\nextern int xfs_qm_dqattach(struct xfs_inode *);\nextern int xfs_qm_dqattach_locked(struct xfs_inode *ip, bool doalloc);\nextern void xfs_qm_dqdetach(struct xfs_inode *);\nextern void xfs_qm_dqrele(struct xfs_dquot *);\nextern void xfs_qm_statvfs(struct xfs_inode *, struct kstatfs *);\nextern int xfs_qm_newmount(struct xfs_mount *, uint *, uint *);\nextern void xfs_qm_mount_quotas(struct xfs_mount *);\nextern void xfs_qm_unmount(struct xfs_mount *);\nextern void xfs_qm_unmount_quotas(struct xfs_mount *);\n\nstatic inline int\nxfs_quota_reserve_blkres(struct xfs_inode *ip, int64_t blocks)\n{\n\treturn xfs_trans_reserve_quota_nblks(NULL, ip, blocks, 0, false);\n}\nbool xfs_inode_near_dquot_enforcement(struct xfs_inode *ip, xfs_dqtype_t type);\n#else\nstatic inline int\nxfs_qm_vop_dqalloc(struct xfs_inode *ip, kuid_t kuid, kgid_t kgid,\n\t\tprid_t prid, uint flags, struct xfs_dquot **udqp,\n\t\tstruct xfs_dquot **gdqp, struct xfs_dquot **pdqp)\n{\n\t*udqp = NULL;\n\t*gdqp = NULL;\n\t*pdqp = NULL;\n\treturn 0;\n}\n#define xfs_trans_dup_dqinfo(tp, tp2)\n#define xfs_trans_free_dqinfo(tp)\n#define xfs_trans_mod_dquot_byino(tp, ip, fields, delta) do { } while (0)\n#define xfs_trans_apply_dquot_deltas(tp)\n#define xfs_trans_unreserve_and_mod_dquots(tp)\nstatic inline int xfs_trans_reserve_quota_nblks(struct xfs_trans *tp,\n\t\tstruct xfs_inode *ip, int64_t dblocks, int64_t rblocks,\n\t\tbool force)\n{\n\treturn 0;\n}\nstatic inline int xfs_trans_reserve_quota_bydquots(struct xfs_trans *tp,\n\t\tstruct xfs_mount *mp, struct xfs_dquot *udqp,\n\t\tstruct xfs_dquot *gdqp, struct xfs_dquot *pdqp,\n\t\tint64_t nblks, long nions, uint flags)\n{\n\treturn 0;\n}\n\nstatic inline int\nxfs_quota_reserve_blkres(struct xfs_inode *ip, int64_t blocks)\n{\n\treturn 0;\n}\n\nstatic inline int\nxfs_trans_reserve_quota_icreate(struct xfs_trans *tp, struct xfs_dquot *udqp,\n\t\tstruct xfs_dquot *gdqp, struct xfs_dquot *pdqp, int64_t dblocks)\n{\n\treturn 0;\n}\n\n#define xfs_qm_vop_create_dqattach(tp, ip, u, g, p)\n#define xfs_qm_vop_rename_dqattach(it)\t\t\t\t\t(0)\n#define xfs_qm_vop_chown(tp, ip, old, new)\t\t\t\t(NULL)\n#define xfs_qm_dqattach(ip)\t\t\t\t\t\t(0)\n#define xfs_qm_dqattach_locked(ip, fl)\t\t\t\t\t(0)\n#define xfs_qm_dqdetach(ip)\n#define xfs_qm_dqrele(d)\t\t\tdo { (d) = (d); } while(0)\n#define xfs_qm_statvfs(ip, s)\t\t\tdo { } while(0)\n#define xfs_qm_newmount(mp, a, b)\t\t\t\t\t(0)\n#define xfs_qm_mount_quotas(mp)\n#define xfs_qm_unmount(mp)\n#define xfs_qm_unmount_quotas(mp)\n#define xfs_inode_near_dquot_enforcement(ip, type)\t\t\t(false)\n#endif  \n\nstatic inline int\nxfs_quota_unreserve_blkres(struct xfs_inode *ip, int64_t blocks)\n{\n\treturn xfs_quota_reserve_blkres(ip, -blocks);\n}\n\nextern int xfs_mount_reset_sbqflags(struct xfs_mount *);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}