{
  "module_name": "xfs_attr.h",
  "hash_id": "768235294919f2c45cdb56be72671e4706a69dd10a401777e7b964f1bb07cb7a",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/libxfs/xfs_attr.h",
  "human_readable_source": " \n \n#ifndef __XFS_ATTR_H__\n#define\t__XFS_ATTR_H__\n\nstruct xfs_inode;\nstruct xfs_da_args;\nstruct xfs_attr_list_context;\n\n \n\n \n#define\tATTR_MAX_VALUELEN\t(64*1024)\t \n\n \nstruct xfs_attrlist_cursor_kern {\n\t__u32\thashval;\t \n\t__u32\tblkno;\t\t \n\t__u32\toffset;\t\t \n\t__u16\tpad1;\t\t \n\t__u8\tpad2;\t\t \n\t__u8\tinitted;\t \n};\n\n\n \n\n\n \ntypedef void (*put_listent_func_t)(struct xfs_attr_list_context *, int,\n\t\t\t      unsigned char *, int, int);\n\nstruct xfs_attr_list_context {\n\tstruct xfs_trans\t*tp;\n\tstruct xfs_inode\t*dp;\t\t \n\tstruct xfs_attrlist_cursor_kern cursor;\t \n\tvoid\t\t\t*buffer;\t \n\n\t \n\tint\t\t\tseen_enough;\n\tbool\t\t\tallow_incomplete;\n\n\tssize_t\t\t\tcount;\t\t \n\tint\t\t\tdupcnt;\t\t \n\tint\t\t\tbufsize;\t \n\tint\t\t\tfirstu;\t\t \n\tunsigned int\t\tattr_filter;\t \n\tint\t\t\tresynch;\t \n\tput_listent_func_t\tput_listent;\t \n\tint\t\t\tindex;\t\t \n};\n\n\n \n\n \n\n \nenum xfs_delattr_state {\n\tXFS_DAS_UNINIT\t\t= 0,\t \n\n\t \n\tXFS_DAS_SF_ADD,\t\t\t \n\tXFS_DAS_SF_REMOVE,\t\t \n\n\tXFS_DAS_LEAF_ADD,\t\t \n\tXFS_DAS_LEAF_REMOVE,\t\t \n\n\tXFS_DAS_NODE_ADD,\t\t \n\tXFS_DAS_NODE_REMOVE,\t\t \n\n\t \n\tXFS_DAS_LEAF_SET_RMT,\t\t \n\tXFS_DAS_LEAF_ALLOC_RMT,\t\t \n\tXFS_DAS_LEAF_REPLACE,\t\t \n\tXFS_DAS_LEAF_REMOVE_OLD,\t \n\tXFS_DAS_LEAF_REMOVE_RMT,\t \n\tXFS_DAS_LEAF_REMOVE_ATTR,\t \n\n\t \n\tXFS_DAS_NODE_SET_RMT,\t\t \n\tXFS_DAS_NODE_ALLOC_RMT,\t\t \n\tXFS_DAS_NODE_REPLACE,\t\t \n\tXFS_DAS_NODE_REMOVE_OLD,\t \n\tXFS_DAS_NODE_REMOVE_RMT,\t \n\tXFS_DAS_NODE_REMOVE_ATTR,\t \n\n\tXFS_DAS_DONE,\t\t\t \n};\n\n#define XFS_DAS_STRINGS\t\\\n\t{ XFS_DAS_UNINIT,\t\t\"XFS_DAS_UNINIT\" }, \\\n\t{ XFS_DAS_SF_ADD,\t\t\"XFS_DAS_SF_ADD\" }, \\\n\t{ XFS_DAS_SF_REMOVE,\t\t\"XFS_DAS_SF_REMOVE\" }, \\\n\t{ XFS_DAS_LEAF_ADD,\t\t\"XFS_DAS_LEAF_ADD\" }, \\\n\t{ XFS_DAS_LEAF_REMOVE,\t\t\"XFS_DAS_LEAF_REMOVE\" }, \\\n\t{ XFS_DAS_NODE_ADD,\t\t\"XFS_DAS_NODE_ADD\" }, \\\n\t{ XFS_DAS_NODE_REMOVE,\t\t\"XFS_DAS_NODE_REMOVE\" }, \\\n\t{ XFS_DAS_LEAF_SET_RMT,\t\t\"XFS_DAS_LEAF_SET_RMT\" }, \\\n\t{ XFS_DAS_LEAF_ALLOC_RMT,\t\"XFS_DAS_LEAF_ALLOC_RMT\" }, \\\n\t{ XFS_DAS_LEAF_REPLACE,\t\t\"XFS_DAS_LEAF_REPLACE\" }, \\\n\t{ XFS_DAS_LEAF_REMOVE_OLD,\t\"XFS_DAS_LEAF_REMOVE_OLD\" }, \\\n\t{ XFS_DAS_LEAF_REMOVE_RMT,\t\"XFS_DAS_LEAF_REMOVE_RMT\" }, \\\n\t{ XFS_DAS_LEAF_REMOVE_ATTR,\t\"XFS_DAS_LEAF_REMOVE_ATTR\" }, \\\n\t{ XFS_DAS_NODE_SET_RMT,\t\t\"XFS_DAS_NODE_SET_RMT\" }, \\\n\t{ XFS_DAS_NODE_ALLOC_RMT,\t\"XFS_DAS_NODE_ALLOC_RMT\" },  \\\n\t{ XFS_DAS_NODE_REPLACE,\t\t\"XFS_DAS_NODE_REPLACE\" },  \\\n\t{ XFS_DAS_NODE_REMOVE_OLD,\t\"XFS_DAS_NODE_REMOVE_OLD\" }, \\\n\t{ XFS_DAS_NODE_REMOVE_RMT,\t\"XFS_DAS_NODE_REMOVE_RMT\" }, \\\n\t{ XFS_DAS_NODE_REMOVE_ATTR,\t\"XFS_DAS_NODE_REMOVE_ATTR\" }, \\\n\t{ XFS_DAS_DONE,\t\t\t\"XFS_DAS_DONE\" }\n\nstruct xfs_attri_log_nameval;\n\n \nstruct xfs_attr_intent {\n\t \n\tstruct list_head\t\txattri_list;\n\n\t \n\tstruct xfs_da_state\t\t*xattri_da_state;\n\n\tstruct xfs_da_args\t\t*xattri_da_args;\n\n\t \n\tstruct xfs_attri_log_nameval\t*xattri_nameval;\n\n\t \n\tenum xfs_delattr_state\t\txattri_dela_state;\n\n\t \n\tunsigned int\t\t\txattri_op_flags;\n\n\t \n\txfs_dablk_t\t\t\txattri_lblkno;\n\tint\t\t\t\txattri_blkcnt;\n\tstruct xfs_bmbt_irec\t\txattri_map;\n};\n\n\n \n\n \nint xfs_attr_inactive(struct xfs_inode *dp);\nint xfs_attr_list_ilocked(struct xfs_attr_list_context *);\nint xfs_attr_list(struct xfs_attr_list_context *);\nint xfs_inode_hasattr(struct xfs_inode *ip);\nbool xfs_attr_is_leaf(struct xfs_inode *ip);\nint xfs_attr_get_ilocked(struct xfs_da_args *args);\nint xfs_attr_get(struct xfs_da_args *args);\nint xfs_attr_set(struct xfs_da_args *args);\nint xfs_attr_set_iter(struct xfs_attr_intent *attr);\nint xfs_attr_remove_iter(struct xfs_attr_intent *attr);\nbool xfs_attr_namecheck(const void *name, size_t length);\nint xfs_attr_calc_size(struct xfs_da_args *args, int *local);\nvoid xfs_init_attr_trans(struct xfs_da_args *args, struct xfs_trans_res *tres,\n\t\t\t unsigned int *total);\n\n \nstatic inline bool\nxfs_attr_is_shortform(\n\tstruct xfs_inode    *ip)\n{\n\treturn ip->i_af.if_format == XFS_DINODE_FMT_LOCAL ||\n\t       (ip->i_af.if_format == XFS_DINODE_FMT_EXTENTS &&\n\t\tip->i_af.if_nextents == 0);\n}\n\nstatic inline enum xfs_delattr_state\nxfs_attr_init_add_state(struct xfs_da_args *args)\n{\n\t \n\tif (!xfs_inode_has_attr_fork(args->dp))\n\t\treturn XFS_DAS_DONE;\n\n\targs->op_flags |= XFS_DA_OP_ADDNAME;\n\tif (xfs_attr_is_shortform(args->dp))\n\t\treturn XFS_DAS_SF_ADD;\n\tif (xfs_attr_is_leaf(args->dp))\n\t\treturn XFS_DAS_LEAF_ADD;\n\treturn XFS_DAS_NODE_ADD;\n}\n\nstatic inline enum xfs_delattr_state\nxfs_attr_init_remove_state(struct xfs_da_args *args)\n{\n\targs->op_flags |= XFS_DA_OP_REMOVE;\n\tif (xfs_attr_is_shortform(args->dp))\n\t\treturn XFS_DAS_SF_REMOVE;\n\tif (xfs_attr_is_leaf(args->dp))\n\t\treturn XFS_DAS_LEAF_REMOVE;\n\treturn XFS_DAS_NODE_REMOVE;\n}\n\n \nstatic inline enum xfs_delattr_state\nxfs_attr_init_replace_state(struct xfs_da_args *args)\n{\n\targs->op_flags |= XFS_DA_OP_ADDNAME | XFS_DA_OP_REPLACE;\n\tif (args->op_flags & XFS_DA_OP_LOGGED)\n\t\treturn xfs_attr_init_remove_state(args);\n\treturn xfs_attr_init_add_state(args);\n}\n\nextern struct kmem_cache *xfs_attr_intent_cache;\nint __init xfs_attr_intent_init_cache(void);\nvoid xfs_attr_intent_destroy_cache(void);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}