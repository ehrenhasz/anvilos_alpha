{
  "module_name": "xfs_trans_inode.c",
  "hash_id": "f58ca04d745bcb715bc03fa59606e95f9afdf073c0e2f26b935da1a1edeb1c9a",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/libxfs/xfs_trans_inode.c",
  "human_readable_source": "\n \n#include \"xfs.h\"\n#include \"xfs_fs.h\"\n#include \"xfs_shared.h\"\n#include \"xfs_format.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_inode.h\"\n#include \"xfs_trans.h\"\n#include \"xfs_trans_priv.h\"\n#include \"xfs_inode_item.h\"\n\n#include <linux/iversion.h>\n\n \nvoid\nxfs_trans_ijoin(\n\tstruct xfs_trans\t*tp,\n\tstruct xfs_inode\t*ip,\n\tuint\t\t\tlock_flags)\n{\n\tstruct xfs_inode_log_item *iip;\n\n\tASSERT(xfs_isilocked(ip, XFS_ILOCK_EXCL));\n\tif (ip->i_itemp == NULL)\n\t\txfs_inode_item_init(ip, ip->i_mount);\n\tiip = ip->i_itemp;\n\n\tASSERT(iip->ili_lock_flags == 0);\n\tiip->ili_lock_flags = lock_flags;\n\tASSERT(!xfs_iflags_test(ip, XFS_ISTALE));\n\n\t \n\tiip->ili_dirty_flags = 0;\n\txfs_trans_add_item(tp, &iip->ili_item);\n}\n\n \nvoid\nxfs_trans_ichgtime(\n\tstruct xfs_trans\t*tp,\n\tstruct xfs_inode\t*ip,\n\tint\t\t\tflags)\n{\n\tstruct inode\t\t*inode = VFS_I(ip);\n\tstruct timespec64\ttv;\n\n\tASSERT(tp);\n\tASSERT(xfs_isilocked(ip, XFS_ILOCK_EXCL));\n\n\ttv = current_time(inode);\n\n\tif (flags & XFS_ICHGTIME_MOD)\n\t\tinode->i_mtime = tv;\n\tif (flags & XFS_ICHGTIME_CHG)\n\t\tinode_set_ctime_to_ts(inode, tv);\n\tif (flags & XFS_ICHGTIME_CREATE)\n\t\tip->i_crtime = tv;\n}\n\n \nvoid\nxfs_trans_log_inode(\n\tstruct xfs_trans\t*tp,\n\tstruct xfs_inode\t*ip,\n\tuint\t\t\tflags)\n{\n\tstruct xfs_inode_log_item *iip = ip->i_itemp;\n\tstruct inode\t\t*inode = VFS_I(ip);\n\n\tASSERT(iip);\n\tASSERT(xfs_isilocked(ip, XFS_ILOCK_EXCL));\n\tASSERT(!xfs_iflags_test(ip, XFS_ISTALE));\n\n\ttp->t_flags |= XFS_TRANS_DIRTY;\n\n\t \n\tif (!test_and_set_bit(XFS_LI_DIRTY, &iip->ili_item.li_flags)) {\n\t\tif (IS_I_VERSION(inode) &&\n\t\t    inode_maybe_inc_iversion(inode, flags & XFS_ILOG_CORE))\n\t\t\tflags |= XFS_ILOG_IVERSION;\n\t}\n\n\tiip->ili_dirty_flags |= flags;\n}\n\nint\nxfs_trans_roll_inode(\n\tstruct xfs_trans\t**tpp,\n\tstruct xfs_inode\t*ip)\n{\n\tint\t\t\terror;\n\n\txfs_trans_log_inode(*tpp, ip, XFS_ILOG_CORE);\n\terror = xfs_trans_roll(tpp);\n\tif (!error)\n\t\txfs_trans_ijoin(*tpp, ip, 0);\n\treturn error;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}