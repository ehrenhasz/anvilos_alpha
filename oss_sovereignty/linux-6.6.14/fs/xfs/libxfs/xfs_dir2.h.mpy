{
  "module_name": "xfs_dir2.h",
  "hash_id": "c858a0b9533cad4102b1284f8e8b8a647a3a5b530e965e219615fec02acf699a",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/libxfs/xfs_dir2.h",
  "human_readable_source": " \n \n#ifndef __XFS_DIR2_H__\n#define __XFS_DIR2_H__\n\n#include \"xfs_da_format.h\"\n#include \"xfs_da_btree.h\"\n\nstruct xfs_da_args;\nstruct xfs_inode;\nstruct xfs_mount;\nstruct xfs_trans;\nstruct xfs_dir2_sf_hdr;\nstruct xfs_dir2_sf_entry;\nstruct xfs_dir2_data_hdr;\nstruct xfs_dir2_data_entry;\nstruct xfs_dir2_data_unused;\nstruct xfs_dir3_icfree_hdr;\nstruct xfs_dir3_icleaf_hdr;\n\nextern const struct xfs_name\txfs_name_dotdot;\n\n \nextern unsigned char xfs_mode_to_ftype(int mode);\n\n \nextern void xfs_dir_startup(void);\nextern int xfs_da_mount(struct xfs_mount *mp);\nextern void xfs_da_unmount(struct xfs_mount *mp);\n\nextern int xfs_dir_isempty(struct xfs_inode *dp);\nextern int xfs_dir_init(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tstruct xfs_inode *pdp);\nextern int xfs_dir_createname(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tconst struct xfs_name *name, xfs_ino_t inum,\n\t\t\t\txfs_extlen_t tot);\nextern int xfs_dir_lookup(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tconst struct xfs_name *name, xfs_ino_t *inum,\n\t\t\t\tstruct xfs_name *ci_name);\nextern int xfs_dir_removename(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tstruct xfs_name *name, xfs_ino_t ino,\n\t\t\t\txfs_extlen_t tot);\nextern int xfs_dir_replace(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tconst struct xfs_name *name, xfs_ino_t inum,\n\t\t\t\txfs_extlen_t tot);\nextern int xfs_dir_canenter(struct xfs_trans *tp, struct xfs_inode *dp,\n\t\t\t\tstruct xfs_name *name);\n\n \nextern int xfs_dir2_sf_to_block(struct xfs_da_args *args);\n\n \nextern int xfs_dir2_isblock(struct xfs_da_args *args, bool *isblock);\nextern int xfs_dir2_isleaf(struct xfs_da_args *args, bool *isleaf);\nextern int xfs_dir2_shrink_inode(struct xfs_da_args *args, xfs_dir2_db_t db,\n\t\t\t\tstruct xfs_buf *bp);\n\nextern void xfs_dir2_data_freescan(struct xfs_mount *mp,\n\t\tstruct xfs_dir2_data_hdr *hdr, int *loghead);\nextern void xfs_dir2_data_log_entry(struct xfs_da_args *args,\n\t\tstruct xfs_buf *bp, struct xfs_dir2_data_entry *dep);\nextern void xfs_dir2_data_log_header(struct xfs_da_args *args,\n\t\tstruct xfs_buf *bp);\nextern void xfs_dir2_data_log_unused(struct xfs_da_args *args,\n\t\tstruct xfs_buf *bp, struct xfs_dir2_data_unused *dup);\nextern void xfs_dir2_data_make_free(struct xfs_da_args *args,\n\t\tstruct xfs_buf *bp, xfs_dir2_data_aoff_t offset,\n\t\txfs_dir2_data_aoff_t len, int *needlogp, int *needscanp);\nextern int xfs_dir2_data_use_free(struct xfs_da_args *args,\n\t\tstruct xfs_buf *bp, struct xfs_dir2_data_unused *dup,\n\t\txfs_dir2_data_aoff_t offset, xfs_dir2_data_aoff_t len,\n\t\tint *needlogp, int *needscanp);\n\nextern struct xfs_dir2_data_free *xfs_dir2_data_freefind(\n\t\tstruct xfs_dir2_data_hdr *hdr, struct xfs_dir2_data_free *bf,\n\t\tstruct xfs_dir2_data_unused *dup);\n\nextern int xfs_dir_ino_validate(struct xfs_mount *mp, xfs_ino_t ino);\n\nextern const struct xfs_buf_ops xfs_dir3_block_buf_ops;\nextern const struct xfs_buf_ops xfs_dir3_leafn_buf_ops;\nextern const struct xfs_buf_ops xfs_dir3_leaf1_buf_ops;\nextern const struct xfs_buf_ops xfs_dir3_free_buf_ops;\nextern const struct xfs_buf_ops xfs_dir3_data_buf_ops;\n\n \n\n \nstatic inline xfs_dir2_off_t\nxfs_dir2_dataptr_to_byte(xfs_dir2_dataptr_t dp)\n{\n\treturn (xfs_dir2_off_t)dp << XFS_DIR2_DATA_ALIGN_LOG;\n}\n\n \nstatic inline xfs_dir2_dataptr_t\nxfs_dir2_byte_to_dataptr(xfs_dir2_off_t by)\n{\n\treturn (xfs_dir2_dataptr_t)(by >> XFS_DIR2_DATA_ALIGN_LOG);\n}\n\n \nstatic inline xfs_dir2_db_t\nxfs_dir2_byte_to_db(struct xfs_da_geometry *geo, xfs_dir2_off_t by)\n{\n\treturn (xfs_dir2_db_t)(by >> geo->blklog);\n}\n\n \nstatic inline xfs_dir2_db_t\nxfs_dir2_dataptr_to_db(struct xfs_da_geometry *geo, xfs_dir2_dataptr_t dp)\n{\n\treturn xfs_dir2_byte_to_db(geo, xfs_dir2_dataptr_to_byte(dp));\n}\n\n \nstatic inline xfs_dir2_data_aoff_t\nxfs_dir2_byte_to_off(struct xfs_da_geometry *geo, xfs_dir2_off_t by)\n{\n\treturn (xfs_dir2_data_aoff_t)(by & (geo->blksize - 1));\n}\n\n \nstatic inline xfs_dir2_data_aoff_t\nxfs_dir2_dataptr_to_off(struct xfs_da_geometry *geo, xfs_dir2_dataptr_t dp)\n{\n\treturn xfs_dir2_byte_to_off(geo, xfs_dir2_dataptr_to_byte(dp));\n}\n\n \nstatic inline xfs_dir2_off_t\nxfs_dir2_db_off_to_byte(struct xfs_da_geometry *geo, xfs_dir2_db_t db,\n\t\t\txfs_dir2_data_aoff_t o)\n{\n\treturn ((xfs_dir2_off_t)db << geo->blklog) + o;\n}\n\n \nstatic inline xfs_dablk_t\nxfs_dir2_db_to_da(struct xfs_da_geometry *geo, xfs_dir2_db_t db)\n{\n\treturn (xfs_dablk_t)(db << (geo->blklog - geo->fsblog));\n}\n\n \nstatic inline xfs_dablk_t\nxfs_dir2_byte_to_da(struct xfs_da_geometry *geo, xfs_dir2_off_t by)\n{\n\treturn xfs_dir2_db_to_da(geo, xfs_dir2_byte_to_db(geo, by));\n}\n\n \nstatic inline xfs_dir2_dataptr_t\nxfs_dir2_db_off_to_dataptr(struct xfs_da_geometry *geo, xfs_dir2_db_t db,\n\t\t\t   xfs_dir2_data_aoff_t o)\n{\n\treturn xfs_dir2_byte_to_dataptr(xfs_dir2_db_off_to_byte(geo, db, o));\n}\n\n \nstatic inline xfs_dir2_db_t\nxfs_dir2_da_to_db(struct xfs_da_geometry *geo, xfs_dablk_t da)\n{\n\treturn (xfs_dir2_db_t)(da >> (geo->blklog - geo->fsblog));\n}\n\n \nstatic inline xfs_dir2_off_t\nxfs_dir2_da_to_byte(struct xfs_da_geometry *geo, xfs_dablk_t da)\n{\n\treturn xfs_dir2_db_off_to_byte(geo, xfs_dir2_da_to_db(geo, da), 0);\n}\n\n \nstatic inline struct xfs_dir2_block_tail *\nxfs_dir2_block_tail_p(struct xfs_da_geometry *geo, struct xfs_dir2_data_hdr *hdr)\n{\n\treturn ((struct xfs_dir2_block_tail *)\n\t\t((char *)hdr + geo->blksize)) - 1;\n}\n\nstatic inline struct xfs_dir2_leaf_tail *\nxfs_dir2_leaf_tail_p(struct xfs_da_geometry *geo, struct xfs_dir2_leaf *lp)\n{\n\treturn (struct xfs_dir2_leaf_tail *)\n\t\t((char *)lp + geo->blksize -\n\t\t  sizeof(struct xfs_dir2_leaf_tail));\n}\n\n \n#define XFS_READDIR_BUFSIZE\t(32768)\n\nunsigned char xfs_dir3_get_dtype(struct xfs_mount *mp, uint8_t filetype);\nunsigned int xfs_dir3_data_end_offset(struct xfs_da_geometry *geo,\n\t\tstruct xfs_dir2_data_hdr *hdr);\nbool xfs_dir2_namecheck(const void *name, size_t length);\n\n \nstatic inline bool xfs_ascii_ci_need_xfrm(unsigned char c)\n{\n\tif (c >= 0x41 && c <= 0x5a)\t \n\t\treturn true;\n\tif (c >= 0xc0 && c <= 0xd6)\t \n\t\treturn true;\n\tif (c >= 0xd8 && c <= 0xde)\t \n\t\treturn true;\n\treturn false;\n}\n\nstatic inline unsigned char xfs_ascii_ci_xfrm(unsigned char c)\n{\n\tif (xfs_ascii_ci_need_xfrm(c))\n\t\tc -= 'A' - 'a';\n\treturn c;\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}