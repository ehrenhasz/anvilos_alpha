{
  "module_name": "xfs_alloc.h",
  "hash_id": "910e6020e90f336634bb9937e0cc3afa7db650284867c7e59ae6f38291b36683",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/libxfs/xfs_alloc.h",
  "human_readable_source": " \n \n#ifndef __XFS_ALLOC_H__\n#define\t__XFS_ALLOC_H__\n\nstruct xfs_buf;\nstruct xfs_btree_cur;\nstruct xfs_mount;\nstruct xfs_perag;\nstruct xfs_trans;\n\nextern struct workqueue_struct *xfs_alloc_wq;\n\nunsigned int xfs_agfl_size(struct xfs_mount *mp);\n\n \n#define\tXFS_ALLOC_FLAG_TRYLOCK\t(1U << 0)   \n#define\tXFS_ALLOC_FLAG_FREEING\t(1U << 1)   \n#define\tXFS_ALLOC_FLAG_NORMAP\t(1U << 2)   \n#define\tXFS_ALLOC_FLAG_NOSHRINK\t(1U << 3)   \n#define\tXFS_ALLOC_FLAG_CHECK\t(1U << 4)   \n#define\tXFS_ALLOC_FLAG_TRYFLUSH\t(1U << 5)   \n\n \ntypedef struct xfs_alloc_arg {\n\tstruct xfs_trans *tp;\t\t \n\tstruct xfs_mount *mp;\t\t \n\tstruct xfs_buf\t*agbp;\t\t \n\tstruct xfs_perag *pag;\t\t \n\txfs_fsblock_t\tfsbno;\t\t \n\txfs_agnumber_t\tagno;\t\t \n\txfs_agblock_t\tagbno;\t\t \n\txfs_extlen_t\tminlen;\t\t \n\txfs_extlen_t\tmaxlen;\t\t \n\txfs_extlen_t\tmod;\t\t \n\txfs_extlen_t\tprod;\t\t \n\txfs_extlen_t\tminleft;\t \n\txfs_extlen_t\ttotal;\t\t \n\txfs_extlen_t\talignment;\t \n\txfs_extlen_t\tminalignslop;\t \n\txfs_agblock_t\tmin_agbno;\t \n\txfs_agblock_t\tmax_agbno;\t \n\txfs_extlen_t\tlen;\t\t \n\tint\t\tdatatype;\t \n\tchar\t\twasdel;\t\t \n\tchar\t\twasfromfl;\t \n\tstruct xfs_owner_info\toinfo;\t \n\tenum xfs_ag_resv_type\tresv;\t \n#ifdef DEBUG\n\tbool\t\talloc_minlen_only;  \n#endif\n} xfs_alloc_arg_t;\n\n \n#define XFS_ALLOC_USERDATA\t\t(1 << 0) \n#define XFS_ALLOC_INITIAL_USER_DATA\t(1 << 1) \n#define XFS_ALLOC_NOBUSY\t\t(1 << 2) \n\n \nunsigned int xfs_alloc_set_aside(struct xfs_mount *mp);\nunsigned int xfs_alloc_ag_max_usable(struct xfs_mount *mp);\n\nxfs_extlen_t xfs_alloc_longest_free_extent(struct xfs_perag *pag,\n\t\txfs_extlen_t need, xfs_extlen_t reserved);\nunsigned int xfs_alloc_min_freelist(struct xfs_mount *mp,\n\t\tstruct xfs_perag *pag);\nint xfs_alloc_get_freelist(struct xfs_perag *pag, struct xfs_trans *tp,\n\t\tstruct xfs_buf *agfbp, xfs_agblock_t *bnop, int\t btreeblk);\nint xfs_alloc_put_freelist(struct xfs_perag *pag, struct xfs_trans *tp,\n\t\tstruct xfs_buf *agfbp, struct xfs_buf *agflbp,\n\t\txfs_agblock_t bno, int btreeblk);\n\n \nvoid\nxfs_alloc_compute_maxlevels(\n\tstruct xfs_mount\t*mp);\t \n\n \nvoid\nxfs_alloc_log_agf(\n\tstruct xfs_trans *tp,\t \n\tstruct xfs_buf\t*bp,\t \n\tuint32_t\tfields); \n\n \nint xfs_alloc_vextent_this_ag(struct xfs_alloc_arg *args, xfs_agnumber_t agno);\n\n \nint xfs_alloc_vextent_near_bno(struct xfs_alloc_arg *args,\n\t\txfs_fsblock_t target);\n\n \nint xfs_alloc_vextent_exact_bno(struct xfs_alloc_arg *args,\n\t\txfs_fsblock_t target);\n\n \nint xfs_alloc_vextent_start_ag(struct xfs_alloc_arg *args,\n\t\txfs_fsblock_t target);\n\n \nint xfs_alloc_vextent_first_ag(struct xfs_alloc_arg *args,\n\t\txfs_fsblock_t target);\n\n \nint\t\t\t\t \n__xfs_free_extent(\n\tstruct xfs_trans\t*tp,\t \n\tstruct xfs_perag\t*pag,\n\txfs_agblock_t\t\tagbno,\n\txfs_extlen_t\t\tlen,\t \n\tconst struct xfs_owner_info\t*oinfo,\t \n\tenum xfs_ag_resv_type\ttype,\t \n\tbool\t\t\tskip_discard);\n\nstatic inline int\nxfs_free_extent(\n\tstruct xfs_trans\t*tp,\n\tstruct xfs_perag\t*pag,\n\txfs_agblock_t\t\tagbno,\n\txfs_extlen_t\t\tlen,\n\tconst struct xfs_owner_info\t*oinfo,\n\tenum xfs_ag_resv_type\ttype)\n{\n\treturn __xfs_free_extent(tp, pag, agbno, len, oinfo, type, false);\n}\n\nint\t\t\t\t \nxfs_alloc_lookup_le(\n\tstruct xfs_btree_cur\t*cur,\t \n\txfs_agblock_t\t\tbno,\t \n\txfs_extlen_t\t\tlen,\t \n\tint\t\t\t*stat);\t \n\nint\t\t\t\t \nxfs_alloc_lookup_ge(\n\tstruct xfs_btree_cur\t*cur,\t \n\txfs_agblock_t\t\tbno,\t \n\txfs_extlen_t\t\tlen,\t \n\tint\t\t\t*stat);\t \n\nint\t\t\t\t\t \nxfs_alloc_get_rec(\n\tstruct xfs_btree_cur\t*cur,\t \n\txfs_agblock_t\t\t*bno,\t \n\txfs_extlen_t\t\t*len,\t \n\tint\t\t\t*stat);\t \n\nunion xfs_btree_rec;\nvoid xfs_alloc_btrec_to_irec(const union xfs_btree_rec *rec,\n\t\tstruct xfs_alloc_rec_incore *irec);\nxfs_failaddr_t xfs_alloc_check_irec(struct xfs_btree_cur *cur,\n\t\tconst struct xfs_alloc_rec_incore *irec);\n\nint xfs_read_agf(struct xfs_perag *pag, struct xfs_trans *tp, int flags,\n\t\tstruct xfs_buf **agfbpp);\nint xfs_alloc_read_agf(struct xfs_perag *pag, struct xfs_trans *tp, int flags,\n\t\tstruct xfs_buf **agfbpp);\nint xfs_alloc_read_agfl(struct xfs_perag *pag, struct xfs_trans *tp,\n\t\tstruct xfs_buf **bpp);\nint xfs_free_agfl_block(struct xfs_trans *, xfs_agnumber_t, xfs_agblock_t,\n\t\t\tstruct xfs_buf *, struct xfs_owner_info *);\nint xfs_alloc_fix_freelist(struct xfs_alloc_arg *args, uint32_t alloc_flags);\nint xfs_free_extent_fix_freelist(struct xfs_trans *tp, struct xfs_perag *pag,\n\t\tstruct xfs_buf **agbp);\n\nxfs_extlen_t xfs_prealloc_blocks(struct xfs_mount *mp);\n\ntypedef int (*xfs_alloc_query_range_fn)(\n\tstruct xfs_btree_cur\t\t\t*cur,\n\tconst struct xfs_alloc_rec_incore\t*rec,\n\tvoid\t\t\t\t\t*priv);\n\nint xfs_alloc_query_range(struct xfs_btree_cur *cur,\n\t\tconst struct xfs_alloc_rec_incore *low_rec,\n\t\tconst struct xfs_alloc_rec_incore *high_rec,\n\t\txfs_alloc_query_range_fn fn, void *priv);\nint xfs_alloc_query_all(struct xfs_btree_cur *cur, xfs_alloc_query_range_fn fn,\n\t\tvoid *priv);\n\nint xfs_alloc_has_records(struct xfs_btree_cur *cur, xfs_agblock_t bno,\n\t\txfs_extlen_t len, enum xbtree_recpacking *outcome);\n\ntypedef int (*xfs_agfl_walk_fn)(struct xfs_mount *mp, xfs_agblock_t bno,\n\t\tvoid *priv);\nint xfs_agfl_walk(struct xfs_mount *mp, struct xfs_agf *agf,\n\t\tstruct xfs_buf *agflbp, xfs_agfl_walk_fn walk_fn, void *priv);\n\nstatic inline __be32 *\nxfs_buf_to_agfl_bno(\n\tstruct xfs_buf\t\t*bp)\n{\n\tif (xfs_has_crc(bp->b_mount))\n\t\treturn bp->b_addr + sizeof(struct xfs_agfl);\n\treturn bp->b_addr;\n}\n\nint __xfs_free_extent_later(struct xfs_trans *tp, xfs_fsblock_t bno,\n\t\txfs_filblks_t len, const struct xfs_owner_info *oinfo,\n\t\tenum xfs_ag_resv_type type, bool skip_discard);\n\n \nstruct xfs_extent_free_item {\n\tstruct list_head\txefi_list;\n\tuint64_t\t\txefi_owner;\n\txfs_fsblock_t\t\txefi_startblock; \n\txfs_extlen_t\t\txefi_blockcount; \n\tstruct xfs_perag\t*xefi_pag;\n\tunsigned int\t\txefi_flags;\n\tenum xfs_ag_resv_type\txefi_agresv;\n};\n\nvoid xfs_extent_free_get_group(struct xfs_mount *mp,\n\t\tstruct xfs_extent_free_item *xefi);\n\n#define XFS_EFI_SKIP_DISCARD\t(1U << 0)  \n#define XFS_EFI_ATTR_FORK\t(1U << 1)  \n#define XFS_EFI_BMBT_BLOCK\t(1U << 2)  \n\nstatic inline int\nxfs_free_extent_later(\n\tstruct xfs_trans\t\t*tp,\n\txfs_fsblock_t\t\t\tbno,\n\txfs_filblks_t\t\t\tlen,\n\tconst struct xfs_owner_info\t*oinfo,\n\tenum xfs_ag_resv_type\t\ttype)\n{\n\treturn __xfs_free_extent_later(tp, bno, len, oinfo, type, false);\n}\n\n\nextern struct kmem_cache\t*xfs_extfree_item_cache;\n\nint __init xfs_extfree_intent_init_cache(void);\nvoid xfs_extfree_intent_destroy_cache(void);\n\nxfs_failaddr_t xfs_validate_ag_length(struct xfs_buf *bp, uint32_t seqno,\n\t\tuint32_t length);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}