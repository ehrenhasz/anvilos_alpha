{
  "module_name": "xfs_bmap_btree.h",
  "hash_id": "bb2fb42e5ca72b00a81e73154ba638d573a97a272fd50a60b4c6b16e768624ed",
  "original_prompt": "Ingested from linux-6.6.14/fs/xfs/libxfs/xfs_bmap_btree.h",
  "human_readable_source": " \n \n#ifndef __XFS_BMAP_BTREE_H__\n#define __XFS_BMAP_BTREE_H__\n\nstruct xfs_btree_cur;\nstruct xfs_btree_block;\nstruct xfs_mount;\nstruct xfs_inode;\nstruct xfs_trans;\n\n \n#define XFS_BMBT_BLOCK_LEN(mp) \\\n\t(xfs_has_crc(((mp))) ? \\\n\t\tXFS_BTREE_LBLOCK_CRC_LEN : XFS_BTREE_LBLOCK_LEN)\n\n#define XFS_BMBT_REC_ADDR(mp, block, index) \\\n\t((xfs_bmbt_rec_t *) \\\n\t\t((char *)(block) + \\\n\t\t XFS_BMBT_BLOCK_LEN(mp) + \\\n\t\t ((index) - 1) * sizeof(xfs_bmbt_rec_t)))\n\n#define XFS_BMBT_KEY_ADDR(mp, block, index) \\\n\t((xfs_bmbt_key_t *) \\\n\t\t((char *)(block) + \\\n\t\t XFS_BMBT_BLOCK_LEN(mp) + \\\n\t\t ((index) - 1) * sizeof(xfs_bmbt_key_t)))\n\n#define XFS_BMBT_PTR_ADDR(mp, block, index, maxrecs) \\\n\t((xfs_bmbt_ptr_t *) \\\n\t\t((char *)(block) + \\\n\t\t XFS_BMBT_BLOCK_LEN(mp) + \\\n\t\t (maxrecs) * sizeof(xfs_bmbt_key_t) + \\\n\t\t ((index) - 1) * sizeof(xfs_bmbt_ptr_t)))\n\n#define XFS_BMDR_REC_ADDR(block, index) \\\n\t((xfs_bmdr_rec_t *) \\\n\t\t((char *)(block) + \\\n\t\t sizeof(struct xfs_bmdr_block) + \\\n\t         ((index) - 1) * sizeof(xfs_bmdr_rec_t)))\n\n#define XFS_BMDR_KEY_ADDR(block, index) \\\n\t((xfs_bmdr_key_t *) \\\n\t\t((char *)(block) + \\\n\t\t sizeof(struct xfs_bmdr_block) + \\\n\t\t ((index) - 1) * sizeof(xfs_bmdr_key_t)))\n\n#define XFS_BMDR_PTR_ADDR(block, index, maxrecs) \\\n\t((xfs_bmdr_ptr_t *) \\\n\t\t((char *)(block) + \\\n\t\t sizeof(struct xfs_bmdr_block) + \\\n\t\t (maxrecs) * sizeof(xfs_bmdr_key_t) + \\\n\t\t ((index) - 1) * sizeof(xfs_bmdr_ptr_t)))\n\n \n#define XFS_BMAP_BROOT_PTR_ADDR(mp, bb, i, sz) \\\n\tXFS_BMBT_PTR_ADDR(mp, bb, i, xfs_bmbt_maxrecs(mp, sz, 0))\n\n#define XFS_BMAP_BROOT_SPACE_CALC(mp, nrecs) \\\n\t(int)(XFS_BMBT_BLOCK_LEN(mp) + \\\n\t       ((nrecs) * (sizeof(xfs_bmbt_key_t) + sizeof(xfs_bmbt_ptr_t))))\n\n#define XFS_BMAP_BROOT_SPACE(mp, bb) \\\n\t(XFS_BMAP_BROOT_SPACE_CALC(mp, be16_to_cpu((bb)->bb_numrecs)))\n#define XFS_BMDR_SPACE_CALC(nrecs) \\\n\t(int)(sizeof(xfs_bmdr_block_t) + \\\n\t       ((nrecs) * (sizeof(xfs_bmbt_key_t) + sizeof(xfs_bmbt_ptr_t))))\n#define XFS_BMAP_BMDR_SPACE(bb) \\\n\t(XFS_BMDR_SPACE_CALC(be16_to_cpu((bb)->bb_numrecs)))\n\n \n#define XFS_BM_MAXLEVELS(mp,w)\t\t((mp)->m_bm_maxlevels[(w)])\n\n \nextern void xfs_bmdr_to_bmbt(struct xfs_inode *, xfs_bmdr_block_t *, int,\n\t\t\tstruct xfs_btree_block *, int);\n\nvoid xfs_bmbt_disk_set_all(struct xfs_bmbt_rec *r, struct xfs_bmbt_irec *s);\nextern xfs_filblks_t xfs_bmbt_disk_get_blockcount(const struct xfs_bmbt_rec *r);\nextern xfs_fileoff_t xfs_bmbt_disk_get_startoff(const struct xfs_bmbt_rec *r);\nvoid xfs_bmbt_disk_get_all(const struct xfs_bmbt_rec *r,\n\t\tstruct xfs_bmbt_irec *s);\n\nextern void xfs_bmbt_to_bmdr(struct xfs_mount *, struct xfs_btree_block *, int,\n\t\t\txfs_bmdr_block_t *, int);\n\nextern int xfs_bmbt_get_maxrecs(struct xfs_btree_cur *, int level);\nextern int xfs_bmdr_maxrecs(int blocklen, int leaf);\nextern int xfs_bmbt_maxrecs(struct xfs_mount *, int blocklen, int leaf);\n\nextern int xfs_bmbt_change_owner(struct xfs_trans *tp, struct xfs_inode *ip,\n\t\t\t\t int whichfork, xfs_ino_t new_owner,\n\t\t\t\t struct list_head *buffer_list);\n\nextern struct xfs_btree_cur *xfs_bmbt_init_cursor(struct xfs_mount *,\n\t\tstruct xfs_trans *, struct xfs_inode *, int);\n\nextern unsigned long long xfs_bmbt_calc_size(struct xfs_mount *mp,\n\t\tunsigned long long len);\n\nunsigned int xfs_bmbt_maxlevels_ondisk(void);\n\nint __init xfs_bmbt_init_cur_cache(void);\nvoid xfs_bmbt_destroy_cur_cache(void);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}