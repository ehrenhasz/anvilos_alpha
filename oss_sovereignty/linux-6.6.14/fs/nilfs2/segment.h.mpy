{
  "module_name": "segment.h",
  "hash_id": "c3563f2a428155339fb1e8ac4e4f0eea5d1117b59e3039fed75891cfdad6bad0",
  "original_prompt": "Ingested from linux-6.6.14/fs/nilfs2/segment.h",
  "human_readable_source": " \n \n#ifndef _NILFS_SEGMENT_H\n#define _NILFS_SEGMENT_H\n\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/workqueue.h>\n#include \"nilfs.h\"\n\nstruct nilfs_root;\n\n \nstruct nilfs_recovery_info {\n\tint\t\t\tri_need_recovery;\n\tsector_t\t\tri_super_root;\n\t__u64\t\t\tri_cno;\n\n\tsector_t\t\tri_lsegs_start;\n\tsector_t\t\tri_lsegs_end;\n\tu64\t\t\tri_lsegs_start_seq;\n\tstruct list_head\tri_used_segments;\n\tsector_t\t\tri_pseg_start;\n\tu64\t\t\tri_seq;\n\t__u64\t\t\tri_segnum;\n\t__u64\t\t\tri_nextnum;\n};\n\n \n#define NILFS_RECOVERY_SR_UPDATED\t 1   \n#define NILFS_RECOVERY_ROLLFORWARD_DONE\t 2   \n\n \nstruct nilfs_cstage {\n\tint\t\t\tscnt;\n\tunsigned int\t\tflags;\n\tstruct nilfs_inode_info *dirty_file_ptr;\n\tstruct nilfs_inode_info *gc_inode_ptr;\n};\n\nstruct nilfs_segment_buffer;\n\nstruct nilfs_segsum_pointer {\n\tstruct buffer_head     *bh;\n\tunsigned int\t\toffset;  \n};\n\n \nstruct nilfs_sc_info {\n\tstruct super_block     *sc_super;\n\tstruct nilfs_root      *sc_root;\n\n\tunsigned long\t\tsc_nblk_inc;\n\n\tstruct list_head\tsc_dirty_files;\n\tstruct list_head\tsc_gc_inodes;\n\tstruct list_head\tsc_iput_queue;\n\tstruct work_struct\tsc_iput_work;\n\n\t__u64\t\t       *sc_freesegs;\n\tsize_t\t\t\tsc_nfreesegs;\n\n\tstruct nilfs_inode_info *sc_dsync_inode;\n\tloff_t\t\t\tsc_dsync_start;\n\tloff_t\t\t\tsc_dsync_end;\n\n\t \n\tstruct list_head\tsc_segbufs;\n\tstruct list_head\tsc_write_logs;\n\tunsigned long\t\tsc_segbuf_nblocks;\n\tstruct nilfs_segment_buffer *sc_curseg;\n\n\tstruct nilfs_cstage\tsc_stage;\n\n\tstruct nilfs_segsum_pointer sc_finfo_ptr;\n\tstruct nilfs_segsum_pointer sc_binfo_ptr;\n\tunsigned long\t\tsc_blk_cnt;\n\tunsigned long\t\tsc_datablk_cnt;\n\tunsigned long\t\tsc_nblk_this_inc;\n\ttime64_t\t\tsc_seg_ctime;\n\t__u64\t\t\tsc_cno;\n\tunsigned long\t\tsc_flags;\n\n\tspinlock_t\t\tsc_state_lock;\n\tunsigned long\t\tsc_state;\n\tunsigned long\t\tsc_flush_request;\n\n\twait_queue_head_t\tsc_wait_request;\n\twait_queue_head_t\tsc_wait_daemon;\n\twait_queue_head_t\tsc_wait_task;\n\n\t__u32\t\t\tsc_seq_request;\n\t__u32\t\t\tsc_seq_accepted;\n\t__u32\t\t\tsc_seq_done;\n\n\tint\t\t\tsc_sync;\n\tunsigned long\t\tsc_interval;\n\tunsigned long\t\tsc_mjcp_freq;\n\tunsigned long\t\tsc_lseg_stime;\t \n\tunsigned long\t\tsc_watermark;\n\n\tstruct timer_list\tsc_timer;\n\tstruct task_struct     *sc_timer_task;\n\tstruct task_struct     *sc_task;\n};\n\n \nenum {\n\tNILFS_SC_DIRTY,\t\t \n\tNILFS_SC_UNCLOSED,\t \n\tNILFS_SC_SUPER_ROOT,\t \n\tNILFS_SC_PRIOR_FLUSH,\t \n\tNILFS_SC_HAVE_DELTA,\t \n};\n\n \n#define NILFS_SEGCTOR_QUIT\t    0x0001   \n#define NILFS_SEGCTOR_COMMIT\t    0x0004   \n\n \n#define NILFS_SC_CLEANUP_RETRY\t    3   \n\n \n#define NILFS_SC_DEFAULT_TIMEOUT    5    \n#define NILFS_SC_DEFAULT_SR_FREQ    30   \n\n \n#define NILFS_SC_DEFAULT_WATERMARK  3600\n\n \nextern struct kmem_cache *nilfs_transaction_cachep;\n\n \nextern void nilfs_relax_pressure_in_lock(struct super_block *);\n\nextern int nilfs_construct_segment(struct super_block *);\nextern int nilfs_construct_dsync_segment(struct super_block *, struct inode *,\n\t\t\t\t\t loff_t, loff_t);\nextern void nilfs_flush_segment(struct super_block *, ino_t);\nextern int nilfs_clean_segments(struct super_block *, struct nilfs_argv *,\n\t\t\t\tvoid **);\n\nint nilfs_attach_log_writer(struct super_block *sb, struct nilfs_root *root);\nvoid nilfs_detach_log_writer(struct super_block *sb);\n\n \nextern int nilfs_read_super_root_block(struct the_nilfs *, sector_t,\n\t\t\t\t       struct buffer_head **, int);\nextern int nilfs_search_super_root(struct the_nilfs *,\n\t\t\t\t   struct nilfs_recovery_info *);\nint nilfs_salvage_orphan_logs(struct the_nilfs *nilfs, struct super_block *sb,\n\t\t\t      struct nilfs_recovery_info *ri);\nextern void nilfs_dispose_segment_list(struct list_head *);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}