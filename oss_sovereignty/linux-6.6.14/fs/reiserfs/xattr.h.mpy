{
  "module_name": "xattr.h",
  "hash_id": "fa88a5863d26b6c5afbfff5cc7f327866f2e62c6cd7bf5cf403edd2cfde52ee7",
  "original_prompt": "Ingested from linux-6.6.14/fs/reiserfs/xattr.h",
  "human_readable_source": " \n#include <linux/reiserfs_xattr.h>\n#include <linux/init.h>\n#include <linux/list.h>\n#include <linux/rwsem.h>\n#include <linux/xattr.h>\n\nstruct inode;\nstruct dentry;\nstruct iattr;\nstruct super_block;\n\nint reiserfs_xattr_register_handlers(void) __init;\nvoid reiserfs_xattr_unregister_handlers(void);\nint reiserfs_xattr_init(struct super_block *sb, int mount_flags);\nint reiserfs_lookup_privroot(struct super_block *sb);\nint reiserfs_delete_xattrs(struct inode *inode);\nint reiserfs_chown_xattrs(struct inode *inode, struct iattr *attrs);\nint reiserfs_permission(struct mnt_idmap *idmap,\n\t\t\tstruct inode *inode, int mask);\n\n#ifdef CONFIG_REISERFS_FS_XATTR\n#define has_xattr_dir(inode) (REISERFS_I(inode)->i_flags & i_has_xattr_dir)\nssize_t reiserfs_listxattr(struct dentry *dentry, char *buffer, size_t size);\n\nint reiserfs_xattr_get(struct inode *, const char *, void *, size_t);\nint reiserfs_xattr_set(struct inode *, const char *, const void *, size_t, int);\nint reiserfs_xattr_set_handle(struct reiserfs_transaction_handle *,\n\t\t\t      struct inode *, const char *, const void *,\n\t\t\t      size_t, int);\n\nextern const struct xattr_handler reiserfs_xattr_user_handler;\nextern const struct xattr_handler reiserfs_xattr_trusted_handler;\nextern const struct xattr_handler reiserfs_xattr_security_handler;\n#ifdef CONFIG_REISERFS_FS_SECURITY\nint reiserfs_security_init(struct inode *dir, struct inode *inode,\n\t\t\t   const struct qstr *qstr,\n\t\t\t   struct reiserfs_security_handle *sec);\nint reiserfs_security_write(struct reiserfs_transaction_handle *th,\n\t\t\t    struct inode *inode,\n\t\t\t    struct reiserfs_security_handle *sec);\nvoid reiserfs_security_free(struct reiserfs_security_handle *sec);\n#endif\n\nstatic inline int reiserfs_xattrs_initialized(struct super_block *sb)\n{\n\treturn REISERFS_SB(sb)->priv_root && REISERFS_SB(sb)->xattr_root;\n}\n\n#define xattr_size(size) ((size) + sizeof(struct reiserfs_xattr_header))\nstatic inline loff_t reiserfs_xattr_nblocks(struct inode *inode, loff_t size)\n{\n\tloff_t ret = 0;\n\tif (reiserfs_file_data_log(inode)) {\n\t\tret = _ROUND_UP(xattr_size(size), inode->i_sb->s_blocksize);\n\t\tret >>= inode->i_sb->s_blocksize_bits;\n\t}\n\treturn ret;\n}\n\n \nstatic inline size_t reiserfs_xattr_jcreate_nblocks(struct inode *inode)\n{\n\tsize_t nblocks = JOURNAL_BLOCKS_PER_OBJECT(inode->i_sb);\n\n\tif ((REISERFS_I(inode)->i_flags & i_has_xattr_dir) == 0) {\n\t\tnblocks += JOURNAL_BLOCKS_PER_OBJECT(inode->i_sb);\n\t\tif (d_really_is_negative(REISERFS_SB(inode->i_sb)->xattr_root))\n\t\t\tnblocks += JOURNAL_BLOCKS_PER_OBJECT(inode->i_sb);\n\t}\n\n\treturn nblocks;\n}\n\nstatic inline void reiserfs_init_xattr_rwsem(struct inode *inode)\n{\n\tinit_rwsem(&REISERFS_I(inode)->i_xattr_sem);\n}\n\n#else\n\n#define reiserfs_listxattr NULL\n\nstatic inline void reiserfs_init_xattr_rwsem(struct inode *inode)\n{\n}\n#endif   \n\n#ifndef CONFIG_REISERFS_FS_SECURITY\nstatic inline int reiserfs_security_init(struct inode *dir,\n\t\t\t\t\t struct inode *inode,\n\t\t\t\t\t const struct qstr *qstr,\n\t\t\t\t\t struct reiserfs_security_handle *sec)\n{\n\treturn 0;\n}\nstatic inline int\nreiserfs_security_write(struct reiserfs_transaction_handle *th,\n\t\t\tstruct inode *inode,\n\t\t\tstruct reiserfs_security_handle *sec)\n{\n\treturn 0;\n}\nstatic inline void reiserfs_security_free(struct reiserfs_security_handle *sec)\n{}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}