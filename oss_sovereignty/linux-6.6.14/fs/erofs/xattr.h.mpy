{
  "module_name": "xattr.h",
  "hash_id": "00e7598f0d6e98b1196938019efcca3f6b206d4d6e3660820150b8ef1e940cba",
  "original_prompt": "Ingested from linux-6.6.14/fs/erofs/xattr.h",
  "human_readable_source": " \n \n#ifndef __EROFS_XATTR_H\n#define __EROFS_XATTR_H\n\n#include \"internal.h\"\n#include <linux/posix_acl_xattr.h>\n#include <linux/xattr.h>\n\n \n#define ENOATTR         ENODATA\n\n#ifdef CONFIG_EROFS_FS_XATTR\nextern const struct xattr_handler erofs_xattr_user_handler;\nextern const struct xattr_handler erofs_xattr_trusted_handler;\nextern const struct xattr_handler erofs_xattr_security_handler;\n\nstatic inline const char *erofs_xattr_prefix(unsigned int idx,\n\t\t\t\t\t     struct dentry *dentry)\n{\n\tconst struct xattr_handler *handler = NULL;\n\n\tstatic const struct xattr_handler *xattr_handler_map[] = {\n\t\t[EROFS_XATTR_INDEX_USER] = &erofs_xattr_user_handler,\n#ifdef CONFIG_EROFS_FS_POSIX_ACL\n\t\t[EROFS_XATTR_INDEX_POSIX_ACL_ACCESS] = &nop_posix_acl_access,\n\t\t[EROFS_XATTR_INDEX_POSIX_ACL_DEFAULT] = &nop_posix_acl_default,\n#endif\n\t\t[EROFS_XATTR_INDEX_TRUSTED] = &erofs_xattr_trusted_handler,\n#ifdef CONFIG_EROFS_FS_SECURITY\n\t\t[EROFS_XATTR_INDEX_SECURITY] = &erofs_xattr_security_handler,\n#endif\n\t};\n\n\tif (idx && idx < ARRAY_SIZE(xattr_handler_map))\n\t\thandler = xattr_handler_map[idx];\n\n\tif (!xattr_handler_can_list(handler, dentry))\n\t\treturn NULL;\n\n\treturn xattr_prefix(handler);\n}\n\nextern const struct xattr_handler *erofs_xattr_handlers[];\n\nint erofs_xattr_prefixes_init(struct super_block *sb);\nvoid erofs_xattr_prefixes_cleanup(struct super_block *sb);\nint erofs_getxattr(struct inode *, int, const char *, void *, size_t);\nssize_t erofs_listxattr(struct dentry *, char *, size_t);\n#else\nstatic inline int erofs_xattr_prefixes_init(struct super_block *sb) { return 0; }\nstatic inline void erofs_xattr_prefixes_cleanup(struct super_block *sb) {}\nstatic inline int erofs_getxattr(struct inode *inode, int index,\n\t\t\t\t const char *name, void *buffer,\n\t\t\t\t size_t buffer_size)\n{\n\treturn -EOPNOTSUPP;\n}\n\n#define erofs_listxattr (NULL)\n#define erofs_xattr_handlers (NULL)\n#endif\t \n\n#ifdef CONFIG_EROFS_FS_POSIX_ACL\nstruct posix_acl *erofs_get_acl(struct inode *inode, int type, bool rcu);\n#else\n#define erofs_get_acl\t(NULL)\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}