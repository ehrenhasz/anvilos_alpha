{
  "module_name": "id.c",
  "hash_id": "4caf1bd9ea72182f0126040efbbb00e2b87e1691e5bb3df592481791e03fe233",
  "original_prompt": "Ingested from linux-6.6.14/fs/squashfs/id.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/fs.h>\n#include <linux/vfs.h>\n#include <linux/slab.h>\n\n#include \"squashfs_fs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs.h\"\n\n \nint squashfs_get_id(struct super_block *sb, unsigned int index,\n\t\t\t\t\tunsigned int *id)\n{\n\tstruct squashfs_sb_info *msblk = sb->s_fs_info;\n\tint block = SQUASHFS_ID_BLOCK(index);\n\tint offset = SQUASHFS_ID_BLOCK_OFFSET(index);\n\tu64 start_block;\n\t__le32 disk_id;\n\tint err;\n\n\tif (index >= msblk->ids)\n\t\treturn -EINVAL;\n\n\tstart_block = le64_to_cpu(msblk->id_table[block]);\n\n\terr = squashfs_read_metadata(sb, &disk_id, &start_block, &offset,\n\t\t\t\t\t\t\tsizeof(disk_id));\n\tif (err < 0)\n\t\treturn err;\n\n\t*id = le32_to_cpu(disk_id);\n\treturn 0;\n}\n\n\n \n__le64 *squashfs_read_id_index_table(struct super_block *sb,\n\t\tu64 id_table_start, u64 next_table, unsigned short no_ids)\n{\n\tunsigned int length = SQUASHFS_ID_BLOCK_BYTES(no_ids);\n\tunsigned int indexes = SQUASHFS_ID_BLOCKS(no_ids);\n\tint n;\n\t__le64 *table;\n\tu64 start, end;\n\n\tTRACE(\"In read_id_index_table, length %d\\n\", length);\n\n\t \n\n\t \n\tif (no_ids == 0)\n\t\treturn ERR_PTR(-EINVAL);\n\n\t \n\tif (length != (next_table - id_table_start))\n\t\treturn ERR_PTR(-EINVAL);\n\n\ttable = squashfs_read_table(sb, id_table_start, length);\n\tif (IS_ERR(table))\n\t\treturn table;\n\n\t \n\tfor (n = 0; n < (indexes - 1); n++) {\n\t\tstart = le64_to_cpu(table[n]);\n\t\tend = le64_to_cpu(table[n + 1]);\n\n\t\tif (start >= end || (end - start) >\n\t\t\t\t(SQUASHFS_METADATA_SIZE + SQUASHFS_BLOCK_OFFSET)) {\n\t\t\tkfree(table);\n\t\t\treturn ERR_PTR(-EINVAL);\n\t\t}\n\t}\n\n\tstart = le64_to_cpu(table[indexes - 1]);\n\tif (start >= id_table_start || (id_table_start - start) >\n\t\t\t\t(SQUASHFS_METADATA_SIZE + SQUASHFS_BLOCK_OFFSET)) {\n\t\tkfree(table);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\treturn table;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}