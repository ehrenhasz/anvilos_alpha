{
  "module_name": "squashfs_fs.h",
  "hash_id": "2964762b898a3658796df6dd197f0a82aad09d43e76df7058459f52f47a72ce7",
  "original_prompt": "Ingested from linux-6.6.14/fs/squashfs/squashfs_fs.h",
  "human_readable_source": " \n#ifndef SQUASHFS_FS\n#define SQUASHFS_FS\n \n\n#define SQUASHFS_CACHED_FRAGMENTS\tCONFIG_SQUASHFS_FRAGMENT_CACHE_SIZE\n#define SQUASHFS_MAJOR\t\t\t4\n#define SQUASHFS_MINOR\t\t\t0\n#define SQUASHFS_START\t\t\t0\n\n \n#define SQUASHFS_METADATA_SIZE\t\t8192\n#define SQUASHFS_BLOCK_OFFSET\t\t2\n\n \n#ifdef CONFIG_SQUASHFS_4K_DEVBLK_SIZE\n#define SQUASHFS_DEVBLK_SIZE 4096\n#else\n#define SQUASHFS_DEVBLK_SIZE 1024\n#endif\n\n#define SQUASHFS_FILE_MAX_SIZE\t\t1048576\n#define SQUASHFS_FILE_MAX_LOG\t\t20\n\n \n#define SQUASHFS_NAME_LEN\t\t256\n\n \n#define SQUASHFS_DIR_COUNT\t\t256\n\n#define SQUASHFS_INVALID_FRAG\t\t(0xffffffffU)\n#define SQUASHFS_INVALID_XATTR\t\t(0xffffffffU)\n#define SQUASHFS_INVALID_BLK\t\t(-1LL)\n\n \n#define SQUASHFS_NOI\t\t\t0\n#define SQUASHFS_NOD\t\t\t1\n#define SQUASHFS_NOF\t\t\t3\n#define SQUASHFS_NO_FRAG\t\t4\n#define SQUASHFS_ALWAYS_FRAG\t\t5\n#define SQUASHFS_DUPLICATE\t\t6\n#define SQUASHFS_EXPORT\t\t\t7\n#define SQUASHFS_COMP_OPT\t\t10\n\n#define SQUASHFS_BIT(flag, bit)\t\t((flag >> bit) & 1)\n\n#define SQUASHFS_UNCOMPRESSED_INODES(flags)\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_NOI)\n\n#define SQUASHFS_UNCOMPRESSED_DATA(flags)\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_NOD)\n\n#define SQUASHFS_UNCOMPRESSED_FRAGMENTS(flags)\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_NOF)\n\n#define SQUASHFS_NO_FRAGMENTS(flags)\t\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_NO_FRAG)\n\n#define SQUASHFS_ALWAYS_FRAGMENTS(flags)\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_ALWAYS_FRAG)\n\n#define SQUASHFS_DUPLICATES(flags)\t\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_DUPLICATE)\n\n#define SQUASHFS_EXPORTABLE(flags)\t\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_EXPORT)\n\n#define SQUASHFS_COMP_OPTS(flags)\t\tSQUASHFS_BIT(flags, \\\n\t\t\t\t\t\tSQUASHFS_COMP_OPT)\n\n \n#define SQUASHFS_DIR_TYPE\t\t1\n#define SQUASHFS_REG_TYPE\t\t2\n#define SQUASHFS_SYMLINK_TYPE\t\t3\n#define SQUASHFS_BLKDEV_TYPE\t\t4\n#define SQUASHFS_CHRDEV_TYPE\t\t5\n#define SQUASHFS_FIFO_TYPE\t\t6\n#define SQUASHFS_SOCKET_TYPE\t\t7\n#define SQUASHFS_LDIR_TYPE\t\t8\n#define SQUASHFS_LREG_TYPE\t\t9\n#define SQUASHFS_LSYMLINK_TYPE\t\t10\n#define SQUASHFS_LBLKDEV_TYPE\t\t11\n#define SQUASHFS_LCHRDEV_TYPE\t\t12\n#define SQUASHFS_LFIFO_TYPE\t\t13\n#define SQUASHFS_LSOCKET_TYPE\t\t14\n\n \n#define SQUASHFS_MAX_DIR_TYPE\t\t7\n\n \n#define SQUASHFS_XATTR_USER             0\n#define SQUASHFS_XATTR_TRUSTED          1\n#define SQUASHFS_XATTR_SECURITY         2\n#define SQUASHFS_XATTR_VALUE_OOL        256\n#define SQUASHFS_XATTR_PREFIX_MASK      0xff\n\n \n#define SQUASHFS_COMPRESSED_BIT\t\t(1 << 15)\n\n#define SQUASHFS_COMPRESSED_SIZE(B)\t(((B) & ~SQUASHFS_COMPRESSED_BIT) ? \\\n\t\t(B) & ~SQUASHFS_COMPRESSED_BIT :  SQUASHFS_COMPRESSED_BIT)\n\n#define SQUASHFS_COMPRESSED(B)\t\t(!((B) & SQUASHFS_COMPRESSED_BIT))\n\n#define SQUASHFS_COMPRESSED_BIT_BLOCK\t(1 << 24)\n\n#define SQUASHFS_COMPRESSED_SIZE_BLOCK(B)\t((B) & \\\n\t\t\t\t\t\t~SQUASHFS_COMPRESSED_BIT_BLOCK)\n\n#define SQUASHFS_COMPRESSED_BLOCK(B)\t(!((B) & SQUASHFS_COMPRESSED_BIT_BLOCK))\n\nstatic inline int squashfs_block_size(__le32 raw)\n{\n\tu32 size = le32_to_cpu(raw);\n\treturn (size >> 25) ? -EIO : size;\n}\n\n \n#define SQUASHFS_INODE_BLK(A)\t\t((unsigned int) ((A) >> 16))\n\n#define SQUASHFS_INODE_OFFSET(A)\t((unsigned int) ((A) & 0xffff))\n\n#define SQUASHFS_MKINODE(A, B)\t\t((long long)(((long long) (A)\\\n\t\t\t\t\t<< 16) + (B)))\n\n \n#define SQUASHFS_FRAGMENT_BYTES(A)\t\\\n\t\t\t\t((A) * sizeof(struct squashfs_fragment_entry))\n\n#define SQUASHFS_FRAGMENT_INDEX(A)\t(SQUASHFS_FRAGMENT_BYTES(A) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_FRAGMENT_INDEX_OFFSET(A)\t(SQUASHFS_FRAGMENT_BYTES(A) % \\\n\t\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_FRAGMENT_INDEXES(A)\t((SQUASHFS_FRAGMENT_BYTES(A) + \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE - 1) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_FRAGMENT_INDEX_BYTES(A)\t(SQUASHFS_FRAGMENT_INDEXES(A) *\\\n\t\t\t\t\t\tsizeof(u64))\n\n \n#define SQUASHFS_LOOKUP_BYTES(A)\t((A) * sizeof(u64))\n\n#define SQUASHFS_LOOKUP_BLOCK(A)\t(SQUASHFS_LOOKUP_BYTES(A) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_LOOKUP_BLOCK_OFFSET(A)\t(SQUASHFS_LOOKUP_BYTES(A) % \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_LOOKUP_BLOCKS(A)\t((SQUASHFS_LOOKUP_BYTES(A) + \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE - 1) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_LOOKUP_BLOCK_BYTES(A)\t(SQUASHFS_LOOKUP_BLOCKS(A) *\\\n\t\t\t\t\tsizeof(u64))\n\n \n#define SQUASHFS_ID_BYTES(A)\t\t((A) * sizeof(unsigned int))\n\n#define SQUASHFS_ID_BLOCK(A)\t\t(SQUASHFS_ID_BYTES(A) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_ID_BLOCK_OFFSET(A)\t(SQUASHFS_ID_BYTES(A) % \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_ID_BLOCKS(A)\t\t((SQUASHFS_ID_BYTES(A) + \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE - 1) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_ID_BLOCK_BYTES(A)\t(SQUASHFS_ID_BLOCKS(A) *\\\n\t\t\t\t\tsizeof(u64))\n \n#define SQUASHFS_XATTR_BYTES(A)\t\t(((u64) (A)) * sizeof(struct squashfs_xattr_id))\n\n#define SQUASHFS_XATTR_BLOCK(A)\t\t(SQUASHFS_XATTR_BYTES(A) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_XATTR_BLOCK_OFFSET(A)\t(SQUASHFS_XATTR_BYTES(A) % \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_XATTR_BLOCKS(A)\t((SQUASHFS_XATTR_BYTES(A) + \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE - 1) / \\\n\t\t\t\t\tSQUASHFS_METADATA_SIZE)\n\n#define SQUASHFS_XATTR_BLOCK_BYTES(A)\t(SQUASHFS_XATTR_BLOCKS(A) *\\\n\t\t\t\t\tsizeof(u64))\n#define SQUASHFS_XATTR_BLK(A)\t\t((unsigned int) ((A) >> 16))\n\n#define SQUASHFS_XATTR_OFFSET(A)\t((unsigned int) ((A) & 0xffff))\n\n \n#define SQUASHFS_CACHED_BLKS\t\t8\n\n \n#define SQUASHFS_META_INDEXES\t(SQUASHFS_METADATA_SIZE / sizeof(unsigned int))\n#define SQUASHFS_META_ENTRIES\t127\n#define SQUASHFS_META_SLOTS\t8\n\nstruct meta_entry {\n\tu64\t\t\tdata_block;\n\tunsigned int\t\tindex_block;\n\tunsigned short\t\toffset;\n\tunsigned short\t\tpad;\n};\n\nstruct meta_index {\n\tunsigned int\t\tinode_number;\n\tunsigned int\t\toffset;\n\tunsigned short\t\tentries;\n\tunsigned short\t\tskip;\n\tunsigned short\t\tlocked;\n\tunsigned short\t\tpad;\n\tstruct meta_entry\tmeta_entry[SQUASHFS_META_ENTRIES];\n};\n\n\n \n#define ZLIB_COMPRESSION\t1\n#define LZMA_COMPRESSION\t2\n#define LZO_COMPRESSION\t\t3\n#define XZ_COMPRESSION\t\t4\n#define LZ4_COMPRESSION\t\t5\n#define ZSTD_COMPRESSION\t6\n\nstruct squashfs_super_block {\n\t__le32\t\t\ts_magic;\n\t__le32\t\t\tinodes;\n\t__le32\t\t\tmkfs_time;\n\t__le32\t\t\tblock_size;\n\t__le32\t\t\tfragments;\n\t__le16\t\t\tcompression;\n\t__le16\t\t\tblock_log;\n\t__le16\t\t\tflags;\n\t__le16\t\t\tno_ids;\n\t__le16\t\t\ts_major;\n\t__le16\t\t\ts_minor;\n\t__le64\t\t\troot_inode;\n\t__le64\t\t\tbytes_used;\n\t__le64\t\t\tid_table_start;\n\t__le64\t\t\txattr_id_table_start;\n\t__le64\t\t\tinode_table_start;\n\t__le64\t\t\tdirectory_table_start;\n\t__le64\t\t\tfragment_table_start;\n\t__le64\t\t\tlookup_table_start;\n};\n\nstruct squashfs_dir_index {\n\t__le32\t\t\tindex;\n\t__le32\t\t\tstart_block;\n\t__le32\t\t\tsize;\n\tunsigned char\t\tname[];\n};\n\nstruct squashfs_base_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n};\n\nstruct squashfs_ipc_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n};\n\nstruct squashfs_lipc_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\txattr;\n};\n\nstruct squashfs_dev_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\trdev;\n};\n\nstruct squashfs_ldev_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\trdev;\n\t__le32\t\t\txattr;\n};\n\nstruct squashfs_symlink_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\tsymlink_size;\n\tchar\t\t\tsymlink[];\n};\n\nstruct squashfs_reg_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tstart_block;\n\t__le32\t\t\tfragment;\n\t__le32\t\t\toffset;\n\t__le32\t\t\tfile_size;\n\t__le16\t\t\tblock_list[];\n};\n\nstruct squashfs_lreg_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le64\t\t\tstart_block;\n\t__le64\t\t\tfile_size;\n\t__le64\t\t\tsparse;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\tfragment;\n\t__le32\t\t\toffset;\n\t__le32\t\t\txattr;\n\t__le16\t\t\tblock_list[];\n};\n\nstruct squashfs_dir_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tstart_block;\n\t__le32\t\t\tnlink;\n\t__le16\t\t\tfile_size;\n\t__le16\t\t\toffset;\n\t__le32\t\t\tparent_inode;\n};\n\nstruct squashfs_ldir_inode {\n\t__le16\t\t\tinode_type;\n\t__le16\t\t\tmode;\n\t__le16\t\t\tuid;\n\t__le16\t\t\tguid;\n\t__le32\t\t\tmtime;\n\t__le32\t\t\tinode_number;\n\t__le32\t\t\tnlink;\n\t__le32\t\t\tfile_size;\n\t__le32\t\t\tstart_block;\n\t__le32\t\t\tparent_inode;\n\t__le16\t\t\ti_count;\n\t__le16\t\t\toffset;\n\t__le32\t\t\txattr;\n\tstruct squashfs_dir_index\tindex[];\n};\n\nunion squashfs_inode {\n\tstruct squashfs_base_inode\t\tbase;\n\tstruct squashfs_dev_inode\t\tdev;\n\tstruct squashfs_ldev_inode\t\tldev;\n\tstruct squashfs_symlink_inode\t\tsymlink;\n\tstruct squashfs_reg_inode\t\treg;\n\tstruct squashfs_lreg_inode\t\tlreg;\n\tstruct squashfs_dir_inode\t\tdir;\n\tstruct squashfs_ldir_inode\t\tldir;\n\tstruct squashfs_ipc_inode\t\tipc;\n\tstruct squashfs_lipc_inode\t\tlipc;\n};\n\nstruct squashfs_dir_entry {\n\t__le16\t\t\toffset;\n\t__le16\t\t\tinode_number;\n\t__le16\t\t\ttype;\n\t__le16\t\t\tsize;\n\tchar\t\t\tname[];\n};\n\nstruct squashfs_dir_header {\n\t__le32\t\t\tcount;\n\t__le32\t\t\tstart_block;\n\t__le32\t\t\tinode_number;\n};\n\nstruct squashfs_fragment_entry {\n\t__le64\t\t\tstart_block;\n\t__le32\t\t\tsize;\n\tunsigned int\t\tunused;\n};\n\nstruct squashfs_xattr_entry {\n\t__le16\t\t\ttype;\n\t__le16\t\t\tsize;\n\tchar\t\t\tdata[];\n};\n\nstruct squashfs_xattr_val {\n\t__le32\t\t\tvsize;\n\tchar\t\t\tvalue[];\n};\n\nstruct squashfs_xattr_id {\n\t__le64\t\t\txattr;\n\t__le32\t\t\tcount;\n\t__le32\t\t\tsize;\n};\n\nstruct squashfs_xattr_id_table {\n\t__le64\t\t\txattr_table_start;\n\t__le32\t\t\txattr_ids;\n\t__le32\t\t\tunused;\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}