{
  "module_name": "xattr.h",
  "hash_id": "4763887fab85e32f1f64fc5bec75bdf96b3615b095070a92b0354e869feafffe",
  "original_prompt": "Ingested from linux-6.6.14/fs/f2fs/xattr.h",
  "human_readable_source": " \n \n#ifndef __F2FS_XATTR_H__\n#define __F2FS_XATTR_H__\n\n#include <linux/init.h>\n#include <linux/xattr.h>\n\n \n#define F2FS_XATTR_MAGIC                0xF2F52011\n\n \n#define F2FS_XATTR_REFCOUNT_MAX         1024\n\n \n#define F2FS_SYSTEM_ADVISE_NAME\t\t\t\"system.advise\"\n#define F2FS_XATTR_INDEX_USER\t\t\t1\n#define F2FS_XATTR_INDEX_POSIX_ACL_ACCESS\t2\n#define F2FS_XATTR_INDEX_POSIX_ACL_DEFAULT\t3\n#define F2FS_XATTR_INDEX_TRUSTED\t\t4\n#define F2FS_XATTR_INDEX_LUSTRE\t\t\t5\n#define F2FS_XATTR_INDEX_SECURITY\t\t6\n#define F2FS_XATTR_INDEX_ADVISE\t\t\t7\n \n#define F2FS_XATTR_INDEX_ENCRYPTION\t\t9\n#define F2FS_XATTR_INDEX_VERITY\t\t\t11\n\n#define F2FS_XATTR_NAME_ENCRYPTION_CONTEXT\t\"c\"\n#define F2FS_XATTR_NAME_VERITY\t\t\t\"v\"\n\nstruct f2fs_xattr_header {\n\t__le32  h_magic;         \n\t__le32  h_refcount;      \n\t__u32   h_reserved[4];   \n};\n\nstruct f2fs_xattr_entry {\n\t__u8    e_name_index;\n\t__u8    e_name_len;\n\t__le16  e_value_size;    \n\tchar    e_name[];       \n};\n\n#define XATTR_HDR(ptr)\t\t((struct f2fs_xattr_header *)(ptr))\n#define XATTR_ENTRY(ptr)\t((struct f2fs_xattr_entry *)(ptr))\n#define XATTR_FIRST_ENTRY(ptr)\t(XATTR_ENTRY(XATTR_HDR(ptr) + 1))\n#define XATTR_ROUND\t\t(3)\n\n#define XATTR_ALIGN(size)\t(((size) + XATTR_ROUND) & ~XATTR_ROUND)\n\n#define ENTRY_SIZE(entry) (XATTR_ALIGN(sizeof(struct f2fs_xattr_entry) + \\\n\t\t\t(entry)->e_name_len + le16_to_cpu((entry)->e_value_size)))\n\n#define XATTR_NEXT_ENTRY(entry)\t((struct f2fs_xattr_entry *)((char *)(entry) +\\\n\t\t\tENTRY_SIZE(entry)))\n\n#define IS_XATTR_LAST_ENTRY(entry) (*(__u32 *)(entry) == 0)\n\n#define list_for_each_xattr(entry, addr) \\\n\t\tfor (entry = XATTR_FIRST_ENTRY(addr);\\\n\t\t\t\t!IS_XATTR_LAST_ENTRY(entry);\\\n\t\t\t\tentry = XATTR_NEXT_ENTRY(entry))\n#define VALID_XATTR_BLOCK_SIZE\t(PAGE_SIZE - sizeof(struct node_footer))\n#define XATTR_PADDING_SIZE\t(sizeof(__u32))\n#define XATTR_SIZE(i)\t\t((F2FS_I(i)->i_xattr_nid ?\t\t\\\n\t\t\t\t\tVALID_XATTR_BLOCK_SIZE : 0) +\t\\\n\t\t\t\t\t\t(inline_xattr_size(i)))\n#define MIN_OFFSET(i)\t\tXATTR_ALIGN(inline_xattr_size(i) +\t\\\n\t\t\t\t\t\tVALID_XATTR_BLOCK_SIZE)\n\n#define MAX_VALUE_LEN(i)\t(MIN_OFFSET(i) -\t\t\t\\\n\t\t\t\tsizeof(struct f2fs_xattr_header) -\t\\\n\t\t\t\tsizeof(struct f2fs_xattr_entry))\n\n#define MIN_INLINE_XATTR_SIZE (sizeof(struct f2fs_xattr_header) / sizeof(__le32))\n#define MAX_INLINE_XATTR_SIZE\t\t\t\t\t\t\\\n\t\t\t(DEF_ADDRS_PER_INODE -\t\t\t\t\\\n\t\t\tF2FS_TOTAL_EXTRA_ATTR_SIZE / sizeof(__le32) -\t\\\n\t\t\tDEF_INLINE_RESERVED_SIZE -\t\t\t\\\n\t\t\tMIN_INLINE_DENTRY_SIZE / sizeof(__le32))\n\n \n\n#ifdef CONFIG_F2FS_FS_XATTR\nextern const struct xattr_handler f2fs_xattr_user_handler;\nextern const struct xattr_handler f2fs_xattr_trusted_handler;\nextern const struct xattr_handler f2fs_xattr_advise_handler;\nextern const struct xattr_handler f2fs_xattr_security_handler;\n\nextern const struct xattr_handler *f2fs_xattr_handlers[];\n\nextern int f2fs_setxattr(struct inode *, int, const char *,\n\t\t\t\tconst void *, size_t, struct page *, int);\nextern int f2fs_getxattr(struct inode *, int, const char *, void *,\n\t\t\t\t\t\tsize_t, struct page *);\nextern ssize_t f2fs_listxattr(struct dentry *, char *, size_t);\nextern int f2fs_init_xattr_caches(struct f2fs_sb_info *);\nextern void f2fs_destroy_xattr_caches(struct f2fs_sb_info *);\n#else\n\n#define f2fs_xattr_handlers\tNULL\n#define f2fs_listxattr\t\tNULL\nstatic inline int f2fs_setxattr(struct inode *inode, int index,\n\t\tconst char *name, const void *value, size_t size,\n\t\tstruct page *page, int flags)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int f2fs_getxattr(struct inode *inode, int index,\n\t\t\tconst char *name, void *buffer,\n\t\t\tsize_t buffer_size, struct page *dpage)\n{\n\treturn -EOPNOTSUPP;\n}\nstatic inline int f2fs_init_xattr_caches(struct f2fs_sb_info *sbi) { return 0; }\nstatic inline void f2fs_destroy_xattr_caches(struct f2fs_sb_info *sbi) { }\n#endif\n\n#ifdef CONFIG_F2FS_FS_SECURITY\nextern int f2fs_init_security(struct inode *, struct inode *,\n\t\t\t\tconst struct qstr *, struct page *);\n#else\nstatic inline int f2fs_init_security(struct inode *inode, struct inode *dir,\n\t\t\t\tconst struct qstr *qstr, struct page *ipage)\n{\n\treturn 0;\n}\n#endif\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}