{
  "module_name": "cache.h",
  "hash_id": "b31bbd2337c098e2e5d4557838f1f4da14118edc07984f9a5904572b67830b40",
  "original_prompt": "Ingested from linux-6.6.14/fs/ceph/cache.h",
  "human_readable_source": " \n \n\n#ifndef _CEPH_CACHE_H\n#define _CEPH_CACHE_H\n\n#include <linux/netfs.h>\n\n#ifdef CONFIG_CEPH_FSCACHE\n#include <linux/fscache.h>\n\nint ceph_fscache_register_fs(struct ceph_fs_client* fsc, struct fs_context *fc);\nvoid ceph_fscache_unregister_fs(struct ceph_fs_client* fsc);\n\nvoid ceph_fscache_register_inode_cookie(struct inode *inode);\nvoid ceph_fscache_unregister_inode_cookie(struct ceph_inode_info* ci);\n\nvoid ceph_fscache_use_cookie(struct inode *inode, bool will_modify);\nvoid ceph_fscache_unuse_cookie(struct inode *inode, bool update);\n\nvoid ceph_fscache_update(struct inode *inode);\nvoid ceph_fscache_invalidate(struct inode *inode, bool dio_write);\n\nstatic inline struct fscache_cookie *ceph_fscache_cookie(struct ceph_inode_info *ci)\n{\n\treturn netfs_i_cookie(&ci->netfs);\n}\n\nstatic inline void ceph_fscache_resize(struct inode *inode, loff_t to)\n{\n\tstruct ceph_inode_info *ci = ceph_inode(inode);\n\tstruct fscache_cookie *cookie = ceph_fscache_cookie(ci);\n\n\tif (cookie) {\n\t\tceph_fscache_use_cookie(inode, true);\n\t\tfscache_resize_cookie(cookie, to);\n\t\tceph_fscache_unuse_cookie(inode, true);\n\t}\n}\n\nstatic inline void ceph_fscache_unpin_writeback(struct inode *inode,\n\t\t\t\t\t\tstruct writeback_control *wbc)\n{\n\tfscache_unpin_writeback(wbc, ceph_fscache_cookie(ceph_inode(inode)));\n}\n\nstatic inline int ceph_fscache_dirty_folio(struct address_space *mapping,\n\t\tstruct folio *folio)\n{\n\tstruct ceph_inode_info *ci = ceph_inode(mapping->host);\n\n\treturn fscache_dirty_folio(mapping, folio, ceph_fscache_cookie(ci));\n}\n\nstatic inline int ceph_begin_cache_operation(struct netfs_io_request *rreq)\n{\n\tstruct fscache_cookie *cookie = ceph_fscache_cookie(ceph_inode(rreq->inode));\n\n\treturn fscache_begin_read_operation(&rreq->cache_resources, cookie);\n}\n\nstatic inline bool ceph_is_cache_enabled(struct inode *inode)\n{\n\treturn fscache_cookie_enabled(ceph_fscache_cookie(ceph_inode(inode)));\n}\n\nstatic inline void ceph_fscache_note_page_release(struct inode *inode)\n{\n\tstruct ceph_inode_info *ci = ceph_inode(inode);\n\n\tfscache_note_page_release(ceph_fscache_cookie(ci));\n}\n#else  \nstatic inline int ceph_fscache_register_fs(struct ceph_fs_client* fsc,\n\t\t\t\t\t   struct fs_context *fc)\n{\n\treturn 0;\n}\n\nstatic inline void ceph_fscache_unregister_fs(struct ceph_fs_client* fsc)\n{\n}\n\nstatic inline void ceph_fscache_register_inode_cookie(struct inode *inode)\n{\n}\n\nstatic inline void ceph_fscache_unregister_inode_cookie(struct ceph_inode_info* ci)\n{\n}\n\nstatic inline void ceph_fscache_use_cookie(struct inode *inode, bool will_modify)\n{\n}\n\nstatic inline void ceph_fscache_unuse_cookie(struct inode *inode, bool update)\n{\n}\n\nstatic inline void ceph_fscache_update(struct inode *inode)\n{\n}\n\nstatic inline void ceph_fscache_invalidate(struct inode *inode, bool dio_write)\n{\n}\n\nstatic inline struct fscache_cookie *ceph_fscache_cookie(struct ceph_inode_info *ci)\n{\n\treturn NULL;\n}\n\nstatic inline void ceph_fscache_resize(struct inode *inode, loff_t to)\n{\n}\n\nstatic inline void ceph_fscache_unpin_writeback(struct inode *inode,\n\t\t\t\t\t\tstruct writeback_control *wbc)\n{\n}\n\nstatic inline int ceph_fscache_dirty_folio(struct address_space *mapping,\n\t\tstruct folio *folio)\n{\n\treturn filemap_dirty_folio(mapping, folio);\n}\n\nstatic inline bool ceph_is_cache_enabled(struct inode *inode)\n{\n\treturn false;\n}\n\nstatic inline int ceph_begin_cache_operation(struct netfs_io_request *rreq)\n{\n\treturn -ENOBUFS;\n}\n\nstatic inline void ceph_fscache_note_page_release(struct inode *inode)\n{\n}\n#endif  \n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}