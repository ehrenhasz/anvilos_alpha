{
  "module_name": "inode.h",
  "hash_id": "de72cef5782d35a2a4d716fa7c1c2b8b53236ae4f91b24f1b712d7fa1801aa3b",
  "original_prompt": "Ingested from linux-6.6.14/fs/ntfs/inode.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_NTFS_INODE_H\n#define _LINUX_NTFS_INODE_H\n\n#include <linux/atomic.h>\n\n#include <linux/fs.h>\n#include <linux/list.h>\n#include <linux/mm.h>\n#include <linux/mutex.h>\n#include <linux/seq_file.h>\n\n#include \"layout.h\"\n#include \"volume.h\"\n#include \"types.h\"\n#include \"runlist.h\"\n#include \"debug.h\"\n\ntypedef struct _ntfs_inode ntfs_inode;\n\n \nstruct _ntfs_inode {\n\trwlock_t size_lock;\t \n\ts64 initialized_size;\t \n\ts64 allocated_size;\t \n\tunsigned long state;\t \n\tunsigned long mft_no;\t \n\tu16 seq_no;\t\t \n\tatomic_t count;\t\t \n\tntfs_volume *vol;\t \n\t \n\tATTR_TYPE type;\t \n\tntfschar *name;\t\t \n\tu32 name_len;\t\t \n\trunlist runlist;\t \n\t \n\tstruct mutex mrec_lock;\t \n\tstruct page *page;\t \n\tint page_ofs;\t\t \n\t \n\tu32 attr_list_size;\t \n\tu8 *attr_list;\t\t \n\trunlist attr_list_rl;\t \n\tunion {\n\t\tstruct {  \n\t\t\tu32 block_size;\t\t \n\t\t\tu32 vcn_size;\t\t \n\t\t\tCOLLATION_RULE collation_rule;  \n\t\t\tu8 block_size_bits; \t \n\t\t\tu8 vcn_size_bits;\t \n\t\t} index;\n\t\tstruct {  \n\t\t\ts64 size;\t\t \n\t\t\tu32 block_size;\t\t \n\t\t\tu8 block_size_bits;\t \n\t\t\tu8 block_clusters;\t \n\t\t} compressed;\n\t} itype;\n\tstruct mutex extent_lock;\t \n\ts32 nr_extents;\t \n\tunion {\t\t \n\t\tntfs_inode **extent_ntfs_inos;\t \n\t\tntfs_inode *base_ntfs_ino;\t \n\t} ext;\n};\n\n \ntypedef enum {\n\tNI_Dirty,\t\t \n\tNI_AttrList,\t\t \n\tNI_AttrListNonResident,\t \n\n\tNI_Attr,\t\t \n\n\tNI_MstProtected,\t \n\tNI_NonResident,\t\t \n\tNI_IndexAllocPresent = NI_NonResident,\t \n\tNI_Compressed,\t\t \n\tNI_Encrypted,\t\t \n\tNI_Sparse,\t\t \n\tNI_SparseDisabled,\t \n\tNI_TruncateFailed,\t \n} ntfs_inode_state_bits;\n\n \n\n \n#define NINO_FNS(flag)\t\t\t\t\t\\\nstatic inline int NIno##flag(ntfs_inode *ni)\t\t\\\n{\t\t\t\t\t\t\t\\\n\treturn test_bit(NI_##flag, &(ni)->state);\t\\\n}\t\t\t\t\t\t\t\\\nstatic inline void NInoSet##flag(ntfs_inode *ni)\t\\\n{\t\t\t\t\t\t\t\\\n\tset_bit(NI_##flag, &(ni)->state);\t\t\\\n}\t\t\t\t\t\t\t\\\nstatic inline void NInoClear##flag(ntfs_inode *ni)\t\\\n{\t\t\t\t\t\t\t\\\n\tclear_bit(NI_##flag, &(ni)->state);\t\t\\\n}\n\n \n#define TAS_NINO_FNS(flag)\t\t\t\t\t\\\nstatic inline int NInoTestSet##flag(ntfs_inode *ni)\t\t\\\n{\t\t\t\t\t\t\t\t\\\n\treturn test_and_set_bit(NI_##flag, &(ni)->state);\t\\\n}\t\t\t\t\t\t\t\t\\\nstatic inline int NInoTestClear##flag(ntfs_inode *ni)\t\t\\\n{\t\t\t\t\t\t\t\t\\\n\treturn test_and_clear_bit(NI_##flag, &(ni)->state);\t\\\n}\n\n \nNINO_FNS(Dirty)\nTAS_NINO_FNS(Dirty)\nNINO_FNS(AttrList)\nNINO_FNS(AttrListNonResident)\nNINO_FNS(Attr)\nNINO_FNS(MstProtected)\nNINO_FNS(NonResident)\nNINO_FNS(IndexAllocPresent)\nNINO_FNS(Compressed)\nNINO_FNS(Encrypted)\nNINO_FNS(Sparse)\nNINO_FNS(SparseDisabled)\nNINO_FNS(TruncateFailed)\n\n \ntypedef struct {\n\tntfs_inode ntfs_inode;\n\tstruct inode vfs_inode;\t\t \n} big_ntfs_inode;\n\n \nstatic inline ntfs_inode *NTFS_I(struct inode *inode)\n{\n\treturn (ntfs_inode *)container_of(inode, big_ntfs_inode, vfs_inode);\n}\n\nstatic inline struct inode *VFS_I(ntfs_inode *ni)\n{\n\treturn &((big_ntfs_inode *)ni)->vfs_inode;\n}\n\n \ntypedef struct {\n\tunsigned long mft_no;\n\tntfschar *name;\n\tu32 name_len;\n\tATTR_TYPE type;\n} ntfs_attr;\n\nextern int ntfs_test_inode(struct inode *vi, void *data);\n\nextern struct inode *ntfs_iget(struct super_block *sb, unsigned long mft_no);\nextern struct inode *ntfs_attr_iget(struct inode *base_vi, ATTR_TYPE type,\n\t\tntfschar *name, u32 name_len);\nextern struct inode *ntfs_index_iget(struct inode *base_vi, ntfschar *name,\n\t\tu32 name_len);\n\nextern struct inode *ntfs_alloc_big_inode(struct super_block *sb);\nextern void ntfs_free_big_inode(struct inode *inode);\nextern void ntfs_evict_big_inode(struct inode *vi);\n\nextern void __ntfs_init_inode(struct super_block *sb, ntfs_inode *ni);\n\nstatic inline void ntfs_init_big_inode(struct inode *vi)\n{\n\tntfs_inode *ni = NTFS_I(vi);\n\n\tntfs_debug(\"Entering.\");\n\t__ntfs_init_inode(vi->i_sb, ni);\n\tni->mft_no = vi->i_ino;\n}\n\nextern ntfs_inode *ntfs_new_extent_inode(struct super_block *sb,\n\t\tunsigned long mft_no);\nextern void ntfs_clear_extent_inode(ntfs_inode *ni);\n\nextern int ntfs_read_inode_mount(struct inode *vi);\n\nextern int ntfs_show_options(struct seq_file *sf, struct dentry *root);\n\n#ifdef NTFS_RW\n\nextern int ntfs_truncate(struct inode *vi);\nextern void ntfs_truncate_vfs(struct inode *vi);\n\nextern int ntfs_setattr(struct mnt_idmap *idmap,\n\t\t\tstruct dentry *dentry, struct iattr *attr);\n\nextern int __ntfs_write_inode(struct inode *vi, int sync);\n\nstatic inline void ntfs_commit_inode(struct inode *vi)\n{\n\tif (!is_bad_inode(vi))\n\t\t__ntfs_write_inode(vi, 1);\n\treturn;\n}\n\n#else\n\nstatic inline void ntfs_truncate_vfs(struct inode *vi) {}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}