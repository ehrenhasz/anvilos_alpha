{
  "module_name": "collate.c",
  "hash_id": "98cd11c6293f26f5fcf1d273c2ab17b9144c8ff1647d661abc80995e4f7d512e",
  "original_prompt": "Ingested from linux-6.6.14/fs/ntfs/collate.c",
  "human_readable_source": "\n \n\n#include \"collate.h\"\n#include \"debug.h\"\n#include \"ntfs.h\"\n\nstatic int ntfs_collate_binary(ntfs_volume *vol,\n\t\tconst void *data1, const int data1_len,\n\t\tconst void *data2, const int data2_len)\n{\n\tint rc;\n\n\tntfs_debug(\"Entering.\");\n\trc = memcmp(data1, data2, min(data1_len, data2_len));\n\tif (!rc && (data1_len != data2_len)) {\n\t\tif (data1_len < data2_len)\n\t\t\trc = -1;\n\t\telse\n\t\t\trc = 1;\n\t}\n\tntfs_debug(\"Done, returning %i\", rc);\n\treturn rc;\n}\n\nstatic int ntfs_collate_ntofs_ulong(ntfs_volume *vol,\n\t\tconst void *data1, const int data1_len,\n\t\tconst void *data2, const int data2_len)\n{\n\tint rc;\n\tu32 d1, d2;\n\n\tntfs_debug(\"Entering.\");\n\t\n\tBUG_ON(data1_len != data2_len);\n\tBUG_ON(data1_len != 4);\n\td1 = le32_to_cpup(data1);\n\td2 = le32_to_cpup(data2);\n\tif (d1 < d2)\n\t\trc = -1;\n\telse {\n\t\tif (d1 == d2)\n\t\t\trc = 0;\n\t\telse\n\t\t\trc = 1;\n\t}\n\tntfs_debug(\"Done, returning %i\", rc);\n\treturn rc;\n}\n\ntypedef int (*ntfs_collate_func_t)(ntfs_volume *, const void *, const int,\n\t\tconst void *, const int);\n\nstatic ntfs_collate_func_t ntfs_do_collate0x0[3] = {\n\tntfs_collate_binary,\n\tNULL ,\n\tNULL ,\n};\n\nstatic ntfs_collate_func_t ntfs_do_collate0x1[4] = {\n\tntfs_collate_ntofs_ulong,\n\tNULL ,\n\tNULL ,\n\tNULL ,\n};\n\n \nint ntfs_collate(ntfs_volume *vol, COLLATION_RULE cr,\n\t\tconst void *data1, const int data1_len,\n\t\tconst void *data2, const int data2_len) {\n\tint i;\n\n\tntfs_debug(\"Entering.\");\n\t \n\tBUG_ON(cr != COLLATION_BINARY && cr != COLLATION_NTOFS_ULONG);\n\ti = le32_to_cpu(cr);\n\tBUG_ON(i < 0);\n\tif (i <= 0x02)\n\t\treturn ntfs_do_collate0x0[i](vol, data1, data1_len,\n\t\t\t\tdata2, data2_len);\n\tBUG_ON(i < 0x10);\n\ti -= 0x10;\n\tif (likely(i <= 3))\n\t\treturn ntfs_do_collate0x1[i](vol, data1, data1_len,\n\t\t\t\tdata2, data2_len);\n\tBUG();\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}