{
  "module_name": "cifspdu.h",
  "hash_id": "12ba4a64cd6d3541b1b3dd2d828fd6533f1da5e1ee2bcd710f23dd0b0eb01d2f",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/cifspdu.h",
  "human_readable_source": " \n \n\n#ifndef _CIFSPDU_H\n#define _CIFSPDU_H\n\n#include <net/sock.h>\n#include <asm/unaligned.h>\n#include \"../common/smbfsctl.h\"\n\n#define CIFS_PROT   0\n#define POSIX_PROT  (CIFS_PROT+1)\n#define BAD_PROT 0xFFFF\n\n \n#define SMB_COM_CREATE_DIRECTORY      0x00  \n#define SMB_COM_DELETE_DIRECTORY      0x01  \n#define SMB_COM_CLOSE                 0x04  \n#define SMB_COM_FLUSH                 0x05  \n#define SMB_COM_DELETE                0x06  \n#define SMB_COM_RENAME                0x07  \n#define SMB_COM_QUERY_INFORMATION     0x08  \n#define SMB_COM_SETATTR               0x09  \n#define SMB_COM_LOCKING_ANDX          0x24  \n#define SMB_COM_COPY                  0x29  \n#define SMB_COM_ECHO                  0x2B  \n#define SMB_COM_OPEN_ANDX             0x2D  \n#define SMB_COM_READ_ANDX             0x2E\n#define SMB_COM_WRITE_ANDX            0x2F\n#define SMB_COM_TRANSACTION2          0x32\n#define SMB_COM_TRANSACTION2_SECONDARY 0x33\n#define SMB_COM_FIND_CLOSE2           0x34  \n#define SMB_COM_TREE_DISCONNECT       0x71  \n#define SMB_COM_NEGOTIATE             0x72\n#define SMB_COM_SESSION_SETUP_ANDX    0x73\n#define SMB_COM_LOGOFF_ANDX           0x74  \n#define SMB_COM_TREE_CONNECT_ANDX     0x75\n#define SMB_COM_NT_TRANSACT           0xA0\n#define SMB_COM_NT_TRANSACT_SECONDARY 0xA1\n#define SMB_COM_NT_CREATE_ANDX        0xA2\n#define SMB_COM_NT_CANCEL             0xA4  \n#define SMB_COM_NT_RENAME             0xA5  \n\n \n#define TRANS2_OPEN                   0x00\n#define TRANS2_FIND_FIRST             0x01\n#define TRANS2_FIND_NEXT              0x02\n#define TRANS2_QUERY_FS_INFORMATION   0x03\n#define TRANS2_SET_FS_INFORMATION     0x04\n#define TRANS2_QUERY_PATH_INFORMATION 0x05\n#define TRANS2_SET_PATH_INFORMATION   0x06\n#define TRANS2_QUERY_FILE_INFORMATION 0x07\n#define TRANS2_SET_FILE_INFORMATION   0x08\n#define TRANS2_GET_DFS_REFERRAL       0x10\n#define TRANS2_REPORT_DFS_INCOSISTENCY 0x11\n\n \n#define TRANS_SET_NMPIPE_STATE      0x0001\n#define TRANS_RAW_READ_NMPIPE       0x0011\n#define TRANS_QUERY_NMPIPE_STATE    0x0021\n#define TRANS_QUERY_NMPIPE_INFO     0x0022\n#define TRANS_PEEK_NMPIPE           0x0023\n#define TRANS_TRANSACT_NMPIPE       0x0026\n#define TRANS_RAW_WRITE_NMPIPE      0x0031\n#define TRANS_READ_NMPIPE           0x0036\n#define TRANS_WRITE_NMPIPE          0x0037\n#define TRANS_WAIT_NMPIPE           0x0053\n#define TRANS_CALL_NMPIPE           0x0054\n\n \n#define NT_TRANSACT_CREATE            0x01\n#define NT_TRANSACT_IOCTL             0x02\n#define NT_TRANSACT_SET_SECURITY_DESC 0x03\n#define NT_TRANSACT_NOTIFY_CHANGE     0x04\n#define NT_TRANSACT_RENAME            0x05\n#define NT_TRANSACT_QUERY_SECURITY_DESC 0x06\n#define NT_TRANSACT_GET_USER_QUOTA    0x07\n#define NT_TRANSACT_SET_USER_QUOTA    0x08\n\n#define MAX_CIFS_SMALL_BUFFER_SIZE 448  \n \n \n#define MAX_CIFS_HDR_SIZE 0x58  \n#define CIFS_SMALL_PATH 120  \n\n \n \n\n \n#define CIFS_MAX_MSGSIZE (4*4096)\n\n \n#define CIFS_ENCPWD_SIZE (16)\n\n \n#define CIFS_CRYPTO_KEY_SIZE (8)\n\n \n#define CIFS_AUTH_RESP_SIZE (24)\n\n \n#define CIFS_SESS_KEY_SIZE (16)\n\n#define CIFS_SERVER_CHALLENGE_SIZE (8)\n#define CIFS_HMAC_MD5_HASH_SIZE (16)\n#define CIFS_CPHTXT_SIZE (16)\n#define CIFS_NTHASH_SIZE (16)\n\n \n#define CIFS_UNLEN (20)\n\n \n#define SMBOPEN_WRITE_THROUGH 0x4000\n#define SMBOPEN_DENY_ALL      0x0010\n#define SMBOPEN_DENY_WRITE    0x0020\n#define SMBOPEN_DENY_READ     0x0030\n#define SMBOPEN_DENY_NONE     0x0040\n#define SMBOPEN_READ          0x0000\n#define SMBOPEN_WRITE         0x0001\n#define SMBOPEN_READWRITE     0x0002\n#define SMBOPEN_EXECUTE       0x0003\n\n#define SMBOPEN_OCREATE       0x0010\n#define SMBOPEN_OTRUNC        0x0002\n#define SMBOPEN_OAPPEND       0x0001\n\n \n#define SMBFLG_EXTD_LOCK 0x01\t \n#define SMBFLG_RCV_POSTED 0x02\t \n#define SMBFLG_RSVD 0x04\n#define SMBFLG_CASELESS 0x08\t \n#define SMBFLG_CANONICAL_PATH_FORMAT 0x10\t \n#define SMBFLG_OLD_OPLOCK 0x20\t \n#define SMBFLG_OLD_OPLOCK_NOTIFY 0x40\t \n#define SMBFLG_RESPONSE 0x80\t \n\n \n#define SMBFLG2_KNOWS_LONG_NAMES cpu_to_le16(1)\t \n#define SMBFLG2_KNOWS_EAS cpu_to_le16(2)\n#define SMBFLG2_SECURITY_SIGNATURE cpu_to_le16(4)\n#define SMBFLG2_COMPRESSED (8)\n#define SMBFLG2_SECURITY_SIGNATURE_REQUIRED (0x10)\n#define SMBFLG2_IS_LONG_NAME cpu_to_le16(0x40)\n#define SMBFLG2_REPARSE_PATH (0x400)\n#define SMBFLG2_EXT_SEC cpu_to_le16(0x800)\n#define SMBFLG2_DFS cpu_to_le16(0x1000)\n#define SMBFLG2_PAGING_IO cpu_to_le16(0x2000)\n#define SMBFLG2_ERR_STATUS cpu_to_le16(0x4000)\n#define SMBFLG2_UNICODE cpu_to_le16(0x8000)\n\n \n\n#define FILE_READ_DATA        0x00000001   \n#define FILE_WRITE_DATA       0x00000002   \n#define FILE_APPEND_DATA      0x00000004   \n#define FILE_READ_EA          0x00000008   \n\t\t\t\t\t   \n#define FILE_WRITE_EA         0x00000010   \n\t\t\t\t\t   \n#define FILE_EXECUTE          0x00000020   \n\t\t\t\t\t   \n#define FILE_DELETE_CHILD     0x00000040\n#define FILE_READ_ATTRIBUTES  0x00000080   \n\t\t\t\t\t   \n#define FILE_WRITE_ATTRIBUTES 0x00000100   \n\t\t\t\t\t   \n#define DELETE                0x00010000   \n#define READ_CONTROL          0x00020000   \n\t\t\t\t\t   \n\t\t\t\t\t   \n#define WRITE_DAC             0x00040000   \n\t\t\t\t\t   \n\t\t\t\t\t   \n#define WRITE_OWNER           0x00080000   \n\t\t\t\t\t   \n#define SYNCHRONIZE           0x00100000   \n\t\t\t\t\t   \n\t\t\t\t\t   \n#define SYSTEM_SECURITY       0x01000000   \n\t\t\t\t\t   \n#define GENERIC_ALL           0x10000000\n#define GENERIC_EXECUTE       0x20000000\n#define GENERIC_WRITE         0x40000000\n#define GENERIC_READ          0x80000000\n\t\t\t\t\t  \n\t\t\t\t\t  \n\t\t\t\t\t  \n\t\t\t\t\t  \n\t\t\t\t\t  \n\n#define FILE_READ_RIGHTS (FILE_READ_DATA | FILE_READ_EA | FILE_READ_ATTRIBUTES)\n#define FILE_WRITE_RIGHTS (FILE_WRITE_DATA | FILE_APPEND_DATA \\\n\t\t\t\t| FILE_WRITE_EA | FILE_WRITE_ATTRIBUTES)\n#define FILE_EXEC_RIGHTS (FILE_EXECUTE)\n\n#define SET_FILE_READ_RIGHTS (FILE_READ_DATA | FILE_READ_EA | FILE_WRITE_EA \\\n\t\t\t\t| FILE_READ_ATTRIBUTES \\\n\t\t\t\t| FILE_WRITE_ATTRIBUTES \\\n\t\t\t\t| DELETE | READ_CONTROL | WRITE_DAC \\\n\t\t\t\t| WRITE_OWNER | SYNCHRONIZE)\n#define SET_FILE_WRITE_RIGHTS (FILE_WRITE_DATA | FILE_APPEND_DATA \\\n\t\t\t\t| FILE_READ_EA | FILE_WRITE_EA \\\n\t\t\t\t| FILE_READ_ATTRIBUTES \\\n\t\t\t\t| FILE_WRITE_ATTRIBUTES \\\n\t\t\t\t| DELETE | READ_CONTROL | WRITE_DAC \\\n\t\t\t\t| WRITE_OWNER | SYNCHRONIZE)\n#define SET_FILE_EXEC_RIGHTS (FILE_READ_EA | FILE_WRITE_EA | FILE_EXECUTE \\\n\t\t\t\t| FILE_READ_ATTRIBUTES \\\n\t\t\t\t| FILE_WRITE_ATTRIBUTES \\\n\t\t\t\t| DELETE | READ_CONTROL | WRITE_DAC \\\n\t\t\t\t| WRITE_OWNER | SYNCHRONIZE)\n\n#define SET_MINIMUM_RIGHTS (FILE_READ_EA | FILE_READ_ATTRIBUTES \\\n\t\t\t\t| READ_CONTROL | SYNCHRONIZE)\n\n\n \n#define CIFS_NO_HANDLE        0xFFFF\n\n#define NO_CHANGE_64          0xFFFFFFFFFFFFFFFFULL\n\n \n#define CIFS_IPC_RESOURCE \"\\x49\\x50\\x43\\x24\"\n\n \n#define CIFS_IPC_UNICODE_RESOURCE \"\\x00\\x49\\x00\\x50\\x00\\x43\\x00\\x24\\x00\\x00\"\n\n \n#define UNICODE_NULL \"\\x00\\x00\"\n#define ASCII_NULL 0x00\n\n \n#define CIFS_SV_TYPE_DC     0x00000008\n#define CIFS_SV_TYPE_BACKDC 0x00000010\n\n \n#define CIFS_ALIAS_TYPE_FILE 0x0001\n#define CIFS_SHARE_TYPE_FILE 0x0000\n\n \n#define ATTR_READONLY  0x0001\n#define ATTR_HIDDEN    0x0002\n#define ATTR_SYSTEM    0x0004\n#define ATTR_VOLUME    0x0008\n#define ATTR_DIRECTORY 0x0010\n#define ATTR_ARCHIVE   0x0020\n#define ATTR_DEVICE    0x0040\n#define ATTR_NORMAL    0x0080\n#define ATTR_TEMPORARY 0x0100\n#define ATTR_SPARSE    0x0200\n#define ATTR_REPARSE   0x0400\n#define ATTR_COMPRESSED 0x0800\n#define ATTR_OFFLINE    0x1000\t \n#define ATTR_NOT_CONTENT_INDEXED 0x2000\n#define ATTR_ENCRYPTED  0x4000\n#define ATTR_POSIX_SEMANTICS 0x01000000\n#define ATTR_BACKUP_SEMANTICS 0x02000000\n#define ATTR_DELETE_ON_CLOSE 0x04000000\n#define ATTR_SEQUENTIAL_SCAN 0x08000000\n#define ATTR_RANDOM_ACCESS   0x10000000\n#define ATTR_NO_BUFFERING    0x20000000\n#define ATTR_WRITE_THROUGH   0x80000000\n\n \n#define FILE_NO_SHARE     0x00000000\n#define FILE_SHARE_READ   0x00000001\n#define FILE_SHARE_WRITE  0x00000002\n#define FILE_SHARE_DELETE 0x00000004\n#define FILE_SHARE_ALL    0x00000007\n\n \n#define FILE_SUPERSEDE    0x00000000\n#define FILE_OPEN         0x00000001\n#define FILE_CREATE       0x00000002\n#define FILE_OPEN_IF      0x00000003\n#define FILE_OVERWRITE    0x00000004\n#define FILE_OVERWRITE_IF 0x00000005\n\n \n#define CREATE_NOT_FILE\t\t0x00000001\t \n#define CREATE_WRITE_THROUGH\t0x00000002\n#define CREATE_SEQUENTIAL       0x00000004\n#define CREATE_NO_BUFFER        0x00000008       \n#define CREATE_SYNC_ALERT       0x00000010\t \n#define CREATE_ASYNC_ALERT      0x00000020\t \n#define CREATE_NOT_DIR\t\t0x00000040     \n#define CREATE_TREE_CONNECTION  0x00000080\t \n#define CREATE_COMPLETE_IF_OPLK 0x00000100\t \n#define CREATE_NO_EA_KNOWLEDGE  0x00000200\n#define CREATE_EIGHT_DOT_THREE  0x00000400\t \n#define CREATE_OPEN_FOR_RECOVERY 0x00000400\n#define CREATE_RANDOM_ACCESS\t0x00000800\n#define CREATE_DELETE_ON_CLOSE\t0x00001000\n#define CREATE_OPEN_BY_ID       0x00002000\n#define CREATE_OPEN_BACKUP_INTENT 0x00004000\n#define CREATE_NO_COMPRESSION   0x00008000\n#define CREATE_RESERVE_OPFILTER 0x00100000\t \n#define OPEN_REPARSE_POINT\t0x00200000\n#define OPEN_NO_RECALL          0x00400000\n#define OPEN_FREE_SPACE_QUERY   0x00800000\t \n#define CREATE_OPTIONS_MASK     0x007FFFFF\n#define CREATE_OPTION_READONLY\t0x10000000\n#define CREATE_OPTION_SPECIAL   0x20000000    \n\n \n#define SECURITY_ANONYMOUS      0\n#define SECURITY_IDENTIFICATION 1\n#define SECURITY_IMPERSONATION  2\n#define SECURITY_DELEGATION     3\n\n \n#define SECURITY_CONTEXT_TRACKING 0x01\n#define SECURITY_EFFECTIVE_ONLY   0x02\n\n \n#define CIFS_DFT_PID  0x1234\n\n \n#define CIFS_COPY_OP 1\n#define CIFS_RENAME_OP 2\n\n#define GETU16(var)  (*((__u16 *)var))\t \n#define GETU32(var)  (*((__u32 *)var))\t \n\nstruct smb_hdr {\n\t__be32 smb_buf_length;\t \n\t__u8 Protocol[4];\n\t__u8 Command;\n\tunion {\n\t\tstruct {\n\t\t\t__u8 ErrorClass;\n\t\t\t__u8 Reserved;\n\t\t\t__le16 Error;\n\t\t} __attribute__((packed)) DosError;\n\t\t__le32 CifsError;\n\t} __attribute__((packed)) Status;\n\t__u8 Flags;\n\t__le16 Flags2;\t\t \n\t__le16 PidHigh;\n\tunion {\n\t\tstruct {\n\t\t\t__le32 SequenceNumber;   \n\t\t\t__u32 Reserved;  \n\t\t} __attribute__((packed)) Sequence;\n\t\t__u8 SecuritySignature[8];\t \n\t} __attribute__((packed)) Signature;\n\t__u8 pad[2];\n\t__u16 Tid;\n\t__le16 Pid;\n\t__u16 Uid;\n\t__le16 Mid;\n\t__u8 WordCount;\n} __attribute__((packed));\n\n \nstatic inline void *\nBCC(struct smb_hdr *smb)\n{\n\treturn (void *)smb + sizeof(*smb) + 2 * smb->WordCount;\n}\n\n \n#define pByteArea(smb_var) (BCC(smb_var) + 2)\n\n \nstatic inline __u16\nget_bcc(struct smb_hdr *hdr)\n{\n\t__le16 *bc_ptr = (__le16 *)BCC(hdr);\n\n\treturn get_unaligned_le16(bc_ptr);\n}\n\n \nstatic inline void\nput_bcc(__u16 count, struct smb_hdr *hdr)\n{\n\t__le16 *bc_ptr = (__le16 *)BCC(hdr);\n\n\tput_unaligned_le16(count, bc_ptr);\n}\n\n \n#define CNLEN 15\n\n \n\n \n#define MAXCOMMENTLEN 40\n\n \n#define MAX_PATHCONF 256\n\n \n\ntypedef struct negotiate_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 ByteCount;\n\tunsigned char DialectsArray[];\n} __attribute__((packed)) NEGOTIATE_REQ;\n\n#define MIN_TZ_ADJ (15 * 60)  \n\n#define READ_RAW_ENABLE 1\n#define WRITE_RAW_ENABLE 2\n#define RAW_ENABLE (READ_RAW_ENABLE | WRITE_RAW_ENABLE)\n#define SMB1_CLIENT_GUID_SIZE (16)\ntypedef struct negotiate_rsp {\n\tstruct smb_hdr hdr;\t \n\t__le16 DialectIndex;  \n\t__u8 SecurityMode;\n\t__le16 MaxMpxCount;\n\t__le16 MaxNumberVcs;\n\t__le32 MaxBufferSize;\n\t__le32 MaxRawSize;\n\t__le32 SessionKey;\n\t__le32 Capabilities;\t \n\t__le32 SystemTimeLow;\n\t__le32 SystemTimeHigh;\n\t__le16 ServerTimeZone;\n\t__u8 EncryptionKeyLength;\n\t__u16 ByteCount;\n\tunion {\n\t\t \n\t\tDECLARE_FLEX_ARRAY(unsigned char, EncryptionKey);\n\t\t \n\t\t \n\t\t \n\t\tstruct {\n\t\t\tunsigned char GUID[SMB1_CLIENT_GUID_SIZE];\n\t\t\tunsigned char SecurityBlob[];\n\t\t} __attribute__((packed)) extended_response;\n\t} __attribute__((packed)) u;\n} __attribute__((packed)) NEGOTIATE_RSP;\n\n \n#define SECMODE_USER          0x01\t \n#define SECMODE_PW_ENCRYPT    0x02\n#define SECMODE_SIGN_ENABLED  0x04\t \n#define SECMODE_SIGN_REQUIRED 0x08\t \n\n \n#define CAP_RAW_MODE           0x00000001\n#define CAP_MPX_MODE           0x00000002\n#define CAP_UNICODE            0x00000004\n#define CAP_LARGE_FILES        0x00000008\n#define CAP_NT_SMBS            0x00000010\t \n#define CAP_RPC_REMOTE_APIS    0x00000020\n#define CAP_STATUS32           0x00000040\n#define CAP_LEVEL_II_OPLOCKS   0x00000080\n#define CAP_LOCK_AND_READ      0x00000100\n#define CAP_NT_FIND            0x00000200\n#define CAP_DFS                0x00001000\n#define CAP_INFOLEVEL_PASSTHRU 0x00002000\n#define CAP_LARGE_READ_X       0x00004000\n#define CAP_LARGE_WRITE_X      0x00008000\n#define CAP_LWIO               0x00010000  \n#define CAP_UNIX               0x00800000\n#define CAP_COMPRESSED_DATA    0x02000000\n#define CAP_DYNAMIC_REAUTH     0x20000000\n#define CAP_PERSISTENT_HANDLES 0x40000000\n#define CAP_EXTENDED_SECURITY  0x80000000\n\ntypedef union smb_com_session_setup_andx {\n\tstruct {\t\t \n\t\tstruct smb_hdr hdr;\t \n\t\t__u8 AndXCommand;\n\t\t__u8 AndXReserved;\n\t\t__le16 AndXOffset;\n\t\t__le16 MaxBufferSize;\n\t\t__le16 MaxMpxCount;\n\t\t__le16 VcNumber;\n\t\t__u32 SessionKey;\n\t\t__le16 SecurityBlobLength;\n\t\t__u32 Reserved;\n\t\t__le32 Capabilities;\t \n\t\t__le16 ByteCount;\n\t\tunsigned char SecurityBlob[];\t \n\t\t \n\t\t \n\t} __attribute__((packed)) req;\t \n\n\tstruct {\t\t \n\t\tstruct smb_hdr hdr;\t \n\t\t__u8 AndXCommand;\n\t\t__u8 AndXReserved;\n\t\t__le16 AndXOffset;\n\t\t__le16 MaxBufferSize;\n\t\t__le16 MaxMpxCount;\n\t\t__le16 VcNumber;\n\t\t__u32 SessionKey;\n\t\t__le16 CaseInsensitivePasswordLength;  \n\t\t__le16 CaseSensitivePasswordLength;  \n\t\t__u32 Reserved;\t \n\t\t__le32 Capabilities;\n\t\t__le16 ByteCount;\n\t\tunsigned char CaseInsensitivePassword[];      \n\t\t \n\t\t \n\t\t \n\t\t \n\t\t \n\t} __attribute__((packed)) req_no_secext;  \n\n\tstruct {\t\t \n\t\tstruct smb_hdr hdr;\t \n\t\t__u8 AndXCommand;\n\t\t__u8 AndXReserved;\n\t\t__le16 AndXOffset;\n\t\t__le16 Action;\t \n\t\t__le16 SecurityBlobLength;\n\t\t__u16 ByteCount;\n\t\tunsigned char SecurityBlob[];\t \n \n \n \n\t} __attribute__((packed)) resp;\t \n\n\tstruct {\t\t \n\t\tstruct smb_hdr hdr;\t \n\t\t__u8 AndXCommand;\n\t\t__u8 AndXReserved;\n\t\t__le16 AndXOffset;\n\t\t__le16 MaxBufferSize;\n\t\t__le16 MaxMpxCount;\n\t\t__le16 VcNumber;\n\t\t__u32 SessionKey;\n\t\t__le16 PasswordLength;\n\t\t__u32 Reserved;  \n\t\t__le16 ByteCount;\n\t\tunsigned char AccountPassword[];\t \n\t\t \n\t\t \n\t\t \n\t\t \n\t} __attribute__((packed)) old_req;  \n\n\tstruct {\t\t \n\t\tstruct smb_hdr hdr;\t \n\t\t__u8 AndXCommand;\n\t\t__u8 AndXReserved;\n\t\t__le16 AndXOffset;\n\t\t__le16 Action;\t \n\t\t__u16 ByteCount;\n\t\tunsigned char NativeOS[];\t \n \n \n\t} __attribute__((packed)) old_resp;  \n} __attribute__((packed)) SESSION_SETUP_ANDX;\n\n \n\n#define NTLMSSP_SERVER_TYPE\t1\n#define NTLMSSP_DOMAIN_TYPE\t2\n#define NTLMSSP_FQ_DOMAIN_TYPE\t3\n#define NTLMSSP_DNS_DOMAIN_TYPE\t4\n#define NTLMSSP_DNS_PARENT_TYPE\t5\n\nstruct ntlmssp2_name {\n\t__le16 type;\n\t__le16 length;\n \n} __attribute__((packed));\n\nstruct ntlmv2_resp {\n\tunion {\n\t    char ntlmv2_hash[CIFS_ENCPWD_SIZE];\n\t    struct {\n\t\t__u8 reserved[8];\n\t\t__u8 key[CIFS_SERVER_CHALLENGE_SIZE];\n\t    } __attribute__((packed)) challenge;\n\t} __attribute__((packed));\n\t__le32 blob_signature;\n\t__u32  reserved;\n\t__le64  time;\n\t__u64  client_chal;  \n\t__u32  reserved2;\n\t \n} __attribute__((packed));\n\n\n#define CIFS_NETWORK_OPSYS \"CIFS VFS Client for Linux\"\n\n \n#define CAP_UNICODE            0x00000004\n#define CAP_LARGE_FILES        0x00000008\n#define CAP_NT_SMBS            0x00000010\n#define CAP_STATUS32           0x00000040\n#define CAP_LEVEL_II_OPLOCKS   0x00000080\n#define CAP_NT_FIND            0x00000200\t \n#define CAP_BULK_TRANSFER      0x20000000\n#define CAP_EXTENDED_SECURITY  0x80000000\n\n \n#define GUEST_LOGIN 1\n\ntypedef struct smb_com_tconx_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 Flags;\t\t \n\t__le16 PasswordLength;\n\t__le16 ByteCount;\n\tunsigned char Password[];\t \n \n} __attribute__((packed)) TCONX_REQ;\n\ntypedef struct smb_com_tconx_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 OptionalSupport;\t \n\t__u16 ByteCount;\n\tunsigned char Service[];\t \n\t \n} __attribute__((packed)) TCONX_RSP;\n\ntypedef struct smb_com_tconx_rsp_ext {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 OptionalSupport;\t \n\t__le32 MaximalShareAccessRights;\n\t__le32 GuestMaximalShareAccessRights;\n\t__u16 ByteCount;\n\tunsigned char Service[];\t \n\t \n} __attribute__((packed)) TCONX_RSP_EXT;\n\n\n \n#define DISCONNECT_TID          0x0001\n#define TCON_EXTENDED_SIGNATURES 0x0004\n#define TCON_EXTENDED_SECINFO   0x0008\n\n \n#define SMB_SUPPORT_SEARCH_BITS 0x0001\t \n#define SMB_SHARE_IS_IN_DFS     0x0002\n#define SMB_CSC_MASK               0x000C\n \n#define SMB_CSC_CACHE_MANUAL_REINT 0x0000\n#define SMB_CSC_CACHE_AUTO_REINT   0x0004\n#define SMB_CSC_CACHE_VDO          0x0008\n#define SMB_CSC_NO_CACHING         0x000C\n#define SMB_UNIQUE_FILE_NAME    0x0010\n#define SMB_EXTENDED_SIGNATURES 0x0020\n\n \n\ntypedef struct smb_com_echo_req {\n\tstruct\tsmb_hdr hdr;\n\t__le16\tEchoCount;\n\t__le16\tByteCount;\n\tchar\tData[];\n} __attribute__((packed)) ECHO_REQ;\n\ntypedef struct smb_com_echo_rsp {\n\tstruct\tsmb_hdr hdr;\n\t__le16\tSequenceNumber;\n\t__le16\tByteCount;\n\tchar\tData[];\n} __attribute__((packed)) ECHO_RSP;\n\ntypedef struct smb_com_logoff_andx_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__u16 AndXOffset;\n\t__u16 ByteCount;\n} __attribute__((packed)) LOGOFF_ANDX_REQ;\n\ntypedef struct smb_com_logoff_andx_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__u16 AndXOffset;\n\t__u16 ByteCount;\n} __attribute__((packed)) LOGOFF_ANDX_RSP;\n\ntypedef union smb_com_tree_disconnect {\t \n\t\t\t\t\t \n\tstruct {\n\t\tstruct smb_hdr hdr;\t \n\t\t__u16 ByteCount;\t \n\t} __attribute__((packed)) req;\n\tstruct {\n\t\tstruct smb_hdr hdr;\t \n\t\t__u16 ByteCount;\t \n\t} __attribute__((packed)) resp;\n} __attribute__((packed)) TREE_DISCONNECT;\n\ntypedef struct smb_com_close_req {\n\tstruct smb_hdr hdr;\t \n\t__u16 FileID;\n\t__u32 LastWriteTime;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) CLOSE_REQ;\n\ntypedef struct smb_com_close_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) CLOSE_RSP;\n\ntypedef struct smb_com_flush_req {\n\tstruct smb_hdr hdr;\t \n\t__u16 FileID;\n\t__u16 ByteCount;\t \n} __attribute__((packed)) FLUSH_REQ;\n\ntypedef struct smb_com_findclose_req {\n\tstruct smb_hdr hdr;  \n\t__u16 FileID;\n\t__u16 ByteCount;     \n} __attribute__((packed)) FINDCLOSE_REQ;\n\n \n#define REQ_MORE_INFO      0x00000001   \n#define REQ_OPLOCK         0x00000002\n#define REQ_BATCHOPLOCK    0x00000004\n#define REQ_OPENDIRONLY    0x00000008\n#define REQ_EXTENDED_INFO  0x00000010\n\n \n#define DISK_TYPE\t\t0x0000\n#define BYTE_PIPE_TYPE\t\t0x0001\n#define MESSAGE_PIPE_TYPE\t0x0002\n#define PRINTER_TYPE\t\t0x0003\n#define COMM_DEV_TYPE\t\t0x0004\n#define UNKNOWN_TYPE\t\t0xFFFF\n\n \n#define NO_EAS\t\t\t0x0001\n#define NO_SUBSTREAMS\t\t0x0002\n#define NO_REPARSETAG\t\t0x0004\n \n#define ICOUNT_MASK\t\t0x00FF\n#define PIPE_READ_MODE\t\t0x0100\n#define NAMED_PIPE_TYPE\t\t0x0400\n#define PIPE_END_POINT\t\t0x4000\n#define BLOCKING_NAMED_PIPE\t0x8000\n\ntypedef struct smb_com_open_req {\t \n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u8 Reserved;\t\t \n\t__le16 NameLength;\n\t__le32 OpenFlags;\n\t__u32  RootDirectoryFid;\n\t__le32 DesiredAccess;\n\t__le64 AllocationSize;\n\t__le32 FileAttributes;\n\t__le32 ShareAccess;\n\t__le32 CreateDisposition;\n\t__le32 CreateOptions;\n\t__le32 ImpersonationLevel;\n\t__u8 SecurityFlags;\n\t__le16 ByteCount;\n\tchar fileName[];\n} __attribute__((packed)) OPEN_REQ;\n\n \n#define OPLOCK_NONE  \t 0\n#define OPLOCK_EXCLUSIVE 1\n#define OPLOCK_BATCH\t 2\n#define OPLOCK_READ\t 3   \n\n \n#define CIFS_CREATE_ACTION 0x20000  \n\ntypedef struct smb_com_open_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u8 OplockLevel;\n\t__u16 Fid;\n\t__le32 CreateAction;\n\tstruct_group(common_attributes,\n\t\t__le64 CreationTime;\n\t\t__le64 LastAccessTime;\n\t\t__le64 LastWriteTime;\n\t\t__le64 ChangeTime;\n\t\t__le32 FileAttributes;\n\t);\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\n\t__le16 FileType;\n\t__le16 DeviceState;\n\t__u8 DirectoryFlag;\n\t__u16 ByteCount;\t \n} __attribute__((packed)) OPEN_RSP;\n\ntypedef struct smb_com_open_rsp_ext {\n\tstruct smb_hdr hdr;      \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u8 OplockLevel;\n\t__u16 Fid;\n\t__le32 CreateAction;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le32 FileAttributes;\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\n\t__le16 FileType;\n\t__le16 DeviceState;\n\t__u8 DirectoryFlag;\n\t__u8 VolumeGUID[16];\n\t__u64 FileId;  \n\t__le32 MaximalAccessRights;\n\t__le32 GuestMaximalAccessRights;\n\t__u16 ByteCount;         \n} __attribute__((packed)) OPEN_RSP_EXT;\n\n\n \ntypedef struct smb_com_openx_req {\n\tstruct smb_hdr\thdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 OpenFlags;\n\t__le16 Mode;\n\t__le16 Sattr;  \n\t__le16 FileAttributes;   \n\t__le32 CreateTime;  \n\t__le16 OpenFunction;\n\t__le32 EndOfFile;\n\t__le32 Timeout;\n\t__le32 Reserved;\n\t__le16  ByteCount;   \n\tchar   fileName[];\n} __attribute__((packed)) OPENX_REQ;\n\ntypedef struct smb_com_openx_rsp {\n\tstruct smb_hdr\thdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16  Fid;\n\t__le16 FileAttributes;\n\t__le32 LastWriteTime;  \n\t__le32 EndOfFile;\n\t__le16 Access;\n\t__le16 FileType;\n\t__le16 IPCState;\n\t__le16 Action;\n\t__u32  FileId;\n\t__u16  Reserved;\n\t__u16  ByteCount;\n} __attribute__((packed)) OPENX_RSP;\n\n \n\n \ntypedef struct smb_com_writex_req {\n\tstruct smb_hdr hdr;      \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 Fid;\n\t__le32 OffsetLow;\n\t__u32 Reserved;  \n\t__le16 WriteMode;  \n\t__le16 Remaining;\n\t__le16 Reserved2;\n\t__le16 DataLengthLow;\n\t__le16 DataOffset;\n\t__le16 ByteCount;\n\t__u8 Pad;\t\t \n\tchar Data[];\n} __attribute__((packed)) WRITEX_REQ;\n\ntypedef struct smb_com_write_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 Fid;\n\t__le32 OffsetLow;\n\t__u32 Reserved;\n\t__le16 WriteMode;\n\t__le16 Remaining;\n\t__le16 DataLengthHigh;\n\t__le16 DataLengthLow;\n\t__le16 DataOffset;\n\t__le32 OffsetHigh;\n\t__le16 ByteCount;\n\t__u8 Pad;\t\t \n\tchar Data[];\n} __attribute__((packed)) WRITE_REQ;\n\ntypedef struct smb_com_write_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 Count;\n\t__le16 Remaining;\n\t__le16 CountHigh;\n\t__u16  Reserved;\n\t__u16 ByteCount;\n} __attribute__((packed)) WRITE_RSP;\n\n \ntypedef struct smb_com_readx_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 Fid;\n\t__le32 OffsetLow;\n\t__le16 MaxCount;\n\t__le16 MinCount;\t \n\t__le32 Reserved;\n\t__le16 Remaining;\n\t__le16 ByteCount;\n} __attribute__((packed)) READX_REQ;\n\ntypedef struct smb_com_read_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 Fid;\n\t__le32 OffsetLow;\n\t__le16 MaxCount;\n\t__le16 MinCount;\t\t \n\t__le32 MaxCountHigh;\n\t__le16 Remaining;\n\t__le32 OffsetHigh;\n\t__le16 ByteCount;\n} __attribute__((packed)) READ_REQ;\n\ntypedef struct smb_com_read_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__le16 Remaining;\n\t__le16 DataCompactionMode;\n\t__le16 Reserved;\n\t__le16 DataLength;\n\t__le16 DataOffset;\n\t__le16 DataLengthHigh;\n\t__u64 Reserved2;\n\t__u16 ByteCount;\n\t \n} __attribute__((packed)) READ_RSP;\n\ntypedef struct locking_andx_range {\n\t__le16 Pid;\n\t__le16 Pad;\n\t__le32 OffsetHigh;\n\t__le32 OffsetLow;\n\t__le32 LengthHigh;\n\t__le32 LengthLow;\n} __attribute__((packed)) LOCKING_ANDX_RANGE;\n\n#define LOCKING_ANDX_SHARED_LOCK     0x01\n#define LOCKING_ANDX_OPLOCK_RELEASE  0x02\n#define LOCKING_ANDX_CHANGE_LOCKTYPE 0x04\n#define LOCKING_ANDX_CANCEL_LOCK     0x08\n#define LOCKING_ANDX_LARGE_FILES     0x10\t \n\ntypedef struct smb_com_lock_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 Fid;\n\t__u8 LockType;\n\t__u8 OplockLevel;\n\t__le32 Timeout;\n\t__le16 NumberOfUnlocks;\n\t__le16 NumberOfLocks;\n\t__le16 ByteCount;\n\tLOCKING_ANDX_RANGE Locks[];\n} __attribute__((packed)) LOCK_REQ;\n\n \n#define CIFS_RDLCK\t0\n#define CIFS_WRLCK\t1\n#define CIFS_UNLCK      2\ntypedef struct cifs_posix_lock {\n\t__le16  lock_type;   \n\t__le16  lock_flags;  \n\t__le32  pid;\n\t__le64\tstart;\n\t__le64\tlength;\n\t \n} __attribute__((packed)) CIFS_POSIX_LOCK;\n\ntypedef struct smb_com_lock_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 AndXCommand;\n\t__u8 AndXReserved;\n\t__le16 AndXOffset;\n\t__u16 ByteCount;\n} __attribute__((packed)) LOCK_RSP;\n\ntypedef struct smb_com_rename_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 SearchAttributes;\t \n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char OldFileName[];\n\t \n\t \n} __attribute__((packed)) RENAME_REQ;\n\n\t \n#define COPY_MUST_BE_FILE      0x0001\n#define COPY_MUST_BE_DIR       0x0002\n#define COPY_TARGET_MODE_ASCII 0x0004  \n#define COPY_SOURCE_MODE_ASCII 0x0008  \n#define COPY_VERIFY_WRITES     0x0010\n#define COPY_TREE              0x0020\n\ntypedef struct smb_com_copy_req {\n\tstruct smb_hdr hdr;\t \n\t__u16 Tid2;\n\t__le16 OpenFunction;\n\t__le16 Flags;\n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char OldFileName[];\n\t \n\t \n} __attribute__((packed)) COPY_REQ;\n\ntypedef struct smb_com_copy_rsp {\n\tstruct smb_hdr hdr;      \n\t__le16 CopyCount;     \n\t__u16 ByteCount;     \n\t__u8 BufferFormat;   \n\tunsigned char ErrorFileName[];  \n} __attribute__((packed)) COPY_RSP;\n\n#define CREATE_HARD_LINK\t\t0x103\n#define MOVEFILE_COPY_ALLOWED\t\t0x0002\n#define MOVEFILE_REPLACE_EXISTING\t0x0001\n\ntypedef struct smb_com_nt_rename_req {\t \n\tstruct smb_hdr hdr;\t \n\t__le16 SearchAttributes;\t \n\t__le16 Flags;\t\t \n\t__le32 ClusterCount;\n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char OldFileName[];\n\t \n\t \n} __attribute__((packed)) NT_RENAME_REQ;\n\ntypedef struct smb_com_rename_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) RENAME_RSP;\n\ntypedef struct smb_com_delete_file_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 SearchAttributes;\n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char fileName[];\n} __attribute__((packed)) DELETE_FILE_REQ;\n\ntypedef struct smb_com_delete_file_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) DELETE_FILE_RSP;\n\ntypedef struct smb_com_delete_directory_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char DirName[];\n} __attribute__((packed)) DELETE_DIRECTORY_REQ;\n\ntypedef struct smb_com_delete_directory_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) DELETE_DIRECTORY_RSP;\n\ntypedef struct smb_com_create_directory_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 ByteCount;\n\t__u8 BufferFormat;\t \n\tunsigned char DirName[];\n} __attribute__((packed)) CREATE_DIRECTORY_REQ;\n\ntypedef struct smb_com_create_directory_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u16 ByteCount;\t \n} __attribute__((packed)) CREATE_DIRECTORY_RSP;\n\ntypedef struct smb_com_query_information_req {\n\tstruct smb_hdr hdr;      \n\t__le16 ByteCount;\t \n\t__u8 BufferFormat;       \n\tunsigned char FileName[];\n} __attribute__((packed)) QUERY_INFORMATION_REQ;\n\ntypedef struct smb_com_query_information_rsp {\n\tstruct smb_hdr hdr;      \n\t__le16 attr;\n\t__le32  last_write_time;\n\t__le32 size;\n\t__u16  reserved[5];\n\t__le16 ByteCount;\t \n} __attribute__((packed)) QUERY_INFORMATION_RSP;\n\ntypedef struct smb_com_setattr_req {\n\tstruct smb_hdr hdr;  \n\t__le16 attr;\n\t__le16 time_low;\n\t__le16 time_high;\n\t__le16 reserved[5];  \n\t__u16  ByteCount;\n\t__u8   BufferFormat;  \n\tunsigned char fileName[];\n} __attribute__((packed)) SETATTR_REQ;\n\ntypedef struct smb_com_setattr_rsp {\n\tstruct smb_hdr hdr;      \n\t__u16 ByteCount;         \n} __attribute__((packed)) SETATTR_RSP;\n\n \n\n \n \n \n \n \ntypedef struct smb_com_ntransact_req {\n\tstruct smb_hdr hdr;  \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand;  \n\t \n\t__le16 ByteCount;\n\t__u8 Pad[3];\n\t__u8 Parms[];\n} __attribute__((packed)) NTRANSACT_REQ;\n\ntypedef struct smb_com_ntransact_rsp {\n\tstruct smb_hdr hdr;      \n\t__u8 Reserved[3];\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 ParameterDisplacement;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__le32 DataDisplacement;\n\t__u8 SetupCount;    \n\t__u16 ByteCount;\n\t \n\t \n} __attribute__((packed)) NTRANSACT_RSP;\n\n \nstruct srv_copychunk {\n\t__le64 SourceOffset;\n\t__le64 DestinationOffset;\n\t__le32 CopyLength;\n\t__u32  Reserved;\n} __packed;\n\ntypedef struct smb_com_transaction_ioctl_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand;  \n\t__le32 FunctionCode;\n\t__u16 Fid;\n\t__u8 IsFsctl;   \n\t__u8 IsRootFlag;  \n\t__le16 ByteCount;\n\t__u8 Pad[3];\n\t__u8 Data[];\n} __attribute__((packed)) TRANSACT_IOCTL_REQ;\n\ntypedef struct smb_com_transaction_compr_ioctl_req {\n\tstruct smb_hdr hdr;\t \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand;  \n\t__le32 FunctionCode;\n\t__u16 Fid;\n\t__u8 IsFsctl;   \n\t__u8 IsRootFlag;  \n\t__le16 ByteCount;\n\t__u8 Pad[3];\n\t__le16 compression_state;   \n} __attribute__((packed)) TRANSACT_COMPR_IOCTL_REQ;\n\n \n#define COMPRESSION_FORMAT_NONE\t\t0x0000\n#define COMPRESSION_FORMAT_DEFAULT\t0x0001\n#define COMPRESSION_FORMAT_LZNT1\t0x0002\n\ntypedef struct smb_com_transaction_ioctl_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 Reserved[3];\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 ParameterDisplacement;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__le32 DataDisplacement;\n\t__u8 SetupCount;\t \n\t__le16 ReturnedDataLen;\n\t__le16 ByteCount;\n} __attribute__((packed)) TRANSACT_IOCTL_RSP;\n\n#define CIFS_ACL_OWNER 1\n#define CIFS_ACL_GROUP 2\n#define CIFS_ACL_DACL  4\n#define CIFS_ACL_SACL  8\n\ntypedef struct smb_com_transaction_qsec_req {\n\tstruct smb_hdr hdr;      \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand;  \n\t__le16 ByteCount;  \n\t__u8 Pad[3];\n\t__u16 Fid;\n\t__u16 Reserved2;\n\t__le32 AclFlags;\n} __attribute__((packed)) QUERY_SEC_DESC_REQ;\n\n\ntypedef struct smb_com_transaction_ssec_req {\n\tstruct smb_hdr hdr;      \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand;  \n\t__le16 ByteCount;  \n\t__u8 Pad[3];\n\t__u16 Fid;\n\t__u16 Reserved2;\n\t__le32 AclFlags;\n} __attribute__((packed)) SET_SEC_DESC_REQ;\n\ntypedef struct smb_com_transaction_change_notify_req {\n\tstruct smb_hdr hdr;      \n\t__u8 MaxSetupCount;\n\t__u16 Reserved;\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 MaxParameterCount;\n\t__le32 MaxDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__u8 SetupCount;  \n\t \n\t__le16 SubCommand; \n\t__le32 CompletionFilter;   \n\t__u16 Fid;\n\t__u8 WatchTree;   \n\t__u8 Reserved2;\n\t__le16 ByteCount;\n \n \n} __attribute__((packed)) TRANSACT_CHANGE_NOTIFY_REQ;\n\n \ntypedef struct smb_com_transaction_change_notify_rsp {\n\tstruct smb_hdr hdr;\t \n\t__u8 Reserved[3];\n\t__le32 TotalParameterCount;\n\t__le32 TotalDataCount;\n\t__le32 ParameterCount;\n\t__le32 ParameterOffset;\n\t__le32 ParameterDisplacement;\n\t__le32 DataCount;\n\t__le32 DataOffset;\n\t__le32 DataDisplacement;\n\t__u8 SetupCount;    \n\t__u16 ByteCount;\n\t \n} __attribute__((packed)) TRANSACT_CHANGE_NOTIFY_RSP;\n \n#define FILE_NOTIFY_CHANGE_FILE_NAME    0x00000001\n#define FILE_NOTIFY_CHANGE_DIR_NAME     0x00000002\n#define FILE_NOTIFY_CHANGE_NAME         0x00000003\n#define FILE_NOTIFY_CHANGE_ATTRIBUTES   0x00000004\n#define FILE_NOTIFY_CHANGE_SIZE         0x00000008\n#define FILE_NOTIFY_CHANGE_LAST_WRITE   0x00000010\n#define FILE_NOTIFY_CHANGE_LAST_ACCESS  0x00000020\n#define FILE_NOTIFY_CHANGE_CREATION     0x00000040\n#define FILE_NOTIFY_CHANGE_EA           0x00000080\n#define FILE_NOTIFY_CHANGE_SECURITY     0x00000100\n#define FILE_NOTIFY_CHANGE_STREAM_NAME  0x00000200\n#define FILE_NOTIFY_CHANGE_STREAM_SIZE  0x00000400\n#define FILE_NOTIFY_CHANGE_STREAM_WRITE 0x00000800\n\n#define FILE_ACTION_ADDED\t\t0x00000001\n#define FILE_ACTION_REMOVED\t\t0x00000002\n#define FILE_ACTION_MODIFIED\t\t0x00000003\n#define FILE_ACTION_RENAMED_OLD_NAME\t0x00000004\n#define FILE_ACTION_RENAMED_NEW_NAME\t0x00000005\n#define FILE_ACTION_ADDED_STREAM\t0x00000006\n#define FILE_ACTION_REMOVED_STREAM\t0x00000007\n#define FILE_ACTION_MODIFIED_STREAM\t0x00000008\n\n \nstruct file_notify_information {\n\t__le32 NextEntryOffset;\n\t__le32 Action;\n\t__le32 FileNameLength;\n\t__u8  FileName[];\n} __attribute__((packed));\n\n \nstruct reparse_symlink_data {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__le16\tSubstituteNameOffset;\n\t__le16\tSubstituteNameLength;\n\t__le16\tPrintNameOffset;\n\t__le16\tPrintNameLength;\n\t__le32\tFlags;\n\tchar\tPathBuffer[];\n} __attribute__((packed));\n\n \n#define SYMLINK_FLAG_RELATIVE 0x00000001\n\n \n#define NFS_SPECFILE_LNK\t0x00000000014B4E4C\n#define NFS_SPECFILE_CHR\t0x0000000000524843\n#define NFS_SPECFILE_BLK\t0x00000000004B4C42\n#define NFS_SPECFILE_FIFO\t0x000000004F464946\n#define NFS_SPECFILE_SOCK\t0x000000004B434F53\nstruct reparse_posix_data {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__le64\tInodeType;  \n\t__u8\tDataBuffer[];\n} __attribute__((packed));\n\nstruct cifs_quota_data {\n\t__u32\trsrvd1;   \n\t__u32\tsid_size;\n\t__u64\trsrvd2;   \n\t__u64\tspace_used;\n\t__u64\tsoft_limit;\n\t__u64\thard_limit;\n\tchar\tsid[];   \n} __attribute__((packed));\n\n \n#define QUOTA_LIST_CONTINUE\t    0\n#define QUOTA_LIST_START\t0x100\n#define QUOTA_FOR_SID\t\t0x101\n\nstruct trans2_req {\n\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;  \n\t__le16 ByteCount;\n} __attribute__((packed));\n\nstruct smb_t2_req {\n\tstruct smb_hdr hdr;\n\tstruct trans2_req t2_req;\n} __attribute__((packed));\n\nstruct trans2_resp {\n\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__u16 Reserved;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 ParameterDisplacement;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__le16 DataDisplacement;\n\t__u8 SetupCount;\n\t__u8 Reserved1;\n\t \n\t \n} __attribute__((packed));\n\nstruct smb_t2_rsp {\n\tstruct smb_hdr hdr;\n\tstruct trans2_resp t2_rsp;\n} __attribute__((packed));\n\n \n#define SMB_INFO_STANDARD                   1\n#define SMB_SET_FILE_EA                     2\n#define SMB_QUERY_FILE_EA_SIZE              2\n#define SMB_INFO_QUERY_EAS_FROM_LIST        3\n#define SMB_INFO_QUERY_ALL_EAS              4\n#define SMB_INFO_IS_NAME_VALID              6\n#define SMB_QUERY_FILE_BASIC_INFO       0x101\n#define SMB_QUERY_FILE_STANDARD_INFO    0x102\n#define SMB_QUERY_FILE_EA_INFO          0x103\n#define SMB_QUERY_FILE_NAME_INFO        0x104\n#define SMB_QUERY_FILE_ALLOCATION_INFO  0x105\n#define SMB_QUERY_FILE_END_OF_FILEINFO  0x106\n#define SMB_QUERY_FILE_ALL_INFO         0x107\n#define SMB_QUERY_ALT_NAME_INFO         0x108\n#define SMB_QUERY_FILE_STREAM_INFO      0x109\n#define SMB_QUERY_FILE_COMPRESSION_INFO 0x10B\n#define SMB_QUERY_FILE_UNIX_BASIC       0x200\n#define SMB_QUERY_FILE_UNIX_LINK        0x201\n#define SMB_QUERY_POSIX_ACL             0x204\n#define SMB_QUERY_XATTR                 0x205   \n#define SMB_QUERY_ATTR_FLAGS            0x206   \n#define SMB_QUERY_POSIX_PERMISSION      0x207\n#define SMB_QUERY_POSIX_LOCK            0x208\n \n \n#define SMB_QUERY_FILE__UNIX_INFO2      0x20b\n#define SMB_QUERY_FILE_INTERNAL_INFO    0x3ee\n#define SMB_QUERY_FILE_ACCESS_INFO      0x3f0\n#define SMB_QUERY_FILE_NAME_INFO2       0x3f1  \n#define SMB_QUERY_FILE_POSITION_INFO    0x3f6\n#define SMB_QUERY_FILE_MODE_INFO        0x3f8\n#define SMB_QUERY_FILE_ALGN_INFO        0x3f9\n\n\n#define SMB_SET_FILE_BASIC_INFO\t        0x101\n#define SMB_SET_FILE_DISPOSITION_INFO   0x102\n#define SMB_SET_FILE_ALLOCATION_INFO    0x103\n#define SMB_SET_FILE_END_OF_FILE_INFO   0x104\n#define SMB_SET_FILE_UNIX_BASIC         0x200\n#define SMB_SET_FILE_UNIX_LINK          0x201\n#define SMB_SET_FILE_UNIX_HLINK         0x203\n#define SMB_SET_POSIX_ACL               0x204\n#define SMB_SET_XATTR                   0x205\n#define SMB_SET_ATTR_FLAGS              0x206   \n#define SMB_SET_POSIX_LOCK              0x208\n#define SMB_POSIX_OPEN                  0x209\n#define SMB_POSIX_UNLINK                0x20a\n#define SMB_SET_FILE_UNIX_INFO2         0x20b\n#define SMB_SET_FILE_BASIC_INFO2        0x3ec\n#define SMB_SET_FILE_RENAME_INFORMATION 0x3f2  \n#define SMB_FILE_ALL_INFO2              0x3fa\n#define SMB_SET_FILE_ALLOCATION_INFO2   0x3fb\n#define SMB_SET_FILE_END_OF_FILE_INFO2  0x3fc\n#define SMB_FILE_MOVE_CLUSTER_INFO      0x407\n#define SMB_FILE_QUOTA_INFO             0x408\n#define SMB_FILE_REPARSEPOINT_INFO      0x409\n#define SMB_FILE_MAXIMUM_INFO           0x40d\n\n \n#define SMB_FIND_FILE_INFO_STANDARD       0x001\n#define SMB_FIND_FILE_QUERY_EA_SIZE       0x002\n#define SMB_FIND_FILE_QUERY_EAS_FROM_LIST 0x003\n#define SMB_FIND_FILE_DIRECTORY_INFO      0x101\n#define SMB_FIND_FILE_FULL_DIRECTORY_INFO 0x102\n#define SMB_FIND_FILE_NAMES_INFO          0x103\n#define SMB_FIND_FILE_BOTH_DIRECTORY_INFO 0x104\n#define SMB_FIND_FILE_ID_FULL_DIR_INFO    0x105\n#define SMB_FIND_FILE_ID_BOTH_DIR_INFO    0x106\n#define SMB_FIND_FILE_UNIX                0x202\n \n\ntypedef struct smb_com_transaction2_qpi_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__le16 InformationLevel;\n\t__u32 Reserved4;\n\tchar FileName[];\n} __attribute__((packed)) TRANSACTION2_QPI_REQ;\n\ntypedef struct smb_com_transaction2_qpi_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u16 Reserved2;  \n} __attribute__((packed)) TRANSACTION2_QPI_RSP;\n\ntypedef struct smb_com_transaction2_spi_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__u16 Pad1;\n\t__le16 InformationLevel;\n\t__u32 Reserved4;\n\tchar FileName[];\n} __attribute__((packed)) TRANSACTION2_SPI_REQ;\n\ntypedef struct smb_com_transaction2_spi_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u16 Reserved2;  \n} __attribute__((packed)) TRANSACTION2_SPI_RSP;\n\nstruct set_file_rename {\n\t__le32 overwrite;    \n\t__u32 root_fid;    \n\t__le32 target_name_len;\n\tchar  target_name[];   \n} __attribute__((packed));\n\nstruct smb_com_transaction2_sfi_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__u16 Pad1;\n\t__u16 Fid;\n\t__le16 InformationLevel;\n\t__u16 Reserved4;\n\t__u8  payload[];\n} __attribute__((packed));\n\nstruct smb_com_transaction2_sfi_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u16 Reserved2;  \n} __attribute__((packed));\n\nstruct smb_t2_qfi_req {\n\tstruct\tsmb_hdr hdr;\n\tstruct\ttrans2_req t2;\n\t__u8\tPad;\n\t__u16\tFid;\n\t__le16\tInformationLevel;\n} __attribute__((packed));\n\nstruct smb_t2_qfi_rsp {\n\tstruct smb_hdr hdr;      \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u16 Reserved2;  \n} __attribute__((packed));\n\n \n#define CIFS_SEARCH_CLOSE_ALWAYS  0x0001\n#define CIFS_SEARCH_CLOSE_AT_END  0x0002\n#define CIFS_SEARCH_RETURN_RESUME 0x0004\n#define CIFS_SEARCH_CONTINUE_FROM_LAST 0x0008\n#define CIFS_SEARCH_BACKUP_SEARCH 0x0010\n\n \n#define CIFS_SMB_RESUME_KEY_SIZE 4\n\ntypedef struct smb_com_transaction2_ffirst_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\t \n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__le16 SearchAttributes;\n\t__le16 SearchCount;\n\t__le16 SearchFlags;\n\t__le16 InformationLevel;\n\t__le32 SearchStorageType;\n\tchar FileName[];\n} __attribute__((packed)) TRANSACTION2_FFIRST_REQ;\n\ntypedef struct smb_com_transaction2_ffirst_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n} __attribute__((packed)) TRANSACTION2_FFIRST_RSP;\n\ntypedef struct smb_com_transaction2_ffirst_rsp_parms {\n\t__u16 SearchHandle;\n\t__le16 SearchCount;\n\t__le16 EndofSearch;\n\t__le16 EAErrorOffset;\n\t__le16 LastNameOffset;\n} __attribute__((packed)) T2_FFIRST_RSP_PARMS;\n\ntypedef struct smb_com_transaction2_fnext_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\t \n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__u16 SearchHandle;\n\t__le16 SearchCount;\n\t__le16 InformationLevel;\n\t__u32 ResumeKey;\n\t__le16 SearchFlags;\n\tchar ResumeFileName[];\n} __attribute__((packed)) TRANSACTION2_FNEXT_REQ;\n\ntypedef struct smb_com_transaction2_fnext_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n} __attribute__((packed)) TRANSACTION2_FNEXT_RSP;\n\ntypedef struct smb_com_transaction2_fnext_rsp_parms {\n\t__le16 SearchCount;\n\t__le16 EndofSearch;\n\t__le16 EAErrorOffset;\n\t__le16 LastNameOffset;\n} __attribute__((packed)) T2_FNEXT_RSP_PARMS;\n\n \n#define SMB_INFO_ALLOCATION         1\n#define SMB_INFO_VOLUME             2\n#define SMB_QUERY_FS_VOLUME_INFO    0x102\n#define SMB_QUERY_FS_SIZE_INFO      0x103\n#define SMB_QUERY_FS_DEVICE_INFO    0x104\n#define SMB_QUERY_FS_ATTRIBUTE_INFO 0x105\n#define SMB_QUERY_CIFS_UNIX_INFO    0x200\n#define SMB_QUERY_POSIX_FS_INFO     0x201\n#define SMB_QUERY_POSIX_WHO_AM_I    0x202\n#define SMB_REQUEST_TRANSPORT_ENCRYPTION 0x203\n#define SMB_QUERY_FS_PROXY          0x204  \n#define SMB_QUERY_LABEL_INFO        0x3ea\n#define SMB_QUERY_FS_QUOTA_INFO     0x3ee\n#define SMB_QUERY_FS_FULL_SIZE_INFO 0x3ef\n#define SMB_QUERY_OBJECTID_INFO     0x3f0\n\ntypedef struct smb_com_transaction2_qfsi_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__le16 InformationLevel;\n} __attribute__((packed)) TRANSACTION2_QFSI_REQ;\n\ntypedef struct smb_com_transaction_qfsi_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u8 Pad;\t \n\t__u32 flags;  \n\t__u32 mask;  \n\t__u64 unix_user_id;\n\t__u64 unix_user_gid;\n\t__u32 number_of_supplementary_gids;  \n\t__u32 number_of_sids;  \n\t__u32 length_of_sid_array;  \n\t__u32 pad;  \n\t    \n\t    \n} __attribute__((packed)) WHOAMI_RSP_DATA;\n\n \n#define SMB_SET_CIFS_UNIX_INFO    0x200\n \n \n\n \ntypedef struct smb_com_transaction2_setfsi_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\t \n\t__le16 ParameterOffset;\n\t__le16 DataCount;\t \n\t__le16 DataOffset;\n\t__u8 SetupCount;\t \n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__u16 FileNum;\t\t \n\t__le16 InformationLevel; \n\t__le16 ClientUnixMajor;  \n\t__le16 ClientUnixMinor;\n\t__le64 ClientUnixCap;    \n} __attribute__((packed)) TRANSACTION2_SETFSI_REQ;\n\n \ntypedef struct smb_com_transaction2_setfs_enc_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\t \n\t__le16 ParameterOffset;\n\t__le16 DataCount;\t \n\t__le16 DataOffset;\n\t__u8 SetupCount;\t \n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad;\n\t__u16  Reserved4;\t \n\t__le16 InformationLevel; \n\t \n} __attribute__((packed)) TRANSACTION2_SETFSI_ENC_REQ;\n\n \ntypedef struct smb_com_transaction2_setfsi_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n} __attribute__((packed)) TRANSACTION2_SETFSI_RSP;\n\ntypedef struct smb_com_transaction2_get_dfs_refer_req {\n\tstruct smb_hdr hdr;\t \n\t__le16 TotalParameterCount;\n\t__le16 TotalDataCount;\n\t__le16 MaxParameterCount;\n\t__le16 MaxDataCount;\n\t__u8 MaxSetupCount;\n\t__u8 Reserved;\n\t__le16 Flags;\n\t__le32 Timeout;\n\t__u16 Reserved2;\n\t__le16 ParameterCount;\n\t__le16 ParameterOffset;\n\t__le16 DataCount;\n\t__le16 DataOffset;\n\t__u8 SetupCount;\n\t__u8 Reserved3;\n\t__le16 SubCommand;\t \n\t__le16 ByteCount;\n\t__u8 Pad[3];\t\t \n\t__le16 MaxReferralLevel;\n\tchar RequestFileName[];\n} __attribute__((packed)) TRANSACTION2_GET_DFS_REFER_REQ;\n\n#define DFS_VERSION cpu_to_le16(0x0003)\n\n \n#define DFS_TYPE_LINK 0x0000   \n#define DFS_TYPE_ROOT 0x0001\n\n \n#define DFS_NAME_LIST_REF 0x0200  \n#define DFS_TARGET_SET_BOUNDARY 0x0400  \n\ntypedef struct dfs_referral_level_3 {  \n\t__le16 VersionNumber;   \n\t__le16 Size;\n\t__le16 ServerType;  \n\t__le16 ReferralEntryFlags;\n\t__le32 TimeToLive;\n\t__le16 DfsPathOffset;\n\t__le16 DfsAlternatePathOffset;\n\t__le16 NetworkAddressOffset;  \n\t__u8   ServiceSiteGuid[16];   \n} __attribute__((packed)) REFERRAL3;\n\nstruct get_dfs_referral_rsp {\n\t__le16 PathConsumed;\n\t__le16 NumberOfReferrals;\n\t__le32 DFSFlags;\n\tREFERRAL3 referrals[];\t \n\t \n} __packed;\n\ntypedef struct smb_com_transaction_get_dfs_refer_rsp {\n\tstruct smb_hdr hdr;\t \n\tstruct trans2_resp t2;\n\t__u16 ByteCount;\n\t__u8 Pad;\n\tstruct get_dfs_referral_rsp dfs_data;\n} __packed TRANSACTION2_GET_DFS_REFER_RSP;\n\n \n#define DFSREF_REFERRAL_SERVER  0x00000001  \n#define DFSREF_STORAGE_SERVER   0x00000002  \n#define DFSREF_TARGET_FAILBACK  0x00000004  \n\n \n\n \n\nstruct serverInfo {\n\tchar name[16];\n\tunsigned char versionMajor;\n\tunsigned char versionMinor;\n\tunsigned long type;\n\tunsigned int commentOffset;\n} __attribute__((packed));\n\n \n\nstruct shareInfo {\n\tchar shareName[13];\n\tchar pad;\n\tunsigned short type;\n\tunsigned int commentOffset;\n} __attribute__((packed));\n\nstruct aliasInfo {\n\tchar aliasName[9];\n\tchar pad;\n\tunsigned int commentOffset;\n\tunsigned char type[2];\n} __attribute__((packed));\n\nstruct aliasInfo92 {\n\tint aliasNameOffset;\n\tint serverNameOffset;\n\tint shareNameOffset;\n} __attribute__((packed));\n\ntypedef struct {\n\t__le64 TotalAllocationUnits;\n\t__le64 FreeAllocationUnits;\n\t__le32 SectorsPerAllocationUnit;\n\t__le32 BytesPerSector;\n} __attribute__((packed)) FILE_SYSTEM_INFO;\t \n\ntypedef struct {\n\t__le32 fsid;\n\t__le32 SectorsPerAllocationUnit;\n\t__le32 TotalAllocationUnits;\n\t__le32 FreeAllocationUnits;\n\t__le16  BytesPerSector;\n} __attribute__((packed)) FILE_SYSTEM_ALLOC_INFO;\n\ntypedef struct {\n\t__le16 MajorVersionNumber;\n\t__le16 MinorVersionNumber;\n\t__le64 Capability;\n} __attribute__((packed)) FILE_SYSTEM_UNIX_INFO;  \n\n \n#define CIFS_UNIX_MAJOR_VERSION 1\n#define CIFS_UNIX_MINOR_VERSION 0\n\n \n#define CIFS_UNIX_FCNTL_CAP             0x00000001  \n#define CIFS_UNIX_POSIX_ACL_CAP         0x00000002  \n#define CIFS_UNIX_XATTR_CAP             0x00000004  \n#define CIFS_UNIX_EXTATTR_CAP           0x00000008  \n#define CIFS_UNIX_POSIX_PATHNAMES_CAP   0x00000010  \n#define CIFS_UNIX_POSIX_PATH_OPS_CAP    0x00000020  \n#define CIFS_UNIX_LARGE_READ_CAP        0x00000040  \n#define CIFS_UNIX_LARGE_WRITE_CAP       0x00000080\n#define CIFS_UNIX_TRANSPORT_ENCRYPTION_CAP 0x00000100  \n#define CIFS_UNIX_TRANSPORT_ENCRYPTION_MANDATORY_CAP  0x00000200  \n#define CIFS_UNIX_PROXY_CAP             0x00000400  \n#ifdef CONFIG_CIFS_POSIX\n \n \n#define CIFS_UNIX_CAP_MASK              0x000003db\n#else\n#define CIFS_UNIX_CAP_MASK              0x00000013\n#endif  \n\n\n#define CIFS_POSIX_EXTENSIONS           0x00000010  \n\ntypedef struct {\n\t \n\t__le32 OptimalTransferSize;   \n\t__le32 BlockSize;\n     \n\t__le64 TotalBlocks;\n\t__le64 BlocksAvail;        \n\t__le64 UserBlocksAvail;    \n     \n\t__le64 TotalFileNodes;\n\t__le64 FreeFileNodes;\n\t__le64 FileSysIdentifier;    \n\t \n\t \n} __attribute__((packed)) FILE_SYSTEM_POSIX_INFO;\n\n \n#define FILE_DEVICE_CD_ROM              0x00000002\n#define FILE_DEVICE_CD_ROM_FILE_SYSTEM  0x00000003\n#define FILE_DEVICE_DFS                 0x00000006\n#define FILE_DEVICE_DISK                0x00000007\n#define FILE_DEVICE_DISK_FILE_SYSTEM    0x00000008\n#define FILE_DEVICE_FILE_SYSTEM         0x00000009\n#define FILE_DEVICE_NAMED_PIPE          0x00000011\n#define FILE_DEVICE_NETWORK             0x00000012\n#define FILE_DEVICE_NETWORK_FILE_SYSTEM 0x00000014\n#define FILE_DEVICE_NULL                0x00000015\n#define FILE_DEVICE_PARALLEL_PORT       0x00000016\n#define FILE_DEVICE_PRINTER             0x00000018\n#define FILE_DEVICE_SERIAL_PORT         0x0000001b\n#define FILE_DEVICE_STREAMS             0x0000001e\n#define FILE_DEVICE_TAPE                0x0000001f\n#define FILE_DEVICE_TAPE_FILE_SYSTEM    0x00000020\n#define FILE_DEVICE_VIRTUAL_DISK        0x00000024\n#define FILE_DEVICE_NETWORK_REDIRECTOR  0x00000028\n\n \n#define FILE_REMOVABLE_MEDIA\t\t\t0x00000001\n#define FILE_READ_ONLY_DEVICE\t\t\t0x00000002\n#define FILE_FLOPPY_DISKETTE\t\t\t0x00000004\n#define FILE_WRITE_ONCE_MEDIA\t\t\t0x00000008\n#define FILE_REMOTE_DEVICE\t\t\t0x00000010\n#define FILE_DEVICE_IS_MOUNTED\t\t\t0x00000020\n#define FILE_VIRTUAL_VOLUME\t\t\t0x00000040\n#define FILE_DEVICE_SECURE_OPEN\t\t\t0x00000100\n#define FILE_CHARACTERISTIC_TS_DEVICE\t\t0x00001000\n#define FILE_CHARACTERISTIC_WEBDAV_DEVICE\t0x00002000\n#define FILE_PORTABLE_DEVICE\t\t\t0x00004000\n#define FILE_DEVICE_ALLOW_APPCONTAINER_TRAVERSAL 0x00020000\n\ntypedef struct {\n\t__le32 DeviceType;\n\t__le32 DeviceCharacteristics;\n} __attribute__((packed)) FILE_SYSTEM_DEVICE_INFO;  \n\n \n#define MIN_FS_ATTR_INFO_SIZE 12\n\n\n \n#define FILE_SUPPORTS_SPARSE_VDL\t0x10000000  \n#define FILE_SUPPORTS_BLOCK_REFCOUNTING\t0x08000000  \n#define FILE_SUPPORT_INTEGRITY_STREAMS\t0x04000000\n#define FILE_SUPPORTS_USN_JOURNAL\t0x02000000\n#define FILE_SUPPORTS_OPEN_BY_FILE_ID\t0x01000000\n#define FILE_SUPPORTS_EXTENDED_ATTRIBUTES 0x00800000\n#define FILE_SUPPORTS_HARD_LINKS\t0x00400000\n#define FILE_SUPPORTS_TRANSACTIONS\t0x00200000\n#define FILE_SEQUENTIAL_WRITE_ONCE\t0x00100000\n#define FILE_READ_ONLY_VOLUME\t\t0x00080000\n#define FILE_NAMED_STREAMS\t\t0x00040000\n#define FILE_SUPPORTS_ENCRYPTION\t0x00020000\n#define FILE_SUPPORTS_OBJECT_IDS\t0x00010000\n#define FILE_VOLUME_IS_COMPRESSED\t0x00008000\n#define FILE_SUPPORTS_REMOTE_STORAGE\t0x00000100\n#define FILE_SUPPORTS_REPARSE_POINTS\t0x00000080\n#define FILE_SUPPORTS_SPARSE_FILES\t0x00000040\n#define FILE_VOLUME_QUOTAS\t\t0x00000020\n#define FILE_FILE_COMPRESSION\t\t0x00000010\n#define FILE_PERSISTENT_ACLS\t\t0x00000008\n#define FILE_UNICODE_ON_DISK\t\t0x00000004\n#define FILE_CASE_PRESERVED_NAMES\t0x00000002\n#define FILE_CASE_SENSITIVE_SEARCH\t0x00000001\ntypedef struct {\n\t__le32 Attributes;\n\t__le32 MaxPathNameComponentLength;\n\t__le32 FileSystemNameLen;\n\tchar FileSystemName[52];  \n} __attribute__((packed)) FILE_SYSTEM_ATTRIBUTE_INFO;\n\n \n \n \ntypedef struct {  \n\tstruct_group(common_attributes,\n\t\t__le64 CreationTime;\n\t\t__le64 LastAccessTime;\n\t\t__le64 LastWriteTime;\n\t\t__le64 ChangeTime;\n\t\t__le32 Attributes;\n\t);\n\t__u32 Pad1;\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\t \n\t__le32 NumberOfLinks;\t \n\t__u8 DeletePending;\n\t__u8 Directory;\n\t__u16 Pad2;\n\t__le64 IndexNumber;\n\t__le32 EASize;\n\t__le32 AccessFlags;\n\t__u64 IndexNumber1;\n\t__le64 CurrentByteOffset;\n\t__le32 Mode;\n\t__le32 AlignmentRequirement;\n\t__le32 FileNameLength;\n\tunion {\n\t\tchar __pad;\n\t\tDECLARE_FLEX_ARRAY(char, FileName);\n\t};\n} __attribute__((packed)) FILE_ALL_INFO;\t \n\ntypedef struct {\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\t \n\t__le32 NumberOfLinks;\t \n\t__u8 DeletePending;\n\t__u8 Directory;\n\t__u16 Pad;\n} __attribute__((packed)) FILE_STANDARD_INFO;\t \n\n\n \n#define UNIX_FILE      0\n#define UNIX_DIR       1\n#define UNIX_SYMLINK   2\n#define UNIX_CHARDEV   3\n#define UNIX_BLOCKDEV  4\n#define UNIX_FIFO      5\n#define UNIX_SOCKET    6\ntypedef struct {\n\t__le64 EndOfFile;\n\t__le64 NumOfBytes;\n\t__le64 LastStatusChange;  \n\t__le64 LastAccessTime;\n\t__le64 LastModificationTime;\n\t__le64 Uid;\n\t__le64 Gid;\n\t__le32 Type;\n\t__le64 DevMajor;\n\t__le64 DevMinor;\n\t__le64 UniqueId;\n\t__le64 Permissions;\n\t__le64 Nlinks;\n} __attribute__((packed)) FILE_UNIX_BASIC_INFO;\t \n\ntypedef struct {\n\tDECLARE_FLEX_ARRAY(char, LinkDest);\n} __attribute__((packed)) FILE_UNIX_LINK_INFO;\t \n\n \ntypedef struct {\n\t__u16 Day:5;\n\t__u16 Month:4;\n\t__u16 Year:7;\n} __attribute__((packed)) SMB_DATE;\n\ntypedef struct {\n\t__u16 TwoSeconds:5;\n\t__u16 Minutes:6;\n\t__u16 Hours:5;\n} __attribute__((packed)) SMB_TIME;\n\ntypedef struct {\n\t__le16 CreationDate;  \n\t__le16 CreationTime;  \n\t__le16 LastAccessDate;\n\t__le16 LastAccessTime;\n\t__le16 LastWriteDate;\n\t__le16 LastWriteTime;\n\t__le32 DataSize;  \n\t__le32 AllocationSize;\n\t__le16 Attributes;  \n\t__le32 EASize;\n} __attribute__((packed)) FILE_INFO_STANDARD;   \n\ntypedef struct {\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le32 Attributes;\n\t__u32 Pad;\n} __attribute__((packed)) FILE_BASIC_INFO;\t \n\nstruct file_allocation_info {\n\t__le64 AllocationSize;  \n} __packed;  \n\nstruct file_end_of_file_info {\n\t__le64 FileSize;\t\t \n} __attribute__((packed));  \n\nstruct file_alt_name_info {\n\tDECLARE_FLEX_ARRAY(__u8, alt_name);\n} __attribute__((packed));       \n\nstruct file_stream_info {\n\t__le32 number_of_streams;   \n\t \n};       \n\nstruct file_compression_info {\n\t__le64 compressed_size;\n\t__le16 format;\n\t__u8   unit_shift;\n\t__u8   ch_shift;\n\t__u8   cl_shift;\n\t__u8   pad[3];\n} __attribute__((packed));       \n\n \n#define CIFS_ACL_VERSION 1\nstruct cifs_posix_ace {  \n\t__u8  cifs_e_tag;\n\t__u8  cifs_e_perm;\n\t__le64 cifs_uid;  \n} __attribute__((packed));\n\nstruct cifs_posix_acl {  \n\t__le16\tversion;\n\t__le16\taccess_entry_count;   \n\t__le16\tdefault_entry_count;  \n\tstruct cifs_posix_ace ace_array[];\n\t \n} __attribute__((packed));   \n\n \n \n\n \n \n\n \n\n \n#define SMB_O_RDONLY\t0x1\n#define SMB_O_WRONLY\t0x2\n#define SMB_O_RDWR\t0x4\n#define SMB_O_CREAT\t0x10\n#define SMB_O_EXCL\t0x20\n#define SMB_O_TRUNC\t0x40\n#define SMB_O_APPEND\t0x80\n#define SMB_O_SYNC\t0x100\n#define SMB_O_DIRECTORY\t0x200\n#define SMB_O_NOFOLLOW\t0x400\n#define SMB_O_DIRECT\t0x800\n\ntypedef struct {\n\t__le32 OpenFlags;  \n\t__le32 PosixOpenFlags;\n\t__le64 Permissions;\n\t__le16 Level;  \n} __attribute__((packed)) OPEN_PSX_REQ;  \n\ntypedef struct {\n\t__le16 OplockFlags;\n\t__u16 Fid;\n\t__le32 CreateAction;\n\t__le16 ReturnedLevel;\n\t__le16 Pad;\n\t \n} __attribute__((packed)) OPEN_PSX_RSP;  \n\n#define SMB_POSIX_UNLINK_FILE_TARGET\t\t0\n#define SMB_POSIX_UNLINK_DIRECTORY_TARGET\t1\n\nstruct unlink_psx_rq {  \n\t__le16 type;\n} __attribute__((packed));\n\nstruct file_internal_info {\n\t__le64  UniqueId;  \n} __attribute__((packed));       \n\nstruct file_mode_info {\n\t__le32\tMode;\n} __attribute__((packed));       \n\nstruct file_attrib_tag {\n\t__le32 Attribute;\n\t__le32 ReparseTag;\n} __attribute__((packed));       \n\n\n \n \n \n\ntypedef struct {\n\t__le32 NextEntryOffset;\n\t__u32 ResumeKey;  \n\tFILE_UNIX_BASIC_INFO basic;\n\tunion {\n\t\tchar __pad;\n\t\tDECLARE_FLEX_ARRAY(char, FileName);\n\t};\n} __attribute__((packed)) FILE_UNIX_INFO;  \n\ntypedef struct {\n\t__le32 NextEntryOffset;\n\t__u32 FileIndex;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 ExtFileAttributes;\n\t__le32 FileNameLength;\n\tchar FileName[];\n} __attribute__((packed)) FILE_DIRECTORY_INFO;    \n\ntypedef struct {\n\t__le32 NextEntryOffset;\n\t__u32 FileIndex;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 ExtFileAttributes;\n\t__le32 FileNameLength;\n\t__le32 EaSize;  \n\tchar FileName[];\n} __attribute__((packed)) FILE_FULL_DIRECTORY_INFO;  \n\ntypedef struct {\n\t__le32 NextEntryOffset;\n\t__u32 FileIndex;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 ExtFileAttributes;\n\t__le32 FileNameLength;\n\t__le32 EaSize;  \n\t__le32 Reserved;\n\t__le64 UniqueId;  \n\tchar FileName[];\n} __attribute__((packed)) SEARCH_ID_FULL_DIR_INFO;  \n\ntypedef struct {\n\t__le32 NextEntryOffset;\n\t__u32 FileIndex;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 ExtFileAttributes;\n\t__le32 FileNameLength;\n\t__le32 EaSize;  \n\t__u8   ShortNameLength;\n\t__u8   Reserved;\n\t__u8   ShortName[24];\n\tchar FileName[];\n} __attribute__((packed)) FILE_BOTH_DIRECTORY_INFO;  \n\ntypedef struct {\n\t__u32  ResumeKey;\n\t__le16 CreationDate;  \n\t__le16 CreationTime;  \n\t__le16 LastAccessDate;\n\t__le16 LastAccessTime;\n\t__le16 LastWriteDate;\n\t__le16 LastWriteTime;\n\t__le32 DataSize;  \n\t__le32 AllocationSize;\n\t__le16 Attributes;  \n\t__u8   FileNameLength;\n\tchar FileName[];\n} __attribute__((packed)) FIND_FILE_STANDARD_INFO;  \n\n\nstruct win_dev {\n\tunsigned char type[8];  \n\t__le64 major;\n\t__le64 minor;\n} __attribute__((packed));\n\nstruct fea {\n\tunsigned char EA_flags;\n\t__u8 name_len;\n\t__le16 value_len;\n\tchar name[];\n\t \n} __attribute__((packed));\n \n#define FEA_NEEDEA         0x80\t \n\nstruct fealist {\n\t__le32 list_len;\n\tstruct fea list;\n} __attribute__((packed));\n\n \nstruct data_blob {\n\t__u8 *data;\n\tsize_t length;\n\tvoid (*free) (struct data_blob *data_blob);\n} __attribute__((packed));\n\n\n#ifdef CONFIG_CIFS_POSIX\n \n\n \n\nstruct xsymlink {\n\t \n\tchar signature[4];    \n\tchar cr0;          \n \n\tchar length[4];\n\tchar cr1;          \n \n\t__u8 md5[32];\n\tchar cr2;         \n \n\tchar path[1024];\n} __attribute__((packed));\n\ntypedef struct file_xattr_info {\n\t \n\t__u32 xattr_name_len;\n\t__u32 xattr_value_len;\n\tchar  xattr_name[];\n\t \n} __packed FILE_XATTR_INFO;  \n\n \n\ntypedef struct file_chattr_info {\n\t__le64\tmask;  \n\t__le64\tmode;  \n} __packed FILE_CHATTR_INFO;   \n#endif\t\t\t\t \n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}