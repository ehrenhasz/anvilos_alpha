{
  "module_name": "smb2proto.h",
  "hash_id": "e1c996292adefa648fcf2569376000c3f304dbdc2eab57067a7abac2ee70faf2",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/smb2proto.h",
  "human_readable_source": " \n \n#ifndef _SMB2PROTO_H\n#define _SMB2PROTO_H\n#include <linux/nls.h>\n#include <linux/key-type.h>\n\nstruct statfs;\nstruct smb_rqst;\n\n \nextern int map_smb2_to_linux_error(char *buf, bool log_err);\nextern int smb2_check_message(char *buf, unsigned int length,\n\t\t\t      struct TCP_Server_Info *server);\nextern unsigned int smb2_calc_size(void *buf);\nextern char *smb2_get_data_area_len(int *off, int *len,\n\t\t\t\t    struct smb2_hdr *shdr);\nextern __le16 *cifs_convert_path_to_utf16(const char *from,\n\t\t\t\t\t  struct cifs_sb_info *cifs_sb);\n\nextern int smb2_verify_signature(struct smb_rqst *, struct TCP_Server_Info *);\nextern int smb2_check_receive(struct mid_q_entry *mid,\n\t\t\t      struct TCP_Server_Info *server, bool log_error);\nextern struct mid_q_entry *smb2_setup_request(struct cifs_ses *ses,\n\t\t\t\t\t      struct TCP_Server_Info *,\n\t\t\t\t\t      struct smb_rqst *rqst);\nextern struct mid_q_entry *smb2_setup_async_request(\n\t\t\tstruct TCP_Server_Info *server, struct smb_rqst *rqst);\nextern struct cifs_ses *smb2_find_smb_ses(struct TCP_Server_Info *server,\n\t\t\t\t\t   __u64 ses_id);\nextern struct cifs_tcon *smb2_find_smb_tcon(struct TCP_Server_Info *server,\n\t\t\t\t\t\t__u64 ses_id, __u32  tid);\nextern int smb2_calc_signature(struct smb_rqst *rqst,\n\t\t\t\tstruct TCP_Server_Info *server,\n\t\t\t\tbool allocate_crypto);\nextern int smb3_calc_signature(struct smb_rqst *rqst,\n\t\t\t\tstruct TCP_Server_Info *server,\n\t\t\t\tbool allocate_crypto);\nextern void smb2_echo_request(struct work_struct *work);\nextern __le32 smb2_get_lease_state(struct cifsInodeInfo *cinode);\nextern bool smb2_is_valid_oplock_break(char *buffer,\n\t\t\t\t       struct TCP_Server_Info *srv);\nextern int smb3_handle_read_data(struct TCP_Server_Info *server,\n\t\t\t\t struct mid_q_entry *mid);\nextern int smb2_query_reparse_tag(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t\tstruct cifs_sb_info *cifs_sb, const char *path,\n\t\t\t\t__u32 *reparse_tag);\nint smb2_query_path_info(const unsigned int xid,\n\t\t\t struct cifs_tcon *tcon,\n\t\t\t struct cifs_sb_info *cifs_sb,\n\t\t\t const char *full_path,\n\t\t\t struct cifs_open_info_data *data);\nextern int smb2_set_path_size(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t      const char *full_path, __u64 size,\n\t\t\t      struct cifs_sb_info *cifs_sb, bool set_alloc);\nextern int smb2_set_file_info(struct inode *inode, const char *full_path,\n\t\t\t      FILE_BASIC_INFO *buf, const unsigned int xid);\nextern int smb311_posix_mkdir(const unsigned int xid, struct inode *inode,\n\t\t\t       umode_t mode, struct cifs_tcon *tcon,\n\t\t\t       const char *full_path,\n\t\t\t       struct cifs_sb_info *cifs_sb);\nextern int smb2_mkdir(const unsigned int xid, struct inode *inode,\n\t\t      umode_t mode, struct cifs_tcon *tcon,\n\t\t      const char *name, struct cifs_sb_info *cifs_sb);\nextern void smb2_mkdir_setinfo(struct inode *inode, const char *full_path,\n\t\t\t       struct cifs_sb_info *cifs_sb,\n\t\t\t       struct cifs_tcon *tcon, const unsigned int xid);\nextern int smb2_rmdir(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t      const char *name, struct cifs_sb_info *cifs_sb);\nextern int smb2_unlink(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t       const char *name, struct cifs_sb_info *cifs_sb);\nextern int smb2_rename_path(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t    const char *from_name, const char *to_name,\n\t\t\t    struct cifs_sb_info *cifs_sb);\nextern int smb2_create_hardlink(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t\tconst char *from_name, const char *to_name,\n\t\t\t\tstruct cifs_sb_info *cifs_sb);\nextern int smb3_create_mf_symlink(unsigned int xid, struct cifs_tcon *tcon,\n\t\t\tstruct cifs_sb_info *cifs_sb, const unsigned char *path,\n\t\t\tchar *pbuf, unsigned int *pbytes_written);\nextern int smb3_query_mf_symlink(unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t  struct cifs_sb_info *cifs_sb,\n\t\t\t  const unsigned char *path, char *pbuf,\n\t\t\t  unsigned int *pbytes_read);\nint smb2_parse_symlink_response(struct cifs_sb_info *cifs_sb, const struct kvec *iov, char **path);\nint smb2_open_file(const unsigned int xid, struct cifs_open_parms *oparms, __u32 *oplock,\n\t\t   void *buf);\nextern int smb2_unlock_range(struct cifsFileInfo *cfile,\n\t\t\t     struct file_lock *flock, const unsigned int xid);\nextern int smb2_push_mandatory_locks(struct cifsFileInfo *cfile);\nextern void smb2_reconnect_server(struct work_struct *work);\nextern int smb3_crypto_aead_allocate(struct TCP_Server_Info *server);\nextern unsigned long smb_rqst_len(struct TCP_Server_Info *server,\n\t\t\t\t  struct smb_rqst *rqst);\nextern void smb2_set_next_command(struct cifs_tcon *tcon,\n\t\t\t\t  struct smb_rqst *rqst);\nextern void smb2_set_related(struct smb_rqst *rqst);\n\n \nextern int SMB2_negotiate(const unsigned int xid,\n\t\t\t  struct cifs_ses *ses,\n\t\t\t  struct TCP_Server_Info *server);\nextern int SMB2_sess_setup(const unsigned int xid, struct cifs_ses *ses,\n\t\t\t   struct TCP_Server_Info *server,\n\t\t\t   const struct nls_table *nls_cp);\nextern int SMB2_logoff(const unsigned int xid, struct cifs_ses *ses);\nextern int SMB2_tcon(const unsigned int xid, struct cifs_ses *ses,\n\t\t     const char *tree, struct cifs_tcon *tcon,\n\t\t     const struct nls_table *);\nextern int SMB2_tdis(const unsigned int xid, struct cifs_tcon *tcon);\nextern int SMB2_open(const unsigned int xid, struct cifs_open_parms *oparms,\n\t\t     __le16 *path, __u8 *oplock,\n\t\t     struct smb2_file_all_info *buf,\n\t\t     struct create_posix_rsp *posix,\n\t\t     struct kvec *err_iov, int *resp_buftype);\nextern int SMB2_open_init(struct cifs_tcon *tcon,\n\t\t\t  struct TCP_Server_Info *server,\n\t\t\t  struct smb_rqst *rqst,\n\t\t\t  __u8 *oplock, struct cifs_open_parms *oparms,\n\t\t\t  __le16 *path);\nextern void SMB2_open_free(struct smb_rqst *rqst);\nextern int SMB2_ioctl(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t     u64 persistent_fid, u64 volatile_fid, u32 opcode,\n\t\t     char *in_data, u32 indatalen, u32 maxoutlen,\n\t\t     char **out_data, u32 *plen  );\nextern int SMB2_ioctl_init(struct cifs_tcon *tcon,\n\t\t\t   struct TCP_Server_Info *server,\n\t\t\t   struct smb_rqst *rqst,\n\t\t\t   u64 persistent_fid, u64 volatile_fid, u32 opcode,\n\t\t\t   char *in_data, u32 indatalen,\n\t\t\t   __u32 max_response_size);\nextern void SMB2_ioctl_free(struct smb_rqst *rqst);\nextern int SMB2_change_notify(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\tu64 persistent_fid, u64 volatile_fid, bool watch_tree,\n\t\t\tu32 completion_filter, u32 max_out_data_len,\n\t\t\tchar **out_data, u32 *plen  );\n\nextern int __SMB2_close(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\tu64 persistent_fid, u64 volatile_fid,\n\t\t\tstruct smb2_file_network_open_info *pbuf);\nextern int SMB2_close(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t      u64 persistent_file_id, u64 volatile_file_id);\nextern int SMB2_close_init(struct cifs_tcon *tcon,\n\t\t\t   struct TCP_Server_Info *server,\n\t\t\t   struct smb_rqst *rqst,\n\t\t\t   u64 persistent_fid, u64 volatile_fid,\n\t\t\t   bool query_attrs);\nextern void SMB2_close_free(struct smb_rqst *rqst);\nextern int SMB2_flush(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t      u64 persistent_file_id, u64 volatile_file_id);\nextern int SMB2_flush_init(const unsigned int xid, struct smb_rqst *rqst,\n\t\t\t   struct cifs_tcon *tcon,\n\t\t\t   struct TCP_Server_Info *server,\n\t\t\t   u64 persistent_file_id, u64 volatile_file_id);\nextern void SMB2_flush_free(struct smb_rqst *rqst);\nextern int SMB311_posix_query_info(const unsigned int xid, struct cifs_tcon *tcon,\n\t\tu64 persistent_fid, u64 volatile_fid, struct smb311_posix_qinfo *data, u32 *plen);\nextern int SMB2_query_info(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t   u64 persistent_file_id, u64 volatile_file_id,\n\t\t\t   struct smb2_file_all_info *data);\nextern int SMB2_query_info_init(struct cifs_tcon *tcon,\n\t\t\t\tstruct TCP_Server_Info *server,\n\t\t\t\tstruct smb_rqst *rqst,\n\t\t\t\tu64 persistent_fid, u64 volatile_fid,\n\t\t\t\tu8 info_class, u8 info_type,\n\t\t\t\tu32 additional_info, size_t output_len,\n\t\t\t\tsize_t input_len, void *input);\nextern void SMB2_query_info_free(struct smb_rqst *rqst);\nextern int SMB2_query_acl(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t  u64 persistent_file_id, u64 volatile_file_id,\n\t\t\t  void **data, unsigned int *plen, u32 info);\nextern int SMB2_get_srv_num(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t    u64 persistent_fid, u64 volatile_fid,\n\t\t\t    __le64 *uniqueid);\nextern int smb2_async_readv(struct cifs_readdata *rdata);\nextern int SMB2_read(const unsigned int xid, struct cifs_io_parms *io_parms,\n\t\t     unsigned int *nbytes, char **buf, int *buf_type);\nextern int smb2_async_writev(struct cifs_writedata *wdata,\n\t\t\t     void (*release)(struct kref *kref));\nextern int SMB2_write(const unsigned int xid, struct cifs_io_parms *io_parms,\n\t\t      unsigned int *nbytes, struct kvec *iov, int n_vec);\nextern int SMB2_echo(struct TCP_Server_Info *server);\nextern int SMB2_query_directory(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t\tu64 persistent_fid, u64 volatile_fid, int index,\n\t\t\t\tstruct cifs_search_info *srch_inf);\nextern int SMB2_query_directory_init(unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t\t     struct TCP_Server_Info *server,\n\t\t\t\t     struct smb_rqst *rqst,\n\t\t\t\t     u64 persistent_fid, u64 volatile_fid,\n\t\t\t\t     int index, int info_level);\nextern void SMB2_query_directory_free(struct smb_rqst *rqst);\nextern int SMB2_set_eof(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\tu64 persistent_fid, u64 volatile_fid, u32 pid,\n\t\t\t__le64 *eof);\nextern int SMB2_set_info_init(struct cifs_tcon *tcon,\n\t\t\t      struct TCP_Server_Info *server,\n\t\t\t      struct smb_rqst *rqst,\n\t\t\t      u64 persistent_fid, u64 volatile_fid, u32 pid,\n\t\t\t      u8 info_class, u8 info_type, u32 additional_info,\n\t\t\t      void **data, unsigned int *size);\nextern void SMB2_set_info_free(struct smb_rqst *rqst);\nextern int SMB2_set_acl(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\tu64 persistent_fid, u64 volatile_fid,\n\t\t\tstruct cifs_ntsd *pnntsd, int pacllen, int aclflag);\nextern int SMB2_set_ea(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t       u64 persistent_fid, u64 volatile_fid,\n\t\t       struct smb2_file_full_ea_info *buf, int len);\nextern int SMB2_set_compression(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t\tu64 persistent_fid, u64 volatile_fid);\nextern int SMB2_oplock_break(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t     const u64 persistent_fid, const u64 volatile_fid,\n\t\t\t     const __u8 oplock_level);\nextern int smb2_handle_cancelled_close(struct cifs_tcon *tcon,\n\t\t\t\t       __u64 persistent_fid,\n\t\t\t\t       __u64 volatile_fid);\nextern int smb2_handle_cancelled_mid(struct mid_q_entry *mid, struct TCP_Server_Info *server);\nvoid smb2_cancelled_close_fid(struct work_struct *work);\nextern int SMB2_QFS_info(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t u64 persistent_file_id, u64 volatile_file_id,\n\t\t\t struct kstatfs *FSData);\nextern int SMB311_posix_qfs_info(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t u64 persistent_file_id, u64 volatile_file_id,\n\t\t\t struct kstatfs *FSData);\nextern int SMB2_QFS_attr(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t u64 persistent_file_id, u64 volatile_file_id, int lvl);\nextern int SMB2_lock(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t     const __u64 persist_fid, const __u64 volatile_fid,\n\t\t     const __u32 pid, const __u64 length, const __u64 offset,\n\t\t     const __u32 lockFlags, const bool wait);\nextern int smb2_lockv(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t      const __u64 persist_fid, const __u64 volatile_fid,\n\t\t      const __u32 pid, const __u32 num_lock,\n\t\t      struct smb2_lock_element *buf);\nextern int SMB2_lease_break(const unsigned int xid, struct cifs_tcon *tcon,\n\t\t\t    __u8 *lease_key, const __le32 lease_state);\nextern int smb3_validate_negotiate(const unsigned int, struct cifs_tcon *);\n\nextern enum securityEnum smb2_select_sectype(struct TCP_Server_Info *,\n\t\t\t\t\tenum securityEnum);\nint smb2_parse_contexts(struct TCP_Server_Info *server,\n\t\t\tstruct kvec *rsp_iov,\n\t\t\tunsigned int *epoch,\n\t\t\tchar *lease_key, __u8 *oplock,\n\t\t\tstruct smb2_file_all_info *buf,\n\t\t\tstruct create_posix_rsp *posix);\n\nextern int smb3_encryption_required(const struct cifs_tcon *tcon);\nextern int smb2_validate_iov(unsigned int offset, unsigned int buffer_length,\n\t\t\t     struct kvec *iov, unsigned int min_buf_size);\nextern int smb2_validate_and_copy_iov(unsigned int offset,\n\t\t\t\t      unsigned int buffer_length,\n\t\t\t\t      struct kvec *iov,\n\t\t\t\t      unsigned int minbufsize, char *data);\nextern void smb2_copy_fs_info_to_kstatfs(\n\t struct smb2_fs_full_size_info *pfs_inf,\n\t struct kstatfs *kst);\nextern int smb311_crypto_shash_allocate(struct TCP_Server_Info *server);\nextern int smb311_update_preauth_hash(struct cifs_ses *ses,\n\t\t\t\t      struct TCP_Server_Info *server,\n\t\t\t\t      struct kvec *iov, int nvec);\nextern int smb2_query_info_compound(const unsigned int xid,\n\t\t\t\t    struct cifs_tcon *tcon,\n\t\t\t\t    const char *path, u32 desired_access,\n\t\t\t\t    u32 class, u32 type, u32 output_len,\n\t\t\t\t    struct kvec *rsp, int *buftype,\n\t\t\t\t    struct cifs_sb_info *cifs_sb);\n \nint smb311_posix_query_path_info(const unsigned int xid,\n\t\t\t\t struct cifs_tcon *tcon,\n\t\t\t\t struct cifs_sb_info *cifs_sb,\n\t\t\t\t const char *full_path,\n\t\t\t\t struct cifs_open_info_data *data,\n\t\t\t\t struct cifs_sid *owner,\n\t\t\t\t struct cifs_sid *group);\nint posix_info_parse(const void *beg, const void *end,\n\t\t     struct smb2_posix_info_parsed *out);\nint posix_info_sid_size(const void *beg, const void *end);\n#endif\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}