{
  "module_name": "netlink.c",
  "hash_id": "41ce26e62fb5d664f4886b76a3cdc07458b71ebd2577ba70a111f005d51d94a8",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/netlink.c",
  "human_readable_source": "\n \n\n#include <net/genetlink.h>\n#include <uapi/linux/cifs/cifs_netlink.h>\n\n#include \"netlink.h\"\n#include \"cifsglob.h\"\n#include \"cifs_debug.h\"\n#include \"cifs_swn.h\"\n\nstatic const struct nla_policy cifs_genl_policy[CIFS_GENL_ATTR_MAX + 1] = {\n\t[CIFS_GENL_ATTR_SWN_REGISTRATION_ID]\t= { .type = NLA_U32 },\n\t[CIFS_GENL_ATTR_SWN_NET_NAME]\t\t= { .type = NLA_STRING },\n\t[CIFS_GENL_ATTR_SWN_SHARE_NAME]\t\t= { .type = NLA_STRING },\n\t[CIFS_GENL_ATTR_SWN_IP]\t\t\t= { .len = sizeof(struct sockaddr_storage) },\n\t[CIFS_GENL_ATTR_SWN_NET_NAME_NOTIFY]\t= { .type = NLA_FLAG },\n\t[CIFS_GENL_ATTR_SWN_SHARE_NAME_NOTIFY]\t= { .type = NLA_FLAG },\n\t[CIFS_GENL_ATTR_SWN_IP_NOTIFY]\t\t= { .type = NLA_FLAG },\n\t[CIFS_GENL_ATTR_SWN_KRB_AUTH]\t\t= { .type = NLA_FLAG },\n\t[CIFS_GENL_ATTR_SWN_USER_NAME]\t\t= { .type = NLA_STRING },\n\t[CIFS_GENL_ATTR_SWN_PASSWORD]\t\t= { .type = NLA_STRING },\n\t[CIFS_GENL_ATTR_SWN_DOMAIN_NAME]\t= { .type = NLA_STRING },\n\t[CIFS_GENL_ATTR_SWN_NOTIFICATION_TYPE]\t= { .type = NLA_U32 },\n\t[CIFS_GENL_ATTR_SWN_RESOURCE_STATE]\t= { .type = NLA_U32 },\n\t[CIFS_GENL_ATTR_SWN_RESOURCE_NAME]\t= { .type = NLA_STRING},\n};\n\nstatic const struct genl_ops cifs_genl_ops[] = {\n\t{\n\t\t.cmd = CIFS_GENL_CMD_SWN_NOTIFY,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = cifs_swn_notify,\n\t},\n};\n\nstatic const struct genl_multicast_group cifs_genl_mcgrps[] = {\n\t[CIFS_GENL_MCGRP_SWN] = { .name = CIFS_GENL_MCGRP_SWN_NAME },\n};\n\nstruct genl_family cifs_genl_family = {\n\t.name\t\t= CIFS_GENL_NAME,\n\t.version\t= CIFS_GENL_VERSION,\n\t.hdrsize\t= 0,\n\t.maxattr\t= CIFS_GENL_ATTR_MAX,\n\t.module\t\t= THIS_MODULE,\n\t.policy\t\t= cifs_genl_policy,\n\t.ops\t\t= cifs_genl_ops,\n\t.n_ops\t\t= ARRAY_SIZE(cifs_genl_ops),\n\t.resv_start_op\t= CIFS_GENL_CMD_SWN_NOTIFY + 1,\n\t.mcgrps\t\t= cifs_genl_mcgrps,\n\t.n_mcgrps\t= ARRAY_SIZE(cifs_genl_mcgrps),\n};\n\n \nint cifs_genl_init(void)\n{\n\tint ret;\n\n\tret = genl_register_family(&cifs_genl_family);\n\tif (ret < 0) {\n\t\tcifs_dbg(VFS, \"%s: failed to register netlink family\\n\",\n\t\t\t\t__func__);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\n \nvoid cifs_genl_exit(void)\n{\n\tint ret;\n\n\tret = genl_unregister_family(&cifs_genl_family);\n\tif (ret < 0) {\n\t\tcifs_dbg(VFS, \"%s: failed to unregister netlink family\\n\",\n\t\t\t\t__func__);\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}