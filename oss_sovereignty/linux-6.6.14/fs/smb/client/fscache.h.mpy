{
  "module_name": "fscache.h",
  "hash_id": "f03acdd618fdba86707b94914bae724108c9c53b4632c4cce1e1022e6d7b24f1",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/fscache.h",
  "human_readable_source": " \n \n#ifndef _CIFS_FSCACHE_H\n#define _CIFS_FSCACHE_H\n\n#include <linux/swap.h>\n#include <linux/fscache.h>\n\n#include \"cifsglob.h\"\n\n \nstruct cifs_fscache_volume_coherency_data {\n\t__le64\tresource_id;\t\t \n\t__le64\tvol_create_time;\n\t__le32\tvol_serial_number;\n} __packed;\n\n \nstruct cifs_fscache_inode_coherency_data {\n\t__le64 last_write_time_sec;\n\t__le64 last_change_time_sec;\n\t__le32 last_write_time_nsec;\n\t__le32 last_change_time_nsec;\n};\n\n#ifdef CONFIG_CIFS_FSCACHE\n\n \nextern int cifs_fscache_get_super_cookie(struct cifs_tcon *);\nextern void cifs_fscache_release_super_cookie(struct cifs_tcon *);\n\nextern void cifs_fscache_get_inode_cookie(struct inode *inode);\nextern void cifs_fscache_release_inode_cookie(struct inode *);\nextern void cifs_fscache_unuse_inode_cookie(struct inode *inode, bool update);\n\nstatic inline\nvoid cifs_fscache_fill_coherency(struct inode *inode,\n\t\t\t\t struct cifs_fscache_inode_coherency_data *cd)\n{\n\tstruct timespec64 ctime = inode_get_ctime(inode);\n\tstruct timespec64 mtime = inode_get_mtime(inode);\n\n\tmemset(cd, 0, sizeof(*cd));\n\tcd->last_write_time_sec   = cpu_to_le64(mtime.tv_sec);\n\tcd->last_write_time_nsec  = cpu_to_le32(mtime.tv_nsec);\n\tcd->last_change_time_sec  = cpu_to_le64(ctime.tv_sec);\n\tcd->last_change_time_nsec = cpu_to_le32(ctime.tv_nsec);\n}\n\n\nstatic inline struct fscache_cookie *cifs_inode_cookie(struct inode *inode)\n{\n\treturn netfs_i_cookie(&CIFS_I(inode)->netfs);\n}\n\nstatic inline void cifs_invalidate_cache(struct inode *inode, unsigned int flags)\n{\n\tstruct cifs_fscache_inode_coherency_data cd;\n\n\tcifs_fscache_fill_coherency(inode, &cd);\n\tfscache_invalidate(cifs_inode_cookie(inode), &cd,\n\t\t\t   i_size_read(inode), flags);\n}\n\nextern int __cifs_fscache_query_occupancy(struct inode *inode,\n\t\t\t\t\t  pgoff_t first, unsigned int nr_pages,\n\t\t\t\t\t  pgoff_t *_data_first,\n\t\t\t\t\t  unsigned int *_data_nr_pages);\n\nstatic inline int cifs_fscache_query_occupancy(struct inode *inode,\n\t\t\t\t\t       pgoff_t first, unsigned int nr_pages,\n\t\t\t\t\t       pgoff_t *_data_first,\n\t\t\t\t\t       unsigned int *_data_nr_pages)\n{\n\tif (!cifs_inode_cookie(inode))\n\t\treturn -ENOBUFS;\n\treturn __cifs_fscache_query_occupancy(inode, first, nr_pages,\n\t\t\t\t\t      _data_first, _data_nr_pages);\n}\n\nextern int __cifs_readpage_from_fscache(struct inode *pinode, struct page *ppage);\nextern void __cifs_readahead_to_fscache(struct inode *pinode, loff_t pos, size_t len);\n\n\nstatic inline int cifs_readpage_from_fscache(struct inode *inode,\n\t\t\t\t\t     struct page *page)\n{\n\tif (cifs_inode_cookie(inode))\n\t\treturn __cifs_readpage_from_fscache(inode, page);\n\treturn -ENOBUFS;\n}\n\nstatic inline void cifs_readahead_to_fscache(struct inode *inode,\n\t\t\t\t\t     loff_t pos, size_t len)\n{\n\tif (cifs_inode_cookie(inode))\n\t\t__cifs_readahead_to_fscache(inode, pos, len);\n}\n\n#else  \nstatic inline\nvoid cifs_fscache_fill_coherency(struct inode *inode,\n\t\t\t\t struct cifs_fscache_inode_coherency_data *cd)\n{\n}\n\nstatic inline int cifs_fscache_get_super_cookie(struct cifs_tcon *tcon) { return 0; }\nstatic inline void cifs_fscache_release_super_cookie(struct cifs_tcon *tcon) {}\n\nstatic inline void cifs_fscache_get_inode_cookie(struct inode *inode) {}\nstatic inline void cifs_fscache_release_inode_cookie(struct inode *inode) {}\nstatic inline void cifs_fscache_unuse_inode_cookie(struct inode *inode, bool update) {}\nstatic inline struct fscache_cookie *cifs_inode_cookie(struct inode *inode) { return NULL; }\nstatic inline void cifs_invalidate_cache(struct inode *inode, unsigned int flags) {}\n\nstatic inline int cifs_fscache_query_occupancy(struct inode *inode,\n\t\t\t\t\t       pgoff_t first, unsigned int nr_pages,\n\t\t\t\t\t       pgoff_t *_data_first,\n\t\t\t\t\t       unsigned int *_data_nr_pages)\n{\n\t*_data_first = ULONG_MAX;\n\t*_data_nr_pages = 0;\n\treturn -ENOBUFS;\n}\n\nstatic inline int\ncifs_readpage_from_fscache(struct inode *inode, struct page *page)\n{\n\treturn -ENOBUFS;\n}\n\nstatic inline\nvoid cifs_readahead_to_fscache(struct inode *inode, loff_t pos, size_t len) {}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}