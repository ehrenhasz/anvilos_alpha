{
  "module_name": "cifs_ioctl.h",
  "hash_id": "752ce76e12a1efc6ddcc23b66a759f67501bf05f3c1c7228c70852101de75322",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/cifs_ioctl.h",
  "human_readable_source": " \n \n\nstruct smb_mnt_fs_info {\n\t__u32\tversion;  \n\t__u16\tprotocol_id;\n\t__u16\ttcon_flags;\n\t__u32\tvol_serial_number;\n\t__u32\tvol_create_time;\n\t__u32\tshare_caps;\n\t__u32\tshare_flags;\n\t__u32\tsector_flags;\n\t__u32\toptimal_sector_size;\n\t__u32\tmax_bytes_chunk;\n\t__u32\tfs_attributes;\n\t__u32\tmax_path_component;\n\t__u32\tdevice_type;\n\t__u32\tdevice_characteristics;\n\t__u32\tmaximal_access;\n\t__u64   cifs_posix_caps;\n} __packed;\n\nstruct smb_mnt_tcon_info {\n\t__u32\ttid;\n\t__u64\tsession_id;\n} __packed;\n\nstruct smb_snapshot_array {\n\t__u32\tnumber_of_snapshots;\n\t__u32\tnumber_of_snapshots_returned;\n\t__u32\tsnapshot_array_size;\n\t \n} __packed;\n\n \n#define PASSTHRU_QUERY_INFO\t0x00000000\n#define PASSTHRU_FSCTL\t\t0x00000001\n#define PASSTHRU_SET_INFO\t0x00000002\nstruct smb_query_info {\n\t__u32   info_type;\n\t__u32   file_info_class;\n\t__u32   additional_information;\n\t__u32   flags;\n\t__u32\tinput_buffer_length;\n\t__u32\toutput_buffer_length;\n\t \n} __packed;\n\n \nstruct smb3_key_debug_info {\n\t__u64\tSuid;\n\t__u16\tcipher_type;\n\t__u8\tauth_key[16];  \n\t__u8\tsmb3encryptionkey[SMB3_SIGN_KEY_SIZE];\n\t__u8\tsmb3decryptionkey[SMB3_SIGN_KEY_SIZE];\n} __packed;\n\n \nstruct smb3_full_key_debug_info {\n\t \n\t__u32   in_size;\n\n\t \n\t__u64\tsession_id;\n\t__u16\tcipher_type;\n\t__u8    session_key_length;\n\t__u8    server_in_key_length;\n\t__u8    server_out_key_length;\n\t__u8    data[];\n\t \n} __packed;\n\nstruct smb3_notify {\n\t__u32\tcompletion_filter;\n\tbool\twatch_tree;\n} __packed;\n\nstruct smb3_notify_info {\n\t__u32\tcompletion_filter;\n\tbool\twatch_tree;\n\t__u32   data_len;  \n\t__u8\tnotify_data[];\n} __packed;\n\n#define CIFS_IOCTL_MAGIC\t0xCF\n#define CIFS_IOC_COPYCHUNK_FILE\t_IOW(CIFS_IOCTL_MAGIC, 3, int)\n#define CIFS_IOC_SET_INTEGRITY  _IO(CIFS_IOCTL_MAGIC, 4)\n#define CIFS_IOC_GET_MNT_INFO _IOR(CIFS_IOCTL_MAGIC, 5, struct smb_mnt_fs_info)\n#define CIFS_ENUMERATE_SNAPSHOTS _IOR(CIFS_IOCTL_MAGIC, 6, struct smb_snapshot_array)\n#define CIFS_QUERY_INFO _IOWR(CIFS_IOCTL_MAGIC, 7, struct smb_query_info)\n#define CIFS_DUMP_KEY _IOWR(CIFS_IOCTL_MAGIC, 8, struct smb3_key_debug_info)\n#define CIFS_IOC_NOTIFY _IOW(CIFS_IOCTL_MAGIC, 9, struct smb3_notify)\n#define CIFS_DUMP_FULL_KEY _IOWR(CIFS_IOCTL_MAGIC, 10, struct smb3_full_key_debug_info)\n#define CIFS_IOC_NOTIFY_INFO _IOWR(CIFS_IOCTL_MAGIC, 11, struct smb3_notify_info)\n#define CIFS_IOC_GET_TCON_INFO _IOR(CIFS_IOCTL_MAGIC, 12, struct smb_mnt_tcon_info)\n#define CIFS_IOC_SHUTDOWN _IOR('X', 125, __u32)\n\n \n#define CIFS_GOING_FLAGS_DEFAULT                0x0      \n#define CIFS_GOING_FLAGS_LOGFLUSH               0x1      \n#define CIFS_GOING_FLAGS_NOLOGFLUSH             0x2      \n\nstatic inline bool cifs_forced_shutdown(struct cifs_sb_info *sbi)\n{\n\tif (CIFS_MOUNT_SHUTDOWN & sbi->mnt_cifs_flags)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}