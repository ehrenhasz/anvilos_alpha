{
  "module_name": "asn1.c",
  "hash_id": "7deb1a8880b2cf728ade2a6301d71f65ab8a5a5afed037e14dadf79445ca51da",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/asn1.c",
  "human_readable_source": "\n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/oid_registry.h>\n#include \"cifsglob.h\"\n#include \"cifs_debug.h\"\n#include \"cifsproto.h\"\n#include \"cifs_spnego_negtokeninit.asn1.h\"\n\nint\ndecode_negTokenInit(unsigned char *security_blob, int length,\n\t\t    struct TCP_Server_Info *server)\n{\n\tif (asn1_ber_decoder(&cifs_spnego_negtokeninit_decoder, server,\n\t\t\t     security_blob, length) == 0)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nint cifs_gssapi_this_mech(void *context, size_t hdrlen,\n\t\t\t  unsigned char tag, const void *value, size_t vlen)\n{\n\tenum OID oid;\n\n\toid = look_up_OID(value, vlen);\n\tif (oid != OID_spnego) {\n\t\tchar buf[50];\n\n\t\tsprint_oid(value, vlen, buf, sizeof(buf));\n\t\tcifs_dbg(FYI, \"Error decoding negTokenInit header: unexpected OID %s\\n\",\n\t\t\t buf);\n\t\treturn -EBADMSG;\n\t}\n\treturn 0;\n}\n\nint cifs_neg_token_init_mech_type(void *context, size_t hdrlen,\n\t\t\t\t  unsigned char tag,\n\t\t\t\t  const void *value, size_t vlen)\n{\n\tstruct TCP_Server_Info *server = context;\n\tenum OID oid;\n\n\toid = look_up_OID(value, vlen);\n\tif (oid == OID_mskrb5)\n\t\tserver->sec_mskerberos = true;\n\telse if (oid == OID_krb5u2u)\n\t\tserver->sec_kerberosu2u = true;\n\telse if (oid == OID_krb5)\n\t\tserver->sec_kerberos = true;\n\telse if (oid == OID_ntlmssp)\n\t\tserver->sec_ntlmssp = true;\n\telse {\n\t\tchar buf[50];\n\n\t\tsprint_oid(value, vlen, buf, sizeof(buf));\n\t\tcifs_dbg(FYI, \"Decoding negTokenInit: unsupported OID %s\\n\",\n\t\t\t buf);\n\t}\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}