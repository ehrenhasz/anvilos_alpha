{
  "module_name": "fs_context.h",
  "hash_id": "f96b6d685635a072081bd396d6d5f090ca9ffa086595fafe66b297491668b28f",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/fs_context.h",
  "human_readable_source": " \n \n\n#ifndef _FS_CONTEXT_H\n#define _FS_CONTEXT_H\n\n#include \"cifsglob.h\"\n#include <linux/parser.h>\n#include <linux/fs_parser.h>\n\n \n#define cifs_errorf(fc, fmt, ...)\t\t\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\terrorf(fc, fmt, ## __VA_ARGS__);\t\\\n\t\tcifs_dbg(VFS, fmt, ## __VA_ARGS__);\t\\\n\t} while (0)\n\nenum smb_version {\n\tSmb_1 = 1,\n\tSmb_20,\n\tSmb_21,\n\tSmb_30,\n\tSmb_302,\n\tSmb_311,\n\tSmb_3any,\n\tSmb_default,\n\tSmb_version_err\n};\n\nenum {\n\tOpt_cache_loose,\n\tOpt_cache_strict,\n\tOpt_cache_none,\n\tOpt_cache_ro,\n\tOpt_cache_rw,\n\tOpt_cache_err\n};\n\nenum cifs_sec_param {\n\tOpt_sec_krb5,\n\tOpt_sec_krb5i,\n\tOpt_sec_krb5p,\n\tOpt_sec_ntlmsspi,\n\tOpt_sec_ntlmssp,\n\tOpt_sec_ntlmv2,\n\tOpt_sec_ntlmv2i,\n\tOpt_sec_none,\n\n\tOpt_sec_err\n};\n\nenum cifs_param {\n\t \n\tOpt_user_xattr,\n\tOpt_forceuid,\n\tOpt_forcegid,\n\tOpt_noblocksend,\n\tOpt_noautotune,\n\tOpt_nolease,\n\tOpt_nosparse,\n\tOpt_hard,\n\tOpt_soft,\n\tOpt_perm,\n\tOpt_nodelete,\n\tOpt_mapposix,\n\tOpt_mapchars,\n\tOpt_nomapchars,\n\tOpt_sfu,\n\tOpt_nodfs,\n\tOpt_posixpaths,\n\tOpt_unix,\n\tOpt_nocase,\n\tOpt_brl,\n\tOpt_handlecache,\n\tOpt_forcemandatorylock,\n\tOpt_setuidfromacl,\n\tOpt_setuids,\n\tOpt_dynperm,\n\tOpt_intr,\n\tOpt_strictsync,\n\tOpt_serverino,\n\tOpt_rwpidforward,\n\tOpt_cifsacl,\n\tOpt_acl,\n\tOpt_locallease,\n\tOpt_sign,\n\tOpt_ignore_signature,\n\tOpt_seal,\n\tOpt_noac,\n\tOpt_fsc,\n\tOpt_mfsymlinks,\n\tOpt_multiuser,\n\tOpt_sloppy,\n\tOpt_nosharesock,\n\tOpt_persistent,\n\tOpt_resilient,\n\tOpt_tcp_nodelay,\n\tOpt_domainauto,\n\tOpt_rdma,\n\tOpt_modesid,\n\tOpt_rootfs,\n\tOpt_multichannel,\n\tOpt_compress,\n\tOpt_witness,\n\n\t \n\tOpt_backupuid,\n\tOpt_backupgid,\n\tOpt_uid,\n\tOpt_cruid,\n\tOpt_gid,\n\tOpt_port,\n\tOpt_file_mode,\n\tOpt_dirmode,\n\tOpt_min_enc_offload,\n\tOpt_blocksize,\n\tOpt_rasize,\n\tOpt_rsize,\n\tOpt_wsize,\n\tOpt_actimeo,\n\tOpt_acdirmax,\n\tOpt_acregmax,\n\tOpt_closetimeo,\n\tOpt_echo_interval,\n\tOpt_max_credits,\n\tOpt_max_cached_dirs,\n\tOpt_snapshot,\n\tOpt_max_channels,\n\tOpt_handletimeout,\n\n\t \n\tOpt_source,\n\tOpt_user,\n\tOpt_pass,\n\tOpt_ip,\n\tOpt_domain,\n\tOpt_srcaddr,\n\tOpt_iocharset,\n\tOpt_netbiosname,\n\tOpt_servern,\n\tOpt_ver,\n\tOpt_vers,\n\tOpt_sec,\n\tOpt_cache,\n\n\t \n\tOpt_ignore,\n\n\tOpt_err\n};\n\nstruct smb3_fs_context {\n\tbool uid_specified;\n\tbool cruid_specified;\n\tbool gid_specified;\n\tbool sloppy;\n\tbool got_ip;\n\tbool got_version;\n\tbool got_rsize;\n\tbool got_wsize;\n\tbool got_bsize;\n\tunsigned short port;\n\n\tchar *username;\n\tchar *password;\n\tchar *domainname;\n\tchar *source;\n\tchar *server_hostname;\n\tchar *UNC;\n\tchar *nodename;\n\tchar workstation_name[CIFS_MAX_WORKSTATION_LEN];\n\tchar *iocharset;   \n\tchar source_rfc1001_name[RFC1001_NAME_LEN_WITH_NULL];  \n\tchar target_rfc1001_name[RFC1001_NAME_LEN_WITH_NULL];  \n\tkuid_t cred_uid;\n\tkuid_t linux_uid;\n\tkgid_t linux_gid;\n\tkuid_t backupuid;\n\tkgid_t backupgid;\n\tumode_t file_mode;\n\tumode_t dir_mode;\n\tenum securityEnum sectype;  \n\tbool sign;  \n\tbool ignore_signature:1;\n\tbool retry:1;\n\tbool intr:1;\n\tbool setuids:1;\n\tbool setuidfromacl:1;\n\tbool override_uid:1;\n\tbool override_gid:1;\n\tbool dynperm:1;\n\tbool noperm:1;\n\tbool nodelete:1;\n\tbool mode_ace:1;\n\tbool no_psx_acl:1;  \n\tbool cifs_acl:1;\n\tbool backupuid_specified;  \n\tbool backupgid_specified;  \n\tbool no_xattr:1;    \n\tbool server_ino:1;  \n\tbool direct_io:1;\n\tbool strict_io:1;  \n\tbool cache_ro:1;\n\tbool cache_rw:1;\n\tbool remap:1;       \n\tbool sfu_remap:1;   \n\tbool posix_paths:1;  \n\tbool no_linux_ext:1;\n\tbool linux_ext:1;\n\tbool sfu_emul:1;\n\tbool nullauth:1;    \n\tbool nocase:1;      \n\tbool nobrl:1;       \n\tbool nohandlecache:1;  \n\tbool mand_lock:1;   \n\tbool seal:1;        \n\tbool nodfs:1;       \n\tbool local_lease:1;  \n\tbool noblocksnd:1;\n\tbool noautotune:1;\n\tbool nostrictsync:1;  \n\tbool no_lease:1;      \n\tbool no_sparse:1;     \n\tbool fsc:1;\t \n\tbool mfsymlinks:1;  \n\tbool multiuser:1;\n\tbool rwpidforward:1;  \n\tbool nosharesock:1;\n\tbool persistent:1;\n\tbool nopersistent:1;\n\tbool resilient:1;  \n\tbool domainauto:1;\n\tbool rdma:1;\n\tbool multichannel:1;\n\tbool use_client_guid:1;\n\t \n\tu8 client_guid[SMB2_CLIENT_GUID_SIZE];\n\tunsigned int bsize;\n\tunsigned int rasize;\n\tunsigned int rsize;\n\tunsigned int wsize;\n\tunsigned int min_offload;\n\tbool sockopt_tcp_nodelay:1;\n\t \n\tunsigned long acregmax;\n\tunsigned long acdirmax;\n\t \n\tunsigned long closetimeo;\n\tstruct smb_version_operations *ops;\n\tstruct smb_version_values *vals;\n\tchar *prepath;\n\tstruct sockaddr_storage dstaddr;  \n\tstruct sockaddr_storage srcaddr;  \n\tstruct nls_table *local_nls;  \n\tunsigned int echo_interval;  \n\t__u64 snapshot_time;  \n\t__u32 handle_timeout;  \n\tunsigned int max_credits;  \n\tunsigned int max_channels;\n\tunsigned int max_cached_dirs;\n\t__u16 compression;  \n\tbool rootfs:1;  \n\tbool witness:1;  \n\tchar *leaf_fullpath;\n\tstruct cifs_ses *dfs_root_ses;\n\tbool dfs_automount:1;  \n};\n\nextern const struct fs_parameter_spec smb3_fs_parameters[];\n\nextern int smb3_init_fs_context(struct fs_context *fc);\nextern void smb3_cleanup_fs_context_contents(struct smb3_fs_context *ctx);\nextern void smb3_cleanup_fs_context(struct smb3_fs_context *ctx);\n\nstatic inline struct smb3_fs_context *smb3_fc2context(const struct fs_context *fc)\n{\n\treturn fc->fs_private;\n}\n\nextern int smb3_fs_context_dup(struct smb3_fs_context *new_ctx, struct smb3_fs_context *ctx);\nextern void smb3_update_mnt_flags(struct cifs_sb_info *cifs_sb);\n\n \n#define SMB3_MAX_DCLOSETIMEO (1 << 30)\n#define SMB3_DEF_DCLOSETIMEO (1 * HZ)  \n#define MAX_CACHED_FIDS 16\nextern char *cifs_sanitize_prepath(char *prepath, gfp_t gfp);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}