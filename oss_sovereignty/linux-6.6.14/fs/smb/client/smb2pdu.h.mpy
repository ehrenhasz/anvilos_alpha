{
  "module_name": "smb2pdu.h",
  "hash_id": "685fd87c9f5e3bed699f8b744d5c94ad40ee49424eebe2e4be7357035a9633f2",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/smb2pdu.h",
  "human_readable_source": " \n \n\n#ifndef _SMB2PDU_H\n#define _SMB2PDU_H\n\n#include <net/sock.h>\n#include \"cifsacl.h\"\n\n \n#define SMB2_TRANSFORM_HEADER_SIZE 52\n#define MAX_SMB2_HDR_SIZE 204\n\n \n#define SMB2_READWRITE_PDU_HEADER_SIZE (48 + sizeof(struct smb2_hdr))\n\n \nstruct smb2_rdma_transform {\n\t__le16 RdmaDescriptorOffset;\n\t__le16 RdmaDescriptorLength;\n\t__le32 Channel;  \n\t__le16 TransformCount;\n\t__le16 Reserved1;\n\t__le32 Reserved2;\n} __packed;\n\n \n#define SMB2_RDMA_TRANSFORM_TYPE_ENCRYPTION\t0x0001\n#define SMB2_RDMA_TRANSFORM_TYPE_SIGNING\t0x0002\n\nstruct smb2_rdma_crypto_transform {\n\t__le16\tTransformType;\n\t__le16\tSignatureLength;\n\t__le16\tNonceLength;\n\t__u16\tReserved;\n\t__u8\tSignature[];  \n\t \n\t \n} __packed;\n\n \n\n#define COMPOUND_FID 0xFFFFFFFFFFFFFFFFULL\n\n#define SMB2_SYMLINK_STRUCT_SIZE \\\n\t(sizeof(struct smb2_err_rsp) + sizeof(struct smb2_symlink_err_rsp))\n\n#define SYMLINK_ERROR_TAG 0x4c4d5953\n\nstruct smb2_symlink_err_rsp {\n\t__le32 SymLinkLength;\n\t__le32 SymLinkErrorTag;\n\t__le32 ReparseTag;\n\t__le16 ReparseDataLength;\n\t__le16 UnparsedPathLength;\n\t__le16 SubstituteNameOffset;\n\t__le16 SubstituteNameLength;\n\t__le16 PrintNameOffset;\n\t__le16 PrintNameLength;\n\t__le32 Flags;\n\t__u8  PathBuffer[];\n} __packed;\n\n \nstruct smb2_error_context_rsp {\n\t__le32 ErrorDataLength;\n\t__le32 ErrorId;\n\t__u8  ErrorContextData;  \n} __packed;\n\n \n#define SMB2_ERROR_ID_DEFAULT\t\t0x00000000\n#define SMB2_ERROR_ID_SHARE_REDIRECT\tcpu_to_le32(0x72645253)\t \n\n \n#define MOVE_DST_IPADDR_V4\tcpu_to_le32(0x00000001)\n#define MOVE_DST_IPADDR_V6\tcpu_to_le32(0x00000002)\n\nstruct move_dst_ipaddr {\n\t__le32 Type;\n\t__u32  Reserved;\n\t__u8   address[16];  \n} __packed;\n\nstruct share_redirect_error_context_rsp {\n\t__le32 StructureSize;\n\t__le32 NotificationType;\n\t__le32 ResourceNameOffset;\n\t__le32 ResourceNameLength;\n\t__le16 Reserved;\n\t__le16 TargetType;\n\t__le32 IPAddrCount;\n\tstruct move_dst_ipaddr IpAddrMoveList[];\n\t   \n} __packed;\n\n \n#define SMB2_CREATE_IOV_SIZE 8\n\n \n#define MAX_SMB2_CREATE_RESPONSE_SIZE 880\n\n#define SMB2_LEASE_READ_CACHING_HE\t0x01\n#define SMB2_LEASE_HANDLE_CACHING_HE\t0x02\n#define SMB2_LEASE_WRITE_CACHING_HE\t0x04\n\n\n \n \n#define SMB2_DHANDLE_FLAG_PERSISTENT\t0x00000002\nstruct durable_context_v2 {\n\t__le32 Timeout;\n\t__le32 Flags;\n\t__u64 Reserved;\n\t__u8 CreateGuid[16];\n} __packed;\n\nstruct create_durable_v2 {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct durable_context_v2 dcontext;\n} __packed;\n\n \nstruct durable_reconnect_context_v2 {\n\tstruct {\n\t\t__u64 PersistentFileId;\n\t\t__u64 VolatileFileId;\n\t} Fid;\n\t__u8 CreateGuid[16];\n\t__le32 Flags;  \n} __packed;\n\n \nstruct durable_reconnect_context_v2_rsp {\n\t__le32 Timeout;\n\t__le32 Flags;  \n} __packed;\n\nstruct create_durable_handle_reconnect_v2 {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct durable_reconnect_context_v2 dcontext;\n\t__u8   Pad[4];\n} __packed;\n\n \nstruct crt_twarp_ctxt {\n\tstruct create_context ccontext;\n\t__u8\tName[8];\n\t__le64\tTimestamp;\n\n} __packed;\n\n \nstruct crt_query_id_ctxt {\n\tstruct create_context ccontext;\n\t__u8\tName[8];\n} __packed;\n\nstruct crt_sd_ctxt {\n\tstruct create_context ccontext;\n\t__u8\tName[8];\n\tstruct smb3_sd sd;\n} __packed;\n\n\n#define COPY_CHUNK_RES_KEY_SIZE\t24\nstruct resume_key_req {\n\tchar ResumeKey[COPY_CHUNK_RES_KEY_SIZE];\n\t__le32\tContextLength;\t \n\tchar\tContext[];\t \n} __packed;\n\n \nstruct copychunk_ioctl {\n\tchar SourceKey[COPY_CHUNK_RES_KEY_SIZE];\n\t__le32 ChunkCount;  \n\t__le32 Reserved;\n\t \n\t__le64 SourceOffset;\n\t__le64 TargetOffset;\n\t__le32 Length;  \n\t__u32 Reserved2;\n} __packed;\n\nstruct copychunk_ioctl_rsp {\n\t__le32 ChunksWritten;\n\t__le32 ChunkBytesWritten;\n\t__le32 TotalBytesWritten;\n} __packed;\n\n \nstruct get_retrieval_pointer_count_req {\n\t__le64 StartingVcn;  \n} __packed;\n\nstruct get_retrieval_pointer_count_rsp {\n\t__le32 ExtentCount;\n} __packed;\n\n \nstruct smb3_extents {\n\t__le64 NextVcn;\n\t__le64 Lcn;  \n} __packed;\n\nstruct get_retrieval_pointers_refcount_rsp {\n\t__le32 ExtentCount;\n\t__u32  Reserved;\n\t__le64 StartingVcn;\n\tstruct smb3_extents extents[];\n} __packed;\n\n \nstruct fsctl_get_dfs_referral_req {\n\t__le16 MaxReferralLevel;\n\t__u8 RequestFileName[];\n} __packed;\n\n \n\n \nstruct network_resiliency_req {\n\t__le32 Timeout;\n\t__le32 Reserved;\n} __packed;\n \n\n#define RSS_CAPABLE\tcpu_to_le32(0x00000001)\n#define RDMA_CAPABLE\tcpu_to_le32(0x00000002)\n\n#define INTERNETWORK\tcpu_to_le16(0x0002)\n#define INTERNETWORKV6\tcpu_to_le16(0x0017)\n\nstruct network_interface_info_ioctl_rsp {\n\t__le32 Next;  \n\t__le32 IfIndex;\n\t__le32 Capability;  \n\t__le32 Reserved;\n\t__le64 LinkSpeed;\n\t__le16 Family;\n\t__u8 Buffer[126];\n} __packed;\n\nstruct iface_info_ipv4 {\n\t__be16 Port;\n\t__be32 IPv4Address;\n\t__be64 Reserved;\n} __packed;\n\nstruct iface_info_ipv6 {\n\t__be16 Port;\n\t__be32 FlowInfo;\n\t__u8   IPv6Address[16];\n\t__be32 ScopeId;\n} __packed;\n\n#define NO_FILE_ID 0xFFFFFFFFFFFFFFFFULL  \n\nstruct compress_ioctl {\n\t__le16 CompressionState;  \n} __packed;\n\n \n#define SMB2_IOCTL_IOV_SIZE 2\n\n \n\nstruct smb2_file_full_ea_info {  \n\t__le32 next_entry_offset;\n\t__u8   flags;\n\t__u8   ea_name_length;\n\t__le16 ea_value_length;\n\tchar   ea_data[];  \n} __packed;  \n\nstruct smb2_file_reparse_point_info {\n\t__le64 IndexNumber;\n\t__le32 Tag;\n} __packed;\n\nstruct smb2_file_network_open_info {\n\tstruct_group(network_open_info,\n\t\t__le64 CreationTime;\n\t\t__le64 LastAccessTime;\n\t\t__le64 LastWriteTime;\n\t\t__le64 ChangeTime;\n\t\t__le64 AllocationSize;\n\t\t__le64 EndOfFile;\n\t\t__le32 Attributes;\n\t);\n\t__le32 Reserved;\n} __packed;  \n\n \nstruct smb2_file_id_information {\n\t__le64\tVolumeSerialNumber;\n\t__u64  PersistentFileId;  \n\t__u64  VolatileFileId;  \n} __packed;  \n\n \nstruct smb2_file_id_extd_directory_info {\n\t__le32 NextEntryOffset;\n\t__u32 FileIndex;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 FileAttributes;\n\t__le32 FileNameLength;\n\t__le32 EaSize;  \n\t__le32 ReparsePointTag;  \n\t__le64 UniqueId;  \n\tchar FileName[];\n} __packed;  \n\nextern char smb2_padding[7];\n\n \nstruct create_posix_rsp {\n\tu32 nlink;\n\tu32 reparse_tag;\n\tu32 mode;\n\tstruct cifs_sid owner;  \n\tstruct cifs_sid group;  \n} __packed;\n\n#define SMB2_QUERY_DIRECTORY_IOV_SIZE 2\n\n \nstruct smb2_posix_info {\n\t__le32 NextEntryOffset;\n\t__u32 Ignored;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 DosAttributes;\n\t__le64 Inode;\n\t__le32 DeviceId;\n\t__le32 Zero;\n\t \n\t__le32 HardLinks;\n\t__le32 ReparseTag;\n\t__le32 Mode;\n\t \n} __packed;\n\n \nstruct smb2_posix_info_parsed {\n\tconst struct smb2_posix_info *base;\n\tsize_t size;\n\tstruct cifs_sid owner;\n\tstruct cifs_sid group;\n\tint name_len;\n\tconst u8 *name;\n};\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}