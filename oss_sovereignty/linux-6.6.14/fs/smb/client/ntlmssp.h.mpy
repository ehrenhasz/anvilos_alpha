{
  "module_name": "ntlmssp.h",
  "hash_id": "9eaa34cd1024020a555c46a55e494c429ceb1f4c669874895e5387e5aa369365",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/ntlmssp.h",
  "human_readable_source": " \n \n\n#define NTLMSSP_SIGNATURE \"NTLMSSP\"\n \n#define NtLmNegotiate     cpu_to_le32(1)\n#define NtLmChallenge     cpu_to_le32(2)\n#define NtLmAuthenticate  cpu_to_le32(3)\n#define UnknownMessage    cpu_to_le32(8)\n\n \n#define NTLMSSP_NEGOTIATE_UNICODE         0x01  \n#define NTLMSSP_NEGOTIATE_OEM             0x02  \n#define NTLMSSP_REQUEST_TARGET            0x04  \n \n#define NTLMSSP_NEGOTIATE_SIGN          0x0010  \n#define NTLMSSP_NEGOTIATE_SEAL          0x0020  \n#define NTLMSSP_NEGOTIATE_DGRAM         0x0040\n#define NTLMSSP_NEGOTIATE_LM_KEY        0x0080  \n \n#define NTLMSSP_NEGOTIATE_NTLM          0x0200  \n#define NTLMSSP_NEGOTIATE_NT_ONLY       0x0400  \n#define NTLMSSP_ANONYMOUS               0x0800\n#define NTLMSSP_NEGOTIATE_DOMAIN_SUPPLIED 0x1000  \n#define NTLMSSP_NEGOTIATE_WORKSTATION_SUPPLIED 0x2000\n#define NTLMSSP_NEGOTIATE_LOCAL_CALL    0x4000  \n#define NTLMSSP_NEGOTIATE_ALWAYS_SIGN   0x8000  \n#define NTLMSSP_TARGET_TYPE_DOMAIN     0x10000\n#define NTLMSSP_TARGET_TYPE_SERVER     0x20000\n#define NTLMSSP_TARGET_TYPE_SHARE      0x40000\n#define NTLMSSP_NEGOTIATE_EXTENDED_SEC 0x80000  \n \n#define NTLMSSP_NEGOTIATE_IDENTIFY    0x100000\n#define NTLMSSP_REQUEST_ACCEPT_RESP   0x200000  \n#define NTLMSSP_REQUEST_NON_NT_KEY    0x400000\n#define NTLMSSP_NEGOTIATE_TARGET_INFO 0x800000\n \n#define NTLMSSP_NEGOTIATE_VERSION    0x2000000  \n \n \n \n#define NTLMSSP_NEGOTIATE_128       0x20000000\n#define NTLMSSP_NEGOTIATE_KEY_XCH   0x40000000\n#define NTLMSSP_NEGOTIATE_56        0x80000000\n\n \nenum av_field_type {\n\tNTLMSSP_AV_EOL = 0,\n\tNTLMSSP_AV_NB_COMPUTER_NAME,\n\tNTLMSSP_AV_NB_DOMAIN_NAME,\n\tNTLMSSP_AV_DNS_COMPUTER_NAME,\n\tNTLMSSP_AV_DNS_DOMAIN_NAME,\n\tNTLMSSP_AV_DNS_TREE_NAME,\n\tNTLMSSP_AV_FLAGS,\n\tNTLMSSP_AV_TIMESTAMP,\n\tNTLMSSP_AV_RESTRICTION,\n\tNTLMSSP_AV_TARGET_NAME,\n\tNTLMSSP_AV_CHANNEL_BINDINGS\n};\n\n \n \n \n \n \n\ntypedef struct _SECURITY_BUFFER {\n\t__le16 Length;\n\t__le16 MaximumLength;\n\t__le32 BufferOffset;\t \n} __attribute__((packed)) SECURITY_BUFFER;\n\ntypedef struct _NEGOTIATE_MESSAGE {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;      \n\t__le32 NegotiateFlags;\n\tSECURITY_BUFFER DomainName;\t \n\tSECURITY_BUFFER WorkstationName;\t \n\t \n\tchar DomainString[];\n\t \n} __attribute__((packed)) NEGOTIATE_MESSAGE, *PNEGOTIATE_MESSAGE;\n\n#define NTLMSSP_REVISION_W2K3 0x0F\n\n \nstruct ntlmssp_version {\n\t__u8\tProductMajorVersion;\n\t__u8\tProductMinorVersion;\n\t__le16\tProductBuild;  \n\t__u8\tReserved[3];\n\t__u8\tNTLMRevisionCurrent;  \n} __packed;\n\n \nstruct negotiate_message {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;      \n\t__le32 NegotiateFlags;\n\tSECURITY_BUFFER DomainName;\t \n\tSECURITY_BUFFER WorkstationName;\t \n\tstruct\tntlmssp_version Version;\n\t \n\tchar DomainString[];\n\t \n} __packed;\n\ntypedef struct _CHALLENGE_MESSAGE {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;    \n\tSECURITY_BUFFER TargetName;\n\t__le32 NegotiateFlags;\n\t__u8 Challenge[CIFS_CRYPTO_KEY_SIZE];\n\t__u8 Reserved[8];\n\tSECURITY_BUFFER TargetInfoArray;\n\t \n} __attribute__((packed)) CHALLENGE_MESSAGE, *PCHALLENGE_MESSAGE;\n\ntypedef struct _AUTHENTICATE_MESSAGE {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;   \n\tSECURITY_BUFFER LmChallengeResponse;\n\tSECURITY_BUFFER NtChallengeResponse;\n\tSECURITY_BUFFER DomainName;\n\tSECURITY_BUFFER UserName;\n\tSECURITY_BUFFER WorkstationName;\n\tSECURITY_BUFFER SessionKey;\n\t__le32 NegotiateFlags;\n\t \n\tchar UserString[];\n} __attribute__((packed)) AUTHENTICATE_MESSAGE, *PAUTHENTICATE_MESSAGE;\n\n \n\nint decode_ntlmssp_challenge(char *bcc_ptr, int blob_len, struct cifs_ses *ses);\nint build_ntlmssp_negotiate_blob(unsigned char **pbuffer, u16 *buflen,\n\t\t\t\t struct cifs_ses *ses,\n\t\t\t\t struct TCP_Server_Info *server,\n\t\t\t\t const struct nls_table *nls_cp);\nint build_ntlmssp_smb3_negotiate_blob(unsigned char **pbuffer, u16 *buflen,\n\t\t\t\t struct cifs_ses *ses,\n\t\t\t\t struct TCP_Server_Info *server,\n\t\t\t\t const struct nls_table *nls_cp);\nint build_ntlmssp_auth_blob(unsigned char **pbuffer, u16 *buflen,\n\t\t\tstruct cifs_ses *ses,\n\t\t\tstruct TCP_Server_Info *server,\n\t\t\tconst struct nls_table *nls_cp);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}