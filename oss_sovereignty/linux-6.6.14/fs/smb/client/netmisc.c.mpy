{
  "module_name": "netmisc.c",
  "hash_id": "bb2f3856e0966f50fdb69c9f96af11f0ebeb5f010dfde77a1dc97576675168e4",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/client/netmisc.c",
  "human_readable_source": "\n \n\n#include <linux/net.h>\n#include <linux/string.h>\n#include <linux/in.h>\n#include <linux/ctype.h>\n#include <linux/fs.h>\n#include <asm/div64.h>\n#include <asm/byteorder.h>\n#include <linux/inet.h>\n#include \"cifsfs.h\"\n#include \"cifspdu.h\"\n#include \"cifsglob.h\"\n#include \"cifsproto.h\"\n#include \"smberr.h\"\n#include \"cifs_debug.h\"\n#include \"nterr.h\"\n\nstruct smb_to_posix_error {\n\t__u16 smb_err;\n\tint posix_code;\n};\n\nstatic const struct smb_to_posix_error mapping_table_ERRDOS[] = {\n\t{ERRbadfunc, -EINVAL},\n\t{ERRbadfile, -ENOENT},\n\t{ERRbadpath, -ENOTDIR},\n\t{ERRnofids, -EMFILE},\n\t{ERRnoaccess, -EACCES},\n\t{ERRbadfid, -EBADF},\n\t{ERRbadmcb, -EIO},\n\t{ERRnomem, -EREMOTEIO},\n\t{ERRbadmem, -EFAULT},\n\t{ERRbadenv, -EFAULT},\n\t{ERRbadformat, -EINVAL},\n\t{ERRbadaccess, -EACCES},\n\t{ERRbaddata, -EIO},\n\t{ERRbaddrive, -ENXIO},\n\t{ERRremcd, -EACCES},\n\t{ERRdiffdevice, -EXDEV},\n\t{ERRnofiles, -ENOENT},\n\t{ERRwriteprot, -EROFS},\n\t{ERRbadshare, -EBUSY},\n\t{ERRlock, -EACCES},\n\t{ERRunsup, -EINVAL},\n\t{ERRnosuchshare, -ENXIO},\n\t{ERRfilexists, -EEXIST},\n\t{ERRinvparm, -EINVAL},\n\t{ERRdiskfull, -ENOSPC},\n\t{ERRinvname, -ENOENT},\n\t{ERRinvlevel, -EOPNOTSUPP},\n\t{ERRdirnotempty, -ENOTEMPTY},\n\t{ERRnotlocked, -ENOLCK},\n\t{ERRcancelviolation, -ENOLCK},\n\t{ERRalreadyexists, -EEXIST},\n\t{ERRmoredata, -EOVERFLOW},\n\t{ERReasnotsupported, -EOPNOTSUPP},\n\t{ErrQuota, -EDQUOT},\n\t{ErrNotALink, -ENOLINK},\n\t{ERRnetlogonNotStarted, -ENOPROTOOPT},\n\t{ERRsymlink, -EOPNOTSUPP},\n\t{ErrTooManyLinks, -EMLINK},\n\t{0, 0}\n};\n\nstatic const struct smb_to_posix_error mapping_table_ERRSRV[] = {\n\t{ERRerror, -EIO},\n\t{ERRbadpw, -EACCES},   \n\t{ERRbadtype, -EREMOTE},\n\t{ERRaccess, -EACCES},\n\t{ERRinvtid, -ENXIO},\n\t{ERRinvnetname, -ENXIO},\n\t{ERRinvdevice, -ENXIO},\n\t{ERRqfull, -ENOSPC},\n\t{ERRqtoobig, -ENOSPC},\n\t{ERRqeof, -EIO},\n\t{ERRinvpfid, -EBADF},\n\t{ERRsmbcmd, -EBADRQC},\n\t{ERRsrverror, -EIO},\n\t{ERRbadBID, -EIO},\n\t{ERRfilespecs, -EINVAL},\n\t{ERRbadLink, -EIO},\n\t{ERRbadpermits, -EINVAL},\n\t{ERRbadPID, -ESRCH},\n\t{ERRsetattrmode, -EINVAL},\n\t{ERRpaused, -EHOSTDOWN},\n\t{ERRmsgoff, -EHOSTDOWN},\n\t{ERRnoroom, -ENOSPC},\n\t{ERRrmuns, -EUSERS},\n\t{ERRtimeout, -ETIME},\n\t{ERRnoresource, -EREMOTEIO},\n\t{ERRtoomanyuids, -EUSERS},\n\t{ERRbaduid, -EACCES},\n\t{ERRusempx, -EIO},\n\t{ERRusestd, -EIO},\n\t{ERR_NOTIFY_ENUM_DIR, -ENOBUFS},\n\t{ERRnoSuchUser, -EACCES},\n \n\t{ERRaccountexpired, -EKEYEXPIRED},\n\t{ERRbadclient, -EACCES},\n\t{ERRbadLogonTime, -EACCES},\n\t{ERRpasswordExpired, -EKEYEXPIRED},\n\n\t{ERRnosupport, -EINVAL},\n\t{0, 0}\n};\n\n \nstatic int\ncifs_inet_pton(const int address_family, const char *cp, int len, void *dst)\n{\n\tint ret = 0;\n\n\t \n\tif (address_family == AF_INET)\n\t\tret = in4_pton(cp, len, dst, '\\\\', NULL);\n\telse if (address_family == AF_INET6)\n\t\tret = in6_pton(cp, len, dst , '\\\\', NULL);\n\n\tcifs_dbg(NOISY, \"address conversion returned %d for %*.*s\\n\",\n\t\t ret, len, len, cp);\n\tif (ret > 0)\n\t\tret = 1;\n\treturn ret;\n}\n\n \nint\ncifs_convert_address(struct sockaddr *dst, const char *src, int len)\n{\n\tint rc, alen, slen;\n\tconst char *pct;\n\tchar scope_id[13];\n\tstruct sockaddr_in *s4 = (struct sockaddr_in *) dst;\n\tstruct sockaddr_in6 *s6 = (struct sockaddr_in6 *) dst;\n\n\t \n\tif (cifs_inet_pton(AF_INET, src, len, &s4->sin_addr.s_addr)) {\n\t\ts4->sin_family = AF_INET;\n\t\treturn 1;\n\t}\n\n\t \n\tpct = memchr(src, '%', len);\n\talen = pct ? pct - src : len;\n\n\trc = cifs_inet_pton(AF_INET6, src, alen, &s6->sin6_addr.s6_addr);\n\tif (!rc)\n\t\treturn rc;\n\n\ts6->sin6_family = AF_INET6;\n\tif (pct) {\n\t\t \n\t\tslen = len - (alen + 1);\n\t\tif (slen <= 0 || slen > 12)\n\t\t\treturn 0;\n\t\tmemcpy(scope_id, pct + 1, slen);\n\t\tscope_id[slen] = '\\0';\n\n\t\trc = kstrtouint(scope_id, 0, &s6->sin6_scope_id);\n\t\trc = (rc == 0) ? 1 : 0;\n\t}\n\n\treturn rc;\n}\n\nvoid\ncifs_set_port(struct sockaddr *addr, const unsigned short int port)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET:\n\t\t((struct sockaddr_in *)addr)->sin_port = htons(port);\n\t\tbreak;\n\tcase AF_INET6:\n\t\t((struct sockaddr_in6 *)addr)->sin6_port = htons(port);\n\t\tbreak;\n\t}\n}\n\n \n \nstatic const struct {\n\t__u8 dos_class;\n\t__u16 dos_code;\n\t__u32 ntstatus;\n} ntstatus_to_dos_map[] = {\n\t{\n\tERRDOS, ERRgeneral, NT_STATUS_UNSUCCESSFUL}, {\n\tERRDOS, ERRbadfunc, NT_STATUS_NOT_IMPLEMENTED}, {\n\tERRDOS, ERRinvlevel, NT_STATUS_INVALID_INFO_CLASS}, {\n\tERRDOS, 24, NT_STATUS_INFO_LENGTH_MISMATCH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ACCESS_VIOLATION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IN_PAGE_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PAGEFILE_QUOTA}, {\n\tERRDOS, ERRbadfid, NT_STATUS_INVALID_HANDLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_INITIAL_STACK}, {\n\tERRDOS, 193, NT_STATUS_BAD_INITIAL_PC}, {\n\tERRDOS, 87, NT_STATUS_INVALID_CID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TIMER_NOT_CANCELED}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER}, {\n\tERRDOS, ERRbadfile, NT_STATUS_NO_SUCH_DEVICE}, {\n\tERRDOS, ERRbadfile, NT_STATUS_NO_SUCH_FILE}, {\n\tERRDOS, ERRbadfunc, NT_STATUS_INVALID_DEVICE_REQUEST}, {\n\tERRDOS, 38, NT_STATUS_END_OF_FILE}, {\n\tERRDOS, 34, NT_STATUS_WRONG_VOLUME}, {\n\tERRDOS, 21, NT_STATUS_NO_MEDIA_IN_DEVICE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNRECOGNIZED_MEDIA}, {\n\tERRDOS, 27, NT_STATUS_NONEXISTENT_SECTOR},\n \n\t{\n\tERRDOS, ERRnomem, NT_STATUS_NO_MEMORY}, {\n\tERRDOS, 487, NT_STATUS_CONFLICTING_ADDRESSES}, {\n\tERRDOS, 487, NT_STATUS_NOT_MAPPED_VIEW}, {\n\tERRDOS, 87, NT_STATUS_UNABLE_TO_FREE_VM}, {\n\tERRDOS, 87, NT_STATUS_UNABLE_TO_DELETE_SECTION}, {\n\tERRDOS, 2142, NT_STATUS_INVALID_SYSTEM_SERVICE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ILLEGAL_INSTRUCTION}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_INVALID_LOCK_SEQUENCE}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_INVALID_VIEW_SIZE}, {\n\tERRDOS, 193, NT_STATUS_INVALID_FILE_FOR_SECTION}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_ALREADY_COMMITTED},\n \n\t{\n\tERRDOS, ERRnoaccess, NT_STATUS_ACCESS_DENIED}, {\n\tERRDOS, 111, NT_STATUS_BUFFER_TOO_SMALL}, {\n\tERRDOS, ERRbadfid, NT_STATUS_OBJECT_TYPE_MISMATCH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NONCONTINUABLE_EXCEPTION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_DISPOSITION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNWIND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_STACK}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_UNWIND_TARGET}, {\n\tERRDOS, 158, NT_STATUS_NOT_LOCKED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PARITY_ERROR}, {\n\tERRDOS, 487, NT_STATUS_UNABLE_TO_DECOMMIT_VM}, {\n\tERRDOS, 487, NT_STATUS_NOT_COMMITTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_PORT_ATTRIBUTES}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PORT_MESSAGE_TOO_LONG}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_MIX}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_QUOTA_LOWER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DISK_CORRUPT_ERROR}, {\n\t  \n\tERRDOS, ERRbadfile, NT_STATUS_OBJECT_NAME_INVALID}, {\n\tERRDOS, ERRbadfile, NT_STATUS_OBJECT_NAME_NOT_FOUND}, {\n\tERRDOS, ERRalreadyexists, NT_STATUS_OBJECT_NAME_COLLISION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_HANDLE_NOT_WAITABLE}, {\n\tERRDOS, ERRbadfid, NT_STATUS_PORT_DISCONNECTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DEVICE_ALREADY_ATTACHED}, {\n\tERRDOS, 161, NT_STATUS_OBJECT_PATH_INVALID}, {\n\tERRDOS, ERRbadpath, NT_STATUS_OBJECT_PATH_NOT_FOUND}, {\n\tERRDOS, 161, NT_STATUS_OBJECT_PATH_SYNTAX_BAD}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DATA_OVERRUN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DATA_LATE_ERROR}, {\n\tERRDOS, 23, NT_STATUS_DATA_ERROR}, {\n\tERRDOS, 23, NT_STATUS_CRC_ERROR}, {\n\tERRDOS, ERRnomem, NT_STATUS_SECTION_TOO_BIG}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_PORT_CONNECTION_REFUSED}, {\n\tERRDOS, ERRbadfid, NT_STATUS_INVALID_PORT_HANDLE}, {\n\tERRDOS, ERRbadshare, NT_STATUS_SHARING_VIOLATION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_QUOTA_EXCEEDED}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PAGE_PROTECTION}, {\n\tERRDOS, 288, NT_STATUS_MUTANT_NOT_OWNED}, {\n\tERRDOS, 298, NT_STATUS_SEMAPHORE_LIMIT_EXCEEDED}, {\n\tERRDOS, 87, NT_STATUS_PORT_ALREADY_SET}, {\n\tERRDOS, 87, NT_STATUS_SECTION_NOT_IMAGE}, {\n\tERRDOS, 156, NT_STATUS_SUSPEND_COUNT_EXCEEDED}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_THREAD_IS_TERMINATING}, {\n\tERRDOS, 87, NT_STATUS_BAD_WORKING_SET_LIMIT}, {\n\tERRDOS, 87, NT_STATUS_INCOMPATIBLE_FILE_MAP}, {\n\tERRDOS, 87, NT_STATUS_SECTION_PROTECTION}, {\n\tERRDOS, ERReasnotsupported, NT_STATUS_EAS_NOT_SUPPORTED}, {\n\tERRDOS, 255, NT_STATUS_EA_TOO_LARGE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NONEXISTENT_EA_ENTRY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_EAS_ON_FILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_EA_CORRUPT_ERROR}, {\n\tERRDOS, ERRlock, NT_STATUS_FILE_LOCK_CONFLICT}, {\n\tERRDOS, ERRlock, NT_STATUS_LOCK_NOT_GRANTED}, {\n\tERRDOS, ERRbadfile, NT_STATUS_DELETE_PENDING}, {\n\tERRDOS, ERRunsup, NT_STATUS_CTL_FILE_NOT_SUPPORTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNKNOWN_REVISION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REVISION_MISMATCH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_OWNER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_PRIMARY_GROUP}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_IMPERSONATION_TOKEN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANT_DISABLE_MANDATORY}, {\n\tERRDOS, 2215, NT_STATUS_NO_LOGON_SERVERS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_LOGON_SESSION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_PRIVILEGE}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_PRIVILEGE_NOT_HELD}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_ACCOUNT_NAME}, {\n\tERRHRD, ERRgeneral, NT_STATUS_USER_EXISTS},\n \n\t{\n\tERRDOS, ERRnoaccess, NT_STATUS_NO_SUCH_USER}, {  \n\tERRHRD, ERRgeneral, NT_STATUS_GROUP_EXISTS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_GROUP}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MEMBER_IN_GROUP}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MEMBER_NOT_IN_GROUP}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LAST_ADMIN},\n \n\t{\n\tERRSRV, ERRbadpw, NT_STATUS_WRONG_PASSWORD}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ILL_FORMED_PASSWORD}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PASSWORD_RESTRICTION}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_LOGON_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ACCOUNT_RESTRICTION}, {\n\tERRSRV, ERRbadLogonTime, NT_STATUS_INVALID_LOGON_HOURS}, {\n\tERRSRV, ERRbadclient, NT_STATUS_INVALID_WORKSTATION}, {\n\tERRSRV, ERRpasswordExpired, NT_STATUS_PASSWORD_EXPIRED}, {\n\tERRSRV, ERRaccountexpired, NT_STATUS_ACCOUNT_DISABLED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NONE_MAPPED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOO_MANY_LUIDS_REQUESTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LUIDS_EXHAUSTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_SUB_AUTHORITY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_ACL}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_SID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_SECURITY_DESCR}, {\n\tERRDOS, 127, NT_STATUS_PROCEDURE_NOT_FOUND}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_FORMAT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_TOKEN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_INHERITANCE_ACL}, {\n\tERRDOS, 158, NT_STATUS_RANGE_NOT_LOCKED}, {\n\tERRDOS, 112, NT_STATUS_DISK_FULL}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SERVER_DISABLED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SERVER_NOT_DISABLED}, {\n\tERRDOS, 68, NT_STATUS_TOO_MANY_GUIDS_REQUESTED}, {\n\tERRDOS, 259, NT_STATUS_GUIDS_EXHAUSTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_ID_AUTHORITY}, {\n\tERRDOS, 259, NT_STATUS_AGENTS_EXHAUSTED}, {\n\tERRDOS, 154, NT_STATUS_INVALID_VOLUME_LABEL}, {\n\tERRDOS, 14, NT_STATUS_SECTION_NOT_EXTENDED}, {\n\tERRDOS, 487, NT_STATUS_NOT_MAPPED_DATA}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RESOURCE_DATA_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RESOURCE_TYPE_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RESOURCE_NAME_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ARRAY_BOUNDS_EXCEEDED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_DENORMAL_OPERAND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_DIVIDE_BY_ZERO}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_INEXACT_RESULT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_INVALID_OPERATION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_OVERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_STACK_CHECK}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOAT_UNDERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INTEGER_DIVIDE_BY_ZERO}, {\n\tERRDOS, 534, NT_STATUS_INTEGER_OVERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PRIVILEGED_INSTRUCTION}, {\n\tERRDOS, ERRnomem, NT_STATUS_TOO_MANY_PAGING_FILES}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FILE_INVALID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ALLOTTED_SPACE_EXCEEDED},\n \n\t{\n\tERRDOS, ERRnoresource, NT_STATUS_INSUFFICIENT_RESOURCES}, {\n\tERRDOS, ERRbadpath, NT_STATUS_DFS_EXIT_PATH_FOUND}, {\n\tERRDOS, 23, NT_STATUS_DEVICE_DATA_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DEVICE_NOT_CONNECTED}, {\n\tERRDOS, 21, NT_STATUS_DEVICE_POWER_FAILURE}, {\n\tERRDOS, 487, NT_STATUS_FREE_VM_NOT_AT_BASE}, {\n\tERRDOS, 487, NT_STATUS_MEMORY_NOT_ALLOCATED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_WORKING_SET_QUOTA}, {\n\tERRDOS, 19, NT_STATUS_MEDIA_WRITE_PROTECTED}, {\n\tERRDOS, 21, NT_STATUS_DEVICE_NOT_READY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_GROUP_ATTRIBUTES}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_IMPERSONATION_LEVEL}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANT_OPEN_ANONYMOUS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_VALIDATION_CLASS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_TOKEN_TYPE}, {\n\tERRDOS, 87, NT_STATUS_BAD_MASTER_BOOT_RECORD}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INSTRUCTION_MISALIGNMENT}, {\n\tERRDOS, ERRpipebusy, NT_STATUS_INSTANCE_NOT_AVAILABLE}, {\n\tERRDOS, ERRpipebusy, NT_STATUS_PIPE_NOT_AVAILABLE}, {\n\tERRDOS, ERRbadpipe, NT_STATUS_INVALID_PIPE_STATE}, {\n\tERRDOS, ERRpipebusy, NT_STATUS_PIPE_BUSY}, {\n\tERRDOS, ERRbadfunc, NT_STATUS_ILLEGAL_FUNCTION}, {\n\tERRDOS, ERRnotconnected, NT_STATUS_PIPE_DISCONNECTED}, {\n\tERRDOS, ERRpipeclosing, NT_STATUS_PIPE_CLOSING}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PIPE_CONNECTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PIPE_LISTENING}, {\n\tERRDOS, ERRbadpipe, NT_STATUS_INVALID_READ_MODE}, {\n\tERRDOS, 121, NT_STATUS_IO_TIMEOUT}, {\n\tERRDOS, 38, NT_STATUS_FILE_FORCED_CLOSED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PROFILING_NOT_STARTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PROFILING_NOT_STOPPED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_COULD_NOT_INTERPRET}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_FILE_IS_A_DIRECTORY}, {\n\tERRDOS, ERRunsup, NT_STATUS_NOT_SUPPORTED}, {\n\tERRDOS, 51, NT_STATUS_REMOTE_NOT_LISTENING}, {\n\tERRDOS, 52, NT_STATUS_DUPLICATE_NAME}, {\n\tERRDOS, 53, NT_STATUS_BAD_NETWORK_PATH}, {\n\tERRDOS, 54, NT_STATUS_NETWORK_BUSY}, {\n\tERRDOS, 55, NT_STATUS_DEVICE_DOES_NOT_EXIST}, {\n\tERRDOS, 56, NT_STATUS_TOO_MANY_COMMANDS}, {\n\tERRDOS, 57, NT_STATUS_ADAPTER_HARDWARE_ERROR}, {\n\tERRDOS, 58, NT_STATUS_INVALID_NETWORK_RESPONSE}, {\n\tERRDOS, 59, NT_STATUS_UNEXPECTED_NETWORK_ERROR}, {\n\tERRDOS, 60, NT_STATUS_BAD_REMOTE_ADAPTER}, {\n\tERRDOS, 61, NT_STATUS_PRINT_QUEUE_FULL}, {\n\tERRDOS, 62, NT_STATUS_NO_SPOOL_SPACE}, {\n\tERRDOS, 63, NT_STATUS_PRINT_CANCELLED}, {\n\tERRDOS, 64, NT_STATUS_NETWORK_NAME_DELETED}, {\n\tERRDOS, 65, NT_STATUS_NETWORK_ACCESS_DENIED}, {\n\tERRDOS, 66, NT_STATUS_BAD_DEVICE_TYPE}, {\n\tERRDOS, ERRnosuchshare, NT_STATUS_BAD_NETWORK_NAME}, {\n\tERRDOS, 68, NT_STATUS_TOO_MANY_NAMES}, {\n\tERRDOS, 69, NT_STATUS_TOO_MANY_SESSIONS}, {\n\tERRDOS, 70, NT_STATUS_SHARING_PAUSED}, {\n\tERRDOS, 71, NT_STATUS_REQUEST_NOT_ACCEPTED}, {\n\tERRDOS, 72, NT_STATUS_REDIRECTOR_PAUSED}, {\n\tERRDOS, 88, NT_STATUS_NET_WRITE_FAULT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PROFILING_AT_LIMIT}, {\n\tERRDOS, ERRdiffdevice, NT_STATUS_NOT_SAME_DEVICE}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_FILE_RENAMED}, {\n\tERRDOS, 240, NT_STATUS_VIRTUAL_CIRCUIT_CLOSED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SECURITY_ON_OBJECT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANT_WAIT}, {\n\tERRDOS, ERRpipeclosing, NT_STATUS_PIPE_EMPTY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANT_ACCESS_DOMAIN_INFO}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANT_TERMINATE_SELF}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_SERVER_STATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_DOMAIN_STATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_DOMAIN_ROLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_DOMAIN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DOMAIN_EXISTS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DOMAIN_LIMIT_EXCEEDED}, {\n\tERRDOS, 300, NT_STATUS_OPLOCK_NOT_GRANTED}, {\n\tERRDOS, 301, NT_STATUS_INVALID_OPLOCK_PROTOCOL}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INTERNAL_DB_CORRUPTION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INTERNAL_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_GENERIC_NOT_MAPPED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_DESCRIPTOR_FORMAT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_USER_BUFFER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNEXPECTED_IO_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNEXPECTED_MM_CREATE_ERR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNEXPECTED_MM_MAP_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNEXPECTED_MM_EXTEND_ERR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NOT_LOGON_PROCESS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGON_SESSION_EXISTS}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_1}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_2}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_3}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_4}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_5}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_6}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_7}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_8}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_9}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_10}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_11}, {\n\tERRDOS, 87, NT_STATUS_INVALID_PARAMETER_12}, {\n\tERRDOS, ERRbadpath, NT_STATUS_REDIRECTOR_NOT_STARTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REDIRECTOR_STARTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_STACK_OVERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_PACKAGE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_FUNCTION_TABLE}, {\n\tERRDOS, 203, 0xc0000100}, {\n\tERRDOS, 145, NT_STATUS_DIRECTORY_NOT_EMPTY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FILE_CORRUPT_ERROR}, {\n\tERRDOS, 267, NT_STATUS_NOT_A_DIRECTORY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_LOGON_SESSION_STATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGON_SESSION_COLLISION}, {\n\tERRDOS, 206, NT_STATUS_NAME_TOO_LONG}, {\n\tERRDOS, 2401, NT_STATUS_FILES_OPEN}, {\n\tERRDOS, 2404, NT_STATUS_CONNECTION_IN_USE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MESSAGE_NOT_FOUND}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_PROCESS_IS_TERMINATING}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_LOGON_TYPE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_GUID_TRANSLATION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANNOT_IMPERSONATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IMAGE_ALREADY_LOADED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_NOT_PRESENT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_LID_NOT_EXIST}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_LID_ALREADY_OWNED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_NOT_LID_OWNER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_INVALID_COMMAND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_INVALID_LID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_SELECTOR_NOT_AVAILABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ABIOS_INVALID_SELECTOR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_LDT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_LDT_SIZE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_LDT_OFFSET}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_LDT_DESCRIPTOR}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_NE_FORMAT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RXACT_INVALID_STATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RXACT_COMMIT_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MAPPED_FILE_SIZE_ZERO}, {\n\tERRDOS, ERRnofids, NT_STATUS_TOO_MANY_OPENED_FILES}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANCELLED}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_CANNOT_DELETE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_COMPUTER_NAME}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_FILE_DELETED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SPECIAL_ACCOUNT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SPECIAL_GROUP}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SPECIAL_USER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MEMBERS_PRIMARY_GROUP}, {\n\tERRDOS, ERRbadfid, NT_STATUS_FILE_CLOSED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOO_MANY_THREADS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_THREAD_NOT_IN_PROCESS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOKEN_ALREADY_IN_USE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PAGEFILE_QUOTA_EXCEEDED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_COMMITMENT_LIMIT}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_LE_FORMAT}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_NOT_MZ}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_PROTECT}, {\n\tERRDOS, 193, NT_STATUS_INVALID_IMAGE_WIN_16}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGON_SERVER_CONFLICT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TIME_DIFFERENCE_AT_DC}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SYNCHRONIZATION_REQUIRED}, {\n\tERRDOS, 126, NT_STATUS_DLL_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_OPEN_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IO_PRIVILEGE_FAILED}, {\n\tERRDOS, 182, NT_STATUS_ORDINAL_NOT_FOUND}, {\n\tERRDOS, 127, NT_STATUS_ENTRYPOINT_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONTROL_C_EXIT}, {\n\tERRDOS, 64, NT_STATUS_LOCAL_DISCONNECT}, {\n\tERRDOS, 64, NT_STATUS_REMOTE_DISCONNECT}, {\n\tERRDOS, 51, NT_STATUS_REMOTE_RESOURCES}, {\n\tERRDOS, 59, NT_STATUS_LINK_FAILED}, {\n\tERRDOS, 59, NT_STATUS_LINK_TIMEOUT}, {\n\tERRDOS, 59, NT_STATUS_INVALID_CONNECTION}, {\n\tERRDOS, 59, NT_STATUS_INVALID_ADDRESS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DLL_INIT_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MISSING_SYSTEMFILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNHANDLED_EXCEPTION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_APP_INIT_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PAGEFILE_CREATE_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_PAGEFILE}, {\n\tERRDOS, 124, NT_STATUS_INVALID_LEVEL}, {\n\tERRDOS, 86, NT_STATUS_WRONG_PASSWORD_CORE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ILLEGAL_FLOAT_CONTEXT}, {\n\tERRDOS, 109, NT_STATUS_PIPE_BROKEN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REGISTRY_CORRUPT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REGISTRY_IO_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_EVENT_PAIR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNRECOGNIZED_VOLUME}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SERIAL_NO_DEVICE_INITED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_ALIAS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MEMBER_NOT_IN_ALIAS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MEMBER_IN_ALIAS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ALIAS_EXISTS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGON_NOT_GRANTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOO_MANY_SECRETS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SECRET_TOO_LONG}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INTERNAL_DB_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FULLSCREEN_MODE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOO_MANY_CONTEXT_IDS}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_LOGON_TYPE_NOT_GRANTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NOT_REGISTRY_FILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NT_CROSS_ENCRYPTION_REQUIRED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DOMAIN_CTRLR_CONFIG_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FT_MISSING_MEMBER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ILL_FORMED_SERVICE_ENTRY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ILLEGAL_CHARACTER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNMAPPABLE_CHARACTER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNDEFINED_CHARACTER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOPPY_VOLUME}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOPPY_ID_MARK_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOPPY_WRONG_CYLINDER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOPPY_UNKNOWN_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FLOPPY_BAD_REGISTERS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DISK_RECALIBRATE_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DISK_OPERATION_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DISK_RESET_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SHARED_IRQ_BUSY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FT_ORPHANING}, {\n\tERRHRD, ERRgeneral, 0xc000016e}, {\n\tERRHRD, ERRgeneral, 0xc000016f}, {\n\tERRHRD, ERRgeneral, 0xc0000170}, {\n\tERRHRD, ERRgeneral, 0xc0000171}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PARTITION_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_BLOCK_LENGTH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DEVICE_NOT_PARTITIONED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNABLE_TO_LOCK_MEDIA}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNABLE_TO_UNLOAD_MEDIA}, {\n\tERRHRD, ERRgeneral, NT_STATUS_EOM_OVERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_MEDIA}, {\n\tERRHRD, ERRgeneral, 0xc0000179}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_SUCH_MEMBER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_MEMBER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_KEY_DELETED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_LOG_SPACE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TOO_MANY_SIDS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LM_CROSS_ENCRYPTION_REQUIRED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_KEY_HAS_CHILDREN}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CHILD_MUST_BE_VOLATILE}, {\n\tERRDOS, 87, NT_STATUS_DEVICE_CONFIGURATION_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DRIVER_INTERNAL_ERROR}, {\n\tERRDOS, 22, NT_STATUS_INVALID_DEVICE_STATE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IO_DEVICE_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DEVICE_PROTOCOL_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BACKUP_CONTROLLER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOG_FILE_FULL}, {\n\tERRDOS, 19, NT_STATUS_TOO_LATE}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_NO_TRUST_LSA_SECRET},\n \n\t{\n\tERRDOS, ERRnoaccess, NT_STATUS_NO_TRUST_SAM_ACCOUNT}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_TRUSTED_DOMAIN_FAILURE}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_TRUSTED_RELATIONSHIP_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_EVENTLOG_FILE_CORRUPT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_EVENTLOG_CANT_START}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_TRUST_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MUTANT_LIMIT_EXCEEDED}, {\n\tERRDOS, ERRnetlogonNotStarted, NT_STATUS_NETLOGON_NOT_STARTED}, {\n\tERRSRV, ERRaccountexpired, NT_STATUS_ACCOUNT_EXPIRED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_POSSIBLE_DEADLOCK}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NETWORK_CREDENTIAL_CONFLICT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REMOTE_SESSION_LIMIT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_EVENTLOG_FILE_CHANGED}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_NOLOGON_INTERDOMAIN_TRUST_ACCOUNT}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_NOLOGON_WORKSTATION_TRUST_ACCOUNT}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_NOLOGON_SERVER_TRUST_ACCOUNT},\n \n\t{\n\tERRDOS, ERRnoaccess, NT_STATUS_DOMAIN_TRUST_INCONSISTENT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FS_DRIVER_REQUIRED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_USER_SESSION_KEY}, {\n\tERRDOS, 59, NT_STATUS_USER_SESSION_DELETED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RESOURCE_LANG_NOT_FOUND}, {\n\tERRDOS, ERRnoresource, NT_STATUS_INSUFF_SERVER_RESOURCES}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_BUFFER_SIZE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_ADDRESS_COMPONENT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_ADDRESS_WILDCARD}, {\n\tERRDOS, 68, NT_STATUS_TOO_MANY_ADDRESSES}, {\n\tERRDOS, 52, NT_STATUS_ADDRESS_ALREADY_EXISTS}, {\n\tERRDOS, 64, NT_STATUS_ADDRESS_CLOSED}, {\n\tERRDOS, 64, NT_STATUS_CONNECTION_DISCONNECTED}, {\n\tERRDOS, 64, NT_STATUS_CONNECTION_RESET}, {\n\tERRDOS, 68, NT_STATUS_TOO_MANY_NODES}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_ABORTED}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_TIMED_OUT}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_NO_RELEASE}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_NO_MATCH}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_RESPONDED}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_INVALID_ID}, {\n\tERRDOS, 59, NT_STATUS_TRANSACTION_INVALID_TYPE}, {\n\tERRDOS, ERRunsup, NT_STATUS_NOT_SERVER_SESSION}, {\n\tERRDOS, ERRunsup, NT_STATUS_NOT_CLIENT_SESSION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CANNOT_LOAD_REGISTRY_FILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DEBUG_ATTACH_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_SYSTEM_PROCESS_TERMINATED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DATA_NOT_ACCEPTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_BROWSER_SERVERS_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_VDM_HARD_ERROR}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DRIVER_CANCEL_TIMEOUT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REPLY_MESSAGE_MISMATCH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MAPPED_ALIGNMENT}, {\n\tERRDOS, 193, NT_STATUS_IMAGE_CHECKSUM_MISMATCH}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOST_WRITEBEHIND_DATA}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CLIENT_SERVER_PARAMETERS_INVALID}, {\n\tERRSRV, ERRpasswordExpired, NT_STATUS_PASSWORD_MUST_CHANGE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NOT_TINY_STREAM}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RECOVERY_FAILURE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_STACK_OVERFLOW_READ}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FAIL_CHECK}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DUPLICATE_OBJECTID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_OBJECTID_EXISTS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONVERT_TO_LARGE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_RETRY}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FOUND_OUT_OF_SCOPE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ALLOCATE_BUCKET}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PROPSET_NOT_FOUND}, {\n\tERRHRD, ERRgeneral, NT_STATUS_MARSHALL_OVERFLOW}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_VARIANT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_DOMAIN_CONTROLLER_NOT_FOUND}, {\n\tERRDOS, ERRnoaccess, NT_STATUS_ACCOUNT_LOCKED_OUT}, {\n\tERRDOS, ERRbadfid, NT_STATUS_HANDLE_NOT_CLOSABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONNECTION_REFUSED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_GRACEFUL_DISCONNECT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ADDRESS_ALREADY_ASSOCIATED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_ADDRESS_NOT_ASSOCIATED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONNECTION_INVALID}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONNECTION_ACTIVE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NETWORK_UNREACHABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_HOST_UNREACHABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PROTOCOL_UNREACHABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PORT_UNREACHABLE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REQUEST_ABORTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONNECTION_ABORTED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_COMPRESSION_BUFFER}, {\n\tERRHRD, ERRgeneral, NT_STATUS_USER_MAPPED_FILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_AUDIT_FAILED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_TIMER_RESOLUTION_NOT_SET}, {\n\tERRHRD, ERRgeneral, NT_STATUS_CONNECTION_COUNT_LIMIT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGIN_TIME_RESTRICTION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LOGIN_WKSTA_RESTRICTION}, {\n\tERRDOS, 193, NT_STATUS_IMAGE_MP_UP_MISMATCH}, {\n\tERRHRD, ERRgeneral, 0xc000024a}, {\n\tERRHRD, ERRgeneral, 0xc000024b}, {\n\tERRHRD, ERRgeneral, 0xc000024c}, {\n\tERRHRD, ERRgeneral, 0xc000024d}, {\n\tERRHRD, ERRgeneral, 0xc000024e}, {\n\tERRHRD, ERRgeneral, 0xc000024f}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INSUFFICIENT_LOGON_INFO}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_DLL_ENTRYPOINT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_BAD_SERVICE_ENTRYPOINT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LPC_REPLY_LOST}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IP_ADDRESS_CONFLICT1}, {\n\tERRHRD, ERRgeneral, NT_STATUS_IP_ADDRESS_CONFLICT2}, {\n\tERRHRD, ERRgeneral, NT_STATUS_REGISTRY_QUOTA_LIMIT}, {\n\tERRSRV, 3, NT_STATUS_PATH_NOT_COVERED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_NO_CALLBACK_ACTIVE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_LICENSE_QUOTA_EXCEEDED}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PWD_TOO_SHORT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PWD_TOO_RECENT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PWD_HISTORY_CONFLICT}, {\n\tERRHRD, ERRgeneral, 0xc000025d}, {\n\tERRHRD, ERRgeneral, NT_STATUS_PLUGPLAY_NO_DEVICE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_UNSUPPORTED_COMPRESSION}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_HW_PROFILE}, {\n\tERRHRD, ERRgeneral, NT_STATUS_INVALID_PLUGPLAY_DEVICE_PATH}, {\n\tERRDOS, 182, NT_STATUS_DRIVER_ORDINAL_NOT_FOUND}, {\n\tERRDOS, 127, NT_STATUS_DRIVER_ENTRYPOINT_NOT_FOUND}, {\n\tERRDOS, 288, NT_STATUS_RESOURCE_NOT_OWNED}, {\n\tERRDOS, ErrTooManyLinks, NT_STATUS_TOO_MANY_LINKS}, {\n\tERRHRD, ERRgeneral, NT_STATUS_QUOTA_LIST_INCONSISTENT}, {\n\tERRHRD, ERRgeneral, NT_STATUS_FILE_IS_OFFLINE}, {\n\tERRDOS, 21, 0xc000026e}, {\n\tERRDOS, 161, 0xc0000281}, {\n\tERRDOS, ERRnoaccess, 0xc000028a}, {\n\tERRDOS, ERRnoaccess, 0xc000028b}, {\n\tERRHRD, ERRgeneral, 0xc000028c}, {\n\tERRDOS, ERRnoaccess, 0xc000028d}, {\n\tERRDOS, ERRnoaccess, 0xc000028e}, {\n\tERRDOS, ERRnoaccess, 0xc000028f}, {\n\tERRDOS, ERRnoaccess, 0xc0000290}, {\n\tERRDOS, ERRbadfunc, 0xc000029c}, {\n\tERRDOS, ERRsymlink, NT_STATUS_STOPPED_ON_SYMLINK}, {\n\tERRDOS, ERRinvlevel, 0x007c0001}, {\n\t0, 0, 0 }\n};\n\n \nstatic void\ncifs_print_status(__u32 status_code)\n{\n\tint idx = 0;\n\n\twhile (nt_errs[idx].nt_errstr != NULL) {\n\t\tif (((nt_errs[idx].nt_errcode) & 0xFFFFFF) ==\n\t\t    (status_code & 0xFFFFFF)) {\n\t\t\tpr_notice(\"Status code returned 0x%08x %s\\n\",\n\t\t\t\t  status_code, nt_errs[idx].nt_errstr);\n\t\t}\n\t\tidx++;\n\t}\n\treturn;\n}\n\n\nstatic void\nntstatus_to_dos(__u32 ntstatus, __u8 *eclass, __u16 *ecode)\n{\n\tint i;\n\tif (ntstatus == 0) {\n\t\t*eclass = 0;\n\t\t*ecode = 0;\n\t\treturn;\n\t}\n\tfor (i = 0; ntstatus_to_dos_map[i].ntstatus; i++) {\n\t\tif (ntstatus == ntstatus_to_dos_map[i].ntstatus) {\n\t\t\t*eclass = ntstatus_to_dos_map[i].dos_class;\n\t\t\t*ecode = ntstatus_to_dos_map[i].dos_code;\n\t\t\treturn;\n\t\t}\n\t}\n\t*eclass = ERRHRD;\n\t*ecode = ERRgeneral;\n}\n\nint\nmap_smb_to_linux_error(char *buf, bool logErr)\n{\n\tstruct smb_hdr *smb = (struct smb_hdr *)buf;\n\tunsigned int i;\n\tint rc = -EIO;\t \n\t__u8 smberrclass;\n\t__u16 smberrcode;\n\n\t \n\n\t \n\tif (smb->Status.CifsError == 0)\n\t\treturn 0;\n\n\tif (smb->Flags2 & SMBFLG2_ERR_STATUS) {\n\t\t \n\t\t__u32 err = le32_to_cpu(smb->Status.CifsError);\n\t\tif (logErr && (err != (NT_STATUS_MORE_PROCESSING_REQUIRED)))\n\t\t\tcifs_print_status(err);\n\t\telse if (cifsFYI & CIFS_RC)\n\t\t\tcifs_print_status(err);\n\t\tntstatus_to_dos(err, &smberrclass, &smberrcode);\n\t} else {\n\t\tsmberrclass = smb->Status.DosError.ErrorClass;\n\t\tsmberrcode = le16_to_cpu(smb->Status.DosError.Error);\n\t}\n\n\t \n\n\t \n\tif (smberrclass == ERRDOS) {\n\t\t \n\t\tfor (i = 0;\n\t\t     i <\n\t\t     sizeof(mapping_table_ERRDOS) /\n\t\t     sizeof(struct smb_to_posix_error); i++) {\n\t\t\tif (mapping_table_ERRDOS[i].smb_err == 0)\n\t\t\t\tbreak;\n\t\t\telse if (mapping_table_ERRDOS[i].smb_err ==\n\t\t\t\t\t\t\t\tsmberrcode) {\n\t\t\t\trc = mapping_table_ERRDOS[i].posix_code;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t \n\t\t}\n\t} else if (smberrclass == ERRSRV) {\n\t\t \n\t\tfor (i = 0;\n\t\t     i <\n\t\t     sizeof(mapping_table_ERRSRV) /\n\t\t     sizeof(struct smb_to_posix_error); i++) {\n\t\t\tif (mapping_table_ERRSRV[i].smb_err == 0)\n\t\t\t\tbreak;\n\t\t\telse if (mapping_table_ERRSRV[i].smb_err ==\n\t\t\t\t\t\t\t\tsmberrcode) {\n\t\t\t\trc = mapping_table_ERRSRV[i].posix_code;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t \n\t\t}\n\t}\n\t \n\n\tcifs_dbg(FYI, \"Mapping smb error code 0x%x to POSIX err %d\\n\",\n\t\t le32_to_cpu(smb->Status.CifsError), rc);\n\n\t \n\n\treturn rc;\n}\n\nint\nmap_and_check_smb_error(struct mid_q_entry *mid, bool logErr)\n{\n\tint rc;\n\tstruct smb_hdr *smb = (struct smb_hdr *)mid->resp_buf;\n\n\trc = map_smb_to_linux_error((char *)smb, logErr);\n\tif (rc == -EACCES && !(smb->Flags2 & SMBFLG2_ERR_STATUS)) {\n\t\t \n\t\t__u8 class = smb->Status.DosError.ErrorClass;\n\t\t__u16 code = le16_to_cpu(smb->Status.DosError.Error);\n\n\t\t \n\t\tif (class == ERRSRV && code == ERRbaduid) {\n\t\t\tcifs_dbg(FYI, \"Server returned 0x%x, reconnecting session...\\n\",\n\t\t\t\tcode);\n\t\t\tcifs_signal_cifsd_for_reconnect(mid->server, false);\n\t\t}\n\t}\n\n\treturn rc;\n}\n\n\n \nunsigned int\nsmbCalcSize(void *buf)\n{\n\tstruct smb_hdr *ptr = buf;\n\treturn (sizeof(struct smb_hdr) + (2 * ptr->WordCount) +\n\t\t2   + get_bcc(ptr));\n}\n\n \n\n#define NTFS_TIME_OFFSET ((u64)(369*365 + 89) * 24 * 3600 * 10000000)\n\n \nstruct timespec64\ncifs_NTtimeToUnix(__le64 ntutc)\n{\n\tstruct timespec64 ts;\n\t \n\n\t \n\ts64 t = le64_to_cpu(ntutc) - NTFS_TIME_OFFSET;\n\tu64 abs_t;\n\n\t \n\tif (t < 0) {\n\t\tabs_t = -t;\n\t\tts.tv_nsec = (time64_t)(do_div(abs_t, 10000000) * 100);\n\t\tts.tv_nsec = -ts.tv_nsec;\n\t\tts.tv_sec = -abs_t;\n\t} else {\n\t\tabs_t = t;\n\t\tts.tv_nsec = (time64_t)do_div(abs_t, 10000000) * 100;\n\t\tts.tv_sec = abs_t;\n\t}\n\n\treturn ts;\n}\n\n \nu64\ncifs_UnixTimeToNT(struct timespec64 t)\n{\n\t \n\treturn (u64) t.tv_sec * 10000000 + t.tv_nsec/100 + NTFS_TIME_OFFSET;\n}\n\nstatic const int total_days_of_prev_months[] = {\n\t0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334\n};\n\nstruct timespec64 cnvrtDosUnixTm(__le16 le_date, __le16 le_time, int offset)\n{\n\tstruct timespec64 ts;\n\ttime64_t sec, days;\n\tint min, day, month, year;\n\tu16 date = le16_to_cpu(le_date);\n\tu16 time = le16_to_cpu(le_time);\n\tSMB_TIME *st = (SMB_TIME *)&time;\n\tSMB_DATE *sd = (SMB_DATE *)&date;\n\n\tcifs_dbg(FYI, \"date %d time %d\\n\", date, time);\n\n\tsec = 2 * st->TwoSeconds;\n\tmin = st->Minutes;\n\tif ((sec > 59) || (min > 59))\n\t\tcifs_dbg(VFS, \"Invalid time min %d sec %lld\\n\", min, sec);\n\tsec += (min * 60);\n\tsec += 60 * 60 * st->Hours;\n\tif (st->Hours > 24)\n\t\tcifs_dbg(VFS, \"Invalid hours %d\\n\", st->Hours);\n\tday = sd->Day;\n\tmonth = sd->Month;\n\tif (day < 1 || day > 31 || month < 1 || month > 12) {\n\t\tcifs_dbg(VFS, \"Invalid date, month %d day: %d\\n\", month, day);\n\t\tday = clamp(day, 1, 31);\n\t\tmonth = clamp(month, 1, 12);\n\t}\n\tmonth -= 1;\n\tdays = day + total_days_of_prev_months[month];\n\tdays += 3652;  \n\tyear = sd->Year;\n\tdays += year * 365;\n\tdays += (year/4);  \n\t \n\tif (year >= 120)   \n\t\tdays = days - 1;   \n\n\t \n\tif (year != 120)\n\t\tdays -= ((year & 0x03) == 0) && (month < 2 ? 1 : 0);\n\tsec += 24 * 60 * 60 * days;\n\n\tts.tv_sec = sec + offset;\n\n\t \n\n\tts.tv_nsec = 0;\n\treturn ts;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}