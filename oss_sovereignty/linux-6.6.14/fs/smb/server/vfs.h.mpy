{
  "module_name": "vfs.h",
  "hash_id": "9cc4a19856941e689ecc89fcf322cba8e7b39eb888c104d473594f29d9f80364",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/vfs.h",
  "human_readable_source": " \n \n\n#ifndef __KSMBD_VFS_H__\n#define __KSMBD_VFS_H__\n\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <uapi/linux/xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/unicode.h>\n\n#include \"smbacl.h\"\n#include \"xattr.h\"\n\n \nenum {\n\tDATA_STREAM\t= 1,\t \n\tDIR_STREAM\t\t \n};\n\n \n#define CREATE_TREE_CONNECTION\t\t\tcpu_to_le32(0x00000080)\n#define FILE_RESERVE_OPFILTER_LE\t\tcpu_to_le32(0x00100000)\n\n#define CREATE_OPTION_READONLY\t\t\t0x10000000\n \n#define CREATE_OPTION_SPECIAL\t\t\t0x20000000\n\nstruct ksmbd_work;\nstruct ksmbd_file;\nstruct ksmbd_conn;\n\nstruct ksmbd_dir_info {\n\tconst char\t*name;\n\tchar\t\t*wptr;\n\tchar\t\t*rptr;\n\tint\t\tname_len;\n\tint\t\tout_buf_len;\n\tint\t\tnum_entry;\n\tint\t\tdata_count;\n\tint\t\tlast_entry_offset;\n\tbool\t\thide_dot_file;\n\tint\t\tflags;\n\tint\t\tlast_entry_off_align;\n};\n\nstruct ksmbd_readdir_data {\n\tstruct dir_context\tctx;\n\tunion {\n\t\tvoid\t\t*private;\n\t\tchar\t\t*dirent;\n\t};\n\n\tunsigned int\t\tused;\n\tunsigned int\t\tdirent_count;\n\tunsigned int\t\tfile_attr;\n\tstruct unicode_map\t*um;\n};\n\n \nstruct ksmbd_kstat {\n\tstruct kstat\t\t*kstat;\n\tunsigned long long\tcreate_time;\n\t__le32\t\t\tfile_attributes;\n};\n\nint ksmbd_vfs_lock_parent(struct dentry *parent, struct dentry *child);\nvoid ksmbd_vfs_query_maximal_access(struct mnt_idmap *idmap,\n\t\t\t\t   struct dentry *dentry, __le32 *daccess);\nint ksmbd_vfs_create(struct ksmbd_work *work, const char *name, umode_t mode);\nint ksmbd_vfs_mkdir(struct ksmbd_work *work, const char *name, umode_t mode);\nint ksmbd_vfs_read(struct ksmbd_work *work, struct ksmbd_file *fp, size_t count,\n\t\t   loff_t *pos, char *rbuf);\nint ksmbd_vfs_write(struct ksmbd_work *work, struct ksmbd_file *fp,\n\t\t    char *buf, size_t count, loff_t *pos, bool sync,\n\t\t    ssize_t *written);\nint ksmbd_vfs_fsync(struct ksmbd_work *work, u64 fid, u64 p_id);\nint ksmbd_vfs_remove_file(struct ksmbd_work *work, const struct path *path);\nint ksmbd_vfs_link(struct ksmbd_work *work,\n\t\t   const char *oldname, const char *newname);\nint ksmbd_vfs_getattr(const struct path *path, struct kstat *stat);\nint ksmbd_vfs_rename(struct ksmbd_work *work, const struct path *old_path,\n\t\t     char *newname, int flags);\nint ksmbd_vfs_truncate(struct ksmbd_work *work,\n\t\t       struct ksmbd_file *fp, loff_t size);\nstruct srv_copychunk;\nint ksmbd_vfs_copy_file_ranges(struct ksmbd_work *work,\n\t\t\t       struct ksmbd_file *src_fp,\n\t\t\t       struct ksmbd_file *dst_fp,\n\t\t\t       struct srv_copychunk *chunks,\n\t\t\t       unsigned int chunk_count,\n\t\t\t       unsigned int *chunk_count_written,\n\t\t\t       unsigned int *chunk_size_written,\n\t\t\t       loff_t  *total_size_written);\nssize_t ksmbd_vfs_listxattr(struct dentry *dentry, char **list);\nssize_t ksmbd_vfs_getxattr(struct mnt_idmap *idmap,\n\t\t\t   struct dentry *dentry,\n\t\t\t   char *xattr_name,\n\t\t\t   char **xattr_buf);\nssize_t ksmbd_vfs_casexattr_len(struct mnt_idmap *idmap,\n\t\t\t\tstruct dentry *dentry, char *attr_name,\n\t\t\t\tint attr_name_len);\nint ksmbd_vfs_setxattr(struct mnt_idmap *idmap,\n\t\t       const struct path *path, const char *attr_name,\n\t\t       void *attr_value, size_t attr_size, int flags,\n\t\t       bool get_write);\nint ksmbd_vfs_xattr_stream_name(char *stream_name, char **xattr_stream_name,\n\t\t\t\tsize_t *xattr_stream_name_size, int s_type);\nint ksmbd_vfs_remove_xattr(struct mnt_idmap *idmap,\n\t\t\t   const struct path *path, char *attr_name);\nint ksmbd_vfs_kern_path_locked(struct ksmbd_work *work, char *name,\n\t\t\t       unsigned int flags, struct path *parent_path,\n\t\t\t       struct path *path, bool caseless);\nvoid ksmbd_vfs_kern_path_unlock(struct path *parent_path, struct path *path);\nstruct dentry *ksmbd_vfs_kern_path_create(struct ksmbd_work *work,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  unsigned int flags,\n\t\t\t\t\t  struct path *path);\nint ksmbd_vfs_empty_dir(struct ksmbd_file *fp);\nvoid ksmbd_vfs_set_fadvise(struct file *filp, __le32 option);\nint ksmbd_vfs_zero_data(struct ksmbd_work *work, struct ksmbd_file *fp,\n\t\t\tloff_t off, loff_t len);\nstruct file_allocated_range_buffer;\nint ksmbd_vfs_fqar_lseek(struct ksmbd_file *fp, loff_t start, loff_t length,\n\t\t\t struct file_allocated_range_buffer *ranges,\n\t\t\t unsigned int in_count, unsigned int *out_count);\nint ksmbd_vfs_unlink(struct file *filp);\nvoid *ksmbd_vfs_init_kstat(char **p, struct ksmbd_kstat *ksmbd_kstat);\nint ksmbd_vfs_fill_dentry_attrs(struct ksmbd_work *work,\n\t\t\t\tstruct mnt_idmap *idmap,\n\t\t\t\tstruct dentry *dentry,\n\t\t\t\tstruct ksmbd_kstat *ksmbd_kstat);\nvoid ksmbd_vfs_posix_lock_wait(struct file_lock *flock);\nint ksmbd_vfs_posix_lock_wait_timeout(struct file_lock *flock, long timeout);\nvoid ksmbd_vfs_posix_lock_unblock(struct file_lock *flock);\nint ksmbd_vfs_remove_acl_xattrs(struct mnt_idmap *idmap,\n\t\t\t\tconst struct path *path);\nint ksmbd_vfs_remove_sd_xattrs(struct mnt_idmap *idmap, const struct path *path);\nint ksmbd_vfs_set_sd_xattr(struct ksmbd_conn *conn,\n\t\t\t   struct mnt_idmap *idmap,\n\t\t\t   const struct path *path,\n\t\t\t   struct smb_ntsd *pntsd, int len,\n\t\t\t   bool get_write);\nint ksmbd_vfs_get_sd_xattr(struct ksmbd_conn *conn,\n\t\t\t   struct mnt_idmap *idmap,\n\t\t\t   struct dentry *dentry,\n\t\t\t   struct smb_ntsd **pntsd);\nint ksmbd_vfs_set_dos_attrib_xattr(struct mnt_idmap *idmap,\n\t\t\t\t   const struct path *path,\n\t\t\t\t   struct xattr_dos_attrib *da,\n\t\t\t\t   bool get_write);\nint ksmbd_vfs_get_dos_attrib_xattr(struct mnt_idmap *idmap,\n\t\t\t\t   struct dentry *dentry,\n\t\t\t\t   struct xattr_dos_attrib *da);\nint ksmbd_vfs_set_init_posix_acl(struct mnt_idmap *idmap,\n\t\t\t\t struct path *path);\nint ksmbd_vfs_inherit_posix_acl(struct mnt_idmap *idmap,\n\t\t\t\tstruct path *path,\n\t\t\t\tstruct inode *parent_inode);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}