{
  "module_name": "smb2pdu.h",
  "hash_id": "771509729fec1ce10a382e208c5b329a0a96f2494895aa7959fe2498e8df6c3a",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/smb2pdu.h",
  "human_readable_source": " \n \n\n#ifndef _SMB2PDU_H\n#define _SMB2PDU_H\n\n#include \"ntlmssp.h\"\n#include \"smbacl.h\"\n\n \n#define FILE_SUPERSEDED                0x00000000\n#define FILE_OPENED            0x00000001\n#define FILE_CREATED           0x00000002\n#define FILE_OVERWRITTEN       0x00000003\n\n \n#define SMB2_MAX_CREDITS\t\t8192\n\n \n#define MAX_SMB2_HDR_SIZE 0x78  \n\n#define SMB21_DEFAULT_IOSIZE\t(1024 * 1024)\n#define SMB3_DEFAULT_TRANS_SIZE\t(1024 * 1024)\n#define SMB3_MIN_IOSIZE\t\t(64 * 1024)\n#define SMB3_MAX_IOSIZE\t\t(8 * 1024 * 1024)\n#define SMB3_MAX_MSGSIZE\t(4 * 4096)\n\n \n\nstruct preauth_integrity_info {\n\t \n\t__le16\t\t\tPreauth_HashId;\n\t \n\t__u8\t\t\tPreauth_HashValue[SMB2_PREAUTH_HASH_SIZE];\n};\n\n \n#ifdef CONFIG_SMB_SERVER_KERBEROS5\n \n#define OFFSET_OF_NEG_CONTEXT\t0xe0\n#else\n \n#define OFFSET_OF_NEG_CONTEXT\t0xd0\n#endif\n\n#define SMB2_SESSION_EXPIRED\t\t(0)\n#define SMB2_SESSION_IN_PROGRESS\tBIT(0)\n#define SMB2_SESSION_VALID\t\tBIT(1)\n\n#define SMB2_SESSION_TIMEOUT\t\t(10 * HZ)\n\nstruct create_durable_req_v2 {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le32 Timeout;\n\t__le32 Flags;\n\t__u8 Reserved[8];\n\t__u8 CreateGuid[16];\n} __packed;\n\nstruct create_durable_reconn_v2_req {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct {\n\t\t__u64 PersistentFileId;\n\t\t__u64 VolatileFileId;\n\t} Fid;\n\t__u8 CreateGuid[16];\n\t__le32 Flags;\n} __packed;\n\nstruct create_alloc_size_req {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le64 AllocationSize;\n} __packed;\n\nstruct create_durable_rsp {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tunion {\n\t\t__u8  Reserved[8];\n\t\t__u64 data;\n\t} Data;\n} __packed;\n\nstruct create_durable_v2_rsp {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le32 Timeout;\n\t__le32 Flags;\n} __packed;\n\n \nstruct create_posix_rsp {\n\tstruct create_context ccontext;\n\t__u8    Name[16];\n\t__le32 nlink;\n\t__le32 reparse_tag;\n\t__le32 mode;\n\t \n\tu8 SidBuffer[44];\n} __packed;\n\nstruct smb2_buffer_desc_v1 {\n\t__le64 offset;\n\t__le32 token;\n\t__le32 length;\n} __packed;\n\n#define SMB2_0_IOCTL_IS_FSCTL 0x00000001\n\nstruct smb_sockaddr_in {\n\t__be16 Port;\n\t__be32 IPv4address;\n\t__u8 Reserved[8];\n} __packed;\n\nstruct smb_sockaddr_in6 {\n\t__be16 Port;\n\t__be32 FlowInfo;\n\t__u8 IPv6address[16];\n\t__be32 ScopeId;\n} __packed;\n\n#define INTERNETWORK\t0x0002\n#define INTERNETWORKV6\t0x0017\n\nstruct sockaddr_storage_rsp {\n\t__le16 Family;\n\tunion {\n\t\tstruct smb_sockaddr_in addr4;\n\t\tstruct smb_sockaddr_in6 addr6;\n\t};\n} __packed;\n\n#define RSS_CAPABLE\t0x00000001\n#define RDMA_CAPABLE\t0x00000002\n\nstruct network_interface_info_ioctl_rsp {\n\t__le32 Next;  \n\t__le32 IfIndex;\n\t__le32 Capability;  \n\t__le32 Reserved;\n\t__le64 LinkSpeed;\n\tchar\tSockAddr_Storage[128];\n} __packed;\n\nstruct file_object_buf_type1_ioctl_rsp {\n\t__u8 ObjectId[16];\n\t__u8 BirthVolumeId[16];\n\t__u8 BirthObjectId[16];\n\t__u8 DomainId[16];\n} __packed;\n\nstruct resume_key_ioctl_rsp {\n\t__u64 ResumeKey[3];\n\t__le32 ContextLength;\n\t__u8 Context[4];  \n} __packed;\n\nstruct copychunk_ioctl_req {\n\t__le64 ResumeKey[3];\n\t__le32 ChunkCount;\n\t__le32 Reserved;\n\t__u8 Chunks[1];  \n} __packed;\n\nstruct srv_copychunk {\n\t__le64 SourceOffset;\n\t__le64 TargetOffset;\n\t__le32 Length;\n\t__le32 Reserved;\n} __packed;\n\nstruct copychunk_ioctl_rsp {\n\t__le32 ChunksWritten;\n\t__le32 ChunkBytesWritten;\n\t__le32 TotalBytesWritten;\n} __packed;\n\nstruct file_sparse {\n\t__u8\tSetSparse;\n} __packed;\n\n \n#define FILE_DIRECTORY_INFORMATION_SIZE       1\n#define FILE_FULL_DIRECTORY_INFORMATION_SIZE  2\n#define FILE_BOTH_DIRECTORY_INFORMATION_SIZE  3\n#define FILE_BASIC_INFORMATION_SIZE           40\n#define FILE_STANDARD_INFORMATION_SIZE        24\n#define FILE_INTERNAL_INFORMATION_SIZE        8\n#define FILE_EA_INFORMATION_SIZE              4\n#define FILE_ACCESS_INFORMATION_SIZE          4\n#define FILE_NAME_INFORMATION_SIZE            9\n#define FILE_RENAME_INFORMATION_SIZE          10\n#define FILE_LINK_INFORMATION_SIZE            11\n#define FILE_NAMES_INFORMATION_SIZE           12\n#define FILE_DISPOSITION_INFORMATION_SIZE     13\n#define FILE_POSITION_INFORMATION_SIZE        14\n#define FILE_FULL_EA_INFORMATION_SIZE         15\n#define FILE_MODE_INFORMATION_SIZE            4\n#define FILE_ALIGNMENT_INFORMATION_SIZE       4\n#define FILE_ALL_INFORMATION_SIZE             104\n#define FILE_ALLOCATION_INFORMATION_SIZE      19\n#define FILE_END_OF_FILE_INFORMATION_SIZE     20\n#define FILE_ALTERNATE_NAME_INFORMATION_SIZE  8\n#define FILE_STREAM_INFORMATION_SIZE          32\n#define FILE_PIPE_INFORMATION_SIZE            23\n#define FILE_PIPE_LOCAL_INFORMATION_SIZE      24\n#define FILE_PIPE_REMOTE_INFORMATION_SIZE     25\n#define FILE_MAILSLOT_QUERY_INFORMATION_SIZE  26\n#define FILE_MAILSLOT_SET_INFORMATION_SIZE    27\n#define FILE_COMPRESSION_INFORMATION_SIZE     16\n#define FILE_OBJECT_ID_INFORMATION_SIZE       29\n \n#define FILE_MOVE_CLUSTER_INFORMATION_SIZE    31\n#define FILE_QUOTA_INFORMATION_SIZE           32\n#define FILE_REPARSE_POINT_INFORMATION_SIZE   33\n#define FILE_NETWORK_OPEN_INFORMATION_SIZE    56\n#define FILE_ATTRIBUTE_TAG_INFORMATION_SIZE   8\n\n \n#define FS_DEVICE_INFORMATION_SIZE     8\n#define FS_ATTRIBUTE_INFORMATION_SIZE  16\n#define FS_VOLUME_INFORMATION_SIZE     24\n#define FS_SIZE_INFORMATION_SIZE       24\n#define FS_FULL_SIZE_INFORMATION_SIZE  32\n#define FS_SECTOR_SIZE_INFORMATION_SIZE 28\n#define FS_OBJECT_ID_INFORMATION_SIZE 64\n#define FS_CONTROL_INFORMATION_SIZE 48\n#define FS_POSIX_INFORMATION_SIZE 56\n\n \n#define FS_TYPE_SUPPORT_SIZE   44\nstruct fs_type_info {\n\tchar\t\t*fs_name;\n\tlong\t\tmagic_number;\n} __packed;\n\n \n\nstruct smb2_file_access_info {\n\t__le32 AccessFlags;\n} __packed;\n\nstruct smb2_file_alignment_info {\n\t__le32 AlignmentRequirement;\n} __packed;\n\nstruct smb2_file_basic_info {  \n\t__le64 CreationTime;\t \n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le32 Attributes;\n\t__u32  Pad1;\t\t \n} __packed;\n\nstruct smb2_file_alt_name_info {\n\t__le32 FileNameLength;\n\tchar FileName[];\n} __packed;\n\nstruct smb2_file_stream_info {\n\t__le32  NextEntryOffset;\n\t__le32  StreamNameLength;\n\t__le64 StreamSize;\n\t__le64 StreamAllocationSize;\n\tchar   StreamName[];\n} __packed;\n\nstruct smb2_file_ntwrk_info {\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\n\t__le32 Attributes;\n\t__le32 Reserved;\n} __packed;\n\nstruct smb2_file_standard_info {\n\t__le64 AllocationSize;\n\t__le64 EndOfFile;\n\t__le32 NumberOfLinks;\t \n\t__u8   DeletePending;\n\t__u8   Directory;\n\t__le16 Reserved;\n} __packed;  \n\nstruct smb2_file_ea_info {\n\t__le32 EASize;\n} __packed;\n\nstruct smb2_file_alloc_info {\n\t__le64 AllocationSize;\n} __packed;\n\nstruct smb2_file_disposition_info {\n\t__u8 DeletePending;\n} __packed;\n\nstruct smb2_file_pos_info {\n\t__le64 CurrentByteOffset;\n} __packed;\n\n#define FILE_MODE_INFO_MASK cpu_to_le32(0x0000100e)\n\nstruct smb2_file_mode_info {\n\t__le32 Mode;\n} __packed;\n\n#define COMPRESSION_FORMAT_NONE 0x0000\n#define COMPRESSION_FORMAT_LZNT1 0x0002\n\nstruct smb2_file_comp_info {\n\t__le64 CompressedFileSize;\n\t__le16 CompressionFormat;\n\t__u8 CompressionUnitShift;\n\t__u8 ChunkShift;\n\t__u8 ClusterShift;\n\t__u8 Reserved[3];\n} __packed;\n\nstruct smb2_file_attr_tag_info {\n\t__le32 FileAttributes;\n\t__le32 ReparseTag;\n} __packed;\n\n#define SL_RESTART_SCAN\t0x00000001\n#define SL_RETURN_SINGLE_ENTRY\t0x00000002\n#define SL_INDEX_SPECIFIED\t0x00000004\n\nstruct smb2_ea_info_req {\n\t__le32 NextEntryOffset;\n\t__u8   EaNameLength;\n\tchar name[1];\n} __packed;  \n\nstruct smb2_ea_info {\n\t__le32 NextEntryOffset;\n\t__u8   Flags;\n\t__u8   EaNameLength;\n\t__le16 EaValueLength;\n\tchar name[];\n\t \n} __packed;  \n\nstruct create_ea_buf_req {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct smb2_ea_info ea;\n} __packed;\n\nstruct create_sd_buf_req {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct smb_ntsd ntsd;\n} __packed;\n\nstruct smb2_posix_info {\n\t__le32 NextEntryOffset;\n\t__u32 Ignored;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 DosAttributes;\n\t__le64 Inode;\n\t__le32 DeviceId;\n\t__le32 Zero;\n\t \n\t__le32 HardLinks;\n\t__le32 ReparseTag;\n\t__le32 Mode;\n\t \n\tu8 SidBuffer[32];\n\t__le32 name_len;\n\tu8 name[];\n\t \n} __packed;\n\n \nvoid init_smb2_1_server(struct ksmbd_conn *conn);\nvoid init_smb3_0_server(struct ksmbd_conn *conn);\nvoid init_smb3_02_server(struct ksmbd_conn *conn);\nint init_smb3_11_server(struct ksmbd_conn *conn);\n\nvoid init_smb2_max_read_size(unsigned int sz);\nvoid init_smb2_max_write_size(unsigned int sz);\nvoid init_smb2_max_trans_size(unsigned int sz);\nvoid init_smb2_max_credits(unsigned int sz);\n\nbool is_smb2_neg_cmd(struct ksmbd_work *work);\nbool is_smb2_rsp(struct ksmbd_work *work);\n\nu16 get_smb2_cmd_val(struct ksmbd_work *work);\nvoid set_smb2_rsp_status(struct ksmbd_work *work, __le32 err);\nint init_smb2_rsp_hdr(struct ksmbd_work *work);\nint smb2_allocate_rsp_buf(struct ksmbd_work *work);\nbool is_chained_smb2_message(struct ksmbd_work *work);\nint init_smb2_neg_rsp(struct ksmbd_work *work);\nvoid smb2_set_err_rsp(struct ksmbd_work *work);\nint smb2_check_user_session(struct ksmbd_work *work);\nint smb2_get_ksmbd_tcon(struct ksmbd_work *work);\nbool smb2_is_sign_req(struct ksmbd_work *work, unsigned int command);\nint smb2_check_sign_req(struct ksmbd_work *work);\nvoid smb2_set_sign_rsp(struct ksmbd_work *work);\nint smb3_check_sign_req(struct ksmbd_work *work);\nvoid smb3_set_sign_rsp(struct ksmbd_work *work);\nint find_matching_smb2_dialect(int start_index, __le16 *cli_dialects,\n\t\t\t       __le16 dialects_count);\nstruct file_lock *smb_flock_init(struct file *f);\nint setup_async_work(struct ksmbd_work *work, void (*fn)(void **),\n\t\t     void **arg);\nvoid release_async_work(struct ksmbd_work *work);\nvoid smb2_send_interim_resp(struct ksmbd_work *work, __le32 status);\nstruct channel *lookup_chann_list(struct ksmbd_session *sess,\n\t\t\t\t  struct ksmbd_conn *conn);\nvoid smb3_preauth_hash_rsp(struct ksmbd_work *work);\nbool smb3_is_transform_hdr(void *buf);\nint smb3_decrypt_req(struct ksmbd_work *work);\nint smb3_encrypt_resp(struct ksmbd_work *work);\nbool smb3_11_final_sess_setup_resp(struct ksmbd_work *work);\nint smb2_set_rsp_credits(struct ksmbd_work *work);\nbool smb3_encryption_negotiated(struct ksmbd_conn *conn);\n\n \nint ksmbd_smb2_check_message(struct ksmbd_work *work);\n\n \nint smb2_handle_negotiate(struct ksmbd_work *work);\nint smb2_negotiate_request(struct ksmbd_work *work);\nint smb2_sess_setup(struct ksmbd_work *work);\nint smb2_tree_connect(struct ksmbd_work *work);\nint smb2_tree_disconnect(struct ksmbd_work *work);\nint smb2_session_logoff(struct ksmbd_work *work);\nint smb2_open(struct ksmbd_work *work);\nint smb2_query_info(struct ksmbd_work *work);\nint smb2_query_dir(struct ksmbd_work *work);\nint smb2_close(struct ksmbd_work *work);\nint smb2_echo(struct ksmbd_work *work);\nint smb2_set_info(struct ksmbd_work *work);\nint smb2_read(struct ksmbd_work *work);\nint smb2_write(struct ksmbd_work *work);\nint smb2_flush(struct ksmbd_work *work);\nint smb2_cancel(struct ksmbd_work *work);\nint smb2_lock(struct ksmbd_work *work);\nint smb2_ioctl(struct ksmbd_work *work);\nint smb2_oplock_break(struct ksmbd_work *work);\nint smb2_notify(struct ksmbd_work *ksmbd_work);\n\n \nstatic inline void *smb2_get_msg(void *buf)\n{\n\treturn buf + 4;\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}