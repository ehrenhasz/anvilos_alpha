{
  "module_name": "auth.h",
  "hash_id": "8a214bef0cb080a920e11f346baf8e8799e5050b4f24e6d130901afdbfd06b7b",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/auth.h",
  "human_readable_source": " \n \n\n#ifndef __AUTH_H__\n#define __AUTH_H__\n\n#include \"ntlmssp.h\"\n\n#ifdef CONFIG_SMB_SERVER_KERBEROS5\n#define AUTH_GSS_LENGTH\t\t96\n#define AUTH_GSS_PADDING\t0\n#else\n#define AUTH_GSS_LENGTH\t\t74\n#define AUTH_GSS_PADDING\t6\n#endif\n\n#define CIFS_HMAC_MD5_HASH_SIZE\t(16)\n#define CIFS_NTHASH_SIZE\t(16)\n\n \n#define CIFS_AUTH_RESP_SIZE\t\t24\n#define CIFS_SMB1_SIGNATURE_SIZE\t8\n#define CIFS_SMB1_SESSKEY_SIZE\t\t16\n\n#define KSMBD_AUTH_NTLMSSP\t0x0001\n#define KSMBD_AUTH_KRB5\t\t0x0002\n#define KSMBD_AUTH_MSKRB5\t0x0004\n#define KSMBD_AUTH_KRB5U2U\t0x0008\n\nstruct ksmbd_session;\nstruct ksmbd_conn;\nstruct ksmbd_work;\nstruct kvec;\n\nint ksmbd_crypt_message(struct ksmbd_work *work, struct kvec *iov,\n\t\t\tunsigned int nvec, int enc);\nvoid ksmbd_copy_gss_neg_header(void *buf);\nint ksmbd_auth_ntlmv2(struct ksmbd_conn *conn, struct ksmbd_session *sess,\n\t\t      struct ntlmv2_resp *ntlmv2, int blen, char *domain_name,\n\t\t      char *cryptkey);\nint ksmbd_decode_ntlmssp_auth_blob(struct authenticate_message *authblob,\n\t\t\t\t   int blob_len, struct ksmbd_conn *conn,\n\t\t\t\t   struct ksmbd_session *sess);\nint ksmbd_decode_ntlmssp_neg_blob(struct negotiate_message *negblob,\n\t\t\t\t  int blob_len, struct ksmbd_conn *conn);\nunsigned int\nksmbd_build_ntlmssp_challenge_blob(struct challenge_message *chgblob,\n\t\t\t\t   struct ksmbd_conn *conn);\nint ksmbd_krb5_authenticate(struct ksmbd_session *sess, char *in_blob,\n\t\t\t    int in_len,\tchar *out_blob, int *out_len);\nint ksmbd_sign_smb2_pdu(struct ksmbd_conn *conn, char *key, struct kvec *iov,\n\t\t\tint n_vec, char *sig);\nint ksmbd_sign_smb3_pdu(struct ksmbd_conn *conn, char *key, struct kvec *iov,\n\t\t\tint n_vec, char *sig);\nint ksmbd_gen_smb30_signingkey(struct ksmbd_session *sess,\n\t\t\t       struct ksmbd_conn *conn);\nint ksmbd_gen_smb311_signingkey(struct ksmbd_session *sess,\n\t\t\t\tstruct ksmbd_conn *conn);\nint ksmbd_gen_smb30_encryptionkey(struct ksmbd_conn *conn,\n\t\t\t\t  struct ksmbd_session *sess);\nint ksmbd_gen_smb311_encryptionkey(struct ksmbd_conn *conn,\n\t\t\t\t   struct ksmbd_session *sess);\nint ksmbd_gen_preauth_integrity_hash(struct ksmbd_conn *conn, char *buf,\n\t\t\t\t     __u8 *pi_hash);\nint ksmbd_gen_sd_hash(struct ksmbd_conn *conn, char *sd_buf, int len,\n\t\t      __u8 *pi_hash);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}