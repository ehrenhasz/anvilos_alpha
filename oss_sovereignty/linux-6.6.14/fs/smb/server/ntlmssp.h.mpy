{
  "module_name": "ntlmssp.h",
  "hash_id": "b268261866ef91c1a3cf27fa3b31a4013fd809e9f2635607ac08bfd148f44e5f",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/ntlmssp.h",
  "human_readable_source": " \n \n\n#ifndef __KSMBD_NTLMSSP_H\n#define __KSMBD_NTLMSSP_H\n\n#define NTLMSSP_SIGNATURE \"NTLMSSP\"\n\n \n#define TGT_Name        \"KSMBD\"\n\n \n#define CIFS_CRYPTO_KEY_SIZE\t(8)\n#define CIFS_KEY_SIZE\t(40)\n\n \n#define CIFS_ENCPWD_SIZE\t(16)\n#define CIFS_CPHTXT_SIZE\t(16)\n\n \n#define NtLmNegotiate     cpu_to_le32(1)\n#define NtLmChallenge     cpu_to_le32(2)\n#define NtLmAuthenticate  cpu_to_le32(3)\n#define UnknownMessage    cpu_to_le32(8)\n\n \n#define NTLMSSP_NEGOTIATE_UNICODE         0x01  \n#define NTLMSSP_NEGOTIATE_OEM             0x02  \n#define NTLMSSP_REQUEST_TARGET            0x04  \n \n#define NTLMSSP_NEGOTIATE_SIGN          0x0010  \n#define NTLMSSP_NEGOTIATE_SEAL          0x0020  \n#define NTLMSSP_NEGOTIATE_DGRAM         0x0040\n#define NTLMSSP_NEGOTIATE_LM_KEY        0x0080  \n \n#define NTLMSSP_NEGOTIATE_NTLM          0x0200  \n#define NTLMSSP_NEGOTIATE_NT_ONLY       0x0400  \n#define NTLMSSP_ANONYMOUS               0x0800\n#define NTLMSSP_NEGOTIATE_DOMAIN_SUPPLIED 0x1000  \n#define NTLMSSP_NEGOTIATE_WORKSTATION_SUPPLIED 0x2000\n#define NTLMSSP_NEGOTIATE_LOCAL_CALL    0x4000  \n#define NTLMSSP_NEGOTIATE_ALWAYS_SIGN   0x8000  \n#define NTLMSSP_TARGET_TYPE_DOMAIN     0x10000\n#define NTLMSSP_TARGET_TYPE_SERVER     0x20000\n#define NTLMSSP_TARGET_TYPE_SHARE      0x40000\n#define NTLMSSP_NEGOTIATE_EXTENDED_SEC 0x80000  \n \n#define NTLMSSP_NEGOTIATE_IDENTIFY    0x100000\n#define NTLMSSP_REQUEST_ACCEPT_RESP   0x200000  \n#define NTLMSSP_REQUEST_NON_NT_KEY    0x400000\n#define NTLMSSP_NEGOTIATE_TARGET_INFO 0x800000\n \n#define NTLMSSP_NEGOTIATE_VERSION    0x2000000  \n \n \n \n#define NTLMSSP_NEGOTIATE_128       0x20000000\n#define NTLMSSP_NEGOTIATE_KEY_XCH   0x40000000\n#define NTLMSSP_NEGOTIATE_56        0x80000000\n\n \nenum av_field_type {\n\tNTLMSSP_AV_EOL = 0,\n\tNTLMSSP_AV_NB_COMPUTER_NAME,\n\tNTLMSSP_AV_NB_DOMAIN_NAME,\n\tNTLMSSP_AV_DNS_COMPUTER_NAME,\n\tNTLMSSP_AV_DNS_DOMAIN_NAME,\n\tNTLMSSP_AV_DNS_TREE_NAME,\n\tNTLMSSP_AV_FLAGS,\n\tNTLMSSP_AV_TIMESTAMP,\n\tNTLMSSP_AV_RESTRICTION,\n\tNTLMSSP_AV_TARGET_NAME,\n\tNTLMSSP_AV_CHANNEL_BINDINGS\n};\n\n \n \n \n \n \n\nstruct security_buffer {\n\t__le16 Length;\n\t__le16 MaximumLength;\n\t__le32 BufferOffset;\t \n} __packed;\n\nstruct target_info {\n\t__le16 Type;\n\t__le16 Length;\n\t__u8 Content[];\n} __packed;\n\nstruct negotiate_message {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;      \n\t__le32 NegotiateFlags;\n\tstruct security_buffer DomainName;\t \n\tstruct security_buffer WorkstationName;\t \n\t \n\tchar DomainString[];\n\t \n} __packed;\n\nstruct challenge_message {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;    \n\tstruct security_buffer TargetName;\n\t__le32 NegotiateFlags;\n\t__u8 Challenge[CIFS_CRYPTO_KEY_SIZE];\n\t__u8 Reserved[8];\n\tstruct security_buffer TargetInfoArray;\n\t \n} __packed;\n\nstruct authenticate_message {\n\t__u8 Signature[sizeof(NTLMSSP_SIGNATURE)];\n\t__le32 MessageType;   \n\tstruct security_buffer LmChallengeResponse;\n\tstruct security_buffer NtChallengeResponse;\n\tstruct security_buffer DomainName;\n\tstruct security_buffer UserName;\n\tstruct security_buffer WorkstationName;\n\tstruct security_buffer SessionKey;\n\t__le32 NegotiateFlags;\n\t \n\tchar UserString[];\n} __packed;\n\nstruct ntlmv2_resp {\n\tchar ntlmv2_hash[CIFS_ENCPWD_SIZE];\n\t__le32 blob_signature;\n\t__u32  reserved;\n\t__le64  time;\n\t__u64  client_chal;  \n\t__u32  reserved2;\n\t \n} __packed;\n\n \nstruct ntlmssp_auth {\n\t \n\tbool\t\tsesskey_per_smbsess;\n\t \n\t__u32\t\tclient_flags;\n\t \n\t__u32\t\tconn_flags;\n\t \n\tunsigned char\tciphertext[CIFS_CPHTXT_SIZE];\n\t \n\tchar\t\tcryptkey[CIFS_CRYPTO_KEY_SIZE];\n};\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}