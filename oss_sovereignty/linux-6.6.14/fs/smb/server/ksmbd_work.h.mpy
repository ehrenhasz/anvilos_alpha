{
  "module_name": "ksmbd_work.h",
  "hash_id": "48af6f8a1fc62f516994fc225718cd0aebd9f70d97e883ee78fa9b81c13917df",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/ksmbd_work.h",
  "human_readable_source": " \n \n\n#ifndef __KSMBD_WORK_H__\n#define __KSMBD_WORK_H__\n\n#include <linux/ctype.h>\n#include <linux/workqueue.h>\n\nstruct ksmbd_conn;\nstruct ksmbd_session;\nstruct ksmbd_tree_connect;\n\nenum {\n\tKSMBD_WORK_ACTIVE = 0,\n\tKSMBD_WORK_CANCELLED,\n\tKSMBD_WORK_CLOSED,\n};\n\nstruct aux_read {\n\tvoid *buf;\n\tstruct list_head entry;\n};\n\n \nstruct ksmbd_work {\n\t \n\tstruct ksmbd_conn               *conn;\n\tstruct ksmbd_session            *sess;\n\tstruct ksmbd_tree_connect       *tcon;\n\n\t \n\tvoid                            *request_buf;\n\t \n\tvoid                            *response_buf;\n\n\tstruct list_head\t\taux_read_list;\n\n\tstruct kvec\t\t\t*iov;\n\tint\t\t\t\tiov_alloc_cnt;\n\tint\t\t\t\tiov_cnt;\n\tint\t\t\t\tiov_idx;\n\n\t \n\tint                             next_smb2_rcv_hdr_off;\n\t \n\tint                             next_smb2_rsp_hdr_off;\n\t \n\tint                             curr_smb2_rsp_hdr_off;\n\n\t \n\tu64\t\t\t\tcompound_fid;\n\tu64\t\t\t\tcompound_pfid;\n\tu64\t\t\t\tcompound_sid;\n\n\tconst struct cred\t\t*saved_cred;\n\n\t \n\tunsigned int\t\t\tcredits_granted;\n\n\t \n\tunsigned int                    response_sz;\n\n\tvoid\t\t\t\t*tr_buf;\n\n\tunsigned char\t\t\tstate;\n\t \n\tbool                            send_no_response:1;\n\t \n\tbool                            encrypted:1;\n\t \n\tbool                            asynchronous:1;\n\tbool                            need_invalidate_rkey:1;\n\n\tunsigned int                    remote_key;\n\t \n\tint                             async_id;\n\tvoid                            **cancel_argv;\n\tvoid                            (*cancel_fn)(void **argv);\n\n\tstruct work_struct              work;\n\t \n\tstruct list_head                request_entry;\n\t \n\tstruct list_head                async_request_entry;\n\tstruct list_head                fp_entry;\n\tstruct list_head                interim_entry;\n};\n\n \nstatic inline void *ksmbd_resp_buf_next(struct ksmbd_work *work)\n{\n\treturn work->response_buf + work->next_smb2_rsp_hdr_off + 4;\n}\n\n \nstatic inline void *ksmbd_resp_buf_curr(struct ksmbd_work *work)\n{\n\treturn work->response_buf + work->curr_smb2_rsp_hdr_off + 4;\n}\n\n \nstatic inline void *ksmbd_req_buf_next(struct ksmbd_work *work)\n{\n\treturn work->request_buf + work->next_smb2_rcv_hdr_off + 4;\n}\n\nstruct ksmbd_work *ksmbd_alloc_work_struct(void);\nvoid ksmbd_free_work_struct(struct ksmbd_work *work);\n\nvoid ksmbd_work_pool_destroy(void);\nint ksmbd_work_pool_init(void);\n\nint ksmbd_workqueue_init(void);\nvoid ksmbd_workqueue_destroy(void);\nbool ksmbd_queue_work(struct ksmbd_work *work);\nint ksmbd_iov_pin_rsp_read(struct ksmbd_work *work, void *ib, int len,\n\t\t\t   void *aux_buf, unsigned int aux_size);\nint ksmbd_iov_pin_rsp(struct ksmbd_work *work, void *ib, int len);\nint allocate_interim_rsp_buf(struct ksmbd_work *work);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}