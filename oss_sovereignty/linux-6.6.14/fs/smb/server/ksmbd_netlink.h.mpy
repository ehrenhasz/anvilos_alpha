{
  "module_name": "ksmbd_netlink.h",
  "hash_id": "fd254247cc8e926d102edd99d7f536cbf76508194c8b4692013412af6643aa49",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/ksmbd_netlink.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_KSMBD_SERVER_H\n#define _LINUX_KSMBD_SERVER_H\n\n#include <linux/types.h>\n\n \n\n#define KSMBD_GENL_NAME\t\t\"SMBD_GENL\"\n#define KSMBD_GENL_VERSION\t\t0x01\n\n#define KSMBD_REQ_MAX_ACCOUNT_NAME_SZ\t48\n#define KSMBD_REQ_MAX_HASH_SZ\t\t18\n#define KSMBD_REQ_MAX_SHARE_NAME\t64\n\n \nstruct ksmbd_heartbeat {\n\t__u32\thandle;\n};\n\n \n#define KSMBD_GLOBAL_FLAG_INVALID\t\t(0)\n#define KSMBD_GLOBAL_FLAG_SMB2_LEASES\t\tBIT(0)\n#define KSMBD_GLOBAL_FLAG_SMB2_ENCRYPTION\tBIT(1)\n#define KSMBD_GLOBAL_FLAG_SMB3_MULTICHANNEL\tBIT(2)\n#define KSMBD_GLOBAL_FLAG_SMB2_ENCRYPTION_OFF\tBIT(3)\n\n \nstruct ksmbd_startup_request {\n\t__u32\tflags;\t\t\t \n\t__s32\tsigning;\t\t \n\t__s8\tmin_prot[16];\t\t \n\t__s8\tmax_prot[16];\t\t \n\t__s8\tnetbios_name[16];\n\t__s8\twork_group[64];\t\t \n\t__s8\tserver_string[64];\t \n\t__u16\ttcp_port;\t\t \n\t__u16\tipc_timeout;\t\t \n\t__u32\tdeadtime;\t\t \n\t__u32\tfile_max;\t\t \n\t__u32\tsmb2_max_write;\t\t \n\t__u32\tsmb2_max_read;\t\t \n\t__u32\tsmb2_max_trans;\t\t \n\t__u32\tshare_fake_fscaps;\t \n\t__u32\tsub_auth[3];\t\t \n\t__u32\tsmb2_max_credits;\t \n\t__u32\tsmbd_max_io_size;\t \n\t__u32\tmax_connections;\t \n\t__u32\treserved[126];\t\t \n\t__u32\tifc_list_sz;\t\t \n\t__s8\t____payload[];\n};\n\n#define KSMBD_STARTUP_CONFIG_INTERFACES(s)\t((s)->____payload)\n\n \nstruct ksmbd_shutdown_request {\n\t__s32\treserved[16];\n};\n\n \nstruct ksmbd_login_request {\n\t__u32\thandle;\n\t__s8\taccount[KSMBD_REQ_MAX_ACCOUNT_NAME_SZ];  \n\t__u32\treserved[16];\t\t\t\t \n};\n\n \nstruct ksmbd_login_response {\n\t__u32\thandle;\n\t__u32\tgid;\t\t\t\t\t \n\t__u32\tuid;\t\t\t\t\t \n\t__s8\taccount[KSMBD_REQ_MAX_ACCOUNT_NAME_SZ];  \n\t__u16\tstatus;\n\t__u16\thash_sz;\t\t\t \n\t__s8\thash[KSMBD_REQ_MAX_HASH_SZ];\t \n\t__u32\treserved[16];\t\t\t \n};\n\n \nstruct ksmbd_share_config_request {\n\t__u32\thandle;\n\t__s8\tshare_name[KSMBD_REQ_MAX_SHARE_NAME];  \n\t__u32\treserved[16];\t\t \n};\n\n \nstruct ksmbd_share_config_response {\n\t__u32\thandle;\n\t__u32\tflags;\n\t__u16\tcreate_mask;\n\t__u16\tdirectory_mask;\n\t__u16\tforce_create_mode;\n\t__u16\tforce_directory_mode;\n\t__u16\tforce_uid;\n\t__u16\tforce_gid;\n\t__s8\tshare_name[KSMBD_REQ_MAX_SHARE_NAME];\n\t__u32\treserved[112];\t\t \n\t__u32\tveto_list_sz;\n\t__s8\t____payload[];\n};\n\n#define KSMBD_SHARE_CONFIG_VETO_LIST(s)\t((s)->____payload)\n\nstatic inline char *\nksmbd_share_config_path(struct ksmbd_share_config_response *sc)\n{\n\tchar *p = sc->____payload;\n\n\tif (sc->veto_list_sz)\n\t\tp += sc->veto_list_sz + 1;\n\n\treturn p;\n}\n\n \nstruct ksmbd_tree_connect_request {\n\t__u32\thandle;\n\t__u16\taccount_flags;\n\t__u16\tflags;\n\t__u64\tsession_id;\n\t__u64\tconnect_id;\n\t__s8\taccount[KSMBD_REQ_MAX_ACCOUNT_NAME_SZ];\n\t__s8\tshare[KSMBD_REQ_MAX_SHARE_NAME];\n\t__s8\tpeer_addr[64];\n\t__u32\treserved[16];\t\t \n};\n\n \nstruct ksmbd_tree_connect_response {\n\t__u32\thandle;\n\t__u16\tstatus;\n\t__u16\tconnection_flags;\n\t__u32\treserved[16];\t\t \n};\n\n \nstruct ksmbd_tree_disconnect_request {\n\t__u64\tsession_id;\t \n\t__u64\tconnect_id;\t \n\t__u32\treserved[16];\t \n};\n\n \nstruct ksmbd_logout_request {\n\t__s8\taccount[KSMBD_REQ_MAX_ACCOUNT_NAME_SZ];  \n\t__u32\taccount_flags;\n\t__u32\treserved[16];\t\t\t\t \n};\n\n \nstruct ksmbd_rpc_command {\n\t__u32\thandle;\n\t__u32\tflags;\n\t__u32\tpayload_sz;\n\t__u8\tpayload[];\n};\n\n \nstruct ksmbd_spnego_authen_request {\n\t__u32\thandle;\n\t__u16\tspnego_blob_len;\t \n\t__u8\tspnego_blob[];\t\t \n};\n\n \nstruct ksmbd_spnego_authen_response {\n\t__u32\thandle;\n\tstruct ksmbd_login_response login_response;  \n\t__u16\tsession_key_len;  \n\t__u16\tspnego_blob_len;  \n\t__u8\tpayload[];  \n};\n\n \nenum ksmbd_event {\n\tKSMBD_EVENT_UNSPEC\t\t\t= 0,\n\tKSMBD_EVENT_HEARTBEAT_REQUEST,\n\n\tKSMBD_EVENT_STARTING_UP,\n\tKSMBD_EVENT_SHUTTING_DOWN,\n\n\tKSMBD_EVENT_LOGIN_REQUEST,\n\tKSMBD_EVENT_LOGIN_RESPONSE\t\t= 5,\n\n\tKSMBD_EVENT_SHARE_CONFIG_REQUEST,\n\tKSMBD_EVENT_SHARE_CONFIG_RESPONSE,\n\n\tKSMBD_EVENT_TREE_CONNECT_REQUEST,\n\tKSMBD_EVENT_TREE_CONNECT_RESPONSE,\n\n\tKSMBD_EVENT_TREE_DISCONNECT_REQUEST\t= 10,\n\n\tKSMBD_EVENT_LOGOUT_REQUEST,\n\n\tKSMBD_EVENT_RPC_REQUEST,\n\tKSMBD_EVENT_RPC_RESPONSE,\n\n\tKSMBD_EVENT_SPNEGO_AUTHEN_REQUEST,\n\tKSMBD_EVENT_SPNEGO_AUTHEN_RESPONSE\t= 15,\n\n\tKSMBD_EVENT_MAX\n};\n\n \nenum KSMBD_TREE_CONN_STATUS {\n\tKSMBD_TREE_CONN_STATUS_OK\t\t= 0,\n\tKSMBD_TREE_CONN_STATUS_NOMEM,\n\tKSMBD_TREE_CONN_STATUS_NO_SHARE,\n\tKSMBD_TREE_CONN_STATUS_NO_USER,\n\tKSMBD_TREE_CONN_STATUS_INVALID_USER,\n\tKSMBD_TREE_CONN_STATUS_HOST_DENIED\t= 5,\n\tKSMBD_TREE_CONN_STATUS_CONN_EXIST,\n\tKSMBD_TREE_CONN_STATUS_TOO_MANY_CONNS,\n\tKSMBD_TREE_CONN_STATUS_TOO_MANY_SESSIONS,\n\tKSMBD_TREE_CONN_STATUS_ERROR,\n};\n\n \n#define KSMBD_USER_FLAG_INVALID\t\t(0)\n#define KSMBD_USER_FLAG_OK\t\tBIT(0)\n#define KSMBD_USER_FLAG_BAD_PASSWORD\tBIT(1)\n#define KSMBD_USER_FLAG_BAD_UID\t\tBIT(2)\n#define KSMBD_USER_FLAG_BAD_USER\tBIT(3)\n#define KSMBD_USER_FLAG_GUEST_ACCOUNT\tBIT(4)\n#define KSMBD_USER_FLAG_DELAY_SESSION\tBIT(5)\n\n \n#define KSMBD_SHARE_FLAG_INVALID\t\t(0)\n#define KSMBD_SHARE_FLAG_AVAILABLE\t\tBIT(0)\n#define KSMBD_SHARE_FLAG_BROWSEABLE\t\tBIT(1)\n#define KSMBD_SHARE_FLAG_WRITEABLE\t\tBIT(2)\n#define KSMBD_SHARE_FLAG_READONLY\t\tBIT(3)\n#define KSMBD_SHARE_FLAG_GUEST_OK\t\tBIT(4)\n#define KSMBD_SHARE_FLAG_GUEST_ONLY\t\tBIT(5)\n#define KSMBD_SHARE_FLAG_STORE_DOS_ATTRS\tBIT(6)\n#define KSMBD_SHARE_FLAG_OPLOCKS\t\tBIT(7)\n#define KSMBD_SHARE_FLAG_PIPE\t\t\tBIT(8)\n#define KSMBD_SHARE_FLAG_HIDE_DOT_FILES\t\tBIT(9)\n#define KSMBD_SHARE_FLAG_INHERIT_OWNER\t\tBIT(10)\n#define KSMBD_SHARE_FLAG_STREAMS\t\tBIT(11)\n#define KSMBD_SHARE_FLAG_FOLLOW_SYMLINKS\tBIT(12)\n#define KSMBD_SHARE_FLAG_ACL_XATTR\t\tBIT(13)\n#define KSMBD_SHARE_FLAG_UPDATE\t\t\tBIT(14)\n#define KSMBD_SHARE_FLAG_CROSSMNT\t\tBIT(15)\n\n \n#define KSMBD_TREE_CONN_FLAG_REQUEST_SMB1\t(0)\n#define KSMBD_TREE_CONN_FLAG_REQUEST_IPV6\tBIT(0)\n#define KSMBD_TREE_CONN_FLAG_REQUEST_SMB2\tBIT(1)\n\n \n#define KSMBD_TREE_CONN_FLAG_GUEST_ACCOUNT\tBIT(0)\n#define KSMBD_TREE_CONN_FLAG_READ_ONLY\t\tBIT(1)\n#define KSMBD_TREE_CONN_FLAG_WRITABLE\t\tBIT(2)\n#define KSMBD_TREE_CONN_FLAG_ADMIN_ACCOUNT\tBIT(3)\n#define KSMBD_TREE_CONN_FLAG_UPDATE\t\tBIT(4)\n\n \n#define KSMBD_RPC_METHOD_RETURN\t\tBIT(0)\n#define KSMBD_RPC_SRVSVC_METHOD_INVOKE\tBIT(1)\n#define KSMBD_RPC_SRVSVC_METHOD_RETURN\t(KSMBD_RPC_SRVSVC_METHOD_INVOKE | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_WKSSVC_METHOD_INVOKE\tBIT(2)\n#define KSMBD_RPC_WKSSVC_METHOD_RETURN\t(KSMBD_RPC_WKSSVC_METHOD_INVOKE | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_IOCTL_METHOD\t\t(BIT(3) | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_OPEN_METHOD\t\tBIT(4)\n#define KSMBD_RPC_WRITE_METHOD\t\tBIT(5)\n#define KSMBD_RPC_READ_METHOD\t\t(BIT(6) | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_CLOSE_METHOD\t\tBIT(7)\n#define KSMBD_RPC_RAP_METHOD\t\t(BIT(8) | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_RESTRICTED_CONTEXT\tBIT(9)\n#define KSMBD_RPC_SAMR_METHOD_INVOKE\tBIT(10)\n#define KSMBD_RPC_SAMR_METHOD_RETURN\t(KSMBD_RPC_SAMR_METHOD_INVOKE | KSMBD_RPC_METHOD_RETURN)\n#define KSMBD_RPC_LSARPC_METHOD_INVOKE\tBIT(11)\n#define KSMBD_RPC_LSARPC_METHOD_RETURN\t(KSMBD_RPC_LSARPC_METHOD_INVOKE | KSMBD_RPC_METHOD_RETURN)\n\n \n#define KSMBD_RPC_OK\t\t\t0\n#define KSMBD_RPC_EBAD_FUNC\t\t0x00000001\n#define KSMBD_RPC_EACCESS_DENIED\t0x00000005\n#define KSMBD_RPC_EBAD_FID\t\t0x00000006\n#define KSMBD_RPC_ENOMEM\t\t0x00000008\n#define KSMBD_RPC_EBAD_DATA\t\t0x0000000D\n#define KSMBD_RPC_ENOTIMPLEMENTED\t0x00000040\n#define KSMBD_RPC_EINVALID_PARAMETER\t0x00000057\n#define KSMBD_RPC_EMORE_DATA\t\t0x000000EA\n#define KSMBD_RPC_EINVALID_LEVEL\t0x0000007C\n#define KSMBD_RPC_SOME_NOT_MAPPED\t0x00000107\n\n#define KSMBD_CONFIG_OPT_DISABLED\t0\n#define KSMBD_CONFIG_OPT_ENABLED\t1\n#define KSMBD_CONFIG_OPT_AUTO\t\t2\n#define KSMBD_CONFIG_OPT_MANDATORY\t3\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}