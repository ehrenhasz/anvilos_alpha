{
  "module_name": "user_session.h",
  "hash_id": "f2c32b5f579ac217e2aacf895f53e73ee1d5255cee8c4cb75794cf7ca5037d1c",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/server/mgmt/user_session.h",
  "human_readable_source": " \n \n\n#ifndef __USER_SESSION_MANAGEMENT_H__\n#define __USER_SESSION_MANAGEMENT_H__\n\n#include <linux/hashtable.h>\n#include <linux/xarray.h>\n\n#include \"../smb_common.h\"\n#include \"../ntlmssp.h\"\n\n#define CIFDS_SESSION_FLAG_SMB2\t\tBIT(1)\n\n#define PREAUTH_HASHVALUE_SIZE\t\t64\n\nstruct ksmbd_file_table;\n\nstruct channel {\n\t__u8\t\t\tsmb3signingkey[SMB3_SIGN_KEY_SIZE];\n\tstruct ksmbd_conn\t*conn;\n};\n\nstruct preauth_session {\n\t__u8\t\t\tPreauth_HashValue[PREAUTH_HASHVALUE_SIZE];\n\tu64\t\t\tid;\n\tstruct list_head\tpreauth_entry;\n};\n\nstruct ksmbd_session {\n\tu64\t\t\t\tid;\n\n\t__u16\t\t\t\tdialect;\n\tchar\t\t\t\tClientGUID[SMB2_CLIENT_GUID_SIZE];\n\n\tstruct ksmbd_user\t\t*user;\n\tunsigned int\t\t\tsequence_number;\n\tunsigned int\t\t\tflags;\n\n\tbool\t\t\t\tsign;\n\tbool\t\t\t\tenc;\n\tbool\t\t\t\tis_anonymous;\n\n\tint\t\t\t\tstate;\n\t__u8\t\t\t\t*Preauth_HashValue;\n\n\tchar\t\t\t\tsess_key[CIFS_KEY_SIZE];\n\n\tstruct hlist_node\t\thlist;\n\tstruct xarray\t\t\tksmbd_chann_list;\n\tstruct xarray\t\t\ttree_conns;\n\tstruct ida\t\t\ttree_conn_ida;\n\tstruct xarray\t\t\trpc_handle_list;\n\n\t__u8\t\t\t\tsmb3encryptionkey[SMB3_ENC_DEC_KEY_SIZE];\n\t__u8\t\t\t\tsmb3decryptionkey[SMB3_ENC_DEC_KEY_SIZE];\n\t__u8\t\t\t\tsmb3signingkey[SMB3_SIGN_KEY_SIZE];\n\n\tstruct ksmbd_file_table\t\tfile_table;\n\tunsigned long\t\t\tlast_active;\n\trwlock_t\t\t\ttree_conns_lock;\n};\n\nstatic inline int test_session_flag(struct ksmbd_session *sess, int bit)\n{\n\treturn sess->flags & bit;\n}\n\nstatic inline void set_session_flag(struct ksmbd_session *sess, int bit)\n{\n\tsess->flags |= bit;\n}\n\nstatic inline void clear_session_flag(struct ksmbd_session *sess, int bit)\n{\n\tsess->flags &= ~bit;\n}\n\nstruct ksmbd_session *ksmbd_smb2_session_create(void);\n\nvoid ksmbd_session_destroy(struct ksmbd_session *sess);\n\nstruct ksmbd_session *ksmbd_session_lookup_slowpath(unsigned long long id);\nstruct ksmbd_session *ksmbd_session_lookup(struct ksmbd_conn *conn,\n\t\t\t\t\t   unsigned long long id);\nint ksmbd_session_register(struct ksmbd_conn *conn,\n\t\t\t   struct ksmbd_session *sess);\nvoid ksmbd_sessions_deregister(struct ksmbd_conn *conn);\nstruct ksmbd_session *ksmbd_session_lookup_all(struct ksmbd_conn *conn,\n\t\t\t\t\t       unsigned long long id);\nstruct preauth_session *ksmbd_preauth_session_alloc(struct ksmbd_conn *conn,\n\t\t\t\t\t\t    u64 sess_id);\nstruct preauth_session *ksmbd_preauth_session_lookup(struct ksmbd_conn *conn,\n\t\t\t\t\t\t     unsigned long long id);\n\nint ksmbd_acquire_tree_conn_id(struct ksmbd_session *sess);\nvoid ksmbd_release_tree_conn_id(struct ksmbd_session *sess, int id);\n\nint ksmbd_session_rpc_open(struct ksmbd_session *sess, char *rpc_name);\nvoid ksmbd_session_rpc_close(struct ksmbd_session *sess, int id);\nint ksmbd_session_rpc_method(struct ksmbd_session *sess, int id);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}