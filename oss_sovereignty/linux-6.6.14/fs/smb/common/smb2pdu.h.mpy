{
  "module_name": "smb2pdu.h",
  "hash_id": "2510d9538371fb60bd9702b9af208f28596094b010fc71c8b61524e69be0ae03",
  "original_prompt": "Ingested from linux-6.6.14/fs/smb/common/smb2pdu.h",
  "human_readable_source": " \n#ifndef _COMMON_SMB2PDU_H\n#define _COMMON_SMB2PDU_H\n\n \n\n \n#define SMB2_NEGOTIATE_HE\t0x0000\n#define SMB2_SESSION_SETUP_HE\t0x0001\n#define SMB2_LOGOFF_HE\t\t0x0002  \n#define SMB2_TREE_CONNECT_HE\t0x0003\n#define SMB2_TREE_DISCONNECT_HE\t0x0004  \n#define SMB2_CREATE_HE\t\t0x0005\n#define SMB2_CLOSE_HE\t\t0x0006\n#define SMB2_FLUSH_HE\t\t0x0007  \n#define SMB2_READ_HE\t\t0x0008\n#define SMB2_WRITE_HE\t\t0x0009\n#define SMB2_LOCK_HE\t\t0x000A\n#define SMB2_IOCTL_HE\t\t0x000B\n#define SMB2_CANCEL_HE\t\t0x000C\n#define SMB2_ECHO_HE\t\t0x000D\n#define SMB2_QUERY_DIRECTORY_HE\t0x000E\n#define SMB2_CHANGE_NOTIFY_HE\t0x000F\n#define SMB2_QUERY_INFO_HE\t0x0010\n#define SMB2_SET_INFO_HE\t0x0011\n#define SMB2_OPLOCK_BREAK_HE\t0x0012\n\n \n#define SMB2_NEGOTIATE\t\tcpu_to_le16(SMB2_NEGOTIATE_HE)\n#define SMB2_SESSION_SETUP\tcpu_to_le16(SMB2_SESSION_SETUP_HE)\n#define SMB2_LOGOFF\t\tcpu_to_le16(SMB2_LOGOFF_HE)\n#define SMB2_TREE_CONNECT\tcpu_to_le16(SMB2_TREE_CONNECT_HE)\n#define SMB2_TREE_DISCONNECT\tcpu_to_le16(SMB2_TREE_DISCONNECT_HE)\n#define SMB2_CREATE\t\tcpu_to_le16(SMB2_CREATE_HE)\n#define SMB2_CLOSE\t\tcpu_to_le16(SMB2_CLOSE_HE)\n#define SMB2_FLUSH\t\tcpu_to_le16(SMB2_FLUSH_HE)\n#define SMB2_READ\t\tcpu_to_le16(SMB2_READ_HE)\n#define SMB2_WRITE\t\tcpu_to_le16(SMB2_WRITE_HE)\n#define SMB2_LOCK\t\tcpu_to_le16(SMB2_LOCK_HE)\n#define SMB2_IOCTL\t\tcpu_to_le16(SMB2_IOCTL_HE)\n#define SMB2_CANCEL\t\tcpu_to_le16(SMB2_CANCEL_HE)\n#define SMB2_ECHO\t\tcpu_to_le16(SMB2_ECHO_HE)\n#define SMB2_QUERY_DIRECTORY\tcpu_to_le16(SMB2_QUERY_DIRECTORY_HE)\n#define SMB2_CHANGE_NOTIFY\tcpu_to_le16(SMB2_CHANGE_NOTIFY_HE)\n#define SMB2_QUERY_INFO\t\tcpu_to_le16(SMB2_QUERY_INFO_HE)\n#define SMB2_SET_INFO\t\tcpu_to_le16(SMB2_SET_INFO_HE)\n#define SMB2_OPLOCK_BREAK\tcpu_to_le16(SMB2_OPLOCK_BREAK_HE)\n\n#define SMB2_INTERNAL_CMD\tcpu_to_le16(0xFFFF)\n\n#define NUMBER_OF_SMB2_COMMANDS\t0x0013\n\n \n#define SMB2_NTLMV2_SESSKEY_SIZE\t16\n#define SMB2_SIGNATURE_SIZE\t\t16\n#define SMB2_HMACSHA256_SIZE\t\t32\n#define SMB2_CMACAES_SIZE\t\t16\n#define SMB3_GCM128_CRYPTKEY_SIZE\t16\n#define SMB3_GCM256_CRYPTKEY_SIZE\t32\n\n \n#define SMB3_ENC_DEC_KEY_SIZE\t\t32\n\n \n#define SMB3_SIGN_KEY_SIZE\t\t16\n\n#define CIFS_CLIENT_CHALLENGE_SIZE\t8\n\n \n#define SMB2_MAX_BUFFER_SIZE 65536\n\n \n#define SMB3_DEFAULT_IOSIZE (4 * 1024 * 1024)\n\n \n\n#define __SMB2_HEADER_STRUCTURE_SIZE\t64\n#define SMB2_HEADER_STRUCTURE_SIZE\t\t\t\t\\\n\tcpu_to_le16(__SMB2_HEADER_STRUCTURE_SIZE)\n\n#define SMB2_PROTO_NUMBER cpu_to_le32(0x424d53fe)\n#define SMB2_TRANSFORM_PROTO_NUM cpu_to_le32(0x424d53fd)\n#define SMB2_COMPRESSION_TRANSFORM_ID cpu_to_le32(0x424d53fc)\n\n \n#define SMB2_FLAGS_SERVER_TO_REDIR\tcpu_to_le32(0x00000001)\n#define SMB2_FLAGS_ASYNC_COMMAND\tcpu_to_le32(0x00000002)\n#define SMB2_FLAGS_RELATED_OPERATIONS\tcpu_to_le32(0x00000004)\n#define SMB2_FLAGS_SIGNED\t\tcpu_to_le32(0x00000008)\n#define SMB2_FLAGS_PRIORITY_MASK\tcpu_to_le32(0x00000070)  \n#define SMB2_FLAGS_DFS_OPERATIONS\tcpu_to_le32(0x10000000)\n#define SMB2_FLAGS_REPLAY_OPERATION\tcpu_to_le32(0x20000000)  \n\n \n\n \nstruct smb2_hdr {\n\t__le32 ProtocolId;\t \n\t__le16 StructureSize;\t \n\t__le16 CreditCharge;\t \n\t__le32 Status;\t\t \n\t__le16 Command;\n\t__le16 CreditRequest;\t \n\t__le32 Flags;\n\t__le32 NextCommand;\n\t__le64 MessageId;\n\tunion {\n\t\tstruct {\n\t\t\t__le32 ProcessId;\n\t\t\t__le32  TreeId;\n\t\t} __packed SyncId;\n\t\t__le64  AsyncId;\n\t} __packed Id;\n\t__le64  SessionId;\n\t__u8   Signature[16];\n} __packed;\n\nstruct smb3_hdr_req {\n\t__le32 ProtocolId;\t \n\t__le16 StructureSize;\t \n\t__le16 CreditCharge;\t \n\t__le16 ChannelSequence;  \n\t__le16 Reserved;\n\t__le16 Command;\n\t__le16 CreditRequest;\t \n\t__le32 Flags;\n\t__le32 NextCommand;\n\t__le64 MessageId;\n\tunion {\n\t\tstruct {\n\t\t\t__le32 ProcessId;\n\t\t\t__le32  TreeId;\n\t\t} __packed SyncId;\n\t\t__le64  AsyncId;\n\t} __packed Id;\n\t__le64  SessionId;\n\t__u8   Signature[16];\n} __packed;\n\nstruct smb2_pdu {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize2;  \n} __packed;\n\n#define SMB2_ERROR_STRUCTURE_SIZE2\t9\n#define SMB2_ERROR_STRUCTURE_SIZE2_LE\tcpu_to_le16(SMB2_ERROR_STRUCTURE_SIZE2)\n\nstruct smb2_err_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\n\t__u8   ErrorContextCount;\n\t__u8   Reserved;\n\t__le32 ByteCount;   \n\t__u8   ErrorData[];   \n} __packed;\n\n#define SMB3_AES_CCM_NONCE 11\n#define SMB3_AES_GCM_NONCE 12\n\n \n#define TRANSFORM_FLAG_ENCRYPTED\t0x0001\nstruct smb2_transform_hdr {\n\t__le32 ProtocolId;\t \n\t__u8   Signature[16];\n\t__u8   Nonce[16];\n\t__le32 OriginalMessageSize;\n\t__u16  Reserved1;\n\t__le16 Flags;  \n\t__le64  SessionId;\n} __packed;\n\n\n \nstruct smb2_compression_transform_hdr_unchained {\n\t__le32 ProtocolId;\t \n\t__le32 OriginalCompressedSegmentSize;\n\t__le16 CompressionAlgorithm;\n\t__le16 Flags;\n\t__le16 Length;  \n} __packed;\n\n \n#define SMB2_COMPRESSION_FLAG_NONE\t0x0000\n#define SMB2_COMPRESSION_FLAG_CHAINED\t0x0001\n\nstruct compression_payload_header {\n\t__le16\tCompressionAlgorithm;\n\t__le16\tFlags;\n\t__le32\tLength;  \n\t   \n} __packed;\n\n \nstruct smb2_compression_transform_hdr_chained {\n\t__le32 ProtocolId;\t \n\t__le32 OriginalCompressedSegmentSize;\n\t \n} __packed;\n\n \nstruct compression_pattern_payload_v1 {\n\t__le16\tPattern;\n\t__le16\tReserved1;\n\t__le16\tReserved2;\n\t__le32\tRepetitions;\n} __packed;\n\n \n \n#define SMB2_RESERVED_TREE_CONNECT_CONTEXT_ID 0x0000\n#define SMB2_REMOTED_IDENTITY_TREE_CONNECT_CONTEXT_ID cpu_to_le16(0x0001)\n\nstruct tree_connect_contexts {\n\t__le16 ContextType;\n\t__le16 DataLength;\n\t__le32 Reserved;\n\t__u8   Data[];\n} __packed;\n\n \nstruct smb3_blob_data {\n\t__le16 BlobSize;\n\t__u8   BlobData[];\n} __packed;\n\n \n#define SE_GROUP_MANDATORY\t\t0x00000001\n#define SE_GROUP_ENABLED_BY_DEFAULT\t0x00000002\n#define SE_GROUP_ENABLED\t\t0x00000004\n#define SE_GROUP_OWNER\t\t\t0x00000008\n#define SE_GROUP_USE_FOR_DENY_ONLY\t0x00000010\n#define SE_GROUP_INTEGRITY\t\t0x00000020\n#define SE_GROUP_INTEGRITY_ENABLED\t0x00000040\n#define SE_GROUP_RESOURCE\t\t0x20000000\n#define SE_GROUP_LOGON_ID\t\t0xC0000000\n\n \n\nstruct sid_array_data {\n\t__le16 SidAttrCount;\n\t \n} __packed;\n\nstruct luid_attr_data {\n\n} __packed;\n\n \n\nstruct privilege_array_data {\n\t__le16 PrivilegeCount;\n\t \n} __packed;\n\nstruct remoted_identity_tcon_context {\n\t__le16 TicketType;  \n\t__le16 TicketSize;  \n\t__le16 User;  \n\t__le16 UserName;  \n\t__le16 Domain;  \n\t__le16 Groups;  \n\t__le16 RestrictedGroups;  \n\t__le16 Privileges;  \n\t__le16 PrimaryGroup;  \n\t__le16 Owner;  \n\t__le16 DefaultDacl;  \n\t__le16 DeviceGroups;  \n\t__le16 UserClaims;  \n\t__le16 DeviceClaims;  \n\t__u8   TicketInfo[];  \n} __packed;\n\nstruct smb2_tree_connect_req_extension {\n\t__le32 TreeConnectContextOffset;\n\t__le16 TreeConnectContextCount;\n\t__u8  Reserved[10];\n\t__u8  PathName[];  \n\t \n} __packed;\n\n \n#define SMB2_TREE_CONNECT_FLAG_CLUSTER_RECONNECT cpu_to_le16(0x0001)\n#define SMB2_TREE_CONNECT_FLAG_REDIRECT_TO_OWNER cpu_to_le16(0x0002)\n#define SMB2_TREE_CONNECT_FLAG_EXTENSION_PRESENT cpu_to_le16(0x0004)\n\nstruct smb2_tree_connect_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Flags;\t\t \n\t__le16 PathOffset;\n\t__le16 PathLength;\n\t__u8   Buffer[];\t \n} __packed;\n\n \n#define SMB2_SHARE_TYPE_DISK\t0x01\n#define SMB2_SHARE_TYPE_PIPE\t0x02\n#define\tSMB2_SHARE_TYPE_PRINT\t0x03\n\n \n#define SMB2_SHAREFLAG_MANUAL_CACHING\t\t\t0x00000000\n#define SMB2_SHAREFLAG_AUTO_CACHING\t\t\t0x00000010\n#define SMB2_SHAREFLAG_VDO_CACHING\t\t\t0x00000020\n#define SMB2_SHAREFLAG_NO_CACHING\t\t\t0x00000030\n#define SHI1005_FLAGS_DFS\t\t\t\t0x00000001\n#define SHI1005_FLAGS_DFS_ROOT\t\t\t\t0x00000002\n#define SMB2_SHAREFLAG_RESTRICT_EXCLUSIVE_OPENS\t\t0x00000100\n#define SMB2_SHAREFLAG_FORCE_SHARED_DELETE\t\t0x00000200\n#define SMB2_SHAREFLAG_ALLOW_NAMESPACE_CACHING\t\t0x00000400\n#define SMB2_SHAREFLAG_ACCESS_BASED_DIRECTORY_ENUM\t0x00000800\n#define SMB2_SHAREFLAG_FORCE_LEVELII_OPLOCK\t\t0x00001000\n#define SMB2_SHAREFLAG_ENABLE_HASH_V1\t\t\t0x00002000\n#define SMB2_SHAREFLAG_ENABLE_HASH_V2\t\t\t0x00004000\n#define SHI1005_FLAGS_ENCRYPT_DATA\t\t\t0x00008000\n#define SMB2_SHAREFLAG_IDENTITY_REMOTING\t\t0x00040000  \n#define SMB2_SHAREFLAG_COMPRESS_DATA\t\t\t0x00100000  \n#define SMB2_SHAREFLAG_ISOLATED_TRANSPORT\t\t0x00200000\n#define SHI1005_FLAGS_ALL\t\t\t\t0x0034FF33\n\n \n#define SMB2_SHARE_CAP_DFS\tcpu_to_le32(0x00000008)  \n#define SMB2_SHARE_CAP_CONTINUOUS_AVAILABILITY cpu_to_le32(0x00000010)  \n#define SMB2_SHARE_CAP_SCALEOUT\tcpu_to_le32(0x00000020)  \n#define SMB2_SHARE_CAP_CLUSTER\tcpu_to_le32(0x00000040)  \n#define SMB2_SHARE_CAP_ASYMMETRIC cpu_to_le32(0x00000080)  \n#define SMB2_SHARE_CAP_REDIRECT_TO_OWNER cpu_to_le32(0x00000100)  \n\nstruct smb2_tree_connect_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__u8   ShareType;\t \n\t__u8   Reserved;\n\t__le32 ShareFlags;\t \n\t__le32 Capabilities;\t \n\t__le32 MaximalAccess;\n} __packed;\n\nstruct smb2_tree_disconnect_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Reserved;\n} __packed;\n\nstruct smb2_tree_disconnect_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Reserved;\n} __packed;\n\n\n \n \n#define\tSMB2_NEGOTIATE_SIGNING_ENABLED     0x0001\n#define\tSMB2_NEGOTIATE_SIGNING_ENABLED_LE  cpu_to_le16(0x0001)\n#define SMB2_NEGOTIATE_SIGNING_REQUIRED\t   0x0002\n#define SMB2_NEGOTIATE_SIGNING_REQUIRED_LE cpu_to_le16(0x0002)\n#define SMB2_SEC_MODE_FLAGS_ALL            0x0003\n\n \n#define SMB2_GLOBAL_CAP_DFS\t\t0x00000001\n#define SMB2_GLOBAL_CAP_LEASING\t\t0x00000002  \n#define SMB2_GLOBAL_CAP_LARGE_MTU\t0x00000004  \n#define SMB2_GLOBAL_CAP_MULTI_CHANNEL\t0x00000008  \n#define SMB2_GLOBAL_CAP_PERSISTENT_HANDLES 0x00000010  \n#define SMB2_GLOBAL_CAP_DIRECTORY_LEASING  0x00000020  \n#define SMB2_GLOBAL_CAP_ENCRYPTION\t0x00000040  \n \n#define SMB2_NT_FIND\t\t\t0x00100000\n#define SMB2_LARGE_FILES\t\t0x00200000\n\n#define SMB2_CLIENT_GUID_SIZE\t\t16\n#define SMB2_CREATE_GUID_SIZE\t\t16\n\n \n#define SMB10_PROT_ID  0x0000  \n#define SMB20_PROT_ID  0x0202\n#define SMB21_PROT_ID  0x0210\n#define SMB2X_PROT_ID  0x02FF\n#define SMB30_PROT_ID  0x0300\n#define SMB302_PROT_ID 0x0302\n#define SMB311_PROT_ID 0x0311\n#define BAD_PROT_ID    0xFFFF\n\n#define SMB311_SALT_SIZE\t\t\t32\n \n#define SMB2_PREAUTH_INTEGRITY_SHA512\tcpu_to_le16(0x0001)\n#define SMB2_PREAUTH_HASH_SIZE 64\n\n \n#define SMB2_PREAUTH_INTEGRITY_CAPABILITIES\tcpu_to_le16(1)\n#define SMB2_ENCRYPTION_CAPABILITIES\t\tcpu_to_le16(2)\n#define SMB2_COMPRESSION_CAPABILITIES\t\tcpu_to_le16(3)\n#define SMB2_NETNAME_NEGOTIATE_CONTEXT_ID\tcpu_to_le16(5)\n#define SMB2_TRANSPORT_CAPABILITIES\t\tcpu_to_le16(6)\n#define SMB2_RDMA_TRANSFORM_CAPABILITIES\tcpu_to_le16(7)\n#define SMB2_SIGNING_CAPABILITIES\t\tcpu_to_le16(8)\n#define SMB2_POSIX_EXTENSIONS_AVAILABLE\t\tcpu_to_le16(0x100)\n\nstruct smb2_neg_context {\n\t__le16\tContextType;\n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t \n} __packed;\n\n \n#define MIN_PREAUTH_CTXT_DATA_LEN 6\n\nstruct smb2_preauth_neg_context {\n\t__le16\tContextType;  \n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t__le16\tHashAlgorithmCount;  \n\t__le16\tSaltLength;\n\t__le16\tHashAlgorithms;  \n\t__u8\tSalt[SMB311_SALT_SIZE];\n} __packed;\n\n \n#define SMB2_ENCRYPTION_AES128_CCM\tcpu_to_le16(0x0001)\n#define SMB2_ENCRYPTION_AES128_GCM\tcpu_to_le16(0x0002)\n#define SMB2_ENCRYPTION_AES256_CCM      cpu_to_le16(0x0003)\n#define SMB2_ENCRYPTION_AES256_GCM      cpu_to_le16(0x0004)\n\n \n#define MIN_ENCRYPT_CTXT_DATA_LEN\t4\nstruct smb2_encryption_neg_context {\n\t__le16\tContextType;  \n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t \n\t__le16\tCipherCount;  \n\t__le16\tCiphers[];\n} __packed;\n\n \n#define SMB3_COMPRESS_NONE\tcpu_to_le16(0x0000)\n#define SMB3_COMPRESS_LZNT1\tcpu_to_le16(0x0001)\n#define SMB3_COMPRESS_LZ77\tcpu_to_le16(0x0002)\n#define SMB3_COMPRESS_LZ77_HUFF\tcpu_to_le16(0x0003)\n \n#define SMB3_COMPRESS_PATTERN\tcpu_to_le16(0x0004)  \n\n \n#define SMB2_COMPRESSION_CAPABILITIES_FLAG_NONE\t\tcpu_to_le32(0x00000000)\n#define SMB2_COMPRESSION_CAPABILITIES_FLAG_CHAINED\tcpu_to_le32(0x00000001)\n\nstruct smb2_compression_capabilities_context {\n\t__le16\tContextType;  \n\t__le16  DataLength;\n\t__le32\tReserved;\n\t__le16\tCompressionAlgorithmCount;\n\t__le16\tPadding;\n\t__le32\tFlags;\n\t__le16\tCompressionAlgorithms[3];\n\t__u16\tPad;   \n\t \n} __packed;\n\n \nstruct smb2_netname_neg_context {\n\t__le16\tContextType;  \n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t__le16\tNetName[];  \n} __packed;\n\n \n\n \n#define SMB2_ACCEPT_TRANSPORT_LEVEL_SECURITY\t0x00000001\n\nstruct smb2_transport_capabilities_context {\n\t__le16\tContextType;  \n\t__le16  DataLength;\n\t__u32\tReserved;\n\t__le32\tFlags;\n\t__u32\tPad;\n} __packed;\n\n \n\n \n#define SMB2_RDMA_TRANSFORM_NONE\t0x0000\n#define SMB2_RDMA_TRANSFORM_ENCRYPTION\t0x0001\n#define SMB2_RDMA_TRANSFORM_SIGNING\t0x0002\n\nstruct smb2_rdma_transform_capabilities_context {\n\t__le16\tContextType;  \n\t__le16  DataLength;\n\t__u32\tReserved;\n\t__le16\tTransformCount;\n\t__u16\tReserved1;\n\t__u32\tReserved2;\n\t__le16\tRDMATransformIds[];\n} __packed;\n\n \n\n \n#define SIGNING_ALG_HMAC_SHA256    0\n#define SIGNING_ALG_HMAC_SHA256_LE cpu_to_le16(0)\n#define SIGNING_ALG_AES_CMAC       1\n#define SIGNING_ALG_AES_CMAC_LE    cpu_to_le16(1)\n#define SIGNING_ALG_AES_GMAC       2\n#define SIGNING_ALG_AES_GMAC_LE    cpu_to_le16(2)\n\nstruct smb2_signing_capabilities {\n\t__le16\tContextType;  \n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t__le16\tSigningAlgorithmCount;\n\t__le16\tSigningAlgorithms[];\n\t \n} __packed;\n\n#define POSIX_CTXT_DATA_LEN\t16\nstruct smb2_posix_neg_context {\n\t__le16\tContextType;  \n\t__le16\tDataLength;\n\t__le32\tReserved;\n\t__u8\tName[16];  \n} __packed;\n\nstruct smb2_negotiate_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 DialectCount;\n\t__le16 SecurityMode;\n\t__le16 Reserved;\t \n\t__le32 Capabilities;\n\t__u8   ClientGUID[SMB2_CLIENT_GUID_SIZE];\n\t \n\t__le32 NegotiateContextOffset;  \n\t__le16 NegotiateContextCount;   \n\t__le16 Reserved2;\n\t__le16 Dialects[];\n} __packed;\n\nstruct smb2_negotiate_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 SecurityMode;\n\t__le16 DialectRevision;\n\t__le16 NegotiateContextCount;\t \n\t__u8   ServerGUID[16];\n\t__le32 Capabilities;\n\t__le32 MaxTransactSize;\n\t__le32 MaxReadSize;\n\t__le32 MaxWriteSize;\n\t__le64 SystemTime;\t \n\t__le64 ServerStartTime;\n\t__le16 SecurityBufferOffset;\n\t__le16 SecurityBufferLength;\n\t__le32 NegotiateContextOffset;\t \n\t__u8   Buffer[];\t \n} __packed;\n\n\n \n \n#define SMB2_SESSION_REQ_FLAG_BINDING\t\t0x01\n#define SMB2_SESSION_REQ_FLAG_ENCRYPT_DATA\t0x04\n\nstruct smb2_sess_setup_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   Flags;\n\t__u8   SecurityMode;\n\t__le32 Capabilities;\n\t__le32 Channel;\n\t__le16 SecurityBufferOffset;\n\t__le16 SecurityBufferLength;\n\t__le64 PreviousSessionId;\n\t__u8   Buffer[];\t \n} __packed;\n\n \n#define SMB2_SESSION_FLAG_IS_GUEST        0x0001\n#define SMB2_SESSION_FLAG_IS_GUEST_LE     cpu_to_le16(0x0001)\n#define SMB2_SESSION_FLAG_IS_NULL         0x0002\n#define SMB2_SESSION_FLAG_IS_NULL_LE      cpu_to_le16(0x0002)\n#define SMB2_SESSION_FLAG_ENCRYPT_DATA    0x0004\n#define SMB2_SESSION_FLAG_ENCRYPT_DATA_LE cpu_to_le16(0x0004)\n\nstruct smb2_sess_setup_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 SessionFlags;\n\t__le16 SecurityBufferOffset;\n\t__le16 SecurityBufferLength;\n\t__u8   Buffer[];\t \n} __packed;\n\n\n \nstruct smb2_logoff_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Reserved;\n} __packed;\n\nstruct smb2_logoff_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Reserved;\n} __packed;\n\n\n \n \n#define SMB2_CLOSE_FLAG_POSTQUERY_ATTRIB\tcpu_to_le16(0x0001)\nstruct smb2_close_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Flags;\n\t__le32 Reserved;\n\t__u64  PersistentFileId;  \n\t__u64  VolatileFileId;  \n} __packed;\n\n \n#define MAX_SMB2_CLOSE_RESPONSE_SIZE 124\n\nstruct smb2_close_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Flags;\n\t__le32 Reserved;\n\tstruct_group(network_open_info,\n\t\t__le64 CreationTime;\n\t\t__le64 LastAccessTime;\n\t\t__le64 LastWriteTime;\n\t\t__le64 ChangeTime;\n\t\t \n\t\t__le64 AllocationSize;\n\t\t__le64 EndOfFile;\n\t\t__le32 Attributes;\n\t);\n} __packed;\n\n\n \n \n#define SMB2_READFLAG_READ_UNBUFFERED\t0x01\n#define SMB2_READFLAG_REQUEST_COMPRESSED 0x02  \n\n \n#define SMB2_CHANNEL_NONE               cpu_to_le32(0x00000000)\n#define SMB2_CHANNEL_RDMA_V1            cpu_to_le32(0x00000001)\n#define SMB2_CHANNEL_RDMA_V1_INVALIDATE cpu_to_le32(0x00000002)\n#define SMB2_CHANNEL_RDMA_TRANSFORM     cpu_to_le32(0x00000003)\n\n \nstruct smb2_read_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   Padding;  \n\t__u8   Flags;  \n\t__le32 Length;\n\t__le64 Offset;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__le32 MinimumCount;\n\t__le32 Channel;  \n\t__le32 RemainingBytes;\n\t__le16 ReadChannelInfoOffset;\n\t__le16 ReadChannelInfoLength;\n\t__u8   Buffer[];\n} __packed;\n\n \n#define SMB2_READFLAG_RESPONSE_NONE            cpu_to_le32(0x00000000)\n#define SMB2_READFLAG_RESPONSE_RDMA_TRANSFORM  cpu_to_le32(0x00000001)\n\nstruct smb2_read_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   DataOffset;\n\t__u8   Reserved;\n\t__le32 DataLength;\n\t__le32 DataRemaining;\n\t__le32 Flags;\n\t__u8   Buffer[];\n} __packed;\n\n\n \n \n#define SMB2_WRITEFLAG_WRITE_THROUGH\t0x00000001\t \n#define SMB2_WRITEFLAG_WRITE_UNBUFFERED\t0x00000002\t \n\nstruct smb2_write_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 DataOffset;  \n\t__le32 Length;\n\t__le64 Offset;\n\t__u64  PersistentFileId;  \n\t__u64  VolatileFileId;  \n\t__le32 Channel;  \n\t__le32 RemainingBytes;\n\t__le16 WriteChannelInfoOffset;\n\t__le16 WriteChannelInfoLength;\n\t__le32 Flags;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_write_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   DataOffset;\n\t__u8   Reserved;\n\t__le32 DataLength;\n\t__le32 DataRemaining;\n\t__u32  Reserved2;\n\t__u8   Buffer[];\n} __packed;\n\n\n \nstruct smb2_flush_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__le16 Reserved1;\n\t__le32 Reserved2;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n} __packed;\n\nstruct smb2_flush_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\n\t__le16 Reserved;\n} __packed;\n\n#define SMB2_LOCKFLAG_SHARED\t\t0x0001\n#define SMB2_LOCKFLAG_EXCLUSIVE\t\t0x0002\n#define SMB2_LOCKFLAG_UNLOCK\t\t0x0004\n#define SMB2_LOCKFLAG_FAIL_IMMEDIATELY\t0x0010\n#define SMB2_LOCKFLAG_MASK\t\t0x0007\n\nstruct smb2_lock_element {\n\t__le64 Offset;\n\t__le64 Length;\n\t__le32 Flags;\n\t__le32 Reserved;\n} __packed;\n\nstruct smb2_lock_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 LockCount;\n\t \n\t__le32 LockSequenceNumber;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t \n\tunion {\n\t\tstruct smb2_lock_element lock;\n\t\tDECLARE_FLEX_ARRAY(struct smb2_lock_element, locks);\n\t};\n} __packed;\n\nstruct smb2_lock_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Reserved;\n} __packed;\n\nstruct smb2_echo_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__u16  Reserved;\n} __packed;\n\nstruct smb2_echo_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__u16  Reserved;\n} __packed;\n\n \n\n \n#define SMB2_RESTART_SCANS\t\t0x01\n#define SMB2_RETURN_SINGLE_ENTRY\t0x02\n#define SMB2_INDEX_SPECIFIED\t\t0x04\n#define SMB2_REOPEN\t\t\t0x10\n\nstruct smb2_query_directory_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   FileInformationClass;\n\t__u8   Flags;\n\t__le32 FileIndex;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__le16 FileNameOffset;\n\t__le16 FileNameLength;\n\t__le32 OutputBufferLength;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_query_directory_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 OutputBufferOffset;\n\t__le32 OutputBufferLength;\n\t__u8   Buffer[];\n} __packed;\n\n \n#define SMB2_SET_INFO_IOV_SIZE 3\n\nstruct smb2_set_info_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   InfoType;\n\t__u8   FileInfoClass;\n\t__le32 BufferLength;\n\t__le16 BufferOffset;\n\t__u16  Reserved;\n\t__le32 AdditionalInformation;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_set_info_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n} __packed;\n\n \n \n#define SMB2_WATCH_TREE\t\t\t0x0001\n\n \n#define FILE_NOTIFY_CHANGE_FILE_NAME\t\t0x00000001\n#define FILE_NOTIFY_CHANGE_DIR_NAME\t\t0x00000002\n#define FILE_NOTIFY_CHANGE_ATTRIBUTES\t\t0x00000004\n#define FILE_NOTIFY_CHANGE_SIZE\t\t\t0x00000008\n#define FILE_NOTIFY_CHANGE_LAST_WRITE\t\t0x00000010\n#define FILE_NOTIFY_CHANGE_LAST_ACCESS\t\t0x00000020\n#define FILE_NOTIFY_CHANGE_CREATION\t\t0x00000040\n#define FILE_NOTIFY_CHANGE_EA\t\t\t0x00000080\n#define FILE_NOTIFY_CHANGE_SECURITY\t\t0x00000100\n#define FILE_NOTIFY_CHANGE_STREAM_NAME\t\t0x00000200\n#define FILE_NOTIFY_CHANGE_STREAM_SIZE\t\t0x00000400\n#define FILE_NOTIFY_CHANGE_STREAM_WRITE\t\t0x00000800\n\n \n#define FILE_ACTION_ADDED                       0x00000001\n#define FILE_ACTION_REMOVED                     0x00000002\n#define FILE_ACTION_MODIFIED                    0x00000003\n#define FILE_ACTION_RENAMED_OLD_NAME            0x00000004\n#define FILE_ACTION_RENAMED_NEW_NAME            0x00000005\n#define FILE_ACTION_ADDED_STREAM                0x00000006\n#define FILE_ACTION_REMOVED_STREAM              0x00000007\n#define FILE_ACTION_MODIFIED_STREAM             0x00000008\n#define FILE_ACTION_REMOVED_BY_DELETE           0x00000009\n\nstruct smb2_change_notify_req {\n\tstruct smb2_hdr hdr;\n\t__le16\tStructureSize;\n\t__le16\tFlags;\n\t__le32\tOutputBufferLength;\n\t__u64\tPersistentFileId;  \n\t__u64\tVolatileFileId;  \n\t__le32\tCompletionFilter;\n\t__u32\tReserved;\n} __packed;\n\nstruct smb2_change_notify_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16\tStructureSize;   \n\t__le16\tOutputBufferOffset;\n\t__le32\tOutputBufferLength;\n\t__u8\tBuffer[];  \n} __packed;\n\n\n \n \n#define SMB2_OPLOCK_LEVEL_NONE\t\t0x00\n#define SMB2_OPLOCK_LEVEL_II\t\t0x01\n#define SMB2_OPLOCK_LEVEL_EXCLUSIVE\t0x08\n#define SMB2_OPLOCK_LEVEL_BATCH\t\t0x09\n#define SMB2_OPLOCK_LEVEL_LEASE\t\t0xFF\n \n#define SMB2_OPLOCK_LEVEL_NOCHANGE\t0x99\n\n \n#define IL_ANONYMOUS\t\tcpu_to_le32(0x00000000)\n#define IL_IDENTIFICATION\tcpu_to_le32(0x00000001)\n#define IL_IMPERSONATION\tcpu_to_le32(0x00000002)\n#define IL_DELEGATE\t\tcpu_to_le32(0x00000003)\n\n \n#define FILE_ATTRIBUTE_READONLY\t\t\t0x00000001\n#define FILE_ATTRIBUTE_HIDDEN\t\t\t0x00000002\n#define FILE_ATTRIBUTE_SYSTEM\t\t\t0x00000004\n#define FILE_ATTRIBUTE_DIRECTORY\t\t0x00000010\n#define FILE_ATTRIBUTE_ARCHIVE\t\t\t0x00000020\n#define FILE_ATTRIBUTE_NORMAL\t\t\t0x00000080\n#define FILE_ATTRIBUTE_TEMPORARY\t\t0x00000100\n#define FILE_ATTRIBUTE_SPARSE_FILE\t\t0x00000200\n#define FILE_ATTRIBUTE_REPARSE_POINT\t\t0x00000400\n#define FILE_ATTRIBUTE_COMPRESSED\t\t0x00000800\n#define FILE_ATTRIBUTE_OFFLINE\t\t\t0x00001000\n#define FILE_ATTRIBUTE_NOT_CONTENT_INDEXED\t0x00002000\n#define FILE_ATTRIBUTE_ENCRYPTED\t\t0x00004000\n#define FILE_ATTRIBUTE_INTEGRITY_STREAM\t\t0x00008000\n#define FILE_ATTRIBUTE_NO_SCRUB_DATA\t\t0x00020000\n#define FILE_ATTRIBUTE__MASK\t\t\t0x00007FB7\n\n#define FILE_ATTRIBUTE_READONLY_LE              cpu_to_le32(0x00000001)\n#define FILE_ATTRIBUTE_HIDDEN_LE\t\tcpu_to_le32(0x00000002)\n#define FILE_ATTRIBUTE_SYSTEM_LE\t\tcpu_to_le32(0x00000004)\n#define FILE_ATTRIBUTE_DIRECTORY_LE\t\tcpu_to_le32(0x00000010)\n#define FILE_ATTRIBUTE_ARCHIVE_LE\t\tcpu_to_le32(0x00000020)\n#define FILE_ATTRIBUTE_NORMAL_LE\t\tcpu_to_le32(0x00000080)\n#define FILE_ATTRIBUTE_TEMPORARY_LE\t\tcpu_to_le32(0x00000100)\n#define FILE_ATTRIBUTE_SPARSE_FILE_LE\t\tcpu_to_le32(0x00000200)\n#define FILE_ATTRIBUTE_REPARSE_POINT_LE\t\tcpu_to_le32(0x00000400)\n#define FILE_ATTRIBUTE_COMPRESSED_LE\t\tcpu_to_le32(0x00000800)\n#define FILE_ATTRIBUTE_OFFLINE_LE\t\tcpu_to_le32(0x00001000)\n#define FILE_ATTRIBUTE_NOT_CONTENT_INDEXED_LE\tcpu_to_le32(0x00002000)\n#define FILE_ATTRIBUTE_ENCRYPTED_LE\t\tcpu_to_le32(0x00004000)\n#define FILE_ATTRIBUTE_INTEGRITY_STREAM_LE\tcpu_to_le32(0x00008000)\n#define FILE_ATTRIBUTE_NO_SCRUB_DATA_LE\t\tcpu_to_le32(0x00020000)\n#define FILE_ATTRIBUTE_MASK_LE\t\t\tcpu_to_le32(0x00007FB7)\n\n \n#define FILE_READ_DATA_LE\t\tcpu_to_le32(0x00000001)\n#define FILE_LIST_DIRECTORY_LE\t\tcpu_to_le32(0x00000001)\n#define FILE_WRITE_DATA_LE\t\tcpu_to_le32(0x00000002)\n#define FILE_APPEND_DATA_LE\t\tcpu_to_le32(0x00000004)\n#define FILE_ADD_SUBDIRECTORY_LE\tcpu_to_le32(0x00000004)\n#define FILE_READ_EA_LE\t\t\tcpu_to_le32(0x00000008)\n#define FILE_WRITE_EA_LE\t\tcpu_to_le32(0x00000010)\n#define FILE_EXECUTE_LE\t\t\tcpu_to_le32(0x00000020)\n#define FILE_DELETE_CHILD_LE\t\tcpu_to_le32(0x00000040)\n#define FILE_READ_ATTRIBUTES_LE\t\tcpu_to_le32(0x00000080)\n#define FILE_WRITE_ATTRIBUTES_LE\tcpu_to_le32(0x00000100)\n#define FILE_DELETE_LE\t\t\tcpu_to_le32(0x00010000)\n#define FILE_READ_CONTROL_LE\t\tcpu_to_le32(0x00020000)\n#define FILE_WRITE_DAC_LE\t\tcpu_to_le32(0x00040000)\n#define FILE_WRITE_OWNER_LE\t\tcpu_to_le32(0x00080000)\n#define FILE_SYNCHRONIZE_LE\t\tcpu_to_le32(0x00100000)\n#define FILE_ACCESS_SYSTEM_SECURITY_LE\tcpu_to_le32(0x01000000)\n#define FILE_MAXIMAL_ACCESS_LE\t\tcpu_to_le32(0x02000000)\n#define FILE_GENERIC_ALL_LE\t\tcpu_to_le32(0x10000000)\n#define FILE_GENERIC_EXECUTE_LE\t\tcpu_to_le32(0x20000000)\n#define FILE_GENERIC_WRITE_LE\t\tcpu_to_le32(0x40000000)\n#define FILE_GENERIC_READ_LE\t\tcpu_to_le32(0x80000000)\n#define DESIRED_ACCESS_MASK             cpu_to_le32(0xF21F01FF)\n\n\n#define FILE_READ_DESIRED_ACCESS_LE     (FILE_READ_DATA_LE        |\t\\\n\t\t\t\t\t FILE_READ_EA_LE          |     \\\n\t\t\t\t\t FILE_GENERIC_READ_LE)\n#define FILE_WRITE_DESIRE_ACCESS_LE     (FILE_WRITE_DATA_LE       |\t\\\n\t\t\t\t\t FILE_APPEND_DATA_LE      |\t\\\n\t\t\t\t\t FILE_WRITE_EA_LE         |\t\\\n\t\t\t\t\t FILE_WRITE_ATTRIBUTES_LE |\t\\\n\t\t\t\t\t FILE_GENERIC_WRITE_LE)\n\n \n#define FILE_SHARE_READ_LE\t\tcpu_to_le32(0x00000001)\n#define FILE_SHARE_WRITE_LE\t\tcpu_to_le32(0x00000002)\n#define FILE_SHARE_DELETE_LE\t\tcpu_to_le32(0x00000004)\n#define FILE_SHARE_ALL_LE\t\tcpu_to_le32(0x00000007)\n\n \n#define FILE_SUPERSEDE_LE\t\tcpu_to_le32(0x00000000)\n#define FILE_OPEN_LE\t\t\tcpu_to_le32(0x00000001)\n#define FILE_CREATE_LE\t\t\tcpu_to_le32(0x00000002)\n#define\tFILE_OPEN_IF_LE\t\t\tcpu_to_le32(0x00000003)\n#define FILE_OVERWRITE_LE\t\tcpu_to_le32(0x00000004)\n#define FILE_OVERWRITE_IF_LE\t\tcpu_to_le32(0x00000005)\n#define FILE_CREATE_MASK_LE             cpu_to_le32(0x00000007)\n\n#define FILE_READ_RIGHTS (FILE_READ_DATA | FILE_READ_EA \\\n\t\t\t| FILE_READ_ATTRIBUTES)\n#define FILE_WRITE_RIGHTS (FILE_WRITE_DATA | FILE_APPEND_DATA \\\n\t\t\t| FILE_WRITE_EA | FILE_WRITE_ATTRIBUTES)\n#define FILE_EXEC_RIGHTS (FILE_EXECUTE)\n\n \n#define FILE_DIRECTORY_FILE_LE\t\tcpu_to_le32(0x00000001)\n \n#define FILE_WRITE_THROUGH_LE\t\tcpu_to_le32(0x00000002)\n#define FILE_SEQUENTIAL_ONLY_LE\t\tcpu_to_le32(0x00000004)\n#define FILE_NO_INTERMEDIATE_BUFFERING_LE cpu_to_le32(0x00000008)\n#define FILE_NON_DIRECTORY_FILE_LE\tcpu_to_le32(0x00000040)\n#define FILE_COMPLETE_IF_OPLOCKED_LE\tcpu_to_le32(0x00000100)\n#define FILE_NO_EA_KNOWLEDGE_LE\t\tcpu_to_le32(0x00000200)\n#define FILE_RANDOM_ACCESS_LE\t\tcpu_to_le32(0x00000800)\n#define FILE_DELETE_ON_CLOSE_LE\t\tcpu_to_le32(0x00001000)\n#define FILE_OPEN_BY_FILE_ID_LE\t\tcpu_to_le32(0x00002000)\n#define FILE_OPEN_FOR_BACKUP_INTENT_LE\tcpu_to_le32(0x00004000)\n#define FILE_NO_COMPRESSION_LE\t\tcpu_to_le32(0x00008000)\n#define FILE_OPEN_REPARSE_POINT_LE\tcpu_to_le32(0x00200000)\n#define FILE_OPEN_NO_RECALL_LE\t\tcpu_to_le32(0x00400000)\n#define CREATE_OPTIONS_MASK_LE          cpu_to_le32(0x00FFFFFF)\n\n#define FILE_READ_RIGHTS_LE (FILE_READ_DATA_LE | FILE_READ_EA_LE \\\n\t\t\t| FILE_READ_ATTRIBUTES_LE)\n#define FILE_WRITE_RIGHTS_LE (FILE_WRITE_DATA_LE | FILE_APPEND_DATA_LE \\\n\t\t\t| FILE_WRITE_EA_LE | FILE_WRITE_ATTRIBUTES_LE)\n#define FILE_EXEC_RIGHTS_LE (FILE_EXECUTE_LE)\n\n \n#define SMB2_CREATE_EA_BUFFER\t\t\t\"ExtA\"  \n#define SMB2_CREATE_SD_BUFFER\t\t\t\"SecD\"  \n#define SMB2_CREATE_DURABLE_HANDLE_REQUEST\t\"DHnQ\"\n#define SMB2_CREATE_DURABLE_HANDLE_RECONNECT\t\"DHnC\"\n#define SMB2_CREATE_ALLOCATION_SIZE\t\t\"AlSi\"\n#define SMB2_CREATE_QUERY_MAXIMAL_ACCESS_REQUEST \"MxAc\"\n#define SMB2_CREATE_TIMEWARP_REQUEST\t\t\"TWrp\"\n#define SMB2_CREATE_QUERY_ON_DISK_ID\t\t\"QFid\"\n#define SMB2_CREATE_REQUEST_LEASE\t\t\"RqLs\"\n#define SMB2_CREATE_DURABLE_HANDLE_REQUEST_V2\t\"DH2Q\"\n#define SMB2_CREATE_DURABLE_HANDLE_RECONNECT_V2\t\"DH2C\"\n#define SMB2_CREATE_TAG_POSIX\t\t\"\\x93\\xAD\\x25\\x50\\x9C\\xB4\\x11\\xE7\\xB4\\x23\\x83\\xDE\\x96\\x8B\\xCD\\x7C\"\n#define SMB2_CREATE_APP_INSTANCE_ID\t\"\\x45\\xBC\\xA6\\x6A\\xEF\\xA7\\xF7\\x4A\\x90\\x08\\xFA\\x46\\x2E\\x14\\x4D\\x74\"\n#define SMB2_CREATE_APP_INSTANCE_VERSION \"\\xB9\\x82\\xD0\\xB7\\x3B\\x56\\x07\\x4F\\xA0\\x7B\\x52\\x4A\\x81\\x16\\xA0\\x10\"\n#define SVHDX_OPEN_DEVICE_CONTEXT\t\"\\x9C\\xCB\\xCF\\x9E\\x04\\xC1\\xE6\\x43\\x98\\x0E\\x15\\x8D\\xA1\\xF6\\xEC\\x83\"\n#define SMB2_CREATE_TAG_AAPL\t\t\t\"AAPL\"\n\n \n#define SMB2_CREATE_FLAG_REPARSEPOINT 0x01\n\nstruct create_context {\n\t__le32 Next;\n\t__le16 NameOffset;\n\t__le16 NameLength;\n\t__le16 Reserved;\n\t__le16 DataOffset;\n\t__le32 DataLength;\n\t__u8 Buffer[];\n} __packed;\n\nstruct smb2_create_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__u8   SecurityFlags;\n\t__u8   RequestedOplockLevel;\n\t__le32 ImpersonationLevel;\n\t__le64 SmbCreateFlags;\n\t__le64 Reserved;\n\t__le32 DesiredAccess;\n\t__le32 FileAttributes;\n\t__le32 ShareAccess;\n\t__le32 CreateDisposition;\n\t__le32 CreateOptions;\n\t__le16 NameOffset;\n\t__le16 NameLength;\n\t__le32 CreateContextsOffset;\n\t__le32 CreateContextsLength;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_create_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;\t \n\t__u8   OplockLevel;\n\t__u8   Flags;   \n\t__le32 CreateAction;\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 AllocationSize;\n\t__le64 EndofFile;\n\t__le32 FileAttributes;\n\t__le32 Reserved2;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__le32 CreateContextsOffset;\n\t__le32 CreateContextsLength;\n\t__u8   Buffer[];\n} __packed;\n\nstruct create_posix {\n\tstruct create_context ccontext;\n\t__u8    Name[16];\n\t__le32  Mode;\n\t__u32   Reserved;\n} __packed;\n\n \nstruct create_durable {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tunion {\n\t\t__u8  Reserved[16];\n\t\tstruct {\n\t\t\t__u64 PersistentFileId;\n\t\t\t__u64 VolatileFileId;\n\t\t} Fid;\n\t} Data;\n} __packed;\n\n \nstruct create_mxac_req {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le64 Timestamp;\n} __packed;\n\n \nstruct create_mxac_rsp {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le32 QueryStatus;\n\t__le32 MaximalAccess;\n} __packed;\n\n#define SMB2_LEASE_NONE_LE\t\t\tcpu_to_le32(0x00)\n#define SMB2_LEASE_READ_CACHING_LE\t\tcpu_to_le32(0x01)\n#define SMB2_LEASE_HANDLE_CACHING_LE\t\tcpu_to_le32(0x02)\n#define SMB2_LEASE_WRITE_CACHING_LE\t\tcpu_to_le32(0x04)\n\n#define SMB2_LEASE_FLAG_BREAK_IN_PROGRESS_LE\tcpu_to_le32(0x02)\n#define SMB2_LEASE_FLAG_PARENT_LEASE_KEY_SET_LE\tcpu_to_le32(0x04)\n\n#define SMB2_LEASE_KEY_SIZE\t\t\t16\n\n \nstruct lease_context {\n\t__u8 LeaseKey[SMB2_LEASE_KEY_SIZE];\n\t__le32 LeaseState;\n\t__le32 LeaseFlags;\n\t__le64 LeaseDuration;\n} __packed;\n\n \nstruct lease_context_v2 {\n\t__u8 LeaseKey[SMB2_LEASE_KEY_SIZE];\n\t__le32 LeaseState;\n\t__le32 LeaseFlags;\n\t__le64 LeaseDuration;\n\t__u8 ParentLeaseKey[SMB2_LEASE_KEY_SIZE];\n\t__le16 Epoch;\n\t__le16 Reserved;\n} __packed;\n\nstruct create_lease {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct lease_context lcontext;\n} __packed;\n\nstruct create_lease_v2 {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\tstruct lease_context_v2 lcontext;\n\t__u8   Pad[4];\n} __packed;\n\n \nstruct create_disk_id_rsp {\n\tstruct create_context ccontext;\n\t__u8   Name[8];\n\t__le64 DiskFileId;\n\t__le64 VolumeId;\n\t__u8  Reserved[16];\n} __packed;\n\n \nstruct create_app_inst_id {\n\tstruct create_context ccontext;\n\t__u8 Name[16];\n\t__le32 StructureSize;  \n\t__u16 Reserved;\n\t__u8 AppInstanceId[16];\n} __packed;\n\n \nstruct create_app_inst_id_vers {\n\tstruct create_context ccontext;\n\t__u8 Name[16];\n\t__le32 StructureSize;  \n\t__u16 Reserved;\n\t__u32 Padding;\n\t__le64 AppInstanceVersionHigh;\n\t__le64 AppInstanceVersionLow;\n} __packed;\n\n \nstruct smb2_ioctl_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Reserved;  \n\t__le32 CtlCode;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__le32 InputOffset;  \n\t__le32 InputCount;\n\t__le32 MaxInputResponse;\n\t__le32 OutputOffset;\n\t__le32 OutputCount;\n\t__le32 MaxOutputResponse;\n\t__le32 Flags;\n\t__le32 Reserved2;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_ioctl_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Reserved;\n\t__le32 CtlCode;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__le32 InputOffset;  \n\t__le32 InputCount;\n\t__le32 OutputOffset;\n\t__le32 OutputCount;\n\t__le32 Flags;\n\t__le32 Reserved2;\n\t__u8   Buffer[];\n} __packed;\n\n \nstruct file_zero_data_information {\n\t__le64\tFileOffset;\n\t__le64\tBeyondFinalZero;\n} __packed;\n\n \nstruct duplicate_extents_to_file {\n\t__u64 PersistentFileHandle;  \n\t__u64 VolatileFileHandle;\n\t__le64 SourceFileOffset;\n\t__le64 TargetFileOffset;\n\t__le64 ByteCount;   \n} __packed;\n\n \n#define DUPLICATE_EXTENTS_DATA_EX_SOURCE_ATOMIC\t0x00000001\nstruct duplicate_extents_to_file_ex {\n\t__u64 PersistentFileHandle;  \n\t__u64 VolatileFileHandle;\n\t__le64 SourceFileOffset;\n\t__le64 TargetFileOffset;\n\t__le64 ByteCount;   \n\t__le32 Flags;\n\t__le32 Reserved;\n} __packed;\n\n\n \nstruct fsctl_get_integrity_information_rsp {\n\t__le16\tChecksumAlgorithm;\n\t__le16\tReserved;\n\t__le32\tFlags;\n\t__le32\tChecksumChunkSizeInBytes;\n\t__le32\tClusterSizeInBytes;\n} __packed;\n\n \nstruct fsctl_query_file_regions_req {\n\t__le64\tFileOffset;\n\t__le64\tLength;\n\t__le32\tDesiredUsage;\n\t__le32\tReserved;\n} __packed;\n\n \n#define FILE_USAGE_INVALID_RANGE\t0x00000000\n#define FILE_USAGE_VALID_CACHED_DATA\t0x00000001\n#define FILE_USAGE_NONCACHED_DATA\t0x00000002\n\nstruct file_region_info {\n\t__le64\tFileOffset;\n\t__le64\tLength;\n\t__le32\tDesiredUsage;\n\t__le32\tReserved;\n} __packed;\n\n \nstruct fsctl_query_file_region_rsp {\n\t__le32 Flags;\n\t__le32 TotalRegionEntryCount;\n\t__le32 RegionEntryCount;\n\t__u32  Reserved;\n\tstruct  file_region_info Regions[];\n} __packed;\n\n \nstruct fsctl_query_on_disk_vol_info_rsp {\n\t__le64\tDirectoryCount;\n\t__le64\tFileCount;\n\t__le16\tFsFormatMajVersion;\n\t__le16\tFsFormatMinVersion;\n\t__u8\tFsFormatName[24];\n\t__le64\tFormatTime;\n\t__le64\tLastUpdateTime;\n\t__u8\tCopyrightInfo[68];\n\t__u8\tAbstractInfo[68];\n\t__u8\tFormatImplInfo[68];\n\t__u8\tLastModifyImplInfo[68];\n} __packed;\n\n \nstruct fsctl_set_integrity_information_req {\n\t__le16\tChecksumAlgorithm;\n\t__le16\tReserved;\n\t__le32\tFlags;\n} __packed;\n\n \nstruct fsctl_set_integrity_info_ex_req {\n\t__u8\tEnableIntegrity;\n\t__u8\tKeepState;\n\t__u16\tReserved;\n\t__le32\tFlags;\n\t__u8\tVersion;\n\t__u8\tReserved2[7];\n} __packed;\n\n \n#define\tCHECKSUM_TYPE_NONE\t0x0000\n#define\tCHECKSUM_TYPE_CRC64\t0x0002\n#define\tCHECKSUM_TYPE_UNCHANGED\t0xFFFF\t \n\n \n#define FSCTL_INTEGRITY_FLAG_CHECKSUM_ENFORCEMENT_OFF\t0x00000001\n\n \n\n \nstruct reparse_data_buffer {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__u8\tDataBuffer[];  \n} __packed;\n\nstruct reparse_guid_data_buffer {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__u8\tReparseGuid[16];\n\t__u8\tDataBuffer[];  \n} __packed;\n\nstruct reparse_mount_point_data_buffer {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__le16\tSubstituteNameOffset;\n\t__le16\tSubstituteNameLength;\n\t__le16\tPrintNameOffset;\n\t__le16\tPrintNameLength;\n\t__u8\tPathBuffer[];  \n} __packed;\n\n#define SYMLINK_FLAG_RELATIVE 0x00000001\n\nstruct reparse_symlink_data_buffer {\n\t__le32\tReparseTag;\n\t__le16\tReparseDataLength;\n\t__u16\tReserved;\n\t__le16\tSubstituteNameOffset;\n\t__le16\tSubstituteNameLength;\n\t__le16\tPrintNameOffset;\n\t__le16\tPrintNameLength;\n\t__le32\tFlags;\n\t__u8\tPathBuffer[];  \n} __packed;\n\n \n\nstruct validate_negotiate_info_req {\n\t__le32 Capabilities;\n\t__u8   Guid[SMB2_CLIENT_GUID_SIZE];\n\t__le16 SecurityMode;\n\t__le16 DialectCount;\n\t__le16 Dialects[4];  \n} __packed;\n\nstruct validate_negotiate_info_rsp {\n\t__le32 Capabilities;\n\t__u8   Guid[SMB2_CLIENT_GUID_SIZE];\n\t__le16 SecurityMode;\n\t__le16 Dialect;  \n} __packed;\n\n\n \n#define SMB2_O_INFO_FILE\t0x01\n#define SMB2_O_INFO_FILESYSTEM\t0x02\n#define SMB2_O_INFO_SECURITY\t0x03\n#define SMB2_O_INFO_QUOTA\t0x04\n\n \n\n \n#define FILE_DIRECTORY_INFORMATION\t1\t \n#define FILE_FULL_DIRECTORY_INFORMATION 2\t \n#define FILE_BOTH_DIRECTORY_INFORMATION 3\t \n#define FILE_BASIC_INFORMATION\t\t4\n#define FILE_STANDARD_INFORMATION\t5\n#define FILE_INTERNAL_INFORMATION\t6\n#define FILE_EA_INFORMATION\t        7\n#define FILE_ACCESS_INFORMATION\t\t8\n#define FILE_NAME_INFORMATION\t\t9\n#define FILE_RENAME_INFORMATION\t\t10\n#define FILE_LINK_INFORMATION\t\t11\n#define FILE_NAMES_INFORMATION\t\t12\t \n#define FILE_DISPOSITION_INFORMATION\t13\n#define FILE_POSITION_INFORMATION\t14\n#define FILE_FULL_EA_INFORMATION\t15\n#define FILE_MODE_INFORMATION\t\t16\n#define FILE_ALIGNMENT_INFORMATION\t17\n#define FILE_ALL_INFORMATION\t\t18\n#define FILE_ALLOCATION_INFORMATION\t19\n#define FILE_END_OF_FILE_INFORMATION\t20\n#define FILE_ALTERNATE_NAME_INFORMATION 21\n#define FILE_STREAM_INFORMATION\t\t22\n#define FILE_PIPE_INFORMATION\t\t23\n#define FILE_PIPE_LOCAL_INFORMATION\t24\n#define FILE_PIPE_REMOTE_INFORMATION\t25\n#define FILE_MAILSLOT_QUERY_INFORMATION 26\n#define FILE_MAILSLOT_SET_INFORMATION\t27\n#define FILE_COMPRESSION_INFORMATION\t28\n#define FILE_OBJECT_ID_INFORMATION\t29\n \n#define FILE_MOVE_CLUSTER_INFORMATION\t31\n#define FILE_QUOTA_INFORMATION\t\t32\n#define FILE_REPARSE_POINT_INFORMATION\t33\n#define FILE_NETWORK_OPEN_INFORMATION\t34\n#define FILE_ATTRIBUTE_TAG_INFORMATION\t35\n#define FILE_TRACKING_INFORMATION\t36\n#define FILEID_BOTH_DIRECTORY_INFORMATION 37\t \n#define FILEID_FULL_DIRECTORY_INFORMATION 38\t \n#define FILE_VALID_DATA_LENGTH_INFORMATION 39\n#define FILE_SHORT_NAME_INFORMATION\t40\n#define FILE_SFIO_RESERVE_INFORMATION\t44\n#define FILE_SFIO_VOLUME_INFORMATION\t45\n#define FILE_HARD_LINK_INFORMATION\t46\n#define FILE_NORMALIZED_NAME_INFORMATION 48\n#define FILEID_GLOBAL_TX_DIRECTORY_INFORMATION 50\n#define FILE_STANDARD_LINK_INFORMATION\t54\n#define FILE_ID_INFORMATION\t\t59\n#define FILE_ID_EXTD_DIRECTORY_INFORMATION 60\t \n \n#define SMB_FIND_FILE_POSIX_INFO\t0x064\n\n \n#define OWNER_SECINFO   0x00000001\n#define GROUP_SECINFO   0x00000002\n#define DACL_SECINFO   0x00000004\n#define SACL_SECINFO   0x00000008\n#define LABEL_SECINFO   0x00000010\n#define ATTRIBUTE_SECINFO   0x00000020\n#define SCOPE_SECINFO   0x00000040\n#define BACKUP_SECINFO   0x00010000\n#define UNPROTECTED_SACL_SECINFO   0x10000000\n#define UNPROTECTED_DACL_SECINFO   0x20000000\n#define PROTECTED_SACL_SECINFO   0x40000000\n#define PROTECTED_DACL_SECINFO   0x80000000\n\n \n#define SL_RESTART_SCAN\t\t0x00000001\n#define SL_RETURN_SINGLE_ENTRY\t0x00000002\n#define SL_INDEX_SPECIFIED\t0x00000004\n\nstruct smb2_query_info_req {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   InfoType;\n\t__u8   FileInfoClass;\n\t__le32 OutputBufferLength;\n\t__le16 InputBufferOffset;\n\t__u16  Reserved;\n\t__le32 InputBufferLength;\n\t__le32 AdditionalInformation;\n\t__le32 Flags;\n\t__u64  PersistentFileId;\n\t__u64  VolatileFileId;\n\t__u8   Buffer[];\n} __packed;\n\nstruct smb2_query_info_rsp {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 OutputBufferOffset;\n\t__le32 OutputBufferLength;\n\t__u8   Buffer[];\n} __packed;\n\n \n\n \nstruct file_allocated_range_buffer {\n\t__le64\tfile_offset;\n\t__le64\tlength;\n} __packed;\n\nstruct smb2_file_internal_info {\n\t__le64 IndexNumber;\n} __packed;  \n\nstruct smb2_file_rename_info {  \n\t__u8   ReplaceIfExists;  \n\t\t\t\t \n\t__u8   Reserved[7];\n\t__u64  RootDirectory;   \n\t__le32 FileNameLength;\n\tchar   FileName[];      \n\t \n} __packed;  \n\nstruct smb2_file_link_info {  \n\t__u8   ReplaceIfExists;  \n\t\t\t\t \n\t__u8   Reserved[7];\n\t__u64  RootDirectory;   \n\t__le32 FileNameLength;\n\tchar   FileName[];      \n} __packed;  \n\n \nstruct smb2_file_all_info {  \n\t__le64 CreationTime;\t \n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le32 Attributes;\n\t__u32  Pad1;\t\t \n\t__le64 AllocationSize;\t \n\t__le64 EndOfFile;\t \n\t__le32 NumberOfLinks;\t \n\t__u8   DeletePending;\n\t__u8   Directory;\n\t__u16  Pad2;\t\t \n\t__le64 IndexNumber;\n\t__le32 EASize;\n\t__le32 AccessFlags;\n\t__le64 CurrentByteOffset;\n\t__le32 Mode;\n\t__le32 AlignmentRequirement;\n\t__le32 FileNameLength;\n\tunion {\n\t\tchar __pad;\t \n\t\tDECLARE_FLEX_ARRAY(char, FileName);\n\t};\n} __packed;  \n\nstruct smb2_file_eof_info {  \n\t__le64 EndOfFile;  \n} __packed;  \n\n \nstruct smb311_posix_qinfo {\n\t__le64 CreationTime;\n\t__le64 LastAccessTime;\n\t__le64 LastWriteTime;\n\t__le64 ChangeTime;\n\t__le64 EndOfFile;\n\t__le64 AllocationSize;\n\t__le32 DosAttributes;\n\t__le64 Inode;\n\t__le32 DeviceId;\n\t__le32 Zero;\n\t \n\t__le32 HardLinks;\n\t__le32 ReparseTag;\n\t__le32 Mode;\n\tu8     Sids[];\n\t \n} __packed;\n\n \n#define FS_VOLUME_INFORMATION\t\t1  \n#define FS_LABEL_INFORMATION\t\t2  \n#define FS_SIZE_INFORMATION\t\t3  \n#define FS_DEVICE_INFORMATION\t\t4  \n#define FS_ATTRIBUTE_INFORMATION\t5  \n#define FS_CONTROL_INFORMATION\t\t6  \n#define FS_FULL_SIZE_INFORMATION\t7  \n#define FS_OBJECT_ID_INFORMATION\t8  \n#define FS_DRIVER_PATH_INFORMATION\t9  \n#define FS_SECTOR_SIZE_INFORMATION\t11  \n#define FS_POSIX_INFORMATION\t\t100  \n\nstruct smb2_fs_full_size_info {\n\t__le64 TotalAllocationUnits;\n\t__le64 CallerAvailableAllocationUnits;\n\t__le64 ActualAvailableAllocationUnits;\n\t__le32 SectorsPerAllocationUnit;\n\t__le32 BytesPerSector;\n} __packed;\n\n#define SSINFO_FLAGS_ALIGNED_DEVICE\t\t0x00000001\n#define SSINFO_FLAGS_PARTITION_ALIGNED_ON_DEVICE 0x00000002\n#define SSINFO_FLAGS_NO_SEEK_PENALTY\t\t0x00000004\n#define SSINFO_FLAGS_TRIM_ENABLED\t\t0x00000008\n\n \nstruct smb3_fs_ss_info {\n\t__le32 LogicalBytesPerSector;\n\t__le32 PhysicalBytesPerSectorForAtomicity;\n\t__le32 PhysicalBytesPerSectorForPerf;\n\t__le32 FSEffPhysicalBytesPerSectorForAtomicity;\n\t__le32 Flags;\n\t__le32 ByteOffsetForSectorAlignment;\n\t__le32 ByteOffsetForPartitionAlignment;\n} __packed;\n\n \nstruct smb2_fs_control_info {\n\t__le64 FreeSpaceStartFiltering;\n\t__le64 FreeSpaceThreshold;\n\t__le64 FreeSpaceStopFiltering;\n\t__le64 DefaultQuotaThreshold;\n\t__le64 DefaultQuotaLimit;\n\t__le32 FileSystemControlFlags;\n\t__le32 Padding;\n} __packed;\n\n \n#define MAX_VOL_LABEL_LEN\t32\nstruct smb3_fs_vol_info {\n\t__le64\tVolumeCreationTime;\n\t__u32\tVolumeSerialNumber;\n\t__le32\tVolumeLabelLength;  \n\t__u8\tSupportsObjects;  \n\t__u8\tReserved;\n\t__u8\tVolumeLabel[];  \n} __packed;\n\n \nstruct smb2_oplock_break {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__u8   OplockLevel;\n\t__u8   Reserved;\n\t__le32 Reserved2;\n\t__u64  PersistentFid;\n\t__u64  VolatileFid;\n} __packed;\n\n#define SMB2_NOTIFY_BREAK_LEASE_FLAG_ACK_REQUIRED cpu_to_le32(0x01)\n\nstruct smb2_lease_break {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Epoch;\n\t__le32 Flags;\n\t__u8   LeaseKey[16];\n\t__le32 CurrentLeaseState;\n\t__le32 NewLeaseState;\n\t__le32 BreakReason;\n\t__le32 AccessMaskHint;\n\t__le32 ShareMaskHint;\n} __packed;\n\nstruct smb2_lease_ack {\n\tstruct smb2_hdr hdr;\n\t__le16 StructureSize;  \n\t__le16 Reserved;\n\t__le32 Flags;\n\t__u8   LeaseKey[16];\n\t__le32 LeaseState;\n\t__le64 LeaseDuration;\n} __packed;\n\n#define OP_BREAK_STRUCT_SIZE_20\t\t24\n#define OP_BREAK_STRUCT_SIZE_21\t\t36\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}