{
  "module_name": "nls_euc-jp.c",
  "hash_id": "4e27b23d0643686619885957ac34cb862e8837b3f857cb3d452271560c2e1390",
  "original_prompt": "Ingested from linux-6.6.14/fs/nls/nls_euc-jp.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/nls.h>\n#include <linux/errno.h>\n\nstatic struct nls_table *p_nls;\n\n#define IS_SJIS_LOW_BYTE(l)\t((0x40 <= (l)) && ((l) <= 0xFC) && ((l) != 0x7F))\n \n#define IS_SJIS_JISX0208(h, l)\t((((0x81 <= (h)) && ((h) <= 0x9F))\t\\\n\t\t\t\t || ((0xE0 <= (h)) && ((h) <= 0xEA)))\t\\\n\t\t\t\t && IS_SJIS_LOW_BYTE(l))\n#define IS_SJIS_JISX0201KANA(c)\t((0xA1 <= (c)) && ((c) <= 0xDF))\n#define IS_SJIS_UDC_LOW(h, l)\t(((0xF0 <= (h)) && ((h) <= 0xF4))\t\\\n\t\t\t\t && IS_SJIS_LOW_BYTE(l))\n#define IS_SJIS_UDC_HI(h, l)\t(((0xF5 <= (h)) && ((h) <= 0xF9))\t\\\n\t\t\t\t && IS_SJIS_LOW_BYTE(l))\n#define IS_SJIS_IBM(h, l)\t(((0xFA <= (h)) && ((h) <= 0xFC))\t\\\n\t\t\t\t && IS_SJIS_LOW_BYTE(l))\n#define IS_SJIS_NECIBM(h, l)\t(((0xED <= (h)) && ((h) <= 0xEE))\t\\\n\t\t\t\t && IS_SJIS_LOW_BYTE(l))\n#define MAP_SJIS2EUC(sjis_hi, sjis_lo, sjis_p, euc_hi, euc_lo, euc_p) {\t\t\\\n\tif ((sjis_lo) >= 0x9F) {\t\t\t\t\t\t\\\n\t\t(euc_hi) = (sjis_hi) * 2 - (((sjis_p) * 2 - (euc_p)) - 1);\t\\\n\t\t(euc_lo) = (sjis_lo) + 2;\t\t\t\t\t\\\n\t} else {\t\t\t\t\t\t\t\t\\\n\t\t(euc_hi) = (sjis_hi) * 2 - ((sjis_p) * 2 - (euc_p));\t\t\\\n\t\t(euc_lo) = (sjis_lo) + ((sjis_lo) >= 0x7F ? 0x60 : 0x61);\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n} while(0)\n\n#define SS2\t\t(0x8E)\t\t \n#define SS3\t\t(0x8F)\t\t \n#define IS_EUC_BYTE(c)\t\t((0xA1 <= (c)) && ((c) <= 0xFE))\n#define IS_EUC_JISX0208(h, l)\t(IS_EUC_BYTE(h) && IS_EUC_BYTE(l))\n#define IS_EUC_JISX0201KANA(h, l)\t(((h) == SS2) && (0xA1 <= (l) && (l) <= 0xDF))\n#define IS_EUC_UDC_LOW(h, l)\t(((0xF5 <= (h)) && ((h) <= 0xFE))\t\\\n\t\t\t\t && IS_EUC_BYTE(l))\n#define IS_EUC_UDC_HI(h, l)\tIS_EUC_UDC_LOW(h, l)  \n#define MAP_EUC2SJIS(euc_hi, euc_lo, euc_p, sjis_hi, sjis_lo, sjis_p) {\t\t\\\n\tif ((euc_hi) & 1) {\t\t\t\t\t\t\t\\\n\t\t(sjis_hi) = (euc_hi) / 2 + ((sjis_p) - (euc_p) / 2);\t\t\\\n\t\t(sjis_lo) = (euc_lo) - ((euc_lo) >= 0xE0 ? 0x60 : 0x61);\t\\\n\t} else {\t\t\t\t\t\t\t\t\\\n\t\t(sjis_hi) = (euc_hi) / 2 + (((sjis_p) - (euc_p) / 2) - 1);\t\\\n\t\t(sjis_lo) = (euc_lo) - 2;\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n} while(0)\n\n \nstatic const unsigned char sjisibm2euc_map[][2] = {\n\t{0xF3, 0xF3}, {0xF3, 0xF4}, {0xF3, 0xF5}, {0xF3, 0xF6}, {0xF3, 0xF7},\n\t{0xF3, 0xF8}, {0xF3, 0xF9}, {0xF3, 0xFA}, {0xF3, 0xFB}, {0xF3, 0xFC},\n\t{0xF3, 0xFD}, {0xF3, 0xFE}, {0xF4, 0xA1}, {0xF4, 0xA2}, {0xF4, 0xA3},\n\t{0xF4, 0xA4}, {0xF4, 0xA5}, {0xF4, 0xA6}, {0xF4, 0xA7}, {0xF4, 0xA8},\n\t{0xA2, 0xCC}, {0xA2, 0xC3}, {0xF4, 0xA9}, {0xF4, 0xAA}, {0xF4, 0xAB},\n\t{0xF4, 0xAC}, {0xF4, 0xAD}, {0xA2, 0xE8}, {0xD4, 0xE3}, {0xDC, 0xDF},\n\t{0xE4, 0xE9}, {0xE3, 0xF8}, {0xD9, 0xA1}, {0xB1, 0xBB}, {0xF4, 0xAE},\n\t{0xC2, 0xAD}, {0xC3, 0xFC}, {0xE4, 0xD0}, {0xC2, 0xBF}, {0xBC, 0xF4},\n\t{0xB0, 0xA9}, {0xB0, 0xC8}, {0xF4, 0xAF}, {0xB0, 0xD2}, {0xB0, 0xD4},\n\t{0xB0, 0xE3}, {0xB0, 0xEE}, {0xB1, 0xA7}, {0xB1, 0xA3}, {0xB1, 0xAC},\n\t{0xB1, 0xA9}, {0xB1, 0xBE}, {0xB1, 0xDF}, {0xB1, 0xD8}, {0xB1, 0xC8},\n\t{0xB1, 0xD7}, {0xB1, 0xE3}, {0xB1, 0xF4}, {0xB1, 0xE1}, {0xB2, 0xA3},\n\t{0xF4, 0xB0}, {0xB2, 0xBB}, {0xB2, 0xE6}, {0x00, 0x00}, {0xB2, 0xED},\n\t{0xB2, 0xF5}, {0xB2, 0xFC}, {0xF4, 0xB1}, {0xB3, 0xB5}, {0xB3, 0xD8},\n\t{0xB3, 0xDB}, {0xB3, 0xE5}, {0xB3, 0xEE}, {0xB3, 0xFB}, {0xF4, 0xB2},\n\t{0xF4, 0xB3}, {0xB4, 0xC0}, {0xB4, 0xC7}, {0xB4, 0xD0}, {0xB4, 0xDE},\n\t{0xF4, 0xB4}, {0xB5, 0xAA}, {0xF4, 0xB5}, {0xB5, 0xAF}, {0xB5, 0xC4},\n\t{0xB5, 0xE8}, {0xF4, 0xB6}, {0xB7, 0xC2}, {0xB7, 0xE4}, {0xB7, 0xE8},\n\t{0xB7, 0xE7}, {0xF4, 0xB7}, {0xF4, 0xB8}, {0xF4, 0xB9}, {0xB8, 0xCE},\n\t{0xB8, 0xE1}, {0xB8, 0xF5}, {0xB8, 0xF7}, {0xB8, 0xF8}, {0xB8, 0xFC},\n\t{0xB9, 0xAF}, {0xB9, 0xB7}, {0xBA, 0xBE}, {0xBA, 0xDB}, {0xCD, 0xAA},\n\t{0xBA, 0xE1}, {0xF4, 0xBA}, {0xBA, 0xEB}, {0xBB, 0xB3}, {0xBB, 0xB8},\n\t{0xF4, 0xBB}, {0xBB, 0xCA}, {0xF4, 0xBC}, {0xF4, 0xBD}, {0xBB, 0xD0},\n\t{0xBB, 0xDE}, {0xBB, 0xF4}, {0xBB, 0xF5}, {0xBB, 0xF9}, {0xBC, 0xE4},\n\t{0xBC, 0xED}, {0xBC, 0xFE}, {0xF4, 0xBE}, {0xBD, 0xC2}, {0xBD, 0xE7},\n\t{0xF4, 0xBF}, {0xBD, 0xF0}, {0xBE, 0xB0}, {0xBE, 0xAC}, {0xF4, 0xC0},\n\t{0xBE, 0xB3}, {0xBE, 0xBD}, {0xBE, 0xCD}, {0xBE, 0xC9}, {0xBE, 0xE4},\n\t{0xBF, 0xA8}, {0xBF, 0xC9}, {0xC0, 0xC4}, {0xC0, 0xE4}, {0xC0, 0xF4},\n\t{0xC1, 0xA6}, {0xF4, 0xC1}, {0xC1, 0xF5}, {0xC1, 0xFC}, {0xF4, 0xC2},\n\t{0xC1, 0xF8}, {0xC2, 0xAB}, {0xC2, 0xA1}, {0xC2, 0xA5}, {0xF4, 0xC3},\n\t{0xC2, 0xB8}, {0xC2, 0xBA}, {0xF4, 0xC4}, {0xC2, 0xC4}, {0xC2, 0xD2},\n\t{0xC2, 0xD7}, {0xC2, 0xDB}, {0xC2, 0xDE}, {0xC2, 0xED}, {0xC2, 0xF0},\n\t{0xF4, 0xC5}, {0xC3, 0xA1}, {0xC3, 0xB5}, {0xC3, 0xC9}, {0xC3, 0xB9},\n\t{0xF4, 0xC6}, {0xC3, 0xD8}, {0xC3, 0xFE}, {0xF4, 0xC7}, {0xC4, 0xCC},\n\t{0xF4, 0xC8}, {0xC4, 0xD9}, {0xC4, 0xEA}, {0xC4, 0xFD}, {0xF4, 0xC9},\n\t{0xC5, 0xA7}, {0xC5, 0xB5}, {0xC5, 0xB6}, {0xF4, 0xCA}, {0xC5, 0xD5},\n\t{0xC6, 0xB8}, {0xC6, 0xD7}, {0xC6, 0xE0}, {0xC6, 0xEA}, {0xC6, 0xE3},\n\t{0xC7, 0xA1}, {0xC7, 0xAB}, {0xC7, 0xC7}, {0xC7, 0xC3}, {0xC7, 0xCB},\n\t{0xC7, 0xCF}, {0xC7, 0xD9}, {0xF4, 0xCB}, {0xF4, 0xCC}, {0xC7, 0xE6},\n\t{0xC7, 0xEE}, {0xC7, 0xFC}, {0xC7, 0xEB}, {0xC7, 0xF0}, {0xC8, 0xB1},\n\t{0xC8, 0xE5}, {0xC8, 0xF8}, {0xC9, 0xA6}, {0xC9, 0xAB}, {0xC9, 0xAD},\n\t{0xF4, 0xCD}, {0xC9, 0xCA}, {0xC9, 0xD3}, {0xC9, 0xE9}, {0xC9, 0xE3},\n\t{0xC9, 0xFC}, {0xC9, 0xF4}, {0xC9, 0xF5}, {0xF4, 0xCE}, {0xCA, 0xB3},\n\t{0xCA, 0xBD}, {0xCA, 0xEF}, {0xCA, 0xF1}, {0xCB, 0xAE}, {0xF4, 0xCF},\n\t{0xCB, 0xCA}, {0xCB, 0xE6}, {0xCB, 0xEA}, {0xCB, 0xF0}, {0xCB, 0xF4},\n\t{0xCB, 0xEE}, {0xCC, 0xA5}, {0xCB, 0xF9}, {0xCC, 0xAB}, {0xCC, 0xAE},\n\t{0xCC, 0xAD}, {0xCC, 0xB2}, {0xCC, 0xC2}, {0xCC, 0xD0}, {0xCC, 0xD9},\n\t{0xF4, 0xD0}, {0xCD, 0xBB}, {0xF4, 0xD1}, {0xCE, 0xBB}, {0xF4, 0xD2},\n\t{0xCE, 0xBA}, {0xCE, 0xC3}, {0xF4, 0xD3}, {0xCE, 0xF2}, {0xB3, 0xDD},\n\t{0xCF, 0xD5}, {0xCF, 0xE2}, {0xCF, 0xE9}, {0xCF, 0xED}, {0xF4, 0xD4},\n\t{0xF4, 0xD5}, {0xF4, 0xD6}, {0x00, 0x00}, {0xF4, 0xD7}, {0xD0, 0xE5},\n\t{0xF4, 0xD8}, {0xD0, 0xE9}, {0xD1, 0xE8}, {0xF4, 0xD9}, {0xF4, 0xDA},\n\t{0xD1, 0xEC}, {0xD2, 0xBB}, {0xF4, 0xDB}, {0xD3, 0xE1}, {0xD3, 0xE8},\n\t{0xD4, 0xA7}, {0xF4, 0xDC}, {0xF4, 0xDD}, {0xD4, 0xD4}, {0xD4, 0xF2},\n\t{0xD5, 0xAE}, {0xF4, 0xDE}, {0xD7, 0xDE}, {0xF4, 0xDF}, {0xD8, 0xA2},\n\t{0xD8, 0xB7}, {0xD8, 0xC1}, {0xD8, 0xD1}, {0xD8, 0xF4}, {0xD9, 0xC6},\n\t{0xD9, 0xC8}, {0xD9, 0xD1}, {0xF4, 0xE0}, {0xF4, 0xE1}, {0xF4, 0xE2},\n\t{0xF4, 0xE3}, {0xF4, 0xE4}, {0xDC, 0xD3}, {0xDD, 0xC8}, {0xDD, 0xD4},\n\t{0xDD, 0xEA}, {0xDD, 0xFA}, {0xDE, 0xA4}, {0xDE, 0xB0}, {0xF4, 0xE5},\n\t{0xDE, 0xB5}, {0xDE, 0xCB}, {0xF4, 0xE6}, {0xDF, 0xB9}, {0xF4, 0xE7},\n\t{0xDF, 0xC3}, {0xF4, 0xE8}, {0xF4, 0xE9}, {0xE0, 0xD9}, {0xF4, 0xEA},\n\t{0xF4, 0xEB}, {0xE1, 0xE2}, {0xF4, 0xEC}, {0xF4, 0xED}, {0xF4, 0xEE},\n\t{0xE2, 0xC7}, {0xE3, 0xA8}, {0xE3, 0xA6}, {0xE3, 0xA9}, {0xE3, 0xAF},\n\t{0xE3, 0xB0}, {0xE3, 0xAA}, {0xE3, 0xAB}, {0xE3, 0xBC}, {0xE3, 0xC1},\n\t{0xE3, 0xBF}, {0xE3, 0xD5}, {0xE3, 0xD8}, {0xE3, 0xD6}, {0xE3, 0xDF},\n\t{0xE3, 0xE3}, {0xE3, 0xE1}, {0xE3, 0xD4}, {0xE3, 0xE9}, {0xE4, 0xA6},\n\t{0xE3, 0xF1}, {0xE3, 0xF2}, {0xE4, 0xCB}, {0xE4, 0xC1}, {0xE4, 0xC3},\n\t{0xE4, 0xBE}, {0xF4, 0xEF}, {0xE4, 0xC0}, {0xE4, 0xC7}, {0xE4, 0xBF},\n\t{0xE4, 0xE0}, {0xE4, 0xDE}, {0xE4, 0xD1}, {0xF4, 0xF0}, {0xE4, 0xDC},\n\t{0xE4, 0xD2}, {0xE4, 0xDB}, {0xE4, 0xD4}, {0xE4, 0xFA}, {0xE4, 0xEF},\n\t{0xE5, 0xB3}, {0xE5, 0xBF}, {0xE5, 0xC9}, {0xE5, 0xD0}, {0xE5, 0xE2},\n\t{0xE5, 0xEA}, {0xE5, 0xEB}, {0xF4, 0xF1}, {0xF4, 0xF2}, {0xF4, 0xF3},\n\t{0xE6, 0xE8}, {0xE6, 0xEF}, {0xE7, 0xAC}, {0xF4, 0xF4}, {0xE7, 0xAE},\n\t{0xF4, 0xF5}, {0xE7, 0xB1}, {0xF4, 0xF6}, {0xE7, 0xB2}, {0xE8, 0xB1},\n\t{0xE8, 0xB6}, {0xF4, 0xF7}, {0xF4, 0xF8}, {0xE8, 0xDD}, {0xF4, 0xF9},\n\t{0xF4, 0xFA}, {0xE9, 0xD1}, {0xF4, 0xFB}, {0xE9, 0xED}, {0xEA, 0xCD},\n\t{0xF4, 0xFC}, {0xEA, 0xDB}, {0xEA, 0xE6}, {0xEA, 0xEA}, {0xEB, 0xA5},\n\t{0xEB, 0xFB}, {0xEB, 0xFA}, {0xF4, 0xFD}, {0xEC, 0xD6}, {0xF4, 0xFE},\n};\n\n#define IS_EUC_IBM2JISX0208(h, l) \\\n\t\t(((h) == 0xA2 && (l) == 0xCC) || ((h) == 0xA2 && (l) == 0xE8))\n\n \nstatic struct {\n\tunsigned short euc;\n\tunsigned char sjis[2];\n} euc2sjisibm_jisx0212_map[] = {\n\t{0xA2C3, {0xFA, 0x55}}, {0xB0A9, {0xFA, 0x68}}, {0xB0C8, {0xFA, 0x69}},\n\t{0xB0D2, {0xFA, 0x6B}}, {0xB0D4, {0xFA, 0x6C}}, {0xB0E3, {0xFA, 0x6D}},\n\t{0xB0EE, {0xFA, 0x6E}}, {0xB1A3, {0xFA, 0x70}}, {0xB1A7, {0xFA, 0x6F}},\n\t{0xB1A9, {0xFA, 0x72}}, {0xB1AC, {0xFA, 0x71}}, {0xB1BB, {0xFA, 0x61}},\n\t{0xB1BE, {0xFA, 0x73}}, {0xB1C8, {0xFA, 0x76}}, {0xB1D7, {0xFA, 0x77}},\n\t{0xB1D8, {0xFA, 0x75}}, {0xB1DF, {0xFA, 0x74}}, {0xB1E1, {0xFA, 0x7A}},\n\t{0xB1E3, {0xFA, 0x78}}, {0xB1F4, {0xFA, 0x79}}, {0xB2A3, {0xFA, 0x7B}},\n\t{0xB2BB, {0xFA, 0x7D}}, {0xB2E6, {0xFA, 0x7E}}, {0xB2ED, {0xFA, 0x80}},\n\t{0xB2F5, {0xFA, 0x81}}, {0xB2FC, {0xFA, 0x82}}, {0xB3B5, {0xFA, 0x84}},\n\t{0xB3D8, {0xFA, 0x85}}, {0xB3DB, {0xFA, 0x86}}, {0xB3DD, {0xFB, 0x77}},\n\t{0xB3E5, {0xFA, 0x87}}, {0xB3EE, {0xFA, 0x88}}, {0xB3FB, {0xFA, 0x89}},\n\t{0xB4C0, {0xFA, 0x8C}}, {0xB4C7, {0xFA, 0x8D}}, {0xB4D0, {0xFA, 0x8E}},\n\t{0xB4DE, {0xFA, 0x8F}}, {0xB5AA, {0xFA, 0x91}}, {0xB5AF, {0xFA, 0x93}},\n\t{0xB5C4, {0xFA, 0x94}}, {0xB5E8, {0xFA, 0x95}}, {0xB7C2, {0xFA, 0x97}},\n\t{0xB7E4, {0xFA, 0x98}}, {0xB7E7, {0xFA, 0x9A}}, {0xB7E8, {0xFA, 0x99}},\n\t{0xB8CE, {0xFA, 0x9E}}, {0xB8E1, {0xFA, 0x9F}}, {0xB8F5, {0xFA, 0xA0}},\n\t{0xB8F7, {0xFA, 0xA1}}, {0xB8F8, {0xFA, 0xA2}}, {0xB8FC, {0xFA, 0xA3}},\n\t{0xB9AF, {0xFA, 0xA4}}, {0xB9B7, {0xFA, 0xA5}}, {0xBABE, {0xFA, 0xA6}},\n\t{0xBADB, {0xFA, 0xA7}}, {0xBAE1, {0xFA, 0xA9}}, {0xBAEB, {0xFA, 0xAB}},\n\t{0xBBB3, {0xFA, 0xAC}}, {0xBBB8, {0xFA, 0xAD}}, {0xBBCA, {0xFA, 0xAF}},\n\t{0xBBD0, {0xFA, 0xB2}}, {0xBBDE, {0xFA, 0xB3}}, {0xBBF4, {0xFA, 0xB4}},\n\t{0xBBF5, {0xFA, 0xB5}}, {0xBBF9, {0xFA, 0xB6}}, {0xBCE4, {0xFA, 0xB7}},\n\t{0xBCED, {0xFA, 0xB8}}, {0xBCF4, {0xFA, 0x67}}, {0xBCFE, {0xFA, 0xB9}},\n\t{0xBDC2, {0xFA, 0xBB}}, {0xBDE7, {0xFA, 0xBC}}, {0xBDF0, {0xFA, 0xBE}},\n\t{0xBEAC, {0xFA, 0xC0}}, {0xBEB0, {0xFA, 0xBF}}, {0xBEB3, {0xFA, 0xC2}},\n\t{0xBEBD, {0xFA, 0xC3}}, {0xBEC9, {0xFA, 0xC5}}, {0xBECD, {0xFA, 0xC4}},\n\t{0xBEE4, {0xFA, 0xC6}}, {0xBFA8, {0xFA, 0xC7}}, {0xBFC9, {0xFA, 0xC8}},\n\t{0xC0C4, {0xFA, 0xC9}}, {0xC0E4, {0xFA, 0xCA}}, {0xC0F4, {0xFA, 0xCB}},\n\t{0xC1A6, {0xFA, 0xCC}}, {0xC1F5, {0xFA, 0xCE}}, {0xC1F8, {0xFA, 0xD1}},\n\t{0xC1FC, {0xFA, 0xCF}}, {0xC2A1, {0xFA, 0xD3}}, {0xC2A5, {0xFA, 0xD4}},\n\t{0xC2AB, {0xFA, 0xD2}}, {0xC2AD, {0xFA, 0x63}}, {0xC2B8, {0xFA, 0xD6}},\n\t{0xC2BA, {0xFA, 0xD7}}, {0xC2BF, {0xFA, 0x66}}, {0xC2C4, {0xFA, 0xD9}},\n\t{0xC2D2, {0xFA, 0xDA}}, {0xC2D7, {0xFA, 0xDB}}, {0xC2DB, {0xFA, 0xDC}},\n\t{0xC2DE, {0xFA, 0xDD}}, {0xC2ED, {0xFA, 0xDE}}, {0xC2F0, {0xFA, 0xDF}},\n\t{0xC3A1, {0xFA, 0xE1}}, {0xC3B5, {0xFA, 0xE2}}, {0xC3B9, {0xFA, 0xE4}},\n\t{0xC3C9, {0xFA, 0xE3}}, {0xC3D8, {0xFA, 0xE6}}, {0xC3FC, {0xFA, 0x64}},\n\t{0xC3FE, {0xFA, 0xE7}}, {0xC4CC, {0xFA, 0xE9}}, {0xC4D9, {0xFA, 0xEB}},\n\t{0xC4EA, {0xFA, 0xEC}}, {0xC4FD, {0xFA, 0xED}}, {0xC5A7, {0xFA, 0xEF}},\n\t{0xC5B5, {0xFA, 0xF0}}, {0xC5B6, {0xFA, 0xF1}}, {0xC5D5, {0xFA, 0xF3}},\n\t{0xC6B8, {0xFA, 0xF4}}, {0xC6D7, {0xFA, 0xF5}}, {0xC6E0, {0xFA, 0xF6}},\n\t{0xC6E3, {0xFA, 0xF8}}, {0xC6EA, {0xFA, 0xF7}}, {0xC7A1, {0xFA, 0xF9}},\n\t{0xC7AB, {0xFA, 0xFA}}, {0xC7C3, {0xFA, 0xFC}}, {0xC7C7, {0xFA, 0xFB}},\n\t{0xC7CB, {0xFB, 0x40}}, {0xC7CF, {0xFB, 0x41}}, {0xC7D9, {0xFB, 0x42}},\n\t{0xC7E6, {0xFB, 0x45}}, {0xC7EB, {0xFB, 0x48}}, {0xC7EE, {0xFB, 0x46}},\n\t{0xC7F0, {0xFB, 0x49}}, {0xC7FC, {0xFB, 0x47}}, {0xC8B1, {0xFB, 0x4A}},\n\t{0xC8E5, {0xFB, 0x4B}}, {0xC8F8, {0xFB, 0x4C}}, {0xC9A6, {0xFB, 0x4D}},\n\t{0xC9AB, {0xFB, 0x4E}}, {0xC9AD, {0xFB, 0x4F}}, {0xC9CA, {0xFB, 0x51}},\n\t{0xC9D3, {0xFB, 0x52}}, {0xC9E3, {0xFB, 0x54}}, {0xC9E9, {0xFB, 0x53}},\n\t{0xC9F4, {0xFB, 0x56}}, {0xC9F5, {0xFB, 0x57}}, {0xC9FC, {0xFB, 0x55}},\n\t{0xCAB3, {0xFB, 0x59}}, {0xCABD, {0xFB, 0x5A}}, {0xCAEF, {0xFB, 0x5B}},\n\t{0xCAF1, {0xFB, 0x5C}}, {0xCBAE, {0xFB, 0x5D}}, {0xCBCA, {0xFB, 0x5F}},\n\t{0xCBE6, {0xFB, 0x60}}, {0xCBEA, {0xFB, 0x61}}, {0xCBEE, {0xFB, 0x64}},\n\t{0xCBF0, {0xFB, 0x62}}, {0xCBF4, {0xFB, 0x63}}, {0xCBF9, {0xFB, 0x66}},\n\t{0xCCA5, {0xFB, 0x65}}, {0xCCAB, {0xFB, 0x67}}, {0xCCAD, {0xFB, 0x69}},\n\t{0xCCAE, {0xFB, 0x68}}, {0xCCB2, {0xFB, 0x6A}}, {0xCCC2, {0xFB, 0x6B}},\n\t{0xCCD0, {0xFB, 0x6C}}, {0xCCD9, {0xFB, 0x6D}}, {0xCDAA, {0xFA, 0xA8}},\n\t{0xCDBB, {0xFB, 0x6F}}, {0xCEBA, {0xFB, 0x73}}, {0xCEBB, {0xFB, 0x71}},\n\t{0xCEC3, {0xFB, 0x74}}, {0xCEF2, {0xFB, 0x76}}, {0xCFD5, {0xFB, 0x78}},\n\t{0xCFE2, {0xFB, 0x79}}, {0xCFE9, {0xFB, 0x7A}}, {0xCFED, {0xFB, 0x7B}},\n\t{0xD0E5, {0xFB, 0x81}}, {0xD0E9, {0xFB, 0x83}}, {0xD1E8, {0xFB, 0x84}},\n\t{0xD1EC, {0xFB, 0x87}}, {0xD2BB, {0xFB, 0x88}}, {0xD3E1, {0xFB, 0x8A}},\n\t{0xD3E8, {0xFB, 0x8B}}, {0xD4A7, {0xFB, 0x8C}}, {0xD4D4, {0xFB, 0x8F}},\n\t{0xD4E3, {0xFA, 0x5C}}, {0xD4F2, {0xFB, 0x90}}, {0xD5AE, {0xFB, 0x91}},\n\t{0xD7DE, {0xFB, 0x93}}, {0xD8A2, {0xFB, 0x95}}, {0xD8B7, {0xFB, 0x96}},\n\t{0xD8C1, {0xFB, 0x97}}, {0xD8D1, {0xFB, 0x98}}, {0xD8F4, {0xFB, 0x99}},\n\t{0xD9A1, {0xFA, 0x60}}, {0xD9C6, {0xFB, 0x9A}}, {0xD9C8, {0xFB, 0x9B}},\n\t{0xD9D1, {0xFB, 0x9C}}, {0xDCD3, {0xFB, 0xA2}}, {0xDCDF, {0xFA, 0x5D}},\n\t{0xDDC8, {0xFB, 0xA3}}, {0xDDD4, {0xFB, 0xA4}}, {0xDDEA, {0xFB, 0xA5}},\n\t{0xDDFA, {0xFB, 0xA6}}, {0xDEA4, {0xFB, 0xA7}}, {0xDEB0, {0xFB, 0xA8}},\n\t{0xDEB5, {0xFB, 0xAA}}, {0xDECB, {0xFB, 0xAB}}, {0xDFB9, {0xFB, 0xAD}},\n\t{0xDFC3, {0xFB, 0xAF}}, {0xE0D9, {0xFB, 0xB2}}, {0xE1E2, {0xFB, 0xB5}},\n\t{0xE2C7, {0xFB, 0xB9}}, {0xE3A6, {0xFB, 0xBB}}, {0xE3A8, {0xFB, 0xBA}},\n\t{0xE3A9, {0xFB, 0xBC}}, {0xE3AA, {0xFB, 0xBF}}, {0xE3AB, {0xFB, 0xC0}},\n\t{0xE3AF, {0xFB, 0xBD}}, {0xE3B0, {0xFB, 0xBE}}, {0xE3BC, {0xFB, 0xC1}},\n\t{0xE3BF, {0xFB, 0xC3}}, {0xE3C1, {0xFB, 0xC2}}, {0xE3D4, {0xFB, 0xCA}},\n\t{0xE3D5, {0xFB, 0xC4}}, {0xE3D6, {0xFB, 0xC6}}, {0xE3D8, {0xFB, 0xC5}},\n\t{0xE3DF, {0xFB, 0xC7}}, {0xE3E1, {0xFB, 0xC9}}, {0xE3E3, {0xFB, 0xC8}},\n\t{0xE3E9, {0xFB, 0xCB}}, {0xE3F1, {0xFB, 0xCD}}, {0xE3F2, {0xFB, 0xCE}},\n\t{0xE3F8, {0xFA, 0x5F}}, {0xE4A6, {0xFB, 0xCC}}, {0xE4BE, {0xFB, 0xD2}},\n\t{0xE4BF, {0xFB, 0xD6}}, {0xE4C0, {0xFB, 0xD4}}, {0xE4C1, {0xFB, 0xD0}},\n\t{0xE4C3, {0xFB, 0xD1}}, {0xE4C7, {0xFB, 0xD5}}, {0xE4CB, {0xFB, 0xCF}},\n\t{0xE4D0, {0xFA, 0x65}}, {0xE4D1, {0xFB, 0xD9}}, {0xE4D2, {0xFB, 0xDC}},\n\t{0xE4D4, {0xFB, 0xDE}}, {0xE4DB, {0xFB, 0xDD}}, {0xE4DC, {0xFB, 0xDB}},\n\t{0xE4DE, {0xFB, 0xD8}}, {0xE4E0, {0xFB, 0xD7}}, {0xE4E9, {0xFA, 0x5E}},\n\t{0xE4EF, {0xFB, 0xE0}}, {0xE4FA, {0xFB, 0xDF}}, {0xE5B3, {0xFB, 0xE1}},\n\t{0xE5BF, {0xFB, 0xE2}}, {0xE5C9, {0xFB, 0xE3}}, {0xE5D0, {0xFB, 0xE4}},\n\t{0xE5E2, {0xFB, 0xE5}}, {0xE5EA, {0xFB, 0xE6}}, {0xE5EB, {0xFB, 0xE7}},\n\t{0xE6E8, {0xFB, 0xEB}}, {0xE6EF, {0xFB, 0xEC}}, {0xE7AC, {0xFB, 0xED}},\n\t{0xE7AE, {0xFB, 0xEF}}, {0xE7B1, {0xFB, 0xF1}}, {0xE7B2, {0xFB, 0xF3}},\n\t{0xE8B1, {0xFB, 0xF4}}, {0xE8B6, {0xFB, 0xF5}}, {0xE8DD, {0xFB, 0xF8}},\n\t{0xE9D1, {0xFB, 0xFB}}, {0xE9ED, {0xFC, 0x40}}, {0xEACD, {0xFC, 0x41}},\n\t{0xEADB, {0xFC, 0x43}}, {0xEAE6, {0xFC, 0x44}}, {0xEAEA, {0xFC, 0x45}},\n\t{0xEBA5, {0xFC, 0x46}}, {0xEBFA, {0xFC, 0x48}}, {0xEBFB, {0xFC, 0x47}},\n\t{0xECD6, {0xFC, 0x4A}},\n};\n\n \nstatic const unsigned char euc2sjisibm_g3upper_map[][2] = {\n\t{0xFA, 0x40}, {0xFA, 0x41}, {0xFA, 0x42}, {0xFA, 0x43}, {0xFA, 0x44},\n\t{0xFA, 0x45}, {0xFA, 0x46}, {0xFA, 0x47}, {0xFA, 0x48}, {0xFA, 0x49},\n\t{0xFA, 0x4A}, {0xFA, 0x4B}, {0xFA, 0x4C}, {0xFA, 0x4D}, {0xFA, 0x4E},\n\t{0xFA, 0x4F}, {0xFA, 0x50}, {0xFA, 0x51}, {0xFA, 0x52}, {0xFA, 0x53},\n\t{0xFA, 0x56}, {0xFA, 0x57}, {0xFA, 0x58}, {0xFA, 0x59}, {0xFA, 0x5A},\n\t{0xFA, 0x62}, {0xFA, 0x6A}, {0xFA, 0x7C}, {0xFA, 0x83}, {0xFA, 0x8A},\n\t{0xFA, 0x8B}, {0xFA, 0x90}, {0xFA, 0x92}, {0xFA, 0x96}, {0xFA, 0x9B},\n\t{0xFA, 0x9C}, {0xFA, 0x9D}, {0xFA, 0xAA}, {0xFA, 0xAE}, {0xFA, 0xB0},\n\t{0xFA, 0xB1}, {0xFA, 0xBA}, {0xFA, 0xBD}, {0xFA, 0xC1}, {0xFA, 0xCD},\n\t{0xFA, 0xD0}, {0xFA, 0xD5}, {0xFA, 0xD8}, {0xFA, 0xE0}, {0xFA, 0xE5},\n\t{0xFA, 0xE8}, {0xFA, 0xEA}, {0xFA, 0xEE}, {0xFA, 0xF2}, {0xFB, 0x43},\n\t{0xFB, 0x44}, {0xFB, 0x50}, {0xFB, 0x58}, {0xFB, 0x5E}, {0xFB, 0x6E},\n\t{0xFB, 0x70}, {0xFB, 0x72}, {0xFB, 0x75}, {0xFB, 0x7C}, {0xFB, 0x7D},\n\t{0xFB, 0x7E}, {0xFB, 0x80}, {0xFB, 0x82}, {0xFB, 0x85}, {0xFB, 0x86},\n\t{0xFB, 0x89}, {0xFB, 0x8D}, {0xFB, 0x8E}, {0xFB, 0x92}, {0xFB, 0x94},\n\t{0xFB, 0x9D}, {0xFB, 0x9E}, {0xFB, 0x9F}, {0xFB, 0xA0}, {0xFB, 0xA1},\n\t{0xFB, 0xA9}, {0xFB, 0xAC}, {0xFB, 0xAE}, {0xFB, 0xB0}, {0xFB, 0xB1},\n\t{0xFB, 0xB3}, {0xFB, 0xB4}, {0xFB, 0xB6}, {0xFB, 0xB7}, {0xFB, 0xB8},\n\t{0xFB, 0xD3}, {0xFB, 0xDA}, {0xFB, 0xE8}, {0xFB, 0xE9}, {0xFB, 0xEA},\n\t{0xFB, 0xEE}, {0xFB, 0xF0}, {0xFB, 0xF2}, {0xFB, 0xF6}, {0xFB, 0xF7},\n\t{0xFB, 0xF9}, {0xFB, 0xFA}, {0xFB, 0xFC}, {0xFC, 0x42}, {0xFC, 0x49},\n\t{0xFC, 0x4B},\n};\n\nstatic inline int sjisibm2euc(unsigned char *euc, const unsigned char sjis_hi,\n\t\t\t      const unsigned char sjis_lo);\nstatic inline int euc2sjisibm_jisx0212(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t\t       const unsigned char euc_lo);\nstatic inline int euc2sjisibm_g3upper(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t\t      const unsigned char euc_lo);\nstatic inline int euc2sjisibm(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t      const unsigned char euc_lo);\nstatic inline int sjisnec2sjisibm(unsigned char *sjisibm,\n\t\t\t\t  const unsigned char sjisnec_hi,\n\t\t\t\t  const unsigned char sjisnec_lo);\n\n \nstatic inline int sjisibm2euc(unsigned char *euc, const unsigned char sjis_hi,\n\t\t\t      const unsigned char sjis_lo)\n{\n\tint index;\n\n\tindex = ((sjis_hi - 0xFA) * (0xFD - 0x40)) + (sjis_lo - 0x40);\n\tif (IS_EUC_IBM2JISX0208(sjisibm2euc_map[index][0],\n\t\t\t\tsjisibm2euc_map[index][1])) {\n\t\teuc[0] = sjisibm2euc_map[index][0];\n\t\teuc[1] = sjisibm2euc_map[index][1];\n\t\treturn 2;\n\t} else {\n\t\teuc[0] = SS3;\n\t\teuc[1] = sjisibm2euc_map[index][0];\n\t\teuc[2] = sjisibm2euc_map[index][1];\n\t\treturn 3;\n\t}\n}\n\n \nstatic inline int euc2sjisibm_jisx0212(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t\t       const unsigned char euc_lo)\n{\n\tint index, min_index, max_index;\n\tunsigned short euc;\n\n\tmin_index = 0;\n\tmax_index = ARRAY_SIZE(euc2sjisibm_jisx0212_map) - 1;\n\teuc = (euc_hi << 8) | euc_lo;\n\n\twhile (min_index <= max_index) {\n\t\tindex = (min_index + max_index) / 2;\n\t\tif (euc < euc2sjisibm_jisx0212_map[index].euc)\n\t\t\tmax_index = index - 1;\n\t\telse\n\t\t\tmin_index = index + 1;\n\t\tif (euc == euc2sjisibm_jisx0212_map[index].euc) {\n\t\t\tsjis[0] = euc2sjisibm_jisx0212_map[index].sjis[0];\n\t\t\tsjis[1] = euc2sjisibm_jisx0212_map[index].sjis[1];\n\t\t\treturn 3;\n\t\t}\n\t}\n\treturn 0;\n}\n\n \nstatic inline int euc2sjisibm_g3upper(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t\t      const unsigned char euc_lo)\n{\n\tint index;\n\n\tif (euc_hi == 0xF3)\n\t\tindex = ((euc_hi << 8) | euc_lo) - 0xF3F3;\n\telse\n\t\tindex = ((euc_hi << 8) | euc_lo) - 0xF4A1 + 12;\n\n\tif ((index < 0) || (index >= ARRAY_SIZE(euc2sjisibm_g3upper_map)))\n\t\treturn 0;\n\n\tsjis[0] = euc2sjisibm_g3upper_map[index][0];\n\tsjis[1] = euc2sjisibm_g3upper_map[index][1];\n\n\treturn 3;\n}\n\n \nstatic inline int euc2sjisibm(unsigned char *sjis, const unsigned char euc_hi,\n\t\t\t      const unsigned char euc_lo)\n{\n\tint n;\n\n#if 0\n\tif ((euc_hi == 0xA2) && (euc_lo == 0xCC)) {\n\t\tsjis[0] = 0xFA;\n\t\tsjis[1] = 0x54;\n\t\treturn 2;\n\t} else if ((euc_hi == 0xA2) && (euc_lo == 0xE8)) {\n\t\tsjis[0] = 0xFA;\n\t\tsjis[1] = 0x5B;\n\t\treturn 2;\n\t}\n#endif\n\tif ((n = euc2sjisibm_g3upper(sjis, euc_hi, euc_lo))) {\n\t\treturn n;\n\t} else if ((n = euc2sjisibm_jisx0212(sjis, euc_hi, euc_lo))) {\n\t\treturn n;\n\t}\n\n\treturn 0;\n}\n\n \nstatic inline int sjisnec2sjisibm(unsigned char *sjisibm,\n\t\t\t\t  const unsigned char sjisnec_hi,\n\t\t\t\t  const unsigned char sjisnec_lo)\n{\n\tint count;\n\n\tif (! IS_SJIS_NECIBM(sjisnec_hi, sjisnec_lo))\n\t\treturn 0;\n\n\tif ((sjisnec_hi == 0xEE) && (sjisnec_lo == 0xF9)) {\n\t\tsjisibm[0] = 0x81;\n\t\tsjisibm[1] = 0xCA;\n\t\treturn 2;\n\t}\n\n\tif ((sjisnec_hi == 0xEE) && (sjisnec_lo >= 0xEF)) {\n\t\tcount = (sjisnec_hi << 8 | sjisnec_lo)\n\t\t\t- (sjisnec_lo <= 0xF9 ? 0xEEEF : (0xEEEF - 10));\n\t} else {\n\t\tcount = (sjisnec_hi - 0xED) * (0xFC - 0x40)\n\t\t\t+ (sjisnec_lo - 0x40) + (0x5C - 0x40);\n\t\tif (sjisnec_lo >= 0x7F)\n\t\t\tcount--;\n\t}\n\n\tsjisibm[0] = 0xFA + (count / (0xFC - 0x40));\n\tsjisibm[1] = 0x40 + (count % (0xFC - 0x40));\n\tif (sjisibm[1] >= 0x7F)\n\t\tsjisibm[1]++;\n\n\treturn 2;\n}\n\nstatic int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tint n;\n\n\tif (!p_nls)\n\t\treturn -EINVAL;\n\tif ((n = p_nls->uni2char(uni, out, boundlen)) < 0)\n\t\treturn n;\n\n\t \n\tif (n == 1) {\n\t\tif (IS_SJIS_JISX0201KANA(out[0])) {\n\t\t\t \n\t\t\tif (boundlen < 2)\n\t\t\t\treturn -ENAMETOOLONG;\n\n\t\t\tout[1] = out[0];\n\t\t\tout[0] = SS2;\n\t\t\treturn 2;\n\t\t}\n\t} else if (n == 2) {\n\t\t \n\t\tsjisnec2sjisibm(out, out[0], out[1]);\n\n\t\tif (IS_SJIS_UDC_LOW(out[0], out[1])) {\n\t\t\t \n\t\t\tMAP_SJIS2EUC(out[0], out[1], 0xF0, out[0], out[1], 0xF5);\n\t\t} else if (IS_SJIS_UDC_HI(out[0], out[1])) {\n\t\t\t \n\t\t\tunsigned char ch, cl;\n\n\t\t\tif (boundlen < 3)\n\t\t\t\treturn -ENAMETOOLONG;\n\n\t\t\tn = 3; ch = out[0]; cl = out[1];\n\t\t\tout[0] = SS3;\n\t\t\tMAP_SJIS2EUC(ch, cl, 0xF5, out[1], out[2], 0xF5);\n\t\t} else if (IS_SJIS_IBM(out[0], out[1])) {\n\t\t\t \n\t\t\tunsigned char euc[3], i;\n\n\t\t\tn = sjisibm2euc(euc, out[0], out[1]);\n\t\t\tif (boundlen < n)\n\t\t\t\treturn -ENAMETOOLONG;\n\t\t\tfor (i = 0; i < n; i++)\n\t\t\t\tout[i] = euc[i];\n\t\t} else if (IS_SJIS_JISX0208(out[0], out[1])) {\n\t\t\t \n\t\t\tout[0] = (out[0]^0xA0)*2 + 0x5F;\n\t\t\tif (out[1] > 0x9E)\n\t\t\t\tout[0]++;\n\n\t\t\tif (out[1] < 0x7F)\n\t\t\t\tout[1] = out[1] + 0x61;\n\t\t\telse if (out[1] < 0x9F)\n\t\t\t\tout[1] = out[1] + 0x60;\n\t\t\telse\n\t\t\t\tout[1] = out[1] + 0x02;\n\t\t} else {\n\t\t\t \n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\telse\n\t\treturn -EINVAL;\n\n\treturn n;\n}\n\nstatic int char2uni(const unsigned char *rawstring, int boundlen,\n\t\t    wchar_t *uni)\n{\n\tunsigned char sjis_temp[2];\n\tint euc_offset, n;\n\n\tif ( !p_nls )\n\t\treturn -EINVAL;\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\t \n\tif (rawstring[0] > 0x7F) {\n\t\tif (rawstring[0] == SS3) {\n\t\t\tif (boundlen < 3)\n\t\t\t\treturn -EINVAL;\n\t\t\teuc_offset = 3;\n\n\t\t\tif (IS_EUC_UDC_HI(rawstring[1], rawstring[2])) {\n\t\t\t\t \n\t\t\t\tMAP_EUC2SJIS(rawstring[1], rawstring[2], 0xF5,\n\t\t\t\t\t     sjis_temp[0], sjis_temp[1], 0xF5);\n\t\t\t} else if (euc2sjisibm(sjis_temp,rawstring[1],rawstring[2])) {\n\t\t\t\t \n\t\t\t} else {\n\t\t\t\t \n\t\t\t\treturn -EINVAL;\n\n\t\t\t\t \n\t\t\t\t \n\t\t\t\t \n\t\t\t}\n\t\t} else {\n\t\t\tif (boundlen < 2)\n\t\t\t\treturn -EINVAL;\n\t\t\teuc_offset = 2;\n\n\t\t\tif (IS_EUC_JISX0201KANA(rawstring[0], rawstring[1])) {\n\t\t\t\t \n\t\t\t\tsjis_temp[0] = rawstring[1];\n\t\t\t\tsjis_temp[1] = 0x00;\n\t\t\t} else if (IS_EUC_UDC_LOW(rawstring[0], rawstring[1])) {\n\t\t\t\t \n\t\t\t\tMAP_EUC2SJIS(rawstring[0], rawstring[1], 0xF5,\n\t\t\t\t\t     sjis_temp[0], sjis_temp[1], 0xF0);\n\t\t\t} else if (IS_EUC_JISX0208(rawstring[0], rawstring[1])) {\n\t\t\t\t \n\t\t\t\tsjis_temp[0] = ((rawstring[0]-0x5f)/2) ^ 0xA0;\n\t\t\t\tif (!(rawstring[0] & 1))\n\t\t\t\t\tsjis_temp[1] = rawstring[1] - 0x02;\n\t\t\t\telse if (rawstring[1] < 0xE0)\n\t\t\t\t\tsjis_temp[1] = rawstring[1] - 0x61;\n\t\t\t\telse\n\t\t\t\t\tsjis_temp[1] = rawstring[1] - 0x60;\n\t\t\t} else {\n\t\t\t\t \n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\t\t}\n\t} else {\n\t\teuc_offset = 1;\n\n\t\t \n\t\tsjis_temp[0] = rawstring[0];\n\t\tsjis_temp[1] = 0x00;\n\t}\n\n\tif ( (n = p_nls->char2uni(sjis_temp, sizeof(sjis_temp), uni)) < 0)\n\t\treturn n;\n\n\treturn euc_offset;\n}\n\nstatic struct nls_table table = {\n\t.charset\t= \"euc-jp\",\n\t.uni2char\t= uni2char,\n\t.char2uni\t= char2uni,\n};\n\nstatic int __init init_nls_euc_jp(void)\n{\n\tp_nls = load_nls(\"cp932\");\n\n\tif (p_nls) {\n\t\ttable.charset2upper = p_nls->charset2upper;\n\t\ttable.charset2lower = p_nls->charset2lower;\n\t\treturn register_nls(&table);\n\t}\n\n\treturn -EINVAL;\n}\n\nstatic void __exit exit_nls_euc_jp(void)\n{\n\tunregister_nls(&table);\n\tunload_nls(p_nls);\n}\n\nmodule_init(init_nls_euc_jp)\nmodule_exit(exit_nls_euc_jp)\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}