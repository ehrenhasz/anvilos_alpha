{
  "module_name": "inode.c",
  "hash_id": "6863416169feebbc22481bda78d07760a7f21b414fde61dd76c7e97a31c9f98a",
  "original_prompt": "Ingested from linux-6.6.14/fs/befs/inode.c",
  "human_readable_source": "\n \n\n#include <linux/fs.h>\n\n#include \"befs.h\"\n#include \"inode.h\"\n\n \nint\nbefs_check_inode(struct super_block *sb, befs_inode *raw_inode,\n\t\t befs_blocknr_t inode)\n{\n\tu32 magic1 = fs32_to_cpu(sb, raw_inode->magic1);\n\tbefs_inode_addr ino_num = fsrun_to_cpu(sb, raw_inode->inode_num);\n\tu32 flags = fs32_to_cpu(sb, raw_inode->flags);\n\n\t \n\tif (magic1 != BEFS_INODE_MAGIC1) {\n\t\tbefs_error(sb,\n\t\t\t   \"Inode has a bad magic header - inode = %lu\",\n\t\t\t   (unsigned long)inode);\n\t\treturn BEFS_BAD_INODE;\n\t}\n\n\t \n\tif (inode != iaddr2blockno(sb, &ino_num)) {\n\t\tbefs_error(sb, \"inode blocknr field disagrees with vfs \"\n\t\t\t   \"VFS: %lu, Inode %lu\", (unsigned long)\n\t\t\t   inode, (unsigned long)iaddr2blockno(sb, &ino_num));\n\t\treturn BEFS_BAD_INODE;\n\t}\n\n\t \n\n\tif (!(flags & BEFS_INODE_IN_USE)) {\n\t\tbefs_error(sb, \"inode is not used - inode = %lu\",\n\t\t\t   (unsigned long)inode);\n\t\treturn BEFS_BAD_INODE;\n\t}\n\n\treturn BEFS_OK;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}