{
  "module_name": "get_dvb_firmware",
  "hash_id": "57b5b239e076ff0e3b636a48247b6d3f2ff1724c8b550d6c349857f48d200a9b",
  "original_prompt": "Ingested from linux-6.6.14/scripts/get_dvb_firmware",
  "human_readable_source": "#!/usr/bin/env perl\n# SPDX-License-Identifier: GPL-2.0-or-later\n#     DVB firmware extractor\n#\n#     (c) 2004 Andrew de Quincey\n#\n\nuse File::Temp qw/ tempdir /;\nuse IO::Handle;\n\n@components = ( \"sp8870\", \"sp887x\", \"tda10045\", \"tda10046\",\n\t\t\"tda10046lifeview\", \"av7110\", \"dec2000t\", \"dec2540t\",\n\t\t\"dec3000s\", \"vp7041\", \"vp7049\", \"dibusb\", \"nxt2002\", \"nxt2004\",\n\t\t\"or51211\", \"or51132_qam\", \"or51132_vsb\", \"bluebird\",\n\t\t\"opera1\", \"cx231xx\", \"cx18\", \"cx23885\", \"pvrusb2\", \"mpc718\",\n\t\t\"af9015\", \"ngene\", \"az6027\", \"lme2510_lg\", \"lme2510c_s7395\",\n\t\t\"lme2510c_s7395_old\", \"drxk\", \"drxk_terratec_h5\",\n\t\t\"drxk_hauppauge_hvr930c\", \"tda10071\", \"it9135\", \"drxk_pctv\",\n\t\t\"drxk_terratec_htc_stick\", \"sms1xxx_hcw\", \"si2165\");\n\n# Check args\nsyntax() if (scalar(@ARGV) != 1);\n$cid = $ARGV[0];\n\n# Do it!\nfor ($i=0; $i < scalar(@components); $i++) {\n    if ($cid eq $components[$i]) {\n\t$outfile = eval($cid);\n\tdie $@ if $@;\n\tprint STDERR <<EOF;\nFirmware(s) $outfile extracted successfully.\nNow copy it(them) to either /usr/lib/hotplug/firmware or /lib/firmware\n(depending on configuration of firmware hotplug).\nEOF\n\texit(0);\n    }\n}\n\n# If we get here, it wasn't found\nprint STDERR \"Unknown component \\\"$cid\\\"\\n\";\nsyntax();\n\n\n\n\n# ---------------------------------------------------------------\n# Firmware-specific extraction subroutines\n\nsub sp8870 {\n    my $sourcefile = \"tt_Premium_217g.zip\";\n    my $url = \"http://www.softwarepatch.pl/9999ccd06a4813cb827dbb0005071c71/$sourcefile\";\n    my $hash = \"53970ec17a538945a6d8cb608a7b3899\";\n    my $outfile = \"dvb-fe-sp8870.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/software/OEM/HE/App/boot/SC_MAIN.MC\", $hash);\n    copy(\"$tmpdir/software/OEM/HE/App/boot/SC_MAIN.MC\", $outfile);\n\n    $outfile;\n}\n\nsub sp887x {\n    my $sourcefile = \"Dvbt1.3.57.6.zip\";\n    my $url = \"http://www.avermedia.com/software/$sourcefile\";\n    my $cabfile = \"DVBT Net  Ver1.3.57.6/disk1/data1.cab\";\n    my $hash = \"237938d53a7f834c05c42b894ca68ac3\";\n    my $outfile = \"dvb-fe-sp887x.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n    checkunshield();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    unshield(\"$tmpdir/$cabfile\", $tmpdir);\n    verify(\"$tmpdir/ZEnglish/sc_main.mc\", $hash);\n    copy(\"$tmpdir/ZEnglish/sc_main.mc\", $outfile);\n\n    $outfile;\n}\n\nsub tda10045 {\n    my $sourcefile = \"tt_budget_217g.zip\";\n    my $url = \"http://www.technotrend.de/new/217g/$sourcefile\";\n    my $hash = \"2105fd5bf37842fbcdfa4bfd58f3594a\";\n    my $outfile = \"dvb-fe-tda10045.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/software/OEM/PCI/App/ttlcdacc.dll\", 0x37ef9, 30555, \"$tmpdir/fwtmp\");\n    verify(\"$tmpdir/fwtmp\", $hash);\n    copy(\"$tmpdir/fwtmp\", $outfile);\n\n    $outfile;\n}\n\nsub tda10046 {\n\tmy $sourcefile = \"TT_PCI_2.19h_28_11_2006.zip\";\n\tmy $url = \"http://technotrend.com.ua/download/software/219/$sourcefile\";\n\tmy $hash = \"6a7e1e2f2644b162ff0502367553c72d\";\n\tmy $outfile = \"dvb-fe-tda10046.fw\";\n\tmy $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n\tcheckstandard();\n\n\twgetfile($sourcefile, $url);\n\tunzip($sourcefile, $tmpdir);\n\textract(\"$tmpdir/TT_PCI_2.19h_28_11_2006/software/OEM/PCI/App/ttlcdacc.dll\", 0x65389, 24478, \"$tmpdir/fwtmp\");\n\tverify(\"$tmpdir/fwtmp\", $hash);\n\tcopy(\"$tmpdir/fwtmp\", $outfile);\n\n\t$outfile;\n}\n\nsub tda10046lifeview {\n    my $sourcefile = \"7%5Cdrv_2.11.02.zip\";\n    my $url = \"http://www.lifeview.hk/dbimages/document/$sourcefile\";\n    my $hash = \"1ea24dee4eea8fe971686981f34fd2e0\";\n    my $outfile = \"dvb-fe-tda10046.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/LVHybrid.sys\", 0x8b088, 24602, \"$tmpdir/fwtmp\");\n    verify(\"$tmpdir/fwtmp\", $hash);\n    copy(\"$tmpdir/fwtmp\", $outfile);\n\n    $outfile;\n}\n\nsub av7110 {\n    my $sourcefile = \"dvb-ttpci-01.fw-261d\";\n    my $url = \"https://linuxtv.org/downloads/firmware/$sourcefile\";\n    my $hash = \"603431b6259715a8e88f376a53b64e2f\";\n    my $outfile = \"dvb-ttpci-01.fw\";\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    verify($sourcefile, $hash);\n    copy($sourcefile, $outfile);\n\n    $outfile;\n}\n\nsub dec2000t {\n    my $sourcefile = \"dec217g.exe\";\n    my $url = \"http://hauppauge.lightpath.net/de/$sourcefile\";\n    my $hash = \"bd86f458cee4a8f0a8ce2d20c66215a9\";\n    my $outfile = \"dvb-ttusb-dec-2000t.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_T.bin\", $hash);\n    copy(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_T.bin\", $outfile);\n\n    $outfile;\n}\n\nsub dec2540t {\n    my $sourcefile = \"dec217g.exe\";\n    my $url = \"http://hauppauge.lightpath.net/de/$sourcefile\";\n    my $hash = \"53e58f4f5b5c2930beee74a7681fed92\";\n    my $outfile = \"dvb-ttusb-dec-2540t.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_X.bin\", $hash);\n    copy(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_X.bin\", $outfile);\n\n    $outfile;\n}\n\nsub dec3000s {\n    my $sourcefile = \"dec217g.exe\";\n    my $url = \"http://hauppauge.lightpath.net/de/$sourcefile\";\n    my $hash = \"b013ececea83f4d6d8d2a29ac7c1b448\";\n    my $outfile = \"dvb-ttusb-dec-3000s.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_S.bin\", $hash);\n    copy(\"$tmpdir/software/OEM/STB/App/Boot/STB_PC_S.bin\", $outfile);\n\n    $outfile;\n}\nsub opera1{\n\tmy $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 0);\n\n\tcheckstandard();\n\tmy $fwfile1=\"dvb-usb-opera1-fpga-01.fw\";\n\tmy $fwfile2=\"dvb-usb-opera-01.fw\";\n\textract(\"2830SCap2.sys\", 0x62e8, 55024, \"$tmpdir/opera1-fpga.fw\");\n\textract(\"2830SLoad2.sys\",0x3178,0x3685-0x3178,\"$tmpdir/fw1part1\");\n\textract(\"2830SLoad2.sys\",0x0980,0x3150-0x0980,\"$tmpdir/fw1part2\");\n\tdelzero(\"$tmpdir/fw1part1\",\"$tmpdir/fw1part1-1\");\n\tdelzero(\"$tmpdir/fw1part2\",\"$tmpdir/fw1part2-1\");\n\tverify(\"$tmpdir/fw1part1-1\",\"5e0909858fdf0b5b09ad48b9fe622e70\");\n\tverify(\"$tmpdir/fw1part2-1\",\"d6e146f321427e931df2c6fcadac37a1\");\n\tverify(\"$tmpdir/opera1-fpga.fw\",\"0f8133f5e9051f5f3c1928f7e5a1b07d\");\n\n\tmy $RES1=\"\\x01\\x92\\x7f\\x00\\x01\\x00\";\n\tmy $RES0=\"\\x01\\x92\\x7f\\x00\\x00\\x00\";\n\tmy $DAT1=\"\\x01\\x00\\xe6\\x00\\x01\\x00\";\n\tmy $DAT0=\"\\x01\\x00\\xe6\\x00\\x00\\x00\";\n\topen FW,\">$tmpdir/opera.fw\";\n\tprint FW \"$RES1\";\n\tprint FW \"$DAT1\";\n\tprint FW \"$RES1\";\n\tprint FW \"$DAT1\";\n\tappendfile(FW,\"$tmpdir/fw1part1-1\");\n\tprint FW \"$RES0\";\n\tprint FW \"$DAT0\";\n\tprint FW \"$RES1\";\n\tprint FW \"$DAT1\";\n\tappendfile(FW,\"$tmpdir/fw1part2-1\");\n\tprint FW \"$RES1\";\n\tprint FW \"$DAT1\";\n\tprint FW \"$RES0\";\n\tprint FW \"$DAT0\";\n\tcopy (\"$tmpdir/opera1-fpga.fw\",$fwfile1);\n\tcopy (\"$tmpdir/opera.fw\",$fwfile2);\n\n\t$fwfile1.\",\".$fwfile2;\n}\n\nsub vp7041 {\n    my $sourcefile = \"2.422.zip\";\n    my $url = \"http://www.twinhan.com/files/driver/USB-Ter/$sourcefile\";\n    my $hash = \"e88c9372d1f66609a3e7b072c53fbcfe\";\n    my $outfile = \"dvb-vp7041-2.422.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/VisionDTV/Drivers/Win2K&XP/UDTTload.sys\", 12503, 3036, \"$tmpdir/fwtmp1\");\n    extract(\"$tmpdir/VisionDTV/Drivers/Win2K&XP/UDTTload.sys\", 2207, 10274, \"$tmpdir/fwtmp2\");\n\n    my $CMD = \"\\000\\001\\000\\222\\177\\000\";\n    my $PAD = \"\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\";\n    my ($FW);\n    open $FW, \">$tmpdir/fwtmp3\";\n    print $FW \"$CMD\\001$PAD\";\n    print $FW \"$CMD\\001$PAD\";\n    appendfile($FW, \"$tmpdir/fwtmp1\");\n    print $FW \"$CMD\\000$PAD\";\n    print $FW \"$CMD\\001$PAD\";\n    appendfile($FW, \"$tmpdir/fwtmp2\");\n    print $FW \"$CMD\\001$PAD\";\n    print $FW \"$CMD\\000$PAD\";\n    close($FW);\n\n    verify(\"$tmpdir/fwtmp3\", $hash);\n    copy(\"$tmpdir/fwtmp3\", $outfile);\n\n    $outfile;\n}\n\nsub vp7049 {\n    my $fwfile = \"dvb-usb-vp7049-0.95.fw\";\n    my $url = \"http://ao2.it/sites/default/files/blog/2012/11/06/linux-support-digicom-digitune-s-vp7049-udtt7049/$fwfile\";\n    my $hash = \"5609fd295168aea88b25ff43a6f79c36\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url);\n    verify($fwfile, $hash);\n\n    $fwfile;\n}\n\nsub dibusb {\n\tmy $url = \"https://linuxtv.org/downloads/firmware/dvb-usb-dibusb-5.0.0.11.fw\";\n\tmy $outfile = \"dvb-dibusb-5.0.0.11.fw\";\n\tmy $hash = \"fa490295a527360ca16dcdf3224ca243\";\n\n\tcheckstandard();\n\n\twgetfile($outfile, $url);\n\tverify($outfile,$hash);\n\n\t$outfile;\n}\n\nsub nxt2002 {\n    my $sourcefile = \"Technisat_DVB-PC_4_4_COMPACT.zip\";\n    my $url = \"http://www.bbti.us/download/windows/$sourcefile\";\n    my $hash = \"476befae8c7c1bb9648954060b1eec1f\";\n    my $outfile = \"dvb-fe-nxt2002.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/SkyNET.sys\", $hash);\n    extract(\"$tmpdir/SkyNET.sys\", 331624, 5908, $outfile);\n\n    $outfile;\n}\n\nsub nxt2004 {\n    my $sourcefile = \"AVerTVHD_MCE_A180_Drv_v1.2.2.16.zip\";\n    my $url = \"http://www.avermedia-usa.com/support/Drivers/$sourcefile\";\n    my $hash = \"111cb885b1e009188346d72acfed024c\";\n    my $outfile = \"dvb-fe-nxt2004.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url);\n    unzip($sourcefile, $tmpdir);\n    verify(\"$tmpdir/3xHybrid.sys\", $hash);\n    extract(\"$tmpdir/3xHybrid.sys\", 465304, 9584, $outfile);\n\n    $outfile;\n}\n\nsub or51211 {\n    my $fwfile = \"dvb-fe-or51211.fw\";\n    my $url = \"https://linuxtv.org/downloads/firmware/$fwfile\";\n    my $hash = \"d830949c771a289505bf9eafc225d491\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url);\n    verify($fwfile, $hash);\n\n    $fwfile;\n}\n\nsub cx231xx {\n    my $fwfile = \"v4l-cx231xx-avcore-01.fw\";\n    my $url = \"https://linuxtv.org/downloads/firmware/$fwfile\";\n    my $hash = \"7d3bb956dc9df0eafded2b56ba57cc42\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url);\n    verify($fwfile, $hash);\n\n    $fwfile;\n}\n\nsub cx18 {\n    my $url = \"https://linuxtv.org/downloads/firmware/\";\n\n    my %files = (\n\t'v4l-cx23418-apu.fw' => '588f081b562f5c653a3db1ad8f65939a',\n\t'v4l-cx23418-cpu.fw' => 'b6c7ed64bc44b1a6e0840adaeac39d79',\n\t'v4l-cx23418-dig.fw' => '95bc688d3e7599fd5800161e9971cc55',\n    );\n\n    checkstandard();\n\n    my $allfiles;\n    foreach my $fwfile (keys %files) {\n\twgetfile($fwfile, \"$url/$fwfile\");\n\tverify($fwfile, $files{$fwfile});\n\t$allfiles .= \" $fwfile\";\n    }\n\n    $allfiles =~ s/^\\s//;\n\n    $allfiles;\n}\n\nsub mpc718 {\n    my $archive = 'Yuan MPC718 TV Tuner Card 2.13.10.1016.zip';\n    my $url = \"ftp://ftp.work.acer-euro.com/desktop/aspire_idea510/vista/Drivers/$archive\";\n    my $fwfile = \"dvb-cx18-mpc718-mt352.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n    wgetfile($archive, $url);\n    unzip($archive, $tmpdir);\n\n    my $sourcefile = \"$tmpdir/Yuan MPC718 TV Tuner Card 2.13.10.1016/mpc718_32bit/yuanrap.sys\";\n    my $found = 0;\n\n    open IN, '<', $sourcefile or die \"Couldn't open $sourcefile to extract $fwfile data\\n\";\n    binmode IN;\n    open OUT, '>', $fwfile;\n    binmode OUT;\n    {\n\t# Block scope because we change the line terminator variable $/\n\tmy $prevlen = 0;\n\tmy $currlen;\n\n\t# Buried in the data segment are 3 runs of almost identical\n\t# register-value pairs that end in 0x5d 0x01 which is a \"TUNER GO\"\n\t# command for the MT352.\n\t# Pull out the middle run (because it's easy) of register-value\n\t# pairs to make the \"firmware\" file.\n\n\tlocal $/ = \"\\x5d\\x01\"; # MT352 \"TUNER GO\"\n\n\twhile (<IN>) {\n\t    $currlen = length($_);\n\t    if ($prevlen == $currlen && $currlen <= 64) {\n\t\tchop; chop; # Get rid of \"TUNER GO\"\n\t\ts/^\\0\\0//;  # get rid of leading 00 00 if it's there\n\t\tprintf OUT \"$_\";\n\t\t$found = 1;\n\t\tlast;\n\t    }\n\t    $prevlen = $currlen;\n\t}\n    }\n    close OUT;\n    close IN;\n    if (!$found) {\n\tunlink $fwfile;\n\tdie \"Couldn't find valid register-value sequence in $sourcefile for $fwfile\\n\";\n    }\n    $fwfile;\n}\n\nsub cx23885 {\n    my $url = \"https://linuxtv.org/downloads/firmware/\";\n\n    my %files = (\n\t'v4l-cx23885-avcore-01.fw' => 'a9f8f5d901a7fb42f552e1ee6384f3bb',\n\t'v4l-cx23885-enc.fw'       => 'a9f8f5d901a7fb42f552e1ee6384f3bb',\n    );\n\n    checkstandard();\n\n    my $allfiles;\n    foreach my $fwfile (keys %files) {\n\twgetfile($fwfile, \"$url/$fwfile\");\n\tverify($fwfile, $files{$fwfile});\n\t$allfiles .= \" $fwfile\";\n    }\n\n    $allfiles =~ s/^\\s//;\n\n    $allfiles;\n}\n\nsub pvrusb2 {\n    my $url = \"https://linuxtv.org/downloads/firmware/\";\n\n    my %files = (\n\t'v4l-cx25840.fw'           => 'dadb79e9904fc8af96e8111d9cb59320',\n    );\n\n    checkstandard();\n\n    my $allfiles;\n    foreach my $fwfile (keys %files) {\n\twgetfile($fwfile, \"$url/$fwfile\");\n\tverify($fwfile, $files{$fwfile});\n\t$allfiles .= \" $fwfile\";\n    }\n\n    $allfiles =~ s/^\\s//;\n\n    $allfiles;\n}\n\nsub or51132_qam {\n    my $fwfile = \"dvb-fe-or51132-qam.fw\";\n    my $url = \"https://linuxtv.org/downloads/firmware/$fwfile\";\n    my $hash = \"7702e8938612de46ccadfe9b413cb3b5\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url);\n    verify($fwfile, $hash);\n\n    $fwfile;\n}\n\nsub or51132_vsb {\n    my $fwfile = \"dvb-fe-or51132-vsb.fw\";\n    my $url = \"https://linuxtv.org/downloads/firmware/$fwfile\";\n    my $hash = \"c16208e02f36fc439a557ad4c613364a\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url);\n    verify($fwfile, $hash);\n\n    $fwfile;\n}\n\nsub bluebird {\n\tmy $url = \"https://linuxtv.org/download/dvb/firmware/dvb-usb-bluebird-01.fw\";\n\tmy $outfile = \"dvb-usb-bluebird-01.fw\";\n\tmy $hash = \"658397cb9eba9101af9031302671f49d\";\n\n\tcheckstandard();\n\n\twgetfile($outfile, $url);\n\tverify($outfile,$hash);\n\n\t$outfile;\n}\n\nsub af9015 {\n\tmy $sourcefile = \"download.ashx?file=57\";\n\tmy $url = \"http://www.ite.com.tw/EN/Services/$sourcefile\";\n\tmy $hash = \"e3f08935158038d385ad382442f4bb2d\";\n\tmy $outfile = \"dvb-usb-af9015.fw\";\n\tmy $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\tmy $fwoffset = 0x25690;\n\tmy $fwlength = 18725;\n\tmy ($chunklength, $buf, $rcount);\n\n\tcheckstandard();\n\n\twgetfile($sourcefile, $url);\n\tunzip($sourcefile, $tmpdir);\n\tverify(\"$tmpdir/Driver/Files/AF15BDA.sys\", $hash);\n\n\topen INFILE, '<', \"$tmpdir/Driver/Files/AF15BDA.sys\";\n\topen OUTFILE, '>', $outfile;\n\n\tsysseek(INFILE, $fwoffset, SEEK_SET);\n\twhile($fwlength > 0) {\n\t\t$chunklength = 55;\n\t\t$chunklength = $fwlength if ($chunklength > $fwlength);\n\t\t$rcount = sysread(INFILE, $buf, $chunklength);\n\t\tdie \"Ran out of data\\n\" if ($rcount != $chunklength);\n\t\tsyswrite(OUTFILE, $buf);\n\t\tsysread(INFILE, $buf, 8);\n\t\t$fwlength -= $rcount + 8;\n\t}\n\n\tclose OUTFILE;\n\tclose INFILE;\n}\n\nsub ngene {\n    my $url = \"http://www.digitaldevices.de/download/\";\n    my $file1 = \"ngene_15.fw\";\n    my $hash1 = \"d798d5a757121174f0dbc5f2833c0c85\";\n    my $file2 = \"ngene_17.fw\";\n    my $hash2 = \"26b687136e127b8ac24b81e0eeafc20b\";\n    my $url2 = \"http://l4m-daten.de/downloads/firmware/dvb-s2/linux/all/\";\n    my $file3 = \"ngene_18.fw\";\n    my $hash3 = \"ebce3ea769a53e3e0b0197c3b3f127e3\";\n\n    checkstandard();\n\n    wgetfile($file1, $url . $file1);\n    verify($file1, $hash1);\n\n    wgetfile($file2, $url . $file2);\n    verify($file2, $hash2);\n\n    wgetfile($file3, $url2 . $file3);\n    verify($file3, $hash3);\n\n    \"$file1, $file2, $file3\";\n}\n\nsub az6027{\n    my $firmware = \"dvb-usb-az6027-03.fw\";\n    my $url = \"http://linux.terratec.de/files/TERRATEC_S7/$firmware\";\n\n    wgetfile($firmware, $url);\n\n    $firmware;\n}\n\nsub lme2510_lg {\n    my $sourcefile = \"LMEBDA_DVBS.sys\";\n    my $hash = \"fc6017ad01e79890a97ec53bea157ed2\";\n    my $outfile = \"dvb-usb-lme2510-lg.fw\";\n    my $hasho = \"caa065d5fdbd2c09ad57b399bbf55cad\";\n\n    checkstandard();\n\n    verify($sourcefile, $hash);\n    extract($sourcefile, 4168, 3841, $outfile);\n    verify($outfile, $hasho);\n    $outfile;\n}\n\nsub lme2510c_s7395 {\n    my $sourcefile = \"US2A0D.sys\";\n    my $hash = \"b0155a8083fb822a3bd47bc360e74601\";\n    my $outfile = \"dvb-usb-lme2510c-s7395.fw\";\n    my $hasho = \"3a3cf1aeebd17b6ddc04cebe131e94cf\";\n\n    checkstandard();\n\n    verify($sourcefile, $hash);\n    extract($sourcefile, 37248, 3720, $outfile);\n    verify($outfile, $hasho);\n    $outfile;\n}\n\nsub lme2510c_s7395_old {\n    my $sourcefile = \"LMEBDA_DVBS7395C.sys\";\n    my $hash = \"7572ae0eb9cdf91baabd7c0ba9e09b31\";\n    my $outfile = \"dvb-usb-lme2510c-s7395.fw\";\n    my $hasho = \"90430c5b435eb5c6f88fd44a9d950674\";\n\n    checkstandard();\n\n    verify($sourcefile, $hash);\n    extract($sourcefile, 4208, 3881, $outfile);\n    verify($outfile, $hasho);\n    $outfile;\n}\n\nsub drxk {\n    my $url = \"http://l4m-daten.de/files/\";\n    my $zipfile = \"DDTuner.zip\";\n    my $hash = \"f5a37b9a20a3534997997c0b1382a3e5\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n    my $drvfile = \"DDTuner.sys\";\n    my $fwfile = \"drxk_a3.mc\";\n\n    checkstandard();\n\n    wgetfile($zipfile, $url . $zipfile);\n    verify($zipfile, $hash);\n    unzip($zipfile, $tmpdir);\n    extract(\"$tmpdir/$drvfile\", 0x14dd8, 15634, \"$fwfile\");\n\n    \"$fwfile\"\n}\n\nsub drxk_hauppauge_hvr930c {\n    my $url = \"http://www.wintvcd.co.uk/drivers/\";\n    my $zipfile = \"HVR-9x0_5_10_325_28153_SIGNED.zip\";\n    my $hash = \"83ab82e7e9480ec8bf1ae0155ca63c88\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n    my $drvfile = \"HVR-900/emOEM.sys\";\n    my $fwfile = \"dvb-usb-hauppauge-hvr930c-drxk.fw\";\n\n    checkstandard();\n\n    wgetfile($zipfile, $url . $zipfile);\n    verify($zipfile, $hash);\n    unzip($zipfile, $tmpdir);\n    extract(\"$tmpdir/$drvfile\", 0x117b0, 42692, \"$fwfile\");\n\n    \"$fwfile\"\n}\n\nsub drxk_terratec_h5 {\n    my $url = \"https://linuxtv.org/downloads/firmware/\";\n    my $hash = \"19000dada8e2741162ccc50cc91fa7f1\";\n    my $fwfile = \"dvb-usb-terratec-h5-drxk.fw\";\n\n    checkstandard();\n\n    wgetfile($fwfile, $url . $fwfile);\n    verify($fwfile, $hash);\n\n    \"$fwfile\"\n}\n\nsub drxk_terratec_htc_stick {\n    my $url = \"http://ftp.terratec.de/Receiver/Cinergy_HTC_Stick/Updates/History/\";\n    my $zipfile = \"Cinergy_HTC_Stick_Drv_5.09.1202.00_XP_Vista_7.exe\";\n    my $hash = \"6722a2442a05423b781721fbc069ed5e\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 0);\n    my $drvfile = \"Cinergy HTC Stick/BDA Driver 5.09.1202.00/Windows 32 Bit/emOEM.sys\";\n    my $fwfile = \"dvb-usb-terratec-htc-stick-drxk.fw\";\n\n    checkstandard();\n\n    wgetfile($zipfile, $url . $zipfile);\n    verify($zipfile, $hash);\n    unzip($zipfile, $tmpdir);\n    extract(\"$tmpdir/$drvfile\", 0x4e5c0, 42692, \"$fwfile\");\n\n    \"$fwfile\"\n}\n\nsub it9135 {\n\tmy $url = \"http://www.ite.com.tw/uploads/firmware/v3.25.0.0/\";\n\tmy $file1 = \"dvb-usb-it9135-01.zip\";\n\tmy $fwfile1 = \"dvb-usb-it9135-01.fw\";\n\tmy $hash1 = \"02fcf11174eda84745dae7e61c5ff9ba\";\n\tmy $file2 = \"dvb-usb-it9135-02.zip\";\n\tmy $fwfile2 = \"dvb-usb-it9135-02.fw\";\n\tmy $hash2 = \"d5e1437dc24358578e07999475d4cac9\";\n\n\tcheckstandard();\n\n\twgetfile($file1, $url . $file1);\n\tunzip($file1, \"\");\n\tverify(\"$fwfile1\", $hash1);\n\n\twgetfile($file2, $url . $file2);\n\tunzip($file2, \"\");\n\tverify(\"$fwfile2\", $hash2);\n\n\t\"$file1 $file2\"\n}\n\nsub tda10071 {\n    my $sourcefile = \"PCTV_460e_reference.zip\";\n    my $url = \"ftp://ftp.pctvsystems.com/TV/driver/PCTV%2070e%2080e%20100e%20320e%20330e%20800e/\";\n    my $hash = \"4403de903bf2593464c8d74bbc200a57\";\n    my $fwfile = \"dvb-fe-tda10071.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url . $sourcefile);\n    verify($sourcefile, $hash);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/PCTV\\ 70e\\ 80e\\ 100e\\ 320e\\ 330e\\ 800e/32\\ bit/emOEM.sys\", 0x67d38, 40504, $fwfile);\n\n    \"$fwfile\";\n}\n\nsub drxk_pctv {\n    my $sourcefile = \"PCTV_460e_reference.zip\";\n    my $url = \"ftp://ftp.pctvsystems.com/TV/driver/PCTV%2070e%2080e%20100e%20320e%20330e%20800e/\";\n    my $hash = \"4403de903bf2593464c8d74bbc200a57\";\n    my $fwfile = \"dvb-demod-drxk-pctv.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url . $sourcefile);\n    verify($sourcefile, $hash);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/PCTV\\ 70e\\ 80e\\ 100e\\ 320e\\ 330e\\ 800e/32\\ bit/emOEM.sys\", 0x72b80, 42692, $fwfile);\n\n    \"$fwfile\";\n}\n\nsub sms1xxx_hcw {\n    my $url = \"http://steventoth.net/linux/sms1xxx/\";\n    my %files = (\n\t'sms1xxx-hcw-55xxx-dvbt-01.fw'  => \"afb6f9fb9a71d64392e8564ef9577e5a\",\n\t'sms1xxx-hcw-55xxx-dvbt-02.fw'  => \"b44807098ba26e52cbedeadc052ba58f\",\n\t'sms1xxx-hcw-55xxx-isdbt-02.fw' => \"dae934eeea85225acbd63ce6cfe1c9e4\",\n    );\n\n    checkstandard();\n\n    my $allfiles;\n    foreach my $fwfile (keys %files) {\n\twgetfile($fwfile, \"$url/$fwfile\");\n\tverify($fwfile, $files{$fwfile});\n\t$allfiles .= \" $fwfile\";\n    }\n\n    $allfiles =~ s/^\\s//;\n\n    $allfiles;\n}\n\nsub si2165 {\n    my $sourcefile = \"model_111xxx_122xxx_driver_6_0_119_31191_WHQL.zip\";\n    my $url = \"http://www.hauppauge.de/files/drivers/\";\n    my $hash = \"76633e7c76b0edee47c3ba18ded99336\";\n    my $fwfile = \"dvb-demod-si2165.fw\";\n    my $tmpdir = tempdir(DIR => \"/tmp\", CLEANUP => 1);\n\n    checkstandard();\n\n    wgetfile($sourcefile, $url . $sourcefile);\n    verify($sourcefile, $hash);\n    unzip($sourcefile, $tmpdir);\n    extract(\"$tmpdir/Driver10/Hcw10bda.sys\", 0x80788, 0x81E08-0x80788, \"$tmpdir/fw1\");\n\n    delzero(\"$tmpdir/fw1\",\"$tmpdir/fw1-1\");\n    #verify(\"$tmpdir/fw1\",\"5e0909858fdf0b5b09ad48b9fe622e70\");\n\n    my $CRC=\"\\x0A\\xCC\";\n    my $BLOCKS_MAIN=\"\\x27\";\n    open FW,\">$fwfile\";\n    print FW \"\\x01\\x00\"; # just a version id for the driver itself\n    print FW \"\\x9A\"; # fw version\n    print FW \"\\x00\"; # padding\n    print FW \"$BLOCKS_MAIN\"; # number of blocks of main part\n    print FW \"\\x00\"; # padding\n    print FW \"$CRC\"; # 16bit crc value of main part\n    appendfile(FW,\"$tmpdir/fw1\");\n\n    \"$fwfile\";\n}\n\n# ---------------------------------------------------------------\n# Utilities\n\nsub checkstandard {\n    if (system(\"which unzip > /dev/null 2>&1\")) {\n\tdie \"This firmware requires the unzip command - see ftp://ftp.info-zip.org/pub/infozip/UnZip.html\\n\";\n    }\n    if (system(\"which md5sum > /dev/null 2>&1\")) {\n\tdie \"This firmware requires the md5sum command - see http://www.gnu.org/software/coreutils/\\n\";\n    }\n    if (system(\"which wget > /dev/null 2>&1\")) {\n\tdie \"This firmware requires the wget command - see http://wget.sunsite.dk/\\n\";\n    }\n}\n\nsub checkunshield {\n    if (system(\"which unshield > /dev/null 2>&1\")) {\n\tdie \"This firmware requires the unshield command - see http://sourceforge.net/projects/synce/\\n\";\n    }\n}\n\nsub wgetfile {\n    my ($sourcefile, $url) = @_;\n\n    if (! -f $sourcefile) {\n\tsystem(\"wget -O \\\"$sourcefile\\\" \\\"$url\\\"\") and die \"wget failed - unable to download firmware\";\n    }\n}\n\nsub unzip {\n    my ($sourcefile, $todir) = @_;\n\n    $status = system(\"unzip -q -o -d \\\"$todir\\\" \\\"$sourcefile\\\" 2>/dev/null\" );\n    if ((($status >> 8) > 2) || (($status & 0xff) != 0)) {\n\tdie (\"unzip failed - unable to extract firmware\");\n    }\n}\n\nsub unshield {\n    my ($sourcefile, $todir) = @_;\n\n    system(\"unshield x -d \\\"$todir\\\" \\\"$sourcefile\\\" > /dev/null\" ) and die (\"unshield failed - unable to extract firmware\");\n}\n\nsub verify {\n    my ($filename, $hash) = @_;\n    my ($testhash);\n\n    open(CMD, \"md5sum \\\"$filename\\\"|\");\n    $testhash = <CMD>;\n    $testhash =~ /([a-zA-Z0-9]*)/;\n    $testhash = $1;\n    close CMD;\n    die \"Hash of extracted file does not match!\\n\" if ($testhash ne $hash);\n}\n\nsub copy {\n    my ($from, $to) = @_;\n\n    system(\"cp -f \\\"$from\\\" \\\"$to\\\"\") and die (\"cp failed\");\n}\n\nsub extract {\n    my ($infile, $offset, $length, $outfile) = @_;\n    my ($chunklength, $buf, $rcount);\n\n    open INFILE, \"<$infile\";\n    open OUTFILE, \">$outfile\";\n    sysseek(INFILE, $offset, SEEK_SET);\n    while($length > 0) {\n\t# Calc chunk size\n\t$chunklength = 2048;\n\t$chunklength = $length if ($chunklength > $length);\n\n\t$rcount = sysread(INFILE, $buf, $chunklength);\n\tdie \"Ran out of data\\n\" if ($rcount != $chunklength);\n\tsyswrite(OUTFILE, $buf);\n\t$length -= $rcount;\n    }\n    close INFILE;\n    close OUTFILE;\n}\n\nsub appendfile {\n    my ($FH, $infile) = @_;\n    my ($buf);\n\n    open INFILE, \"<$infile\";\n    while(1) {\n\t$rcount = sysread(INFILE, $buf, 2048);\n\tlast if ($rcount == 0);\n\tprint $FH $buf;\n    }\n    close(INFILE);\n}\n\nsub delzero{\n\tmy ($infile,$outfile) =@_;\n\n\topen INFILE,\"<$infile\";\n\topen OUTFILE,\">$outfile\";\n\twhile (1){\n\t\t$rcount=sysread(INFILE,$buf,22);\n\t\t$len=ord(substr($buf,0,1));\n\t\tprint OUTFILE substr($buf,0,1);\n\t\tprint OUTFILE substr($buf,2,$len+3);\n\tlast if ($rcount<1);\n\tprintf OUTFILE \"%c\",0;\n#print $len.\" \".length($buf).\"\\n\";\n\n\t}\n\tclose(INFILE);\n\tclose(OUTFILE);\n}\n\nsub syntax() {\n    print STDERR \"syntax: get_dvb_firmware <component>\\n\";\n    print STDERR \"Supported components:\\n\";\n    @components = sort @components;\n    for($i=0; $i < scalar(@components); $i++) {\n\tprint STDERR \"\\t\" . $components[$i] . \"\\n\";\n    }\n    exit(1);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}