{
  "module_name": "gfp-translate",
  "hash_id": "22794150d0dd925edf2d830aa2536622beb161805f331668b3a02a90dfef4418",
  "original_prompt": "Ingested from linux-6.6.14/scripts/gfp-translate",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0-only\n# Translate the bits making up a GFP mask\n# (c) 2009, Mel Gorman <mel@csn.ul.ie>\nSOURCE=\nGFPMASK=none\n\n# Helper function to report failures and exit\ndie() {\n\techo ERROR: $@\n\tif [ \"$TMPFILE\" != \"\" ]; then\n\t\trm -f $TMPFILE\n\tfi\n\texit -1\n}\n\nusage() {\n\techo \"usage: gfp-translate [-h] [ --source DIRECTORY ] gfpmask\"\n\texit 0\n}\n\n# Parse command-line arguments\nwhile [ $# -gt 0 ]; do\n\tcase $1 in\n\t\t--source)\n\t\t\tSOURCE=$2\n\t\t\tshift 2\n\t\t\t;;\n\t\t-h)\n\t\t\tusage\n\t\t\t;;\n\t\t--help)\n\t\t\tusage\n\t\t\t;;\n\t\t*)\n\t\t\tGFPMASK=$1\n\t\t\tshift\n\t\t\t;;\n\tesac\ndone\n\n# Guess the kernel source directory if it's not set. Preference is in order of\n# o current directory\n# o /usr/src/linux\nif [ \"$SOURCE\" = \"\" ]; then\n\tif [ -r \"/usr/src/linux/Makefile\" ]; then\n\t\tSOURCE=/usr/src/linux\n\tfi\n\tif [ -r \"`pwd`/Makefile\" ]; then\n\t\tSOURCE=`pwd`\n\tfi\nfi\n\n# Confirm that a source directory exists\nif [ ! -r \"$SOURCE/Makefile\" ]; then\n\tdie \"Could not locate kernel source directory or it is invalid\"\nfi\n\n# Confirm that a GFP mask has been specified\nif [ \"$GFPMASK\" = \"none\" ]; then\n\tusage\nfi\n\n# Extract GFP flags from the kernel source\nTMPFILE=`mktemp -t gfptranslate-XXXXXX` || exit 1\ngrep -q ___GFP $SOURCE/include/linux/gfp_types.h\nif [ $? -eq 0 ]; then\n\tgrep \"^#define ___GFP\" $SOURCE/include/linux/gfp_types.h | sed -e 's/u$//' | grep -v GFP_BITS > $TMPFILE\nelse\n\tgrep \"^#define __GFP\" $SOURCE/include/linux/gfp_types.h | sed -e 's/(__force gfp_t)//' | sed -e 's/u)/)/' | grep -v GFP_BITS | sed -e 's/)\\//) \\//' > $TMPFILE\nfi\n\n# Parse the flags\nIFS=\"\n\"\necho Source: $SOURCE\necho Parsing: $GFPMASK\nfor LINE in `cat $TMPFILE`; do\n\tMASK=`echo $LINE | awk '{print $3}'`\n\tif [ $(($GFPMASK&$MASK)) -ne 0 ]; then\n\t\techo $LINE\n\tfi\ndone\n\nrm -f $TMPFILE\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}