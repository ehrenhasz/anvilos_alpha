{
  "module_name": "as-version.sh",
  "hash_id": "431def986dc25a7228c54f0be86bb6e787bf0b0b85f361baa8fcba38320b779d",
  "original_prompt": "Ingested from linux-6.6.14/scripts/as-version.sh",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0-only\n#\n# Print the assembler name and its version in a 5 or 6-digit form.\n# Also, perform the minimum version check.\n# (If it is the integrated assembler, return 0 as the version, and\n# skip the version check.)\n\nset -e\n\n# Convert the version string x.y.z to a canonical 5 or 6-digit form.\nget_canonical_version()\n{\n\tIFS=.\n\tset -- $1\n\n\t# If the 2nd or 3rd field is missing, fill it with a zero.\n\t#\n\t# The 4th field, if present, is ignored.\n\t# This occurs in development snapshots as in 2.35.1.20201116\n\techo $((10000 * $1 + 100 * ${2:-0} + ${3:-0}))\n}\n\n# Clang fails to handle -Wa,--version unless -fno-integrated-as is given.\n# We check -fintegrated-as, expecting it is explicitly passed in for the\n# integrated assembler case.\ncheck_integrated_as()\n{\n\twhile [ $# -gt 0 ]; do\n\t\tif [ \"$1\" = -fintegrated-as ]; then\n\t\t\t# For the integrated assembler, we do not check the\n\t\t\t# version here. It is the same as the clang version, and\n\t\t\t# it has been already checked by scripts/cc-version.sh.\n\t\t\techo LLVM 0\n\t\t\texit 0\n\t\tfi\n\t\tshift\n\tdone\n}\n\ncheck_integrated_as \"$@\"\n\norig_args=\"$@\"\n\n# Get the first line of the --version output.\nIFS='\n'\nset -- $(LC_ALL=C \"$@\" -Wa,--version -c -x assembler-with-cpp /dev/null -o /dev/null 2>/dev/null)\n\n# Split the line on spaces.\nIFS=' '\nset -- $1\n\nmin_tool_version=$(dirname $0)/min-tool-version.sh\n\nif [ \"$1\" = GNU -a \"$2\" = assembler ]; then\n\tshift $(($# - 1))\n\tversion=$1\n\tmin_version=$($min_tool_version binutils)\n\tname=GNU\nelse\n\techo \"$orig_args: unknown assembler invoked\" >&2\n\texit 1\nfi\n\n# Some distributions append a package release number, as in 2.34-4.fc32\n# Trim the hyphen and any characters that follow.\nversion=${version%-*}\n\ncversion=$(get_canonical_version $version)\nmin_cversion=$(get_canonical_version $min_version)\n\nif [ \"$cversion\" -lt \"$min_cversion\" ]; then\n\techo >&2 \"***\"\n\techo >&2 \"*** Assembler is too old.\"\n\techo >&2 \"***   Your $name assembler version:    $version\"\n\techo >&2 \"***   Minimum $name assembler version: $min_version\"\n\techo >&2 \"***\"\n\texit 1\nfi\n\necho $name $cversion\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}