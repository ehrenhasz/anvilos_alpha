{
  "module_name": "checksyscalls.sh",
  "hash_id": "816ebfd030b2cb49d0064ae59673916b9f3c8e0bac6508fd009e0b68b0663f11",
  "original_prompt": "Ingested from linux-6.6.14/scripts/checksyscalls.sh",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0\n#\n# Check if current architecture are missing any function calls compared\n# to i386.\n# i386 define a number of legacy system calls that are i386 specific\n# and listed below so they are ignored.\n#\n# Usage:\n# checksyscalls.sh gcc gcc-options\n#\n\nignore_list() {\ncat << EOF\n#include <asm/types.h>\n#include <asm/unistd.h>\n\n/* *at */\n#define __IGNORE_open\t\t/* openat */\n#define __IGNORE_link\t\t/* linkat */\n#define __IGNORE_unlink\t\t/* unlinkat */\n#define __IGNORE_mknod\t\t/* mknodat */\n#define __IGNORE_chmod\t\t/* fchmodat */\n#define __IGNORE_chown\t\t/* fchownat */\n#define __IGNORE_mkdir\t\t/* mkdirat */\n#define __IGNORE_rmdir\t\t/* unlinkat */\n#define __IGNORE_lchown\t\t/* fchownat */\n#define __IGNORE_access\t\t/* faccessat */\n#define __IGNORE_rename\t\t/* renameat2 */\n#define __IGNORE_readlink\t/* readlinkat */\n#define __IGNORE_symlink\t/* symlinkat */\n#define __IGNORE_utimes\t\t/* futimesat */\n#define __IGNORE_stat\t\t/* fstatat */\n#define __IGNORE_lstat\t\t/* fstatat */\n#define __IGNORE_stat64\t\t/* fstatat64 */\n#define __IGNORE_lstat64\t/* fstatat64 */\n\n#ifndef __ARCH_WANT_SET_GET_RLIMIT\n#define __IGNORE_getrlimit\t/* getrlimit */\n#define __IGNORE_setrlimit\t/* setrlimit */\n#endif\n\n#ifndef __ARCH_WANT_MEMFD_SECRET\n#define __IGNORE_memfd_secret\n#endif\n\n/* Missing flags argument */\n#define __IGNORE_renameat\t/* renameat2 */\n\n/* CLOEXEC flag */\n#define __IGNORE_pipe\t\t/* pipe2 */\n#define __IGNORE_dup2\t\t/* dup3 */\n#define __IGNORE_epoll_create\t/* epoll_create1 */\n#define __IGNORE_inotify_init\t/* inotify_init1 */\n#define __IGNORE_eventfd\t/* eventfd2 */\n#define __IGNORE_signalfd\t/* signalfd4 */\n\n/* MMU */\n#ifndef CONFIG_MMU\n#define __IGNORE_madvise\n#define __IGNORE_mbind\n#define __IGNORE_mincore\n#define __IGNORE_mlock\n#define __IGNORE_mlockall\n#define __IGNORE_munlock\n#define __IGNORE_munlockall\n#define __IGNORE_mprotect\n#define __IGNORE_msync\n#define __IGNORE_migrate_pages\n#define __IGNORE_move_pages\n#define __IGNORE_remap_file_pages\n#define __IGNORE_get_mempolicy\n#define __IGNORE_set_mempolicy\n#define __IGNORE_swapoff\n#define __IGNORE_swapon\n#endif\n\n/* System calls for 32-bit kernels only */\n#if BITS_PER_LONG == 64\n#define __IGNORE_sendfile64\n#define __IGNORE_ftruncate64\n#define __IGNORE_truncate64\n#define __IGNORE_stat64\n#define __IGNORE_lstat64\n#define __IGNORE_fcntl64\n#define __IGNORE_fadvise64_64\n#define __IGNORE_fstatfs64\n#define __IGNORE_statfs64\n#define __IGNORE_llseek\n#define __IGNORE_mmap2\n#define __IGNORE_clock_gettime64\n#define __IGNORE_clock_settime64\n#define __IGNORE_clock_adjtime64\n#define __IGNORE_clock_getres_time64\n#define __IGNORE_clock_nanosleep_time64\n#define __IGNORE_timer_gettime64\n#define __IGNORE_timer_settime64\n#define __IGNORE_timerfd_gettime64\n#define __IGNORE_timerfd_settime64\n#define __IGNORE_utimensat_time64\n#define __IGNORE_pselect6_time64\n#define __IGNORE_ppoll_time64\n#define __IGNORE_io_pgetevents_time64\n#define __IGNORE_recvmmsg_time64\n#define __IGNORE_mq_timedsend_time64\n#define __IGNORE_mq_timedreceive_time64\n#define __IGNORE_semtimedop_time64\n#define __IGNORE_rt_sigtimedwait_time64\n#define __IGNORE_futex_time64\n#define __IGNORE_sched_rr_get_interval_time64\n#else\n#define __IGNORE_sendfile\n#define __IGNORE_ftruncate\n#define __IGNORE_truncate\n#define __IGNORE_stat\n#define __IGNORE_lstat\n#define __IGNORE_fcntl\n#define __IGNORE_fadvise64\n#define __IGNORE_newfstatat\n#define __IGNORE_fstatfs\n#define __IGNORE_statfs\n#define __IGNORE_lseek\n#define __IGNORE_mmap\n#define __IGNORE_clock_gettime\n#define __IGNORE_clock_settime\n#define __IGNORE_clock_adjtime\n#define __IGNORE_clock_getres\n#define __IGNORE_clock_nanosleep\n#define __IGNORE_timer_gettime\n#define __IGNORE_timer_settime\n#define __IGNORE_timerfd_gettime\n#define __IGNORE_timerfd_settime\n#define __IGNORE_utimensat\n#define __IGNORE_pselect6\n#define __IGNORE_ppoll\n#define __IGNORE_io_pgetevents\n#define __IGNORE_recvmmsg\n#define __IGNORE_mq_timedsend\n#define __IGNORE_mq_timedreceive\n#define __IGNORE_semtimedop\n#define __IGNORE_rt_sigtimedwait\n#define __IGNORE_futex\n#define __IGNORE_sched_rr_get_interval\n#define __IGNORE_gettimeofday\n#define __IGNORE_settimeofday\n#define __IGNORE_wait4\n#define __IGNORE_adjtimex\n#define __IGNORE_nanosleep\n#define __IGNORE_io_getevents\n#define __IGNORE_recvmmsg\n#endif\n\n/* i386-specific or historical system calls */\n#define __IGNORE_break\n#define __IGNORE_stty\n#define __IGNORE_gtty\n#define __IGNORE_ftime\n#define __IGNORE_prof\n#define __IGNORE_lock\n#define __IGNORE_mpx\n#define __IGNORE_ulimit\n#define __IGNORE_profil\n#define __IGNORE_ioperm\n#define __IGNORE_iopl\n#define __IGNORE_idle\n#define __IGNORE_modify_ldt\n#define __IGNORE_ugetrlimit\n#define __IGNORE_vm86\n#define __IGNORE_vm86old\n#define __IGNORE_set_thread_area\n#define __IGNORE_get_thread_area\n#define __IGNORE_madvise1\n#define __IGNORE_oldstat\n#define __IGNORE_oldfstat\n#define __IGNORE_oldlstat\n#define __IGNORE_oldolduname\n#define __IGNORE_olduname\n#define __IGNORE_umount\n#define __IGNORE_waitpid\n#define __IGNORE_stime\n#define __IGNORE_nice\n#define __IGNORE_signal\n#define __IGNORE_sigaction\n#define __IGNORE_sgetmask\n#define __IGNORE_sigsuspend\n#define __IGNORE_sigpending\n#define __IGNORE_ssetmask\n#define __IGNORE_readdir\n#define __IGNORE_socketcall\n#define __IGNORE_ipc\n#define __IGNORE_sigreturn\n#define __IGNORE_sigprocmask\n#define __IGNORE_bdflush\n#define __IGNORE__llseek\n#define __IGNORE__newselect\n#define __IGNORE_create_module\n#define __IGNORE_query_module\n#define __IGNORE_get_kernel_syms\n#define __IGNORE_sysfs\n#define __IGNORE_uselib\n#define __IGNORE__sysctl\n#define __IGNORE_arch_prctl\n#define __IGNORE_nfsservctl\n\n/* ... including the \"new\" 32-bit uid syscalls */\n#define __IGNORE_lchown32\n#define __IGNORE_getuid32\n#define __IGNORE_getgid32\n#define __IGNORE_geteuid32\n#define __IGNORE_getegid32\n#define __IGNORE_setreuid32\n#define __IGNORE_setregid32\n#define __IGNORE_getgroups32\n#define __IGNORE_setgroups32\n#define __IGNORE_fchown32\n#define __IGNORE_setresuid32\n#define __IGNORE_getresuid32\n#define __IGNORE_setresgid32\n#define __IGNORE_getresgid32\n#define __IGNORE_chown32\n#define __IGNORE_setuid32\n#define __IGNORE_setgid32\n#define __IGNORE_setfsuid32\n#define __IGNORE_setfsgid32\n\n/* these can be expressed using other calls */\n#define __IGNORE_alarm\t\t/* setitimer */\n#define __IGNORE_creat\t\t/* open */\n#define __IGNORE_fork\t\t/* clone */\n#define __IGNORE_futimesat\t/* utimensat */\n#define __IGNORE_getpgrp\t/* getpgid */\n#define __IGNORE_getdents\t/* getdents64 */\n#define __IGNORE_pause\t\t/* sigsuspend */\n#define __IGNORE_poll\t\t/* ppoll */\n#define __IGNORE_select\t\t/* pselect6 */\n#define __IGNORE_epoll_wait\t/* epoll_pwait */\n#define __IGNORE_time\t\t/* gettimeofday */\n#define __IGNORE_uname\t\t/* newuname */\n#define __IGNORE_ustat\t\t/* statfs */\n#define __IGNORE_utime\t\t/* utimes */\n#define __IGNORE_vfork\t\t/* clone */\n\n/* sync_file_range had a stupid ABI. Allow sync_file_range2 instead */\n#ifdef __NR_sync_file_range2\n#define __IGNORE_sync_file_range\n#endif\n\n/* Unmerged syscalls for AFS, STREAMS, etc. */\n#define __IGNORE_afs_syscall\n#define __IGNORE_getpmsg\n#define __IGNORE_putpmsg\n#define __IGNORE_vserver\n\n/* 64-bit ports never needed these, and new 32-bit ports can use statx */\n#define __IGNORE_fstat64\n#define __IGNORE_fstatat64\n\n/* Newer ports are not required to provide fstat in favor of statx */\n#define __IGNORE_fstat\nEOF\n}\n\nsyscall_list() {\n    grep '^[0-9]' \"$1\" | sort -n |\n\twhile read nr abi name entry ; do\n\t\techo \"#if !defined(__NR_${name}) && !defined(__IGNORE_${name})\"\n\t\techo \"#warning syscall ${name} not implemented\"\n\t\techo \"#endif\"\n\tdone\n}\n\n(ignore_list && syscall_list $(dirname $0)/../arch/x86/entry/syscalls/syscall_32.tbl) | \\\n$* -Wno-error -Wno-unused-macros -E -x c - > /dev/null\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}