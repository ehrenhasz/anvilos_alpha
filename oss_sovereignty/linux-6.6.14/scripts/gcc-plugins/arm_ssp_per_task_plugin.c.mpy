{
  "module_name": "arm_ssp_per_task_plugin.c",
  "hash_id": "d9aea6e1b32efef7a2df2a4f32d58c00843c1640548d048c5268eceaace55425",
  "original_prompt": "Ingested from linux-6.6.14/scripts/gcc-plugins/arm_ssp_per_task_plugin.c",
  "human_readable_source": "\n\n#include \"gcc-common.h\"\n\n__visible int plugin_is_GPL_compatible;\n\nstatic unsigned int canary_offset;\n\nstatic unsigned int arm_pertask_ssp_rtl_execute(void)\n{\n\trtx_insn *insn;\n\n\tfor (insn = get_insns(); insn; insn = NEXT_INSN(insn)) {\n\t\tconst char *sym;\n\t\trtx body;\n\t\trtx current;\n\n\t\t \n\t\tif (!INSN_P(insn))\n\t\t\tcontinue;\n\t\tbody = PATTERN(insn);\n\t\tif (GET_CODE(body) != SET ||\n\t\t    GET_CODE(SET_SRC(body)) != SYMBOL_REF)\n\t\t\tcontinue;\n\t\tsym = XSTR(SET_SRC(body), 0);\n\t\tif (strcmp(sym, \"__stack_chk_guard\"))\n\t\t\tcontinue;\n\n\t\t \n\t\tcurrent = gen_reg_rtx(Pmode);\n\n\t\temit_insn_before(gen_load_tp_hard(current), insn);\n\n\t\tSET_SRC(body) = gen_rtx_PLUS(Pmode, current,\n\t\t\t\t\t     GEN_INT(canary_offset));\n\t}\n\treturn 0;\n}\n\n#define PASS_NAME arm_pertask_ssp_rtl\n\n#define NO_GATE\n#include \"gcc-generate-rtl-pass.h\"\n\n#if BUILDING_GCC_VERSION >= 9000\nstatic bool no(void)\n{\n\treturn false;\n}\n\nstatic void arm_pertask_ssp_start_unit(void *gcc_data, void *user_data)\n{\n\ttargetm.have_stack_protect_combined_set = no;\n\ttargetm.have_stack_protect_combined_test = no;\n}\n#endif\n\n__visible int plugin_init(struct plugin_name_args *plugin_info,\n\t\t\t  struct plugin_gcc_version *version)\n{\n\tconst char * const plugin_name = plugin_info->base_name;\n\tconst int argc = plugin_info->argc;\n\tconst struct plugin_argument *argv = plugin_info->argv;\n\tint i;\n\n\tif (!plugin_default_version_check(version, &gcc_version)) {\n\t\terror(G_(\"incompatible gcc/plugin versions\"));\n\t\treturn 1;\n\t}\n\n\tfor (i = 0; i < argc; ++i) {\n\t\tif (!strcmp(argv[i].key, \"disable\"))\n\t\t\treturn 0;\n\n\t\t \n\t\tif (!argv[i].value) {\n\t\t\terror(G_(\"no value supplied for option '-fplugin-arg-%s-%s'\"),\n\t\t\t      plugin_name, argv[i].key);\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (!strcmp(argv[i].key, \"offset\")) {\n\t\t\tcanary_offset = atoi(argv[i].value);\n\t\t\tcontinue;\n\t\t}\n\t\terror(G_(\"unknown option '-fplugin-arg-%s-%s'\"),\n\t\t      plugin_name, argv[i].key);\n\t\treturn 1;\n\t}\n\n\tPASS_INFO(arm_pertask_ssp_rtl, \"expand\", 1, PASS_POS_INSERT_AFTER);\n\n\tregister_callback(plugin_info->base_name, PLUGIN_PASS_MANAGER_SETUP,\n\t\t\t  NULL, &arm_pertask_ssp_rtl_pass_info);\n\n#if BUILDING_GCC_VERSION >= 9000\n\tregister_callback(plugin_info->base_name, PLUGIN_START_UNIT,\n\t\t\t  arm_pertask_ssp_start_unit, NULL);\n#endif\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}