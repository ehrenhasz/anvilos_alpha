{
  "module_name": "clk_put.cocci",
  "hash_id": "be8f4c7030f2c3d7a76efad11e271731b157648c55e11f9f32634e0635c83623",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/free/clk_put.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Find missing clk_puts.\n///\n//# This only signals a missing clk_put when there is a clk_put later\n//# in the same function.\n//# False positives can be due to loops.\n//\n// Confidence: Moderate\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options:\n\nvirtual context\nvirtual org\nvirtual report\n\n@clk@\nexpression e;\nstatement S,S1;\nint ret;\nposition p1,p2,p3;\n@@\n\ne = clk_get@p1(...)\n... when != clk_put(e)\nif (<+...e...+>) S\n... when any\n    when != clk_put(e)\n    when != if (...) { ... clk_put(e); ... }\n(\n if (ret == 0) S1\n|\nif (...)\n   { ...\n     return 0; }\n|\nif (...)\n   { ...\n     return <+...e...+>; }\n|\n*if@p2 (...)\n   { ... when != clk_put(e)\n         when forall\n     return@p3 ...; }\n)\n... when any\nclk_put(e);\n\n@script:python depends on org@\np1 << clk.p1;\np2 << clk.p2;\np3 << clk.p3;\n@@\n\ncocci.print_main(\"clk_get\",p1)\ncocci.print_secs(\"if\",p2)\ncocci.print_secs(\"needed clk_put\",p3)\n\n@script:python depends on report@\np1 << clk.p1;\np2 << clk.p2;\np3 << clk.p3;\n@@\n\nmsg = \"ERROR: missing clk_put; clk_get on line %s and execution via conditional on line %s\" % (p1[0].line,p2[0].line)\ncoccilib.report.print_report(p3[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}