{
  "module_name": "kfree.cocci",
  "hash_id": "5475ac12e3f99bbcaa3718892d5928992df4edfadc1c65b5a03386c5938b0a14",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/free/kfree.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Find a use after free.\n//# Values of variables may imply that some\n//# execution paths are not possible, resulting in false positives.\n//# Another source of false positives are macros such as\n//# SCTP_DBG_OBJCNT_DEC that do not actually evaluate their argument\n///\n// Confidence: Moderate\n// Copyright: (C) 2010-2012 Nicolas Palix.\n// Copyright: (C) 2010-2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2010-2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual org\nvirtual report\n\n@free@\nexpression E;\nposition p1;\n@@\n\n(\n kfree@p1(E)\n|\n kfree_sensitive@p1(E)\n)\n\n@print expression@\nconstant char [] c;\nexpression free.E,E2;\ntype T;\nposition p;\nidentifier f;\n@@\n\n(\n f(...,c,...,(T)E@p,...)\n|\n E@p == E2\n|\n E@p != E2\n|\n E2 == E@p\n|\n E2 != E@p\n|\n !E@p\n|\n E@p || ...\n)\n\n@sz@\nexpression free.E;\nposition p;\n@@\n\n sizeof(<+...E@p...+>)\n\n@loop exists@\nexpression E;\nidentifier l;\nposition ok;\n@@\n\nwhile (1) { ...\n(\n kfree@ok(E)\n|\n kfree_sensitive@ok(E)\n)\n  ... when != break;\n      when != goto l;\n      when forall\n}\n\n@r exists@\nexpression free.E, subE<=free.E, E2;\nexpression E1;\niterator iter;\nstatement S;\nposition free.p1!=loop.ok,p2!={print.p,sz.p};\n@@\n\n(\n kfree@p1(E,...)\n|\n kfree_sensitive@p1(E,...)\n)\n...\n(\n iter(...,subE,...) S // no use\n|\n list_remove_head(E1,subE,...)\n|\n subE = E2\n|\n subE++\n|\n ++subE\n|\n --subE\n|\n subE--\n|\n &subE\n|\n BUG(...)\n|\n BUG_ON(...)\n|\n return_VALUE(...)\n|\n return_ACPI_STATUS(...)\n|\n E@p2 // bad use\n)\n\n@script:python depends on org@\np1 << free.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"kfree\",p1)\ncocci.print_secs(\"ref\",p2)\n\n@script:python depends on report@\np1 << free.p1;\np2 << r.p2;\n@@\n\nmsg = \"ERROR: reference preceded by free on line %s\" % (p1[0].line)\ncoccilib.report.print_report(p2[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}