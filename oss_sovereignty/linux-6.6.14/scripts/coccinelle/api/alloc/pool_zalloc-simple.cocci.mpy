{
  "module_name": "pool_zalloc-simple.cocci",
  "hash_id": "af7af753d6d99d33a21de8b535810cbdadc5323a7543e034b6295fed8ad0e35f",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/api/alloc/pool_zalloc-simple.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n///\n/// Use *_pool_zalloc rather than *_pool_alloc followed by memset with 0\n///\n// Copyright: (C) 2015 Intel Corp.\n// Options: --no-includes --include-headers\n//\n// Keywords: dma_pool_zalloc, pci_pool_zalloc\n//\n\nvirtual context\nvirtual patch\nvirtual org\nvirtual report\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@depends on context@\nexpression x;\nstatement S;\n@@\n\n* x = \\(dma_pool_alloc\\|pci_pool_alloc\\)(...);\n  if ((x==NULL) || ...) S\n* memset(x,0, ...);\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@depends on patch@\nexpression x;\nexpression a,b,c;\nstatement S;\n@@\n\n- x = dma_pool_alloc(a,b,c);\n+ x = dma_pool_zalloc(a,b,c);\n  if ((x==NULL) || ...) S\n- memset(x,0,...);\n\n@depends on patch@\nexpression x;\nexpression a,b,c;\nstatement S;\n@@\n\n- x = pci_pool_alloc(a,b,c);\n+ x = pci_pool_zalloc(a,b,c);\n  if ((x==NULL) || ...) S\n- memset(x,0,...);\n\n//----------------------------------------------------------\n//  For org and report mode\n//----------------------------------------------------------\n\n@r depends on org || report@\nexpression x;\nexpression a,b,c;\nstatement S;\nposition p;\n@@\n\n x = @p\\(dma_pool_alloc\\|pci_pool_alloc\\)(a,b,c);\n if ((x==NULL) || ...) S\n memset(x,0, ...);\n\n@script:python depends on org@\np << r.p;\nx << r.x;\n@@\n\nmsg=\"%s\" % (x)\nmsg_safe=msg.replace(\"[\",\"@(\").replace(\"]\",\")\")\ncoccilib.org.print_todo(p[0], msg_safe)\n\n@script:python depends on report@\np << r.p;\nx << r.x;\n@@\n\nmsg=\"WARNING: *_pool_zalloc should be used for %s, instead of *_pool_alloc/memset\" % (x)\ncoccilib.report.print_report(p[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}