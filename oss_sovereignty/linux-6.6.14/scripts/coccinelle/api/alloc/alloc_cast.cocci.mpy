{
  "module_name": "alloc_cast.cocci",
  "hash_id": "700f020be18b4e942e3f380d96c17b2dafa97a50b73ccb2a3c8a1de7660624b2",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/api/alloc/alloc_cast.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Remove casting the values returned by memory allocation functions\n/// like kmalloc, kzalloc, kmem_cache_alloc, kmem_cache_zalloc etc.\n///\n//# This makes an effort to find cases of casting of values returned by\n//# kmalloc, kzalloc, kcalloc, kmem_cache_alloc, kmem_cache_zalloc,\n//# kmem_cache_alloc_node, kmalloc_node and kzalloc_node and removes\n//# the casting as it is not required. The result in the patch case may\n//# need some reformatting.\n//\n// Confidence: High\n// Copyright: (C) 2014 Himangi Saraogi\n// Copyright: (C) 2017 Himanshu Jha\n// Comments:\n// Options: --no-includes --include-headers\n//\n\nvirtual context\nvirtual patch\nvirtual org\nvirtual report\n\n@initialize:python@\n@@\nimport re\npattern = '__'\nm = re.compile(pattern)\n\n@r1 depends on context || patch@\ntype T;\n@@\n\n  (T *)\n  \\(kmalloc\\|kzalloc\\|kcalloc\\|kmem_cache_alloc\\|kmem_cache_zalloc\\|\n   kmem_cache_alloc_node\\|kmalloc_node\\|kzalloc_node\\|vmalloc\\|vzalloc\\|\n   dma_alloc_coherent\\|devm_kmalloc\\|devm_kzalloc\\|\n   kvmalloc\\|kvzalloc\\|kvmalloc_node\\|kvzalloc_node\\|pci_alloc_consistent\\|\n   pci_zalloc_consistent\\|kmem_alloc\\|kmem_zalloc\\|kmem_zone_alloc\\|\n   kmem_zone_zalloc\\|vmalloc_node\\|vzalloc_node\\)(...)\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@script:python depends on context@\nt << r1.T;\n@@\n\nif m.search(t) != None:\n        cocci.include_match(False)\n\n@depends on context && r1@\ntype r1.T;\n@@\n\n* (T *)\n  \\(kmalloc\\|kzalloc\\|kcalloc\\|kmem_cache_alloc\\|kmem_cache_zalloc\\|\n   kmem_cache_alloc_node\\|kmalloc_node\\|kzalloc_node\\|vmalloc\\|vzalloc\\|\n   dma_alloc_coherent\\|devm_kmalloc\\|devm_kzalloc\\|\n   kvmalloc\\|kvzalloc\\|kvmalloc_node\\|kvzalloc_node\\|pci_alloc_consistent\\|\n   pci_zalloc_consistent\\|kmem_alloc\\|kmem_zalloc\\|kmem_zone_alloc\\|\n   kmem_zone_zalloc\\|vmalloc_node\\|vzalloc_node\\)(...)\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@script:python depends on patch@\nt << r1.T;\n@@\n\nif m.search(t) != None:\n        cocci.include_match(False)\n\n@depends on patch && r1@\ntype r1.T;\n@@\n\n- (T *)\n  \\(kmalloc\\|kzalloc\\|kcalloc\\|kmem_cache_alloc\\|kmem_cache_zalloc\\|\n   kmem_cache_alloc_node\\|kmalloc_node\\|kzalloc_node\\|vmalloc\\|vzalloc\\|\n   dma_alloc_coherent\\|devm_kmalloc\\|devm_kzalloc\\|\n   kvmalloc\\|kvzalloc\\|kvmalloc_node\\|kvzalloc_node\\|pci_alloc_consistent\\|\n   pci_zalloc_consistent\\|kmem_alloc\\|kmem_zalloc\\|kmem_zone_alloc\\|\n   kmem_zone_zalloc\\|vmalloc_node\\|vzalloc_node\\)(...)\n\n//----------------------------------------------------------\n//  For org and report mode\n//----------------------------------------------------------\n\n@r2 depends on org || report@\ntype T;\nposition p;\n@@\n\n (T@p *)\n  \\(kmalloc\\|kzalloc\\|kcalloc\\|kmem_cache_alloc\\|kmem_cache_zalloc\\|\n   kmem_cache_alloc_node\\|kmalloc_node\\|kzalloc_node\\|vmalloc\\|vzalloc\\|\n   dma_alloc_coherent\\|devm_kmalloc\\|devm_kzalloc\\|\n   kvmalloc\\|kvzalloc\\|kvmalloc_node\\|kvzalloc_node\\|pci_alloc_consistent\\|\n   pci_zalloc_consistent\\|kmem_alloc\\|kmem_zalloc\\|kmem_zone_alloc\\|\n   kmem_zone_zalloc\\|vmalloc_node\\|vzalloc_node\\)(...)\n\n@script:python depends on org@\np << r2.p;\nt << r2.T;\n@@\n\nif m.search(t) != None:\n\tcocci.include_match(False)\nelse:\n\tcoccilib.org.print_safe_todo(p[0], t)\n\n@script:python depends on report@\np << r2.p;\nt << r2.T;\n@@\n\nif m.search(t) != None:\n\tcocci.include_match(False)\nelse:\n\tmsg=\"WARNING: casting value returned by memory allocation function to (%s *) is useless.\" % (t)\n\tcoccilib.report.print_report(p[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}