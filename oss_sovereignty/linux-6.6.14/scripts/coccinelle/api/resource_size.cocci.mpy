{
  "module_name": "resource_size.cocci",
  "hash_id": "391961fed1237e1bf210a3a93f9144ff76c6cf306f1ef152dc803dceb25fdecf",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/api/resource_size.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n///\n/// Use resource_size function on resource object\n/// instead of explicit computation.\n///\n//  Confidence: High\n//  Copyright: (C) 2009, 2010 Nicolas Palix, DIKU.\n//  Copyright: (C) 2009, 2010 Julia Lawall, DIKU.\n//  Copyright: (C) 2009, 2010 Gilles Muller, INRIA/LiP6.\n//  URL: https://coccinelle.gitlabpages.inria.fr/website\n//  Options:\n//\n//  Keywords: resource_size\n//  Version min: 2.6.27 resource_size\n//\n\nvirtual context\nvirtual patch\nvirtual org\nvirtual report\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@r_context depends on context && !patch && !org@\nstruct resource *res;\n@@\n\n* (res->end - res->start) + 1\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@r_patch depends on !context && patch && !org@\nstruct resource *res;\n@@\n\n- (res->end - res->start) + 1\n+ resource_size(res)\n\n//----------------------------------------------------------\n//  For org mode\n//----------------------------------------------------------\n\n\n@r_org depends on !context && !patch && (org || report)@\nstruct resource *res;\nposition p;\n@@\n\n (res->end@p - res->start) + 1\n\n@rbad_org depends on !context && !patch && (org || report)@\nstruct resource *res;\nposition p != r_org.p;\n@@\n\n res->end@p - res->start\n\n@script:python depends on org@\np << r_org.p;\nx << r_org.res;\n@@\n\nmsg=\"ERROR with %s\" % (x)\nmsg_safe=msg.replace(\"[\",\"@(\").replace(\"]\",\")\")\ncoccilib.org.print_todo(p[0], msg_safe)\n\n@script:python depends on report@\np << r_org.p;\nx << r_org.res;\n@@\n\nmsg=\"ERROR: Missing resource_size with %s\" % (x)\ncoccilib.report.print_report(p[0], msg)\n\n@script:python depends on org@\np << rbad_org.p;\nx << rbad_org.res;\n@@\n\nmsg=\"WARNING with %s\" % (x)\nmsg_safe=msg.replace(\"[\",\"@(\").replace(\"]\",\")\")\ncoccilib.org.print_todo(p[0], msg_safe)\n\n@script:python depends on report@\np << rbad_org.p;\nx << rbad_org.res;\n@@\n\nmsg=\"WARNING: Suspicious code. resource_size is maybe missing with %s\" % (x)\ncoccilib.report.print_report(p[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}