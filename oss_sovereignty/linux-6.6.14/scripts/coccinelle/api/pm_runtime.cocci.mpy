{
  "module_name": "pm_runtime.cocci",
  "hash_id": "24e633b58c1008ae823bd8fb5df1ce1fe20351e4f086cd50d8be82bfd5bdc6a1",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/api/pm_runtime.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Make sure pm_runtime_* calls does not use unnecessary IS_ERR_VALUE\n///\n// Keywords: pm_runtime\n// Confidence: Medium\n// Copyright (C) 2013 Texas Instruments Incorporated -\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Options: --include-headers\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n//----------------------------------------------------------\n//  Detection\n//----------------------------------------------------------\n\n@runtime_bad_err_handle exists@\nexpression ret;\nposition p;\n@@\n(\nret@p = \\(pm_runtime_idle\\|\n\tpm_runtime_suspend\\|\n\tpm_runtime_autosuspend\\|\n\tpm_runtime_resume\\|\n\tpm_request_idle\\|\n\tpm_request_resume\\|\n\tpm_request_autosuspend\\|\n\tpm_runtime_get\\|\n\tpm_runtime_get_sync\\|\n\tpm_runtime_put\\|\n\tpm_runtime_put_autosuspend\\|\n\tpm_runtime_put_sync\\|\n\tpm_runtime_put_sync_suspend\\|\n\tpm_runtime_put_sync_autosuspend\\|\n\tpm_runtime_set_active\\|\n\tpm_schedule_suspend\\|\n\tpm_runtime_barrier\\|\n\tpm_generic_runtime_suspend\\|\n\tpm_generic_runtime_resume\\)(...);\n...\nIS_ERR_VALUE(ret)\n...\n)\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@depends on context@\nidentifier pm_runtime_api;\nexpression ret;\nposition runtime_bad_err_handle.p;\n@@\n(\nret@p = pm_runtime_api(...);\n...\n* IS_ERR_VALUE(ret)\n...\n)\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@depends on patch@\nidentifier pm_runtime_api;\nexpression ret;\nposition runtime_bad_err_handle.p;\n@@\n(\nret@p = pm_runtime_api(...);\n...\n- IS_ERR_VALUE(ret)\n+ ret < 0\n...\n)\n\n//----------------------------------------------------------\n//  For org and report mode\n//----------------------------------------------------------\n\n@r depends on (org || report) exists@\nposition p1, p2;\nidentifier pm_runtime_api;\nexpression ret;\nposition runtime_bad_err_handle.p;\n@@\n(\nret@p = pm_runtime_api@p1(...);\n...\nIS_ERR_VALUE@p2(ret)\n...\n)\n\n@script:python depends on org@\np1 << r.p1;\np2 << r.p2;\npm_runtime_api << r.pm_runtime_api;\n@@\n\ncocci.print_main(pm_runtime_api,p1)\ncocci.print_secs(\"IS_ERR_VALUE\",p2)\n\n@script:python depends on report@\np1 << r.p1;\np2 << r.p2;\npm_runtime_api << r.pm_runtime_api;\n@@\n\nmsg = \"%s returns < 0 as error. Unecessary IS_ERR_VALUE at line %s\" % (pm_runtime_api, p2[0].line)\ncoccilib.report.print_report(p1[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}