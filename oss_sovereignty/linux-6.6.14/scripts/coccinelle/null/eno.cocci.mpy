{
  "module_name": "eno.cocci",
  "hash_id": "f7fcc9e11649d40dd5574e4d645ad5981c704019e540fe47ce21aa4c74ce77eb",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/null/eno.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// The various basic memory allocation functions don't return ERR_PTR\n///\n// Confidence: High\n// Copyright: (C) 2010-2012 Nicolas Palix.\n// Copyright: (C) 2010-2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2010-2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@depends on patch@\nexpression x,E;\n@@\n\nx = \\(kmalloc\\|kzalloc\\|kcalloc\\|kmem_cache_alloc\\|kmem_cache_zalloc\\|kmem_cache_alloc_node\\|kmalloc_node\\|kzalloc_node\\)(...)\n... when != x = E\n- IS_ERR(x)\n+ !x\n\n@r depends on !patch exists@\nexpression x,E;\nposition p1,p2;\n@@\n\n*x = \\(kmalloc@p1\\|kzalloc@p1\\|kcalloc@p1\\|kmem_cache_alloc@p1\\|kmem_cache_zalloc@p1\\|kmem_cache_alloc_node@p1\\|kmalloc_node@p1\\|kzalloc_node@p1\\)(...)\n... when != x = E\n* IS_ERR@p2(x)\n\n@script:python depends on org@\np1 << r.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"alloc call\",p1)\ncocci.print_secs(\"IS_ERR that should be NULL tests\",p2)\n\n@script:python depends on report@\np1 << r.p1;\np2 << r.p2;\n@@\n\nmsg = \"ERROR: allocation function on line %s returns NULL not ERR_PTR on failure\" % (p1[0].line)\ncoccilib.report.print_report(p2[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}