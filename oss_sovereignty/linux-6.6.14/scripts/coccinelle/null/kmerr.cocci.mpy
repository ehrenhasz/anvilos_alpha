{
  "module_name": "kmerr.cocci",
  "hash_id": "194bb4bec9512787a26d8108f3d2ac8051daf08ab98ba3ae67519941ae75b825",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/null/kmerr.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// This semantic patch looks for kmalloc etc that are not followed by a\n/// NULL check.  It only gives a report in the case where there is some\n/// error handling code later in the function, which may be helpful\n/// in determining what the error handling code for the call to kmalloc etc\n/// should be.\n///\n// Confidence: High\n// Copyright: (C) 2010 Nicolas Palix, DIKU.\n// Copyright: (C) 2010 Julia Lawall, DIKU.\n// Copyright: (C) 2010 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual context\nvirtual org\nvirtual report\n\n@withtest@\nexpression x;\nposition p;\nidentifier f,fld;\n@@\n\nx@p = f(...);\n... when != x->fld\n\\(x == NULL \\| x != NULL\\)\n\n@fixed depends on context && !org && !report@\nexpression x,x1;\nposition p1 != withtest.p;\nstatement S;\nposition any withtest.p;\nidentifier f;\n@@\n\n*x@p1 = \\(kmalloc\\|kzalloc\\|kcalloc\\)(...);\n...\n*x1@p = f(...);\nif (!x1) S\n\n// ------------------------------------------------------------------------\n\n@rfixed depends on (org || report) && !context exists@\nexpression x,x1;\nposition p1 != withtest.p;\nposition p2;\nstatement S;\nposition any withtest.p;\nidentifier f;\n@@\n\nx@p1 = \\(kmalloc\\|kzalloc\\|kcalloc\\)(...);\n...\nx1@p = f@p2(...);\nif (!x1) S\n\n@script:python depends on org@\np1 << rfixed.p1;\np2 << rfixed.p2;\n@@\n\ncocci.print_main(\"alloc call\",p1)\ncocci.print_secs(\"possible model\",p2)\n\n@script:python depends on report@\np1 << rfixed.p1;\np2 << rfixed.p2;\n@@\n\nmsg = \"alloc with no test, possible model on line %s\" % (p2[0].line)\ncoccilib.report.print_report(p1[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}