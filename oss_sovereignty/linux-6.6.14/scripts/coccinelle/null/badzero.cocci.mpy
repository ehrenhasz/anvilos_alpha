{
  "module_name": "badzero.cocci",
  "hash_id": "f84e1735bb46075b2442ba92afb3251adc24d8cb4d81096e4fc72a02bd4f1ea0",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/null/badzero.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Compare pointer-typed values to NULL rather than 0\n///\n//# This makes an effort to choose between !x and x == NULL.  !x is used\n//# if it has previously been used with the function used to initialize x.\n//# This relies on type information.  More type information can be obtained\n//# using the option -all_includes and the option -I to specify an\n//# include path.\n//\n// Confidence: High\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Requires: 1.0.0\n// Options:\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@initialize:ocaml@\n@@\nlet negtable = Hashtbl.create 101\n\n@depends on patch@\nexpression *E;\nidentifier f;\n@@\n\n(\n  (E = f(...)) ==\n- 0\n+ NULL\n|\n  (E = f(...)) !=\n- 0\n+ NULL\n|\n- 0\n+ NULL\n  == (E = f(...))\n|\n- 0\n+ NULL\n  != (E = f(...))\n)\n\n\n@t1 depends on !patch@\nexpression *E;\nidentifier f;\nposition p;\n@@\n\n(\n  (E = f(...)) ==\n* 0@p\n|\n  (E = f(...)) !=\n* 0@p\n|\n* 0@p\n  == (E = f(...))\n|\n* 0@p\n  != (E = f(...))\n)\n\n@script:python depends on org@\np << t1.p;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING comparing pointer to 0\")\n\n@script:python depends on report@\np << t1.p;\n@@\n\ncoccilib.report.print_report(p[0], \"WARNING comparing pointer to 0\")\n\n// Tests of returned values\n\n@s@\nidentifier f;\nexpression E,E1;\n@@\n\n E = f(...)\n ... when != E = E1\n !E\n\n@script:ocaml depends on s@\nf << s.f;\n@@\n\ntry let _ = Hashtbl.find negtable f in ()\nwith Not_found -> Hashtbl.add negtable f ()\n\n@ r disable is_zero,isnt_zero exists @\nexpression *E;\nidentifier f;\n@@\n\nE = f(...)\n...\n(E == 0\n|E != 0\n|0 == E\n|0 != E\n)\n\n@script:ocaml@\nf << r.f;\n@@\n\ntry let _ = Hashtbl.find negtable f in ()\nwith Not_found -> include_match false\n\n// This rule may lead to inconsistent path problems, if E is defined in two\n// places\n@ depends on patch disable is_zero,isnt_zero @\nexpression *E;\nexpression E1;\nidentifier r.f;\n@@\n\nE = f(...)\n<...\n(\n- E == 0\n+ !E\n|\n- E != 0\n+ E\n|\n- 0 == E\n+ !E\n|\n- 0 != E\n+ E\n)\n...>\n?E = E1\n\n@t2 depends on !patch disable is_zero,isnt_zero @\nexpression *E;\nexpression E1;\nidentifier r.f;\nposition p1;\nposition p2;\n@@\n\nE = f(...)\n<...\n(\n* E == 0@p1\n|\n* E != 0@p2\n|\n* 0@p1 == E\n|\n* 0@p1 != E\n)\n...>\n?E = E1\n\n@script:python depends on org@\np << t2.p1;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING comparing pointer to 0, suggest !E\")\n\n@script:python depends on org@\np << t2.p2;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING comparing pointer to 0\")\n\n@script:python depends on report@\np << t2.p1;\n@@\n\ncoccilib.report.print_report(p[0], \"WARNING comparing pointer to 0, suggest !E\")\n\n@script:python depends on report@\np << t2.p2;\n@@\n\ncoccilib.report.print_report(p[0], \"WARNING comparing pointer to 0\")\n\n@ depends on patch disable is_zero,isnt_zero @\nexpression *E;\n@@\n\n(\n  E ==\n- 0\n+ NULL\n|\n  E !=\n- 0\n+ NULL\n|\n- 0\n+ NULL\n  == E\n|\n- 0\n+ NULL\n  != E\n)\n\n@ t3 depends on !patch disable is_zero,isnt_zero @\nexpression *E;\nposition p;\n@@\n\n(\n* E == 0@p\n|\n* E != 0@p\n|\n* 0@p == E\n|\n* 0@p != E\n)\n\n@script:python depends on org@\np << t3.p;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING comparing pointer to 0\")\n\n@script:python depends on report@\np << t3.p;\n@@\n\ncoccilib.report.print_report(p[0], \"WARNING comparing pointer to 0\")\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}