{
  "module_name": "device_node_continue.cocci",
  "hash_id": "e2c489e5bee2943528c6a187086123624d40eafb1f17486b9b1099ff6482c9c5",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/iterators/device_node_continue.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Device node iterators put the previous value of the index variable, so an\n/// explicit put causes a double put.\n///\n// Confidence: High\n// Copyright: (C) 2015 Julia Lawall, Inria.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Options: --no-includes --include-headers\n// Requires: 1.0.4\n// Keywords: for_each_child_of_node, etc.\n\n// This uses a conjunction, which requires at least coccinelle >= 1.0.4\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@r exists@\nexpression e1,e2;\nlocal idexpression n;\niterator name for_each_node_by_name, for_each_node_by_type,\nfor_each_compatible_node, for_each_matching_node,\nfor_each_matching_node_and_match, for_each_child_of_node,\nfor_each_available_child_of_node, for_each_node_with_property;\niterator i;\nposition p1,p2;\nstatement S;\n@@\n\n(\n(\nfor_each_node_by_name(n,e1) S\n|\nfor_each_node_by_type(n,e1) S\n|\nfor_each_compatible_node(n,e1,e2) S\n|\nfor_each_matching_node(n,e1) S\n|\nfor_each_matching_node_and_match(n,e1,e2) S\n|\nfor_each_child_of_node(e1,n) S\n|\nfor_each_available_child_of_node(e1,n) S\n|\nfor_each_node_with_property(n,e1) S\n)\n&\ni@p1(...) {\n   ... when != of_node_get(n)\n       when any\n   of_node_put@p2(n);\n   ... when any\n}\n)\n\n@s exists@\nlocal idexpression r.n;\nstatement S;\nposition r.p1,r.p2;\niterator i;\n@@\n\n of_node_put@p2(n);\n ... when any\n i@p1(..., n, ...)\n S\n\n@t depends on s && patch && !context && !org && !report@\nlocal idexpression n;\nposition r.p2;\n@@\n\n- of_node_put@p2(n);\n\n// ----------------------------------------------------------------------------\n\n@t_context depends on s && !patch && (context || org || report)@\nlocal idexpression n;\nposition r.p2;\nposition j0;\n@@\n\n*  of_node_put@j0@p2(n);\n\n// ----------------------------------------------------------------------------\n\n@script:python t_org depends on org@\nj0 << t_context.j0;\n@@\n\nmsg = \"ERROR: probable double put.\"\ncoccilib.org.print_todo(j0[0], msg)\n\n// ----------------------------------------------------------------------------\n\n@script:python t_report depends on report@\nj0 << t_context.j0;\n@@\n\nmsg = \"ERROR: probable double put.\"\ncoccilib.report.print_report(j0[0], msg)\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}