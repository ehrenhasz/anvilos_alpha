{
  "module_name": "list_entry_update.cocci",
  "hash_id": "eb92329687d05e9c44cf7e1b982c7fd8ed827c31d1b421ae195ce5eb97881a7c",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/iterators/list_entry_update.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// list_for_each_entry uses its first argument to get from one element of\n/// the list to the next, so it is usually not a good idea to reassign it.\n/// The first rule finds such a reassignment and the second rule checks\n/// that there is a path from the reassignment back to the top of the loop.\n///\n// Confidence: High\n// Copyright: (C) 2010 Nicolas Palix, DIKU.\n// Copyright: (C) 2010 Julia Lawall, DIKU.\n// Copyright: (C) 2010 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual context\nvirtual org\nvirtual report\n\n@r exists@\niterator name list_for_each_entry;\nexpression x,E;\nposition p1,p2;\n@@\n\nlist_for_each_entry@p1(x,...) { <... x =@p2 E ...> }\n\n@depends on context && !org && !report@\nexpression x,E;\nposition r.p1,r.p2;\nstatement S;\n@@\n\n*x =@p2 E\n...\nlist_for_each_entry@p1(x,...) S\n\n// ------------------------------------------------------------------------\n\n@back depends on (org || report) && !context exists@\nexpression x,E;\nposition r.p1,r.p2;\nstatement S;\n@@\n\nx =@p2 E\n...\nlist_for_each_entry@p1(x,...) S\n\n@script:python depends on back && org@\np1 << r.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"iterator\",p1)\ncocci.print_secs(\"update\",p2)\n\n@script:python depends on back && report@\np1 << r.p1;\np2 << r.p2;\n@@\n\nmsg = \"iterator with update on line %s\" % (p2[0].line)\ncoccilib.report.print_report(p1[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}