{
  "module_name": "itnull.cocci",
  "hash_id": "9e3efd4febc233051bed63c042418434efa07640992a711343c3218aa7690f73",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/iterators/itnull.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Many iterators have the property that the first argument is always bound\n/// to a real list element, never NULL.\n//# False positives arise for some iterators that do not have this property,\n//# or in cases when the loop cursor is reassigned.  The latter should only\n//# happen when the matched code is on the way to a loop exit (break, goto,\n//# or return).\n///\n// Confidence: Moderate\n// Copyright: (C) 2010-2012 Nicolas Palix.\n// Copyright: (C) 2010-2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2010-2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@depends on patch@\niterator I;\nexpression x,E,E1,E2;\nstatement S,S1,S2;\n@@\n\nI(x,...) { <...\n(\n- if (x == NULL && ...) S\n|\n- if (x != NULL || ...)\n  S\n|\n- (x == NULL) ||\n  E\n|\n- (x != NULL) &&\n  E\n|\n- (x == NULL && ...) ? E1 :\n  E2\n|\n- (x != NULL || ...) ?\n  E1\n- : E2\n|\n- if (x == NULL && ...) S1 else\n  S2\n|\n- if (x != NULL || ...)\n  S1\n- else S2\n|\n+ BAD(\n  x == NULL\n+ )\n|\n+ BAD(\n  x != NULL\n+ )\n)\n  ...> }\n\n@r depends on !patch exists@\niterator I;\nexpression x,E;\nposition p1,p2;\n@@\n\n*I@p1(x,...)\n{ ... when != x = E\n(\n*  x@p2 == NULL\n|\n*  x@p2 != NULL\n)\n  ... when any\n}\n\n@script:python depends on org@\np1 << r.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"iterator-bound variable\",p1)\ncocci.print_secs(\"useless NULL test\",p2)\n\n@script:python depends on report@\np1 << r.p1;\np2 << r.p2;\n@@\n\nmsg = \"ERROR: iterator variable bound on line %s cannot be NULL\" % (p1[0].line)\ncoccilib.report.print_report(p2[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}