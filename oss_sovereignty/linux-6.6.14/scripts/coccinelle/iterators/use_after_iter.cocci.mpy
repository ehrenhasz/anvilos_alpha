{
  "module_name": "use_after_iter.cocci",
  "hash_id": "4888e384b974b4f3ccccbf404a9cc0a0e1e11ee5ba1c0bbbe1c0bfd2d8db1df0",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/iterators/use_after_iter.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// If list_for_each_entry, etc complete a traversal of the list, the iterator\n/// variable ends up pointing to an address at an offset from the list head,\n/// and not a meaningful structure.  Thus this value should not be used after\n/// the end of the iterator.\n//#False positives arise when there is a goto in the iterator and the\n//#reported reference is at the label of this goto.  Some flag tests\n//#may also cause a report to be a false positive.\n///\n// Confidence: Moderate\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LIP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual context\nvirtual org\nvirtual report\n\n@r exists@\nidentifier c,member;\nexpression E,x;\niterator name list_for_each_entry;\niterator name list_for_each_entry_reverse;\niterator name list_for_each_entry_continue;\niterator name list_for_each_entry_continue_reverse;\niterator name list_for_each_entry_from;\niterator name list_for_each_entry_safe;\niterator name list_for_each_entry_safe_continue;\niterator name list_for_each_entry_safe_from;\niterator name list_for_each_entry_safe_reverse;\niterator name hlist_for_each_entry;\niterator name hlist_for_each_entry_continue;\niterator name hlist_for_each_entry_from;\niterator name hlist_for_each_entry_safe;\nstatement S;\nposition p1,p2;\ntype T;\n@@\n\n(\nlist_for_each_entry@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_reverse@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_continue@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_continue_reverse@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_from@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_safe@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_safe_continue@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_safe_from@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n|\nlist_for_each_entry_safe_reverse@p1(c,...,member) { ... when != break;\n                                 when forall\n                                 when strict\n}\n)\n...\n(\nlist_for_each_entry(c,...) S\n|\nlist_for_each_entry_reverse(c,...) S\n|\nlist_for_each_entry_continue(c,...) S\n|\nlist_for_each_entry_continue_reverse(c,...) S\n|\nlist_for_each_entry_from(c,...) S\n|\nlist_for_each_entry_safe(c,...) S\n|\nlist_for_each_entry_safe(x,c,...) S\n|\nlist_for_each_entry_safe_continue(c,...) S\n|\nlist_for_each_entry_safe_continue(x,c,...) S\n|\nlist_for_each_entry_safe_from(c,...) S\n|\nlist_for_each_entry_safe_from(x,c,...) S\n|\nlist_for_each_entry_safe_reverse(c,...) S\n|\nlist_for_each_entry_safe_reverse(x,c,...) S\n|\nhlist_for_each_entry(c,...) S\n|\nhlist_for_each_entry_continue(c,...) S\n|\nhlist_for_each_entry_from(c,...) S\n|\nhlist_for_each_entry_safe(c,...) S\n|\nlist_remove_head(x,c,...)\n|\nlist_entry_is_head(c,...)\n|\nsizeof(<+...c...+>)\n|\n &c->member\n|\nT c;\n|\nc = E\n|\n*c@p2\n)\n\n@script:python depends on org@\np1 << r.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"invalid iterator index reference\",p2)\ncocci.print_secs(\"iterator\",p1)\n\n@script:python depends on report@\np1 << r.p1;\np2 << r.p2;\n@@\n\nmsg = \"ERROR: invalid reference to the index variable of the iterator on line %s\" % (p1[0].line)\ncoccilib.report.print_report(p2[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}