{
  "module_name": "noderef.cocci",
  "hash_id": "a9b87f99bb137d0f30055c6da27b75267114b8c8953b6975a88588c20556f289",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/noderef.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// sizeof when applied to a pointer typed expression gives the size of\n/// the pointer\n///\n// Confidence: High\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual org\nvirtual report\nvirtual context\nvirtual patch\n\n@depends on patch@\nexpression *x;\nexpression f;\nexpression i;\ntype T;\n@@\n\n(\nx = <+... sizeof(\n- x\n+ *x\n   ) ...+>\n|\nf(...,(T)(x),...,sizeof(\n- x\n+ *x\n   ),...)\n|\nf(...,sizeof(\n- x\n+ *x\n   ),...,(T)(x),...)\n|\nf(...,(T)(x),...,i*sizeof(\n- x\n+ *x\n   ),...)\n|\nf(...,i*sizeof(\n- x\n+ *x\n   ),...,(T)(x),...)\n)\n\n@r depends on !patch@\nexpression *x;\nexpression f;\nexpression i;\nposition p;\ntype T;\n@@\n\n(\n*x = <+... sizeof@p(x) ...+>\n|\n*f(...,(T)(x),...,sizeof@p(x),...)\n|\n*f(...,sizeof@p(x),...,(T)(x),...)\n|\n*f(...,(T)(x),...,i*sizeof@p(x),...)\n|\n*f(...,i*sizeof@p(x),...,(T)(x),...)\n)\n\n@script:python depends on org@\np << r.p;\n@@\n\ncocci.print_main(\"application of sizeof to pointer\",p)\n\n@script:python depends on report@\np << r.p;\n@@\n\nmsg = \"ERROR: application of sizeof to pointer\"\ncoccilib.report.print_report(p[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}