{
  "module_name": "cstptr.cocci",
  "hash_id": "6d344f3e181dd57d252eacd5b201a170d8530ebcc42966b54b17bcf61eb0815c",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/cstptr.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// PTR_ERR should be applied before its argument is reassigned, typically\n/// to NULL\n///\n// Confidence: High\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual org\nvirtual report\nvirtual context\n\n@r exists@\nexpression e,e1;\nconstant c;\nposition p1,p2;\n@@\n\n*e@p1 = c\n... when != e = e1\n    when != &e\n    when != true IS_ERR(e)\n*PTR_ERR@p2(e)\n\n@script:python depends on org@\np1 << r.p1;\np2 << r.p2;\n@@\n\ncocci.print_main(\"PTR_ERR\",p2)\ncocci.print_secs(\"assignment\",p1)\n\n@script:python depends on report@\np1 << r.p1;\np2 << r.p2;\n@@\n\nmsg = \"ERROR: PTR_ERR applied after initialization to constant on line %s\" % (p1[0].line)\ncoccilib.report.print_report(p2[0],msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}