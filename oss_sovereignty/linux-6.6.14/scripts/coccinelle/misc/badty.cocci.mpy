{
  "module_name": "badty.cocci",
  "hash_id": "2558d1acc47dc37768216ed6f59230f99c0b9aac1c8d50e0af7eb2972926585f",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/badty.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Correct the size argument to alloc functions\n///\n//# This makes an effort to find cases where the argument to sizeof is wrong\n//# in memory allocation functions by checking the type of the allocated memory\n//# when it is a double pointer and ensuring the sizeof argument takes a pointer\n//# to the the memory being allocated. There are false positives in cases the\n//# sizeof argument is not used in constructing the return value. The result\n//# may need some reformatting.\n//\n// Confidence: Moderate\n// Copyright: (C) 2014 Himangi Saraogi.\n// Comments:\n// Options:\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@depends on context disable sizeof_type_expr@\ntype T;\nT **x;\n@@\n\n  x =\n  <+...sizeof(\n* T\n  )...+>\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@depends on patch disable sizeof_type_expr@\ntype T;\nT **x;\n@@\n\n  x =\n  <+...sizeof(\n- T\n+ *x\n  )...+>\n\n//----------------------------------------------------------\n//  For org and report mode\n//----------------------------------------------------------\n\n@r depends on (org || report) disable sizeof_type_expr@\ntype T;\nT **x;\nposition p;\n@@\n\n  x =\n  <+...sizeof(\n  T@p\n  )...+>\n\n@script:python depends on org@\np << r.p;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING sizeof argument should be pointer type, not structure type\")\n\n@script:python depends on report@\np << r.p;\n@@\n\nmsg=\"WARNING: Use correct pointer type argument for sizeof\"\ncoccilib.report.print_report(p[0], msg)\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}