{
  "module_name": "array_size.cocci",
  "hash_id": "a2b1aa1e6ba05d6ad293dbbf56e696ee0e534e85759624401ede5897f42c6745",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/array_size.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Use ARRAY_SIZE instead of dividing sizeof array with sizeof an element\n///\n//# This makes an effort to find cases where ARRAY_SIZE can be used such as\n//# where there is a division of sizeof the array by the sizeof its first\n//# element or by any indexed element or the element type. It replaces the\n//# division of the two sizeofs by ARRAY_SIZE.\n//\n// Confidence: High\n// Copyright: (C) 2014 Himangi Saraogi.\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@i@\n@@\n\n#include <linux/kernel.h>\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@depends on i&&context@\ntype T;\nT[] E;\n@@\n(\n* (sizeof(E)/sizeof(*E))\n|\n* (sizeof(E)/sizeof(E[...]))\n|\n* (sizeof(E)/sizeof(T))\n)\n\n//----------------------------------------------------------\n//  For patch mode\n//----------------------------------------------------------\n\n@depends on i&&patch@\ntype T;\nT[] E;\n@@\n(\n- (sizeof(E)/sizeof(*E))\n+ ARRAY_SIZE(E)\n|\n- (sizeof(E)/sizeof(E[...]))\n+ ARRAY_SIZE(E)\n|\n- (sizeof(E)/sizeof(T))\n+ ARRAY_SIZE(E)\n)\n\n//----------------------------------------------------------\n//  For org and report mode\n//----------------------------------------------------------\n\n@r depends on (org || report)@\ntype T;\nT[] E;\nposition p;\n@@\n(\n (sizeof(E)@p /sizeof(*E))\n|\n (sizeof(E)@p /sizeof(E[...]))\n|\n (sizeof(E)@p /sizeof(T))\n)\n\n@script:python depends on org@\np << r.p;\n@@\n\ncoccilib.org.print_todo(p[0], \"WARNING should use ARRAY_SIZE\")\n\n@script:python depends on report@\np << r.p;\n@@\n\nmsg=\"WARNING: Use ARRAY_SIZE\"\ncoccilib.report.print_report(p[0], msg)\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}