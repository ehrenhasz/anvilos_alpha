{
  "module_name": "newline_in_nl_msg.cocci",
  "hash_id": "3558ab11d2ac1b43a9bcf2febb5ef93225d6183252a5d3852bb1a8d29cf68e93",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/newline_in_nl_msg.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n///\n/// Catch strings ending in newline with GENL_SET_ERR_MSG, NL_SET_ERR_MSG,\n/// NL_SET_ERR_MSG_MOD.\n///\n// Confidence: Very High\n// Copyright: (C) 2020 Intel Corporation\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Options: --no-includes --include-headers\n\nvirtual context\nvirtual org\nvirtual report\n\n@r depends on context || org || report@\nexpression e;\nconstant m;\nposition p;\n@@\n  \\(GENL_SET_ERR_MSG\\|NL_SET_ERR_MSG\\|NL_SET_ERR_MSG_MOD\\)(e,m@p)\n\n@script:python@\nm << r.m;\n@@\n\nif not m.endswith(\"\\\\n\\\"\"):\n\tcocci.include_match(False)\n\n@r1 depends on r@\nidentifier fname;\nexpression r.e;\nconstant r.m;\nposition r.p;\n@@\n  fname(e,m@p)\n\n//----------------------------------------------------------\n//  For context mode\n//----------------------------------------------------------\n\n@depends on context && r@\nidentifier r1.fname;\nexpression r.e;\nconstant r.m;\n@@\n* fname(e,m)\n\n//----------------------------------------------------------\n//  For org mode\n//----------------------------------------------------------\n\n@script:python depends on org@\nfname << r1.fname;\nm << r.m;\np << r.p;\n@@\n\nif m.endswith(\"\\\\n\\\"\"):\n\tmsg=\"WARNING avoid newline at end of message in %s\" % (fname)\n\tmsg_safe=msg.replace(\"[\",\"@(\").replace(\"]\",\")\")\n\tcoccilib.org.print_todo(p[0], msg_safe)\n\n//----------------------------------------------------------\n//  For report mode\n//----------------------------------------------------------\n\n@script:python depends on report@\nfname << r1.fname;\nm << r.m;\np << r.p;\n@@\n\nif m.endswith(\"\\\\n\\\"\"):\n\tmsg=\"WARNING avoid newline at end of message in %s\" % (fname)\n\tcoccilib.report.print_report(p[0], msg)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}