{
  "module_name": "warn.cocci",
  "hash_id": "ddf3479dea1db8f0525f3a917dde5e1252f26a56ca62bfa777570344e6950a58",
  "original_prompt": "Ingested from linux-6.6.14/scripts/coccinelle/misc/warn.cocci",
  "human_readable_source": "// SPDX-License-Identifier: GPL-2.0-only\n/// Use WARN(1,...) rather than printk followed by WARN_ON(1)\n///\n// Confidence: High\n// Copyright: (C) 2012 Julia Lawall, INRIA/LIP6.\n// Copyright: (C) 2012 Gilles Muller, INRIA/LiP6.\n// URL: https://coccinelle.gitlabpages.inria.fr/website\n// Comments:\n// Options: --no-includes --include-headers\n\nvirtual patch\nvirtual context\nvirtual org\nvirtual report\n\n@bad1@\nposition p;\n@@\n\nprintk(...);\nprintk@p(...);\nWARN_ON(1);\n\n@r1 depends on context || report || org@\nposition p != bad1.p;\n@@\n\n printk@p(...);\n*WARN_ON(1);\n\n@script:python depends on org@\np << r1.p;\n@@\n\ncocci.print_main(\"printk + WARN_ON can be just WARN\",p)\n\n@script:python depends on report@\np << r1.p;\n@@\n\nmsg = \"SUGGESTION: printk + WARN_ON can be just WARN\"\ncoccilib.report.print_report(p[0],msg)\n\n@ok1 depends on patch@\nexpression list es;\nposition p != bad1.p;\n@@\n\n-printk@p(\n+WARN(1,\n  es);\n-WARN_ON(1);\n\n@depends on patch@\nexpression list ok1.es;\n@@\n\nif (...)\n- {\n  WARN(1,es);\n- }\n\n// --------------------------------------------------------------------\n\n@bad2@\nposition p;\n@@\n\nprintk(...);\nprintk@p(...);\nWARN_ON_ONCE(1);\n\n@r2 depends on context || report || org@\nposition p != bad1.p;\n@@\n\n printk@p(...);\n*WARN_ON_ONCE(1);\n\n@script:python depends on org@\np << r2.p;\n@@\n\ncocci.print_main(\"printk + WARN_ON_ONCE can be just WARN_ONCE\",p)\n\n@script:python depends on report@\np << r2.p;\n@@\n\nmsg = \"SUGGESTION: printk + WARN_ON_ONCE can be just WARN_ONCE\"\ncoccilib.report.print_report(p[0],msg)\n\n@ok2 depends on patch@\nexpression list es;\nposition p != bad2.p;\n@@\n\n-printk@p(\n+WARN_ONCE(1,\n  es);\n-WARN_ON_ONCE(1);\n\n@depends on patch@\nexpression list ok2.es;\n@@\n\nif (...)\n- {\n  WARN_ONCE(1,es);\n- }\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}