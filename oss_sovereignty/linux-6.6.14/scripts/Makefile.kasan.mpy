{
  "module_name": "Makefile.kasan",
  "hash_id": "0c4a64b78af903602bf6edab89cd1138e4c7263be880482728908055c77e8a06",
  "original_prompt": "Ingested from linux-6.6.14/scripts/Makefile.kasan",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\n\nifdef CONFIG_CC_HAS_KASAN_MEMINTRINSIC_PREFIX\n# Safe for compiler to generate meminstrinsic calls in uninstrumented files.\nCFLAGS_KASAN_NOSANITIZE :=\nelse\n# Don't let compiler generate memintrinsic calls in uninstrumented files\n# because they are instrumented.\nCFLAGS_KASAN_NOSANITIZE := -fno-builtin\nendif\n\nKASAN_SHADOW_OFFSET ?= $(CONFIG_KASAN_SHADOW_OFFSET)\n\ncc-param = $(call cc-option, -mllvm -$(1), $(call cc-option, --param $(1)))\n\nifdef CONFIG_KASAN_STACK\n\tstack_enable := 1\nelse\n\tstack_enable := 0\nendif\n\nifdef CONFIG_KASAN_GENERIC\n\nifdef CONFIG_KASAN_INLINE\n\tcall_threshold := 10000\nelse\n\tcall_threshold := 0\nendif\n\nCFLAGS_KASAN_MINIMAL := -fsanitize=kernel-address\n\n# -fasan-shadow-offset fails without -fsanitize\nCFLAGS_KASAN_SHADOW := $(call cc-option, -fsanitize=kernel-address \\\n\t\t\t-fasan-shadow-offset=$(KASAN_SHADOW_OFFSET), \\\n\t\t\t$(call cc-option, -fsanitize=kernel-address \\\n\t\t\t-mllvm -asan-mapping-offset=$(KASAN_SHADOW_OFFSET)))\n\nifeq ($(strip $(CFLAGS_KASAN_SHADOW)),)\n\tCFLAGS_KASAN := $(CFLAGS_KASAN_MINIMAL)\nelse\n\t# Now add all the compiler specific options that are valid standalone\n\tCFLAGS_KASAN := $(CFLAGS_KASAN_SHADOW) \\\n\t $(call cc-param,asan-globals=1) \\\n\t $(call cc-param,asan-instrumentation-with-call-threshold=$(call_threshold)) \\\n\t $(call cc-param,asan-instrument-allocas=1)\nendif\n\nCFLAGS_KASAN += $(call cc-param,asan-stack=$(stack_enable))\n\n# Instrument memcpy/memset/memmove calls by using instrumented __asan_mem*()\n# instead. With compilers that don't support this option, compiler-inserted\n# memintrinsics won't be checked by KASAN on GENERIC_ENTRY architectures.\nCFLAGS_KASAN += $(call cc-param,asan-kernel-mem-intrinsic-prefix=1)\n\nendif # CONFIG_KASAN_GENERIC\n\nifdef CONFIG_KASAN_SW_TAGS\n\nifdef CONFIG_KASAN_INLINE\n    instrumentation_flags := $(call cc-param,hwasan-mapping-offset=$(KASAN_SHADOW_OFFSET))\nelse\n    instrumentation_flags := $(call cc-param,hwasan-instrument-with-calls=1)\nendif\n\nCFLAGS_KASAN := -fsanitize=kernel-hwaddress \\\n\t\t$(call cc-param,hwasan-instrument-stack=$(stack_enable)) \\\n\t\t$(call cc-param,hwasan-use-short-granules=0) \\\n\t\t$(call cc-param,hwasan-inline-all-checks=0) \\\n\t\t$(instrumentation_flags)\n\n# Instrument memcpy/memset/memmove calls by using instrumented __hwasan_mem*().\nifeq ($(call clang-min-version, 150000)$(call gcc-min-version, 130000),y)\nCFLAGS_KASAN += $(call cc-param,hwasan-kernel-mem-intrinsic-prefix=1)\nendif\n\nendif # CONFIG_KASAN_SW_TAGS\n\nexport CFLAGS_KASAN CFLAGS_KASAN_NOSANITIZE\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}