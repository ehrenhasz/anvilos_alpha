{
  "module_name": "extract-vmlinux",
  "hash_id": "97cfeeeb51de17f4b5928c5442b56e5581314ddef3cedf2523be2049d79394af",
  "original_prompt": "Ingested from linux-6.6.14/scripts/extract-vmlinux",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0-only\n# ----------------------------------------------------------------------\n# extract-vmlinux - Extract uncompressed vmlinux from a kernel image\n#\n# Inspired from extract-ikconfig\n# (c) 2009,2010 Dick Streefland <dick@streefland.net>\n#\n# (c) 2011      Corentin Chary <corentin.chary@gmail.com>\n#\n# ----------------------------------------------------------------------\n\ncheck_vmlinux()\n{\n\t# Use readelf to check if it's a valid ELF\n\t# TODO: find a better to way to check that it's really vmlinux\n\t#       and not just an elf\n\treadelf -h $1 > /dev/null 2>&1 || return 1\n\n\tcat $1\n\texit 0\n}\n\ntry_decompress()\n{\n\t# The obscure use of the \"tr\" filter is to work around older versions of\n\t# \"grep\" that report the byte offset of the line instead of the pattern.\n\n\t# Try to find the header ($1) and decompress from here\n\tfor\tpos in `tr \"$1\\n$2\" \"\\n$2=\" < \"$img\" | grep -abo \"^$2\"`\n\tdo\n\t\tpos=${pos%%:*}\n\t\ttail -c+$pos \"$img\" | $3 > $tmp 2> /dev/null\n\t\tcheck_vmlinux $tmp\n\tdone\n}\n\n# Check invocation:\nme=${0##*/}\nimg=$1\nif\t[ $# -ne 1 -o ! -s \"$img\" ]\nthen\n\techo \"Usage: $me <kernel-image>\" >&2\n\texit 2\nfi\n\n# Prepare temp files:\ntmp=$(mktemp /tmp/vmlinux-XXX)\ntrap \"rm -f $tmp\" 0\n\n# That didn't work, so retry after decompression.\ntry_decompress '\\037\\213\\010' xy    gunzip\ntry_decompress '\\3757zXZ\\000' abcde unxz\ntry_decompress 'BZh'          xy    bunzip2\ntry_decompress '\\135\\0\\0\\0'   xxx   unlzma\ntry_decompress '\\211\\114\\132' xy    'lzop -d'\ntry_decompress '\\002!L\\030'   xxx   'lz4 -d'\ntry_decompress '(\\265/\\375'   xxx   unzstd\n\n# Finally check for uncompressed images or objects:\ncheck_vmlinux $img\n\n# Bail out:\necho \"$me: Cannot find vmlinux.\" >&2\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}