{
  "module_name": "checkversion.pl",
  "hash_id": "86eef5a74e074bfe945c1230d1cdaebae8c3ff8cdcaa55a42232f8f30da4ac9a",
  "original_prompt": "Ingested from linux-6.6.14/scripts/checkversion.pl",
  "human_readable_source": "#! /usr/bin/env perl\n# SPDX-License-Identifier: GPL-2.0\n#\n# checkversion finds uses of all macros in <linux/version.h>\n# where the source files do not #include <linux/version.h>; or cases\n# of including <linux/version.h> where it is not needed.\n# Copyright (C) 2003, Randy Dunlap <rdunlap@infradead.org>\n\nuse strict;\n\n$| = 1;\n\nmy $debugging;\n\nforeach my $file (@ARGV) {\n    next if $file =~ \"include/generated/uapi/linux/version\\.h\";\n    next if $file =~ \"usr/include/linux/version\\.h\";\n    # Open this file.\n    open( my $f, '<', $file )\n      or die \"Can't open $file: $!\\n\";\n\n    # Initialize variables.\n    my ($fInComment, $fInString, $fUseVersion);\n    my $iLinuxVersion = 0;\n\n    while (<$f>) {\n\t# Strip comments.\n\t$fInComment && (s+^.*?\\*/+ +o ? ($fInComment = 0) : next);\n\tm+/\\*+o && (s+/\\*.*?\\*/+ +go, (s+/\\*.*$+ +o && ($fInComment = 1)));\n\n\t# Pick up definitions.\n\tif ( m/^\\s*#/o ) {\n\t    $iLinuxVersion      = $. if m/^\\s*#\\s*include\\s*\"linux\\/version\\.h\"/o;\n\t}\n\n\t# Strip strings.\n\t$fInString && (s+^.*?\"+ +o ? ($fInString = 0) : next);\n\tm+\"+o && (s+\".*?\"+ +go, (s+\".*$+ +o && ($fInString = 1)));\n\n\t# Pick up definitions.\n\tif ( m/^\\s*#/o ) {\n\t    $iLinuxVersion      = $. if m/^\\s*#\\s*include\\s*<linux\\/version\\.h>/o;\n\t}\n\n\t# Look for uses: LINUX_VERSION_CODE, KERNEL_VERSION,\n\t# LINUX_VERSION_MAJOR, LINUX_VERSION_PATCHLEVEL, LINUX_VERSION_SUBLEVEL\n\tif (($_ =~ /LINUX_VERSION_CODE/) || ($_ =~ /\\WKERNEL_VERSION/) ||\n\t    ($_ =~ /LINUX_VERSION_MAJOR/) || ($_ =~ /LINUX_VERSION_PATCHLEVEL/) ||\n\t    ($_ =~ /LINUX_VERSION_SUBLEVEL/)) {\n\t    $fUseVersion = 1;\n            last if $iLinuxVersion;\n        }\n    }\n\n    # Report used version IDs without include?\n    if ($fUseVersion && ! $iLinuxVersion) {\n\tprint \"$file: $.: need linux/version.h\\n\";\n    }\n\n    # Report superfluous includes.\n    if ($iLinuxVersion && ! $fUseVersion) {\n\tprint \"$file: $iLinuxVersion linux/version.h not needed.\\n\";\n    }\n\n    # debug: report OK results:\n    if ($debugging) {\n        if ($iLinuxVersion && $fUseVersion) {\n\t    print \"$file: version use is OK ($iLinuxVersion)\\n\";\n        }\n        if (! $iLinuxVersion && ! $fUseVersion) {\n\t    print \"$file: version use is OK (none)\\n\";\n        }\n    }\n\n    close($f);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}