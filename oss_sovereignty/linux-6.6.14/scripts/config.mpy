{
  "module_name": "config",
  "hash_id": "f2f312526fdb71824d0b52aa82879fec2699b7d38cdd41d74c3c3e451e4bc669",
  "original_prompt": "Ingested from linux-6.6.14/scripts/config",
  "human_readable_source": "#!/usr/bin/env bash\n# SPDX-License-Identifier: GPL-2.0\n# Manipulate options in a .config file from the command line\n\nmyname=${0##*/}\n\n# If no prefix forced, use the default CONFIG_\nCONFIG_=\"${CONFIG_-CONFIG_}\"\n\n# We use an uncommon delimiter for sed substitutions\nSED_DELIM=$(echo -en \"\\001\")\n\nusage() {\n\tcat >&2 <<EOL\nManipulate options in a .config file from the command line.\nUsage:\n$myname options command ...\ncommands:\n\t--enable|-e option   Enable option\n\t--disable|-d option  Disable option\n\t--module|-m option   Turn option into a module\n\t--set-str option string\n\t                     Set option to \"string\"\n\t--set-val option value\n\t                     Set option to value\n\t--undefine|-u option Undefine option\n\t--state|-s option    Print state of option (n,y,m,undef)\n\n\t--enable-after|-E beforeopt option\n                             Enable option directly after other option\n\t--disable-after|-D beforeopt option\n                             Disable option directly after other option\n\t--module-after|-M beforeopt option\n                             Turn option into module directly after other option\n\n\tcommands can be repeated multiple times\n\noptions:\n\t--file config-file   .config file to change (default .config)\n\t--keep-case|-k       Keep next symbols' case (dont' upper-case it)\n\n$myname doesn't check the validity of the .config file. This is done at next\nmake time.\n\nBy default, $myname will upper-case the given symbol. Use --keep-case to keep\nthe case of all following symbols unchanged.\n\n$myname uses 'CONFIG_' as the default symbol prefix. Set the environment\nvariable CONFIG_ to the prefix to use. Eg.: CONFIG_=\"FOO_\" $myname ...\nEOL\n\texit 1\n}\n\ncheckarg() {\n\tARG=\"$1\"\n\tif [ \"$ARG\" = \"\" ] ; then\n\t\tusage\n\tfi\n\tcase \"$ARG\" in\n\t${CONFIG_}*)\n\t\tARG=\"${ARG/${CONFIG_}/}\"\n\t\t;;\n\tesac\n\tif [ \"$MUNGE_CASE\" = \"yes\" ] ; then\n\t\tARG=\"`echo $ARG | tr a-z A-Z`\"\n\tfi\n}\n\ntxt_append() {\n\tlocal anchor=\"$1\"\n\tlocal insert=\"$2\"\n\tlocal infile=\"$3\"\n\tlocal tmpfile=\"$infile.swp\"\n\n\t# sed append cmd: 'a\\' + newline + text + newline\n\tcmd=\"$(printf \"a\\\\%b$insert\" \"\\n\")\"\n\n\tsed -e \"/$anchor/$cmd\" \"$infile\" >\"$tmpfile\"\n\t# replace original file with the edited one\n\tmv \"$tmpfile\" \"$infile\"\n}\n\ntxt_subst() {\n\tlocal before=\"$1\"\n\tlocal after=\"$2\"\n\tlocal infile=\"$3\"\n\tlocal tmpfile=\"$infile.swp\"\n\n\tsed -e \"s$SED_DELIM$before$SED_DELIM$after$SED_DELIM\" \"$infile\" >\"$tmpfile\"\n\t# replace original file with the edited one\n\tmv \"$tmpfile\" \"$infile\"\n}\n\ntxt_delete() {\n\tlocal text=\"$1\"\n\tlocal infile=\"$2\"\n\tlocal tmpfile=\"$infile.swp\"\n\n\tsed -e \"/$text/d\" \"$infile\" >\"$tmpfile\"\n\t# replace original file with the edited one\n\tmv \"$tmpfile\" \"$infile\"\n}\n\nset_var() {\n\tlocal name=$1 new=$2 before=$3\n\n\tname_re=\"^($name=|# $name is not set)\"\n\tbefore_re=\"^($before=|# $before is not set)\"\n\tif test -n \"$before\" && grep -Eq \"$before_re\" \"$FN\"; then\n\t\ttxt_append \"^$before=\" \"$new\" \"$FN\"\n\t\ttxt_append \"^# $before is not set\" \"$new\" \"$FN\"\n\telif grep -Eq \"$name_re\" \"$FN\"; then\n\t\ttxt_subst \"^$name=.*\" \"$new\" \"$FN\"\n\t\ttxt_subst \"^# $name is not set\" \"$new\" \"$FN\"\n\telse\n\t\techo \"$new\" >>\"$FN\"\n\tfi\n}\n\nundef_var() {\n\tlocal name=$1\n\n\ttxt_delete \"^$name=\" \"$FN\"\n\ttxt_delete \"^# $name is not set\" \"$FN\"\n}\n\nif [ \"$1\" = \"--file\" ]; then\n\tFN=\"$2\"\n\tif [ \"$FN\" = \"\" ] ; then\n\t\tusage\n\tfi\n\tshift 2\nelse\n\tFN=.config\nfi\n\nif [ \"$1\" = \"\" ] ; then\n\tusage\nfi\n\nMUNGE_CASE=yes\nwhile [ \"$1\" != \"\" ] ; do\n\tCMD=\"$1\"\n\tshift\n\tcase \"$CMD\" in\n\t--keep-case|-k)\n\t\tMUNGE_CASE=no\n\t\tcontinue\n\t\t;;\n\t--refresh)\n\t\t;;\n\t--*-after|-E|-D|-M)\n\t\tcheckarg \"$1\"\n\t\tA=$ARG\n\t\tcheckarg \"$2\"\n\t\tB=$ARG\n\t\tshift 2\n\t\t;;\n\t-*)\n\t\tcheckarg \"$1\"\n\t\tshift\n\t\t;;\n\tesac\n\tcase \"$CMD\" in\n\t--enable|-e)\n\t\tset_var \"${CONFIG_}$ARG\" \"${CONFIG_}$ARG=y\"\n\t\t;;\n\n\t--disable|-d)\n\t\tset_var \"${CONFIG_}$ARG\" \"# ${CONFIG_}$ARG is not set\"\n\t\t;;\n\n\t--module|-m)\n\t\tset_var \"${CONFIG_}$ARG\" \"${CONFIG_}$ARG=m\"\n\t\t;;\n\n\t--set-str)\n\t\t# sed swallows one level of escaping, so we need double-escaping\n\t\tset_var \"${CONFIG_}$ARG\" \"${CONFIG_}$ARG=\\\"${1//\\\"/\\\\\\\\\\\"}\\\"\"\n\t\tshift\n\t\t;;\n\n\t--set-val)\n\t\tset_var \"${CONFIG_}$ARG\" \"${CONFIG_}$ARG=$1\"\n\t\tshift\n\t\t;;\n\t--undefine|-u)\n\t\tundef_var \"${CONFIG_}$ARG\"\n\t\t;;\n\n\t--state|-s)\n\t\tif grep -q \"# ${CONFIG_}$ARG is not set\" $FN ; then\n\t\t\techo n\n\t\telse\n\t\t\tV=\"$(grep \"^${CONFIG_}$ARG=\" $FN)\"\n\t\t\tif [ $? != 0 ] ; then\n\t\t\t\techo undef\n\t\t\telse\n\t\t\t\tV=\"${V/#${CONFIG_}$ARG=/}\"\n\t\t\t\tV=\"${V/#\\\"/}\"\n\t\t\t\tV=\"${V/%\\\"/}\"\n\t\t\t\tV=\"${V//\\\\\\\"/\\\"}\"\n\t\t\t\techo \"${V}\"\n\t\t\tfi\n\t\tfi\n\t\t;;\n\n\t--enable-after|-E)\n\t\tset_var \"${CONFIG_}$B\" \"${CONFIG_}$B=y\" \"${CONFIG_}$A\"\n\t\t;;\n\n\t--disable-after|-D)\n\t\tset_var \"${CONFIG_}$B\" \"# ${CONFIG_}$B is not set\" \"${CONFIG_}$A\"\n\t\t;;\n\n\t--module-after|-M)\n\t\tset_var \"${CONFIG_}$B\" \"${CONFIG_}$B=m\" \"${CONFIG_}$A\"\n\t\t;;\n\n\t# undocumented because it ignores --file (fixme)\n\t--refresh)\n\t\tyes \"\" | make oldconfig\n\t\t;;\n\n\t*)\n\t\techo \"bad command: $CMD\" >&2\n\t\tusage\n\t\t;;\n\tesac\ndone\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}