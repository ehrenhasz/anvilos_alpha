{
  "module_name": "kernel.spec",
  "hash_id": "78c634166b49754ff7ba3361b5950621a81b3cff436e640026164aa86137dba1",
  "original_prompt": "Ingested from linux-6.6.14/scripts/package/kernel.spec",
  "human_readable_source": "# _arch is undefined if /usr/lib/rpm/platform/*/macros was not included.\n%{!?_arch: %define _arch dummy}\n%{!?make: %define make make}\n%define makeflags %{?_smp_mflags} ARCH=%{ARCH}\n%define __spec_install_post /usr/lib/rpm/brp-compress || :\n%define debug_package %{nil}\n\nName: kernel\nSummary: The Linux Kernel\nVersion: %(echo %{KERNELRELEASE} | sed -e 's/-/_/g')\nRelease: %{pkg_release}\nLicense: GPL\nGroup: System Environment/Kernel\nVendor: The Linux Community\nURL: https://www.kernel.org\nSource0: linux.tar.gz\nSource1: config\nSource2: diff.patch\nProvides: kernel-%{KERNELRELEASE}\nBuildRequires: bc binutils bison dwarves\nBuildRequires: (elfutils-libelf-devel or libelf-devel) flex\nBuildRequires: gcc make openssl openssl-devel perl python3 rsync\n\n%description\nThe Linux Kernel, the operating system core itself\n\n%package headers\nSummary: Header files for the Linux kernel for use by glibc\nGroup: Development/System\nObsoletes: kernel-headers\nProvides: kernel-headers = %{version}\n%description headers\nKernel-headers includes the C header files that specify the interface\nbetween the Linux kernel and userspace libraries and programs.  The\nheader files define structures and constants that are needed for\nbuilding most standard programs and are also needed for rebuilding the\nglibc package.\n\n%if %{with_devel}\n%package devel\nSummary: Development package for building kernel modules to match the %{version} kernel\nGroup: System Environment/Kernel\nAutoReqProv: no\n%description -n kernel-devel\nThis package provides kernel headers and makefiles sufficient to build modules\nagainst the %{version} kernel package.\n%endif\n\n%prep\n%setup -q -n linux\ncp %{SOURCE1} .config\npatch -p1 < %{SOURCE2}\n\n%build\n%{make} %{makeflags} KERNELRELEASE=%{KERNELRELEASE} KBUILD_BUILD_VERSION=%{release}\n\n%install\nmkdir -p %{buildroot}/boot\n%ifarch ia64\nmkdir -p %{buildroot}/boot/efi\ncp $(%{make} %{makeflags} -s image_name) %{buildroot}/boot/efi/vmlinuz-%{KERNELRELEASE}\nln -s efi/vmlinuz-%{KERNELRELEASE} %{buildroot}/boot/\n%else\ncp $(%{make} %{makeflags} -s image_name) %{buildroot}/boot/vmlinuz-%{KERNELRELEASE}\n%endif\n%{make} %{makeflags} INSTALL_MOD_PATH=%{buildroot} modules_install\n%{make} %{makeflags} INSTALL_HDR_PATH=%{buildroot}/usr headers_install\ncp System.map %{buildroot}/boot/System.map-%{KERNELRELEASE}\ncp .config %{buildroot}/boot/config-%{KERNELRELEASE}\nln -fns /usr/src/kernels/%{KERNELRELEASE} %{buildroot}/lib/modules/%{KERNELRELEASE}/build\n%if %{with_devel}\n%{make} %{makeflags} run-command KBUILD_RUN_COMMAND='${srctree}/scripts/package/install-extmod-build %{buildroot}/usr/src/kernels/%{KERNELRELEASE}'\n%endif\n\n%clean\nrm -rf %{buildroot}\n\n%post\nif [ -x /sbin/installkernel -a -r /boot/vmlinuz-%{KERNELRELEASE} -a -r /boot/System.map-%{KERNELRELEASE} ]; then\ncp /boot/vmlinuz-%{KERNELRELEASE} /boot/.vmlinuz-%{KERNELRELEASE}-rpm\ncp /boot/System.map-%{KERNELRELEASE} /boot/.System.map-%{KERNELRELEASE}-rpm\nrm -f /boot/vmlinuz-%{KERNELRELEASE} /boot/System.map-%{KERNELRELEASE}\n/sbin/installkernel %{KERNELRELEASE} /boot/.vmlinuz-%{KERNELRELEASE}-rpm /boot/.System.map-%{KERNELRELEASE}-rpm\nrm -f /boot/.vmlinuz-%{KERNELRELEASE}-rpm /boot/.System.map-%{KERNELRELEASE}-rpm\nfi\n\n%preun\nif [ -x /sbin/new-kernel-pkg ]; then\nnew-kernel-pkg --remove %{KERNELRELEASE} --rminitrd --initrdfile=/boot/initramfs-%{KERNELRELEASE}.img\nelif [ -x /usr/bin/kernel-install ]; then\nkernel-install remove %{KERNELRELEASE}\nfi\n\n%postun\nif [ -x /sbin/update-bootloader ]; then\n/sbin/update-bootloader --remove %{KERNELRELEASE}\nfi\n\n%files\n%defattr (-, root, root)\n/lib/modules/%{KERNELRELEASE}\n%exclude /lib/modules/%{KERNELRELEASE}/build\n/boot/*\n\n%files headers\n%defattr (-, root, root)\n/usr/include\n\n%if %{with_devel}\n%files devel\n%defattr (-, root, root)\n/usr/src/kernels/%{KERNELRELEASE}\n/lib/modules/%{KERNELRELEASE}/build\n%endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}