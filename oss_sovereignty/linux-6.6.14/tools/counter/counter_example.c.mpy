{
  "module_name": "counter_example.c",
  "hash_id": "ae993e6bd506b1b43334082e6d42b2ae4fdfbeaf2b3df52c980950cc5fa254f2",
  "original_prompt": "Ingested from linux-6.6.14/tools/counter/counter_example.c",
  "human_readable_source": "\n \n#include <errno.h>\n#include <fcntl.h>\n#include <linux/counter.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/ioctl.h>\n#include <unistd.h>\n\nstatic struct counter_watch watches[2] = {\n\t{\n\t\t \n\t\t.component.type = COUNTER_COMPONENT_COUNT,\n\t\t.component.scope = COUNTER_SCOPE_COUNT,\n\t\t.component.parent = 0,\n\t\t \n\t\t.event = COUNTER_EVENT_INDEX,\n\t\t \n\t\t.channel = 0,\n\t},\n\t{\n\t\t \n\t\t.component.type = COUNTER_COMPONENT_COUNT,\n\t\t.component.scope = COUNTER_SCOPE_COUNT,\n\t\t.component.parent = 1,\n\t\t \n\t\t.event = COUNTER_EVENT_INDEX,\n\t\t \n\t\t.channel = 0,\n\t},\n};\n\nint main(void)\n{\n\tint fd;\n\tint ret;\n\tint i;\n\tstruct counter_event event_data[2];\n\n\tfd = open(\"/dev/counter0\", O_RDWR);\n\tif (fd == -1) {\n\t\tperror(\"Unable to open /dev/counter0\");\n\t\treturn 1;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\tret = ioctl(fd, COUNTER_ADD_WATCH_IOCTL, watches + i);\n\t\tif (ret == -1) {\n\t\t\tfprintf(stderr, \"Error adding watches[%d]: %s\\n\", i,\n\t\t\t\tstrerror(errno));\n\t\t\treturn 1;\n\t\t}\n\t}\n\tret = ioctl(fd, COUNTER_ENABLE_EVENTS_IOCTL);\n\tif (ret == -1) {\n\t\tperror(\"Error enabling events\");\n\t\treturn 1;\n\t}\n\n\tfor (;;) {\n\t\tret = read(fd, event_data, sizeof(event_data));\n\t\tif (ret == -1) {\n\t\t\tperror(\"Failed to read event data\");\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (ret != sizeof(event_data)) {\n\t\t\tfprintf(stderr, \"Failed to read event data\\n\");\n\t\t\treturn -EIO;\n\t\t}\n\n\t\tprintf(\"Timestamp 0: %llu\\tCount 0: %llu\\n\"\n\t\t       \"Error Message 0: %s\\n\"\n\t\t       \"Timestamp 1: %llu\\tCount 1: %llu\\n\"\n\t\t       \"Error Message 1: %s\\n\",\n\t\t       event_data[0].timestamp, event_data[0].value,\n\t\t       strerror(event_data[0].status),\n\t\t       event_data[1].timestamp, event_data[1].value,\n\t\t       strerror(event_data[1].status));\n\t}\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}