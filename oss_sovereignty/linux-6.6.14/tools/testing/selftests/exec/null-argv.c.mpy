{
  "module_name": "null-argv.c",
  "hash_id": "8f79bbff12a577698f58921bf74515ac5f92e6c912fc0f2d70ae7097f1380d50",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/exec/null-argv.c",
  "human_readable_source": "\n \n#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n\n#include \"../kselftest.h\"\n\n#define FORK(exec)\t\t\t\t\\\ndo {\t\t\t\t\t\t\\\n\tpid = fork();\t\t\t\t\\\n\tif (pid == 0) {\t\t\t\t\\\n\t\t \t\t\t\\\n\t\texec;  \t\\\n\t\tperror(\"# \" #exec);\t\t\\\n\t\treturn 1;\t\t\t\\\n\t}\t\t\t\t\t\\\n\tcheck_result(pid, #exec);\t\t\\\n} while (0)\n\nvoid check_result(pid_t pid, const char *msg)\n{\n\tint wstatus;\n\n\tif (pid == (pid_t)-1) {\n\t\tperror(\"# fork\");\n\t\tksft_test_result_fail(\"fork failed: %s\\n\", msg);\n\t\treturn;\n\t}\n\tif (waitpid(pid, &wstatus, 0) < 0) {\n\t\tperror(\"# waitpid\");\n\t\tksft_test_result_fail(\"waitpid failed: %s\\n\", msg);\n\t\treturn;\n\t}\n\tif (!WIFEXITED(wstatus)) {\n\t\tksft_test_result_fail(\"child did not exit: %s\\n\", msg);\n\t\treturn;\n\t}\n\tif (WEXITSTATUS(wstatus) != 0) {\n\t\tksft_test_result_fail(\"non-zero exit: %s\\n\", msg);\n\t\treturn;\n\t}\n\tksft_test_result_pass(\"%s\\n\", msg);\n}\n\nint main(int argc, char *argv[], char *envp[])\n{\n\tpid_t pid;\n\tstatic char * const args[] = { NULL };\n\tstatic char * const str[] = { \"\", NULL };\n\n\t \n\tif (argc < 1) {\n\t\tfprintf(stderr, \"# FAIL: saw argc == 0 (old kernel?)\\n\");\n\t\treturn 1;\n\t}\n\tif (argc != 1) {\n\t\tfprintf(stderr, \"# FAIL: unknown argc (%d)\\n\", argc);\n\t\treturn 1;\n\t}\n\tif (argv[0][0] == '\\0') {\n\t\t \n\t\treturn 0;\n\t}\n\n\t \n\tksft_print_header();\n\tksft_set_plan(5);\n\n\tFORK(execve(argv[0], str, NULL));\n\tFORK(execve(argv[0], NULL, NULL));\n\tFORK(execve(argv[0], NULL, envp));\n\tFORK(execve(argv[0], args, NULL));\n\tFORK(execve(argv[0], args, envp));\n\n\tksft_exit(ksft_cnt.ksft_pass == ksft_plan);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}