{
  "module_name": "helpers.h",
  "hash_id": "0f455c484fcc272265205609b023a944d58cc6e135e016ecb16a82c08c08158f",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/openat2/helpers.h",
  "human_readable_source": "\n \n\n#ifndef __RESOLVEAT_H__\n#define __RESOLVEAT_H__\n\n#define _GNU_SOURCE\n#include <stdint.h>\n#include <stdbool.h>\n#include <errno.h>\n#include <linux/types.h>\n#include \"../kselftest.h\"\n\n#define ARRAY_LEN(X) (sizeof (X) / sizeof (*(X)))\n#define BUILD_BUG_ON(e) ((void)(sizeof(struct { int:(-!!(e)); })))\n\n#ifndef SYS_openat2\n#ifndef __NR_openat2\n#define __NR_openat2 437\n#endif  \n#define SYS_openat2 __NR_openat2\n#endif  \n\n \nstruct open_how {\n\t__u64 flags;\n\t__u64 mode;\n\t__u64 resolve;\n};\n\n#define OPEN_HOW_SIZE_VER0\t24  \n#define OPEN_HOW_SIZE_LATEST\tOPEN_HOW_SIZE_VER0\n\nbool needs_openat2(const struct open_how *how);\n\n#ifndef RESOLVE_IN_ROOT\n \n#define RESOLVE_NO_XDEV\t\t0x01  \n#define RESOLVE_NO_MAGICLINKS\t0x02  \n#define RESOLVE_NO_SYMLINKS\t0x04  \n#define RESOLVE_BENEATH\t\t0x08  \n#define RESOLVE_IN_ROOT\t\t0x10  \n#endif  \n\n#define E_func(func, ...)\t\t\t\t\t\t      \\\n\tdo {\t\t\t\t\t\t\t\t      \\\n\t\terrno = 0;\t\t\t\t\t\t      \\\n\t\tif (func(__VA_ARGS__) < 0)\t\t\t\t      \\\n\t\t\tksft_exit_fail_msg(\"%s:%d %s failed - errno:%d\\n\",    \\\n\t\t\t\t\t   __FILE__, __LINE__, #func, errno); \\\n\t} while (0)\n\n#define E_asprintf(...)\t\tE_func(asprintf,\t__VA_ARGS__)\n#define E_chmod(...)\t\tE_func(chmod,\t\t__VA_ARGS__)\n#define E_dup2(...)\t\tE_func(dup2,\t\t__VA_ARGS__)\n#define E_fchdir(...)\t\tE_func(fchdir,\t\t__VA_ARGS__)\n#define E_fstatat(...)\t\tE_func(fstatat,\t\t__VA_ARGS__)\n#define E_kill(...)\t\tE_func(kill,\t\t__VA_ARGS__)\n#define E_mkdirat(...)\t\tE_func(mkdirat,\t\t__VA_ARGS__)\n#define E_mount(...)\t\tE_func(mount,\t\t__VA_ARGS__)\n#define E_prctl(...)\t\tE_func(prctl,\t\t__VA_ARGS__)\n#define E_readlink(...)\t\tE_func(readlink,\t__VA_ARGS__)\n#define E_setresuid(...)\tE_func(setresuid,\t__VA_ARGS__)\n#define E_symlinkat(...)\tE_func(symlinkat,\t__VA_ARGS__)\n#define E_touchat(...)\t\tE_func(touchat,\t\t__VA_ARGS__)\n#define E_unshare(...)\t\tE_func(unshare,\t\t__VA_ARGS__)\n\n#define E_assert(expr, msg, ...)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tif (!(expr))\t\t\t\t\t\t\\\n\t\t\tksft_exit_fail_msg(\"ASSERT(%s:%d) failed (%s): \" msg \"\\n\", \\\n\t\t\t\t\t   __FILE__, __LINE__, #expr, ##__VA_ARGS__); \\\n\t} while (0)\n\nint raw_openat2(int dfd, const char *path, void *how, size_t size);\nint sys_openat2(int dfd, const char *path, struct open_how *how);\nint sys_openat(int dfd, const char *path, struct open_how *how);\nint sys_renameat2(int olddirfd, const char *oldpath,\n\t\t  int newdirfd, const char *newpath, unsigned int flags);\n\nint touchat(int dfd, const char *path);\nchar *fdreadlink(int fd);\nbool fdequal(int fd, int dfd, const char *path);\n\nextern bool openat2_supported;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}