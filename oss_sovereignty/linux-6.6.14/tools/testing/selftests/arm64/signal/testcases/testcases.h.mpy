{
  "module_name": "testcases.h",
  "hash_id": "7d0e03f59967224bad39ee8f22b8b26e205dacecd978e3595f86df2e1807e708",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/arm64/signal/testcases/testcases.h",
  "human_readable_source": " \n \n#ifndef __TESTCASES_H__\n#define __TESTCASES_H__\n\n#include <stddef.h>\n#include <stdio.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ucontext.h>\n#include <signal.h>\n\n \n#include <asm/sigcontext.h>\n\n#define FPSIMD_CTX\t(1 << 0)\n#define SVE_CTX\t\t(1 << 1)\n#define ZA_CTX\t\t(1 << 2)\n#define EXTRA_CTX\t(1 << 3)\n#define ZT_CTX\t\t(1 << 4)\n\n#define KSFT_BAD_MAGIC\t0xdeadbeef\n\n#define HDR_SZ \\\n\tsizeof(struct _aarch64_ctx)\n\n#define GET_SF_RESV_HEAD(sf) \\\n\t(struct _aarch64_ctx *)(&(sf).uc.uc_mcontext.__reserved)\n\n#define GET_SF_RESV_SIZE(sf) \\\n\tsizeof((sf).uc.uc_mcontext.__reserved)\n\n#define GET_BUF_RESV_HEAD(buf) \\\n\t(struct _aarch64_ctx *)(&(buf).uc.uc_mcontext.__reserved)\n\n#define GET_BUF_RESV_SIZE(buf) \\\n\t(sizeof(buf) - sizeof(buf.uc) +\t\\\n\t sizeof((buf).uc.uc_mcontext.__reserved))\n\n#define GET_UCP_RESV_SIZE(ucp) \\\n\tsizeof((ucp)->uc_mcontext.__reserved)\n\n#define ASSERT_BAD_CONTEXT(uc) do {\t\t\t\t\t\\\n\tchar *err = NULL;\t\t\t\t\t\t\\\n\tif (!validate_reserved((uc), GET_UCP_RESV_SIZE((uc)), &err)) {\t\\\n\t\tif (err)\t\t\t\t\t\t\\\n\t\t\tfprintf(stderr,\t\t\t\t\t\\\n\t\t\t\t\"Using badly built context - ERR: %s\\n\",\\\n\t\t\t\terr);\t\t\t\t\t\\\n\t} else {\t\t\t\t\t\t\t\\\n\t\tabort();\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define ASSERT_GOOD_CONTEXT(uc) do {\t\t\t\t\t \\\n\tchar *err = NULL;\t\t\t\t\t\t \\\n\tif (!validate_reserved((uc), GET_UCP_RESV_SIZE((uc)), &err)) {\t \\\n\t\tif (err)\t\t\t\t\t\t \\\n\t\t\tfprintf(stderr,\t\t\t\t\t \\\n\t\t\t\t\"Detected BAD context - ERR: %s\\n\", err);\\\n\t\tabort();\t\t\t\t\t\t \\\n\t} else {\t\t\t\t\t\t\t \\\n\t\tfprintf(stderr, \"uc context validated.\\n\");\t\t \\\n\t}\t\t\t\t\t\t\t\t \\\n} while (0)\n\n \n#define GET_RESV_NEXT_HEAD(h) \\\n\t(struct _aarch64_ctx *)((char *)(h) + (h)->size)\n\nstruct fake_sigframe {\n\tsiginfo_t\tinfo;\n\tucontext_t\tuc;\n};\n\n\nbool validate_reserved(ucontext_t *uc, size_t resv_sz, char **err);\n\nstruct _aarch64_ctx *get_header(struct _aarch64_ctx *head, uint32_t magic,\n\t\t\t\tsize_t resv_sz, size_t *offset);\n\nstatic inline struct _aarch64_ctx *get_terminator(struct _aarch64_ctx *head,\n\t\t\t\t\t\t  size_t resv_sz,\n\t\t\t\t\t\t  size_t *offset)\n{\n\treturn get_header(head, 0, resv_sz, offset);\n}\n\nstatic inline void write_terminator_record(struct _aarch64_ctx *tail)\n{\n\tif (tail) {\n\t\ttail->magic = 0;\n\t\ttail->size = 0;\n\t}\n}\n\nstruct _aarch64_ctx *get_starting_head(struct _aarch64_ctx *shead,\n\t\t\t\t       size_t need_sz, size_t resv_sz,\n\t\t\t\t       size_t *offset);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}