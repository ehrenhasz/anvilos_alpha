{
  "module_name": "fpsimd-test.S",
  "hash_id": "bff38bea88a28c10d0f7ed2f995ba28f25491b8a22a6bd12c190538c5a267e84",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/arm64/fp/fpsimd-test.S",
  "human_readable_source": " \n \n \n \n \n \n \n \n \n \n \n\n#include <asm/unistd.h>\n#include \"assembler.h\"\n#include \"asm-offsets.h\"\n\n#define NVR\t32\n#define MAXVL_B\t(128 / 8)\n\n.macro _vldr Vn:req, Xt:req\n\tld1\t{v\\Vn\\().2d}, [x\\Xt]\n.endm\n\n.macro _vstr Vn:req, Xt:req\n\tst1\t{v\\Vn\\().2d}, [x\\Xt]\n.endm\n\n \n \n \n \n \ndefine_accessor setv, NVR, _vldr\ndefine_accessor getv, NVR, _vstr\n\n \n.pushsection .text\n.data\n.align 4\nvref:\n\t.space\tMAXVL_B * NVR\nscratch:\n\t.space\tMAXVL_B\n.popsection\n\n \n \n \n \nfunction pattern\n\torr\tw1, w0, w1, lsl #16\n\torr\tw2, w1, w2, lsl #28\n\n\tldr\tx0, =scratch\n\tmov\tw1, #MAXVL_B / 4\n\n0:\tstr\tw2, [x0], #4\n\tadd\tw2, w2, #(1 << 22)\n\tsubs\tw1, w1, #1\n\tbne\t0b\n\n\tret\nendfunction\n\n \n.macro _adrv xd, xn, nrtmp\n\tldr\t\\xd, =vref\n\tmov\tx\\nrtmp, #16\n\tmadd\t\\xd, x\\nrtmp, \\xn, \\xd\n.endm\n\n \n \n \n \nfunction setup_vreg\n\tmov\tx4, x30\n\n\tmov\tx6, x1\n\tbl\tpattern\n\t_adrv\tx0, x6, 2\n\tmov\tx5, x0\n\tldr\tx1, =scratch\n\tbl\tmemcpy\n\n\tmov\tx0, x6\n\tmov\tx1, x5\n\tbl\tsetv\n\n\tret\tx4\nendfunction\n\n \n \n \n \nfunction memcmp\n\tcbz\tx2, 1f\n\n\tmov\tx5, #0\n0:\tldrb\tw3, [x0, x5]\n\tldrb\tw4, [x1, x5]\n\tadd\tx5, x5, #1\n\tcmp\tw3, w4\n\tb.ne\tbarf\n\tsubs\tx2, x2, #1\n\tb.ne\t0b\n\n1:\tret\nendfunction\n\n \n \n \nfunction check_vreg\n\tmov\tx3, x30\n\n\t_adrv\tx5, x0, 6\n\tmov\tx4, x0\n\tldr\tx7, =scratch\n\n\tmov\tx0, x7\n\tmov\tx1, x6\n\tbl\tmemfill_ae\n\n\tmov\tx0, x4\n\tmov\tx1, x7\n\tbl\tgetv\n\n\tmov\tx0, x5\n\tmov\tx1, x7\n\tmov\tx2, x6\n\tmov\tx30, x3\n\tb\tmemcmp\nendfunction\n\n \n \nfunction irritator_handler\n\t \n\tldr\tx0, [x2, #ucontext_regs + 8 * 23]\n\tadd\tx0, x0, #1\n\tstr\tx0, [x2, #ucontext_regs + 8 * 23]\n\n\t \n\tadr\tx0, .text + (irritator_handler - .text) / 16 * 16\n\tmovi\tv0.8b, #7\n\tmovi\tv9.16b, #9\n\tmovi\tv31.8b, #31\n\n\tret\nendfunction\n\nfunction tickle_handler\n\t \n\tldr\tx0, [x2, #ucontext_regs + 8 * 23]\n\tadd\tx0, x0, #1\n\tstr\tx0, [x2, #ucontext_regs + 8 * 23]\n\n\tret\nendfunction\n\nfunction terminate_handler\n\tmov\tw21, w0\n\tmov\tx20, x2\n\n\tputs\t\"Terminated by signal \"\n\tmov\tw0, w21\n\tbl\tputdec\n\tputs\t\", no error, iterations=\"\n\tldr\tx0, [x20, #ucontext_regs + 8 * 22]\n\tbl\tputdec\n\tputs\t\", signals=\"\n\tldr\tx0, [x20, #ucontext_regs + 8 * 23]\n\tbl\tputdecn\n\n\tmov\tx0, #0\n\tmov\tx8, #__NR_exit\n\tsvc\t#0\nendfunction\n\n \n \n \n \nfunction setsignal\n\tstr\tx30, [sp, #-((sa_sz + 15) / 16 * 16 + 16)]!\n\n\tmov\tw4, w0\n\tmov\tx5, x1\n\tmov\tw6, w2\n\n\tadd\tx0, sp, #16\n\tmov\tx1, #sa_sz\n\tbl\tmemclr\n\n\tmov\tw0, w4\n\tadd\tx1, sp, #16\n\tstr\tw6, [x1, #sa_flags]\n\tstr\tx5, [x1, #sa_handler]\n\tmov\tx2, #0\n\tmov\tx3, #sa_mask_sz\n\tmov\tx8, #__NR_rt_sigaction\n\tsvc\t#0\n\n\tcbz\tw0, 1f\n\n\tputs\t\"sigaction failure\\n\"\n\tb\t.Labort\n\n1:\tldr\tx30, [sp], #((sa_sz + 15) / 16 * 16 + 16)\n\tret\nendfunction\n\n \n.globl _start\nfunction _start\n\tmov\tx23, #0\t\t \n\n\tmov\tw0, #SIGINT\n\tadr\tx1, terminate_handler\n\tmov\tw2, #SA_SIGINFO\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGTERM\n\tadr\tx1, terminate_handler\n\tmov\tw2, #SA_SIGINFO\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGUSR1\n\tadr\tx1, irritator_handler\n\tmov\tw2, #SA_SIGINFO\n\torr\tw2, w2, #SA_NODEFER\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGUSR2\n\tadr\tx1, tickle_handler\n\tmov\tw2, #SA_SIGINFO\n\torr\tw2, w2, #SA_NODEFER\n\tbl\tsetsignal\n\n\t \n\n\tmov\tx19, #128\n\tcmp\tx19, #128\n\tb.lo\t1f\n\tcmp\tx19, #2048\n\tb.hi\t1f\n\ttst\tx19, #(8 - 1)\n\tb.eq\t2f\n\n1:\tputs\t\"Bad vector length: \"\n\tmov\tx0, x19\n\tbl\tputdecn\n\tb\t.Labort\n\n2:\tputs\t\"Vector length:\\t\"\n\tmov\tx0, x19\n\tbl\tputdec\n\tputs\t\" bits\\n\"\n\n\t \n\n\tmov\tx8, #__NR_getpid\n\tsvc\t#0\n\tmov\tx20, x0\n\n\tputs\t\"PID:\\t\"\n\tmov\tx0, x20\n\tbl\tputdecn\n\n\tmov\tx22, #0\t\t \n.Ltest_loop:\n\n\tmov\tx21, #0\t\t \n0:\tmov\tx0, x20\n\tmov\tx1, x21\n\tand\tx2, x22, #0xf\n\tbl\tsetup_vreg\n\tadd\tx21, x21, #1\n\tcmp\tx21, #NVR\n\tb.lo\t0b\n\n \n\tmov\tx8, #__NR_sched_yield\t \n\tsvc\t#0\n\n\tmov\tx21, #0\n0:\tmov\tx0, x21\n\tbl\tcheck_vreg\n\tadd\tx21, x21, #1\n\tcmp\tx21, #NVR\n\tb.lo\t0b\n\n\tadd\tx22, x22, #1\n\tb\t.Ltest_loop\n\n.Labort:\n\tmov\tx0, #0\n\tmov\tx1, #SIGABRT\n\tmov\tx8, #__NR_kill\n\tsvc\t#0\nendfunction\n\nfunction barf\n\tmov\tx10, x0\t \n\tmov\tx11, x1\t \n\tmov\tx12, x2\t \n\n\tputs\t\"Mismatch: PID=\"\n\tmov\tx0, x20\n\tbl\tputdec\n\tputs\t\", iteration=\"\n\tmov\tx0, x22\n\tbl\tputdec\n\tputs\t\", reg=\"\n\tmov\tx0, x21\n\tbl\tputdecn\n\tputs\t\"\\tExpected [\"\n\tmov\tx0, x10\n\tmov\tx1, x12\n\tbl\tdumphex\n\tputs\t\"]\\n\\tGot      [\"\n\tmov\tx0, x11\n\tmov\tx1, x12\n\tbl\tdumphex\n\tputs\t\"]\\n\"\n\n\tmov\tx8, #__NR_exit\n\tmov\tx1, #1\n\tsvc\t#0\nendfunction\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}