{
  "module_name": "zt-test.S",
  "hash_id": "ff8f1b5d09fc13c69c257b349f6b6b0c1456d22fb8e9b6fc64656133d427afde",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/arm64/fp/zt-test.S",
  "human_readable_source": " \n \n \n \n \n \n \n\n#include <asm/unistd.h>\n#include \"assembler.h\"\n#include \"asm-offsets.h\"\n#include \"sme-inst.h\"\n\n.arch_extension sve\n\n#define ZT_SZ\t512\n#define ZT_B\t(ZT_SZ / 8)\n\n \n \n.pushsection .text\n.data\n.align 4\nztref:\n\t.space\tZT_B\nscratch:\n\t.space\tZT_B\n.popsection\n\n\n \n \n \n\n \n \n \n \n \n\nfunction pattern\n\tmov\tw3, wzr\n\tbfi\tw3, w0, #8, #16\t\t \n\tbfi\tw3, w1, #24, #8\t\t \n\n\tldr\tx0, =scratch\n\tmov\tw1, #ZT_B / 4\n\n0:\tstr\tw3, [x0], #4\n\tadd\tw3, w3, #1\t\t \n\tsubs\tw1, w1, #1\n\tb.ne\t0b\n\n\tret\nendfunction\n\n \n \n \nfunction setup_zt\n\tmov\tx4, x30\n\n\tbl\tpattern\t\t\t \n\tldr\tx0, =ztref\n\tldr\tx1, =scratch\n\tmov\tx2, #ZT_B\n\tbl\tmemcpy\n\n\tldr\tx0, =ztref\n\t_ldr_zt 0\t\t\t \n\n\tret\tx4\nendfunction\n\n \n \n \n \nfunction memcmp\n\tcbz\tx2, 2f\n\n\tstp\tx0, x1, [sp, #-0x20]!\n\tstr\tx2, [sp, #0x10]\n\n\tmov\tx5, #0\n0:\tldrb\tw3, [x0, x5]\n\tldrb\tw4, [x1, x5]\n\tadd\tx5, x5, #1\n\tcmp\tw3, w4\n\tb.ne\t1f\n\tsubs\tx2, x2, #1\n\tb.ne\t0b\n\n1:\tldr\tx2, [sp, #0x10]\n\tldp\tx0, x1, [sp], #0x20\n\tb.ne\tbarf\n\n2:\tret\nendfunction\n\n \n \nfunction check_zt\n\tmov\tx3, x30\n\n\tldr\tx0, =scratch\t\t \n\tmov\tx1, #ZT_B\n\tbl\tmemfill_ae\n\n\tldr\tx0, =scratch\n\t_str_zt 0\n\n\tldr\tx0, =ztref\n\tldr\tx1, =scratch\n\tmov\tx2, #ZT_B\n\tmov\tx30, x3\n\tb\tmemcmp\nendfunction\n\n \n \nfunction irritator_handler\n\t \n\tldr\tx0, [x2, #ucontext_regs + 8 * 23]\n\tadd\tx0, x0, #1\n\tstr\tx0, [x2, #ucontext_regs + 8 * 23]\n\n\t \n#if 0\n\tadr\tx0, .text + (irritator_handler - .text) / 16 * 16\n\tmovi\tv0.8b, #1\n\tmovi\tv9.16b, #2\n\tmovi\tv31.8b, #3\n#endif\n\n\tret\nendfunction\n\nfunction tickle_handler\n\t \n\tldr\tx0, [x2, #ucontext_regs + 8 * 23]\n\tadd\tx0, x0, #1\n\tstr\tx0, [x2, #ucontext_regs + 8 * 23]\n\n\tret\nendfunction\n\nfunction terminate_handler\n\tmov\tw21, w0\n\tmov\tx20, x2\n\n\tputs\t\"Terminated by signal \"\n\tmov\tw0, w21\n\tbl\tputdec\n\tputs\t\", no error, iterations=\"\n\tldr\tx0, [x20, #ucontext_regs + 8 * 22]\n\tbl\tputdec\n\tputs\t\", signals=\"\n\tldr\tx0, [x20, #ucontext_regs + 8 * 23]\n\tbl\tputdecn\n\n\tmov\tx0, #0\n\tmov\tx8, #__NR_exit\n\tsvc\t#0\nendfunction\n\n \n \n \n \nfunction setsignal\n\tstr\tx30, [sp, #-((sa_sz + 15) / 16 * 16 + 16)]!\n\n\tmov\tw4, w0\n\tmov\tx5, x1\n\tmov\tw6, w2\n\n\tadd\tx0, sp, #16\n\tmov\tx1, #sa_sz\n\tbl\tmemclr\n\n\tmov\tw0, w4\n\tadd\tx1, sp, #16\n\tstr\tw6, [x1, #sa_flags]\n\tstr\tx5, [x1, #sa_handler]\n\tmov\tx2, #0\n\tmov\tx3, #sa_mask_sz\n\tmov\tx8, #__NR_rt_sigaction\n\tsvc\t#0\n\n\tcbz\tw0, 1f\n\n\tputs\t\"sigaction failure\\n\"\n\tb\t.Labort\n\n1:\tldr\tx30, [sp], #((sa_sz + 15) / 16 * 16 + 16)\n\tret\nendfunction\n\n \n.globl _start\nfunction _start\n\tmov\tx23, #0\t\t \n\n\tmov\tw0, #SIGINT\n\tadr\tx1, terminate_handler\n\tmov\tw2, #SA_SIGINFO\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGTERM\n\tadr\tx1, terminate_handler\n\tmov\tw2, #SA_SIGINFO\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGUSR1\n\tadr\tx1, irritator_handler\n\tmov\tw2, #SA_SIGINFO\n\torr\tw2, w2, #SA_NODEFER\n\tbl\tsetsignal\n\n\tmov\tw0, #SIGUSR2\n\tadr\tx1, tickle_handler\n\tmov\tw2, #SA_SIGINFO\n\torr\tw2, w2, #SA_NODEFER\n\tbl\tsetsignal\n\n\tsmstart_za\n\n\t \n\tmov\tx8, #__NR_getpid\n\tsvc\t#0\n\tmov\tx20, x0\n\n\tputs\t\"PID:\\t\"\n\tmov\tx0, x20\n\tbl\tputdecn\n\n\tmov\tx22, #0\t\t \n.Ltest_loop:\n\tmov\tx0, x20\n\tmov\tx1, x22\n\tbl\tsetup_zt\n\n\tmov\tx8, #__NR_sched_yield\t \n\tsvc\t#0\n\n\tmrs\tx0, S3_3_C4_C2_2\t \n\tand\tx1, x0, #3\n\tcmp\tx1, #2\n\tb.ne\tsvcr_barf\n\n\tbl\tcheck_zt\n\n\tadd\tx22, x22, #1\t \n\tb\t.Ltest_loop\n\n.Labort:\n\tmov\tx0, #0\n\tmov\tx1, #SIGABRT\n\tmov\tx8, #__NR_kill\n\tsvc\t#0\nendfunction\n\nfunction barf\n \n \n \n \n \n\tsmstop\n\tmov\tx10, x0\t \n\tmov\tx11, x1\t \n\tmov\tx12, x2\t \n\n\tputs\t\"Mismatch: PID=\"\n\tmov\tx0, x20\n\tbl\tputdec\n\tputs\t\", iteration=\"\n\tmov\tx0, x22\n\tbl\tputdec\n\tputs\t\"\\tExpected [\"\n\tmov\tx0, x10\n\tmov\tx1, x12\n\tbl\tdumphex\n\tputs\t\"]\\n\\tGot      [\"\n\tmov\tx0, x11\n\tmov\tx1, x12\n\tbl\tdumphex\n\tputs\t\"]\\n\"\n\n\tmov\tx8, #__NR_getpid\n\tsvc\t#0\n \n \n \n \n \n\tmov\tx1, #SIGABRT\n\tmov\tx8, #__NR_kill\n\tsvc\t#0\n \n \n \nendfunction\n\nfunction svcr_barf\n\tmov\tx10, x0\n\n\tputs\t\"Bad SVCR: \"\n\tmov\tx0, x10\n\tbl\tputdecn\n\n\tmov\tx8, #__NR_exit\n\tmov\tx1, #1\n\tsvc\t#0\nendfunction\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}