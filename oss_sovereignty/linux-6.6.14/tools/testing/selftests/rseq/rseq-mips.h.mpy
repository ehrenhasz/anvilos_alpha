{
  "module_name": "rseq-mips.h",
  "hash_id": "9d7b97f7b3bd719c4899790be1ad1c9cb9b3066213afa12c8b28ef336567bb14",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rseq/rseq-mips.h",
  "human_readable_source": " \n \n\n \n#if defined(__nanomips__)\n# ifdef __MIPSEL__\n#  define RSEQ_SIG\t0x03500010\n# else\n#  define RSEQ_SIG\t0x00100350\n# endif\n#elif defined(__mips_micromips)\n# ifdef __MIPSEL__\n#  define RSEQ_SIG\t0xd4070000\n# else\n#  define RSEQ_SIG\t0x0000d407\n# endif\n#elif defined(__mips__)\n# define RSEQ_SIG\t0x0350000d\n#else\n \n#endif\n\n#define rseq_smp_mb()\t__asm__ __volatile__ (\"sync\" ::: \"memory\")\n#define rseq_smp_rmb()\trseq_smp_mb()\n#define rseq_smp_wmb()\trseq_smp_mb()\n\n#define rseq_smp_load_acquire(p)\t\t\t\t\t\\\n__extension__ ({\t\t\t\t\t\t\t\\\n\trseq_unqual_scalar_typeof(*(p)) ____p1 = RSEQ_READ_ONCE(*(p));\t\\\n\trseq_smp_mb();\t\t\t\t\t\t\t\\\n\t____p1;\t\t\t\t\t\t\t\t\\\n})\n\n#define rseq_smp_acquire__after_ctrl_dep()\trseq_smp_rmb()\n\n#define rseq_smp_store_release(p, v)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\trseq_smp_mb();\t\t\t\t\t\t\t\\\n\tRSEQ_WRITE_ONCE(*(p), v);\t\t\t\t\t\\\n} while (0)\n\n#if _MIPS_SZLONG == 64\n# define LONG\t\t\t\".dword\"\n# define LONG_LA\t\t\"dla\"\n# define LONG_L\t\t\t\"ld\"\n# define LONG_S\t\t\t\"sd\"\n# define LONG_ADDI\t\t\"daddiu\"\n# define U32_U64_PAD(x)\t\tx\n#elif _MIPS_SZLONG == 32\n# define LONG\t\t\t\".word\"\n# define LONG_LA\t\t\"la\"\n# define LONG_L\t\t\t\"lw\"\n# define LONG_S\t\t\t\"sw\"\n# define LONG_ADDI\t\t\"addiu\"\n# ifdef __BIG_ENDIAN\n#  define U32_U64_PAD(x)\t\"0x0, \" x\n# else\n#  define U32_U64_PAD(x)\tx \", 0x0\"\n# endif\n#else\n# error unsupported _MIPS_SZLONG\n#endif\n\n#define __RSEQ_ASM_DEFINE_TABLE(label, version, flags, start_ip, \\\n\t\t\t\tpost_commit_offset, abort_ip) \\\n\t\t\".pushsection __rseq_cs, \\\"aw\\\"\\n\\t\" \\\n\t\t\".balign 32\\n\\t\" \\\n\t\t__rseq_str(label) \":\\n\\t\"\t\t\t\t\t\\\n\t\t\".word \" __rseq_str(version) \", \" __rseq_str(flags) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(start_ip)) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(post_commit_offset)) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(abort_ip)) \"\\n\\t\" \\\n\t\t\".popsection\\n\\t\" \\\n\t\t\".pushsection __rseq_cs_ptr_array, \\\"aw\\\"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(label) \"b\") \"\\n\\t\" \\\n\t\t\".popsection\\n\\t\"\n\n#define RSEQ_ASM_DEFINE_TABLE(label, start_ip, post_commit_ip, abort_ip) \\\n\t__RSEQ_ASM_DEFINE_TABLE(label, 0x0, 0x0, start_ip, \\\n\t\t\t\t(post_commit_ip - start_ip), abort_ip)\n\n \n#define RSEQ_ASM_DEFINE_EXIT_POINT(start_ip, exit_ip) \\\n\t\t\".pushsection __rseq_exit_point_array, \\\"aw\\\"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(start_ip)) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(exit_ip)) \"\\n\\t\" \\\n\t\t\".popsection\\n\\t\"\n\n#define RSEQ_ASM_STORE_RSEQ_CS(label, cs_label, rseq_cs) \\\n\t\tRSEQ_INJECT_ASM(1) \\\n\t\tLONG_LA \" $4, \" __rseq_str(cs_label) \"\\n\\t\" \\\n\t\tLONG_S  \" $4, %[\" __rseq_str(rseq_cs) \"]\\n\\t\" \\\n\t\t__rseq_str(label) \":\\n\\t\"\n\n#define RSEQ_ASM_CMP_CPU_ID(cpu_id, current_cpu_id, label) \\\n\t\tRSEQ_INJECT_ASM(2) \\\n\t\t\"lw  $4, %[\" __rseq_str(current_cpu_id) \"]\\n\\t\" \\\n\t\t\"bne $4, %[\" __rseq_str(cpu_id) \"], \" __rseq_str(label) \"\\n\\t\"\n\n#define __RSEQ_ASM_DEFINE_ABORT(table_label, label, teardown, \\\n\t\t\t\tabort_label, version, flags, \\\n\t\t\t\tstart_ip, post_commit_offset, abort_ip) \\\n\t\t\".balign 32\\n\\t\" \\\n\t\t__rseq_str(table_label) \":\\n\\t\" \\\n\t\t\".word \" __rseq_str(version) \", \" __rseq_str(flags) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(start_ip)) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(post_commit_offset)) \"\\n\\t\" \\\n\t\tLONG \" \" U32_U64_PAD(__rseq_str(abort_ip)) \"\\n\\t\" \\\n\t\t\".word \" __rseq_str(RSEQ_SIG) \"\\n\\t\" \\\n\t\t__rseq_str(label) \":\\n\\t\" \\\n\t\tteardown \\\n\t\t\"b %l[\" __rseq_str(abort_label) \"]\\n\\t\"\n\n#define RSEQ_ASM_DEFINE_ABORT(table_label, label, teardown, abort_label, \\\n\t\t\t      start_ip, post_commit_ip, abort_ip) \\\n\t__RSEQ_ASM_DEFINE_ABORT(table_label, label, teardown, \\\n\t\t\t\tabort_label, 0x0, 0x0, start_ip, \\\n\t\t\t\t(post_commit_ip - start_ip), abort_ip)\n\n#define RSEQ_ASM_DEFINE_CMPFAIL(label, teardown, cmpfail_label) \\\n\t\t__rseq_str(label) \":\\n\\t\" \\\n\t\tteardown \\\n\t\t\"b %l[\" __rseq_str(cmpfail_label) \"]\\n\\t\"\n\n \n\n#define RSEQ_TEMPLATE_CPU_ID\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-mips-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n\n#define RSEQ_TEMPLATE_MO_RELEASE\n#include \"rseq-mips-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELEASE\n#undef RSEQ_TEMPLATE_CPU_ID\n\n \n\n#define RSEQ_TEMPLATE_MM_CID\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-mips-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n\n#define RSEQ_TEMPLATE_MO_RELEASE\n#include \"rseq-mips-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELEASE\n#undef RSEQ_TEMPLATE_MM_CID\n\n \n\n#define RSEQ_TEMPLATE_CPU_ID_NONE\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-mips-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n#undef RSEQ_TEMPLATE_CPU_ID_NONE\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}