{
  "module_name": "run_param_test.sh",
  "hash_id": "a209f3f597105f0c95202fc197b9512f01a0ec97b86879143b67965282c4fb56",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rseq/run_param_test.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0+ or MIT\n\nNR_CPUS=`grep '^processor' /proc/cpuinfo | wc -l`\n\nEXTRA_ARGS=${@}\n\nOLDIFS=\"$IFS\"\nIFS=$'\\n'\nTEST_LIST=(\n\t\"-T s\"\n\t\"-T l\"\n\t\"-T b\"\n\t\"-T b -M\"\n\t\"-T m\"\n\t\"-T m -M\"\n\t\"-T i\"\n\t\"-T r\"\n)\n\nTEST_NAME=(\n\t\"spinlock\"\n\t\"list\"\n\t\"buffer\"\n\t\"buffer with barrier\"\n\t\"memcpy\"\n\t\"memcpy with barrier\"\n\t\"increment\"\n\t\"membarrier\"\n)\nIFS=\"$OLDIFS\"\n\nREPS=1000\nSLOW_REPS=100\nNR_THREADS=$((6*${NR_CPUS}))\n\nfunction do_tests()\n{\n\tlocal i=0\n\twhile [ \"$i\" -lt \"${#TEST_LIST[@]}\" ]; do\n\t\techo \"Running test ${TEST_NAME[$i]}\"\n\t\t./param_test ${TEST_LIST[$i]} -r ${REPS} -t ${NR_THREADS} ${@} ${EXTRA_ARGS} || exit 1\n\t\techo \"Running compare-twice test ${TEST_NAME[$i]}\"\n\t\t./param_test_compare_twice ${TEST_LIST[$i]} -r ${REPS} -t ${NR_THREADS} ${@} ${EXTRA_ARGS} || exit 1\n\n\t\techo \"Running mm_cid test ${TEST_NAME[$i]}\"\n\t\t./param_test_mm_cid ${TEST_LIST[$i]} -r ${REPS} -t ${NR_THREADS} ${@} ${EXTRA_ARGS} || exit 1\n\t\techo \"Running mm_cid compare-twice test ${TEST_NAME[$i]}\"\n\t\t./param_test_mm_cid_compare_twice ${TEST_LIST[$i]} -r ${REPS} -t ${NR_THREADS} ${@} ${EXTRA_ARGS} || exit 1\n\t\tlet \"i++\"\n\tdone\n}\n\necho \"Default parameters\"\ndo_tests\n\necho \"Loop injection: 10000 loops\"\n\nOLDIFS=\"$IFS\"\nIFS=$'\\n'\nINJECT_LIST=(\n\t\"1\"\n\t\"2\"\n\t\"3\"\n\t\"4\"\n\t\"5\"\n\t\"6\"\n\t\"7\"\n\t\"8\"\n\t\"9\"\n)\nIFS=\"$OLDIFS\"\n\nNR_LOOPS=10000\n\ni=0\nwhile [ \"$i\" -lt \"${#INJECT_LIST[@]}\" ]; do\n\techo \"Injecting at <${INJECT_LIST[$i]}>\"\n\tdo_tests -${INJECT_LIST[i]} ${NR_LOOPS}\n\tlet \"i++\"\ndone\nNR_LOOPS=\n\nfunction inject_blocking()\n{\n\tOLDIFS=\"$IFS\"\n\tIFS=$'\\n'\n\tINJECT_LIST=(\n\t\t\"7\"\n\t\t\"8\"\n\t\t\"9\"\n\t)\n\tIFS=\"$OLDIFS\"\n\n\tNR_LOOPS=-1\n\n\ti=0\n\twhile [ \"$i\" -lt \"${#INJECT_LIST[@]}\" ]; do\n\t\techo \"Injecting at <${INJECT_LIST[$i]}>\"\n\t\tdo_tests -${INJECT_LIST[i]} -1 ${@}\n\t\tlet \"i++\"\n\tdone\n\tNR_LOOPS=\n}\n\necho \"Yield injection (25%)\"\ninject_blocking -m 4 -y\n\necho \"Yield injection (50%)\"\ninject_blocking -m 2 -y\n\necho \"Yield injection (100%)\"\ninject_blocking -m 1 -y\n\necho \"Kill injection (25%)\"\ninject_blocking -m 4 -k\n\necho \"Kill injection (50%)\"\ninject_blocking -m 2 -k\n\necho \"Kill injection (100%)\"\ninject_blocking -m 1 -k\n\necho \"Sleep injection (1ms, 25%)\"\ninject_blocking -m 4 -s 1\n\necho \"Sleep injection (1ms, 50%)\"\ninject_blocking -m 2 -s 1\n\necho \"Sleep injection (1ms, 100%)\"\ninject_blocking -m 1 -s 1\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}