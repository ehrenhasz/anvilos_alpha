{
  "module_name": "rseq-arm64.h",
  "hash_id": "340c904ee9a2930c6f735ad54d495357f675c4000487b4b72a1b45f38fd5f50d",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rseq/rseq-arm64.h",
  "human_readable_source": " \n \n\n \n#define RSEQ_SIG_CODE\t0xd428bc00\t \n\n#ifdef __AARCH64EB__\n#define RSEQ_SIG_DATA\t0x00bc28d4\t \n#else\n#define RSEQ_SIG_DATA\tRSEQ_SIG_CODE\n#endif\n\n#define RSEQ_SIG\tRSEQ_SIG_DATA\n\n#define rseq_smp_mb()\t__asm__ __volatile__ (\"dmb ish\" ::: \"memory\")\n#define rseq_smp_rmb()\t__asm__ __volatile__ (\"dmb ishld\" ::: \"memory\")\n#define rseq_smp_wmb()\t__asm__ __volatile__ (\"dmb ishst\" ::: \"memory\")\n\n#define rseq_smp_load_acquire(p)\t\t\t\t\t\t\\\n__extension__ ({\t\t\t\t\t\t\t\t\\\n\tunion { rseq_unqual_scalar_typeof(*(p)) __val; char __c[sizeof(*(p))]; } __u; \\\n\tswitch (sizeof(*(p))) {\t\t\t\t\t\t\t\\\n\tcase 1:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"ldarb %w0, %1\"\t\t\t\t\\\n\t\t\t: \"=r\" (*(__u8 *)__u.__c)\t\t\t\t\\\n\t\t\t: \"Q\" (*(p)) : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 2:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"ldarh %w0, %1\"\t\t\t\t\\\n\t\t\t: \"=r\" (*(__u16 *)__u.__c)\t\t\t\t\\\n\t\t\t: \"Q\" (*(p)) : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 4:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"ldar %w0, %1\"\t\t\t\t\\\n\t\t\t: \"=r\" (*(__u32 *)__u.__c)\t\t\t\t\\\n\t\t\t: \"Q\" (*(p)) : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 8:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"ldar %0, %1\"\t\t\t\t\\\n\t\t\t: \"=r\" (*(__u64 *)__u.__c)\t\t\t\t\\\n\t\t\t: \"Q\" (*(p)) : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\t(rseq_unqual_scalar_typeof(*(p)))__u.__val;\t\t\t\t\\\n})\n\n#define rseq_smp_acquire__after_ctrl_dep()\trseq_smp_rmb()\n\n#define rseq_smp_store_release(p, v)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\t\\\n\tunion { rseq_unqual_scalar_typeof(*(p)) __val; char __c[sizeof(*(p))]; } __u = \\\n\t\t{ .__val = (rseq_unqual_scalar_typeof(*(p))) (v) };\t\t\\\n\tswitch (sizeof(*(p))) {\t\t\t\t\t\t\t\\\n\tcase 1:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"stlrb %w1, %0\"\t\t\t\t\\\n\t\t\t\t: \"=Q\" (*(p))\t\t\t\t\t\\\n\t\t\t\t: \"r\" (*(__u8 *)__u.__c)\t\t\t\\\n\t\t\t\t: \"memory\");\t\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 2:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"stlrh %w1, %0\"\t\t\t\t\\\n\t\t\t\t: \"=Q\" (*(p))\t\t\t\t\t\\\n\t\t\t\t: \"r\" (*(__u16 *)__u.__c)\t\t\t\\\n\t\t\t\t: \"memory\");\t\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 4:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"stlr %w1, %0\"\t\t\t\t\\\n\t\t\t\t: \"=Q\" (*(p))\t\t\t\t\t\\\n\t\t\t\t: \"r\" (*(__u32 *)__u.__c)\t\t\t\\\n\t\t\t\t: \"memory\");\t\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\tcase 8:\t\t\t\t\t\t\t\t\t\\\n\t\t__asm__ __volatile__ (\"stlr %1, %0\"\t\t\t\t\\\n\t\t\t\t: \"=Q\" (*(p))\t\t\t\t\t\\\n\t\t\t\t: \"r\" (*(__u64 *)__u.__c)\t\t\t\\\n\t\t\t\t: \"memory\");\t\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define RSEQ_ASM_TMP_REG32\t\"w15\"\n#define RSEQ_ASM_TMP_REG\t\"x15\"\n#define RSEQ_ASM_TMP_REG_2\t\"x14\"\n\n#define __RSEQ_ASM_DEFINE_TABLE(label, version, flags, start_ip,\t\t\\\n\t\t\t\tpost_commit_offset, abort_ip)\t\t\t\\\n\t\"\t.pushsection\t__rseq_cs, \\\"aw\\\"\\n\"\t\t\t\t\\\n\t\"\t.balign\t32\\n\"\t\t\t\t\t\t\t\\\n\t__rseq_str(label) \":\\n\"\t\t\t\t\t\t\t\\\n\t\"\t.long\t\" __rseq_str(version) \", \" __rseq_str(flags) \"\\n\"\t\\\n\t\"\t.quad\t\" __rseq_str(start_ip) \", \"\t\t\t\t\\\n\t\t\t  __rseq_str(post_commit_offset) \", \"\t\t\t\\\n\t\t\t  __rseq_str(abort_ip) \"\\n\"\t\t\t\t\\\n\t\"\t.popsection\\n\\t\"\t\t\t\t\t\t\\\n\t\"\t.pushsection __rseq_cs_ptr_array, \\\"aw\\\"\\n\"\t\t\t\t\\\n\t\"\t.quad \" __rseq_str(label) \"b\\n\"\t\t\t\t\t\\\n\t\"\t.popsection\\n\"\n\n#define RSEQ_ASM_DEFINE_TABLE(label, start_ip, post_commit_ip, abort_ip)\t\\\n\t__RSEQ_ASM_DEFINE_TABLE(label, 0x0, 0x0, start_ip,\t\t\t\\\n\t\t\t\t(post_commit_ip - start_ip), abort_ip)\n\n \n#define RSEQ_ASM_DEFINE_EXIT_POINT(start_ip, exit_ip)\t\t\t\t\\\n\t\"\t.pushsection __rseq_exit_point_array, \\\"aw\\\"\\n\"\t\t\t\\\n\t\"\t.quad \" __rseq_str(start_ip) \", \" __rseq_str(exit_ip) \"\\n\"\t\\\n\t\"\t.popsection\\n\"\n\n#define RSEQ_ASM_STORE_RSEQ_CS(label, cs_label, rseq_cs)\t\t\t\\\n\tRSEQ_INJECT_ASM(1)\t\t\t\t\t\t\t\\\n\t\"\tadrp\t\" RSEQ_ASM_TMP_REG \", \" __rseq_str(cs_label) \"\\n\"\t\\\n\t\"\tadd\t\" RSEQ_ASM_TMP_REG \", \" RSEQ_ASM_TMP_REG\t\t\\\n\t\t\t\", :lo12:\" __rseq_str(cs_label) \"\\n\"\t\t\t\\\n\t\"\tstr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(rseq_cs) \"]\\n\"\t\\\n\t__rseq_str(label) \":\\n\"\n\n#define RSEQ_ASM_DEFINE_ABORT(label, abort_label)\t\t\t\t\\\n\t\"\tb\t222f\\n\"\t\t\t\t\t\t\t\\\n\t\"\t.inst \t\"\t__rseq_str(RSEQ_SIG_CODE) \"\\n\"\t\t\t\\\n\t__rseq_str(label) \":\\n\"\t\t\t\t\t\t\t\\\n\t\"\tb\t%l[\" __rseq_str(abort_label) \"]\\n\"\t\t\t\\\n\t\"222:\\n\"\n\n#define RSEQ_ASM_OP_STORE(value, var)\t\t\t\t\t\t\\\n\t\"\tstr\t%[\" __rseq_str(value) \"], %[\" __rseq_str(var) \"]\\n\"\n\n#define RSEQ_ASM_OP_STORE_RELEASE(value, var)\t\t\t\t\t\\\n\t\"\tstlr\t%[\" __rseq_str(value) \"], %[\" __rseq_str(var) \"]\\n\"\n\n#define RSEQ_ASM_OP_FINAL_STORE(value, var, post_commit_label)\t\t\t\\\n\tRSEQ_ASM_OP_STORE(value, var)\t\t\t\t\t\t\\\n\t__rseq_str(post_commit_label) \":\\n\"\n\n#define RSEQ_ASM_OP_FINAL_STORE_RELEASE(value, var, post_commit_label)\t\t\\\n\tRSEQ_ASM_OP_STORE_RELEASE(value, var)\t\t\t\t\t\\\n\t__rseq_str(post_commit_label) \":\\n\"\n\n#define RSEQ_ASM_OP_CMPEQ(var, expect, label)\t\t\t\t\t\\\n\t\"\tldr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(var) \"]\\n\"\t\t\\\n\t\"\tsub\t\" RSEQ_ASM_TMP_REG \", \" RSEQ_ASM_TMP_REG\t\t\\\n\t\t\t\", %[\" __rseq_str(expect) \"]\\n\"\t\t\t\t\\\n\t\"\tcbnz\t\" RSEQ_ASM_TMP_REG \", \" __rseq_str(label) \"\\n\"\n\n#define RSEQ_ASM_OP_CMPEQ32(var, expect, label)\t\t\t\t\t\\\n\t\"\tldr\t\" RSEQ_ASM_TMP_REG32 \", %[\" __rseq_str(var) \"]\\n\"\t\\\n\t\"\tsub\t\" RSEQ_ASM_TMP_REG32 \", \" RSEQ_ASM_TMP_REG32\t\t\\\n\t\t\t\", %w[\" __rseq_str(expect) \"]\\n\"\t\t\t\\\n\t\"\tcbnz\t\" RSEQ_ASM_TMP_REG32 \", \" __rseq_str(label) \"\\n\"\n\n#define RSEQ_ASM_OP_CMPNE(var, expect, label)\t\t\t\t\t\\\n\t\"\tldr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(var) \"]\\n\"\t\t\\\n\t\"\tsub\t\" RSEQ_ASM_TMP_REG \", \" RSEQ_ASM_TMP_REG\t\t\\\n\t\t\t\", %[\" __rseq_str(expect) \"]\\n\"\t\t\t\t\\\n\t\"\tcbz\t\" RSEQ_ASM_TMP_REG \", \" __rseq_str(label) \"\\n\"\n\n#define RSEQ_ASM_CMP_CPU_ID(cpu_id, current_cpu_id, label)\t\t\t\\\n\tRSEQ_INJECT_ASM(2)\t\t\t\t\t\t\t\\\n\tRSEQ_ASM_OP_CMPEQ32(current_cpu_id, cpu_id, label)\n\n#define RSEQ_ASM_OP_R_LOAD(var)\t\t\t\t\t\t\t\\\n\t\"\tldr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(var) \"]\\n\"\n\n#define RSEQ_ASM_OP_R_STORE(var)\t\t\t\t\t\t\\\n\t\"\tstr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(var) \"]\\n\"\n\n#define RSEQ_ASM_OP_R_LOAD_OFF(offset)\t\t\t\t\t\t\\\n\t\"\tldr\t\" RSEQ_ASM_TMP_REG \", [\" RSEQ_ASM_TMP_REG\t\t\\\n\t\t\t\", %[\" __rseq_str(offset) \"]]\\n\"\n\n#define RSEQ_ASM_OP_R_ADD(count)\t\t\t\t\t\t\\\n\t\"\tadd\t\" RSEQ_ASM_TMP_REG \", \" RSEQ_ASM_TMP_REG\t\t\\\n\t\t\t\", %[\" __rseq_str(count) \"]\\n\"\n\n#define RSEQ_ASM_OP_R_FINAL_STORE(var, post_commit_label)\t\t\t\\\n\t\"\tstr\t\" RSEQ_ASM_TMP_REG \", %[\" __rseq_str(var) \"]\\n\"\t\t\\\n\t__rseq_str(post_commit_label) \":\\n\"\n\n#define RSEQ_ASM_OP_R_BAD_MEMCPY(dst, src, len)\t\t\t\t\t\\\n\t\"\tcbz\t%[\" __rseq_str(len) \"], 333f\\n\"\t\t\t\t\\\n\t\"\tmov\t\" RSEQ_ASM_TMP_REG_2 \", %[\" __rseq_str(len) \"]\\n\"\t\\\n\t\"222:\tsub\t\" RSEQ_ASM_TMP_REG_2 \", \" RSEQ_ASM_TMP_REG_2 \", #1\\n\"\t\\\n\t\"\tldrb\t\" RSEQ_ASM_TMP_REG32 \", [%[\" __rseq_str(src) \"]\"\t\\\n\t\t\t\", \" RSEQ_ASM_TMP_REG_2 \"]\\n\"\t\t\t\t\\\n\t\"\tstrb\t\" RSEQ_ASM_TMP_REG32 \", [%[\" __rseq_str(dst) \"]\"\t\\\n\t\t\t\", \" RSEQ_ASM_TMP_REG_2 \"]\\n\"\t\t\t\t\\\n\t\"\tcbnz\t\" RSEQ_ASM_TMP_REG_2 \", 222b\\n\"\t\t\t\t\\\n\t\"333:\\n\"\n\n \n\n#define RSEQ_TEMPLATE_CPU_ID\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-arm64-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n\n#define RSEQ_TEMPLATE_MO_RELEASE\n#include \"rseq-arm64-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELEASE\n#undef RSEQ_TEMPLATE_CPU_ID\n\n \n\n#define RSEQ_TEMPLATE_MM_CID\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-arm64-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n\n#define RSEQ_TEMPLATE_MO_RELEASE\n#include \"rseq-arm64-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELEASE\n#undef RSEQ_TEMPLATE_MM_CID\n\n \n\n#define RSEQ_TEMPLATE_CPU_ID_NONE\n#define RSEQ_TEMPLATE_MO_RELAXED\n#include \"rseq-arm64-bits.h\"\n#undef RSEQ_TEMPLATE_MO_RELAXED\n#undef RSEQ_TEMPLATE_CPU_ID_NONE\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}