{
  "module_name": "proc-self-map-files-002.c",
  "hash_id": "922711e6078591dcc70fb393d542a4c7dd6a11e795684418c5b90b811a83be3a",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/proc/proc-self-map-files-002.c",
  "human_readable_source": " \n \n#include <errno.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <unistd.h>\n#include <sys/mman.h>\n#include <stdlib.h>\n\nstatic void pass(const char *fmt, unsigned long a, unsigned long b)\n{\n\tchar name[64];\n\tchar buf[64];\n\n\tsnprintf(name, sizeof(name), fmt, a, b);\n\tif (readlink(name, buf, sizeof(buf)) == -1)\n\t\texit(1);\n}\n\nstatic void fail(const char *fmt, unsigned long a, unsigned long b)\n{\n\tchar name[64];\n\tchar buf[64];\n\n\tsnprintf(name, sizeof(name), fmt, a, b);\n\tif (readlink(name, buf, sizeof(buf)) == -1 && errno == ENOENT)\n\t\treturn;\n\texit(1);\n}\n\nint main(void)\n{\n\tconst int PAGE_SIZE = sysconf(_SC_PAGESIZE);\n\t \n\tconst unsigned long va_max = 1UL << 20;\n\tunsigned long va;\n\tvoid *p;\n\tint fd;\n\tunsigned long a, b;\n\n\tfd = open(\"/dev/zero\", O_RDONLY);\n\tif (fd == -1)\n\t\treturn 1;\n\n\tfor (va = 0; va < va_max; va += PAGE_SIZE) {\n\t\tp = mmap((void *)va, PAGE_SIZE, PROT_NONE, MAP_PRIVATE|MAP_FILE|MAP_FIXED, fd, 0);\n\t\tif (p == (void *)va)\n\t\t\tbreak;\n\t}\n\tif (va == va_max) {\n\t\tfprintf(stderr, \"error: mmap doesn't like you\\n\");\n\t\treturn 1;\n\t}\n\n\ta = (unsigned long)p;\n\tb = (unsigned long)p + PAGE_SIZE;\n\n\tpass(\"/proc/self/map_files/%lx-%lx\", a, b);\n\tfail(\"/proc/self/map_files/ %lx-%lx\", a, b);\n\tfail(\"/proc/self/map_files/%lx -%lx\", a, b);\n\tfail(\"/proc/self/map_files/%lx- %lx\", a, b);\n\tfail(\"/proc/self/map_files/%lx-%lx \", a, b);\n\tfail(\"/proc/self/map_files/0%lx-%lx\", a, b);\n\tfail(\"/proc/self/map_files/%lx-0%lx\", a, b);\n\tif (sizeof(long) == 4) {\n\t\tfail(\"/proc/self/map_files/100000000%lx-%lx\", a, b);\n\t\tfail(\"/proc/self/map_files/%lx-100000000%lx\", a, b);\n\t} else if (sizeof(long) == 8) {\n\t\tfail(\"/proc/self/map_files/10000000000000000%lx-%lx\", a, b);\n\t\tfail(\"/proc/self/map_files/%lx-10000000000000000%lx\", a, b);\n\t} else\n\t\treturn 1;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}