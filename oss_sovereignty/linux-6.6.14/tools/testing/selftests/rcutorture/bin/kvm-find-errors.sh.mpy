{
  "module_name": "kvm-find-errors.sh",
  "hash_id": "488e8100b9f43047b6db95910da98ee1e841bd268995e1a7576f8af8f07b81a2",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rcutorture/bin/kvm-find-errors.sh",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0+\n#\n# Invoke a text editor on all console.log files for all runs with diagnostics,\n# that is, on all such files having a console.log.diags counterpart.\n# Note that both console.log.diags and console.log are passed to the\n# editor (currently defaulting to \"vi\"), allowing the user to get an\n# idea of what to search for in the console.log file.\n#\n# Usage: kvm-find-errors.sh directory\n#\n# The \"directory\" above should end with the date/time directory, for example,\n# \"tools/testing/selftests/rcutorture/res/2018.02.25-14:27:27\".\n# Returns error status reflecting the success (or not) of the specified run.\n#\n# Copyright (C) IBM Corporation, 2018\n#\n# Author: Paul E. McKenney <paulmck@linux.ibm.com>\n\nrundir=\"${1}\"\nif test -z \"$rundir\" -o ! -d \"$rundir\"\nthen\n\techo Directory \"$rundir\" not found.\n\techo Usage: $0 directory\n\texit 1\nfi\neditor=${EDITOR-vi}\n\n# Find builds with errors\nfiles=\nfor i in ${rundir}/*/Make.out\ndo\n\tscenariodir=\"`dirname $i`\"\n\tscenariobasedir=\"`echo ${scenariodir} | sed -e 's/\\.[0-9]*$//'`\"\n\tif grep -E -q \"error:|warning:|^ld: .*undefined reference to\" < $i\n\tthen\n\t\tgrep -E \"error:|warning:|^ld: .*undefined reference to\" < $i > $i.diags\n\t\tfiles=\"$files $i.diags $i\"\n\telif ! test -f ${scenariobasedir}/vmlinux && ! test -f ${scenariobasedir}/vmlinux.xz && ! test -f \"${rundir}/re-run\"\n\tthen\n\t\techo No ${scenariobasedir}/vmlinux file > $i.diags\n\t\tfiles=\"$files $i.diags $i\"\n\tfi\ndone\nif test -n \"$files\"\nthen\n\t$editor $files\n\teditorret=1\nelse\n\techo No build errors.\nfi\nif grep -q -e \"--build-\\?only\" < ${rundir}/log && ! test -f \"${rundir}/remote-log\"\nthen\n\techo Build-only run, no console logs to check.\n\texit $editorret\nfi\n\n# Find console logs with errors\nfiles=\nfor i in ${rundir}/*/console.log\ndo\n\tif test -r $i.diags\n\tthen\n\t\tfiles=\"$files $i.diags $i\"\n\tfi\ndone\nif test -n \"$files\"\nthen\n\t$editor $files\n\texit 1\nelse\n\techo No errors in console logs.\n\tif test -n \"$editorret\"\n\tthen\n\t\texit $editorret\n\telse\n\t\texit 0\n\tfi\nfi\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}