{
  "module_name": "kvm-recheck-rcu.sh",
  "hash_id": "2c94a3b0f104d6f28bceeb7ab64be37359242c901e2958220d304c9f8d55ff78",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rcutorture/bin/kvm-recheck-rcu.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0+\n#\n# Analyze a given results directory for rcutorture progress.\n#\n# Usage: kvm-recheck-rcu.sh resdir\n#\n# Copyright (C) IBM Corporation, 2014\n#\n# Authors: Paul E. McKenney <paulmck@linux.ibm.com>\n\ni=\"$1\"\nif test -d \"$i\" -a -r \"$i\"\nthen\n\t:\nelse\n\techo Unreadable results directory: $i\n\texit 1\nfi\n. functions.sh\n\nconfigfile=`echo $i | sed -e 's/^.*\\///'`\nngps=`grep ver: $i/console.log 2> /dev/null | tail -1 | sed -e 's/^.* ver: //' -e 's/ .*$//'`\nstopstate=\"`grep 'End-test grace-period state: g' $i/console.log 2> /dev/null |\n\t    tail -1 | sed -e 's/^\\[[ 0-9.]*] //' |\n\t    awk '{ print \\\"[\\\" $1 \\\" \\\" $5 \\\" \\\" $6 \\\" \\\" $7 \\\"]\\\"; }' |\n\t    tr -d '\\012\\015'`\"\nfwdprog=\"`grep 'rcu_torture_fwd_prog n_max_cbs: ' $i/console.log 2> /dev/null | sed -e 's/^\\[[^]]*] //' | sort -k3nr | head -1 | awk '{ print $2 \" \" $3 }' | tr -d '\\015'`\"\nif test -z \"$ngps\"\nthen\n\techo \"$configfile ------- \" $stopstate\nelse\n\ttitle=\"$configfile ------- $ngps GPs\"\n\tdur=`grep -v '^#' $i/qemu-cmd | sed -e 's/^.* rcutorture.shutdown_secs=//' -e 's/ .*$//'`\n\tif test -z \"$dur\"\n\tthen\n\t\t:\n\telse\n\t\tngpsps=`awk -v ngps=$ngps -v dur=$dur '\n\t\t\tBEGIN { print ngps / dur }' < /dev/null`\n\t\ttitle=\"$title ($ngpsps/s)\"\n\tfi\n\techo $title $stopstate $fwdprog\n\tnclosecalls=`grep --binary-files=text 'torture: Reader Batch' $i/console.log | tail -1 | \\\n\t\tawk -v sum=0 '\n\t\t{\n\t\t\tfor (i = 0; i <= NF; i++) {\n\t\t\t\tsum += $i;\n\t\t\t\tif ($i ~ /Batch:/) {\n\t\t\t\t\tsum = 0;\n\t\t\t\t\ti = i + 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tEND {\n\t\t\tprint sum\n\t\t}'`\n\tif test -z \"$nclosecalls\"\n\tthen\n\t\texit 0\n\tfi\n\tif test \"$nclosecalls\" -eq 0\n\tthen\n\t\texit 0\n\tfi\n\t# Compute number of close calls per tenth of an hour\n\tnclosecalls10=`awk -v nclosecalls=$nclosecalls -v dur=$dur 'BEGIN { print int(nclosecalls * 36000 / dur) }' < /dev/null`\n\tif test $nclosecalls10 -gt 5 -a $nclosecalls -gt 1\n\tthen\n\t\tprint_bug $nclosecalls \"Reader Batch close calls in\" $(($dur/60)) minute run: $i\n\telse\n\t\tprint_warning $nclosecalls \"Reader Batch close calls in\" $(($dur/60)) minute run: $i\n\tfi\n\techo $nclosecalls \"Reader Batch close calls in\" $(($dur/60)) minute run: $i > $i/console.log.rcu.diags\nfi\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}