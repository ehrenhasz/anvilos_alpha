{
  "module_name": "srcu_lockdep.sh",
  "hash_id": "6c7f1c2653092544c60ff3d143d045e7105bebee270702f33f836768553afec1",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/rcutorture/bin/srcu_lockdep.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0+\n#\n# Run SRCU-lockdep tests and report any that fail to meet expectations.\n#\n# Copyright (C) 2021 Meta Platforms, Inc.\n#\n# Authors: Paul E. McKenney <paulmck@kernel.org>\n\nusage () {\n\techo \"Usage: $scriptname optional arguments:\"\n\techo \"       --datestamp string\"\n\texit 1\n}\n\nds=`date +%Y.%m.%d-%H.%M.%S`-srcu_lockdep\nscriptname=\"$0\"\n\nT=\"`mktemp -d ${TMPDIR-/tmp}/srcu_lockdep.sh.XXXXXX`\"\ntrap 'rm -rf $T' 0\n\nRCUTORTURE=\"`pwd`/tools/testing/selftests/rcutorture\"; export RCUTORTURE\nPATH=${RCUTORTURE}/bin:$PATH; export PATH\n. functions.sh\n\nwhile test $# -gt 0\ndo\n\tcase \"$1\" in\n\t--datestamp)\n\t\tcheckarg --datestamp \"(relative pathname)\" \"$#\" \"$2\" '^[a-zA-Z0-9._/-]*$' '^--'\n\t\tds=$2\n\t\tshift\n\t\t;;\n\t*)\n\t\techo Unknown argument $1\n\t\tusage\n\t\t;;\n\tesac\n\tshift\ndone\n\nerr=\nnerrs=0\nfor d in 0 1\ndo\n\tfor t in 0 1 2\n\tdo\n\t\tfor c in 1 2 3\n\t\tdo\n\t\t\terr=\n\t\t\tval=$((d*1000+t*10+c))\n\t\t\ttools/testing/selftests/rcutorture/bin/kvm.sh --allcpus --duration 5s --configs \"SRCU-P\" --bootargs \"rcutorture.test_srcu_lockdep=$val\" --trust-make --datestamp \"$ds/$val\" > \"$T/kvm.sh.out\" 2>&1\n\t\t\tret=$?\n\t\t\tmv \"$T/kvm.sh.out\" \"$RCUTORTURE/res/$ds/$val\"\n\t\t\tif test \"$d\" -ne 0 && test \"$ret\" -eq 0\n\t\t\tthen\n\t\t\t\terr=1\n\t\t\t\techo -n Unexpected success for > \"$RCUTORTURE/res/$ds/$val/kvm.sh.err\"\n\t\t\tfi\n\t\t\tif test \"$d\" -eq 0 && test \"$ret\" -ne 0\n\t\t\tthen\n\t\t\t\terr=1\n\t\t\t\techo -n Unexpected failure for > \"$RCUTORTURE/res/$ds/$val/kvm.sh.err\"\n\t\t\tfi\n\t\t\tif test -n \"$err\"\n\t\t\tthen\n\t\t\t\tgrep \"rcu_torture_init_srcu_lockdep: test_srcu_lockdep = \" \"$RCUTORTURE/res/$ds/$val/SRCU-P/console.log\" | sed -e 's/^.*rcu_torture_init_srcu_lockdep://' >> \"$RCUTORTURE/res/$ds/$val/kvm.sh.err\"\n\t\t\t\tcat \"$RCUTORTURE/res/$ds/$val/kvm.sh.err\"\n\t\t\t\tnerrs=$((nerrs+1))\n\t\t\tfi\n\t\tdone\n\tdone\ndone\nif test \"$nerrs\" -ne 0\nthen\n\texit 1\nfi\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}