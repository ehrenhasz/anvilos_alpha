{
  "module_name": "test-shadow-vars.sh",
  "hash_id": "b1e5bb6b51a5be84f0a5e5b3154fb5562e2161d75066cf25988a22a00f050d60",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/livepatch/test-shadow-vars.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n# Copyright (C) 2018 Joe Lawrence <joe.lawrence@redhat.com>\n\n. $(dirname $0)/functions.sh\n\nMOD_TEST=test_klp_shadow_vars\n\nsetup_config\n\n\n# - load a module that exercises the shadow variable API\n\nstart_test \"basic shadow variable API\"\n\nload_mod $MOD_TEST\nunload_mod $MOD_TEST\n\ncheck_result \"% modprobe $MOD_TEST\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1234) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: shadow_ctor: PTR3 -> PTR2\n$MOD_TEST: klp_shadow_get_or_alloc(obj=PTR1, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR2 = PTR3\n$MOD_TEST: shadow_ctor: PTR6 -> PTR5\n$MOD_TEST: klp_shadow_alloc(obj=PTR1, id=0x1235, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR5 = PTR6\n$MOD_TEST: shadow_ctor: PTR8 -> PTR7\n$MOD_TEST: klp_shadow_alloc(obj=PTR9, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR7 = PTR8\n$MOD_TEST: shadow_ctor: PTR11 -> PTR10\n$MOD_TEST: klp_shadow_alloc(obj=PTR9, id=0x1235, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR10 = PTR11\n$MOD_TEST: shadow_ctor: PTR13 -> PTR12\n$MOD_TEST: klp_shadow_get_or_alloc(obj=PTR14, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR12 = PTR13\n$MOD_TEST: shadow_ctor: PTR16 -> PTR15\n$MOD_TEST: klp_shadow_alloc(obj=PTR14, id=0x1235, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR15 = PTR16\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1234) = PTR3\n$MOD_TEST:   got expected PTR3 -> PTR2 result\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1235) = PTR6\n$MOD_TEST:   got expected PTR6 -> PTR5 result\n$MOD_TEST: klp_shadow_get(obj=PTR9, id=0x1234) = PTR8\n$MOD_TEST:   got expected PTR8 -> PTR7 result\n$MOD_TEST: klp_shadow_get(obj=PTR9, id=0x1235) = PTR11\n$MOD_TEST:   got expected PTR11 -> PTR10 result\n$MOD_TEST: klp_shadow_get(obj=PTR14, id=0x1234) = PTR13\n$MOD_TEST:   got expected PTR13 -> PTR12 result\n$MOD_TEST: klp_shadow_get(obj=PTR14, id=0x1235) = PTR16\n$MOD_TEST:   got expected PTR16 -> PTR15 result\n$MOD_TEST: klp_shadow_get_or_alloc(obj=PTR1, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR2 = PTR3\n$MOD_TEST:   got expected PTR3 -> PTR2 result\n$MOD_TEST: klp_shadow_get_or_alloc(obj=PTR9, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR7 = PTR8\n$MOD_TEST:   got expected PTR8 -> PTR7 result\n$MOD_TEST: klp_shadow_get_or_alloc(obj=PTR14, id=0x1234, size=8, gfp_flags=GFP_KERNEL), ctor=PTR4, ctor_data=PTR12 = PTR13\n$MOD_TEST:   got expected PTR13 -> PTR12 result\n$MOD_TEST: shadow_dtor(obj=PTR1, shadow_data=PTR3)\n$MOD_TEST: klp_shadow_free(obj=PTR1, id=0x1234, dtor=PTR17)\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1234) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: shadow_dtor(obj=PTR9, shadow_data=PTR8)\n$MOD_TEST: klp_shadow_free(obj=PTR9, id=0x1234, dtor=PTR17)\n$MOD_TEST: klp_shadow_get(obj=PTR9, id=0x1234) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: shadow_dtor(obj=PTR14, shadow_data=PTR13)\n$MOD_TEST: klp_shadow_free(obj=PTR14, id=0x1234, dtor=PTR17)\n$MOD_TEST: klp_shadow_get(obj=PTR14, id=0x1234) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1235) = PTR6\n$MOD_TEST:   got expected PTR6 -> PTR5 result\n$MOD_TEST: klp_shadow_get(obj=PTR9, id=0x1235) = PTR11\n$MOD_TEST:   got expected PTR11 -> PTR10 result\n$MOD_TEST: klp_shadow_get(obj=PTR14, id=0x1235) = PTR16\n$MOD_TEST:   got expected PTR16 -> PTR15 result\n$MOD_TEST: klp_shadow_free_all(id=0x1235, dtor=PTR0)\n$MOD_TEST: klp_shadow_get(obj=PTR1, id=0x1235) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: klp_shadow_get(obj=PTR9, id=0x1235) = PTR0\n$MOD_TEST:   got expected NULL result\n$MOD_TEST: klp_shadow_get(obj=PTR14, id=0x1235) = PTR0\n$MOD_TEST:   got expected NULL result\n% rmmod $MOD_TEST\"\n\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}