{
  "module_name": "vdso_test_clock_getres.c",
  "hash_id": "4d40b262a32aef0a5930e26e95a2d8c55298c46f805cde428d4420b55b8d5696",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/vDSO/vdso_test_clock_getres.c",
  "human_readable_source": "\n \n\n#define _GNU_SOURCE\n#include <elf.h>\n#include <err.h>\n#include <fcntl.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <time.h>\n#include <sys/auxv.h>\n#include <sys/mman.h>\n#include <sys/time.h>\n#include <unistd.h>\n#include <sys/syscall.h>\n\n#include \"../kselftest.h\"\n\nstatic long syscall_clock_getres(clockid_t _clkid, struct timespec *_ts)\n{\n\tlong ret;\n\n\tret = syscall(SYS_clock_getres, _clkid, _ts);\n\n\treturn ret;\n}\n\nconst char *vdso_clock_name[12] = {\n\t\"CLOCK_REALTIME\",\n\t\"CLOCK_MONOTONIC\",\n\t\"CLOCK_PROCESS_CPUTIME_ID\",\n\t\"CLOCK_THREAD_CPUTIME_ID\",\n\t\"CLOCK_MONOTONIC_RAW\",\n\t\"CLOCK_REALTIME_COARSE\",\n\t\"CLOCK_MONOTONIC_COARSE\",\n\t\"CLOCK_BOOTTIME\",\n\t\"CLOCK_REALTIME_ALARM\",\n\t\"CLOCK_BOOTTIME_ALARM\",\n\t\"CLOCK_SGI_CYCLE\",\n\t\"CLOCK_TAI\",\n};\n\n \nstatic inline int vdso_test_clock(unsigned int clock_id)\n{\n\tstruct timespec x, y;\n\n\tprintf(\"clock_id: %s\", vdso_clock_name[clock_id]);\n\tclock_getres(clock_id, &x);\n\tsyscall_clock_getres(clock_id, &y);\n\n\tif ((x.tv_sec != y.tv_sec) || (x.tv_nsec != y.tv_nsec)) {\n\t\tprintf(\" [FAIL]\\n\");\n\t\treturn KSFT_FAIL;\n\t}\n\n\tprintf(\" [PASS]\\n\");\n\treturn KSFT_PASS;\n}\n\nint main(int argc, char **argv)\n{\n\tint ret = 0;\n\n#if _POSIX_TIMERS > 0\n\n#ifdef CLOCK_REALTIME\n\tret += vdso_test_clock(CLOCK_REALTIME);\n#endif\n\n#ifdef CLOCK_BOOTTIME\n\tret += vdso_test_clock(CLOCK_BOOTTIME);\n#endif\n\n#ifdef CLOCK_TAI\n\tret += vdso_test_clock(CLOCK_TAI);\n#endif\n\n#ifdef CLOCK_REALTIME_COARSE\n\tret += vdso_test_clock(CLOCK_REALTIME_COARSE);\n#endif\n\n#ifdef CLOCK_MONOTONIC\n\tret += vdso_test_clock(CLOCK_MONOTONIC);\n#endif\n\n#ifdef CLOCK_MONOTONIC_RAW\n\tret += vdso_test_clock(CLOCK_MONOTONIC_RAW);\n#endif\n\n#ifdef CLOCK_MONOTONIC_COARSE\n\tret += vdso_test_clock(CLOCK_MONOTONIC_COARSE);\n#endif\n\n#endif\n\tif (ret > 0)\n\t\treturn KSFT_FAIL;\n\n\treturn KSFT_PASS;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}