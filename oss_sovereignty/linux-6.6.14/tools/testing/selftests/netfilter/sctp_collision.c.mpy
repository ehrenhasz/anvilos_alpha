{
  "module_name": "sctp_collision.c",
  "hash_id": "b411e57d01ef8195cb25c1d779fa57dd8f616b2ac0cf2fa6aa29e8f68950e33e",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/netfilter/sctp_collision.c",
  "human_readable_source": "\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <arpa/inet.h>\n\nint main(int argc, char *argv[])\n{\n\tstruct sockaddr_in saddr = {}, daddr = {};\n\tint sd, ret, len = sizeof(daddr);\n\tstruct timeval tv = {25, 0};\n\tchar buf[] = \"hello\";\n\n\tif (argc != 6 || (strcmp(argv[1], \"server\") && strcmp(argv[1], \"client\"))) {\n\t\tprintf(\"%s <server|client> <LOCAL_IP> <LOCAL_PORT> <REMOTE_IP> <REMOTE_PORT>\\n\",\n\t\t       argv[0]);\n\t\treturn -1;\n\t}\n\n\tsd = socket(AF_INET, SOCK_SEQPACKET, IPPROTO_SCTP);\n\tif (sd < 0) {\n\t\tprintf(\"Failed to create sd\\n\");\n\t\treturn -1;\n\t}\n\n\tsaddr.sin_family = AF_INET;\n\tsaddr.sin_addr.s_addr = inet_addr(argv[2]);\n\tsaddr.sin_port = htons(atoi(argv[3]));\n\n\tret = bind(sd, (struct sockaddr *)&saddr, sizeof(saddr));\n\tif (ret < 0) {\n\t\tprintf(\"Failed to bind to address\\n\");\n\t\tgoto out;\n\t}\n\n\tret = listen(sd, 5);\n\tif (ret < 0) {\n\t\tprintf(\"Failed to listen on port\\n\");\n\t\tgoto out;\n\t}\n\n\tdaddr.sin_family = AF_INET;\n\tdaddr.sin_addr.s_addr = inet_addr(argv[4]);\n\tdaddr.sin_port = htons(atoi(argv[5]));\n\n\t \n\tret = setsockopt(sd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv));\n\tif (ret < 0) {\n\t\tprintf(\"Failed to setsockopt SO_RCVTIMEO\\n\");\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(argv[1], \"server\")) {\n\t\tsleep(1);  \n\t\tret = connect(sd, (struct sockaddr *)&daddr, len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to connect to peer\\n\");\n\t\t\tgoto out;\n\t\t}\n\t\tret = recvfrom(sd, buf, sizeof(buf), 0, (struct sockaddr *)&daddr, &len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to recv msg %d\\n\", ret);\n\t\t\tgoto out;\n\t\t}\n\t\tret = sendto(sd, buf, strlen(buf) + 1, 0, (struct sockaddr *)&daddr, len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to send msg %d\\n\", ret);\n\t\t\tgoto out;\n\t\t}\n\t\tprintf(\"Server: sent! %d\\n\", ret);\n\t}\n\n\tif (!strcmp(argv[1], \"client\")) {\n\t\tusleep(300000);  \n\t\tret = connect(sd, (struct sockaddr *)&daddr, len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to connect to peer\\n\");\n\t\t\tgoto out;\n\t\t}\n\t\tsleep(1);  \n\t\tret = sendto(sd, buf, strlen(buf) + 1, 0, (struct sockaddr *)&daddr, len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to send msg %d\\n\", ret);\n\t\t\tgoto out;\n\t\t}\n\t\tret = recvfrom(sd, buf, sizeof(buf), 0, (struct sockaddr *)&daddr, &len);\n\t\tif (ret < 0) {\n\t\t\tprintf(\"Failed to recv msg %d\\n\", ret);\n\t\t\tgoto out;\n\t\t}\n\t\tprintf(\"Client: rcvd! %d\\n\", ret);\n\t}\n\tret = 0;\nout:\n\tclose(sd);\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}