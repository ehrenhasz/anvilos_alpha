{
  "module_name": "bpf_loop_inline.c",
  "hash_id": "6327d08a640c0a6b539d4dbcc75984f45988115825fbdeabab33e2f41f524ff9",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/verifier/bpf_loop_inline.c",
  "human_readable_source": "#define BTF_TYPES \\\n\t.btf_strings = \"\\0int\\0i\\0ctx\\0callback\\0main\\0\", \\\n\t.btf_types = { \\\n\t  BTF_TYPE_INT_ENC(1, BTF_INT_SIGNED, 0, 32, 4), \\\n\t  BTF_PTR_ENC(1), \\\n\t  BTF_PTR_ENC(0), \\\n\t  BTF_FUNC_PROTO_ENC(1, 1), \\\n\t\tBTF_FUNC_PROTO_ARG_ENC(7, 3), \\\n\t  BTF_FUNC_PROTO_ENC(1, 2), \\\n\t\tBTF_FUNC_PROTO_ARG_ENC(5, 1), \\\n\t\tBTF_FUNC_PROTO_ARG_ENC(7, 2), \\\n\t  BTF_FUNC_ENC(20, 4), \\\n\t  BTF_FUNC_ENC(11, 5), \\\n\tBTF_END_RAW \\\n\t}\n\n#define MAIN_TYPE\t6\n#define CALLBACK_TYPE\t7\n\n \n#define PSEUDO_CALL_INSN() \\\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, BPF_PSEUDO_CALL, \\\n\t\t     INSN_OFF_MASK, INSN_IMM_MASK)\n\n \n#define HELPER_CALL_INSN() \\\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, INSN_OFF_MASK, INSN_IMM_MASK)\n\n{\n\t\"inline simple bpf_loop call\",\n\t.insns = {\n\t \n\t \n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_jiffies64),\n\tBPF_JMP_IMM(BPF_JEQ, BPF_REG_0, 777, 2),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_JMP_IMM(BPF_JA, 0, 0, 1),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 2),\n\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 6),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.expected_insns = { PSEUDO_CALL_INSN() },\n\t.unexpected_insns = { HELPER_CALL_INSN() },\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.result = ACCEPT,\n\t.runs = 0,\n\t.func_info = { { 0, MAIN_TYPE }, { 12, CALLBACK_TYPE } },\n\t.func_info_cnt = 2,\n\tBTF_TYPES\n},\n{\n\t\"don't inline bpf_loop call, flags non-zero\",\n\t.insns = {\n\t \n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_jiffies64),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_6, BPF_REG_0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_jiffies64),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_7, BPF_REG_0),\n\tBPF_JMP_IMM(BPF_JNE, BPF_REG_6, 0, 9),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_JMP_IMM(BPF_JNE, BPF_REG_7, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 7),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 1),\n\tBPF_JMP_IMM(BPF_JA, 0, 0, -10),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.expected_insns = { HELPER_CALL_INSN() },\n\t.unexpected_insns = { PSEUDO_CALL_INSN() },\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.result = ACCEPT,\n\t.runs = 0,\n\t.func_info = { { 0, MAIN_TYPE }, { 16, CALLBACK_TYPE } },\n\t.func_info_cnt = 2,\n\tBTF_TYPES\n},\n{\n\t\"don't inline bpf_loop call, callback non-constant\",\n\t.insns = {\n\t \n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_jiffies64),\n\tBPF_JMP_IMM(BPF_JEQ, BPF_REG_0, 777, 4),  \n\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 10),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_JMP_IMM(BPF_JA, 0, 0, 3),\n\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 8),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.expected_insns = { HELPER_CALL_INSN() },\n\t.unexpected_insns = { PSEUDO_CALL_INSN() },\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.result = ACCEPT,\n\t.runs = 0,\n\t.func_info = {\n\t\t{ 0, MAIN_TYPE },\n\t\t{ 14, CALLBACK_TYPE },\n\t\t{ 16, CALLBACK_TYPE }\n\t},\n\t.func_info_cnt = 3,\n\tBTF_TYPES\n},\n{\n\t\"bpf_loop_inline and a dead func\",\n\t.insns = {\n\t \n\n\t \n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 9),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 8),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.expected_insns = { PSEUDO_CALL_INSN() },\n\t.unexpected_insns = { HELPER_CALL_INSN() },\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.result = ACCEPT,\n\t.runs = 0,\n\t.func_info = {\n\t\t{ 0, MAIN_TYPE },\n\t\t{ 10, CALLBACK_TYPE },\n\t\t{ 12, CALLBACK_TYPE }\n\t},\n\t.func_info_cnt = 3,\n\tBTF_TYPES\n},\n{\n\t\"bpf_loop_inline stack locations for loop vars\",\n\t.insns = {\n\t \n\tBPF_ST_MEM(BPF_W, BPF_REG_10, -12, 0x77),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 1),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 22),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 2),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 16),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\t \n\tBPF_CALL_REL(2),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ST_MEM(BPF_DW, BPF_REG_10, -32, 0x55),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_1, 2),\n\tBPF_RAW_INSN(BPF_LD | BPF_IMM | BPF_DW, BPF_REG_2, BPF_PSEUDO_FUNC, 0, 6),\n\tBPF_RAW_INSN(0, 0, 0, 0, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_3, 0),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_4, 0),\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_loop),\n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t \n\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.expected_insns = {\n\tBPF_ST_MEM(BPF_W, BPF_REG_10, -12, 0x77),\n\tSKIP_INSNS(),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_6, -40),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_7, -32),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_8, -24),\n\tSKIP_INSNS(),\n\t \n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_6, -40),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_7, -32),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_8, -24),\n\tSKIP_INSNS(),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_10, -32, 0x55),\n\tSKIP_INSNS(),\n\t \n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_6, -56),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_7, -48),\n\tBPF_STX_MEM(BPF_DW, BPF_REG_10, BPF_REG_8, -40),\n\t},\n\t.unexpected_insns = { HELPER_CALL_INSN() },\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.result = ACCEPT,\n\t.func_info = {\n\t\t{ 0, MAIN_TYPE },\n\t\t{ 16, MAIN_TYPE },\n\t\t{ 25, CALLBACK_TYPE },\n\t},\n\t.func_info_cnt = 3,\n\tBTF_TYPES\n},\n{\n\t\"inline bpf_loop call in a big program\",\n\t.insns = {},\n\t.fill_helper = bpf_fill_big_prog_with_loop_1,\n\t.expected_insns = { PSEUDO_CALL_INSN() },\n\t.unexpected_insns = { HELPER_CALL_INSN() },\n\t.result = ACCEPT,\n\t.prog_type = BPF_PROG_TYPE_TRACEPOINT,\n\t.func_info = { { 0, MAIN_TYPE }, { 16, CALLBACK_TYPE } },\n\t.func_info_cnt = 2,\n\tBTF_TYPES\n},\n\n#undef HELPER_CALL_INSN\n#undef PSEUDO_CALL_INSN\n#undef CALLBACK_TYPE\n#undef MAIN_TYPE\n#undef BTF_TYPES\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}