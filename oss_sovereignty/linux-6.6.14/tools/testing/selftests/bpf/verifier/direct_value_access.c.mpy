{
  "module_name": "direct_value_access.c",
  "hash_id": "5f11503cac4568bba1c3478f803bd5ad2861882672708aa0b48077b62379821c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/verifier/direct_value_access.c",
  "human_readable_source": "{\n\t\"direct map access, write test 1\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 0),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 0, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 2\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 8),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 0, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 3\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 8),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 8, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 4\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 40),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 0, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 5\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 32),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 8, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 6\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 40),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 4, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"R1 min value is outside of the allowed memory range\",\n\t.flags = F_NEEDS_EFFICIENT_UNALIGNED_ACCESS,\n},\n{\n\t\"direct map access, write test 7\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, -1),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 4, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"direct value offset of 4294967295 is not allowed\",\n},\n{\n\t\"direct map access, write test 8\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 1),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, -1, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 9\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 48),\n\tBPF_ST_MEM(BPF_DW, BPF_REG_1, 0, 4242),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value pointer\",\n},\n{\n\t\"direct map access, write test 10\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 47),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 4),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 11\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 48),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 4),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value pointer\",\n},\n{\n\t\"direct map access, write test 12\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, (1<<29)),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 4),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"direct value offset of 536870912 is not allowed\",\n},\n{\n\t\"direct map access, write test 13\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, (1<<29)-1),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 4),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value pointer, value_size=48 off=536870911\",\n},\n{\n\t\"direct map access, write test 14\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 47),\n\tBPF_LD_MAP_VALUE(BPF_REG_2, 0, 46),\n\tBPF_ST_MEM(BPF_H, BPF_REG_2, 0, 0xffff),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_0, BPF_REG_1, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1, 3 },\n\t.result = ACCEPT,\n\t.retval = 0xff,\n},\n{\n\t\"direct map access, write test 15\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 46),\n\tBPF_LD_MAP_VALUE(BPF_REG_2, 0, 46),\n\tBPF_ST_MEM(BPF_H, BPF_REG_2, 0, 0xffff),\n\tBPF_LDX_MEM(BPF_H, BPF_REG_0, BPF_REG_1, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1, 3 },\n\t.result = ACCEPT,\n\t.retval = 0xffff,\n},\n{\n\t\"direct map access, write test 16\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 46),\n\tBPF_LD_MAP_VALUE(BPF_REG_2, 0, 47),\n\tBPF_ST_MEM(BPF_H, BPF_REG_2, 0, 0xffff),\n\tBPF_LDX_MEM(BPF_H, BPF_REG_0, BPF_REG_1, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1, 3 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value, value_size=48 off=47 size=2\",\n\t.flags = F_NEEDS_EFFICIENT_UNALIGNED_ACCESS,\n},\n{\n\t\"direct map access, write test 17\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 46),\n\tBPF_LD_MAP_VALUE(BPF_REG_2, 0, 46),\n\tBPF_ST_MEM(BPF_H, BPF_REG_2, 1, 0xffff),\n\tBPF_LDX_MEM(BPF_H, BPF_REG_0, BPF_REG_1, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1, 3 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value, value_size=48 off=47 size=2\",\n\t.flags = F_NEEDS_EFFICIENT_UNALIGNED_ACCESS,\n},\n{\n\t\"direct map access, write test 18\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 0),\n\tBPF_ST_MEM(BPF_H, BPF_REG_1, 0, 42),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_small = { 1 },\n\t.result = REJECT,\n\t.errstr = \"R1 min value is outside of the allowed memory range\",\n},\n{\n\t\"direct map access, write test 19\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 0),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 42),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_small = { 1 },\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"direct map access, write test 20\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_MAP_VALUE(BPF_REG_1, 0, 1),\n\tBPF_ST_MEM(BPF_B, BPF_REG_1, 0, 42),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_small = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid access to map value pointer\",\n},\n{\n\t\"direct map access, invalid insn test 1\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_VALUE, 0, 1, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid bpf_ld_imm64 insn\",\n},\n{\n\t\"direct map access, invalid insn test 2\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_VALUE, 1, 0, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"BPF_LD_IMM64 uses reserved fields\",\n},\n{\n\t\"direct map access, invalid insn test 3\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_VALUE, ~0, 0, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"BPF_LD_IMM64 uses reserved fields\",\n},\n{\n\t\"direct map access, invalid insn test 4\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_VALUE, 0, ~0, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid bpf_ld_imm64 insn\",\n},\n{\n\t\"direct map access, invalid insn test 5\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_VALUE, ~0, ~0, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid bpf_ld_imm64 insn\",\n},\n{\n\t\"direct map access, invalid insn test 6\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_FD, ~0, 0, 0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"BPF_LD_IMM64 uses reserved fields\",\n},\n{\n\t\"direct map access, invalid insn test 7\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_FD, 0, ~0, 0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid bpf_ld_imm64 insn\",\n},\n{\n\t\"direct map access, invalid insn test 8\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_FD, ~0, ~0, 0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"invalid bpf_ld_imm64 insn\",\n},\n{\n\t\"direct map access, invalid insn test 9\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_LD_IMM64_RAW_FULL(BPF_REG_1, BPF_PSEUDO_MAP_FD, 0, 0, 0, 47),\n\tBPF_EXIT_INSN(),\n\t},\n\t.fixup_map_array_48b = { 1 },\n\t.result = REJECT,\n\t.errstr = \"unrecognized bpf_ld_imm64 insn\",\n},\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}