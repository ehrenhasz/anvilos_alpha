{
  "module_name": "basic_instr.c",
  "hash_id": "d3c3f34a74d60edca496ded7972bafc72d1219af6852f04ef495676f95e7cdd3",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/verifier/basic_instr.c",
  "human_readable_source": "{\n\t\"add+sub+mul\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_1, 1),\n\tBPF_ALU64_IMM(BPF_ADD, BPF_REG_1, 2),\n\tBPF_MOV64_IMM(BPF_REG_2, 3),\n\tBPF_ALU64_REG(BPF_SUB, BPF_REG_1, BPF_REG_2),\n\tBPF_ALU64_IMM(BPF_ADD, BPF_REG_1, -1),\n\tBPF_ALU64_IMM(BPF_MUL, BPF_REG_1, 3),\n\tBPF_MOV64_REG(BPF_REG_0, BPF_REG_1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = -3,\n},\n{\n\t\"xor32 zero extend check\",\n\t.insns = {\n\tBPF_MOV32_IMM(BPF_REG_2, -1),\n\tBPF_ALU64_IMM(BPF_LSH, BPF_REG_2, 32),\n\tBPF_ALU64_IMM(BPF_OR, BPF_REG_2, 0xffff),\n\tBPF_ALU32_REG(BPF_XOR, BPF_REG_2, BPF_REG_2),\n\tBPF_MOV32_IMM(BPF_REG_0, 2),\n\tBPF_JMP_IMM(BPF_JNE, BPF_REG_2, 0, 1),\n\tBPF_MOV32_IMM(BPF_REG_0, 1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SCHED_CLS,\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"arsh32 on imm\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_ALU32_IMM(BPF_ARSH, BPF_REG_0, 5),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 0,\n},\n{\n\t\"arsh32 on imm 2\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 0x1122334485667788),\n\tBPF_ALU32_IMM(BPF_ARSH, BPF_REG_0, 7),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = -16069393,\n},\n{\n\t\"arsh32 on reg\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_MOV64_IMM(BPF_REG_1, 5),\n\tBPF_ALU32_REG(BPF_ARSH, BPF_REG_0, BPF_REG_1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 0,\n},\n{\n\t\"arsh32 on reg 2\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 0xffff55667788),\n\tBPF_MOV64_IMM(BPF_REG_1, 15),\n\tBPF_ALU32_REG(BPF_ARSH, BPF_REG_0, BPF_REG_1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 43724,\n},\n{\n\t\"arsh64 on imm\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_ALU64_IMM(BPF_ARSH, BPF_REG_0, 5),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n},\n{\n\t\"arsh64 on reg\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_MOV64_IMM(BPF_REG_1, 5),\n\tBPF_ALU64_REG(BPF_ARSH, BPF_REG_0, BPF_REG_1),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n},\n{\n\t\"lsh64 by 0 imm\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 1),\n\tBPF_ALU64_IMM(BPF_LSH, BPF_REG_1, 0),\n\tBPF_JMP_IMM(BPF_JEQ, BPF_REG_1, 1, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"rsh64 by 0 imm\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 0x100000000LL),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_2, BPF_REG_1),\n\tBPF_ALU64_IMM(BPF_RSH, BPF_REG_1, 0),\n\tBPF_JMP_REG(BPF_JEQ, BPF_REG_1, BPF_REG_2, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"arsh64 by 0 imm\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 0x100000000LL),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_2, BPF_REG_1),\n\tBPF_ALU64_IMM(BPF_ARSH, BPF_REG_1, 0),\n\tBPF_JMP_REG(BPF_JEQ, BPF_REG_1, BPF_REG_2, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"lsh64 by 0 reg\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 1),\n\tBPF_LD_IMM64(BPF_REG_2, 0),\n\tBPF_ALU64_REG(BPF_LSH, BPF_REG_1, BPF_REG_2),\n\tBPF_JMP_IMM(BPF_JEQ, BPF_REG_1, 1, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"rsh64 by 0 reg\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 0x100000000LL),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_2, BPF_REG_1),\n\tBPF_LD_IMM64(BPF_REG_3, 0),\n\tBPF_ALU64_REG(BPF_RSH, BPF_REG_1, BPF_REG_3),\n\tBPF_JMP_REG(BPF_JEQ, BPF_REG_1, BPF_REG_2, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"arsh64 by 0 reg\",\n\t.insns = {\n\tBPF_LD_IMM64(BPF_REG_0, 1),\n\tBPF_LD_IMM64(BPF_REG_1, 0x100000000LL),\n\tBPF_ALU64_REG(BPF_MOV, BPF_REG_2, BPF_REG_1),\n\tBPF_LD_IMM64(BPF_REG_3, 0),\n\tBPF_ALU64_REG(BPF_ARSH, BPF_REG_1, BPF_REG_3),\n\tBPF_JMP_REG(BPF_JEQ, BPF_REG_1, BPF_REG_2, 1),\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.result = ACCEPT,\n\t.retval = 1,\n},\n{\n\t\"invalid 64-bit BPF_END with BPF_TO_BE\",\n\t.insns = {\n\tBPF_MOV32_IMM(BPF_REG_0, 0),\n\t{\n\t\t.code  = BPF_ALU64 | BPF_END | BPF_TO_BE,\n\t\t.dst_reg = BPF_REG_0,\n\t\t.src_reg = 0,\n\t\t.off   = 0,\n\t\t.imm   = 32,\n\t},\n\tBPF_EXIT_INSN(),\n\t},\n\t.errstr = \"unknown opcode df\",\n\t.result = REJECT,\n},\n{\n\t\"mov64 src == dst\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_2, 0),\n\tBPF_MOV64_REG(BPF_REG_2, BPF_REG_2),\n\t\n\tBPF_ALU64_REG(BPF_ADD, BPF_REG_1, BPF_REG_2),\n\tBPF_MOV64_IMM(BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SCHED_CLS,\n\t.result = ACCEPT,\n},\n{\n\t\"mov64 src != dst\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_3, 0),\n\tBPF_MOV64_REG(BPF_REG_2, BPF_REG_3),\n\t\n\tBPF_ALU64_REG(BPF_ADD, BPF_REG_1, BPF_REG_2),\n\tBPF_MOV64_IMM(BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SCHED_CLS,\n\t.result = ACCEPT,\n},\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}