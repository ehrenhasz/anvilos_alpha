{
  "module_name": "jset.c",
  "hash_id": "c491996f44397f4527c64801d9181d04d847e059916c80c9499f248d8447af4b",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/verifier/jset.c",
  "human_readable_source": "{\n\t\"jset: functional\",\n\t.insns = {\n\tBPF_DIRECT_PKT_R2,\n\tBPF_LDX_MEM(BPF_DW, BPF_REG_7, BPF_REG_2, 0),\n\n\t \n\tBPF_LD_IMM64(BPF_REG_8, 0x8000000000000001),\n\tBPF_JMP_REG(BPF_JSET, BPF_REG_7, BPF_REG_8, 1),\n\tBPF_EXIT_INSN(),\n\n\t \n\tBPF_LD_IMM64(BPF_REG_8, 0x4000000000000000),\n\tBPF_JMP_REG(BPF_JSET, BPF_REG_7, BPF_REG_8, 1),\n\tBPF_JMP_IMM(BPF_JA, 0, 0, 1),\n\tBPF_EXIT_INSN(),\n\n\t \n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_7, -1, 1),\n\tBPF_EXIT_INSN(),\n\n\t \n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_7, 0x80000000, 1),\n\tBPF_EXIT_INSN(),\n\n\t \n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SCHED_CLS,\n\t.result = ACCEPT,\n\t.runs = 7,\n\t.retvals = {\n\t\t{ .retval = 2,\n\t\t  .data64 = { (1ULL << 63) | (1U << 31) | (1U << 0), }\n\t\t},\n\t\t{ .retval = 2,\n\t\t  .data64 = { (1ULL << 63) | (1U << 31), }\n\t\t},\n\t\t{ .retval = 2,\n\t\t  .data64 = { (1ULL << 31) | (1U << 0), }\n\t\t},\n\t\t{ .retval = 2,\n\t\t  .data64 = { (__u32)-1, }\n\t\t},\n\t\t{ .retval = 2,\n\t\t  .data64 = { ~0x4000000000000000ULL, }\n\t\t},\n\t\t{ .retval = 0,\n\t\t  .data64 = { 0, }\n\t\t},\n\t\t{ .retval = 0,\n\t\t  .data64 = { ~0ULL, }\n\t\t},\n\t},\n\t.flags = F_NEEDS_EFFICIENT_UNALIGNED_ACCESS,\n},\n{\n\t\"jset: sign-extend\",\n\t.insns = {\n\tBPF_DIRECT_PKT_R2,\n\tBPF_LDX_MEM(BPF_DW, BPF_REG_7, BPF_REG_2, 0),\n\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_7, 0x80000000, 1),\n\tBPF_EXIT_INSN(),\n\n\tBPF_MOV64_IMM(BPF_REG_0, 2),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SCHED_CLS,\n\t.result = ACCEPT,\n\t.retval = 2,\n\t.data = { 1, 0, 0, 0, 0, 0, 0, 1, },\n\t.flags = F_NEEDS_EFFICIENT_UNALIGNED_ACCESS,\n},\n{\n\t\"jset: known const compare\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 1),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_0, 1, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"R9 !read_ok\",\n\t.result_unpriv = REJECT,\n\t.retval = 1,\n\t.result = ACCEPT,\n},\n{\n\t\"jset: known const compare bad\",\n\t.insns = {\n\tBPF_MOV64_IMM(BPF_REG_0, 0),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_0, 1, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"!read_ok\",\n\t.result_unpriv = REJECT,\n\t.errstr = \"!read_ok\",\n\t.result = REJECT,\n},\n{\n\t\"jset: unknown const compare taken\",\n\t.insns = {\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_get_prandom_u32),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_0, 1, 1),\n\tBPF_JMP_IMM(BPF_JA, 0, 0, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"!read_ok\",\n\t.result_unpriv = REJECT,\n\t.errstr = \"!read_ok\",\n\t.result = REJECT,\n},\n{\n\t\"jset: unknown const compare not taken\",\n\t.insns = {\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_get_prandom_u32),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_0, 1, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"!read_ok\",\n\t.result_unpriv = REJECT,\n\t.errstr = \"!read_ok\",\n\t.result = REJECT,\n},\n{\n\t\"jset: half-known const compare\",\n\t.insns = {\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_get_prandom_u32),\n\tBPF_ALU64_IMM(BPF_OR, BPF_REG_0, 2),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_0, 3, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_MOV64_IMM(BPF_REG_0, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"R9 !read_ok\",\n\t.result_unpriv = REJECT,\n\t.result = ACCEPT,\n},\n{\n\t\"jset: range\",\n\t.insns = {\n\tBPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_get_prandom_u32),\n\tBPF_MOV64_REG(BPF_REG_1, BPF_REG_0),\n\tBPF_MOV64_IMM(BPF_REG_0, 0),\n\tBPF_ALU64_IMM(BPF_AND, BPF_REG_1, 0xff),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_1, 0xf0, 3),\n\tBPF_JMP_IMM(BPF_JLT, BPF_REG_1, 0x10, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\tBPF_JMP_IMM(BPF_JSET, BPF_REG_1, 0x10, 1),\n\tBPF_EXIT_INSN(),\n\tBPF_JMP_IMM(BPF_JGE, BPF_REG_1, 0x10, 1),\n\tBPF_LDX_MEM(BPF_B, BPF_REG_8, BPF_REG_9, 0),\n\tBPF_EXIT_INSN(),\n\t},\n\t.prog_type = BPF_PROG_TYPE_SOCKET_FILTER,\n\t.errstr_unpriv = \"R9 !read_ok\",\n\t.result_unpriv = REJECT,\n\t.result = ACCEPT,\n},\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}