{
  "module_name": "network_helpers.h",
  "hash_id": "a344d28e326959090dbd9e6d78d40a99931963b2bbb3fc61517aede6765ffcf3",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/network_helpers.h",
  "human_readable_source": " \n#ifndef __NETWORK_HELPERS_H\n#define __NETWORK_HELPERS_H\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <linux/types.h>\ntypedef __u16 __sum16;\n#include <linux/if_ether.h>\n#include <linux/if_packet.h>\n#include <linux/ip.h>\n#include <linux/ipv6.h>\n#include <netinet/tcp.h>\n#include <bpf/bpf_endian.h>\n\n#define MAGIC_VAL 0x1234\n#define NUM_ITER 100000\n#define VIP_NUM 5\n#define MAGIC_BYTES 123\n\nstruct network_helper_opts {\n\tconst char *cc;\n\tint timeout_ms;\n\tbool must_fail;\n\tbool noconnect;\n\tint type;\n\tint proto;\n};\n\n \nstruct ipv4_packet {\n\tstruct ethhdr eth;\n\tstruct iphdr iph;\n\tstruct tcphdr tcp;\n} __packed;\nextern struct ipv4_packet pkt_v4;\n\n \nstruct ipv6_packet {\n\tstruct ethhdr eth;\n\tstruct ipv6hdr iph;\n\tstruct tcphdr tcp;\n} __packed;\nextern struct ipv6_packet pkt_v6;\n\nint settimeo(int fd, int timeout_ms);\nint start_server(int family, int type, const char *addr, __u16 port,\n\t\t int timeout_ms);\nint start_mptcp_server(int family, const char *addr, __u16 port,\n\t\t       int timeout_ms);\nint *start_reuseport_server(int family, int type, const char *addr_str,\n\t\t\t    __u16 port, int timeout_ms,\n\t\t\t    unsigned int nr_listens);\nvoid free_fds(int *fds, unsigned int nr_close_fds);\nint connect_to_fd(int server_fd, int timeout_ms);\nint connect_to_fd_opts(int server_fd, const struct network_helper_opts *opts);\nint connect_fd_to_fd(int client_fd, int server_fd, int timeout_ms);\nint fastopen_connect(int server_fd, const char *data, unsigned int data_len,\n\t\t     int timeout_ms);\nint make_sockaddr(int family, const char *addr_str, __u16 port,\n\t\t  struct sockaddr_storage *addr, socklen_t *len);\nchar *ping_command(int family);\nint get_socket_local_port(int sock_fd);\n\nstruct nstoken;\n \nstruct nstoken *open_netns(const char *name);\nvoid close_netns(struct nstoken *token);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}