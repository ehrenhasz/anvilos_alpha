{
  "module_name": "test_xdp_redirect.sh",
  "hash_id": "836344d2d195884ea111c7952c6cafe24ba637c0593ee250d1e7eb6134834ece",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/test_xdp_redirect.sh",
  "human_readable_source": "#!/bin/bash\n# Create 2 namespaces with two veth peers, and\n# forward packets in-between using generic XDP\n#\n# NS1(veth11)     NS2(veth22)\n#     |               |\n#     |               |\n#   (veth1, ------ (veth2,\n#   id:111)         id:222)\n#     | xdp forwarding |\n#     ------------------\n\nreadonly NS1=\"ns1-$(mktemp -u XXXXXX)\"\nreadonly NS2=\"ns2-$(mktemp -u XXXXXX)\"\nret=0\n\nsetup()\n{\n\n\tlocal xdpmode=$1\n\n\tip netns add ${NS1}\n\tip netns add ${NS2}\n\n\tip link add veth1 index 111 type veth peer name veth11 netns ${NS1}\n\tip link add veth2 index 222 type veth peer name veth22 netns ${NS2}\n\n\tip link set veth1 up\n\tip link set veth2 up\n\tip -n ${NS1} link set dev veth11 up\n\tip -n ${NS2} link set dev veth22 up\n\n\tip -n ${NS1} addr add 10.1.1.11/24 dev veth11\n\tip -n ${NS2} addr add 10.1.1.22/24 dev veth22\n}\n\ncleanup()\n{\n\tip link del veth1 2> /dev/null\n\tip link del veth2 2> /dev/null\n\tip netns del ${NS1} 2> /dev/null\n\tip netns del ${NS2} 2> /dev/null\n}\n\ntest_xdp_redirect()\n{\n\tlocal xdpmode=$1\n\n\tsetup\n\n\tip link set dev veth1 $xdpmode off &> /dev/null\n\tif [ $? -ne 0 ];then\n\t\techo \"selftests: test_xdp_redirect $xdpmode [SKIP]\"\n\t\treturn 0\n\tfi\n\n\tip -n ${NS1} link set veth11 $xdpmode obj xdp_dummy.bpf.o sec xdp &> /dev/null\n\tip -n ${NS2} link set veth22 $xdpmode obj xdp_dummy.bpf.o sec xdp &> /dev/null\n\tip link set dev veth1 $xdpmode obj test_xdp_redirect.bpf.o sec redirect_to_222 &> /dev/null\n\tip link set dev veth2 $xdpmode obj test_xdp_redirect.bpf.o sec redirect_to_111 &> /dev/null\n\n\tif ip netns exec ${NS1} ping -c 1 10.1.1.22 &> /dev/null &&\n\t   ip netns exec ${NS2} ping -c 1 10.1.1.11 &> /dev/null; then\n\t\techo \"selftests: test_xdp_redirect $xdpmode [PASS]\";\n\telse\n\t\tret=1\n\t\techo \"selftests: test_xdp_redirect $xdpmode [FAILED]\";\n\tfi\n\n\tcleanup\n}\n\nset -e\ntrap cleanup 2 3 6 9\n\ntest_xdp_redirect xdpgeneric\ntest_xdp_redirect xdpdrv\n\nexit $ret\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}