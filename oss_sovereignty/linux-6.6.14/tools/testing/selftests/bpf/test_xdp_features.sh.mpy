{
  "module_name": "test_xdp_features.sh",
  "hash_id": "3c95731dad3fbb4afa8ab8e784304e922bd7e753a44d6cc3a529232410991e12",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/test_xdp_features.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\nreadonly NS=\"ns1-$(mktemp -u XXXXXX)\"\nreadonly V0_IP4=10.10.0.11\nreadonly V1_IP4=10.10.0.1\nreadonly V0_IP6=2001:db8::11\nreadonly V1_IP6=2001:db8::1\n\nret=1\n\nsetup() {\n\t{\n\t\tip netns add ${NS}\n\n\t\tip link add v1 type veth peer name v0 netns ${NS}\n\n\t\tip link set v1 up\n\t\tip addr add $V1_IP4/24 dev v1\n\t\tip addr add $V1_IP6/64 nodad dev v1\n\t\tip -n ${NS} link set dev v0 up\n\t\tip -n ${NS} addr add $V0_IP4/24 dev v0\n\t\tip -n ${NS} addr add $V0_IP6/64 nodad dev v0\n\n\t\t# Enable XDP mode and disable checksum offload\n\t\tethtool -K v1 gro on\n\t\tethtool -K v1 tx-checksumming off\n\t\tip netns exec ${NS} ethtool -K v0 gro on\n\t\tip netns exec ${NS} ethtool -K v0 tx-checksumming off\n\t} > /dev/null 2>&1\n}\n\ncleanup() {\n\tip link del v1 2> /dev/null\n\tip netns del ${NS} 2> /dev/null\n\t[ \"$(pidof xdp_features)\" = \"\" ] || kill $(pidof xdp_features) 2> /dev/null\n}\n\nwait_for_dut_server() {\n\twhile sleep 1; do\n\t\tss -tlp | grep -q xdp_features\n\t\t[ $? -eq 0 ] && break\n\tdone\n}\n\ntest_xdp_features() {\n\tsetup\n\n\t## XDP_PASS\n\t./xdp_features -f XDP_PASS -D $V1_IP6 -T $V0_IP6 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_PASS \\\n\t\t\t\t\t   -D $V1_IP6 -C $V1_IP6 \\\n\t\t\t\t\t   -T $V0_IP6 v0\n\t[ $? -ne 0 ] && exit\n\n\t## XDP_DROP\n\t./xdp_features -f XDP_DROP -D ::ffff:$V1_IP4 -T ::ffff:$V0_IP4 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_DROP \\\n\t\t\t\t\t   -D ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -C ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -T ::ffff:$V0_IP4 v0\n\t[ $? -ne 0 ] && exit\n\n\t## XDP_ABORTED\n\t./xdp_features -f XDP_ABORTED -D $V1_IP6 -T $V0_IP6 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_ABORTED \\\n\t\t\t\t\t   -D $V1_IP6 -C $V1_IP6 \\\n\t\t\t\t\t   -T $V0_IP6 v0\n\t[ $? -ne 0 ] && exit\n\n\t## XDP_TX\n\t./xdp_features -f XDP_TX -D ::ffff:$V1_IP4 -T ::ffff:$V0_IP4 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_TX \\\n\t\t\t\t\t   -D ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -C ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -T ::ffff:$V0_IP4 v0\n\t[ $? -ne 0 ] && exit\n\n\t## XDP_REDIRECT\n\t./xdp_features -f XDP_REDIRECT -D $V1_IP6 -T $V0_IP6 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_REDIRECT \\\n\t\t\t\t\t   -D $V1_IP6 -C $V1_IP6 \\\n\t\t\t\t\t   -T $V0_IP6 v0\n\t[ $? -ne 0 ] && exit\n\n\t## XDP_NDO_XMIT\n\t./xdp_features -f XDP_NDO_XMIT -D ::ffff:$V1_IP4 -T ::ffff:$V0_IP4 v1 &\n\twait_for_dut_server\n\tip netns exec ${NS} ./xdp_features -t -f XDP_NDO_XMIT \\\n\t\t\t\t\t   -D ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -C ::ffff:$V1_IP4 \\\n\t\t\t\t\t   -T ::ffff:$V0_IP4 v0\n\tret=$?\n\tcleanup\n}\n\nset -e\ntrap cleanup 2 3 6 9\n\ntest_xdp_features\n\nexit $ret\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}