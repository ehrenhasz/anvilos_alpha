{
  "module_name": "bpf_rand.h",
  "hash_id": "9ea140e9374d95cb2244c2a91ecddecdb7cc84853d055c55d51920abacc76119",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/bpf_rand.h",
  "human_readable_source": " \n#ifndef __BPF_RAND__\n#define __BPF_RAND__\n\n#include <stdint.h>\n#include <stdlib.h>\n#include <time.h>\n\nstatic inline uint64_t bpf_rand_mask(uint64_t mask)\n{\n\treturn (((uint64_t)(uint32_t)rand()) |\n\t        ((uint64_t)(uint32_t)rand() << 32)) & mask;\n}\n\n#define bpf_rand_ux(x, m)\t\t\t\\\nstatic inline uint64_t bpf_rand_u##x(int shift)\t\\\n{\t\t\t\t\t\t\\\n\treturn bpf_rand_mask((m)) << shift;\t\\\n}\n\nbpf_rand_ux( 8,               0xffULL)\nbpf_rand_ux(16,             0xffffULL)\nbpf_rand_ux(24,           0xffffffULL)\nbpf_rand_ux(32,         0xffffffffULL)\nbpf_rand_ux(40,       0xffffffffffULL)\nbpf_rand_ux(48,     0xffffffffffffULL)\nbpf_rand_ux(56,   0xffffffffffffffULL)\nbpf_rand_ux(64, 0xffffffffffffffffULL)\n\nstatic inline void bpf_semi_rand_init(void)\n{\n\tsrand(time(NULL));\n}\n\nstatic inline uint64_t bpf_semi_rand_get(void)\n{\n\tswitch (rand() % 39) {\n\tcase  0: return 0x000000ff00000000ULL | bpf_rand_u8(0);\n\tcase  1: return 0xffffffff00000000ULL | bpf_rand_u16(0);\n\tcase  2: return 0x00000000ffff0000ULL | bpf_rand_u16(0);\n\tcase  3: return 0x8000000000000000ULL | bpf_rand_u32(0);\n\tcase  4: return 0x00000000f0000000ULL | bpf_rand_u32(0);\n\tcase  5: return 0x0000000100000000ULL | bpf_rand_u24(0);\n\tcase  6: return 0x800ff00000000000ULL | bpf_rand_u32(0);\n\tcase  7: return 0x7fffffff00000000ULL | bpf_rand_u32(0);\n\tcase  8: return 0xffffffffffffff00ULL ^ bpf_rand_u32(24);\n\tcase  9: return 0xffffffffffffff00ULL | bpf_rand_u8(0);\n\tcase 10: return 0x0000000010000000ULL | bpf_rand_u32(0);\n\tcase 11: return 0xf000000000000000ULL | bpf_rand_u8(0);\n\tcase 12: return 0x0000f00000000000ULL | bpf_rand_u8(8);\n\tcase 13: return 0x000000000f000000ULL | bpf_rand_u8(16);\n\tcase 14: return 0x0000000000000f00ULL | bpf_rand_u8(32);\n\tcase 15: return 0x00fff00000000f00ULL | bpf_rand_u8(48);\n\tcase 16: return 0x00007fffffffffffULL ^ bpf_rand_u32(1);\n\tcase 17: return 0xffff800000000000ULL | bpf_rand_u8(4);\n\tcase 18: return 0xffff800000000000ULL | bpf_rand_u8(20);\n\tcase 19: return (0xffffffc000000000ULL + 0x80000ULL) | bpf_rand_u32(0);\n\tcase 20: return (0xffffffc000000000ULL - 0x04000000ULL) | bpf_rand_u32(0);\n\tcase 21: return 0x0000000000000000ULL | bpf_rand_u8(55) | bpf_rand_u32(20);\n\tcase 22: return 0xffffffffffffffffULL ^ bpf_rand_u8(3) ^ bpf_rand_u32(40);\n\tcase 23: return 0x0000000000000000ULL | bpf_rand_u8(bpf_rand_u8(0) % 64);\n\tcase 24: return 0x0000000000000000ULL | bpf_rand_u16(bpf_rand_u8(0) % 64);\n\tcase 25: return 0xffffffffffffffffULL ^ bpf_rand_u8(bpf_rand_u8(0) % 64);\n\tcase 26: return 0xffffffffffffffffULL ^ bpf_rand_u40(bpf_rand_u8(0) % 64);\n\tcase 27: return 0x0000800000000000ULL;\n\tcase 28: return 0x8000000000000000ULL;\n\tcase 29: return 0x0000000000000000ULL;\n\tcase 30: return 0xffffffffffffffffULL;\n\tcase 31: return bpf_rand_u16(bpf_rand_u8(0) % 64);\n\tcase 32: return bpf_rand_u24(bpf_rand_u8(0) % 64);\n\tcase 33: return bpf_rand_u32(bpf_rand_u8(0) % 64);\n\tcase 34: return bpf_rand_u40(bpf_rand_u8(0) % 64);\n\tcase 35: return bpf_rand_u48(bpf_rand_u8(0) % 64);\n\tcase 36: return bpf_rand_u56(bpf_rand_u8(0) % 64);\n\tcase 37: return bpf_rand_u64(bpf_rand_u8(0) % 64);\n\tdefault: return bpf_rand_u64(0);\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}