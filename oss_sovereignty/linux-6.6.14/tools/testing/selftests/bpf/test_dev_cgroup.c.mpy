{
  "module_name": "test_dev_cgroup.c",
  "hash_id": "2fbc97a9d414b78f7ddf40ac871eaf295d80882def2995d148e76bae6c130e09",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/test_dev_cgroup.c",
  "human_readable_source": "\n \n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <errno.h>\n#include <assert.h>\n#include <sys/time.h>\n\n#include <linux/bpf.h>\n#include <bpf/bpf.h>\n#include <bpf/libbpf.h>\n\n#include \"cgroup_helpers.h\"\n#include \"testing_helpers.h\"\n\n#define DEV_CGROUP_PROG \"./dev_cgroup.bpf.o\"\n\n#define TEST_CGROUP \"/test-bpf-based-device-cgroup/\"\n\nint main(int argc, char **argv)\n{\n\tstruct bpf_object *obj;\n\tint error = EXIT_FAILURE;\n\tint prog_fd, cgroup_fd;\n\t__u32 prog_cnt;\n\n\t \n\tlibbpf_set_strict_mode(LIBBPF_STRICT_ALL);\n\n\tif (bpf_prog_test_load(DEV_CGROUP_PROG, BPF_PROG_TYPE_CGROUP_DEVICE,\n\t\t\t  &obj, &prog_fd)) {\n\t\tprintf(\"Failed to load DEV_CGROUP program\\n\");\n\t\tgoto out;\n\t}\n\n\tcgroup_fd = cgroup_setup_and_join(TEST_CGROUP);\n\tif (cgroup_fd < 0) {\n\t\tprintf(\"Failed to create test cgroup\\n\");\n\t\tgoto out;\n\t}\n\n\t \n\tif (bpf_prog_attach(prog_fd, cgroup_fd, BPF_CGROUP_DEVICE, 0)) {\n\t\tprintf(\"Failed to attach DEV_CGROUP program\");\n\t\tgoto err;\n\t}\n\n\tif (bpf_prog_query(cgroup_fd, BPF_CGROUP_DEVICE, 0, NULL, NULL,\n\t\t\t   &prog_cnt)) {\n\t\tprintf(\"Failed to query attached programs\");\n\t\tgoto err;\n\t}\n\n\t \n\tassert(system(\"rm -f /tmp/test_dev_cgroup_null\") == 0);\n\tassert(system(\"mknod /tmp/test_dev_cgroup_null c 1 3\"));\n\tassert(system(\"rm -f /tmp/test_dev_cgroup_null\") == 0);\n\n\t \n\tassert(system(\"rm -f /tmp/test_dev_cgroup_zero\") == 0);\n\tassert(system(\"mknod /tmp/test_dev_cgroup_zero c 1 5\") == 0);\n\tassert(system(\"rm -f /tmp/test_dev_cgroup_zero\") == 0);\n\n\tassert(system(\"dd if=/dev/urandom of=/dev/zero count=64\") == 0);\n\n\t \n\tassert(system(\"dd if=/dev/urandom of=/dev/full count=64\"));\n\n\t \n\tassert(system(\"dd if=/dev/random of=/dev/zero count=64\"));\n\n\terror = 0;\n\tprintf(\"test_dev_cgroup:PASS\\n\");\n\nerr:\n\tcleanup_cgroup_environment();\n\nout:\n\treturn error;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}