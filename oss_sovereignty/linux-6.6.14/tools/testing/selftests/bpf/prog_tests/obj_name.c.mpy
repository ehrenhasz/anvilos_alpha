{
  "module_name": "obj_name.c",
  "hash_id": "60ee0d34038824f8f1f557f0a62b81ebf558e6719050d8c4a3f277b7348c8e98",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/obj_name.c",
  "human_readable_source": "\n#include <test_progs.h>\n\nvoid test_obj_name(void)\n{\n\tstruct {\n\t\tconst char *name;\n\t\tint success;\n\t\tint expected_errno;\n\t} tests[] = {\n\t\t{ \"\", 1, 0 },\n\t\t{ \"_123456789ABCDE\", 1, 0 },\n\t\t{ \"_123456789ABCDEF\", 0, EINVAL },\n\t\t{ \"_123456789ABCD\\n\", 0, EINVAL },\n\t};\n\tstruct bpf_insn prog[] = {\n\t\tBPF_ALU64_IMM(BPF_MOV, BPF_REG_0, 0),\n\t\tBPF_EXIT_INSN(),\n\t};\n\t__u32 duration = 0;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(tests); i++) {\n\t\tsize_t name_len = strlen(tests[i].name) + 1;\n\t\tunion bpf_attr attr;\n\t\tsize_t ncopy;\n\t\tint fd;\n\n\t\t \n\t\tncopy = name_len < sizeof(attr.prog_name) ?\n\t\t\tname_len : sizeof(attr.prog_name);\n\t\tbzero(&attr, sizeof(attr));\n\t\tattr.prog_type = BPF_PROG_TYPE_SCHED_CLS;\n\t\tattr.insn_cnt = 2;\n\t\tattr.insns = ptr_to_u64(prog);\n\t\tattr.license = ptr_to_u64(\"\");\n\t\tmemcpy(attr.prog_name, tests[i].name, ncopy);\n\n\t\tfd = syscall(__NR_bpf, BPF_PROG_LOAD, &attr, sizeof(attr));\n\t\tCHECK((tests[i].success && fd < 0) ||\n\t\t      (!tests[i].success && fd >= 0) ||\n\t\t      (!tests[i].success && errno != tests[i].expected_errno),\n\t\t      \"check-bpf-prog-name\",\n\t\t      \"fd %d(%d) errno %d(%d)\\n\",\n\t\t       fd, tests[i].success, errno, tests[i].expected_errno);\n\n\t\tif (fd >= 0)\n\t\t\tclose(fd);\n\n\t\t \n\t\tncopy = name_len < sizeof(attr.map_name) ?\n\t\t\tname_len : sizeof(attr.map_name);\n\t\tbzero(&attr, sizeof(attr));\n\t\tattr.map_type = BPF_MAP_TYPE_ARRAY;\n\t\tattr.key_size = 4;\n\t\tattr.value_size = 4;\n\t\tattr.max_entries = 1;\n\t\tattr.map_flags = 0;\n\t\tmemcpy(attr.map_name, tests[i].name, ncopy);\n\t\tfd = syscall(__NR_bpf, BPF_MAP_CREATE, &attr, sizeof(attr));\n\t\tCHECK((tests[i].success && fd < 0) ||\n\t\t      (!tests[i].success && fd >= 0) ||\n\t\t      (!tests[i].success && errno != tests[i].expected_errno),\n\t\t      \"check-bpf-map-name\",\n\t\t      \"fd %d(%d) errno %d(%d)\\n\",\n\t\t      fd, tests[i].success, errno, tests[i].expected_errno);\n\n\t\tif (fd >= 0)\n\t\t\tclose(fd);\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}