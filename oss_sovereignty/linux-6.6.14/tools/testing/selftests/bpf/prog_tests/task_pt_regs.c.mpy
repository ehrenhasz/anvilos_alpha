{
  "module_name": "task_pt_regs.c",
  "hash_id": "120d4f0dd4c8d116e194f0430358fc4c3dbd7cb5b244e2b8ef113df5c8c33642",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/task_pt_regs.c",
  "human_readable_source": "\n#define _GNU_SOURCE\n#include <test_progs.h>\n#include \"test_task_pt_regs.skel.h\"\n\n \nstatic noinline void trigger_func(void)\n{\n\tasm volatile (\"\");\n}\n\nvoid test_task_pt_regs(void)\n{\n\tstruct test_task_pt_regs *skel;\n\tstruct bpf_link *uprobe_link;\n\tssize_t uprobe_offset;\n\tbool match;\n\n\tuprobe_offset = get_uprobe_offset(&trigger_func);\n\tif (!ASSERT_GE(uprobe_offset, 0, \"uprobe_offset\"))\n\t\treturn;\n\n\tskel = test_task_pt_regs__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"skel_open\"))\n\t\treturn;\n\tif (!ASSERT_OK_PTR(skel->bss, \"check_bss\"))\n\t\tgoto cleanup;\n\n\tuprobe_link = bpf_program__attach_uprobe(skel->progs.handle_uprobe,\n\t\t\t\t\t\t false  ,\n\t\t\t\t\t\t 0  ,\n\t\t\t\t\t\t \"/proc/self/exe\",\n\t\t\t\t\t\t uprobe_offset);\n\tif (!ASSERT_OK_PTR(uprobe_link, \"attach_uprobe\"))\n\t\tgoto cleanup;\n\tskel->links.handle_uprobe = uprobe_link;\n\n\t \n\ttrigger_func();\n\n\tif (!ASSERT_EQ(skel->bss->uprobe_res, 1, \"check_uprobe_res\"))\n\t\tgoto cleanup;\n\n\tmatch = !memcmp(&skel->bss->current_regs, &skel->bss->ctx_regs,\n\t\t\tsizeof(skel->bss->current_regs));\n\tASSERT_TRUE(match, \"check_regs_match\");\n\ncleanup:\n\ttest_task_pt_regs__destroy(skel);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}