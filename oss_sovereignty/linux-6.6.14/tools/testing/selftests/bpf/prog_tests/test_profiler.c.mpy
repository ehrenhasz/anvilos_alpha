{
  "module_name": "test_profiler.c",
  "hash_id": "183f5b5117a302a74053543eee20ccf499bcfb29c24ab90b636371cbb775bd9d",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/test_profiler.c",
  "human_readable_source": "\n \n#include <test_progs.h>\n#include \"progs/profiler.h\"\n#include \"profiler1.skel.h\"\n#include \"profiler2.skel.h\"\n#include \"profiler3.skel.h\"\n\nstatic int sanity_run(struct bpf_program *prog)\n{\n\tLIBBPF_OPTS(bpf_test_run_opts, test_attr);\n\t__u64 args[] = {1, 2, 3};\n\tint err, prog_fd;\n\n\tprog_fd = bpf_program__fd(prog);\n\ttest_attr.ctx_in = args;\n\ttest_attr.ctx_size_in = sizeof(args);\n\terr = bpf_prog_test_run_opts(prog_fd, &test_attr);\n\tif (!ASSERT_OK(err, \"test_run\"))\n\t\treturn -1;\n\n\tif (!ASSERT_OK(test_attr.retval, \"test_run retval\"))\n\t\treturn -1;\n\n\treturn 0;\n}\n\nvoid test_test_profiler(void)\n{\n\tstruct profiler1 *profiler1_skel = NULL;\n\tstruct profiler2 *profiler2_skel = NULL;\n\tstruct profiler3 *profiler3_skel = NULL;\n\t__u32 duration = 0;\n\tint err;\n\n\tprofiler1_skel = profiler1__open_and_load();\n\tif (CHECK(!profiler1_skel, \"profiler1_skel_load\", \"profiler1 skeleton failed\\n\"))\n\t\tgoto cleanup;\n\n\terr = profiler1__attach(profiler1_skel);\n\tif (CHECK(err, \"profiler1_attach\", \"profiler1 attach failed: %d\\n\", err))\n\t\tgoto cleanup;\n\n\tif (sanity_run(profiler1_skel->progs.raw_tracepoint__sched_process_exec))\n\t\tgoto cleanup;\n\n\tprofiler2_skel = profiler2__open_and_load();\n\tif (CHECK(!profiler2_skel, \"profiler2_skel_load\", \"profiler2 skeleton failed\\n\"))\n\t\tgoto cleanup;\n\n\terr = profiler2__attach(profiler2_skel);\n\tif (CHECK(err, \"profiler2_attach\", \"profiler2 attach failed: %d\\n\", err))\n\t\tgoto cleanup;\n\n\tif (sanity_run(profiler2_skel->progs.raw_tracepoint__sched_process_exec))\n\t\tgoto cleanup;\n\n\tprofiler3_skel = profiler3__open_and_load();\n\tif (CHECK(!profiler3_skel, \"profiler3_skel_load\", \"profiler3 skeleton failed\\n\"))\n\t\tgoto cleanup;\n\n\terr = profiler3__attach(profiler3_skel);\n\tif (CHECK(err, \"profiler3_attach\", \"profiler3 attach failed: %d\\n\", err))\n\t\tgoto cleanup;\n\n\tif (sanity_run(profiler3_skel->progs.raw_tracepoint__sched_process_exec))\n\t\tgoto cleanup;\ncleanup:\n\tprofiler1__destroy(profiler1_skel);\n\tprofiler2__destroy(profiler2_skel);\n\tprofiler3__destroy(profiler3_skel);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}