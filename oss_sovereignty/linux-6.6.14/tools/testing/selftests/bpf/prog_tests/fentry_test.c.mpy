{
  "module_name": "fentry_test.c",
  "hash_id": "1796f0c7970f7d6c339b122c722d5ccbadef1d706ea0dd1fe68a748f27957616",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/fentry_test.c",
  "human_readable_source": "\n \n#include <test_progs.h>\n#include \"fentry_test.lskel.h\"\n#include \"fentry_many_args.skel.h\"\n\nstatic int fentry_test_common(struct fentry_test_lskel *fentry_skel)\n{\n\tint err, prog_fd, i;\n\tint link_fd;\n\t__u64 *result;\n\tLIBBPF_OPTS(bpf_test_run_opts, topts);\n\n\terr = fentry_test_lskel__attach(fentry_skel);\n\tif (!ASSERT_OK(err, \"fentry_attach\"))\n\t\treturn err;\n\n\t \n\tlink_fd = fentry_test_lskel__test1__attach(fentry_skel);\n\tif (!ASSERT_LT(link_fd, 0, \"fentry_attach_link\"))\n\t\treturn -1;\n\n\tprog_fd = fentry_skel->progs.test1.prog_fd;\n\terr = bpf_prog_test_run_opts(prog_fd, &topts);\n\tASSERT_OK(err, \"test_run\");\n\tASSERT_EQ(topts.retval, 0, \"test_run\");\n\n\tresult = (__u64 *)fentry_skel->bss;\n\tfor (i = 0; i < sizeof(*fentry_skel->bss) / sizeof(__u64); i++) {\n\t\tif (!ASSERT_EQ(result[i], 1, \"fentry_result\"))\n\t\t\treturn -1;\n\t}\n\n\tfentry_test_lskel__detach(fentry_skel);\n\n\t \n\tmemset(fentry_skel->bss, 0, sizeof(*fentry_skel->bss));\n\treturn 0;\n}\n\nstatic void fentry_test(void)\n{\n\tstruct fentry_test_lskel *fentry_skel = NULL;\n\tint err;\n\n\tfentry_skel = fentry_test_lskel__open_and_load();\n\tif (!ASSERT_OK_PTR(fentry_skel, \"fentry_skel_load\"))\n\t\tgoto cleanup;\n\n\terr = fentry_test_common(fentry_skel);\n\tif (!ASSERT_OK(err, \"fentry_first_attach\"))\n\t\tgoto cleanup;\n\n\terr = fentry_test_common(fentry_skel);\n\tASSERT_OK(err, \"fentry_second_attach\");\n\ncleanup:\n\tfentry_test_lskel__destroy(fentry_skel);\n}\n\nstatic void fentry_many_args(void)\n{\n\tstruct fentry_many_args *fentry_skel = NULL;\n\tint err;\n\n\tfentry_skel = fentry_many_args__open_and_load();\n\tif (!ASSERT_OK_PTR(fentry_skel, \"fentry_many_args_skel_load\"))\n\t\tgoto cleanup;\n\n\terr = fentry_many_args__attach(fentry_skel);\n\tif (!ASSERT_OK(err, \"fentry_many_args_attach\"))\n\t\tgoto cleanup;\n\n\tASSERT_OK(trigger_module_test_read(1), \"trigger_read\");\n\n\tASSERT_EQ(fentry_skel->bss->test1_result, 1,\n\t\t  \"fentry_many_args_result1\");\n\tASSERT_EQ(fentry_skel->bss->test2_result, 1,\n\t\t  \"fentry_many_args_result2\");\n\tASSERT_EQ(fentry_skel->bss->test3_result, 1,\n\t\t  \"fentry_many_args_result3\");\n\ncleanup:\n\tfentry_many_args__destroy(fentry_skel);\n}\n\nvoid test_fentry_test(void)\n{\n\tif (test__start_subtest(\"fentry\"))\n\t\tfentry_test();\n\tif (test__start_subtest(\"fentry_many_args\"))\n\t\tfentry_many_args();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}