{
  "module_name": "snprintf.c",
  "hash_id": "729f746ef5c91561b3d96aeba5c7c5187981a4e670f1baacb2e2d277541dc5b6",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/snprintf.c",
  "human_readable_source": "\n \n\n#include <test_progs.h>\n#include \"test_snprintf.skel.h\"\n#include \"test_snprintf_single.skel.h\"\n\n#define EXP_NUM_OUT  \"-8 9 96 -424242 1337 DABBAD00\"\n#define EXP_NUM_RET  sizeof(EXP_NUM_OUT)\n\n#define EXP_IP_OUT   \"127.000.000.001 0000:0000:0000:0000:0000:0000:0000:0001\"\n#define EXP_IP_RET   sizeof(EXP_IP_OUT)\n\n \n#define EXP_SYM_OUT  \"schedule schedule+0x0/\"\n#define MIN_SYM_RET  sizeof(EXP_SYM_OUT)\n\n \n#define EXP_ADDR_OUT \"0000000000000000 ffff00000add4e55 \"\n#define EXP_ADDR_RET sizeof(EXP_ADDR_OUT \"unknownhashedptr\")\n\n#define EXP_STR_OUT  \"str1         a  b c      d e longstr\"\n#define EXP_STR_RET  sizeof(EXP_STR_OUT)\n\n#define EXP_OVER_OUT \"%over\"\n#define EXP_OVER_RET 10\n\n#define EXP_PAD_OUT \"    4 000\"\n#define EXP_PAD_RET 900007\n\n#define EXP_NO_ARG_OUT \"simple case\"\n#define EXP_NO_ARG_RET 12\n\n#define EXP_NO_BUF_RET 29\n\nstatic void test_snprintf_positive(void)\n{\n\tchar exp_addr_out[] = EXP_ADDR_OUT;\n\tchar exp_sym_out[]  = EXP_SYM_OUT;\n\tstruct test_snprintf *skel;\n\n\tskel = test_snprintf__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"skel_open\"))\n\t\treturn;\n\n\tskel->bss->pid = getpid();\n\n\tif (!ASSERT_OK(test_snprintf__attach(skel), \"skel_attach\"))\n\t\tgoto cleanup;\n\n\t \n\tusleep(1);\n\n\tASSERT_STREQ(skel->bss->num_out, EXP_NUM_OUT, \"num_out\");\n\tASSERT_EQ(skel->bss->num_ret, EXP_NUM_RET, \"num_ret\");\n\n\tASSERT_STREQ(skel->bss->ip_out, EXP_IP_OUT, \"ip_out\");\n\tASSERT_EQ(skel->bss->ip_ret, EXP_IP_RET, \"ip_ret\");\n\n\tASSERT_OK(memcmp(skel->bss->sym_out, exp_sym_out,\n\t\t\t sizeof(exp_sym_out) - 1), \"sym_out\");\n\tASSERT_LT(MIN_SYM_RET, skel->bss->sym_ret, \"sym_ret\");\n\n\tASSERT_OK(memcmp(skel->bss->addr_out, exp_addr_out,\n\t\t\t sizeof(exp_addr_out) - 1), \"addr_out\");\n\tASSERT_EQ(skel->bss->addr_ret, EXP_ADDR_RET, \"addr_ret\");\n\n\tASSERT_STREQ(skel->bss->str_out, EXP_STR_OUT, \"str_out\");\n\tASSERT_EQ(skel->bss->str_ret, EXP_STR_RET, \"str_ret\");\n\n\tASSERT_STREQ(skel->bss->over_out, EXP_OVER_OUT, \"over_out\");\n\tASSERT_EQ(skel->bss->over_ret, EXP_OVER_RET, \"over_ret\");\n\n\tASSERT_STREQ(skel->bss->pad_out, EXP_PAD_OUT, \"pad_out\");\n\tASSERT_EQ(skel->bss->pad_ret, EXP_PAD_RET, \"pad_ret\");\n\n\tASSERT_STREQ(skel->bss->noarg_out, EXP_NO_ARG_OUT, \"no_arg_out\");\n\tASSERT_EQ(skel->bss->noarg_ret, EXP_NO_ARG_RET, \"no_arg_ret\");\n\n\tASSERT_EQ(skel->bss->nobuf_ret, EXP_NO_BUF_RET, \"no_buf_ret\");\n\ncleanup:\n\ttest_snprintf__destroy(skel);\n}\n\n \nstatic int load_single_snprintf(char *fmt)\n{\n\tstruct test_snprintf_single *skel;\n\tint ret;\n\n\tskel = test_snprintf_single__open();\n\tif (!skel)\n\t\treturn -EINVAL;\n\n\tmemcpy(skel->rodata->fmt, fmt, MIN(strlen(fmt) + 1, 10));\n\n\tret = test_snprintf_single__load(skel);\n\ttest_snprintf_single__destroy(skel);\n\n\treturn ret;\n}\n\nstatic void test_snprintf_negative(void)\n{\n\tASSERT_OK(load_single_snprintf(\"valid %d\"), \"valid usage\");\n\n\tASSERT_ERR(load_single_snprintf(\"0123456789\"), \"no terminating zero\");\n\tASSERT_ERR(load_single_snprintf(\"%d %d\"), \"too many specifiers\");\n\tASSERT_ERR(load_single_snprintf(\"%pi5\"), \"invalid specifier 1\");\n\tASSERT_ERR(load_single_snprintf(\"%a\"), \"invalid specifier 2\");\n\tASSERT_ERR(load_single_snprintf(\"%\"), \"invalid specifier 3\");\n\tASSERT_ERR(load_single_snprintf(\"%12345678\"), \"invalid specifier 4\");\n\tASSERT_ERR(load_single_snprintf(\"%--------\"), \"invalid specifier 5\");\n\tASSERT_ERR(load_single_snprintf(\"%lc\"), \"invalid specifier 6\");\n\tASSERT_ERR(load_single_snprintf(\"%llc\"), \"invalid specifier 7\");\n\tASSERT_ERR(load_single_snprintf(\"\\x80\"), \"non ascii character\");\n\tASSERT_ERR(load_single_snprintf(\"\\x1\"), \"non printable character\");\n}\n\nvoid test_snprintf(void)\n{\n\tif (test__start_subtest(\"snprintf_positive\"))\n\t\ttest_snprintf_positive();\n\tif (test__start_subtest(\"snprintf_negative\"))\n\t\ttest_snprintf_negative();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}