{
  "module_name": "probe_read_user_str.c",
  "hash_id": "bbf1510e1934e61c467e7893f8cbfffbafcf4d4c76cab25428fb6ff0c8489bd7",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/probe_read_user_str.c",
  "human_readable_source": "\n#include <test_progs.h>\n#include \"test_probe_read_user_str.skel.h\"\n\nstatic const char str1[] = \"mestring\";\nstatic const char str2[] = \"mestringalittlebigger\";\nstatic const char str3[] = \"mestringblubblubblubblubblub\";\n\nstatic int test_one_str(struct test_probe_read_user_str *skel, const char *str,\n\t\t\tsize_t len)\n{\n\tint err, duration = 0;\n\tchar buf[256];\n\n\t \n\tmemset(buf, 1, sizeof(buf));\n\tmemcpy(buf, str, len);\n\n\t \n\tskel->bss->user_ptr = buf;\n\n\t \n\tusleep(1);\n\n\t \n\tif (CHECK(skel->bss->ret < 0, \"prog_ret\", \"prog returned: %ld\\n\",\n\t\t  skel->bss->ret))\n\t\treturn 1;\n\n\t \n\terr = memcmp(skel->bss->buf, str, len);\n\tif (CHECK(err, \"memcmp\", \"prog copied wrong string\"))\n\t\treturn 1;\n\n\t \n\tmemset(buf, 0, sizeof(buf));\n\terr = memcmp(skel->bss->buf + len, buf, sizeof(buf) - len);\n\tif (CHECK(err, \"memcmp\", \"trailing bytes were not stripped\"))\n\t\treturn 1;\n\n\treturn 0;\n}\n\nvoid test_probe_read_user_str(void)\n{\n\tstruct test_probe_read_user_str *skel;\n\tint err, duration = 0;\n\n\tskel = test_probe_read_user_str__open_and_load();\n\tif (CHECK(!skel, \"test_probe_read_user_str__open_and_load\",\n\t\t  \"skeleton open and load failed\\n\"))\n\t\treturn;\n\n\t \n\tskel->bss->pid = getpid();\n\n\terr = test_probe_read_user_str__attach(skel);\n\tif (CHECK(err, \"test_probe_read_user_str__attach\",\n\t\t  \"skeleton attach failed: %d\\n\", err))\n\t\tgoto out;\n\n\tif (test_one_str(skel, str1, sizeof(str1)))\n\t\tgoto out;\n\tif (test_one_str(skel, str2, sizeof(str2)))\n\t\tgoto out;\n\tif (test_one_str(skel, str3, sizeof(str3)))\n\t\tgoto out;\n\nout:\n\ttest_probe_read_user_str__destroy(skel);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}