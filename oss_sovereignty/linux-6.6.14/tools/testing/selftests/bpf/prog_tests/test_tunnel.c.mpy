{
  "module_name": "test_tunnel.c",
  "hash_id": "c250c9c4b8c4411157b4f148b112281726c6285bd86125a9d3d859dc5110eacf",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/test_tunnel.c",
  "human_readable_source": "\n\n \n\n#include <arpa/inet.h>\n#include <linux/if_tun.h>\n#include <linux/limits.h>\n#include <linux/sysctl.h>\n#include <linux/time_types.h>\n#include <linux/net_tstamp.h>\n#include <net/if.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <sys/stat.h>\n#include <unistd.h>\n\n#include \"test_progs.h\"\n#include \"network_helpers.h\"\n#include \"test_tunnel_kern.skel.h\"\n\n#define IP4_ADDR_VETH0 \"172.16.1.100\"\n#define IP4_ADDR1_VETH1 \"172.16.1.200\"\n#define IP4_ADDR2_VETH1 \"172.16.1.20\"\n#define IP4_ADDR_TUNL_DEV0 \"10.1.1.100\"\n#define IP4_ADDR_TUNL_DEV1 \"10.1.1.200\"\n\n#define IP6_ADDR_VETH0 \"::11\"\n#define IP6_ADDR1_VETH1 \"::22\"\n#define IP6_ADDR2_VETH1 \"::bb\"\n\n#define IP4_ADDR1_HEX_VETH1 0xac1001c8\n#define IP4_ADDR2_HEX_VETH1 0xac100114\n#define IP6_ADDR1_HEX_VETH1 0x22\n#define IP6_ADDR2_HEX_VETH1 0xbb\n\n#define MAC_TUNL_DEV0 \"52:54:00:d9:01:00\"\n#define MAC_TUNL_DEV1 \"52:54:00:d9:02:00\"\n#define MAC_VETH1 \"52:54:00:d9:03:00\"\n\n#define VXLAN_TUNL_DEV0 \"vxlan00\"\n#define VXLAN_TUNL_DEV1 \"vxlan11\"\n#define IP6VXLAN_TUNL_DEV0 \"ip6vxlan00\"\n#define IP6VXLAN_TUNL_DEV1 \"ip6vxlan11\"\n\n#define IPIP_TUNL_DEV0 \"ipip00\"\n#define IPIP_TUNL_DEV1 \"ipip11\"\n\n#define PING_ARGS \"-i 0.01 -c 3 -w 10 -q\"\n\nstatic int config_device(void)\n{\n\tSYS(fail, \"ip netns add at_ns0\");\n\tSYS(fail, \"ip link add veth0 address \" MAC_VETH1 \" type veth peer name veth1\");\n\tSYS(fail, \"ip link set veth0 netns at_ns0\");\n\tSYS(fail, \"ip addr add \" IP4_ADDR1_VETH1 \"/24 dev veth1\");\n\tSYS(fail, \"ip link set dev veth1 up mtu 1500\");\n\tSYS(fail, \"ip netns exec at_ns0 ip addr add \" IP4_ADDR_VETH0 \"/24 dev veth0\");\n\tSYS(fail, \"ip netns exec at_ns0 ip link set dev veth0 up mtu 1500\");\n\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic void cleanup(void)\n{\n\tSYS_NOFAIL(\"test -f /var/run/netns/at_ns0 && ip netns delete at_ns0\");\n\tSYS_NOFAIL(\"ip link del veth1 2> /dev/null\");\n\tSYS_NOFAIL(\"ip link del %s 2> /dev/null\", VXLAN_TUNL_DEV1);\n\tSYS_NOFAIL(\"ip link del %s 2> /dev/null\", IP6VXLAN_TUNL_DEV1);\n}\n\nstatic int add_vxlan_tunnel(void)\n{\n\t \n\tSYS(fail, \"ip netns exec at_ns0 ip link add dev %s type vxlan external gbp dstport 4789\",\n\t    VXLAN_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip link set dev %s address %s up\",\n\t    VXLAN_TUNL_DEV0, MAC_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip addr add dev %s %s/24\",\n\t    VXLAN_TUNL_DEV0, IP4_ADDR_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip neigh add %s lladdr %s dev %s\",\n\t    IP4_ADDR_TUNL_DEV1, MAC_TUNL_DEV1, VXLAN_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip neigh add %s lladdr %s dev veth0\",\n\t    IP4_ADDR2_VETH1, MAC_VETH1);\n\n\t \n\tSYS(fail, \"ip link add dev %s type vxlan external gbp dstport 4789\",\n\t    VXLAN_TUNL_DEV1);\n\tSYS(fail, \"ip link set dev %s address %s up\", VXLAN_TUNL_DEV1, MAC_TUNL_DEV1);\n\tSYS(fail, \"ip addr add dev %s %s/24\", VXLAN_TUNL_DEV1, IP4_ADDR_TUNL_DEV1);\n\tSYS(fail, \"ip neigh add %s lladdr %s dev %s\",\n\t    IP4_ADDR_TUNL_DEV0, MAC_TUNL_DEV0, VXLAN_TUNL_DEV1);\n\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic void delete_vxlan_tunnel(void)\n{\n\tSYS_NOFAIL(\"ip netns exec at_ns0 ip link delete dev %s\",\n\t\t   VXLAN_TUNL_DEV0);\n\tSYS_NOFAIL(\"ip link delete dev %s\", VXLAN_TUNL_DEV1);\n}\n\nstatic int add_ip6vxlan_tunnel(void)\n{\n\tSYS(fail, \"ip netns exec at_ns0 ip -6 addr add %s/96 dev veth0\",\n\t    IP6_ADDR_VETH0);\n\tSYS(fail, \"ip netns exec at_ns0 ip link set dev veth0 up\");\n\tSYS(fail, \"ip -6 addr add %s/96 dev veth1\", IP6_ADDR1_VETH1);\n\tSYS(fail, \"ip -6 addr add %s/96 dev veth1\", IP6_ADDR2_VETH1);\n\tSYS(fail, \"ip link set dev veth1 up\");\n\n\t \n\tSYS(fail, \"ip netns exec at_ns0 ip link add dev %s type vxlan external dstport 4789\",\n\t    IP6VXLAN_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip addr add dev %s %s/24\",\n\t    IP6VXLAN_TUNL_DEV0, IP4_ADDR_TUNL_DEV0);\n\tSYS(fail, \"ip netns exec at_ns0 ip link set dev %s address %s up\",\n\t    IP6VXLAN_TUNL_DEV0, MAC_TUNL_DEV0);\n\n\t \n\tSYS(fail, \"ip link add dev %s type vxlan external dstport 4789\",\n\t    IP6VXLAN_TUNL_DEV1);\n\tSYS(fail, \"ip addr add dev %s %s/24\", IP6VXLAN_TUNL_DEV1, IP4_ADDR_TUNL_DEV1);\n\tSYS(fail, \"ip link set dev %s address %s up\",\n\t    IP6VXLAN_TUNL_DEV1, MAC_TUNL_DEV1);\n\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic void delete_ip6vxlan_tunnel(void)\n{\n\tSYS_NOFAIL(\"ip netns exec at_ns0 ip -6 addr delete %s/96 dev veth0\",\n\t\t   IP6_ADDR_VETH0);\n\tSYS_NOFAIL(\"ip -6 addr delete %s/96 dev veth1\", IP6_ADDR1_VETH1);\n\tSYS_NOFAIL(\"ip -6 addr delete %s/96 dev veth1\", IP6_ADDR2_VETH1);\n\tSYS_NOFAIL(\"ip netns exec at_ns0 ip link delete dev %s\",\n\t\t   IP6VXLAN_TUNL_DEV0);\n\tSYS_NOFAIL(\"ip link delete dev %s\", IP6VXLAN_TUNL_DEV1);\n}\n\nenum ipip_encap {\n\tNONE\t= 0,\n\tFOU\t= 1,\n\tGUE\t= 2,\n};\n\nstatic int set_ipip_encap(const char *ipproto, const char *type)\n{\n\tSYS(fail, \"ip -n at_ns0 fou add port 5555 %s\", ipproto);\n\tSYS(fail, \"ip -n at_ns0 link set dev %s type ipip encap %s\",\n\t    IPIP_TUNL_DEV0, type);\n\tSYS(fail, \"ip -n at_ns0 link set dev %s type ipip encap-dport 5555\",\n\t    IPIP_TUNL_DEV0);\n\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic int add_ipip_tunnel(enum ipip_encap encap)\n{\n\tint err;\n\tconst char *ipproto, *type;\n\n\tswitch (encap) {\n\tcase FOU:\n\t\tipproto = \"ipproto 4\";\n\t\ttype = \"fou\";\n\t\tbreak;\n\tcase GUE:\n\t\tipproto = \"gue\";\n\t\ttype = ipproto;\n\t\tbreak;\n\tdefault:\n\t\tipproto = NULL;\n\t\ttype = ipproto;\n\t}\n\n\t \n\tSYS(fail, \"ip -n at_ns0 link add dev %s type ipip local %s remote %s\",\n\t    IPIP_TUNL_DEV0, IP4_ADDR_VETH0, IP4_ADDR1_VETH1);\n\n\tif (type && ipproto) {\n\t\terr = set_ipip_encap(ipproto, type);\n\t\tif (!ASSERT_OK(err, \"set_ipip_encap\"))\n\t\t\tgoto fail;\n\t}\n\n\tSYS(fail, \"ip -n at_ns0 link set dev %s up\", IPIP_TUNL_DEV0);\n\tSYS(fail, \"ip -n at_ns0 addr add dev %s %s/24\",\n\t    IPIP_TUNL_DEV0, IP4_ADDR_TUNL_DEV0);\n\n\t \n\tif (type && ipproto)\n\t\tSYS(fail, \"ip fou add port 5555 %s\", ipproto);\n\tSYS(fail, \"ip link add dev %s type ipip external\", IPIP_TUNL_DEV1);\n\tSYS(fail, \"ip link set dev %s up\", IPIP_TUNL_DEV1);\n\tSYS(fail, \"ip addr add dev %s %s/24\", IPIP_TUNL_DEV1,\n\t    IP4_ADDR_TUNL_DEV1);\n\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic void delete_ipip_tunnel(void)\n{\n\tSYS_NOFAIL(\"ip -n at_ns0 link delete dev %s\", IPIP_TUNL_DEV0);\n\tSYS_NOFAIL(\"ip -n at_ns0 fou del port 5555 2> /dev/null\");\n\tSYS_NOFAIL(\"ip link delete dev %s\", IPIP_TUNL_DEV1);\n\tSYS_NOFAIL(\"ip fou del port 5555 2> /dev/null\");\n}\n\nstatic int test_ping(int family, const char *addr)\n{\n\tSYS(fail, \"%s %s %s > /dev/null\", ping_command(family), PING_ARGS, addr);\n\treturn 0;\nfail:\n\treturn -1;\n}\n\nstatic int attach_tc_prog(struct bpf_tc_hook *hook, int igr_fd, int egr_fd)\n{\n\tDECLARE_LIBBPF_OPTS(bpf_tc_opts, opts1, .handle = 1,\n\t\t\t    .priority = 1, .prog_fd = igr_fd);\n\tDECLARE_LIBBPF_OPTS(bpf_tc_opts, opts2, .handle = 1,\n\t\t\t    .priority = 1, .prog_fd = egr_fd);\n\tint ret;\n\n\tret = bpf_tc_hook_create(hook);\n\tif (!ASSERT_OK(ret, \"create tc hook\"))\n\t\treturn ret;\n\n\tif (igr_fd >= 0) {\n\t\thook->attach_point = BPF_TC_INGRESS;\n\t\tret = bpf_tc_attach(hook, &opts1);\n\t\tif (!ASSERT_OK(ret, \"bpf_tc_attach\")) {\n\t\t\tbpf_tc_hook_destroy(hook);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tif (egr_fd >= 0) {\n\t\thook->attach_point = BPF_TC_EGRESS;\n\t\tret = bpf_tc_attach(hook, &opts2);\n\t\tif (!ASSERT_OK(ret, \"bpf_tc_attach\")) {\n\t\t\tbpf_tc_hook_destroy(hook);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic void test_vxlan_tunnel(void)\n{\n\tstruct test_tunnel_kern *skel = NULL;\n\tstruct nstoken *nstoken;\n\tint local_ip_map_fd = -1;\n\tint set_src_prog_fd, get_src_prog_fd;\n\tint set_dst_prog_fd;\n\tint key = 0, ifindex = -1;\n\tuint local_ip;\n\tint err;\n\tDECLARE_LIBBPF_OPTS(bpf_tc_hook, tc_hook,\n\t\t\t    .attach_point = BPF_TC_INGRESS);\n\n\t \n\terr = add_vxlan_tunnel();\n\tif (!ASSERT_OK(err, \"add vxlan tunnel\"))\n\t\tgoto done;\n\n\t \n\tskel = test_tunnel_kern__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"test_tunnel_kern__open_and_load\"))\n\t\tgoto done;\n\tifindex = if_nametoindex(VXLAN_TUNL_DEV1);\n\tif (!ASSERT_NEQ(ifindex, 0, \"vxlan11 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\tget_src_prog_fd = bpf_program__fd(skel->progs.vxlan_get_tunnel_src);\n\tset_src_prog_fd = bpf_program__fd(skel->progs.vxlan_set_tunnel_src);\n\tif (!ASSERT_GE(get_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (!ASSERT_GE(set_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, get_src_prog_fd, set_src_prog_fd))\n\t\tgoto done;\n\n\t \n\tifindex = if_nametoindex(\"veth1\");\n\tif (!ASSERT_NEQ(ifindex, 0, \"veth1 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\tset_dst_prog_fd = bpf_program__fd(skel->progs.veth_set_outer_dst);\n\tif (!ASSERT_GE(set_dst_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, set_dst_prog_fd, -1))\n\t\tgoto done;\n\n\t \n\tnstoken = open_netns(\"at_ns0\");\n\tif (!ASSERT_OK_PTR(nstoken, \"setns src\"))\n\t\tgoto done;\n\tifindex = if_nametoindex(VXLAN_TUNL_DEV0);\n\tif (!ASSERT_NEQ(ifindex, 0, \"vxlan00 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\tset_dst_prog_fd = bpf_program__fd(skel->progs.vxlan_set_tunnel_dst);\n\tif (!ASSERT_GE(set_dst_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, -1, set_dst_prog_fd))\n\t\tgoto done;\n\tclose_netns(nstoken);\n\n\t \n\tlocal_ip_map_fd = bpf_map__fd(skel->maps.local_ip_map);\n\tif (!ASSERT_GE(local_ip_map_fd, 0, \"bpf_map__fd\"))\n\t\tgoto done;\n\tlocal_ip = IP4_ADDR2_HEX_VETH1;\n\terr = bpf_map_update_elem(local_ip_map_fd, &key, &local_ip, BPF_ANY);\n\tif (!ASSERT_OK(err, \"update bpf local_ip_map\"))\n\t\tgoto done;\n\n\t \n\terr = test_ping(AF_INET, IP4_ADDR_TUNL_DEV0);\n\tif (!ASSERT_OK(err, \"test_ping\"))\n\t\tgoto done;\n\ndone:\n\t \n\tdelete_vxlan_tunnel();\n\tif (local_ip_map_fd >= 0)\n\t\tclose(local_ip_map_fd);\n\tif (skel)\n\t\ttest_tunnel_kern__destroy(skel);\n}\n\nstatic void test_ip6vxlan_tunnel(void)\n{\n\tstruct test_tunnel_kern *skel = NULL;\n\tstruct nstoken *nstoken;\n\tint local_ip_map_fd = -1;\n\tint set_src_prog_fd, get_src_prog_fd;\n\tint set_dst_prog_fd;\n\tint key = 0, ifindex = -1;\n\tuint local_ip;\n\tint err;\n\tDECLARE_LIBBPF_OPTS(bpf_tc_hook, tc_hook,\n\t\t\t    .attach_point = BPF_TC_INGRESS);\n\n\t \n\terr = add_ip6vxlan_tunnel();\n\tif (!ASSERT_OK(err, \"add_ip6vxlan_tunnel\"))\n\t\tgoto done;\n\n\t \n\tskel = test_tunnel_kern__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"test_tunnel_kern__open_and_load\"))\n\t\tgoto done;\n\tifindex = if_nametoindex(IP6VXLAN_TUNL_DEV1);\n\tif (!ASSERT_NEQ(ifindex, 0, \"ip6vxlan11 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\tget_src_prog_fd = bpf_program__fd(skel->progs.ip6vxlan_get_tunnel_src);\n\tset_src_prog_fd = bpf_program__fd(skel->progs.ip6vxlan_set_tunnel_src);\n\tif (!ASSERT_GE(set_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (!ASSERT_GE(get_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, get_src_prog_fd, set_src_prog_fd))\n\t\tgoto done;\n\n\t \n\tnstoken = open_netns(\"at_ns0\");\n\tif (!ASSERT_OK_PTR(nstoken, \"setns src\"))\n\t\tgoto done;\n\tifindex = if_nametoindex(IP6VXLAN_TUNL_DEV0);\n\tif (!ASSERT_NEQ(ifindex, 0, \"ip6vxlan00 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\tset_dst_prog_fd = bpf_program__fd(skel->progs.ip6vxlan_set_tunnel_dst);\n\tif (!ASSERT_GE(set_dst_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, -1, set_dst_prog_fd))\n\t\tgoto done;\n\tclose_netns(nstoken);\n\n\t \n\tlocal_ip_map_fd = bpf_map__fd(skel->maps.local_ip_map);\n\tif (!ASSERT_GE(local_ip_map_fd, 0, \"get local_ip_map fd\"))\n\t\tgoto done;\n\tlocal_ip = IP6_ADDR2_HEX_VETH1;\n\terr = bpf_map_update_elem(local_ip_map_fd, &key, &local_ip, BPF_ANY);\n\tif (!ASSERT_OK(err, \"update bpf local_ip_map\"))\n\t\tgoto done;\n\n\t \n\terr = test_ping(AF_INET, IP4_ADDR_TUNL_DEV0);\n\tif (!ASSERT_OK(err, \"test_ping\"))\n\t\tgoto done;\n\ndone:\n\t \n\tdelete_ip6vxlan_tunnel();\n\tif (local_ip_map_fd >= 0)\n\t\tclose(local_ip_map_fd);\n\tif (skel)\n\t\ttest_tunnel_kern__destroy(skel);\n}\n\nstatic void test_ipip_tunnel(enum ipip_encap encap)\n{\n\tstruct test_tunnel_kern *skel = NULL;\n\tstruct nstoken *nstoken;\n\tint set_src_prog_fd, get_src_prog_fd;\n\tint ifindex = -1;\n\tint err;\n\tDECLARE_LIBBPF_OPTS(bpf_tc_hook, tc_hook,\n\t\t\t    .attach_point = BPF_TC_INGRESS);\n\n\t \n\terr = add_ipip_tunnel(encap);\n\tif (!ASSERT_OK(err, \"add_ipip_tunnel\"))\n\t\tgoto done;\n\n\t \n\tskel = test_tunnel_kern__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"test_tunnel_kern__open_and_load\"))\n\t\tgoto done;\n\tifindex = if_nametoindex(IPIP_TUNL_DEV1);\n\tif (!ASSERT_NEQ(ifindex, 0, \"ipip11 ifindex\"))\n\t\tgoto done;\n\ttc_hook.ifindex = ifindex;\n\n\tswitch (encap) {\n\tcase FOU:\n\t\tget_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_encap_get_tunnel);\n\t\tset_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_fou_set_tunnel);\n\t\tbreak;\n\tcase GUE:\n\t\tget_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_encap_get_tunnel);\n\t\tset_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_gue_set_tunnel);\n\t\tbreak;\n\tdefault:\n\t\tget_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_get_tunnel);\n\t\tset_src_prog_fd = bpf_program__fd(\n\t\t\tskel->progs.ipip_set_tunnel);\n\t}\n\n\tif (!ASSERT_GE(set_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (!ASSERT_GE(get_src_prog_fd, 0, \"bpf_program__fd\"))\n\t\tgoto done;\n\tif (attach_tc_prog(&tc_hook, get_src_prog_fd, set_src_prog_fd))\n\t\tgoto done;\n\n\t \n\terr = test_ping(AF_INET, IP4_ADDR_TUNL_DEV0);\n\tif (!ASSERT_OK(err, \"test_ping\"))\n\t\tgoto done;\n\n\t \n\tnstoken = open_netns(\"at_ns0\");\n\terr = test_ping(AF_INET, IP4_ADDR_TUNL_DEV1);\n\tif (!ASSERT_OK(err, \"test_ping\"))\n\t\tgoto done;\n\tclose_netns(nstoken);\n\ndone:\n\t \n\tdelete_ipip_tunnel();\n\tif (skel)\n\t\ttest_tunnel_kern__destroy(skel);\n}\n\n#define RUN_TEST(name, ...)\t\t\t\t\t\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tif (test__start_subtest(#name)) {\t\t\t\\\n\t\t\ttest_ ## name(__VA_ARGS__);\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t})\n\nstatic void *test_tunnel_run_tests(void *arg)\n{\n\tcleanup();\n\tconfig_device();\n\n\tRUN_TEST(vxlan_tunnel);\n\tRUN_TEST(ip6vxlan_tunnel);\n\tRUN_TEST(ipip_tunnel, NONE);\n\tRUN_TEST(ipip_tunnel, FOU);\n\tRUN_TEST(ipip_tunnel, GUE);\n\n\tcleanup();\n\n\treturn NULL;\n}\n\nvoid test_tunnel(void)\n{\n\tpthread_t test_thread;\n\tint err;\n\n\t \n\terr = pthread_create(&test_thread, NULL, &test_tunnel_run_tests, NULL);\n\tif (ASSERT_OK(err, \"pthread_create\"))\n\t\tASSERT_OK(pthread_join(test_thread, NULL), \"pthread_join\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}