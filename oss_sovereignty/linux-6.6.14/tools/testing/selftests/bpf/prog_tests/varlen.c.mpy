{
  "module_name": "varlen.c",
  "hash_id": "9d2a2ab7dec231ed7308fbe2a61da5bfb431561822e3836b9ef83406a292c688",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/varlen.c",
  "human_readable_source": "\n \n\n#include <test_progs.h>\n#include <time.h>\n#include \"test_varlen.skel.h\"\n\n#define CHECK_VAL(got, exp) \\\n\tCHECK((got) != (exp), \"check\", \"got %ld != exp %ld\\n\", \\\n\t      (long)(got), (long)(exp))\n\nvoid test_varlen(void)\n{\n\tint duration = 0, err;\n\tstruct test_varlen* skel;\n\tstruct test_varlen__bss *bss;\n\tstruct test_varlen__data *data;\n\tconst char str1[] = \"Hello, \";\n\tconst char str2[] = \"World!\";\n\tconst char exp_str[] = \"Hello, \\0World!\\0\";\n\tconst int size1 = sizeof(str1);\n\tconst int size2 = sizeof(str2);\n\n\tskel = test_varlen__open_and_load();\n\tif (CHECK(!skel, \"skel_open\", \"failed to open skeleton\\n\"))\n\t\treturn;\n\tbss = skel->bss;\n\tdata = skel->data;\n\n\terr = test_varlen__attach(skel);\n\tif (CHECK(err, \"skel_attach\", \"skeleton attach failed: %d\\n\", err))\n\t\tgoto cleanup;\n\n\tbss->test_pid = getpid();\n\n\t \n\tmemcpy(bss->buf_in1, str1, size1);\n\tmemcpy(bss->buf_in2, str2, size2);\n\tbss->capture = true;\n\tusleep(1);\n\tbss->capture = false;\n\n\tCHECK_VAL(bss->payload1_len1, size1);\n\tCHECK_VAL(bss->payload1_len2, size2);\n\tCHECK_VAL(bss->total1, size1 + size2);\n\tCHECK(memcmp(bss->payload1, exp_str, size1 + size2), \"content_check\",\n\t      \"doesn't match!\\n\");\n\n\tCHECK_VAL(data->payload2_len1, size1);\n\tCHECK_VAL(data->payload2_len2, size2);\n\tCHECK_VAL(data->total2, size1 + size2);\n\tCHECK(memcmp(data->payload2, exp_str, size1 + size2), \"content_check\",\n\t      \"doesn't match!\\n\");\n\n\tCHECK_VAL(data->payload3_len1, size1);\n\tCHECK_VAL(data->payload3_len2, size2);\n\tCHECK_VAL(data->total3, size1 + size2);\n\tCHECK(memcmp(data->payload3, exp_str, size1 + size2), \"content_check\",\n\t      \"doesn't match!\\n\");\n\n\tCHECK_VAL(data->payload4_len1, size1);\n\tCHECK_VAL(data->payload4_len2, size2);\n\tCHECK_VAL(data->total4, size1 + size2);\n\tCHECK(memcmp(data->payload4, exp_str, size1 + size2), \"content_check\",\n\t      \"doesn't match!\\n\");\n\n\tCHECK_VAL(bss->ret_bad_read, -EFAULT);\n\tCHECK_VAL(data->payload_bad[0], 0x42);\n\tCHECK_VAL(data->payload_bad[1], 0x42);\n\tCHECK_VAL(data->payload_bad[2], 0);\n\tCHECK_VAL(data->payload_bad[3], 0x42);\n\tCHECK_VAL(data->payload_bad[4], 0x42);\ncleanup:\n\ttest_varlen__destroy(skel);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}