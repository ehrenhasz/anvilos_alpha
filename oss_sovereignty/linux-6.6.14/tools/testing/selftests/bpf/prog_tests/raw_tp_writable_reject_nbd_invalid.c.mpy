{
  "module_name": "raw_tp_writable_reject_nbd_invalid.c",
  "hash_id": "f55d50462c5f174af2ad52bca38aa4197668fb416d3fc4a278a9739ba6914774",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/raw_tp_writable_reject_nbd_invalid.c",
  "human_readable_source": "\n\n#include <test_progs.h>\n#include <linux/nbd.h>\n\nvoid test_raw_tp_writable_reject_nbd_invalid(void)\n{\n\t__u32 duration = 0;\n\tchar error[4096];\n\tint bpf_fd = -1, tp_fd = -1;\n\n\tconst struct bpf_insn program[] = {\n\t\t \n\t\tBPF_LDX_MEM(BPF_DW, BPF_REG_6, BPF_REG_1, 0),\n\t\t \n\t\tBPF_LDX_MEM(BPF_B, BPF_REG_0, BPF_REG_6,\n\t\t\t    sizeof(struct nbd_request)),\n\t\tBPF_EXIT_INSN(),\n\t};\n\n\tLIBBPF_OPTS(bpf_prog_load_opts, opts,\n\t\t.log_level = 2,\n\t\t.log_buf = error,\n\t\t.log_size = sizeof(error),\n\t);\n\n\tbpf_fd = bpf_prog_load(BPF_PROG_TYPE_RAW_TRACEPOINT_WRITABLE, NULL, \"GPL v2\",\n\t\t\t       program, sizeof(program) / sizeof(struct bpf_insn),\n\t\t\t       &opts);\n\tif (CHECK(bpf_fd < 0, \"bpf_raw_tracepoint_writable load\",\n\t\t  \"failed: %d errno %d\\n\", bpf_fd, errno))\n\t\treturn;\n\n\ttp_fd = bpf_raw_tracepoint_open(\"nbd_send_request\", bpf_fd);\n\tif (CHECK(tp_fd >= 0, \"bpf_raw_tracepoint_writable open\",\n\t\t  \"erroneously succeeded\\n\"))\n\t\tgoto out_bpffd;\n\n\tclose(tp_fd);\nout_bpffd:\n\tclose(bpf_fd);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}