{
  "module_name": "tc_helpers.h",
  "hash_id": "013275d21e27ecf7a5ba7464aa62b8bc783cabeed1fdad715b7f84410e92ef38",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/tc_helpers.h",
  "human_readable_source": " \n \n#ifndef TC_HELPERS\n#define TC_HELPERS\n#include <test_progs.h>\n\nstatic inline __u32 id_from_prog_fd(int fd)\n{\n\tstruct bpf_prog_info prog_info = {};\n\t__u32 prog_info_len = sizeof(prog_info);\n\tint err;\n\n\terr = bpf_obj_get_info_by_fd(fd, &prog_info, &prog_info_len);\n\tif (!ASSERT_OK(err, \"id_from_prog_fd\"))\n\t\treturn 0;\n\n\tASSERT_NEQ(prog_info.id, 0, \"prog_info.id\");\n\treturn prog_info.id;\n}\n\nstatic inline __u32 id_from_link_fd(int fd)\n{\n\tstruct bpf_link_info link_info = {};\n\t__u32 link_info_len = sizeof(link_info);\n\tint err;\n\n\terr = bpf_link_get_info_by_fd(fd, &link_info, &link_info_len);\n\tif (!ASSERT_OK(err, \"id_from_link_fd\"))\n\t\treturn 0;\n\n\tASSERT_NEQ(link_info.id, 0, \"link_info.id\");\n\treturn link_info.id;\n}\n\nstatic inline __u32 ifindex_from_link_fd(int fd)\n{\n\tstruct bpf_link_info link_info = {};\n\t__u32 link_info_len = sizeof(link_info);\n\tint err;\n\n\terr = bpf_link_get_info_by_fd(fd, &link_info, &link_info_len);\n\tif (!ASSERT_OK(err, \"id_from_link_fd\"))\n\t\treturn 0;\n\n\treturn link_info.tcx.ifindex;\n}\n\nstatic inline void __assert_mprog_count(int target, int expected, int ifindex)\n{\n\t__u32 count = 0, attach_flags = 0;\n\tint err;\n\n\terr = bpf_prog_query(ifindex, target, 0, &attach_flags,\n\t\t\t     NULL, &count);\n\tASSERT_EQ(count, expected, \"count\");\n\tASSERT_EQ(err, 0, \"prog_query\");\n}\n\nstatic inline void assert_mprog_count(int target, int expected)\n{\n\t__assert_mprog_count(target, expected, loopback);\n}\n\nstatic inline void assert_mprog_count_ifindex(int ifindex, int target, int expected)\n{\n\t__assert_mprog_count(target, expected, ifindex);\n}\n\nstatic inline void tc_skel_reset_all_seen(struct test_tc_link *skel)\n{\n\tmemset(skel->bss, 0, sizeof(*skel->bss));\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}