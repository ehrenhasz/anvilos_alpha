{
  "module_name": "cgroup_getset_retval.c",
  "hash_id": "7b2be877fca395ecf73357dd2b71c4af0afde089ff86a03b6308509ec3bea777",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/cgroup_getset_retval.c",
  "human_readable_source": "\n\n \n\n#include <test_progs.h>\n#include <cgroup_helpers.h>\n#include <network_helpers.h>\n\n#include \"cgroup_getset_retval_setsockopt.skel.h\"\n#include \"cgroup_getset_retval_getsockopt.skel.h\"\n#include \"cgroup_getset_retval_hooks.skel.h\"\n\n#define SOL_CUSTOM\t0xdeadbeef\n\nstatic int zero;\n\nstatic void test_setsockopt_set(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_set_eunatch = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eunatch = bpf_program__attach_cgroup(obj->progs.set_eunatch,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eunatch, \"cg-attach-set_eunatch\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EUNATCH, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 1, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eunatch);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_set_and_get(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_set_eunatch = NULL, *link_get_retval = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eunatch = bpf_program__attach_cgroup(obj->progs.set_eunatch,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eunatch, \"cg-attach-set_eunatch\"))\n\t\tgoto close_bpf_object;\n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EUNATCH, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 2, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, -EUNATCH, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eunatch);\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_default_zero(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_get_retval = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_OK(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t  &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 1, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, 0, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_default_zero_and_set(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_get_retval = NULL, *link_set_eunatch = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\tlink_set_eunatch = bpf_program__attach_cgroup(obj->progs.set_eunatch,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eunatch, \"cg-attach-set_eunatch\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EUNATCH, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 2, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, 0, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_get_retval);\n\tbpf_link__destroy(link_set_eunatch);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_override(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_set_eunatch = NULL, *link_set_eisconn = NULL;\n\tstruct bpf_link *link_get_retval = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eunatch = bpf_program__attach_cgroup(obj->progs.set_eunatch,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eunatch, \"cg-attach-set_eunatch\"))\n\t\tgoto close_bpf_object;\n\tlink_set_eisconn = bpf_program__attach_cgroup(obj->progs.set_eisconn,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eisconn, \"cg-attach-set_eisconn\"))\n\t\tgoto close_bpf_object;\n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EISCONN, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 3, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, -EISCONN, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eunatch);\n\tbpf_link__destroy(link_set_eisconn);\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_legacy_eperm(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_legacy_eperm = NULL, *link_get_retval = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_legacy_eperm = bpf_program__attach_cgroup(obj->progs.legacy_eperm,\n\t\t\t\t\t\t       cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_legacy_eperm, \"cg-attach-legacy_eperm\"))\n\t\tgoto close_bpf_object;\n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EPERM, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 2, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, -EPERM, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_legacy_eperm);\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_setsockopt_legacy_no_override(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_setsockopt *obj;\n\tstruct bpf_link *link_set_eunatch = NULL, *link_legacy_eperm = NULL;\n\tstruct bpf_link *link_get_retval = NULL;\n\n\tobj = cgroup_getset_retval_setsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eunatch = bpf_program__attach_cgroup(obj->progs.set_eunatch,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eunatch, \"cg-attach-set_eunatch\"))\n\t\tgoto close_bpf_object;\n\tlink_legacy_eperm = bpf_program__attach_cgroup(obj->progs.legacy_eperm,\n\t\t\t\t\t\t       cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_legacy_eperm, \"cg-attach-legacy_eperm\"))\n\t\tgoto close_bpf_object;\n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(setsockopt(sock_fd, SOL_SOCKET, SO_REUSEADDR,\n\t\t\t\t   &zero, sizeof(int)), \"setsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EUNATCH, \"setsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 3, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, -EUNATCH, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eunatch);\n\tbpf_link__destroy(link_legacy_eperm);\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_setsockopt__destroy(obj);\n}\n\nstatic void test_getsockopt_get(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_getsockopt *obj;\n\tstruct bpf_link *link_get_retval = NULL;\n\tint buf;\n\tsocklen_t optlen = sizeof(buf);\n\n\tobj = cgroup_getset_retval_getsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(getsockopt(sock_fd, SOL_CUSTOM, 0,\n\t\t\t\t   &buf, &optlen), \"getsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EOPNOTSUPP, \"getsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 1, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, -EOPNOTSUPP, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->ctx_retval_value, -EOPNOTSUPP, \"ctx_retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_getsockopt__destroy(obj);\n}\n\nstatic void test_getsockopt_override(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_getsockopt *obj;\n\tstruct bpf_link *link_set_eisconn = NULL;\n\tint buf;\n\tsocklen_t optlen = sizeof(buf);\n\n\tobj = cgroup_getset_retval_getsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eisconn = bpf_program__attach_cgroup(obj->progs.set_eisconn,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eisconn, \"cg-attach-set_eisconn\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_ERR(getsockopt(sock_fd, SOL_CUSTOM, 0,\n\t\t\t\t   &buf, &optlen), \"getsockopt\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(errno, EISCONN, \"getsockopt-errno\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 1, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eisconn);\n\n\tcgroup_getset_retval_getsockopt__destroy(obj);\n}\n\nstatic void test_getsockopt_retval_sync(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_getsockopt *obj;\n\tstruct bpf_link *link_set_eisconn = NULL, *link_clear_retval = NULL;\n\tstruct bpf_link *link_get_retval = NULL;\n\tint buf;\n\tsocklen_t optlen = sizeof(buf);\n\n\tobj = cgroup_getset_retval_getsockopt__open_and_load();\n\tif (!ASSERT_OK_PTR(obj, \"skel-load\"))\n\t\treturn;\n\n\tobj->bss->page_size = sysconf(_SC_PAGESIZE);\n\n\t \n\tlink_set_eisconn = bpf_program__attach_cgroup(obj->progs.set_eisconn,\n\t\t\t\t\t\t      cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_set_eisconn, \"cg-attach-set_eisconn\"))\n\t\tgoto close_bpf_object;\n\tlink_clear_retval = bpf_program__attach_cgroup(obj->progs.clear_retval,\n\t\t\t\t\t\t       cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_clear_retval, \"cg-attach-clear_retval\"))\n\t\tgoto close_bpf_object;\n\tlink_get_retval = bpf_program__attach_cgroup(obj->progs.get_retval,\n\t\t\t\t\t\t     cgroup_fd);\n\tif (!ASSERT_OK_PTR(link_get_retval, \"cg-attach-get_retval\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_OK(getsockopt(sock_fd, SOL_CUSTOM, 0,\n\t\t\t\t  &buf, &optlen), \"getsockopt\"))\n\t\tgoto close_bpf_object;\n\n\tif (!ASSERT_EQ(obj->bss->invocations, 3, \"invocations\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_FALSE(obj->bss->assertion_error, \"assertion_error\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->retval_value, 0, \"retval_value\"))\n\t\tgoto close_bpf_object;\n\tif (!ASSERT_EQ(obj->bss->ctx_retval_value, 0, \"ctx_retval_value\"))\n\t\tgoto close_bpf_object;\n\nclose_bpf_object:\n\tbpf_link__destroy(link_set_eisconn);\n\tbpf_link__destroy(link_clear_retval);\n\tbpf_link__destroy(link_get_retval);\n\n\tcgroup_getset_retval_getsockopt__destroy(obj);\n}\n\nstruct exposed_hook {\n\tconst char *name;\n\tint expected_err;\n} exposed_hooks[] = {\n\n#define BPF_RETVAL_HOOK(NAME, SECTION, CTX, EXPECTED_ERR) \\\n\t{ \\\n\t\t.name = #NAME, \\\n\t\t.expected_err = EXPECTED_ERR, \\\n\t},\n\n#include \"cgroup_getset_retval_hooks.h\"\n\n#undef BPF_RETVAL_HOOK\n};\n\nstatic void test_exposed_hooks(int cgroup_fd, int sock_fd)\n{\n\tstruct cgroup_getset_retval_hooks *skel;\n\tstruct bpf_program *prog;\n\tint err;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(exposed_hooks); i++) {\n\t\tskel = cgroup_getset_retval_hooks__open();\n\t\tif (!ASSERT_OK_PTR(skel, \"cgroup_getset_retval_hooks__open\"))\n\t\t\tcontinue;\n\n\t\tprog = bpf_object__find_program_by_name(skel->obj, exposed_hooks[i].name);\n\t\tif (!ASSERT_NEQ(prog, NULL, \"bpf_object__find_program_by_name\"))\n\t\t\tgoto close_skel;\n\n\t\terr = bpf_program__set_autoload(prog, true);\n\t\tif (!ASSERT_OK(err, \"bpf_program__set_autoload\"))\n\t\t\tgoto close_skel;\n\n\t\terr = cgroup_getset_retval_hooks__load(skel);\n\t\tASSERT_EQ(err, exposed_hooks[i].expected_err, \"expected_err\");\n\nclose_skel:\n\t\tcgroup_getset_retval_hooks__destroy(skel);\n\t}\n}\n\nvoid test_cgroup_getset_retval(void)\n{\n\tint cgroup_fd = -1;\n\tint sock_fd = -1;\n\n\tcgroup_fd = test__join_cgroup(\"/cgroup_getset_retval\");\n\tif (!ASSERT_GE(cgroup_fd, 0, \"cg-create\"))\n\t\tgoto close_fd;\n\n\tsock_fd = start_server(AF_INET, SOCK_DGRAM, NULL, 0, 0);\n\tif (!ASSERT_GE(sock_fd, 0, \"start-server\"))\n\t\tgoto close_fd;\n\n\tif (test__start_subtest(\"setsockopt-set\"))\n\t\ttest_setsockopt_set(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-set_and_get\"))\n\t\ttest_setsockopt_set_and_get(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-default_zero\"))\n\t\ttest_setsockopt_default_zero(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-default_zero_and_set\"))\n\t\ttest_setsockopt_default_zero_and_set(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-override\"))\n\t\ttest_setsockopt_override(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-legacy_eperm\"))\n\t\ttest_setsockopt_legacy_eperm(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"setsockopt-legacy_no_override\"))\n\t\ttest_setsockopt_legacy_no_override(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"getsockopt-get\"))\n\t\ttest_getsockopt_get(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"getsockopt-override\"))\n\t\ttest_getsockopt_override(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"getsockopt-retval_sync\"))\n\t\ttest_getsockopt_retval_sync(cgroup_fd, sock_fd);\n\n\tif (test__start_subtest(\"exposed_hooks\"))\n\t\ttest_exposed_hooks(cgroup_fd, sock_fd);\n\nclose_fd:\n\tclose(cgroup_fd);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}