{
  "module_name": "ksyms_module.c",
  "hash_id": "e94c58db4be5af4584159078480816aa3ea9457c3a126b351c1b3ef5215ab675",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/ksyms_module.c",
  "human_readable_source": "\n \n\n#include <test_progs.h>\n#include <network_helpers.h>\n#include \"test_ksyms_module.lskel.h\"\n#include \"test_ksyms_module.skel.h\"\n\nstatic void test_ksyms_module_lskel(void)\n{\n\tstruct test_ksyms_module_lskel *skel;\n\tint err;\n\tLIBBPF_OPTS(bpf_test_run_opts, topts,\n\t\t.data_in = &pkt_v4,\n\t\t.data_size_in = sizeof(pkt_v4),\n\t\t.repeat = 1,\n\t);\n\n\tif (!env.has_testmod) {\n\t\ttest__skip();\n\t\treturn;\n\t}\n\n\tskel = test_ksyms_module_lskel__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"test_ksyms_module_lskel__open_and_load\"))\n\t\treturn;\n\terr = bpf_prog_test_run_opts(skel->progs.load.prog_fd, &topts);\n\tif (!ASSERT_OK(err, \"bpf_prog_test_run\"))\n\t\tgoto cleanup;\n\tASSERT_EQ(topts.retval, 0, \"retval\");\n\tASSERT_EQ(skel->bss->out_bpf_testmod_ksym, 42, \"bpf_testmod_ksym\");\ncleanup:\n\ttest_ksyms_module_lskel__destroy(skel);\n}\n\nstatic void test_ksyms_module_libbpf(void)\n{\n\tstruct test_ksyms_module *skel;\n\tint err;\n\tLIBBPF_OPTS(bpf_test_run_opts, topts,\n\t\t.data_in = &pkt_v4,\n\t\t.data_size_in = sizeof(pkt_v4),\n\t\t.repeat = 1,\n\t);\n\n\tif (!env.has_testmod) {\n\t\ttest__skip();\n\t\treturn;\n\t}\n\n\tskel = test_ksyms_module__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"test_ksyms_module__open\"))\n\t\treturn;\n\terr = bpf_prog_test_run_opts(bpf_program__fd(skel->progs.load), &topts);\n\tif (!ASSERT_OK(err, \"bpf_prog_test_run\"))\n\t\tgoto cleanup;\n\tASSERT_EQ(topts.retval, 0, \"retval\");\n\tASSERT_EQ(skel->bss->out_bpf_testmod_ksym, 42, \"bpf_testmod_ksym\");\ncleanup:\n\ttest_ksyms_module__destroy(skel);\n}\n\nvoid test_ksyms_module(void)\n{\n\tif (test__start_subtest(\"lskel\"))\n\t\ttest_ksyms_module_lskel();\n\tif (test__start_subtest(\"libbpf\"))\n\t\ttest_ksyms_module_libbpf();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}