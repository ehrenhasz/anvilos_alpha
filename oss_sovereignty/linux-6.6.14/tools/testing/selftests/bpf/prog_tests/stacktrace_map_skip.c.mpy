{
  "module_name": "stacktrace_map_skip.c",
  "hash_id": "1cad5161c527968fd82c504cf5a488b23e51d5dcf10434e68de42d12b22ec04b",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/stacktrace_map_skip.c",
  "human_readable_source": "\n#include <test_progs.h>\n#include \"stacktrace_map_skip.skel.h\"\n\n#define TEST_STACK_DEPTH  2\n\nvoid test_stacktrace_map_skip(void)\n{\n\tstruct stacktrace_map_skip *skel;\n\tint stackid_hmap_fd, stackmap_fd, stack_amap_fd;\n\tint err, stack_trace_len;\n\n\tskel = stacktrace_map_skip__open_and_load();\n\tif (!ASSERT_OK_PTR(skel, \"skel_open_and_load\"))\n\t\treturn;\n\n\t \n\tstackid_hmap_fd = bpf_map__fd(skel->maps.stackid_hmap);\n\tif (!ASSERT_GE(stackid_hmap_fd, 0, \"stackid_hmap fd\"))\n\t\tgoto out;\n\n\tstackmap_fd = bpf_map__fd(skel->maps.stackmap);\n\tif (!ASSERT_GE(stackmap_fd, 0, \"stackmap fd\"))\n\t\tgoto out;\n\n\tstack_amap_fd = bpf_map__fd(skel->maps.stack_amap);\n\tif (!ASSERT_GE(stack_amap_fd, 0, \"stack_amap fd\"))\n\t\tgoto out;\n\n\tskel->bss->pid = getpid();\n\n\terr = stacktrace_map_skip__attach(skel);\n\tif (!ASSERT_OK(err, \"skel_attach\"))\n\t\tgoto out;\n\n\t \n\tsleep(1);\n\n\t \n\tskel->bss->control = 1;\n\n\t \n\terr = compare_map_keys(stackid_hmap_fd, stackmap_fd);\n\tif (!ASSERT_OK(err, \"compare_map_keys stackid_hmap vs. stackmap\"))\n\t\tgoto out;\n\n\terr = compare_map_keys(stackmap_fd, stackid_hmap_fd);\n\tif (!ASSERT_OK(err, \"compare_map_keys stackmap vs. stackid_hmap\"))\n\t\tgoto out;\n\n\tstack_trace_len = TEST_STACK_DEPTH * sizeof(__u64);\n\terr = compare_stack_ips(stackmap_fd, stack_amap_fd, stack_trace_len);\n\tif (!ASSERT_OK(err, \"compare_stack_ips stackmap vs. stack_amap\"))\n\t\tgoto out;\n\n\tif (!ASSERT_EQ(skel->bss->failed, 0, \"skip_failed\"))\n\t\tgoto out;\n\nout:\n\tstacktrace_map_skip__destroy(skel);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}