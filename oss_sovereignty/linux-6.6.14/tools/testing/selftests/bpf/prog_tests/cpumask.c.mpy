{
  "module_name": "cpumask.c",
  "hash_id": "a5e390c7f6cfd09f5ff8d29c6b10b407528adeae0614bb321203df57423db45e",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/cpumask.c",
  "human_readable_source": "\n \n\n#include <test_progs.h>\n#include \"cpumask_failure.skel.h\"\n#include \"cpumask_success.skel.h\"\n\nstatic const char * const cpumask_success_testcases[] = {\n\t\"test_alloc_free_cpumask\",\n\t\"test_set_clear_cpu\",\n\t\"test_setall_clear_cpu\",\n\t\"test_first_firstzero_cpu\",\n\t\"test_firstand_nocpu\",\n\t\"test_test_and_set_clear\",\n\t\"test_and_or_xor\",\n\t\"test_intersects_subset\",\n\t\"test_copy_any_anyand\",\n\t\"test_insert_leave\",\n\t\"test_insert_remove_release\",\n\t\"test_global_mask_rcu\",\n};\n\nstatic void verify_success(const char *prog_name)\n{\n\tstruct cpumask_success *skel;\n\tstruct bpf_program *prog;\n\tstruct bpf_link *link = NULL;\n\tpid_t child_pid;\n\tint status;\n\n\tskel = cpumask_success__open();\n\tif (!ASSERT_OK_PTR(skel, \"cpumask_success__open\"))\n\t\treturn;\n\n\tskel->bss->pid = getpid();\n\tskel->bss->nr_cpus = libbpf_num_possible_cpus();\n\n\tcpumask_success__load(skel);\n\tif (!ASSERT_OK_PTR(skel, \"cpumask_success__load\"))\n\t\tgoto cleanup;\n\n\tprog = bpf_object__find_program_by_name(skel->obj, prog_name);\n\tif (!ASSERT_OK_PTR(prog, \"bpf_object__find_program_by_name\"))\n\t\tgoto cleanup;\n\n\tlink = bpf_program__attach(prog);\n\tif (!ASSERT_OK_PTR(link, \"bpf_program__attach\"))\n\t\tgoto cleanup;\n\n\tchild_pid = fork();\n\tif (!ASSERT_GT(child_pid, -1, \"child_pid\"))\n\t\tgoto cleanup;\n\tif (child_pid == 0)\n\t\t_exit(0);\n\twaitpid(child_pid, &status, 0);\n\tASSERT_OK(skel->bss->err, \"post_wait_err\");\n\ncleanup:\n\tbpf_link__destroy(link);\n\tcpumask_success__destroy(skel);\n}\n\nvoid test_cpumask(void)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(cpumask_success_testcases); i++) {\n\t\tif (!test__start_subtest(cpumask_success_testcases[i]))\n\t\t\tcontinue;\n\n\t\tverify_success(cpumask_success_testcases[i]);\n\t}\n\n\tRUN_TESTS(cpumask_success);\n\tRUN_TESTS(cpumask_failure);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}