{
  "module_name": "section_names.c",
  "hash_id": "a3603b823532b9d425ad72465ec9f0eeddaafca6cf0e9e555451655ea48c2448",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/prog_tests/section_names.c",
  "human_readable_source": "\n\n#include <test_progs.h>\n\nstatic int duration = 0;\n\nstruct sec_name_test {\n\tconst char sec_name[32];\n\tstruct {\n\t\tint rc;\n\t\tenum bpf_prog_type prog_type;\n\t\tenum bpf_attach_type expected_attach_type;\n\t} expected_load;\n\tstruct {\n\t\tint rc;\n\t\tenum bpf_attach_type attach_type;\n\t} expected_attach;\n};\n\nstatic struct sec_name_test tests[] = {\n\t{\"InvAliD\", {-ESRCH, 0, 0}, {-EINVAL, 0} },\n\t{\"cgroup\", {-ESRCH, 0, 0}, {-EINVAL, 0} },\n\t{\"socket\", {0, BPF_PROG_TYPE_SOCKET_FILTER, 0}, {-EINVAL, 0} },\n\t{\"kprobe/\", {0, BPF_PROG_TYPE_KPROBE, 0}, {-EINVAL, 0} },\n\t{\"uprobe/\", {0, BPF_PROG_TYPE_KPROBE, 0}, {-EINVAL, 0} },\n\t{\"kretprobe/\", {0, BPF_PROG_TYPE_KPROBE, 0}, {-EINVAL, 0} },\n\t{\"uretprobe/\", {0, BPF_PROG_TYPE_KPROBE, 0}, {-EINVAL, 0} },\n\t{\"classifier\", {0, BPF_PROG_TYPE_SCHED_CLS, 0}, {-EINVAL, 0} },\n\t{\"action\", {0, BPF_PROG_TYPE_SCHED_ACT, 0}, {-EINVAL, 0} },\n\t{\"tracepoint/\", {0, BPF_PROG_TYPE_TRACEPOINT, 0}, {-EINVAL, 0} },\n\t{\"tp/\", {0, BPF_PROG_TYPE_TRACEPOINT, 0}, {-EINVAL, 0} },\n\t{\n\t\t\"raw_tracepoint/\",\n\t\t{0, BPF_PROG_TYPE_RAW_TRACEPOINT, 0},\n\t\t{-EINVAL, 0},\n\t},\n\t{\"raw_tp/\", {0, BPF_PROG_TYPE_RAW_TRACEPOINT, 0}, {-EINVAL, 0} },\n\t{\"xdp\", {0, BPF_PROG_TYPE_XDP, BPF_XDP}, {0, BPF_XDP} },\n\t{\"perf_event\", {0, BPF_PROG_TYPE_PERF_EVENT, 0}, {-EINVAL, 0} },\n\t{\"lwt_in\", {0, BPF_PROG_TYPE_LWT_IN, 0}, {-EINVAL, 0} },\n\t{\"lwt_out\", {0, BPF_PROG_TYPE_LWT_OUT, 0}, {-EINVAL, 0} },\n\t{\"lwt_xmit\", {0, BPF_PROG_TYPE_LWT_XMIT, 0}, {-EINVAL, 0} },\n\t{\"lwt_seg6local\", {0, BPF_PROG_TYPE_LWT_SEG6LOCAL, 0}, {-EINVAL, 0} },\n\t{\n\t\t\"cgroup_skb/ingress\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SKB, BPF_CGROUP_INET_INGRESS},\n\t\t{0, BPF_CGROUP_INET_INGRESS},\n\t},\n\t{\n\t\t\"cgroup_skb/egress\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SKB, BPF_CGROUP_INET_EGRESS},\n\t\t{0, BPF_CGROUP_INET_EGRESS},\n\t},\n\t{\"cgroup/skb\", {0, BPF_PROG_TYPE_CGROUP_SKB, 0}, {-EINVAL, 0} },\n\t{\n\t\t\"cgroup/sock\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK, BPF_CGROUP_INET_SOCK_CREATE},\n\t\t{0, BPF_CGROUP_INET_SOCK_CREATE},\n\t},\n\t{\n\t\t\"cgroup/post_bind4\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK, BPF_CGROUP_INET4_POST_BIND},\n\t\t{0, BPF_CGROUP_INET4_POST_BIND},\n\t},\n\t{\n\t\t\"cgroup/post_bind6\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK, BPF_CGROUP_INET6_POST_BIND},\n\t\t{0, BPF_CGROUP_INET6_POST_BIND},\n\t},\n\t{\n\t\t\"cgroup/dev\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_DEVICE, BPF_CGROUP_DEVICE},\n\t\t{0, BPF_CGROUP_DEVICE},\n\t},\n\t{\n\t\t\"sockops\",\n\t\t{0, BPF_PROG_TYPE_SOCK_OPS, BPF_CGROUP_SOCK_OPS},\n\t\t{0, BPF_CGROUP_SOCK_OPS},\n\t},\n\t{\n\t\t\"sk_skb/stream_parser\",\n\t\t{0, BPF_PROG_TYPE_SK_SKB, BPF_SK_SKB_STREAM_PARSER},\n\t\t{0, BPF_SK_SKB_STREAM_PARSER},\n\t},\n\t{\n\t\t\"sk_skb/stream_verdict\",\n\t\t{0, BPF_PROG_TYPE_SK_SKB, BPF_SK_SKB_STREAM_VERDICT},\n\t\t{0, BPF_SK_SKB_STREAM_VERDICT},\n\t},\n\t{\"sk_skb\", {0, BPF_PROG_TYPE_SK_SKB, 0}, {-EINVAL, 0} },\n\t{\n\t\t\"sk_msg\",\n\t\t{0, BPF_PROG_TYPE_SK_MSG, BPF_SK_MSG_VERDICT},\n\t\t{0, BPF_SK_MSG_VERDICT},\n\t},\n\t{\n\t\t\"lirc_mode2\",\n\t\t{0, BPF_PROG_TYPE_LIRC_MODE2, BPF_LIRC_MODE2},\n\t\t{0, BPF_LIRC_MODE2},\n\t},\n\t{\n\t\t\"flow_dissector\",\n\t\t{0, BPF_PROG_TYPE_FLOW_DISSECTOR, BPF_FLOW_DISSECTOR},\n\t\t{0, BPF_FLOW_DISSECTOR},\n\t},\n\t{\n\t\t\"cgroup/bind4\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_INET4_BIND},\n\t\t{0, BPF_CGROUP_INET4_BIND},\n\t},\n\t{\n\t\t\"cgroup/bind6\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_INET6_BIND},\n\t\t{0, BPF_CGROUP_INET6_BIND},\n\t},\n\t{\n\t\t\"cgroup/connect4\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_INET4_CONNECT},\n\t\t{0, BPF_CGROUP_INET4_CONNECT},\n\t},\n\t{\n\t\t\"cgroup/connect6\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_INET6_CONNECT},\n\t\t{0, BPF_CGROUP_INET6_CONNECT},\n\t},\n\t{\n\t\t\"cgroup/sendmsg4\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_UDP4_SENDMSG},\n\t\t{0, BPF_CGROUP_UDP4_SENDMSG},\n\t},\n\t{\n\t\t\"cgroup/sendmsg6\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_UDP6_SENDMSG},\n\t\t{0, BPF_CGROUP_UDP6_SENDMSG},\n\t},\n\t{\n\t\t\"cgroup/recvmsg4\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_UDP4_RECVMSG},\n\t\t{0, BPF_CGROUP_UDP4_RECVMSG},\n\t},\n\t{\n\t\t\"cgroup/recvmsg6\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCK_ADDR, BPF_CGROUP_UDP6_RECVMSG},\n\t\t{0, BPF_CGROUP_UDP6_RECVMSG},\n\t},\n\t{\n\t\t\"cgroup/sysctl\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SYSCTL, BPF_CGROUP_SYSCTL},\n\t\t{0, BPF_CGROUP_SYSCTL},\n\t},\n\t{\n\t\t\"cgroup/getsockopt\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCKOPT, BPF_CGROUP_GETSOCKOPT},\n\t\t{0, BPF_CGROUP_GETSOCKOPT},\n\t},\n\t{\n\t\t\"cgroup/setsockopt\",\n\t\t{0, BPF_PROG_TYPE_CGROUP_SOCKOPT, BPF_CGROUP_SETSOCKOPT},\n\t\t{0, BPF_CGROUP_SETSOCKOPT},\n\t},\n};\n\nstatic void test_prog_type_by_name(const struct sec_name_test *test)\n{\n\tenum bpf_attach_type expected_attach_type;\n\tenum bpf_prog_type prog_type;\n\tint rc;\n\n\trc = libbpf_prog_type_by_name(test->sec_name, &prog_type,\n\t\t\t\t      &expected_attach_type);\n\n\tCHECK(rc != test->expected_load.rc, \"check_code\",\n\t      \"prog: unexpected rc=%d for %s\\n\", rc, test->sec_name);\n\n\tif (rc)\n\t\treturn;\n\n\tCHECK(prog_type != test->expected_load.prog_type, \"check_prog_type\",\n\t      \"prog: unexpected prog_type=%d for %s\\n\",\n\t      prog_type, test->sec_name);\n\n\tCHECK(expected_attach_type != test->expected_load.expected_attach_type,\n\t      \"check_attach_type\", \"prog: unexpected expected_attach_type=%d for %s\\n\",\n\t      expected_attach_type, test->sec_name);\n}\n\nstatic void test_attach_type_by_name(const struct sec_name_test *test)\n{\n\tenum bpf_attach_type attach_type;\n\tint rc;\n\n\trc = libbpf_attach_type_by_name(test->sec_name, &attach_type);\n\n\tCHECK(rc != test->expected_attach.rc, \"check_ret\",\n\t      \"attach: unexpected rc=%d for %s\\n\", rc, test->sec_name);\n\n\tif (rc)\n\t\treturn;\n\n\tCHECK(attach_type != test->expected_attach.attach_type,\n\t      \"check_attach_type\", \"attach: unexpected attach_type=%d for %s\\n\",\n\t      attach_type, test->sec_name);\n}\n\nvoid test_section_names(void)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(tests); ++i) {\n\t\tstruct sec_name_test *test = &tests[i];\n\n\t\ttest_prog_type_by_name(test);\n\t\ttest_attach_type_by_name(test);\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}