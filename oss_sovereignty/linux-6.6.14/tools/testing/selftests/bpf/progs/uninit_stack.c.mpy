{
  "module_name": "uninit_stack.c",
  "hash_id": "ad89c5978e473275113527716b16e8769a8240ed5aa34acc6c2585a9c70f62e6",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/uninit_stack.c",
  "human_readable_source": "\n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\n \nSEC(\"socket\")\n__naked int read_uninit_stack_fixed_off(void *ctx)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t\tr0 = 0;\t\t\t\t\t\\\n\t\t \t\\\n\t\t*(u64*)(r10 - 128) = r1;\t\t\\\n\t\tr1 = *(u8 *)(r10 - 8 );\t\t\t\\\n\t\tr0 += r1;\t\t\t\t\\\n\t\tr1 = *(u8 *)(r10 - 11);\t\t\t\\\n\t\tr1 = *(u8 *)(r10 - 13);\t\t\t\\\n\t\tr1 = *(u8 *)(r10 - 15);\t\t\t\\\n\t\tr1 = *(u16*)(r10 - 16);\t\t\t\\\n\t\tr1 = *(u32*)(r10 - 32);\t\t\t\\\n\t\tr1 = *(u64*)(r10 - 64);\t\t\t\\\n\t\t \t\t\t\t\t\\\n\t\t*(u32*)(r10 - 72) = r1;\t\t\t\\\n\t\tr1 = *(u64*)(r10 - 72);\t\t\t\\\n\t\tr0 = 0;\t\t\t\t\t\\\n\t\texit;\t\t\t\t\t\\\n\"\n\t\t      ::: __clobber_all);\n}\n\n/* Read an uninitialized value from stack at a variable offset */\nSEC(\"socket\")\n__naked int read_uninit_stack_var_off(void *ctx)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t\tcall %[bpf_get_prandom_u32];\t\t\\\n\t\t \t\\\n\t\t*(u64*)(r10 - 64) = r0;\t\t\t\\\n\t\tr0 = -r0;\t\t\t\t\\\n\t\t \t\t\\\n\t\tif r0 s<= -32 goto exit_%=;\t\t\\\n\t\tif r0 s>= 0 goto exit_%=;\t\t\\\n\t\t \t\t\\\n\t\tr1 = r10;\t\t\t\t\\\n\t\tr1 += r0;\t\t\t\t\\\n\t\tr2 = *(u8*)(r1 + 0);\t\t\t\\\nexit_%=:\tr0 = 0;\t\t\t\t\t\\\n\t\texit;\t\t\t\t\t\\\n\"\n\t\t      :\n\t\t      : __imm(bpf_get_prandom_u32)\n\t\t      : __clobber_all);\n}\n\nstatic __noinline void dummy(void) {}\n\n/* Pass a pointer to uninitialized stack memory to a helper.\n * Passed memory block should be marked as STACK_MISC after helper call.\n */\nSEC(\"socket\")\n__log_level(7) __msg(\"fp-104=mmmmmmmm\")\n__naked int helper_uninit_to_misc(void *ctx)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t\t \t\\\n\t\t*(u64*)(r10 - 128) = r1;\t\t\\\n\t\tr1 = r10;\t\t\t\t\\\n\t\tr1 += -128;\t\t\t\t\\\n\t\tr2 = 32;\t\t\t\t\\\n\t\tcall %[bpf_trace_printk];\t\t\\\n\t\t \t\t\t\t\t\\\n\t\tcall %[dummy];\t\t\t\t\\\n\t\tr0 = 0;\t\t\t\t\t\\\n\t\texit;\t\t\t\t\t\\\n\"\n\t\t      :\n\t\t      : __imm(bpf_trace_printk),\n\t\t\t__imm(dummy)\n\t\t      : __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}