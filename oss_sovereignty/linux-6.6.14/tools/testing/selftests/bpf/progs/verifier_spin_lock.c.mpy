{
  "module_name": "verifier_spin_lock.c",
  "hash_id": "02f9019254ab3f35d88aef40d3efff8dc0fd0bb878d06d0ad1a3eacea1b70a41",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_spin_lock.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nstruct val {\n\tint cnt;\n\tstruct bpf_spin_lock l;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, int);\n\t__type(value, struct val);\n} map_spin_lock SEC(\".maps\");\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test1 success\")\n__success __failure_unpriv __msg_unpriv(\"\")\n__retval(0)\n__naked void spin_lock_test1_success(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r6 + 0);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test2 direct ld/st\")\n__failure __msg(\"cannot be accessed directly\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void lock_test2_direct_ld_st(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + 0);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test3 direct ld/st\")\n__failure __msg(\"cannot be accessed directly\")\n__failure_unpriv __msg_unpriv(\"\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void lock_test3_direct_ld_st(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r6 + 1);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test4 direct ld/st\")\n__failure __msg(\"cannot be accessed directly\")\n__failure_unpriv __msg_unpriv(\"\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void lock_test4_direct_ld_st(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u16*)(r6 + 3);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test5 call within a locked region\")\n__failure __msg(\"calls are not allowed\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void call_within_a_locked_region(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32),\n\t  __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test6 missing unlock\")\n__failure __msg(\"unlock is missing\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void spin_lock_test6_missing_unlock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r6 + 0);\t\t\t\t\\\n\tif r0 != 0 goto l1_%=;\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\nl1_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test7 unlock without lock\")\n__failure __msg(\"without taking a lock\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void lock_test7_unlock_without_lock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tif r1 != 0 goto l1_%=;\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\nl1_%=:\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r6 + 0);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test8 double lock\")\n__failure __msg(\"calls are not allowed\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void spin_lock_test8_double_lock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tr0 = *(u32*)(r6 + 0);\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test9 different lock\")\n__failure __msg(\"unlock of different lock\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void spin_lock_test9_different_lock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl1_%=:\tr7 = r0;\t\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: test10 lock in subprog without unlock\")\n__failure __msg(\"unlock is missing\")\n__failure_unpriv __msg_unpriv(\"\")\n__naked void lock_in_subprog_without_unlock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr6 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall lock_in_subprog_without_unlock__1;\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nstatic __naked __noinline __attribute__((used))\nvoid lock_in_subprog_without_unlock__1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"spin_lock: test11 ld_abs under lock\")\n__failure __msg(\"inside bpf_spin_lock\")\n__naked void test11_ld_abs_under_lock(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr6 = r1;\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr7 = r0;\t\t\t\t\t\\\n\tr1 = r0;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr0 = *(u8*)skb[0];\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"spin_lock: regsafe compare reg->id for map value\")\n__failure __msg(\"bpf_spin_unlock of different lock\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void reg_id_for_map_value(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr6 = r1;\t\t\t\t\t\\\n\tr6 = *(u32*)(r6 + %[__sk_buff_mark]);\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tr9 = r1;\t\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r2;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr7 = r0;\t\t\t\t\t\\\n\tr1 = r9;\t\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl1_%=:\tr8 = r0;\t\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tif r6 == 0 goto l2_%=;\t\t\t\t\\\n\tgoto l3_%=;\t\t\t\t\t\\\nl2_%=:\tr7 = r8;\t\t\t\t\t\\\nl3_%=:\tr1 = r7;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\n/* Make sure that regsafe() compares ids for spin lock records using\n * check_ids():\n *  1: r9 = map_lookup_elem(...)  ; r9.id == 1\n *  2: r8 = map_lookup_elem(...)  ; r8.id == 2\n *  3: r7 = ktime_get_ns()\n *  4: r6 = ktime_get_ns()\n *  5: if r6 > r7 goto <9>\n *  6: spin_lock(r8)\n *  7: r9 = r8\n *  8: goto <10>\n *  9: spin_lock(r9)\n * 10: spin_unlock(r9)             ; r9.id == 1 || r9.id == 2 and lock is active,\n *                                 ; second visit to (10) should be considered safe\n *                                 ; if check_ids() is used.\n * 11: exit(0)\n */\n\nSEC(\"cgroup/skb\")\n__description(\"spin_lock: regsafe() check_ids() similar id mappings\")\n__success __msg(\"29: safe\")\n__failure_unpriv __msg_unpriv(\"\")\n__log_level(2) __retval(0) __flag(BPF_F_TEST_STATE_FREQ)\n__naked void check_ids_similar_id_mappings(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r10 - 4) = r1;\t\t\t\t\\\n\t \t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr9 = r0;\t\t\t\t\t\\\n\t \t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -4;\t\t\t\t\t\\\n\tr1 = %[map_spin_lock] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l1_%=;\t\t\t\t\\\n\tr8 = r0;\t\t\t\t\t\\\n\t \t\t\t\\\n\tcall %[bpf_ktime_get_ns];\t\t\t\\\n\tr7 = r0;\t\t\t\t\t\\\n\t \t\t\t\\\n\tcall %[bpf_ktime_get_ns];\t\t\t\\\n\tr6 = r0;\t\t\t\t\t\\\n\t \t\t\t\t\t\t\\\n\tif r6 > r7 goto l2_%=;\t\t\t\t\\\n\tr1 = r8;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\n\tr9 = r8;\t\t\t\t\t\\\n\tgoto l3_%=;\t\t\t\t\t\\\nl2_%=:\t \t\t\t\t\\\n\tr1 = r9;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_lock];\t\t\t\t\\\nl3_%=:\t \t\t\t\t\\\n\tr1 = r9;\t\t\t\t\t\\\n\tr1 += 4;\t\t\t\t\t\\\n\tcall %[bpf_spin_unlock];\t\t\t\\\nl0_%=:\t \t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl1_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_ktime_get_ns),\n\t  __imm(bpf_map_lookup_elem),\n\t  __imm(bpf_spin_lock),\n\t  __imm(bpf_spin_unlock),\n\t  __imm_addr(map_spin_lock)\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}