{
  "module_name": "test_core_reloc_existence.c",
  "hash_id": "2ca74171dd4ed4e76de449b92edb783e94922ddb3eee508b1bdb15d593d8a6be",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_core_reloc_existence.c",
  "human_readable_source": "\n\n\n#include <linux/bpf.h>\n#include <stdint.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\tchar in[256];\n\tchar out[256];\n} data = {};\n\nstruct core_reloc_existence_output {\n\tint a_exists;\n\tint a_value;\n\tint b_exists;\n\tint b_value;\n\tint c_exists;\n\tint c_value;\n\tint arr_exists;\n\tint arr_value;\n\tint s_exists;\n\tint s_value;\n};\n\nstruct core_reloc_existence {\n\tstruct {\n\t\tint x;\n\t} s;\n\tint arr[1];\n\tint a;\n\tstruct {\n\t\tint b;\n\t};\n\tint c;\n};\n\nSEC(\"raw_tracepoint/sys_enter\")\nint test_core_existence(void *ctx)\n{\n\tstruct core_reloc_existence *in = (void *)&data.in;\n\tstruct core_reloc_existence_output *out = (void *)&data.out;\n\n\tout->a_exists = bpf_core_field_exists(in->a);\n\tif (bpf_core_field_exists(struct core_reloc_existence, a))\n\t\tout->a_value = BPF_CORE_READ(in, a);\n\telse\n\t\tout->a_value = 0xff000001u;\n\n\tout->b_exists = bpf_core_field_exists(in->b);\n\tif (bpf_core_field_exists(struct core_reloc_existence, b))\n\t\tout->b_value = BPF_CORE_READ(in, b);\n\telse\n\t\tout->b_value = 0xff000002u;\n\n\tout->c_exists = bpf_core_field_exists(in->c);\n\tif (bpf_core_field_exists(struct core_reloc_existence, c))\n\t\tout->c_value = BPF_CORE_READ(in, c);\n\telse\n\t\tout->c_value = 0xff000003u;\n\n\tout->arr_exists = bpf_core_field_exists(in->arr);\n\tif (bpf_core_field_exists(struct core_reloc_existence, arr))\n\t\tout->arr_value = BPF_CORE_READ(in, arr[0]);\n\telse\n\t\tout->arr_value = 0xff000004u;\n\n\tout->s_exists = bpf_core_field_exists(in->s);\n\tif (bpf_core_field_exists(struct core_reloc_existence, s))\n\t\tout->s_value = BPF_CORE_READ(in, s.x);\n\telse\n\t\tout->s_value = 0xff000005u;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}