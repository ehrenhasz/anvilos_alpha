{
  "module_name": "test_vmlinux.c",
  "hash_id": "6069f99e1c3686256c267fbd1688d7f768589ac37402ce3e5642a7811795b351",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_vmlinux.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n#include <asm/unistd.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <bpf/bpf_core_read.h>\n\n#define MY_TV_NSEC 1337\n\nbool tp_called = false;\nbool raw_tp_called = false;\nbool tp_btf_called = false;\nbool kprobe_called = false;\nbool fentry_called = false;\n\nSEC(\"tp/syscalls/sys_enter_nanosleep\")\nint handle__tp(struct trace_event_raw_sys_enter *args)\n{\n\tstruct __kernel_timespec *ts;\n\tlong tv_nsec;\n\n\tif (args->id != __NR_nanosleep)\n\t\treturn 0;\n\n\tts = (void *)args->args[0];\n\tif (bpf_probe_read_user(&tv_nsec, sizeof(ts->tv_nsec), &ts->tv_nsec) ||\n\t    tv_nsec != MY_TV_NSEC)\n\t\treturn 0;\n\n\ttp_called = true;\n\treturn 0;\n}\n\nSEC(\"raw_tp/sys_enter\")\nint BPF_PROG(handle__raw_tp, struct pt_regs *regs, long id)\n{\n\tstruct __kernel_timespec *ts;\n\tlong tv_nsec;\n\n\tif (id != __NR_nanosleep)\n\t\treturn 0;\n\n\tts = (void *)PT_REGS_PARM1_CORE_SYSCALL(regs);\n\tif (bpf_probe_read_user(&tv_nsec, sizeof(ts->tv_nsec), &ts->tv_nsec) ||\n\t    tv_nsec != MY_TV_NSEC)\n\t\treturn 0;\n\n\traw_tp_called = true;\n\treturn 0;\n}\n\nSEC(\"tp_btf/sys_enter\")\nint BPF_PROG(handle__tp_btf, struct pt_regs *regs, long id)\n{\n\tstruct __kernel_timespec *ts;\n\tlong tv_nsec;\n\n\tif (id != __NR_nanosleep)\n\t\treturn 0;\n\n\tts = (void *)PT_REGS_PARM1_CORE_SYSCALL(regs);\n\tif (bpf_probe_read_user(&tv_nsec, sizeof(ts->tv_nsec), &ts->tv_nsec) ||\n\t    tv_nsec != MY_TV_NSEC)\n\t\treturn 0;\n\n\ttp_btf_called = true;\n\treturn 0;\n}\n\nSEC(\"kprobe/hrtimer_start_range_ns\")\nint BPF_KPROBE(handle__kprobe, struct hrtimer *timer, ktime_t tim, u64 delta_ns,\n\t       const enum hrtimer_mode mode)\n{\n\tif (tim == MY_TV_NSEC)\n\t\tkprobe_called = true;\n\treturn 0;\n}\n\nSEC(\"fentry/hrtimer_start_range_ns\")\nint BPF_PROG(handle__fentry, struct hrtimer *timer, ktime_t tim, u64 delta_ns,\n\t     const enum hrtimer_mode mode)\n{\n\tif (tim == MY_TV_NSEC)\n\t\tfentry_called = true;\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}