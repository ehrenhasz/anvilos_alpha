{
  "module_name": "test_helper_restricted.c",
  "hash_id": "cc92cd8cca68a46dfe12b9e5a5df53de3c5ed1b3a65f18e9277d72dd7e74701c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_helper_restricted.c",
  "human_readable_source": "\n#include <time.h>\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n\nstruct timer {\n\tstruct bpf_timer t;\n};\n\nstruct lock {\n\tstruct bpf_spin_lock l;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, __u32);\n\t__type(value, struct timer);\n} timers SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, __u32);\n\t__type(value, struct lock);\n} locks SEC(\".maps\");\n\nstatic int timer_cb(void *map, int *key, struct timer *timer)\n{\n\treturn 0;\n}\n\nstatic void timer_work(void)\n{\n\tstruct timer *timer;\n\tconst int key = 0;\n\n\ttimer  = bpf_map_lookup_elem(&timers, &key);\n\tif (timer) {\n\t\tbpf_timer_init(&timer->t, &timers, CLOCK_MONOTONIC);\n\t\tbpf_timer_set_callback(&timer->t, timer_cb);\n\t\tbpf_timer_start(&timer->t, 10E9, 0);\n\t\tbpf_timer_cancel(&timer->t);\n\t}\n}\n\nstatic void spin_lock_work(void)\n{\n\tconst int key = 0;\n\tstruct lock *lock;\n\n\tlock = bpf_map_lookup_elem(&locks, &key);\n\tif (lock) {\n\t\tbpf_spin_lock(&lock->l);\n\t\tbpf_spin_unlock(&lock->l);\n\t}\n}\n\nSEC(\"?raw_tp/sys_enter\")\nint raw_tp_timer(void *ctx)\n{\n\ttimer_work();\n\n\treturn 0;\n}\n\nSEC(\"?tp/syscalls/sys_enter_nanosleep\")\nint tp_timer(void *ctx)\n{\n\ttimer_work();\n\n\treturn 0;\n}\n\nSEC(\"?kprobe\")\nint kprobe_timer(void *ctx)\n{\n\ttimer_work();\n\n\treturn 0;\n}\n\nSEC(\"?perf_event\")\nint perf_event_timer(void *ctx)\n{\n\ttimer_work();\n\n\treturn 0;\n}\n\nSEC(\"?raw_tp/sys_enter\")\nint raw_tp_spin_lock(void *ctx)\n{\n\tspin_lock_work();\n\n\treturn 0;\n}\n\nSEC(\"?tp/syscalls/sys_enter_nanosleep\")\nint tp_spin_lock(void *ctx)\n{\n\tspin_lock_work();\n\n\treturn 0;\n}\n\nSEC(\"?kprobe\")\nint kprobe_spin_lock(void *ctx)\n{\n\tspin_lock_work();\n\n\treturn 0;\n}\n\nSEC(\"?perf_event\")\nint perf_event_spin_lock(void *ctx)\n{\n\tspin_lock_work();\n\n\treturn 0;\n}\n\nconst char LICENSE[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}