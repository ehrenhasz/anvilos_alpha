{
  "module_name": "test_skeleton.c",
  "hash_id": "59c2cd15fa376a5936215b659e85b9d17c4406c955b1eb90bee8ab1465c4974f",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_skeleton.c",
  "human_readable_source": "\n \n\n#include <stdbool.h>\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n\n#define __read_mostly SEC(\".data.read_mostly\")\n\nstruct s {\n\tint a;\n\tlong long b;\n} __attribute__((packed));\n\n \nint in1 = -1;\nlong long in2 = -1;\n\n \nchar in3 = '\\0';\nlong long in4 __attribute__((aligned(64))) = 0;\nstruct s in5 = {};\n\n \nconst volatile struct {\n\tconst int in6;\n} in = {};\n\n \nint out1 = -1;\nlong long out2 = -1;\n\n \nchar out3 = 0;\nlong long out4 = 0;\nint out6 = 0;\n\nextern bool CONFIG_BPF_SYSCALL __kconfig;\nextern int LINUX_KERNEL_VERSION __kconfig;\nbool bpf_syscall = 0;\nint kern_ver = 0;\n\nstruct s out5 = {};\n\n\nconst volatile int in_dynarr_sz SEC(\".rodata.dyn\");\nconst volatile int in_dynarr[4] SEC(\".rodata.dyn\") = { -1, -2, -3, -4 };\n\nint out_dynarr[4] SEC(\".data.dyn\") = { 1, 2, 3, 4 };\n\nint read_mostly_var __read_mostly;\nint out_mostly_var;\n\nchar huge_arr[16 * 1024 * 1024];\n\n \n\nstruct my_value { int x, y, z; };\n\n__hidden int zero_key SEC(\".data.non_mmapable\");\nstatic struct my_value zero_value SEC(\".data.non_mmapable\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__type(key, int);\n\t__type(value, struct my_value);\n\t__uint(max_entries, 1);\n} my_map SEC(\".maps\");\n\nSEC(\"raw_tp/sys_enter\")\nint handler(const void *ctx)\n{\n\tint i;\n\n\tout1 = in1;\n\tout2 = in2;\n\tout3 = in3;\n\tout4 = in4;\n\tout5 = in5;\n\tout6 = in.in6;\n\n\tbpf_syscall = CONFIG_BPF_SYSCALL;\n\tkern_ver = LINUX_KERNEL_VERSION;\n\n\tfor (i = 0; i < in_dynarr_sz; i++)\n\t\tout_dynarr[i] = in_dynarr[i];\n\n\tout_mostly_var = read_mostly_var;\n\n\thuge_arr[sizeof(huge_arr) - 1] = 123;\n\n\t \n\tbpf_map_update_elem(&my_map, &zero_key, &zero_value, BPF_ANY);\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}