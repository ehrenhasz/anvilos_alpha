{
  "module_name": "verifier_movsx.c",
  "hash_id": "63569a380d9c8e0a6a12d64be70cc78174505c1c4f240ef5d1ef6368530fd102",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_movsx.c",
  "human_readable_source": "\n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\n#if (defined(__TARGET_ARCH_arm64) || defined(__TARGET_ARCH_x86) || \\\n     (defined(__TARGET_ARCH_riscv) && __riscv_xlen == 64)) && __clang_major__ >= 18\n\nSEC(\"socket\")\n__description(\"MOV32SX, S8\")\n__success __success_unpriv __retval(0x23)\n__naked void mov32sx_s8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw0 = 0xff23;\t\t\t\t\t\\\n\tw0 = (s8)w0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV32SX, S16\")\n__success __success_unpriv __retval(0xFFFFff23)\n__naked void mov32sx_s16(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw0 = 0xff23;\t\t\t\t\t\\\n\tw0 = (s16)w0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S8\")\n__success __success_unpriv __retval(-2)\n__naked void mov64sx_s8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0x1fe;\t\t\t\t\t\\\n\tr0 = (s8)r0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S16\")\n__success __success_unpriv __retval(0xf23)\n__naked void mov64sx_s16(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0xf0f23;\t\t\t\t\t\\\n\tr0 = (s16)r0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S32\")\n__success __success_unpriv __retval(-1)\n__naked void mov64sx_s32(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0xfffffffe;\t\t\t\t\\\n\tr0 = (s32)r0;\t\t\t\t\t\\\n\tr0 >>= 1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV32SX, S8, range_check\")\n__success __success_unpriv __retval(1)\n__naked void mov32sx_s8_range(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tw1 = (s8)w0;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tif w1 s> 0x7f goto l0_%=;\t\t\t\\\n\tif w1 s< -0x80 goto l0_%=;\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV32SX, S16, range_check\")\n__success __success_unpriv __retval(1)\n__naked void mov32sx_s16_range(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tw1 = (s16)w0;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tif w1 s> 0x7fff goto l0_%=;\t\t\t\\\n\tif w1 s< -0x80ff goto l0_%=;\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV32SX, S16, range_check 2\")\n__success __success_unpriv __retval(1)\n__naked void mov32sx_s16_range_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 65535;\t\t\t\t\t\\\n\tw2 = (s16)w1;\t\t\t\t\t\\\n\tr2 >>= 1;\t\t\t\t\t\\\n\tif r2 != 0x7fffFFFF goto l0_%=;\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S8, range_check\")\n__success __success_unpriv __retval(1)\n__naked void mov64sx_s8_range(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tr1 = (s8)r0;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tif r1 s> 0x7f goto l0_%=;\t\t\t\\\n\tif r1 s< -0x80 goto l0_%=;\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S16, range_check\")\n__success __success_unpriv __retval(1)\n__naked void mov64sx_s16_range(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tr1 = (s16)r0;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tif r1 s> 0x7fff goto l0_%=;\t\t\t\\\n\tif r1 s< -0x8000 goto l0_%=;\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S32, range_check\")\n__success __success_unpriv __retval(1)\n__naked void mov64sx_s32_range(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tr1 = (s32)r0;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tif r1 s> 0x7fffffff goto l0_%=;\t\t\t\\\n\tif r1 s< -0x80000000 goto l0_%=;\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\t\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"MOV64SX, S16, R10 Sign Extension\")\n__failure __msg(\"R1 type=scalar expected=fp, pkt, pkt_meta, map_key, map_value, mem, ringbuf_mem, buf, trusted_ptr_\")\n__failure_unpriv __msg_unpriv(\"R10 sign-extension part of pointer\")\n__naked void mov64sx_s16_r10(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 553656332;\t\t\t\t\t\\\n\t*(u32 *)(r10 - 8) = r1; \t\t\t\\\n\tr1 = (s16)r10;\t\t\t\t\t\\\n\tr1 += -8;\t\t\t\t\t\\\n\tr2 = 3;\t\t\t\t\t\t\\\n\tif r2 <= r1 goto l0_%=;\t\t\t\t\\\nl0_%=:\t\t\t\t\t\t\t\\\n\tcall %[bpf_trace_printk];\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_trace_printk)\n\t: __clobber_all);\n}\n\n#else\n\nSEC(\"socket\")\n__description(\"cpuv4 is not supported by compiler or jit, use a dummy test\")\n__success\nint dummy_test(void)\n{\n\treturn 0;\n}\n\n#endif\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}