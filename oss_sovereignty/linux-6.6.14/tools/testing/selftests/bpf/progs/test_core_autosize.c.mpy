{
  "module_name": "test_core_autosize.c",
  "hash_id": "a73a966be3039d35f1da1d9b0fff4168a95b663b008285565825f6ea7143ab97",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_core_autosize.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <stdint.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\n \nstruct test_struct___samesize {\n\tvoid *ptr;\n\tunsigned long long val1;\n\tunsigned int val2;\n\tunsigned short val3;\n\tunsigned char val4;\n} __attribute((preserve_access_index));\n\n \nstruct test_struct___downsize {\n\tvoid *ptr;\n\tunsigned long val1;\n\tunsigned long val2;\n\tunsigned long val3;\n\tunsigned long val4;\n\t \n} __attribute__((preserve_access_index));\n\n \nstruct test_struct___signed {\n\tvoid *ptr;\n\tlong val1;\n\tlong val2;\n\tlong val3;\n\tlong val4;\n} __attribute((preserve_access_index));\n\n \nstruct test_struct___real {\n\tunsigned int ptr;  \n\tunsigned int val2;\n\tunsigned long long val1;\n\tunsigned short val3;\n\tunsigned char val4;\n\tunsigned char _pad;\n\t \n};\n\nstruct test_struct___real input = {\n\t.ptr = 0x01020304,\n\t.val1 = 0x1020304050607080,\n\t.val2 = 0x0a0b0c0d,\n\t.val3 = 0xfeed,\n\t.val4 = 0xb9,\n\t._pad = 0xff,  \n};\n\nunsigned long long ptr_samesized = 0;\nunsigned long long val1_samesized = 0;\nunsigned long long val2_samesized = 0;\nunsigned long long val3_samesized = 0;\nunsigned long long val4_samesized = 0;\nstruct test_struct___real output_samesized = {};\n\nunsigned long long ptr_downsized = 0;\nunsigned long long val1_downsized = 0;\nunsigned long long val2_downsized = 0;\nunsigned long long val3_downsized = 0;\nunsigned long long val4_downsized = 0;\nstruct test_struct___real output_downsized = {};\n\nunsigned long long ptr_probed = 0;\nunsigned long long val1_probed = 0;\nunsigned long long val2_probed = 0;\nunsigned long long val3_probed = 0;\nunsigned long long val4_probed = 0;\n\nunsigned long long ptr_signed = 0;\nunsigned long long val1_signed = 0;\nunsigned long long val2_signed = 0;\nunsigned long long val3_signed = 0;\nunsigned long long val4_signed = 0;\nstruct test_struct___real output_signed = {};\n\nSEC(\"raw_tp/sys_exit\")\nint handle_samesize(void *ctx)\n{\n\tstruct test_struct___samesize *in = (void *)&input;\n\tstruct test_struct___samesize *out = (void *)&output_samesized;\n\n\tptr_samesized = (unsigned long long)in->ptr;\n\tval1_samesized = in->val1;\n\tval2_samesized = in->val2;\n\tval3_samesized = in->val3;\n\tval4_samesized = in->val4;\n\n\tout->ptr = in->ptr;\n\tout->val1 = in->val1;\n\tout->val2 = in->val2;\n\tout->val3 = in->val3;\n\tout->val4 = in->val4;\n\n\treturn 0;\n}\n\nSEC(\"raw_tp/sys_exit\")\nint handle_downsize(void *ctx)\n{\n\tstruct test_struct___downsize *in = (void *)&input;\n\tstruct test_struct___downsize *out = (void *)&output_downsized;\n\n\tptr_downsized = (unsigned long long)in->ptr;\n\tval1_downsized = in->val1;\n\tval2_downsized = in->val2;\n\tval3_downsized = in->val3;\n\tval4_downsized = in->val4;\n\n\tout->ptr = in->ptr;\n\tout->val1 = in->val1;\n\tout->val2 = in->val2;\n\tout->val3 = in->val3;\n\tout->val4 = in->val4;\n\n\treturn 0;\n}\n\n#if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__\n#define bpf_core_read_int bpf_core_read\n#else\n#define bpf_core_read_int(dst, sz, src) ({ \\\n\t  \\\n\tvolatile long __off = sizeof(*dst) - (sz); \\\n\tbpf_core_read((char *)(dst) + __off, sz, src); \\\n})\n#endif\n\nSEC(\"raw_tp/sys_enter\")\nint handle_probed(void *ctx)\n{\n\tstruct test_struct___downsize *in = (void *)&input;\n\t__u64 tmp;\n\n\ttmp = 0;\n\tbpf_core_read_int(&tmp, bpf_core_field_size(in->ptr), &in->ptr);\n\tptr_probed = tmp;\n\n\ttmp = 0;\n\tbpf_core_read_int(&tmp, bpf_core_field_size(in->val1), &in->val1);\n\tval1_probed = tmp;\n\n\ttmp = 0;\n\tbpf_core_read_int(&tmp, bpf_core_field_size(in->val2), &in->val2);\n\tval2_probed = tmp;\n\n\ttmp = 0;\n\tbpf_core_read_int(&tmp, bpf_core_field_size(in->val3), &in->val3);\n\tval3_probed = tmp;\n\n\ttmp = 0;\n\tbpf_core_read_int(&tmp, bpf_core_field_size(in->val4), &in->val4);\n\tval4_probed = tmp;\n\n\treturn 0;\n}\n\nSEC(\"raw_tp/sys_enter\")\nint handle_signed(void *ctx)\n{\n\tstruct test_struct___signed *in = (void *)&input;\n\tstruct test_struct___signed *out = (void *)&output_signed;\n\n\tval2_signed = in->val2;\n\tval3_signed = in->val3;\n\tval4_signed = in->val4;\n\n\tout->val2= in->val2;\n\tout->val3= in->val3;\n\tout->val4= in->val4;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}