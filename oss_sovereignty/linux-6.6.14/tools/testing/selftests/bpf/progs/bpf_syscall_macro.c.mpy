{
  "module_name": "bpf_syscall_macro.c",
  "hash_id": "c074e697e4ce01fd20326c97127628a8e7f3c4f388410b76e7f4923591e3cf6b",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/bpf_syscall_macro.c",
  "human_readable_source": "\n \n#include <vmlinux.h>\n\n#include <bpf/bpf_core_read.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include \"bpf_misc.h\"\n\nint arg1 = 0;\nunsigned long arg2 = 0;\nunsigned long arg3 = 0;\nunsigned long arg4_cx = 0;\nunsigned long arg4 = 0;\nunsigned long arg5 = 0;\n\nint arg1_core = 0;\nunsigned long arg2_core = 0;\nunsigned long arg3_core = 0;\nunsigned long arg4_core_cx = 0;\nunsigned long arg4_core = 0;\nunsigned long arg5_core = 0;\n\nint option_syscall = 0;\nunsigned long arg2_syscall = 0;\nunsigned long arg3_syscall = 0;\nunsigned long arg4_syscall = 0;\nunsigned long arg5_syscall = 0;\n\nconst volatile pid_t filter_pid = 0;\n\nSEC(\"kprobe/\" SYS_PREFIX \"sys_prctl\")\nint BPF_KPROBE(handle_sys_prctl)\n{\n\tstruct pt_regs *real_regs;\n\tpid_t pid = bpf_get_current_pid_tgid() >> 32;\n\tunsigned long tmp = 0;\n\n\tif (pid != filter_pid)\n\t\treturn 0;\n\n\treal_regs = PT_REGS_SYSCALL_REGS(ctx);\n\n\t \n\n#if !defined(bpf_target_arm64) && !defined(bpf_target_s390)\n\tbpf_probe_read_kernel(&tmp, sizeof(tmp), &PT_REGS_PARM1_SYSCALL(real_regs));\n#endif\n\targ1 = tmp;\n\tbpf_probe_read_kernel(&arg2, sizeof(arg2), &PT_REGS_PARM2_SYSCALL(real_regs));\n\tbpf_probe_read_kernel(&arg3, sizeof(arg3), &PT_REGS_PARM3_SYSCALL(real_regs));\n\tbpf_probe_read_kernel(&arg4_cx, sizeof(arg4_cx), &PT_REGS_PARM4(real_regs));\n\tbpf_probe_read_kernel(&arg4, sizeof(arg4), &PT_REGS_PARM4_SYSCALL(real_regs));\n\tbpf_probe_read_kernel(&arg5, sizeof(arg5), &PT_REGS_PARM5_SYSCALL(real_regs));\n\n\t \n\targ1_core = PT_REGS_PARM1_CORE_SYSCALL(real_regs);\n\targ2_core = PT_REGS_PARM2_CORE_SYSCALL(real_regs);\n\targ3_core = PT_REGS_PARM3_CORE_SYSCALL(real_regs);\n\targ4_core_cx = PT_REGS_PARM4_CORE(real_regs);\n\targ4_core = PT_REGS_PARM4_CORE_SYSCALL(real_regs);\n\targ5_core = PT_REGS_PARM5_CORE_SYSCALL(real_regs);\n\n\treturn 0;\n}\n\nSEC(\"ksyscall/prctl\")\nint BPF_KSYSCALL(prctl_enter, int option, unsigned long arg2,\n\t\t unsigned long arg3, unsigned long arg4, unsigned long arg5)\n{\n\tpid_t pid = bpf_get_current_pid_tgid() >> 32;\n\n\tif (pid != filter_pid)\n\t\treturn 0;\n\n\toption_syscall = option;\n\targ2_syscall = arg2;\n\targ3_syscall = arg3;\n\targ4_syscall = arg4;\n\targ5_syscall = arg5;\n\treturn 0;\n}\n\n__u64 splice_fd_in;\n__u64 splice_off_in;\n__u64 splice_fd_out;\n__u64 splice_off_out;\n__u64 splice_len;\n__u64 splice_flags;\n\nSEC(\"ksyscall/splice\")\nint BPF_KSYSCALL(splice_enter, int fd_in, loff_t *off_in, int fd_out,\n\t\t loff_t *off_out, size_t len, unsigned int flags)\n{\n\tpid_t pid = bpf_get_current_pid_tgid() >> 32;\n\n\tif (pid != filter_pid)\n\t\treturn 0;\n\n\tsplice_fd_in = fd_in;\n\tsplice_off_in = (__u64)off_in;\n\tsplice_fd_out = fd_out;\n\tsplice_off_out = (__u64)off_out;\n\tsplice_len = len;\n\tsplice_flags = flags;\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}