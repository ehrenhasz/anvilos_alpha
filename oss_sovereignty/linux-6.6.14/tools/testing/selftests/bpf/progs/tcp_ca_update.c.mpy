{
  "module_name": "tcp_ca_update.c",
  "hash_id": "d26e4dccf754587a80cdee116d818ba9feca41dc01b9935b1e19b1b32a3cf554",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/tcp_ca_update.c",
  "human_readable_source": "\n\n#include \"vmlinux.h\"\n\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nint ca1_cnt = 0;\nint ca2_cnt = 0;\n\nstatic inline struct tcp_sock *tcp_sk(const struct sock *sk)\n{\n\treturn (struct tcp_sock *)sk;\n}\n\nSEC(\"struct_ops/ca_update_1_init\")\nvoid BPF_PROG(ca_update_1_init, struct sock *sk)\n{\n\tca1_cnt++;\n}\n\nSEC(\"struct_ops/ca_update_2_init\")\nvoid BPF_PROG(ca_update_2_init, struct sock *sk)\n{\n\tca2_cnt++;\n}\n\nSEC(\"struct_ops/ca_update_cong_control\")\nvoid BPF_PROG(ca_update_cong_control, struct sock *sk,\n\t      const struct rate_sample *rs)\n{\n}\n\nSEC(\"struct_ops/ca_update_ssthresh\")\n__u32 BPF_PROG(ca_update_ssthresh, struct sock *sk)\n{\n\treturn tcp_sk(sk)->snd_ssthresh;\n}\n\nSEC(\"struct_ops/ca_update_undo_cwnd\")\n__u32 BPF_PROG(ca_update_undo_cwnd, struct sock *sk)\n{\n\treturn tcp_sk(sk)->snd_cwnd;\n}\n\nSEC(\".struct_ops.link\")\nstruct tcp_congestion_ops ca_update_1 = {\n\t.init = (void *)ca_update_1_init,\n\t.cong_control = (void *)ca_update_cong_control,\n\t.ssthresh = (void *)ca_update_ssthresh,\n\t.undo_cwnd = (void *)ca_update_undo_cwnd,\n\t.name = \"tcp_ca_update\",\n};\n\nSEC(\".struct_ops.link\")\nstruct tcp_congestion_ops ca_update_2 = {\n\t.init = (void *)ca_update_2_init,\n\t.cong_control = (void *)ca_update_cong_control,\n\t.ssthresh = (void *)ca_update_ssthresh,\n\t.undo_cwnd = (void *)ca_update_undo_cwnd,\n\t.name = \"tcp_ca_update\",\n};\n\nSEC(\".struct_ops.link\")\nstruct tcp_congestion_ops ca_wrong = {\n\t.cong_control = (void *)ca_update_cong_control,\n\t.ssthresh = (void *)ca_update_ssthresh,\n\t.undo_cwnd = (void *)ca_update_undo_cwnd,\n\t.name = \"tcp_ca_wrong\",\n};\n\nSEC(\".struct_ops\")\nstruct tcp_congestion_ops ca_no_link = {\n\t.cong_control = (void *)ca_update_cong_control,\n\t.ssthresh = (void *)ca_update_ssthresh,\n\t.undo_cwnd = (void *)ca_update_undo_cwnd,\n\t.name = \"tcp_ca_no_link\",\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}