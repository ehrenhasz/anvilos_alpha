{
  "module_name": "test_legacy_printk.c",
  "hash_id": "82233614babcaf0e41c67832613153320838ea56a9d34c68f61eaa93cf707f33",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_legacy_printk.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#define BPF_NO_GLOBAL_DATA\n#include <bpf/bpf_helpers.h>\n\nchar LICENSE[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__type(key, int);\n\t__type(value, int);\n\t__uint(max_entries, 1);\n} my_pid_map SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__type(key, int);\n\t__type(value, int);\n\t__uint(max_entries, 1);\n} res_map SEC(\".maps\");\n\nvolatile int my_pid_var = 0;\nvolatile int res_var = 0;\n\nSEC(\"tp/raw_syscalls/sys_enter\")\nint handle_legacy(void *ctx)\n{\n\tint zero = 0, *my_pid, cur_pid, *my_res;\n\n\tmy_pid = bpf_map_lookup_elem(&my_pid_map, &zero);\n\tif (!my_pid)\n\t\treturn 1;\n\n\tcur_pid = bpf_get_current_pid_tgid() >> 32;\n\tif (cur_pid != *my_pid)\n\t\treturn 1;\n\n\tmy_res = bpf_map_lookup_elem(&res_map, &zero);\n\tif (!my_res)\n\t\treturn 1;\n\n\tif (*my_res == 0)\n\t\t \n\t\tbpf_printk(\"Legacy-case bpf_printk test, pid %d\\n\", cur_pid);\n\t*my_res = 1;\n\n\treturn *my_res;\n}\n\nSEC(\"tp/raw_syscalls/sys_enter\")\nint handle_modern(void *ctx)\n{\n\tint cur_pid;\n\n\tcur_pid = bpf_get_current_pid_tgid() >> 32;\n\tif (cur_pid != my_pid_var)\n\t\treturn 1;\n\n\tif (res_var == 0)\n\t\t \n\t\tbpf_printk(\"Modern-case bpf_printk test, pid %d\\n\", cur_pid);\n\tres_var = 1;\n\n\treturn res_var;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}