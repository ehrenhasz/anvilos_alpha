{
  "module_name": "test_global_func_args.c",
  "hash_id": "5e57780536aa4c98cd1b124c6c60399cbbbcdf434282019cde7ddc92a312bdd3",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_global_func_args.c",
  "human_readable_source": "\n\n#include <linux/bpf.h>\n\n#include <bpf/bpf_helpers.h>\n\nstruct S {\n\tint v;\n};\n\nstruct S global_variable = {};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 7);\n\t__type(key, __u32);\n\t__type(value, int);\n} values SEC(\".maps\");\n\nstatic void save_value(__u32 index, int value)\n{\n\tbpf_map_update_elem(&values, &index, &value, 0);\n}\n\n__noinline int foo(__u32 index, struct S *s)\n{\n\tif (s) {\n\t\tsave_value(index, s->v);\n\t\treturn ++s->v;\n\t}\n\n\tsave_value(index, 0);\n\n\treturn 1;\n}\n\n__noinline int bar(__u32 index, volatile struct S *s)\n{\n\tif (s) {\n\t\tsave_value(index, s->v);\n\t\treturn ++s->v;\n\t}\n\n\tsave_value(index, 0);\n\n\treturn 1;\n}\n\n__noinline int baz(struct S **s)\n{\n\tif (s)\n\t\t*s = 0;\n\n\treturn 0;\n}\n\nSEC(\"cgroup_skb/ingress\")\nint test_cls(struct __sk_buff *skb)\n{\n\t__u32 index = 0;\n\n\t{\n\t\tconst int v = foo(index++, 0);\n\n\t\tsave_value(index++, v);\n\t}\n\n\t{\n\t\tstruct S s = { .v = 100 };\n\n\t\tfoo(index++, &s);\n\t\tsave_value(index++, s.v);\n\t}\n\n\t{\n\t\tglobal_variable.v = 42;\n\t\tbar(index++, &global_variable);\n\t\tsave_value(index++, global_variable.v);\n\t}\n\n\t{\n\t\tstruct S v, *p = &v;\n\n\t\tbaz(&p);\n\t\tsave_value(index++, !p);\n\t}\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}