{
  "module_name": "verifier_loops1.c",
  "hash_id": "195feb736d17b633dedabf6093b68e0ff3c88c16b0835e360b82b2db02daf3de",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_loops1.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"xdp\")\n__description(\"bounded loop, count to 4\")\n__success __retval(4)\n__naked void bounded_loop_count_to_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl0_%=:\tr0 += 1;\t\t\t\t\t\\\n\tif r0 < 4 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded loop, count to 20\")\n__success\n__naked void bounded_loop_count_to_20(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl0_%=:\tr0 += 3;\t\t\t\t\t\\\n\tif r0 < 20 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded loop, count from positive unknown to 4\")\n__success\n__naked void from_positive_unknown_to_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tif r0 s< 0 goto l0_%=;\t\t\t\t\\\nl1_%=:\tr0 += 1;\t\t\t\t\t\\\n\tif r0 < 4 goto l1_%=;\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded loop, count from totally unknown to 4\")\n__success\n__naked void from_totally_unknown_to_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\nl0_%=:\tr0 += 1;\t\t\t\t\t\\\n\tif r0 < 4 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded loop, count to 4 with equality\")\n__success\n__naked void count_to_4_with_equality(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl0_%=:\tr0 += 1;\t\t\t\t\t\\\n\tif r0 != 4 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"bounded loop, start in the middle\")\n__success\n__failure_unpriv __msg_unpriv(\"back-edge\")\n__naked void loop_start_in_the_middle(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tgoto l0_%=;\t\t\t\t\t\\\nl1_%=:\tr0 += 1;\t\t\t\t\t\\\nl0_%=:\tif r0 < 4 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"bounded loop containing a forward jump\")\n__success __retval(4)\n__naked void loop_containing_a_forward_jump(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl1_%=:\tr0 += 1;\t\t\t\t\t\\\n\tif r0 == r0 goto l0_%=;\t\t\t\t\\\nl0_%=:\tif r0 < 4 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded loop that jumps out rather than in\")\n__success\n__naked void jumps_out_rather_than_in(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr6 = 0;\t\t\t\t\t\t\\\nl1_%=:\tr6 += 1;\t\t\t\t\t\\\n\tif r6 > 10000 goto l0_%=;\t\t\t\\\n\tcall %[bpf_get_prandom_u32];\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_get_prandom_u32)\n\t: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"infinite loop after a conditional jump\")\n__failure __msg(\"program is too large\")\n__naked void loop_after_a_conditional_jump(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 5;\t\t\t\t\t\t\\\n\tif r0 < 4 goto l0_%=;\t\t\t\t\\\nl1_%=:\tr0 += 1;\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"bounded recursion\")\n__failure\n/* verifier limitation in detecting max stack depth */\n__msg(\"the call stack of 8 frames is too deep !\")\n__naked void bounded_recursion(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\tcall bounded_recursion__1;\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nstatic __naked __noinline __attribute__((used))\nvoid bounded_recursion__1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 += 1;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\tif r1 < 4 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tcall bounded_recursion__1;\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"infinite loop in two jumps\")\n__failure __msg(\"loop detected\")\n__naked void infinite_loop_in_two_jumps(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl1_%=:\tgoto l0_%=;\t\t\t\t\t\\\nl0_%=:\tif r0 < 4 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tracepoint\")\n__description(\"infinite loop: three-jump trick\")\n__failure __msg(\"loop detected\")\n__naked void infinite_loop_three_jump_trick(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl2_%=:\tr0 += 1;\t\t\t\t\t\\\n\tr0 &= 1;\t\t\t\t\t\\\n\tif r0 < 2 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 += 1;\t\t\t\t\t\\\n\tr0 &= 1;\t\t\t\t\t\\\n\tif r0 < 2 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl1_%=:\tr0 += 1;\t\t\t\t\t\\\n\tr0 &= 1;\t\t\t\t\t\\\n\tif r0 < 2 goto l2_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"not-taken loop with back jump to 1st insn\")\n__success __retval(123)\n__naked void back_jump_to_1st_insn_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\nl0_%=:\tr0 = 123;\t\t\t\t\t\\\n\tif r0 == 4 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"taken loop with back jump to 1st insn\")\n__success __retval(55)\n__naked void back_jump_to_1st_insn_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 10;\t\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\tcall back_jump_to_1st_insn_2__1;\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nstatic __naked __noinline __attribute__((used))\nvoid back_jump_to_1st_insn_2__1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\nl0_%=:\tr2 += r1;\t\t\t\t\t\\\n\tr1 -= 1;\t\t\t\t\t\\\n\tif r1 != 0 goto l0_%=;\t\t\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"taken loop with back jump to 1st insn, 2\")\n__success __retval(55)\n__naked void jump_to_1st_insn_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 10;\t\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\tcall jump_to_1st_insn_2__1;\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nstatic __naked __noinline __attribute__((used))\nvoid jump_to_1st_insn_2__1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\nl0_%=:\tr2 += r1;\t\t\t\t\t\\\n\tr1 -= 1;\t\t\t\t\t\\\n\tif w1 != 0 goto l0_%=;\t\t\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}