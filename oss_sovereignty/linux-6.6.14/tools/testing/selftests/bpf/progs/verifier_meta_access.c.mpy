{
  "module_name": "verifier_meta_access.c",
  "hash_id": "ee3e259f91fd119404d68e1a914eceda5d6835d8531330505324d71efe6e5190",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_meta_access.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"xdp\")\n__description(\"meta access, test1\")\n__success __retval(0)\n__naked void meta_access_test1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test2\")\n__failure __msg(\"invalid access to packet, off=-8\")\n__naked void meta_access_test2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 -= 8;\t\t\t\t\t\\\n\tr4 = r2;\t\t\t\t\t\\\n\tr4 += 8;\t\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test3\")\n__failure __msg(\"invalid access to packet\")\n__naked void meta_access_test3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data_end]);\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data_end, offsetof(struct xdp_md, data_end)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test4\")\n__failure __msg(\"invalid access to packet\")\n__naked void meta_access_test4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data_end]);\t\t\\\n\tr4 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r4;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_end, offsetof(struct xdp_md, data_end)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test5\")\n__failure __msg(\"R3 !read_ok\")\n__naked void meta_access_test5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr4 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r3;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r4 goto l0_%=;\t\t\t\t\\\n\tr2 = -8;\t\t\t\t\t\\\n\tcall %[bpf_xdp_adjust_meta];\t\t\t\\\n\tr0 = *(u8*)(r3 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_xdp_adjust_meta),\n\t  __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test6\")\n__failure __msg(\"invalid access to packet\")\n__naked void meta_access_test6(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r3;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tr4 = r2;\t\t\t\t\t\\\n\tr4 += 8;\t\t\t\t\t\\\n\tif r4 > r0 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test7\")\n__success __retval(0)\n__naked void meta_access_test7(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr0 = r3;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tr4 = r2;\t\t\t\t\t\\\n\tr4 += 8;\t\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test8\")\n__success __retval(0)\n__naked void meta_access_test8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr4 = r2;\t\t\t\t\t\\\n\tr4 += 0xFFFF;\t\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test9\")\n__failure __msg(\"invalid access to packet\")\n__naked void meta_access_test9(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr4 = r2;\t\t\t\t\t\\\n\tr4 += 0xFFFF;\t\t\t\t\t\\\n\tr4 += 1;\t\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test10\")\n__failure __msg(\"invalid access to packet\")\n__naked void meta_access_test10(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr4 = *(u32*)(r1 + %[xdp_md_data_end]);\t\t\\\n\tr5 = 42;\t\t\t\t\t\\\n\tr6 = 24;\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r5;\t\t\t\t\\\n\tlock *(u64 *)(r10 - 8) += r6;\t\t\t\\\n\tr5 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tif r5 > 100 goto l0_%=;\t\t\t\t\\\n\tr3 += r5;\t\t\t\t\t\\\n\tr5 = r3;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += 8;\t\t\t\t\t\\\n\tif r6 > r5 goto l0_%=;\t\t\t\t\\\n\tr2 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_end, offsetof(struct xdp_md, data_end)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test11\")\n__success __retval(0)\n__naked void meta_access_test11(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr5 = 42;\t\t\t\t\t\\\n\tr6 = 24;\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r5;\t\t\t\t\\\n\tlock *(u64 *)(r10 - 8) += r6;\t\t\t\\\n\tr5 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tif r5 > 100 goto l0_%=;\t\t\t\t\\\n\tr2 += r5;\t\t\t\t\t\\\n\tr5 = r2;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += 8;\t\t\t\t\t\\\n\tif r6 > r3 goto l0_%=;\t\t\t\t\\\n\tr5 = *(u8*)(r5 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nSEC(\"xdp\")\n__description(\"meta access, test12\")\n__success __retval(0)\n__naked void meta_access_test12(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[xdp_md_data_meta]);\t\t\\\n\tr3 = *(u32*)(r1 + %[xdp_md_data]);\t\t\\\n\tr4 = *(u32*)(r1 + %[xdp_md_data_end]);\t\t\\\n\tr5 = r3;\t\t\t\t\t\\\n\tr5 += 16;\t\t\t\t\t\\\n\tif r5 > r4 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r3 + 0);\t\t\t\t\\\n\tr5 = r2;\t\t\t\t\t\\\n\tr5 += 16;\t\t\t\t\t\\\n\tif r5 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(xdp_md_data, offsetof(struct xdp_md, data)),\n\t  __imm_const(xdp_md_data_end, offsetof(struct xdp_md, data_end)),\n\t  __imm_const(xdp_md_data_meta, offsetof(struct xdp_md, data_meta))\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}