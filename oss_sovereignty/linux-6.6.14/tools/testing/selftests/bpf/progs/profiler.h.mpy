{
  "module_name": "profiler.h",
  "hash_id": "f44806157b37ed8558df6fa9e393655e801b0567a19397469467dc9057e02cfa",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/profiler.h",
  "human_readable_source": "\n \n#pragma once\n\n#define TASK_COMM_LEN 16\n#define MAX_ANCESTORS 4\n#define MAX_PATH 256\n#define KILL_TARGET_LEN 64\n#define CTL_MAXNAME 10\n#define MAX_ARGS_LEN 4096\n#define MAX_FILENAME_LEN 512\n#define MAX_ENVIRON_LEN 8192\n#define MAX_PATH_DEPTH 32\n#define MAX_FILEPATH_LENGTH (MAX_PATH_DEPTH * MAX_PATH)\n#define MAX_CGROUPS_PATH_DEPTH 8\n\n#define MAX_METADATA_PAYLOAD_LEN TASK_COMM_LEN\n\n#define MAX_CGROUP_PAYLOAD_LEN \\\n\t(MAX_PATH * 2 + (MAX_PATH * MAX_CGROUPS_PATH_DEPTH))\n\n#define MAX_CAP_PAYLOAD_LEN (MAX_METADATA_PAYLOAD_LEN + MAX_CGROUP_PAYLOAD_LEN)\n\n#define MAX_SYSCTL_PAYLOAD_LEN \\\n\t(MAX_METADATA_PAYLOAD_LEN + MAX_CGROUP_PAYLOAD_LEN + CTL_MAXNAME + MAX_PATH)\n\n#define MAX_KILL_PAYLOAD_LEN \\\n\t(MAX_METADATA_PAYLOAD_LEN + MAX_CGROUP_PAYLOAD_LEN + TASK_COMM_LEN + \\\n\t KILL_TARGET_LEN)\n\n#define MAX_EXEC_PAYLOAD_LEN \\\n\t(MAX_METADATA_PAYLOAD_LEN + MAX_CGROUP_PAYLOAD_LEN + MAX_FILENAME_LEN + \\\n\t MAX_ARGS_LEN + MAX_ENVIRON_LEN)\n\n#define MAX_FILEMOD_PAYLOAD_LEN \\\n\t(MAX_METADATA_PAYLOAD_LEN + MAX_CGROUP_PAYLOAD_LEN + MAX_FILEPATH_LENGTH + \\\n\t MAX_FILEPATH_LENGTH)\n\nenum data_type {\n\tINVALID_EVENT,\n\tEXEC_EVENT,\n\tFORK_EVENT,\n\tKILL_EVENT,\n\tSYSCTL_EVENT,\n\tFILEMOD_EVENT,\n\tMAX_DATA_TYPE_EVENT\n};\n\nenum filemod_type {\n\tFMOD_OPEN,\n\tFMOD_LINK,\n\tFMOD_SYMLINK,\n};\n\nstruct ancestors_data_t {\n\tpid_t ancestor_pids[MAX_ANCESTORS];\n\tuint32_t ancestor_exec_ids[MAX_ANCESTORS];\n\tuint64_t ancestor_start_times[MAX_ANCESTORS];\n\tuint32_t num_ancestors;\n};\n\nstruct var_metadata_t {\n\tenum data_type type;\n\tpid_t pid;\n\tuint32_t exec_id;\n\tuid_t uid;\n\tgid_t gid;\n\tuint64_t start_time;\n\tuint32_t cpu_id;\n\tuint64_t bpf_stats_num_perf_events;\n\tuint64_t bpf_stats_start_ktime_ns;\n\tuint8_t comm_length;\n};\n\nstruct cgroup_data_t {\n\tino_t cgroup_root_inode;\n\tino_t cgroup_proc_inode;\n\tuint64_t cgroup_root_mtime;\n\tuint64_t cgroup_proc_mtime;\n\tuint16_t cgroup_root_length;\n\tuint16_t cgroup_proc_length;\n\tuint16_t cgroup_full_length;\n\tint cgroup_full_path_root_pos;\n};\n\nstruct var_sysctl_data_t {\n\tstruct var_metadata_t meta;\n\tstruct cgroup_data_t cgroup_data;\n\tstruct ancestors_data_t ancestors_info;\n\tuint8_t sysctl_val_length;\n\tuint16_t sysctl_path_length;\n\tchar payload[MAX_SYSCTL_PAYLOAD_LEN];\n};\n\nstruct var_kill_data_t {\n\tstruct var_metadata_t meta;\n\tstruct cgroup_data_t cgroup_data;\n\tstruct ancestors_data_t ancestors_info;\n\tpid_t kill_target_pid;\n\tint kill_sig;\n\tuint32_t kill_count;\n\tuint64_t last_kill_time;\n\tuint8_t kill_target_name_length;\n\tuint8_t kill_target_cgroup_proc_length;\n\tchar payload[MAX_KILL_PAYLOAD_LEN];\n\tsize_t payload_length;\n};\n\nstruct var_exec_data_t {\n\tstruct var_metadata_t meta;\n\tstruct cgroup_data_t cgroup_data;\n\tpid_t parent_pid;\n\tuint32_t parent_exec_id;\n\tuid_t parent_uid;\n\tuint64_t parent_start_time;\n\tuint16_t bin_path_length;\n\tuint16_t cmdline_length;\n\tuint16_t environment_length;\n\tchar payload[MAX_EXEC_PAYLOAD_LEN];\n};\n\nstruct var_fork_data_t {\n\tstruct var_metadata_t meta;\n\tpid_t parent_pid;\n\tuint32_t parent_exec_id;\n\tuint64_t parent_start_time;\n\tchar payload[MAX_METADATA_PAYLOAD_LEN];\n};\n\nstruct var_filemod_data_t {\n\tstruct var_metadata_t meta;\n\tstruct cgroup_data_t cgroup_data;\n\tenum filemod_type fmod_type;\n\tunsigned int dst_flags;\n\tuint32_t src_device_id;\n\tuint32_t dst_device_id;\n\tino_t src_inode;\n\tino_t dst_inode;\n\tuint16_t src_filepath_length;\n\tuint16_t dst_filepath_length;\n\tchar payload[MAX_FILEMOD_PAYLOAD_LEN];\n};\n\nstruct profiler_config_struct {\n\tbool fetch_cgroups_from_bpf;\n\tino_t cgroup_fs_inode;\n\tino_t cgroup_login_session_inode;\n\tuint64_t kill_signals_mask;\n\tino_t inode_filter;\n\tuint32_t stale_info_secs;\n\tbool use_variable_buffers;\n\tbool read_environ_from_exec;\n\tbool enable_cgroup_v1_resolver;\n};\n\nstruct bpf_func_stats_data {\n\tuint64_t time_elapsed_ns;\n\tuint64_t num_executions;\n\tuint64_t num_perf_events;\n};\n\nstruct bpf_func_stats_ctx {\n\tuint64_t start_time_ns;\n\tstruct bpf_func_stats_data* bpf_func_stats_data_val;\n};\n\nenum bpf_function_id {\n\tprofiler_bpf_proc_sys_write,\n\tprofiler_bpf_sched_process_exec,\n\tprofiler_bpf_sched_process_exit,\n\tprofiler_bpf_sys_enter_kill,\n\tprofiler_bpf_do_filp_open_ret,\n\tprofiler_bpf_sched_process_fork,\n\tprofiler_bpf_vfs_link,\n\tprofiler_bpf_vfs_symlink,\n\tprofiler_bpf_max_function_id\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}