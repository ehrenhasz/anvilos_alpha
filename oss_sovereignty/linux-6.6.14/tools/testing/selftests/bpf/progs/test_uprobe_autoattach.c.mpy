{
  "module_name": "test_uprobe_autoattach.c",
  "hash_id": "c8bea3322fed2f7dc4bcf4e16e40ee6cee4d9797e268bc92a393d2fe86d0d0f9",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_uprobe_autoattach.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n\n#include <bpf/bpf_core_read.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include \"bpf_misc.h\"\n\nint uprobe_byname_parm1 = 0;\nint uprobe_byname_ran = 0;\nint uretprobe_byname_rc = 0;\nint uretprobe_byname_ret = 0;\nint uretprobe_byname_ran = 0;\nu64 uprobe_byname2_parm1 = 0;\nint uprobe_byname2_ran = 0;\nu64 uretprobe_byname2_rc = 0;\nint uretprobe_byname2_ran = 0;\n\nint test_pid;\n\nint a[8];\n\n \nSEC(\"uprobe\")\nint handle_uprobe_noautoattach(struct pt_regs *ctx)\n{\n\treturn 0;\n}\n\nSEC(\"uprobe//proc/self/exe:autoattach_trigger_func\")\nint BPF_UPROBE(handle_uprobe_byname\n\t       , int arg1\n\t       , int arg2\n\t       , int arg3\n#if FUNC_REG_ARG_CNT > 3\n\t       , int arg4\n#endif\n#if FUNC_REG_ARG_CNT > 4\n\t       , int arg5\n#endif\n#if FUNC_REG_ARG_CNT > 5\n\t       , int arg6\n#endif\n#if FUNC_REG_ARG_CNT > 6\n\t       , int arg7\n#endif\n#if FUNC_REG_ARG_CNT > 7\n\t       , int arg8\n#endif\n)\n{\n\tuprobe_byname_parm1 = PT_REGS_PARM1_CORE(ctx);\n\tuprobe_byname_ran = 1;\n\n\ta[0] = arg1;\n\ta[1] = arg2;\n\ta[2] = arg3;\n#if FUNC_REG_ARG_CNT > 3\n\ta[3] = arg4;\n#endif\n#if FUNC_REG_ARG_CNT > 4\n\ta[4] = arg5;\n#endif\n#if FUNC_REG_ARG_CNT > 5\n\ta[5] = arg6;\n#endif\n#if FUNC_REG_ARG_CNT > 6\n\ta[6] = arg7;\n#endif\n#if FUNC_REG_ARG_CNT > 7\n\ta[7] = arg8;\n#endif\n\treturn 0;\n}\n\nSEC(\"uretprobe//proc/self/exe:autoattach_trigger_func\")\nint BPF_URETPROBE(handle_uretprobe_byname, int ret)\n{\n\turetprobe_byname_rc = PT_REGS_RC_CORE(ctx);\n\turetprobe_byname_ret = ret;\n\turetprobe_byname_ran = 2;\n\n\treturn 0;\n}\n\n\nSEC(\"uprobe/libc.so.6:fopen\")\nint BPF_UPROBE(handle_uprobe_byname2, const char *pathname, const char *mode)\n{\n\tint pid = bpf_get_current_pid_tgid() >> 32;\n\n\t \n\tif (test_pid != pid)\n\t\treturn 0;\n\tuprobe_byname2_parm1 = (u64)(long)pathname;\n\tuprobe_byname2_ran = 3;\n\treturn 0;\n}\n\nSEC(\"uretprobe/libc.so.6:fopen\")\nint BPF_URETPROBE(handle_uretprobe_byname2, void *ret)\n{\n\tint pid = bpf_get_current_pid_tgid() >> 32;\n\n\t \n\tif (test_pid != pid)\n\t\treturn 0;\n\turetprobe_byname2_rc = (u64)(long)ret;\n\turetprobe_byname2_ran = 4;\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}