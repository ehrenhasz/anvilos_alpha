{
  "module_name": "test_global_data.c",
  "hash_id": "d4aa56f0c2a15a79b09da8c62964ec13ca3645f3e6a6e1e859d32a7a0113759b",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_global_data.c",
  "human_readable_source": "\n\n\n#include <linux/bpf.h>\n#include <linux/pkt_cls.h>\n#include <string.h>\n\n#include <bpf/bpf_helpers.h>\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 11);\n\t__type(key, __u32);\n\t__type(value, __u64);\n} result_number SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 5);\n\t__type(key, __u32);\n\tconst char (*value)[32];\n} result_string SEC(\".maps\");\n\nstruct foo {\n\t__u8  a;\n\t__u32 b;\n\t__u64 c;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 5);\n\t__type(key, __u32);\n\t__type(value, struct foo);\n} result_struct SEC(\".maps\");\n\n \nstatic       __u64 num0;\nstatic       __u64 num1 = 42;\nstatic const __u64 num2 = 24;\nstatic       __u64 num3 = 0;\nstatic       __u64 num4 = 0xffeeff;\nstatic const __u64 num5 = 0xabab;\nstatic const __u64 num6 = 0xab;\n\n \nstatic const char str0[32] = \"abcdefghijklmnopqrstuvwxyz\";\nstatic       char str1[32] = \"abcdefghijklmnopqrstuvwxyz\";\nstatic       char str2[32];\n\n \nstatic const struct foo struct0 = {\n\t.a = 42,\n\t.b = 0xfefeefef,\n\t.c = 0x1111111111111111ULL,\n};\nstatic struct foo struct1;\nstatic const struct foo struct2;\nstatic struct foo struct3 = {\n\t.a = 41,\n\t.b = 0xeeeeefef,\n\t.c = 0x2111111111111111ULL,\n};\n\n#define test_reloc(map, num, var)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t__u32 key = num;\t\t\t\t\t\\\n\t\tbpf_map_update_elem(&result_##map, &key, var, 0);\t\\\n\t} while (0)\n\nSEC(\"tc\")\nint load_static_data(struct __sk_buff *skb)\n{\n\tstatic const __u64 bar = ~0;\n\n\ttest_reloc(number, 0, &num0);\n\ttest_reloc(number, 1, &num1);\n\ttest_reloc(number, 2, &num2);\n\ttest_reloc(number, 3, &num3);\n\ttest_reloc(number, 4, &num4);\n\ttest_reloc(number, 5, &num5);\n\tnum4 = 1234;\n\ttest_reloc(number, 6, &num4);\n\ttest_reloc(number, 7, &num0);\n\ttest_reloc(number, 8, &num6);\n\n\ttest_reloc(string, 0, str0);\n\ttest_reloc(string, 1, str1);\n\ttest_reloc(string, 2, str2);\n\tstr1[5] = 'x';\n\ttest_reloc(string, 3, str1);\n\t__builtin_memcpy(&str2[2], \"hello\", sizeof(\"hello\"));\n\ttest_reloc(string, 4, str2);\n\n\ttest_reloc(struct, 0, &struct0);\n\ttest_reloc(struct, 1, &struct1);\n\ttest_reloc(struct, 2, &struct2);\n\ttest_reloc(struct, 3, &struct3);\n\n\ttest_reloc(number,  9, &struct0.c);\n\ttest_reloc(number, 10, &bar);\n\n\treturn TC_ACT_OK;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}