{
  "module_name": "verifier_value_ptr_arith.c",
  "hash_id": "fc8820f818b7e9ca5fae4aa87f455616a154b593d660d48343c2eb26a09ee9a0",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_value_ptr_arith.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include <errno.h>\n#include \"bpf_misc.h\"\n\n#define MAX_ENTRIES 11\n\nstruct test_val {\n\tunsigned int index;\n\tint foo[MAX_ENTRIES];\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, int);\n\t__type(value, struct test_val);\n} map_array_48b SEC(\".maps\");\n\nstruct other_val {\n\tlong long foo;\n\tlong long bar;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_HASH);\n\t__uint(max_entries, 1);\n\t__type(key, long long);\n\t__type(value, struct other_val);\n} map_hash_16b SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_HASH);\n\t__uint(max_entries, 1);\n\t__type(key, long long);\n\t__type(value, struct test_val);\n} map_hash_48b SEC(\".maps\");\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr unknown vs const\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 tried to add from different maps, paths or scalars\")\n__retval(1)\n__naked void value_ptr_unknown_vs_const(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 3;\t\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr const vs unknown\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 tried to add from different maps, paths or scalars\")\n__retval(1)\n__naked void value_ptr_const_vs_unknown(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 3;\t\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr const vs const (ne)\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 tried to add from different maps, paths or scalars\")\n__retval(1)\n__naked void ptr_const_vs_const_ne(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 3;\t\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 5;\t\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr const vs const (eq)\")\n__success __success_unpriv __retval(1)\n__naked void ptr_const_vs_const_eq(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 5;\t\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 5;\t\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr unknown vs unknown (eq)\")\n__success __success_unpriv __retval(1)\n__naked void ptr_unknown_vs_unknown_eq(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr unknown vs unknown (lt)\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 tried to add from different maps, paths or scalars\")\n__retval(1)\n__naked void ptr_unknown_vs_unknown_lt(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x3;\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr unknown vs unknown (gt)\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 tried to add from different maps, paths or scalars\")\n__retval(1)\n__naked void ptr_unknown_vs_unknown_gt(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr4 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tif r4 == 1 goto l3_%=;\t\t\t\t\\\n\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\tr1 = 6;\t\t\t\t\t\t\\\n\tr1 = -r1;\t\t\t\t\t\\\n\tr1 &= 0x3;\t\t\t\t\t\\\nl4_%=:\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr from different maps\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_from_different_maps(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar from different maps\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 min value is outside of the allowed memory range\")\n__retval(1)\n__naked void known_scalar_from_different_maps(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_16b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_16b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr from different maps, but same value properties\")\n__success __success_unpriv __retval(1)\n__naked void maps_but_same_value_properties(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tif r0 == 1 goto l0_%=;\t\t\t\t\\\n\tr1 = %[map_hash_48b] ll;\t\t\t\\\n\tif r0 != 1 goto l1_%=;\t\t\t\t\\\nl0_%=:\tr1 = %[map_array_48b] ll;\t\t\t\\\nl1_%=:\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l2_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl2_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_addr(map_hash_48b),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: mixing value pointer and scalar, 1\")\n__success __failure_unpriv __msg_unpriv(\"R2 pointer comparison prohibited\")\n__retval(0)\n__naked void value_pointer_and_scalar_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -16;\t\t\t\t\t\\\n\tr6 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 16) = r6;\t\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t \t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\t \t\t\t\\\n\tif r1 != 0 goto l1_%=;\t\t\t\t\\\n\t \t\t\t\t\t\\\n\tr2 = r0;\t\t\t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\tgoto l2_%=;\t\t\t\t\t\\\nl1_%=:\t \t\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\tr3 = 0x100000;\t\t\t\t\t\\\nl2_%=:\t \t\t\t\\\n\tr2 += r3;\t\t\t\t\t\\\n\t \t\t\t\\\n\tif r1 != 0 goto l3_%=;\t\t\t\t\\\n\t \t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\t \t\t\t\t\t\\\n\tr0 = 0x13371337;\t\t\t\t\\\n\t \t\t\\\n\tif r2 != 0x100000 goto l4_%=;\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl4_%=:\t \t\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: mixing value pointer and scalar, 2\")\n__success __failure_unpriv __msg_unpriv(\"R0 invalid mem access 'scalar'\")\n__retval(0)\n__naked void value_pointer_and_scalar_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -16;\t\t\t\t\t\\\n\tr6 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 16) = r6;\t\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t \t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\t \t\t\t\\\n\tif r1 == 0 goto l1_%=;\t\t\t\t\\\n\t \t\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\tr3 = 0x100000;\t\t\t\t\t\\\n\tgoto l2_%=;\t\t\t\t\t\\\nl1_%=:\t \t\t\t\t\t\\\n\tr2 = r0;\t\t\t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\nl2_%=:\t \t\t\t\\\n\tr2 += r3;\t\t\t\t\t\\\n\t \t\t\t\\\n\tif r1 != 0 goto l3_%=;\t\t\t\t\\\n\t \t\t\t\t\t\\\n\tgoto l4_%=;\t\t\t\t\t\\\nl3_%=:\t \t\t\t\t\t\\\n\tr0 = 0x13371337;\t\t\t\t\\\n\t \t\t\\\n\tif r2 != 0x100000 goto l4_%=;\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl4_%=:\t \t\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"sanitation: alu with different scalars 1\")\n__success __success_unpriv __retval(0x100000)\n__naked void alu_with_different_scalars_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -16;\t\t\t\t\t\\\n\tr6 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 16) = r6;\t\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr1 = *(u32*)(r0 + 0);\t\t\t\t\\\n\tif r1 == 0 goto l1_%=;\t\t\t\t\\\n\tr2 = 0;\t\t\t\t\t\t\\\n\tr3 = 0x100000;\t\t\t\t\t\\\n\tgoto l2_%=;\t\t\t\t\t\\\nl1_%=:\tr2 = 42;\t\t\t\t\t\\\n\tr3 = 0x100001;\t\t\t\t\t\\\nl2_%=:\tr2 += r3;\t\t\t\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"sanitation: alu with different scalars 2\")\n__success __success_unpriv __retval(0)\n__naked void alu_with_different_scalars_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tr6 = r1;\t\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -16;\t\t\t\t\t\\\n\tr7 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 16) = r7;\t\t\t\t\\\n\tcall %[bpf_map_delete_elem];\t\t\t\\\n\tr7 = r0;\t\t\t\t\t\\\n\tr1 = r6;\t\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -16;\t\t\t\t\t\\\n\tcall %[bpf_map_delete_elem];\t\t\t\\\n\tr6 = r0;\t\t\t\t\t\\\n\tr8 = r6;\t\t\t\t\t\\\n\tr8 += r7;\t\t\t\t\t\\\n\tr0 = r8;\t\t\t\t\t\\\n\tr0 += %[einval];\t\t\t\t\\\n\tr0 += %[einval];\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_delete_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_const(einval, EINVAL)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"sanitation: alu with different scalars 3\")\n__success __success_unpriv __retval(0)\n__naked void alu_with_different_scalars_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = %[einval];\t\t\t\t\t\\\n\tr0 *= -1;\t\t\t\t\t\\\n\tr7 = r0;\t\t\t\t\t\\\n\tr0 = %[einval];\t\t\t\t\t\\\n\tr0 *= -1;\t\t\t\t\t\\\n\tr6 = r0;\t\t\t\t\t\\\n\tr8 = r6;\t\t\t\t\t\\\n\tr8 += r7;\t\t\t\t\t\\\n\tr0 = r8;\t\t\t\t\t\\\n\tr0 += %[einval];\t\t\t\t\\\n\tr0 += %[einval];\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(einval, EINVAL)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, upper oob arith, test 1\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__retval(1)\n__naked void upper_oob_arith_test_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 48;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, upper oob arith, test 2\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__retval(1)\n__naked void upper_oob_arith_test_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 49;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, upper oob arith, test 3\")\n__success __success_unpriv __retval(1)\n__naked void upper_oob_arith_test_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 47;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar, lower oob arith, test 1\")\n__failure __msg(\"R0 min value is outside of the allowed memory range\")\n__failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__naked void lower_oob_arith_test_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 47;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = 48;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar, lower oob arith, test 2\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__retval(1)\n__naked void lower_oob_arith_test_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 47;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = 48;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr1 = 1;\t\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar, lower oob arith, test 3\")\n__success __success_unpriv __retval(1)\n__naked void lower_oob_arith_test_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 47;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = 47;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar += value_ptr\")\n__success __success_unpriv __retval(1)\n__naked void access_known_scalar_value_ptr_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 1\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_known_scalar_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 2\")\n__failure __msg(\"invalid access to map value\")\n__failure_unpriv\n__naked void value_ptr_known_scalar_2_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 49;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 3\")\n__failure __msg(\"invalid access to map value\")\n__failure_unpriv\n__naked void value_ptr_known_scalar_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = -1;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 4\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_known_scalar_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 5;\t\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = -2;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = -1;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 5\")\n__success __success_unpriv __retval(0xabcdef12)\n__naked void value_ptr_known_scalar_5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = %[__imm_0];\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_const(__imm_0, (6 + 1) * sizeof(int))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += known scalar, 6\")\n__success __success_unpriv __retval(0xabcdef12)\n__naked void value_ptr_known_scalar_6(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = %[__imm_0];\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = %[__imm_1];\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 = *(u32*)(r0 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b),\n\t  __imm_const(__imm_0, (3 + 1) * sizeof(int)),\n\t  __imm_const(__imm_1, 3 * sizeof(int))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += N, value_ptr -= N known scalar\")\n__success __success_unpriv __retval(0x12345678)\n__naked void value_ptr_n_known_scalar(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tw1 = 0x12345678;\t\t\t\t\\\n\t*(u32*)(r0 + 0) = r1;\t\t\t\t\\\n\tr0 += 2;\t\t\t\t\t\\\n\tr1 = 2;\t\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr0 = *(u32*)(r0 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: unknown scalar += value_ptr, 1\")\n__success __success_unpriv __retval(1)\n__naked void unknown_scalar_value_ptr_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: unknown scalar += value_ptr, 2\")\n__success __success_unpriv __retval(0xabcdef12) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void unknown_scalar_value_ptr_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u32*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 31;\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: unknown scalar += value_ptr, 3\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__retval(0xabcdef12) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void unknown_scalar_value_ptr_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = -1;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = 1;\t\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u32*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 31;\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: unknown scalar += value_ptr, 4\")\n__failure __msg(\"R1 max value is outside of the allowed memory range\")\n__msg_unpriv(\"R1 pointer arithmetic of map value goes out of range\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void unknown_scalar_value_ptr_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 19;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u32*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 31;\t\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += unknown scalar, 1\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_unknown_scalar_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += unknown scalar, 2\")\n__success __success_unpriv __retval(0xabcdef12) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void value_ptr_unknown_scalar_2_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u32*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 31;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 = *(u32*)(r0 + 0);\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += unknown scalar, 3\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_unknown_scalar_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u64*)(r0 + 0);\t\t\t\t\\\n\tr2 = *(u64*)(r0 + 8);\t\t\t\t\\\n\tr3 = *(u64*)(r0 + 16);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr3 &= 1;\t\t\t\t\t\\\n\tr3 |= 1;\t\t\t\t\t\\\n\tif r2 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 += r3;\t\t\t\t\t\\\n\tr0 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl1_%=:\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 2;\t\t\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr += value_ptr\")\n__failure __msg(\"R0 pointer += pointer prohibited\")\n__failure_unpriv\n__naked void access_value_ptr_value_ptr_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr0 += r0;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: known scalar -= value_ptr\")\n__failure __msg(\"R1 tried to subtract pointer from scalar\")\n__failure_unpriv\n__naked void access_known_scalar_value_ptr_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr1 -= r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar\")\n__failure __msg(\"R0 min value is outside of the allowed memory range\")\n__failure_unpriv\n__naked void access_value_ptr_known_scalar(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 4;\t\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= known scalar, 2\")\n__success __success_unpriv __retval(1)\n__naked void value_ptr_known_scalar_2_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = 6;\t\t\t\t\t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr0 -= r2;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: unknown scalar -= value_ptr\")\n__failure __msg(\"R1 tried to subtract pointer from scalar\")\n__failure_unpriv\n__naked void access_unknown_scalar_value_ptr(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr1 -= r0;\t\t\t\t\t\\\n\tr0 = *(u8*)(r1 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= unknown scalar\")\n__failure __msg(\"R0 min value is negative\")\n__failure_unpriv\n__naked void access_value_ptr_unknown_scalar(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= unknown scalar, 2\")\n__success __failure_unpriv\n__msg_unpriv(\"R0 pointer arithmetic of map value goes out of range\")\n__retval(1)\n__naked void value_ptr_unknown_scalar_2_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0xf;\t\t\t\t\t\\\n\tr1 |= 0x7;\t\t\t\t\t\\\n\tr0 += r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\n\tr1 &= 0x7;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: value_ptr -= value_ptr\")\n__failure __msg(\"R0 invalid mem access 'scalar'\")\n__msg_unpriv(\"R0 pointer -= pointer prohibited\")\n__naked void access_value_ptr_value_ptr_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr0 -= r0;\t\t\t\t\t\\\n\tr1 = *(u8*)(r0 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"map access: trying to leak tainted dst reg\")\n__failure __msg(\"math between map_value pointer and 4294967295 is not allowed\")\n__failure_unpriv\n__naked void to_leak_tainted_dst_reg(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tr1 = 0;\t\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r1;\t\t\t\t\\\n\tr2 = r10;\t\t\t\t\t\\\n\tr2 += -8;\t\t\t\t\t\\\n\tr1 = %[map_array_48b] ll;\t\t\t\\\n\tcall %[bpf_map_lookup_elem];\t\t\t\\\n\tif r0 != 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr2 = r0;\t\t\t\t\t\\\n\tw1 = 0xFFFFFFFF;\t\t\t\t\\\n\tw1 = w1;\t\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\t*(u64*)(r0 + 0) = r2;\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_map_lookup_elem),\n\t  __imm_addr(map_array_48b)\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"32bit pkt_ptr -= scalar\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void _32bit_pkt_ptr_scalar(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr8 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr7 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr6 = r7;\t\t\t\t\t\\\n\tr6 += 40;\t\t\t\t\t\\\n\tif r6 > r8 goto l0_%=;\t\t\t\t\\\n\tw4 = w7;\t\t\t\t\t\\\n\tw6 -= w4;\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"32bit scalar -= pkt_ptr\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void _32bit_scalar_pkt_ptr(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr8 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr7 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr6 = r7;\t\t\t\t\t\\\n\tr6 += 40;\t\t\t\t\t\\\n\tif r6 > r8 goto l0_%=;\t\t\t\t\\\n\tw4 = w6;\t\t\t\t\t\\\n\tw4 -= w7;\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}