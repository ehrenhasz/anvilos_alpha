{
  "module_name": "get_func_ip_test.c",
  "hash_id": "3ed9943220210d30a5eabe826964b0c4cd73ae756ed41e4799c51e90b1f1296d",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/get_func_ip_test.c",
  "human_readable_source": "\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nextern const void bpf_fentry_test1 __ksym;\nextern const void bpf_fentry_test2 __ksym;\nextern const void bpf_fentry_test3 __ksym;\nextern const void bpf_fentry_test4 __ksym;\nextern const void bpf_modify_return_test __ksym;\nextern const void bpf_fentry_test6 __ksym;\nextern const void bpf_fentry_test7 __ksym;\n\nextern bool CONFIG_X86_KERNEL_IBT __kconfig __weak;\n\n \nint unused(void)\n{\n\treturn CONFIG_X86_KERNEL_IBT ? 0 : 1;\n}\n\n__u64 test1_result = 0;\nSEC(\"fentry/bpf_fentry_test1\")\nint BPF_PROG(test1, int a)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest1_result = (const void *) addr == &bpf_fentry_test1;\n\treturn 0;\n}\n\n__u64 test2_result = 0;\nSEC(\"fexit/bpf_fentry_test2\")\nint BPF_PROG(test2, int a)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest2_result = (const void *) addr == &bpf_fentry_test2;\n\treturn 0;\n}\n\n__u64 test3_result = 0;\nSEC(\"kprobe/bpf_fentry_test3\")\nint test3(struct pt_regs *ctx)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest3_result = (const void *) addr == &bpf_fentry_test3;\n\treturn 0;\n}\n\n__u64 test4_result = 0;\nSEC(\"kretprobe/bpf_fentry_test4\")\nint BPF_KRETPROBE(test4)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest4_result = (const void *) addr == &bpf_fentry_test4;\n\treturn 0;\n}\n\n__u64 test5_result = 0;\nSEC(\"fmod_ret/bpf_modify_return_test\")\nint BPF_PROG(test5, int a, int *b, int ret)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest5_result = (const void *) addr == &bpf_modify_return_test;\n\treturn ret;\n}\n\n__u64 test6_result = 0;\nSEC(\"?kprobe\")\nint test6(struct pt_regs *ctx)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest6_result = (const void *) addr == 0;\n\treturn 0;\n}\n\nunsigned long uprobe_trigger;\n\n__u64 test7_result = 0;\nSEC(\"uprobe//proc/self/exe:uprobe_trigger\")\nint BPF_UPROBE(test7)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest7_result = (const void *) addr == (const void *) uprobe_trigger;\n\treturn 0;\n}\n\n__u64 test8_result = 0;\nSEC(\"uretprobe//proc/self/exe:uprobe_trigger\")\nint BPF_URETPROBE(test8, int ret)\n{\n\t__u64 addr = bpf_get_func_ip(ctx);\n\n\ttest8_result = (const void *) addr == (const void *) uprobe_trigger;\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}