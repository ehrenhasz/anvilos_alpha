{
  "module_name": "verifier_masking.c",
  "hash_id": "d3e9d7df4f9b76ebb7561caf0bb656509a70e082486147db2ffff74fc34ce6d2",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_masking.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 1\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 5;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 5 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 2\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 1;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 3\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0xffffffff;\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 4\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0xffffffff;\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 5\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 6\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_6(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 7\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_7(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 5;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 5 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 8\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 1;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 9\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_9(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0xffffffff;\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 10\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_10(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = 0xffffffff;\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 11\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_11(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test out of bounds 12\")\n__success __success_unpriv __retval(0)\n__naked void test_out_of_bounds_12(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr1 = -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 1\")\n__success __success_unpriv __retval(4)\n__naked void masking_test_in_bounds_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 4;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 5 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 2\")\n__success __success_unpriv __retval(0)\n__naked void masking_test_in_bounds_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 3\")\n__success __success_unpriv __retval(0xfffffffe)\n__naked void masking_test_in_bounds_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0xfffffffe;\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffffffff - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 4\")\n__success __success_unpriv __retval(0xabcde)\n__naked void masking_test_in_bounds_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0xabcde;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xabcdef - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 5\")\n__success __success_unpriv __retval(0)\n__naked void masking_test_in_bounds_5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 0;\t\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 1 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 6\")\n__success __success_unpriv __retval(46)\n__naked void masking_test_in_bounds_6(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tw1 = 46;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r1;\t\t\t\t\t\\\n\tr2 |= r1;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr1 &= r2;\t\t\t\t\t\\\n\tr0 = r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 47 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 7\")\n__success __success_unpriv __retval(46)\n__naked void masking_test_in_bounds_7(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr3 = -46;\t\t\t\t\t\\\n\tr3 *= -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r3;\t\t\t\t\t\\\n\tr2 |= r3;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr3 &= r2;\t\t\t\t\t\\\n\tr0 = r3;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 47 - 1)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"masking, test in bounds 8\")\n__success __success_unpriv __retval(0)\n__naked void masking_test_in_bounds_8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr3 = -47;\t\t\t\t\t\\\n\tr3 *= -1;\t\t\t\t\t\\\n\tw2 = %[__imm_0];\t\t\t\t\\\n\tr2 -= r3;\t\t\t\t\t\\\n\tr2 |= r3;\t\t\t\t\t\\\n\tr2 = -r2;\t\t\t\t\t\\\n\tr2 s>>= 63;\t\t\t\t\t\\\n\tr3 &= r2;\t\t\t\t\t\\\n\tr0 = r3;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 47 - 1)\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}