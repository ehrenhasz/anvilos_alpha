{
  "module_name": "verifier_int_ptr.c",
  "hash_id": "5f0c3e5f8d8795abb35fc7b36d3fef1849cf209bb40cc411bc950695d7e953a2",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_int_ptr.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"socket\")\n__description(\"ARG_PTR_TO_LONG uninitialized\")\n__success\n__failure_unpriv __msg_unpriv(\"invalid indirect read from stack R4 off -16+0 size 8\")\n__naked void arg_ptr_to_long_uninitialized(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 = r10;\t\t\t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\tr0 = 0x00303036;\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\t \t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\tr4 = r7;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tcall %[bpf_strtoul];\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_strtoul)\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"ARG_PTR_TO_LONG half-uninitialized\")\n/* in privileged mode reads from uninitialized stack locations are permitted */\n__success __failure_unpriv\n__msg_unpriv(\"invalid indirect read from stack R4 off -16+4 size 8\")\n__retval(0)\n__naked void ptr_to_long_half_uninitialized(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 = r10;\t\t\t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\tr0 = 0x00303036;\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\t \t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\t*(u32*)(r7 + 0) = r0;\t\t\t\t\\\n\tr4 = r7;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tcall %[bpf_strtoul];\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_strtoul)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/sysctl\")\n__description(\"ARG_PTR_TO_LONG misaligned\")\n__failure __msg(\"misaligned stack access off (0x0; 0x0)+-20+0 size 8\")\n__naked void arg_ptr_to_long_misaligned(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 = r10;\t\t\t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\tr0 = 0x00303036;\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\t \t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 += -12;\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\t*(u32*)(r7 + 0) = r0;\t\t\t\t\\\n\t*(u64*)(r7 + 4) = r0;\t\t\t\t\\\n\tr4 = r7;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tcall %[bpf_strtoul];\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_strtoul)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/sysctl\")\n__description(\"ARG_PTR_TO_LONG size < sizeof(long)\")\n__failure __msg(\"invalid indirect access to stack R4 off=-4 size=8\")\n__naked void to_long_size_sizeof_long(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 = r10;\t\t\t\t\t\\\n\tr7 += -16;\t\t\t\t\t\\\n\tr0 = 0x00303036;\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\t \t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 += 12;\t\t\t\t\t\\\n\t*(u32*)(r7 + 0) = r0;\t\t\t\t\\\n\tr4 = r7;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tcall %[bpf_strtoul];\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_strtoul)\n\t: __clobber_all);\n}\n\nSEC(\"cgroup/sysctl\")\n__description(\"ARG_PTR_TO_LONG initialized\")\n__success\n__naked void arg_ptr_to_long_initialized(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 = r10;\t\t\t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\tr0 = 0x00303036;\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr1 = r7;\t\t\t\t\t\\\n\t \t\t\\\n\tr2 = 4;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr3 = 0;\t\t\t\t\t\t\\\n\t \t\t\t\\\n\tr7 += -8;\t\t\t\t\t\\\n\t*(u64*)(r7 + 0) = r0;\t\t\t\t\\\n\tr4 = r7;\t\t\t\t\t\\\n\t \t\t\t\t\\\n\tcall %[bpf_strtoul];\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_strtoul)\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}