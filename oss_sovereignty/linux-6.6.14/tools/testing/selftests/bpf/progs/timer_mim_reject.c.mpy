{
  "module_name": "timer_mim_reject.c",
  "hash_id": "dd248d7480ed114b9c08d04f05fe6d2b3cd3a3b36224300a1ffc7310ee891c43",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/timer_mim_reject.c",
  "human_readable_source": "\n \n#include <linux/bpf.h>\n#include <time.h>\n#include <errno.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_tcp_helpers.h\"\n\nchar _license[] SEC(\"license\") = \"GPL\";\nstruct hmap_elem {\n\tint pad;  \n\tstruct bpf_timer timer;\n};\n\nstruct inner_map {\n\t__uint(type, BPF_MAP_TYPE_HASH);\n\t__uint(max_entries, 1024);\n\t__type(key, int);\n\t__type(value, struct hmap_elem);\n} inner_htab SEC(\".maps\");\n\n#define ARRAY_KEY 1\n#define ARRAY_KEY2 2\n#define HASH_KEY 1234\n\nstruct outer_arr {\n\t__uint(type, BPF_MAP_TYPE_ARRAY_OF_MAPS);\n\t__uint(max_entries, 2);\n\t__uint(key_size, sizeof(int));\n\t__uint(value_size, sizeof(int));\n\t__array(values, struct inner_map);\n} outer_arr SEC(\".maps\") = {\n\t.values = { [ARRAY_KEY] = &inner_htab },\n};\n\n__u64 err;\n__u64 ok;\n__u64 cnt;\n\n \nstatic int timer_cb(void *map, int *key, struct hmap_elem *val)\n{\n\treturn 0;\n}\n\nSEC(\"fentry/bpf_fentry_test1\")\nint BPF_PROG(test1, int a)\n{\n\tstruct hmap_elem init = {};\n\tstruct bpf_map *inner_map, *inner_map2;\n\tstruct hmap_elem *val;\n\tint array_key = ARRAY_KEY;\n\tint array_key2 = ARRAY_KEY2;\n\tint hash_key = HASH_KEY;\n\n\tinner_map = bpf_map_lookup_elem(&outer_arr, &array_key);\n\tif (!inner_map)\n\t\treturn 0;\n\n\tinner_map2 = bpf_map_lookup_elem(&outer_arr, &array_key2);\n\tif (!inner_map2)\n\t\treturn 0;\n\tbpf_map_update_elem(inner_map, &hash_key, &init, 0);\n\tval = bpf_map_lookup_elem(inner_map, &hash_key);\n\tif (!val)\n\t\treturn 0;\n\n\tbpf_timer_init(&val->timer, inner_map2, CLOCK_MONOTONIC);\n\tif (bpf_timer_set_callback(&val->timer, timer_cb))\n\t\terr |= 4;\n\tif (bpf_timer_start(&val->timer, 0, 0))\n\t\terr |= 8;\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}