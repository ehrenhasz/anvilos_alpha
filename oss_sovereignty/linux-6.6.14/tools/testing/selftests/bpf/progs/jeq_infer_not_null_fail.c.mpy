{
  "module_name": "jeq_infer_not_null_fail.c",
  "hash_id": "2836ef009aba5629a6ab905332ba8448ec8e602676aacc68d9eec1709ea15a6c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/jeq_infer_not_null_fail.c",
  "human_readable_source": "\n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_HASH);\n\t__uint(max_entries, 1);\n\t__type(key, u64);\n\t__type(value, u64);\n} m_hash SEC(\".maps\");\n\nSEC(\"?raw_tp\")\n__failure __msg(\"R8 invalid mem access 'map_value_or_null\")\nint jeq_infer_not_null_ptr_to_btfid(void *ctx)\n{\n\tstruct bpf_map *map = (struct bpf_map *)&m_hash;\n\tstruct bpf_map *inner_map = map->inner_map_meta;\n\tu64 key = 0, ret = 0, *val;\n\n\tval = bpf_map_lookup_elem(map, &key);\n\t \n\tasm volatile(\"r8 = %[val];\\n\"\n\t\t     \"r9 = %[inner_map];\\n\"\n\t\t     \"if r8 != r9 goto +1;\\n\"\n\t\t     \"%[ret] = *(u64 *)(r8 +0);\\n\"\n\t\t     : [ret] \"+r\"(ret)\n\t\t     : [inner_map] \"r\"(inner_map), [val] \"r\"(val)\n\t\t     : \"r8\", \"r9\");\n\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}