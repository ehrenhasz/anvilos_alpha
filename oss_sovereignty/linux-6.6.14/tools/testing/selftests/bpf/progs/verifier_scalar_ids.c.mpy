{
  "module_name": "verifier_scalar_ids.c",
  "hash_id": "db6aedb0956d518e49c1b9c35b2b0acb7c07211f50fffeacf17637f5bc378e89",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_scalar_ids.c",
  "human_readable_source": "\n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"frame0: regs=r0,r1,r2 stack= before 4: (bf) r3 = r10\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 3: (bf) r2 = r0\")\n__msg(\"frame0: regs=r0,r1 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__msg(\"frame0: regs=r0 stack= before 0: (85) call bpf_ktime_get_ns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_same_state(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"r2 = r0;\"\n\t \n\t\"r3 = r10;\"\n\t\"r3 += r0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"frame0: last_idx 6 first_idx 5 subseq_idx -1\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 5: (bf) r3 = r10\")\n__msg(\"frame0: parent state regs=r0,r1,r2 stack=:\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 4: (05) goto pc+0\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 3: (bf) r2 = r0\")\n__msg(\"frame0: regs=r0,r1 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__msg(\"frame0: parent state regs=r0 stack=:\")\n__msg(\"frame0: regs=r0 stack= before 0: (85) call bpf_ktime_get_ns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_cross_state(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"r2 = r0;\"\n\t \n\t\"goto +0;\"\n\t \n\t\"r3 = r10;\"\n\t\"r3 += r0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"frame0: regs=r0,r2 stack= before 5: (bf) r3 = r10\")\n__msg(\"frame0: regs=r0,r2 stack= before 4: (b7) r1 = 0\")\n__msg(\"frame0: regs=r0,r2 stack= before 3: (bf) r2 = r0\")\n__msg(\"frame0: regs=r0 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__msg(\"frame0: regs=r0 stack= before 0: (85) call bpf_ktime_get_ns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_same_state_broken_link(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"r2 = r0;\"\n\t \n\t\"r1 = 0;\"\n\t \n\t\"r3 = r10;\"\n\t\"r3 += r0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"frame0: regs=r0,r2 stack= before 6: (bf) r3 = r10\")\n__msg(\"frame0: regs=r0,r2 stack= before 5: (b7) r1 = 0\")\n__msg(\"frame0: parent state regs=r0,r2 stack=:\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 4: (05) goto pc+0\")\n__msg(\"frame0: regs=r0,r1,r2 stack= before 3: (bf) r2 = r0\")\n__msg(\"frame0: regs=r0,r1 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__msg(\"frame0: parent state regs=r0 stack=:\")\n__msg(\"frame0: regs=r0 stack= before 0: (85) call bpf_ktime_get_ns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_cross_state_broken_link(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"r2 = r0;\"\n\t \n\t\"goto +0;\"\n\t \n\t\"r1 = 0;\"\n\t \n\t\"r3 = r10;\"\n\t\"r3 += r0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"11: (0f) r2 += r1\")\n \n__msg(\"frame2: last_idx 11 first_idx 10 subseq_idx -1\")\n__msg(\"frame2: regs=r1 stack= before 10: (bf) r2 = r10\")\n__msg(\"frame2: parent state regs=r1 stack=\")\n \n__msg(\"frame1: parent state regs=r6,r7 stack=\")\n__msg(\"frame0: parent state regs=r6 stack=\")\n \n__msg(\"frame2: last_idx 8 first_idx 8 subseq_idx 10\")\n__msg(\"frame2: regs=r1 stack= before 8: (85) call pc+1\")\n \n__msg(\"frame1: parent state regs=r1,r6,r7 stack=\")\n__msg(\"frame0: parent state regs=r6 stack=\")\n \n__msg(\"frame1: last_idx 7 first_idx 6 subseq_idx 8\")\n__msg(\"frame1: regs=r1,r6,r7 stack= before 7: (bf) r7 = r1\")\n__msg(\"frame1: regs=r1,r6 stack= before 6: (bf) r6 = r1\")\n__msg(\"frame1: parent state regs=r1 stack=\")\n__msg(\"frame0: parent state regs=r6 stack=\")\n \n__msg(\"frame1: last_idx 4 first_idx 4 subseq_idx 6\")\n__msg(\"frame1: regs=r1 stack= before 4: (85) call pc+1\")\n__msg(\"frame0: parent state regs=r1,r6 stack=\")\n \n__msg(\"frame0: last_idx 3 first_idx 1 subseq_idx 4\")\n__msg(\"frame0: regs=r0,r1,r6 stack= before 3: (bf) r6 = r0\")\n__msg(\"frame0: regs=r0,r1 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_many_frames(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"r6 = r0;\"\n\t\"call precision_many_frames__foo;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\nstatic __naked __noinline __used\nvoid precision_many_frames__foo(void)\n{\n\tasm volatile (\n\t \n\t\"r6 = r1;\"\n\t\"r7 = r1;\"\n\t\"call precision_many_frames__bar;\"\n\t\"exit\"\n\t::: __clobber_all);\n}\n\nstatic __naked __noinline __used\nvoid precision_many_frames__bar(void)\n{\n\tasm volatile (\n\t \n\t\"r2 = r10;\"\n\t\"r2 += r1;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t::: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n \n__msg(\"frame1: regs=r1 stack=-8,-16 before 9: (bf) r2 = r10\")\n__msg(\"frame1: regs=r1 stack=-8,-16 before 8: (7b) *(u64 *)(r10 -16) = r1\")\n__msg(\"frame1: regs=r1 stack=-8 before 7: (7b) *(u64 *)(r10 -8) = r1\")\n__msg(\"frame1: regs=r1 stack= before 4: (85) call pc+2\")\n \n__msg(\"frame0: regs=r0,r1 stack=-8 before 3: (7b) *(u64 *)(r10 -8) = r1\")\n__msg(\"frame0: regs=r0,r1 stack= before 2: (bf) r1 = r0\")\n__msg(\"frame0: regs=r0 stack= before 1: (57) r0 &= 255\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_stack(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t\"*(u64*)(r10 - 8) = r1;\"\n\t\"call precision_stack__foo;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\nstatic __naked __noinline __used\nvoid precision_stack__foo(void)\n{\n\tasm volatile (\n\t \n\t\"*(u64*)(r10 - 8) = r1;\"\n\t\"*(u64*)(r10 - 16) = r1;\"\n\t \n\t\"r2 = r10;\"\n\t\"r2 += r1;\"\n\t\"exit\"\n\t::: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n \n__msg(\"11: (0f) r3 += r7\")\n__msg(\"frame0: regs=r6,r7 stack= before 10: (bf) r3 = r10\")\n \n__msg(\"frame0: regs=r6,r7 stack= before 3: (bf) r7 = r0\")\n__msg(\"frame0: regs=r0,r6 stack= before 2: (bf) r6 = r0\")\n \n__msg(\"12: (0f) r3 += r9\")\n__msg(\"frame0: regs=r8,r9 stack= before 11: (0f) r3 += r7\")\n \n__msg(\"frame0: regs=r8,r9 stack= before 7: (bf) r9 = r0\")\n__msg(\"frame0: regs=r0,r8 stack= before 6: (bf) r8 = r0\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void precision_two_ids(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t\"r6 = r0;\"\n\t\"r7 = r0;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t\"r8 = r0;\"\n\t\"r9 = r0;\"\n\t \n\t\"r0 = 0;\"\n\t \n\t\"goto +0;\"\n\t\"r3 = r10;\"\n\t \n\t\"r3 += r7;\"\n\t \n\t\"r3 += r9;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__failure __msg(\"register with unbounded min value\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void check_ids_in_regsafe(void)\n{\n\tasm volatile (\n\t \n\t\"r1 = 0;\"\n\t\"*(u64*)(r10 - 8) = r1;\"\n\t \n\t\"r9 = r10;\"\n\t\"r9 += -8;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r7 = r0;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r6 = r0;\"\n\t \n\t\"if r6 > r7 goto l1_%=;\"\n\t\"r7 = r6;\"\n\"l1_%=:\"\n\t \n\t\"if r7 > 4 goto l2_%=;\"\n\t \n\t\"r9 += r6;\"\n\t\"r0 = *(u8*)(r9 + 0);\"\n\"l2_%=:\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__failure __msg(\"register with unbounded min value\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void check_ids_in_regsafe_2(void)\n{\n\tasm volatile (\n\t \n\t\"r1 = 0;\"\n\t\"*(u64*)(r10 - 8) = r1;\"\n\t \n\t\"r9 = r10;\"\n\t\"r9 += -8;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r8 = r0;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r7 = r0;\"\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r6 = r0;\"\n\t \n\t\"r0 = 0;\"\n\t \n\t\"if r6 > r7 goto l1_%=;\"\n\t \n\t\"r6 = r7;\"\n\"l0_%=:\"\n\t \n\t\"if r7 > 4 goto l2_%=;\"\n\t \n\t\"r9 += r6;\"\n\t\"r0 = *(u8*)(r9 + 0);\"\n\"l2_%=:\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\"l1_%=:\"\n\t \n\t\"r6 = r8;\"\n\t\"goto l0_%=;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"11: (1d) if r3 == r4 goto pc+0\")\n__msg(\"frame 0: propagating r3,r4\")\n__msg(\"11: safe\")\n__msg(\"processed 15 insns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void no_scalar_id_for_const(void)\n{\n\tasm volatile (\n\t\"call %[bpf_ktime_get_ns];\"\n\t \n\t\"if r0 > 7 goto l0_%=;\"\n\t \n\t\"r1 = 0;\"\n\t\"r1 = r1;\"\n\t\"r3 = r1;\"\n\t\"r4 = r1;\"\n\t\"goto l1_%=;\"\n\"l0_%=:\"\n\t \n\t\"r1 = 0;\"\n\t\"r2 = 0;\"\n\t\"r3 = r1;\"\n\t\"r4 = r2;\"\n\"l1_%=:\"\n\t \n\t\"if r3 == r4 goto +0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"11: (1e) if w3 == w4 goto pc+0\")\n__msg(\"frame 0: propagating r3,r4\")\n__msg(\"11: safe\")\n__msg(\"processed 15 insns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void no_scalar_id_for_const32(void)\n{\n\tasm volatile (\n\t\"call %[bpf_ktime_get_ns];\"\n\t \n\t\"if r0 > 7 goto l0_%=;\"\n\t \n\t\"w1 = 0;\"\n\t\"w1 = w1;\"\n\t\"w3 = w1;\"\n\t\"w4 = w1;\"\n\t\"goto l1_%=;\"\n\"l0_%=:\"\n\t \n\t\"w1 = 0;\"\n\t\"w2 = 0;\"\n\t\"w3 = w1;\"\n\t\"w4 = w2;\"\n\"l1_%=:\"\n\t \n\t\"if w3 == w4 goto +0;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"6: (25) if r6 > 0x7 goto pc+1\")\n__msg(\"7: (57) r1 &= 255\")\n__msg(\"8: (bf) r2 = r10\")\n__msg(\"from 6 to 8: safe\")\n__msg(\"processed 12 insns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void ignore_unique_scalar_ids_cur(void)\n{\n\tasm volatile (\n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r6 = r0;\"\n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t \n\t\"r0 = 0;\"\n\t\"if r6 > 7 goto l0_%=;\"\n\t \n\t\"r1 &= 0xff;\"\n\"l0_%=:\"\n\t \n\t\"r2 = r10;\"\n\t\"r2 += r1;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n__msg(\"6: (25) if r6 > 0x7 goto pc+1\")\n__msg(\"7: (05) goto pc+1\")\n__msg(\"9: (bf) r2 = r10\")\n__msg(\"9: safe\")\n__msg(\"processed 13 insns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void ignore_unique_scalar_ids_old(void)\n{\n\tasm volatile (\n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r6 = r0;\"\n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t \n\t\"r1 = r0;\"\n\t \n\t\"r0 = 0;\"\n\t\"if r6 > 7 goto l1_%=;\"\n\t\"goto l0_%=;\"\n\"l1_%=:\"\n\t \n\t\"r1 &= 0xff;\"\n\"l0_%=:\"\n\t \n\t\"r2 = r10;\"\n\t\"r2 += r1;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\n \nSEC(\"socket\")\n__success __log_level(2)\n \n__msg(\"13: (95) exit\")\n__msg(\"13: (95) exit\")\n__msg(\"processed 18 insns\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void two_old_ids_one_cur_id(void)\n{\n\tasm volatile (\n\t \n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t\"r6 = r0;\"\n\t\"call %[bpf_ktime_get_ns];\"\n\t\"r0 &= 0xff;\"\n\t\"r7 = r0;\"\n\t\"r0 = 0;\"\n\t \n\t\"if r6 > r7 goto l0_%=;\"\n\t\"goto l1_%=;\"\n\"l0_%=:\"\n\t\"r6 = r7;\"\n\"l1_%=:\"\n\t \n\t\"r2 = r10;\"\n\t\"r2 += r6;\"\n\t\"r2 += r7;\"\n\t\"exit;\"\n\t:\n\t: __imm(bpf_ktime_get_ns)\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}