{
  "module_name": "test_subprogs.c",
  "hash_id": "36928ecf5a3e74fb0ad73c474706d9c1299ca0e45f179c36586eb2d48821336c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_subprogs.c",
  "human_readable_source": "#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nconst char LICENSE[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, __u32);\n\t__type(value, __u64);\n} array SEC(\".maps\");\n\n__noinline int sub1(int x)\n{\n\tint key = 0;\n\n\tbpf_map_lookup_elem(&array, &key);\n\treturn x + 1;\n}\n\nstatic __noinline int sub5(int v);\n\n__noinline int sub2(int y)\n{\n\treturn sub5(y + 2);\n}\n\nstatic __noinline int sub3(int z)\n{\n\treturn z + 3 + sub1(4);\n}\n\nstatic __noinline int sub4(int w)\n{\n\tint key = 0;\n\n\tbpf_map_lookup_elem(&array, &key);\n\treturn w + sub3(5) + sub1(6);\n}\n\n \nstatic __noinline int sub5(int v)\n{\n\treturn sub1(v) - 1;  \n}\n\n \n__noinline int get_task_tgid(uintptr_t t)\n{\n\t \n\treturn BPF_CORE_READ((struct task_struct *)(void *)t, tgid);\n}\n\nint res1 = 0;\nint res2 = 0;\nint res3 = 0;\nint res4 = 0;\n\nSEC(\"raw_tp/sys_enter\")\nint prog1(void *ctx)\n{\n\t \n\tstruct task_struct *t = (void *)bpf_get_current_task();\n\n\tif (!BPF_CORE_READ(t, pid) || !get_task_tgid((uintptr_t)t))\n\t\treturn 1;\n\n\tres1 = sub1(1) + sub3(2);  \n\treturn 0;\n}\n\nSEC(\"raw_tp/sys_exit\")\nint prog2(void *ctx)\n{\n\tstruct task_struct *t = (void *)bpf_get_current_task();\n\n\tif (!BPF_CORE_READ(t, pid) || !get_task_tgid((uintptr_t)t))\n\t\treturn 1;\n\n\tres2 = sub2(3) + sub3(4);  \n\treturn 0;\n}\n\nstatic int empty_callback(__u32 index, void *data)\n{\n\treturn 0;\n}\n\n \nSEC(\"raw_tp/sys_enter\")\nint prog3(void *ctx)\n{\n\tstruct task_struct *t = (void *)bpf_get_current_task();\n\n\tif (!BPF_CORE_READ(t, pid) || !get_task_tgid((uintptr_t)t))\n\t\treturn 1;\n\n\t \n\tbpf_loop(1, empty_callback, NULL, 0);\n\n\tres3 = sub3(5) + 6;  \n\treturn 0;\n}\n\n \nSEC(\"raw_tp/sys_exit\")\nint prog4(void *ctx)\n{\n\tstruct task_struct *t = (void *)bpf_get_current_task();\n\n\tif (!BPF_CORE_READ(t, pid) || !get_task_tgid((uintptr_t)t))\n\t\treturn 1;\n\n\tres4 = sub4(7) + sub1(8);  \n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}