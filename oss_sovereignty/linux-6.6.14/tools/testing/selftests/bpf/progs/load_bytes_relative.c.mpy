{
  "module_name": "load_bytes_relative.c",
  "hash_id": "c9db8920f9aac6d7f14d782afb87099623dc7c9898b87237db08692a2241cbf8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/load_bytes_relative.c",
  "human_readable_source": "\n\n \n\n#include <errno.h>\n#include <linux/bpf.h>\n#include <linux/if_ether.h>\n#include <linux/ip.h>\n#include <bpf/bpf_helpers.h>\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, __u32);\n\t__type(value, __u32);\n} test_result SEC(\".maps\");\n\nSEC(\"cgroup_skb/egress\")\nint load_bytes_relative(struct __sk_buff *skb)\n{\n\tstruct ethhdr eth;\n\tstruct iphdr iph;\n\n\t__u32 map_key = 0;\n\t__u32 test_passed = 0;\n\n\t \n\tif (bpf_skb_load_bytes_relative(skb, 0, &eth, sizeof(eth),\n\t\t\t\t\tBPF_HDR_START_MAC) != -EFAULT)\n\t\tgoto fail;\n\n\tif (bpf_skb_load_bytes_relative(skb, 0, &iph, sizeof(iph),\n\t\t\t\t\tBPF_HDR_START_NET))\n\t\tgoto fail;\n\n\tif (bpf_skb_load_bytes_relative(skb, 0xffff, &iph, sizeof(iph),\n\t\t\t\t\tBPF_HDR_START_NET) != -EFAULT)\n\t\tgoto fail;\n\n\ttest_passed = 1;\n\nfail:\n\tbpf_map_update_elem(&test_result, &map_key, &test_passed, BPF_ANY);\n\n\treturn 1;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}