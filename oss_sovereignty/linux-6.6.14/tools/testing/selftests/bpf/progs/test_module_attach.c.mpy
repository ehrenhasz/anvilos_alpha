{
  "module_name": "test_module_attach.c",
  "hash_id": "c40268d1004972a926c8430a32dc5a9acd04481397ee71382428b6ecfdb951ea",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_module_attach.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <bpf/bpf_core_read.h>\n#include \"../bpf_testmod/bpf_testmod.h\"\n\n__u32 raw_tp_read_sz = 0;\n\nSEC(\"raw_tp/bpf_testmod_test_read\")\nint BPF_PROG(handle_raw_tp,\n\t     struct task_struct *task, struct bpf_testmod_test_read_ctx *read_ctx)\n{\n\traw_tp_read_sz = BPF_CORE_READ(read_ctx, len);\n\treturn 0;\n}\n\n__u32 raw_tp_bare_write_sz = 0;\n\nSEC(\"raw_tp/bpf_testmod_test_write_bare\")\nint BPF_PROG(handle_raw_tp_bare,\n\t     struct task_struct *task, struct bpf_testmod_test_write_ctx *write_ctx)\n{\n\traw_tp_bare_write_sz = BPF_CORE_READ(write_ctx, len);\n\treturn 0;\n}\n\nint raw_tp_writable_bare_in_val = 0;\nint raw_tp_writable_bare_early_ret = 0;\nint raw_tp_writable_bare_out_val = 0;\n\nSEC(\"raw_tp.w/bpf_testmod_test_writable_bare\")\nint BPF_PROG(handle_raw_tp_writable_bare,\n\t     struct bpf_testmod_test_writable_ctx *writable)\n{\n\traw_tp_writable_bare_in_val = writable->val;\n\twritable->early_ret = raw_tp_writable_bare_early_ret;\n\twritable->val = raw_tp_writable_bare_out_val;\n\treturn 0;\n}\n\n__u32 tp_btf_read_sz = 0;\n\nSEC(\"tp_btf/bpf_testmod_test_read\")\nint BPF_PROG(handle_tp_btf,\n\t     struct task_struct *task, struct bpf_testmod_test_read_ctx *read_ctx)\n{\n\ttp_btf_read_sz = read_ctx->len;\n\treturn 0;\n}\n\n__u32 fentry_read_sz = 0;\n\nSEC(\"fentry/bpf_testmod_test_read\")\nint BPF_PROG(handle_fentry,\n\t     struct file *file, struct kobject *kobj,\n\t     struct bin_attribute *bin_attr, char *buf, loff_t off, size_t len)\n{\n\tfentry_read_sz = len;\n\treturn 0;\n}\n\n__u32 fentry_manual_read_sz = 0;\n\nSEC(\"fentry\")\nint BPF_PROG(handle_fentry_manual,\n\t     struct file *file, struct kobject *kobj,\n\t     struct bin_attribute *bin_attr, char *buf, loff_t off, size_t len)\n{\n\tfentry_manual_read_sz = len;\n\treturn 0;\n}\n\n__u32 fexit_read_sz = 0;\nint fexit_ret = 0;\n\nSEC(\"fexit/bpf_testmod_test_read\")\nint BPF_PROG(handle_fexit,\n\t     struct file *file, struct kobject *kobj,\n\t     struct bin_attribute *bin_attr, char *buf, loff_t off, size_t len,\n\t     int ret)\n{\n\tfexit_read_sz = len;\n\tfexit_ret = ret;\n\treturn 0;\n}\n\nSEC(\"fexit/bpf_testmod_return_ptr\")\nint BPF_PROG(handle_fexit_ret, int arg, struct file *ret)\n{\n\tlong buf = 0;\n\n\tbpf_probe_read_kernel(&buf, 8, ret);\n\tbpf_probe_read_kernel(&buf, 8, (char *)ret + 256);\n\t*(volatile long long *)ret;\n\t*(volatile int *)&ret->f_mode;\n\treturn 0;\n}\n\n__u32 fmod_ret_read_sz = 0;\n\nSEC(\"fmod_ret/bpf_testmod_test_read\")\nint BPF_PROG(handle_fmod_ret,\n\t     struct file *file, struct kobject *kobj,\n\t     struct bin_attribute *bin_attr, char *buf, loff_t off, size_t len)\n{\n\tfmod_ret_read_sz = len;\n\treturn 0;  \n}\n\nSEC(\"kprobe.multi/bpf_testmod_test_read\")\nint BPF_PROG(kprobe_multi)\n{\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}