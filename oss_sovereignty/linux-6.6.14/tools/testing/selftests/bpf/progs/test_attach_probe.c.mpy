{
  "module_name": "test_attach_probe.c",
  "hash_id": "61bf9e04844c31d4e55ce49fc0dc6c336de3dba22cf0fab84022e2c083cdf1b8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_attach_probe.c",
  "human_readable_source": "\n\n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <bpf/bpf_core_read.h>\n#include \"bpf_misc.h\"\n\nint kprobe2_res = 0;\nint kretprobe2_res = 0;\nint uprobe_byname_res = 0;\nint uretprobe_byname_res = 0;\nint uprobe_byname2_res = 0;\nint uretprobe_byname2_res = 0;\nint uprobe_byname3_sleepable_res = 0;\nint uprobe_byname3_res = 0;\nint uretprobe_byname3_sleepable_res = 0;\nint uretprobe_byname3_res = 0;\nvoid *user_ptr = 0;\n\nSEC(\"ksyscall/nanosleep\")\nint BPF_KSYSCALL(handle_kprobe_auto, struct __kernel_timespec *req, struct __kernel_timespec *rem)\n{\n\tkprobe2_res = 11;\n\treturn 0;\n}\n\nSEC(\"kretsyscall/nanosleep\")\nint BPF_KRETPROBE(handle_kretprobe_auto, int ret)\n{\n\tkretprobe2_res = 22;\n\treturn ret;\n}\n\nSEC(\"uprobe\")\nint handle_uprobe_ref_ctr(struct pt_regs *ctx)\n{\n\treturn 0;\n}\n\nSEC(\"uretprobe\")\nint handle_uretprobe_ref_ctr(struct pt_regs *ctx)\n{\n\treturn 0;\n}\n\nSEC(\"uprobe\")\nint handle_uprobe_byname(struct pt_regs *ctx)\n{\n\tuprobe_byname_res = 5;\n\treturn 0;\n}\n\n \nSEC(\"uretprobe//proc/self/exe:trigger_func2\")\nint handle_uretprobe_byname(struct pt_regs *ctx)\n{\n\turetprobe_byname_res = 6;\n\treturn 0;\n}\n\nSEC(\"uprobe\")\nint BPF_UPROBE(handle_uprobe_byname2, const char *pathname, const char *mode)\n{\n\tchar mode_buf[2] = {};\n\n\t \n\tbpf_probe_read_user(mode_buf, sizeof(mode_buf), mode);\n\tif (mode_buf[0] == 'r' && mode_buf[1] == 0)\n\t\tuprobe_byname2_res = 7;\n\treturn 0;\n}\n\nSEC(\"uretprobe\")\nint BPF_URETPROBE(handle_uretprobe_byname2, void *ret)\n{\n\turetprobe_byname2_res = 8;\n\treturn 0;\n}\n\nstatic __always_inline bool verify_sleepable_user_copy(void)\n{\n\tchar data[9];\n\n\tbpf_copy_from_user(data, sizeof(data), user_ptr);\n\treturn bpf_strncmp(data, sizeof(data), \"test_data\") == 0;\n}\n\nSEC(\"uprobe.s//proc/self/exe:trigger_func3\")\nint handle_uprobe_byname3_sleepable(struct pt_regs *ctx)\n{\n\tif (verify_sleepable_user_copy())\n\t\tuprobe_byname3_sleepable_res = 9;\n\treturn 0;\n}\n\n \nSEC(\"uprobe//proc/self/exe:trigger_func3\")\nint handle_uprobe_byname3(struct pt_regs *ctx)\n{\n\tuprobe_byname3_res = 10;\n\treturn 0;\n}\n\nSEC(\"uretprobe.s//proc/self/exe:trigger_func3\")\nint handle_uretprobe_byname3_sleepable(struct pt_regs *ctx)\n{\n\tif (verify_sleepable_user_copy())\n\t\turetprobe_byname3_sleepable_res = 11;\n\treturn 0;\n}\n\nSEC(\"uretprobe//proc/self/exe:trigger_func3\")\nint handle_uretprobe_byname3(struct pt_regs *ctx)\n{\n\turetprobe_byname3_res = 12;\n\treturn 0;\n}\n\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}