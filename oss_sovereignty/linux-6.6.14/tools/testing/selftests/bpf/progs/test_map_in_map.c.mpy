{
  "module_name": "test_map_in_map.c",
  "hash_id": "f080f571814c5093424ec5b0c1a8228339624be50925cd36d779829dcdb77aa8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_map_in_map.c",
  "human_readable_source": "\n \n#include <stddef.h>\n#include <linux/bpf.h>\n#include <linux/types.h>\n#include <bpf/bpf_helpers.h>\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY_OF_MAPS);\n\t__uint(max_entries, 1);\n\t__uint(map_flags, 0);\n\t__type(key, __u32);\n\t__type(value, __u32);\n} mim_array SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_HASH_OF_MAPS);\n\t__uint(max_entries, 1);\n\t__uint(map_flags, 0);\n\t__type(key, int);\n\t__type(value, __u32);\n} mim_hash SEC(\".maps\");\n\nSEC(\"xdp\")\nint xdp_mimtest0(struct xdp_md *ctx)\n{\n\tint value = 123;\n\tint *value_p;\n\tint key = 0;\n\tvoid *map;\n\n\tmap = bpf_map_lookup_elem(&mim_array, &key);\n\tif (!map)\n\t\treturn XDP_DROP;\n\n\tbpf_map_update_elem(map, &key, &value, 0);\n\tvalue_p = bpf_map_lookup_elem(map, &key);\n\tif (!value_p || *value_p != 123)\n\t\treturn XDP_DROP;\n\n\tmap = bpf_map_lookup_elem(&mim_hash, &key);\n\tif (!map)\n\t\treturn XDP_DROP;\n\n\tbpf_map_update_elem(map, &key, &value, 0);\n\n\treturn XDP_PASS;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}