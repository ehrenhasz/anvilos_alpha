{
  "module_name": "test_core_reloc_size.c",
  "hash_id": "57c3483d6ff473f3bdf6551125511bbc27a3471ee10fbf55ad1493058b57be87",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_core_reloc_size.c",
  "human_readable_source": "\n\n\n#include <linux/bpf.h>\n#include <stdint.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\tchar in[256];\n\tchar out[256];\n} data = {};\n\nstruct core_reloc_size_output {\n\tint int_sz;\n\tint int_off;\n\tint struct_sz;\n\tint struct_off;\n\tint union_sz;\n\tint union_off;\n\tint arr_sz;\n\tint arr_off;\n\tint arr_elem_sz;\n\tint arr_elem_off;\n\tint ptr_sz;\n\tint ptr_off;\n\tint enum_sz;\n\tint enum_off;\n\tint float_sz;\n\tint float_off;\n};\n\nstruct core_reloc_size {\n\tint int_field;\n\tstruct { int x; } struct_field;\n\tunion { int x; } union_field;\n\tint arr_field[4];\n\tvoid *ptr_field;\n\tenum { VALUE = 123 } enum_field;\n\tfloat float_field;\n};\n\nSEC(\"raw_tracepoint/sys_enter\")\nint test_core_size(void *ctx)\n{\n\tstruct core_reloc_size *in = (void *)&data.in;\n\tstruct core_reloc_size_output *out = (void *)&data.out;\n\n\tout->int_sz = bpf_core_field_size(in->int_field);\n\tout->int_off = bpf_core_field_offset(in->int_field);\n\n\tout->struct_sz = bpf_core_field_size(in->struct_field);\n\tout->struct_off = bpf_core_field_offset(in->struct_field);\n\n\tout->union_sz = bpf_core_field_size(in->union_field);\n\tout->union_off = bpf_core_field_offset(in->union_field);\n\n\tout->arr_sz = bpf_core_field_size(in->arr_field);\n\tout->arr_off = bpf_core_field_offset(in->arr_field);\n\n\tout->arr_elem_sz = bpf_core_field_size(struct core_reloc_size, arr_field[1]);\n\tout->arr_elem_off = bpf_core_field_offset(struct core_reloc_size, arr_field[1]);\n\n\tout->ptr_sz = bpf_core_field_size(struct core_reloc_size, ptr_field);\n\tout->ptr_off = bpf_core_field_offset(struct core_reloc_size, ptr_field);\n\n\tout->enum_sz = bpf_core_field_size(struct core_reloc_size, enum_field);\n\tout->enum_off = bpf_core_field_offset(struct core_reloc_size, enum_field);\n\n\tout->float_sz = bpf_core_field_size(struct core_reloc_size, float_field);\n\tout->float_off = bpf_core_field_offset(struct core_reloc_size, float_field);\n\n\treturn 0;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}