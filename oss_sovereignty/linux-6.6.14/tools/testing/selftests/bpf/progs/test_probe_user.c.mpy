{
  "module_name": "test_probe_user.c",
  "hash_id": "3f0ae2c0958ddf2815d60b81f9432e3e7167d5286ff4353320fe78ea733f73bd",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_probe_user.c",
  "human_readable_source": "\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <bpf/bpf_core_read.h>\n#include \"bpf_misc.h\"\n\nstatic struct sockaddr_in old;\n\nstatic int handle_sys_connect_common(struct sockaddr_in *uservaddr)\n{\n\tstruct sockaddr_in new;\n\n\tbpf_probe_read_user(&old, sizeof(old), uservaddr);\n\t__builtin_memset(&new, 0xab, sizeof(new));\n\tbpf_probe_write_user(uservaddr, &new, sizeof(new));\n\n\treturn 0;\n}\n\nSEC(\"ksyscall/connect\")\nint BPF_KSYSCALL(handle_sys_connect, int fd, struct sockaddr_in *uservaddr,\n\t\t int addrlen)\n{\n\treturn handle_sys_connect_common(uservaddr);\n}\n\n#if defined(bpf_target_s390)\n#ifndef SYS_CONNECT\n#define SYS_CONNECT 3\n#endif\n\nSEC(\"ksyscall/socketcall\")\nint BPF_KSYSCALL(handle_sys_socketcall, int call, unsigned long *args)\n{\n\tif (call == SYS_CONNECT) {\n\t\tstruct sockaddr_in *uservaddr;\n\n\t\tbpf_probe_read_user(&uservaddr, sizeof(uservaddr), &args[1]);\n\t\treturn handle_sys_connect_common(uservaddr);\n\t}\n\n\treturn 0;\n}\n#endif\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}