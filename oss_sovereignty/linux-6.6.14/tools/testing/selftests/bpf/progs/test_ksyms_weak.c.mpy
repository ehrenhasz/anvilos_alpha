{
  "module_name": "test_ksyms_weak.c",
  "hash_id": "1cb1b23197ff60a11ed2a70466d04a2db790d8c27f408db6975b143261193e55",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_ksyms_weak.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n\n#include <bpf/bpf_helpers.h>\n\nint out__existing_typed = -1;\n__u64 out__existing_typeless = -1;\n\n__u64 out__non_existent_typeless = -1;\n__u64 out__non_existent_typed = -1;\n\n \n\n \nextern const struct rq runqueues __ksym __weak;  \nextern const void bpf_prog_active __ksym __weak;  \nstruct task_struct *bpf_task_acquire(struct task_struct *p) __ksym __weak;\nvoid bpf_testmod_test_mod_kfunc(int i) __ksym __weak;\n\n\n \n\n \nextern const void bpf_link_fops1 __ksym __weak;\n\n \nextern const int bpf_link_fops2 __ksym __weak;\nvoid invalid_kfunc(void) __ksym __weak;\n\nSEC(\"raw_tp/sys_enter\")\nint pass_handler(const void *ctx)\n{\n\tstruct rq *rq;\n\n\t \n\trq = (struct rq *)bpf_per_cpu_ptr(&runqueues, 0);\n\tif (rq && bpf_ksym_exists(&runqueues))\n\t\tout__existing_typed = rq->cpu;\n\tout__existing_typeless = (__u64)&bpf_prog_active;\n\n\t \n\tout__non_existent_typeless = (__u64)&bpf_link_fops1;\n\n\t \n\tout__non_existent_typed = (__u64)&bpf_link_fops2;\n\n\tif (&bpf_link_fops2)  \n\t\tout__non_existent_typed = (__u64)bpf_per_cpu_ptr(&bpf_link_fops2, 0);\n\n\tif (!bpf_ksym_exists(bpf_task_acquire))\n\t\t \n\t\tbpf_task_acquire(0);\n\n\tif (!bpf_ksym_exists(bpf_testmod_test_mod_kfunc))\n\t\t \n\t\tbpf_testmod_test_mod_kfunc(0);\n\n\tif (bpf_ksym_exists(invalid_kfunc))\n\t\t \n\t\tinvalid_kfunc();\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}