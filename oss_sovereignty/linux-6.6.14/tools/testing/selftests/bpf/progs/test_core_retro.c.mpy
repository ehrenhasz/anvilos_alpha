{
  "module_name": "test_core_retro.c",
  "hash_id": "eb664588d69523226cbb6c10354ed24c755ba8b8940ccf6934cf836d4fde9801",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_core_retro.c",
  "human_readable_source": "\n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nstruct task_struct {\n\tint tgid;\n} __attribute__((preserve_access_index));\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, int);\n\t__type(value, int);\n} exp_tgid_map SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, int);\n\t__type(value, int);\n} results SEC(\".maps\");\n\nSEC(\"tp/raw_syscalls/sys_enter\")\nint handle_sys_enter(void *ctx)\n{\n\tstruct task_struct *task = (void *)bpf_get_current_task();\n\tint tgid = BPF_CORE_READ(task, tgid);\n\tint zero = 0;\n\tint real_tgid = bpf_get_current_pid_tgid() >> 32;\n\tint *exp_tgid = bpf_map_lookup_elem(&exp_tgid_map, &zero);\n\n\t \n\tif (!exp_tgid || *exp_tgid != real_tgid)\n\t\treturn 0;\n\n\tbpf_map_update_elem(&results, &zero, &tgid, 0);\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}