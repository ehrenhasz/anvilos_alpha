{
  "module_name": "test_usdt.c",
  "hash_id": "1a26fdad161d77640fdc868d9fe458a36d04d1d0226c615b258e76d2883b6876",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_usdt.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/usdt.bpf.h>\n\nint my_pid;\n\nint usdt0_called;\nu64 usdt0_cookie;\nint usdt0_arg_cnt;\nint usdt0_arg_ret;\n\nSEC(\"usdt\")\nint usdt0(struct pt_regs *ctx)\n{\n\tlong tmp;\n\n\tif (my_pid != (bpf_get_current_pid_tgid() >> 32))\n\t\treturn 0;\n\n\t__sync_fetch_and_add(&usdt0_called, 1);\n\n\tusdt0_cookie = bpf_usdt_cookie(ctx);\n\tusdt0_arg_cnt = bpf_usdt_arg_cnt(ctx);\n\t \n\tusdt0_arg_ret = bpf_usdt_arg(ctx, bpf_get_prandom_u32(), &tmp);\n\treturn 0;\n}\n\nint usdt3_called;\nu64 usdt3_cookie;\nint usdt3_arg_cnt;\nint usdt3_arg_rets[3];\nu64 usdt3_args[3];\n\nSEC(\"usdt//proc/self/exe:test:usdt3\")\nint usdt3(struct pt_regs *ctx)\n{\n\tlong tmp;\n\n\tif (my_pid != (bpf_get_current_pid_tgid() >> 32))\n\t\treturn 0;\n\n\t__sync_fetch_and_add(&usdt3_called, 1);\n\n\tusdt3_cookie = bpf_usdt_cookie(ctx);\n\tusdt3_arg_cnt = bpf_usdt_arg_cnt(ctx);\n\n\tusdt3_arg_rets[0] = bpf_usdt_arg(ctx, 0, &tmp);\n\tusdt3_args[0] = (int)tmp;\n\n\tusdt3_arg_rets[1] = bpf_usdt_arg(ctx, 1, &tmp);\n\tusdt3_args[1] = (long)tmp;\n\n\tusdt3_arg_rets[2] = bpf_usdt_arg(ctx, 2, &tmp);\n\tusdt3_args[2] = (uintptr_t)tmp;\n\n\treturn 0;\n}\n\nint usdt12_called;\nu64 usdt12_cookie;\nint usdt12_arg_cnt;\nu64 usdt12_args[12];\n\nSEC(\"usdt//proc/self/exe:test:usdt12\")\nint BPF_USDT(usdt12, int a1, int a2, long a3, long a4, unsigned a5,\n\t\t     long a6, __u64 a7, uintptr_t a8, int a9, short a10,\n\t\t     short a11, signed char a12)\n{\n\tif (my_pid != (bpf_get_current_pid_tgid() >> 32))\n\t\treturn 0;\n\n\t__sync_fetch_and_add(&usdt12_called, 1);\n\n\tusdt12_cookie = bpf_usdt_cookie(ctx);\n\tusdt12_arg_cnt = bpf_usdt_arg_cnt(ctx);\n\n\tusdt12_args[0] = a1;\n\tusdt12_args[1] = a2;\n\tusdt12_args[2] = a3;\n\tusdt12_args[3] = a4;\n\tusdt12_args[4] = a5;\n\tusdt12_args[5] = a6;\n\tusdt12_args[6] = a7;\n\tusdt12_args[7] = a8;\n\tusdt12_args[8] = a9;\n\tusdt12_args[9] = a10;\n\tusdt12_args[10] = a11;\n\tusdt12_args[11] = a12;\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}