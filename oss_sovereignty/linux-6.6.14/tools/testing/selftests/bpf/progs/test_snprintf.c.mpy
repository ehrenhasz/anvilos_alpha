{
  "module_name": "test_snprintf.c",
  "hash_id": "6539348cb169bdaa7aff3d4f1890630b280aa6f072205762ad7e9aed7b2b128c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_snprintf.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n\n__u32 pid = 0;\n\nchar num_out[64] = {};\nlong num_ret = 0;\n\nchar ip_out[64] = {};\nlong ip_ret = 0;\n\nchar sym_out[64] = {};\nlong sym_ret = 0;\n\nchar addr_out[64] = {};\nlong addr_ret = 0;\n\nchar str_out[64] = {};\nlong str_ret = 0;\n\nchar over_out[6] = {};\nlong over_ret = 0;\n\nchar pad_out[10] = {};\nlong pad_ret = 0;\n\nchar noarg_out[64] = {};\nlong noarg_ret = 0;\n\nlong nobuf_ret = 0;\n\nextern const void schedule __ksym;\n\nSEC(\"raw_tp/sys_enter\")\nint handler(const void *ctx)\n{\n\t \n\tconst __u8 ex_ipv4[] = {127, 0, 0, 1};\n\tconst __u8 ex_ipv6[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1};\n\tstatic const char str1[] = \"str1\";\n\tstatic const char longstr[] = \"longstr\";\n\n\tif ((int)bpf_get_current_pid_tgid() != pid)\n\t\treturn 0;\n\n\t \n\tnum_ret  = BPF_SNPRINTF(num_out, sizeof(num_out),\n\t\t\t\t\"%d %u %x %li %llu %lX\",\n\t\t\t\t-8, 9, 150, -424242, 1337, 0xDABBAD00);\n\t \n\tip_ret   = BPF_SNPRINTF(ip_out, sizeof(ip_out), \"%pi4 %pI6\",\n\t\t\t\t&ex_ipv4, &ex_ipv6);\n\t \n\tsym_ret  = BPF_SNPRINTF(sym_out,  sizeof(sym_out), \"%ps %pS %pB\",\n\t\t\t\t&schedule, &schedule, &schedule);\n\t \n\taddr_ret = BPF_SNPRINTF(addr_out, sizeof(addr_out), \"%pK %px %p\",\n\t\t\t\t0, 0xFFFF00000ADD4E55, 0xFFFF00000ADD4E55);\n\t \n\tstr_ret  = BPF_SNPRINTF(str_out, sizeof(str_out), \"%s % 9c %+2c %-3c %04c %0c %+05s\",\n\t\t\t\tstr1, 'a', 'b', 'c', 'd', 'e', longstr);\n\t \n\tover_ret = BPF_SNPRINTF(over_out, sizeof(over_out), \"%%overflow\");\n\t \n\tpad_ret = BPF_SNPRINTF(pad_out, sizeof(pad_out), \"%5d %0900000X\", 4, 4);\n\t \n\tnoarg_ret = BPF_SNPRINTF(noarg_out, sizeof(noarg_out), \"simple case\");\n\t \n\tnobuf_ret = BPF_SNPRINTF(NULL, 0, \"only interested in length %d\", 60);\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}