{
  "module_name": "test_bpf_cookie.c",
  "hash_id": "4076b48f3b754f036a33acf6c1c7800287102e15f72933d953f3149d15ab0ddd",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_bpf_cookie.c",
  "human_readable_source": "\n \n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <errno.h>\n\nint my_tid;\n\n__u64 kprobe_res;\n__u64 kprobe_multi_res;\n__u64 kretprobe_res;\n__u64 uprobe_res;\n__u64 uretprobe_res;\n__u64 tp_res;\n__u64 pe_res;\n__u64 fentry_res;\n__u64 fexit_res;\n__u64 fmod_ret_res;\n__u64 lsm_res;\n\nstatic void update(void *ctx, __u64 *res)\n{\n\tif (my_tid != (u32)bpf_get_current_pid_tgid())\n\t\treturn;\n\n\t*res |= bpf_get_attach_cookie(ctx);\n}\n\nSEC(\"kprobe\")\nint handle_kprobe(struct pt_regs *ctx)\n{\n\tupdate(ctx, &kprobe_res);\n\treturn 0;\n}\n\nSEC(\"kretprobe\")\nint handle_kretprobe(struct pt_regs *ctx)\n{\n\tupdate(ctx, &kretprobe_res);\n\treturn 0;\n}\n\nSEC(\"uprobe\")\nint handle_uprobe(struct pt_regs *ctx)\n{\n\tupdate(ctx, &uprobe_res);\n\treturn 0;\n}\n\nSEC(\"uretprobe\")\nint handle_uretprobe(struct pt_regs *ctx)\n{\n\tupdate(ctx, &uretprobe_res);\n\treturn 0;\n}\n\n \nSEC(\"tp/syscalls/sys_enter_nanosleep\")\nint handle_tp1(struct pt_regs *ctx)\n{\n\tupdate(ctx, &tp_res);\n\treturn 0;\n}\nSEC(\"tp/syscalls/sys_enter_nanosleep\")\nint handle_tp2(struct pt_regs *ctx)\n{\n\tupdate(ctx, &tp_res);\n\treturn 0;\n}\nSEC(\"tp/syscalls/sys_enter_nanosleep\")\nint handle_tp3(void *ctx)\n{\n\tupdate(ctx, &tp_res);\n\treturn 1;\n}\n\nSEC(\"perf_event\")\nint handle_pe(struct pt_regs *ctx)\n{\n\tupdate(ctx, &pe_res);\n\treturn 0;\n}\n\nSEC(\"fentry/bpf_fentry_test1\")\nint BPF_PROG(fentry_test1, int a)\n{\n\tupdate(ctx, &fentry_res);\n\treturn 0;\n}\n\nSEC(\"fexit/bpf_fentry_test1\")\nint BPF_PROG(fexit_test1, int a, int ret)\n{\n\tupdate(ctx, &fexit_res);\n\treturn 0;\n}\n\nSEC(\"fmod_ret/bpf_modify_return_test\")\nint BPF_PROG(fmod_ret_test, int _a, int *_b, int _ret)\n{\n\tupdate(ctx, &fmod_ret_res);\n\treturn 1234;\n}\n\nSEC(\"lsm/file_mprotect\")\nint BPF_PROG(test_int_hook, struct vm_area_struct *vma,\n\t     unsigned long reqprot, unsigned long prot, int ret)\n{\n\tif (my_tid != (u32)bpf_get_current_pid_tgid())\n\t\treturn ret;\n\tupdate(ctx, &lsm_res);\n\treturn -EPERM;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}