{
  "module_name": "get_func_args_test.c",
  "hash_id": "fca7b905d9e08caba572471720c2704e5ec0733c1384f1910aa73a5d87228bac",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/get_func_args_test.c",
  "human_readable_source": "\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <errno.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\n__u64 test1_result = 0;\nSEC(\"fentry/bpf_fentry_test1\")\nint BPF_PROG(test1)\n{\n\t__u64 cnt = bpf_get_func_arg_cnt(ctx);\n\t__u64 a = 0, z = 0, ret = 0;\n\t__s64 err;\n\n\ttest1_result = cnt == 1;\n\n\t \n\terr = bpf_get_func_arg(ctx, 0, &a);\n\n\t \n\ttest1_result &= err == 0 && ((int) a == 1);\n\n\t \n\terr = bpf_get_func_arg(ctx, 1, &z);\n\ttest1_result &= err == -EINVAL;\n\n\t \n\terr = bpf_get_func_ret(ctx, &ret);\n\ttest1_result &= err == -EOPNOTSUPP;\n\treturn 0;\n}\n\n__u64 test2_result = 0;\nSEC(\"fexit/bpf_fentry_test2\")\nint BPF_PROG(test2)\n{\n\t__u64 cnt = bpf_get_func_arg_cnt(ctx);\n\t__u64 a = 0, b = 0, z = 0, ret = 0;\n\t__s64 err;\n\n\ttest2_result = cnt == 2;\n\n\t \n\terr = bpf_get_func_arg(ctx, 0, &a);\n\ttest2_result &= err == 0 && (int) a == 2;\n\n\terr = bpf_get_func_arg(ctx, 1, &b);\n\ttest2_result &= err == 0 && b == 3;\n\n\t \n\terr = bpf_get_func_arg(ctx, 2, &z);\n\ttest2_result &= err == -EINVAL;\n\n\t \n\terr = bpf_get_func_ret(ctx, &ret);\n\ttest2_result &= err == 0 && ret == 5;\n\treturn 0;\n}\n\n__u64 test3_result = 0;\nSEC(\"fmod_ret/bpf_modify_return_test\")\nint BPF_PROG(fmod_ret_test, int _a, int *_b, int _ret)\n{\n\t__u64 cnt = bpf_get_func_arg_cnt(ctx);\n\t__u64 a = 0, b = 0, z = 0, ret = 0;\n\t__s64 err;\n\n\ttest3_result = cnt == 2;\n\n\t \n\terr = bpf_get_func_arg(ctx, 0, &a);\n\ttest3_result &= err == 0 && ((int) a == 1);\n\n\terr = bpf_get_func_arg(ctx, 1, &b);\n\ttest3_result &= err == 0 && ((int *) b == _b);\n\n\t \n\terr = bpf_get_func_arg(ctx, 2, &z);\n\ttest3_result &= err == -EINVAL;\n\n\t \n\terr = bpf_get_func_ret(ctx, &ret);\n\ttest3_result &= err == 0 && ret == 0;\n\n\t \n\treturn 1234;\n}\n\n__u64 test4_result = 0;\nSEC(\"fexit/bpf_modify_return_test\")\nint BPF_PROG(fexit_test, int _a, int *_b, int _ret)\n{\n\t__u64 cnt = bpf_get_func_arg_cnt(ctx);\n\t__u64 a = 0, b = 0, z = 0, ret = 0;\n\t__s64 err;\n\n\ttest4_result = cnt == 2;\n\n\t \n\terr = bpf_get_func_arg(ctx, 0, &a);\n\ttest4_result &= err == 0 && ((int) a == 1);\n\n\terr = bpf_get_func_arg(ctx, 1, &b);\n\ttest4_result &= err == 0 && ((int *) b == _b);\n\n\t \n\terr = bpf_get_func_arg(ctx, 2, &z);\n\ttest4_result &= err == -EINVAL;\n\n\t \n\terr = bpf_get_func_ret(ctx, &ret);\n\ttest4_result &= err == 0 && ret == 1234;\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}