{
  "module_name": "test_core_reloc_enumval.c",
  "hash_id": "d52dff77b23f8015ef2d7685c937cab9130973731e08a21f89d0e1da69e87eeb",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_core_reloc_enumval.c",
  "human_readable_source": "\n\n\n#include <linux/bpf.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_core_read.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nstruct {\n\tchar in[256];\n\tchar out[256];\n\tbool skip;\n} data = {};\n\nenum named_enum {\n\tNAMED_ENUM_VAL1 = 1,\n\tNAMED_ENUM_VAL2 = 2,\n\tNAMED_ENUM_VAL3 = 3,\n};\n\ntypedef enum {\n\tANON_ENUM_VAL1 = 0x10,\n\tANON_ENUM_VAL2 = 0x20,\n\tANON_ENUM_VAL3 = 0x30,\n} anon_enum;\n\nstruct core_reloc_enumval_output {\n\tbool named_val1_exists;\n\tbool named_val2_exists;\n\tbool named_val3_exists;\n\tbool anon_val1_exists;\n\tbool anon_val2_exists;\n\tbool anon_val3_exists;\n\n\tint named_val1;\n\tint named_val2;\n\tint anon_val1;\n\tint anon_val2;\n};\n\nSEC(\"raw_tracepoint/sys_enter\")\nint test_core_enumval(void *ctx)\n{\n#if __has_builtin(__builtin_preserve_enum_value)\n\tstruct core_reloc_enumval_output *out = (void *)&data.out;\n\tenum named_enum named = 0;\n\tanon_enum anon = 0;\n\n\tout->named_val1_exists = bpf_core_enum_value_exists(named, NAMED_ENUM_VAL1);\n\tout->named_val2_exists = bpf_core_enum_value_exists(enum named_enum, NAMED_ENUM_VAL2);\n\tout->named_val3_exists = bpf_core_enum_value_exists(enum named_enum, NAMED_ENUM_VAL3);\n\n\tout->anon_val1_exists = bpf_core_enum_value_exists(anon, ANON_ENUM_VAL1);\n\tout->anon_val2_exists = bpf_core_enum_value_exists(anon_enum, ANON_ENUM_VAL2);\n\tout->anon_val3_exists = bpf_core_enum_value_exists(anon_enum, ANON_ENUM_VAL3);\n\n\tout->named_val1 = bpf_core_enum_value(named, NAMED_ENUM_VAL1);\n\tout->named_val2 = bpf_core_enum_value(named, NAMED_ENUM_VAL2);\n\t \n\n\tout->anon_val1 = bpf_core_enum_value(anon, ANON_ENUM_VAL1);\n\tout->anon_val2 = bpf_core_enum_value(anon, ANON_ENUM_VAL2);\n\t \n#else\n\tdata.skip = true;\n#endif\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}