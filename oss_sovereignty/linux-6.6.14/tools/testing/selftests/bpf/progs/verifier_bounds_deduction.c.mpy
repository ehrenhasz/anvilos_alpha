{
  "module_name": "verifier_bounds_deduction.c",
  "hash_id": "6b0a4b82a91312e4e1d04333a58643de33afeb89a74cb0b7e42a38e8e8769ae8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_bounds_deduction.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 1\")\n__failure __msg(\"R0 tried to subtract pointer from scalar\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__naked void deducing_bounds_from_const_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tif r0 s>= 1 goto l0_%=;\t\t\t\t\\\nl0_%=:\tr0 -= r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 2\")\n__success __failure_unpriv\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__retval(1)\n__naked void deducing_bounds_from_const_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tif r0 s>= 1 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tif r0 s<= 1 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl1_%=:\tr1 -= r0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 3\")\n__failure __msg(\"R0 tried to subtract pointer from scalar\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__naked void deducing_bounds_from_const_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s<= 0 goto l0_%=;\t\t\t\t\\\nl0_%=:\tr0 -= r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 4\")\n__success __failure_unpriv\n__msg_unpriv(\"R6 has pointer with unsupported alu operation\")\n__retval(0)\n__naked void deducing_bounds_from_const_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr6 = r1;\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s<= 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tif r0 s>= 0 goto l1_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl1_%=:\tr6 -= r0;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 5\")\n__failure __msg(\"R0 tried to subtract pointer from scalar\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__naked void deducing_bounds_from_const_5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s>= 1 goto l0_%=;\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 6\")\n__failure __msg(\"R0 tried to subtract pointer from scalar\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__naked void deducing_bounds_from_const_6(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s>= 0 goto l0_%=;\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 -= r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 7\")\n__failure __msg(\"dereference of modified ctx ptr\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void deducing_bounds_from_const_7(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = %[__imm_0];\t\t\t\t\\\n\tif r0 s>= 0 goto l0_%=;\t\t\t\t\\\nl0_%=:\tr1 -= r0;\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_mark]);\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, ~0),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 8\")\n__failure __msg(\"negative offset ctx ptr R1 off=-1 disallowed\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void deducing_bounds_from_const_8(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = %[__imm_0];\t\t\t\t\\\n\tif r0 s>= 0 goto l0_%=;\t\t\t\t\\\n\tr1 += r0;\t\t\t\t\t\\\nl0_%=:\tr0 = *(u32*)(r1 + %[__sk_buff_mark]);\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, ~0),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 9\")\n__failure __msg(\"R0 tried to subtract pointer from scalar\")\n__msg_unpriv(\"R1 has pointer with unsupported alu operation\")\n__naked void deducing_bounds_from_const_9(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s>= 0 goto l0_%=;\t\t\t\t\\\nl0_%=:\tr0 -= r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"check deducing bounds from const, 10\")\n__failure\n__msg(\"math between ctx pointer and register with unbounded min value is not allowed\")\n__failure_unpriv\n__naked void deducing_bounds_from_const_10(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r0 s<= 0 goto l0_%=;\t\t\t\t\\\nl0_%=:\t \t\t\t\\\n\tr0 = -r0;\t\t\t\t\t\\\n\tr0 -= r1;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}