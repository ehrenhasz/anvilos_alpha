{
  "module_name": "verifier_direct_packet_access.c",
  "hash_id": "5dc29ac23ab25e922a9d1d4fcd6a0f17342721474f214453fb6ee7f84361f8ba",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/verifier_direct_packet_access.c",
  "human_readable_source": "\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nSEC(\"tc\")\n__description(\"pkt_end - pkt_start is allowed\")\n__success __retval(TEST_DATA_LEN)\n__naked void end_pkt_start_is_allowed(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr0 -= r2;\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test1\")\n__success __retval(0)\n__naked void direct_packet_access_test1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test2\")\n__success __retval(0)\n__naked void direct_packet_access_test2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\tr4 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr5 = r3;\t\t\t\t\t\\\n\tr5 += 14;\t\t\t\t\t\\\n\tif r5 > r4 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r3 + 7);\t\t\t\t\\\n\tr4 = *(u8*)(r3 + 12);\t\t\t\t\\\n\tr4 *= 14;\t\t\t\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 += r4;\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_len]);\t\t\\\n\tr2 <<= 49;\t\t\t\t\t\\\n\tr2 >>= 49;\t\t\t\t\t\\\n\tr3 += r2;\t\t\t\t\t\\\n\tr2 = r3;\t\t\t\t\t\\\n\tr2 += 8;\t\t\t\t\t\\\n\tr1 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tif r2 > r1 goto l1_%=;\t\t\t\t\\\n\tr1 = *(u8*)(r3 + 4);\t\t\t\t\\\nl1_%=:\tr0 = 0;\t\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end)),\n\t  __imm_const(__sk_buff_len, offsetof(struct __sk_buff, len))\n\t: __clobber_all);\n}\n\nSEC(\"socket\")\n__description(\"direct packet access: test3\")\n__failure __msg(\"invalid bpf_context access off=76\")\n__failure_unpriv\n__naked void direct_packet_access_test3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test4 (write)\")\n__success __retval(0)\n__naked void direct_packet_access_test4_write(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u8*)(r2 + 0) = r2;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test5 (pkt_end >= reg, good access)\")\n__success __retval(0)\n__naked void pkt_end_reg_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 >= r0 goto l0_%=;\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test6 (pkt_end >= reg, bad access)\")\n__failure __msg(\"invalid access to packet\")\n__naked void pkt_end_reg_bad_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 >= r0 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test7 (pkt_end >= reg, both accesses)\")\n__failure __msg(\"invalid access to packet\")\n__naked void pkt_end_reg_both_accesses(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 >= r0 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test8 (double test, variant 1)\")\n__success __retval(0)\n__naked void test8_double_test_variant_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 >= r0 goto l0_%=;\t\t\t\t\\\n\tif r0 > r3 goto l1_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl1_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test9 (double test, variant 2)\")\n__success __retval(0)\n__naked void test9_double_test_variant_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 >= r0 goto l0_%=;\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tif r0 > r3 goto l1_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl1_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test10 (write invalid)\")\n__failure __msg(\"invalid access to packet\")\n__naked void packet_access_test10_write_invalid(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\t*(u8*)(r2 + 0) = r2;\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test11 (shift, good access)\")\n__success __retval(1)\n__naked void access_test11_shift_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 22;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr3 = 144;\t\t\t\t\t\\\n\tr5 = r3;\t\t\t\t\t\\\n\tr5 += 23;\t\t\t\t\t\\\n\tr5 >>= 3;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += r5;\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test12 (and, good access)\")\n__success __retval(1)\n__naked void access_test12_and_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 22;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr3 = 144;\t\t\t\t\t\\\n\tr5 = r3;\t\t\t\t\t\\\n\tr5 += 23;\t\t\t\t\t\\\n\tr5 &= 15;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += r5;\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test13 (branches, good access)\")\n__success __retval(1)\n__naked void access_test13_branches_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 22;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_mark]);\t\t\\\n\tr4 = 1;\t\t\t\t\t\t\\\n\tif r3 > r4 goto l1_%=;\t\t\t\t\\\n\tr3 = 14;\t\t\t\t\t\\\n\tgoto l2_%=;\t\t\t\t\t\\\nl1_%=:\tr3 = 24;\t\t\t\t\t\\\nl2_%=:\tr5 = r3;\t\t\t\t\t\\\n\tr5 += 23;\t\t\t\t\t\\\n\tr5 &= 15;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += r5;\t\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end)),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test14 (pkt_ptr += 0, CONST_IMM, good access)\")\n__success __retval(1)\n__naked void _0_const_imm_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 22;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr5 = 12;\t\t\t\t\t\\\n\tr5 >>= 4;\t\t\t\t\t\\\n\tr6 = r2;\t\t\t\t\t\\\n\tr6 += r5;\t\t\t\t\t\\\n\tr0 = *(u8*)(r6 + 0);\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test15 (spill with xadd)\")\n__failure __msg(\"R2 invalid mem access 'scalar'\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void access_test15_spill_with_xadd(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr5 = 4096;\t\t\t\t\t\\\n\tr4 = r10;\t\t\t\t\t\\\n\tr4 += -8;\t\t\t\t\t\\\n\t*(u64*)(r4 + 0) = r2;\t\t\t\t\\\n\tlock *(u64 *)(r4 + 0) += r5;\t\t\t\\\n\tr2 = *(u64*)(r4 + 0);\t\t\t\t\\\n\t*(u32*)(r2 + 0) = r5;\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test16 (arith on data_end)\")\n__failure __msg(\"R3 pointer arithmetic on pkt_end\")\n__naked void test16_arith_on_data_end(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tr3 += 16;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u8*)(r2 + 0) = r2;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test17 (pruning, alignment)\")\n__failure __msg(\"misaligned packet access off 2+(0x0; 0x0)+15+-4 size 4\")\n__flag(BPF_F_STRICT_ALIGNMENT)\n__naked void packet_access_test17_pruning_alignment(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr7 = *(u32*)(r1 + %[__sk_buff_mark]);\t\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 14;\t\t\t\t\t\\\n\tif r7 > 1 goto l0_%=;\t\t\t\t\\\nl2_%=:\tif r0 > r3 goto l1_%=;\t\t\t\t\\\n\t*(u32*)(r0 - 4) = r0;\t\t\t\t\\\nl1_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 += 1;\t\t\t\t\t\\\n\tgoto l2_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end)),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test18 (imm += pkt_ptr, 1)\")\n__success __retval(0)\n__naked void test18_imm_pkt_ptr_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = 8;\t\t\t\t\t\t\\\n\tr0 += r2;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u8*)(r2 + 0) = r2;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test19 (imm += pkt_ptr, 2)\")\n__success __retval(0)\n__naked void test19_imm_pkt_ptr_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr4 = 4;\t\t\t\t\t\t\\\n\tr4 += r2;\t\t\t\t\t\\\n\t*(u8*)(r4 + 0) = r4;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test20 (x += pkt_ptr, 1)\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void test20_x_pkt_ptr_1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = 0xffffffff;\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r0;\t\t\t\t\\\n\tr0 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr0 &= 0x7fff;\t\t\t\t\t\\\n\tr4 = r0;\t\t\t\t\t\\\n\tr4 += r2;\t\t\t\t\t\\\n\tr5 = r4;\t\t\t\t\t\\\n\tr4 += %[__imm_0];\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u64*)(r5 + 0) = r4;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0x7fff - 1),\n\t  __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test21 (x += pkt_ptr, 2)\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void test21_x_pkt_ptr_2(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr4 = 0xffffffff;\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r4;\t\t\t\t\\\n\tr4 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr4 &= 0x7fff;\t\t\t\t\t\\\n\tr4 += r2;\t\t\t\t\t\\\n\tr5 = r4;\t\t\t\t\t\\\n\tr4 += %[__imm_0];\t\t\t\t\\\n\tif r4 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u64*)(r5 + 0) = r4;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0x7fff - 1),\n\t  __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test22 (x += pkt_ptr, 3)\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void test22_x_pkt_ptr_3(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r2;\t\t\t\t\\\n\t*(u64*)(r10 - 16) = r3;\t\t\t\t\\\n\tr3 = *(u64*)(r10 - 16);\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr2 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr4 = 0xffffffff;\t\t\t\t\\\n\tlock *(u64 *)(r10 - 8) += r4;\t\t\t\\\n\tr4 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr4 >>= 49;\t\t\t\t\t\\\n\tr4 += r2;\t\t\t\t\t\\\n\tr0 = r4;\t\t\t\t\t\\\n\tr0 += 2;\t\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\tr2 = 1;\t\t\t\t\t\t\\\n\t*(u16*)(r4 + 0) = r2;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test23 (x += pkt_ptr, 4)\")\n__failure __msg(\"invalid access to packet, off=0 size=8, R5(id=2,off=0,r=0)\")\n__flag(BPF_F_ANY_ALIGNMENT)\n__naked void test23_x_pkt_ptr_4(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = *(u32*)(r1 + %[__sk_buff_mark]);\t\t\\\n\t*(u64*)(r10 - 8) = r0;\t\t\t\t\\\n\tr0 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr0 &= 0xffff;\t\t\t\t\t\\\n\tr4 = r0;\t\t\t\t\t\\\n\tr0 = 31;\t\t\t\t\t\\\n\tr0 += r4;\t\t\t\t\t\\\n\tr0 += r2;\t\t\t\t\t\\\n\tr5 = r0;\t\t\t\t\t\\\n\tr0 += %[__imm_0];\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u64*)(r5 + 0) = r0;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0xffff - 1),\n\t  __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end)),\n\t  __imm_const(__sk_buff_mark, offsetof(struct __sk_buff, mark))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test24 (x += pkt_ptr, 5)\")\n__success __retval(0) __flag(BPF_F_ANY_ALIGNMENT)\n__naked void test24_x_pkt_ptr_5(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = 0xffffffff;\t\t\t\t\\\n\t*(u64*)(r10 - 8) = r0;\t\t\t\t\\\n\tr0 = *(u64*)(r10 - 8);\t\t\t\t\\\n\tr0 &= 0xff;\t\t\t\t\t\\\n\tr4 = r0;\t\t\t\t\t\\\n\tr0 = 64;\t\t\t\t\t\\\n\tr0 += r4;\t\t\t\t\t\\\n\tr0 += r2;\t\t\t\t\t\\\n\tr5 = r0;\t\t\t\t\t\\\n\tr0 += %[__imm_0];\t\t\t\t\\\n\tif r0 > r3 goto l0_%=;\t\t\t\t\\\n\t*(u64*)(r5 + 0) = r0;\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__imm_0, 0x7fff - 1),\n\t  __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test25 (marking on <, good access)\")\n__success __retval(0)\n__naked void test25_marking_on_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 < r3 goto l0_%=;\t\t\t\t\\\nl1_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test26 (marking on <, bad access)\")\n__failure __msg(\"invalid access to packet\")\n__naked void test26_marking_on_bad_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r0 < r3 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl1_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test27 (marking on <=, good access)\")\n__success __retval(1)\n__naked void test27_marking_on_good_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 <= r0 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test28 (marking on <=, bad access)\")\n__failure __msg(\"invalid access to packet\")\n__naked void test28_marking_on_bad_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr0 = r2;\t\t\t\t\t\\\n\tr0 += 8;\t\t\t\t\t\\\n\tif r3 <= r0 goto l0_%=;\t\t\t\t\\\nl1_%=:\tr0 = 1;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\nl0_%=:\tr0 = *(u8*)(r2 + 0);\t\t\t\t\\\n\tgoto l1_%=;\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test29 (reg > pkt_end in subprog)\")\n__success __retval(0)\n__naked void reg_pkt_end_in_subprog(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr6 = *(u32*)(r1 + %[__sk_buff_data]);\t\t\\\n\tr2 = *(u32*)(r1 + %[__sk_buff_data_end]);\t\\\n\tr3 = r6;\t\t\t\t\t\\\n\tr3 += 8;\t\t\t\t\t\\\n\tcall reg_pkt_end_in_subprog__1;\t\t\t\\\n\tif r0 == 0 goto l0_%=;\t\t\t\t\\\n\tr0 = *(u8*)(r6 + 0);\t\t\t\t\\\nl0_%=:\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nstatic __naked __noinline __attribute__((used))\nvoid reg_pkt_end_in_subprog__1(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\tif r3 > r2 goto l0_%=;\t\t\t\t\\\n\tr0 = 1;\t\t\t\t\t\t\\\nl0_%=:\texit;\t\t\t\t\t\t\\\n\"\t::: __clobber_all);\n}\n\nSEC(\"tc\")\n__description(\"direct packet access: test30 (check_id() in regsafe(), bad access)\")\n__failure __msg(\"invalid access to packet, off=0 size=1, R2\")\n__flag(BPF_F_TEST_STATE_FREQ)\n__naked void id_in_regsafe_bad_access(void)\n{\n\tasm volatile (\"\t\t\t\t\t\\\n\t \t\t\t\t\t\\\n\tr9 = r1;\t\t\t\t\t\\\n\t \t\t\t\\\n\tcall %[bpf_ktime_get_ns];\t\t\t\\\n\tr7 = r0;\t\t\t\t\t\\\n\t \t\t\t\\\n\tcall %[bpf_ktime_get_ns];\t\t\t\\\n\tr6 = r0;\t\t\t\t\t\\\n\t \t\t\t\t\t\t\\\n\tr2 = *(u32*)(r9 + %[__sk_buff_data]);\t\t\\\n\tr3 = *(u32*)(r9 + %[__sk_buff_data]);\t\t\\\n\tr4 = *(u32*)(r9 + %[__sk_buff_data_end]);\t\\\n\t \t\t\t\t\t\t\\\n\tif r6 > 100 goto l0_%=;\t\t\t\t\\\n\tif r7 > 100 goto l0_%=;\t\t\t\t\\\n\t \t\t\t\t\t\t\\\n\tr2 += r6;\t\t\t\t\t\\\n\tr2 += 1;\t\t\t\t\t\\\n\tr3 += r7;\t\t\t\t\t\\\n\tr3 += 1;\t\t\t\t\t\\\n\t \t\t\t\t\t\t\\\n\tif r6 != r7 goto l1_%=;\t\t\t\t\\\n\tr2 = r3;\t\t\t\t\t\\\nl1_%=:\t \t\t\\\n\tif r3 > r4 goto l0_%=;\t\t\t\t\\\n\t \t\t\t\t\t\t\\\n\tr5 = *(u8*)(r2 - 1);\t\t\t\t\\\nl0_%=:\t \t\t\t\t\t\\\n\tr0 = 0;\t\t\t\t\t\t\\\n\texit;\t\t\t\t\t\t\\\n\"\t:\n\t: __imm(bpf_ktime_get_ns),\n\t  __imm_const(__sk_buff_data, offsetof(struct __sk_buff, data)),\n\t  __imm_const(__sk_buff_data_end, offsetof(struct __sk_buff, data_end))\n\t: __clobber_all);\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}