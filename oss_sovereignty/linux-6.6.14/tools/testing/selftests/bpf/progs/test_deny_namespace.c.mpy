{
  "module_name": "test_deny_namespace.c",
  "hash_id": "cfbb0bcd486486ba3135b1314d30c34d9ea5dd4d66db368e5903f53a1b7ca392",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_deny_namespace.c",
  "human_readable_source": "\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include <errno.h>\n#include <linux/capability.h>\n\ntypedef struct { unsigned long long val; } kernel_cap_t;\n\nstruct cred {\n\tkernel_cap_t cap_effective;\n} __attribute__((preserve_access_index));\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nSEC(\"lsm.s/userns_create\")\nint BPF_PROG(test_userns_create, const struct cred *cred, int ret)\n{\n\tkernel_cap_t caps = cred->cap_effective;\n\t__u64 cap_mask = 1ULL << CAP_SYS_ADMIN;\n\n\tif (ret)\n\t\treturn 0;\n\n\tret = -EPERM;\n\tif (caps.val & cap_mask)\n\t\treturn 0;\n\n\treturn -EPERM;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}