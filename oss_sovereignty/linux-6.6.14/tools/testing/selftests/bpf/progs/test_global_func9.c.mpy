{
  "module_name": "test_global_func9.c",
  "hash_id": "23672ab6017fe00d7fb5f7dfe98872a86d26742fa6c0153a885a6a198a817435",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/test_global_func9.c",
  "human_readable_source": "\n#include <stddef.h>\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include \"bpf_misc.h\"\n\nstruct S {\n\tint x;\n};\n\nstruct C {\n\tint x;\n\tint y;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(max_entries, 1);\n\t__type(key, __u32);\n\t__type(value, struct S);\n} map SEC(\".maps\");\n\nenum E {\n\tE_ITEM\n};\n\nstatic int global_data_x = 100;\nstatic int volatile global_data_y = 500;\n\n__noinline int foo(const struct S *s)\n{\n\tif (s)\n\t\treturn bpf_get_prandom_u32() < s->x;\n\n\treturn 0;\n}\n\n__noinline int bar(int *x)\n{\n\tif (x)\n\t\t*x &= bpf_get_prandom_u32();\n\n\treturn 0;\n}\n__noinline int baz(volatile int *x)\n{\n\tif (x)\n\t\t*x &= bpf_get_prandom_u32();\n\n\treturn 0;\n}\n\n__noinline int qux(enum E *e)\n{\n\tif (e)\n\t\treturn *e;\n\n\treturn 0;\n}\n\n__noinline int quux(int (*arr)[10])\n{\n\tif (arr)\n\t\treturn (*arr)[9];\n\n\treturn 0;\n}\n\n__noinline int quuz(int **p)\n{\n\tif (p)\n\t\t*p = NULL;\n\n\treturn 0;\n}\n\nSEC(\"cgroup_skb/ingress\")\n__success\nint global_func9(struct __sk_buff *skb)\n{\n\tint result = 0;\n\n\t{\n\t\tconst struct S s = {.x = skb->len };\n\n\t\tresult |= foo(&s);\n\t}\n\n\t{\n\t\tconst __u32 key = 1;\n\t\tconst struct S *s = bpf_map_lookup_elem(&map, &key);\n\n\t\tresult |= foo(s);\n\t}\n\n\t{\n\t\tconst struct C c = {.x = skb->len, .y = skb->family };\n\n\t\tresult |= foo((const struct S *)&c);\n\t}\n\n\t{\n\t\tresult |= foo(NULL);\n\t}\n\n\t{\n\t\tbar(&result);\n\t\tbar(&global_data_x);\n\t}\n\n\t{\n\t\tresult |= baz(&global_data_y);\n\t}\n\n\t{\n\t\tenum E e = E_ITEM;\n\n\t\tresult |= qux(&e);\n\t}\n\n\t{\n\t\tint array[10] = {0};\n\n\t\tresult |= quux(&array);\n\t}\n\n\t{\n\t\tint *p;\n\n\t\tresult |= quuz(&p);\n\t}\n\n\treturn result ? 1 : 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}