{
  "module_name": "bpf_iter_setsockopt_unix.c",
  "hash_id": "0f28c795592103993c627eece8cbb3dde5d3a28e75643bbe88d86c8d80e16552",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/bpf_iter_setsockopt_unix.c",
  "human_readable_source": "\n \n#include \"bpf_iter.h\"\n#include \"bpf_tracing_net.h\"\n#include <bpf/bpf_helpers.h>\n#include <limits.h>\n\n#define AUTOBIND_LEN 6\nchar sun_path[AUTOBIND_LEN];\n\n#define NR_CASES 5\nint sndbuf_setsockopt[NR_CASES] = {-1, 0, 8192, INT_MAX / 2, INT_MAX};\nint sndbuf_getsockopt[NR_CASES] = {-1, -1, -1, -1, -1};\nint sndbuf_getsockopt_expected[NR_CASES];\n\nstatic inline int cmpname(struct unix_sock *unix_sk)\n{\n\tint i;\n\n\tfor (i = 0; i < AUTOBIND_LEN; i++) {\n\t\tif (unix_sk->addr->name->sun_path[i] != sun_path[i])\n\t\t\treturn -1;\n\t}\n\n\treturn 0;\n}\n\nSEC(\"iter/unix\")\nint change_sndbuf(struct bpf_iter__unix *ctx)\n{\n\tstruct unix_sock *unix_sk = ctx->unix_sk;\n\tint i, err;\n\n\tif (!unix_sk || !unix_sk->addr)\n\t\treturn 0;\n\n\tif (unix_sk->addr->name->sun_path[0])\n\t\treturn 0;\n\n\tif (cmpname(unix_sk))\n\t\treturn 0;\n\n\tfor (i = 0; i < NR_CASES; i++) {\n\t\terr = bpf_setsockopt(unix_sk, SOL_SOCKET, SO_SNDBUF,\n\t\t\t\t     &sndbuf_setsockopt[i],\n\t\t\t\t     sizeof(sndbuf_setsockopt[i]));\n\t\tif (err)\n\t\t\tbreak;\n\n\t\terr = bpf_getsockopt(unix_sk, SOL_SOCKET, SO_SNDBUF,\n\t\t\t\t     &sndbuf_getsockopt[i],\n\t\t\t\t     sizeof(sndbuf_getsockopt[i]));\n\t\tif (err)\n\t\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}