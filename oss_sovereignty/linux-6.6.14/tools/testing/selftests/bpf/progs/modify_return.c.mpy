{
  "module_name": "modify_return.c",
  "hash_id": "ce1542d8e7889e2b22d3699102864a55f341d68bbd97b00d3eeeef8d610f4197",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/modify_return.c",
  "human_readable_source": "\n\n \n\n#include <linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n\nchar _license[] SEC(\"license\") = \"GPL\";\n\nstatic int sequence = 0;\n__s32 input_retval = 0;\n\n__u64 fentry_result = 0;\nSEC(\"fentry/bpf_modify_return_test\")\nint BPF_PROG(fentry_test, int a, __u64 b)\n{\n\tsequence++;\n\tfentry_result = (sequence == 1);\n\treturn 0;\n}\n\n__u64 fmod_ret_result = 0;\nSEC(\"fmod_ret/bpf_modify_return_test\")\nint BPF_PROG(fmod_ret_test, int a, int *b, int ret)\n{\n\tsequence++;\n\t \n\tfmod_ret_result = (sequence == 2 && ret == 0);\n\treturn input_retval;\n}\n\n__u64 fexit_result = 0;\nSEC(\"fexit/bpf_modify_return_test\")\nint BPF_PROG(fexit_test, int a, __u64 b, int ret)\n{\n\tsequence++;\n\t \n\tif (input_retval)\n\t\tfexit_result = (sequence == 3 && ret == input_retval);\n\telse\n\t\tfexit_result = (sequence == 3 && ret == 4);\n\n\treturn 0;\n}\n\nstatic int sequence2;\n\n__u64 fentry_result2 = 0;\nSEC(\"fentry/bpf_modify_return_test2\")\nint BPF_PROG(fentry_test2, int a, int *b, short c, int d, void *e, char f,\n\t     int g)\n{\n\tsequence2++;\n\tfentry_result2 = (sequence2 == 1);\n\treturn 0;\n}\n\n__u64 fmod_ret_result2 = 0;\nSEC(\"fmod_ret/bpf_modify_return_test2\")\nint BPF_PROG(fmod_ret_test2, int a, int *b, short c, int d, void *e, char f,\n\t     int g, int ret)\n{\n\tsequence2++;\n\t \n\tfmod_ret_result2 = (sequence2 == 2 && ret == 0);\n\treturn input_retval;\n}\n\n__u64 fexit_result2 = 0;\nSEC(\"fexit/bpf_modify_return_test2\")\nint BPF_PROG(fexit_test2, int a, int *b, short c, int d, void *e, char f,\n\t     int g, int ret)\n{\n\tsequence2++;\n\t \n\tif (input_retval)\n\t\tfexit_result2 = (sequence2 == 3 && ret == input_retval);\n\telse\n\t\tfexit_result2 = (sequence2 == 3 && ret == 29);\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}