{
  "module_name": "recvmsg6_prog.c",
  "hash_id": "f0892b5ba074b0dfeaccdd5c3cc4646c4c1f401cea510cb18f6691f6c881f771",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/recvmsg6_prog.c",
  "human_readable_source": "\n\n#include <linux/stddef.h>\n#include <linux/bpf.h>\n#include <linux/in6.h>\n#include <sys/socket.h>\n\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_endian.h>\n\n#include <bpf_sockopt_helpers.h>\n\n#define SERV6_IP_0\t\t0xfaceb00c  \n#define SERV6_IP_1\t\t0x12345678\n#define SERV6_IP_2\t\t0x00000000\n#define SERV6_IP_3\t\t0x0000abcd\n#define SERV6_PORT\t\t6060\n\nSEC(\"cgroup/recvmsg6\")\nint recvmsg6_prog(struct bpf_sock_addr *ctx)\n{\n\tstruct bpf_sock *sk;\n\n\tsk = ctx->sk;\n\tif (!sk)\n\t\treturn 1;\n\n\tif (sk->family != AF_INET6)\n\t\treturn 1;\n\n\tif (ctx->type != SOCK_STREAM && ctx->type != SOCK_DGRAM)\n\t\treturn 1;\n\n\tif (!get_set_sk_priority(ctx))\n\t\treturn 1;\n\n\tctx->user_ip6[0] = bpf_htonl(SERV6_IP_0);\n\tctx->user_ip6[1] = bpf_htonl(SERV6_IP_1);\n\tctx->user_ip6[2] = bpf_htonl(SERV6_IP_2);\n\tctx->user_ip6[3] = bpf_htonl(SERV6_IP_3);\n\tctx->user_port = bpf_htons(SERV6_PORT);\n\n\treturn 1;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}