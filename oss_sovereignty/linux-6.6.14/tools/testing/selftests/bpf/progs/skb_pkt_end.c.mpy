{
  "module_name": "skb_pkt_end.c",
  "hash_id": "98d68ebc0b78ee3c1cec41081bfa5d758ca208367e153c090273c8924c461013",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/progs/skb_pkt_end.c",
  "human_readable_source": "\n#define BPF_NO_PRESERVE_ACCESS_INDEX\n#include <vmlinux.h>\n#include <bpf/bpf_core_read.h>\n#include <bpf/bpf_helpers.h>\n\n#define INLINE __always_inline\n\n#define skb_shorter(skb, len) ((void *)(long)(skb)->data + (len) > (void *)(long)skb->data_end)\n\n#define ETH_IPV4_TCP_SIZE (14 + sizeof(struct iphdr) + sizeof(struct tcphdr))\n\nstatic INLINE struct iphdr *get_iphdr(struct __sk_buff *skb)\n{\n\tstruct iphdr *ip = NULL;\n\tstruct ethhdr *eth;\n\n\tif (skb_shorter(skb, ETH_IPV4_TCP_SIZE))\n\t\tgoto out;\n\n\teth = (void *)(long)skb->data;\n\tip = (void *)(eth + 1);\n\nout:\n\treturn ip;\n}\n\nSEC(\"tc\")\nint main_prog(struct __sk_buff *skb)\n{\n\tstruct iphdr *ip = NULL;\n\tstruct tcphdr *tcp;\n\t__u8 proto = 0;\n\n\tif (!(ip = get_iphdr(skb)))\n\t\tgoto out;\n\n\tproto = ip->protocol;\n\n\tif (proto != IPPROTO_TCP)\n\t\tgoto out;\n\n\ttcp = (void*)(ip + 1);\n\tif (tcp->dest != 0)\n\t\tgoto out;\n\tif (!tcp)\n\t\tgoto out;\n\n\treturn tcp->urg_ptr;\nout:\n\treturn -1;\n}\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}