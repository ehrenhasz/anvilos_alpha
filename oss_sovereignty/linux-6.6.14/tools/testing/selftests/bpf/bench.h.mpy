{
  "module_name": "bench.h",
  "hash_id": "3511b262ba949010b795b9cec646d92838b1b2f97df8f4def54f2c1d40daf906",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/bpf/bench.h",
  "human_readable_source": " \n#pragma once\n#include <stdlib.h>\n#include <stdbool.h>\n#include <linux/err.h>\n#include <errno.h>\n#include <unistd.h>\n#include <bpf/bpf.h>\n#include <bpf/libbpf.h>\n#include <math.h>\n#include <time.h>\n#include <sys/syscall.h>\n\nstruct cpu_set {\n\tbool *cpus;\n\tint cpus_len;\n\tint next_cpu;\n};\n\nstruct env {\n\tchar *bench_name;\n\tint duration_sec;\n\tint warmup_sec;\n\tbool verbose;\n\tbool list;\n\tbool affinity;\n\tbool quiet;\n\tint consumer_cnt;\n\tint producer_cnt;\n\tint nr_cpus;\n\tstruct cpu_set prod_cpus;\n\tstruct cpu_set cons_cpus;\n};\n\nstruct basic_stats {\n\tdouble mean;\n\tdouble stddev;\n};\n\nstruct bench_res {\n\tlong hits;\n\tlong drops;\n\tlong false_hits;\n\tlong important_hits;\n\tunsigned long gp_ns;\n\tunsigned long gp_ct;\n\tunsigned int stime;\n};\n\nstruct bench {\n\tconst char *name;\n\tconst struct argp *argp;\n\tvoid (*validate)(void);\n\tvoid (*setup)(void);\n\tvoid *(*producer_thread)(void *ctx);\n\tvoid *(*consumer_thread)(void *ctx);\n\tvoid (*measure)(struct bench_res* res);\n\tvoid (*report_progress)(int iter, struct bench_res* res, long delta_ns);\n\tvoid (*report_final)(struct bench_res res[], int res_cnt);\n};\n\nstruct counter {\n\tlong value;\n} __attribute__((aligned(128)));\n\nextern struct env env;\nextern const struct bench *bench;\n\nvoid setup_libbpf(void);\nvoid hits_drops_report_progress(int iter, struct bench_res *res, long delta_ns);\nvoid hits_drops_report_final(struct bench_res res[], int res_cnt);\nvoid false_hits_report_progress(int iter, struct bench_res *res, long delta_ns);\nvoid false_hits_report_final(struct bench_res res[], int res_cnt);\nvoid ops_report_progress(int iter, struct bench_res *res, long delta_ns);\nvoid ops_report_final(struct bench_res res[], int res_cnt);\nvoid local_storage_report_progress(int iter, struct bench_res *res,\n\t\t\t\t   long delta_ns);\nvoid local_storage_report_final(struct bench_res res[], int res_cnt);\nvoid grace_period_latency_basic_stats(struct bench_res res[], int res_cnt,\n\t\t\t\t      struct basic_stats *gp_stat);\nvoid grace_period_ticks_basic_stats(struct bench_res res[], int res_cnt,\n\t\t\t\t    struct basic_stats *gp_stat);\n\nstatic inline void atomic_inc(long *value)\n{\n\t(void)__atomic_add_fetch(value, 1, __ATOMIC_RELAXED);\n}\n\nstatic inline void atomic_add(long *value, long n)\n{\n\t(void)__atomic_add_fetch(value, n, __ATOMIC_RELAXED);\n}\n\nstatic inline long atomic_swap(long *value, long n)\n{\n\treturn __atomic_exchange_n(value, n, __ATOMIC_RELAXED);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}