{
  "module_name": "v_initval_nolibc.c",
  "hash_id": "7305051784eaade98e6b0836d79816144247e39b6c2d20c54ae9f323fafdc6a4",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/riscv/vector/v_initval_nolibc.c",
  "human_readable_source": "\n\n#include \"../../kselftest.h\"\n#define MAX_VSIZE\t(8192 * 32)\n\nvoid dump(char *ptr, int size)\n{\n\tint i = 0;\n\n\tfor (i = 0; i < size; i++) {\n\t\tif (i != 0) {\n\t\t\tif (i % 16 == 0)\n\t\t\t\tprintf(\"\\n\");\n\t\t\telse if (i % 8 == 0)\n\t\t\t\tprintf(\"  \");\n\t\t}\n\t\tprintf(\"%02x \", ptr[i]);\n\t}\n\tprintf(\"\\n\");\n}\n\nint main(void)\n{\n\tint i;\n\tunsigned long vl;\n\tchar *datap, *tmp;\n\n\tdatap = malloc(MAX_VSIZE);\n\tif (!datap) {\n\t\tksft_test_result_fail(\"fail to allocate memory for size = %lu\\n\", MAX_VSIZE);\n\t\texit(-1);\n\t}\n\n\ttmp = datap;\n\tasm volatile (\n\t\t\".option push\\n\\t\"\n\t\t\".option arch, +v\\n\\t\"\n\t\t\"vsetvli\t%0, x0, e8, m8, ta, ma\\n\\t\"\n\t\t\"vse8.v\t\tv0, (%2)\\n\\t\"\n\t\t\"add\t\t%1, %2, %0\\n\\t\"\n\t\t\"vse8.v\t\tv8, (%1)\\n\\t\"\n\t\t\"add\t\t%1, %1, %0\\n\\t\"\n\t\t\"vse8.v\t\tv16, (%1)\\n\\t\"\n\t\t\"add\t\t%1, %1, %0\\n\\t\"\n\t\t\"vse8.v\t\tv24, (%1)\\n\\t\"\n\t\t\".option pop\\n\\t\"\n\t\t: \"=&r\" (vl), \"=r\" (tmp) : \"r\" (datap) : \"memory\");\n\n\tksft_print_msg(\"vl = %lu\\n\", vl);\n\n\tif (datap[0] != 0x00 && datap[0] != 0xff) {\n\t\tksft_test_result_fail(\"v-regesters are not properly initialized\\n\");\n\t\tdump(datap, vl * 4);\n\t\texit(-1);\n\t}\n\n\tfor (i = 1; i < vl * 4; i++) {\n\t\tif (datap[i] != datap[0]) {\n\t\t\tksft_test_result_fail(\"detect stale values on v-regesters\\n\");\n\t\t\tdump(datap, vl * 4);\n\t\t\texit(-2);\n\t\t}\n\t}\n\n\tfree(datap);\n\tksft_exit_pass();\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}