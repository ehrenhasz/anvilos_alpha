{
  "module_name": "sync_wait.c",
  "hash_id": "9721a6c3d27f48cbc57345a326e48908a3bba85c0e8385fbe7c0f1b47142d6b1",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/sync/sync_wait.c",
  "human_readable_source": " \n\n#include \"sync.h\"\n#include \"sw_sync.h\"\n#include \"synctest.h\"\n\nint test_fence_multi_timeline_wait(void)\n{\n\tint timelineA, timelineB, timelineC;\n\tint fenceA, fenceB, fenceC, merged;\n\tint valid, active, signaled, ret;\n\n\ttimelineA = sw_sync_timeline_create();\n\ttimelineB = sw_sync_timeline_create();\n\ttimelineC = sw_sync_timeline_create();\n\n\tfenceA = sw_sync_fence_create(timelineA, \"fenceA\", 5);\n\tfenceB = sw_sync_fence_create(timelineB, \"fenceB\", 5);\n\tfenceC = sw_sync_fence_create(timelineC, \"fenceC\", 5);\n\n\tmerged = sync_merge(\"mergeFence\", fenceB, fenceA);\n\tmerged = sync_merge(\"mergeFence\", fenceC, merged);\n\n\tvalid = sw_sync_fence_is_valid(merged);\n\tASSERT(valid, \"Failure merging fence from various timelines\\n\");\n\n\t \n\tactive = sync_fence_count_with_status(merged, FENCE_STATUS_ACTIVE);\n\tASSERT(active == 3, \"Fence signaled too early!\\n\");\n\n\tret = sync_wait(merged, 0);\n\tASSERT(ret == 0,\n\t       \"Failure waiting on fence until timeout\\n\");\n\n\tret = sw_sync_timeline_inc(timelineA, 5);\n\tactive = sync_fence_count_with_status(merged, FENCE_STATUS_ACTIVE);\n\tsignaled = sync_fence_count_with_status(merged, FENCE_STATUS_SIGNALED);\n\tASSERT(active == 2 && signaled == 1,\n\t       \"Fence did not signal properly!\\n\");\n\n\tret = sw_sync_timeline_inc(timelineB, 5);\n\tactive = sync_fence_count_with_status(merged, FENCE_STATUS_ACTIVE);\n\tsignaled = sync_fence_count_with_status(merged, FENCE_STATUS_SIGNALED);\n\tASSERT(active == 1 && signaled == 2,\n\t       \"Fence did not signal properly!\\n\");\n\n\tret = sw_sync_timeline_inc(timelineC, 5);\n\tactive = sync_fence_count_with_status(merged, FENCE_STATUS_ACTIVE);\n\tsignaled = sync_fence_count_with_status(merged, FENCE_STATUS_SIGNALED);\n\tASSERT(active == 0 && signaled == 3,\n\t       \"Fence did not signal properly!\\n\");\n\n\t \n\tret = sync_wait(merged, 100);\n\tASSERT(ret > 0, \"Failure waiting on signaled fence\\n\");\n\n\tsw_sync_fence_destroy(merged);\n\tsw_sync_fence_destroy(fenceC);\n\tsw_sync_fence_destroy(fenceB);\n\tsw_sync_fence_destroy(fenceA);\n\tsw_sync_timeline_destroy(timelineC);\n\tsw_sync_timeline_destroy(timelineB);\n\tsw_sync_timeline_destroy(timelineA);\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}