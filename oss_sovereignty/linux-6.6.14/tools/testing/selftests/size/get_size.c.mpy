{
  "module_name": "get_size.c",
  "hash_id": "3d586c366d4dc6583219bb748e1bdb3028866d99bf252f0f740f297cdf5a0281",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/size/get_size.c",
  "human_readable_source": "\n \n\n#include <sys/sysinfo.h>\n#include <unistd.h>\n#include <sys/syscall.h>\n\n#define STDOUT_FILENO 1\n\nstatic int print(const char *s)\n{\n\tsize_t len = 0;\n\n\twhile (s[len] != '\\0')\n\t\tlen++;\n\n\treturn syscall(SYS_write, STDOUT_FILENO, s, len);\n}\n\nstatic inline char *num_to_str(unsigned long num, char *buf, int len)\n{\n\tunsigned int digit;\n\n\t \n\tbuf += len - 1;\n\t*buf = 0;\n\tdo {\n\t\tdigit = num % 10;\n\t\t*(--buf) = digit + '0';\n\t\tnum /= 10;\n\t} while (num > 0);\n\n\treturn buf;\n}\n\nstatic int print_num(unsigned long num)\n{\n\tchar num_buf[30];\n\n\treturn print(num_to_str(num, num_buf, sizeof(num_buf)));\n}\n\nstatic int print_k_value(const char *s, unsigned long num, unsigned long units)\n{\n\tunsigned long long temp;\n\tint ccode;\n\n\tprint(s);\n\n\ttemp = num;\n\ttemp = (temp * units)/1024;\n\tnum = temp;\n\tccode = print_num(num);\n\tprint(\"\\n\");\n\treturn ccode;\n}\n\n \nvoid _start(void)\n{\n\tint ccode;\n\tstruct sysinfo info;\n\tunsigned long used;\n\tstatic const char *test_name = \" get runtime memory use\\n\";\n\n\tprint(\"TAP version 13\\n\");\n\tprint(\"# Testing system size.\\n\");\n\n\tccode = syscall(SYS_sysinfo, &info);\n\tif (ccode < 0) {\n\t\tprint(\"not ok 1\");\n\t\tprint(test_name);\n\t\tprint(\" ---\\n reason: \\\"could not get sysinfo\\\"\\n ...\\n\");\n\t\tsyscall(SYS_exit, ccode);\n\t}\n\tprint(\"ok 1\");\n\tprint(test_name);\n\n\t \n\tused = info.totalram - info.freeram - info.bufferram;\n\tprint(\"# System runtime memory report (units in Kilobytes):\\n\");\n\tprint(\" ---\\n\");\n\tprint_k_value(\" Total:  \", info.totalram, info.mem_unit);\n\tprint_k_value(\" Free:   \", info.freeram, info.mem_unit);\n\tprint_k_value(\" Buffer: \", info.bufferram, info.mem_unit);\n\tprint_k_value(\" In use: \", used, info.mem_unit);\n\tprint(\" ...\\n\");\n\tprint(\"1..1\\n\");\n\n\tsyscall(SYS_exit, 0);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}