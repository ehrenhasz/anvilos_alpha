{
  "module_name": "Makefile",
  "hash_id": "d750279ba4d2e0a518817c552f463934ef7313a413281c840176a5076aac7f6d",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/x86/Makefile",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\nall:\n\ninclude ../lib.mk\n\n.PHONY: all all_32 all_64 warn_32bit_failure clean\n\nUNAME_M := $(shell uname -m)\nCAN_BUILD_I386 := $(shell ./check_cc.sh \"$(CC)\" trivial_32bit_program.c -m32)\nCAN_BUILD_X86_64 := $(shell ./check_cc.sh \"$(CC)\" trivial_64bit_program.c)\nCAN_BUILD_WITH_NOPIE := $(shell ./check_cc.sh \"$(CC)\" trivial_program.c -no-pie)\n\nTARGETS_C_BOTHBITS := single_step_syscall sysret_ss_attrs syscall_nt test_mremap_vdso \\\n\t\t\tcheck_initial_reg_state sigreturn iopl ioperm \\\n\t\t\ttest_vsyscall mov_ss_trap \\\n\t\t\tsyscall_arg_fault fsgsbase_restore sigaltstack\nTARGETS_C_32BIT_ONLY := entry_from_vm86 test_syscall_vdso unwind_vdso \\\n\t\t\ttest_FCMOV test_FCOMI test_FISTTP \\\n\t\t\tvdso_restorer\nTARGETS_C_64BIT_ONLY := fsgsbase sysret_rip syscall_numbering \\\n\t\t\tcorrupt_xstate_header amx lam test_shadow_stack\n# Some selftests require 32bit support enabled also on 64bit systems\nTARGETS_C_32BIT_NEEDED := ldt_gdt ptrace_syscall\n\nTARGETS_C_32BIT_ALL := $(TARGETS_C_BOTHBITS) $(TARGETS_C_32BIT_ONLY) $(TARGETS_C_32BIT_NEEDED)\nTARGETS_C_64BIT_ALL := $(TARGETS_C_BOTHBITS) $(TARGETS_C_64BIT_ONLY)\nifeq ($(CAN_BUILD_I386)$(CAN_BUILD_X86_64),11)\nTARGETS_C_64BIT_ALL += $(TARGETS_C_32BIT_NEEDED)\nendif\n\nBINARIES_32 := $(TARGETS_C_32BIT_ALL:%=%_32)\nBINARIES_64 := $(TARGETS_C_64BIT_ALL:%=%_64)\n\nBINARIES_32 := $(patsubst %,$(OUTPUT)/%,$(BINARIES_32))\nBINARIES_64 := $(patsubst %,$(OUTPUT)/%,$(BINARIES_64))\n\nCFLAGS := -O2 -g -std=gnu99 -pthread -Wall $(KHDR_INCLUDES)\n\n# call32_from_64 in thunks.S uses absolute addresses.\nifeq ($(CAN_BUILD_WITH_NOPIE),1)\nCFLAGS += -no-pie\nendif\n\ndefine gen-target-rule-32\n$(1) $(1)_32: $(OUTPUT)/$(1)_32\n.PHONY: $(1) $(1)_32\nendef\n\ndefine gen-target-rule-64\n$(1) $(1)_64: $(OUTPUT)/$(1)_64\n.PHONY: $(1) $(1)_64\nendef\n\nifeq ($(CAN_BUILD_I386),1)\nall: all_32\nTEST_PROGS += $(BINARIES_32)\nEXTRA_CFLAGS += -DCAN_BUILD_32\n$(foreach t,$(TARGETS_C_32BIT_ALL),$(eval $(call gen-target-rule-32,$(t))))\nendif\n\nifeq ($(CAN_BUILD_X86_64),1)\nall: all_64\nTEST_PROGS += $(BINARIES_64)\nEXTRA_CFLAGS += -DCAN_BUILD_64\n$(foreach t,$(TARGETS_C_64BIT_ALL),$(eval $(call gen-target-rule-64,$(t))))\nendif\n\nall_32: $(BINARIES_32)\n\nall_64: $(BINARIES_64)\n\nEXTRA_CLEAN := $(BINARIES_32) $(BINARIES_64)\n\n$(BINARIES_32): $(OUTPUT)/%_32: %.c helpers.h\n\t$(CC) -m32 -o $@ $(CFLAGS) $(EXTRA_CFLAGS) $^ -lrt -ldl -lm\n\n$(BINARIES_64): $(OUTPUT)/%_64: %.c helpers.h\n\t$(CC) -m64 -o $@ $(CFLAGS) $(EXTRA_CFLAGS) $^ -lrt -ldl\n\n# x86_64 users should be encouraged to install 32-bit libraries\nifeq ($(CAN_BUILD_I386)$(CAN_BUILD_X86_64),01)\nall: warn_32bit_failure\n\nwarn_32bit_failure:\n\t@echo \"Warning: you seem to have a broken 32-bit build\" 2>&1; \t\\\n\techo \"environment.  This will reduce test coverage of 64-bit\" 2>&1; \\\n\techo \"kernels.  If you are using a Debian-like distribution,\" 2>&1; \\\n\techo \"try:\"; 2>&1; \\\n\techo \"\";\t\t\t\t\t\t\t\\\n\techo \"  apt-get install gcc-multilib libc6-i386 libc6-dev-i386\"; \\\n\techo \"\";\t\t\t\t\t\t\t\\\n\techo \"If you are using a Fedora-like distribution, try:\";\t\\\n\techo \"\";\t\t\t\t\t\t\t\\\n\techo \"  yum install glibc-devel.*i686\";\t\t\t\t\\\n\techo \"\";\t\t\t\t\t\t\t\\\n\techo \"If you are using a SUSE-like distribution, try:\";\t\t\\\n\techo \"\";\t\t\t\t\t\t\t\\\n\techo \"  zypper install gcc-32bit glibc-devel-static-32bit\";\t\\\n\texit 0;\nendif\n\n# Some tests have additional dependencies.\n$(OUTPUT)/sysret_ss_attrs_64: thunks.S\n$(OUTPUT)/ptrace_syscall_32: raw_syscall_helper_32.S\n$(OUTPUT)/test_syscall_vdso_32: thunks_32.S\n\n# check_initial_reg_state is special: it needs a custom entry, and it\n# needs to be static so that its interpreter doesn't destroy its initial\n# state.\n$(OUTPUT)/check_initial_reg_state_32: CFLAGS += -Wl,-ereal_start -static\n$(OUTPUT)/check_initial_reg_state_64: CFLAGS += -Wl,-ereal_start -static\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}