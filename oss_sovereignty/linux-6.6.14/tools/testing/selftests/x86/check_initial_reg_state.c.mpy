{
  "module_name": "check_initial_reg_state.c",
  "hash_id": "b5b94027b10e10804bb77501db94d7b88aab588b4492be909cec5b289a8c6ec8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/x86/check_initial_reg_state.c",
  "human_readable_source": "\n \n\n#define _GNU_SOURCE\n\n#include <stdio.h>\n\nunsigned long ax, bx, cx, dx, si, di, bp, sp, flags;\nunsigned long r8, r9, r10, r11, r12, r13, r14, r15;\n\nasm (\n\t\".pushsection .text\\n\\t\"\n\t\".type real_start, @function\\n\\t\"\n\t\".global real_start\\n\\t\"\n\t\"real_start:\\n\\t\"\n#ifdef __x86_64__\n\t\"mov %rax, ax\\n\\t\"\n\t\"mov %rbx, bx\\n\\t\"\n\t\"mov %rcx, cx\\n\\t\"\n\t\"mov %rdx, dx\\n\\t\"\n\t\"mov %rsi, si\\n\\t\"\n\t\"mov %rdi, di\\n\\t\"\n\t\"mov %rbp, bp\\n\\t\"\n\t\"mov %rsp, sp\\n\\t\"\n\t\"mov %r8, r8\\n\\t\"\n\t\"mov %r9, r9\\n\\t\"\n\t\"mov %r10, r10\\n\\t\"\n\t\"mov %r11, r11\\n\\t\"\n\t\"mov %r12, r12\\n\\t\"\n\t\"mov %r13, r13\\n\\t\"\n\t\"mov %r14, r14\\n\\t\"\n\t\"mov %r15, r15\\n\\t\"\n\t\"pushfq\\n\\t\"\n\t\"popq flags\\n\\t\"\n#else\n\t\"mov %eax, ax\\n\\t\"\n\t\"mov %ebx, bx\\n\\t\"\n\t\"mov %ecx, cx\\n\\t\"\n\t\"mov %edx, dx\\n\\t\"\n\t\"mov %esi, si\\n\\t\"\n\t\"mov %edi, di\\n\\t\"\n\t\"mov %ebp, bp\\n\\t\"\n\t\"mov %esp, sp\\n\\t\"\n\t\"pushfl\\n\\t\"\n\t\"popl flags\\n\\t\"\n#endif\n\t\"jmp _start\\n\\t\"\n\t\".size real_start, . - real_start\\n\\t\"\n\t\".popsection\");\n\nint main()\n{\n\tint nerrs = 0;\n\n\tif (sp == 0) {\n\t\tprintf(\"[FAIL]\\tTest was built incorrectly\\n\");\n\t\treturn 1;\n\t}\n\n\tif (ax || bx || cx || dx || si || di || bp\n#ifdef __x86_64__\n\t    || r8 || r9 || r10 || r11 || r12 || r13 || r14 || r15\n#endif\n\t\t) {\n\t\tprintf(\"[FAIL]\\tAll GPRs except SP should be 0\\n\");\n#define SHOW(x) printf(\"\\t\" #x \" = 0x%lx\\n\", x);\n\t\tSHOW(ax);\n\t\tSHOW(bx);\n\t\tSHOW(cx);\n\t\tSHOW(dx);\n\t\tSHOW(si);\n\t\tSHOW(di);\n\t\tSHOW(bp);\n\t\tSHOW(sp);\n#ifdef __x86_64__\n\t\tSHOW(r8);\n\t\tSHOW(r9);\n\t\tSHOW(r10);\n\t\tSHOW(r11);\n\t\tSHOW(r12);\n\t\tSHOW(r13);\n\t\tSHOW(r14);\n\t\tSHOW(r15);\n#endif\n\t\tnerrs++;\n\t} else {\n\t\tprintf(\"[OK]\\tAll GPRs except SP are 0\\n\");\n\t}\n\n\tif (flags != 0x202) {\n\t\tprintf(\"[FAIL]\\tFLAGS is 0x%lx, but it should be 0x202\\n\", flags);\n\t\tnerrs++;\n\t} else {\n\t\tprintf(\"[OK]\\tFLAGS is 0x202\\n\");\n\t}\n\n\treturn nerrs ? 1 : 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}