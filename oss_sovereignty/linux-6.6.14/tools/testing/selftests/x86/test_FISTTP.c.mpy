{
  "module_name": "test_FISTTP.c",
  "hash_id": "e8b9a003d81182a9794321ec088706e8348a95a912730b45cd317a5140f7a9c0",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/x86/test_FISTTP.c",
  "human_readable_source": "\n#undef _GNU_SOURCE\n#define _GNU_SOURCE 1\n#undef __USE_GNU\n#define __USE_GNU 1\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n#include <signal.h>\n#include <sys/types.h>\n#include <sys/select.h>\n#include <sys/time.h>\n#include <sys/wait.h>\n#include <fenv.h>\n\nunsigned long long res64 = -1;\nunsigned int res32 = -1;\nunsigned short res16 = -1;\n\nint test(void)\n{\n\tint ex;\n\n\tfeclearexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tasm volatile (\"\\n\"\n\t\"\tfld1\"\"\\n\"\n\t\"\tfisttp\tres16\"\"\\n\"\n\t\"\tfld1\"\"\\n\"\n\t\"\tfisttpl\tres32\"\"\\n\"\n\t\"\tfld1\"\"\\n\"\n\t\"\tfisttpll res64\"\"\\n\"\n\t: : : \"memory\"\n\t);\n\tif (res16 != 1 || res32 != 1 || res64 != 1) {\n\t\tprintf(\"[BAD]\\tfisttp 1\\n\");\n\t\treturn 1;\n\t}\n\tex = fetestexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tif (ex != 0) {\n\t\tprintf(\"[BAD]\\tfisttp 1: wrong exception state\\n\");\n\t\treturn 1;\n\t}\n\n\tfeclearexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tasm volatile (\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfisttp\tres16\"\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfisttpl\tres32\"\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfisttpll res64\"\"\\n\"\n\t: : : \"memory\"\n\t);\n\tif (res16 != 3 || res32 != 3 || res64 != 3) {\n\t\tprintf(\"[BAD]\\tfisttp pi\\n\");\n\t\treturn 1;\n\t}\n\tex = fetestexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tif (ex != FE_INEXACT) {\n\t\tprintf(\"[BAD]\\tfisttp pi: wrong exception state\\n\");\n\t\treturn 1;\n\t}\n\n\tfeclearexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tasm volatile (\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfchs\"\"\\n\"\n\t\"\tfisttp\tres16\"\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfchs\"\"\\n\"\n\t\"\tfisttpl\tres32\"\"\\n\"\n\t\"\tfldpi\"\"\\n\"\n\t\"\tfchs\"\"\\n\"\n\t\"\tfisttpll res64\"\"\\n\"\n\t: : : \"memory\"\n\t);\n\tif (res16 != 0xfffd || res32 != 0xfffffffd || res64 != 0xfffffffffffffffdULL) {\n\t\tprintf(\"[BAD]\\tfisttp -pi\\n\");\n\t\treturn 1;\n\t}\n\tex = fetestexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tif (ex != FE_INEXACT) {\n\t\tprintf(\"[BAD]\\tfisttp -pi: wrong exception state\\n\");\n\t\treturn 1;\n\t}\n\n\tfeclearexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tasm volatile (\"\\n\"\n\t\"\tfldln2\"\"\\n\"\n\t\"\tfisttp\tres16\"\"\\n\"\n\t\"\tfldln2\"\"\\n\"\n\t\"\tfisttpl\tres32\"\"\\n\"\n\t\"\tfldln2\"\"\\n\"\n\t\"\tfisttpll res64\"\"\\n\"\n\t: : : \"memory\"\n\t);\n\t \n\tif (res16 != 0 || res32 != 0 || res64 != 0) {\n\t\tprintf(\"[BAD]\\tfisttp ln2\\n\");\n\t\treturn 1;\n\t}\n\tex = fetestexcept(FE_DIVBYZERO|FE_INEXACT|FE_INVALID|FE_OVERFLOW|FE_UNDERFLOW);\n\tif (ex != FE_INEXACT) {\n\t\tprintf(\"[BAD]\\tfisttp ln2: wrong exception state\\n\");\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n\nvoid sighandler(int sig)\n{\n\tprintf(\"[FAIL]\\tGot signal %d, exiting\\n\", sig);\n\texit(1);\n}\n\nint main(int argc, char **argv, char **envp)\n{\n\tint err = 0;\n\n\t \n\tsignal(SIGILL, sighandler);\n\tsignal(SIGFPE, sighandler);\n\tsignal(SIGSEGV, sighandler);\n\n\tprintf(\"[RUN]\\tTesting fisttp instructions\\n\");\n\terr |= test();\n\tif (!err)\n\t\tprintf(\"[OK]\\tfisttp\\n\");\n\telse\n\t\tprintf(\"[FAIL]\\tfisttp errors: %d\\n\", err);\n\n\treturn err;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}