{
  "module_name": "special-tests.sh",
  "hash_id": "6af9d73b9c165a5725af2c95e8fa01f42f883de118b8ec10d2c9b05b1857e4f5",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/cpufreq/special-tests.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n#\n# Special test cases reported by people\n\n# Testcase 1: Reported here: http://marc.info/?l=linux-pm&m=140618592709858&w=2\n\n# protect against multiple inclusion\nif [ $FILE_SPECIAL ]; then\n\treturn 0\nelse\n\tFILE_SPECIAL=DONE\nfi\n\nsource cpu.sh\nsource cpufreq.sh\nsource governor.sh\n\n# Test 1\n# $1: policy\n__simple_lockdep()\n{\n\t# switch to ondemand\n\t__switch_governor $1 \"ondemand\"\n\n\t# cat ondemand files\n\tlocal ondir=$(find_gov_directory $1 \"ondemand\")\n\tif [ -z $ondir ]; then\n\t\tprintf \"${FUNCNAME[0]}Ondemand directory not created, quit\"\n\t\treturn\n\tfi\n\n\tcat $ondir/*\n\n\t# switch to conservative\n\t__switch_governor $1 \"conservative\"\n}\n\nsimple_lockdep()\n{\n\tprintf \"** Test: Running ${FUNCNAME[0]} **\\n\"\n\n\tfor_each_policy __simple_lockdep\n}\n\n# Test 2\n# $1: policy\n__concurrent_lockdep()\n{\n\tfor i in `seq 0 100`; do\n\t\t__simple_lockdep $1\n\tdone\n}\n\nconcurrent_lockdep()\n{\n\tprintf \"** Test: Running ${FUNCNAME[0]} **\\n\"\n\n\tfor_each_policy_concurrent __concurrent_lockdep\n}\n\n# Test 3\nquick_shuffle()\n{\n\t# this is called concurrently from governor_race\n\tfor I in `seq 1000`\n\tdo\n\t\techo ondemand | sudo tee $CPUFREQROOT/policy*/scaling_governor &\n\t\techo userspace | sudo tee $CPUFREQROOT/policy*/scaling_governor &\n\tdone\n}\n\ngovernor_race()\n{\n\tprintf \"** Test: Running ${FUNCNAME[0]} **\\n\"\n\n\t# run 8 concurrent instances\n\tfor I in `seq 8`\n\tdo\n\t\tquick_shuffle &\n\tdone\n}\n\n# Test 4\n# $1: cpu\nhotplug_with_updates_cpu()\n{\n\tlocal filepath=\"$CPUROOT/$1/cpufreq\"\n\n\t# switch to ondemand\n\t__switch_governor_for_cpu $1 \"ondemand\"\n\n\tfor i in `seq 1 5000`\n\tdo\n\t\treboot_cpu $1\n\tdone &\n\n\tlocal freqs=$(cat $filepath/scaling_available_frequencies)\n\tlocal oldfreq=$(cat $filepath/scaling_min_freq)\n\n\tfor j in `seq 1 5000`\n\tdo\n\t\t# Set all frequencies one-by-one\n\t\tfor freq in $freqs; do\n\t\t\techo $freq > $filepath/scaling_min_freq\n\t\tdone\n\tdone\n\n\t# restore old freq\n\techo $oldfreq > $filepath/scaling_min_freq\n}\n\nhotplug_with_updates()\n{\n\tfor_each_non_boot_cpu hotplug_with_updates_cpu\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}