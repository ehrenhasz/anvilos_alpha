{
  "module_name": "sysfs_update_removed_scheme_dir.sh",
  "hash_id": "20f8c44d12a6ed840997c9216b8625fd943611c26cac7131f0fee97ce1f086bd",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/damon/sysfs_update_removed_scheme_dir.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\n# Kselftest framework requirement - SKIP code is 4.\nksft_skip=4\n\nif [ $EUID -ne 0 ]\nthen\n\techo \"Run as root\"\n\texit $ksft_skip\nfi\n\ndamon_sysfs=\"/sys/kernel/mm/damon/admin\"\nif [ ! -d \"$damon_sysfs\" ]\nthen\n\techo \"damon sysfs not found\"\n\texit $ksft_skip\nfi\n\n# clear log\ndmesg -C\n\n# start DAMON with a scheme\necho 1 > \"$damon_sysfs/kdamonds/nr_kdamonds\"\necho 1 > \"$damon_sysfs/kdamonds/0/contexts/nr_contexts\"\necho \"vaddr\" > \"$damon_sysfs/kdamonds/0/contexts/0/operations\"\necho 1 > \"$damon_sysfs/kdamonds/0/contexts/0/targets/nr_targets\"\necho $$ > \"$damon_sysfs/kdamonds/0/contexts/0/targets/0/pid_target\"\necho 1 > \"$damon_sysfs/kdamonds/0/contexts/0/schemes/nr_schemes\"\nscheme_dir=\"$damon_sysfs/kdamonds/0/contexts/0/schemes/0\"\necho 4096000 > \"$scheme_dir/access_pattern/sz/max\"\necho 20 > \"$scheme_dir/access_pattern/nr_accesses/max\"\necho 1024 > \"$scheme_dir/access_pattern/age/max\"\necho \"on\" > \"$damon_sysfs/kdamonds/0/state\"\nsleep 0.3\n\n# remove scheme sysfs dir\necho 0 > \"$damon_sysfs/kdamonds/0/contexts/0/schemes/nr_schemes\"\n\n# try to update stat of already removed scheme sysfs dir\necho \"update_schemes_stats\" > \"$damon_sysfs/kdamonds/0/state\"\nif dmesg | grep -q BUG\nthen\n\techo \"update_schemes_stats triggers a kernel bug\"\n\tdmesg\n\texit 1\nfi\n\n# try to update tried regions of already removed scheme sysfs dir\necho \"update_schemes_tried_regions\" > \"$damon_sysfs/kdamonds/0/state\"\nif dmesg | grep -q BUG\nthen\n\techo \"update_schemes_tried_regions triggers a kernel bug\"\n\tdmesg\n\texit 1\nfi\n\necho \"off\" > \"$damon_sysfs/kdamonds/0/state\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}