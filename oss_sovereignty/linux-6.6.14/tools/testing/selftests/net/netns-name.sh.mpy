{
  "module_name": "netns-name.sh",
  "hash_id": "137f510d03b21603f7c2b5a330075bf1431647c8aa72d39dc9b0baae9d96264c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/netns-name.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\nset -o pipefail\n\nNS=netns-name-test\nDEV=dummy-dev0\nDEV2=dummy-dev1\nALT_NAME=some-alt-name\n\nRET_CODE=0\n\ncleanup() {\n    ip netns del $NS\n}\n\ntrap cleanup EXIT\n\nfail() {\n    echo \"ERROR: ${1:-unexpected return code} (ret: $_)\" >&2\n    RET_CODE=1\n}\n\nip netns add $NS\n\n#\n# Test basic move without a rename\n#\nip -netns $NS link add name $DEV type dummy || fail\nip -netns $NS link set dev $DEV netns 1 ||\n    fail \"Can't perform a netns move\"\nip link show dev $DEV >> /dev/null || fail \"Device not found after move\"\nip link del $DEV || fail\n\n#\n# Test move with a conflict\n#\nip link add name $DEV type dummy\nip -netns $NS link add name $DEV type dummy || fail\nip -netns $NS link set dev $DEV netns 1 2> /dev/null &&\n    fail \"Performed a netns move with a name conflict\"\nip link show dev $DEV >> /dev/null || fail \"Device not found after move\"\nip -netns $NS link del $DEV || fail\nip link del $DEV || fail\n\n#\n# Test move with a conflict and rename\n#\nip link add name $DEV type dummy\nip -netns $NS link add name $DEV type dummy || fail\nip -netns $NS link set dev $DEV netns 1 name $DEV2 ||\n    fail \"Can't perform a netns move with rename\"\nip link del $DEV2 || fail\nip link del $DEV || fail\n\n#\n# Test dup alt-name with netns move\n#\nip link add name $DEV type dummy || fail\nip link property add dev $DEV altname $ALT_NAME || fail\nip -netns $NS link add name $DEV2 type dummy || fail\nip -netns $NS link property add dev $DEV2 altname $ALT_NAME || fail\n\nip -netns $NS link set dev $DEV2 netns 1 2> /dev/null &&\n    fail \"Moved with alt-name dup\"\n\nip link del $DEV || fail\nip -netns $NS link del $DEV2 || fail\n\n#\n# Test creating alt-name in one net-ns and using in another\n#\nip -netns $NS link add name $DEV type dummy || fail\nip -netns $NS link property add dev $DEV altname $ALT_NAME || fail\nip -netns $NS link set dev $DEV netns 1 || fail\nip link show dev $ALT_NAME >> /dev/null || fail \"Can't find alt-name after move\"\nip  -netns $NS link show dev $ALT_NAME 2> /dev/null &&\n    fail \"Can still find alt-name after move\"\nip link del $DEV || fail\n\necho -ne \"$(basename $0) \\t\\t\\t\\t\"\nif [ $RET_CODE -eq 0 ]; then\n    echo \"[  OK  ]\"\nelse\n    echo \"[ FAIL ]\"\nfi\nexit $RET_CODE\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}