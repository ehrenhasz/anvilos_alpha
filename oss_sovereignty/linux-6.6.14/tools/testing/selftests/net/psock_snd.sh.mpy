{
  "module_name": "psock_snd.sh",
  "hash_id": "b6e3fdc3cc4d1b3abbbea10963d8bcc48914b193011584e1d8b044954999ce7b",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/psock_snd.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n#\n# Run a series of packet socket send regression tests\n\nset -e\n\nreadonly mtu=1500\nreadonly iphlen=20\nreadonly udphlen=8\n\nreadonly vnet_hlen=10\nreadonly eth_hlen=14\n\nreadonly mss=\"$((${mtu} - ${iphlen} - ${udphlen}))\"\nreadonly mss_exceeds=\"$((${mss} + 1))\"\n\nreadonly max_mtu=65535\nreadonly max_mss=\"$((${max_mtu} - ${iphlen} - ${udphlen}))\"\nreadonly max_mss_exceeds=\"$((${max_mss} + 1))\"\n\n# functional checks (not a full cross-product)\n\necho \"dgram\"\n./in_netns.sh ./psock_snd -d\n\necho \"dgram bind\"\n./in_netns.sh ./psock_snd -d -b\n\necho \"raw\"\n./in_netns.sh ./psock_snd\n\necho \"raw bind\"\n./in_netns.sh ./psock_snd -b\n\necho \"raw qdisc bypass\"\n./in_netns.sh ./psock_snd -q\n\necho \"raw vlan\"\n./in_netns.sh ./psock_snd -V\n\necho \"raw vnet hdr\"\n./in_netns.sh ./psock_snd -v\n\necho \"raw csum_off\"\n./in_netns.sh ./psock_snd -v -c\n\necho \"raw csum_off with bad offset (expected to fail)\"\n(! ./in_netns.sh ./psock_snd -v -c -C)\n\n\n# bounds check: send {max, max + 1, min, min - 1} lengths\n\necho \"raw min size\"\n./in_netns.sh ./psock_snd -l 0\n\necho \"raw mtu size\"\n./in_netns.sh ./psock_snd -l \"${mss}\"\n\necho \"raw mtu size + 1 (expected to fail)\"\n(! ./in_netns.sh ./psock_snd -l \"${mss_exceeds}\")\n\n# fails due to ARPHRD_ETHER check in packet_extra_vlan_len_allowed\n#\n# echo \"raw vlan mtu size\"\n# ./in_netns.sh ./psock_snd -V -l \"${mss}\"\n\necho \"raw vlan mtu size + 1 (expected to fail)\"\n(! ./in_netns.sh ./psock_snd -V -l \"${mss_exceeds}\")\n\necho \"dgram mtu size\"\n./in_netns.sh ./psock_snd -d -l \"${mss}\"\n\necho \"dgram mtu size + 1 (expected to fail)\"\n(! ./in_netns.sh ./psock_snd -d -l \"${mss_exceeds}\")\n\necho \"raw truncate hlen (expected to fail: does not arrive)\"\n(! ./in_netns.sh ./psock_snd -t \"$((${vnet_hlen} + ${eth_hlen}))\")\n\necho \"raw truncate hlen - 1 (expected to fail: EINVAL)\"\n(! ./in_netns.sh ./psock_snd -t \"$((${vnet_hlen} + ${eth_hlen} - 1))\")\n\n\n# gso checks: implies -l, because with gso len must exceed gso_size\n\necho \"raw gso min size\"\n./in_netns.sh ./psock_snd -v -c -g -l \"${mss_exceeds}\"\n\necho \"raw gso max size\"\n./in_netns.sh ./psock_snd -v -c -g -l \"${max_mss}\"\n\necho \"raw gso max size + 1 (expected to fail)\"\n(! ./in_netns.sh ./psock_snd -v -c -g -l \"${max_mss_exceeds}\")\n\necho \"OK. All tests passed\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}