{
  "module_name": "so_txtime.sh",
  "hash_id": "fe2855bc03626ce18376d85c89a9fe70f517f570075fcc0297dc0411c7ccd289",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/so_txtime.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n#\n# Regression tests for the SO_TXTIME interface\n\nset -e\n\nreadonly DEV=\"veth0\"\nreadonly BIN=\"./so_txtime\"\n\nreadonly RAND=\"$(mktemp -u XXXXXX)\"\nreadonly NSPREFIX=\"ns-${RAND}\"\nreadonly NS1=\"${NSPREFIX}1\"\nreadonly NS2=\"${NSPREFIX}2\"\n\nreadonly SADDR4='192.168.1.1'\nreadonly DADDR4='192.168.1.2'\nreadonly SADDR6='fd::1'\nreadonly DADDR6='fd::2'\n\ncleanup() {\n\tip netns del \"${NS2}\"\n\tip netns del \"${NS1}\"\n}\n\ntrap cleanup EXIT\n\n# Create virtual ethernet pair between network namespaces\nip netns add \"${NS1}\"\nip netns add \"${NS2}\"\n\nip link add \"${DEV}\" netns \"${NS1}\" type veth \\\n  peer name \"${DEV}\" netns \"${NS2}\"\n\n# Bring the devices up\nip -netns \"${NS1}\" link set \"${DEV}\" up\nip -netns \"${NS2}\" link set \"${DEV}\" up\n\n# Set fixed MAC addresses on the devices\nip -netns \"${NS1}\" link set dev \"${DEV}\" address 02:02:02:02:02:02\nip -netns \"${NS2}\" link set dev \"${DEV}\" address 06:06:06:06:06:06\n\n# Add fixed IP addresses to the devices\nip -netns \"${NS1}\" addr add 192.168.1.1/24 dev \"${DEV}\"\nip -netns \"${NS2}\" addr add 192.168.1.2/24 dev \"${DEV}\"\nip -netns \"${NS1}\" addr add       fd::1/64 dev \"${DEV}\" nodad\nip -netns \"${NS2}\" addr add       fd::2/64 dev \"${DEV}\" nodad\n\ndo_test() {\n\tlocal readonly IP=\"$1\"\n\tlocal readonly CLOCK=\"$2\"\n\tlocal readonly TXARGS=\"$3\"\n\tlocal readonly RXARGS=\"$4\"\n\n\tif [[ \"${IP}\" == \"4\" ]]; then\n\t\tlocal readonly SADDR=\"${SADDR4}\"\n\t\tlocal readonly DADDR=\"${DADDR4}\"\n\telif [[ \"${IP}\" == \"6\" ]]; then\n\t\tlocal readonly SADDR=\"${SADDR6}\"\n\t\tlocal readonly DADDR=\"${DADDR6}\"\n\telse\n\t\techo \"Invalid IP version ${IP}\"\n\t\texit 1\n\tfi\n\n\tlocal readonly START=\"$(date +%s%N --date=\"+ 0.1 seconds\")\"\n\tip netns exec \"${NS2}\" \"${BIN}\" -\"${IP}\" -c \"${CLOCK}\" -t \"${START}\" -S \"${SADDR}\" -D \"${DADDR}\" \"${RXARGS}\" -r &\n\tip netns exec \"${NS1}\" \"${BIN}\" -\"${IP}\" -c \"${CLOCK}\" -t \"${START}\" -S \"${SADDR}\" -D \"${DADDR}\" \"${TXARGS}\"\n\twait \"$!\"\n}\n\nip netns exec \"${NS1}\" tc qdisc add dev \"${DEV}\" root fq\ndo_test 4 mono a,-1 a,-1\ndo_test 6 mono a,0 a,0\ndo_test 6 mono a,10 a,10\ndo_test 4 mono a,10,b,20 a,10,b,20\ndo_test 6 mono a,20,b,10 b,20,a,20\n\nif ip netns exec \"${NS1}\" tc qdisc replace dev \"${DEV}\" root etf clockid CLOCK_TAI delta 400000; then\n\t! do_test 4 tai a,-1 a,-1\n\t! do_test 6 tai a,0 a,0\n\tdo_test 6 tai a,10 a,10\n\tdo_test 4 tai a,10,b,20 a,10,b,20\n\tdo_test 6 tai a,20,b,10 b,10,a,20\nelse\n\techo \"tc ($(tc -V)) does not support qdisc etf. skipping\"\nfi\n\necho OK. All tests passed\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}