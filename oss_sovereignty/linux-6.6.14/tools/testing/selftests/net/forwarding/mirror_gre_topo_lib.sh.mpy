{
  "module_name": "mirror_gre_topo_lib.sh",
  "hash_id": "8b4457e36fe1a62b870e9cd2ad510e45e962f214156753567fcb2f089b4f000c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/forwarding/mirror_gre_topo_lib.sh",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\n\n# This is the standard topology for testing mirroring to gretap and ip6gretap\n# netdevices. The tests that use it tweak it in one way or another--importantly,\n# $swp3 and $h3 need to have addresses set up.\n#\n#   +---------------------+                             +---------------------+\n#   | H1                  |                             |                  H2 |\n#   |     + $h1           |                             |           $h2 +     |\n#   |     | 192.0.2.1/28  |                             |  192.0.2.2/28 |     |\n#   +-----|---------------+                             +---------------|-----+\n#         |                                                             |\n#   +-----|-------------------------------------------------------------|-----+\n#   | SW  o--> mirror                                                   |     |\n#   | +---|-------------------------------------------------------------|---+ |\n#   | |   + $swp1                    BR                           $swp2 +   | |\n#   | +---------------------------------------------------------------------+ |\n#   |                                                                         |\n#   |     + $swp3               + gt6 (ip6gretap)      + gt4 (gretap)         |\n#   |     |                     : loc=2001:db8:2::1    : loc=192.0.2.129      |\n#   |     |                     : rem=2001:db8:2::2    : rem=192.0.2.130      |\n#   |     |                     : ttl=100              : ttl=100              |\n#   |     |                     : tos=inherit          : tos=inherit          |\n#   |     |                     :                      :                      |\n#   +-----|---------------------:----------------------:----------------------+\n#         |                     :                      :\n#   +-----|---------------------:----------------------:----------------------+\n#   | H3  + $h3                 + h3-gt6 (ip6gretap)   + h3-gt4 (gretap)      |\n#   |                             loc=2001:db8:2::2      loc=192.0.2.130      |\n#   |                             rem=2001:db8:2::1      rem=192.0.2.129      |\n#   |                             ttl=100                ttl=100              |\n#   |                             tos=inherit            tos=inherit          |\n#   |                                                                         |\n#   +-------------------------------------------------------------------------+\n\nsource \"$relative_path/mirror_topo_lib.sh\"\n\nmirror_gre_topo_h3_create()\n{\n\tmirror_topo_h3_create\n\n\ttunnel_create h3-gt4 gretap 192.0.2.130 192.0.2.129\n\tip link set h3-gt4 vrf v$h3\n\tmatchall_sink_create h3-gt4\n\n\ttunnel_create h3-gt6 ip6gretap 2001:db8:2::2 2001:db8:2::1\n\tip link set h3-gt6 vrf v$h3\n\tmatchall_sink_create h3-gt6\n}\n\nmirror_gre_topo_h3_destroy()\n{\n\ttunnel_destroy h3-gt6\n\ttunnel_destroy h3-gt4\n\n\tmirror_topo_h3_destroy\n}\n\nmirror_gre_topo_switch_create()\n{\n\tmirror_topo_switch_create\n\n\ttunnel_create gt4 gretap 192.0.2.129 192.0.2.130 \\\n\t\t      ttl 100 tos inherit\n\n\ttunnel_create gt6 ip6gretap 2001:db8:2::1 2001:db8:2::2 \\\n\t\t      ttl 100 tos inherit allow-localremote\n}\n\nmirror_gre_topo_switch_destroy()\n{\n\ttunnel_destroy gt6\n\ttunnel_destroy gt4\n\n\tmirror_topo_switch_destroy\n}\n\nmirror_gre_topo_create()\n{\n\tmirror_topo_h1_create\n\tmirror_topo_h2_create\n\tmirror_gre_topo_h3_create\n\n\tmirror_gre_topo_switch_create\n}\n\nmirror_gre_topo_destroy()\n{\n\tmirror_gre_topo_switch_destroy\n\n\tmirror_gre_topo_h3_destroy\n\tmirror_topo_h2_destroy\n\tmirror_topo_h1_destroy\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}