{
  "module_name": "mirror_gre_lib.sh",
  "hash_id": "bee0794dfb4113284cc88395846faf8bb702f7c6ca52ac8586316a93fad1faa9",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/forwarding/mirror_gre_lib.sh",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\n\nsource \"$relative_path/mirror_lib.sh\"\n\nquick_test_span_gre_dir_ips()\n{\n\tlocal tundev=$1; shift\n\n\tdo_test_span_dir_ips 10 h3-$tundev \"$@\"\n}\n\nfail_test_span_gre_dir_ips()\n{\n\tlocal tundev=$1; shift\n\n\tdo_test_span_dir_ips 0 h3-$tundev \"$@\"\n}\n\ntest_span_gre_dir_ips()\n{\n\tlocal tundev=$1; shift\n\n\ttest_span_dir_ips h3-$tundev \"$@\"\n}\n\nfull_test_span_gre_dir_ips()\n{\n\tlocal tundev=$1; shift\n\tlocal direction=$1; shift\n\tlocal forward_type=$1; shift\n\tlocal backward_type=$1; shift\n\tlocal what=$1; shift\n\tlocal ip1=$1; shift\n\tlocal ip2=$1; shift\n\n\tRET=0\n\n\tmirror_install $swp1 $direction $tundev \"matchall $tcflags\"\n\ttest_span_dir_ips \"h3-$tundev\" \"$direction\" \"$forward_type\" \\\n\t\t\t  \"$backward_type\" \"$ip1\" \"$ip2\"\n\tmirror_uninstall $swp1 $direction\n\n\tlog_test \"$direction $what ($tcflags)\"\n}\n\nfull_test_span_gre_dir_vlan_ips()\n{\n\tlocal tundev=$1; shift\n\tlocal direction=$1; shift\n\tlocal vlan_match=$1; shift\n\tlocal forward_type=$1; shift\n\tlocal backward_type=$1; shift\n\tlocal what=$1; shift\n\tlocal ip1=$1; shift\n\tlocal ip2=$1; shift\n\n\tRET=0\n\n\tmirror_install $swp1 $direction $tundev \"matchall $tcflags\"\n\n\ttest_span_dir_ips \"h3-$tundev\" \"$direction\" \"$forward_type\" \\\n\t\t\t  \"$backward_type\" \"$ip1\" \"$ip2\"\n\n\ttc filter add dev $h3 ingress pref 77 prot 802.1q \\\n\t\tflower $vlan_match \\\n\t\taction pass\n\tmirror_test v$h1 $ip1 $ip2 $h3 77 10\n\ttc filter del dev $h3 ingress pref 77\n\n\tmirror_uninstall $swp1 $direction\n\n\tlog_test \"$direction $what ($tcflags)\"\n}\n\nquick_test_span_gre_dir()\n{\n\tquick_test_span_gre_dir_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n\nfail_test_span_gre_dir()\n{\n\tfail_test_span_gre_dir_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n\ntest_span_gre_dir()\n{\n\ttest_span_gre_dir_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n\nfull_test_span_gre_dir()\n{\n\tfull_test_span_gre_dir_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n\nfull_test_span_gre_dir_vlan()\n{\n\tfull_test_span_gre_dir_vlan_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n\nfull_test_span_gre_stp_ips()\n{\n\tlocal tundev=$1; shift\n\tlocal nbpdev=$1; shift\n\tlocal what=$1; shift\n\tlocal ip1=$1; shift\n\tlocal ip2=$1; shift\n\tlocal h3mac=$(mac_get $h3)\n\n\tRET=0\n\n\tmirror_install $swp1 ingress $tundev \"matchall $tcflags\"\n\tquick_test_span_gre_dir_ips $tundev ingress $ip1 $ip2\n\n\tbridge link set dev $nbpdev state disabled\n\tsleep 1\n\tfail_test_span_gre_dir_ips $tundev ingress $ip1 $ip2\n\n\tbridge link set dev $nbpdev state forwarding\n\tsleep 1\n\tquick_test_span_gre_dir_ips $tundev ingress $ip1 $ip2\n\n\tmirror_uninstall $swp1 ingress\n\n\tlog_test \"$what: STP state ($tcflags)\"\n}\n\nfull_test_span_gre_stp()\n{\n\tfull_test_span_gre_stp_ips \"$@\" 192.0.2.1 192.0.2.2\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}