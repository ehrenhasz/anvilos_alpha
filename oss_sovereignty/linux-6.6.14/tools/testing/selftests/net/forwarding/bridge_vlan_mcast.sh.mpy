{
  "module_name": "bridge_vlan_mcast.sh",
  "hash_id": "9285c13affd05c2475c6a5fd3d087ca292de5f4489d02e46b81b192661d73e50",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/forwarding/bridge_vlan_mcast.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\nALL_TESTS=\"vlmc_control_test vlmc_querier_test vlmc_igmp_mld_version_test \\\n\t   vlmc_last_member_test vlmc_startup_query_test vlmc_membership_test \\\n\t   vlmc_querier_intvl_test vlmc_query_intvl_test vlmc_query_response_intvl_test \\\n\t   vlmc_router_port_test vlmc_filtering_test\"\nNUM_NETIFS=4\nCHECK_TC=\"yes\"\nTEST_GROUP=\"239.10.10.10\"\n\nsource lib.sh\n\nh1_create()\n{\n\tsimple_if_init $h1 192.0.2.1/24 2001:db8:1::1/64\n\tip link add l $h1 $h1.10 up type vlan id 10\n}\n\nh1_destroy()\n{\n\tip link del $h1.10\n\tsimple_if_fini $h1 192.0.2.1/24 2001:db8:1::1/64\n}\n\nh2_create()\n{\n\tsimple_if_init $h2 192.0.2.2/24 2001:db8:1::2/64\n\tip link add l $h2 $h2.10 up type vlan id 10\n}\n\nh2_destroy()\n{\n\tip link del $h2.10\n\tsimple_if_fini $h2 192.0.2.2/24 2001:db8:1::2/64\n}\n\nswitch_create()\n{\n\tip link add dev br0 type bridge mcast_snooping 1 mcast_querier 1 vlan_filtering 1\n\n\tip link set dev $swp1 master br0\n\tip link set dev $swp2 master br0\n\n\tip link set dev br0 up\n\tip link set dev $swp1 up\n\tip link set dev $swp2 up\n\n\ttc qdisc add dev $swp1 clsact\n\ttc qdisc add dev $swp2 clsact\n\n\tbridge vlan add vid 10-11 dev $swp1 master\n\tbridge vlan add vid 10-11 dev $swp2 master\n\n\tip link set dev br0 type bridge mcast_vlan_snooping 1\n\tcheck_err $? \"Could not enable global vlan multicast snooping\"\n\tlog_test \"Vlan multicast snooping enable\"\n}\n\nswitch_destroy()\n{\n\ttc qdisc del dev $swp2 clsact\n\ttc qdisc del dev $swp1 clsact\n\n\tip link set dev $swp2 down\n\tip link set dev $swp1 down\n\n\tip link del dev br0\n}\n\nsetup_prepare()\n{\n\th1=${NETIFS[p1]}\n\tswp1=${NETIFS[p2]}\n\n\tswp2=${NETIFS[p3]}\n\th2=${NETIFS[p4]}\n\n\tvrf_prepare\n\n\th1_create\n\th2_create\n\n\tswitch_create\n}\n\ncleanup()\n{\n\tpre_cleanup\n\n\tswitch_destroy\n\n\th2_destroy\n\th1_destroy\n\n\tvrf_cleanup\n}\n\nvlmc_v2join_test()\n{\n\tlocal expect=$1\n\n\tRET=0\n\tip address add dev $h2.10 $TEST_GROUP/32 autojoin\n\tcheck_err $? \"Could not join $TEST_GROUP\"\n\n\tsleep 5\n\tbridge -j mdb show dev br0 |\n\t\tjq -e \".[].mdb[] | select(.grp == \\\"$TEST_GROUP\\\" and .vid == 10)\" &>/dev/null\n\tif [ $expect -eq 0 ]; then\n\t\tcheck_err $? \"IGMPv2 report didn't create mdb entry for $TEST_GROUP\"\n\telse\n\t\tcheck_fail $? \"IGMPv2 report shouldn't have created mdb entry for $TEST_GROUP\"\n\tfi\n\n\t# check if we need to cleanup\n\tif [ $RET -eq 0 ]; then\n\t\tip address del dev $h2.10 $TEST_GROUP/32 2>&1 1>/dev/null\n\t\tsleep 5\n\t\tbridge -j mdb show dev br0 |\n\t\t\tjq -e \".[].mdb[] | select(.grp == \\\"$TEST_GROUP\\\" and \\\n\t\t\t\t\t\t  .vid == 10)\" &>/dev/null\n\t\tcheck_fail $? \"IGMPv2 leave didn't remove mdb entry for $TEST_GROUP\"\n\tfi\n}\n\nvlmc_control_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\tlog_test \"Vlan global options existence\"\n\n\tRET=0\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and .mcast_snooping == 1) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_snooping global option value\"\n\tlog_test \"Vlan mcast_snooping global option default value\"\n\n\tRET=0\n\tvlmc_v2join_test 0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 0\n\tcheck_err $? \"Could not disable multicast snooping in vlan 10\"\n\tvlmc_v2join_test 1\n\tlog_test \"Vlan 10 multicast snooping control\"\n}\n\n# setup for general query counting\nvlmc_query_cnt_xstats()\n{\n\tlocal type=$1\n\tlocal version=$2\n\tlocal dev=$3\n\n\tip -j link xstats type bridge_slave dev $dev | \\\n\tjq -e \".[].multicast.${type}_queries.tx_v${version}\"\n}\n\nvlmc_query_cnt_setup()\n{\n\tlocal type=$1\n\tlocal dev=$2\n\n\tif [[ $type == \"igmp\" ]]; then\n\t\ttc filter add dev $dev egress pref 10 prot 802.1Q \\\n\t\t\tflower vlan_id 10 vlan_ethtype ipv4 dst_ip 224.0.0.1 ip_proto 2 \\\n\t\t\taction pass\n\telse\n\t\ttc filter add dev $dev egress pref 10 prot 802.1Q \\\n\t\t\tflower vlan_id 10 vlan_ethtype ipv6 dst_ip ff02::1 ip_proto icmpv6 \\\n\t\t\taction pass\n\tfi\n\n\tip link set dev br0 type bridge mcast_stats_enabled 1\n}\n\nvlmc_query_cnt_cleanup()\n{\n\tlocal dev=$1\n\n\tip link set dev br0 type bridge mcast_stats_enabled 0\n\ttc filter del dev $dev egress pref 10\n}\n\nvlmc_check_query()\n{\n\tlocal type=$1\n\tlocal version=$2\n\tlocal dev=$3\n\tlocal expect=$4\n\tlocal time=$5\n\tlocal ret=0\n\n\tvlmc_query_cnt_setup $type $dev\n\n\tlocal pre_tx_xstats=$(vlmc_query_cnt_xstats $type $version $dev)\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier 1\n\tret=$?\n\tif [[ $ret -eq 0 ]]; then\n\t\tsleep $time\n\n\t\tlocal tcstats=$(tc_rule_stats_get $dev 10 egress)\n\t\tlocal post_tx_xstats=$(vlmc_query_cnt_xstats $type $version $dev)\n\n\t\tif [[ $tcstats != $expect || \\\n\t\t      $(($post_tx_xstats-$pre_tx_xstats)) != $expect || \\\n\t\t      $tcstats != $(($post_tx_xstats-$pre_tx_xstats)) ]]; then\n\t\t\tret=1\n\t\tfi\n\tfi\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier 0\n\tvlmc_query_cnt_cleanup $dev\n\n\treturn $ret\n}\n\nvlmc_querier_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and .mcast_querier == 0) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_querier global vlan option value\"\n\tlog_test \"Vlan mcast_querier global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier 1\n\tcheck_err $? \"Could not enable querier in vlan 10\"\n\tlog_test \"Vlan 10 multicast querier enable\"\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier 0\n\n\tRET=0\n\tvlmc_check_query igmp 2 $swp1 1 1\n\tcheck_err $? \"No vlan tagged IGMPv2 general query packets sent\"\n\tlog_test \"Vlan 10 tagged IGMPv2 general query sent\"\n\n\tRET=0\n\tvlmc_check_query mld 1 $swp1 1 1\n\tcheck_err $? \"No vlan tagged MLD general query packets sent\"\n\tlog_test \"Vlan 10 tagged MLD general query sent\"\n}\n\nvlmc_igmp_mld_version_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and .mcast_igmp_version == 2) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_igmp_version global vlan option value\"\n\tlog_test \"Vlan mcast_igmp_version global option default value\"\n\n\tRET=0\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and .mcast_mld_version == 1) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_mld_version global vlan option value\"\n\tlog_test \"Vlan mcast_mld_version global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_igmp_version 3\n\tcheck_err $? \"Could not set mcast_igmp_version in vlan 10\"\n\tlog_test \"Vlan 10 mcast_igmp_version option changed to 3\"\n\n\tRET=0\n\tvlmc_check_query igmp 3 $swp1 1 1\n\tcheck_err $? \"No vlan tagged IGMPv3 general query packets sent\"\n\tlog_test \"Vlan 10 tagged IGMPv3 general query sent\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_mld_version 2\n\tcheck_err $? \"Could not set mcast_mld_version in vlan 10\"\n\tlog_test \"Vlan 10 mcast_mld_version option changed to 2\"\n\n\tRET=0\n\tvlmc_check_query mld 2 $swp1 1 1\n\tcheck_err $? \"No vlan tagged MLDv2 general query packets sent\"\n\tlog_test \"Vlan 10 tagged MLDv2 general query sent\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_igmp_version 2\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_mld_version 1\n}\n\nvlmc_last_member_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_last_member_count == 2) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_last_member_count global vlan option value\"\n\tlog_test \"Vlan mcast_last_member_count global option default value\"\n\n\tRET=0\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_last_member_interval == 100) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_last_member_interval global vlan option value\"\n\tlog_test \"Vlan mcast_last_member_interval global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_last_member_count 3\n\tcheck_err $? \"Could not set mcast_last_member_count in vlan 10\"\n\tlog_test \"Vlan 10 mcast_last_member_count option changed to 3\"\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_last_member_count 2\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_last_member_interval 200\n\tcheck_err $? \"Could not set mcast_last_member_interval in vlan 10\"\n\tlog_test \"Vlan 10 mcast_last_member_interval option changed to 200\"\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_last_member_interval 100\n}\n\nvlmc_startup_query_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_startup_query_interval == 3125) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_startup_query_interval global vlan option value\"\n\tlog_test \"Vlan mcast_startup_query_interval global option default value\"\n\n\tRET=0\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_startup_query_count == 2) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_startup_query_count global vlan option value\"\n\tlog_test \"Vlan mcast_startup_query_count global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_interval 100\n\tcheck_err $? \"Could not set mcast_startup_query_interval in vlan 10\"\n\tvlmc_check_query igmp 2 $swp1 2 3\n\tcheck_err $? \"Wrong number of tagged IGMPv2 general queries sent\"\n\tlog_test \"Vlan 10 mcast_startup_query_interval option changed to 100\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_count 3\n\tcheck_err $? \"Could not set mcast_startup_query_count in vlan 10\"\n\tvlmc_check_query igmp 2 $swp1 3 4\n\tcheck_err $? \"Wrong number of tagged IGMPv2 general queries sent\"\n\tlog_test \"Vlan 10 mcast_startup_query_count option changed to 3\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_interval 3125\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_count 2\n}\n\nvlmc_membership_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_membership_interval == 26000) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_membership_interval global vlan option value\"\n\tlog_test \"Vlan mcast_membership_interval global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_membership_interval 200\n\tcheck_err $? \"Could not set mcast_membership_interval in vlan 10\"\n\tlog_test \"Vlan 10 mcast_membership_interval option changed to 200\"\n\n\tRET=0\n\tvlmc_v2join_test 1\n\tlog_test \"Vlan 10 mcast_membership_interval mdb entry expire\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_membership_interval 26000\n}\n\nvlmc_querier_intvl_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_querier_interval == 25500) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_querier_interval global vlan option value\"\n\tlog_test \"Vlan mcast_querier_interval global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier_interval 100\n\tcheck_err $? \"Could not set mcast_querier_interval in vlan 10\"\n\tlog_test \"Vlan 10 mcast_querier_interval option changed to 100\"\n\n\tRET=0\n\tip link add dev br1 type bridge mcast_snooping 1 mcast_querier 1 vlan_filtering 1 \\\n\t\t\t\t\tmcast_vlan_snooping 1\n\tbridge vlan add vid 10 dev br1 self pvid untagged\n\tip link set dev $h1 master br1\n\tip link set dev br1 up\n\tbridge vlan add vid 10 dev $h1 master\n\tbridge vlan global set vid 10 dev br1 mcast_snooping 1 mcast_querier 1\n\tsleep 2\n\tip link del dev br1\n\tip addr replace 2001:db8:1::1/64 dev $h1\n\tvlmc_check_query igmp 2 $swp1 1 1\n\tcheck_err $? \"Wrong number of IGMPv2 general queries after querier interval\"\n\tlog_test \"Vlan 10 mcast_querier_interval expire after outside query\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier_interval 25500\n}\n\nvlmc_query_intvl_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_query_interval == 12500) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_query_interval global vlan option value\"\n\tlog_test \"Vlan mcast_query_interval global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_count 0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_query_interval 200\n\tcheck_err $? \"Could not set mcast_query_interval in vlan 10\"\n\t# 1 is sent immediately, then 2 more in the next 5 seconds\n\tvlmc_check_query igmp 2 $swp1 3 5\n\tcheck_err $? \"Wrong number of tagged IGMPv2 general queries sent\"\n\tlog_test \"Vlan 10 mcast_query_interval option changed to 200\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_startup_query_count 2\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_query_interval 12500\n}\n\nvlmc_query_response_intvl_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j vlan global show`\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find vlan 10's global options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[].vlans[] | select(.vlan == 10 and \\\n\t\t\t\t\t    .mcast_query_response_interval == 1000) \" &>/dev/null\n\tcheck_err $? \"Wrong default mcast_query_response_interval global vlan option value\"\n\tlog_test \"Vlan mcast_query_response_interval global option default value\"\n\n\tRET=0\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_query_response_interval 200\n\tcheck_err $? \"Could not set mcast_query_response_interval in vlan 10\"\n\tlog_test \"Vlan 10 mcast_query_response_interval option changed to 200\"\n\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_query_response_interval 1000\n}\n\nvlmc_router_port_test()\n{\n\tRET=0\n\tlocal goutput=`bridge -j -d vlan show`\n\techo -n $goutput |\n\t\tjq -e \".[] | select(.ifname == \\\"$swp1\\\" and \\\n\t\t\t\t    .vlans[].vlan == 10)\" &>/dev/null\n\tcheck_err $? \"Could not find port vlan 10's options\"\n\n\techo -n $goutput |\n\t\tjq -e \".[] | select(.ifname == \\\"$swp1\\\" and \\\n\t\t\t\t    .vlans[].vlan == 10 and \\\n\t\t\t\t    .vlans[].mcast_router == 1)\" &>/dev/null\n\tcheck_err $? \"Wrong default port mcast_router option value\"\n\tlog_test \"Port vlan 10 option mcast_router default value\"\n\n\tRET=0\n\tbridge vlan set vid 10 dev $swp1 mcast_router 2\n\tcheck_err $? \"Could not set port vlan 10's mcast_router option\"\n\tlog_test \"Port vlan 10 mcast_router option changed to 2\"\n\n\tRET=0\n\ttc filter add dev $swp1 egress pref 10 prot 802.1Q \\\n\t\tflower vlan_id 10 vlan_ethtype ipv4 dst_ip 239.1.1.1 ip_proto udp action pass\n\ttc filter add dev $swp2 egress pref 10 prot 802.1Q \\\n\t\tflower vlan_id 10 vlan_ethtype ipv4 dst_ip 239.1.1.1 ip_proto udp action pass\n\tbridge vlan set vid 10 dev $swp2 mcast_router 0\n\t# we need to enable querier and disable query response interval to\n\t# make sure packets are flooded only to router ports\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_querier 1 \\\n\t\t\t\t\t      mcast_query_response_interval 0\n\tbridge vlan add vid 10 dev br0 self\n\tsleep 1\n\tmausezahn br0 -Q 10 -c 10 -p 128 -b 01:00:5e:01:01:01 -B 239.1.1.1 \\\n\t\t\t-t udp \"dp=1024\" &>/dev/null\n\tlocal swp1_tcstats=$(tc_rule_stats_get $swp1 10 egress)\n\tif [[ $swp1_tcstats != 10 ]]; then\n\t\tcheck_err 1 \"Wrong number of vlan 10 multicast packets flooded\"\n\tfi\n\tlocal swp2_tcstats=$(tc_rule_stats_get $swp2 10 egress)\n\tcheck_err $swp2_tcstats \"Vlan 10 multicast packets flooded to non-router port\"\n\tlog_test \"Flood unknown vlan multicast packets to router port only\"\n\n\ttc filter del dev $swp2 egress pref 10\n\ttc filter del dev $swp1 egress pref 10\n\tbridge vlan del vid 10 dev br0 self\n\tbridge vlan global set vid 10 dev br0 mcast_snooping 1 mcast_query_response_interval 1000\n\tbridge vlan set vid 10 dev $swp2 mcast_router 1\n\tbridge vlan set vid 10 dev $swp1 mcast_router 1\n}\n\nvlmc_filtering_test()\n{\n\tRET=0\n\tip link set dev br0 type bridge vlan_filtering 0\n\tip -j -d link show dev br0 | \\\n\tjq -e \"select(.[0].linkinfo.info_data.mcast_vlan_snooping == 1)\" &>/dev/null\n\tcheck_fail $? \"Vlan filtering is disabled but multicast vlan snooping is still enabled\"\n\tlog_test \"Disable multicast vlan snooping when vlan filtering is disabled\"\n}\n\ntrap cleanup EXIT\n\nsetup_prepare\nsetup_wait\n\ntests_run\n\nexit $EXIT_STATUS\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}