{
  "module_name": "altnames.sh",
  "hash_id": "bb88562536c42a2de992081cef00a651cd8d87d665656a7dab6ad4f2b3bd2d4a",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/net/altnames.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\nlib_dir=$(dirname $0)/forwarding\n\nALL_TESTS=\"altnames_test\"\nNUM_NETIFS=0\nsource $lib_dir/lib.sh\n\nDUMMY_DEV=dummytest\nSHORT_NAME=shortname\nLONG_NAME=someveryveryveryveryveryverylongname\n\naltnames_test()\n{\n\tRET=0\n\tlocal output\n\tlocal name\n\n\tip link property add $DUMMY_DEV altname $SHORT_NAME\n\tcheck_err $? \"Failed to add short alternative name\"\n\n\toutput=$(ip -j -p link show $SHORT_NAME)\n\tcheck_err $? \"Failed to do link show with short alternative name\"\n\n\tname=$(echo $output | jq -e -r \".[0].altnames[0]\")\n\tcheck_err $? \"Failed to get short alternative name from link show JSON\"\n\n\t[ \"$name\" == \"$SHORT_NAME\" ]\n\tcheck_err $? \"Got unexpected short alternative name from link show JSON\"\n\n\tip -j -p link show $DUMMY_DEV &>/dev/null\n\tcheck_err $? \"Failed to do link show with original name\"\n\n\tip link property add $DUMMY_DEV altname $LONG_NAME\n\tcheck_err $? \"Failed to add long alternative name\"\n\n\toutput=$(ip -j -p link show $LONG_NAME)\n\tcheck_err $? \"Failed to do link show with long alternative name\"\n\n\tname=$(echo $output | jq -e -r \".[0].altnames[1]\")\n\tcheck_err $? \"Failed to get long alternative name from link show JSON\"\n\n\t[ \"$name\" == \"$LONG_NAME\" ]\n\tcheck_err $? \"Got unexpected long alternative name from link show JSON\"\n\n\tip link property del $DUMMY_DEV altname $SHORT_NAME\n\tcheck_err $? \"Failed to delete short alternative name\"\n\n\tip -j -p link show $SHORT_NAME &>/dev/null\n\tcheck_fail $? \"Unexpected success while trying to do link show with deleted short alternative name\"\n\n\t# long name is left there on purpose to be removed alongside the device\n\n\tlog_test \"altnames test\"\n}\n\nsetup_prepare()\n{\n\tip link add name $DUMMY_DEV type dummy\n}\n\ncleanup()\n{\n\tpre_cleanup\n\tip link del name $DUMMY_DEV\n}\n\ntrap cleanup EXIT\n\nsetup_prepare\n\ntests_run\n\nexit $EXIT_STATUS\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}