{
  "module_name": "Makefile",
  "hash_id": "79a6b277a5c4189dd94986803de173a57c2d0f11bc15e6519a6bfad4c6e62ec7",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/kvm/Makefile",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\ninclude ../../../build/Build.include\n\nall:\n\ntop_srcdir = ../../../..\ninclude $(top_srcdir)/scripts/subarch.include\nARCH            ?= $(SUBARCH)\n\nifeq ($(ARCH),x86)\n\tARCH_DIR := x86_64\nelse ifeq ($(ARCH),arm64)\n\tARCH_DIR := aarch64\nelse ifeq ($(ARCH),s390)\n\tARCH_DIR := s390x\nelse\n\tARCH_DIR := $(ARCH)\nendif\n\nLIBKVM += lib/assert.c\nLIBKVM += lib/elf.c\nLIBKVM += lib/guest_modes.c\nLIBKVM += lib/io.c\nLIBKVM += lib/kvm_util.c\nLIBKVM += lib/memstress.c\nLIBKVM += lib/guest_sprintf.c\nLIBKVM += lib/rbtree.c\nLIBKVM += lib/sparsebit.c\nLIBKVM += lib/test_util.c\nLIBKVM += lib/ucall_common.c\nLIBKVM += lib/userfaultfd_util.c\n\nLIBKVM_STRING += lib/string_override.c\n\nLIBKVM_x86_64 += lib/x86_64/apic.c\nLIBKVM_x86_64 += lib/x86_64/handlers.S\nLIBKVM_x86_64 += lib/x86_64/hyperv.c\nLIBKVM_x86_64 += lib/x86_64/memstress.c\nLIBKVM_x86_64 += lib/x86_64/processor.c\nLIBKVM_x86_64 += lib/x86_64/svm.c\nLIBKVM_x86_64 += lib/x86_64/ucall.c\nLIBKVM_x86_64 += lib/x86_64/vmx.c\n\nLIBKVM_aarch64 += lib/aarch64/gic.c\nLIBKVM_aarch64 += lib/aarch64/gic_v3.c\nLIBKVM_aarch64 += lib/aarch64/handlers.S\nLIBKVM_aarch64 += lib/aarch64/processor.c\nLIBKVM_aarch64 += lib/aarch64/spinlock.c\nLIBKVM_aarch64 += lib/aarch64/ucall.c\nLIBKVM_aarch64 += lib/aarch64/vgic.c\n\nLIBKVM_s390x += lib/s390x/diag318_test_handler.c\nLIBKVM_s390x += lib/s390x/processor.c\nLIBKVM_s390x += lib/s390x/ucall.c\n\nLIBKVM_riscv += lib/riscv/processor.c\nLIBKVM_riscv += lib/riscv/ucall.c\n\n# Non-compiled test targets\nTEST_PROGS_x86_64 += x86_64/nx_huge_pages_test.sh\n\n# Compiled test targets\nTEST_GEN_PROGS_x86_64 = x86_64/cpuid_test\nTEST_GEN_PROGS_x86_64 += x86_64/cr4_cpuid_sync_test\nTEST_GEN_PROGS_x86_64 += x86_64/dirty_log_page_splitting_test\nTEST_GEN_PROGS_x86_64 += x86_64/get_msr_index_features\nTEST_GEN_PROGS_x86_64 += x86_64/exit_on_emulation_failure_test\nTEST_GEN_PROGS_x86_64 += x86_64/fix_hypercall_test\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_clock\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_cpuid\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_evmcs\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_extended_hypercalls\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_features\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_ipi\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_svm_test\nTEST_GEN_PROGS_x86_64 += x86_64/hyperv_tlb_flush\nTEST_GEN_PROGS_x86_64 += x86_64/kvm_clock_test\nTEST_GEN_PROGS_x86_64 += x86_64/kvm_pv_test\nTEST_GEN_PROGS_x86_64 += x86_64/mmio_warning_test\nTEST_GEN_PROGS_x86_64 += x86_64/monitor_mwait_test\nTEST_GEN_PROGS_x86_64 += x86_64/nested_exceptions_test\nTEST_GEN_PROGS_x86_64 += x86_64/platform_info_test\nTEST_GEN_PROGS_x86_64 += x86_64/pmu_event_filter_test\nTEST_GEN_PROGS_x86_64 += x86_64/set_boot_cpu_id\nTEST_GEN_PROGS_x86_64 += x86_64/set_sregs_test\nTEST_GEN_PROGS_x86_64 += x86_64/smaller_maxphyaddr_emulation_test\nTEST_GEN_PROGS_x86_64 += x86_64/smm_test\nTEST_GEN_PROGS_x86_64 += x86_64/state_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_preemption_timer_test\nTEST_GEN_PROGS_x86_64 += x86_64/svm_vmcall_test\nTEST_GEN_PROGS_x86_64 += x86_64/svm_int_ctl_test\nTEST_GEN_PROGS_x86_64 += x86_64/svm_nested_shutdown_test\nTEST_GEN_PROGS_x86_64 += x86_64/svm_nested_soft_inject_test\nTEST_GEN_PROGS_x86_64 += x86_64/tsc_scaling_sync\nTEST_GEN_PROGS_x86_64 += x86_64/sync_regs_test\nTEST_GEN_PROGS_x86_64 += x86_64/ucna_injection_test\nTEST_GEN_PROGS_x86_64 += x86_64/userspace_io_test\nTEST_GEN_PROGS_x86_64 += x86_64/userspace_msr_exit_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_apic_access_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_close_while_nested_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_dirty_log_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_exception_with_invalid_guest_state\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_msrs_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_invalid_nested_guest_state\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_set_nested_state_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_tsc_adjust_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_nested_tsc_scaling_test\nTEST_GEN_PROGS_x86_64 += x86_64/xapic_ipi_test\nTEST_GEN_PROGS_x86_64 += x86_64/xapic_state_test\nTEST_GEN_PROGS_x86_64 += x86_64/xcr0_cpuid_test\nTEST_GEN_PROGS_x86_64 += x86_64/xss_msr_test\nTEST_GEN_PROGS_x86_64 += x86_64/debug_regs\nTEST_GEN_PROGS_x86_64 += x86_64/tsc_msrs_test\nTEST_GEN_PROGS_x86_64 += x86_64/vmx_pmu_caps_test\nTEST_GEN_PROGS_x86_64 += x86_64/xen_shinfo_test\nTEST_GEN_PROGS_x86_64 += x86_64/xen_vmcall_test\nTEST_GEN_PROGS_x86_64 += x86_64/sev_migrate_tests\nTEST_GEN_PROGS_x86_64 += x86_64/amx_test\nTEST_GEN_PROGS_x86_64 += x86_64/max_vcpuid_cap_test\nTEST_GEN_PROGS_x86_64 += x86_64/triple_fault_event_test\nTEST_GEN_PROGS_x86_64 += x86_64/recalc_apic_map_test\nTEST_GEN_PROGS_x86_64 += access_tracking_perf_test\nTEST_GEN_PROGS_x86_64 += demand_paging_test\nTEST_GEN_PROGS_x86_64 += dirty_log_test\nTEST_GEN_PROGS_x86_64 += dirty_log_perf_test\nTEST_GEN_PROGS_x86_64 += guest_print_test\nTEST_GEN_PROGS_x86_64 += hardware_disable_test\nTEST_GEN_PROGS_x86_64 += kvm_create_max_vcpus\nTEST_GEN_PROGS_x86_64 += kvm_page_table_test\nTEST_GEN_PROGS_x86_64 += max_guest_memory_test\nTEST_GEN_PROGS_x86_64 += memslot_modification_stress_test\nTEST_GEN_PROGS_x86_64 += memslot_perf_test\nTEST_GEN_PROGS_x86_64 += rseq_test\nTEST_GEN_PROGS_x86_64 += set_memory_region_test\nTEST_GEN_PROGS_x86_64 += steal_time\nTEST_GEN_PROGS_x86_64 += kvm_binary_stats_test\nTEST_GEN_PROGS_x86_64 += system_counter_offset_test\n\n# Compiled outputs used by test targets\nTEST_GEN_PROGS_EXTENDED_x86_64 += x86_64/nx_huge_pages_test\n\nTEST_GEN_PROGS_aarch64 += aarch64/aarch32_id_regs\nTEST_GEN_PROGS_aarch64 += aarch64/arch_timer\nTEST_GEN_PROGS_aarch64 += aarch64/debug-exceptions\nTEST_GEN_PROGS_aarch64 += aarch64/hypercalls\nTEST_GEN_PROGS_aarch64 += aarch64/page_fault_test\nTEST_GEN_PROGS_aarch64 += aarch64/psci_test\nTEST_GEN_PROGS_aarch64 += aarch64/smccc_filter\nTEST_GEN_PROGS_aarch64 += aarch64/vcpu_width_config\nTEST_GEN_PROGS_aarch64 += aarch64/vgic_init\nTEST_GEN_PROGS_aarch64 += aarch64/vgic_irq\nTEST_GEN_PROGS_aarch64 += access_tracking_perf_test\nTEST_GEN_PROGS_aarch64 += demand_paging_test\nTEST_GEN_PROGS_aarch64 += dirty_log_test\nTEST_GEN_PROGS_aarch64 += dirty_log_perf_test\nTEST_GEN_PROGS_aarch64 += guest_print_test\nTEST_GEN_PROGS_aarch64 += get-reg-list\nTEST_GEN_PROGS_aarch64 += kvm_create_max_vcpus\nTEST_GEN_PROGS_aarch64 += kvm_page_table_test\nTEST_GEN_PROGS_aarch64 += memslot_modification_stress_test\nTEST_GEN_PROGS_aarch64 += memslot_perf_test\nTEST_GEN_PROGS_aarch64 += rseq_test\nTEST_GEN_PROGS_aarch64 += set_memory_region_test\nTEST_GEN_PROGS_aarch64 += steal_time\nTEST_GEN_PROGS_aarch64 += kvm_binary_stats_test\n\nTEST_GEN_PROGS_s390x = s390x/memop\nTEST_GEN_PROGS_s390x += s390x/resets\nTEST_GEN_PROGS_s390x += s390x/sync_regs_test\nTEST_GEN_PROGS_s390x += s390x/tprot\nTEST_GEN_PROGS_s390x += s390x/cmma_test\nTEST_GEN_PROGS_s390x += s390x/debug_test\nTEST_GEN_PROGS_s390x += demand_paging_test\nTEST_GEN_PROGS_s390x += dirty_log_test\nTEST_GEN_PROGS_s390x += guest_print_test\nTEST_GEN_PROGS_s390x += kvm_create_max_vcpus\nTEST_GEN_PROGS_s390x += kvm_page_table_test\nTEST_GEN_PROGS_s390x += rseq_test\nTEST_GEN_PROGS_s390x += set_memory_region_test\nTEST_GEN_PROGS_s390x += kvm_binary_stats_test\n\nTEST_GEN_PROGS_riscv += demand_paging_test\nTEST_GEN_PROGS_riscv += dirty_log_test\nTEST_GEN_PROGS_riscv += guest_print_test\nTEST_GEN_PROGS_riscv += get-reg-list\nTEST_GEN_PROGS_riscv += kvm_create_max_vcpus\nTEST_GEN_PROGS_riscv += kvm_page_table_test\nTEST_GEN_PROGS_riscv += set_memory_region_test\nTEST_GEN_PROGS_riscv += kvm_binary_stats_test\n\nSPLIT_TESTS += get-reg-list\n\nTEST_PROGS += $(TEST_PROGS_$(ARCH_DIR))\nTEST_GEN_PROGS += $(TEST_GEN_PROGS_$(ARCH_DIR))\nTEST_GEN_PROGS_EXTENDED += $(TEST_GEN_PROGS_EXTENDED_$(ARCH_DIR))\nLIBKVM += $(LIBKVM_$(ARCH_DIR))\n\nOVERRIDE_TARGETS = 1\n\n# lib.mak defines $(OUTPUT), prepends $(OUTPUT)/ to $(TEST_GEN_PROGS), and most\n# importantly defines, i.e. overwrites, $(CC) (unless `make -e` or `make CC=`,\n# which causes the environment variable to override the makefile).\ninclude ../lib.mk\n\nINSTALL_HDR_PATH = $(top_srcdir)/usr\nLINUX_HDR_PATH = $(INSTALL_HDR_PATH)/include/\nLINUX_TOOL_INCLUDE = $(top_srcdir)/tools/include\nifeq ($(ARCH),x86_64)\nLINUX_TOOL_ARCH_INCLUDE = $(top_srcdir)/tools/arch/x86/include\nelse\nLINUX_TOOL_ARCH_INCLUDE = $(top_srcdir)/tools/arch/$(ARCH)/include\nendif\nCFLAGS += -Wall -Wstrict-prototypes -Wuninitialized -O2 -g -std=gnu99 \\\n\t-Wno-gnu-variable-sized-type-not-at-end -MD\\\n\t-fno-builtin-memcmp -fno-builtin-memcpy -fno-builtin-memset \\\n\t-fno-builtin-strnlen \\\n\t-fno-stack-protector -fno-PIE -I$(LINUX_TOOL_INCLUDE) \\\n\t-I$(LINUX_TOOL_ARCH_INCLUDE) -I$(LINUX_HDR_PATH) -Iinclude \\\n\t-I$(<D) -Iinclude/$(ARCH_DIR) -I ../rseq -I.. $(EXTRA_CFLAGS) \\\n\t$(KHDR_INCLUDES)\nifeq ($(ARCH),s390)\n\tCFLAGS += -march=z10\nendif\n\nno-pie-option := $(call try-run, echo 'int main(void) { return 0; }' | \\\n        $(CC) -Werror $(CFLAGS) -no-pie -x c - -o \"$$TMP\", -no-pie)\n\n# On s390, build the testcases KVM-enabled\npgste-option = $(call try-run, echo 'int main(void) { return 0; }' | \\\n\t$(CC) -Werror -Wl$(comma)--s390-pgste -x c - -o \"$$TMP\",-Wl$(comma)--s390-pgste)\n\nLDLIBS += -ldl\nLDFLAGS += -pthread $(no-pie-option) $(pgste-option)\n\nLIBKVM_C := $(filter %.c,$(LIBKVM))\nLIBKVM_S := $(filter %.S,$(LIBKVM))\nLIBKVM_C_OBJ := $(patsubst %.c, $(OUTPUT)/%.o, $(LIBKVM_C))\nLIBKVM_S_OBJ := $(patsubst %.S, $(OUTPUT)/%.o, $(LIBKVM_S))\nLIBKVM_STRING_OBJ := $(patsubst %.c, $(OUTPUT)/%.o, $(LIBKVM_STRING))\nLIBKVM_OBJS = $(LIBKVM_C_OBJ) $(LIBKVM_S_OBJ) $(LIBKVM_STRING_OBJ)\nSPLIT_TESTS_TARGETS := $(patsubst %, $(OUTPUT)/%, $(SPLIT_TESTS))\nSPLIT_TESTS_OBJS := $(patsubst %, $(ARCH_DIR)/%.o, $(SPLIT_TESTS))\n\nTEST_GEN_OBJ = $(patsubst %, %.o, $(TEST_GEN_PROGS))\nTEST_GEN_OBJ += $(patsubst %, %.o, $(TEST_GEN_PROGS_EXTENDED))\nTEST_DEP_FILES = $(patsubst %.o, %.d, $(TEST_GEN_OBJ))\nTEST_DEP_FILES += $(patsubst %.o, %.d, $(LIBKVM_OBJS))\nTEST_DEP_FILES += $(patsubst %.o, %.d, $(SPLIT_TESTS_OBJS))\n-include $(TEST_DEP_FILES)\n\n$(TEST_GEN_PROGS) $(TEST_GEN_PROGS_EXTENDED): %: %.o\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) $< $(LIBKVM_OBJS) $(LDLIBS) -o $@\n$(TEST_GEN_OBJ): $(OUTPUT)/%.o: %.c\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(TARGET_ARCH) -c $< -o $@\n\n$(SPLIT_TESTS_TARGETS): %: %.o $(SPLIT_TESTS_OBJS)\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) $^ $(LDLIBS) -o $@\n\nEXTRA_CLEAN += $(LIBKVM_OBJS) $(TEST_DEP_FILES) $(TEST_GEN_OBJ) $(SPLIT_TESTS_OBJS) cscope.*\n\nx := $(shell mkdir -p $(sort $(dir $(LIBKVM_C_OBJ) $(LIBKVM_S_OBJ))))\n$(LIBKVM_C_OBJ): $(OUTPUT)/%.o: %.c\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(TARGET_ARCH) -c $< -o $@\n\n$(LIBKVM_S_OBJ): $(OUTPUT)/%.o: %.S\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(TARGET_ARCH) -c $< -o $@\n\n# Compile the string overrides as freestanding to prevent the compiler from\n# generating self-referential code, e.g. without \"freestanding\" the compiler may\n# \"optimize\" memcmp() by invoking memcmp(), thus causing infinite recursion.\n$(LIBKVM_STRING_OBJ): $(OUTPUT)/%.o: %.c\n\t$(CC) $(CFLAGS) $(CPPFLAGS) $(TARGET_ARCH) -c -ffreestanding $< -o $@\n\nx := $(shell mkdir -p $(sort $(dir $(TEST_GEN_PROGS))))\n$(TEST_GEN_PROGS): $(LIBKVM_OBJS)\n$(TEST_GEN_PROGS_EXTENDED): $(LIBKVM_OBJS)\n\ncscope: include_paths = $(LINUX_TOOL_INCLUDE) $(LINUX_HDR_PATH) include lib ..\ncscope:\n\t$(RM) cscope.*\n\t(find $(include_paths) -name '*.h' \\\n\t\t-exec realpath --relative-base=$(PWD) {} \\;; \\\n\tfind . -name '*.c' \\\n\t\t-exec realpath --relative-base=$(PWD) {} \\;) | sort -u > cscope.files\n\tcscope -b\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}