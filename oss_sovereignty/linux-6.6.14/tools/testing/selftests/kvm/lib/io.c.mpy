{
  "module_name": "io.c",
  "hash_id": "7609d6d645694ce081a4db85baa2240ce51e8475b9d2942bfa1b89bda11a4a04",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/kvm/lib/io.c",
  "human_readable_source": "\n \n\n#include \"test_util.h\"\n\n \nssize_t test_write(int fd, const void *buf, size_t count)\n{\n\tssize_t rc;\n\tssize_t num_written = 0;\n\tsize_t num_left = count;\n\tconst char *ptr = buf;\n\n\t \n\tTEST_ASSERT(count >= 0, \"Unexpected count, count: %li\", count);\n\n\tdo {\n\t\trc = write(fd, ptr, num_left);\n\n\t\tswitch (rc) {\n\t\tcase -1:\n\t\t\tTEST_ASSERT(errno == EAGAIN || errno == EINTR,\n\t\t\t\t    \"Unexpected write failure,\\n\"\n\t\t\t\t    \"  rc: %zi errno: %i\", rc, errno);\n\t\t\tcontinue;\n\n\t\tcase 0:\n\t\t\tTEST_FAIL(\"Unexpected EOF,\\n\"\n\t\t\t\t  \"  rc: %zi num_written: %zi num_left: %zu\",\n\t\t\t\t  rc, num_written, num_left);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tTEST_ASSERT(rc >= 0, \"Unexpected ret from write,\\n\"\n\t\t\t\t\"  rc: %zi errno: %i\", rc, errno);\n\t\t\tnum_written += rc;\n\t\t\tnum_left -= rc;\n\t\t\tptr += rc;\n\t\t\tbreak;\n\t\t}\n\t} while (num_written < count);\n\n\treturn num_written;\n}\n\n \nssize_t test_read(int fd, void *buf, size_t count)\n{\n\tssize_t rc;\n\tssize_t num_read = 0;\n\tsize_t num_left = count;\n\tchar *ptr = buf;\n\n\t \n\tTEST_ASSERT(count >= 0, \"Unexpected count, count: %li\", count);\n\n\tdo {\n\t\trc = read(fd, ptr, num_left);\n\n\t\tswitch (rc) {\n\t\tcase -1:\n\t\t\tTEST_ASSERT(errno == EAGAIN || errno == EINTR,\n\t\t\t\t    \"Unexpected read failure,\\n\"\n\t\t\t\t    \"  rc: %zi errno: %i\", rc, errno);\n\t\t\tbreak;\n\n\t\tcase 0:\n\t\t\tTEST_FAIL(\"Unexpected EOF,\\n\"\n\t\t\t\t  \"   rc: %zi num_read: %zi num_left: %zu\",\n\t\t\t\t  rc, num_read, num_left);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tTEST_ASSERT(rc > 0, \"Unexpected ret from read,\\n\"\n\t\t\t\t    \"  rc: %zi errno: %i\", rc, errno);\n\t\t\tnum_read += rc;\n\t\t\tnum_left -= rc;\n\t\t\tptr += rc;\n\t\t\tbreak;\n\t\t}\n\t} while (num_read < count);\n\n\treturn num_read;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}