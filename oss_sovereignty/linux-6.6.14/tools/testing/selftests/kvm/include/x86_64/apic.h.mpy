{
  "module_name": "apic.h",
  "hash_id": "bd11015d2cd7972b2b32c7efa9ab6109c5a18d5bec6e8c815794504692ee9fe6",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/kvm/include/x86_64/apic.h",
  "human_readable_source": " \n \n\n#ifndef SELFTEST_KVM_APIC_H\n#define SELFTEST_KVM_APIC_H\n\n#include <stdint.h>\n\n#include \"processor.h\"\n\n#define APIC_DEFAULT_GPA\t\t0xfee00000ULL\n\n \n#define MSR_IA32_APICBASE\t\t0x0000001b\n#define MSR_IA32_APICBASE_BSP\t\t(1<<8)\n#define MSR_IA32_APICBASE_EXTD\t\t(1<<10)\n#define MSR_IA32_APICBASE_ENABLE\t(1<<11)\n#define MSR_IA32_APICBASE_BASE\t\t(0xfffff<<12)\n#define\t\tGET_APIC_BASE(x)\t(((x) >> 12) << 12)\n\n#define APIC_BASE_MSR\t0x800\n#define X2APIC_ENABLE\t(1UL << 10)\n#define\tAPIC_ID\t\t0x20\n#define\tAPIC_LVR\t0x30\n#define\t\tGET_APIC_ID_FIELD(x)\t(((x) >> 24) & 0xFF)\n#define\tAPIC_TASKPRI\t0x80\n#define\tAPIC_PROCPRI\t0xA0\n#define\tAPIC_EOI\t0xB0\n#define\tAPIC_SPIV\t0xF0\n#define\t\tAPIC_SPIV_FOCUS_DISABLED\t(1 << 9)\n#define\t\tAPIC_SPIV_APIC_ENABLED\t\t(1 << 8)\n#define APIC_IRR\t0x200\n#define\tAPIC_ICR\t0x300\n#define\tAPIC_LVTCMCI\t0x2f0\n#define\t\tAPIC_DEST_SELF\t\t0x40000\n#define\t\tAPIC_DEST_ALLINC\t0x80000\n#define\t\tAPIC_DEST_ALLBUT\t0xC0000\n#define\t\tAPIC_ICR_RR_MASK\t0x30000\n#define\t\tAPIC_ICR_RR_INVALID\t0x00000\n#define\t\tAPIC_ICR_RR_INPROG\t0x10000\n#define\t\tAPIC_ICR_RR_VALID\t0x20000\n#define\t\tAPIC_INT_LEVELTRIG\t0x08000\n#define\t\tAPIC_INT_ASSERT\t\t0x04000\n#define\t\tAPIC_ICR_BUSY\t\t0x01000\n#define\t\tAPIC_DEST_LOGICAL\t0x00800\n#define\t\tAPIC_DEST_PHYSICAL\t0x00000\n#define\t\tAPIC_DM_FIXED\t\t0x00000\n#define\t\tAPIC_DM_FIXED_MASK\t0x00700\n#define\t\tAPIC_DM_LOWEST\t\t0x00100\n#define\t\tAPIC_DM_SMI\t\t0x00200\n#define\t\tAPIC_DM_REMRD\t\t0x00300\n#define\t\tAPIC_DM_NMI\t\t0x00400\n#define\t\tAPIC_DM_INIT\t\t0x00500\n#define\t\tAPIC_DM_STARTUP\t\t0x00600\n#define\t\tAPIC_DM_EXTINT\t\t0x00700\n#define\t\tAPIC_VECTOR_MASK\t0x000FF\n#define\tAPIC_ICR2\t0x310\n#define\t\tSET_APIC_DEST_FIELD(x)\t((x) << 24)\n\nvoid apic_disable(void);\nvoid xapic_enable(void);\nvoid x2apic_enable(void);\n\nstatic inline uint32_t get_bsp_flag(void)\n{\n\treturn rdmsr(MSR_IA32_APICBASE) & MSR_IA32_APICBASE_BSP;\n}\n\nstatic inline uint32_t xapic_read_reg(unsigned int reg)\n{\n\treturn ((volatile uint32_t *)APIC_DEFAULT_GPA)[reg >> 2];\n}\n\nstatic inline void xapic_write_reg(unsigned int reg, uint32_t val)\n{\n\t((volatile uint32_t *)APIC_DEFAULT_GPA)[reg >> 2] = val;\n}\n\nstatic inline uint64_t x2apic_read_reg(unsigned int reg)\n{\n\treturn rdmsr(APIC_BASE_MSR + (reg >> 4));\n}\n\nstatic inline void x2apic_write_reg(unsigned int reg, uint64_t value)\n{\n\twrmsr(APIC_BASE_MSR + (reg >> 4), value);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}