{
  "module_name": "exit_on_emulation_failure_test.c",
  "hash_id": "d30e15a62c9e3bb5367bbb00bc004c3d9a83a6736fbb7d3b499385c77de9e8d4",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/kvm/x86_64/exit_on_emulation_failure_test.c",
  "human_readable_source": "\n \n\n#define _GNU_SOURCE  \n\n#include \"flds_emulation.h\"\n\n#include \"test_util.h\"\n\n#define MMIO_GPA\t0x700000000\n#define MMIO_GVA\tMMIO_GPA\n\nstatic void guest_code(void)\n{\n\t \n\tflds(MMIO_GVA);\n\tGUEST_DONE();\n}\n\nint main(int argc, char *argv[])\n{\n\tstruct kvm_vcpu *vcpu;\n\tstruct kvm_vm *vm;\n\n\tTEST_REQUIRE(kvm_has_cap(KVM_CAP_EXIT_ON_EMULATION_FAILURE));\n\n\tvm = vm_create_with_one_vcpu(&vcpu, guest_code);\n\tvm_enable_cap(vm, KVM_CAP_EXIT_ON_EMULATION_FAILURE, 1);\n\tvirt_map(vm, MMIO_GVA, MMIO_GPA, 1);\n\n\tvcpu_run(vcpu);\n\thandle_flds_emulation_failure_exit(vcpu);\n\tvcpu_run(vcpu);\n\tTEST_ASSERT_EQ(get_ucall(vcpu, NULL), UCALL_DONE);\n\n\tkvm_vm_free(vm);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}