{
  "module_name": "set-tz.c",
  "hash_id": "30119e6194ec00f4e3c68c24df3077df6a2a6b696508d85d5d41ea726f7daa00",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/timers/set-tz.c",
  "human_readable_source": " \n\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <time.h>\n#include <sys/time.h>\n#include <sys/timex.h>\n#include <string.h>\n#include <signal.h>\n#include <unistd.h>\n#include \"../kselftest.h\"\n\nint set_tz(int min, int dst)\n{\n\tstruct timezone tz;\n\n\ttz.tz_minuteswest = min;\n\ttz.tz_dsttime = dst;\n\n\treturn settimeofday(0, &tz);\n}\n\nint get_tz_min(void)\n{\n\tstruct timezone tz;\n\tstruct timeval tv;\n\n\tmemset(&tz, 0, sizeof(tz));\n\tgettimeofday(&tv, &tz);\n\treturn tz.tz_minuteswest;\n}\n\nint get_tz_dst(void)\n{\n\tstruct timezone tz;\n\tstruct timeval tv;\n\n\tmemset(&tz, 0, sizeof(tz));\n\tgettimeofday(&tv, &tz);\n\treturn tz.tz_dsttime;\n}\n\nint main(int argc, char **argv)\n{\n\tint i, ret;\n\tint min, dst;\n\n\tmin = get_tz_min();\n\tdst = get_tz_dst();\n\tprintf(\"tz_minuteswest started at %i, dst at %i\\n\", min, dst);\n\n\tprintf(\"Checking tz_minuteswest can be properly set: \");\n\tfflush(stdout);\n\tfor (i = -15*60; i < 15*60; i += 30) {\n\t\tret = set_tz(i, dst);\n\t\tret = get_tz_min();\n\t\tif (ret != i) {\n\t\t\tprintf(\"[FAILED] expected: %i got %i\\n\", i, ret);\n\t\t\tgoto err;\n\t\t}\n\t}\n\tprintf(\"[OK]\\n\");\n\n\tprintf(\"Checking invalid tz_minuteswest values are caught: \");\n\tfflush(stdout);\n\n\tif (!set_tz(-15*60-1, dst)) {\n\t\tprintf(\"[FAILED] %i didn't return failure!\\n\", -15*60-1);\n\t\tgoto err;\n\t}\n\n\tif (!set_tz(15*60+1, dst)) {\n\t\tprintf(\"[FAILED] %i didn't return failure!\\n\", 15*60+1);\n\t\tgoto err;\n\t}\n\n\tif (!set_tz(-24*60, dst)) {\n\t\tprintf(\"[FAILED] %i didn't return failure!\\n\", -24*60);\n\t\tgoto err;\n\t}\n\n\tif (!set_tz(24*60, dst)) {\n\t\tprintf(\"[FAILED] %i didn't return failure!\\n\", 24*60);\n\t\tgoto err;\n\t}\n\n\tprintf(\"[OK]\\n\");\n\n\tset_tz(min, dst);\n\treturn ksft_exit_pass();\n\nerr:\n\tset_tz(min, dst);\n\treturn ksft_exit_fail();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}