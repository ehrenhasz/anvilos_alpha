{
  "module_name": "func_profiler.tc",
  "hash_id": "39ec6d54b3756e64833a1073ad2bee6ba1cbfd03a29f12b6f058b7588900302e",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/ftrace/test.d/ftrace/func_profiler.tc",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0\n# description: ftrace - function profiler with function tracing\n# requires: function_profile_enabled set_ftrace_filter function_graph:tracer\n\n# There was a bug after a rewrite of the ftrace infrastructure that\n# caused the function_profiler not to be able to run with the function\n# tracer, because the function_profiler used the function_graph tracer\n# and it was assumed the two could not run simultaneously.\n#\n# There was another related bug where the solution to the first bug\n# broke the way filtering of the function tracer worked.\n#\n# This test triggers those bugs on those kernels.\n#\n# We need function_graph and profiling to to run this test\n\nfail() { # mesg\n    echo $1\n    exit_fail\n}\n\necho \"Testing function tracer with profiler:\"\necho \"enable function tracer\"\necho function > current_tracer\necho \"enable profiler\"\necho 1 > function_profile_enabled\n\nsleep 1\n\necho \"Now filter on just schedule\"\necho '*schedule' > set_ftrace_filter\nclear_trace\n\necho \"Now disable function profiler\"\necho 0 > function_profile_enabled\n\nsleep 1\n\n# make sure only schedule functions exist\n\necho \"testing if only schedule is being traced\"\nif grep -v -e '^#' -e 'schedule' trace; then\n\tfail \"more than schedule was found\"\nfi\n\necho \"Make sure schedule was traced\"\nif ! grep -e 'schedule' trace > /dev/null; then\n\tcat trace\n\tfail \"can not find schedule in trace\"\nfi\n\necho > set_ftrace_filter\nclear_trace\n\nsleep 1\n\necho \"make sure something other than scheduler is being traced\"\nif ! grep -v -e '^#' -e 'schedule' trace > /dev/null; then\n\tcat trace\n\tfail \"no other functions besides schedule was found\"\nfi\n\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}