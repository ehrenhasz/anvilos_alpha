{
  "module_name": "fgraph-filter-stack.tc",
  "hash_id": "3f665776f1f771e31a8d802df3464bcd2fb19754da0e656ee0e2bebade7cc5ea",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/ftrace/test.d/ftrace/fgraph-filter-stack.tc",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0\n# description: ftrace - function graph filters with stack tracer\n# requires: stack_trace set_ftrace_filter function_graph:tracer\n\n# Make sure that function graph filtering works, and is not\n# affected by other tracers enabled (like stack tracer)\n\ndo_reset() {\n    if [ -e /proc/sys/kernel/stack_tracer_enabled ]; then\n\t    echo 0 > /proc/sys/kernel/stack_tracer_enabled\n    fi\n}\n\nfail() { # msg\n    do_reset\n    echo $1\n    exit_fail\n}\n\ndisable_tracing\nclear_trace;\n\n# filter something, schedule is always good\nif ! echo \"schedule\" > set_ftrace_filter; then\n    # test for powerpc 64\n    if ! echo \".schedule\" > set_ftrace_filter; then\n\tfail \"can not enable schedule filter\"\n    fi\nfi\n\necho function_graph > current_tracer\n\necho \"Now testing with stack tracer\"\n\necho 1 > /proc/sys/kernel/stack_tracer_enabled\n\ndisable_tracing\nclear_trace\nenable_tracing\nsleep 1\n\ncount=`cat trace | grep '()' | grep -v schedule | wc -l`\n\nif [ $count -ne 0 ]; then\n    fail \"Graph filtering not working with stack tracer?\"\nfi\n\n# Make sure we did find something\ncount=`cat trace | grep 'schedule()' | wc -l` \nif [ $count -eq 0 ]; then\n    fail \"No schedule traces found?\"\nfi\n\necho 0 > /proc/sys/kernel/stack_tracer_enabled\nclear_trace\nsleep 1\n\n\ncount=`cat trace | grep '()' | grep -v schedule | wc -l`\n\nif [ $count -ne 0 ]; then\n    fail \"Graph filtering not working after stack tracer disabled?\"\nfi\n\ncount=`cat trace | grep 'schedule()' | wc -l` \nif [ $count -eq 0 ]; then\n    fail \"No schedule traces found?\"\nfi\n\ndo_reset\n\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}