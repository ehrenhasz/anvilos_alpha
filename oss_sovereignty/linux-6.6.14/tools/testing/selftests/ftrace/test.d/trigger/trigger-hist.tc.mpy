{
  "module_name": "trigger-hist.tc",
  "hash_id": "40eaecda3ad4c63e7661d1eb12a22663f15d508ab8481a96b5baf6e429c812cb",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/ftrace/test.d/trigger/trigger-hist.tc",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0\n# description: event trigger - test histogram trigger\n# requires: set_event events/sched/sched_process_fork/trigger events/sched/sched_process_fork/hist\n# flags: instance\n\nfail() { #msg\n    echo $1\n    exit_fail\n}\n\necho \"Test histogram basic trigger\"\n\necho 'hist:keys=parent_pid:vals=child_pid' > events/sched/sched_process_fork/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\ngrep parent_pid events/sched/sched_process_fork/hist > /dev/null || \\\n    fail \"hist trigger on sched_process_fork did not work\"\ngrep child events/sched/sched_process_fork/hist > /dev/null || \\\n    fail \"hist trigger on sched_process_fork did not work\"\n\nreset_trigger\n\necho \"Test histogram with compound keys\"\n\necho 'hist:keys=parent_pid,child_pid' > events/sched/sched_process_fork/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\ngrep '^{ parent_pid:.*, child_pid:.*}' events/sched/sched_process_fork/hist > /dev/null || \\\n    fail \"compound keys on sched_process_fork did not work\"\n\nreset_trigger\n\necho \"Test histogram with string key\"\n\necho 'hist:keys=parent_comm' > events/sched/sched_process_fork/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\nCOMM=`cat /proc/$$/comm`\ngrep \"parent_comm: $COMM\" events/sched/sched_process_fork/hist > /dev/null || \\\n    fail \"string key on sched_process_fork did not work\"\n\nreset_trigger\n\necho \"Test histogram with sym modifier\"\n\necho 'hist:keys=call_site.sym' > events/kmem/kmalloc/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\ngrep '{ call_site: \\[[0-9a-f][0-9a-f]*\\] [_a-zA-Z][_a-zA-Z]* *}' events/kmem/kmalloc/hist > /dev/null || \\\n    fail \"sym modifier on kmalloc call_site did not work\"\n\nreset_trigger\n\necho \"Test histogram with sym-offset modifier\"\n\necho 'hist:keys=call_site.sym-offset' > events/kmem/kmalloc/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\ngrep '{ call_site: \\[[0-9a-f][0-9a-f]*\\] [_a-zA-Z][_a-zA-Z]*+0x[0-9a-f][0-9a-f]*' events/kmem/kmalloc/hist > /dev/null || \\\n    fail \"sym-offset modifier on kmalloc call_site did not work\"\n\nreset_trigger\n\necho \"Test histogram with sort key\"\n\necho 'hist:keys=parent_pid,child_pid:sort=child_pid.ascending' > events/sched/sched_process_fork/trigger\nfor i in `seq 1 10` ; do ( echo \"forked\" > /dev/null); done\n\ncheck_inc() {\n    while [ $# -gt 1 ]; do\n        [ $1 -gt $2 ] && return 1\n        shift 1\n    done\n    return 0\n}\ncheck_inc `grep -o \"child_pid:[[:space:]]*[[:digit:]]*\" \\\n    events/sched/sched_process_fork/hist | cut -d: -f2 ` ||\n    fail \"sort param on sched_process_fork did not work\"\n\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}