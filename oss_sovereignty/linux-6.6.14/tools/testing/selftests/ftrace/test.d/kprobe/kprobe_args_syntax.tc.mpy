{
  "module_name": "kprobe_args_syntax.tc",
  "hash_id": "35657847ffda48feb4e0a5ac2ac2c9ac266d413922a3edc92796ec64af8f39e5",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/ftrace/test.d/kprobe/kprobe_args_syntax.tc",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0\n# description: Kprobe event argument syntax\n# requires: kprobe_events \"x8/16/32/64\":README\n\nPROBEFUNC=\"vfs_read\"\nGOODREG=\nBADREG=\nGOODSYM=\"_sdata\"\nif ! grep -qw ${GOODSYM} /proc/kallsyms ; then\n  GOODSYM=$PROBEFUNC\nfi\nBADSYM=\"deaqswdefr\"\nSYMADDR=0x`grep -w ${GOODSYM} /proc/kallsyms | cut -f 1 -d \" \"`\nGOODTYPE=\"x16\"\nBADTYPE=\"y16\"\n\ncase `uname -m` in\nx86_64|i[3456]86)\n  GOODREG=%ax\n  BADREG=%ex\n;;\naarch64)\n  GOODREG=%x0\n  BADREG=%ax\n;;\narm*)\n  GOODREG=%r0\n  BADREG=%ax\n;;\nppc*)\n  GOODREG=%r3\n  BADREG=%msr\n;;\ns390*)\n  GOODREG=%r2\n  BADREG=%s2\n;;\nmips*)\n  GOODREG=%r4\n  BADREG=%r12\n;;\nloongarch*)\n  GOODREG=%r4\n  BADREG=%r12\n;;\n*)\n  echo \"Please implement other architecture here\"\n  exit_untested\nesac\n\ntest_goodarg() # Good-args\n{\n  while [ \"$1\" ]; do\n    echo \"p ${PROBEFUNC} $1\" > kprobe_events\n    shift 1\n  done;\n}\n\ntest_badarg() # Bad-args\n{\n  while [ \"$1\" ]; do\n    ! echo \"p ${PROBEFUNC} $1\" > kprobe_events\n    shift 1\n  done;\n}\n\necho > kprobe_events\n\n: \"Register access\"\ntest_goodarg ${GOODREG}\ntest_badarg ${BADREG}\n\n: \"Symbol access\"\ntest_goodarg \"@${GOODSYM}\" \"@${SYMADDR}\" \"@${GOODSYM}+10\" \"@${GOODSYM}-10\"\ntest_badarg \"@\" \"@${BADSYM}\" \"@${GOODSYM}*10\" \"@${GOODSYM}/10\" \\\n\t    \"@${GOODSYM}%10\" \"@${GOODSYM}&10\" \"@${GOODSYM}|10\"\n\n: \"Stack access\"\ntest_goodarg \"\\$stack\" \"\\$stack0\" \"\\$stack1\"\ntest_badarg \"\\$stackp\" \"\\$stack0+10\" \"\\$stack1-10\"\n\n: \"Retval access\"\necho \"r ${PROBEFUNC} \\$retval\" > kprobe_events\n! echo \"p ${PROBEFUNC} \\$retval\" > kprobe_events\n\n# $comm was introduced in 4.8, older kernels reject it.\nif grep -A1 \"fetcharg:\" README | grep -q '\\$comm' ; then\n: \"Comm access\"\ntest_goodarg \"\\$comm\"\nfi\n\n: \"Indirect memory access\"\ntest_goodarg \"+0(${GOODREG})\" \"-0(${GOODREG})\" \"+10(\\$stack)\" \\\n\t\"+0(\\$stack1)\" \"+10(@${GOODSYM}-10)\" \"+0(+10(+20(\\$stack)))\"\ntest_badarg \"+(${GOODREG})\" \"(${GOODREG}+10)\" \"-(${GOODREG})\" \"(${GOODREG})\" \\\n\t\"+10(\\$comm)\" \"+0(${GOODREG})+10\"\n\n: \"Name assignment\"\ntest_goodarg \"varname=${GOODREG}\"\ntest_badarg \"varname=varname2=${GOODREG}\"\n\n: \"Type syntax\"\ntest_goodarg \"${GOODREG}:${GOODTYPE}\"\ntest_badarg \"${GOODREG}::${GOODTYPE}\" \"${GOODREG}:${BADTYPE}\" \\\n\t\"${GOODTYPE}:${GOODREG}\"\n\n: \"Combination check\"\n\ntest_goodarg \"\\$comm:string\" \"+0(\\$stack):string\"\ntest_badarg \"\\$comm:x64\" \"\\$stack:string\" \"${GOODREG}:string\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}