{
  "module_name": "blacklisted_events_test.c",
  "hash_id": "d979aa7ba5f3d03d96239663d745639d43b511706529beed87e79dbafcfb7fb8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/pmu/event_code_tests/blacklisted_events_test.c",
  "human_readable_source": "\n \n\n#include <stdio.h>\n#include <sys/prctl.h>\n#include <limits.h>\n#include \"../event.h\"\n#include \"../sampling_tests/misc.h\"\n\n#define PM_DTLB_MISS_16G 0x1c058\n#define PM_DERAT_MISS_2M 0x1c05a\n#define PM_DTLB_MISS_2M 0x1c05c\n#define PM_MRK_DTLB_MISS_1G 0x1d15c\n#define PM_DTLB_MISS_4K 0x2c056\n#define PM_DERAT_MISS_1G 0x2c05a\n#define PM_MRK_DERAT_MISS_2M 0x2d152\n#define PM_MRK_DTLB_MISS_4K  0x2d156\n#define PM_MRK_DTLB_MISS_16G 0x2d15e\n#define PM_DTLB_MISS_64K 0x3c056\n#define PM_MRK_DERAT_MISS_1G 0x3d152\n#define PM_MRK_DTLB_MISS_64K 0x3d156\n#define PM_DISP_HELD_SYNC_HOLD 0x4003c\n#define PM_DTLB_MISS_16M 0x4c056\n#define PM_DTLB_MISS_1G 0x4c05a\n#define PM_MRK_DTLB_MISS_16M 0x4c15e\n#define PM_MRK_ST_DONE_L2 0x10134\n#define PM_RADIX_PWC_L1_HIT 0x1f056\n#define PM_FLOP_CMPL 0x100f4\n#define PM_MRK_NTF_FIN 0x20112\n#define PM_RADIX_PWC_L2_HIT 0x2d024\n#define PM_IFETCH_THROTTLE 0x3405e\n#define PM_MRK_L2_TM_ST_ABORT_SISTER 0x3e15c\n#define PM_RADIX_PWC_L3_HIT 0x3f056\n#define PM_RUN_CYC_SMT2_MODE 0x3006c\n#define PM_TM_TX_PASS_RUN_INST 0x4e014\n\n#define PVR_POWER9_CUMULUS 0x00002000\n\nint blacklist_events_dd21[] = {\n\tPM_MRK_ST_DONE_L2,\n\tPM_RADIX_PWC_L1_HIT,\n\tPM_FLOP_CMPL,\n\tPM_MRK_NTF_FIN,\n\tPM_RADIX_PWC_L2_HIT,\n\tPM_IFETCH_THROTTLE,\n\tPM_MRK_L2_TM_ST_ABORT_SISTER,\n\tPM_RADIX_PWC_L3_HIT,\n\tPM_RUN_CYC_SMT2_MODE,\n\tPM_TM_TX_PASS_RUN_INST,\n\tPM_DISP_HELD_SYNC_HOLD,\n};\n\nint blacklist_events_dd22[] = {\n\tPM_DTLB_MISS_16G,\n\tPM_DERAT_MISS_2M,\n\tPM_DTLB_MISS_2M,\n\tPM_MRK_DTLB_MISS_1G,\n\tPM_DTLB_MISS_4K,\n\tPM_DERAT_MISS_1G,\n\tPM_MRK_DERAT_MISS_2M,\n\tPM_MRK_DTLB_MISS_4K,\n\tPM_MRK_DTLB_MISS_16G,\n\tPM_DTLB_MISS_64K,\n\tPM_MRK_DERAT_MISS_1G,\n\tPM_MRK_DTLB_MISS_64K,\n\tPM_DISP_HELD_SYNC_HOLD,\n\tPM_DTLB_MISS_16M,\n\tPM_DTLB_MISS_1G,\n\tPM_MRK_DTLB_MISS_16M,\n};\n\nint pvr_min;\n\n \nint check_for_power9_version(void)\n{\n\tpvr_min = PVR_MIN(mfspr(SPRN_PVR));\n\n\tSKIP_IF(PVR_VER(pvr) != POWER9);\n\tSKIP_IF(!(pvr & PVR_POWER9_CUMULUS));\n\n\tSKIP_IF(!(3 - pvr_min));\n\n\treturn 0;\n}\n\n \n\nstatic int blacklisted_events(void)\n{\n\tstruct event event;\n\tint i = 0;\n\n\t \n\tSKIP_IF(platform_check_for_tests());\n\n\t \n\tSKIP_IF(check_for_power9_version());\n\n\t \n\tSKIP_IF(check_for_generic_compat_pmu());\n\n\tif (pvr_min == 1) {\n\t\tfor (i = 0; i < ARRAY_SIZE(blacklist_events_dd21); i++) {\n\t\t\tevent_init(&event, blacklist_events_dd21[i]);\n\t\t\tFAIL_IF(!event_open(&event));\n\t\t}\n\t} else if (pvr_min == 2) {\n\t\tfor (i = 0; i < ARRAY_SIZE(blacklist_events_dd22); i++) {\n\t\t\tevent_init(&event, blacklist_events_dd22[i]);\n\t\t\tFAIL_IF(!event_open(&event));\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nint main(void)\n{\n\treturn test_harness(blacklisted_events, \"blacklisted_events\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}