{
  "module_name": "multi_counter_test.c",
  "hash_id": "63d7cd6ca8e482e8289ccde9daa669a0f04dc3bac7e326b249d17c579868208e",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/pmu/ebb/multi_counter_test.c",
  "human_readable_source": "\n \n\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/ioctl.h>\n\n#include \"ebb.h\"\n\n\n \nint multi_counter(void)\n{\n\tstruct event events[6];\n\tint i, group_fd;\n\n\tSKIP_IF(!ebb_is_supported());\n\n\tevent_init_named(&events[0], 0x1001C, \"PM_CMPLU_STALL_THRD\");\n\tevent_init_named(&events[1], 0x2D016, \"PM_CMPLU_STALL_FXU\");\n\tevent_init_named(&events[2], 0x30006, \"PM_CMPLU_STALL_OTHER_CMPL\");\n\tevent_init_named(&events[3], 0x4000A, \"PM_CMPLU_STALL\");\n\tevent_init_named(&events[4], 0x600f4, \"PM_RUN_CYC\");\n\tevent_init_named(&events[5], 0x500fa, \"PM_RUN_INST_CMPL\");\n\n\tevent_leader_ebb_init(&events[0]);\n\tfor (i = 1; i < 6; i++)\n\t\tevent_ebb_init(&events[i]);\n\n\tgroup_fd = -1;\n\tfor (i = 0; i < 6; i++) {\n\t\tevents[i].attr.exclude_kernel = 1;\n\t\tevents[i].attr.exclude_hv = 1;\n\t\tevents[i].attr.exclude_idle = 1;\n\n\t\tFAIL_IF(event_open_with_group(&events[i], group_fd));\n\t\tif (group_fd == -1)\n\t\t\tgroup_fd = events[0].fd;\n\t}\n\n\tebb_enable_pmc_counting(1);\n\tebb_enable_pmc_counting(2);\n\tebb_enable_pmc_counting(3);\n\tebb_enable_pmc_counting(4);\n\tebb_enable_pmc_counting(5);\n\tebb_enable_pmc_counting(6);\n\tsetup_ebb_handler(standard_ebb_callee);\n\n\tFAIL_IF(ioctl(events[0].fd, PERF_EVENT_IOC_ENABLE, PERF_IOC_FLAG_GROUP));\n\tFAIL_IF(event_read(&events[0]));\n\n\tebb_global_enable();\n\n\tmtspr(SPRN_PMC1, pmc_sample_period(sample_period));\n\tmtspr(SPRN_PMC2, pmc_sample_period(sample_period));\n\tmtspr(SPRN_PMC3, pmc_sample_period(sample_period));\n\tmtspr(SPRN_PMC4, pmc_sample_period(sample_period));\n\tmtspr(SPRN_PMC5, pmc_sample_period(sample_period));\n\tmtspr(SPRN_PMC6, pmc_sample_period(sample_period));\n\n\twhile (ebb_state.stats.ebb_count < 50) {\n\t\tFAIL_IF(core_busy_loop());\n\t\tFAIL_IF(ebb_check_mmcr0());\n\t}\n\n\tebb_global_disable();\n\tebb_freeze_pmcs();\n\n\tdump_ebb_state();\n\n\tfor (i = 0; i < 6; i++)\n\t\tevent_close(&events[i]);\n\n\tFAIL_IF(ebb_state.stats.ebb_count == 0);\n\n\treturn 0;\n}\n\nint main(void)\n{\n\treturn test_harness(multi_counter, \"multi_counter\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}