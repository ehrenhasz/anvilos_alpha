{
  "module_name": "ebb_handler.S",
  "hash_id": "5dbc0cc1cc94d30b75174db943a7c89d07a2b3871218fc849d1d557edaec65e2",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/pmu/ebb/ebb_handler.S",
  "human_readable_source": " \n \n\n#include <ppc-asm.h>\n#include \"reg.h\"\n\n\n \n#define r1 1\n#define r2 2\n\n#define RFEBB   .long 0x4c000924\n\n \n\n#if defined(_CALL_ELF) && _CALL_ELF == 2\n#define ABIGAP\t\t512\n#else\n#define ABIGAP\t\t288\n#endif\n\n#define NR_GPR\t\t32\n#define NR_SPR\t\t6\n#define NR_VSR\t\t64\n\n#define SAVE_AREA\t((NR_GPR + NR_SPR) * 8 + (NR_VSR * 16))\n#define CALLER_FRAME\t112\n\n#define STACK_FRAME\t(ABIGAP + SAVE_AREA + CALLER_FRAME)\n\n#define CCR_SAVE\t(CALLER_FRAME)\n#define LR_SAVE\t\t(CCR_SAVE + 8)\n#define CTR_SAVE\t(LR_SAVE  + 8)\n#define XER_SAVE\t(CTR_SAVE + 8)\n#define GPR_SAVE(n)\t(XER_SAVE + 8 + (8 * n))\n#define FSCR_SAVE\t(GPR_SAVE(31) + 8)\n#define VSCR_SAVE\t(FSCR_SAVE + 8)\n#define VSR_SAVE(n)\t(VSCR_SAVE + 8 + (16 * n))\n\n#define SAVE_GPR(n)\tstd n,GPR_SAVE(n)(r1)\n#define REST_GPR(n)\tld  n,GPR_SAVE(n)(r1)\n#define TRASH_GPR(n)\tlis n,0xaaaa\n\n#define SAVE_VSR(n, b)\tli b, VSR_SAVE(n); stxvd2x n,b,r1\n#define LOAD_VSR(n, b)\tli b, VSR_SAVE(n); lxvd2x  n,b,r1\n\n#define LOAD_REG_IMMEDIATE(reg,expr)\t\\\n\tlis     reg,(expr)@highest;\t\\\n\tori     reg,reg,(expr)@higher;\t\\\n\trldicr  reg,reg,32,31;\t\t\\\n\toris    reg,reg,(expr)@h;\t\\\n\tori     reg,reg,(expr)@l;\n\n\n#if defined(_CALL_ELF) && _CALL_ELF == 2\n#define ENTRY_POINT(name) \\\n\t.type FUNC_NAME(name),@function; \\\n\t.globl FUNC_NAME(name); \\\n\tFUNC_NAME(name):\n\n#define RESTORE_TOC(name)\t\\\n\t \t\\\n\tLOAD_REG_IMMEDIATE(r12, name)\t\t\t\t\\\n0:\taddis\tr2,r12,(.TOC.-0b)@ha;\t\t\t\t\\\n\taddi\tr2,r2,(.TOC.-0b)@l;\n\n#else\n#define ENTRY_POINT(name) FUNC_START(name)\n#define RESTORE_TOC(name)\t\\\n\t \t\\\n\tLOAD_REG_IMMEDIATE(r2, name)\t\t\t\\\n\tld      r2,8(r2);\n#endif\n\n    .text\n\nENTRY_POINT(ebb_handler)\n    stdu    r1,-STACK_FRAME(r1)\n    SAVE_GPR(0)\n    mflr    r0\n    std     r0,LR_SAVE(r1)\n    mfcr    r0\n    std     r0,CCR_SAVE(r1)\n    mfctr   r0\n    std     r0,CTR_SAVE(r1)\n    mfxer   r0\n    std     r0,XER_SAVE(r1)\n    SAVE_GPR(2)\n    SAVE_GPR(3)\n    SAVE_GPR(4)\n    SAVE_GPR(5)\n    SAVE_GPR(6)\n    SAVE_GPR(7)\n    SAVE_GPR(8)\n    SAVE_GPR(9)\n    SAVE_GPR(10)\n    SAVE_GPR(11)\n    SAVE_GPR(12)\n    SAVE_GPR(13)\n    SAVE_GPR(14)\n    SAVE_GPR(15)\n    SAVE_GPR(16)\n    SAVE_GPR(17)\n    SAVE_GPR(18)\n    SAVE_GPR(19)\n    SAVE_GPR(20)\n    SAVE_GPR(21)\n    SAVE_GPR(22)\n    SAVE_GPR(23)\n    SAVE_GPR(24)\n    SAVE_GPR(25)\n    SAVE_GPR(26)\n    SAVE_GPR(27)\n    SAVE_GPR(28)\n    SAVE_GPR(29)\n    SAVE_GPR(30)\n    SAVE_GPR(31)\n    SAVE_VSR(0, r3)\n    mffs     f0\n    stfd     f0, FSCR_SAVE(r1)\n    mfvscr   f0\n    stfd     f0, VSCR_SAVE(r1)\n    SAVE_VSR(1,  r3)\n    SAVE_VSR(2,  r3)\n    SAVE_VSR(3,  r3)\n    SAVE_VSR(4,  r3)\n    SAVE_VSR(5,  r3)\n    SAVE_VSR(6,  r3)\n    SAVE_VSR(7,  r3)\n    SAVE_VSR(8,  r3)\n    SAVE_VSR(9,  r3)\n    SAVE_VSR(10, r3)\n    SAVE_VSR(11, r3)\n    SAVE_VSR(12, r3)\n    SAVE_VSR(13, r3)\n    SAVE_VSR(14, r3)\n    SAVE_VSR(15, r3)\n    SAVE_VSR(16, r3)\n    SAVE_VSR(17, r3)\n    SAVE_VSR(18, r3)\n    SAVE_VSR(19, r3)\n    SAVE_VSR(20, r3)\n    SAVE_VSR(21, r3)\n    SAVE_VSR(22, r3)\n    SAVE_VSR(23, r3)\n    SAVE_VSR(24, r3)\n    SAVE_VSR(25, r3)\n    SAVE_VSR(26, r3)\n    SAVE_VSR(27, r3)\n    SAVE_VSR(28, r3)\n    SAVE_VSR(29, r3)\n    SAVE_VSR(30, r3)\n    SAVE_VSR(31, r3)\n    SAVE_VSR(32, r3)\n    SAVE_VSR(33, r3)\n    SAVE_VSR(34, r3)\n    SAVE_VSR(35, r3)\n    SAVE_VSR(36, r3)\n    SAVE_VSR(37, r3)\n    SAVE_VSR(38, r3)\n    SAVE_VSR(39, r3)\n    SAVE_VSR(40, r3)\n    SAVE_VSR(41, r3)\n    SAVE_VSR(42, r3)\n    SAVE_VSR(43, r3)\n    SAVE_VSR(44, r3)\n    SAVE_VSR(45, r3)\n    SAVE_VSR(46, r3)\n    SAVE_VSR(47, r3)\n    SAVE_VSR(48, r3)\n    SAVE_VSR(49, r3)\n    SAVE_VSR(50, r3)\n    SAVE_VSR(51, r3)\n    SAVE_VSR(52, r3)\n    SAVE_VSR(53, r3)\n    SAVE_VSR(54, r3)\n    SAVE_VSR(55, r3)\n    SAVE_VSR(56, r3)\n    SAVE_VSR(57, r3)\n    SAVE_VSR(58, r3)\n    SAVE_VSR(59, r3)\n    SAVE_VSR(60, r3)\n    SAVE_VSR(61, r3)\n    SAVE_VSR(62, r3)\n    SAVE_VSR(63, r3)\n\n    TRASH_GPR(2)\n    TRASH_GPR(3)\n    TRASH_GPR(4)\n    TRASH_GPR(5)\n    TRASH_GPR(6)\n    TRASH_GPR(7)\n    TRASH_GPR(8)\n    TRASH_GPR(9)\n    TRASH_GPR(10)\n    TRASH_GPR(11)\n    TRASH_GPR(12)\n    TRASH_GPR(14)\n    TRASH_GPR(15)\n    TRASH_GPR(16)\n    TRASH_GPR(17)\n    TRASH_GPR(18)\n    TRASH_GPR(19)\n    TRASH_GPR(20)\n    TRASH_GPR(21)\n    TRASH_GPR(22)\n    TRASH_GPR(23)\n    TRASH_GPR(24)\n    TRASH_GPR(25)\n    TRASH_GPR(26)\n    TRASH_GPR(27)\n    TRASH_GPR(28)\n    TRASH_GPR(29)\n    TRASH_GPR(30)\n    TRASH_GPR(31)\n\n    RESTORE_TOC(ebb_handler)\n\n     \n\n    bl      ebb_hook\n    nop\n\n     \n\n    lfd      f0, FSCR_SAVE(r1)\n    mtfsf    0xff,f0\n    lfd      f0, VSCR_SAVE(r1)\n    mtvscr   f0\n    LOAD_VSR(0, r3)\n    LOAD_VSR(1,  r3)\n    LOAD_VSR(2,  r3)\n    LOAD_VSR(3,  r3)\n    LOAD_VSR(4,  r3)\n    LOAD_VSR(5,  r3)\n    LOAD_VSR(6,  r3)\n    LOAD_VSR(7,  r3)\n    LOAD_VSR(8,  r3)\n    LOAD_VSR(9,  r3)\n    LOAD_VSR(10, r3)\n    LOAD_VSR(11, r3)\n    LOAD_VSR(12, r3)\n    LOAD_VSR(13, r3)\n    LOAD_VSR(14, r3)\n    LOAD_VSR(15, r3)\n    LOAD_VSR(16, r3)\n    LOAD_VSR(17, r3)\n    LOAD_VSR(18, r3)\n    LOAD_VSR(19, r3)\n    LOAD_VSR(20, r3)\n    LOAD_VSR(21, r3)\n    LOAD_VSR(22, r3)\n    LOAD_VSR(23, r3)\n    LOAD_VSR(24, r3)\n    LOAD_VSR(25, r3)\n    LOAD_VSR(26, r3)\n    LOAD_VSR(27, r3)\n    LOAD_VSR(28, r3)\n    LOAD_VSR(29, r3)\n    LOAD_VSR(30, r3)\n    LOAD_VSR(31, r3)\n    LOAD_VSR(32, r3)\n    LOAD_VSR(33, r3)\n    LOAD_VSR(34, r3)\n    LOAD_VSR(35, r3)\n    LOAD_VSR(36, r3)\n    LOAD_VSR(37, r3)\n    LOAD_VSR(38, r3)\n    LOAD_VSR(39, r3)\n    LOAD_VSR(40, r3)\n    LOAD_VSR(41, r3)\n    LOAD_VSR(42, r3)\n    LOAD_VSR(43, r3)\n    LOAD_VSR(44, r3)\n    LOAD_VSR(45, r3)\n    LOAD_VSR(46, r3)\n    LOAD_VSR(47, r3)\n    LOAD_VSR(48, r3)\n    LOAD_VSR(49, r3)\n    LOAD_VSR(50, r3)\n    LOAD_VSR(51, r3)\n    LOAD_VSR(52, r3)\n    LOAD_VSR(53, r3)\n    LOAD_VSR(54, r3)\n    LOAD_VSR(55, r3)\n    LOAD_VSR(56, r3)\n    LOAD_VSR(57, r3)\n    LOAD_VSR(58, r3)\n    LOAD_VSR(59, r3)\n    LOAD_VSR(60, r3)\n    LOAD_VSR(61, r3)\n    LOAD_VSR(62, r3)\n    LOAD_VSR(63, r3)\n\n    ld      r0,XER_SAVE(r1)\n    mtxer   r0\n    ld      r0,CTR_SAVE(r1)\n    mtctr   r0\n    ld      r0,LR_SAVE(r1)\n    mtlr    r0\n    ld      r0,CCR_SAVE(r1)\n    mtcr    r0\n    REST_GPR(0)\n    REST_GPR(2)\n    REST_GPR(3)\n    REST_GPR(4)\n    REST_GPR(5)\n    REST_GPR(6)\n    REST_GPR(7)\n    REST_GPR(8)\n    REST_GPR(9)\n    REST_GPR(10)\n    REST_GPR(11)\n    REST_GPR(12)\n    REST_GPR(13)\n    REST_GPR(14)\n    REST_GPR(15)\n    REST_GPR(16)\n    REST_GPR(17)\n    REST_GPR(18)\n    REST_GPR(19)\n    REST_GPR(20)\n    REST_GPR(21)\n    REST_GPR(22)\n    REST_GPR(23)\n    REST_GPR(24)\n    REST_GPR(25)\n    REST_GPR(26)\n    REST_GPR(27)\n    REST_GPR(28)\n    REST_GPR(29)\n    REST_GPR(30)\n    REST_GPR(31)\n    addi    r1,r1,STACK_FRAME\n    RFEBB\nFUNC_END(ebb_handler)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}