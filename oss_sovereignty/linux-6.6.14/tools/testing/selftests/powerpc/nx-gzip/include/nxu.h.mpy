{
  "module_name": "nxu.h",
  "hash_id": "2c1df8fc8ad8f930d4569ace7dea5d2820c40aa0310123aa0ed4602f4ff52211",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/nx-gzip/include/nxu.h",
  "human_readable_source": " \n \n\n#ifndef _NXU_H\n#define _NXU_H\n\n#include <stdint.h>\n#include <endian.h>\n#include \"nx.h\"\n\n \n#define LLSZ   286\n#define DSZ    30\n\n \n#define DHTSZ  18\n#define DHT_MAXSZ 288\n#define MAX_DDE_COUNT 256\n\n \n#ifdef NXDBG\n#define NXPRT(X)\tX\n#else\n#define NXPRT(X)\n#endif\n\n#ifdef NXTIMER\n#include <sys/platform/ppc.h>\n#define NX_CLK(X)\tX\n#define nx_get_time()\t__ppc_get_timebase()\n#define nx_get_freq()\t__ppc_get_timebase_freq()\n#else\n#define NX_CLK(X)\n#define nx_get_time()  (-1)\n#define nx_get_freq()  (-1)\n#endif\n\n#define NX_MAX_FAULTS  500\n\n \n\nunion nx_qw_t {\n\tuint32_t word[4];\n\tuint64_t dword[2];\n} __aligned(16);\n\n \n\nstruct nx_dde_t {\n\t \n\tunion {\n\t\tuint32_t dde_count;\n\t\t \n\t};\n\tuint32_t ddebc;  \n\tuint64_t ddead;  \n} __aligned(16);\n\nstruct nx_csb_t {\n\t \n\tunion {\n\t\tuint32_t csb_v;\n\t\t \n\n\t\tuint32_t csb_f;\n\t\t \n\n\t\tuint32_t csb_cs;\n\t\t \n\n\t\tuint32_t csb_cc;\n\t\t \n\n\t\tuint32_t csb_ce;\n\t\t \n\n\t};\n\tuint32_t tpbc;\n\t \n\n\tuint64_t fsaddr;\n\t \n} __aligned(16);\n\nstruct nx_ccb_t {\n\t \n\n\tuint32_t reserved[3];\n\tunion {\n\t\t \n\n\t\tuint32_t ccb_cm;\n\t\t \n\n\t\tuint32_t word;\n\t\t \n\t};\n} __aligned(16);\n\nstruct vas_stamped_crb_t {\n\t \n\n\tunion {\n\t\tuint32_t vas_buf_num;\n\t\t \n\n\t\tuint32_t send_wc_id;\n\t\t \n\n\t};\n\tunion {\n\t\tuint32_t recv_wc_id;\n\t\t \n\n\t};\n\tuint32_t reserved2;\n\tunion {\n\t\tuint32_t vas_invalid;\n\t\t \n\n\t};\n};\n\nstruct nx_stamped_fault_crb_t {\n\t \n\tuint64_t fsa;\n\tunion {\n\t\tuint32_t nxsf_t;\n\t\tuint32_t nxsf_fs;\n\t};\n\tuint32_t pswid;\n};\n\nunion stamped_crb_t {\n\tstruct vas_stamped_crb_t      vas;\n\tstruct nx_stamped_fault_crb_t nx;\n};\n\nstruct nx_gzip_cpb_t {\n\t \n\n\t \n\n\tstruct {\n\t\tunion {\n\t\tunion nx_qw_t qw0;\n\t\t\tstruct {\n\t\t\t\tuint32_t in_adler;             \n\t\t\t\tuint32_t in_crc;               \n\t\t\t\tunion {\n\t\t\t\t\tuint32_t in_histlen;   \n\t\t\t\t\tuint32_t in_subc;      \n\t\t\t\t};\n\t\t\t\tunion {\n\t\t\t\t\t \n\t\t\t\t\tuint32_t in_sfbt;\n\t\t\t\t\t \n\t\t\t\t\tuint32_t in_rembytecnt;\n\t\t\t\t\t \n\t\t\t\t\tuint32_t in_dhtlen;\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\tunion {\n\t\t\tunion nx_qw_t  in_dht[DHTSZ];\t \n\t\t\tchar in_dht_char[DHT_MAXSZ];\t \n\t\t};\n\t\tunion nx_qw_t  reserved[5];\t\t \n\t};\n\n\t \n\n\tvolatile struct {\n\t\tunion {\n\t\t\tunion nx_qw_t qw24;\n\t\t\tstruct {\n\t\t\t\tuint32_t out_adler;     \n\t\t\t\tuint32_t out_crc;       \n\t\t\t\tunion {\n\t\t\t\t\t \n\t\t\t\t\tuint32_t out_tebc;\n\t\t\t\t\t \n\t\t\t\t\tuint32_t out_subc;\n\t\t\t\t};\n\t\t\t\tunion {\n\t\t\t\t\t \n\t\t\t\t\tuint32_t out_sfbt;\n\t\t\t\t\t \n\t\t\t\t\tuint32_t out_rembytecnt;\n\t\t\t\t\t \n\t\t\t\t\tuint32_t out_dhtlen;\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\tunion {\n\t\t\tunion nx_qw_t  qw25[79];         \n\t\t\t \n\t\t\tuint32_t out_spbc_comp_wrap;\n\t\t\tuint32_t out_spbc_wrap;          \n\t\t\t \n\t\t\tuint32_t out_spbc_comp;\n\t\t\t  \n\t\t\tuint32_t out_lzcount[LLSZ+DSZ];\n\t\t\tstruct {\n\t\t\t\tunion nx_qw_t  out_dht[DHTSZ];   \n\t\t\t\t \n\t\t\t\tuint32_t out_spbc_decomp;\n\t\t\t};\n\t\t};\n\t\t \n\t\tuint32_t out_spbc_comp_with_count;\n\t};\n} __aligned(128);\n\nstruct nx_gzip_crb_t {\n\tunion {                    \n\t\tuint32_t gzip_fc;      \n\t};\n\tuint32_t reserved1;        \n\tunion {\n\t\tuint64_t csb_address;  \n\t\tstruct {\n\t\t\tuint32_t reserved2;\n\t\t\tunion {\n\t\t\t\tuint32_t crb_c;\n\t\t\t\t \n\n\t\t\t\tuint32_t crb_at;\n\t\t\t\t \n\n\t\t\t};\n\t\t};\n\t};\n\tstruct nx_dde_t source_dde;            \n\tstruct nx_dde_t target_dde;            \n\tvolatile struct nx_ccb_t ccb;          \n\tvolatile union {\n\t\t \n\t\tunion nx_qw_t reserved64[11];\n\t\tunion stamped_crb_t stamp;        \n\t};\n\tvolatile struct nx_csb_t csb;\n} __aligned(128);\n\nstruct nx_gzip_crb_cpb_t {\n\tstruct nx_gzip_crb_t crb;\n\tstruct nx_gzip_cpb_t cpb;\n} __aligned(2048);\n\n\n \n\n#define size_mask(x)          ((1U<<(x))-1)\n\n \n\n#define dde_count_mask        size_mask(8)\n#define dde_count_offset      23\n\n \n\n#define csb_v_mask            size_mask(1)\n#define csb_v_offset          0\n#define csb_f_mask            size_mask(1)\n#define csb_f_offset          6\n#define csb_cs_mask           size_mask(8)\n#define csb_cs_offset         15\n#define csb_cc_mask           size_mask(8)\n#define csb_cc_offset         23\n#define csb_ce_mask           size_mask(8)\n#define csb_ce_offset         31\n\n \n\n#define ccb_cm_mask           size_mask(3)\n#define ccb_cm_offset         31\n\n \n\n#define vas_buf_num_mask      size_mask(6)\n#define vas_buf_num_offset    5\n#define send_wc_id_mask       size_mask(16)\n#define send_wc_id_offset     31\n#define recv_wc_id_mask       size_mask(16)\n#define recv_wc_id_offset     31\n#define vas_invalid_mask      size_mask(1)\n#define vas_invalid_offset    31\n\n \n\n#define nxsf_t_mask           size_mask(1)\n#define nxsf_t_offset         23\n#define nxsf_fs_mask          size_mask(8)\n#define nxsf_fs_offset        31\n\n \n\n#define in_histlen_mask       size_mask(12)\n#define in_histlen_offset     11\n#define in_dhtlen_mask        size_mask(12)\n#define in_dhtlen_offset      31\n#define in_subc_mask          size_mask(3)\n#define in_subc_offset        31\n#define in_sfbt_mask          size_mask(4)\n#define in_sfbt_offset        15\n#define in_rembytecnt_mask    size_mask(16)\n#define in_rembytecnt_offset  31\n\n \n\n#define out_tebc_mask         size_mask(3)\n#define out_tebc_offset       15\n#define out_subc_mask         size_mask(16)\n#define out_subc_offset       31\n#define out_sfbt_mask         size_mask(4)\n#define out_sfbt_offset       15\n#define out_rembytecnt_mask   size_mask(16)\n#define out_rembytecnt_offset 31\n#define out_dhtlen_mask       size_mask(12)\n#define out_dhtlen_offset     31\n\n \n\n#define gzip_fc_mask          size_mask(8)\n#define gzip_fc_offset        31\n#define crb_c_mask            size_mask(1)\n#define crb_c_offset          28\n#define crb_at_mask           size_mask(1)\n#define crb_at_offset         30\n#define csb_address_mask      ~(15UL)  \n\n \n\n#define getnn(ST, REG)      ((be32toh(ST.REG) >> (31-REG##_offset)) \\\n\t\t\t\t & REG##_mask)\n#define getpnn(ST, REG)     ((be32toh((ST)->REG) >> (31-REG##_offset)) \\\n\t\t\t\t & REG##_mask)\n#define get32(ST, REG)      (be32toh(ST.REG))\n#define getp32(ST, REG)     (be32toh((ST)->REG))\n#define get64(ST, REG)      (be64toh(ST.REG))\n#define getp64(ST, REG)     (be64toh((ST)->REG))\n\n#define unget32(ST, REG)    (get32(ST, REG) & ~((REG##_mask) \\\n\t\t\t\t<< (31-REG##_offset)))\n \n\n#define ungetp32(ST, REG)   (getp32(ST, REG) & ~((REG##_mask) \\\n\t\t\t\t<< (31-REG##_offset)))\n \n\n#define clear_regs(ST)      memset((void *)(&(ST)), 0, sizeof(ST))\n#define clear_dde(ST)       do { ST.dde_count = ST.ddebc = 0; ST.ddead = 0; \\\n\t\t\t\t} while (0)\n#define clearp_dde(ST)      do { (ST)->dde_count = (ST)->ddebc = 0; \\\n\t\t\t\t (ST)->ddead = 0; \\\n\t\t\t\t} while (0)\n#define clear_struct(ST)    memset((void *)(&(ST)), 0, sizeof(ST))\n#define putnn(ST, REG, X)   (ST.REG = htobe32(unget32(ST, REG) | (((X) \\\n\t\t\t\t & REG##_mask) << (31-REG##_offset))))\n#define putpnn(ST, REG, X)  ((ST)->REG = htobe32(ungetp32(ST, REG) \\\n\t\t\t\t| (((X) & REG##_mask) << (31-REG##_offset))))\n\n#define put32(ST, REG, X)   (ST.REG = htobe32(X))\n#define putp32(ST, REG, X)  ((ST)->REG = htobe32(X))\n#define put64(ST, REG, X)   (ST.REG = htobe64(X))\n#define putp64(ST, REG, X)  ((ST)->REG = htobe64(X))\n\n \n\n#define get_csb_ce(ST) ((uint32_t)getnn(ST, csb_ce))\n#define get_csb_ce_ms3b(ST) (get_csb_ce(ST) >> 5)\n#define put_csb_ce_ms3b(ST, X) putnn(ST, csb_ce, ((uint32_t)(X) << 5))\n\n#define CSB_CE_PARTIAL         0x4\n#define CSB_CE_TERMINATE       0x2\n#define CSB_CE_TPBC_VALID      0x1\n\n#define csb_ce_termination(X)         (!!((X) & CSB_CE_TERMINATE))\n \n\n#define csb_ce_check_completion(X)    (!csb_ce_termination(X))\n \n\n#define csb_ce_partial_completion(X)  (!!((X) & CSB_CE_PARTIAL))\n#define csb_ce_full_completion(X)     (!csb_ce_partial_completion(X))\n#define csb_ce_tpbc_valid(X)          (!!((X) & CSB_CE_TPBC_VALID))\n \n\n#define csb_ce_default_err(X)         csb_ce_termination(X)\n \n\n#define csb_ce_cc3_partial(X)         csb_ce_partial_completion(X)\n \n\n#define csb_ce_cc64(X)                ((X)&(CSB_CE_PARTIAL \\\n\t\t\t\t\t| CSB_CE_TERMINATE) == 0)\n \n\n \n\n#define SFBT_BFINAL 0x1\n#define SFBT_LIT    0x4\n#define SFBT_FHT    0x5\n#define SFBT_DHT    0x6\n#define SFBT_HDR    0x7\n\n \n\n#define GZIP_FC_LIMIT_MASK                               0x01\n#define GZIP_FC_COMPRESS_FHT                             0x00\n#define GZIP_FC_COMPRESS_DHT                             0x02\n#define GZIP_FC_COMPRESS_FHT_COUNT                       0x04\n#define GZIP_FC_COMPRESS_DHT_COUNT                       0x06\n#define GZIP_FC_COMPRESS_RESUME_FHT                      0x08\n#define GZIP_FC_COMPRESS_RESUME_DHT                      0x0a\n#define GZIP_FC_COMPRESS_RESUME_FHT_COUNT                0x0c\n#define GZIP_FC_COMPRESS_RESUME_DHT_COUNT                0x0e\n#define GZIP_FC_DECOMPRESS                               0x10\n#define GZIP_FC_DECOMPRESS_SINGLE_BLK_N_SUSPEND          0x12\n#define GZIP_FC_DECOMPRESS_RESUME                        0x14\n#define GZIP_FC_DECOMPRESS_RESUME_SINGLE_BLK_N_SUSPEND   0x16\n#define GZIP_FC_WRAP                                     0x1e\n\n#define fc_is_compress(fc)  (((fc) & 0x10) == 0)\n#define fc_has_count(fc)    (fc_is_compress(fc) && (((fc) & 0x4) != 0))\n\n \n\n#define ERR_NX_OK             0\n#define ERR_NX_ALIGNMENT      1\n#define ERR_NX_OPOVERLAP      2\n#define ERR_NX_DATA_LENGTH    3\n#define ERR_NX_TRANSLATION    5\n#define ERR_NX_PROTECTION     6\n#define ERR_NX_EXTERNAL_UE7   7\n#define ERR_NX_INVALID_OP     8\n#define ERR_NX_PRIVILEGE      9\n#define ERR_NX_INTERNAL_UE   10\n#define ERR_NX_EXTERN_UE_WR  12\n#define ERR_NX_TARGET_SPACE  13\n#define ERR_NX_EXCESSIVE_DDE 14\n#define ERR_NX_TRANSL_WR     15\n#define ERR_NX_PROTECT_WR    16\n#define ERR_NX_SUBFUNCTION   17\n#define ERR_NX_FUNC_ABORT    18\n#define ERR_NX_BYTE_MAX      19\n#define ERR_NX_CORRUPT_CRB   20\n#define ERR_NX_INVALID_CRB   21\n#define ERR_NX_INVALID_DDE   30\n#define ERR_NX_SEGMENTED_DDL 31\n#define ERR_NX_DDE_OVERFLOW  33\n#define ERR_NX_TPBC_GT_SPBC  64\n#define ERR_NX_MISSING_CODE  66\n#define ERR_NX_INVALID_DIST  67\n#define ERR_NX_INVALID_DHT   68\n#define ERR_NX_EXTERNAL_UE90 90\n#define ERR_NX_WDOG_TIMER   224\n#define ERR_NX_AT_FAULT     250\n#define ERR_NX_INTR_SERVER  252\n#define ERR_NX_UE253        253\n#define ERR_NX_NO_HW        254\n#define ERR_NX_HUNG_OP      255\n#define ERR_NX_END          256\n\n \n#define INIT_CRC   0   \n#define INIT_ADLER 1   \n\n \nint nxu_submit_job(struct nx_gzip_crb_cpb_t *c, void *handle);\n\nextern void nxu_sigsegv_handler(int sig, siginfo_t *info, void *ctx);\nextern int nxu_touch_pages(void *buf, long buf_len, long page_len, int wr);\n\n \n\nchar *nx_crb_str(struct nx_gzip_crb_t *crb, char *prbuf);\nchar *nx_cpb_str(struct nx_gzip_cpb_t *cpb, char *prbuf);\nchar *nx_prt_hex(void *cp, int sz, char *prbuf);\nchar *nx_lzcount_str(struct nx_gzip_cpb_t *cpb, char *prbuf);\nchar *nx_strerror(int e);\n\n#ifdef NX_SIM\n#include <stdio.h>\nint nx_sim_init(void *ctx);\nint nx_sim_end(void *ctx);\nint nxu_run_sim_job(struct nx_gzip_crb_cpb_t *c, void *ctx);\n#endif  \n\n \n\n#define set_final_bit(x)\t(x |= (unsigned char)1)\n#define clr_final_bit(x)\t(x &= ~(unsigned char)1)\n\n#define append_empty_fh_blk(p, b) do { *(p) = (2 | (1&(b))); *((p)+1) = 0; \\\n\t\t\t\t\t} while (0)\n \n\n\n#ifdef NX_842\n\n \n\nstruct nx_eft_crb_t {\n\tunion {                    \n\t\tuint32_t eft_fc;       \n\t};\n\tuint32_t reserved1;        \n\tunion {\n\t\tuint64_t csb_address;  \n\t\tstruct {\n\t\t\tuint32_t reserved2;\n\t\t\tunion {\n\t\t\t\tuint32_t crb_c;\n\t\t\t\t \n\n\t\t\t\tuint32_t crb_at;\n\t\t\t\t \n\n\t\t\t};\n\t\t};\n\t};\n\tstruct nx_dde_t source_dde;            \n\tstruct nx_dde_t target_dde;            \n\tstruct nx_ccb_t ccb;                   \n\tunion {\n\t\tunion nx_qw_t reserved64[3];      \n\t};\n\tstruct nx_csb_t csb;\n} __aligned(128);\n\n \n\n#define EFT_FC_MASK                 size_mask(3)\n#define EFT_FC_OFFSET               31\n#define EFT_FC_COMPRESS             0x0\n#define EFT_FC_COMPRESS_WITH_CRC    0x1\n#define EFT_FC_DECOMPRESS           0x2\n#define EFT_FC_DECOMPRESS_WITH_CRC  0x3\n#define EFT_FC_BLK_DATA_MOVE        0x4\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}