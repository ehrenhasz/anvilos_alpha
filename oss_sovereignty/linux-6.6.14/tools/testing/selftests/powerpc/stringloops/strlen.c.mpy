{
  "module_name": "strlen.c",
  "hash_id": "bc45a55a66b3d9a5d9d5ea39543229d4ac68c8c822cdb08c68bbe13d1e8540e2",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/stringloops/strlen.c",
  "human_readable_source": "\n#include <malloc.h>\n#include <stdlib.h>\n#include <string.h>\n#include <time.h>\n#include \"utils.h\"\n\n#define SIZE 256\n#define ITERATIONS 1000\n#define ITERATIONS_BENCH 100000\n\nint test_strlen(const void *s);\n\n \nstatic void test_one(char *s)\n{\n\tunsigned long offset;\n\n\tfor (offset = 0; offset < SIZE; offset++) {\n\t\tint x, y;\n\t\tunsigned long i;\n\n\t\ty = strlen(s + offset);\n\t\tx = test_strlen(s + offset);\n\n\t\tif (x != y) {\n\t\t\tprintf(\"strlen() returned %d, should have returned %d (%p offset %ld)\\n\", x, y, s, offset);\n\n\t\t\tfor (i = offset; i < SIZE; i++)\n\t\t\t\tprintf(\"%02x \", s[i]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n}\n\nstatic void bench_test(char *s)\n{\n\tstruct timespec ts_start, ts_end;\n\tint i;\n\n\tclock_gettime(CLOCK_MONOTONIC, &ts_start);\n\n\tfor (i = 0; i < ITERATIONS_BENCH; i++)\n\t\ttest_strlen(s);\n\n\tclock_gettime(CLOCK_MONOTONIC, &ts_end);\n\n\tprintf(\"len %3.3d : time = %.6f\\n\", test_strlen(s), ts_end.tv_sec - ts_start.tv_sec + (ts_end.tv_nsec - ts_start.tv_nsec) / 1e9);\n}\n\nstatic int testcase(void)\n{\n\tchar *s;\n\tunsigned long i;\n\n\ts = memalign(128, SIZE);\n\tif (!s) {\n\t\tperror(\"memalign\");\n\t\texit(1);\n\t}\n\n\tsrandom(1);\n\n\tmemset(s, 0, SIZE);\n\tfor (i = 0; i < SIZE; i++) {\n\t\tchar c;\n\n\t\tdo {\n\t\t\tc = random() & 0x7f;\n\t\t} while (!c);\n\t\ts[i] = c;\n\t\ttest_one(s);\n\t}\n\n\tfor (i = 0; i < ITERATIONS; i++) {\n\t\tunsigned long j;\n\n\t\tfor (j = 0; j < SIZE; j++) {\n\t\t\tchar c;\n\n\t\t\tdo {\n\t\t\t\tc = random() & 0x7f;\n\t\t\t} while (!c);\n\t\t\ts[j] = c;\n\t\t}\n\t\tfor (j = 0; j < sizeof(long); j++) {\n\t\t\ts[SIZE - 1 - j] = 0;\n\t\t\ttest_one(s);\n\t\t}\n\t}\n\n\tfor (i = 0; i < SIZE; i++) {\n\t\tchar c;\n\n\t\tdo {\n\t\t\tc = random() & 0x7f;\n\t\t} while (!c);\n\t\ts[i] = c;\n\t}\n\n\tbench_test(s);\n\n\ts[16] = 0;\n\tbench_test(s);\n\n\ts[8] = 0;\n\tbench_test(s);\n\n\ts[4] = 0;\n\tbench_test(s);\n\n\ts[3] = 0;\n\tbench_test(s);\n\n\ts[2] = 0;\n\tbench_test(s);\n\n\ts[1] = 0;\n\tbench_test(s);\n\n\treturn 0;\n}\n\nint main(void)\n{\n\treturn test_harness(testcase, \"strlen\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}