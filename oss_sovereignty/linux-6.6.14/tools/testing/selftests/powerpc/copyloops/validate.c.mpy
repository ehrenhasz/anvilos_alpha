{
  "module_name": "validate.c",
  "hash_id": "a515f5754e1cb3144c5668add6e7f330c49b2cde86d669065c06f648d618d43a",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/copyloops/validate.c",
  "human_readable_source": "\n#include <malloc.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdbool.h>\n\n#include \"utils.h\"\n\n#define MAX_LEN 8192\n#define MAX_OFFSET 16\n#define MIN_REDZONE 128\n#define BUFLEN (MAX_LEN+MAX_OFFSET+2*MIN_REDZONE)\n#define POISON 0xa5\n\nunsigned long COPY_LOOP(void *to, const void *from, unsigned long size);\n\nstatic void do_one(char *src, char *dst, unsigned long src_off,\n\t\t   unsigned long dst_off, unsigned long len, void *redzone,\n\t\t   void *fill)\n{\n\tchar *srcp, *dstp;\n\tunsigned long ret;\n\tunsigned long i;\n\n\tsrcp = src + MIN_REDZONE + src_off;\n\tdstp = dst + MIN_REDZONE + dst_off;\n\n\tmemset(src, POISON, BUFLEN);\n\tmemset(dst, POISON, BUFLEN);\n\tmemcpy(srcp, fill, len);\n\n\tret = COPY_LOOP(dstp, srcp, len);\n\tif (ret && ret != (unsigned long)dstp) {\n\t\tprintf(\"(%p,%p,%ld) returned %ld\\n\", dstp, srcp, len, ret);\n\t\tabort();\n\t}\n\n\tif (memcmp(dstp, srcp, len)) {\n\t\tprintf(\"(%p,%p,%ld) miscompare\\n\", dstp, srcp, len);\n\t\tprintf(\"src: \");\n\t\tfor (i = 0; i < len; i++)\n\t\t\tprintf(\"%02x \", srcp[i]);\n\t\tprintf(\"\\ndst: \");\n\t\tfor (i = 0; i < len; i++)\n\t\t\tprintf(\"%02x \", dstp[i]);\n\t\tprintf(\"\\n\");\n\t\tabort();\n\t}\n\n\tif (memcmp(dst, redzone, dstp - dst)) {\n\t\tprintf(\"(%p,%p,%ld) redzone before corrupted\\n\",\n\t\t       dstp, srcp, len);\n\t\tabort();\n\t}\n\n\tif (memcmp(dstp+len, redzone, dst+BUFLEN-(dstp+len))) {\n\t\tprintf(\"(%p,%p,%ld) redzone after corrupted\\n\",\n\t\t       dstp, srcp, len);\n\t\tabort();\n\t}\n}\n\nint test_copy_loop(void)\n{\n\tchar *src, *dst, *redzone, *fill;\n\tunsigned long len, src_off, dst_off;\n\tunsigned long i;\n\n\tsrc = memalign(BUFLEN, BUFLEN);\n\tdst = memalign(BUFLEN, BUFLEN);\n\tredzone = malloc(BUFLEN);\n\tfill = malloc(BUFLEN);\n\n\tif (!src || !dst || !redzone || !fill) {\n\t\tfprintf(stderr, \"malloc failed\\n\");\n\t\texit(1);\n\t}\n\n\tmemset(redzone, POISON, BUFLEN);\n\n\t \n\tfor (i = 0; i < BUFLEN; i++)\n\t\tfill[i] = i & 0xff;\n\n\tfor (len = 1; len < MAX_LEN; len++) {\n\t\tfor (src_off = 0; src_off < MAX_OFFSET; src_off++) {\n\t\t\tfor (dst_off = 0; dst_off < MAX_OFFSET; dst_off++) {\n\t\t\t\tdo_one(src, dst, src_off, dst_off, len,\n\t\t\t\t       redzone, fill);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nint main(void)\n{\n\treturn test_harness(test_copy_loop, str(COPY_LOOP));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}