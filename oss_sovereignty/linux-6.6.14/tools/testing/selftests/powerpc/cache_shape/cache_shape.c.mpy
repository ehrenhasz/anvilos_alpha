{
  "module_name": "cache_shape.c",
  "hash_id": "c385525facdc554fe19872afe7ab8c4deceebd87d142c772ac1db5cddf251db8",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/powerpc/cache_shape/cache_shape.c",
  "human_readable_source": "\n \n\n#include <elf.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <link.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <unistd.h>\n\n#include \"utils.h\"\n\n#ifndef AT_L1I_CACHESIZE\n#define AT_L1I_CACHESIZE\t40\n#define AT_L1I_CACHEGEOMETRY\t41\n#define AT_L1D_CACHESIZE\t42\n#define AT_L1D_CACHEGEOMETRY\t43\n#define AT_L2_CACHESIZE\t\t44\n#define AT_L2_CACHEGEOMETRY\t45\n#define AT_L3_CACHESIZE\t\t46\n#define AT_L3_CACHEGEOMETRY\t47\n#endif\n\nstatic void print_size(const char *label, uint32_t val)\n{\n\tprintf(\"%s cache size: %#10x %10dB %10dK\\n\", label, val, val, val / 1024);\n}\n\nstatic void print_geo(const char *label, uint32_t val)\n{\n\tuint16_t assoc;\n\n\tprintf(\"%s line size:  %#10x       \", label, val & 0xFFFF);\n\n\tassoc = val >> 16;\n\tif (assoc)\n\t\tprintf(\"%u-way\", assoc);\n\telse\n\t\tprintf(\"fully\");\n\n\tprintf(\" associative\\n\");\n}\n\nstatic int test_cache_shape()\n{\n\tstatic char buffer[4096];\n\tElfW(auxv_t) *p;\n\tint found;\n\n\tFAIL_IF(read_auxv(buffer, sizeof(buffer)));\n\n\tfound = 0;\n\n\tp = find_auxv_entry(AT_L1I_CACHESIZE, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_size(\"L1I \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L1I_CACHEGEOMETRY, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_geo(\"L1I \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L1D_CACHESIZE, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_size(\"L1D \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L1D_CACHEGEOMETRY, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_geo(\"L1D \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L2_CACHESIZE, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_size(\"L2  \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L2_CACHEGEOMETRY, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_geo(\"L2  \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L3_CACHESIZE, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_size(\"L3  \", (uint32_t)p->a_un.a_val);\n\t}\n\n\tp = find_auxv_entry(AT_L3_CACHEGEOMETRY, buffer);\n\tif (p) {\n\t\tfound++;\n\t\tprint_geo(\"L3  \", (uint32_t)p->a_un.a_val);\n\t}\n\n\t \n\tSKIP_IF(found == 0);\n\n\t \n\tFAIL_IF(found != 8);\n\n\treturn 0;\n}\n\nint main(void)\n{\n\treturn test_harness(test_cache_shape, \"cache_shape\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}