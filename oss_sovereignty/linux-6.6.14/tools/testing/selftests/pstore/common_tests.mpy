{
  "module_name": "common_tests",
  "hash_id": "6571bc305a3dc64656776a8e604acc9073b99928a9ea8dfa27afa6289dcc69ae",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/pstore/common_tests",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0-only\n\n# common_tests - Shell script commonly used by pstore test scripts\n#\n# Copyright (C) Hitachi Ltd., 2015\n#  Written by Hiraku Toyooka <hiraku.toyooka.gu@hitachi.com>\n#\n\n# Utilities\nerrexit() { # message\n    echo \"Error: $1\" 1>&2\n    exit 1\n}\n\nabsdir() { # file_path\n    (cd `dirname $1`; pwd)\n}\n\nshow_result() { # result_value\n    if [ $1 -eq 0 ]; then\n\tprlog \"ok\"\n    else\n\tprlog \"FAIL\"\n\trc=1\n    fi\n}\n\ncheck_files_exist() { # type of pstorefs file\n    if [ -e ${1}-${backend}-0 ]; then\n\tprlog \"ok\"\n\tfor f in `ls ${1}-${backend}-*`; do\n            prlog -e \"\\t${f}\"\n\tdone\n    else\n\tprlog \"FAIL\"\n\trc=1\n    fi\n}\n\noperate_files() { # tested value, files, operation\n    if [ $1 -eq 0 ]; then\n\tprlog\n\tfor f in $2; do\n\t    prlog -ne \"\\t${f} ... \"\n\t    # execute operation\n\t    $3 $f\n\t    show_result $?\n\tdone\n    else\n\tprlog \" ... FAIL\"\n\trc=1\n    fi\n}\n\n# Parameters\nTEST_STRING_PATTERN=\"Testing pstore: uuid=\"\nUUID=`cat /proc/sys/kernel/random/uuid`\nTOP_DIR=`absdir $0`\nLOG_DIR=$TOP_DIR/logs/`date +%Y%m%d-%H%M%S`_${UUID}/\nREBOOT_FLAG=$TOP_DIR/reboot_flag\n\n# Preparing logs\nLOG_FILE=$LOG_DIR/`basename $0`.log\nmkdir -p $LOG_DIR || errexit \"Failed to make a log directory: $LOG_DIR\"\ndate > $LOG_FILE\nprlog() { # messages\n    /bin/echo \"$@\" | tee -a $LOG_FILE\n}\n\n# Starting tests\nrc=0\nprlog \"=== Pstore unit tests (`basename $0`) ===\"\nprlog \"UUID=\"$UUID\n\nprlog -n \"Checking pstore backend is registered ... \"\nbackend=`cat /sys/module/pstore/parameters/backend`\nshow_result $?\nprlog -e \"\\tbackend=${backend}\"\nprlog -e \"\\tcmdline=`cat /proc/cmdline`\"\nif [ $rc -ne 0 ]; then\n    exit 1\nfi\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}