{
  "module_name": "pstore_post_reboot_tests",
  "hash_id": "ebf0cada08e6f3b1bf0b4d5d134b0a5b3b1fc2af013b509b37f24732eddc9133",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/pstore/pstore_post_reboot_tests",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0-only\n\n# pstore_post_reboot_tests - Check pstore's behavior after crash/reboot\n#\n# Copyright (C) Hitachi Ltd., 2015\n#  Written by Hiraku Toyooka <hiraku.toyooka.gu@hitachi.com>\n#\n\n# Kselftest framework requirement - SKIP code is 4.\nksft_skip=4\n\n. ./common_tests\n\nif [ -e $REBOOT_FLAG  ]; then\n    rm $REBOOT_FLAG\nelse\n    prlog \"pstore_crash_test has not been executed yet. we skip further tests.\"\n    exit $ksft_skip\nfi\n\nprlog -n \"Mounting pstore filesystem ... \"\nmount_info=`grep pstore /proc/mounts`\nif [ $? -eq 0 ]; then\n    mount_point=`echo ${mount_info} | cut -d' ' -f2 | head -n1`\n    prlog \"ok\"\nelse\n    mount none /sys/fs/pstore -t pstore\n    if [ $? -eq 0 ]; then\n\tmount_point=`grep pstore /proc/mounts | cut -d' ' -f2 | head -n1`\n\tprlog \"ok\"\n    else\n\tprlog \"FAIL\"\n\texit 1\n    fi\nfi\n\ncd ${mount_point}\n\nprlog -n \"Checking dmesg files exist in pstore filesystem ... \"\ncheck_files_exist dmesg\n\nprlog -n \"Checking console files exist in pstore filesystem ... \"\ncheck_files_exist console\n\nprlog -n \"Checking pmsg files exist in pstore filesystem ... \"\ncheck_files_exist pmsg\n\nprlog -n \"Checking dmesg files contain oops end marker\"\ngrep_end_trace() {\n    grep -q \"\\---\\[ end trace\" $1\n}\nfiles=`ls dmesg-${backend}-*`\noperate_files $? \"$files\" grep_end_trace\n\nprlog -n \"Checking console file contains oops end marker ... \"\ngrep -q \"\\---\\[ end trace\" console-${backend}-0\nshow_result $?\n\nprlog -n \"Checking pmsg file properly keeps the content written before crash ... \"\nprev_uuid=`cat $TOP_DIR/prev_uuid`\nif [ $? -eq 0 ]; then\n    nr_matched=`grep -c \"$TEST_STRING_PATTERN\" pmsg-${backend}-0`\n    if [ $nr_matched -eq 1 ]; then\n\tgrep -q \"$TEST_STRING_PATTERN\"$prev_uuid pmsg-${backend}-0\n\tshow_result $?\n    else\n\tprlog \"FAIL\"\n\trc=1\n    fi\nelse\n    prlog \"FAIL\"\n    rc=1\nfi\n\nprlog -n \"Removing all files in pstore filesystem \"\nfiles=`ls *-${backend}-*`\noperate_files $? \"$files\" rm\n\nexit $rc\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}