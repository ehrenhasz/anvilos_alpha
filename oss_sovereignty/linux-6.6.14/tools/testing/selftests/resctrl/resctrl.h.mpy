{
  "module_name": "resctrl.h",
  "hash_id": "826e0140148f56bd89976e161687d853f920cbe49b15fcaacdb976e755cd38e4",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/resctrl/resctrl.h",
  "human_readable_source": " \n#ifndef RESCTRL_H\n#define RESCTRL_H\n#include <stdio.h>\n#include <math.h>\n#include <errno.h>\n#include <sched.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <dirent.h>\n#include <stdbool.h>\n#include <sys/stat.h>\n#include <sys/ioctl.h>\n#include <sys/mount.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n#include <sys/select.h>\n#include <sys/time.h>\n#include <sys/eventfd.h>\n#include <asm/unistd.h>\n#include <linux/perf_event.h>\n#include \"../kselftest.h\"\n\n#define MB\t\t\t(1024 * 1024)\n#define RESCTRL_PATH\t\t\"/sys/fs/resctrl\"\n#define PHYS_ID_PATH\t\t\"/sys/devices/system/cpu/cpu\"\n#define INFO_PATH\t\t\"/sys/fs/resctrl/info\"\n\n#define ARCH_INTEL     1\n#define ARCH_AMD       2\n\n#define END_OF_TESTS\t1\n\n#define BENCHMARK_ARGS\t\t64\n\n#define DEFAULT_SPAN\t\t(250 * MB)\n\n#define PARENT_EXIT(err_msg)\t\t\t\\\n\tdo {\t\t\t\t\t\\\n\t\tperror(err_msg);\t\t\\\n\t\tkill(ppid, SIGKILL);\t\t\\\n\t\tumount_resctrlfs();\t\t\\\n\t\texit(EXIT_FAILURE);\t\t\\\n\t} while (0)\n\n \nstruct resctrl_val_param {\n\tchar\t\t*resctrl_val;\n\tchar\t\tctrlgrp[64];\n\tchar\t\tmongrp[64];\n\tint\t\tcpu_no;\n\tchar\t\tfilename[64];\n\tchar\t\t*bw_report;\n\tunsigned long\tmask;\n\tint\t\tnum_of_runs;\n\tint\t\t(*setup)(struct resctrl_val_param *param);\n};\n\n#define MBM_STR\t\t\t\"mbm\"\n#define MBA_STR\t\t\t\"mba\"\n#define CMT_STR\t\t\t\"cmt\"\n#define CAT_STR\t\t\t\"cat\"\n\nextern pid_t bm_pid, ppid;\n\nextern char llc_occup_path[1024];\n\nint get_vendor(void);\nbool check_resctrlfs_support(void);\nint filter_dmesg(void);\nint get_resource_id(int cpu_no, int *resource_id);\nint mount_resctrlfs(void);\nint umount_resctrlfs(void);\nint validate_bw_report_request(char *bw_report);\nbool validate_resctrl_feature_request(const char *resource, const char *feature);\nchar *fgrep(FILE *inf, const char *str);\nint taskset_benchmark(pid_t bm_pid, int cpu_no);\nvoid run_benchmark(int signum, siginfo_t *info, void *ucontext);\nint write_schemata(char *ctrlgrp, char *schemata, int cpu_no,\n\t\t   char *resctrl_val);\nint write_bm_pid_to_resctrl(pid_t bm_pid, char *ctrlgrp, char *mongrp,\n\t\t\t    char *resctrl_val);\nint perf_event_open(struct perf_event_attr *hw_event, pid_t pid, int cpu,\n\t\t    int group_fd, unsigned long flags);\nint run_fill_buf(size_t span, int memflush, int op, bool once);\nint resctrl_val(const char * const *benchmark_cmd, struct resctrl_val_param *param);\nint mbm_bw_change(int cpu_no, const char * const *benchmark_cmd);\nvoid tests_cleanup(void);\nvoid mbm_test_cleanup(void);\nint mba_schemata_change(int cpu_no, const char * const *benchmark_cmd);\nvoid mba_test_cleanup(void);\nint get_cbm_mask(char *cache_type, char *cbm_mask);\nint get_cache_size(int cpu_no, char *cache_type, unsigned long *cache_size);\nvoid ctrlc_handler(int signum, siginfo_t *info, void *ptr);\nint signal_handler_register(void);\nvoid signal_handler_unregister(void);\nint cat_val(struct resctrl_val_param *param, size_t span);\nvoid cat_test_cleanup(void);\nint cat_perf_miss_val(int cpu_no, int no_of_bits, char *cache_type);\nint cmt_resctrl_val(int cpu_no, int n, const char * const *benchmark_cmd);\nunsigned int count_bits(unsigned long n);\nvoid cmt_test_cleanup(void);\nint get_core_sibling(int cpu_no);\nint measure_cache_vals(struct resctrl_val_param *param, int bm_pid);\nint show_cache_info(unsigned long sum_llc_val, int no_of_bits,\n\t\t    size_t cache_span, unsigned long max_diff,\n\t\t    unsigned long max_diff_percent, unsigned long num_of_runs,\n\t\t    bool platform, bool cmt);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}