{
  "module_name": "on-fault-limit.c",
  "hash_id": "008883d94057183ac34ea7eb0ed3072892babef3bd06b177e609e72486dfec3f",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/mm/on-fault-limit.c",
  "human_readable_source": "\n#include <sys/mman.h>\n#include <stdio.h>\n#include <unistd.h>\n#include <string.h>\n#include <sys/time.h>\n#include <sys/resource.h>\n\nstatic int test_limit(void)\n{\n\tint ret = 1;\n\tstruct rlimit lims;\n\tvoid *map;\n\n\tif (getrlimit(RLIMIT_MEMLOCK, &lims)) {\n\t\tperror(\"getrlimit\");\n\t\treturn ret;\n\t}\n\n\tif (mlockall(MCL_ONFAULT | MCL_FUTURE)) {\n\t\tperror(\"mlockall\");\n\t\treturn ret;\n\t}\n\n\tmap = mmap(NULL, 2 * lims.rlim_max, PROT_READ | PROT_WRITE,\n\t\t   MAP_PRIVATE | MAP_ANONYMOUS | MAP_POPULATE, -1, 0);\n\tif (map != MAP_FAILED)\n\t\tprintf(\"mmap should have failed, but didn't\\n\");\n\telse {\n\t\tret = 0;\n\t\tmunmap(map, 2 * lims.rlim_max);\n\t}\n\n\tmunlockall();\n\treturn ret;\n}\n\nint main(int argc, char **argv)\n{\n\tint ret = 0;\n\n\tret += test_limit();\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}