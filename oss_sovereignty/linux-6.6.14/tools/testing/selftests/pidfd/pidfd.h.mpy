{
  "module_name": "pidfd.h",
  "hash_id": "ffb61f704102636fbd01a50a618458d56b0212e8ac3c3bc490ef002ec00c423d",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/pidfd/pidfd.h",
  "human_readable_source": " \n\n#ifndef __PIDFD_H\n#define __PIDFD_H\n\n#define _GNU_SOURCE\n#include <errno.h>\n#include <fcntl.h>\n#include <sched.h>\n#include <signal.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <syscall.h>\n#include <sys/mount.h>\n#include <sys/types.h>\n#include <sys/wait.h>\n\n#include \"../kselftest.h\"\n\n#ifndef P_PIDFD\n#define P_PIDFD 3\n#endif\n\n#ifndef CLONE_NEWTIME\n#define CLONE_NEWTIME 0x00000080\n#endif\n\n#ifndef CLONE_PIDFD\n#define CLONE_PIDFD 0x00001000\n#endif\n\n#ifndef __NR_pidfd_open\n#define __NR_pidfd_open -1\n#endif\n\n#ifndef __NR_pidfd_send_signal\n#define __NR_pidfd_send_signal -1\n#endif\n\n#ifndef __NR_clone3\n#define __NR_clone3 -1\n#endif\n\n#ifndef __NR_pidfd_getfd\n#define __NR_pidfd_getfd -1\n#endif\n\n#ifndef PIDFD_NONBLOCK\n#define PIDFD_NONBLOCK O_NONBLOCK\n#endif\n\n \n#define PID_RECYCLE 1000\n\n \n#define PIDFD_PASS 0\n#define PIDFD_FAIL 1\n#define PIDFD_ERROR 2\n#define PIDFD_SKIP 3\n#define PIDFD_XFAIL 4\n\nstatic inline int wait_for_pid(pid_t pid)\n{\n\tint status, ret;\n\nagain:\n\tret = waitpid(pid, &status, 0);\n\tif (ret == -1) {\n\t\tif (errno == EINTR)\n\t\t\tgoto again;\n\n\t\tksft_print_msg(\"waitpid returned -1, errno=%d\\n\", errno);\n\t\treturn -1;\n\t}\n\n\tif (!WIFEXITED(status)) {\n\t\tksft_print_msg(\n\t\t       \"waitpid !WIFEXITED, WIFSIGNALED=%d, WTERMSIG=%d\\n\",\n\t\t       WIFSIGNALED(status), WTERMSIG(status));\n\t\treturn -1;\n\t}\n\n\tret = WEXITSTATUS(status);\n\treturn ret;\n}\n\nstatic inline int sys_pidfd_open(pid_t pid, unsigned int flags)\n{\n\treturn syscall(__NR_pidfd_open, pid, flags);\n}\n\nstatic inline int sys_pidfd_send_signal(int pidfd, int sig, siginfo_t *info,\n\t\t\t\t\tunsigned int flags)\n{\n\treturn syscall(__NR_pidfd_send_signal, pidfd, sig, info, flags);\n}\n\nstatic inline int sys_pidfd_getfd(int pidfd, int fd, int flags)\n{\n\treturn syscall(__NR_pidfd_getfd, pidfd, fd, flags);\n}\n\nstatic inline int sys_memfd_create(const char *name, unsigned int flags)\n{\n\treturn syscall(__NR_memfd_create, name, flags);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}