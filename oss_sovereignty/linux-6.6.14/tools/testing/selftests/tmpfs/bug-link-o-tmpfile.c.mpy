{
  "module_name": "bug-link-o-tmpfile.c",
  "hash_id": "b6f0378891c17ecfb53f55a80740f117e3457f190e3a47fd47d7c9d4ba3d9fed",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/tmpfs/bug-link-o-tmpfile.c",
  "human_readable_source": " \n \n#include <errno.h>\n#include <sched.h>\n#include <stdio.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <sys/mount.h>\n#include <unistd.h>\n\nint main(void)\n{\n\tint fd;\n\n\tif (unshare(CLONE_NEWNS) == -1) {\n\t\tif (errno == ENOSYS || errno == EPERM) {\n\t\t\tfprintf(stderr, \"error: unshare, errno %d\\n\", errno);\n\t\t\treturn 4;\n\t\t}\n\t\tfprintf(stderr, \"error: unshare, errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\tif (mount(NULL, \"/\", NULL, MS_PRIVATE|MS_REC, NULL) == -1) {\n\t\tfprintf(stderr, \"error: mount '/', errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\n\t \n\tif (mount(NULL, \"/tmp\", \"tmpfs\", 0, \"nr_inodes=3\") == -1) {\n\t\tfprintf(stderr, \"error: mount tmpfs, errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\n\tfd = openat(AT_FDCWD, \"/tmp\", O_WRONLY|O_TMPFILE, 0600);\n\tif (fd == -1) {\n\t\tfprintf(stderr, \"error: open 1, errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\tif (linkat(fd, \"\", AT_FDCWD, \"/tmp/1\", AT_EMPTY_PATH) == -1) {\n\t\tfprintf(stderr, \"error: linkat, errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\tclose(fd);\n\n\tfd = openat(AT_FDCWD, \"/tmp\", O_WRONLY|O_TMPFILE, 0600);\n\tif (fd == -1) {\n\t\tfprintf(stderr, \"error: open 2, errno %d\\n\", errno);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}