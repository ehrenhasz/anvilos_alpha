{
  "module_name": "buildebpfPlugin.py",
  "hash_id": "deef082efb1820d7f8eaa27e61cc421a316ffadf7f03394baee5a7162c3c8f0c",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/tc-testing/plugin-lib/buildebpfPlugin.py",
  "human_readable_source": "'''\nbuild ebpf program\n'''\n\nimport os\nimport signal\nfrom string import Template\nimport subprocess\nimport time\nfrom TdcPlugin import TdcPlugin\nfrom tdc_config import *\n\nclass SubPlugin(TdcPlugin):\n    def __init__(self):\n        self.sub_class = 'buildebpf/SubPlugin'\n        self.tap = ''\n        super().__init__()\n\n    def pre_suite(self, testcount, testidlist):\n        super().pre_suite(testcount, testidlist)\n\n        if self.args.buildebpf:\n            self._ebpf_makeall()\n\n    def post_suite(self, index):\n        super().post_suite(index)\n\n        self._ebpf_makeclean()\n\n    def add_args(self, parser):\n        super().add_args(parser)\n\n        self.argparser_group = self.argparser.add_argument_group(\n            'buildebpf',\n            'options for buildebpfPlugin')\n        self.argparser_group.add_argument(\n            '--nobuildebpf', action='store_false', default=True,\n            dest='buildebpf',\n            help='Don\\'t build eBPF programs')\n\n        return self.argparser\n\n    def _ebpf_makeall(self):\n        if self.args.buildebpf:\n            self._make('all')\n\n    def _ebpf_makeclean(self):\n        if self.args.buildebpf:\n            self._make('clean')\n\n    def _make(self, target):\n        command = 'make -C {} {}'.format(self.args.NAMES['EBPFDIR'], target)\n        proc = subprocess.Popen(command,\n            shell=True,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n            env=os.environ.copy())\n        (rawout, serr) = proc.communicate()\n\n        if proc.returncode != 0 and len(serr) > 0:\n            foutput = serr.decode(\"utf-8\")\n        else:\n            foutput = rawout.decode(\"utf-8\")\n\n        proc.stdout.close()\n        proc.stderr.close()\n        return proc, foutput\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}