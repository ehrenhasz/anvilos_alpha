{
  "module_name": "ct.json",
  "hash_id": "452ee11358146492917e64720ec950e4ae80d83134f4564a10185b06c70e6125",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/tc-testing/tc-tests/actions/ct.json",
  "human_readable_source": "[\n    {\n        \"id\": \"696a\",\n        \"name\": \"Add simple ct action\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 0 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"e38c\",\n        \"name\": \"Add simple ct action with cookie\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct index 42 cookie deadbeef\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 0 pipe.*index 42 ref.*cookie deadbeef\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"9f20\",\n        \"name\": \"Add ct clear action\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct clear index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct clear pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"0bc1\",\n        \"name\": \"Add ct clear action with cookie of max length\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct clear index 42 cookie aa11bb22cc33dd44ee55ff66aa11b1b2\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct clear pipe.*index 42 ref.*cookie aa11bb22cc33dd44ee55ff66aa11b1b2\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"5bea\",\n        \"name\": \"Try ct with zone\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct zone 404 index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 404 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"d5d6\",\n        \"name\": \"Try ct with zone, commit\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct zone 404 commit index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit zone 404 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"029f\",\n        \"name\": \"Try ct with zone, commit, mark\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct zone 404 commit mark 0x42 index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit mark 66 zone 404 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"a58d\",\n        \"name\": \"Try ct with zone, commit, mark, nat\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct zone 404 commit mark 0x42 nat src addr 5.5.5.7 index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit mark 66 zone 404 nat src addr 5.5.5.7 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"901b\",\n        \"name\": \"Try ct with full nat ipv4 range syntax\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct commit nat src addr 5.5.5.7-5.5.6.0 port 1000-2000 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit zone 0 nat src addr 5.5.5.7-5.5.6.0 port 1000-2000 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"072b\",\n        \"name\": \"Try ct with full nat ipv6 syntax\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct commit nat src addr 2001::1 port 1000-2000 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit zone 0 nat src addr 2001::1 port 1000-2000 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"3420\",\n        \"name\": \"Try ct with full nat ipv6 range syntax\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct commit nat src addr 2001::1-2001::10 port 1000-2000 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit zone 0 nat src addr 2001::1-2001::10 port 1000-2000 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"4470\",\n        \"name\": \"Try ct with full nat ipv6 range syntax + force\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct commit force nat src addr 2001::1-2001::10 port 1000-2000 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct commit force zone 0 nat src addr 2001::1-2001::10 port 1000-2000 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"5d88\",\n        \"name\": \"Try ct with label\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct label 123123 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 0 label 12312300000000000000000000000000 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"04d4\",\n        \"name\": \"Try ct with label with mask\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct label 12312300000000000000000000000001/ffffffff000000000000000000000001 index 44\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 0 label 12312300000000000000000000000001/ffffffff000000000000000000000001 pipe.*index 44 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"9751\",\n        \"name\": \"Try ct with mark + mask\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct mark 0x42/0xf0 index 42\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct mark 66/0xf0 zone 0 pipe.*index 42 ref\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"2faa\",\n        \"name\": \"Try ct with mark + mask and cookie\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct mark 0x42/0xf0 index 42 cookie aa11bb22cc33dd44ee55ff66aa11b1b2\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct mark 66/0xf0 zone 0 pipe.*index 42 ref.*cookie aa11bb22cc33dd44ee55ff66aa11b1b2\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"3991\",\n        \"name\": \"Add simple ct action with no_percpu flag\",\n        \"category\": [\n            \"actions\",\n            \"ct\"\n        ],\n        \"setup\": [\n            [\n                \"$TC actions flush action ct\",\n                0,\n                1,\n                255\n            ]\n        ],\n        \"cmdUnderTest\": \"$TC actions add action ct no_percpu\",\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"$TC actions list action ct\",\n        \"matchPattern\": \"action order [0-9]*: ct zone 0 pipe.*no_percpu\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC actions flush action ct\"\n        ]\n    },\n    {\n        \"id\": \"3992\",\n        \"name\": \"Add ct action triggering DNAT tuple conflict\",\n        \"category\": [\n            \"actions\",\n            \"ct\",\n\t    \"scapy\"\n        ],\n\t\"plugins\": {\n\t\t\"requires\": [\n\t\t\t\"nsPlugin\",\n\t\t\t\"scapyPlugin\"\n\t\t]\n\t},\n        \"setup\": [\n            [\n                \"$TC qdisc del dev $DEV1 ingress\",\n                0,\n                1,\n\t\t2,\n                255\n            ],\n\t    \"$TC qdisc add dev $DEV1 ingress\"\n        ],\n        \"cmdUnderTest\": \"$TC filter add dev $DEV1 ingress protocol ip prio 1 flower ct_state -trk action ct commit nat dst addr 20.0.0.1 port 10 pipe action drop\",\n\t\"scapy\": [\n\t    {\n\t\t\"iface\": \"$DEV0\",\n\t\t\"count\": 1,\n\t\t\"packet\": \"Ether(type=0x800)/IP(src='10.0.0.10',dst='10.0.0.10')/TCP(sport=5000,dport=10)\"\n\t    },\n\t    {\n\t\t\"iface\": \"$DEV0\",\n\t\t\"count\": 1,\n\t\t\"packet\": \"Ether(type=0x800)/IP(src='10.0.0.10',dst='10.0.0.20')/TCP(sport=5000,dport=10)\"\n\t    }\n\t],\n        \"expExitCode\": \"0\",\n        \"verifyCmd\": \"cat /proc/net/nf_conntrack\",\n        \"matchPattern\": \"dst=10.0.0.20\",\n        \"matchCount\": \"1\",\n        \"teardown\": [\n            \"$TC qdisc del dev $DEV1 ingress\"\n        ]\n    }\n]\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}