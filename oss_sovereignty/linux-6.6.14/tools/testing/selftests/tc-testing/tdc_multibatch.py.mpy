{
  "module_name": "tdc_multibatch.py",
  "hash_id": "e074c404333715a1a28fefbe98fe14ec9671b548e2ed5d50c29c08606123b510",
  "original_prompt": "Ingested from linux-6.6.14/tools/testing/selftests/tc-testing/tdc_multibatch.py",
  "human_readable_source": "#!/usr/bin/env python3\n# SPDX-License-Identifier: GPL-2.0\n\"\"\"\ntdc_multibatch.py - a thin wrapper over tdc_batch.py to generate multiple batch\nfiles\n\nCopyright (C) 2019 Vlad Buslov <vladbu@mellanox.com>\n\"\"\"\n\nimport argparse\nimport os\n\nparser = argparse.ArgumentParser(\n    description='TC multiple batch file generator')\nparser.add_argument(\"device\", help=\"device name\")\nparser.add_argument(\"dir\", help=\"where to put batch files\")\nparser.add_argument(\n    \"num_filters\", type=int, help=\"how many lines per batch file\")\nparser.add_argument(\"num_files\", type=int, help=\"how many batch files\")\nparser.add_argument(\n    \"operation\",\n    choices=['add', 'del', 'replace'],\n    help=\"operation to perform on filters\")\nparser.add_argument(\n    \"-x\",\n    \"--file_prefix\",\n    default=\"\",\n    help=\"prefix for generated batch file names\")\nparser.add_argument(\n    \"-d\",\n    \"--duplicate_handles\",\n    action=\"store_true\",\n    help=\"duplicate filter handle range in all files\")\nparser.add_argument(\n    \"-a\",\n    \"--handle_start\",\n    type=int,\n    default=1,\n    help=\"start handle range from (default: 1)\")\nparser.add_argument(\n    \"-m\",\n    \"--mac_prefix\",\n    type=int,\n    default=0,\n    choices=range(0, 256),\n    help=\"add this value to third byte of source MAC address of flower filter\"\n    \"(default: 0)\")\nargs = parser.parse_args()\n\ndevice = args.device\ndir = args.dir\nfile_prefix = args.file_prefix + args.operation + \"_\"\nnum_filters = args.num_filters\nnum_files = args.num_files\noperation = args.operation\nduplicate_handles = args.duplicate_handles\nhandle = args.handle_start\nmac_prefix = args.mac_prefix\n\nfor i in range(num_files):\n    file = dir + '/' + file_prefix + str(i)\n    os.system(\"./tdc_batch.py -n {} -a {} -e {} -m {} {} {}\".format(\n        num_filters, handle, operation, i + mac_prefix, device, file))\n    if not duplicate_handles:\n        handle += num_filters\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}