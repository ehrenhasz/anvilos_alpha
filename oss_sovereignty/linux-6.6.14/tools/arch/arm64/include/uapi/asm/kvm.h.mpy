{
  "module_name": "kvm.h",
  "hash_id": "d0854792a3d9665e90154f928501c0b109a2a4909be5d71e961a1a5c6c93bec1",
  "original_prompt": "Ingested from linux-6.6.14/tools/arch/arm64/include/uapi/asm/kvm.h",
  "human_readable_source": " \n \n\n#ifndef __ARM_KVM_H__\n#define __ARM_KVM_H__\n\n#define KVM_SPSR_EL1\t0\n#define KVM_SPSR_SVC\tKVM_SPSR_EL1\n#define KVM_SPSR_ABT\t1\n#define KVM_SPSR_UND\t2\n#define KVM_SPSR_IRQ\t3\n#define KVM_SPSR_FIQ\t4\n#define KVM_NR_SPSR\t5\n\n#ifndef __ASSEMBLY__\n#include <linux/psci.h>\n#include <linux/types.h>\n#include <asm/ptrace.h>\n#include <asm/sve_context.h>\n\n#define __KVM_HAVE_GUEST_DEBUG\n#define __KVM_HAVE_IRQ_LINE\n#define __KVM_HAVE_READONLY_MEM\n#define __KVM_HAVE_VCPU_EVENTS\n\n#define KVM_COALESCED_MMIO_PAGE_OFFSET 1\n#define KVM_DIRTY_LOG_PAGE_OFFSET 64\n\n#define KVM_REG_SIZE(id)\t\t\t\t\t\t\\\n\t(1U << (((id) & KVM_REG_SIZE_MASK) >> KVM_REG_SIZE_SHIFT))\n\nstruct kvm_regs {\n\tstruct user_pt_regs regs;\t \n\n\t__u64\tsp_el1;\n\t__u64\telr_el1;\n\n\t__u64\tspsr[KVM_NR_SPSR];\n\n\tstruct user_fpsimd_state fp_regs;\n};\n\n \n#define KVM_ARM_TARGET_AEM_V8\t\t0\n#define KVM_ARM_TARGET_FOUNDATION_V8\t1\n#define KVM_ARM_TARGET_CORTEX_A57\t2\n#define KVM_ARM_TARGET_XGENE_POTENZA\t3\n#define KVM_ARM_TARGET_CORTEX_A53\t4\n \n#define KVM_ARM_TARGET_GENERIC_V8\t5\n\n#define KVM_ARM_NUM_TARGETS\t\t6\n\n \n#define KVM_ARM_DEVICE_TYPE_SHIFT\t0\n#define KVM_ARM_DEVICE_TYPE_MASK\tGENMASK(KVM_ARM_DEVICE_TYPE_SHIFT + 15, \\\n\t\t\t\t\t\tKVM_ARM_DEVICE_TYPE_SHIFT)\n#define KVM_ARM_DEVICE_ID_SHIFT\t\t16\n#define KVM_ARM_DEVICE_ID_MASK\t\tGENMASK(KVM_ARM_DEVICE_ID_SHIFT + 15, \\\n\t\t\t\t\t\tKVM_ARM_DEVICE_ID_SHIFT)\n\n \n#define KVM_ARM_DEVICE_VGIC_V2\t\t0\n\n \n#define KVM_VGIC_V2_ADDR_TYPE_DIST\t0\n#define KVM_VGIC_V2_ADDR_TYPE_CPU\t1\n\n#define KVM_VGIC_V2_DIST_SIZE\t\t0x1000\n#define KVM_VGIC_V2_CPU_SIZE\t\t0x2000\n\n \n#define KVM_VGIC_V3_ADDR_TYPE_DIST\t2\n#define KVM_VGIC_V3_ADDR_TYPE_REDIST\t3\n#define KVM_VGIC_ITS_ADDR_TYPE\t\t4\n#define KVM_VGIC_V3_ADDR_TYPE_REDIST_REGION\t5\n\n#define KVM_VGIC_V3_DIST_SIZE\t\tSZ_64K\n#define KVM_VGIC_V3_REDIST_SIZE\t\t(2 * SZ_64K)\n#define KVM_VGIC_V3_ITS_SIZE\t\t(2 * SZ_64K)\n\n#define KVM_ARM_VCPU_POWER_OFF\t\t0  \n#define KVM_ARM_VCPU_EL1_32BIT\t\t1  \n#define KVM_ARM_VCPU_PSCI_0_2\t\t2  \n#define KVM_ARM_VCPU_PMU_V3\t\t3  \n#define KVM_ARM_VCPU_SVE\t\t4  \n#define KVM_ARM_VCPU_PTRAUTH_ADDRESS\t5  \n#define KVM_ARM_VCPU_PTRAUTH_GENERIC\t6  \n#define KVM_ARM_VCPU_HAS_EL2\t\t7  \n\nstruct kvm_vcpu_init {\n\t__u32 target;\n\t__u32 features[7];\n};\n\nstruct kvm_sregs {\n};\n\nstruct kvm_fpu {\n};\n\n \n#define KVM_ARM_MAX_DBG_REGS 16\nstruct kvm_guest_debug_arch {\n\t__u64 dbg_bcr[KVM_ARM_MAX_DBG_REGS];\n\t__u64 dbg_bvr[KVM_ARM_MAX_DBG_REGS];\n\t__u64 dbg_wcr[KVM_ARM_MAX_DBG_REGS];\n\t__u64 dbg_wvr[KVM_ARM_MAX_DBG_REGS];\n};\n\n#define KVM_DEBUG_ARCH_HSR_HIGH_VALID\t(1 << 0)\nstruct kvm_debug_exit_arch {\n\t__u32 hsr;\n\t__u32 hsr_high;\t \n\t__u64 far;\t \n};\n\n \n\n#define KVM_GUESTDBG_USE_SW_BP\t\t(1 << 16)\n#define KVM_GUESTDBG_USE_HW\t\t(1 << 17)\n\nstruct kvm_sync_regs {\n\t \n\t__u64 device_irq_level;\n};\n\n \nstruct kvm_pmu_event_filter {\n\t__u16\tbase_event;\n\t__u16\tnevents;\n\n#define KVM_PMU_EVENT_ALLOW\t0\n#define KVM_PMU_EVENT_DENY\t1\n\n\t__u8\taction;\n\t__u8\tpad[3];\n};\n\n \nstruct kvm_vcpu_events {\n\tstruct {\n\t\t__u8 serror_pending;\n\t\t__u8 serror_has_esr;\n\t\t__u8 ext_dabt_pending;\n\t\t \n\t\t__u8 pad[5];\n\t\t__u64 serror_esr;\n\t} exception;\n\t__u32 reserved[12];\n};\n\nstruct kvm_arm_copy_mte_tags {\n\t__u64 guest_ipa;\n\t__u64 length;\n\tvoid __user *addr;\n\t__u64 flags;\n\t__u64 reserved[2];\n};\n\n \nstruct kvm_arm_counter_offset {\n\t__u64 counter_offset;\n\t__u64 reserved;\n};\n\n#define KVM_ARM_TAGS_TO_GUEST\t\t0\n#define KVM_ARM_TAGS_FROM_GUEST\t\t1\n\n \n#define KVM_REG_ARM_COPROC_MASK\t\t0x000000000FFF0000\n#define KVM_REG_ARM_COPROC_SHIFT\t16\n\n \n#define KVM_REG_ARM_CORE\t\t(0x0010 << KVM_REG_ARM_COPROC_SHIFT)\n#define KVM_REG_ARM_CORE_REG(name)\t(offsetof(struct kvm_regs, name) / sizeof(__u32))\n\n \n#define KVM_REG_ARM_DEMUX\t\t(0x0011 << KVM_REG_ARM_COPROC_SHIFT)\n#define KVM_REG_ARM_DEMUX_ID_MASK\t0x000000000000FF00\n#define KVM_REG_ARM_DEMUX_ID_SHIFT\t8\n#define KVM_REG_ARM_DEMUX_ID_CCSIDR\t(0x00 << KVM_REG_ARM_DEMUX_ID_SHIFT)\n#define KVM_REG_ARM_DEMUX_VAL_MASK\t0x00000000000000FF\n#define KVM_REG_ARM_DEMUX_VAL_SHIFT\t0\n\n \n#define KVM_REG_ARM64_SYSREG\t\t(0x0013 << KVM_REG_ARM_COPROC_SHIFT)\n#define KVM_REG_ARM64_SYSREG_OP0_MASK\t0x000000000000c000\n#define KVM_REG_ARM64_SYSREG_OP0_SHIFT\t14\n#define KVM_REG_ARM64_SYSREG_OP1_MASK\t0x0000000000003800\n#define KVM_REG_ARM64_SYSREG_OP1_SHIFT\t11\n#define KVM_REG_ARM64_SYSREG_CRN_MASK\t0x0000000000000780\n#define KVM_REG_ARM64_SYSREG_CRN_SHIFT\t7\n#define KVM_REG_ARM64_SYSREG_CRM_MASK\t0x0000000000000078\n#define KVM_REG_ARM64_SYSREG_CRM_SHIFT\t3\n#define KVM_REG_ARM64_SYSREG_OP2_MASK\t0x0000000000000007\n#define KVM_REG_ARM64_SYSREG_OP2_SHIFT\t0\n\n#define ARM64_SYS_REG_SHIFT_MASK(x,n) \\\n\t(((x) << KVM_REG_ARM64_SYSREG_ ## n ## _SHIFT) & \\\n\tKVM_REG_ARM64_SYSREG_ ## n ## _MASK)\n\n#define __ARM64_SYS_REG(op0,op1,crn,crm,op2) \\\n\t(KVM_REG_ARM64 | KVM_REG_ARM64_SYSREG | \\\n\tARM64_SYS_REG_SHIFT_MASK(op0, OP0) | \\\n\tARM64_SYS_REG_SHIFT_MASK(op1, OP1) | \\\n\tARM64_SYS_REG_SHIFT_MASK(crn, CRN) | \\\n\tARM64_SYS_REG_SHIFT_MASK(crm, CRM) | \\\n\tARM64_SYS_REG_SHIFT_MASK(op2, OP2))\n\n#define ARM64_SYS_REG(...) (__ARM64_SYS_REG(__VA_ARGS__) | KVM_REG_SIZE_U64)\n\n \n#define KVM_REG_ARM_PTIMER_CTL\t\tARM64_SYS_REG(3, 3, 14, 2, 1)\n#define KVM_REG_ARM_PTIMER_CVAL\t\tARM64_SYS_REG(3, 3, 14, 2, 2)\n#define KVM_REG_ARM_PTIMER_CNT\t\tARM64_SYS_REG(3, 3, 14, 0, 1)\n\n \n#define KVM_REG_ARM_TIMER_CTL\t\tARM64_SYS_REG(3, 3, 14, 3, 1)\n#define KVM_REG_ARM_TIMER_CVAL\t\tARM64_SYS_REG(3, 3, 14, 0, 2)\n#define KVM_REG_ARM_TIMER_CNT\t\tARM64_SYS_REG(3, 3, 14, 3, 2)\n\n \n#define KVM_REG_ARM_FW\t\t\t(0x0014 << KVM_REG_ARM_COPROC_SHIFT)\n#define KVM_REG_ARM_FW_REG(r)\t\t(KVM_REG_ARM64 | KVM_REG_SIZE_U64 | \\\n\t\t\t\t\t KVM_REG_ARM_FW | ((r) & 0xffff))\n#define KVM_REG_ARM_PSCI_VERSION\tKVM_REG_ARM_FW_REG(0)\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_1\tKVM_REG_ARM_FW_REG(1)\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_1_NOT_AVAIL\t\t0\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_1_AVAIL\t\t1\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_1_NOT_REQUIRED\t2\n\n \n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2\tKVM_REG_ARM_FW_REG(2)\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2_NOT_AVAIL\t\t0\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2_UNKNOWN\t\t1\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2_AVAIL\t\t2\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2_NOT_REQUIRED\t3\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_2_ENABLED     \t(1U << 4)\n\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_3\tKVM_REG_ARM_FW_REG(3)\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_3_NOT_AVAIL\t\t0\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_3_AVAIL\t\t1\n#define KVM_REG_ARM_SMCCC_ARCH_WORKAROUND_3_NOT_REQUIRED\t2\n\n \n#define KVM_REG_ARM64_SVE\t\t(0x15 << KVM_REG_ARM_COPROC_SHIFT)\n\n \n#define KVM_REG_ARM64_SVE_ZREG_BASE\t0\n#define KVM_REG_ARM64_SVE_PREG_BASE\t0x400\n#define KVM_REG_ARM64_SVE_FFR_BASE\t0x600\n\n#define KVM_ARM64_SVE_NUM_ZREGS\t\t__SVE_NUM_ZREGS\n#define KVM_ARM64_SVE_NUM_PREGS\t\t__SVE_NUM_PREGS\n\n#define KVM_ARM64_SVE_MAX_SLICES\t32\n\n#define KVM_REG_ARM64_SVE_ZREG(n, i)\t\t\t\t\t\\\n\t(KVM_REG_ARM64 | KVM_REG_ARM64_SVE | KVM_REG_ARM64_SVE_ZREG_BASE | \\\n\t KVM_REG_SIZE_U2048 |\t\t\t\t\t\t\\\n\t (((n) & (KVM_ARM64_SVE_NUM_ZREGS - 1)) << 5) |\t\t\t\\\n\t ((i) & (KVM_ARM64_SVE_MAX_SLICES - 1)))\n\n#define KVM_REG_ARM64_SVE_PREG(n, i)\t\t\t\t\t\\\n\t(KVM_REG_ARM64 | KVM_REG_ARM64_SVE | KVM_REG_ARM64_SVE_PREG_BASE | \\\n\t KVM_REG_SIZE_U256 |\t\t\t\t\t\t\\\n\t (((n) & (KVM_ARM64_SVE_NUM_PREGS - 1)) << 5) |\t\t\t\\\n\t ((i) & (KVM_ARM64_SVE_MAX_SLICES - 1)))\n\n#define KVM_REG_ARM64_SVE_FFR(i)\t\t\t\t\t\\\n\t(KVM_REG_ARM64 | KVM_REG_ARM64_SVE | KVM_REG_ARM64_SVE_FFR_BASE | \\\n\t KVM_REG_SIZE_U256 |\t\t\t\t\t\t\\\n\t ((i) & (KVM_ARM64_SVE_MAX_SLICES - 1)))\n\n \n\n#define KVM_ARM64_SVE_VQ_MIN __SVE_VQ_MIN\n#define KVM_ARM64_SVE_VQ_MAX __SVE_VQ_MAX\n\n \n#define KVM_REG_ARM64_SVE_VLS\t\t(KVM_REG_ARM64 | KVM_REG_ARM64_SVE | \\\n\t\t\t\t\t KVM_REG_SIZE_U512 | 0xffff)\n#define KVM_ARM64_SVE_VLS_WORDS\t\\\n\t((KVM_ARM64_SVE_VQ_MAX - KVM_ARM64_SVE_VQ_MIN) / 64 + 1)\n\n \n#define KVM_REG_ARM_FW_FEAT_BMAP\t\t(0x0016 << KVM_REG_ARM_COPROC_SHIFT)\n#define KVM_REG_ARM_FW_FEAT_BMAP_REG(r)\t\t(KVM_REG_ARM64 | KVM_REG_SIZE_U64 | \\\n\t\t\t\t\t\tKVM_REG_ARM_FW_FEAT_BMAP |\t\\\n\t\t\t\t\t\t((r) & 0xffff))\n\n#define KVM_REG_ARM_STD_BMAP\t\t\tKVM_REG_ARM_FW_FEAT_BMAP_REG(0)\n\nenum {\n\tKVM_REG_ARM_STD_BIT_TRNG_V1_0\t= 0,\n#ifdef __KERNEL__\n\tKVM_REG_ARM_STD_BMAP_BIT_COUNT,\n#endif\n};\n\n#define KVM_REG_ARM_STD_HYP_BMAP\t\tKVM_REG_ARM_FW_FEAT_BMAP_REG(1)\n\nenum {\n\tKVM_REG_ARM_STD_HYP_BIT_PV_TIME\t= 0,\n#ifdef __KERNEL__\n\tKVM_REG_ARM_STD_HYP_BMAP_BIT_COUNT,\n#endif\n};\n\n#define KVM_REG_ARM_VENDOR_HYP_BMAP\t\tKVM_REG_ARM_FW_FEAT_BMAP_REG(2)\n\nenum {\n\tKVM_REG_ARM_VENDOR_HYP_BIT_FUNC_FEAT\t= 0,\n\tKVM_REG_ARM_VENDOR_HYP_BIT_PTP\t\t= 1,\n#ifdef __KERNEL__\n\tKVM_REG_ARM_VENDOR_HYP_BMAP_BIT_COUNT,\n#endif\n};\n\n \n#define KVM_ARM_VM_SMCCC_CTRL\t\t0\n#define   KVM_ARM_VM_SMCCC_FILTER\t0\n\n \n#define KVM_DEV_ARM_VGIC_GRP_ADDR\t0\n#define KVM_DEV_ARM_VGIC_GRP_DIST_REGS\t1\n#define KVM_DEV_ARM_VGIC_GRP_CPU_REGS\t2\n#define   KVM_DEV_ARM_VGIC_CPUID_SHIFT\t32\n#define   KVM_DEV_ARM_VGIC_CPUID_MASK\t(0xffULL << KVM_DEV_ARM_VGIC_CPUID_SHIFT)\n#define   KVM_DEV_ARM_VGIC_V3_MPIDR_SHIFT 32\n#define   KVM_DEV_ARM_VGIC_V3_MPIDR_MASK \\\n\t\t\t(0xffffffffULL << KVM_DEV_ARM_VGIC_V3_MPIDR_SHIFT)\n#define   KVM_DEV_ARM_VGIC_OFFSET_SHIFT\t0\n#define   KVM_DEV_ARM_VGIC_OFFSET_MASK\t(0xffffffffULL << KVM_DEV_ARM_VGIC_OFFSET_SHIFT)\n#define   KVM_DEV_ARM_VGIC_SYSREG_INSTR_MASK (0xffff)\n#define KVM_DEV_ARM_VGIC_GRP_NR_IRQS\t3\n#define KVM_DEV_ARM_VGIC_GRP_CTRL\t4\n#define KVM_DEV_ARM_VGIC_GRP_REDIST_REGS 5\n#define KVM_DEV_ARM_VGIC_GRP_CPU_SYSREGS 6\n#define KVM_DEV_ARM_VGIC_GRP_LEVEL_INFO  7\n#define KVM_DEV_ARM_VGIC_GRP_ITS_REGS 8\n#define KVM_DEV_ARM_VGIC_LINE_LEVEL_INFO_SHIFT\t10\n#define KVM_DEV_ARM_VGIC_LINE_LEVEL_INFO_MASK \\\n\t\t\t(0x3fffffULL << KVM_DEV_ARM_VGIC_LINE_LEVEL_INFO_SHIFT)\n#define KVM_DEV_ARM_VGIC_LINE_LEVEL_INTID_MASK\t0x3ff\n#define VGIC_LEVEL_INFO_LINE_LEVEL\t0\n\n#define   KVM_DEV_ARM_VGIC_CTRL_INIT\t\t0\n#define   KVM_DEV_ARM_ITS_SAVE_TABLES           1\n#define   KVM_DEV_ARM_ITS_RESTORE_TABLES        2\n#define   KVM_DEV_ARM_VGIC_SAVE_PENDING_TABLES\t3\n#define   KVM_DEV_ARM_ITS_CTRL_RESET\t\t4\n\n \n#define KVM_ARM_VCPU_PMU_V3_CTRL\t0\n#define   KVM_ARM_VCPU_PMU_V3_IRQ\t0\n#define   KVM_ARM_VCPU_PMU_V3_INIT\t1\n#define   KVM_ARM_VCPU_PMU_V3_FILTER\t2\n#define   KVM_ARM_VCPU_PMU_V3_SET_PMU\t3\n#define KVM_ARM_VCPU_TIMER_CTRL\t\t1\n#define   KVM_ARM_VCPU_TIMER_IRQ_VTIMER\t\t0\n#define   KVM_ARM_VCPU_TIMER_IRQ_PTIMER\t\t1\n#define   KVM_ARM_VCPU_TIMER_IRQ_HVTIMER\t2\n#define   KVM_ARM_VCPU_TIMER_IRQ_HPTIMER\t3\n#define KVM_ARM_VCPU_PVTIME_CTRL\t2\n#define   KVM_ARM_VCPU_PVTIME_IPA\t0\n\n \n#define KVM_ARM_IRQ_VCPU2_SHIFT\t\t28\n#define KVM_ARM_IRQ_VCPU2_MASK\t\t0xf\n#define KVM_ARM_IRQ_TYPE_SHIFT\t\t24\n#define KVM_ARM_IRQ_TYPE_MASK\t\t0xf\n#define KVM_ARM_IRQ_VCPU_SHIFT\t\t16\n#define KVM_ARM_IRQ_VCPU_MASK\t\t0xff\n#define KVM_ARM_IRQ_NUM_SHIFT\t\t0\n#define KVM_ARM_IRQ_NUM_MASK\t\t0xffff\n\n \n#define KVM_ARM_IRQ_TYPE_CPU\t\t0\n#define KVM_ARM_IRQ_TYPE_SPI\t\t1\n#define KVM_ARM_IRQ_TYPE_PPI\t\t2\n\n \n#define KVM_ARM_IRQ_CPU_IRQ\t\t0\n#define KVM_ARM_IRQ_CPU_FIQ\t\t1\n\n \n#ifndef __KERNEL__\n#define KVM_ARM_IRQ_GIC_MAX\t\t127\n#endif\n\n \n#define KVM_NR_IRQCHIPS          1\n\n \n#define KVM_PSCI_FN_BASE\t\t0x95c1ba5e\n#define KVM_PSCI_FN(n)\t\t\t(KVM_PSCI_FN_BASE + (n))\n\n#define KVM_PSCI_FN_CPU_SUSPEND\t\tKVM_PSCI_FN(0)\n#define KVM_PSCI_FN_CPU_OFF\t\tKVM_PSCI_FN(1)\n#define KVM_PSCI_FN_CPU_ON\t\tKVM_PSCI_FN(2)\n#define KVM_PSCI_FN_MIGRATE\t\tKVM_PSCI_FN(3)\n\n#define KVM_PSCI_RET_SUCCESS\t\tPSCI_RET_SUCCESS\n#define KVM_PSCI_RET_NI\t\t\tPSCI_RET_NOT_SUPPORTED\n#define KVM_PSCI_RET_INVAL\t\tPSCI_RET_INVALID_PARAMS\n#define KVM_PSCI_RET_DENIED\t\tPSCI_RET_DENIED\n\n \n \n#define KVM_SYSTEM_EVENT_RESET_FLAG_PSCI_RESET2\t(1ULL << 0)\n\n \n#define KVM_EXIT_FAIL_ENTRY_CPU_UNSUPPORTED\t(1ULL << 0)\n\nenum kvm_smccc_filter_action {\n\tKVM_SMCCC_FILTER_HANDLE = 0,\n\tKVM_SMCCC_FILTER_DENY,\n\tKVM_SMCCC_FILTER_FWD_TO_USER,\n\n#ifdef __KERNEL__\n\tNR_SMCCC_FILTER_ACTIONS\n#endif\n};\n\nstruct kvm_smccc_filter {\n\t__u32 base;\n\t__u32 nr_functions;\n\t__u8 action;\n\t__u8 pad[15];\n};\n\n \n#define KVM_HYPERCALL_EXIT_SMC\t\t(1U << 0)\n#define KVM_HYPERCALL_EXIT_16BIT\t(1U << 1)\n\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}