{
  "module_name": "cmpxchg.h",
  "hash_id": "2b9331ba9374f58695eb7bfc42d49f465ff2194633bc482d8e166f05b30ff8ba",
  "original_prompt": "Ingested from linux-6.6.14/tools/arch/x86/include/asm/cmpxchg.h",
  "human_readable_source": " \n#ifndef TOOLS_ASM_X86_CMPXCHG_H\n#define TOOLS_ASM_X86_CMPXCHG_H\n\n#include <linux/compiler.h>\n\n \nextern void __cmpxchg_wrong_size(void)\n\t__compiletime_error(\"Bad argument size for cmpxchg\");\n\n \n#define __X86_CASE_B\t1\n#define __X86_CASE_W\t2\n#define __X86_CASE_L\t4\n#ifdef __x86_64__\n#define __X86_CASE_Q\t8\n#else\n#define\t__X86_CASE_Q\t-1\t\t \n#endif\n\n \n#define __raw_cmpxchg(ptr, old, new, size, lock)\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\t__typeof__(*(ptr)) __ret;\t\t\t\t\t\\\n\t__typeof__(*(ptr)) __old = (old);\t\t\t\t\\\n\t__typeof__(*(ptr)) __new = (new);\t\t\t\t\\\n\tswitch (size) {\t\t\t\t\t\t\t\\\n\tcase __X86_CASE_B:\t\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\tvolatile u8 *__ptr = (volatile u8 *)(ptr);\t\t\\\n\t\tasm volatile(lock \"cmpxchgb %2,%1\"\t\t\t\\\n\t\t\t     : \"=a\" (__ret), \"+m\" (*__ptr)\t\t\\\n\t\t\t     : \"q\" (__new), \"0\" (__old)\t\t\t\\\n\t\t\t     : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tcase __X86_CASE_W:\t\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\tvolatile u16 *__ptr = (volatile u16 *)(ptr);\t\t\\\n\t\tasm volatile(lock \"cmpxchgw %2,%1\"\t\t\t\\\n\t\t\t     : \"=a\" (__ret), \"+m\" (*__ptr)\t\t\\\n\t\t\t     : \"r\" (__new), \"0\" (__old)\t\t\t\\\n\t\t\t     : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tcase __X86_CASE_L:\t\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\tvolatile u32 *__ptr = (volatile u32 *)(ptr);\t\t\\\n\t\tasm volatile(lock \"cmpxchgl %2,%1\"\t\t\t\\\n\t\t\t     : \"=a\" (__ret), \"+m\" (*__ptr)\t\t\\\n\t\t\t     : \"r\" (__new), \"0\" (__old)\t\t\t\\\n\t\t\t     : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tcase __X86_CASE_Q:\t\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\tvolatile u64 *__ptr = (volatile u64 *)(ptr);\t\t\\\n\t\tasm volatile(lock \"cmpxchgq %2,%1\"\t\t\t\\\n\t\t\t     : \"=a\" (__ret), \"+m\" (*__ptr)\t\t\\\n\t\t\t     : \"r\" (__new), \"0\" (__old)\t\t\t\\\n\t\t\t     : \"memory\");\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tdefault:\t\t\t\t\t\t\t\\\n\t\t__cmpxchg_wrong_size();\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\t__ret;\t\t\t\t\t\t\t\t\\\n})\n\n#define __cmpxchg(ptr, old, new, size)\t\t\t\t\t\\\n\t__raw_cmpxchg((ptr), (old), (new), (size), LOCK_PREFIX)\n\n#define cmpxchg(ptr, old, new)\t\t\t\t\t\t\\\n\t__cmpxchg(ptr, old, new, sizeof(*(ptr)))\n\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}