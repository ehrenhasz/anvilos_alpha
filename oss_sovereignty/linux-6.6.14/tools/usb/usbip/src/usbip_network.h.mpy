{
  "module_name": "usbip_network.h",
  "hash_id": "c8e61b9db5c383ddafddf72034534676c042e525acc8acf76a2d7c767529da57",
  "original_prompt": "Ingested from linux-6.6.14/tools/usb/usbip/src/usbip_network.h",
  "human_readable_source": " \n \n\n#ifndef __USBIP_NETWORK_H\n#define __USBIP_NETWORK_H\n\n#ifdef HAVE_CONFIG_H\n#include \"../config.h\"\n#endif\n\n#include <sys/types.h>\n\n#include <stdint.h>\n\nextern int usbip_port;\nextern char *usbip_port_string;\nvoid usbip_setup_port_number(char *arg);\n\n \n \nstruct op_common {\n\tuint16_t version;\n\n#define OP_REQUEST\t(0x80 << 8)\n#define OP_REPLY\t(0x00 << 8)\n\tuint16_t code;\n\n\t \n\tuint32_t status;  \n\n} __attribute__((packed));\n\n \n \n#define OP_UNSPEC\t0x00\n#define OP_REQ_UNSPEC\tOP_UNSPEC\n#define OP_REP_UNSPEC\tOP_UNSPEC\n\n \n \n#define OP_DEVINFO\t0x02\n#define OP_REQ_DEVINFO\t(OP_REQUEST | OP_DEVINFO)\n#define OP_REP_DEVINFO\t(OP_REPLY   | OP_DEVINFO)\n\nstruct op_devinfo_request {\n\tchar busid[SYSFS_BUS_ID_SIZE];\n} __attribute__((packed));\n\nstruct op_devinfo_reply {\n\tstruct usbip_usb_device udev;\n\tstruct usbip_usb_interface uinf[];\n} __attribute__((packed));\n\n \n \n#define OP_IMPORT\t0x03\n#define OP_REQ_IMPORT\t(OP_REQUEST | OP_IMPORT)\n#define OP_REP_IMPORT   (OP_REPLY   | OP_IMPORT)\n\nstruct op_import_request {\n\tchar busid[SYSFS_BUS_ID_SIZE];\n} __attribute__((packed));\n\nstruct op_import_reply {\n\tstruct usbip_usb_device udev;\n\n} __attribute__((packed));\n\n#define PACK_OP_IMPORT_REQUEST(pack, request)  do {\\\n} while (0)\n\n#define PACK_OP_IMPORT_REPLY(pack, reply)  do {\\\n\tusbip_net_pack_usb_device(pack, &(reply)->udev);\\\n} while (0)\n\n \n \n#define OP_EXPORT\t0x06\n#define OP_REQ_EXPORT\t(OP_REQUEST | OP_EXPORT)\n#define OP_REP_EXPORT\t(OP_REPLY   | OP_EXPORT)\n\nstruct op_export_request {\n\tstruct usbip_usb_device udev;\n} __attribute__((packed));\n\nstruct op_export_reply {\n\tint returncode;\n} __attribute__((packed));\n\n\n#define PACK_OP_EXPORT_REQUEST(pack, request)  do {\\\n\tusbip_net_pack_usb_device(pack, &(request)->udev);\\\n} while (0)\n\n#define PACK_OP_EXPORT_REPLY(pack, reply)  do {\\\n} while (0)\n\n \n \n#define OP_UNEXPORT\t0x07\n#define OP_REQ_UNEXPORT\t(OP_REQUEST | OP_UNEXPORT)\n#define OP_REP_UNEXPORT\t(OP_REPLY   | OP_UNEXPORT)\n\nstruct op_unexport_request {\n\tstruct usbip_usb_device udev;\n} __attribute__((packed));\n\nstruct op_unexport_reply {\n\tint returncode;\n} __attribute__((packed));\n\n#define PACK_OP_UNEXPORT_REQUEST(pack, request)  do {\\\n\tusbip_net_pack_usb_device(pack, &(request)->udev);\\\n} while (0)\n\n#define PACK_OP_UNEXPORT_REPLY(pack, reply)  do {\\\n} while (0)\n\n \n \n#define OP_CRYPKEY\t0x04\n#define OP_REQ_CRYPKEY\t(OP_REQUEST | OP_CRYPKEY)\n#define OP_REP_CRYPKEY\t(OP_REPLY   | OP_CRYPKEY)\n\nstruct op_crypkey_request {\n\t \n\tuint32_t key[4];\n} __attribute__((packed));\n\nstruct op_crypkey_reply {\n\tuint32_t __reserved;\n} __attribute__((packed));\n\n\n \n \n#define OP_DEVLIST\t0x05\n#define OP_REQ_DEVLIST\t(OP_REQUEST | OP_DEVLIST)\n#define OP_REP_DEVLIST\t(OP_REPLY   | OP_DEVLIST)\n\nstruct op_devlist_request {\n} __attribute__((packed));\n\nstruct op_devlist_reply {\n\tuint32_t ndev;\n\t \n} __attribute__((packed));\n\nstruct op_devlist_reply_extra {\n\tstruct usbip_usb_device    udev;\n\tstruct usbip_usb_interface uinf[];\n} __attribute__((packed));\n\n#define PACK_OP_DEVLIST_REQUEST(pack, request)  do {\\\n} while (0)\n\n#define PACK_OP_DEVLIST_REPLY(pack, reply)  do {\\\n\t(reply)->ndev = usbip_net_pack_uint32_t(pack, (reply)->ndev);\\\n} while (0)\n\nuint32_t usbip_net_pack_uint32_t(int pack, uint32_t num);\nuint16_t usbip_net_pack_uint16_t(int pack, uint16_t num);\nvoid usbip_net_pack_usb_device(int pack, struct usbip_usb_device *udev);\nvoid usbip_net_pack_usb_interface(int pack, struct usbip_usb_interface *uinf);\n\nssize_t usbip_net_recv(int sockfd, void *buff, size_t bufflen);\nssize_t usbip_net_send(int sockfd, void *buff, size_t bufflen);\nint usbip_net_send_op_common(int sockfd, uint32_t code, uint32_t status);\nint usbip_net_recv_op_common(int sockfd, uint16_t *code, int *status);\nint usbip_net_set_reuseaddr(int sockfd);\nint usbip_net_set_nodelay(int sockfd);\nint usbip_net_set_keepalive(int sockfd);\nint usbip_net_set_v6only(int sockfd);\nint usbip_net_tcp_connect(char *hostname, char *port);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}