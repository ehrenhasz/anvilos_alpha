{
  "module_name": "kallsyms-parse.c",
  "hash_id": "898fb76e809d87395b3e111ca7222092b23ddcacad9587ad6460eb0717f885cf",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/bench/kallsyms-parse.c",
  "human_readable_source": "\n \n#include <stdlib.h>\n#include \"bench.h\"\n#include \"../util/stat.h\"\n#include <linux/time64.h>\n#include <subcmd/parse-options.h>\n#include <symbol/kallsyms.h>\n\nstatic unsigned int iterations = 100;\n\nstatic const struct option options[] = {\n\tOPT_UINTEGER('i', \"iterations\", &iterations,\n\t\t\"Number of iterations used to compute average\"),\n\tOPT_END()\n};\n\nstatic const char *const bench_usage[] = {\n\t\"perf bench internals kallsyms-parse <options>\",\n\tNULL\n};\n\nstatic int bench_process_symbol(void *arg __maybe_unused,\n\t\t\t\tconst char *name __maybe_unused,\n\t\t\t\tchar type __maybe_unused,\n\t\t\t\tu64 start __maybe_unused)\n{\n\treturn 0;\n}\n\nstatic int do_kallsyms_parse(void)\n{\n\tstruct timeval start, end, diff;\n\tu64 runtime_us;\n\tunsigned int i;\n\tdouble time_average, time_stddev;\n\tint err;\n\tstruct stats time_stats;\n\n\tinit_stats(&time_stats);\n\n\tfor (i = 0; i < iterations; i++) {\n\t\tgettimeofday(&start, NULL);\n\t\terr = kallsyms__parse(\"/proc/kallsyms\", NULL,\n\t\t\t\tbench_process_symbol);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\tgettimeofday(&end, NULL);\n\t\ttimersub(&end, &start, &diff);\n\t\truntime_us = diff.tv_sec * USEC_PER_SEC + diff.tv_usec;\n\t\tupdate_stats(&time_stats, runtime_us);\n\t}\n\n\ttime_average = avg_stats(&time_stats) / USEC_PER_MSEC;\n\ttime_stddev = stddev_stats(&time_stats) / USEC_PER_MSEC;\n\tprintf(\"  Average kallsyms__parse took: %.3f ms (+- %.3f ms)\\n\",\n\t\ttime_average, time_stddev);\n\treturn 0;\n}\n\nint bench_kallsyms_parse(int argc, const char **argv)\n{\n\targc = parse_options(argc, argv, options, bench_usage, 0);\n\tif (argc) {\n\t\tusage_with_options(bench_usage, options);\n\t\texit(EXIT_FAILURE);\n\t}\n\n\treturn do_kallsyms_parse();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}