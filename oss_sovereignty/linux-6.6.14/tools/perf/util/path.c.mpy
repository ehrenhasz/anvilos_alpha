{
  "module_name": "path.c",
  "hash_id": "1cfaf055128c52439728f907047e12b5b477e5d853a9fa154ffcab90fb67c05b",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/util/path.c",
  "human_readable_source": "\n#include \"path.h\"\n#include \"cache.h\"\n#include <linux/kernel.h>\n#include <limits.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <dirent.h>\n#include <unistd.h>\n\nstatic char *cleanup_path(char *path)\n{\n\t \n\tif (!memcmp(path, \"./\", 2)) {\n\t\tpath += 2;\n\t\twhile (*path == '/')\n\t\t\tpath++;\n\t}\n\treturn path;\n}\n\nchar *mkpath(char *path_buf, size_t sz, const char *fmt, ...)\n{\n\tva_list args;\n\tunsigned len;\n\n\tva_start(args, fmt);\n\tlen = vsnprintf(path_buf, sz, fmt, args);\n\tva_end(args);\n\tif (len >= sz)\n\t\tstrncpy(path_buf, \"/bad-path/\", sz);\n\treturn cleanup_path(path_buf);\n}\n\nint path__join(char *bf, size_t size, const char *path1, const char *path2)\n{\n\treturn scnprintf(bf, size, \"%s%s%s\", path1, path1[0] ? \"/\" : \"\", path2);\n}\n\nint path__join3(char *bf, size_t size, const char *path1, const char *path2, const char *path3)\n{\n\treturn scnprintf(bf, size, \"%s%s%s%s%s\", path1, path1[0] ? \"/\" : \"\",\n\t\t\t path2, path2[0] ? \"/\" : \"\", path3);\n}\n\nbool is_regular_file(const char *file)\n{\n\tstruct stat st;\n\n\tif (stat(file, &st))\n\t\treturn false;\n\n\treturn S_ISREG(st.st_mode);\n}\n\n \nbool is_directory(const char *base_path, const struct dirent *dent)\n{\n\tchar path[PATH_MAX];\n\tstruct stat st;\n\n\tsnprintf(path, sizeof(path), \"%s/%s\", base_path, dent->d_name);\n\tif (stat(path, &st))\n\t\treturn false;\n\n\treturn S_ISDIR(st.st_mode);\n}\n\nbool is_executable_file(const char *base_path, const struct dirent *dent)\n{\n\tchar path[PATH_MAX];\n\tstruct stat st;\n\n\tsnprintf(path, sizeof(path), \"%s/%s\", base_path, dent->d_name);\n\tif (stat(path, &st))\n\t\treturn false;\n\n\treturn !S_ISDIR(st.st_mode) && (st.st_mode & S_IXUSR);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}