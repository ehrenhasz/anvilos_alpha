{
  "module_name": "sort.h",
  "hash_id": "dad25d2b9b4eef394485626230d132c794a3870a29fee5a36008a19fbd5b6006",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/util/sort.h",
  "human_readable_source": " \n#ifndef __PERF_SORT_H\n#define __PERF_SORT_H\n#include <regex.h>\n#include <stdbool.h>\n#include <linux/list.h>\n#include <linux/rbtree.h>\n#include \"map_symbol.h\"\n#include \"symbol_conf.h\"\n#include \"callchain.h\"\n#include \"values.h\"\n#include \"hist.h\"\n#include \"stat.h\"\n#include \"spark.h\"\n\nstruct option;\nstruct thread;\n\nextern regex_t parent_regex;\nextern const char *sort_order;\nextern const char *field_order;\nextern const char default_parent_pattern[];\nextern const char *parent_pattern;\nextern const char *default_sort_order;\nextern regex_t ignore_callees_regex;\nextern int have_ignore_callees;\nextern enum sort_mode sort__mode;\nextern struct sort_entry sort_comm;\nextern struct sort_entry sort_dso;\nextern struct sort_entry sort_sym;\nextern struct sort_entry sort_parent;\nextern struct sort_entry sort_dso_from;\nextern struct sort_entry sort_dso_to;\nextern struct sort_entry sort_sym_from;\nextern struct sort_entry sort_sym_to;\nextern struct sort_entry sort_srcline;\nextern const char default_mem_sort_order[];\nextern bool chk_double_cl;\n\nstruct res_sample {\n\tu64 time;\n\tint cpu;\n\tint tid;\n};\n\nstruct he_stat {\n\tu64\t\t\tperiod;\n\tu64\t\t\tperiod_sys;\n\tu64\t\t\tperiod_us;\n\tu64\t\t\tperiod_guest_sys;\n\tu64\t\t\tperiod_guest_us;\n\tu32\t\t\tnr_events;\n};\n\nstruct namespace_id {\n\tu64\t\t\tdev;\n\tu64\t\t\tino;\n};\n\nstruct hist_entry_diff {\n\tbool\tcomputed;\n\tunion {\n\t\t \n\t\tdouble\tperiod_ratio_delta;\n\n\t\t \n\t\tdouble\tperiod_ratio;\n\n\t\t \n\t\ts64\twdiff;\n\n\t\t \n\t\ts64\tcycles;\n\t};\n\tstruct stats\tstats;\n\tunsigned long\tsvals[NUM_SPARKS];\n};\n\nstruct hist_entry_ops {\n\tvoid\t*(*new)(size_t size);\n\tvoid\t(*free)(void *ptr);\n};\n\n \nstruct hist_entry {\n\tstruct rb_node\t\trb_node_in;\n\tstruct rb_node\t\trb_node;\n\tunion {\n\t\tstruct list_head node;\n\t\tstruct list_head head;\n\t} pairs;\n\tstruct he_stat\t\tstat;\n\tstruct he_stat\t\t*stat_acc;\n\tstruct map_symbol\tms;\n\tstruct thread\t\t*thread;\n\tstruct comm\t\t*comm;\n\tstruct namespace_id\tcgroup_id;\n\tu64\t\t\tcgroup;\n\tu64\t\t\tip;\n\tu64\t\t\ttransaction;\n\ts32\t\t\tsocket;\n\ts32\t\t\tcpu;\n\tu64\t\t\tcode_page_size;\n\tu64\t\t\tweight;\n\tu64\t\t\tins_lat;\n\tu64\t\t\tp_stage_cyc;\n\tu8\t\t\tcpumode;\n\tu8\t\t\tdepth;\n\tstruct simd_flags\tsimd_flags;\n\n\t \n\tbool\t\t\tdummy;\n\tbool\t\t\tleaf;\n\n\tchar\t\t\tlevel;\n\tu8\t\t\tfiltered;\n\n\tu16\t\t\tcallchain_size;\n\tunion {\n\t\t \n\t\tstruct hist_entry_diff\tdiff;\n\t\tstruct   {\n\t\t\tu16\trow_offset;\n\t\t\tu16\tnr_rows;\n\t\t\tbool\tinit_have_children;\n\t\t\tbool\tunfolded;\n\t\t\tbool\thas_children;\n\t\t\tbool\thas_no_entry;\n\t\t};\n\t};\n\tchar\t\t\t*srcline;\n\tchar\t\t\t*srcfile;\n\tstruct symbol\t\t*parent;\n\tstruct branch_info\t*branch_info;\n\tlong\t\t\ttime;\n\tstruct hists\t\t*hists;\n\tstruct mem_info\t\t*mem_info;\n\tstruct block_info\t*block_info;\n\tstruct kvm_info\t\t*kvm_info;\n\tvoid\t\t\t*raw_data;\n\tu32\t\t\traw_size;\n\tint\t\t\tnum_res;\n\tstruct res_sample\t*res_samples;\n\tvoid\t\t\t*trace_output;\n\tstruct perf_hpp_list\t*hpp_list;\n\tstruct hist_entry\t*parent_he;\n\tstruct hist_entry_ops\t*ops;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\tstruct rb_root_cached\throot_in;\n\t\t\tstruct rb_root_cached   hroot_out;\n\t\t};\t\t\t\t \n\t\tstruct rb_root\tsorted_chain;\t \n\t};\n\tstruct callchain_root\tcallchain[0];  \n};\n\nstatic __pure inline bool hist_entry__has_callchains(struct hist_entry *he)\n{\n\treturn he->callchain_size != 0;\n}\n\nint hist_entry__sym_snprintf(struct hist_entry *he, char *bf, size_t size, unsigned int width);\n\nstatic inline bool hist_entry__has_pairs(struct hist_entry *he)\n{\n\treturn !list_empty(&he->pairs.node);\n}\n\nstatic inline struct hist_entry *hist_entry__next_pair(struct hist_entry *he)\n{\n\tif (hist_entry__has_pairs(he))\n\t\treturn list_entry(he->pairs.node.next, struct hist_entry, pairs.node);\n\treturn NULL;\n}\n\nstatic inline void hist_entry__add_pair(struct hist_entry *pair,\n\t\t\t\t\tstruct hist_entry *he)\n{\n\tlist_add_tail(&pair->pairs.node, &he->pairs.head);\n}\n\nstatic inline float hist_entry__get_percent_limit(struct hist_entry *he)\n{\n\tu64 period = he->stat.period;\n\tu64 total_period = hists__total_period(he->hists);\n\n\tif (unlikely(total_period == 0))\n\t\treturn 0;\n\n\tif (symbol_conf.cumulate_callchain)\n\t\tperiod = he->stat_acc->period;\n\n\treturn period * 100.0 / total_period;\n}\n\nenum sort_mode {\n\tSORT_MODE__NORMAL,\n\tSORT_MODE__BRANCH,\n\tSORT_MODE__MEMORY,\n\tSORT_MODE__TOP,\n\tSORT_MODE__DIFF,\n\tSORT_MODE__TRACEPOINT,\n};\n\nenum sort_type {\n\t \n\tSORT_PID,\n\tSORT_COMM,\n\tSORT_DSO,\n\tSORT_SYM,\n\tSORT_PARENT,\n\tSORT_CPU,\n\tSORT_SOCKET,\n\tSORT_SRCLINE,\n\tSORT_SRCFILE,\n\tSORT_LOCAL_WEIGHT,\n\tSORT_GLOBAL_WEIGHT,\n\tSORT_TRANSACTION,\n\tSORT_TRACE,\n\tSORT_SYM_SIZE,\n\tSORT_DSO_SIZE,\n\tSORT_CGROUP,\n\tSORT_CGROUP_ID,\n\tSORT_SYM_IPC_NULL,\n\tSORT_TIME,\n\tSORT_CODE_PAGE_SIZE,\n\tSORT_LOCAL_INS_LAT,\n\tSORT_GLOBAL_INS_LAT,\n\tSORT_LOCAL_PIPELINE_STAGE_CYC,\n\tSORT_GLOBAL_PIPELINE_STAGE_CYC,\n\tSORT_ADDR,\n\tSORT_LOCAL_RETIRE_LAT,\n\tSORT_GLOBAL_RETIRE_LAT,\n\tSORT_SIMD,\n\n\t \n\t__SORT_BRANCH_STACK,\n\tSORT_DSO_FROM = __SORT_BRANCH_STACK,\n\tSORT_DSO_TO,\n\tSORT_SYM_FROM,\n\tSORT_SYM_TO,\n\tSORT_MISPREDICT,\n\tSORT_ABORT,\n\tSORT_IN_TX,\n\tSORT_CYCLES,\n\tSORT_SRCLINE_FROM,\n\tSORT_SRCLINE_TO,\n\tSORT_SYM_IPC,\n\tSORT_ADDR_FROM,\n\tSORT_ADDR_TO,\n\n\t \n\t__SORT_MEMORY_MODE,\n\tSORT_MEM_DADDR_SYMBOL = __SORT_MEMORY_MODE,\n\tSORT_MEM_DADDR_DSO,\n\tSORT_MEM_LOCKED,\n\tSORT_MEM_TLB,\n\tSORT_MEM_LVL,\n\tSORT_MEM_SNOOP,\n\tSORT_MEM_DCACHELINE,\n\tSORT_MEM_IADDR_SYMBOL,\n\tSORT_MEM_PHYS_DADDR,\n\tSORT_MEM_DATA_PAGE_SIZE,\n\tSORT_MEM_BLOCKED,\n};\n\n \n\nstruct sort_entry {\n\tconst char *se_header;\n\n\tint64_t (*se_cmp)(struct hist_entry *, struct hist_entry *);\n\tint64_t (*se_collapse)(struct hist_entry *, struct hist_entry *);\n\tint64_t\t(*se_sort)(struct hist_entry *, struct hist_entry *);\n\tint\t(*se_snprintf)(struct hist_entry *he, char *bf, size_t size,\n\t\t\t       unsigned int width);\n\tint\t(*se_filter)(struct hist_entry *he, int type, const void *arg);\n\tvoid\t(*se_init)(struct hist_entry *he);\n\tu8\tse_width_idx;\n};\n\nstruct block_hist {\n\tstruct hists\t\tblock_hists;\n\tstruct perf_hpp_list\tblock_list;\n\tstruct perf_hpp_fmt\tblock_fmt;\n\tint\t\t\tblock_idx;\n\tbool\t\t\tvalid;\n\tstruct hist_entry\the;\n};\n\nextern struct sort_entry sort_thread;\n\nstruct evlist;\nstruct tep_handle;\nint setup_sorting(struct evlist *evlist);\nint setup_output_field(void);\nvoid reset_output_field(void);\nvoid sort__setup_elide(FILE *fp);\nvoid perf_hpp__set_elide(int idx, bool elide);\n\nchar *sort_help(const char *prefix);\n\nint report_parse_ignore_callees_opt(const struct option *opt, const char *arg, int unset);\n\nbool is_strict_order(const char *order);\n\nint hpp_dimension__add_output(unsigned col);\nvoid reset_dimensions(void);\nint sort_dimension__add(struct perf_hpp_list *list, const char *tok,\n\t\t\tstruct evlist *evlist,\n\t\t\tint level);\nint output_field_add(struct perf_hpp_list *list, char *tok);\nint64_t\nsort__iaddr_cmp(struct hist_entry *left, struct hist_entry *right);\nint64_t\nsort__daddr_cmp(struct hist_entry *left, struct hist_entry *right);\nint64_t\nsort__dcacheline_cmp(struct hist_entry *left, struct hist_entry *right);\nint64_t\n_sort__sym_cmp(struct symbol *sym_l, struct symbol *sym_r);\nchar *hist_entry__srcline(struct hist_entry *he);\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}