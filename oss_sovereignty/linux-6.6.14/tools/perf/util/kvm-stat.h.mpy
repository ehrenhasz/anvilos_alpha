{
  "module_name": "kvm-stat.h",
  "hash_id": "6de0cc07ee94bf9a57e705290db20271ce23af60ec27dd14cf9171c3d9df4924",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/util/kvm-stat.h",
  "human_readable_source": " \n#ifndef __PERF_KVM_STAT_H\n#define __PERF_KVM_STAT_H\n\n#ifdef HAVE_KVM_STAT_SUPPORT\n\n#include \"tool.h\"\n#include \"sort.h\"\n#include \"stat.h\"\n#include \"symbol.h\"\n#include \"record.h\"\n\n#include <stdlib.h>\n#include <linux/zalloc.h>\n\n#define KVM_EVENT_NAME_LEN\t40\n\nstruct evsel;\nstruct evlist;\nstruct perf_session;\n\nstruct event_key {\n\t#define INVALID_KEY     (~0ULL)\n\tu64 key;\n\tint info;\n\tstruct exit_reasons_table *exit_reasons;\n};\n\nstruct kvm_info {\n\tchar name[KVM_EVENT_NAME_LEN];\n\trefcount_t refcnt;\n};\n\nstruct kvm_event_stats {\n\tu64 time;\n\tstruct stats stats;\n};\n\nstruct perf_kvm_stat;\n\nstruct kvm_event {\n\tstruct list_head hash_entry;\n\n\tstruct perf_kvm_stat *perf_kvm;\n\tstruct event_key key;\n\n\tstruct kvm_event_stats total;\n\n\t#define DEFAULT_VCPU_NUM 8\n\tint max_vcpu;\n\tstruct kvm_event_stats *vcpu;\n\n\tstruct hist_entry he;\n};\n\nstruct child_event_ops {\n\tvoid (*get_key)(struct evsel *evsel,\n\t\t\tstruct perf_sample *sample,\n\t\t\tstruct event_key *key);\n\tconst char *name;\n};\n\nstruct kvm_events_ops {\n\tbool (*is_begin_event)(struct evsel *evsel,\n\t\t\t       struct perf_sample *sample,\n\t\t\t       struct event_key *key);\n\tbool (*is_end_event)(struct evsel *evsel,\n\t\t\t     struct perf_sample *sample, struct event_key *key);\n\tstruct child_event_ops *child_ops;\n\tvoid (*decode_key)(struct perf_kvm_stat *kvm, struct event_key *key,\n\t\t\t   char *decode);\n\tconst char *name;\n};\n\nstruct exit_reasons_table {\n\tunsigned long exit_code;\n\tconst char *reason;\n};\n\nstruct perf_kvm_stat {\n\tstruct perf_tool    tool;\n\tstruct record_opts  opts;\n\tstruct evlist  *evlist;\n\tstruct perf_session *session;\n\n\tconst char *file_name;\n\tconst char *report_event;\n\tconst char *sort_key;\n\tint trace_vcpu;\n\n\t \n\tstruct addr_location al;\n\n\tstruct exit_reasons_table *exit_reasons;\n\tconst char *exit_reasons_isa;\n\n\tstruct kvm_events_ops *events_ops;\n\n\tu64 total_time;\n\tu64 total_count;\n\tu64 lost_events;\n\tu64 duration;\n\n\tstruct intlist *pid_list;\n\n\tint timerfd;\n\tunsigned int display_time;\n\tbool live;\n\tbool force;\n\tbool use_stdio;\n};\n\nstruct kvm_reg_events_ops {\n\tconst char *name;\n\tstruct kvm_events_ops *ops;\n};\n\nvoid exit_event_get_key(struct evsel *evsel,\n\t\t\tstruct perf_sample *sample,\n\t\t\tstruct event_key *key);\nbool exit_event_begin(struct evsel *evsel,\n\t\t      struct perf_sample *sample,\n\t\t      struct event_key *key);\nbool exit_event_end(struct evsel *evsel,\n\t\t    struct perf_sample *sample,\n\t\t    struct event_key *key);\nvoid exit_event_decode_key(struct perf_kvm_stat *kvm,\n\t\t\t   struct event_key *key,\n\t\t\t   char *decode);\n\nbool kvm_exit_event(struct evsel *evsel);\nbool kvm_entry_event(struct evsel *evsel);\nint setup_kvm_events_tp(struct perf_kvm_stat *kvm);\n\n#define define_exit_reasons_table(name, symbols)\t\\\n\tstatic struct exit_reasons_table name[] = {\t\\\n\t\tsymbols, { -1, NULL }\t\t\t\\\n\t}\n\n \nint cpu_isa_init(struct perf_kvm_stat *kvm, const char *cpuid);\n\nextern const char *kvm_events_tp[];\nextern struct kvm_reg_events_ops kvm_reg_events_ops[];\nextern const char * const kvm_skip_events[];\nextern const char *vcpu_id_str;\nextern const char *kvm_exit_reason;\nextern const char *kvm_entry_trace;\nextern const char *kvm_exit_trace;\n\nstatic inline struct kvm_info *kvm_info__get(struct kvm_info *ki)\n{\n\tif (ki)\n\t\trefcount_inc(&ki->refcnt);\n\treturn ki;\n}\n\nstatic inline void kvm_info__put(struct kvm_info *ki)\n{\n\tif (ki && refcount_dec_and_test(&ki->refcnt))\n\t\tfree(ki);\n}\n\nstatic inline void __kvm_info__zput(struct kvm_info **ki)\n{\n\tkvm_info__put(*ki);\n\t*ki = NULL;\n}\n\n#define kvm_info__zput(ki) __kvm_info__zput(&ki)\n\nstatic inline struct kvm_info *kvm_info__new(void)\n{\n\tstruct kvm_info *ki;\n\n\tki = zalloc(sizeof(*ki));\n\tif (ki)\n\t\trefcount_set(&ki->refcnt, 1);\n\n\treturn ki;\n}\n\n#else  \n\n#define kvm_info__zput(ki) do { } while (0)\n#endif  \n\nextern int kvm_add_default_arch_event(int *argc, const char **argv);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}