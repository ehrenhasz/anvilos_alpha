{
  "module_name": "perf_regs.c",
  "hash_id": "d740561ceaccf07142b261ab04a82f1ad2eedbcebb8bf70e21f225d87e755b35",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/util/perf_regs.c",
  "human_readable_source": "\n#include <errno.h>\n#include <string.h>\n#include \"perf_regs.h\"\n#include \"util/sample.h\"\n#include \"debug.h\"\n\nint __weak arch_sdt_arg_parse_op(char *old_op __maybe_unused,\n\t\t\t\t char **new_op __maybe_unused)\n{\n\treturn SDT_ARG_SKIP;\n}\n\nuint64_t __weak arch__intr_reg_mask(void)\n{\n\treturn 0;\n}\n\nuint64_t __weak arch__user_reg_mask(void)\n{\n\treturn 0;\n}\n\n#ifdef HAVE_PERF_REGS_SUPPORT\n\nconst char *perf_reg_name(int id, const char *arch)\n{\n\tconst char *reg_name = NULL;\n\n\tif (!strcmp(arch, \"csky\"))\n\t\treg_name = __perf_reg_name_csky(id);\n\telse if (!strcmp(arch, \"loongarch\"))\n\t\treg_name = __perf_reg_name_loongarch(id);\n\telse if (!strcmp(arch, \"mips\"))\n\t\treg_name = __perf_reg_name_mips(id);\n\telse if (!strcmp(arch, \"powerpc\"))\n\t\treg_name = __perf_reg_name_powerpc(id);\n\telse if (!strcmp(arch, \"riscv\"))\n\t\treg_name = __perf_reg_name_riscv(id);\n\telse if (!strcmp(arch, \"s390\"))\n\t\treg_name = __perf_reg_name_s390(id);\n\telse if (!strcmp(arch, \"x86\"))\n\t\treg_name = __perf_reg_name_x86(id);\n\telse if (!strcmp(arch, \"arm\"))\n\t\treg_name = __perf_reg_name_arm(id);\n\telse if (!strcmp(arch, \"arm64\"))\n\t\treg_name = __perf_reg_name_arm64(id);\n\n\treturn reg_name ?: \"unknown\";\n}\n\nint perf_reg_value(u64 *valp, struct regs_dump *regs, int id)\n{\n\tint i, idx = 0;\n\tu64 mask = regs->mask;\n\n\tif ((u64)id >= PERF_SAMPLE_REGS_CACHE_SIZE)\n\t\treturn -EINVAL;\n\n\tif (regs->cache_mask & (1ULL << id))\n\t\tgoto out;\n\n\tif (!(mask & (1ULL << id)))\n\t\treturn -EINVAL;\n\n\tfor (i = 0; i < id; i++) {\n\t\tif (mask & (1ULL << i))\n\t\t\tidx++;\n\t}\n\n\tregs->cache_mask |= (1ULL << id);\n\tregs->cache_regs[id] = regs->regs[idx];\n\nout:\n\t*valp = regs->cache_regs[id];\n\treturn 0;\n}\n\nuint64_t perf_arch_reg_ip(const char *arch)\n{\n\tif (!strcmp(arch, \"arm\"))\n\t\treturn __perf_reg_ip_arm();\n\telse if (!strcmp(arch, \"arm64\"))\n\t\treturn __perf_reg_ip_arm64();\n\telse if (!strcmp(arch, \"csky\"))\n\t\treturn __perf_reg_ip_csky();\n\telse if (!strcmp(arch, \"loongarch\"))\n\t\treturn __perf_reg_ip_loongarch();\n\telse if (!strcmp(arch, \"mips\"))\n\t\treturn __perf_reg_ip_mips();\n\telse if (!strcmp(arch, \"powerpc\"))\n\t\treturn __perf_reg_ip_powerpc();\n\telse if (!strcmp(arch, \"riscv\"))\n\t\treturn __perf_reg_ip_riscv();\n\telse if (!strcmp(arch, \"s390\"))\n\t\treturn __perf_reg_ip_s390();\n\telse if (!strcmp(arch, \"x86\"))\n\t\treturn __perf_reg_ip_x86();\n\n\tpr_err(\"Fail to find IP register for arch %s, returns 0\\n\", arch);\n\treturn 0;\n}\n\nuint64_t perf_arch_reg_sp(const char *arch)\n{\n\tif (!strcmp(arch, \"arm\"))\n\t\treturn __perf_reg_sp_arm();\n\telse if (!strcmp(arch, \"arm64\"))\n\t\treturn __perf_reg_sp_arm64();\n\telse if (!strcmp(arch, \"csky\"))\n\t\treturn __perf_reg_sp_csky();\n\telse if (!strcmp(arch, \"loongarch\"))\n\t\treturn __perf_reg_sp_loongarch();\n\telse if (!strcmp(arch, \"mips\"))\n\t\treturn __perf_reg_sp_mips();\n\telse if (!strcmp(arch, \"powerpc\"))\n\t\treturn __perf_reg_sp_powerpc();\n\telse if (!strcmp(arch, \"riscv\"))\n\t\treturn __perf_reg_sp_riscv();\n\telse if (!strcmp(arch, \"s390\"))\n\t\treturn __perf_reg_sp_s390();\n\telse if (!strcmp(arch, \"x86\"))\n\t\treturn __perf_reg_sp_x86();\n\n\tpr_err(\"Fail to find SP register for arch %s, returns 0\\n\", arch);\n\treturn 0;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}