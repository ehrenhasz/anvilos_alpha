{
  "module_name": "rb_resort.h",
  "hash_id": "93240eeb7d9c788ac069d5cb9fdebb345e066caeab889006bac7796410bc3717",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/util/rb_resort.h",
  "human_readable_source": " \n#ifndef _PERF_RESORT_RB_H_\n#define _PERF_RESORT_RB_H_\n \n\n#define DEFINE_RESORT_RB(__name, __comp, ...)\t\t\t\t\t\\\nstruct __name##_sorted_entry {\t\t\t\t\t\t\t\\\n\tstruct rb_node\trb_node;\t\t\t\t\t\t\\\n\t__VA_ARGS__\t\t\t\t\t\t\t\t\\\n};\t\t\t\t\t\t\t\t\t\t\\\nstatic void __name##_sorted__init_entry(struct rb_node *nd,\t\t\t\\\n\t\t\t\t\tstruct __name##_sorted_entry *entry);\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic int __name##_sorted__cmp(struct rb_node *nda, struct rb_node *ndb)\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tstruct __name##_sorted_entry *a, *b;\t\t\t\t\t\\\n\ta = rb_entry(nda, struct __name##_sorted_entry, rb_node);\t\t\\\n\tb = rb_entry(ndb, struct __name##_sorted_entry, rb_node);\t\t\\\n\treturn __comp;\t\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstruct __name##_sorted {\t\t\t\t\t\t\t\\\n       struct rb_root\t\t    entries;\t\t\t\t\t\\\n       struct __name##_sorted_entry nd[0];\t\t\t\t\t\\\n};\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic void __name##_sorted__insert(struct __name##_sorted *sorted,\t\t\\\n\t\t\t\t      struct rb_node *sorted_nd)\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tstruct rb_node **p = &sorted->entries.rb_node, *parent = NULL;\t\t\\\n\twhile (*p != NULL) {\t\t\t\t\t\t\t\\\n\t\tparent = *p;\t\t\t\t\t\t\t\\\n\t\tif (__name##_sorted__cmp(sorted_nd, parent))\t\t\t\\\n\t\t\tp = &(*p)->rb_left;\t\t\t\t\t\\\n\t\telse\t\t\t\t\t\t\t\t\\\n\t\t\tp = &(*p)->rb_right;\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\trb_link_node(sorted_nd, parent, p);\t\t\t\t\t\\\n\trb_insert_color(sorted_nd, &sorted->entries);\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic void __name##_sorted__sort(struct __name##_sorted *sorted,\t\t\\\n\t\t\t\t    struct rb_root *entries)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tstruct rb_node *nd;\t\t\t\t\t\t\t\\\n\tunsigned int i = 0;\t\t\t\t\t\t\t\\\n\tfor (nd = rb_first(entries); nd; nd = rb_next(nd)) {\t\t\t\\\n\t\tstruct __name##_sorted_entry *snd = &sorted->nd[i++];\t\t\\\n\t\t__name##_sorted__init_entry(nd, snd);\t\t\t\t\\\n\t\t__name##_sorted__insert(sorted, &snd->rb_node);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic struct __name##_sorted *__name##_sorted__new(struct rb_root *entries,\t\\\n\t\t\t\t\t\t    int nr_entries)\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tstruct __name##_sorted *sorted;\t\t\t\t\t\t\\\n\tsorted = malloc(sizeof(*sorted) + sizeof(sorted->nd[0]) * nr_entries);\t\\\n\tif (sorted) {\t\t\t\t\t\t\t\t\\\n\t\tsorted->entries = RB_ROOT;\t\t\t\t\t\\\n\t\t__name##_sorted__sort(sorted, entries);\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\treturn sorted;\t\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic void __name##_sorted__delete(struct __name##_sorted *sorted)\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tfree(sorted);\t\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\nstatic void __name##_sorted__init_entry(struct rb_node *nd,\t\t\t\\\n\t\t\t\t\tstruct __name##_sorted_entry *entry)\n\n#define DECLARE_RESORT_RB(__name)\t\t\t\t\t\t\\\nstruct __name##_sorted_entry *__name##_entry;\t\t\t\t\t\\\nstruct __name##_sorted *__name = __name##_sorted__new\n\n#define resort_rb__for_each_entry(__nd, __name)\t\t\t\t\t\\\n\tfor (__nd = rb_first(&__name->entries);\t\t\t\t\t\\\n\t     __name##_entry = rb_entry(__nd, struct __name##_sorted_entry,\t\\\n\t\t\t\t       rb_node), __nd;\t\t\t\t\\\n\t     __nd = rb_next(__nd))\n\n#define resort_rb__delete(__name)\t\t\t\t\t\t\\\n\t__name##_sorted__delete(__name), __name = NULL\n\n \n\n \n#define DECLARE_RESORT_RB_INTLIST(__name, __ilist)\t\t\t\t\\\n\tDECLARE_RESORT_RB(__name)(&__ilist->rblist.entries.rb_root,\t\t\\\n\t\t\t\t  __ilist->rblist.nr_entries)\n\n \n#define DECLARE_RESORT_RB_MACHINE_THREADS(__name, __machine, hash_bucket)    \\\n DECLARE_RESORT_RB(__name)(&__machine->threads[hash_bucket].entries.rb_root, \\\n\t\t\t   __machine->threads[hash_bucket].nr)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}