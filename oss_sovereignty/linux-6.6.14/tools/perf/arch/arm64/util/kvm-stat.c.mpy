{
  "module_name": "kvm-stat.c",
  "hash_id": "5a99af926b052b7dac7b069ee3b29b9398f5ef17b59d1bf0cb9238a699a50a1f",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/arch/arm64/util/kvm-stat.c",
  "human_readable_source": "\n#include <errno.h>\n#include <memory.h>\n#include \"../../../util/evsel.h\"\n#include \"../../../util/kvm-stat.h\"\n#include \"arm64_exception_types.h\"\n#include \"debug.h\"\n\ndefine_exit_reasons_table(arm64_exit_reasons, kvm_arm_exception_type);\ndefine_exit_reasons_table(arm64_trap_exit_reasons, kvm_arm_exception_class);\n\nconst char *kvm_trap_exit_reason = \"esr_ec\";\nconst char *vcpu_id_str = \"id\";\nconst char *kvm_exit_reason = \"ret\";\nconst char *kvm_entry_trace = \"kvm:kvm_entry\";\nconst char *kvm_exit_trace = \"kvm:kvm_exit\";\n\nconst char *kvm_events_tp[] = {\n\t\"kvm:kvm_entry\",\n\t\"kvm:kvm_exit\",\n\tNULL,\n};\n\nstatic void event_get_key(struct evsel *evsel,\n\t\t\t  struct perf_sample *sample,\n\t\t\t  struct event_key *key)\n{\n\tkey->info = 0;\n\tkey->key = evsel__intval(evsel, sample, kvm_exit_reason);\n\tkey->exit_reasons = arm64_exit_reasons;\n\n\t \n\tif (key->key == ARM_EXCEPTION_TRAP) {\n\t\tkey->key = evsel__intval(evsel, sample, kvm_trap_exit_reason);\n\t\tkey->exit_reasons = arm64_trap_exit_reasons;\n\t}\n}\n\nstatic bool event_begin(struct evsel *evsel,\n\t\t\tstruct perf_sample *sample __maybe_unused,\n\t\t\tstruct event_key *key __maybe_unused)\n{\n\treturn evsel__name_is(evsel, kvm_entry_trace);\n}\n\nstatic bool event_end(struct evsel *evsel,\n\t\t      struct perf_sample *sample,\n\t\t      struct event_key *key)\n{\n\tif (evsel__name_is(evsel, kvm_exit_trace)) {\n\t\tevent_get_key(evsel, sample, key);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic struct kvm_events_ops exit_events = {\n\t.is_begin_event = event_begin,\n\t.is_end_event\t= event_end,\n\t.decode_key\t= exit_event_decode_key,\n\t.name\t\t= \"VM-EXIT\"\n};\n\nstruct kvm_reg_events_ops kvm_reg_events_ops[] = {\n\t{\n\t\t.name\t= \"vmexit\",\n\t\t.ops\t= &exit_events,\n\t},\n\t{ NULL, NULL },\n};\n\nconst char * const kvm_skip_events[] = {\n\tNULL,\n};\n\nint cpu_isa_init(struct perf_kvm_stat *kvm, const char *cpuid __maybe_unused)\n{\n\tkvm->exit_reasons_isa = \"arm64\";\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}