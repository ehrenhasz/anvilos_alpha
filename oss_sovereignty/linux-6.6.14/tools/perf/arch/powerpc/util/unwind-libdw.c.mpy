{
  "module_name": "unwind-libdw.c",
  "hash_id": "091115da1fdc7c89876698ccb517e8c3d2363fd8997d51ea87d3ae75d820bb34",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/arch/powerpc/util/unwind-libdw.c",
  "human_readable_source": "\n#include <elfutils/libdwfl.h>\n#include <linux/kernel.h>\n#include \"perf_regs.h\"\n#include \"../../../util/unwind-libdw.h\"\n#include \"../../../util/perf_regs.h\"\n#include \"../../../util/sample.h\"\n\n \nstatic const int special_regs[3][2] = {\n\t{ 65, PERF_REG_POWERPC_LINK },\n\t{ 101, PERF_REG_POWERPC_XER },\n\t{ 109, PERF_REG_POWERPC_CTR },\n};\n\nbool libdw__arch_set_initial_registers(Dwfl_Thread *thread, void *arg)\n{\n\tstruct unwind_info *ui = arg;\n\tstruct regs_dump *user_regs = &ui->sample->user_regs;\n\tDwarf_Word dwarf_regs[32], dwarf_nip;\n\tsize_t i;\n\n#define REG(r) ({\t\t\t\t\t\t\\\n\tDwarf_Word val = 0;\t\t\t\t\t\\\n\tperf_reg_value(&val, user_regs, PERF_REG_POWERPC_##r);\t\\\n\tval;\t\t\t\t\t\t\t\\\n})\n\n\tdwarf_regs[0]  = REG(R0);\n\tdwarf_regs[1]  = REG(R1);\n\tdwarf_regs[2]  = REG(R2);\n\tdwarf_regs[3]  = REG(R3);\n\tdwarf_regs[4]  = REG(R4);\n\tdwarf_regs[5]  = REG(R5);\n\tdwarf_regs[6]  = REG(R6);\n\tdwarf_regs[7]  = REG(R7);\n\tdwarf_regs[8]  = REG(R8);\n\tdwarf_regs[9]  = REG(R9);\n\tdwarf_regs[10] = REG(R10);\n\tdwarf_regs[11] = REG(R11);\n\tdwarf_regs[12] = REG(R12);\n\tdwarf_regs[13] = REG(R13);\n\tdwarf_regs[14] = REG(R14);\n\tdwarf_regs[15] = REG(R15);\n\tdwarf_regs[16] = REG(R16);\n\tdwarf_regs[17] = REG(R17);\n\tdwarf_regs[18] = REG(R18);\n\tdwarf_regs[19] = REG(R19);\n\tdwarf_regs[20] = REG(R20);\n\tdwarf_regs[21] = REG(R21);\n\tdwarf_regs[22] = REG(R22);\n\tdwarf_regs[23] = REG(R23);\n\tdwarf_regs[24] = REG(R24);\n\tdwarf_regs[25] = REG(R25);\n\tdwarf_regs[26] = REG(R26);\n\tdwarf_regs[27] = REG(R27);\n\tdwarf_regs[28] = REG(R28);\n\tdwarf_regs[29] = REG(R29);\n\tdwarf_regs[30] = REG(R30);\n\tdwarf_regs[31] = REG(R31);\n\tif (!dwfl_thread_state_registers(thread, 0, 32, dwarf_regs))\n\t\treturn false;\n\n\tdwarf_nip = REG(NIP);\n\tdwfl_thread_state_register_pc(thread, dwarf_nip);\n\tfor (i = 0; i < ARRAY_SIZE(special_regs); i++) {\n\t\tDwarf_Word val = 0;\n\t\tperf_reg_value(&val, user_regs, special_regs[i][1]);\n\t\tif (!dwfl_thread_state_registers(thread,\n\t\t\t\t\t\t special_regs[i][0], 1,\n\t\t\t\t\t\t &val))\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}