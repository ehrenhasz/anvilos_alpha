{
  "module_name": "syscall-counts-by-pid.py",
  "hash_id": "84221f3d9d6b0147ab70252dcd3521767551b0802cda4ff6f1866220cc16257a",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/scripts/python/syscall-counts-by-pid.py",
  "human_readable_source": "# system call counts, by pid\n# (c) 2010, Tom Zanussi <tzanussi@gmail.com>\n# Licensed under the terms of the GNU GPL License version 2\n#\n# Displays system-wide system call totals, broken down by syscall.\n# If a [comm] arg is specified, only syscalls called by [comm] are displayed.\n\nfrom __future__ import print_function\n\nimport os, sys\n\nsys.path.append(os.environ['PERF_EXEC_PATH'] + \\\n\t'/scripts/python/Perf-Trace-Util/lib/Perf/Trace')\n\nfrom perf_trace_context import *\nfrom Core import *\nfrom Util import syscall_name\n\nusage = \"perf script -s syscall-counts-by-pid.py [comm]\\n\";\n\nfor_comm = None\nfor_pid = None\n\nif len(sys.argv) > 2:\n\tsys.exit(usage)\n\nif len(sys.argv) > 1:\n\ttry:\n\t\tfor_pid = int(sys.argv[1])\n\texcept:\n\t\tfor_comm = sys.argv[1]\n\nsyscalls = autodict()\n\ndef trace_begin():\n\tprint(\"Press control+C to stop and show the summary\")\n\ndef trace_end():\n\tprint_syscall_totals()\n\ndef raw_syscalls__sys_enter(event_name, context, common_cpu,\n\t\tcommon_secs, common_nsecs, common_pid, common_comm,\n\t\tcommon_callchain, id, args):\n\tif (for_comm and common_comm != for_comm) or \\\n\t\t(for_pid and common_pid != for_pid ):\n\t\treturn\n\ttry:\n\t\tsyscalls[common_comm][common_pid][id] += 1\n\texcept TypeError:\n\t\tsyscalls[common_comm][common_pid][id] = 1\n\ndef syscalls__sys_enter(event_name, context, common_cpu,\n\t\tcommon_secs, common_nsecs, common_pid, common_comm,\n\t\tid, args):\n\traw_syscalls__sys_enter(**locals())\n\ndef print_syscall_totals():\n\tif for_comm is not None:\n\t\tprint(\"\\nsyscall events for %s:\\n\" % (for_comm))\n\telse:\n\t\tprint(\"\\nsyscall events by comm/pid:\\n\")\n\n\tprint(\"%-40s  %10s\" % (\"comm [pid]/syscalls\", \"count\"))\n\tprint(\"%-40s  %10s\" % (\"----------------------------------------\",\n\t\t\t\t\"----------\"))\n\n\tcomm_keys = syscalls.keys()\n\tfor comm in comm_keys:\n\t\tpid_keys = syscalls[comm].keys()\n\t\tfor pid in pid_keys:\n\t\t\tprint(\"\\n%s [%d]\" % (comm, pid))\n\t\t\tid_keys = syscalls[comm][pid].keys()\n\t\t\tfor id, val in sorted(syscalls[comm][pid].items(),\n\t\t\t\tkey = lambda kv: (kv[1], kv[0]), reverse = True):\n\t\t\t\tprint(\"  %-38s  %10d\" % (syscall_name(id), val))\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}