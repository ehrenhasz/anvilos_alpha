{
  "module_name": "failed-syscalls-by-pid.py",
  "hash_id": "533180dbe97361a4f73e8199e49e245d9fc28cc380ed6dbb19df4542ba6205a6",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/scripts/python/failed-syscalls-by-pid.py",
  "human_readable_source": "# failed system call counts, by pid\n# (c) 2010, Tom Zanussi <tzanussi@gmail.com>\n# Licensed under the terms of the GNU GPL License version 2\n#\n# Displays system-wide failed system call totals, broken down by pid.\n# If a [comm] arg is specified, only syscalls called by [comm] are displayed.\n\nfrom __future__ import print_function\n\nimport os\nimport sys\n\nsys.path.append(os.environ['PERF_EXEC_PATH'] + \\\n\t'/scripts/python/Perf-Trace-Util/lib/Perf/Trace')\n\nfrom perf_trace_context import *\nfrom Core import *\nfrom Util import *\n\nusage = \"perf script -s syscall-counts-by-pid.py [comm|pid]\\n\";\n\nfor_comm = None\nfor_pid = None\n\nif len(sys.argv) > 2:\n\tsys.exit(usage)\n\nif len(sys.argv) > 1:\n\ttry:\n\t\tfor_pid = int(sys.argv[1])\n\texcept:\n\t\tfor_comm = sys.argv[1]\n\nsyscalls = autodict()\n\ndef trace_begin():\n\tprint(\"Press control+C to stop and show the summary\")\n\ndef trace_end():\n\tprint_error_totals()\n\ndef raw_syscalls__sys_exit(event_name, context, common_cpu,\n\tcommon_secs, common_nsecs, common_pid, common_comm,\n\tcommon_callchain, id, ret):\n\tif (for_comm and common_comm != for_comm) or \\\n\t   (for_pid  and common_pid  != for_pid ):\n\t\treturn\n\n\tif ret < 0:\n\t\ttry:\n\t\t\tsyscalls[common_comm][common_pid][id][ret] += 1\n\t\texcept TypeError:\n\t\t\tsyscalls[common_comm][common_pid][id][ret] = 1\n\ndef syscalls__sys_exit(event_name, context, common_cpu,\n\tcommon_secs, common_nsecs, common_pid, common_comm,\n\tid, ret):\n\traw_syscalls__sys_exit(**locals())\n\ndef print_error_totals():\n\tif for_comm is not None:\n\t\tprint(\"\\nsyscall errors for %s:\\n\" % (for_comm))\n\telse:\n\t\tprint(\"\\nsyscall errors:\\n\")\n\n\tprint(\"%-30s  %10s\" % (\"comm [pid]\", \"count\"))\n\tprint(\"%-30s  %10s\" % (\"------------------------------\", \"----------\"))\n\n\tcomm_keys = syscalls.keys()\n\tfor comm in comm_keys:\n\t\tpid_keys = syscalls[comm].keys()\n\t\tfor pid in pid_keys:\n\t\t\tprint(\"\\n%s [%d]\" % (comm, pid))\n\t\t\tid_keys = syscalls[comm][pid].keys()\n\t\t\tfor id in id_keys:\n\t\t\t\tprint(\"  syscall: %-16s\" % syscall_name(id))\n\t\t\t\tret_keys = syscalls[comm][pid][id].keys()\n\t\t\t\tfor ret, val in sorted(syscalls[comm][pid][id].items(), key = lambda kv: (kv[1], kv[0]), reverse = True):\n\t\t\t\t\tprint(\"    err = %-20s  %10d\" % (strerror(ret), val))\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}