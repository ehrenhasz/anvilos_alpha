{
  "module_name": "check-headers.sh",
  "hash_id": "6c9c14563d3995812f8be59da1f36418ae3d055c070216b8d7e5f8cb5abe83fa",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/check-headers.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n\nYELLOW='\\033[0;33m'\nNC='\\033[0m' # No Color\n\ndeclare -a FILES\nFILES=(\n  \"include/uapi/linux/const.h\"\n  \"include/uapi/drm/drm.h\"\n  \"include/uapi/drm/i915_drm.h\"\n  \"include/uapi/linux/fadvise.h\"\n  \"include/uapi/linux/fcntl.h\"\n  \"include/uapi/linux/fs.h\"\n  \"include/uapi/linux/fscrypt.h\"\n  \"include/uapi/linux/kcmp.h\"\n  \"include/uapi/linux/kvm.h\"\n  \"include/uapi/linux/in.h\"\n  \"include/uapi/linux/mount.h\"\n  \"include/uapi/linux/openat2.h\"\n  \"include/uapi/linux/perf_event.h\"\n  \"include/uapi/linux/prctl.h\"\n  \"include/uapi/linux/sched.h\"\n  \"include/uapi/linux/seccomp.h\"\n  \"include/uapi/linux/stat.h\"\n  \"include/uapi/linux/usbdevice_fs.h\"\n  \"include/uapi/linux/vhost.h\"\n  \"include/uapi/sound/asound.h\"\n  \"include/linux/bits.h\"\n  \"include/vdso/bits.h\"\n  \"include/linux/const.h\"\n  \"include/vdso/const.h\"\n  \"include/linux/hash.h\"\n  \"include/linux/list-sort.h\"\n  \"include/uapi/linux/hw_breakpoint.h\"\n  \"arch/x86/include/asm/disabled-features.h\"\n  \"arch/x86/include/asm/required-features.h\"\n  \"arch/x86/include/asm/cpufeatures.h\"\n  \"arch/x86/include/asm/inat_types.h\"\n  \"arch/x86/include/asm/emulate_prefix.h\"\n  \"arch/x86/include/asm/irq_vectors.h\"\n  \"arch/x86/include/asm/msr-index.h\"\n  \"arch/x86/include/uapi/asm/prctl.h\"\n  \"arch/x86/lib/x86-opcode-map.txt\"\n  \"arch/x86/tools/gen-insn-attr-x86.awk\"\n  \"arch/arm/include/uapi/asm/perf_regs.h\"\n  \"arch/arm64/include/uapi/asm/perf_regs.h\"\n  \"arch/loongarch/include/uapi/asm/perf_regs.h\"\n  \"arch/mips/include/uapi/asm/perf_regs.h\"\n  \"arch/powerpc/include/uapi/asm/perf_regs.h\"\n  \"arch/s390/include/uapi/asm/perf_regs.h\"\n  \"arch/x86/include/uapi/asm/perf_regs.h\"\n  \"arch/x86/include/uapi/asm/kvm.h\"\n  \"arch/x86/include/uapi/asm/kvm_perf.h\"\n  \"arch/x86/include/uapi/asm/svm.h\"\n  \"arch/x86/include/uapi/asm/unistd.h\"\n  \"arch/x86/include/uapi/asm/vmx.h\"\n  \"arch/powerpc/include/uapi/asm/kvm.h\"\n  \"arch/s390/include/uapi/asm/kvm.h\"\n  \"arch/s390/include/uapi/asm/kvm_perf.h\"\n  \"arch/s390/include/uapi/asm/sie.h\"\n  \"arch/arm/include/uapi/asm/kvm.h\"\n  \"arch/arm64/include/uapi/asm/kvm.h\"\n  \"arch/arm64/include/uapi/asm/unistd.h\"\n  \"arch/alpha/include/uapi/asm/errno.h\"\n  \"arch/mips/include/asm/errno.h\"\n  \"arch/mips/include/uapi/asm/errno.h\"\n  \"arch/parisc/include/uapi/asm/errno.h\"\n  \"arch/powerpc/include/uapi/asm/errno.h\"\n  \"arch/sparc/include/uapi/asm/errno.h\"\n  \"arch/x86/include/uapi/asm/errno.h\"\n  \"include/asm-generic/bitops/arch_hweight.h\"\n  \"include/asm-generic/bitops/const_hweight.h\"\n  \"include/asm-generic/bitops/__fls.h\"\n  \"include/asm-generic/bitops/fls.h\"\n  \"include/asm-generic/bitops/fls64.h\"\n  \"include/linux/coresight-pmu.h\"\n  \"include/uapi/asm-generic/errno.h\"\n  \"include/uapi/asm-generic/errno-base.h\"\n  \"include/uapi/asm-generic/ioctls.h\"\n  \"include/uapi/asm-generic/mman-common.h\"\n  \"include/uapi/asm-generic/unistd.h\"\n)\n\ndeclare -a SYNC_CHECK_FILES\nSYNC_CHECK_FILES=(\n  \"arch/x86/include/asm/inat.h\"\n  \"arch/x86/include/asm/insn.h\"\n  \"arch/x86/lib/inat.c\"\n  \"arch/x86/lib/insn.c\"\n)\n\n# These copies are under tools/perf/trace/beauty/ as they are not used to in\n# building object files only by scripts in tools/perf/trace/beauty/ to generate\n# tables that then gets included in .c files for things like id->string syscall\n# tables (and the reverse lookup as well: string -> id)\n\ndeclare -a BEAUTY_FILES\nBEAUTY_FILES=(\n  \"include/linux/socket.h\"\n)\n\ndeclare -a FAILURES\n\ncheck_2 () {\n  tools_file=$1\n  orig_file=$2\n\n  shift\n  shift\n\n  cmd=\"diff $* $tools_file $orig_file > /dev/null\"\n\n  if [ -f \"$orig_file\" ] && ! eval \"$cmd\"\n  then\n    FAILURES+=(\n      \"$tools_file $orig_file\"\n    )\n  fi\n}\n\ncheck () {\n  file=$1\n\n  shift\n\n  check_2 \"tools/$file\" \"$file\" \"$@\"\n}\n\nbeauty_check () {\n  file=$1\n\n  shift\n\n  check_2 \"tools/perf/trace/beauty/$file\" \"$file\" \"$@\"\n}\n\n# Check if we have the kernel headers (tools/perf/../../include), else\n# we're probably on a detached tarball, so no point in trying to check\n# differences.\nif ! [ -d ../../include ]\nthen\n  echo -e \"${YELLOW}Warning${NC}: Skipped check-headers due to missing ../../include\"\n  exit 0\nfi\n\ncd ../..\n\n# simple diff check\nfor i in \"${FILES[@]}\"\ndo\n  check \"$i\" -B\ndone\n\nfor i in \"${SYNC_CHECK_FILES[@]}\"\ndo\n  check \"$i\" '-I \"^.*\\/\\*.*__ignore_sync_check__.*\\*\\/.*$\"'\ndone\n\n# diff with extra ignore lines\ncheck arch/x86/lib/memcpy_64.S        '-I \"^EXPORT_SYMBOL\" -I \"^#include <asm/export.h>\" -I\"^SYM_FUNC_START\\(_LOCAL\\)*(memcpy_\\(erms\\|orig\\))\" -I\"^#include <linux/cfi_types.h>\"'\ncheck arch/x86/lib/memset_64.S        '-I \"^EXPORT_SYMBOL\" -I \"^#include <asm/export.h>\" -I\"^SYM_FUNC_START\\(_LOCAL\\)*(memset_\\(erms\\|orig\\))\"'\ncheck arch/x86/include/asm/amd-ibs.h  '-I \"^#include [<\\\"]\\(asm/\\)*msr-index.h\"'\ncheck arch/arm64/include/asm/cputype.h '-I \"^#include [<\\\"]\\(asm/\\)*sysreg.h\"'\ncheck include/uapi/asm-generic/mman.h '-I \"^#include <\\(uapi/\\)*asm-generic/mman-common\\(-tools\\)*.h>\"'\ncheck include/uapi/linux/mman.h       '-I \"^#include <\\(uapi/\\)*asm/mman.h>\"'\ncheck include/linux/build_bug.h       '-I \"^#\\(ifndef\\|endif\\)\\( \\/\\/\\)* static_assert$\"'\ncheck include/linux/ctype.h\t      '-I \"isdigit(\"'\ncheck lib/ctype.c\t\t      '-I \"^EXPORT_SYMBOL\" -I \"^#include <linux/export.h>\" -B'\ncheck lib/list_sort.c\t\t      '-I \"^#include <linux/bug.h>\"'\n\n# diff non-symmetric files\ncheck_2 tools/perf/arch/x86/entry/syscalls/syscall_64.tbl arch/x86/entry/syscalls/syscall_64.tbl\ncheck_2 tools/perf/arch/powerpc/entry/syscalls/syscall.tbl arch/powerpc/kernel/syscalls/syscall.tbl\ncheck_2 tools/perf/arch/s390/entry/syscalls/syscall.tbl arch/s390/kernel/syscalls/syscall.tbl\ncheck_2 tools/perf/arch/mips/entry/syscalls/syscall_n64.tbl arch/mips/kernel/syscalls/syscall_n64.tbl\n\nfor i in \"${BEAUTY_FILES[@]}\"\ndo\n  beauty_check \"$i\" -B\ndone\n\n# check duplicated library files\ncheck_2 tools/perf/util/hashmap.h tools/lib/bpf/hashmap.h\ncheck_2 tools/perf/util/hashmap.c tools/lib/bpf/hashmap.c\n\ncd tools/perf || exit\n\nif [ ${#FAILURES[@]} -gt 0 ]\nthen\n  echo -e \"${YELLOW}Warning${NC}: Kernel ABI header differences:\"\n  for i in \"${FAILURES[@]}\"\n  do\n    echo \"  diff -u $i\"\n  done\nfi\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}