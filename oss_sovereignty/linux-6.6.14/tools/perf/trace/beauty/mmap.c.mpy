{
  "module_name": "mmap.c",
  "hash_id": "415282478921be963115f4d733e9c7ffa3e2ec5c45e65bf5a1a37d5cc0bbf6b6",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/mmap.c",
  "human_readable_source": "\n#include <linux/log2.h>\n\n#include \"trace/beauty/generated/mmap_prot_array.c\"\nstatic DEFINE_STRARRAY(mmap_prot, \"PROT_\");\n\nstatic size_t mmap__scnprintf_prot(unsigned long prot, char *bf, size_t size, bool show_prefix)\n{\n       return strarray__scnprintf_flags(&strarray__mmap_prot, bf, size, show_prefix, prot);\n}\n\nstatic size_t syscall_arg__scnprintf_mmap_prot(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tunsigned long prot = arg->val;\n\n\tif (prot == 0)\n\t\treturn scnprintf(bf, size, \"%sNONE\", arg->show_string_prefix ? strarray__mmap_prot.prefix : \"\");\n\n\treturn mmap__scnprintf_prot(prot, bf, size, arg->show_string_prefix);\n}\n\n#define SCA_MMAP_PROT syscall_arg__scnprintf_mmap_prot\n\n#include \"trace/beauty/generated/mmap_flags_array.c\"\nstatic DEFINE_STRARRAY(mmap_flags, \"MAP_\");\n\nstatic size_t mmap__scnprintf_flags(unsigned long flags, char *bf, size_t size, bool show_prefix)\n{\n       return strarray__scnprintf_flags(&strarray__mmap_flags, bf, size, show_prefix, flags);\n}\n\nstatic size_t syscall_arg__scnprintf_mmap_flags(char *bf, size_t size,\n\t\t\t\t\t\tstruct syscall_arg *arg)\n{\n\tunsigned long flags = arg->val;\n\n\tif (flags & MAP_ANONYMOUS)\n\t\targ->mask |= (1 << 4) | (1 << 5);  \n\n\treturn mmap__scnprintf_flags(flags, bf, size, arg->show_string_prefix);\n}\n\n#define SCA_MMAP_FLAGS syscall_arg__scnprintf_mmap_flags\n\n#include \"trace/beauty/generated/mremap_flags_array.c\"\nstatic DEFINE_STRARRAY(mremap_flags, \"MREMAP_\");\n\nstatic size_t mremap__scnprintf_flags(unsigned long flags, char *bf, size_t size, bool show_prefix)\n{\n       return strarray__scnprintf_flags(&strarray__mremap_flags, bf, size, show_prefix, flags);\n}\n\nstatic size_t syscall_arg__scnprintf_mremap_flags(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tunsigned long flags = arg->val;\n\n\tif (!(flags & MREMAP_FIXED))\n\t\targ->mask |=  (1 << 5);  \n\n\treturn mremap__scnprintf_flags(flags, bf, size, arg->show_string_prefix);\n}\n\n#define SCA_MREMAP_FLAGS syscall_arg__scnprintf_mremap_flags\n\nstatic size_t madvise__scnprintf_behavior(int behavior, char *bf, size_t size)\n{\n#include \"trace/beauty/generated/madvise_behavior_array.c\"\n       static DEFINE_STRARRAY(madvise_advices, \"MADV_\");\n\n       if (behavior < strarray__madvise_advices.nr_entries && strarray__madvise_advices.entries[behavior] != NULL)\n               return scnprintf(bf, size, \"MADV_%s\", strarray__madvise_advices.entries[behavior]);\n\n       return scnprintf(bf, size, \"%#\", behavior);\n}\n\nstatic size_t syscall_arg__scnprintf_madvise_behavior(char *bf, size_t size,\n\t\t\t\t\t\t      struct syscall_arg *arg)\n{\n\treturn madvise__scnprintf_behavior(arg->val, bf, size);\n}\n\n#define SCA_MADV_BHV syscall_arg__scnprintf_madvise_behavior\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}