{
  "module_name": "open_flags.c",
  "hash_id": "4785432c192a59d8547d7d284edf9dc2267e7f7b2ada8eb107336537b7db25f6",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/open_flags.c",
  "human_readable_source": "\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n\n#ifndef O_DIRECT\n#define O_DIRECT\t00040000\n#endif\n\n#ifndef O_DIRECTORY\n#define O_DIRECTORY\t00200000\n#endif\n\n#ifndef O_NOATIME\n#define O_NOATIME\t01000000\n#endif\n\n#ifndef O_TMPFILE\n#define O_TMPFILE\t020000000\n#endif\n\n#undef O_LARGEFILE\n#define O_LARGEFILE\t00100000\n\nsize_t open__scnprintf_flags(unsigned long flags, char *bf, size_t size, bool show_prefix)\n{\n\tconst char *prefix = \"O_\";\n\tint printed = 0;\n\n\tif ((flags & O_ACCMODE) == O_RDONLY)\n\t\tprinted = scnprintf(bf, size, \"%s%s\", show_prefix ? prefix : \"\", \"RDONLY\");\n\tif (flags == 0)\n\t\treturn printed;\n#define\tP_FLAG(n) \\\n\tif (flags & O_##n) { \\\n\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%s%s\", printed ? \"|\" : \"\", show_prefix ? prefix : \"\", #n); \\\n\t\tflags &= ~O_##n; \\\n\t}\n\n\tP_FLAG(RDWR);\n\tP_FLAG(APPEND);\n\tP_FLAG(ASYNC);\n\tP_FLAG(CLOEXEC);\n\tP_FLAG(CREAT);\n\tP_FLAG(DIRECT);\n\tP_FLAG(DIRECTORY);\n\tP_FLAG(EXCL);\n\tP_FLAG(LARGEFILE);\n\tP_FLAG(NOFOLLOW);\n\tP_FLAG(TMPFILE);\n\tP_FLAG(NOATIME);\n\tP_FLAG(NOCTTY);\n#ifdef O_NONBLOCK\n\tP_FLAG(NONBLOCK);\n#elif O_NDELAY\n\tP_FLAG(NDELAY);\n#endif\n#ifdef O_PATH\n\tP_FLAG(PATH);\n#endif\n#ifdef O_DSYNC\n\tif ((flags & O_SYNC) == O_SYNC)\n\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%s%s\", printed ? \"|\" : \"\", show_prefix ? prefix : \"\", \"SYNC\");\n\telse {\n\t\tP_FLAG(DSYNC);\n\t}\n#else\n\tP_FLAG(SYNC);\n#endif\n\tP_FLAG(TRUNC);\n\tP_FLAG(WRONLY);\n#undef P_FLAG\n\n\tif (flags)\n\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%#x\", printed ? \"|\" : \"\", flags);\n\n\treturn printed;\n}\n\nsize_t syscall_arg__scnprintf_open_flags(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tint flags = arg->val;\n\n\tif (!(flags & O_CREAT))\n\t\targ->mask |= 1 << (arg->idx + 1);  \n\n\treturn open__scnprintf_flags(flags, bf, size, arg->show_string_prefix);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}