{
  "module_name": "clone.c",
  "hash_id": "004b1ed367ff9b88680a9ca540951fa4264578c3ff815b25aca84ce6ab048cff",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/clone.c",
  "human_readable_source": "\n \n\n#include \"trace/beauty/beauty.h\"\n#include <linux/kernel.h>\n#include <sys/types.h>\n#include <uapi/linux/sched.h>\n\nstatic size_t clone__scnprintf_flags(unsigned long flags, char *bf, size_t size, bool show_prefix)\n{\n\tconst char *prefix = \"CLONE_\";\n\tint printed = 0;\n\n#define\tP_FLAG(n) \\\n\tif (flags & CLONE_##n) { \\\n\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%s%s\", printed ? \"|\" : \"\", show_prefix ? prefix : \"\", #n); \\\n\t\tflags &= ~CLONE_##n; \\\n\t}\n\n\tP_FLAG(VM);\n\tP_FLAG(FS);\n\tP_FLAG(FILES);\n\tP_FLAG(SIGHAND);\n\tP_FLAG(PIDFD);\n\tP_FLAG(PTRACE);\n\tP_FLAG(VFORK);\n\tP_FLAG(PARENT);\n\tP_FLAG(THREAD);\n\tP_FLAG(NEWNS);\n\tP_FLAG(SYSVSEM);\n\tP_FLAG(SETTLS);\n\tP_FLAG(PARENT_SETTID);\n\tP_FLAG(CHILD_CLEARTID);\n\tP_FLAG(DETACHED);\n\tP_FLAG(UNTRACED);\n\tP_FLAG(CHILD_SETTID);\n\tP_FLAG(NEWCGROUP);\n\tP_FLAG(NEWUTS);\n\tP_FLAG(NEWIPC);\n\tP_FLAG(NEWUSER);\n\tP_FLAG(NEWPID);\n\tP_FLAG(NEWNET);\n\tP_FLAG(IO);\n\tP_FLAG(CLEAR_SIGHAND);\n\tP_FLAG(INTO_CGROUP);\n#undef P_FLAG\n\n\tif (flags)\n\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%#x\", printed ? \"|\" : \"\", flags);\n\n\treturn printed;\n}\n\nsize_t syscall_arg__scnprintf_clone_flags(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tunsigned long flags = arg->val;\n\tenum syscall_clone_args {\n\t\tSCC_FLAGS\t  = (1 << 0),\n\t\tSCC_CHILD_STACK\t  = (1 << 1),\n\t\tSCC_PARENT_TIDPTR = (1 << 2),\n\t\tSCC_CHILD_TIDPTR  = (1 << 3),\n\t\tSCC_TLS\t\t  = (1 << 4),\n\t};\n\tif (!(flags & CLONE_PARENT_SETTID))\n\t\targ->mask |= SCC_PARENT_TIDPTR;\n\n\tif (!(flags & (CLONE_CHILD_SETTID | CLONE_CHILD_CLEARTID)))\n\t\targ->mask |= SCC_CHILD_TIDPTR;\n\n\tif (!(flags & CLONE_SETTLS))\n\t\targ->mask |= SCC_TLS;\n\n\treturn clone__scnprintf_flags(flags, bf, size, arg->show_string_prefix);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}