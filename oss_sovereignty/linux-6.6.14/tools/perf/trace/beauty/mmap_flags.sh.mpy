{
  "module_name": "mmap_flags.sh",
  "hash_id": "77bb244df80bc2405241a1fcdd08d20592b80d72823b6469baae039dc8f6dc04",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/mmap_flags.sh",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: LGPL-2.1\n\nif [ $# -ne 3 ] ; then\n\t[ $# -eq 1 ] && hostarch=$1 || hostarch=`uname -m | sed -e s/i.86/x86/ -e s/x86_64/x86/`\n\tlinux_header_dir=tools/include/uapi/linux\n\theader_dir=tools/include/uapi/asm-generic\n\tarch_header_dir=tools/arch/${hostarch}/include/uapi/asm\nelse\n\tlinux_header_dir=$1\n\theader_dir=$2\n\tarch_header_dir=$3\nfi\n\nlinux_mman=${linux_header_dir}/mman.h\narch_mman=${arch_header_dir}/mman.h\n\n# those in grep -E -vw are flags, we want just the bits\n\nprintf \"static const char *mmap_flags[] = {\\n\"\nregex='^[[:space:]]*#[[:space:]]*define[[:space:]]+MAP_([[:alnum:]_]+)[[:space:]]+(0x[[:xdigit:]]+)[[:space:]]*.*'\ntest -f ${arch_mman} && \\\ngrep -E -q $regex ${arch_mman} && \\\n(grep -E $regex ${arch_mman} | \\\n\tsed -r \"s/$regex/\\2 \\1 \\1 \\1 \\2/g\"\t| \\\n\txargs printf \"\\t[ilog2(%s) + 1] = \\\"%s\\\",\\n#ifndef MAP_%s\\n#define MAP_%s %s\\n#endif\\n\")\ngrep -E -q $regex ${linux_mman} && \\\n(grep -E $regex ${linux_mman} | \\\n\tgrep -E -vw 'MAP_(UNINITIALIZED|TYPE|SHARED_VALIDATE)' | \\\n\tsed -r \"s/$regex/\\2 \\1 \\1 \\1 \\2/g\" | \\\n\txargs printf \"\\t[ilog2(%s) + 1] = \\\"%s\\\",\\n#ifndef MAP_%s\\n#define MAP_%s %s\\n#endif\\n\")\n( ! test -f ${arch_mman} || \\\ngrep -E -q '#[[:space:]]*include[[:space:]]+.*uapi/asm-generic/mman.*' ${arch_mman}) &&\n(grep -E $regex ${header_dir}/mman-common.h | \\\n\tgrep -E -vw 'MAP_(UNINITIALIZED|TYPE|SHARED_VALIDATE)' | \\\n\tsed -r \"s/$regex/\\2 \\1 \\1 \\1 \\2/g\"\t| \\\n\txargs printf \"\\t[ilog2(%s) + 1] = \\\"%s\\\",\\n#ifndef MAP_%s\\n#define MAP_%s %s\\n#endif\\n\")\n( ! test -f ${arch_mman} || \\\ngrep -E -q '#[[:space:]]*include[[:space:]]+.*uapi/asm-generic/mman.h>.*' ${arch_mman}) &&\n(grep -E $regex ${header_dir}/mman.h | \\\n\tsed -r \"s/$regex/\\2 \\1 \\1 \\1 \\2/g\"\t| \\\n\txargs printf \"\\t[ilog2(%s) + 1] = \\\"%s\\\",\\n#ifndef MAP_%s\\n#define MAP_%s %s\\n#endif\\n\")\nprintf \"};\\n\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}