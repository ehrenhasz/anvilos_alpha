{
  "module_name": "prctl.c",
  "hash_id": "04dc9c91c73b81299828d008b8b57f406cacb519065c16d0a2511fac3045f745",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/prctl.c",
  "human_readable_source": "\n \n\n#include \"trace/beauty/beauty.h\"\n#include <linux/kernel.h>\n#include <uapi/linux/prctl.h>\n\n#include \"trace/beauty/generated/prctl_option_array.c\"\n\nDEFINE_STRARRAY(prctl_options, \"PR_\");\n\nstatic size_t prctl__scnprintf_option(int option, char *bf, size_t size, bool show_prefix)\n{\n\treturn strarray__scnprintf(&strarray__prctl_options, bf, size, \"%d\", show_prefix, option);\n}\n\nstatic size_t prctl__scnprintf_set_mm(int option, char *bf, size_t size, bool show_prefix)\n{\n\tstatic DEFINE_STRARRAY(prctl_set_mm_options, \"PR_SET_MM_\");\n\treturn strarray__scnprintf(&strarray__prctl_set_mm_options, bf, size, \"%d\", show_prefix, option);\n}\n\nsize_t syscall_arg__scnprintf_prctl_arg2(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tint option = syscall_arg__val(arg, 0);\n\n\tif (option == PR_SET_MM)\n\t\treturn prctl__scnprintf_set_mm(arg->val, bf, size, arg->show_string_prefix);\n\t \n\tif (option == PR_SET_NAME)\n\t\treturn syscall_arg__scnprintf_hex(bf, size, arg);\n\n\treturn syscall_arg__scnprintf_long(bf, size, arg);\n}\n\nsize_t syscall_arg__scnprintf_prctl_arg3(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tint option = syscall_arg__val(arg, 0);\n\n\tif (option == PR_SET_MM)\n\t\treturn syscall_arg__scnprintf_hex(bf, size, arg);\n\n\treturn syscall_arg__scnprintf_long(bf, size, arg);\n}\n\nsize_t syscall_arg__scnprintf_prctl_option(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tunsigned long option = arg->val;\n\tenum {\n                SPO_ARG2 = (1 << 1),\n                SPO_ARG3 = (1 << 2),\n                SPO_ARG4 = (1 << 3),\n                SPO_ARG5 = (1 << 4),\n                SPO_ARG6 = (1 << 5),\n        };\n\tconst u8 all_but2 = SPO_ARG3 | SPO_ARG4 | SPO_ARG5 | SPO_ARG6;\n\tconst u8 all = SPO_ARG2 | all_but2;\n\tconst u8 masks[] = {\n\t\t[PR_GET_DUMPABLE]\t = all,\n\t\t[PR_SET_DUMPABLE]\t = all_but2,\n\t\t[PR_SET_NAME]\t\t = all_but2,\n\t\t[PR_GET_CHILD_SUBREAPER] = all_but2,\n\t\t[PR_SET_CHILD_SUBREAPER] = all_but2,\n\t\t[PR_GET_SECUREBITS]\t = all,\n\t\t[PR_SET_SECUREBITS]\t = all_but2,\n\t\t[PR_SET_MM]\t\t = SPO_ARG4 | SPO_ARG5 | SPO_ARG6,\n\t\t[PR_GET_PDEATHSIG]\t = all,\n\t\t[PR_SET_PDEATHSIG]\t = all_but2,\n\t};\n\n\tif (option < ARRAY_SIZE(masks))\n\t\targ->mask |= masks[option];\n\n\treturn prctl__scnprintf_option(option, bf, size, arg->show_string_prefix);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}