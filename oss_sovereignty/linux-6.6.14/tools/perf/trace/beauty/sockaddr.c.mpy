{
  "module_name": "sockaddr.c",
  "hash_id": "ce9992718ee3b0426288ee7689bf22903bb13f26f9043db98b80d507cca3ab0f",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/sockaddr.c",
  "human_readable_source": "\n\n\n#include \"trace/beauty/beauty.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <sys/un.h>\n#include <arpa/inet.h>\n\n#include \"trace/beauty/generated/sockaddr.c\"\nDEFINE_STRARRAY(socket_families, \"PF_\");\n\nstatic size_t af_inet__scnprintf(struct sockaddr *sa, char *bf, size_t size)\n{\n\tstruct sockaddr_in *sin = (struct sockaddr_in *)sa;\n\tchar tmp[16];\n\treturn scnprintf(bf, size, \", port: %d, addr: %s\", ntohs(sin->sin_port),\n\t\t\t inet_ntop(sin->sin_family, &sin->sin_addr, tmp, sizeof(tmp)));\n}\n\nstatic size_t af_inet6__scnprintf(struct sockaddr *sa, char *bf, size_t size)\n{\n\tstruct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)sa;\n\tu32 flowinfo = ntohl(sin6->sin6_flowinfo);\n\tchar tmp[512];\n\tsize_t printed = scnprintf(bf, size, \", port: %d, addr: %s\", ntohs(sin6->sin6_port),\n\t\t\t\t   inet_ntop(sin6->sin6_family, &sin6->sin6_addr, tmp, sizeof(tmp)));\n\tif (flowinfo != 0)\n\t\tprinted += scnprintf(bf + printed, size - printed, \", flowinfo: %lu\", flowinfo);\n\tif (sin6->sin6_scope_id != 0)\n\t\tprinted += scnprintf(bf + printed, size - printed, \", scope_id: %lu\", sin6->sin6_scope_id);\n\n\treturn printed;\n}\n\nstatic size_t af_local__scnprintf(struct sockaddr *sa, char *bf, size_t size)\n{\n\tstruct sockaddr_un *sun = (struct sockaddr_un *)sa;\n\treturn scnprintf(bf, size, \", path: %s\", sun->sun_path);\n}\n\nstatic size_t (*af_scnprintfs[])(struct sockaddr *sa, char *bf, size_t size) = {\n\t[AF_LOCAL] = af_local__scnprintf,\n\t[AF_INET]  = af_inet__scnprintf,\n\t[AF_INET6] = af_inet6__scnprintf,\n};\n\nstatic size_t syscall_arg__scnprintf_augmented_sockaddr(struct syscall_arg *arg, char *bf, size_t size)\n{\n\tstruct sockaddr *sa = (struct sockaddr *)arg->augmented.args;\n\tchar family[32];\n\tsize_t printed;\n\n\tstrarray__scnprintf(&strarray__socket_families, family, sizeof(family), \"%d\", arg->show_string_prefix, sa->sa_family);\n\tprinted = scnprintf(bf, size, \"{ .family: %s\", family);\n\n\tif (sa->sa_family < ARRAY_SIZE(af_scnprintfs) && af_scnprintfs[sa->sa_family])\n\t\tprinted += af_scnprintfs[sa->sa_family](sa, bf + printed, size - printed);\n\n\treturn printed + scnprintf(bf + printed, size - printed, \" }\");\n}\n\nsize_t syscall_arg__scnprintf_sockaddr(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tif (arg->augmented.args)\n\t\treturn syscall_arg__scnprintf_augmented_sockaddr(arg, bf, size);\n\n\treturn scnprintf(bf, size, \"%#lx\", arg->val);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}