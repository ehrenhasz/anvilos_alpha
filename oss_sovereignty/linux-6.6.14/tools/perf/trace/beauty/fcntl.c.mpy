{
  "module_name": "fcntl.c",
  "hash_id": "bcfcf687a2dc0b612d3f5b4fc95b907705fa31fb21a02fbba80b82e9dc82d475",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/fcntl.c",
  "human_readable_source": "\n \n\n#include \"trace/beauty/beauty.h\"\n#include <linux/kernel.h>\n#include <uapi/linux/fcntl.h>\n\nstatic size_t fcntl__scnprintf_getfd(unsigned long val, char *bf, size_t size, bool show_prefix)\n{\n\treturn val ? scnprintf(bf, size, \"%s\", \"0\") :\n\t\t     scnprintf(bf, size, \"%s%s\", show_prefix ? \"FD_\" : \"\", \"CLOEXEC\");\n}\n\nstatic size_t syscall_arg__scnprintf_fcntl_getfd(char *bf, size_t size, struct syscall_arg *arg)\n{\n\treturn fcntl__scnprintf_getfd(arg->val, bf, size, arg->show_string_prefix);\n}\n\nstatic size_t fcntl__scnprintf_getlease(unsigned long val, char *bf, size_t size, bool show_prefix)\n{\n\tstatic const char *fcntl_setlease[] = { \"RDLCK\", \"WRLCK\", \"UNLCK\", };\n\tstatic DEFINE_STRARRAY(fcntl_setlease, \"F_\");\n\n\treturn strarray__scnprintf(&strarray__fcntl_setlease, bf, size, \"%x\", show_prefix, val);\n}\n\nstatic size_t syscall_arg__scnprintf_fcntl_getlease(char *bf, size_t size, struct syscall_arg *arg)\n{\n\treturn fcntl__scnprintf_getlease(arg->val, bf, size, arg->show_string_prefix);\n}\n\nsize_t syscall_arg__scnprintf_fcntl_cmd(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tif (arg->val == F_GETFL) {\n\t\tsyscall_arg__set_ret_scnprintf(arg, syscall_arg__scnprintf_open_flags);\n\t\tgoto mask_arg;\n\t}\n\tif (arg->val == F_GETFD) {\n\t\tsyscall_arg__set_ret_scnprintf(arg, syscall_arg__scnprintf_fcntl_getfd);\n\t\tgoto mask_arg;\n\t}\n\tif (arg->val == F_DUPFD_CLOEXEC || arg->val == F_DUPFD) {\n\t\tsyscall_arg__set_ret_scnprintf(arg, syscall_arg__scnprintf_fd);\n\t\tgoto out;\n\t}\n\tif (arg->val == F_GETOWN) {\n\t\tsyscall_arg__set_ret_scnprintf(arg, syscall_arg__scnprintf_pid);\n\t\tgoto mask_arg;\n\t}\n\tif (arg->val == F_GETLEASE) {\n\t\tsyscall_arg__set_ret_scnprintf(arg, syscall_arg__scnprintf_fcntl_getlease);\n\t\tgoto mask_arg;\n\t}\n\t \n\tif (arg->val == F_GET_SEALS ||\n\t    arg->val == F_GETSIG) {\nmask_arg:\n\t\targ->mask |= (1 << 2);\n\t}\nout:\n\treturn syscall_arg__scnprintf_strarrays(bf, size, arg);\n}\n\nsize_t syscall_arg__scnprintf_fcntl_arg(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tbool show_prefix = arg->show_string_prefix;\n\tint cmd = syscall_arg__val(arg, 1);\n\n\tif (cmd == F_DUPFD)\n\t\treturn syscall_arg__scnprintf_fd(bf, size, arg);\n\n\tif (cmd == F_SETFD)\n\t\treturn fcntl__scnprintf_getfd(arg->val, bf, size, show_prefix);\n\n\tif (cmd == F_SETFL)\n\t\treturn open__scnprintf_flags(arg->val, bf, size, show_prefix);\n\n\tif (cmd == F_SETOWN)\n\t\treturn syscall_arg__scnprintf_pid(bf, size, arg);\n\n\tif (cmd == F_SETLEASE)\n\t\treturn fcntl__scnprintf_getlease(arg->val, bf, size, show_prefix);\n\t \n\tif (cmd == F_SETLK || cmd == F_SETLKW || cmd == F_GETLK ||\n\t    cmd == F_OFD_SETLK || cmd == F_OFD_SETLKW || cmd == F_OFD_GETLK ||\n\t    cmd == F_GETOWN_EX || cmd == F_SETOWN_EX ||\n\t    cmd == F_GET_RW_HINT || cmd == F_SET_RW_HINT ||\n\t    cmd == F_GET_FILE_RW_HINT || cmd == F_SET_FILE_RW_HINT)\n\t\treturn syscall_arg__scnprintf_hex(bf, size, arg);\n\n\treturn syscall_arg__scnprintf_long(bf, size, arg);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}