{
  "module_name": "pkey_alloc.c",
  "hash_id": "9442a1d3494119f92e6761c3b7c8ac6bc3f7b18139723e3291f0e3fe01d4b013",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/trace/beauty/pkey_alloc.c",
  "human_readable_source": "\n \n\n#include \"trace/beauty/beauty.h\"\n#include <linux/kernel.h>\n#include <linux/log2.h>\n\nsize_t strarray__scnprintf_flags(struct strarray *sa, char *bf, size_t size, bool show_prefix, unsigned long flags)\n{\n\tint i, printed = 0;\n\n\tif (flags == 0) {\n\t\tconst char *s = sa->entries[0];\n\t\tif (s)\n\t\t\treturn scnprintf(bf, size, \"%s%s\", show_prefix ? sa->prefix : \"\", s);\n\t\treturn scnprintf(bf, size, \"%d\", 0);\n\t}\n\n\tfor (i = 1; i < sa->nr_entries; ++i) {\n\t\tunsigned long bit = 1UL << (i - 1);\n\n\t\tif (!(flags & bit))\n\t\t\tcontinue;\n\n\t\tif (printed != 0)\n\t\t\tprinted += scnprintf(bf + printed, size - printed, \"|\");\n\n\t\tif (sa->entries[i] != NULL)\n\t\t\tprinted += scnprintf(bf + printed, size - printed, \"%s%s\", show_prefix ? sa->prefix : \"\", sa->entries[i]);\n\t\telse\n\t\t\tprinted += scnprintf(bf + printed, size - printed, \"0x%#\", bit);\n\t}\n\n\treturn printed;\n}\n\nstatic size_t pkey_alloc__scnprintf_access_rights(int access_rights, char *bf, size_t size, bool show_prefix)\n{\n#include \"trace/beauty/generated/pkey_alloc_access_rights_array.c\"\n\tstatic DEFINE_STRARRAY(pkey_alloc_access_rights, \"PKEY_\");\n\n\treturn strarray__scnprintf_flags(&strarray__pkey_alloc_access_rights, bf, size, show_prefix, access_rights);\n}\n\nsize_t syscall_arg__scnprintf_pkey_alloc_access_rights(char *bf, size_t size, struct syscall_arg *arg)\n{\n\tunsigned long cmd = arg->val;\n\n\treturn pkey_alloc__scnprintf_access_rights(cmd, bf, size, arg->show_string_prefix);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}