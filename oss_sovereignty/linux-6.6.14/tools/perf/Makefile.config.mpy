{
  "module_name": "Makefile.config",
  "hash_id": "eac48546a0b76b17f0910adc462947a925cc66efd58a926372360d1d3dab2aa0",
  "original_prompt": "Ingested from linux-6.6.14/tools/perf/Makefile.config",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n\nifeq ($(src-perf),)\nsrc-perf := $(srctree)/tools/perf\nendif\n\nifeq ($(obj-perf),)\nobj-perf := $(OUTPUT)\nendif\n\nifneq ($(obj-perf),)\nobj-perf := $(abspath $(obj-perf))/\nendif\n\n$(shell printf \"\" > $(OUTPUT).config-detected)\ndetected     = $(shell echo \"$(1)=y\"       >> $(OUTPUT).config-detected)\ndetected_var = $(shell echo \"$(1)=$($(1))\" >> $(OUTPUT).config-detected)\n\nCFLAGS := $(EXTRA_CFLAGS) $(filter-out -Wnested-externs,$(EXTRA_WARNINGS))\nHOSTCFLAGS := $(filter-out -Wnested-externs,$(EXTRA_WARNINGS))\n\n# Enabled Wthread-safety analysis for clang builds.\nifeq ($(CC_NO_CLANG), 0)\n  CFLAGS += -Wthread-safety\nendif\n\ninclude $(srctree)/tools/scripts/Makefile.arch\n\n$(call detected_var,SRCARCH)\n\nNO_PERF_REGS := 1\n\nifneq ($(NO_SYSCALL_TABLE),1)\n  NO_SYSCALL_TABLE := 1\n\n  ifeq ($(SRCARCH),x86)\n    ifeq (${IS_64_BIT}, 1)\n      NO_SYSCALL_TABLE := 0\n    endif\n  else\n    ifeq ($(SRCARCH),$(filter $(SRCARCH),powerpc arm64 s390 mips loongarch))\n      NO_SYSCALL_TABLE := 0\n    endif\n  endif\n\n  ifneq ($(NO_SYSCALL_TABLE),1)\n    CFLAGS += -DHAVE_SYSCALL_TABLE_SUPPORT\n  endif\nendif\n\n# Additional ARCH settings for ppc\nifeq ($(SRCARCH),powerpc)\n  NO_PERF_REGS := 0\n  CFLAGS += -I$(OUTPUT)arch/powerpc/include/generated\n  LIBUNWIND_LIBS := -lunwind -lunwind-ppc64\nendif\n\n# Additional ARCH settings for x86\nifeq ($(SRCARCH),x86)\n  $(call detected,CONFIG_X86)\n  ifeq (${IS_64_BIT}, 1)\n    CFLAGS += -DHAVE_ARCH_X86_64_SUPPORT -I$(OUTPUT)arch/x86/include/generated\n    ARCH_INCLUDE = ../../arch/x86/lib/memcpy_64.S ../../arch/x86/lib/memset_64.S\n    LIBUNWIND_LIBS = -lunwind-x86_64 -lunwind -llzma\n    $(call detected,CONFIG_X86_64)\n  else\n    LIBUNWIND_LIBS = -lunwind-x86 -llzma -lunwind\n  endif\n  NO_PERF_REGS := 0\nendif\n\nifeq ($(SRCARCH),arm)\n  NO_PERF_REGS := 0\n  LIBUNWIND_LIBS = -lunwind -lunwind-arm\nendif\n\nifeq ($(SRCARCH),arm64)\n  NO_PERF_REGS := 0\n  CFLAGS += -I$(OUTPUT)arch/arm64/include/generated\n  LIBUNWIND_LIBS = -lunwind -lunwind-aarch64\nendif\n\nifeq ($(SRCARCH),loongarch)\n  NO_PERF_REGS := 0\n  CFLAGS += -I$(OUTPUT)arch/loongarch/include/generated\n  LIBUNWIND_LIBS = -lunwind -lunwind-loongarch64\nendif\n\nifeq ($(SRCARCH),riscv)\n  NO_PERF_REGS := 0\nendif\n\nifeq ($(SRCARCH),csky)\n  NO_PERF_REGS := 0\nendif\n\nifeq ($(ARCH),s390)\n  NO_PERF_REGS := 0\n  CFLAGS += -fPIC -I$(OUTPUT)arch/s390/include/generated\nendif\n\nifeq ($(ARCH),mips)\n  NO_PERF_REGS := 0\n  CFLAGS += -I$(OUTPUT)arch/mips/include/generated\n  LIBUNWIND_LIBS = -lunwind -lunwind-mips\nendif\n\nifeq ($(NO_PERF_REGS),0)\n  $(call detected,CONFIG_PERF_REGS)\nendif\n\n# So far there's only x86 and arm libdw unwind support merged in perf.\n# Disable it on all other architectures in case libdw unwind\n# support is detected in system. Add supported architectures\n# to the check.\nifneq ($(SRCARCH),$(filter $(SRCARCH),x86 arm arm64 powerpc s390 csky riscv loongarch))\n  NO_LIBDW_DWARF_UNWIND := 1\nendif\n\nifeq ($(LIBUNWIND_LIBS),)\n  NO_LIBUNWIND := 1\nendif\n#\n# For linking with debug library, run like:\n#\n#   make DEBUG=1 LIBUNWIND_DIR=/opt/libunwind/\n#\n\nlibunwind_arch_set_flags = $(eval $(libunwind_arch_set_flags_code))\ndefine libunwind_arch_set_flags_code\n  FEATURE_CHECK_CFLAGS-libunwind-$(1)  = -I$(LIBUNWIND_DIR)/include\n  FEATURE_CHECK_LDFLAGS-libunwind-$(1) = -L$(LIBUNWIND_DIR)/lib\nendef\n\nifdef LIBUNWIND_DIR\n  LIBUNWIND_CFLAGS  = -I$(LIBUNWIND_DIR)/include\n  LIBUNWIND_LDFLAGS = -L$(LIBUNWIND_DIR)/lib\n  LIBUNWIND_ARCHS = x86 x86_64 arm aarch64 debug-frame-arm debug-frame-aarch64 loongarch\n  $(foreach libunwind_arch,$(LIBUNWIND_ARCHS),$(call libunwind_arch_set_flags,$(libunwind_arch)))\nendif\n\n# Set per-feature check compilation flags\nFEATURE_CHECK_CFLAGS-libunwind = $(LIBUNWIND_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libunwind = $(LIBUNWIND_LDFLAGS) $(LIBUNWIND_LIBS)\nFEATURE_CHECK_CFLAGS-libunwind-debug-frame = $(LIBUNWIND_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libunwind-debug-frame = $(LIBUNWIND_LDFLAGS) $(LIBUNWIND_LIBS)\n\nFEATURE_CHECK_LDFLAGS-libunwind-arm += -lunwind -lunwind-arm\nFEATURE_CHECK_LDFLAGS-libunwind-aarch64 += -lunwind -lunwind-aarch64\nFEATURE_CHECK_LDFLAGS-libunwind-x86 += -lunwind -llzma -lunwind-x86\nFEATURE_CHECK_LDFLAGS-libunwind-x86_64 += -lunwind -llzma -lunwind-x86_64\n\nFEATURE_CHECK_LDFLAGS-libcrypto = -lcrypto\n\nifdef CSINCLUDES\n  LIBOPENCSD_CFLAGS := -I$(CSINCLUDES)\nendif\nOPENCSDLIBS := -lopencsd_c_api -lopencsd\nifeq ($(findstring -static,${LDFLAGS}),-static)\n  OPENCSDLIBS += -lstdc++\nendif\nifdef CSLIBS\n  LIBOPENCSD_LDFLAGS := -L$(CSLIBS)\nendif\nFEATURE_CHECK_CFLAGS-libopencsd := $(LIBOPENCSD_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libopencsd := $(LIBOPENCSD_LDFLAGS) $(OPENCSDLIBS)\n\nifeq ($(NO_PERF_REGS),0)\n  CFLAGS += -DHAVE_PERF_REGS_SUPPORT\nendif\n\n# for linking with debug library, run like:\n# make DEBUG=1 LIBDW_DIR=/opt/libdw/\nifdef LIBDW_DIR\n  LIBDW_CFLAGS  := -I$(LIBDW_DIR)/include\n  LIBDW_LDFLAGS := -L$(LIBDW_DIR)/lib\nendif\nDWARFLIBS := -ldw\nifeq ($(findstring -static,${LDFLAGS}),-static)\n  DWARFLIBS += -lelf -lebl -ldl -lz -llzma -lbz2\nendif\nFEATURE_CHECK_CFLAGS-libdw-dwarf-unwind := $(LIBDW_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libdw-dwarf-unwind := $(LIBDW_LDFLAGS) $(DWARFLIBS)\n\n# for linking with debug library, run like:\n# make DEBUG=1 LIBBABELTRACE_DIR=/opt/libbabeltrace/\nifdef LIBBABELTRACE_DIR\n  LIBBABELTRACE_CFLAGS  := -I$(LIBBABELTRACE_DIR)/include\n  LIBBABELTRACE_LDFLAGS := -L$(LIBBABELTRACE_DIR)/lib\nendif\nFEATURE_CHECK_CFLAGS-libbabeltrace := $(LIBBABELTRACE_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libbabeltrace := $(LIBBABELTRACE_LDFLAGS) -lbabeltrace-ctf\n\nifdef LIBZSTD_DIR\n  LIBZSTD_CFLAGS  := -I$(LIBZSTD_DIR)/lib\n  LIBZSTD_LDFLAGS := -L$(LIBZSTD_DIR)/lib\nendif\nFEATURE_CHECK_CFLAGS-libzstd := $(LIBZSTD_CFLAGS)\nFEATURE_CHECK_LDFLAGS-libzstd := $(LIBZSTD_LDFLAGS)\n\nFEATURE_CHECK_CFLAGS-bpf = -I. -I$(srctree)/tools/include -I$(srctree)/tools/arch/$(SRCARCH)/include/uapi -I$(srctree)/tools/include/uapi\n# include ARCH specific config\n-include $(src-perf)/arch/$(SRCARCH)/Makefile\n\nifdef PERF_HAVE_ARCH_REGS_QUERY_REGISTER_OFFSET\n  CFLAGS += -DHAVE_ARCH_REGS_QUERY_REGISTER_OFFSET\nendif\n\ninclude $(srctree)/tools/scripts/utilities.mak\n\nifeq ($(call get-executable,$(FLEX)),)\n  dummy := $(error Error: $(FLEX) is missing on this system, please install it)\nendif\n\nifeq ($(call get-executable,$(BISON)),)\n  dummy := $(error Error: $(BISON) is missing on this system, please install it)\nendif\n\nifeq ($(BUILD_BPF_SKEL),1)\n  ifeq ($(call get-executable,$(CLANG)),)\n    dummy := $(error $(CLANG) is missing on this system, please install it to be able to build with BUILD_BPF_SKEL=1)\n  endif\nendif\n\nifneq ($(OUTPUT),)\n  ifeq ($(shell expr $(shell $(BISON) --version | grep bison | sed -e 's/.\\+ \\([0-9]\\+\\).\\([0-9]\\+\\).\\([0-9]\\+\\)/\\1\\2\\3/g') \\>\\= 371), 1)\n    BISON_FILE_PREFIX_MAP := --file-prefix-map=$(OUTPUT)=\n  endif\nendif\n\n# Treat warnings as errors unless directed not to\nifneq ($(WERROR),0)\n  CORE_CFLAGS += -Werror\n  CXXFLAGS += -Werror\n  HOSTCFLAGS += -Werror\nendif\n\nifndef DEBUG\n  DEBUG := 0\nendif\n\nifeq ($(DEBUG),0)\nCORE_CFLAGS += -DNDEBUG=1\nifeq ($(CC_NO_CLANG), 0)\n  CORE_CFLAGS += -O3\nelse\n  CORE_CFLAGS += -O6\nendif\nelse\n  CORE_CFLAGS += -g\n  CXXFLAGS += -g\nendif\n\nifdef PARSER_DEBUG\n  PARSER_DEBUG_BISON := -t\n  PARSER_DEBUG_FLEX  := -d\n  CFLAGS             += -DPARSER_DEBUG\n  $(call detected_var,PARSER_DEBUG_BISON)\n  $(call detected_var,PARSER_DEBUG_FLEX)\nendif\n\nifdef LTO\n  CORE_CFLAGS += -flto\n  CXXFLAGS += -flto\nendif\n\n# Try different combinations to accommodate systems that only have\n# python[2][3]-config in weird combinations in the following order of\n# priority from lowest to highest:\n#   * python2-config as per pep-0394.\n#   * python-config\n#   * python3-config\n#   * $(PYTHON)-config (If PYTHON is user supplied but PYTHON_CONFIG isn't)\n#\nPYTHON_AUTO := python-config\nPYTHON_AUTO := $(if $(call get-executable,python2-config),python2-config,$(PYTHON_AUTO))\nPYTHON_AUTO := $(if $(call get-executable,python-config),python-config,$(PYTHON_AUTO))\nPYTHON_AUTO := $(if $(call get-executable,python3-config),python3-config,$(PYTHON_AUTO))\n\n# If PYTHON is defined but PYTHON_CONFIG isn't, then take $(PYTHON)-config as if it was the user\n# supplied value for PYTHON_CONFIG. Because it's \"user supplied\", error out if it doesn't exist.\nifdef PYTHON\n  ifndef PYTHON_CONFIG\n    PYTHON_CONFIG_AUTO := $(call get-executable,$(PYTHON)-config)\n    PYTHON_CONFIG := $(if $(PYTHON_CONFIG_AUTO),$(PYTHON_CONFIG_AUTO),\\\n                          $(call $(error $(PYTHON)-config not found)))\n  endif\nendif\n\n# Select either auto detected python and python-config or use user supplied values if they are\n# defined. get-executable-or-default fails with an error if the first argument is supplied but\n# doesn't exist.\noverride PYTHON_CONFIG := $(call get-executable-or-default,PYTHON_CONFIG,$(PYTHON_AUTO))\noverride PYTHON := $(call get-executable-or-default,PYTHON,$(subst -config,,$(PYTHON_CONFIG)))\n\ngrep-libs  = $(filter -l%,$(1))\nstrip-libs  = $(filter-out -l%,$(1))\n\nPYTHON_CONFIG_SQ := $(call shell-sq,$(PYTHON_CONFIG))\n\n# Python 3.8 changed the output of `python-config --ldflags` to not include the\n# '-lpythonX.Y' flag unless '--embed' is also passed. The feature check for\n# libpython fails if that flag is not included in LDFLAGS\nifeq ($(shell $(PYTHON_CONFIG_SQ) --ldflags --embed 2>&1 1>/dev/null; echo $$?), 0)\n  PYTHON_CONFIG_LDFLAGS := --ldflags --embed\nelse\n  PYTHON_CONFIG_LDFLAGS := --ldflags\nendif\n\nifdef PYTHON_CONFIG\n  PYTHON_EMBED_LDOPTS := $(shell $(PYTHON_CONFIG_SQ) $(PYTHON_CONFIG_LDFLAGS) 2>/dev/null)\n  PYTHON_EMBED_LDFLAGS := $(call strip-libs,$(PYTHON_EMBED_LDOPTS))\n  PYTHON_EMBED_LIBADD := $(call grep-libs,$(PYTHON_EMBED_LDOPTS)) -lutil\n  PYTHON_EMBED_CCOPTS := $(shell $(PYTHON_CONFIG_SQ) --includes 2>/dev/null)\n  FLAGS_PYTHON_EMBED := $(PYTHON_EMBED_CCOPTS) $(PYTHON_EMBED_LDOPTS)\n  ifeq ($(CC_NO_CLANG), 0)\n    PYTHON_EMBED_CCOPTS := $(filter-out -ffat-lto-objects, $(PYTHON_EMBED_CCOPTS))\n  endif\nendif\n\nFEATURE_CHECK_CFLAGS-libpython := $(PYTHON_EMBED_CCOPTS)\nFEATURE_CHECK_LDFLAGS-libpython := $(PYTHON_EMBED_LDOPTS)\n\nFEATURE_CHECK_LDFLAGS-libaio = -lrt\n\nFEATURE_CHECK_LDFLAGS-disassembler-four-args = -lbfd -lopcodes -ldl\nFEATURE_CHECK_LDFLAGS-disassembler-init-styled = -lbfd -lopcodes -ldl\n\nCORE_CFLAGS += -fno-omit-frame-pointer\nCORE_CFLAGS += -Wall\nCORE_CFLAGS += -Wextra\nCORE_CFLAGS += -std=gnu11\n\nCXXFLAGS += -std=gnu++17 -fno-exceptions -fno-rtti\nCXXFLAGS += -Wall\nCXXFLAGS += -Wextra\nCXXFLAGS += -fno-omit-frame-pointer\n\nHOSTCFLAGS += -Wall\nHOSTCFLAGS += -Wextra\n\n# Enforce a non-executable stack, as we may regress (again) in the future by\n# adding assembler files missing the .GNU-stack linker note.\nLDFLAGS += -Wl,-z,noexecstack\n\nEXTLIBS = -lpthread -lrt -lm -ldl\n\nifneq ($(TCMALLOC),)\n  CFLAGS += -fno-builtin-malloc -fno-builtin-calloc -fno-builtin-realloc -fno-builtin-free\n  EXTLIBS += -ltcmalloc\nendif\n\nifeq ($(FEATURES_DUMP),)\n# We will display at the end of this Makefile.config, using $(call feature_display_entries)\n# As we may retry some feature detection here, see the disassembler-four-args case, for instance\n  FEATURE_DISPLAY_DEFERRED := 1\ninclude $(srctree)/tools/build/Makefile.feature\nelse\ninclude $(FEATURES_DUMP)\nendif\n\nifeq ($(feature-stackprotector-all), 1)\n  CORE_CFLAGS += -fstack-protector-all\nendif\n\nifeq ($(DEBUG),0)\n  ifeq ($(feature-fortify-source), 1)\n    CORE_CFLAGS += -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2\n  endif\nendif\n\nINC_FLAGS += -I$(src-perf)/util/include\nINC_FLAGS += -I$(src-perf)/arch/$(SRCARCH)/include\nINC_FLAGS += -I$(srctree)/tools/include/\nINC_FLAGS += -I$(srctree)/tools/arch/$(SRCARCH)/include/uapi\nINC_FLAGS += -I$(srctree)/tools/include/uapi\nINC_FLAGS += -I$(srctree)/tools/arch/$(SRCARCH)/include/\nINC_FLAGS += -I$(srctree)/tools/arch/$(SRCARCH)/\n\n# $(obj-perf)      for generated common-cmds.h\n# $(obj-perf)/util for generated bison/flex headers\nifneq ($(OUTPUT),)\nINC_FLAGS += -I$(obj-perf)/util\nINC_FLAGS += -I$(obj-perf)\nendif\n\nINC_FLAGS += -I$(src-perf)/util\nINC_FLAGS += -I$(src-perf)\n\nCORE_CFLAGS += -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64 -D_GNU_SOURCE\n\nCFLAGS   += $(CORE_CFLAGS) $(INC_FLAGS)\nCXXFLAGS += $(INC_FLAGS)\n\nLIBPERF_CFLAGS := $(CORE_CFLAGS) $(EXTRA_CFLAGS)\n\nifeq ($(feature-pthread-attr-setaffinity-np), 1)\n  CFLAGS += -DHAVE_PTHREAD_ATTR_SETAFFINITY_NP\nendif\n\nifeq ($(feature-pthread-barrier), 1)\n  CFLAGS += -DHAVE_PTHREAD_BARRIER\nendif\n\nifndef NO_BIONIC\n  $(call feature_check,bionic)\n  ifeq ($(feature-bionic), 1)\n    BIONIC := 1\n    CFLAGS += -DLACKS_SIGQUEUE_PROTOTYPE\n    CFLAGS += -DLACKS_OPEN_MEMSTREAM_PROTOTYPE\n    EXTLIBS := $(filter-out -lrt,$(EXTLIBS))\n    EXTLIBS := $(filter-out -lpthread,$(EXTLIBS))\n  endif\nendif\n\nifeq ($(feature-eventfd), 1)\n  CFLAGS += -DHAVE_EVENTFD_SUPPORT\nendif\n\nifeq ($(feature-get_current_dir_name), 1)\n  CFLAGS += -DHAVE_GET_CURRENT_DIR_NAME\nendif\n\nifeq ($(feature-gettid), 1)\n  CFLAGS += -DHAVE_GETTID\nendif\n\nifeq ($(feature-file-handle), 1)\n  CFLAGS += -DHAVE_FILE_HANDLE\nendif\n\nifdef NO_LIBELF\n  NO_DWARF := 1\n  NO_LIBUNWIND := 1\n  NO_LIBDW_DWARF_UNWIND := 1\n  NO_LIBBPF := 1\n  NO_JVMTI := 1\nelse\n  ifeq ($(feature-libelf), 0)\n    ifeq ($(feature-glibc), 1)\n      LIBC_SUPPORT := 1\n    endif\n    ifeq ($(BIONIC),1)\n      LIBC_SUPPORT := 1\n    endif\n    ifeq ($(LIBC_SUPPORT),1)\n      msg := $(error ERROR: No libelf found. Disables 'probe' tool, jvmti and BPF support. Please install libelf-dev, libelf-devel, elfutils-libelf-devel or build with NO_LIBELF=1.)\n    else\n      ifneq ($(filter s% -fsanitize=address%,$(EXTRA_CFLAGS),),)\n        ifneq ($(shell ldconfig -p | grep libasan >/dev/null 2>&1; echo $$?), 0)\n          msg := $(error No libasan found, please install libasan);\n        endif\n      endif\n\n      ifneq ($(filter s% -fsanitize=undefined%,$(EXTRA_CFLAGS),),)\n        ifneq ($(shell ldconfig -p | grep libubsan >/dev/null 2>&1; echo $$?), 0)\n          msg := $(error No libubsan found, please install libubsan);\n        endif\n      endif\n\n      ifneq ($(filter s% -static%,$(LDFLAGS),),)\n        msg := $(error No static glibc found, please install glibc-static);\n      else\n        msg := $(error No gnu/libc-version.h found, please install glibc-dev[el]);\n      endif\n    endif\n  else\n    ifndef NO_LIBDW_DWARF_UNWIND\n      ifneq ($(feature-libdw-dwarf-unwind),1)\n        NO_LIBDW_DWARF_UNWIND := 1\n        msg := $(warning No libdw DWARF unwind found, Please install elfutils-devel/libdw-dev >= 0.158 and/or set LIBDW_DIR);\n      endif\n    endif\n    ifneq ($(feature-dwarf), 1)\n      ifndef NO_DWARF\n        msg := $(warning No libdw.h found or old libdw.h found or elfutils is older than 0.138, disables dwarf support. Please install new elfutils-devel/libdw-dev);\n        NO_DWARF := 1\n      endif\n    else\n      ifneq ($(feature-dwarf_getlocations), 1)\n        msg := $(warning Old libdw.h, finding variables at given 'perf probe' point will not work, install elfutils-devel/libdw-dev >= 0.157);\n      else\n        CFLAGS += -DHAVE_DWARF_GETLOCATIONS_SUPPORT\n      endif # dwarf_getlocations\n    endif # Dwarf support\n  endif # libelf support\nendif # NO_LIBELF\n\nifeq ($(feature-libaio), 1)\n  ifndef NO_AIO\n    CFLAGS += -DHAVE_AIO_SUPPORT\n  endif\nendif\n\nifdef NO_DWARF\n  NO_LIBDW_DWARF_UNWIND := 1\nendif\n\nifeq ($(feature-scandirat), 1)\n  CFLAGS += -DHAVE_SCANDIRAT_SUPPORT\nendif\n\nifeq ($(feature-sched_getcpu), 1)\n  CFLAGS += -DHAVE_SCHED_GETCPU_SUPPORT\nendif\n\nifeq ($(feature-setns), 1)\n  CFLAGS += -DHAVE_SETNS_SUPPORT\n  $(call detected,CONFIG_SETNS)\nendif\n\nifdef CORESIGHT\n  $(call feature_check,libopencsd)\n  ifeq ($(feature-libopencsd), 1)\n    CFLAGS += -DHAVE_CSTRACE_SUPPORT $(LIBOPENCSD_CFLAGS)\n    ifeq ($(feature-reallocarray), 0)\n      CFLAGS += -DCOMPAT_NEED_REALLOCARRAY\n    endif\n    LDFLAGS += $(LIBOPENCSD_LDFLAGS)\n    EXTLIBS += $(OPENCSDLIBS)\n    $(call detected,CONFIG_LIBOPENCSD)\n    ifdef CSTRACE_RAW\n      CFLAGS += -DCS_DEBUG_RAW\n      ifeq (${CSTRACE_RAW}, packed)\n        CFLAGS += -DCS_RAW_PACKED\n      endif\n    endif\n  else\n    dummy := $(error Error: No libopencsd library found or the version is not up-to-date. Please install recent libopencsd to build with CORESIGHT=1)\n  endif\nendif\n\nifndef NO_LIBELF\n  CFLAGS += -DHAVE_LIBELF_SUPPORT\n  EXTLIBS += -lelf\n  $(call detected,CONFIG_LIBELF)\n\n  ifeq ($(feature-libelf-getphdrnum), 1)\n    CFLAGS += -DHAVE_ELF_GETPHDRNUM_SUPPORT\n  endif\n\n  ifeq ($(feature-libelf-gelf_getnote), 1)\n    CFLAGS += -DHAVE_GELF_GETNOTE_SUPPORT\n  else\n    msg := $(warning gelf_getnote() not found on libelf, SDT support disabled);\n  endif\n\n  ifeq ($(feature-libelf-getshdrstrndx), 1)\n    CFLAGS += -DHAVE_ELF_GETSHDRSTRNDX_SUPPORT\n  endif\n\n  ifndef NO_LIBDEBUGINFOD\n    $(call feature_check,libdebuginfod)\n    ifeq ($(feature-libdebuginfod), 1)\n      CFLAGS += -DHAVE_DEBUGINFOD_SUPPORT\n      EXTLIBS += -ldebuginfod\n    endif\n  endif\n\n  ifndef NO_DWARF\n    ifeq ($(origin PERF_HAVE_DWARF_REGS), undefined)\n      msg := $(warning DWARF register mappings have not been defined for architecture $(SRCARCH), DWARF support disabled);\n      NO_DWARF := 1\n    else\n      CFLAGS += -DHAVE_DWARF_SUPPORT $(LIBDW_CFLAGS)\n      LDFLAGS += $(LIBDW_LDFLAGS)\n      EXTLIBS += ${DWARFLIBS}\n      $(call detected,CONFIG_DWARF)\n    endif # PERF_HAVE_DWARF_REGS\n  endif # NO_DWARF\n\n  ifndef NO_LIBBPF\n    ifeq ($(feature-bpf), 1)\n      CFLAGS += -DHAVE_LIBBPF_SUPPORT\n      $(call detected,CONFIG_LIBBPF)\n\n      # detecting libbpf without LIBBPF_DYNAMIC, so make VF=1 shows libbpf detection status\n      $(call feature_check,libbpf)\n\n      ifdef LIBBPF_DYNAMIC\n        ifeq ($(feature-libbpf), 1)\n          EXTLIBS += -lbpf\n          $(call detected,CONFIG_LIBBPF_DYNAMIC)\n        else\n          dummy := $(error Error: No libbpf devel library found or older than v1.0, please install/update libbpf-devel);\n        endif\n      else\n        # Libbpf will be built as a static library from tools/lib/bpf.\n\tLIBBPF_STATIC := 1\n      endif\n    endif\n  endif # NO_LIBBPF\nendif # NO_LIBELF\n\nifndef NO_SDT\n  ifneq ($(feature-sdt), 1)\n    msg := $(warning No sys/sdt.h found, no SDT events are defined, please install systemtap-sdt-devel or systemtap-sdt-dev);\n    NO_SDT := 1;\n  else\n    CFLAGS += -DHAVE_SDT_EVENT\n    $(call detected,CONFIG_SDT_EVENT)\n  endif\nendif\n\nifdef PERF_HAVE_JITDUMP\n  ifndef NO_LIBELF\n    $(call detected,CONFIG_JITDUMP)\n    CFLAGS += -DHAVE_JITDUMP\n  endif\nendif\n\nifeq ($(SRCARCH),powerpc)\n  ifndef NO_DWARF\n    CFLAGS += -DHAVE_SKIP_CALLCHAIN_IDX\n  endif\nendif\n\nifndef NO_LIBUNWIND\n  have_libunwind :=\n\n  $(call feature_check,libunwind-x86)\n  ifeq ($(feature-libunwind-x86), 1)\n    $(call detected,CONFIG_LIBUNWIND_X86)\n    CFLAGS += -DHAVE_LIBUNWIND_X86_SUPPORT\n    LDFLAGS += -lunwind-x86\n    EXTLIBS_LIBUNWIND += -lunwind-x86\n    have_libunwind = 1\n  endif\n\n  $(call feature_check,libunwind-aarch64)\n  ifeq ($(feature-libunwind-aarch64), 1)\n    $(call detected,CONFIG_LIBUNWIND_AARCH64)\n    CFLAGS += -DHAVE_LIBUNWIND_AARCH64_SUPPORT\n    LDFLAGS += -lunwind-aarch64\n    EXTLIBS_LIBUNWIND += -lunwind-aarch64\n    have_libunwind = 1\n    $(call feature_check,libunwind-debug-frame-aarch64)\n    ifneq ($(feature-libunwind-debug-frame-aarch64), 1)\n      msg := $(warning No debug_frame support found in libunwind-aarch64);\n      CFLAGS += -DNO_LIBUNWIND_DEBUG_FRAME_AARCH64\n    endif\n  endif\n\n  ifneq ($(feature-libunwind), 1)\n    msg := $(warning No libunwind found. Please install libunwind-dev[el] >= 1.1 and/or set LIBUNWIND_DIR);\n    NO_LOCAL_LIBUNWIND := 1\n  else\n    have_libunwind := 1\n    $(call detected,CONFIG_LOCAL_LIBUNWIND)\n  endif\n\n  ifneq ($(have_libunwind), 1)\n    NO_LIBUNWIND := 1\n  endif\nelse\n  NO_LOCAL_LIBUNWIND := 1\nendif\n\nifndef NO_LIBBPF\n  ifneq ($(feature-bpf), 1)\n    msg := $(warning BPF API too old. Please install recent kernel headers. BPF support in 'perf record' is disabled.)\n    NO_LIBBPF := 1\n  endif\nendif\n\nifdef BUILD_BPF_SKEL\n  $(call feature_check,clang-bpf-co-re)\n  ifeq ($(feature-clang-bpf-co-re), 0)\n    dummy := $(error Error: clang too old/not installed. Please install recent clang to build with BUILD_BPF_SKEL)\n  endif\n  ifeq ($(filter -DHAVE_LIBBPF_SUPPORT, $(CFLAGS)),)\n    dummy := $(error Error: BPF skeleton support requires libbpf)\n  endif\n  $(call detected,CONFIG_PERF_BPF_SKEL)\n  CFLAGS += -DHAVE_BPF_SKEL\nendif\n\nifndef GEN_VMLINUX_H\n  VMLINUX_H=$(src-perf)/util/bpf_skel/vmlinux/vmlinux.h\nendif\n\ndwarf-post-unwind := 1\ndwarf-post-unwind-text := BUG\n\n# setup DWARF post unwinder\nifdef NO_LIBUNWIND\n  ifdef NO_LIBDW_DWARF_UNWIND\n    msg := $(warning Disabling post unwind, no support found.);\n    dwarf-post-unwind := 0\n  else\n    dwarf-post-unwind-text := libdw\n    $(call detected,CONFIG_LIBDW_DWARF_UNWIND)\n  endif\nelse\n  dwarf-post-unwind-text := libunwind\n  $(call detected,CONFIG_LIBUNWIND)\n  # Enable libunwind support by default.\n  ifndef NO_LIBDW_DWARF_UNWIND\n    NO_LIBDW_DWARF_UNWIND := 1\n  endif\nendif\n\nifeq ($(dwarf-post-unwind),1)\n  CFLAGS += -DHAVE_DWARF_UNWIND_SUPPORT\n  $(call detected,CONFIG_DWARF_UNWIND)\nelse\n  NO_DWARF_UNWIND := 1\nendif\n\nifndef NO_LOCAL_LIBUNWIND\n  ifeq ($(SRCARCH),$(filter $(SRCARCH),arm arm64))\n    $(call feature_check,libunwind-debug-frame)\n    ifneq ($(feature-libunwind-debug-frame), 1)\n      msg := $(warning No debug_frame support found in libunwind);\n      CFLAGS += -DNO_LIBUNWIND_DEBUG_FRAME\n    endif\n  else\n    # non-ARM has no dwarf_find_debug_frame() function:\n    CFLAGS += -DNO_LIBUNWIND_DEBUG_FRAME\n  endif\n  EXTLIBS += $(LIBUNWIND_LIBS)\n  LDFLAGS += $(LIBUNWIND_LIBS)\nendif\nifeq ($(findstring -static,${LDFLAGS}),-static)\n  # gcc -static links libgcc_eh which contans piece of libunwind\n  LIBUNWIND_LDFLAGS += -Wl,--allow-multiple-definition\nendif\n\nifndef NO_LIBUNWIND\n  CFLAGS  += -DHAVE_LIBUNWIND_SUPPORT\n  CFLAGS  += $(LIBUNWIND_CFLAGS)\n  LDFLAGS += $(LIBUNWIND_LDFLAGS)\n  EXTLIBS += $(EXTLIBS_LIBUNWIND)\nendif\n\nifneq ($(NO_LIBTRACEEVENT),1)\n  ifeq ($(NO_SYSCALL_TABLE),0)\n    $(call detected,CONFIG_TRACE)\n  else\n    ifndef NO_LIBAUDIT\n      $(call feature_check,libaudit)\n      ifneq ($(feature-libaudit), 1)\n        msg := $(warning No libaudit.h found, disables 'trace' tool, please install audit-libs-devel or libaudit-dev);\n        NO_LIBAUDIT := 1\n      else\n        CFLAGS += -DHAVE_LIBAUDIT_SUPPORT\n        EXTLIBS += -laudit\n        $(call detected,CONFIG_TRACE)\n      endif\n    endif\n  endif\nendif\n\nifndef NO_LIBCRYPTO\n  ifneq ($(feature-libcrypto), 1)\n    msg := $(warning No libcrypto.h found, disables jitted code injection, please install openssl-devel or libssl-dev);\n    NO_LIBCRYPTO := 1\n  else\n    CFLAGS += -DHAVE_LIBCRYPTO_SUPPORT\n    EXTLIBS += -lcrypto\n    $(call detected,CONFIG_CRYPTO)\n  endif\nendif\n\nifndef NO_SLANG\n  ifneq ($(feature-libslang), 1)\n    ifneq ($(feature-libslang-include-subdir), 1)\n      msg := $(warning slang not found, disables TUI support. Please install slang-devel, libslang-dev or libslang2-dev);\n      NO_SLANG := 1\n    else\n      CFLAGS += -DHAVE_SLANG_INCLUDE_SUBDIR\n    endif\n  endif\n  ifndef NO_SLANG\n    # Fedora has /usr/include/slang/slang.h, but ubuntu /usr/include/slang.h\n    CFLAGS += -DHAVE_SLANG_SUPPORT\n    EXTLIBS += -lslang\n    $(call detected,CONFIG_SLANG)\n  endif\nendif\n\nifdef GTK2\n  FLAGS_GTK2=$(CFLAGS) $(LDFLAGS) $(EXTLIBS) $(shell $(PKG_CONFIG) --libs --cflags gtk+-2.0 2>/dev/null)\n  $(call feature_check,gtk2)\n  ifneq ($(feature-gtk2), 1)\n    msg := $(warning GTK2 not found, disables GTK2 support. Please install gtk2-devel or libgtk2.0-dev);\n    NO_GTK2 := 1\n  else\n    $(call feature_check,gtk2-infobar)\n    ifeq ($(feature-gtk2-infobar), 1)\n      GTK_CFLAGS := -DHAVE_GTK_INFO_BAR_SUPPORT\n    endif\n    CFLAGS += -DHAVE_GTK2_SUPPORT\n    GTK_CFLAGS += $(shell $(PKG_CONFIG) --cflags gtk+-2.0 2>/dev/null)\n    GTK_LIBS := $(shell $(PKG_CONFIG) --libs gtk+-2.0 2>/dev/null)\n    EXTLIBS += -ldl\n  endif\nendif\n\nifdef NO_LIBPERL\n  CFLAGS += -DNO_LIBPERL\nelse\n  PERL_EMBED_LDOPTS = $(shell perl -MExtUtils::Embed -e ldopts 2>/dev/null)\n  PERL_EMBED_LDFLAGS = $(call strip-libs,$(PERL_EMBED_LDOPTS))\n  PERL_EMBED_LIBADD = $(call grep-libs,$(PERL_EMBED_LDOPTS))\n  PERL_EMBED_CCOPTS = $(shell perl -MExtUtils::Embed -e ccopts 2>/dev/null)\n  PERL_EMBED_CCOPTS := $(filter-out -specs=%,$(PERL_EMBED_CCOPTS))\n  PERL_EMBED_CCOPTS := $(filter-out -flto=auto -ffat-lto-objects, $(PERL_EMBED_CCOPTS))\n  PERL_EMBED_LDOPTS := $(filter-out -specs=%,$(PERL_EMBED_LDOPTS))\n  FLAGS_PERL_EMBED=$(PERL_EMBED_CCOPTS) $(PERL_EMBED_LDOPTS)\n\n  ifneq ($(feature-libperl), 1)\n    CFLAGS += -DNO_LIBPERL\n    NO_LIBPERL := 1\n    msg := $(warning Missing perl devel files. Disabling perl scripting support, please install perl-ExtUtils-Embed/libperl-dev);\n  else\n    LDFLAGS += $(PERL_EMBED_LDFLAGS)\n    EXTLIBS += $(PERL_EMBED_LIBADD)\n    CFLAGS += -DHAVE_LIBPERL_SUPPORT\n    ifeq ($(CC_NO_CLANG), 0)\n      CFLAGS += -Wno-compound-token-split-by-macro\n    endif\n    $(call detected,CONFIG_LIBPERL)\n  endif\nendif\n\nifeq ($(feature-timerfd), 1)\n  CFLAGS += -DHAVE_TIMERFD_SUPPORT\nelse\n  msg := $(warning No timerfd support. Disables 'perf kvm stat live');\nendif\n\ndisable-python = $(eval $(disable-python_code))\ndefine disable-python_code\n  CFLAGS += -DNO_LIBPYTHON\n  $(warning $1)\n  NO_LIBPYTHON := 1\nendef\n\nPYTHON_EXTENSION_SUFFIX := '.so'\nifdef NO_LIBPYTHON\n  $(call disable-python,Python support disabled by user)\nelse\n\n  ifndef PYTHON\n    $(call disable-python,No python interpreter was found: disables Python support - please install python-devel/python-dev)\n  else\n    PYTHON_WORD := $(call shell-wordify,$(PYTHON))\n\n    ifndef PYTHON_CONFIG\n      $(call disable-python,No 'python-config' tool was found: disables Python support - please install python-devel/python-dev)\n    else\n\n      ifneq ($(feature-libpython), 1)\n        $(call disable-python,No 'Python.h' was found: disables Python support - please install python-devel/python-dev)\n      else\n         LDFLAGS += $(PYTHON_EMBED_LDFLAGS)\n         EXTLIBS += $(PYTHON_EMBED_LIBADD)\n         PYTHON_SETUPTOOLS_INSTALLED := $(shell $(PYTHON) -c 'import setuptools;' 2> /dev/null && echo \"yes\" || echo \"no\")\n         ifeq ($(PYTHON_SETUPTOOLS_INSTALLED), yes)\n           PYTHON_EXTENSION_SUFFIX := $(shell $(PYTHON) -c 'from importlib import machinery; print(machinery.EXTENSION_SUFFIXES[0])')\n           LANG_BINDINGS += $(obj-perf)python/perf$(PYTHON_EXTENSION_SUFFIX)\n\t else\n           msg := $(warning Missing python setuptools, the python binding won't be built, please install python3-setuptools or equivalent);\n         endif\n         CFLAGS += -DHAVE_LIBPYTHON_SUPPORT\n         $(call detected,CONFIG_LIBPYTHON)\n      endif\n    endif\n  endif\nendif\n\nifneq ($(NO_JEVENTS),1)\n  ifeq ($(wildcard pmu-events/arch/$(SRCARCH)/mapfile.csv),)\n    NO_JEVENTS := 1\n  endif\nendif\nifneq ($(NO_JEVENTS),1)\n  NO_JEVENTS := 0\n  ifndef PYTHON\n    $(error ERROR: No python interpreter needed for jevents generation. Install python or build with NO_JEVENTS=1.)\n  else\n    # jevents.py uses f-strings present in Python 3.6 released in Dec. 2016.\n    JEVENTS_PYTHON_GOOD := $(shell $(PYTHON) -c 'import sys;print(\"1\" if(sys.version_info.major >= 3 and sys.version_info.minor >= 6) else \"0\")' 2> /dev/null)\n    ifneq ($(JEVENTS_PYTHON_GOOD), 1)\n      $(error ERROR: Python interpreter needed for jevents generation too old (older than 3.6). Install a newer python or build with NO_JEVENTS=1.)\n    endif\n  endif\nendif\n\nifdef BUILD_NONDISTRO\n  ifeq ($(feature-libbfd), 1)\n    EXTLIBS += -lbfd -lopcodes\n  else\n    # we are on a system that requires -liberty and (maybe) -lz\n    # to link against -lbfd; test each case individually here\n\n    # call all detections now so we get correct\n    # status in VF output\n    $(call feature_check,libbfd-liberty)\n    $(call feature_check,libbfd-liberty-z)\n\n    ifeq ($(feature-libbfd-liberty), 1)\n      EXTLIBS += -lbfd -lopcodes -liberty\n      FEATURE_CHECK_LDFLAGS-disassembler-four-args += -liberty -ldl\n      FEATURE_CHECK_LDFLAGS-disassembler-init-styled += -liberty -ldl\n    else\n      ifeq ($(feature-libbfd-liberty-z), 1)\n        EXTLIBS += -lbfd -lopcodes -liberty -lz\n        FEATURE_CHECK_LDFLAGS-disassembler-four-args += -liberty -lz -ldl\n        FEATURE_CHECK_LDFLAGS-disassembler-init-styled += -liberty -lz -ldl\n      endif\n    endif\n    $(call feature_check,disassembler-four-args)\n    $(call feature_check,disassembler-init-styled)\n  endif\n\n  CFLAGS += -DHAVE_LIBBFD_SUPPORT\n  CXXFLAGS += -DHAVE_LIBBFD_SUPPORT\n  ifeq ($(feature-libbfd-buildid), 1)\n    CFLAGS += -DHAVE_LIBBFD_BUILDID_SUPPORT\n  else\n    msg := $(warning Old version of libbfd/binutils things like PE executable profiling will not be available);\n  endif\nendif\n\nifndef NO_DEMANGLE\n  $(call feature_check,cxa-demangle)\n  ifeq ($(feature-cxa-demangle), 1)\n    EXTLIBS += -lstdc++\n    CFLAGS += -DHAVE_CXA_DEMANGLE_SUPPORT\n    CXXFLAGS += -DHAVE_CXA_DEMANGLE_SUPPORT\n    $(call detected,CONFIG_CXX_DEMANGLE)\n  endif\n  ifdef BUILD_NONDISTRO\n    ifeq ($(filter -liberty,$(EXTLIBS)),)\n      $(call feature_check,cplus-demangle)\n      ifeq ($(feature-cplus-demangle), 1)\n        EXTLIBS += -liberty\n      endif\n    endif\n    ifneq ($(filter -liberty,$(EXTLIBS)),)\n      CFLAGS += -DHAVE_CPLUS_DEMANGLE_SUPPORT\n      CXXFLAGS += -DHAVE_CPLUS_DEMANGLE_SUPPORT\n    endif\n  endif\nendif\n\nifndef NO_ZLIB\n  ifeq ($(feature-zlib), 1)\n    CFLAGS += -DHAVE_ZLIB_SUPPORT\n    EXTLIBS += -lz\n    $(call detected,CONFIG_ZLIB)\n  else\n    NO_ZLIB := 1\n  endif\nendif\n\nifndef NO_LZMA\n  ifeq ($(feature-lzma), 1)\n    CFLAGS += -DHAVE_LZMA_SUPPORT\n    EXTLIBS += -llzma\n    $(call detected,CONFIG_LZMA)\n  else\n    msg := $(warning No liblzma found, disables xz kernel module decompression, please install xz-devel/liblzma-dev);\n    NO_LZMA := 1\n  endif\nendif\n\nifndef NO_LIBZSTD\n  ifeq ($(feature-libzstd), 1)\n    CFLAGS += -DHAVE_ZSTD_SUPPORT\n    CFLAGS += $(LIBZSTD_CFLAGS)\n    LDFLAGS += $(LIBZSTD_LDFLAGS)\n    EXTLIBS += -lzstd\n    $(call detected,CONFIG_ZSTD)\n  else\n    msg := $(warning No libzstd found, disables trace compression, please install libzstd-dev[el] and/or set LIBZSTD_DIR);\n    NO_LIBZSTD := 1\n  endif\nendif\n\nifndef NO_LIBCAP\n  ifeq ($(feature-libcap), 1)\n    CFLAGS += -DHAVE_LIBCAP_SUPPORT\n    EXTLIBS += -lcap\n    $(call detected,CONFIG_LIBCAP)\n  else\n    msg := $(warning No libcap found, disables capability support, please install libcap-devel/libcap-dev);\n    NO_LIBCAP := 1\n  endif\nendif\n\nifndef NO_BACKTRACE\n  ifeq ($(feature-backtrace), 1)\n    CFLAGS += -DHAVE_BACKTRACE_SUPPORT\n  endif\nendif\n\nifndef NO_LIBNUMA\n  ifeq ($(feature-libnuma), 0)\n    msg := $(warning No numa.h found, disables 'perf bench numa mem' benchmark, please install numactl-devel/libnuma-devel/libnuma-dev);\n    NO_LIBNUMA := 1\n  else\n    ifeq ($(feature-numa_num_possible_cpus), 0)\n      msg := $(warning Old numa library found, disables 'perf bench numa mem' benchmark, please install numactl-devel/libnuma-devel/libnuma-dev >= 2.0.8);\n      NO_LIBNUMA := 1\n    else\n      CFLAGS += -DHAVE_LIBNUMA_SUPPORT\n      EXTLIBS += -lnuma\n      $(call detected,CONFIG_NUMA)\n    endif\n  endif\nendif\n\nifdef HAVE_KVM_STAT_SUPPORT\n    CFLAGS += -DHAVE_KVM_STAT_SUPPORT\nendif\n\nifeq ($(feature-disassembler-four-args), 1)\n    CFLAGS += -DDISASM_FOUR_ARGS_SIGNATURE\nendif\n\nifeq ($(feature-disassembler-init-styled), 1)\n    CFLAGS += -DDISASM_INIT_STYLED\nendif\n\nifeq (${IS_64_BIT}, 1)\n  ifndef NO_PERF_READ_VDSO32\n    $(call feature_check,compile-32)\n    ifeq ($(feature-compile-32), 1)\n      CFLAGS += -DHAVE_PERF_READ_VDSO32\n    else\n      NO_PERF_READ_VDSO32 := 1\n    endif\n  endif\n  ifneq ($(SRCARCH), x86)\n    NO_PERF_READ_VDSOX32 := 1\n  endif\n  ifndef NO_PERF_READ_VDSOX32\n    $(call feature_check,compile-x32)\n    ifeq ($(feature-compile-x32), 1)\n      CFLAGS += -DHAVE_PERF_READ_VDSOX32\n    else\n      NO_PERF_READ_VDSOX32 := 1\n    endif\n  endif\nelse\n  NO_PERF_READ_VDSO32 := 1\n  NO_PERF_READ_VDSOX32 := 1\nendif\n\nifndef NO_LIBBABELTRACE\n  $(call feature_check,libbabeltrace)\n  ifeq ($(feature-libbabeltrace), 1)\n    CFLAGS += -DHAVE_LIBBABELTRACE_SUPPORT $(LIBBABELTRACE_CFLAGS)\n    LDFLAGS += $(LIBBABELTRACE_LDFLAGS)\n    EXTLIBS += -lbabeltrace-ctf\n    $(call detected,CONFIG_LIBBABELTRACE)\n  else\n    msg := $(warning No libbabeltrace found, disables 'perf data' CTF format support, please install libbabeltrace-dev[el]/libbabeltrace-ctf-dev);\n  endif\nendif\n\nifndef NO_AUXTRACE\n  ifeq ($(SRCARCH),x86)\n    ifeq ($(feature-get_cpuid), 0)\n      msg := $(warning Your gcc lacks the __get_cpuid() builtin, disables support for auxtrace/Intel PT, please install a newer gcc);\n      NO_AUXTRACE := 1\n    endif\n  endif\n  ifndef NO_AUXTRACE\n    $(call detected,CONFIG_AUXTRACE)\n    CFLAGS += -DHAVE_AUXTRACE_SUPPORT\n    ifeq ($(feature-reallocarray), 0)\n      CFLAGS += -DCOMPAT_NEED_REALLOCARRAY\n    endif\n  endif\nendif\n\nifdef EXTRA_TESTS\n    $(call detected,CONFIG_EXTRA_TESTS)\n    CFLAGS += -DHAVE_EXTRA_TESTS\nendif\n\nifndef NO_JVMTI\n  ifneq (,$(wildcard /usr/sbin/update-java-alternatives))\n    JDIR=$(shell /usr/sbin/update-java-alternatives -l | head -1 | awk '{print $$3}')\n  else\n    ifneq (,$(wildcard /usr/sbin/alternatives))\n      JDIR=$(shell /usr/sbin/alternatives --display java | tail -1 | cut -d' ' -f 5 | sed -e 's%/jre/bin/java.%%g' -e 's%/bin/java.%%g')\n    endif\n  endif\n  ifndef JDIR\n    $(warning No alternatives command found, you need to set JDIR= to point to the root of your Java directory)\n    NO_JVMTI := 1\n  endif\nendif\n\nifndef NO_JVMTI\n  FEATURE_CHECK_CFLAGS-jvmti := -I$(JDIR)/include -I$(JDIR)/include/linux\n  $(call feature_check,jvmti)\n  ifeq ($(feature-jvmti), 1)\n    $(call detected_var,JDIR)\n    ifndef NO_JVMTI_CMLR\n      FEATURE_CHECK_CFLAGS-jvmti-cmlr := $(FEATURE_CHECK_CFLAGS-jvmti)\n      $(call feature_check,jvmti-cmlr)\n      ifeq ($(feature-jvmti-cmlr), 1)\n        CFLAGS += -DHAVE_JVMTI_CMLR\n      endif\n    endif # NO_JVMTI_CMLR\n  else\n    $(warning No openjdk development package found, please install JDK package, e.g. openjdk-8-jdk, java-1.8.0-openjdk-devel)\n    NO_JVMTI := 1\n  endif\nendif\n\nifndef NO_LIBPFM4\n  $(call feature_check,libpfm4)\n  ifeq ($(feature-libpfm4), 1)\n    CFLAGS += -DHAVE_LIBPFM\n    EXTLIBS += -lpfm\n    ASCIIDOC_EXTRA = -aHAVE_LIBPFM=1\n    $(call detected,CONFIG_LIBPFM4)\n  else\n    msg := $(warning libpfm4 not found, disables libpfm4 support. Please install libpfm4-dev);\n  endif\nendif\n\n# libtraceevent is a recommended dependency picked up from the system.\nifneq ($(NO_LIBTRACEEVENT),1)\n  $(call feature_check,libtraceevent)\n  ifeq ($(feature-libtraceevent), 1)\n    CFLAGS += -DHAVE_LIBTRACEEVENT\n    EXTLIBS += -ltraceevent\n    LIBTRACEEVENT_VERSION := $(shell $(PKG_CONFIG) --modversion libtraceevent)\n    LIBTRACEEVENT_VERSION_1 := $(word 1, $(subst ., ,$(LIBTRACEEVENT_VERSION)))\n    LIBTRACEEVENT_VERSION_2 := $(word 2, $(subst ., ,$(LIBTRACEEVENT_VERSION)))\n    LIBTRACEEVENT_VERSION_3 := $(word 3, $(subst ., ,$(LIBTRACEEVENT_VERSION)))\n    LIBTRACEEVENT_VERSION_CPP := $(shell expr $(LIBTRACEEVENT_VERSION_1) \\* 255 \\* 255 + $(LIBTRACEEVENT_VERSION_2) \\* 255 + $(LIBTRACEEVENT_VERSION_3))\n    CFLAGS += -DLIBTRACEEVENT_VERSION=$(LIBTRACEEVENT_VERSION_CPP)\n    $(call detected,CONFIG_LIBTRACEEVENT)\n  else\n    dummy := $(error ERROR: libtraceevent is missing. Please install libtraceevent-dev/libtraceevent-devel or build with NO_LIBTRACEEVENT=1)\n  endif\n\n  $(call feature_check,libtracefs)\n  ifeq ($(feature-libtracefs), 1)\n    EXTLIBS += -ltracefs\n    LIBTRACEFS_VERSION := $(shell $(PKG_CONFIG) --modversion libtracefs)\n    LIBTRACEFS_VERSION_1 := $(word 1, $(subst ., ,$(LIBTRACEFS_VERSION)))\n    LIBTRACEFS_VERSION_2 := $(word 2, $(subst ., ,$(LIBTRACEFS_VERSION)))\n    LIBTRACEFS_VERSION_3 := $(word 3, $(subst ., ,$(LIBTRACEFS_VERSION)))\n    LIBTRACEFS_VERSION_CPP := $(shell expr $(LIBTRACEFS_VERSION_1) \\* 255 \\* 255 + $(LIBTRACEFS_VERSION_2) \\* 255 + $(LIBTRACEFS_VERSION_3))\n    CFLAGS += -DLIBTRACEFS_VERSION=$(LIBTRACEFS_VERSION_CPP)\n  endif\nendif\n\n# Among the variables below, these:\n#   perfexecdir\n#   libbpf_include_dir\n#   perf_examples_dir\n#   template_dir\n#   mandir\n#   infodir\n#   htmldir\n#   ETC_PERFCONFIG (but not sysconfdir)\n# can be specified as a relative path some/where/else;\n# this is interpreted as relative to $(prefix) and \"perf\" at\n# runtime figures out where they are based on the path to the executable.\n# This can help installing the suite in a relocatable way.\n\n# Make the path relative to DESTDIR, not to prefix\nifndef DESTDIR\nprefix ?= $(HOME)\nendif\nbindir_relative = bin\nbindir = $(abspath $(prefix)/$(bindir_relative))\nincludedir_relative = include\nincludedir = $(abspath $(prefix)/$(includedir_relative))\nmandir = share/man\ninfodir = share/info\nperfexecdir = libexec/perf-core\n# FIXME: system's libbpf header directory, where we expect to find bpf/bpf_helpers.h, for instance\nlibbpf_include_dir = /usr/include\nperf_examples_dir = lib/perf/examples\nsharedir = $(prefix)/share\ntemplate_dir = share/perf-core/templates\nSTRACE_GROUPS_DIR = share/perf-core/strace/groups\nhtmldir = share/doc/perf-doc\ntipdir = share/doc/perf-tip\nsrcdir = $(srctree)/tools/perf\nifeq ($(prefix),/usr)\nsysconfdir = /etc\nETC_PERFCONFIG = $(sysconfdir)/perfconfig\nelse\nsysconfdir = $(prefix)/etc\nETC_PERFCONFIG = etc/perfconfig\nendif\nifndef lib\nifeq ($(SRCARCH)$(IS_64_BIT), x861)\nlib = lib64\nelse\nlib = lib\nendif\nendif # lib\nlibdir = $(prefix)/$(lib)\n\n# Shell quote (do not use $(call) to accommodate ancient setups);\nETC_PERFCONFIG_SQ = $(subst ','\\'',$(ETC_PERFCONFIG))\nSTRACE_GROUPS_DIR_SQ = $(subst ','\\'',$(STRACE_GROUPS_DIR))\nDESTDIR_SQ = $(subst ','\\'',$(DESTDIR))\nbindir_SQ = $(subst ','\\'',$(bindir))\nincludedir_SQ = $(subst ','\\'',$(includedir))\nmandir_SQ = $(subst ','\\'',$(mandir))\ninfodir_SQ = $(subst ','\\'',$(infodir))\nperfexecdir_SQ = $(subst ','\\'',$(perfexecdir))\nlibbpf_include_dir_SQ = $(subst ','\\'',$(libbpf_include_dir))\nperf_examples_dir_SQ = $(subst ','\\'',$(perf_examples_dir))\ntemplate_dir_SQ = $(subst ','\\'',$(template_dir))\nhtmldir_SQ = $(subst ','\\'',$(htmldir))\ntipdir_SQ = $(subst ','\\'',$(tipdir))\nprefix_SQ = $(subst ','\\'',$(prefix))\nsysconfdir_SQ = $(subst ','\\'',$(sysconfdir))\nlibdir_SQ = $(subst ','\\'',$(libdir))\nsrcdir_SQ = $(subst ','\\'',$(srcdir))\n\nifneq ($(filter /%,$(firstword $(perfexecdir))),)\nperfexec_instdir = $(perfexecdir)\nperf_include_instdir = $(libbpf_include_dir)\nperf_examples_instdir = $(perf_examples_dir)\nSTRACE_GROUPS_INSTDIR = $(STRACE_GROUPS_DIR)\ntip_instdir = $(tipdir)\nelse\nperfexec_instdir = $(prefix)/$(perfexecdir)\nperf_include_instdir = $(prefix)/$(libbpf_include_dir)\nperf_examples_instdir = $(prefix)/$(perf_examples_dir)\nSTRACE_GROUPS_INSTDIR = $(prefix)/$(STRACE_GROUPS_DIR)\ntip_instdir = $(prefix)/$(tipdir)\nendif\nperfexec_instdir_SQ = $(subst ','\\'',$(perfexec_instdir))\nperf_include_instdir_SQ = $(subst ','\\'',$(perf_include_instdir))\nperf_examples_instdir_SQ = $(subst ','\\'',$(perf_examples_instdir))\nSTRACE_GROUPS_INSTDIR_SQ = $(subst ','\\'',$(STRACE_GROUPS_INSTDIR))\ntip_instdir_SQ = $(subst ','\\'',$(tip_instdir))\n\nexport perfexec_instdir_SQ\n\nprint_var = $(eval $(print_var_code)) $(info $(MSG))\ndefine print_var_code\n    MSG = $(shell printf '...%40s: %s' $(1) $($(1)))\nendef\n\nifeq ($(feature_display),1)\n  $(call feature_display_entries)\nendif\n\nifeq ($(VF),1)\n  # Display EXTRA features which are detected manualy\n  # from here with feature_check call and thus cannot\n  # be partof global state output.\n  $(foreach feat,$(FEATURE_TESTS_EXTRA),$(call feature_print_status,$(feat),) $(info $(MSG)))\n  $(call print_var,prefix)\n  $(call print_var,bindir)\n  $(call print_var,libdir)\n  $(call print_var,sysconfdir)\n  $(call print_var,LIBUNWIND_DIR)\n  $(call print_var,LIBDW_DIR)\n  $(call print_var,JDIR)\n\n  ifeq ($(dwarf-post-unwind),1)\n    $(call feature_print_text,\"DWARF post unwind library\", $(dwarf-post-unwind-text)) $(info $(MSG))\n  endif\nendif\n\n$(info )\n\n$(call detected_var,bindir_SQ)\n$(call detected_var,PYTHON_WORD)\nifneq ($(OUTPUT),)\n$(call detected_var,OUTPUT)\nendif\n$(call detected_var,htmldir_SQ)\n$(call detected_var,infodir_SQ)\n$(call detected_var,mandir_SQ)\n$(call detected_var,ETC_PERFCONFIG_SQ)\n$(call detected_var,STRACE_GROUPS_DIR_SQ)\n$(call detected_var,prefix_SQ)\n$(call detected_var,perfexecdir_SQ)\n$(call detected_var,libbpf_include_dir_SQ)\n$(call detected_var,perf_examples_dir_SQ)\n$(call detected_var,tipdir_SQ)\n$(call detected_var,srcdir_SQ)\n$(call detected_var,LIBDIR)\n$(call detected_var,GTK_CFLAGS)\n$(call detected_var,PERL_EMBED_CCOPTS)\n$(call detected_var,PYTHON_EMBED_CCOPTS)\nifneq ($(BISON_FILE_PREFIX_MAP),)\n$(call detected_var,BISON_FILE_PREFIX_MAP)\nendif\n\n# re-generate FEATURE-DUMP as we may have called feature_check, found out\n# extra libraries to add to LDFLAGS of some other test and then redo those\n# tests, see the block about libbfd, disassembler-four-args, for instance.\n$(shell rm -f $(FEATURE_DUMP_FILENAME))\n$(foreach feat,$(FEATURE_TESTS),$(shell echo \"$(call feature_assign,$(feat))\" >> $(FEATURE_DUMP_FILENAME)))\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}