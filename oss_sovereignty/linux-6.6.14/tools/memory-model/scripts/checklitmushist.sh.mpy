{
  "module_name": "checklitmushist.sh",
  "hash_id": "3a2e95275742e1005840fec06b16752df0ccc39112cd6f12f172b90ee5ab8b25",
  "original_prompt": "Ingested from linux-6.6.14/tools/memory-model/scripts/checklitmushist.sh",
  "human_readable_source": "#!/bin/sh\n# SPDX-License-Identifier: GPL-2.0+\n#\n# Reruns the C-language litmus tests previously run that match the\n# specified criteria, and compares the result to that of the previous\n# runs from initlitmushist.sh and/or newlitmushist.sh.\n#\n# sh checklitmushist.sh\n#\n# Run from the Linux kernel tools/memory-model directory.\n# See scripts/parseargs.sh for list of arguments.\n#\n# Copyright IBM Corporation, 2018\n#\n# Author: Paul E. McKenney <paulmck@linux.ibm.com>\n\n. scripts/parseargs.sh\n\nT=/tmp/checklitmushist.sh.$$\ntrap 'rm -rf $T' 0\nmkdir $T\n\nif test -d litmus\nthen\n\t:\nelse\n\techo Run scripts/initlitmushist.sh first, need litmus repo.\n\texit 1\nfi\n\n# Create the results directory and populate it with subdirectories.\n# The initial output is created here to avoid clobbering the output\n# generated earlier.\nmkdir $T/results\nfind litmus -type d -print | ( cd $T/results; sed -e 's/^/mkdir -p /' | sh )\n\n# Create the list of litmus tests already run, then remove those that\n# are excluded by this run's --procs argument.\n( cd $LKMM_DESTDIR; find litmus -name '*.litmus.out' -print ) |\n\tsed -e 's/\\.out$//' |\n\txargs -r grep -L \"^P${LKMM_PROCS}\"> $T/list-C-already\nxargs < $T/list-C-already -r grep -L \"^P${LKMM_PROCS}\" > $T/list-C-short\n\n# Redirect output, run tests, then restore destination directory.\ndestdir=\"$LKMM_DESTDIR\"\nLKMM_DESTDIR=$T/results; export LKMM_DESTDIR\nscripts/runlitmushist.sh < $T/list-C-short > $T/runlitmushist.sh.out 2>&1\nLKMM_DESTDIR=\"$destdir\"; export LKMM_DESTDIR\n\n# Move the newly generated .litmus.out files to .litmus.out.new files\n# in the destination directory.\ncdir=`pwd`\nddir=`awk -v c=\"$cdir\" -v d=\"$LKMM_DESTDIR\" \\\n\t'END { if (d ~ /^\\//) print d; else print c \"/\" d; }' < /dev/null`\n( cd $T/results; find litmus -type f -name '*.litmus.out' -print |\n  sed -e 's,^.*$,cp & '\"$ddir\"'/&.new,' | sh )\n\nsed < $T/list-C-short -e 's,^,'\"$LKMM_DESTDIR/\"',' |\n\tsh scripts/cmplitmushist.sh\nexit $?\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}