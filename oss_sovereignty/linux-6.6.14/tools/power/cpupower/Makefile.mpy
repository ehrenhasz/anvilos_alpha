{
  "module_name": "Makefile",
  "hash_id": "5e4bef62c49ea757f840576ad4b70877b19d71367951778c8584a2d87a7efde8",
  "original_prompt": "Ingested from linux-6.6.14/tools/power/cpupower/Makefile",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n# Makefile for cpupower\n#\n# Copyright (C) 2005,2006 Dominik Brodowski <linux@dominikbrodowski.net>\n#\n# Based largely on the Makefile for udev by:\n#\n# Copyright (C) 2003,2004 Greg Kroah-Hartman <greg@kroah.com>\n#\nOUTPUT=./\nifeq (\"$(origin O)\", \"command line\")\n\tOUTPUT := $(O)/\nendif\n\nifneq ($(OUTPUT),)\n# check that the output directory actually exists\nOUTDIR := $(shell cd $(OUTPUT) && pwd)\n$(if $(OUTDIR),, $(error output directory \"$(OUTPUT)\" does not exist))\nendif\n\n\n# --- CONFIGURATION BEGIN ---\n\n# Set the following to `true' to make a unstripped, unoptimized\n# binary. Leave this set to `false' for production use.\nDEBUG ?=\ttrue\n\n# make the build silent. Set this to something else to make it noisy again.\nV ?=\t\tfalse\n\n# Internationalization support (output in different languages).\n# Requires gettext.\nNLS ?=\t\ttrue\n\n# Set the following to 'true' to build/install the\n# cpufreq-bench benchmarking tool\nCPUFREQ_BENCH ?= true\n\n# Do not build libraries, but build the code in statically\n# Libraries are still built, otherwise the Makefile code would\n# be rather ugly.\nexport STATIC ?= false\n\n# Prefix to the directories we're installing to\nDESTDIR ?=\n\n# --- CONFIGURATION END ---\n\n\n\n# Package-related definitions. Distributions can modify the version\n# and _should_ modify the PACKAGE_BUGREPORT definition\n\nVERSION:=\t\t\t$(shell ./utils/version-gen.sh)\nLIB_MAJ=\t\t\t0.0.1\nLIB_MIN=\t\t\t1\n\nPACKAGE =\t\t\tcpupower\nPACKAGE_BUGREPORT =\t\tlinux-pm@vger.kernel.org\nLANGUAGES = \t\t\tde fr it cs pt ka\n\n\n# Directory definitions. These are default and most probably\n# do not need to be changed. Please note that DESTDIR is\n# added in front of any of them\n\nbindir ?=\t/usr/bin\nsbindir ?=\t/usr/sbin\nmandir ?=\t/usr/man\nincludedir ?=\t/usr/include\nlocaledir ?=\t/usr/share/locale\ndocdir ?=       /usr/share/doc/packages/cpupower\nconfdir ?=      /etc/\nbash_completion_dir ?= /usr/share/bash-completion/completions\n\n# Toolchain: what tools do we use, and what options do they need:\n\nCP = cp -fpR\nINSTALL = /usr/bin/install -c\nINSTALL_PROGRAM = ${INSTALL}\nINSTALL_DATA  = ${INSTALL} -m 644\n#bash completion scripts get sourced and so they should be rw only.\nINSTALL_SCRIPT = ${INSTALL} -m 644\n\n# If you are running a cross compiler, you may want to set this\n# to something more interesting, like \"arm-linux-\".  If you want\n# to compile vs uClibc, that can be done here as well.\nCROSS = #/usr/i386-linux-uclibc/usr/bin/i386-uclibc-\nCC = $(CROSS)gcc\nLD = $(CROSS)gcc\nAR = $(CROSS)ar\nSTRIP = $(CROSS)strip\nRANLIB = $(CROSS)ranlib\nHOSTCC = gcc\nMKDIR = mkdir\n\n# 64bit library detection\ninclude ../../scripts/Makefile.arch\n\nifeq ($(IS_64_BIT), 1)\nlibdir ?=\t/usr/lib64\nelse\nlibdir ?=\t/usr/lib\nendif\n\n# Now we set up the build system\n#\n\nGMO_FILES = ${shell for HLANG in ${LANGUAGES}; do echo $(OUTPUT)po/$$HLANG.gmo; done;}\n\nexport CROSS CC AR STRIP RANLIB CFLAGS LDFLAGS LIB_OBJS\n\n# check if compiler option is supported\ncc-supports = ${shell if $(CC) ${1} -S -o /dev/null -x c /dev/null > /dev/null 2>&1; then echo \"$(1)\"; fi;}\n\n# use '-Os' optimization if available, else use -O2\nOPTIMIZATION := $(call cc-supports,-Os,-O2)\n\nWARNINGS := -Wall -Wchar-subscripts -Wpointer-arith -Wsign-compare\nWARNINGS += $(call cc-supports,-Wno-pointer-sign)\nWARNINGS += $(call cc-supports,-Wdeclaration-after-statement)\nWARNINGS += -Wshadow\n\noverride CFLAGS += -DVERSION=\\\"$(VERSION)\\\" -DPACKAGE=\\\"$(PACKAGE)\\\" \\\n\t\t-DPACKAGE_BUGREPORT=\\\"$(PACKAGE_BUGREPORT)\\\" -D_GNU_SOURCE\n\nUTIL_OBJS =  utils/helpers/amd.o utils/helpers/msr.o \\\n\tutils/helpers/sysfs.o utils/helpers/misc.o utils/helpers/cpuid.o \\\n\tutils/helpers/pci.o utils/helpers/bitmask.o \\\n\tutils/idle_monitor/nhm_idle.o utils/idle_monitor/snb_idle.o \\\n\tutils/idle_monitor/hsw_ext_idle.o \\\n\tutils/idle_monitor/amd_fam14h_idle.o utils/idle_monitor/cpuidle_sysfs.o \\\n\tutils/idle_monitor/mperf_monitor.o utils/idle_monitor/cpupower-monitor.o \\\n\tutils/idle_monitor/rapl_monitor.o \\\n\tutils/cpupower.o utils/cpufreq-info.o utils/cpufreq-set.o \\\n\tutils/cpupower-set.o utils/cpupower-info.o utils/cpuidle-info.o \\\n\tutils/cpuidle-set.o utils/powercap-info.o\n\nUTIL_SRC := $(UTIL_OBJS:.o=.c)\n\nUTIL_OBJS := $(addprefix $(OUTPUT),$(UTIL_OBJS))\n\nUTIL_HEADERS = utils/helpers/helpers.h utils/idle_monitor/cpupower-monitor.h \\\n\tutils/helpers/bitmask.h \\\n\tutils/idle_monitor/idle_monitors.h utils/idle_monitor/idle_monitors.def\n\nLIB_HEADERS = \tlib/cpufreq.h lib/cpupower.h lib/cpuidle.h lib/acpi_cppc.h \\\n\tlib/powercap.h\nLIB_SRC = \tlib/cpufreq.c lib/cpupower.c lib/cpuidle.c lib/acpi_cppc.c \\\n\tlib/powercap.c\nLIB_OBJS = \tlib/cpufreq.o lib/cpupower.o lib/cpuidle.o lib/acpi_cppc.o \\\n\tlib/powercap.o\nLIB_OBJS :=\t$(addprefix $(OUTPUT),$(LIB_OBJS))\n\noverride CFLAGS +=\t-pipe\n\nifeq ($(strip $(NLS)),true)\n\tINSTALL_NLS += install-gmo\n\tCOMPILE_NLS += create-gmo\n\toverride CFLAGS += -DNLS\nendif\n\nifeq ($(strip $(CPUFREQ_BENCH)),true)\n\tINSTALL_BENCH += install-bench\n\tCOMPILE_BENCH += compile-bench\nendif\n\nifeq ($(strip $(STATIC)),true)\n        UTIL_OBJS += $(LIB_OBJS)\n        UTIL_HEADERS += $(LIB_HEADERS)\n        UTIL_SRC += $(LIB_SRC)\nendif\n\noverride CFLAGS += $(WARNINGS)\n\nifeq ($(strip $(V)),false)\n\tQUIET=@\n\tECHO=@echo\nelse\n\tQUIET=\n\tECHO=@\\#\nendif\nexport QUIET ECHO\n\n# if DEBUG is enabled, then we do not strip or optimize\nifeq ($(strip $(DEBUG)),true)\n\toverride CFLAGS += -O1 -g -DDEBUG\n\tSTRIPCMD = /bin/true -Since_we_are_debugging\nelse\n\toverride CFLAGS += $(OPTIMIZATION) -fomit-frame-pointer\n\tSTRIPCMD = $(STRIP) -s --remove-section=.note --remove-section=.comment\nendif\n\n\n# the actual make rules\n\nall: libcpupower $(OUTPUT)cpupower $(COMPILE_NLS) $(COMPILE_BENCH)\n\n$(OUTPUT)lib/%.o: $(LIB_SRC) $(LIB_HEADERS)\n\t$(ECHO) \"  CC      \" $@\n\t$(QUIET) $(CC) $(CFLAGS) -fPIC -o $@ -c lib/$*.c\n\n$(OUTPUT)libcpupower.so.$(LIB_MAJ): $(LIB_OBJS)\n\t$(ECHO) \"  LD      \" $@\n\t$(QUIET) $(CC) -shared $(CFLAGS) $(LDFLAGS) -o $@ \\\n\t\t-Wl,-soname,libcpupower.so.$(LIB_MIN) $(LIB_OBJS)\n\t@ln -sf $(@F) $(OUTPUT)libcpupower.so\n\t@ln -sf $(@F) $(OUTPUT)libcpupower.so.$(LIB_MIN)\n\nlibcpupower: $(OUTPUT)libcpupower.so.$(LIB_MAJ)\n\n# Let all .o files depend on its .c file and all headers\n# Might be worth to put this into utils/Makefile at some point of time\n$(UTIL_OBJS): $(UTIL_HEADERS)\n\n$(OUTPUT)%.o: %.c\n\t$(ECHO) \"  CC      \" $@\n\t$(QUIET) $(CC) $(CFLAGS) -I./lib -I ./utils -o $@ -c $*.c\n\n$(OUTPUT)cpupower: $(UTIL_OBJS) $(OUTPUT)libcpupower.so.$(LIB_MAJ)\n\t$(ECHO) \"  CC      \" $@\nifeq ($(strip $(STATIC)),true)\n\t$(QUIET) $(CC) $(CFLAGS) $(LDFLAGS) $(UTIL_OBJS) -lrt -lpci -L$(OUTPUT) -o $@\nelse\n\t$(QUIET) $(CC) $(CFLAGS) $(LDFLAGS) $(UTIL_OBJS) -lcpupower -lrt -lpci -L$(OUTPUT) -o $@\nendif\n\t$(QUIET) $(STRIPCMD) $@\n\n$(OUTPUT)po/$(PACKAGE).pot: $(UTIL_SRC)\n\t$(ECHO) \"  GETTEXT \" $@\n\t$(QUIET) xgettext --default-domain=$(PACKAGE) --add-comments \\\n\t\t--keyword=_ --keyword=N_ $(UTIL_SRC) -p $(@D) -o $(@F)\n\n$(OUTPUT)po/%.gmo: po/%.po\n\t$(ECHO) \"  MSGFMT  \" $@\n\t$(QUIET) msgfmt -o $@ po/$*.po\n\ncreate-gmo: ${GMO_FILES}\n\nupdate-po: $(OUTPUT)po/$(PACKAGE).pot\n\t$(ECHO) \"  MSGMRG  \" $@\n\t$(QUIET) @for HLANG in $(LANGUAGES); do \\\n\t\techo -n \"Updating $$HLANG \"; \\\n\t\tif msgmerge po/$$HLANG.po $< -o \\\n\t\t   $(OUTPUT)po/$$HLANG.new.po; then \\\n\t\t\tmv -f $(OUTPUT)po/$$HLANG.new.po $(OUTPUT)po/$$HLANG.po; \\\n\t\telse \\\n\t\t\techo \"msgmerge for $$HLANG failed!\"; \\\n\t\t\trm -f $(OUTPUT)po/$$HLANG.new.po; \\\n\t\tfi; \\\n\tdone;\n\ncompile-bench: $(OUTPUT)libcpupower.so.$(LIB_MAJ)\n\t@V=$(V) confdir=$(confdir) $(MAKE) -C bench O=$(OUTPUT)\n\n# we compile into subdirectories. if the target directory is not the\n# source directory, they might not exists. So we depend the various\n# files onto their directories.\nDIRECTORY_DEPS = $(LIB_OBJS) $(UTIL_OBJS) $(GMO_FILES)\n$(DIRECTORY_DEPS): | $(sort $(dir $(DIRECTORY_DEPS)))\n\n# In the second step, we make a rule to actually create these directories\n$(sort $(dir $(DIRECTORY_DEPS))):\n\t$(ECHO) \"  MKDIR      \" $@\n\t$(QUIET) $(MKDIR) -p $@ 2>/dev/null\n\nclean:\n\t-find $(OUTPUT) \\( -not -type d \\) -and \\( -name '*~' -o -name '*.[oas]' \\) -type f -print \\\n\t | xargs rm -f\n\t-rm -f $(OUTPUT)cpupower\n\t-rm -f $(OUTPUT)libcpupower.so*\n\t-rm -rf $(OUTPUT)po/*.gmo\n\t-rm -rf $(OUTPUT)po/*.pot\n\t$(MAKE) -C bench O=$(OUTPUT) clean\n\n\ninstall-lib: libcpupower\n\t$(INSTALL) -d $(DESTDIR)${libdir}\n\t$(CP) $(OUTPUT)libcpupower.so* $(DESTDIR)${libdir}/\n\t$(INSTALL) -d $(DESTDIR)${includedir}\n\t$(INSTALL_DATA) lib/cpufreq.h $(DESTDIR)${includedir}/cpufreq.h\n\t$(INSTALL_DATA) lib/cpuidle.h $(DESTDIR)${includedir}/cpuidle.h\n\t$(INSTALL_DATA) lib/powercap.h $(DESTDIR)${includedir}/powercap.h\n\ninstall-tools: $(OUTPUT)cpupower\n\t$(INSTALL) -d $(DESTDIR)${bindir}\n\t$(INSTALL_PROGRAM) $(OUTPUT)cpupower $(DESTDIR)${bindir}\n\t$(INSTALL) -d $(DESTDIR)${bash_completion_dir}\n\t$(INSTALL_SCRIPT) cpupower-completion.sh '$(DESTDIR)${bash_completion_dir}/cpupower'\n\ninstall-man:\n\t$(INSTALL_DATA) -D man/cpupower.1 $(DESTDIR)${mandir}/man1/cpupower.1\n\t$(INSTALL_DATA) -D man/cpupower-frequency-set.1 $(DESTDIR)${mandir}/man1/cpupower-frequency-set.1\n\t$(INSTALL_DATA) -D man/cpupower-frequency-info.1 $(DESTDIR)${mandir}/man1/cpupower-frequency-info.1\n\t$(INSTALL_DATA) -D man/cpupower-idle-set.1 $(DESTDIR)${mandir}/man1/cpupower-idle-set.1\n\t$(INSTALL_DATA) -D man/cpupower-idle-info.1 $(DESTDIR)${mandir}/man1/cpupower-idle-info.1\n\t$(INSTALL_DATA) -D man/cpupower-set.1 $(DESTDIR)${mandir}/man1/cpupower-set.1\n\t$(INSTALL_DATA) -D man/cpupower-info.1 $(DESTDIR)${mandir}/man1/cpupower-info.1\n\t$(INSTALL_DATA) -D man/cpupower-monitor.1 $(DESTDIR)${mandir}/man1/cpupower-monitor.1\n\t$(INSTALL_DATA) -D man/cpupower-powercap-info.1 $(DESTDIR)${mandir}/man1/cpupower-powercap-info.1\n\ninstall-gmo: create-gmo\n\t$(INSTALL) -d $(DESTDIR)${localedir}\n\tfor HLANG in $(LANGUAGES); do \\\n\t\techo '$(INSTALL_DATA) -D $(OUTPUT)po/$$HLANG.gmo $(DESTDIR)${localedir}/$$HLANG/LC_MESSAGES/cpupower.mo'; \\\n\t\t$(INSTALL_DATA) -D $(OUTPUT)po/$$HLANG.gmo $(DESTDIR)${localedir}/$$HLANG/LC_MESSAGES/cpupower.mo; \\\n\tdone;\n\ninstall-bench: compile-bench\n\t@#DESTDIR must be set from outside to survive\n\t@sbindir=$(sbindir) bindir=$(bindir) docdir=$(docdir) confdir=$(confdir) $(MAKE) -C bench O=$(OUTPUT) install\n\nifeq ($(strip $(STATIC)),true)\ninstall: all install-tools install-man $(INSTALL_NLS) $(INSTALL_BENCH)\nelse\ninstall: all install-lib install-tools install-man $(INSTALL_NLS) $(INSTALL_BENCH)\nendif\n\nuninstall:\n\t- rm -f $(DESTDIR)${libdir}/libcpupower.*\n\t- rm -f $(DESTDIR)${includedir}/cpufreq.h\n\t- rm -f $(DESTDIR)${includedir}/cpuidle.h\n\t- rm -f $(DESTDIR)${bindir}/utils/cpupower\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-frequency-set.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-frequency-info.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-set.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-info.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-monitor.1\n\t- rm -f $(DESTDIR)${mandir}/man1/cpupower-powercap-info.1\n\t- for HLANG in $(LANGUAGES); do \\\n\t\trm -f $(DESTDIR)${localedir}/$$HLANG/LC_MESSAGES/cpupower.mo; \\\n\t  done;\n\n.PHONY: all utils libcpupower update-po create-gmo install-lib install-tools install-man install-gmo install uninstall clean\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}