{
  "module_name": "sleepgraph.8",
  "hash_id": "87e348ebd95cb8815b480dd63258894006d733c9bfa901a0c5dab65a678858e2",
  "original_prompt": "Ingested from linux-6.6.14/tools/power/pm-graph/sleepgraph.8",
  "human_readable_source": ".TH SLEEPGRAPH 8\n.SH NAME\nsleepgraph \\- Suspend/Resume timing analysis\n.SH SYNOPSIS\n.ft B\n.B sleepgraph\n.RB [ OPTIONS ]\n.RB [ COMMAND ]\n.SH DESCRIPTION\n\\fBsleepgraph \\fP is designed to assist kernel and OS developers\nin optimizing their linux stack's suspend/resume time. Using a kernel\nimage built with a few extra options enabled, the tool will execute a\nsuspend and capture dmesg and ftrace data until resume is complete.\nThis data is transformed into a device timeline and an optional\ncallgraph to give a detailed view of which devices/subsystems are\ntaking the most time in suspend/resume.\n.PP\nIf no specific command is given, the default behavior is to initiate\na suspend/resume.\n.PP\nGenerates output files in subdirectory: suspend-yymmdd-HHMMSS\n   html timeline   :     <hostname>_<mode>.html\n   raw dmesg file  :     <hostname>_<mode>_dmesg.txt\n   raw ftrace file :     <hostname>_<mode>_ftrace.txt\n.SH OPTIONS\n.TP\n\\fB-h\\fR\nPrint the help text.\n.TP\n\\fB-v\\fR\nPrint the current tool version.\n.TP\n\\fB-verbose\\fR\nPrint extra information during execution and analysis.\n.TP\n\\fB-config \\fIfile\\fR\nPull arguments and config options from a file.\n.TP\n\\fB-m \\fImode\\fR\nMode to initiate for suspend e.g. standby, freeze, mem (default: mem).\n.TP\n\\fB-o \\fIname\\fR\nOverrides the output subdirectory name when running a new test.\nUse {date}, {time}, {hostname} for current values.\n.sp\ne.g. suspend-{hostname}-{date}-{time}\n.TP\n\\fB-rtcwake \\fIt\\fR | off\nUse rtcwake to autoresume after \\fIt\\fR seconds (default: 15). Set t to \"off\" to\ndisable rtcwake and require a user keypress to resume.\n.TP\n\\fB-addlogs\\fR\nAdd the dmesg and ftrace logs to the html output. They will be viewable by\nclicking buttons in the timeline.\n.TP\n\\fB-noturbostat\\fR\nBy default, if turbostat is found and the requested mode is freeze, sleepgraph\nwill execute the suspend via turbostat and collect data in the timeline log.\nThis option disables the use of turbostat.\n.TP\n\\fB-result \\fIfile\\fR\nExport a results table to a text file for parsing.\n.TP\n\\fB-sync\\fR\nSync the filesystems before starting the test. This reduces the size of\nthe sys_sync call which happens in the suspend_prepare phase.\n.TP\n\\fB-rs \\fIenable/disable\\fR\nDuring test, enable/disable runtime suspend for all devices. The test is delayed\nby 5 seconds to allow runtime suspend changes to occur. The settings are restored\nafter the test is complete.\n.TP\n\\fB-display \\fIon/off/standby/suspend\\fR\nSwitch the display to the requested mode for the test using the xset command.\nThis helps maintain the consistency of test data for better comparison.\n.TP\n\\fB-wifi\\fR\nIf a wifi connection is available, check that it reconnects after resume. Include\nthe reconnect time in the total resume time calculation and treat wifi timeouts\nas resume failures.\n.TP\n\\fB-wifitrace\\fR\nTrace through the wifi reconnect time and include it in the timeline.\n\n.SS \"advanced\"\n.TP\n\\fB-gzip\\fR\nGzip the trace and dmesg logs to save space. The tool can also read in gzipped\nlogs for processing.\n.TP\n\\fB-cmd \\fIstr\\fR\nRun the timeline over a custom suspend command, e.g. pm-suspend. By default\nthe tool forces suspend via /sys/power/state so this allows testing over\nan OS's official suspend method. The output file will change to\nhostname_command.html and will autodetect which suspend mode was triggered.\n.TP\n\\fB-filter \\fI\"d1,d2,...\"\\fR\nFilter out all but these device callbacks. These strings can be device names\nor module names. e.g. 0000:00:02.0, ata5, i915, usb, etc.\n.TP\n\\fB-mindev \\fIt\\fR\nDiscard all device callbacks shorter than \\fIt\\fR milliseconds (default: 0.0).\nThis reduces the html file size as there can be many tiny callbacks which are barely\nvisible. The value is a float: e.g. 0.001 represents 1 us.\n.TP\n\\fB-proc\\fR\nAdd usermode process info into the timeline (default: disabled).\n.TP\n\\fB-dev\\fR\nAdd kernel source calls and threads to the timeline (default: disabled).\n.TP\n\\fB-x2\\fR\nRun two suspend/resumes back to back (default: disabled).\n.TP\n\\fB-x2delay \\fIt\\fR\nInclude \\fIt\\fR ms delay between multiple test runs (default: 0 ms).\n.TP\n\\fB-predelay \\fIt\\fR\nInclude \\fIt\\fR ms delay before 1st suspend (default: 0 ms).\n.TP\n\\fB-postdelay \\fIt\\fR\nInclude \\fIt\\fR ms delay after last resume (default: 0 ms).\n.TP\n\\fB-multi \\fIn d\\fR\nUsed for endurance testing. If \\fIn\\fR is entirely numeric, it's treated as a count:\nExecute \\fIn\\fR consecutive tests at \\fId\\fR second intervals.\nIf \\fIn\\fR is an integer followed by a \"d\", \"h\", or \"m\", it's treated as a duration:\nExecute tests continuously over \\fIn\\fR days, hours, or minutes at \\fId\\fR second intervals.\nThe outputs will be created in a new subdirectory, for count: suspend-{date}-{time}-xN,\nfor duration: suspend-{date}-{time}-Nm. When the multitest run is done, the \\fI-summary\\fR\ncommand is called automatically to create summary html files for all the data (unless you\nuse \\fI-skiphtml\\fR). \\fI-skiphtml\\fR will speed up the testing by not creating timelines\nor summary html files. You can then run the tool again at a later time with \\fI-summary\\fR\nand \\fI-genhtml\\fR to create the timelines.\n.TP\n\\fB-maxfail \\fIn\\fR\nAbort a -multi run after \\fIn\\fR consecutive fails. 0 means never abort (default = 0).\n.TP\n\\fB-skiphtml\\fR\nRun the test and capture the trace logs, but skip the timeline generation.\nYou can generate the html timelines later with \\fI-dmesg\\fR & \\fI-ftrace\\fR, or\nby running \\fI-summary\\fR and \\fI-genhtml\\fR.\n\n.SS \"ftrace debug\"\n.TP\n\\fB-f\\fR\nUse ftrace to create device callgraphs (default: disabled). This can produce\nvery large outputs, i.e. 10MB - 100MB.\n.TP\n\\fB-ftop\\fR\nUse ftrace on the top level call: \"suspend_devices_and_enter\" only (default: disabled).\nThis option implies -f and creates a single callgraph covering all of suspend/resume.\n.TP\n\\fB-maxdepth \\fIlevel\\fR\nlimit the callgraph trace depth to \\fIlevel\\fR (default: 0=all). This is\nthe best way to limit the output size when using callgraphs via -f.\n.TP\n\\fB-expandcg\\fR\npre-expand the callgraph data in the html output (default: disabled)\n.TP\n\\fB-fadd \\fIfile\\fR\nAdd functions to be graphed in the timeline from a list in a text file\n.TP\n\\fB-mincg \\fIt\\fR\nDiscard all callgraphs shorter than \\fIt\\fR milliseconds (default: 0.0).\nThis reduces the html file size as there can be many tiny callgraphs\nwhich are barely visible in the timeline.\nThe value is a float: e.g. 0.001 represents 1 us.\n.TP\n\\fB-cgfilter \\fI\"func1,func2,...\"\\fR\nReduce callgraph output in the timeline by limiting it certain devices. The\nargument can be a single device name or a comma delimited list.\n(default: none)\n.TP\n\\fB-cgskip \\fIfile\\fR\nReduce callgraph timeline size by skipping over uninteresting functions\nin the trace, e.g. printk or console_unlock. The functions listed\nin this file will show up as empty leaves in the callgraph with only the start/end\ntimes displayed. cgskip.txt is used automatically if found in the path, so\nuse \"off\" to disable completely (default: cgskip.txt)\n.TP\n\\fB-cgphase \\fIp\\fR\nOnly show callgraph data for phase \\fIp\\fR (e.g. suspend_late).\n.TP\n\\fB-cgtest \\fIn\\fR\nIn an x2 run, only show callgraph data for test \\fIn\\fR (e.g. 0 or 1).\n.TP\n\\fB-timeprec \\fIn\\fR\nNumber of significant digits in timestamps (0:S, [3:ms], 6:us).\n.TP\n\\fB-bufsize \\fIN\\fR\nSet trace buffer size to N kilo-bytes (default: all of free memory up to 3GB)\n\n.SH COMMANDS\n.TP\n\\fB-summary \\fIindir\\fR\nCreate a set of summary pages for all tests in \\fIindir\\fR recursively.\nCreates summary.html, summary-issues.html, and summary-devices.html in the current folder.\nsummary.html is a table of tests with relevant info sorted by kernel/host/mode,\nand links to the test html files. It identifies the minimum, maximum, and median\nsuspend and resume times for you with highlights and links in the header.\nsummary-issues.html is a list of kernel issues found in dmesg from all the tests.\nsummary-devices.html is a list of devices and times from all the tests.\n\nUse \\fI-genhtml\\fR to regenerate any tests with missing html.\n.TP\n\\fB-genhtml\\fR\nUsed with \\fI-summary\\fR to regenerate any missing html timelines from their\ndmesg and ftrace logs. This will require a significant amount of time if there\nare thousands of tests.\n.TP\n\\fB-modes\\fR\nList available suspend modes.\n.TP\n\\fB-status\\fR\nTest to see if the system is able to run this tool. Use this along\nwith any options you intend to use to see if they will work.\n.TP\n\\fB-fpdt\\fR\nPrint out the contents of the ACPI Firmware Performance Data Table.\n.TP\n\\fB-wificheck\\fR\nPrint out wifi status and connection details.\n.TP\n\\fB-xon/-xoff/-xstandby/-xsuspend\\fR\nTest xset by attempting to switch the display to the given mode. This\nis the same command which will be issued by \\fB-display \\fImode\\fR.\n.TP\n\\fB-xstat\\fR\nGet the current DPMS display mode.\n.TP\n\\fB-sysinfo\\fR\nPrint out system info extracted from BIOS. Reads /dev/mem directly instead of going through dmidecode.\n.TP\n\\fB-devinfo\\fR\nPrint out the pm settings of all devices which support runtime suspend.\n.TP\n\\fB-cmdinfo\\fR\nPrint out all the platform data collected from the system that makes it into the logs.\n.TP\n\\fB-flist\\fR\nPrint the list of ftrace functions currently being captured. Functions\nthat are not available as symbols in the current kernel are shown in red.\nBy default, the tool traces a list of important suspend/resume functions\nin order to better fill out the timeline. If the user has added their own\nwith -fadd they will also be checked.\n.TP\n\\fB-flistall\\fR\nPrint all ftrace functions capable of being captured. These are all the\npossible values you can add to trace via the -fadd argument.\n.SS \"rebuild\"\n.TP\n\\fB-ftrace \\fIfile\\fR\nCreate HTML output from an existing ftrace file.\n.TP\n\\fB-dmesg \\fIfile\\fR\nCreate HTML output from an existing dmesg file.\n\n.SH EXAMPLES\n.SS \"simple commands\"\nCheck which suspend modes are currently supported.\n.IP\n\\f(CW$ sleepgraph -modes\\fR\n.PP\nRead the Firmware Performance Data Table (FPDT)\n.IP\n\\f(CW$ sudo sleepgraph -fpdt\\fR\n.PP\nPrint out the current USB power topology\n.IP\n\\f(CW$ sleepgraph -usbtopo\n.PP\nVerify that you can run a command with a set of arguments\n.IP\n\\f(CW$ sudo sleepgraph -f -rtcwake 30 -status\n.PP\nGenerate a summary of all timelines in a particular folder.\n.IP\n\\f(CW$ sleepgraph -summary ~/workspace/myresults/\\fR\n.PP\n\n.SS \"capturing basic timelines\"\nExecute a mem suspend with a 15 second wakeup. Include the logs in the html.\n.IP\n\\f(CW$ sudo sleepgraph -rtcwake 15 -addlogs\\fR\n.PP\nExecute a standby with a 15 second wakeup. Change the output folder name.\n.IP\n\\f(CW$ sudo sleepgraph -m standby -rtcwake 15 -o \"standby-{host}-{date}-{time}\"\\fR\n.PP\nExecute a freeze with no wakeup (require keypress). Change output folder name.\n.IP\n\\f(CW$ sudo sleepgraph -m freeze -rtcwake off -o \"freeze-{hostname}-{date}-{time}\"\\fR\n.PP\n\n.SS \"capturing advanced timelines\"\nExecute a suspend & include dev mode source calls, limit callbacks to 5ms or larger.\n.IP\n\\f(CW$ sudo sleepgraph -m mem -rtcwake 15 -dev -mindev 5\\fR\n.PP\nRun two suspends back to back, include a 500ms delay before, after, and in between runs.\n.IP\n\\f(CW$ sudo sleepgraph -m mem -rtcwake 15 -x2 -predelay 500 -x2delay 500 -postdelay 500\\fR\n.PP\nExecute a suspend using a custom command.\n.IP\n\\f(CW$ sudo sleepgraph -cmd \"echo mem > /sys/power/state\" -rtcwake 15\\fR\n.PP\n\n.SS \"endurance testing using -multi\"\n.PP\nDo a batch run of 10 freezes with 30 seconds delay between runs.\n.IP\n\\f(CW$ sudo sleepgraph -m freeze -rtcwake 15 -multi 10 30\\fR\n.PP\nDo a batch run of freezes for 24 hours.\n.IP\n\\f(CW$ sudo sleepgraph -m freeze -rtcwake 15 -multi 24h 0\\fR\n\n.SS \"adding callgraph data\"\nAdd device callgraphs. Limit the trace depth and only show callgraphs 10ms or larger.\n.IP\n\\f(CW$ sudo sleepgraph -m mem -rtcwake 15 -f -maxdepth 5 -mincg 10\\fR\n.PP\nCapture a full callgraph across all suspend, then filter the html by a single phase.\n.IP\n\\f(CW$ sudo sleepgraph -m mem -rtcwake 15 -f\\fR\n.IP\n\\f(CW$ sleepgraph -dmesg host_mem_dmesg.txt -ftrace host_mem_ftrace.txt -f -cgphase resume\n.PP\n\n.SS \"rebuild timeline from logs\"\n.PP\nRebuild the html from a previous run's logs, using the same options.\n.IP\n\\f(CW$ sleepgraph -dmesg dmesg.txt -ftrace ftrace.txt -callgraph\\fR\n.PP\nRebuild the html with different options.\n.IP\n\\f(CW$ sleepgraph -dmesg dmesg.txt -ftrace ftrace.txt -addlogs -srgap\\fR\n\n.SH \"SEE ALSO\"\ndmesg(1)\n.PP\n.SH AUTHOR\n.nf\nWritten by Todd Brandt <todd.e.brandt@linux.intel.com>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}