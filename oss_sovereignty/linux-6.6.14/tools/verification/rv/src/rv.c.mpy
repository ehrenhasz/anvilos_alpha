{
  "module_name": "rv.c",
  "hash_id": "ca39b2d251b7b003c1c58d4d80758949f8b18ab6752cf3196321d20115613ab6",
  "original_prompt": "Ingested from linux-6.6.14/tools/verification/rv/src/rv.c",
  "human_readable_source": "\n \n\n#include <stdlib.h>\n#include <signal.h>\n#include <unistd.h>\n\n#include <trace.h>\n#include <utils.h>\n#include <in_kernel.h>\n\nstatic int stop_session;\n\n \nstatic void stop_rv(int sig)\n{\n\tstop_session = 1;\n}\n\n \nint should_stop(void)\n{\n\treturn stop_session;\n}\n\n \nstatic void rv_list(int argc, char **argv)\n{\n\tstatic const char *const usage[] = {\n\t\t\"\",\n\t\t\"  usage: rv list [-h]\",\n\t\t\"\",\n\t\t\"\tlist all available monitors\",\n\t\t\"\",\n\t\t\"\t-h/--help: print this menu\",\n\t\tNULL,\n\t};\n\tint i;\n\n\tif (argc > 1) {\n\t\tfprintf(stderr, \"rv version %s\\n\", VERSION);\n\n\t\t \n\t\tfor (i = 0; usage[i]; i++)\n\t\t\tfprintf(stderr, \"%s\\n\", usage[i]);\n\n\t\t \n\t\tif (!strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\"))\n\t\t\texit(0);\n\t\telse\n\t\t\texit(1);\n\t}\n\n\tikm_list_monitors();\n\texit(0);\n}\n\n \nstatic void rv_mon(int argc, char **argv)\n{\n\tchar *monitor_name;\n\tint i, run = 0;\n\n\tstatic const char *const usage[] = {\n\t\t\"\",\n\t\t\"  usage: rv mon [-h] monitor [monitor options]\",\n\t\t\"\",\n\t\t\"\trun a monitor\",\n\t\t\"\",\n\t\t\"\t-h/--help: print this menu\",\n\t\t\"\",\n\t\t\"\tmonitor [monitor options]: the monitor, passing\",\n\t\t\"\tthe arguments to the [monitor options]\",\n\t\tNULL,\n\t};\n\n\t \n\tif (argc == 1) {\n\n\t\tfprintf(stderr, \"rv version %s\\n\", VERSION);\n\n\t\tfor (i = 0; usage[i]; i++)\n\t\t\tfprintf(stderr, \"%s\\n\", usage[i]);\n\t\texit(1);\n\t} else if (!strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n\n\t\tfprintf(stderr, \"rv version %s\\n\", VERSION);\n\n\t\tfor (i = 0; usage[i]; i++)\n\t\t\tfprintf(stderr, \"%s\\n\", usage[i]);\n\t\texit(0);\n\t}\n\n\tmonitor_name = argv[1];\n\t \n\trun += ikm_run_monitor(monitor_name, argc-1, &argv[1]);\n\n\tif (!run)\n\t\terr_msg(\"rv: monitor %s does not exist\\n\", monitor_name);\n\texit(!run);\n}\n\nstatic void usage(int exit_val, const char *fmt, ...)\n{\n\tchar message[1024];\n\tva_list ap;\n\tint i;\n\n\tstatic const char *const usage[] = {\n\t\t\"\",\n\t\t\"  usage: rv command [-h] [command_options]\",\n\t\t\"\",\n\t\t\"\t-h/--help: print this menu\",\n\t\t\"\",\n\t\t\"\tcommand: run one of the following command:\",\n\t\t\"\t  list: list all available monitors\",\n\t\t\"\t  mon:  run a monitor\",\n\t\t\"\",\n\t\t\"\t[command options]: each command has its own set of options\",\n\t\t\"\t\t           run rv command -h for further information\",\n\t\tNULL,\n\t};\n\n\tva_start(ap, fmt);\n\tvsnprintf(message, sizeof(message), fmt, ap);\n\tva_end(ap);\n\n\tfprintf(stderr, \"rv version %s: %s\\n\", VERSION, message);\n\n\tfor (i = 0; usage[i]; i++)\n\t\tfprintf(stderr, \"%s\\n\", usage[i]);\n\n\texit(exit_val);\n}\n\n \nint main(int argc, char **argv)\n{\n\tif (geteuid())\n\t\tusage(1, \"%s needs root permission\", argv[0]);\n\n\tif (argc <= 1)\n\t\tusage(1, \"%s requires a command\", argv[0]);\n\n\tif (!strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\"))\n\t\tusage(0, \"help\");\n\n\tif (!strcmp(argv[1], \"list\"))\n\t\trv_list(--argc, &argv[1]);\n\n\tif (!strcmp(argv[1], \"mon\")) {\n\t\t \n\t\tsignal(SIGINT, stop_rv);\n\n\t\trv_mon(argc - 1, &argv[1]);\n\t}\n\n\t \n\tusage(1, \"%s does not know the %s command, old version?\", argv[0], argv[1]);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}