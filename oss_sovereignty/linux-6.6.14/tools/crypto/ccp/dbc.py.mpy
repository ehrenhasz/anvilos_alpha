{
  "module_name": "dbc.py",
  "hash_id": "f9b75f940a299876e5d9a73107b073c70d5ec03ab6982c3a296104a298438dec",
  "original_prompt": "Ingested from linux-6.6.14/tools/crypto/ccp/dbc.py",
  "human_readable_source": "#!/usr/bin/python3\n# SPDX-License-Identifier: GPL-2.0\n\nimport ctypes\nimport os\n\nDBC_UID_SIZE = 16\nDBC_NONCE_SIZE = 16\nDBC_SIG_SIZE = 32\n\nPARAM_GET_FMAX_CAP = (0x3,)\nPARAM_SET_FMAX_CAP = (0x4,)\nPARAM_GET_PWR_CAP = (0x5,)\nPARAM_SET_PWR_CAP = (0x6,)\nPARAM_GET_GFX_MODE = (0x7,)\nPARAM_SET_GFX_MODE = (0x8,)\nPARAM_GET_CURR_TEMP = (0x9,)\nPARAM_GET_FMAX_MAX = (0xA,)\nPARAM_GET_FMAX_MIN = (0xB,)\nPARAM_GET_SOC_PWR_MAX = (0xC,)\nPARAM_GET_SOC_PWR_MIN = (0xD,)\nPARAM_GET_SOC_PWR_CUR = (0xE,)\n\nDEVICE_NODE = \"/dev/dbc\"\n\nlib = ctypes.CDLL(\"./dbc_library.so\", mode=ctypes.RTLD_GLOBAL)\n\n\ndef handle_error(code):\n    raise OSError(code, os.strerror(code))\n\n\ndef get_nonce(device, signature):\n    if not device:\n        raise ValueError(\"Device required\")\n    buf = ctypes.create_string_buffer(DBC_NONCE_SIZE)\n    ret = lib.get_nonce(device.fileno(), ctypes.byref(buf), signature)\n    if ret:\n        handle_error(ret)\n    return buf.value\n\n\ndef set_uid(device, new_uid, signature):\n    if not signature:\n        raise ValueError(\"Signature required\")\n    if not new_uid:\n        raise ValueError(\"UID required\")\n    ret = lib.set_uid(device.fileno(), new_uid, signature)\n    if ret:\n        handle_error(ret)\n    return True\n\n\ndef process_param(device, message, signature, data=None):\n    if not signature:\n        raise ValueError(\"Signature required\")\n    if type(message) != tuple:\n        raise ValueError(\"Expected message tuple\")\n    arg = ctypes.c_int(data if data else 0)\n    sig = ctypes.create_string_buffer(signature, len(signature))\n    ret = lib.process_param(device.fileno(), message[0], ctypes.pointer(sig), ctypes.pointer(arg))\n    if ret:\n        handle_error(ret)\n    return arg.value, sig.value\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}