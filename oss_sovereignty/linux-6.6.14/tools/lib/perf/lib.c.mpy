{
  "module_name": "lib.c",
  "hash_id": "f63e79ff3e4491f55c5058ad57d3d34b454c1b512c3a730d8c0b0e5bdb3f4333",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/perf/lib.c",
  "human_readable_source": "\n#include <unistd.h>\n#include <stdbool.h>\n#include <errno.h>\n#include <linux/kernel.h>\n#include <internal/lib.h>\n\nunsigned int page_size;\n\nstatic ssize_t ion(bool is_read, int fd, void *buf, size_t n)\n{\n\tvoid *buf_start = buf;\n\tsize_t left = n;\n\n\twhile (left) {\n\t\t \n\t\tssize_t ret = is_read ? read(fd, buf, left) :\n\t\t\t\t\twrite(fd, buf, left);\n\n\t\tif (ret < 0 && errno == EINTR)\n\t\t\tcontinue;\n\t\tif (ret <= 0)\n\t\t\treturn ret;\n\n\t\tleft -= ret;\n\t\tbuf  += ret;\n\t}\n\n\tBUG_ON((size_t)(buf - buf_start) != n);\n\treturn n;\n}\n\n \nssize_t readn(int fd, void *buf, size_t n)\n{\n\treturn ion(true, fd, buf, n);\n}\n\nssize_t preadn(int fd, void *buf, size_t n, off_t offs)\n{\n\tsize_t left = n;\n\n\twhile (left) {\n\t\tssize_t ret = pread(fd, buf, left, offs);\n\n\t\tif (ret < 0 && errno == EINTR)\n\t\t\tcontinue;\n\t\tif (ret <= 0)\n\t\t\treturn ret;\n\n\t\tleft -= ret;\n\t\tbuf  += ret;\n\t\toffs += ret;\n\t}\n\n\treturn n;\n}\n\n \nssize_t writen(int fd, const void *buf, size_t n)\n{\n\t \n\treturn ion(false, fd, (void *)buf, n);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}