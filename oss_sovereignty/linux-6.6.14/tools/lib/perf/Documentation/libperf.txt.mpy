{
  "module_name": "libperf.txt",
  "hash_id": "510a0686aac8f1f82ae11043dc8522ceb08c03c85f51cc473988e163201892e9",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/perf/Documentation/libperf.txt",
  "human_readable_source": "libperf(3)\n==========\n\nNAME\n----\nlibperf - Linux kernel perf event library\n\n\nSYNOPSIS\n--------\n*Generic API:*\n\n[source,c]\n--\n  #include <perf/core.h>\n\n  enum libperf_print_level {\n          LIBPERF_ERR,\n          LIBPERF_WARN,\n          LIBPERF_INFO,\n          LIBPERF_DEBUG,\n          LIBPERF_DEBUG2,\n          LIBPERF_DEBUG3,\n  };\n\n  typedef int (*libperf_print_fn_t)(enum libperf_print_level level,\n                                    const char *, va_list ap);\n\n  void libperf_init(libperf_print_fn_t fn);\n--\n\n*API to handle CPU maps:*\n\n[source,c]\n--\n  #include <perf/cpumap.h>\n\n  struct perf_cpu_map;\n\n  struct perf_cpu_map *perf_cpu_map__dummy_new(void);\n  struct perf_cpu_map *perf_cpu_map__new(const char *cpu_list);\n  struct perf_cpu_map *perf_cpu_map__read(FILE *file);\n  struct perf_cpu_map *perf_cpu_map__get(struct perf_cpu_map *map);\n  struct perf_cpu_map *perf_cpu_map__merge(struct perf_cpu_map *orig,\n                                           struct perf_cpu_map *other);\n  void perf_cpu_map__put(struct perf_cpu_map *map);\n  int perf_cpu_map__cpu(const struct perf_cpu_map *cpus, int idx);\n  int perf_cpu_map__nr(const struct perf_cpu_map *cpus);\n  bool perf_cpu_map__empty(const struct perf_cpu_map *map);\n  int perf_cpu_map__max(struct perf_cpu_map *map);\n  bool perf_cpu_map__has(const struct perf_cpu_map *map, int cpu);\n\n  #define perf_cpu_map__for_each_cpu(cpu, idx, cpus)\n--\n\n*API to handle thread maps:*\n\n[source,c]\n--\n  #include <perf/threadmap.h>\n\n  struct perf_thread_map;\n\n  struct perf_thread_map *perf_thread_map__new_dummy(void);\n  struct perf_thread_map *perf_thread_map__new_array(int nr_threads, pid_t *array);\n\n  void perf_thread_map__set_pid(struct perf_thread_map *map, int idx, pid_t pid);\n  char *perf_thread_map__comm(struct perf_thread_map *map, int idx);\n  int perf_thread_map__nr(struct perf_thread_map *threads);\n  pid_t perf_thread_map__pid(struct perf_thread_map *map, int idx);\n\n  struct perf_thread_map *perf_thread_map__get(struct perf_thread_map *map);\n  void perf_thread_map__put(struct perf_thread_map *map);\n--\n\n*API to handle event lists:*\n\n[source,c]\n--\n  #include <perf/evlist.h>\n\n  struct perf_evlist;\n\n  void perf_evlist__add(struct perf_evlist *evlist,\n                        struct perf_evsel *evsel);\n  void perf_evlist__remove(struct perf_evlist *evlist,\n                           struct perf_evsel *evsel);\n  struct perf_evlist *perf_evlist__new(void);\n  void perf_evlist__delete(struct perf_evlist *evlist);\n  struct perf_evsel* perf_evlist__next(struct perf_evlist *evlist,\n                                       struct perf_evsel *evsel);\n  int perf_evlist__open(struct perf_evlist *evlist);\n  void perf_evlist__close(struct perf_evlist *evlist);\n  void perf_evlist__enable(struct perf_evlist *evlist);\n  void perf_evlist__disable(struct perf_evlist *evlist);\n\n  #define perf_evlist__for_each_evsel(evlist, pos)\n\n  void perf_evlist__set_maps(struct perf_evlist *evlist,\n                             struct perf_cpu_map *cpus,\n                             struct perf_thread_map *threads);\n  int perf_evlist__poll(struct perf_evlist *evlist, int timeout);\n  int perf_evlist__filter_pollfd(struct perf_evlist *evlist,\n                                 short revents_and_mask);\n\n  int perf_evlist__mmap(struct perf_evlist *evlist, int pages);\n  void perf_evlist__munmap(struct perf_evlist *evlist);\n\n  struct perf_mmap *perf_evlist__next_mmap(struct perf_evlist *evlist,\n                                           struct perf_mmap *map,\n                                           bool overwrite);\n\n  #define perf_evlist__for_each_mmap(evlist, pos, overwrite)\n--\n\n*API to handle events:*\n\n[source,c]\n--\n  #include <perf/evsel.h>*\n\n  struct perf_evsel;\n\n  struct perf_counts_values {\n          union {\n                  struct {\n                          uint64_t val;\n                          uint64_t ena;\n                          uint64_t run;\n                  };\n                  uint64_t values[3];\n          };\n  };\n\n  struct perf_evsel *perf_evsel__new(struct perf_event_attr *attr);\n  void perf_evsel__delete(struct perf_evsel *evsel);\n  int perf_evsel__open(struct perf_evsel *evsel, struct perf_cpu_map *cpus,\n                       struct perf_thread_map *threads);\n  void perf_evsel__close(struct perf_evsel *evsel);\n  void perf_evsel__close_cpu(struct perf_evsel *evsel, int cpu_map_idx);\n  int perf_evsel__mmap(struct perf_evsel *evsel, int pages);\n  void perf_evsel__munmap(struct perf_evsel *evsel);\n  void *perf_evsel__mmap_base(struct perf_evsel *evsel, int cpu_map_idx, int thread);\n  int perf_evsel__read(struct perf_evsel *evsel, int cpu_map_idx, int thread,\n                       struct perf_counts_values *count);\n  int perf_evsel__enable(struct perf_evsel *evsel);\n  int perf_evsel__enable_cpu(struct perf_evsel *evsel, int cpu_map_idx);\n  int perf_evsel__disable(struct perf_evsel *evsel);\n  int perf_evsel__disable_cpu(struct perf_evsel *evsel, int cpu_map_idx);\n  struct perf_cpu_map *perf_evsel__cpus(struct perf_evsel *evsel);\n  struct perf_thread_map *perf_evsel__threads(struct perf_evsel *evsel);\n  struct perf_event_attr *perf_evsel__attr(struct perf_evsel *evsel);\n--\n\n*API to handle maps (perf ring buffers):*\n\n[source,c]\n--\n  #include <perf/mmap.h>\n\n  struct perf_mmap;\n\n  void perf_mmap__consume(struct perf_mmap *map);\n  int perf_mmap__read_init(struct perf_mmap *map);\n  void perf_mmap__read_done(struct perf_mmap *map);\n  union perf_event *perf_mmap__read_event(struct perf_mmap *map);\n--\n\n*Structures to access perf API events:*\n\n[source,c]\n--\n  #include <perf/event.h>\n\n  struct perf_record_mmap;\n  struct perf_record_mmap2;\n  struct perf_record_comm;\n  struct perf_record_namespaces;\n  struct perf_record_fork;\n  struct perf_record_lost;\n  struct perf_record_lost_samples;\n  struct perf_record_read;\n  struct perf_record_throttle;\n  struct perf_record_ksymbol;\n  struct perf_record_bpf_event;\n  struct perf_record_sample;\n  struct perf_record_switch;\n  struct perf_record_header_attr;\n  struct perf_record_record_cpu_map;\n  struct perf_record_cpu_map_data;\n  struct perf_record_cpu_map;\n  struct perf_record_event_update_cpus;\n  struct perf_record_event_update_scale;\n  struct perf_record_event_update;\n  struct perf_trace_event_type;\n  struct perf_record_header_event_type;\n  struct perf_record_header_tracing_data;\n  struct perf_record_header_build_id;\n  struct perf_record_id_index;\n  struct perf_record_auxtrace_info;\n  struct perf_record_auxtrace;\n  struct perf_record_auxtrace_error;\n  struct perf_record_aux;\n  struct perf_record_itrace_start;\n  struct perf_record_thread_map_entry;\n  struct perf_record_thread_map;\n  struct perf_record_stat_config_entry;\n  struct perf_record_stat_config;\n  struct perf_record_stat;\n  struct perf_record_stat_round;\n  struct perf_record_time_conv;\n  struct perf_record_header_feature;\n  struct perf_record_compressed;\n--\n\nDESCRIPTION\n-----------\nThe libperf library provides an API to access the linux kernel perf\nevents subsystem.\n\nFollowing objects are key to the libperf interface:\n\n[horizontal]\n\nstruct perf_cpu_map:: Provides a CPU list abstraction.\n\nstruct perf_thread_map:: Provides a thread list abstraction.\n\nstruct perf_evsel:: Provides an abstraction for single a perf event.\n\nstruct perf_evlist:: Gathers several struct perf_evsel object and performs functions on all of them.\n\nstruct perf_mmap:: Provides an abstraction for accessing perf ring buffer.\n\nThe exported API functions bind these objects together.\n\nREPORTING BUGS\n--------------\nReport bugs to <linux-perf-users@vger.kernel.org>.\n\nLICENSE\n-------\nlibperf is Free Software licensed under the GNU LGPL 2.1\n\nRESOURCES\n---------\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git\n\nSEE ALSO\n--------\nlibperf-sampling(7), libperf-counting(7)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}