{
  "module_name": "libbpf.h",
  "hash_id": "b1d72b1bfa405147de6d7c38725c7a33b682c901a0a3d9f2bf7a1effacdf7d70",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/bpf/libbpf.h",
  "human_readable_source": " \n\n \n#ifndef __LIBBPF_LIBBPF_H\n#define __LIBBPF_LIBBPF_H\n\n#include <stdarg.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <sys/types.h>  \n#include <linux/bpf.h>\n\n#include \"libbpf_common.h\"\n#include \"libbpf_legacy.h\"\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nLIBBPF_API __u32 libbpf_major_version(void);\nLIBBPF_API __u32 libbpf_minor_version(void);\nLIBBPF_API const char *libbpf_version_string(void);\n\nenum libbpf_errno {\n\t__LIBBPF_ERRNO__START = 4000,\n\n\t \n\tLIBBPF_ERRNO__LIBELF = __LIBBPF_ERRNO__START,\n\tLIBBPF_ERRNO__FORMAT,\t \n\tLIBBPF_ERRNO__KVERSION,\t \n\tLIBBPF_ERRNO__ENDIAN,\t \n\tLIBBPF_ERRNO__INTERNAL,\t \n\tLIBBPF_ERRNO__RELOC,\t \n\tLIBBPF_ERRNO__LOAD,\t \n\tLIBBPF_ERRNO__VERIFY,\t \n\tLIBBPF_ERRNO__PROG2BIG,\t \n\tLIBBPF_ERRNO__KVER,\t \n\tLIBBPF_ERRNO__PROGTYPE,\t \n\tLIBBPF_ERRNO__WRNGPID,\t \n\tLIBBPF_ERRNO__INVSEQ,\t \n\tLIBBPF_ERRNO__NLPARSE,\t \n\t__LIBBPF_ERRNO__END,\n};\n\nLIBBPF_API int libbpf_strerror(int err, char *buf, size_t size);\n\n \nLIBBPF_API const char *libbpf_bpf_attach_type_str(enum bpf_attach_type t);\n\n \nLIBBPF_API const char *libbpf_bpf_link_type_str(enum bpf_link_type t);\n\n \nLIBBPF_API const char *libbpf_bpf_map_type_str(enum bpf_map_type t);\n\n \nLIBBPF_API const char *libbpf_bpf_prog_type_str(enum bpf_prog_type t);\n\nenum libbpf_print_level {\n        LIBBPF_WARN,\n        LIBBPF_INFO,\n        LIBBPF_DEBUG,\n};\n\ntypedef int (*libbpf_print_fn_t)(enum libbpf_print_level level,\n\t\t\t\t const char *, va_list ap);\n\n \nLIBBPF_API libbpf_print_fn_t libbpf_set_print(libbpf_print_fn_t fn);\n\n \nstruct bpf_object;\n\nstruct bpf_object_open_opts {\n\t \n\tsize_t sz;\n\t \n\tconst char *object_name;\n\t \n\tbool relaxed_maps;\n\t \n\tconst char *pin_root_path;\n\n\t__u32 :32;  \n\n\t \n\tconst char *kconfig;\n\t \n\tconst char *btf_custom_path;\n\t \n\tchar *kernel_log_buf;\n\tsize_t kernel_log_size;\n\t \n\t__u32 kernel_log_level;\n\n\tsize_t :0;\n};\n#define bpf_object_open_opts__last_field kernel_log_level\n\n \nLIBBPF_API struct bpf_object *bpf_object__open(const char *path);\n\n \nLIBBPF_API struct bpf_object *\nbpf_object__open_file(const char *path, const struct bpf_object_open_opts *opts);\n\n \nLIBBPF_API struct bpf_object *\nbpf_object__open_mem(const void *obj_buf, size_t obj_buf_sz,\n\t\t     const struct bpf_object_open_opts *opts);\n\n \nLIBBPF_API int bpf_object__load(struct bpf_object *obj);\n\n \nLIBBPF_API void bpf_object__close(struct bpf_object *obj);\n\n \nLIBBPF_API int bpf_object__pin_maps(struct bpf_object *obj, const char *path);\n\n \nLIBBPF_API int bpf_object__unpin_maps(struct bpf_object *obj,\n\t\t\t\t      const char *path);\nLIBBPF_API int bpf_object__pin_programs(struct bpf_object *obj,\n\t\t\t\t\tconst char *path);\nLIBBPF_API int bpf_object__unpin_programs(struct bpf_object *obj,\n\t\t\t\t\t  const char *path);\nLIBBPF_API int bpf_object__pin(struct bpf_object *object, const char *path);\nLIBBPF_API int bpf_object__unpin(struct bpf_object *object, const char *path);\n\nLIBBPF_API const char *bpf_object__name(const struct bpf_object *obj);\nLIBBPF_API unsigned int bpf_object__kversion(const struct bpf_object *obj);\nLIBBPF_API int bpf_object__set_kversion(struct bpf_object *obj, __u32 kern_version);\n\nstruct btf;\nLIBBPF_API struct btf *bpf_object__btf(const struct bpf_object *obj);\nLIBBPF_API int bpf_object__btf_fd(const struct bpf_object *obj);\n\nLIBBPF_API struct bpf_program *\nbpf_object__find_program_by_name(const struct bpf_object *obj,\n\t\t\t\t const char *name);\n\nLIBBPF_API int\nlibbpf_prog_type_by_name(const char *name, enum bpf_prog_type *prog_type,\n\t\t\t enum bpf_attach_type *expected_attach_type);\nLIBBPF_API int libbpf_attach_type_by_name(const char *name,\n\t\t\t\t\t  enum bpf_attach_type *attach_type);\nLIBBPF_API int libbpf_find_vmlinux_btf_id(const char *name,\n\t\t\t\t\t  enum bpf_attach_type attach_type);\n\n \nstruct bpf_program;\n\nLIBBPF_API struct bpf_program *\nbpf_object__next_program(const struct bpf_object *obj, struct bpf_program *prog);\n\n#define bpf_object__for_each_program(pos, obj)\t\t\t\\\n\tfor ((pos) = bpf_object__next_program((obj), NULL);\t\\\n\t     (pos) != NULL;\t\t\t\t\t\\\n\t     (pos) = bpf_object__next_program((obj), (pos)))\n\nLIBBPF_API struct bpf_program *\nbpf_object__prev_program(const struct bpf_object *obj, struct bpf_program *prog);\n\nLIBBPF_API void bpf_program__set_ifindex(struct bpf_program *prog,\n\t\t\t\t\t __u32 ifindex);\n\nLIBBPF_API const char *bpf_program__name(const struct bpf_program *prog);\nLIBBPF_API const char *bpf_program__section_name(const struct bpf_program *prog);\nLIBBPF_API bool bpf_program__autoload(const struct bpf_program *prog);\nLIBBPF_API int bpf_program__set_autoload(struct bpf_program *prog, bool autoload);\nLIBBPF_API bool bpf_program__autoattach(const struct bpf_program *prog);\nLIBBPF_API void bpf_program__set_autoattach(struct bpf_program *prog, bool autoattach);\n\nstruct bpf_insn;\n\n \nLIBBPF_API const struct bpf_insn *bpf_program__insns(const struct bpf_program *prog);\n\n \nLIBBPF_API int bpf_program__set_insns(struct bpf_program *prog,\n\t\t\t\t      struct bpf_insn *new_insns, size_t new_insn_cnt);\n\n \nLIBBPF_API size_t bpf_program__insn_cnt(const struct bpf_program *prog);\n\nLIBBPF_API int bpf_program__fd(const struct bpf_program *prog);\n\n \nLIBBPF_API int bpf_program__pin(struct bpf_program *prog, const char *path);\n\n \nLIBBPF_API int bpf_program__unpin(struct bpf_program *prog, const char *path);\nLIBBPF_API void bpf_program__unload(struct bpf_program *prog);\n\nstruct bpf_link;\n\nLIBBPF_API struct bpf_link *bpf_link__open(const char *path);\nLIBBPF_API int bpf_link__fd(const struct bpf_link *link);\nLIBBPF_API const char *bpf_link__pin_path(const struct bpf_link *link);\n \n\nLIBBPF_API int bpf_link__pin(struct bpf_link *link, const char *path);\n\n \nLIBBPF_API int bpf_link__unpin(struct bpf_link *link);\nLIBBPF_API int bpf_link__update_program(struct bpf_link *link,\n\t\t\t\t\tstruct bpf_program *prog);\nLIBBPF_API void bpf_link__disconnect(struct bpf_link *link);\nLIBBPF_API int bpf_link__detach(struct bpf_link *link);\nLIBBPF_API int bpf_link__destroy(struct bpf_link *link);\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach(const struct bpf_program *prog);\n\nstruct bpf_perf_event_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 bpf_cookie;\n\t \n\tbool force_ioctl_attach;\n\tsize_t :0;\n};\n#define bpf_perf_event_opts__last_field force_ioctl_attach\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_perf_event(const struct bpf_program *prog, int pfd);\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_perf_event_opts(const struct bpf_program *prog, int pfd,\n\t\t\t\t    const struct bpf_perf_event_opts *opts);\n\n \nenum probe_attach_mode {\n\t \n\tPROBE_ATTACH_MODE_DEFAULT = 0,\n\t \n\tPROBE_ATTACH_MODE_LEGACY,\n\t \n\tPROBE_ATTACH_MODE_PERF,\n\t \n\tPROBE_ATTACH_MODE_LINK,\n};\n\nstruct bpf_kprobe_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 bpf_cookie;\n\t \n\tsize_t offset;\n\t \n\tbool retprobe;\n\t \n\tenum probe_attach_mode attach_mode;\n\tsize_t :0;\n};\n#define bpf_kprobe_opts__last_field attach_mode\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_kprobe(const struct bpf_program *prog, bool retprobe,\n\t\t\t   const char *func_name);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_kprobe_opts(const struct bpf_program *prog,\n                                const char *func_name,\n                                const struct bpf_kprobe_opts *opts);\n\nstruct bpf_kprobe_multi_opts {\n\t \n\tsize_t sz;\n\t \n\tconst char **syms;\n\t \n\tconst unsigned long *addrs;\n\t \n\tconst __u64 *cookies;\n\t \n\tsize_t cnt;\n\t \n\tbool retprobe;\n\tsize_t :0;\n};\n\n#define bpf_kprobe_multi_opts__last_field retprobe\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_kprobe_multi_opts(const struct bpf_program *prog,\n\t\t\t\t      const char *pattern,\n\t\t\t\t      const struct bpf_kprobe_multi_opts *opts);\n\nstruct bpf_uprobe_multi_opts {\n\t \n\tsize_t sz;\n\t \n\tconst char **syms;\n\t \n\tconst unsigned long *offsets;\n\t \n\tconst unsigned long *ref_ctr_offsets;\n\t \n\tconst __u64 *cookies;\n\t \n\tsize_t cnt;\n\t \n\tbool retprobe;\n\tsize_t :0;\n};\n\n#define bpf_uprobe_multi_opts__last_field retprobe\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach_uprobe_multi(const struct bpf_program *prog,\n\t\t\t\t pid_t pid,\n\t\t\t\t const char *binary_path,\n\t\t\t\t const char *func_pattern,\n\t\t\t\t const struct bpf_uprobe_multi_opts *opts);\n\nstruct bpf_ksyscall_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 bpf_cookie;\n\t \n\tbool retprobe;\n\tsize_t :0;\n};\n#define bpf_ksyscall_opts__last_field retprobe\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach_ksyscall(const struct bpf_program *prog,\n\t\t\t     const char *syscall_name,\n\t\t\t     const struct bpf_ksyscall_opts *opts);\n\nstruct bpf_uprobe_opts {\n\t \n\tsize_t sz;\n\t \n\tsize_t ref_ctr_offset;\n\t \n\t__u64 bpf_cookie;\n\t \n\tbool retprobe;\n\t \n\tconst char *func_name;\n\t \n\tenum probe_attach_mode attach_mode;\n\tsize_t :0;\n};\n#define bpf_uprobe_opts__last_field attach_mode\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach_uprobe(const struct bpf_program *prog, bool retprobe,\n\t\t\t   pid_t pid, const char *binary_path,\n\t\t\t   size_t func_offset);\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach_uprobe_opts(const struct bpf_program *prog, pid_t pid,\n\t\t\t\tconst char *binary_path, size_t func_offset,\n\t\t\t\tconst struct bpf_uprobe_opts *opts);\n\nstruct bpf_usdt_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 usdt_cookie;\n\tsize_t :0;\n};\n#define bpf_usdt_opts__last_field usdt_cookie\n\n \nLIBBPF_API struct bpf_link *\nbpf_program__attach_usdt(const struct bpf_program *prog,\n\t\t\t pid_t pid, const char *binary_path,\n\t\t\t const char *usdt_provider, const char *usdt_name,\n\t\t\t const struct bpf_usdt_opts *opts);\n\nstruct bpf_tracepoint_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 bpf_cookie;\n};\n#define bpf_tracepoint_opts__last_field bpf_cookie\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_tracepoint(const struct bpf_program *prog,\n\t\t\t       const char *tp_category,\n\t\t\t       const char *tp_name);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_tracepoint_opts(const struct bpf_program *prog,\n\t\t\t\t    const char *tp_category,\n\t\t\t\t    const char *tp_name,\n\t\t\t\t    const struct bpf_tracepoint_opts *opts);\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_raw_tracepoint(const struct bpf_program *prog,\n\t\t\t\t   const char *tp_name);\n\nstruct bpf_trace_opts {\n\t \n\tsize_t sz;\n\t \n\t__u64 cookie;\n};\n#define bpf_trace_opts__last_field cookie\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_trace(const struct bpf_program *prog);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_trace_opts(const struct bpf_program *prog, const struct bpf_trace_opts *opts);\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_lsm(const struct bpf_program *prog);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_cgroup(const struct bpf_program *prog, int cgroup_fd);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_netns(const struct bpf_program *prog, int netns_fd);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_xdp(const struct bpf_program *prog, int ifindex);\nLIBBPF_API struct bpf_link *\nbpf_program__attach_freplace(const struct bpf_program *prog,\n\t\t\t     int target_fd, const char *attach_func_name);\n\nstruct bpf_netfilter_opts {\n\t \n\tsize_t sz;\n\n\t__u32 pf;\n\t__u32 hooknum;\n\t__s32 priority;\n\t__u32 flags;\n};\n#define bpf_netfilter_opts__last_field flags\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_netfilter(const struct bpf_program *prog,\n\t\t\t      const struct bpf_netfilter_opts *opts);\n\nstruct bpf_tcx_opts {\n\t \n\tsize_t sz;\n\t__u32 flags;\n\t__u32 relative_fd;\n\t__u32 relative_id;\n\t__u64 expected_revision;\n\tsize_t :0;\n};\n#define bpf_tcx_opts__last_field expected_revision\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_tcx(const struct bpf_program *prog, int ifindex,\n\t\t\tconst struct bpf_tcx_opts *opts);\n\nstruct bpf_map;\n\nLIBBPF_API struct bpf_link *bpf_map__attach_struct_ops(const struct bpf_map *map);\nLIBBPF_API int bpf_link__update_map(struct bpf_link *link, const struct bpf_map *map);\n\nstruct bpf_iter_attach_opts {\n\tsize_t sz;  \n\tunion bpf_iter_link_info *link_info;\n\t__u32 link_info_len;\n};\n#define bpf_iter_attach_opts__last_field link_info_len\n\nLIBBPF_API struct bpf_link *\nbpf_program__attach_iter(const struct bpf_program *prog,\n\t\t\t const struct bpf_iter_attach_opts *opts);\n\nLIBBPF_API enum bpf_prog_type bpf_program__type(const struct bpf_program *prog);\n\n \nLIBBPF_API int bpf_program__set_type(struct bpf_program *prog,\n\t\t\t\t     enum bpf_prog_type type);\n\nLIBBPF_API enum bpf_attach_type\nbpf_program__expected_attach_type(const struct bpf_program *prog);\n\n \nLIBBPF_API int\nbpf_program__set_expected_attach_type(struct bpf_program *prog,\n\t\t\t\t      enum bpf_attach_type type);\n\nLIBBPF_API __u32 bpf_program__flags(const struct bpf_program *prog);\nLIBBPF_API int bpf_program__set_flags(struct bpf_program *prog, __u32 flags);\n\n \nLIBBPF_API __u32 bpf_program__log_level(const struct bpf_program *prog);\nLIBBPF_API int bpf_program__set_log_level(struct bpf_program *prog, __u32 log_level);\nLIBBPF_API const char *bpf_program__log_buf(const struct bpf_program *prog, size_t *log_size);\nLIBBPF_API int bpf_program__set_log_buf(struct bpf_program *prog, char *log_buf, size_t log_size);\n\n \nLIBBPF_API int\nbpf_program__set_attach_target(struct bpf_program *prog, int attach_prog_fd,\n\t\t\t       const char *attach_func_name);\n\n \nLIBBPF_API struct bpf_map *\nbpf_object__find_map_by_name(const struct bpf_object *obj, const char *name);\n\nLIBBPF_API int\nbpf_object__find_map_fd_by_name(const struct bpf_object *obj, const char *name);\n\nLIBBPF_API struct bpf_map *\nbpf_object__next_map(const struct bpf_object *obj, const struct bpf_map *map);\n\n#define bpf_object__for_each_map(pos, obj)\t\t\\\n\tfor ((pos) = bpf_object__next_map((obj), NULL);\t\\\n\t     (pos) != NULL;\t\t\t\t\\\n\t     (pos) = bpf_object__next_map((obj), (pos)))\n#define bpf_map__for_each bpf_object__for_each_map\n\nLIBBPF_API struct bpf_map *\nbpf_object__prev_map(const struct bpf_object *obj, const struct bpf_map *map);\n\n \nLIBBPF_API int bpf_map__set_autocreate(struct bpf_map *map, bool autocreate);\nLIBBPF_API bool bpf_map__autocreate(const struct bpf_map *map);\n\n \nLIBBPF_API int bpf_map__fd(const struct bpf_map *map);\nLIBBPF_API int bpf_map__reuse_fd(struct bpf_map *map, int fd);\n \nLIBBPF_API const char *bpf_map__name(const struct bpf_map *map);\n \nLIBBPF_API enum bpf_map_type bpf_map__type(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_type(struct bpf_map *map, enum bpf_map_type type);\n \nLIBBPF_API __u32 bpf_map__max_entries(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_max_entries(struct bpf_map *map, __u32 max_entries);\n \nLIBBPF_API __u32 bpf_map__map_flags(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_map_flags(struct bpf_map *map, __u32 flags);\n \nLIBBPF_API __u32 bpf_map__numa_node(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_numa_node(struct bpf_map *map, __u32 numa_node);\n \nLIBBPF_API __u32 bpf_map__key_size(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_key_size(struct bpf_map *map, __u32 size);\n \nLIBBPF_API __u32 bpf_map__value_size(const struct bpf_map *map);\n \nLIBBPF_API int bpf_map__set_value_size(struct bpf_map *map, __u32 size);\n \nLIBBPF_API __u32 bpf_map__btf_key_type_id(const struct bpf_map *map);\nLIBBPF_API __u32 bpf_map__btf_value_type_id(const struct bpf_map *map);\n \nLIBBPF_API __u32 bpf_map__ifindex(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_ifindex(struct bpf_map *map, __u32 ifindex);\n \nLIBBPF_API __u64 bpf_map__map_extra(const struct bpf_map *map);\nLIBBPF_API int bpf_map__set_map_extra(struct bpf_map *map, __u64 map_extra);\n\nLIBBPF_API int bpf_map__set_initial_value(struct bpf_map *map,\n\t\t\t\t\t  const void *data, size_t size);\nLIBBPF_API void *bpf_map__initial_value(struct bpf_map *map, size_t *psize);\n\n \nLIBBPF_API bool bpf_map__is_internal(const struct bpf_map *map);\n\n \nLIBBPF_API int bpf_map__set_pin_path(struct bpf_map *map, const char *path);\n\n \nLIBBPF_API const char *bpf_map__pin_path(const struct bpf_map *map);\n\n \nLIBBPF_API bool bpf_map__is_pinned(const struct bpf_map *map);\n\n \nLIBBPF_API int bpf_map__pin(struct bpf_map *map, const char *path);\n\n \nLIBBPF_API int bpf_map__unpin(struct bpf_map *map, const char *path);\n\nLIBBPF_API int bpf_map__set_inner_map_fd(struct bpf_map *map, int fd);\nLIBBPF_API struct bpf_map *bpf_map__inner_map(struct bpf_map *map);\n\n \nLIBBPF_API int bpf_map__lookup_elem(const struct bpf_map *map,\n\t\t\t\t    const void *key, size_t key_sz,\n\t\t\t\t    void *value, size_t value_sz, __u64 flags);\n\n \nLIBBPF_API int bpf_map__update_elem(const struct bpf_map *map,\n\t\t\t\t    const void *key, size_t key_sz,\n\t\t\t\t    const void *value, size_t value_sz, __u64 flags);\n\n \nLIBBPF_API int bpf_map__delete_elem(const struct bpf_map *map,\n\t\t\t\t    const void *key, size_t key_sz, __u64 flags);\n\n \nLIBBPF_API int bpf_map__lookup_and_delete_elem(const struct bpf_map *map,\n\t\t\t\t\t       const void *key, size_t key_sz,\n\t\t\t\t\t       void *value, size_t value_sz, __u64 flags);\n\n \nLIBBPF_API int bpf_map__get_next_key(const struct bpf_map *map,\n\t\t\t\t     const void *cur_key, void *next_key, size_t key_sz);\n\nstruct bpf_xdp_set_link_opts {\n\tsize_t sz;\n\tint old_fd;\n\tsize_t :0;\n};\n#define bpf_xdp_set_link_opts__last_field old_fd\n\nstruct bpf_xdp_attach_opts {\n\tsize_t sz;\n\tint old_prog_fd;\n\tsize_t :0;\n};\n#define bpf_xdp_attach_opts__last_field old_prog_fd\n\nstruct bpf_xdp_query_opts {\n\tsize_t sz;\n\t__u32 prog_id;\t\t \n\t__u32 drv_prog_id;\t \n\t__u32 hw_prog_id;\t \n\t__u32 skb_prog_id;\t \n\t__u8 attach_mode;\t \n\t__u64 feature_flags;\t \n\t__u32 xdp_zc_max_segs;\t \n\tsize_t :0;\n};\n#define bpf_xdp_query_opts__last_field xdp_zc_max_segs\n\nLIBBPF_API int bpf_xdp_attach(int ifindex, int prog_fd, __u32 flags,\n\t\t\t      const struct bpf_xdp_attach_opts *opts);\nLIBBPF_API int bpf_xdp_detach(int ifindex, __u32 flags,\n\t\t\t      const struct bpf_xdp_attach_opts *opts);\nLIBBPF_API int bpf_xdp_query(int ifindex, int flags, struct bpf_xdp_query_opts *opts);\nLIBBPF_API int bpf_xdp_query_id(int ifindex, int flags, __u32 *prog_id);\n\n \nenum bpf_tc_attach_point {\n\tBPF_TC_INGRESS = 1 << 0,\n\tBPF_TC_EGRESS  = 1 << 1,\n\tBPF_TC_CUSTOM  = 1 << 2,\n};\n\n#define BPF_TC_PARENT(a, b) \t\\\n\t((((a) << 16) & 0xFFFF0000U) | ((b) & 0x0000FFFFU))\n\nenum bpf_tc_flags {\n\tBPF_TC_F_REPLACE = 1 << 0,\n};\n\nstruct bpf_tc_hook {\n\tsize_t sz;\n\tint ifindex;\n\tenum bpf_tc_attach_point attach_point;\n\t__u32 parent;\n\tsize_t :0;\n};\n#define bpf_tc_hook__last_field parent\n\nstruct bpf_tc_opts {\n\tsize_t sz;\n\tint prog_fd;\n\t__u32 flags;\n\t__u32 prog_id;\n\t__u32 handle;\n\t__u32 priority;\n\tsize_t :0;\n};\n#define bpf_tc_opts__last_field priority\n\nLIBBPF_API int bpf_tc_hook_create(struct bpf_tc_hook *hook);\nLIBBPF_API int bpf_tc_hook_destroy(struct bpf_tc_hook *hook);\nLIBBPF_API int bpf_tc_attach(const struct bpf_tc_hook *hook,\n\t\t\t     struct bpf_tc_opts *opts);\nLIBBPF_API int bpf_tc_detach(const struct bpf_tc_hook *hook,\n\t\t\t     const struct bpf_tc_opts *opts);\nLIBBPF_API int bpf_tc_query(const struct bpf_tc_hook *hook,\n\t\t\t    struct bpf_tc_opts *opts);\n\n \nstruct ring_buffer;\nstruct user_ring_buffer;\n\ntypedef int (*ring_buffer_sample_fn)(void *ctx, void *data, size_t size);\n\nstruct ring_buffer_opts {\n\tsize_t sz;  \n};\n\n#define ring_buffer_opts__last_field sz\n\nLIBBPF_API struct ring_buffer *\nring_buffer__new(int map_fd, ring_buffer_sample_fn sample_cb, void *ctx,\n\t\t const struct ring_buffer_opts *opts);\nLIBBPF_API void ring_buffer__free(struct ring_buffer *rb);\nLIBBPF_API int ring_buffer__add(struct ring_buffer *rb, int map_fd,\n\t\t\t\tring_buffer_sample_fn sample_cb, void *ctx);\nLIBBPF_API int ring_buffer__poll(struct ring_buffer *rb, int timeout_ms);\nLIBBPF_API int ring_buffer__consume(struct ring_buffer *rb);\nLIBBPF_API int ring_buffer__epoll_fd(const struct ring_buffer *rb);\n\nstruct user_ring_buffer_opts {\n\tsize_t sz;  \n};\n\n#define user_ring_buffer_opts__last_field sz\n\n \nLIBBPF_API struct user_ring_buffer *\nuser_ring_buffer__new(int map_fd, const struct user_ring_buffer_opts *opts);\n\n \nLIBBPF_API void *user_ring_buffer__reserve(struct user_ring_buffer *rb, __u32 size);\n\n \nLIBBPF_API void *user_ring_buffer__reserve_blocking(struct user_ring_buffer *rb,\n\t\t\t\t\t\t    __u32 size,\n\t\t\t\t\t\t    int timeout_ms);\n\n \nLIBBPF_API void user_ring_buffer__submit(struct user_ring_buffer *rb, void *sample);\n\n \nLIBBPF_API void user_ring_buffer__discard(struct user_ring_buffer *rb, void *sample);\n\n \nLIBBPF_API void user_ring_buffer__free(struct user_ring_buffer *rb);\n\n \nstruct perf_buffer;\n\ntypedef void (*perf_buffer_sample_fn)(void *ctx, int cpu,\n\t\t\t\t      void *data, __u32 size);\ntypedef void (*perf_buffer_lost_fn)(void *ctx, int cpu, __u64 cnt);\n\n \nstruct perf_buffer_opts {\n\tsize_t sz;\n\t__u32 sample_period;\n\tsize_t :0;\n};\n#define perf_buffer_opts__last_field sample_period\n\n \nLIBBPF_API struct perf_buffer *\nperf_buffer__new(int map_fd, size_t page_cnt,\n\t\t perf_buffer_sample_fn sample_cb, perf_buffer_lost_fn lost_cb, void *ctx,\n\t\t const struct perf_buffer_opts *opts);\n\nenum bpf_perf_event_ret {\n\tLIBBPF_PERF_EVENT_DONE\t= 0,\n\tLIBBPF_PERF_EVENT_ERROR\t= -1,\n\tLIBBPF_PERF_EVENT_CONT\t= -2,\n};\n\nstruct perf_event_header;\n\ntypedef enum bpf_perf_event_ret\n(*perf_buffer_event_fn)(void *ctx, int cpu, struct perf_event_header *event);\n\n \nstruct perf_buffer_raw_opts {\n\tsize_t sz;\n\tlong :0;\n\tlong :0;\n\t \n\tint cpu_cnt;\n\t \n\tint *cpus;\n\t \n\tint *map_keys;\n};\n#define perf_buffer_raw_opts__last_field map_keys\n\nstruct perf_event_attr;\n\nLIBBPF_API struct perf_buffer *\nperf_buffer__new_raw(int map_fd, size_t page_cnt, struct perf_event_attr *attr,\n\t\t     perf_buffer_event_fn event_cb, void *ctx,\n\t\t     const struct perf_buffer_raw_opts *opts);\n\nLIBBPF_API void perf_buffer__free(struct perf_buffer *pb);\nLIBBPF_API int perf_buffer__epoll_fd(const struct perf_buffer *pb);\nLIBBPF_API int perf_buffer__poll(struct perf_buffer *pb, int timeout_ms);\nLIBBPF_API int perf_buffer__consume(struct perf_buffer *pb);\nLIBBPF_API int perf_buffer__consume_buffer(struct perf_buffer *pb, size_t buf_idx);\nLIBBPF_API size_t perf_buffer__buffer_cnt(const struct perf_buffer *pb);\nLIBBPF_API int perf_buffer__buffer_fd(const struct perf_buffer *pb, size_t buf_idx);\n \nLIBBPF_API int perf_buffer__buffer(struct perf_buffer *pb, int buf_idx, void **buf,\n\t\t\t\t   size_t *buf_size);\n\nstruct bpf_prog_linfo;\nstruct bpf_prog_info;\n\nLIBBPF_API void bpf_prog_linfo__free(struct bpf_prog_linfo *prog_linfo);\nLIBBPF_API struct bpf_prog_linfo *\nbpf_prog_linfo__new(const struct bpf_prog_info *info);\nLIBBPF_API const struct bpf_line_info *\nbpf_prog_linfo__lfind_addr_func(const struct bpf_prog_linfo *prog_linfo,\n\t\t\t\t__u64 addr, __u32 func_idx, __u32 nr_skip);\nLIBBPF_API const struct bpf_line_info *\nbpf_prog_linfo__lfind(const struct bpf_prog_linfo *prog_linfo,\n\t\t      __u32 insn_off, __u32 nr_skip);\n\n \n\n \nLIBBPF_API int libbpf_probe_bpf_prog_type(enum bpf_prog_type prog_type, const void *opts);\n \nLIBBPF_API int libbpf_probe_bpf_map_type(enum bpf_map_type map_type, const void *opts);\n \nLIBBPF_API int libbpf_probe_bpf_helper(enum bpf_prog_type prog_type,\n\t\t\t\t       enum bpf_func_id helper_id, const void *opts);\n\n \nLIBBPF_API int libbpf_num_possible_cpus(void);\n\nstruct bpf_map_skeleton {\n\tconst char *name;\n\tstruct bpf_map **map;\n\tvoid **mmaped;\n};\n\nstruct bpf_prog_skeleton {\n\tconst char *name;\n\tstruct bpf_program **prog;\n\tstruct bpf_link **link;\n};\n\nstruct bpf_object_skeleton {\n\tsize_t sz;  \n\n\tconst char *name;\n\tconst void *data;\n\tsize_t data_sz;\n\n\tstruct bpf_object **obj;\n\n\tint map_cnt;\n\tint map_skel_sz;  \n\tstruct bpf_map_skeleton *maps;\n\n\tint prog_cnt;\n\tint prog_skel_sz;  \n\tstruct bpf_prog_skeleton *progs;\n};\n\nLIBBPF_API int\nbpf_object__open_skeleton(struct bpf_object_skeleton *s,\n\t\t\t  const struct bpf_object_open_opts *opts);\nLIBBPF_API int bpf_object__load_skeleton(struct bpf_object_skeleton *s);\nLIBBPF_API int bpf_object__attach_skeleton(struct bpf_object_skeleton *s);\nLIBBPF_API void bpf_object__detach_skeleton(struct bpf_object_skeleton *s);\nLIBBPF_API void bpf_object__destroy_skeleton(struct bpf_object_skeleton *s);\n\nstruct bpf_var_skeleton {\n\tconst char *name;\n\tstruct bpf_map **map;\n\tvoid **addr;\n};\n\nstruct bpf_object_subskeleton {\n\tsize_t sz;  \n\n\tconst struct bpf_object *obj;\n\n\tint map_cnt;\n\tint map_skel_sz;  \n\tstruct bpf_map_skeleton *maps;\n\n\tint prog_cnt;\n\tint prog_skel_sz;  \n\tstruct bpf_prog_skeleton *progs;\n\n\tint var_cnt;\n\tint var_skel_sz;  \n\tstruct bpf_var_skeleton *vars;\n};\n\nLIBBPF_API int\nbpf_object__open_subskeleton(struct bpf_object_subskeleton *s);\nLIBBPF_API void\nbpf_object__destroy_subskeleton(struct bpf_object_subskeleton *s);\n\nstruct gen_loader_opts {\n\tsize_t sz;  \n\tconst char *data;\n\tconst char *insns;\n\t__u32 data_sz;\n\t__u32 insns_sz;\n};\n\n#define gen_loader_opts__last_field insns_sz\nLIBBPF_API int bpf_object__gen_loader(struct bpf_object *obj,\n\t\t\t\t      struct gen_loader_opts *opts);\n\nenum libbpf_tristate {\n\tTRI_NO = 0,\n\tTRI_YES = 1,\n\tTRI_MODULE = 2,\n};\n\nstruct bpf_linker_opts {\n\t \n\tsize_t sz;\n};\n#define bpf_linker_opts__last_field sz\n\nstruct bpf_linker_file_opts {\n\t \n\tsize_t sz;\n};\n#define bpf_linker_file_opts__last_field sz\n\nstruct bpf_linker;\n\nLIBBPF_API struct bpf_linker *bpf_linker__new(const char *filename, struct bpf_linker_opts *opts);\nLIBBPF_API int bpf_linker__add_file(struct bpf_linker *linker,\n\t\t\t\t    const char *filename,\n\t\t\t\t    const struct bpf_linker_file_opts *opts);\nLIBBPF_API int bpf_linker__finalize(struct bpf_linker *linker);\nLIBBPF_API void bpf_linker__free(struct bpf_linker *linker);\n\n \n\nstruct bpf_prog_load_opts;  \n\n \ntypedef int (*libbpf_prog_setup_fn_t)(struct bpf_program *prog, long cookie);\n\n \ntypedef int (*libbpf_prog_prepare_load_fn_t)(struct bpf_program *prog,\n\t\t\t\t\t     struct bpf_prog_load_opts *opts, long cookie);\n\n \ntypedef int (*libbpf_prog_attach_fn_t)(const struct bpf_program *prog, long cookie,\n\t\t\t\t       struct bpf_link **link);\n\nstruct libbpf_prog_handler_opts {\n\t \n\tsize_t sz;\n\t \n\tlong cookie;\n\t \n\tlibbpf_prog_setup_fn_t prog_setup_fn;\n\t \n\tlibbpf_prog_prepare_load_fn_t prog_prepare_load_fn;\n\t \n\tlibbpf_prog_attach_fn_t prog_attach_fn;\n};\n#define libbpf_prog_handler_opts__last_field prog_attach_fn\n\n \nLIBBPF_API int libbpf_register_prog_handler(const char *sec,\n\t\t\t\t\t    enum bpf_prog_type prog_type,\n\t\t\t\t\t    enum bpf_attach_type exp_attach_type,\n\t\t\t\t\t    const struct libbpf_prog_handler_opts *opts);\n \nLIBBPF_API int libbpf_unregister_prog_handler(int handler_id);\n\n#ifdef __cplusplus\n}  \n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}