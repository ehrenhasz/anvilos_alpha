{
  "module_name": "libbpf_errno.c",
  "hash_id": "84d802fc9c205c87cde8fecb42d1c2af4b99fdf6ee305367b2155dadf6902268",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/bpf/libbpf_errno.c",
  "human_readable_source": "\n\n \n\n#undef _GNU_SOURCE\n#include <stdio.h>\n#include <string.h>\n\n#include \"libbpf.h\"\n#include \"libbpf_internal.h\"\n\n \n#pragma GCC poison u8 u16 u32 u64 s8 s16 s32 s64\n\n#define ERRNO_OFFSET(e)\t\t((e) - __LIBBPF_ERRNO__START)\n#define ERRCODE_OFFSET(c)\tERRNO_OFFSET(LIBBPF_ERRNO__##c)\n#define NR_ERRNO\t(__LIBBPF_ERRNO__END - __LIBBPF_ERRNO__START)\n\nstatic const char *libbpf_strerror_table[NR_ERRNO] = {\n\t[ERRCODE_OFFSET(LIBELF)]\t= \"Something wrong in libelf\",\n\t[ERRCODE_OFFSET(FORMAT)]\t= \"BPF object format invalid\",\n\t[ERRCODE_OFFSET(KVERSION)]\t= \"'version' section incorrect or lost\",\n\t[ERRCODE_OFFSET(ENDIAN)]\t= \"Endian mismatch\",\n\t[ERRCODE_OFFSET(INTERNAL)]\t= \"Internal error in libbpf\",\n\t[ERRCODE_OFFSET(RELOC)]\t\t= \"Relocation failed\",\n\t[ERRCODE_OFFSET(VERIFY)]\t= \"Kernel verifier blocks program loading\",\n\t[ERRCODE_OFFSET(PROG2BIG)]\t= \"Program too big\",\n\t[ERRCODE_OFFSET(KVER)]\t\t= \"Incorrect kernel version\",\n\t[ERRCODE_OFFSET(PROGTYPE)]\t= \"Kernel doesn't support this program type\",\n\t[ERRCODE_OFFSET(WRNGPID)]\t= \"Wrong pid in netlink message\",\n\t[ERRCODE_OFFSET(INVSEQ)]\t= \"Invalid netlink sequence\",\n\t[ERRCODE_OFFSET(NLPARSE)]\t= \"Incorrect netlink message parsing\",\n};\n\nint libbpf_strerror(int err, char *buf, size_t size)\n{\n\tint ret;\n\n\tif (!buf || !size)\n\t\treturn libbpf_err(-EINVAL);\n\n\terr = err > 0 ? err : -err;\n\n\tif (err < __LIBBPF_ERRNO__START) {\n\t\tret = strerror_r(err, buf, size);\n\t\tbuf[size - 1] = '\\0';\n\t\treturn libbpf_err_errno(ret);\n\t}\n\n\tif (err < __LIBBPF_ERRNO__END) {\n\t\tconst char *msg;\n\n\t\tmsg = libbpf_strerror_table[ERRNO_OFFSET(err)];\n\t\tret = snprintf(buf, size, \"%s\", msg);\n\t\tbuf[size - 1] = '\\0';\n\t\t \n\t\tif (ret >= size)\n\t\t\treturn libbpf_err(-ERANGE);\n\t\treturn 0;\n\t}\n\n\tret = snprintf(buf, size, \"Unknown libbpf error %d\", err);\n\tbuf[size - 1] = '\\0';\n\tif (ret >= size)\n\t\treturn libbpf_err(-ERANGE);\n\treturn libbpf_err(-ENOENT);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}