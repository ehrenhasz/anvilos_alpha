{
  "module_name": "bpf.h",
  "hash_id": "f4d3c59f0a46a05598ff883f1315080606086b4e77996ce403d4afbf7e4a609a",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/bpf/bpf.h",
  "human_readable_source": " \n\n \n#ifndef __LIBBPF_BPF_H\n#define __LIBBPF_BPF_H\n\n#include <linux/bpf.h>\n#include <stdbool.h>\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"libbpf_common.h\"\n#include \"libbpf_legacy.h\"\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nint libbpf_set_memlock_rlim(size_t memlock_bytes);\n\nstruct bpf_map_create_opts {\n\tsize_t sz;  \n\n\t__u32 btf_fd;\n\t__u32 btf_key_type_id;\n\t__u32 btf_value_type_id;\n\t__u32 btf_vmlinux_value_type_id;\n\n\t__u32 inner_map_fd;\n\t__u32 map_flags;\n\t__u64 map_extra;\n\n\t__u32 numa_node;\n\t__u32 map_ifindex;\n};\n#define bpf_map_create_opts__last_field map_ifindex\n\nLIBBPF_API int bpf_map_create(enum bpf_map_type map_type,\n\t\t\t      const char *map_name,\n\t\t\t      __u32 key_size,\n\t\t\t      __u32 value_size,\n\t\t\t      __u32 max_entries,\n\t\t\t      const struct bpf_map_create_opts *opts);\n\nstruct bpf_prog_load_opts {\n\tsize_t sz;  \n\n\t \n\tint attempts;\n\n\tenum bpf_attach_type expected_attach_type;\n\t__u32 prog_btf_fd;\n\t__u32 prog_flags;\n\t__u32 prog_ifindex;\n\t__u32 kern_version;\n\n\t__u32 attach_btf_id;\n\t__u32 attach_prog_fd;\n\t__u32 attach_btf_obj_fd;\n\n\tconst int *fd_array;\n\n\t \n\tconst void *func_info;\n\t__u32 func_info_cnt;\n\t__u32 func_info_rec_size;\n\n\t \n\tconst void *line_info;\n\t__u32 line_info_cnt;\n\t__u32 line_info_rec_size;\n\n\t \n\t__u32 log_level;\n\t__u32 log_size;\n\tchar *log_buf;\n\t \n\t__u32 log_true_size;\n\tsize_t :0;\n};\n#define bpf_prog_load_opts__last_field log_true_size\n\nLIBBPF_API int bpf_prog_load(enum bpf_prog_type prog_type,\n\t\t\t     const char *prog_name, const char *license,\n\t\t\t     const struct bpf_insn *insns, size_t insn_cnt,\n\t\t\t     struct bpf_prog_load_opts *opts);\n\n \n#define MAPS_RELAX_COMPAT\t0x01\n\n \n#define BPF_LOG_BUF_SIZE (UINT32_MAX >> 8)  \n\nstruct bpf_btf_load_opts {\n\tsize_t sz;  \n\n\t \n\tchar *log_buf;\n\t__u32 log_level;\n\t__u32 log_size;\n\t \n\t__u32 log_true_size;\n\tsize_t :0;\n};\n#define bpf_btf_load_opts__last_field log_true_size\n\nLIBBPF_API int bpf_btf_load(const void *btf_data, size_t btf_size,\n\t\t\t    struct bpf_btf_load_opts *opts);\n\nLIBBPF_API int bpf_map_update_elem(int fd, const void *key, const void *value,\n\t\t\t\t   __u64 flags);\n\nLIBBPF_API int bpf_map_lookup_elem(int fd, const void *key, void *value);\nLIBBPF_API int bpf_map_lookup_elem_flags(int fd, const void *key, void *value,\n\t\t\t\t\t __u64 flags);\nLIBBPF_API int bpf_map_lookup_and_delete_elem(int fd, const void *key,\n\t\t\t\t\t      void *value);\nLIBBPF_API int bpf_map_lookup_and_delete_elem_flags(int fd, const void *key,\n\t\t\t\t\t\t    void *value, __u64 flags);\nLIBBPF_API int bpf_map_delete_elem(int fd, const void *key);\nLIBBPF_API int bpf_map_delete_elem_flags(int fd, const void *key, __u64 flags);\nLIBBPF_API int bpf_map_get_next_key(int fd, const void *key, void *next_key);\nLIBBPF_API int bpf_map_freeze(int fd);\n\nstruct bpf_map_batch_opts {\n\tsize_t sz;  \n\t__u64 elem_flags;\n\t__u64 flags;\n};\n#define bpf_map_batch_opts__last_field flags\n\n\n \nLIBBPF_API int bpf_map_delete_batch(int fd, const void *keys,\n\t\t\t\t    __u32 *count,\n\t\t\t\t    const struct bpf_map_batch_opts *opts);\n\n \nLIBBPF_API int bpf_map_lookup_batch(int fd, void *in_batch, void *out_batch,\n\t\t\t\t    void *keys, void *values, __u32 *count,\n\t\t\t\t    const struct bpf_map_batch_opts *opts);\n\n \nLIBBPF_API int bpf_map_lookup_and_delete_batch(int fd, void *in_batch,\n\t\t\t\t\tvoid *out_batch, void *keys,\n\t\t\t\t\tvoid *values, __u32 *count,\n\t\t\t\t\tconst struct bpf_map_batch_opts *opts);\n\n \nLIBBPF_API int bpf_map_update_batch(int fd, const void *keys, const void *values,\n\t\t\t\t    __u32 *count,\n\t\t\t\t    const struct bpf_map_batch_opts *opts);\n\nstruct bpf_obj_pin_opts {\n\tsize_t sz;  \n\n\t__u32 file_flags;\n\tint path_fd;\n\n\tsize_t :0;\n};\n#define bpf_obj_pin_opts__last_field path_fd\n\nLIBBPF_API int bpf_obj_pin(int fd, const char *pathname);\nLIBBPF_API int bpf_obj_pin_opts(int fd, const char *pathname,\n\t\t\t\tconst struct bpf_obj_pin_opts *opts);\n\nstruct bpf_obj_get_opts {\n\tsize_t sz;  \n\n\t__u32 file_flags;\n\tint path_fd;\n\n\tsize_t :0;\n};\n#define bpf_obj_get_opts__last_field path_fd\n\nLIBBPF_API int bpf_obj_get(const char *pathname);\nLIBBPF_API int bpf_obj_get_opts(const char *pathname,\n\t\t\t\tconst struct bpf_obj_get_opts *opts);\n\nLIBBPF_API int bpf_prog_attach(int prog_fd, int attachable_fd,\n\t\t\t       enum bpf_attach_type type, unsigned int flags);\nLIBBPF_API int bpf_prog_detach(int attachable_fd, enum bpf_attach_type type);\nLIBBPF_API int bpf_prog_detach2(int prog_fd, int attachable_fd,\n\t\t\t\tenum bpf_attach_type type);\n\nstruct bpf_prog_attach_opts {\n\tsize_t sz;  \n\t__u32 flags;\n\tunion {\n\t\tint replace_prog_fd;\n\t\tint replace_fd;\n\t};\n\tint relative_fd;\n\t__u32 relative_id;\n\t__u64 expected_revision;\n\tsize_t :0;\n};\n#define bpf_prog_attach_opts__last_field expected_revision\n\nstruct bpf_prog_detach_opts {\n\tsize_t sz;  \n\t__u32 flags;\n\tint relative_fd;\n\t__u32 relative_id;\n\t__u64 expected_revision;\n\tsize_t :0;\n};\n#define bpf_prog_detach_opts__last_field expected_revision\n\n \nLIBBPF_API int bpf_prog_attach_opts(int prog_fd, int target,\n\t\t\t\t    enum bpf_attach_type type,\n\t\t\t\t    const struct bpf_prog_attach_opts *opts);\n\n \nLIBBPF_API int bpf_prog_detach_opts(int prog_fd, int target,\n\t\t\t\t    enum bpf_attach_type type,\n\t\t\t\t    const struct bpf_prog_detach_opts *opts);\n\nunion bpf_iter_link_info;  \nstruct bpf_link_create_opts {\n\tsize_t sz;  \n\t__u32 flags;\n\tunion bpf_iter_link_info *iter_info;\n\t__u32 iter_info_len;\n\t__u32 target_btf_id;\n\tunion {\n\t\tstruct {\n\t\t\t__u64 bpf_cookie;\n\t\t} perf_event;\n\t\tstruct {\n\t\t\t__u32 flags;\n\t\t\t__u32 cnt;\n\t\t\tconst char **syms;\n\t\t\tconst unsigned long *addrs;\n\t\t\tconst __u64 *cookies;\n\t\t} kprobe_multi;\n\t\tstruct {\n\t\t\t__u32 flags;\n\t\t\t__u32 cnt;\n\t\t\tconst char *path;\n\t\t\tconst unsigned long *offsets;\n\t\t\tconst unsigned long *ref_ctr_offsets;\n\t\t\tconst __u64 *cookies;\n\t\t\t__u32 pid;\n\t\t} uprobe_multi;\n\t\tstruct {\n\t\t\t__u64 cookie;\n\t\t} tracing;\n\t\tstruct {\n\t\t\t__u32 pf;\n\t\t\t__u32 hooknum;\n\t\t\t__s32 priority;\n\t\t\t__u32 flags;\n\t\t} netfilter;\n\t\tstruct {\n\t\t\t__u32 relative_fd;\n\t\t\t__u32 relative_id;\n\t\t\t__u64 expected_revision;\n\t\t} tcx;\n\t};\n\tsize_t :0;\n};\n#define bpf_link_create_opts__last_field uprobe_multi.pid\n\nLIBBPF_API int bpf_link_create(int prog_fd, int target_fd,\n\t\t\t       enum bpf_attach_type attach_type,\n\t\t\t       const struct bpf_link_create_opts *opts);\n\nLIBBPF_API int bpf_link_detach(int link_fd);\n\nstruct bpf_link_update_opts {\n\tsize_t sz;  \n\t__u32 flags;\t    \n\t__u32 old_prog_fd;  \n\t__u32 old_map_fd;   \n};\n#define bpf_link_update_opts__last_field old_map_fd\n\nLIBBPF_API int bpf_link_update(int link_fd, int new_prog_fd,\n\t\t\t       const struct bpf_link_update_opts *opts);\n\nLIBBPF_API int bpf_iter_create(int link_fd);\n\nstruct bpf_prog_test_run_attr {\n\tint prog_fd;\n\tint repeat;\n\tconst void *data_in;\n\t__u32 data_size_in;\n\tvoid *data_out;       \n\t__u32 data_size_out;  \n\t__u32 retval;         \n\t__u32 duration;       \n\tconst void *ctx_in;  \n\t__u32 ctx_size_in;\n\tvoid *ctx_out;       \n\t__u32 ctx_size_out;  \n};\n\nLIBBPF_API int bpf_prog_get_next_id(__u32 start_id, __u32 *next_id);\nLIBBPF_API int bpf_map_get_next_id(__u32 start_id, __u32 *next_id);\nLIBBPF_API int bpf_btf_get_next_id(__u32 start_id, __u32 *next_id);\nLIBBPF_API int bpf_link_get_next_id(__u32 start_id, __u32 *next_id);\n\nstruct bpf_get_fd_by_id_opts {\n\tsize_t sz;  \n\t__u32 open_flags;  \n\tsize_t :0;\n};\n#define bpf_get_fd_by_id_opts__last_field open_flags\n\nLIBBPF_API int bpf_prog_get_fd_by_id(__u32 id);\nLIBBPF_API int bpf_prog_get_fd_by_id_opts(__u32 id,\n\t\t\t\tconst struct bpf_get_fd_by_id_opts *opts);\nLIBBPF_API int bpf_map_get_fd_by_id(__u32 id);\nLIBBPF_API int bpf_map_get_fd_by_id_opts(__u32 id,\n\t\t\t\tconst struct bpf_get_fd_by_id_opts *opts);\nLIBBPF_API int bpf_btf_get_fd_by_id(__u32 id);\nLIBBPF_API int bpf_btf_get_fd_by_id_opts(__u32 id,\n\t\t\t\tconst struct bpf_get_fd_by_id_opts *opts);\nLIBBPF_API int bpf_link_get_fd_by_id(__u32 id);\nLIBBPF_API int bpf_link_get_fd_by_id_opts(__u32 id,\n\t\t\t\tconst struct bpf_get_fd_by_id_opts *opts);\nLIBBPF_API int bpf_obj_get_info_by_fd(int bpf_fd, void *info, __u32 *info_len);\n\n \nLIBBPF_API int bpf_prog_get_info_by_fd(int prog_fd, struct bpf_prog_info *info, __u32 *info_len);\n\n \nLIBBPF_API int bpf_map_get_info_by_fd(int map_fd, struct bpf_map_info *info, __u32 *info_len);\n\n \nLIBBPF_API int bpf_btf_get_info_by_fd(int btf_fd, struct bpf_btf_info *info, __u32 *info_len);\n\n \nLIBBPF_API int bpf_link_get_info_by_fd(int link_fd, struct bpf_link_info *info, __u32 *info_len);\n\nstruct bpf_prog_query_opts {\n\tsize_t sz;  \n\t__u32 query_flags;\n\t__u32 attach_flags;  \n\t__u32 *prog_ids;\n\tunion {\n\t\t \n\t\t__u32 prog_cnt;\n\t\t__u32 count;\n\t};\n\t__u32 *prog_attach_flags;\n\t__u32 *link_ids;\n\t__u32 *link_attach_flags;\n\t__u64 revision;\n\tsize_t :0;\n};\n#define bpf_prog_query_opts__last_field revision\n\n \nLIBBPF_API int bpf_prog_query_opts(int target, enum bpf_attach_type type,\n\t\t\t\t   struct bpf_prog_query_opts *opts);\nLIBBPF_API int bpf_prog_query(int target_fd, enum bpf_attach_type type,\n\t\t\t      __u32 query_flags, __u32 *attach_flags,\n\t\t\t      __u32 *prog_ids, __u32 *prog_cnt);\n\nLIBBPF_API int bpf_raw_tracepoint_open(const char *name, int prog_fd);\nLIBBPF_API int bpf_task_fd_query(int pid, int fd, __u32 flags, char *buf,\n\t\t\t\t __u32 *buf_len, __u32 *prog_id, __u32 *fd_type,\n\t\t\t\t __u64 *probe_offset, __u64 *probe_addr);\n\n#ifdef __cplusplus\n \nLIBBPF_API int bpf_enable_stats(int type);\n#else\nenum bpf_stats_type;  \nLIBBPF_API int bpf_enable_stats(enum bpf_stats_type type);\n#endif\n\nstruct bpf_prog_bind_opts {\n\tsize_t sz;  \n\t__u32 flags;\n};\n#define bpf_prog_bind_opts__last_field flags\n\nLIBBPF_API int bpf_prog_bind_map(int prog_fd, int map_fd,\n\t\t\t\t const struct bpf_prog_bind_opts *opts);\n\nstruct bpf_test_run_opts {\n\tsize_t sz;  \n\tconst void *data_in;  \n\tvoid *data_out;       \n\t__u32 data_size_in;\n\t__u32 data_size_out;  \n\tconst void *ctx_in;  \n\tvoid *ctx_out;       \n\t__u32 ctx_size_in;\n\t__u32 ctx_size_out;  \n\t__u32 retval;         \n\tint repeat;\n\t__u32 duration;       \n\t__u32 flags;\n\t__u32 cpu;\n\t__u32 batch_size;\n};\n#define bpf_test_run_opts__last_field batch_size\n\nLIBBPF_API int bpf_prog_test_run_opts(int prog_fd,\n\t\t\t\t      struct bpf_test_run_opts *opts);\n\n#ifdef __cplusplus\n}  \n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}