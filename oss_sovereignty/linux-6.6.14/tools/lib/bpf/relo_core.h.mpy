{
  "module_name": "relo_core.h",
  "hash_id": "5abf59571653c1800f81bf218034f21415403afa2468afb0d940ec40a30c206e",
  "original_prompt": "Ingested from linux-6.6.14/tools/lib/bpf/relo_core.h",
  "human_readable_source": " \n \n\n#ifndef __RELO_CORE_H\n#define __RELO_CORE_H\n\n#include <linux/bpf.h>\n\nstruct bpf_core_cand {\n\tconst struct btf *btf;\n\t__u32 id;\n};\n\n \nstruct bpf_core_cand_list {\n\tstruct bpf_core_cand *cands;\n\tint len;\n};\n\n#define BPF_CORE_SPEC_MAX_LEN 64\n\n \nstruct bpf_core_accessor {\n\t__u32 type_id;\t\t \n\t__u32 idx;\t\t \n\tconst char *name;\t \n};\n\nstruct bpf_core_spec {\n\tconst struct btf *btf;\n\t \n\tstruct bpf_core_accessor spec[BPF_CORE_SPEC_MAX_LEN];\n\t \n\t__u32 root_type_id;\n\t \n\tenum bpf_core_relo_kind relo_kind;\n\t \n\tint len;\n\t \n\tint raw_spec[BPF_CORE_SPEC_MAX_LEN];\n\t \n\tint raw_len;\n\t \n\t__u32 bit_offset;\n};\n\nstruct bpf_core_relo_res {\n\t \n\t__u64 orig_val;\n\t \n\t__u64 new_val;\n\t \n\tbool poison;\n\t \n\tbool validate;\n\t \n\tbool fail_memsz_adjust;\n\t__u32 orig_sz;\n\t__u32 orig_type_id;\n\t__u32 new_sz;\n\t__u32 new_type_id;\n};\n\nint __bpf_core_types_are_compat(const struct btf *local_btf, __u32 local_id,\n\t\t\t\tconst struct btf *targ_btf, __u32 targ_id, int level);\nint bpf_core_types_are_compat(const struct btf *local_btf, __u32 local_id,\n\t\t\t      const struct btf *targ_btf, __u32 targ_id);\nint __bpf_core_types_match(const struct btf *local_btf, __u32 local_id, const struct btf *targ_btf,\n\t\t\t   __u32 targ_id, bool behind_ptr, int level);\nint bpf_core_types_match(const struct btf *local_btf, __u32 local_id, const struct btf *targ_btf,\n\t\t\t __u32 targ_id);\n\nsize_t bpf_core_essential_name_len(const char *name);\n\nint bpf_core_calc_relo_insn(const char *prog_name,\n\t\t\t    const struct bpf_core_relo *relo, int relo_idx,\n\t\t\t    const struct btf *local_btf,\n\t\t\t    struct bpf_core_cand_list *cands,\n\t\t\t    struct bpf_core_spec *specs_scratch,\n\t\t\t    struct bpf_core_relo_res *targ_res);\n\nint bpf_core_patch_insn(const char *prog_name, struct bpf_insn *insn,\n\t\t\tint insn_idx, const struct bpf_core_relo *relo,\n\t\t\tint relo_idx, const struct bpf_core_relo_res *res);\n\nint bpf_core_parse_spec(const char *prog_name, const struct btf *btf,\n\t\t        const struct bpf_core_relo *relo,\n\t\t        struct bpf_core_spec *spec);\n\nint bpf_core_format_spec(char *buf, size_t buf_sz, const struct bpf_core_spec *spec);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}