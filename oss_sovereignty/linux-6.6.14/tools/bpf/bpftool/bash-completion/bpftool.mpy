{
  "module_name": "bpftool",
  "hash_id": "f34d5b388854594387155814b2ec369933717c4eb20104611c583a639e56e75e",
  "original_prompt": "Ingested from linux-6.6.14/tools/bpf/bpftool/bash-completion/bpftool",
  "human_readable_source": "# bpftool(8) bash completion                               -*- shell-script -*-\n#\n# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)\n# Copyright (C) 2017-2018 Netronome Systems, Inc.\n#\n# Author: Quentin Monnet <quentin.monnet@netronome.com>\n\n# Takes a list of words in argument; each one of them is added to COMPREPLY if\n# it is not already present on the command line. Returns no value.\n_bpftool_once_attr()\n{\n    local w idx found\n    for w in $*; do\n        found=0\n        for (( idx=3; idx < ${#words[@]}-1; idx++ )); do\n            if [[ $w == ${words[idx]} ]]; then\n                found=1\n                break\n            fi\n        done\n        [[ $found -eq 0 ]] && \\\n            COMPREPLY+=( $( compgen -W \"$w\" -- \"$cur\" ) )\n    done\n}\n\n# Takes a list of words as argument; if any of those words is present on the\n# command line, return 0. Otherwise, return 1.\n_bpftool_search_list()\n{\n    local w idx\n    for w in $*; do\n        for (( idx=3; idx < ${#words[@]}-1; idx++ )); do\n            [[ $w == ${words[idx]} ]] && return 0\n        done\n    done\n    return 1\n}\n\n# Takes a list of words in argument; adds them all to COMPREPLY if none of them\n# is already present on the command line. Returns no value.\n_bpftool_one_of_list()\n{\n    _bpftool_search_list $* && return 1\n    COMPREPLY+=( $( compgen -W \"$*\" -- \"$cur\" ) )\n}\n\n_bpftool_get_map_ids()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp map  2>&1 | \\\n        command sed -n 's/.*\"id\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n# Takes map type and adds matching map ids to the list of suggestions.\n_bpftool_get_map_ids_for_type()\n{\n    local type=\"$1\"\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp map  2>&1 | \\\n        command grep -C2 \"$type\" | \\\n        command sed -n 's/.*\"id\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_map_names()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp map  2>&1 | \\\n        command sed -n 's/.*\"name\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n# Takes map type and adds matching map names to the list of suggestions.\n_bpftool_get_map_names_for_type()\n{\n    local type=\"$1\"\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp map  2>&1 | \\\n        command grep -C2 \"$type\" | \\\n        command sed -n 's/.*\"name\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_prog_ids()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp prog 2>&1 | \\\n        command sed -n 's/.*\"id\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_prog_tags()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp prog 2>&1 | \\\n        command sed -n 's/.*\"tag\": \"\\(.*\\)\",$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_prog_names()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp prog 2>&1 | \\\n        command sed -n 's/.*\"name\": \"\\(.*\\)\",$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_btf_ids()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp btf 2>&1 | \\\n        command sed -n 's/.*\"id\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_link_ids()\n{\n    COMPREPLY+=( $( compgen -W \"$( bpftool -jp link 2>&1 | \\\n        command sed -n 's/.*\"id\": \\(.*\\),$/\\1/p' )\" -- \"$cur\" ) )\n}\n\n_bpftool_get_obj_map_names()\n{\n    local obj\n\n    obj=$1\n\n    maps=$(objdump -j maps -t $obj 2>/dev/null | \\\n        command awk '/g     . maps/ {print $NF}')\n\n    COMPREPLY+=( $( compgen -W \"$maps\" -- \"$cur\" ) )\n}\n\n_bpftool_get_obj_map_idxs()\n{\n    local obj\n\n    obj=$1\n\n    nmaps=$(objdump -j maps -t $obj 2>/dev/null | grep -c 'g     . maps')\n\n    COMPREPLY+=( $( compgen -W \"$(seq 0 $((nmaps - 1)))\" -- \"$cur\" ) )\n}\n\n_sysfs_get_netdevs()\n{\n    COMPREPLY+=( $( compgen -W \"$( ls /sys/class/net 2>/dev/null )\" -- \\\n        \"$cur\" ) )\n}\n\n# Retrieve type of the map that we are operating on.\n_bpftool_map_guess_map_type()\n{\n    local keyword ref\n    for (( idx=3; idx < ${#words[@]}-1; idx++ )); do\n        case \"${words[$((idx-2))]}\" in\n            lookup|update)\n                keyword=${words[$((idx-1))]}\n                ref=${words[$((idx))]}\n                ;;\n            push)\n                printf \"stack\"\n                return 0\n                ;;\n            enqueue)\n                printf \"queue\"\n                return 0\n                ;;\n        esac\n    done\n    [[ -z $ref ]] && return 0\n\n    local type\n    type=$(bpftool -jp map show $keyword $ref | \\\n        command sed -n 's/.*\"type\": \"\\(.*\\)\",$/\\1/p')\n    [[ -n $type ]] && printf $type\n}\n\n_bpftool_map_update_get_id()\n{\n    local command=\"$1\"\n\n    # Is it the map to update, or a map to insert into the map to update?\n    # Search for \"value\" keyword.\n    local idx value\n    for (( idx=7; idx < ${#words[@]}-1; idx++ )); do\n        if [[ ${words[idx]} == \"value\" ]]; then\n            value=1\n            break\n        fi\n    done\n    if [[ $value -eq 0 ]]; then\n        case \"$command\" in\n            push)\n                _bpftool_get_map_ids_for_type stack\n                ;;\n            enqueue)\n                _bpftool_get_map_ids_for_type queue\n                ;;\n            *)\n                _bpftool_get_map_ids\n                ;;\n        esac\n        return 0\n    fi\n\n    # Id to complete is for a value. It can be either prog id or map id. This\n    # depends on the type of the map to update.\n    local type=$(_bpftool_map_guess_map_type)\n    case $type in\n        array_of_maps|hash_of_maps)\n            _bpftool_get_map_ids\n            return 0\n            ;;\n        prog_array)\n            _bpftool_get_prog_ids\n            return 0\n            ;;\n        *)\n            return 0\n            ;;\n    esac\n}\n\n_bpftool_map_update_get_name()\n{\n    local command=\"$1\"\n\n    # Is it the map to update, or a map to insert into the map to update?\n    # Search for \"value\" keyword.\n    local idx value\n    for (( idx=7; idx < ${#words[@]}-1; idx++ )); do\n        if [[ ${words[idx]} == \"value\" ]]; then\n            value=1\n            break\n        fi\n    done\n    if [[ $value -eq 0 ]]; then\n        case \"$command\" in\n            push)\n                _bpftool_get_map_names_for_type stack\n                ;;\n            enqueue)\n                _bpftool_get_map_names_for_type queue\n                ;;\n            *)\n                _bpftool_get_map_names\n                ;;\n        esac\n        return 0\n    fi\n\n    # Name to complete is for a value. It can be either prog name or map name. This\n    # depends on the type of the map to update.\n    local type=$(_bpftool_map_guess_map_type)\n    case $type in\n        array_of_maps|hash_of_maps)\n            _bpftool_get_map_names\n            return 0\n            ;;\n        prog_array)\n            _bpftool_get_prog_names\n            return 0\n            ;;\n        *)\n            return 0\n            ;;\n    esac\n}\n\n_bpftool()\n{\n    local cur prev words objword json=0\n    _init_completion || return\n\n    # Deal with options\n    if [[ ${words[cword]} == -* ]]; then\n        local c='--version --json --pretty --bpffs --mapcompat --debug \\\n            --use-loader --base-btf'\n        COMPREPLY=( $( compgen -W \"$c\" -- \"$cur\" ) )\n        return 0\n    fi\n    if _bpftool_search_list -j --json -p --pretty; then\n        json=1\n    fi\n\n    # Deal with simplest keywords\n    case $prev in\n        help|hex)\n            return 0\n            ;;\n        tag)\n            _bpftool_get_prog_tags\n            return 0\n            ;;\n        dev|offload_dev|xdpmeta_dev)\n            _sysfs_get_netdevs\n            return 0\n            ;;\n        file|pinned|-B|--base-btf)\n            _filedir\n            return 0\n            ;;\n        batch)\n            COMPREPLY=( $( compgen -W 'file' -- \"$cur\" ) )\n            return 0\n            ;;\n    esac\n\n    # Remove all options so completions don't have to deal with them.\n    local i\n    for (( i=1; i < ${#words[@]}; )); do\n        if [[ ${words[i]::1} == - ]] &&\n            [[ ${words[i]} != \"-B\" ]] && [[ ${words[i]} != \"--base-btf\" ]]; then\n            words=( \"${words[@]:0:i}\" \"${words[@]:i+1}\" )\n            [[ $i -le $cword ]] && cword=$(( cword - 1 ))\n        else\n            i=$(( ++i ))\n        fi\n    done\n    cur=${words[cword]}\n    prev=${words[cword - 1]}\n    pprev=${words[cword - 2]}\n\n    local object=${words[1]} command=${words[2]}\n\n    if [[ -z $object || $cword -eq 1 ]]; then\n        case $cur in\n            *)\n                COMPREPLY=( $( compgen -W \"$( bpftool help 2>&1 | \\\n                    command sed \\\n                    -e '/OBJECT := /!d' \\\n                    -e 's/.*{//' \\\n                    -e 's/}.*//' \\\n                    -e 's/|//g' )\" -- \"$cur\" ) )\n                COMPREPLY+=( $( compgen -W 'batch help' -- \"$cur\" ) )\n                return 0\n                ;;\n        esac\n    fi\n\n    [[ $command == help ]] && return 0\n\n    # Completion depends on object and command in use\n    case $object in\n        prog)\n            # Complete id and name, only for subcommands that use prog (but no\n            # map) ids/names.\n            case $command in\n                show|list|dump|pin)\n                    case $prev in\n                        id)\n                            _bpftool_get_prog_ids\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_get_prog_names\n                            return 0\n                            ;;\n                    esac\n                    ;;\n            esac\n\n            local PROG_TYPE='id pinned tag name'\n            local MAP_TYPE='id pinned name'\n            local METRIC_TYPE='cycles instructions l1d_loads llc_misses \\\n                itlb_misses dtlb_misses'\n            case $command in\n                show|list)\n                    [[ $prev != \"$command\" ]] && return 0\n                    COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                    return 0\n                    ;;\n                dump)\n                    case $prev in\n                        $command)\n                            COMPREPLY+=( $( compgen -W \"xlated jited\" -- \\\n                                \"$cur\" ) )\n                            return 0\n                            ;;\n                        xlated|jited)\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \\\n                                \"$cur\" ) )\n                            return 0\n                            ;;\n                        *)\n                            # \"file\" is not compatible with other keywords here\n                            if _bpftool_search_list 'file'; then\n                                return 0\n                            fi\n                            if ! _bpftool_search_list 'linum opcodes visual'; then\n                                _bpftool_once_attr 'file'\n                            fi\n                            _bpftool_once_attr 'linum opcodes'\n                            if _bpftool_search_list 'xlated' && [[ \"$json\" == 0 ]]; then\n                                _bpftool_once_attr 'visual'\n                            fi\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                pin)\n                    if [[ $prev == \"$command\" ]]; then\n                        COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                    else\n                        _filedir\n                    fi\n                    return 0\n                    ;;\n                attach|detach)\n                    case $cword in\n                        3)\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        4)\n                            case $prev in\n                                id)\n                                    _bpftool_get_prog_ids\n                                    ;;\n                                name)\n                                    _bpftool_get_prog_names\n                                    ;;\n                                pinned)\n                                    _filedir\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        5)\n                            local BPFTOOL_PROG_ATTACH_TYPES='sk_msg_verdict \\\n                                sk_skb_verdict sk_skb_stream_verdict sk_skb_stream_parser \\\n                                flow_dissector'\n                            COMPREPLY=( $( compgen -W \"$BPFTOOL_PROG_ATTACH_TYPES\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        6)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        7)\n                            case $prev in\n                                id)\n                                    _bpftool_get_map_ids\n                                    ;;\n                                name)\n                                    _bpftool_get_map_names\n                                    ;;\n                                pinned)\n                                    _filedir\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                load|loadall)\n                    local obj\n\n                    # Propose \"load/loadall\" to complete \"bpftool prog load\",\n                    # or bash tries to complete \"load\" as a filename below.\n                    if [[ ${#words[@]} -eq 3 ]]; then\n                        COMPREPLY=( $( compgen -W \"load loadall\" -- \"$cur\" ) )\n                        return 0\n                    fi\n\n                    if [[ ${#words[@]} -lt 6 ]]; then\n                        _filedir\n                        return 0\n                    fi\n\n                    obj=${words[3]}\n\n                    if [[ ${words[-4]} == \"map\" ]]; then\n                        COMPREPLY=( $( compgen -W \"id pinned\" -- \"$cur\" ) )\n                        return 0\n                    fi\n                    if [[ ${words[-3]} == \"map\" ]]; then\n                        if [[ ${words[-2]} == \"idx\" ]]; then\n                            _bpftool_get_obj_map_idxs $obj\n                        elif [[ ${words[-2]} == \"name\" ]]; then\n                            _bpftool_get_obj_map_names $obj\n                        fi\n                        return 0\n                    fi\n                    if [[ ${words[-2]} == \"map\" ]]; then\n                        COMPREPLY=( $( compgen -W \"idx name\" -- \"$cur\" ) )\n                        return 0\n                    fi\n\n                    case $prev in\n                        type)\n                            local BPFTOOL_PROG_LOAD_TYPES='socket kprobe \\\n                                kretprobe classifier flow_dissector \\\n                                action tracepoint raw_tracepoint \\\n                                xdp perf_event cgroup/skb cgroup/sock \\\n                                cgroup/dev lwt_in lwt_out lwt_xmit \\\n                                lwt_seg6local sockops sk_skb sk_msg \\\n                                lirc_mode2 cgroup/bind4 cgroup/bind6 \\\n                                cgroup/connect4 cgroup/connect6 \\\n                                cgroup/getpeername4 cgroup/getpeername6 \\\n                                cgroup/getsockname4 cgroup/getsockname6 \\\n                                cgroup/sendmsg4 cgroup/sendmsg6 \\\n                                cgroup/recvmsg4 cgroup/recvmsg6 \\\n                                cgroup/post_bind4 cgroup/post_bind6 \\\n                                cgroup/sysctl cgroup/getsockopt \\\n                                cgroup/setsockopt cgroup/sock_release struct_ops \\\n                                fentry fexit freplace sk_lookup'\n                            COMPREPLY=( $( compgen -W \"$BPFTOOL_PROG_LOAD_TYPES\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            _bpftool_get_map_ids\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_get_map_names\n                            return 0\n                            ;;\n                        pinned|pinmaps)\n                            _filedir\n                            return 0\n                            ;;\n                        *)\n                            COMPREPLY=( $( compgen -W \"map\" -- \"$cur\" ) )\n                            _bpftool_once_attr 'type pinmaps autoattach'\n                            _bpftool_one_of_list 'offload_dev xdpmeta_dev'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                tracelog)\n                    return 0\n                    ;;\n                profile)\n                    case $cword in\n                        3)\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        4)\n                            case $prev in\n                                id)\n                                    _bpftool_get_prog_ids\n                                    ;;\n                                name)\n                                    _bpftool_get_prog_names\n                                    ;;\n                                pinned)\n                                    _filedir\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        5)\n                            COMPREPLY=( $( compgen -W \"$METRIC_TYPE duration\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        6)\n                            case $prev in\n                                duration)\n                                    return 0\n                                    ;;\n                                *)\n                                    COMPREPLY=( $( compgen -W \"$METRIC_TYPE\" -- \"$cur\" ) )\n                                    return 0\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        *)\n                            COMPREPLY=( $( compgen -W \"$METRIC_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                run)\n                    if [[ ${#words[@]} -eq 4 ]]; then\n                        COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                        return 0\n                    fi\n                    case $prev in\n                        id)\n                            _bpftool_get_prog_ids\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_get_prog_names\n                            return 0\n                            ;;\n                        data_in|data_out|ctx_in|ctx_out)\n                            _filedir\n                            return 0\n                            ;;\n                        repeat|data_size_out|ctx_size_out)\n                            return 0\n                            ;;\n                        *)\n                            _bpftool_once_attr 'data_in data_out data_size_out \\\n                                ctx_in ctx_out ctx_size_out repeat'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'dump help pin attach detach \\\n                            load loadall show list tracelog run profile' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        struct_ops)\n            local STRUCT_OPS_TYPE='id name'\n            case $command in\n                show|list|dump|unregister)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$STRUCT_OPS_TYPE\" -- \"$cur\" ) )\n                            ;;\n                        id)\n                            _bpftool_get_map_ids_for_type struct_ops\n                            ;;\n                        name)\n                            _bpftool_get_map_names_for_type struct_ops\n                            ;;\n                    esac\n                    return 0\n                    ;;\n                register)\n                    _filedir\n                    return 0\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'register unregister show list dump help' \\\n                            -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        iter)\n            case $command in\n                pin)\n                    case $prev in\n                        $command)\n                            _filedir\n                            ;;\n                        id)\n                            _bpftool_get_map_ids\n                            ;;\n                        name)\n                            _bpftool_get_map_names\n                            ;;\n                        pinned)\n                            _filedir\n                            ;;\n                        *)\n                            _bpftool_one_of_list $MAP_TYPE\n                            ;;\n                    esac\n                    return 0\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'pin help' \\\n                            -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        map)\n            local MAP_TYPE='id pinned name'\n            case $command in\n                show|list|dump|peek|pop|dequeue|freeze)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            case \"$command\" in\n                                peek)\n                                    _bpftool_get_map_ids_for_type stack\n                                    _bpftool_get_map_ids_for_type queue\n                                    ;;\n                                pop)\n                                    _bpftool_get_map_ids_for_type stack\n                                    ;;\n                                dequeue)\n                                    _bpftool_get_map_ids_for_type queue\n                                    ;;\n                                *)\n                                    _bpftool_get_map_ids\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        name)\n                            case \"$command\" in\n                                peek)\n                                    _bpftool_get_map_names_for_type stack\n                                    _bpftool_get_map_names_for_type queue\n                                    ;;\n                                pop)\n                                    _bpftool_get_map_names_for_type stack\n                                    ;;\n                                dequeue)\n                                    _bpftool_get_map_names_for_type queue\n                                    ;;\n                                *)\n                                    _bpftool_get_map_names\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        *)\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                create)\n                    case $prev in\n                        $command)\n                            _filedir\n                            return 0\n                            ;;\n                        type)\n                            local BPFTOOL_MAP_CREATE_TYPES=\"$(bpftool feature list_builtins map_types 2>/dev/null | \\\n                                grep -v '^unspec$')\"\n                            COMPREPLY=( $( compgen -W \"$BPFTOOL_MAP_CREATE_TYPES\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        key|value|flags|entries)\n                            return 0\n                            ;;\n                        inner_map)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            _bpftool_get_map_ids\n                            ;;\n                        name)\n                            case $pprev in\n                                inner_map)\n                                    _bpftool_get_map_names\n                                    ;;\n                                *)\n                                    return 0\n                                    ;;\n                            esac\n                            ;;\n                        *)\n                            _bpftool_once_attr 'type key value entries name flags offload_dev'\n                            if _bpftool_search_list 'array_of_maps' 'hash_of_maps'; then\n                                _bpftool_once_attr 'inner_map'\n                            fi\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                lookup|getnext|delete)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            _bpftool_get_map_ids\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_get_map_names\n                            return 0\n                            ;;\n                        key)\n                            COMPREPLY+=( $( compgen -W 'hex' -- \"$cur\" ) )\n                            ;;\n                        *)\n                            case $(_bpftool_map_guess_map_type) in\n                                queue|stack)\n                                    return 0\n                                    ;;\n                            esac\n\n                            _bpftool_once_attr 'key'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                update|push|enqueue)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            _bpftool_map_update_get_id $command\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_map_update_get_name $command\n                            return 0\n                            ;;\n                        key)\n                            COMPREPLY+=( $( compgen -W 'hex' -- \"$cur\" ) )\n                            ;;\n                        value)\n                            # We can have bytes, or references to a prog or a\n                            # map, depending on the type of the map to update.\n                            case \"$(_bpftool_map_guess_map_type)\" in\n                                array_of_maps|hash_of_maps)\n                                    local MAP_TYPE='id pinned name'\n                                    COMPREPLY+=( $( compgen -W \"$MAP_TYPE\" \\\n                                        -- \"$cur\" ) )\n                                    return 0\n                                    ;;\n                                prog_array)\n                                    local PROG_TYPE='id pinned tag name'\n                                    COMPREPLY+=( $( compgen -W \"$PROG_TYPE\" \\\n                                        -- \"$cur\" ) )\n                                    return 0\n                                    ;;\n                                *)\n                                    COMPREPLY+=( $( compgen -W 'hex' \\\n                                        -- \"$cur\" ) )\n                                    return 0\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        *)\n                            case $(_bpftool_map_guess_map_type) in\n                                queue|stack)\n                                    _bpftool_once_attr 'value'\n                                    return 0;\n                                    ;;\n                            esac\n\n                            _bpftool_once_attr 'key'\n                            local UPDATE_FLAGS='any exist noexist'\n                            for (( idx=3; idx < ${#words[@]}-1; idx++ )); do\n                                if [[ ${words[idx]} == 'value' ]]; then\n                                    # 'value' is present, but is not the last\n                                    # word i.e. we can now have UPDATE_FLAGS.\n                                    _bpftool_one_of_list \"$UPDATE_FLAGS\"\n                                    return 0\n                                fi\n                            done\n                            for (( idx=3; idx < ${#words[@]}-1; idx++ )); do\n                                if [[ ${words[idx]} == 'key' ]]; then\n                                    # 'key' is present, but is not the last\n                                    # word i.e. we can now have 'value'.\n                                    _bpftool_once_attr 'value'\n                                    return 0\n                                fi\n                            done\n\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                pin)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            ;;\n                        id)\n                            _bpftool_get_map_ids\n                            ;;\n                        name)\n                            _bpftool_get_map_names\n                            ;;\n                    esac\n                    return 0\n                    ;;\n                event_pipe)\n                    case $prev in\n                        $command)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            _bpftool_get_map_ids_for_type perf_event_array\n                            return 0\n                            ;;\n                        name)\n                            _bpftool_get_map_names_for_type perf_event_array\n                            return 0\n                            ;;\n                        cpu)\n                            return 0\n                            ;;\n                        index)\n                            return 0\n                            ;;\n                        *)\n                            _bpftool_once_attr 'cpu index'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'delete dump getnext help \\\n                            lookup pin event_pipe show list update create \\\n                            peek push enqueue pop dequeue freeze' -- \\\n                            \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        btf)\n            local PROG_TYPE='id pinned tag name'\n            local MAP_TYPE='id pinned name'\n            case $command in\n                dump)\n                    case $prev in\n                        $command)\n                            COMPREPLY+=( $( compgen -W \"id map prog file\" -- \\\n                                \"$cur\" ) )\n                            return 0\n                            ;;\n                        prog)\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        map)\n                            COMPREPLY=( $( compgen -W \"$MAP_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        id)\n                            case $pprev in\n                                prog)\n                                    _bpftool_get_prog_ids\n                                    ;;\n                                map)\n                                    _bpftool_get_map_ids\n                                    ;;\n                                $command)\n                                    _bpftool_get_btf_ids\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        name)\n                            case $pprev in\n                                prog)\n                                    _bpftool_get_prog_names\n                                    ;;\n                                map)\n                                    _bpftool_get_map_names\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        format)\n                            COMPREPLY=( $( compgen -W \"c raw\" -- \"$cur\" ) )\n                            ;;\n                        *)\n                            # emit extra options\n                            case ${words[3]} in\n                                id|file)\n                                    _bpftool_once_attr 'format'\n                                    ;;\n                                map|prog)\n                                    if [[ ${words[3]} == \"map\" ]] && [[ $cword == 6 ]]; then\n                                        COMPREPLY+=( $( compgen -W \"key value kv all\" -- \"$cur\" ) )\n                                    fi\n                                    _bpftool_once_attr 'format'\n                                    ;;\n                                *)\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                show|list)\n                    case $prev in\n                        $command)\n                            COMPREPLY+=( $( compgen -W \"id\" -- \"$cur\" ) )\n                            ;;\n                        id)\n                            _bpftool_get_btf_ids\n                            ;;\n                    esac\n                    return 0\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'dump help show list' \\\n                            -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        gen)\n            case $command in\n                object)\n                    _filedir\n                    return 0\n                    ;;\n                skeleton)\n                    case $prev in\n                        $command)\n                            _filedir\n                            return 0\n                            ;;\n                        *)\n                            _bpftool_once_attr 'name'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                subskeleton)\n                    case $prev in\n                        $command)\n                            _filedir\n                            return 0\n                            ;;\n                        *)\n                            _bpftool_once_attr 'name'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                min_core_btf)\n                    _filedir\n                    return 0\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'object skeleton subskeleton help min_core_btf' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        cgroup)\n            case $command in\n                show|list|tree)\n                    case $cword in\n                        3)\n                            _filedir\n                            ;;\n                        4)\n                            COMPREPLY=( $( compgen -W 'effective' -- \"$cur\" ) )\n                            ;;\n                    esac\n                    return 0\n                    ;;\n                attach|detach)\n                    local BPFTOOL_CGROUP_ATTACH_TYPES=\"$(bpftool feature list_builtins attach_types 2>/dev/null | \\\n                        grep '^cgroup_')\"\n                    local ATTACH_FLAGS='multi override'\n                    local PROG_TYPE='id pinned tag name'\n                    # Check for $prev = $command first\n                    if [ $prev = $command ]; then\n                        _filedir\n                        return 0\n                    # Then check for attach type. This is done outside of the\n                    # \"case $prev in\" to avoid writing the whole list of attach\n                    # types again as pattern to match (where we cannot reuse\n                    # our variable).\n                    elif [[ $BPFTOOL_CGROUP_ATTACH_TYPES =~ $prev ]]; then\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \\\n                                \"$cur\" ) )\n                            return 0\n                    fi\n                    # case/esac for the other cases\n                    case $prev in\n                        id)\n                            _bpftool_get_prog_ids\n                            return 0\n                            ;;\n                        *)\n                            if ! _bpftool_search_list \"$BPFTOOL_CGROUP_ATTACH_TYPES\"; then\n                                COMPREPLY=( $( compgen -W \\\n                                    \"$BPFTOOL_CGROUP_ATTACH_TYPES\" -- \"$cur\" ) )\n                            elif [[ \"$command\" == \"attach\" ]]; then\n                                # We have an attach type on the command line,\n                                # but it is not the previous word, or\n                                # \"id|pinned|tag|name\" (we already checked for\n                                # that). This should only leave the case when\n                                # we need attach flags for \"attach\" commamnd.\n                                _bpftool_one_of_list \"$ATTACH_FLAGS\"\n                            fi\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'help attach detach \\\n                            show list tree' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        perf)\n            case $command in\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'help \\\n                            show list' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        net)\n            local PROG_TYPE='id pinned tag name'\n            local ATTACH_TYPES='xdp xdpgeneric xdpdrv xdpoffload'\n            case $command in\n                show|list)\n                    [[ $prev != \"$command\" ]] && return 0\n                    COMPREPLY=( $( compgen -W 'dev' -- \"$cur\" ) )\n                    return 0\n                    ;;\n                attach)\n                    case $cword in\n                        3)\n                            COMPREPLY=( $( compgen -W \"$ATTACH_TYPES\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        4)\n                            COMPREPLY=( $( compgen -W \"$PROG_TYPE\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        5)\n                            case $prev in\n                                id)\n                                    _bpftool_get_prog_ids\n                                    ;;\n                                name)\n                                    _bpftool_get_prog_names\n                                    ;;\n                                pinned)\n                                    _filedir\n                                    ;;\n                            esac\n                            return 0\n                            ;;\n                        6)\n                            COMPREPLY=( $( compgen -W 'dev' -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        8)\n                            _bpftool_once_attr 'overwrite'\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                detach)\n                    case $cword in\n                        3)\n                            COMPREPLY=( $( compgen -W \"$ATTACH_TYPES\" -- \"$cur\" ) )\n                            return 0\n                            ;;\n                        4)\n                            COMPREPLY=( $( compgen -W 'dev' -- \"$cur\" ) )\n                            return 0\n                            ;;\n                    esac\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'help \\\n                            show list attach detach' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        feature)\n            case $command in\n                probe)\n                    [[ $prev == \"prefix\" ]] && return 0\n                    if _bpftool_search_list 'macros'; then\n                        _bpftool_once_attr 'prefix'\n                    else\n                        COMPREPLY+=( $( compgen -W 'macros' -- \"$cur\" ) )\n                    fi\n                    _bpftool_one_of_list 'kernel dev'\n                    _bpftool_once_attr 'full unprivileged'\n                    return 0\n                    ;;\n                list_builtins)\n                    [[ $prev != \"$command\" ]] && return 0\n                    COMPREPLY=( $( compgen -W 'prog_types map_types \\\n                        attach_types link_types helpers' -- \"$cur\" ) )\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'help list_builtins probe' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n        link)\n            case $command in\n                show|list|pin|detach)\n                    case $prev in\n                        id)\n                            _bpftool_get_link_ids\n                            return 0\n                            ;;\n                    esac\n                    ;;\n            esac\n\n            local LINK_TYPE='id pinned'\n            case $command in\n                show|list)\n                    [[ $prev != \"$command\" ]] && return 0\n                    COMPREPLY=( $( compgen -W \"$LINK_TYPE\" -- \"$cur\" ) )\n                    return 0\n                    ;;\n                pin|detach)\n                    if [[ $prev == \"$command\" ]]; then\n                        COMPREPLY=( $( compgen -W \"$LINK_TYPE\" -- \"$cur\" ) )\n                    else\n                        _filedir\n                    fi\n                    return 0\n                    ;;\n                *)\n                    [[ $prev == $object ]] && \\\n                        COMPREPLY=( $( compgen -W 'help pin show list' -- \"$cur\" ) )\n                    ;;\n            esac\n            ;;\n    esac\n} &&\ncomplete -F _bpftool bpftool\n\n# ex: ts=4 sw=4 et filetype=sh\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}