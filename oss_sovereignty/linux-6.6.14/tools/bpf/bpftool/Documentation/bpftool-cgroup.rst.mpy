{
  "module_name": "bpftool-cgroup.rst",
  "hash_id": "6232db73ea2d5a29286c913bce98411d04674f0e58c97d59629b3ad0e0238b56",
  "original_prompt": "Ingested from linux-6.6.14/tools/bpf/bpftool/Documentation/bpftool-cgroup.rst",
  "human_readable_source": ".. SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)\n\n================\nbpftool-cgroup\n================\n-------------------------------------------------------------------------------\ntool for inspection and simple manipulation of eBPF progs\n-------------------------------------------------------------------------------\n\n:Manual section: 8\n\n.. include:: substitutions.rst\n\nSYNOPSIS\n========\n\n\t**bpftool** [*OPTIONS*] **cgroup** *COMMAND*\n\n\t*OPTIONS* := { |COMMON_OPTIONS| | { **-f** | **--bpffs** } }\n\n\t*COMMANDS* :=\n\t{ **show** | **list** | **tree** | **attach** | **detach** | **help** }\n\nCGROUP COMMANDS\n===============\n\n|\t**bpftool** **cgroup** { **show** | **list** } *CGROUP* [**effective**]\n|\t**bpftool** **cgroup tree** [*CGROUP_ROOT*] [**effective**]\n|\t**bpftool** **cgroup attach** *CGROUP* *ATTACH_TYPE* *PROG* [*ATTACH_FLAGS*]\n|\t**bpftool** **cgroup detach** *CGROUP* *ATTACH_TYPE* *PROG*\n|\t**bpftool** **cgroup help**\n|\n|\t*PROG* := { **id** *PROG_ID* | **pinned** *FILE* | **tag** *PROG_TAG* }\n|\t*ATTACH_TYPE* := { **cgroup_inet_ingress** | **cgroup_inet_egress** |\n|\t\t**cgroup_inet_sock_create** | **cgroup_sock_ops** |\n|\t\t**cgroup_device** | **cgroup_inet4_bind** | **cgroup_inet6_bind** |\n|\t\t**cgroup_inet4_post_bind** | **cgroup_inet6_post_bind** |\n|\t\t**cgroup_inet4_connect** | **cgroup_inet6_connect** |\n|\t\t**cgroup_inet4_getpeername** | **cgroup_inet6_getpeername** |\n|\t\t**cgroup_inet4_getsockname** | **cgroup_inet6_getsockname** |\n|\t\t**cgroup_udp4_sendmsg** | **cgroup_udp6_sendmsg** |\n|\t\t**cgroup_udp4_recvmsg** | **cgroup_udp6_recvmsg** |\n|\t\t**cgroup_sysctl** | **cgroup_getsockopt** | **cgroup_setsockopt** |\n|\t\t**cgroup_inet_sock_release** }\n|\t*ATTACH_FLAGS* := { **multi** | **override** }\n\nDESCRIPTION\n===========\n\t**bpftool cgroup { show | list }** *CGROUP* [**effective**]\n\t\t  List all programs attached to the cgroup *CGROUP*.\n\n\t\t  Output will start with program ID followed by attach type,\n\t\t  attach flags and program name.\n\n\t\t  If **effective** is specified retrieve effective programs that\n\t\t  will execute for events within a cgroup. This includes\n\t\t  inherited along with attached ones.\n\n\t**bpftool cgroup tree** [*CGROUP_ROOT*] [**effective**]\n\t\t  Iterate over all cgroups in *CGROUP_ROOT* and list all\n\t\t  attached programs. If *CGROUP_ROOT* is not specified,\n\t\t  bpftool uses cgroup v2 mountpoint.\n\n\t\t  The output is similar to the output of cgroup show/list\n\t\t  commands: it starts with absolute cgroup path, followed by\n\t\t  program ID, attach type, attach flags and program name.\n\n\t\t  If **effective** is specified retrieve effective programs that\n\t\t  will execute for events within a cgroup. This includes\n\t\t  inherited along with attached ones.\n\n\t**bpftool cgroup attach** *CGROUP* *ATTACH_TYPE* *PROG* [*ATTACH_FLAGS*]\n\t\t  Attach program *PROG* to the cgroup *CGROUP* with attach type\n\t\t  *ATTACH_TYPE* and optional *ATTACH_FLAGS*.\n\n\t\t  *ATTACH_FLAGS* can be one of: **override** if a sub-cgroup installs\n\t\t  some bpf program, the program in this cgroup yields to sub-cgroup\n\t\t  program; **multi** if a sub-cgroup installs some bpf program,\n\t\t  that cgroup program gets run in addition to the program in this\n\t\t  cgroup.\n\n\t\t  Only one program is allowed to be attached to a cgroup with\n\t\t  no attach flags or the **override** flag. Attaching another\n\t\t  program will release old program and attach the new one.\n\n\t\t  Multiple programs are allowed to be attached to a cgroup with\n\t\t  **multi**. They are executed in FIFO order (those that were\n\t\t  attached first, run first).\n\n\t\t  Non-default *ATTACH_FLAGS* are supported by kernel version 4.14\n\t\t  and later.\n\n\t\t  *ATTACH_TYPE* can be on of:\n\t\t  **ingress** ingress path of the inet socket (since 4.10);\n\t\t  **egress** egress path of the inet socket (since 4.10);\n\t\t  **sock_create** opening of an inet socket (since 4.10);\n\t\t  **sock_ops** various socket operations (since 4.12);\n\t\t  **device** device access (since 4.15);\n\t\t  **bind4** call to bind(2) for an inet4 socket (since 4.17);\n\t\t  **bind6** call to bind(2) for an inet6 socket (since 4.17);\n\t\t  **post_bind4** return from bind(2) for an inet4 socket (since 4.17);\n\t\t  **post_bind6** return from bind(2) for an inet6 socket (since 4.17);\n\t\t  **connect4** call to connect(2) for an inet4 socket (since 4.17);\n\t\t  **connect6** call to connect(2) for an inet6 socket (since 4.17);\n\t\t  **sendmsg4** call to sendto(2), sendmsg(2), sendmmsg(2) for an\n\t\t  unconnected udp4 socket (since 4.18);\n\t\t  **sendmsg6** call to sendto(2), sendmsg(2), sendmmsg(2) for an\n\t\t  unconnected udp6 socket (since 4.18);\n\t\t  **recvmsg4** call to recvfrom(2), recvmsg(2), recvmmsg(2) for\n\t\t  an unconnected udp4 socket (since 5.2);\n\t\t  **recvmsg6** call to recvfrom(2), recvmsg(2), recvmmsg(2) for\n\t\t  an unconnected udp6 socket (since 5.2);\n\t\t  **sysctl** sysctl access (since 5.2);\n\t\t  **getsockopt** call to getsockopt (since 5.3);\n\t\t  **setsockopt** call to setsockopt (since 5.3);\n\t\t  **getpeername4** call to getpeername(2) for an inet4 socket (since 5.8);\n\t\t  **getpeername6** call to getpeername(2) for an inet6 socket (since 5.8);\n\t\t  **getsockname4** call to getsockname(2) for an inet4 socket (since 5.8);\n\t\t  **getsockname6** call to getsockname(2) for an inet6 socket (since 5.8).\n\t\t  **sock_release** closing an userspace inet socket (since 5.9).\n\n\t**bpftool cgroup detach** *CGROUP* *ATTACH_TYPE* *PROG*\n\t\t  Detach *PROG* from the cgroup *CGROUP* and attach type\n\t\t  *ATTACH_TYPE*.\n\n\t**bpftool prog help**\n\t\t  Print short help message.\n\nOPTIONS\n=======\n\t.. include:: common_options.rst\n\n\t-f, --bpffs\n\t\t  Show file names of pinned programs.\n\nEXAMPLES\n========\n|\n| **# mount -t bpf none /sys/fs/bpf/**\n| **# mkdir /sys/fs/cgroup/test.slice**\n| **# bpftool prog load ./device_cgroup.o /sys/fs/bpf/prog**\n| **# bpftool cgroup attach /sys/fs/cgroup/test.slice/ device id 1 allow_multi**\n\n**# bpftool cgroup list /sys/fs/cgroup/test.slice/**\n\n::\n\n    ID       AttachType      AttachFlags     Name\n    1        device          allow_multi     bpf_prog1\n\n|\n| **# bpftool cgroup detach /sys/fs/cgroup/test.slice/ device id 1**\n| **# bpftool cgroup list /sys/fs/cgroup/test.slice/**\n\n::\n\n    ID       AttachType      AttachFlags     Name\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}