{
  "module_name": "bpftool-net.rst",
  "hash_id": "3725dcfbaa700229a47d46ebb9a8cb100f3c757f4c672b1eb9757fe60d294b23",
  "original_prompt": "Ingested from linux-6.6.14/tools/bpf/bpftool/Documentation/bpftool-net.rst",
  "human_readable_source": ".. SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)\n\n================\nbpftool-net\n================\n-------------------------------------------------------------------------------\ntool for inspection of networking related bpf prog attachments\n-------------------------------------------------------------------------------\n\n:Manual section: 8\n\n.. include:: substitutions.rst\n\nSYNOPSIS\n========\n\n\t**bpftool** [*OPTIONS*] **net** *COMMAND*\n\n\t*OPTIONS* := { |COMMON_OPTIONS| }\n\n\t*COMMANDS* :=\n\t{ **show** | **list** | **attach** | **detach** | **help** }\n\nNET COMMANDS\n============\n\n|\t**bpftool** **net** { **show** | **list** } [ **dev** *NAME* ]\n|\t**bpftool** **net attach** *ATTACH_TYPE* *PROG* **dev** *NAME* [ **overwrite** ]\n|\t**bpftool** **net detach** *ATTACH_TYPE* **dev** *NAME*\n|\t**bpftool** **net help**\n|\n|\t*PROG* := { **id** *PROG_ID* | **pinned** *FILE* | **tag** *PROG_TAG* }\n|\t*ATTACH_TYPE* := { **xdp** | **xdpgeneric** | **xdpdrv** | **xdpoffload** }\n\nDESCRIPTION\n===========\n\t**bpftool net { show | list }** [ **dev** *NAME* ]\n\t\t  List bpf program attachments in the kernel networking subsystem.\n\n\t\t  Currently, device driver xdp attachments, tcx and old-style tc\n\t\t  classifier/action attachments, flow_dissector as well as netfilter\n\t\t  attachments are implemented, i.e., for\n\t\t  program types **BPF_PROG_TYPE_XDP**, **BPF_PROG_TYPE_SCHED_CLS**,\n\t\t  **BPF_PROG_TYPE_SCHED_ACT**, **BPF_PROG_TYPE_FLOW_DISSECTOR**,\n\t\t  **BPF_PROG_TYPE_NETFILTER**.\n\n\t\t  For programs attached to a particular cgroup, e.g.,\n\t\t  **BPF_PROG_TYPE_CGROUP_SKB**, **BPF_PROG_TYPE_CGROUP_SOCK**,\n\t\t  **BPF_PROG_TYPE_SOCK_OPS** and **BPF_PROG_TYPE_CGROUP_SOCK_ADDR**,\n\t\t  users can use **bpftool cgroup** to dump cgroup attachments.\n\t\t  For sk_{filter, skb, msg, reuseport} and lwt/seg6\n\t\t  bpf programs, users should consult other tools, e.g., iproute2.\n\n\t\t  The current output will start with all xdp program attachments, followed by\n\t\t  all tcx, then tc class/qdisc bpf program attachments, then flow_dissector\n\t\t  and finally netfilter programs. Both xdp programs and tcx/tc programs are\n\t\t  ordered based on ifindex number. If multiple bpf programs attached\n\t\t  to the same networking device through **tc**, the order will be first\n\t\t  all bpf programs attached to tcx, then tc classes, then all bpf programs\n\t\t  attached to non clsact qdiscs, and finally all bpf programs attached\n\t\t  to root and clsact qdisc.\n\n\t**bpftool** **net attach** *ATTACH_TYPE* *PROG* **dev** *NAME* [ **overwrite** ]\n\t\t  Attach bpf program *PROG* to network interface *NAME* with\n\t\t  type specified by *ATTACH_TYPE*. Previously attached bpf program\n\t\t  can be replaced by the command used with **overwrite** option.\n\t\t  Currently, only XDP-related modes are supported for *ATTACH_TYPE*.\n\n\t\t  *ATTACH_TYPE* can be of:\n\t\t  **xdp** - try native XDP and fallback to generic XDP if NIC driver does not support it;\n\t\t  **xdpgeneric** - Generic XDP. runs at generic XDP hook when packet already enters receive path as skb;\n\t\t  **xdpdrv** - Native XDP. runs earliest point in driver's receive path;\n\t\t  **xdpoffload** - Offload XDP. runs directly on NIC on each packet reception;\n\n\t**bpftool** **net detach** *ATTACH_TYPE* **dev** *NAME*\n\t\t  Detach bpf program attached to network interface *NAME* with\n\t\t  type specified by *ATTACH_TYPE*. To detach bpf program, same\n\t\t  *ATTACH_TYPE* previously used for attach must be specified.\n\t\t  Currently, only XDP-related modes are supported for *ATTACH_TYPE*.\n\n\t**bpftool net help**\n\t\t  Print short help message.\n\nOPTIONS\n=======\n\t.. include:: common_options.rst\n\nEXAMPLES\n========\n\n| **# bpftool net**\n\n::\n\n      xdp:\n      eth0(2) driver id 198\n\n      tc:\n      eth0(2) htb name prefix_matcher.o:[cls_prefix_matcher_htb] id 111727 act []\n      eth0(2) clsact/ingress fbflow_icmp id 130246 act []\n      eth0(2) clsact/egress prefix_matcher.o:[cls_prefix_matcher_clsact] id 111726\n      eth0(2) clsact/egress cls_fg_dscp id 108619 act []\n      eth0(2) clsact/egress fbflow_egress id 130245\n\n|\n| **# bpftool -jp net**\n\n::\n\n    [{\n            \"xdp\": [{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"mode\": \"driver\",\n                    \"id\": 198\n                }\n            ],\n            \"tc\": [{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"kind\": \"htb\",\n                    \"name\": \"prefix_matcher.o:[cls_prefix_matcher_htb]\",\n                    \"id\": 111727,\n                    \"act\": []\n                },{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"kind\": \"clsact/ingress\",\n                    \"name\": \"fbflow_icmp\",\n                    \"id\": 130246,\n                    \"act\": []\n                },{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"kind\": \"clsact/egress\",\n                    \"name\": \"prefix_matcher.o:[cls_prefix_matcher_clsact]\",\n                    \"id\": 111726,\n                },{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"kind\": \"clsact/egress\",\n                    \"name\": \"cls_fg_dscp\",\n                    \"id\": 108619,\n                    \"act\": []\n                },{\n                    \"devname\": \"eth0\",\n                    \"ifindex\": 2,\n                    \"kind\": \"clsact/egress\",\n                    \"name\": \"fbflow_egress\",\n                    \"id\": 130245,\n                }\n            ]\n        }\n    ]\n\n|\n| **# bpftool net attach xdpdrv id 16 dev enp6s0np0**\n| **# bpftool net**\n\n::\n\n      xdp:\n      enp6s0np0(4) driver id 16\n\n|\n| **# bpftool net attach xdpdrv id 16 dev enp6s0np0**\n| **# bpftool net attach xdpdrv id 20 dev enp6s0np0 overwrite**\n| **# bpftool net**\n\n::\n\n      xdp:\n      enp6s0np0(4) driver id 20\n\n|\n| **# bpftool net attach xdpdrv id 16 dev enp6s0np0**\n| **# bpftool net detach xdpdrv dev enp6s0np0**\n| **# bpftool net**\n\n::\n\n      xdp:\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}