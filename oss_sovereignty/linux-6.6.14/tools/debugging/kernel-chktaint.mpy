{
  "module_name": "kernel-chktaint",
  "hash_id": "4a4bc95aa08740e4be32293491f95f698b49d450e4dba54684f74dcd79694404",
  "original_prompt": "Ingested from linux-6.6.14/tools/debugging/kernel-chktaint",
  "human_readable_source": "#! /bin/sh\n# SPDX-License-Identifier: GPL-2.0\n#\n# Randy Dunlap <rdunlap@infradead.org>, 2018\n# Thorsten Leemhuis <linux@leemhuis.info>, 2018\n\nusage()\n{\n\tcat <<EOF\nusage: ${0##*/}\n       ${0##*/} <int>\n\nCall without parameters to decode /proc/sys/kernel/tainted.\n\nCall with a positive integer as parameter to decode a value you\nretrieved from /proc/sys/kernel/tainted on another system.\n\nEOF\n}\n\nif [ \"$1\"x != \"x\" ]; then\n\tif  [ \"$1\"x == \"--helpx\" ] || [ \"$1\"x == \"-hx\" ] ; then\n\t\tusage\n\t\texit 1\n\telif  [ $1 -ge 0 ] 2>/dev/null ; then\n\t\ttaint=$1\n\telse\n\t\techo \"Error: Parameter '$1' not a positive integer. Aborting.\" >&2\n\t\texit 1\n\tfi\nelse\n\tTAINTFILE=\"/proc/sys/kernel/tainted\"\n\tif [ ! -r $TAINTFILE ]; then\n\t\techo \"No file: $TAINTFILE\"\n\t\texit\n\tfi\n\n\ttaint=`cat $TAINTFILE`\nfi\n\nif [ $taint -eq 0 ]; then\n\techo \"Kernel not Tainted\"\n\texit\nelse\n\techo \"Kernel is \\\"tainted\\\" for the following reasons:\"\nfi\n\nT=$taint\nout=\n\naddout() {\n\tout=$out$1\n}\n\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \"G\"\nelse\n\taddout \"P\"\n\techo \" * proprietary module was loaded (#0)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"F\"\n\techo \" * module was force loaded (#1)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"S\"\n\techo \" * kernel running on an out of specification system (#2)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"R\"\n\techo \" * module was force unloaded (#3)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"M\"\n\techo \" * processor reported a Machine Check Exception (MCE) (#4)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"B\"\n\techo \" * bad page referenced or some unexpected page flags (#5)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"U\"\n\techo \" * taint requested by userspace application (#6)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"D\"\n\techo \" * kernel died recently, i.e. there was an OOPS or BUG (#7)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"A\"\n\techo \" * an ACPI table was overridden by user (#8)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"W\"\n\techo \" * kernel issued warning (#9)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"C\"\n\techo \" * staging driver was loaded (#10)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"I\"\n\techo \" * workaround for bug in platform firmware applied (#11)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"O\"\n\techo \" * externally-built ('out-of-tree') module was loaded  (#12)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"E\"\n\techo \" * unsigned module was loaded (#13)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"L\"\n\techo \" * soft lockup occurred (#14)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"K\"\n\techo \" * kernel has been live patched (#15)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"X\"\n\techo \" * auxiliary taint, defined for and used by distros (#16)\"\n\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"T\"\n\techo \" * kernel was built with the struct randomization plugin (#17)\"\nfi\n\nT=`expr $T / 2`\nif [ `expr $T % 2` -eq 0 ]; then\n\taddout \" \"\nelse\n\taddout \"N\"\n\techo \" * an in-kernel test (such as a KUnit test) has been run (#18)\"\nfi\n\necho \"For a more detailed explanation of the various taint flags see\"\necho \" Documentation/admin-guide/tainted-kernels.rst in the Linux kernel sources\"\necho \" or https://kernel.org/doc/html/latest/admin-guide/tainted-kernels.html\"\necho \"Raw taint value as int/string: $taint/'$out'\"\n#EOF#\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}