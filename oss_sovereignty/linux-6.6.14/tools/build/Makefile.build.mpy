{
  "module_name": "Makefile.build",
  "hash_id": "539944be5adb6bd2ce778bc1eae3a25e6c9b475239c372bd195252a13d04b07b",
  "original_prompt": "Ingested from linux-6.6.14/tools/build/Makefile.build",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\n###\n# Main build makefile.\n#\n#  Lots of this code have been borrowed or heavily inspired from parts\n#  of kbuild code, which is not credited, but mostly developed by:\n#\n#  Copyright (C) Sam Ravnborg <sam@mars.ravnborg.org>, 2015\n#  Copyright (C) Linus Torvalds <torvalds@linux-foundation.org>, 2015\n#\n\nPHONY := __build\n__build:\n\nifeq ($(V),1)\n  quiet =\n  Q =\nelse\n  quiet=quiet_\n  Q=@\nendif\n\nifneq ($(findstring s,$(filter-out --%,$(MAKEFLAGS))),)\n  quiet=silent_\nendif\n\nbuild-dir := $(srctree)/tools/build\n\n# Define $(fixdep) for dep-cmd function\nifeq ($(OUTPUT),)\n  fixdep := $(build-dir)/fixdep\nelse\n  fixdep := $(OUTPUT)/fixdep\nendif\n\n# Generic definitions\ninclude $(build-dir)/Build.include\n\n# do not force detected configuration\n-include $(OUTPUT).config-detected\n\n# Init all relevant variables used in build files so\n# 1) they have correct type\n# 2) they do not inherit any value from the environment\nsubdir-y     :=\nobj-y        :=\nsubdir-y     :=\nsubdir-obj-y :=\n\n# Build definitions\nbuild-file := $(dir)/Build\n-include $(build-file)\n\nquiet_cmd_flex  = FLEX    $@\nquiet_cmd_bison = BISON   $@\nquiet_cmd_test  = TEST    $@\n\n# Create directory unless it exists\nquiet_cmd_mkdir = MKDIR   $(dir $@)\n      cmd_mkdir = mkdir -p $(dir $@)\n     rule_mkdir = $(if $(wildcard $(dir $@)),,@$(call echo-cmd,mkdir) $(cmd_mkdir))\n\n# Compile command\nquiet_cmd_cc_o_c = CC      $@\n      cmd_cc_o_c = $(CC) $(c_flags) -c -o $@ $<\n\nquiet_cmd_host_cc_o_c = HOSTCC  $@\n      cmd_host_cc_o_c = $(HOSTCC) $(host_c_flags) -c -o $@ $<\n\nquiet_cmd_cxx_o_c = CXX     $@\n      cmd_cxx_o_c = $(CXX) $(cxx_flags) -c -o $@ $<\n\nquiet_cmd_cpp_i_c = CPP     $@\n      cmd_cpp_i_c = $(CC) $(c_flags) -E -o $@ $<\n\nquiet_cmd_cc_s_c = AS      $@\n      cmd_cc_s_c = $(CC) $(c_flags) -S -o $@ $<\n\nquiet_cmd_gen = GEN     $@\n\n# Link agregate command\n# If there's nothing to link, create empty $@ object.\nquiet_cmd_ld_multi = LD      $@\n      cmd_ld_multi = $(if $(strip $(obj-y)),\\\n                     $(LD) -r -o $@  $(filter $(obj-y),$^),rm -f $@; $(AR) rcs $@)\n\nquiet_cmd_host_ld_multi = HOSTLD  $@\n      cmd_host_ld_multi = $(if $(strip $(obj-y)),\\\n                          $(HOSTLD) -r -o $@  $(filter $(obj-y),$^),rm -f $@; $(HOSTAR) rcs $@)\n\nifneq ($(filter $(obj),$(hostprogs)),)\n  host = host_\nendif\n\n# Build rules\n$(OUTPUT)%.o: %.c FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,$(host)cc_o_c)\n\n$(OUTPUT)%.o: %.cpp FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,cxx_o_c)\n\n$(OUTPUT)%.o: %.S FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,$(host)cc_o_c)\n\n$(OUTPUT)%.i: %.c FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,cpp_i_c)\n\n$(OUTPUT)%.s: %.S FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,cpp_i_c)\n\n$(OUTPUT)%.s: %.c FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,cc_s_c)\n\n# bison and flex files are generated in the OUTPUT directory\n# so it needs a separate rule to depend on them properly\n$(OUTPUT)%-bison.o: $(OUTPUT)%-bison.c FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,$(host)cc_o_c)\n\n$(OUTPUT)%-flex.o: $(OUTPUT)%-flex.c FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed_dep,$(host)cc_o_c)\n\n# Gather build data:\n#   obj-y        - list of build objects\n#   subdir-y     - list of directories to nest\n#   subdir-obj-y - list of directories objects 'dir/$(obj)-in.o'\nobj-y        := $($(obj)-y)\nsubdir-y     := $(patsubst %/,%,$(filter %/, $(obj-y)))\nobj-y        := $(patsubst %/, %/$(obj)-in.o, $(obj-y))\nsubdir-obj-y := $(filter %/$(obj)-in.o, $(obj-y))\n\n# '$(OUTPUT)/dir' prefix to all objects\nobjprefix    := $(subst ./,,$(OUTPUT)$(dir)/)\nobj-y        := $(addprefix $(objprefix),$(obj-y))\nsubdir-obj-y := $(addprefix $(objprefix),$(subdir-obj-y))\n\n# Final '$(obj)-in.o' object\nin-target := $(objprefix)$(obj)-in.o\n\nPHONY += $(subdir-y)\n\n$(subdir-y):\n\t$(Q)$(MAKE) -f $(build-dir)/Makefile.build dir=$(dir)/$@ obj=$(obj)\n\n$(sort $(subdir-obj-y)): $(subdir-y) ;\n\n$(in-target): $(obj-y) FORCE\n\t$(call rule_mkdir)\n\t$(call if_changed,$(host)ld_multi)\n\n__build: $(in-target)\n\t@:\n\nPHONY += FORCE\nFORCE:\n\n# Include all cmd files to get all the dependency rules\n# for all objects included\ntargets   := $(wildcard $(sort $(obj-y) $(in-target) $(MAKECMDGOALS)))\ncmd_files := $(wildcard $(foreach f,$(targets),$(dir $(f)).$(notdir $(f)).cmd))\n\nifneq ($(cmd_files),)\n  include $(cmd_files)\nendif\n\n.PHONY: $(PHONY)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}