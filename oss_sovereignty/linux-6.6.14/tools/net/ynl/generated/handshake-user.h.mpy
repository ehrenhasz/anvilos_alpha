{
  "module_name": "handshake-user.h",
  "hash_id": "6ddf0b01dec5ab00f017efbf955b0ba75acb5eb293aa533853e13c9d3d94d6c8",
  "original_prompt": "Ingested from linux-6.6.14/tools/net/ynl/generated/handshake-user.h",
  "human_readable_source": " \n \n \n \n\n#ifndef _LINUX_HANDSHAKE_GEN_H\n#define _LINUX_HANDSHAKE_GEN_H\n\n#include <stdlib.h>\n#include <string.h>\n#include <linux/types.h>\n#include <linux/handshake.h>\n\nstruct ynl_sock;\n\nextern const struct ynl_family ynl_handshake_family;\n\n \nconst char *handshake_op_str(int op);\nconst char *handshake_handler_class_str(enum handshake_handler_class value);\nconst char *handshake_msg_type_str(enum handshake_msg_type value);\nconst char *handshake_auth_str(enum handshake_auth value);\n\n \nstruct handshake_x509 {\n\tstruct {\n\t\t__u32 cert:1;\n\t\t__u32 privkey:1;\n\t} _present;\n\n\t__u32 cert;\n\t__u32 privkey;\n};\n\n \n \nstruct handshake_accept_req {\n\tstruct {\n\t\t__u32 handler_class:1;\n\t} _present;\n\n\tenum handshake_handler_class handler_class;\n};\n\nstatic inline struct handshake_accept_req *handshake_accept_req_alloc(void)\n{\n\treturn calloc(1, sizeof(struct handshake_accept_req));\n}\nvoid handshake_accept_req_free(struct handshake_accept_req *req);\n\nstatic inline void\nhandshake_accept_req_set_handler_class(struct handshake_accept_req *req,\n\t\t\t\t       enum handshake_handler_class handler_class)\n{\n\treq->_present.handler_class = 1;\n\treq->handler_class = handler_class;\n}\n\nstruct handshake_accept_rsp {\n\tstruct {\n\t\t__u32 sockfd:1;\n\t\t__u32 message_type:1;\n\t\t__u32 timeout:1;\n\t\t__u32 auth_mode:1;\n\t\t__u32 peername_len;\n\t} _present;\n\n\t__u32 sockfd;\n\tenum handshake_msg_type message_type;\n\t__u32 timeout;\n\tenum handshake_auth auth_mode;\n\tunsigned int n_peer_identity;\n\t__u32 *peer_identity;\n\tunsigned int n_certificate;\n\tstruct handshake_x509 *certificate;\n\tchar *peername;\n};\n\nvoid handshake_accept_rsp_free(struct handshake_accept_rsp *rsp);\n\n \nstruct handshake_accept_rsp *\nhandshake_accept(struct ynl_sock *ys, struct handshake_accept_req *req);\n\n \nstruct handshake_accept_ntf {\n\t__u16 family;\n\t__u8 cmd;\n\tstruct ynl_ntf_base_type *next;\n\tvoid (*free)(struct handshake_accept_ntf *ntf);\n\tstruct handshake_accept_rsp obj __attribute__ ((aligned (8)));\n};\n\nvoid handshake_accept_ntf_free(struct handshake_accept_ntf *rsp);\n\n \n \nstruct handshake_done_req {\n\tstruct {\n\t\t__u32 status:1;\n\t\t__u32 sockfd:1;\n\t} _present;\n\n\t__u32 status;\n\t__u32 sockfd;\n\tunsigned int n_remote_auth;\n\t__u32 *remote_auth;\n};\n\nstatic inline struct handshake_done_req *handshake_done_req_alloc(void)\n{\n\treturn calloc(1, sizeof(struct handshake_done_req));\n}\nvoid handshake_done_req_free(struct handshake_done_req *req);\n\nstatic inline void\nhandshake_done_req_set_status(struct handshake_done_req *req, __u32 status)\n{\n\treq->_present.status = 1;\n\treq->status = status;\n}\nstatic inline void\nhandshake_done_req_set_sockfd(struct handshake_done_req *req, __u32 sockfd)\n{\n\treq->_present.sockfd = 1;\n\treq->sockfd = sockfd;\n}\nstatic inline void\n__handshake_done_req_set_remote_auth(struct handshake_done_req *req,\n\t\t\t\t     __u32 *remote_auth,\n\t\t\t\t     unsigned int n_remote_auth)\n{\n\tfree(req->remote_auth);\n\treq->remote_auth = remote_auth;\n\treq->n_remote_auth = n_remote_auth;\n}\n\n \nint handshake_done(struct ynl_sock *ys, struct handshake_done_req *req);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}