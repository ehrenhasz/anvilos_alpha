{
  "module_name": "fscrypt.h",
  "hash_id": "2ea69db04a643fe849dbd7dc9b4f330adba330241fa8893239273b48256c938c",
  "original_prompt": "Ingested from linux-6.6.14/tools/include/uapi/linux/fscrypt.h",
  "human_readable_source": " \n \n#ifndef _UAPI_LINUX_FSCRYPT_H\n#define _UAPI_LINUX_FSCRYPT_H\n\n#include <linux/ioctl.h>\n#include <linux/types.h>\n\n \n#define FSCRYPT_POLICY_FLAGS_PAD_4\t\t0x00\n#define FSCRYPT_POLICY_FLAGS_PAD_8\t\t0x01\n#define FSCRYPT_POLICY_FLAGS_PAD_16\t\t0x02\n#define FSCRYPT_POLICY_FLAGS_PAD_32\t\t0x03\n#define FSCRYPT_POLICY_FLAGS_PAD_MASK\t\t0x03\n#define FSCRYPT_POLICY_FLAG_DIRECT_KEY\t\t0x04\n#define FSCRYPT_POLICY_FLAG_IV_INO_LBLK_64\t0x08\n#define FSCRYPT_POLICY_FLAG_IV_INO_LBLK_32\t0x10\n\n \n#define FSCRYPT_MODE_AES_256_XTS\t\t1\n#define FSCRYPT_MODE_AES_256_CTS\t\t4\n#define FSCRYPT_MODE_AES_128_CBC\t\t5\n#define FSCRYPT_MODE_AES_128_CTS\t\t6\n#define FSCRYPT_MODE_SM4_XTS\t\t\t7\n#define FSCRYPT_MODE_SM4_CTS\t\t\t8\n#define FSCRYPT_MODE_ADIANTUM\t\t\t9\n#define FSCRYPT_MODE_AES_256_HCTR2\t\t10\n \n\n \n#define FSCRYPT_POLICY_V1\t\t0\n#define FSCRYPT_KEY_DESCRIPTOR_SIZE\t8\nstruct fscrypt_policy_v1 {\n\t__u8 version;\n\t__u8 contents_encryption_mode;\n\t__u8 filenames_encryption_mode;\n\t__u8 flags;\n\t__u8 master_key_descriptor[FSCRYPT_KEY_DESCRIPTOR_SIZE];\n};\n\n \n#define FSCRYPT_KEY_DESC_PREFIX\t\t\"fscrypt:\"\n#define FSCRYPT_KEY_DESC_PREFIX_SIZE\t8\n#define FSCRYPT_MAX_KEY_SIZE\t\t64\nstruct fscrypt_key {\n\t__u32 mode;\n\t__u8 raw[FSCRYPT_MAX_KEY_SIZE];\n\t__u32 size;\n};\n\n \n#define FSCRYPT_POLICY_V2\t\t2\n#define FSCRYPT_KEY_IDENTIFIER_SIZE\t16\nstruct fscrypt_policy_v2 {\n\t__u8 version;\n\t__u8 contents_encryption_mode;\n\t__u8 filenames_encryption_mode;\n\t__u8 flags;\n\t__u8 __reserved[4];\n\t__u8 master_key_identifier[FSCRYPT_KEY_IDENTIFIER_SIZE];\n};\n\n \nstruct fscrypt_get_policy_ex_arg {\n\t__u64 policy_size;  \n\tunion {\n\t\t__u8 version;\n\t\tstruct fscrypt_policy_v1 v1;\n\t\tstruct fscrypt_policy_v2 v2;\n\t} policy;  \n};\n\n \n#define FSCRYPT_KEY_SPEC_TYPE_DESCRIPTOR\t1\n\n \n#define FSCRYPT_KEY_SPEC_TYPE_IDENTIFIER\t2\n\n \nstruct fscrypt_key_specifier {\n\t__u32 type;\t \n\t__u32 __reserved;\n\tunion {\n\t\t__u8 __reserved[32];  \n\t\t__u8 descriptor[FSCRYPT_KEY_DESCRIPTOR_SIZE];\n\t\t__u8 identifier[FSCRYPT_KEY_IDENTIFIER_SIZE];\n\t} u;\n};\n\n \nstruct fscrypt_provisioning_key_payload {\n\t__u32 type;\n\t__u32 __reserved;\n\t__u8 raw[];\n};\n\n \nstruct fscrypt_add_key_arg {\n\tstruct fscrypt_key_specifier key_spec;\n\t__u32 raw_size;\n\t__u32 key_id;\n\t__u32 __reserved[8];\n\t__u8 raw[];\n};\n\n \nstruct fscrypt_remove_key_arg {\n\tstruct fscrypt_key_specifier key_spec;\n#define FSCRYPT_KEY_REMOVAL_STATUS_FLAG_FILES_BUSY\t0x00000001\n#define FSCRYPT_KEY_REMOVAL_STATUS_FLAG_OTHER_USERS\t0x00000002\n\t__u32 removal_status_flags;\t \n\t__u32 __reserved[5];\n};\n\n \nstruct fscrypt_get_key_status_arg {\n\t \n\tstruct fscrypt_key_specifier key_spec;\n\t__u32 __reserved[6];\n\n\t \n#define FSCRYPT_KEY_STATUS_ABSENT\t\t1\n#define FSCRYPT_KEY_STATUS_PRESENT\t\t2\n#define FSCRYPT_KEY_STATUS_INCOMPLETELY_REMOVED\t3\n\t__u32 status;\n#define FSCRYPT_KEY_STATUS_FLAG_ADDED_BY_SELF   0x00000001\n\t__u32 status_flags;\n\t__u32 user_count;\n\t__u32 __out_reserved[13];\n};\n\n#define FS_IOC_SET_ENCRYPTION_POLICY\t\t_IOR('f', 19, struct fscrypt_policy_v1)\n#define FS_IOC_GET_ENCRYPTION_PWSALT\t\t_IOW('f', 20, __u8[16])\n#define FS_IOC_GET_ENCRYPTION_POLICY\t\t_IOW('f', 21, struct fscrypt_policy_v1)\n#define FS_IOC_GET_ENCRYPTION_POLICY_EX\t\t_IOWR('f', 22, __u8[9])  \n#define FS_IOC_ADD_ENCRYPTION_KEY\t\t_IOWR('f', 23, struct fscrypt_add_key_arg)\n#define FS_IOC_REMOVE_ENCRYPTION_KEY\t\t_IOWR('f', 24, struct fscrypt_remove_key_arg)\n#define FS_IOC_REMOVE_ENCRYPTION_KEY_ALL_USERS\t_IOWR('f', 25, struct fscrypt_remove_key_arg)\n#define FS_IOC_GET_ENCRYPTION_KEY_STATUS\t_IOWR('f', 26, struct fscrypt_get_key_status_arg)\n#define FS_IOC_GET_ENCRYPTION_NONCE\t\t_IOR('f', 27, __u8[16])\n\n \n\n \n#ifndef __KERNEL__\n#define fscrypt_policy\t\t\tfscrypt_policy_v1\n#define FS_KEY_DESCRIPTOR_SIZE\t\tFSCRYPT_KEY_DESCRIPTOR_SIZE\n#define FS_POLICY_FLAGS_PAD_4\t\tFSCRYPT_POLICY_FLAGS_PAD_4\n#define FS_POLICY_FLAGS_PAD_8\t\tFSCRYPT_POLICY_FLAGS_PAD_8\n#define FS_POLICY_FLAGS_PAD_16\t\tFSCRYPT_POLICY_FLAGS_PAD_16\n#define FS_POLICY_FLAGS_PAD_32\t\tFSCRYPT_POLICY_FLAGS_PAD_32\n#define FS_POLICY_FLAGS_PAD_MASK\tFSCRYPT_POLICY_FLAGS_PAD_MASK\n#define FS_POLICY_FLAG_DIRECT_KEY\tFSCRYPT_POLICY_FLAG_DIRECT_KEY\n#define FS_POLICY_FLAGS_VALID\t\t0x07\t \n#define FS_ENCRYPTION_MODE_INVALID\t0\t \n#define FS_ENCRYPTION_MODE_AES_256_XTS\tFSCRYPT_MODE_AES_256_XTS\n#define FS_ENCRYPTION_MODE_AES_256_GCM\t2\t \n#define FS_ENCRYPTION_MODE_AES_256_CBC\t3\t \n#define FS_ENCRYPTION_MODE_AES_256_CTS\tFSCRYPT_MODE_AES_256_CTS\n#define FS_ENCRYPTION_MODE_AES_128_CBC\tFSCRYPT_MODE_AES_128_CBC\n#define FS_ENCRYPTION_MODE_AES_128_CTS\tFSCRYPT_MODE_AES_128_CTS\n#define FS_ENCRYPTION_MODE_ADIANTUM\tFSCRYPT_MODE_ADIANTUM\n#define FS_KEY_DESC_PREFIX\t\tFSCRYPT_KEY_DESC_PREFIX\n#define FS_KEY_DESC_PREFIX_SIZE\t\tFSCRYPT_KEY_DESC_PREFIX_SIZE\n#define FS_MAX_KEY_SIZE\t\t\tFSCRYPT_MAX_KEY_SIZE\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}