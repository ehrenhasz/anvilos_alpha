{
  "module_name": "core.h",
  "hash_id": "78048d1a646daf0ca5b205b0036916416b4fa7ed0a62254a509acf36cc01d63e",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/core.h",
  "human_readable_source": " \n\n#ifndef _TIPC_CORE_H\n#define _TIPC_CORE_H\n\n#include <linux/tipc.h>\n#include <linux/tipc_config.h>\n#include <linux/tipc_netlink.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/timer.h>\n#include <linux/string.h>\n#include <linux/uaccess.h>\n#include <linux/interrupt.h>\n#include <linux/atomic.h>\n#include <linux/netdevice.h>\n#include <linux/in.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/rtnetlink.h>\n#include <linux/etherdevice.h>\n#include <net/netns/generic.h>\n#include <linux/rhashtable.h>\n#include <net/genetlink.h>\n#include <net/netns/hash.h>\n\n#ifdef pr_fmt\n#undef pr_fmt\n#endif\n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\nstruct tipc_node;\nstruct tipc_bearer;\nstruct tipc_bc_base;\nstruct tipc_link;\nstruct tipc_name_table;\nstruct tipc_topsrv;\nstruct tipc_monitor;\n#ifdef CONFIG_TIPC_CRYPTO\nstruct tipc_crypto;\n#endif\n\n#define TIPC_MOD_VER \"2.0.0\"\n\n#define NODE_HTABLE_SIZE       512\n#define MAX_BEARERS\t         3\n#define TIPC_DEF_MON_THRESHOLD  32\n#define NODE_ID_LEN             16\n#define NODE_ID_STR_LEN        (NODE_ID_LEN * 2 + 1)\n\nextern unsigned int tipc_net_id __read_mostly;\nextern int sysctl_tipc_rmem[3] __read_mostly;\nextern int sysctl_tipc_named_timeout __read_mostly;\n\nstruct tipc_net {\n\tu8  node_id[NODE_ID_LEN];\n\tu32 node_addr;\n\tu32 trial_addr;\n\tunsigned long addr_trial_end;\n\tchar node_id_string[NODE_ID_STR_LEN];\n\tint net_id;\n\tint random;\n\tbool legacy_addr_format;\n\n\t \n\tspinlock_t node_list_lock;\n\tstruct hlist_head node_htable[NODE_HTABLE_SIZE];\n\tstruct list_head node_list;\n\tu32 num_nodes;\n\tu32 num_links;\n\n\t \n\tstruct tipc_monitor *monitors[MAX_BEARERS];\n\tint mon_threshold;\n\n\t \n\tstruct tipc_bearer __rcu *bearer_list[MAX_BEARERS + 1];\n\n\t \n\tspinlock_t bclock;\n\tstruct tipc_bc_base *bcbase;\n\tstruct tipc_link *bcl;\n\n\t \n\tstruct rhashtable sk_rht;\n\n\t \n\tspinlock_t nametbl_lock;\n\tstruct name_table *nametbl;\n\n\t \n\tstruct tipc_topsrv *topsrv;\n\tatomic_t subscription_count;\n\n\t \n\tu16 capabilities;\n\n\t \n\tstruct packet_type loopback_pt;\n\n#ifdef CONFIG_TIPC_CRYPTO\n\t \n\tstruct tipc_crypto *crypto_tx;\n#endif\n\t \n\tstruct work_struct work;\n\t \n\tatomic_t wq_count;\n};\n\nstatic inline struct tipc_net *tipc_net(struct net *net)\n{\n\treturn net_generic(net, tipc_net_id);\n}\n\nstatic inline int tipc_netid(struct net *net)\n{\n\treturn tipc_net(net)->net_id;\n}\n\nstatic inline struct list_head *tipc_nodes(struct net *net)\n{\n\treturn &tipc_net(net)->node_list;\n}\n\nstatic inline struct name_table *tipc_name_table(struct net *net)\n{\n\treturn tipc_net(net)->nametbl;\n}\n\nstatic inline struct tipc_topsrv *tipc_topsrv(struct net *net)\n{\n\treturn tipc_net(net)->topsrv;\n}\n\nstatic inline unsigned int tipc_hashfn(u32 addr)\n{\n\treturn addr & (NODE_HTABLE_SIZE - 1);\n}\n\nstatic inline u16 mod(u16 x)\n{\n\treturn x & 0xffffu;\n}\n\nstatic inline int less_eq(u16 left, u16 right)\n{\n\treturn mod(right - left) < 32768u;\n}\n\nstatic inline int more(u16 left, u16 right)\n{\n\treturn !less_eq(left, right);\n}\n\nstatic inline int less(u16 left, u16 right)\n{\n\treturn less_eq(left, right) && (mod(right) != mod(left));\n}\n\nstatic inline int tipc_in_range(u16 val, u16 min, u16 max)\n{\n\treturn !less(val, min) && !more(val, max);\n}\n\nstatic inline u32 tipc_net_hash_mixes(struct net *net, int tn_rand)\n{\n\treturn net_hash_mix(&init_net) ^ net_hash_mix(net) ^ tn_rand;\n}\n\nstatic inline u32 hash128to32(char *bytes)\n{\n\t__be32 *tmp = (__be32 *)bytes;\n\tu32 res;\n\n\tres = ntohl(tmp[0] ^ tmp[1] ^ tmp[2] ^ tmp[3]);\n\tif (likely(res))\n\t\treturn res;\n\treturn  ntohl(tmp[0] | tmp[1] | tmp[2] | tmp[3]);\n}\n\n#ifdef CONFIG_SYSCTL\nint tipc_register_sysctl(void);\nvoid tipc_unregister_sysctl(void);\n#else\n#define tipc_register_sysctl() 0\n#define tipc_unregister_sysctl()\n#endif\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}