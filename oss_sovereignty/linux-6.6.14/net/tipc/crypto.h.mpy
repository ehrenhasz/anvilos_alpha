{
  "module_name": "crypto.h",
  "hash_id": "d4826d61107e53d609304797ea72270692422826dfad4582e8dfab6f73095c10",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/crypto.h",
  "human_readable_source": " \n \n#ifdef CONFIG_TIPC_CRYPTO\n#ifndef _TIPC_CRYPTO_H\n#define _TIPC_CRYPTO_H\n\n#include \"core.h\"\n#include \"node.h\"\n#include \"msg.h\"\n#include \"bearer.h\"\n\n#define TIPC_EVERSION\t\t\t7\n\n \n#define TIPC_AES_GCM_KEY_SIZE_128\t16\n#define TIPC_AES_GCM_KEY_SIZE_192\t24\n#define TIPC_AES_GCM_KEY_SIZE_256\t32\n\n#define TIPC_AES_GCM_SALT_SIZE\t\t4\n#define TIPC_AES_GCM_IV_SIZE\t\t12\n#define TIPC_AES_GCM_TAG_SIZE\t\t16\n\n \nenum {\n\tCLUSTER_KEY = 1,\n\tPER_NODE_KEY = (1 << 1),\n};\n\nextern int sysctl_tipc_max_tfms __read_mostly;\nextern int sysctl_tipc_key_exchange_enabled __read_mostly;\n\n \nstruct tipc_ehdr {\n\tunion {\n\t\tstruct {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\t\t\t__u8\tdestined:1,\n\t\t\t\tuser:4,\n\t\t\t\tversion:3;\n\t\t\t__u8\treserved_1:1,\n\t\t\t\trx_nokey:1,\n\t\t\t\tmaster_key:1,\n\t\t\t\tkeepalive:1,\n\t\t\t\trx_key_active:2,\n\t\t\t\ttx_key:2;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n\t\t\t__u8\tversion:3,\n\t\t\t\tuser:4,\n\t\t\t\tdestined:1;\n\t\t\t__u8\ttx_key:2,\n\t\t\t\trx_key_active:2,\n\t\t\t\tkeepalive:1,\n\t\t\t\tmaster_key:1,\n\t\t\t\trx_nokey:1,\n\t\t\t\treserved_1:1;\n#else\n#error  \"Please fix <asm/byteorder.h>\"\n#endif\n\t\t\t__be16\treserved_2;\n\t\t} __packed;\n\t\t__be32 w0;\n\t};\n\t__be64 seqno;\n\tunion {\n\t\t__be32 addr;\n\t\t__u8 id[NODE_ID_LEN];  \n\t};\n#define EHDR_SIZE\t(offsetof(struct tipc_ehdr, addr) + sizeof(__be32))\n#define EHDR_CFG_SIZE\t(sizeof(struct tipc_ehdr))\n#define EHDR_MIN_SIZE\t(EHDR_SIZE)\n#define EHDR_MAX_SIZE\t(EHDR_CFG_SIZE)\n#define EMSG_OVERHEAD\t(EHDR_SIZE + TIPC_AES_GCM_TAG_SIZE)\n} __packed;\n\nint tipc_crypto_start(struct tipc_crypto **crypto, struct net *net,\n\t\t      struct tipc_node *node);\nvoid tipc_crypto_stop(struct tipc_crypto **crypto);\nvoid tipc_crypto_timeout(struct tipc_crypto *rx);\nint tipc_crypto_xmit(struct net *net, struct sk_buff **skb,\n\t\t     struct tipc_bearer *b, struct tipc_media_addr *dst,\n\t\t     struct tipc_node *__dnode);\nint tipc_crypto_rcv(struct net *net, struct tipc_crypto *rx,\n\t\t    struct sk_buff **skb, struct tipc_bearer *b);\nint tipc_crypto_key_init(struct tipc_crypto *c, struct tipc_aead_key *ukey,\n\t\t\t u8 mode, bool master_key);\nvoid tipc_crypto_key_flush(struct tipc_crypto *c);\nint tipc_crypto_key_distr(struct tipc_crypto *tx, u8 key,\n\t\t\t  struct tipc_node *dest);\nvoid tipc_crypto_msg_rcv(struct net *net, struct sk_buff *skb);\nvoid tipc_crypto_rekeying_sched(struct tipc_crypto *tx, bool changed,\n\t\t\t\tu32 new_intv);\nint tipc_aead_key_validate(struct tipc_aead_key *ukey, struct genl_info *info);\nbool tipc_ehdr_validate(struct sk_buff *skb);\n\nstatic inline u32 msg_key_gen(struct tipc_msg *m)\n{\n\treturn msg_bits(m, 4, 16, 0xffff);\n}\n\nstatic inline void msg_set_key_gen(struct tipc_msg *m, u32 gen)\n{\n\tmsg_set_bits(m, 4, 16, 0xffff, gen);\n}\n\nstatic inline u32 msg_key_mode(struct tipc_msg *m)\n{\n\treturn msg_bits(m, 4, 0, 0xf);\n}\n\nstatic inline void msg_set_key_mode(struct tipc_msg *m, u32 mode)\n{\n\tmsg_set_bits(m, 4, 0, 0xf, mode);\n}\n\n#endif  \n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}