{
  "module_name": "bearer.h",
  "hash_id": "99aa448e55ecddeff10025252556f3a5193f99e6169665f6445f9bd477ba2562",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/bearer.h",
  "human_readable_source": " \n\n#ifndef _TIPC_BEARER_H\n#define _TIPC_BEARER_H\n\n#include \"netlink.h\"\n#include \"core.h\"\n#include \"msg.h\"\n#include <net/genetlink.h>\n\n#define MAX_MEDIA\t3\n\n \n#define TIPC_MEDIA_INFO_SIZE\t32\n#define TIPC_MEDIA_TYPE_OFFSET\t3\n#define TIPC_MEDIA_ADDR_OFFSET\t4\n\n \n#define TIPC_MEDIA_TYPE_ETH\t1\n#define TIPC_MEDIA_TYPE_IB\t2\n#define TIPC_MEDIA_TYPE_UDP\t3\n\n \n#define TIPC_MIN_BEARER_MTU\t(MAX_H_SIZE + INT_H_SIZE)\n\n \n#define TIPC_BROADCAST_SUPPORT  1\n#define TIPC_REPLICAST_SUPPORT  2\n\n \nstruct tipc_media_addr {\n\tu8 value[TIPC_MEDIA_INFO_SIZE];\n\tu8 media_id;\n\tu8 broadcast;\n};\n\nstruct tipc_bearer;\n\n \nstruct tipc_media {\n\tint (*send_msg)(struct net *net, struct sk_buff *buf,\n\t\t\tstruct tipc_bearer *b,\n\t\t\tstruct tipc_media_addr *dest);\n\tint (*enable_media)(struct net *net, struct tipc_bearer *b,\n\t\t\t    struct nlattr *attr[]);\n\tvoid (*disable_media)(struct tipc_bearer *b);\n\tint (*addr2str)(struct tipc_media_addr *addr,\n\t\t\tchar *strbuf,\n\t\t\tint bufsz);\n\tint (*addr2msg)(char *msg, struct tipc_media_addr *addr);\n\tint (*msg2addr)(struct tipc_bearer *b,\n\t\t\tstruct tipc_media_addr *addr,\n\t\t\tchar *msg);\n\tint (*raw2addr)(struct tipc_bearer *b,\n\t\t\tstruct tipc_media_addr *addr,\n\t\t\tconst char *raw);\n\tu32 priority;\n\tu32 tolerance;\n\tu32 min_win;\n\tu32 max_win;\n\tu32 mtu;\n\tu32 type_id;\n\tu32 hwaddr_len;\n\tchar name[TIPC_MAX_MEDIA_NAME];\n};\n\n \nstruct tipc_bearer {\n\tvoid __rcu *media_ptr;\t\t\t \n\tu32 mtu;\t\t\t\t \n\tstruct tipc_media_addr addr;\t\t \n\tchar name[TIPC_MAX_BEARER_NAME];\n\tstruct tipc_media *media;\n\tstruct tipc_media_addr bcast_addr;\n\tstruct packet_type pt;\n\tstruct rcu_head rcu;\n\tu32 priority;\n\tu32 min_win;\n\tu32 max_win;\n\tu32 tolerance;\n\tu32 domain;\n\tu32 identity;\n\tstruct tipc_discoverer *disc;\n\tchar net_plane;\n\tu16 encap_hlen;\n\tunsigned long up;\n\trefcount_t refcnt;\n};\n\nstruct tipc_bearer_names {\n\tchar media_name[TIPC_MAX_MEDIA_NAME];\n\tchar if_name[TIPC_MAX_IF_NAME];\n};\n\n \n\nvoid tipc_rcv(struct net *net, struct sk_buff *skb, struct tipc_bearer *b);\n\n \nextern struct tipc_media eth_media_info;\n\n#ifdef CONFIG_TIPC_MEDIA_IB\nextern struct tipc_media ib_media_info;\n#endif\n#ifdef CONFIG_TIPC_MEDIA_UDP\nextern struct tipc_media udp_media_info;\n#endif\n\nint tipc_nl_bearer_disable(struct sk_buff *skb, struct genl_info *info);\nint __tipc_nl_bearer_disable(struct sk_buff *skb, struct genl_info *info);\nint tipc_nl_bearer_enable(struct sk_buff *skb, struct genl_info *info);\nint __tipc_nl_bearer_enable(struct sk_buff *skb, struct genl_info *info);\nint tipc_nl_bearer_dump(struct sk_buff *skb, struct netlink_callback *cb);\nint tipc_nl_bearer_get(struct sk_buff *skb, struct genl_info *info);\nint tipc_nl_bearer_set(struct sk_buff *skb, struct genl_info *info);\nint __tipc_nl_bearer_set(struct sk_buff *skb, struct genl_info *info);\nint tipc_nl_bearer_add(struct sk_buff *skb, struct genl_info *info);\n\nint tipc_nl_media_dump(struct sk_buff *skb, struct netlink_callback *cb);\nint tipc_nl_media_get(struct sk_buff *skb, struct genl_info *info);\nint tipc_nl_media_set(struct sk_buff *skb, struct genl_info *info);\nint __tipc_nl_media_set(struct sk_buff *skb, struct genl_info *info);\n\nint tipc_media_addr_printf(char *buf, int len, struct tipc_media_addr *a);\nint tipc_enable_l2_media(struct net *net, struct tipc_bearer *b,\n\t\t\t struct nlattr *attrs[]);\nbool tipc_bearer_hold(struct tipc_bearer *b);\nvoid tipc_bearer_put(struct tipc_bearer *b);\nvoid tipc_disable_l2_media(struct tipc_bearer *b);\nint tipc_l2_send_msg(struct net *net, struct sk_buff *buf,\n\t\t     struct tipc_bearer *b, struct tipc_media_addr *dest);\n\nvoid tipc_bearer_add_dest(struct net *net, u32 bearer_id, u32 dest);\nvoid tipc_bearer_remove_dest(struct net *net, u32 bearer_id, u32 dest);\nstruct tipc_bearer *tipc_bearer_find(struct net *net, const char *name);\nint tipc_bearer_get_name(struct net *net, char *name, u32 bearer_id);\nstruct tipc_media *tipc_media_find(const char *name);\nint tipc_bearer_setup(void);\nvoid tipc_bearer_cleanup(void);\nvoid tipc_bearer_stop(struct net *net);\nint tipc_bearer_mtu(struct net *net, u32 bearer_id);\nint tipc_bearer_min_mtu(struct net *net, u32 bearer_id);\nbool tipc_bearer_bcast_support(struct net *net, u32 bearer_id);\nvoid tipc_bearer_xmit_skb(struct net *net, u32 bearer_id,\n\t\t\t  struct sk_buff *skb,\n\t\t\t  struct tipc_media_addr *dest);\nvoid tipc_bearer_xmit(struct net *net, u32 bearer_id,\n\t\t      struct sk_buff_head *xmitq,\n\t\t      struct tipc_media_addr *dst,\n\t\t      struct tipc_node *__dnode);\nvoid tipc_bearer_bc_xmit(struct net *net, u32 bearer_id,\n\t\t\t struct sk_buff_head *xmitq);\nvoid tipc_clone_to_loopback(struct net *net, struct sk_buff_head *pkts);\nint tipc_attach_loopback(struct net *net);\nvoid tipc_detach_loopback(struct net *net);\n\nstatic inline void tipc_loopback_trace(struct net *net,\n\t\t\t\t       struct sk_buff_head *pkts)\n{\n\tif (unlikely(dev_nit_active(net->loopback_dev)))\n\t\ttipc_clone_to_loopback(net, pkts);\n}\n\n \nstatic inline bool tipc_mtu_bad(struct net_device *dev)\n{\n\tif (dev->mtu >= TIPC_MIN_BEARER_MTU)\n\t\treturn false;\n\tnetdev_warn(dev, \"MTU too low for tipc bearer\\n\");\n\treturn true;\n}\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}