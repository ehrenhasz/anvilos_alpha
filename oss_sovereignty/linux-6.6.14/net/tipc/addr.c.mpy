{
  "module_name": "addr.c",
  "hash_id": "623da64dc12be0998214982094208ed9988b14540eb688d3c781c8440e0d5ce0",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/addr.c",
  "human_readable_source": " \n\n#include \"addr.h\"\n#include \"core.h\"\n\nbool tipc_in_scope(bool legacy_format, u32 domain, u32 addr)\n{\n\tif (!domain || (domain == addr))\n\t\treturn true;\n\tif (!legacy_format)\n\t\treturn false;\n\tif (domain == tipc_cluster_mask(addr))  \n\t\treturn true;\n\tif (domain == (addr & TIPC_ZONE_CLUSTER_MASK))  \n\t\treturn true;\n\tif (domain == (addr & TIPC_ZONE_MASK))  \n\t\treturn true;\n\treturn false;\n}\n\nvoid tipc_set_node_id(struct net *net, u8 *id)\n{\n\tstruct tipc_net *tn = tipc_net(net);\n\n\tmemcpy(tn->node_id, id, NODE_ID_LEN);\n\ttipc_nodeid2string(tn->node_id_string, id);\n\ttn->trial_addr = hash128to32(id);\n\tpr_info(\"Node identity %s, cluster identity %u\\n\",\n\t\ttipc_own_id_string(net), tn->net_id);\n}\n\nvoid tipc_set_node_addr(struct net *net, u32 addr)\n{\n\tstruct tipc_net *tn = tipc_net(net);\n\tu8 node_id[NODE_ID_LEN] = {0,};\n\n\ttn->node_addr = addr;\n\tif (!tipc_own_id(net)) {\n\t\tsprintf(node_id, \"%x\", addr);\n\t\ttipc_set_node_id(net, node_id);\n\t}\n\ttn->trial_addr = addr;\n\ttn->addr_trial_end = jiffies;\n\tpr_info(\"Node number set to %u\\n\", addr);\n}\n\nchar *tipc_nodeid2string(char *str, u8 *id)\n{\n\tint i;\n\tu8 c;\n\n\t \n\tfor (i = 0; i < NODE_ID_LEN; i++) {\n\t\tc = id[i];\n\t\tif (c >= '0' && c <= '9')\n\t\t\tcontinue;\n\t\tif (c >= 'A' && c <= 'Z')\n\t\t\tcontinue;\n\t\tif (c >= 'a' && c <= 'z')\n\t\t\tcontinue;\n\t\tif (c == '.')\n\t\t\tcontinue;\n\t\tif (c == ':')\n\t\t\tcontinue;\n\t\tif (c == '_')\n\t\t\tcontinue;\n\t\tif (c == '-')\n\t\t\tcontinue;\n\t\tif (c == '@')\n\t\t\tcontinue;\n\t\tif (c != 0)\n\t\t\tbreak;\n\t}\n\tif (i == NODE_ID_LEN) {\n\t\tmemcpy(str, id, NODE_ID_LEN);\n\t\tstr[NODE_ID_LEN] = 0;\n\t\treturn str;\n\t}\n\n\t \n\tfor (i = 0; i < NODE_ID_LEN; i++)\n\t\tsprintf(&str[2 * i], \"%02x\", id[i]);\n\n\t \n\tfor (i = NODE_ID_STR_LEN - 2; str[i] == '0'; i--)\n\t\tstr[i] = 0;\n\n\treturn str;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}