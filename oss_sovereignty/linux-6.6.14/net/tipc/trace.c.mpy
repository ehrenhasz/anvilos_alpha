{
  "module_name": "trace.c",
  "hash_id": "8e2b1896a2a26f4fe2d3d991d14c6e718279188e048f9b2eaf92b41d4d7c9f3c",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/trace.c",
  "human_readable_source": " \n\n#define CREATE_TRACE_POINTS\n#include \"trace.h\"\n\n \nunsigned long sysctl_tipc_sk_filter[5] __read_mostly = {0, };\n\n \nint tipc_skb_dump(struct sk_buff *skb, bool more, char *buf)\n{\n\tint i = 0;\n\tsize_t sz = (more) ? SKB_LMAX : SKB_LMIN;\n\tstruct tipc_msg *hdr;\n\tstruct tipc_skb_cb *skbcb;\n\n\tif (!skb) {\n\t\ti += scnprintf(buf, sz, \"msg: (null)\\n\");\n\t\treturn i;\n\t}\n\n\thdr = buf_msg(skb);\n\tskbcb = TIPC_SKB_CB(skb);\n\n\t \n\ti += scnprintf(buf, sz, \"msg: %u\", msg_user(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_type(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_hdr_sz(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_data_sz(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %x\", msg_orignode(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %x\", msg_destnode(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_seqno(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_ack(hdr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", msg_bcast_ack(hdr));\n\tswitch (msg_user(hdr)) {\n\tcase LINK_PROTOCOL:\n\t\ti += scnprintf(buf + i, sz - i, \" %c\", msg_net_plane(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_probe(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_peer_stopping(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_session(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_next_sent(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_seq_gap(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_bc_snd_nxt(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_bc_gap(hdr));\n\t\tbreak;\n\tcase TIPC_LOW_IMPORTANCE:\n\tcase TIPC_MEDIUM_IMPORTANCE:\n\tcase TIPC_HIGH_IMPORTANCE:\n\tcase TIPC_CRITICAL_IMPORTANCE:\n\tcase CONN_MANAGER:\n\tcase SOCK_WAKEUP:\n\t\ti += scnprintf(buf + i, sz - i, \" | %u\", msg_origport(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_destport(hdr));\n\t\tswitch (msg_type(hdr)) {\n\t\tcase TIPC_NAMED_MSG:\n\t\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t\t       msg_nametype(hdr));\n\t\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t\t       msg_nameinst(hdr));\n\t\t\tbreak;\n\t\tcase TIPC_MCAST_MSG:\n\t\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t\t       msg_nametype(hdr));\n\t\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t\t       msg_namelower(hdr));\n\t\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t\t       msg_nameupper(hdr));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t\ti += scnprintf(buf + i, sz - i, \" | %u\",\n\t\t\t       msg_src_droppable(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t\t       msg_dest_droppable(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_errcode(hdr));\n\t\ti += scnprintf(buf + i, sz - i, \" %u\", msg_reroute_cnt(hdr));\n\t\tbreak;\n\tdefault:\n\t\t \n\t\tbreak;\n\t}\n\n\ti += scnprintf(buf + i, sz - i, \"\\n\");\n\tif (!more)\n\t\treturn i;\n\n\t \n\ti += scnprintf(buf + i, sz - i, \"skb: %s\",\n\t\t       (skb->dev) ? skb->dev->name : \"n/a\");\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb->len);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb->data_len);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb->hdr_len);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb->truesize);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb_cloned(skb));\n\ti += scnprintf(buf + i, sz - i, \" %p\", skb->sk);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skb_shinfo(skb)->nr_frags);\n\ti += scnprintf(buf + i, sz - i, \" %llx\",\n\t\t       ktime_to_ms(skb_get_ktime(skb)));\n\ti += scnprintf(buf + i, sz - i, \" %llx\\n\",\n\t\t       ktime_to_ms(skb_hwtstamps(skb)->hwtstamp));\n\n\t \n\ti += scnprintf(buf + i, sz - i, \"cb[]: %u\", skbcb->bytes_read);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skbcb->orig_member);\n\ti += scnprintf(buf + i, sz - i, \" %u\",\n\t\t       jiffies_to_msecs(skbcb->nxt_retr));\n\ti += scnprintf(buf + i, sz - i, \" %u\", skbcb->validated);\n\ti += scnprintf(buf + i, sz - i, \" %u\", skbcb->chain_imp);\n\ti += scnprintf(buf + i, sz - i, \" %u\\n\", skbcb->ackers);\n\n\treturn i;\n}\n\n \nint tipc_list_dump(struct sk_buff_head *list, bool more, char *buf)\n{\n\tint i = 0;\n\tsize_t sz = (more) ? LIST_LMAX : LIST_LMIN;\n\tu32 count, len;\n\tstruct sk_buff *hskb, *tskb, *skb, *tmp;\n\n\tif (!list) {\n\t\ti += scnprintf(buf, sz, \"(null)\\n\");\n\t\treturn i;\n\t}\n\n\tlen = skb_queue_len(list);\n\ti += scnprintf(buf, sz, \"len = %d\\n\", len);\n\n\tif (!len)\n\t\treturn i;\n\n\tif (!more) {\n\t\thskb = skb_peek(list);\n\t\ti += scnprintf(buf + i, sz - i, \"  head \");\n\t\ti += tipc_skb_dump(hskb, false, buf + i);\n\t\tif (len > 1) {\n\t\t\ttskb = skb_peek_tail(list);\n\t\t\ti += scnprintf(buf + i, sz - i, \"  tail \");\n\t\t\ti += tipc_skb_dump(tskb, false, buf + i);\n\t\t}\n\t} else {\n\t\tcount = 0;\n\t\tskb_queue_walk_safe(list, skb, tmp) {\n\t\t\tcount++;\n\t\t\tif (count == 6)\n\t\t\t\ti += scnprintf(buf + i, sz - i, \"  .\\n  .\\n\");\n\t\t\tif (count > 5 && count <= len - 5)\n\t\t\t\tcontinue;\n\t\t\ti += scnprintf(buf + i, sz - i, \"  #%d \", count);\n\t\t\ti += tipc_skb_dump(skb, false, buf + i);\n\t\t}\n\t}\n\treturn i;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}