{
  "module_name": "netlink.c",
  "hash_id": "69601237d1b209686a7d824cc50ccdff809166321de8d1e220ed52a413c58aeb",
  "original_prompt": "Ingested from linux-6.6.14/net/tipc/netlink.c",
  "human_readable_source": " \n\n#include \"core.h\"\n#include \"socket.h\"\n#include \"name_table.h\"\n#include \"bearer.h\"\n#include \"link.h\"\n#include \"node.h\"\n#include \"net.h\"\n#include \"udp_media.h\"\n#include <net/genetlink.h>\n\nstatic const struct nla_policy tipc_nl_policy[TIPC_NLA_MAX + 1] = {\n\t[TIPC_NLA_UNSPEC]\t= { .type = NLA_UNSPEC, },\n\t[TIPC_NLA_BEARER]\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_SOCK]\t\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_PUBL]\t\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_LINK]\t\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_MEDIA]\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_NODE]\t\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_NET]\t\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_NAME_TABLE]\t= { .type = NLA_NESTED, },\n\t[TIPC_NLA_MON]\t\t= { .type = NLA_NESTED, },\n};\n\nconst struct nla_policy\ntipc_nl_name_table_policy[TIPC_NLA_NAME_TABLE_MAX + 1] = {\n\t[TIPC_NLA_NAME_TABLE_UNSPEC]\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_NAME_TABLE_PUBL]\t= { .type = NLA_NESTED }\n};\n\nconst struct nla_policy tipc_nl_monitor_policy[TIPC_NLA_MON_MAX + 1] = {\n\t[TIPC_NLA_MON_UNSPEC]\t\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_MON_REF]\t\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_MON_ACTIVATION_THRESHOLD]\t= { .type = NLA_U32 },\n};\n\nconst struct nla_policy tipc_nl_sock_policy[TIPC_NLA_SOCK_MAX + 1] = {\n\t[TIPC_NLA_SOCK_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_SOCK_ADDR]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_SOCK_REF]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_SOCK_CON]\t\t= { .type = NLA_NESTED },\n\t[TIPC_NLA_SOCK_HAS_PUBL]\t= { .type = NLA_FLAG }\n};\n\nconst struct nla_policy tipc_nl_net_policy[TIPC_NLA_NET_MAX + 1] = {\n\t[TIPC_NLA_NET_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_NET_ID]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_NET_ADDR]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_NET_NODEID]\t\t= { .type = NLA_U64 },\n\t[TIPC_NLA_NET_NODEID_W1]\t= { .type = NLA_U64 },\n\t[TIPC_NLA_NET_ADDR_LEGACY]\t= { .type = NLA_FLAG }\n};\n\nconst struct nla_policy tipc_nl_link_policy[TIPC_NLA_LINK_MAX + 1] = {\n\t[TIPC_NLA_LINK_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_LINK_NAME]\t\t= { .type = NLA_NUL_STRING,\n\t\t\t\t\t    .len = TIPC_MAX_LINK_NAME },\n\t[TIPC_NLA_LINK_MTU]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_LINK_BROADCAST]\t= { .type = NLA_FLAG },\n\t[TIPC_NLA_LINK_UP]\t\t= { .type = NLA_FLAG },\n\t[TIPC_NLA_LINK_ACTIVE]\t\t= { .type = NLA_FLAG },\n\t[TIPC_NLA_LINK_PROP]\t\t= { .type = NLA_NESTED },\n\t[TIPC_NLA_LINK_STATS]\t\t= { .type = NLA_NESTED },\n\t[TIPC_NLA_LINK_RX]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_LINK_TX]\t\t= { .type = NLA_U32 }\n};\n\nconst struct nla_policy tipc_nl_node_policy[TIPC_NLA_NODE_MAX + 1] = {\n\t[TIPC_NLA_NODE_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_NODE_ADDR]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_NODE_UP]\t\t= { .type = NLA_FLAG },\n\t[TIPC_NLA_NODE_ID]\t\t= { .type = NLA_BINARY,\n\t\t\t\t\t    .len = TIPC_NODEID_LEN},\n\t[TIPC_NLA_NODE_KEY]\t\t= { .type = NLA_BINARY,\n\t\t\t\t\t    .len = TIPC_AEAD_KEY_SIZE_MAX},\n\t[TIPC_NLA_NODE_KEY_MASTER]\t= { .type = NLA_FLAG },\n\t[TIPC_NLA_NODE_REKEYING]\t= { .type = NLA_U32 },\n};\n\n \nconst struct nla_policy tipc_nl_prop_policy[TIPC_NLA_PROP_MAX + 1] = {\n\t[TIPC_NLA_PROP_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_PROP_PRIO]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_PROP_TOL]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_PROP_WIN]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_PROP_MTU]\t\t= { .type = NLA_U32 },\n\t[TIPC_NLA_PROP_BROADCAST]\t= { .type = NLA_U32 },\n\t[TIPC_NLA_PROP_BROADCAST_RATIO]\t= { .type = NLA_U32 }\n};\n\nconst struct nla_policy tipc_nl_bearer_policy[TIPC_NLA_BEARER_MAX + 1]\t= {\n\t[TIPC_NLA_BEARER_UNSPEC]\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_BEARER_NAME]\t\t= { .type = NLA_NUL_STRING,\n\t\t\t\t\t    .len = TIPC_MAX_BEARER_NAME },\n\t[TIPC_NLA_BEARER_PROP]\t\t= { .type = NLA_NESTED },\n\t[TIPC_NLA_BEARER_DOMAIN]\t= { .type = NLA_U32 }\n};\n\nconst struct nla_policy tipc_nl_media_policy[TIPC_NLA_MEDIA_MAX + 1] = {\n\t[TIPC_NLA_MEDIA_UNSPEC]\t\t= { .type = NLA_UNSPEC },\n\t[TIPC_NLA_MEDIA_NAME]\t\t= { .type = NLA_STRING },\n\t[TIPC_NLA_MEDIA_PROP]\t\t= { .type = NLA_NESTED }\n};\n\nconst struct nla_policy tipc_nl_udp_policy[TIPC_NLA_UDP_MAX + 1] = {\n\t[TIPC_NLA_UDP_UNSPEC]\t= {.type = NLA_UNSPEC},\n\t[TIPC_NLA_UDP_LOCAL]\t= {.type = NLA_BINARY,\n\t\t\t\t   .len = sizeof(struct sockaddr_storage)},\n\t[TIPC_NLA_UDP_REMOTE]\t= {.type = NLA_BINARY,\n\t\t\t\t   .len = sizeof(struct sockaddr_storage)},\n};\n\n \nstatic const struct genl_ops tipc_genl_v2_ops[] = {\n\t{\n\t\t.cmd\t= TIPC_NL_BEARER_DISABLE,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_bearer_disable,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_BEARER_ENABLE,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_bearer_enable,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_BEARER_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_bearer_get,\n\t\t.dumpit\t= tipc_nl_bearer_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_BEARER_ADD,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_bearer_add,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_BEARER_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_bearer_set,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_SOCK_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.start = tipc_dump_start,\n\t\t.dumpit\t= tipc_nl_sk_dump,\n\t\t.done\t= tipc_dump_done,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_PUBL_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT |\n\t\t\t    GENL_DONT_VALIDATE_DUMP_STRICT,\n\t\t.dumpit\t= tipc_nl_publ_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_LINK_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT,\n\t\t.doit   = tipc_nl_node_get_link,\n\t\t.dumpit\t= tipc_nl_node_dump_link,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_LINK_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_node_set_link,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_LINK_RESET_STATS,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit   = tipc_nl_node_reset_link_stats,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_MEDIA_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_media_get,\n\t\t.dumpit\t= tipc_nl_media_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_MEDIA_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_media_set,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_NODE_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.dumpit\t= tipc_nl_node_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_NET_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.dumpit\t= tipc_nl_net_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_NET_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_net_set,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_NAME_TABLE_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.dumpit\t= tipc_nl_name_table_dump,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_MON_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_node_set_monitor,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_MON_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_node_get_monitor,\n\t\t.dumpit\t= tipc_nl_node_dump_monitor,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_MON_PEER_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT |\n\t\t\t    GENL_DONT_VALIDATE_DUMP_STRICT,\n\t\t.dumpit\t= tipc_nl_node_dump_monitor_peer,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_PEER_REMOVE,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_peer_rm,\n\t},\n#ifdef CONFIG_TIPC_MEDIA_UDP\n\t{\n\t\t.cmd\t= TIPC_NL_UDP_GET_REMOTEIP,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT |\n\t\t\t    GENL_DONT_VALIDATE_DUMP_STRICT,\n\t\t.dumpit\t= tipc_udp_nl_dump_remoteip,\n\t},\n#endif\n#ifdef CONFIG_TIPC_CRYPTO\n\t{\n\t\t.cmd\t= TIPC_NL_KEY_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_node_set_key,\n\t},\n\t{\n\t\t.cmd\t= TIPC_NL_KEY_FLUSH,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_node_flush_key,\n\t},\n#endif\n\t{\n\t\t.cmd\t= TIPC_NL_ADDR_LEGACY_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit\t= tipc_nl_net_addr_legacy_get,\n\t},\n};\n\nstruct genl_family tipc_genl_family __ro_after_init = {\n\t.name\t\t= TIPC_GENL_V2_NAME,\n\t.version\t= TIPC_GENL_V2_VERSION,\n\t.hdrsize\t= 0,\n\t.maxattr\t= TIPC_NLA_MAX,\n\t.policy\t\t= tipc_nl_policy,\n\t.netnsok\t= true,\n\t.module\t\t= THIS_MODULE,\n\t.ops\t\t= tipc_genl_v2_ops,\n\t.n_ops\t\t= ARRAY_SIZE(tipc_genl_v2_ops),\n\t.resv_start_op\t= TIPC_NL_ADDR_LEGACY_GET + 1,\n};\n\nint __init tipc_netlink_start(void)\n{\n\tint res;\n\n\tres = genl_register_family(&tipc_genl_family);\n\tif (res) {\n\t\tpr_err(\"Failed to register netlink interface\\n\");\n\t\treturn res;\n\t}\n\treturn 0;\n}\n\nvoid tipc_netlink_stop(void)\n{\n\tgenl_unregister_family(&tipc_genl_family);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}