{
  "module_name": "ebtable_filter.c",
  "hash_id": "8e12b7e42510a51a4bc6772ad3498f7715bafc7375015964fbaac1a634434283",
  "original_prompt": "Ingested from linux-6.6.14/net/bridge/netfilter/ebtable_filter.c",
  "human_readable_source": "\n \n\n#include <linux/netfilter_bridge/ebtables.h>\n#include <uapi/linux/netfilter_bridge.h>\n#include <linux/module.h>\n\n#define FILTER_VALID_HOOKS ((1 << NF_BR_LOCAL_IN) | (1 << NF_BR_FORWARD) | \\\n\t\t\t    (1 << NF_BR_LOCAL_OUT))\n\nstatic struct ebt_entries initial_chains[] = {\n\t{\n\t\t.name\t= \"INPUT\",\n\t\t.policy\t= EBT_ACCEPT,\n\t},\n\t{\n\t\t.name\t= \"FORWARD\",\n\t\t.policy\t= EBT_ACCEPT,\n\t},\n\t{\n\t\t.name\t= \"OUTPUT\",\n\t\t.policy\t= EBT_ACCEPT,\n\t},\n};\n\nstatic struct ebt_replace_kernel initial_table = {\n\t.name\t\t= \"filter\",\n\t.valid_hooks\t= FILTER_VALID_HOOKS,\n\t.entries_size\t= 3 * sizeof(struct ebt_entries),\n\t.hook_entry\t= {\n\t\t[NF_BR_LOCAL_IN]\t= &initial_chains[0],\n\t\t[NF_BR_FORWARD]\t\t= &initial_chains[1],\n\t\t[NF_BR_LOCAL_OUT]\t= &initial_chains[2],\n\t},\n\t.entries\t= (char *)initial_chains,\n};\n\nstatic const struct ebt_table frame_filter = {\n\t.name\t\t= \"filter\",\n\t.table\t\t= &initial_table,\n\t.valid_hooks\t= FILTER_VALID_HOOKS,\n\t.me\t\t= THIS_MODULE,\n};\n\nstatic const struct nf_hook_ops ebt_ops_filter[] = {\n\t{\n\t\t.hook\t\t= ebt_do_table,\n\t\t.pf\t\t= NFPROTO_BRIDGE,\n\t\t.hooknum\t= NF_BR_LOCAL_IN,\n\t\t.priority\t= NF_BR_PRI_FILTER_BRIDGED,\n\t},\n\t{\n\t\t.hook\t\t= ebt_do_table,\n\t\t.pf\t\t= NFPROTO_BRIDGE,\n\t\t.hooknum\t= NF_BR_FORWARD,\n\t\t.priority\t= NF_BR_PRI_FILTER_BRIDGED,\n\t},\n\t{\n\t\t.hook\t\t= ebt_do_table,\n\t\t.pf\t\t= NFPROTO_BRIDGE,\n\t\t.hooknum\t= NF_BR_LOCAL_OUT,\n\t\t.priority\t= NF_BR_PRI_FILTER_OTHER,\n\t},\n};\n\nstatic int frame_filter_table_init(struct net *net)\n{\n\treturn ebt_register_table(net, &frame_filter, ebt_ops_filter);\n}\n\nstatic void __net_exit frame_filter_net_pre_exit(struct net *net)\n{\n\tebt_unregister_table_pre_exit(net, \"filter\");\n}\n\nstatic void __net_exit frame_filter_net_exit(struct net *net)\n{\n\tebt_unregister_table(net, \"filter\");\n}\n\nstatic struct pernet_operations frame_filter_net_ops = {\n\t.exit = frame_filter_net_exit,\n\t.pre_exit = frame_filter_net_pre_exit,\n};\n\nstatic int __init ebtable_filter_init(void)\n{\n\tint ret = ebt_register_template(&frame_filter, frame_filter_table_init);\n\n\tif (ret)\n\t\treturn ret;\n\n\tret = register_pernet_subsys(&frame_filter_net_ops);\n\tif (ret) {\n\t\tebt_unregister_template(&frame_filter);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic void __exit ebtable_filter_fini(void)\n{\n\tunregister_pernet_subsys(&frame_filter_net_ops);\n\tebt_unregister_template(&frame_filter);\n}\n\nmodule_init(ebtable_filter_init);\nmodule_exit(ebtable_filter_fini);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}