{
  "module_name": "ebt_nflog.c",
  "hash_id": "0c91d19e0dd11238e00ada76c25d8a34a7f292b1996b01a4e7a8824370a038f2",
  "original_prompt": "Ingested from linux-6.6.14/net/bridge/netfilter/ebt_nflog.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/netfilter/x_tables.h>\n#include <linux/netfilter_bridge/ebtables.h>\n#include <linux/netfilter_bridge/ebt_nflog.h>\n#include <net/netfilter/nf_log.h>\n\nstatic unsigned int\nebt_nflog_tg(struct sk_buff *skb, const struct xt_action_param *par)\n{\n\tconst struct ebt_nflog_info *info = par->targinfo;\n\tstruct net *net = xt_net(par);\n\tstruct nf_loginfo li;\n\n\tli.type = NF_LOG_TYPE_ULOG;\n\tli.u.ulog.copy_len = info->len;\n\tli.u.ulog.group = info->group;\n\tli.u.ulog.qthreshold = info->threshold;\n\tli.u.ulog.flags = 0;\n\n\tnf_log_packet(net, PF_BRIDGE, xt_hooknum(par), skb, xt_in(par),\n\t\t      xt_out(par), &li, \"%s\", info->prefix);\n\treturn EBT_CONTINUE;\n}\n\nstatic int ebt_nflog_tg_check(const struct xt_tgchk_param *par)\n{\n\tstruct ebt_nflog_info *info = par->targinfo;\n\n\tif (info->flags & ~EBT_NFLOG_MASK)\n\t\treturn -EINVAL;\n\tinfo->prefix[EBT_NFLOG_PREFIX_SIZE - 1] = '\\0';\n\treturn 0;\n}\n\nstatic struct xt_target ebt_nflog_tg_reg __read_mostly = {\n\t.name       = \"nflog\",\n\t.revision   = 0,\n\t.family     = NFPROTO_BRIDGE,\n\t.target     = ebt_nflog_tg,\n\t.checkentry = ebt_nflog_tg_check,\n\t.targetsize = sizeof(struct ebt_nflog_info),\n\t.me         = THIS_MODULE,\n};\n\nstatic int __init ebt_nflog_init(void)\n{\n\treturn xt_register_target(&ebt_nflog_tg_reg);\n}\n\nstatic void __exit ebt_nflog_fini(void)\n{\n\txt_unregister_target(&ebt_nflog_tg_reg);\n}\n\nmodule_init(ebt_nflog_init);\nmodule_exit(ebt_nflog_fini);\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Peter Warasin <peter@endian.com>\");\nMODULE_DESCRIPTION(\"ebtables NFLOG netfilter logging module\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}