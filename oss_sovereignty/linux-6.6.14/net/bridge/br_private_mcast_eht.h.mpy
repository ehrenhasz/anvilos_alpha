{
  "module_name": "br_private_mcast_eht.h",
  "hash_id": "3b80dace42ed224e0f146b84e9671402908c35fef33780e652b19b24cf1fb1c6",
  "original_prompt": "Ingested from linux-6.6.14/net/bridge/br_private_mcast_eht.h",
  "human_readable_source": " \n#ifndef _BR_PRIVATE_MCAST_EHT_H_\n#define _BR_PRIVATE_MCAST_EHT_H_\n\n#define BR_MCAST_DEFAULT_EHT_HOSTS_LIMIT 512\n\nunion net_bridge_eht_addr {\n\t__be32\t\t\t\tip4;\n#if IS_ENABLED(CONFIG_IPV6)\n\tstruct in6_addr\t\t\tip6;\n#endif\n};\n\n \nstruct net_bridge_group_eht_host {\n\tstruct rb_node\t\t\trb_node;\n\n\tunion net_bridge_eht_addr\th_addr;\n\tstruct hlist_head\t\tset_entries;\n\tunsigned int\t\t\tnum_entries;\n\tunsigned char\t\t\tfilter_mode;\n\tstruct net_bridge_port_group\t*pg;\n};\n\n \nstruct net_bridge_group_eht_set_entry {\n\tstruct rb_node\t\t\trb_node;\n\tstruct hlist_node\t\thost_list;\n\n\tunion net_bridge_eht_addr\th_addr;\n\tstruct timer_list\t\ttimer;\n\tstruct net_bridge\t\t*br;\n\tstruct net_bridge_group_eht_set\t*eht_set;\n\tstruct net_bridge_group_eht_host *h_parent;\n\tstruct net_bridge_mcast_gc\tmcast_gc;\n};\n\n \nstruct net_bridge_group_eht_set {\n\tstruct rb_node\t\t\trb_node;\n\n\tunion net_bridge_eht_addr\tsrc_addr;\n\tstruct rb_root\t\t\tentry_tree;\n\tstruct timer_list\t\ttimer;\n\tstruct net_bridge_port_group\t*pg;\n\tstruct net_bridge\t\t*br;\n\tstruct net_bridge_mcast_gc\tmcast_gc;\n};\n\n#ifdef CONFIG_BRIDGE_IGMP_SNOOPING\nvoid br_multicast_eht_clean_sets(struct net_bridge_port_group *pg);\nbool br_multicast_eht_handle(const struct net_bridge_mcast *brmctx,\n\t\t\t     struct net_bridge_port_group *pg,\n\t\t\t     void *h_addr,\n\t\t\t     void *srcs,\n\t\t\t     u32 nsrcs,\n\t\t\t     size_t addr_size,\n\t\t\t     int grec_type);\nint br_multicast_eht_set_hosts_limit(struct net_bridge_port *p,\n\t\t\t\t     u32 eht_hosts_limit);\n\nstatic inline bool\nbr_multicast_eht_should_del_pg(const struct net_bridge_port_group *pg)\n{\n\treturn !!((pg->key.port->flags & BR_MULTICAST_FAST_LEAVE) &&\n\t\t  RB_EMPTY_ROOT(&pg->eht_host_tree));\n}\n\nstatic inline bool\nbr_multicast_eht_hosts_over_limit(const struct net_bridge_port_group *pg)\n{\n\tconst struct net_bridge_port *p = pg->key.port;\n\n\treturn !!(p->multicast_eht_hosts_cnt >= p->multicast_eht_hosts_limit);\n}\n\nstatic inline void br_multicast_eht_hosts_inc(struct net_bridge_port_group *pg)\n{\n\tstruct net_bridge_port *p = pg->key.port;\n\n\tp->multicast_eht_hosts_cnt++;\n}\n\nstatic inline void br_multicast_eht_hosts_dec(struct net_bridge_port_group *pg)\n{\n\tstruct net_bridge_port *p = pg->key.port;\n\n\tp->multicast_eht_hosts_cnt--;\n}\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}