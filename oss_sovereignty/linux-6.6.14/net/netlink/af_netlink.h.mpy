{
  "module_name": "af_netlink.h",
  "hash_id": "f5998c82728cc288ad451e5712149b7db7d32706a63888661e0db21b37d860e7",
  "original_prompt": "Ingested from linux-6.6.14/net/netlink/af_netlink.h",
  "human_readable_source": " \n#ifndef _AF_NETLINK_H\n#define _AF_NETLINK_H\n\n#include <linux/rhashtable.h>\n#include <linux/atomic.h>\n#include <linux/workqueue.h>\n#include <net/sock.h>\n\n \nenum {\n\tNETLINK_F_KERNEL_SOCKET,\n\tNETLINK_F_RECV_PKTINFO,\n\tNETLINK_F_BROADCAST_SEND_ERROR,\n\tNETLINK_F_RECV_NO_ENOBUFS,\n\tNETLINK_F_LISTEN_ALL_NSID,\n\tNETLINK_F_CAP_ACK,\n\tNETLINK_F_EXT_ACK,\n\tNETLINK_F_STRICT_CHK,\n};\n\n#define NLGRPSZ(x)\t(ALIGN(x, sizeof(unsigned long) * 8) / 8)\n#define NLGRPLONGS(x)\t(NLGRPSZ(x)/sizeof(unsigned long))\n\nstruct netlink_sock {\n\t \n\tstruct sock\t\tsk;\n\tunsigned long\t\tflags;\n\tu32\t\t\tportid;\n\tu32\t\t\tdst_portid;\n\tu32\t\t\tdst_group;\n\tu32\t\t\tsubscriptions;\n\tu32\t\t\tngroups;\n\tunsigned long\t\t*groups;\n\tunsigned long\t\tstate;\n\tsize_t\t\t\tmax_recvmsg_len;\n\twait_queue_head_t\twait;\n\tbool\t\t\tbound;\n\tbool\t\t\tcb_running;\n\tint\t\t\tdump_done_errno;\n\tstruct netlink_callback\tcb;\n\tstruct mutex\t\t*cb_mutex;\n\tstruct mutex\t\tcb_def_mutex;\n\tvoid\t\t\t(*netlink_rcv)(struct sk_buff *skb);\n\tint\t\t\t(*netlink_bind)(struct net *net, int group);\n\tvoid\t\t\t(*netlink_unbind)(struct net *net, int group);\n\tvoid\t\t\t(*netlink_release)(struct sock *sk,\n\t\t\t\t\t\t   unsigned long *groups);\n\tstruct module\t\t*module;\n\n\tstruct rhash_head\tnode;\n\tstruct rcu_head\t\trcu;\n\tstruct work_struct\twork;\n};\n\nstatic inline struct netlink_sock *nlk_sk(struct sock *sk)\n{\n\treturn container_of(sk, struct netlink_sock, sk);\n}\n\n#define nlk_test_bit(nr, sk) test_bit(NETLINK_F_##nr, &nlk_sk(sk)->flags)\n\nstruct netlink_table {\n\tstruct rhashtable\thash;\n\tstruct hlist_head\tmc_list;\n\tstruct listeners __rcu\t*listeners;\n\tunsigned int\t\tflags;\n\tunsigned int\t\tgroups;\n\tstruct mutex\t\t*cb_mutex;\n\tstruct module\t\t*module;\n\tint\t\t\t(*bind)(struct net *net, int group);\n\tvoid\t\t\t(*unbind)(struct net *net, int group);\n\tvoid                    (*release)(struct sock *sk,\n\t\t\t\t\t   unsigned long *groups);\n\tint\t\t\tregistered;\n};\n\nextern struct netlink_table *nl_table;\nextern rwlock_t nl_table_lock;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}