{
  "module_name": "mac_cmd.c",
  "hash_id": "213611576419e006e3806f708a94b0fa35162e0b323d3be08199f1610df23944",
  "original_prompt": "Ingested from linux-6.6.14/net/mac802154/mac_cmd.c",
  "human_readable_source": "\n \n\n#include <linux/skbuff.h>\n#include <linux/if_arp.h>\n#include <linux/ieee802154.h>\n\n#include <net/ieee802154_netdev.h>\n#include <net/cfg802154.h>\n#include <net/mac802154.h>\n\n#include \"ieee802154_i.h\"\n#include \"driver-ops.h\"\n\nstatic int mac802154_mlme_start_req(struct net_device *dev,\n\t\t\t\t    struct ieee802154_addr *addr,\n\t\t\t\t    u8 channel, u8 page,\n\t\t\t\t    u8 bcn_ord, u8 sf_ord,\n\t\t\t\t    u8 pan_coord, u8 blx,\n\t\t\t\t    u8 coord_realign)\n{\n\tstruct ieee802154_llsec_params params;\n\tint changed = 0;\n\n\tASSERT_RTNL();\n\n\tBUG_ON(addr->mode != IEEE802154_ADDR_SHORT);\n\n\tdev->ieee802154_ptr->pan_id = addr->pan_id;\n\tdev->ieee802154_ptr->short_addr = addr->short_addr;\n\tmac802154_dev_set_page_channel(dev, page, channel);\n\n\tparams.pan_id = addr->pan_id;\n\tchanged |= IEEE802154_LLSEC_PARAM_PAN_ID;\n\n\tparams.hwaddr = ieee802154_devaddr_from_raw(dev->dev_addr);\n\tchanged |= IEEE802154_LLSEC_PARAM_HWADDR;\n\n\tparams.coord_hwaddr = params.hwaddr;\n\tchanged |= IEEE802154_LLSEC_PARAM_COORD_HWADDR;\n\n\tparams.coord_shortaddr = addr->short_addr;\n\tchanged |= IEEE802154_LLSEC_PARAM_COORD_SHORTADDR;\n\n\treturn mac802154_set_params(dev, &params, changed);\n}\n\nstatic int mac802154_set_mac_params(struct net_device *dev,\n\t\t\t\t    const struct ieee802154_mac_params *params)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tstruct ieee802154_local *local = sdata->local;\n\tstruct wpan_dev *wpan_dev = &sdata->wpan_dev;\n\tint ret;\n\n\tASSERT_RTNL();\n\n\t \n\twpan_dev->wpan_phy->transmit_power = params->transmit_power;\n\twpan_dev->wpan_phy->cca = params->cca;\n\twpan_dev->wpan_phy->cca_ed_level = params->cca_ed_level;\n\n\t \n\twpan_dev->min_be = params->min_be;\n\twpan_dev->max_be = params->max_be;\n\twpan_dev->csma_retries = params->csma_retries;\n\twpan_dev->frame_retries = params->frame_retries;\n\twpan_dev->lbt = params->lbt;\n\n\tif (local->hw.phy->flags & WPAN_PHY_FLAG_TXPOWER) {\n\t\tret = drv_set_tx_power(local, params->transmit_power);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\tif (local->hw.phy->flags & WPAN_PHY_FLAG_CCA_MODE) {\n\t\tret = drv_set_cca_mode(local, &params->cca);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\tif (local->hw.phy->flags & WPAN_PHY_FLAG_CCA_ED_LEVEL) {\n\t\tret = drv_set_cca_ed_level(local, params->cca_ed_level);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic void mac802154_get_mac_params(struct net_device *dev,\n\t\t\t\t     struct ieee802154_mac_params *params)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tstruct wpan_dev *wpan_dev = &sdata->wpan_dev;\n\n\tASSERT_RTNL();\n\n\t \n\tparams->transmit_power = wpan_dev->wpan_phy->transmit_power;\n\tparams->cca = wpan_dev->wpan_phy->cca;\n\tparams->cca_ed_level = wpan_dev->wpan_phy->cca_ed_level;\n\n\t \n\tparams->min_be = wpan_dev->min_be;\n\tparams->max_be = wpan_dev->max_be;\n\tparams->csma_retries = wpan_dev->csma_retries;\n\tparams->frame_retries = wpan_dev->frame_retries;\n\tparams->lbt = wpan_dev->lbt;\n}\n\nstatic const struct ieee802154_llsec_ops mac802154_llsec_ops = {\n\t.get_params = mac802154_get_params,\n\t.set_params = mac802154_set_params,\n\t.add_key = mac802154_add_key,\n\t.del_key = mac802154_del_key,\n\t.add_dev = mac802154_add_dev,\n\t.del_dev = mac802154_del_dev,\n\t.add_devkey = mac802154_add_devkey,\n\t.del_devkey = mac802154_del_devkey,\n\t.add_seclevel = mac802154_add_seclevel,\n\t.del_seclevel = mac802154_del_seclevel,\n\t.lock_table = mac802154_lock_table,\n\t.get_table = mac802154_get_table,\n\t.unlock_table = mac802154_unlock_table,\n};\n\nstruct ieee802154_mlme_ops mac802154_mlme_wpan = {\n\t.start_req = mac802154_mlme_start_req,\n\n\t.llsec = &mac802154_llsec_ops,\n\n\t.set_mac_params = mac802154_set_mac_params,\n\t.get_mac_params = mac802154_get_mac_params,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}