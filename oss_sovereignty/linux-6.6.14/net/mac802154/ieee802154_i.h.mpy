{
  "module_name": "ieee802154_i.h",
  "hash_id": "b8ecc17fad593e306ca89d2942ee72269d213ac97fc50d8f3c4d48388bff8318",
  "original_prompt": "Ingested from linux-6.6.14/net/mac802154/ieee802154_i.h",
  "human_readable_source": " \n \n#ifndef __IEEE802154_I_H\n#define __IEEE802154_I_H\n\n#include <linux/interrupt.h>\n#include <linux/mutex.h>\n#include <linux/hrtimer.h>\n#include <net/cfg802154.h>\n#include <net/mac802154.h>\n#include <net/nl802154.h>\n#include <net/ieee802154_netdev.h>\n\n#include \"llsec.h\"\n\nenum ieee802154_ongoing {\n\tIEEE802154_IS_SCANNING = BIT(0),\n\tIEEE802154_IS_BEACONING = BIT(1),\n};\n\n \nstruct ieee802154_local {\n\tstruct ieee802154_hw hw;\n\tconst struct ieee802154_ops *ops;\n\n\t \n\tstruct ieee802154_hw_addr_filt addr_filt;\n\t \n\tstruct wpan_phy *phy;\n\n\tint open_count;\n\n\t \n\tstruct list_head\tinterfaces;\n\tstruct mutex\t\tiflist_mtx;\n\n\t \n\tstruct workqueue_struct\t*workqueue;\n\t \n\tstruct workqueue_struct\t*mac_wq;\n\n\tstruct hrtimer ifs_timer;\n\n\t \n\tu8 scan_page;\n\tu8 scan_channel;\n\tstruct ieee802154_beacon_req_frame scan_beacon_req;\n\tstruct cfg802154_scan_request __rcu *scan_req;\n\tstruct delayed_work scan_work;\n\n\t \n\tunsigned int beacon_interval;\n\tstruct ieee802154_beacon_frame beacon;\n\tstruct cfg802154_beacon_request __rcu *beacon_req;\n\tstruct delayed_work beacon_work;\n\n\t \n\tstruct list_head rx_beacon_list;\n\tstruct work_struct rx_beacon_work;\n\tstruct list_head rx_mac_cmd_list;\n\tstruct work_struct rx_mac_cmd_work;\n\n\tbool started;\n\tbool suspended;\n\tunsigned long ongoing;\n\n\tstruct tasklet_struct tasklet;\n\tstruct sk_buff_head skb_queue;\n\n\tstruct sk_buff *tx_skb;\n\tstruct work_struct sync_tx_work;\n\t \n\tint tx_result;\n};\n\nenum {\n\tIEEE802154_RX_MSG        = 1,\n};\n\nenum ieee802154_sdata_state_bits {\n\tSDATA_STATE_RUNNING,\n};\n\n \nstruct ieee802154_sub_if_data {\n\tstruct list_head list;  \n\n\tstruct wpan_dev wpan_dev;\n\n\tstruct ieee802154_local *local;\n\tstruct net_device *dev;\n\n\t \n\tenum ieee802154_filtering_level iface_default_filtering;\n\tenum ieee802154_filtering_level required_filtering;\n\n\tunsigned long state;\n\tchar name[IFNAMSIZ];\n\n\t \n\tstruct mutex sec_mtx;\n\n\tstruct mac802154_llsec sec;\n};\n\n \nextern const void *const mac802154_wpan_phy_privid;  \n\nstatic inline struct ieee802154_local *\nhw_to_local(struct ieee802154_hw *hw)\n{\n\treturn container_of(hw, struct ieee802154_local, hw);\n}\n\nstatic inline struct ieee802154_sub_if_data *\nIEEE802154_DEV_TO_SUB_IF(const struct net_device *dev)\n{\n\treturn netdev_priv(dev);\n}\n\nstatic inline struct ieee802154_sub_if_data *\nIEEE802154_WPAN_DEV_TO_SUB_IF(struct wpan_dev *wpan_dev)\n{\n\treturn container_of(wpan_dev, struct ieee802154_sub_if_data, wpan_dev);\n}\n\nstatic inline bool\nieee802154_sdata_running(struct ieee802154_sub_if_data *sdata)\n{\n\treturn test_bit(SDATA_STATE_RUNNING, &sdata->state);\n}\n\nstatic inline int ieee802154_get_mac_cmd(struct sk_buff *skb, u8 *mac_cmd)\n{\n\tstruct ieee802154_mac_cmd_pl mac_pl;\n\tint ret;\n\n\tif (mac_cb(skb)->type != IEEE802154_FC_TYPE_MAC_CMD)\n\t\treturn -EINVAL;\n\n\tret = ieee802154_mac_cmd_pl_pull(skb, &mac_pl);\n\tif (ret)\n\t\treturn ret;\n\n\t*mac_cmd = mac_pl.cmd_id;\n\treturn 0;\n}\n\nextern struct ieee802154_mlme_ops mac802154_mlme_wpan;\n\nvoid ieee802154_rx(struct ieee802154_local *local, struct sk_buff *skb);\nvoid ieee802154_xmit_sync_worker(struct work_struct *work);\nint ieee802154_sync_and_hold_queue(struct ieee802154_local *local);\nint ieee802154_mlme_op_pre(struct ieee802154_local *local);\nint ieee802154_mlme_tx(struct ieee802154_local *local,\n\t\t       struct ieee802154_sub_if_data *sdata,\n\t\t       struct sk_buff *skb);\nint ieee802154_mlme_tx_locked(struct ieee802154_local *local,\n\t\t\t      struct ieee802154_sub_if_data *sdata,\n\t\t\t      struct sk_buff *skb);\nvoid ieee802154_mlme_op_post(struct ieee802154_local *local);\nint ieee802154_mlme_tx_one(struct ieee802154_local *local,\n\t\t\t   struct ieee802154_sub_if_data *sdata,\n\t\t\t   struct sk_buff *skb);\nint ieee802154_mlme_tx_one_locked(struct ieee802154_local *local,\n\t\t\t\t  struct ieee802154_sub_if_data *sdata,\n\t\t\t\t  struct sk_buff *skb);\nnetdev_tx_t\nieee802154_monitor_start_xmit(struct sk_buff *skb, struct net_device *dev);\nnetdev_tx_t\nieee802154_subif_start_xmit(struct sk_buff *skb, struct net_device *dev);\nenum hrtimer_restart ieee802154_xmit_ifs_timer(struct hrtimer *timer);\n\n \nvoid ieee802154_hold_queue(struct ieee802154_local *local);\n\n \nvoid ieee802154_release_queue(struct ieee802154_local *local);\n\n \nvoid ieee802154_disable_queue(struct ieee802154_local *local);\n\n \nvoid mac802154_dev_set_page_channel(struct net_device *dev, u8 page, u8 chan);\n\nint mac802154_get_params(struct net_device *dev,\n\t\t\t struct ieee802154_llsec_params *params);\nint mac802154_set_params(struct net_device *dev,\n\t\t\t const struct ieee802154_llsec_params *params,\n\t\t\t int changed);\n\nint mac802154_add_key(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_key_id *id,\n\t\t      const struct ieee802154_llsec_key *key);\nint mac802154_del_key(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_key_id *id);\n\nint mac802154_add_dev(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_device *llsec_dev);\nint mac802154_del_dev(struct net_device *dev, __le64 dev_addr);\n\nint mac802154_add_devkey(struct net_device *dev,\n\t\t\t __le64 device_addr,\n\t\t\t const struct ieee802154_llsec_device_key *key);\nint mac802154_del_devkey(struct net_device *dev,\n\t\t\t __le64 device_addr,\n\t\t\t const struct ieee802154_llsec_device_key *key);\n\nint mac802154_add_seclevel(struct net_device *dev,\n\t\t\t   const struct ieee802154_llsec_seclevel *sl);\nint mac802154_del_seclevel(struct net_device *dev,\n\t\t\t   const struct ieee802154_llsec_seclevel *sl);\n\nvoid mac802154_lock_table(struct net_device *dev);\nvoid mac802154_get_table(struct net_device *dev,\n\t\t\t struct ieee802154_llsec_table **t);\nvoid mac802154_unlock_table(struct net_device *dev);\n\nint mac802154_wpan_update_llsec(struct net_device *dev);\n\n \nvoid mac802154_scan_worker(struct work_struct *work);\nint mac802154_trigger_scan_locked(struct ieee802154_sub_if_data *sdata,\n\t\t\t\t  struct cfg802154_scan_request *request);\nint mac802154_abort_scan_locked(struct ieee802154_local *local,\n\t\t\t\tstruct ieee802154_sub_if_data *sdata);\nint mac802154_process_beacon(struct ieee802154_local *local,\n\t\t\t     struct sk_buff *skb,\n\t\t\t     u8 page, u8 channel);\nvoid mac802154_rx_beacon_worker(struct work_struct *work);\n\nstatic inline bool mac802154_is_scanning(struct ieee802154_local *local)\n{\n\treturn test_bit(IEEE802154_IS_SCANNING, &local->ongoing);\n}\n\nvoid mac802154_beacon_worker(struct work_struct *work);\nint mac802154_send_beacons_locked(struct ieee802154_sub_if_data *sdata,\n\t\t\t\t  struct cfg802154_beacon_request *request);\nint mac802154_stop_beacons_locked(struct ieee802154_local *local,\n\t\t\t\t  struct ieee802154_sub_if_data *sdata);\n\nstatic inline bool mac802154_is_beaconing(struct ieee802154_local *local)\n{\n\treturn test_bit(IEEE802154_IS_BEACONING, &local->ongoing);\n}\n\nvoid mac802154_rx_mac_cmd_worker(struct work_struct *work);\n\n \nint ieee802154_iface_init(void);\nvoid ieee802154_iface_exit(void);\nvoid ieee802154_if_remove(struct ieee802154_sub_if_data *sdata);\nstruct net_device *\nieee802154_if_add(struct ieee802154_local *local, const char *name,\n\t\t  unsigned char name_assign_type, enum nl802154_iftype type,\n\t\t  __le64 extended_addr);\nvoid ieee802154_remove_interfaces(struct ieee802154_local *local);\nvoid ieee802154_stop_device(struct ieee802154_local *local);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}