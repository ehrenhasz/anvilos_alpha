{
  "module_name": "mib.c",
  "hash_id": "675ec4d74f2eb939ad7064e627ae9a877c017dffe37265a8adc87eea67f6549d",
  "original_prompt": "Ingested from linux-6.6.14/net/mac802154/mib.c",
  "human_readable_source": "\n \n\n#include <linux/if_arp.h>\n\n#include <net/mac802154.h>\n#include <net/ieee802154_netdev.h>\n#include <net/cfg802154.h>\n\n#include \"ieee802154_i.h\"\n#include \"driver-ops.h\"\n\nvoid mac802154_dev_set_page_channel(struct net_device *dev, u8 page, u8 chan)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tstruct ieee802154_local *local = sdata->local;\n\tint res;\n\n\tASSERT_RTNL();\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tres = drv_set_channel(local, page, chan);\n\tif (res) {\n\t\tpr_debug(\"set_channel failed\\n\");\n\t} else {\n\t\tlocal->phy->current_channel = chan;\n\t\tlocal->phy->current_page = page;\n\t}\n}\n\nint mac802154_get_params(struct net_device *dev,\n\t\t\t struct ieee802154_llsec_params *params)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_get_params(&sdata->sec, params);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_set_params(struct net_device *dev,\n\t\t\t const struct ieee802154_llsec_params *params,\n\t\t\t int changed)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_set_params(&sdata->sec, params, changed);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_add_key(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_key_id *id,\n\t\t      const struct ieee802154_llsec_key *key)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_key_add(&sdata->sec, id, key);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_del_key(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_key_id *id)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_key_del(&sdata->sec, id);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_add_dev(struct net_device *dev,\n\t\t      const struct ieee802154_llsec_device *llsec_dev)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_dev_add(&sdata->sec, llsec_dev);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_del_dev(struct net_device *dev, __le64 dev_addr)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_dev_del(&sdata->sec, dev_addr);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_add_devkey(struct net_device *dev,\n\t\t\t __le64 device_addr,\n\t\t\t const struct ieee802154_llsec_device_key *key)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_devkey_add(&sdata->sec, device_addr, key);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_del_devkey(struct net_device *dev,\n\t\t\t __le64 device_addr,\n\t\t\t const struct ieee802154_llsec_device_key *key)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_devkey_del(&sdata->sec, device_addr, key);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_add_seclevel(struct net_device *dev,\n\t\t\t   const struct ieee802154_llsec_seclevel *sl)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_seclevel_add(&sdata->sec, sl);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nint mac802154_del_seclevel(struct net_device *dev,\n\t\t\t   const struct ieee802154_llsec_seclevel *sl)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\tint res;\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n\tres = mac802154_llsec_seclevel_del(&sdata->sec, sl);\n\tmutex_unlock(&sdata->sec_mtx);\n\n\treturn res;\n}\n\nvoid mac802154_lock_table(struct net_device *dev)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_lock(&sdata->sec_mtx);\n}\n\nvoid mac802154_get_table(struct net_device *dev,\n\t\t\t struct ieee802154_llsec_table **t)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\t*t = &sdata->sec.table;\n}\n\nvoid mac802154_unlock_table(struct net_device *dev)\n{\n\tstruct ieee802154_sub_if_data *sdata = IEEE802154_DEV_TO_SUB_IF(dev);\n\n\tBUG_ON(dev->type != ARPHRD_IEEE802154);\n\n\tmutex_unlock(&sdata->sec_mtx);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}