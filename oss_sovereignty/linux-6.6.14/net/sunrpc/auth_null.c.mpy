{
  "module_name": "auth_null.c",
  "hash_id": "55db42f7045ff034bfb8f20bac1a6e5c38222764a32f8a4f132bfc12f63385bb",
  "original_prompt": "Ingested from linux-6.6.14/net/sunrpc/auth_null.c",
  "human_readable_source": "\n \n\n#include <linux/types.h>\n#include <linux/module.h>\n#include <linux/sunrpc/clnt.h>\n\n#if IS_ENABLED(CONFIG_SUNRPC_DEBUG)\n# define RPCDBG_FACILITY\tRPCDBG_AUTH\n#endif\n\nstatic struct rpc_auth null_auth;\nstatic struct rpc_cred null_cred;\n\nstatic struct rpc_auth *\nnul_create(const struct rpc_auth_create_args *args, struct rpc_clnt *clnt)\n{\n\trefcount_inc(&null_auth.au_count);\n\treturn &null_auth;\n}\n\nstatic void\nnul_destroy(struct rpc_auth *auth)\n{\n}\n\n \nstatic struct rpc_cred *\nnul_lookup_cred(struct rpc_auth *auth, struct auth_cred *acred, int flags)\n{\n\treturn get_rpccred(&null_cred);\n}\n\n \nstatic void\nnul_destroy_cred(struct rpc_cred *cred)\n{\n}\n\n \nstatic int\nnul_match(struct auth_cred *acred, struct rpc_cred *cred, int taskflags)\n{\n\treturn 1;\n}\n\n \nstatic int\nnul_marshal(struct rpc_task *task, struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 * sizeof(*p));\n\tif (!p)\n\t\treturn -EMSGSIZE;\n\t \n\t*p++ = rpc_auth_null;\n\t*p++ = xdr_zero;\n\t \n\t*p++ = rpc_auth_null;\n\t*p   = xdr_zero;\n\treturn 0;\n}\n\n \nstatic int\nnul_refresh(struct rpc_task *task)\n{\n\tset_bit(RPCAUTH_CRED_UPTODATE, &task->tk_rqstp->rq_cred->cr_flags);\n\treturn 0;\n}\n\nstatic int\nnul_validate(struct rpc_task *task, struct xdr_stream *xdr)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 2 * sizeof(*p));\n\tif (!p)\n\t\treturn -EIO;\n\tif (*p++ != rpc_auth_null)\n\t\treturn -EIO;\n\tif (*p != xdr_zero)\n\t\treturn -EIO;\n\treturn 0;\n}\n\nconst struct rpc_authops authnull_ops = {\n\t.owner\t\t= THIS_MODULE,\n\t.au_flavor\t= RPC_AUTH_NULL,\n\t.au_name\t= \"NULL\",\n\t.create\t\t= nul_create,\n\t.destroy\t= nul_destroy,\n\t.lookup_cred\t= nul_lookup_cred,\n};\n\nstatic\nstruct rpc_auth null_auth = {\n\t.au_cslack\t= NUL_CALLSLACK,\n\t.au_rslack\t= NUL_REPLYSLACK,\n\t.au_verfsize\t= NUL_REPLYSLACK,\n\t.au_ralign\t= NUL_REPLYSLACK,\n\t.au_ops\t\t= &authnull_ops,\n\t.au_flavor\t= RPC_AUTH_NULL,\n\t.au_count\t= REFCOUNT_INIT(1),\n};\n\nstatic\nconst struct rpc_credops null_credops = {\n\t.cr_name\t= \"AUTH_NULL\",\n\t.crdestroy\t= nul_destroy_cred,\n\t.crmatch\t= nul_match,\n\t.crmarshal\t= nul_marshal,\n\t.crwrap_req\t= rpcauth_wrap_req_encode,\n\t.crrefresh\t= nul_refresh,\n\t.crvalidate\t= nul_validate,\n\t.crunwrap_resp\t= rpcauth_unwrap_resp_decode,\n};\n\nstatic\nstruct rpc_cred null_cred = {\n\t.cr_lru\t\t= LIST_HEAD_INIT(null_cred.cr_lru),\n\t.cr_auth\t= &null_auth,\n\t.cr_ops\t\t= &null_credops,\n\t.cr_count\t= REFCOUNT_INIT(2),\n\t.cr_flags\t= 1UL << RPCAUTH_CRED_UPTODATE,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}