{
  "module_name": "gss_krb5_internal.h",
  "hash_id": "588537cc8706bd6f091c7ecf9abaaf0ee87d47a584b1bb593ab4fe2ba0414eac",
  "original_prompt": "Ingested from linux-6.6.14/net/sunrpc/auth_gss/gss_krb5_internal.h",
  "human_readable_source": " \n \n\n#ifndef _NET_SUNRPC_AUTH_GSS_KRB5_INTERNAL_H\n#define _NET_SUNRPC_AUTH_GSS_KRB5_INTERNAL_H\n\n \n#define BITS2OCTETS(x)\t((x) / 8)\n\nstruct krb5_ctx;\n\nstruct gss_krb5_enctype {\n\tconst u32\t\tetype;\t\t \n\tconst u32\t\tctype;\t\t \n\tconst char\t\t*name;\t\t \n\tconst char\t\t*encrypt_name;\t \n\tconst char\t\t*aux_cipher;\t \n\tconst char\t\t*cksum_name;\t \n\tconst u16\t\tsignalg;\t \n\tconst u16\t\tsealalg;\t \n\tconst u32\t\tcksumlength;\t \n\tconst u32\t\tkeyed_cksum;\t \n\tconst u32\t\tkeybytes;\t \n\tconst u32\t\tkeylength;\t \n\tconst u32\t\tKc_length;\t \n\tconst u32\t\tKe_length;\t \n\tconst u32\t\tKi_length;\t \n\n\tint (*derive_key)(const struct gss_krb5_enctype *gk5e,\n\t\t\t  const struct xdr_netobj *in,\n\t\t\t  struct xdr_netobj *out,\n\t\t\t  const struct xdr_netobj *label,\n\t\t\t  gfp_t gfp_mask);\n\tu32 (*encrypt)(struct krb5_ctx *kctx, u32 offset,\n\t\t       struct xdr_buf *buf, struct page **pages);\n\tu32 (*decrypt)(struct krb5_ctx *kctx, u32 offset, u32 len,\n\t\t       struct xdr_buf *buf, u32 *headskip, u32 *tailskip);\n\tu32 (*get_mic)(struct krb5_ctx *kctx, struct xdr_buf *text,\n\t\t       struct xdr_netobj *token);\n\tu32 (*verify_mic)(struct krb5_ctx *kctx, struct xdr_buf *message_buffer,\n\t\t\t  struct xdr_netobj *read_token);\n\tu32 (*wrap)(struct krb5_ctx *kctx, int offset,\n\t\t    struct xdr_buf *buf, struct page **pages);\n\tu32 (*unwrap)(struct krb5_ctx *kctx, int offset, int len,\n\t\t      struct xdr_buf *buf, unsigned int *slack,\n\t\t      unsigned int *align);\n};\n\n \n#define KRB5_CTX_FLAG_INITIATOR         0x00000001\n#define KRB5_CTX_FLAG_ACCEPTOR_SUBKEY   0x00000004\n\nstruct krb5_ctx {\n\tint\t\t\tinitiate;  \n\tu32\t\t\tenctype;\n\tu32\t\t\tflags;\n\tconst struct gss_krb5_enctype *gk5e;  \n\tstruct crypto_sync_skcipher *enc;\n\tstruct crypto_sync_skcipher *seq;\n\tstruct crypto_sync_skcipher *acceptor_enc;\n\tstruct crypto_sync_skcipher *initiator_enc;\n\tstruct crypto_sync_skcipher *acceptor_enc_aux;\n\tstruct crypto_sync_skcipher *initiator_enc_aux;\n\tstruct crypto_ahash\t*acceptor_sign;\n\tstruct crypto_ahash\t*initiator_sign;\n\tstruct crypto_ahash\t*initiator_integ;\n\tstruct crypto_ahash\t*acceptor_integ;\n\tu8\t\t\tKsess[GSS_KRB5_MAX_KEYLEN];  \n\tu8\t\t\tcksum[GSS_KRB5_MAX_KEYLEN];\n\tatomic_t\t\tseq_send;\n\tatomic64_t\t\tseq_send64;\n\ttime64_t\t\tendtime;\n\tstruct xdr_netobj\tmech_used;\n};\n\n \n\nu32 gss_krb5_get_mic_v2(struct krb5_ctx *ctx, struct xdr_buf *text,\n\t\t\tstruct xdr_netobj *token);\n\nu32 gss_krb5_verify_mic_v2(struct krb5_ctx *ctx, struct xdr_buf *message_buffer,\n\t\t\t   struct xdr_netobj *read_token);\n\nu32 gss_krb5_wrap_v2(struct krb5_ctx *kctx, int offset,\n\t\t     struct xdr_buf *buf, struct page **pages);\n\nu32 gss_krb5_unwrap_v2(struct krb5_ctx *kctx, int offset, int len,\n\t\t       struct xdr_buf *buf, unsigned int *slack,\n\t\t       unsigned int *align);\n\n \n\n \n\nint krb5_derive_key_v2(const struct gss_krb5_enctype *gk5e,\n\t\t       const struct xdr_netobj *inkey,\n\t\t       struct xdr_netobj *outkey,\n\t\t       const struct xdr_netobj *label,\n\t\t       gfp_t gfp_mask);\n\nint krb5_kdf_hmac_sha2(const struct gss_krb5_enctype *gk5e,\n\t\t       const struct xdr_netobj *inkey,\n\t\t       struct xdr_netobj *outkey,\n\t\t       const struct xdr_netobj *in_constant,\n\t\t       gfp_t gfp_mask);\n\nint krb5_kdf_feedback_cmac(const struct gss_krb5_enctype *gk5e,\n\t\t\t   const struct xdr_netobj *inkey,\n\t\t\t   struct xdr_netobj *outkey,\n\t\t\t   const struct xdr_netobj *in_constant,\n\t\t\t   gfp_t gfp_mask);\n\n \nstatic inline int krb5_derive_key(struct krb5_ctx *kctx,\n\t\t\t\t  const struct xdr_netobj *inkey,\n\t\t\t\t  struct xdr_netobj *outkey,\n\t\t\t\t  u32 usage, u8 seed, gfp_t gfp_mask)\n{\n\tconst struct gss_krb5_enctype *gk5e = kctx->gk5e;\n\tu8 label_data[GSS_KRB5_K5CLENGTH];\n\tstruct xdr_netobj label = {\n\t\t.len\t= sizeof(label_data),\n\t\t.data\t= label_data,\n\t};\n\t__be32 *p = (__be32 *)label_data;\n\n\t*p = cpu_to_be32(usage);\n\tlabel_data[4] = seed;\n\treturn gk5e->derive_key(gk5e, inkey, outkey, &label, gfp_mask);\n}\n\nvoid krb5_make_confounder(u8 *p, int conflen);\n\nu32 make_checksum(struct krb5_ctx *kctx, char *header, int hdrlen,\n\t\t  struct xdr_buf *body, int body_offset, u8 *cksumkey,\n\t\t  unsigned int usage, struct xdr_netobj *cksumout);\n\nu32 gss_krb5_checksum(struct crypto_ahash *tfm, char *header, int hdrlen,\n\t\t      const struct xdr_buf *body, int body_offset,\n\t\t      struct xdr_netobj *cksumout);\n\nu32 krb5_encrypt(struct crypto_sync_skcipher *key, void *iv, void *in,\n\t\t void *out, int length);\n\nu32 krb5_decrypt(struct crypto_sync_skcipher *key, void *iv, void *in,\n\t\t void *out, int length);\n\nint xdr_extend_head(struct xdr_buf *buf, unsigned int base,\n\t\t    unsigned int shiftlen);\n\nint gss_encrypt_xdr_buf(struct crypto_sync_skcipher *tfm,\n\t\t\tstruct xdr_buf *outbuf, int offset,\n\t\t\tstruct page **pages);\n\nint gss_decrypt_xdr_buf(struct crypto_sync_skcipher *tfm,\n\t\t\tstruct xdr_buf *inbuf, int offset);\n\nu32 gss_krb5_aes_encrypt(struct krb5_ctx *kctx, u32 offset,\n\t\t\t struct xdr_buf *buf, struct page **pages);\n\nu32 gss_krb5_aes_decrypt(struct krb5_ctx *kctx, u32 offset, u32 len,\n\t\t\t struct xdr_buf *buf, u32 *plainoffset, u32 *plainlen);\n\nu32 krb5_etm_encrypt(struct krb5_ctx *kctx, u32 offset, struct xdr_buf *buf,\n\t\t     struct page **pages);\n\nu32 krb5_etm_decrypt(struct krb5_ctx *kctx, u32 offset, u32 len,\n\t\t     struct xdr_buf *buf, u32 *headskip, u32 *tailskip);\n\n#if IS_ENABLED(CONFIG_KUNIT)\nvoid krb5_nfold(u32 inbits, const u8 *in, u32 outbits, u8 *out);\nconst struct gss_krb5_enctype *gss_krb5_lookup_enctype(u32 etype);\nint krb5_cbc_cts_encrypt(struct crypto_sync_skcipher *cts_tfm,\n\t\t\t struct crypto_sync_skcipher *cbc_tfm, u32 offset,\n\t\t\t struct xdr_buf *buf, struct page **pages,\n\t\t\t u8 *iv, unsigned int ivsize);\nint krb5_cbc_cts_decrypt(struct crypto_sync_skcipher *cts_tfm,\n\t\t\t struct crypto_sync_skcipher *cbc_tfm,\n\t\t\t u32 offset, struct xdr_buf *buf);\nu32 krb5_etm_checksum(struct crypto_sync_skcipher *cipher,\n\t\t      struct crypto_ahash *tfm, const struct xdr_buf *body,\n\t\t      int body_offset, struct xdr_netobj *cksumout);\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}