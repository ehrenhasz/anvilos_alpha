{
  "module_name": "llc_s_ac.c",
  "hash_id": "fcbd3e44923a9ddb969f3b8888e9ea1cc174655dfcdf74cea212e3b76efb9299",
  "original_prompt": "Ingested from linux-6.6.14/net/llc/llc_s_ac.c",
  "human_readable_source": " \n\n#include <linux/netdevice.h>\n#include <net/llc.h>\n#include <net/llc_pdu.h>\n#include <net/llc_s_ac.h>\n#include <net/llc_s_ev.h>\n#include <net/llc_sap.h>\n\n\n \nint llc_sap_action_unitdata_ind(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tllc_sap_rtn_pdu(sap, skb);\n\treturn 0;\n}\n\n \nint llc_sap_action_send_ui(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tstruct llc_sap_state_ev *ev = llc_sap_ev(skb);\n\tint rc;\n\n\tllc_pdu_header_init(skb, LLC_PDU_TYPE_U, ev->saddr.lsap,\n\t\t\t    ev->daddr.lsap, LLC_PDU_CMD);\n\tllc_pdu_init_as_ui_cmd(skb);\n\trc = llc_mac_hdr_init(skb, ev->saddr.mac, ev->daddr.mac);\n\tif (likely(!rc)) {\n\t\tskb_get(skb);\n\t\trc = dev_queue_xmit(skb);\n\t}\n\treturn rc;\n}\n\n \nint llc_sap_action_send_xid_c(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tstruct llc_sap_state_ev *ev = llc_sap_ev(skb);\n\tint rc;\n\n\tllc_pdu_header_init(skb, LLC_PDU_TYPE_U_XID, ev->saddr.lsap,\n\t\t\t    ev->daddr.lsap, LLC_PDU_CMD);\n\tllc_pdu_init_as_xid_cmd(skb, LLC_XID_NULL_CLASS_2, 0);\n\trc = llc_mac_hdr_init(skb, ev->saddr.mac, ev->daddr.mac);\n\tif (likely(!rc)) {\n\t\tskb_get(skb);\n\t\trc = dev_queue_xmit(skb);\n\t}\n\treturn rc;\n}\n\n \nint llc_sap_action_send_xid_r(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tu8 mac_da[ETH_ALEN], mac_sa[ETH_ALEN], dsap;\n\tint rc = 1;\n\tstruct sk_buff *nskb;\n\n\tllc_pdu_decode_sa(skb, mac_da);\n\tllc_pdu_decode_da(skb, mac_sa);\n\tllc_pdu_decode_ssap(skb, &dsap);\n\tnskb = llc_alloc_frame(NULL, skb->dev, LLC_PDU_TYPE_U,\n\t\t\t       sizeof(struct llc_xid_info));\n\tif (!nskb)\n\t\tgoto out;\n\tllc_pdu_header_init(nskb, LLC_PDU_TYPE_U, sap->laddr.lsap, dsap,\n\t\t\t    LLC_PDU_RSP);\n\tllc_pdu_init_as_xid_rsp(nskb, LLC_XID_NULL_CLASS_2, 0);\n\trc = llc_mac_hdr_init(nskb, mac_sa, mac_da);\n\tif (likely(!rc))\n\t\trc = dev_queue_xmit(nskb);\nout:\n\treturn rc;\n}\n\n \nint llc_sap_action_send_test_c(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tstruct llc_sap_state_ev *ev = llc_sap_ev(skb);\n\tint rc;\n\n\tllc_pdu_header_init(skb, LLC_PDU_TYPE_U, ev->saddr.lsap,\n\t\t\t    ev->daddr.lsap, LLC_PDU_CMD);\n\tllc_pdu_init_as_test_cmd(skb);\n\trc = llc_mac_hdr_init(skb, ev->saddr.mac, ev->daddr.mac);\n\tif (likely(!rc)) {\n\t\tskb_get(skb);\n\t\trc = dev_queue_xmit(skb);\n\t}\n\treturn rc;\n}\n\nint llc_sap_action_send_test_r(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tu8 mac_da[ETH_ALEN], mac_sa[ETH_ALEN], dsap;\n\tstruct sk_buff *nskb;\n\tint rc = 1;\n\tu32 data_size;\n\n\tif (skb->mac_len < ETH_HLEN)\n\t\treturn 1;\n\n\tllc_pdu_decode_sa(skb, mac_da);\n\tllc_pdu_decode_da(skb, mac_sa);\n\tllc_pdu_decode_ssap(skb, &dsap);\n\n\t \n\tdata_size = ntohs(eth_hdr(skb)->h_proto) - 3;\n\tnskb = llc_alloc_frame(NULL, skb->dev, LLC_PDU_TYPE_U, data_size);\n\tif (!nskb)\n\t\tgoto out;\n\tllc_pdu_header_init(nskb, LLC_PDU_TYPE_U, sap->laddr.lsap, dsap,\n\t\t\t    LLC_PDU_RSP);\n\tllc_pdu_init_as_test_rsp(nskb, skb);\n\trc = llc_mac_hdr_init(nskb, mac_sa, mac_da);\n\tif (likely(!rc))\n\t\trc = dev_queue_xmit(nskb);\nout:\n\treturn rc;\n}\n\n \nint llc_sap_action_report_status(struct llc_sap *sap, struct sk_buff *skb)\n{\n\treturn 0;\n}\n\n \nint llc_sap_action_xid_ind(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tllc_sap_rtn_pdu(sap, skb);\n\treturn 0;\n}\n\n \nint llc_sap_action_test_ind(struct llc_sap *sap, struct sk_buff *skb)\n{\n\tllc_sap_rtn_pdu(sap, skb);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}