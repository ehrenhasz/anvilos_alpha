{
  "module_name": "llc_station.c",
  "hash_id": "8c3204d381f9205c6bff1a0c2bf9367503ff9e0dab03b00b297a5410dc4a3e56",
  "original_prompt": "Ingested from linux-6.6.14/net/llc/llc_station.c",
  "human_readable_source": " \n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <net/llc.h>\n#include <net/llc_sap.h>\n#include <net/llc_conn.h>\n#include <net/llc_c_ac.h>\n#include <net/llc_s_ac.h>\n#include <net/llc_c_ev.h>\n#include <net/llc_c_st.h>\n#include <net/llc_s_ev.h>\n#include <net/llc_s_st.h>\n#include <net/llc_pdu.h>\n\nstatic int llc_stat_ev_rx_null_dsap_xid_c(struct sk_buff *skb)\n{\n\tstruct llc_pdu_un *pdu = llc_pdu_un_hdr(skb);\n\n\treturn LLC_PDU_IS_CMD(pdu) &&\t\t\t \n\t       LLC_PDU_TYPE_IS_U(pdu) &&\t\t \n\t       LLC_U_PDU_CMD(pdu) == LLC_1_PDU_CMD_XID &&\n\t       !pdu->dsap;\t\t\t\t \n}\n\nstatic int llc_stat_ev_rx_null_dsap_test_c(struct sk_buff *skb)\n{\n\tstruct llc_pdu_un *pdu = llc_pdu_un_hdr(skb);\n\n\treturn LLC_PDU_IS_CMD(pdu) &&\t\t\t \n\t       LLC_PDU_TYPE_IS_U(pdu) &&\t\t \n\t       LLC_U_PDU_CMD(pdu) == LLC_1_PDU_CMD_TEST &&\n\t       !pdu->dsap;\t\t\t\t \n}\n\nstatic int llc_station_ac_send_xid_r(struct sk_buff *skb)\n{\n\tu8 mac_da[ETH_ALEN], dsap;\n\tint rc = 1;\n\tstruct sk_buff *nskb = llc_alloc_frame(NULL, skb->dev, LLC_PDU_TYPE_U,\n\t\t\t\t\t       sizeof(struct llc_xid_info));\n\n\tif (!nskb)\n\t\tgoto out;\n\tllc_pdu_decode_sa(skb, mac_da);\n\tllc_pdu_decode_ssap(skb, &dsap);\n\tllc_pdu_header_init(nskb, LLC_PDU_TYPE_U, 0, dsap, LLC_PDU_RSP);\n\tllc_pdu_init_as_xid_rsp(nskb, LLC_XID_NULL_CLASS_2, 127);\n\trc = llc_mac_hdr_init(nskb, skb->dev->dev_addr, mac_da);\n\tif (unlikely(rc))\n\t\tgoto free;\n\tdev_queue_xmit(nskb);\nout:\n\treturn rc;\nfree:\n\tkfree_skb(nskb);\n\tgoto out;\n}\n\nstatic int llc_station_ac_send_test_r(struct sk_buff *skb)\n{\n\tu8 mac_da[ETH_ALEN], dsap;\n\tint rc = 1;\n\tu32 data_size;\n\tstruct sk_buff *nskb;\n\n\tif (skb->mac_len < ETH_HLEN)\n\t\tgoto out;\n\n\t \n\tdata_size = ntohs(eth_hdr(skb)->h_proto) - 3;\n\tnskb = llc_alloc_frame(NULL, skb->dev, LLC_PDU_TYPE_U, data_size);\n\n\tif (!nskb)\n\t\tgoto out;\n\tllc_pdu_decode_sa(skb, mac_da);\n\tllc_pdu_decode_ssap(skb, &dsap);\n\tllc_pdu_header_init(nskb, LLC_PDU_TYPE_U, 0, dsap, LLC_PDU_RSP);\n\tllc_pdu_init_as_test_rsp(nskb, skb);\n\trc = llc_mac_hdr_init(nskb, skb->dev->dev_addr, mac_da);\n\tif (unlikely(rc))\n\t\tgoto free;\n\tdev_queue_xmit(nskb);\nout:\n\treturn rc;\nfree:\n\tkfree_skb(nskb);\n\tgoto out;\n}\n\n \nstatic void llc_station_rcv(struct sk_buff *skb)\n{\n\tif (llc_stat_ev_rx_null_dsap_xid_c(skb))\n\t\tllc_station_ac_send_xid_r(skb);\n\telse if (llc_stat_ev_rx_null_dsap_test_c(skb))\n\t\tllc_station_ac_send_test_r(skb);\n\tkfree_skb(skb);\n}\n\nvoid __init llc_station_init(void)\n{\n\tllc_set_station_handler(llc_station_rcv);\n}\n\nvoid llc_station_exit(void)\n{\n\tllc_set_station_handler(NULL);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}