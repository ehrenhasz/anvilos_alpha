{
  "module_name": "sm_statetable.c",
  "hash_id": "c09b14f971a37de291430158cd152318ae481ad401ac47a17ab73fc96c98d441",
  "original_prompt": "Ingested from linux-6.6.14/net/sctp/sm_statetable.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/skbuff.h>\n#include <net/sctp/sctp.h>\n#include <net/sctp/sm.h>\n\nstatic const struct sctp_sm_table_entry\nprimitive_event_table[SCTP_NUM_PRIMITIVE_TYPES][SCTP_STATE_NUM_STATES];\nstatic const struct sctp_sm_table_entry\nother_event_table[SCTP_NUM_OTHER_TYPES][SCTP_STATE_NUM_STATES];\nstatic const struct sctp_sm_table_entry\ntimeout_event_table[SCTP_NUM_TIMEOUT_TYPES][SCTP_STATE_NUM_STATES];\n\nstatic const struct sctp_sm_table_entry *sctp_chunk_event_lookup(\n\t\t\t\t\t\tstruct net *net,\n\t\t\t\t\t\tenum sctp_cid cid,\n\t\t\t\t\t\tenum sctp_state state);\n\n\nstatic const struct sctp_sm_table_entry bug = {\n\t.fn = sctp_sf_bug,\n\t.name = \"sctp_sf_bug\"\n};\n\n#define DO_LOOKUP(_max, _type, _table)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tconst struct sctp_sm_table_entry *rtn;\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tif ((event_subtype._type > (_max))) {\t\t\t\t\\\n\t\tpr_warn(\"table %p possible attack: event %d exceeds max %d\\n\", \\\n\t\t\t_table, event_subtype._type, _max);\t\t\\\n\t\trtn = &bug;\t\t\t\t\t\t\\\n\t} else\t\t\t\t\t\t\t\t\\\n\t\trtn = &_table[event_subtype._type][(int)state];\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\trtn;\t\t\t\t\t\t\t\t\\\n})\n\nconst struct sctp_sm_table_entry *sctp_sm_lookup_event(\n\t\t\t\t\tstruct net *net,\n\t\t\t\t\tenum sctp_event_type event_type,\n\t\t\t\t\tenum sctp_state state,\n\t\t\t\t\tunion sctp_subtype event_subtype)\n{\n\tswitch (event_type) {\n\tcase SCTP_EVENT_T_CHUNK:\n\t\treturn sctp_chunk_event_lookup(net, event_subtype.chunk, state);\n\tcase SCTP_EVENT_T_TIMEOUT:\n\t\treturn DO_LOOKUP(SCTP_EVENT_TIMEOUT_MAX, timeout,\n\t\t\t\t timeout_event_table);\n\tcase SCTP_EVENT_T_OTHER:\n\t\treturn DO_LOOKUP(SCTP_EVENT_OTHER_MAX, other,\n\t\t\t\t other_event_table);\n\tcase SCTP_EVENT_T_PRIMITIVE:\n\t\treturn DO_LOOKUP(SCTP_EVENT_PRIMITIVE_MAX, primitive,\n\t\t\t\t primitive_event_table);\n\tdefault:\n\t\t \n\t\treturn &bug;\n\t}\n}\n\n#define TYPE_SCTP_FUNC(func) {.fn = func, .name = #func}\n\n#define TYPE_SCTP_DATA { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_data_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_data_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_data_fast_4_4), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_INIT { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_1B_init), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_1_siminit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_1_siminit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_2_dupinit), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_reshutack), \\\n}  \n\n#define TYPE_SCTP_INIT_ACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_3_initack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_1C_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_SACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_sack_6_2), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_HEARTBEAT { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n\t  \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_beat_8_3), \\\n}  \n\n#define TYPE_SCTP_HEARTBEAT_ACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_violation), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_backbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_ABORT { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_pdiscard), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_wait_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_echoed_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_1_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_pending_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_sent_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_1_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_ack_sent_abort), \\\n}  \n\n#define TYPE_SCTP_SHUTDOWN { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_shut_ctsn), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_SHUTDOWN_ACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_8_5_1_E_sa), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_8_5_1_E_sa), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_violation), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_violation), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_final), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_violation), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_final), \\\n}  \n\n#define TYPE_SCTP_ERROR { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_echoed_err), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_operr_notify), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_operr_notify), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_operr_notify), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_COOKIE_ECHO { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_1D_ce), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_2_4_dupcook), \\\n}  \n\n#define TYPE_SCTP_COOKIE_ACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_5_1E_ca), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_ECN_ECNE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecne), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecne), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecne), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecne), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecne), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_ECN_CWR { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_ecn_cwr), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_SHUTDOWN_COMPLETE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_4_C), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\nchunk_event_table[SCTP_NUM_BASE_CHUNK_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_DATA,\n\tTYPE_SCTP_INIT,\n\tTYPE_SCTP_INIT_ACK,\n\tTYPE_SCTP_SACK,\n\tTYPE_SCTP_HEARTBEAT,\n\tTYPE_SCTP_HEARTBEAT_ACK,\n\tTYPE_SCTP_ABORT,\n\tTYPE_SCTP_SHUTDOWN,\n\tTYPE_SCTP_SHUTDOWN_ACK,\n\tTYPE_SCTP_ERROR,\n\tTYPE_SCTP_COOKIE_ECHO,\n\tTYPE_SCTP_COOKIE_ACK,\n\tTYPE_SCTP_ECN_ECNE,\n\tTYPE_SCTP_ECN_CWR,\n\tTYPE_SCTP_SHUTDOWN_COMPLETE,\n};  \n\n#define TYPE_SCTP_ASCONF { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n#define TYPE_SCTP_ASCONF_ACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_asconf_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\naddip_chunk_event_table[SCTP_NUM_ADDIP_CHUNK_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_ASCONF,\n\tTYPE_SCTP_ASCONF_ACK,\n};  \n\n#define TYPE_SCTP_FWD_TSN { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_fwd_tsn_fast), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\nprsctp_chunk_event_table[SCTP_NUM_PRSCTP_CHUNK_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_FWD_TSN,\n};  \n\n#define TYPE_SCTP_RECONF { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\nreconf_chunk_event_table[SCTP_NUM_RECONF_CHUNK_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_RECONF,\n};  \n\n#define TYPE_SCTP_AUTH { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ootb), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_eat_auth), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\nauth_chunk_event_table[SCTP_NUM_AUTH_CHUNK_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_AUTH,\n};  \n\nstatic const struct sctp_sm_table_entry\npad_chunk_event_table[SCTP_STATE_NUM_STATES] = {\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_discard_chunk),\n};\t \n\nstatic const struct sctp_sm_table_entry\nchunk_event_table_unknown[SCTP_STATE_NUM_STATES] = {\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_ootb),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n\t \n\tTYPE_SCTP_FUNC(sctp_sf_unk_chunk),\n};\t \n\n\n#define TYPE_SCTP_PRIMITIVE_ASSOCIATE  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_asoc), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_not_impl), \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_SHUTDOWN  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_wait_prm_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_echoed_prm_shutdown),\\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_prm_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_primitive), \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_ABORT  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_wait_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_echoed_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_1_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_pending_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_sent_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_1_prm_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_shutdown_ack_sent_prm_abort), \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_SEND  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_send), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_send), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_send), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_requestheartbeat),          \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_ASCONF { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_asconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n}  \n\n#define TYPE_SCTP_PRIMITIVE_RECONF { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_closed), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_prm_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_error_shutdown), \\\n}  \n\n \nstatic const struct sctp_sm_table_entry\nprimitive_event_table[SCTP_NUM_PRIMITIVE_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_PRIMITIVE_ASSOCIATE,\n\tTYPE_SCTP_PRIMITIVE_SHUTDOWN,\n\tTYPE_SCTP_PRIMITIVE_ABORT,\n\tTYPE_SCTP_PRIMITIVE_SEND,\n\tTYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT,\n\tTYPE_SCTP_PRIMITIVE_ASCONF,\n\tTYPE_SCTP_PRIMITIVE_RECONF,\n};\n\n#define TYPE_SCTP_OTHER_NO_PENDING_TSN  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_no_pending_tsn), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_start_shutdown), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_9_2_shutdown_ack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n}\n\n#define TYPE_SCTP_OTHER_ICMP_PROTO_UNREACH  { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_cookie_wait_icmp_abort), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_ignore_other), \\\n}\n\nstatic const struct sctp_sm_table_entry\nother_event_table[SCTP_NUM_OTHER_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_OTHER_NO_PENDING_TSN,\n\tTYPE_SCTP_OTHER_ICMP_PROTO_UNREACH,\n};\n\n#define TYPE_SCTP_EVENT_TIMEOUT_NONE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_bug), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t1_cookie_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T1_INIT { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t1_init_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t2_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t2_timer_expire), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T3_RTX { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_3_3_rtx), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T4_RTO { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t4_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t5_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_t5_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_sendbeat_8_3), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_SACK { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_do_6_2_sack), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_autoclose_timer_expire), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_RECONF { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_send_reconf), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\n#define TYPE_SCTP_EVENT_TIMEOUT_PROBE { \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_send_probe), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n\t  \\\n\tTYPE_SCTP_FUNC(sctp_sf_timer_ignore), \\\n}\n\nstatic const struct sctp_sm_table_entry\ntimeout_event_table[SCTP_NUM_TIMEOUT_TYPES][SCTP_STATE_NUM_STATES] = {\n\tTYPE_SCTP_EVENT_TIMEOUT_NONE,\n\tTYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE,\n\tTYPE_SCTP_EVENT_TIMEOUT_T1_INIT,\n\tTYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN,\n\tTYPE_SCTP_EVENT_TIMEOUT_T3_RTX,\n\tTYPE_SCTP_EVENT_TIMEOUT_T4_RTO,\n\tTYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD,\n\tTYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT,\n\tTYPE_SCTP_EVENT_TIMEOUT_RECONF,\n\tTYPE_SCTP_EVENT_TIMEOUT_PROBE,\n\tTYPE_SCTP_EVENT_TIMEOUT_SACK,\n\tTYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE,\n};\n\nstatic const struct sctp_sm_table_entry *sctp_chunk_event_lookup(\n\t\t\t\t\t\tstruct net *net,\n\t\t\t\t\t\tenum sctp_cid cid,\n\t\t\t\t\t\tenum sctp_state state)\n{\n\tif (state > SCTP_STATE_MAX)\n\t\treturn &bug;\n\n\tif (cid == SCTP_CID_I_DATA)\n\t\tcid = SCTP_CID_DATA;\n\n\tif (cid <= SCTP_CID_BASE_MAX)\n\t\treturn &chunk_event_table[cid][state];\n\n\tswitch ((u16)cid) {\n\tcase SCTP_CID_FWD_TSN:\n\tcase SCTP_CID_I_FWD_TSN:\n\t\treturn &prsctp_chunk_event_table[0][state];\n\n\tcase SCTP_CID_ASCONF:\n\t\treturn &addip_chunk_event_table[0][state];\n\n\tcase SCTP_CID_ASCONF_ACK:\n\t\treturn &addip_chunk_event_table[1][state];\n\n\tcase SCTP_CID_RECONF:\n\t\treturn &reconf_chunk_event_table[0][state];\n\n\tcase SCTP_CID_AUTH:\n\t\treturn &auth_chunk_event_table[0][state];\n\n\tcase SCTP_CID_PAD:\n\t\treturn &pad_chunk_event_table[state];\n\t}\n\n\treturn &chunk_event_table_unknown[state];\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}