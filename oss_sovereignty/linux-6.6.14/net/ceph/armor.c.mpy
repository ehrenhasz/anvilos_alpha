{
  "module_name": "armor.c",
  "hash_id": "b72149408e018f643605e97b17e4ca4fde58e8d83a8f3c058d34173c2ff55539",
  "original_prompt": "Ingested from linux-6.6.14/net/ceph/armor.c",
  "human_readable_source": "\n\n#include <linux/errno.h>\n\nint ceph_armor(char *dst, const char *src, const char *end);\nint ceph_unarmor(char *dst, const char *src, const char *end);\n\n \n\nstatic const char *pem_key =\n\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\nstatic int encode_bits(int c)\n{\n\treturn pem_key[c];\n}\n\nstatic int decode_bits(char c)\n{\n\tif (c >= 'A' && c <= 'Z')\n\t\treturn c - 'A';\n\tif (c >= 'a' && c <= 'z')\n\t\treturn c - 'a' + 26;\n\tif (c >= '0' && c <= '9')\n\t\treturn c - '0' + 52;\n\tif (c == '+')\n\t\treturn 62;\n\tif (c == '/')\n\t\treturn 63;\n\tif (c == '=')\n\t\treturn 0;  \n\treturn -EINVAL;\n}\n\nint ceph_armor(char *dst, const char *src, const char *end)\n{\n\tint olen = 0;\n\tint line = 0;\n\n\twhile (src < end) {\n\t\tunsigned char a, b, c;\n\n\t\ta = *src++;\n\t\t*dst++ = encode_bits(a >> 2);\n\t\tif (src < end) {\n\t\t\tb = *src++;\n\t\t\t*dst++ = encode_bits(((a & 3) << 4) | (b >> 4));\n\t\t\tif (src < end) {\n\t\t\t\tc = *src++;\n\t\t\t\t*dst++ = encode_bits(((b & 15) << 2) |\n\t\t\t\t\t\t     (c >> 6));\n\t\t\t\t*dst++ = encode_bits(c & 63);\n\t\t\t} else {\n\t\t\t\t*dst++ = encode_bits((b & 15) << 2);\n\t\t\t\t*dst++ = '=';\n\t\t\t}\n\t\t} else {\n\t\t\t*dst++ = encode_bits(((a & 3) << 4));\n\t\t\t*dst++ = '=';\n\t\t\t*dst++ = '=';\n\t\t}\n\t\tolen += 4;\n\t\tline += 4;\n\t\tif (line == 64) {\n\t\t\tline = 0;\n\t\t\t*(dst++) = '\\n';\n\t\t\tolen++;\n\t\t}\n\t}\n\treturn olen;\n}\n\nint ceph_unarmor(char *dst, const char *src, const char *end)\n{\n\tint olen = 0;\n\n\twhile (src < end) {\n\t\tint a, b, c, d;\n\n\t\tif (src[0] == '\\n') {\n\t\t\tsrc++;\n\t\t\tcontinue;\n\t\t}\n\t\tif (src + 4 > end)\n\t\t\treturn -EINVAL;\n\t\ta = decode_bits(src[0]);\n\t\tb = decode_bits(src[1]);\n\t\tc = decode_bits(src[2]);\n\t\td = decode_bits(src[3]);\n\t\tif (a < 0 || b < 0 || c < 0 || d < 0)\n\t\t\treturn -EINVAL;\n\n\t\t*dst++ = (a << 2) | (b >> 4);\n\t\tif (src[2] == '=')\n\t\t\treturn olen + 1;\n\t\t*dst++ = ((b & 15) << 4) | (c >> 2);\n\t\tif (src[3] == '=')\n\t\t\treturn olen + 2;\n\t\t*dst++ = ((c & 3) << 6) | d;\n\t\tolen += 3;\n\t\tsrc += 4;\n\t}\n\treturn olen;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}