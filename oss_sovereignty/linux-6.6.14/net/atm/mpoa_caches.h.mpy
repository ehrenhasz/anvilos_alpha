{
  "module_name": "mpoa_caches.h",
  "hash_id": "427bc7027f3e8f06a835a4f7f5d40e8c57960b210ee5f48323fc698ad9164991",
  "original_prompt": "Ingested from linux-6.6.14/net/atm/mpoa_caches.h",
  "human_readable_source": " \n#ifndef MPOA_CACHES_H\n#define MPOA_CACHES_H\n\n#include <linux/time64.h>\n#include <linux/netdevice.h>\n#include <linux/types.h>\n#include <linux/atm.h>\n#include <linux/atmdev.h>\n#include <linux/atmmpc.h>\n#include <linux/refcount.h>\n\nstruct mpoa_client;\n\nvoid atm_mpoa_init_cache(struct mpoa_client *mpc);\n\ntypedef struct in_cache_entry {\n\tstruct in_cache_entry *next;\n\tstruct in_cache_entry *prev;\n\ttime64_t  time;\n\ttime64_t  reply_wait;\n\ttime64_t  hold_down;\n\tuint32_t  packets_fwded;\n\tuint16_t  entry_state;\n\tuint32_t retry_time;\n\tuint32_t refresh_time;\n\tuint32_t count;\n\tstruct   atm_vcc *shortcut;\n\tuint8_t  MPS_ctrl_ATM_addr[ATM_ESA_LEN];\n\tstruct   in_ctrl_info ctrl_info;\n\trefcount_t use;\n} in_cache_entry;\n\nstruct in_cache_ops{\n\tin_cache_entry *(*add_entry)(__be32 dst_ip,\n\t\t\t\t      struct mpoa_client *client);\n\tin_cache_entry *(*get)(__be32 dst_ip, struct mpoa_client *client);\n\tin_cache_entry *(*get_with_mask)(__be32 dst_ip,\n\t\t\t\t\t struct mpoa_client *client,\n\t\t\t\t\t __be32 mask);\n\tin_cache_entry *(*get_by_vcc)(struct atm_vcc *vcc,\n\t\t\t\t      struct mpoa_client *client);\n\tvoid            (*put)(in_cache_entry *entry);\n\tvoid            (*remove_entry)(in_cache_entry *delEntry,\n\t\t\t\t\tstruct mpoa_client *client );\n\tint             (*cache_hit)(in_cache_entry *entry,\n\t\t\t\t     struct mpoa_client *client);\n\tvoid            (*clear_count)(struct mpoa_client *client);\n\tvoid            (*check_resolving)(struct mpoa_client *client);\n\tvoid            (*refresh)(struct mpoa_client *client);\n\tvoid            (*destroy_cache)(struct mpoa_client *mpc);\n};\n\ntypedef struct eg_cache_entry{\n\tstruct               eg_cache_entry *next;\n\tstruct               eg_cache_entry *prev;\n\ttime64_t\t     time;\n\tuint8_t              MPS_ctrl_ATM_addr[ATM_ESA_LEN];\n\tstruct atm_vcc       *shortcut;\n\tuint32_t             packets_rcvd;\n\tuint16_t             entry_state;\n\t__be32             latest_ip_addr;     \n\tstruct eg_ctrl_info  ctrl_info;\n\trefcount_t             use;\n} eg_cache_entry;\n\nstruct eg_cache_ops{\n\teg_cache_entry *(*add_entry)(struct k_message *msg, struct mpoa_client *client);\n\teg_cache_entry *(*get_by_cache_id)(__be32 cache_id, struct mpoa_client *client);\n\teg_cache_entry *(*get_by_tag)(__be32 cache_id, struct mpoa_client *client);\n\teg_cache_entry *(*get_by_vcc)(struct atm_vcc *vcc, struct mpoa_client *client);\n\teg_cache_entry *(*get_by_src_ip)(__be32 ipaddr, struct mpoa_client *client);\n\tvoid            (*put)(eg_cache_entry *entry);\n\tvoid            (*remove_entry)(eg_cache_entry *entry, struct mpoa_client *client);\n\tvoid            (*update)(eg_cache_entry *entry, uint16_t holding_time);\n\tvoid            (*clear_expired)(struct mpoa_client *client);\n\tvoid            (*destroy_cache)(struct mpoa_client *mpc);\n};\n\n\n \n\n#define INGRESS_REFRESHING 3\n#define INGRESS_RESOLVED   2\n#define INGRESS_RESOLVING  1\n#define INGRESS_INVALID    0\n\n \n\n#define OPEN   1\n#define CLOSED 0\n\n \n\n#define EGRESS_RESOLVED 2\n#define EGRESS_PURGE    1\n#define EGRESS_INVALID  0\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}