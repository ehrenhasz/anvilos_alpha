{
  "module_name": "raw.c",
  "hash_id": "871e3592161d87a849f438d9fc87e5a50b4e191f0a043cd3bfde8afd427ef097",
  "original_prompt": "Ingested from linux-6.6.14/net/atm/raw.c",
  "human_readable_source": "\n \n\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \":%s: \" fmt, __func__\n\n#include <linux/module.h>\n#include <linux/atmdev.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/skbuff.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\n#include \"common.h\"\n#include \"protocols.h\"\n\n \n\nstatic void atm_push_raw(struct atm_vcc *vcc, struct sk_buff *skb)\n{\n\tif (skb) {\n\t\tstruct sock *sk = sk_atm(vcc);\n\n\t\tskb_queue_tail(&sk->sk_receive_queue, skb);\n\t\tsk->sk_data_ready(sk);\n\t}\n}\n\nstatic void atm_pop_raw(struct atm_vcc *vcc, struct sk_buff *skb)\n{\n\tstruct sock *sk = sk_atm(vcc);\n\n\tpr_debug(\"(%d) %d -= %d\\n\",\n\t\t vcc->vci, sk_wmem_alloc_get(sk), ATM_SKB(skb)->acct_truesize);\n\tWARN_ON(refcount_sub_and_test(ATM_SKB(skb)->acct_truesize, &sk->sk_wmem_alloc));\n\tdev_kfree_skb_any(skb);\n\tsk->sk_write_space(sk);\n}\n\nstatic int atm_send_aal0(struct atm_vcc *vcc, struct sk_buff *skb)\n{\n\t \n\tif (!capable(CAP_NET_ADMIN) &&\n\t    (((u32 *)skb->data)[0] & (ATM_HDR_VPI_MASK | ATM_HDR_VCI_MASK)) !=\n\t    ((vcc->vpi << ATM_HDR_VPI_SHIFT) |\n\t     (vcc->vci << ATM_HDR_VCI_SHIFT))) {\n\t\tkfree_skb(skb);\n\t\treturn -EADDRNOTAVAIL;\n\t}\n\tif (vcc->dev->ops->send_bh)\n\t\treturn vcc->dev->ops->send_bh(vcc, skb);\n\treturn vcc->dev->ops->send(vcc, skb);\n}\n\nint atm_init_aal0(struct atm_vcc *vcc)\n{\n\tvcc->push = atm_push_raw;\n\tvcc->pop = atm_pop_raw;\n\tvcc->push_oam = NULL;\n\tvcc->send = atm_send_aal0;\n\treturn 0;\n}\n\nint atm_init_aal34(struct atm_vcc *vcc)\n{\n\tvcc->push = atm_push_raw;\n\tvcc->pop = atm_pop_raw;\n\tvcc->push_oam = NULL;\n\tif (vcc->dev->ops->send_bh)\n\t\tvcc->send = vcc->dev->ops->send_bh;\n\telse\n\t\tvcc->send = vcc->dev->ops->send;\n\treturn 0;\n}\n\nint atm_init_aal5(struct atm_vcc *vcc)\n{\n\tvcc->push = atm_push_raw;\n\tvcc->pop = atm_pop_raw;\n\tvcc->push_oam = NULL;\n\tif (vcc->dev->ops->send_bh)\n\t\tvcc->send = vcc->dev->ops->send_bh;\n\telse\n\t\tvcc->send = vcc->dev->ops->send;\n\treturn 0;\n}\nEXPORT_SYMBOL(atm_init_aal5);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}