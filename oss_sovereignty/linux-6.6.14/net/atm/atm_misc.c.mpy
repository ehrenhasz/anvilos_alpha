{
  "module_name": "atm_misc.c",
  "hash_id": "d5b4acfee692988432cf10eefd4cececa3fb0016e94e53a96a991a38ce592d94",
  "original_prompt": "Ingested from linux-6.6.14/net/atm/atm_misc.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/module.h>\n#include <linux/atm.h>\n#include <linux/atmdev.h>\n#include <linux/skbuff.h>\n#include <linux/sonet.h>\n#include <linux/bitops.h>\n#include <linux/errno.h>\n#include <linux/atomic.h>\n\nint atm_charge(struct atm_vcc *vcc, int truesize)\n{\n\tatm_force_charge(vcc, truesize);\n\tif (atomic_read(&sk_atm(vcc)->sk_rmem_alloc) <= sk_atm(vcc)->sk_rcvbuf)\n\t\treturn 1;\n\tatm_return(vcc, truesize);\n\tatomic_inc(&vcc->stats->rx_drop);\n\treturn 0;\n}\nEXPORT_SYMBOL(atm_charge);\n\nstruct sk_buff *atm_alloc_charge(struct atm_vcc *vcc, int pdu_size,\n\t\t\t\t gfp_t gfp_flags)\n{\n\tstruct sock *sk = sk_atm(vcc);\n\tint guess = SKB_TRUESIZE(pdu_size);\n\n\tatm_force_charge(vcc, guess);\n\tif (atomic_read(&sk->sk_rmem_alloc) <= sk->sk_rcvbuf) {\n\t\tstruct sk_buff *skb = alloc_skb(pdu_size, gfp_flags);\n\n\t\tif (skb) {\n\t\t\tatomic_add(skb->truesize-guess,\n\t\t\t\t   &sk->sk_rmem_alloc);\n\t\t\treturn skb;\n\t\t}\n\t}\n\tatm_return(vcc, guess);\n\tatomic_inc(&vcc->stats->rx_drop);\n\treturn NULL;\n}\nEXPORT_SYMBOL(atm_alloc_charge);\n\n\n \n\nint atm_pcr_goal(const struct atm_trafprm *tp)\n{\n\tif (tp->pcr && tp->pcr != ATM_MAX_PCR)\n\t\treturn -tp->pcr;\n\tif (tp->min_pcr && !tp->pcr)\n\t\treturn tp->min_pcr;\n\tif (tp->max_pcr != ATM_MAX_PCR)\n\t\treturn -tp->max_pcr;\n\treturn 0;\n}\nEXPORT_SYMBOL(atm_pcr_goal);\n\nvoid sonet_copy_stats(struct k_sonet_stats *from, struct sonet_stats *to)\n{\n#define __HANDLE_ITEM(i) to->i = atomic_read(&from->i)\n\t__SONET_ITEMS\n#undef __HANDLE_ITEM\n}\nEXPORT_SYMBOL(sonet_copy_stats);\n\nvoid sonet_subtract_stats(struct k_sonet_stats *from, struct sonet_stats *to)\n{\n#define __HANDLE_ITEM(i) atomic_sub(to->i, &from->i)\n\t__SONET_ITEMS\n#undef __HANDLE_ITEM\n}\nEXPORT_SYMBOL(sonet_subtract_stats);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}