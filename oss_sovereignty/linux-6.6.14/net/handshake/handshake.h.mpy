{
  "module_name": "handshake.h",
  "hash_id": "aa807e2e051ee8bf903eebaaf7d685b8797f7f483ecda3ee0b6f02511bdde827",
  "original_prompt": "Ingested from linux-6.6.14/net/handshake/handshake.h",
  "human_readable_source": " \n \n\n#ifndef _INTERNAL_HANDSHAKE_H\n#define _INTERNAL_HANDSHAKE_H\n\n \nstruct handshake_net {\n\tspinlock_t\t\thn_lock;\t \n\tint\t\t\thn_pending;\n\tint\t\t\thn_pending_max;\n\tstruct list_head\thn_requests;\n\n\tunsigned long\t\thn_flags;\n};\n\nenum hn_flags_bits {\n\tHANDSHAKE_F_NET_DRAINING,\n};\n\nstruct handshake_proto;\n\n \nstruct handshake_req {\n\tstruct list_head\t\thr_list;\n\tstruct rhash_head\t\thr_rhash;\n\tunsigned long\t\t\thr_flags;\n\tconst struct handshake_proto\t*hr_proto;\n\tstruct sock\t\t\t*hr_sk;\n\tvoid\t\t\t\t(*hr_odestruct)(struct sock *sk);\n\n\t \n\tchar\t\t\t\thr_priv[];\n};\n\nenum hr_flags_bits {\n\tHANDSHAKE_F_REQ_COMPLETED,\n\tHANDSHAKE_F_REQ_SESSION,\n};\n\nstruct genl_info;\n\n \nstruct handshake_proto {\n\tint\t\t\thp_handler_class;\n\tsize_t\t\t\thp_privsize;\n\tunsigned long\t\thp_flags;\n\n\tint\t\t\t(*hp_accept)(struct handshake_req *req,\n\t\t\t\t\t     struct genl_info *info, int fd);\n\tvoid\t\t\t(*hp_done)(struct handshake_req *req,\n\t\t\t\t\t   unsigned int status,\n\t\t\t\t\t   struct genl_info *info);\n\tvoid\t\t\t(*hp_destroy)(struct handshake_req *req);\n};\n\nenum hp_flags_bits {\n\tHANDSHAKE_F_PROTO_NOTIFY,\n};\n\n \nint tls_alert_send(struct socket *sock, u8 level, u8 description);\n\n \nint handshake_genl_notify(struct net *net, const struct handshake_proto *proto,\n\t\t\t  gfp_t flags);\nstruct nlmsghdr *handshake_genl_put(struct sk_buff *msg,\n\t\t\t\t    struct genl_info *info);\nstruct handshake_net *handshake_pernet(struct net *net);\n\n \nstruct handshake_req *handshake_req_alloc(const struct handshake_proto *proto,\n\t\t\t\t\t  gfp_t flags);\nint handshake_req_hash_init(void);\nvoid handshake_req_hash_destroy(void);\nvoid *handshake_req_private(struct handshake_req *req);\nstruct handshake_req *handshake_req_hash_lookup(struct sock *sk);\nstruct handshake_req *handshake_req_next(struct handshake_net *hn, int class);\nint handshake_req_submit(struct socket *sock, struct handshake_req *req,\n\t\t\t gfp_t flags);\nvoid handshake_complete(struct handshake_req *req, unsigned int status,\n\t\t\tstruct genl_info *info);\nbool handshake_req_cancel(struct sock *sk);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}