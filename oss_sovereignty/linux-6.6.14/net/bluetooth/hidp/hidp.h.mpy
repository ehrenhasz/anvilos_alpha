{
  "module_name": "hidp.h",
  "hash_id": "749cb9a5c37d8893946ed562988fedcf6e70dc9a707514f403ae725f5408e037",
  "original_prompt": "Ingested from linux-6.6.14/net/bluetooth/hidp/hidp.h",
  "human_readable_source": " \n\n#ifndef __HIDP_H\n#define __HIDP_H\n\n#include <linux/types.h>\n#include <linux/hid.h>\n#include <linux/kref.h>\n#include <net/bluetooth/bluetooth.h>\n#include <net/bluetooth/l2cap.h>\n\n \n#define HIDP_HEADER_TRANS_MASK\t\t\t0xf0\n#define HIDP_HEADER_PARAM_MASK\t\t\t0x0f\n\n \n#define HIDP_TRANS_HANDSHAKE\t\t\t0x00\n#define HIDP_TRANS_HID_CONTROL\t\t\t0x10\n#define HIDP_TRANS_GET_REPORT\t\t\t0x40\n#define HIDP_TRANS_SET_REPORT\t\t\t0x50\n#define HIDP_TRANS_GET_PROTOCOL\t\t\t0x60\n#define HIDP_TRANS_SET_PROTOCOL\t\t\t0x70\n#define HIDP_TRANS_GET_IDLE\t\t\t0x80\n#define HIDP_TRANS_SET_IDLE\t\t\t0x90\n#define HIDP_TRANS_DATA\t\t\t\t0xa0\n#define HIDP_TRANS_DATC\t\t\t\t0xb0\n\n \n#define HIDP_HSHK_SUCCESSFUL\t\t\t0x00\n#define HIDP_HSHK_NOT_READY\t\t\t0x01\n#define HIDP_HSHK_ERR_INVALID_REPORT_ID\t\t0x02\n#define HIDP_HSHK_ERR_UNSUPPORTED_REQUEST\t0x03\n#define HIDP_HSHK_ERR_INVALID_PARAMETER\t\t0x04\n#define HIDP_HSHK_ERR_UNKNOWN\t\t\t0x0e\n#define HIDP_HSHK_ERR_FATAL\t\t\t0x0f\n\n \n#define HIDP_CTRL_NOP\t\t\t\t0x00\n#define HIDP_CTRL_HARD_RESET\t\t\t0x01\n#define HIDP_CTRL_SOFT_RESET\t\t\t0x02\n#define HIDP_CTRL_SUSPEND\t\t\t0x03\n#define HIDP_CTRL_EXIT_SUSPEND\t\t\t0x04\n#define HIDP_CTRL_VIRTUAL_CABLE_UNPLUG\t\t0x05\n\n \n#define HIDP_DATA_RTYPE_MASK\t\t\t0x03\n#define HIDP_DATA_RSRVD_MASK\t\t\t0x0c\n#define HIDP_DATA_RTYPE_OTHER\t\t\t0x00\n#define HIDP_DATA_RTYPE_INPUT\t\t\t0x01\n#define HIDP_DATA_RTYPE_OUPUT\t\t\t0x02\n#define HIDP_DATA_RTYPE_FEATURE\t\t\t0x03\n\n \n#define HIDP_PROTO_BOOT\t\t\t\t0x00\n#define HIDP_PROTO_REPORT\t\t\t0x01\n\n \n#define HIDPCONNADD\t_IOW('H', 200, int)\n#define HIDPCONNDEL\t_IOW('H', 201, int)\n#define HIDPGETCONNLIST\t_IOR('H', 210, int)\n#define HIDPGETCONNINFO\t_IOR('H', 211, int)\n\n#define HIDP_VIRTUAL_CABLE_UNPLUG\t0\n#define HIDP_BOOT_PROTOCOL_MODE\t\t1\n#define HIDP_BLUETOOTH_VENDOR_ID\t9\n#define HIDP_WAITING_FOR_RETURN\t\t10\n#define HIDP_WAITING_FOR_SEND_ACK\t11\n\nstruct hidp_connadd_req {\n\tint   ctrl_sock;\t \n\tint   intr_sock;\t \n\t__u16 parser;\n\t__u16 rd_size;\n\t__u8 __user *rd_data;\n\t__u8  country;\n\t__u8  subclass;\n\t__u16 vendor;\n\t__u16 product;\n\t__u16 version;\n\t__u32 flags;\n\t__u32 idle_to;\n\tchar  name[128];\n};\n\nstruct hidp_conndel_req {\n\tbdaddr_t bdaddr;\n\t__u32    flags;\n};\n\nstruct hidp_conninfo {\n\tbdaddr_t bdaddr;\n\t__u32    flags;\n\t__u16    state;\n\t__u16    vendor;\n\t__u16    product;\n\t__u16    version;\n\tchar     name[128];\n};\n\nstruct hidp_connlist_req {\n\t__u32  cnum;\n\tstruct hidp_conninfo __user *ci;\n};\n\nint hidp_connection_add(const struct hidp_connadd_req *req, struct socket *ctrl_sock, struct socket *intr_sock);\nint hidp_connection_del(struct hidp_conndel_req *req);\nint hidp_get_connlist(struct hidp_connlist_req *req);\nint hidp_get_conninfo(struct hidp_conninfo *ci);\n\nenum hidp_session_state {\n\tHIDP_SESSION_IDLING,\n\tHIDP_SESSION_PREPARING,\n\tHIDP_SESSION_RUNNING,\n};\n\n \nstruct hidp_session {\n\tstruct list_head list;\n\tstruct kref ref;\n\n\t \n\tatomic_t state;\n\twait_queue_head_t state_queue;\n\tatomic_t terminate;\n\tstruct task_struct *task;\n\tunsigned long flags;\n\n\t \n\tbdaddr_t bdaddr;\n\tstruct l2cap_conn *conn;\n\tstruct l2cap_user user;\n\tstruct socket *ctrl_sock;\n\tstruct socket *intr_sock;\n\tstruct sk_buff_head ctrl_transmit;\n\tstruct sk_buff_head intr_transmit;\n\tuint ctrl_mtu;\n\tuint intr_mtu;\n\tunsigned long idle_to;\n\n\t \n\tstruct work_struct dev_init;\n\tstruct input_dev *input;\n\tstruct hid_device *hid;\n\tstruct timer_list timer;\n\n\t \n\t__u8 *rd_data;\n\tuint rd_size;\n\n\t \n\tunsigned char keys[8];\n\tunsigned char leds;\n\n\t \n\tint waiting_report_type;  \n\tint waiting_report_number;  \n\tstruct mutex report_mutex;\n\tstruct sk_buff *report_return;\n\twait_queue_head_t report_queue;\n\n\t \n\tint output_report_success;  \n\n\t \n\tu8 input_buf[HID_MAX_BUFFER_SIZE];\n};\n\n \nint __init hidp_init_sockets(void);\nvoid __exit hidp_cleanup_sockets(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}