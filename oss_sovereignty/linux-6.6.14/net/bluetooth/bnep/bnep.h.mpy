{
  "module_name": "bnep.h",
  "hash_id": "c9527bc6972ef365345b63dd0518641a482f4433bdd4b9f2c80b671ea205001d",
  "original_prompt": "Ingested from linux-6.6.14/net/bluetooth/bnep/bnep.h",
  "human_readable_source": " \n \n\n#ifndef _BNEP_H\n#define _BNEP_H\n\n#include <linux/types.h>\n#include <linux/crc32.h>\n#include <net/bluetooth/bluetooth.h>\n\n \n#define BNEP_MAX_PROTO_FILTERS\t\t5\n#define BNEP_MAX_MULTICAST_FILTERS\t20\n\n \n#define BNEP_BASE_UUID\t0x0000000000001000800000805F9B34FB\n#define BNEP_UUID16\t0x02\n#define BNEP_UUID32\t0x04\n#define BNEP_UUID128\t0x16\n\n#define BNEP_SVC_PANU\t0x1115\n#define BNEP_SVC_NAP\t0x1116\n#define BNEP_SVC_GN\t0x1117\n\n \n#define BNEP_GENERAL\t\t\t0x00\n#define BNEP_CONTROL\t\t\t0x01\n#define BNEP_COMPRESSED\t\t\t0x02\n#define BNEP_COMPRESSED_SRC_ONLY\t0x03\n#define BNEP_COMPRESSED_DST_ONLY\t0x04\n\n \n#define BNEP_CMD_NOT_UNDERSTOOD\t\t0x00\n#define BNEP_SETUP_CONN_REQ\t\t0x01\n#define BNEP_SETUP_CONN_RSP\t\t0x02\n#define BNEP_FILTER_NET_TYPE_SET\t0x03\n#define BNEP_FILTER_NET_TYPE_RSP\t0x04\n#define BNEP_FILTER_MULTI_ADDR_SET\t0x05\n#define BNEP_FILTER_MULTI_ADDR_RSP\t0x06\n\n \n#define BNEP_EXT_CONTROL 0x00\n\n \n#define BNEP_SUCCESS 0x00\n\n#define BNEP_CONN_INVALID_DST 0x01\n#define BNEP_CONN_INVALID_SRC 0x02\n#define BNEP_CONN_INVALID_SVC 0x03\n#define BNEP_CONN_NOT_ALLOWED 0x04\n\n#define BNEP_FILTER_UNSUPPORTED_REQ\t0x01\n#define BNEP_FILTER_INVALID_RANGE\t0x02\n#define BNEP_FILTER_INVALID_MCADDR\t0x02\n#define BNEP_FILTER_LIMIT_REACHED\t0x03\n#define BNEP_FILTER_DENIED_SECURITY\t0x04\n\n \n#define BNEP_MTU\t1691\n#define BNEP_PSM\t0x0f\n#define BNEP_FLUSH_TO\t0xffff\n#define BNEP_CONNECT_TO\t15\n#define BNEP_FILTER_TO\t15\n\n \n#define BNEP_TYPE_MASK\t0x7f\n#define BNEP_EXT_HEADER\t0x80\n\nstruct bnep_setup_conn_req {\n\t__u8 type;\n\t__u8 ctrl;\n\t__u8 uuid_size;\n\t__u8 service[];\n} __packed;\n\nstruct bnep_set_filter_req {\n\t__u8 type;\n\t__u8 ctrl;\n\t__be16 len;\n\t__u8 list[];\n} __packed;\n\nstruct bnep_control_rsp {\n\t__u8 type;\n\t__u8 ctrl;\n\t__be16 resp;\n} __packed;\n\nstruct bnep_ext_hdr {\n\t__u8 type;\n\t__u8 len;\n\t__u8 data[];\n} __packed;\n\n \n#define BNEPCONNADD\t_IOW('B', 200, int)\n#define BNEPCONNDEL\t_IOW('B', 201, int)\n#define BNEPGETCONNLIST\t_IOR('B', 210, int)\n#define BNEPGETCONNINFO\t_IOR('B', 211, int)\n#define BNEPGETSUPPFEAT\t_IOR('B', 212, int)\n\n#define BNEP_SETUP_RESPONSE\t0\n#define BNEP_SETUP_RSP_SENT\t10\n\nstruct bnep_connadd_req {\n\tint   sock;\t\t \n\t__u32 flags;\n\t__u16 role;\n\tchar  device[16];\t \n};\n\nstruct bnep_conndel_req {\n\t__u32 flags;\n\t__u8  dst[ETH_ALEN];\n};\n\nstruct bnep_conninfo {\n\t__u32 flags;\n\t__u16 role;\n\t__u16 state;\n\t__u8  dst[ETH_ALEN];\n\tchar  device[16];\n};\n\nstruct bnep_connlist_req {\n\t__u32  cnum;\n\tstruct bnep_conninfo __user *ci;\n};\n\nstruct bnep_proto_filter {\n\t__u16 start;\n\t__u16 end;\n};\n\nint bnep_add_connection(struct bnep_connadd_req *req, struct socket *sock);\nint bnep_del_connection(struct bnep_conndel_req *req);\nint bnep_get_connlist(struct bnep_connlist_req *req);\nint bnep_get_conninfo(struct bnep_conninfo *ci);\n\n \nstruct bnep_session {\n\tstruct list_head list;\n\n\tunsigned int  role;\n\tunsigned long state;\n\tunsigned long flags;\n\tatomic_t      terminate;\n\tstruct task_struct *task;\n\n\tstruct ethhdr eh;\n\tstruct msghdr msg;\n\n\tstruct bnep_proto_filter proto_filter[BNEP_MAX_PROTO_FILTERS];\n\tunsigned long long mc_filter;\n\n\tstruct socket    *sock;\n\tstruct net_device *dev;\n};\n\nvoid bnep_net_setup(struct net_device *dev);\nint bnep_sock_init(void);\nvoid bnep_sock_cleanup(void);\n\nstatic inline int bnep_mc_hash(__u8 *addr)\n{\n\treturn crc32_be(~0, addr, ETH_ALEN) >> 26;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}