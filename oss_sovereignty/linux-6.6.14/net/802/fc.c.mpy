{
  "module_name": "fc.c",
  "hash_id": "833342661ea50803373a7cb5c5016ebbc1c2d8600d5e8e77bf682b11425dd613",
  "original_prompt": "Ingested from linux-6.6.14/net/802/fc.c",
  "human_readable_source": "\n \n\n#include <linux/uaccess.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/socket.h>\n#include <linux/in.h>\n#include <linux/inet.h>\n#include <linux/netdevice.h>\n#include <linux/fcdevice.h>\n#include <linux/skbuff.h>\n#include <linux/errno.h>\n#include <linux/timer.h>\n#include <linux/net.h>\n#include <linux/proc_fs.h>\n#include <linux/init.h>\n#include <linux/export.h>\n#include <net/arp.h>\n\n \n\nstatic int fc_header(struct sk_buff *skb, struct net_device *dev,\n\t\t     unsigned short type,\n\t\t     const void *daddr, const void *saddr, unsigned int len)\n{\n\tstruct fch_hdr *fch;\n\tint hdr_len;\n\n\t \n\tif (type == ETH_P_IP || type == ETH_P_ARP)\n\t{\n\t\tstruct fcllc *fcllc;\n\n\t\thdr_len = sizeof(struct fch_hdr) + sizeof(struct fcllc);\n\t\tfch = skb_push(skb, hdr_len);\n\t\tfcllc = (struct fcllc *)(fch+1);\n\t\tfcllc->dsap = fcllc->ssap = EXTENDED_SAP;\n\t\tfcllc->llc = UI_CMD;\n\t\tfcllc->protid[0] = fcllc->protid[1] = fcllc->protid[2] = 0x00;\n\t\tfcllc->ethertype = htons(type);\n\t}\n\telse\n\t{\n\t\thdr_len = sizeof(struct fch_hdr);\n\t\tfch = skb_push(skb, hdr_len);\n\t}\n\n\tif(saddr)\n\t\tmemcpy(fch->saddr,saddr,dev->addr_len);\n\telse\n\t\tmemcpy(fch->saddr,dev->dev_addr,dev->addr_len);\n\n\tif(daddr)\n\t{\n\t\tmemcpy(fch->daddr,daddr,dev->addr_len);\n\t\treturn hdr_len;\n\t}\n\treturn -hdr_len;\n}\n\nstatic const struct header_ops fc_header_ops = {\n\t.create\t = fc_header,\n};\n\nstatic void fc_setup(struct net_device *dev)\n{\n\tdev->header_ops\t\t= &fc_header_ops;\n\tdev->type\t\t= ARPHRD_IEEE802;\n\tdev->hard_header_len\t= FC_HLEN;\n\tdev->mtu\t\t= 2024;\n\tdev->addr_len\t\t= FC_ALEN;\n\tdev->tx_queue_len\t= 100;  \n\tdev->flags\t\t= IFF_BROADCAST;\n\n\tmemset(dev->broadcast, 0xFF, FC_ALEN);\n}\n\n \nstruct net_device *alloc_fcdev(int sizeof_priv)\n{\n\treturn alloc_netdev(sizeof_priv, \"fc%d\", NET_NAME_UNKNOWN, fc_setup);\n}\nEXPORT_SYMBOL(alloc_fcdev);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}