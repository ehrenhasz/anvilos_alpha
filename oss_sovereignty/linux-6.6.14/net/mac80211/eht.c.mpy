{
  "module_name": "eht.c",
  "hash_id": "c89aa0fe960d58b7483cf8f8aad4bc22de7a6092c0adb914005ef16cd3cd32c0",
  "original_prompt": "Ingested from linux-6.6.14/net/mac80211/eht.c",
  "human_readable_source": "\n \n\n#include \"ieee80211_i.h\"\n\nvoid\nieee80211_eht_cap_ie_to_sta_eht_cap(struct ieee80211_sub_if_data *sdata,\n\t\t\t\t    struct ieee80211_supported_band *sband,\n\t\t\t\t    const u8 *he_cap_ie, u8 he_cap_len,\n\t\t\t\t    const struct ieee80211_eht_cap_elem *eht_cap_ie_elem,\n\t\t\t\t    u8 eht_cap_len,\n\t\t\t\t    struct link_sta_info *link_sta)\n{\n\tstruct ieee80211_sta_eht_cap *eht_cap = &link_sta->pub->eht_cap;\n\tstruct ieee80211_he_cap_elem *he_cap_ie_elem = (void *)he_cap_ie;\n\tu8 eht_ppe_size = 0;\n\tu8 mcs_nss_size;\n\tu8 eht_total_size = sizeof(eht_cap->eht_cap_elem);\n\tu8 *pos = (u8 *)eht_cap_ie_elem;\n\n\tmemset(eht_cap, 0, sizeof(*eht_cap));\n\n\tif (!eht_cap_ie_elem ||\n\t    !ieee80211_get_eht_iftype_cap_vif(sband, &sdata->vif))\n\t\treturn;\n\n\tmcs_nss_size = ieee80211_eht_mcs_nss_size(he_cap_ie_elem,\n\t\t\t\t\t\t  &eht_cap_ie_elem->fixed,\n\t\t\t\t\t\t  sdata->vif.type ==\n\t\t\t\t\t\t\tNL80211_IFTYPE_STATION);\n\n\teht_total_size += mcs_nss_size;\n\n\t \n\tif (eht_cap_ie_elem->fixed.phy_cap_info[5] &\n\t\t\tIEEE80211_EHT_PHY_CAP5_PPE_THRESHOLD_PRESENT) {\n\t\tu16 eht_ppe_hdr;\n\n\t\tif (eht_cap_len < eht_total_size + sizeof(u16))\n\t\t\treturn;\n\n\t\teht_ppe_hdr = get_unaligned_le16(eht_cap_ie_elem->optional + mcs_nss_size);\n\t\teht_ppe_size =\n\t\t\tieee80211_eht_ppe_size(eht_ppe_hdr,\n\t\t\t\t\t       eht_cap_ie_elem->fixed.phy_cap_info);\n\t\teht_total_size += eht_ppe_size;\n\n\t\t \n\t\tif (eht_ppe_size > sizeof(eht_cap->eht_ppe_thres))\n\t\t\treturn;\n\t}\n\n\tif (eht_cap_len < eht_total_size)\n\t\treturn;\n\n\t \n\tmemcpy(&eht_cap->eht_cap_elem, pos, sizeof(eht_cap->eht_cap_elem));\n\tpos += sizeof(eht_cap->eht_cap_elem);\n\n\t \n\tmemset(&eht_cap->eht_mcs_nss_supp, 0,\n\t       sizeof(eht_cap->eht_mcs_nss_supp));\n\tmemcpy(&eht_cap->eht_mcs_nss_supp, pos, mcs_nss_size);\n\n\tif (eht_ppe_size)\n\t\tmemcpy(eht_cap->eht_ppe_thres,\n\t\t       &eht_cap_ie_elem->optional[mcs_nss_size],\n\t\t       eht_ppe_size);\n\n\teht_cap->has_eht = true;\n\n\tlink_sta->cur_max_bandwidth = ieee80211_sta_cap_rx_bw(link_sta);\n\tlink_sta->pub->bandwidth = ieee80211_sta_cur_vht_bw(link_sta);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}