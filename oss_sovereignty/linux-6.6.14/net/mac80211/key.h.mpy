{
  "module_name": "key.h",
  "hash_id": "7042975d2b7d5c956e7e56ba7cafa1885a05da3725ed76cb1b147a91277d39b1",
  "original_prompt": "Ingested from linux-6.6.14/net/mac80211/key.h",
  "human_readable_source": " \n \n\n#ifndef IEEE80211_KEY_H\n#define IEEE80211_KEY_H\n\n#include <linux/types.h>\n#include <linux/list.h>\n#include <linux/crypto.h>\n#include <linux/rcupdate.h>\n#include <crypto/arc4.h>\n#include <net/mac80211.h>\n\n#define NUM_DEFAULT_KEYS 4\n#define NUM_DEFAULT_MGMT_KEYS 2\n#define NUM_DEFAULT_BEACON_KEYS 2\n#define INVALID_PTK_KEYIDX 2  \n\nstruct ieee80211_local;\nstruct ieee80211_sub_if_data;\nstruct ieee80211_link_data;\nstruct sta_info;\n\n \nenum ieee80211_internal_key_flags {\n\tKEY_FLAG_UPLOADED_TO_HARDWARE\t= BIT(0),\n\tKEY_FLAG_TAINTED\t\t= BIT(1),\n};\n\nenum ieee80211_internal_tkip_state {\n\tTKIP_STATE_NOT_INIT,\n\tTKIP_STATE_PHASE1_DONE,\n\tTKIP_STATE_PHASE1_HW_UPLOADED,\n};\n\nstruct tkip_ctx {\n\tu16 p1k[5];\t \n\tu32 p1k_iv32;\t \n\tenum ieee80211_internal_tkip_state state;\n};\n\nstruct tkip_ctx_rx {\n\tstruct tkip_ctx ctx;\n\tu32 iv32;\t \n\tu16 iv16;\t \n};\n\nstruct ieee80211_key {\n\tstruct ieee80211_local *local;\n\tstruct ieee80211_sub_if_data *sdata;\n\tstruct sta_info *sta;\n\n\t \n\tstruct list_head list;\n\n\t \n\tunsigned int flags;\n\n\tunion {\n\t\tstruct {\n\t\t\t \n\t\t\tspinlock_t txlock;\n\n\t\t\t \n\t\t\tstruct tkip_ctx tx;\n\n\t\t\t \n\t\t\tstruct tkip_ctx_rx rx[IEEE80211_NUM_TIDS];\n\n\t\t\t \n\t\t\tu32 mic_failures;\n\t\t} tkip;\n\t\tstruct {\n\t\t\t \n\t\t\tu8 rx_pn[IEEE80211_NUM_TIDS + 1][IEEE80211_CCMP_PN_LEN];\n\t\t\tstruct crypto_aead *tfm;\n\t\t\tu32 replays;  \n\t\t} ccmp;\n\t\tstruct {\n\t\t\tu8 rx_pn[IEEE80211_CMAC_PN_LEN];\n\t\t\tstruct crypto_shash *tfm;\n\t\t\tu32 replays;  \n\t\t\tu32 icverrors;  \n\t\t} aes_cmac;\n\t\tstruct {\n\t\t\tu8 rx_pn[IEEE80211_GMAC_PN_LEN];\n\t\t\tstruct crypto_aead *tfm;\n\t\t\tu32 replays;  \n\t\t\tu32 icverrors;  \n\t\t} aes_gmac;\n\t\tstruct {\n\t\t\t \n\t\t\tu8 rx_pn[IEEE80211_NUM_TIDS + 1][IEEE80211_GCMP_PN_LEN];\n\t\t\tstruct crypto_aead *tfm;\n\t\t\tu32 replays;  \n\t\t} gcmp;\n\t\tstruct {\n\t\t\t \n\t\t\tu8 rx_pn[IEEE80211_NUM_TIDS + 1][IEEE80211_MAX_PN_LEN];\n\t\t} gen;\n\t} u;\n\n#ifdef CONFIG_MAC80211_DEBUGFS\n\tstruct {\n\t\tstruct dentry *stalink;\n\t\tstruct dentry *dir;\n\t\tint cnt;\n\t} debugfs;\n#endif\n\n\tunsigned int color;\n\n\t \n\tstruct ieee80211_key_conf conf;\n};\n\nstruct ieee80211_key *\nieee80211_key_alloc(u32 cipher, int idx, size_t key_len,\n\t\t    const u8 *key_data,\n\t\t    size_t seq_len, const u8 *seq);\n \nint ieee80211_key_link(struct ieee80211_key *key,\n\t\t       struct ieee80211_link_data *link,\n\t\t       struct sta_info *sta);\nint ieee80211_set_tx_key(struct ieee80211_key *key);\nvoid ieee80211_key_free(struct ieee80211_key *key, bool delay_tailroom);\nvoid ieee80211_key_free_unused(struct ieee80211_key *key);\nvoid ieee80211_set_default_key(struct ieee80211_link_data *link, int idx,\n\t\t\t       bool uni, bool multi);\nvoid ieee80211_set_default_mgmt_key(struct ieee80211_link_data *link,\n\t\t\t\t    int idx);\nvoid ieee80211_set_default_beacon_key(struct ieee80211_link_data *link,\n\t\t\t\t      int idx);\nvoid ieee80211_remove_link_keys(struct ieee80211_link_data *link,\n\t\t\t\tstruct list_head *keys);\nvoid ieee80211_free_key_list(struct ieee80211_local *local,\n\t\t\t     struct list_head *keys);\nvoid ieee80211_free_keys(struct ieee80211_sub_if_data *sdata,\n\t\t\t bool force_synchronize);\nvoid ieee80211_free_sta_keys(struct ieee80211_local *local,\n\t\t\t     struct sta_info *sta);\nvoid ieee80211_reenable_keys(struct ieee80211_sub_if_data *sdata);\nint ieee80211_key_switch_links(struct ieee80211_sub_if_data *sdata,\n\t\t\t       unsigned long del_links_mask,\n\t\t\t       unsigned long add_links_mask);\n\n#define key_mtx_dereference(local, ref) \\\n\trcu_dereference_protected(ref, lockdep_is_held(&((local)->key_mtx)))\n#define rcu_dereference_check_key_mtx(local, ref) \\\n\trcu_dereference_check(ref, lockdep_is_held(&((local)->key_mtx)))\n\nvoid ieee80211_delayed_tailroom_dec(struct work_struct *wk);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}