{
  "module_name": "ax25_std_subr.c",
  "hash_id": "f6dfc3193002a0f3bee951bd20e70b6e0652bec0a3cbc573e136387a84ff6862",
  "original_prompt": "Ingested from linux-6.6.14/net/ax25/ax25_std_subr.c",
  "human_readable_source": "\n \n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/socket.h>\n#include <linux/in.h>\n#include <linux/kernel.h>\n#include <linux/timer.h>\n#include <linux/string.h>\n#include <linux/sockios.h>\n#include <linux/net.h>\n#include <net/ax25.h>\n#include <linux/inet.h>\n#include <linux/netdevice.h>\n#include <linux/skbuff.h>\n#include <net/sock.h>\n#include <linux/uaccess.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/interrupt.h>\n\n \n\nvoid ax25_std_nr_error_recovery(ax25_cb *ax25)\n{\n\tax25_std_establish_data_link(ax25);\n}\n\nvoid ax25_std_establish_data_link(ax25_cb *ax25)\n{\n\tax25->condition = 0x00;\n\tax25->n2count   = 0;\n\n\tif (ax25->modulus == AX25_MODULUS)\n\t\tax25_send_control(ax25, AX25_SABM, AX25_POLLON, AX25_COMMAND);\n\telse\n\t\tax25_send_control(ax25, AX25_SABME, AX25_POLLON, AX25_COMMAND);\n\n\tax25_calculate_t1(ax25);\n\tax25_stop_idletimer(ax25);\n\tax25_stop_t3timer(ax25);\n\tax25_stop_t2timer(ax25);\n\tax25_start_t1timer(ax25);\n}\n\nvoid ax25_std_transmit_enquiry(ax25_cb *ax25)\n{\n\tif (ax25->condition & AX25_COND_OWN_RX_BUSY)\n\t\tax25_send_control(ax25, AX25_RNR, AX25_POLLON, AX25_COMMAND);\n\telse\n\t\tax25_send_control(ax25, AX25_RR, AX25_POLLON, AX25_COMMAND);\n\n\tax25->condition &= ~AX25_COND_ACK_PENDING;\n\n\tax25_calculate_t1(ax25);\n\tax25_start_t1timer(ax25);\n}\n\nvoid ax25_std_enquiry_response(ax25_cb *ax25)\n{\n\tif (ax25->condition & AX25_COND_OWN_RX_BUSY)\n\t\tax25_send_control(ax25, AX25_RNR, AX25_POLLON, AX25_RESPONSE);\n\telse\n\t\tax25_send_control(ax25, AX25_RR, AX25_POLLON, AX25_RESPONSE);\n\n\tax25->condition &= ~AX25_COND_ACK_PENDING;\n}\n\nvoid ax25_std_timeout_response(ax25_cb *ax25)\n{\n\tif (ax25->condition & AX25_COND_OWN_RX_BUSY)\n\t\tax25_send_control(ax25, AX25_RNR, AX25_POLLOFF, AX25_RESPONSE);\n\telse\n\t\tax25_send_control(ax25, AX25_RR, AX25_POLLOFF, AX25_RESPONSE);\n\n\tax25->condition &= ~AX25_COND_ACK_PENDING;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}