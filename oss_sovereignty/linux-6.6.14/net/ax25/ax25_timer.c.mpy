{
  "module_name": "ax25_timer.c",
  "hash_id": "06431b115517678822629c5a6fc8f90ba5d6bfe8a43cd7869eb94291dbb2fdb4",
  "original_prompt": "Ingested from linux-6.6.14/net/ax25/ax25_timer.c",
  "human_readable_source": "\n \n#include <linux/errno.h>\n#include <linux/types.h>\n#include <linux/socket.h>\n#include <linux/in.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/timer.h>\n#include <linux/string.h>\n#include <linux/sockios.h>\n#include <linux/net.h>\n#include <net/ax25.h>\n#include <linux/inet.h>\n#include <linux/netdevice.h>\n#include <linux/skbuff.h>\n#include <net/sock.h>\n#include <linux/uaccess.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/interrupt.h>\n\nstatic void ax25_heartbeat_expiry(struct timer_list *);\nstatic void ax25_t1timer_expiry(struct timer_list *);\nstatic void ax25_t2timer_expiry(struct timer_list *);\nstatic void ax25_t3timer_expiry(struct timer_list *);\nstatic void ax25_idletimer_expiry(struct timer_list *);\n\nvoid ax25_setup_timers(ax25_cb *ax25)\n{\n\ttimer_setup(&ax25->timer, ax25_heartbeat_expiry, 0);\n\ttimer_setup(&ax25->t1timer, ax25_t1timer_expiry, 0);\n\ttimer_setup(&ax25->t2timer, ax25_t2timer_expiry, 0);\n\ttimer_setup(&ax25->t3timer, ax25_t3timer_expiry, 0);\n\ttimer_setup(&ax25->idletimer, ax25_idletimer_expiry, 0);\n}\n\nvoid ax25_start_heartbeat(ax25_cb *ax25)\n{\n\tmod_timer(&ax25->timer, jiffies + 5 * HZ);\n}\n\nvoid ax25_start_t1timer(ax25_cb *ax25)\n{\n\tmod_timer(&ax25->t1timer, jiffies + ax25->t1);\n}\n\nvoid ax25_start_t2timer(ax25_cb *ax25)\n{\n\tmod_timer(&ax25->t2timer, jiffies + ax25->t2);\n}\n\nvoid ax25_start_t3timer(ax25_cb *ax25)\n{\n\tif (ax25->t3 > 0)\n\t\tmod_timer(&ax25->t3timer, jiffies + ax25->t3);\n\telse\n\t\tdel_timer(&ax25->t3timer);\n}\n\nvoid ax25_start_idletimer(ax25_cb *ax25)\n{\n\tif (ax25->idle > 0)\n\t\tmod_timer(&ax25->idletimer, jiffies + ax25->idle);\n\telse\n\t\tdel_timer(&ax25->idletimer);\n}\n\nvoid ax25_stop_heartbeat(ax25_cb *ax25)\n{\n\tdel_timer(&ax25->timer);\n}\n\nvoid ax25_stop_t1timer(ax25_cb *ax25)\n{\n\tdel_timer(&ax25->t1timer);\n}\n\nvoid ax25_stop_t2timer(ax25_cb *ax25)\n{\n\tdel_timer(&ax25->t2timer);\n}\n\nvoid ax25_stop_t3timer(ax25_cb *ax25)\n{\n\tdel_timer(&ax25->t3timer);\n}\n\nvoid ax25_stop_idletimer(ax25_cb *ax25)\n{\n\tdel_timer(&ax25->idletimer);\n}\n\nint ax25_t1timer_running(ax25_cb *ax25)\n{\n\treturn timer_pending(&ax25->t1timer);\n}\n\nunsigned long ax25_display_timer(struct timer_list *timer)\n{\n\tlong delta = timer->expires - jiffies;\n\n\tif (!timer_pending(timer))\n\t\treturn 0;\n\n\treturn max(0L, delta);\n}\n\nEXPORT_SYMBOL(ax25_display_timer);\n\nstatic void ax25_heartbeat_expiry(struct timer_list *t)\n{\n\tint proto = AX25_PROTO_STD_SIMPLEX;\n\tax25_cb *ax25 = from_timer(ax25, t, timer);\n\n\tif (ax25->ax25_dev)\n\t\tproto = ax25->ax25_dev->values[AX25_VALUES_PROTOCOL];\n\n\tswitch (proto) {\n\tcase AX25_PROTO_STD_SIMPLEX:\n\tcase AX25_PROTO_STD_DUPLEX:\n\t\tax25_std_heartbeat_expiry(ax25);\n\t\tbreak;\n\n#ifdef CONFIG_AX25_DAMA_SLAVE\n\tcase AX25_PROTO_DAMA_SLAVE:\n\t\tif (ax25->ax25_dev->dama.slave)\n\t\t\tax25_ds_heartbeat_expiry(ax25);\n\t\telse\n\t\t\tax25_std_heartbeat_expiry(ax25);\n\t\tbreak;\n#endif\n\t}\n}\n\nstatic void ax25_t1timer_expiry(struct timer_list *t)\n{\n\tax25_cb *ax25 = from_timer(ax25, t, t1timer);\n\n\tswitch (ax25->ax25_dev->values[AX25_VALUES_PROTOCOL]) {\n\tcase AX25_PROTO_STD_SIMPLEX:\n\tcase AX25_PROTO_STD_DUPLEX:\n\t\tax25_std_t1timer_expiry(ax25);\n\t\tbreak;\n\n#ifdef CONFIG_AX25_DAMA_SLAVE\n\tcase AX25_PROTO_DAMA_SLAVE:\n\t\tif (!ax25->ax25_dev->dama.slave)\n\t\t\tax25_std_t1timer_expiry(ax25);\n\t\tbreak;\n#endif\n\t}\n}\n\nstatic void ax25_t2timer_expiry(struct timer_list *t)\n{\n\tax25_cb *ax25 = from_timer(ax25, t, t2timer);\n\n\tswitch (ax25->ax25_dev->values[AX25_VALUES_PROTOCOL]) {\n\tcase AX25_PROTO_STD_SIMPLEX:\n\tcase AX25_PROTO_STD_DUPLEX:\n\t\tax25_std_t2timer_expiry(ax25);\n\t\tbreak;\n\n#ifdef CONFIG_AX25_DAMA_SLAVE\n\tcase AX25_PROTO_DAMA_SLAVE:\n\t\tif (!ax25->ax25_dev->dama.slave)\n\t\t\tax25_std_t2timer_expiry(ax25);\n\t\tbreak;\n#endif\n\t}\n}\n\nstatic void ax25_t3timer_expiry(struct timer_list *t)\n{\n\tax25_cb *ax25 = from_timer(ax25, t, t3timer);\n\n\tswitch (ax25->ax25_dev->values[AX25_VALUES_PROTOCOL]) {\n\tcase AX25_PROTO_STD_SIMPLEX:\n\tcase AX25_PROTO_STD_DUPLEX:\n\t\tax25_std_t3timer_expiry(ax25);\n\t\tbreak;\n\n#ifdef CONFIG_AX25_DAMA_SLAVE\n\tcase AX25_PROTO_DAMA_SLAVE:\n\t\tif (ax25->ax25_dev->dama.slave)\n\t\t\tax25_ds_t3timer_expiry(ax25);\n\t\telse\n\t\t\tax25_std_t3timer_expiry(ax25);\n\t\tbreak;\n#endif\n\t}\n}\n\nstatic void ax25_idletimer_expiry(struct timer_list *t)\n{\n\tax25_cb *ax25 = from_timer(ax25, t, idletimer);\n\n\tswitch (ax25->ax25_dev->values[AX25_VALUES_PROTOCOL]) {\n\tcase AX25_PROTO_STD_SIMPLEX:\n\tcase AX25_PROTO_STD_DUPLEX:\n\t\tax25_std_idletimer_expiry(ax25);\n\t\tbreak;\n\n#ifdef CONFIG_AX25_DAMA_SLAVE\n\tcase AX25_PROTO_DAMA_SLAVE:\n\t\tif (ax25->ax25_dev->dama.slave)\n\t\t\tax25_ds_idletimer_expiry(ax25);\n\t\telse\n\t\t\tax25_std_idletimer_expiry(ax25);\n\t\tbreak;\n#endif\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}