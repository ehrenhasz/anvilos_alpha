{
  "module_name": "internal.h",
  "hash_id": "a6a57e1f990a6a479904882c7c13d24c7916832fea365d6d573dec55ce56adae",
  "original_prompt": "Ingested from linux-6.6.14/net/packet/internal.h",
  "human_readable_source": " \n#ifndef __PACKET_INTERNAL_H__\n#define __PACKET_INTERNAL_H__\n\n#include <linux/refcount.h>\n\nstruct packet_mclist {\n\tstruct packet_mclist\t*next;\n\tint\t\t\tifindex;\n\tint\t\t\tcount;\n\tunsigned short\t\ttype;\n\tunsigned short\t\talen;\n\tunsigned char\t\taddr[MAX_ADDR_LEN];\n};\n\n \nstruct tpacket_kbdq_core {\n\tstruct pgv\t*pkbdq;\n\tunsigned int\tfeature_req_word;\n\tunsigned int\thdrlen;\n\tunsigned char\treset_pending_on_curr_blk;\n\tunsigned char   delete_blk_timer;\n\tunsigned short\tkactive_blk_num;\n\tunsigned short\tblk_sizeof_priv;\n\n\t \n\tunsigned short\tlast_kactive_blk_num;\n\n\tchar\t\t*pkblk_start;\n\tchar\t\t*pkblk_end;\n\tint\t\tkblk_size;\n\tunsigned int\tmax_frame_len;\n\tunsigned int\tknum_blocks;\n\tuint64_t\tknxt_seq_num;\n\tchar\t\t*prev;\n\tchar\t\t*nxt_offset;\n\tstruct sk_buff\t*skb;\n\n\trwlock_t\tblk_fill_in_prog_lock;\n\n\t \n#define DEFAULT_PRB_RETIRE_TOV\t(8)\n\n\tunsigned short  retire_blk_tov;\n\tunsigned short  version;\n\tunsigned long\ttov_in_jiffies;\n\n\t \n\tstruct timer_list retire_blk_timer;\n};\n\nstruct pgv {\n\tchar *buffer;\n};\n\nstruct packet_ring_buffer {\n\tstruct pgv\t\t*pg_vec;\n\n\tunsigned int\t\thead;\n\tunsigned int\t\tframes_per_block;\n\tunsigned int\t\tframe_size;\n\tunsigned int\t\tframe_max;\n\n\tunsigned int\t\tpg_vec_order;\n\tunsigned int\t\tpg_vec_pages;\n\tunsigned int\t\tpg_vec_len;\n\n\tunsigned int __percpu\t*pending_refcnt;\n\n\tunion {\n\t\tunsigned long\t\t\t*rx_owner_map;\n\t\tstruct tpacket_kbdq_core\tprb_bdqc;\n\t};\n};\n\nextern struct mutex fanout_mutex;\n#define PACKET_FANOUT_MAX\t(1 << 16)\n\nstruct packet_fanout {\n\tpossible_net_t\t\tnet;\n\tunsigned int\t\tnum_members;\n\tu32\t\t\tmax_num_members;\n\tu16\t\t\tid;\n\tu8\t\t\ttype;\n\tu8\t\t\tflags;\n\tunion {\n\t\tatomic_t\t\trr_cur;\n\t\tstruct bpf_prog __rcu\t*bpf_prog;\n\t};\n\tstruct list_head\tlist;\n\tspinlock_t\t\tlock;\n\trefcount_t\t\tsk_ref;\n\tstruct packet_type\tprot_hook ____cacheline_aligned_in_smp;\n\tstruct sock\t__rcu\t*arr[];\n};\n\nstruct packet_rollover {\n\tint\t\t\tsock;\n\tatomic_long_t\t\tnum;\n\tatomic_long_t\t\tnum_huge;\n\tatomic_long_t\t\tnum_failed;\n#define ROLLOVER_HLEN\t(L1_CACHE_BYTES / sizeof(u32))\n\tu32\t\t\thistory[ROLLOVER_HLEN] ____cacheline_aligned;\n} ____cacheline_aligned_in_smp;\n\nstruct packet_sock {\n\t \n\tstruct sock\t\tsk;\n\tstruct packet_fanout\t*fanout;\n\tunion  tpacket_stats_u\tstats;\n\tstruct packet_ring_buffer\trx_ring;\n\tstruct packet_ring_buffer\ttx_ring;\n\tint\t\t\tcopy_thresh;\n\tspinlock_t\t\tbind_lock;\n\tstruct mutex\t\tpg_vec_lock;\n\tunsigned long\t\tflags;\n\tint\t\t\tifindex;\t \n\tu8\t\t\tvnet_hdr_sz;\n\t__be16\t\t\tnum;\n\tstruct packet_rollover\t*rollover;\n\tstruct packet_mclist\t*mclist;\n\tatomic_long_t\t\tmapped;\n\tenum tpacket_versions\ttp_version;\n\tunsigned int\t\ttp_hdrlen;\n\tunsigned int\t\ttp_reserve;\n\tunsigned int\t\ttp_tstamp;\n\tstruct completion\tskb_completion;\n\tstruct net_device __rcu\t*cached_dev;\n\tstruct packet_type\tprot_hook ____cacheline_aligned_in_smp;\n\tatomic_t\t\ttp_drops ____cacheline_aligned_in_smp;\n};\n\n#define pkt_sk(ptr) container_of_const(ptr, struct packet_sock, sk)\n\nenum packet_sock_flags {\n\tPACKET_SOCK_ORIGDEV,\n\tPACKET_SOCK_AUXDATA,\n\tPACKET_SOCK_TX_HAS_OFF,\n\tPACKET_SOCK_TP_LOSS,\n\tPACKET_SOCK_RUNNING,\n\tPACKET_SOCK_PRESSURE,\n\tPACKET_SOCK_QDISC_BYPASS,\n};\n\nstatic inline void packet_sock_flag_set(struct packet_sock *po,\n\t\t\t\t\tenum packet_sock_flags flag,\n\t\t\t\t\tbool val)\n{\n\tif (val)\n\t\tset_bit(flag, &po->flags);\n\telse\n\t\tclear_bit(flag, &po->flags);\n}\n\nstatic inline bool packet_sock_flag(const struct packet_sock *po,\n\t\t\t\t    enum packet_sock_flags flag)\n{\n\treturn test_bit(flag, &po->flags);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}