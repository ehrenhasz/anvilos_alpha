{
  "module_name": "xfrm_sysctl.c",
  "hash_id": "17146ad33103c380b17984f5640e7c27c04ef9189af0432d083b31acbc5184a8",
  "original_prompt": "Ingested from linux-6.6.14/net/xfrm/xfrm_sysctl.c",
  "human_readable_source": "\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <net/net_namespace.h>\n#include <net/xfrm.h>\n\nstatic void __net_init __xfrm_sysctl_init(struct net *net)\n{\n\tnet->xfrm.sysctl_aevent_etime = XFRM_AE_ETIME;\n\tnet->xfrm.sysctl_aevent_rseqth = XFRM_AE_SEQT_SIZE;\n\tnet->xfrm.sysctl_larval_drop = 1;\n\tnet->xfrm.sysctl_acq_expires = 30;\n}\n\n#ifdef CONFIG_SYSCTL\nstatic struct ctl_table xfrm_table[] = {\n\t{\n\t\t.procname\t= \"xfrm_aevent_etime\",\n\t\t.maxlen\t\t= sizeof(u32),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_douintvec\n\t},\n\t{\n\t\t.procname\t= \"xfrm_aevent_rseqth\",\n\t\t.maxlen\t\t= sizeof(u32),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_douintvec\n\t},\n\t{\n\t\t.procname\t= \"xfrm_larval_drop\",\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec\n\t},\n\t{\n\t\t.procname\t= \"xfrm_acq_expires\",\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec\n\t},\n\t{}\n};\n\nint __net_init xfrm_sysctl_init(struct net *net)\n{\n\tstruct ctl_table *table;\n\tsize_t table_size = ARRAY_SIZE(xfrm_table);\n\n\t__xfrm_sysctl_init(net);\n\n\ttable = kmemdup(xfrm_table, sizeof(xfrm_table), GFP_KERNEL);\n\tif (!table)\n\t\tgoto out_kmemdup;\n\ttable[0].data = &net->xfrm.sysctl_aevent_etime;\n\ttable[1].data = &net->xfrm.sysctl_aevent_rseqth;\n\ttable[2].data = &net->xfrm.sysctl_larval_drop;\n\ttable[3].data = &net->xfrm.sysctl_acq_expires;\n\n\t \n\tif (net->user_ns != &init_user_ns) {\n\t\ttable[0].procname = NULL;\n\t\ttable_size = 0;\n\t}\n\n\tnet->xfrm.sysctl_hdr = register_net_sysctl_sz(net, \"net/core\", table,\n\t\t\t\t\t\t      table_size);\n\tif (!net->xfrm.sysctl_hdr)\n\t\tgoto out_register;\n\treturn 0;\n\nout_register:\n\tkfree(table);\nout_kmemdup:\n\treturn -ENOMEM;\n}\n\nvoid __net_exit xfrm_sysctl_fini(struct net *net)\n{\n\tstruct ctl_table *table;\n\n\ttable = net->xfrm.sysctl_hdr->ctl_table_arg;\n\tunregister_net_sysctl_table(net->xfrm.sysctl_hdr);\n\tkfree(table);\n}\n#else\nint __net_init xfrm_sysctl_init(struct net *net)\n{\n\t__xfrm_sysctl_init(net);\n\treturn 0;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}