{
  "module_name": "xfrm_proc.c",
  "hash_id": "037e58697837d9af028f72bc4a5fe2689f18ab005a6cbf4ef5d4d878415750b4",
  "original_prompt": "Ingested from linux-6.6.14/net/xfrm/xfrm_proc.c",
  "human_readable_source": "\n \n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <net/snmp.h>\n#include <net/xfrm.h>\n\nstatic const struct snmp_mib xfrm_mib_list[] = {\n\tSNMP_MIB_ITEM(\"XfrmInError\", LINUX_MIB_XFRMINERROR),\n\tSNMP_MIB_ITEM(\"XfrmInBufferError\", LINUX_MIB_XFRMINBUFFERERROR),\n\tSNMP_MIB_ITEM(\"XfrmInHdrError\", LINUX_MIB_XFRMINHDRERROR),\n\tSNMP_MIB_ITEM(\"XfrmInNoStates\", LINUX_MIB_XFRMINNOSTATES),\n\tSNMP_MIB_ITEM(\"XfrmInStateProtoError\", LINUX_MIB_XFRMINSTATEPROTOERROR),\n\tSNMP_MIB_ITEM(\"XfrmInStateModeError\", LINUX_MIB_XFRMINSTATEMODEERROR),\n\tSNMP_MIB_ITEM(\"XfrmInStateSeqError\", LINUX_MIB_XFRMINSTATESEQERROR),\n\tSNMP_MIB_ITEM(\"XfrmInStateExpired\", LINUX_MIB_XFRMINSTATEEXPIRED),\n\tSNMP_MIB_ITEM(\"XfrmInStateMismatch\", LINUX_MIB_XFRMINSTATEMISMATCH),\n\tSNMP_MIB_ITEM(\"XfrmInStateInvalid\", LINUX_MIB_XFRMINSTATEINVALID),\n\tSNMP_MIB_ITEM(\"XfrmInTmplMismatch\", LINUX_MIB_XFRMINTMPLMISMATCH),\n\tSNMP_MIB_ITEM(\"XfrmInNoPols\", LINUX_MIB_XFRMINNOPOLS),\n\tSNMP_MIB_ITEM(\"XfrmInPolBlock\", LINUX_MIB_XFRMINPOLBLOCK),\n\tSNMP_MIB_ITEM(\"XfrmInPolError\", LINUX_MIB_XFRMINPOLERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutError\", LINUX_MIB_XFRMOUTERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutBundleGenError\", LINUX_MIB_XFRMOUTBUNDLEGENERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutBundleCheckError\", LINUX_MIB_XFRMOUTBUNDLECHECKERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutNoStates\", LINUX_MIB_XFRMOUTNOSTATES),\n\tSNMP_MIB_ITEM(\"XfrmOutStateProtoError\", LINUX_MIB_XFRMOUTSTATEPROTOERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutStateModeError\", LINUX_MIB_XFRMOUTSTATEMODEERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutStateSeqError\", LINUX_MIB_XFRMOUTSTATESEQERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutStateExpired\", LINUX_MIB_XFRMOUTSTATEEXPIRED),\n\tSNMP_MIB_ITEM(\"XfrmOutPolBlock\", LINUX_MIB_XFRMOUTPOLBLOCK),\n\tSNMP_MIB_ITEM(\"XfrmOutPolDead\", LINUX_MIB_XFRMOUTPOLDEAD),\n\tSNMP_MIB_ITEM(\"XfrmOutPolError\", LINUX_MIB_XFRMOUTPOLERROR),\n\tSNMP_MIB_ITEM(\"XfrmFwdHdrError\", LINUX_MIB_XFRMFWDHDRERROR),\n\tSNMP_MIB_ITEM(\"XfrmOutStateInvalid\", LINUX_MIB_XFRMOUTSTATEINVALID),\n\tSNMP_MIB_ITEM(\"XfrmAcquireError\", LINUX_MIB_XFRMACQUIREERROR),\n\tSNMP_MIB_SENTINEL\n};\n\nstatic int xfrm_statistics_seq_show(struct seq_file *seq, void *v)\n{\n\tunsigned long buff[LINUX_MIB_XFRMMAX];\n\tstruct net *net = seq->private;\n\tint i;\n\n\tmemset(buff, 0, sizeof(unsigned long) * LINUX_MIB_XFRMMAX);\n\n\tsnmp_get_cpu_field_batch(buff, xfrm_mib_list,\n\t\t\t\t net->mib.xfrm_statistics);\n\tfor (i = 0; xfrm_mib_list[i].name; i++)\n\t\tseq_printf(seq, \"%-24s\\t%lu\\n\", xfrm_mib_list[i].name,\n\t\t\t\t\t\tbuff[i]);\n\n\treturn 0;\n}\n\nint __net_init xfrm_proc_init(struct net *net)\n{\n\tif (!proc_create_net_single(\"xfrm_stat\", 0444, net->proc_net,\n\t\t\t xfrm_statistics_seq_show, NULL))\n\t\treturn -ENOMEM;\n\treturn 0;\n}\n\nvoid xfrm_proc_fini(struct net *net)\n{\n\tremove_proc_entry(\"xfrm_stat\", net->proc_net);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}