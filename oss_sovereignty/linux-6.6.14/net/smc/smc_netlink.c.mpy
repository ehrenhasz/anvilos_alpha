{
  "module_name": "smc_netlink.c",
  "hash_id": "c63ffde3ae0601010f636e50555cc68bcd1172e4ae2094e8448c5e73fb087612",
  "original_prompt": "Ingested from linux-6.6.14/net/smc/smc_netlink.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/list.h>\n#include <linux/ctype.h>\n#include <linux/mutex.h>\n#include <linux/if.h>\n#include <linux/smc.h>\n\n#include \"smc_core.h\"\n#include \"smc_ism.h\"\n#include \"smc_ib.h\"\n#include \"smc_clc.h\"\n#include \"smc_stats.h\"\n#include \"smc_netlink.h\"\n\nconst struct nla_policy\nsmc_gen_ueid_policy[SMC_NLA_EID_TABLE_MAX + 1] = {\n\t[SMC_NLA_EID_TABLE_UNSPEC]\t= { .type = NLA_UNSPEC },\n\t[SMC_NLA_EID_TABLE_ENTRY]\t= { .type = NLA_STRING,\n\t\t\t\t\t    .len = SMC_MAX_EID_LEN,\n\t\t\t\t\t  },\n};\n\n#define SMC_CMD_MAX_ATTR 1\n \nstatic const struct genl_ops smc_gen_nl_ops[] = {\n\t{\n\t\t.cmd = SMC_NETLINK_GET_SYS_INFO,\n\t\t \n\t\t.dumpit = smc_nl_get_sys_info,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_LGR_SMCR,\n\t\t \n\t\t.dumpit = smcr_nl_get_lgr,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_LINK_SMCR,\n\t\t \n\t\t.dumpit = smcr_nl_get_link,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_LGR_SMCD,\n\t\t \n\t\t.dumpit = smcd_nl_get_lgr,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_DEV_SMCD,\n\t\t \n\t\t.dumpit = smcd_nl_get_device,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_DEV_SMCR,\n\t\t \n\t\t.dumpit = smcr_nl_get_device,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_STATS,\n\t\t \n\t\t.dumpit = smc_nl_get_stats,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_GET_FBACK_STATS,\n\t\t \n\t\t.dumpit = smc_nl_get_fback_stats,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_DUMP_UEID,\n\t\t \n\t\t.dumpit = smc_nl_dump_ueid,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_ADD_UEID,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_add_ueid,\n\t\t.policy = smc_gen_ueid_policy,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_REMOVE_UEID,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_remove_ueid,\n\t\t.policy = smc_gen_ueid_policy,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_FLUSH_UEID,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_flush_ueid,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_DUMP_SEID,\n\t\t \n\t\t.dumpit = smc_nl_dump_seid,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_ENABLE_SEID,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_enable_seid,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_DISABLE_SEID,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_disable_seid,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_DUMP_HS_LIMITATION,\n\t\t \n\t\t.dumpit = smc_nl_dump_hs_limitation,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_ENABLE_HS_LIMITATION,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_enable_hs_limitation,\n\t},\n\t{\n\t\t.cmd = SMC_NETLINK_DISABLE_HS_LIMITATION,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.doit = smc_nl_disable_hs_limitation,\n\t},\n};\n\nstatic const struct nla_policy smc_gen_nl_policy[2] = {\n\t[SMC_CMD_MAX_ATTR]\t= { .type = NLA_REJECT, },\n};\n\n \nstruct genl_family smc_gen_nl_family __ro_after_init = {\n\t.hdrsize =\t0,\n\t.name =\t\tSMC_GENL_FAMILY_NAME,\n\t.version =\tSMC_GENL_FAMILY_VERSION,\n\t.maxattr =\tSMC_CMD_MAX_ATTR,\n\t.policy =\tsmc_gen_nl_policy,\n\t.netnsok =\ttrue,\n\t.module =\tTHIS_MODULE,\n\t.ops =\t\tsmc_gen_nl_ops,\n\t.n_ops =\tARRAY_SIZE(smc_gen_nl_ops),\n\t.resv_start_op = SMC_NETLINK_DISABLE_HS_LIMITATION + 1,\n};\n\nint __init smc_nl_init(void)\n{\n\treturn genl_register_family(&smc_gen_nl_family);\n}\n\nvoid smc_nl_exit(void)\n{\n\tgenl_unregister_family(&smc_gen_nl_family);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}