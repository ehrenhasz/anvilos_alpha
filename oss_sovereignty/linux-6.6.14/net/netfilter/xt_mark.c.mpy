{
  "module_name": "xt_mark.c",
  "hash_id": "6138f24ef121bab4ed1c42e0c097fbc0f3f30a00c24f2f5cf7f5436e97276301",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/xt_mark.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/skbuff.h>\n\n#include <linux/netfilter/xt_mark.h>\n#include <linux/netfilter/x_tables.h>\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Marc Boucher <marc@mbsi.ca>\");\nMODULE_DESCRIPTION(\"Xtables: packet mark operations\");\nMODULE_ALIAS(\"ipt_mark\");\nMODULE_ALIAS(\"ip6t_mark\");\nMODULE_ALIAS(\"ipt_MARK\");\nMODULE_ALIAS(\"ip6t_MARK\");\nMODULE_ALIAS(\"arpt_MARK\");\n\nstatic unsigned int\nmark_tg(struct sk_buff *skb, const struct xt_action_param *par)\n{\n\tconst struct xt_mark_tginfo2 *info = par->targinfo;\n\n\tskb->mark = (skb->mark & ~info->mask) ^ info->mark;\n\treturn XT_CONTINUE;\n}\n\nstatic bool\nmark_mt(const struct sk_buff *skb, struct xt_action_param *par)\n{\n\tconst struct xt_mark_mtinfo1 *info = par->matchinfo;\n\n\treturn ((skb->mark & info->mask) == info->mark) ^ info->invert;\n}\n\nstatic struct xt_target mark_tg_reg __read_mostly = {\n\t.name           = \"MARK\",\n\t.revision       = 2,\n\t.family         = NFPROTO_UNSPEC,\n\t.target         = mark_tg,\n\t.targetsize     = sizeof(struct xt_mark_tginfo2),\n\t.me             = THIS_MODULE,\n};\n\nstatic struct xt_match mark_mt_reg __read_mostly = {\n\t.name           = \"mark\",\n\t.revision       = 1,\n\t.family         = NFPROTO_UNSPEC,\n\t.match          = mark_mt,\n\t.matchsize      = sizeof(struct xt_mark_mtinfo1),\n\t.me             = THIS_MODULE,\n};\n\nstatic int __init mark_mt_init(void)\n{\n\tint ret;\n\n\tret = xt_register_target(&mark_tg_reg);\n\tif (ret < 0)\n\t\treturn ret;\n\tret = xt_register_match(&mark_mt_reg);\n\tif (ret < 0) {\n\t\txt_unregister_target(&mark_tg_reg);\n\t\treturn ret;\n\t}\n\treturn 0;\n}\n\nstatic void __exit mark_mt_exit(void)\n{\n\txt_unregister_match(&mark_mt_reg);\n\txt_unregister_target(&mark_tg_reg);\n}\n\nmodule_init(mark_mt_init);\nmodule_exit(mark_mt_exit);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}