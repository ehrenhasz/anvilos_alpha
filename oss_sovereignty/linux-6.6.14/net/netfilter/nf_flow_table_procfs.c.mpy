{
  "module_name": "nf_flow_table_procfs.c",
  "hash_id": "8052870e177e84ffbc7d498ba5b59ad95b32ff4c4dedfa9599d7e4388d847953",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/nf_flow_table_procfs.c",
  "human_readable_source": "\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <net/netfilter/nf_flow_table.h>\n\nstatic void *nf_flow_table_cpu_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct net *net = seq_file_net(seq);\n\tint cpu;\n\n\tif (*pos == 0)\n\t\treturn SEQ_START_TOKEN;\n\n\tfor (cpu = *pos - 1; cpu < nr_cpu_ids; ++cpu) {\n\t\tif (!cpu_possible(cpu))\n\t\t\tcontinue;\n\t\t*pos = cpu + 1;\n\t\treturn per_cpu_ptr(net->ft.stat, cpu);\n\t}\n\n\treturn NULL;\n}\n\nstatic void *nf_flow_table_cpu_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct net *net = seq_file_net(seq);\n\tint cpu;\n\n\tfor (cpu = *pos; cpu < nr_cpu_ids; ++cpu) {\n\t\tif (!cpu_possible(cpu))\n\t\t\tcontinue;\n\t\t*pos = cpu + 1;\n\t\treturn per_cpu_ptr(net->ft.stat, cpu);\n\t}\n\t(*pos)++;\n\treturn NULL;\n}\n\nstatic void nf_flow_table_cpu_seq_stop(struct seq_file *seq, void *v)\n{\n}\n\nstatic int nf_flow_table_cpu_seq_show(struct seq_file *seq, void *v)\n{\n\tconst struct nf_flow_table_stat *st = v;\n\n\tif (v == SEQ_START_TOKEN) {\n\t\tseq_puts(seq, \"wq_add   wq_del   wq_stats\\n\");\n\t\treturn 0;\n\t}\n\n\tseq_printf(seq, \"%8d %8d %8d\\n\",\n\t\t   st->count_wq_add,\n\t\t   st->count_wq_del,\n\t\t   st->count_wq_stats\n\t\t);\n\treturn 0;\n}\n\nstatic const struct seq_operations nf_flow_table_cpu_seq_ops = {\n\t.start\t= nf_flow_table_cpu_seq_start,\n\t.next\t= nf_flow_table_cpu_seq_next,\n\t.stop\t= nf_flow_table_cpu_seq_stop,\n\t.show\t= nf_flow_table_cpu_seq_show,\n};\n\nint nf_flow_table_init_proc(struct net *net)\n{\n\tstruct proc_dir_entry *pde;\n\n\tpde = proc_create_net(\"nf_flowtable\", 0444, net->proc_net_stat,\n\t\t\t      &nf_flow_table_cpu_seq_ops,\n\t\t\t      sizeof(struct seq_net_private));\n\treturn pde ? 0 : -ENOMEM;\n}\n\nvoid nf_flow_table_fini_proc(struct net *net)\n{\n\tremove_proc_entry(\"nf_flowtable\", net->proc_net_stat);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}