{
  "module_name": "nf_conntrack_netbios_ns.c",
  "hash_id": "fcc296b6888bce4be81271c9a80cbfba34fe8581f9c9dd5586621a0f3d69ed0f",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/nf_conntrack_netbios_ns.c",
  "human_readable_source": "\n \n \n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/in.h>\n\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_helper.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n\n#define HELPER_NAME\t\"netbios-ns\"\n#define NMBD_PORT\t137\n\nMODULE_AUTHOR(\"Patrick McHardy <kaber@trash.net>\");\nMODULE_DESCRIPTION(\"NetBIOS name service broadcast connection tracking helper\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"ip_conntrack_netbios_ns\");\nMODULE_ALIAS_NFCT_HELPER(HELPER_NAME);\n\nstatic unsigned int timeout __read_mostly = 3;\nmodule_param(timeout, uint, 0400);\nMODULE_PARM_DESC(timeout, \"timeout for master connection/replies in seconds\");\n\nstatic struct nf_conntrack_expect_policy exp_policy = {\n\t.max_expected\t= 1,\n};\n\nstatic int netbios_ns_help(struct sk_buff *skb, unsigned int protoff,\n\t\t\t   struct nf_conn *ct,\n\t\t\t   enum ip_conntrack_info ctinfo)\n{\n\treturn nf_conntrack_broadcast_help(skb, ct, ctinfo, timeout);\n}\n\nstatic struct nf_conntrack_helper helper __read_mostly = {\n\t.name\t\t\t= HELPER_NAME,\n\t.tuple.src.l3num\t= NFPROTO_IPV4,\n\t.tuple.src.u.udp.port\t= cpu_to_be16(NMBD_PORT),\n\t.tuple.dst.protonum\t= IPPROTO_UDP,\n\t.me\t\t\t= THIS_MODULE,\n\t.help\t\t\t= netbios_ns_help,\n\t.expect_policy\t\t= &exp_policy,\n};\n\nstatic int __init nf_conntrack_netbios_ns_init(void)\n{\n\tNF_CT_HELPER_BUILD_BUG_ON(0);\n\n\texp_policy.timeout = timeout;\n\treturn nf_conntrack_helper_register(&helper);\n}\n\nstatic void __exit nf_conntrack_netbios_ns_fini(void)\n{\n\tnf_conntrack_helper_unregister(&helper);\n}\n\nmodule_init(nf_conntrack_netbios_ns_init);\nmodule_exit(nf_conntrack_netbios_ns_fini);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}