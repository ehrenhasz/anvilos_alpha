{
  "module_name": "xt_hl.c",
  "hash_id": "415b33f6fa27c914cb888f04cd2639524cde127b811e7f888fda65721bf23750",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/xt_hl.c",
  "human_readable_source": "\n \n\n#include <linux/ip.h>\n#include <linux/ipv6.h>\n#include <linux/module.h>\n#include <linux/skbuff.h>\n\n#include <linux/netfilter/x_tables.h>\n#include <linux/netfilter_ipv4/ipt_ttl.h>\n#include <linux/netfilter_ipv6/ip6t_hl.h>\n\nMODULE_AUTHOR(\"Maciej Soltysiak <solt@dns.toxicfilms.tv>\");\nMODULE_DESCRIPTION(\"Xtables: Hoplimit/TTL field match\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"ipt_ttl\");\nMODULE_ALIAS(\"ip6t_hl\");\n\nstatic bool ttl_mt(const struct sk_buff *skb, struct xt_action_param *par)\n{\n\tconst struct ipt_ttl_info *info = par->matchinfo;\n\tconst u8 ttl = ip_hdr(skb)->ttl;\n\n\tswitch (info->mode) {\n\tcase IPT_TTL_EQ:\n\t\treturn ttl == info->ttl;\n\tcase IPT_TTL_NE:\n\t\treturn ttl != info->ttl;\n\tcase IPT_TTL_LT:\n\t\treturn ttl < info->ttl;\n\tcase IPT_TTL_GT:\n\t\treturn ttl > info->ttl;\n\t}\n\n\treturn false;\n}\n\nstatic bool hl_mt6(const struct sk_buff *skb, struct xt_action_param *par)\n{\n\tconst struct ip6t_hl_info *info = par->matchinfo;\n\tconst struct ipv6hdr *ip6h = ipv6_hdr(skb);\n\n\tswitch (info->mode) {\n\tcase IP6T_HL_EQ:\n\t\treturn ip6h->hop_limit == info->hop_limit;\n\tcase IP6T_HL_NE:\n\t\treturn ip6h->hop_limit != info->hop_limit;\n\tcase IP6T_HL_LT:\n\t\treturn ip6h->hop_limit < info->hop_limit;\n\tcase IP6T_HL_GT:\n\t\treturn ip6h->hop_limit > info->hop_limit;\n\t}\n\n\treturn false;\n}\n\nstatic struct xt_match hl_mt_reg[] __read_mostly = {\n\t{\n\t\t.name       = \"ttl\",\n\t\t.revision   = 0,\n\t\t.family     = NFPROTO_IPV4,\n\t\t.match      = ttl_mt,\n\t\t.matchsize  = sizeof(struct ipt_ttl_info),\n\t\t.me         = THIS_MODULE,\n\t},\n\t{\n\t\t.name       = \"hl\",\n\t\t.revision   = 0,\n\t\t.family     = NFPROTO_IPV6,\n\t\t.match      = hl_mt6,\n\t\t.matchsize  = sizeof(struct ip6t_hl_info),\n\t\t.me         = THIS_MODULE,\n\t},\n};\n\nstatic int __init hl_mt_init(void)\n{\n\treturn xt_register_matches(hl_mt_reg, ARRAY_SIZE(hl_mt_reg));\n}\n\nstatic void __exit hl_mt_exit(void)\n{\n\txt_unregister_matches(hl_mt_reg, ARRAY_SIZE(hl_mt_reg));\n}\n\nmodule_init(hl_mt_init);\nmodule_exit(hl_mt_exit);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}