{
  "module_name": "nf_conntrack_proto_generic.c",
  "hash_id": "ac977eab5bb29cfba8075aa0f74a24655af5b31aae080f59fa1a68b376fc1c1e",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/nf_conntrack_proto_generic.c",
  "human_readable_source": "\n \n\n#include <linux/types.h>\n#include <linux/jiffies.h>\n#include <linux/timer.h>\n#include <linux/netfilter.h>\n#include <net/netfilter/nf_conntrack_l4proto.h>\n#include <net/netfilter/nf_conntrack_timeout.h>\n\nstatic const unsigned int nf_ct_generic_timeout = 600*HZ;\n\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\n#include <linux/netfilter/nfnetlink.h>\n#include <linux/netfilter/nfnetlink_cttimeout.h>\n\nstatic int generic_timeout_nlattr_to_obj(struct nlattr *tb[],\n\t\t\t\t\t struct net *net, void *data)\n{\n\tstruct nf_generic_net *gn = nf_generic_pernet(net);\n\tunsigned int *timeout = data;\n\n\tif (!timeout)\n\t\ttimeout = &gn->timeout;\n\n\tif (tb[CTA_TIMEOUT_GENERIC_TIMEOUT])\n\t\t*timeout =\n\t\t    ntohl(nla_get_be32(tb[CTA_TIMEOUT_GENERIC_TIMEOUT])) * HZ;\n\telse {\n\t\t \n\t\t*timeout = gn->timeout;\n\t}\n\n\treturn 0;\n}\n\nstatic int\ngeneric_timeout_obj_to_nlattr(struct sk_buff *skb, const void *data)\n{\n\tconst unsigned int *timeout = data;\n\n\tif (nla_put_be32(skb, CTA_TIMEOUT_GENERIC_TIMEOUT, htonl(*timeout / HZ)))\n\t\tgoto nla_put_failure;\n\n\treturn 0;\n\nnla_put_failure:\n        return -ENOSPC;\n}\n\nstatic const struct nla_policy\ngeneric_timeout_nla_policy[CTA_TIMEOUT_GENERIC_MAX+1] = {\n\t[CTA_TIMEOUT_GENERIC_TIMEOUT]\t= { .type = NLA_U32 },\n};\n#endif  \n\nvoid nf_conntrack_generic_init_net(struct net *net)\n{\n\tstruct nf_generic_net *gn = nf_generic_pernet(net);\n\n\tgn->timeout = nf_ct_generic_timeout;\n}\n\nconst struct nf_conntrack_l4proto nf_conntrack_l4proto_generic =\n{\n\t.l4proto\t\t= 255,\n#ifdef CONFIG_NF_CONNTRACK_TIMEOUT\n\t.ctnl_timeout\t\t= {\n\t\t.nlattr_to_obj\t= generic_timeout_nlattr_to_obj,\n\t\t.obj_to_nlattr\t= generic_timeout_obj_to_nlattr,\n\t\t.nlattr_max\t= CTA_TIMEOUT_GENERIC_MAX,\n\t\t.obj_size\t= sizeof(unsigned int),\n\t\t.nla_policy\t= generic_timeout_nla_policy,\n\t},\n#endif  \n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}