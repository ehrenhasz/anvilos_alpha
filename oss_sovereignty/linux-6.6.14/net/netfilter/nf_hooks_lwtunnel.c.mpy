{
  "module_name": "nf_hooks_lwtunnel.c",
  "hash_id": "a5ef1a5adab1cb4a24e10f24b5af7b03763dd18a753768e22a6e5f9cd34e3456",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/nf_hooks_lwtunnel.c",
  "human_readable_source": "\n\n#include <linux/sysctl.h>\n#include <net/lwtunnel.h>\n#include <net/netfilter/nf_hooks_lwtunnel.h>\n\nstatic inline int nf_hooks_lwtunnel_get(void)\n{\n\tif (static_branch_unlikely(&nf_hooks_lwtunnel_enabled))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nstatic inline int nf_hooks_lwtunnel_set(int enable)\n{\n\tif (static_branch_unlikely(&nf_hooks_lwtunnel_enabled)) {\n\t\tif (!enable)\n\t\t\treturn -EBUSY;\n\t} else if (enable) {\n\t\tstatic_branch_enable(&nf_hooks_lwtunnel_enabled);\n\t}\n\n\treturn 0;\n}\n\n#ifdef CONFIG_SYSCTL\nint nf_hooks_lwtunnel_sysctl_handler(struct ctl_table *table, int write,\n\t\t\t\t     void *buffer, size_t *lenp, loff_t *ppos)\n{\n\tint proc_nf_hooks_lwtunnel_enabled = 0;\n\tstruct ctl_table tmp = {\n\t\t.procname = table->procname,\n\t\t.data = &proc_nf_hooks_lwtunnel_enabled,\n\t\t.maxlen = sizeof(int),\n\t\t.mode = table->mode,\n\t\t.extra1 = SYSCTL_ZERO,\n\t\t.extra2 = SYSCTL_ONE,\n\t};\n\tint ret;\n\n\tif (!write)\n\t\tproc_nf_hooks_lwtunnel_enabled = nf_hooks_lwtunnel_get();\n\n\tret = proc_dointvec_minmax(&tmp, write, buffer, lenp, ppos);\n\n\tif (write && ret == 0)\n\t\tret = nf_hooks_lwtunnel_set(proc_nf_hooks_lwtunnel_enabled);\n\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(nf_hooks_lwtunnel_sysctl_handler);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}