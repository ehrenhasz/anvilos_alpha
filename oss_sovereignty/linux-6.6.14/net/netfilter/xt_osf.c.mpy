{
  "module_name": "xt_osf.c",
  "hash_id": "5cd92082773926df47b02bd11fd017246242fca37b9cc7c8bc4d50608c0bc132",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/xt_osf.c",
  "human_readable_source": "\n \n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#include <linux/capability.h>\n#include <linux/if.h>\n#include <linux/inetdevice.h>\n#include <linux/ip.h>\n#include <linux/list.h>\n#include <linux/rculist.h>\n#include <linux/skbuff.h>\n#include <linux/slab.h>\n#include <linux/tcp.h>\n\n#include <net/ip.h>\n#include <net/tcp.h>\n\n#include <linux/netfilter/nfnetlink.h>\n#include <linux/netfilter/x_tables.h>\n#include <net/netfilter/nf_log.h>\n#include <linux/netfilter/xt_osf.h>\n\nstatic bool\nxt_osf_match_packet(const struct sk_buff *skb, struct xt_action_param *p)\n{\n\treturn nf_osf_match(skb, xt_family(p), xt_hooknum(p), xt_in(p),\n\t\t\t    xt_out(p), p->matchinfo, xt_net(p), nf_osf_fingers);\n}\n\nstatic struct xt_match xt_osf_match = {\n\t.name \t\t= \"osf\",\n\t.revision\t= 0,\n\t.family\t\t= NFPROTO_IPV4,\n\t.proto\t\t= IPPROTO_TCP,\n\t.hooks      \t= (1 << NF_INET_LOCAL_IN) |\n\t\t\t\t(1 << NF_INET_PRE_ROUTING) |\n\t\t\t\t(1 << NF_INET_FORWARD),\n\t.match \t\t= xt_osf_match_packet,\n\t.matchsize\t= sizeof(struct xt_osf_info),\n\t.me\t\t= THIS_MODULE,\n};\n\nstatic int __init xt_osf_init(void)\n{\n\tint err;\n\n\terr = xt_register_match(&xt_osf_match);\n\tif (err) {\n\t\tpr_err(\"Failed to register OS fingerprint \"\n\t\t       \"matching module (%d)\\n\", err);\n\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nstatic void __exit xt_osf_fini(void)\n{\n\txt_unregister_match(&xt_osf_match);\n}\n\nmodule_init(xt_osf_init);\nmodule_exit(xt_osf_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Evgeniy Polyakov <zbr@ioremap.net>\");\nMODULE_DESCRIPTION(\"Passive OS fingerprint matching.\");\nMODULE_ALIAS(\"ipt_osf\");\nMODULE_ALIAS(\"ip6t_osf\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}