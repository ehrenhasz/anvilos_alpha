{
  "module_name": "nf_conntrack_snmp.c",
  "hash_id": "7dd4dc03657b8bd0996433c5970ad69ba212faa991c38befcaeaec6e44906516",
  "original_prompt": "Ingested from linux-6.6.14/net/netfilter/nf_conntrack_snmp.c",
  "human_readable_source": "\n \n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/in.h>\n\n#include <net/netfilter/nf_conntrack.h>\n#include <net/netfilter/nf_conntrack_helper.h>\n#include <net/netfilter/nf_conntrack_expect.h>\n#include <linux/netfilter/nf_conntrack_snmp.h>\n\n#define SNMP_PORT\t161\n\nMODULE_AUTHOR(\"Jiri Olsa <jolsa@redhat.com>\");\nMODULE_DESCRIPTION(\"SNMP service broadcast connection tracking helper\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_NFCT_HELPER(\"snmp\");\n\nstatic unsigned int timeout __read_mostly = 30;\nmodule_param(timeout, uint, 0400);\nMODULE_PARM_DESC(timeout, \"timeout for master connection/replies in seconds\");\n\nint (*nf_nat_snmp_hook)(struct sk_buff *skb,\n\t\t\tunsigned int protoff,\n\t\t\tstruct nf_conn *ct,\n\t\t\tenum ip_conntrack_info ctinfo);\nEXPORT_SYMBOL_GPL(nf_nat_snmp_hook);\n\nstatic int snmp_conntrack_help(struct sk_buff *skb, unsigned int protoff,\n\t\t\t       struct nf_conn *ct,\n\t\t\t       enum ip_conntrack_info ctinfo)\n{\n\ttypeof(nf_nat_snmp_hook) nf_nat_snmp;\n\n\tnf_conntrack_broadcast_help(skb, ct, ctinfo, timeout);\n\n\tnf_nat_snmp = rcu_dereference(nf_nat_snmp_hook);\n\tif (nf_nat_snmp && ct->status & IPS_NAT_MASK)\n\t\treturn nf_nat_snmp(skb, protoff, ct, ctinfo);\n\n\treturn NF_ACCEPT;\n}\n\nstatic struct nf_conntrack_expect_policy exp_policy = {\n\t.max_expected\t= 1,\n};\n\nstatic struct nf_conntrack_helper helper __read_mostly = {\n\t.name\t\t\t= \"snmp\",\n\t.tuple.src.l3num\t= NFPROTO_IPV4,\n\t.tuple.src.u.udp.port\t= cpu_to_be16(SNMP_PORT),\n\t.tuple.dst.protonum\t= IPPROTO_UDP,\n\t.me\t\t\t= THIS_MODULE,\n\t.help\t\t\t= snmp_conntrack_help,\n\t.expect_policy\t\t= &exp_policy,\n};\n\nstatic int __init nf_conntrack_snmp_init(void)\n{\n\texp_policy.timeout = timeout;\n\treturn nf_conntrack_helper_register(&helper);\n}\n\nstatic void __exit nf_conntrack_snmp_fini(void)\n{\n\tnf_conntrack_helper_unregister(&helper);\n}\n\nmodule_init(nf_conntrack_snmp_init);\nmodule_exit(nf_conntrack_snmp_fini);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}