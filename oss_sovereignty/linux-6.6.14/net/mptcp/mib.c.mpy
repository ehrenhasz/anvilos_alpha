{
  "module_name": "mib.c",
  "hash_id": "17bed1a7a9fd653faeaf982fe98ea99f54afc2f54649c62b0f225037089c5ba6",
  "original_prompt": "Ingested from linux-6.6.14/net/mptcp/mib.c",
  "human_readable_source": "\n\n#include <linux/seq_file.h>\n#include <net/ip.h>\n#include <net/mptcp.h>\n#include <net/snmp.h>\n#include <net/net_namespace.h>\n\n#include \"mib.h\"\n\nstatic const struct snmp_mib mptcp_snmp_list[] = {\n\tSNMP_MIB_ITEM(\"MPCapableSYNRX\", MPTCP_MIB_MPCAPABLEPASSIVE),\n\tSNMP_MIB_ITEM(\"MPCapableSYNTX\", MPTCP_MIB_MPCAPABLEACTIVE),\n\tSNMP_MIB_ITEM(\"MPCapableSYNACKRX\", MPTCP_MIB_MPCAPABLEACTIVEACK),\n\tSNMP_MIB_ITEM(\"MPCapableACKRX\", MPTCP_MIB_MPCAPABLEPASSIVEACK),\n\tSNMP_MIB_ITEM(\"MPCapableFallbackACK\", MPTCP_MIB_MPCAPABLEPASSIVEFALLBACK),\n\tSNMP_MIB_ITEM(\"MPCapableFallbackSYNACK\", MPTCP_MIB_MPCAPABLEACTIVEFALLBACK),\n\tSNMP_MIB_ITEM(\"MPFallbackTokenInit\", MPTCP_MIB_TOKENFALLBACKINIT),\n\tSNMP_MIB_ITEM(\"MPTCPRetrans\", MPTCP_MIB_RETRANSSEGS),\n\tSNMP_MIB_ITEM(\"MPJoinNoTokenFound\", MPTCP_MIB_JOINNOTOKEN),\n\tSNMP_MIB_ITEM(\"MPJoinSynRx\", MPTCP_MIB_JOINSYNRX),\n\tSNMP_MIB_ITEM(\"MPJoinSynAckRx\", MPTCP_MIB_JOINSYNACKRX),\n\tSNMP_MIB_ITEM(\"MPJoinSynAckHMacFailure\", MPTCP_MIB_JOINSYNACKMAC),\n\tSNMP_MIB_ITEM(\"MPJoinAckRx\", MPTCP_MIB_JOINACKRX),\n\tSNMP_MIB_ITEM(\"MPJoinAckHMacFailure\", MPTCP_MIB_JOINACKMAC),\n\tSNMP_MIB_ITEM(\"DSSNotMatching\", MPTCP_MIB_DSSNOMATCH),\n\tSNMP_MIB_ITEM(\"InfiniteMapTx\", MPTCP_MIB_INFINITEMAPTX),\n\tSNMP_MIB_ITEM(\"InfiniteMapRx\", MPTCP_MIB_INFINITEMAPRX),\n\tSNMP_MIB_ITEM(\"DSSNoMatchTCP\", MPTCP_MIB_DSSTCPMISMATCH),\n\tSNMP_MIB_ITEM(\"DataCsumErr\", MPTCP_MIB_DATACSUMERR),\n\tSNMP_MIB_ITEM(\"OFOQueueTail\", MPTCP_MIB_OFOQUEUETAIL),\n\tSNMP_MIB_ITEM(\"OFOQueue\", MPTCP_MIB_OFOQUEUE),\n\tSNMP_MIB_ITEM(\"OFOMerge\", MPTCP_MIB_OFOMERGE),\n\tSNMP_MIB_ITEM(\"NoDSSInWindow\", MPTCP_MIB_NODSSWINDOW),\n\tSNMP_MIB_ITEM(\"DuplicateData\", MPTCP_MIB_DUPDATA),\n\tSNMP_MIB_ITEM(\"AddAddr\", MPTCP_MIB_ADDADDR),\n\tSNMP_MIB_ITEM(\"AddAddrTx\", MPTCP_MIB_ADDADDRTX),\n\tSNMP_MIB_ITEM(\"AddAddrTxDrop\", MPTCP_MIB_ADDADDRTXDROP),\n\tSNMP_MIB_ITEM(\"EchoAdd\", MPTCP_MIB_ECHOADD),\n\tSNMP_MIB_ITEM(\"EchoAddTx\", MPTCP_MIB_ECHOADDTX),\n\tSNMP_MIB_ITEM(\"EchoAddTxDrop\", MPTCP_MIB_ECHOADDTXDROP),\n\tSNMP_MIB_ITEM(\"PortAdd\", MPTCP_MIB_PORTADD),\n\tSNMP_MIB_ITEM(\"AddAddrDrop\", MPTCP_MIB_ADDADDRDROP),\n\tSNMP_MIB_ITEM(\"MPJoinPortSynRx\", MPTCP_MIB_JOINPORTSYNRX),\n\tSNMP_MIB_ITEM(\"MPJoinPortSynAckRx\", MPTCP_MIB_JOINPORTSYNACKRX),\n\tSNMP_MIB_ITEM(\"MPJoinPortAckRx\", MPTCP_MIB_JOINPORTACKRX),\n\tSNMP_MIB_ITEM(\"MismatchPortSynRx\", MPTCP_MIB_MISMATCHPORTSYNRX),\n\tSNMP_MIB_ITEM(\"MismatchPortAckRx\", MPTCP_MIB_MISMATCHPORTACKRX),\n\tSNMP_MIB_ITEM(\"RmAddr\", MPTCP_MIB_RMADDR),\n\tSNMP_MIB_ITEM(\"RmAddrDrop\", MPTCP_MIB_RMADDRDROP),\n\tSNMP_MIB_ITEM(\"RmAddrTx\", MPTCP_MIB_RMADDRTX),\n\tSNMP_MIB_ITEM(\"RmAddrTxDrop\", MPTCP_MIB_RMADDRTXDROP),\n\tSNMP_MIB_ITEM(\"RmSubflow\", MPTCP_MIB_RMSUBFLOW),\n\tSNMP_MIB_ITEM(\"MPPrioTx\", MPTCP_MIB_MPPRIOTX),\n\tSNMP_MIB_ITEM(\"MPPrioRx\", MPTCP_MIB_MPPRIORX),\n\tSNMP_MIB_ITEM(\"MPFailTx\", MPTCP_MIB_MPFAILTX),\n\tSNMP_MIB_ITEM(\"MPFailRx\", MPTCP_MIB_MPFAILRX),\n\tSNMP_MIB_ITEM(\"MPFastcloseTx\", MPTCP_MIB_MPFASTCLOSETX),\n\tSNMP_MIB_ITEM(\"MPFastcloseRx\", MPTCP_MIB_MPFASTCLOSERX),\n\tSNMP_MIB_ITEM(\"MPRstTx\", MPTCP_MIB_MPRSTTX),\n\tSNMP_MIB_ITEM(\"MPRstRx\", MPTCP_MIB_MPRSTRX),\n\tSNMP_MIB_ITEM(\"RcvPruned\", MPTCP_MIB_RCVPRUNED),\n\tSNMP_MIB_ITEM(\"SubflowStale\", MPTCP_MIB_SUBFLOWSTALE),\n\tSNMP_MIB_ITEM(\"SubflowRecover\", MPTCP_MIB_SUBFLOWRECOVER),\n\tSNMP_MIB_ITEM(\"SndWndShared\", MPTCP_MIB_SNDWNDSHARED),\n\tSNMP_MIB_ITEM(\"RcvWndShared\", MPTCP_MIB_RCVWNDSHARED),\n\tSNMP_MIB_ITEM(\"RcvWndConflictUpdate\", MPTCP_MIB_RCVWNDCONFLICTUPDATE),\n\tSNMP_MIB_ITEM(\"RcvWndConflict\", MPTCP_MIB_RCVWNDCONFLICT),\n\tSNMP_MIB_SENTINEL\n};\n\n \nbool mptcp_mib_alloc(struct net *net)\n{\n\tstruct mptcp_mib __percpu *mib = alloc_percpu(struct mptcp_mib);\n\n\tif (!mib)\n\t\treturn false;\n\n\tif (cmpxchg(&net->mib.mptcp_statistics, NULL, mib))\n\t\tfree_percpu(mib);\n\n\treturn true;\n}\n\nvoid mptcp_seq_show(struct seq_file *seq)\n{\n\tunsigned long sum[ARRAY_SIZE(mptcp_snmp_list) - 1];\n\tstruct net *net = seq->private;\n\tint i;\n\n\tseq_puts(seq, \"MPTcpExt:\");\n\tfor (i = 0; mptcp_snmp_list[i].name; i++)\n\t\tseq_printf(seq, \" %s\", mptcp_snmp_list[i].name);\n\n\tseq_puts(seq, \"\\nMPTcpExt:\");\n\n\tmemset(sum, 0, sizeof(sum));\n\tif (net->mib.mptcp_statistics)\n\t\tsnmp_get_cpu_field_batch(sum, mptcp_snmp_list,\n\t\t\t\t\t net->mib.mptcp_statistics);\n\n\tfor (i = 0; mptcp_snmp_list[i].name; i++)\n\t\tseq_printf(seq, \" %lu\", sum[i]);\n\n\tseq_putc(seq, '\\n');\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}