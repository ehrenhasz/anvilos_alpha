{
  "module_name": "crypto_test.c",
  "hash_id": "5fd255889c9bf04f0cb0922049a7d34419a140532803ea80054c423e1be4137c",
  "original_prompt": "Ingested from linux-6.6.14/net/mptcp/crypto_test.c",
  "human_readable_source": "\n#include <kunit/test.h>\n\n#include \"protocol.h\"\n\nstruct test_case {\n\tchar *key;\n\tchar *msg;\n\tchar *result;\n};\n\n \nstatic struct test_case tests[] = {\n\t{\n\t\t.key = \"0b0b0b0b0b0b0b0b\",\n\t\t.msg = \"48692054\",\n\t\t.result = \"8385e24fb4235ac37556b6b886db106284a1da671699f46db1f235ec622dcafa\",\n\t},\n\t{\n\t\t.key = \"aaaaaaaaaaaaaaaa\",\n\t\t.msg = \"dddddddd\",\n\t\t.result = \"2c5e219164ff1dca1c4a92318d847bb6b9d44492984e1eb71aff9022f71046e9\",\n\t},\n\t{\n\t\t.key = \"0102030405060708\",\n\t\t.msg = \"cdcdcdcd\",\n\t\t.result = \"e73b9ba9969969cefb04aa0d6df18ec2fcc075b6f23b4d8c4da736a5dbbc6e7d\",\n\t},\n};\n\nstatic void mptcp_crypto_test_basic(struct kunit *test)\n{\n\tchar hmac[32], hmac_hex[65];\n\tu32 nonce1, nonce2;\n\tu64 key1, key2;\n\tu8 msg[8];\n\tint i, j;\n\n\tfor (i = 0; i < ARRAY_SIZE(tests); ++i) {\n\t\t \n\t\tkey1 = be64_to_cpu(*((__be64 *)&tests[i].key[0]));\n\t\tkey2 = be64_to_cpu(*((__be64 *)&tests[i].key[8]));\n\t\tnonce1 = be32_to_cpu(*((__be32 *)&tests[i].msg[0]));\n\t\tnonce2 = be32_to_cpu(*((__be32 *)&tests[i].msg[4]));\n\n\t\tput_unaligned_be32(nonce1, &msg[0]);\n\t\tput_unaligned_be32(nonce2, &msg[4]);\n\n\t\tmptcp_crypto_hmac_sha(key1, key2, msg, 8, hmac);\n\t\tfor (j = 0; j < 32; ++j)\n\t\t\tsprintf(&hmac_hex[j << 1], \"%02x\", hmac[j] & 0xff);\n\t\thmac_hex[64] = 0;\n\n\t\tKUNIT_EXPECT_STREQ(test, &hmac_hex[0], tests[i].result);\n\t}\n}\n\nstatic struct kunit_case mptcp_crypto_test_cases[] = {\n\tKUNIT_CASE(mptcp_crypto_test_basic),\n\t{}\n};\n\nstatic struct kunit_suite mptcp_crypto_suite = {\n\t.name = \"mptcp-crypto\",\n\t.test_cases = mptcp_crypto_test_cases,\n};\n\nkunit_test_suite(mptcp_crypto_suite);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}