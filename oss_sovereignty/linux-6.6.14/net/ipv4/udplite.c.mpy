{
  "module_name": "udplite.c",
  "hash_id": "60aa4cba4f0c38fa6f89096c6449c2350899eb17244d73d3699f40c46bf5a55a",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv4/udplite.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) \"UDPLite: \" fmt\n\n#include <linux/export.h>\n#include <linux/proc_fs.h>\n#include \"udp_impl.h\"\n\nstruct udp_table \tudplite_table __read_mostly;\nEXPORT_SYMBOL(udplite_table);\n\n \nstatic int udplite_sk_init(struct sock *sk)\n{\n\tudp_init_sock(sk);\n\tpr_warn_once(\"UDP-Lite is deprecated and scheduled to be removed in 2025, \"\n\t\t     \"please contact the netdev mailing list\\n\");\n\treturn 0;\n}\n\nstatic int udplite_rcv(struct sk_buff *skb)\n{\n\treturn __udp4_lib_rcv(skb, &udplite_table, IPPROTO_UDPLITE);\n}\n\nstatic int udplite_err(struct sk_buff *skb, u32 info)\n{\n\treturn __udp4_lib_err(skb, info, &udplite_table);\n}\n\nstatic const struct net_protocol udplite_protocol = {\n\t.handler\t= udplite_rcv,\n\t.err_handler\t= udplite_err,\n\t.no_policy\t= 1,\n};\n\nstruct proto \tudplite_prot = {\n\t.name\t\t   = \"UDP-Lite\",\n\t.owner\t\t   = THIS_MODULE,\n\t.close\t\t   = udp_lib_close,\n\t.connect\t   = ip4_datagram_connect,\n\t.disconnect\t   = udp_disconnect,\n\t.ioctl\t\t   = udp_ioctl,\n\t.init\t\t   = udplite_sk_init,\n\t.destroy\t   = udp_destroy_sock,\n\t.setsockopt\t   = udp_setsockopt,\n\t.getsockopt\t   = udp_getsockopt,\n\t.sendmsg\t   = udp_sendmsg,\n\t.recvmsg\t   = udp_recvmsg,\n\t.hash\t\t   = udp_lib_hash,\n\t.unhash\t\t   = udp_lib_unhash,\n\t.rehash\t\t   = udp_v4_rehash,\n\t.get_port\t   = udp_v4_get_port,\n\n\t.memory_allocated  = &udp_memory_allocated,\n\t.per_cpu_fw_alloc  = &udp_memory_per_cpu_fw_alloc,\n\n\t.sysctl_mem\t   = sysctl_udp_mem,\n\t.sysctl_wmem_offset = offsetof(struct net, ipv4.sysctl_udp_wmem_min),\n\t.sysctl_rmem_offset = offsetof(struct net, ipv4.sysctl_udp_rmem_min),\n\t.obj_size\t   = sizeof(struct udp_sock),\n\t.h.udp_table\t   = &udplite_table,\n};\nEXPORT_SYMBOL(udplite_prot);\n\nstatic struct inet_protosw udplite4_protosw = {\n\t.type\t\t=  SOCK_DGRAM,\n\t.protocol\t=  IPPROTO_UDPLITE,\n\t.prot\t\t=  &udplite_prot,\n\t.ops\t\t=  &inet_dgram_ops,\n\t.flags\t\t=  INET_PROTOSW_PERMANENT,\n};\n\n#ifdef CONFIG_PROC_FS\nstatic struct udp_seq_afinfo udplite4_seq_afinfo = {\n\t.family\t\t= AF_INET,\n\t.udp_table \t= &udplite_table,\n};\n\nstatic int __net_init udplite4_proc_init_net(struct net *net)\n{\n\tif (!proc_create_net_data(\"udplite\", 0444, net->proc_net, &udp_seq_ops,\n\t\t\tsizeof(struct udp_iter_state), &udplite4_seq_afinfo))\n\t\treturn -ENOMEM;\n\treturn 0;\n}\n\nstatic void __net_exit udplite4_proc_exit_net(struct net *net)\n{\n\tremove_proc_entry(\"udplite\", net->proc_net);\n}\n\nstatic struct pernet_operations udplite4_net_ops = {\n\t.init = udplite4_proc_init_net,\n\t.exit = udplite4_proc_exit_net,\n};\n\nstatic __init int udplite4_proc_init(void)\n{\n\treturn register_pernet_subsys(&udplite4_net_ops);\n}\n#else\nstatic inline int udplite4_proc_init(void)\n{\n\treturn 0;\n}\n#endif\n\nvoid __init udplite4_register(void)\n{\n\tudp_table_init(&udplite_table, \"UDP-Lite\");\n\tif (proto_register(&udplite_prot, 1))\n\t\tgoto out_register_err;\n\n\tif (inet_add_protocol(&udplite_protocol, IPPROTO_UDPLITE) < 0)\n\t\tgoto out_unregister_proto;\n\n\tinet_register_protosw(&udplite4_protosw);\n\n\tif (udplite4_proc_init())\n\t\tpr_err(\"%s: Cannot register /proc!\\n\", __func__);\n\treturn;\n\nout_unregister_proto:\n\tproto_unregister(&udplite_prot);\nout_register_err:\n\tpr_crit(\"%s: Cannot add UDP-Lite protocol\\n\", __func__);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}