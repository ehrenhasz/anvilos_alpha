{
  "module_name": "proc.c",
  "hash_id": "2060d69c773f3cd954c487f5e6077b9bbb50023687551bed7e2589d78390dec5",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv4/proc.c",
  "human_readable_source": "\n \n#include <linux/types.h>\n#include <net/net_namespace.h>\n#include <net/icmp.h>\n#include <net/protocol.h>\n#include <net/tcp.h>\n#include <net/mptcp.h>\n#include <net/udp.h>\n#include <net/udplite.h>\n#include <linux/bottom_half.h>\n#include <linux/inetdevice.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <net/sock.h>\n#include <net/raw.h>\n\n#define TCPUDP_MIB_MAX max_t(u32, UDP_MIB_MAX, TCP_MIB_MAX)\n\n \nstatic int sockstat_seq_show(struct seq_file *seq, void *v)\n{\n\tstruct net *net = seq->private;\n\tint orphans, sockets;\n\n\torphans = tcp_orphan_count_sum();\n\tsockets = proto_sockets_allocated_sum_positive(&tcp_prot);\n\n\tsocket_seq_show(seq);\n\tseq_printf(seq, \"TCP: inuse %d orphan %d tw %d alloc %d mem %ld\\n\",\n\t\t   sock_prot_inuse_get(net, &tcp_prot), orphans,\n\t\t   refcount_read(&net->ipv4.tcp_death_row.tw_refcount) - 1,\n\t\t   sockets, proto_memory_allocated(&tcp_prot));\n\tseq_printf(seq, \"UDP: inuse %d mem %ld\\n\",\n\t\t   sock_prot_inuse_get(net, &udp_prot),\n\t\t   proto_memory_allocated(&udp_prot));\n\tseq_printf(seq, \"UDPLITE: inuse %d\\n\",\n\t\t   sock_prot_inuse_get(net, &udplite_prot));\n\tseq_printf(seq, \"RAW: inuse %d\\n\",\n\t\t   sock_prot_inuse_get(net, &raw_prot));\n\tseq_printf(seq,  \"FRAG: inuse %u memory %lu\\n\",\n\t\t   atomic_read(&net->ipv4.fqdir->rhashtable.nelems),\n\t\t   frag_mem_limit(net->ipv4.fqdir));\n\treturn 0;\n}\n\n \nstatic const struct snmp_mib snmp4_ipstats_list[] = {\n\tSNMP_MIB_ITEM(\"InReceives\", IPSTATS_MIB_INPKTS),\n\tSNMP_MIB_ITEM(\"InHdrErrors\", IPSTATS_MIB_INHDRERRORS),\n\tSNMP_MIB_ITEM(\"InAddrErrors\", IPSTATS_MIB_INADDRERRORS),\n\tSNMP_MIB_ITEM(\"ForwDatagrams\", IPSTATS_MIB_OUTFORWDATAGRAMS),\n\tSNMP_MIB_ITEM(\"InUnknownProtos\", IPSTATS_MIB_INUNKNOWNPROTOS),\n\tSNMP_MIB_ITEM(\"InDiscards\", IPSTATS_MIB_INDISCARDS),\n\tSNMP_MIB_ITEM(\"InDelivers\", IPSTATS_MIB_INDELIVERS),\n\tSNMP_MIB_ITEM(\"OutRequests\", IPSTATS_MIB_OUTPKTS),\n\tSNMP_MIB_ITEM(\"OutDiscards\", IPSTATS_MIB_OUTDISCARDS),\n\tSNMP_MIB_ITEM(\"OutNoRoutes\", IPSTATS_MIB_OUTNOROUTES),\n\tSNMP_MIB_ITEM(\"ReasmTimeout\", IPSTATS_MIB_REASMTIMEOUT),\n\tSNMP_MIB_ITEM(\"ReasmReqds\", IPSTATS_MIB_REASMREQDS),\n\tSNMP_MIB_ITEM(\"ReasmOKs\", IPSTATS_MIB_REASMOKS),\n\tSNMP_MIB_ITEM(\"ReasmFails\", IPSTATS_MIB_REASMFAILS),\n\tSNMP_MIB_ITEM(\"FragOKs\", IPSTATS_MIB_FRAGOKS),\n\tSNMP_MIB_ITEM(\"FragFails\", IPSTATS_MIB_FRAGFAILS),\n\tSNMP_MIB_ITEM(\"FragCreates\", IPSTATS_MIB_FRAGCREATES),\n\tSNMP_MIB_SENTINEL\n};\n\n \nstatic const struct snmp_mib snmp4_ipextstats_list[] = {\n\tSNMP_MIB_ITEM(\"InNoRoutes\", IPSTATS_MIB_INNOROUTES),\n\tSNMP_MIB_ITEM(\"InTruncatedPkts\", IPSTATS_MIB_INTRUNCATEDPKTS),\n\tSNMP_MIB_ITEM(\"InMcastPkts\", IPSTATS_MIB_INMCASTPKTS),\n\tSNMP_MIB_ITEM(\"OutMcastPkts\", IPSTATS_MIB_OUTMCASTPKTS),\n\tSNMP_MIB_ITEM(\"InBcastPkts\", IPSTATS_MIB_INBCASTPKTS),\n\tSNMP_MIB_ITEM(\"OutBcastPkts\", IPSTATS_MIB_OUTBCASTPKTS),\n\tSNMP_MIB_ITEM(\"InOctets\", IPSTATS_MIB_INOCTETS),\n\tSNMP_MIB_ITEM(\"OutOctets\", IPSTATS_MIB_OUTOCTETS),\n\tSNMP_MIB_ITEM(\"InMcastOctets\", IPSTATS_MIB_INMCASTOCTETS),\n\tSNMP_MIB_ITEM(\"OutMcastOctets\", IPSTATS_MIB_OUTMCASTOCTETS),\n\tSNMP_MIB_ITEM(\"InBcastOctets\", IPSTATS_MIB_INBCASTOCTETS),\n\tSNMP_MIB_ITEM(\"OutBcastOctets\", IPSTATS_MIB_OUTBCASTOCTETS),\n\t \n\tSNMP_MIB_ITEM(\"InCsumErrors\", IPSTATS_MIB_CSUMERRORS),\n\tSNMP_MIB_ITEM(\"InNoECTPkts\", IPSTATS_MIB_NOECTPKTS),\n\tSNMP_MIB_ITEM(\"InECT1Pkts\", IPSTATS_MIB_ECT1PKTS),\n\tSNMP_MIB_ITEM(\"InECT0Pkts\", IPSTATS_MIB_ECT0PKTS),\n\tSNMP_MIB_ITEM(\"InCEPkts\", IPSTATS_MIB_CEPKTS),\n\tSNMP_MIB_ITEM(\"ReasmOverlaps\", IPSTATS_MIB_REASM_OVERLAPS),\n\tSNMP_MIB_SENTINEL\n};\n\nstatic const struct {\n\tconst char *name;\n\tint index;\n} icmpmibmap[] = {\n\t{ \"DestUnreachs\", ICMP_DEST_UNREACH },\n\t{ \"TimeExcds\", ICMP_TIME_EXCEEDED },\n\t{ \"ParmProbs\", ICMP_PARAMETERPROB },\n\t{ \"SrcQuenchs\", ICMP_SOURCE_QUENCH },\n\t{ \"Redirects\", ICMP_REDIRECT },\n\t{ \"Echos\", ICMP_ECHO },\n\t{ \"EchoReps\", ICMP_ECHOREPLY },\n\t{ \"Timestamps\", ICMP_TIMESTAMP },\n\t{ \"TimestampReps\", ICMP_TIMESTAMPREPLY },\n\t{ \"AddrMasks\", ICMP_ADDRESS },\n\t{ \"AddrMaskReps\", ICMP_ADDRESSREPLY },\n\t{ NULL, 0 }\n};\n\n\nstatic const struct snmp_mib snmp4_tcp_list[] = {\n\tSNMP_MIB_ITEM(\"RtoAlgorithm\", TCP_MIB_RTOALGORITHM),\n\tSNMP_MIB_ITEM(\"RtoMin\", TCP_MIB_RTOMIN),\n\tSNMP_MIB_ITEM(\"RtoMax\", TCP_MIB_RTOMAX),\n\tSNMP_MIB_ITEM(\"MaxConn\", TCP_MIB_MAXCONN),\n\tSNMP_MIB_ITEM(\"ActiveOpens\", TCP_MIB_ACTIVEOPENS),\n\tSNMP_MIB_ITEM(\"PassiveOpens\", TCP_MIB_PASSIVEOPENS),\n\tSNMP_MIB_ITEM(\"AttemptFails\", TCP_MIB_ATTEMPTFAILS),\n\tSNMP_MIB_ITEM(\"EstabResets\", TCP_MIB_ESTABRESETS),\n\tSNMP_MIB_ITEM(\"CurrEstab\", TCP_MIB_CURRESTAB),\n\tSNMP_MIB_ITEM(\"InSegs\", TCP_MIB_INSEGS),\n\tSNMP_MIB_ITEM(\"OutSegs\", TCP_MIB_OUTSEGS),\n\tSNMP_MIB_ITEM(\"RetransSegs\", TCP_MIB_RETRANSSEGS),\n\tSNMP_MIB_ITEM(\"InErrs\", TCP_MIB_INERRS),\n\tSNMP_MIB_ITEM(\"OutRsts\", TCP_MIB_OUTRSTS),\n\tSNMP_MIB_ITEM(\"InCsumErrors\", TCP_MIB_CSUMERRORS),\n\tSNMP_MIB_SENTINEL\n};\n\nstatic const struct snmp_mib snmp4_udp_list[] = {\n\tSNMP_MIB_ITEM(\"InDatagrams\", UDP_MIB_INDATAGRAMS),\n\tSNMP_MIB_ITEM(\"NoPorts\", UDP_MIB_NOPORTS),\n\tSNMP_MIB_ITEM(\"InErrors\", UDP_MIB_INERRORS),\n\tSNMP_MIB_ITEM(\"OutDatagrams\", UDP_MIB_OUTDATAGRAMS),\n\tSNMP_MIB_ITEM(\"RcvbufErrors\", UDP_MIB_RCVBUFERRORS),\n\tSNMP_MIB_ITEM(\"SndbufErrors\", UDP_MIB_SNDBUFERRORS),\n\tSNMP_MIB_ITEM(\"InCsumErrors\", UDP_MIB_CSUMERRORS),\n\tSNMP_MIB_ITEM(\"IgnoredMulti\", UDP_MIB_IGNOREDMULTI),\n\tSNMP_MIB_ITEM(\"MemErrors\", UDP_MIB_MEMERRORS),\n\tSNMP_MIB_SENTINEL\n};\n\nstatic const struct snmp_mib snmp4_net_list[] = {\n\tSNMP_MIB_ITEM(\"SyncookiesSent\", LINUX_MIB_SYNCOOKIESSENT),\n\tSNMP_MIB_ITEM(\"SyncookiesRecv\", LINUX_MIB_SYNCOOKIESRECV),\n\tSNMP_MIB_ITEM(\"SyncookiesFailed\", LINUX_MIB_SYNCOOKIESFAILED),\n\tSNMP_MIB_ITEM(\"EmbryonicRsts\", LINUX_MIB_EMBRYONICRSTS),\n\tSNMP_MIB_ITEM(\"PruneCalled\", LINUX_MIB_PRUNECALLED),\n\tSNMP_MIB_ITEM(\"RcvPruned\", LINUX_MIB_RCVPRUNED),\n\tSNMP_MIB_ITEM(\"OfoPruned\", LINUX_MIB_OFOPRUNED),\n\tSNMP_MIB_ITEM(\"OutOfWindowIcmps\", LINUX_MIB_OUTOFWINDOWICMPS),\n\tSNMP_MIB_ITEM(\"LockDroppedIcmps\", LINUX_MIB_LOCKDROPPEDICMPS),\n\tSNMP_MIB_ITEM(\"ArpFilter\", LINUX_MIB_ARPFILTER),\n\tSNMP_MIB_ITEM(\"TW\", LINUX_MIB_TIMEWAITED),\n\tSNMP_MIB_ITEM(\"TWRecycled\", LINUX_MIB_TIMEWAITRECYCLED),\n\tSNMP_MIB_ITEM(\"TWKilled\", LINUX_MIB_TIMEWAITKILLED),\n\tSNMP_MIB_ITEM(\"PAWSActive\", LINUX_MIB_PAWSACTIVEREJECTED),\n\tSNMP_MIB_ITEM(\"PAWSEstab\", LINUX_MIB_PAWSESTABREJECTED),\n\tSNMP_MIB_ITEM(\"DelayedACKs\", LINUX_MIB_DELAYEDACKS),\n\tSNMP_MIB_ITEM(\"DelayedACKLocked\", LINUX_MIB_DELAYEDACKLOCKED),\n\tSNMP_MIB_ITEM(\"DelayedACKLost\", LINUX_MIB_DELAYEDACKLOST),\n\tSNMP_MIB_ITEM(\"ListenOverflows\", LINUX_MIB_LISTENOVERFLOWS),\n\tSNMP_MIB_ITEM(\"ListenDrops\", LINUX_MIB_LISTENDROPS),\n\tSNMP_MIB_ITEM(\"TCPHPHits\", LINUX_MIB_TCPHPHITS),\n\tSNMP_MIB_ITEM(\"TCPPureAcks\", LINUX_MIB_TCPPUREACKS),\n\tSNMP_MIB_ITEM(\"TCPHPAcks\", LINUX_MIB_TCPHPACKS),\n\tSNMP_MIB_ITEM(\"TCPRenoRecovery\", LINUX_MIB_TCPRENORECOVERY),\n\tSNMP_MIB_ITEM(\"TCPSackRecovery\", LINUX_MIB_TCPSACKRECOVERY),\n\tSNMP_MIB_ITEM(\"TCPSACKReneging\", LINUX_MIB_TCPSACKRENEGING),\n\tSNMP_MIB_ITEM(\"TCPSACKReorder\", LINUX_MIB_TCPSACKREORDER),\n\tSNMP_MIB_ITEM(\"TCPRenoReorder\", LINUX_MIB_TCPRENOREORDER),\n\tSNMP_MIB_ITEM(\"TCPTSReorder\", LINUX_MIB_TCPTSREORDER),\n\tSNMP_MIB_ITEM(\"TCPFullUndo\", LINUX_MIB_TCPFULLUNDO),\n\tSNMP_MIB_ITEM(\"TCPPartialUndo\", LINUX_MIB_TCPPARTIALUNDO),\n\tSNMP_MIB_ITEM(\"TCPDSACKUndo\", LINUX_MIB_TCPDSACKUNDO),\n\tSNMP_MIB_ITEM(\"TCPLossUndo\", LINUX_MIB_TCPLOSSUNDO),\n\tSNMP_MIB_ITEM(\"TCPLostRetransmit\", LINUX_MIB_TCPLOSTRETRANSMIT),\n\tSNMP_MIB_ITEM(\"TCPRenoFailures\", LINUX_MIB_TCPRENOFAILURES),\n\tSNMP_MIB_ITEM(\"TCPSackFailures\", LINUX_MIB_TCPSACKFAILURES),\n\tSNMP_MIB_ITEM(\"TCPLossFailures\", LINUX_MIB_TCPLOSSFAILURES),\n\tSNMP_MIB_ITEM(\"TCPFastRetrans\", LINUX_MIB_TCPFASTRETRANS),\n\tSNMP_MIB_ITEM(\"TCPSlowStartRetrans\", LINUX_MIB_TCPSLOWSTARTRETRANS),\n\tSNMP_MIB_ITEM(\"TCPTimeouts\", LINUX_MIB_TCPTIMEOUTS),\n\tSNMP_MIB_ITEM(\"TCPLossProbes\", LINUX_MIB_TCPLOSSPROBES),\n\tSNMP_MIB_ITEM(\"TCPLossProbeRecovery\", LINUX_MIB_TCPLOSSPROBERECOVERY),\n\tSNMP_MIB_ITEM(\"TCPRenoRecoveryFail\", LINUX_MIB_TCPRENORECOVERYFAIL),\n\tSNMP_MIB_ITEM(\"TCPSackRecoveryFail\", LINUX_MIB_TCPSACKRECOVERYFAIL),\n\tSNMP_MIB_ITEM(\"TCPRcvCollapsed\", LINUX_MIB_TCPRCVCOLLAPSED),\n\tSNMP_MIB_ITEM(\"TCPBacklogCoalesce\", LINUX_MIB_TCPBACKLOGCOALESCE),\n\tSNMP_MIB_ITEM(\"TCPDSACKOldSent\", LINUX_MIB_TCPDSACKOLDSENT),\n\tSNMP_MIB_ITEM(\"TCPDSACKOfoSent\", LINUX_MIB_TCPDSACKOFOSENT),\n\tSNMP_MIB_ITEM(\"TCPDSACKRecv\", LINUX_MIB_TCPDSACKRECV),\n\tSNMP_MIB_ITEM(\"TCPDSACKOfoRecv\", LINUX_MIB_TCPDSACKOFORECV),\n\tSNMP_MIB_ITEM(\"TCPAbortOnData\", LINUX_MIB_TCPABORTONDATA),\n\tSNMP_MIB_ITEM(\"TCPAbortOnClose\", LINUX_MIB_TCPABORTONCLOSE),\n\tSNMP_MIB_ITEM(\"TCPAbortOnMemory\", LINUX_MIB_TCPABORTONMEMORY),\n\tSNMP_MIB_ITEM(\"TCPAbortOnTimeout\", LINUX_MIB_TCPABORTONTIMEOUT),\n\tSNMP_MIB_ITEM(\"TCPAbortOnLinger\", LINUX_MIB_TCPABORTONLINGER),\n\tSNMP_MIB_ITEM(\"TCPAbortFailed\", LINUX_MIB_TCPABORTFAILED),\n\tSNMP_MIB_ITEM(\"TCPMemoryPressures\", LINUX_MIB_TCPMEMORYPRESSURES),\n\tSNMP_MIB_ITEM(\"TCPMemoryPressuresChrono\", LINUX_MIB_TCPMEMORYPRESSURESCHRONO),\n\tSNMP_MIB_ITEM(\"TCPSACKDiscard\", LINUX_MIB_TCPSACKDISCARD),\n\tSNMP_MIB_ITEM(\"TCPDSACKIgnoredOld\", LINUX_MIB_TCPDSACKIGNOREDOLD),\n\tSNMP_MIB_ITEM(\"TCPDSACKIgnoredNoUndo\", LINUX_MIB_TCPDSACKIGNOREDNOUNDO),\n\tSNMP_MIB_ITEM(\"TCPSpuriousRTOs\", LINUX_MIB_TCPSPURIOUSRTOS),\n\tSNMP_MIB_ITEM(\"TCPMD5NotFound\", LINUX_MIB_TCPMD5NOTFOUND),\n\tSNMP_MIB_ITEM(\"TCPMD5Unexpected\", LINUX_MIB_TCPMD5UNEXPECTED),\n\tSNMP_MIB_ITEM(\"TCPMD5Failure\", LINUX_MIB_TCPMD5FAILURE),\n\tSNMP_MIB_ITEM(\"TCPSackShifted\", LINUX_MIB_SACKSHIFTED),\n\tSNMP_MIB_ITEM(\"TCPSackMerged\", LINUX_MIB_SACKMERGED),\n\tSNMP_MIB_ITEM(\"TCPSackShiftFallback\", LINUX_MIB_SACKSHIFTFALLBACK),\n\tSNMP_MIB_ITEM(\"TCPBacklogDrop\", LINUX_MIB_TCPBACKLOGDROP),\n\tSNMP_MIB_ITEM(\"PFMemallocDrop\", LINUX_MIB_PFMEMALLOCDROP),\n\tSNMP_MIB_ITEM(\"TCPMinTTLDrop\", LINUX_MIB_TCPMINTTLDROP),\n\tSNMP_MIB_ITEM(\"TCPDeferAcceptDrop\", LINUX_MIB_TCPDEFERACCEPTDROP),\n\tSNMP_MIB_ITEM(\"IPReversePathFilter\", LINUX_MIB_IPRPFILTER),\n\tSNMP_MIB_ITEM(\"TCPTimeWaitOverflow\", LINUX_MIB_TCPTIMEWAITOVERFLOW),\n\tSNMP_MIB_ITEM(\"TCPReqQFullDoCookies\", LINUX_MIB_TCPREQQFULLDOCOOKIES),\n\tSNMP_MIB_ITEM(\"TCPReqQFullDrop\", LINUX_MIB_TCPREQQFULLDROP),\n\tSNMP_MIB_ITEM(\"TCPRetransFail\", LINUX_MIB_TCPRETRANSFAIL),\n\tSNMP_MIB_ITEM(\"TCPRcvCoalesce\", LINUX_MIB_TCPRCVCOALESCE),\n\tSNMP_MIB_ITEM(\"TCPOFOQueue\", LINUX_MIB_TCPOFOQUEUE),\n\tSNMP_MIB_ITEM(\"TCPOFODrop\", LINUX_MIB_TCPOFODROP),\n\tSNMP_MIB_ITEM(\"TCPOFOMerge\", LINUX_MIB_TCPOFOMERGE),\n\tSNMP_MIB_ITEM(\"TCPChallengeACK\", LINUX_MIB_TCPCHALLENGEACK),\n\tSNMP_MIB_ITEM(\"TCPSYNChallenge\", LINUX_MIB_TCPSYNCHALLENGE),\n\tSNMP_MIB_ITEM(\"TCPFastOpenActive\", LINUX_MIB_TCPFASTOPENACTIVE),\n\tSNMP_MIB_ITEM(\"TCPFastOpenActiveFail\", LINUX_MIB_TCPFASTOPENACTIVEFAIL),\n\tSNMP_MIB_ITEM(\"TCPFastOpenPassive\", LINUX_MIB_TCPFASTOPENPASSIVE),\n\tSNMP_MIB_ITEM(\"TCPFastOpenPassiveFail\", LINUX_MIB_TCPFASTOPENPASSIVEFAIL),\n\tSNMP_MIB_ITEM(\"TCPFastOpenListenOverflow\", LINUX_MIB_TCPFASTOPENLISTENOVERFLOW),\n\tSNMP_MIB_ITEM(\"TCPFastOpenCookieReqd\", LINUX_MIB_TCPFASTOPENCOOKIEREQD),\n\tSNMP_MIB_ITEM(\"TCPFastOpenBlackhole\", LINUX_MIB_TCPFASTOPENBLACKHOLE),\n\tSNMP_MIB_ITEM(\"TCPSpuriousRtxHostQueues\", LINUX_MIB_TCPSPURIOUS_RTX_HOSTQUEUES),\n\tSNMP_MIB_ITEM(\"BusyPollRxPackets\", LINUX_MIB_BUSYPOLLRXPACKETS),\n\tSNMP_MIB_ITEM(\"TCPAutoCorking\", LINUX_MIB_TCPAUTOCORKING),\n\tSNMP_MIB_ITEM(\"TCPFromZeroWindowAdv\", LINUX_MIB_TCPFROMZEROWINDOWADV),\n\tSNMP_MIB_ITEM(\"TCPToZeroWindowAdv\", LINUX_MIB_TCPTOZEROWINDOWADV),\n\tSNMP_MIB_ITEM(\"TCPWantZeroWindowAdv\", LINUX_MIB_TCPWANTZEROWINDOWADV),\n\tSNMP_MIB_ITEM(\"TCPSynRetrans\", LINUX_MIB_TCPSYNRETRANS),\n\tSNMP_MIB_ITEM(\"TCPOrigDataSent\", LINUX_MIB_TCPORIGDATASENT),\n\tSNMP_MIB_ITEM(\"TCPHystartTrainDetect\", LINUX_MIB_TCPHYSTARTTRAINDETECT),\n\tSNMP_MIB_ITEM(\"TCPHystartTrainCwnd\", LINUX_MIB_TCPHYSTARTTRAINCWND),\n\tSNMP_MIB_ITEM(\"TCPHystartDelayDetect\", LINUX_MIB_TCPHYSTARTDELAYDETECT),\n\tSNMP_MIB_ITEM(\"TCPHystartDelayCwnd\", LINUX_MIB_TCPHYSTARTDELAYCWND),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedSynRecv\", LINUX_MIB_TCPACKSKIPPEDSYNRECV),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedPAWS\", LINUX_MIB_TCPACKSKIPPEDPAWS),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedSeq\", LINUX_MIB_TCPACKSKIPPEDSEQ),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedFinWait2\", LINUX_MIB_TCPACKSKIPPEDFINWAIT2),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedTimeWait\", LINUX_MIB_TCPACKSKIPPEDTIMEWAIT),\n\tSNMP_MIB_ITEM(\"TCPACKSkippedChallenge\", LINUX_MIB_TCPACKSKIPPEDCHALLENGE),\n\tSNMP_MIB_ITEM(\"TCPWinProbe\", LINUX_MIB_TCPWINPROBE),\n\tSNMP_MIB_ITEM(\"TCPKeepAlive\", LINUX_MIB_TCPKEEPALIVE),\n\tSNMP_MIB_ITEM(\"TCPMTUPFail\", LINUX_MIB_TCPMTUPFAIL),\n\tSNMP_MIB_ITEM(\"TCPMTUPSuccess\", LINUX_MIB_TCPMTUPSUCCESS),\n\tSNMP_MIB_ITEM(\"TCPDelivered\", LINUX_MIB_TCPDELIVERED),\n\tSNMP_MIB_ITEM(\"TCPDeliveredCE\", LINUX_MIB_TCPDELIVEREDCE),\n\tSNMP_MIB_ITEM(\"TCPAckCompressed\", LINUX_MIB_TCPACKCOMPRESSED),\n\tSNMP_MIB_ITEM(\"TCPZeroWindowDrop\", LINUX_MIB_TCPZEROWINDOWDROP),\n\tSNMP_MIB_ITEM(\"TCPRcvQDrop\", LINUX_MIB_TCPRCVQDROP),\n\tSNMP_MIB_ITEM(\"TCPWqueueTooBig\", LINUX_MIB_TCPWQUEUETOOBIG),\n\tSNMP_MIB_ITEM(\"TCPFastOpenPassiveAltKey\", LINUX_MIB_TCPFASTOPENPASSIVEALTKEY),\n\tSNMP_MIB_ITEM(\"TcpTimeoutRehash\", LINUX_MIB_TCPTIMEOUTREHASH),\n\tSNMP_MIB_ITEM(\"TcpDuplicateDataRehash\", LINUX_MIB_TCPDUPLICATEDATAREHASH),\n\tSNMP_MIB_ITEM(\"TCPDSACKRecvSegs\", LINUX_MIB_TCPDSACKRECVSEGS),\n\tSNMP_MIB_ITEM(\"TCPDSACKIgnoredDubious\", LINUX_MIB_TCPDSACKIGNOREDDUBIOUS),\n\tSNMP_MIB_ITEM(\"TCPMigrateReqSuccess\", LINUX_MIB_TCPMIGRATEREQSUCCESS),\n\tSNMP_MIB_ITEM(\"TCPMigrateReqFailure\", LINUX_MIB_TCPMIGRATEREQFAILURE),\n\tSNMP_MIB_ITEM(\"TCPPLBRehash\", LINUX_MIB_TCPPLBREHASH),\n\tSNMP_MIB_SENTINEL\n};\n\nstatic void icmpmsg_put_line(struct seq_file *seq, unsigned long *vals,\n\t\t\t     unsigned short *type, int count)\n{\n\tint j;\n\n\tif (count) {\n\t\tseq_puts(seq, \"\\nIcmpMsg:\");\n\t\tfor (j = 0; j < count; ++j)\n\t\t\tseq_printf(seq, \" %sType%u\",\n\t\t\t\ttype[j] & 0x100 ? \"Out\" : \"In\",\n\t\t\t\ttype[j] & 0xff);\n\t\tseq_puts(seq, \"\\nIcmpMsg:\");\n\t\tfor (j = 0; j < count; ++j)\n\t\t\tseq_printf(seq, \" %lu\", vals[j]);\n\t}\n}\n\nstatic void icmpmsg_put(struct seq_file *seq)\n{\n#define PERLINE\t16\n\n\tint i, count;\n\tunsigned short type[PERLINE];\n\tunsigned long vals[PERLINE], val;\n\tstruct net *net = seq->private;\n\n\tcount = 0;\n\tfor (i = 0; i < ICMPMSG_MIB_MAX; i++) {\n\t\tval = atomic_long_read(&net->mib.icmpmsg_statistics->mibs[i]);\n\t\tif (val) {\n\t\t\ttype[count] = i;\n\t\t\tvals[count++] = val;\n\t\t}\n\t\tif (count == PERLINE) {\n\t\t\ticmpmsg_put_line(seq, vals, type, count);\n\t\t\tcount = 0;\n\t\t}\n\t}\n\ticmpmsg_put_line(seq, vals, type, count);\n\n#undef PERLINE\n}\n\nstatic void icmp_put(struct seq_file *seq)\n{\n\tint i;\n\tstruct net *net = seq->private;\n\tatomic_long_t *ptr = net->mib.icmpmsg_statistics->mibs;\n\n\tseq_puts(seq, \"\\nIcmp: InMsgs InErrors InCsumErrors\");\n\tfor (i = 0; icmpmibmap[i].name; i++)\n\t\tseq_printf(seq, \" In%s\", icmpmibmap[i].name);\n\tseq_puts(seq, \" OutMsgs OutErrors OutRateLimitGlobal OutRateLimitHost\");\n\tfor (i = 0; icmpmibmap[i].name; i++)\n\t\tseq_printf(seq, \" Out%s\", icmpmibmap[i].name);\n\tseq_printf(seq, \"\\nIcmp: %lu %lu %lu\",\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_INMSGS),\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_INERRORS),\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_CSUMERRORS));\n\tfor (i = 0; icmpmibmap[i].name; i++)\n\t\tseq_printf(seq, \" %lu\",\n\t\t\t   atomic_long_read(ptr + icmpmibmap[i].index));\n\tseq_printf(seq, \" %lu %lu %lu %lu\",\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_OUTMSGS),\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_OUTERRORS),\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_RATELIMITGLOBAL),\n\t\tsnmp_fold_field(net->mib.icmp_statistics, ICMP_MIB_RATELIMITHOST));\n\tfor (i = 0; icmpmibmap[i].name; i++)\n\t\tseq_printf(seq, \" %lu\",\n\t\t\t   atomic_long_read(ptr + (icmpmibmap[i].index | 0x100)));\n}\n\n \nstatic int snmp_seq_show_ipstats(struct seq_file *seq, void *v)\n{\n\tstruct net *net = seq->private;\n\tu64 buff64[IPSTATS_MIB_MAX];\n\tint i;\n\n\tmemset(buff64, 0, IPSTATS_MIB_MAX * sizeof(u64));\n\n\tseq_puts(seq, \"Ip: Forwarding DefaultTTL\");\n\tfor (i = 0; snmp4_ipstats_list[i].name; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_ipstats_list[i].name);\n\n\tseq_printf(seq, \"\\nIp: %d %d\",\n\t\t   IPV4_DEVCONF_ALL(net, FORWARDING) ? 1 : 2,\n\t\t   READ_ONCE(net->ipv4.sysctl_ip_default_ttl));\n\n\tBUILD_BUG_ON(offsetof(struct ipstats_mib, mibs) != 0);\n\tsnmp_get_cpu_field64_batch(buff64, snmp4_ipstats_list,\n\t\t\t\t   net->mib.ip_statistics,\n\t\t\t\t   offsetof(struct ipstats_mib, syncp));\n\tfor (i = 0; snmp4_ipstats_list[i].name; i++)\n\t\tseq_printf(seq, \" %llu\", buff64[i]);\n\n\treturn 0;\n}\n\nstatic int snmp_seq_show_tcp_udp(struct seq_file *seq, void *v)\n{\n\tunsigned long buff[TCPUDP_MIB_MAX];\n\tstruct net *net = seq->private;\n\tint i;\n\n\tmemset(buff, 0, TCPUDP_MIB_MAX * sizeof(unsigned long));\n\n\tseq_puts(seq, \"\\nTcp:\");\n\tfor (i = 0; snmp4_tcp_list[i].name; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_tcp_list[i].name);\n\n\tseq_puts(seq, \"\\nTcp:\");\n\tsnmp_get_cpu_field_batch(buff, snmp4_tcp_list,\n\t\t\t\t net->mib.tcp_statistics);\n\tfor (i = 0; snmp4_tcp_list[i].name; i++) {\n\t\t \n\t\tif (snmp4_tcp_list[i].entry == TCP_MIB_MAXCONN)\n\t\t\tseq_printf(seq, \" %ld\", buff[i]);\n\t\telse\n\t\t\tseq_printf(seq, \" %lu\", buff[i]);\n\t}\n\n\tmemset(buff, 0, TCPUDP_MIB_MAX * sizeof(unsigned long));\n\n\tsnmp_get_cpu_field_batch(buff, snmp4_udp_list,\n\t\t\t\t net->mib.udp_statistics);\n\tseq_puts(seq, \"\\nUdp:\");\n\tfor (i = 0; snmp4_udp_list[i].name; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_udp_list[i].name);\n\tseq_puts(seq, \"\\nUdp:\");\n\tfor (i = 0; snmp4_udp_list[i].name; i++)\n\t\tseq_printf(seq, \" %lu\", buff[i]);\n\n\tmemset(buff, 0, TCPUDP_MIB_MAX * sizeof(unsigned long));\n\n\t \n\tseq_puts(seq, \"\\nUdpLite:\");\n\tsnmp_get_cpu_field_batch(buff, snmp4_udp_list,\n\t\t\t\t net->mib.udplite_statistics);\n\tfor (i = 0; snmp4_udp_list[i].name; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_udp_list[i].name);\n\tseq_puts(seq, \"\\nUdpLite:\");\n\tfor (i = 0; snmp4_udp_list[i].name; i++)\n\t\tseq_printf(seq, \" %lu\", buff[i]);\n\n\tseq_putc(seq, '\\n');\n\treturn 0;\n}\n\nstatic int snmp_seq_show(struct seq_file *seq, void *v)\n{\n\tsnmp_seq_show_ipstats(seq, v);\n\n\ticmp_put(seq);\t \n\ticmpmsg_put(seq);\n\n\tsnmp_seq_show_tcp_udp(seq, v);\n\n\treturn 0;\n}\n\n \nstatic int netstat_seq_show(struct seq_file *seq, void *v)\n{\n\tconst int ip_cnt = ARRAY_SIZE(snmp4_ipextstats_list) - 1;\n\tconst int tcp_cnt = ARRAY_SIZE(snmp4_net_list) - 1;\n\tstruct net *net = seq->private;\n\tunsigned long *buff;\n\tint i;\n\n\tseq_puts(seq, \"TcpExt:\");\n\tfor (i = 0; i < tcp_cnt; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_net_list[i].name);\n\n\tseq_puts(seq, \"\\nTcpExt:\");\n\tbuff = kzalloc(max(tcp_cnt * sizeof(long), ip_cnt * sizeof(u64)),\n\t\t       GFP_KERNEL);\n\tif (buff) {\n\t\tsnmp_get_cpu_field_batch(buff, snmp4_net_list,\n\t\t\t\t\t net->mib.net_statistics);\n\t\tfor (i = 0; i < tcp_cnt; i++)\n\t\t\tseq_printf(seq, \" %lu\", buff[i]);\n\t} else {\n\t\tfor (i = 0; i < tcp_cnt; i++)\n\t\t\tseq_printf(seq, \" %lu\",\n\t\t\t\t   snmp_fold_field(net->mib.net_statistics,\n\t\t\t\t\t\t   snmp4_net_list[i].entry));\n\t}\n\tseq_puts(seq, \"\\nIpExt:\");\n\tfor (i = 0; i < ip_cnt; i++)\n\t\tseq_printf(seq, \" %s\", snmp4_ipextstats_list[i].name);\n\n\tseq_puts(seq, \"\\nIpExt:\");\n\tif (buff) {\n\t\tu64 *buff64 = (u64 *)buff;\n\n\t\tmemset(buff64, 0, ip_cnt * sizeof(u64));\n\t\tsnmp_get_cpu_field64_batch(buff64, snmp4_ipextstats_list,\n\t\t\t\t\t   net->mib.ip_statistics,\n\t\t\t\t\t   offsetof(struct ipstats_mib, syncp));\n\t\tfor (i = 0; i < ip_cnt; i++)\n\t\t\tseq_printf(seq, \" %llu\", buff64[i]);\n\t} else {\n\t\tfor (i = 0; i < ip_cnt; i++)\n\t\t\tseq_printf(seq, \" %llu\",\n\t\t\t\t   snmp_fold_field64(net->mib.ip_statistics,\n\t\t\t\t\t\t     snmp4_ipextstats_list[i].entry,\n\t\t\t\t\t\t     offsetof(struct ipstats_mib, syncp)));\n\t}\n\tkfree(buff);\n\tseq_putc(seq, '\\n');\n\tmptcp_seq_show(seq);\n\treturn 0;\n}\n\nstatic __net_init int ip_proc_init_net(struct net *net)\n{\n\tif (!proc_create_net_single(\"sockstat\", 0444, net->proc_net,\n\t\t\tsockstat_seq_show, NULL))\n\t\tgoto out_sockstat;\n\tif (!proc_create_net_single(\"netstat\", 0444, net->proc_net,\n\t\t\tnetstat_seq_show, NULL))\n\t\tgoto out_netstat;\n\tif (!proc_create_net_single(\"snmp\", 0444, net->proc_net, snmp_seq_show,\n\t\t\tNULL))\n\t\tgoto out_snmp;\n\n\treturn 0;\n\nout_snmp:\n\tremove_proc_entry(\"netstat\", net->proc_net);\nout_netstat:\n\tremove_proc_entry(\"sockstat\", net->proc_net);\nout_sockstat:\n\treturn -ENOMEM;\n}\n\nstatic __net_exit void ip_proc_exit_net(struct net *net)\n{\n\tremove_proc_entry(\"snmp\", net->proc_net);\n\tremove_proc_entry(\"netstat\", net->proc_net);\n\tremove_proc_entry(\"sockstat\", net->proc_net);\n}\n\nstatic __net_initdata struct pernet_operations ip_proc_ops = {\n\t.init = ip_proc_init_net,\n\t.exit = ip_proc_exit_net,\n};\n\nint __init ip_misc_proc_init(void)\n{\n\treturn register_pernet_subsys(&ip_proc_ops);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}