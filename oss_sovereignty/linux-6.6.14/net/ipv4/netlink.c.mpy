{
  "module_name": "netlink.c",
  "hash_id": "ef4a6b16acad2cbbb2de50517873835b6f1a65f47de52d669701994cf607102a",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv4/netlink.c",
  "human_readable_source": "\n#include <linux/netlink.h>\n#include <linux/rtnetlink.h>\n#include <linux/types.h>\n#include <net/net_namespace.h>\n#include <net/netlink.h>\n#include <linux/in6.h>\n#include <net/ip.h>\n\nint rtm_getroute_parse_ip_proto(struct nlattr *attr, u8 *ip_proto, u8 family,\n\t\t\t\tstruct netlink_ext_ack *extack)\n{\n\t*ip_proto = nla_get_u8(attr);\n\n\tswitch (*ip_proto) {\n\tcase IPPROTO_TCP:\n\tcase IPPROTO_UDP:\n\t\treturn 0;\n\tcase IPPROTO_ICMP:\n\t\tif (family != AF_INET)\n\t\t\tbreak;\n\t\treturn 0;\n#if IS_ENABLED(CONFIG_IPV6)\n\tcase IPPROTO_ICMPV6:\n\t\tif (family != AF_INET6)\n\t\t\tbreak;\n\t\treturn 0;\n#endif\n\t}\n\tNL_SET_ERR_MSG(extack, \"Unsupported ip proto\");\n\treturn -EOPNOTSUPP;\n}\nEXPORT_SYMBOL_GPL(rtm_getroute_parse_ip_proto);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}