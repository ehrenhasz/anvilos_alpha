{
  "module_name": "vmci_transport.h",
  "hash_id": "742b0e882c4dee3d3d9793ff65d18db748d540a3bf79cb71018a3c120eb89053",
  "original_prompt": "Ingested from linux-6.6.14/net/vmw_vsock/vmci_transport.h",
  "human_readable_source": " \n \n\n#ifndef _VMCI_TRANSPORT_H_\n#define _VMCI_TRANSPORT_H_\n\n#include <linux/vmw_vmci_defs.h>\n#include <linux/vmw_vmci_api.h>\n\n#include <net/vsock_addr.h>\n#include <net/af_vsock.h>\n\n \n#define VMCI_TRANSPORT_PACKET_VERSION 1\n\n \n#define VMCI_TRANSPORT_PACKET_RID 1\n\n \n#define VMCI_TRANSPORT_HYPERVISOR_PACKET_RID 15\n\n#define VSOCK_PROTO_INVALID        0\n#define VSOCK_PROTO_PKT_ON_NOTIFY (1 << 0)\n#define VSOCK_PROTO_ALL_SUPPORTED (VSOCK_PROTO_PKT_ON_NOTIFY)\n\n#define vmci_trans(_vsk) ((struct vmci_transport *)((_vsk)->trans))\n\nenum vmci_transport_packet_type {\n\tVMCI_TRANSPORT_PACKET_TYPE_INVALID = 0,\n\tVMCI_TRANSPORT_PACKET_TYPE_REQUEST,\n\tVMCI_TRANSPORT_PACKET_TYPE_NEGOTIATE,\n\tVMCI_TRANSPORT_PACKET_TYPE_OFFER,\n\tVMCI_TRANSPORT_PACKET_TYPE_ATTACH,\n\tVMCI_TRANSPORT_PACKET_TYPE_WROTE,\n\tVMCI_TRANSPORT_PACKET_TYPE_READ,\n\tVMCI_TRANSPORT_PACKET_TYPE_RST,\n\tVMCI_TRANSPORT_PACKET_TYPE_SHUTDOWN,\n\tVMCI_TRANSPORT_PACKET_TYPE_WAITING_WRITE,\n\tVMCI_TRANSPORT_PACKET_TYPE_WAITING_READ,\n\tVMCI_TRANSPORT_PACKET_TYPE_REQUEST2,\n\tVMCI_TRANSPORT_PACKET_TYPE_NEGOTIATE2,\n\tVMCI_TRANSPORT_PACKET_TYPE_MAX\n};\n\nstruct vmci_transport_waiting_info {\n\tu64 generation;\n\tu64 offset;\n};\n\n \nstruct vmci_transport_packet {\n\tstruct vmci_datagram dg;\n\tu8 version;\n\tu8 type;\n\tu16 proto;\n\tu32 src_port;\n\tu32 dst_port;\n\tu32 _reserved2;\n\tunion {\n\t\tu64 size;\n\t\tu64 mode;\n\t\tstruct vmci_handle handle;\n\t\tstruct vmci_transport_waiting_info wait;\n\t} u;\n};\n\nstruct vmci_transport_notify_pkt {\n\tu64 write_notify_window;\n\tu64 write_notify_min_window;\n\tbool peer_waiting_read;\n\tbool peer_waiting_write;\n\tbool peer_waiting_write_detected;\n\tbool sent_waiting_read;\n\tbool sent_waiting_write;\n\tstruct vmci_transport_waiting_info peer_waiting_read_info;\n\tstruct vmci_transport_waiting_info peer_waiting_write_info;\n\tu64 produce_q_generation;\n\tu64 consume_q_generation;\n};\n\nstruct vmci_transport_notify_pkt_q_state {\n\tu64 write_notify_window;\n\tu64 write_notify_min_window;\n\tbool peer_waiting_write;\n\tbool peer_waiting_write_detected;\n};\n\nunion vmci_transport_notify {\n\tstruct vmci_transport_notify_pkt pkt;\n\tstruct vmci_transport_notify_pkt_q_state pkt_q_state;\n};\n\n \nstruct vmci_transport {\n\t \n\tstruct vmci_handle dg_handle;\n\t \n\tstruct vmci_handle qp_handle;\n\tstruct vmci_qp *qpair;\n\tu64 produce_size;\n\tu64 consume_size;\n\tu32 detach_sub_id;\n\tunion vmci_transport_notify notify;\n\tconst struct vmci_transport_notify_ops *notify_ops;\n\tstruct list_head elem;\n\tstruct sock *sk;\n\tspinlock_t lock;  \n};\n\nint vmci_transport_send_wrote_bh(struct sockaddr_vm *dst,\n\t\t\t\t struct sockaddr_vm *src);\nint vmci_transport_send_read_bh(struct sockaddr_vm *dst,\n\t\t\t\tstruct sockaddr_vm *src);\nint vmci_transport_send_wrote(struct sock *sk);\nint vmci_transport_send_read(struct sock *sk);\nint vmci_transport_send_waiting_write(struct sock *sk,\n\t\t\t\t      struct vmci_transport_waiting_info *wait);\nint vmci_transport_send_waiting_read(struct sock *sk,\n\t\t\t\t     struct vmci_transport_waiting_info *wait);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}