{
  "module_name": "local_event.c",
  "hash_id": "1e08f2c19613fb13908769aa8891fa76e6a021ec64099dbecca09845e5391958",
  "original_prompt": "Ingested from linux-6.6.14/net/rxrpc/local_event.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/module.h>\n#include <linux/net.h>\n#include <linux/skbuff.h>\n#include <linux/slab.h>\n#include <net/sock.h>\n#include <net/af_rxrpc.h>\n#include <generated/utsrelease.h>\n#include \"ar-internal.h\"\n\nstatic char rxrpc_version_string[65]; \n\n \nvoid rxrpc_gen_version_string(void)\n{\n\tsnprintf(rxrpc_version_string, sizeof(rxrpc_version_string),\n\t\t \"linux-%.49s AF_RXRPC\", UTS_RELEASE);\n}\n\n \nvoid rxrpc_send_version_request(struct rxrpc_local *local,\n\t\t\t\tstruct rxrpc_host_header *hdr,\n\t\t\t\tstruct sk_buff *skb)\n{\n\tstruct rxrpc_wire_header whdr;\n\tstruct rxrpc_skb_priv *sp = rxrpc_skb(skb);\n\tstruct sockaddr_rxrpc srx;\n\tstruct msghdr msg;\n\tstruct kvec iov[2];\n\tsize_t len;\n\tint ret;\n\n\t_enter(\"\");\n\n\tif (rxrpc_extract_addr_from_skb(&srx, skb) < 0)\n\t\treturn;\n\n\tmsg.msg_name\t= &srx.transport;\n\tmsg.msg_namelen\t= srx.transport_len;\n\tmsg.msg_control\t= NULL;\n\tmsg.msg_controllen = 0;\n\tmsg.msg_flags\t= 0;\n\n\twhdr.epoch\t= htonl(sp->hdr.epoch);\n\twhdr.cid\t= htonl(sp->hdr.cid);\n\twhdr.callNumber\t= htonl(sp->hdr.callNumber);\n\twhdr.seq\t= 0;\n\twhdr.serial\t= 0;\n\twhdr.type\t= RXRPC_PACKET_TYPE_VERSION;\n\twhdr.flags\t= RXRPC_LAST_PACKET | (~hdr->flags & RXRPC_CLIENT_INITIATED);\n\twhdr.userStatus\t= 0;\n\twhdr.securityIndex = 0;\n\twhdr._rsvd\t= 0;\n\twhdr.serviceId\t= htons(sp->hdr.serviceId);\n\n\tiov[0].iov_base\t= &whdr;\n\tiov[0].iov_len\t= sizeof(whdr);\n\tiov[1].iov_base\t= (char *)rxrpc_version_string;\n\tiov[1].iov_len\t= sizeof(rxrpc_version_string);\n\n\tlen = iov[0].iov_len + iov[1].iov_len;\n\n\tret = kernel_sendmsg(local->socket, &msg, iov, 2, len);\n\tif (ret < 0)\n\t\ttrace_rxrpc_tx_fail(local->debug_id, 0, ret,\n\t\t\t\t    rxrpc_tx_point_version_reply);\n\telse\n\t\ttrace_rxrpc_tx_packet(local->debug_id, &whdr,\n\t\t\t\t      rxrpc_tx_point_version_reply);\n\n\t_leave(\"\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}