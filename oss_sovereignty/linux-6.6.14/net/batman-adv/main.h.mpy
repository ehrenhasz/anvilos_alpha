{
  "module_name": "main.h",
  "hash_id": "f4fc6373c8dab7b88b3fe30d7a2d39f2b575eb44e5c725c9c61e92d5ed90ffb3",
  "original_prompt": "Ingested from linux-6.6.14/net/batman-adv/main.h",
  "human_readable_source": " \n \n\n#ifndef _NET_BATMAN_ADV_MAIN_H_\n#define _NET_BATMAN_ADV_MAIN_H_\n\n#define BATADV_DRIVER_AUTHOR \"Marek Lindner <mareklindner@neomailbox.ch>, \" \\\n\t\t\t     \"Simon Wunderlich <sw@simonwunderlich.de>\"\n#define BATADV_DRIVER_DESC   \"B.A.T.M.A.N. advanced\"\n#define BATADV_DRIVER_DEVICE \"batman-adv\"\n\n#ifndef BATADV_SOURCE_VERSION\n#define BATADV_SOURCE_VERSION \"2023.3\"\n#endif\n\n \n\n#define BATADV_TQ_MAX_VALUE 255\n#define BATADV_THROUGHPUT_MAX_VALUE 0xFFFFFFFF\n#define BATADV_JITTER 20\n\n \n#define BATADV_TTL 50\n\n \n#define BATADV_BCAST_MAX_AGE 64\n\n \n#define BATADV_PURGE_TIMEOUT 200000  \n#define BATADV_TT_LOCAL_TIMEOUT 600000  \n#define BATADV_TT_CLIENT_ROAM_TIMEOUT 600000  \n#define BATADV_TT_CLIENT_TEMP_TIMEOUT 600000  \n#define BATADV_TT_WORK_PERIOD 5000  \n#define BATADV_ORIG_WORK_PERIOD 1000  \n#define BATADV_MCAST_WORK_PERIOD 500  \n#define BATADV_DAT_ENTRY_TIMEOUT (5 * 60000)  \n \n#define BATADV_TQ_LOCAL_WINDOW_SIZE 64\n \n#define BATADV_TT_REQUEST_TIMEOUT 3000\n\n#define BATADV_TQ_GLOBAL_WINDOW_SIZE 5\n#define BATADV_TQ_LOCAL_BIDRECT_SEND_MINIMUM 1\n#define BATADV_TQ_LOCAL_BIDRECT_RECV_MINIMUM 1\n#define BATADV_TQ_TOTAL_BIDRECT_LIMIT 1\n\n \n#define BATADV_THROUGHPUT_DEFAULT_VALUE 10  \n#define BATADV_ELP_PROBES_PER_NODE 2\n#define BATADV_ELP_MIN_PROBE_SIZE 200  \n#define BATADV_ELP_PROBE_MAX_TX_DIFF 100  \n#define BATADV_ELP_MAX_AGE 64\n#define BATADV_OGM_MAX_ORIGDIFF 5\n#define BATADV_OGM_MAX_AGE 64\n\n \n#define BATADV_TT_OGM_APPEND_MAX 3\n\n \n#define BATADV_ROAMING_MAX_TIME 20000\n#define BATADV_ROAMING_MAX_COUNT 5\n\n#define BATADV_NO_FLAGS 0\n\n#define BATADV_NULL_IFINDEX 0  \n\n#define BATADV_NO_MARK 0\n\n \n#define BATADV_IF_DEFAULT\t((struct batadv_hard_iface *)NULL)\n\n#define BATADV_NUM_WORDS BITS_TO_LONGS(BATADV_TQ_LOCAL_WINDOW_SIZE)\n\n#define BATADV_LOG_BUF_LEN 8192\t   \n\n \n#define BATADV_NUM_BCASTS_DEFAULT 1\n#define BATADV_NUM_BCASTS_WIRELESS 3\n\n \n#define BATADV_TP_PACKET_LEN ETH_DATA_LEN\n\n \n#define ARP_REQ_DELAY 250\n \n#define BATADV_DAT_CANDIDATES_NUM 3\n\n \n#define BATADV_TQ_SIMILARITY_THRESHOLD 50\n\n \n#define BATADV_MAX_AGGREGATION_BYTES 512\n#define BATADV_MAX_AGGREGATION_MS 100\n\n#define BATADV_BLA_PERIOD_LENGTH\t10000\t \n#define BATADV_BLA_BACKBONE_TIMEOUT\t(BATADV_BLA_PERIOD_LENGTH * 6)\n#define BATADV_BLA_CLAIM_TIMEOUT\t(BATADV_BLA_PERIOD_LENGTH * 10)\n#define BATADV_BLA_WAIT_PERIODS\t\t3\n#define BATADV_BLA_LOOPDETECT_PERIODS\t6\n#define BATADV_BLA_LOOPDETECT_TIMEOUT\t3000\t \n\n#define BATADV_DUPLIST_SIZE\t\t16\n#define BATADV_DUPLIST_TIMEOUT\t\t500\t \n \n#define BATADV_RESET_PROTECTION_MS 30000\n#define BATADV_EXPECTED_SEQNO_RANGE\t65536\n\n#define BATADV_NC_NODE_TIMEOUT 10000  \n\n \n#define BATADV_TP_MAX_NUM 5\n\n \nenum batadv_mesh_state {\n\t \n\tBATADV_MESH_INACTIVE,\n\n\t \n\tBATADV_MESH_ACTIVE,\n\n\t \n\tBATADV_MESH_DEACTIVATING,\n};\n\n#define BATADV_BCAST_QUEUE_LEN\t\t256\n#define BATADV_BATMAN_QUEUE_LEN\t256\n\n \nenum batadv_uev_action {\n\t \n\tBATADV_UEV_ADD = 0,\n\n\t \n\tBATADV_UEV_DEL,\n\n\t \n\tBATADV_UEV_CHANGE,\n\n\t \n\tBATADV_UEV_LOOPDETECT,\n};\n\n \nenum batadv_uev_type {\n\t \n\tBATADV_UEV_GW = 0,\n\n\t \n\tBATADV_UEV_BLA,\n};\n\n#define BATADV_GW_THRESHOLD\t50\n\n \n#define BATADV_FRAG_BUFFER_COUNT 8\n \n#define BATADV_FRAG_MAX_FRAGMENTS 16\n \n#define BATADV_FRAG_MAX_FRAG_SIZE 1280\n \n#define BATADV_FRAG_TIMEOUT 10000\n\n#define BATADV_DAT_CANDIDATE_NOT_FOUND\t0\n#define BATADV_DAT_CANDIDATE_ORIG\t1\n\n \n#ifdef pr_fmt\n#undef pr_fmt\n#endif\n \n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n \n\n#include <linux/atomic.h>\n#include <linux/compiler.h>\n#include <linux/etherdevice.h>\n#include <linux/if_vlan.h>\n#include <linux/jiffies.h>\n#include <linux/netdevice.h>\n#include <linux/percpu.h>\n#include <linux/skbuff.h>\n#include <linux/types.h>\n#include <uapi/linux/batadv_packet.h>\n\n#include \"types.h\"\n#include \"main.h\"\n\n \nstatic inline int batadv_print_vid(unsigned short vid)\n{\n\tif (vid & BATADV_VLAN_HAS_TAG)\n\t\treturn (int)(vid & VLAN_VID_MASK);\n\telse\n\t\treturn -1;\n}\n\nextern struct list_head batadv_hardif_list;\nextern unsigned int batadv_hardif_generation;\n\nextern unsigned char batadv_broadcast_addr[];\nextern struct workqueue_struct *batadv_event_workqueue;\n\nint batadv_mesh_init(struct net_device *soft_iface);\nvoid batadv_mesh_free(struct net_device *soft_iface);\nbool batadv_is_my_mac(struct batadv_priv *bat_priv, const u8 *addr);\nint batadv_max_header_len(void);\nvoid batadv_skb_set_priority(struct sk_buff *skb, int offset);\nint batadv_batman_skb_recv(struct sk_buff *skb, struct net_device *dev,\n\t\t\t   struct packet_type *ptype,\n\t\t\t   struct net_device *orig_dev);\nint\nbatadv_recv_handler_register(u8 packet_type,\n\t\t\t     int (*recv_handler)(struct sk_buff *,\n\t\t\t\t\t\t struct batadv_hard_iface *));\nvoid batadv_recv_handler_unregister(u8 packet_type);\n__be32 batadv_skb_crc32(struct sk_buff *skb, u8 *payload_ptr);\n\n \nstatic inline bool batadv_compare_eth(const void *data1, const void *data2)\n{\n\treturn ether_addr_equal_unaligned(data1, data2);\n}\n\n \nstatic inline bool batadv_has_timed_out(unsigned long timestamp,\n\t\t\t\t\tunsigned int timeout)\n{\n\treturn time_is_before_jiffies(timestamp + msecs_to_jiffies(timeout));\n}\n\n \n#define batadv_atomic_dec_not_zero(v)\tatomic_add_unless((v), -1, 0)\n\n \n#define batadv_smallest_signed_int(x) (1u << (7u + 8u * (sizeof(x) - 1u)))\n\n \n#define batadv_seq_before(x, y) ({ \\\n\ttypeof(x)_d1 = (x); \\\n\ttypeof(y)_d2 = (y); \\\n\ttypeof(x)_dummy = (_d1 - _d2); \\\n\t(void)(&_d1 == &_d2); \\\n\t_dummy > batadv_smallest_signed_int(_dummy); \\\n})\n\n \n#define batadv_seq_after(x, y) batadv_seq_before(y, x)\n\n \nstatic inline void batadv_add_counter(struct batadv_priv *bat_priv, size_t idx,\n\t\t\t\t      size_t count)\n{\n\tthis_cpu_add(bat_priv->bat_counters[idx], count);\n}\n\n \n#define batadv_inc_counter(b, i) batadv_add_counter(b, i, 1)\n\n \n#define BATADV_SKB_CB(__skb)       ((struct batadv_skb_cb *)&((__skb)->cb[0]))\n\nunsigned short batadv_get_vid(struct sk_buff *skb, size_t header_len);\nbool batadv_vlan_ap_isola_get(struct batadv_priv *bat_priv, unsigned short vid);\nint batadv_throw_uevent(struct batadv_priv *bat_priv, enum batadv_uev_type type,\n\t\t\tenum batadv_uev_action action, const char *data);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}