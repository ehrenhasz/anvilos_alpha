{
  "module_name": "types.h",
  "hash_id": "9979d9622e3401b3719b5129b722a1c4885eefe17fb01258b52a95389dc5cd93",
  "original_prompt": "Ingested from linux-6.6.14/net/batman-adv/types.h",
  "human_readable_source": " \n \n\n#ifndef _NET_BATMAN_ADV_TYPES_H_\n#define _NET_BATMAN_ADV_TYPES_H_\n\n#ifndef _NET_BATMAN_ADV_MAIN_H_\n#error only \"main.h\" can be included directly\n#endif\n\n#include <linux/average.h>\n#include <linux/bitops.h>\n#include <linux/compiler.h>\n#include <linux/if.h>\n#include <linux/if_ether.h>\n#include <linux/kref.h>\n#include <linux/mutex.h>\n#include <linux/netdevice.h>\n#include <linux/netlink.h>\n#include <linux/sched.h>  \n#include <linux/skbuff.h>\n#include <linux/spinlock.h>\n#include <linux/timer.h>\n#include <linux/types.h>\n#include <linux/wait.h>\n#include <linux/workqueue.h>\n#include <uapi/linux/batadv_packet.h>\n#include <uapi/linux/batman_adv.h>\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\n \ntypedef u16 batadv_dat_addr_t;\n\n#endif  \n\n \nenum batadv_dhcp_recipient {\n\t \n\tBATADV_DHCP_NO = 0,\n\n\t \n\tBATADV_DHCP_TO_SERVER,\n\n\t \n\tBATADV_DHCP_TO_CLIENT,\n};\n\n \n#define BATADV_TT_REMOTE_MASK\t0x00FF\n\n \n#define BATADV_TT_SYNC_MASK\t0x00F0\n\n \nstruct batadv_hard_iface_bat_iv {\n\t \n\tunsigned char *ogm_buff;\n\n\t \n\tint ogm_buff_len;\n\n\t \n\tatomic_t ogm_seqno;\n\n\t \n\tstruct mutex ogm_buff_mutex;\n};\n\n \nenum batadv_v_hard_iface_flags {\n\t \n\tBATADV_FULL_DUPLEX\t= BIT(0),\n\n\t \n\tBATADV_WARNING_DEFAULT\t= BIT(1),\n};\n\n \nstruct batadv_hard_iface_bat_v {\n\t \n\tatomic_t elp_interval;\n\n\t \n\tatomic_t elp_seqno;\n\n\t \n\tstruct sk_buff *elp_skb;\n\n\t \n\tstruct delayed_work elp_wq;\n\n\t \n\tstruct delayed_work aggr_wq;\n\n\t \n\tstruct sk_buff_head aggr_list;\n\n\t \n\tunsigned int aggr_len;\n\n\t \n\tatomic_t throughput_override;\n\n\t \n\tu8 flags;\n};\n\n \nenum batadv_hard_iface_wifi_flags {\n\t \n\tBATADV_HARDIF_WIFI_WEXT_DIRECT = BIT(0),\n\n\t \n\tBATADV_HARDIF_WIFI_CFG80211_DIRECT = BIT(1),\n\n\t \n\tBATADV_HARDIF_WIFI_WEXT_INDIRECT = BIT(2),\n\n\t \n\tBATADV_HARDIF_WIFI_CFG80211_INDIRECT = BIT(3),\n};\n\n \nstruct batadv_hard_iface {\n\t \n\tstruct list_head list;\n\n\t \n\tchar if_status;\n\n\t \n\tu8 num_bcasts;\n\n\t \n\tu32 wifi_flags;\n\n\t \n\tstruct net_device *net_dev;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct packet_type batman_adv_ptype;\n\n\t \n\tstruct net_device *soft_iface;\n\n\t \n\tstruct rcu_head rcu;\n\n\t \n\tatomic_t hop_penalty;\n\n\t \n\tstruct batadv_hard_iface_bat_iv bat_iv;\n\n#ifdef CONFIG_BATMAN_ADV_BATMAN_V\n\t \n\tstruct batadv_hard_iface_bat_v bat_v;\n#endif\n\n\t \n\tstruct hlist_head neigh_list;\n\n\t \n\tspinlock_t neigh_list_lock;\n};\n\n \nstruct batadv_orig_ifinfo_bat_iv {\n\t \n\tDECLARE_BITMAP(bcast_own, BATADV_TQ_LOCAL_WINDOW_SIZE);\n\n\t \n\tu8 bcast_own_sum;\n};\n\n \nstruct batadv_orig_ifinfo {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct batadv_hard_iface *if_outgoing;\n\n\t \n\tstruct batadv_neigh_node __rcu *router;\n\n\t \n\tu32 last_real_seqno;\n\n\t \n\tu8 last_ttl;\n\n\t \n\tu32 last_seqno_forwarded;\n\n\t \n\tunsigned long batman_seqno_reset;\n\n\t \n\tstruct batadv_orig_ifinfo_bat_iv bat_iv;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_frag_table_entry {\n\t \n\tstruct hlist_head fragment_list;\n\n\t \n\tspinlock_t lock;\n\n\t \n\tunsigned long timestamp;\n\n\t \n\tu16 seqno;\n\n\t \n\tu16 size;\n\n\t \n\tu16 total_size;\n};\n\n \nstruct batadv_frag_list_entry {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct sk_buff *skb;\n\n\t \n\tu8 no;\n};\n\n \nstruct batadv_vlan_tt {\n\t \n\tu32 crc;\n\n\t \n\tatomic_t num_entries;\n};\n\n \nstruct batadv_orig_node_vlan {\n\t \n\tunsigned short vid;\n\n\t \n\tstruct batadv_vlan_tt tt;\n\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_orig_bat_iv {\n\t \n\tspinlock_t ogm_cnt_lock;\n};\n\n \nstruct batadv_orig_node {\n\t \n\tu8 orig[ETH_ALEN];\n\n\t \n\tstruct hlist_head ifinfo_list;\n\n\t \n\tstruct batadv_orig_ifinfo *last_bonding_candidate;\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\t \n\tbatadv_dat_addr_t dat_addr;\n#endif\n\n\t \n\tunsigned long last_seen;\n\n\t \n\tunsigned long bcast_seqno_reset;\n\n#ifdef CONFIG_BATMAN_ADV_MCAST\n\t \n\tspinlock_t mcast_handler_lock;\n\n\t \n\tu8 mcast_flags;\n\n\t \n\tstruct hlist_node mcast_want_all_unsnoopables_node;\n\n\t \n\tstruct hlist_node mcast_want_all_ipv4_node;\n\t \n\tstruct hlist_node mcast_want_all_ipv6_node;\n\n\t \n\tstruct hlist_node mcast_want_all_rtr4_node;\n\t \n\tstruct hlist_node mcast_want_all_rtr6_node;\n#endif\n\n\t \n\tunsigned long capabilities;\n\n\t \n\tunsigned long capa_initialized;\n\n\t \n\tatomic_t last_ttvn;\n\n\t \n\tunsigned char *tt_buff;\n\n\t \n\ts16 tt_buff_len;\n\n\t \n\tspinlock_t tt_buff_lock;\n\n\t \n\tspinlock_t tt_lock;\n\n\t \n\tDECLARE_BITMAP(bcast_bits, BATADV_TQ_LOCAL_WINDOW_SIZE);\n\n\t \n\tu32 last_bcast_seqno;\n\n\t \n\tstruct hlist_head neigh_list;\n\n\t \n\tspinlock_t neigh_list_lock;\n\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tstruct batadv_priv *bat_priv;\n\n\t \n\tspinlock_t bcast_seqno_lock;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n\n#ifdef CONFIG_BATMAN_ADV_NC\n\t \n\tstruct list_head in_coding_list;\n\n\t \n\tstruct list_head out_coding_list;\n\n\t \n\tspinlock_t in_coding_list_lock;\n\n\t \n\tspinlock_t out_coding_list_lock;\n#endif\n\n\t \n\tstruct batadv_frag_table_entry fragments[BATADV_FRAG_BUFFER_COUNT];\n\n\t \n\tstruct hlist_head vlan_list;\n\n\t \n\tspinlock_t vlan_list_lock;\n\n\t \n\tstruct batadv_orig_bat_iv bat_iv;\n};\n\n \nenum batadv_orig_capabilities {\n\t \n\tBATADV_ORIG_CAPA_HAS_DAT,\n\n\t \n\tBATADV_ORIG_CAPA_HAS_NC,\n\n\t \n\tBATADV_ORIG_CAPA_HAS_TT,\n\n\t \n\tBATADV_ORIG_CAPA_HAS_MCAST,\n};\n\n \nstruct batadv_gw_node {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct batadv_orig_node *orig_node;\n\n\t \n\tu32 bandwidth_down;\n\n\t \n\tu32 bandwidth_up;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\nDECLARE_EWMA(throughput, 10, 8)\n\n \nstruct batadv_hardif_neigh_node_bat_v {\n\t \n\tstruct ewma_throughput throughput;\n\n\t \n\tu32 elp_interval;\n\n\t \n\tu32 elp_latest_seqno;\n\n\t \n\tunsigned long last_unicast_tx;\n\n\t \n\tstruct work_struct metric_work;\n};\n\n \nstruct batadv_hardif_neigh_node {\n\t \n\tstruct hlist_node list;\n\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tu8 orig[ETH_ALEN];\n\n\t \n\tstruct batadv_hard_iface *if_incoming;\n\n\t \n\tunsigned long last_seen;\n\n#ifdef CONFIG_BATMAN_ADV_BATMAN_V\n\t \n\tstruct batadv_hardif_neigh_node_bat_v bat_v;\n#endif\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_neigh_node {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct batadv_orig_node *orig_node;\n\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tstruct hlist_head ifinfo_list;\n\n\t \n\tspinlock_t ifinfo_lock;\n\n\t \n\tstruct batadv_hard_iface *if_incoming;\n\n\t \n\tunsigned long last_seen;\n\n\t \n\tstruct batadv_hardif_neigh_node *hardif_neigh;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_neigh_ifinfo_bat_iv {\n\t \n\tu8 tq_recv[BATADV_TQ_GLOBAL_WINDOW_SIZE];\n\n\t \n\tu8 tq_index;\n\n\t \n\tu8 tq_avg;\n\n\t \n\tDECLARE_BITMAP(real_bits, BATADV_TQ_LOCAL_WINDOW_SIZE);\n\n\t \n\tu8 real_packet_count;\n};\n\n \nstruct batadv_neigh_ifinfo_bat_v {\n\t \n\tu32 throughput;\n\n\t \n\tu32 last_seqno;\n};\n\n \nstruct batadv_neigh_ifinfo {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct batadv_hard_iface *if_outgoing;\n\n\t \n\tstruct batadv_neigh_ifinfo_bat_iv bat_iv;\n\n#ifdef CONFIG_BATMAN_ADV_BATMAN_V\n\t \n\tstruct batadv_neigh_ifinfo_bat_v bat_v;\n#endif\n\n\t \n\tu8 last_ttl;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n#ifdef CONFIG_BATMAN_ADV_BLA\n\n \nstruct batadv_bcast_duplist_entry {\n\t \n\tu8 orig[ETH_ALEN];\n\n\t \n\t__be32 crc;\n\n\t \n\tunsigned long entrytime;\n};\n#endif\n\n \nenum batadv_counters {\n\t \n\tBATADV_CNT_TX,\n\n\t \n\tBATADV_CNT_TX_BYTES,\n\n\t \n\tBATADV_CNT_TX_DROPPED,\n\n\t \n\tBATADV_CNT_RX,\n\n\t \n\tBATADV_CNT_RX_BYTES,\n\n\t \n\tBATADV_CNT_FORWARD,\n\n\t \n\tBATADV_CNT_FORWARD_BYTES,\n\n\t \n\tBATADV_CNT_MGMT_TX,\n\n\t \n\tBATADV_CNT_MGMT_TX_BYTES,\n\n\t \n\tBATADV_CNT_MGMT_RX,\n\n\t \n\tBATADV_CNT_MGMT_RX_BYTES,\n\n\t \n\tBATADV_CNT_FRAG_TX,\n\n\t \n\tBATADV_CNT_FRAG_TX_BYTES,\n\n\t \n\tBATADV_CNT_FRAG_RX,\n\n\t \n\tBATADV_CNT_FRAG_RX_BYTES,\n\n\t \n\tBATADV_CNT_FRAG_FWD,\n\n\t \n\tBATADV_CNT_FRAG_FWD_BYTES,\n\n\t \n\tBATADV_CNT_TT_REQUEST_TX,\n\n\t \n\tBATADV_CNT_TT_REQUEST_RX,\n\n\t \n\tBATADV_CNT_TT_RESPONSE_TX,\n\n\t \n\tBATADV_CNT_TT_RESPONSE_RX,\n\n\t \n\tBATADV_CNT_TT_ROAM_ADV_TX,\n\n\t \n\tBATADV_CNT_TT_ROAM_ADV_RX,\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\t \n\tBATADV_CNT_DAT_GET_TX,\n\n\t \n\tBATADV_CNT_DAT_GET_RX,\n\n\t \n\tBATADV_CNT_DAT_PUT_TX,\n\n\t \n\tBATADV_CNT_DAT_PUT_RX,\n\n\t \n\tBATADV_CNT_DAT_CACHED_REPLY_TX,\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_NC\n\t \n\tBATADV_CNT_NC_CODE,\n\n\t \n\tBATADV_CNT_NC_CODE_BYTES,\n\n\t \n\tBATADV_CNT_NC_RECODE,\n\n\t \n\tBATADV_CNT_NC_RECODE_BYTES,\n\n\t \n\tBATADV_CNT_NC_BUFFER,\n\n\t \n\tBATADV_CNT_NC_DECODE,\n\n\t \n\tBATADV_CNT_NC_DECODE_BYTES,\n\n\t \n\tBATADV_CNT_NC_DECODE_FAILED,\n\n\t \n\tBATADV_CNT_NC_SNIFFED,\n#endif\n\n\t \n\tBATADV_CNT_NUM,\n};\n\n \nstruct batadv_priv_tt {\n\t \n\tatomic_t vn;\n\n\t \n\tatomic_t ogm_append_cnt;\n\n\t \n\tatomic_t local_changes;\n\n\t \n\tstruct list_head changes_list;\n\n\t \n\tstruct batadv_hashtable *local_hash;\n\n\t \n\tstruct batadv_hashtable *global_hash;\n\n\t \n\tstruct hlist_head req_list;\n\n\t \n\tstruct list_head roam_list;\n\n\t \n\tspinlock_t changes_list_lock;\n\n\t \n\tspinlock_t req_list_lock;\n\n\t \n\tspinlock_t roam_list_lock;\n\n\t \n\tunsigned char *last_changeset;\n\n\t \n\ts16 last_changeset_len;\n\n\t \n\tspinlock_t last_changeset_lock;\n\n\t \n\tspinlock_t commit_lock;\n\n\t \n\tstruct delayed_work work;\n};\n\n#ifdef CONFIG_BATMAN_ADV_BLA\n\n \nstruct batadv_priv_bla {\n\t \n\tatomic_t num_requests;\n\n\t \n\tstruct batadv_hashtable *claim_hash;\n\n\t \n\tstruct batadv_hashtable *backbone_hash;\n\n\t \n\tu8 loopdetect_addr[ETH_ALEN];\n\n\t \n\tunsigned long loopdetect_lasttime;\n\n\t \n\tatomic_t loopdetect_next;\n\n\t \n\tstruct batadv_bcast_duplist_entry bcast_duplist[BATADV_DUPLIST_SIZE];\n\n\t \n\tint bcast_duplist_curr;\n\n\t \n\tspinlock_t bcast_duplist_lock;\n\n\t \n\tstruct batadv_bla_claim_dst claim_dest;\n\n\t \n\tstruct delayed_work work;\n};\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_DEBUG\n\n \nstruct batadv_priv_debug_log {\n\t \n\tchar log_buff[BATADV_LOG_BUF_LEN];\n\n\t \n\tunsigned long log_start;\n\n\t \n\tunsigned long log_end;\n\n\t \n\tspinlock_t lock;\n\n\t \n\twait_queue_head_t queue_wait;\n};\n#endif\n\n \nstruct batadv_priv_gw {\n\t \n\tstruct hlist_head gateway_list;\n\n\t \n\tspinlock_t list_lock;\n\n\t \n\tstruct batadv_gw_node __rcu *curr_gw;\n\n\t \n\tunsigned int generation;\n\n\t \n\tatomic_t mode;\n\n\t \n\tatomic_t sel_class;\n\n\t \n\tatomic_t bandwidth_down;\n\n\t \n\tatomic_t bandwidth_up;\n\n\t \n\tatomic_t reselect;\n};\n\n \nstruct batadv_priv_tvlv {\n\t \n\tstruct hlist_head container_list;\n\n\t \n\tstruct hlist_head handler_list;\n\n\t \n\tspinlock_t container_list_lock;\n\n\t \n\tspinlock_t handler_list_lock;\n};\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\n \nstruct batadv_priv_dat {\n\t \n\tbatadv_dat_addr_t addr;\n\n\t \n\tstruct batadv_hashtable *hash;\n\n\t \n\tstruct delayed_work work;\n};\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_MCAST\n \nstruct batadv_mcast_querier_state {\n\t \n\tunsigned char exists:1;\n\n\t \n\tunsigned char shadowing:1;\n};\n\n \nstruct batadv_mcast_mla_flags {\n\t \n\tstruct batadv_mcast_querier_state querier_ipv4;\n\n\t \n\tstruct batadv_mcast_querier_state querier_ipv6;\n\n\t \n\tunsigned char enabled:1;\n\n\t \n\tunsigned char bridged:1;\n\n\t \n\tu8 tvlv_flags;\n};\n\n \nstruct batadv_priv_mcast {\n\t \n\tstruct hlist_head mla_list;  \n\n\t \n\tstruct hlist_head want_all_unsnoopables_list;\n\n\t \n\tstruct hlist_head want_all_ipv4_list;\n\n\t \n\tstruct hlist_head want_all_ipv6_list;\n\n\t \n\tstruct hlist_head want_all_rtr4_list;\n\n\t \n\tstruct hlist_head want_all_rtr6_list;\n\n\t \n\tstruct batadv_mcast_mla_flags mla_flags;\n\n\t \n\tspinlock_t mla_lock;\n\n\t \n\tatomic_t num_want_all_unsnoopables;\n\n\t \n\tatomic_t num_want_all_ipv4;\n\n\t \n\tatomic_t num_want_all_ipv6;\n\n\t \n\tatomic_t num_want_all_rtr4;\n\n\t \n\tatomic_t num_want_all_rtr6;\n\n\t \n\tspinlock_t want_lists_lock;\n\n\t \n\tstruct delayed_work work;\n};\n#endif\n\n \nstruct batadv_priv_nc {\n\t \n\tstruct delayed_work work;\n\n\t \n\tu8 min_tq;\n\n\t \n\tu32 max_fwd_delay;\n\n\t \n\tu32 max_buffer_time;\n\n\t \n\tunsigned long timestamp_fwd_flush;\n\n\t \n\tunsigned long timestamp_sniffed_purge;\n\n\t \n\tstruct batadv_hashtable *coding_hash;\n\n\t \n\tstruct batadv_hashtable *decoding_hash;\n};\n\n \nstruct batadv_tp_unacked {\n\t \n\tu32 seqno;\n\n\t \n\tu16 len;\n\n\t \n\tstruct list_head list;\n};\n\n \nenum batadv_tp_meter_role {\n\t \n\tBATADV_TP_RECEIVER,\n\n\t \n\tBATADV_TP_SENDER\n};\n\n \nstruct batadv_tp_vars {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct timer_list timer;\n\n\t \n\tstruct batadv_priv *bat_priv;\n\n\t \n\tunsigned long start_time;\n\n\t \n\tu8 other_end[ETH_ALEN];\n\n\t \n\tenum batadv_tp_meter_role role;\n\n\t \n\tatomic_t sending;\n\n\t \n\tenum batadv_tp_meter_reason reason;\n\n\t \n\tstruct delayed_work finish_work;\n\n\t \n\tu32 test_length;\n\n\t \n\tu8 session[2];\n\n\t \n\tu8 icmp_uid;\n\n\t \n\n\t \n\tu16 dec_cwnd;\n\n\t \n\tu32 cwnd;\n\n\t \n\tspinlock_t cwnd_lock;\n\n\t \n\tu32 ss_threshold;\n\n\t \n\tatomic_t last_acked;\n\n\t \n\tu32 last_sent;\n\n\t \n\tatomic64_t tot_sent;\n\n\t \n\tatomic_t dup_acks;\n\n\t \n\tunsigned char fast_recovery:1;\n\n\t \n\tu32 recover;\n\n\t \n\tu32 rto;\n\n\t \n\tu32 srtt;\n\n\t \n\tu32 rttvar;\n\n\t \n\twait_queue_head_t more_bytes;\n\n\t \n\tu32 prerandom_offset;\n\n\t \n\tspinlock_t prerandom_lock;\n\n\t \n\n\t \n\tu32 last_recv;\n\n\t \n\tstruct list_head unacked_list;\n\n\t \n\tspinlock_t unacked_lock;\n\n\t \n\tunsigned long last_recv_time;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_softif_vlan {\n\t \n\tstruct batadv_priv *bat_priv;\n\n\t \n\tunsigned short vid;\n\n\t \n\tatomic_t ap_isolation;\t\t \n\n\t \n\tstruct batadv_vlan_tt tt;\n\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_priv_bat_v {\n\t \n\tunsigned char *ogm_buff;\n\n\t \n\tint ogm_buff_len;\n\n\t \n\tatomic_t ogm_seqno;\n\n\t \n\tstruct mutex ogm_buff_mutex;\n\n\t \n\tstruct delayed_work ogm_wq;\n};\n\n \nstruct batadv_priv {\n\t \n\tatomic_t mesh_state;\n\n\t \n\tstruct net_device *soft_iface;\n\n\t \n\tint mtu_set_by_user;\n\n\t \n\tu64 __percpu *bat_counters;  \n\n\t \n\tatomic_t aggregated_ogms;\n\n\t \n\tatomic_t bonding;\n\n\t \n\tatomic_t fragmentation;\n\n\t \n\tatomic_t packet_size_max;\n\n\t \n\tatomic_t frag_seqno;\n\n#ifdef CONFIG_BATMAN_ADV_BLA\n\t \n\tatomic_t bridge_loop_avoidance;\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\t \n\tatomic_t distributed_arp_table;\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_MCAST\n\t \n\tatomic_t multicast_mode;\n\n\t \n\tatomic_t multicast_fanout;\n#endif\n\n\t \n\tatomic_t orig_interval;\n\n\t \n\tatomic_t hop_penalty;\n\n#ifdef CONFIG_BATMAN_ADV_DEBUG\n\t \n\tatomic_t log_level;\n#endif\n\n\t \n\tu32 isolation_mark;\n\n\t \n\tu32 isolation_mark_mask;\n\n\t \n\tatomic_t bcast_seqno;\n\n\t \n\tatomic_t bcast_queue_left;\n\n\t \n\tatomic_t batman_queue_left;\n\n\t \n\tstruct hlist_head forw_bat_list;\n\n\t \n\tstruct hlist_head forw_bcast_list;\n\n\t \n\tstruct hlist_head tp_list;\n\n\t \n\tstruct batadv_hashtable *orig_hash;\n\n\t \n\tspinlock_t forw_bat_list_lock;\n\n\t \n\tspinlock_t forw_bcast_list_lock;\n\n\t \n\tspinlock_t tp_list_lock;\n\n\t \n\tatomic_t tp_num;\n\n\t \n\tstruct delayed_work orig_work;\n\n\t \n\tstruct batadv_hard_iface __rcu *primary_if;   \n\n\t \n\tstruct batadv_algo_ops *algo_ops;\n\n\t \n\tstruct hlist_head softif_vlan_list;\n\n\t \n\tspinlock_t softif_vlan_list_lock;\n\n#ifdef CONFIG_BATMAN_ADV_BLA\n\t \n\tstruct batadv_priv_bla bla;\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_DEBUG\n\t \n\tstruct batadv_priv_debug_log *debug_log;\n#endif\n\n\t \n\tstruct batadv_priv_gw gw;\n\n\t \n\tstruct batadv_priv_tt tt;\n\n\t \n\tstruct batadv_priv_tvlv tvlv;\n\n#ifdef CONFIG_BATMAN_ADV_DAT\n\t \n\tstruct batadv_priv_dat dat;\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_MCAST\n\t \n\tstruct batadv_priv_mcast mcast;\n#endif\n\n#ifdef CONFIG_BATMAN_ADV_NC\n\t \n\tatomic_t network_coding;\n\n\t \n\tstruct batadv_priv_nc nc;\n#endif  \n\n#ifdef CONFIG_BATMAN_ADV_BATMAN_V\n\t \n\tstruct batadv_priv_bat_v bat_v;\n#endif\n};\n\n#ifdef CONFIG_BATMAN_ADV_BLA\n\n \nstruct batadv_bla_backbone_gw {\n\t \n\tu8 orig[ETH_ALEN];\n\n\t \n\tunsigned short vid;\n\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tstruct batadv_priv *bat_priv;\n\n\t \n\tunsigned long lasttime;\n\n\t \n\tatomic_t wait_periods;\n\n\t \n\tatomic_t request_sent;\n\n\t \n\tu16 crc;\n\n\t \n\tspinlock_t crc_lock;\n\n\t \n\tstruct work_struct report_work;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_bla_claim {\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tunsigned short vid;\n\n\t \n\tstruct batadv_bla_backbone_gw *backbone_gw;\n\n\t \n\tspinlock_t backbone_lock;\n\n\t \n\tunsigned long lasttime;\n\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tstruct rcu_head rcu;\n\n\t \n\tstruct kref refcount;\n};\n#endif\n\n \nstruct batadv_tt_common_entry {\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tunsigned short vid;\n\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tu16 flags;\n\n\t \n\tunsigned long added_at;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_tt_local_entry {\n\t \n\tstruct batadv_tt_common_entry common;\n\n\t \n\tunsigned long last_seen;\n\n\t \n\tstruct batadv_softif_vlan *vlan;\n};\n\n \nstruct batadv_tt_global_entry {\n\t \n\tstruct batadv_tt_common_entry common;\n\n\t \n\tstruct hlist_head orig_list;\n\n\t \n\tatomic_t orig_list_count;\n\n\t \n\tspinlock_t list_lock;\n\n\t \n\tunsigned long roam_at;\n};\n\n \nstruct batadv_tt_orig_list_entry {\n\t \n\tstruct batadv_orig_node *orig_node;\n\n\t \n\tu8 ttvn;\n\n\t \n\tu8 flags;\n\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_tt_change_node {\n\t \n\tstruct list_head list;\n\n\t \n\tstruct batadv_tvlv_tt_change change;\n};\n\n \nstruct batadv_tt_req_node {\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tunsigned long issued_at;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct hlist_node list;\n};\n\n \nstruct batadv_tt_roam_node {\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tatomic_t counter;\n\n\t \n\tunsigned long first_time;\n\n\t \n\tstruct list_head list;\n};\n\n \nstruct batadv_nc_node {\n\t \n\tstruct list_head list;\n\n\t \n\tu8 addr[ETH_ALEN];\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n\n\t \n\tstruct batadv_orig_node *orig_node;\n\n\t \n\tunsigned long last_seen;\n};\n\n \nstruct batadv_nc_path {\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tstruct rcu_head rcu;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct list_head packet_list;\n\n\t \n\tspinlock_t packet_list_lock;\n\n\t \n\tu8 next_hop[ETH_ALEN];\n\n\t \n\tu8 prev_hop[ETH_ALEN];\n\n\t \n\tunsigned long last_valid;\n};\n\n \nstruct batadv_nc_packet {\n\t \n\tstruct list_head list;\n\n\t \n\t__be32 packet_id;\n\n\t \n\tunsigned long timestamp;\n\n\t \n\tstruct batadv_neigh_node *neigh_node;\n\n\t \n\tstruct sk_buff *skb;\n\n\t \n\tstruct batadv_nc_path *nc_path;\n};\n\n \nstruct batadv_skb_cb {\n\t \n\tunsigned char decoded:1;\n\n\t \n\tunsigned char num_bcasts;\n};\n\n \nstruct batadv_forw_packet {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct hlist_node cleanup_list;\n\n\t \n\tunsigned long send_time;\n\n\t \n\tu8 own;\n\n\t \n\tstruct sk_buff *skb;\n\n\t \n\tu16 packet_len;\n\n\t \n\tu32 direct_link_flags;\n\n\t \n\tu8 num_packets;\n\n\t \n\tstruct delayed_work delayed_work;\n\n\t \n\tstruct batadv_hard_iface *if_incoming;\n\n\t \n\tstruct batadv_hard_iface *if_outgoing;\n\n\t \n\tatomic_t *queue_left;\n};\n\n \nstruct batadv_algo_iface_ops {\n\t \n\tvoid (*activate)(struct batadv_hard_iface *hard_iface);\n\n\t \n\tint (*enable)(struct batadv_hard_iface *hard_iface);\n\n\t \n\tvoid (*enabled)(struct batadv_hard_iface *hard_iface);\n\n\t \n\tvoid (*disable)(struct batadv_hard_iface *hard_iface);\n\n\t \n\tvoid (*update_mac)(struct batadv_hard_iface *hard_iface);\n\n\t \n\tvoid (*primary_set)(struct batadv_hard_iface *hard_iface);\n};\n\n \nstruct batadv_algo_neigh_ops {\n\t \n\tvoid (*hardif_init)(struct batadv_hardif_neigh_node *neigh);\n\n\t \n\tint (*cmp)(struct batadv_neigh_node *neigh1,\n\t\t   struct batadv_hard_iface *if_outgoing1,\n\t\t   struct batadv_neigh_node *neigh2,\n\t\t   struct batadv_hard_iface *if_outgoing2);\n\n\t \n\tbool (*is_similar_or_better)(struct batadv_neigh_node *neigh1,\n\t\t\t\t     struct batadv_hard_iface *if_outgoing1,\n\t\t\t\t     struct batadv_neigh_node *neigh2,\n\t\t\t\t     struct batadv_hard_iface *if_outgoing2);\n\n\t \n\tvoid (*dump)(struct sk_buff *msg, struct netlink_callback *cb,\n\t\t     struct batadv_priv *priv,\n\t\t     struct batadv_hard_iface *hard_iface);\n};\n\n \nstruct batadv_algo_orig_ops {\n\t \n\tvoid (*dump)(struct sk_buff *msg, struct netlink_callback *cb,\n\t\t     struct batadv_priv *priv,\n\t\t     struct batadv_hard_iface *hard_iface);\n};\n\n \nstruct batadv_algo_gw_ops {\n\t \n\tvoid (*init_sel_class)(struct batadv_priv *bat_priv);\n\n\t \n\tu32 sel_class_max;\n\n\t \n\tstruct batadv_gw_node *(*get_best_gw_node)\n\t\t(struct batadv_priv *bat_priv);\n\n\t \n\tbool (*is_eligible)(struct batadv_priv *bat_priv,\n\t\t\t    struct batadv_orig_node *curr_gw_orig,\n\t\t\t    struct batadv_orig_node *orig_node);\n\n\t \n\tvoid (*dump)(struct sk_buff *msg, struct netlink_callback *cb,\n\t\t     struct batadv_priv *priv);\n};\n\n \nstruct batadv_algo_ops {\n\t \n\tstruct hlist_node list;\n\n\t \n\tchar *name;\n\n\t \n\tstruct batadv_algo_iface_ops iface;\n\n\t \n\tstruct batadv_algo_neigh_ops neigh;\n\n\t \n\tstruct batadv_algo_orig_ops orig;\n\n\t \n\tstruct batadv_algo_gw_ops gw;\n};\n\n \nstruct batadv_dat_entry {\n\t \n\t__be32 ip;\n\n\t \n\tu8 mac_addr[ETH_ALEN];\n\n\t \n\tunsigned short vid;\n\n\t \n\tunsigned long last_update;\n\n\t \n\tstruct hlist_node hash_entry;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nstruct batadv_hw_addr {\n\t \n\tstruct hlist_node list;\n\n\t \n\tunsigned char addr[ETH_ALEN];\n};\n\n \nstruct batadv_dat_candidate {\n\t \n\tint type;\n\n\t \n\tstruct batadv_orig_node *orig_node;\n};\n\n \nstruct batadv_tvlv_container {\n\t \n\tstruct hlist_node list;\n\n\t \n\tstruct batadv_tvlv_hdr tvlv_hdr;\n\n\t \n\tstruct kref refcount;\n};\n\n \nstruct batadv_tvlv_handler {\n\t \n\tstruct hlist_node list;\n\n\t \n\tvoid (*ogm_handler)(struct batadv_priv *bat_priv,\n\t\t\t    struct batadv_orig_node *orig,\n\t\t\t    u8 flags, void *tvlv_value, u16 tvlv_value_len);\n\n\t \n\tint (*unicast_handler)(struct batadv_priv *bat_priv,\n\t\t\t       u8 *src, u8 *dst,\n\t\t\t       void *tvlv_value, u16 tvlv_value_len);\n\n\t \n\tint (*mcast_handler)(struct batadv_priv *bat_priv, struct sk_buff *skb);\n\n\t \n\tu8 type;\n\n\t \n\tu8 version;\n\n\t \n\tu8 flags;\n\n\t \n\tstruct kref refcount;\n\n\t \n\tstruct rcu_head rcu;\n};\n\n \nenum batadv_tvlv_handler_flags {\n\t \n\tBATADV_TVLV_HANDLER_OGM_CIFNOTFND = BIT(1),\n\n\t \n\tBATADV_TVLV_HANDLER_OGM_CALLED = BIT(2),\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}