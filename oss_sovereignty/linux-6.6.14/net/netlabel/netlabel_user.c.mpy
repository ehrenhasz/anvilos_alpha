{
  "module_name": "netlabel_user.c",
  "hash_id": "d9dbc4bddbfba679da9a7b11527843c686f08c57cdc99a8e8559ae321109858f",
  "original_prompt": "Ingested from linux-6.6.14/net/netlabel/netlabel_user.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/list.h>\n#include <linux/socket.h>\n#include <linux/audit.h>\n#include <linux/tty.h>\n#include <linux/security.h>\n#include <linux/gfp.h>\n#include <net/sock.h>\n#include <net/netlink.h>\n#include <net/genetlink.h>\n#include <net/netlabel.h>\n#include <asm/bug.h>\n\n#include \"netlabel_mgmt.h\"\n#include \"netlabel_unlabeled.h\"\n#include \"netlabel_cipso_v4.h\"\n#include \"netlabel_calipso.h\"\n#include \"netlabel_user.h\"\n\n \n\n \nint __init netlbl_netlink_init(void)\n{\n\tint ret_val;\n\n\tret_val = netlbl_mgmt_genl_init();\n\tif (ret_val != 0)\n\t\treturn ret_val;\n\n\tret_val = netlbl_cipsov4_genl_init();\n\tif (ret_val != 0)\n\t\treturn ret_val;\n\n\tret_val = netlbl_calipso_genl_init();\n\tif (ret_val != 0)\n\t\treturn ret_val;\n\n\treturn netlbl_unlabel_genl_init();\n}\n\n \n\n \nstruct audit_buffer *netlbl_audit_start_common(int type,\n\t\t\t\t\t       struct netlbl_audit *audit_info)\n{\n\tstruct audit_buffer *audit_buf;\n\tchar *secctx;\n\tu32 secctx_len;\n\n\tif (audit_enabled == AUDIT_OFF)\n\t\treturn NULL;\n\n\taudit_buf = audit_log_start(audit_context(), GFP_ATOMIC, type);\n\tif (audit_buf == NULL)\n\t\treturn NULL;\n\n\taudit_log_format(audit_buf, \"netlabel: auid=%u ses=%u\",\n\t\t\t from_kuid(&init_user_ns, audit_info->loginuid),\n\t\t\t audit_info->sessionid);\n\n\tif (audit_info->secid != 0 &&\n\t    security_secid_to_secctx(audit_info->secid,\n\t\t\t\t     &secctx,\n\t\t\t\t     &secctx_len) == 0) {\n\t\taudit_log_format(audit_buf, \" subj=%s\", secctx);\n\t\tsecurity_release_secctx(secctx, secctx_len);\n\t}\n\n\treturn audit_buf;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}