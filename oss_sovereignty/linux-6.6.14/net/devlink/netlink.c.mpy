{
  "module_name": "netlink.c",
  "hash_id": "71ee3272b70357b0f84bfcbe30c5d6ebbb6327d68521443a0fa7a40bd160b207",
  "original_prompt": "Ingested from linux-6.6.14/net/devlink/netlink.c",
  "human_readable_source": "\n \n\n#include <net/genetlink.h>\n#include <net/sock.h>\n\n#include \"devl_internal.h\"\n\nstatic const struct genl_multicast_group devlink_nl_mcgrps[] = {\n\t[DEVLINK_MCGRP_CONFIG] = { .name = DEVLINK_GENL_MCGRP_CONFIG_NAME },\n};\n\nstatic const struct nla_policy devlink_nl_policy[DEVLINK_ATTR_MAX + 1] = {\n\t[DEVLINK_ATTR_UNSPEC] = { .strict_start_type =\n\t\tDEVLINK_ATTR_TRAP_POLICER_ID },\n\t[DEVLINK_ATTR_BUS_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_DEV_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_PORT_INDEX] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_PORT_TYPE] = NLA_POLICY_RANGE(NLA_U16, DEVLINK_PORT_TYPE_AUTO,\n\t\t\t\t\t\t    DEVLINK_PORT_TYPE_IB),\n\t[DEVLINK_ATTR_PORT_SPLIT_COUNT] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_SB_INDEX] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_SB_POOL_INDEX] = { .type = NLA_U16 },\n\t[DEVLINK_ATTR_SB_POOL_TYPE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_SB_POOL_SIZE] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_SB_POOL_THRESHOLD_TYPE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_SB_THRESHOLD] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_SB_TC_INDEX] = { .type = NLA_U16 },\n\t[DEVLINK_ATTR_ESWITCH_MODE] = NLA_POLICY_RANGE(NLA_U16, DEVLINK_ESWITCH_MODE_LEGACY,\n\t\t\t\t\t\t       DEVLINK_ESWITCH_MODE_SWITCHDEV),\n\t[DEVLINK_ATTR_ESWITCH_INLINE_MODE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_ESWITCH_ENCAP_MODE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_DPIPE_TABLE_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_DPIPE_TABLE_COUNTERS_ENABLED] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_RESOURCE_ID] = { .type = NLA_U64},\n\t[DEVLINK_ATTR_RESOURCE_SIZE] = { .type = NLA_U64},\n\t[DEVLINK_ATTR_PARAM_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_PARAM_TYPE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_PARAM_VALUE_CMODE] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_REGION_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_REGION_SNAPSHOT_ID] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_REGION_CHUNK_ADDR] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_REGION_CHUNK_LEN] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_HEALTH_REPORTER_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_HEALTH_REPORTER_GRACEFUL_PERIOD] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_HEALTH_REPORTER_AUTO_RECOVER] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_FLASH_UPDATE_FILE_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_FLASH_UPDATE_COMPONENT] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_FLASH_UPDATE_OVERWRITE_MASK] =\n\t\tNLA_POLICY_BITFIELD32(DEVLINK_SUPPORTED_FLASH_OVERWRITE_SECTIONS),\n\t[DEVLINK_ATTR_TRAP_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_TRAP_ACTION] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_TRAP_GROUP_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_NETNS_PID] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_NETNS_FD] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_NETNS_ID] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_HEALTH_REPORTER_AUTO_DUMP] = { .type = NLA_U8 },\n\t[DEVLINK_ATTR_TRAP_POLICER_ID] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_TRAP_POLICER_RATE] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_TRAP_POLICER_BURST] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_PORT_FUNCTION] = { .type = NLA_NESTED },\n\t[DEVLINK_ATTR_RELOAD_ACTION] = NLA_POLICY_RANGE(NLA_U8, DEVLINK_RELOAD_ACTION_DRIVER_REINIT,\n\t\t\t\t\t\t\tDEVLINK_RELOAD_ACTION_MAX),\n\t[DEVLINK_ATTR_RELOAD_LIMITS] = NLA_POLICY_BITFIELD32(DEVLINK_RELOAD_LIMITS_VALID_MASK),\n\t[DEVLINK_ATTR_PORT_FLAVOUR] = { .type = NLA_U16 },\n\t[DEVLINK_ATTR_PORT_PCI_PF_NUMBER] = { .type = NLA_U16 },\n\t[DEVLINK_ATTR_PORT_PCI_SF_NUMBER] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_PORT_CONTROLLER_NUMBER] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_RATE_TYPE] = { .type = NLA_U16 },\n\t[DEVLINK_ATTR_RATE_TX_SHARE] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_RATE_TX_MAX] = { .type = NLA_U64 },\n\t[DEVLINK_ATTR_RATE_NODE_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_RATE_PARENT_NODE_NAME] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_LINECARD_INDEX] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_LINECARD_TYPE] = { .type = NLA_NUL_STRING },\n\t[DEVLINK_ATTR_SELFTESTS] = { .type = NLA_NESTED },\n\t[DEVLINK_ATTR_RATE_TX_PRIORITY] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_RATE_TX_WEIGHT] = { .type = NLA_U32 },\n\t[DEVLINK_ATTR_REGION_DIRECT] = { .type = NLA_FLAG },\n};\n\nint devlink_nl_msg_reply_and_new(struct sk_buff **msg, struct genl_info *info)\n{\n\tint err;\n\n\tif (*msg) {\n\t\terr = genlmsg_reply(*msg, info);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\t*msg = genlmsg_new(GENLMSG_DEFAULT_SIZE, GFP_KERNEL);\n\tif (!*msg)\n\t\treturn -ENOMEM;\n\treturn 0;\n}\n\nstruct devlink *\ndevlink_get_from_attrs_lock(struct net *net, struct nlattr **attrs)\n{\n\tstruct devlink *devlink;\n\tunsigned long index;\n\tchar *busname;\n\tchar *devname;\n\n\tif (!attrs[DEVLINK_ATTR_BUS_NAME] || !attrs[DEVLINK_ATTR_DEV_NAME])\n\t\treturn ERR_PTR(-EINVAL);\n\n\tbusname = nla_data(attrs[DEVLINK_ATTR_BUS_NAME]);\n\tdevname = nla_data(attrs[DEVLINK_ATTR_DEV_NAME]);\n\n\tdevlinks_xa_for_each_registered_get(net, index, devlink) {\n\t\tdevl_lock(devlink);\n\t\tif (devl_is_registered(devlink) &&\n\t\t    strcmp(devlink->dev->bus->name, busname) == 0 &&\n\t\t    strcmp(dev_name(devlink->dev), devname) == 0)\n\t\t\treturn devlink;\n\t\tdevl_unlock(devlink);\n\t\tdevlink_put(devlink);\n\t}\n\n\treturn ERR_PTR(-ENODEV);\n}\n\nstatic int __devlink_nl_pre_doit(struct sk_buff *skb, struct genl_info *info,\n\t\t\t\t u8 flags)\n{\n\tstruct devlink_port *devlink_port;\n\tstruct devlink *devlink;\n\tint err;\n\n\tdevlink = devlink_get_from_attrs_lock(genl_info_net(info), info->attrs);\n\tif (IS_ERR(devlink))\n\t\treturn PTR_ERR(devlink);\n\n\tinfo->user_ptr[0] = devlink;\n\tif (flags & DEVLINK_NL_FLAG_NEED_PORT) {\n\t\tdevlink_port = devlink_port_get_from_info(devlink, info);\n\t\tif (IS_ERR(devlink_port)) {\n\t\t\terr = PTR_ERR(devlink_port);\n\t\t\tgoto unlock;\n\t\t}\n\t\tinfo->user_ptr[1] = devlink_port;\n\t} else if (flags & DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT) {\n\t\tdevlink_port = devlink_port_get_from_info(devlink, info);\n\t\tif (!IS_ERR(devlink_port))\n\t\t\tinfo->user_ptr[1] = devlink_port;\n\t}\n\treturn 0;\n\nunlock:\n\tdevl_unlock(devlink);\n\tdevlink_put(devlink);\n\treturn err;\n}\n\nint devlink_nl_pre_doit(const struct genl_split_ops *ops,\n\t\t\tstruct sk_buff *skb, struct genl_info *info)\n{\n\treturn __devlink_nl_pre_doit(skb, info, ops->internal_flags);\n}\n\nint devlink_nl_pre_doit_port(const struct genl_split_ops *ops,\n\t\t\t     struct sk_buff *skb, struct genl_info *info)\n{\n\treturn __devlink_nl_pre_doit(skb, info, DEVLINK_NL_FLAG_NEED_PORT);\n}\n\nint devlink_nl_pre_doit_port_optional(const struct genl_split_ops *ops,\n\t\t\t\t      struct sk_buff *skb,\n\t\t\t\t      struct genl_info *info)\n{\n\treturn __devlink_nl_pre_doit(skb, info, DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT);\n}\n\nvoid devlink_nl_post_doit(const struct genl_split_ops *ops,\n\t\t\t  struct sk_buff *skb, struct genl_info *info)\n{\n\tstruct devlink *devlink;\n\n\tdevlink = info->user_ptr[0];\n\tdevl_unlock(devlink);\n\tdevlink_put(devlink);\n}\n\nstatic int devlink_nl_inst_single_dumpit(struct sk_buff *msg,\n\t\t\t\t\t struct netlink_callback *cb, int flags,\n\t\t\t\t\t devlink_nl_dump_one_func_t *dump_one,\n\t\t\t\t\t struct nlattr **attrs)\n{\n\tstruct devlink *devlink;\n\tint err;\n\n\tdevlink = devlink_get_from_attrs_lock(sock_net(msg->sk), attrs);\n\tif (IS_ERR(devlink))\n\t\treturn PTR_ERR(devlink);\n\terr = dump_one(msg, devlink, cb, flags | NLM_F_DUMP_FILTERED);\n\n\tdevl_unlock(devlink);\n\tdevlink_put(devlink);\n\n\tif (err != -EMSGSIZE)\n\t\treturn err;\n\treturn msg->len;\n}\n\nstatic int devlink_nl_inst_iter_dumpit(struct sk_buff *msg,\n\t\t\t\t       struct netlink_callback *cb, int flags,\n\t\t\t\t       devlink_nl_dump_one_func_t *dump_one)\n{\n\tstruct devlink_nl_dump_state *state = devlink_dump_state(cb);\n\tstruct devlink *devlink;\n\tint err = 0;\n\n\twhile ((devlink = devlinks_xa_find_get(sock_net(msg->sk),\n\t\t\t\t\t       &state->instance))) {\n\t\tdevl_lock(devlink);\n\n\t\tif (devl_is_registered(devlink))\n\t\t\terr = dump_one(msg, devlink, cb, flags);\n\t\telse\n\t\t\terr = 0;\n\n\t\tdevl_unlock(devlink);\n\t\tdevlink_put(devlink);\n\n\t\tif (err)\n\t\t\tbreak;\n\n\t\tstate->instance++;\n\n\t\t \n\t\tstate->idx = 0;\n\t}\n\n\tif (err != -EMSGSIZE)\n\t\treturn err;\n\treturn msg->len;\n}\n\nint devlink_nl_dumpit(struct sk_buff *msg, struct netlink_callback *cb,\n\t\t      devlink_nl_dump_one_func_t *dump_one)\n{\n\tconst struct genl_info *info = genl_info_dump(cb);\n\tstruct nlattr **attrs = info->attrs;\n\tint flags = NLM_F_MULTI;\n\n\tif (attrs &&\n\t    (attrs[DEVLINK_ATTR_BUS_NAME] || attrs[DEVLINK_ATTR_DEV_NAME]))\n\t\treturn devlink_nl_inst_single_dumpit(msg, cb, flags, dump_one,\n\t\t\t\t\t\t     attrs);\n\telse\n\t\treturn devlink_nl_inst_iter_dumpit(msg, cb, flags, dump_one);\n}\n\nstatic const struct genl_small_ops devlink_nl_small_ops[40] = {\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_port_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RATE_SET,\n\t\t.doit = devlink_nl_cmd_rate_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RATE_NEW,\n\t\t.doit = devlink_nl_cmd_rate_new_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RATE_DEL,\n\t\t.doit = devlink_nl_cmd_rate_del_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_SPLIT,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_port_split_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_UNSPLIT,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_port_unsplit_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_NEW,\n\t\t.doit = devlink_nl_cmd_port_new_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_DEL,\n\t\t.doit = devlink_nl_cmd_port_del_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\n\t{\n\t\t.cmd = DEVLINK_CMD_LINECARD_SET,\n\t\t.doit = devlink_nl_cmd_linecard_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SB_POOL_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_sb_pool_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SB_PORT_POOL_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_sb_port_pool_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SB_TC_POOL_BIND_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_sb_tc_pool_bind_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SB_OCC_SNAPSHOT,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_sb_occ_snapshot_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SB_OCC_MAX_CLEAR,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_sb_occ_max_clear_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_ESWITCH_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_eswitch_get_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_ESWITCH_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_eswitch_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_DPIPE_TABLE_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_dpipe_table_get,\n\t\t \n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_DPIPE_ENTRIES_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_dpipe_entries_get,\n\t\t \n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_DPIPE_HEADERS_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_dpipe_headers_get,\n\t\t \n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_DPIPE_TABLE_COUNTERS_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_dpipe_table_counters_set,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RESOURCE_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_resource_set,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RESOURCE_DUMP,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_resource_dump,\n\t\t \n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_RELOAD,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_reload,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PARAM_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_param_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_PARAM_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_port_param_get_doit,\n\t\t.dumpit = devlink_nl_cmd_port_param_get_dumpit,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t\t \n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_PORT_PARAM_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_port_param_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_REGION_NEW,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_region_new,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_REGION_DEL,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_region_del,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_REGION_READ,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT |\n\t\t\t    GENL_DONT_VALIDATE_DUMP_STRICT,\n\t\t.dumpit = devlink_nl_cmd_region_read_dumpit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_SET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_health_reporter_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_RECOVER,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_health_reporter_recover_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_DIAGNOSE,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_health_reporter_diagnose_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_DUMP_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT |\n\t\t\t    GENL_DONT_VALIDATE_DUMP_STRICT,\n\t\t.dumpit = devlink_nl_cmd_health_reporter_dump_get_dumpit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_DUMP_CLEAR,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_health_reporter_dump_clear_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_HEALTH_REPORTER_TEST,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_health_reporter_test_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t\t.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK_OR_PORT,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_FLASH_UPDATE,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = devlink_nl_cmd_flash_update,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_TRAP_SET,\n\t\t.doit = devlink_nl_cmd_trap_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_TRAP_GROUP_SET,\n\t\t.doit = devlink_nl_cmd_trap_group_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_TRAP_POLICER_SET,\n\t\t.doit = devlink_nl_cmd_trap_policer_set_doit,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = DEVLINK_CMD_SELFTESTS_RUN,\n\t\t.doit = devlink_nl_cmd_selftests_run,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t \n};\n\nstruct genl_family devlink_nl_family __ro_after_init = {\n\t.name\t\t= DEVLINK_GENL_NAME,\n\t.version\t= DEVLINK_GENL_VERSION,\n\t.maxattr\t= DEVLINK_ATTR_MAX,\n\t.policy\t\t= devlink_nl_policy,\n\t.netnsok\t= true,\n\t.parallel_ops\t= true,\n\t.pre_doit\t= devlink_nl_pre_doit,\n\t.post_doit\t= devlink_nl_post_doit,\n\t.module\t\t= THIS_MODULE,\n\t.small_ops\t= devlink_nl_small_ops,\n\t.n_small_ops\t= ARRAY_SIZE(devlink_nl_small_ops),\n\t.split_ops\t= devlink_nl_ops,\n\t.n_split_ops\t= ARRAY_SIZE(devlink_nl_ops),\n\t.resv_start_op\t= DEVLINK_CMD_SELFTESTS_RUN + 1,\n\t.mcgrps\t\t= devlink_nl_mcgrps,\n\t.n_mcgrps\t= ARRAY_SIZE(devlink_nl_mcgrps),\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}