{
  "module_name": "act_meta_skbtcindex.c",
  "hash_id": "e927ee71944564b327fb542b37cfe0f8f43940cb04739f3ae967c5df250e11ed",
  "original_prompt": "Ingested from linux-6.6.14/net/sched/act_meta_skbtcindex.c",
  "human_readable_source": "\n \n\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/skbuff.h>\n#include <linux/rtnetlink.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <net/netlink.h>\n#include <net/pkt_sched.h>\n#include <uapi/linux/tc_act/tc_ife.h>\n#include <net/tc_act/tc_ife.h>\n\nstatic int skbtcindex_encode(struct sk_buff *skb, void *skbdata,\n\t\t\t     struct tcf_meta_info *e)\n{\n\tu32 ifetc_index = skb->tc_index;\n\n\treturn ife_encode_meta_u16(ifetc_index, skbdata, e);\n}\n\nstatic int skbtcindex_decode(struct sk_buff *skb, void *data, u16 len)\n{\n\tu16 ifetc_index = *(u16 *)data;\n\n\tskb->tc_index = ntohs(ifetc_index);\n\treturn 0;\n}\n\nstatic int skbtcindex_check(struct sk_buff *skb, struct tcf_meta_info *e)\n{\n\treturn ife_check_meta_u16(skb->tc_index, e);\n}\n\nstatic struct tcf_meta_ops ife_skbtcindex_ops = {\n\t.metaid = IFE_META_TCINDEX,\n\t.metatype = NLA_U16,\n\t.name = \"tc_index\",\n\t.synopsis = \"skb tc_index 16 bit metadata\",\n\t.check_presence = skbtcindex_check,\n\t.encode = skbtcindex_encode,\n\t.decode = skbtcindex_decode,\n\t.get = ife_get_meta_u16,\n\t.alloc = ife_alloc_meta_u16,\n\t.release = ife_release_meta_gen,\n\t.validate = ife_validate_meta_u16,\n\t.owner = THIS_MODULE,\n};\n\nstatic int __init ifetc_index_init_module(void)\n{\n\treturn register_ife_op(&ife_skbtcindex_ops);\n}\n\nstatic void __exit ifetc_index_cleanup_module(void)\n{\n\tunregister_ife_op(&ife_skbtcindex_ops);\n}\n\nmodule_init(ifetc_index_init_module);\nmodule_exit(ifetc_index_cleanup_module);\n\nMODULE_AUTHOR(\"Jamal Hadi Salim(2016)\");\nMODULE_DESCRIPTION(\"Inter-FE skb tc_index metadata module\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_IFE_META(\"tcindex\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}