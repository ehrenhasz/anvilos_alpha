{
  "module_name": "act_meta_mark.c",
  "hash_id": "d0b7ad1fb2b51c0e1139b13f10ce13e0f6d6b472d96499566a8531cf4453da59",
  "original_prompt": "Ingested from linux-6.6.14/net/sched/act_meta_mark.c",
  "human_readable_source": "\n \n\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/skbuff.h>\n#include <linux/rtnetlink.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <net/netlink.h>\n#include <net/pkt_sched.h>\n#include <uapi/linux/tc_act/tc_ife.h>\n#include <net/tc_act/tc_ife.h>\n\nstatic int skbmark_encode(struct sk_buff *skb, void *skbdata,\n\t\t\t  struct tcf_meta_info *e)\n{\n\tu32 ifemark = skb->mark;\n\n\treturn ife_encode_meta_u32(ifemark, skbdata, e);\n}\n\nstatic int skbmark_decode(struct sk_buff *skb, void *data, u16 len)\n{\n\tu32 ifemark = *(u32 *)data;\n\n\tskb->mark = ntohl(ifemark);\n\treturn 0;\n}\n\nstatic int skbmark_check(struct sk_buff *skb, struct tcf_meta_info *e)\n{\n\treturn ife_check_meta_u32(skb->mark, e);\n}\n\nstatic struct tcf_meta_ops ife_skbmark_ops = {\n\t.metaid = IFE_META_SKBMARK,\n\t.metatype = NLA_U32,\n\t.name = \"skbmark\",\n\t.synopsis = \"skb mark 32 bit metadata\",\n\t.check_presence = skbmark_check,\n\t.encode = skbmark_encode,\n\t.decode = skbmark_decode,\n\t.get = ife_get_meta_u32,\n\t.alloc = ife_alloc_meta_u32,\n\t.release = ife_release_meta_gen,\n\t.validate = ife_validate_meta_u32,\n\t.owner = THIS_MODULE,\n};\n\nstatic int __init ifemark_init_module(void)\n{\n\treturn register_ife_op(&ife_skbmark_ops);\n}\n\nstatic void __exit ifemark_cleanup_module(void)\n{\n\tunregister_ife_op(&ife_skbmark_ops);\n}\n\nmodule_init(ifemark_init_module);\nmodule_exit(ifemark_cleanup_module);\n\nMODULE_AUTHOR(\"Jamal Hadi Salim(2015)\");\nMODULE_DESCRIPTION(\"Inter-FE skb mark metadata module\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS_IFE_META(\"skbmark\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}