{
  "module_name": "ila_main.c",
  "hash_id": "85e2a11051d40acdccb957f7e98befb5ed8531e216f236f131fe8f98387a30df",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv6/ila/ila_main.c",
  "human_readable_source": "\n#include <net/genetlink.h>\n#include <net/netns/generic.h>\n#include <uapi/linux/genetlink.h>\n#include \"ila.h\"\n\nstatic const struct nla_policy ila_nl_policy[ILA_ATTR_MAX + 1] = {\n\t[ILA_ATTR_LOCATOR] = { .type = NLA_U64, },\n\t[ILA_ATTR_LOCATOR_MATCH] = { .type = NLA_U64, },\n\t[ILA_ATTR_IFINDEX] = { .type = NLA_U32, },\n\t[ILA_ATTR_CSUM_MODE] = { .type = NLA_U8, },\n\t[ILA_ATTR_IDENT_TYPE] = { .type = NLA_U8, },\n};\n\nstatic const struct genl_ops ila_nl_ops[] = {\n\t{\n\t\t.cmd = ILA_CMD_ADD,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = ila_xlat_nl_cmd_add_mapping,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = ILA_CMD_DEL,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = ila_xlat_nl_cmd_del_mapping,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = ILA_CMD_FLUSH,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = ila_xlat_nl_cmd_flush,\n\t\t.flags = GENL_ADMIN_PERM,\n\t},\n\t{\n\t\t.cmd = ILA_CMD_GET,\n\t\t.validate = GENL_DONT_VALIDATE_STRICT | GENL_DONT_VALIDATE_DUMP,\n\t\t.doit = ila_xlat_nl_cmd_get_mapping,\n\t\t.start = ila_xlat_nl_dump_start,\n\t\t.dumpit = ila_xlat_nl_dump,\n\t\t.done = ila_xlat_nl_dump_done,\n\t},\n};\n\nunsigned int ila_net_id;\n\nstruct genl_family ila_nl_family __ro_after_init = {\n\t.hdrsize\t= 0,\n\t.name\t\t= ILA_GENL_NAME,\n\t.version\t= ILA_GENL_VERSION,\n\t.maxattr\t= ILA_ATTR_MAX,\n\t.policy = ila_nl_policy,\n\t.netnsok\t= true,\n\t.parallel_ops\t= true,\n\t.module\t\t= THIS_MODULE,\n\t.ops\t\t= ila_nl_ops,\n\t.n_ops\t\t= ARRAY_SIZE(ila_nl_ops),\n\t.resv_start_op\t= ILA_CMD_FLUSH + 1,\n};\n\nstatic __net_init int ila_init_net(struct net *net)\n{\n\tint err;\n\n\terr = ila_xlat_init_net(net);\n\tif (err)\n\t\tgoto ila_xlat_init_fail;\n\n\treturn 0;\n\nila_xlat_init_fail:\n\treturn err;\n}\n\nstatic __net_exit void ila_exit_net(struct net *net)\n{\n\tila_xlat_exit_net(net);\n}\n\nstatic struct pernet_operations ila_net_ops = {\n\t.init = ila_init_net,\n\t.exit = ila_exit_net,\n\t.id   = &ila_net_id,\n\t.size = sizeof(struct ila_net),\n};\n\nstatic int __init ila_init(void)\n{\n\tint ret;\n\n\tret = register_pernet_device(&ila_net_ops);\n\tif (ret)\n\t\tgoto register_device_fail;\n\n\tret = genl_register_family(&ila_nl_family);\n\tif (ret)\n\t\tgoto register_family_fail;\n\n\tret = ila_lwt_init();\n\tif (ret)\n\t\tgoto fail_lwt;\n\n\treturn 0;\n\nfail_lwt:\n\tgenl_unregister_family(&ila_nl_family);\nregister_family_fail:\n\tunregister_pernet_device(&ila_net_ops);\nregister_device_fail:\n\treturn ret;\n}\n\nstatic void __exit ila_fini(void)\n{\n\tila_lwt_fini();\n\tgenl_unregister_family(&ila_nl_family);\n\tunregister_pernet_device(&ila_net_ops);\n}\n\nmodule_init(ila_init);\nmodule_exit(ila_fini);\nMODULE_AUTHOR(\"Tom Herbert <tom@herbertland.com>\");\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"IPv6: Identifier Locator Addressing (ILA)\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}