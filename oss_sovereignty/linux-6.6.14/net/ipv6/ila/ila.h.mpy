{
  "module_name": "ila.h",
  "hash_id": "3014ead18b70cc3962587819a5a6a5ecb34e7526e4f20e42d6eb67c21603fa9c",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv6/ila/ila.h",
  "human_readable_source": " \n \n\n#ifndef __ILA_H\n#define __ILA_H\n\n#include <linux/errno.h>\n#include <linux/ip.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/socket.h>\n#include <linux/skbuff.h>\n#include <linux/types.h>\n#include <net/checksum.h>\n#include <net/genetlink.h>\n#include <net/ip.h>\n#include <net/protocol.h>\n#include <uapi/linux/ila.h>\n\nstruct ila_locator {\n\tunion {\n\t\t__u8            v8[8];\n\t\t__be16          v16[4];\n\t\t__be32          v32[2];\n\t\t__be64\t\tv64;\n\t};\n};\n\nstruct ila_identifier {\n\tunion {\n\t\tstruct {\n#if defined(__LITTLE_ENDIAN_BITFIELD)\n\t\t\tu8 __space:4;\n\t\t\tu8 csum_neutral:1;\n\t\t\tu8 type:3;\n#elif defined(__BIG_ENDIAN_BITFIELD)\n\t\t\tu8 type:3;\n\t\t\tu8 csum_neutral:1;\n\t\t\tu8 __space:4;\n#else\n#error  \"Adjust your <asm/byteorder.h> defines\"\n#endif\n\t\t\tu8 __space2[7];\n\t\t};\n\t\t__u8            v8[8];\n\t\t__be16          v16[4];\n\t\t__be32          v32[2];\n\t\t__be64\t\tv64;\n\t};\n};\n\n#define CSUM_NEUTRAL_FLAG\thtonl(0x10000000)\n\nstruct ila_addr {\n\tunion {\n\t\tstruct in6_addr addr;\n\t\tstruct {\n\t\t\tstruct ila_locator loc;\n\t\t\tstruct ila_identifier ident;\n\t\t};\n\t};\n};\n\nstatic inline struct ila_addr *ila_a2i(struct in6_addr *addr)\n{\n\treturn (struct ila_addr *)addr;\n}\n\nstruct ila_params {\n\tstruct ila_locator locator;\n\tstruct ila_locator locator_match;\n\t__wsum csum_diff;\n\tu8 csum_mode;\n\tu8 ident_type;\n};\n\nstatic inline __wsum compute_csum_diff8(const __be32 *from, const __be32 *to)\n{\n\t__be32 diff[] = {\n\t\t~from[0], ~from[1], to[0], to[1],\n\t};\n\n\treturn csum_partial(diff, sizeof(diff), 0);\n}\n\nstatic inline bool ila_csum_neutral_set(struct ila_identifier ident)\n{\n\treturn !!(ident.csum_neutral);\n}\n\nvoid ila_update_ipv6_locator(struct sk_buff *skb, struct ila_params *p,\n\t\t\t     bool set_csum_neutral);\n\nvoid ila_init_saved_csum(struct ila_params *p);\n\nstruct ila_net {\n\tstruct {\n\t\tstruct rhashtable rhash_table;\n\t\tspinlock_t *locks;  \n\t\tunsigned int locks_mask;\n\t\tbool hooks_registered;\n\t} xlat;\n};\n\nint ila_lwt_init(void);\nvoid ila_lwt_fini(void);\n\nint ila_xlat_init_net(struct net *net);\nvoid ila_xlat_exit_net(struct net *net);\n\nint ila_xlat_nl_cmd_add_mapping(struct sk_buff *skb, struct genl_info *info);\nint ila_xlat_nl_cmd_del_mapping(struct sk_buff *skb, struct genl_info *info);\nint ila_xlat_nl_cmd_get_mapping(struct sk_buff *skb, struct genl_info *info);\nint ila_xlat_nl_cmd_flush(struct sk_buff *skb, struct genl_info *info);\nint ila_xlat_nl_dump_start(struct netlink_callback *cb);\nint ila_xlat_nl_dump_done(struct netlink_callback *cb);\nint ila_xlat_nl_dump(struct sk_buff *skb, struct netlink_callback *cb);\n\nextern unsigned int ila_net_id;\n\nextern struct genl_family ila_nl_family;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}