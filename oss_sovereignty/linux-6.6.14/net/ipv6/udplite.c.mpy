{
  "module_name": "udplite.c",
  "hash_id": "bbfde1a1f5d8a33c9f1859f0cac3862e5f3ad5f331527040b895c040b9a72859",
  "original_prompt": "Ingested from linux-6.6.14/net/ipv6/udplite.c",
  "human_readable_source": "\n \n#define pr_fmt(fmt) \"UDPLite6: \" fmt\n\n#include <linux/export.h>\n#include <linux/proc_fs.h>\n#include \"udp_impl.h\"\n\nstatic int udplitev6_sk_init(struct sock *sk)\n{\n\tudpv6_init_sock(sk);\n\tpr_warn_once(\"UDP-Lite is deprecated and scheduled to be removed in 2025, \"\n\t\t     \"please contact the netdev mailing list\\n\");\n\treturn 0;\n}\n\nstatic int udplitev6_rcv(struct sk_buff *skb)\n{\n\treturn __udp6_lib_rcv(skb, &udplite_table, IPPROTO_UDPLITE);\n}\n\nstatic int udplitev6_err(struct sk_buff *skb,\n\t\t\t  struct inet6_skb_parm *opt,\n\t\t\t  u8 type, u8 code, int offset, __be32 info)\n{\n\treturn __udp6_lib_err(skb, opt, type, code, offset, info,\n\t\t\t      &udplite_table);\n}\n\nstatic const struct inet6_protocol udplitev6_protocol = {\n\t.handler\t=\tudplitev6_rcv,\n\t.err_handler\t=\tudplitev6_err,\n\t.flags\t\t=\tINET6_PROTO_NOPOLICY|INET6_PROTO_FINAL,\n};\n\nstruct proto udplitev6_prot = {\n\t.name\t\t   = \"UDPLITEv6\",\n\t.owner\t\t   = THIS_MODULE,\n\t.close\t\t   = udp_lib_close,\n\t.connect\t   = ip6_datagram_connect,\n\t.disconnect\t   = udp_disconnect,\n\t.ioctl\t\t   = udp_ioctl,\n\t.init\t\t   = udplitev6_sk_init,\n\t.destroy\t   = udpv6_destroy_sock,\n\t.setsockopt\t   = udpv6_setsockopt,\n\t.getsockopt\t   = udpv6_getsockopt,\n\t.sendmsg\t   = udpv6_sendmsg,\n\t.recvmsg\t   = udpv6_recvmsg,\n\t.hash\t\t   = udp_lib_hash,\n\t.unhash\t\t   = udp_lib_unhash,\n\t.rehash\t\t   = udp_v6_rehash,\n\t.get_port\t   = udp_v6_get_port,\n\n\t.memory_allocated  = &udp_memory_allocated,\n\t.per_cpu_fw_alloc  = &udp_memory_per_cpu_fw_alloc,\n\n\t.sysctl_mem\t   = sysctl_udp_mem,\n\t.sysctl_wmem_offset = offsetof(struct net, ipv4.sysctl_udp_wmem_min),\n\t.sysctl_rmem_offset = offsetof(struct net, ipv4.sysctl_udp_rmem_min),\n\t.obj_size\t   = sizeof(struct udp6_sock),\n\t.ipv6_pinfo_offset = offsetof(struct udp6_sock, inet6),\n\t.h.udp_table\t   = &udplite_table,\n};\n\nstatic struct inet_protosw udplite6_protosw = {\n\t.type\t\t= SOCK_DGRAM,\n\t.protocol\t= IPPROTO_UDPLITE,\n\t.prot\t\t= &udplitev6_prot,\n\t.ops\t\t= &inet6_dgram_ops,\n\t.flags\t\t= INET_PROTOSW_PERMANENT,\n};\n\nint __init udplitev6_init(void)\n{\n\tint ret;\n\n\tret = inet6_add_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\n\tif (ret)\n\t\tgoto out;\n\n\tret = inet6_register_protosw(&udplite6_protosw);\n\tif (ret)\n\t\tgoto out_udplitev6_protocol;\nout:\n\treturn ret;\n\nout_udplitev6_protocol:\n\tinet6_del_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\n\tgoto out;\n}\n\nvoid udplitev6_exit(void)\n{\n\tinet6_unregister_protosw(&udplite6_protosw);\n\tinet6_del_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\n}\n\n#ifdef CONFIG_PROC_FS\nstatic struct udp_seq_afinfo udplite6_seq_afinfo = {\n\t.family\t\t= AF_INET6,\n\t.udp_table\t= &udplite_table,\n};\n\nstatic int __net_init udplite6_proc_init_net(struct net *net)\n{\n\tif (!proc_create_net_data(\"udplite6\", 0444, net->proc_net,\n\t\t\t&udp6_seq_ops, sizeof(struct udp_iter_state),\n\t\t\t&udplite6_seq_afinfo))\n\t\treturn -ENOMEM;\n\treturn 0;\n}\n\nstatic void __net_exit udplite6_proc_exit_net(struct net *net)\n{\n\tremove_proc_entry(\"udplite6\", net->proc_net);\n}\n\nstatic struct pernet_operations udplite6_net_ops = {\n\t.init = udplite6_proc_init_net,\n\t.exit = udplite6_proc_exit_net,\n};\n\nint __init udplite6_proc_init(void)\n{\n\treturn register_pernet_subsys(&udplite6_net_ops);\n}\n\nvoid udplite6_proc_exit(void)\n{\n\tunregister_pernet_subsys(&udplite6_net_ops);\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}