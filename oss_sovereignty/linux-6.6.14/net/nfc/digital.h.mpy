{
  "module_name": "digital.h",
  "hash_id": "98a85ee33fbd021628a2b352255d16968f94a70c0b770762cc7a2b156003a505",
  "original_prompt": "Ingested from linux-6.6.14/net/nfc/digital.h",
  "human_readable_source": " \n \n\n#ifndef __DIGITAL_H\n#define __DIGITAL_H\n\n#include <net/nfc/nfc.h>\n#include <net/nfc/digital.h>\n\n#include <linux/crc-ccitt.h>\n#include <linux/crc-itu-t.h>\n\n#define PROTOCOL_ERR(req) pr_err(\"%d: NFC Digital Protocol error: %s\\n\", \\\n\t\t\t\t __LINE__, req)\n\n#define DIGITAL_CMD_IN_SEND        0\n#define DIGITAL_CMD_TG_SEND        1\n#define DIGITAL_CMD_TG_LISTEN      2\n#define DIGITAL_CMD_TG_LISTEN_MDAA 3\n#define DIGITAL_CMD_TG_LISTEN_MD   4\n\n#define DIGITAL_MAX_HEADER_LEN 7\n#define DIGITAL_CRC_LEN        2\n\n#define DIGITAL_SENSF_NFCID2_NFC_DEP_B1 0x01\n#define DIGITAL_SENSF_NFCID2_NFC_DEP_B2 0xFE\n\n#define DIGITAL_SENS_RES_NFC_DEP 0x0100\n#define DIGITAL_SEL_RES_NFC_DEP  0x40\n#define DIGITAL_SENSF_FELICA_SC  0xFFFF\n\n#define DIGITAL_DRV_CAPS_IN_CRC(ddev) \\\n\t((ddev)->driver_capabilities & NFC_DIGITAL_DRV_CAPS_IN_CRC)\n#define DIGITAL_DRV_CAPS_TG_CRC(ddev) \\\n\t((ddev)->driver_capabilities & NFC_DIGITAL_DRV_CAPS_TG_CRC)\n\nstruct digital_data_exch {\n\tdata_exchange_cb_t cb;\n\tvoid *cb_context;\n};\n\nstruct sk_buff *digital_skb_alloc(struct nfc_digital_dev *ddev,\n\t\t\t\t  unsigned int len);\n\nint digital_send_cmd(struct nfc_digital_dev *ddev, u8 cmd_type,\n\t\t     struct sk_buff *skb, struct digital_tg_mdaa_params *params,\n\t\t     u16 timeout, nfc_digital_cmd_complete_t cmd_cb,\n\t\t     void *cb_context);\n\nint digital_in_configure_hw(struct nfc_digital_dev *ddev, int type, int param);\nstatic inline int digital_in_send_cmd(struct nfc_digital_dev *ddev,\n\t\t\t\t      struct sk_buff *skb, u16 timeout,\n\t\t\t\t      nfc_digital_cmd_complete_t cmd_cb,\n\t\t\t\t      void *cb_context)\n{\n\treturn digital_send_cmd(ddev, DIGITAL_CMD_IN_SEND, skb, NULL, timeout,\n\t\t\t\tcmd_cb, cb_context);\n}\n\nvoid digital_poll_next_tech(struct nfc_digital_dev *ddev);\n\nint digital_in_send_sens_req(struct nfc_digital_dev *ddev, u8 rf_tech);\nint digital_in_send_sensb_req(struct nfc_digital_dev *ddev, u8 rf_tech);\nint digital_in_send_sensf_req(struct nfc_digital_dev *ddev, u8 rf_tech);\nint digital_in_send_iso15693_inv_req(struct nfc_digital_dev *ddev, u8 rf_tech);\n\nint digital_in_iso_dep_pull_sod(struct nfc_digital_dev *ddev,\n\t\t\t\tstruct sk_buff *skb);\nint digital_in_iso_dep_push_sod(struct nfc_digital_dev *ddev,\n\t\t\t\tstruct sk_buff *skb);\n\nint digital_target_found(struct nfc_digital_dev *ddev,\n\t\t\t struct nfc_target *target, u8 protocol);\n\nint digital_in_recv_mifare_res(struct sk_buff *resp);\n\nint digital_in_send_atr_req(struct nfc_digital_dev *ddev,\n\t\t\t    struct nfc_target *target, __u8 comm_mode, __u8 *gb,\n\t\t\t    size_t gb_len);\nint digital_in_send_dep_req(struct nfc_digital_dev *ddev,\n\t\t\t    struct nfc_target *target, struct sk_buff *skb,\n\t\t\t    struct digital_data_exch *data_exch);\n\nint digital_tg_configure_hw(struct nfc_digital_dev *ddev, int type, int param);\nstatic inline int digital_tg_send_cmd(struct nfc_digital_dev *ddev,\n\t\t\tstruct sk_buff *skb, u16 timeout,\n\t\t\tnfc_digital_cmd_complete_t cmd_cb, void *cb_context)\n{\n\treturn digital_send_cmd(ddev, DIGITAL_CMD_TG_SEND, skb, NULL, timeout,\n\t\t\t\tcmd_cb, cb_context);\n}\n\nvoid digital_tg_recv_sens_req(struct nfc_digital_dev *ddev, void *arg,\n\t\t\t      struct sk_buff *resp);\n\nvoid digital_tg_recv_sensf_req(struct nfc_digital_dev *ddev, void *arg,\n\t\t\t       struct sk_buff *resp);\n\nstatic inline int digital_tg_listen(struct nfc_digital_dev *ddev, u16 timeout,\n\t\t\t\t    nfc_digital_cmd_complete_t cb, void *arg)\n{\n\treturn digital_send_cmd(ddev, DIGITAL_CMD_TG_LISTEN, NULL, NULL,\n\t\t\t\ttimeout, cb, arg);\n}\n\nvoid digital_tg_recv_atr_req(struct nfc_digital_dev *ddev, void *arg,\n\t\t\t     struct sk_buff *resp);\n\nint digital_tg_send_dep_res(struct nfc_digital_dev *ddev, struct sk_buff *skb);\n\nint digital_tg_listen_nfca(struct nfc_digital_dev *ddev, u8 rf_tech);\nint digital_tg_listen_nfcf(struct nfc_digital_dev *ddev, u8 rf_tech);\nvoid digital_tg_recv_md_req(struct nfc_digital_dev *ddev, void *arg,\n\t\t\t    struct sk_buff *resp);\n\ntypedef u16 (*crc_func_t)(u16, const u8 *, size_t);\n\n#define CRC_A_INIT 0x6363\n#define CRC_B_INIT 0xFFFF\n#define CRC_F_INIT 0x0000\n\nvoid digital_skb_add_crc(struct sk_buff *skb, crc_func_t crc_func, u16 init,\n\t\t\t u8 bitwise_inv, u8 msb_first);\n\nstatic inline void digital_skb_add_crc_a(struct sk_buff *skb)\n{\n\tdigital_skb_add_crc(skb, crc_ccitt, CRC_A_INIT, 0, 0);\n}\n\nstatic inline void digital_skb_add_crc_b(struct sk_buff *skb)\n{\n\tdigital_skb_add_crc(skb, crc_ccitt, CRC_B_INIT, 1, 0);\n}\n\nstatic inline void digital_skb_add_crc_f(struct sk_buff *skb)\n{\n\tdigital_skb_add_crc(skb, crc_itu_t, CRC_F_INIT, 0, 1);\n}\n\nstatic inline void digital_skb_add_crc_none(struct sk_buff *skb)\n{\n\treturn;\n}\n\nint digital_skb_check_crc(struct sk_buff *skb, crc_func_t crc_func,\n\t\t\t  u16 crc_init, u8 bitwise_inv, u8 msb_first);\n\nstatic inline int digital_skb_check_crc_a(struct sk_buff *skb)\n{\n\treturn digital_skb_check_crc(skb, crc_ccitt, CRC_A_INIT, 0, 0);\n}\n\nstatic inline int digital_skb_check_crc_b(struct sk_buff *skb)\n{\n\treturn digital_skb_check_crc(skb, crc_ccitt, CRC_B_INIT, 1, 0);\n}\n\nstatic inline int digital_skb_check_crc_f(struct sk_buff *skb)\n{\n\treturn digital_skb_check_crc(skb, crc_itu_t, CRC_F_INIT, 0, 1);\n}\n\nstatic inline int digital_skb_check_crc_none(struct sk_buff *skb)\n{\n\treturn 0;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}