{
  "module_name": "llcp.h",
  "hash_id": "d393b0ea4e0bf02e795f2df2009749d1da0c259d2bab6878e518f60d92dd414c",
  "original_prompt": "Ingested from linux-6.6.14/net/nfc/llcp.h",
  "human_readable_source": " \n \n\nenum llcp_state {\n\tLLCP_CONNECTED = 1,  \n\tLLCP_CONNECTING,\n\tLLCP_CLOSED,\n\tLLCP_BOUND,\n\tLLCP_LISTEN,\n};\n\n#define LLCP_DEFAULT_LTO 100\n#define LLCP_DEFAULT_RW  1\n#define LLCP_DEFAULT_MIU 128\n\n#define LLCP_MAX_LTO  0xff\n#define LLCP_MAX_RW   15\n#define LLCP_MAX_MIUX 0x7ff\n#define LLCP_MAX_MIU (LLCP_MAX_MIUX + 128)\n\n#define LLCP_WKS_NUM_SAP   16\n#define LLCP_SDP_NUM_SAP   16\n#define LLCP_LOCAL_NUM_SAP 32\n#define LLCP_LOCAL_SAP_OFFSET (LLCP_WKS_NUM_SAP + LLCP_SDP_NUM_SAP)\n#define LLCP_MAX_SAP (LLCP_WKS_NUM_SAP + LLCP_SDP_NUM_SAP + LLCP_LOCAL_NUM_SAP)\n#define LLCP_SDP_UNBOUND   (LLCP_MAX_SAP + 1)\n\nstruct nfc_llcp_sock;\n\nstruct llcp_sock_list {\n\tstruct hlist_head head;\n\trwlock_t          lock;\n};\n\nstruct nfc_llcp_sdp_tlv {\n\tu8 *tlv;\n\tu8 tlv_len;\n\n\tchar *uri;\n\tu8 tid;\n\tu8 sap;\n\n\tunsigned long time;\n\n\tstruct hlist_node node;\n};\n\nstruct nfc_llcp_local {\n\tstruct list_head list;\n\tstruct nfc_dev *dev;\n\n\tstruct kref ref;\n\n\tstruct mutex sdp_lock;\n\n\tstruct timer_list link_timer;\n\tstruct sk_buff_head tx_queue;\n\tstruct work_struct\t tx_work;\n\tstruct work_struct\t rx_work;\n\tstruct sk_buff *rx_pending;\n\tstruct work_struct\t timeout_work;\n\n\tu32 target_idx;\n\tu8 rf_mode;\n\tu8 comm_mode;\n\tu8 lto;\n\tu8 rw;\n\t__be16 miux;\n\tunsigned long local_wks;       \n\tunsigned long local_sdp;       \n\tunsigned long local_sap;  \n\tatomic_t local_sdp_cnt[LLCP_SDP_NUM_SAP];\n\n\t \n\tu8 gb[NFC_MAX_GT_LEN];\n\tu8 gb_len;\n\n\t \n\tu8 remote_gb[NFC_MAX_GT_LEN];\n\tu8 remote_gb_len;\n\n\tu8  remote_version;\n\tu16 remote_miu;\n\tu16 remote_lto;\n\tu8  remote_opt;\n\tu16 remote_wks;\n\n\tstruct mutex sdreq_lock;\n\tstruct hlist_head pending_sdreqs;\n\tstruct timer_list sdreq_timer;\n\tstruct work_struct sdreq_timeout_work;\n\tu8 sdreq_next_tid;\n\n\t \n\tstruct llcp_sock_list sockets;\n\tstruct llcp_sock_list connecting_sockets;\n\tstruct llcp_sock_list raw_sockets;\n};\n\nstruct nfc_llcp_sock {\n\tstruct sock sk;\n\tstruct nfc_dev *dev;\n\tstruct nfc_llcp_local *local;\n\tu32 target_idx;\n\tu32 nfc_protocol;\n\n\t \n\tu8 ssap;\n\tu8 dsap;\n\tchar *service_name;\n\tsize_t service_name_len;\n\tu8 rw;\n\t__be16 miux;\n\n\n\t \n\tu8 remote_rw;\n\tu16 remote_miu;\n\n\t \n\tu8 send_n;\n\tu8 send_ack_n;\n\tu8 recv_n;\n\tu8 recv_ack_n;\n\n\t \n\tu8 remote_ready;\n\n\t \n\tu8 reserved_ssap;\n\n\tstruct sk_buff_head tx_queue;\n\tstruct sk_buff_head tx_pending_queue;\n\n\tstruct list_head accept_queue;\n\tstruct sock *parent;\n};\n\nstruct nfc_llcp_ui_cb {\n\t__u8 dsap;\n\t__u8 ssap;\n};\n\n#define nfc_llcp_ui_skb_cb(__skb) ((struct nfc_llcp_ui_cb *)&((__skb)->cb[0]))\n\n#define nfc_llcp_sock(sk) ((struct nfc_llcp_sock *) (sk))\n#define nfc_llcp_dev(sk)  (nfc_llcp_sock((sk))->dev)\n\n#define LLCP_HEADER_SIZE   2\n#define LLCP_SEQUENCE_SIZE 1\n#define LLCP_AGF_PDU_HEADER_SIZE 2\n\n \n#define LLCP_VERSION_10 0x10\n#define LLCP_VERSION_11 0x11\n\n \n#define LLCP_PDU_SYMM     0x0\n#define LLCP_PDU_PAX      0x1\n#define LLCP_PDU_AGF      0x2\n#define LLCP_PDU_UI       0x3\n#define LLCP_PDU_CONNECT  0x4\n#define LLCP_PDU_DISC     0x5\n#define LLCP_PDU_CC       0x6\n#define LLCP_PDU_DM       0x7\n#define LLCP_PDU_FRMR     0x8\n#define LLCP_PDU_SNL      0x9\n#define LLCP_PDU_I        0xc\n#define LLCP_PDU_RR       0xd\n#define LLCP_PDU_RNR      0xe\n\n \n#define LLCP_TLV_VERSION 0x1\n#define LLCP_TLV_MIUX    0x2\n#define LLCP_TLV_WKS     0x3\n#define LLCP_TLV_LTO     0x4\n#define LLCP_TLV_RW      0x5\n#define LLCP_TLV_SN      0x6\n#define LLCP_TLV_OPT     0x7\n#define LLCP_TLV_SDREQ   0x8\n#define LLCP_TLV_SDRES   0x9\n#define LLCP_TLV_MAX     0xa\n\n \n#define LLCP_SAP_SDP   0x1\n#define LLCP_SAP_IP    0x2\n#define LLCP_SAP_OBEX  0x3\n#define LLCP_SAP_SNEP  0x4\n#define LLCP_SAP_MAX   0xff\n\n \n#define LLCP_DM_DISC    0x00\n#define LLCP_DM_NOCONN  0x01\n#define LLCP_DM_NOBOUND 0x02\n#define LLCP_DM_REJ     0x03\n\n\nvoid nfc_llcp_sock_link(struct llcp_sock_list *l, struct sock *s);\nvoid nfc_llcp_sock_unlink(struct llcp_sock_list *l, struct sock *s);\nvoid nfc_llcp_socket_remote_param_init(struct nfc_llcp_sock *sock);\nstruct nfc_llcp_local *nfc_llcp_find_local(struct nfc_dev *dev);\nint nfc_llcp_local_put(struct nfc_llcp_local *local);\nu8 nfc_llcp_get_sdp_ssap(struct nfc_llcp_local *local,\n\t\t\t struct nfc_llcp_sock *sock);\nu8 nfc_llcp_get_local_ssap(struct nfc_llcp_local *local);\nvoid nfc_llcp_put_ssap(struct nfc_llcp_local *local, u8 ssap);\nint nfc_llcp_queue_i_frames(struct nfc_llcp_sock *sock);\nvoid nfc_llcp_send_to_raw_sock(struct nfc_llcp_local *local,\n\t\t\t       struct sk_buff *skb, u8 direction);\n\n \nstruct sock *nfc_llcp_sock_alloc(struct socket *sock, int type, gfp_t gfp, int kern);\nvoid nfc_llcp_sock_free(struct nfc_llcp_sock *sock);\nvoid nfc_llcp_accept_unlink(struct sock *sk);\nvoid nfc_llcp_accept_enqueue(struct sock *parent, struct sock *sk);\nstruct sock *nfc_llcp_accept_dequeue(struct sock *sk, struct socket *newsock);\n\n \nint nfc_llcp_parse_gb_tlv(struct nfc_llcp_local *local,\n\t\t\t  const u8 *tlv_array, u16 tlv_array_len);\nint nfc_llcp_parse_connection_tlv(struct nfc_llcp_sock *sock,\n\t\t\t\t  const u8 *tlv_array, u16 tlv_array_len);\n\n \nvoid nfc_llcp_recv(void *data, struct sk_buff *skb, int err);\nu8 *nfc_llcp_build_tlv(u8 type, const u8 *value, u8 value_length, u8 *tlv_length);\nstruct nfc_llcp_sdp_tlv *nfc_llcp_build_sdres_tlv(u8 tid, u8 sap);\nstruct nfc_llcp_sdp_tlv *nfc_llcp_build_sdreq_tlv(u8 tid, const char *uri,\n\t\t\t\t\t\t  size_t uri_len);\nvoid nfc_llcp_free_sdp_tlv(struct nfc_llcp_sdp_tlv *sdp);\nvoid nfc_llcp_free_sdp_tlv_list(struct hlist_head *sdp_head);\nvoid nfc_llcp_recv(void *data, struct sk_buff *skb, int err);\nint nfc_llcp_send_symm(struct nfc_dev *dev);\nint nfc_llcp_send_connect(struct nfc_llcp_sock *sock);\nint nfc_llcp_send_cc(struct nfc_llcp_sock *sock);\nint nfc_llcp_send_snl_sdres(struct nfc_llcp_local *local,\n\t\t\t    struct hlist_head *tlv_list, size_t tlvs_len);\nint nfc_llcp_send_snl_sdreq(struct nfc_llcp_local *local,\n\t\t\t    struct hlist_head *tlv_list, size_t tlvs_len);\nint nfc_llcp_send_dm(struct nfc_llcp_local *local, u8 ssap, u8 dsap, u8 reason);\nint nfc_llcp_send_disconnect(struct nfc_llcp_sock *sock);\nint nfc_llcp_send_i_frame(struct nfc_llcp_sock *sock,\n\t\t\t  struct msghdr *msg, size_t len);\nint nfc_llcp_send_ui_frame(struct nfc_llcp_sock *sock, u8 ssap, u8 dsap,\n\t\t\t   struct msghdr *msg, size_t len);\nint nfc_llcp_send_rr(struct nfc_llcp_sock *sock);\n\n \nint __init nfc_llcp_sock_init(void);\nvoid nfc_llcp_sock_exit(void);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}