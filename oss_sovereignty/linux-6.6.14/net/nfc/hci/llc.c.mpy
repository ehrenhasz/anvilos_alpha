{
  "module_name": "llc.c",
  "hash_id": "cbd8949f20b4842fa5c6e3996dd682348dc7065d5ee6875020b22c02be9181b1",
  "original_prompt": "Ingested from linux-6.6.14/net/nfc/hci/llc.c",
  "human_readable_source": "\n \n\n#include <net/nfc/llc.h>\n\n#include \"llc.h\"\n\nstatic LIST_HEAD(llc_engines);\n\nint __init nfc_llc_init(void)\n{\n\tint r;\n\n\tr = nfc_llc_nop_register();\n\tif (r)\n\t\tgoto exit;\n\n\tr = nfc_llc_shdlc_register();\n\tif (r)\n\t\tgoto exit;\n\n\treturn 0;\n\nexit:\n\tnfc_llc_exit();\n\treturn r;\n}\n\nvoid nfc_llc_exit(void)\n{\n\tstruct nfc_llc_engine *llc_engine, *n;\n\n\tlist_for_each_entry_safe(llc_engine, n, &llc_engines, entry) {\n\t\tlist_del(&llc_engine->entry);\n\t\tkfree(llc_engine->name);\n\t\tkfree(llc_engine);\n\t}\n}\n\nint nfc_llc_register(const char *name, const struct nfc_llc_ops *ops)\n{\n\tstruct nfc_llc_engine *llc_engine;\n\n\tllc_engine = kzalloc(sizeof(struct nfc_llc_engine), GFP_KERNEL);\n\tif (llc_engine == NULL)\n\t\treturn -ENOMEM;\n\n\tllc_engine->name = kstrdup(name, GFP_KERNEL);\n\tif (llc_engine->name == NULL) {\n\t\tkfree(llc_engine);\n\t\treturn -ENOMEM;\n\t}\n\tllc_engine->ops = ops;\n\n\tINIT_LIST_HEAD(&llc_engine->entry);\n\tlist_add_tail(&llc_engine->entry, &llc_engines);\n\n\treturn 0;\n}\n\nstatic struct nfc_llc_engine *nfc_llc_name_to_engine(const char *name)\n{\n\tstruct nfc_llc_engine *llc_engine;\n\n\tlist_for_each_entry(llc_engine, &llc_engines, entry) {\n\t\tif (strcmp(llc_engine->name, name) == 0)\n\t\t\treturn llc_engine;\n\t}\n\n\treturn NULL;\n}\n\nvoid nfc_llc_unregister(const char *name)\n{\n\tstruct nfc_llc_engine *llc_engine;\n\n\tllc_engine = nfc_llc_name_to_engine(name);\n\tif (llc_engine == NULL)\n\t\treturn;\n\n\tlist_del(&llc_engine->entry);\n\tkfree(llc_engine->name);\n\tkfree(llc_engine);\n}\n\nstruct nfc_llc *nfc_llc_allocate(const char *name, struct nfc_hci_dev *hdev,\n\t\t\t\t xmit_to_drv_t xmit_to_drv,\n\t\t\t\t rcv_to_hci_t rcv_to_hci, int tx_headroom,\n\t\t\t\t int tx_tailroom, llc_failure_t llc_failure)\n{\n\tstruct nfc_llc_engine *llc_engine;\n\tstruct nfc_llc *llc;\n\n\tllc_engine = nfc_llc_name_to_engine(name);\n\tif (llc_engine == NULL)\n\t\treturn NULL;\n\n\tllc = kzalloc(sizeof(struct nfc_llc), GFP_KERNEL);\n\tif (llc == NULL)\n\t\treturn NULL;\n\n\tllc->data = llc_engine->ops->init(hdev, xmit_to_drv, rcv_to_hci,\n\t\t\t\t\t  tx_headroom, tx_tailroom,\n\t\t\t\t\t  &llc->rx_headroom, &llc->rx_tailroom,\n\t\t\t\t\t  llc_failure);\n\tif (llc->data == NULL) {\n\t\tkfree(llc);\n\t\treturn NULL;\n\t}\n\tllc->ops = llc_engine->ops;\n\n\treturn llc;\n}\n\nvoid nfc_llc_free(struct nfc_llc *llc)\n{\n\tllc->ops->deinit(llc);\n\tkfree(llc);\n}\n\nint nfc_llc_start(struct nfc_llc *llc)\n{\n\treturn llc->ops->start(llc);\n}\nEXPORT_SYMBOL(nfc_llc_start);\n\nint nfc_llc_stop(struct nfc_llc *llc)\n{\n\treturn llc->ops->stop(llc);\n}\nEXPORT_SYMBOL(nfc_llc_stop);\n\nvoid nfc_llc_rcv_from_drv(struct nfc_llc *llc, struct sk_buff *skb)\n{\n\tllc->ops->rcv_from_drv(llc, skb);\n}\n\nint nfc_llc_xmit_from_hci(struct nfc_llc *llc, struct sk_buff *skb)\n{\n\treturn llc->ops->xmit_from_hci(llc, skb);\n}\n\nvoid *nfc_llc_get_data(struct nfc_llc *llc)\n{\n\treturn llc->data;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}