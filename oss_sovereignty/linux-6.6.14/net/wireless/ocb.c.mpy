{
  "module_name": "ocb.c",
  "hash_id": "556e033dee9ada1dcb59dedf4c86ab072c12413f952c97687b5b6b3db5836d51",
  "original_prompt": "Ingested from linux-6.6.14/net/wireless/ocb.c",
  "human_readable_source": "\n \n\n#include <linux/ieee80211.h>\n#include <net/cfg80211.h>\n#include \"nl80211.h\"\n#include \"core.h\"\n#include \"rdev-ops.h\"\n\nint __cfg80211_join_ocb(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev,\n\t\t\tstruct ocb_setup *setup)\n{\n\tstruct wireless_dev *wdev = dev->ieee80211_ptr;\n\tint err;\n\n\tASSERT_WDEV_LOCK(wdev);\n\n\tif (dev->ieee80211_ptr->iftype != NL80211_IFTYPE_OCB)\n\t\treturn -EOPNOTSUPP;\n\n\tif (!rdev->ops->join_ocb)\n\t\treturn -EOPNOTSUPP;\n\n\tif (WARN_ON(!setup->chandef.chan))\n\t\treturn -EINVAL;\n\n\terr = rdev_join_ocb(rdev, dev, setup);\n\tif (!err)\n\t\twdev->u.ocb.chandef = setup->chandef;\n\n\treturn err;\n}\n\nint cfg80211_join_ocb(struct cfg80211_registered_device *rdev,\n\t\t      struct net_device *dev,\n\t\t      struct ocb_setup *setup)\n{\n\tstruct wireless_dev *wdev = dev->ieee80211_ptr;\n\tint err;\n\n\twdev_lock(wdev);\n\terr = __cfg80211_join_ocb(rdev, dev, setup);\n\twdev_unlock(wdev);\n\n\treturn err;\n}\n\nint __cfg80211_leave_ocb(struct cfg80211_registered_device *rdev,\n\t\t\t struct net_device *dev)\n{\n\tstruct wireless_dev *wdev = dev->ieee80211_ptr;\n\tint err;\n\n\tASSERT_WDEV_LOCK(wdev);\n\n\tif (dev->ieee80211_ptr->iftype != NL80211_IFTYPE_OCB)\n\t\treturn -EOPNOTSUPP;\n\n\tif (!rdev->ops->leave_ocb)\n\t\treturn -EOPNOTSUPP;\n\n\tif (!wdev->u.ocb.chandef.chan)\n\t\treturn -ENOTCONN;\n\n\terr = rdev_leave_ocb(rdev, dev);\n\tif (!err)\n\t\tmemset(&wdev->u.ocb.chandef, 0, sizeof(wdev->u.ocb.chandef));\n\n\treturn err;\n}\n\nint cfg80211_leave_ocb(struct cfg80211_registered_device *rdev,\n\t\t       struct net_device *dev)\n{\n\tstruct wireless_dev *wdev = dev->ieee80211_ptr;\n\tint err;\n\n\twdev_lock(wdev);\n\terr = __cfg80211_leave_ocb(rdev, dev);\n\twdev_unlock(wdev);\n\n\treturn err;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}