{
  "module_name": "core.h",
  "hash_id": "6d09689a81e05845aaa4d65ff55656161527edae2cc53403069931f14a08f90e",
  "original_prompt": "Ingested from linux-6.6.14/net/wireless/core.h",
  "human_readable_source": " \n \n#ifndef __NET_WIRELESS_CORE_H\n#define __NET_WIRELESS_CORE_H\n#include <linux/list.h>\n#include <linux/netdevice.h>\n#include <linux/rbtree.h>\n#include <linux/debugfs.h>\n#include <linux/rfkill.h>\n#include <linux/workqueue.h>\n#include <linux/rtnetlink.h>\n#include <net/genetlink.h>\n#include <net/cfg80211.h>\n#include \"reg.h\"\n\n\n#define WIPHY_IDX_INVALID\t-1\n\nstruct cfg80211_registered_device {\n\tconst struct cfg80211_ops *ops;\n\tstruct list_head list;\n\n\t \n\tstruct rfkill_ops rfkill_ops;\n\tstruct work_struct rfkill_block;\n\n\t \n\tchar country_ie_alpha2[2];\n\n\t \n\tconst struct ieee80211_regdomain *requested_regd;\n\n\t \n\tenum environment_cap env;\n\n\t \n\tint wiphy_idx;\n\n\t \n\tint devlist_generation, wdev_id;\n\tint opencount;\n\twait_queue_head_t dev_wait;\n\n\tstruct list_head beacon_registrations;\n\tspinlock_t beacon_registrations_lock;\n\n\t \n\tint num_running_ifaces;\n\tint num_running_monitor_ifaces;\n\tu64 cookie_counter;\n\n\t \n\tspinlock_t bss_lock;\n\tstruct list_head bss_list;\n\tstruct rb_root bss_tree;\n\tu32 bss_generation;\n\tu32 bss_entries;\n\tstruct cfg80211_scan_request *scan_req;  \n\tstruct cfg80211_scan_request *int_scan_req;\n\tstruct sk_buff *scan_msg;\n\tstruct list_head sched_scan_req_list;\n\ttime64_t suspend_at;\n\tstruct wiphy_work scan_done_wk;\n\n\tstruct genl_info *cur_cmd_info;\n\n\tstruct work_struct conn_work;\n\tstruct work_struct event_work;\n\n\tstruct delayed_work dfs_update_channels_wk;\n\n\tstruct wireless_dev *background_radar_wdev;\n\tstruct cfg80211_chan_def background_radar_chandef;\n\tstruct delayed_work background_cac_done_wk;\n\tstruct work_struct background_cac_abort_wk;\n\n\t \n\tu32 crit_proto_nlportid;\n\n\tstruct cfg80211_coalesce *coalesce;\n\n\tstruct work_struct destroy_work;\n\tstruct wiphy_work sched_scan_stop_wk;\n\tstruct work_struct sched_scan_res_wk;\n\n\tstruct cfg80211_chan_def radar_chandef;\n\tstruct work_struct propagate_radar_detect_wk;\n\n\tstruct cfg80211_chan_def cac_done_chandef;\n\tstruct work_struct propagate_cac_done_wk;\n\n\tstruct work_struct mgmt_registrations_update_wk;\n\t \n\tspinlock_t mgmt_registrations_lock;\n\n\tstruct work_struct wiphy_work;\n\tstruct list_head wiphy_work_list;\n\t \n\tspinlock_t wiphy_work_lock;\n\tbool suspended;\n\n\t \n\tstruct wiphy wiphy __aligned(NETDEV_ALIGN);\n};\n\nstatic inline\nstruct cfg80211_registered_device *wiphy_to_rdev(struct wiphy *wiphy)\n{\n\tBUG_ON(!wiphy);\n\treturn container_of(wiphy, struct cfg80211_registered_device, wiphy);\n}\n\nstatic inline void\ncfg80211_rdev_free_wowlan(struct cfg80211_registered_device *rdev)\n{\n#ifdef CONFIG_PM\n\tint i;\n\n\tif (!rdev->wiphy.wowlan_config)\n\t\treturn;\n\tfor (i = 0; i < rdev->wiphy.wowlan_config->n_patterns; i++)\n\t\tkfree(rdev->wiphy.wowlan_config->patterns[i].mask);\n\tkfree(rdev->wiphy.wowlan_config->patterns);\n\tif (rdev->wiphy.wowlan_config->tcp &&\n\t    rdev->wiphy.wowlan_config->tcp->sock)\n\t\tsock_release(rdev->wiphy.wowlan_config->tcp->sock);\n\tkfree(rdev->wiphy.wowlan_config->tcp);\n\tkfree(rdev->wiphy.wowlan_config->nd_config);\n\tkfree(rdev->wiphy.wowlan_config);\n#endif\n}\n\nstatic inline u64 cfg80211_assign_cookie(struct cfg80211_registered_device *rdev)\n{\n\tu64 r = ++rdev->cookie_counter;\n\n\tif (WARN_ON(r == 0))\n\t\tr = ++rdev->cookie_counter;\n\n\treturn r;\n}\n\nextern struct workqueue_struct *cfg80211_wq;\nextern struct list_head cfg80211_rdev_list;\nextern int cfg80211_rdev_list_generation;\n\nstruct cfg80211_internal_bss {\n\tstruct list_head list;\n\tstruct list_head hidden_list;\n\tstruct rb_node rbn;\n\tu64 ts_boottime;\n\tunsigned long ts;\n\tunsigned long refcount;\n\tatomic_t hold;\n\n\t \n\tu64 parent_tsf;\n\n\t \n\tu8 parent_bssid[ETH_ALEN] __aligned(2);\n\n\t \n\tstruct cfg80211_bss pub;\n};\n\nstatic inline struct cfg80211_internal_bss *bss_from_pub(struct cfg80211_bss *pub)\n{\n\treturn container_of(pub, struct cfg80211_internal_bss, pub);\n}\n\nstatic inline void cfg80211_hold_bss(struct cfg80211_internal_bss *bss)\n{\n\tatomic_inc(&bss->hold);\n\tif (bss->pub.transmitted_bss) {\n\t\tbss = container_of(bss->pub.transmitted_bss,\n\t\t\t\t   struct cfg80211_internal_bss, pub);\n\t\tatomic_inc(&bss->hold);\n\t}\n}\n\nstatic inline void cfg80211_unhold_bss(struct cfg80211_internal_bss *bss)\n{\n\tint r = atomic_dec_return(&bss->hold);\n\tWARN_ON(r < 0);\n\tif (bss->pub.transmitted_bss) {\n\t\tbss = container_of(bss->pub.transmitted_bss,\n\t\t\t\t   struct cfg80211_internal_bss, pub);\n\t\tr = atomic_dec_return(&bss->hold);\n\t\tWARN_ON(r < 0);\n\t}\n}\n\n\nstruct cfg80211_registered_device *cfg80211_rdev_by_wiphy_idx(int wiphy_idx);\nint get_wiphy_idx(struct wiphy *wiphy);\n\nstruct wiphy *wiphy_idx_to_wiphy(int wiphy_idx);\n\nint cfg80211_switch_netns(struct cfg80211_registered_device *rdev,\n\t\t\t  struct net *net);\n\nvoid cfg80211_init_wdev(struct wireless_dev *wdev);\nvoid cfg80211_register_wdev(struct cfg80211_registered_device *rdev,\n\t\t\t    struct wireless_dev *wdev);\n\nstatic inline void wdev_lock(struct wireless_dev *wdev)\n\t__acquires(wdev)\n{\n\tmutex_lock(&wdev->mtx);\n\t__acquire(wdev->mtx);\n}\n\nstatic inline void wdev_unlock(struct wireless_dev *wdev)\n\t__releases(wdev)\n{\n\t__release(wdev->mtx);\n\tmutex_unlock(&wdev->mtx);\n}\n\n#define ASSERT_WDEV_LOCK(wdev) lockdep_assert_held(&(wdev)->mtx)\n\nstatic inline bool cfg80211_has_monitors_only(struct cfg80211_registered_device *rdev)\n{\n\tlockdep_assert_held(&rdev->wiphy.mtx);\n\n\treturn rdev->num_running_ifaces == rdev->num_running_monitor_ifaces &&\n\t       rdev->num_running_ifaces > 0;\n}\n\nenum cfg80211_event_type {\n\tEVENT_CONNECT_RESULT,\n\tEVENT_ROAMED,\n\tEVENT_DISCONNECTED,\n\tEVENT_IBSS_JOINED,\n\tEVENT_STOPPED,\n\tEVENT_PORT_AUTHORIZED,\n};\n\nstruct cfg80211_event {\n\tstruct list_head list;\n\tenum cfg80211_event_type type;\n\n\tunion {\n\t\tstruct cfg80211_connect_resp_params cr;\n\t\tstruct cfg80211_roam_info rm;\n\t\tstruct {\n\t\t\tconst u8 *ie;\n\t\t\tsize_t ie_len;\n\t\t\tu16 reason;\n\t\t\tbool locally_generated;\n\t\t} dc;\n\t\tstruct {\n\t\t\tu8 bssid[ETH_ALEN];\n\t\t\tstruct ieee80211_channel *channel;\n\t\t} ij;\n\t\tstruct {\n\t\t\tu8 bssid[ETH_ALEN];\n\t\t\tconst u8 *td_bitmap;\n\t\t\tu8 td_bitmap_len;\n\t\t} pa;\n\t};\n};\n\nstruct cfg80211_cached_keys {\n\tstruct key_params params[4];\n\tu8 data[4][WLAN_KEY_LEN_WEP104];\n\tint def;\n};\n\nstruct cfg80211_beacon_registration {\n\tstruct list_head list;\n\tu32 nlportid;\n};\n\nstruct cfg80211_cqm_config {\n\tstruct rcu_head rcu_head;\n\tu32 rssi_hyst;\n\ts32 last_rssi_event_value;\n\tenum nl80211_cqm_rssi_threshold_event last_rssi_event_type;\n\tbool use_range_api;\n\tint n_rssi_thresholds;\n\ts32 rssi_thresholds[] __counted_by(n_rssi_thresholds);\n};\n\nvoid cfg80211_cqm_rssi_notify_work(struct wiphy *wiphy,\n\t\t\t\t   struct wiphy_work *work);\n\nvoid cfg80211_destroy_ifaces(struct cfg80211_registered_device *rdev);\n\n \nvoid cfg80211_dev_free(struct cfg80211_registered_device *rdev);\n\nint cfg80211_dev_rename(struct cfg80211_registered_device *rdev,\n\t\t\tchar *newname);\n\nvoid ieee80211_set_bitrate_flags(struct wiphy *wiphy);\n\nvoid cfg80211_bss_expire(struct cfg80211_registered_device *rdev);\nvoid cfg80211_bss_age(struct cfg80211_registered_device *rdev,\n                      unsigned long age_secs);\nvoid cfg80211_update_assoc_bss_entry(struct wireless_dev *wdev,\n\t\t\t\t     unsigned int link,\n\t\t\t\t     struct ieee80211_channel *channel);\n\n \nint __cfg80211_join_ibss(struct cfg80211_registered_device *rdev,\n\t\t\t struct net_device *dev,\n\t\t\t struct cfg80211_ibss_params *params,\n\t\t\t struct cfg80211_cached_keys *connkeys);\nvoid cfg80211_clear_ibss(struct net_device *dev, bool nowext);\nint __cfg80211_leave_ibss(struct cfg80211_registered_device *rdev,\n\t\t\t  struct net_device *dev, bool nowext);\nint cfg80211_leave_ibss(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev, bool nowext);\nvoid __cfg80211_ibss_joined(struct net_device *dev, const u8 *bssid,\n\t\t\t    struct ieee80211_channel *channel);\nint cfg80211_ibss_wext_join(struct cfg80211_registered_device *rdev,\n\t\t\t    struct wireless_dev *wdev);\n\n \nextern const struct mesh_config default_mesh_config;\nextern const struct mesh_setup default_mesh_setup;\nint __cfg80211_join_mesh(struct cfg80211_registered_device *rdev,\n\t\t\t struct net_device *dev,\n\t\t\t struct mesh_setup *setup,\n\t\t\t const struct mesh_config *conf);\nint __cfg80211_leave_mesh(struct cfg80211_registered_device *rdev,\n\t\t\t  struct net_device *dev);\nint cfg80211_leave_mesh(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev);\nint cfg80211_set_mesh_channel(struct cfg80211_registered_device *rdev,\n\t\t\t      struct wireless_dev *wdev,\n\t\t\t      struct cfg80211_chan_def *chandef);\n\n \nint __cfg80211_join_ocb(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev,\n\t\t\tstruct ocb_setup *setup);\nint cfg80211_join_ocb(struct cfg80211_registered_device *rdev,\n\t\t      struct net_device *dev,\n\t\t      struct ocb_setup *setup);\nint __cfg80211_leave_ocb(struct cfg80211_registered_device *rdev,\n\t\t\t struct net_device *dev);\nint cfg80211_leave_ocb(struct cfg80211_registered_device *rdev,\n\t\t       struct net_device *dev);\n\n \nint __cfg80211_stop_ap(struct cfg80211_registered_device *rdev,\n\t\t       struct net_device *dev, int link,\n\t\t       bool notify);\nint cfg80211_stop_ap(struct cfg80211_registered_device *rdev,\n\t\t     struct net_device *dev, int link,\n\t\t     bool notify);\n\n \nint cfg80211_mlme_auth(struct cfg80211_registered_device *rdev,\n\t\t       struct net_device *dev,\n\t\t       struct cfg80211_auth_request *req);\nint cfg80211_mlme_assoc(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev,\n\t\t\tstruct cfg80211_assoc_request *req);\nint cfg80211_mlme_deauth(struct cfg80211_registered_device *rdev,\n\t\t\t struct net_device *dev, const u8 *bssid,\n\t\t\t const u8 *ie, int ie_len, u16 reason,\n\t\t\t bool local_state_change);\nint cfg80211_mlme_disassoc(struct cfg80211_registered_device *rdev,\n\t\t\t   struct net_device *dev, const u8 *ap_addr,\n\t\t\t   const u8 *ie, int ie_len, u16 reason,\n\t\t\t   bool local_state_change);\nvoid cfg80211_mlme_down(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev);\nint cfg80211_mlme_register_mgmt(struct wireless_dev *wdev, u32 snd_pid,\n\t\t\t\tu16 frame_type, const u8 *match_data,\n\t\t\t\tint match_len, bool multicast_rx,\n\t\t\t\tstruct netlink_ext_ack *extack);\nvoid cfg80211_mgmt_registrations_update_wk(struct work_struct *wk);\nvoid cfg80211_mlme_unregister_socket(struct wireless_dev *wdev, u32 nlpid);\nvoid cfg80211_mlme_purge_registrations(struct wireless_dev *wdev);\nint cfg80211_mlme_mgmt_tx(struct cfg80211_registered_device *rdev,\n\t\t\t  struct wireless_dev *wdev,\n\t\t\t  struct cfg80211_mgmt_tx_params *params,\n\t\t\t  u64 *cookie);\nvoid cfg80211_oper_and_ht_capa(struct ieee80211_ht_cap *ht_capa,\n\t\t\t       const struct ieee80211_ht_cap *ht_capa_mask);\nvoid cfg80211_oper_and_vht_capa(struct ieee80211_vht_cap *vht_capa,\n\t\t\t\tconst struct ieee80211_vht_cap *vht_capa_mask);\n\n \nint cfg80211_connect(struct cfg80211_registered_device *rdev,\n\t\t     struct net_device *dev,\n\t\t     struct cfg80211_connect_params *connect,\n\t\t     struct cfg80211_cached_keys *connkeys,\n\t\t     const u8 *prev_bssid);\nvoid __cfg80211_connect_result(struct net_device *dev,\n\t\t\t       struct cfg80211_connect_resp_params *params,\n\t\t\t       bool wextev);\nvoid __cfg80211_disconnected(struct net_device *dev, const u8 *ie,\n\t\t\t     size_t ie_len, u16 reason, bool from_ap);\nint cfg80211_disconnect(struct cfg80211_registered_device *rdev,\n\t\t\tstruct net_device *dev, u16 reason,\n\t\t\tbool wextev);\nvoid __cfg80211_roamed(struct wireless_dev *wdev,\n\t\t       struct cfg80211_roam_info *info);\nvoid __cfg80211_port_authorized(struct wireless_dev *wdev, const u8 *bssid,\n\t\t\t\tconst u8 *td_bitmap, u8 td_bitmap_len);\nint cfg80211_mgd_wext_connect(struct cfg80211_registered_device *rdev,\n\t\t\t      struct wireless_dev *wdev);\nvoid cfg80211_autodisconnect_wk(struct work_struct *work);\n\n \nvoid cfg80211_conn_work(struct work_struct *work);\nvoid cfg80211_sme_scan_done(struct net_device *dev);\nbool cfg80211_sme_rx_assoc_resp(struct wireless_dev *wdev, u16 status);\nvoid cfg80211_sme_rx_auth(struct wireless_dev *wdev, const u8 *buf, size_t len);\nvoid cfg80211_sme_disassoc(struct wireless_dev *wdev);\nvoid cfg80211_sme_deauth(struct wireless_dev *wdev);\nvoid cfg80211_sme_auth_timeout(struct wireless_dev *wdev);\nvoid cfg80211_sme_assoc_timeout(struct wireless_dev *wdev);\nvoid cfg80211_sme_abandon_assoc(struct wireless_dev *wdev);\n\n \nbool cfg80211_supported_cipher_suite(struct wiphy *wiphy, u32 cipher);\nbool cfg80211_valid_key_idx(struct cfg80211_registered_device *rdev,\n\t\t\t    int key_idx, bool pairwise);\nint cfg80211_validate_key_settings(struct cfg80211_registered_device *rdev,\n\t\t\t\t   struct key_params *params, int key_idx,\n\t\t\t\t   bool pairwise, const u8 *mac_addr);\nvoid __cfg80211_scan_done(struct wiphy *wiphy, struct wiphy_work *wk);\nvoid ___cfg80211_scan_done(struct cfg80211_registered_device *rdev,\n\t\t\t   bool send_message);\nvoid cfg80211_add_sched_scan_req(struct cfg80211_registered_device *rdev,\n\t\t\t\t struct cfg80211_sched_scan_request *req);\nint cfg80211_sched_scan_req_possible(struct cfg80211_registered_device *rdev,\n\t\t\t\t     bool want_multi);\nvoid cfg80211_sched_scan_results_wk(struct work_struct *work);\nint cfg80211_stop_sched_scan_req(struct cfg80211_registered_device *rdev,\n\t\t\t\t struct cfg80211_sched_scan_request *req,\n\t\t\t\t bool driver_initiated);\nint __cfg80211_stop_sched_scan(struct cfg80211_registered_device *rdev,\n\t\t\t       u64 reqid, bool driver_initiated);\nvoid cfg80211_upload_connect_keys(struct wireless_dev *wdev);\nint cfg80211_change_iface(struct cfg80211_registered_device *rdev,\n\t\t\t  struct net_device *dev, enum nl80211_iftype ntype,\n\t\t\t  struct vif_params *params);\nvoid cfg80211_process_rdev_events(struct cfg80211_registered_device *rdev);\nvoid cfg80211_process_wiphy_works(struct cfg80211_registered_device *rdev,\n\t\t\t\t  struct wiphy_work *end);\nvoid cfg80211_process_wdev_events(struct wireless_dev *wdev);\n\nbool cfg80211_does_bw_fit_range(const struct ieee80211_freq_range *freq_range,\n\t\t\t\tu32 center_freq_khz, u32 bw_khz);\n\nint cfg80211_scan(struct cfg80211_registered_device *rdev);\n\nextern struct work_struct cfg80211_disconnect_work;\n\n \nbool cfg80211_chandef_dfs_usable(struct wiphy *wiphy,\n\t\t\t\t const struct cfg80211_chan_def *chandef);\n\nvoid cfg80211_set_dfs_state(struct wiphy *wiphy,\n\t\t\t    const struct cfg80211_chan_def *chandef,\n\t\t\t    enum nl80211_dfs_state dfs_state);\n\nvoid cfg80211_dfs_channels_update_work(struct work_struct *work);\n\nunsigned int\ncfg80211_chandef_dfs_cac_time(struct wiphy *wiphy,\n\t\t\t      const struct cfg80211_chan_def *chandef);\n\nvoid cfg80211_sched_dfs_chan_update(struct cfg80211_registered_device *rdev);\n\nint\ncfg80211_start_background_radar_detection(struct cfg80211_registered_device *rdev,\n\t\t\t\t\t  struct wireless_dev *wdev,\n\t\t\t\t\t  struct cfg80211_chan_def *chandef);\n\nvoid cfg80211_stop_background_radar_detection(struct wireless_dev *wdev);\n\nvoid cfg80211_background_cac_done_wk(struct work_struct *work);\n\nvoid cfg80211_background_cac_abort_wk(struct work_struct *work);\n\nbool cfg80211_any_wiphy_oper_chan(struct wiphy *wiphy,\n\t\t\t\t  struct ieee80211_channel *chan);\n\nbool cfg80211_beaconing_iface_active(struct wireless_dev *wdev);\n\nbool cfg80211_is_sub_chan(struct cfg80211_chan_def *chandef,\n\t\t\t  struct ieee80211_channel *chan,\n\t\t\t  bool primary_only);\nbool cfg80211_wdev_on_sub_chan(struct wireless_dev *wdev,\n\t\t\t       struct ieee80211_channel *chan,\n\t\t\t       bool primary_only);\n\nstatic inline unsigned int elapsed_jiffies_msecs(unsigned long start)\n{\n\tunsigned long end = jiffies;\n\n\tif (end >= start)\n\t\treturn jiffies_to_msecs(end - start);\n\n\treturn jiffies_to_msecs(end + (ULONG_MAX - start) + 1);\n}\n\nint cfg80211_set_monitor_channel(struct cfg80211_registered_device *rdev,\n\t\t\t\t struct cfg80211_chan_def *chandef);\n\nint ieee80211_get_ratemask(struct ieee80211_supported_band *sband,\n\t\t\t   const u8 *rates, unsigned int n_rates,\n\t\t\t   u32 *mask);\n\nint cfg80211_validate_beacon_int(struct cfg80211_registered_device *rdev,\n\t\t\t\t enum nl80211_iftype iftype, u32 beacon_int);\n\nvoid cfg80211_update_iface_num(struct cfg80211_registered_device *rdev,\n\t\t\t       enum nl80211_iftype iftype, int num);\n\nvoid __cfg80211_leave(struct cfg80211_registered_device *rdev,\n\t\t      struct wireless_dev *wdev);\nvoid cfg80211_leave(struct cfg80211_registered_device *rdev,\n\t\t    struct wireless_dev *wdev);\n\nvoid cfg80211_stop_p2p_device(struct cfg80211_registered_device *rdev,\n\t\t\t      struct wireless_dev *wdev);\n\nvoid cfg80211_stop_nan(struct cfg80211_registered_device *rdev,\n\t\t       struct wireless_dev *wdev);\n\nstruct cfg80211_internal_bss *\ncfg80211_bss_update(struct cfg80211_registered_device *rdev,\n\t\t    struct cfg80211_internal_bss *tmp,\n\t\t    bool signal_valid, unsigned long ts);\n#ifdef CONFIG_CFG80211_DEVELOPER_WARNINGS\n#define CFG80211_DEV_WARN_ON(cond)\tWARN_ON(cond)\n#else\n \n#define CFG80211_DEV_WARN_ON(cond)\t({bool __r = (cond); __r; })\n#endif\n\nvoid cfg80211_release_pmsr(struct wireless_dev *wdev, u32 portid);\nvoid cfg80211_pmsr_wdev_down(struct wireless_dev *wdev);\nvoid cfg80211_pmsr_free_wk(struct work_struct *work);\n\nvoid cfg80211_remove_link(struct wireless_dev *wdev, unsigned int link_id);\nvoid cfg80211_remove_links(struct wireless_dev *wdev);\nint cfg80211_remove_virtual_intf(struct cfg80211_registered_device *rdev,\n\t\t\t\t struct wireless_dev *wdev);\nvoid cfg80211_wdev_release_link_bsses(struct wireless_dev *wdev, u16 link_mask);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}