{
  "module_name": "wext-proc.c",
  "hash_id": "adf5929268aacb2ef4ed83a97b18845e3235d1c2cad7f05241ed5561fd806327",
  "original_prompt": "Ingested from linux-6.6.14/net/wireless/wext-proc.c",
  "human_readable_source": " \n\n \n\n#include <linux/module.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/wireless.h>\n#include <linux/netdevice.h>\n#include <linux/rtnetlink.h>\n#include <net/iw_handler.h>\n#include <net/wext.h>\n\n\nstatic void wireless_seq_printf_stats(struct seq_file *seq,\n\t\t\t\t      struct net_device *dev)\n{\n\t \n\tstruct iw_statistics *stats = get_wireless_stats(dev);\n\tstatic struct iw_statistics nullstats = {};\n\n\t \n\tif (!stats) {\n#ifdef CONFIG_WIRELESS_EXT\n\t\tif (dev->wireless_handlers)\n\t\t\tstats = &nullstats;\n#endif\n#ifdef CONFIG_CFG80211\n\t\tif (dev->ieee80211_ptr)\n\t\t\tstats = &nullstats;\n#endif\n\t}\n\n\tif (stats) {\n\t\tseq_printf(seq, \"%6s: %04x  %3d%c  %3d%c  %3d%c  %6d %6d %6d \"\n\t\t\t\t\"%6d %6d   %6d\\n\",\n\t\t\t   dev->name, stats->status, stats->qual.qual,\n\t\t\t   stats->qual.updated & IW_QUAL_QUAL_UPDATED\n\t\t\t   ? '.' : ' ',\n\t\t\t   ((__s32) stats->qual.level) -\n\t\t\t   ((stats->qual.updated & IW_QUAL_DBM) ? 0x100 : 0),\n\t\t\t   stats->qual.updated & IW_QUAL_LEVEL_UPDATED\n\t\t\t   ? '.' : ' ',\n\t\t\t   ((__s32) stats->qual.noise) -\n\t\t\t   ((stats->qual.updated & IW_QUAL_DBM) ? 0x100 : 0),\n\t\t\t   stats->qual.updated & IW_QUAL_NOISE_UPDATED\n\t\t\t   ? '.' : ' ',\n\t\t\t   stats->discard.nwid, stats->discard.code,\n\t\t\t   stats->discard.fragment, stats->discard.retries,\n\t\t\t   stats->discard.misc, stats->miss.beacon);\n\n\t\tif (stats != &nullstats)\n\t\t\tstats->qual.updated &= ~IW_QUAL_ALL_UPDATED;\n\t}\n}\n\n \n \nstatic int wireless_dev_seq_show(struct seq_file *seq, void *v)\n{\n\tmight_sleep();\n\n\tif (v == SEQ_START_TOKEN)\n\t\tseq_printf(seq, \"Inter-| sta-|   Quality        |   Discarded \"\n\t\t\t\t\"packets               | Missed | WE\\n\"\n\t\t\t\t\" face | tus | link level noise |  nwid  \"\n\t\t\t\t\"crypt   frag  retry   misc | beacon | %d\\n\",\n\t\t\t   WIRELESS_EXT);\n\telse\n\t\twireless_seq_printf_stats(seq, v);\n\treturn 0;\n}\n\nstatic void *wireless_dev_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct net *net = seq_file_net(seq);\n\tloff_t off;\n\tstruct net_device *dev;\n\n\trtnl_lock();\n\tif (!*pos)\n\t\treturn SEQ_START_TOKEN;\n\n\toff = 1;\n\tfor_each_netdev(net, dev)\n\t\tif (off++ == *pos)\n\t\t\treturn dev;\n\treturn NULL;\n}\n\nstatic void *wireless_dev_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct net *net = seq_file_net(seq);\n\n\t++*pos;\n\n\treturn v == SEQ_START_TOKEN ?\n\t\tfirst_net_device(net) : next_net_device(v);\n}\n\nstatic void wireless_dev_seq_stop(struct seq_file *seq, void *v)\n{\n\trtnl_unlock();\n}\n\nstatic const struct seq_operations wireless_seq_ops = {\n\t.start = wireless_dev_seq_start,\n\t.next  = wireless_dev_seq_next,\n\t.stop  = wireless_dev_seq_stop,\n\t.show  = wireless_dev_seq_show,\n};\n\nint __net_init wext_proc_init(struct net *net)\n{\n\t \n\tif (!proc_create_net(\"wireless\", 0444, net->proc_net,\n\t\t\t&wireless_seq_ops, sizeof(struct seq_net_private)))\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}\n\nvoid __net_exit wext_proc_exit(struct net *net)\n{\n\tremove_proc_entry(\"wireless\", net->proc_net);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}