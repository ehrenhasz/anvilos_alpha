{
  "module_name": "internal.h",
  "hash_id": "a80b737a6e7f2df8ed47cd010eae8e0efed4c755add2aeeaa9ab9331824c8d42",
  "original_prompt": "Ingested from linux-6.6.14/net/ncsi/internal.h",
  "human_readable_source": " \n \n\n#ifndef __NCSI_INTERNAL_H__\n#define __NCSI_INTERNAL_H__\n\nenum {\n\tNCSI_CAP_BASE\t\t= 0,\n\tNCSI_CAP_GENERIC\t= 0,\n\tNCSI_CAP_BC,\n\tNCSI_CAP_MC,\n\tNCSI_CAP_BUFFER,\n\tNCSI_CAP_AEN,\n\tNCSI_CAP_VLAN,\n\tNCSI_CAP_MAX\n};\n\nenum {\n\tNCSI_CAP_GENERIC_HWA             = 0x01,  \n\tNCSI_CAP_GENERIC_HDS             = 0x02,  \n\tNCSI_CAP_GENERIC_FC              = 0x04,  \n\tNCSI_CAP_GENERIC_FC1             = 0x08,  \n\tNCSI_CAP_GENERIC_MC              = 0x10,  \n\tNCSI_CAP_GENERIC_HWA_UNKNOWN     = 0x00,  \n\tNCSI_CAP_GENERIC_HWA_SUPPORT     = 0x20,  \n\tNCSI_CAP_GENERIC_HWA_NOT_SUPPORT = 0x40,  \n\tNCSI_CAP_GENERIC_HWA_RESERVED    = 0x60,  \n\tNCSI_CAP_GENERIC_HWA_MASK        = 0x60,  \n\tNCSI_CAP_GENERIC_MASK            = 0x7f,\n\tNCSI_CAP_BC_ARP                  = 0x01,  \n\tNCSI_CAP_BC_DHCPC                = 0x02,  \n\tNCSI_CAP_BC_DHCPS                = 0x04,  \n\tNCSI_CAP_BC_NETBIOS              = 0x08,  \n\tNCSI_CAP_BC_MASK                 = 0x0f,\n\tNCSI_CAP_MC_IPV6_NEIGHBOR        = 0x01,  \n\tNCSI_CAP_MC_IPV6_ROUTER          = 0x02,  \n\tNCSI_CAP_MC_DHCPV6_RELAY         = 0x04,  \n\tNCSI_CAP_MC_DHCPV6_WELL_KNOWN    = 0x08,  \n\tNCSI_CAP_MC_IPV6_MLD             = 0x10,  \n\tNCSI_CAP_MC_IPV6_NEIGHBOR_S      = 0x20,  \n\tNCSI_CAP_MC_MASK                 = 0x3f,\n\tNCSI_CAP_AEN_LSC                 = 0x01,  \n\tNCSI_CAP_AEN_CR                  = 0x02,  \n\tNCSI_CAP_AEN_HDS                 = 0x04,  \n\tNCSI_CAP_AEN_MASK                = 0x07,\n\tNCSI_CAP_VLAN_ONLY               = 0x01,  \n\tNCSI_CAP_VLAN_NO                 = 0x02,  \n\tNCSI_CAP_VLAN_ANY                = 0x04,  \n\tNCSI_CAP_VLAN_MASK               = 0x07\n};\n\nenum {\n\tNCSI_MODE_BASE\t\t= 0,\n\tNCSI_MODE_ENABLE\t= 0,\n\tNCSI_MODE_TX_ENABLE,\n\tNCSI_MODE_LINK,\n\tNCSI_MODE_VLAN,\n\tNCSI_MODE_BC,\n\tNCSI_MODE_MC,\n\tNCSI_MODE_AEN,\n\tNCSI_MODE_FC,\n\tNCSI_MODE_MAX\n};\n\n \nenum {\n\tMLX_MC_RBT_SUPPORT  = 0x01,  \n\tMLX_MC_RBT_AVL      = 0x08,  \n};\n\n \n#define NCSI_OEM_MFR_MLX_ID             0x8119\n#define NCSI_OEM_MFR_BCM_ID             0x113d\n#define NCSI_OEM_MFR_INTEL_ID           0x157\n \n#define NCSI_OEM_INTEL_CMD_GMA          0x06    \n#define NCSI_OEM_INTEL_CMD_KEEP_PHY     0x20    \n \n#define NCSI_OEM_BCM_CMD_GMA            0x01    \n \n#define NCSI_OEM_MLX_CMD_GMA            0x00    \n#define NCSI_OEM_MLX_CMD_GMA_PARAM      0x1b    \n#define NCSI_OEM_MLX_CMD_SMAF           0x01    \n#define NCSI_OEM_MLX_CMD_SMAF_PARAM     0x07    \n \n#define NCSI_OEM_INTEL_CMD_GMA_LEN      5\n#define NCSI_OEM_INTEL_CMD_KEEP_PHY_LEN 7\n#define NCSI_OEM_BCM_CMD_GMA_LEN        12\n#define NCSI_OEM_MLX_CMD_GMA_LEN        8\n#define NCSI_OEM_MLX_CMD_SMAF_LEN        60\n \n#define MLX_SMAF_MAC_ADDR_OFFSET         8      \n#define MLX_SMAF_MED_SUPPORT_OFFSET      14     \n \n#define BCM_MAC_ADDR_OFFSET             28\n#define MLX_MAC_ADDR_OFFSET             8\n#define INTEL_MAC_ADDR_OFFSET           1\n\n\nstruct ncsi_channel_version {\n\tu8   major;\t\t \n\tu8   minor;\t\t \n\tu8   update;\t\t \n\tchar alpha1;\t\t \n\tchar alpha2;\t\t \n\tu8  fw_name[12];\t \n\tu32 fw_version;\t\t \n\tu16 pci_ids[4];\t\t \n\tu32 mf_id;\t\t \n};\n\nstruct ncsi_channel_cap {\n\tu32 index;\t \n\tu32 cap;\t \n};\n\nstruct ncsi_channel_mode {\n\tu32 index;\t \n\tu32 enable;\t \n\tu32 size;\t \n\tu32 data[8];\t \n};\n\nstruct ncsi_channel_mac_filter {\n\tu8\tn_uc;\n\tu8\tn_mc;\n\tu8\tn_mixed;\n\tu64\tbitmap;\n\tunsigned char\t*addrs;\n};\n\nstruct ncsi_channel_vlan_filter {\n\tu8\tn_vids;\n\tu64\tbitmap;\n\tu16\t*vids;\n};\n\nstruct ncsi_channel_stats {\n\tu32 hnc_cnt_hi;\t\t \n\tu32 hnc_cnt_lo;\t\t \n\tu32 hnc_rx_bytes;\t \n\tu32 hnc_tx_bytes;\t \n\tu32 hnc_rx_uc_pkts;\t \n\tu32 hnc_rx_mc_pkts;      \n\tu32 hnc_rx_bc_pkts;\t \n\tu32 hnc_tx_uc_pkts;\t \n\tu32 hnc_tx_mc_pkts;\t \n\tu32 hnc_tx_bc_pkts;\t \n\tu32 hnc_fcs_err;\t \n\tu32 hnc_align_err;\t \n\tu32 hnc_false_carrier;\t \n\tu32 hnc_runt_pkts;\t \n\tu32 hnc_jabber_pkts;\t \n\tu32 hnc_rx_pause_xon;\t \n\tu32 hnc_rx_pause_xoff;\t \n\tu32 hnc_tx_pause_xon;\t \n\tu32 hnc_tx_pause_xoff;\t \n\tu32 hnc_tx_s_collision;\t \n\tu32 hnc_tx_m_collision;\t \n\tu32 hnc_l_collision;\t \n\tu32 hnc_e_collision;\t \n\tu32 hnc_rx_ctl_frames;\t \n\tu32 hnc_rx_64_frames;\t \n\tu32 hnc_rx_127_frames;\t \n\tu32 hnc_rx_255_frames;\t \n\tu32 hnc_rx_511_frames;\t \n\tu32 hnc_rx_1023_frames;\t \n\tu32 hnc_rx_1522_frames;\t \n\tu32 hnc_rx_9022_frames;\t \n\tu32 hnc_tx_64_frames;\t \n\tu32 hnc_tx_127_frames;\t \n\tu32 hnc_tx_255_frames;\t \n\tu32 hnc_tx_511_frames;\t \n\tu32 hnc_tx_1023_frames;\t \n\tu32 hnc_tx_1522_frames;\t \n\tu32 hnc_tx_9022_frames;\t \n\tu32 hnc_rx_valid_bytes;\t \n\tu32 hnc_rx_runt_pkts;\t \n\tu32 hnc_rx_jabber_pkts;\t \n\tu32 ncsi_rx_cmds;\t \n\tu32 ncsi_dropped_cmds;\t \n\tu32 ncsi_cmd_type_errs;\t \n\tu32 ncsi_cmd_csum_errs;\t \n\tu32 ncsi_rx_pkts;\t \n\tu32 ncsi_tx_pkts;\t \n\tu32 ncsi_tx_aen_pkts;\t \n\tu32 pt_tx_pkts;\t\t \n\tu32 pt_tx_dropped;\t \n\tu32 pt_tx_channel_err;\t \n\tu32 pt_tx_us_err;\t \n\tu32 pt_rx_pkts;\t\t \n\tu32 pt_rx_dropped;\t \n\tu32 pt_rx_channel_err;\t \n\tu32 pt_rx_us_err;\t \n\tu32 pt_rx_os_err;\t \n};\n\nstruct ncsi_dev_priv;\nstruct ncsi_package;\n\n#define NCSI_PACKAGE_SHIFT\t5\n#define NCSI_PACKAGE_INDEX(c)\t(((c) >> NCSI_PACKAGE_SHIFT) & 0x7)\n#define NCSI_RESERVED_CHANNEL\t0x1f\n#define NCSI_CHANNEL_INDEX(c)\t((c) & ((1 << NCSI_PACKAGE_SHIFT) - 1))\n#define NCSI_TO_CHANNEL(p, c)\t(((p) << NCSI_PACKAGE_SHIFT) | (c))\n#define NCSI_MAX_PACKAGE\t8\n#define NCSI_MAX_CHANNEL\t32\n\nstruct ncsi_channel {\n\tunsigned char               id;\n\tint                         state;\n#define NCSI_CHANNEL_INACTIVE\t\t1\n#define NCSI_CHANNEL_ACTIVE\t\t2\n#define NCSI_CHANNEL_INVISIBLE\t\t3\n\tbool                        reconfigure_needed;\n\tspinlock_t                  lock;\t \n\tstruct ncsi_package         *package;\n\tstruct ncsi_channel_version version;\n\tstruct ncsi_channel_cap\t    caps[NCSI_CAP_MAX];\n\tstruct ncsi_channel_mode    modes[NCSI_MODE_MAX];\n\t \n\tstruct ncsi_channel_mac_filter\tmac_filter;\n\tstruct ncsi_channel_vlan_filter\tvlan_filter;\n\tstruct ncsi_channel_stats   stats;\n\tstruct {\n\t\tstruct timer_list   timer;\n\t\tbool                enabled;\n\t\tunsigned int        state;\n#define NCSI_CHANNEL_MONITOR_START\t0\n#define NCSI_CHANNEL_MONITOR_RETRY\t1\n#define NCSI_CHANNEL_MONITOR_WAIT\t2\n#define NCSI_CHANNEL_MONITOR_WAIT_MAX\t5\n\t} monitor;\n\tstruct list_head            node;\n\tstruct list_head            link;\n};\n\nstruct ncsi_package {\n\tunsigned char        id;           \n\tunsigned char        uuid[16];     \n\tstruct ncsi_dev_priv *ndp;         \n\tspinlock_t           lock;         \n\tunsigned int         channel_num;  \n\tstruct list_head     channels;     \n\tstruct list_head     node;         \n\n\tbool                 multi_channel;  \n\tu32                  channel_whitelist;  \n\tstruct ncsi_channel  *preferred_channel;  \n};\n\nstruct ncsi_request {\n\tunsigned char        id;       \n\tbool                 used;     \n\tunsigned int         flags;    \n#define NCSI_REQ_FLAG_EVENT_DRIVEN\t1\n#define NCSI_REQ_FLAG_NETLINK_DRIVEN\t2\n\tstruct ncsi_dev_priv *ndp;     \n\tstruct sk_buff       *cmd;     \n\tstruct sk_buff       *rsp;     \n\tstruct timer_list    timer;    \n\tbool                 enabled;  \n\tu32                  snd_seq;      \n\tu32                  snd_portid;   \n\tstruct nlmsghdr      nlhdr;        \n};\n\nenum {\n\tncsi_dev_state_major\t\t= 0xff00,\n\tncsi_dev_state_minor\t\t= 0x00ff,\n\tncsi_dev_state_probe_deselect\t= 0x0201,\n\tncsi_dev_state_probe_package,\n\tncsi_dev_state_probe_channel,\n\tncsi_dev_state_probe_mlx_gma,\n\tncsi_dev_state_probe_mlx_smaf,\n\tncsi_dev_state_probe_cis,\n\tncsi_dev_state_probe_keep_phy,\n\tncsi_dev_state_probe_gvi,\n\tncsi_dev_state_probe_gc,\n\tncsi_dev_state_probe_gls,\n\tncsi_dev_state_probe_dp,\n\tncsi_dev_state_config_sp\t= 0x0301,\n\tncsi_dev_state_config_cis,\n\tncsi_dev_state_config_oem_gma,\n\tncsi_dev_state_config_clear_vids,\n\tncsi_dev_state_config_svf,\n\tncsi_dev_state_config_ev,\n\tncsi_dev_state_config_sma,\n\tncsi_dev_state_config_ebf,\n\tncsi_dev_state_config_dgmf,\n\tncsi_dev_state_config_ecnt,\n\tncsi_dev_state_config_ec,\n\tncsi_dev_state_config_ae,\n\tncsi_dev_state_config_gls,\n\tncsi_dev_state_config_done,\n\tncsi_dev_state_suspend_select\t= 0x0401,\n\tncsi_dev_state_suspend_gls,\n\tncsi_dev_state_suspend_dcnt,\n\tncsi_dev_state_suspend_dc,\n\tncsi_dev_state_suspend_deselect,\n\tncsi_dev_state_suspend_done\n};\n\nstruct vlan_vid {\n\tstruct list_head list;\n\t__be16 proto;\n\tu16 vid;\n};\n\nstruct ncsi_dev_priv {\n\tstruct ncsi_dev     ndev;             \n\tunsigned int        flags;            \n#define NCSI_DEV_PROBED\t\t1             \n#define NCSI_DEV_HWA\t\t2             \n#define NCSI_DEV_RESHUFFLE\t4\n#define NCSI_DEV_RESET\t\t8             \n\tunsigned int        gma_flag;         \n\tspinlock_t          lock;             \n\tunsigned int        package_probe_id; \n\tunsigned int        package_num;      \n\tstruct list_head    packages;         \n\tstruct ncsi_channel *hot_channel;     \n\tstruct ncsi_request requests[256];    \n\tunsigned int        request_id;       \n#define NCSI_REQ_START_IDX\t1\n\tunsigned int        pending_req_num;  \n\tstruct ncsi_package *active_package;  \n\tstruct ncsi_channel *active_channel;  \n\tstruct list_head    channel_queue;    \n\tstruct work_struct  work;             \n\tstruct packet_type  ptype;            \n\tstruct list_head    node;             \n#define NCSI_MAX_VLAN_VIDS\t15\n\tstruct list_head    vlan_vids;        \n\n\tbool                multi_package;    \n\tbool                mlx_multi_host;   \n\tu32                 package_whitelist;  \n};\n\nstruct ncsi_cmd_arg {\n\tstruct ncsi_dev_priv *ndp;         \n\tunsigned char        type;         \n\tunsigned char        id;           \n\tunsigned char        package;      \n\tunsigned char        channel;      \n\tunsigned short       payload;      \n\tunsigned int         req_flags;    \n\tunion {\n\t\tunsigned char  bytes[16];  \n\t\tunsigned short words[8];\n\t\tunsigned int   dwords[4];\n\t};\n\tunsigned char        *data;        \n\tstruct genl_info     *info;        \n};\n\nextern struct list_head ncsi_dev_list;\nextern spinlock_t ncsi_dev_lock;\n\n#define TO_NCSI_DEV_PRIV(nd) \\\n\tcontainer_of(nd, struct ncsi_dev_priv, ndev)\n#define NCSI_FOR_EACH_DEV(ndp) \\\n\tlist_for_each_entry_rcu(ndp, &ncsi_dev_list, node)\n#define NCSI_FOR_EACH_PACKAGE(ndp, np) \\\n\tlist_for_each_entry_rcu(np, &ndp->packages, node)\n#define NCSI_FOR_EACH_CHANNEL(np, nc) \\\n\tlist_for_each_entry_rcu(nc, &np->channels, node)\n\n \nint ncsi_reset_dev(struct ncsi_dev *nd);\nvoid ncsi_start_channel_monitor(struct ncsi_channel *nc);\nvoid ncsi_stop_channel_monitor(struct ncsi_channel *nc);\nstruct ncsi_channel *ncsi_find_channel(struct ncsi_package *np,\n\t\t\t\t       unsigned char id);\nstruct ncsi_channel *ncsi_add_channel(struct ncsi_package *np,\n\t\t\t\t      unsigned char id);\nstruct ncsi_package *ncsi_find_package(struct ncsi_dev_priv *ndp,\n\t\t\t\t       unsigned char id);\nstruct ncsi_package *ncsi_add_package(struct ncsi_dev_priv *ndp,\n\t\t\t\t      unsigned char id);\nvoid ncsi_remove_package(struct ncsi_package *np);\nvoid ncsi_find_package_and_channel(struct ncsi_dev_priv *ndp,\n\t\t\t\t   unsigned char id,\n\t\t\t\t   struct ncsi_package **np,\n\t\t\t\t   struct ncsi_channel **nc);\nstruct ncsi_request *ncsi_alloc_request(struct ncsi_dev_priv *ndp,\n\t\t\t\t\tunsigned int req_flags);\nvoid ncsi_free_request(struct ncsi_request *nr);\nstruct ncsi_dev *ncsi_find_dev(struct net_device *dev);\nint ncsi_process_next_channel(struct ncsi_dev_priv *ndp);\nbool ncsi_channel_has_link(struct ncsi_channel *channel);\nbool ncsi_channel_is_last(struct ncsi_dev_priv *ndp,\n\t\t\t  struct ncsi_channel *channel);\nint ncsi_update_tx_channel(struct ncsi_dev_priv *ndp,\n\t\t\t   struct ncsi_package *np,\n\t\t\t   struct ncsi_channel *disable,\n\t\t\t   struct ncsi_channel *enable);\n\n \nu32 ncsi_calculate_checksum(unsigned char *data, int len);\nint ncsi_xmit_cmd(struct ncsi_cmd_arg *nca);\nint ncsi_rcv_rsp(struct sk_buff *skb, struct net_device *dev,\n\t\t struct packet_type *pt, struct net_device *orig_dev);\nint ncsi_aen_handler(struct ncsi_dev_priv *ndp, struct sk_buff *skb);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}