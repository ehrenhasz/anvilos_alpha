{
  "module_name": "vlan_mvrp.c",
  "hash_id": "3a164dd769c4eafb26dc81cd78068126972838d8bce233726239ac3d39eea85e",
  "original_prompt": "Ingested from linux-6.6.14/net/8021q/vlan_mvrp.c",
  "human_readable_source": "\n \n#include <linux/types.h>\n#include <linux/if_ether.h>\n#include <linux/if_vlan.h>\n#include <net/mrp.h>\n#include \"vlan.h\"\n\n#define MRP_MVRP_ADDRESS\t{ 0x01, 0x80, 0xc2, 0x00, 0x00, 0x21 }\n\nenum mvrp_attributes {\n\tMVRP_ATTR_INVALID,\n\tMVRP_ATTR_VID,\n\t__MVRP_ATTR_MAX\n};\n#define MVRP_ATTR_MAX\t(__MVRP_ATTR_MAX - 1)\n\nstatic struct mrp_application vlan_mrp_app __read_mostly = {\n\t.type\t\t= MRP_APPLICATION_MVRP,\n\t.maxattr\t= MVRP_ATTR_MAX,\n\t.pkttype.type\t= htons(ETH_P_MVRP),\n\t.group_address\t= MRP_MVRP_ADDRESS,\n\t.version\t= 0,\n};\n\nint vlan_mvrp_request_join(const struct net_device *dev)\n{\n\tconst struct vlan_dev_priv *vlan = vlan_dev_priv(dev);\n\t__be16 vlan_id = htons(vlan->vlan_id);\n\n\tif (vlan->vlan_proto != htons(ETH_P_8021Q))\n\t\treturn 0;\n\treturn mrp_request_join(vlan->real_dev, &vlan_mrp_app,\n\t\t\t\t&vlan_id, sizeof(vlan_id), MVRP_ATTR_VID);\n}\n\nvoid vlan_mvrp_request_leave(const struct net_device *dev)\n{\n\tconst struct vlan_dev_priv *vlan = vlan_dev_priv(dev);\n\t__be16 vlan_id = htons(vlan->vlan_id);\n\n\tif (vlan->vlan_proto != htons(ETH_P_8021Q))\n\t\treturn;\n\tmrp_request_leave(vlan->real_dev, &vlan_mrp_app,\n\t\t\t  &vlan_id, sizeof(vlan_id), MVRP_ATTR_VID);\n}\n\nint vlan_mvrp_init_applicant(struct net_device *dev)\n{\n\treturn mrp_init_applicant(dev, &vlan_mrp_app);\n}\n\nvoid vlan_mvrp_uninit_applicant(struct net_device *dev)\n{\n\tmrp_uninit_applicant(dev, &vlan_mrp_app);\n}\n\nint __init vlan_mvrp_init(void)\n{\n\treturn mrp_register_application(&vlan_mrp_app);\n}\n\nvoid vlan_mvrp_uninit(void)\n{\n\tmrp_unregister_application(&vlan_mrp_app);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}