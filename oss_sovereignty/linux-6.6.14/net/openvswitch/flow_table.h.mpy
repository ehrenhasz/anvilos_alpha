{
  "module_name": "flow_table.h",
  "hash_id": "0bfb19121f965ef0654da3912b4f8b0aeec17f65fee37fc634241661aebe5b6e",
  "original_prompt": "Ingested from linux-6.6.14/net/openvswitch/flow_table.h",
  "human_readable_source": " \n \n\n#ifndef FLOW_TABLE_H\n#define FLOW_TABLE_H 1\n\n#include <linux/kernel.h>\n#include <linux/netlink.h>\n#include <linux/openvswitch.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/rcupdate.h>\n#include <linux/if_ether.h>\n#include <linux/in6.h>\n#include <linux/jiffies.h>\n#include <linux/time.h>\n\n#include <net/inet_ecn.h>\n#include <net/ip_tunnels.h>\n\n#include \"flow.h\"\n\nstruct mask_cache_entry {\n\tu32 skb_hash;\n\tu32 mask_index;\n};\n\nstruct mask_cache {\n\tstruct rcu_head rcu;\n\tu32 cache_size;   \n\tstruct mask_cache_entry __percpu *mask_cache;\n};\n\nstruct mask_count {\n\tint index;\n\tu64 counter;\n};\n\nstruct mask_array_stats {\n\tstruct u64_stats_sync syncp;\n\tu64 usage_cntrs[];\n};\n\nstruct mask_array {\n\tstruct rcu_head rcu;\n\tint count, max;\n\tstruct mask_array_stats __percpu *masks_usage_stats;\n\tu64 *masks_usage_zero_cntr;\n\tstruct sw_flow_mask __rcu *masks[];\n};\n\nstruct table_instance {\n\tstruct hlist_head *buckets;\n\tunsigned int n_buckets;\n\tstruct rcu_head rcu;\n\tint node_ver;\n\tu32 hash_seed;\n};\n\nstruct flow_table {\n\tstruct table_instance __rcu *ti;\n\tstruct table_instance __rcu *ufid_ti;\n\tstruct mask_cache __rcu *mask_cache;\n\tstruct mask_array __rcu *mask_array;\n\tunsigned long last_rehash;\n\tunsigned int count;\n\tunsigned int ufid_count;\n};\n\nextern struct kmem_cache *flow_stats_cache;\n\nint ovs_flow_init(void);\nvoid ovs_flow_exit(void);\n\nstruct sw_flow *ovs_flow_alloc(void);\nvoid ovs_flow_free(struct sw_flow *, bool deferred);\n\nint ovs_flow_tbl_init(struct flow_table *);\nint ovs_flow_tbl_count(const struct flow_table *table);\nvoid ovs_flow_tbl_destroy(struct flow_table *table);\nint ovs_flow_tbl_flush(struct flow_table *flow_table);\n\nint ovs_flow_tbl_insert(struct flow_table *table, struct sw_flow *flow,\n\t\t\tconst struct sw_flow_mask *mask);\nvoid ovs_flow_tbl_remove(struct flow_table *table, struct sw_flow *flow);\nint  ovs_flow_tbl_num_masks(const struct flow_table *table);\nu32  ovs_flow_tbl_masks_cache_size(const struct flow_table *table);\nint  ovs_flow_tbl_masks_cache_resize(struct flow_table *table, u32 size);\nstruct sw_flow *ovs_flow_tbl_dump_next(struct table_instance *table,\n\t\t\t\t       u32 *bucket, u32 *idx);\nstruct sw_flow *ovs_flow_tbl_lookup_stats(struct flow_table *,\n\t\t\t\t\t  const struct sw_flow_key *,\n\t\t\t\t\t  u32 skb_hash,\n\t\t\t\t\t  u32 *n_mask_hit,\n\t\t\t\t\t  u32 *n_cache_hit);\nstruct sw_flow *ovs_flow_tbl_lookup(struct flow_table *,\n\t\t\t\t    const struct sw_flow_key *);\nstruct sw_flow *ovs_flow_tbl_lookup_exact(struct flow_table *tbl,\n\t\t\t\t\t  const struct sw_flow_match *match);\nstruct sw_flow *ovs_flow_tbl_lookup_ufid(struct flow_table *,\n\t\t\t\t\t const struct sw_flow_id *);\n\nbool ovs_flow_cmp(const struct sw_flow *, const struct sw_flow_match *);\n\nvoid ovs_flow_mask_key(struct sw_flow_key *dst, const struct sw_flow_key *src,\n\t\t       bool full, const struct sw_flow_mask *mask);\n\nvoid ovs_flow_masks_rebalance(struct flow_table *table);\nvoid table_instance_flow_flush(struct flow_table *table,\n\t\t\t       struct table_instance *ti,\n\t\t\t       struct table_instance *ufid_ti);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}