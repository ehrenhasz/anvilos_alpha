{
  "module_name": "feat.h",
  "hash_id": "f05cc6ea4bd6e1da9f45ea67926d3473703dbf01154efdd093955b7b22e54ed7",
  "original_prompt": "Ingested from linux-6.6.14/net/dccp/feat.h",
  "human_readable_source": " \n#ifndef _DCCP_FEAT_H\n#define _DCCP_FEAT_H\n \n#include <linux/types.h>\n#include \"dccp.h\"\n\n \n \n#define DCCPF_ACK_RATIO_MAX\t0xFFFF\n \n#define DCCPF_SEQ_WMIN\t\t32\n#define DCCPF_SEQ_WMAX\t\t0x3FFFFFFFFFFFull\n \n#define DCCP_FEAT_MAX_SP_VALS\t(DCCP_SINGLE_OPT_MAXLEN - 2)\n\nenum dccp_feat_type {\n\tFEAT_AT_RX   = 1,\t \n\tFEAT_AT_TX   = 2,\t \n\tFEAT_SP      = 4,\t \n\tFEAT_NN\t     = 8,\t \n\tFEAT_UNKNOWN = 0xFF\t \n};\n\nenum dccp_feat_state {\n\tFEAT_DEFAULT = 0,\t \n\tFEAT_INITIALISING,\t \n\tFEAT_CHANGING,\t\t \n\tFEAT_UNSTABLE,\t\t \n\tFEAT_STABLE\t\t \n};\n\n \ntypedef union {\n\tu64 nn;\n\tstruct {\n\t\tu8\t*vec;\n\t\tu8\tlen;\n\t}   sp;\n} dccp_feat_val;\n\n \nstruct dccp_feat_entry {\n\tdccp_feat_val           val;\n\tenum dccp_feat_state    state:8;\n\tu8                      feat_num;\n\n\tbool\t\t\tneeds_mandatory,\n\t\t\t\tneeds_confirm,\n\t\t\t\tempty_confirm,\n\t\t\t\tis_local;\n\n\tstruct list_head\tnode;\n};\n\nstatic inline u8 dccp_feat_genopt(struct dccp_feat_entry *entry)\n{\n\tif (entry->needs_confirm)\n\t\treturn entry->is_local ? DCCPO_CONFIRM_L : DCCPO_CONFIRM_R;\n\treturn entry->is_local ? DCCPO_CHANGE_L : DCCPO_CHANGE_R;\n}\n\n \nstruct ccid_dependency {\n\tu8\tdependent_feat;\n\tbool\tis_local:1,\n\t\tis_mandatory:1;\n\tu8\tval;\n};\n\n \nextern unsigned long sysctl_dccp_sequence_window;\nextern int\t     sysctl_dccp_rx_ccid;\nextern int\t     sysctl_dccp_tx_ccid;\n\nint dccp_feat_init(struct sock *sk);\nint dccp_feat_register_sp(struct sock *sk, u8 feat, u8 is_local,\n\t\t\t  u8 const *list, u8 len);\nint dccp_feat_parse_options(struct sock *, struct dccp_request_sock *,\n\t\t\t    u8 mand, u8 opt, u8 feat, u8 *val, u8 len);\nint dccp_feat_clone_list(struct list_head const *, struct list_head *);\n\n \n#define DCCP_OPTVAL_MAXLEN\t6\n\nvoid dccp_encode_value_var(const u64 value, u8 *to, const u8 len);\nu64 dccp_decode_value_var(const u8 *bf, const u8 len);\nu64 dccp_feat_nn_get(struct sock *sk, u8 feat);\n\nint dccp_insert_option_mandatory(struct sk_buff *skb);\nint dccp_insert_fn_opt(struct sk_buff *skb, u8 type, u8 feat, u8 *val, u8 len,\n\t\t       bool repeat_first);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}