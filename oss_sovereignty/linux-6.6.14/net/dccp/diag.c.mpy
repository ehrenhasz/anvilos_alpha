{
  "module_name": "diag.c",
  "hash_id": "412609003be1fd6bb3e5feb5b2c1f5b967db6f844b83ad904722c23ceb637637",
  "original_prompt": "Ingested from linux-6.6.14/net/dccp/diag.c",
  "human_readable_source": "\n \n\n\n#include <linux/module.h>\n#include <linux/inet_diag.h>\n\n#include \"ccid.h\"\n#include \"dccp.h\"\n\nstatic void dccp_get_info(struct sock *sk, struct tcp_info *info)\n{\n\tstruct dccp_sock *dp = dccp_sk(sk);\n\tconst struct inet_connection_sock *icsk = inet_csk(sk);\n\n\tmemset(info, 0, sizeof(*info));\n\n\tinfo->tcpi_state\t= sk->sk_state;\n\tinfo->tcpi_retransmits\t= icsk->icsk_retransmits;\n\tinfo->tcpi_probes\t= icsk->icsk_probes_out;\n\tinfo->tcpi_backoff\t= icsk->icsk_backoff;\n\tinfo->tcpi_pmtu\t\t= icsk->icsk_pmtu_cookie;\n\n\tif (dp->dccps_hc_rx_ackvec != NULL)\n\t\tinfo->tcpi_options |= TCPI_OPT_SACK;\n\n\tif (dp->dccps_hc_rx_ccid != NULL)\n\t\tccid_hc_rx_get_info(dp->dccps_hc_rx_ccid, sk, info);\n\n\tif (dp->dccps_hc_tx_ccid != NULL)\n\t\tccid_hc_tx_get_info(dp->dccps_hc_tx_ccid, sk, info);\n}\n\nstatic void dccp_diag_get_info(struct sock *sk, struct inet_diag_msg *r,\n\t\t\t       void *_info)\n{\n\tr->idiag_rqueue = r->idiag_wqueue = 0;\n\n\tif (_info != NULL)\n\t\tdccp_get_info(sk, _info);\n}\n\nstatic void dccp_diag_dump(struct sk_buff *skb, struct netlink_callback *cb,\n\t\t\t   const struct inet_diag_req_v2 *r)\n{\n\tinet_diag_dump_icsk(&dccp_hashinfo, skb, cb, r);\n}\n\nstatic int dccp_diag_dump_one(struct netlink_callback *cb,\n\t\t\t      const struct inet_diag_req_v2 *req)\n{\n\treturn inet_diag_dump_one_icsk(&dccp_hashinfo, cb, req);\n}\n\nstatic const struct inet_diag_handler dccp_diag_handler = {\n\t.dump\t\t = dccp_diag_dump,\n\t.dump_one\t = dccp_diag_dump_one,\n\t.idiag_get_info\t = dccp_diag_get_info,\n\t.idiag_type\t = IPPROTO_DCCP,\n\t.idiag_info_size = sizeof(struct tcp_info),\n};\n\nstatic int __init dccp_diag_init(void)\n{\n\treturn inet_diag_register(&dccp_diag_handler);\n}\n\nstatic void __exit dccp_diag_fini(void)\n{\n\tinet_diag_unregister(&dccp_diag_handler);\n}\n\nmodule_init(dccp_diag_init);\nmodule_exit(dccp_diag_fini);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Arnaldo Carvalho de Melo <acme@mandriva.com>\");\nMODULE_DESCRIPTION(\"DCCP inet_diag handler\");\nMODULE_ALIAS_NET_PF_PROTO_TYPE(PF_NETLINK, NETLINK_SOCK_DIAG, 2-33  );\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}