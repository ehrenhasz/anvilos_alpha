{
  "module_name": "ccid.h",
  "hash_id": "d7ad97a736168134475efc3703fcaa9a896758b76db49a2f76d6d052e0fb37d5",
  "original_prompt": "Ingested from linux-6.6.14/net/dccp/ccid.h",
  "human_readable_source": " \n#ifndef _CCID_H\n#define _CCID_H\n \n\n#include <net/sock.h>\n#include <linux/compiler.h>\n#include <linux/dccp.h>\n#include <linux/list.h>\n#include <linux/module.h>\n\n \n#define CCID_MAX\t\t255\n#define CCID_SLAB_NAME_LENGTH\t32\n\nstruct tcp_info;\n\n \nstruct ccid_operations {\n\tunsigned char\t\tccid_id;\n\t__u32\t\t\tccid_ccmps;\n\tconst char\t\t*ccid_name;\n\tstruct kmem_cache\t*ccid_hc_rx_slab,\n\t\t\t\t*ccid_hc_tx_slab;\n\tchar\t\t\tccid_hc_rx_slab_name[CCID_SLAB_NAME_LENGTH];\n\tchar\t\t\tccid_hc_tx_slab_name[CCID_SLAB_NAME_LENGTH];\n\t__u32\t\t\tccid_hc_rx_obj_size,\n\t\t\t\tccid_hc_tx_obj_size;\n\t \n\tint\t\t(*ccid_hc_rx_init)(struct ccid *ccid, struct sock *sk);\n\tint\t\t(*ccid_hc_tx_init)(struct ccid *ccid, struct sock *sk);\n\tvoid\t\t(*ccid_hc_rx_exit)(struct sock *sk);\n\tvoid\t\t(*ccid_hc_tx_exit)(struct sock *sk);\n\tvoid\t\t(*ccid_hc_rx_packet_recv)(struct sock *sk,\n\t\t\t\t\t\t  struct sk_buff *skb);\n\tint\t\t(*ccid_hc_rx_parse_options)(struct sock *sk, u8 pkt,\n\t\t\t\t\t\t    u8 opt, u8 *val, u8 len);\n\tint\t\t(*ccid_hc_rx_insert_options)(struct sock *sk,\n\t\t\t\t\t\t     struct sk_buff *skb);\n\tvoid\t\t(*ccid_hc_tx_packet_recv)(struct sock *sk,\n\t\t\t\t\t\t  struct sk_buff *skb);\n\tint\t\t(*ccid_hc_tx_parse_options)(struct sock *sk, u8 pkt,\n\t\t\t\t\t\t    u8 opt, u8 *val, u8 len);\n\tint\t\t(*ccid_hc_tx_send_packet)(struct sock *sk,\n\t\t\t\t\t\t  struct sk_buff *skb);\n\tvoid\t\t(*ccid_hc_tx_packet_sent)(struct sock *sk,\n\t\t\t\t\t\t  unsigned int len);\n\tvoid\t\t(*ccid_hc_rx_get_info)(struct sock *sk,\n\t\t\t\t\t       struct tcp_info *info);\n\tvoid\t\t(*ccid_hc_tx_get_info)(struct sock *sk,\n\t\t\t\t\t       struct tcp_info *info);\n\tint\t\t(*ccid_hc_rx_getsockopt)(struct sock *sk,\n\t\t\t\t\t\t const int optname, int len,\n\t\t\t\t\t\t u32 __user *optval,\n\t\t\t\t\t\t int __user *optlen);\n\tint\t\t(*ccid_hc_tx_getsockopt)(struct sock *sk,\n\t\t\t\t\t\t const int optname, int len,\n\t\t\t\t\t\t u32 __user *optval,\n\t\t\t\t\t\t int __user *optlen);\n};\n\nextern struct ccid_operations ccid2_ops;\n#ifdef CONFIG_IP_DCCP_CCID3\nextern struct ccid_operations ccid3_ops;\n#endif\n\nint ccid_initialize_builtins(void);\nvoid ccid_cleanup_builtins(void);\n\nstruct ccid {\n\tstruct ccid_operations *ccid_ops;\n\tchar\t\t       ccid_priv[];\n};\n\nstatic inline void *ccid_priv(const struct ccid *ccid)\n{\n\treturn (void *)ccid->ccid_priv;\n}\n\nbool ccid_support_check(u8 const *ccid_array, u8 array_len);\nint ccid_get_builtin_ccids(u8 **ccid_array, u8 *array_len);\nint ccid_getsockopt_builtin_ccids(struct sock *sk, int len,\n\t\t\t\t  char __user *, int __user *);\n\nstruct ccid *ccid_new(const u8 id, struct sock *sk, bool rx);\n\nstatic inline int ccid_get_current_rx_ccid(struct dccp_sock *dp)\n{\n\tstruct ccid *ccid = dp->dccps_hc_rx_ccid;\n\n\tif (ccid == NULL || ccid->ccid_ops == NULL)\n\t\treturn -1;\n\treturn ccid->ccid_ops->ccid_id;\n}\n\nstatic inline int ccid_get_current_tx_ccid(struct dccp_sock *dp)\n{\n\tstruct ccid *ccid = dp->dccps_hc_tx_ccid;\n\n\tif (ccid == NULL || ccid->ccid_ops == NULL)\n\t\treturn -1;\n\treturn ccid->ccid_ops->ccid_id;\n}\n\nvoid ccid_hc_rx_delete(struct ccid *ccid, struct sock *sk);\nvoid ccid_hc_tx_delete(struct ccid *ccid, struct sock *sk);\n\n \n\nenum ccid_dequeueing_decision {\n\tCCID_PACKET_SEND_AT_ONCE =\t 0x00000,   \n\tCCID_PACKET_DELAY_MAX =\t\t 0x0FFFF,   \n\tCCID_PACKET_DELAY =\t\t 0x10000,   \n\tCCID_PACKET_WILL_DEQUEUE_LATER = 0x20000,   \n\tCCID_PACKET_ERR =\t\t 0xF0000,   \n};\n\nstatic inline int ccid_packet_dequeue_eval(const int return_code)\n{\n\tif (return_code < 0)\n\t\treturn CCID_PACKET_ERR;\n\tif (return_code == 0)\n\t\treturn CCID_PACKET_SEND_AT_ONCE;\n\tif (return_code <= CCID_PACKET_DELAY_MAX)\n\t\treturn CCID_PACKET_DELAY;\n\treturn return_code;\n}\n\nstatic inline int ccid_hc_tx_send_packet(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t struct sk_buff *skb)\n{\n\tif (ccid->ccid_ops->ccid_hc_tx_send_packet != NULL)\n\t\treturn ccid->ccid_ops->ccid_hc_tx_send_packet(sk, skb);\n\treturn CCID_PACKET_SEND_AT_ONCE;\n}\n\nstatic inline void ccid_hc_tx_packet_sent(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t  unsigned int len)\n{\n\tif (ccid->ccid_ops->ccid_hc_tx_packet_sent != NULL)\n\t\tccid->ccid_ops->ccid_hc_tx_packet_sent(sk, len);\n}\n\nstatic inline void ccid_hc_rx_packet_recv(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t  struct sk_buff *skb)\n{\n\tif (ccid->ccid_ops->ccid_hc_rx_packet_recv != NULL)\n\t\tccid->ccid_ops->ccid_hc_rx_packet_recv(sk, skb);\n}\n\nstatic inline void ccid_hc_tx_packet_recv(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t  struct sk_buff *skb)\n{\n\tif (ccid->ccid_ops->ccid_hc_tx_packet_recv != NULL)\n\t\tccid->ccid_ops->ccid_hc_tx_packet_recv(sk, skb);\n}\n\n \nstatic inline int ccid_hc_tx_parse_options(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t   u8 pkt, u8 opt, u8 *val, u8 len)\n{\n\tif (!ccid || !ccid->ccid_ops->ccid_hc_tx_parse_options)\n\t\treturn 0;\n\treturn ccid->ccid_ops->ccid_hc_tx_parse_options(sk, pkt, opt, val, len);\n}\n\n \nstatic inline int ccid_hc_rx_parse_options(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t   u8 pkt, u8 opt, u8 *val, u8 len)\n{\n\tif (!ccid || !ccid->ccid_ops->ccid_hc_rx_parse_options)\n\t\treturn 0;\n\treturn ccid->ccid_ops->ccid_hc_rx_parse_options(sk, pkt, opt, val, len);\n}\n\nstatic inline int ccid_hc_rx_insert_options(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\t    struct sk_buff *skb)\n{\n\tif (ccid->ccid_ops->ccid_hc_rx_insert_options != NULL)\n\t\treturn ccid->ccid_ops->ccid_hc_rx_insert_options(sk, skb);\n\treturn 0;\n}\n\nstatic inline void ccid_hc_rx_get_info(struct ccid *ccid, struct sock *sk,\n\t\t\t\t       struct tcp_info *info)\n{\n\tif (ccid->ccid_ops->ccid_hc_rx_get_info != NULL)\n\t\tccid->ccid_ops->ccid_hc_rx_get_info(sk, info);\n}\n\nstatic inline void ccid_hc_tx_get_info(struct ccid *ccid, struct sock *sk,\n\t\t\t\t       struct tcp_info *info)\n{\n\tif (ccid->ccid_ops->ccid_hc_tx_get_info != NULL)\n\t\tccid->ccid_ops->ccid_hc_tx_get_info(sk, info);\n}\n\nstatic inline int ccid_hc_rx_getsockopt(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\tconst int optname, int len,\n\t\t\t\t\tu32 __user *optval, int __user *optlen)\n{\n\tint rc = -ENOPROTOOPT;\n\tif (ccid != NULL && ccid->ccid_ops->ccid_hc_rx_getsockopt != NULL)\n\t\trc = ccid->ccid_ops->ccid_hc_rx_getsockopt(sk, optname, len,\n\t\t\t\t\t\t optval, optlen);\n\treturn rc;\n}\n\nstatic inline int ccid_hc_tx_getsockopt(struct ccid *ccid, struct sock *sk,\n\t\t\t\t\tconst int optname, int len,\n\t\t\t\t\tu32 __user *optval, int __user *optlen)\n{\n\tint rc = -ENOPROTOOPT;\n\tif (ccid != NULL && ccid->ccid_ops->ccid_hc_tx_getsockopt != NULL)\n\t\trc = ccid->ccid_ops->ccid_hc_tx_getsockopt(sk, optname, len,\n\t\t\t\t\t\t optval, optlen);\n\treturn rc;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}