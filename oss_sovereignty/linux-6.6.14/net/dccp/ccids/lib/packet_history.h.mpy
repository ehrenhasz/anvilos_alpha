{
  "module_name": "packet_history.h",
  "hash_id": "2037269bfc4995cd98bf7f2cb66c407465d9c5c26db781e74708bdaceba35f72",
  "original_prompt": "Ingested from linux-6.6.14/net/dccp/ccids/lib/packet_history.h",
  "human_readable_source": " \n \n\n#ifndef _DCCP_PKT_HIST_\n#define _DCCP_PKT_HIST_\n\n#include <linux/list.h>\n#include <linux/slab.h>\n#include \"tfrc.h\"\n\n \nstruct tfrc_tx_hist_entry {\n\tstruct tfrc_tx_hist_entry *next;\n\tu64\t\t\t  seqno;\n\tktime_t\t\t\t  stamp;\n};\n\nstatic inline struct tfrc_tx_hist_entry *\n\ttfrc_tx_hist_find_entry(struct tfrc_tx_hist_entry *head, u64 seqno)\n{\n\twhile (head != NULL && head->seqno != seqno)\n\t\thead = head->next;\n\treturn head;\n}\n\nint tfrc_tx_hist_add(struct tfrc_tx_hist_entry **headp, u64 seqno);\nvoid tfrc_tx_hist_purge(struct tfrc_tx_hist_entry **headp);\n\n \n#define SUB16(a, b) (((a) + 16 - (b)) & 0xF)\n\n \n#define TFRC_NDUPACK 3\n\n \nstruct tfrc_rx_hist_entry {\n\tu64\t\t tfrchrx_seqno:48,\n\t\t\t tfrchrx_ccval:4,\n\t\t\t tfrchrx_type:4;\n\tu64\t\t tfrchrx_ndp:48;\n\tktime_t\t\t tfrchrx_tstamp;\n};\n\n \nstruct tfrc_rx_hist {\n\tstruct tfrc_rx_hist_entry *ring[TFRC_NDUPACK + 1];\n\tu8\t\t\t  loss_count:2,\n\t\t\t\t  loss_start:2;\n#define rtt_sample_prev\t\t  loss_start\n};\n\n \nstatic inline u8 tfrc_rx_hist_index(const struct tfrc_rx_hist *h, const u8 n)\n{\n\treturn (h->loss_start + n) & TFRC_NDUPACK;\n}\n\n \nstatic inline struct tfrc_rx_hist_entry *\n\t\t\ttfrc_rx_hist_last_rcv(const struct tfrc_rx_hist *h)\n{\n\treturn h->ring[tfrc_rx_hist_index(h, h->loss_count)];\n}\n\n \nstatic inline struct tfrc_rx_hist_entry *\n\t\t\ttfrc_rx_hist_entry(const struct tfrc_rx_hist *h, const u8 n)\n{\n\treturn h->ring[tfrc_rx_hist_index(h, n)];\n}\n\n \nstatic inline struct tfrc_rx_hist_entry *\n\t\t\ttfrc_rx_hist_loss_prev(const struct tfrc_rx_hist *h)\n{\n\treturn h->ring[h->loss_start];\n}\n\n \nstatic inline bool tfrc_rx_hist_loss_pending(const struct tfrc_rx_hist *h)\n{\n\treturn h->loss_count > 0;\n}\n\nvoid tfrc_rx_hist_add_packet(struct tfrc_rx_hist *h, const struct sk_buff *skb,\n\t\t\t     const u64 ndp);\n\nint tfrc_rx_hist_duplicate(struct tfrc_rx_hist *h, struct sk_buff *skb);\n\nstruct tfrc_loss_hist;\nint tfrc_rx_handle_loss(struct tfrc_rx_hist *h, struct tfrc_loss_hist *lh,\n\t\t\tstruct sk_buff *skb, const u64 ndp,\n\t\t\tu32 (*first_li)(struct sock *sk), struct sock *sk);\nu32 tfrc_rx_hist_sample_rtt(struct tfrc_rx_hist *h, const struct sk_buff *skb);\nint tfrc_rx_hist_alloc(struct tfrc_rx_hist *h);\nvoid tfrc_rx_hist_purge(struct tfrc_rx_hist *h);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}