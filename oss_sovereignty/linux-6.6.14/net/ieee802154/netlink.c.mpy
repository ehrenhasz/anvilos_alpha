{
  "module_name": "netlink.c",
  "hash_id": "d12403a5c0a6b299f03ed1db02cb3798064a228df2e5ee80037651a1eb496ce8",
  "original_prompt": "Ingested from linux-6.6.14/net/ieee802154/netlink.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/gfp.h>\n#include <net/genetlink.h>\n#include <linux/nl802154.h>\n\n#include \"ieee802154.h\"\n\nstatic unsigned int ieee802154_seq_num;\nstatic DEFINE_SPINLOCK(ieee802154_seq_lock);\n\n \nstruct sk_buff *ieee802154_nl_create(int flags, u8 req)\n{\n\tvoid *hdr;\n\tstruct sk_buff *msg = nlmsg_new(NLMSG_DEFAULT_SIZE, GFP_ATOMIC);\n\tunsigned long f;\n\n\tif (!msg)\n\t\treturn NULL;\n\n\tspin_lock_irqsave(&ieee802154_seq_lock, f);\n\thdr = genlmsg_put(msg, 0, ieee802154_seq_num++,\n\t\t\t  &nl802154_family, flags, req);\n\tspin_unlock_irqrestore(&ieee802154_seq_lock, f);\n\tif (!hdr) {\n\t\tnlmsg_free(msg);\n\t\treturn NULL;\n\t}\n\n\treturn msg;\n}\n\nint ieee802154_nl_mcast(struct sk_buff *msg, unsigned int group)\n{\n\tstruct nlmsghdr *nlh = nlmsg_hdr(msg);\n\tvoid *hdr = genlmsg_data(nlmsg_data(nlh));\n\n\tgenlmsg_end(msg, hdr);\n\n\treturn genlmsg_multicast(&nl802154_family, msg, 0, group, GFP_ATOMIC);\n}\n\nstruct sk_buff *ieee802154_nl_new_reply(struct genl_info *info,\n\t\t\t\t\tint flags, u8 req)\n{\n\tvoid *hdr;\n\tstruct sk_buff *msg = nlmsg_new(NLMSG_DEFAULT_SIZE, GFP_ATOMIC);\n\n\tif (!msg)\n\t\treturn NULL;\n\n\thdr = genlmsg_put_reply(msg, info,\n\t\t\t\t&nl802154_family, flags, req);\n\tif (!hdr) {\n\t\tnlmsg_free(msg);\n\t\treturn NULL;\n\t}\n\n\treturn msg;\n}\n\nint ieee802154_nl_reply(struct sk_buff *msg, struct genl_info *info)\n{\n\tstruct nlmsghdr *nlh = nlmsg_hdr(msg);\n\tvoid *hdr = genlmsg_data(nlmsg_data(nlh));\n\n\tgenlmsg_end(msg, hdr);\n\n\treturn genlmsg_reply(msg, info);\n}\n\nstatic const struct genl_small_ops ieee802154_ops[] = {\n\t \n\tIEEE802154_DUMP(IEEE802154_LIST_PHY, ieee802154_list_phy,\n\t\t\tieee802154_dump_phy),\n\tIEEE802154_OP(IEEE802154_ADD_IFACE, ieee802154_add_iface),\n\tIEEE802154_OP(IEEE802154_DEL_IFACE, ieee802154_del_iface),\n\t \n\tIEEE802154_OP(IEEE802154_ASSOCIATE_REQ, ieee802154_associate_req),\n\tIEEE802154_OP(IEEE802154_ASSOCIATE_RESP, ieee802154_associate_resp),\n\tIEEE802154_OP(IEEE802154_DISASSOCIATE_REQ, ieee802154_disassociate_req),\n\tIEEE802154_OP(IEEE802154_SCAN_REQ, ieee802154_scan_req),\n\tIEEE802154_OP(IEEE802154_START_REQ, ieee802154_start_req),\n\tIEEE802154_DUMP(IEEE802154_LIST_IFACE, ieee802154_list_iface,\n\t\t\tieee802154_dump_iface),\n\tIEEE802154_OP(IEEE802154_SET_MACPARAMS, ieee802154_set_macparams),\n\tIEEE802154_OP(IEEE802154_LLSEC_GETPARAMS, ieee802154_llsec_getparams),\n\tIEEE802154_OP(IEEE802154_LLSEC_SETPARAMS, ieee802154_llsec_setparams),\n\tIEEE802154_DUMP(IEEE802154_LLSEC_LIST_KEY, NULL,\n\t\t\tieee802154_llsec_dump_keys),\n\tIEEE802154_OP(IEEE802154_LLSEC_ADD_KEY, ieee802154_llsec_add_key),\n\tIEEE802154_OP(IEEE802154_LLSEC_DEL_KEY, ieee802154_llsec_del_key),\n\tIEEE802154_DUMP(IEEE802154_LLSEC_LIST_DEV, NULL,\n\t\t\tieee802154_llsec_dump_devs),\n\tIEEE802154_OP(IEEE802154_LLSEC_ADD_DEV, ieee802154_llsec_add_dev),\n\tIEEE802154_OP(IEEE802154_LLSEC_DEL_DEV, ieee802154_llsec_del_dev),\n\tIEEE802154_DUMP(IEEE802154_LLSEC_LIST_DEVKEY, NULL,\n\t\t\tieee802154_llsec_dump_devkeys),\n\tIEEE802154_OP(IEEE802154_LLSEC_ADD_DEVKEY, ieee802154_llsec_add_devkey),\n\tIEEE802154_OP(IEEE802154_LLSEC_DEL_DEVKEY, ieee802154_llsec_del_devkey),\n\tIEEE802154_DUMP(IEEE802154_LLSEC_LIST_SECLEVEL, NULL,\n\t\t\tieee802154_llsec_dump_seclevels),\n\tIEEE802154_OP(IEEE802154_LLSEC_ADD_SECLEVEL,\n\t\t      ieee802154_llsec_add_seclevel),\n\tIEEE802154_OP(IEEE802154_LLSEC_DEL_SECLEVEL,\n\t\t      ieee802154_llsec_del_seclevel),\n};\n\nstatic const struct genl_multicast_group ieee802154_mcgrps[] = {\n\t[IEEE802154_COORD_MCGRP] = { .name = IEEE802154_MCAST_COORD_NAME, },\n\t[IEEE802154_BEACON_MCGRP] = { .name = IEEE802154_MCAST_BEACON_NAME, },\n};\n\nstruct genl_family nl802154_family __ro_after_init = {\n\t.hdrsize\t= 0,\n\t.name\t\t= IEEE802154_NL_NAME,\n\t.version\t= 1,\n\t.maxattr\t= IEEE802154_ATTR_MAX,\n\t.policy\t\t= ieee802154_policy,\n\t.module\t\t= THIS_MODULE,\n\t.small_ops\t= ieee802154_ops,\n\t.n_small_ops\t= ARRAY_SIZE(ieee802154_ops),\n\t.resv_start_op\t= IEEE802154_LLSEC_DEL_SECLEVEL + 1,\n\t.mcgrps\t\t= ieee802154_mcgrps,\n\t.n_mcgrps\t= ARRAY_SIZE(ieee802154_mcgrps),\n};\n\nint __init ieee802154_nl_init(void)\n{\n\treturn genl_register_family(&nl802154_family);\n}\n\nvoid ieee802154_nl_exit(void)\n{\n\tgenl_unregister_family(&nl802154_family);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}