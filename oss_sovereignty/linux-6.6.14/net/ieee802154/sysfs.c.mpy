{
  "module_name": "sysfs.c",
  "hash_id": "e17e436e73bd4fcf3a7303298306c740f458b67c47919fb08f2a0281bae99b28",
  "original_prompt": "Ingested from linux-6.6.14/net/ieee802154/sysfs.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/rtnetlink.h>\n\n#include <net/cfg802154.h>\n\n#include \"core.h\"\n#include \"sysfs.h\"\n#include \"rdev-ops.h\"\n\nstatic inline struct cfg802154_registered_device *\ndev_to_rdev(struct device *dev)\n{\n\treturn container_of(dev, struct cfg802154_registered_device,\n\t\t\t    wpan_phy.dev);\n}\n\n#define SHOW_FMT(name, fmt, member)\t\t\t\t\t\\\nstatic ssize_t name ## _show(struct device *dev,\t\t\t\\\n\t\t\t     struct device_attribute *attr,\t\t\\\n\t\t\t     char *buf)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\treturn sprintf(buf, fmt \"\\n\", dev_to_rdev(dev)->member);\t\\\n}\t\t\t\t\t\t\t\t\t\\\nstatic DEVICE_ATTR_RO(name)\n\nSHOW_FMT(index, \"%d\", wpan_phy_idx);\n\nstatic ssize_t name_show(struct device *dev,\n\t\t\t struct device_attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct wpan_phy *wpan_phy = &dev_to_rdev(dev)->wpan_phy;\n\n\treturn sprintf(buf, \"%s\\n\", dev_name(&wpan_phy->dev));\n}\nstatic DEVICE_ATTR_RO(name);\n\nstatic void wpan_phy_release(struct device *dev)\n{\n\tstruct cfg802154_registered_device *rdev = dev_to_rdev(dev);\n\n\tcfg802154_dev_free(rdev);\n}\n\nstatic struct attribute *pmib_attrs[] = {\n\t&dev_attr_index.attr,\n\t&dev_attr_name.attr,\n\tNULL,\n};\nATTRIBUTE_GROUPS(pmib);\n\n#ifdef CONFIG_PM_SLEEP\nstatic int wpan_phy_suspend(struct device *dev)\n{\n\tstruct cfg802154_registered_device *rdev = dev_to_rdev(dev);\n\tint ret = 0;\n\n\tif (rdev->ops->suspend) {\n\t\trtnl_lock();\n\t\tret = rdev_suspend(rdev);\n\t\trtnl_unlock();\n\t}\n\n\treturn ret;\n}\n\nstatic int wpan_phy_resume(struct device *dev)\n{\n\tstruct cfg802154_registered_device *rdev = dev_to_rdev(dev);\n\tint ret = 0;\n\n\tif (rdev->ops->resume) {\n\t\trtnl_lock();\n\t\tret = rdev_resume(rdev);\n\t\trtnl_unlock();\n\t}\n\n\treturn ret;\n}\n\nstatic SIMPLE_DEV_PM_OPS(wpan_phy_pm_ops, wpan_phy_suspend, wpan_phy_resume);\n#define WPAN_PHY_PM_OPS (&wpan_phy_pm_ops)\n#else\n#define WPAN_PHY_PM_OPS NULL\n#endif\n\nstruct class wpan_phy_class = {\n\t.name = \"ieee802154\",\n\t.dev_release = wpan_phy_release,\n\t.dev_groups = pmib_groups,\n\t.pm = WPAN_PHY_PM_OPS,\n};\n\nint wpan_phy_sysfs_init(void)\n{\n\treturn class_register(&wpan_phy_class);\n}\n\nvoid wpan_phy_sysfs_exit(void)\n{\n\tclass_unregister(&wpan_phy_class);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}