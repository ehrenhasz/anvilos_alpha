{
  "module_name": "hsr_framereg.h",
  "hash_id": "e5229182f3d0cf4f36083c36f7e9dc9e5354fb085ba25fe80ea2897be2d947d6",
  "original_prompt": "Ingested from linux-6.6.14/net/hsr/hsr_framereg.h",
  "human_readable_source": " \n \n\n#ifndef __HSR_FRAMEREG_H\n#define __HSR_FRAMEREG_H\n\n#include \"hsr_main.h\"\n\nstruct hsr_node;\n\nstruct hsr_frame_info {\n\tstruct sk_buff *skb_std;\n\tstruct sk_buff *skb_hsr;\n\tstruct sk_buff *skb_prp;\n\tstruct hsr_port *port_rcv;\n\tstruct hsr_node *node_src;\n\tu16 sequence_nr;\n\tbool is_supervision;\n\tbool is_vlan;\n\tbool is_local_dest;\n\tbool is_local_exclusive;\n\tbool is_from_san;\n};\n\nvoid hsr_del_self_node(struct hsr_priv *hsr);\nvoid hsr_del_nodes(struct list_head *node_db);\nstruct hsr_node *hsr_get_node(struct hsr_port *port, struct list_head *node_db,\n\t\t\t      struct sk_buff *skb, bool is_sup,\n\t\t\t      enum hsr_port_type rx_port);\nvoid hsr_handle_sup_frame(struct hsr_frame_info *frame);\nbool hsr_addr_is_self(struct hsr_priv *hsr, unsigned char *addr);\n\nvoid hsr_addr_subst_source(struct hsr_node *node, struct sk_buff *skb);\nvoid hsr_addr_subst_dest(struct hsr_node *node_src, struct sk_buff *skb,\n\t\t\t struct hsr_port *port);\n\nvoid hsr_register_frame_in(struct hsr_node *node, struct hsr_port *port,\n\t\t\t   u16 sequence_nr);\nint hsr_register_frame_out(struct hsr_port *port, struct hsr_node *node,\n\t\t\t   u16 sequence_nr);\n\nvoid hsr_prune_nodes(struct timer_list *t);\n\nint hsr_create_self_node(struct hsr_priv *hsr,\n\t\t\t const unsigned char addr_a[ETH_ALEN],\n\t\t\t const unsigned char addr_b[ETH_ALEN]);\n\nvoid *hsr_get_next_node(struct hsr_priv *hsr, void *_pos,\n\t\t\tunsigned char addr[ETH_ALEN]);\n\nint hsr_get_node_data(struct hsr_priv *hsr,\n\t\t      const unsigned char *addr,\n\t\t      unsigned char addr_b[ETH_ALEN],\n\t\t      unsigned int *addr_b_ifindex,\n\t\t      int *if1_age,\n\t\t      u16 *if1_seq,\n\t\t      int *if2_age,\n\t\t      u16 *if2_seq);\n\nvoid prp_handle_san_frame(bool san, enum hsr_port_type port,\n\t\t\t  struct hsr_node *node);\nvoid prp_update_san_info(struct hsr_node *node, bool is_sup);\n\nstruct hsr_node {\n\tstruct list_head\tmac_list;\n\t \n\tspinlock_t\t\tseq_out_lock;\n\tunsigned char\t\tmacaddress_A[ETH_ALEN];\n\tunsigned char\t\tmacaddress_B[ETH_ALEN];\n\t \n\tenum hsr_port_type\taddr_B_port;\n\tunsigned long\t\ttime_in[HSR_PT_PORTS];\n\tbool\t\t\ttime_in_stale[HSR_PT_PORTS];\n\tunsigned long\t\ttime_out[HSR_PT_PORTS];\n\t \n\tbool\t\t\tsan_a;\n\tbool\t\t\tsan_b;\n\tu16\t\t\tseq_out[HSR_PT_PORTS];\n\tbool\t\t\tremoved;\n\tstruct rcu_head\t\trcu_head;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}