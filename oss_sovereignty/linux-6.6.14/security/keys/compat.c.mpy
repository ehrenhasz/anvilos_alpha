{
  "module_name": "compat.c",
  "hash_id": "2bbb053ddd00256c2fe5638072dcf245d46d3711fcccbfb062ddd3cb362aebf9",
  "original_prompt": "Ingested from linux-6.6.14/security/keys/compat.c",
  "human_readable_source": "\n \n\n#include <linux/syscalls.h>\n#include <linux/keyctl.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include \"internal.h\"\n\n \nCOMPAT_SYSCALL_DEFINE5(keyctl, u32, option,\n\t\t       u32, arg2, u32, arg3, u32, arg4, u32, arg5)\n{\n\tswitch (option) {\n\tcase KEYCTL_GET_KEYRING_ID:\n\t\treturn keyctl_get_keyring_ID(arg2, arg3);\n\n\tcase KEYCTL_JOIN_SESSION_KEYRING:\n\t\treturn keyctl_join_session_keyring(compat_ptr(arg2));\n\n\tcase KEYCTL_UPDATE:\n\t\treturn keyctl_update_key(arg2, compat_ptr(arg3), arg4);\n\n\tcase KEYCTL_REVOKE:\n\t\treturn keyctl_revoke_key(arg2);\n\n\tcase KEYCTL_DESCRIBE:\n\t\treturn keyctl_describe_key(arg2, compat_ptr(arg3), arg4);\n\n\tcase KEYCTL_CLEAR:\n\t\treturn keyctl_keyring_clear(arg2);\n\n\tcase KEYCTL_LINK:\n\t\treturn keyctl_keyring_link(arg2, arg3);\n\n\tcase KEYCTL_UNLINK:\n\t\treturn keyctl_keyring_unlink(arg2, arg3);\n\n\tcase KEYCTL_SEARCH:\n\t\treturn keyctl_keyring_search(arg2, compat_ptr(arg3),\n\t\t\t\t\t     compat_ptr(arg4), arg5);\n\n\tcase KEYCTL_READ:\n\t\treturn keyctl_read_key(arg2, compat_ptr(arg3), arg4);\n\n\tcase KEYCTL_CHOWN:\n\t\treturn keyctl_chown_key(arg2, arg3, arg4);\n\n\tcase KEYCTL_SETPERM:\n\t\treturn keyctl_setperm_key(arg2, arg3);\n\n\tcase KEYCTL_INSTANTIATE:\n\t\treturn keyctl_instantiate_key(arg2, compat_ptr(arg3), arg4,\n\t\t\t\t\t      arg5);\n\n\tcase KEYCTL_NEGATE:\n\t\treturn keyctl_negate_key(arg2, arg3, arg4);\n\n\tcase KEYCTL_SET_REQKEY_KEYRING:\n\t\treturn keyctl_set_reqkey_keyring(arg2);\n\n\tcase KEYCTL_SET_TIMEOUT:\n\t\treturn keyctl_set_timeout(arg2, arg3);\n\n\tcase KEYCTL_ASSUME_AUTHORITY:\n\t\treturn keyctl_assume_authority(arg2);\n\n\tcase KEYCTL_GET_SECURITY:\n\t\treturn keyctl_get_security(arg2, compat_ptr(arg3), arg4);\n\n\tcase KEYCTL_SESSION_TO_PARENT:\n\t\treturn keyctl_session_to_parent();\n\n\tcase KEYCTL_REJECT:\n\t\treturn keyctl_reject_key(arg2, arg3, arg4, arg5);\n\n\tcase KEYCTL_INSTANTIATE_IOV:\n\t\treturn keyctl_instantiate_key_iov(arg2, compat_ptr(arg3), arg4,\n\t\t\t\t\t\t  arg5);\n\n\tcase KEYCTL_INVALIDATE:\n\t\treturn keyctl_invalidate_key(arg2);\n\n\tcase KEYCTL_GET_PERSISTENT:\n\t\treturn keyctl_get_persistent(arg2, arg3);\n\n\tcase KEYCTL_DH_COMPUTE:\n\t\treturn compat_keyctl_dh_compute(compat_ptr(arg2),\n\t\t\t\t\t\tcompat_ptr(arg3),\n\t\t\t\t\t\targ4, compat_ptr(arg5));\n\n\tcase KEYCTL_RESTRICT_KEYRING:\n\t\treturn keyctl_restrict_keyring(arg2, compat_ptr(arg3),\n\t\t\t\t\t       compat_ptr(arg4));\n\n\tcase KEYCTL_PKEY_QUERY:\n\t\tif (arg3 != 0)\n\t\t\treturn -EINVAL;\n\t\treturn keyctl_pkey_query(arg2,\n\t\t\t\t\t compat_ptr(arg4),\n\t\t\t\t\t compat_ptr(arg5));\n\n\tcase KEYCTL_PKEY_ENCRYPT:\n\tcase KEYCTL_PKEY_DECRYPT:\n\tcase KEYCTL_PKEY_SIGN:\n\t\treturn keyctl_pkey_e_d_s(option,\n\t\t\t\t\t compat_ptr(arg2), compat_ptr(arg3),\n\t\t\t\t\t compat_ptr(arg4), compat_ptr(arg5));\n\n\tcase KEYCTL_PKEY_VERIFY:\n\t\treturn keyctl_pkey_verify(compat_ptr(arg2), compat_ptr(arg3),\n\t\t\t\t\t  compat_ptr(arg4), compat_ptr(arg5));\n\n\tcase KEYCTL_MOVE:\n\t\treturn keyctl_keyring_move(arg2, arg3, arg4, arg5);\n\n\tcase KEYCTL_CAPABILITIES:\n\t\treturn keyctl_capabilities(compat_ptr(arg2), arg3);\n\n\tcase KEYCTL_WATCH_KEY:\n\t\treturn keyctl_watch_key(arg2, arg3, arg4);\n\n\tdefault:\n\t\treturn -EOPNOTSUPP;\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}