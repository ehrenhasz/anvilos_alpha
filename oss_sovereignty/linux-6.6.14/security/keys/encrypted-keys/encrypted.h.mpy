{
  "module_name": "encrypted.h",
  "hash_id": "f3105223bc19cefad48089dde6ef5c366abdd7d3ae27b9f82f474163301fb2ae",
  "original_prompt": "Ingested from linux-6.6.14/security/keys/encrypted-keys/encrypted.h",
  "human_readable_source": " \n#ifndef __ENCRYPTED_KEY_H\n#define __ENCRYPTED_KEY_H\n\n#define ENCRYPTED_DEBUG 0\n#if defined(CONFIG_TRUSTED_KEYS) || \\\n  (defined(CONFIG_TRUSTED_KEYS_MODULE) && defined(CONFIG_ENCRYPTED_KEYS_MODULE))\nextern struct key *request_trusted_key(const char *trusted_desc,\n\t\t\t\t       const u8 **master_key, size_t *master_keylen);\n#else\nstatic inline struct key *request_trusted_key(const char *trusted_desc,\n\t\t\t\t\t      const u8 **master_key,\n\t\t\t\t\t      size_t *master_keylen)\n{\n\treturn ERR_PTR(-EOPNOTSUPP);\n}\n#endif\n\n#if ENCRYPTED_DEBUG\nstatic inline void dump_master_key(const u8 *master_key, size_t master_keylen)\n{\n\tprint_hex_dump(KERN_ERR, \"master key: \", DUMP_PREFIX_NONE, 32, 1,\n\t\t       master_key, master_keylen, 0);\n}\n\nstatic inline void dump_decrypted_data(struct encrypted_key_payload *epayload)\n{\n\tprint_hex_dump(KERN_ERR, \"decrypted data: \", DUMP_PREFIX_NONE, 32, 1,\n\t\t       epayload->decrypted_data,\n\t\t       epayload->decrypted_datalen, 0);\n}\n\nstatic inline void dump_encrypted_data(struct encrypted_key_payload *epayload,\n\t\t\t\t       unsigned int encrypted_datalen)\n{\n\tprint_hex_dump(KERN_ERR, \"encrypted data: \", DUMP_PREFIX_NONE, 32, 1,\n\t\t       epayload->encrypted_data, encrypted_datalen, 0);\n}\n\nstatic inline void dump_hmac(const char *str, const u8 *digest,\n\t\t\t     unsigned int hmac_size)\n{\n\tif (str)\n\t\tpr_info(\"encrypted_key: %s\", str);\n\tprint_hex_dump(KERN_ERR, \"hmac: \", DUMP_PREFIX_NONE, 32, 1, digest,\n\t\t       hmac_size, 0);\n}\n#else\nstatic inline void dump_master_key(const u8 *master_key, size_t master_keylen)\n{\n}\n\nstatic inline void dump_decrypted_data(struct encrypted_key_payload *epayload)\n{\n}\n\nstatic inline void dump_encrypted_data(struct encrypted_key_payload *epayload,\n\t\t\t\t       unsigned int encrypted_datalen)\n{\n}\n\nstatic inline void dump_hmac(const char *str, const u8 *digest,\n\t\t\t     unsigned int hmac_size)\n{\n}\n#endif\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}