{
  "module_name": "avtab.h",
  "hash_id": "a12366baf6d5952577b6891452c0c5b508d8d0ee42b8c0ebe73c0cbd79bc1fa0",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/ss/avtab.h",
  "human_readable_source": " \n \n\n \n#ifndef _SS_AVTAB_H_\n#define _SS_AVTAB_H_\n\n#include \"security.h\"\n\nstruct avtab_key {\n\tu16 source_type;\t \n\tu16 target_type;\t \n\tu16 target_class;\t \n#define AVTAB_ALLOWED\t\t0x0001\n#define AVTAB_AUDITALLOW\t0x0002\n#define AVTAB_AUDITDENY\t\t0x0004\n#define AVTAB_AV\t\t(AVTAB_ALLOWED | AVTAB_AUDITALLOW | AVTAB_AUDITDENY)\n#define AVTAB_TRANSITION\t0x0010\n#define AVTAB_MEMBER\t\t0x0020\n#define AVTAB_CHANGE\t\t0x0040\n#define AVTAB_TYPE\t\t(AVTAB_TRANSITION | AVTAB_MEMBER | AVTAB_CHANGE)\n \n#define AVTAB_XPERMS_ALLOWED\t0x0100\n#define AVTAB_XPERMS_AUDITALLOW\t0x0200\n#define AVTAB_XPERMS_DONTAUDIT\t0x0400\n#define AVTAB_XPERMS\t\t(AVTAB_XPERMS_ALLOWED | \\\n\t\t\t\tAVTAB_XPERMS_AUDITALLOW | \\\n\t\t\t\tAVTAB_XPERMS_DONTAUDIT)\n#define AVTAB_ENABLED_OLD   0x80000000  \n#define AVTAB_ENABLED\t\t0x8000  \n\tu16 specified;\t \n};\n\n \nstruct avtab_extended_perms {\n \n#define AVTAB_XPERMS_IOCTLFUNCTION\t0x01\n#define AVTAB_XPERMS_IOCTLDRIVER\t0x02\n\t \n\tu8 specified;  \n\t \n\tu8 driver;\n\t \n\tstruct extended_perms_data perms;\n};\n\nstruct avtab_datum {\n\tunion {\n\t\tu32 data;  \n\t\tstruct avtab_extended_perms *xperms;\n\t} u;\n};\n\nstruct avtab_node {\n\tstruct avtab_key key;\n\tstruct avtab_datum datum;\n\tstruct avtab_node *next;\n};\n\nstruct avtab {\n\tstruct avtab_node **htable;\n\tu32 nel;\t \n\tu32 nslot;       \n\tu32 mask;        \n};\n\nvoid avtab_init(struct avtab *h);\nint avtab_alloc(struct avtab *, u32);\nint avtab_alloc_dup(struct avtab *new, const struct avtab *orig);\nvoid avtab_destroy(struct avtab *h);\n\n#ifdef CONFIG_SECURITY_SELINUX_DEBUG\nvoid avtab_hash_eval(struct avtab *h, const char *tag);\n#else\nstatic inline void avtab_hash_eval(struct avtab *h, const char *tag)\n{\n}\n#endif\n\nstruct policydb;\nint avtab_read_item(struct avtab *a, void *fp, struct policydb *pol,\n\t\t    int (*insert)(struct avtab *a, const struct avtab_key *k,\n\t\t\t\t  const struct avtab_datum *d, void *p),\n\t\t    void *p);\n\nint avtab_read(struct avtab *a, void *fp, struct policydb *pol);\nint avtab_write_item(struct policydb *p, const struct avtab_node *cur, void *fp);\nint avtab_write(struct policydb *p, struct avtab *a, void *fp);\n\nstruct avtab_node *avtab_insert_nonunique(struct avtab *h,\n\t\t\t\t\t  const struct avtab_key *key,\n\t\t\t\t\t  const struct avtab_datum *datum);\n\nstruct avtab_node *avtab_search_node(struct avtab *h,\n\t\t\t\t     const struct avtab_key *key);\n\nstruct avtab_node *avtab_search_node_next(struct avtab_node *node, u16 specified);\n\n#define MAX_AVTAB_HASH_BITS 16\n#define MAX_AVTAB_HASH_BUCKETS (1 << MAX_AVTAB_HASH_BITS)\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}