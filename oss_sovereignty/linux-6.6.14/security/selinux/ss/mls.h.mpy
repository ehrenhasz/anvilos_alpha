{
  "module_name": "mls.h",
  "hash_id": "222ff35f2468aeba789d1eb8b2473db9719bb2ad528ba6c522047c5b154e5d70",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/ss/mls.h",
  "human_readable_source": " \n \n \n \n\n#ifndef _SS_MLS_H_\n#define _SS_MLS_H_\n\n#include <linux/jhash.h>\n\n#include \"context.h\"\n#include \"ebitmap.h\"\n#include \"policydb.h\"\n\nint mls_compute_context_len(struct policydb *p, struct context *context);\nvoid mls_sid_to_context(struct policydb *p, struct context *context,\n\t\t\tchar **scontext);\nint mls_context_isvalid(struct policydb *p, struct context *c);\nint mls_range_isvalid(struct policydb *p, struct mls_range *r);\nint mls_level_isvalid(struct policydb *p, struct mls_level *l);\n\nint mls_context_to_sid(struct policydb *p,\n\t\t       char oldc,\n\t\t       char *scontext,\n\t\t       struct context *context,\n\t\t       struct sidtab *s,\n\t\t       u32 def_sid);\n\nint mls_from_string(struct policydb *p, char *str, struct context *context,\n\t\t    gfp_t gfp_mask);\n\nint mls_range_set(struct context *context, struct mls_range *range);\n\nint mls_convert_context(struct policydb *oldp,\n\t\t\tstruct policydb *newp,\n\t\t\tstruct context *oldc,\n\t\t\tstruct context *newc);\n\nint mls_compute_sid(struct policydb *p,\n\t\t    struct context *scontext,\n\t\t    struct context *tcontext,\n\t\t    u16 tclass,\n\t\t    u32 specified,\n\t\t    struct context *newcontext,\n\t\t    bool sock);\n\nint mls_setup_user_range(struct policydb *p,\n\t\t\t struct context *fromcon, struct user_datum *user,\n\t\t\t struct context *usercon);\n\n#ifdef CONFIG_NETLABEL\nvoid mls_export_netlbl_lvl(struct policydb *p,\n\t\t\t   struct context *context,\n\t\t\t   struct netlbl_lsm_secattr *secattr);\nvoid mls_import_netlbl_lvl(struct policydb *p,\n\t\t\t   struct context *context,\n\t\t\t   struct netlbl_lsm_secattr *secattr);\nint mls_export_netlbl_cat(struct policydb *p,\n\t\t\t  struct context *context,\n\t\t\t  struct netlbl_lsm_secattr *secattr);\nint mls_import_netlbl_cat(struct policydb *p,\n\t\t\t  struct context *context,\n\t\t\t  struct netlbl_lsm_secattr *secattr);\n#else\nstatic inline void mls_export_netlbl_lvl(struct policydb *p,\n\t\t\t\t\t struct context *context,\n\t\t\t\t\t struct netlbl_lsm_secattr *secattr)\n{\n\treturn;\n}\nstatic inline void mls_import_netlbl_lvl(struct policydb *p,\n\t\t\t\t\t struct context *context,\n\t\t\t\t\t struct netlbl_lsm_secattr *secattr)\n{\n\treturn;\n}\nstatic inline int mls_export_netlbl_cat(struct policydb *p,\n\t\t\t\t\tstruct context *context,\n\t\t\t\t\tstruct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOMEM;\n}\nstatic inline int mls_import_netlbl_cat(struct policydb *p,\n\t\t\t\t\tstruct context *context,\n\t\t\t\t\tstruct netlbl_lsm_secattr *secattr)\n{\n\treturn -ENOMEM;\n}\n#endif\n\nstatic inline u32 mls_range_hash(const struct mls_range *r, u32 hash)\n{\n\thash = jhash_2words(r->level[0].sens, r->level[1].sens, hash);\n\thash = ebitmap_hash(&r->level[0].cat, hash);\n\thash = ebitmap_hash(&r->level[1].cat, hash);\n\treturn hash;\n}\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}