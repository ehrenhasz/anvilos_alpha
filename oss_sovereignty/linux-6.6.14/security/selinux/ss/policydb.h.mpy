{
  "module_name": "policydb.h",
  "hash_id": "3aabeea6c55b05c189ed05465f74ace783589a5c3c9b323edc05d310a613ebb2",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/ss/policydb.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _SS_POLICYDB_H_\n#define _SS_POLICYDB_H_\n\n#include \"symtab.h\"\n#include \"avtab.h\"\n#include \"sidtab.h\"\n#include \"ebitmap.h\"\n#include \"mls_types.h\"\n#include \"context.h\"\n#include \"constraint.h\"\n\n \n\n \nstruct perm_datum {\n\tu32 value;\t\t \n};\n\n \nstruct common_datum {\n\tu32 value;\t\t\t \n\tstruct symtab permissions;\t \n};\n\n \nstruct class_datum {\n\tu32 value;\t\t\t \n\tchar *comkey;\t\t\t \n\tstruct common_datum *comdatum;\t \n\tstruct symtab permissions;\t \n\tstruct constraint_node *constraints;\t \n\tstruct constraint_node *validatetrans;\t \n \n#define DEFAULT_SOURCE         1\n#define DEFAULT_TARGET         2\n\tchar default_user;\n\tchar default_role;\n\tchar default_type;\n \n#define DEFAULT_SOURCE_LOW     1\n#define DEFAULT_SOURCE_HIGH    2\n#define DEFAULT_SOURCE_LOW_HIGH        3\n#define DEFAULT_TARGET_LOW     4\n#define DEFAULT_TARGET_HIGH    5\n#define DEFAULT_TARGET_LOW_HIGH        6\n#define DEFAULT_GLBLUB\t\t7\n\tchar default_range;\n};\n\n \nstruct role_datum {\n\tu32 value;\t\t\t \n\tu32 bounds;\t\t\t \n\tstruct ebitmap dominates;\t \n\tstruct ebitmap types;\t\t \n};\n\nstruct role_trans_key {\n\tu32 role;\t\t \n\tu32 type;\t\t \n\tu32 tclass;\t\t \n};\n\nstruct role_trans_datum {\n\tu32 new_role;\t\t \n};\n\nstruct filename_trans_key {\n\tu32 ttype;\t\t \n\tu16 tclass;\t\t \n\tconst char *name;\t \n};\n\nstruct filename_trans_datum {\n\tstruct ebitmap stypes;\t \n\tu32 otype;\t\t \n\tstruct filename_trans_datum *next;\t \n};\n\nstruct role_allow {\n\tu32 role;\t\t \n\tu32 new_role;\t\t \n\tstruct role_allow *next;\n};\n\n \nstruct type_datum {\n\tu32 value;\t\t \n\tu32 bounds;\t\t \n\tunsigned char primary;\t \n\tunsigned char attribute; \n};\n\n \nstruct user_datum {\n\tu32 value;\t\t\t \n\tu32 bounds;\t\t\t \n\tstruct ebitmap roles;\t\t \n\tstruct mls_range range;\t\t \n\tstruct mls_level dfltlevel;\t \n};\n\n\n \nstruct level_datum {\n\tstruct mls_level *level;\t \n\tunsigned char isalias;\t \n};\n\n \nstruct cat_datum {\n\tu32 value;\t\t \n\tunsigned char isalias;   \n};\n\nstruct range_trans {\n\tu32 source_type;\n\tu32 target_type;\n\tu32 target_class;\n};\n\n \nstruct cond_bool_datum {\n\t__u32 value;\t\t \n\tint state;\n};\n\nstruct cond_node;\n\n \nstruct type_set {\n\tstruct ebitmap types;\n\tstruct ebitmap negset;\n\tu32 flags;\n};\n\n \nstruct ocontext {\n\tunion {\n\t\tchar *name;\t \n\t\tstruct {\n\t\t\tu8 protocol;\n\t\t\tu16 low_port;\n\t\t\tu16 high_port;\n\t\t} port;\t\t \n\t\tstruct {\n\t\t\tu32 addr;\n\t\t\tu32 mask;\n\t\t} node;\t\t \n\t\tstruct {\n\t\t\tu32 addr[4];\n\t\t\tu32 mask[4];\n\t\t} node6;         \n\t\tstruct {\n\t\t\tu64 subnet_prefix;\n\t\t\tu16 low_pkey;\n\t\t\tu16 high_pkey;\n\t\t} ibpkey;\n\t\tstruct {\n\t\t\tchar *dev_name;\n\t\t\tu8 port;\n\t\t} ibendport;\n\t} u;\n\tunion {\n\t\tu32 sclass;   \n\t\tu32 behavior;   \n\t} v;\n\tstruct context context[2];\t \n\tu32 sid[2];\t \n\tstruct ocontext *next;\n};\n\nstruct genfs {\n\tchar *fstype;\n\tstruct ocontext *head;\n\tstruct genfs *next;\n};\n\n \n#define SYM_COMMONS 0\n#define SYM_CLASSES 1\n#define SYM_ROLES   2\n#define SYM_TYPES   3\n#define SYM_USERS   4\n#define SYM_BOOLS   5\n#define SYM_LEVELS  6\n#define SYM_CATS    7\n#define SYM_NUM     8\n\n \n#define OCON_ISID\t0  \n#define OCON_FS\t\t1  \n#define OCON_PORT\t2  \n#define OCON_NETIF\t3  \n#define OCON_NODE\t4  \n#define OCON_FSUSE\t5  \n#define OCON_NODE6\t6  \n#define OCON_IBPKEY\t7  \n#define OCON_IBENDPORT\t8  \n#define OCON_NUM\t9\n\n \nstruct policydb {\n\tint mls_enabled;\n\n\t \n\tstruct symtab symtab[SYM_NUM];\n#define p_commons symtab[SYM_COMMONS]\n#define p_classes symtab[SYM_CLASSES]\n#define p_roles symtab[SYM_ROLES]\n#define p_types symtab[SYM_TYPES]\n#define p_users symtab[SYM_USERS]\n#define p_bools symtab[SYM_BOOLS]\n#define p_levels symtab[SYM_LEVELS]\n#define p_cats symtab[SYM_CATS]\n\n\t \n\tchar\t\t**sym_val_to_name[SYM_NUM];\n\n\t \n\tstruct class_datum **class_val_to_struct;\n\tstruct role_datum **role_val_to_struct;\n\tstruct user_datum **user_val_to_struct;\n\tstruct type_datum **type_val_to_struct;\n\n\t \n\tstruct avtab te_avtab;\n\n\t \n\tstruct hashtab role_tr;\n\n\t \n\t \n\tstruct ebitmap filename_trans_ttypes;\n\t \n\tstruct hashtab filename_trans;\n\t \n\tu32 compat_filename_trans_count;\n\n\t \n\tstruct cond_bool_datum **bool_val_to_struct;\n\t \n\tstruct avtab te_cond_avtab;\n\t \n\tstruct cond_node *cond_list;\n\tu32 cond_list_len;\n\n\t \n\tstruct role_allow *role_allow;\n\n\t \n\tstruct ocontext *ocontexts[OCON_NUM];\n\n\t \n\tstruct genfs *genfs;\n\n\t \n\tstruct hashtab range_tr;\n\n\t \n\tstruct ebitmap *type_attr_map_array;\n\n\tstruct ebitmap policycaps;\n\n\tstruct ebitmap permissive_map;\n\n\t \n\tsize_t len;\n\n\tunsigned int policyvers;\n\n\tunsigned int reject_unknown : 1;\n\tunsigned int allow_unknown : 1;\n\n\tu16 process_class;\n\tu32 process_trans_perms;\n} __randomize_layout;\n\nextern void policydb_destroy(struct policydb *p);\nextern int policydb_load_isids(struct policydb *p, struct sidtab *s);\nextern int policydb_context_isvalid(struct policydb *p, struct context *c);\nextern int policydb_class_isvalid(struct policydb *p, unsigned int class);\nextern int policydb_type_isvalid(struct policydb *p, unsigned int type);\nextern int policydb_role_isvalid(struct policydb *p, unsigned int role);\nextern int policydb_read(struct policydb *p, void *fp);\nextern int policydb_write(struct policydb *p, void *fp);\n\nextern struct filename_trans_datum *policydb_filenametr_search(\n\tstruct policydb *p, struct filename_trans_key *key);\n\nextern struct mls_range *policydb_rangetr_search(\n\tstruct policydb *p, struct range_trans *key);\n\nextern struct role_trans_datum *policydb_roletr_search(\n\tstruct policydb *p, struct role_trans_key *key);\n\n#define POLICYDB_CONFIG_MLS    1\n\n \n#define REJECT_UNKNOWN\t0x00000002\n#define ALLOW_UNKNOWN\t0x00000004\n\n#define OBJECT_R \"object_r\"\n#define OBJECT_R_VAL 1\n\n#define POLICYDB_MAGIC SELINUX_MAGIC\n#define POLICYDB_STRING \"SE Linux\"\n\nstruct policy_file {\n\tchar *data;\n\tsize_t len;\n};\n\nstruct policy_data {\n\tstruct policydb *p;\n\tvoid *fp;\n};\n\nstatic inline int next_entry(void *buf, struct policy_file *fp, size_t bytes)\n{\n\tif (bytes > fp->len)\n\t\treturn -EINVAL;\n\n\tmemcpy(buf, fp->data, bytes);\n\tfp->data += bytes;\n\tfp->len -= bytes;\n\treturn 0;\n}\n\nstatic inline int put_entry(const void *buf, size_t bytes, size_t num, struct policy_file *fp)\n{\n\tsize_t len;\n\n\tif (unlikely(check_mul_overflow(bytes, num, &len)))\n\t\treturn -EINVAL;\n\n\tif (len > fp->len)\n\t\treturn -EINVAL;\n\tmemcpy(fp->data, buf, len);\n\tfp->data += len;\n\tfp->len -= len;\n\n\treturn 0;\n}\n\nstatic inline char *sym_name(struct policydb *p, unsigned int sym_num, unsigned int element_nr)\n{\n\treturn p->sym_val_to_name[sym_num][element_nr];\n}\n\nextern u16 string_to_security_class(struct policydb *p, const char *name);\nextern u32 string_to_av_perm(struct policydb *p, u16 tclass, const char *name);\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}