{
  "module_name": "objsec.h",
  "hash_id": "80d6b9acf61bb4a32dd8511fe8769ce0827a5a2468e8db1cb2988a4f9ef24b92",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/include/objsec.h",
  "human_readable_source": " \n \n#ifndef _SELINUX_OBJSEC_H_\n#define _SELINUX_OBJSEC_H_\n\n#include <linux/list.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/binfmts.h>\n#include <linux/in.h>\n#include <linux/spinlock.h>\n#include <linux/lsm_hooks.h>\n#include <linux/msg.h>\n#include <net/net_namespace.h>\n#include \"flask.h\"\n#include \"avc.h\"\n\nstruct task_security_struct {\n\tu32 osid;\t\t \n\tu32 sid;\t\t \n\tu32 exec_sid;\t\t \n\tu32 create_sid;\t\t \n\tu32 keycreate_sid;\t \n\tu32 sockcreate_sid;\t \n} __randomize_layout;\n\nenum label_initialized {\n\tLABEL_INVALID,\t\t \n\tLABEL_INITIALIZED,\t \n\tLABEL_PENDING\n};\n\nstruct inode_security_struct {\n\tstruct inode *inode;\t \n\tstruct list_head list;\t \n\tu32 task_sid;\t\t \n\tu32 sid;\t\t \n\tu16 sclass;\t\t \n\tunsigned char initialized;\t \n\tspinlock_t lock;\n};\n\nstruct file_security_struct {\n\tu32 sid;\t\t \n\tu32 fown_sid;\t\t \n\tu32 isid;\t\t \n\tu32 pseqno;\t\t \n};\n\nstruct superblock_security_struct {\n\tu32 sid;\t\t\t \n\tu32 def_sid;\t\t\t \n\tu32 mntpoint_sid;\t\t \n\tunsigned short behavior;\t \n\tunsigned short flags;\t\t \n\tstruct mutex lock;\n\tstruct list_head isec_head;\n\tspinlock_t isec_lock;\n};\n\nstruct msg_security_struct {\n\tu32 sid;\t \n};\n\nstruct ipc_security_struct {\n\tu16 sclass;\t \n\tu32 sid;\t \n};\n\nstruct netif_security_struct {\n\tstruct net *ns;\t\t\t \n\tint ifindex;\t\t\t \n\tu32 sid;\t\t\t \n};\n\nstruct netnode_security_struct {\n\tunion {\n\t\t__be32 ipv4;\t\t \n\t\tstruct in6_addr ipv6;\t \n\t} addr;\n\tu32 sid;\t\t\t \n\tu16 family;\t\t\t \n};\n\nstruct netport_security_struct {\n\tu32 sid;\t\t\t \n\tu16 port;\t\t\t \n\tu8 protocol;\t\t\t \n};\n\nstruct sk_security_struct {\n#ifdef CONFIG_NETLABEL\n\tenum {\t\t\t\t \n\t\tNLBL_UNSET = 0,\n\t\tNLBL_REQUIRE,\n\t\tNLBL_LABELED,\n\t\tNLBL_REQSKB,\n\t\tNLBL_CONNLABELED,\n\t} nlbl_state;\n\tstruct netlbl_lsm_secattr *nlbl_secattr;  \n#endif\n\tu32 sid;\t\t\t \n\tu32 peer_sid;\t\t\t \n\tu16 sclass;\t\t\t \n\tenum {\t\t\t\t \n\t\tSCTP_ASSOC_UNSET = 0,\n\t\tSCTP_ASSOC_SET,\n\t} sctp_assoc_state;\n};\n\nstruct tun_security_struct {\n\tu32 sid;\t\t\t \n};\n\nstruct key_security_struct {\n\tu32 sid;\t \n};\n\nstruct ib_security_struct {\n\tu32 sid;         \n};\n\nstruct pkey_security_struct {\n\tu64\tsubnet_prefix;  \n\tu16\tpkey;\t \n\tu32\tsid;\t \n};\n\nstruct bpf_security_struct {\n\tu32 sid;   \n};\n\nstruct perf_event_security_struct {\n\tu32 sid;   \n};\n\nextern struct lsm_blob_sizes selinux_blob_sizes;\nstatic inline struct task_security_struct *selinux_cred(const struct cred *cred)\n{\n\treturn cred->security + selinux_blob_sizes.lbs_cred;\n}\n\nstatic inline struct file_security_struct *selinux_file(const struct file *file)\n{\n\treturn file->f_security + selinux_blob_sizes.lbs_file;\n}\n\nstatic inline struct inode_security_struct *selinux_inode(\n\t\t\t\t\t\tconst struct inode *inode)\n{\n\tif (unlikely(!inode->i_security))\n\t\treturn NULL;\n\treturn inode->i_security + selinux_blob_sizes.lbs_inode;\n}\n\nstatic inline struct msg_security_struct *selinux_msg_msg(\n\t\t\t\t\t\tconst struct msg_msg *msg_msg)\n{\n\treturn msg_msg->security + selinux_blob_sizes.lbs_msg_msg;\n}\n\nstatic inline struct ipc_security_struct *selinux_ipc(\n\t\t\t\t\t\tconst struct kern_ipc_perm *ipc)\n{\n\treturn ipc->security + selinux_blob_sizes.lbs_ipc;\n}\n\n \nstatic inline u32 current_sid(void)\n{\n\tconst struct task_security_struct *tsec = selinux_cred(current_cred());\n\n\treturn tsec->sid;\n}\n\nstatic inline struct superblock_security_struct *selinux_superblock(\n\t\t\t\t\tconst struct super_block *superblock)\n{\n\treturn superblock->s_security + selinux_blob_sizes.lbs_superblock;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}