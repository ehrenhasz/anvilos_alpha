{
  "module_name": "xfrm.h",
  "hash_id": "e0d4d253b1d263f4817b48cffd08b49269d9579ad710e38c7895c12a96b8279f",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/include/xfrm.h",
  "human_readable_source": " \n \n#ifndef _SELINUX_XFRM_H_\n#define _SELINUX_XFRM_H_\n\n#include <linux/lsm_audit.h>\n#include <net/flow.h>\n#include <net/xfrm.h>\n\nint selinux_xfrm_policy_alloc(struct xfrm_sec_ctx **ctxp,\n\t\t\t      struct xfrm_user_sec_ctx *uctx,\n\t\t\t      gfp_t gfp);\nint selinux_xfrm_policy_clone(struct xfrm_sec_ctx *old_ctx,\n\t\t\t      struct xfrm_sec_ctx **new_ctxp);\nvoid selinux_xfrm_policy_free(struct xfrm_sec_ctx *ctx);\nint selinux_xfrm_policy_delete(struct xfrm_sec_ctx *ctx);\nint selinux_xfrm_state_alloc(struct xfrm_state *x,\n\t\t\t     struct xfrm_user_sec_ctx *uctx);\nint selinux_xfrm_state_alloc_acquire(struct xfrm_state *x,\n\t\t\t\t     struct xfrm_sec_ctx *polsec, u32 secid);\nvoid selinux_xfrm_state_free(struct xfrm_state *x);\nint selinux_xfrm_state_delete(struct xfrm_state *x);\nint selinux_xfrm_policy_lookup(struct xfrm_sec_ctx *ctx, u32 fl_secid);\nint selinux_xfrm_state_pol_flow_match(struct xfrm_state *x,\n\t\t\t\t      struct xfrm_policy *xp,\n\t\t\t\t      const struct flowi_common *flic);\n\n#ifdef CONFIG_SECURITY_NETWORK_XFRM\nextern atomic_t selinux_xfrm_refcount;\n\nstatic inline int selinux_xfrm_enabled(void)\n{\n\treturn (atomic_read(&selinux_xfrm_refcount) > 0);\n}\n\nint selinux_xfrm_sock_rcv_skb(u32 sk_sid, struct sk_buff *skb,\n\t\t\t      struct common_audit_data *ad);\nint selinux_xfrm_postroute_last(u32 sk_sid, struct sk_buff *skb,\n\t\t\t\tstruct common_audit_data *ad, u8 proto);\nint selinux_xfrm_decode_session(struct sk_buff *skb, u32 *sid, int ckall);\nint selinux_xfrm_skb_sid(struct sk_buff *skb, u32 *sid);\n\nstatic inline void selinux_xfrm_notify_policyload(void)\n{\n\tstruct net *net;\n\n\tdown_read(&net_rwsem);\n\tfor_each_net(net)\n\t\trt_genid_bump_all(net);\n\tup_read(&net_rwsem);\n}\n#else\nstatic inline int selinux_xfrm_enabled(void)\n{\n\treturn 0;\n}\n\nstatic inline int selinux_xfrm_sock_rcv_skb(u32 sk_sid, struct sk_buff *skb,\n\t\t\t\t\t    struct common_audit_data *ad)\n{\n\treturn 0;\n}\n\nstatic inline int selinux_xfrm_postroute_last(u32 sk_sid, struct sk_buff *skb,\n\t\t\t\t\t      struct common_audit_data *ad,\n\t\t\t\t\t      u8 proto)\n{\n\treturn 0;\n}\n\nstatic inline int selinux_xfrm_decode_session(struct sk_buff *skb, u32 *sid,\n\t\t\t\t\t      int ckall)\n{\n\t*sid = SECSID_NULL;\n\treturn 0;\n}\n\nstatic inline void selinux_xfrm_notify_policyload(void)\n{\n}\n\nstatic inline int selinux_xfrm_skb_sid(struct sk_buff *skb, u32 *sid)\n{\n\t*sid = SECSID_NULL;\n\treturn 0;\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}