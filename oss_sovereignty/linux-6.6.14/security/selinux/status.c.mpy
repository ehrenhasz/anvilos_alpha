{
  "module_name": "status.c",
  "hash_id": "db1ba08096f06ed922ab14b13aa47d446eac0c54299aabc7853a73b6cfd5cccd",
  "original_prompt": "Ingested from linux-6.6.14/security/selinux/status.c",
  "human_readable_source": "\n \n#include <linux/kernel.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n#include <linux/mutex.h>\n#include \"avc.h\"\n#include \"security.h\"\n\n \n\n \nstruct page *selinux_kernel_status_page(void)\n{\n\tstruct selinux_kernel_status   *status;\n\tstruct page\t\t       *result = NULL;\n\n\tmutex_lock(&selinux_state.status_lock);\n\tif (!selinux_state.status_page) {\n\t\tselinux_state.status_page = alloc_page(GFP_KERNEL|__GFP_ZERO);\n\n\t\tif (selinux_state.status_page) {\n\t\t\tstatus = page_address(selinux_state.status_page);\n\n\t\t\tstatus->version = SELINUX_KERNEL_STATUS_VERSION;\n\t\t\tstatus->sequence = 0;\n\t\t\tstatus->enforcing = enforcing_enabled();\n\t\t\t \n\t\t\tstatus->policyload = 0;\n\t\t\tstatus->deny_unknown =\n\t\t\t\t!security_get_allow_unknown();\n\t\t}\n\t}\n\tresult = selinux_state.status_page;\n\tmutex_unlock(&selinux_state.status_lock);\n\n\treturn result;\n}\n\n \nvoid selinux_status_update_setenforce(bool enforcing)\n{\n\tstruct selinux_kernel_status   *status;\n\n\tmutex_lock(&selinux_state.status_lock);\n\tif (selinux_state.status_page) {\n\t\tstatus = page_address(selinux_state.status_page);\n\n\t\tstatus->sequence++;\n\t\tsmp_wmb();\n\n\t\tstatus->enforcing = enforcing ? 1 : 0;\n\n\t\tsmp_wmb();\n\t\tstatus->sequence++;\n\t}\n\tmutex_unlock(&selinux_state.status_lock);\n}\n\n \nvoid selinux_status_update_policyload(u32 seqno)\n{\n\tstruct selinux_kernel_status   *status;\n\n\tmutex_lock(&selinux_state.status_lock);\n\tif (selinux_state.status_page) {\n\t\tstatus = page_address(selinux_state.status_page);\n\n\t\tstatus->sequence++;\n\t\tsmp_wmb();\n\n\t\tstatus->policyload = seqno;\n\t\tstatus->deny_unknown = !security_get_allow_unknown();\n\n\t\tsmp_wmb();\n\t\tstatus->sequence++;\n\t}\n\tmutex_unlock(&selinux_state.status_lock);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}