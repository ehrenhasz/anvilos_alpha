{
  "module_name": "Kconfig",
  "hash_id": "7af2d7035de86472a979c37c98f56730cd118bafc0322716781867caaf9c95e8",
  "original_prompt": "Ingested from linux-6.6.14/security/Kconfig",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n#\n# Security configuration\n#\n\nmenu \"Security options\"\n\nsource \"security/keys/Kconfig\"\n\nconfig SECURITY_DMESG_RESTRICT\n\tbool \"Restrict unprivileged access to the kernel syslog\"\n\tdefault n\n\thelp\n\t  This enforces restrictions on unprivileged users reading the kernel\n\t  syslog via dmesg(8).\n\n\t  If this option is not selected, no restrictions will be enforced\n\t  unless the dmesg_restrict sysctl is explicitly set to (1).\n\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITY\n\tbool \"Enable different security models\"\n\tdepends on SYSFS\n\tdepends on MULTIUSER\n\thelp\n\t  This allows you to choose different security modules to be\n\t  configured into your kernel.\n\n\t  If this option is not selected, the default Linux security\n\t  model will be used.\n\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITYFS\n\tbool \"Enable the securityfs filesystem\"\n\thelp\n\t  This will build the securityfs filesystem.  It is currently used by\n\t  various security modules (AppArmor, IMA, SafeSetID, TOMOYO, TPM).\n\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITY_NETWORK\n\tbool \"Socket and Networking Security Hooks\"\n\tdepends on SECURITY\n\thelp\n\t  This enables the socket and networking security hooks.\n\t  If enabled, a security module can use these hooks to\n\t  implement socket and networking access controls.\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITY_INFINIBAND\n\tbool \"Infiniband Security Hooks\"\n\tdepends on SECURITY && INFINIBAND\n\thelp\n\t  This enables the Infiniband security hooks.\n\t  If enabled, a security module can use these hooks to\n\t  implement Infiniband access controls.\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITY_NETWORK_XFRM\n\tbool \"XFRM (IPSec) Networking Security Hooks\"\n\tdepends on XFRM && SECURITY_NETWORK\n\thelp\n\t  This enables the XFRM (IPSec) networking security hooks.\n\t  If enabled, a security module can use these hooks to\n\t  implement per-packet access controls based on labels\n\t  derived from IPSec policy.  Non-IPSec communications are\n\t  designated as unlabelled, and only sockets authorized\n\t  to communicate unlabelled data can send without using\n\t  IPSec.\n\t  If you are unsure how to answer this question, answer N.\n\nconfig SECURITY_PATH\n\tbool \"Security hooks for pathname based access control\"\n\tdepends on SECURITY\n\thelp\n\t  This enables the security hooks for pathname based access control.\n\t  If enabled, a security module can use these hooks to\n\t  implement pathname based access controls.\n\t  If you are unsure how to answer this question, answer N.\n\nconfig INTEL_TXT\n\tbool \"Enable Intel(R) Trusted Execution Technology (Intel(R) TXT)\"\n\tdepends on HAVE_INTEL_TXT\n\thelp\n\t  This option enables support for booting the kernel with the\n\t  Trusted Boot (tboot) module. This will utilize\n\t  Intel(R) Trusted Execution Technology to perform a measured launch\n\t  of the kernel. If the system does not support Intel(R) TXT, this\n\t  will have no effect.\n\n\t  Intel TXT will provide higher assurance of system configuration and\n\t  initial state as well as data reset protection.  This is used to\n\t  create a robust initial kernel measurement and verification, which\n\t  helps to ensure that kernel security mechanisms are functioning\n\t  correctly. This level of protection requires a root of trust outside\n\t  of the kernel itself.\n\n\t  Intel TXT also helps solve real end user concerns about having\n\t  confidence that their hardware is running the VMM or kernel that\n\t  it was configured with, especially since they may be responsible for\n\t  providing such assurances to VMs and services running on it.\n\n\t  See <https://www.intel.com/technology/security/> for more information\n\t  about Intel(R) TXT.\n\t  See <http://tboot.sourceforge.net> for more information about tboot.\n\t  See Documentation/arch/x86/intel_txt.rst for a description of how to enable\n\t  Intel TXT support in a kernel boot.\n\n\t  If you are unsure as to whether this is required, answer N.\n\nconfig LSM_MMAP_MIN_ADDR\n\tint \"Low address space for LSM to protect from user allocation\"\n\tdepends on SECURITY && SECURITY_SELINUX\n\tdefault 32768 if ARM || (ARM64 && COMPAT)\n\tdefault 65536\n\thelp\n\t  This is the portion of low virtual memory which should be protected\n\t  from userspace allocation.  Keeping a user from writing to low pages\n\t  can help reduce the impact of kernel NULL pointer bugs.\n\n\t  For most ia64, ppc64 and x86 users with lots of address space\n\t  a value of 65536 is reasonable and should cause no problems.\n\t  On arm and other archs it should not be higher than 32768.\n\t  Programs which use vm86 functionality or have some need to map\n\t  this low address space will need the permission specific to the\n\t  systems running LSM.\n\nconfig HARDENED_USERCOPY\n\tbool \"Harden memory copies between kernel and userspace\"\n\timply STRICT_DEVMEM\n\thelp\n\t  This option checks for obviously wrong memory regions when\n\t  copying memory to/from the kernel (via copy_to_user() and\n\t  copy_from_user() functions) by rejecting memory ranges that\n\t  are larger than the specified heap object, span multiple\n\t  separately allocated pages, are not on the process stack,\n\t  or are part of the kernel text. This prevents entire classes\n\t  of heap overflow exploits and similar kernel memory exposures.\n\nconfig FORTIFY_SOURCE\n\tbool \"Harden common str/mem functions against buffer overflows\"\n\tdepends on ARCH_HAS_FORTIFY_SOURCE\n\t# https://bugs.llvm.org/show_bug.cgi?id=41459\n\tdepends on !CC_IS_CLANG || CLANG_VERSION >= 120001\n\t# https://github.com/llvm/llvm-project/issues/53645\n\tdepends on !CC_IS_CLANG || !X86_32\n\thelp\n\t  Detect overflows of buffers in common string and memory functions\n\t  where the compiler can determine and validate the buffer sizes.\n\nconfig STATIC_USERMODEHELPER\n\tbool \"Force all usermode helper calls through a single binary\"\n\thelp\n\t  By default, the kernel can call many different userspace\n\t  binary programs through the \"usermode helper\" kernel\n\t  interface.  Some of these binaries are statically defined\n\t  either in the kernel code itself, or as a kernel configuration\n\t  option.  However, some of these are dynamically created at\n\t  runtime, or can be modified after the kernel has started up.\n\t  To provide an additional layer of security, route all of these\n\t  calls through a single executable that can not have its name\n\t  changed.\n\n\t  Note, it is up to this single binary to then call the relevant\n\t  \"real\" usermode helper binary, based on the first argument\n\t  passed to it.  If desired, this program can filter and pick\n\t  and choose what real programs are called.\n\n\t  If you wish for all usermode helper programs are to be\n\t  disabled, choose this option and then set\n\t  STATIC_USERMODEHELPER_PATH to an empty string.\n\nconfig STATIC_USERMODEHELPER_PATH\n\tstring \"Path to the static usermode helper binary\"\n\tdepends on STATIC_USERMODEHELPER\n\tdefault \"/sbin/usermode-helper\"\n\thelp\n\t  The binary called by the kernel when any usermode helper\n\t  program is wish to be run.  The \"real\" application's name will\n\t  be in the first argument passed to this program on the command\n\t  line.\n\n\t  If you wish for all usermode helper programs to be disabled,\n\t  specify an empty string here (i.e. \"\").\n\nsource \"security/selinux/Kconfig\"\nsource \"security/smack/Kconfig\"\nsource \"security/tomoyo/Kconfig\"\nsource \"security/apparmor/Kconfig\"\nsource \"security/loadpin/Kconfig\"\nsource \"security/yama/Kconfig\"\nsource \"security/safesetid/Kconfig\"\nsource \"security/lockdown/Kconfig\"\nsource \"security/landlock/Kconfig\"\n\nsource \"security/integrity/Kconfig\"\n\nchoice\n\tprompt \"First legacy 'major LSM' to be initialized\"\n\tdefault DEFAULT_SECURITY_SELINUX if SECURITY_SELINUX\n\tdefault DEFAULT_SECURITY_SMACK if SECURITY_SMACK\n\tdefault DEFAULT_SECURITY_TOMOYO if SECURITY_TOMOYO\n\tdefault DEFAULT_SECURITY_APPARMOR if SECURITY_APPARMOR\n\tdefault DEFAULT_SECURITY_DAC\n\n\thelp\n\t  This choice is there only for converting CONFIG_DEFAULT_SECURITY\n\t  in old kernel configs to CONFIG_LSM in new kernel configs. Don't\n\t  change this choice unless you are creating a fresh kernel config,\n\t  for this choice will be ignored after CONFIG_LSM has been set.\n\n\t  Selects the legacy \"major security module\" that will be\n\t  initialized first. Overridden by non-default CONFIG_LSM.\n\n\tconfig DEFAULT_SECURITY_SELINUX\n\t\tbool \"SELinux\" if SECURITY_SELINUX=y\n\n\tconfig DEFAULT_SECURITY_SMACK\n\t\tbool \"Simplified Mandatory Access Control\" if SECURITY_SMACK=y\n\n\tconfig DEFAULT_SECURITY_TOMOYO\n\t\tbool \"TOMOYO\" if SECURITY_TOMOYO=y\n\n\tconfig DEFAULT_SECURITY_APPARMOR\n\t\tbool \"AppArmor\" if SECURITY_APPARMOR=y\n\n\tconfig DEFAULT_SECURITY_DAC\n\t\tbool \"Unix Discretionary Access Controls\"\n\nendchoice\n\nconfig LSM\n\tstring \"Ordered list of enabled LSMs\"\n\tdefault \"landlock,lockdown,yama,loadpin,safesetid,smack,selinux,tomoyo,apparmor,bpf\" if DEFAULT_SECURITY_SMACK\n\tdefault \"landlock,lockdown,yama,loadpin,safesetid,apparmor,selinux,smack,tomoyo,bpf\" if DEFAULT_SECURITY_APPARMOR\n\tdefault \"landlock,lockdown,yama,loadpin,safesetid,tomoyo,bpf\" if DEFAULT_SECURITY_TOMOYO\n\tdefault \"landlock,lockdown,yama,loadpin,safesetid,bpf\" if DEFAULT_SECURITY_DAC\n\tdefault \"landlock,lockdown,yama,loadpin,safesetid,selinux,smack,tomoyo,apparmor,bpf\"\n\thelp\n\t  A comma-separated list of LSMs, in initialization order.\n\t  Any LSMs left off this list, except for those with order\n\t  LSM_ORDER_FIRST and LSM_ORDER_LAST, which are always enabled\n\t  if selected in the kernel configuration, will be ignored.\n\t  This can be controlled at boot with the \"lsm=\" parameter.\n\n\t  If unsure, leave this as the default.\n\nsource \"security/Kconfig.hardening\"\n\nendmenu\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}