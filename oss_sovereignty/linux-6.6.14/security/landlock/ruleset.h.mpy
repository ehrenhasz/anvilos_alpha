{
  "module_name": "ruleset.h",
  "hash_id": "acd550458746d58cd7a52259a70437e82be74ebe95353f11c7c94bc39f894b55",
  "original_prompt": "Ingested from linux-6.6.14/security/landlock/ruleset.h",
  "human_readable_source": " \n \n\n#ifndef _SECURITY_LANDLOCK_RULESET_H\n#define _SECURITY_LANDLOCK_RULESET_H\n\n#include <linux/bitops.h>\n#include <linux/build_bug.h>\n#include <linux/mutex.h>\n#include <linux/rbtree.h>\n#include <linux/refcount.h>\n#include <linux/workqueue.h>\n\n#include \"limits.h\"\n#include \"object.h\"\n\ntypedef u16 access_mask_t;\n \nstatic_assert(BITS_PER_TYPE(access_mask_t) >= LANDLOCK_NUM_ACCESS_FS);\n \nstatic_assert(sizeof(unsigned long) >= sizeof(access_mask_t));\n\ntypedef u16 layer_mask_t;\n \nstatic_assert(BITS_PER_TYPE(layer_mask_t) >= LANDLOCK_MAX_NUM_LAYERS);\n\n \nstruct landlock_layer {\n\t \n\tu16 level;\n\t \n\taccess_mask_t access;\n};\n\n \nstruct landlock_rule {\n\t \n\tstruct rb_node node;\n\t \n\tstruct landlock_object *object;\n\t \n\tu32 num_layers;\n\t \n\tstruct landlock_layer layers[] __counted_by(num_layers);\n};\n\n \nstruct landlock_hierarchy {\n\t \n\tstruct landlock_hierarchy *parent;\n\t \n\trefcount_t usage;\n};\n\n \nstruct landlock_ruleset {\n\t \n\tstruct rb_root root;\n\t \n\tstruct landlock_hierarchy *hierarchy;\n\tunion {\n\t\t \n\t\tstruct work_struct work_free;\n\t\tstruct {\n\t\t\t \n\t\t\tstruct mutex lock;\n\t\t\t \n\t\t\trefcount_t usage;\n\t\t\t \n\t\t\tu32 num_rules;\n\t\t\t \n\t\t\tu32 num_layers;\n\t\t\t \n\t\t\taccess_mask_t fs_access_masks[];\n\t\t};\n\t};\n};\n\nstruct landlock_ruleset *\nlandlock_create_ruleset(const access_mask_t fs_access_mask);\n\nvoid landlock_put_ruleset(struct landlock_ruleset *const ruleset);\nvoid landlock_put_ruleset_deferred(struct landlock_ruleset *const ruleset);\n\nint landlock_insert_rule(struct landlock_ruleset *const ruleset,\n\t\t\t struct landlock_object *const object,\n\t\t\t const access_mask_t access);\n\nstruct landlock_ruleset *\nlandlock_merge_ruleset(struct landlock_ruleset *const parent,\n\t\t       struct landlock_ruleset *const ruleset);\n\nconst struct landlock_rule *\nlandlock_find_rule(const struct landlock_ruleset *const ruleset,\n\t\t   const struct landlock_object *const object);\n\nstatic inline void landlock_get_ruleset(struct landlock_ruleset *const ruleset)\n{\n\tif (ruleset)\n\t\trefcount_inc(&ruleset->usage);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}