{
  "module_name": "cred.h",
  "hash_id": "104ad9a61fe145bc064f7812056c4a64077507e545ecf253f7e529ce85268272",
  "original_prompt": "Ingested from linux-6.6.14/security/landlock/cred.h",
  "human_readable_source": " \n \n\n#ifndef _SECURITY_LANDLOCK_CRED_H\n#define _SECURITY_LANDLOCK_CRED_H\n\n#include <linux/cred.h>\n#include <linux/init.h>\n#include <linux/rcupdate.h>\n\n#include \"ruleset.h\"\n#include \"setup.h\"\n\nstruct landlock_cred_security {\n\tstruct landlock_ruleset *domain;\n};\n\nstatic inline struct landlock_cred_security *\nlandlock_cred(const struct cred *cred)\n{\n\treturn cred->security + landlock_blob_sizes.lbs_cred;\n}\n\nstatic inline const struct landlock_ruleset *landlock_get_current_domain(void)\n{\n\treturn landlock_cred(current_cred())->domain;\n}\n\n \nstatic inline const struct landlock_ruleset *\nlandlock_get_task_domain(const struct task_struct *const task)\n{\n\treturn landlock_cred(__task_cred(task))->domain;\n}\n\nstatic inline bool landlocked(const struct task_struct *const task)\n{\n\tbool has_dom;\n\n\tif (task == current)\n\t\treturn !!landlock_get_current_domain();\n\n\trcu_read_lock();\n\thas_dom = !!landlock_get_task_domain(task);\n\trcu_read_unlock();\n\treturn has_dom;\n}\n\n__init void landlock_add_cred_hooks(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}