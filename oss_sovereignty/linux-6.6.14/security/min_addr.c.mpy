{
  "module_name": "min_addr.c",
  "hash_id": "f23069ef5e244b38089565b79ad6ff0628758b2539f24ac479295164d1239f45",
  "original_prompt": "Ingested from linux-6.6.14/security/min_addr.c",
  "human_readable_source": "\n#include <linux/init.h>\n#include <linux/mm.h>\n#include <linux/security.h>\n#include <linux/sysctl.h>\n\n \nunsigned long mmap_min_addr;\n \nunsigned long dac_mmap_min_addr = CONFIG_DEFAULT_MMAP_MIN_ADDR;\n \n\n \nstatic void update_mmap_min_addr(void)\n{\n#ifdef CONFIG_LSM_MMAP_MIN_ADDR\n\tif (dac_mmap_min_addr > CONFIG_LSM_MMAP_MIN_ADDR)\n\t\tmmap_min_addr = dac_mmap_min_addr;\n\telse\n\t\tmmap_min_addr = CONFIG_LSM_MMAP_MIN_ADDR;\n#else\n\tmmap_min_addr = dac_mmap_min_addr;\n#endif\n}\n\n \nint mmap_min_addr_handler(struct ctl_table *table, int write,\n\t\t\t  void *buffer, size_t *lenp, loff_t *ppos)\n{\n\tint ret;\n\n\tif (write && !capable(CAP_SYS_RAWIO))\n\t\treturn -EPERM;\n\n\tret = proc_doulongvec_minmax(table, write, buffer, lenp, ppos);\n\n\tupdate_mmap_min_addr();\n\n\treturn ret;\n}\n\nstatic int __init init_mmap_min_addr(void)\n{\n\tupdate_mmap_min_addr();\n\n\treturn 0;\n}\npure_initcall(init_mmap_min_addr);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}