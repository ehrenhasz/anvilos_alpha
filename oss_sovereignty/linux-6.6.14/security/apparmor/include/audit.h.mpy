{
  "module_name": "audit.h",
  "hash_id": "31a6d78f2b3197ea3ac7588333faec11e33d0eabca0e739460f9b2864605880f",
  "original_prompt": "Ingested from linux-6.6.14/security/apparmor/include/audit.h",
  "human_readable_source": " \n \n\n#ifndef __AA_AUDIT_H\n#define __AA_AUDIT_H\n\n#include <linux/audit.h>\n#include <linux/fs.h>\n#include <linux/lsm_audit.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n\n#include \"file.h\"\n#include \"label.h\"\n\nextern const char *const audit_mode_names[];\n#define AUDIT_MAX_INDEX 5\nenum audit_mode {\n\tAUDIT_NORMAL,\t\t \n\tAUDIT_QUIET_DENIED,\t \n\tAUDIT_QUIET,\t\t \n\tAUDIT_NOQUIET,\t\t \n\tAUDIT_ALL\t\t \n};\n\nenum audit_type {\n\tAUDIT_APPARMOR_AUDIT,\n\tAUDIT_APPARMOR_ALLOWED,\n\tAUDIT_APPARMOR_DENIED,\n\tAUDIT_APPARMOR_HINT,\n\tAUDIT_APPARMOR_STATUS,\n\tAUDIT_APPARMOR_ERROR,\n\tAUDIT_APPARMOR_KILL,\n\tAUDIT_APPARMOR_AUTO\n};\n\n#define OP_NULL NULL\n\n#define OP_SYSCTL \"sysctl\"\n#define OP_CAPABLE \"capable\"\n\n#define OP_UNLINK \"unlink\"\n#define OP_MKDIR \"mkdir\"\n#define OP_RMDIR \"rmdir\"\n#define OP_MKNOD \"mknod\"\n#define OP_TRUNC \"truncate\"\n#define OP_LINK \"link\"\n#define OP_SYMLINK \"symlink\"\n#define OP_RENAME_SRC \"rename_src\"\n#define OP_RENAME_DEST \"rename_dest\"\n#define OP_CHMOD \"chmod\"\n#define OP_CHOWN \"chown\"\n#define OP_GETATTR \"getattr\"\n#define OP_OPEN \"open\"\n\n#define OP_FRECEIVE \"file_receive\"\n#define OP_FPERM \"file_perm\"\n#define OP_FLOCK \"file_lock\"\n#define OP_FMMAP \"file_mmap\"\n#define OP_FMPROT \"file_mprotect\"\n#define OP_INHERIT \"file_inherit\"\n\n#define OP_PIVOTROOT \"pivotroot\"\n#define OP_MOUNT \"mount\"\n#define OP_UMOUNT \"umount\"\n\n#define OP_CREATE \"create\"\n#define OP_POST_CREATE \"post_create\"\n#define OP_BIND \"bind\"\n#define OP_CONNECT \"connect\"\n#define OP_LISTEN \"listen\"\n#define OP_ACCEPT \"accept\"\n#define OP_SENDMSG \"sendmsg\"\n#define OP_RECVMSG \"recvmsg\"\n#define OP_GETSOCKNAME \"getsockname\"\n#define OP_GETPEERNAME \"getpeername\"\n#define OP_GETSOCKOPT \"getsockopt\"\n#define OP_SETSOCKOPT \"setsockopt\"\n#define OP_SHUTDOWN \"socket_shutdown\"\n\n#define OP_PTRACE \"ptrace\"\n#define OP_SIGNAL \"signal\"\n\n#define OP_EXEC \"exec\"\n\n#define OP_CHANGE_HAT \"change_hat\"\n#define OP_CHANGE_PROFILE \"change_profile\"\n#define OP_CHANGE_ONEXEC \"change_onexec\"\n#define OP_STACK \"stack\"\n#define OP_STACK_ONEXEC \"stack_onexec\"\n\n#define OP_SETPROCATTR \"setprocattr\"\n#define OP_SETRLIMIT \"setrlimit\"\n\n#define OP_PROF_REPL \"profile_replace\"\n#define OP_PROF_LOAD \"profile_load\"\n#define OP_PROF_RM \"profile_remove\"\n\n\nstruct apparmor_audit_data {\n\tint error;\n\tint type;\n\tu16 class;\n\tconst char *op;\n\tconst struct cred *subj_cred;\n\tstruct aa_label *subj_label;\n\tconst char *name;\n\tconst char *info;\n\tu32 request;\n\tu32 denied;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\tstruct aa_label *peer;\n\t\t\tunion {\n\t\t\t\tstruct {\n\t\t\t\t\tconst char *target;\n\t\t\t\t\tkuid_t ouid;\n\t\t\t\t} fs;\n\t\t\t\tstruct {\n\t\t\t\t\tint rlim;\n\t\t\t\t\tunsigned long max;\n\t\t\t\t} rlim;\n\t\t\t\tstruct {\n\t\t\t\t\tint signal;\n\t\t\t\t\tint unmappedsig;\n\t\t\t\t};\n\t\t\t\tstruct {\n\t\t\t\t\tint type, protocol;\n\t\t\t\t\tstruct sock *peer_sk;\n\t\t\t\t\tvoid *addr;\n\t\t\t\t\tint addrlen;\n\t\t\t\t} net;\n\t\t\t};\n\t\t};\n\t\tstruct {\n\t\t\tstruct aa_profile *profile;\n\t\t\tconst char *ns;\n\t\t\tlong pos;\n\t\t} iface;\n\t\tstruct {\n\t\t\tconst char *src_name;\n\t\t\tconst char *type;\n\t\t\tconst char *trans;\n\t\t\tconst char *data;\n\t\t\tunsigned long flags;\n\t\t} mnt;\n\t};\n\n\tstruct common_audit_data common;\n};\n\n \n#define aad(SA) (container_of(SA, struct apparmor_audit_data, common))\n#define aad_of_va(VA) aad((struct common_audit_data *)(VA))\n\n#define DEFINE_AUDIT_DATA(NAME, T, C, X)\t\t\t\t\\\n\t \t\\\n\tstruct apparmor_audit_data NAME = {\t\t\t\t\\\n\t\t.class = (C),\t\t\t\t\t\t\\\n\t\t.op = (X),                                              \\\n\t\t.common.type = (T),\t\t\t\t\t\\\n\t\t.common.u.tsk = NULL,\t\t\t\t\t\\\n\t\t.common.apparmor_audit_data = &NAME,\t\t\t\\\n\t};\n\nvoid aa_audit_msg(int type, struct apparmor_audit_data *ad,\n\t\t  void (*cb) (struct audit_buffer *, void *));\nint aa_audit(int type, struct aa_profile *profile,\n\t     struct apparmor_audit_data *ad,\n\t     void (*cb) (struct audit_buffer *, void *));\n\n#define aa_audit_error(ERROR, AD, CB)\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\\\n\t(AD)->error = (ERROR);\t\t\t\t\t\\\n\taa_audit_msg(AUDIT_APPARMOR_ERROR, (AD), (CB));\t\t\\\n\t(AD)->error;\t\t\t\t\t\\\n})\n\n\nstatic inline int complain_error(int error)\n{\n\tif (error == -EPERM || error == -EACCES)\n\t\treturn 0;\n\treturn error;\n}\n\nvoid aa_audit_rule_free(void *vrule);\nint aa_audit_rule_init(u32 field, u32 op, char *rulestr, void **vrule);\nint aa_audit_rule_known(struct audit_krule *rule);\nint aa_audit_rule_match(u32 sid, u32 field, u32 op, void *vrule);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}