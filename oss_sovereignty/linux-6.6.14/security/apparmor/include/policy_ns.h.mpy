{
  "module_name": "policy_ns.h",
  "hash_id": "91743c8ef9eca1c15dd275d96f474350a18da33f46f15ed1354935d51e210bf4",
  "original_prompt": "Ingested from linux-6.6.14/security/apparmor/include/policy_ns.h",
  "human_readable_source": " \n \n\n#ifndef __AA_NAMESPACE_H\n#define __AA_NAMESPACE_H\n\n#include <linux/kref.h>\n\n#include \"apparmor.h\"\n#include \"apparmorfs.h\"\n#include \"label.h\"\n#include \"policy.h\"\n\n\n \nstruct aa_ns_acct {\n\tint max_size;\n\tint max_count;\n\tint size;\n\tint count;\n};\n\n \nstruct aa_ns {\n\tstruct aa_policy base;\n\tstruct aa_ns *parent;\n\tstruct mutex lock;\n\tstruct aa_ns_acct acct;\n\tstruct aa_profile *unconfined;\n\tstruct list_head sub_ns;\n\tatomic_t uniq_null;\n\tlong uniq_id;\n\tint level;\n\tlong revision;\n\twait_queue_head_t wait;\n\n\tstruct aa_labelset labels;\n\tstruct list_head rawdata_list;\n\n\tstruct dentry *dents[AAFS_NS_SIZEOF];\n};\n\nextern struct aa_label *kernel_t;\nextern struct aa_ns *root_ns;\n\nextern const char *aa_hidden_ns_name;\n\n#define ns_unconfined(NS) (&(NS)->unconfined->label)\n\nbool aa_ns_visible(struct aa_ns *curr, struct aa_ns *view, bool subns);\nconst char *aa_ns_name(struct aa_ns *parent, struct aa_ns *child, bool subns);\nvoid aa_free_ns(struct aa_ns *ns);\nint aa_alloc_root_ns(void);\nvoid aa_free_root_ns(void);\nvoid aa_free_ns_kref(struct kref *kref);\n\nstruct aa_ns *aa_find_ns(struct aa_ns *root, const char *name);\nstruct aa_ns *aa_findn_ns(struct aa_ns *root, const char *name, size_t n);\nstruct aa_ns *__aa_lookupn_ns(struct aa_ns *view, const char *hname, size_t n);\nstruct aa_ns *aa_lookupn_ns(struct aa_ns *view, const char *name, size_t n);\nstruct aa_ns *__aa_find_or_create_ns(struct aa_ns *parent, const char *name,\n\t\t\t\t     struct dentry *dir);\nstruct aa_ns *aa_prepare_ns(struct aa_ns *root, const char *name);\nvoid __aa_remove_ns(struct aa_ns *ns);\n\nstatic inline struct aa_profile *aa_deref_parent(struct aa_profile *p)\n{\n\treturn rcu_dereference_protected(p->parent,\n\t\t\t\t\t mutex_is_locked(&p->ns->lock));\n}\n\n \nstatic inline struct aa_ns *aa_get_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_get_profile(ns->unconfined);\n\n\treturn ns;\n}\n\n \nstatic inline void aa_put_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_put_profile(ns->unconfined);\n}\n\n \nstatic inline struct aa_ns *__aa_findn_ns(struct list_head *head,\n\t\t\t\t\t  const char *name, size_t n)\n{\n\treturn (struct aa_ns *)__policy_strn_find(head, name, n);\n}\n\nstatic inline struct aa_ns *__aa_find_ns(struct list_head *head,\n\t\t\t\t\t const char *name)\n{\n\treturn __aa_findn_ns(head, name, strlen(name));\n}\n\nstatic inline struct aa_ns *__aa_lookup_ns(struct aa_ns *base,\n\t\t\t\t\t   const char *hname)\n{\n\treturn __aa_lookupn_ns(base, hname, strlen(hname));\n}\n\nstatic inline struct aa_ns *aa_lookup_ns(struct aa_ns *view, const char *name)\n{\n\treturn aa_lookupn_ns(view, name, strlen(name));\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}