{
  "module_name": "apparmorfs.h",
  "hash_id": "74c785673502f5b7222f7256ed3435bf793744dfd4d0650d142d9137e71a5066",
  "original_prompt": "Ingested from linux-6.6.14/security/apparmor/include/apparmorfs.h",
  "human_readable_source": " \n \n\n#ifndef __AA_APPARMORFS_H\n#define __AA_APPARMORFS_H\n\nextern struct path aa_null;\n\nenum aa_sfs_type {\n\tAA_SFS_TYPE_BOOLEAN,\n\tAA_SFS_TYPE_STRING,\n\tAA_SFS_TYPE_U64,\n\tAA_SFS_TYPE_FOPS,\n\tAA_SFS_TYPE_DIR,\n};\n\nstruct aa_sfs_entry;\n\nstruct aa_sfs_entry {\n\tconst char *name;\n\tstruct dentry *dentry;\n\tumode_t mode;\n\tenum aa_sfs_type v_type;\n\tunion {\n\t\tbool boolean;\n\t\tchar *string;\n\t\tunsigned long u64;\n\t\tstruct aa_sfs_entry *files;\n\t} v;\n\tconst struct file_operations *file_ops;\n};\n\nextern const struct file_operations aa_sfs_seq_file_ops;\n\n#define AA_SFS_FILE_BOOLEAN(_name, _value) \\\n\t{ .name = (_name), .mode = 0444, \\\n\t  .v_type = AA_SFS_TYPE_BOOLEAN, .v.boolean = (_value), \\\n\t  .file_ops = &aa_sfs_seq_file_ops }\n#define AA_SFS_FILE_STRING(_name, _value) \\\n\t{ .name = (_name), .mode = 0444, \\\n\t  .v_type = AA_SFS_TYPE_STRING, .v.string = (_value), \\\n\t  .file_ops = &aa_sfs_seq_file_ops }\n#define AA_SFS_FILE_U64(_name, _value) \\\n\t{ .name = (_name), .mode = 0444, \\\n\t  .v_type = AA_SFS_TYPE_U64, .v.u64 = (_value), \\\n\t  .file_ops = &aa_sfs_seq_file_ops }\n#define AA_SFS_FILE_FOPS(_name, _mode, _fops) \\\n\t{ .name = (_name), .v_type = AA_SFS_TYPE_FOPS, \\\n\t  .mode = (_mode), .file_ops = (_fops) }\n#define AA_SFS_DIR(_name, _value) \\\n\t{ .name = (_name), .v_type = AA_SFS_TYPE_DIR, .v.files = (_value) }\n\nextern void __init aa_destroy_aafs(void);\n\nstruct aa_profile;\nstruct aa_ns;\n\nenum aafs_ns_type {\n\tAAFS_NS_DIR,\n\tAAFS_NS_PROFS,\n\tAAFS_NS_NS,\n\tAAFS_NS_RAW_DATA,\n\tAAFS_NS_LOAD,\n\tAAFS_NS_REPLACE,\n\tAAFS_NS_REMOVE,\n\tAAFS_NS_REVISION,\n\tAAFS_NS_COUNT,\n\tAAFS_NS_MAX_COUNT,\n\tAAFS_NS_SIZE,\n\tAAFS_NS_MAX_SIZE,\n\tAAFS_NS_OWNER,\n\tAAFS_NS_SIZEOF,\n};\n\nenum aafs_prof_type {\n\tAAFS_PROF_DIR,\n\tAAFS_PROF_PROFS,\n\tAAFS_PROF_NAME,\n\tAAFS_PROF_MODE,\n\tAAFS_PROF_ATTACH,\n\tAAFS_PROF_HASH,\n\tAAFS_PROF_RAW_DATA,\n\tAAFS_PROF_RAW_HASH,\n\tAAFS_PROF_RAW_ABI,\n\tAAFS_PROF_SIZEOF,\n};\n\n#define ns_dir(X) ((X)->dents[AAFS_NS_DIR])\n#define ns_subns_dir(X) ((X)->dents[AAFS_NS_NS])\n#define ns_subprofs_dir(X) ((X)->dents[AAFS_NS_PROFS])\n#define ns_subdata_dir(X) ((X)->dents[AAFS_NS_RAW_DATA])\n#define ns_subload(X) ((X)->dents[AAFS_NS_LOAD])\n#define ns_subreplace(X) ((X)->dents[AAFS_NS_REPLACE])\n#define ns_subremove(X) ((X)->dents[AAFS_NS_REMOVE])\n#define ns_subrevision(X) ((X)->dents[AAFS_NS_REVISION])\n\n#define prof_dir(X) ((X)->dents[AAFS_PROF_DIR])\n#define prof_child_dir(X) ((X)->dents[AAFS_PROF_PROFS])\n\nvoid __aa_bump_ns_revision(struct aa_ns *ns);\nvoid __aafs_profile_rmdir(struct aa_profile *profile);\nvoid __aafs_profile_migrate_dents(struct aa_profile *old,\n\t\t\t\t   struct aa_profile *new);\nint __aafs_profile_mkdir(struct aa_profile *profile, struct dentry *parent);\nvoid __aafs_ns_rmdir(struct aa_ns *ns);\nint __aafs_ns_mkdir(struct aa_ns *ns, struct dentry *parent, const char *name,\n\t\t     struct dentry *dent);\n\nstruct aa_loaddata;\n\n#ifdef CONFIG_SECURITY_APPARMOR_EXPORT_BINARY\nvoid __aa_fs_remove_rawdata(struct aa_loaddata *rawdata);\nint __aa_fs_create_rawdata(struct aa_ns *ns, struct aa_loaddata *rawdata);\n#else\nstatic inline void __aa_fs_remove_rawdata(struct aa_loaddata *rawdata)\n{\n\t \n}\n\nstatic inline int __aa_fs_create_rawdata(struct aa_ns *ns,\n\t\t\t\t\t struct aa_loaddata *rawdata)\n{\n\treturn 0;\n}\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}