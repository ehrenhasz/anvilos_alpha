{
  "module_name": "task.h",
  "hash_id": "e08ae72c9be75031559795ce50c12f814263a97437caede44a69e76c630d99ae",
  "original_prompt": "Ingested from linux-6.6.14/security/apparmor/include/task.h",
  "human_readable_source": " \n \n\n#ifndef __AA_TASK_H\n#define __AA_TASK_H\n\nstatic inline struct aa_task_ctx *task_ctx(struct task_struct *task)\n{\n\treturn task->security + apparmor_blob_sizes.lbs_task;\n}\n\n \nstruct aa_task_ctx {\n\tstruct aa_label *nnp;\n\tstruct aa_label *onexec;\n\tstruct aa_label *previous;\n\tu64 token;\n};\n\nint aa_replace_current_label(struct aa_label *label);\nint aa_set_current_onexec(struct aa_label *label, bool stack);\nint aa_set_current_hat(struct aa_label *label, u64 token);\nint aa_restore_previous_label(u64 cookie);\nstruct aa_label *aa_get_task_label(struct task_struct *task);\n\n \nstatic inline void aa_free_task_ctx(struct aa_task_ctx *ctx)\n{\n\tif (ctx) {\n\t\taa_put_label(ctx->nnp);\n\t\taa_put_label(ctx->previous);\n\t\taa_put_label(ctx->onexec);\n\t}\n}\n\n \nstatic inline void aa_dup_task_ctx(struct aa_task_ctx *new,\n\t\t\t\t   const struct aa_task_ctx *old)\n{\n\t*new = *old;\n\taa_get_label(new->nnp);\n\taa_get_label(new->previous);\n\taa_get_label(new->onexec);\n}\n\n \nstatic inline void aa_clear_task_ctx_trans(struct aa_task_ctx *ctx)\n{\n\tAA_BUG(!ctx);\n\n\taa_put_label(ctx->previous);\n\taa_put_label(ctx->onexec);\n\tctx->previous = NULL;\n\tctx->onexec = NULL;\n\tctx->token = 0;\n}\n\n#define AA_PTRACE_TRACE\t\tMAY_WRITE\n#define AA_PTRACE_READ\t\tMAY_READ\n#define AA_MAY_BE_TRACED\tAA_MAY_APPEND\n#define AA_MAY_BE_READ\t\tAA_MAY_CREATE\n#define PTRACE_PERM_SHIFT\t2\n\n#define AA_PTRACE_PERM_MASK (AA_PTRACE_READ | AA_PTRACE_TRACE | \\\n\t\t\t     AA_MAY_BE_READ | AA_MAY_BE_TRACED)\n#define AA_SIGNAL_PERM_MASK (MAY_READ | MAY_WRITE)\n\n#define AA_SFS_SIG_MASK \"hup int quit ill trap abrt bus fpe kill usr1 \" \\\n\t\"segv usr2 pipe alrm term stkflt chld cont stop stp ttin ttou urg \" \\\n\t\"xcpu xfsz vtalrm prof winch io pwr sys emt lost\"\n\nint aa_may_ptrace(const struct cred *tracer_cred, struct aa_label *tracer,\n\t\t  const struct cred *tracee_cred, struct aa_label *tracee,\n\t\t  u32 request);\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}