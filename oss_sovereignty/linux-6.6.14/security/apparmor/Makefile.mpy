{
  "module_name": "Makefile",
  "hash_id": "7a0c08a09edfaf96a50baac71f0067cdb004bafc0443671cb84f7afe58b976e4",
  "original_prompt": "Ingested from linux-6.6.14/security/apparmor/Makefile",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\n# Makefile for AppArmor Linux Security Module\n#\nobj-$(CONFIG_SECURITY_APPARMOR) += apparmor.o\n\napparmor-y := apparmorfs.o audit.o capability.o task.o ipc.o lib.o match.o \\\n              path.o domain.o policy.o policy_unpack.o procattr.o lsm.o \\\n              resource.o secid.o file.o policy_ns.o label.o mount.o net.o \\\n              policy_compat.o\napparmor-$(CONFIG_SECURITY_APPARMOR_HASH) += crypto.o\n\nobj-$(CONFIG_SECURITY_APPARMOR_KUNIT_TEST) += apparmor_policy_unpack_test.o\napparmor_policy_unpack_test-objs += policy_unpack_test.o\n\nclean-files := capability_names.h rlim_names.h net_names.h\n\n# Build a lower case string table of address family names\n# Transform lines from\n#    #define AF_LOCAL\t\t1\t/* POSIX name for AF_UNIX\t*/\n#    #define AF_INET\t\t2\t/* Internet IP Protocol \t*/\n# to\n#    [1] = \"local\",\n#    [2] = \"inet\",\n#\n# and build the securityfs entries for the mapping.\n# Transforms lines from\n#    #define AF_INET\t\t2\t/* Internet IP Protocol \t*/\n# to\n#    #define AA_SFS_AF_MASK \"local inet\"\nquiet_cmd_make-af = GEN     $@\ncmd_make-af = echo \"static const char *address_family_names[] = {\" > $@ ;\\\n\tsed $< >>$@ -r -n -e \"/AF_MAX/d\" -e \"/AF_LOCAL/d\" -e \"/AF_ROUTE/d\" -e \\\n\t 's/^\\#define[ \\t]+AF_([A-Z0-9_]+)[ \\t]+([0-9]+)(.*)/[\\2] = \"\\L\\1\",/p';\\\n\techo \"};\" >> $@ ;\\\n\tprintf '%s' '\\#define AA_SFS_AF_MASK \"' >> $@ ;\\\n\tsed -r -n -e \"/AF_MAX/d\" -e \"/AF_LOCAL/d\" -e \"/AF_ROUTE/d\" -e \\\n\t 's/^\\#define[ \\t]+AF_([A-Z0-9_]+)[ \\t]+([0-9]+)(.*)/\\L\\1/p'\\\n\t $< | tr '\\n' ' ' | sed -e 's/ $$/\"\\n/' >> $@\n\n# Build a lower case string table of sock type names\n# Transform lines from\n#    SOCK_STREAM\t= 1,\n# to\n#    [1] = \"stream\",\nquiet_cmd_make-sock = GEN     $@\ncmd_make-sock = echo \"static const char *sock_type_names[] = {\" >> $@ ;\\\n\tsed $^ >>$@ -r -n \\\n\t-e 's/^\\tSOCK_([A-Z0-9_]+)[\\t]+=[ \\t]+([0-9]+)(.*)/[\\2] = \"\\L\\1\",/p';\\\n\techo \"};\" >> $@\n\n# Build a lower case string table of capability names\n# Transforms lines from\n#    #define CAP_DAC_OVERRIDE     1\n# to\n#    [1] = \"dac_override\",\nquiet_cmd_make-caps = GEN     $@\ncmd_make-caps = echo \"static const char *const capability_names[] = {\" > $@ ;\\\n\tsed $< >>$@ -r -n -e '/CAP_FS_MASK/d' \\\n\t-e 's/^\\#define[ \\t]+CAP_([A-Z0-9_]+)[ \\t]+([0-9]+)/[\\2] = \"\\L\\1\",/p';\\\n\techo \"};\" >> $@ ;\\\n\tprintf '%s' '\\#define AA_SFS_CAPS_MASK \"' >> $@ ;\\\n\tsed $< -r -n -e '/CAP_FS_MASK/d' \\\n\t    -e 's/^\\#define[ \\t]+CAP_([A-Z0-9_]+)[ \\t]+([0-9]+)/\\L\\1/p' | \\\n\t     tr '\\n' ' ' | sed -e 's/ $$/\"\\n/' >> $@\n\n\n# Build a lower case string table of rlimit names.\n# Transforms lines from\n#    #define RLIMIT_STACK\t\t3\t/* max stack size */\n# to\n#    [RLIMIT_STACK] = \"stack\",\n#\n# and build a second integer table (with the second sed cmd), that maps\n# RLIMIT defines to the order defined in asm-generic/resource.h  This is\n# required by policy load to map policy ordering of RLIMITs to internal\n# ordering for architectures that redefine an RLIMIT.\n# Transforms lines from\n#    #define RLIMIT_STACK\t\t3\t/* max stack size */\n# to\n# RLIMIT_STACK, \n#\n# and build the securityfs entries for the mapping.\n# Transforms lines from\n#    #define RLIMIT_FSIZE        1   /* Maximum filesize */\n#    #define RLIMIT_STACK\t\t3\t/* max stack size */\n# to\n# #define AA_SFS_RLIMIT_MASK \"fsize stack\"\nquiet_cmd_make-rlim = GEN     $@\ncmd_make-rlim = echo \"static const char *const rlim_names[RLIM_NLIMITS] = {\" \\\n\t> $@ ;\\\n\tsed $< >> $@ -r -n \\\n\t    -e 's/^\\# ?define[ \\t]+(RLIMIT_([A-Z0-9_]+)).*/[\\1] = \"\\L\\2\",/p';\\\n\techo \"};\" >> $@ ;\\\n\techo \"static const int rlim_map[RLIM_NLIMITS] = {\" >> $@ ;\\\n\tsed -r -n \"s/^\\# ?define[ \\t]+(RLIMIT_[A-Z0-9_]+).*/\\1,/p\" $< >> $@ ;\\\n\techo \"};\" >> $@ ; \\\n\tprintf '%s' '\\#define AA_SFS_RLIMIT_MASK \"' >> $@ ;\\\n\tsed -r -n 's/^\\# ?define[ \\t]+RLIMIT_([A-Z0-9_]+).*/\\L\\1/p' $< | \\\n\t    tr '\\n' ' ' | sed -e 's/ $$/\"\\n/' >> $@\n\n$(obj)/capability.o : $(obj)/capability_names.h\n$(obj)/net.o : $(obj)/net_names.h\n$(obj)/resource.o : $(obj)/rlim_names.h\n$(obj)/capability_names.h : $(srctree)/include/uapi/linux/capability.h \\\n\t\t\t    $(src)/Makefile\n\t$(call cmd,make-caps)\n$(obj)/rlim_names.h : $(srctree)/include/uapi/asm-generic/resource.h \\\n\t\t      $(src)/Makefile\n\t$(call cmd,make-rlim)\n$(obj)/net_names.h : $(srctree)/include/linux/socket.h \\\n\t\t     $(srctree)/include/linux/net.h \\\n\t\t     $(src)/Makefile\n\t$(call cmd,make-af)\n\t$(call cmd,make-sock)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}