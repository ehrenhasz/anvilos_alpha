{
  "module_name": "Kconfig",
  "hash_id": "1d071c95bc78a6e317d8170fa2b89b2789fcbb4a13d843694315e3d0168c2d08",
  "original_prompt": "Ingested from linux-6.6.14/security/integrity/Kconfig",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n#\nconfig INTEGRITY\n\tbool \"Integrity subsystem\"\n\tdepends on SECURITY\n\tdefault y\n\thelp\n\t  This option enables the integrity subsystem, which is comprised\n\t  of a number of different components including the Integrity\n\t  Measurement Architecture (IMA), Extended Verification Module\n\t  (EVM), IMA-appraisal extension, digital signature verification\n\t  extension and audit measurement log support.\n\n\t  Each of these components can be enabled/disabled separately.\n\t  Refer to the individual components for additional details.\n\nif INTEGRITY\n\nconfig INTEGRITY_SIGNATURE\n\tbool \"Digital signature verification using multiple keyrings\"\n\tdefault n\n\tselect KEYS\n\tselect SIGNATURE\n\thelp\n\t  This option enables digital signature verification support\n\t  using multiple keyrings. It defines separate keyrings for each\n\t  of the different use cases - evm, ima, and modules.\n\t  Different keyrings improves search performance, but also allow\n\t  to \"lock\" certain keyring to prevent adding new keys.\n\t  This is useful for evm and module keyrings, when keys are\n\t  usually only added from initramfs.\n\nconfig INTEGRITY_ASYMMETRIC_KEYS\n\tbool \"Enable asymmetric keys support\"\n\tdepends on INTEGRITY_SIGNATURE\n\tdefault n\n        select ASYMMETRIC_KEY_TYPE\n        select ASYMMETRIC_PUBLIC_KEY_SUBTYPE\n        select CRYPTO_RSA\n        select X509_CERTIFICATE_PARSER\n\thelp\n\t  This option enables digital signature verification using\n\t  asymmetric keys.\n\nconfig INTEGRITY_TRUSTED_KEYRING\n\tbool \"Require all keys on the integrity keyrings be signed\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\tdepends on INTEGRITY_ASYMMETRIC_KEYS\n\tdefault y\n\thelp\n\t   This option requires that all keys added to the .ima and\n\t   .evm keyrings be signed by a key on the system trusted\n\t   keyring.\n\nconfig INTEGRITY_PLATFORM_KEYRING\n        bool \"Provide keyring for platform/firmware trusted keys\"\n        depends on INTEGRITY_ASYMMETRIC_KEYS\n        depends on SYSTEM_BLACKLIST_KEYRING\n        help\n         Provide a separate, distinct keyring for platform trusted keys, which\n         the kernel automatically populates during initialization from values\n         provided by the platform for verifying the kexec'ed kerned image\n         and, possibly, the initramfs signature.\n\nconfig INTEGRITY_MACHINE_KEYRING\n\tbool \"Provide a keyring to which Machine Owner Keys may be added\"\n\tdepends on SECONDARY_TRUSTED_KEYRING\n\tdepends on INTEGRITY_ASYMMETRIC_KEYS\n\tdepends on SYSTEM_BLACKLIST_KEYRING\n\tdepends on LOAD_UEFI_KEYS || LOAD_PPC_KEYS\n\thelp\n\t If set, provide a keyring to which Machine Owner Keys (MOK) may\n\t be added. This keyring shall contain just MOK keys.  Unlike keys\n\t in the platform keyring, keys contained in the .machine keyring will\n\t be trusted within the kernel.\n\nconfig INTEGRITY_CA_MACHINE_KEYRING\n\tbool \"Enforce Machine Keyring CA Restrictions\"\n\tdepends on INTEGRITY_MACHINE_KEYRING\n\tdefault n\n\thelp\n\t  The .machine keyring can be configured to enforce CA restriction\n\t  on any key added to it.  By default no restrictions are in place\n\t  and all Machine Owner Keys (MOK) are added to the machine keyring.\n\t  If enabled only CA keys are added to the machine keyring, all\n\t  other MOK keys load into the platform keyring.\n\nconfig INTEGRITY_CA_MACHINE_KEYRING_MAX\n\tbool \"Only CA keys without DigitialSignature usage set\"\n\tdepends on INTEGRITY_CA_MACHINE_KEYRING\n\tdefault n\n\thelp\n\t  When selected, only load CA keys are loaded into the machine\n\t  keyring that contain the CA bit set along with the keyCertSign\n\t  Usage field.  Keys containing the digitialSignature Usage field\n\t  will not be loaded. The remaining MOK keys are loaded into the\n\t  .platform keyring.\n\nconfig LOAD_UEFI_KEYS\n       depends on INTEGRITY_PLATFORM_KEYRING\n       depends on EFI\n       def_bool y\n\nconfig LOAD_IPL_KEYS\n       depends on INTEGRITY_PLATFORM_KEYRING\n       depends on S390\n       def_bool y\n\nconfig LOAD_PPC_KEYS\n\tbool \"Enable loading of platform and blacklisted keys for POWER\"\n\tdepends on INTEGRITY_PLATFORM_KEYRING\n\tdepends on PPC_SECURE_BOOT\n\tdefault y\n\thelp\n\t  Enable loading of keys to the .platform keyring and blacklisted\n\t  hashes to the .blacklist keyring for powerpc based platforms.\n\nconfig INTEGRITY_AUDIT\n\tbool \"Enables integrity auditing support \"\n\tdepends on AUDIT\n\tdefault y\n\thelp\n\t  In addition to enabling integrity auditing support, this\n\t  option adds a kernel parameter 'integrity_audit', which\n\t  controls the level of integrity auditing messages.\n\t  0 - basic integrity auditing messages (default)\n\t  1 - additional integrity auditing messages\n\n\t  Additional informational integrity auditing messages would\n\t  be enabled by specifying 'integrity_audit=1' on the kernel\n\t  command line.\n\nsource \"security/integrity/ima/Kconfig\"\nsource \"security/integrity/evm/Kconfig\"\n\nendif   # if INTEGRITY\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}