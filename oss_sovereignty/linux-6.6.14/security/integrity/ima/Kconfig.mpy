{
  "module_name": "Kconfig",
  "hash_id": "9a168f56574e99896a4bcee00c3623765ca23de51ff7b7440270c9008d2202ef",
  "original_prompt": "Ingested from linux-6.6.14/security/integrity/ima/Kconfig",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n# IBM Integrity Measurement Architecture\n#\nconfig IMA\n\tbool \"Integrity Measurement Architecture(IMA)\"\n\tselect SECURITYFS\n\tselect CRYPTO\n\tselect CRYPTO_HMAC\n\tselect CRYPTO_SHA1\n\tselect CRYPTO_HASH_INFO\n\tselect TCG_TPM if HAS_IOMEM\n\tselect TCG_TIS if TCG_TPM && X86\n\tselect TCG_CRB if TCG_TPM && ACPI\n\tselect TCG_IBMVTPM if TCG_TPM && PPC_PSERIES\n\tselect INTEGRITY_AUDIT if AUDIT\n\thelp\n\t  The Trusted Computing Group(TCG) runtime Integrity\n\t  Measurement Architecture(IMA) maintains a list of hash\n\t  values of executables and other sensitive system files,\n\t  as they are read or executed. If an attacker manages\n\t  to change the contents of an important system file\n\t  being measured, we can tell.\n\n\t  If your system has a TPM chip, then IMA also maintains\n\t  an aggregate integrity value over this list inside the\n\t  TPM hardware, so that the TPM can prove to a third party\n\t  whether or not critical system files have been modified.\n\t  Read <https://www.usenix.org/events/sec04/tech/sailer.html>\n\t  to learn more about IMA.\n\t  If unsure, say N.\n\nif IMA\n\nconfig IMA_KEXEC\n\tbool \"Enable carrying the IMA measurement list across a soft boot\"\n\tdepends on TCG_TPM && HAVE_IMA_KEXEC\n\tdefault n\n\thelp\n\t   TPM PCRs are only reset on a hard reboot.  In order to validate\n\t   a TPM's quote after a soft boot, the IMA measurement list of the\n\t   running kernel must be saved and restored on boot.\n\n\t   Depending on the IMA policy, the measurement list can grow to\n\t   be very large.\n\nconfig IMA_MEASURE_PCR_IDX\n\tint\n\trange 8 14\n\tdefault 10\n\thelp\n\t  IMA_MEASURE_PCR_IDX determines the TPM PCR register index\n\t  that IMA uses to maintain the integrity aggregate of the\n\t  measurement list.  If unsure, use the default 10.\n\nconfig IMA_LSM_RULES\n\tbool\n\tdepends on AUDIT && (SECURITY_SELINUX || SECURITY_SMACK || SECURITY_APPARMOR)\n\tdefault y\n\thelp\n\t  Disabling this option will disregard LSM based policy rules.\n\nchoice\n\tprompt \"Default template\"\n\tdefault IMA_NG_TEMPLATE\n\thelp\n\t  Select the default IMA measurement template.\n\n\t  The original 'ima' measurement list template contains a\n\t  hash, defined as 20 bytes, and a null terminated pathname,\n\t  limited to 255 characters.  The 'ima-ng' measurement list\n\t  template permits both larger hash digests and longer\n\t  pathnames. The configured default template can be replaced\n\t  by specifying \"ima_template=\" on the boot command line.\n\n\tconfig IMA_NG_TEMPLATE\n\t\tbool \"ima-ng (default)\"\n\tconfig IMA_SIG_TEMPLATE\n\t\tbool \"ima-sig\"\nendchoice\n\nconfig IMA_DEFAULT_TEMPLATE\n\tstring\n\tdefault \"ima-ng\" if IMA_NG_TEMPLATE\n\tdefault \"ima-sig\" if IMA_SIG_TEMPLATE\n\nchoice\n\tprompt \"Default integrity hash algorithm\"\n\tdefault IMA_DEFAULT_HASH_SHA1\n\thelp\n\t   Select the default hash algorithm used for the measurement\n\t   list, integrity appraisal and audit log.  The compiled default\n\t   hash algorithm can be overwritten using the kernel command\n\t   line 'ima_hash=' option.\n\n\tconfig IMA_DEFAULT_HASH_SHA1\n\t\tbool \"SHA1 (default)\"\n\t\tdepends on CRYPTO_SHA1=y\n\n\tconfig IMA_DEFAULT_HASH_SHA256\n\t\tbool \"SHA256\"\n\t\tdepends on CRYPTO_SHA256=y\n\n\tconfig IMA_DEFAULT_HASH_SHA512\n\t\tbool \"SHA512\"\n\t\tdepends on CRYPTO_SHA512=y\n\n\tconfig IMA_DEFAULT_HASH_WP512\n\t\tbool \"WP512\"\n\t\tdepends on CRYPTO_WP512=y\n\n\tconfig IMA_DEFAULT_HASH_SM3\n\t\tbool \"SM3\"\n\t\tdepends on CRYPTO_SM3_GENERIC=y\nendchoice\n\nconfig IMA_DEFAULT_HASH\n\tstring\n\tdefault \"sha1\" if IMA_DEFAULT_HASH_SHA1\n\tdefault \"sha256\" if IMA_DEFAULT_HASH_SHA256\n\tdefault \"sha512\" if IMA_DEFAULT_HASH_SHA512\n\tdefault \"wp512\" if IMA_DEFAULT_HASH_WP512\n\tdefault \"sm3\" if IMA_DEFAULT_HASH_SM3\n\nconfig IMA_WRITE_POLICY\n\tbool \"Enable multiple writes to the IMA policy\"\n\tdefault n\n\thelp\n\t  IMA policy can now be updated multiple times.  The new rules get\n\t  appended to the original policy.  Have in mind that the rules are\n\t  scanned in FIFO order so be careful when you design and add new ones.\n\n\t  If unsure, say N.\n\nconfig IMA_READ_POLICY\n\tbool \"Enable reading back the current IMA policy\"\n\tdefault y if IMA_WRITE_POLICY\n\tdefault n if !IMA_WRITE_POLICY\n\thelp\n\t   It is often useful to be able to read back the IMA policy.  It is\n\t   even more important after introducing CONFIG_IMA_WRITE_POLICY.\n\t   This option allows the root user to see the current policy rules.\n\nconfig IMA_APPRAISE\n\tbool \"Appraise integrity measurements\"\n\tdefault n\n\thelp\n\t  This option enables local measurement integrity appraisal.\n\t  It requires the system to be labeled with a security extended\n\t  attribute containing the file hash measurement.  To protect\n\t  the security extended attributes from offline attack, enable\n\t  and configure EVM.\n\n\t  For more information on integrity appraisal refer to:\n\t  <http://linux-ima.sourceforge.net>\n\t  If unsure, say N.\n\nconfig IMA_ARCH_POLICY\n        bool \"Enable loading an IMA architecture specific policy\"\n        depends on (KEXEC_SIG && IMA) || IMA_APPRAISE \\\n\t\t   && INTEGRITY_ASYMMETRIC_KEYS\n        default n\n        help\n          This option enables loading an IMA architecture specific policy\n          based on run time secure boot flags.\n\nconfig IMA_APPRAISE_BUILD_POLICY\n\tbool \"IMA build time configured policy rules\"\n\tdepends on IMA_APPRAISE && INTEGRITY_ASYMMETRIC_KEYS\n\tdefault n\n\thelp\n\t  This option defines an IMA appraisal policy at build time, which\n\t  is enforced at run time without having to specify a builtin\n\t  policy name on the boot command line.  The build time appraisal\n\t  policy rules persist after loading a custom policy.\n\n\t  Depending on the rules configured, this policy may require kernel\n\t  modules, firmware, the kexec kernel image, and/or the IMA policy\n\t  to be signed.  Unsigned files might prevent the system from\n\t  booting or applications from working properly.\n\nconfig IMA_APPRAISE_REQUIRE_FIRMWARE_SIGS\n\tbool \"Appraise firmware signatures\"\n\tdepends on IMA_APPRAISE_BUILD_POLICY\n\tdefault n\n\thelp\n\t  This option defines a policy requiring all firmware to be signed,\n\t  including the regulatory.db.  If both this option and\n\t  CFG80211_REQUIRE_SIGNED_REGDB are enabled, then both signature\n\t  verification methods are necessary.\n\nconfig IMA_APPRAISE_REQUIRE_KEXEC_SIGS\n\tbool \"Appraise kexec kernel image signatures\"\n\tdepends on IMA_APPRAISE_BUILD_POLICY\n\tdefault n\n\thelp\n\t  Enabling this rule will require all kexec'ed kernel images to\n\t  be signed and verified by a public key on the trusted IMA\n\t  keyring.\n\n\t  Kernel image signatures can not be verified by the original\n\t  kexec_load syscall.  Enabling this rule will prevent its\n\t  usage.\n\nconfig IMA_APPRAISE_REQUIRE_MODULE_SIGS\n\tbool \"Appraise kernel modules signatures\"\n\tdepends on IMA_APPRAISE_BUILD_POLICY\n\tdefault n\n\thelp\n\t  Enabling this rule will require all kernel modules to be signed\n\t  and verified by a public key on the trusted IMA keyring.\n\n\t  Kernel module signatures can only be verified by IMA-appraisal,\n\t  via the finit_module syscall. Enabling this rule will prevent\n\t  the usage of the init_module syscall.\n\nconfig IMA_APPRAISE_REQUIRE_POLICY_SIGS\n\tbool \"Appraise IMA policy signature\"\n\tdepends on IMA_APPRAISE_BUILD_POLICY\n\tdefault n\n\thelp\n\t  Enabling this rule will require the IMA policy to be signed and\n\t  and verified by a key on the trusted IMA keyring.\n\nconfig IMA_APPRAISE_BOOTPARAM\n\tbool \"ima_appraise boot parameter\"\n\tdepends on IMA_APPRAISE\n\tdefault y\n\thelp\n\t  This option enables the different \"ima_appraise=\" modes\n\t  (eg. fix, log) from the boot command line.\n\nconfig IMA_APPRAISE_MODSIG\n\tbool \"Support module-style signatures for appraisal\"\n\tdepends on IMA_APPRAISE\n\tdepends on INTEGRITY_ASYMMETRIC_KEYS\n\tselect PKCS7_MESSAGE_PARSER\n\tselect MODULE_SIG_FORMAT\n\tdefault n\n\thelp\n\t   Adds support for signatures appended to files. The format of the\n\t   appended signature is the same used for signed kernel modules.\n\t   The modsig keyword can be used in the IMA policy to allow a hook\n\t   to accept such signatures.\n\nconfig IMA_KEYRINGS_PERMIT_SIGNED_BY_BUILTIN_OR_SECONDARY\n\tbool \"Permit keys validly signed by a built-in or secondary CA cert (EXPERIMENTAL)\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\tdepends on SECONDARY_TRUSTED_KEYRING\n\tdepends on INTEGRITY_ASYMMETRIC_KEYS\n\tselect INTEGRITY_TRUSTED_KEYRING\n\tdefault n\n\thelp\n\t  Keys may be added to the IMA or IMA blacklist keyrings, if the\n\t  key is validly signed by a CA cert in the system built-in or\n\t  secondary trusted keyrings. The key must also have the\n\t  digitalSignature usage set.\n\n\t  Intermediate keys between those the kernel has compiled in and the\n\t  IMA keys to be added may be added to the system secondary keyring,\n\t  provided they are validly signed by a key already resident in the\n\t  built-in or secondary trusted keyrings.\n\nconfig IMA_BLACKLIST_KEYRING\n\tbool \"Create IMA machine owner blacklist keyrings (EXPERIMENTAL)\"\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\tdepends on INTEGRITY_TRUSTED_KEYRING\n\tdefault n\n\thelp\n\t   This option creates an IMA blacklist keyring, which contains all\n\t   revoked IMA keys.  It is consulted before any other keyring.  If\n\t   the search is successful the requested operation is rejected and\n\t   an error is returned to the caller.\n\nconfig IMA_LOAD_X509\n\tbool \"Load X509 certificate onto the '.ima' trusted keyring\"\n\tdepends on INTEGRITY_TRUSTED_KEYRING\n\tdefault n\n\thelp\n\t   File signature verification is based on the public keys\n\t   loaded on the .ima trusted keyring. These public keys are\n\t   X509 certificates signed by a trusted key on the\n\t   .system keyring.  This option enables X509 certificate\n\t   loading from the kernel onto the '.ima' trusted keyring.\n\nconfig IMA_X509_PATH\n\tstring \"IMA X509 certificate path\"\n\tdepends on IMA_LOAD_X509\n\tdefault \"/etc/keys/x509_ima.der\"\n\thelp\n\t   This option defines IMA X509 certificate path.\n\nconfig IMA_APPRAISE_SIGNED_INIT\n\tbool \"Require signed user-space initialization\"\n\tdepends on IMA_LOAD_X509\n\tdefault n\n\thelp\n\t   This option requires user-space init to be signed.\n\nconfig IMA_MEASURE_ASYMMETRIC_KEYS\n\tbool\n\tdepends on ASYMMETRIC_PUBLIC_KEY_SUBTYPE=y\n\tdefault y\n\nconfig IMA_QUEUE_EARLY_BOOT_KEYS\n\tbool\n\tdepends on IMA_MEASURE_ASYMMETRIC_KEYS\n\tdepends on SYSTEM_TRUSTED_KEYRING\n\tdefault y\n\nconfig IMA_SECURE_AND_OR_TRUSTED_BOOT\n       bool\n       depends on IMA_ARCH_POLICY\n       help\n          This option is selected by architectures to enable secure and/or\n          trusted boot based on IMA runtime policies.\n\nconfig IMA_DISABLE_HTABLE\n\tbool \"Disable htable to allow measurement of duplicate records\"\n\tdefault n\n\thelp\n\t   This option disables htable to allow measurement of duplicate records.\n\nendif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}