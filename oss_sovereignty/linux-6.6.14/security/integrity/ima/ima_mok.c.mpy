{
  "module_name": "ima_mok.c",
  "hash_id": "42856e0560e8e4e71de668eab199c8b8a4a6564c8149e1e53de6100e74df4cad",
  "original_prompt": "Ingested from linux-6.6.14/security/integrity/ima/ima_mok.c",
  "human_readable_source": "\n \n\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/cred.h>\n#include <linux/err.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <keys/system_keyring.h>\n\n\nstruct key *ima_blacklist_keyring;\n\n \nstatic __init int ima_mok_init(void)\n{\n\tstruct key_restriction *restriction;\n\n\tpr_notice(\"Allocating IMA blacklist keyring.\\n\");\n\n\trestriction = kzalloc(sizeof(struct key_restriction), GFP_KERNEL);\n\tif (!restriction)\n\t\tpanic(\"Can't allocate IMA blacklist restriction.\");\n\n\trestriction->check = restrict_link_by_builtin_trusted;\n\n\tima_blacklist_keyring = keyring_alloc(\".ima_blacklist\",\n\t\t\t\tKUIDT_INIT(0), KGIDT_INIT(0), current_cred(),\n\t\t\t\t(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ |\n\t\t\t\tKEY_USR_WRITE | KEY_USR_SEARCH,\n\t\t\t\tKEY_ALLOC_NOT_IN_QUOTA |\n\t\t\t\tKEY_ALLOC_SET_KEEP,\n\t\t\t\trestriction, NULL);\n\n\tif (IS_ERR(ima_blacklist_keyring))\n\t\tpanic(\"Can't allocate IMA blacklist keyring.\");\n\treturn 0;\n}\ndevice_initcall(ima_mok_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}