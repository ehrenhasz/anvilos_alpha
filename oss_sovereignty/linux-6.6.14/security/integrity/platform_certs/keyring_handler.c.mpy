{
  "module_name": "keyring_handler.c",
  "hash_id": "036a72ce65dab191fb0de4dd8ca09d18b9feac2180b3e9501dc8c0a5d3daea6c",
  "original_prompt": "Ingested from linux-6.6.14/security/integrity/platform_certs/keyring_handler.c",
  "human_readable_source": "\n\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/cred.h>\n#include <linux/err.h>\n#include <linux/efi.h>\n#include <linux/slab.h>\n#include <keys/asymmetric-type.h>\n#include <keys/system_keyring.h>\n#include \"../integrity.h\"\n#include \"keyring_handler.h\"\n\nstatic efi_guid_t efi_cert_x509_guid __initdata = EFI_CERT_X509_GUID;\nstatic efi_guid_t efi_cert_x509_sha256_guid __initdata =\n\tEFI_CERT_X509_SHA256_GUID;\nstatic efi_guid_t efi_cert_sha256_guid __initdata = EFI_CERT_SHA256_GUID;\n\n \nstatic __init void uefi_blacklist_x509_tbs(const char *source,\n\t\t\t\t\t   const void *data, size_t len)\n{\n\tmark_hash_blacklisted(data, len, BLACKLIST_HASH_X509_TBS);\n}\n\n \nstatic __init void uefi_blacklist_binary(const char *source,\n\t\t\t\t\t const void *data, size_t len)\n{\n\tmark_hash_blacklisted(data, len, BLACKLIST_HASH_BINARY);\n}\n\n \nstatic __init void uefi_revocation_list_x509(const char *source,\n\t\t\t\t\t     const void *data, size_t len)\n{\n\tadd_key_to_revocation_list(data, len);\n}\n\n \n__init efi_element_handler_t get_handler_for_db(const efi_guid_t *sig_type)\n{\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_guid) == 0)\n\t\treturn add_to_platform_keyring;\n\treturn NULL;\n}\n\n \n__init efi_element_handler_t get_handler_for_mok(const efi_guid_t *sig_type)\n{\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_guid) == 0) {\n\t\tif (IS_ENABLED(CONFIG_INTEGRITY_MACHINE_KEYRING) &&\n\t\t    imputed_trust_enabled())\n\t\t\treturn add_to_machine_keyring;\n\t\telse\n\t\t\treturn add_to_platform_keyring;\n\t}\n\treturn NULL;\n}\n\n__init efi_element_handler_t get_handler_for_ca_keys(const efi_guid_t *sig_type)\n{\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_guid) == 0)\n\t\treturn add_to_machine_keyring;\n\n\treturn NULL;\n}\n\n__init efi_element_handler_t get_handler_for_code_signing_keys(const efi_guid_t *sig_type)\n{\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_guid) == 0)\n\t\treturn add_to_secondary_keyring;\n\n\treturn NULL;\n}\n\n \n__init efi_element_handler_t get_handler_for_dbx(const efi_guid_t *sig_type)\n{\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_sha256_guid) == 0)\n\t\treturn uefi_blacklist_x509_tbs;\n\tif (efi_guidcmp(*sig_type, efi_cert_sha256_guid) == 0)\n\t\treturn uefi_blacklist_binary;\n\tif (efi_guidcmp(*sig_type, efi_cert_x509_guid) == 0)\n\t\treturn uefi_revocation_list_x509;\n\treturn NULL;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}