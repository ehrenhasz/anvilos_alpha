{
  "module_name": "test_bpf.c",
  "hash_id": "e816d3727389293e34109edc4396bbecb990171a565d85d44f8bf460e22b6424",
  "original_prompt": "Ingested from linux-6.6.14/lib/test_bpf.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <linux/if_vlan.h>\n#include <linux/random.h>\n#include <linux/highmem.h>\n#include <linux/sched.h>\n\n \n#define MAX_SUBTESTS\t3\n#define MAX_TESTRUNS\t1000\n#define MAX_DATA\t128\n#define MAX_INSNS\t512\n#define MAX_K\t\t0xffffFFFF\n\n \n#define SKB_TYPE\t3\n#define SKB_MARK\t0x1234aaaa\n#define SKB_HASH\t0x1234aaab\n#define SKB_QUEUE_MAP\t123\n#define SKB_VLAN_TCI\t0xffff\n#define SKB_VLAN_PRESENT\t1\n#define SKB_DEV_IFINDEX\t577\n#define SKB_DEV_TYPE\t588\n\n \n#define R0\t\tBPF_REG_0\n#define R1\t\tBPF_REG_1\n#define R2\t\tBPF_REG_2\n#define R3\t\tBPF_REG_3\n#define R4\t\tBPF_REG_4\n#define R5\t\tBPF_REG_5\n#define R6\t\tBPF_REG_6\n#define R7\t\tBPF_REG_7\n#define R8\t\tBPF_REG_8\n#define R9\t\tBPF_REG_9\n#define R10\t\tBPF_REG_10\n\n \n#define FLAG_NO_DATA\t\tBIT(0)\n#define FLAG_EXPECTED_FAIL\tBIT(1)\n#define FLAG_SKB_FRAG\t\tBIT(2)\n#define FLAG_VERIFIER_ZEXT\tBIT(3)\n#define FLAG_LARGE_MEM\t\tBIT(4)\n\nenum {\n\tCLASSIC  = BIT(6),\t \n\tINTERNAL = BIT(7),\t \n};\n\n#define TEST_TYPE_MASK\t\t(CLASSIC | INTERNAL)\n\nstruct bpf_test {\n\tconst char *descr;\n\tunion {\n\t\tstruct sock_filter insns[MAX_INSNS];\n\t\tstruct bpf_insn insns_int[MAX_INSNS];\n\t\tstruct {\n\t\t\tvoid *insns;\n\t\t\tunsigned int len;\n\t\t} ptr;\n\t} u;\n\t__u8 aux;\n\t__u8 data[MAX_DATA];\n\tstruct {\n\t\tint data_size;\n\t\t__u32 result;\n\t} test[MAX_SUBTESTS];\n\tint (*fill_helper)(struct bpf_test *self);\n\tint expected_errcode;  \n\t__u8 frag_data[MAX_DATA];\n\tint stack_depth;  \n\tint nr_testruns;  \n};\n\n \n\nstatic int bpf_fill_maxinsns1(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\t__u32 k = ~0;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len; i++, k--)\n\t\tinsn[i] = __BPF_STMT(BPF_RET | BPF_K, k);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns2(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_RET | BPF_K, 0xfefefefe);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns3(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tstruct rnd_state rnd;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tprandom_seed_state(&rnd, 3141592653589793238ULL);\n\n\tfor (i = 0; i < len - 1; i++) {\n\t\t__u32 k = prandom_u32_state(&rnd);\n\n\t\tinsn[i] = __BPF_STMT(BPF_ALU | BPF_ADD | BPF_K, k);\n\t}\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_A, 0);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns4(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS + 1;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_RET | BPF_K, 0xfefefefe);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns5(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[0] = __BPF_JUMP(BPF_JMP | BPF_JA, len - 2, 0, 0);\n\n\tfor (i = 1; i < len - 1; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_RET | BPF_K, 0xfefefefe);\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_K, 0xabababab);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns6(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len - 1; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_LD | BPF_W | BPF_ABS, SKF_AD_OFF +\n\t\t\t\t     SKF_AD_VLAN_TAG_PRESENT);\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_A, 0);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns7(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len - 4; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_LD | BPF_W | BPF_ABS, SKF_AD_OFF +\n\t\t\t\t     SKF_AD_CPU);\n\n\tinsn[len - 4] = __BPF_STMT(BPF_MISC | BPF_TAX, 0);\n\tinsn[len - 3] = __BPF_STMT(BPF_LD | BPF_W | BPF_ABS, SKF_AD_OFF +\n\t\t\t\t   SKF_AD_CPU);\n\tinsn[len - 2] = __BPF_STMT(BPF_ALU | BPF_SUB | BPF_X, 0);\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_A, 0);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns8(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i, jmp_off = len - 3;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[0] = __BPF_STMT(BPF_LD | BPF_IMM, 0xffffffff);\n\n\tfor (i = 1; i < len - 1; i++)\n\t\tinsn[i] = __BPF_JUMP(BPF_JMP | BPF_JGT, 0xffffffff, jmp_off--, 0);\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_A, 0);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns9(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct bpf_insn *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[0] = BPF_JMP_IMM(BPF_JA, 0, 0, len - 2);\n\tinsn[1] = BPF_ALU32_IMM(BPF_MOV, R0, 0xcbababab);\n\tinsn[2] = BPF_EXIT_INSN();\n\n\tfor (i = 3; i < len - 2; i++)\n\t\tinsn[i] = BPF_ALU32_IMM(BPF_MOV, R0, 0xfefefefe);\n\n\tinsn[len - 2] = BPF_EXIT_INSN();\n\tinsn[len - 1] = BPF_JMP_IMM(BPF_JA, 0, 0, -(len - 1));\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns10(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS, hlen = len - 2;\n\tstruct bpf_insn *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < hlen / 2; i++)\n\t\tinsn[i] = BPF_JMP_IMM(BPF_JA, 0, 0, hlen - 2 - 2 * i);\n\tfor (i = hlen - 1; i > hlen / 2; i--)\n\t\tinsn[i] = BPF_JMP_IMM(BPF_JA, 0, 0, hlen - 1 - 2 * i);\n\n\tinsn[hlen / 2] = BPF_JMP_IMM(BPF_JA, 0, 0, hlen / 2 - 1);\n\tinsn[hlen]     = BPF_ALU32_IMM(BPF_MOV, R0, 0xabababac);\n\tinsn[hlen + 1] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int __bpf_fill_ja(struct bpf_test *self, unsigned int len,\n\t\t\t unsigned int plen)\n{\n\tstruct sock_filter *insn;\n\tunsigned int rlen;\n\tint i, j;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\trlen = (len % plen) - 1;\n\n\tfor (i = 0; i + plen < len; i += plen)\n\t\tfor (j = 0; j < plen; j++)\n\t\t\tinsn[i + j] = __BPF_JUMP(BPF_JMP | BPF_JA,\n\t\t\t\t\t\t plen - 1 - j, 0, 0);\n\tfor (j = 0; j < rlen; j++)\n\t\tinsn[i + j] = __BPF_JUMP(BPF_JMP | BPF_JA, rlen - 1 - j,\n\t\t\t\t\t 0, 0);\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_K, 0xababcbac);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns11(struct bpf_test *self)\n{\n\t \n\treturn __bpf_fill_ja(self, BPF_MAXINSNS, 68);\n}\n\nstatic int bpf_fill_maxinsns12(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[0] = __BPF_JUMP(BPF_JMP | BPF_JA, len - 2, 0, 0);\n\n\tfor (i = 1; i < len - 1; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0);\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_K, 0xabababab);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_maxinsns13(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len - 3; i++)\n\t\tinsn[i] = __BPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0);\n\n\tinsn[len - 3] = __BPF_STMT(BPF_LD | BPF_IMM, 0xabababab);\n\tinsn[len - 2] = __BPF_STMT(BPF_ALU | BPF_XOR | BPF_X, 0);\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_A, 0);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_ja(struct bpf_test *self)\n{\n\t \n\treturn __bpf_fill_ja(self, 12, 9);\n}\n\nstatic int bpf_fill_ld_abs_get_processor_id(struct bpf_test *self)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct sock_filter *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < len - 1; i += 2) {\n\t\tinsn[i] = __BPF_STMT(BPF_LD | BPF_B | BPF_ABS, 0);\n\t\tinsn[i + 1] = __BPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t\t SKF_AD_OFF + SKF_AD_CPU);\n\t}\n\n\tinsn[len - 1] = __BPF_STMT(BPF_RET | BPF_K, 0xbee);\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\nstatic int __bpf_fill_stxdw(struct bpf_test *self, int size)\n{\n\tunsigned int len = BPF_MAXINSNS;\n\tstruct bpf_insn *insn;\n\tint i;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[0] = BPF_ALU32_IMM(BPF_MOV, R0, 1);\n\tinsn[1] = BPF_ST_MEM(size, R10, -40, 42);\n\n\tfor (i = 2; i < len - 2; i++)\n\t\tinsn[i] = BPF_STX_XADD(size, R10, R0, -40);\n\n\tinsn[len - 2] = BPF_LDX_MEM(size, R0, R10, -40);\n\tinsn[len - 1] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\tself->stack_depth = 40;\n\n\treturn 0;\n}\n\nstatic int bpf_fill_stxw(struct bpf_test *self)\n{\n\treturn __bpf_fill_stxdw(self, BPF_W);\n}\n\nstatic int bpf_fill_stxdw(struct bpf_test *self)\n{\n\treturn __bpf_fill_stxdw(self, BPF_DW);\n}\n\nstatic int __bpf_ld_imm64(struct bpf_insn insns[2], u8 reg, s64 imm64)\n{\n\tstruct bpf_insn tmp[] = {BPF_LD_IMM64(reg, imm64)};\n\n\tmemcpy(insns, tmp, sizeof(tmp));\n\treturn 2;\n}\n\n \nstatic int __bpf_fill_max_jmp(struct bpf_test *self, int jmp, int imm)\n{\n\tstruct bpf_insn *insns;\n\tint len = S16_MAX + 5;\n\tint i;\n\n\tinsns = kmalloc_array(len, sizeof(*insns), GFP_KERNEL);\n\tif (!insns)\n\t\treturn -ENOMEM;\n\n\ti = __bpf_ld_imm64(insns, R1, 0x0123456789abcdefULL);\n\tinsns[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsns[i++] = BPF_JMP_IMM(jmp, R0, imm, S16_MAX);\n\tinsns[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 2);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\twhile (i < len - 1) {\n\t\tstatic const int ops[] = {\n\t\t\tBPF_LSH, BPF_RSH, BPF_ARSH, BPF_ADD,\n\t\t\tBPF_SUB, BPF_MUL, BPF_DIV, BPF_MOD,\n\t\t};\n\t\tint op = ops[(i >> 1) % ARRAY_SIZE(ops)];\n\n\t\tif (i & 1)\n\t\t\tinsns[i++] = BPF_ALU32_REG(op, R0, R1);\n\t\telse\n\t\t\tinsns[i++] = BPF_ALU64_REG(op, R0, R1);\n\t}\n\n\tinsns[i++] = BPF_EXIT_INSN();\n\tself->u.ptr.insns = insns;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\n \nstatic int bpf_fill_max_jmp_taken(struct bpf_test *self)\n{\n\treturn __bpf_fill_max_jmp(self, BPF_JEQ, 1);\n}\n\n \nstatic int bpf_fill_max_jmp_not_taken(struct bpf_test *self)\n{\n\treturn __bpf_fill_max_jmp(self, BPF_JEQ, 0);\n}\n\n \nstatic int bpf_fill_max_jmp_always_taken(struct bpf_test *self)\n{\n\treturn __bpf_fill_max_jmp(self, BPF_JGE, 0);\n}\n\n \nstatic int bpf_fill_max_jmp_never_taken(struct bpf_test *self)\n{\n\treturn __bpf_fill_max_jmp(self, BPF_JLT, 0);\n}\n\n \nstatic bool __bpf_alu_result(u64 *res, u64 v1, u64 v2, u8 op)\n{\n\t*res = 0;\n\tswitch (op) {\n\tcase BPF_MOV:\n\t\t*res = v2;\n\t\tbreak;\n\tcase BPF_AND:\n\t\t*res = v1 & v2;\n\t\tbreak;\n\tcase BPF_OR:\n\t\t*res = v1 | v2;\n\t\tbreak;\n\tcase BPF_XOR:\n\t\t*res = v1 ^ v2;\n\t\tbreak;\n\tcase BPF_LSH:\n\t\t*res = v1 << v2;\n\t\tbreak;\n\tcase BPF_RSH:\n\t\t*res = v1 >> v2;\n\t\tbreak;\n\tcase BPF_ARSH:\n\t\t*res = v1 >> v2;\n\t\tif (v2 > 0 && v1 > S64_MAX)\n\t\t\t*res |= ~0ULL << (64 - v2);\n\t\tbreak;\n\tcase BPF_ADD:\n\t\t*res = v1 + v2;\n\t\tbreak;\n\tcase BPF_SUB:\n\t\t*res = v1 - v2;\n\t\tbreak;\n\tcase BPF_MUL:\n\t\t*res = v1 * v2;\n\t\tbreak;\n\tcase BPF_DIV:\n\t\tif (v2 == 0)\n\t\t\treturn false;\n\t\t*res = div64_u64(v1, v2);\n\t\tbreak;\n\tcase BPF_MOD:\n\t\tif (v2 == 0)\n\t\t\treturn false;\n\t\tdiv64_u64_rem(v1, v2, res);\n\t\tbreak;\n\t}\n\treturn true;\n}\n\n \nstatic int __bpf_fill_alu_shift(struct bpf_test *self, u8 op,\n\t\t\t\tu8 mode, bool alu32)\n{\n\tstatic const s64 regs[] = {\n\t\t0x0123456789abcdefLL,  \n\t\t0xfedcba9876543210LL,  \n\t\t0xfedcba0198765432LL,  \n\t\t0x0123458967abcdefLL,  \n\t};\n\tint bits = alu32 ? 32 : 64;\n\tint len = (2 + 7 * bits) * ARRAY_SIZE(regs) + 3;\n\tstruct bpf_insn *insn;\n\tint imm, k;\n\tint i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\n\tfor (k = 0; k < ARRAY_SIZE(regs); k++) {\n\t\ts64 reg = regs[k];\n\n\t\ti += __bpf_ld_imm64(&insn[i], R3, reg);\n\n\t\tfor (imm = 0; imm < bits; imm++) {\n\t\t\tu64 val;\n\n\t\t\t \n\t\t\tinsn[i++] = BPF_ALU64_REG(BPF_MOV, R1, R3);\n\t\t\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R2, imm);\n\t\t\tif (alu32) {\n\t\t\t\tif (mode == BPF_K)\n\t\t\t\t\tinsn[i++] = BPF_ALU32_IMM(op, R1, imm);\n\t\t\t\telse\n\t\t\t\t\tinsn[i++] = BPF_ALU32_REG(op, R1, R2);\n\n\t\t\t\tif (op == BPF_ARSH)\n\t\t\t\t\treg = (s32)reg;\n\t\t\t\telse\n\t\t\t\t\treg = (u32)reg;\n\t\t\t\t__bpf_alu_result(&val, reg, imm, op);\n\t\t\t\tval = (u32)val;\n\t\t\t} else {\n\t\t\t\tif (mode == BPF_K)\n\t\t\t\t\tinsn[i++] = BPF_ALU64_IMM(op, R1, imm);\n\t\t\t\telse\n\t\t\t\t\tinsn[i++] = BPF_ALU64_REG(op, R1, R2);\n\t\t\t\t__bpf_alu_result(&val, reg, imm, op);\n\t\t\t}\n\n\t\t\t \n\n\t\t\t \n\t\t\ti += __bpf_ld_imm64(&insn[i], R4, val);\n\t\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, R1, R4, 1);\n\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t}\n\t}\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsn[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\nstatic int bpf_fill_alu64_lsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_LSH, BPF_K, false);\n}\n\nstatic int bpf_fill_alu64_rsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_RSH, BPF_K, false);\n}\n\nstatic int bpf_fill_alu64_arsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_ARSH, BPF_K, false);\n}\n\nstatic int bpf_fill_alu64_lsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_LSH, BPF_X, false);\n}\n\nstatic int bpf_fill_alu64_rsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_RSH, BPF_X, false);\n}\n\nstatic int bpf_fill_alu64_arsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_ARSH, BPF_X, false);\n}\n\nstatic int bpf_fill_alu32_lsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_LSH, BPF_K, true);\n}\n\nstatic int bpf_fill_alu32_rsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_RSH, BPF_K, true);\n}\n\nstatic int bpf_fill_alu32_arsh_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_ARSH, BPF_K, true);\n}\n\nstatic int bpf_fill_alu32_lsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_LSH, BPF_X, true);\n}\n\nstatic int bpf_fill_alu32_rsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_RSH, BPF_X, true);\n}\n\nstatic int bpf_fill_alu32_arsh_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift(self, BPF_ARSH, BPF_X, true);\n}\n\n \nstatic int __bpf_fill_alu_shift_same_reg(struct bpf_test *self, u8 op,\n\t\t\t\t\t bool alu32)\n{\n\tint bits = alu32 ? 32 : 64;\n\tint len = 3 + 6 * bits;\n\tstruct bpf_insn *insn;\n\tint i = 0;\n\tu64 val;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\n\tfor (val = 0; val < bits; val++) {\n\t\tu64 res;\n\n\t\t \n\t\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R1, val);\n\t\tif (alu32)\n\t\t\tinsn[i++] = BPF_ALU32_REG(op, R1, R1);\n\t\telse\n\t\t\tinsn[i++] = BPF_ALU64_REG(op, R1, R1);\n\n\t\t \n\t\t__bpf_alu_result(&res, val, val, op);\n\t\tif (alu32)\n\t\t\tres = (u32)res;\n\t\ti += __bpf_ld_imm64(&insn[i], R2, res);\n\n\t\t \n\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, R1, R2, 1);\n\t\tinsn[i++] = BPF_EXIT_INSN();\n\t}\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsn[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\nstatic int bpf_fill_alu64_lsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_LSH, false);\n}\n\nstatic int bpf_fill_alu64_rsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_RSH, false);\n}\n\nstatic int bpf_fill_alu64_arsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_ARSH, false);\n}\n\nstatic int bpf_fill_alu32_lsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_LSH, true);\n}\n\nstatic int bpf_fill_alu32_rsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_RSH, true);\n}\n\nstatic int bpf_fill_alu32_arsh_same_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_shift_same_reg(self, BPF_ARSH, true);\n}\n\n \n\nstatic inline s64 value(int msb, int delta, int sign)\n{\n\treturn sign * (1LL << msb) + delta;\n}\n\nstatic int __bpf_fill_pattern(struct bpf_test *self, void *arg,\n\t\t\t      int dbits, int sbits, int block1, int block2,\n\t\t\t      int (*emit)(struct bpf_test*, void*,\n\t\t\t\t\t  struct bpf_insn*, s64, s64))\n{\n\tstatic const int sgn[][2] = {{1, 1}, {1, -1}, {-1, 1}, {-1, -1}};\n\tstruct bpf_insn *insns;\n\tint di, si, bt, db, sb;\n\tint count, len, k;\n\tint extra = 1 + 2;\n\tint i = 0;\n\n\t \n\tcount = (dbits - 1) * (sbits - 1) * block1 * block1 * ARRAY_SIZE(sgn);\n\tcount += (max(dbits, sbits) - 1) * block2 * block2 * ARRAY_SIZE(sgn);\n\n\t \n\tlen = extra + count * (*emit)(self, arg, NULL, 0, 0);\n\tinsns = kmalloc_array(len, sizeof(*insns), GFP_KERNEL);\n\tif (!insns)\n\t\treturn -ENOMEM;\n\n\t \n\tinsns[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\n\t \n\tfor (di = 0; di < dbits - 1; di++)                  \n\t\tfor (si = 0; si < sbits - 1; si++)          \n\t\t\tfor (k = 0; k < ARRAY_SIZE(sgn); k++)  \n\t\t\t\tfor (db = -(block1 / 2);\n\t\t\t\t     db < (block1 + 1) / 2; db++)\n\t\t\t\t\tfor (sb = -(block1 / 2);\n\t\t\t\t\t     sb < (block1 + 1) / 2; sb++) {\n\t\t\t\t\t\ts64 dst, src;\n\n\t\t\t\t\t\tdst = value(di, db, sgn[k][0]);\n\t\t\t\t\t\tsrc = value(si, sb, sgn[k][1]);\n\t\t\t\t\t\ti += (*emit)(self, arg,\n\t\t\t\t\t\t\t     &insns[i],\n\t\t\t\t\t\t\t     dst, src);\n\t\t\t\t\t}\n\t \n\tfor (bt = 0; bt < max(dbits, sbits) - 1; bt++)         \n\t\tfor (k = 0; k < ARRAY_SIZE(sgn); k++)          \n\t\t\tfor (db = -(block2 / 2); db < (block2 + 1) / 2; db++)\n\t\t\t\tfor (sb = -(block2 / 2);\n\t\t\t\t     sb < (block2 + 1) / 2; sb++) {\n\t\t\t\t\ts64 dst, src;\n\n\t\t\t\t\tdst = value(bt % dbits, db, sgn[k][0]);\n\t\t\t\t\tsrc = value(bt % sbits, sb, sgn[k][1]);\n\t\t\t\t\ti += (*emit)(self, arg, &insns[i],\n\t\t\t\t\t\t     dst, src);\n\t\t\t\t}\n\n\t \n\tinsns[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\tBUG_ON(i > len);\n\n\tself->u.ptr.insns = insns;\n\tself->u.ptr.len = i;\n\n\treturn 0;\n}\n\n \n#define PATTERN_BLOCK1 1\n#define PATTERN_BLOCK2 5\n\n \n#define NR_PATTERN_RUNS 1\n\n \nstatic int __bpf_emit_alu64_imm(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 imm)\n{\n\tint op = *(int *)arg;\n\tint i = 0;\n\tu64 res;\n\n\tif (!insns)\n\t\treturn 7;\n\n\tif (__bpf_alu_result(&res, dst, (s32)imm, op)) {\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R3, res);\n\t\tinsns[i++] = BPF_ALU64_IMM(op, R1, imm);\n\t\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\t}\n\n\treturn i;\n}\n\nstatic int __bpf_emit_alu32_imm(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 imm)\n{\n\tint op = *(int *)arg;\n\tint i = 0;\n\tu64 res;\n\n\tif (!insns)\n\t\treturn 7;\n\n\tif (__bpf_alu_result(&res, (u32)dst, (u32)imm, op)) {\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R3, (u32)res);\n\t\tinsns[i++] = BPF_ALU32_IMM(op, R1, imm);\n\t\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\t}\n\n\treturn i;\n}\n\nstatic int __bpf_emit_alu64_reg(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\tint i = 0;\n\tu64 res;\n\n\tif (!insns)\n\t\treturn 9;\n\n\tif (__bpf_alu_result(&res, dst, src, op)) {\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\t\ti += __bpf_ld_imm64(&insns[i], R3, res);\n\t\tinsns[i++] = BPF_ALU64_REG(op, R1, R2);\n\t\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\t}\n\n\treturn i;\n}\n\nstatic int __bpf_emit_alu32_reg(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\tint i = 0;\n\tu64 res;\n\n\tif (!insns)\n\t\treturn 9;\n\n\tif (__bpf_alu_result(&res, (u32)dst, (u32)src, op)) {\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\t\ti += __bpf_ld_imm64(&insns[i], R3, (u32)res);\n\t\tinsns[i++] = BPF_ALU32_REG(op, R1, R2);\n\t\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\t}\n\n\treturn i;\n}\n\nstatic int __bpf_fill_alu64_imm(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 32,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_alu64_imm);\n}\n\nstatic int __bpf_fill_alu32_imm(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 32,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_alu32_imm);\n}\n\nstatic int __bpf_fill_alu64_reg(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_alu64_reg);\n}\n\nstatic int __bpf_fill_alu32_reg(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_alu32_reg);\n}\n\n \nstatic int bpf_fill_alu64_mov_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_MOV);\n}\n\nstatic int bpf_fill_alu64_and_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_AND);\n}\n\nstatic int bpf_fill_alu64_or_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_OR);\n}\n\nstatic int bpf_fill_alu64_xor_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_XOR);\n}\n\nstatic int bpf_fill_alu64_add_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_ADD);\n}\n\nstatic int bpf_fill_alu64_sub_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_SUB);\n}\n\nstatic int bpf_fill_alu64_mul_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_MUL);\n}\n\nstatic int bpf_fill_alu64_div_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_DIV);\n}\n\nstatic int bpf_fill_alu64_mod_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_imm(self, BPF_MOD);\n}\n\n \nstatic int bpf_fill_alu32_mov_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_MOV);\n}\n\nstatic int bpf_fill_alu32_and_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_AND);\n}\n\nstatic int bpf_fill_alu32_or_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_OR);\n}\n\nstatic int bpf_fill_alu32_xor_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_XOR);\n}\n\nstatic int bpf_fill_alu32_add_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_ADD);\n}\n\nstatic int bpf_fill_alu32_sub_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_SUB);\n}\n\nstatic int bpf_fill_alu32_mul_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_MUL);\n}\n\nstatic int bpf_fill_alu32_div_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_DIV);\n}\n\nstatic int bpf_fill_alu32_mod_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_imm(self, BPF_MOD);\n}\n\n \nstatic int bpf_fill_alu64_mov_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_MOV);\n}\n\nstatic int bpf_fill_alu64_and_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_AND);\n}\n\nstatic int bpf_fill_alu64_or_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_OR);\n}\n\nstatic int bpf_fill_alu64_xor_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_XOR);\n}\n\nstatic int bpf_fill_alu64_add_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_ADD);\n}\n\nstatic int bpf_fill_alu64_sub_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_SUB);\n}\n\nstatic int bpf_fill_alu64_mul_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_MUL);\n}\n\nstatic int bpf_fill_alu64_div_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_DIV);\n}\n\nstatic int bpf_fill_alu64_mod_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu64_reg(self, BPF_MOD);\n}\n\n \nstatic int bpf_fill_alu32_mov_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_MOV);\n}\n\nstatic int bpf_fill_alu32_and_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_AND);\n}\n\nstatic int bpf_fill_alu32_or_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_OR);\n}\n\nstatic int bpf_fill_alu32_xor_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_XOR);\n}\n\nstatic int bpf_fill_alu32_add_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_ADD);\n}\n\nstatic int bpf_fill_alu32_sub_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_SUB);\n}\n\nstatic int bpf_fill_alu32_mul_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_MUL);\n}\n\nstatic int bpf_fill_alu32_div_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_DIV);\n}\n\nstatic int bpf_fill_alu32_mod_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu32_reg(self, BPF_MOD);\n}\n\n \nstatic int __bpf_fill_alu_imm_regs(struct bpf_test *self, u8 op, bool alu32)\n{\n\tint len = 2 + 10 * 10;\n\tstruct bpf_insn *insns;\n\tu64 dst, res;\n\tint i = 0;\n\tu32 imm;\n\tint rd;\n\n\tinsns = kmalloc_array(len, sizeof(*insns), GFP_KERNEL);\n\tif (!insns)\n\t\treturn -ENOMEM;\n\n\t \n\tif (alu32)\n\t\tdst = 0x76543210U;\n\telse\n\t\tdst = 0x7edcba9876543210ULL;\n\timm = 0x01234567U;\n\n\tif (op == BPF_LSH || op == BPF_RSH || op == BPF_ARSH)\n\t\timm &= 31;\n\n\t__bpf_alu_result(&res, dst, imm, op);\n\n\tif (alu32)\n\t\tres = (u32)res;\n\n\t \n\tfor (rd = R0; rd <= R9; rd++) {\n\t\ti += __bpf_ld_imm64(&insns[i], rd, dst);\n\n\t\tif (alu32)\n\t\t\tinsns[i++] = BPF_ALU32_IMM(op, rd, imm);\n\t\telse\n\t\t\tinsns[i++] = BPF_ALU64_IMM(op, rd, imm);\n\n\t\tinsns[i++] = BPF_JMP32_IMM(BPF_JEQ, rd, res, 2);\n\t\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\tinsns[i++] = BPF_ALU64_IMM(BPF_RSH, rd, 32);\n\t\tinsns[i++] = BPF_JMP32_IMM(BPF_JEQ, rd, res >> 32, 2);\n\t\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\t}\n\n\tinsns[i++] = BPF_MOV64_IMM(R0, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insns;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\n \nstatic int bpf_fill_alu64_mov_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MOV, false);\n}\n\nstatic int bpf_fill_alu64_and_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_AND, false);\n}\n\nstatic int bpf_fill_alu64_or_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_OR, false);\n}\n\nstatic int bpf_fill_alu64_xor_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_XOR, false);\n}\n\nstatic int bpf_fill_alu64_lsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_LSH, false);\n}\n\nstatic int bpf_fill_alu64_rsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_RSH, false);\n}\n\nstatic int bpf_fill_alu64_arsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_ARSH, false);\n}\n\nstatic int bpf_fill_alu64_add_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_ADD, false);\n}\n\nstatic int bpf_fill_alu64_sub_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_SUB, false);\n}\n\nstatic int bpf_fill_alu64_mul_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MUL, false);\n}\n\nstatic int bpf_fill_alu64_div_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_DIV, false);\n}\n\nstatic int bpf_fill_alu64_mod_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MOD, false);\n}\n\n \nstatic int bpf_fill_alu32_mov_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MOV, true);\n}\n\nstatic int bpf_fill_alu32_and_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_AND, true);\n}\n\nstatic int bpf_fill_alu32_or_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_OR, true);\n}\n\nstatic int bpf_fill_alu32_xor_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_XOR, true);\n}\n\nstatic int bpf_fill_alu32_lsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_LSH, true);\n}\n\nstatic int bpf_fill_alu32_rsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_RSH, true);\n}\n\nstatic int bpf_fill_alu32_arsh_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_ARSH, true);\n}\n\nstatic int bpf_fill_alu32_add_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_ADD, true);\n}\n\nstatic int bpf_fill_alu32_sub_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_SUB, true);\n}\n\nstatic int bpf_fill_alu32_mul_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MUL, true);\n}\n\nstatic int bpf_fill_alu32_div_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_DIV, true);\n}\n\nstatic int bpf_fill_alu32_mod_imm_regs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_imm_regs(self, BPF_MOD, true);\n}\n\n \nstatic int __bpf_fill_alu_reg_pairs(struct bpf_test *self, u8 op, bool alu32)\n{\n\tint len = 2 + 10 * 10 * 12;\n\tu64 dst, src, res, same;\n\tstruct bpf_insn *insns;\n\tint rd, rs;\n\tint i = 0;\n\n\tinsns = kmalloc_array(len, sizeof(*insns), GFP_KERNEL);\n\tif (!insns)\n\t\treturn -ENOMEM;\n\n\t \n\tif (alu32) {\n\t\tdst = 0x76543210U;\n\t\tsrc = 0x01234567U;\n\t} else {\n\t\tdst = 0x7edcba9876543210ULL;\n\t\tsrc = 0x0123456789abcdefULL;\n\t}\n\n\tif (op == BPF_LSH || op == BPF_RSH || op == BPF_ARSH)\n\t\tsrc &= 31;\n\n\t__bpf_alu_result(&res, dst, src, op);\n\t__bpf_alu_result(&same, src, src, op);\n\n\tif (alu32) {\n\t\tres = (u32)res;\n\t\tsame = (u32)same;\n\t}\n\n\t \n\tfor (rd = R0; rd <= R9; rd++) {\n\t\tfor (rs = R0; rs <= R9; rs++) {\n\t\t\tu64 val = rd == rs ? same : res;\n\n\t\t\ti += __bpf_ld_imm64(&insns[i], rd, dst);\n\t\t\ti += __bpf_ld_imm64(&insns[i], rs, src);\n\n\t\t\tif (alu32)\n\t\t\t\tinsns[i++] = BPF_ALU32_REG(op, rd, rs);\n\t\t\telse\n\t\t\t\tinsns[i++] = BPF_ALU64_REG(op, rd, rs);\n\n\t\t\tinsns[i++] = BPF_JMP32_IMM(BPF_JEQ, rd, val, 2);\n\t\t\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\t\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\t\tinsns[i++] = BPF_ALU64_IMM(BPF_RSH, rd, 32);\n\t\t\tinsns[i++] = BPF_JMP32_IMM(BPF_JEQ, rd, val >> 32, 2);\n\t\t\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\t\t\tinsns[i++] = BPF_EXIT_INSN();\n\t\t}\n\t}\n\n\tinsns[i++] = BPF_MOV64_IMM(R0, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insns;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\n \nstatic int bpf_fill_alu64_mov_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MOV, false);\n}\n\nstatic int bpf_fill_alu64_and_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_AND, false);\n}\n\nstatic int bpf_fill_alu64_or_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_OR, false);\n}\n\nstatic int bpf_fill_alu64_xor_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_XOR, false);\n}\n\nstatic int bpf_fill_alu64_lsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_LSH, false);\n}\n\nstatic int bpf_fill_alu64_rsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_RSH, false);\n}\n\nstatic int bpf_fill_alu64_arsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_ARSH, false);\n}\n\nstatic int bpf_fill_alu64_add_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_ADD, false);\n}\n\nstatic int bpf_fill_alu64_sub_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_SUB, false);\n}\n\nstatic int bpf_fill_alu64_mul_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MUL, false);\n}\n\nstatic int bpf_fill_alu64_div_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_DIV, false);\n}\n\nstatic int bpf_fill_alu64_mod_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MOD, false);\n}\n\n \nstatic int bpf_fill_alu32_mov_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MOV, true);\n}\n\nstatic int bpf_fill_alu32_and_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_AND, true);\n}\n\nstatic int bpf_fill_alu32_or_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_OR, true);\n}\n\nstatic int bpf_fill_alu32_xor_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_XOR, true);\n}\n\nstatic int bpf_fill_alu32_lsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_LSH, true);\n}\n\nstatic int bpf_fill_alu32_rsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_RSH, true);\n}\n\nstatic int bpf_fill_alu32_arsh_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_ARSH, true);\n}\n\nstatic int bpf_fill_alu32_add_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_ADD, true);\n}\n\nstatic int bpf_fill_alu32_sub_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_SUB, true);\n}\n\nstatic int bpf_fill_alu32_mul_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MUL, true);\n}\n\nstatic int bpf_fill_alu32_div_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_DIV, true);\n}\n\nstatic int bpf_fill_alu32_mod_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_alu_reg_pairs(self, BPF_MOD, true);\n}\n\n \n\nstatic int __bpf_emit_atomic64(struct bpf_test *self, void *arg,\n\t\t\t       struct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\tu64 keep, fetch, res;\n\tint i = 0;\n\n\tif (!insns)\n\t\treturn 21;\n\n\tswitch (op) {\n\tcase BPF_XCHG:\n\t\tres = src;\n\t\tbreak;\n\tdefault:\n\t\t__bpf_alu_result(&res, dst, src, BPF_OP(op));\n\t}\n\n\tkeep = 0x0123456789abcdefULL;\n\tif (op & BPF_FETCH)\n\t\tfetch = dst;\n\telse\n\t\tfetch = src;\n\n\ti += __bpf_ld_imm64(&insns[i], R0, keep);\n\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\ti += __bpf_ld_imm64(&insns[i], R3, res);\n\ti += __bpf_ld_imm64(&insns[i], R4, fetch);\n\ti += __bpf_ld_imm64(&insns[i], R5, keep);\n\n\tinsns[i++] = BPF_STX_MEM(BPF_DW, R10, R1, -8);\n\tinsns[i++] = BPF_ATOMIC_OP(BPF_DW, op, R10, R2, -8);\n\tinsns[i++] = BPF_LDX_MEM(BPF_DW, R1, R10, -8);\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R2, R4, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R5, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\treturn i;\n}\n\nstatic int __bpf_emit_atomic32(struct bpf_test *self, void *arg,\n\t\t\t       struct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\tu64 keep, fetch, res;\n\tint i = 0;\n\n\tif (!insns)\n\t\treturn 21;\n\n\tswitch (op) {\n\tcase BPF_XCHG:\n\t\tres = src;\n\t\tbreak;\n\tdefault:\n\t\t__bpf_alu_result(&res, (u32)dst, (u32)src, BPF_OP(op));\n\t}\n\n\tkeep = 0x0123456789abcdefULL;\n\tif (op & BPF_FETCH)\n\t\tfetch = (u32)dst;\n\telse\n\t\tfetch = src;\n\n\ti += __bpf_ld_imm64(&insns[i], R0, keep);\n\ti += __bpf_ld_imm64(&insns[i], R1, (u32)dst);\n\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\ti += __bpf_ld_imm64(&insns[i], R3, (u32)res);\n\ti += __bpf_ld_imm64(&insns[i], R4, fetch);\n\ti += __bpf_ld_imm64(&insns[i], R5, keep);\n\n\tinsns[i++] = BPF_STX_MEM(BPF_W, R10, R1, -4);\n\tinsns[i++] = BPF_ATOMIC_OP(BPF_W, op, R10, R2, -4);\n\tinsns[i++] = BPF_LDX_MEM(BPF_W, R1, R10, -4);\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R2, R4, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R5, 1);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\treturn i;\n}\n\nstatic int __bpf_emit_cmpxchg64(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint i = 0;\n\n\tif (!insns)\n\t\treturn 23;\n\n\ti += __bpf_ld_imm64(&insns[i], R0, ~dst);\n\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\n\t \n\tinsns[i++] = BPF_STX_MEM(BPF_DW, R10, R1, -8);\n\tinsns[i++] = BPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -8);\n\tinsns[i++] = BPF_LDX_MEM(BPF_DW, R3, R10, -8);\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R1, R3, 2);\n\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R3, 2);\n\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\t \n\tinsns[i++] = BPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -8);\n\tinsns[i++] = BPF_LDX_MEM(BPF_DW, R3, R10, -8);\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R2, R3, 2);\n\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R1, 2);\n\tinsns[i++] = BPF_MOV64_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\treturn i;\n}\n\nstatic int __bpf_emit_cmpxchg32(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint i = 0;\n\n\tif (!insns)\n\t\treturn 27;\n\n\ti += __bpf_ld_imm64(&insns[i], R0, ~dst);\n\ti += __bpf_ld_imm64(&insns[i], R1, (u32)dst);\n\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\n\t \n\tinsns[i++] = BPF_STX_MEM(BPF_W, R10, R1, -4);\n\tinsns[i++] = BPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R2, -4);\n\tinsns[i++] = BPF_ZEXT_REG(R0),  \n\tinsns[i++] = BPF_LDX_MEM(BPF_W, R3, R10, -4);\n\n\tinsns[i++] = BPF_JMP32_REG(BPF_JEQ, R1, R3, 2);\n\tinsns[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R3, 2);\n\tinsns[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\t \n\ti += __bpf_ld_imm64(&insns[i], R0, dst);\n\tinsns[i++] = BPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R2, -4);\n\tinsns[i++] = BPF_ZEXT_REG(R0),  \n\tinsns[i++] = BPF_LDX_MEM(BPF_W, R3, R10, -4);\n\n\tinsns[i++] = BPF_JMP32_REG(BPF_JEQ, R2, R3, 2);\n\tinsns[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\tinsns[i++] = BPF_JMP_REG(BPF_JEQ, R0, R1, 2);\n\tinsns[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\tinsns[i++] = BPF_EXIT_INSN();\n\n\treturn i;\n}\n\nstatic int __bpf_fill_atomic64(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  0, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_atomic64);\n}\n\nstatic int __bpf_fill_atomic32(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  0, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_atomic32);\n}\n\n \nstatic int bpf_fill_atomic64_add(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_ADD);\n}\n\nstatic int bpf_fill_atomic64_and(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_AND);\n}\n\nstatic int bpf_fill_atomic64_or(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_OR);\n}\n\nstatic int bpf_fill_atomic64_xor(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_XOR);\n}\n\nstatic int bpf_fill_atomic64_add_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_ADD | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_and_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_AND | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_or_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_OR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_xor_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_XOR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_xchg(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic64(self, BPF_XCHG);\n}\n\nstatic int bpf_fill_cmpxchg64(struct bpf_test *self)\n{\n\treturn __bpf_fill_pattern(self, NULL, 64, 64, 0, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_cmpxchg64);\n}\n\n \nstatic int bpf_fill_atomic32_add(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_ADD);\n}\n\nstatic int bpf_fill_atomic32_and(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_AND);\n}\n\nstatic int bpf_fill_atomic32_or(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_OR);\n}\n\nstatic int bpf_fill_atomic32_xor(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_XOR);\n}\n\nstatic int bpf_fill_atomic32_add_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_ADD | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_and_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_AND | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_or_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_OR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_xor_fetch(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_XOR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_xchg(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic32(self, BPF_XCHG);\n}\n\nstatic int bpf_fill_cmpxchg32(struct bpf_test *self)\n{\n\treturn __bpf_fill_pattern(self, NULL, 64, 64, 0, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_cmpxchg32);\n}\n\n \nstatic int __bpf_fill_atomic_reg_pairs(struct bpf_test *self, u8 width, u8 op)\n{\n\tstruct bpf_insn *insn;\n\tint len = 2 + 34 * 10 * 10;\n\tu64 mem, upd, res;\n\tint rd, rs, i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\t \n\tif (width == BPF_DW) {\n\t\tmem = 0x0123456789abcdefULL;\n\t\tupd = 0xfedcba9876543210ULL;\n\t} else {  \n\t\tmem = 0x01234567U;\n\t\tupd = 0x76543210U;\n\t}\n\n\t \n\tswitch (op) {\n\tcase BPF_XCHG:\n\t\tres = upd;\n\t\tbreak;\n\tcase BPF_CMPXCHG:\n\t\tres = mem;\n\t\tbreak;\n\tdefault:\n\t\t__bpf_alu_result(&res, mem, upd, BPF_OP(op));\n\t}\n\n\t \n\tfor (rd = R0; rd <= R9; rd++) {\n\t\tfor (rs = R0; rs <= R9; rs++) {\n\t\t\tu64 cmp, src;\n\n\t\t\t \n\t\t\ti += __bpf_ld_imm64(&insn[i], R0, mem);\n\t\t\tinsn[i++] = BPF_STX_MEM(width, R10, R0, -8);\n\n\t\t\t \n\t\t\ti += __bpf_ld_imm64(&insn[i], R0, ~mem);\n\t\t\ti += __bpf_ld_imm64(&insn[i], rs, upd);\n\t\t\tinsn[i++] = BPF_MOV64_REG(rd, R10);\n\n\t\t\t \n\t\t\tinsn[i++] = BPF_ATOMIC_OP(width, op, rd, rs, -8);\n\t\t\tif (op == BPF_CMPXCHG && width == BPF_W)\n\t\t\t\tinsn[i++] = BPF_ZEXT_REG(R0);\n\n\t\t\t \n\t\t\tif (op == BPF_CMPXCHG)\n\t\t\t\tcmp = mem;   \n\t\t\telse if (R0 == rd || R0 == rs)\n\t\t\t\tcmp = 0;     \n\t\t\telse\n\t\t\t\tcmp = ~mem;  \n\t\t\tif (cmp) {\n\t\t\t\tinsn[i++] = BPF_JMP32_IMM(BPF_JEQ, R0,\n\t\t\t\t\t\t\t   (u32)cmp, 2);\n\t\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t\tinsn[i++] = BPF_ALU64_IMM(BPF_RSH, R0, 32);\n\t\t\t\tinsn[i++] = BPF_JMP32_IMM(BPF_JEQ, R0,\n\t\t\t\t\t\t\t   cmp >> 32, 2);\n\t\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t}\n\n\t\t\t \n\t\t\tif (rs == R0 && op == BPF_CMPXCHG)\n\t\t\t\tsrc = 0;    \n\t\t\telse if (rs == rd && (op == BPF_CMPXCHG ||\n\t\t\t\t\t      !(op & BPF_FETCH)))\n\t\t\t\tsrc = 0;    \n\t\t\telse if (op == BPF_CMPXCHG)\n\t\t\t\tsrc = upd;  \n\t\t\telse if (op & BPF_FETCH)\n\t\t\t\tsrc = mem;  \n\t\t\telse  \n\t\t\t\tsrc = upd;  \n\t\t\tif (src) {\n\t\t\t\tinsn[i++] = BPF_JMP32_IMM(BPF_JEQ, rs,\n\t\t\t\t\t\t\t   (u32)src, 2);\n\t\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t\tinsn[i++] = BPF_ALU64_IMM(BPF_RSH, rs, 32);\n\t\t\t\tinsn[i++] = BPF_JMP32_IMM(BPF_JEQ, rs,\n\t\t\t\t\t\t\t   src >> 32, 2);\n\t\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t}\n\n\t\t\t \n\t\t\tif (!(rd == R0 && op == BPF_CMPXCHG) &&\n\t\t\t    !(rd == rs && (op & BPF_FETCH))) {\n\t\t\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, rd, R10, 2);\n\t\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t}\n\n\t\t\t \n\t\t\tif (rs != rd) {                   \n\t\t\t\ti += __bpf_ld_imm64(&insn[i], R1, res);\n\t\t\t} else if (op == BPF_XCHG) {      \n\t\t\t\tinsn[i++] = BPF_MOV64_REG(R1, R10);\n\t\t\t} else if (op == BPF_CMPXCHG) {   \n\t\t\t\ti += __bpf_ld_imm64(&insn[i], R1, mem);\n\t\t\t} else {                         \n\t\t\t\ti += __bpf_ld_imm64(&insn[i], R1, mem);\n\t\t\t\tinsn[i++] = BPF_ALU64_REG(BPF_OP(op), R1, R10);\n\t\t\t}\n\n\t\t\tinsn[i++] = BPF_LDX_MEM(width, R0, R10, -8);\n\t\t\tif (width == BPF_DW)\n\t\t\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, R0, R1, 2);\n\t\t\telse  \n\t\t\t\tinsn[i++] = BPF_JMP32_REG(BPF_JEQ, R0, R1, 2);\n\t\t\tinsn[i++] = BPF_MOV32_IMM(R0, __LINE__);\n\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t}\n\t}\n\n\tinsn[i++] = BPF_MOV64_IMM(R0, 1);\n\tinsn[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = i;\n\tBUG_ON(i > len);\n\n\treturn 0;\n}\n\n \nstatic int bpf_fill_atomic64_add_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_ADD);\n}\n\nstatic int bpf_fill_atomic64_and_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_AND);\n}\n\nstatic int bpf_fill_atomic64_or_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_OR);\n}\n\nstatic int bpf_fill_atomic64_xor_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_XOR);\n}\n\nstatic int bpf_fill_atomic64_add_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_ADD | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_and_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_AND | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_or_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_OR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_xor_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_XOR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic64_xchg_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_XCHG);\n}\n\nstatic int bpf_fill_atomic64_cmpxchg_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_DW, BPF_CMPXCHG);\n}\n\n \nstatic int bpf_fill_atomic32_add_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_ADD);\n}\n\nstatic int bpf_fill_atomic32_and_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_AND);\n}\n\nstatic int bpf_fill_atomic32_or_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_OR);\n}\n\nstatic int bpf_fill_atomic32_xor_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_XOR);\n}\n\nstatic int bpf_fill_atomic32_add_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_ADD | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_and_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_AND | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_or_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_OR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_xor_fetch_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_XOR | BPF_FETCH);\n}\n\nstatic int bpf_fill_atomic32_xchg_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_XCHG);\n}\n\nstatic int bpf_fill_atomic32_cmpxchg_reg_pairs(struct bpf_test *self)\n{\n\treturn __bpf_fill_atomic_reg_pairs(self, BPF_W, BPF_CMPXCHG);\n}\n\n \nstatic int bpf_fill_ld_imm64_magn(struct bpf_test *self)\n{\n\tint block = 64;  \n\tint len = 3 + 8 * 63 * block * 2;\n\tstruct bpf_insn *insn;\n\tint bit, adj, sign;\n\tint i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\n\tfor (bit = 0; bit <= 62; bit++) {\n\t\tfor (adj = -block / 2; adj < block / 2; adj++) {\n\t\t\tfor (sign = -1; sign <= 1; sign += 2) {\n\t\t\t\ts64 imm = sign * ((1LL << bit) + adj);\n\n\t\t\t\t \n\t\t\t\ti += __bpf_ld_imm64(&insn[i], R1, imm);\n\n\t\t\t\t \n\t\t\t\tinsn[i++] = BPF_ALU32_IMM(BPF_MOV, R2, imm);\n\t\t\t\tinsn[i++] = BPF_ALU32_IMM(BPF_MOV, R3,\n\t\t\t\t\t\t\t  (u32)(imm >> 32));\n\t\t\t\tinsn[i++] = BPF_ALU64_IMM(BPF_LSH, R3, 32);\n\t\t\t\tinsn[i++] = BPF_ALU64_REG(BPF_OR, R2, R3);\n\n\t\t\t\t \n\t\t\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, R1, R2, 1);\n\t\t\t\tinsn[i++] = BPF_EXIT_INSN();\n\t\t\t}\n\t\t}\n\t}\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsn[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\n \nstatic int __bpf_fill_ld_imm64_bytes(struct bpf_test *self,\n\t\t\t\t     u8 base1, u8 mask1,\n\t\t\t\t     u8 base2, u8 mask2)\n{\n\tstruct bpf_insn *insn;\n\tint len = 3 + 8 * BIT(8);\n\tint pattern, index;\n\tu32 rand = 1;\n\tint i = 0;\n\n\tinsn = kmalloc_array(len, sizeof(*insn), GFP_KERNEL);\n\tif (!insn)\n\t\treturn -ENOMEM;\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\n\tfor (pattern = 0; pattern < BIT(8); pattern++) {\n\t\tu64 imm = 0;\n\n\t\tfor (index = 0; index < 8; index++) {\n\t\t\tint byte;\n\n\t\t\tif (pattern & BIT(index))\n\t\t\t\tbyte = (base1 & mask1) | (rand & ~mask1);\n\t\t\telse\n\t\t\t\tbyte = (base2 & mask2) | (rand & ~mask2);\n\t\t\timm = (imm << 8) | byte;\n\t\t}\n\n\t\t \n\t\trand = rand * 1664525 + 1013904223;\n\n\t\t \n\t\ti += __bpf_ld_imm64(&insn[i], R1, imm);\n\n\t\t \n\t\tinsn[i++] = BPF_ALU32_IMM(BPF_MOV, R2, imm);\n\t\tinsn[i++] = BPF_ALU32_IMM(BPF_MOV, R3, (u32)(imm >> 32));\n\t\tinsn[i++] = BPF_ALU64_IMM(BPF_LSH, R3, 32);\n\t\tinsn[i++] = BPF_ALU64_REG(BPF_OR, R2, R3);\n\n\t\t \n\t\tinsn[i++] = BPF_JMP_REG(BPF_JEQ, R1, R2, 1);\n\t\tinsn[i++] = BPF_EXIT_INSN();\n\t}\n\n\tinsn[i++] = BPF_ALU64_IMM(BPF_MOV, R0, 1);\n\tinsn[i++] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insn;\n\tself->u.ptr.len = len;\n\tBUG_ON(i != len);\n\n\treturn 0;\n}\n\nstatic int bpf_fill_ld_imm64_checker(struct bpf_test *self)\n{\n\treturn __bpf_fill_ld_imm64_bytes(self, 0, 0xff, 0xff, 0xff);\n}\n\nstatic int bpf_fill_ld_imm64_pos_neg(struct bpf_test *self)\n{\n\treturn __bpf_fill_ld_imm64_bytes(self, 1, 0x81, 0x80, 0x80);\n}\n\nstatic int bpf_fill_ld_imm64_pos_zero(struct bpf_test *self)\n{\n\treturn __bpf_fill_ld_imm64_bytes(self, 1, 0x81, 0, 0xff);\n}\n\nstatic int bpf_fill_ld_imm64_neg_zero(struct bpf_test *self)\n{\n\treturn __bpf_fill_ld_imm64_bytes(self, 0x80, 0x80, 0, 0xff);\n}\n\n \n\nstatic bool __bpf_match_jmp_cond(s64 v1, s64 v2, u8 op)\n{\n\tswitch (op) {\n\tcase BPF_JSET:\n\t\treturn !!(v1 & v2);\n\tcase BPF_JEQ:\n\t\treturn v1 == v2;\n\tcase BPF_JNE:\n\t\treturn v1 != v2;\n\tcase BPF_JGT:\n\t\treturn (u64)v1 > (u64)v2;\n\tcase BPF_JGE:\n\t\treturn (u64)v1 >= (u64)v2;\n\tcase BPF_JLT:\n\t\treturn (u64)v1 < (u64)v2;\n\tcase BPF_JLE:\n\t\treturn (u64)v1 <= (u64)v2;\n\tcase BPF_JSGT:\n\t\treturn v1 > v2;\n\tcase BPF_JSGE:\n\t\treturn v1 >= v2;\n\tcase BPF_JSLT:\n\t\treturn v1 < v2;\n\tcase BPF_JSLE:\n\t\treturn v1 <= v2;\n\t}\n\treturn false;\n}\n\nstatic int __bpf_emit_jmp_imm(struct bpf_test *self, void *arg,\n\t\t\t      struct bpf_insn *insns, s64 dst, s64 imm)\n{\n\tint op = *(int *)arg;\n\n\tif (insns) {\n\t\tbool match = __bpf_match_jmp_cond(dst, (s32)imm, op);\n\t\tint i = 0;\n\n\t\tinsns[i++] = BPF_ALU32_IMM(BPF_MOV, R0, match);\n\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\tinsns[i++] = BPF_JMP_IMM(op, R1, imm, 1);\n\t\tif (!match)\n\t\t\tinsns[i++] = BPF_JMP_IMM(BPF_JA, 0, 0, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\treturn i;\n\t}\n\n\treturn 5 + 1;\n}\n\nstatic int __bpf_emit_jmp32_imm(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 imm)\n{\n\tint op = *(int *)arg;\n\n\tif (insns) {\n\t\tbool match = __bpf_match_jmp_cond((s32)dst, (s32)imm, op);\n\t\tint i = 0;\n\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\tinsns[i++] = BPF_JMP32_IMM(op, R1, imm, 1);\n\t\tif (!match)\n\t\t\tinsns[i++] = BPF_JMP_IMM(BPF_JA, 0, 0, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\treturn i;\n\t}\n\n\treturn 5;\n}\n\nstatic int __bpf_emit_jmp_reg(struct bpf_test *self, void *arg,\n\t\t\t      struct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\n\tif (insns) {\n\t\tbool match = __bpf_match_jmp_cond(dst, src, op);\n\t\tint i = 0;\n\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\t\tinsns[i++] = BPF_JMP_REG(op, R1, R2, 1);\n\t\tif (!match)\n\t\t\tinsns[i++] = BPF_JMP_IMM(BPF_JA, 0, 0, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\treturn i;\n\t}\n\n\treturn 7;\n}\n\nstatic int __bpf_emit_jmp32_reg(struct bpf_test *self, void *arg,\n\t\t\t\tstruct bpf_insn *insns, s64 dst, s64 src)\n{\n\tint op = *(int *)arg;\n\n\tif (insns) {\n\t\tbool match = __bpf_match_jmp_cond((s32)dst, (s32)src, op);\n\t\tint i = 0;\n\n\t\ti += __bpf_ld_imm64(&insns[i], R1, dst);\n\t\ti += __bpf_ld_imm64(&insns[i], R2, src);\n\t\tinsns[i++] = BPF_JMP32_REG(op, R1, R2, 1);\n\t\tif (!match)\n\t\t\tinsns[i++] = BPF_JMP_IMM(BPF_JA, 0, 0, 1);\n\t\tinsns[i++] = BPF_EXIT_INSN();\n\n\t\treturn i;\n\t}\n\n\treturn 7;\n}\n\nstatic int __bpf_fill_jmp_imm(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 32,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_jmp_imm);\n}\n\nstatic int __bpf_fill_jmp32_imm(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 32,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_jmp32_imm);\n}\n\nstatic int __bpf_fill_jmp_reg(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_jmp_reg);\n}\n\nstatic int __bpf_fill_jmp32_reg(struct bpf_test *self, int op)\n{\n\treturn __bpf_fill_pattern(self, &op, 64, 64,\n\t\t\t\t  PATTERN_BLOCK1, PATTERN_BLOCK2,\n\t\t\t\t  &__bpf_emit_jmp32_reg);\n}\n\n \nstatic int bpf_fill_jmp_jset_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JSET);\n}\n\nstatic int bpf_fill_jmp_jeq_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JEQ);\n}\n\nstatic int bpf_fill_jmp_jne_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JNE);\n}\n\nstatic int bpf_fill_jmp_jgt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JGT);\n}\n\nstatic int bpf_fill_jmp_jge_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JGE);\n}\n\nstatic int bpf_fill_jmp_jlt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JLT);\n}\n\nstatic int bpf_fill_jmp_jle_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JLE);\n}\n\nstatic int bpf_fill_jmp_jsgt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JSGT);\n}\n\nstatic int bpf_fill_jmp_jsge_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JSGE);\n}\n\nstatic int bpf_fill_jmp_jslt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JSLT);\n}\n\nstatic int bpf_fill_jmp_jsle_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_imm(self, BPF_JSLE);\n}\n\n \nstatic int bpf_fill_jmp32_jset_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JSET);\n}\n\nstatic int bpf_fill_jmp32_jeq_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JEQ);\n}\n\nstatic int bpf_fill_jmp32_jne_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JNE);\n}\n\nstatic int bpf_fill_jmp32_jgt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JGT);\n}\n\nstatic int bpf_fill_jmp32_jge_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JGE);\n}\n\nstatic int bpf_fill_jmp32_jlt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JLT);\n}\n\nstatic int bpf_fill_jmp32_jle_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JLE);\n}\n\nstatic int bpf_fill_jmp32_jsgt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JSGT);\n}\n\nstatic int bpf_fill_jmp32_jsge_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JSGE);\n}\n\nstatic int bpf_fill_jmp32_jslt_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JSLT);\n}\n\nstatic int bpf_fill_jmp32_jsle_imm(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_imm(self, BPF_JSLE);\n}\n\n \nstatic int bpf_fill_jmp_jset_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JSET);\n}\n\nstatic int bpf_fill_jmp_jeq_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JEQ);\n}\n\nstatic int bpf_fill_jmp_jne_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JNE);\n}\n\nstatic int bpf_fill_jmp_jgt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JGT);\n}\n\nstatic int bpf_fill_jmp_jge_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JGE);\n}\n\nstatic int bpf_fill_jmp_jlt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JLT);\n}\n\nstatic int bpf_fill_jmp_jle_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JLE);\n}\n\nstatic int bpf_fill_jmp_jsgt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JSGT);\n}\n\nstatic int bpf_fill_jmp_jsge_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JSGE);\n}\n\nstatic int bpf_fill_jmp_jslt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JSLT);\n}\n\nstatic int bpf_fill_jmp_jsle_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp_reg(self, BPF_JSLE);\n}\n\n \nstatic int bpf_fill_jmp32_jset_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JSET);\n}\n\nstatic int bpf_fill_jmp32_jeq_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JEQ);\n}\n\nstatic int bpf_fill_jmp32_jne_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JNE);\n}\n\nstatic int bpf_fill_jmp32_jgt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JGT);\n}\n\nstatic int bpf_fill_jmp32_jge_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JGE);\n}\n\nstatic int bpf_fill_jmp32_jlt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JLT);\n}\n\nstatic int bpf_fill_jmp32_jle_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JLE);\n}\n\nstatic int bpf_fill_jmp32_jsgt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JSGT);\n}\n\nstatic int bpf_fill_jmp32_jsge_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JSGE);\n}\n\nstatic int bpf_fill_jmp32_jslt_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JSLT);\n}\n\nstatic int bpf_fill_jmp32_jsle_reg(struct bpf_test *self)\n{\n\treturn __bpf_fill_jmp32_reg(self, BPF_JSLE);\n}\n\n \n\n \n#define MAX_STAGGERED_JMP_SIZE ((0x7fff / 3) & ~1)\n\n \n#define NR_STAGGERED_JMP_RUNS 10\n\nstatic int __bpf_fill_staggered_jumps(struct bpf_test *self,\n\t\t\t\t      const struct bpf_insn *jmp,\n\t\t\t\t      u64 r1, u64 r2)\n{\n\tint size = self->test[0].result - 1;\n\tint len = 4 + 3 * (size + 1);\n\tstruct bpf_insn *insns;\n\tint off, ind;\n\n\tinsns = kmalloc_array(len, sizeof(*insns), GFP_KERNEL);\n\tif (!insns)\n\t\treturn -ENOMEM;\n\n\t \n\tinsns[0] = BPF_ALU64_IMM(BPF_MOV, R0, 0);\n\tinsns[1] = BPF_ALU64_IMM(BPF_MOV, R1, r1);\n\tinsns[2] = BPF_ALU64_IMM(BPF_MOV, R2, r2);\n\tinsns[3] = BPF_JMP_IMM(BPF_JA, 0, 0, 3 * size / 2);\n\n\t \n\tfor (ind = 0, off = size; ind <= size; ind++, off -= 2) {\n\t\tstruct bpf_insn *ins = &insns[4 + 3 * ind];\n\t\tint loc;\n\n\t\tif (off == 0)\n\t\t\toff--;\n\n\t\tloc = abs(off);\n\t\tins[0] = BPF_JMP_IMM(BPF_JNE, R0, loc - 1,\n\t\t\t\t     3 * (size - ind) + 1);\n\t\tins[1] = BPF_ALU64_IMM(BPF_MOV, R0, loc);\n\t\tins[2] = *jmp;\n\t\tins[2].off = 3 * (off - 1);\n\t}\n\n\t \n\tinsns[len - 1] = BPF_EXIT_INSN();\n\n\tself->u.ptr.insns = insns;\n\tself->u.ptr.len = len;\n\n\treturn 0;\n}\n\n \nstatic int bpf_fill_staggered_ja(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JA, 0, 0, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0, 0);\n}\n\n \nstatic int bpf_fill_staggered_jeq_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JEQ, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jne_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JNE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 4321, 0);\n}\n\nstatic int bpf_fill_staggered_jset_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JSET, R1, 0x82, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x86, 0);\n}\n\nstatic int bpf_fill_staggered_jgt_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JGT, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x80000000, 0);\n}\n\nstatic int bpf_fill_staggered_jge_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JGE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jlt_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JLT, R1, 0x80000000, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jle_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JLE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jsgt_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JSGT, R1, -2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, 0);\n}\n\nstatic int bpf_fill_staggered_jsge_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JSGE, R1, -2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, 0);\n}\n\nstatic int bpf_fill_staggered_jslt_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JSLT, R1, -1, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, 0);\n}\n\nstatic int bpf_fill_staggered_jsle_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_IMM(BPF_JSLE, R1, -1, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, 0);\n}\n\n \nstatic int bpf_fill_staggered_jeq_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JEQ, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jne_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JNE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 4321, 1234);\n}\n\nstatic int bpf_fill_staggered_jset_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JSET, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x86, 0x82);\n}\n\nstatic int bpf_fill_staggered_jgt_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JGT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x80000000, 1234);\n}\n\nstatic int bpf_fill_staggered_jge_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JGE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jlt_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JLT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0x80000000);\n}\n\nstatic int bpf_fill_staggered_jle_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JLE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jsgt_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JSGT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, -2);\n}\n\nstatic int bpf_fill_staggered_jsge_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JSGE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, -2);\n}\n\nstatic int bpf_fill_staggered_jslt_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JSLT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, -1);\n}\n\nstatic int bpf_fill_staggered_jsle_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP_REG(BPF_JSLE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, -1);\n}\n\n \nstatic int bpf_fill_staggered_jeq32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JEQ, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jne32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JNE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 4321, 0);\n}\n\nstatic int bpf_fill_staggered_jset32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JSET, R1, 0x82, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x86, 0);\n}\n\nstatic int bpf_fill_staggered_jgt32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JGT, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x80000000, 0);\n}\n\nstatic int bpf_fill_staggered_jge32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JGE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jlt32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JLT, R1, 0x80000000, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jle32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JLE, R1, 1234, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0);\n}\n\nstatic int bpf_fill_staggered_jsgt32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JSGT, R1, -2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, 0);\n}\n\nstatic int bpf_fill_staggered_jsge32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JSGE, R1, -2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, 0);\n}\n\nstatic int bpf_fill_staggered_jslt32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JSLT, R1, -1, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, 0);\n}\n\nstatic int bpf_fill_staggered_jsle32_imm(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_IMM(BPF_JSLE, R1, -1, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, 0);\n}\n\n \nstatic int bpf_fill_staggered_jeq32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JEQ, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jne32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JNE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 4321, 1234);\n}\n\nstatic int bpf_fill_staggered_jset32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JSET, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x86, 0x82);\n}\n\nstatic int bpf_fill_staggered_jgt32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JGT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 0x80000000, 1234);\n}\n\nstatic int bpf_fill_staggered_jge32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JGE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jlt32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JLT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 0x80000000);\n}\n\nstatic int bpf_fill_staggered_jle32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JLE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, 1234, 1234);\n}\n\nstatic int bpf_fill_staggered_jsgt32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JSGT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, -2);\n}\n\nstatic int bpf_fill_staggered_jsge32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JSGE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, -2);\n}\n\nstatic int bpf_fill_staggered_jslt32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JSLT, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -2, -1);\n}\n\nstatic int bpf_fill_staggered_jsle32_reg(struct bpf_test *self)\n{\n\tstruct bpf_insn jmp = BPF_JMP32_REG(BPF_JSLE, R1, R2, 0);\n\n\treturn __bpf_fill_staggered_jumps(self, &jmp, -1, -1);\n}\n\n\nstatic struct bpf_test tests[] = {\n\t{\n\t\t\"TAX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_NEG, 0),  \n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),  \n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_IND, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 10, 20, 30, 40, 50 },\n\t\t{ { 2, 10 }, { 3, 20 }, { 4, 30 } },\n\t},\n\t{\n\t\t\"TXA\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)  \n\t\t},\n\t\tCLASSIC,\n\t\t{ 10, 20, 30, 40, 50 },\n\t\t{ { 1, 2 }, { 3, 6 }, { 4, 8 } },\n\t},\n\t{\n\t\t\"ADD_SUB_MUL_K\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 2),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 3),\n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 0xffffffff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_MUL | BPF_K, 3),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xfffffffd } }\n\t},\n\t{\n\t\t\"DIV_MOD_KX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 8),\n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_K, 2),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffffffff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffffffff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_K, 0x70000000),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffffffff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_MOD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffffffff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_MOD | BPF_K, 0x70000000),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0x20000000 } }\n\t},\n\t{\n\t\t\"AND_OR_LSH_K\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xff),\n\t\t\tBPF_STMT(BPF_ALU | BPF_AND | BPF_K, 0xf0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_LSH | BPF_K, 27),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xf),\n\t\t\tBPF_STMT(BPF_ALU | BPF_OR | BPF_K, 0xf0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0x800000ff }, { 1, 0x800000ff } },\n\t},\n\t{\n\t\t\"LD_IMM_0\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0),  \n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 1 } },\n\t},\n\t{\n\t\t\"LD_IND\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_IND, MAX_K),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0 }, { 10, 0 }, { 60, 0 } },\n\t},\n\t{\n\t\t\"LD_ABS\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS, 1000),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0 }, { 10, 0 }, { 60, 0 } },\n\t},\n\t{\n\t\t\"LD_ABS_LL\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, SKF_LL_OFF),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, SKF_LL_OFF + 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 1, 2, 3 },\n\t\t{ { 1, 0 }, { 2, 3 } },\n\t},\n\t{\n\t\t\"LD_IND_LL\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, SKF_LL_OFF - 1),\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_IND, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 1, 2, 3, 0xff },\n\t\t{ { 1, 1 }, { 3, 3 }, { 4, 0xff } },\n\t},\n\t{\n\t\t\"LD_ABS_NET\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, SKF_NET_OFF),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, SKF_NET_OFF + 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3 },\n\t\t{ { 15, 0 }, { 16, 3 } },\n\t},\n\t{\n\t\t\"LD_IND_NET\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, SKF_NET_OFF - 15),\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_IND, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3 },\n\t\t{ { 14, 0 }, { 15, 1 }, { 17, 3 } },\n\t},\n\t{\n\t\t\"LD_PKTTYPE\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PKTTYPE),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, SKB_TYPE, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PKTTYPE),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, SKB_TYPE, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PKTTYPE),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, SKB_TYPE, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 3 }, { 10, 3 } },\n\t},\n\t{\n\t\t\"LD_MARK\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_MARK),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, SKB_MARK}, { 10, SKB_MARK} },\n\t},\n\t{\n\t\t\"LD_RXHASH\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_RXHASH),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, SKB_HASH}, { 10, SKB_HASH} },\n\t},\n\t{\n\t\t\"LD_QUEUE\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_QUEUE),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, SKB_QUEUE_MAP }, { 10, SKB_QUEUE_MAP } },\n\t},\n\t{\n\t\t\"LD_PROTOCOL\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 1),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 20, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PROTOCOL),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 2),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 30, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 10, 20, 30 },\n\t\t{ { 10, ETH_P_IP }, { 100, ETH_P_IP } },\n\t},\n\t{\n\t\t\"LD_VLAN_TAG\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_VLAN_TAG),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{\n\t\t\t{ 1, SKB_VLAN_TCI },\n\t\t\t{ 10, SKB_VLAN_TCI }\n\t\t},\n\t},\n\t{\n\t\t\"LD_VLAN_TAG_PRESENT\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_VLAN_TAG_PRESENT),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{\n\t\t\t{ 1, SKB_VLAN_PRESENT },\n\t\t\t{ 10, SKB_VLAN_PRESENT }\n\t\t},\n\t},\n\t{\n\t\t\"LD_IFINDEX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_IFINDEX),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, SKB_DEV_IFINDEX }, { 10, SKB_DEV_IFINDEX } },\n\t},\n\t{\n\t\t\"LD_HATYPE\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_HATYPE),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, SKB_DEV_TYPE }, { 10, SKB_DEV_TYPE } },\n\t},\n\t{\n\t\t\"LD_CPU\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_CPU),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_CPU),\n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0 }, { 10, 0 } },\n\t},\n\t{\n\t\t\"LD_NLATTR\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 3),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n#ifdef __BIG_ENDIAN\n\t\t{ 0xff, 0xff, 0, 4, 0, 2, 0, 4, 0, 3 },\n#else\n\t\t{ 0xff, 0xff, 4, 0, 2, 0, 4, 0, 3, 0 },\n#endif\n\t\t{ { 4, 0 }, { 20, 6 } },\n\t},\n\t{\n\t\t\"LD_NLATTR_NEST\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 3),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_NLATTR_NEST),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n#ifdef __BIG_ENDIAN\n\t\t{ 0xff, 0xff, 0, 12, 0, 1, 0, 4, 0, 2, 0, 4, 0, 3 },\n#else\n\t\t{ 0xff, 0xff, 12, 0, 1, 0, 4, 0, 2, 0, 4, 0, 3, 0 },\n#endif\n\t\t{ { 4, 0 }, { 20, 10 } },\n\t},\n\t{\n\t\t\"LD_PAYLOAD_OFF\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PAY_OFFSET),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PAY_OFFSET),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PAY_OFFSET),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PAY_OFFSET),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_PAY_OFFSET),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t \n\t\t{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t\t  0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t\t  0x08, 0x00,\n\t\t  0x45, 0x00, 0x00, 0x54, 0xac, 0x8b, 0x40, 0x00, 0x40,\n\t\t  0x01, 0x90, 0x1b, 0x7f, 0x00, 0x00, 0x01 },\n\t\t{ { 30, 0 }, { 100, 42 } },\n\t},\n\t{\n\t\t\"LD_ANC_XOR\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 10),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 300),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_ALU_XOR_X),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 4, 0xA ^ 300 }, { 20, 0xA ^ 300 } },\n\t},\n\t{\n\t\t\"SPILL_FILL\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 2),\n\t\t\tBPF_STMT(BPF_ALU | BPF_RSH, 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_XOR | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_ST, 1),  \n\t\t\tBPF_STMT(BPF_ALU | BPF_XOR | BPF_K, 0x80000000),\n\t\t\tBPF_STMT(BPF_ST, 2),  \n\t\t\tBPF_STMT(BPF_STX, 15),  \n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 1),\n\t\t\tBPF_STMT(BPF_LD | BPF_MEM, 2),\n\t\t\tBPF_STMT(BPF_ALU | BPF_XOR | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 15),\n\t\t\tBPF_STMT(BPF_ALU | BPF_XOR | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0x80000001 }, { 2, 0x80000002 }, { 60, 0x80000000 ^ 60 } }\n\t},\n\t{\n\t\t\"JEQ\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 2),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_X, 0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 3, 3, 3, 3, 3 },\n\t\t{ { 1, 0 }, { 3, 1 }, { 4, MAX_K } },\n\t},\n\t{\n\t\t\"JGT\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 2),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGT | BPF_X, 0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 4, 4, 4, 3, 3 },\n\t\t{ { 2, 0 }, { 3, 1 }, { 4, MAX_K } },\n\t},\n\t{\n\t\t\"JGE (jt 0), test 1\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 2),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_X, 0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 4, 4, 4, 3, 3 },\n\t\t{ { 2, 0 }, { 3, 1 }, { 4, 1 } },\n\t},\n\t{\n\t\t\"JGE (jt 0), test 2\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 2),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_X, 0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 4, 4, 5, 3, 3 },\n\t\t{ { 4, 1 }, { 5, 1 }, { 6, MAX_K } },\n\t},\n\t{\n\t\t\"JGE\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_IND, MAX_K),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_K, 1, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 10),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_K, 2, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 20),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_K, 3, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_K, 4, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 40),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 1, 2, 3, 4, 5 },\n\t\t{ { 1, 20 }, { 3, 40 }, { 5, MAX_K } },\n\t},\n\t{\n\t\t\"JSET\",\n\t\t.u.insns = {\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JA, 0, 0, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JA, 1, 1, 1),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JA, 0, 0, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JA, 0, 0, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_LEN, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_K, 4),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_IND, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 1, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 10),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0x80000000, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 20),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0xffffff, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0xffffff, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0xffffff, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0xffffff, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0xffffff, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 30),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, MAX_K)\n\t\t},\n\t\tCLASSIC,\n\t\t{ 0, 0xAA, 0x55, 1 },\n\t\t{ { 4, 10 }, { 5, 20 }, { 6, MAX_K } },\n\t},\n\t{\n\t\t\"tcpdump port 22\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 12),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x86dd, 0, 8),  \n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 20),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x84, 2, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x6, 1, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x11, 0, 17),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 54),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 14, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 56),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 12, 13),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x0800, 0, 12),  \n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 23),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x84, 2, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x6, 1, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x11, 0, 8),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 20),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0x1fff, 6, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 14),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_IND, 14),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 2, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_IND, 16),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0xffff),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0),\n\t\t},\n\t\tCLASSIC,\n\t\t \n\t\t{ 0x10, 0xbf, 0x48, 0xd6, 0x43, 0xd6,\n\t\t  0x3c, 0x07, 0x54, 0x43, 0xe5, 0x76,\n\t\t  0x08, 0x00,\n\t\t  0x45, 0x10, 0x00, 0x64, 0x75, 0xb5,\n\t\t  0x40, 0x00, 0x40, 0x06, 0xad, 0x2e,  \n\t\t  0x0a, 0x01, 0x01, 0x95,  \n\t\t  0x0a, 0x01, 0x02, 0x0a,  \n\t\t  0xc2, 0x24,\n\t\t  0x00, 0x16   },\n\t\t{ { 10, 0 }, { 30, 0 }, { 100, 65535 } },\n\t},\n\t{\n\t\t\"tcpdump complex\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 12),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x86dd, 30, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x800, 0, 29),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 23),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x6, 0, 27),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 20),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JSET | BPF_K, 0x1fff, 25, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 14),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_IND, 14),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 2, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_IND, 16),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 22, 0, 20),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 16),\n\t\t\tBPF_STMT(BPF_ST, 1),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_ABS, 14),\n\t\t\tBPF_STMT(BPF_ALU | BPF_AND | BPF_K, 0xf),\n\t\t\tBPF_STMT(BPF_ALU | BPF_LSH | BPF_K, 2),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0x5),  \n\t\t\tBPF_STMT(BPF_LD | BPF_MEM, 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_ST, 5),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 14),\n\t\t\tBPF_STMT(BPF_LD | BPF_B | BPF_IND, 26),\n\t\t\tBPF_STMT(BPF_ALU | BPF_AND | BPF_K, 0xf0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_RSH | BPF_K, 2),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0x9),  \n\t\t\tBPF_STMT(BPF_LD | BPF_MEM, 5),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_X, 0, 4, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_LEN, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGT | BPF_K, 0x73, 1, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE | BPF_K, 0xfc23ac00, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0xffff),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ 0x10, 0xbf, 0x48, 0xd6, 0x43, 0xd6,\n\t\t  0x3c, 0x07, 0x54, 0x43, 0xe5, 0x76,\n\t\t  0x08, 0x00,\n\t\t  0x45, 0x10, 0x00, 0x64, 0x75, 0xb5,\n\t\t  0x40, 0x00, 0x40, 0x06, 0xad, 0x2e,  \n\t\t  0x0a, 0x01, 0x01, 0x95,  \n\t\t  0x0a, 0x01, 0x02, 0x0a,  \n\t\t  0xc2, 0x24,\n\t\t  0x00, 0x16   },\n\t\t{ { 10, 0 }, { 30, 0 }, { 100, 65535 } },\n\t},\n\t{\n\t\t\"RET_A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0)\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ {1, 0}, {2, 0} },\n\t},\n\t{\n\t\t\"INT: ADD trivial\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R2),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, -1),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R1, 3),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffd } }\n\t},\n\t{\n\t\t\"INT: MUL_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R2),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 0xfffffffd, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"INT: MUL_X2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R2, 3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R2),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 8),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 0x2ffffff, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"INT: MUL32_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R2, 3),\n\t\t\tBPF_ALU32_REG(BPF_MUL, R1, R2),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 8),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 0xffffff, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t \n\t\t\"INT: ADD 64-bit\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, 4),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 5),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, 6),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, 7),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, 8),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, 9),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R3, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R4, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R5, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R6, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R7, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R8, 20),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R9, 20),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R2, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R3, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R4, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R5, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R6, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R7, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R8, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R9, 10),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 155, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R1, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 456, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R2, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R2, 1358, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R3, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R3, 4063, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R4, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R4, 12177, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R5, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R5, 36518, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R6, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R6, 109540, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R7, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R7, 328605, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R8, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R8, 985799, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R9, R9),  \n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R9),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2957380 } }\n\t},\n\t{\n\t\t\"INT: ADD 32-bit\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 20),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R4, 4),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R5, 5),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R6, 6),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R7, 7),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R8, 8),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R9, 9),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R3, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R4, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R5, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R6, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R7, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R8, 10),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R9, 10),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 155, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R1, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 456, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R2, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R2, 1358, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R3, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R3, 4063, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R4, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R4, 12177, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R5, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R5, 36518, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R6, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R6, 109540, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R7, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R7, 328605, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R8, R9),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R8, 985799, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R0),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R1),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R3),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R4),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R5),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R6),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R7),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R8),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R9, R9),  \n\t\t\tBPF_ALU32_REG(BPF_MOV, R0, R9),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2957380 } }\n\t},\n\t{\t \n\t\t\"INT: SUB\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, 4),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 5),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, 6),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, 7),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, 8),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, 9),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 10),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, -55, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R2, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R3, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R4, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R5, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R6, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R7, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R9),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R8, 10),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R8),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R9, 10),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 10),\n\t\t\tBPF_ALU64_IMM(BPF_NEG, R0, 0),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R9),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 11 } }\n\t},\n\t{\t \n\t\t\"INT: XOR\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R1, R1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 10),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R1),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R2, R2),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R2, R2),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R3, R3),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 10),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R3, R3),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R4, R4),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, -1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R3, R4, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R4, R4),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R5, R5),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, -1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R5, R4, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R5, R5),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R6, R6),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, -1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R5, R6, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R6, R6),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R7, R7),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R7, R6, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R7, R7),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R8, R8),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R7, R8, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R8, R8),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R9, R9),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R9, R8, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R9, R9),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R0, R0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R9, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R1),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R0, R0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R9, R0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\t \n\t\t\"INT: MUL\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 11),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, 4),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 5),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, 6),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, 7),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, 8),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, 9),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R9),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 10),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 439084800, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R0),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R2),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R4),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R5),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R6),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R7),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R8),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R1, R9),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R1, 10),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R2, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R2, 32),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R2, 0x5a924, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R1, 32),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R1, 32),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 0xebb90000, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R0),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R4),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R5),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R6),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R7),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R8),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R2, R9),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R2, 10),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R2, 32),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x35d97ef2 } }\n\t},\n\t{\t \n\t\t\"MOV REG64\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffLL),\n\t\t\tBPF_MOV64_REG(R1, R0),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_MOV64_REG(R3, R2),\n\t\t\tBPF_MOV64_REG(R4, R3),\n\t\t\tBPF_MOV64_REG(R5, R4),\n\t\t\tBPF_MOV64_REG(R6, R5),\n\t\t\tBPF_MOV64_REG(R7, R6),\n\t\t\tBPF_MOV64_REG(R8, R7),\n\t\t\tBPF_MOV64_REG(R9, R8),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, 0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, 0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R9),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 0xfefe),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfefe } }\n\t},\n\t{\t \n\t\t\"MOV REG32\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffLL),\n\t\t\tBPF_MOV64_REG(R1, R0),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_MOV64_REG(R3, R2),\n\t\t\tBPF_MOV64_REG(R4, R3),\n\t\t\tBPF_MOV64_REG(R5, R4),\n\t\t\tBPF_MOV64_REG(R6, R5),\n\t\t\tBPF_MOV64_REG(R7, R6),\n\t\t\tBPF_MOV64_REG(R8, R7),\n\t\t\tBPF_MOV64_REG(R9, R8),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R2, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R4, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R5, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R6, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R7, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R8, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R9, 0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R9),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 0xfefe),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfefe } }\n\t},\n\t{\t \n\t\t\"LD IMM64\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffLL),\n\t\t\tBPF_MOV64_REG(R1, R0),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_MOV64_REG(R3, R2),\n\t\t\tBPF_MOV64_REG(R4, R3),\n\t\t\tBPF_MOV64_REG(R5, R4),\n\t\t\tBPF_MOV64_REG(R6, R5),\n\t\t\tBPF_MOV64_REG(R7, R6),\n\t\t\tBPF_MOV64_REG(R8, R7),\n\t\t\tBPF_MOV64_REG(R9, R8),\n\t\t\tBPF_LD_IMM64(R0, 0x0LL),\n\t\t\tBPF_LD_IMM64(R1, 0x0LL),\n\t\t\tBPF_LD_IMM64(R2, 0x0LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0LL),\n\t\t\tBPF_LD_IMM64(R4, 0x0LL),\n\t\t\tBPF_LD_IMM64(R5, 0x0LL),\n\t\t\tBPF_LD_IMM64(R6, 0x0LL),\n\t\t\tBPF_LD_IMM64(R7, 0x0LL),\n\t\t\tBPF_LD_IMM64(R8, 0x0LL),\n\t\t\tBPF_LD_IMM64(R9, 0x0LL),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R0),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R3),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R4),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R5),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R6),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R7),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R8),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R9),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 0xfefe),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfefe } }\n\t},\n\t{\n\t\t\"INT: ALU MIX\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 11),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, -1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R2, 3),\n\t\t\tBPF_ALU64_REG(BPF_DIV, R0, R2),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 10, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOD, R0, 3),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n\t{\n\t\t\"INT: shifts by register\",\n\t\t.u.insns_int = {\n\t\t\tBPF_MOV64_IMM(R0, -1234),\n\t\t\tBPF_MOV64_IMM(R1, 1),\n\t\t\tBPF_ALU32_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0x7ffffd97, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV64_IMM(R2, 1),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R2),\n\t\t\tBPF_MOV32_IMM(R4, -1234),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R4, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R4, 63),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R4),  \n\t\t\tBPF_MOV64_IMM(R3, 47),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R3),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, -617, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV64_IMM(R2, 1),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R4, R2),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R4, 92, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV64_IMM(R4, 4),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R4, R4),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R4, 64, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV64_IMM(R4, 5),\n\t\t\tBPF_ALU32_REG(BPF_LSH, R4, R4),  \n\t\t\tBPF_JMP_IMM(BPF_JEQ, R4, 160, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV64_IMM(R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n#ifdef CONFIG_32BIT\n\t{\n\t\t\"INT: 32-bit context pointer word order and zero-extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R1, 0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R1, 0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n#endif\n\t{\n\t\t\"check: missing ret\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 1),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"check: div_k_0\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_K, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0)\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"check: unknown insn\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LDX | BPF_W | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0)\n\t\t},\n\t\tCLASSIC | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"check: out of range spill/fill\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_STX, 16),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0)\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"JUMPS + HOLES\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE, 0, 13, 15),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x90c2894d, 3, 4),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x90c2894d, 1, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE, 0, 14, 15),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE, 0, 13, 14),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x2ac28349, 2, 3),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x2ac28349, 1, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE, 0, 14, 15),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JGE, 0, 13, 14),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x90d2ff41, 2, 3),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ, 0x90d2ff41, 1, 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_H | BPF_ABS, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ 0x00, 0x1b, 0x21, 0x3c, 0x9d, 0xf8,\n\t\t  0x90, 0xe2, 0xba, 0x0a, 0x56, 0xb4,\n\t\t  0x08, 0x00,\n\t\t  0x45, 0x00, 0x00, 0x28, 0x00, 0x00,\n\t\t  0x20, 0x00, 0x40, 0x11, 0x00, 0x00,  \n\t\t  0xc0, 0xa8, 0x33, 0x01,\n\t\t  0xc0, 0xa8, 0x33, 0x02,\n\t\t  0xbb, 0xb6,\n\t\t  0xa9, 0xfa,\n\t\t  0x00, 0x14, 0x00, 0x00,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc,\n\t\t  0xcc, 0xcc, 0xcc, 0xcc },\n\t\t{ { 88, 0x001b } }\n\t},\n\t{\n\t\t\"check: RET X\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_RET | BPF_X, 0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"check: LDX + RET X\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 42),\n\t\t\tBPF_STMT(BPF_RET | BPF_X, 0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\t \n\t\t\"M[]: alt STX + LDX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 100),\n\t\t\tBPF_STMT(BPF_STX, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 1),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 2),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 2),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 3),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 3),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 4),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 4),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 5),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 5),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 6),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 6),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 7),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 7),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 8),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 8),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 9),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 9),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 10),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 10),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 11),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 11),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 12),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 12),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 13),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 13),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 14),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 14),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_STX, 15),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 15),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 116 } },\n\t},\n\t{\t \n\t\t\"M[]: full STX + full LDX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xbadfeedb),\n\t\t\tBPF_STMT(BPF_STX, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xecabedae),\n\t\t\tBPF_STMT(BPF_STX, 1),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xafccfeaf),\n\t\t\tBPF_STMT(BPF_STX, 2),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xbffdcedc),\n\t\t\tBPF_STMT(BPF_STX, 3),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xfbbbdccb),\n\t\t\tBPF_STMT(BPF_STX, 4),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xfbabcbda),\n\t\t\tBPF_STMT(BPF_STX, 5),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xaedecbdb),\n\t\t\tBPF_STMT(BPF_STX, 6),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xadebbade),\n\t\t\tBPF_STMT(BPF_STX, 7),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xfcfcfaec),\n\t\t\tBPF_STMT(BPF_STX, 8),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xbcdddbdc),\n\t\t\tBPF_STMT(BPF_STX, 9),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xfeefdfac),\n\t\t\tBPF_STMT(BPF_STX, 10),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xcddcdeea),\n\t\t\tBPF_STMT(BPF_STX, 11),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xaccfaebb),\n\t\t\tBPF_STMT(BPF_STX, 12),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xbdcccdcf),\n\t\t\tBPF_STMT(BPF_STX, 13),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xaaedecde),\n\t\t\tBPF_STMT(BPF_STX, 14),\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0xfaeacdad),\n\t\t\tBPF_STMT(BPF_STX, 15),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 0),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 1),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 2),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 3),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 4),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 5),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 6),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 7),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 8),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 9),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 10),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 11),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 12),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 13),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 14),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_LDX | BPF_MEM, 15),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0x2a5a5e5 } },\n\t},\n\t{\n\t\t\"check: SKF_AD_MAX\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF + SKF_AD_MAX),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = NULL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\t \n\t\t\"LD [SKF_AD_OFF-1]\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_W | BPF_ABS,\n\t\t\t\t SKF_AD_OFF - 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t},\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0 } },\n\t},\n\t{\n\t\t\"load 64-bit immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x567800001234LL),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_MOV64_REG(R3, R2),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R2, 32),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R3, 32),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R3, 32),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R2, 0x5678, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R3, 0x1234, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_LD_IMM64(R0, 0x1ffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t \n\t{\n\t\t\"ALU_MOV_X: dst = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_MOV_X: dst = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967295U),\n\t\t\tBPF_ALU32_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t{\n\t\t\"ALU64_MOV_X: dst = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_MOV_X: dst = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967295U),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t \n\t{\n\t\t\"ALU_MOV_K: dst = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_MOV_K: dst = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 4294967295U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t{\n\t\t\"ALU_MOV_K: 0x0000ffffffff0000 = 0x00000000ffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x00000000ffffffffLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_MOV_K: small negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"ALU_MOV_K: small negative zero extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU_MOV_K: large negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123456789),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123456789 } }\n\t},\n\t{\n\t\t\"ALU_MOV_K: large negative zero extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123456789),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_MOV_K: dst = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_MOV_K: dst = 2147483647\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2147483647 } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: dst = 0x0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 0x0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_MOV_K: dst = -1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_MOV_K: small negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"ALU64_MOV_K: small negative sign extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } }\n\t},\n\t{\n\t\t\"ALU64_MOV_K: large negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -123456789),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123456789 } }\n\t},\n\t{\n\t\t\"ALU64_MOV_K: large negative sign extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -123456789),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } }\n\t},\n\t \n\t{\n\t\t\"ALU_ADD_X: 1 + 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_ADD_X: 1 + 4294967294 = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967294U),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t{\n\t\t\"ALU_ADD_X: 2 + 4294967294 = 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_LD_IMM64(R1, 4294967294U),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_X: 1 + 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_X: 1 + 4294967294 = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967294U),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t{\n\t\t\"ALU64_ADD_X: 2 + 4294967294 = 4294967296\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_LD_IMM64(R1, 4294967294U),\n\t\t\tBPF_LD_IMM64(R2, 4294967296ULL),\n\t\t\tBPF_ALU64_REG(BPF_ADD, R0, R1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R2, 2),\n\t\t\tBPF_MOV32_IMM(R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_ADD_K: 1 + 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 3 + 0 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 1 + 4294967294 = 4294967295\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 4294967294U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4294967295U } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 4294967294 + 2 = 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967294U),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 2),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + (-1) = 0x00000000ffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0x00000000ffffffff),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + 0xffff = 0xffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0xffff),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R2, 0xffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + 0x7fffffff = 0x7fffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0x7fffffff),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R2, 0x7fffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + 0x80000000 = 0x80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0x80000000),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R2, 0x80000000),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + 0x80008000 = 0x80008000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0x80008000),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R2, 0x80008000),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 1 + 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 3 + 0 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 1 + 2147483646 = 2147483647\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 2147483646),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2147483647 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 4294967294 + 2 = 4294967296\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967294U),\n\t\t\tBPF_LD_IMM64(R1, 4294967296ULL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 2),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 2147483646 + -2147483647 = -1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483646),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, -2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 1 + 0 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x1),\n\t\t\tBPF_LD_IMM64(R3, 0x1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0x0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 0 + (-1) = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 0 + 0xffff = 0xffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0xffff),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0xffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 0 + 0x7fffffff = 0x7fffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0x7fffffff),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0x7fffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 0 + 0x80000000 = 0xffffffff80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffff80000000LL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0x80000000),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU_ADD_K: 0 + 0x80008000 = 0xffffffff80008000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffff80008000LL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 0x80008000),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_SUB_X: 3 - 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU32_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_SUB_X: 4294967295 - 4294967294 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967294U),\n\t\t\tBPF_ALU32_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_SUB_X: 3 - 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_SUB_X: 4294967295 - 4294967294 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967294U),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_SUB_K: 3 - 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_SUB, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_SUB_K: 3 - 0 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_SUB, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_SUB_K: 4294967295 - 4294967294 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_SUB, R0, 4294967294U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_SUB_K: 3 - 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_SUB_K: 3 - 0 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_SUB_K: 4294967294 - 4294967295 = -1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967294U),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 4294967295U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } },\n\t},\n\t{\n\t\t\"ALU64_ADD_K: 2147483646 - 2147483647 = -1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483646),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R0, 2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_MUL_X: 2 * 3 = 6\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 3),\n\t\t\tBPF_ALU32_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 6 } },\n\t},\n\t{\n\t\t\"ALU_MUL_X: 2 * 0x7FFFFFF8 = 0xFFFFFFF0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0x7FFFFFF8),\n\t\t\tBPF_ALU32_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xFFFFFFF0 } },\n\t},\n\t{\n\t\t\"ALU_MUL_X: -1 * -1 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, -1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -1),\n\t\t\tBPF_ALU32_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_X: 2 * 3 = 6\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 3),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 6 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_X: 1 * 2147483647 = 2147483647\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2147483647),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2147483647 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_X: 64x64 multiply, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0fedcba987654321LL),\n\t\t\tBPF_LD_IMM64(R1, 0x123456789abcdef0LL),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xe5618cf0 } }\n\t},\n\t{\n\t\t\"ALU64_MUL_X: 64x64 multiply, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0fedcba987654321LL),\n\t\t\tBPF_LD_IMM64(R1, 0x123456789abcdef0LL),\n\t\t\tBPF_ALU64_REG(BPF_MUL, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x2236d88f } }\n\t},\n\t \n\t{\n\t\t\"ALU_MUL_K: 2 * 3 = 6\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MUL, R0, 3),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 6 } },\n\t},\n\t{\n\t\t\"ALU_MUL_K: 3 * 1 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MUL, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_MUL_K: 2 * 0x7FFFFFF8 = 0xFFFFFFF0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MUL, R0, 0x7FFFFFF8),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xFFFFFFF0 } },\n\t},\n\t{\n\t\t\"ALU_MUL_K: 1 * (-1) = 0x00000000ffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x1),\n\t\t\tBPF_LD_IMM64(R3, 0x00000000ffffffff),\n\t\t\tBPF_ALU32_IMM(BPF_MUL, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 2 * 3 = 6\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 3),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 6 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 3 * 1 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 1 * 2147483647 = 2147483647\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2147483647 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 1 * -2147483647 = -2147483647\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, -2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -2147483647 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 1 * (-1) = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x1),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 64x32 multiply, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 0x12345678),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xe242d208 } }\n\t},\n\t{\n\t\t\"ALU64_MUL_K: 64x32 multiply, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_MUL, R0, 0x12345678),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xc28f5c28 } }\n\t},\n\t \n\t{\n\t\t\"ALU_DIV_X: 6 / 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 6),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_DIV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_DIV_X: 4294967295 / 4294967295 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967295U),\n\t\t\tBPF_ALU32_REG(BPF_DIV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_X: 6 / 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 6),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_DIV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_X: 2147483647 / 2147483647 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483647),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2147483647),\n\t\t\tBPF_ALU64_REG(BPF_DIV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_X: 0xffffffffffffffff / (-1) = 0x0000000000000001\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0xffffffffffffffffLL),\n\t\t\tBPF_LD_IMM64(R4, 0xffffffffffffffffLL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000001LL),\n\t\t\tBPF_ALU64_REG(BPF_DIV, R2, R4),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_DIV_K: 6 / 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 6),\n\t\t\tBPF_ALU32_IMM(BPF_DIV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_DIV_K: 3 / 1 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_DIV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_DIV_K: 4294967295 / 4294967295 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_DIV, R0, 4294967295U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_DIV_K: 0xffffffffffffffff / (-1) = 0x1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0xffffffffffffffffLL),\n\t\t\tBPF_LD_IMM64(R3, 0x1UL),\n\t\t\tBPF_ALU32_IMM(BPF_DIV, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_K: 6 / 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 6),\n\t\t\tBPF_ALU64_IMM(BPF_DIV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_K: 3 / 1 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_DIV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_K: 2147483647 / 2147483647 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483647),\n\t\t\tBPF_ALU64_IMM(BPF_DIV, R0, 2147483647),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_DIV_K: 0xffffffffffffffff / (-1) = 0x0000000000000001\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0xffffffffffffffffLL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000001LL),\n\t\t\tBPF_ALU64_IMM(BPF_DIV, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t \n\t{\n\t\t\"ALU_MOD_X: 3 % 2 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_MOD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_MOD_X: 4294967295 % 4294967293 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4294967293U),\n\t\t\tBPF_ALU32_REG(BPF_MOD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_MOD_X: 3 % 2 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_MOD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_MOD_X: 2147483647 % 2147483645 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483647),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2147483645),\n\t\t\tBPF_ALU64_REG(BPF_MOD, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t \n\t{\n\t\t\"ALU_MOD_K: 3 % 2 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOD, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_MOD_K: 3 % 1 = 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"ALU_MOD_K: 4294967295 % 4294967293 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 4294967295U),\n\t\t\tBPF_ALU32_IMM(BPF_MOD, R0, 4294967293U),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_MOD_K: 3 % 2 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MOD, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_MOD_K: 3 % 1 = 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_MOD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"ALU64_MOD_K: 2147483647 % 2147483645 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2147483647),\n\t\t\tBPF_ALU64_IMM(BPF_MOD, R0, 2147483645),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t \n\t{\n\t\t\"ALU_AND_X: 3 & 2 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_AND, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_AND_X: 0xffffffff & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffff),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU32_REG(BPF_AND, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU64_AND_X: 3 & 2 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_AND, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_AND_X: 0xffffffff & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffff),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU64_REG(BPF_AND, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t \n\t{\n\t\t\"ALU_AND_K: 3 & 2 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_AND, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_AND_K: 0xffffffff & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffff),\n\t\t\tBPF_ALU32_IMM(BPF_AND, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU_AND_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01020304),\n\t\t\tBPF_ALU32_IMM(BPF_AND, R0, 15),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4 } }\n\t},\n\t{\n\t\t\"ALU_AND_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xf1f2f3f4),\n\t\t\tBPF_ALU32_IMM(BPF_AND, R0, 0xafbfcfdf),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xa1b2c3d4 } }\n\t},\n\t{\n\t\t\"ALU_AND_K: Zero extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x0000000080a0c0e0LL),\n\t\t\tBPF_ALU32_IMM(BPF_AND, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_AND_K: 3 & 2 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_AND_K: 0xffffffff & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xffffffff),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU64_AND_K: 0x0000ffffffff0000 & 0x0 = 0x0000000000000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000000LL),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R2, 0x0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_AND_K: 0x0000ffffffff0000 & -1 = 0x0000ffffffff0000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000ffffffff0000LL),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_AND_K: 0xffffffffffffffff & -1 = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0xffffffffffffffffLL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_AND_K: Sign extension 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x00000000090b0d0fLL),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R0, 0x0f0f0f0f),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_AND_K: Sign extension 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x0123456780a0c0e0LL),\n\t\t\tBPF_ALU64_IMM(BPF_AND, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t \n\t{\n\t\t\"ALU_OR_X: 1 | 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU32_REG(BPF_OR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_OR_X: 0x0 | 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU32_REG(BPF_OR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU64_OR_X: 1 | 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 2),\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_OR_X: 0 | 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t \n\t{\n\t\t\"ALU_OR_K: 1 | 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_OR, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_OR_K: 0 & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_ALU32_IMM(BPF_OR, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU_OR_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01020304),\n\t\t\tBPF_ALU32_IMM(BPF_OR, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x01020305 } }\n\t},\n\t{\n\t\t\"ALU_OR_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01020304),\n\t\t\tBPF_ALU32_IMM(BPF_OR, R0, 0xa0b0c0d0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xa1b2c3d4 } }\n\t},\n\t{\n\t\t\"ALU_OR_K: Zero extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x00000000f9fbfdffLL),\n\t\t\tBPF_ALU32_IMM(BPF_OR, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_OR_K: 1 | 2 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: 0 & 0xffffffff = 0xffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: 0x0000ffffffff0000 | 0x0 = 0x0000ffffffff0000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000ffffffff0000LL),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R2, 0x0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: 0x0000ffffffff0000 | -1 = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: 0x000000000000000 | -1 = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000000000LL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_OR_K: Sign extension 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x012345678fafcfefLL),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R0, 0x0f0f0f0f),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_OR_K: Sign extension 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0xfffffffff9fbfdffLL),\n\t\t\tBPF_ALU64_IMM(BPF_OR, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t \n\t{\n\t\t\"ALU_XOR_X: 5 ^ 6 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 5),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 6),\n\t\t\tBPF_ALU32_REG(BPF_XOR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_XOR_X: 0x1 ^ 0xffffffff = 0xfffffffe\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU32_REG(BPF_XOR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } },\n\t},\n\t{\n\t\t\"ALU64_XOR_X: 5 ^ 6 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 5),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 6),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_XOR_X: 1 ^ 0xffffffff = 0xfffffffe\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_ALU64_REG(BPF_XOR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } },\n\t},\n\t \n\t{\n\t\t\"ALU_XOR_K: 5 ^ 6 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 5),\n\t\t\tBPF_ALU32_IMM(BPF_XOR, R0, 6),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU_XOR_K: 1 ^ 0xffffffff = 0xfffffffe\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_XOR, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } },\n\t},\n\t{\n\t\t\"ALU_XOR_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01020304),\n\t\t\tBPF_ALU32_IMM(BPF_XOR, R0, 15),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x0102030b } }\n\t},\n\t{\n\t\t\"ALU_XOR_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xf1f2f3f4),\n\t\t\tBPF_ALU32_IMM(BPF_XOR, R0, 0xafbfcfdf),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x5e4d3c2b } }\n\t},\n\t{\n\t\t\"ALU_XOR_K: Zero extension\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x00000000795b3d1fLL),\n\t\t\tBPF_ALU32_IMM(BPF_XOR, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_XOR_K: 5 ^ 6 = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 5),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R0, 6),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_XOR_K: 1 ^ 0xffffffff = 0xfffffffe\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R0, 0xffffffff),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } },\n\t},\n\t{\n\t\t\"ALU64_XOR_K: 0x0000ffffffff0000 ^ 0x0 = 0x0000ffffffff0000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000ffffffff0000LL),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R2, 0x0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_XOR_K: 0x0000ffffffff0000 ^ -1 = 0xffff00000000ffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000ffffffff0000LL),\n\t\t\tBPF_LD_IMM64(R3, 0xffff00000000ffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_XOR_K: 0x000000000000000 ^ -1 = 0xffffffffffffffff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000000000LL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t},\n\t{\n\t\t\"ALU64_XOR_K: Sign extension 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0x0123456786a4c2e0LL),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R0, 0x0f0f0f0f),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"ALU64_XOR_K: Sign extension 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_LD_IMM64(R1, 0xfedcba98795b3d1fLL),\n\t\t\tBPF_ALU64_IMM(BPF_XOR, R0, 0xf0f0f0f0),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t \n\t{\n\t\t\"ALU_LSH_X: 1 << 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU32_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_LSH_X: 1 << 31 = 0x80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 31),\n\t\t\tBPF_ALU32_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x80000000 } },\n\t},\n\t{\n\t\t\"ALU_LSH_X: 0x12345678 << 12 = 0x45678000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU32_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x45678000 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: 1 << 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_LSH_X: 1 << 31 = 0x80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 31),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x80000000 } },\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xbcdef000 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x3456789a } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x9abcdef0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Zero shift, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t{\n\t\t\"ALU64_LSH_X: Zero shift, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_LSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x01234567 } }\n\t},\n\t \n\t{\n\t\t\"ALU_LSH_K: 1 << 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_LSH, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU_LSH_K: 1 << 31 = 0x80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_LSH, R0, 31),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x80000000 } },\n\t},\n\t{\n\t\t\"ALU_LSH_K: 0x12345678 << 12 = 0x45678000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_LSH, R0, 12),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x45678000 } }\n\t},\n\t{\n\t\t\"ALU_LSH_K: 0x12345678 << 0 = 0x12345678\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_LSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x12345678 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: 1 << 1 = 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"ALU64_LSH_K: 1 << 31 = 0x80000000\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 31),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x80000000 } },\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 12),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xbcdef000 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 12),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x3456789a } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 36),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 36),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x9abcdef0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 32),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t{\n\t\t\"ALU64_LSH_K: Zero shift\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_LSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t \n\t{\n\t\t\"ALU_RSH_X: 2 >> 1 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU32_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_RSH_X: 0x80000000 >> 31 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x80000000),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 31),\n\t\t\tBPF_ALU32_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_RSH_X: 0x12345678 >> 20 = 0x123\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 20),\n\t\t\tBPF_ALU32_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x123 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: 2 >> 1 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_RSH_X: 0x80000000 >> 31 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x80000000),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 31),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x56789abc } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x00081234 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x08123456 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Zero shift, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t{\n\t\t\"ALU64_RSH_X: Zero shift, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_RSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t \n\t{\n\t\t\"ALU_RSH_K: 2 >> 1 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_RSH, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_RSH_K: 0x80000000 >> 31 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x80000000),\n\t\t\tBPF_ALU32_IMM(BPF_RSH, R0, 31),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU_RSH_K: 0x12345678 >> 20 = 0x123\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_RSH, R0, 20),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x123 } }\n\t},\n\t{\n\t\t\"ALU_RSH_K: 0x12345678 >> 0 = 0x12345678\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x12345678),\n\t\t\tBPF_ALU32_IMM(BPF_RSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x12345678 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: 2 >> 1 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_RSH_K: 0x80000000 >> 31 = 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x80000000),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 31),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 12),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x56789abc } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 12),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x00081234 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 36),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x08123456 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 36),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } }\n\t},\n\t{\n\t\t\"ALU64_RSH_K: Zero shift\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t \n\t{\n\t\t\"ALU32_ARSH_X: -1234 >> 7 = -10\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1234),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 7),\n\t\t\tBPF_ALU32_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -10 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: 0xff00ff0000000000 >> 40 = 0xffffffffffff00ff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xff00ff0000000000LL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 40),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffff00ff } },\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x56789abc } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 12),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfff81234 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xf8123456 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 36),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Zero shift, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: Zero shift, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0),\n\t\t\tBPF_ALU64_REG(BPF_ARSH, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t \n\t{\n\t\t\"ALU32_ARSH_K: -1234 >> 7 = -10\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1234),\n\t\t\tBPF_ALU32_IMM(BPF_ARSH, R0, 7),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -10 } }\n\t},\n\t{\n\t\t\"ALU32_ARSH_K: -1234 >> 0 = -1234\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1234),\n\t\t\tBPF_ALU32_IMM(BPF_ARSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1234 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: 0xff00ff0000000000 >> 40 = 0xffffffffffff00ff\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xff00ff0000000000LL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffff00ff } },\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift < 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 12),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x56789abc } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift < 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 12),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfff81234 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift > 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 36),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xf8123456 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift > 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xf123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 36),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift == 32, low word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x81234567 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Shift == 32, high word\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 32),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -1 } }\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: Zero shift\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x8123456789abcdefLL),\n\t\t\tBPF_ALU64_IMM(BPF_ARSH, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } }\n\t},\n\t \n\t{\n\t\t\"ALU_NEG: -(3) = -3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_NEG, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -3 } },\n\t},\n\t{\n\t\t\"ALU_NEG: -(-3) = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -3),\n\t\t\tBPF_ALU32_IMM(BPF_NEG, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t{\n\t\t\"ALU64_NEG: -(3) = -3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 3),\n\t\t\tBPF_ALU64_IMM(BPF_NEG, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -3 } },\n\t},\n\t{\n\t\t\"ALU64_NEG: -(-3) = 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, -3),\n\t\t\tBPF_ALU64_IMM(BPF_NEG, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 3 } },\n\t},\n\t \n\t{\n\t\t\"ALU_END_FROM_BE 16: 0x0123456789abcdef -> 0xcdef\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 16),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0,  cpu_to_be16(0xcdef) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 32: 0x0123456789abcdef -> 0x89abcdef\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 32),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, cpu_to_be32(0x89abcdef) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 64: 0x0123456789abcdef -> 0x89abcdef\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 64),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) cpu_to_be64(0x0123456789abcdefLL) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 64: 0x0123456789abcdef >> 32 -> 0x01234567\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 64),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) (cpu_to_be64(0x0123456789abcdefLL) >> 32) } },\n\t},\n\t \n\t{\n\t\t\"ALU_END_FROM_BE 16: 0xfedcba9876543210 -> 0x3210\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 16),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0,  cpu_to_be16(0x3210) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 32: 0xfedcba9876543210 -> 0x76543210\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 32),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, cpu_to_be32(0x76543210) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 64: 0xfedcba9876543210 -> 0x76543210\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 64),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) cpu_to_be64(0xfedcba9876543210ULL) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_BE 64: 0xfedcba9876543210 >> 32 -> 0xfedcba98\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_BE, R0, 64),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) (cpu_to_be64(0xfedcba9876543210ULL) >> 32) } },\n\t},\n\t \n\t{\n\t\t\"ALU_END_FROM_LE 16: 0x0123456789abcdef -> 0xefcd\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 16),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, cpu_to_le16(0xcdef) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 32: 0x0123456789abcdef -> 0xefcdab89\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 32),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, cpu_to_le32(0x89abcdef) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 64: 0x0123456789abcdef -> 0x67452301\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 64),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) cpu_to_le64(0x0123456789abcdefLL) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 64: 0x0123456789abcdef >> 32 -> 0xefcdab89\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789abcdefLL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 64),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) (cpu_to_le64(0x0123456789abcdefLL) >> 32) } },\n\t},\n\t \n\t{\n\t\t\"ALU_END_FROM_LE 16: 0xfedcba9876543210 -> 0x1032\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 16),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0,  cpu_to_le16(0x3210) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 32: 0xfedcba9876543210 -> 0x10325476\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 32),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_ALU32_REG(BPF_ADD, R0, R1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, cpu_to_le32(0x76543210) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 64: 0xfedcba9876543210 -> 0x10325476\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 64),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) cpu_to_le64(0xfedcba9876543210ULL) } },\n\t},\n\t{\n\t\t\"ALU_END_FROM_LE 64: 0xfedcba9876543210 >> 32 -> 0x98badcfe\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_ENDIAN(BPF_FROM_LE, R0, 64),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R0, 32),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, (u32) (cpu_to_le64(0xfedcba9876543210ULL) >> 32) } },\n\t},\n\t \n\t{\n\t\t\"BPF_LDX_MEM | BPF_B, base\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000000008ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -1),\n#else\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_B, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000000088ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -1),\n#else\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_B, negative offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000088ULL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 512),\n\t\t\tBPF_STX_MEM(BPF_B, R1, R2, -256),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R1, -256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_B, small positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000088ULL),\n\t\t\tBPF_STX_MEM(BPF_B, R1, R2, 256),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R1, 256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_B, large positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000000088ULL),\n\t\t\tBPF_STX_MEM(BPF_B, R1, R2, 4096),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R1, 4096),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 4096 + 16, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, base\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000000708ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -2),\n#else\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000000008788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -2),\n#else\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, negative offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000008788ULL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 512),\n\t\t\tBPF_STX_MEM(BPF_H, R1, R2, -256),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R1, -256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, small positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000008788ULL),\n\t\t\tBPF_STX_MEM(BPF_H, R1, R2, 256),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R1, 256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, large positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000008788ULL),\n\t\t\tBPF_STX_MEM(BPF_H, R1, R2, 8192),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R1, 8192),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 8192 + 16, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_H, unaligned positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000000008788ULL),\n\t\t\tBPF_STX_MEM(BPF_H, R1, R2, 13),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R1, 13),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 32, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, base\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000005060708ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -4),\n#else\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0000000085868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -4),\n#else\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -8),\n#endif\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, negative offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000085868788ULL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 512),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, -256),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R1, -256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, small positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000085868788ULL),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 256),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R1, 256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, large positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000085868788ULL),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 16384),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R1, 16384),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 16384 + 16, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_W, unaligned positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x0000000085868788ULL),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 13),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R1, 13),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 32, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, base\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0102030405060708ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8182838485868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, negative offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 512),\n\t\t\tBPF_STX_MEM(BPF_DW, R1, R2, -256),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R1, -256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, small positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R1, R2, 256),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R1, 256),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 512, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, large positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R1, R2, 32760),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R1, 32760),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 32768, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t{\n\t\t\"BPF_LDX_MEM | BPF_DW, unaligned positive offset\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R1, R2, 13),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R1, 13),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_LARGE_MEM,\n\t\t{ },\n\t\t{ { 32, 0 } },\n\t\t.stack_depth = 0,\n\t},\n\t \n\t{\n\t\t\"BPF_STX_MEM | BPF_B\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b0c0d0e008ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_B, R10, R2, -1),\n#else\n\t\t\tBPF_STX_MEM(BPF_B, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_STX_MEM | BPF_B, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b0c0d0e088ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_B, R10, R2, -1),\n#else\n\t\t\tBPF_STX_MEM(BPF_B, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_STX_MEM | BPF_H\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b0c0d00708ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_H, R10, R2, -2),\n#else\n\t\t\tBPF_STX_MEM(BPF_H, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_STX_MEM | BPF_H, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b0c0d08788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_H, R10, R2, -2),\n#else\n\t\t\tBPF_STX_MEM(BPF_H, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_STX_MEM | BPF_W\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x0102030405060708ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b005060708ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_W, R10, R2, -4),\n#else\n\t\t\tBPF_STX_MEM(BPF_W, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"BPF_STX_MEM | BPF_W, MSB set\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x8090a0b0c0d0e0f0ULL),\n\t\t\tBPF_LD_IMM64(R2, 0x8182838485868788ULL),\n\t\t\tBPF_LD_IMM64(R3, 0x8090a0b085868788ULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n#ifdef __BIG_ENDIAN\n\t\t\tBPF_STX_MEM(BPF_W, R10, R2, -4),\n#else\n\t\t\tBPF_STX_MEM(BPF_W, R10, R2, -8),\n#endif\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R3, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t \n\t{\n\t\t\"ST_MEM_B: Store/Load byte: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_B, R10, -40, 0xff),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_B: Store/Load byte: max positive\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_H, R10, -40, 0x7f),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x7f } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_B: Store/Load byte: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffLL),\n\t\t\tBPF_STX_MEM(BPF_B, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_H: Store/Load half word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_H, R10, -40, 0xffff),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_H: Store/Load half word: max positive\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_H, R10, -40, 0x7fff),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x7fff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_H: Store/Load half word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffLL),\n\t\t\tBPF_STX_MEM(BPF_H, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_W: Store/Load word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0xffffffff),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_W: Store/Load word: max positive\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x7fffffff),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x7fffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_W: Store/Load word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffLL),\n\t\t\tBPF_STX_MEM(BPF_W, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_DW: Store/Load double word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_DW, R10, -40, 0xffffffff),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_DW: Store/Load double word: max negative 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R2, 0xffff00000000ffffLL),\n\t\t\tBPF_LD_IMM64(R3, 0xffffffffffffffffLL),\n\t\t\tBPF_ST_MEM(BPF_DW, R10, -40, 0xffffffff),\n\t\t\tBPF_LDX_MEM(BPF_DW, R2, R10, -40),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R2, R3, 2),\n\t\t\tBPF_MOV32_IMM(R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_MOV32_IMM(R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x1 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"ST_MEM_DW: Store/Load double word: max positive\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_ST_MEM(BPF_DW, R10, -40, 0x7fffffff),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x7fffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_DW: Store/Load double word: max negative\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_DW: Store double word: first word in memory\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefLL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n#ifdef __BIG_ENDIAN\n\t\t{ { 0, 0x01234567 } },\n#else\n\t\t{ { 0, 0x89abcdef } },\n#endif\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"STX_MEM_DW: Store double word: second word in memory\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefLL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -36),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n#ifdef __BIG_ENDIAN\n\t\t{ { 0, 0x89abcdef } },\n#else\n\t\t{ { 0, 0x01234567 } },\n#endif\n\t\t.stack_depth = 40,\n\t},\n\t \n\t{\n\t\t\"STX_XADD_W: X + 1 + 1 + 1 + ...\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4134 } },\n\t\t.fill_helper = bpf_fill_stxw,\n\t},\n\t{\n\t\t\"STX_XADD_DW: X + 1 + 1 + 1 + ...\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 4134 } },\n\t\t.fill_helper = bpf_fill_stxdw,\n\t},\n\t \n#define BPF_ATOMIC_POISON(width) ((width) == BPF_W ? (0xbaadf00dULL << 32) : 0)\n\n#define BPF_ATOMIC_OP_TEST1(width, op, logic, old, update, result)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t\"BPF_ATOMIC | \" #width \", \" #op \": Test: \"\t\t\t\\\n\t\t#old \" \" #logic \" \" #update \" = \" #result,\t\t\\\n\t.u.insns_int = {\t\t\t\t\t\t\\\n\t\tBPF_LD_IMM64(R5, (update) | BPF_ATOMIC_POISON(width)),\t\\\n\t\tBPF_ST_MEM(width, R10, -40, old),\t\t\t\\\n\t\tBPF_ATOMIC_OP(width, op, R10, R5, -40),\t\t\t\\\n\t\tBPF_LDX_MEM(width, R0, R10, -40),\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\t\t\\\n\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\t\t\\\n\t\tBPF_EXIT_INSN(),\t\t\t\t\t\\\n\t},\t\t\t\t\t\t\t\t\\\n\tINTERNAL,\t\t\t\t\t\t\t\\\n\t{ },\t\t\t\t\t\t\t\t\\\n\t{ { 0, result } },\t\t\t\t\t\t\\\n\t.stack_depth = 40,\t\t\t\t\t\t\\\n}\n#define BPF_ATOMIC_OP_TEST2(width, op, logic, old, update, result)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t\"BPF_ATOMIC | \" #width \", \" #op \": Test side effects, r10: \"\t\\\n\t\t#old \" \" #logic \" \" #update \" = \" #result,\t\t\\\n\t.u.insns_int = {\t\t\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R1, R10),\t\t\t\\\n\t\tBPF_LD_IMM64(R0, (update) | BPF_ATOMIC_POISON(width)),\t\\\n\t\tBPF_ST_MEM(BPF_W, R10, -40, old),\t\t\t\\\n\t\tBPF_ATOMIC_OP(width, op, R10, R0, -40),\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R0, R10),\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\t\t\\\n\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\t\t\\\n\t\tBPF_EXIT_INSN(),\t\t\t\t\t\\\n\t},\t\t\t\t\t\t\t\t\\\n\tINTERNAL,\t\t\t\t\t\t\t\\\n\t{ },\t\t\t\t\t\t\t\t\\\n\t{ { 0, 0 } },\t\t\t\t\t\t\t\\\n\t.stack_depth = 40,\t\t\t\t\t\t\\\n}\n#define BPF_ATOMIC_OP_TEST3(width, op, logic, old, update, result)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t\"BPF_ATOMIC | \" #width \", \" #op \": Test side effects, r0: \"\t\\\n\t\t#old \" \" #logic \" \" #update \" = \" #result,\t\t\\\n\t.u.insns_int = {\t\t\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R0, R10),\t\t\t\\\n\t\tBPF_LD_IMM64(R1, (update) | BPF_ATOMIC_POISON(width)),\t\\\n\t\tBPF_ST_MEM(width, R10, -40, old),\t\t\t\\\n\t\tBPF_ATOMIC_OP(width, op, R10, R1, -40),\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_SUB, R0, R10),\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\t\t\\\n\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\t\t\\\n\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\t\t\\\n\t\tBPF_EXIT_INSN(),\t\t\t\t\t\\\n\t},\t\t\t\t\t\t\t\t\\\n\tINTERNAL,                                                       \\\n\t{ },                                                            \\\n\t{ { 0, 0 } },                                                   \\\n\t.stack_depth = 40,                                              \\\n}\n#define BPF_ATOMIC_OP_TEST4(width, op, logic, old, update, result)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t\"BPF_ATOMIC | \" #width \", \" #op \": Test fetch: \"\t\t\\\n\t\t#old \" \" #logic \" \" #update \" = \" #result,\t\t\\\n\t.u.insns_int = {\t\t\t\t\t\t\\\n\t\tBPF_LD_IMM64(R3, (update) | BPF_ATOMIC_POISON(width)),\t\\\n\t\tBPF_ST_MEM(width, R10, -40, old),\t\t\t\\\n\t\tBPF_ATOMIC_OP(width, op, R10, R3, -40),\t\t\t\\\n\t\tBPF_ALU32_REG(BPF_MOV, R0, R3),                         \\\n\t\tBPF_EXIT_INSN(),\t\t\t\t\t\\\n\t},\t\t\t\t\t\t\t\t\\\n\tINTERNAL,                                                       \\\n\t{ },                                                            \\\n\t{ { 0, (op) & BPF_FETCH ? old : update } },\t\t\t\\\n\t.stack_depth = 40,                                              \\\n}\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_ADD, +, 0x12, 0xab, 0xbd),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_ADD | BPF_FETCH, +, 0x12, 0xab, 0xbd),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_AND, &, 0x12, 0xab, 0x02),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_AND, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_AND, &, 0x12, 0xab, 0x02),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_AND | BPF_FETCH, &, 0x12, 0xab, 0x02),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_OR, |, 0x12, 0xab, 0xbb),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_OR, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_OR, |, 0x12, 0xab, 0xbb),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_OR | BPF_FETCH, |, 0x12, 0xab, 0xbb),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_XOR, ^, 0x12, 0xab, 0xb9),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_XOR | BPF_FETCH, ^, 0x12, 0xab, 0xb9),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_W, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST2(BPF_W, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST3(BPF_W, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST4(BPF_W, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\t \n\tBPF_ATOMIC_OP_TEST1(BPF_DW, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST2(BPF_DW, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST3(BPF_DW, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n\tBPF_ATOMIC_OP_TEST4(BPF_DW, BPF_XCHG, xchg, 0x12, 0xab, 0xab),\n#undef BPF_ATOMIC_POISON\n#undef BPF_ATOMIC_OP_TEST1\n#undef BPF_ATOMIC_OP_TEST2\n#undef BPF_ATOMIC_OP_TEST3\n#undef BPF_ATOMIC_OP_TEST4\n\t \n\t{\n\t\t\"BPF_ATOMIC | BPF_W, BPF_CMPXCHG: Test successful return\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0x89abcdef),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x01234567 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_W, BPF_CMPXCHG: Test successful store\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0x89abcdef),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_W, BPF_CMPXCHG: Test failure return\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x76543210),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0x89abcdef),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x01234567 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_W, BPF_CMPXCHG: Test failure store\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x76543210),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0x89abcdef),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R10, -40),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x01234567 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_W, BPF_CMPXCHG: Test side effects\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -40, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x01234567),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0x89abcdef),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R3, -40),\n\t\t\tBPF_ALU32_REG(BPF_MOV, R0, R3),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x89abcdef } },\n\t\t.stack_depth = 40,\n\t},\n\t \n\t{\n\t\t\"BPF_ATOMIC | BPF_DW, BPF_CMPXCHG: Test successful return\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefULL),\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -40),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_DW, BPF_CMPXCHG: Test successful store\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefULL),\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R0, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -40),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -40),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_DW, BPF_CMPXCHG: Test failure return\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefULL),\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -40),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_DW, BPF_CMPXCHG: Test failure store\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefULL),\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -40),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R10, -40),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 40,\n\t},\n\t{\n\t\t\"BPF_ATOMIC | BPF_DW, BPF_CMPXCHG: Test side effects\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789abcdefULL),\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -40),\n\t\t\tBPF_ATOMIC_OP(BPF_DW, BPF_CMPXCHG, R10, R2, -40),\n\t\t\tBPF_LD_IMM64(R0, 0xfedcba9876543210ULL),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 40,\n\t},\n\t \n\t{\n\t\t\"JMP32_JEQ_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0, 321, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0, 123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JEQ_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0, 12345678 & 0xffff, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0, 12345678, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 12345678 } }\n\t},\n\t{\n\t\t\"JMP32_JEQ_K: negative immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0,  123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JEQ, R0, -123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JEQ_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1234),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4321),\n\t\t\tBPF_JMP32_REG(BPF_JEQ, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1234),\n\t\t\tBPF_JMP32_REG(BPF_JEQ, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1234 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JNE_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0, 123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0, 321, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JNE_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0, 12345678, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0, 12345678 & 0xffff, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 12345678 } }\n\t},\n\t{\n\t\t\"JMP32_JNE_K: negative immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0, -123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JNE, R0,  123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JNE_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1234),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 1234),\n\t\t\tBPF_JMP32_REG(BPF_JNE, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 4321),\n\t\t\tBPF_JMP32_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1234 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSET_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSET, R0, 2, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSET, R0, 3, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } }\n\t},\n\t{\n\t\t\"JMP32_JSET_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x40000000),\n\t\t\tBPF_JMP32_IMM(BPF_JSET, R0, 0x3fffffff, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSET, R0, 0x60000000, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x40000000 } }\n\t},\n\t{\n\t\t\"JMP32_JSET_K: negative immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JSET, R0, -1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSET_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 8),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 7),\n\t\t\tBPF_JMP32_REG(BPF_JSET, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 8 | 2),\n\t\t\tBPF_JMP32_REG(BPF_JNE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 8 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JGT_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JGT, R0, 123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JGT, R0, 122, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JGT_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_JMP32_IMM(BPF_JGT, R0, 0xffffffff, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JGT, R0, 0xfffffffd, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JGT_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_JMP32_REG(BPF_JGT, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfffffffd),\n\t\t\tBPF_JMP32_REG(BPF_JGT, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JGE_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JGE, R0, 124, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JGE, R0, 123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JGE_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_JMP32_IMM(BPF_JGE, R0, 0xffffffff, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JGE, R0, 0xfffffffe, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JGE_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_JMP32_REG(BPF_JGE, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfffffffe),\n\t\t\tBPF_JMP32_REG(BPF_JGE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JLT_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JLT, R0, 123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JLT, R0, 124, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JLT_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_JMP32_IMM(BPF_JLT, R0, 0xfffffffd, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JLT, R0, 0xffffffff, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JLT_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfffffffd),\n\t\t\tBPF_JMP32_REG(BPF_JLT, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xffffffff),\n\t\t\tBPF_JMP32_REG(BPF_JLT, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JLE_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 123),\n\t\t\tBPF_JMP32_IMM(BPF_JLE, R0, 122, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JLE, R0, 123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } }\n\t},\n\t{\n\t\t\"JMP32_JLE_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_JMP32_IMM(BPF_JLE, R0, 0xfffffffd, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JLE, R0, 0xfffffffe, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JLE_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0xfffffffe),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfffffffd),\n\t\t\tBPF_JMP32_REG(BPF_JLE, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfffffffe),\n\t\t\tBPF_JMP32_REG(BPF_JLE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xfffffffe } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSGT_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JSGT, R0, -123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGT, R0, -124, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"JMP32_JSGT_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JSGT, R0, -12345678, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGT, R0, -12345679, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSGT_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345678),\n\t\t\tBPF_JMP32_REG(BPF_JSGT, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345679),\n\t\t\tBPF_JMP32_REG(BPF_JSGT, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSGE_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JSGE, R0, -122, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGE, R0, -123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"JMP32_JSGE_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JSGE, R0, -12345677, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGE, R0, -12345678, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSGE_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345677),\n\t\t\tBPF_JMP32_REG(BPF_JSGE, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345678),\n\t\t\tBPF_JMP32_REG(BPF_JSGE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSLT_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JSLT, R0, -123, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLT, R0, -122, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"JMP32_JSLT_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JSLT, R0, -12345678, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLT, R0, -12345677, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSLT_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345678),\n\t\t\tBPF_JMP32_REG(BPF_JSLT, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345677),\n\t\t\tBPF_JMP32_REG(BPF_JSLT, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSLE_K: Small immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -123),\n\t\t\tBPF_JMP32_IMM(BPF_JSLE, R0, -124, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLE, R0, -123, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -123 } }\n\t},\n\t{\n\t\t\"JMP32_JSLE_K: Large immediate\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_JMP32_IMM(BPF_JSLE, R0, -12345679, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLE, R0, -12345678, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP32_JSLE_X\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -12345678),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345679),\n\t\t\tBPF_JMP32_REG(BPF_JSLE, R0, R1, 2),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, -12345678),\n\t\t\tBPF_JMP32_REG(BPF_JSLE, R0, R1, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, -12345678 } }\n\t},\n\t \n\t{\n\t\t\"JMP_EXIT\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x4711),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0x4712),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0x4711 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JA: Unconditional jump: if (true) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JA, 0, 0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSLT_K: Signed jump: if (-2 < -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xfffffffffffffffeLL),\n\t\t\tBPF_JMP_IMM(BPF_JSLT, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLT_K: Signed jump: if (-1 < -1) return 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSLT, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSGT_K: Signed jump: if (-1 > -2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSGT, R1, -2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGT_K: Signed jump: if (-1 > -1) return 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSGT, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSLE_K: Signed jump: if (-2 <= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xfffffffffffffffeLL),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLE_K: Signed jump: if (-1 <= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLE_K: Signed jump: value walk 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 6),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 4),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 1),\n\t\t\tBPF_EXIT_INSN(),\t\t \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\t \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLE_K: Signed jump: value walk 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 4),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_SUB, R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JSLE, R1, 0, 1),\n\t\t\tBPF_EXIT_INSN(),\t\t \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\t \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSGE_K: Signed jump: if (-1 >= -2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, -2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGE_K: Signed jump: if (-1 >= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 0xffffffffffffffffLL),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGE_K: Signed jump: value walk 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -3),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 6),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 4),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 1),\n\t\t\tBPF_EXIT_INSN(),\t\t \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\t \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGE_K: Signed jump: value walk 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -3),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 4),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 2),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JSGE, R1, 0, 1),\n\t\t\tBPF_EXIT_INSN(),\t\t \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\t \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGT_K: if (3 > 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JGT, R1, 2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGT_K: Unsigned jump: if (-1 > 1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_JMP_IMM(BPF_JGT, R1, 1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JLT_K: if (2 < 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JLT, R1, 3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGT_K: Unsigned jump: if (1 < -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 1),\n\t\t\tBPF_JMP_IMM(BPF_JLT, R1, -1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGE_K: if (3 >= 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JGE, R1, 2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JLE_K: if (2 <= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 2),\n\t\t\tBPF_JMP_IMM(BPF_JLE, R1, 3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGT_K: if (3 > 2) return 1 (jump backwards)\",\n\t\t.u.insns_int = {\n\t\t\tBPF_JMP_IMM(BPF_JA, 0, 0, 2),  \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),  \n\t\t\tBPF_LD_IMM64(R1, 3),  \n\t\t\tBPF_JMP_IMM(BPF_JGT, R1, 2, -6),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGE_K: if (3 >= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JGE, R1, 3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGT_K: if (2 < 3) return 1 (jump backwards)\",\n\t\t.u.insns_int = {\n\t\t\tBPF_JMP_IMM(BPF_JA, 0, 0, 2),  \n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),  \n\t\t\tBPF_LD_IMM64(R1, 2),  \n\t\t\tBPF_JMP_IMM(BPF_JLT, R1, 3, -6),  \n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JLE_K: if (3 <= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JLE, R1, 3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JNE_K: if (3 != 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, 2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JEQ_K: if (3 == 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R1, 3, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSET_K: if (0x3 & 0x2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JSET, R1, 2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSET_K: if (0x3 & 0xffffffff) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_JMP_IMM(BPF_JSET, R1, 0xffffffff, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSGT_X: Signed jump: if (-1 > -2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -2),\n\t\t\tBPF_JMP_REG(BPF_JSGT, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGT_X: Signed jump: if (-1 > -1) return 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -1),\n\t\t\tBPF_JMP_REG(BPF_JSGT, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSLT_X: Signed jump: if (-2 < -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -2),\n\t\t\tBPF_JMP_REG(BPF_JSLT, R2, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLT_X: Signed jump: if (-1 < -1) return 0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -1),\n\t\t\tBPF_JMP_REG(BPF_JSLT, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSGE_X: Signed jump: if (-1 >= -2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -2),\n\t\t\tBPF_JMP_REG(BPF_JSGE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGE_X: Signed jump: if (-1 >= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -1),\n\t\t\tBPF_JMP_REG(BPF_JSGE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSLE_X: Signed jump: if (-2 <= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -2),\n\t\t\tBPF_JMP_REG(BPF_JSLE, R2, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLE_X: Signed jump: if (-1 <= -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, -1),\n\t\t\tBPF_JMP_REG(BPF_JSLE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGT_X: if (3 > 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JGT, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGT_X: Unsigned jump: if (-1 > 1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, 1),\n\t\t\tBPF_JMP_REG(BPF_JGT, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JLT_X: if (2 < 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JLT, R2, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JLT_X: Unsigned jump: if (1 < -1) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, -1),\n\t\t\tBPF_LD_IMM64(R2, 1),\n\t\t\tBPF_JMP_REG(BPF_JLT, R2, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JGE_X: if (3 >= 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGE_X: if (3 >= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 3),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JLE_X: if (2 <= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JLE, R2, R1, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JLE_X: if (3 <= 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 3),\n\t\t\tBPF_JMP_REG(BPF_JLE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t \n\t\t\"JMP_JGE_X: ldimm64 test 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R2, 2),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_LD_IMM64(R0, 0xeeeeeeeeeeeeeeeeULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xeeeeeeeeU } },\n\t},\n\t{\n\t\t\"JMP_JGE_X: ldimm64 test 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R2, 0),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffffU } },\n\t},\n\t{\n\t\t\"JMP_JGE_X: ldimm64 test 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R2, 4),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_LD_IMM64(R0, 0xeeeeeeeeeeeeeeeeULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JLE_X: ldimm64 test 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JLE, R2, R1, 2),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_LD_IMM64(R0, 0xeeeeeeeeeeeeeeeeULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xeeeeeeeeU } },\n\t},\n\t{\n\t\t\"JMP_JLE_X: ldimm64 test 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JLE, R2, R1, 0),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0xffffffffU } },\n\t},\n\t{\n\t\t\"JMP_JLE_X: ldimm64 test 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JLE, R2, R1, 4),\n\t\t\tBPF_LD_IMM64(R0, 0xffffffffffffffffULL),\n\t\t\tBPF_LD_IMM64(R0, 0xeeeeeeeeeeeeeeeeULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JNE_X: if (3 != 2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JNE, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JEQ_X: if (3 == 3) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 3),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t \n\t{\n\t\t\"JMP_JSET_X: if (0x3 & 0x2) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 2),\n\t\t\tBPF_JMP_REG(BPF_JSET, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSET_X: if (0x3 & 0xffffffff) return 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_LD_IMM64(R1, 3),\n\t\t\tBPF_LD_IMM64(R2, 0xffffffff),\n\t\t\tBPF_JMP_REG(BPF_JSET, R1, R2, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JA: Jump, gap, jump, ...\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xababcbac } },\n\t\t.fill_helper = bpf_fill_ja,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Maximum possible literals\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.fill_helper = bpf_fill_maxinsns1,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Single literal\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xfefefefe } },\n\t\t.fill_helper = bpf_fill_maxinsns2,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Run/add until end\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0x947bf368 } },\n\t\t.fill_helper = bpf_fill_maxinsns3,\n\t},\n\t{\n\t\t\"BPF_MAXINSNS: Too many instructions\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA | FLAG_EXPECTED_FAIL,\n\t\t{ },\n\t\t{ },\n\t\t.fill_helper = bpf_fill_maxinsns4,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Very long jump\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xabababab } },\n\t\t.fill_helper = bpf_fill_maxinsns5,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Ctx heavy transformations\",\n\t\t{ },\n\t\tCLASSIC,\n\t\t{ },\n\t\t{\n\t\t\t{  1, SKB_VLAN_PRESENT },\n\t\t\t{ 10, SKB_VLAN_PRESENT }\n\t\t},\n\t\t.fill_helper = bpf_fill_maxinsns6,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Call heavy transformations\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 1, 0 }, { 10, 0 } },\n\t\t.fill_helper = bpf_fill_maxinsns7,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Jump heavy test\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xffffffff } },\n\t\t.fill_helper = bpf_fill_maxinsns8,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Very long jump backwards\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xcbababab } },\n\t\t.fill_helper = bpf_fill_maxinsns9,\n\t},\n\t{\t \n\t\t\"BPF_MAXINSNS: Edge hopping nuthouse\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xabababac } },\n\t\t.fill_helper = bpf_fill_maxinsns10,\n\t},\n\t{\n\t\t\"BPF_MAXINSNS: Jump, gap, jump, ...\",\n\t\t{ },\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0xababcbac } },\n\t\t.fill_helper = bpf_fill_maxinsns11,\n\t},\n\t{\n\t\t\"BPF_MAXINSNS: jump over MSH\",\n\t\t{ },\n\t\tCLASSIC | FLAG_EXPECTED_FAIL,\n\t\t{ 0xfa, 0xfb, 0xfc, 0xfd, },\n\t\t{ { 4, 0xabababab } },\n\t\t.fill_helper = bpf_fill_maxinsns12,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"BPF_MAXINSNS: exec all MSH\",\n\t\t{ },\n\t\tCLASSIC,\n\t\t{ 0xfa, 0xfb, 0xfc, 0xfd, },\n\t\t{ { 4, 0xababab83 } },\n\t\t.fill_helper = bpf_fill_maxinsns13,\n\t},\n\t{\n\t\t\"BPF_MAXINSNS: ld_abs+get_processor_id\",\n\t\t{ },\n\t\tCLASSIC,\n\t\t{ },\n\t\t{ { 1, 0xbee } },\n\t\t.fill_helper = bpf_fill_ld_abs_get_processor_id,\n\t},\n\t \n\t{\n\t\t\"LD_IND byte frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x40),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, 0x0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x42} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_IND halfword frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x40),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, 0x4),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x4344} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_IND word frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x40),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, 0x8),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x21071983} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_IND halfword mixed head/frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x40),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, -0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ [0x3e] = 0x25, [0x3f] = 0x05, },\n\t\t{ {0x40, 0x0519} },\n\t\t.frag_data = { 0x19, 0x82 },\n\t},\n\t{\n\t\t\"LD_IND word mixed head/frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x40),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x2),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ [0x3e] = 0x25, [0x3f] = 0x05, },\n\t\t{ {0x40, 0x25051982} },\n\t\t.frag_data = { 0x19, 0x82 },\n\t},\n\t{\n\t\t\"LD_ABS byte frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, 0x40),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x42} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_ABS halfword frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x44),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x4344} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_ABS word frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x48),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ },\n\t\t{ {0x40, 0x21071983} },\n\t\t.frag_data = {\n\t\t\t0x42, 0x00, 0x00, 0x00,\n\t\t\t0x43, 0x44, 0x00, 0x00,\n\t\t\t0x21, 0x07, 0x19, 0x83,\n\t\t},\n\t},\n\t{\n\t\t\"LD_ABS halfword mixed head/frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ [0x3e] = 0x25, [0x3f] = 0x05, },\n\t\t{ {0x40, 0x0519} },\n\t\t.frag_data = { 0x19, 0x82 },\n\t},\n\t{\n\t\t\"LD_ABS word mixed head/frag\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x3e),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_SKB_FRAG,\n\t\t{ [0x3e] = 0x25, [0x3f] = 0x05, },\n\t\t{ {0x40, 0x25051982} },\n\t\t.frag_data = { 0x19, 0x82 },\n\t},\n\t \n\t{\n\t\t \n\t\t\"LD_IND byte default X\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x1] = 0x42 },\n\t\t{ {0x40, 0x42 } },\n\t},\n\t{\n\t\t\"LD_IND byte positive offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x82 } },\n\t},\n\t{\n\t\t\"LD_IND byte negative offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, -0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x05 } },\n\t},\n\t{\n\t\t\"LD_IND byte positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xff } },\n\t},\n\t{\n\t\t\"LD_IND byte positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_IND byte negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, -0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 } },\n\t},\n\t{\n\t\t\"LD_IND byte negative offset, multiple calls\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3b),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, SKF_LL_OFF + 1),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, SKF_LL_OFF + 2),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, SKF_LL_OFF + 3),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_B, SKF_LL_OFF + 4),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x82 }, },\n\t},\n\t{\n\t\t\"LD_IND halfword positive offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, 0x2),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t},\n\t\t{ {0x40, 0xdd88 } },\n\t},\n\t{\n\t\t\"LD_IND halfword negative offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, -0x2),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t},\n\t\t{ {0x40, 0xbb66 } },\n\t},\n\t{\n\t\t\"LD_IND halfword unaligned\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, -0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t},\n\t\t{ {0x40, 0x66cc } },\n\t},\n\t{\n\t\t\"LD_IND halfword positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3d),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xffff } },\n\t},\n\t{\n\t\t\"LD_IND halfword positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_IND halfword negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_H, -0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 } },\n\t},\n\t{\n\t\t\"LD_IND word positive offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, 0x4),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xee99ffaa } },\n\t},\n\t{\n\t\t\"LD_IND word negative offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x4),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xaa55bb66 } },\n\t},\n\t{\n\t\t\"LD_IND word unaligned (addr & 3 == 2)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x2),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xbb66cc77 } },\n\t},\n\t{\n\t\t\"LD_IND word unaligned (addr & 3 == 1)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x3),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0x55bb66cc } },\n\t},\n\t{\n\t\t\"LD_IND word unaligned (addr & 3 == 3)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x20),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0x66cc77dd } },\n\t},\n\t{\n\t\t\"LD_IND word positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3b),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xffffffff } },\n\t},\n\t{\n\t\t\"LD_IND word positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_IND word negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LDX | BPF_IMM, 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_IND | BPF_W, -0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 } },\n\t},\n\t{\n\t\t\"LD_ABS byte\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, 0x20),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xcc } },\n\t},\n\t{\n\t\t\"LD_ABS byte positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xff } },\n\t},\n\t{\n\t\t\"LD_ABS byte positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_ABS byte negative offset, out of bounds load\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, -1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_EXPECTED_FAIL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"LD_ABS byte negative offset, in bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x82 }, },\n\t},\n\t{\n\t\t\"LD_ABS byte negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_ABS byte negative offset, multiple calls\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3c),\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3d),\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3e),\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_B, SKF_LL_OFF + 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x82 }, },\n\t},\n\t{\n\t\t\"LD_ABS halfword\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x22),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xdd88 } },\n\t},\n\t{\n\t\t\"LD_ABS halfword unaligned\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x25),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0x99ff } },\n\t},\n\t{\n\t\t\"LD_ABS halfword positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x3e),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xffff } },\n\t},\n\t{\n\t\t\"LD_ABS halfword positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_ABS halfword negative offset, out of bounds load\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, -1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_EXPECTED_FAIL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"LD_ABS halfword negative offset, in bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, SKF_LL_OFF + 0x3e),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x1982 }, },\n\t},\n\t{\n\t\t\"LD_ABS halfword negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_H, SKF_LL_OFF + 0x3e),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_ABS word\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x1c),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xaa55bb66 } },\n\t},\n\t{\n\t\t\"LD_ABS word unaligned (addr & 3 == 2)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x22),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0xdd88ee99 } },\n\t},\n\t{\n\t\t\"LD_ABS word unaligned (addr & 3 == 1)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x21),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0x77dd88ee } },\n\t},\n\t{\n\t\t\"LD_ABS word unaligned (addr & 3 == 3)\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x23),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{\n\t\t\t[0x1c] = 0xaa, [0x1d] = 0x55,\n\t\t\t[0x1e] = 0xbb, [0x1f] = 0x66,\n\t\t\t[0x20] = 0xcc, [0x21] = 0x77,\n\t\t\t[0x22] = 0xdd, [0x23] = 0x88,\n\t\t\t[0x24] = 0xee, [0x25] = 0x99,\n\t\t\t[0x26] = 0xff, [0x27] = 0xaa,\n\t\t},\n\t\t{ {0x40, 0x88ee99ff } },\n\t},\n\t{\n\t\t\"LD_ABS word positive offset, all ff\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x3c),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0xff, [0x3d] = 0xff,  [0x3e] = 0xff, [0x3f] = 0xff },\n\t\t{ {0x40, 0xffffffff } },\n\t},\n\t{\n\t\t\"LD_ABS word positive offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LD_ABS word negative offset, out of bounds load\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, -1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_EXPECTED_FAIL,\n\t\t.expected_errcode = -EINVAL,\n\t},\n\t{\n\t\t\"LD_ABS word negative offset, in bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, SKF_LL_OFF + 0x3c),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x25051982 }, },\n\t},\n\t{\n\t\t\"LD_ABS word negative offset, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_ABS | BPF_W, SKF_LL_OFF + 0x3c),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x3f, 0 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, preserved A\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3c),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0xffeebbaa }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, preserved A 2\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x175e9d63),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3c),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3d),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3e),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3f),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x175e9d63 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, test result 1\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3c),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x14 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, test result 2\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x3e),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x24 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, negative offset\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, -1),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, negative offset 2\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, SKF_LL_OFF + 0x3e),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0x24 }, },\n\t},\n\t{\n\t\t\"LDX_MSH standalone, out of bounds\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffeebbaa),\n\t\t\tBPF_STMT(BPF_LDX | BPF_B | BPF_MSH, 0x40),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TXA, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC,\n\t\t{ [0x3c] = 0x25, [0x3d] = 0x05,  [0x3e] = 0x19, [0x3f] = 0x82 },\n\t\t{ {0x40, 0 }, },\n\t},\n\t \n\t{\n\t\t\"ADD default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x42),\n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x42 } },\n\t},\n\t{\n\t\t\"ADD default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_ALU | BPF_ADD | BPF_K, 0x42),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x42 } },\n\t},\n\t{\n\t\t\"SUB default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x66),\n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x66 } },\n\t},\n\t{\n\t\t\"SUB default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_ALU | BPF_SUB | BPF_K, -0x66),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x66 } },\n\t},\n\t{\n\t\t\"MUL default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x42),\n\t\t\tBPF_STMT(BPF_ALU | BPF_MUL | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"MUL default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_ALU | BPF_MUL | BPF_K, 0x66),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"DIV default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x42),\n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x42),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"DIV default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_ALU | BPF_DIV | BPF_K, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"MOD default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x42),\n\t\t\tBPF_STMT(BPF_ALU | BPF_MOD | BPF_X, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x42),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"MOD default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_ALU | BPF_MOD | BPF_K, 0x1),\n\t\t\tBPF_STMT(BPF_RET | BPF_A, 0x0),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x0 } },\n\t},\n\t{\n\t\t\"JMP EQ default A\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0x0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x42),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x66),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x42 } },\n\t},\n\t{\n\t\t\"JMP EQ default X\",\n\t\t.u.insns = {\n\t\t\t \n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0x0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_X, 0x0, 0, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x42),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 0x66),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ {0x1, 0x42 } },\n\t},\n\t \n\t{\n\t\t\"JNE signed compare, test 1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfefbbc12),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0xffff0000),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_AND, R2, R3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R2, -17104896, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfefbbc12),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0xffff0000),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_AND, R2, R3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R2, 0xfefb0000, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R1, 0xfefbbc12),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R3, 0xffff0000),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R4, 0xfefb0000),\n\t\t\tBPF_MOV64_REG(R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_AND, R2, R3),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JNE, R2, R4, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 4\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, -17104896),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, -17104896, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 5\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0xfefb0000),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, 0xfefb0000, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 6\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x7efb0000),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, 0x7efb0000, 1),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, 2),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t},\n\t{\n\t\t\"JNE signed compare, test 7\",\n\t\t.u.insns = {\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xffff0000),\n\t\t\tBPF_STMT(BPF_MISC | BPF_TAX, 0),\n\t\t\tBPF_STMT(BPF_LD | BPF_IMM, 0xfefbbc12),\n\t\t\tBPF_STMT(BPF_ALU | BPF_AND | BPF_X, 0),\n\t\t\tBPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, 0xfefb0000, 1, 0),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 1),\n\t\t\tBPF_STMT(BPF_RET | BPF_K, 2),\n\t\t},\n\t\tCLASSIC | FLAG_NO_DATA,\n\t\t{},\n\t\t{ { 0, 2 } },\n\t},\n\t \n\t{\n\t\t\"LDX_MEM_B: operand register aliasing\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_B, R10, -8, 123),\n\t\t\tBPF_MOV64_REG(R0, R10),\n\t\t\tBPF_LDX_MEM(BPF_B, R0, R0, -8),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"LDX_MEM_H: operand register aliasing\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_H, R10, -8, 12345),\n\t\t\tBPF_MOV64_REG(R0, R10),\n\t\t\tBPF_LDX_MEM(BPF_H, R0, R0, -8),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 12345 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"LDX_MEM_W: operand register aliasing\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ST_MEM(BPF_W, R10, -8, 123456789),\n\t\t\tBPF_MOV64_REG(R0, R10),\n\t\t\tBPF_LDX_MEM(BPF_W, R0, R0, -8),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 123456789 } },\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"LDX_MEM_DW: operand register aliasing\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x123456789abcdefULL),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n\t\t\tBPF_MOV64_REG(R0, R10),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, R0, -8),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\n\t\t\tBPF_MOV64_REG(R1, R0),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t \n#define BPF_TEST_CLOBBER_ALU(alu, op, dst, src)\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t#alu \"_\" #op \" to \" #dst \": no clobbering\",\t\\\n\t\t.u.insns_int = {\t\t\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, R0),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, R1),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, R2),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, R3),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, R4),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, R5),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, R6),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, R7),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, R8),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, R9),\t\t\\\n\t\t\tBPF_##alu(BPF_ ##op, dst, src),\t\t\\\n\t\t\tBPF_ALU32_IMM(BPF_MOV, dst, dst),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R0, R0, 10),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, R1, 9),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R2, R2, 8),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R3, R3, 7),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R4, R4, 6),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R5, R5, 5),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R6, R6, 4),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R7, R7, 3),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R8, R8, 2),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R9, R9, 1),\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\\\n\t\t},\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\\\n\t\t{ { 0, 1 } }\t\t\t\t\t\\\n\t}\n\t \n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, AND, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, AND, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, OR, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, OR, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, XOR, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, XOR, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, LSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, LSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, RSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, RSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, ARSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, ARSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, ADD, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, ADD, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, SUB, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, SUB, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, MUL, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, MUL, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, DIV, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, DIV, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, MOD, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU64_IMM, MOD, R9, 123456789),\n\t \n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, AND, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, AND, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, OR, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, OR, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, XOR, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, XOR, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, LSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, LSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, RSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, RSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, ARSH, R8, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, ARSH, R9, 12),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, ADD, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, ADD, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, SUB, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, SUB, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, MUL, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, MUL, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, DIV, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, DIV, R9, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, MOD, R8, 123456789),\n\tBPF_TEST_CLOBBER_ALU(ALU32_IMM, MOD, R9, 123456789),\n\t \n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, AND, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, AND, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, OR, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, OR, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, XOR, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, XOR, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, LSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, LSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, RSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, RSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, ARSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, ARSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, ADD, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, ADD, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, SUB, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, SUB, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, MUL, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, MUL, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, DIV, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, DIV, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, MOD, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU64_REG, MOD, R9, R1),\n\t \n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, AND, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, AND, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, OR, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, OR, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, XOR, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, XOR, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, LSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, LSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, RSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, RSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, ARSH, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, ARSH, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, ADD, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, ADD, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, SUB, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, SUB, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, MUL, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, MUL, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, DIV, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, DIV, R9, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, MOD, R8, R1),\n\tBPF_TEST_CLOBBER_ALU(ALU32_REG, MOD, R9, R1),\n#undef BPF_TEST_CLOBBER_ALU\n#define BPF_TEST_CLOBBER_ATOMIC(width, op)\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t\"Atomic_\" #width \" \" #op \": no clobbering\",\t\\\n\t\t.u.insns_int = {\t\t\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R3, 3),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R4, 4),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R5, 5),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R6, 6),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R7, 7),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R8, 8),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R9, 9),\t\t\\\n\t\t\tBPF_ST_MEM(width, R10, -8,\t\t\\\n\t\t\t\t   (op) == BPF_CMPXCHG ? 0 :\t\\\n\t\t\t\t   (op) & BPF_FETCH ? 1 : 0),\t\\\n\t\t\tBPF_ATOMIC_OP(width, op, R10, R1, -8),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R0, 0, 10),\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R1, 1, 9),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R2, 2, 8),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R3, 3, 7),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R4, 4, 6),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R5, 5, 5),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R6, 6, 4),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R7, 7, 3),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R8, 8, 2),\t\t\\\n\t\t\tBPF_JMP_IMM(BPF_JNE, R9, 9, 1),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\\\n\t\t},\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\\\n\t\t{ { 0, 1 } },\t\t\t\t\t\\\n\t\t.stack_depth = 8,\t\t\t\t\\\n\t}\n\t \n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_ADD),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_AND),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_OR),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_XOR),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_ADD | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_AND | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_OR | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_XOR | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_XCHG),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_DW, BPF_CMPXCHG),\n\t \n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_ADD),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_AND),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_OR),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_XOR),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_ADD | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_AND | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_OR | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_XOR | BPF_FETCH),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_XCHG),\n\tBPF_TEST_CLOBBER_ATOMIC(BPF_W, BPF_CMPXCHG),\n#undef BPF_TEST_CLOBBER_ATOMIC\n\t \n#define BPF_ALU32_SRC_ZEXT(op)\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t\"ALU32_\" #op \"_X: src preserved in zext\",\t\\\n\t\t.u.insns_int = {\t\t\t\t\\\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789acbdefULL),\\\n\t\t\tBPF_LD_IMM64(R2, 0xfedcba9876543210ULL),\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\t\t\\\n\t\t\tBPF_ALU32_REG(BPF_##op, R2, R1),\t\\\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\\\n\t\t},\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\\\n\t\t{ { 0, 0 } },\t\t\t\t\t\\\n\t}\n\tBPF_ALU32_SRC_ZEXT(MOV),\n\tBPF_ALU32_SRC_ZEXT(AND),\n\tBPF_ALU32_SRC_ZEXT(OR),\n\tBPF_ALU32_SRC_ZEXT(XOR),\n\tBPF_ALU32_SRC_ZEXT(ADD),\n\tBPF_ALU32_SRC_ZEXT(SUB),\n\tBPF_ALU32_SRC_ZEXT(MUL),\n\tBPF_ALU32_SRC_ZEXT(DIV),\n\tBPF_ALU32_SRC_ZEXT(MOD),\n#undef BPF_ALU32_SRC_ZEXT\n\t \n#define BPF_ATOMIC32_SRC_ZEXT(op)\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\t\"ATOMIC_W_\" #op \": src preserved in zext\",\t\t\\\n\t\t.u.insns_int = {\t\t\t\t\t\\\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789acbdefULL),\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\t\\\n\t\t\tBPF_ST_MEM(BPF_W, R10, -4, 0),\t\t\t\\\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_##op, R10, R1, -4),\t\\\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\t\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\t\\\n\t\t},\t\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\t\\\n\t\t{ { 0, 0 } },\t\t\t\t\t\t\\\n\t\t.stack_depth = 8,\t\t\t\t\t\\\n\t}\n\tBPF_ATOMIC32_SRC_ZEXT(ADD),\n\tBPF_ATOMIC32_SRC_ZEXT(AND),\n\tBPF_ATOMIC32_SRC_ZEXT(OR),\n\tBPF_ATOMIC32_SRC_ZEXT(XOR),\n#undef BPF_ATOMIC32_SRC_ZEXT\n\t \n\t{\n\t\t\"ATOMIC_W_CMPXCHG: src preserved in zext\",\n\t\t.u.insns_int = {\n\t\t\tBPF_LD_IMM64(R1, 0x0123456789acbdefULL),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R2, R1),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, 0),\n\t\t\tBPF_ST_MEM(BPF_W, R10, -4, 0),\n\t\t\tBPF_ATOMIC_OP(BPF_W, BPF_CMPXCHG, R10, R1, -4),\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R2),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R2, R1),\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R2, 32),\n\t\t\tBPF_ALU64_REG(BPF_OR, R1, R2),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t\t.stack_depth = 8,\n\t},\n\t \n#define BPF_JMP32_IMM_ZEXT(op)\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t\"JMP32_\" #op \"_K: operand preserved in zext\",\t\\\n\t\t.u.insns_int = {\t\t\t\t\\\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789acbdefULL),\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\\\n\t\t\tBPF_JMP32_IMM(BPF_##op, R0, 1234, 1),\t\\\n\t\t\tBPF_JMP_A(0),  \t\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R1),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\\\n\t\t},\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\\\n\t\t{ { 0, 0 } },\t\t\t\t\t\\\n\t}\n\tBPF_JMP32_IMM_ZEXT(JEQ),\n\tBPF_JMP32_IMM_ZEXT(JNE),\n\tBPF_JMP32_IMM_ZEXT(JSET),\n\tBPF_JMP32_IMM_ZEXT(JGT),\n\tBPF_JMP32_IMM_ZEXT(JGE),\n\tBPF_JMP32_IMM_ZEXT(JLT),\n\tBPF_JMP32_IMM_ZEXT(JLE),\n\tBPF_JMP32_IMM_ZEXT(JSGT),\n\tBPF_JMP32_IMM_ZEXT(JSGE),\n\tBPF_JMP32_IMM_ZEXT(JSGT),\n\tBPF_JMP32_IMM_ZEXT(JSLT),\n\tBPF_JMP32_IMM_ZEXT(JSLE),\n#undef BPF_JMP2_IMM_ZEXT\n\t \n#define BPF_JMP32_REG_ZEXT(op)\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t\"JMP32_\" #op \"_X: operands preserved in zext\",\t\\\n\t\t.u.insns_int = {\t\t\t\t\\\n\t\t\tBPF_LD_IMM64(R0, 0x0123456789acbdefULL),\\\n\t\t\tBPF_LD_IMM64(R1, 0xfedcba9876543210ULL),\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R2, R0),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R3, R1),\t\t\\\n\t\t\tBPF_JMP32_IMM(BPF_##op, R0, R1, 1),\t\\\n\t\t\tBPF_JMP_A(0),  \t\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_SUB, R0, R2),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_SUB, R1, R3),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_MOV, R1, R0),\t\t\\\n\t\t\tBPF_ALU64_IMM(BPF_RSH, R1, 32),\t\t\\\n\t\t\tBPF_ALU64_REG(BPF_OR, R0, R1),\t\t\\\n\t\t\tBPF_EXIT_INSN(),\t\t\t\\\n\t\t},\t\t\t\t\t\t\\\n\t\tINTERNAL,\t\t\t\t\t\\\n\t\t{ },\t\t\t\t\t\t\\\n\t\t{ { 0, 0 } },\t\t\t\t\t\\\n\t}\n\tBPF_JMP32_REG_ZEXT(JEQ),\n\tBPF_JMP32_REG_ZEXT(JNE),\n\tBPF_JMP32_REG_ZEXT(JSET),\n\tBPF_JMP32_REG_ZEXT(JGT),\n\tBPF_JMP32_REG_ZEXT(JGE),\n\tBPF_JMP32_REG_ZEXT(JLT),\n\tBPF_JMP32_REG_ZEXT(JLE),\n\tBPF_JMP32_REG_ZEXT(JSGT),\n\tBPF_JMP32_REG_ZEXT(JSGE),\n\tBPF_JMP32_REG_ZEXT(JSGT),\n\tBPF_JMP32_REG_ZEXT(JSLT),\n\tBPF_JMP32_REG_ZEXT(JSLE),\n#undef BPF_JMP2_REG_ZEXT\n\t \n\t{\n\t\t\"ALU64_MOV_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mov_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_AND_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_and_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_OR_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_or_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_XOR_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_xor_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_LSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_lsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_RSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_rsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_arsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_ADD_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_add_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_SUB_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_sub_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_MUL_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mul_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_DIV_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_div_imm_regs,\n\t},\n\t{\n\t\t\"ALU64_MOD_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mod_imm_regs,\n\t},\n\t \n\t{\n\t\t\"ALU32_MOV_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mov_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_AND_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_and_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_OR_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_or_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_XOR_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_xor_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_LSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_lsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_RSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_rsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_ARSH_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_arsh_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_ADD_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_add_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_SUB_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_sub_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_MUL_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mul_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_DIV_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_div_imm_regs,\n\t},\n\t{\n\t\t\"ALU32_MOD_K: registers\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mod_imm_regs,\n\t},\n\t \n\t{\n\t\t\"ALU64_MOV_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mov_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_AND_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_and_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_OR_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_or_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_XOR_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_xor_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_LSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_lsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_RSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_rsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_arsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_ADD_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_add_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_SUB_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_sub_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_MUL_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mul_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_DIV_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_div_reg_pairs,\n\t},\n\t{\n\t\t\"ALU64_MOD_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mod_reg_pairs,\n\t},\n\t \n\t{\n\t\t\"ALU32_MOV_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mov_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_AND_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_and_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_OR_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_or_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_XOR_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_xor_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_LSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_lsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_RSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_rsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_ARSH_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_arsh_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_ADD_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_add_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_SUB_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_sub_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_MUL_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mul_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_DIV_X: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_div_reg_pairs,\n\t},\n\t{\n\t\t\"ALU32_MOD_X register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mod_reg_pairs,\n\t},\n\t \n\t{\n\t\t\"ALU64_LSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_lsh_imm,\n\t},\n\t{\n\t\t\"ALU64_RSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_rsh_imm,\n\t},\n\t{\n\t\t\"ALU64_ARSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_arsh_imm,\n\t},\n\t{\n\t\t\"ALU64_LSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_lsh_reg,\n\t},\n\t{\n\t\t\"ALU64_RSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_rsh_reg,\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_arsh_reg,\n\t},\n\t \n\t{\n\t\t\"ALU32_LSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_lsh_imm,\n\t},\n\t{\n\t\t\"ALU32_RSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_rsh_imm,\n\t},\n\t{\n\t\t\"ALU32_ARSH_K: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_arsh_imm,\n\t},\n\t{\n\t\t\"ALU32_LSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_lsh_reg,\n\t},\n\t{\n\t\t\"ALU32_RSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_rsh_reg,\n\t},\n\t{\n\t\t\"ALU32_ARSH_X: all shift values\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_arsh_reg,\n\t},\n\t \n\t{\n\t\t\"ALU64_LSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_lsh_same_reg,\n\t},\n\t{\n\t\t\"ALU64_RSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_rsh_same_reg,\n\t},\n\t{\n\t\t\"ALU64_ARSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_arsh_same_reg,\n\t},\n\t \n\t{\n\t\t\"ALU32_LSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_lsh_same_reg,\n\t},\n\t{\n\t\t\"ALU32_RSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_rsh_same_reg,\n\t},\n\t{\n\t\t\"ALU32_ARSH_X: all shift values with the same register\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_arsh_same_reg,\n\t},\n\t \n\t{\n\t\t\"ALU64_MOV_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mov_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_AND_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_and_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_OR_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_or_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_XOR_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_xor_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_ADD_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_add_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_SUB_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_sub_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_MUL_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mul_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_DIV_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_div_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_MOD_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mod_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"ALU32_MOV_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mov_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_AND_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_and_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_OR_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_or_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_XOR_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_xor_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_ADD_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_add_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_SUB_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_sub_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_MUL_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mul_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_DIV_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_div_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_MOD_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mod_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"ALU64_MOV_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mov_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_AND_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_and_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_OR_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_or_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_XOR_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_xor_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_ADD_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_add_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_SUB_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_sub_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_MUL_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mul_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_DIV_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_div_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU64_MOD_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu64_mod_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"ALU32_MOV_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mov_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_AND_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_and_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_OR_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_or_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_XOR_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_xor_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_ADD_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_add_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_SUB_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_sub_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_MUL_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mul_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_DIV_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_div_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ALU32_MOD_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_alu32_mod_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"LD_IMM64: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_ld_imm64_magn,\n\t},\n\t{\n\t\t\"LD_IMM64: checker byte patterns\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_ld_imm64_checker,\n\t},\n\t{\n\t\t\"LD_IMM64: random positive and zero byte patterns\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_ld_imm64_pos_zero,\n\t},\n\t{\n\t\t\"LD_IMM64: random negative and zero byte patterns\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_ld_imm64_neg_zero,\n\t},\n\t{\n\t\t\"LD_IMM64: random positive and negative byte patterns\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_ld_imm64_pos_neg,\n\t},\n\t \n\t{\n\t\t\"ATOMIC_DW_ADD: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_add_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_AND: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_and_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_OR: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_or_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XOR: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xor_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_ADD_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_add_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_AND_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_and_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_OR_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_or_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XOR_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xor_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XCHG: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xchg_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_DW_CMPXCHG: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_cmpxchg_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t \n\t{\n\t\t\"ATOMIC_W_ADD: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_add_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_AND: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_and_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_OR: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_or_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_XOR: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xor_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_ADD_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_add_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_AND_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_and_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_OR_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_or_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_XOR_FETCH: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xor_fetch_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_XCHG: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xchg_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t{\n\t\t\"ATOMIC_W_CMPXCHG: register combinations\",\n\t\t{ },\n\t\tINTERNAL,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_cmpxchg_reg_pairs,\n\t\t.stack_depth = 8,\n\t},\n\t \n\t{\n\t\t\"ATOMIC_DW_ADD: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_add,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_AND: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_and,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_OR: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_or,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XOR: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xor,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_ADD_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_add_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_AND_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_and_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_OR_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_or_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XOR_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xor_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_XCHG: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic64_xchg,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_DW_CMPXCHG: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_cmpxchg64,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"ATOMIC_W_ADD: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_add,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_AND: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_and,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_OR: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_or,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_XOR: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xor,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_ADD_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_add_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_AND_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_and_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_OR_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_or_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_XOR_FETCH: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xor_fetch,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_XCHG: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_atomic32_xchg,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"ATOMIC_W_CMPXCHG: all operand magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_cmpxchg32,\n\t\t.stack_depth = 8,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"JMP_JSET_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jset_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JEQ_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jeq_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JNE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jne_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JGT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jgt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JGE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jge_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JLT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jlt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JLE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jle_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSGT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsgt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSGE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsge_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSLT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jslt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSLE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsle_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"JMP_JSET_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jset_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JEQ_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jeq_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JNE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jne_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JGT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jgt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JGE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jge_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JLT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jlt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JLE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jle_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSGT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsgt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSGE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsge_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSLT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jslt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP_JSLE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp_jsle_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"JMP32_JSET_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jset_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JEQ_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jeq_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JNE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jne_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JGT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jgt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JGE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jge_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JLT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jlt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JLE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jle_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSGT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsgt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSGE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsge_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSLT_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jslt_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSLE_K: all immediate value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsle_imm,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"JMP32_JSET_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jset_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JEQ_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jeq_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JNE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jne_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JGT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jgt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JGE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jge_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JLT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jlt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JLE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jle_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSGT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsgt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSGE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsge_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSLT_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jslt_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t{\n\t\t\"JMP32_JSLE_X: all register value magnitudes\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_jmp32_jsle_reg,\n\t\t.nr_testruns = NR_PATTERN_RUNS,\n\t},\n\t \n\t{\n\t\t\"JMP_JSET_K: imm = 0 -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JSET, R1, 0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JLT_K: imm = 0 -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JLT, R1, 0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JGE_K: imm = 0 -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JGE, R1, 0, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGT_K: imm = 0xffffffff -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JGT, R1, U32_MAX, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JLE_K: imm = 0xffffffff -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_IMM(BPF_JLE, R1, U32_MAX, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP32_JSGT_K: imm = 0x7fffffff -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGT, R1, S32_MAX, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP32_JSGE_K: imm = -0x80000000 -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSGE, R1, S32_MIN, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP32_JSLT_K: imm = -0x80000000 -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLT, R1, S32_MIN, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP32_JSLE_K: imm = 0x7fffffff -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP32_IMM(BPF_JSLE, R1, S32_MAX, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JEQ_X: dst = src -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JEQ, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JGE_X: dst = src -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JGE, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JLE_X: dst = src -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JLE, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSGE_X: dst = src -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JSGE, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JSLE_X: dst = src -> always taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JSLE, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t},\n\t{\n\t\t\"JMP_JNE_X: dst = src -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JNE, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JGT_X: dst = src -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JGT, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JLT_X: dst = src -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JLT, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JSGT_X: dst = src -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JSGT, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"JMP_JSLT_X: dst = src -> never taken\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 1),\n\t\t\tBPF_JMP_REG(BPF_JSLT, R1, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t \n\t{\n\t\t\"Short relative jump: offset=0\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA | FLAG_VERIFIER_ZEXT,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"Short relative jump: offset=1\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA | FLAG_VERIFIER_ZEXT,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"Short relative jump: offset=2\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 2),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA | FLAG_VERIFIER_ZEXT,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"Short relative jump: offset=3\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 3),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA | FLAG_VERIFIER_ZEXT,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t{\n\t\t\"Short relative jump: offset=4\",\n\t\t.u.insns_int = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_JMP_IMM(BPF_JEQ, R0, 0, 4),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_ALU32_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t\tBPF_ALU32_IMM(BPF_MOV, R0, -1),\n\t\t},\n\t\tINTERNAL | FLAG_NO_DATA | FLAG_VERIFIER_ZEXT,\n\t\t{ },\n\t\t{ { 0, 0 } },\n\t},\n\t \n\t{\n\t\t\"Long conditional jump: taken at runtime\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_max_jmp_taken,\n\t},\n\t{\n\t\t\"Long conditional jump: not taken at runtime\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t\t.fill_helper = bpf_fill_max_jmp_not_taken,\n\t},\n\t{\n\t\t\"Long conditional jump: always taken, known at JIT time\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 1 } },\n\t\t.fill_helper = bpf_fill_max_jmp_always_taken,\n\t},\n\t{\n\t\t\"Long conditional jump: never taken, known at JIT time\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, 2 } },\n\t\t.fill_helper = bpf_fill_max_jmp_never_taken,\n\t},\n\t \n\t{\n\t\t\"Staggered jumps: JMP_JA\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_ja,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JEQ_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jeq_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JNE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jne_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSET_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jset_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JGT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jgt_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JGE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jge_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JLT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jlt_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JLE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jle_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSGT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsgt_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSGE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsge_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSLT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jslt_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSLE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsle_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t \n\t{\n\t\t\"Staggered jumps: JMP_JEQ_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jeq_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JNE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jne_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSET_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jset_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JGT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jgt_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JGE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jge_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JLT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jlt_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JLE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jle_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSGT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsgt_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSGE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsge_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSLT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jslt_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP_JSLE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsle_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t \n\t{\n\t\t\"Staggered jumps: JMP32_JEQ_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jeq32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JNE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jne32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSET_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jset32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JGT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jgt32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JGE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jge32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JLT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jlt32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JLE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jle32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSGT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsgt32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSGE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsge32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSLT_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jslt32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSLE_K\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsle32_imm,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t \n\t{\n\t\t\"Staggered jumps: JMP32_JEQ_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jeq32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JNE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jne32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSET_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jset32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JGT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jgt32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JGE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jge32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JLT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jlt32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JLE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jle32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSGT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsgt32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSGE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsge32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSLT_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jslt32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n\t{\n\t\t\"Staggered jumps: JMP32_JSLE_X\",\n\t\t{ },\n\t\tINTERNAL | FLAG_NO_DATA,\n\t\t{ },\n\t\t{ { 0, MAX_STAGGERED_JMP_SIZE + 1 } },\n\t\t.fill_helper = bpf_fill_staggered_jsle32_reg,\n\t\t.nr_testruns = NR_STAGGERED_JMP_RUNS,\n\t},\n};\n\nstatic struct net_device dev;\n\nstatic struct sk_buff *populate_skb(char *buf, int size)\n{\n\tstruct sk_buff *skb;\n\n\tif (size >= MAX_DATA)\n\t\treturn NULL;\n\n\tskb = alloc_skb(MAX_DATA, GFP_KERNEL);\n\tif (!skb)\n\t\treturn NULL;\n\n\t__skb_put_data(skb, buf, size);\n\n\t \n\tskb_reset_mac_header(skb);\n\tskb->protocol = htons(ETH_P_IP);\n\tskb->pkt_type = SKB_TYPE;\n\tskb->mark = SKB_MARK;\n\tskb->hash = SKB_HASH;\n\tskb->queue_mapping = SKB_QUEUE_MAP;\n\tskb->vlan_tci = SKB_VLAN_TCI;\n\tskb->vlan_proto = htons(ETH_P_IP);\n\tdev_net_set(&dev, &init_net);\n\tskb->dev = &dev;\n\tskb->dev->ifindex = SKB_DEV_IFINDEX;\n\tskb->dev->type = SKB_DEV_TYPE;\n\tskb_set_network_header(skb, min(size, ETH_HLEN));\n\n\treturn skb;\n}\n\nstatic void *generate_test_data(struct bpf_test *test, int sub)\n{\n\tstruct sk_buff *skb;\n\tstruct page *page;\n\n\tif (test->aux & FLAG_NO_DATA)\n\t\treturn NULL;\n\n\tif (test->aux & FLAG_LARGE_MEM)\n\t\treturn kmalloc(test->test[sub].data_size, GFP_KERNEL);\n\n\t \n\tskb = populate_skb(test->data, test->test[sub].data_size);\n\tif (!skb)\n\t\treturn NULL;\n\n\tif (test->aux & FLAG_SKB_FRAG) {\n\t\t \n\t\tpage = alloc_page(GFP_KERNEL);\n\t\tif (!page)\n\t\t\tgoto err_kfree_skb;\n\n\t\tmemcpy(page_address(page), test->frag_data, MAX_DATA);\n\t\tskb_add_rx_frag(skb, 0, page, 0, MAX_DATA, MAX_DATA);\n\t}\n\n\treturn skb;\nerr_kfree_skb:\n\tkfree_skb(skb);\n\treturn NULL;\n}\n\nstatic void release_test_data(const struct bpf_test *test, void *data)\n{\n\tif (test->aux & FLAG_NO_DATA)\n\t\treturn;\n\n\tif (test->aux & FLAG_LARGE_MEM)\n\t\tkfree(data);\n\telse\n\t\tkfree_skb(data);\n}\n\nstatic int filter_length(int which)\n{\n\tstruct sock_filter *fp;\n\tint len;\n\n\tif (tests[which].fill_helper)\n\t\treturn tests[which].u.ptr.len;\n\n\tfp = tests[which].u.insns;\n\tfor (len = MAX_INSNS - 1; len > 0; --len)\n\t\tif (fp[len].code != 0 || fp[len].k != 0)\n\t\t\tbreak;\n\n\treturn len + 1;\n}\n\nstatic void *filter_pointer(int which)\n{\n\tif (tests[which].fill_helper)\n\t\treturn tests[which].u.ptr.insns;\n\telse\n\t\treturn tests[which].u.insns;\n}\n\nstatic struct bpf_prog *generate_filter(int which, int *err)\n{\n\t__u8 test_type = tests[which].aux & TEST_TYPE_MASK;\n\tunsigned int flen = filter_length(which);\n\tvoid *fptr = filter_pointer(which);\n\tstruct sock_fprog_kern fprog;\n\tstruct bpf_prog *fp;\n\n\tswitch (test_type) {\n\tcase CLASSIC:\n\t\tfprog.filter = fptr;\n\t\tfprog.len = flen;\n\n\t\t*err = bpf_prog_create(&fp, &fprog);\n\t\tif (tests[which].aux & FLAG_EXPECTED_FAIL) {\n\t\t\tif (*err == tests[which].expected_errcode) {\n\t\t\t\tpr_cont(\"PASS\\n\");\n\t\t\t\t \n\t\t\t\t*err = 0;\n\t\t\t\treturn NULL;\n\t\t\t} else {\n\t\t\t\tpr_cont(\"UNEXPECTED_PASS\\n\");\n\t\t\t\t \n\t\t\t\t*err = -EINVAL;\n\t\t\t\treturn NULL;\n\t\t\t}\n\t\t}\n\t\tif (*err) {\n\t\t\tpr_cont(\"FAIL to prog_create err=%d len=%d\\n\",\n\t\t\t\t*err, fprog.len);\n\t\t\treturn NULL;\n\t\t}\n\t\tbreak;\n\n\tcase INTERNAL:\n\t\tfp = bpf_prog_alloc(bpf_prog_size(flen), 0);\n\t\tif (fp == NULL) {\n\t\t\tpr_cont(\"UNEXPECTED_FAIL no memory left\\n\");\n\t\t\t*err = -ENOMEM;\n\t\t\treturn NULL;\n\t\t}\n\n\t\tfp->len = flen;\n\t\t \n\t\tfp->type = BPF_PROG_TYPE_SOCKET_FILTER;\n\t\tmemcpy(fp->insnsi, fptr, fp->len * sizeof(struct bpf_insn));\n\t\tfp->aux->stack_depth = tests[which].stack_depth;\n\t\tfp->aux->verifier_zext = !!(tests[which].aux &\n\t\t\t\t\t    FLAG_VERIFIER_ZEXT);\n\n\t\t \n\t\tfp = bpf_prog_select_runtime(fp, err);\n\t\tif (*err) {\n\t\t\tpr_cont(\"FAIL to select_runtime err=%d\\n\", *err);\n\t\t\treturn NULL;\n\t\t}\n\t\tbreak;\n\t}\n\n\t*err = 0;\n\treturn fp;\n}\n\nstatic void release_filter(struct bpf_prog *fp, int which)\n{\n\t__u8 test_type = tests[which].aux & TEST_TYPE_MASK;\n\n\tswitch (test_type) {\n\tcase CLASSIC:\n\t\tbpf_prog_destroy(fp);\n\t\tbreak;\n\tcase INTERNAL:\n\t\tbpf_prog_free(fp);\n\t\tbreak;\n\t}\n}\n\nstatic int __run_one(const struct bpf_prog *fp, const void *data,\n\t\t     int runs, u64 *duration)\n{\n\tu64 start, finish;\n\tint ret = 0, i;\n\n\tmigrate_disable();\n\tstart = ktime_get_ns();\n\n\tfor (i = 0; i < runs; i++)\n\t\tret = bpf_prog_run(fp, data);\n\n\tfinish = ktime_get_ns();\n\tmigrate_enable();\n\n\t*duration = finish - start;\n\tdo_div(*duration, runs);\n\n\treturn ret;\n}\n\nstatic int run_one(const struct bpf_prog *fp, struct bpf_test *test)\n{\n\tint err_cnt = 0, i, runs = MAX_TESTRUNS;\n\n\tif (test->nr_testruns)\n\t\truns = min(test->nr_testruns, MAX_TESTRUNS);\n\n\tfor (i = 0; i < MAX_SUBTESTS; i++) {\n\t\tvoid *data;\n\t\tu64 duration;\n\t\tu32 ret;\n\n\t\t \n\t\tif (i > 0 &&\n\t\t    test->test[i].data_size == 0 &&\n\t\t    test->test[i].result == 0)\n\t\t\tbreak;\n\n\t\tdata = generate_test_data(test, i);\n\t\tif (!data && !(test->aux & FLAG_NO_DATA)) {\n\t\t\tpr_cont(\"data generation failed \");\n\t\t\terr_cnt++;\n\t\t\tbreak;\n\t\t}\n\t\tret = __run_one(fp, data, runs, &duration);\n\t\trelease_test_data(test, data);\n\n\t\tif (ret == test->test[i].result) {\n\t\t\tpr_cont(\"%lld \", duration);\n\t\t} else {\n\t\t\ts32 res = test->test[i].result;\n\n\t\t\tpr_cont(\"ret %d != %d (%#x != %#x)\",\n\t\t\t\tret, res, ret, res);\n\t\t\terr_cnt++;\n\t\t}\n\t}\n\n\treturn err_cnt;\n}\n\nstatic char test_name[64];\nmodule_param_string(test_name, test_name, sizeof(test_name), 0);\n\nstatic int test_id = -1;\nmodule_param(test_id, int, 0);\n\nstatic int test_range[2] = { 0, INT_MAX };\nmodule_param_array(test_range, int, NULL, 0);\n\nstatic bool exclude_test(int test_id)\n{\n\treturn test_id < test_range[0] || test_id > test_range[1];\n}\n\nstatic __init struct sk_buff *build_test_skb(void)\n{\n\tu32 headroom = NET_SKB_PAD + NET_IP_ALIGN + ETH_HLEN;\n\tstruct sk_buff *skb[2];\n\tstruct page *page[2];\n\tint i, data_size = 8;\n\n\tfor (i = 0; i < 2; i++) {\n\t\tpage[i] = alloc_page(GFP_KERNEL);\n\t\tif (!page[i]) {\n\t\t\tif (i == 0)\n\t\t\t\tgoto err_page0;\n\t\t\telse\n\t\t\t\tgoto err_page1;\n\t\t}\n\n\t\t \n\t\tskb[i] = dev_alloc_skb(headroom + data_size);\n\t\tif (!skb[i]) {\n\t\t\tif (i == 0)\n\t\t\t\tgoto err_skb0;\n\t\t\telse\n\t\t\t\tgoto err_skb1;\n\t\t}\n\n\t\tskb_reserve(skb[i], headroom);\n\t\tskb_put(skb[i], data_size);\n\t\tskb[i]->protocol = htons(ETH_P_IP);\n\t\tskb_reset_network_header(skb[i]);\n\t\tskb_set_mac_header(skb[i], -ETH_HLEN);\n\n\t\tskb_add_rx_frag(skb[i], 0, page[i], 0, 64, 64);\n\t\t \n\t}\n\n\t \n\tskb_shinfo(skb[0])->gso_size = 1448;\n\tskb_shinfo(skb[0])->gso_type = SKB_GSO_TCPV4;\n\tskb_shinfo(skb[0])->gso_type |= SKB_GSO_DODGY;\n\tskb_shinfo(skb[0])->gso_segs = 0;\n\tskb_shinfo(skb[0])->frag_list = skb[1];\n\tskb_shinfo(skb[0])->hwtstamps.hwtstamp = 1000;\n\n\t \n\tskb[0]->len += skb[1]->len;\n\tskb[0]->data_len += skb[1]->data_len;\n\tskb[0]->truesize += skb[1]->truesize;\n\n\treturn skb[0];\n\nerr_skb1:\n\t__free_page(page[1]);\nerr_page1:\n\tkfree_skb(skb[0]);\nerr_skb0:\n\t__free_page(page[0]);\nerr_page0:\n\treturn NULL;\n}\n\nstatic __init struct sk_buff *build_test_skb_linear_no_head_frag(void)\n{\n\tunsigned int alloc_size = 2000;\n\tunsigned int headroom = 102, doffset = 72, data_size = 1308;\n\tstruct sk_buff *skb[2];\n\tint i;\n\n\t \n\tfor (i = 0; i < 2; i++) {\n\t\tskb[i] = alloc_skb(alloc_size, GFP_KERNEL);\n\t\tif (!skb[i]) {\n\t\t\tif (i == 0)\n\t\t\t\tgoto err_skb0;\n\t\t\telse\n\t\t\t\tgoto err_skb1;\n\t\t}\n\n\t\tskb[i]->protocol = htons(ETH_P_IPV6);\n\t\tskb_reserve(skb[i], headroom);\n\t\tskb_put(skb[i], doffset + data_size);\n\t\tskb_reset_network_header(skb[i]);\n\t\tif (i == 0)\n\t\t\tskb_reset_mac_header(skb[i]);\n\t\telse\n\t\t\tskb_set_mac_header(skb[i], -ETH_HLEN);\n\t\t__skb_pull(skb[i], doffset);\n\t}\n\n\t \n\tskb_shinfo(skb[0])->gso_size = 1288;\n\tskb_shinfo(skb[0])->gso_type = SKB_GSO_TCPV6 | SKB_GSO_DODGY;\n\tskb_shinfo(skb[0])->gso_segs = 0;\n\tskb_shinfo(skb[0])->frag_list = skb[1];\n\n\t \n\tskb[0]->len += skb[1]->len;\n\tskb[0]->data_len += skb[1]->len;\n\tskb[0]->truesize += skb[1]->truesize;\n\n\treturn skb[0];\n\nerr_skb1:\n\tkfree_skb(skb[0]);\nerr_skb0:\n\treturn NULL;\n}\n\nstruct skb_segment_test {\n\tconst char *descr;\n\tstruct sk_buff *(*build_skb)(void);\n\tnetdev_features_t features;\n};\n\nstatic struct skb_segment_test skb_segment_tests[] __initconst = {\n\t{\n\t\t.descr = \"gso_with_rx_frags\",\n\t\t.build_skb = build_test_skb,\n\t\t.features = NETIF_F_SG | NETIF_F_GSO_PARTIAL | NETIF_F_IP_CSUM |\n\t\t\t    NETIF_F_IPV6_CSUM | NETIF_F_RXCSUM\n\t},\n\t{\n\t\t.descr = \"gso_linear_no_head_frag\",\n\t\t.build_skb = build_test_skb_linear_no_head_frag,\n\t\t.features = NETIF_F_SG | NETIF_F_FRAGLIST |\n\t\t\t    NETIF_F_HW_VLAN_CTAG_TX | NETIF_F_GSO |\n\t\t\t    NETIF_F_LLTX | NETIF_F_GRO |\n\t\t\t    NETIF_F_IPV6_CSUM | NETIF_F_RXCSUM |\n\t\t\t    NETIF_F_HW_VLAN_STAG_TX\n\t}\n};\n\nstatic __init int test_skb_segment_single(const struct skb_segment_test *test)\n{\n\tstruct sk_buff *skb, *segs;\n\tint ret = -1;\n\n\tskb = test->build_skb();\n\tif (!skb) {\n\t\tpr_info(\"%s: failed to build_test_skb\", __func__);\n\t\tgoto done;\n\t}\n\n\tsegs = skb_segment(skb, test->features);\n\tif (!IS_ERR(segs)) {\n\t\tkfree_skb_list(segs);\n\t\tret = 0;\n\t}\n\tkfree_skb(skb);\ndone:\n\treturn ret;\n}\n\nstatic __init int test_skb_segment(void)\n{\n\tint i, err_cnt = 0, pass_cnt = 0;\n\n\tfor (i = 0; i < ARRAY_SIZE(skb_segment_tests); i++) {\n\t\tconst struct skb_segment_test *test = &skb_segment_tests[i];\n\n\t\tcond_resched();\n\t\tif (exclude_test(i))\n\t\t\tcontinue;\n\n\t\tpr_info(\"#%d %s \", i, test->descr);\n\n\t\tif (test_skb_segment_single(test)) {\n\t\t\tpr_cont(\"FAIL\\n\");\n\t\t\terr_cnt++;\n\t\t} else {\n\t\t\tpr_cont(\"PASS\\n\");\n\t\t\tpass_cnt++;\n\t\t}\n\t}\n\n\tpr_info(\"%s: Summary: %d PASSED, %d FAILED\\n\", __func__,\n\t\tpass_cnt, err_cnt);\n\treturn err_cnt ? -EINVAL : 0;\n}\n\nstatic __init int test_bpf(void)\n{\n\tint i, err_cnt = 0, pass_cnt = 0;\n\tint jit_cnt = 0, run_cnt = 0;\n\n\tfor (i = 0; i < ARRAY_SIZE(tests); i++) {\n\t\tstruct bpf_prog *fp;\n\t\tint err;\n\n\t\tcond_resched();\n\t\tif (exclude_test(i))\n\t\t\tcontinue;\n\n\t\tpr_info(\"#%d %s \", i, tests[i].descr);\n\n\t\tif (tests[i].fill_helper &&\n\t\t    tests[i].fill_helper(&tests[i]) < 0) {\n\t\t\tpr_cont(\"FAIL to prog_fill\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\tfp = generate_filter(i, &err);\n\n\t\tif (tests[i].fill_helper) {\n\t\t\tkfree(tests[i].u.ptr.insns);\n\t\t\ttests[i].u.ptr.insns = NULL;\n\t\t}\n\n\t\tif (fp == NULL) {\n\t\t\tif (err == 0) {\n\t\t\t\tpass_cnt++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\terr_cnt++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_cont(\"jited:%u \", fp->jited);\n\n\t\trun_cnt++;\n\t\tif (fp->jited)\n\t\t\tjit_cnt++;\n\n\t\terr = run_one(fp, &tests[i]);\n\t\trelease_filter(fp, i);\n\n\t\tif (err) {\n\t\t\tpr_cont(\"FAIL (%d times)\\n\", err);\n\t\t\terr_cnt++;\n\t\t} else {\n\t\t\tpr_cont(\"PASS\\n\");\n\t\t\tpass_cnt++;\n\t\t}\n\t}\n\n\tpr_info(\"Summary: %d PASSED, %d FAILED, [%d/%d JIT'ed]\\n\",\n\t\tpass_cnt, err_cnt, jit_cnt, run_cnt);\n\n\treturn err_cnt ? -EINVAL : 0;\n}\n\nstruct tail_call_test {\n\tconst char *descr;\n\tstruct bpf_insn insns[MAX_INSNS];\n\tint flags;\n\tint result;\n\tint stack_depth;\n};\n\n \n#define FLAG_NEED_STATE\t\tBIT(0)\n#define FLAG_RESULT_IN_STATE\tBIT(1)\n\n \n#define TAIL_CALL_MARKER 0x7a11ca11\n\n \n#define TAIL_CALL_NULL 0x7fff\n\n \n#define TAIL_CALL_INVALID 0x7ffe\n\n#define TAIL_CALL(offset)\t\t\t       \\\n\tBPF_LD_IMM64(R2, TAIL_CALL_MARKER),\t       \\\n\tBPF_RAW_INSN(BPF_ALU | BPF_MOV | BPF_K, R3, 0, \\\n\t\t     offset, TAIL_CALL_MARKER),\t       \\\n\tBPF_JMP_IMM(BPF_TAIL_CALL, 0, 0, 0)\n\n \nBPF_CALL_1(bpf_test_func, u64, arg)\n{\n\tchar buf[64];\n\tlong a = 0;\n\tlong b = 1;\n\tlong c = 2;\n\tlong d = 3;\n\tlong e = 4;\n\tlong f = 5;\n\tlong g = 6;\n\tlong h = 7;\n\n\treturn snprintf(buf, sizeof(buf),\n\t\t\t\"%ld %lu %lx %ld %lu %lx %ld %lu %x\",\n\t\t\ta, b, c, d, e, f, g, h, (int)arg);\n}\n#define BPF_FUNC_test_func __BPF_FUNC_MAX_ID\n\n \nstatic struct tail_call_test tail_call_tests[] = {\n\t{\n\t\t\"Tail call leaf\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_REG(BPF_MOV, R0, R1),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R0, 1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 1,\n\t},\n\t{\n\t\t\"Tail call 2\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 2),\n\t\t\tTAIL_CALL(-1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 3,\n\t},\n\t{\n\t\t\"Tail call 3\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 3),\n\t\t\tTAIL_CALL(-1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 6,\n\t},\n\t{\n\t\t\"Tail call 4\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R1, 4),\n\t\t\tTAIL_CALL(-1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 10,\n\t},\n\t{\n\t\t\"Tail call load/store leaf\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R1, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R2, 2),\n\t\t\tBPF_ALU64_REG(BPF_MOV, R3, BPF_REG_FP),\n\t\t\tBPF_STX_MEM(BPF_DW, R3, R1, -8),\n\t\t\tBPF_STX_MEM(BPF_DW, R3, R2, -16),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, BPF_REG_FP, -8),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R1, 3),\n\t\t\tBPF_LDX_MEM(BPF_DW, R0, BPF_REG_FP, -16),\n\t\t\tBPF_JMP_REG(BPF_JNE, R0, R2, 1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 0,\n\t\t.stack_depth = 32,\n\t},\n\t{\n\t\t\"Tail call load/store\",\n\t\t.insns = {\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, 3),\n\t\t\tBPF_STX_MEM(BPF_DW, BPF_REG_FP, R0, -8),\n\t\t\tTAIL_CALL(-1),\n\t\t\tBPF_ALU64_IMM(BPF_MOV, R0, -1),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.result = 0,\n\t\t.stack_depth = 16,\n\t},\n\t{\n\t\t\"Tail call error path, max count reached\",\n\t\t.insns = {\n\t\t\tBPF_LDX_MEM(BPF_W, R2, R1, 0),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 1),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 0),\n\t\t\tTAIL_CALL(0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.flags = FLAG_NEED_STATE | FLAG_RESULT_IN_STATE,\n\t\t.result = (MAX_TAIL_CALL_CNT + 1) * MAX_TESTRUNS,\n\t},\n\t{\n\t\t\"Tail call count preserved across function calls\",\n\t\t.insns = {\n\t\t\tBPF_LDX_MEM(BPF_W, R2, R1, 0),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 1),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 0),\n\t\t\tBPF_STX_MEM(BPF_DW, R10, R1, -8),\n\t\t\tBPF_CALL_REL(BPF_FUNC_get_numa_node_id),\n\t\t\tBPF_CALL_REL(BPF_FUNC_ktime_get_ns),\n\t\t\tBPF_CALL_REL(BPF_FUNC_ktime_get_boot_ns),\n\t\t\tBPF_CALL_REL(BPF_FUNC_ktime_get_coarse_ns),\n\t\t\tBPF_CALL_REL(BPF_FUNC_jiffies64),\n\t\t\tBPF_CALL_REL(BPF_FUNC_test_func),\n\t\t\tBPF_LDX_MEM(BPF_DW, R1, R10, -8),\n\t\t\tBPF_ALU32_REG(BPF_MOV, R0, R1),\n\t\t\tTAIL_CALL(0),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.stack_depth = 8,\n\t\t.flags = FLAG_NEED_STATE | FLAG_RESULT_IN_STATE,\n\t\t.result = (MAX_TAIL_CALL_CNT + 1) * MAX_TESTRUNS,\n\t},\n\t{\n\t\t\"Tail call error path, NULL target\",\n\t\t.insns = {\n\t\t\tBPF_LDX_MEM(BPF_W, R2, R1, 0),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 1),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 0),\n\t\t\tTAIL_CALL(TAIL_CALL_NULL),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.flags = FLAG_NEED_STATE | FLAG_RESULT_IN_STATE,\n\t\t.result = MAX_TESTRUNS,\n\t},\n\t{\n\t\t\"Tail call error path, index out of range\",\n\t\t.insns = {\n\t\t\tBPF_LDX_MEM(BPF_W, R2, R1, 0),\n\t\t\tBPF_ALU64_IMM(BPF_ADD, R2, 1),\n\t\t\tBPF_STX_MEM(BPF_W, R1, R2, 0),\n\t\t\tTAIL_CALL(TAIL_CALL_INVALID),\n\t\t\tBPF_EXIT_INSN(),\n\t\t},\n\t\t.flags = FLAG_NEED_STATE | FLAG_RESULT_IN_STATE,\n\t\t.result = MAX_TESTRUNS,\n\t},\n};\n\nstatic void __init destroy_tail_call_tests(struct bpf_array *progs)\n{\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(tail_call_tests); i++)\n\t\tif (progs->ptrs[i])\n\t\t\tbpf_prog_free(progs->ptrs[i]);\n\tkfree(progs);\n}\n\nstatic __init int prepare_tail_call_tests(struct bpf_array **pprogs)\n{\n\tint ntests = ARRAY_SIZE(tail_call_tests);\n\tstruct bpf_array *progs;\n\tint which, err;\n\n\t \n\tprogs = kzalloc(struct_size(progs, ptrs, ntests + 1), GFP_KERNEL);\n\tif (!progs)\n\t\tgoto out_nomem;\n\n\t \n\tfor (which = 0; which < ntests; which++) {\n\t\tstruct tail_call_test *test = &tail_call_tests[which];\n\t\tstruct bpf_prog *fp;\n\t\tint len, i;\n\n\t\t \n\t\tfor (len = 0; len < MAX_INSNS; len++) {\n\t\t\tstruct bpf_insn *insn = &test->insns[len];\n\n\t\t\tif (len < MAX_INSNS - 1 &&\n\t\t\t    insn->code == (BPF_LD | BPF_DW | BPF_IMM))\n\t\t\t\tlen++;\n\t\t\tif (insn->code == 0)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t \n\t\tfp = bpf_prog_alloc(bpf_prog_size(len), 0);\n\t\tif (!fp)\n\t\t\tgoto out_nomem;\n\n\t\tfp->len = len;\n\t\tfp->type = BPF_PROG_TYPE_SOCKET_FILTER;\n\t\tfp->aux->stack_depth = test->stack_depth;\n\t\tmemcpy(fp->insnsi, test->insns, len * sizeof(struct bpf_insn));\n\n\t\t \n\t\tfor (i = 0; i < len; i++) {\n\t\t\tstruct bpf_insn *insn = &fp->insnsi[i];\n\t\t\tlong addr = 0;\n\n\t\t\tswitch (insn->code) {\n\t\t\tcase BPF_LD | BPF_DW | BPF_IMM:\n\t\t\t\tif (insn->imm != TAIL_CALL_MARKER)\n\t\t\t\t\tbreak;\n\t\t\t\tinsn[0].imm = (u32)(long)progs;\n\t\t\t\tinsn[1].imm = ((u64)(long)progs) >> 32;\n\t\t\t\tbreak;\n\n\t\t\tcase BPF_ALU | BPF_MOV | BPF_K:\n\t\t\t\tif (insn->imm != TAIL_CALL_MARKER)\n\t\t\t\t\tbreak;\n\t\t\t\tif (insn->off == TAIL_CALL_NULL)\n\t\t\t\t\tinsn->imm = ntests;\n\t\t\t\telse if (insn->off == TAIL_CALL_INVALID)\n\t\t\t\t\tinsn->imm = ntests + 1;\n\t\t\t\telse\n\t\t\t\t\tinsn->imm = which + insn->off;\n\t\t\t\tinsn->off = 0;\n\t\t\t\tbreak;\n\n\t\t\tcase BPF_JMP | BPF_CALL:\n\t\t\t\tif (insn->src_reg != BPF_PSEUDO_CALL)\n\t\t\t\t\tbreak;\n\t\t\t\tswitch (insn->imm) {\n\t\t\t\tcase BPF_FUNC_get_numa_node_id:\n\t\t\t\t\taddr = (long)&numa_node_id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase BPF_FUNC_ktime_get_ns:\n\t\t\t\t\taddr = (long)&ktime_get_ns;\n\t\t\t\t\tbreak;\n\t\t\t\tcase BPF_FUNC_ktime_get_boot_ns:\n\t\t\t\t\taddr = (long)&ktime_get_boot_fast_ns;\n\t\t\t\t\tbreak;\n\t\t\t\tcase BPF_FUNC_ktime_get_coarse_ns:\n\t\t\t\t\taddr = (long)&ktime_get_coarse_ns;\n\t\t\t\t\tbreak;\n\t\t\t\tcase BPF_FUNC_jiffies64:\n\t\t\t\t\taddr = (long)&get_jiffies_64;\n\t\t\t\t\tbreak;\n\t\t\t\tcase BPF_FUNC_test_func:\n\t\t\t\t\taddr = (long)&bpf_test_func;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\terr = -EFAULT;\n\t\t\t\t\tgoto out_err;\n\t\t\t\t}\n\t\t\t\t*insn = BPF_EMIT_CALL(addr);\n\t\t\t\tif ((long)__bpf_call_base + insn->imm != addr)\n\t\t\t\t\t*insn = BPF_JMP_A(0);  \n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfp = bpf_prog_select_runtime(fp, &err);\n\t\tif (err)\n\t\t\tgoto out_err;\n\n\t\tprogs->ptrs[which] = fp;\n\t}\n\n\t \n\tprogs->map.max_entries = ntests + 1;\n\t*pprogs = progs;\n\treturn 0;\n\nout_nomem:\n\terr = -ENOMEM;\n\nout_err:\n\tif (progs)\n\t\tdestroy_tail_call_tests(progs);\n\treturn err;\n}\n\nstatic __init int test_tail_calls(struct bpf_array *progs)\n{\n\tint i, err_cnt = 0, pass_cnt = 0;\n\tint jit_cnt = 0, run_cnt = 0;\n\n\tfor (i = 0; i < ARRAY_SIZE(tail_call_tests); i++) {\n\t\tstruct tail_call_test *test = &tail_call_tests[i];\n\t\tstruct bpf_prog *fp = progs->ptrs[i];\n\t\tint *data = NULL;\n\t\tint state = 0;\n\t\tu64 duration;\n\t\tint ret;\n\n\t\tcond_resched();\n\t\tif (exclude_test(i))\n\t\t\tcontinue;\n\n\t\tpr_info(\"#%d %s \", i, test->descr);\n\t\tif (!fp) {\n\t\t\terr_cnt++;\n\t\t\tcontinue;\n\t\t}\n\t\tpr_cont(\"jited:%u \", fp->jited);\n\n\t\trun_cnt++;\n\t\tif (fp->jited)\n\t\t\tjit_cnt++;\n\n\t\tif (test->flags & FLAG_NEED_STATE)\n\t\t\tdata = &state;\n\t\tret = __run_one(fp, data, MAX_TESTRUNS, &duration);\n\t\tif (test->flags & FLAG_RESULT_IN_STATE)\n\t\t\tret = state;\n\t\tif (ret == test->result) {\n\t\t\tpr_cont(\"%lld PASS\", duration);\n\t\t\tpass_cnt++;\n\t\t} else {\n\t\t\tpr_cont(\"ret %d != %d FAIL\", ret, test->result);\n\t\t\terr_cnt++;\n\t\t}\n\t}\n\n\tpr_info(\"%s: Summary: %d PASSED, %d FAILED, [%d/%d JIT'ed]\\n\",\n\t\t__func__, pass_cnt, err_cnt, jit_cnt, run_cnt);\n\n\treturn err_cnt ? -EINVAL : 0;\n}\n\nstatic char test_suite[32];\nmodule_param_string(test_suite, test_suite, sizeof(test_suite), 0);\n\nstatic __init int find_test_index(const char *test_name)\n{\n\tint i;\n\n\tif (!strcmp(test_suite, \"test_bpf\")) {\n\t\tfor (i = 0; i < ARRAY_SIZE(tests); i++) {\n\t\t\tif (!strcmp(tests[i].descr, test_name))\n\t\t\t\treturn i;\n\t\t}\n\t}\n\n\tif (!strcmp(test_suite, \"test_tail_calls\")) {\n\t\tfor (i = 0; i < ARRAY_SIZE(tail_call_tests); i++) {\n\t\t\tif (!strcmp(tail_call_tests[i].descr, test_name))\n\t\t\t\treturn i;\n\t\t}\n\t}\n\n\tif (!strcmp(test_suite, \"test_skb_segment\")) {\n\t\tfor (i = 0; i < ARRAY_SIZE(skb_segment_tests); i++) {\n\t\t\tif (!strcmp(skb_segment_tests[i].descr, test_name))\n\t\t\t\treturn i;\n\t\t}\n\t}\n\n\treturn -1;\n}\n\nstatic __init int prepare_test_range(void)\n{\n\tint valid_range;\n\n\tif (!strcmp(test_suite, \"test_bpf\"))\n\t\tvalid_range = ARRAY_SIZE(tests);\n\telse if (!strcmp(test_suite, \"test_tail_calls\"))\n\t\tvalid_range = ARRAY_SIZE(tail_call_tests);\n\telse if (!strcmp(test_suite, \"test_skb_segment\"))\n\t\tvalid_range = ARRAY_SIZE(skb_segment_tests);\n\telse\n\t\treturn 0;\n\n\tif (test_id >= 0) {\n\t\t \n\t\tif (test_id >= valid_range) {\n\t\t\tpr_err(\"test_bpf: invalid test_id specified for '%s' suite.\\n\",\n\t\t\t       test_suite);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\ttest_range[0] = test_id;\n\t\ttest_range[1] = test_id;\n\t} else if (*test_name) {\n\t\t \n\t\tint idx = find_test_index(test_name);\n\n\t\tif (idx < 0) {\n\t\t\tpr_err(\"test_bpf: no test named '%s' found for '%s' suite.\\n\",\n\t\t\t       test_name, test_suite);\n\t\t\treturn -EINVAL;\n\t\t}\n\t\ttest_range[0] = idx;\n\t\ttest_range[1] = idx;\n\t} else if (test_range[0] != 0 || test_range[1] != INT_MAX) {\n\t\t \n\t\tif (test_range[0] < 0 || test_range[1] >= valid_range) {\n\t\t\tpr_err(\"test_bpf: test_range is out of bound for '%s' suite.\\n\",\n\t\t\t       test_suite);\n\t\t\treturn -EINVAL;\n\t\t}\n\n\t\tif (test_range[1] < test_range[0]) {\n\t\t\tpr_err(\"test_bpf: test_range is ending before it starts.\\n\");\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int __init test_bpf_init(void)\n{\n\tstruct bpf_array *progs = NULL;\n\tint ret;\n\n\tif (strlen(test_suite) &&\n\t    strcmp(test_suite, \"test_bpf\") &&\n\t    strcmp(test_suite, \"test_tail_calls\") &&\n\t    strcmp(test_suite, \"test_skb_segment\")) {\n\t\tpr_err(\"test_bpf: invalid test_suite '%s' specified.\\n\", test_suite);\n\t\treturn -EINVAL;\n\t}\n\n\t \n\tif (!strlen(test_suite) &&\n\t    (test_id != -1 || strlen(test_name) ||\n\t    (test_range[0] != 0 || test_range[1] != INT_MAX))) {\n\t\tpr_info(\"test_bpf: set 'test_bpf' as the default test_suite.\\n\");\n\t\tstrscpy(test_suite, \"test_bpf\", sizeof(test_suite));\n\t}\n\n\tret = prepare_test_range();\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!strlen(test_suite) || !strcmp(test_suite, \"test_bpf\")) {\n\t\tret = test_bpf();\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tif (!strlen(test_suite) || !strcmp(test_suite, \"test_tail_calls\")) {\n\t\tret = prepare_tail_call_tests(&progs);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = test_tail_calls(progs);\n\t\tdestroy_tail_call_tests(progs);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tif (!strlen(test_suite) || !strcmp(test_suite, \"test_skb_segment\"))\n\t\treturn test_skb_segment();\n\n\treturn 0;\n}\n\nstatic void __exit test_bpf_exit(void)\n{\n}\n\nmodule_init(test_bpf_init);\nmodule_exit(test_bpf_exit);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}