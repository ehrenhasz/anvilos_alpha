{
  "module_name": "curve25519-fiat32.c",
  "hash_id": "b8b56f32bfc6bcb8151f66ab384bc7e0a01d1fda1f2fb3a1970ecf93364982c5",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/curve25519-fiat32.c",
  "human_readable_source": "\n \n\n#include <asm/unaligned.h>\n#include <crypto/curve25519.h>\n#include <linux/string.h>\n\n \ntypedef struct fe { u32 v[10]; } fe;\n\n \ntypedef struct fe_loose { u32 v[10]; } fe_loose;\n\nstatic __always_inline void fe_frombytes_impl(u32 h[10], const u8 *s)\n{\n\t \n\tu32 a0 = get_unaligned_le32(s);\n\tu32 a1 = get_unaligned_le32(s+4);\n\tu32 a2 = get_unaligned_le32(s+8);\n\tu32 a3 = get_unaligned_le32(s+12);\n\tu32 a4 = get_unaligned_le32(s+16);\n\tu32 a5 = get_unaligned_le32(s+20);\n\tu32 a6 = get_unaligned_le32(s+24);\n\tu32 a7 = get_unaligned_le32(s+28);\n\th[0] = a0&((1<<26)-1);                     \n\th[1] = (a0>>26) | ((a1&((1<<19)-1))<< 6);  \n\th[2] = (a1>>19) | ((a2&((1<<13)-1))<<13);  \n\th[3] = (a2>>13) | ((a3&((1<< 6)-1))<<19);  \n\th[4] = (a3>> 6);                           \n\th[5] = a4&((1<<25)-1);                     \n\th[6] = (a4>>25) | ((a5&((1<<19)-1))<< 7);  \n\th[7] = (a5>>19) | ((a6&((1<<12)-1))<<13);  \n\th[8] = (a6>>12) | ((a7&((1<< 6)-1))<<20);  \n\th[9] = (a7>> 6)&((1<<25)-1);  \n}\n\nstatic __always_inline void fe_frombytes(fe *h, const u8 *s)\n{\n\tfe_frombytes_impl(h->v, s);\n}\n\nstatic __always_inline u8  \naddcarryx_u25(u8   c, u32 a, u32 b, u32 *low)\n{\n\t \n\tu32 x = a + b + c;\n\t*low = x & ((1 << 25) - 1);\n\treturn (x >> 25) & 1;\n}\n\nstatic __always_inline u8  \naddcarryx_u26(u8   c, u32 a, u32 b, u32 *low)\n{\n\t \n\tu32 x = a + b + c;\n\t*low = x & ((1 << 26) - 1);\n\treturn (x >> 26) & 1;\n}\n\nstatic __always_inline u8  \nsubborrow_u25(u8   c, u32 a, u32 b, u32 *low)\n{\n\t \n\tu32 x = a - b - c;\n\t*low = x & ((1 << 25) - 1);\n\treturn x >> 31;\n}\n\nstatic __always_inline u8  \nsubborrow_u26(u8   c, u32 a, u32 b, u32 *low)\n{\n\t \n\tu32 x = a - b - c;\n\t*low = x & ((1 << 26) - 1);\n\treturn x >> 31;\n}\n\nstatic __always_inline u32 cmovznz32(u32 t, u32 z, u32 nz)\n{\n\tt = -!!t;  \n\treturn (t&nz) | ((~t)&z);\n}\n\nstatic __always_inline void fe_freeze(u32 out[10], const u32 in1[10])\n{\n\t{ const u32 x17 = in1[9];\n\t{ const u32 x18 = in1[8];\n\t{ const u32 x16 = in1[7];\n\t{ const u32 x14 = in1[6];\n\t{ const u32 x12 = in1[5];\n\t{ const u32 x10 = in1[4];\n\t{ const u32 x8 = in1[3];\n\t{ const u32 x6 = in1[2];\n\t{ const u32 x4 = in1[1];\n\t{ const u32 x2 = in1[0];\n\t{ u32 x20; u8  x21 = subborrow_u26(0x0, x2, 0x3ffffed, &x20);\n\t{ u32 x23; u8  x24 = subborrow_u25(x21, x4, 0x1ffffff, &x23);\n\t{ u32 x26; u8  x27 = subborrow_u26(x24, x6, 0x3ffffff, &x26);\n\t{ u32 x29; u8  x30 = subborrow_u25(x27, x8, 0x1ffffff, &x29);\n\t{ u32 x32; u8  x33 = subborrow_u26(x30, x10, 0x3ffffff, &x32);\n\t{ u32 x35; u8  x36 = subborrow_u25(x33, x12, 0x1ffffff, &x35);\n\t{ u32 x38; u8  x39 = subborrow_u26(x36, x14, 0x3ffffff, &x38);\n\t{ u32 x41; u8  x42 = subborrow_u25(x39, x16, 0x1ffffff, &x41);\n\t{ u32 x44; u8  x45 = subborrow_u26(x42, x18, 0x3ffffff, &x44);\n\t{ u32 x47; u8  x48 = subborrow_u25(x45, x17, 0x1ffffff, &x47);\n\t{ u32 x49 = cmovznz32(x48, 0x0, 0xffffffff);\n\t{ u32 x50 = (x49 & 0x3ffffed);\n\t{ u32 x52; u8  x53 = addcarryx_u26(0x0, x20, x50, &x52);\n\t{ u32 x54 = (x49 & 0x1ffffff);\n\t{ u32 x56; u8  x57 = addcarryx_u25(x53, x23, x54, &x56);\n\t{ u32 x58 = (x49 & 0x3ffffff);\n\t{ u32 x60; u8  x61 = addcarryx_u26(x57, x26, x58, &x60);\n\t{ u32 x62 = (x49 & 0x1ffffff);\n\t{ u32 x64; u8  x65 = addcarryx_u25(x61, x29, x62, &x64);\n\t{ u32 x66 = (x49 & 0x3ffffff);\n\t{ u32 x68; u8  x69 = addcarryx_u26(x65, x32, x66, &x68);\n\t{ u32 x70 = (x49 & 0x1ffffff);\n\t{ u32 x72; u8  x73 = addcarryx_u25(x69, x35, x70, &x72);\n\t{ u32 x74 = (x49 & 0x3ffffff);\n\t{ u32 x76; u8  x77 = addcarryx_u26(x73, x38, x74, &x76);\n\t{ u32 x78 = (x49 & 0x1ffffff);\n\t{ u32 x80; u8  x81 = addcarryx_u25(x77, x41, x78, &x80);\n\t{ u32 x82 = (x49 & 0x3ffffff);\n\t{ u32 x84; u8  x85 = addcarryx_u26(x81, x44, x82, &x84);\n\t{ u32 x86 = (x49 & 0x1ffffff);\n\t{ u32 x88; addcarryx_u25(x85, x47, x86, &x88);\n\tout[0] = x52;\n\tout[1] = x56;\n\tout[2] = x60;\n\tout[3] = x64;\n\tout[4] = x68;\n\tout[5] = x72;\n\tout[6] = x76;\n\tout[7] = x80;\n\tout[8] = x84;\n\tout[9] = x88;\n\t}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}\n}\n\nstatic __always_inline void fe_tobytes(u8 s[32], const fe *f)\n{\n\tu32 h[10];\n\tfe_freeze(h, f->v);\n\ts[0] = h[0] >> 0;\n\ts[1] = h[0] >> 8;\n\ts[2] = h[0] >> 16;\n\ts[3] = (h[0] >> 24) | (h[1] << 2);\n\ts[4] = h[1] >> 6;\n\ts[5] = h[1] >> 14;\n\ts[6] = (h[1] >> 22) | (h[2] << 3);\n\ts[7] = h[2] >> 5;\n\ts[8] = h[2] >> 13;\n\ts[9] = (h[2] >> 21) | (h[3] << 5);\n\ts[10] = h[3] >> 3;\n\ts[11] = h[3] >> 11;\n\ts[12] = (h[3] >> 19) | (h[4] << 6);\n\ts[13] = h[4] >> 2;\n\ts[14] = h[4] >> 10;\n\ts[15] = h[4] >> 18;\n\ts[16] = h[5] >> 0;\n\ts[17] = h[5] >> 8;\n\ts[18] = h[5] >> 16;\n\ts[19] = (h[5] >> 24) | (h[6] << 1);\n\ts[20] = h[6] >> 7;\n\ts[21] = h[6] >> 15;\n\ts[22] = (h[6] >> 23) | (h[7] << 3);\n\ts[23] = h[7] >> 5;\n\ts[24] = h[7] >> 13;\n\ts[25] = (h[7] >> 21) | (h[8] << 4);\n\ts[26] = h[8] >> 4;\n\ts[27] = h[8] >> 12;\n\ts[28] = (h[8] >> 20) | (h[9] << 6);\n\ts[29] = h[9] >> 2;\n\ts[30] = h[9] >> 10;\n\ts[31] = h[9] >> 18;\n}\n\n \nstatic __always_inline void fe_copy(fe *h, const fe *f)\n{\n\tmemmove(h, f, sizeof(u32) * 10);\n}\n\nstatic __always_inline void fe_copy_lt(fe_loose *h, const fe *f)\n{\n\tmemmove(h, f, sizeof(u32) * 10);\n}\n\n \nstatic __always_inline void fe_0(fe *h)\n{\n\tmemset(h, 0, sizeof(u32) * 10);\n}\n\n \nstatic __always_inline void fe_1(fe *h)\n{\n\tmemset(h, 0, sizeof(u32) * 10);\n\th->v[0] = 1;\n}\n\nstatic noinline void fe_add_impl(u32 out[10], const u32 in1[10], const u32 in2[10])\n{\n\t{ const u32 x20 = in1[9];\n\t{ const u32 x21 = in1[8];\n\t{ const u32 x19 = in1[7];\n\t{ const u32 x17 = in1[6];\n\t{ const u32 x15 = in1[5];\n\t{ const u32 x13 = in1[4];\n\t{ const u32 x11 = in1[3];\n\t{ const u32 x9 = in1[2];\n\t{ const u32 x7 = in1[1];\n\t{ const u32 x5 = in1[0];\n\t{ const u32 x38 = in2[9];\n\t{ const u32 x39 = in2[8];\n\t{ const u32 x37 = in2[7];\n\t{ const u32 x35 = in2[6];\n\t{ const u32 x33 = in2[5];\n\t{ const u32 x31 = in2[4];\n\t{ const u32 x29 = in2[3];\n\t{ const u32 x27 = in2[2];\n\t{ const u32 x25 = in2[1];\n\t{ const u32 x23 = in2[0];\n\tout[0] = (x5 + x23);\n\tout[1] = (x7 + x25);\n\tout[2] = (x9 + x27);\n\tout[3] = (x11 + x29);\n\tout[4] = (x13 + x31);\n\tout[5] = (x15 + x33);\n\tout[6] = (x17 + x35);\n\tout[7] = (x19 + x37);\n\tout[8] = (x21 + x39);\n\tout[9] = (x20 + x38);\n\t}}}}}}}}}}}}}}}}}}}}\n}\n\n \nstatic __always_inline void fe_add(fe_loose *h, const fe *f, const fe *g)\n{\n\tfe_add_impl(h->v, f->v, g->v);\n}\n\nstatic noinline void fe_sub_impl(u32 out[10], const u32 in1[10], const u32 in2[10])\n{\n\t{ const u32 x20 = in1[9];\n\t{ const u32 x21 = in1[8];\n\t{ const u32 x19 = in1[7];\n\t{ const u32 x17 = in1[6];\n\t{ const u32 x15 = in1[5];\n\t{ const u32 x13 = in1[4];\n\t{ const u32 x11 = in1[3];\n\t{ const u32 x9 = in1[2];\n\t{ const u32 x7 = in1[1];\n\t{ const u32 x5 = in1[0];\n\t{ const u32 x38 = in2[9];\n\t{ const u32 x39 = in2[8];\n\t{ const u32 x37 = in2[7];\n\t{ const u32 x35 = in2[6];\n\t{ const u32 x33 = in2[5];\n\t{ const u32 x31 = in2[4];\n\t{ const u32 x29 = in2[3];\n\t{ const u32 x27 = in2[2];\n\t{ const u32 x25 = in2[1];\n\t{ const u32 x23 = in2[0];\n\tout[0] = ((0x7ffffda + x5) - x23);\n\tout[1] = ((0x3fffffe + x7) - x25);\n\tout[2] = ((0x7fffffe + x9) - x27);\n\tout[3] = ((0x3fffffe + x11) - x29);\n\tout[4] = ((0x7fffffe + x13) - x31);\n\tout[5] = ((0x3fffffe + x15) - x33);\n\tout[6] = ((0x7fffffe + x17) - x35);\n\tout[7] = ((0x3fffffe + x19) - x37);\n\tout[8] = ((0x7fffffe + x21) - x39);\n\tout[9] = ((0x3fffffe + x20) - x38);\n\t}}}}}}}}}}}}}}}}}}}}\n}\n\n \nstatic __always_inline void fe_sub(fe_loose *h, const fe *f, const fe *g)\n{\n\tfe_sub_impl(h->v, f->v, g->v);\n}\n\nstatic noinline void fe_mul_impl(u32 out[10], const u32 in1[10], const u32 in2[10])\n{\n\t{ const u32 x20 = in1[9];\n\t{ const u32 x21 = in1[8];\n\t{ const u32 x19 = in1[7];\n\t{ const u32 x17 = in1[6];\n\t{ const u32 x15 = in1[5];\n\t{ const u32 x13 = in1[4];\n\t{ const u32 x11 = in1[3];\n\t{ const u32 x9 = in1[2];\n\t{ const u32 x7 = in1[1];\n\t{ const u32 x5 = in1[0];\n\t{ const u32 x38 = in2[9];\n\t{ const u32 x39 = in2[8];\n\t{ const u32 x37 = in2[7];\n\t{ const u32 x35 = in2[6];\n\t{ const u32 x33 = in2[5];\n\t{ const u32 x31 = in2[4];\n\t{ const u32 x29 = in2[3];\n\t{ const u32 x27 = in2[2];\n\t{ const u32 x25 = in2[1];\n\t{ const u32 x23 = in2[0];\n\t{ u64 x40 = ((u64)x23 * x5);\n\t{ u64 x41 = (((u64)x23 * x7) + ((u64)x25 * x5));\n\t{ u64 x42 = ((((u64)(0x2 * x25) * x7) + ((u64)x23 * x9)) + ((u64)x27 * x5));\n\t{ u64 x43 = (((((u64)x25 * x9) + ((u64)x27 * x7)) + ((u64)x23 * x11)) + ((u64)x29 * x5));\n\t{ u64 x44 = (((((u64)x27 * x9) + (0x2 * (((u64)x25 * x11) + ((u64)x29 * x7)))) + ((u64)x23 * x13)) + ((u64)x31 * x5));\n\t{ u64 x45 = (((((((u64)x27 * x11) + ((u64)x29 * x9)) + ((u64)x25 * x13)) + ((u64)x31 * x7)) + ((u64)x23 * x15)) + ((u64)x33 * x5));\n\t{ u64 x46 = (((((0x2 * ((((u64)x29 * x11) + ((u64)x25 * x15)) + ((u64)x33 * x7))) + ((u64)x27 * x13)) + ((u64)x31 * x9)) + ((u64)x23 * x17)) + ((u64)x35 * x5));\n\t{ u64 x47 = (((((((((u64)x29 * x13) + ((u64)x31 * x11)) + ((u64)x27 * x15)) + ((u64)x33 * x9)) + ((u64)x25 * x17)) + ((u64)x35 * x7)) + ((u64)x23 * x19)) + ((u64)x37 * x5));\n\t{ u64 x48 = (((((((u64)x31 * x13) + (0x2 * (((((u64)x29 * x15) + ((u64)x33 * x11)) + ((u64)x25 * x19)) + ((u64)x37 * x7)))) + ((u64)x27 * x17)) + ((u64)x35 * x9)) + ((u64)x23 * x21)) + ((u64)x39 * x5));\n\t{ u64 x49 = (((((((((((u64)x31 * x15) + ((u64)x33 * x13)) + ((u64)x29 * x17)) + ((u64)x35 * x11)) + ((u64)x27 * x19)) + ((u64)x37 * x9)) + ((u64)x25 * x21)) + ((u64)x39 * x7)) + ((u64)x23 * x20)) + ((u64)x38 * x5));\n\t{ u64 x50 = (((((0x2 * ((((((u64)x33 * x15) + ((u64)x29 * x19)) + ((u64)x37 * x11)) + ((u64)x25 * x20)) + ((u64)x38 * x7))) + ((u64)x31 * x17)) + ((u64)x35 * x13)) + ((u64)x27 * x21)) + ((u64)x39 * x9));\n\t{ u64 x51 = (((((((((u64)x33 * x17) + ((u64)x35 * x15)) + ((u64)x31 * x19)) + ((u64)x37 * x13)) + ((u64)x29 * x21)) + ((u64)x39 * x11)) + ((u64)x27 * x20)) + ((u64)x38 * x9));\n\t{ u64 x52 = (((((u64)x35 * x17) + (0x2 * (((((u64)x33 * x19) + ((u64)x37 * x15)) + ((u64)x29 * x20)) + ((u64)x38 * x11)))) + ((u64)x31 * x21)) + ((u64)x39 * x13));\n\t{ u64 x53 = (((((((u64)x35 * x19) + ((u64)x37 * x17)) + ((u64)x33 * x21)) + ((u64)x39 * x15)) + ((u64)x31 * x20)) + ((u64)x38 * x13));\n\t{ u64 x54 = (((0x2 * ((((u64)x37 * x19) + ((u64)x33 * x20)) + ((u64)x38 * x15))) + ((u64)x35 * x21)) + ((u64)x39 * x17));\n\t{ u64 x55 = (((((u64)x37 * x21) + ((u64)x39 * x19)) + ((u64)x35 * x20)) + ((u64)x38 * x17));\n\t{ u64 x56 = (((u64)x39 * x21) + (0x2 * (((u64)x37 * x20) + ((u64)x38 * x19))));\n\t{ u64 x57 = (((u64)x39 * x20) + ((u64)x38 * x21));\n\t{ u64 x58 = ((u64)(0x2 * x38) * x20);\n\t{ u64 x59 = (x48 + (x58 << 0x4));\n\t{ u64 x60 = (x59 + (x58 << 0x1));\n\t{ u64 x61 = (x60 + x58);\n\t{ u64 x62 = (x47 + (x57 << 0x4));\n\t{ u64 x63 = (x62 + (x57 << 0x1));\n\t{ u64 x64 = (x63 + x57);\n\t{ u64 x65 = (x46 + (x56 << 0x4));\n\t{ u64 x66 = (x65 + (x56 << 0x1));\n\t{ u64 x67 = (x66 + x56);\n\t{ u64 x68 = (x45 + (x55 << 0x4));\n\t{ u64 x69 = (x68 + (x55 << 0x1));\n\t{ u64 x70 = (x69 + x55);\n\t{ u64 x71 = (x44 + (x54 << 0x4));\n\t{ u64 x72 = (x71 + (x54 << 0x1));\n\t{ u64 x73 = (x72 + x54);\n\t{ u64 x74 = (x43 + (x53 << 0x4));\n\t{ u64 x75 = (x74 + (x53 << 0x1));\n\t{ u64 x76 = (x75 + x53);\n\t{ u64 x77 = (x42 + (x52 << 0x4));\n\t{ u64 x78 = (x77 + (x52 << 0x1));\n\t{ u64 x79 = (x78 + x52);\n\t{ u64 x80 = (x41 + (x51 << 0x4));\n\t{ u64 x81 = (x80 + (x51 << 0x1));\n\t{ u64 x82 = (x81 + x51);\n\t{ u64 x83 = (x40 + (x50 << 0x4));\n\t{ u64 x84 = (x83 + (x50 << 0x1));\n\t{ u64 x85 = (x84 + x50);\n\t{ u64 x86 = (x85 >> 0x1a);\n\t{ u32 x87 = ((u32)x85 & 0x3ffffff);\n\t{ u64 x88 = (x86 + x82);\n\t{ u64 x89 = (x88 >> 0x19);\n\t{ u32 x90 = ((u32)x88 & 0x1ffffff);\n\t{ u64 x91 = (x89 + x79);\n\t{ u64 x92 = (x91 >> 0x1a);\n\t{ u32 x93 = ((u32)x91 & 0x3ffffff);\n\t{ u64 x94 = (x92 + x76);\n\t{ u64 x95 = (x94 >> 0x19);\n\t{ u32 x96 = ((u32)x94 & 0x1ffffff);\n\t{ u64 x97 = (x95 + x73);\n\t{ u64 x98 = (x97 >> 0x1a);\n\t{ u32 x99 = ((u32)x97 & 0x3ffffff);\n\t{ u64 x100 = (x98 + x70);\n\t{ u64 x101 = (x100 >> 0x19);\n\t{ u32 x102 = ((u32)x100 & 0x1ffffff);\n\t{ u64 x103 = (x101 + x67);\n\t{ u64 x104 = (x103 >> 0x1a);\n\t{ u32 x105 = ((u32)x103 & 0x3ffffff);\n\t{ u64 x106 = (x104 + x64);\n\t{ u64 x107 = (x106 >> 0x19);\n\t{ u32 x108 = ((u32)x106 & 0x1ffffff);\n\t{ u64 x109 = (x107 + x61);\n\t{ u64 x110 = (x109 >> 0x1a);\n\t{ u32 x111 = ((u32)x109 & 0x3ffffff);\n\t{ u64 x112 = (x110 + x49);\n\t{ u64 x113 = (x112 >> 0x19);\n\t{ u32 x114 = ((u32)x112 & 0x1ffffff);\n\t{ u64 x115 = (x87 + (0x13 * x113));\n\t{ u32 x116 = (u32) (x115 >> 0x1a);\n\t{ u32 x117 = ((u32)x115 & 0x3ffffff);\n\t{ u32 x118 = (x116 + x90);\n\t{ u32 x119 = (x118 >> 0x19);\n\t{ u32 x120 = (x118 & 0x1ffffff);\n\tout[0] = x117;\n\tout[1] = x120;\n\tout[2] = (x119 + x93);\n\tout[3] = x96;\n\tout[4] = x99;\n\tout[5] = x102;\n\tout[6] = x105;\n\tout[7] = x108;\n\tout[8] = x111;\n\tout[9] = x114;\n\t}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}\n}\n\nstatic __always_inline void fe_mul_ttt(fe *h, const fe *f, const fe *g)\n{\n\tfe_mul_impl(h->v, f->v, g->v);\n}\n\nstatic __always_inline void fe_mul_tlt(fe *h, const fe_loose *f, const fe *g)\n{\n\tfe_mul_impl(h->v, f->v, g->v);\n}\n\nstatic __always_inline void\nfe_mul_tll(fe *h, const fe_loose *f, const fe_loose *g)\n{\n\tfe_mul_impl(h->v, f->v, g->v);\n}\n\nstatic noinline void fe_sqr_impl(u32 out[10], const u32 in1[10])\n{\n\t{ const u32 x17 = in1[9];\n\t{ const u32 x18 = in1[8];\n\t{ const u32 x16 = in1[7];\n\t{ const u32 x14 = in1[6];\n\t{ const u32 x12 = in1[5];\n\t{ const u32 x10 = in1[4];\n\t{ const u32 x8 = in1[3];\n\t{ const u32 x6 = in1[2];\n\t{ const u32 x4 = in1[1];\n\t{ const u32 x2 = in1[0];\n\t{ u64 x19 = ((u64)x2 * x2);\n\t{ u64 x20 = ((u64)(0x2 * x2) * x4);\n\t{ u64 x21 = (0x2 * (((u64)x4 * x4) + ((u64)x2 * x6)));\n\t{ u64 x22 = (0x2 * (((u64)x4 * x6) + ((u64)x2 * x8)));\n\t{ u64 x23 = ((((u64)x6 * x6) + ((u64)(0x4 * x4) * x8)) + ((u64)(0x2 * x2) * x10));\n\t{ u64 x24 = (0x2 * ((((u64)x6 * x8) + ((u64)x4 * x10)) + ((u64)x2 * x12)));\n\t{ u64 x25 = (0x2 * (((((u64)x8 * x8) + ((u64)x6 * x10)) + ((u64)x2 * x14)) + ((u64)(0x2 * x4) * x12)));\n\t{ u64 x26 = (0x2 * (((((u64)x8 * x10) + ((u64)x6 * x12)) + ((u64)x4 * x14)) + ((u64)x2 * x16)));\n\t{ u64 x27 = (((u64)x10 * x10) + (0x2 * ((((u64)x6 * x14) + ((u64)x2 * x18)) + (0x2 * (((u64)x4 * x16) + ((u64)x8 * x12))))));\n\t{ u64 x28 = (0x2 * ((((((u64)x10 * x12) + ((u64)x8 * x14)) + ((u64)x6 * x16)) + ((u64)x4 * x18)) + ((u64)x2 * x17)));\n\t{ u64 x29 = (0x2 * (((((u64)x12 * x12) + ((u64)x10 * x14)) + ((u64)x6 * x18)) + (0x2 * (((u64)x8 * x16) + ((u64)x4 * x17)))));\n\t{ u64 x30 = (0x2 * (((((u64)x12 * x14) + ((u64)x10 * x16)) + ((u64)x8 * x18)) + ((u64)x6 * x17)));\n\t{ u64 x31 = (((u64)x14 * x14) + (0x2 * (((u64)x10 * x18) + (0x2 * (((u64)x12 * x16) + ((u64)x8 * x17))))));\n\t{ u64 x32 = (0x2 * ((((u64)x14 * x16) + ((u64)x12 * x18)) + ((u64)x10 * x17)));\n\t{ u64 x33 = (0x2 * ((((u64)x16 * x16) + ((u64)x14 * x18)) + ((u64)(0x2 * x12) * x17)));\n\t{ u64 x34 = (0x2 * (((u64)x16 * x18) + ((u64)x14 * x17)));\n\t{ u64 x35 = (((u64)x18 * x18) + ((u64)(0x4 * x16) * x17));\n\t{ u64 x36 = ((u64)(0x2 * x18) * x17);\n\t{ u64 x37 = ((u64)(0x2 * x17) * x17);\n\t{ u64 x38 = (x27 + (x37 << 0x4));\n\t{ u64 x39 = (x38 + (x37 << 0x1));\n\t{ u64 x40 = (x39 + x37);\n\t{ u64 x41 = (x26 + (x36 << 0x4));\n\t{ u64 x42 = (x41 + (x36 << 0x1));\n\t{ u64 x43 = (x42 + x36);\n\t{ u64 x44 = (x25 + (x35 << 0x4));\n\t{ u64 x45 = (x44 + (x35 << 0x1));\n\t{ u64 x46 = (x45 + x35);\n\t{ u64 x47 = (x24 + (x34 << 0x4));\n\t{ u64 x48 = (x47 + (x34 << 0x1));\n\t{ u64 x49 = (x48 + x34);\n\t{ u64 x50 = (x23 + (x33 << 0x4));\n\t{ u64 x51 = (x50 + (x33 << 0x1));\n\t{ u64 x52 = (x51 + x33);\n\t{ u64 x53 = (x22 + (x32 << 0x4));\n\t{ u64 x54 = (x53 + (x32 << 0x1));\n\t{ u64 x55 = (x54 + x32);\n\t{ u64 x56 = (x21 + (x31 << 0x4));\n\t{ u64 x57 = (x56 + (x31 << 0x1));\n\t{ u64 x58 = (x57 + x31);\n\t{ u64 x59 = (x20 + (x30 << 0x4));\n\t{ u64 x60 = (x59 + (x30 << 0x1));\n\t{ u64 x61 = (x60 + x30);\n\t{ u64 x62 = (x19 + (x29 << 0x4));\n\t{ u64 x63 = (x62 + (x29 << 0x1));\n\t{ u64 x64 = (x63 + x29);\n\t{ u64 x65 = (x64 >> 0x1a);\n\t{ u32 x66 = ((u32)x64 & 0x3ffffff);\n\t{ u64 x67 = (x65 + x61);\n\t{ u64 x68 = (x67 >> 0x19);\n\t{ u32 x69 = ((u32)x67 & 0x1ffffff);\n\t{ u64 x70 = (x68 + x58);\n\t{ u64 x71 = (x70 >> 0x1a);\n\t{ u32 x72 = ((u32)x70 & 0x3ffffff);\n\t{ u64 x73 = (x71 + x55);\n\t{ u64 x74 = (x73 >> 0x19);\n\t{ u32 x75 = ((u32)x73 & 0x1ffffff);\n\t{ u64 x76 = (x74 + x52);\n\t{ u64 x77 = (x76 >> 0x1a);\n\t{ u32 x78 = ((u32)x76 & 0x3ffffff);\n\t{ u64 x79 = (x77 + x49);\n\t{ u64 x80 = (x79 >> 0x19);\n\t{ u32 x81 = ((u32)x79 & 0x1ffffff);\n\t{ u64 x82 = (x80 + x46);\n\t{ u64 x83 = (x82 >> 0x1a);\n\t{ u32 x84 = ((u32)x82 & 0x3ffffff);\n\t{ u64 x85 = (x83 + x43);\n\t{ u64 x86 = (x85 >> 0x19);\n\t{ u32 x87 = ((u32)x85 & 0x1ffffff);\n\t{ u64 x88 = (x86 + x40);\n\t{ u64 x89 = (x88 >> 0x1a);\n\t{ u32 x90 = ((u32)x88 & 0x3ffffff);\n\t{ u64 x91 = (x89 + x28);\n\t{ u64 x92 = (x91 >> 0x19);\n\t{ u32 x93 = ((u32)x91 & 0x1ffffff);\n\t{ u64 x94 = (x66 + (0x13 * x92));\n\t{ u32 x95 = (u32) (x94 >> 0x1a);\n\t{ u32 x96 = ((u32)x94 & 0x3ffffff);\n\t{ u32 x97 = (x95 + x69);\n\t{ u32 x98 = (x97 >> 0x19);\n\t{ u32 x99 = (x97 & 0x1ffffff);\n\tout[0] = x96;\n\tout[1] = x99;\n\tout[2] = (x98 + x72);\n\tout[3] = x75;\n\tout[4] = x78;\n\tout[5] = x81;\n\tout[6] = x84;\n\tout[7] = x87;\n\tout[8] = x90;\n\tout[9] = x93;\n\t}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}\n}\n\nstatic __always_inline void fe_sq_tl(fe *h, const fe_loose *f)\n{\n\tfe_sqr_impl(h->v, f->v);\n}\n\nstatic __always_inline void fe_sq_tt(fe *h, const fe *f)\n{\n\tfe_sqr_impl(h->v, f->v);\n}\n\nstatic __always_inline void fe_loose_invert(fe *out, const fe_loose *z)\n{\n\tfe t0;\n\tfe t1;\n\tfe t2;\n\tfe t3;\n\tint i;\n\n\tfe_sq_tl(&t0, z);\n\tfe_sq_tt(&t1, &t0);\n\tfor (i = 1; i < 2; ++i)\n\t\tfe_sq_tt(&t1, &t1);\n\tfe_mul_tlt(&t1, z, &t1);\n\tfe_mul_ttt(&t0, &t0, &t1);\n\tfe_sq_tt(&t2, &t0);\n\tfe_mul_ttt(&t1, &t1, &t2);\n\tfe_sq_tt(&t2, &t1);\n\tfor (i = 1; i < 5; ++i)\n\t\tfe_sq_tt(&t2, &t2);\n\tfe_mul_ttt(&t1, &t2, &t1);\n\tfe_sq_tt(&t2, &t1);\n\tfor (i = 1; i < 10; ++i)\n\t\tfe_sq_tt(&t2, &t2);\n\tfe_mul_ttt(&t2, &t2, &t1);\n\tfe_sq_tt(&t3, &t2);\n\tfor (i = 1; i < 20; ++i)\n\t\tfe_sq_tt(&t3, &t3);\n\tfe_mul_ttt(&t2, &t3, &t2);\n\tfe_sq_tt(&t2, &t2);\n\tfor (i = 1; i < 10; ++i)\n\t\tfe_sq_tt(&t2, &t2);\n\tfe_mul_ttt(&t1, &t2, &t1);\n\tfe_sq_tt(&t2, &t1);\n\tfor (i = 1; i < 50; ++i)\n\t\tfe_sq_tt(&t2, &t2);\n\tfe_mul_ttt(&t2, &t2, &t1);\n\tfe_sq_tt(&t3, &t2);\n\tfor (i = 1; i < 100; ++i)\n\t\tfe_sq_tt(&t3, &t3);\n\tfe_mul_ttt(&t2, &t3, &t2);\n\tfe_sq_tt(&t2, &t2);\n\tfor (i = 1; i < 50; ++i)\n\t\tfe_sq_tt(&t2, &t2);\n\tfe_mul_ttt(&t1, &t2, &t1);\n\tfe_sq_tt(&t1, &t1);\n\tfor (i = 1; i < 5; ++i)\n\t\tfe_sq_tt(&t1, &t1);\n\tfe_mul_ttt(out, &t1, &t0);\n}\n\nstatic __always_inline void fe_invert(fe *out, const fe *z)\n{\n\tfe_loose l;\n\tfe_copy_lt(&l, z);\n\tfe_loose_invert(out, &l);\n}\n\n \nstatic noinline void fe_cswap(fe *f, fe *g, unsigned int b)\n{\n\tunsigned i;\n\tb = 0 - b;\n\tfor (i = 0; i < 10; i++) {\n\t\tu32 x = f->v[i] ^ g->v[i];\n\t\tx &= b;\n\t\tf->v[i] ^= x;\n\t\tg->v[i] ^= x;\n\t}\n}\n\n \nstatic __always_inline void fe_mul_121666_impl(u32 out[10], const u32 in1[10])\n{\n\t{ const u32 x20 = in1[9];\n\t{ const u32 x21 = in1[8];\n\t{ const u32 x19 = in1[7];\n\t{ const u32 x17 = in1[6];\n\t{ const u32 x15 = in1[5];\n\t{ const u32 x13 = in1[4];\n\t{ const u32 x11 = in1[3];\n\t{ const u32 x9 = in1[2];\n\t{ const u32 x7 = in1[1];\n\t{ const u32 x5 = in1[0];\n\t{ const u32 x38 = 0;\n\t{ const u32 x39 = 0;\n\t{ const u32 x37 = 0;\n\t{ const u32 x35 = 0;\n\t{ const u32 x33 = 0;\n\t{ const u32 x31 = 0;\n\t{ const u32 x29 = 0;\n\t{ const u32 x27 = 0;\n\t{ const u32 x25 = 0;\n\t{ const u32 x23 = 121666;\n\t{ u64 x40 = ((u64)x23 * x5);\n\t{ u64 x41 = (((u64)x23 * x7) + ((u64)x25 * x5));\n\t{ u64 x42 = ((((u64)(0x2 * x25) * x7) + ((u64)x23 * x9)) + ((u64)x27 * x5));\n\t{ u64 x43 = (((((u64)x25 * x9) + ((u64)x27 * x7)) + ((u64)x23 * x11)) + ((u64)x29 * x5));\n\t{ u64 x44 = (((((u64)x27 * x9) + (0x2 * (((u64)x25 * x11) + ((u64)x29 * x7)))) + ((u64)x23 * x13)) + ((u64)x31 * x5));\n\t{ u64 x45 = (((((((u64)x27 * x11) + ((u64)x29 * x9)) + ((u64)x25 * x13)) + ((u64)x31 * x7)) + ((u64)x23 * x15)) + ((u64)x33 * x5));\n\t{ u64 x46 = (((((0x2 * ((((u64)x29 * x11) + ((u64)x25 * x15)) + ((u64)x33 * x7))) + ((u64)x27 * x13)) + ((u64)x31 * x9)) + ((u64)x23 * x17)) + ((u64)x35 * x5));\n\t{ u64 x47 = (((((((((u64)x29 * x13) + ((u64)x31 * x11)) + ((u64)x27 * x15)) + ((u64)x33 * x9)) + ((u64)x25 * x17)) + ((u64)x35 * x7)) + ((u64)x23 * x19)) + ((u64)x37 * x5));\n\t{ u64 x48 = (((((((u64)x31 * x13) + (0x2 * (((((u64)x29 * x15) + ((u64)x33 * x11)) + ((u64)x25 * x19)) + ((u64)x37 * x7)))) + ((u64)x27 * x17)) + ((u64)x35 * x9)) + ((u64)x23 * x21)) + ((u64)x39 * x5));\n\t{ u64 x49 = (((((((((((u64)x31 * x15) + ((u64)x33 * x13)) + ((u64)x29 * x17)) + ((u64)x35 * x11)) + ((u64)x27 * x19)) + ((u64)x37 * x9)) + ((u64)x25 * x21)) + ((u64)x39 * x7)) + ((u64)x23 * x20)) + ((u64)x38 * x5));\n\t{ u64 x50 = (((((0x2 * ((((((u64)x33 * x15) + ((u64)x29 * x19)) + ((u64)x37 * x11)) + ((u64)x25 * x20)) + ((u64)x38 * x7))) + ((u64)x31 * x17)) + ((u64)x35 * x13)) + ((u64)x27 * x21)) + ((u64)x39 * x9));\n\t{ u64 x51 = (((((((((u64)x33 * x17) + ((u64)x35 * x15)) + ((u64)x31 * x19)) + ((u64)x37 * x13)) + ((u64)x29 * x21)) + ((u64)x39 * x11)) + ((u64)x27 * x20)) + ((u64)x38 * x9));\n\t{ u64 x52 = (((((u64)x35 * x17) + (0x2 * (((((u64)x33 * x19) + ((u64)x37 * x15)) + ((u64)x29 * x20)) + ((u64)x38 * x11)))) + ((u64)x31 * x21)) + ((u64)x39 * x13));\n\t{ u64 x53 = (((((((u64)x35 * x19) + ((u64)x37 * x17)) + ((u64)x33 * x21)) + ((u64)x39 * x15)) + ((u64)x31 * x20)) + ((u64)x38 * x13));\n\t{ u64 x54 = (((0x2 * ((((u64)x37 * x19) + ((u64)x33 * x20)) + ((u64)x38 * x15))) + ((u64)x35 * x21)) + ((u64)x39 * x17));\n\t{ u64 x55 = (((((u64)x37 * x21) + ((u64)x39 * x19)) + ((u64)x35 * x20)) + ((u64)x38 * x17));\n\t{ u64 x56 = (((u64)x39 * x21) + (0x2 * (((u64)x37 * x20) + ((u64)x38 * x19))));\n\t{ u64 x57 = (((u64)x39 * x20) + ((u64)x38 * x21));\n\t{ u64 x58 = ((u64)(0x2 * x38) * x20);\n\t{ u64 x59 = (x48 + (x58 << 0x4));\n\t{ u64 x60 = (x59 + (x58 << 0x1));\n\t{ u64 x61 = (x60 + x58);\n\t{ u64 x62 = (x47 + (x57 << 0x4));\n\t{ u64 x63 = (x62 + (x57 << 0x1));\n\t{ u64 x64 = (x63 + x57);\n\t{ u64 x65 = (x46 + (x56 << 0x4));\n\t{ u64 x66 = (x65 + (x56 << 0x1));\n\t{ u64 x67 = (x66 + x56);\n\t{ u64 x68 = (x45 + (x55 << 0x4));\n\t{ u64 x69 = (x68 + (x55 << 0x1));\n\t{ u64 x70 = (x69 + x55);\n\t{ u64 x71 = (x44 + (x54 << 0x4));\n\t{ u64 x72 = (x71 + (x54 << 0x1));\n\t{ u64 x73 = (x72 + x54);\n\t{ u64 x74 = (x43 + (x53 << 0x4));\n\t{ u64 x75 = (x74 + (x53 << 0x1));\n\t{ u64 x76 = (x75 + x53);\n\t{ u64 x77 = (x42 + (x52 << 0x4));\n\t{ u64 x78 = (x77 + (x52 << 0x1));\n\t{ u64 x79 = (x78 + x52);\n\t{ u64 x80 = (x41 + (x51 << 0x4));\n\t{ u64 x81 = (x80 + (x51 << 0x1));\n\t{ u64 x82 = (x81 + x51);\n\t{ u64 x83 = (x40 + (x50 << 0x4));\n\t{ u64 x84 = (x83 + (x50 << 0x1));\n\t{ u64 x85 = (x84 + x50);\n\t{ u64 x86 = (x85 >> 0x1a);\n\t{ u32 x87 = ((u32)x85 & 0x3ffffff);\n\t{ u64 x88 = (x86 + x82);\n\t{ u64 x89 = (x88 >> 0x19);\n\t{ u32 x90 = ((u32)x88 & 0x1ffffff);\n\t{ u64 x91 = (x89 + x79);\n\t{ u64 x92 = (x91 >> 0x1a);\n\t{ u32 x93 = ((u32)x91 & 0x3ffffff);\n\t{ u64 x94 = (x92 + x76);\n\t{ u64 x95 = (x94 >> 0x19);\n\t{ u32 x96 = ((u32)x94 & 0x1ffffff);\n\t{ u64 x97 = (x95 + x73);\n\t{ u64 x98 = (x97 >> 0x1a);\n\t{ u32 x99 = ((u32)x97 & 0x3ffffff);\n\t{ u64 x100 = (x98 + x70);\n\t{ u64 x101 = (x100 >> 0x19);\n\t{ u32 x102 = ((u32)x100 & 0x1ffffff);\n\t{ u64 x103 = (x101 + x67);\n\t{ u64 x104 = (x103 >> 0x1a);\n\t{ u32 x105 = ((u32)x103 & 0x3ffffff);\n\t{ u64 x106 = (x104 + x64);\n\t{ u64 x107 = (x106 >> 0x19);\n\t{ u32 x108 = ((u32)x106 & 0x1ffffff);\n\t{ u64 x109 = (x107 + x61);\n\t{ u64 x110 = (x109 >> 0x1a);\n\t{ u32 x111 = ((u32)x109 & 0x3ffffff);\n\t{ u64 x112 = (x110 + x49);\n\t{ u64 x113 = (x112 >> 0x19);\n\t{ u32 x114 = ((u32)x112 & 0x1ffffff);\n\t{ u64 x115 = (x87 + (0x13 * x113));\n\t{ u32 x116 = (u32) (x115 >> 0x1a);\n\t{ u32 x117 = ((u32)x115 & 0x3ffffff);\n\t{ u32 x118 = (x116 + x90);\n\t{ u32 x119 = (x118 >> 0x19);\n\t{ u32 x120 = (x118 & 0x1ffffff);\n\tout[0] = x117;\n\tout[1] = x120;\n\tout[2] = (x119 + x93);\n\tout[3] = x96;\n\tout[4] = x99;\n\tout[5] = x102;\n\tout[6] = x105;\n\tout[7] = x108;\n\tout[8] = x111;\n\tout[9] = x114;\n\t}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}\n}\n\nstatic __always_inline void fe_mul121666(fe *h, const fe_loose *f)\n{\n\tfe_mul_121666_impl(h->v, f->v);\n}\n\nvoid curve25519_generic(u8 out[CURVE25519_KEY_SIZE],\n\t\t\tconst u8 scalar[CURVE25519_KEY_SIZE],\n\t\t\tconst u8 point[CURVE25519_KEY_SIZE])\n{\n\tfe x1, x2, z2, x3, z3;\n\tfe_loose x2l, z2l, x3l;\n\tunsigned swap = 0;\n\tint pos;\n\tu8 e[32];\n\n\tmemcpy(e, scalar, 32);\n\tcurve25519_clamp_secret(e);\n\n\t \n\tfe_frombytes(&x1, point);\n\tfe_1(&x2);\n\tfe_0(&z2);\n\tfe_copy(&x3, &x1);\n\tfe_1(&z3);\n\n\tfor (pos = 254; pos >= 0; --pos) {\n\t\tfe tmp0, tmp1;\n\t\tfe_loose tmp0l, tmp1l;\n\t\t \n\t\tunsigned b = 1 & (e[pos / 8] >> (pos & 7));\n\t\tswap ^= b;\n\t\tfe_cswap(&x2, &x3, swap);\n\t\tfe_cswap(&z2, &z3, swap);\n\t\tswap = b;\n\t\t \n\t\tfe_sub(&tmp0l, &x3, &z3);\n\t\tfe_sub(&tmp1l, &x2, &z2);\n\t\tfe_add(&x2l, &x2, &z2);\n\t\tfe_add(&z2l, &x3, &z3);\n\t\tfe_mul_tll(&z3, &tmp0l, &x2l);\n\t\tfe_mul_tll(&z2, &z2l, &tmp1l);\n\t\tfe_sq_tl(&tmp0, &tmp1l);\n\t\tfe_sq_tl(&tmp1, &x2l);\n\t\tfe_add(&x3l, &z3, &z2);\n\t\tfe_sub(&z2l, &z3, &z2);\n\t\tfe_mul_ttt(&x2, &tmp1, &tmp0);\n\t\tfe_sub(&tmp1l, &tmp1, &tmp0);\n\t\tfe_sq_tl(&z2, &z2l);\n\t\tfe_mul121666(&z3, &tmp1l);\n\t\tfe_sq_tl(&x3, &x3l);\n\t\tfe_add(&tmp0l, &tmp0, &z3);\n\t\tfe_mul_ttt(&z3, &x1, &z2);\n\t\tfe_mul_tll(&z2, &tmp1l, &tmp0l);\n\t}\n\t \n\tfe_cswap(&x2, &x3, swap);\n\tfe_cswap(&z2, &z3, swap);\n\n\tfe_invert(&z2, &z2);\n\tfe_mul_ttt(&x2, &x2, &z2);\n\tfe_tobytes(out, &x2);\n\n\tmemzero_explicit(&x1, sizeof(x1));\n\tmemzero_explicit(&x2, sizeof(x2));\n\tmemzero_explicit(&z2, sizeof(z2));\n\tmemzero_explicit(&x3, sizeof(x3));\n\tmemzero_explicit(&z3, sizeof(z3));\n\tmemzero_explicit(&x2l, sizeof(x2l));\n\tmemzero_explicit(&z2l, sizeof(z2l));\n\tmemzero_explicit(&x3l, sizeof(x3l));\n\tmemzero_explicit(&e, sizeof(e));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}