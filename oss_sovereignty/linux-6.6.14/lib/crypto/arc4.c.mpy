{
  "module_name": "arc4.c",
  "hash_id": "336a6950c30775fbaeeda97010071a4125d1bba22a527a4341e2dda3caabbd17",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/arc4.c",
  "human_readable_source": "\n \n\n#include <crypto/arc4.h>\n#include <linux/module.h>\n\nint arc4_setkey(struct arc4_ctx *ctx, const u8 *in_key, unsigned int key_len)\n{\n\tint i, j = 0, k = 0;\n\n\tctx->x = 1;\n\tctx->y = 0;\n\n\tfor (i = 0; i < 256; i++)\n\t\tctx->S[i] = i;\n\n\tfor (i = 0; i < 256; i++) {\n\t\tu32 a = ctx->S[i];\n\n\t\tj = (j + in_key[k] + a) & 0xff;\n\t\tctx->S[i] = ctx->S[j];\n\t\tctx->S[j] = a;\n\t\tif (++k >= key_len)\n\t\t\tk = 0;\n\t}\n\n\treturn 0;\n}\nEXPORT_SYMBOL(arc4_setkey);\n\nvoid arc4_crypt(struct arc4_ctx *ctx, u8 *out, const u8 *in, unsigned int len)\n{\n\tu32 *const S = ctx->S;\n\tu32 x, y, a, b;\n\tu32 ty, ta, tb;\n\n\tif (len == 0)\n\t\treturn;\n\n\tx = ctx->x;\n\ty = ctx->y;\n\n\ta = S[x];\n\ty = (y + a) & 0xff;\n\tb = S[y];\n\n\tdo {\n\t\tS[y] = a;\n\t\ta = (a + b) & 0xff;\n\t\tS[x] = b;\n\t\tx = (x + 1) & 0xff;\n\t\tta = S[x];\n\t\tty = (y + ta) & 0xff;\n\t\ttb = S[ty];\n\t\t*out++ = *in++ ^ S[a];\n\t\tif (--len == 0)\n\t\t\tbreak;\n\t\ty = ty;\n\t\ta = ta;\n\t\tb = tb;\n\t} while (true);\n\n\tctx->x = x;\n\tctx->y = y;\n}\nEXPORT_SYMBOL(arc4_crypt);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}