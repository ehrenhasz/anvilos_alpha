{
  "module_name": "mpi-add.c",
  "hash_id": "7b4ef767fd41d0291d54554742eabcd93fe69542f08f0609d3e97d08d0faba2e",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/mpi/mpi-add.c",
  "human_readable_source": " \n\n#include \"mpi-internal.h\"\n\n \nvoid mpi_add_ui(MPI w, MPI u, unsigned long v)\n{\n\tmpi_ptr_t wp, up;\n\tmpi_size_t usize, wsize;\n\tint usign, wsign;\n\n\tusize = u->nlimbs;\n\tusign = u->sign;\n\twsign = 0;\n\n\t \n\twsize = usize + 1;\n\tif (w->alloced < wsize)\n\t\tmpi_resize(w, wsize);\n\n\t \n\tup = u->d;\n\twp = w->d;\n\n\tif (!usize) {   \n\t\twp[0] = v;\n\t\twsize = v ? 1:0;\n\t} else if (!usign) {   \n\t\tmpi_limb_t cy;\n\t\tcy = mpihelp_add_1(wp, up, usize, v);\n\t\twp[usize] = cy;\n\t\twsize = usize + cy;\n\t} else {\n\t\t \n\t\tif (usize == 1 && up[0] < v) {\n\t\t\twp[0] = v - up[0];\n\t\t\twsize = 1;\n\t\t} else {\n\t\t\tmpihelp_sub_1(wp, up, usize, v);\n\t\t\t \n\t\t\twsize = usize - (wp[usize-1] == 0);\n\t\t\twsign = 1;\n\t\t}\n\t}\n\n\tw->nlimbs = wsize;\n\tw->sign   = wsign;\n}\n\n\nvoid mpi_add(MPI w, MPI u, MPI v)\n{\n\tmpi_ptr_t wp, up, vp;\n\tmpi_size_t usize, vsize, wsize;\n\tint usign, vsign, wsign;\n\n\tif (u->nlimbs < v->nlimbs) {  \n\t\tusize = v->nlimbs;\n\t\tusign = v->sign;\n\t\tvsize = u->nlimbs;\n\t\tvsign = u->sign;\n\t\twsize = usize + 1;\n\t\tRESIZE_IF_NEEDED(w, wsize);\n\t\t \n\t\tup = v->d;\n\t\tvp = u->d;\n\t} else {\n\t\tusize = u->nlimbs;\n\t\tusign = u->sign;\n\t\tvsize = v->nlimbs;\n\t\tvsign = v->sign;\n\t\twsize = usize + 1;\n\t\tRESIZE_IF_NEEDED(w, wsize);\n\t\t \n\t\tup = u->d;\n\t\tvp = v->d;\n\t}\n\twp = w->d;\n\twsign = 0;\n\n\tif (!vsize) {   \n\t\tMPN_COPY(wp, up, usize);\n\t\twsize = usize;\n\t\twsign = usign;\n\t} else if (usign != vsign) {  \n\t\t \n\t\tif (usize != vsize) {\n\t\t\tmpihelp_sub(wp, up, usize, vp, vsize);\n\t\t\twsize = usize;\n\t\t\tMPN_NORMALIZE(wp, wsize);\n\t\t\twsign = usign;\n\t\t} else if (mpihelp_cmp(up, vp, usize) < 0) {\n\t\t\tmpihelp_sub_n(wp, vp, up, usize);\n\t\t\twsize = usize;\n\t\t\tMPN_NORMALIZE(wp, wsize);\n\t\t\tif (!usign)\n\t\t\t\twsign = 1;\n\t\t} else {\n\t\t\tmpihelp_sub_n(wp, up, vp, usize);\n\t\t\twsize = usize;\n\t\t\tMPN_NORMALIZE(wp, wsize);\n\t\t\tif (usign)\n\t\t\t\twsign = 1;\n\t\t}\n\t} else {  \n\t\tmpi_limb_t cy = mpihelp_add(wp, up, usize, vp, vsize);\n\t\twp[usize] = cy;\n\t\twsize = usize + cy;\n\t\tif (usign)\n\t\t\twsign = 1;\n\t}\n\n\tw->nlimbs = wsize;\n\tw->sign = wsign;\n}\nEXPORT_SYMBOL_GPL(mpi_add);\n\nvoid mpi_sub(MPI w, MPI u, MPI v)\n{\n\tMPI vv = mpi_copy(v);\n\tvv->sign = !vv->sign;\n\tmpi_add(w, u, vv);\n\tmpi_free(vv);\n}\nEXPORT_SYMBOL_GPL(mpi_sub);\n\nvoid mpi_addm(MPI w, MPI u, MPI v, MPI m)\n{\n\tmpi_add(w, u, v);\n\tmpi_mod(w, w, m);\n}\nEXPORT_SYMBOL_GPL(mpi_addm);\n\nvoid mpi_subm(MPI w, MPI u, MPI v, MPI m)\n{\n\tmpi_sub(w, u, v);\n\tmpi_mod(w, w, m);\n}\nEXPORT_SYMBOL_GPL(mpi_subm);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}