{
  "module_name": "mpi-mul.c",
  "hash_id": "75b55ea77530d79b0672e2e23aaa4b057dae830c9718af122462780926f6fad7",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/mpi/mpi-mul.c",
  "human_readable_source": " \n\n#include \"mpi-internal.h\"\n\nvoid mpi_mul(MPI w, MPI u, MPI v)\n{\n\tmpi_size_t usize, vsize, wsize;\n\tmpi_ptr_t up, vp, wp;\n\tmpi_limb_t cy;\n\tint usign, vsign, sign_product;\n\tint assign_wp = 0;\n\tmpi_ptr_t tmp_limb = NULL;\n\n\tif (u->nlimbs < v->nlimbs) {\n\t\t \n\t\tusize = v->nlimbs;\n\t\tusign = v->sign;\n\t\tup    = v->d;\n\t\tvsize = u->nlimbs;\n\t\tvsign = u->sign;\n\t\tvp    = u->d;\n\t} else {\n\t\tusize = u->nlimbs;\n\t\tusign = u->sign;\n\t\tup    = u->d;\n\t\tvsize = v->nlimbs;\n\t\tvsign = v->sign;\n\t\tvp    = v->d;\n\t}\n\tsign_product = usign ^ vsign;\n\twp = w->d;\n\n\t \n\twsize = usize + vsize;\n\tif (w->alloced < wsize) {\n\t\tif (wp == up || wp == vp) {\n\t\t\twp = mpi_alloc_limb_space(wsize);\n\t\t\tassign_wp = 1;\n\t\t} else {\n\t\t\tmpi_resize(w, wsize);\n\t\t\twp = w->d;\n\t\t}\n\t} else {  \n\t\tif (wp == up) {\n\t\t\t \n\t\t\tup = tmp_limb = mpi_alloc_limb_space(usize);\n\t\t\t \n\t\t\tif (wp == vp)\n\t\t\t\tvp = up;\n\t\t\t \n\t\t\tMPN_COPY(up, wp, usize);\n\t\t} else if (wp == vp) {\n\t\t\t \n\t\t\tvp = tmp_limb = mpi_alloc_limb_space(vsize);\n\t\t\t \n\t\t\tMPN_COPY(vp, wp, vsize);\n\t\t}\n\t}\n\n\tif (!vsize)\n\t\twsize = 0;\n\telse {\n\t\tmpihelp_mul(wp, up, usize, vp, vsize, &cy);\n\t\twsize -= cy ? 0:1;\n\t}\n\n\tif (assign_wp)\n\t\tmpi_assign_limb_space(w, wp, wsize);\n\tw->nlimbs = wsize;\n\tw->sign = sign_product;\n\tif (tmp_limb)\n\t\tmpi_free_limb_space(tmp_limb);\n}\nEXPORT_SYMBOL_GPL(mpi_mul);\n\nvoid mpi_mulm(MPI w, MPI u, MPI v, MPI m)\n{\n\tmpi_mul(w, u, v);\n\tmpi_tdiv_r(w, w, m);\n}\nEXPORT_SYMBOL_GPL(mpi_mulm);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}