{
  "module_name": "mpi-internal.h",
  "hash_id": "478c0e1c7f9c9a2a4d0501293b3b243bd087f1bc99d7d0487caddc191ac8d6e8",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/mpi/mpi-internal.h",
  "human_readable_source": " \n \n\n#ifndef G10_MPI_INTERNAL_H\n#define G10_MPI_INTERNAL_H\n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mpi.h>\n#include <linux/errno.h>\n\n#define log_debug printk\n#define log_bug printk\n\n#define assert(x) \\\n\tdo { \\\n\t\tif (!x) \\\n\t\t\tlog_bug(\"failed assertion\\n\"); \\\n\t} while (0);\n\n \n\n \n#ifndef KARATSUBA_THRESHOLD\n#define KARATSUBA_THRESHOLD 16\n#endif\n\n \n#if KARATSUBA_THRESHOLD < 2\n#undef KARATSUBA_THRESHOLD\n#define KARATSUBA_THRESHOLD 2\n#endif\n\ntypedef mpi_limb_t *mpi_ptr_t;\t \ntypedef int mpi_size_t;\t\t \n\n#define RESIZE_IF_NEEDED(a, b)\t\t\t\\\n\tdo {\t\t\t\t\t\\\n\t\tif ((a)->alloced < (b))\t\t\\\n\t\t\tmpi_resize((a), (b));\t\\\n\t} while (0)\n\n \n#define MPN_COPY(d, s, n) \\\n\tdo {\t\t\t\t\t\\\n\t\tmpi_size_t _i;\t\t\t\\\n\t\tfor (_i = 0; _i < (n); _i++)\t\\\n\t\t\t(d)[_i] = (s)[_i];\t\\\n\t} while (0)\n\n#define MPN_COPY_INCR(d, s, n)\t\t\\\n\tdo {\t\t\t\t\t\\\n\t\tmpi_size_t _i;\t\t\t\\\n\t\tfor (_i = 0; _i < (n); _i++)\t\\\n\t\t\t(d)[_i] = (s)[_i];\t\\\n\t} while (0)\n\n\n#define MPN_COPY_DECR(d, s, n) \\\n\tdo {\t\t\t\t\t\\\n\t\tmpi_size_t _i;\t\t\t\\\n\t\tfor (_i = (n)-1; _i >= 0; _i--) \\\n\t\t\t(d)[_i] = (s)[_i];\t\\\n\t} while (0)\n\n \n#define MPN_ZERO(d, n) \\\n\tdo {\t\t\t\t\t\\\n\t\tint  _i;\t\t\t\\\n\t\tfor (_i = 0; _i < (n); _i++)\t\\\n\t\t\t(d)[_i] = 0;\t\t\\\n\t} while (0)\n\n#define MPN_NORMALIZE(d, n)  \\\n\tdo {\t\t\t\t\t\\\n\t\twhile ((n) > 0) {\t\t\\\n\t\t\tif ((d)[(n)-1])\t\t\\\n\t\t\t\tbreak;\t\t\\\n\t\t\t(n)--;\t\t\t\\\n\t\t}\t\t\t\t\\\n\t} while (0)\n\n#define MPN_MUL_N_RECURSE(prodp, up, vp, size, tspace) \\\n\tdo {\t\t\t\t\t\t\t\\\n\t\tif ((size) < KARATSUBA_THRESHOLD)\t\t\\\n\t\t\tmul_n_basecase(prodp, up, vp, size);\t\\\n\t\telse\t\t\t\t\t\t\\\n\t\t\tmul_n(prodp, up, vp, size, tspace);\t\\\n\t} while (0);\n\n \n#define UDIV_QRNND_PREINV(q, r, nh, nl, d, di)\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tmpi_limb_t _ql __maybe_unused;\t\t\t\t\\\n\t\tmpi_limb_t _q, _r;\t\t\t\t\t\\\n\t\tmpi_limb_t _xh, _xl;\t\t\t\t\t\\\n\t\tumul_ppmm(_q, _ql, (nh), (di));\t\t\t\t\\\n\t\t_q += (nh);\t  \\\n\t\tumul_ppmm(_xh, _xl, _q, (d));\t\t\t\t\\\n\t\tsub_ddmmss(_xh, _r, (nh), (nl), _xh, _xl);\t\t\\\n\t\tif (_xh) {\t\t\t\t\t\t\\\n\t\t\tsub_ddmmss(_xh, _r, _xh, _r, 0, (d));\t\t\\\n\t\t\t_q++;\t\t\t\t\t\t\\\n\t\t\tif (_xh) {\t\t\t\t\t\\\n\t\t\t\tsub_ddmmss(_xh, _r, _xh, _r, 0, (d));\t\\\n\t\t\t\t_q++;\t\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t\tif (_r >= (d)) {\t\t\t\t\t\\\n\t\t\t_r -= (d);\t\t\t\t\t\\\n\t\t\t_q++;\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t\t(r) = _r;\t\t\t\t\t\t\\\n\t\t(q) = _q;\t\t\t\t\t\t\\\n\t} while (0)\n\n\n \nmpi_ptr_t mpi_alloc_limb_space(unsigned nlimbs);\nvoid mpi_free_limb_space(mpi_ptr_t a);\nvoid mpi_assign_limb_space(MPI a, mpi_ptr_t ap, unsigned nlimbs);\n\nstatic inline mpi_limb_t mpihelp_add_1(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t mpi_size_t s1_size, mpi_limb_t s2_limb);\nmpi_limb_t mpihelp_add_n(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t mpi_ptr_t s2_ptr, mpi_size_t size);\nstatic inline mpi_limb_t mpihelp_add(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr, mpi_size_t s1_size,\n\t\t       mpi_ptr_t s2_ptr, mpi_size_t s2_size);\n\nstatic inline mpi_limb_t mpihelp_sub_1(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t mpi_size_t s1_size, mpi_limb_t s2_limb);\nmpi_limb_t mpihelp_sub_n(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t mpi_ptr_t s2_ptr, mpi_size_t size);\nstatic inline mpi_limb_t mpihelp_sub(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr, mpi_size_t s1_size,\n\t\t       mpi_ptr_t s2_ptr, mpi_size_t s2_size);\n\n \nint mpihelp_cmp(mpi_ptr_t op1_ptr, mpi_ptr_t op2_ptr, mpi_size_t size);\n\n \n\nstruct karatsuba_ctx {\n\tstruct karatsuba_ctx *next;\n\tmpi_ptr_t tspace;\n\tmpi_size_t tspace_size;\n\tmpi_ptr_t tp;\n\tmpi_size_t tp_size;\n};\n\nvoid mpihelp_release_karatsuba_ctx(struct karatsuba_ctx *ctx);\n\nmpi_limb_t mpihelp_addmul_1(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t    mpi_size_t s1_size, mpi_limb_t s2_limb);\nmpi_limb_t mpihelp_submul_1(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t    mpi_size_t s1_size, mpi_limb_t s2_limb);\nint mpihelp_mul(mpi_ptr_t prodp, mpi_ptr_t up, mpi_size_t usize,\n\t\tmpi_ptr_t vp, mpi_size_t vsize, mpi_limb_t *_result);\nvoid mpih_sqr_n_basecase(mpi_ptr_t prodp, mpi_ptr_t up, mpi_size_t size);\nvoid mpih_sqr_n(mpi_ptr_t prodp, mpi_ptr_t up, mpi_size_t size,\n\t\tmpi_ptr_t tspace);\nvoid mpihelp_mul_n(mpi_ptr_t prodp,\n\t\tmpi_ptr_t up, mpi_ptr_t vp, mpi_size_t size);\n\nint mpihelp_mul_karatsuba_case(mpi_ptr_t prodp,\n\t\t\t       mpi_ptr_t up, mpi_size_t usize,\n\t\t\t       mpi_ptr_t vp, mpi_size_t vsize,\n\t\t\t       struct karatsuba_ctx *ctx);\n\n \nmpi_limb_t mpihelp_mul_1(mpi_ptr_t res_ptr, mpi_ptr_t s1_ptr,\n\t\t\t mpi_size_t s1_size, mpi_limb_t s2_limb);\n\n \nmpi_limb_t mpihelp_mod_1(mpi_ptr_t dividend_ptr, mpi_size_t dividend_size,\n\t\t\t mpi_limb_t divisor_limb);\nmpi_limb_t mpihelp_divrem(mpi_ptr_t qp, mpi_size_t qextra_limbs,\n\t\t\t  mpi_ptr_t np, mpi_size_t nsize,\n\t\t\t  mpi_ptr_t dp, mpi_size_t dsize);\nmpi_limb_t mpihelp_divmod_1(mpi_ptr_t quot_ptr,\n\t\t\t    mpi_ptr_t dividend_ptr, mpi_size_t dividend_size,\n\t\t\t    mpi_limb_t divisor_limb);\n\n \nmpi_limb_t mpihelp_lshift(mpi_ptr_t wp, mpi_ptr_t up, mpi_size_t usize,\n\t\t\t  unsigned cnt);\nmpi_limb_t mpihelp_rshift(mpi_ptr_t wp, mpi_ptr_t up, mpi_size_t usize,\n\t\t\t  unsigned cnt);\n\n \n#define W_TYPE_SIZE BITS_PER_MPI_LIMB\ntypedef mpi_limb_t UWtype;\ntypedef unsigned int UHWtype;\n#if defined(__GNUC__)\ntypedef unsigned int UQItype __attribute__ ((mode(QI)));\ntypedef int SItype __attribute__ ((mode(SI)));\ntypedef unsigned int USItype __attribute__ ((mode(SI)));\ntypedef int DItype __attribute__ ((mode(DI)));\ntypedef unsigned int UDItype __attribute__ ((mode(DI)));\n#else\ntypedef unsigned char UQItype;\ntypedef long SItype;\ntypedef unsigned long USItype;\n#endif\n\n#ifdef __GNUC__\n#include \"mpi-inline.h\"\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}