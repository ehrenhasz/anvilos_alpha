{
  "module_name": "utils.c",
  "hash_id": "4dfaadb4e0b57b5fec36c8c4cf6e8e7e4085a5c38d26b3eb70652ff800a3dc1e",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/utils.c",
  "human_readable_source": "\n \n\n#include <asm/unaligned.h>\n#include <crypto/utils.h>\n#include <linux/module.h>\n\n \nvoid __crypto_xor(u8 *dst, const u8 *src1, const u8 *src2, unsigned int len)\n{\n\tint relalign = 0;\n\n\tif (!IS_ENABLED(CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS)) {\n\t\tint size = sizeof(unsigned long);\n\t\tint d = (((unsigned long)dst ^ (unsigned long)src1) |\n\t\t\t ((unsigned long)dst ^ (unsigned long)src2)) &\n\t\t\t(size - 1);\n\n\t\trelalign = d ? 1 << __ffs(d) : size;\n\n\t\t \n\t\twhile (((unsigned long)dst & (relalign - 1)) && len > 0) {\n\t\t\t*dst++ = *src1++ ^ *src2++;\n\t\t\tlen--;\n\t\t}\n\t}\n\n\twhile (IS_ENABLED(CONFIG_64BIT) && len >= 8 && !(relalign & 7)) {\n\t\tif (IS_ENABLED(CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS)) {\n\t\t\tu64 l = get_unaligned((u64 *)src1) ^\n\t\t\t\tget_unaligned((u64 *)src2);\n\t\t\tput_unaligned(l, (u64 *)dst);\n\t\t} else {\n\t\t\t*(u64 *)dst = *(u64 *)src1 ^ *(u64 *)src2;\n\t\t}\n\t\tdst += 8;\n\t\tsrc1 += 8;\n\t\tsrc2 += 8;\n\t\tlen -= 8;\n\t}\n\n\twhile (len >= 4 && !(relalign & 3)) {\n\t\tif (IS_ENABLED(CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS)) {\n\t\t\tu32 l = get_unaligned((u32 *)src1) ^\n\t\t\t\tget_unaligned((u32 *)src2);\n\t\t\tput_unaligned(l, (u32 *)dst);\n\t\t} else {\n\t\t\t*(u32 *)dst = *(u32 *)src1 ^ *(u32 *)src2;\n\t\t}\n\t\tdst += 4;\n\t\tsrc1 += 4;\n\t\tsrc2 += 4;\n\t\tlen -= 4;\n\t}\n\n\twhile (len >= 2 && !(relalign & 1)) {\n\t\tif (IS_ENABLED(CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS)) {\n\t\t\tu16 l = get_unaligned((u16 *)src1) ^\n\t\t\t\tget_unaligned((u16 *)src2);\n\t\t\tput_unaligned(l, (u16 *)dst);\n\t\t} else {\n\t\t\t*(u16 *)dst = *(u16 *)src1 ^ *(u16 *)src2;\n\t\t}\n\t\tdst += 2;\n\t\tsrc1 += 2;\n\t\tsrc2 += 2;\n\t\tlen -= 2;\n\t}\n\n\twhile (len--)\n\t\t*dst++ = *src1++ ^ *src2++;\n}\nEXPORT_SYMBOL_GPL(__crypto_xor);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}