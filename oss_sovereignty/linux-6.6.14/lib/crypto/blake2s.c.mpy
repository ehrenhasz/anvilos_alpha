{
  "module_name": "blake2s.c",
  "hash_id": "af67844be57c32fad9bab5afe43c0af049de2bd927199f6be2aa9e982eae6a36",
  "original_prompt": "Ingested from linux-6.6.14/lib/crypto/blake2s.c",
  "human_readable_source": "\n \n\n#include <crypto/internal/blake2s.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/bug.h>\n\nstatic inline void blake2s_set_lastblock(struct blake2s_state *state)\n{\n\tstate->f[0] = -1;\n}\n\nvoid blake2s_update(struct blake2s_state *state, const u8 *in, size_t inlen)\n{\n\tconst size_t fill = BLAKE2S_BLOCK_SIZE - state->buflen;\n\n\tif (unlikely(!inlen))\n\t\treturn;\n\tif (inlen > fill) {\n\t\tmemcpy(state->buf + state->buflen, in, fill);\n\t\tblake2s_compress(state, state->buf, 1, BLAKE2S_BLOCK_SIZE);\n\t\tstate->buflen = 0;\n\t\tin += fill;\n\t\tinlen -= fill;\n\t}\n\tif (inlen > BLAKE2S_BLOCK_SIZE) {\n\t\tconst size_t nblocks = DIV_ROUND_UP(inlen, BLAKE2S_BLOCK_SIZE);\n\t\tblake2s_compress(state, in, nblocks - 1, BLAKE2S_BLOCK_SIZE);\n\t\tin += BLAKE2S_BLOCK_SIZE * (nblocks - 1);\n\t\tinlen -= BLAKE2S_BLOCK_SIZE * (nblocks - 1);\n\t}\n\tmemcpy(state->buf + state->buflen, in, inlen);\n\tstate->buflen += inlen;\n}\nEXPORT_SYMBOL(blake2s_update);\n\nvoid blake2s_final(struct blake2s_state *state, u8 *out)\n{\n\tWARN_ON(IS_ENABLED(DEBUG) && !out);\n\tblake2s_set_lastblock(state);\n\tmemset(state->buf + state->buflen, 0,\n\t       BLAKE2S_BLOCK_SIZE - state->buflen);  \n\tblake2s_compress(state, state->buf, 1, state->buflen);\n\tcpu_to_le32_array(state->h, ARRAY_SIZE(state->h));\n\tmemcpy(out, state->h, state->outlen);\n\tmemzero_explicit(state, sizeof(*state));\n}\nEXPORT_SYMBOL(blake2s_final);\n\nstatic int __init blake2s_mod_init(void)\n{\n\tif (!IS_ENABLED(CONFIG_CRYPTO_MANAGER_DISABLE_TESTS) &&\n\t    WARN_ON(!blake2s_selftest()))\n\t\treturn -ENODEV;\n\treturn 0;\n}\n\nmodule_init(blake2s_mod_init);\nMODULE_DESCRIPTION(\"BLAKE2s hash function\");\nMODULE_AUTHOR(\"Jason A. Donenfeld <Jason@zx2c4.com>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}