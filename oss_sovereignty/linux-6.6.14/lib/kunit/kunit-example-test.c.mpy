{
  "module_name": "kunit-example-test.c",
  "hash_id": "89eec5e60106956b7f88aaa59553866d0427e4f8cec44c648e34008427d9abab",
  "original_prompt": "Ingested from linux-6.6.14/lib/kunit/kunit-example-test.c",
  "human_readable_source": "\n \n\n#include <kunit/test.h>\n#include <kunit/static_stub.h>\n\n \nstatic void example_simple_test(struct kunit *test)\n{\n\t \n\tKUNIT_EXPECT_EQ(test, 1 + 1, 2);\n}\n\n \nstatic int example_test_init(struct kunit *test)\n{\n\tkunit_info(test, \"initializing\\n\");\n\n\treturn 0;\n}\n\n \nstatic void example_test_exit(struct kunit *test)\n{\n\tkunit_info(test, \"cleaning up\\n\");\n}\n\n\n \nstatic int example_test_init_suite(struct kunit_suite *suite)\n{\n\tkunit_info(suite, \"initializing suite\\n\");\n\n\treturn 0;\n}\n\n \nstatic void example_test_exit_suite(struct kunit_suite *suite)\n{\n\tkunit_info(suite, \"exiting suite\\n\");\n}\n\n\n \nstatic void example_skip_test(struct kunit *test)\n{\n\t \n\tkunit_info(test, \"You should not see a line below.\");\n\n\t \n\tkunit_skip(test, \"this test should be skipped\");\n\n\t \n\tKUNIT_FAIL(test, \"You should not see this line.\");\n}\n\n \nstatic void example_mark_skipped_test(struct kunit *test)\n{\n\t \n\tkunit_info(test, \"You should see a line below.\");\n\n\t \n\tkunit_mark_skipped(test, \"this test should be skipped\");\n\n\t \n\tkunit_info(test, \"You should see this line.\");\n}\n\n \nstatic void example_all_expect_macros_test(struct kunit *test)\n{\n\tconst u32 array1[] = { 0x0F, 0xFF };\n\tconst u32 array2[] = { 0x1F, 0xFF };\n\n\t \n\tKUNIT_EXPECT_TRUE(test, true);\n\tKUNIT_EXPECT_FALSE(test, false);\n\n\t \n\tKUNIT_EXPECT_EQ(test, 1, 1);  \n\tKUNIT_EXPECT_GE(test, 1, 1);  \n\tKUNIT_EXPECT_LE(test, 1, 1);  \n\tKUNIT_EXPECT_NE(test, 1, 0);  \n\tKUNIT_EXPECT_GT(test, 1, 0);  \n\tKUNIT_EXPECT_LT(test, 0, 1);  \n\n\t \n\tKUNIT_EXPECT_NOT_ERR_OR_NULL(test, test);\n\tKUNIT_EXPECT_PTR_EQ(test, NULL, NULL);\n\tKUNIT_EXPECT_PTR_NE(test, test, NULL);\n\tKUNIT_EXPECT_NULL(test, NULL);\n\tKUNIT_EXPECT_NOT_NULL(test, test);\n\n\t \n\tKUNIT_EXPECT_STREQ(test, \"hi\", \"hi\");\n\tKUNIT_EXPECT_STRNEQ(test, \"hi\", \"bye\");\n\n\t \n\tKUNIT_EXPECT_MEMEQ(test, array1, array1, sizeof(array1));\n\tKUNIT_EXPECT_MEMNEQ(test, array1, array2, sizeof(array1));\n\n\t \n\tKUNIT_ASSERT_GT(test, sizeof(char), 0);\n\n\t \n\tKUNIT_EXPECT_GT_MSG(test, sizeof(int), 0, \"Your ints are 0-bit?!\");\n\tKUNIT_ASSERT_GT_MSG(test, sizeof(int), 0, \"Your ints are 0-bit?!\");\n}\n\n \nstatic int add_one(int i)\n{\n\t \n\tKUNIT_STATIC_STUB_REDIRECT(add_one, i);\n\n\treturn i + 1;\n}\n\n \nstatic int subtract_one(int i)\n{\n\t \n\n\treturn i - 1;\n}\n\n \nstatic void example_static_stub_test(struct kunit *test)\n{\n\t \n\tKUNIT_EXPECT_EQ(test, add_one(1), 2);\n\n\t \n\tkunit_activate_static_stub(test, add_one, subtract_one);\n\n\t \n\tKUNIT_EXPECT_EQ(test, add_one(1), 0);\n\n\t \n\tkunit_deactivate_static_stub(test, add_one);\n\tKUNIT_EXPECT_EQ(test, add_one(1), 2);\n}\n\nstatic const struct example_param {\n\tint value;\n} example_params_array[] = {\n\t{ .value = 2, },\n\t{ .value = 1, },\n\t{ .value = 0, },\n};\n\nstatic void example_param_get_desc(const struct example_param *p, char *desc)\n{\n\tsnprintf(desc, KUNIT_PARAM_DESC_SIZE, \"example value %d\", p->value);\n}\n\nKUNIT_ARRAY_PARAM(example, example_params_array, example_param_get_desc);\n\n \nstatic void example_params_test(struct kunit *test)\n{\n\tconst struct example_param *param = test->param_value;\n\n\t \n\tKUNIT_ASSERT_NOT_NULL(test, param);\n\n\t \n\tif (!param->value)\n\t\tkunit_skip(test, \"unsupported param value\");\n\n\t \n\tKUNIT_EXPECT_EQ(test, param->value % param->value, 0);\n}\n\n \nstatic void example_slow_test(struct kunit *test)\n{\n\tKUNIT_EXPECT_EQ(test, 1 + 1, 2);\n}\n\n \nstatic struct kunit_case example_test_cases[] = {\n\t \n\tKUNIT_CASE(example_simple_test),\n\tKUNIT_CASE(example_skip_test),\n\tKUNIT_CASE(example_mark_skipped_test),\n\tKUNIT_CASE(example_all_expect_macros_test),\n\tKUNIT_CASE(example_static_stub_test),\n\tKUNIT_CASE_PARAM(example_params_test, example_gen_params),\n\tKUNIT_CASE_SLOW(example_slow_test),\n\t{}\n};\n\n \nstatic struct kunit_suite example_test_suite = {\n\t.name = \"example\",\n\t.init = example_test_init,\n\t.exit = example_test_exit,\n\t.suite_init = example_test_init_suite,\n\t.suite_exit = example_test_exit_suite,\n\t.test_cases = example_test_cases,\n};\n\n \nkunit_test_suites(&example_test_suite);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}