{
  "module_name": "dim.c",
  "hash_id": "e47d1e32e24b77b3374084f52272447a88dd1d4b5ec025b34a4032a640ff72fb",
  "original_prompt": "Ingested from linux-6.6.14/lib/dim/dim.c",
  "human_readable_source": "\n \n\n#include <linux/dim.h>\n\nbool dim_on_top(struct dim *dim)\n{\n\tswitch (dim->tune_state) {\n\tcase DIM_PARKING_ON_TOP:\n\tcase DIM_PARKING_TIRED:\n\t\treturn true;\n\tcase DIM_GOING_RIGHT:\n\t\treturn (dim->steps_left > 1) && (dim->steps_right == 1);\n\tdefault:  \n\t\treturn (dim->steps_right > 1) && (dim->steps_left == 1);\n\t}\n}\nEXPORT_SYMBOL(dim_on_top);\n\nvoid dim_turn(struct dim *dim)\n{\n\tswitch (dim->tune_state) {\n\tcase DIM_PARKING_ON_TOP:\n\tcase DIM_PARKING_TIRED:\n\t\tbreak;\n\tcase DIM_GOING_RIGHT:\n\t\tdim->tune_state = DIM_GOING_LEFT;\n\t\tdim->steps_left = 0;\n\t\tbreak;\n\tcase DIM_GOING_LEFT:\n\t\tdim->tune_state = DIM_GOING_RIGHT;\n\t\tdim->steps_right = 0;\n\t\tbreak;\n\t}\n}\nEXPORT_SYMBOL(dim_turn);\n\nvoid dim_park_on_top(struct dim *dim)\n{\n\tdim->steps_right  = 0;\n\tdim->steps_left   = 0;\n\tdim->tired        = 0;\n\tdim->tune_state   = DIM_PARKING_ON_TOP;\n}\nEXPORT_SYMBOL(dim_park_on_top);\n\nvoid dim_park_tired(struct dim *dim)\n{\n\tdim->steps_right  = 0;\n\tdim->steps_left   = 0;\n\tdim->tune_state   = DIM_PARKING_TIRED;\n}\nEXPORT_SYMBOL(dim_park_tired);\n\nbool dim_calc_stats(struct dim_sample *start, struct dim_sample *end,\n\t\t    struct dim_stats *curr_stats)\n{\n\t \n\tu32 delta_us = ktime_us_delta(end->time, start->time);\n\tu32 npkts = BIT_GAP(BITS_PER_TYPE(u32), end->pkt_ctr, start->pkt_ctr);\n\tu32 nbytes = BIT_GAP(BITS_PER_TYPE(u32), end->byte_ctr,\n\t\t\t     start->byte_ctr);\n\tu32 ncomps = BIT_GAP(BITS_PER_TYPE(u32), end->comp_ctr,\n\t\t\t     start->comp_ctr);\n\n\tif (!delta_us)\n\t\treturn false;\n\n\tcurr_stats->ppms = DIV_ROUND_UP(npkts * USEC_PER_MSEC, delta_us);\n\tcurr_stats->bpms = DIV_ROUND_UP(nbytes * USEC_PER_MSEC, delta_us);\n\tcurr_stats->epms = DIV_ROUND_UP(DIM_NEVENTS * USEC_PER_MSEC,\n\t\t\t\t\tdelta_us);\n\tcurr_stats->cpms = DIV_ROUND_UP(ncomps * USEC_PER_MSEC, delta_us);\n\tif (curr_stats->epms != 0)\n\t\tcurr_stats->cpe_ratio = DIV_ROUND_DOWN_ULL(\n\t\t\tcurr_stats->cpms * 100, curr_stats->epms);\n\telse\n\t\tcurr_stats->cpe_ratio = 0;\n\n\treturn true;\n}\nEXPORT_SYMBOL(dim_calc_stats);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}