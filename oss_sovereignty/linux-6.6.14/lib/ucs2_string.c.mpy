{
  "module_name": "ucs2_string.c",
  "hash_id": "072f3ce03446ad571929e1c77f4e970430bfb5a92cbc15149e7fca811ed72483",
  "original_prompt": "Ingested from linux-6.6.14/lib/ucs2_string.c",
  "human_readable_source": "\n#include <linux/ucs2_string.h>\n#include <linux/module.h>\n\n \nunsigned long\nucs2_strnlen(const ucs2_char_t *s, size_t maxlength)\n{\n        unsigned long length = 0;\n\n        while (*s++ != 0 && length < maxlength)\n                length++;\n        return length;\n}\nEXPORT_SYMBOL(ucs2_strnlen);\n\nunsigned long\nucs2_strlen(const ucs2_char_t *s)\n{\n        return ucs2_strnlen(s, ~0UL);\n}\nEXPORT_SYMBOL(ucs2_strlen);\n\n \nunsigned long\nucs2_strsize(const ucs2_char_t *data, unsigned long maxlength)\n{\n        return ucs2_strnlen(data, maxlength/sizeof(ucs2_char_t)) * sizeof(ucs2_char_t);\n}\nEXPORT_SYMBOL(ucs2_strsize);\n\nint\nucs2_strncmp(const ucs2_char_t *a, const ucs2_char_t *b, size_t len)\n{\n        while (1) {\n                if (len == 0)\n                        return 0;\n                if (*a < *b)\n                        return -1;\n                if (*a > *b)\n                        return 1;\n                if (*a == 0)  \n                        return 0;\n                a++;\n                b++;\n                len--;\n        }\n}\nEXPORT_SYMBOL(ucs2_strncmp);\n\nunsigned long\nucs2_utf8size(const ucs2_char_t *src)\n{\n\tunsigned long i;\n\tunsigned long j = 0;\n\n\tfor (i = 0; src[i]; i++) {\n\t\tu16 c = src[i];\n\n\t\tif (c >= 0x800)\n\t\t\tj += 3;\n\t\telse if (c >= 0x80)\n\t\t\tj += 2;\n\t\telse\n\t\t\tj += 1;\n\t}\n\n\treturn j;\n}\nEXPORT_SYMBOL(ucs2_utf8size);\n\n \nunsigned long\nucs2_as_utf8(u8 *dest, const ucs2_char_t *src, unsigned long maxlength)\n{\n\tunsigned int i;\n\tunsigned long j = 0;\n\tunsigned long limit = ucs2_strnlen(src, maxlength);\n\n\tfor (i = 0; maxlength && i < limit; i++) {\n\t\tu16 c = src[i];\n\n\t\tif (c >= 0x800) {\n\t\t\tif (maxlength < 3)\n\t\t\t\tbreak;\n\t\t\tmaxlength -= 3;\n\t\t\tdest[j++] = 0xe0 | (c & 0xf000) >> 12;\n\t\t\tdest[j++] = 0x80 | (c & 0x0fc0) >> 6;\n\t\t\tdest[j++] = 0x80 | (c & 0x003f);\n\t\t} else if (c >= 0x80) {\n\t\t\tif (maxlength < 2)\n\t\t\t\tbreak;\n\t\t\tmaxlength -= 2;\n\t\t\tdest[j++] = 0xc0 | (c & 0x7c0) >> 6;\n\t\t\tdest[j++] = 0x80 | (c & 0x03f);\n\t\t} else {\n\t\t\tmaxlength -= 1;\n\t\t\tdest[j++] = c & 0x7f;\n\t\t}\n\t}\n\tif (maxlength)\n\t\tdest[j] = '\\0';\n\treturn j;\n}\nEXPORT_SYMBOL(ucs2_as_utf8);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}