{
  "module_name": "audit.c",
  "hash_id": "a6febdcb0fbab4616cdda89b3bb2945384f68ad23322c02486b451b63f42fbe6",
  "original_prompt": "Ingested from linux-6.6.14/lib/audit.c",
  "human_readable_source": "\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/audit.h>\n#include <asm/unistd.h>\n\nstatic unsigned dir_class[] = {\n#include <asm-generic/audit_dir_write.h>\n~0U\n};\n\nstatic unsigned read_class[] = {\n#include <asm-generic/audit_read.h>\n~0U\n};\n\nstatic unsigned write_class[] = {\n#include <asm-generic/audit_write.h>\n~0U\n};\n\nstatic unsigned chattr_class[] = {\n#include <asm-generic/audit_change_attr.h>\n~0U\n};\n\nstatic unsigned signal_class[] = {\n#include <asm-generic/audit_signal.h>\n~0U\n};\n\nint audit_classify_arch(int arch)\n{\n\tif (audit_is_compat(arch))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nint audit_classify_syscall(int abi, unsigned syscall)\n{\n\tif (audit_is_compat(abi))\n\t\treturn audit_classify_compat_syscall(abi, syscall);\n\n\tswitch(syscall) {\n#ifdef __NR_open\n\tcase __NR_open:\n\t\treturn AUDITSC_OPEN;\n#endif\n#ifdef __NR_openat\n\tcase __NR_openat:\n\t\treturn AUDITSC_OPENAT;\n#endif\n#ifdef __NR_socketcall\n\tcase __NR_socketcall:\n\t\treturn AUDITSC_SOCKETCALL;\n#endif\n#ifdef __NR_execveat\n\tcase __NR_execveat:\n#endif\n\tcase __NR_execve:\n\t\treturn AUDITSC_EXECVE;\n#ifdef __NR_openat2\n\tcase __NR_openat2:\n\t\treturn AUDITSC_OPENAT2;\n#endif\n\tdefault:\n\t\treturn AUDITSC_NATIVE;\n\t}\n}\n\nstatic int __init audit_classes_init(void)\n{\n#ifdef CONFIG_AUDIT_COMPAT_GENERIC\n\taudit_register_class(AUDIT_CLASS_WRITE_32, compat_write_class);\n\taudit_register_class(AUDIT_CLASS_READ_32, compat_read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE_32, compat_dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR_32, compat_chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL_32, compat_signal_class);\n#endif\n\taudit_register_class(AUDIT_CLASS_WRITE, write_class);\n\taudit_register_class(AUDIT_CLASS_READ, read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE, dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR, chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL, signal_class);\n\treturn 0;\n}\n\n__initcall(audit_classes_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}