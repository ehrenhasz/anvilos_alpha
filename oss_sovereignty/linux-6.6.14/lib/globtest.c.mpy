{
  "module_name": "globtest.c",
  "hash_id": "3f9d86084ea8d6f8528c1e9d0636a7ba13e35ad276aeabccc3d0b4f65bacbe7a",
  "original_prompt": "Ingested from linux-6.6.14/lib/globtest.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/glob.h>\n#include <linux/printk.h>\n\n \nstatic bool verbose = false;\nmodule_param(verbose, bool, 0);\n\nstruct glob_test {\n\tchar const *pat, *str;\n\tbool expected;\n};\n\nstatic bool __pure __init test(char const *pat, char const *str, bool expected)\n{\n\tbool match = glob_match(pat, str);\n\tbool success = match == expected;\n\n\t \n\tstatic char const msg_error[] __initconst =\n\t\tKERN_ERR \"glob: \\\"%s\\\" vs. \\\"%s\\\": %s *** ERROR ***\\n\";\n\tstatic char const msg_ok[] __initconst =\n\t\tKERN_DEBUG \"glob: \\\"%s\\\" vs. \\\"%s\\\": %s OK\\n\";\n\tstatic char const mismatch[] __initconst = \"mismatch\";\n\tchar const *message;\n\n\tif (!success)\n\t\tmessage = msg_error;\n\telse if (verbose)\n\t\tmessage = msg_ok;\n\telse\n\t\treturn success;\n\n\tprintk(message, pat, str, mismatch + 3*match);\n\treturn success;\n}\n\n \nstatic char const glob_tests[] __initconst =\n\t \n\t\"1\" \"a\\0\" \"a\\0\"\n\t\"0\" \"a\\0\" \"b\\0\"\n\t\"0\" \"a\\0\" \"aa\\0\"\n\t\"0\" \"a\\0\" \"\\0\"\n\t\"1\" \"\\0\" \"\\0\"\n\t\"0\" \"\\0\" \"a\\0\"\n\t \n\t\"1\" \"[a]\\0\" \"a\\0\"\n\t\"0\" \"[a]\\0\" \"b\\0\"\n\t\"0\" \"[!a]\\0\" \"a\\0\"\n\t\"1\" \"[!a]\\0\" \"b\\0\"\n\t\"1\" \"[ab]\\0\" \"a\\0\"\n\t\"1\" \"[ab]\\0\" \"b\\0\"\n\t\"0\" \"[ab]\\0\" \"c\\0\"\n\t\"1\" \"[!ab]\\0\" \"c\\0\"\n\t\"1\" \"[a-c]\\0\" \"b\\0\"\n\t\"0\" \"[a-c]\\0\" \"d\\0\"\n\t \n\t\"1\" \"[a-c-e-g]\\0\" \"-\\0\"\n\t\"0\" \"[a-c-e-g]\\0\" \"d\\0\"\n\t\"1\" \"[a-c-e-g]\\0\" \"f\\0\"\n\t\"1\" \"[]a-ceg-ik[]\\0\" \"a\\0\"\n\t\"1\" \"[]a-ceg-ik[]\\0\" \"]\\0\"\n\t\"1\" \"[]a-ceg-ik[]\\0\" \"[\\0\"\n\t\"1\" \"[]a-ceg-ik[]\\0\" \"h\\0\"\n\t\"0\" \"[]a-ceg-ik[]\\0\" \"f\\0\"\n\t\"0\" \"[!]a-ceg-ik[]\\0\" \"h\\0\"\n\t\"0\" \"[!]a-ceg-ik[]\\0\" \"]\\0\"\n\t\"1\" \"[!]a-ceg-ik[]\\0\" \"f\\0\"\n\t \n\t\"1\" \"?\\0\" \"a\\0\"\n\t\"0\" \"?\\0\" \"aa\\0\"\n\t\"0\" \"??\\0\" \"a\\0\"\n\t\"1\" \"?x?\\0\" \"axb\\0\"\n\t\"0\" \"?x?\\0\" \"abx\\0\"\n\t\"0\" \"?x?\\0\" \"xab\\0\"\n\t \n\t\"0\" \"*??\\0\" \"a\\0\"\n\t\"1\" \"*??\\0\" \"ab\\0\"\n\t\"1\" \"*??\\0\" \"abc\\0\"\n\t\"1\" \"*??\\0\" \"abcd\\0\"\n\t\"0\" \"??*\\0\" \"a\\0\"\n\t\"1\" \"??*\\0\" \"ab\\0\"\n\t\"1\" \"??*\\0\" \"abc\\0\"\n\t\"1\" \"??*\\0\" \"abcd\\0\"\n\t\"0\" \"?*?\\0\" \"a\\0\"\n\t\"1\" \"?*?\\0\" \"ab\\0\"\n\t\"1\" \"?*?\\0\" \"abc\\0\"\n\t\"1\" \"?*?\\0\" \"abcd\\0\"\n\t\"1\" \"*b\\0\" \"b\\0\"\n\t\"1\" \"*b\\0\" \"ab\\0\"\n\t\"0\" \"*b\\0\" \"ba\\0\"\n\t\"1\" \"*b\\0\" \"bb\\0\"\n\t\"1\" \"*b\\0\" \"abb\\0\"\n\t\"1\" \"*b\\0\" \"bab\\0\"\n\t\"1\" \"*bc\\0\" \"abbc\\0\"\n\t\"1\" \"*bc\\0\" \"bc\\0\"\n\t\"1\" \"*bc\\0\" \"bbc\\0\"\n\t\"1\" \"*bc\\0\" \"bcbc\\0\"\n\t \n\t\"1\" \"*ac*\\0\" \"abacadaeafag\\0\"\n\t\"1\" \"*ac*ae*ag*\\0\" \"abacadaeafag\\0\"\n\t\"1\" \"*a*b*[bc]*[ef]*g*\\0\" \"abacadaeafag\\0\"\n\t\"0\" \"*a*b*[ef]*[cd]*g*\\0\" \"abacadaeafag\\0\"\n\t\"1\" \"*abcd*\\0\" \"abcabcabcabcdefg\\0\"\n\t\"1\" \"*ab*cd*\\0\" \"abcabcabcabcdefg\\0\"\n\t\"1\" \"*abcd*abcdef*\\0\" \"abcabcdabcdeabcdefg\\0\"\n\t\"0\" \"*abcd*\\0\" \"abcabcabcabcefg\\0\"\n\t\"0\" \"*ab*cd*\\0\" \"abcabcabcabcefg\\0\";\n\nstatic int __init glob_init(void)\n{\n\tunsigned successes = 0;\n\tunsigned n = 0;\n\tchar const *p = glob_tests;\n\tstatic char const message[] __initconst =\n\t\tKERN_INFO \"glob: %u self-tests passed, %u failed\\n\";\n\n\t \n\twhile (*p) {\n\t\tbool expected = *p++ & 1;\n\t\tchar const *pat = p;\n\n\t\tp += strlen(p) + 1;\n\t\tsuccesses += test(pat, p, expected);\n\t\tp += strlen(p) + 1;\n\t\tn++;\n\t}\n\n\tn -= successes;\n\tprintk(message, successes, n);\n\n\t \n\treturn n ? -ECANCELED : 0;\n}\n\n \nstatic void __exit glob_fini(void) { }\n\nmodule_init(glob_init);\nmodule_exit(glob_fini);\n\nMODULE_DESCRIPTION(\"glob(7) matching tests\");\nMODULE_LICENSE(\"Dual MIT/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}