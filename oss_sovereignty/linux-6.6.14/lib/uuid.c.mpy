{
  "module_name": "uuid.c",
  "hash_id": "56fc2db72504b690f688848f1409969c3ee07e9ff96ea1d904b5b14c3025099c",
  "original_prompt": "Ingested from linux-6.6.14/lib/uuid.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/ctype.h>\n#include <linux/errno.h>\n#include <linux/export.h>\n#include <linux/uuid.h>\n#include <linux/random.h>\n\nconst guid_t guid_null;\nEXPORT_SYMBOL(guid_null);\nconst uuid_t uuid_null;\nEXPORT_SYMBOL(uuid_null);\n\nconst u8 guid_index[16] = {3,2,1,0,5,4,7,6,8,9,10,11,12,13,14,15};\nconst u8 uuid_index[16] = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};\n\n \nvoid generate_random_uuid(unsigned char uuid[16])\n{\n\tget_random_bytes(uuid, 16);\n\t \n\tuuid[6] = (uuid[6] & 0x0F) | 0x40;\n\t \n\tuuid[8] = (uuid[8] & 0x3F) | 0x80;\n}\nEXPORT_SYMBOL(generate_random_uuid);\n\nvoid generate_random_guid(unsigned char guid[16])\n{\n\tget_random_bytes(guid, 16);\n\t \n\tguid[7] = (guid[7] & 0x0F) | 0x40;\n\t \n\tguid[8] = (guid[8] & 0x3F) | 0x80;\n}\nEXPORT_SYMBOL(generate_random_guid);\n\nstatic void __uuid_gen_common(__u8 b[16])\n{\n\tget_random_bytes(b, 16);\n\t \n\tb[8] = (b[8] & 0x3F) | 0x80;\n}\n\nvoid guid_gen(guid_t *lu)\n{\n\t__uuid_gen_common(lu->b);\n\t \n\tlu->b[7] = (lu->b[7] & 0x0F) | 0x40;\n}\nEXPORT_SYMBOL_GPL(guid_gen);\n\nvoid uuid_gen(uuid_t *bu)\n{\n\t__uuid_gen_common(bu->b);\n\t \n\tbu->b[6] = (bu->b[6] & 0x0F) | 0x40;\n}\nEXPORT_SYMBOL_GPL(uuid_gen);\n\n \nbool uuid_is_valid(const char *uuid)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < UUID_STRING_LEN; i++) {\n\t\tif (i == 8 || i == 13 || i == 18 || i == 23) {\n\t\t\tif (uuid[i] != '-')\n\t\t\t\treturn false;\n\t\t} else if (!isxdigit(uuid[i])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\nEXPORT_SYMBOL(uuid_is_valid);\n\nstatic int __uuid_parse(const char *uuid, __u8 b[16], const u8 ei[16])\n{\n\tstatic const u8 si[16] = {0,2,4,6,9,11,14,16,19,21,24,26,28,30,32,34};\n\tunsigned int i;\n\n\tif (!uuid_is_valid(uuid))\n\t\treturn -EINVAL;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tint hi = hex_to_bin(uuid[si[i] + 0]);\n\t\tint lo = hex_to_bin(uuid[si[i] + 1]);\n\n\t\tb[ei[i]] = (hi << 4) | lo;\n\t}\n\n\treturn 0;\n}\n\nint guid_parse(const char *uuid, guid_t *u)\n{\n\treturn __uuid_parse(uuid, u->b, guid_index);\n}\nEXPORT_SYMBOL(guid_parse);\n\nint uuid_parse(const char *uuid, uuid_t *u)\n{\n\treturn __uuid_parse(uuid, u->b, uuid_index);\n}\nEXPORT_SYMBOL(uuid_parse);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}