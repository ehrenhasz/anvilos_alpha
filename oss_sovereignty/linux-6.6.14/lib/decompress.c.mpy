{
  "module_name": "decompress.c",
  "hash_id": "90964e41a53cb8f28e83d52dccb0fe594f0d827e2ae643bd1f6201cc7a216c3e",
  "original_prompt": "Ingested from linux-6.6.14/lib/decompress.c",
  "human_readable_source": "\n \n\n#include <linux/decompress/generic.h>\n\n#include <linux/decompress/bunzip2.h>\n#include <linux/decompress/unlzma.h>\n#include <linux/decompress/unxz.h>\n#include <linux/decompress/inflate.h>\n#include <linux/decompress/unlzo.h>\n#include <linux/decompress/unlz4.h>\n#include <linux/decompress/unzstd.h>\n\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/init.h>\n#include <linux/printk.h>\n\n#ifndef CONFIG_DECOMPRESS_GZIP\n# define gunzip NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_BZIP2\n# define bunzip2 NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_LZMA\n# define unlzma NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_XZ\n# define unxz NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_LZO\n# define unlzo NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_LZ4\n# define unlz4 NULL\n#endif\n#ifndef CONFIG_DECOMPRESS_ZSTD\n# define unzstd NULL\n#endif\n\nstruct compress_format {\n\tunsigned char magic[2];\n\tconst char *name;\n\tdecompress_fn decompressor;\n};\n\nstatic const struct compress_format compressed_formats[] __initconst = {\n\t{ {0x1f, 0x8b}, \"gzip\", gunzip },\n\t{ {0x1f, 0x9e}, \"gzip\", gunzip },\n\t{ {0x42, 0x5a}, \"bzip2\", bunzip2 },\n\t{ {0x5d, 0x00}, \"lzma\", unlzma },\n\t{ {0xfd, 0x37}, \"xz\", unxz },\n\t{ {0x89, 0x4c}, \"lzo\", unlzo },\n\t{ {0x02, 0x21}, \"lz4\", unlz4 },\n\t{ {0x28, 0xb5}, \"zstd\", unzstd },\n\t{ {0, 0}, NULL, NULL }\n};\n\ndecompress_fn __init decompress_method(const unsigned char *inbuf, long len,\n\t\t\t\tconst char **name)\n{\n\tconst struct compress_format *cf;\n\n\tif (len < 2) {\n\t\tif (name)\n\t\t\t*name = NULL;\n\t\treturn NULL;\t \n\t}\n\n\tpr_debug(\"Compressed data magic: %#.2x %#.2x\\n\", inbuf[0], inbuf[1]);\n\n\tfor (cf = compressed_formats; cf->name; cf++) {\n\t\tif (!memcmp(inbuf, cf->magic, 2))\n\t\t\tbreak;\n\n\t}\n\tif (name)\n\t\t*name = cf->name;\n\treturn cf->decompressor;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}