{
  "module_name": "percpu_test.c",
  "hash_id": "4d687043a438c184d0d07dd4ba145d73a58b8dd824964a9ea170b509bae943f6",
  "original_prompt": "Ingested from linux-6.6.14/lib/percpu_test.c",
  "human_readable_source": "\n#include <linux/module.h>\n\n \n#define CHECK(native, pcp, expected)                                    \\\n\tdo {                                                            \\\n\t\tWARN((native) != (expected),                            \\\n\t\t     \"raw %ld (0x%lx) != expected %lld (0x%llx)\",\t\\\n\t\t     (native), (native),\t\t\t\t\\\n\t\t     (long long)(expected), (long long)(expected));\t\\\n\t\tWARN(__this_cpu_read(pcp) != (expected),                \\\n\t\t     \"pcp %ld (0x%lx) != expected %lld (0x%llx)\",\t\\\n\t\t     __this_cpu_read(pcp), __this_cpu_read(pcp),\t\\\n\t\t     (long long)(expected), (long long)(expected));\t\\\n\t} while (0)\n\nstatic DEFINE_PER_CPU(long, long_counter);\nstatic DEFINE_PER_CPU(unsigned long, ulong_counter);\n\nstatic int __init percpu_test_init(void)\n{\n\t \n\tvolatile unsigned int ui_one = 1;\n\tlong l = 0;\n\tunsigned long ul = 0;\n\n\tpr_info(\"percpu test start\\n\");\n\n\tpreempt_disable();\n\n\tl += -1;\n\t__this_cpu_add(long_counter, -1);\n\tCHECK(l, long_counter, -1);\n\n\tl += 1;\n\t__this_cpu_add(long_counter, 1);\n\tCHECK(l, long_counter, 0);\n\n\tul = 0;\n\t__this_cpu_write(ulong_counter, 0);\n\n\tul += 1UL;\n\t__this_cpu_add(ulong_counter, 1UL);\n\tCHECK(ul, ulong_counter, 1);\n\n\tul += -1UL;\n\t__this_cpu_add(ulong_counter, -1UL);\n\tCHECK(ul, ulong_counter, 0);\n\n\tul += -(unsigned long)1;\n\t__this_cpu_add(ulong_counter, -(unsigned long)1);\n\tCHECK(ul, ulong_counter, -1);\n\n\tul = 0;\n\t__this_cpu_write(ulong_counter, 0);\n\n\tul -= 1;\n\t__this_cpu_dec(ulong_counter);\n\tCHECK(ul, ulong_counter, -1);\n\tCHECK(ul, ulong_counter, ULONG_MAX);\n\n\tl += -ui_one;\n\t__this_cpu_add(long_counter, -ui_one);\n\tCHECK(l, long_counter, 0xffffffff);\n\n\tl += ui_one;\n\t__this_cpu_add(long_counter, ui_one);\n\tCHECK(l, long_counter, (long)0x100000000LL);\n\n\n\tl = 0;\n\t__this_cpu_write(long_counter, 0);\n\n\tl -= ui_one;\n\t__this_cpu_sub(long_counter, ui_one);\n\tCHECK(l, long_counter, -1);\n\n\tl = 0;\n\t__this_cpu_write(long_counter, 0);\n\n\tl += ui_one;\n\t__this_cpu_add(long_counter, ui_one);\n\tCHECK(l, long_counter, 1);\n\n\tl += -ui_one;\n\t__this_cpu_add(long_counter, -ui_one);\n\tCHECK(l, long_counter, (long)0x100000000LL);\n\n\tl = 0;\n\t__this_cpu_write(long_counter, 0);\n\n\tl -= ui_one;\n\tthis_cpu_sub(long_counter, ui_one);\n\tCHECK(l, long_counter, -1);\n\tCHECK(l, long_counter, ULONG_MAX);\n\n\tul = 0;\n\t__this_cpu_write(ulong_counter, 0);\n\n\tul += ui_one;\n\t__this_cpu_add(ulong_counter, ui_one);\n\tCHECK(ul, ulong_counter, 1);\n\n\tul = 0;\n\t__this_cpu_write(ulong_counter, 0);\n\n\tul -= ui_one;\n\t__this_cpu_sub(ulong_counter, ui_one);\n\tCHECK(ul, ulong_counter, -1);\n\tCHECK(ul, ulong_counter, ULONG_MAX);\n\n\tul = 3;\n\t__this_cpu_write(ulong_counter, 3);\n\n\tul = this_cpu_sub_return(ulong_counter, ui_one);\n\tCHECK(ul, ulong_counter, 2);\n\n\tul = __this_cpu_sub_return(ulong_counter, ui_one);\n\tCHECK(ul, ulong_counter, 1);\n\n\tpreempt_enable();\n\n\tpr_info(\"percpu test done\\n\");\n\treturn -EAGAIN;   \n}\n\nstatic void __exit percpu_test_exit(void)\n{\n}\n\nmodule_init(percpu_test_init)\nmodule_exit(percpu_test_exit)\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Greg Thelen\");\nMODULE_DESCRIPTION(\"percpu operations test\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}