{
  "module_name": "mktables.c",
  "hash_id": "20312592368ce03485dac016d77268781adbf77cfb9d0c2c2beb30b7b6d7ca53",
  "original_prompt": "Ingested from linux-6.6.14/lib/raid6/mktables.c",
  "human_readable_source": "\n \n\n \n\n#include <stdio.h>\n#include <string.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <time.h>\n\nstatic uint8_t gfmul(uint8_t a, uint8_t b)\n{\n\tuint8_t v = 0;\n\n\twhile (b) {\n\t\tif (b & 1)\n\t\t\tv ^= a;\n\t\ta = (a << 1) ^ (a & 0x80 ? 0x1d : 0);\n\t\tb >>= 1;\n\t}\n\n\treturn v;\n}\n\nstatic uint8_t gfpow(uint8_t a, int b)\n{\n\tuint8_t v = 1;\n\n\tb %= 255;\n\tif (b < 0)\n\t\tb += 255;\n\n\twhile (b) {\n\t\tif (b & 1)\n\t\t\tv = gfmul(v, a);\n\t\ta = gfmul(a, a);\n\t\tb >>= 1;\n\t}\n\n\treturn v;\n}\n\nint main(int argc, char *argv[])\n{\n\tint i, j, k;\n\tuint8_t v;\n\tuint8_t exptbl[256], invtbl[256];\n\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"#include <linux/export.h>\\n\");\n\tprintf(\"#endif\\n\");\n\tprintf(\"#include <linux/raid/pq.h>\\n\");\n\n\t \n\tprintf(\"\\nconst u8  __attribute__((aligned(256)))\\n\"\n\t\t\"raid6_gfmul[256][256] =\\n\"\n\t\t\"{\\n\");\n\tfor (i = 0; i < 256; i++) {\n\t\tprintf(\"\\t{\\n\");\n\t\tfor (j = 0; j < 256; j += 8) {\n\t\t\tprintf(\"\\t\\t\");\n\t\t\tfor (k = 0; k < 8; k++)\n\t\t\t\tprintf(\"0x%02x,%c\", gfmul(i, j + k),\n\t\t\t\t       (k == 7) ? '\\n' : ' ');\n\t\t}\n\t\tprintf(\"\\t},\\n\");\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_gfmul);\\n\");\n\tprintf(\"#endif\\n\");\n\n\t \n\tprintf(\"\\nconst u8  __attribute__((aligned(256)))\\n\"\n\t\t\"raid6_vgfmul[256][32] =\\n\"\n\t\t\"{\\n\");\n\tfor (i = 0; i < 256; i++) {\n\t\tprintf(\"\\t{\\n\");\n\t\tfor (j = 0; j < 16; j += 8) {\n\t\t\tprintf(\"\\t\\t\");\n\t\t\tfor (k = 0; k < 8; k++)\n\t\t\t\tprintf(\"0x%02x,%c\", gfmul(i, j + k),\n\t\t\t\t       (k == 7) ? '\\n' : ' ');\n\t\t}\n\t\tfor (j = 0; j < 16; j += 8) {\n\t\t\tprintf(\"\\t\\t\");\n\t\t\tfor (k = 0; k < 8; k++)\n\t\t\t\tprintf(\"0x%02x,%c\", gfmul(i, (j + k) << 4),\n\t\t\t\t       (k == 7) ? '\\n' : ' ');\n\t\t}\n\t\tprintf(\"\\t},\\n\");\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_vgfmul);\\n\");\n\tprintf(\"#endif\\n\");\n\n\t \n\tv = 1;\n\tprintf(\"\\nconst u8 __attribute__((aligned(256)))\\n\"\n\t       \"raid6_gfexp[256] =\\n\" \"{\\n\");\n\tfor (i = 0; i < 256; i += 8) {\n\t\tprintf(\"\\t\");\n\t\tfor (j = 0; j < 8; j++) {\n\t\t\texptbl[i + j] = v;\n\t\t\tprintf(\"0x%02x,%c\", v, (j == 7) ? '\\n' : ' ');\n\t\t\tv = gfmul(v, 2);\n\t\t\tif (v == 1)\n\t\t\t\tv = 0;\t \n\t\t}\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_gfexp);\\n\");\n\tprintf(\"#endif\\n\");\n\n\t \n\tprintf(\"\\nconst u8 __attribute__((aligned(256)))\\n\"\n\t       \"raid6_gflog[256] =\\n\" \"{\\n\");\n\tfor (i = 0; i < 256; i += 8) {\n\t\tprintf(\"\\t\");\n\t\tfor (j = 0; j < 8; j++) {\n\t\t\tv = 255;\n\t\t\tfor (k = 0; k < 256; k++)\n\t\t\t\tif (exptbl[k] == (i + j)) {\n\t\t\t\t\tv = k;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tprintf(\"0x%02x,%c\", v, (j == 7) ? '\\n' : ' ');\n\t\t}\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_gflog);\\n\");\n\tprintf(\"#endif\\n\");\n\n\t \n\tprintf(\"\\nconst u8 __attribute__((aligned(256)))\\n\"\n\t       \"raid6_gfinv[256] =\\n\" \"{\\n\");\n\tfor (i = 0; i < 256; i += 8) {\n\t\tprintf(\"\\t\");\n\t\tfor (j = 0; j < 8; j++) {\n\t\t\tinvtbl[i + j] = v = gfpow(i + j, 254);\n\t\t\tprintf(\"0x%02x,%c\", v, (j == 7) ? '\\n' : ' ');\n\t\t}\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_gfinv);\\n\");\n\tprintf(\"#endif\\n\");\n\n\t \n\tprintf(\"\\nconst u8 __attribute__((aligned(256)))\\n\"\n\t       \"raid6_gfexi[256] =\\n\" \"{\\n\");\n\tfor (i = 0; i < 256; i += 8) {\n\t\tprintf(\"\\t\");\n\t\tfor (j = 0; j < 8; j++)\n\t\t\tprintf(\"0x%02x,%c\", invtbl[exptbl[i + j] ^ 1],\n\t\t\t       (j == 7) ? '\\n' : ' ');\n\t}\n\tprintf(\"};\\n\");\n\tprintf(\"#ifdef __KERNEL__\\n\");\n\tprintf(\"EXPORT_SYMBOL(raid6_gfexi);\\n\");\n\tprintf(\"#endif\\n\");\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}