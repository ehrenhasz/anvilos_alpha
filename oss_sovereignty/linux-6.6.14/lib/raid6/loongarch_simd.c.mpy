{
  "module_name": "loongarch_simd.c",
  "hash_id": "ade36be197d8b48e2b37e22ca75261cb4903f2e14eb47ecbfbcddd1e50123644",
  "original_prompt": "Ingested from linux-6.6.14/lib/raid6/loongarch_simd.c",
  "human_readable_source": "\n \n\n#include <linux/raid/pq.h>\n#include \"loongarch.h\"\n\n \n\n#ifdef CONFIG_CPU_HAS_LSX\n#define NSIZE 16\n\nstatic int raid6_has_lsx(void)\n{\n\treturn cpu_has_lsx;\n}\n\nstatic void raid6_lsx_gen_syndrome(int disks, size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = disks - 3;\t\t \n\tp = dptr[z0+1];\t\t \n\tq = dptr[z0+2];\t\t \n\n\tkernel_fpu_begin();\n\n\t \n\tfor (d = 0; d < bytes; d += NSIZE*4) {\n\t\t \n\t\tasm volatile(\"vld $vr0, %0\" : : \"m\"(dptr[z0][d+0*NSIZE]));\n\t\tasm volatile(\"vld $vr1, %0\" : : \"m\"(dptr[z0][d+1*NSIZE]));\n\t\tasm volatile(\"vld $vr2, %0\" : : \"m\"(dptr[z0][d+2*NSIZE]));\n\t\tasm volatile(\"vld $vr3, %0\" : : \"m\"(dptr[z0][d+3*NSIZE]));\n\t\tasm volatile(\"vori.b $vr4, $vr0, 0\");\n\t\tasm volatile(\"vori.b $vr5, $vr1, 0\");\n\t\tasm volatile(\"vori.b $vr6, $vr2, 0\");\n\t\tasm volatile(\"vori.b $vr7, $vr3, 0\");\n\t\tfor (z = z0-1; z >= 0; z--) {\n\t\t\t \n\t\t\tasm volatile(\"vld $vr8, %0\" : : \"m\"(dptr[z][d+0*NSIZE]));\n\t\t\tasm volatile(\"vld $vr9, %0\" : : \"m\"(dptr[z][d+1*NSIZE]));\n\t\t\tasm volatile(\"vld $vr10, %0\" : : \"m\"(dptr[z][d+2*NSIZE]));\n\t\t\tasm volatile(\"vld $vr11, %0\" : : \"m\"(dptr[z][d+3*NSIZE]));\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr0, $vr0, $vr8\");\n\t\t\tasm volatile(\"vxor.v $vr1, $vr1, $vr9\");\n\t\t\tasm volatile(\"vxor.v $vr2, $vr2, $vr10\");\n\t\t\tasm volatile(\"vxor.v $vr3, $vr3, $vr11\");\n\t\t\t \n\t\t\tasm volatile(\"vslti.b $vr12, $vr4, 0\");\n\t\t\tasm volatile(\"vslti.b $vr13, $vr5, 0\");\n\t\t\tasm volatile(\"vslti.b $vr14, $vr6, 0\");\n\t\t\tasm volatile(\"vslti.b $vr15, $vr7, 0\");\n\t\t\t \n\t\t\tasm volatile(\"vslli.b $vr16, $vr4, 1\");\n\t\t\tasm volatile(\"vslli.b $vr17, $vr5, 1\");\n\t\t\tasm volatile(\"vslli.b $vr18, $vr6, 1\");\n\t\t\tasm volatile(\"vslli.b $vr19, $vr7, 1\");\n\t\t\t \n\t\t\tasm volatile(\"vandi.b $vr12, $vr12, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr13, $vr13, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr14, $vr14, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr15, $vr15, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr16, $vr16, $vr12\");\n\t\t\tasm volatile(\"vxor.v $vr17, $vr17, $vr13\");\n\t\t\tasm volatile(\"vxor.v $vr18, $vr18, $vr14\");\n\t\t\tasm volatile(\"vxor.v $vr19, $vr19, $vr15\");\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr4, $vr16, $vr8\");\n\t\t\tasm volatile(\"vxor.v $vr5, $vr17, $vr9\");\n\t\t\tasm volatile(\"vxor.v $vr6, $vr18, $vr10\");\n\t\t\tasm volatile(\"vxor.v $vr7, $vr19, $vr11\");\n\t\t}\n\t\t \n\t\tasm volatile(\"vst $vr0, %0\" : \"=m\"(p[d+NSIZE*0]));\n\t\tasm volatile(\"vst $vr1, %0\" : \"=m\"(p[d+NSIZE*1]));\n\t\tasm volatile(\"vst $vr2, %0\" : \"=m\"(p[d+NSIZE*2]));\n\t\tasm volatile(\"vst $vr3, %0\" : \"=m\"(p[d+NSIZE*3]));\n\t\t \n\t\tasm volatile(\"vst $vr4, %0\" : \"=m\"(q[d+NSIZE*0]));\n\t\tasm volatile(\"vst $vr5, %0\" : \"=m\"(q[d+NSIZE*1]));\n\t\tasm volatile(\"vst $vr6, %0\" : \"=m\"(q[d+NSIZE*2]));\n\t\tasm volatile(\"vst $vr7, %0\" : \"=m\"(q[d+NSIZE*3]));\n\t}\n\n\tkernel_fpu_end();\n}\n\nstatic void raid6_lsx_xor_syndrome(int disks, int start, int stop,\n\t\t\t\t   size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = stop;\t\t \n\tp = dptr[disks-2];\t \n\tq = dptr[disks-1];\t \n\n\tkernel_fpu_begin();\n\n\t \n\tfor (d = 0; d < bytes; d += NSIZE*4) {\n\t\t \n\t\t \n\t\tasm volatile(\"vld $vr0, %0\" : : \"m\"(dptr[z0][d+0*NSIZE]));\n\t\tasm volatile(\"vld $vr1, %0\" : : \"m\"(dptr[z0][d+1*NSIZE]));\n\t\tasm volatile(\"vld $vr2, %0\" : : \"m\"(dptr[z0][d+2*NSIZE]));\n\t\tasm volatile(\"vld $vr3, %0\" : : \"m\"(dptr[z0][d+3*NSIZE]));\n\t\tasm volatile(\"vori.b $vr4, $vr0, 0\");\n\t\tasm volatile(\"vori.b $vr5, $vr1, 0\");\n\t\tasm volatile(\"vori.b $vr6, $vr2, 0\");\n\t\tasm volatile(\"vori.b $vr7, $vr3, 0\");\n\t\tfor (z = z0-1; z >= start; z--) {\n\t\t\t \n\t\t\tasm volatile(\"vld $vr8, %0\" : : \"m\"(dptr[z][d+0*NSIZE]));\n\t\t\tasm volatile(\"vld $vr9, %0\" : : \"m\"(dptr[z][d+1*NSIZE]));\n\t\t\tasm volatile(\"vld $vr10, %0\" : : \"m\"(dptr[z][d+2*NSIZE]));\n\t\t\tasm volatile(\"vld $vr11, %0\" : : \"m\"(dptr[z][d+3*NSIZE]));\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr0, $vr0, $vr8\");\n\t\t\tasm volatile(\"vxor.v $vr1, $vr1, $vr9\");\n\t\t\tasm volatile(\"vxor.v $vr2, $vr2, $vr10\");\n\t\t\tasm volatile(\"vxor.v $vr3, $vr3, $vr11\");\n\t\t\t \n\t\t\tasm volatile(\"vslti.b $vr12, $vr4, 0\");\n\t\t\tasm volatile(\"vslti.b $vr13, $vr5, 0\");\n\t\t\tasm volatile(\"vslti.b $vr14, $vr6, 0\");\n\t\t\tasm volatile(\"vslti.b $vr15, $vr7, 0\");\n\t\t\t \n\t\t\tasm volatile(\"vslli.b $vr16, $vr4, 1\");\n\t\t\tasm volatile(\"vslli.b $vr17, $vr5, 1\");\n\t\t\tasm volatile(\"vslli.b $vr18, $vr6, 1\");\n\t\t\tasm volatile(\"vslli.b $vr19, $vr7, 1\");\n\t\t\t \n\t\t\tasm volatile(\"vandi.b $vr12, $vr12, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr13, $vr13, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr14, $vr14, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr15, $vr15, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr16, $vr16, $vr12\");\n\t\t\tasm volatile(\"vxor.v $vr17, $vr17, $vr13\");\n\t\t\tasm volatile(\"vxor.v $vr18, $vr18, $vr14\");\n\t\t\tasm volatile(\"vxor.v $vr19, $vr19, $vr15\");\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr4, $vr16, $vr8\");\n\t\t\tasm volatile(\"vxor.v $vr5, $vr17, $vr9\");\n\t\t\tasm volatile(\"vxor.v $vr6, $vr18, $vr10\");\n\t\t\tasm volatile(\"vxor.v $vr7, $vr19, $vr11\");\n\t\t}\n\n\t\t \n\t\tfor (z = start-1; z >= 0; z--) {\n\t\t\t \n\t\t\tasm volatile(\"vslti.b $vr12, $vr4, 0\");\n\t\t\tasm volatile(\"vslti.b $vr13, $vr5, 0\");\n\t\t\tasm volatile(\"vslti.b $vr14, $vr6, 0\");\n\t\t\tasm volatile(\"vslti.b $vr15, $vr7, 0\");\n\t\t\t \n\t\t\tasm volatile(\"vslli.b $vr16, $vr4, 1\");\n\t\t\tasm volatile(\"vslli.b $vr17, $vr5, 1\");\n\t\t\tasm volatile(\"vslli.b $vr18, $vr6, 1\");\n\t\t\tasm volatile(\"vslli.b $vr19, $vr7, 1\");\n\t\t\t \n\t\t\tasm volatile(\"vandi.b $vr12, $vr12, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr13, $vr13, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr14, $vr14, 0x1d\");\n\t\t\tasm volatile(\"vandi.b $vr15, $vr15, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"vxor.v $vr4, $vr16, $vr12\");\n\t\t\tasm volatile(\"vxor.v $vr5, $vr17, $vr13\");\n\t\t\tasm volatile(\"vxor.v $vr6, $vr18, $vr14\");\n\t\t\tasm volatile(\"vxor.v $vr7, $vr19, $vr15\");\n\t\t}\n\t\t \n\t\tasm volatile(\n\t\t\t\"vld $vr20, %0\\n\\t\"\n\t\t\t\"vld $vr21, %1\\n\\t\"\n\t\t\t\"vld $vr22, %2\\n\\t\"\n\t\t\t\"vld $vr23, %3\\n\\t\"\n\t\t\t\"vld $vr24, %4\\n\\t\"\n\t\t\t\"vld $vr25, %5\\n\\t\"\n\t\t\t\"vld $vr26, %6\\n\\t\"\n\t\t\t\"vld $vr27, %7\\n\\t\"\n\t\t\t\"vxor.v $vr20, $vr20, $vr0\\n\\t\"\n\t\t\t\"vxor.v $vr21, $vr21, $vr1\\n\\t\"\n\t\t\t\"vxor.v $vr22, $vr22, $vr2\\n\\t\"\n\t\t\t\"vxor.v $vr23, $vr23, $vr3\\n\\t\"\n\t\t\t\"vxor.v $vr24, $vr24, $vr4\\n\\t\"\n\t\t\t\"vxor.v $vr25, $vr25, $vr5\\n\\t\"\n\t\t\t\"vxor.v $vr26, $vr26, $vr6\\n\\t\"\n\t\t\t\"vxor.v $vr27, $vr27, $vr7\\n\\t\"\n\t\t\t\"vst $vr20, %0\\n\\t\"\n\t\t\t\"vst $vr21, %1\\n\\t\"\n\t\t\t\"vst $vr22, %2\\n\\t\"\n\t\t\t\"vst $vr23, %3\\n\\t\"\n\t\t\t\"vst $vr24, %4\\n\\t\"\n\t\t\t\"vst $vr25, %5\\n\\t\"\n\t\t\t\"vst $vr26, %6\\n\\t\"\n\t\t\t\"vst $vr27, %7\\n\\t\"\n\t\t\t: \"+m\"(p[d+NSIZE*0]), \"+m\"(p[d+NSIZE*1]),\n\t\t\t  \"+m\"(p[d+NSIZE*2]), \"+m\"(p[d+NSIZE*3]),\n\t\t\t  \"+m\"(q[d+NSIZE*0]), \"+m\"(q[d+NSIZE*1]),\n\t\t\t  \"+m\"(q[d+NSIZE*2]), \"+m\"(q[d+NSIZE*3])\n\t\t);\n\t}\n\n\tkernel_fpu_end();\n}\n\nconst struct raid6_calls raid6_lsx = {\n\traid6_lsx_gen_syndrome,\n\traid6_lsx_xor_syndrome,\n\traid6_has_lsx,\n\t\"lsx\",\n\t.priority = 0  \n};\n\n#undef NSIZE\n#endif  \n\n#ifdef CONFIG_CPU_HAS_LASX\n#define NSIZE 32\n\nstatic int raid6_has_lasx(void)\n{\n\treturn cpu_has_lasx;\n}\n\nstatic void raid6_lasx_gen_syndrome(int disks, size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = disks - 3;\t\t \n\tp = dptr[z0+1];\t\t \n\tq = dptr[z0+2];\t\t \n\n\tkernel_fpu_begin();\n\n\t \n\tfor (d = 0; d < bytes; d += NSIZE*2) {\n\t\t \n\t\tasm volatile(\"xvld $xr0, %0\" : : \"m\"(dptr[z0][d+0*NSIZE]));\n\t\tasm volatile(\"xvld $xr1, %0\" : : \"m\"(dptr[z0][d+1*NSIZE]));\n\t\tasm volatile(\"xvori.b $xr2, $xr0, 0\");\n\t\tasm volatile(\"xvori.b $xr3, $xr1, 0\");\n\t\tfor (z = z0-1; z >= 0; z--) {\n\t\t\t \n\t\t\tasm volatile(\"xvld $xr4, %0\" : : \"m\"(dptr[z][d+0*NSIZE]));\n\t\t\tasm volatile(\"xvld $xr5, %0\" : : \"m\"(dptr[z][d+1*NSIZE]));\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr0, $xr0, $xr4\");\n\t\t\tasm volatile(\"xvxor.v $xr1, $xr1, $xr5\");\n\t\t\t \n\t\t\tasm volatile(\"xvslti.b $xr6, $xr2, 0\");\n\t\t\tasm volatile(\"xvslti.b $xr7, $xr3, 0\");\n\t\t\t \n\t\t\tasm volatile(\"xvslli.b $xr8, $xr2, 1\");\n\t\t\tasm volatile(\"xvslli.b $xr9, $xr3, 1\");\n\t\t\t \n\t\t\tasm volatile(\"xvandi.b $xr6, $xr6, 0x1d\");\n\t\t\tasm volatile(\"xvandi.b $xr7, $xr7, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr8, $xr8, $xr6\");\n\t\t\tasm volatile(\"xvxor.v $xr9, $xr9, $xr7\");\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr2, $xr8, $xr4\");\n\t\t\tasm volatile(\"xvxor.v $xr3, $xr9, $xr5\");\n\t\t}\n\t\t \n\t\tasm volatile(\"xvst $xr0, %0\" : \"=m\"(p[d+NSIZE*0]));\n\t\tasm volatile(\"xvst $xr1, %0\" : \"=m\"(p[d+NSIZE*1]));\n\t\t \n\t\tasm volatile(\"xvst $xr2, %0\" : \"=m\"(q[d+NSIZE*0]));\n\t\tasm volatile(\"xvst $xr3, %0\" : \"=m\"(q[d+NSIZE*1]));\n\t}\n\n\tkernel_fpu_end();\n}\n\nstatic void raid6_lasx_xor_syndrome(int disks, int start, int stop,\n\t\t\t\t    size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = stop;\t\t \n\tp = dptr[disks-2];\t \n\tq = dptr[disks-1];\t \n\n\tkernel_fpu_begin();\n\n\t \n\tfor (d = 0; d < bytes; d += NSIZE*2) {\n\t\t \n\t\t \n\t\tasm volatile(\"xvld $xr0, %0\" : : \"m\"(dptr[z0][d+0*NSIZE]));\n\t\tasm volatile(\"xvld $xr1, %0\" : : \"m\"(dptr[z0][d+1*NSIZE]));\n\t\tasm volatile(\"xvori.b $xr2, $xr0, 0\");\n\t\tasm volatile(\"xvori.b $xr3, $xr1, 0\");\n\t\tfor (z = z0-1; z >= start; z--) {\n\t\t\t \n\t\t\tasm volatile(\"xvld $xr4, %0\" : : \"m\"(dptr[z][d+0*NSIZE]));\n\t\t\tasm volatile(\"xvld $xr5, %0\" : : \"m\"(dptr[z][d+1*NSIZE]));\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr0, $xr0, $xr4\");\n\t\t\tasm volatile(\"xvxor.v $xr1, $xr1, $xr5\");\n\t\t\t \n\t\t\tasm volatile(\"xvslti.b $xr6, $xr2, 0\");\n\t\t\tasm volatile(\"xvslti.b $xr7, $xr3, 0\");\n\t\t\t \n\t\t\tasm volatile(\"xvslli.b $xr8, $xr2, 1\");\n\t\t\tasm volatile(\"xvslli.b $xr9, $xr3, 1\");\n\t\t\t \n\t\t\tasm volatile(\"xvandi.b $xr6, $xr6, 0x1d\");\n\t\t\tasm volatile(\"xvandi.b $xr7, $xr7, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr8, $xr8, $xr6\");\n\t\t\tasm volatile(\"xvxor.v $xr9, $xr9, $xr7\");\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr2, $xr8, $xr4\");\n\t\t\tasm volatile(\"xvxor.v $xr3, $xr9, $xr5\");\n\t\t}\n\n\t\t \n\t\tfor (z = start-1; z >= 0; z--) {\n\t\t\t \n\t\t\tasm volatile(\"xvslti.b $xr6, $xr2, 0\");\n\t\t\tasm volatile(\"xvslti.b $xr7, $xr3, 0\");\n\t\t\t \n\t\t\tasm volatile(\"xvslli.b $xr8, $xr2, 1\");\n\t\t\tasm volatile(\"xvslli.b $xr9, $xr3, 1\");\n\t\t\t \n\t\t\tasm volatile(\"xvandi.b $xr6, $xr6, 0x1d\");\n\t\t\tasm volatile(\"xvandi.b $xr7, $xr7, 0x1d\");\n\t\t\t \n\t\t\tasm volatile(\"xvxor.v $xr2, $xr8, $xr6\");\n\t\t\tasm volatile(\"xvxor.v $xr3, $xr9, $xr7\");\n\t\t}\n\t\t \n\t\tasm volatile(\n\t\t\t\"xvld $xr10, %0\\n\\t\"\n\t\t\t\"xvld $xr11, %1\\n\\t\"\n\t\t\t\"xvld $xr12, %2\\n\\t\"\n\t\t\t\"xvld $xr13, %3\\n\\t\"\n\t\t\t\"xvxor.v $xr10, $xr10, $xr0\\n\\t\"\n\t\t\t\"xvxor.v $xr11, $xr11, $xr1\\n\\t\"\n\t\t\t\"xvxor.v $xr12, $xr12, $xr2\\n\\t\"\n\t\t\t\"xvxor.v $xr13, $xr13, $xr3\\n\\t\"\n\t\t\t\"xvst $xr10, %0\\n\\t\"\n\t\t\t\"xvst $xr11, %1\\n\\t\"\n\t\t\t\"xvst $xr12, %2\\n\\t\"\n\t\t\t\"xvst $xr13, %3\\n\\t\"\n\t\t\t: \"+m\"(p[d+NSIZE*0]), \"+m\"(p[d+NSIZE*1]),\n\t\t\t  \"+m\"(q[d+NSIZE*0]), \"+m\"(q[d+NSIZE*1])\n\t\t);\n\t}\n\n\tkernel_fpu_end();\n}\n\nconst struct raid6_calls raid6_lasx = {\n\traid6_lasx_gen_syndrome,\n\traid6_lasx_xor_syndrome,\n\traid6_has_lasx,\n\t\"lasx\",\n\t.priority = 0  \n};\n#undef NSIZE\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}