{
  "module_name": "sse1.c",
  "hash_id": "27ddc197ae4faf98d2a2498e72a9728737db53554454b5a61b7c3b367f19da0f",
  "original_prompt": "Ingested from linux-6.6.14/lib/raid6/sse1.c",
  "human_readable_source": "\n \n\n \n\n#ifdef CONFIG_X86_32\n\n#include <linux/raid/pq.h>\n#include \"x86.h\"\n\n \nextern const struct raid6_mmx_constants {\n\tu64 x1d;\n} raid6_mmx_constants;\n\nstatic int raid6_have_sse1_or_mmxext(void)\n{\n\t \n\treturn boot_cpu_has(X86_FEATURE_MMX) &&\n\t\t(boot_cpu_has(X86_FEATURE_XMM) ||\n\t\t boot_cpu_has(X86_FEATURE_MMXEXT));\n}\n\n \nstatic void raid6_sse11_gen_syndrome(int disks, size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = disks - 3;\t\t \n\tp = dptr[z0+1];\t\t \n\tq = dptr[z0+2];\t\t \n\n\tkernel_fpu_begin();\n\n\tasm volatile(\"movq %0,%%mm0\" : : \"m\" (raid6_mmx_constants.x1d));\n\tasm volatile(\"pxor %mm5,%mm5\");\t \n\n\tfor ( d = 0 ; d < bytes ; d += 8 ) {\n\t\tasm volatile(\"prefetchnta %0\" : : \"m\" (dptr[z0][d]));\n\t\tasm volatile(\"movq %0,%%mm2\" : : \"m\" (dptr[z0][d]));  \n\t\tasm volatile(\"prefetchnta %0\" : : \"m\" (dptr[z0-1][d]));\n\t\tasm volatile(\"movq %mm2,%mm4\");\t \n\t\tasm volatile(\"movq %0,%%mm6\" : : \"m\" (dptr[z0-1][d]));\n\t\tfor ( z = z0-2 ; z >= 0 ; z-- ) {\n\t\t\tasm volatile(\"prefetchnta %0\" : : \"m\" (dptr[z][d]));\n\t\t\tasm volatile(\"pcmpgtb %mm4,%mm5\");\n\t\t\tasm volatile(\"paddb %mm4,%mm4\");\n\t\t\tasm volatile(\"pand %mm0,%mm5\");\n\t\t\tasm volatile(\"pxor %mm5,%mm4\");\n\t\t\tasm volatile(\"pxor %mm5,%mm5\");\n\t\t\tasm volatile(\"pxor %mm6,%mm2\");\n\t\t\tasm volatile(\"pxor %mm6,%mm4\");\n\t\t\tasm volatile(\"movq %0,%%mm6\" : : \"m\" (dptr[z][d]));\n\t\t}\n\t\tasm volatile(\"pcmpgtb %mm4,%mm5\");\n\t\tasm volatile(\"paddb %mm4,%mm4\");\n\t\tasm volatile(\"pand %mm0,%mm5\");\n\t\tasm volatile(\"pxor %mm5,%mm4\");\n\t\tasm volatile(\"pxor %mm5,%mm5\");\n\t\tasm volatile(\"pxor %mm6,%mm2\");\n\t\tasm volatile(\"pxor %mm6,%mm4\");\n\n\t\tasm volatile(\"movntq %%mm2,%0\" : \"=m\" (p[d]));\n\t\tasm volatile(\"movntq %%mm4,%0\" : \"=m\" (q[d]));\n\t}\n\n\tasm volatile(\"sfence\" : : : \"memory\");\n\tkernel_fpu_end();\n}\n\nconst struct raid6_calls raid6_sse1x1 = {\n\traid6_sse11_gen_syndrome,\n\tNULL,\t\t\t \n\traid6_have_sse1_or_mmxext,\n\t\"sse1x1\",\n\t1\t\t\t \n};\n\n \nstatic void raid6_sse12_gen_syndrome(int disks, size_t bytes, void **ptrs)\n{\n\tu8 **dptr = (u8 **)ptrs;\n\tu8 *p, *q;\n\tint d, z, z0;\n\n\tz0 = disks - 3;\t\t \n\tp = dptr[z0+1];\t\t \n\tq = dptr[z0+2];\t\t \n\n\tkernel_fpu_begin();\n\n\tasm volatile(\"movq %0,%%mm0\" : : \"m\" (raid6_mmx_constants.x1d));\n\tasm volatile(\"pxor %mm5,%mm5\");\t \n\tasm volatile(\"pxor %mm7,%mm7\");  \n\n\t \n\tfor ( d = 0 ; d < bytes ; d += 16 ) {\n\t\tasm volatile(\"prefetchnta %0\" : : \"m\" (dptr[z0][d]));\n\t\tasm volatile(\"movq %0,%%mm2\" : : \"m\" (dptr[z0][d]));  \n\t\tasm volatile(\"movq %0,%%mm3\" : : \"m\" (dptr[z0][d+8]));  \n\t\tasm volatile(\"movq %mm2,%mm4\");\t \n\t\tasm volatile(\"movq %mm3,%mm6\");  \n\t\tfor ( z = z0-1 ; z >= 0 ; z-- ) {\n\t\t\tasm volatile(\"prefetchnta %0\" : : \"m\" (dptr[z][d]));\n\t\t\tasm volatile(\"pcmpgtb %mm4,%mm5\");\n\t\t\tasm volatile(\"pcmpgtb %mm6,%mm7\");\n\t\t\tasm volatile(\"paddb %mm4,%mm4\");\n\t\t\tasm volatile(\"paddb %mm6,%mm6\");\n\t\t\tasm volatile(\"pand %mm0,%mm5\");\n\t\t\tasm volatile(\"pand %mm0,%mm7\");\n\t\t\tasm volatile(\"pxor %mm5,%mm4\");\n\t\t\tasm volatile(\"pxor %mm7,%mm6\");\n\t\t\tasm volatile(\"movq %0,%%mm5\" : : \"m\" (dptr[z][d]));\n\t\t\tasm volatile(\"movq %0,%%mm7\" : : \"m\" (dptr[z][d+8]));\n\t\t\tasm volatile(\"pxor %mm5,%mm2\");\n\t\t\tasm volatile(\"pxor %mm7,%mm3\");\n\t\t\tasm volatile(\"pxor %mm5,%mm4\");\n\t\t\tasm volatile(\"pxor %mm7,%mm6\");\n\t\t\tasm volatile(\"pxor %mm5,%mm5\");\n\t\t\tasm volatile(\"pxor %mm7,%mm7\");\n\t\t}\n\t\tasm volatile(\"movntq %%mm2,%0\" : \"=m\" (p[d]));\n\t\tasm volatile(\"movntq %%mm3,%0\" : \"=m\" (p[d+8]));\n\t\tasm volatile(\"movntq %%mm4,%0\" : \"=m\" (q[d]));\n\t\tasm volatile(\"movntq %%mm6,%0\" : \"=m\" (q[d+8]));\n\t}\n\n\tasm volatile(\"sfence\" : :: \"memory\");\n\tkernel_fpu_end();\n}\n\nconst struct raid6_calls raid6_sse1x2 = {\n\traid6_sse12_gen_syndrome,\n\tNULL,\t\t\t \n\traid6_have_sse1_or_mmxext,\n\t\"sse1x2\",\n\t1\t\t\t \n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}