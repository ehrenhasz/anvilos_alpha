{
  "module_name": "zstd_compress_module.c",
  "hash_id": "29606900a264edc7ad9f477139eab62b1fdbfe5c4769b4a3f1a7860c99a9b64a",
  "original_prompt": "Ingested from linux-6.6.14/lib/zstd/zstd_compress_module.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/string.h>\n#include <linux/zstd.h>\n\n#include \"common/zstd_deps.h\"\n#include \"common/zstd_internal.h\"\n\n#define ZSTD_FORWARD_IF_ERR(ret)            \\\n\tdo {                                \\\n\t\tsize_t const __ret = (ret); \\\n\t\tif (ZSTD_isError(__ret))    \\\n\t\t\treturn __ret;       \\\n\t} while (0)\n\nstatic size_t zstd_cctx_init(zstd_cctx *cctx, const zstd_parameters *parameters,\n\tunsigned long long pledged_src_size)\n{\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_reset(\n\t\tcctx, ZSTD_reset_session_and_parameters));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setPledgedSrcSize(\n\t\tcctx, pledged_src_size));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_windowLog, parameters->cParams.windowLog));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_hashLog, parameters->cParams.hashLog));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_chainLog, parameters->cParams.chainLog));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_searchLog, parameters->cParams.searchLog));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_minMatch, parameters->cParams.minMatch));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_targetLength, parameters->cParams.targetLength));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_strategy, parameters->cParams.strategy));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_contentSizeFlag, parameters->fParams.contentSizeFlag));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_checksumFlag, parameters->fParams.checksumFlag));\n\tZSTD_FORWARD_IF_ERR(ZSTD_CCtx_setParameter(\n\t\tcctx, ZSTD_c_dictIDFlag, !parameters->fParams.noDictIDFlag));\n\treturn 0;\n}\n\nint zstd_min_clevel(void)\n{\n\treturn ZSTD_minCLevel();\n}\nEXPORT_SYMBOL(zstd_min_clevel);\n\nint zstd_max_clevel(void)\n{\n\treturn ZSTD_maxCLevel();\n}\nEXPORT_SYMBOL(zstd_max_clevel);\n\nsize_t zstd_compress_bound(size_t src_size)\n{\n\treturn ZSTD_compressBound(src_size);\n}\nEXPORT_SYMBOL(zstd_compress_bound);\n\nzstd_parameters zstd_get_params(int level,\n\tunsigned long long estimated_src_size)\n{\n\treturn ZSTD_getParams(level, estimated_src_size, 0);\n}\nEXPORT_SYMBOL(zstd_get_params);\n\nsize_t zstd_cctx_workspace_bound(const zstd_compression_parameters *cparams)\n{\n\treturn ZSTD_estimateCCtxSize_usingCParams(*cparams);\n}\nEXPORT_SYMBOL(zstd_cctx_workspace_bound);\n\nzstd_cctx *zstd_init_cctx(void *workspace, size_t workspace_size)\n{\n\tif (workspace == NULL)\n\t\treturn NULL;\n\treturn ZSTD_initStaticCCtx(workspace, workspace_size);\n}\nEXPORT_SYMBOL(zstd_init_cctx);\n\nsize_t zstd_compress_cctx(zstd_cctx *cctx, void *dst, size_t dst_capacity,\n\tconst void *src, size_t src_size, const zstd_parameters *parameters)\n{\n\tZSTD_FORWARD_IF_ERR(zstd_cctx_init(cctx, parameters, src_size));\n\treturn ZSTD_compress2(cctx, dst, dst_capacity, src, src_size);\n}\nEXPORT_SYMBOL(zstd_compress_cctx);\n\nsize_t zstd_cstream_workspace_bound(const zstd_compression_parameters *cparams)\n{\n\treturn ZSTD_estimateCStreamSize_usingCParams(*cparams);\n}\nEXPORT_SYMBOL(zstd_cstream_workspace_bound);\n\nzstd_cstream *zstd_init_cstream(const zstd_parameters *parameters,\n\tunsigned long long pledged_src_size, void *workspace, size_t workspace_size)\n{\n\tzstd_cstream *cstream;\n\n\tif (workspace == NULL)\n\t\treturn NULL;\n\n\tcstream = ZSTD_initStaticCStream(workspace, workspace_size);\n\tif (cstream == NULL)\n\t\treturn NULL;\n\n\t \n\tif (pledged_src_size == 0)\n\t\tpledged_src_size = ZSTD_CONTENTSIZE_UNKNOWN;\n\n\tif (ZSTD_isError(zstd_cctx_init(cstream, parameters, pledged_src_size)))\n\t\treturn NULL;\n\n\treturn cstream;\n}\nEXPORT_SYMBOL(zstd_init_cstream);\n\nsize_t zstd_reset_cstream(zstd_cstream *cstream,\n\tunsigned long long pledged_src_size)\n{\n\tif (pledged_src_size == 0)\n\t\tpledged_src_size = ZSTD_CONTENTSIZE_UNKNOWN;\n\tZSTD_FORWARD_IF_ERR( ZSTD_CCtx_reset(cstream, ZSTD_reset_session_only) );\n\tZSTD_FORWARD_IF_ERR( ZSTD_CCtx_setPledgedSrcSize(cstream, pledged_src_size) );\n\treturn 0;\n}\nEXPORT_SYMBOL(zstd_reset_cstream);\n\nsize_t zstd_compress_stream(zstd_cstream *cstream, zstd_out_buffer *output,\n\tzstd_in_buffer *input)\n{\n\treturn ZSTD_compressStream(cstream, output, input);\n}\nEXPORT_SYMBOL(zstd_compress_stream);\n\nsize_t zstd_flush_stream(zstd_cstream *cstream, zstd_out_buffer *output)\n{\n\treturn ZSTD_flushStream(cstream, output);\n}\nEXPORT_SYMBOL(zstd_flush_stream);\n\nsize_t zstd_end_stream(zstd_cstream *cstream, zstd_out_buffer *output)\n{\n\treturn ZSTD_endStream(cstream, output);\n}\nEXPORT_SYMBOL(zstd_end_stream);\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\nMODULE_DESCRIPTION(\"Zstd Compressor\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}