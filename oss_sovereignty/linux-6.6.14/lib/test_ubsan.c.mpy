{
  "module_name": "test_ubsan.c",
  "hash_id": "d38fdd1146d9ae813c2c452f0456858cf2f6f45f8870e8880d5a14db91e964b2",
  "original_prompt": "Ingested from linux-6.6.14/lib/test_ubsan.c",
  "human_readable_source": "\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\ntypedef void(*test_ubsan_fp)(void);\n\n#define UBSAN_TEST(config, ...)\tdo {\t\t\t\t\t\\\n\t\tpr_info(\"%s \" __VA_ARGS__ \"%s(%s=%s)\\n\", __func__,\t\\\n\t\t\tsizeof(\" \" __VA_ARGS__) > 2 ? \" \" : \"\",\t\t\\\n\t\t\t#config, IS_ENABLED(config) ? \"y\" : \"n\");\t\\\n\t} while (0)\n\nstatic void test_ubsan_divrem_overflow(void)\n{\n\tvolatile int val = 16;\n\tvolatile int val2 = 0;\n\n\tUBSAN_TEST(CONFIG_UBSAN_DIV_ZERO);\n\tval /= val2;\n}\n\nstatic void test_ubsan_shift_out_of_bounds(void)\n{\n\tvolatile int neg = -1, wrap = 4;\n\tint val1 = 10;\n\tint val2 = INT_MAX;\n\n\tUBSAN_TEST(CONFIG_UBSAN_SHIFT, \"negative exponent\");\n\tval1 <<= neg;\n\n\tUBSAN_TEST(CONFIG_UBSAN_SHIFT, \"left overflow\");\n\tval2 <<= wrap;\n}\n\nstatic void test_ubsan_out_of_bounds(void)\n{\n\tvolatile int i = 4, j = 5, k = -1;\n\tvolatile char above[4] = { };  \n\tvolatile int arr[4];\n\tvolatile char below[4] = { };  \n\n\tabove[0] = below[0];\n\n\tUBSAN_TEST(CONFIG_UBSAN_BOUNDS, \"above\");\n\tarr[j] = i;\n\n\tUBSAN_TEST(CONFIG_UBSAN_BOUNDS, \"below\");\n\tarr[k] = i;\n}\n\nenum ubsan_test_enum {\n\tUBSAN_TEST_ZERO = 0,\n\tUBSAN_TEST_ONE,\n\tUBSAN_TEST_MAX,\n};\n\nstatic void test_ubsan_load_invalid_value(void)\n{\n\tvolatile char *dst, *src;\n\tbool val, val2, *ptr;\n\tenum ubsan_test_enum eval, eval2, *eptr;\n\tunsigned char c = 0xff;\n\n\tUBSAN_TEST(CONFIG_UBSAN_BOOL, \"bool\");\n\tdst = (char *)&val;\n\tsrc = &c;\n\t*dst = *src;\n\n\tptr = &val2;\n\tval2 = val;\n\n\tUBSAN_TEST(CONFIG_UBSAN_ENUM, \"enum\");\n\tdst = (char *)&eval;\n\tsrc = &c;\n\t*dst = *src;\n\n\teptr = &eval2;\n\teval2 = eval;\n}\n\nstatic void test_ubsan_misaligned_access(void)\n{\n\tvolatile char arr[5] __aligned(4) = {1, 2, 3, 4, 5};\n\tvolatile int *ptr, val = 6;\n\n\tUBSAN_TEST(CONFIG_UBSAN_ALIGNMENT);\n\tptr = (int *)(arr + 1);\n\t*ptr = val;\n}\n\nstatic const test_ubsan_fp test_ubsan_array[] = {\n\ttest_ubsan_shift_out_of_bounds,\n\ttest_ubsan_out_of_bounds,\n\ttest_ubsan_load_invalid_value,\n\ttest_ubsan_misaligned_access,\n};\n\n \nstatic const test_ubsan_fp skip_ubsan_array[] = {\n\ttest_ubsan_divrem_overflow,\n};\n\nstatic int __init test_ubsan_init(void)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < ARRAY_SIZE(test_ubsan_array); i++)\n\t\ttest_ubsan_array[i]();\n\n\treturn 0;\n}\nmodule_init(test_ubsan_init);\n\nstatic void __exit test_ubsan_exit(void)\n{\n\t \n}\nmodule_exit(test_ubsan_exit);\n\nMODULE_AUTHOR(\"Jinbum Park <jinb.park7@gmail.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}