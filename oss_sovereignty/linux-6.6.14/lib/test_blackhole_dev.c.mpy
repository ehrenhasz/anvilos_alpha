{
  "module_name": "test_blackhole_dev.c",
  "hash_id": "b2214b0bd16ea06453709f3158422d16b5bd4335a82979b7f6a5485dfa93eca4",
  "original_prompt": "Ingested from linux-6.6.14/lib/test_blackhole_dev.c",
  "human_readable_source": "\n \n\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/printk.h>\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <linux/udp.h>\n#include <linux/ipv6.h>\n\n#include <net/dst.h>\n\n#define SKB_SIZE  256\n#define HEAD_SIZE (14+40+8)\t \n#define TAIL_SIZE 32\t\t \n\n#define UDP_PORT 1234\n\nstatic int __init test_blackholedev_init(void)\n{\n\tstruct ipv6hdr *ip6h;\n\tstruct sk_buff *skb;\n\tstruct ethhdr *ethh;\n\tstruct udphdr *uh;\n\tint data_len;\n\tint ret;\n\n\tskb = alloc_skb(SKB_SIZE, GFP_KERNEL);\n\tif (!skb)\n\t\treturn -ENOMEM;\n\n\t \n\tskb_reserve(skb, HEAD_SIZE);\n\n\t \n\tdata_len = SKB_SIZE - (HEAD_SIZE + TAIL_SIZE);\n\tmemset(__skb_put(skb, data_len), 0xf, data_len);\n\n\t \n\t \n\tuh = (struct udphdr *)skb_push(skb, sizeof(struct udphdr));\n\tskb_set_transport_header(skb, 0);\n\tuh->source = uh->dest = htons(UDP_PORT);\n\tuh->len = htons(data_len);\n\tuh->check = 0;\n\t \n\tip6h = (struct ipv6hdr *)skb_push(skb, sizeof(struct ipv6hdr));\n\tskb_set_network_header(skb, 0);\n\tip6h->hop_limit = 32;\n\tip6h->payload_len = data_len + sizeof(struct udphdr);\n\tip6h->nexthdr = IPPROTO_UDP;\n\tip6h->saddr = in6addr_loopback;\n\tip6h->daddr = in6addr_loopback;\n\t \n\tethh = (struct ethhdr *)skb_push(skb, sizeof(struct ethhdr));\n\tskb_set_mac_header(skb, 0);\n\n\tskb->protocol = htons(ETH_P_IPV6);\n\tskb->pkt_type = PACKET_HOST;\n\tskb->dev = blackhole_netdev;\n\n\t \n\tret = dev_queue_xmit(skb);\n\n\tswitch (ret) {\n\tcase NET_XMIT_SUCCESS:\n\t\tpr_warn(\"dev_queue_xmit() returned NET_XMIT_SUCCESS\\n\");\n\t\tbreak;\n\tcase NET_XMIT_DROP:\n\t\tpr_warn(\"dev_queue_xmit() returned NET_XMIT_DROP\\n\");\n\t\tbreak;\n\tcase NET_XMIT_CN:\n\t\tpr_warn(\"dev_queue_xmit() returned NET_XMIT_CN\\n\");\n\t\tbreak;\n\tdefault:\n\t\tpr_err(\"dev_queue_xmit() returned UNKNOWN(%d)\\n\", ret);\n\t}\n\n\treturn 0;\n}\n\nstatic void __exit test_blackholedev_exit(void)\n{\n\tpr_warn(\"test_blackholedev module terminating.\\n\");\n}\n\nmodule_init(test_blackholedev_init);\nmodule_exit(test_blackholedev_exit);\n\nMODULE_AUTHOR(\"Mahesh Bandewar <maheshb@google.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}