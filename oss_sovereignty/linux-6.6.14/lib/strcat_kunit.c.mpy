{
  "module_name": "strcat_kunit.c",
  "hash_id": "cd4670fddfb1684bec58806abfbe8fcca2addedc625412d2a66e007ec7665da5",
  "original_prompt": "Ingested from linux-6.6.14/lib/strcat_kunit.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <kunit/test.h>\n#include <linux/string.h>\n\nstatic volatile int unconst;\n\nstatic void strcat_test(struct kunit *test)\n{\n\tchar dest[8];\n\n\t \n\tmemset(dest, 0, sizeof(dest));\n\tKUNIT_EXPECT_EQ(test, strlen(dest), 0);\n\t \n\tKUNIT_EXPECT_TRUE(test, strcat(dest, \"\") == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\t \n\tKUNIT_EXPECT_TRUE(test, strcat(dest, \"four\\000123\") == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"four\");\n\tKUNIT_EXPECT_EQ(test, dest[5], '\\0');\n\t \n\tKUNIT_EXPECT_TRUE(test, strcat(dest, \"AB\") == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourAB\");\n}\n\nstatic void strncat_test(struct kunit *test)\n{\n\tchar dest[8];\n\n\t \n\tmemset(dest, 0, sizeof(dest));\n\tKUNIT_EXPECT_EQ(test, strlen(dest), 0);\n\t \n\tKUNIT_EXPECT_TRUE(test, strncat(dest, \"\", 0 + unconst) == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\t \n\tKUNIT_EXPECT_TRUE(test, strncat(dest, \"\", 1 + unconst) == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\t \n\tKUNIT_EXPECT_TRUE(test, strncat(dest, \"asdf\", 0 + unconst) == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\n\t \n\tKUNIT_EXPECT_TRUE(test, strncat(dest, \"four\\000123\", 8 + unconst) == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"four\");\n\tKUNIT_EXPECT_EQ(test, dest[5], '\\0');\n\tKUNIT_EXPECT_EQ(test, dest[6], '\\0');\n\t \n\tKUNIT_EXPECT_TRUE(test, strncat(dest, \"ABCD\", 2 + unconst) == dest);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourAB\");\n}\n\nstatic void strlcat_test(struct kunit *test)\n{\n\tchar dest[8] = \"\";\n\tint len = sizeof(dest) + unconst;\n\n\t \n\tKUNIT_EXPECT_EQ(test, strlen(dest), 0);\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"\", len), 0);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"four\", 1 + unconst), 4);\n\tKUNIT_EXPECT_STREQ(test, dest, \"\");\n\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"four\", len), 4);\n\tKUNIT_EXPECT_STREQ(test, dest, \"four\");\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"AB\", len), 6);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourAB\");\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"CD\", 7 + unconst), 8);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourAB\");\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"EFG\", len), 9);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourABE\");\n\t \n\tKUNIT_EXPECT_EQ(test, strlcat(dest, \"1234\", len), 11);\n\tKUNIT_EXPECT_STREQ(test, dest, \"fourABE\");\n}\n\nstatic struct kunit_case strcat_test_cases[] = {\n\tKUNIT_CASE(strcat_test),\n\tKUNIT_CASE(strncat_test),\n\tKUNIT_CASE(strlcat_test),\n\t{}\n};\n\nstatic struct kunit_suite strcat_test_suite = {\n\t.name = \"strcat\",\n\t.test_cases = strcat_test_cases,\n};\n\nkunit_test_suite(strcat_test_suite);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}