{
  "module_name": "siphash_kunit.c",
  "hash_id": "0c198995d174d753139975d0a33774e9fc1650bb336a6601492c8bfdf31ebd06",
  "original_prompt": "Ingested from linux-6.6.14/lib/siphash_kunit.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <kunit/test.h>\n#include <linux/siphash.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\n \n\nstatic const siphash_key_t test_key_siphash =\n\t{{ 0x0706050403020100ULL, 0x0f0e0d0c0b0a0908ULL }};\n\nstatic const u64 test_vectors_siphash[64] = {\n\t0x726fdb47dd0e0e31ULL, 0x74f839c593dc67fdULL, 0x0d6c8009d9a94f5aULL,\n\t0x85676696d7fb7e2dULL, 0xcf2794e0277187b7ULL, 0x18765564cd99a68dULL,\n\t0xcbc9466e58fee3ceULL, 0xab0200f58b01d137ULL, 0x93f5f5799a932462ULL,\n\t0x9e0082df0ba9e4b0ULL, 0x7a5dbbc594ddb9f3ULL, 0xf4b32f46226bada7ULL,\n\t0x751e8fbc860ee5fbULL, 0x14ea5627c0843d90ULL, 0xf723ca908e7af2eeULL,\n\t0xa129ca6149be45e5ULL, 0x3f2acc7f57c29bdbULL, 0x699ae9f52cbe4794ULL,\n\t0x4bc1b3f0968dd39cULL, 0xbb6dc91da77961bdULL, 0xbed65cf21aa2ee98ULL,\n\t0xd0f2cbb02e3b67c7ULL, 0x93536795e3a33e88ULL, 0xa80c038ccd5ccec8ULL,\n\t0xb8ad50c6f649af94ULL, 0xbce192de8a85b8eaULL, 0x17d835b85bbb15f3ULL,\n\t0x2f2e6163076bcfadULL, 0xde4daaaca71dc9a5ULL, 0xa6a2506687956571ULL,\n\t0xad87a3535c49ef28ULL, 0x32d892fad841c342ULL, 0x7127512f72f27cceULL,\n\t0xa7f32346f95978e3ULL, 0x12e0b01abb051238ULL, 0x15e034d40fa197aeULL,\n\t0x314dffbe0815a3b4ULL, 0x027990f029623981ULL, 0xcadcd4e59ef40c4dULL,\n\t0x9abfd8766a33735cULL, 0x0e3ea96b5304a7d0ULL, 0xad0c42d6fc585992ULL,\n\t0x187306c89bc215a9ULL, 0xd4a60abcf3792b95ULL, 0xf935451de4f21df2ULL,\n\t0xa9538f0419755787ULL, 0xdb9acddff56ca510ULL, 0xd06c98cd5c0975ebULL,\n\t0xe612a3cb9ecba951ULL, 0xc766e62cfcadaf96ULL, 0xee64435a9752fe72ULL,\n\t0xa192d576b245165aULL, 0x0a8787bf8ecb74b2ULL, 0x81b3e73d20b49b6fULL,\n\t0x7fa8220ba3b2eceaULL, 0x245731c13ca42499ULL, 0xb78dbfaf3a8d83bdULL,\n\t0xea1ad565322a1a0bULL, 0x60e61c23a3795013ULL, 0x6606d7e446282b93ULL,\n\t0x6ca4ecb15c5f91e1ULL, 0x9f626da15c9625f3ULL, 0xe51b38608ef25f57ULL,\n\t0x958a324ceb064572ULL\n};\n\n#if BITS_PER_LONG == 64\nstatic const hsiphash_key_t test_key_hsiphash =\n\t{{ 0x0706050403020100ULL, 0x0f0e0d0c0b0a0908ULL }};\n\nstatic const u32 test_vectors_hsiphash[64] = {\n\t0x050fc4dcU, 0x7d57ca93U, 0x4dc7d44dU,\n\t0xe7ddf7fbU, 0x88d38328U, 0x49533b67U,\n\t0xc59f22a7U, 0x9bb11140U, 0x8d299a8eU,\n\t0x6c063de4U, 0x92ff097fU, 0xf94dc352U,\n\t0x57b4d9a2U, 0x1229ffa7U, 0xc0f95d34U,\n\t0x2a519956U, 0x7d908b66U, 0x63dbd80cU,\n\t0xb473e63eU, 0x8d297d1cU, 0xa6cce040U,\n\t0x2b45f844U, 0xa320872eU, 0xdae6c123U,\n\t0x67349c8cU, 0x705b0979U, 0xca9913a5U,\n\t0x4ade3b35U, 0xef6cd00dU, 0x4ab1e1f4U,\n\t0x43c5e663U, 0x8c21d1bcU, 0x16a7b60dU,\n\t0x7a8ff9bfU, 0x1f2a753eU, 0xbf186b91U,\n\t0xada26206U, 0xa3c33057U, 0xae3a36a1U,\n\t0x7b108392U, 0x99e41531U, 0x3f1ad944U,\n\t0xc8138825U, 0xc28949a6U, 0xfaf8876bU,\n\t0x9f042196U, 0x68b1d623U, 0x8b5114fdU,\n\t0xdf074c46U, 0x12cc86b3U, 0x0a52098fU,\n\t0x9d292f9aU, 0xa2f41f12U, 0x43a71ed0U,\n\t0x73f0bce6U, 0x70a7e980U, 0x243c6d75U,\n\t0xfdb71513U, 0xa67d8a08U, 0xb7e8f148U,\n\t0xf7a644eeU, 0x0f1837f2U, 0x4b6694e0U,\n\t0xb7bbb3a8U\n};\n#else\nstatic const hsiphash_key_t test_key_hsiphash =\n\t{{ 0x03020100U, 0x07060504U }};\n\nstatic const u32 test_vectors_hsiphash[64] = {\n\t0x5814c896U, 0xe7e864caU, 0xbc4b0e30U,\n\t0x01539939U, 0x7e059ea6U, 0x88e3d89bU,\n\t0xa0080b65U, 0x9d38d9d6U, 0x577999b1U,\n\t0xc839caedU, 0xe4fa32cfU, 0x959246eeU,\n\t0x6b28096cU, 0x66dd9cd6U, 0x16658a7cU,\n\t0xd0257b04U, 0x8b31d501U, 0x2b1cd04bU,\n\t0x06712339U, 0x522aca67U, 0x911bb605U,\n\t0x90a65f0eU, 0xf826ef7bU, 0x62512debU,\n\t0x57150ad7U, 0x5d473507U, 0x1ec47442U,\n\t0xab64afd3U, 0x0a4100d0U, 0x6d2ce652U,\n\t0x2331b6a3U, 0x08d8791aU, 0xbc6dda8dU,\n\t0xe0f6c934U, 0xb0652033U, 0x9b9851ccU,\n\t0x7c46fb7fU, 0x732ba8cbU, 0xf142997aU,\n\t0xfcc9aa1bU, 0x05327eb2U, 0xe110131cU,\n\t0xf9e5e7c0U, 0xa7d708a6U, 0x11795ab1U,\n\t0x65671619U, 0x9f5fff91U, 0xd89c5267U,\n\t0x007783ebU, 0x95766243U, 0xab639262U,\n\t0x9c7e1390U, 0xc368dda6U, 0x38ddc455U,\n\t0xfa13d379U, 0x979ea4e8U, 0x53ecd77eU,\n\t0x2ee80657U, 0x33dbb66aU, 0xae3f0577U,\n\t0x88b4c4ccU, 0x3e7f480bU, 0x74c1ebf8U,\n\t0x87178304U\n};\n#endif\n\n#define chk(hash, vector, fmt...)\t\t\t\\\n\tKUNIT_EXPECT_EQ_MSG(test, hash, vector, fmt)\n\nstatic void siphash_test(struct kunit *test)\n{\n\tu8 in[64] __aligned(SIPHASH_ALIGNMENT);\n\tu8 in_unaligned[65] __aligned(SIPHASH_ALIGNMENT);\n\tu8 i;\n\n\tfor (i = 0; i < 64; ++i) {\n\t\tin[i] = i;\n\t\tin_unaligned[i + 1] = i;\n\t\tchk(siphash(in, i, &test_key_siphash),\n\t\t    test_vectors_siphash[i],\n\t\t    \"siphash self-test aligned %u: FAIL\", i + 1);\n\t\tchk(siphash(in_unaligned + 1, i, &test_key_siphash),\n\t\t    test_vectors_siphash[i],\n\t\t    \"siphash self-test unaligned %u: FAIL\", i + 1);\n\t\tchk(hsiphash(in, i, &test_key_hsiphash),\n\t\t    test_vectors_hsiphash[i],\n\t\t    \"hsiphash self-test aligned %u: FAIL\", i + 1);\n\t\tchk(hsiphash(in_unaligned + 1, i, &test_key_hsiphash),\n\t\t    test_vectors_hsiphash[i],\n\t\t    \"hsiphash self-test unaligned %u: FAIL\", i + 1);\n\t}\n\tchk(siphash_1u64(0x0706050403020100ULL, &test_key_siphash),\n\t    test_vectors_siphash[8],\n\t    \"siphash self-test 1u64: FAIL\");\n\tchk(siphash_2u64(0x0706050403020100ULL, 0x0f0e0d0c0b0a0908ULL,\n\t\t\t &test_key_siphash),\n\t    test_vectors_siphash[16],\n\t    \"siphash self-test 2u64: FAIL\");\n\tchk(siphash_3u64(0x0706050403020100ULL, 0x0f0e0d0c0b0a0908ULL,\n\t\t\t 0x1716151413121110ULL, &test_key_siphash),\n\t    test_vectors_siphash[24],\n\t    \"siphash self-test 3u64: FAIL\");\n\tchk(siphash_4u64(0x0706050403020100ULL, 0x0f0e0d0c0b0a0908ULL,\n\t\t\t 0x1716151413121110ULL, 0x1f1e1d1c1b1a1918ULL,\n\t\t\t &test_key_siphash),\n\t    test_vectors_siphash[32],\n\t    \"siphash self-test 4u64: FAIL\");\n\tchk(siphash_1u32(0x03020100U, &test_key_siphash),\n\t    test_vectors_siphash[4],\n\t    \"siphash self-test 1u32: FAIL\");\n\tchk(siphash_2u32(0x03020100U, 0x07060504U, &test_key_siphash),\n\t    test_vectors_siphash[8],\n\t    \"siphash self-test 2u32: FAIL\");\n\tchk(siphash_3u32(0x03020100U, 0x07060504U,\n\t\t\t 0x0b0a0908U, &test_key_siphash),\n\t    test_vectors_siphash[12],\n\t    \"siphash self-test 3u32: FAIL\");\n\tchk(siphash_4u32(0x03020100U, 0x07060504U,\n\t\t\t 0x0b0a0908U, 0x0f0e0d0cU, &test_key_siphash),\n\t    test_vectors_siphash[16],\n\t    \"siphash self-test 4u32: FAIL\");\n\tchk(hsiphash_1u32(0x03020100U, &test_key_hsiphash),\n\t    test_vectors_hsiphash[4],\n\t    \"hsiphash self-test 1u32: FAIL\");\n\tchk(hsiphash_2u32(0x03020100U, 0x07060504U, &test_key_hsiphash),\n\t    test_vectors_hsiphash[8],\n\t    \"hsiphash self-test 2u32: FAIL\");\n\tchk(hsiphash_3u32(0x03020100U, 0x07060504U,\n\t\t\t  0x0b0a0908U, &test_key_hsiphash),\n\t    test_vectors_hsiphash[12],\n\t    \"hsiphash self-test 3u32: FAIL\");\n\tchk(hsiphash_4u32(0x03020100U, 0x07060504U,\n\t\t\t  0x0b0a0908U, 0x0f0e0d0cU, &test_key_hsiphash),\n\t    test_vectors_hsiphash[16],\n\t    \"hsiphash self-test 4u32: FAIL\");\n}\n\nstatic struct kunit_case siphash_test_cases[] = {\n\tKUNIT_CASE(siphash_test),\n\t{}\n};\n\nstatic struct kunit_suite siphash_test_suite = {\n\t.name = \"siphash\",\n\t.test_cases = siphash_test_cases,\n};\n\nkunit_test_suite(siphash_test_suite);\n\nMODULE_AUTHOR(\"Jason A. Donenfeld <Jason@zx2c4.com>\");\nMODULE_LICENSE(\"Dual BSD/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}