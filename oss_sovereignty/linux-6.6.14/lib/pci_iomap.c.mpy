{
  "module_name": "pci_iomap.c",
  "hash_id": "d93ee55e472e75569a015deeda951f6b9be6f1c5248a45c207595e635552ce86",
  "original_prompt": "Ingested from linux-6.6.14/lib/pci_iomap.c",
  "human_readable_source": "\n \n#include <linux/pci.h>\n#include <linux/io.h>\n\n#include <linux/export.h>\n\n#ifdef CONFIG_PCI\n \nvoid __iomem *pci_iomap_range(struct pci_dev *dev,\n\t\t\t      int bar,\n\t\t\t      unsigned long offset,\n\t\t\t      unsigned long maxlen)\n{\n\tresource_size_t start = pci_resource_start(dev, bar);\n\tresource_size_t len = pci_resource_len(dev, bar);\n\tunsigned long flags = pci_resource_flags(dev, bar);\n\n\tif (len <= offset || !start)\n\t\treturn NULL;\n\tlen -= offset;\n\tstart += offset;\n\tif (maxlen && len > maxlen)\n\t\tlen = maxlen;\n\tif (flags & IORESOURCE_IO)\n\t\treturn __pci_ioport_map(dev, start, len);\n\tif (flags & IORESOURCE_MEM)\n\t\treturn ioremap(start, len);\n\t \n\treturn NULL;\n}\nEXPORT_SYMBOL(pci_iomap_range);\n\n \nvoid __iomem *pci_iomap_wc_range(struct pci_dev *dev,\n\t\t\t\t int bar,\n\t\t\t\t unsigned long offset,\n\t\t\t\t unsigned long maxlen)\n{\n\tresource_size_t start = pci_resource_start(dev, bar);\n\tresource_size_t len = pci_resource_len(dev, bar);\n\tunsigned long flags = pci_resource_flags(dev, bar);\n\n\n\tif (flags & IORESOURCE_IO)\n\t\treturn NULL;\n\n\tif (len <= offset || !start)\n\t\treturn NULL;\n\n\tlen -= offset;\n\tstart += offset;\n\tif (maxlen && len > maxlen)\n\t\tlen = maxlen;\n\n\tif (flags & IORESOURCE_MEM)\n\t\treturn ioremap_wc(start, len);\n\n\t \n\treturn NULL;\n}\nEXPORT_SYMBOL_GPL(pci_iomap_wc_range);\n\n \nvoid __iomem *pci_iomap(struct pci_dev *dev, int bar, unsigned long maxlen)\n{\n\treturn pci_iomap_range(dev, bar, 0, maxlen);\n}\nEXPORT_SYMBOL(pci_iomap);\n\n \nvoid __iomem *pci_iomap_wc(struct pci_dev *dev, int bar, unsigned long maxlen)\n{\n\treturn pci_iomap_wc_range(dev, bar, 0, maxlen);\n}\nEXPORT_SYMBOL_GPL(pci_iomap_wc);\n\n \n#if defined(ARCH_WANTS_GENERIC_PCI_IOUNMAP)\n\nvoid pci_iounmap(struct pci_dev *dev, void __iomem *p)\n{\n#ifdef ARCH_HAS_GENERIC_IOPORT_MAP\n\tuintptr_t start = (uintptr_t) PCI_IOBASE;\n\tuintptr_t addr = (uintptr_t) p;\n\n\tif (addr >= start && addr < start + IO_SPACE_LIMIT)\n\t\treturn;\n\tiounmap(p);\n#endif\n}\nEXPORT_SYMBOL(pci_iounmap);\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}