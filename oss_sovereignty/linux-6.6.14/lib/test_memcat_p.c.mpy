{
  "module_name": "test_memcat_p.c",
  "hash_id": "d8c6ce10d211beb7a09ee0674bd7448dd09c1e8d290229695bd2ba30eb99cb6a",
  "original_prompt": "Ingested from linux-6.6.14/lib/test_memcat_p.c",
  "human_readable_source": "\n \n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\nstruct test_struct {\n\tint\t\tnum;\n\tunsigned int\tmagic;\n};\n\n#define MAGIC\t\t0xf00ff00f\n \n#define INPUT_MAX\t128\n \n#define EXPECT\t\t(INPUT_MAX * 2 - 2)\n\nstatic int __init test_memcat_p_init(void)\n{\n\tstruct test_struct **in0, **in1, **out, **p;\n\tint err = -ENOMEM, i, r, total = 0;\n\n\tin0 = kcalloc(INPUT_MAX, sizeof(*in0), GFP_KERNEL);\n\tif (!in0)\n\t\treturn err;\n\n\tin1 = kcalloc(INPUT_MAX, sizeof(*in1), GFP_KERNEL);\n\tif (!in1)\n\t\tgoto err_free_in0;\n\n\tfor (i = 0, r = 1; i < INPUT_MAX - 1; i++) {\n\t\tin0[i] = kmalloc(sizeof(**in0), GFP_KERNEL);\n\t\tif (!in0[i])\n\t\t\tgoto err_free_elements;\n\n\t\tin1[i] = kmalloc(sizeof(**in1), GFP_KERNEL);\n\t\tif (!in1[i]) {\n\t\t\tkfree(in0[i]);\n\t\t\tgoto err_free_elements;\n\t\t}\n\n\t\t \n\t\tr = (r * 725861) % 6599;\n\t\tin0[i]->num = r;\n\t\tin1[i]->num = -r;\n\t\tin0[i]->magic = MAGIC;\n\t\tin1[i]->magic = MAGIC;\n\t}\n\n\tin0[i] = in1[i] = NULL;\n\n\tout = memcat_p(in0, in1);\n\tif (!out)\n\t\tgoto err_free_all_elements;\n\n\terr = -EINVAL;\n\tfor (i = 0, p = out; *p && (i < INPUT_MAX * 2 - 1); p++, i++) {\n\t\ttotal += (*p)->num;\n\n\t\tif ((*p)->magic != MAGIC) {\n\t\t\tpr_err(\"test failed: wrong magic at %d: %u\\n\", i,\n\t\t\t       (*p)->magic);\n\t\t\tgoto err_free_out;\n\t\t}\n\t}\n\n\tif (total) {\n\t\tpr_err(\"test failed: expected zero total, got %d\\n\", total);\n\t\tgoto err_free_out;\n\t}\n\n\tif (i != EXPECT) {\n\t\tpr_err(\"test failed: expected output size %d, got %d\\n\",\n\t\t       EXPECT, i);\n\t\tgoto err_free_out;\n\t}\n\n\tfor (i = 0; i < INPUT_MAX - 1; i++)\n\t\tif (out[i] != in0[i] || out[i + INPUT_MAX - 1] != in1[i]) {\n\t\t\tpr_err(\"test failed: wrong element order at %d\\n\", i);\n\t\t\tgoto err_free_out;\n\t\t}\n\n\terr = 0;\n\tpr_info(\"test passed\\n\");\n\nerr_free_out:\n\tkfree(out);\nerr_free_all_elements:\n\ti = INPUT_MAX;\nerr_free_elements:\n\tfor (i--; i >= 0; i--) {\n\t\tkfree(in1[i]);\n\t\tkfree(in0[i]);\n\t}\n\n\tkfree(in1);\nerr_free_in0:\n\tkfree(in0);\n\n\treturn err;\n}\n\nstatic void __exit test_memcat_p_exit(void)\n{\n}\n\nmodule_init(test_memcat_p_init);\nmodule_exit(test_memcat_p_exit);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}