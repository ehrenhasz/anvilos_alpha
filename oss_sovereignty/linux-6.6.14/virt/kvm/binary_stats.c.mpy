{
  "module_name": "binary_stats.c",
  "hash_id": "aaa7e6fed25662102517017b989f83bf243e4df630ba57485f20d50437ed73ab",
  "original_prompt": "Ingested from linux-6.6.14/virt/kvm/binary_stats.c",
  "human_readable_source": "\n \n\n#include <linux/kvm_host.h>\n#include <linux/kvm.h>\n#include <linux/errno.h>\n#include <linux/uaccess.h>\n\n \nssize_t kvm_stats_read(char *id, const struct kvm_stats_header *header,\n\t\t       const struct _kvm_stats_desc *desc,\n\t\t       void *stats, size_t size_stats,\n\t\t       char __user *user_buffer, size_t size, loff_t *offset)\n{\n\tssize_t len;\n\tssize_t copylen;\n\tssize_t remain = size;\n\tsize_t size_desc;\n\tsize_t size_header;\n\tvoid *src;\n\tloff_t pos = *offset;\n\tchar __user *dest = user_buffer;\n\n\tsize_header = sizeof(*header);\n\tsize_desc = header->num_desc * sizeof(*desc);\n\n\tlen = KVM_STATS_NAME_SIZE + size_header + size_desc + size_stats - pos;\n\tlen = min(len, remain);\n\tif (len <= 0)\n\t\treturn 0;\n\tremain = len;\n\n\t \n\tcopylen = size_header - pos;\n\tcopylen = min(copylen, remain);\n\tif (copylen > 0) {\n\t\tsrc = (void *)header + pos;\n\t\tif (copy_to_user(dest, src, copylen))\n\t\t\treturn -EFAULT;\n\t\tremain -= copylen;\n\t\tpos += copylen;\n\t\tdest += copylen;\n\t}\n\n\t \n\tcopylen = header->id_offset + KVM_STATS_NAME_SIZE - pos;\n\tcopylen = min(copylen, remain);\n\tif (copylen > 0) {\n\t\tsrc = id + pos - header->id_offset;\n\t\tif (copy_to_user(dest, src, copylen))\n\t\t\treturn -EFAULT;\n\t\tremain -= copylen;\n\t\tpos += copylen;\n\t\tdest += copylen;\n\t}\n\n\t \n\tcopylen = header->desc_offset + size_desc - pos;\n\tcopylen = min(copylen, remain);\n\tif (copylen > 0) {\n\t\tsrc = (void *)desc + pos - header->desc_offset;\n\t\tif (copy_to_user(dest, src, copylen))\n\t\t\treturn -EFAULT;\n\t\tremain -= copylen;\n\t\tpos += copylen;\n\t\tdest += copylen;\n\t}\n\n\t \n\tcopylen = header->data_offset + size_stats - pos;\n\tcopylen = min(copylen, remain);\n\tif (copylen > 0) {\n\t\tsrc = stats + pos - header->data_offset;\n\t\tif (copy_to_user(dest, src, copylen))\n\t\t\treturn -EFAULT;\n\t\tpos += copylen;\n\t}\n\n\t*offset = pos;\n\treturn len;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}