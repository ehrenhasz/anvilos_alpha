{
  "module_name": "twofish-x86_64-asm_64.S",
  "hash_id": "8ff96ad2ad18070207c64fb1efde67b62f8e2e0a1d46b127078779b9d16b013a",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/twofish-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n.file \"twofish-x86_64-asm.S\"\n.text\n\n#include <linux/linkage.h>\n#include <asm/asm-offsets.h>\n\n#define a_offset\t0\n#define b_offset\t4\n#define c_offset\t8\n#define d_offset\t12\n\n \n\n#define s0\t0\t \n#define s1\t1024\t \n#define s2\t2048\t \n#define s3\t3072\t \n#define w\t4096\t \n#define k\t4128\t \n\n \n\n#define R0     %rax\n#define R0D    %eax\n#define R0B    %al\n#define R0H    %ah\n\n#define R1     %rbx\n#define R1D    %ebx\n#define R1B    %bl\n#define R1H    %bh\n\n#define R2     %rcx\n#define R2D    %ecx\n#define R2B    %cl\n#define R2H    %ch\n\n#define R3     %rdx\n#define R3D    %edx\n#define R3B    %dl\n#define R3H    %dh\n\n\n \n#define input_whitening(src,context,offset)\\\n\txor\tw+offset(context),\tsrc;\n\n \n#define output_whitening(src,context,offset)\\\n\txor\tw+16+offset(context),\tsrc;\n\n\n \n#define encrypt_round(a,b,c,d,round)\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts1(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\ts2(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\ts2(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts3(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts3(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\t(%r11,%rdi,4),\t%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$15,\t\tb ## D;\\\n\txor\t(%r11,%rdi,4),\t%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\txor\ts1(%r11,%rdi,4),%r9d;\\\n\tadd\t%r8d,\t\t%r9d;\\\n\tadd\t%r9d,\t\t%r8d;\\\n\tadd\tk+round(%r11),\t%r9d;\\\n\txor\t%r9d,\t\tc ## D;\\\n\trol\t$15,\t\tc ## D;\\\n\tadd\tk+4+round(%r11),%r8d;\\\n\txor\t%r8d,\t\td ## D;\n\n \n#define encrypt_last_round(a,b,c,d,round)\\\n\tmov\tb ## D,\t\t%r10d;\\\n\tshl\t$32,\t\t%r10;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts1(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\ts2(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\ts2(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts3(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts3(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\t(%r11,%rdi,4),\t%r9d;\\\n\txor\ta,\t\t%r10;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\txor\t(%r11,%rdi,4),\t%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\txor\ts1(%r11,%rdi,4),%r9d;\\\n\tadd\t%r8d,\t\t%r9d;\\\n\tadd\t%r9d,\t\t%r8d;\\\n\tadd\tk+round(%r11),\t%r9d;\\\n\txor\t%r9d,\t\tc ## D;\\\n\tror\t$1,\t\tc ## D;\\\n\tadd\tk+4+round(%r11),%r8d;\\\n\txor\t%r8d,\t\td ## D\n\n \n#define decrypt_round(a,b,c,d,round)\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\t(%r11,%rdi,4),\t%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts3(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts1(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\t(%r11,%rdi,4),\t%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\ts2(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts1(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$15,\t\ta ## D;\\\n\txor\ts3(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\txor\ts2(%r11,%rdi,4),%r8d;\\\n\tadd\t%r8d,\t\t%r9d;\\\n\tadd\t%r9d,\t\t%r8d;\\\n\tadd\tk+round(%r11),\t%r9d;\\\n\txor\t%r9d,\t\tc ## D;\\\n\tadd\tk+4+round(%r11),%r8d;\\\n\txor\t%r8d,\t\td ## D;\\\n\trol\t$15,\t\td ## D;\n\n \n#define decrypt_last_round(a,b,c,d,round)\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\t(%r11,%rdi,4),\t%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts3(%r11,%rdi,4),%r8d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\t(%r11,%rdi,4),\t%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tmov\tb ## D,\t\t%r10d;\\\n\tshl\t$32,\t\t%r10;\\\n\txor\ta,\t\t%r10;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts1(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts1(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\ts2(%r11,%rdi,4),%r9d;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\txor\ts2(%r11,%rdi,4),%r8d;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\txor\ts3(%r11,%rdi,4),%r9d;\\\n\tadd\t%r8d,\t\t%r9d;\\\n\tadd\t%r9d,\t\t%r8d;\\\n\tadd\tk+round(%r11),\t%r9d;\\\n\txor\t%r9d,\t\tc ## D;\\\n\tadd\tk+4+round(%r11),%r8d;\\\n\txor\t%r8d,\t\td ## D;\\\n\tror\t$1,\t\td ## D;\n\nSYM_FUNC_START(twofish_enc_blk)\n\tpushq    R1\n\n\t \n\t \n\t \n\t \n\tmov\t%rdi,\t\t%r11\n\n\tmovq\t(R3),\tR1\n\tmovq\t8(R3),\tR3\n\tinput_whitening(R1,%r11,a_offset)\n\tinput_whitening(R3,%r11,c_offset)\n\tmov\tR1D,\tR0D\n\trol\t$16,\tR0D\n\tshr\t$32,\tR1\n\tmov\tR3D,\tR2D\n\tshr\t$32,\tR3\n\trol\t$1,\tR3D\n\n\tencrypt_round(R0,R1,R2,R3,0);\n\tencrypt_round(R2,R3,R0,R1,8);\n\tencrypt_round(R0,R1,R2,R3,2*8);\n\tencrypt_round(R2,R3,R0,R1,3*8);\n\tencrypt_round(R0,R1,R2,R3,4*8);\n\tencrypt_round(R2,R3,R0,R1,5*8);\n\tencrypt_round(R0,R1,R2,R3,6*8);\n\tencrypt_round(R2,R3,R0,R1,7*8);\n\tencrypt_round(R0,R1,R2,R3,8*8);\n\tencrypt_round(R2,R3,R0,R1,9*8);\n\tencrypt_round(R0,R1,R2,R3,10*8);\n\tencrypt_round(R2,R3,R0,R1,11*8);\n\tencrypt_round(R0,R1,R2,R3,12*8);\n\tencrypt_round(R2,R3,R0,R1,13*8);\n\tencrypt_round(R0,R1,R2,R3,14*8);\n\tencrypt_last_round(R2,R3,R0,R1,15*8);\n\n\n\toutput_whitening(%r10,%r11,a_offset)\n\tmovq\t%r10,\t(%rsi)\n\n\tshl\t$32,\tR1\n\txor\tR0,\tR1\n\n\toutput_whitening(R1,%r11,c_offset)\n\tmovq\tR1,\t8(%rsi)\n\n\tpopq\tR1\n\tmovl\t$1,%eax\n\tRET\nSYM_FUNC_END(twofish_enc_blk)\n\nSYM_FUNC_START(twofish_dec_blk)\n\tpushq    R1\n\n\t \n\t \n\t \n\t \n\tmov\t%rdi,\t\t%r11\n\n\tmovq\t(R3),\tR1\n\tmovq\t8(R3),\tR3\n\toutput_whitening(R1,%r11,a_offset)\n\toutput_whitening(R3,%r11,c_offset)\n\tmov\tR1D,\tR0D\n\tshr\t$32,\tR1\n\trol\t$16,\tR1D\n\tmov\tR3D,\tR2D\n\tshr\t$32,\tR3\n\trol\t$1,\tR2D\n\n\tdecrypt_round(R0,R1,R2,R3,15*8);\n\tdecrypt_round(R2,R3,R0,R1,14*8);\n\tdecrypt_round(R0,R1,R2,R3,13*8);\n\tdecrypt_round(R2,R3,R0,R1,12*8);\n\tdecrypt_round(R0,R1,R2,R3,11*8);\n\tdecrypt_round(R2,R3,R0,R1,10*8);\n\tdecrypt_round(R0,R1,R2,R3,9*8);\n\tdecrypt_round(R2,R3,R0,R1,8*8);\n\tdecrypt_round(R0,R1,R2,R3,7*8);\n\tdecrypt_round(R2,R3,R0,R1,6*8);\n\tdecrypt_round(R0,R1,R2,R3,5*8);\n\tdecrypt_round(R2,R3,R0,R1,4*8);\n\tdecrypt_round(R0,R1,R2,R3,3*8);\n\tdecrypt_round(R2,R3,R0,R1,2*8);\n\tdecrypt_round(R0,R1,R2,R3,1*8);\n\tdecrypt_last_round(R2,R3,R0,R1,0);\n\n\tinput_whitening(%r10,%r11,a_offset)\n\tmovq\t%r10,\t(%rsi)\n\n\tshl\t$32,\tR1\n\txor\tR0,\tR1\n\n\tinput_whitening(R1,%r11,c_offset)\n\tmovq\tR1,\t8(%rsi)\n\n\tpopq\tR1\n\tmovl\t$1,%eax\n\tRET\nSYM_FUNC_END(twofish_dec_blk)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}