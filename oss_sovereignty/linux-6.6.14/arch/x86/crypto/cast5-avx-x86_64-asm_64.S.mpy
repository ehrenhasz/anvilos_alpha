{
  "module_name": "cast5-avx-x86_64-asm_64.S",
  "hash_id": "2852dcf99e814810b28832535b6f8ec409f11e7da21aeffaac568d97da52cd01",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/cast5-avx-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/frame.h>\n\n.file \"cast5-avx-x86_64-asm_64.S\"\n\n.extern cast_s1\n.extern cast_s2\n.extern cast_s3\n.extern cast_s4\n\n \n#define km\t0\n#define kr\t(16*4)\n#define rr\t((16*4)+16)\n\n \n#define s1\tcast_s1\n#define s2\tcast_s2\n#define s3\tcast_s3\n#define s4\tcast_s4\n\n \n#define CTX %r15\n\n#define RL1 %xmm0\n#define RR1 %xmm1\n#define RL2 %xmm2\n#define RR2 %xmm3\n#define RL3 %xmm4\n#define RR3 %xmm5\n#define RL4 %xmm6\n#define RR4 %xmm7\n\n#define RX %xmm8\n\n#define RKM  %xmm9\n#define RKR  %xmm10\n#define RKRF %xmm11\n#define RKRR %xmm12\n\n#define R32  %xmm13\n#define R1ST %xmm14\n\n#define RTMP %xmm15\n\n#define RID1  %rdi\n#define RID1d %edi\n#define RID2  %rsi\n#define RID2d %esi\n\n#define RGI1   %rdx\n#define RGI1bl %dl\n#define RGI1bh %dh\n#define RGI2   %rcx\n#define RGI2bl %cl\n#define RGI2bh %ch\n\n#define RGI3   %rax\n#define RGI3bl %al\n#define RGI3bh %ah\n#define RGI4   %rbx\n#define RGI4bl %bl\n#define RGI4bh %bh\n\n#define RFS1  %r8\n#define RFS1d %r8d\n#define RFS2  %r9\n#define RFS2d %r9d\n#define RFS3  %r10\n#define RFS3d %r10d\n\n\n#define lookup_32bit(src, dst, op1, op2, op3, interleave_op, il_reg) \\\n\tmovzbl\t\tsrc ## bh,     RID1d;    \\\n\tleaq\t\ts1(%rip),      RID2;     \\\n\tmovl\t\t(RID2,RID1,4), dst ## d; \\\n\tmovzbl\t\tsrc ## bl,     RID2d;    \\\n\tleaq\t\ts2(%rip),      RID1;     \\\n\top1\t\t(RID1,RID2,4), dst ## d; \\\n\tshrq $16,\tsrc;                     \\\n\tmovzbl\t\tsrc ## bh,     RID1d;    \\\n\tleaq\t\ts3(%rip),      RID2;     \\\n\top2\t\t(RID2,RID1,4), dst ## d; \\\n\tmovzbl\t\tsrc ## bl,     RID2d;    \\\n\tinterleave_op(il_reg);\t\t\t \\\n\tleaq\t\ts4(%rip),      RID1;     \\\n\top3\t\t(RID1,RID2,4), dst ## d;\n\n#define dummy(d)  \n\n#define shr_next(reg) \\\n\tshrq $16,\treg;\n\n#define F_head(a, x, gi1, gi2, op0) \\\n\top0\ta,\tRKM,  x;                 \\\n\tvpslld\tRKRF,\tx,    RTMP;              \\\n\tvpsrld\tRKRR,\tx,    x;                 \\\n\tvpor\tRTMP,\tx,    x;                 \\\n\t\\\n\tvmovq\t\tx,    gi1;               \\\n\tvpextrq $1,\tx,    gi2;\n\n#define F_tail(a, x, gi1, gi2, op1, op2, op3) \\\n\tlookup_32bit(##gi1, RFS1, op1, op2, op3, shr_next, ##gi1); \\\n\tlookup_32bit(##gi2, RFS3, op1, op2, op3, shr_next, ##gi2); \\\n\t\\\n\tlookup_32bit(##gi1, RFS2, op1, op2, op3, dummy, none);     \\\n\tshlq $32,\tRFS2;                                      \\\n\torq\t\tRFS1, RFS2;                                \\\n\tlookup_32bit(##gi2, RFS1, op1, op2, op3, dummy, none);     \\\n\tshlq $32,\tRFS1;                                      \\\n\torq\t\tRFS1, RFS3;                                \\\n\t\\\n\tvmovq\t\tRFS2, x;                                   \\\n\tvpinsrq $1,\tRFS3, x, x;\n\n#define F_2(a1, b1, a2, b2, op0, op1, op2, op3) \\\n\tF_head(b1, RX, RGI1, RGI2, op0);              \\\n\tF_head(b2, RX, RGI3, RGI4, op0);              \\\n\t\\\n\tF_tail(b1, RX, RGI1, RGI2, op1, op2, op3);    \\\n\tF_tail(b2, RTMP, RGI3, RGI4, op1, op2, op3);  \\\n\t\\\n\tvpxor\t\ta1, RX,   a1;                 \\\n\tvpxor\t\ta2, RTMP, a2;\n\n#define F1_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpaddd, xorl, subl, addl)\n#define F2_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpxor, subl, addl, xorl)\n#define F3_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpsubd, addl, xorl, subl)\n\n#define subround(a1, b1, a2, b2, f) \\\n\tF ## f ## _2(a1, b1, a2, b2);\n\n#define round(l, r, n, f) \\\n\tvbroadcastss \t(km+(4*n))(CTX), RKM;        \\\n\tvpand\t\tR1ST,            RKR,  RKRF; \\\n\tvpsubq\t\tRKRF,            R32,  RKRR; \\\n\tvpsrldq $1,\tRKR,             RKR;        \\\n\tsubround(l ## 1, r ## 1, l ## 2, r ## 2, f); \\\n\tsubround(l ## 3, r ## 3, l ## 4, r ## 4, f);\n\n#define enc_preload_rkr() \\\n\tvbroadcastss\t.L16_mask(%rip),          RKR;      \\\n\t  \\\n\tvpxor\t\tkr(CTX),                  RKR, RKR;\n\n#define dec_preload_rkr() \\\n\tvbroadcastss\t.L16_mask(%rip),          RKR;      \\\n\t  \\\n\tvpxor\t\tkr(CTX),                  RKR, RKR; \\\n\tvpshufb\t\t.Lbswap128_mask(%rip),    RKR, RKR;\n\n#define transpose_2x4(x0, x1, t0, t1) \\\n\tvpunpckldq\t\tx1, x0, t0; \\\n\tvpunpckhdq\t\tx1, x0, t1; \\\n\t\\\n\tvpunpcklqdq\t\tt1, t0, x0; \\\n\tvpunpckhqdq\t\tt1, t0, x1;\n\n#define inpack_blocks(x0, x1, t0, t1, rmask) \\\n\tvpshufb rmask, \tx0,\tx0; \\\n\tvpshufb rmask, \tx1,\tx1; \\\n\t\\\n\ttranspose_2x4(x0, x1, t0, t1)\n\n#define outunpack_blocks(x0, x1, t0, t1, rmask) \\\n\ttranspose_2x4(x0, x1, t0, t1) \\\n\t\\\n\tvpshufb rmask,\tx0, x0;           \\\n\tvpshufb rmask,\tx1, x1;\n\n.section\t.rodata.cst16.bswap_mask, \"aM\", @progbits, 16\n.align 16\n.Lbswap_mask:\n\t.byte 3, 2, 1, 0, 7, 6, 5, 4, 11, 10, 9, 8, 15, 14, 13, 12\n.section\t.rodata.cst16.bswap128_mask, \"aM\", @progbits, 16\n.align 16\n.Lbswap128_mask:\n\t.byte 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0\n.section\t.rodata.cst16.bswap_iv_mask, \"aM\", @progbits, 16\n.align 16\n.Lbswap_iv_mask:\n\t.byte 7, 6, 5, 4, 3, 2, 1, 0, 7, 6, 5, 4, 3, 2, 1, 0\n\n.section\t.rodata.cst4.16_mask, \"aM\", @progbits, 4\n.align 4\n.L16_mask:\n\t.byte 16, 16, 16, 16\n.section\t.rodata.cst4.32_mask, \"aM\", @progbits, 4\n.align 4\n.L32_mask:\n\t.byte 32, 0, 0, 0\n.section\t.rodata.cst4.first_mask, \"aM\", @progbits, 4\n.align 4\n.Lfirst_mask:\n\t.byte 0x1f, 0, 0, 0\n\n.text\n\nSYM_FUNC_START_LOCAL(__cast5_enc_blk16)\n\t \n\n\tpushq %r15;\n\tpushq %rbx;\n\n\tmovq %rdi, CTX;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\tvmovd .Lfirst_mask(%rip), R1ST;\n\tvmovd .L32_mask(%rip), R32;\n\tenc_preload_rkr();\n\n\tinpack_blocks(RL1, RR1, RTMP, RX, RKM);\n\tinpack_blocks(RL2, RR2, RTMP, RX, RKM);\n\tinpack_blocks(RL3, RR3, RTMP, RX, RKM);\n\tinpack_blocks(RL4, RR4, RTMP, RX, RKM);\n\n\tround(RL, RR, 0, 1);\n\tround(RR, RL, 1, 2);\n\tround(RL, RR, 2, 3);\n\tround(RR, RL, 3, 1);\n\tround(RL, RR, 4, 2);\n\tround(RR, RL, 5, 3);\n\tround(RL, RR, 6, 1);\n\tround(RR, RL, 7, 2);\n\tround(RL, RR, 8, 3);\n\tround(RR, RL, 9, 1);\n\tround(RL, RR, 10, 2);\n\tround(RR, RL, 11, 3);\n\n\tmovzbl rr(CTX), %eax;\n\ttestl %eax, %eax;\n\tjnz .L__skip_enc;\n\n\tround(RL, RR, 12, 1);\n\tround(RR, RL, 13, 2);\n\tround(RL, RR, 14, 3);\n\tround(RR, RL, 15, 1);\n\n.L__skip_enc:\n\tpopq %rbx;\n\tpopq %r15;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\n\toutunpack_blocks(RR1, RL1, RTMP, RX, RKM);\n\toutunpack_blocks(RR2, RL2, RTMP, RX, RKM);\n\toutunpack_blocks(RR3, RL3, RTMP, RX, RKM);\n\toutunpack_blocks(RR4, RL4, RTMP, RX, RKM);\n\n\tRET;\nSYM_FUNC_END(__cast5_enc_blk16)\n\nSYM_FUNC_START_LOCAL(__cast5_dec_blk16)\n\t \n\n\tpushq %r15;\n\tpushq %rbx;\n\n\tmovq %rdi, CTX;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\tvmovd .Lfirst_mask(%rip), R1ST;\n\tvmovd .L32_mask(%rip), R32;\n\tdec_preload_rkr();\n\n\tinpack_blocks(RL1, RR1, RTMP, RX, RKM);\n\tinpack_blocks(RL2, RR2, RTMP, RX, RKM);\n\tinpack_blocks(RL3, RR3, RTMP, RX, RKM);\n\tinpack_blocks(RL4, RR4, RTMP, RX, RKM);\n\n\tmovzbl rr(CTX), %eax;\n\ttestl %eax, %eax;\n\tjnz .L__skip_dec;\n\n\tround(RL, RR, 15, 1);\n\tround(RR, RL, 14, 3);\n\tround(RL, RR, 13, 2);\n\tround(RR, RL, 12, 1);\n\n.L__dec_tail:\n\tround(RL, RR, 11, 3);\n\tround(RR, RL, 10, 2);\n\tround(RL, RR, 9, 1);\n\tround(RR, RL, 8, 3);\n\tround(RL, RR, 7, 2);\n\tround(RR, RL, 6, 1);\n\tround(RL, RR, 5, 3);\n\tround(RR, RL, 4, 2);\n\tround(RL, RR, 3, 1);\n\tround(RR, RL, 2, 3);\n\tround(RL, RR, 1, 2);\n\tround(RR, RL, 0, 1);\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\tpopq %rbx;\n\tpopq %r15;\n\n\toutunpack_blocks(RR1, RL1, RTMP, RX, RKM);\n\toutunpack_blocks(RR2, RL2, RTMP, RX, RKM);\n\toutunpack_blocks(RR3, RL3, RTMP, RX, RKM);\n\toutunpack_blocks(RR4, RL4, RTMP, RX, RKM);\n\n\tRET;\n\n.L__skip_dec:\n\tvpsrldq $4, RKR, RKR;\n\tjmp .L__dec_tail;\nSYM_FUNC_END(__cast5_dec_blk16)\n\nSYM_FUNC_START(cast5_ecb_enc_16way)\n\t \n\tFRAME_BEGIN\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\n\tvmovdqu (0*4*4)(%rdx), RL1;\n\tvmovdqu (1*4*4)(%rdx), RR1;\n\tvmovdqu (2*4*4)(%rdx), RL2;\n\tvmovdqu (3*4*4)(%rdx), RR2;\n\tvmovdqu (4*4*4)(%rdx), RL3;\n\tvmovdqu (5*4*4)(%rdx), RR3;\n\tvmovdqu (6*4*4)(%rdx), RL4;\n\tvmovdqu (7*4*4)(%rdx), RR4;\n\n\tcall __cast5_enc_blk16;\n\n\tvmovdqu RR1, (0*4*4)(%r11);\n\tvmovdqu RL1, (1*4*4)(%r11);\n\tvmovdqu RR2, (2*4*4)(%r11);\n\tvmovdqu RL2, (3*4*4)(%r11);\n\tvmovdqu RR3, (4*4*4)(%r11);\n\tvmovdqu RL3, (5*4*4)(%r11);\n\tvmovdqu RR4, (6*4*4)(%r11);\n\tvmovdqu RL4, (7*4*4)(%r11);\n\n\tpopq %r15;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast5_ecb_enc_16way)\n\nSYM_FUNC_START(cast5_ecb_dec_16way)\n\t \n\n\tFRAME_BEGIN\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\n\tvmovdqu (0*4*4)(%rdx), RL1;\n\tvmovdqu (1*4*4)(%rdx), RR1;\n\tvmovdqu (2*4*4)(%rdx), RL2;\n\tvmovdqu (3*4*4)(%rdx), RR2;\n\tvmovdqu (4*4*4)(%rdx), RL3;\n\tvmovdqu (5*4*4)(%rdx), RR3;\n\tvmovdqu (6*4*4)(%rdx), RL4;\n\tvmovdqu (7*4*4)(%rdx), RR4;\n\n\tcall __cast5_dec_blk16;\n\n\tvmovdqu RR1, (0*4*4)(%r11);\n\tvmovdqu RL1, (1*4*4)(%r11);\n\tvmovdqu RR2, (2*4*4)(%r11);\n\tvmovdqu RL2, (3*4*4)(%r11);\n\tvmovdqu RR3, (4*4*4)(%r11);\n\tvmovdqu RL3, (5*4*4)(%r11);\n\tvmovdqu RR4, (6*4*4)(%r11);\n\tvmovdqu RL4, (7*4*4)(%r11);\n\n\tpopq %r15;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast5_ecb_dec_16way)\n\nSYM_FUNC_START(cast5_cbc_dec_16way)\n\t \n\tFRAME_BEGIN\n\tpushq %r12;\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\tmovq %rdx, %r12;\n\n\tvmovdqu (0*16)(%rdx), RL1;\n\tvmovdqu (1*16)(%rdx), RR1;\n\tvmovdqu (2*16)(%rdx), RL2;\n\tvmovdqu (3*16)(%rdx), RR2;\n\tvmovdqu (4*16)(%rdx), RL3;\n\tvmovdqu (5*16)(%rdx), RR3;\n\tvmovdqu (6*16)(%rdx), RL4;\n\tvmovdqu (7*16)(%rdx), RR4;\n\n\tcall __cast5_dec_blk16;\n\n\t \n\tvmovq (%r12), RX;\n\tvpshufd $0x4f, RX, RX;\n\tvpxor RX, RR1, RR1;\n\tvpxor 0*16+8(%r12), RL1, RL1;\n\tvpxor 1*16+8(%r12), RR2, RR2;\n\tvpxor 2*16+8(%r12), RL2, RL2;\n\tvpxor 3*16+8(%r12), RR3, RR3;\n\tvpxor 4*16+8(%r12), RL3, RL3;\n\tvpxor 5*16+8(%r12), RR4, RR4;\n\tvpxor 6*16+8(%r12), RL4, RL4;\n\n\tvmovdqu RR1, (0*16)(%r11);\n\tvmovdqu RL1, (1*16)(%r11);\n\tvmovdqu RR2, (2*16)(%r11);\n\tvmovdqu RL2, (3*16)(%r11);\n\tvmovdqu RR3, (4*16)(%r11);\n\tvmovdqu RL3, (5*16)(%r11);\n\tvmovdqu RR4, (6*16)(%r11);\n\tvmovdqu RL4, (7*16)(%r11);\n\n\tpopq %r15;\n\tpopq %r12;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast5_cbc_dec_16way)\n\nSYM_FUNC_START(cast5_ctr_16way)\n\t \n\tFRAME_BEGIN\n\tpushq %r12;\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\tmovq %rdx, %r12;\n\n\tvpcmpeqd RTMP, RTMP, RTMP;\n\tvpsrldq $8, RTMP, RTMP;  \n\n\tvpcmpeqd RKR, RKR, RKR;\n\tvpaddq RKR, RKR, RKR;  \n\tvmovdqa .Lbswap_iv_mask(%rip), R1ST;\n\tvmovdqa .Lbswap128_mask(%rip), RKM;\n\n\t \n\tvmovq (%rcx), RX;\n\tvpshufb R1ST, RX, RX;\n\n\t \n\tvpsubq RTMP, RX, RX;   \n\tvpshufb RKM, RX, RL1;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RR1;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RL2;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RR2;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RL3;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RR3;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RL4;  \n\tvpsubq RKR, RX, RX;\n\tvpshufb RKM, RX, RR4;  \n\n\t \n\tvpsubq RTMP, RX, RX;  \n\tvpshufb R1ST, RX, RX;  \n\tvmovq RX, (%rcx);\n\n\tcall __cast5_enc_blk16;\n\n\t \n\tvpxor (0*16)(%r12), RR1, RR1;\n\tvpxor (1*16)(%r12), RL1, RL1;\n\tvpxor (2*16)(%r12), RR2, RR2;\n\tvpxor (3*16)(%r12), RL2, RL2;\n\tvpxor (4*16)(%r12), RR3, RR3;\n\tvpxor (5*16)(%r12), RL3, RL3;\n\tvpxor (6*16)(%r12), RR4, RR4;\n\tvpxor (7*16)(%r12), RL4, RL4;\n\tvmovdqu RR1, (0*16)(%r11);\n\tvmovdqu RL1, (1*16)(%r11);\n\tvmovdqu RR2, (2*16)(%r11);\n\tvmovdqu RL2, (3*16)(%r11);\n\tvmovdqu RR3, (4*16)(%r11);\n\tvmovdqu RL3, (5*16)(%r11);\n\tvmovdqu RR4, (6*16)(%r11);\n\tvmovdqu RL4, (7*16)(%r11);\n\n\tpopq %r15;\n\tpopq %r12;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast5_ctr_16way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}