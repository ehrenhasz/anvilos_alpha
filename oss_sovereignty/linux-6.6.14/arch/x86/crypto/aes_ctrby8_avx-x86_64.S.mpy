{
  "module_name": "aes_ctrby8_avx-x86_64.S",
  "hash_id": "b1a4c384029053ae7a35ddcd083f3c34a33887e5b45952c348e990b3deaa51f1",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/aes_ctrby8_avx-x86_64.S",
  "human_readable_source": " \n \n \n\n#include <linux/linkage.h>\n\n#define VMOVDQ\t\tvmovdqu\n\n \n#define xdata0\t\t%xmm0\n#define xdata1\t\t%xmm1\n#define xdata2\t\t%xmm2\n#define xdata3\t\t%xmm3\n#define xdata4\t\t%xmm4\n#define xdata5\t\t%xmm5\n#define xdata6\t\t%xmm6\n#define xdata7\t\t%xmm7\n#define xcounter\t%xmm8\t \n#define xiv\t\t%xmm8\t \n#define xbyteswap\t%xmm9\t \n#define xtmp\t\t%xmm9\t \n#define xkey0\t\t%xmm10\n#define xkey4\t\t%xmm11\n#define xkey8\t\t%xmm12\n#define xkey12\t\t%xmm13\n#define xkeyA\t\t%xmm14\n#define xkeyB\t\t%xmm15\n\n#define p_in\t\t%rdi\n#define p_iv\t\t%rsi\n#define p_keys\t\t%rdx\n#define p_out\t\t%rcx\n#define num_bytes\t%r8\n#define counter\t\t%r9\t \n#define tmp\t\t%r10\n#define\tDDQ_DATA\t0\n#define\tXDATA\t\t1\n#define KEY_128\t\t1\n#define KEY_192\t\t2\n#define KEY_256\t\t3\n\n.section .rodata\n.align 16\n\nbyteswap_const:\n\t.octa 0x000102030405060708090A0B0C0D0E0F\nddq_low_msk:\n\t.octa 0x0000000000000000FFFFFFFFFFFFFFFF\nddq_high_add_1:\n\t.octa 0x00000000000000010000000000000000\nddq_add_1:\n\t.octa 0x00000000000000000000000000000001\nddq_add_2:\n\t.octa 0x00000000000000000000000000000002\nddq_add_3:\n\t.octa 0x00000000000000000000000000000003\nddq_add_4:\n\t.octa 0x00000000000000000000000000000004\nddq_add_5:\n\t.octa 0x00000000000000000000000000000005\nddq_add_6:\n\t.octa 0x00000000000000000000000000000006\nddq_add_7:\n\t.octa 0x00000000000000000000000000000007\nddq_add_8:\n\t.octa 0x00000000000000000000000000000008\n\n.text\n\n \n\n \n.macro setxdata n\n\tvar_xdata = %xmm\\n\n.endm\n\n \n\n.macro club name, id\n.altmacro\n\t.if \\name == XDATA\n\t\tsetxdata %\\id\n\t.endif\n.noaltmacro\n.endm\n\n \n.macro do_aes b, k, key_len, xctr\n\t.set by, \\b\n\t.set load_keys, \\k\n\t.set klen, \\key_len\n\n\t.if (load_keys)\n\t\tvmovdqa\t0*16(p_keys), xkey0\n\t.endif\n\n\t.if \\xctr\n\t\tmovq counter, xtmp\n\t\t.set i, 0\n\t\t.rept (by)\n\t\t\tclub XDATA, i\n\t\t\tvpaddq\t(ddq_add_1 + 16 * i)(%rip), xtmp, var_xdata\n\t\t\t.set i, (i +1)\n\t\t.endr\n\t\t.set i, 0\n\t\t.rept (by)\n\t\t\tclub\tXDATA, i\n\t\t\tvpxor\txiv, var_xdata, var_xdata\n\t\t\t.set i, (i +1)\n\t\t.endr\n\t.else\n\t\tvpshufb\txbyteswap, xcounter, xdata0\n\t\t.set i, 1\n\t\t.rept (by - 1)\n\t\t\tclub XDATA, i\n\t\t\tvpaddq\t(ddq_add_1 + 16 * (i - 1))(%rip), xcounter, var_xdata\n\t\t\tvptest\tddq_low_msk(%rip), var_xdata\n\t\t\tjnz 1f\n\t\t\tvpaddq\tddq_high_add_1(%rip), var_xdata, var_xdata\n\t\t\tvpaddq\tddq_high_add_1(%rip), xcounter, xcounter\n\t\t\t1:\n\t\t\tvpshufb\txbyteswap, var_xdata, var_xdata\n\t\t\t.set i, (i +1)\n\t\t.endr\n\t.endif\n\n\tvmovdqa\t1*16(p_keys), xkeyA\n\n\tvpxor\txkey0, xdata0, xdata0\n\t.if \\xctr\n\t\tadd $by, counter\n\t.else\n\t\tvpaddq\t(ddq_add_1 + 16 * (by - 1))(%rip), xcounter, xcounter\n\t\tvptest\tddq_low_msk(%rip), xcounter\n\t\tjnz\t1f\n\t\tvpaddq\tddq_high_add_1(%rip), xcounter, xcounter\n\t\t1:\n\t.endif\n\n\t.set i, 1\n\t.rept (by - 1)\n\t\tclub XDATA, i\n\t\tvpxor\txkey0, var_xdata, var_xdata\n\t\t.set i, (i +1)\n\t.endr\n\n\tvmovdqa\t2*16(p_keys), xkeyB\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\tvaesenc\txkeyA, var_xdata, var_xdata\t\t \n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen == KEY_128)\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t3*16(p_keys), xkey4\n\t\t.endif\n\t.else\n\t\tvmovdqa\t3*16(p_keys), xkeyA\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\tvaesenc\txkeyB, var_xdata, var_xdata\t\t \n\t\t.set i, (i +1)\n\t.endr\n\n\tadd\t$(16*by), p_in\n\n\t.if (klen == KEY_128)\n\t\tvmovdqa\t4*16(p_keys), xkeyB\n\t.else\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t4*16(p_keys), xkey4\n\t\t.endif\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenc\txkey4, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkeyA, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\tvmovdqa\t5*16(p_keys), xkeyA\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenc\txkeyB, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkey4, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen == KEY_128)\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t6*16(p_keys), xkey8\n\t\t.endif\n\t.else\n\t\tvmovdqa\t6*16(p_keys), xkeyB\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\tvaesenc\txkeyA, var_xdata, var_xdata\t\t \n\t\t.set i, (i +1)\n\t.endr\n\n\tvmovdqa\t7*16(p_keys), xkeyA\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenc\txkey8, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkeyB, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen == KEY_128)\n\t\tvmovdqa\t8*16(p_keys), xkeyB\n\t.else\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t8*16(p_keys), xkey8\n\t\t.endif\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\tvaesenc\txkeyA, var_xdata, var_xdata\t\t \n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen == KEY_128)\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t9*16(p_keys), xkey12\n\t\t.endif\n\t.else\n\t\tvmovdqa\t9*16(p_keys), xkeyA\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenc\txkeyB, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkey8, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\tvmovdqa\t10*16(p_keys), xkeyB\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenc\txkey12, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkeyA, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen != KEY_128)\n\t\tvmovdqa\t11*16(p_keys), xkeyA\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\t \n\t\t.if (klen == KEY_128)\n\t\t\tvaesenclast\txkeyB, var_xdata, var_xdata\n\t\t.else\n\t\t\tvaesenc\txkeyB, var_xdata, var_xdata\n\t\t.endif\n\t\t.set i, (i +1)\n\t.endr\n\n\t.if (klen != KEY_128)\n\t\t.if (load_keys)\n\t\t\tvmovdqa\t12*16(p_keys), xkey12\n\t\t.endif\n\n\t\t.set i, 0\n\t\t.rept by\n\t\t\tclub XDATA, i\n\t\t\tvaesenc\txkeyA, var_xdata, var_xdata\t \n\t\t\t.set i, (i +1)\n\t\t.endr\n\n\t\t.if (klen == KEY_256)\n\t\t\tvmovdqa\t13*16(p_keys), xkeyA\n\t\t.endif\n\n\t\t.set i, 0\n\t\t.rept by\n\t\t\tclub XDATA, i\n\t\t\t.if (klen == KEY_256)\n\t\t\t\t \n\t\t\t\tvaesenc\txkey12, var_xdata, var_xdata\n\t\t\t.else\n\t\t\t\tvaesenclast xkey12, var_xdata, var_xdata\n\t\t\t.endif\n\t\t\t.set i, (i +1)\n\t\t.endr\n\n\t\t.if (klen == KEY_256)\n\t\t\tvmovdqa\t14*16(p_keys), xkeyB\n\n\t\t\t.set i, 0\n\t\t\t.rept by\n\t\t\t\tclub XDATA, i\n\t\t\t\t \n\t\t\t\tvaesenc\txkeyA, var_xdata, var_xdata\n\t\t\t\t.set i, (i +1)\n\t\t\t.endr\n\n\t\t\t.set i, 0\n\t\t\t.rept by\n\t\t\t\tclub XDATA, i\n\t\t\t\t \n\t\t\t\tvaesenclast\txkeyB, var_xdata, var_xdata\n\t\t\t\t.set i, (i +1)\n\t\t\t.endr\n\t\t.endif\n\t.endif\n\n\t.set i, 0\n\t.rept (by / 2)\n\t\t.set j, (i+1)\n\t\tVMOVDQ\t(i*16 - 16*by)(p_in), xkeyA\n\t\tVMOVDQ\t(j*16 - 16*by)(p_in), xkeyB\n\t\tclub XDATA, i\n\t\tvpxor\txkeyA, var_xdata, var_xdata\n\t\tclub XDATA, j\n\t\tvpxor\txkeyB, var_xdata, var_xdata\n\t\t.set i, (i+2)\n\t.endr\n\n\t.if (i < by)\n\t\tVMOVDQ\t(i*16 - 16*by)(p_in), xkeyA\n\t\tclub XDATA, i\n\t\tvpxor\txkeyA, var_xdata, var_xdata\n\t.endif\n\n\t.set i, 0\n\t.rept by\n\t\tclub XDATA, i\n\t\tVMOVDQ\tvar_xdata, i*16(p_out)\n\t\t.set i, (i+1)\n\t.endr\n.endm\n\n.macro do_aes_load val, key_len, xctr\n\tdo_aes \\val, 1, \\key_len, \\xctr\n.endm\n\n.macro do_aes_noload val, key_len, xctr\n\tdo_aes \\val, 0, \\key_len, \\xctr\n.endm\n\n \n\n.macro do_aes_ctrmain key_len, xctr\n\tcmp\t$16, num_bytes\n\tjb\t.Ldo_return2\\xctr\\key_len\n\n\t.if \\xctr\n\t\tshr\t$4, counter\n\t\tvmovdqu\t(p_iv), xiv\n\t.else\n\t\tvmovdqa\tbyteswap_const(%rip), xbyteswap\n\t\tvmovdqu\t(p_iv), xcounter\n\t\tvpshufb\txbyteswap, xcounter, xcounter\n\t.endif\n\n\tmov\tnum_bytes, tmp\n\tand\t$(7*16), tmp\n\tjz\t.Lmult_of_8_blks\\xctr\\key_len\n\n\t \n\tcmp\t$(4*16), tmp\n\tjg\t.Lgt4\\xctr\\key_len\n\tje\t.Leq4\\xctr\\key_len\n\n.Llt4\\xctr\\key_len:\n\tcmp\t$(2*16), tmp\n\tjg\t.Leq3\\xctr\\key_len\n\tje\t.Leq2\\xctr\\key_len\n\n.Leq1\\xctr\\key_len:\n\tdo_aes_load\t1, \\key_len, \\xctr\n\tadd\t$(1*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Leq2\\xctr\\key_len:\n\tdo_aes_load\t2, \\key_len, \\xctr\n\tadd\t$(2*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n\n.Leq3\\xctr\\key_len:\n\tdo_aes_load\t3, \\key_len, \\xctr\n\tadd\t$(3*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Leq4\\xctr\\key_len:\n\tdo_aes_load\t4, \\key_len, \\xctr\n\tadd\t$(4*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Lgt4\\xctr\\key_len:\n\tcmp\t$(6*16), tmp\n\tjg\t.Leq7\\xctr\\key_len\n\tje\t.Leq6\\xctr\\key_len\n\n.Leq5\\xctr\\key_len:\n\tdo_aes_load\t5, \\key_len, \\xctr\n\tadd\t$(5*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Leq6\\xctr\\key_len:\n\tdo_aes_load\t6, \\key_len, \\xctr\n\tadd\t$(6*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Leq7\\xctr\\key_len:\n\tdo_aes_load\t7, \\key_len, \\xctr\n\tadd\t$(7*16), p_out\n\tand\t$(~7*16), num_bytes\n\tjz\t.Ldo_return2\\xctr\\key_len\n\tjmp\t.Lmain_loop2\\xctr\\key_len\n\n.Lmult_of_8_blks\\xctr\\key_len:\n\t.if (\\key_len != KEY_128)\n\t\tvmovdqa\t0*16(p_keys), xkey0\n\t\tvmovdqa\t4*16(p_keys), xkey4\n\t\tvmovdqa\t8*16(p_keys), xkey8\n\t\tvmovdqa\t12*16(p_keys), xkey12\n\t.else\n\t\tvmovdqa\t0*16(p_keys), xkey0\n\t\tvmovdqa\t3*16(p_keys), xkey4\n\t\tvmovdqa\t6*16(p_keys), xkey8\n\t\tvmovdqa\t9*16(p_keys), xkey12\n\t.endif\n.align 16\n.Lmain_loop2\\xctr\\key_len:\n\t \n\tdo_aes_noload\t8, \\key_len, \\xctr\n\tadd\t$(8*16), p_out\n\tsub\t$(8*16), num_bytes\n\tjne\t.Lmain_loop2\\xctr\\key_len\n\n.Ldo_return2\\xctr\\key_len:\n\t.if !\\xctr\n\t\t \n\t\tvpshufb\txbyteswap, xcounter, xcounter\n\t\tvmovdqu\txcounter, (p_iv)\n\t.endif\n\tRET\n.endm\n\n \nSYM_FUNC_START(aes_ctr_enc_128_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_128 0\n\nSYM_FUNC_END(aes_ctr_enc_128_avx_by8)\n\n \nSYM_FUNC_START(aes_ctr_enc_192_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_192 0\n\nSYM_FUNC_END(aes_ctr_enc_192_avx_by8)\n\n \nSYM_FUNC_START(aes_ctr_enc_256_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_256 0\n\nSYM_FUNC_END(aes_ctr_enc_256_avx_by8)\n\n \nSYM_FUNC_START(aes_xctr_enc_128_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_128 1\n\nSYM_FUNC_END(aes_xctr_enc_128_avx_by8)\n\n \nSYM_FUNC_START(aes_xctr_enc_192_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_192 1\n\nSYM_FUNC_END(aes_xctr_enc_192_avx_by8)\n\n \nSYM_FUNC_START(aes_xctr_enc_256_avx_by8)\n\t \n\tdo_aes_ctrmain KEY_256 1\n\nSYM_FUNC_END(aes_xctr_enc_256_avx_by8)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}