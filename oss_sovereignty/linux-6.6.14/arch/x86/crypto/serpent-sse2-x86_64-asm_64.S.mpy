{
  "module_name": "serpent-sse2-x86_64-asm_64.S",
  "hash_id": "696241abda66b5e56c08953d360653e5ac85557e5ca99d7445853aef4b8514c6",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/serpent-sse2-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n\n.file \"serpent-sse2-x86_64-asm_64.S\"\n.text\n\n#define CTX %rdi\n\n \n#define RA1 %xmm0\n#define RB1 %xmm1\n#define RC1 %xmm2\n#define RD1 %xmm3\n#define RE1 %xmm4\n\n#define RA2 %xmm5\n#define RB2 %xmm6\n#define RC2 %xmm7\n#define RD2 %xmm8\n#define RE2 %xmm9\n\n#define RNOT %xmm10\n\n#define RK0 %xmm11\n#define RK1 %xmm12\n#define RK2 %xmm13\n#define RK3 %xmm14\n\n#define S0_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x3,\t\tx4; \\\n\tpor x0,\t\t\tx3; \\\n\tpxor x4,\t\tx0; \\\n\tpxor x2,\t\tx4; \\\n\tpxor RNOT,\t\tx4; \\\n\tpxor x1,\t\tx3; \\\n\tpand x0,\t\tx1; \\\n\tpxor x4,\t\tx1; \\\n\tpxor x0,\t\tx2;\n#define S0_2(x0, x1, x2, x3, x4) \\\n\tpxor x3,\t\tx0; \\\n\tpor x0,\t\t\tx4; \\\n\tpxor x2,\t\tx0; \\\n\tpand x1,\t\tx2; \\\n\tpxor x2,\t\tx3; \\\n\tpxor RNOT,\t\tx1; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x2,\t\tx1;\n\n#define S1_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x1,\t\tx4; \\\n\tpxor x0,\t\tx1; \\\n\tpxor x3,\t\tx0; \\\n\tpxor RNOT,\t\tx3; \\\n\tpand x1,\t\tx4; \\\n\tpor x1,\t\t\tx0; \\\n\tpxor x2,\t\tx3; \\\n\tpxor x3,\t\tx0; \\\n\tpxor x3,\t\tx1;\n#define S1_2(x0, x1, x2, x3, x4) \\\n\tpxor x4,\t\tx3; \\\n\tpor x4,\t\t\tx1; \\\n\tpxor x2,\t\tx4; \\\n\tpand x0,\t\tx2; \\\n\tpxor x1,\t\tx2; \\\n\tpor x0,\t\t\tx1; \\\n\tpxor RNOT,\t\tx0; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x1,\t\tx4;\n\n#define S2_1(x0, x1, x2, x3, x4) \\\n\tpxor RNOT,\t\tx3; \\\n\tpxor x0,\t\tx1; \\\n\tmovdqa x0,\t\tx4; \\\n\tpand x2,\t\tx0; \\\n\tpxor x3,\t\tx0; \\\n\tpor x4,\t\t\tx3; \\\n\tpxor x1,\t\tx2; \\\n\tpxor x1,\t\tx3; \\\n\tpand x0,\t\tx1;\n#define S2_2(x0, x1, x2, x3, x4) \\\n\tpxor x2,\t\tx0; \\\n\tpand x3,\t\tx2; \\\n\tpor x1,\t\t\tx3; \\\n\tpxor RNOT,\t\tx0; \\\n\tpxor x0,\t\tx3; \\\n\tpxor x0,\t\tx4; \\\n\tpxor x2,\t\tx0; \\\n\tpor x2,\t\t\tx1;\n\n#define S3_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x1,\t\tx4; \\\n\tpxor x3,\t\tx1; \\\n\tpor x0,\t\t\tx3; \\\n\tpand x0,\t\tx4; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x1,\t\tx2; \\\n\tpand x3,\t\tx1; \\\n\tpxor x3,\t\tx2; \\\n\tpor x4,\t\t\tx0; \\\n\tpxor x3,\t\tx4;\n#define S3_2(x0, x1, x2, x3, x4) \\\n\tpxor x0,\t\tx1; \\\n\tpand x3,\t\tx0; \\\n\tpand x4,\t\tx3; \\\n\tpxor x2,\t\tx3; \\\n\tpor x1,\t\t\tx4; \\\n\tpand x1,\t\tx2; \\\n\tpxor x3,\t\tx4; \\\n\tpxor x3,\t\tx0; \\\n\tpxor x2,\t\tx3;\n\n#define S4_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x3,\t\tx4; \\\n\tpand x0,\t\tx3; \\\n\tpxor x4,\t\tx0; \\\n\tpxor x2,\t\tx3; \\\n\tpor x4,\t\t\tx2; \\\n\tpxor x1,\t\tx0; \\\n\tpxor x3,\t\tx4; \\\n\tpor x0,\t\t\tx2; \\\n\tpxor x1,\t\tx2;\n#define S4_2(x0, x1, x2, x3, x4) \\\n\tpand x0,\t\tx1; \\\n\tpxor x4,\t\tx1; \\\n\tpand x2,\t\tx4; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x0,\t\tx4; \\\n\tpor x1,\t\t\tx3; \\\n\tpxor RNOT,\t\tx1; \\\n\tpxor x0,\t\tx3;\n\n#define S5_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x1,\t\tx4; \\\n\tpor x0,\t\t\tx1; \\\n\tpxor x1,\t\tx2; \\\n\tpxor RNOT,\t\tx3; \\\n\tpxor x0,\t\tx4; \\\n\tpxor x2,\t\tx0; \\\n\tpand x4,\t\tx1; \\\n\tpor x3,\t\t\tx4; \\\n\tpxor x0,\t\tx4;\n#define S5_2(x0, x1, x2, x3, x4) \\\n\tpand x3,\t\tx0; \\\n\tpxor x3,\t\tx1; \\\n\tpxor x2,\t\tx3; \\\n\tpxor x1,\t\tx0; \\\n\tpand x4,\t\tx2; \\\n\tpxor x2,\t\tx1; \\\n\tpand x0,\t\tx2; \\\n\tpxor x2,\t\tx3;\n\n#define S6_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x1,\t\tx4; \\\n\tpxor x0,\t\tx3; \\\n\tpxor x2,\t\tx1; \\\n\tpxor x0,\t\tx2; \\\n\tpand x3,\t\tx0; \\\n\tpor x3,\t\t\tx1; \\\n\tpxor RNOT,\t\tx4; \\\n\tpxor x1,\t\tx0; \\\n\tpxor x2,\t\tx1;\n#define S6_2(x0, x1, x2, x3, x4) \\\n\tpxor x4,\t\tx3; \\\n\tpxor x0,\t\tx4; \\\n\tpand x0,\t\tx2; \\\n\tpxor x1,\t\tx4; \\\n\tpxor x3,\t\tx2; \\\n\tpand x1,\t\tx3; \\\n\tpxor x0,\t\tx3; \\\n\tpxor x2,\t\tx1;\n\n#define S7_1(x0, x1, x2, x3, x4) \\\n\tpxor RNOT,\t\tx1; \\\n\tmovdqa x1,\t\tx4; \\\n\tpxor RNOT,\t\tx0; \\\n\tpand x2,\t\tx1; \\\n\tpxor x3,\t\tx1; \\\n\tpor x4,\t\t\tx3; \\\n\tpxor x2,\t\tx4; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x0,\t\tx3; \\\n\tpor x1,\t\t\tx0;\n#define S7_2(x0, x1, x2, x3, x4) \\\n\tpand x0,\t\tx2; \\\n\tpxor x4,\t\tx0; \\\n\tpxor x3,\t\tx4; \\\n\tpand x0,\t\tx3; \\\n\tpxor x1,\t\tx4; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x1,\t\tx3; \\\n\tpor x0,\t\t\tx4; \\\n\tpxor x1,\t\tx4;\n\n#define SI0_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x3,\t\tx4; \\\n\tpxor x0,\t\tx1; \\\n\tpor x1,\t\t\tx3; \\\n\tpxor x1,\t\tx4; \\\n\tpxor RNOT,\t\tx0; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x0,\t\tx3; \\\n\tpand x1,\t\tx0; \\\n\tpxor x2,\t\tx0;\n#define SI0_2(x0, x1, x2, x3, x4) \\\n\tpand x3,\t\tx2; \\\n\tpxor x4,\t\tx3; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x3,\t\tx1; \\\n\tpand x0,\t\tx3; \\\n\tpxor x0,\t\tx1; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x3,\t\tx4;\n\n#define SI1_1(x0, x1, x2, x3, x4) \\\n\tpxor x3,\t\tx1; \\\n\tmovdqa x0,\t\tx4; \\\n\tpxor x2,\t\tx0; \\\n\tpxor RNOT,\t\tx2; \\\n\tpor x1,\t\t\tx4; \\\n\tpxor x3,\t\tx4; \\\n\tpand x1,\t\tx3; \\\n\tpxor x2,\t\tx1; \\\n\tpand x4,\t\tx2;\n#define SI1_2(x0, x1, x2, x3, x4) \\\n\tpxor x1,\t\tx4; \\\n\tpor x3,\t\t\tx1; \\\n\tpxor x0,\t\tx3; \\\n\tpxor x0,\t\tx2; \\\n\tpor x4,\t\t\tx0; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x0,\t\tx1; \\\n\tpxor x1,\t\tx4;\n\n#define SI2_1(x0, x1, x2, x3, x4) \\\n\tpxor x1,\t\tx2; \\\n\tmovdqa x3,\t\tx4; \\\n\tpxor RNOT,\t\tx3; \\\n\tpor x2,\t\t\tx3; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x0,\t\tx4; \\\n\tpxor x1,\t\tx3; \\\n\tpor x2,\t\t\tx1; \\\n\tpxor x0,\t\tx2;\n#define SI2_2(x0, x1, x2, x3, x4) \\\n\tpxor x4,\t\tx1; \\\n\tpor x3,\t\t\tx4; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x2,\t\tx4; \\\n\tpand x1,\t\tx2; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x4,\t\tx3; \\\n\tpxor x0,\t\tx4;\n\n#define SI3_1(x0, x1, x2, x3, x4) \\\n\tpxor x1,\t\tx2; \\\n\tmovdqa x1,\t\tx4; \\\n\tpand x2,\t\tx1; \\\n\tpxor x0,\t\tx1; \\\n\tpor x4,\t\t\tx0; \\\n\tpxor x3,\t\tx4; \\\n\tpxor x3,\t\tx0; \\\n\tpor x1,\t\t\tx3; \\\n\tpxor x2,\t\tx1;\n#define SI3_2(x0, x1, x2, x3, x4) \\\n\tpxor x3,\t\tx1; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x3,\t\tx2; \\\n\tpand x1,\t\tx3; \\\n\tpxor x0,\t\tx1; \\\n\tpand x2,\t\tx0; \\\n\tpxor x3,\t\tx4; \\\n\tpxor x0,\t\tx3; \\\n\tpxor x1,\t\tx0;\n\n#define SI4_1(x0, x1, x2, x3, x4) \\\n\tpxor x3,\t\tx2; \\\n\tmovdqa x0,\t\tx4; \\\n\tpand x1,\t\tx0; \\\n\tpxor x2,\t\tx0; \\\n\tpor x3,\t\t\tx2; \\\n\tpxor RNOT,\t\tx4; \\\n\tpxor x0,\t\tx1; \\\n\tpxor x2,\t\tx0; \\\n\tpand x4,\t\tx2;\n#define SI4_2(x0, x1, x2, x3, x4) \\\n\tpxor x0,\t\tx2; \\\n\tpor x4,\t\t\tx0; \\\n\tpxor x3,\t\tx0; \\\n\tpand x2,\t\tx3; \\\n\tpxor x3,\t\tx4; \\\n\tpxor x1,\t\tx3; \\\n\tpand x0,\t\tx1; \\\n\tpxor x1,\t\tx4; \\\n\tpxor x3,\t\tx0;\n\n#define SI5_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x1,\t\tx4; \\\n\tpor x2,\t\t\tx1; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x3,\t\tx1; \\\n\tpand x4,\t\tx3; \\\n\tpxor x3,\t\tx2; \\\n\tpor x0,\t\t\tx3; \\\n\tpxor RNOT,\t\tx0; \\\n\tpxor x2,\t\tx3; \\\n\tpor x0,\t\t\tx2;\n#define SI5_2(x0, x1, x2, x3, x4) \\\n\tpxor x1,\t\tx4; \\\n\tpxor x4,\t\tx2; \\\n\tpand x0,\t\tx4; \\\n\tpxor x1,\t\tx0; \\\n\tpxor x3,\t\tx1; \\\n\tpand x2,\t\tx0; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x4,\t\tx2; \\\n\tpxor x3,\t\tx4;\n\n#define SI6_1(x0, x1, x2, x3, x4) \\\n\tpxor x2,\t\tx0; \\\n\tmovdqa x0,\t\tx4; \\\n\tpand x3,\t\tx0; \\\n\tpxor x3,\t\tx2; \\\n\tpxor x2,\t\tx0; \\\n\tpxor x1,\t\tx3; \\\n\tpor x4,\t\t\tx2; \\\n\tpxor x3,\t\tx2; \\\n\tpand x0,\t\tx3;\n#define SI6_2(x0, x1, x2, x3, x4) \\\n\tpxor RNOT,\t\tx0; \\\n\tpxor x1,\t\tx3; \\\n\tpand x2,\t\tx1; \\\n\tpxor x0,\t\tx4; \\\n\tpxor x4,\t\tx3; \\\n\tpxor x2,\t\tx4; \\\n\tpxor x1,\t\tx0; \\\n\tpxor x0,\t\tx2;\n\n#define SI7_1(x0, x1, x2, x3, x4) \\\n\tmovdqa x3,\t\tx4; \\\n\tpand x0,\t\tx3; \\\n\tpxor x2,\t\tx0; \\\n\tpor x4,\t\t\tx2; \\\n\tpxor x1,\t\tx4; \\\n\tpxor RNOT,\t\tx0; \\\n\tpor x3,\t\t\tx1; \\\n\tpxor x0,\t\tx4; \\\n\tpand x2,\t\tx0; \\\n\tpxor x1,\t\tx0;\n#define SI7_2(x0, x1, x2, x3, x4) \\\n\tpand x2,\t\tx1; \\\n\tpxor x2,\t\tx3; \\\n\tpxor x3,\t\tx4; \\\n\tpand x3,\t\tx2; \\\n\tpor x0,\t\t\tx3; \\\n\tpxor x4,\t\tx1; \\\n\tpxor x4,\t\tx3; \\\n\tpand x0,\t\tx4; \\\n\tpxor x2,\t\tx4;\n\n#define get_key(i, j, t) \\\n\tmovd (4*(i)+(j))*4(CTX), t; \\\n\tpshufd $0, t, t;\n\n#define K2(x0, x1, x2, x3, x4, i) \\\n\tget_key(i, 0, RK0); \\\n\tget_key(i, 1, RK1); \\\n\tget_key(i, 2, RK2); \\\n\tget_key(i, 3, RK3); \\\n\tpxor RK0,\t\tx0 ## 1; \\\n\tpxor RK1,\t\tx1 ## 1; \\\n\tpxor RK2,\t\tx2 ## 1; \\\n\tpxor RK3,\t\tx3 ## 1; \\\n\t\tpxor RK0,\t\tx0 ## 2; \\\n\t\tpxor RK1,\t\tx1 ## 2; \\\n\t\tpxor RK2,\t\tx2 ## 2; \\\n\t\tpxor RK3,\t\tx3 ## 2;\n\n#define LK2(x0, x1, x2, x3, x4, i) \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\tpslld $13,\t\tx0 ## 1; \\\n\tpsrld $(32 - 13),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx0 ## 1; \\\n\tpxor x0 ## 1,\t\tx1 ## 1; \\\n\tmovdqa x2 ## 1,\t\tx4 ## 1; \\\n\tpslld $3,\t\tx2 ## 1; \\\n\tpsrld $(32 - 3),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx2 ## 1; \\\n\tpxor x2 ## 1,\t\tx1 ## 1; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $13,\t\tx0 ## 2; \\\n\t\tpsrld $(32 - 13),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx0 ## 2; \\\n\t\tpxor x0 ## 2,\t\tx1 ## 2; \\\n\t\tmovdqa x2 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $3,\t\tx2 ## 2; \\\n\t\tpsrld $(32 - 3),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx2 ## 2; \\\n\t\tpxor x2 ## 2,\t\tx1 ## 2; \\\n\tmovdqa x1 ## 1,\t\tx4 ## 1; \\\n\tpslld $1,\t\tx1 ## 1; \\\n\tpsrld $(32 - 1),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx1 ## 1; \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\tpslld $3,\t\tx4 ## 1; \\\n\tpxor x2 ## 1,\t\tx3 ## 1; \\\n\tpxor x4 ## 1,\t\tx3 ## 1; \\\n\tmovdqa x3 ## 1,\t\tx4 ## 1; \\\n\tget_key(i, 1, RK1); \\\n\t\tmovdqa x1 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $1,\t\tx1 ## 2; \\\n\t\tpsrld $(32 - 1),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx1 ## 2; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $3,\t\tx4 ## 2; \\\n\t\tpxor x2 ## 2,\t\tx3 ## 2; \\\n\t\tpxor x4 ## 2,\t\tx3 ## 2; \\\n\t\tmovdqa x3 ## 2,\t\tx4 ## 2; \\\n\t\tget_key(i, 3, RK3); \\\n\tpslld $7,\t\tx3 ## 1; \\\n\tpsrld $(32 - 7),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx3 ## 1; \\\n\tmovdqa x1 ## 1,\t\tx4 ## 1; \\\n\tpslld $7,\t\tx4 ## 1; \\\n\tpxor x1 ## 1,\t\tx0 ## 1; \\\n\tpxor x3 ## 1,\t\tx0 ## 1; \\\n\tpxor x3 ## 1,\t\tx2 ## 1; \\\n\tpxor x4 ## 1,\t\tx2 ## 1; \\\n\tget_key(i, 0, RK0); \\\n\t\tpslld $7,\t\tx3 ## 2; \\\n\t\tpsrld $(32 - 7),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx3 ## 2; \\\n\t\tmovdqa x1 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $7,\t\tx4 ## 2; \\\n\t\tpxor x1 ## 2,\t\tx0 ## 2; \\\n\t\tpxor x3 ## 2,\t\tx0 ## 2; \\\n\t\tpxor x3 ## 2,\t\tx2 ## 2; \\\n\t\tpxor x4 ## 2,\t\tx2 ## 2; \\\n\t\tget_key(i, 2, RK2); \\\n\tpxor RK1,\t\tx1 ## 1; \\\n\tpxor RK3,\t\tx3 ## 1; \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\tpslld $5,\t\tx0 ## 1; \\\n\tpsrld $(32 - 5),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx0 ## 1; \\\n\tmovdqa x2 ## 1,\t\tx4 ## 1; \\\n\tpslld $22,\t\tx2 ## 1; \\\n\tpsrld $(32 - 22),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx2 ## 1; \\\n\tpxor RK0,\t\tx0 ## 1; \\\n\tpxor RK2,\t\tx2 ## 1; \\\n\t\tpxor RK1,\t\tx1 ## 2; \\\n\t\tpxor RK3,\t\tx3 ## 2; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $5,\t\tx0 ## 2; \\\n\t\tpsrld $(32 - 5),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx0 ## 2; \\\n\t\tmovdqa x2 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $22,\t\tx2 ## 2; \\\n\t\tpsrld $(32 - 22),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx2 ## 2; \\\n\t\tpxor RK0,\t\tx0 ## 2; \\\n\t\tpxor RK2,\t\tx2 ## 2;\n\n#define KL2(x0, x1, x2, x3, x4, i) \\\n\tpxor RK0,\t\tx0 ## 1; \\\n\tpxor RK2,\t\tx2 ## 1; \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\tpsrld $5,\t\tx0 ## 1; \\\n\tpslld $(32 - 5),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx0 ## 1; \\\n\tpxor RK3,\t\tx3 ## 1; \\\n\tpxor RK1,\t\tx1 ## 1; \\\n\tmovdqa x2 ## 1,\t\tx4 ## 1; \\\n\tpsrld $22,\t\tx2 ## 1; \\\n\tpslld $(32 - 22),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx2 ## 1; \\\n\tpxor x3 ## 1,\t\tx2 ## 1; \\\n\t\tpxor RK0,\t\tx0 ## 2; \\\n\t\tpxor RK2,\t\tx2 ## 2; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\t\tpsrld $5,\t\tx0 ## 2; \\\n\t\tpslld $(32 - 5),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx0 ## 2; \\\n\t\tpxor RK3,\t\tx3 ## 2; \\\n\t\tpxor RK1,\t\tx1 ## 2; \\\n\t\tmovdqa x2 ## 2,\t\tx4 ## 2; \\\n\t\tpsrld $22,\t\tx2 ## 2; \\\n\t\tpslld $(32 - 22),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx2 ## 2; \\\n\t\tpxor x3 ## 2,\t\tx2 ## 2; \\\n\tpxor x3 ## 1,\t\tx0 ## 1; \\\n\tmovdqa x1 ## 1,\t\tx4 ## 1; \\\n\tpslld $7,\t\tx4 ## 1; \\\n\tpxor x1 ## 1,\t\tx0 ## 1; \\\n\tpxor x4 ## 1,\t\tx2 ## 1; \\\n\tmovdqa x1 ## 1,\t\tx4 ## 1; \\\n\tpsrld $1,\t\tx1 ## 1; \\\n\tpslld $(32 - 1),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx1 ## 1; \\\n\t\tpxor x3 ## 2,\t\tx0 ## 2; \\\n\t\tmovdqa x1 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $7,\t\tx4 ## 2; \\\n\t\tpxor x1 ## 2,\t\tx0 ## 2; \\\n\t\tpxor x4 ## 2,\t\tx2 ## 2; \\\n\t\tmovdqa x1 ## 2,\t\tx4 ## 2; \\\n\t\tpsrld $1,\t\tx1 ## 2; \\\n\t\tpslld $(32 - 1),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx1 ## 2; \\\n\tmovdqa x3 ## 1,\t\tx4 ## 1; \\\n\tpsrld $7,\t\tx3 ## 1; \\\n\tpslld $(32 - 7),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx3 ## 1; \\\n\tpxor x0 ## 1,\t\tx1 ## 1; \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\tpslld $3,\t\tx4 ## 1; \\\n\tpxor x4 ## 1,\t\tx3 ## 1; \\\n\tmovdqa x0 ## 1,\t\tx4 ## 1; \\\n\t\tmovdqa x3 ## 2,\t\tx4 ## 2; \\\n\t\tpsrld $7,\t\tx3 ## 2; \\\n\t\tpslld $(32 - 7),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx3 ## 2; \\\n\t\tpxor x0 ## 2,\t\tx1 ## 2; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\t\tpslld $3,\t\tx4 ## 2; \\\n\t\tpxor x4 ## 2,\t\tx3 ## 2; \\\n\t\tmovdqa x0 ## 2,\t\tx4 ## 2; \\\n\tpsrld $13,\t\tx0 ## 1; \\\n\tpslld $(32 - 13),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx0 ## 1; \\\n\tpxor x2 ## 1,\t\tx1 ## 1; \\\n\tpxor x2 ## 1,\t\tx3 ## 1; \\\n\tmovdqa x2 ## 1,\t\tx4 ## 1; \\\n\tpsrld $3,\t\tx2 ## 1; \\\n\tpslld $(32 - 3),\tx4 ## 1; \\\n\tpor x4 ## 1,\t\tx2 ## 1; \\\n\t\tpsrld $13,\t\tx0 ## 2; \\\n\t\tpslld $(32 - 13),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx0 ## 2; \\\n\t\tpxor x2 ## 2,\t\tx1 ## 2; \\\n\t\tpxor x2 ## 2,\t\tx3 ## 2; \\\n\t\tmovdqa x2 ## 2,\t\tx4 ## 2; \\\n\t\tpsrld $3,\t\tx2 ## 2; \\\n\t\tpslld $(32 - 3),\tx4 ## 2; \\\n\t\tpor x4 ## 2,\t\tx2 ## 2;\n\n#define S(SBOX, x0, x1, x2, x3, x4) \\\n\tSBOX ## _1(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tSBOX ## _2(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tSBOX ## _1(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\tSBOX ## _2(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2);\n\n#define SP(SBOX, x0, x1, x2, x3, x4, i) \\\n\tget_key(i, 0, RK0); \\\n\tSBOX ## _1(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tget_key(i, 2, RK2); \\\n\tSBOX ## _1(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\tget_key(i, 3, RK3); \\\n\tSBOX ## _2(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tget_key(i, 1, RK1); \\\n\tSBOX ## _2(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\n#define transpose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\tmovdqa x0,\t\tt2; \\\n\tpunpckldq x1,\t\tx0; \\\n\tpunpckhdq x1,\t\tt2; \\\n\tmovdqa x2,\t\tt1; \\\n\tpunpckhdq x3,\t\tx2; \\\n\tpunpckldq x3,\t\tt1; \\\n\tmovdqa x0,\t\tx1; \\\n\tpunpcklqdq t1,\t\tx0; \\\n\tpunpckhqdq t1,\t\tx1; \\\n\tmovdqa t2,\t\tx3; \\\n\tpunpcklqdq x2,\t\tt2; \\\n\tpunpckhqdq x2,\t\tx3; \\\n\tmovdqa t2,\t\tx2;\n\n#define read_blocks(in, x0, x1, x2, x3, t0, t1, t2) \\\n\tmovdqu (0*4*4)(in),\tx0; \\\n\tmovdqu (1*4*4)(in),\tx1; \\\n\tmovdqu (2*4*4)(in),\tx2; \\\n\tmovdqu (3*4*4)(in),\tx3; \\\n\t\\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2)\n\n#define write_blocks(out, x0, x1, x2, x3, t0, t1, t2) \\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\t\\\n\tmovdqu x0,\t\t(0*4*4)(out); \\\n\tmovdqu x1,\t\t(1*4*4)(out); \\\n\tmovdqu x2,\t\t(2*4*4)(out); \\\n\tmovdqu x3,\t\t(3*4*4)(out);\n\n#define xor_blocks(out, x0, x1, x2, x3, t0, t1, t2) \\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\t\\\n\tmovdqu (0*4*4)(out),\tt0; \\\n\tpxor t0,\t\tx0; \\\n\tmovdqu x0,\t\t(0*4*4)(out); \\\n\tmovdqu (1*4*4)(out),\tt0; \\\n\tpxor t0,\t\tx1; \\\n\tmovdqu x1,\t\t(1*4*4)(out); \\\n\tmovdqu (2*4*4)(out),\tt0; \\\n\tpxor t0,\t\tx2; \\\n\tmovdqu x2,\t\t(2*4*4)(out); \\\n\tmovdqu (3*4*4)(out),\tt0; \\\n\tpxor t0,\t\tx3; \\\n\tmovdqu x3,\t\t(3*4*4)(out);\n\nSYM_FUNC_START(__serpent_enc_blk_8way)\n\t \n\n\tpcmpeqd RNOT, RNOT;\n\n\tleaq (4*4*4)(%rdx), %rax;\n\tread_blocks(%rdx, RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\tread_blocks(%rax, RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\t\t\t\t\t\t K2(RA, RB, RC, RD, RE, 0);\n\tS(S0, RA, RB, RC, RD, RE);\t\tLK2(RC, RB, RD, RA, RE, 1);\n\tS(S1, RC, RB, RD, RA, RE);\t\tLK2(RE, RD, RA, RC, RB, 2);\n\tS(S2, RE, RD, RA, RC, RB);\t\tLK2(RB, RD, RE, RC, RA, 3);\n\tS(S3, RB, RD, RE, RC, RA);\t\tLK2(RC, RA, RD, RB, RE, 4);\n\tS(S4, RC, RA, RD, RB, RE);\t\tLK2(RA, RD, RB, RE, RC, 5);\n\tS(S5, RA, RD, RB, RE, RC);\t\tLK2(RC, RA, RD, RE, RB, 6);\n\tS(S6, RC, RA, RD, RE, RB);\t\tLK2(RD, RB, RA, RE, RC, 7);\n\tS(S7, RD, RB, RA, RE, RC);\t\tLK2(RC, RA, RE, RD, RB, 8);\n\tS(S0, RC, RA, RE, RD, RB);\t\tLK2(RE, RA, RD, RC, RB, 9);\n\tS(S1, RE, RA, RD, RC, RB);\t\tLK2(RB, RD, RC, RE, RA, 10);\n\tS(S2, RB, RD, RC, RE, RA);\t\tLK2(RA, RD, RB, RE, RC, 11);\n\tS(S3, RA, RD, RB, RE, RC);\t\tLK2(RE, RC, RD, RA, RB, 12);\n\tS(S4, RE, RC, RD, RA, RB);\t\tLK2(RC, RD, RA, RB, RE, 13);\n\tS(S5, RC, RD, RA, RB, RE);\t\tLK2(RE, RC, RD, RB, RA, 14);\n\tS(S6, RE, RC, RD, RB, RA);\t\tLK2(RD, RA, RC, RB, RE, 15);\n\tS(S7, RD, RA, RC, RB, RE);\t\tLK2(RE, RC, RB, RD, RA, 16);\n\tS(S0, RE, RC, RB, RD, RA);\t\tLK2(RB, RC, RD, RE, RA, 17);\n\tS(S1, RB, RC, RD, RE, RA);\t\tLK2(RA, RD, RE, RB, RC, 18);\n\tS(S2, RA, RD, RE, RB, RC);\t\tLK2(RC, RD, RA, RB, RE, 19);\n\tS(S3, RC, RD, RA, RB, RE);\t\tLK2(RB, RE, RD, RC, RA, 20);\n\tS(S4, RB, RE, RD, RC, RA);\t\tLK2(RE, RD, RC, RA, RB, 21);\n\tS(S5, RE, RD, RC, RA, RB);\t\tLK2(RB, RE, RD, RA, RC, 22);\n\tS(S6, RB, RE, RD, RA, RC);\t\tLK2(RD, RC, RE, RA, RB, 23);\n\tS(S7, RD, RC, RE, RA, RB);\t\tLK2(RB, RE, RA, RD, RC, 24);\n\tS(S0, RB, RE, RA, RD, RC);\t\tLK2(RA, RE, RD, RB, RC, 25);\n\tS(S1, RA, RE, RD, RB, RC);\t\tLK2(RC, RD, RB, RA, RE, 26);\n\tS(S2, RC, RD, RB, RA, RE);\t\tLK2(RE, RD, RC, RA, RB, 27);\n\tS(S3, RE, RD, RC, RA, RB);\t\tLK2(RA, RB, RD, RE, RC, 28);\n\tS(S4, RA, RB, RD, RE, RC);\t\tLK2(RB, RD, RE, RC, RA, 29);\n\tS(S5, RB, RD, RE, RC, RA);\t\tLK2(RA, RB, RD, RC, RE, 30);\n\tS(S6, RA, RB, RD, RC, RE);\t\tLK2(RD, RE, RB, RC, RA, 31);\n\tS(S7, RD, RE, RB, RC, RA);\t\t K2(RA, RB, RC, RD, RE, 32);\n\n\tleaq (4*4*4)(%rsi), %rax;\n\n\ttestb %cl, %cl;\n\tjnz .L__enc_xor8;\n\n\twrite_blocks(%rsi, RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\twrite_blocks(%rax, RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\tRET;\n\n.L__enc_xor8:\n\txor_blocks(%rsi, RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\txor_blocks(%rax, RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\tRET;\nSYM_FUNC_END(__serpent_enc_blk_8way)\n\nSYM_FUNC_START(serpent_dec_blk_8way)\n\t \n\n\tpcmpeqd RNOT, RNOT;\n\n\tleaq (4*4*4)(%rdx), %rax;\n\tread_blocks(%rdx, RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\tread_blocks(%rax, RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\t\t\t\t\t\t K2(RA, RB, RC, RD, RE, 32);\n\tSP(SI7, RA, RB, RC, RD, RE, 31);\tKL2(RB, RD, RA, RE, RC, 31);\n\tSP(SI6, RB, RD, RA, RE, RC, 30);\tKL2(RA, RC, RE, RB, RD, 30);\n\tSP(SI5, RA, RC, RE, RB, RD, 29);\tKL2(RC, RD, RA, RE, RB, 29);\n\tSP(SI4, RC, RD, RA, RE, RB, 28);\tKL2(RC, RA, RB, RE, RD, 28);\n\tSP(SI3, RC, RA, RB, RE, RD, 27);\tKL2(RB, RC, RD, RE, RA, 27);\n\tSP(SI2, RB, RC, RD, RE, RA, 26);\tKL2(RC, RA, RE, RD, RB, 26);\n\tSP(SI1, RC, RA, RE, RD, RB, 25);\tKL2(RB, RA, RE, RD, RC, 25);\n\tSP(SI0, RB, RA, RE, RD, RC, 24);\tKL2(RE, RC, RA, RB, RD, 24);\n\tSP(SI7, RE, RC, RA, RB, RD, 23);\tKL2(RC, RB, RE, RD, RA, 23);\n\tSP(SI6, RC, RB, RE, RD, RA, 22);\tKL2(RE, RA, RD, RC, RB, 22);\n\tSP(SI5, RE, RA, RD, RC, RB, 21);\tKL2(RA, RB, RE, RD, RC, 21);\n\tSP(SI4, RA, RB, RE, RD, RC, 20);\tKL2(RA, RE, RC, RD, RB, 20);\n\tSP(SI3, RA, RE, RC, RD, RB, 19);\tKL2(RC, RA, RB, RD, RE, 19);\n\tSP(SI2, RC, RA, RB, RD, RE, 18);\tKL2(RA, RE, RD, RB, RC, 18);\n\tSP(SI1, RA, RE, RD, RB, RC, 17);\tKL2(RC, RE, RD, RB, RA, 17);\n\tSP(SI0, RC, RE, RD, RB, RA, 16);\tKL2(RD, RA, RE, RC, RB, 16);\n\tSP(SI7, RD, RA, RE, RC, RB, 15);\tKL2(RA, RC, RD, RB, RE, 15);\n\tSP(SI6, RA, RC, RD, RB, RE, 14);\tKL2(RD, RE, RB, RA, RC, 14);\n\tSP(SI5, RD, RE, RB, RA, RC, 13);\tKL2(RE, RC, RD, RB, RA, 13);\n\tSP(SI4, RE, RC, RD, RB, RA, 12);\tKL2(RE, RD, RA, RB, RC, 12);\n\tSP(SI3, RE, RD, RA, RB, RC, 11);\tKL2(RA, RE, RC, RB, RD, 11);\n\tSP(SI2, RA, RE, RC, RB, RD, 10);\tKL2(RE, RD, RB, RC, RA, 10);\n\tSP(SI1, RE, RD, RB, RC, RA, 9);\t\tKL2(RA, RD, RB, RC, RE, 9);\n\tSP(SI0, RA, RD, RB, RC, RE, 8);\t\tKL2(RB, RE, RD, RA, RC, 8);\n\tSP(SI7, RB, RE, RD, RA, RC, 7);\t\tKL2(RE, RA, RB, RC, RD, 7);\n\tSP(SI6, RE, RA, RB, RC, RD, 6);\t\tKL2(RB, RD, RC, RE, RA, 6);\n\tSP(SI5, RB, RD, RC, RE, RA, 5);\t\tKL2(RD, RA, RB, RC, RE, 5);\n\tSP(SI4, RD, RA, RB, RC, RE, 4);\t\tKL2(RD, RB, RE, RC, RA, 4);\n\tSP(SI3, RD, RB, RE, RC, RA, 3);\t\tKL2(RE, RD, RA, RC, RB, 3);\n\tSP(SI2, RE, RD, RA, RC, RB, 2);\t\tKL2(RD, RB, RC, RA, RE, 2);\n\tSP(SI1, RD, RB, RC, RA, RE, 1);\t\tKL2(RE, RB, RC, RA, RD, 1);\n\tS(SI0, RE, RB, RC, RA, RD);\t\t K2(RC, RD, RB, RE, RA, 0);\n\n\tleaq (4*4*4)(%rsi), %rax;\n\twrite_blocks(%rsi, RC1, RD1, RB1, RE1, RK0, RK1, RK2);\n\twrite_blocks(%rax, RC2, RD2, RB2, RE2, RK0, RK1, RK2);\n\n\tRET;\nSYM_FUNC_END(serpent_dec_blk_8way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}