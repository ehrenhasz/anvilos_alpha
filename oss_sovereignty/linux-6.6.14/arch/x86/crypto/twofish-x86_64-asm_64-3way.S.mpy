{
  "module_name": "twofish-x86_64-asm_64-3way.S",
  "hash_id": "93880e303b2161cd3f02a62f0ed9887a586ac38c2a20434e55e934970d931ac4",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/twofish-x86_64-asm_64-3way.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n\n.file \"twofish-x86_64-asm-3way.S\"\n.text\n\n \n#define s0\t0\n#define s1\t1024\n#define s2\t2048\n#define s3\t3072\n#define w\t4096\n#define k\t4128\n\n \n#define CTX %rdi\n#define RIO %rdx\n\n#define RAB0 %rax\n#define RAB1 %rbx\n#define RAB2 %rcx\n\n#define RAB0d %eax\n#define RAB1d %ebx\n#define RAB2d %ecx\n\n#define RAB0bh %ah\n#define RAB1bh %bh\n#define RAB2bh %ch\n\n#define RAB0bl %al\n#define RAB1bl %bl\n#define RAB2bl %cl\n\n#define CD0 0x0(%rsp)\n#define CD1 0x8(%rsp)\n#define CD2 0x10(%rsp)\n\n# used only before/after all rounds\n#define RCD0 %r8\n#define RCD1 %r9\n#define RCD2 %r10\n\n# used only during rounds\n#define RX0 %r8\n#define RX1 %r9\n#define RX2 %r10\n\n#define RX0d %r8d\n#define RX1d %r9d\n#define RX2d %r10d\n\n#define RY0 %r11\n#define RY1 %r12\n#define RY2 %r13\n\n#define RY0d %r11d\n#define RY1d %r12d\n#define RY2d %r13d\n\n#define RT0 %rdx\n#define RT1 %rsi\n\n#define RT0d %edx\n#define RT1d %esi\n\n#define RT1bl %sil\n\n#define do16bit_ror(rot, op1, op2, T0, T1, tmp1, tmp2, ab, dst) \\\n\tmovzbl ab ## bl,\t\ttmp2 ## d; \\\n\tmovzbl ab ## bh,\t\ttmp1 ## d; \\\n\trorq $(rot),\t\t\tab; \\\n\top1##l T0(CTX, tmp2, 4),\tdst ## d; \\\n\top2##l T1(CTX, tmp1, 4),\tdst ## d;\n\n#define swap_ab_with_cd(ab, cd, tmp)\t\\\n\tmovq cd, tmp;\t\t\t\\\n\tmovq ab, cd;\t\t\t\\\n\tmovq tmp, ab;\n\n \n#define g1g2_3(ab, cd, Tx0, Tx1, Tx2, Tx3, Ty0, Ty1, Ty2, Ty3, x, y) \\\n\t  \\\n\tdo16bit_ror(32, mov, xor, Tx0, Tx1, RT0, x ## 0, ab ## 0, x ## 0); \\\n\tdo16bit_ror(48, mov, xor, Ty1, Ty2, RT0, y ## 0, ab ## 0, y ## 0); \\\n\t\\\n\tdo16bit_ror(32, mov, xor, Tx0, Tx1, RT0, x ## 1, ab ## 1, x ## 1); \\\n\tdo16bit_ror(48, mov, xor, Ty1, Ty2, RT0, y ## 1, ab ## 1, y ## 1); \\\n\t\\\n\tdo16bit_ror(32, mov, xor, Tx0, Tx1, RT0, x ## 2, ab ## 2, x ## 2); \\\n\tdo16bit_ror(48, mov, xor, Ty1, Ty2, RT0, y ## 2, ab ## 2, y ## 2); \\\n\t\\\n\t  \\\n\tdo16bit_ror(32, xor, xor, Tx2, Tx3, RT0, RT1, ab ## 0, x ## 0); \\\n\tdo16bit_ror(16, xor, xor, Ty3, Ty0, RT0, RT1, ab ## 0, y ## 0); \\\n\tswap_ab_with_cd(ab ## 0, cd ## 0, RT0); \\\n\t\\\n\tdo16bit_ror(32, xor, xor, Tx2, Tx3, RT0, RT1, ab ## 1, x ## 1); \\\n\tdo16bit_ror(16, xor, xor, Ty3, Ty0, RT0, RT1, ab ## 1, y ## 1); \\\n\tswap_ab_with_cd(ab ## 1, cd ## 1, RT0); \\\n\t\\\n\tdo16bit_ror(32, xor, xor, Tx2, Tx3, RT0, RT1, ab ## 2, x ## 2); \\\n\tdo16bit_ror(16, xor, xor, Ty3, Ty0, RT0, RT1, ab ## 2, y ## 2); \\\n\tswap_ab_with_cd(ab ## 2, cd ## 2, RT0);\n\n#define enc_round_end(ab, x, y, n) \\\n\taddl y ## d,\t\t\tx ## d; \\\n\taddl x ## d,\t\t\ty ## d; \\\n\taddl k+4*(2*(n))(CTX),\t\tx ## d; \\\n\txorl ab ## d,\t\t\tx ## d; \\\n\taddl k+4*(2*(n)+1)(CTX),\ty ## d; \\\n\tshrq $32,\t\t\tab; \\\n\troll $1,\t\t\tab ## d; \\\n\txorl y ## d,\t\t\tab ## d; \\\n\tshlq $32,\t\t\tab; \\\n\trorl $1,\t\t\tx ## d; \\\n\torq x,\t\t\t\tab;\n\n#define dec_round_end(ba, x, y, n) \\\n\taddl y ## d,\t\t\tx ## d; \\\n\taddl x ## d,\t\t\ty ## d; \\\n\taddl k+4*(2*(n))(CTX),\t\tx ## d; \\\n\taddl k+4*(2*(n)+1)(CTX),\ty ## d; \\\n\txorl ba ## d,\t\t\ty ## d; \\\n\tshrq $32,\t\t\tba; \\\n\troll $1,\t\t\tba ## d; \\\n\txorl x ## d,\t\t\tba ## d; \\\n\tshlq $32,\t\t\tba; \\\n\trorl $1,\t\t\ty ## d; \\\n\torq y,\t\t\t\tba;\n\n#define encrypt_round3(ab, cd, n) \\\n\tg1g2_3(ab, cd, s0, s1, s2, s3, s0, s1, s2, s3, RX, RY); \\\n\t\\\n\tenc_round_end(ab ## 0, RX0, RY0, n); \\\n\tenc_round_end(ab ## 1, RX1, RY1, n); \\\n\tenc_round_end(ab ## 2, RX2, RY2, n);\n\n#define decrypt_round3(ba, dc, n) \\\n\tg1g2_3(ba, dc, s1, s2, s3, s0, s3, s0, s1, s2, RY, RX); \\\n\t\\\n\tdec_round_end(ba ## 0, RX0, RY0, n); \\\n\tdec_round_end(ba ## 1, RX1, RY1, n); \\\n\tdec_round_end(ba ## 2, RX2, RY2, n);\n\n#define encrypt_cycle3(ab, cd, n) \\\n\tencrypt_round3(ab, cd, n*2); \\\n\tencrypt_round3(ab, cd, (n*2)+1);\n\n#define decrypt_cycle3(ba, dc, n) \\\n\tdecrypt_round3(ba, dc, (n*2)+1); \\\n\tdecrypt_round3(ba, dc, (n*2));\n\n#define push_cd()\t\\\n\tpushq RCD2;\t\\\n\tpushq RCD1;\t\\\n\tpushq RCD0;\n\n#define pop_cd()\t\\\n\tpopq RCD0;\t\\\n\tpopq RCD1;\t\\\n\tpopq RCD2;\n\n#define inpack3(in, n, xy, m) \\\n\tmovq 4*(n)(in),\t\t\txy ## 0; \\\n\txorq w+4*m(CTX),\t\txy ## 0; \\\n\t\\\n\tmovq 4*(4+(n))(in),\t\txy ## 1; \\\n\txorq w+4*m(CTX),\t\txy ## 1; \\\n\t\\\n\tmovq 4*(8+(n))(in),\t\txy ## 2; \\\n\txorq w+4*m(CTX),\t\txy ## 2;\n\n#define outunpack3(op, out, n, xy, m) \\\n\txorq w+4*m(CTX),\t\txy ## 0; \\\n\top ## q xy ## 0,\t\t4*(n)(out); \\\n\t\\\n\txorq w+4*m(CTX),\t\txy ## 1; \\\n\top ## q xy ## 1,\t\t4*(4+(n))(out); \\\n\t\\\n\txorq w+4*m(CTX),\t\txy ## 2; \\\n\top ## q xy ## 2,\t\t4*(8+(n))(out);\n\n#define inpack_enc3() \\\n\tinpack3(RIO, 0, RAB, 0); \\\n\tinpack3(RIO, 2, RCD, 2);\n\n#define outunpack_enc3(op) \\\n\toutunpack3(op, RIO, 2, RAB, 6); \\\n\toutunpack3(op, RIO, 0, RCD, 4);\n\n#define inpack_dec3() \\\n\tinpack3(RIO, 0, RAB, 4); \\\n\trorq $32,\t\t\tRAB0; \\\n\trorq $32,\t\t\tRAB1; \\\n\trorq $32,\t\t\tRAB2; \\\n\tinpack3(RIO, 2, RCD, 6); \\\n\trorq $32,\t\t\tRCD0; \\\n\trorq $32,\t\t\tRCD1; \\\n\trorq $32,\t\t\tRCD2;\n\n#define outunpack_dec3() \\\n\trorq $32,\t\t\tRCD0; \\\n\trorq $32,\t\t\tRCD1; \\\n\trorq $32,\t\t\tRCD2; \\\n\toutunpack3(mov, RIO, 0, RCD, 0); \\\n\trorq $32,\t\t\tRAB0; \\\n\trorq $32,\t\t\tRAB1; \\\n\trorq $32,\t\t\tRAB2; \\\n\toutunpack3(mov, RIO, 2, RAB, 2);\n\nSYM_FUNC_START(__twofish_enc_blk_3way)\n\t \n\tpushq %r13;\n\tpushq %r12;\n\tpushq %rbx;\n\n\tpushq %rcx;  \n\tpushq %rsi;  \n\n\tinpack_enc3();\n\n\tpush_cd();\n\tencrypt_cycle3(RAB, CD, 0);\n\tencrypt_cycle3(RAB, CD, 1);\n\tencrypt_cycle3(RAB, CD, 2);\n\tencrypt_cycle3(RAB, CD, 3);\n\tencrypt_cycle3(RAB, CD, 4);\n\tencrypt_cycle3(RAB, CD, 5);\n\tencrypt_cycle3(RAB, CD, 6);\n\tencrypt_cycle3(RAB, CD, 7);\n\tpop_cd();\n\n\tpopq RIO;  \n\tpopq RT1;  \n\n\ttestb RT1bl, RT1bl;\n\tjnz .L__enc_xor3;\n\n\toutunpack_enc3(mov);\n\n\tpopq %rbx;\n\tpopq %r12;\n\tpopq %r13;\n\tRET;\n\n.L__enc_xor3:\n\toutunpack_enc3(xor);\n\n\tpopq %rbx;\n\tpopq %r12;\n\tpopq %r13;\n\tRET;\nSYM_FUNC_END(__twofish_enc_blk_3way)\n\nSYM_FUNC_START(twofish_dec_blk_3way)\n\t \n\tpushq %r13;\n\tpushq %r12;\n\tpushq %rbx;\n\n\tpushq %rsi;  \n\n\tinpack_dec3();\n\n\tpush_cd();\n\tdecrypt_cycle3(RAB, CD, 7);\n\tdecrypt_cycle3(RAB, CD, 6);\n\tdecrypt_cycle3(RAB, CD, 5);\n\tdecrypt_cycle3(RAB, CD, 4);\n\tdecrypt_cycle3(RAB, CD, 3);\n\tdecrypt_cycle3(RAB, CD, 2);\n\tdecrypt_cycle3(RAB, CD, 1);\n\tdecrypt_cycle3(RAB, CD, 0);\n\tpop_cd();\n\n\tpopq RIO;  \n\n\toutunpack_dec3();\n\n\tpopq %rbx;\n\tpopq %r12;\n\tpopq %r13;\n\tRET;\nSYM_FUNC_END(twofish_dec_blk_3way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}