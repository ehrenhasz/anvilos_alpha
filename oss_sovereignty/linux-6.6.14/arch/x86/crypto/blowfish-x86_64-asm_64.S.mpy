{
  "module_name": "blowfish-x86_64-asm_64.S",
  "hash_id": "c37425d627334968bd97b1cbb38f37d748dfc4c292cbb6748cd5c22fe6f50a81",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/blowfish-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n\n.file \"blowfish-x86_64-asm.S\"\n.text\n\n \n#define p\t0\n#define s0\t((16 + 2) * 4)\n#define s1\t((16 + 2 + (1 * 256)) * 4)\n#define s2\t((16 + 2 + (2 * 256)) * 4)\n#define s3\t((16 + 2 + (3 * 256)) * 4)\n\n \n#define CTX %r12\n#define RIO %rsi\n\n#define RX0 %rax\n#define RX1 %rbx\n#define RX2 %rcx\n#define RX3 %rdx\n\n#define RX0d %eax\n#define RX1d %ebx\n#define RX2d %ecx\n#define RX3d %edx\n\n#define RX0bl %al\n#define RX1bl %bl\n#define RX2bl %cl\n#define RX3bl %dl\n\n#define RX0bh %ah\n#define RX1bh %bh\n#define RX2bh %ch\n#define RX3bh %dh\n\n#define RT0 %rdi\n#define RT1 %rsi\n#define RT2 %r8\n#define RT3 %r9\n\n#define RT0d %edi\n#define RT1d %esi\n#define RT2d %r8d\n#define RT3d %r9d\n\n#define RKEY %r10\n\n \n#define F() \\\n\trorq $16,\t\tRX0; \\\n\tmovzbl RX0bh,\t\tRT0d; \\\n\tmovzbl RX0bl,\t\tRT1d; \\\n\trolq $16,\t\tRX0; \\\n\tmovl s0(CTX,RT0,4),\tRT0d; \\\n\taddl s1(CTX,RT1,4),\tRT0d; \\\n\tmovzbl RX0bh,\t\tRT1d; \\\n\tmovzbl RX0bl,\t\tRT2d; \\\n\trolq $32,\t\tRX0; \\\n\txorl s2(CTX,RT1,4),\tRT0d; \\\n\taddl s3(CTX,RT2,4),\tRT0d; \\\n\txorq RT0,\t\tRX0;\n\n#define add_roundkey_enc(n) \\\n\txorq p+4*(n)(CTX), \tRX0;\n\n#define round_enc(n) \\\n\tadd_roundkey_enc(n); \\\n\t\\\n\tF(); \\\n\tF();\n\n#define add_roundkey_dec(n) \\\n\tmovq p+4*(n-1)(CTX),\tRT0; \\\n\trorq $32,\t\tRT0; \\\n\txorq RT0,\t\tRX0;\n\n#define round_dec(n) \\\n\tadd_roundkey_dec(n); \\\n\t\\\n\tF(); \\\n\tF(); \\\n\n#define read_block() \\\n\tmovq (RIO), \t\tRX0; \\\n\trorq $32, \t\tRX0; \\\n\tbswapq \t\t\tRX0;\n\n#define write_block() \\\n\tbswapq \t\t\tRX0; \\\n\tmovq RX0, \t\t(RIO);\n\nSYM_FUNC_START(blowfish_enc_blk)\n\t \n\tmovq %r12, %r11;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r10;\n\tmovq %rdx, RIO;\n\n\tread_block();\n\n\tround_enc(0);\n\tround_enc(2);\n\tround_enc(4);\n\tround_enc(6);\n\tround_enc(8);\n\tround_enc(10);\n\tround_enc(12);\n\tround_enc(14);\n\tadd_roundkey_enc(16);\n\n\tmovq %r11, %r12;\n\tmovq %r10, RIO;\n\n\twrite_block();\n\tRET;\nSYM_FUNC_END(blowfish_enc_blk)\n\nSYM_FUNC_START(blowfish_dec_blk)\n\t \n\tmovq %r12, %r11;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r10;\n\tmovq %rdx, RIO;\n\n\tread_block();\n\n\tround_dec(17);\n\tround_dec(15);\n\tround_dec(13);\n\tround_dec(11);\n\tround_dec(9);\n\tround_dec(7);\n\tround_dec(5);\n\tround_dec(3);\n\tadd_roundkey_dec(1);\n\n\tmovq %r10, RIO;\n\twrite_block();\n\n\tmovq %r11, %r12;\n\n\tRET;\nSYM_FUNC_END(blowfish_dec_blk)\n\n \n\n \n#define F4(x) \\\n\tmovzbl x ## bh,\t\tRT1d; \\\n\tmovzbl x ## bl,\t\tRT3d; \\\n\trorq $16,\t\tx; \\\n\tmovzbl x ## bh,\t\tRT0d; \\\n\tmovzbl x ## bl,\t\tRT2d; \\\n\trorq $16,\t\tx; \\\n\tmovl s0(CTX,RT0,4),\tRT0d; \\\n\taddl s1(CTX,RT2,4),\tRT0d; \\\n\txorl s2(CTX,RT1,4),\tRT0d; \\\n\taddl s3(CTX,RT3,4),\tRT0d; \\\n\txorq RT0,\t\tx;\n\n#define add_preloaded_roundkey4() \\\n\txorq RKEY,\t\tRX0; \\\n\txorq RKEY,\t\tRX1; \\\n\txorq RKEY,\t\tRX2; \\\n\txorq RKEY,\t\tRX3;\n\n#define preload_roundkey_enc(n) \\\n\tmovq p+4*(n)(CTX),\tRKEY;\n\n#define add_roundkey_enc4(n) \\\n\tadd_preloaded_roundkey4(); \\\n\tpreload_roundkey_enc(n + 2);\n\n#define round_enc4(n) \\\n\tadd_roundkey_enc4(n); \\\n\t\\\n\tF4(RX0); \\\n\tF4(RX1); \\\n\tF4(RX2); \\\n\tF4(RX3); \\\n\t\\\n\tF4(RX0); \\\n\tF4(RX1); \\\n\tF4(RX2); \\\n\tF4(RX3);\n\n#define preload_roundkey_dec(n) \\\n\tmovq p+4*((n)-1)(CTX),\tRKEY; \\\n\trorq $32,\t\tRKEY;\n\n#define add_roundkey_dec4(n) \\\n\tadd_preloaded_roundkey4(); \\\n\tpreload_roundkey_dec(n - 2);\n\n#define round_dec4(n) \\\n\tadd_roundkey_dec4(n); \\\n\t\\\n\tF4(RX0); \\\n\tF4(RX1); \\\n\tF4(RX2); \\\n\tF4(RX3); \\\n\t\\\n\tF4(RX0); \\\n\tF4(RX1); \\\n\tF4(RX2); \\\n\tF4(RX3);\n\n#define read_block4() \\\n\tmovq (RIO),\t\tRX0; \\\n\trorq $32,\t\tRX0; \\\n\tbswapq \t\t\tRX0; \\\n\t\\\n\tmovq 8(RIO),\t\tRX1; \\\n\trorq $32,\t\tRX1; \\\n\tbswapq \t\t\tRX1; \\\n\t\\\n\tmovq 16(RIO),\t\tRX2; \\\n\trorq $32,\t\tRX2; \\\n\tbswapq \t\t\tRX2; \\\n\t\\\n\tmovq 24(RIO),\t\tRX3; \\\n\trorq $32,\t\tRX3; \\\n\tbswapq \t\t\tRX3;\n\n#define write_block4() \\\n\tbswapq \t\t\tRX0; \\\n\tmovq RX0,\t\t(RIO); \\\n\t\\\n\tbswapq \t\t\tRX1; \\\n\tmovq RX1,\t\t8(RIO); \\\n\t\\\n\tbswapq \t\t\tRX2; \\\n\tmovq RX2,\t\t16(RIO); \\\n\t\\\n\tbswapq \t\t\tRX3; \\\n\tmovq RX3,\t\t24(RIO);\n\n#define xor_block4() \\\n\tmovq (RIO),\t\tRT0; \\\n\tbswapq\t\t\tRT0; \\\n\txorq RT0,\t\tRX1; \\\n\t\\\n\tmovq 8(RIO),\t\tRT2; \\\n\tbswapq\t\t\tRT2; \\\n\txorq RT2,\t\tRX2; \\\n\t\\\n\tmovq 16(RIO),\t\tRT3; \\\n\tbswapq\t\t\tRT3; \\\n\txorq RT3,\t\tRX3;\n\nSYM_FUNC_START(blowfish_enc_blk_4way)\n\t \n\tpushq %r12;\n\tpushq %rbx;\n\n\tmovq %rdi, CTX\n\tmovq %rsi, %r11;\n\tmovq %rdx, RIO;\n\n\tpreload_roundkey_enc(0);\n\n\tread_block4();\n\n\tround_enc4(0);\n\tround_enc4(2);\n\tround_enc4(4);\n\tround_enc4(6);\n\tround_enc4(8);\n\tround_enc4(10);\n\tround_enc4(12);\n\tround_enc4(14);\n\tadd_preloaded_roundkey4();\n\n\tmovq %r11, RIO;\n\twrite_block4();\n\n\tpopq %rbx;\n\tpopq %r12;\n\tRET;\nSYM_FUNC_END(blowfish_enc_blk_4way)\n\nSYM_FUNC_START(__blowfish_dec_blk_4way)\n\t \n\tpushq %r12;\n\tpushq %rbx;\n\tpushq %rcx;\n\tpushq %rdx;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\tmovq %rdx, RIO;\n\n\tpreload_roundkey_dec(17);\n\tread_block4();\n\n\tround_dec4(17);\n\tround_dec4(15);\n\tround_dec4(13);\n\tround_dec4(11);\n\tround_dec4(9);\n\tround_dec4(7);\n\tround_dec4(5);\n\tround_dec4(3);\n\tadd_preloaded_roundkey4();\n\n\tpopq RIO;\n\tpopq %r12;\n\ttestq %r12, %r12;\n\tjz .L_no_cbc_xor;\n\n\txor_block4();\n\n.L_no_cbc_xor:\n\tmovq %r11, RIO;\n\twrite_block4();\n\n\tpopq %rbx;\n\tpopq %r12;\n\n\tRET;\nSYM_FUNC_END(__blowfish_dec_blk_4way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}