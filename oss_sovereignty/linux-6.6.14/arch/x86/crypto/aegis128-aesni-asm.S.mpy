{
  "module_name": "aegis128-aesni-asm.S",
  "hash_id": "b3b27897a127f284180edbb995f421a1c4e5fdf21a81d56aa54883b0f92a4b30",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/aegis128-aesni-asm.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <linux/cfi_types.h>\n#include <asm/frame.h>\n\n#define STATE0\t%xmm0\n#define STATE1\t%xmm1\n#define STATE2\t%xmm2\n#define STATE3\t%xmm3\n#define STATE4\t%xmm4\n#define KEY\t%xmm5\n#define MSG\t%xmm5\n#define T0\t%xmm6\n#define T1\t%xmm7\n\n#define STATEP\t%rdi\n#define LEN\t%rsi\n#define SRC\t%rdx\n#define DST\t%rcx\n\n.section .rodata.cst16.aegis128_const, \"aM\", @progbits, 32\n.align 16\n.Laegis128_const_0:\n\t.byte 0x00, 0x01, 0x01, 0x02, 0x03, 0x05, 0x08, 0x0d\n\t.byte 0x15, 0x22, 0x37, 0x59, 0x90, 0xe9, 0x79, 0x62\n.Laegis128_const_1:\n\t.byte 0xdb, 0x3d, 0x18, 0x55, 0x6d, 0xc2, 0x2f, 0xf1\n\t.byte 0x20, 0x11, 0x31, 0x42, 0x73, 0xb5, 0x28, 0xdd\n\n.section .rodata.cst16.aegis128_counter, \"aM\", @progbits, 16\n.align 16\n.Laegis128_counter:\n\t.byte 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07\n\t.byte 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f\n\n.text\n\n \n.macro aegis128_update\n\tmovdqa STATE4, T0\n\taesenc STATE0, STATE4\n\taesenc STATE1, STATE0\n\taesenc STATE2, STATE1\n\taesenc STATE3, STATE2\n\taesenc T0,     STATE3\n.endm\n\n \nSYM_FUNC_START_LOCAL(__load_partial)\n\txor %r9d, %r9d\n\tpxor MSG, MSG\n\n\tmov LEN, %r8\n\tand $0x1, %r8\n\tjz .Lld_partial_1\n\n\tmov LEN, %r8\n\tand $0x1E, %r8\n\tadd SRC, %r8\n\tmov (%r8), %r9b\n\n.Lld_partial_1:\n\tmov LEN, %r8\n\tand $0x2, %r8\n\tjz .Lld_partial_2\n\n\tmov LEN, %r8\n\tand $0x1C, %r8\n\tadd SRC, %r8\n\tshl $0x10, %r9\n\tmov (%r8), %r9w\n\n.Lld_partial_2:\n\tmov LEN, %r8\n\tand $0x4, %r8\n\tjz .Lld_partial_4\n\n\tmov LEN, %r8\n\tand $0x18, %r8\n\tadd SRC, %r8\n\tshl $32, %r9\n\tmov (%r8), %r8d\n\txor %r8, %r9\n\n.Lld_partial_4:\n\tmovq %r9, MSG\n\n\tmov LEN, %r8\n\tand $0x8, %r8\n\tjz .Lld_partial_8\n\n\tmov LEN, %r8\n\tand $0x10, %r8\n\tadd SRC, %r8\n\tpslldq $8, MSG\n\tmovq (%r8), T0\n\tpxor T0, MSG\n\n.Lld_partial_8:\n\tRET\nSYM_FUNC_END(__load_partial)\n\n \nSYM_FUNC_START_LOCAL(__store_partial)\n\tmov LEN, %r8\n\tmov DST, %r9\n\n\tmovq T0, %r10\n\n\tcmp $8, %r8\n\tjl .Lst_partial_8\n\n\tmov %r10, (%r9)\n\tpsrldq $8, T0\n\tmovq T0, %r10\n\n\tsub $8, %r8\n\tadd $8, %r9\n\n.Lst_partial_8:\n\tcmp $4, %r8\n\tjl .Lst_partial_4\n\n\tmov %r10d, (%r9)\n\tshr $32, %r10\n\n\tsub $4, %r8\n\tadd $4, %r9\n\n.Lst_partial_4:\n\tcmp $2, %r8\n\tjl .Lst_partial_2\n\n\tmov %r10w, (%r9)\n\tshr $0x10, %r10\n\n\tsub $2, %r8\n\tadd $2, %r9\n\n.Lst_partial_2:\n\tcmp $1, %r8\n\tjl .Lst_partial_1\n\n\tmov %r10b, (%r9)\n\n.Lst_partial_1:\n\tRET\nSYM_FUNC_END(__store_partial)\n\n \nSYM_FUNC_START(crypto_aegis128_aesni_init)\n\tFRAME_BEGIN\n\n\t \n\tmovdqu (%rdx), T1\n\n\t \n\tmovdqa (%rsi), KEY\n\tpxor KEY, T1\n\tmovdqa T1, STATE0\n\tmovdqa KEY, STATE3\n\tmovdqa KEY, STATE4\n\n\t \n\tmovdqa .Laegis128_const_0(%rip), STATE2\n\tmovdqa .Laegis128_const_1(%rip), STATE1\n\tpxor STATE2, STATE3\n\tpxor STATE1, STATE4\n\n\t \n\taegis128_update; pxor KEY, STATE4\n\taegis128_update; pxor T1,  STATE3\n\taegis128_update; pxor KEY, STATE2\n\taegis128_update; pxor T1,  STATE1\n\taegis128_update; pxor KEY, STATE0\n\taegis128_update; pxor T1,  STATE4\n\taegis128_update; pxor KEY, STATE3\n\taegis128_update; pxor T1,  STATE2\n\taegis128_update; pxor KEY, STATE1\n\taegis128_update; pxor T1,  STATE0\n\n\t \n\tmovdqu STATE0, 0x00(STATEP)\n\tmovdqu STATE1, 0x10(STATEP)\n\tmovdqu STATE2, 0x20(STATEP)\n\tmovdqu STATE3, 0x30(STATEP)\n\tmovdqu STATE4, 0x40(STATEP)\n\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_init)\n\n \nSYM_FUNC_START(crypto_aegis128_aesni_ad)\n\tFRAME_BEGIN\n\n\tcmp $0x10, LEN\n\tjb .Lad_out\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\tmov SRC, %r8\n\tand $0xF, %r8\n\tjnz .Lad_u_loop\n\n.align 8\n.Lad_a_loop:\n\tmovdqa 0x00(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE4\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_1\n\n\tmovdqa 0x10(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE3\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_2\n\n\tmovdqa 0x20(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE2\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_3\n\n\tmovdqa 0x30(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE1\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_4\n\n\tmovdqa 0x40(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE0\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_0\n\n\tadd $0x50, SRC\n\tjmp .Lad_a_loop\n\n.align 8\n.Lad_u_loop:\n\tmovdqu 0x00(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE4\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_1\n\n\tmovdqu 0x10(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE3\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_2\n\n\tmovdqu 0x20(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE2\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_3\n\n\tmovdqu 0x30(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE1\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_4\n\n\tmovdqu 0x40(SRC), MSG\n\taegis128_update\n\tpxor MSG, STATE0\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lad_out_0\n\n\tadd $0x50, SRC\n\tjmp .Lad_u_loop\n\n\t \n.Lad_out_0:\n\tmovdqu STATE0, 0x00(STATEP)\n\tmovdqu STATE1, 0x10(STATEP)\n\tmovdqu STATE2, 0x20(STATEP)\n\tmovdqu STATE3, 0x30(STATEP)\n\tmovdqu STATE4, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lad_out_1:\n\tmovdqu STATE4, 0x00(STATEP)\n\tmovdqu STATE0, 0x10(STATEP)\n\tmovdqu STATE1, 0x20(STATEP)\n\tmovdqu STATE2, 0x30(STATEP)\n\tmovdqu STATE3, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lad_out_2:\n\tmovdqu STATE3, 0x00(STATEP)\n\tmovdqu STATE4, 0x10(STATEP)\n\tmovdqu STATE0, 0x20(STATEP)\n\tmovdqu STATE1, 0x30(STATEP)\n\tmovdqu STATE2, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lad_out_3:\n\tmovdqu STATE2, 0x00(STATEP)\n\tmovdqu STATE3, 0x10(STATEP)\n\tmovdqu STATE4, 0x20(STATEP)\n\tmovdqu STATE0, 0x30(STATEP)\n\tmovdqu STATE1, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lad_out_4:\n\tmovdqu STATE1, 0x00(STATEP)\n\tmovdqu STATE2, 0x10(STATEP)\n\tmovdqu STATE3, 0x20(STATEP)\n\tmovdqu STATE4, 0x30(STATEP)\n\tmovdqu STATE0, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lad_out:\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_ad)\n\n.macro encrypt_block a s0 s1 s2 s3 s4 i\n\tmovdq\\a (\\i * 0x10)(SRC), MSG\n\tmovdqa MSG, T0\n\tpxor \\s1, T0\n\tpxor \\s4, T0\n\tmovdqa \\s2, T1\n\tpand \\s3, T1\n\tpxor T1, T0\n\tmovdq\\a T0, (\\i * 0x10)(DST)\n\n\taegis128_update\n\tpxor MSG, \\s4\n\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Lenc_out_\\i\n.endm\n\n \nSYM_TYPED_FUNC_START(crypto_aegis128_aesni_enc)\n\tFRAME_BEGIN\n\n\tcmp $0x10, LEN\n\tjb .Lenc_out\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\tmov  SRC,  %r8\n\tor   DST,  %r8\n\tand $0xF, %r8\n\tjnz .Lenc_u_loop\n\n.align 8\n.Lenc_a_loop:\n\tencrypt_block a STATE0 STATE1 STATE2 STATE3 STATE4 0\n\tencrypt_block a STATE4 STATE0 STATE1 STATE2 STATE3 1\n\tencrypt_block a STATE3 STATE4 STATE0 STATE1 STATE2 2\n\tencrypt_block a STATE2 STATE3 STATE4 STATE0 STATE1 3\n\tencrypt_block a STATE1 STATE2 STATE3 STATE4 STATE0 4\n\n\tadd $0x50, SRC\n\tadd $0x50, DST\n\tjmp .Lenc_a_loop\n\n.align 8\n.Lenc_u_loop:\n\tencrypt_block u STATE0 STATE1 STATE2 STATE3 STATE4 0\n\tencrypt_block u STATE4 STATE0 STATE1 STATE2 STATE3 1\n\tencrypt_block u STATE3 STATE4 STATE0 STATE1 STATE2 2\n\tencrypt_block u STATE2 STATE3 STATE4 STATE0 STATE1 3\n\tencrypt_block u STATE1 STATE2 STATE3 STATE4 STATE0 4\n\n\tadd $0x50, SRC\n\tadd $0x50, DST\n\tjmp .Lenc_u_loop\n\n\t \n.Lenc_out_0:\n\tmovdqu STATE4, 0x00(STATEP)\n\tmovdqu STATE0, 0x10(STATEP)\n\tmovdqu STATE1, 0x20(STATEP)\n\tmovdqu STATE2, 0x30(STATEP)\n\tmovdqu STATE3, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lenc_out_1:\n\tmovdqu STATE3, 0x00(STATEP)\n\tmovdqu STATE4, 0x10(STATEP)\n\tmovdqu STATE0, 0x20(STATEP)\n\tmovdqu STATE1, 0x30(STATEP)\n\tmovdqu STATE2, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lenc_out_2:\n\tmovdqu STATE2, 0x00(STATEP)\n\tmovdqu STATE3, 0x10(STATEP)\n\tmovdqu STATE4, 0x20(STATEP)\n\tmovdqu STATE0, 0x30(STATEP)\n\tmovdqu STATE1, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lenc_out_3:\n\tmovdqu STATE1, 0x00(STATEP)\n\tmovdqu STATE2, 0x10(STATEP)\n\tmovdqu STATE3, 0x20(STATEP)\n\tmovdqu STATE4, 0x30(STATEP)\n\tmovdqu STATE0, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lenc_out_4:\n\tmovdqu STATE0, 0x00(STATEP)\n\tmovdqu STATE1, 0x10(STATEP)\n\tmovdqu STATE2, 0x20(STATEP)\n\tmovdqu STATE3, 0x30(STATEP)\n\tmovdqu STATE4, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Lenc_out:\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_enc)\n\n \nSYM_TYPED_FUNC_START(crypto_aegis128_aesni_enc_tail)\n\tFRAME_BEGIN\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\t \n\tcall __load_partial\n\n\tmovdqa MSG, T0\n\tpxor STATE1, T0\n\tpxor STATE4, T0\n\tmovdqa STATE2, T1\n\tpand STATE3, T1\n\tpxor T1, T0\n\n\tcall __store_partial\n\n\taegis128_update\n\tpxor MSG, STATE4\n\n\t \n\tmovdqu STATE4, 0x00(STATEP)\n\tmovdqu STATE0, 0x10(STATEP)\n\tmovdqu STATE1, 0x20(STATEP)\n\tmovdqu STATE2, 0x30(STATEP)\n\tmovdqu STATE3, 0x40(STATEP)\n\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_enc_tail)\n\n.macro decrypt_block a s0 s1 s2 s3 s4 i\n\tmovdq\\a (\\i * 0x10)(SRC), MSG\n\tpxor \\s1, MSG\n\tpxor \\s4, MSG\n\tmovdqa \\s2, T1\n\tpand \\s3, T1\n\tpxor T1, MSG\n\tmovdq\\a MSG, (\\i * 0x10)(DST)\n\n\taegis128_update\n\tpxor MSG, \\s4\n\n\tsub $0x10, LEN\n\tcmp $0x10, LEN\n\tjl .Ldec_out_\\i\n.endm\n\n \nSYM_TYPED_FUNC_START(crypto_aegis128_aesni_dec)\n\tFRAME_BEGIN\n\n\tcmp $0x10, LEN\n\tjb .Ldec_out\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\tmov  SRC, %r8\n\tor   DST, %r8\n\tand $0xF, %r8\n\tjnz .Ldec_u_loop\n\n.align 8\n.Ldec_a_loop:\n\tdecrypt_block a STATE0 STATE1 STATE2 STATE3 STATE4 0\n\tdecrypt_block a STATE4 STATE0 STATE1 STATE2 STATE3 1\n\tdecrypt_block a STATE3 STATE4 STATE0 STATE1 STATE2 2\n\tdecrypt_block a STATE2 STATE3 STATE4 STATE0 STATE1 3\n\tdecrypt_block a STATE1 STATE2 STATE3 STATE4 STATE0 4\n\n\tadd $0x50, SRC\n\tadd $0x50, DST\n\tjmp .Ldec_a_loop\n\n.align 8\n.Ldec_u_loop:\n\tdecrypt_block u STATE0 STATE1 STATE2 STATE3 STATE4 0\n\tdecrypt_block u STATE4 STATE0 STATE1 STATE2 STATE3 1\n\tdecrypt_block u STATE3 STATE4 STATE0 STATE1 STATE2 2\n\tdecrypt_block u STATE2 STATE3 STATE4 STATE0 STATE1 3\n\tdecrypt_block u STATE1 STATE2 STATE3 STATE4 STATE0 4\n\n\tadd $0x50, SRC\n\tadd $0x50, DST\n\tjmp .Ldec_u_loop\n\n\t \n.Ldec_out_0:\n\tmovdqu STATE4, 0x00(STATEP)\n\tmovdqu STATE0, 0x10(STATEP)\n\tmovdqu STATE1, 0x20(STATEP)\n\tmovdqu STATE2, 0x30(STATEP)\n\tmovdqu STATE3, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Ldec_out_1:\n\tmovdqu STATE3, 0x00(STATEP)\n\tmovdqu STATE4, 0x10(STATEP)\n\tmovdqu STATE0, 0x20(STATEP)\n\tmovdqu STATE1, 0x30(STATEP)\n\tmovdqu STATE2, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Ldec_out_2:\n\tmovdqu STATE2, 0x00(STATEP)\n\tmovdqu STATE3, 0x10(STATEP)\n\tmovdqu STATE4, 0x20(STATEP)\n\tmovdqu STATE0, 0x30(STATEP)\n\tmovdqu STATE1, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Ldec_out_3:\n\tmovdqu STATE1, 0x00(STATEP)\n\tmovdqu STATE2, 0x10(STATEP)\n\tmovdqu STATE3, 0x20(STATEP)\n\tmovdqu STATE4, 0x30(STATEP)\n\tmovdqu STATE0, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Ldec_out_4:\n\tmovdqu STATE0, 0x00(STATEP)\n\tmovdqu STATE1, 0x10(STATEP)\n\tmovdqu STATE2, 0x20(STATEP)\n\tmovdqu STATE3, 0x30(STATEP)\n\tmovdqu STATE4, 0x40(STATEP)\n\tFRAME_END\n\tRET\n\n.Ldec_out:\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_dec)\n\n \nSYM_TYPED_FUNC_START(crypto_aegis128_aesni_dec_tail)\n\tFRAME_BEGIN\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\t \n\tcall __load_partial\n\n\tpxor STATE1, MSG\n\tpxor STATE4, MSG\n\tmovdqa STATE2, T1\n\tpand STATE3, T1\n\tpxor T1, MSG\n\n\tmovdqa MSG, T0\n\tcall __store_partial\n\n\t \n\tmovq LEN, T0\n\tpunpcklbw T0, T0\n\tpunpcklbw T0, T0\n\tpunpcklbw T0, T0\n\tpunpcklbw T0, T0\n\tmovdqa .Laegis128_counter(%rip), T1\n\tpcmpgtb T1, T0\n\tpand T0, MSG\n\n\taegis128_update\n\tpxor MSG, STATE4\n\n\t \n\tmovdqu STATE4, 0x00(STATEP)\n\tmovdqu STATE0, 0x10(STATEP)\n\tmovdqu STATE1, 0x20(STATEP)\n\tmovdqu STATE2, 0x30(STATEP)\n\tmovdqu STATE3, 0x40(STATEP)\n\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_dec_tail)\n\n \nSYM_FUNC_START(crypto_aegis128_aesni_final)\n\tFRAME_BEGIN\n\n\t \n\tmovdqu 0x00(STATEP), STATE0\n\tmovdqu 0x10(STATEP), STATE1\n\tmovdqu 0x20(STATEP), STATE2\n\tmovdqu 0x30(STATEP), STATE3\n\tmovdqu 0x40(STATEP), STATE4\n\n\t \n\tmovq %rdx, MSG\n\tmovq %rcx, T0\n\tpslldq $8, T0\n\tpxor T0, MSG\n\tpsllq $3, MSG  \n\n\tpxor STATE3, MSG\n\n\t \n\taegis128_update; pxor MSG, STATE4\n\taegis128_update; pxor MSG, STATE3\n\taegis128_update; pxor MSG, STATE2\n\taegis128_update; pxor MSG, STATE1\n\taegis128_update; pxor MSG, STATE0\n\taegis128_update; pxor MSG, STATE4\n\taegis128_update; pxor MSG, STATE3\n\n\t \n\tmovdqu (%rsi), MSG\n\n\tpxor STATE0, MSG\n\tpxor STATE1, MSG\n\tpxor STATE2, MSG\n\tpxor STATE3, MSG\n\tpxor STATE4, MSG\n\n\tmovdqu MSG, (%rsi)\n\n\tFRAME_END\n\tRET\nSYM_FUNC_END(crypto_aegis128_aesni_final)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}