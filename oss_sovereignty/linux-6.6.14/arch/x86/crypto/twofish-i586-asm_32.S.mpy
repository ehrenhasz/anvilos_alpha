{
  "module_name": "twofish-i586-asm_32.S",
  "hash_id": "383708f138ddab5a725e1fddc816af96d843f2a3e86b946c4a25c85b15167876",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/twofish-i586-asm_32.S",
  "human_readable_source": " \n \n\n.file \"twofish-i586-asm.S\"\n.text\n\n#include <linux/linkage.h>\n#include <asm/asm-offsets.h>\n\n \n\n#define in_blk    12   \n#define out_blk   8   \n#define ctx       4   \n\n#define a_offset\t0\n#define b_offset\t4\n#define c_offset\t8\n#define d_offset\t12\n\n \n\n#define s0\t0\t \n#define s1\t1024\t \n#define s2\t2048\t \n#define s3\t3072\t \n#define w\t4096\t \n#define k\t4128\t \n\n \n\n#define R0D    %eax\n#define R0B    %al\n#define R0H    %ah\n\n#define R1D    %ebx\n#define R1B    %bl\n#define R1H    %bh\n\n#define R2D    %ecx\n#define R2B    %cl\n#define R2H    %ch\n\n#define R3D    %edx\n#define R3B    %dl\n#define R3H    %dh\n\n\n \n#define input_whitening(src,context,offset)\\\n\txor\tw+offset(context),\tsrc;\n\n \n#define output_whitening(src,context,offset)\\\n\txor\tw+16+offset(context),\tsrc;\n\n \n#define encrypt_round(a,b,c,d,round)\\\n\tpush\td ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts1(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\ts2(%ebp,%edi,4),%esi;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\ts2(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts3(%ebp,%edi,4),%esi;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts3(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\t(%ebp,%edi,4),\t%esi;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$15,\t\tb ## D;\\\n\txor\t(%ebp,%edi,4),\td ## D;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\txor\ts1(%ebp,%edi,4),%esi;\\\n\tpop\t%edi;\\\n\tadd\td ## D,\t\t%esi;\\\n\tadd\t%esi,\t\td ## D;\\\n\tadd\tk+round(%ebp),\t%esi;\\\n\txor\t%esi,\t\tc ## D;\\\n\trol\t$15,\t\tc ## D;\\\n\tadd\tk+4+round(%ebp),d ## D;\\\n\txor\t%edi,\t\td ## D;\n\n \n#define encrypt_last_round(a,b,c,d,round)\\\n\tpush\td ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts1(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\ts2(%ebp,%edi,4),%esi;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\ts2(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts3(%ebp,%edi,4),%esi;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts3(%ebp,%edi,4),d ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\t(%ebp,%edi,4),\t%esi;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\t(%ebp,%edi,4),\td ## D;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\txor\ts1(%ebp,%edi,4),%esi;\\\n\tpop\t%edi;\\\n\tadd\td ## D,\t\t%esi;\\\n\tadd\t%esi,\t\td ## D;\\\n\tadd\tk+round(%ebp),\t%esi;\\\n\txor\t%esi,\t\tc ## D;\\\n\tror\t$1,\t\tc ## D;\\\n\tadd\tk+4+round(%ebp),d ## D;\\\n\txor\t%edi,\t\td ## D;\n\n \n#define decrypt_round(a,b,c,d,round)\\\n\tpush\tc ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\t(%ebp,%edi,4),\tc ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts3(%ebp,%edi,4),%esi;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts1(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\t(%ebp,%edi,4),\t%esi;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\ts2(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts1(%ebp,%edi,4),%esi;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$15,\t\ta ## D;\\\n\txor\ts3(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\txor\ts2(%ebp,%edi,4),%esi;\\\n\tpop\t%edi;\\\n\tadd\t%esi,\t\tc ## D;\\\n\tadd\tc ## D,\t\t%esi;\\\n\tadd\tk+round(%ebp),\tc ## D;\\\n\txor\t%edi,\t\tc ## D;\\\n\tadd\tk+4+round(%ebp),%esi;\\\n\txor\t%esi,\t\td ## D;\\\n\trol\t$15,\t\td ## D;\n\n \n#define decrypt_last_round(a,b,c,d,round)\\\n\tpush\tc ## D;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\tmov\t(%ebp,%edi,4),\tc ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\tmov\ts3(%ebp,%edi,4),%esi;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts1(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\tror\t$16,\t\tb ## D;\\\n\txor\t(%ebp,%edi,4),\t%esi;\\\n\tmovzx\ta ## B,\t\t%edi;\\\n\txor\ts2(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## B,\t\t%edi;\\\n\txor\ts1(%ebp,%edi,4),%esi;\\\n\tmovzx\ta ## H,\t\t%edi;\\\n\tror\t$16,\t\ta ## D;\\\n\txor\ts3(%ebp,%edi,4),c ## D;\\\n\tmovzx\tb ## H,\t\t%edi;\\\n\txor\ts2(%ebp,%edi,4),%esi;\\\n\tpop\t%edi;\\\n\tadd\t%esi,\t\tc ## D;\\\n\tadd\tc ## D,\t\t%esi;\\\n\tadd\tk+round(%ebp),\tc ## D;\\\n\txor\t%edi,\t\tc ## D;\\\n\tadd\tk+4+round(%ebp),%esi;\\\n\txor\t%esi,\t\td ## D;\\\n\tror\t$1,\t\td ## D;\n\nSYM_FUNC_START(twofish_enc_blk)\n\tpush\t%ebp\t\t\t \n\tpush    %ebx\n\tpush    %esi\n\tpush    %edi\n\n\tmov\tctx + 16(%esp),\t%ebp\t \n\tmov     in_blk+16(%esp),%edi\t \n\n\tmov\t(%edi),\t\t%eax\n\tmov\tb_offset(%edi),\t%ebx\n\tmov\tc_offset(%edi),\t%ecx\n\tmov\td_offset(%edi),\t%edx\n\tinput_whitening(%eax,%ebp,a_offset)\n\tror\t$16,\t%eax\n\tinput_whitening(%ebx,%ebp,b_offset)\n\tinput_whitening(%ecx,%ebp,c_offset)\n\tinput_whitening(%edx,%ebp,d_offset)\n\trol\t$1,\t%edx\n\n\tencrypt_round(R0,R1,R2,R3,0);\n\tencrypt_round(R2,R3,R0,R1,8);\n\tencrypt_round(R0,R1,R2,R3,2*8);\n\tencrypt_round(R2,R3,R0,R1,3*8);\n\tencrypt_round(R0,R1,R2,R3,4*8);\n\tencrypt_round(R2,R3,R0,R1,5*8);\n\tencrypt_round(R0,R1,R2,R3,6*8);\n\tencrypt_round(R2,R3,R0,R1,7*8);\n\tencrypt_round(R0,R1,R2,R3,8*8);\n\tencrypt_round(R2,R3,R0,R1,9*8);\n\tencrypt_round(R0,R1,R2,R3,10*8);\n\tencrypt_round(R2,R3,R0,R1,11*8);\n\tencrypt_round(R0,R1,R2,R3,12*8);\n\tencrypt_round(R2,R3,R0,R1,13*8);\n\tencrypt_round(R0,R1,R2,R3,14*8);\n\tencrypt_last_round(R2,R3,R0,R1,15*8);\n\n\toutput_whitening(%eax,%ebp,c_offset)\n\toutput_whitening(%ebx,%ebp,d_offset)\n\toutput_whitening(%ecx,%ebp,a_offset)\n\toutput_whitening(%edx,%ebp,b_offset)\n\tmov\tout_blk+16(%esp),%edi;\n\tmov\t%eax,\t\tc_offset(%edi)\n\tmov\t%ebx,\t\td_offset(%edi)\n\tmov\t%ecx,\t\t(%edi)\n\tmov\t%edx,\t\tb_offset(%edi)\n\n\tpop\t%edi\n\tpop\t%esi\n\tpop\t%ebx\n\tpop\t%ebp\n\tmov\t$1,\t%eax\n\tRET\nSYM_FUNC_END(twofish_enc_blk)\n\nSYM_FUNC_START(twofish_dec_blk)\n\tpush\t%ebp\t\t\t \n\tpush    %ebx\n\tpush    %esi\n\tpush    %edi\n\n\n\tmov\tctx + 16(%esp),\t%ebp\t \n\tmov     in_blk+16(%esp),%edi\t \n\n\tmov\t(%edi),\t\t%eax\n\tmov\tb_offset(%edi),\t%ebx\n\tmov\tc_offset(%edi),\t%ecx\n\tmov\td_offset(%edi),\t%edx\n\toutput_whitening(%eax,%ebp,a_offset)\n\toutput_whitening(%ebx,%ebp,b_offset)\n\tror\t$16,\t%ebx\n\toutput_whitening(%ecx,%ebp,c_offset)\n\toutput_whitening(%edx,%ebp,d_offset)\n\trol\t$1,\t%ecx\n\n\tdecrypt_round(R0,R1,R2,R3,15*8);\n\tdecrypt_round(R2,R3,R0,R1,14*8);\n\tdecrypt_round(R0,R1,R2,R3,13*8);\n\tdecrypt_round(R2,R3,R0,R1,12*8);\n\tdecrypt_round(R0,R1,R2,R3,11*8);\n\tdecrypt_round(R2,R3,R0,R1,10*8);\n\tdecrypt_round(R0,R1,R2,R3,9*8);\n\tdecrypt_round(R2,R3,R0,R1,8*8);\n\tdecrypt_round(R0,R1,R2,R3,7*8);\n\tdecrypt_round(R2,R3,R0,R1,6*8);\n\tdecrypt_round(R0,R1,R2,R3,5*8);\n\tdecrypt_round(R2,R3,R0,R1,4*8);\n\tdecrypt_round(R0,R1,R2,R3,3*8);\n\tdecrypt_round(R2,R3,R0,R1,2*8);\n\tdecrypt_round(R0,R1,R2,R3,1*8);\n\tdecrypt_last_round(R2,R3,R0,R1,0);\n\n\tinput_whitening(%eax,%ebp,c_offset)\n\tinput_whitening(%ebx,%ebp,d_offset)\n\tinput_whitening(%ecx,%ebp,a_offset)\n\tinput_whitening(%edx,%ebp,b_offset)\n\tmov\tout_blk+16(%esp),%edi;\n\tmov\t%eax,\t\tc_offset(%edi)\n\tmov\t%ebx,\t\td_offset(%edi)\n\tmov\t%ecx,\t\t(%edi)\n\tmov\t%edx,\t\tb_offset(%edi)\n\n\tpop\t%edi\n\tpop\t%esi\n\tpop\t%ebx\n\tpop\t%ebp\n\tmov\t$1,\t%eax\n\tRET\nSYM_FUNC_END(twofish_dec_blk)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}