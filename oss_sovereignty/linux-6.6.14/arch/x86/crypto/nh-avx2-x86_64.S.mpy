{
  "module_name": "nh-avx2-x86_64.S",
  "hash_id": "8acc746ac136363017412e3267f9b32472d1365b8334d8f3f3d7794d75471c1c",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/nh-avx2-x86_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <linux/cfi_types.h>\n\n#define\t\tPASS0_SUMS\t%ymm0\n#define\t\tPASS1_SUMS\t%ymm1\n#define\t\tPASS2_SUMS\t%ymm2\n#define\t\tPASS3_SUMS\t%ymm3\n#define\t\tK0\t\t%ymm4\n#define\t\tK0_XMM\t\t%xmm4\n#define\t\tK1\t\t%ymm5\n#define\t\tK1_XMM\t\t%xmm5\n#define\t\tK2\t\t%ymm6\n#define\t\tK2_XMM\t\t%xmm6\n#define\t\tK3\t\t%ymm7\n#define\t\tK3_XMM\t\t%xmm7\n#define\t\tT0\t\t%ymm8\n#define\t\tT1\t\t%ymm9\n#define\t\tT2\t\t%ymm10\n#define\t\tT2_XMM\t\t%xmm10\n#define\t\tT3\t\t%ymm11\n#define\t\tT3_XMM\t\t%xmm11\n#define\t\tT4\t\t%ymm12\n#define\t\tT5\t\t%ymm13\n#define\t\tT6\t\t%ymm14\n#define\t\tT7\t\t%ymm15\n#define\t\tKEY\t\t%rdi\n#define\t\tMESSAGE\t\t%rsi\n#define\t\tMESSAGE_LEN\t%rdx\n#define\t\tHASH\t\t%rcx\n\n.macro _nh_2xstride\tk0, k1, k2, k3\n\n\t \n\tvpaddd\t\t\\k0, T3, T0\n\tvpaddd\t\t\\k1, T3, T1\n\tvpaddd\t\t\\k2, T3, T2\n\tvpaddd\t\t\\k3, T3, T3\n\n\t \n\tvpshufd\t\t$0x10, T0, T4\n\tvpshufd\t\t$0x32, T0, T0\n\tvpshufd\t\t$0x10, T1, T5\n\tvpshufd\t\t$0x32, T1, T1\n\tvpshufd\t\t$0x10, T2, T6\n\tvpshufd\t\t$0x32, T2, T2\n\tvpshufd\t\t$0x10, T3, T7\n\tvpshufd\t\t$0x32, T3, T3\n\tvpmuludq\tT4, T0, T0\n\tvpmuludq\tT5, T1, T1\n\tvpmuludq\tT6, T2, T2\n\tvpmuludq\tT7, T3, T3\n\tvpaddq\t\tT0, PASS0_SUMS, PASS0_SUMS\n\tvpaddq\t\tT1, PASS1_SUMS, PASS1_SUMS\n\tvpaddq\t\tT2, PASS2_SUMS, PASS2_SUMS\n\tvpaddq\t\tT3, PASS3_SUMS, PASS3_SUMS\n.endm\n\n \nSYM_TYPED_FUNC_START(nh_avx2)\n\n\tvmovdqu\t\t0x00(KEY), K0\n\tvmovdqu\t\t0x10(KEY), K1\n\tadd\t\t$0x20, KEY\n\tvpxor\t\tPASS0_SUMS, PASS0_SUMS, PASS0_SUMS\n\tvpxor\t\tPASS1_SUMS, PASS1_SUMS, PASS1_SUMS\n\tvpxor\t\tPASS2_SUMS, PASS2_SUMS, PASS2_SUMS\n\tvpxor\t\tPASS3_SUMS, PASS3_SUMS, PASS3_SUMS\n\n\tsub\t\t$0x40, MESSAGE_LEN\n\tjl\t\t.Lloop4_done\n.Lloop4:\n\tvmovdqu\t\t(MESSAGE), T3\n\tvmovdqu\t\t0x00(KEY), K2\n\tvmovdqu\t\t0x10(KEY), K3\n\t_nh_2xstride\tK0, K1, K2, K3\n\n\tvmovdqu\t\t0x20(MESSAGE), T3\n\tvmovdqu\t\t0x20(KEY), K0\n\tvmovdqu\t\t0x30(KEY), K1\n\t_nh_2xstride\tK2, K3, K0, K1\n\n\tadd\t\t$0x40, MESSAGE\n\tadd\t\t$0x40, KEY\n\tsub\t\t$0x40, MESSAGE_LEN\n\tjge\t\t.Lloop4\n\n.Lloop4_done:\n\tand\t\t$0x3f, MESSAGE_LEN\n\tjz\t\t.Ldone\n\n\tcmp\t\t$0x20, MESSAGE_LEN\n\tjl\t\t.Llast\n\n\t \n\tvmovdqu\t\t(MESSAGE), T3\n\tvmovdqu\t\t0x00(KEY), K2\n\tvmovdqu\t\t0x10(KEY), K3\n\t_nh_2xstride\tK0, K1, K2, K3\n\tadd\t\t$0x20, MESSAGE\n\tadd\t\t$0x20, KEY\n\tsub\t\t$0x20, MESSAGE_LEN\n\tjz\t\t.Ldone\n\tvmovdqa\t\tK2, K0\n\tvmovdqa\t\tK3, K1\n.Llast:\n\t \n\t \n\tvmovdqu\t\t(MESSAGE), T3_XMM\n\tvmovdqa\t\tK0_XMM, K0_XMM\n\tvmovdqa\t\tK1_XMM, K1_XMM\n\tvmovdqu\t\t0x00(KEY), K2_XMM\n\tvmovdqu\t\t0x10(KEY), K3_XMM\n\t_nh_2xstride\tK0, K1, K2, K3\n\n.Ldone:\n\t \n\n\t \n\t \n\t \n\t \n\t \n\t \n\t \n\t \n\t \n\t \n\n\tvpunpcklqdq\tPASS1_SUMS, PASS0_SUMS, T0\t \n\tvpunpckhqdq\tPASS1_SUMS, PASS0_SUMS, T1\t \n\tvpunpcklqdq\tPASS3_SUMS, PASS2_SUMS, T2\t \n\tvpunpckhqdq\tPASS3_SUMS, PASS2_SUMS, T3\t \n\n\tvinserti128\t$0x1, T2_XMM, T0, T4\t\t \n\tvinserti128\t$0x1, T3_XMM, T1, T5\t\t \n\tvperm2i128\t$0x31, T2, T0, T0\t\t \n\tvperm2i128\t$0x31, T3, T1, T1\t\t \n\n\tvpaddq\t\tT5, T4, T4\n\tvpaddq\t\tT1, T0, T0\n\tvpaddq\t\tT4, T0, T0\n\tvmovdqu\t\tT0, (HASH)\n\tRET\nSYM_FUNC_END(nh_avx2)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}