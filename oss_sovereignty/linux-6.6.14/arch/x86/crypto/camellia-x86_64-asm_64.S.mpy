{
  "module_name": "camellia-x86_64-asm_64.S",
  "hash_id": "e98c29a28b7913bd484ab620b9c8df9b15d5e9b171751c99eabc02d7faeed5b8",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/camellia-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n\n.file \"camellia-x86_64-asm_64.S\"\n.text\n\n.extern camellia_sp10011110;\n.extern camellia_sp22000222;\n.extern camellia_sp03303033;\n.extern camellia_sp00444404;\n.extern camellia_sp02220222;\n.extern camellia_sp30333033;\n.extern camellia_sp44044404;\n.extern camellia_sp11101110;\n\n#define sp10011110 camellia_sp10011110\n#define sp22000222 camellia_sp22000222\n#define sp03303033 camellia_sp03303033\n#define sp00444404 camellia_sp00444404\n#define sp02220222 camellia_sp02220222\n#define sp30333033 camellia_sp30333033\n#define sp44044404 camellia_sp44044404\n#define sp11101110 camellia_sp11101110\n\n#define CAMELLIA_TABLE_BYTE_LEN 272\n\n \n#define key_table 0\n#define key_length CAMELLIA_TABLE_BYTE_LEN\n\n \n#define CTX %rdi\n#define RIO %rsi\n#define RIOd %esi\n\n#define RAB0 %rax\n#define RCD0 %rcx\n#define RAB1 %rbx\n#define RCD1 %rdx\n\n#define RAB0d %eax\n#define RCD0d %ecx\n#define RAB1d %ebx\n#define RCD1d %edx\n\n#define RAB0bl %al\n#define RCD0bl %cl\n#define RAB1bl %bl\n#define RCD1bl %dl\n\n#define RAB0bh %ah\n#define RCD0bh %ch\n#define RAB1bh %bh\n#define RCD1bh %dh\n\n#define RT0 %rsi\n#define RT1 %r12\n#define RT2 %r8\n\n#define RT0d %esi\n#define RT1d %r12d\n#define RT2d %r8d\n\n#define RT2bl %r8b\n\n#define RXOR %r9\n#define RR12 %r10\n#define RDST %r11\n\n#define RXORd %r9d\n#define RXORbl %r9b\n\n#define xor2ror16(T0, T1, tmp1, tmp2, ab, dst) \\\n\tleaq T0(%rip), \t\t\ttmp1; \\\n\tmovzbl ab ## bl,\t\ttmp2 ## d; \\\n\txorq (tmp1, tmp2, 8),\t\tdst; \\\n\tleaq T1(%rip), \t\t\ttmp2; \\\n\tmovzbl ab ## bh,\t\ttmp1 ## d; \\\n\trorq $16,\t\t\tab; \\\n\txorq (tmp2, tmp1, 8),\t\tdst;\n\n \n#define roundsm(ab, subkey, cd) \\\n\tmovq (key_table + ((subkey) * 2) * 4)(CTX),\tRT2; \\\n\t\\\n\txor2ror16(sp00444404, sp03303033, RT0, RT1, ab ## 0, cd ## 0); \\\n\txor2ror16(sp22000222, sp10011110, RT0, RT1, ab ## 0, RT2); \\\n\txor2ror16(sp11101110, sp44044404, RT0, RT1, ab ## 0, cd ## 0); \\\n\txor2ror16(sp30333033, sp02220222, RT0, RT1, ab ## 0, RT2); \\\n\t\\\n\txorq RT2,\t\t\t\t\tcd ## 0;\n\n#define fls(l, r, kl, kr) \\\n\tmovl (key_table + ((kl) * 2) * 4)(CTX),\t\tRT0d; \\\n\tandl l ## 0d,\t\t\t\t\tRT0d; \\\n\troll $1,\t\t\t\t\tRT0d; \\\n\tshlq $32,\t\t\t\t\tRT0; \\\n\txorq RT0,\t\t\t\t\tl ## 0; \\\n\tmovq (key_table + ((kr) * 2) * 4)(CTX),\t\tRT1; \\\n\torq r ## 0,\t\t\t\t\tRT1; \\\n\tshrq $32,\t\t\t\t\tRT1; \\\n\txorq RT1,\t\t\t\t\tr ## 0; \\\n\t\\\n\tmovq (key_table + ((kl) * 2) * 4)(CTX),\t\tRT2; \\\n\torq l ## 0,\t\t\t\t\tRT2; \\\n\tshrq $32,\t\t\t\t\tRT2; \\\n\txorq RT2,\t\t\t\t\tl ## 0; \\\n\tmovl (key_table + ((kr) * 2) * 4)(CTX),\t\tRT0d; \\\n\tandl r ## 0d,\t\t\t\t\tRT0d; \\\n\troll $1,\t\t\t\t\tRT0d; \\\n\tshlq $32,\t\t\t\t\tRT0; \\\n\txorq RT0,\t\t\t\t\tr ## 0;\n\n#define enc_rounds(i) \\\n\troundsm(RAB, i + 2, RCD); \\\n\troundsm(RCD, i + 3, RAB); \\\n\troundsm(RAB, i + 4, RCD); \\\n\troundsm(RCD, i + 5, RAB); \\\n\troundsm(RAB, i + 6, RCD); \\\n\troundsm(RCD, i + 7, RAB);\n\n#define enc_fls(i) \\\n\tfls(RAB, RCD, i + 0, i + 1);\n\n#define enc_inpack() \\\n\tmovq (RIO),\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\trolq $32,\t\t\tRAB0; \\\n\tmovq 4*2(RIO),\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\trorq $32,\t\t\tRCD0; \\\n\txorq key_table(CTX),\t\tRAB0;\n\n#define enc_outunpack(op, max) \\\n\txorq key_table(CTX, max, 8),\tRCD0; \\\n\trorq $32,\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\top ## q RCD0,\t\t\t(RIO); \\\n\trolq $32,\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\top ## q RAB0,\t\t\t4*2(RIO);\n\n#define dec_rounds(i) \\\n\troundsm(RAB, i + 7, RCD); \\\n\troundsm(RCD, i + 6, RAB); \\\n\troundsm(RAB, i + 5, RCD); \\\n\troundsm(RCD, i + 4, RAB); \\\n\troundsm(RAB, i + 3, RCD); \\\n\troundsm(RCD, i + 2, RAB);\n\n#define dec_fls(i) \\\n\tfls(RAB, RCD, i + 1, i + 0);\n\n#define dec_inpack(max) \\\n\tmovq (RIO),\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\trolq $32,\t\t\tRAB0; \\\n\tmovq 4*2(RIO),\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\trorq $32,\t\t\tRCD0; \\\n\txorq key_table(CTX, max, 8),\tRAB0;\n\n#define dec_outunpack() \\\n\txorq key_table(CTX),\t\tRCD0; \\\n\trorq $32,\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\tmovq RCD0,\t\t\t(RIO); \\\n\trolq $32,\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\tmovq RAB0,\t\t\t4*2(RIO);\n\nSYM_FUNC_START(__camellia_enc_blk)\n\t \n\tmovq %r12, RR12;\n\n\tmovq %rcx, RXOR;\n\tmovq %rsi, RDST;\n\tmovq %rdx, RIO;\n\n\tenc_inpack();\n\n\tenc_rounds(0);\n\tenc_fls(8);\n\tenc_rounds(8);\n\tenc_fls(16);\n\tenc_rounds(16);\n\tmovl $24, RT1d;  \n\n\tcmpb $16, key_length(CTX);\n\tje .L__enc_done;\n\n\tenc_fls(24);\n\tenc_rounds(24);\n\tmovl $32, RT1d;  \n\n.L__enc_done:\n\ttestb RXORbl, RXORbl;\n\tmovq RDST, RIO;\n\n\tjnz .L__enc_xor;\n\n\tenc_outunpack(mov, RT1);\n\n\tmovq RR12, %r12;\n\tRET;\n\n.L__enc_xor:\n\tenc_outunpack(xor, RT1);\n\n\tmovq RR12, %r12;\n\tRET;\nSYM_FUNC_END(__camellia_enc_blk)\n\nSYM_FUNC_START(camellia_dec_blk)\n\t \n\tcmpl $16, key_length(CTX);\n\tmovl $32, RT2d;\n\tmovl $24, RXORd;\n\tcmovel RXORd, RT2d;  \n\n\tmovq %r12, RR12;\n\tmovq %rsi, RDST;\n\tmovq %rdx, RIO;\n\n\tdec_inpack(RT2);\n\n\tcmpb $24, RT2bl;\n\tje .L__dec_rounds16;\n\n\tdec_rounds(24);\n\tdec_fls(24);\n\n.L__dec_rounds16:\n\tdec_rounds(16);\n\tdec_fls(16);\n\tdec_rounds(8);\n\tdec_fls(8);\n\tdec_rounds(0);\n\n\tmovq RDST, RIO;\n\n\tdec_outunpack();\n\n\tmovq RR12, %r12;\n\tRET;\nSYM_FUNC_END(camellia_dec_blk)\n\n \n#define roundsm2(ab, subkey, cd) \\\n\tmovq (key_table + ((subkey) * 2) * 4)(CTX),\tRT2; \\\n\txorq RT2,\t\t\t\t\tcd ## 1; \\\n\t\\\n\txor2ror16(sp00444404, sp03303033, RT0, RT1, ab ## 0, cd ## 0); \\\n\txor2ror16(sp22000222, sp10011110, RT0, RT1, ab ## 0, RT2); \\\n\txor2ror16(sp11101110, sp44044404, RT0, RT1, ab ## 0, cd ## 0); \\\n\txor2ror16(sp30333033, sp02220222, RT0, RT1, ab ## 0, RT2); \\\n\t\\\n\t\txor2ror16(sp00444404, sp03303033, RT0, RT1, ab ## 1, cd ## 1); \\\n\t\txorq RT2,\t\t\t\t\tcd ## 0; \\\n\t\txor2ror16(sp22000222, sp10011110, RT0, RT1, ab ## 1, cd ## 1); \\\n\t\txor2ror16(sp11101110, sp44044404, RT0, RT1, ab ## 1, cd ## 1); \\\n\t\txor2ror16(sp30333033, sp02220222, RT0, RT1, ab ## 1, cd ## 1);\n\n#define fls2(l, r, kl, kr) \\\n\tmovl (key_table + ((kl) * 2) * 4)(CTX),\t\tRT0d; \\\n\tandl l ## 0d,\t\t\t\t\tRT0d; \\\n\troll $1,\t\t\t\t\tRT0d; \\\n\tshlq $32,\t\t\t\t\tRT0; \\\n\txorq RT0,\t\t\t\t\tl ## 0; \\\n\tmovq (key_table + ((kr) * 2) * 4)(CTX),\t\tRT1; \\\n\torq r ## 0,\t\t\t\t\tRT1; \\\n\tshrq $32,\t\t\t\t\tRT1; \\\n\txorq RT1,\t\t\t\t\tr ## 0; \\\n\t\\\n\t\tmovl (key_table + ((kl) * 2) * 4)(CTX),\t\tRT2d; \\\n\t\tandl l ## 1d,\t\t\t\t\tRT2d; \\\n\t\troll $1,\t\t\t\t\tRT2d; \\\n\t\tshlq $32,\t\t\t\t\tRT2; \\\n\t\txorq RT2,\t\t\t\t\tl ## 1; \\\n\t\tmovq (key_table + ((kr) * 2) * 4)(CTX),\t\tRT0; \\\n\t\torq r ## 1,\t\t\t\t\tRT0; \\\n\t\tshrq $32,\t\t\t\t\tRT0; \\\n\t\txorq RT0,\t\t\t\t\tr ## 1; \\\n\t\\\n\tmovq (key_table + ((kl) * 2) * 4)(CTX),\t\tRT1; \\\n\torq l ## 0,\t\t\t\t\tRT1; \\\n\tshrq $32,\t\t\t\t\tRT1; \\\n\txorq RT1,\t\t\t\t\tl ## 0; \\\n\tmovl (key_table + ((kr) * 2) * 4)(CTX),\t\tRT2d; \\\n\tandl r ## 0d,\t\t\t\t\tRT2d; \\\n\troll $1,\t\t\t\t\tRT2d; \\\n\tshlq $32,\t\t\t\t\tRT2; \\\n\txorq RT2,\t\t\t\t\tr ## 0; \\\n\t\\\n\t\tmovq (key_table + ((kl) * 2) * 4)(CTX),\t\tRT0; \\\n\t\torq l ## 1,\t\t\t\t\tRT0; \\\n\t\tshrq $32,\t\t\t\t\tRT0; \\\n\t\txorq RT0,\t\t\t\t\tl ## 1; \\\n\t\tmovl (key_table + ((kr) * 2) * 4)(CTX),\t\tRT1d; \\\n\t\tandl r ## 1d,\t\t\t\t\tRT1d; \\\n\t\troll $1,\t\t\t\t\tRT1d; \\\n\t\tshlq $32,\t\t\t\t\tRT1; \\\n\t\txorq RT1,\t\t\t\t\tr ## 1;\n\n#define enc_rounds2(i) \\\n\troundsm2(RAB, i + 2, RCD); \\\n\troundsm2(RCD, i + 3, RAB); \\\n\troundsm2(RAB, i + 4, RCD); \\\n\troundsm2(RCD, i + 5, RAB); \\\n\troundsm2(RAB, i + 6, RCD); \\\n\troundsm2(RCD, i + 7, RAB);\n\n#define enc_fls2(i) \\\n\tfls2(RAB, RCD, i + 0, i + 1);\n\n#define enc_inpack2() \\\n\tmovq (RIO),\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\trorq $32,\t\t\tRAB0; \\\n\tmovq 4*2(RIO),\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\trolq $32,\t\t\tRCD0; \\\n\txorq key_table(CTX),\t\tRAB0; \\\n\t\\\n\t\tmovq 8*2(RIO),\t\t\tRAB1; \\\n\t\tbswapq\t\t\t\tRAB1; \\\n\t\trorq $32,\t\t\tRAB1; \\\n\t\tmovq 12*2(RIO),\t\t\tRCD1; \\\n\t\tbswapq\t\t\t\tRCD1; \\\n\t\trolq $32,\t\t\tRCD1; \\\n\t\txorq key_table(CTX),\t\tRAB1;\n\n#define enc_outunpack2(op, max) \\\n\txorq key_table(CTX, max, 8),\tRCD0; \\\n\trolq $32,\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\top ## q RCD0,\t\t\t(RIO); \\\n\trorq $32,\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\top ## q RAB0,\t\t\t4*2(RIO); \\\n\t\\\n\t\txorq key_table(CTX, max, 8),\tRCD1; \\\n\t\trolq $32,\t\t\tRCD1; \\\n\t\tbswapq\t\t\t\tRCD1; \\\n\t\top ## q RCD1,\t\t\t8*2(RIO); \\\n\t\trorq $32,\t\t\tRAB1; \\\n\t\tbswapq\t\t\t\tRAB1; \\\n\t\top ## q RAB1,\t\t\t12*2(RIO);\n\n#define dec_rounds2(i) \\\n\troundsm2(RAB, i + 7, RCD); \\\n\troundsm2(RCD, i + 6, RAB); \\\n\troundsm2(RAB, i + 5, RCD); \\\n\troundsm2(RCD, i + 4, RAB); \\\n\troundsm2(RAB, i + 3, RCD); \\\n\troundsm2(RCD, i + 2, RAB);\n\n#define dec_fls2(i) \\\n\tfls2(RAB, RCD, i + 1, i + 0);\n\n#define dec_inpack2(max) \\\n\tmovq (RIO),\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\trorq $32,\t\t\tRAB0; \\\n\tmovq 4*2(RIO),\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\trolq $32,\t\t\tRCD0; \\\n\txorq key_table(CTX, max, 8),\tRAB0; \\\n\t\\\n\t\tmovq 8*2(RIO),\t\t\tRAB1; \\\n\t\tbswapq\t\t\t\tRAB1; \\\n\t\trorq $32,\t\t\tRAB1; \\\n\t\tmovq 12*2(RIO),\t\t\tRCD1; \\\n\t\tbswapq\t\t\t\tRCD1; \\\n\t\trolq $32,\t\t\tRCD1; \\\n\t\txorq key_table(CTX, max, 8),\tRAB1;\n\n#define dec_outunpack2() \\\n\txorq key_table(CTX),\t\tRCD0; \\\n\trolq $32,\t\t\tRCD0; \\\n\tbswapq\t\t\t\tRCD0; \\\n\tmovq RCD0,\t\t\t(RIO); \\\n\trorq $32,\t\t\tRAB0; \\\n\tbswapq\t\t\t\tRAB0; \\\n\tmovq RAB0,\t\t\t4*2(RIO); \\\n\t\\\n\t\txorq key_table(CTX),\t\tRCD1; \\\n\t\trolq $32,\t\t\tRCD1; \\\n\t\tbswapq\t\t\t\tRCD1; \\\n\t\tmovq RCD1,\t\t\t8*2(RIO); \\\n\t\trorq $32,\t\t\tRAB1; \\\n\t\tbswapq\t\t\t\tRAB1; \\\n\t\tmovq RAB1,\t\t\t12*2(RIO);\n\nSYM_FUNC_START(__camellia_enc_blk_2way)\n\t \n\tpushq %rbx;\n\n\tmovq %r12, RR12;\n\tmovq %rcx, RXOR;\n\tmovq %rsi, RDST;\n\tmovq %rdx, RIO;\n\n\tenc_inpack2();\n\n\tenc_rounds2(0);\n\tenc_fls2(8);\n\tenc_rounds2(8);\n\tenc_fls2(16);\n\tenc_rounds2(16);\n\tmovl $24, RT2d;  \n\n\tcmpb $16, key_length(CTX);\n\tje .L__enc2_done;\n\n\tenc_fls2(24);\n\tenc_rounds2(24);\n\tmovl $32, RT2d;  \n\n.L__enc2_done:\n\ttest RXORbl, RXORbl;\n\tmovq RDST, RIO;\n\tjnz .L__enc2_xor;\n\n\tenc_outunpack2(mov, RT2);\n\n\tmovq RR12, %r12;\n\tpopq %rbx;\n\tRET;\n\n.L__enc2_xor:\n\tenc_outunpack2(xor, RT2);\n\n\tmovq RR12, %r12;\n\tpopq %rbx;\n\tRET;\nSYM_FUNC_END(__camellia_enc_blk_2way)\n\nSYM_FUNC_START(camellia_dec_blk_2way)\n\t \n\tcmpl $16, key_length(CTX);\n\tmovl $32, RT2d;\n\tmovl $24, RXORd;\n\tcmovel RXORd, RT2d;  \n\n\tmovq %rbx, RXOR;\n\tmovq %r12, RR12;\n\tmovq %rsi, RDST;\n\tmovq %rdx, RIO;\n\n\tdec_inpack2(RT2);\n\n\tcmpb $24, RT2bl;\n\tje .L__dec2_rounds16;\n\n\tdec_rounds2(24);\n\tdec_fls2(24);\n\n.L__dec2_rounds16:\n\tdec_rounds2(16);\n\tdec_fls2(16);\n\tdec_rounds2(8);\n\tdec_fls2(8);\n\tdec_rounds2(0);\n\n\tmovq RDST, RIO;\n\n\tdec_outunpack2();\n\n\tmovq RR12, %r12;\n\tmovq RXOR, %rbx;\n\tRET;\nSYM_FUNC_END(camellia_dec_blk_2way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}