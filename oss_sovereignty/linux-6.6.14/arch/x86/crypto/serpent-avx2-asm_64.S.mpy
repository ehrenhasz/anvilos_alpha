{
  "module_name": "serpent-avx2-asm_64.S",
  "hash_id": "e43014b3aa93000c8af53f3ac05c3bab88d5093c80cd38556c52559b4ccc557a",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/serpent-avx2-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/frame.h>\n#include \"glue_helper-asm-avx2.S\"\n\n.file \"serpent-avx2-asm_64.S\"\n\n.section\t.rodata.cst16.bswap128_mask, \"aM\", @progbits, 16\n.align 16\n.Lbswap128_mask:\n\t.byte 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0\n\n.text\n\n#define CTX %rdi\n\n#define RNOT %ymm0\n#define tp  %ymm1\n\n#define RA1 %ymm2\n#define RA2 %ymm3\n#define RB1 %ymm4\n#define RB2 %ymm5\n#define RC1 %ymm6\n#define RC2 %ymm7\n#define RD1 %ymm8\n#define RD2 %ymm9\n#define RE1 %ymm10\n#define RE2 %ymm11\n\n#define RK0 %ymm12\n#define RK1 %ymm13\n#define RK2 %ymm14\n#define RK3 %ymm15\n\n#define RK0x %xmm12\n#define RK1x %xmm13\n#define RK2x %xmm14\n#define RK3x %xmm15\n\n#define S0_1(x0, x1, x2, x3, x4)      \\\n\tvpor\t\tx0,   x3, tp; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpxor\t\tx2,   x3, x4; \\\n\tvpxor\t\tRNOT, x4, x4; \\\n\tvpxor\t\tx1,   tp, x3; \\\n\tvpand\t\tx0,   x1, x1; \\\n\tvpxor\t\tx4,   x1, x1; \\\n\tvpxor\t\tx0,   x2, x2;\n#define S0_2(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpor\t\tx0,   x4, x4; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpand\t\tx1,   x2, x2; \\\n\tvpxor\t\tx2,   x3, x3; \\\n\tvpxor\t\tRNOT, x1, x1; \\\n\tvpxor\t\tx4,   x2, x2; \\\n\tvpxor\t\tx2,   x1, x1;\n\n#define S1_1(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx0,   x1, tp; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpxor\t\tRNOT, x3, x3; \\\n\tvpand\t\ttp,   x1, x4; \\\n\tvpor\t\ttp,   x0, x0; \\\n\tvpxor\t\tx2,   x3, x3; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpxor\t\tx3,   tp, x1;\n#define S1_2(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpor\t\tx4,   x1, x1; \\\n\tvpxor\t\tx2,   x4, x4; \\\n\tvpand\t\tx0,   x2, x2; \\\n\tvpxor\t\tx1,   x2, x2; \\\n\tvpor\t\tx0,   x1, x1; \\\n\tvpxor\t\tRNOT, x0, x0; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpxor\t\tx1,   x4, x4;\n\n#define S2_1(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tRNOT, x3, x3; \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpand\t\tx2,   x0, tp; \\\n\tvpxor\t\tx3,   tp, tp; \\\n\tvpor\t\tx0,   x3, x3; \\\n\tvpxor\t\tx1,   x2, x2; \\\n\tvpxor\t\tx1,   x3, x3; \\\n\tvpand\t\ttp,   x1, x1;\n#define S2_2(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx2,   tp, tp; \\\n\tvpand\t\tx3,   x2, x2; \\\n\tvpor\t\tx1,   x3, x3; \\\n\tvpxor\t\tRNOT, tp, tp; \\\n\tvpxor\t\ttp,   x3, x3; \\\n\tvpxor\t\ttp,   x0, x4; \\\n\tvpxor\t\tx2,   tp, x0; \\\n\tvpor\t\tx2,   x1, x1;\n\n#define S3_1(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx3,   x1, tp; \\\n\tvpor\t\tx0,   x3, x3; \\\n\tvpand\t\tx0,   x1, x4; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpxor\t\ttp,   x2, x2; \\\n\tvpand\t\tx3,   tp, x1; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpor\t\tx4,   x0, x0; \\\n\tvpxor\t\tx3,   x4, x4;\n#define S3_2(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpand\t\tx3,   x0, x0; \\\n\tvpand\t\tx4,   x3, x3; \\\n\tvpxor\t\tx2,   x3, x3; \\\n\tvpor\t\tx1,   x4, x4; \\\n\tvpand\t\tx1,   x2, x2; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpxor\t\tx2,   x3, x3;\n\n#define S4_1(x0, x1, x2, x3, x4)      \\\n\tvpand\t\tx0,   x3, tp; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpxor\t\tx2,   tp, tp; \\\n\tvpor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx1,   x0, x0; \\\n\tvpxor\t\ttp,   x3, x4; \\\n\tvpor\t\tx0,   x2, x2; \\\n\tvpxor\t\tx1,   x2, x2;\n#define S4_2(x0, x1, x2, x3, x4)      \\\n\tvpand\t\tx0,   x1, x1; \\\n\tvpxor\t\tx4,   x1, x1; \\\n\tvpand\t\tx2,   x4, x4; \\\n\tvpxor\t\ttp,   x2, x2; \\\n\tvpxor\t\tx0,   x4, x4; \\\n\tvpor\t\tx1,   tp, x3; \\\n\tvpxor\t\tRNOT, x1, x1; \\\n\tvpxor\t\tx0,   x3, x3;\n\n#define S5_1(x0, x1, x2, x3, x4)      \\\n\tvpor\t\tx0,   x1, tp; \\\n\tvpxor\t\ttp,   x2, x2; \\\n\tvpxor\t\tRNOT, x3, x3; \\\n\tvpxor\t\tx0,   x1, x4; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpand\t\tx4,   tp, x1; \\\n\tvpor\t\tx3,   x4, x4; \\\n\tvpxor\t\tx0,   x4, x4;\n#define S5_2(x0, x1, x2, x3, x4)      \\\n\tvpand\t\tx3,   x0, x0; \\\n\tvpxor\t\tx3,   x1, x1; \\\n\tvpxor\t\tx2,   x3, x3; \\\n\tvpxor\t\tx1,   x0, x0; \\\n\tvpand\t\tx4,   x2, x2; \\\n\tvpxor\t\tx2,   x1, x1; \\\n\tvpand\t\tx0,   x2, x2; \\\n\tvpxor\t\tx2,   x3, x3;\n\n#define S6_1(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx0,   x3, x3; \\\n\tvpxor\t\tx2,   x1, tp; \\\n\tvpxor\t\tx0,   x2, x2; \\\n\tvpand\t\tx3,   x0, x0; \\\n\tvpor\t\tx3,   tp, tp; \\\n\tvpxor\t\tRNOT, x1, x4; \\\n\tvpxor\t\ttp,   x0, x0; \\\n\tvpxor\t\tx2,   tp, x1;\n#define S6_2(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpxor\t\tx0,   x4, x4; \\\n\tvpand\t\tx0,   x2, x2; \\\n\tvpxor\t\tx1,   x4, x4; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpand\t\tx1,   x3, x3; \\\n\tvpxor\t\tx0,   x3, x3; \\\n\tvpxor\t\tx2,   x1, x1;\n\n#define S7_1(x0, x1, x2, x3, x4)      \\\n\tvpxor\t\tRNOT, x1, tp; \\\n\tvpxor\t\tRNOT, x0, x0; \\\n\tvpand\t\tx2,   tp, x1; \\\n\tvpxor\t\tx3,   x1, x1; \\\n\tvpor\t\ttp,   x3, x3; \\\n\tvpxor\t\tx2,   tp, x4; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx0,   x3, x3; \\\n\tvpor\t\tx1,   x0, x0;\n#define S7_2(x0, x1, x2, x3, x4)      \\\n\tvpand\t\tx0,   x2, x2; \\\n\tvpxor\t\tx4,   x0, x0; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpand\t\tx0,   x3, x3; \\\n\tvpxor\t\tx1,   x4, x4; \\\n\tvpxor\t\tx4,   x2, x2; \\\n\tvpxor\t\tx1,   x3, x3; \\\n\tvpor\t\tx0,   x4, x4; \\\n\tvpxor\t\tx1,   x4, x4;\n\n#define SI0_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpor\t\tx1,   x3, tp; \\\n\tvpxor\t\tx1,   x3, x4; \\\n\tvpxor\t\tRNOT, x0, x0; \\\n\tvpxor\t\ttp,   x2, x2; \\\n\tvpxor\t\tx0,   tp, x3; \\\n\tvpand\t\tx1,   x0, x0; \\\n\tvpxor\t\tx2,   x0, x0;\n#define SI0_2(x0, x1, x2, x3, x4)     \\\n\tvpand\t\tx3,   x2, x2; \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx3,   x1, x1; \\\n\tvpand\t\tx0,   x3, x3; \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpxor\t\tx3,   x4, x4;\n\n#define SI1_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx3,   x1, x1; \\\n\tvpxor\t\tx2,   x0, tp; \\\n\tvpxor\t\tRNOT, x2, x2; \\\n\tvpor\t\tx1,   x0, x4; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpand\t\tx1,   x3, x3; \\\n\tvpxor\t\tx2,   x1, x1; \\\n\tvpand\t\tx4,   x2, x2;\n#define SI1_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx1,   x4, x4; \\\n\tvpor\t\tx3,   x1, x1; \\\n\tvpxor\t\ttp,   x3, x3; \\\n\tvpxor\t\ttp,   x2, x2; \\\n\tvpor\t\tx4,   tp, x0; \\\n\tvpxor\t\tx4,   x2, x2; \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpxor\t\tx1,   x4, x4;\n\n#define SI2_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx1,   x2, x2; \\\n\tvpxor\t\tRNOT, x3, tp; \\\n\tvpor\t\tx2,   tp, tp; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx0,   x3, x4; \\\n\tvpxor\t\tx1,   tp, x3; \\\n\tvpor\t\tx2,   x1, x1; \\\n\tvpxor\t\tx0,   x2, x2;\n#define SI2_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx4,   x1, x1; \\\n\tvpor\t\tx3,   x4, x4; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx2,   x4, x4; \\\n\tvpand\t\tx1,   x2, x2; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpxor\t\tx0,   x4, x4;\n\n#define SI3_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx1,   x2, x2; \\\n\tvpand\t\tx2,   x1, tp; \\\n\tvpxor\t\tx0,   tp, tp; \\\n\tvpor\t\tx1,   x0, x0; \\\n\tvpxor\t\tx3,   x1, x4; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpor\t\ttp,   x3, x3; \\\n\tvpxor\t\tx2,   tp, x1;\n#define SI3_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx3,   x1, x1; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpand\t\tx1,   x3, x3; \\\n\tvpxor\t\tx0,   x1, x1; \\\n\tvpand\t\tx2,   x0, x0; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpxor\t\tx0,   x3, x3; \\\n\tvpxor\t\tx1,   x0, x0;\n\n#define SI4_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpand\t\tx1,   x0, tp; \\\n\tvpxor\t\tx2,   tp, tp; \\\n\tvpor\t\tx3,   x2, x2; \\\n\tvpxor\t\tRNOT, x0, x4; \\\n\tvpxor\t\ttp,   x1, x1; \\\n\tvpxor\t\tx2,   tp, x0; \\\n\tvpand\t\tx4,   x2, x2;\n#define SI4_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx0,   x2, x2; \\\n\tvpor\t\tx4,   x0, x0; \\\n\tvpxor\t\tx3,   x0, x0; \\\n\tvpand\t\tx2,   x3, x3; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpxor\t\tx1,   x3, x3; \\\n\tvpand\t\tx0,   x1, x1; \\\n\tvpxor\t\tx1,   x4, x4; \\\n\tvpxor\t\tx3,   x0, x0;\n\n#define SI5_1(x0, x1, x2, x3, x4)     \\\n\tvpor\t\tx2,   x1, tp; \\\n\tvpxor\t\tx1,   x2, x2; \\\n\tvpxor\t\tx3,   tp, tp; \\\n\tvpand\t\tx1,   x3, x3; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpor\t\tx0,   x3, x3; \\\n\tvpxor\t\tRNOT, x0, x0; \\\n\tvpxor\t\tx2,   x3, x3; \\\n\tvpor\t\tx0,   x2, x2;\n#define SI5_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\ttp,   x1, x4; \\\n\tvpxor\t\tx4,   x2, x2; \\\n\tvpand\t\tx0,   x4, x4; \\\n\tvpxor\t\ttp,   x0, x0; \\\n\tvpxor\t\tx3,   tp, x1; \\\n\tvpand\t\tx2,   x0, x0; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpxor\t\tx4,   x2, x2; \\\n\tvpxor\t\tx3,   x4, x4;\n\n#define SI6_1(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpand\t\tx3,   x0, tp; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx2,   tp, tp; \\\n\tvpxor\t\tx1,   x3, x3; \\\n\tvpor\t\tx0,   x2, x2; \\\n\tvpxor\t\tx3,   x2, x2; \\\n\tvpand\t\ttp,   x3, x3;\n#define SI6_2(x0, x1, x2, x3, x4)     \\\n\tvpxor\t\tRNOT, tp, tp; \\\n\tvpxor\t\tx1,   x3, x3; \\\n\tvpand\t\tx2,   x1, x1; \\\n\tvpxor\t\ttp,   x0, x4; \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpxor\t\tx2,   x4, x4; \\\n\tvpxor\t\tx1,   tp, x0; \\\n\tvpxor\t\tx0,   x2, x2;\n\n#define SI7_1(x0, x1, x2, x3, x4)     \\\n\tvpand\t\tx0,   x3, tp; \\\n\tvpxor\t\tx2,   x0, x0; \\\n\tvpor\t\tx3,   x2, x2; \\\n\tvpxor\t\tx1,   x3, x4; \\\n\tvpxor\t\tRNOT, x0, x0; \\\n\tvpor\t\ttp,   x1, x1; \\\n\tvpxor\t\tx0,   x4, x4; \\\n\tvpand\t\tx2,   x0, x0; \\\n\tvpxor\t\tx1,   x0, x0;\n#define SI7_2(x0, x1, x2, x3, x4)     \\\n\tvpand\t\tx2,   x1, x1; \\\n\tvpxor\t\tx2,   tp, x3; \\\n\tvpxor\t\tx3,   x4, x4; \\\n\tvpand\t\tx3,   x2, x2; \\\n\tvpor\t\tx0,   x3, x3; \\\n\tvpxor\t\tx4,   x1, x1; \\\n\tvpxor\t\tx4,   x3, x3; \\\n\tvpand\t\tx0,   x4, x4; \\\n\tvpxor\t\tx2,   x4, x4;\n\n#define get_key(i,j,t) \\\n\tvpbroadcastd (4*(i)+(j))*4(CTX), t;\n\n#define K2(x0, x1, x2, x3, x4, i) \\\n\tget_key(i, 0, RK0); \\\n\tget_key(i, 1, RK1); \\\n\tget_key(i, 2, RK2); \\\n\tget_key(i, 3, RK3); \\\n\tvpxor RK0,\tx0 ## 1, x0 ## 1; \\\n\tvpxor RK1,\tx1 ## 1, x1 ## 1; \\\n\tvpxor RK2,\tx2 ## 1, x2 ## 1; \\\n\tvpxor RK3,\tx3 ## 1, x3 ## 1; \\\n\t\tvpxor RK0,\tx0 ## 2, x0 ## 2; \\\n\t\tvpxor RK1,\tx1 ## 2, x1 ## 2; \\\n\t\tvpxor RK2,\tx2 ## 2, x2 ## 2; \\\n\t\tvpxor RK3,\tx3 ## 2, x3 ## 2;\n\n#define LK2(x0, x1, x2, x3, x4, i) \\\n\tvpslld $13,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 13),\tx0 ## 1, x0 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tx0 ## 1, x1 ## 1, x1 ## 1; \\\n\tvpslld $3,\t\tx2 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 3),\tx2 ## 1, x2 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\tvpxor\t\t\tx2 ## 1, x1 ## 1, x1 ## 1; \\\n\t\tvpslld $13,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 13),\tx0 ## 2, x0 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tx0 ## 2, x1 ## 2, x1 ## 2; \\\n\t\tvpslld $3,\t\tx2 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 3),\tx2 ## 2, x2 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tvpxor\t\t\tx2 ## 2, x1 ## 2, x1 ## 2; \\\n\tvpslld $1,\t\tx1 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 1),\tx1 ## 1, x1 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x1 ## 1, x1 ## 1; \\\n\tvpslld $3,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpxor\t\t\tx2 ## 1, x3 ## 1, x3 ## 1; \\\n\tvpxor\t\t\tx4 ## 1, x3 ## 1, x3 ## 1; \\\n\tget_key(i, 1, RK1); \\\n\t\tvpslld $1,\t\tx1 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 1),\tx1 ## 2, x1 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x1 ## 2, x1 ## 2; \\\n\t\tvpslld $3,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpxor\t\t\tx2 ## 2, x3 ## 2, x3 ## 2; \\\n\t\tvpxor\t\t\tx4 ## 2, x3 ## 2, x3 ## 2; \\\n\t\tget_key(i, 3, RK3); \\\n\tvpslld $7,\t\tx3 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 7),\tx3 ## 1, x3 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x3 ## 1, x3 ## 1; \\\n\tvpslld $7,\t\tx1 ## 1, x4 ## 1;          \\\n\tvpxor\t\t\tx1 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tx3 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tx3 ## 1, x2 ## 1, x2 ## 1; \\\n\tvpxor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\tget_key(i, 0, RK0); \\\n\t\tvpslld $7,\t\tx3 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 7),\tx3 ## 2, x3 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x3 ## 2, x3 ## 2; \\\n\t\tvpslld $7,\t\tx1 ## 2, x4 ## 2;          \\\n\t\tvpxor\t\t\tx1 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tx3 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tx3 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tvpxor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tget_key(i, 2, RK2); \\\n\tvpxor\t\t\tRK1, x1 ## 1, x1 ## 1;     \\\n\tvpxor\t\t\tRK3, x3 ## 1, x3 ## 1;     \\\n\tvpslld $5,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 5),\tx0 ## 1, x0 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpslld $22,\t\tx2 ## 1, x4 ## 1;          \\\n\tvpsrld $(32 - 22),\tx2 ## 1, x2 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\tvpxor\t\t\tRK0, x0 ## 1, x0 ## 1;     \\\n\tvpxor\t\t\tRK2, x2 ## 1, x2 ## 1;     \\\n\t\tvpxor\t\t\tRK1, x1 ## 2, x1 ## 2;     \\\n\t\tvpxor\t\t\tRK3, x3 ## 2, x3 ## 2;     \\\n\t\tvpslld $5,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 5),\tx0 ## 2, x0 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpslld $22,\t\tx2 ## 2, x4 ## 2;          \\\n\t\tvpsrld $(32 - 22),\tx2 ## 2, x2 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tvpxor\t\t\tRK0, x0 ## 2, x0 ## 2;     \\\n\t\tvpxor\t\t\tRK2, x2 ## 2, x2 ## 2;\n\n#define KL2(x0, x1, x2, x3, x4, i) \\\n\tvpxor\t\t\tRK0, x0 ## 1, x0 ## 1;     \\\n\tvpxor\t\t\tRK2, x2 ## 1, x2 ## 1;     \\\n\tvpsrld $5,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 5),\tx0 ## 1, x0 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tRK3, x3 ## 1, x3 ## 1;     \\\n\tvpxor\t\t\tRK1, x1 ## 1, x1 ## 1;     \\\n\tvpsrld $22,\t\tx2 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 22),\tx2 ## 1, x2 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\tvpxor\t\t\tx3 ## 1, x2 ## 1, x2 ## 1; \\\n\t\tvpxor\t\t\tRK0, x0 ## 2, x0 ## 2;     \\\n\t\tvpxor\t\t\tRK2, x2 ## 2, x2 ## 2;     \\\n\t\tvpsrld $5,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 5),\tx0 ## 2, x0 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tRK3, x3 ## 2, x3 ## 2;     \\\n\t\tvpxor\t\t\tRK1, x1 ## 2, x1 ## 2;     \\\n\t\tvpsrld $22,\t\tx2 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 22),\tx2 ## 2, x2 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tvpxor\t\t\tx3 ## 2, x2 ## 2, x2 ## 2; \\\n\tvpxor\t\t\tx3 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpslld $7,\t\tx1 ## 1, x4 ## 1;          \\\n\tvpxor\t\t\tx1 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\tvpsrld $1,\t\tx1 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 1),\tx1 ## 1, x1 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x1 ## 1, x1 ## 1; \\\n\t\tvpxor\t\t\tx3 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpslld $7,\t\tx1 ## 2, x4 ## 2;          \\\n\t\tvpxor\t\t\tx1 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2; \\\n\t\tvpsrld $1,\t\tx1 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 1),\tx1 ## 2, x1 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x1 ## 2, x1 ## 2; \\\n\tvpsrld $7,\t\tx3 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 7),\tx3 ## 1, x3 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x3 ## 1, x3 ## 1; \\\n\tvpxor\t\t\tx0 ## 1, x1 ## 1, x1 ## 1; \\\n\tvpslld $3,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpxor\t\t\tx4 ## 1, x3 ## 1, x3 ## 1; \\\n\t\tvpsrld $7,\t\tx3 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 7),\tx3 ## 2, x3 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x3 ## 2, x3 ## 2; \\\n\t\tvpxor\t\t\tx0 ## 2, x1 ## 2, x1 ## 2; \\\n\t\tvpslld $3,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpxor\t\t\tx4 ## 2, x3 ## 2, x3 ## 2; \\\n\tvpsrld $13,\t\tx0 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 13),\tx0 ## 1, x0 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x0 ## 1, x0 ## 1; \\\n\tvpxor\t\t\tx2 ## 1, x1 ## 1, x1 ## 1; \\\n\tvpxor\t\t\tx2 ## 1, x3 ## 1, x3 ## 1; \\\n\tvpsrld $3,\t\tx2 ## 1, x4 ## 1;          \\\n\tvpslld $(32 - 3),\tx2 ## 1, x2 ## 1;          \\\n\tvpor\t\t\tx4 ## 1, x2 ## 1, x2 ## 1; \\\n\t\tvpsrld $13,\t\tx0 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 13),\tx0 ## 2, x0 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x0 ## 2, x0 ## 2; \\\n\t\tvpxor\t\t\tx2 ## 2, x1 ## 2, x1 ## 2; \\\n\t\tvpxor\t\t\tx2 ## 2, x3 ## 2, x3 ## 2; \\\n\t\tvpsrld $3,\t\tx2 ## 2, x4 ## 2;          \\\n\t\tvpslld $(32 - 3),\tx2 ## 2, x2 ## 2;          \\\n\t\tvpor\t\t\tx4 ## 2, x2 ## 2, x2 ## 2;\n\n#define S(SBOX, x0, x1, x2, x3, x4) \\\n\tSBOX ## _1(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tSBOX ## _2(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tSBOX ## _1(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\tSBOX ## _2(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2);\n\n#define SP(SBOX, x0, x1, x2, x3, x4, i) \\\n\tget_key(i, 0, RK0); \\\n\tSBOX ## _1(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tget_key(i, 2, RK2); \\\n\tSBOX ## _2(x0 ## 1, x1 ## 1, x2 ## 1, x3 ## 1, x4 ## 1); \\\n\tget_key(i, 3, RK3); \\\n\tSBOX ## _1(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\tget_key(i, 1, RK1); \\\n\tSBOX ## _2(x0 ## 2, x1 ## 2, x2 ## 2, x3 ## 2, x4 ## 2); \\\n\n#define transpose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\tvpunpckldq\t\tx1, x0, t0; \\\n\tvpunpckhdq\t\tx1, x0, t2; \\\n\tvpunpckldq\t\tx3, x2, t1; \\\n\tvpunpckhdq\t\tx3, x2, x3; \\\n\t\\\n\tvpunpcklqdq\t\tt1, t0, x0; \\\n\tvpunpckhqdq\t\tt1, t0, x1; \\\n\tvpunpcklqdq\t\tx3, t2, x2; \\\n\tvpunpckhqdq\t\tx3, t2, x3;\n\n#define read_blocks(x0, x1, x2, x3, t0, t1, t2) \\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2)\n\n#define write_blocks(x0, x1, x2, x3, t0, t1, t2) \\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2)\n\nSYM_FUNC_START_LOCAL(__serpent_enc_blk16)\n\t \n\n\tvpcmpeqd RNOT, RNOT, RNOT;\n\n\tread_blocks(RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\tread_blocks(RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\t\t\t\t\t\t K2(RA, RB, RC, RD, RE, 0);\n\tS(S0, RA, RB, RC, RD, RE);\t\tLK2(RC, RB, RD, RA, RE, 1);\n\tS(S1, RC, RB, RD, RA, RE);\t\tLK2(RE, RD, RA, RC, RB, 2);\n\tS(S2, RE, RD, RA, RC, RB);\t\tLK2(RB, RD, RE, RC, RA, 3);\n\tS(S3, RB, RD, RE, RC, RA);\t\tLK2(RC, RA, RD, RB, RE, 4);\n\tS(S4, RC, RA, RD, RB, RE);\t\tLK2(RA, RD, RB, RE, RC, 5);\n\tS(S5, RA, RD, RB, RE, RC);\t\tLK2(RC, RA, RD, RE, RB, 6);\n\tS(S6, RC, RA, RD, RE, RB);\t\tLK2(RD, RB, RA, RE, RC, 7);\n\tS(S7, RD, RB, RA, RE, RC);\t\tLK2(RC, RA, RE, RD, RB, 8);\n\tS(S0, RC, RA, RE, RD, RB);\t\tLK2(RE, RA, RD, RC, RB, 9);\n\tS(S1, RE, RA, RD, RC, RB);\t\tLK2(RB, RD, RC, RE, RA, 10);\n\tS(S2, RB, RD, RC, RE, RA);\t\tLK2(RA, RD, RB, RE, RC, 11);\n\tS(S3, RA, RD, RB, RE, RC);\t\tLK2(RE, RC, RD, RA, RB, 12);\n\tS(S4, RE, RC, RD, RA, RB);\t\tLK2(RC, RD, RA, RB, RE, 13);\n\tS(S5, RC, RD, RA, RB, RE);\t\tLK2(RE, RC, RD, RB, RA, 14);\n\tS(S6, RE, RC, RD, RB, RA);\t\tLK2(RD, RA, RC, RB, RE, 15);\n\tS(S7, RD, RA, RC, RB, RE);\t\tLK2(RE, RC, RB, RD, RA, 16);\n\tS(S0, RE, RC, RB, RD, RA);\t\tLK2(RB, RC, RD, RE, RA, 17);\n\tS(S1, RB, RC, RD, RE, RA);\t\tLK2(RA, RD, RE, RB, RC, 18);\n\tS(S2, RA, RD, RE, RB, RC);\t\tLK2(RC, RD, RA, RB, RE, 19);\n\tS(S3, RC, RD, RA, RB, RE);\t\tLK2(RB, RE, RD, RC, RA, 20);\n\tS(S4, RB, RE, RD, RC, RA);\t\tLK2(RE, RD, RC, RA, RB, 21);\n\tS(S5, RE, RD, RC, RA, RB);\t\tLK2(RB, RE, RD, RA, RC, 22);\n\tS(S6, RB, RE, RD, RA, RC);\t\tLK2(RD, RC, RE, RA, RB, 23);\n\tS(S7, RD, RC, RE, RA, RB);\t\tLK2(RB, RE, RA, RD, RC, 24);\n\tS(S0, RB, RE, RA, RD, RC);\t\tLK2(RA, RE, RD, RB, RC, 25);\n\tS(S1, RA, RE, RD, RB, RC);\t\tLK2(RC, RD, RB, RA, RE, 26);\n\tS(S2, RC, RD, RB, RA, RE);\t\tLK2(RE, RD, RC, RA, RB, 27);\n\tS(S3, RE, RD, RC, RA, RB);\t\tLK2(RA, RB, RD, RE, RC, 28);\n\tS(S4, RA, RB, RD, RE, RC);\t\tLK2(RB, RD, RE, RC, RA, 29);\n\tS(S5, RB, RD, RE, RC, RA);\t\tLK2(RA, RB, RD, RC, RE, 30);\n\tS(S6, RA, RB, RD, RC, RE);\t\tLK2(RD, RE, RB, RC, RA, 31);\n\tS(S7, RD, RE, RB, RC, RA);\t\t K2(RA, RB, RC, RD, RE, 32);\n\n\twrite_blocks(RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\twrite_blocks(RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\tRET;\nSYM_FUNC_END(__serpent_enc_blk16)\n\nSYM_FUNC_START_LOCAL(__serpent_dec_blk16)\n\t \n\n\tvpcmpeqd RNOT, RNOT, RNOT;\n\n\tread_blocks(RA1, RB1, RC1, RD1, RK0, RK1, RK2);\n\tread_blocks(RA2, RB2, RC2, RD2, RK0, RK1, RK2);\n\n\t\t\t\t\t\t K2(RA, RB, RC, RD, RE, 32);\n\tSP(SI7, RA, RB, RC, RD, RE, 31);\tKL2(RB, RD, RA, RE, RC, 31);\n\tSP(SI6, RB, RD, RA, RE, RC, 30);\tKL2(RA, RC, RE, RB, RD, 30);\n\tSP(SI5, RA, RC, RE, RB, RD, 29);\tKL2(RC, RD, RA, RE, RB, 29);\n\tSP(SI4, RC, RD, RA, RE, RB, 28);\tKL2(RC, RA, RB, RE, RD, 28);\n\tSP(SI3, RC, RA, RB, RE, RD, 27);\tKL2(RB, RC, RD, RE, RA, 27);\n\tSP(SI2, RB, RC, RD, RE, RA, 26);\tKL2(RC, RA, RE, RD, RB, 26);\n\tSP(SI1, RC, RA, RE, RD, RB, 25);\tKL2(RB, RA, RE, RD, RC, 25);\n\tSP(SI0, RB, RA, RE, RD, RC, 24);\tKL2(RE, RC, RA, RB, RD, 24);\n\tSP(SI7, RE, RC, RA, RB, RD, 23);\tKL2(RC, RB, RE, RD, RA, 23);\n\tSP(SI6, RC, RB, RE, RD, RA, 22);\tKL2(RE, RA, RD, RC, RB, 22);\n\tSP(SI5, RE, RA, RD, RC, RB, 21);\tKL2(RA, RB, RE, RD, RC, 21);\n\tSP(SI4, RA, RB, RE, RD, RC, 20);\tKL2(RA, RE, RC, RD, RB, 20);\n\tSP(SI3, RA, RE, RC, RD, RB, 19);\tKL2(RC, RA, RB, RD, RE, 19);\n\tSP(SI2, RC, RA, RB, RD, RE, 18);\tKL2(RA, RE, RD, RB, RC, 18);\n\tSP(SI1, RA, RE, RD, RB, RC, 17);\tKL2(RC, RE, RD, RB, RA, 17);\n\tSP(SI0, RC, RE, RD, RB, RA, 16);\tKL2(RD, RA, RE, RC, RB, 16);\n\tSP(SI7, RD, RA, RE, RC, RB, 15);\tKL2(RA, RC, RD, RB, RE, 15);\n\tSP(SI6, RA, RC, RD, RB, RE, 14);\tKL2(RD, RE, RB, RA, RC, 14);\n\tSP(SI5, RD, RE, RB, RA, RC, 13);\tKL2(RE, RC, RD, RB, RA, 13);\n\tSP(SI4, RE, RC, RD, RB, RA, 12);\tKL2(RE, RD, RA, RB, RC, 12);\n\tSP(SI3, RE, RD, RA, RB, RC, 11);\tKL2(RA, RE, RC, RB, RD, 11);\n\tSP(SI2, RA, RE, RC, RB, RD, 10);\tKL2(RE, RD, RB, RC, RA, 10);\n\tSP(SI1, RE, RD, RB, RC, RA, 9);\t\tKL2(RA, RD, RB, RC, RE, 9);\n\tSP(SI0, RA, RD, RB, RC, RE, 8);\t\tKL2(RB, RE, RD, RA, RC, 8);\n\tSP(SI7, RB, RE, RD, RA, RC, 7);\t\tKL2(RE, RA, RB, RC, RD, 7);\n\tSP(SI6, RE, RA, RB, RC, RD, 6);\t\tKL2(RB, RD, RC, RE, RA, 6);\n\tSP(SI5, RB, RD, RC, RE, RA, 5);\t\tKL2(RD, RA, RB, RC, RE, 5);\n\tSP(SI4, RD, RA, RB, RC, RE, 4);\t\tKL2(RD, RB, RE, RC, RA, 4);\n\tSP(SI3, RD, RB, RE, RC, RA, 3);\t\tKL2(RE, RD, RA, RC, RB, 3);\n\tSP(SI2, RE, RD, RA, RC, RB, 2);\t\tKL2(RD, RB, RC, RA, RE, 2);\n\tSP(SI1, RD, RB, RC, RA, RE, 1);\t\tKL2(RE, RB, RC, RA, RD, 1);\n\tS(SI0, RE, RB, RC, RA, RD);\t\t K2(RC, RD, RB, RE, RA, 0);\n\n\twrite_blocks(RC1, RD1, RB1, RE1, RK0, RK1, RK2);\n\twrite_blocks(RC2, RD2, RB2, RE2, RK0, RK1, RK2);\n\n\tRET;\nSYM_FUNC_END(__serpent_dec_blk16)\n\nSYM_FUNC_START(serpent_ecb_enc_16way)\n\t \n\tFRAME_BEGIN\n\n\tvzeroupper;\n\n\tload_16way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __serpent_enc_blk16;\n\n\tstore_16way(%rsi, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tvzeroupper;\n\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(serpent_ecb_enc_16way)\n\nSYM_FUNC_START(serpent_ecb_dec_16way)\n\t \n\tFRAME_BEGIN\n\n\tvzeroupper;\n\n\tload_16way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __serpent_dec_blk16;\n\n\tstore_16way(%rsi, RC1, RD1, RB1, RE1, RC2, RD2, RB2, RE2);\n\n\tvzeroupper;\n\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(serpent_ecb_dec_16way)\n\nSYM_FUNC_START(serpent_cbc_dec_16way)\n\t \n\tFRAME_BEGIN\n\n\tvzeroupper;\n\n\tload_16way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __serpent_dec_blk16;\n\n\tstore_cbc_16way(%rdx, %rsi, RC1, RD1, RB1, RE1, RC2, RD2, RB2, RE2,\n\t\t\tRK0);\n\n\tvzeroupper;\n\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(serpent_cbc_dec_16way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}