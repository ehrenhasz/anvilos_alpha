{
  "module_name": "cast6-avx-x86_64-asm_64.S",
  "hash_id": "b2e9a3d31a36447e7e959e18bd9a8d3800e54f9774f3fbc5bcfc42ed4e7cc8db",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/cast6-avx-x86_64-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/frame.h>\n#include \"glue_helper-asm-avx.S\"\n\n.file \"cast6-avx-x86_64-asm_64.S\"\n\n.extern cast_s1\n.extern cast_s2\n.extern cast_s3\n.extern cast_s4\n\n \n#define km\t0\n#define kr\t(12*4*4)\n\n \n#define s1\tcast_s1\n#define s2\tcast_s2\n#define s3\tcast_s3\n#define s4\tcast_s4\n\n \n#define CTX %r15\n\n#define RA1 %xmm0\n#define RB1 %xmm1\n#define RC1 %xmm2\n#define RD1 %xmm3\n\n#define RA2 %xmm4\n#define RB2 %xmm5\n#define RC2 %xmm6\n#define RD2 %xmm7\n\n#define RX  %xmm8\n\n#define RKM  %xmm9\n#define RKR  %xmm10\n#define RKRF %xmm11\n#define RKRR %xmm12\n#define R32  %xmm13\n#define R1ST %xmm14\n\n#define RTMP %xmm15\n\n#define RID1  %rdi\n#define RID1d %edi\n#define RID2  %rsi\n#define RID2d %esi\n\n#define RGI1   %rdx\n#define RGI1bl %dl\n#define RGI1bh %dh\n#define RGI2   %rcx\n#define RGI2bl %cl\n#define RGI2bh %ch\n\n#define RGI3   %rax\n#define RGI3bl %al\n#define RGI3bh %ah\n#define RGI4   %rbx\n#define RGI4bl %bl\n#define RGI4bh %bh\n\n#define RFS1  %r8\n#define RFS1d %r8d\n#define RFS2  %r9\n#define RFS2d %r9d\n#define RFS3  %r10\n#define RFS3d %r10d\n\n\n#define lookup_32bit(src, dst, op1, op2, op3, interleave_op, il_reg) \\\n\tmovzbl\t\tsrc ## bh,     RID1d;    \\\n\tleaq\t\ts1(%rip),      RID2;     \\\n\tmovl\t\t(RID2,RID1,4), dst ## d; \\\n\tmovzbl\t\tsrc ## bl,     RID2d;    \\\n\tleaq\t\ts2(%rip),      RID1;     \\\n\top1\t\t(RID1,RID2,4), dst ## d; \\\n\tshrq $16,\tsrc;                     \\\n\tmovzbl\t\tsrc ## bh,     RID1d;    \\\n\tleaq\t\ts3(%rip),      RID2;     \\\n\top2\t\t(RID2,RID1,4), dst ## d; \\\n\tmovzbl\t\tsrc ## bl,     RID2d;    \\\n\tinterleave_op(il_reg);\t\t\t \\\n\tleaq\t\ts4(%rip),      RID1;     \\\n\top3\t\t(RID1,RID2,4), dst ## d;\n\n#define dummy(d)  \n\n#define shr_next(reg) \\\n\tshrq $16,\treg;\n\n#define F_head(a, x, gi1, gi2, op0) \\\n\top0\ta,\tRKM,  x;                 \\\n\tvpslld\tRKRF,\tx,    RTMP;              \\\n\tvpsrld\tRKRR,\tx,    x;                 \\\n\tvpor\tRTMP,\tx,    x;                 \\\n\t\\\n\tvmovq\t\tx,    gi1;               \\\n\tvpextrq $1,\tx,    gi2;\n\n#define F_tail(a, x, gi1, gi2, op1, op2, op3) \\\n\tlookup_32bit(##gi1, RFS1, op1, op2, op3, shr_next, ##gi1); \\\n\tlookup_32bit(##gi2, RFS3, op1, op2, op3, shr_next, ##gi2); \\\n\t\\\n\tlookup_32bit(##gi1, RFS2, op1, op2, op3, dummy, none);     \\\n\tshlq $32,\tRFS2;                                      \\\n\torq\t\tRFS1, RFS2;                                \\\n\tlookup_32bit(##gi2, RFS1, op1, op2, op3, dummy, none);     \\\n\tshlq $32,\tRFS1;                                      \\\n\torq\t\tRFS1, RFS3;                                \\\n\t\\\n\tvmovq\t\tRFS2, x;                                   \\\n\tvpinsrq $1,\tRFS3, x, x;\n\n#define F_2(a1, b1, a2, b2, op0, op1, op2, op3) \\\n\tF_head(b1, RX, RGI1, RGI2, op0);              \\\n\tF_head(b2, RX, RGI3, RGI4, op0);              \\\n\t\\\n\tF_tail(b1, RX, RGI1, RGI2, op1, op2, op3);    \\\n\tF_tail(b2, RTMP, RGI3, RGI4, op1, op2, op3);  \\\n\t\\\n\tvpxor\t\ta1, RX,   a1;                 \\\n\tvpxor\t\ta2, RTMP, a2;\n\n#define F1_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpaddd, xorl, subl, addl)\n#define F2_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpxor, subl, addl, xorl)\n#define F3_2(a1, b1, a2, b2) \\\n\tF_2(a1, b1, a2, b2, vpsubd, addl, xorl, subl)\n\n#define qop(in, out, f) \\\n\tF ## f ## _2(out ## 1, in ## 1, out ## 2, in ## 2);\n\n#define get_round_keys(nn) \\\n\tvbroadcastss\t(km+(4*(nn)))(CTX), RKM;        \\\n\tvpand\t\tR1ST,               RKR,  RKRF; \\\n\tvpsubq\t\tRKRF,               R32,  RKRR; \\\n\tvpsrldq $1,\tRKR,                RKR;\n\n#define Q(n) \\\n\tget_round_keys(4*n+0); \\\n\tqop(RD, RC, 1);        \\\n\t\\\n\tget_round_keys(4*n+1); \\\n\tqop(RC, RB, 2);        \\\n\t\\\n\tget_round_keys(4*n+2); \\\n\tqop(RB, RA, 3);        \\\n\t\\\n\tget_round_keys(4*n+3); \\\n\tqop(RA, RD, 1);\n\n#define QBAR(n) \\\n\tget_round_keys(4*n+3); \\\n\tqop(RA, RD, 1);        \\\n\t\\\n\tget_round_keys(4*n+2); \\\n\tqop(RB, RA, 3);        \\\n\t\\\n\tget_round_keys(4*n+1); \\\n\tqop(RC, RB, 2);        \\\n\t\\\n\tget_round_keys(4*n+0); \\\n\tqop(RD, RC, 1);\n\n#define shuffle(mask) \\\n\tvpshufb\t\tmask(%rip),            RKR, RKR;\n\n#define preload_rkr(n, do_mask, mask) \\\n\tvbroadcastss\t.L16_mask(%rip),          RKR;      \\\n\t  \\\n\tvpxor\t\t(kr+n*16)(CTX),           RKR, RKR; \\\n\tdo_mask(mask);\n\n#define transpose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\tvpunpckldq\t\tx1, x0, t0; \\\n\tvpunpckhdq\t\tx1, x0, t2; \\\n\tvpunpckldq\t\tx3, x2, t1; \\\n\tvpunpckhdq\t\tx3, x2, x3; \\\n\t\\\n\tvpunpcklqdq\t\tt1, t0, x0; \\\n\tvpunpckhqdq\t\tt1, t0, x1; \\\n\tvpunpcklqdq\t\tx3, t2, x2; \\\n\tvpunpckhqdq\t\tx3, t2, x3;\n\n#define inpack_blocks(x0, x1, x2, x3, t0, t1, t2, rmask) \\\n\tvpshufb rmask, x0,\tx0; \\\n\tvpshufb rmask, x1,\tx1; \\\n\tvpshufb rmask, x2,\tx2; \\\n\tvpshufb rmask, x3,\tx3; \\\n\t\\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2)\n\n#define outunpack_blocks(x0, x1, x2, x3, t0, t1, t2, rmask) \\\n\ttranspose_4x4(x0, x1, x2, x3, t0, t1, t2) \\\n\t\\\n\tvpshufb rmask,\t\tx0, x0;       \\\n\tvpshufb rmask,\t\tx1, x1;       \\\n\tvpshufb rmask,\t\tx2, x2;       \\\n\tvpshufb rmask,\t\tx3, x3;\n\n.section\t.rodata.cst16, \"aM\", @progbits, 16\n.align 16\n.Lbswap_mask:\n\t.byte 3, 2, 1, 0, 7, 6, 5, 4, 11, 10, 9, 8, 15, 14, 13, 12\n.Lbswap128_mask:\n\t.byte 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0\n.Lrkr_enc_Q_Q_QBAR_QBAR:\n\t.byte 0, 1, 2, 3, 4, 5, 6, 7, 11, 10, 9, 8, 15, 14, 13, 12\n.Lrkr_enc_QBAR_QBAR_QBAR_QBAR:\n\t.byte 3, 2, 1, 0, 7, 6, 5, 4, 11, 10, 9, 8, 15, 14, 13, 12\n.Lrkr_dec_Q_Q_Q_Q:\n\t.byte 12, 13, 14, 15, 8, 9, 10, 11, 4, 5, 6, 7, 0, 1, 2, 3\n.Lrkr_dec_Q_Q_QBAR_QBAR:\n\t.byte 12, 13, 14, 15, 8, 9, 10, 11, 7, 6, 5, 4, 3, 2, 1, 0\n.Lrkr_dec_QBAR_QBAR_QBAR_QBAR:\n\t.byte 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0\n\n.section\t.rodata.cst4.L16_mask, \"aM\", @progbits, 4\n.align 4\n.L16_mask:\n\t.byte 16, 16, 16, 16\n\n.section\t.rodata.cst4.L32_mask, \"aM\", @progbits, 4\n.align 4\n.L32_mask:\n\t.byte 32, 0, 0, 0\n\n.section\t.rodata.cst4.first_mask, \"aM\", @progbits, 4\n.align 4\n.Lfirst_mask:\n\t.byte 0x1f, 0, 0, 0\n\n.text\n\n.align 8\nSYM_FUNC_START_LOCAL(__cast6_enc_blk8)\n\t \n\n\tpushq %r15;\n\tpushq %rbx;\n\n\tmovq %rdi, CTX;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\tvmovd .Lfirst_mask(%rip), R1ST;\n\tvmovd .L32_mask(%rip), R32;\n\n\tinpack_blocks(RA1, RB1, RC1, RD1, RTMP, RX, RKRF, RKM);\n\tinpack_blocks(RA2, RB2, RC2, RD2, RTMP, RX, RKRF, RKM);\n\n\tpreload_rkr(0, dummy, none);\n\tQ(0);\n\tQ(1);\n\tQ(2);\n\tQ(3);\n\tpreload_rkr(1, shuffle, .Lrkr_enc_Q_Q_QBAR_QBAR);\n\tQ(4);\n\tQ(5);\n\tQBAR(6);\n\tQBAR(7);\n\tpreload_rkr(2, shuffle, .Lrkr_enc_QBAR_QBAR_QBAR_QBAR);\n\tQBAR(8);\n\tQBAR(9);\n\tQBAR(10);\n\tQBAR(11);\n\n\tpopq %rbx;\n\tpopq %r15;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\n\toutunpack_blocks(RA1, RB1, RC1, RD1, RTMP, RX, RKRF, RKM);\n\toutunpack_blocks(RA2, RB2, RC2, RD2, RTMP, RX, RKRF, RKM);\n\n\tRET;\nSYM_FUNC_END(__cast6_enc_blk8)\n\n.align 8\nSYM_FUNC_START_LOCAL(__cast6_dec_blk8)\n\t \n\n\tpushq %r15;\n\tpushq %rbx;\n\n\tmovq %rdi, CTX;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\tvmovd .Lfirst_mask(%rip), R1ST;\n\tvmovd .L32_mask(%rip), R32;\n\n\tinpack_blocks(RA1, RB1, RC1, RD1, RTMP, RX, RKRF, RKM);\n\tinpack_blocks(RA2, RB2, RC2, RD2, RTMP, RX, RKRF, RKM);\n\n\tpreload_rkr(2, shuffle, .Lrkr_dec_Q_Q_Q_Q);\n\tQ(11);\n\tQ(10);\n\tQ(9);\n\tQ(8);\n\tpreload_rkr(1, shuffle, .Lrkr_dec_Q_Q_QBAR_QBAR);\n\tQ(7);\n\tQ(6);\n\tQBAR(5);\n\tQBAR(4);\n\tpreload_rkr(0, shuffle, .Lrkr_dec_QBAR_QBAR_QBAR_QBAR);\n\tQBAR(3);\n\tQBAR(2);\n\tQBAR(1);\n\tQBAR(0);\n\n\tpopq %rbx;\n\tpopq %r15;\n\n\tvmovdqa .Lbswap_mask(%rip), RKM;\n\toutunpack_blocks(RA1, RB1, RC1, RD1, RTMP, RX, RKRF, RKM);\n\toutunpack_blocks(RA2, RB2, RC2, RD2, RTMP, RX, RKRF, RKM);\n\n\tRET;\nSYM_FUNC_END(__cast6_dec_blk8)\n\nSYM_FUNC_START(cast6_ecb_enc_8way)\n\t \n\tFRAME_BEGIN\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\n\tload_8way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __cast6_enc_blk8;\n\n\tstore_8way(%r11, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tpopq %r15;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast6_ecb_enc_8way)\n\nSYM_FUNC_START(cast6_ecb_dec_8way)\n\t \n\tFRAME_BEGIN\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\n\tload_8way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __cast6_dec_blk8;\n\n\tstore_8way(%r11, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tpopq %r15;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast6_ecb_dec_8way)\n\nSYM_FUNC_START(cast6_cbc_dec_8way)\n\t \n\tFRAME_BEGIN\n\tpushq %r12;\n\tpushq %r15;\n\n\tmovq %rdi, CTX;\n\tmovq %rsi, %r11;\n\tmovq %rdx, %r12;\n\n\tload_8way(%rdx, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tcall __cast6_dec_blk8;\n\n\tstore_cbc_8way(%r12, %r11, RA1, RB1, RC1, RD1, RA2, RB2, RC2, RD2);\n\n\tpopq %r15;\n\tpopq %r12;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(cast6_cbc_dec_8way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}