{
  "module_name": "camellia-aesni-avx2-asm_64.S",
  "hash_id": "002ad1521c6370ae311bd1cdc4868a058307e4e93002764543d14e139d2f8039",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/crypto/camellia-aesni-avx2-asm_64.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/frame.h>\n\n#define CAMELLIA_TABLE_BYTE_LEN 272\n\n \n#define key_table 0\n#define key_length CAMELLIA_TABLE_BYTE_LEN\n\n \n#define CTX %rdi\n#define RIO %r8\n\n \n#define filter_8bit(x, lo_t, hi_t, mask4bit, tmp0) \\\n\tvpand x, mask4bit, tmp0; \\\n\tvpandn x, mask4bit, x; \\\n\tvpsrld $4, x, x; \\\n\t\\\n\tvpshufb tmp0, lo_t, tmp0; \\\n\tvpshufb x, hi_t, x; \\\n\tvpxor tmp0, x, x;\n\n#define ymm0_x xmm0\n#define ymm1_x xmm1\n#define ymm2_x xmm2\n#define ymm3_x xmm3\n#define ymm4_x xmm4\n#define ymm5_x xmm5\n#define ymm6_x xmm6\n#define ymm7_x xmm7\n#define ymm8_x xmm8\n#define ymm9_x xmm9\n#define ymm10_x xmm10\n#define ymm11_x xmm11\n#define ymm12_x xmm12\n#define ymm13_x xmm13\n#define ymm14_x xmm14\n#define ymm15_x xmm15\n\n \n\n \n#define roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, t0, t1, t2, t3, t4, t5, t6, \\\n\t\t  t7, mem_cd, key) \\\n\t  \\\n\tvbroadcasti128 .Linv_shift_row(%rip), t4; \\\n\tvpbroadcastd .L0f0f0f0f(%rip), t7; \\\n\tvbroadcasti128 .Lpre_tf_lo_s1(%rip), t5; \\\n\tvbroadcasti128 .Lpre_tf_hi_s1(%rip), t6; \\\n\tvbroadcasti128 .Lpre_tf_lo_s4(%rip), t2; \\\n\tvbroadcasti128 .Lpre_tf_hi_s4(%rip), t3; \\\n\t\\\n\t  \\\n\tvpshufb t4, x0, x0; \\\n\tvpshufb t4, x7, x7; \\\n\tvpshufb t4, x3, x3; \\\n\tvpshufb t4, x6, x6; \\\n\tvpshufb t4, x2, x2; \\\n\tvpshufb t4, x5, x5; \\\n\tvpshufb t4, x1, x1; \\\n\tvpshufb t4, x4, x4; \\\n\t\\\n\t  \\\n\t  \\\n\tfilter_8bit(x0, t5, t6, t7, t4); \\\n\tfilter_8bit(x7, t5, t6, t7, t4); \\\n\tvextracti128 $1, x0, t0##_x; \\\n\tvextracti128 $1, x7, t1##_x; \\\n\tfilter_8bit(x3, t2, t3, t7, t4); \\\n\tfilter_8bit(x6, t2, t3, t7, t4); \\\n\tvextracti128 $1, x3, t3##_x; \\\n\tvextracti128 $1, x6, t2##_x; \\\n\tfilter_8bit(x2, t5, t6, t7, t4); \\\n\tfilter_8bit(x5, t5, t6, t7, t4); \\\n\tfilter_8bit(x1, t5, t6, t7, t4); \\\n\tfilter_8bit(x4, t5, t6, t7, t4); \\\n\t\\\n\tvpxor t4##_x, t4##_x, t4##_x; \\\n\t\\\n\t  \\\n\tvextracti128 $1, x2, t6##_x; \\\n\tvextracti128 $1, x5, t5##_x; \\\n\tvaesenclast t4##_x, x0##_x, x0##_x; \\\n\tvaesenclast t4##_x, t0##_x, t0##_x; \\\n\tvinserti128 $1, t0##_x, x0, x0; \\\n\tvaesenclast t4##_x, x7##_x, x7##_x; \\\n\tvaesenclast t4##_x, t1##_x, t1##_x; \\\n\tvinserti128 $1, t1##_x, x7, x7; \\\n\tvaesenclast t4##_x, x3##_x, x3##_x; \\\n\tvaesenclast t4##_x, t3##_x, t3##_x; \\\n\tvinserti128 $1, t3##_x, x3, x3; \\\n\tvaesenclast t4##_x, x6##_x, x6##_x; \\\n\tvaesenclast t4##_x, t2##_x, t2##_x; \\\n\tvinserti128 $1, t2##_x, x6, x6; \\\n\tvextracti128 $1, x1, t3##_x; \\\n\tvextracti128 $1, x4, t2##_x; \\\n\tvbroadcasti128 .Lpost_tf_lo_s1(%rip), t0; \\\n\tvbroadcasti128 .Lpost_tf_hi_s1(%rip), t1; \\\n\tvaesenclast t4##_x, x2##_x, x2##_x; \\\n\tvaesenclast t4##_x, t6##_x, t6##_x; \\\n\tvinserti128 $1, t6##_x, x2, x2; \\\n\tvaesenclast t4##_x, x5##_x, x5##_x; \\\n\tvaesenclast t4##_x, t5##_x, t5##_x; \\\n\tvinserti128 $1, t5##_x, x5, x5; \\\n\tvaesenclast t4##_x, x1##_x, x1##_x; \\\n\tvaesenclast t4##_x, t3##_x, t3##_x; \\\n\tvinserti128 $1, t3##_x, x1, x1; \\\n\tvaesenclast t4##_x, x4##_x, x4##_x; \\\n\tvaesenclast t4##_x, t2##_x, t2##_x; \\\n\tvinserti128 $1, t2##_x, x4, x4; \\\n\t\\\n\t  \\\n\tvbroadcasti128 .Lpost_tf_lo_s3(%rip), t2; \\\n\tvbroadcasti128 .Lpost_tf_hi_s3(%rip), t3; \\\n\tfilter_8bit(x0, t0, t1, t7, t6); \\\n\tfilter_8bit(x7, t0, t1, t7, t6); \\\n\tfilter_8bit(x3, t0, t1, t7, t6); \\\n\tfilter_8bit(x6, t0, t1, t7, t6); \\\n\t\\\n\t  \\\n\tvbroadcasti128 .Lpost_tf_lo_s2(%rip), t4; \\\n\tvbroadcasti128 .Lpost_tf_hi_s2(%rip), t5; \\\n\tfilter_8bit(x2, t2, t3, t7, t6); \\\n\tfilter_8bit(x5, t2, t3, t7, t6); \\\n\t\\\n\tvpbroadcastq key, t0;   \\\n\t\\\n\t  \\\n\tfilter_8bit(x1, t4, t5, t7, t2); \\\n\tfilter_8bit(x4, t4, t5, t7, t2); \\\n\tvpxor t7, t7, t7; \\\n\t\\\n\tvpsrldq $1, t0, t1; \\\n\tvpsrldq $2, t0, t2; \\\n\tvpshufb t7, t1, t1; \\\n\tvpsrldq $3, t0, t3; \\\n\t\\\n\t  \\\n\tvpxor x5, x0, x0; \\\n\tvpxor x6, x1, x1; \\\n\tvpxor x7, x2, x2; \\\n\tvpxor x4, x3, x3; \\\n\t\\\n\tvpshufb t7, t2, t2; \\\n\tvpsrldq $4, t0, t4; \\\n\tvpshufb t7, t3, t3; \\\n\tvpsrldq $5, t0, t5; \\\n\tvpshufb t7, t4, t4; \\\n\t\\\n\tvpxor x2, x4, x4; \\\n\tvpxor x3, x5, x5; \\\n\tvpxor x0, x6, x6; \\\n\tvpxor x1, x7, x7; \\\n\t\\\n\tvpsrldq $6, t0, t6; \\\n\tvpshufb t7, t5, t5; \\\n\tvpshufb t7, t6, t6; \\\n\t\\\n\tvpxor x7, x0, x0; \\\n\tvpxor x4, x1, x1; \\\n\tvpxor x5, x2, x2; \\\n\tvpxor x6, x3, x3; \\\n\t\\\n\tvpxor x3, x4, x4; \\\n\tvpxor x0, x5, x5; \\\n\tvpxor x1, x6, x6; \\\n\tvpxor x2, x7, x7;   \\\n\t\\\n\t  \\\n\t\\\n\tvpxor t6, x1, x1; \\\n\tvpxor 5 * 32(mem_cd), x1, x1; \\\n\t\\\n\tvpsrldq $7, t0, t6; \\\n\tvpshufb t7, t0, t0; \\\n\tvpshufb t7, t6, t7; \\\n\t\\\n\tvpxor t7, x0, x0; \\\n\tvpxor 4 * 32(mem_cd), x0, x0; \\\n\t\\\n\tvpxor t5, x2, x2; \\\n\tvpxor 6 * 32(mem_cd), x2, x2; \\\n\t\\\n\tvpxor t4, x3, x3; \\\n\tvpxor 7 * 32(mem_cd), x3, x3; \\\n\t\\\n\tvpxor t3, x4, x4; \\\n\tvpxor 0 * 32(mem_cd), x4, x4; \\\n\t\\\n\tvpxor t2, x5, x5; \\\n\tvpxor 1 * 32(mem_cd), x5, x5; \\\n\t\\\n\tvpxor t1, x6, x6; \\\n\tvpxor 2 * 32(mem_cd), x6, x6; \\\n\t\\\n\tvpxor t0, x7, x7; \\\n\tvpxor 3 * 32(mem_cd), x7, x7;\n\n \nSYM_FUNC_START_LOCAL(roundsm32_x0_x1_x2_x3_x4_x5_x6_x7_y0_y1_y2_y3_y4_y5_y6_y7_cd)\n\troundsm32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t  %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14, %ymm15,\n\t\t  %rcx, (%r9));\n\tRET;\nSYM_FUNC_END(roundsm32_x0_x1_x2_x3_x4_x5_x6_x7_y0_y1_y2_y3_y4_y5_y6_y7_cd)\n\nSYM_FUNC_START_LOCAL(roundsm32_x4_x5_x6_x7_x0_x1_x2_x3_y4_y5_y6_y7_y0_y1_y2_y3_ab)\n\troundsm32(%ymm4, %ymm5, %ymm6, %ymm7, %ymm0, %ymm1, %ymm2, %ymm3,\n\t\t  %ymm12, %ymm13, %ymm14, %ymm15, %ymm8, %ymm9, %ymm10, %ymm11,\n\t\t  %rax, (%r9));\n\tRET;\nSYM_FUNC_END(roundsm32_x4_x5_x6_x7_x0_x1_x2_x3_y4_y5_y6_y7_y0_y1_y2_y3_ab)\n\n \n#define two_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, i, dir, store_ab) \\\n\tleaq (key_table + (i) * 8)(CTX), %r9; \\\n\tcall roundsm32_x0_x1_x2_x3_x4_x5_x6_x7_y0_y1_y2_y3_y4_y5_y6_y7_cd; \\\n\t\\\n\tvmovdqu x0, 4 * 32(mem_cd); \\\n\tvmovdqu x1, 5 * 32(mem_cd); \\\n\tvmovdqu x2, 6 * 32(mem_cd); \\\n\tvmovdqu x3, 7 * 32(mem_cd); \\\n\tvmovdqu x4, 0 * 32(mem_cd); \\\n\tvmovdqu x5, 1 * 32(mem_cd); \\\n\tvmovdqu x6, 2 * 32(mem_cd); \\\n\tvmovdqu x7, 3 * 32(mem_cd); \\\n\t\\\n\tleaq (key_table + ((i) + (dir)) * 8)(CTX), %r9; \\\n\tcall roundsm32_x4_x5_x6_x7_x0_x1_x2_x3_y4_y5_y6_y7_y0_y1_y2_y3_ab; \\\n\t\\\n\tstore_ab(x0, x1, x2, x3, x4, x5, x6, x7, mem_ab);\n\n#define dummy_store(x0, x1, x2, x3, x4, x5, x6, x7, mem_ab)  \n\n#define store_ab_state(x0, x1, x2, x3, x4, x5, x6, x7, mem_ab) \\\n\t  \\\n\tvmovdqu x4, 4 * 32(mem_ab); \\\n\tvmovdqu x5, 5 * 32(mem_ab); \\\n\tvmovdqu x6, 6 * 32(mem_ab); \\\n\tvmovdqu x7, 7 * 32(mem_ab); \\\n\tvmovdqu x0, 0 * 32(mem_ab); \\\n\tvmovdqu x1, 1 * 32(mem_ab); \\\n\tvmovdqu x2, 2 * 32(mem_ab); \\\n\tvmovdqu x3, 3 * 32(mem_ab);\n\n#define enc_rounds32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, i) \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 2, 1, store_ab_state); \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 4, 1, store_ab_state); \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 6, 1, dummy_store);\n\n#define dec_rounds32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, i) \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 7, -1, store_ab_state); \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 5, -1, store_ab_state); \\\n\ttwo_roundsm32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd, (i) + 3, -1, dummy_store);\n\n \n#define rol32_1_32(v0, v1, v2, v3, t0, t1, t2, zero) \\\n\tvpcmpgtb v0, zero, t0; \\\n\tvpaddb v0, v0, v0; \\\n\tvpabsb t0, t0; \\\n\t\\\n\tvpcmpgtb v1, zero, t1; \\\n\tvpaddb v1, v1, v1; \\\n\tvpabsb t1, t1; \\\n\t\\\n\tvpcmpgtb v2, zero, t2; \\\n\tvpaddb v2, v2, v2; \\\n\tvpabsb t2, t2; \\\n\t\\\n\tvpor t0, v1, v1; \\\n\t\\\n\tvpcmpgtb v3, zero, t0; \\\n\tvpaddb v3, v3, v3; \\\n\tvpabsb t0, t0; \\\n\t\\\n\tvpor t1, v2, v2; \\\n\tvpor t2, v3, v3; \\\n\tvpor t0, v0, v0;\n\n \n#define fls32(l, l0, l1, l2, l3, l4, l5, l6, l7, r, t0, t1, t2, t3, tt0, \\\n\t      tt1, tt2, tt3, kll, klr, krl, krr) \\\n\t  \\\n\tvpbroadcastd kll, t0;   \\\n\tvpxor tt0, tt0, tt0; \\\n\tvpshufb tt0, t0, t3; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t2; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t1; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t0; \\\n\t\\\n\tvpand l0, t0, t0; \\\n\tvpand l1, t1, t1; \\\n\tvpand l2, t2, t2; \\\n\tvpand l3, t3, t3; \\\n\t\\\n\trol32_1_32(t3, t2, t1, t0, tt1, tt2, tt3, tt0); \\\n\t\\\n\tvpxor l4, t0, l4; \\\n\tvpbroadcastd krr, t0;   \\\n\tvmovdqu l4, 4 * 32(l); \\\n\tvpxor l5, t1, l5; \\\n\tvmovdqu l5, 5 * 32(l); \\\n\tvpxor l6, t2, l6; \\\n\tvmovdqu l6, 6 * 32(l); \\\n\tvpxor l7, t3, l7; \\\n\tvmovdqu l7, 7 * 32(l); \\\n\t\\\n\t  \\\n\t\\\n\tvpshufb tt0, t0, t3; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t2; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t1; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t0; \\\n\t\\\n\tvpor 4 * 32(r), t0, t0; \\\n\tvpor 5 * 32(r), t1, t1; \\\n\tvpor 6 * 32(r), t2, t2; \\\n\tvpor 7 * 32(r), t3, t3; \\\n\t\\\n\tvpxor 0 * 32(r), t0, t0; \\\n\tvpxor 1 * 32(r), t1, t1; \\\n\tvpxor 2 * 32(r), t2, t2; \\\n\tvpxor 3 * 32(r), t3, t3; \\\n\tvmovdqu t0, 0 * 32(r); \\\n\tvpbroadcastd krl, t0;   \\\n\tvmovdqu t1, 1 * 32(r); \\\n\tvmovdqu t2, 2 * 32(r); \\\n\tvmovdqu t3, 3 * 32(r); \\\n\t\\\n\t  \\\n\tvpshufb tt0, t0, t3; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t2; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t1; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t0; \\\n\t\\\n\tvpand 0 * 32(r), t0, t0; \\\n\tvpand 1 * 32(r), t1, t1; \\\n\tvpand 2 * 32(r), t2, t2; \\\n\tvpand 3 * 32(r), t3, t3; \\\n\t\\\n\trol32_1_32(t3, t2, t1, t0, tt1, tt2, tt3, tt0); \\\n\t\\\n\tvpxor 4 * 32(r), t0, t0; \\\n\tvpxor 5 * 32(r), t1, t1; \\\n\tvpxor 6 * 32(r), t2, t2; \\\n\tvpxor 7 * 32(r), t3, t3; \\\n\tvmovdqu t0, 4 * 32(r); \\\n\tvpbroadcastd klr, t0;   \\\n\tvmovdqu t1, 5 * 32(r); \\\n\tvmovdqu t2, 6 * 32(r); \\\n\tvmovdqu t3, 7 * 32(r); \\\n\t\\\n\t  \\\n\t\\\n\tvpshufb tt0, t0, t3; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t2; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t1; \\\n\tvpsrldq $1, t0, t0; \\\n\tvpshufb tt0, t0, t0; \\\n\t\\\n\tvpor l4, t0, t0; \\\n\tvpor l5, t1, t1; \\\n\tvpor l6, t2, t2; \\\n\tvpor l7, t3, t3; \\\n\t\\\n\tvpxor l0, t0, l0; \\\n\tvmovdqu l0, 0 * 32(l); \\\n\tvpxor l1, t1, l1; \\\n\tvmovdqu l1, 1 * 32(l); \\\n\tvpxor l2, t2, l2; \\\n\tvmovdqu l2, 2 * 32(l); \\\n\tvpxor l3, t3, l3; \\\n\tvmovdqu l3, 3 * 32(l);\n\n#define transpose_4x4(x0, x1, x2, x3, t1, t2) \\\n\tvpunpckhdq x1, x0, t2; \\\n\tvpunpckldq x1, x0, x0; \\\n\t\\\n\tvpunpckldq x3, x2, t1; \\\n\tvpunpckhdq x3, x2, x2; \\\n\t\\\n\tvpunpckhqdq t1, x0, x1; \\\n\tvpunpcklqdq t1, x0, x0; \\\n\t\\\n\tvpunpckhqdq x2, t2, x3; \\\n\tvpunpcklqdq x2, t2, x2;\n\n#define byteslice_16x16b_fast(a0, b0, c0, d0, a1, b1, c1, d1, a2, b2, c2, d2, \\\n\t\t\t      a3, b3, c3, d3, st0, st1) \\\n\tvmovdqu d2, st0; \\\n\tvmovdqu d3, st1; \\\n\ttranspose_4x4(a0, a1, a2, a3, d2, d3); \\\n\ttranspose_4x4(b0, b1, b2, b3, d2, d3); \\\n\tvmovdqu st0, d2; \\\n\tvmovdqu st1, d3; \\\n\t\\\n\tvmovdqu a0, st0; \\\n\tvmovdqu a1, st1; \\\n\ttranspose_4x4(c0, c1, c2, c3, a0, a1); \\\n\ttranspose_4x4(d0, d1, d2, d3, a0, a1); \\\n\t\\\n\tvbroadcasti128 .Lshufb_16x16b(%rip), a0; \\\n\tvmovdqu st1, a1; \\\n\tvpshufb a0, a2, a2; \\\n\tvpshufb a0, a3, a3; \\\n\tvpshufb a0, b0, b0; \\\n\tvpshufb a0, b1, b1; \\\n\tvpshufb a0, b2, b2; \\\n\tvpshufb a0, b3, b3; \\\n\tvpshufb a0, a1, a1; \\\n\tvpshufb a0, c0, c0; \\\n\tvpshufb a0, c1, c1; \\\n\tvpshufb a0, c2, c2; \\\n\tvpshufb a0, c3, c3; \\\n\tvpshufb a0, d0, d0; \\\n\tvpshufb a0, d1, d1; \\\n\tvpshufb a0, d2, d2; \\\n\tvpshufb a0, d3, d3; \\\n\tvmovdqu d3, st1; \\\n\tvmovdqu st0, d3; \\\n\tvpshufb a0, d3, a0; \\\n\tvmovdqu d2, st0; \\\n\t\\\n\ttranspose_4x4(a0, b0, c0, d0, d2, d3); \\\n\ttranspose_4x4(a1, b1, c1, d1, d2, d3); \\\n\tvmovdqu st0, d2; \\\n\tvmovdqu st1, d3; \\\n\t\\\n\tvmovdqu b0, st0; \\\n\tvmovdqu b1, st1; \\\n\ttranspose_4x4(a2, b2, c2, d2, b0, b1); \\\n\ttranspose_4x4(a3, b3, c3, d3, b0, b1); \\\n\tvmovdqu st0, b0; \\\n\tvmovdqu st1, b1; \\\n\t \n\n \n#define inpack32_pre(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t     y6, y7, rio, key) \\\n\tvpbroadcastq key, x0; \\\n\tvpshufb .Lpack_bswap(%rip), x0, x0; \\\n\t\\\n\tvpxor 0 * 32(rio), x0, y7; \\\n\tvpxor 1 * 32(rio), x0, y6; \\\n\tvpxor 2 * 32(rio), x0, y5; \\\n\tvpxor 3 * 32(rio), x0, y4; \\\n\tvpxor 4 * 32(rio), x0, y3; \\\n\tvpxor 5 * 32(rio), x0, y2; \\\n\tvpxor 6 * 32(rio), x0, y1; \\\n\tvpxor 7 * 32(rio), x0, y0; \\\n\tvpxor 8 * 32(rio), x0, x7; \\\n\tvpxor 9 * 32(rio), x0, x6; \\\n\tvpxor 10 * 32(rio), x0, x5; \\\n\tvpxor 11 * 32(rio), x0, x4; \\\n\tvpxor 12 * 32(rio), x0, x3; \\\n\tvpxor 13 * 32(rio), x0, x2; \\\n\tvpxor 14 * 32(rio), x0, x1; \\\n\tvpxor 15 * 32(rio), x0, x0;\n\n \n#define inpack32_post(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t      y6, y7, mem_ab, mem_cd) \\\n\tbyteslice_16x16b_fast(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, \\\n\t\t\t      y4, y5, y6, y7, (mem_ab), (mem_cd)); \\\n\t\\\n\tvmovdqu x0, 0 * 32(mem_ab); \\\n\tvmovdqu x1, 1 * 32(mem_ab); \\\n\tvmovdqu x2, 2 * 32(mem_ab); \\\n\tvmovdqu x3, 3 * 32(mem_ab); \\\n\tvmovdqu x4, 4 * 32(mem_ab); \\\n\tvmovdqu x5, 5 * 32(mem_ab); \\\n\tvmovdqu x6, 6 * 32(mem_ab); \\\n\tvmovdqu x7, 7 * 32(mem_ab); \\\n\tvmovdqu y0, 0 * 32(mem_cd); \\\n\tvmovdqu y1, 1 * 32(mem_cd); \\\n\tvmovdqu y2, 2 * 32(mem_cd); \\\n\tvmovdqu y3, 3 * 32(mem_cd); \\\n\tvmovdqu y4, 4 * 32(mem_cd); \\\n\tvmovdqu y5, 5 * 32(mem_cd); \\\n\tvmovdqu y6, 6 * 32(mem_cd); \\\n\tvmovdqu y7, 7 * 32(mem_cd);\n\n \n#define outunpack32(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, \\\n\t\t    y5, y6, y7, key, stack_tmp0, stack_tmp1) \\\n\tbyteslice_16x16b_fast(y0, y4, x0, x4, y1, y5, x1, x5, y2, y6, x2, x6, \\\n\t\t\t      y3, y7, x3, x7, stack_tmp0, stack_tmp1); \\\n\t\\\n\tvmovdqu x0, stack_tmp0; \\\n\t\\\n\tvpbroadcastq key, x0; \\\n\tvpshufb .Lpack_bswap(%rip), x0, x0; \\\n\t\\\n\tvpxor x0, y7, y7; \\\n\tvpxor x0, y6, y6; \\\n\tvpxor x0, y5, y5; \\\n\tvpxor x0, y4, y4; \\\n\tvpxor x0, y3, y3; \\\n\tvpxor x0, y2, y2; \\\n\tvpxor x0, y1, y1; \\\n\tvpxor x0, y0, y0; \\\n\tvpxor x0, x7, x7; \\\n\tvpxor x0, x6, x6; \\\n\tvpxor x0, x5, x5; \\\n\tvpxor x0, x4, x4; \\\n\tvpxor x0, x3, x3; \\\n\tvpxor x0, x2, x2; \\\n\tvpxor x0, x1, x1; \\\n\tvpxor stack_tmp0, x0, x0;\n\n#define write_output(x0, x1, x2, x3, x4, x5, x6, x7, y0, y1, y2, y3, y4, y5, \\\n\t\t     y6, y7, rio) \\\n\tvmovdqu x0, 0 * 32(rio); \\\n\tvmovdqu x1, 1 * 32(rio); \\\n\tvmovdqu x2, 2 * 32(rio); \\\n\tvmovdqu x3, 3 * 32(rio); \\\n\tvmovdqu x4, 4 * 32(rio); \\\n\tvmovdqu x5, 5 * 32(rio); \\\n\tvmovdqu x6, 6 * 32(rio); \\\n\tvmovdqu x7, 7 * 32(rio); \\\n\tvmovdqu y0, 8 * 32(rio); \\\n\tvmovdqu y1, 9 * 32(rio); \\\n\tvmovdqu y2, 10 * 32(rio); \\\n\tvmovdqu y3, 11 * 32(rio); \\\n\tvmovdqu y4, 12 * 32(rio); \\\n\tvmovdqu y5, 13 * 32(rio); \\\n\tvmovdqu y6, 14 * 32(rio); \\\n\tvmovdqu y7, 15 * 32(rio);\n\n\n.section\t.rodata.cst32.shufb_16x16b, \"aM\", @progbits, 32\n.align 32\n#define SHUFB_BYTES(idx) \\\n\t0 + (idx), 4 + (idx), 8 + (idx), 12 + (idx)\n.Lshufb_16x16b:\n\t.byte SHUFB_BYTES(0), SHUFB_BYTES(1), SHUFB_BYTES(2), SHUFB_BYTES(3)\n\t.byte SHUFB_BYTES(0), SHUFB_BYTES(1), SHUFB_BYTES(2), SHUFB_BYTES(3)\n\n.section\t.rodata.cst32.pack_bswap, \"aM\", @progbits, 32\n.align 32\n.Lpack_bswap:\n\t.long 0x00010203, 0x04050607, 0x80808080, 0x80808080\n\t.long 0x00010203, 0x04050607, 0x80808080, 0x80808080\n\n \n.section\t.rodata.cst16, \"aM\", @progbits, 16\n.align 16\n\n \n.Lpre_tf_lo_s1:\n\t.byte 0x45, 0xe8, 0x40, 0xed, 0x2e, 0x83, 0x2b, 0x86\n\t.byte 0x4b, 0xe6, 0x4e, 0xe3, 0x20, 0x8d, 0x25, 0x88\n.Lpre_tf_hi_s1:\n\t.byte 0x00, 0x51, 0xf1, 0xa0, 0x8a, 0xdb, 0x7b, 0x2a\n\t.byte 0x09, 0x58, 0xf8, 0xa9, 0x83, 0xd2, 0x72, 0x23\n\n \n.Lpre_tf_lo_s4:\n\t.byte 0x45, 0x40, 0x2e, 0x2b, 0x4b, 0x4e, 0x20, 0x25\n\t.byte 0x14, 0x11, 0x7f, 0x7a, 0x1a, 0x1f, 0x71, 0x74\n.Lpre_tf_hi_s4:\n\t.byte 0x00, 0xf1, 0x8a, 0x7b, 0x09, 0xf8, 0x83, 0x72\n\t.byte 0xad, 0x5c, 0x27, 0xd6, 0xa4, 0x55, 0x2e, 0xdf\n\n \n.Lpost_tf_lo_s1:\n\t.byte 0x3c, 0xcc, 0xcf, 0x3f, 0x32, 0xc2, 0xc1, 0x31\n\t.byte 0xdc, 0x2c, 0x2f, 0xdf, 0xd2, 0x22, 0x21, 0xd1\n.Lpost_tf_hi_s1:\n\t.byte 0x00, 0xf9, 0x86, 0x7f, 0xd7, 0x2e, 0x51, 0xa8\n\t.byte 0xa4, 0x5d, 0x22, 0xdb, 0x73, 0x8a, 0xf5, 0x0c\n\n \n.Lpost_tf_lo_s2:\n\t.byte 0x78, 0x99, 0x9f, 0x7e, 0x64, 0x85, 0x83, 0x62\n\t.byte 0xb9, 0x58, 0x5e, 0xbf, 0xa5, 0x44, 0x42, 0xa3\n.Lpost_tf_hi_s2:\n\t.byte 0x00, 0xf3, 0x0d, 0xfe, 0xaf, 0x5c, 0xa2, 0x51\n\t.byte 0x49, 0xba, 0x44, 0xb7, 0xe6, 0x15, 0xeb, 0x18\n\n \n.Lpost_tf_lo_s3:\n\t.byte 0x1e, 0x66, 0xe7, 0x9f, 0x19, 0x61, 0xe0, 0x98\n\t.byte 0x6e, 0x16, 0x97, 0xef, 0x69, 0x11, 0x90, 0xe8\n.Lpost_tf_hi_s3:\n\t.byte 0x00, 0xfc, 0x43, 0xbf, 0xeb, 0x17, 0xa8, 0x54\n\t.byte 0x52, 0xae, 0x11, 0xed, 0xb9, 0x45, 0xfa, 0x06\n\n \n.Linv_shift_row:\n\t.byte 0x00, 0x0d, 0x0a, 0x07, 0x04, 0x01, 0x0e, 0x0b\n\t.byte 0x08, 0x05, 0x02, 0x0f, 0x0c, 0x09, 0x06, 0x03\n\n.section\t.rodata.cst4.L0f0f0f0f, \"aM\", @progbits, 4\n.align 4\n \n.L0f0f0f0f:\n\t.long 0x0f0f0f0f\n\n.text\n\nSYM_FUNC_START_LOCAL(__camellia_enc_blk32)\n\t \n\tFRAME_BEGIN\n\n\tleaq 8 * 32(%rax), %rcx;\n\n\tinpack32_post(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t      %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t      %ymm15, %rax, %rcx);\n\n\tenc_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 0);\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (8) * 8) + 0)(CTX),\n\t      ((key_table + (8) * 8) + 4)(CTX),\n\t      ((key_table + (8) * 8) + 8)(CTX),\n\t      ((key_table + (8) * 8) + 12)(CTX));\n\n\tenc_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 8);\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (16) * 8) + 0)(CTX),\n\t      ((key_table + (16) * 8) + 4)(CTX),\n\t      ((key_table + (16) * 8) + 8)(CTX),\n\t      ((key_table + (16) * 8) + 12)(CTX));\n\n\tenc_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 16);\n\n\tmovl $24, %r8d;\n\tcmpl $16, key_length(CTX);\n\tjne .Lenc_max32;\n\n.Lenc_done:\n\t \n\tvmovdqu 0 * 32(%rcx), %ymm8;\n\tvmovdqu 1 * 32(%rcx), %ymm9;\n\tvmovdqu 2 * 32(%rcx), %ymm10;\n\tvmovdqu 3 * 32(%rcx), %ymm11;\n\tvmovdqu 4 * 32(%rcx), %ymm12;\n\tvmovdqu 5 * 32(%rcx), %ymm13;\n\tvmovdqu 6 * 32(%rcx), %ymm14;\n\tvmovdqu 7 * 32(%rcx), %ymm15;\n\n\toutunpack32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t    %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t    %ymm15, (key_table)(CTX, %r8, 8), (%rax), 1 * 32(%rax));\n\n\tFRAME_END\n\tRET;\n\n.align 8\n.Lenc_max32:\n\tmovl $32, %r8d;\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (24) * 8) + 0)(CTX),\n\t      ((key_table + (24) * 8) + 4)(CTX),\n\t      ((key_table + (24) * 8) + 8)(CTX),\n\t      ((key_table + (24) * 8) + 12)(CTX));\n\n\tenc_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 24);\n\n\tjmp .Lenc_done;\nSYM_FUNC_END(__camellia_enc_blk32)\n\nSYM_FUNC_START_LOCAL(__camellia_dec_blk32)\n\t \n\tFRAME_BEGIN\n\n\tleaq 8 * 32(%rax), %rcx;\n\n\tinpack32_post(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t      %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t      %ymm15, %rax, %rcx);\n\n\tcmpl $32, %r8d;\n\tje .Ldec_max32;\n\n.Ldec_max24:\n\tdec_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 16);\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (16) * 8) + 8)(CTX),\n\t      ((key_table + (16) * 8) + 12)(CTX),\n\t      ((key_table + (16) * 8) + 0)(CTX),\n\t      ((key_table + (16) * 8) + 4)(CTX));\n\n\tdec_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 8);\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (8) * 8) + 8)(CTX),\n\t      ((key_table + (8) * 8) + 12)(CTX),\n\t      ((key_table + (8) * 8) + 0)(CTX),\n\t      ((key_table + (8) * 8) + 4)(CTX));\n\n\tdec_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 0);\n\n\t \n\tvmovdqu 0 * 32(%rcx), %ymm8;\n\tvmovdqu 1 * 32(%rcx), %ymm9;\n\tvmovdqu 2 * 32(%rcx), %ymm10;\n\tvmovdqu 3 * 32(%rcx), %ymm11;\n\tvmovdqu 4 * 32(%rcx), %ymm12;\n\tvmovdqu 5 * 32(%rcx), %ymm13;\n\tvmovdqu 6 * 32(%rcx), %ymm14;\n\tvmovdqu 7 * 32(%rcx), %ymm15;\n\n\toutunpack32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t    %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t    %ymm15, (key_table)(CTX), (%rax), 1 * 32(%rax));\n\n\tFRAME_END\n\tRET;\n\n.align 8\n.Ldec_max32:\n\tdec_rounds32(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rax, %rcx, 24);\n\n\tfls32(%rax, %ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t      %rcx, %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t      %ymm15,\n\t      ((key_table + (24) * 8) + 8)(CTX),\n\t      ((key_table + (24) * 8) + 12)(CTX),\n\t      ((key_table + (24) * 8) + 0)(CTX),\n\t      ((key_table + (24) * 8) + 4)(CTX));\n\n\tjmp .Ldec_max24;\nSYM_FUNC_END(__camellia_dec_blk32)\n\nSYM_FUNC_START(camellia_ecb_enc_32way)\n\t \n\tFRAME_BEGIN\n\n\tvzeroupper;\n\n\tinpack32_pre(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rdx, (key_table)(CTX));\n\n\t \n\tmovq\t%rsi, %rax;\n\n\tcall __camellia_enc_blk32;\n\n\twrite_output(%ymm7, %ymm6, %ymm5, %ymm4, %ymm3, %ymm2, %ymm1, %ymm0,\n\t\t     %ymm15, %ymm14, %ymm13, %ymm12, %ymm11, %ymm10, %ymm9,\n\t\t     %ymm8, %rsi);\n\n\tvzeroupper;\n\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(camellia_ecb_enc_32way)\n\nSYM_FUNC_START(camellia_ecb_dec_32way)\n\t \n\tFRAME_BEGIN\n\n\tvzeroupper;\n\n\tcmpl $16, key_length(CTX);\n\tmovl $32, %r8d;\n\tmovl $24, %eax;\n\tcmovel %eax, %r8d;  \n\n\tinpack32_pre(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rdx, (key_table)(CTX, %r8, 8));\n\n\t \n\tmovq\t%rsi, %rax;\n\n\tcall __camellia_dec_blk32;\n\n\twrite_output(%ymm7, %ymm6, %ymm5, %ymm4, %ymm3, %ymm2, %ymm1, %ymm0,\n\t\t     %ymm15, %ymm14, %ymm13, %ymm12, %ymm11, %ymm10, %ymm9,\n\t\t     %ymm8, %rsi);\n\n\tvzeroupper;\n\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(camellia_ecb_dec_32way)\n\nSYM_FUNC_START(camellia_cbc_dec_32way)\n\t \n\tFRAME_BEGIN\n\tsubq $(16 * 32), %rsp;\n\n\tvzeroupper;\n\n\tcmpl $16, key_length(CTX);\n\tmovl $32, %r8d;\n\tmovl $24, %eax;\n\tcmovel %eax, %r8d;  \n\n\tinpack32_pre(%ymm0, %ymm1, %ymm2, %ymm3, %ymm4, %ymm5, %ymm6, %ymm7,\n\t\t     %ymm8, %ymm9, %ymm10, %ymm11, %ymm12, %ymm13, %ymm14,\n\t\t     %ymm15, %rdx, (key_table)(CTX, %r8, 8));\n\n\tcmpq %rsi, %rdx;\n\tje .Lcbc_dec_use_stack;\n\n\t \n\tmovq %rsi, %rax;\n\tjmp .Lcbc_dec_continue;\n\n.Lcbc_dec_use_stack:\n\t \n\tmovq %rsp, %rax;\n\n.Lcbc_dec_continue:\n\tcall __camellia_dec_blk32;\n\n\tvmovdqu %ymm7, (%rax);\n\tvpxor %ymm7, %ymm7, %ymm7;\n\tvinserti128 $1, (%rdx), %ymm7, %ymm7;\n\tvpxor (%rax), %ymm7, %ymm7;\n\tvpxor (0 * 32 + 16)(%rdx), %ymm6, %ymm6;\n\tvpxor (1 * 32 + 16)(%rdx), %ymm5, %ymm5;\n\tvpxor (2 * 32 + 16)(%rdx), %ymm4, %ymm4;\n\tvpxor (3 * 32 + 16)(%rdx), %ymm3, %ymm3;\n\tvpxor (4 * 32 + 16)(%rdx), %ymm2, %ymm2;\n\tvpxor (5 * 32 + 16)(%rdx), %ymm1, %ymm1;\n\tvpxor (6 * 32 + 16)(%rdx), %ymm0, %ymm0;\n\tvpxor (7 * 32 + 16)(%rdx), %ymm15, %ymm15;\n\tvpxor (8 * 32 + 16)(%rdx), %ymm14, %ymm14;\n\tvpxor (9 * 32 + 16)(%rdx), %ymm13, %ymm13;\n\tvpxor (10 * 32 + 16)(%rdx), %ymm12, %ymm12;\n\tvpxor (11 * 32 + 16)(%rdx), %ymm11, %ymm11;\n\tvpxor (12 * 32 + 16)(%rdx), %ymm10, %ymm10;\n\tvpxor (13 * 32 + 16)(%rdx), %ymm9, %ymm9;\n\tvpxor (14 * 32 + 16)(%rdx), %ymm8, %ymm8;\n\twrite_output(%ymm7, %ymm6, %ymm5, %ymm4, %ymm3, %ymm2, %ymm1, %ymm0,\n\t\t     %ymm15, %ymm14, %ymm13, %ymm12, %ymm11, %ymm10, %ymm9,\n\t\t     %ymm8, %rsi);\n\n\tvzeroupper;\n\n\taddq $(16 * 32), %rsp;\n\tFRAME_END\n\tRET;\nSYM_FUNC_END(camellia_cbc_dec_32way)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}