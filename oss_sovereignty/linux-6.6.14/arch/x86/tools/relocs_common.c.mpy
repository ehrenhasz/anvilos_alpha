{
  "module_name": "relocs_common.c",
  "hash_id": "189ad736fb98d0e331e680f9e00abd23e564e9d46633bd52ac80b6bb907b7dca",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/tools/relocs_common.c",
  "human_readable_source": "\n#include \"relocs.h\"\n\nvoid die(char *fmt, ...)\n{\n\tva_list ap;\n\tva_start(ap, fmt);\n\tvfprintf(stderr, fmt, ap);\n\tva_end(ap);\n\texit(1);\n}\n\nstatic void usage(void)\n{\n\tdie(\"relocs [--abs-syms|--abs-relocs|--reloc-info|--text|--realmode]\" \\\n\t    \" vmlinux\\n\");\n}\n\nint main(int argc, char **argv)\n{\n\tint show_absolute_syms, show_absolute_relocs, show_reloc_info;\n\tint as_text, use_real_mode;\n\tconst char *fname;\n\tFILE *fp;\n\tint i;\n\tunsigned char e_ident[EI_NIDENT];\n\n\tshow_absolute_syms = 0;\n\tshow_absolute_relocs = 0;\n\tshow_reloc_info = 0;\n\tas_text = 0;\n\tuse_real_mode = 0;\n\tfname = NULL;\n\tfor (i = 1; i < argc; i++) {\n\t\tchar *arg = argv[i];\n\t\tif (*arg == '-') {\n\t\t\tif (strcmp(arg, \"--abs-syms\") == 0) {\n\t\t\t\tshow_absolute_syms = 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (strcmp(arg, \"--abs-relocs\") == 0) {\n\t\t\t\tshow_absolute_relocs = 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (strcmp(arg, \"--reloc-info\") == 0) {\n\t\t\t\tshow_reloc_info = 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (strcmp(arg, \"--text\") == 0) {\n\t\t\t\tas_text = 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (strcmp(arg, \"--realmode\") == 0) {\n\t\t\t\tuse_real_mode = 1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse if (!fname) {\n\t\t\tfname = arg;\n\t\t\tcontinue;\n\t\t}\n\t\tusage();\n\t}\n\tif (!fname) {\n\t\tusage();\n\t}\n\tfp = fopen(fname, \"r\");\n\tif (!fp) {\n\t\tdie(\"Cannot open %s: %s\\n\", fname, strerror(errno));\n\t}\n\tif (fread(&e_ident, 1, EI_NIDENT, fp) != EI_NIDENT) {\n\t\tdie(\"Cannot read %s: %s\", fname, strerror(errno));\n\t}\n\trewind(fp);\n\tif (e_ident[EI_CLASS] == ELFCLASS64)\n\t\tprocess_64(fp, use_real_mode, as_text,\n\t\t\t   show_absolute_syms, show_absolute_relocs,\n\t\t\t   show_reloc_info);\n\telse\n\t\tprocess_32(fp, use_real_mode, as_text,\n\t\t\t   show_absolute_syms, show_absolute_relocs,\n\t\t\t   show_reloc_info);\n\tfclose(fp);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}