{
  "module_name": "copy_mc.c",
  "hash_id": "e3c07332839599275c65b68d7ac5111443d9d227d2d11cf3c0ef56eca093a957",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/lib/copy_mc.c",
  "human_readable_source": "\n \n\n#include <linux/jump_label.h>\n#include <linux/uaccess.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/types.h>\n\n#include <asm/mce.h>\n\n#ifdef CONFIG_X86_MCE\nstatic DEFINE_STATIC_KEY_FALSE(copy_mc_fragile_key);\n\nvoid enable_copy_mc_fragile(void)\n{\n\tstatic_branch_inc(&copy_mc_fragile_key);\n}\n#define copy_mc_fragile_enabled (static_branch_unlikely(&copy_mc_fragile_key))\n\n \n__visible notrace unsigned long\ncopy_mc_fragile_handle_tail(char *to, char *from, unsigned len)\n{\n\tfor (; len; --len, to++, from++)\n\t\tif (copy_mc_fragile(to, from, 1))\n\t\t\tbreak;\n\treturn len;\n}\n#else\n \nvoid enable_copy_mc_fragile(void)\n{\n}\n#define copy_mc_fragile_enabled (0)\n#endif\n\nunsigned long copy_mc_enhanced_fast_string(void *dst, const void *src, unsigned len);\n\n \nunsigned long __must_check copy_mc_to_kernel(void *dst, const void *src, unsigned len)\n{\n\tif (copy_mc_fragile_enabled)\n\t\treturn copy_mc_fragile(dst, src, len);\n\tif (static_cpu_has(X86_FEATURE_ERMS))\n\t\treturn copy_mc_enhanced_fast_string(dst, src, len);\n\tmemcpy(dst, src, len);\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(copy_mc_to_kernel);\n\nunsigned long __must_check copy_mc_to_user(void __user *dst, const void *src, unsigned len)\n{\n\tunsigned long ret;\n\n\tif (copy_mc_fragile_enabled) {\n\t\t__uaccess_begin();\n\t\tret = copy_mc_fragile((__force void *)dst, src, len);\n\t\t__uaccess_end();\n\t\treturn ret;\n\t}\n\n\tif (static_cpu_has(X86_FEATURE_ERMS)) {\n\t\t__uaccess_begin();\n\t\tret = copy_mc_enhanced_fast_string((__force void *)dst, src, len);\n\t\t__uaccess_end();\n\t\treturn ret;\n\t}\n\n\treturn copy_user_generic((__force void *)dst, src, len);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}