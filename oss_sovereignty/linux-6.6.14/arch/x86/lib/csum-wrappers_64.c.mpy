{
  "module_name": "csum-wrappers_64.c",
  "hash_id": "5c52fd259ab87743bc8a2aa7778e3a163c9b31ed8376a885d24838e571791919",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/lib/csum-wrappers_64.c",
  "human_readable_source": "\n \n#include <asm/checksum.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <asm/smap.h>\n\n \n__wsum\ncsum_and_copy_from_user(const void __user *src, void *dst, int len)\n{\n\t__wsum sum;\n\n\tmight_sleep();\n\tif (!user_access_begin(src, len))\n\t\treturn 0;\n\tsum = csum_partial_copy_generic((__force const void *)src, dst, len);\n\tuser_access_end();\n\treturn sum;\n}\n\n \n__wsum\ncsum_and_copy_to_user(const void *src, void __user *dst, int len)\n{\n\t__wsum sum;\n\n\tmight_sleep();\n\tif (!user_access_begin(dst, len))\n\t\treturn 0;\n\tsum = csum_partial_copy_generic(src, (void __force *)dst, len);\n\tuser_access_end();\n\treturn sum;\n}\n\n \n__wsum\ncsum_partial_copy_nocheck(const void *src, void *dst, int len)\n{\n\treturn csum_partial_copy_generic(src, dst, len);\n}\nEXPORT_SYMBOL(csum_partial_copy_nocheck);\n\n__sum16 csum_ipv6_magic(const struct in6_addr *saddr,\n\t\t\tconst struct in6_addr *daddr,\n\t\t\t__u32 len, __u8 proto, __wsum sum)\n{\n\t__u64 rest, sum64;\n\n\trest = (__force __u64)htonl(len) + (__force __u64)htons(proto) +\n\t\t(__force __u64)sum;\n\n\tasm(\"\taddq (%[saddr]),%[sum]\\n\"\n\t    \"\tadcq 8(%[saddr]),%[sum]\\n\"\n\t    \"\tadcq (%[daddr]),%[sum]\\n\"\n\t    \"\tadcq 8(%[daddr]),%[sum]\\n\"\n\t    \"\tadcq $0,%[sum]\\n\"\n\n\t    : [sum] \"=r\" (sum64)\n\t    : \"[sum]\" (rest), [saddr] \"r\" (saddr), [daddr] \"r\" (daddr));\n\n\treturn csum_fold(\n\t       (__force __wsum)add32_with_carry(sum64 & 0xffffffff, sum64>>32));\n}\nEXPORT_SYMBOL(csum_ipv6_magic);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}