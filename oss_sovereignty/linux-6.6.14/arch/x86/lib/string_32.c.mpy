{
  "module_name": "string_32.c",
  "hash_id": "18ec3f4f29bf4d61c68e7b299033b207c57e933139bcfa3dc3cec9d8298d2e38",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/lib/string_32.c",
  "human_readable_source": "\n \n\n#define __NO_FORTIFY\n#include <linux/string.h>\n#include <linux/export.h>\n\n#ifdef __HAVE_ARCH_STRCPY\nchar *strcpy(char *dest, const char *src)\n{\n\tint d0, d1, d2;\n\tasm volatile(\"1:\\tlodsb\\n\\t\"\n\t\t\"stosb\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\"\n\t\t: \"=&S\" (d0), \"=&D\" (d1), \"=&a\" (d2)\n\t\t: \"0\" (src), \"1\" (dest) : \"memory\");\n\treturn dest;\n}\nEXPORT_SYMBOL(strcpy);\n#endif\n\n#ifdef __HAVE_ARCH_STRNCPY\nchar *strncpy(char *dest, const char *src, size_t count)\n{\n\tint d0, d1, d2, d3;\n\tasm volatile(\"1:\\tdecl %2\\n\\t\"\n\t\t\"js 2f\\n\\t\"\n\t\t\"lodsb\\n\\t\"\n\t\t\"stosb\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\\n\\t\"\n\t\t\"rep\\n\\t\"\n\t\t\"stosb\\n\"\n\t\t\"2:\"\n\t\t: \"=&S\" (d0), \"=&D\" (d1), \"=&c\" (d2), \"=&a\" (d3)\n\t\t: \"0\" (src), \"1\" (dest), \"2\" (count) : \"memory\");\n\treturn dest;\n}\nEXPORT_SYMBOL(strncpy);\n#endif\n\n#ifdef __HAVE_ARCH_STRCAT\nchar *strcat(char *dest, const char *src)\n{\n\tint d0, d1, d2, d3;\n\tasm volatile(\"repne\\n\\t\"\n\t\t\"scasb\\n\\t\"\n\t\t\"decl %1\\n\"\n\t\t\"1:\\tlodsb\\n\\t\"\n\t\t\"stosb\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\"\n\t\t: \"=&S\" (d0), \"=&D\" (d1), \"=&a\" (d2), \"=&c\" (d3)\n\t\t: \"0\" (src), \"1\" (dest), \"2\" (0), \"3\" (0xffffffffu) : \"memory\");\n\treturn dest;\n}\nEXPORT_SYMBOL(strcat);\n#endif\n\n#ifdef __HAVE_ARCH_STRNCAT\nchar *strncat(char *dest, const char *src, size_t count)\n{\n\tint d0, d1, d2, d3;\n\tasm volatile(\"repne\\n\\t\"\n\t\t\"scasb\\n\\t\"\n\t\t\"decl %1\\n\\t\"\n\t\t\"movl %8,%3\\n\"\n\t\t\"1:\\tdecl %3\\n\\t\"\n\t\t\"js 2f\\n\\t\"\n\t\t\"lodsb\\n\\t\"\n\t\t\"stosb\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\\n\"\n\t\t\"2:\\txorl %2,%2\\n\\t\"\n\t\t\"stosb\"\n\t\t: \"=&S\" (d0), \"=&D\" (d1), \"=&a\" (d2), \"=&c\" (d3)\n\t\t: \"0\" (src), \"1\" (dest), \"2\" (0), \"3\" (0xffffffffu), \"g\" (count)\n\t\t: \"memory\");\n\treturn dest;\n}\nEXPORT_SYMBOL(strncat);\n#endif\n\n#ifdef __HAVE_ARCH_STRCMP\nint strcmp(const char *cs, const char *ct)\n{\n\tint d0, d1;\n\tint res;\n\tasm volatile(\"1:\\tlodsb\\n\\t\"\n\t\t\"scasb\\n\\t\"\n\t\t\"jne 2f\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\\n\\t\"\n\t\t\"xorl %%eax,%%eax\\n\\t\"\n\t\t\"jmp 3f\\n\"\n\t\t\"2:\\tsbbl %%eax,%%eax\\n\\t\"\n\t\t\"orb $1,%%al\\n\"\n\t\t\"3:\"\n\t\t: \"=a\" (res), \"=&S\" (d0), \"=&D\" (d1)\n\t\t: \"1\" (cs), \"2\" (ct)\n\t\t: \"memory\");\n\treturn res;\n}\nEXPORT_SYMBOL(strcmp);\n#endif\n\n#ifdef __HAVE_ARCH_STRNCMP\nint strncmp(const char *cs, const char *ct, size_t count)\n{\n\tint res;\n\tint d0, d1, d2;\n\tasm volatile(\"1:\\tdecl %3\\n\\t\"\n\t\t\"js 2f\\n\\t\"\n\t\t\"lodsb\\n\\t\"\n\t\t\"scasb\\n\\t\"\n\t\t\"jne 3f\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\\n\"\n\t\t\"2:\\txorl %%eax,%%eax\\n\\t\"\n\t\t\"jmp 4f\\n\"\n\t\t\"3:\\tsbbl %%eax,%%eax\\n\\t\"\n\t\t\"orb $1,%%al\\n\"\n\t\t\"4:\"\n\t\t: \"=a\" (res), \"=&S\" (d0), \"=&D\" (d1), \"=&c\" (d2)\n\t\t: \"1\" (cs), \"2\" (ct), \"3\" (count)\n\t\t: \"memory\");\n\treturn res;\n}\nEXPORT_SYMBOL(strncmp);\n#endif\n\n#ifdef __HAVE_ARCH_STRCHR\nchar *strchr(const char *s, int c)\n{\n\tint d0;\n\tchar *res;\n\tasm volatile(\"movb %%al,%%ah\\n\"\n\t\t\"1:\\tlodsb\\n\\t\"\n\t\t\"cmpb %%ah,%%al\\n\\t\"\n\t\t\"je 2f\\n\\t\"\n\t\t\"testb %%al,%%al\\n\\t\"\n\t\t\"jne 1b\\n\\t\"\n\t\t\"movl $1,%1\\n\"\n\t\t\"2:\\tmovl %1,%0\\n\\t\"\n\t\t\"decl %0\"\n\t\t: \"=a\" (res), \"=&S\" (d0)\n\t\t: \"1\" (s), \"0\" (c)\n\t\t: \"memory\");\n\treturn res;\n}\nEXPORT_SYMBOL(strchr);\n#endif\n\n#ifdef __HAVE_ARCH_STRLEN\nsize_t strlen(const char *s)\n{\n\tint d0;\n\tsize_t res;\n\tasm volatile(\"repne\\n\\t\"\n\t\t\"scasb\"\n\t\t: \"=c\" (res), \"=&D\" (d0)\n\t\t: \"1\" (s), \"a\" (0), \"0\" (0xffffffffu)\n\t\t: \"memory\");\n\treturn ~res - 1;\n}\nEXPORT_SYMBOL(strlen);\n#endif\n\n#ifdef __HAVE_ARCH_MEMCHR\nvoid *memchr(const void *cs, int c, size_t count)\n{\n\tint d0;\n\tvoid *res;\n\tif (!count)\n\t\treturn NULL;\n\tasm volatile(\"repne\\n\\t\"\n\t\t\"scasb\\n\\t\"\n\t\t\"je 1f\\n\\t\"\n\t\t\"movl $1,%0\\n\"\n\t\t\"1:\\tdecl %0\"\n\t\t: \"=D\" (res), \"=&c\" (d0)\n\t\t: \"a\" (c), \"0\" (cs), \"1\" (count)\n\t\t: \"memory\");\n\treturn res;\n}\nEXPORT_SYMBOL(memchr);\n#endif\n\n#ifdef __HAVE_ARCH_MEMSCAN\nvoid *memscan(void *addr, int c, size_t size)\n{\n\tif (!size)\n\t\treturn addr;\n\tasm volatile(\"repnz; scasb\\n\\t\"\n\t    \"jnz 1f\\n\\t\"\n\t    \"dec %%edi\\n\"\n\t    \"1:\"\n\t    : \"=D\" (addr), \"=c\" (size)\n\t    : \"0\" (addr), \"1\" (size), \"a\" (c)\n\t    : \"memory\");\n\treturn addr;\n}\nEXPORT_SYMBOL(memscan);\n#endif\n\n#ifdef __HAVE_ARCH_STRNLEN\nsize_t strnlen(const char *s, size_t count)\n{\n\tint d0;\n\tint res;\n\tasm volatile(\"movl %2,%0\\n\\t\"\n\t\t\"jmp 2f\\n\"\n\t\t\"1:\\tcmpb $0,(%0)\\n\\t\"\n\t\t\"je 3f\\n\\t\"\n\t\t\"incl %0\\n\"\n\t\t\"2:\\tdecl %1\\n\\t\"\n\t\t\"cmpl $-1,%1\\n\\t\"\n\t\t\"jne 1b\\n\"\n\t\t\"3:\\tsubl %2,%0\"\n\t\t: \"=a\" (res), \"=&d\" (d0)\n\t\t: \"c\" (s), \"1\" (count)\n\t\t: \"memory\");\n\treturn res;\n}\nEXPORT_SYMBOL(strnlen);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}