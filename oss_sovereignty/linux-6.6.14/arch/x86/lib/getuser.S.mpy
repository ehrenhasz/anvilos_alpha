{
  "module_name": "getuser.S",
  "hash_id": "6de5401872c0c2b1fda38b91b364edf103ee4844054446086f6e9244a4291a25",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/lib/getuser.S",
  "human_readable_source": " \n \n\n \n\n#include <linux/linkage.h>\n#include <asm/page_types.h>\n#include <asm/errno.h>\n#include <asm/asm-offsets.h>\n#include <asm/thread_info.h>\n#include <asm/asm.h>\n#include <asm/smap.h>\n#include <asm/export.h>\n\n#define ASM_BARRIER_NOSPEC ALTERNATIVE \"\", \"lfence\", X86_FEATURE_LFENCE_RDTSC\n\n.macro check_range size:req\n.if IS_ENABLED(CONFIG_X86_64)\n\tmov %rax, %rdx\n\tsar $63, %rdx\n\tor %rdx, %rax\n.else\n\tcmp $TASK_SIZE_MAX-\\size+1, %eax\n\tjae .Lbad_get_user\n\tsbb %edx, %edx\t\t \n\tand %edx, %eax\n.endif\n.endm\n\n\t.text\nSYM_FUNC_START(__get_user_1)\n\tcheck_range size=1\n\tASM_STAC\n1:\tmovzbl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_1)\nEXPORT_SYMBOL(__get_user_1)\n\nSYM_FUNC_START(__get_user_2)\n\tcheck_range size=2\n\tASM_STAC\n2:\tmovzwl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_2)\nEXPORT_SYMBOL(__get_user_2)\n\nSYM_FUNC_START(__get_user_4)\n\tcheck_range size=4\n\tASM_STAC\n3:\tmovl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_4)\nEXPORT_SYMBOL(__get_user_4)\n\nSYM_FUNC_START(__get_user_8)\n\tcheck_range size=8\n\tASM_STAC\n#ifdef CONFIG_X86_64\n4:\tmovq (%_ASM_AX),%rdx\n#else\n4:\tmovl (%_ASM_AX),%edx\n5:\tmovl 4(%_ASM_AX),%ecx\n#endif\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_8)\nEXPORT_SYMBOL(__get_user_8)\n\n \nSYM_FUNC_START(__get_user_nocheck_1)\n\tASM_STAC\n\tASM_BARRIER_NOSPEC\n6:\tmovzbl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_nocheck_1)\nEXPORT_SYMBOL(__get_user_nocheck_1)\n\nSYM_FUNC_START(__get_user_nocheck_2)\n\tASM_STAC\n\tASM_BARRIER_NOSPEC\n7:\tmovzwl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_nocheck_2)\nEXPORT_SYMBOL(__get_user_nocheck_2)\n\nSYM_FUNC_START(__get_user_nocheck_4)\n\tASM_STAC\n\tASM_BARRIER_NOSPEC\n8:\tmovl (%_ASM_AX),%edx\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_nocheck_4)\nEXPORT_SYMBOL(__get_user_nocheck_4)\n\nSYM_FUNC_START(__get_user_nocheck_8)\n\tASM_STAC\n\tASM_BARRIER_NOSPEC\n#ifdef CONFIG_X86_64\n9:\tmovq (%_ASM_AX),%rdx\n#else\n9:\tmovl (%_ASM_AX),%edx\n10:\tmovl 4(%_ASM_AX),%ecx\n#endif\n\txor %eax,%eax\n\tASM_CLAC\n\tRET\nSYM_FUNC_END(__get_user_nocheck_8)\nEXPORT_SYMBOL(__get_user_nocheck_8)\n\n\nSYM_CODE_START_LOCAL(__get_user_handle_exception)\n\tASM_CLAC\n.Lbad_get_user:\n\txor %edx,%edx\n\tmov $(-EFAULT),%_ASM_AX\n\tRET\nSYM_CODE_END(__get_user_handle_exception)\n\n#ifdef CONFIG_X86_32\nSYM_CODE_START_LOCAL(__get_user_8_handle_exception)\n\tASM_CLAC\nbad_get_user_8:\n\txor %edx,%edx\n\txor %ecx,%ecx\n\tmov $(-EFAULT),%_ASM_AX\n\tRET\nSYM_CODE_END(__get_user_8_handle_exception)\n#endif\n\n \n\t_ASM_EXTABLE(1b, __get_user_handle_exception)\n\t_ASM_EXTABLE(2b, __get_user_handle_exception)\n\t_ASM_EXTABLE(3b, __get_user_handle_exception)\n#ifdef CONFIG_X86_64\n\t_ASM_EXTABLE(4b, __get_user_handle_exception)\n#else\n\t_ASM_EXTABLE(4b, __get_user_8_handle_exception)\n\t_ASM_EXTABLE(5b, __get_user_8_handle_exception)\n#endif\n\n \n\t_ASM_EXTABLE(6b, __get_user_handle_exception)\n\t_ASM_EXTABLE(7b, __get_user_handle_exception)\n\t_ASM_EXTABLE(8b, __get_user_handle_exception)\n#ifdef CONFIG_X86_64\n\t_ASM_EXTABLE(9b, __get_user_handle_exception)\n#else\n\t_ASM_EXTABLE(9b, __get_user_8_handle_exception)\n\t_ASM_EXTABLE(10b, __get_user_8_handle_exception)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}