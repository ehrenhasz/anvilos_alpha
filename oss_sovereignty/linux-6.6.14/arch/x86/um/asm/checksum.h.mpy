{
  "module_name": "checksum.h",
  "hash_id": "b14215f1e64e69fd229448ca497697e89b624cdea4ad4741e41c331d98ba58a8",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/um/asm/checksum.h",
  "human_readable_source": " \n#ifndef __UM_CHECKSUM_H\n#define __UM_CHECKSUM_H\n\n#include <linux/string.h>\n#include <linux/in6.h>\n#include <linux/uaccess.h>\n\n \nextern __wsum csum_partial(const void *buff, int len, __wsum sum);\n\n \nstatic inline __sum16 csum_fold(__wsum sum)\n{\n\t__asm__(\n\t\t\"  addl %1,%0\\n\"\n\t\t\"  adcl $0xffff,%0\"\n\t\t: \"=r\" (sum)\n\t\t: \"r\" ((__force u32)sum << 16),\n\t\t  \"0\" ((__force u32)sum & 0xffff0000)\n\t);\n\treturn (__force __sum16)(~(__force u32)sum >> 16);\n}\n\n \nstatic inline __wsum\ncsum_tcpudp_nofold(__be32 saddr, __be32 daddr, __u32 len,\n\t\t  __u8 proto, __wsum sum)\n{\n\tasm(\"  addl %1, %0\\n\"\n\t    \"  adcl %2, %0\\n\"\n\t    \"  adcl %3, %0\\n\"\n\t    \"  adcl $0, %0\\n\"\n\t\t: \"=r\" (sum)\n\t    : \"g\" (daddr), \"g\" (saddr), \"g\" ((len + proto) << 8), \"0\" (sum));\n\treturn sum;\n}\n\n \nstatic inline __sum16 csum_tcpudp_magic(__be32 saddr, __be32 daddr,\n\t\t\t\t\t__u32 len, __u8 proto,\n\t\t\t\t\t__wsum sum)\n{\n\treturn csum_fold(csum_tcpudp_nofold(saddr,daddr,len,proto,sum));\n}\n\n \nstatic inline __sum16 ip_fast_csum(const void *iph, unsigned int ihl)\n{\n\tunsigned int sum;\n\n\tasm(\t\"  movl (%1), %0\\n\"\n\t\t\"  subl $4, %2\\n\"\n\t\t\"  jbe 2f\\n\"\n\t\t\"  addl 4(%1), %0\\n\"\n\t\t\"  adcl 8(%1), %0\\n\"\n\t\t\"  adcl 12(%1), %0\\n\"\n\t\t\"1: adcl 16(%1), %0\\n\"\n\t\t\"  lea 4(%1), %1\\n\"\n\t\t\"  decl %2\\n\"\n\t\t\"  jne\t1b\\n\"\n\t\t\"  adcl $0, %0\\n\"\n\t\t\"  movl %0, %2\\n\"\n\t\t\"  shrl $16, %0\\n\"\n\t\t\"  addw %w2, %w0\\n\"\n\t\t\"  adcl $0, %0\\n\"\n\t\t\"  notl %0\\n\"\n\t\t\"2:\"\n\t \n\t: \"=r\" (sum), \"=r\" (iph), \"=r\" (ihl)\n\t: \"1\" (iph), \"2\" (ihl)\n\t: \"memory\");\n\treturn (__force __sum16)sum;\n}\n\n#ifdef CONFIG_X86_32\n# include \"checksum_32.h\"\n#else\n# include \"checksum_64.h\"\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}