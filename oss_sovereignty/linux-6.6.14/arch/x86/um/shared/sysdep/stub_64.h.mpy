{
  "module_name": "stub_64.h",
  "hash_id": "ac89814b45c120322154162eccdc10eba010a83fc87e0599ee95ac04f4944848",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/um/shared/sysdep/stub_64.h",
  "human_readable_source": " \n\n#ifndef __SYSDEP_STUB_H\n#define __SYSDEP_STUB_H\n\n#include <sysdep/ptrace_user.h>\n#include <generated/asm-offsets.h>\n#include <linux/stddef.h>\n\n#define STUB_MMAP_NR __NR_mmap\n#define MMAP_OFFSET(o) (o)\n\n#define __syscall_clobber \"r11\",\"rcx\",\"memory\"\n#define __syscall \"syscall\"\n\nstatic inline long stub_syscall0(long syscall)\n{\n\tlong ret;\n\n\t__asm__ volatile (__syscall\n\t\t: \"=a\" (ret)\n\t\t: \"0\" (syscall) : __syscall_clobber );\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall2(long syscall, long arg1, long arg2)\n{\n\tlong ret;\n\n\t__asm__ volatile (__syscall\n\t\t: \"=a\" (ret)\n\t\t: \"0\" (syscall), \"D\" (arg1), \"S\" (arg2) : __syscall_clobber );\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall3(long syscall, long arg1, long arg2, long arg3)\n{\n\tlong ret;\n\n\t__asm__ volatile (__syscall\n\t\t: \"=a\" (ret)\n\t\t: \"0\" (syscall), \"D\" (arg1), \"S\" (arg2), \"d\" (arg3)\n\t\t: __syscall_clobber );\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall4(long syscall, long arg1, long arg2, long arg3,\n\t\t\t\t long arg4)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"movq %5,%%r10 ; \" __syscall\n\t\t: \"=a\" (ret)\n\t\t: \"0\" (syscall), \"D\" (arg1), \"S\" (arg2), \"d\" (arg3),\n\t\t  \"g\" (arg4)\n\t\t: __syscall_clobber, \"r10\" );\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall5(long syscall, long arg1, long arg2, long arg3,\n\t\t\t\t long arg4, long arg5)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"movq %5,%%r10 ; movq %6,%%r8 ; \" __syscall\n\t\t: \"=a\" (ret)\n\t\t: \"0\" (syscall), \"D\" (arg1), \"S\" (arg2), \"d\" (arg3),\n\t\t  \"g\" (arg4), \"g\" (arg5)\n\t\t: __syscall_clobber, \"r10\", \"r8\" );\n\n\treturn ret;\n}\n\nstatic inline void trap_myself(void)\n{\n\t__asm(\"int3\");\n}\n\nstatic inline void remap_stack_and_trap(void)\n{\n\t__asm__ volatile (\n\t\t\"movq %0,%%rax ;\"\n\t\t\"movq %%rsp,%%rdi ;\"\n\t\t\"andq %1,%%rdi ;\"\n\t\t\"movq %2,%%r10 ;\"\n\t\t\"movq %%rdi,%%r8 ; addq %3,%%r8 ; movq (%%r8),%%r8 ;\"\n\t\t\"movq %%rdi,%%r9 ; addq %4,%%r9 ; movq (%%r9),%%r9 ;\"\n\t\t__syscall \";\"\n\t\t\"movq %%rsp,%%rdi ; andq %1,%%rdi ;\"\n\t\t\"addq %5,%%rdi ; movq %%rax, (%%rdi) ;\"\n\t\t\"int3\"\n\t\t: :\n\t\t\"g\" (STUB_MMAP_NR),\n\t\t\"g\" (~(STUB_DATA_PAGES * UM_KERN_PAGE_SIZE - 1)),\n\t\t\"g\" (MAP_FIXED | MAP_SHARED),\n\t\t\"g\" (UML_STUB_FIELD_FD),\n\t\t\"g\" (UML_STUB_FIELD_OFFSET),\n\t\t\"g\" (UML_STUB_FIELD_CHILD_ERR),\n\t\t\"S\" (STUB_DATA_PAGES * UM_KERN_PAGE_SIZE),\n\t\t\"d\" (PROT_READ | PROT_WRITE)\n\t\t:\n\t\t__syscall_clobber, \"r10\", \"r8\", \"r9\");\n}\n\nstatic __always_inline void *get_stub_data(void)\n{\n\tunsigned long ret;\n\n\tasm volatile (\n\t\t\"movq %%rsp,%0 ;\"\n\t\t\"andq %1,%0\"\n\t\t: \"=a\" (ret)\n\t\t: \"g\" (~(STUB_DATA_PAGES * UM_KERN_PAGE_SIZE - 1)));\n\n\treturn (void *)ret;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}