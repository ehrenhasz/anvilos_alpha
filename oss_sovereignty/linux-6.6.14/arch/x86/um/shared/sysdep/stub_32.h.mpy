{
  "module_name": "stub_32.h",
  "hash_id": "46220639a1333e762100859f80abe49cae2241f0cb2815b9cd9655f279a6127a",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/um/shared/sysdep/stub_32.h",
  "human_readable_source": " \n\n#ifndef __SYSDEP_STUB_H\n#define __SYSDEP_STUB_H\n\n#include <asm/ptrace.h>\n#include <generated/asm-offsets.h>\n\n#define STUB_MMAP_NR __NR_mmap2\n#define MMAP_OFFSET(o) ((o) >> UM_KERN_PAGE_SHIFT)\n\nstatic inline long stub_syscall0(long syscall)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall));\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall1(long syscall, long arg1)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall), \"b\" (arg1));\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall2(long syscall, long arg1, long arg2)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall), \"b\" (arg1),\n\t\t\t\"c\" (arg2));\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall3(long syscall, long arg1, long arg2, long arg3)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall), \"b\" (arg1),\n\t\t\t\"c\" (arg2), \"d\" (arg3));\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall4(long syscall, long arg1, long arg2, long arg3,\n\t\t\t\t long arg4)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall), \"b\" (arg1),\n\t\t\t\"c\" (arg2), \"d\" (arg3), \"S\" (arg4));\n\n\treturn ret;\n}\n\nstatic inline long stub_syscall5(long syscall, long arg1, long arg2, long arg3,\n\t\t\t\t long arg4, long arg5)\n{\n\tlong ret;\n\n\t__asm__ volatile (\"int $0x80\" : \"=a\" (ret) : \"0\" (syscall), \"b\" (arg1),\n\t\t\t\"c\" (arg2), \"d\" (arg3), \"S\" (arg4), \"D\" (arg5));\n\n\treturn ret;\n}\n\nstatic inline void trap_myself(void)\n{\n\t__asm(\"int3\");\n}\n\nstatic inline void remap_stack_and_trap(void)\n{\n\t__asm__ volatile (\n\t\t\"movl %%esp,%%ebx ;\"\n\t\t\"andl %0,%%ebx ;\"\n\t\t\"movl %1,%%eax ;\"\n\t\t\"movl %%ebx,%%edi ; addl %2,%%edi ; movl (%%edi),%%edi ;\"\n\t\t\"movl %%ebx,%%ebp ; addl %3,%%ebp ; movl (%%ebp),%%ebp ;\"\n\t\t\"int $0x80 ;\"\n\t\t\"addl %4,%%ebx ; movl %%eax, (%%ebx) ;\"\n\t\t\"int $3\"\n\t\t: :\n\t\t\"g\" (~(STUB_DATA_PAGES * UM_KERN_PAGE_SIZE - 1)),\n\t\t\"g\" (STUB_MMAP_NR),\n\t\t\"g\" (UML_STUB_FIELD_FD),\n\t\t\"g\" (UML_STUB_FIELD_OFFSET),\n\t\t\"g\" (UML_STUB_FIELD_CHILD_ERR),\n\t\t\"c\" (STUB_DATA_PAGES * UM_KERN_PAGE_SIZE),\n\t\t\"d\" (PROT_READ | PROT_WRITE),\n\t\t\"S\" (MAP_FIXED | MAP_SHARED)\n\t\t:\n\t\t\"memory\");\n}\n\nstatic __always_inline void *get_stub_data(void)\n{\n\tunsigned long ret;\n\n\tasm volatile (\n\t\t\"movl %%esp,%0 ;\"\n\t\t\"andl %1,%0\"\n\t\t: \"=a\" (ret)\n\t\t: \"g\" (~(STUB_DATA_PAGES * UM_KERN_PAGE_SIZE - 1)));\n\n\treturn (void *)ret;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}