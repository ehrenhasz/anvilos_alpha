{
  "module_name": "mcontext.c",
  "hash_id": "7433807e2eeab9fdfb6e8f2444a22be7a5485cdb09b5dc3289dc121f5d034f6e",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/um/os-Linux/mcontext.c",
  "human_readable_source": "\n#include <sys/ucontext.h>\n#define __FRAME_OFFSETS\n#include <asm/ptrace.h>\n#include <sysdep/ptrace.h>\n\nvoid get_regs_from_mc(struct uml_pt_regs *regs, mcontext_t *mc)\n{\n#ifdef __i386__\n#define COPY2(X,Y) regs->gp[X] = mc->gregs[REG_##Y]\n#define COPY(X) regs->gp[X] = mc->gregs[REG_##X]\n#define COPY_SEG(X) regs->gp[X] = mc->gregs[REG_##X] & 0xffff;\n#define COPY_SEG_CPL3(X) regs->gp[X] = (mc->gregs[REG_##X] & 0xffff) | 3;\n\tCOPY_SEG(GS); COPY_SEG(FS); COPY_SEG(ES); COPY_SEG(DS);\n\tCOPY(EDI); COPY(ESI); COPY(EBP);\n\tCOPY2(UESP, ESP);  \n\tCOPY(EBX); COPY(EDX); COPY(ECX); COPY(EAX);\n\tCOPY(EIP); COPY_SEG_CPL3(CS); COPY(EFL); COPY_SEG_CPL3(SS);\n#else\n#define COPY2(X,Y) regs->gp[X/sizeof(unsigned long)] = mc->gregs[REG_##Y]\n#define COPY(X) regs->gp[X/sizeof(unsigned long)] = mc->gregs[REG_##X]\n\tCOPY(R8); COPY(R9); COPY(R10); COPY(R11);\n\tCOPY(R12); COPY(R13); COPY(R14); COPY(R15);\n\tCOPY(RDI); COPY(RSI); COPY(RBP); COPY(RBX);\n\tCOPY(RDX); COPY(RAX); COPY(RCX); COPY(RSP);\n\tCOPY(RIP);\n\tCOPY2(EFLAGS, EFL);\n\tCOPY2(CS, CSGSFS);\n\tregs->gp[CS / sizeof(unsigned long)] &= 0xffff;\n\tregs->gp[CS / sizeof(unsigned long)] |= 3;\n#endif\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}