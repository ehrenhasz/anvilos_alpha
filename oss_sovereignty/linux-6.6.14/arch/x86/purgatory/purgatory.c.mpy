{
  "module_name": "purgatory.c",
  "hash_id": "b9a2c825c4408b4722726b5786a75c55ac46b031d181a320f4af11fd0c44bf87",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/purgatory/purgatory.c",
  "human_readable_source": "\n \n\n#include <linux/bug.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <crypto/sha2.h>\n#include <asm/purgatory.h>\n\n#include \"../boot/compressed/error.h\"\n#include \"../boot/string.h\"\n\nu8 purgatory_sha256_digest[SHA256_DIGEST_SIZE] __section(\".kexec-purgatory\");\n\nstruct kexec_sha_region purgatory_sha_regions[KEXEC_SEGMENT_MAX] __section(\".kexec-purgatory\");\n\nstatic int verify_sha256_digest(void)\n{\n\tstruct kexec_sha_region *ptr, *end;\n\tu8 digest[SHA256_DIGEST_SIZE];\n\tstruct sha256_state sctx;\n\n\tsha256_init(&sctx);\n\tend = purgatory_sha_regions + ARRAY_SIZE(purgatory_sha_regions);\n\n\tfor (ptr = purgatory_sha_regions; ptr < end; ptr++)\n\t\tsha256_update(&sctx, (uint8_t *)(ptr->start), ptr->len);\n\n\tsha256_final(&sctx, digest);\n\n\tif (memcmp(digest, purgatory_sha256_digest, sizeof(digest)))\n\t\treturn 1;\n\n\treturn 0;\n}\n\nvoid purgatory(void)\n{\n\tint ret;\n\n\tret = verify_sha256_digest();\n\tif (ret) {\n\t\t \n\t\tfor (;;)\n\t\t\t;\n\t}\n}\n\n \nvoid warn(const char *msg) {}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}