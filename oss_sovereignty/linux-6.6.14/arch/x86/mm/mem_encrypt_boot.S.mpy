{
  "module_name": "mem_encrypt_boot.S",
  "hash_id": "cd6090760c4f783513dcd7e9b3f16b8d61e34070f04f17bd1af5d480c15ff438",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/mm/mem_encrypt_boot.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <linux/pgtable.h>\n#include <asm/page.h>\n#include <asm/processor-flags.h>\n#include <asm/msr-index.h>\n#include <asm/nospec-branch.h>\n\n\t.text\n\t.code64\nSYM_FUNC_START(sme_encrypt_execute)\n\n\t \n\n\tpush\t%rbp\n\tmovq\t%rsp, %rbp\t\t \n\n\t \n\tmovq\t%rcx, %rax\t\t \n\tleaq\tPAGE_SIZE(%rax), %rsp\t \n\taddq\t$PAGE_SIZE, %rax\t \n\n\tpush\t%r12\n\tmovq\t%rdi, %r10\t\t \n\tmovq\t%rsi, %r11\t\t \n\tmovq\t%rdx, %r12\t\t \n\n\t \n\tmovq\t%rax, %rdi\t\t\t\t \n\tleaq\t__enc_copy(%rip), %rsi\t\t\t \n\tmovq\t$(.L__enc_copy_end - __enc_copy), %rcx\t \n\trep\tmovsb\n\n\t \n\tmovq\t%r10, %rdi\t\t \n\tmovq\t%r11, %rsi\t\t \n\tmovq\t%r8, %rdx\t\t \n\tmovq\t%r12, %rcx\t\t \n\tmovq\t%rax, %r8\t\t \n\taddq\t$PAGE_SIZE, %r8\t\t \n\n\tANNOTATE_RETPOLINE_SAFE\n\tcall\t*%rax\t\t\t \n\n\tpop\t%r12\n\n\tmovq\t%rbp, %rsp\t\t \n\tpop\t%rbp\n\n\t \n\tANNOTATE_UNRET_SAFE\n\tret\n\tint3\nSYM_FUNC_END(sme_encrypt_execute)\n\nSYM_FUNC_START(__enc_copy)\n \n\t \n\tmov\t%rdx, %cr3\n\n\t \n\tmov\t%cr4, %rdx\n\tandq\t$~X86_CR4_PGE, %rdx\n\tmov\t%rdx, %cr4\n\torq\t$X86_CR4_PGE, %rdx\n\tmov\t%rdx, %cr4\n\n\tpush\t%r15\n\tpush\t%r12\n\n\tmovq\t%rcx, %r9\t\t \n\tmovq\t%rdi, %r10\t\t \n\tmovq\t%rsi, %r11\t\t \n\n\t \n\tmovl\t$MSR_IA32_CR_PAT, %ecx\n\trdmsr\n\tmov\t%rdx, %r15\t\t \n\tandl\t$0xffff00ff, %edx\t \n\torl\t$0x00000500, %edx\t \n\twrmsr\n\n\twbinvd\t\t\t\t \n\n\t \n\tmovq\t$PMD_SIZE, %r12\n1:\n\tcmpq\t%r12, %r9\n\tjnb\t2f\n\tmovq\t%r9, %r12\n\n2:\n\tmovq\t%r11, %rsi\t\t \n\tmovq\t%r8, %rdi\t\t \n\tmovq\t%r12, %rcx\n\trep\tmovsb\n\n\tmovq\t%r8, %rsi\t\t \n\tmovq\t%r10, %rdi\t\t \n\tmovq\t%r12, %rcx\n\trep\tmovsb\n\n\taddq\t%r12, %r11\n\taddq\t%r12, %r10\n\tsubq\t%r12, %r9\t\t \n\tjnz\t1b\t\t\t \n\n\t \n\tmovl\t$MSR_IA32_CR_PAT, %ecx\n\trdmsr\n\tmov\t%r15, %rdx\t\t \n\twrmsr\n\n\tpop\t%r12\n\tpop\t%r15\n\n\t \n\tANNOTATE_UNRET_SAFE\n\tret\n\tint3\n.L__enc_copy_end:\nSYM_FUNC_END(__enc_copy)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}