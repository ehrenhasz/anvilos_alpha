{
  "module_name": "debug_pagetables.c",
  "hash_id": "9843fbec53137a86dfa37036db9004c407013b3388a2f4c437e897ea625c2405",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/mm/debug_pagetables.c",
  "human_readable_source": "\n#include <linux/debugfs.h>\n#include <linux/efi.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n#include <linux/pgtable.h>\n\nstatic int ptdump_show(struct seq_file *m, void *v)\n{\n\tptdump_walk_pgd_level_debugfs(m, &init_mm, false);\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(ptdump);\n\nstatic int ptdump_curknl_show(struct seq_file *m, void *v)\n{\n\tif (current->mm->pgd)\n\t\tptdump_walk_pgd_level_debugfs(m, current->mm, false);\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(ptdump_curknl);\n\n#ifdef CONFIG_PAGE_TABLE_ISOLATION\nstatic int ptdump_curusr_show(struct seq_file *m, void *v)\n{\n\tif (current->mm->pgd)\n\t\tptdump_walk_pgd_level_debugfs(m, current->mm, true);\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(ptdump_curusr);\n#endif\n\n#if defined(CONFIG_EFI) && defined(CONFIG_X86_64)\nstatic int ptdump_efi_show(struct seq_file *m, void *v)\n{\n\tif (efi_mm.pgd)\n\t\tptdump_walk_pgd_level_debugfs(m, &efi_mm, false);\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(ptdump_efi);\n#endif\n\nstatic struct dentry *dir;\n\nstatic int __init pt_dump_debug_init(void)\n{\n\tdir = debugfs_create_dir(\"page_tables\", NULL);\n\n\tdebugfs_create_file(\"kernel\", 0400, dir, NULL, &ptdump_fops);\n\tdebugfs_create_file(\"current_kernel\", 0400, dir, NULL,\n\t\t\t    &ptdump_curknl_fops);\n\n#ifdef CONFIG_PAGE_TABLE_ISOLATION\n\tdebugfs_create_file(\"current_user\", 0400, dir, NULL,\n\t\t\t    &ptdump_curusr_fops);\n#endif\n#if defined(CONFIG_EFI) && defined(CONFIG_X86_64)\n\tdebugfs_create_file(\"efi\", 0400, dir, NULL, &ptdump_efi_fops);\n#endif\n\treturn 0;\n}\n\nstatic void __exit pt_dump_debug_exit(void)\n{\n\tdebugfs_remove_recursive(dir);\n}\n\nmodule_init(pt_dump_debug_init);\nmodule_exit(pt_dump_debug_exit);\nMODULE_AUTHOR(\"Arjan van de Ven <arjan@linux.intel.com>\");\nMODULE_DESCRIPTION(\"Kernel debugging helper that dumps pagetables\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}