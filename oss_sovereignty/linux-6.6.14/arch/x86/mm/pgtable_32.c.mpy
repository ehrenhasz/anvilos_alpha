{
  "module_name": "pgtable_32.c",
  "hash_id": "b4e7488e48c548dc5094cca359259b1f3c2923ec5f8ffdce3ada59725b2090c9",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/mm/pgtable_32.c",
  "human_readable_source": "\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/nmi.h>\n#include <linux/swap.h>\n#include <linux/smp.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/spinlock.h>\n\n#include <asm/cpu_entry_area.h>\n#include <asm/fixmap.h>\n#include <asm/e820/api.h>\n#include <asm/tlb.h>\n#include <asm/tlbflush.h>\n#include <asm/io.h>\n#include <linux/vmalloc.h>\n\nunsigned int __VMALLOC_RESERVE = 128 << 20;\n\n  \nvoid set_pte_vaddr(unsigned long vaddr, pte_t pteval)\n{\n\tpgd_t *pgd;\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\tpte_t *pte;\n\n\tpgd = swapper_pg_dir + pgd_index(vaddr);\n\tif (pgd_none(*pgd)) {\n\t\tBUG();\n\t\treturn;\n\t}\n\tp4d = p4d_offset(pgd, vaddr);\n\tif (p4d_none(*p4d)) {\n\t\tBUG();\n\t\treturn;\n\t}\n\tpud = pud_offset(p4d, vaddr);\n\tif (pud_none(*pud)) {\n\t\tBUG();\n\t\treturn;\n\t}\n\tpmd = pmd_offset(pud, vaddr);\n\tif (pmd_none(*pmd)) {\n\t\tBUG();\n\t\treturn;\n\t}\n\tpte = pte_offset_kernel(pmd, vaddr);\n\tif (!pte_none(pteval))\n\t\tset_pte_at(&init_mm, vaddr, pte, pteval);\n\telse\n\t\tpte_clear(&init_mm, vaddr, pte);\n\n\t \n\tflush_tlb_one_kernel(vaddr);\n}\n\nunsigned long __FIXADDR_TOP = 0xfffff000;\nEXPORT_SYMBOL(__FIXADDR_TOP);\n\n \nstatic int __init parse_vmalloc(char *arg)\n{\n\tif (!arg)\n\t\treturn -EINVAL;\n\n\t \n\t__VMALLOC_RESERVE = memparse(arg, &arg) + VMALLOC_OFFSET;\n\treturn 0;\n}\nearly_param(\"vmalloc\", parse_vmalloc);\n\n \nstatic int __init parse_reservetop(char *arg)\n{\n\tunsigned long address;\n\n\tif (!arg)\n\t\treturn -EINVAL;\n\n\taddress = memparse(arg, &arg);\n\treserve_top_address(address);\n\tearly_ioremap_init();\n\treturn 0;\n}\nearly_param(\"reservetop\", parse_reservetop);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}