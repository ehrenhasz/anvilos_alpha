{
  "module_name": "reboot.S",
  "hash_id": "f7bf98645c9055837b77b9eef2526a633488d42c6ce626396d11f3eb95a98be3",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/realmode/rm/reboot.S",
  "human_readable_source": " \n#include <linux/linkage.h>\n#include <asm/segment.h>\n#include <asm/page_types.h>\n#include <asm/processor-flags.h>\n#include <asm/msr-index.h>\n#include \"realmode.h\"\n\n \n\t.section \".text32\", \"ax\"\n\t.code32\nSYM_CODE_START(machine_real_restart_asm)\n\n#ifdef CONFIG_X86_64\n\t \n\tmovl\t$__KERNEL_DS, %eax\n\tmovl\t%eax, %ds\n\tlgdtl\tpa_tr_gdt\n\n\t \n\tmovl\t%cr0, %eax\n\tandl\t$~X86_CR0_PG, %eax\n\tmovl\t%eax, %cr0\n\tljmpl\t$__KERNEL32_CS, $pa_machine_real_restart_paging_off\n\nSYM_INNER_LABEL(machine_real_restart_paging_off, SYM_L_GLOBAL)\n\txorl\t%eax, %eax\n\txorl\t%edx, %edx\n\tmovl\t$MSR_EFER, %ecx\n\twrmsr\n\n\tmovl\t%edi, %eax\n\t\n#endif  \n\t\n\t \n\tlidtl\tpa_machine_real_restart_idt\n\n\t \n\tlgdtl\tpa_machine_real_restart_gdt\n\n\t \n\tmovl\t$16, %ecx\n\tmovl\t%ecx, %ds\n\tmovl\t%ecx, %es\n\tmovl\t%ecx, %fs\n\tmovl\t%ecx, %gs\n\tmovl\t%ecx, %ss\n\tljmpw\t$8, $1f\nSYM_CODE_END(machine_real_restart_asm)\n\n \n\t.text\n\t.code16\n\n\t.balign\t16\nmachine_real_restart_asm16:\n1:\n\txorl\t%ecx, %ecx\n\tmovl\t%cr0, %edx\n\tandl\t$0x00000011, %edx\n\torl\t$0x60000000, %edx\n\tmovl\t%edx, %cr0\n\tmovl\t%ecx, %cr3\n\tmovl\t%cr0, %edx\n\ttestl\t$0x60000000, %edx\t \n\tjz\t2f\n\twbinvd\n2:\n\tandb\t$0x10, %dl\n\tmovl\t%edx, %cr0\n\tLJMPW_RM(3f)\n3:\n\tandw\t%ax, %ax\n\tjz\tbios\n\napm:\n\tmovw\t$0x1000, %ax\n\tmovw\t%ax, %ss\n\tmovw\t$0xf000, %sp\n\tmovw\t$0x5307, %ax\n\tmovw\t$0x0001, %bx\n\tmovw\t$0x0003, %cx\n\tint\t$0x15\n\t \n\nbios:\n\tljmpw\t$0xf000, $0xfff0\n\n\t.section \".rodata\", \"a\"\n\n\t.balign\t16\nSYM_DATA_START(machine_real_restart_idt)\n\t.word\t0xffff\t\t \n\t.long\t0\t\t \nSYM_DATA_END(machine_real_restart_idt)\n\n\t.balign\t16\nSYM_DATA_START(machine_real_restart_gdt)\n\t \n\t.word\t0xffff\t\t \n\t.long\tpa_machine_real_restart_gdt\n\t.word\t0\n\n\t \n\t.word\t0xffff\t\t \n\t.long\t0x9b000000 + pa_real_mode_base\n\t.word\t0\n\n\t \n\t.quad\tGDT_ENTRY(0x0093, 0x100, 0xffff)\nSYM_DATA_END(machine_real_restart_gdt)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}