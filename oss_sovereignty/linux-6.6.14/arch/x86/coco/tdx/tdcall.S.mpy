{
  "module_name": "tdcall.S",
  "hash_id": "ce8a8a037803004c9a717dca3c1ff482fdedf9832e926aac937dd4feb0056637",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/coco/tdx/tdcall.S",
  "human_readable_source": " \n#include <asm/asm-offsets.h>\n#include <asm/asm.h>\n#include <asm/frame.h>\n#include <asm/unwind_hints.h>\n\n#include <linux/linkage.h>\n#include <linux/bits.h>\n#include <linux/errno.h>\n\n#include \"../../virt/vmx/tdx/tdxcall.S\"\n\n \n#define TDX_RDX\t\tBIT(2)\n#define TDX_RBX\t\tBIT(3)\n#define TDX_RSI\t\tBIT(6)\n#define TDX_RDI\t\tBIT(7)\n#define TDX_R8\t\tBIT(8)\n#define TDX_R9\t\tBIT(9)\n#define TDX_R10\t\tBIT(10)\n#define TDX_R11\t\tBIT(11)\n#define TDX_R12\t\tBIT(12)\n#define TDX_R13\t\tBIT(13)\n#define TDX_R14\t\tBIT(14)\n#define TDX_R15\t\tBIT(15)\n\n \n#define TDVMCALL_EXPOSE_REGS_MASK\t\\\n\t( TDX_RDX | TDX_RBX | TDX_RSI | TDX_RDI | TDX_R8  | TDX_R9  | \\\n\t  TDX_R10 | TDX_R11 | TDX_R12 | TDX_R13 | TDX_R14 | TDX_R15 )\n\n.section .noinstr.text, \"ax\"\n\n \nSYM_FUNC_START(__tdx_module_call)\n\tFRAME_BEGIN\n\tTDX_MODULE_CALL host=0\n\tFRAME_END\n\tRET\nSYM_FUNC_END(__tdx_module_call)\n\n \n.macro TDX_HYPERCALL ret:req\n\tFRAME_BEGIN\n\n\t \n\tpush %r15\n\tpush %r14\n\tpush %r13\n\tpush %r12\n\tpush %rbx\n\n\t \n\tmovq %rdi, %rax\n\n\t \n\tmovq TDX_HYPERCALL_r8(%rax),  %r8\n\tmovq TDX_HYPERCALL_r9(%rax),  %r9\n\tmovq TDX_HYPERCALL_r10(%rax), %r10\n\tmovq TDX_HYPERCALL_r11(%rax), %r11\n\tmovq TDX_HYPERCALL_r12(%rax), %r12\n\tmovq TDX_HYPERCALL_r13(%rax), %r13\n\tmovq TDX_HYPERCALL_r14(%rax), %r14\n\tmovq TDX_HYPERCALL_r15(%rax), %r15\n\tmovq TDX_HYPERCALL_rdi(%rax), %rdi\n\tmovq TDX_HYPERCALL_rsi(%rax), %rsi\n\tmovq TDX_HYPERCALL_rbx(%rax), %rbx\n\tmovq TDX_HYPERCALL_rdx(%rax), %rdx\n\n\tpush %rax\n\n\t \n\t \n\txor %eax, %eax\n\n\tmovl $TDVMCALL_EXPOSE_REGS_MASK, %ecx\n\n\ttdcall\n\n\t \n\ttestq %rax, %rax\n\tjne .Lpanic\\@\n\n\tpop %rax\n\n\t.if \\ret\n\tmovq %r8,  TDX_HYPERCALL_r8(%rax)\n\tmovq %r9,  TDX_HYPERCALL_r9(%rax)\n\tmovq %r10, TDX_HYPERCALL_r10(%rax)\n\tmovq %r11, TDX_HYPERCALL_r11(%rax)\n\tmovq %r12, TDX_HYPERCALL_r12(%rax)\n\tmovq %r13, TDX_HYPERCALL_r13(%rax)\n\tmovq %r14, TDX_HYPERCALL_r14(%rax)\n\tmovq %r15, TDX_HYPERCALL_r15(%rax)\n\tmovq %rdi, TDX_HYPERCALL_rdi(%rax)\n\tmovq %rsi, TDX_HYPERCALL_rsi(%rax)\n\tmovq %rbx, TDX_HYPERCALL_rbx(%rax)\n\tmovq %rdx, TDX_HYPERCALL_rdx(%rax)\n\t.endif\n\n\t \n\tmovq %r10, %rax\n\n\t \n\txor %r8d,  %r8d\n\txor %r9d,  %r9d\n\txor %r10d, %r10d\n\txor %r11d, %r11d\n\txor %rdi,  %rdi\n\txor %rsi,  %rsi\n\txor %rdx,  %rdx\n\n\t \n\tpop %rbx\n\tpop %r12\n\tpop %r13\n\tpop %r14\n\tpop %r15\n\n\tFRAME_END\n\n\tRET\n.Lpanic\\@:\n\tcall __tdx_hypercall_failed\n\t \n\tREACHABLE\n\tjmp .Lpanic\\@\n.endm\n\n \nSYM_FUNC_START(__tdx_hypercall)\n\tTDX_HYPERCALL ret=0\nSYM_FUNC_END(__tdx_hypercall)\n\n \nSYM_FUNC_START(__tdx_hypercall_ret)\n\tTDX_HYPERCALL ret=1\nSYM_FUNC_END(__tdx_hypercall_ret)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}