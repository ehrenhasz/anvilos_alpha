{
  "module_name": "wakeup_32.S",
  "hash_id": "d92a1a6583568e4baab94c7ebb2a27c45d22e5322d36d5435a5d190a396dba7f",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/acpi/wakeup_32.S",
  "human_readable_source": " \n\t.text\n#include <linux/linkage.h>\n#include <asm/segment.h>\n#include <asm/page_types.h>\n\n# Copyright 2003, 2008 Pavel Machek <pavel@suse.cz\n\n\t.code32\n\tALIGN\n\nSYM_CODE_START(wakeup_pmode_return)\n\tmovw\t$__KERNEL_DS, %ax\n\tmovw\t%ax, %ss\n\tmovw\t%ax, %fs\n\tmovw\t%ax, %gs\n\n\tmovw\t$__USER_DS, %ax\n\tmovw\t%ax, %ds\n\tmovw\t%ax, %es\n\n\t# reload the gdt, as we need the full 32 bit address\n\tlidt\tsaved_idt\n\tlldt\tsaved_ldt\n\tljmp\t$(__KERNEL_CS), $1f\n1:\n\tmovl\t%cr3, %eax\n\tmovl\t%eax, %cr3\n\twbinvd\n\n\t# and restore the stack ... but you need gdt for this to work\n\tmovl\tsaved_context_esp, %esp\n\n\tmovl\t%cs:saved_magic, %eax\n\tcmpl\t$0x12345678, %eax\n\tjne\tbogus_magic\n\n\t# jump to place where we left off\n\tmovl\tsaved_eip, %eax\n\tjmp\t*%eax\nSYM_CODE_END(wakeup_pmode_return)\n\nbogus_magic:\n\tjmp\tbogus_magic\n\n\n\nsave_registers:\n\tsidt\tsaved_idt\n\tsldt\tsaved_ldt\n\tstr\tsaved_tss\n\n\tleal\t4(%esp), %eax\n\tmovl\t%eax, saved_context_esp\n\tmovl\t%ebx, saved_context_ebx\n\tmovl\t%ebp, saved_context_ebp\n\tmovl\t%esi, saved_context_esi\n\tmovl\t%edi, saved_context_edi\n\tpushfl\n\tpopl\tsaved_context_eflags\n\n\tmovl\t$ret_point, saved_eip\n\tRET\n\n\nrestore_registers:\n\tmovl\tsaved_context_ebp, %ebp\n\tmovl\tsaved_context_ebx, %ebx\n\tmovl\tsaved_context_esi, %esi\n\tmovl\tsaved_context_edi, %edi\n\tpushl\tsaved_context_eflags\n\tpopfl\n\tRET\n\nSYM_CODE_START(do_suspend_lowlevel)\n\tcall\tsave_processor_state\n\tcall\tsave_registers\n\tpushl\t$3\n\tcall\tx86_acpi_enter_sleep_state\n\taddl\t$4, %esp\n\n#\tIn case of S3 failure, we'll emerge here.  Jump\n# \tto ret_point to recover\n\tjmp\tret_point\n\t.p2align 4,,7\nret_point:\n\tcall\trestore_registers\n\tcall\trestore_processor_state\n\tRET\nSYM_CODE_END(do_suspend_lowlevel)\n\n.data\nALIGN\nSYM_DATA(saved_magic,\t.long 0)\nsaved_eip:\t\t.long 0\n\n# saved registers\nsaved_idt:\t.long\t0,0\nsaved_ldt:\t.long\t0\nsaved_tss:\t.long\t0\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}