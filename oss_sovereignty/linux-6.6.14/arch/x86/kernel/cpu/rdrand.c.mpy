{
  "module_name": "rdrand.c",
  "hash_id": "be56558e6d2c4cd9e35655cb5f754db4757bf5e60b6303d58482ba45a0a54b54",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/cpu/rdrand.c",
  "human_readable_source": "\n \n\n#include <asm/processor.h>\n#include <asm/archrandom.h>\n#include <asm/sections.h>\n\n \n\nvoid x86_init_rdrand(struct cpuinfo_x86 *c)\n{\n\tenum { SAMPLES = 8, MIN_CHANGE = 5 };\n\tunsigned long sample, prev;\n\tbool failure = false;\n\tsize_t i, changed;\n\n\tif (!cpu_has(c, X86_FEATURE_RDRAND))\n\t\treturn;\n\n\tfor (changed = 0, i = 0; i < SAMPLES; ++i) {\n\t\tif (!rdrand_long(&sample)) {\n\t\t\tfailure = true;\n\t\t\tbreak;\n\t\t}\n\t\tchanged += i && sample != prev;\n\t\tprev = sample;\n\t}\n\tif (changed < MIN_CHANGE)\n\t\tfailure = true;\n\n\tif (failure) {\n\t\tclear_cpu_cap(c, X86_FEATURE_RDRAND);\n\t\tclear_cpu_cap(c, X86_FEATURE_RDSEED);\n\t\tpr_emerg(\"RDRAND is not reliable on this platform; disabling.\\n\");\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}