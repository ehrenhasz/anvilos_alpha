{
  "module_name": "internal.h",
  "hash_id": "7a541e0358eeda167abed0e54d260b34c4142426c801341d20e4be999e0ea8d7",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/cpu/microcode/internal.h",
  "human_readable_source": " \n#ifndef _X86_MICROCODE_INTERNAL_H\n#define _X86_MICROCODE_INTERNAL_H\n\n#include <linux/earlycpio.h>\n#include <linux/initrd.h>\n\n#include <asm/cpu.h>\n#include <asm/microcode.h>\n\nstruct ucode_patch {\n\tstruct list_head plist;\n\tvoid *data;\t\t \n\tunsigned int size;\n\tu32 patch_id;\n\tu16 equiv_cpu;\n};\n\nextern struct list_head microcode_cache;\n\nstruct device;\n\nenum ucode_state {\n\tUCODE_OK\t= 0,\n\tUCODE_NEW,\n\tUCODE_UPDATED,\n\tUCODE_NFOUND,\n\tUCODE_ERROR,\n};\n\nstruct microcode_ops {\n\tenum ucode_state (*request_microcode_fw)(int cpu, struct device *dev);\n\n\tvoid (*microcode_fini_cpu)(int cpu);\n\n\t \n\tenum ucode_state (*apply_microcode)(int cpu);\n\tint (*collect_cpu_info)(int cpu, struct cpu_signature *csig);\n};\n\nextern struct ucode_cpu_info ucode_cpu_info[];\nstruct cpio_data find_microcode_in_initrd(const char *path, bool use_pa);\n\n#define MAX_UCODE_COUNT 128\n\n#define QCHAR(a, b, c, d) ((a) + ((b) << 8) + ((c) << 16) + ((d) << 24))\n#define CPUID_INTEL1 QCHAR('G', 'e', 'n', 'u')\n#define CPUID_INTEL2 QCHAR('i', 'n', 'e', 'I')\n#define CPUID_INTEL3 QCHAR('n', 't', 'e', 'l')\n#define CPUID_AMD1 QCHAR('A', 'u', 't', 'h')\n#define CPUID_AMD2 QCHAR('e', 'n', 't', 'i')\n#define CPUID_AMD3 QCHAR('c', 'A', 'M', 'D')\n\n#define CPUID_IS(a, b, c, ebx, ecx, edx)\t\\\n\t\t(!(((ebx) ^ (a)) | ((edx) ^ (b)) | ((ecx) ^ (c))))\n\n \nstatic inline int x86_cpuid_vendor(void)\n{\n\tu32 eax = 0x00000000;\n\tu32 ebx, ecx = 0, edx;\n\n\tnative_cpuid(&eax, &ebx, &ecx, &edx);\n\n\tif (CPUID_IS(CPUID_INTEL1, CPUID_INTEL2, CPUID_INTEL3, ebx, ecx, edx))\n\t\treturn X86_VENDOR_INTEL;\n\n\tif (CPUID_IS(CPUID_AMD1, CPUID_AMD2, CPUID_AMD3, ebx, ecx, edx))\n\t\treturn X86_VENDOR_AMD;\n\n\treturn X86_VENDOR_UNKNOWN;\n}\n\nstatic inline unsigned int x86_cpuid_family(void)\n{\n\tu32 eax = 0x00000001;\n\tu32 ebx, ecx = 0, edx;\n\n\tnative_cpuid(&eax, &ebx, &ecx, &edx);\n\n\treturn x86_family(eax);\n}\n\nextern bool initrd_gone;\n\n#ifdef CONFIG_CPU_SUP_AMD\nvoid load_ucode_amd_bsp(unsigned int family);\nvoid load_ucode_amd_ap(unsigned int family);\nvoid load_ucode_amd_early(unsigned int cpuid_1_eax);\nint save_microcode_in_initrd_amd(unsigned int family);\nvoid reload_ucode_amd(unsigned int cpu);\nstruct microcode_ops *init_amd_microcode(void);\nvoid exit_amd_microcode(void);\n#else  \nstatic inline void load_ucode_amd_bsp(unsigned int family) { }\nstatic inline void load_ucode_amd_ap(unsigned int family) { }\nstatic inline void load_ucode_amd_early(unsigned int family) { }\nstatic inline int save_microcode_in_initrd_amd(unsigned int family) { return -EINVAL; }\nstatic inline void reload_ucode_amd(unsigned int cpu) { }\nstatic inline struct microcode_ops *init_amd_microcode(void) { return NULL; }\nstatic inline void exit_amd_microcode(void) { }\n#endif  \n\n#ifdef CONFIG_CPU_SUP_INTEL\nvoid load_ucode_intel_bsp(void);\nvoid load_ucode_intel_ap(void);\nint save_microcode_in_initrd_intel(void);\nvoid reload_ucode_intel(void);\nstruct microcode_ops *init_intel_microcode(void);\n#else  \nstatic inline void load_ucode_intel_bsp(void) { }\nstatic inline void load_ucode_intel_ap(void) { }\nstatic inline int save_microcode_in_initrd_intel(void) { return -EINVAL; }\nstatic inline void reload_ucode_intel(void) { }\nstatic inline struct microcode_ops *init_intel_microcode(void) { return NULL; }\n#endif   \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}