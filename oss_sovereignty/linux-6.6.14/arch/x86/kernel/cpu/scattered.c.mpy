{
  "module_name": "scattered.c",
  "hash_id": "aea5d0783625401f85b7da6c0f1a3bfad013db6eba19b5e9c4dc69df7c022245",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/cpu/scattered.c",
  "human_readable_source": " \n#include <linux/cpu.h>\n\n#include <asm/memtype.h>\n#include <asm/apic.h>\n#include <asm/processor.h>\n\n#include \"cpu.h\"\n\nstruct cpuid_bit {\n\tu16 feature;\n\tu8 reg;\n\tu8 bit;\n\tu32 level;\n\tu32 sub_leaf;\n};\n\n \nstatic const struct cpuid_bit cpuid_bits[] = {\n\t{ X86_FEATURE_APERFMPERF,       CPUID_ECX,  0, 0x00000006, 0 },\n\t{ X86_FEATURE_EPB,\t\tCPUID_ECX,  3, 0x00000006, 0 },\n\t{ X86_FEATURE_INTEL_PPIN,\tCPUID_EBX,  0, 0x00000007, 1 },\n\t{ X86_FEATURE_RRSBA_CTRL,\tCPUID_EDX,  2, 0x00000007, 2 },\n\t{ X86_FEATURE_CQM_LLC,\t\tCPUID_EDX,  1, 0x0000000f, 0 },\n\t{ X86_FEATURE_CQM_OCCUP_LLC,\tCPUID_EDX,  0, 0x0000000f, 1 },\n\t{ X86_FEATURE_CQM_MBM_TOTAL,\tCPUID_EDX,  1, 0x0000000f, 1 },\n\t{ X86_FEATURE_CQM_MBM_LOCAL,\tCPUID_EDX,  2, 0x0000000f, 1 },\n\t{ X86_FEATURE_CAT_L3,\t\tCPUID_EBX,  1, 0x00000010, 0 },\n\t{ X86_FEATURE_CAT_L2,\t\tCPUID_EBX,  2, 0x00000010, 0 },\n\t{ X86_FEATURE_CDP_L3,\t\tCPUID_ECX,  2, 0x00000010, 1 },\n\t{ X86_FEATURE_CDP_L2,\t\tCPUID_ECX,  2, 0x00000010, 2 },\n\t{ X86_FEATURE_MBA,\t\tCPUID_EBX,  3, 0x00000010, 0 },\n\t{ X86_FEATURE_PER_THREAD_MBA,\tCPUID_ECX,  0, 0x00000010, 3 },\n\t{ X86_FEATURE_SGX1,\t\tCPUID_EAX,  0, 0x00000012, 0 },\n\t{ X86_FEATURE_SGX2,\t\tCPUID_EAX,  1, 0x00000012, 0 },\n\t{ X86_FEATURE_SGX_EDECCSSA,\tCPUID_EAX, 11, 0x00000012, 0 },\n\t{ X86_FEATURE_HW_PSTATE,\tCPUID_EDX,  7, 0x80000007, 0 },\n\t{ X86_FEATURE_CPB,\t\tCPUID_EDX,  9, 0x80000007, 0 },\n\t{ X86_FEATURE_PROC_FEEDBACK,    CPUID_EDX, 11, 0x80000007, 0 },\n\t{ X86_FEATURE_MBA,\t\tCPUID_EBX,  6, 0x80000008, 0 },\n\t{ X86_FEATURE_SMBA,\t\tCPUID_EBX,  2, 0x80000020, 0 },\n\t{ X86_FEATURE_BMEC,\t\tCPUID_EBX,  3, 0x80000020, 0 },\n\t{ X86_FEATURE_PERFMON_V2,\tCPUID_EAX,  0, 0x80000022, 0 },\n\t{ X86_FEATURE_AMD_LBR_V2,\tCPUID_EAX,  1, 0x80000022, 0 },\n\t{ 0, 0, 0, 0, 0 }\n};\n\nvoid init_scattered_cpuid_features(struct cpuinfo_x86 *c)\n{\n\tu32 max_level;\n\tu32 regs[4];\n\tconst struct cpuid_bit *cb;\n\n\tfor (cb = cpuid_bits; cb->feature; cb++) {\n\n\t\t \n\t\tmax_level = cpuid_eax(cb->level & 0xffff0000);\n\t\tif (max_level < cb->level ||\n\t\t    max_level > (cb->level | 0xffff))\n\t\t\tcontinue;\n\n\t\tcpuid_count(cb->level, cb->sub_leaf, &regs[CPUID_EAX],\n\t\t\t    &regs[CPUID_EBX], &regs[CPUID_ECX],\n\t\t\t    &regs[CPUID_EDX]);\n\n\t\tif (regs[cb->reg] & (1 << cb->bit))\n\t\t\tset_cpu_cap(c, cb->feature);\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}