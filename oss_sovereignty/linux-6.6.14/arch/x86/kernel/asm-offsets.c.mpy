{
  "module_name": "asm-offsets.c",
  "hash_id": "6affd94ed677863a80dd3dd6f698aeb6c463eae44c14ea0700a027266df4a7df",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/asm-offsets.c",
  "human_readable_source": "\n \n#define COMPILE_OFFSETS\n\n#include <linux/crypto.h>\n#include <crypto/aria.h>\n#include <linux/sched.h>\n#include <linux/stddef.h>\n#include <linux/hardirq.h>\n#include <linux/suspend.h>\n#include <linux/kbuild.h>\n#include <asm/processor.h>\n#include <asm/thread_info.h>\n#include <asm/sigframe.h>\n#include <asm/bootparam.h>\n#include <asm/suspend.h>\n#include <asm/tlbflush.h>\n#include <asm/tdx.h>\n\n#ifdef CONFIG_XEN\n#include <xen/interface/xen.h>\n#endif\n\n#ifdef CONFIG_X86_32\n# include \"asm-offsets_32.c\"\n#else\n# include \"asm-offsets_64.c\"\n#endif\n\nstatic void __used common(void)\n{\n\tBLANK();\n\tOFFSET(TASK_threadsp, task_struct, thread.sp);\n#ifdef CONFIG_STACKPROTECTOR\n\tOFFSET(TASK_stack_canary, task_struct, stack_canary);\n#endif\n\n\tBLANK();\n\tOFFSET(pbe_address, pbe, address);\n\tOFFSET(pbe_orig_address, pbe, orig_address);\n\tOFFSET(pbe_next, pbe, next);\n\n#if defined(CONFIG_X86_32) || defined(CONFIG_IA32_EMULATION)\n\tBLANK();\n\tOFFSET(IA32_SIGCONTEXT_ax, sigcontext_32, ax);\n\tOFFSET(IA32_SIGCONTEXT_bx, sigcontext_32, bx);\n\tOFFSET(IA32_SIGCONTEXT_cx, sigcontext_32, cx);\n\tOFFSET(IA32_SIGCONTEXT_dx, sigcontext_32, dx);\n\tOFFSET(IA32_SIGCONTEXT_si, sigcontext_32, si);\n\tOFFSET(IA32_SIGCONTEXT_di, sigcontext_32, di);\n\tOFFSET(IA32_SIGCONTEXT_bp, sigcontext_32, bp);\n\tOFFSET(IA32_SIGCONTEXT_sp, sigcontext_32, sp);\n\tOFFSET(IA32_SIGCONTEXT_ip, sigcontext_32, ip);\n\n\tBLANK();\n\tOFFSET(IA32_RT_SIGFRAME_sigcontext, rt_sigframe_ia32, uc.uc_mcontext);\n#endif\n\n#ifdef CONFIG_XEN\n\tBLANK();\n\tOFFSET(XEN_vcpu_info_mask, vcpu_info, evtchn_upcall_mask);\n\tOFFSET(XEN_vcpu_info_pending, vcpu_info, evtchn_upcall_pending);\n\tOFFSET(XEN_vcpu_info_arch_cr2, vcpu_info, arch.cr2);\n#endif\n\n\tBLANK();\n\tOFFSET(TDX_MODULE_rcx, tdx_module_output, rcx);\n\tOFFSET(TDX_MODULE_rdx, tdx_module_output, rdx);\n\tOFFSET(TDX_MODULE_r8,  tdx_module_output, r8);\n\tOFFSET(TDX_MODULE_r9,  tdx_module_output, r9);\n\tOFFSET(TDX_MODULE_r10, tdx_module_output, r10);\n\tOFFSET(TDX_MODULE_r11, tdx_module_output, r11);\n\n\tBLANK();\n\tOFFSET(TDX_HYPERCALL_r8,  tdx_hypercall_args, r8);\n\tOFFSET(TDX_HYPERCALL_r9,  tdx_hypercall_args, r9);\n\tOFFSET(TDX_HYPERCALL_r10, tdx_hypercall_args, r10);\n\tOFFSET(TDX_HYPERCALL_r11, tdx_hypercall_args, r11);\n\tOFFSET(TDX_HYPERCALL_r12, tdx_hypercall_args, r12);\n\tOFFSET(TDX_HYPERCALL_r13, tdx_hypercall_args, r13);\n\tOFFSET(TDX_HYPERCALL_r14, tdx_hypercall_args, r14);\n\tOFFSET(TDX_HYPERCALL_r15, tdx_hypercall_args, r15);\n\tOFFSET(TDX_HYPERCALL_rdi, tdx_hypercall_args, rdi);\n\tOFFSET(TDX_HYPERCALL_rsi, tdx_hypercall_args, rsi);\n\tOFFSET(TDX_HYPERCALL_rbx, tdx_hypercall_args, rbx);\n\tOFFSET(TDX_HYPERCALL_rdx, tdx_hypercall_args, rdx);\n\n\tBLANK();\n\tOFFSET(BP_scratch, boot_params, scratch);\n\tOFFSET(BP_secure_boot, boot_params, secure_boot);\n\tOFFSET(BP_loadflags, boot_params, hdr.loadflags);\n\tOFFSET(BP_hardware_subarch, boot_params, hdr.hardware_subarch);\n\tOFFSET(BP_version, boot_params, hdr.version);\n\tOFFSET(BP_kernel_alignment, boot_params, hdr.kernel_alignment);\n\tOFFSET(BP_init_size, boot_params, hdr.init_size);\n\tOFFSET(BP_pref_address, boot_params, hdr.pref_address);\n\n\tBLANK();\n\tDEFINE(PTREGS_SIZE, sizeof(struct pt_regs));\n\n\t \n\tOFFSET(TLB_STATE_user_pcid_flush_mask, tlb_state, user_pcid_flush_mask);\n\n\t \n\tOFFSET(CPU_ENTRY_AREA_entry_stack, cpu_entry_area, entry_stack_page);\n\tDEFINE(SIZEOF_entry_stack, sizeof(struct entry_stack));\n\tDEFINE(MASK_entry_stack, (~(sizeof(struct entry_stack) - 1)));\n\n\t \n\tOFFSET(TSS_sp0, tss_struct, x86_tss.sp0);\n\tOFFSET(TSS_sp1, tss_struct, x86_tss.sp1);\n\tOFFSET(TSS_sp2, tss_struct, x86_tss.sp2);\n\tOFFSET(X86_top_of_stack, pcpu_hot, top_of_stack);\n\tOFFSET(X86_current_task, pcpu_hot, current_task);\n#ifdef CONFIG_CALL_DEPTH_TRACKING\n\tOFFSET(X86_call_depth, pcpu_hot, call_depth);\n#endif\n#if IS_ENABLED(CONFIG_CRYPTO_ARIA_AESNI_AVX_X86_64)\n\t \n\tBLANK();\n\tOFFSET(ARIA_CTX_enc_key, aria_ctx, enc_key);\n\tOFFSET(ARIA_CTX_dec_key, aria_ctx, dec_key);\n\tOFFSET(ARIA_CTX_rounds, aria_ctx, rounds);\n#endif\n\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}