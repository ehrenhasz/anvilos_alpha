{
  "module_name": "ftrace_32.S",
  "hash_id": "6d107709e299d59a248fc9f757b3c183c44f319343a39dbb905cf0f353ccfb61",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/ftrace_32.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/page_types.h>\n#include <asm/segment.h>\n#include <asm/export.h>\n#include <asm/ftrace.h>\n#include <asm/nospec-branch.h>\n#include <asm/frame.h>\n#include <asm/asm-offsets.h>\n\n#ifdef CONFIG_FRAME_POINTER\n# define MCOUNT_FRAME\t\t\t1\t \n#else\n# define MCOUNT_FRAME\t\t\t0\t \n#endif\n\nSYM_FUNC_START(__fentry__)\n\tRET\nSYM_FUNC_END(__fentry__)\nEXPORT_SYMBOL(__fentry__)\n\nSYM_CODE_START(ftrace_caller)\n\n#ifdef CONFIG_FRAME_POINTER\n\t \n\tpushl\t4(%esp)\t\t\t\t \n\tpushl\t%ebp\n\tmovl\t%esp, %ebp\n\tpushl\t2*4(%esp)\t\t\t \n\n\t \n\tpushl\t%ebp\n\tmovl\t%esp, %ebp\n#endif\n\tpushl\t%eax\n\tpushl\t%ecx\n\tpushl\t%edx\n\tpushl\t$0\t\t\t\t \n\n#ifdef CONFIG_FRAME_POINTER\n\t \n\tmovl\t4*4(%esp), %edx\n#else\n\t \n\tlea\t4*4(%esp), %edx\n#endif\n\n\tmovl\t(MCOUNT_FRAME+4)*4(%esp), %eax\t \n\t \n\tmovl\t4(%edx), %edx\t\t\t \n\n\tmovl\tfunction_trace_op, %ecx\n\tsubl\t$MCOUNT_INSN_SIZE, %eax\n\n.globl ftrace_call\nftrace_call:\n\tcall\tftrace_stub\n\n\taddl\t$4, %esp\t\t\t \n\tpopl\t%edx\n\tpopl\t%ecx\n\tpopl\t%eax\n#ifdef CONFIG_FRAME_POINTER\n\tpopl\t%ebp\n\taddl\t$4,%esp\t\t\t\t \n\tpopl\t%ebp\t\t\t\t \n\taddl\t$4, %esp\t\t\t \n#endif\n.Lftrace_ret:\n#ifdef CONFIG_FUNCTION_GRAPH_TRACER\n.globl ftrace_graph_call\nftrace_graph_call:\n\tjmp\tftrace_stub\n#endif\n\n \nSYM_INNER_LABEL_ALIGN(ftrace_stub, SYM_L_WEAK)\n\tRET\nSYM_CODE_END(ftrace_caller)\n\nSYM_CODE_START(ftrace_regs_caller)\n\t \n\tsubl\t$3*4, %esp\t# RET-IP + 3 gaps\n\tpushl\t%ss\t\t# ss\n\tpushl\t%esp\t\t# points at ss\n\taddl\t$5*4, (%esp)\t#   make it point at <previous context>\n\tpushfl\t\t\t# flags\n\tpushl\t$__KERNEL_CS\t# cs\n\tpushl\t7*4(%esp)\t# ip <- RET-IP\n\tpushl\t$0\t\t# orig_eax\n\n\tpushl\t%gs\n\tpushl\t%fs\n\tpushl\t%es\n\tpushl\t%ds\n\n\tpushl\t%eax\n\tpushl\t%ebp\n\tpushl\t%edi\n\tpushl\t%esi\n\tpushl\t%edx\n\tpushl\t%ecx\n\tpushl\t%ebx\n\n\tENCODE_FRAME_POINTER\n\n\tmovl\tPT_EIP(%esp), %eax\t# 1st argument: IP\n\tsubl\t$MCOUNT_INSN_SIZE, %eax\n\tmovl\t21*4(%esp), %edx\t# 2nd argument: parent ip\n\tmovl\tfunction_trace_op, %ecx\t# 3rd argument: ftrace_pos\n\tpushl\t%esp\t\t\t# 4th argument: pt_regs\n\nSYM_INNER_LABEL(ftrace_regs_call, SYM_L_GLOBAL)\n\tcall\tftrace_stub\n\n\taddl\t$4, %esp\t\t# skip 4th argument\n\n\t \n\tmovl\tPT_OLDESP(%esp), %eax\n\tmovl\tPT_EIP(%esp), %ecx\n\tmovl\t%ecx, -4(%eax)\n\n\t \n\tmovl\tPT_EAX(%esp), %ecx\n\tmovl\t%ecx, -8(%eax)\n\n\tpopl\t%ebx\n\tpopl\t%ecx\n\tpopl\t%edx\n\tpopl\t%esi\n\tpopl\t%edi\n\tpopl\t%ebp\n\n\tlea\t-8(%eax), %esp\n\tpopl\t%eax\n\n\tjmp\t.Lftrace_ret\nSYM_CODE_END(ftrace_regs_caller)\n\nSYM_FUNC_START(ftrace_stub_direct_tramp)\n\tCALL_DEPTH_ACCOUNT\n\tRET\nSYM_FUNC_END(ftrace_stub_direct_tramp)\n\n#ifdef CONFIG_FUNCTION_GRAPH_TRACER\nSYM_CODE_START(ftrace_graph_caller)\n\tpushl\t%eax\n\tpushl\t%ecx\n\tpushl\t%edx\n\tmovl\t3*4(%esp), %eax\n\t \n\tlea\t4*4(%esp), %edx\n\tmovl\t$0, %ecx\n\tsubl\t$MCOUNT_INSN_SIZE, %eax\n\tcall\tprepare_ftrace_return\n\tpopl\t%edx\n\tpopl\t%ecx\n\tpopl\t%eax\n\tRET\nSYM_CODE_END(ftrace_graph_caller)\n\n.globl return_to_handler\nreturn_to_handler:\n\tpushl\t$0\n\tpushl\t%edx\n\tpushl\t%eax\n\tmovl\t%esp, %eax\n\tcall\tftrace_return_to_handler\n\tmovl\t%eax, %ecx\n\tpopl\t%eax\n\tpopl\t%edx\n\taddl\t$4, %esp\t\t# skip ebp\n\tJMP_NOSPEC ecx\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}