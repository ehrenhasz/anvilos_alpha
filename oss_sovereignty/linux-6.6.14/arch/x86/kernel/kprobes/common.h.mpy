{
  "module_name": "common.h",
  "hash_id": "5cf53bccb0407f0a11ed5b8bfc122bda17ad3c31789883a1701521b409e4e4c5",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/kprobes/common.h",
  "human_readable_source": " \n#ifndef __X86_KERNEL_KPROBES_COMMON_H\n#define __X86_KERNEL_KPROBES_COMMON_H\n\n \n\n#include <asm/asm.h>\n#include <asm/frame.h>\n#include <asm/insn.h>\n\n#ifdef CONFIG_X86_64\n\n#define SAVE_REGS_STRING\t\t\t\\\n\t \t\t\\\n\t\"\tsubq $24, %rsp\\n\"\t\t\\\n\t\"\tpushq %rdi\\n\"\t\t\t\\\n\t\"\tpushq %rsi\\n\"\t\t\t\\\n\t\"\tpushq %rdx\\n\"\t\t\t\\\n\t\"\tpushq %rcx\\n\"\t\t\t\\\n\t\"\tpushq %rax\\n\"\t\t\t\\\n\t\"\tpushq %r8\\n\"\t\t\t\\\n\t\"\tpushq %r9\\n\"\t\t\t\\\n\t\"\tpushq %r10\\n\"\t\t\t\\\n\t\"\tpushq %r11\\n\"\t\t\t\\\n\t\"\tpushq %rbx\\n\"\t\t\t\\\n\t\"\tpushq %rbp\\n\"\t\t\t\\\n\t\"\tpushq %r12\\n\"\t\t\t\\\n\t\"\tpushq %r13\\n\"\t\t\t\\\n\t\"\tpushq %r14\\n\"\t\t\t\\\n\t\"\tpushq %r15\\n\"\t\t\t\\\n\tENCODE_FRAME_POINTER\n\n#define RESTORE_REGS_STRING\t\t\t\\\n\t\"\tpopq %r15\\n\"\t\t\t\\\n\t\"\tpopq %r14\\n\"\t\t\t\\\n\t\"\tpopq %r13\\n\"\t\t\t\\\n\t\"\tpopq %r12\\n\"\t\t\t\\\n\t\"\tpopq %rbp\\n\"\t\t\t\\\n\t\"\tpopq %rbx\\n\"\t\t\t\\\n\t\"\tpopq %r11\\n\"\t\t\t\\\n\t\"\tpopq %r10\\n\"\t\t\t\\\n\t\"\tpopq %r9\\n\"\t\t\t\\\n\t\"\tpopq %r8\\n\"\t\t\t\\\n\t\"\tpopq %rax\\n\"\t\t\t\\\n\t\"\tpopq %rcx\\n\"\t\t\t\\\n\t\"\tpopq %rdx\\n\"\t\t\t\\\n\t\"\tpopq %rsi\\n\"\t\t\t\\\n\t\"\tpopq %rdi\\n\"\t\t\t\\\n\t \t\t\\\n\t\"\taddq $24, %rsp\\n\"\n#else\n\n#define SAVE_REGS_STRING\t\t\t\\\n\t \t\\\n\t\"\tsubl $4*4, %esp\\n\"\t\t\\\n\t\"\tpushl %fs\\n\"\t\t\t\\\n\t\"\tpushl %es\\n\"\t\t\t\\\n\t\"\tpushl %ds\\n\"\t\t\t\\\n\t\"\tpushl %eax\\n\"\t\t\t\\\n\t\"\tpushl %ebp\\n\"\t\t\t\\\n\t\"\tpushl %edi\\n\"\t\t\t\\\n\t\"\tpushl %esi\\n\"\t\t\t\\\n\t\"\tpushl %edx\\n\"\t\t\t\\\n\t\"\tpushl %ecx\\n\"\t\t\t\\\n\t\"\tpushl %ebx\\n\"\t\t\t\\\n\tENCODE_FRAME_POINTER\n\n#define RESTORE_REGS_STRING\t\t\t\\\n\t\"\tpopl %ebx\\n\"\t\t\t\\\n\t\"\tpopl %ecx\\n\"\t\t\t\\\n\t\"\tpopl %edx\\n\"\t\t\t\\\n\t\"\tpopl %esi\\n\"\t\t\t\\\n\t\"\tpopl %edi\\n\"\t\t\t\\\n\t\"\tpopl %ebp\\n\"\t\t\t\\\n\t\"\tpopl %eax\\n\"\t\t\t\\\n\t \\\n\t\"\taddl $7*4, %esp\\n\"\n#endif\n\n \nextern int can_boost(struct insn *insn, void *orig_addr);\n \nextern unsigned long recover_probed_instruction(kprobe_opcode_t *buf,\n\t\t\t\t\t unsigned long addr);\n \nextern int __copy_instruction(u8 *dest, u8 *src, u8 *real, struct insn *insn);\n\n \nextern void synthesize_reljump(void *dest, void *from, void *to);\nextern void synthesize_relcall(void *dest, void *from, void *to);\n\n#ifdef\tCONFIG_OPTPROBES\nextern int setup_detour_execution(struct kprobe *p, struct pt_regs *regs, int reenter);\nextern unsigned long __recover_optprobed_insn(kprobe_opcode_t *buf, unsigned long addr);\n#else\t \nstatic inline int setup_detour_execution(struct kprobe *p, struct pt_regs *regs, int reenter)\n{\n\treturn 0;\n}\nstatic inline unsigned long __recover_optprobed_insn(kprobe_opcode_t *buf, unsigned long addr)\n{\n\treturn addr;\n}\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}