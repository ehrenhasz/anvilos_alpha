{
  "module_name": "head32.c",
  "hash_id": "ba77d11fb7425f42a52a86f09b24d0afbc092c2ee80699e43973c4fc9caa0aba",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/head32.c",
  "human_readable_source": "\n \n\n#include <linux/init.h>\n#include <linux/start_kernel.h>\n#include <linux/mm.h>\n#include <linux/memblock.h>\n\n#include <asm/desc.h>\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <asm/e820/api.h>\n#include <asm/page.h>\n#include <asm/apic.h>\n#include <asm/io_apic.h>\n#include <asm/bios_ebda.h>\n#include <asm/tlbflush.h>\n#include <asm/bootparam_utils.h>\n\nstatic void __init i386_default_early_setup(void)\n{\n\t \n\tx86_init.resources.reserve_resources = i386_reserve_resources;\n\tx86_init.mpparse.setup_ioapic_ids = setup_ioapic_ids_from_mpc;\n}\n\nasmlinkage __visible void __init __noreturn i386_start_kernel(void)\n{\n\t \n\tidt_setup_early_handler();\n\n\tcr4_init_shadow();\n\n\tsanitize_boot_params(&boot_params);\n\n\tx86_early_init_platform_quirks();\n\n\t \n\tswitch (boot_params.hdr.hardware_subarch) {\n\tcase X86_SUBARCH_INTEL_MID:\n\t\tx86_intel_mid_early_setup();\n\t\tbreak;\n\tcase X86_SUBARCH_CE4100:\n\t\tx86_ce4100_early_setup();\n\t\tbreak;\n\tdefault:\n\t\ti386_default_early_setup();\n\t\tbreak;\n\t}\n\n\tstart_kernel();\n}\n\n \nvoid __init mk_early_pgtbl_32(void);\nvoid __init mk_early_pgtbl_32(void)\n{\n#ifdef __pa\n#undef __pa\n#endif\n#define __pa(x)  ((unsigned long)(x) - PAGE_OFFSET)\n\tpte_t pte, *ptep;\n\tint i;\n\tunsigned long *ptr;\n\t \n\tconst unsigned long limit = __pa(_end) +\n\t\t(PAGE_TABLE_SIZE(LOWMEM_PAGES) << PAGE_SHIFT);\n#ifdef CONFIG_X86_PAE\n\tpmd_t pl2, *pl2p = (pmd_t *)__pa(initial_pg_pmd);\n#define SET_PL2(pl2, val)    { (pl2).pmd = (val); }\n#else\n\tpgd_t pl2, *pl2p = (pgd_t *)__pa(initial_page_table);\n#define SET_PL2(pl2, val)   { (pl2).pgd = (val); }\n#endif\n\n\tptep = (pte_t *)__pa(__brk_base);\n\tpte.pte = PTE_IDENT_ATTR;\n\n\twhile ((pte.pte & PTE_PFN_MASK) < limit) {\n\n\t\tSET_PL2(pl2, (unsigned long)ptep | PDE_IDENT_ATTR);\n\t\t*pl2p = pl2;\n#ifndef CONFIG_X86_PAE\n\t\t \n\t\t*(pl2p +  ((PAGE_OFFSET >> PGDIR_SHIFT))) = pl2;\n#endif\n\t\tfor (i = 0; i < PTRS_PER_PTE; i++) {\n\t\t\t*ptep = pte;\n\t\t\tpte.pte += PAGE_SIZE;\n\t\t\tptep++;\n\t\t}\n\n\t\tpl2p++;\n\t}\n\n\tptr = (unsigned long *)__pa(&max_pfn_mapped);\n\t \n\t*ptr = (pte.pte & PTE_PFN_MASK) >> PAGE_SHIFT;\n\n\tptr = (unsigned long *)__pa(&_brk_end);\n\t*ptr = (unsigned long)ptep + PAGE_OFFSET;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}