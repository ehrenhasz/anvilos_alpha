{
  "module_name": "process_32.c",
  "hash_id": "93b2dece445fcb879367ab24b4596ffcd8a73ca35c321aabb0e0fff44ebd85fd",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/process_32.c",
  "human_readable_source": " \n\n \n\n#include <linux/cpu.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/sched/task.h>\n#include <linux/sched/task_stack.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/mm.h>\n#include <linux/elfcore.h>\n#include <linux/smp.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/user.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/mc146818rtc.h>\n#include <linux/export.h>\n#include <linux/kallsyms.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/percpu.h>\n#include <linux/prctl.h>\n#include <linux/ftrace.h>\n#include <linux/uaccess.h>\n#include <linux/io.h>\n#include <linux/kdebug.h>\n#include <linux/syscalls.h>\n\n#include <asm/ldt.h>\n#include <asm/processor.h>\n#include <asm/fpu/sched.h>\n#include <asm/desc.h>\n\n#include <linux/err.h>\n\n#include <asm/tlbflush.h>\n#include <asm/cpu.h>\n#include <asm/debugreg.h>\n#include <asm/switch_to.h>\n#include <asm/vm86.h>\n#include <asm/resctrl.h>\n#include <asm/proto.h>\n\n#include \"process.h\"\n\nvoid __show_regs(struct pt_regs *regs, enum show_regs_mode mode,\n\t\t const char *log_lvl)\n{\n\tunsigned long cr0 = 0L, cr2 = 0L, cr3 = 0L, cr4 = 0L;\n\tunsigned long d0, d1, d2, d3, d6, d7;\n\tunsigned short gs;\n\n\tsavesegment(gs, gs);\n\n\tshow_ip(regs, log_lvl);\n\n\tprintk(\"%sEAX: %08lx EBX: %08lx ECX: %08lx EDX: %08lx\\n\",\n\t\tlog_lvl, regs->ax, regs->bx, regs->cx, regs->dx);\n\tprintk(\"%sESI: %08lx EDI: %08lx EBP: %08lx ESP: %08lx\\n\",\n\t\tlog_lvl, regs->si, regs->di, regs->bp, regs->sp);\n\tprintk(\"%sDS: %04x ES: %04x FS: %04x GS: %04x SS: %04x EFLAGS: %08lx\\n\",\n\t       log_lvl, (u16)regs->ds, (u16)regs->es, (u16)regs->fs, gs, regs->ss, regs->flags);\n\n\tif (mode != SHOW_REGS_ALL)\n\t\treturn;\n\n\tcr0 = read_cr0();\n\tcr2 = read_cr2();\n\tcr3 = __read_cr3();\n\tcr4 = __read_cr4();\n\tprintk(\"%sCR0: %08lx CR2: %08lx CR3: %08lx CR4: %08lx\\n\",\n\t\tlog_lvl, cr0, cr2, cr3, cr4);\n\n\tget_debugreg(d0, 0);\n\tget_debugreg(d1, 1);\n\tget_debugreg(d2, 2);\n\tget_debugreg(d3, 3);\n\tget_debugreg(d6, 6);\n\tget_debugreg(d7, 7);\n\n\t \n\tif ((d0 == 0) && (d1 == 0) && (d2 == 0) && (d3 == 0) &&\n\t    (d6 == DR6_RESERVED) && (d7 == 0x400))\n\t\treturn;\n\n\tprintk(\"%sDR0: %08lx DR1: %08lx DR2: %08lx DR3: %08lx\\n\",\n\t\tlog_lvl, d0, d1, d2, d3);\n\tprintk(\"%sDR6: %08lx DR7: %08lx\\n\",\n\t\tlog_lvl, d6, d7);\n}\n\nvoid release_thread(struct task_struct *dead_task)\n{\n\tBUG_ON(dead_task->mm);\n\trelease_vm86_irqs(dead_task);\n}\n\nvoid\nstart_thread(struct pt_regs *regs, unsigned long new_ip, unsigned long new_sp)\n{\n\tloadsegment(gs, 0);\n\tregs->fs\t\t= 0;\n\tregs->ds\t\t= __USER_DS;\n\tregs->es\t\t= __USER_DS;\n\tregs->ss\t\t= __USER_DS;\n\tregs->cs\t\t= __USER_CS;\n\tregs->ip\t\t= new_ip;\n\tregs->sp\t\t= new_sp;\n\tregs->flags\t\t= X86_EFLAGS_IF;\n}\nEXPORT_SYMBOL_GPL(start_thread);\n\n\n \n__visible __notrace_funcgraph struct task_struct *\n__switch_to(struct task_struct *prev_p, struct task_struct *next_p)\n{\n\tstruct thread_struct *prev = &prev_p->thread,\n\t\t\t     *next = &next_p->thread;\n\tstruct fpu *prev_fpu = &prev->fpu;\n\tint cpu = smp_processor_id();\n\n\t \n\n\tif (!test_thread_flag(TIF_NEED_FPU_LOAD))\n\t\tswitch_fpu_prepare(prev_fpu, cpu);\n\n\t \n\tsavesegment(gs, prev->gs);\n\n\t \n\tload_TLS(next, cpu);\n\n\tswitch_to_extra(prev_p, next_p);\n\n\t \n\tarch_end_context_switch(next_p);\n\n\t \n\tupdate_task_stack(next_p);\n\trefresh_sysenter_cs(next);\n\tthis_cpu_write(pcpu_hot.top_of_stack,\n\t\t       (unsigned long)task_stack_page(next_p) +\n\t\t       THREAD_SIZE);\n\n\t \n\tif (prev->gs | next->gs)\n\t\tloadsegment(gs, next->gs);\n\n\traw_cpu_write(pcpu_hot.current_task, next_p);\n\n\tswitch_fpu_finish();\n\n\t \n\tresctrl_sched_in(next_p);\n\n\treturn prev_p;\n}\n\nSYSCALL_DEFINE2(arch_prctl, int, option, unsigned long, arg2)\n{\n\treturn do_arch_prctl_common(option, arg2);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}