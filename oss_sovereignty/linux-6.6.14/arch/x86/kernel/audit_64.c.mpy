{
  "module_name": "audit_64.c",
  "hash_id": "01925ad82f768573d8cefeae7dc990fa893722d421d197b146c8d0d2672302db",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/audit_64.c",
  "human_readable_source": "\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/audit.h>\n#include <asm/unistd.h>\n#include <asm/audit.h>\n\nstatic unsigned dir_class[] = {\n#include <asm-generic/audit_dir_write.h>\n~0U\n};\n\nstatic unsigned read_class[] = {\n#include <asm-generic/audit_read.h>\n~0U\n};\n\nstatic unsigned write_class[] = {\n#include <asm-generic/audit_write.h>\n~0U\n};\n\nstatic unsigned chattr_class[] = {\n#include <asm-generic/audit_change_attr.h>\n~0U\n};\n\nstatic unsigned signal_class[] = {\n#include <asm-generic/audit_signal.h>\n~0U\n};\n\nint audit_classify_arch(int arch)\n{\n#ifdef CONFIG_IA32_EMULATION\n\tif (arch == AUDIT_ARCH_I386)\n\t\treturn 1;\n#endif\n\treturn 0;\n}\n\nint audit_classify_syscall(int abi, unsigned syscall)\n{\n#ifdef CONFIG_IA32_EMULATION\n\tif (abi == AUDIT_ARCH_I386)\n\t\treturn ia32_classify_syscall(syscall);\n#endif\n\tswitch(syscall) {\n\tcase __NR_open:\n\t\treturn AUDITSC_OPEN;\n\tcase __NR_openat:\n\t\treturn AUDITSC_OPENAT;\n\tcase __NR_execve:\n\tcase __NR_execveat:\n\t\treturn AUDITSC_EXECVE;\n\tcase __NR_openat2:\n\t\treturn AUDITSC_OPENAT2;\n\tdefault:\n\t\treturn AUDITSC_NATIVE;\n\t}\n}\n\nstatic int __init audit_classes_init(void)\n{\n#ifdef CONFIG_IA32_EMULATION\n\taudit_register_class(AUDIT_CLASS_WRITE_32, ia32_write_class);\n\taudit_register_class(AUDIT_CLASS_READ_32, ia32_read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE_32, ia32_dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR_32, ia32_chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL_32, ia32_signal_class);\n#endif\n\taudit_register_class(AUDIT_CLASS_WRITE, write_class);\n\taudit_register_class(AUDIT_CLASS_READ, read_class);\n\taudit_register_class(AUDIT_CLASS_DIR_WRITE, dir_class);\n\taudit_register_class(AUDIT_CLASS_CHATTR, chattr_class);\n\taudit_register_class(AUDIT_CLASS_SIGNAL, signal_class);\n\treturn 0;\n}\n\n__initcall(audit_classes_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}