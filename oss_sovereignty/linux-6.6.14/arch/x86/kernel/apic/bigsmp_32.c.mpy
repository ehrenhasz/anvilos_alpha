{
  "module_name": "bigsmp_32.c",
  "hash_id": "a93fbe842f05db5713ce636d3621ff823cc4365975169e9f92b346e199f60bf0",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kernel/apic/bigsmp_32.c",
  "human_readable_source": "\n \n#include <linux/cpumask.h>\n#include <linux/dmi.h>\n#include <linux/smp.h>\n\n#include <asm/apic.h>\n#include <asm/io_apic.h>\n\n#include \"local.h\"\n\nstatic unsigned bigsmp_get_apic_id(unsigned long x)\n{\n\treturn (x >> 24) & 0xFF;\n}\n\nstatic bool bigsmp_check_apicid_used(physid_mask_t *map, int apicid)\n{\n\treturn false;\n}\n\nstatic void bigsmp_ioapic_phys_id_map(physid_mask_t *phys_map, physid_mask_t *retmap)\n{\n\t \n\tphysids_promote(0xFFL, retmap);\n}\n\nstatic int bigsmp_phys_pkg_id(int cpuid_apic, int index_msb)\n{\n\treturn cpuid_apic >> index_msb;\n}\n\nstatic void bigsmp_send_IPI_allbutself(int vector)\n{\n\tdefault_send_IPI_mask_allbutself_phys(cpu_online_mask, vector);\n}\n\nstatic void bigsmp_send_IPI_all(int vector)\n{\n\tdefault_send_IPI_mask_sequence_phys(cpu_online_mask, vector);\n}\n\nstatic int dmi_bigsmp;  \n\nstatic int hp_ht_bigsmp(const struct dmi_system_id *d)\n{\n\tprintk(KERN_NOTICE \"%s detected: force use of apic=bigsmp\\n\", d->ident);\n\tdmi_bigsmp = 1;\n\n\treturn 0;\n}\n\n\nstatic const struct dmi_system_id bigsmp_dmi_table[] = {\n\t{ hp_ht_bigsmp, \"HP ProLiant DL760 G2\",\n\t\t{\tDMI_MATCH(DMI_BIOS_VENDOR, \"HP\"),\n\t\t\tDMI_MATCH(DMI_BIOS_VERSION, \"P44-\"),\n\t\t}\n\t},\n\n\t{ hp_ht_bigsmp, \"HP ProLiant DL740\",\n\t\t{\tDMI_MATCH(DMI_BIOS_VENDOR, \"HP\"),\n\t\t\tDMI_MATCH(DMI_BIOS_VERSION, \"P47-\"),\n\t\t}\n\t},\n\t{ }  \n};\n\nstatic int probe_bigsmp(void)\n{\n\treturn dmi_check_system(bigsmp_dmi_table);\n}\n\nstatic struct apic apic_bigsmp __ro_after_init = {\n\n\t.name\t\t\t\t= \"bigsmp\",\n\t.probe\t\t\t\t= probe_bigsmp,\n\n\t.delivery_mode\t\t\t= APIC_DELIVERY_MODE_FIXED,\n\t.dest_mode_logical\t\t= false,\n\n\t.disable_esr\t\t\t= 1,\n\n\t.check_apicid_used\t\t= bigsmp_check_apicid_used,\n\t.ioapic_phys_id_map\t\t= bigsmp_ioapic_phys_id_map,\n\t.cpu_present_to_apicid\t\t= default_cpu_present_to_apicid,\n\t.phys_pkg_id\t\t\t= bigsmp_phys_pkg_id,\n\n\t.max_apic_id\t\t\t= 0xFE,\n\t.get_apic_id\t\t\t= bigsmp_get_apic_id,\n\t.set_apic_id\t\t\t= NULL,\n\n\t.calc_dest_apicid\t\t= apic_default_calc_apicid,\n\n\t.send_IPI\t\t\t= default_send_IPI_single_phys,\n\t.send_IPI_mask\t\t\t= default_send_IPI_mask_sequence_phys,\n\t.send_IPI_mask_allbutself\t= NULL,\n\t.send_IPI_allbutself\t\t= bigsmp_send_IPI_allbutself,\n\t.send_IPI_all\t\t\t= bigsmp_send_IPI_all,\n\t.send_IPI_self\t\t\t= default_send_IPI_self,\n\n\t.read\t\t\t\t= native_apic_mem_read,\n\t.write\t\t\t\t= native_apic_mem_write,\n\t.eoi\t\t\t\t= native_apic_mem_eoi,\n\t.icr_read\t\t\t= native_apic_icr_read,\n\t.icr_write\t\t\t= native_apic_icr_write,\n\t.wait_icr_idle\t\t\t= apic_mem_wait_icr_idle,\n\t.safe_wait_icr_idle\t\t= apic_mem_wait_icr_idle_timeout,\n};\n\nbool __init apic_bigsmp_possible(bool cmdline_override)\n{\n\treturn apic == &apic_bigsmp || !cmdline_override;\n}\n\nvoid __init apic_bigsmp_force(void)\n{\n\tif (apic != &apic_bigsmp)\n\t\tapic_install_driver(&apic_bigsmp);\n}\n\napic_driver(apic_bigsmp);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}