{
  "module_name": "xen-asm.S",
  "hash_id": "ba90742ef637017fd4bf7d63c6480fbadbb2658066c7870afc8061cca8652c96",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/xen/xen-asm.S",
  "human_readable_source": " \n \n\n#include <asm/errno.h>\n#include <asm/asm-offsets.h>\n#include <asm/percpu.h>\n#include <asm/processor-flags.h>\n#include <asm/segment.h>\n#include <asm/thread_info.h>\n#include <asm/asm.h>\n#include <asm/frame.h>\n#include <asm/unwind_hints.h>\n\n#include <xen/interface/xen.h>\n\n#include <linux/init.h>\n#include <linux/linkage.h>\n#include <../entry/calling.h>\n\n.pushsection .noinstr.text, \"ax\"\n \nSYM_FUNC_START(xen_irq_disable_direct)\n\tmovb $1, PER_CPU_VAR(xen_vcpu_info) + XEN_vcpu_info_mask\n\tRET\nSYM_FUNC_END(xen_irq_disable_direct)\n\n \nSYM_FUNC_START(check_events)\n\tFRAME_BEGIN\n\tpush %rax\n\tpush %rcx\n\tpush %rdx\n\tpush %rsi\n\tpush %rdi\n\tpush %r8\n\tpush %r9\n\tpush %r10\n\tpush %r11\n\tcall xen_force_evtchn_callback\n\tpop %r11\n\tpop %r10\n\tpop %r9\n\tpop %r8\n\tpop %rdi\n\tpop %rsi\n\tpop %rdx\n\tpop %rcx\n\tpop %rax\n\tFRAME_END\n\tRET\nSYM_FUNC_END(check_events)\n\n \nSYM_FUNC_START(xen_irq_enable_direct)\n\tFRAME_BEGIN\n\t \n\tmovb $0, PER_CPU_VAR(xen_vcpu_info) + XEN_vcpu_info_mask\n\n\t \n\n\t \n\ttestb $0xff, PER_CPU_VAR(xen_vcpu_info) + XEN_vcpu_info_pending\n\tjz 1f\n\n\tcall check_events\n1:\n\tFRAME_END\n\tRET\nSYM_FUNC_END(xen_irq_enable_direct)\n\n \nSYM_FUNC_START(xen_save_fl_direct)\n\ttestb $0xff, PER_CPU_VAR(xen_vcpu_info) + XEN_vcpu_info_mask\n\tsetz %ah\n\taddb %ah, %ah\n\tRET\nSYM_FUNC_END(xen_save_fl_direct)\n\nSYM_FUNC_START(xen_read_cr2)\n\tFRAME_BEGIN\n\t_ASM_MOV PER_CPU_VAR(xen_vcpu), %_ASM_AX\n\t_ASM_MOV XEN_vcpu_info_arch_cr2(%_ASM_AX), %_ASM_AX\n\tFRAME_END\n\tRET\nSYM_FUNC_END(xen_read_cr2);\n\nSYM_FUNC_START(xen_read_cr2_direct)\n\tFRAME_BEGIN\n\t_ASM_MOV PER_CPU_VAR(xen_vcpu_info) + XEN_vcpu_info_arch_cr2, %_ASM_AX\n\tFRAME_END\n\tRET\nSYM_FUNC_END(xen_read_cr2_direct);\n.popsection\n\n.macro xen_pv_trap name\nSYM_CODE_START(xen_\\name)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\tpop %rcx\n\tpop %r11\n\tjmp  \\name\nSYM_CODE_END(xen_\\name)\n_ASM_NOKPROBE(xen_\\name)\n.endm\n\nxen_pv_trap asm_exc_divide_error\nxen_pv_trap asm_xenpv_exc_debug\nxen_pv_trap asm_exc_int3\nxen_pv_trap asm_xenpv_exc_nmi\nxen_pv_trap asm_exc_overflow\nxen_pv_trap asm_exc_bounds\nxen_pv_trap asm_exc_invalid_op\nxen_pv_trap asm_exc_device_not_available\nxen_pv_trap asm_xenpv_exc_double_fault\nxen_pv_trap asm_exc_coproc_segment_overrun\nxen_pv_trap asm_exc_invalid_tss\nxen_pv_trap asm_exc_segment_not_present\nxen_pv_trap asm_exc_stack_segment\nxen_pv_trap asm_exc_general_protection\nxen_pv_trap asm_exc_page_fault\nxen_pv_trap asm_exc_spurious_interrupt_bug\nxen_pv_trap asm_exc_coprocessor_error\nxen_pv_trap asm_exc_alignment_check\n#ifdef CONFIG_X86_CET\nxen_pv_trap asm_exc_control_protection\n#endif\n#ifdef CONFIG_X86_MCE\nxen_pv_trap asm_xenpv_exc_machine_check\n#endif  \nxen_pv_trap asm_exc_simd_coprocessor_error\n#ifdef CONFIG_IA32_EMULATION\nxen_pv_trap asm_int80_emulation\n#endif\nxen_pv_trap asm_exc_xen_unknown_trap\nxen_pv_trap asm_exc_xen_hypervisor_callback\n\n\t__INIT\nSYM_CODE_START(xen_early_idt_handler_array)\n\ti = 0\n\t.rept NUM_EXCEPTION_VECTORS\n\tUNWIND_HINT_UNDEFINED\n\tENDBR\n\tpop %rcx\n\tpop %r11\n\tjmp early_idt_handler_array + i*EARLY_IDT_HANDLER_SIZE\n\ti = i + 1\n\t.fill xen_early_idt_handler_array + i*XEN_EARLY_IDT_HANDLER_SIZE - ., 1, 0xcc\n\t.endr\nSYM_CODE_END(xen_early_idt_handler_array)\n\t__FINIT\n\nhypercall_iret = hypercall_page + __HYPERVISOR_iret * 32\n \nSYM_CODE_START(xen_iret)\n\tUNWIND_HINT_UNDEFINED\n\tANNOTATE_NOENDBR\n\tpushq $0\n\tjmp hypercall_iret\nSYM_CODE_END(xen_iret)\n\n \nSYM_CODE_START(xenpv_restore_regs_and_return_to_usermode)\n\tUNWIND_HINT_REGS\n\tPOP_REGS\n\n\t \n\tSTACKLEAK_ERASE_NOCLOBBER\n\n\taddq\t$8, %rsp\t \n\tjmp xen_iret\nSYM_CODE_END(xenpv_restore_regs_and_return_to_usermode)\n\n \n\n \nSYM_CODE_START(xen_entry_SYSCALL_64)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\tpopq %rcx\n\tpopq %r11\n\n\t \n\tmovq $__USER_DS, 4*8(%rsp)\n\tmovq $__USER_CS, 1*8(%rsp)\n\n\tjmp entry_SYSCALL_64_after_hwframe\nSYM_CODE_END(xen_entry_SYSCALL_64)\n\n#ifdef CONFIG_IA32_EMULATION\n\n \nSYM_CODE_START(xen_entry_SYSCALL_compat)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\tpopq %rcx\n\tpopq %r11\n\n\t \n\tmovq $__USER_DS, 4*8(%rsp)\n\tmovq $__USER32_CS, 1*8(%rsp)\n\n\tjmp entry_SYSCALL_compat_after_hwframe\nSYM_CODE_END(xen_entry_SYSCALL_compat)\n\n \nSYM_CODE_START(xen_entry_SYSENTER_compat)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\t \n\tpopq %rcx\n\tpopq %r11\n\n\t \n\tmovq $__USER_DS, 4*8(%rsp)\n\tmovq $__USER32_CS, 1*8(%rsp)\n\n\tjmp entry_SYSENTER_compat_after_hwframe\nSYM_CODE_END(xen_entry_SYSENTER_compat)\n\n#else  \n\nSYM_CODE_START(xen_entry_SYSCALL_compat)\nSYM_CODE_START(xen_entry_SYSENTER_compat)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\tlea 16(%rsp), %rsp\t \n\tmov $-ENOSYS, %rax\n\tpushq $0\n\tjmp hypercall_iret\nSYM_CODE_END(xen_entry_SYSENTER_compat)\nSYM_CODE_END(xen_entry_SYSCALL_compat)\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}