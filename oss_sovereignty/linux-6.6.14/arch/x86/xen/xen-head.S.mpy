{
  "module_name": "xen-head.S",
  "hash_id": "ab58b5e60b4a8413f5ccafe1dc91b8698ec15d6940ce9a34906dbd25429eb79e",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/xen/xen-head.S",
  "human_readable_source": " \n \n\n#ifdef CONFIG_XEN\n\n#include <linux/elfnote.h>\n#include <linux/init.h>\n\n#include <asm/boot.h>\n#include <asm/asm.h>\n#include <asm/msr.h>\n#include <asm/page_types.h>\n#include <asm/percpu.h>\n#include <asm/unwind_hints.h>\n\n#include <xen/interface/elfnote.h>\n#include <xen/interface/features.h>\n#include <xen/interface/xen.h>\n#include <xen/interface/xen-mca.h>\n#include <asm/xen/interface.h>\n\n.pushsection .noinstr.text, \"ax\"\n\t.balign PAGE_SIZE\nSYM_CODE_START(hypercall_page)\n\t.rept (PAGE_SIZE / 32)\n\t\tUNWIND_HINT_FUNC\n\t\tANNOTATE_NOENDBR\n\t\tANNOTATE_UNRET_SAFE\n\t\tret\n\t\t \n\t\t.skip 31, 0xcc\n\t.endr\n\n#define HYPERCALL(n) \\\n\t.equ xen_hypercall_##n, hypercall_page + __HYPERVISOR_##n * 32; \\\n\t.type xen_hypercall_##n, @function; .size xen_hypercall_##n, 32\n#include <asm/xen-hypercalls.h>\n#undef HYPERCALL\nSYM_CODE_END(hypercall_page)\n.popsection\n\n#ifdef CONFIG_XEN_PV\n\t__INIT\nSYM_CODE_START(startup_xen)\n\tUNWIND_HINT_END_OF_STACK\n\tANNOTATE_NOENDBR\n\tcld\n\n\tleaq\t(__end_init_task - PTREGS_SIZE)(%rip), %rsp\n\n\t \n\tmovl\t$MSR_GS_BASE,%ecx\n\tmovq\t$INIT_PER_CPU_VAR(fixed_percpu_data),%rax\n\tcdq\n\twrmsr\n\n\tmov\t%rsi, %rdi\n\tcall xen_start_kernel\nSYM_CODE_END(startup_xen)\n\t__FINIT\n\n#ifdef CONFIG_XEN_PV_SMP\n.pushsection .text\nSYM_CODE_START(asm_cpu_bringup_and_idle)\n\tUNWIND_HINT_END_OF_STACK\n\tENDBR\n\n\tcall cpu_bringup_and_idle\nSYM_CODE_END(asm_cpu_bringup_and_idle)\n\nSYM_CODE_START(xen_cpu_bringup_again)\n\tUNWIND_HINT_FUNC\n\tmov\t%rdi, %rsp\n\tUNWIND_HINT_REGS\n\tcall\tcpu_bringup_and_idle\nSYM_CODE_END(xen_cpu_bringup_again)\n.popsection\n#endif\n#endif\n\n\tELFNOTE(Xen, XEN_ELFNOTE_GUEST_OS,       .asciz \"linux\")\n\tELFNOTE(Xen, XEN_ELFNOTE_GUEST_VERSION,  .asciz \"2.6\")\n\tELFNOTE(Xen, XEN_ELFNOTE_XEN_VERSION,    .asciz \"xen-3.0\")\n#ifdef CONFIG_XEN_PV\n\tELFNOTE(Xen, XEN_ELFNOTE_VIRT_BASE,      _ASM_PTR __START_KERNEL_map)\n\t \n\tELFNOTE(Xen, XEN_ELFNOTE_INIT_P2M,       .quad (PUD_SIZE * PTRS_PER_PUD))\n\tELFNOTE(Xen, XEN_ELFNOTE_ENTRY,          _ASM_PTR startup_xen)\n\tELFNOTE(Xen, XEN_ELFNOTE_FEATURES,       .ascii \"!writable_page_tables\")\n\tELFNOTE(Xen, XEN_ELFNOTE_PAE_MODE,       .asciz \"yes\")\n\tELFNOTE(Xen, XEN_ELFNOTE_L1_MFN_VALID,\n\t\t.quad _PAGE_PRESENT; .quad _PAGE_PRESENT)\n\tELFNOTE(Xen, XEN_ELFNOTE_MOD_START_PFN,  .long 1)\n\tELFNOTE(Xen, XEN_ELFNOTE_PADDR_OFFSET,   _ASM_PTR 0)\n# define FEATURES_PV (1 << XENFEAT_writable_page_tables)\n#else\n# define FEATURES_PV 0\n#endif\n#ifdef CONFIG_XEN_PVH\n# define FEATURES_PVH (1 << XENFEAT_linux_rsdp_unrestricted)\n#else\n# define FEATURES_PVH 0\n#endif\n#ifdef CONFIG_XEN_DOM0\n# define FEATURES_DOM0 (1 << XENFEAT_dom0)\n#else\n# define FEATURES_DOM0 0\n#endif\n\tELFNOTE(Xen, XEN_ELFNOTE_HYPERCALL_PAGE, _ASM_PTR hypercall_page)\n\tELFNOTE(Xen, XEN_ELFNOTE_SUPPORTED_FEATURES,\n\t\t.long FEATURES_PV | FEATURES_PVH | FEATURES_DOM0)\n\tELFNOTE(Xen, XEN_ELFNOTE_LOADER,         .asciz \"generic\")\n\tELFNOTE(Xen, XEN_ELFNOTE_SUSPEND_CANCEL, .long 1)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}