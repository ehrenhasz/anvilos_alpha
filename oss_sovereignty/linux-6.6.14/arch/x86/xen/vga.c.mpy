{
  "module_name": "vga.c",
  "hash_id": "eb8714243901061aaef6f288043e472b1782c754df028d45587d6df416756bac",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/xen/vga.c",
  "human_readable_source": "\n#include <linux/screen_info.h>\n#include <linux/init.h>\n\n#include <asm/bootparam.h>\n#include <asm/setup.h>\n\n#include <xen/interface/xen.h>\n\n#include \"xen-ops.h\"\n\nvoid __init xen_init_vga(const struct dom0_vga_console_info *info, size_t size,\n\t\t\t struct screen_info *screen_info)\n{\n\t \n\tscreen_info->orig_video_mode = 3;\n\tscreen_info->orig_video_isVGA = 1;\n\tscreen_info->orig_video_lines = 25;\n\tscreen_info->orig_video_cols = 80;\n\tscreen_info->orig_video_ega_bx = 3;\n\tscreen_info->orig_video_points = 16;\n\tscreen_info->orig_y = screen_info->orig_video_lines - 1;\n\n\tswitch (info->video_type) {\n\tcase XEN_VGATYPE_TEXT_MODE_3:\n\t\tif (size < offsetof(struct dom0_vga_console_info, u.text_mode_3)\n\t\t    + sizeof(info->u.text_mode_3))\n\t\t\tbreak;\n\t\tscreen_info->orig_video_lines = info->u.text_mode_3.rows;\n\t\tscreen_info->orig_video_cols = info->u.text_mode_3.columns;\n\t\tscreen_info->orig_x = info->u.text_mode_3.cursor_x;\n\t\tscreen_info->orig_y = info->u.text_mode_3.cursor_y;\n\t\tscreen_info->orig_video_points =\n\t\t\tinfo->u.text_mode_3.font_height;\n\t\tbreak;\n\n\tcase XEN_VGATYPE_EFI_LFB:\n\tcase XEN_VGATYPE_VESA_LFB:\n\t\tif (size < offsetof(struct dom0_vga_console_info,\n\t\t\t\t    u.vesa_lfb.gbl_caps))\n\t\t\tbreak;\n\t\tscreen_info->orig_video_isVGA = VIDEO_TYPE_VLFB;\n\t\tscreen_info->lfb_width = info->u.vesa_lfb.width;\n\t\tscreen_info->lfb_height = info->u.vesa_lfb.height;\n\t\tscreen_info->lfb_depth = info->u.vesa_lfb.bits_per_pixel;\n\t\tscreen_info->lfb_base = info->u.vesa_lfb.lfb_base;\n\t\tscreen_info->lfb_size = info->u.vesa_lfb.lfb_size;\n\t\tscreen_info->lfb_linelength = info->u.vesa_lfb.bytes_per_line;\n\t\tscreen_info->red_size = info->u.vesa_lfb.red_size;\n\t\tscreen_info->red_pos = info->u.vesa_lfb.red_pos;\n\t\tscreen_info->green_size = info->u.vesa_lfb.green_size;\n\t\tscreen_info->green_pos = info->u.vesa_lfb.green_pos;\n\t\tscreen_info->blue_size = info->u.vesa_lfb.blue_size;\n\t\tscreen_info->blue_pos = info->u.vesa_lfb.blue_pos;\n\t\tscreen_info->rsvd_size = info->u.vesa_lfb.rsvd_size;\n\t\tscreen_info->rsvd_pos = info->u.vesa_lfb.rsvd_pos;\n\n\t\tif (size >= offsetof(struct dom0_vga_console_info,\n\t\t\t\t     u.vesa_lfb.ext_lfb_base)\n\t\t    + sizeof(info->u.vesa_lfb.ext_lfb_base)\n\t\t    && info->u.vesa_lfb.ext_lfb_base) {\n\t\t\tscreen_info->ext_lfb_base = info->u.vesa_lfb.ext_lfb_base;\n\t\t\tscreen_info->capabilities |= VIDEO_CAPABILITY_64BIT_BASE;\n\t\t}\n\n\t\tif (info->video_type == XEN_VGATYPE_EFI_LFB) {\n\t\t\tscreen_info->orig_video_isVGA = VIDEO_TYPE_EFI;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (size >= offsetof(struct dom0_vga_console_info,\n\t\t\t\t     u.vesa_lfb.mode_attrs)\n\t\t    + sizeof(info->u.vesa_lfb.mode_attrs))\n\t\t\tscreen_info->vesa_attributes = info->u.vesa_lfb.mode_attrs;\n\t\tbreak;\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}