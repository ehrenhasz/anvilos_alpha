{
  "module_name": "entry_64_compat.S",
  "hash_id": "9ab8e9643926aeca688eeba8f22d24e8b687569c11aae088787686d0b319f8cf",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/entry/entry_64_compat.S",
  "human_readable_source": " \n \n#include <asm/asm-offsets.h>\n#include <asm/current.h>\n#include <asm/errno.h>\n#include <asm/ia32_unistd.h>\n#include <asm/thread_info.h>\n#include <asm/segment.h>\n#include <asm/irqflags.h>\n#include <asm/asm.h>\n#include <asm/smap.h>\n#include <asm/nospec-branch.h>\n#include <linux/linkage.h>\n#include <linux/err.h>\n\n#include \"calling.h\"\n\n\t.section .entry.text, \"ax\"\n\n \nSYM_CODE_START(entry_SYSENTER_compat)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\t \n\tswapgs\n\n\tpushq\t%rax\n\tSWITCH_TO_KERNEL_CR3 scratch_reg=%rax\n\tpopq\t%rax\n\n\tmovq\tPER_CPU_VAR(pcpu_hot + X86_top_of_stack), %rsp\n\n\t \n\tpushq\t$__USER_DS\t\t \n\tpushq\t$0\t\t\t \n\n\t \n\tpushfq\t\t\t\t \n\tpushq\t$__USER32_CS\t\t \n\tpushq\t$0\t\t\t \nSYM_INNER_LABEL(entry_SYSENTER_compat_after_hwframe, SYM_L_GLOBAL)\n\n\t \n\tmovl\t%eax, %eax\n\n\tpushq\t%rax\t\t\t \n\tPUSH_AND_CLEAR_REGS rax=$-ENOSYS\n\tUNWIND_HINT_REGS\n\n\tcld\n\n\tIBRS_ENTER\n\tUNTRAIN_RET\n\n\t \n\ttestl\t$X86_EFLAGS_NT|X86_EFLAGS_AC|X86_EFLAGS_TF, EFLAGS(%rsp)\n\tjnz\t.Lsysenter_fix_flags\n.Lsysenter_flags_fixed:\n\n\tmovq\t%rsp, %rdi\n\tcall\tdo_SYSENTER_32\n\t \n\tALTERNATIVE \"testl %eax, %eax; jz swapgs_restore_regs_and_return_to_usermode\", \\\n\t\t    \"jmp swapgs_restore_regs_and_return_to_usermode\", X86_FEATURE_XENPV\n\tjmp\tsysret32_from_system_call\n\n.Lsysenter_fix_flags:\n\tpushq\t$X86_EFLAGS_FIXED\n\tpopfq\n\tjmp\t.Lsysenter_flags_fixed\nSYM_INNER_LABEL(__end_entry_SYSENTER_compat, SYM_L_GLOBAL)\nSYM_CODE_END(entry_SYSENTER_compat)\n\n \nSYM_CODE_START(entry_SYSCALL_compat)\n\tUNWIND_HINT_ENTRY\n\tENDBR\n\t \n\tswapgs\n\n\t \n\tmovl\t%esp, %r8d\n\n\t \n\tSWITCH_TO_KERNEL_CR3 scratch_reg=%rsp\n\n\t \n\tmovq\tPER_CPU_VAR(pcpu_hot + X86_top_of_stack), %rsp\n\nSYM_INNER_LABEL(entry_SYSCALL_compat_safe_stack, SYM_L_GLOBAL)\n\tANNOTATE_NOENDBR\n\n\t \n\tpushq\t$__USER_DS\t\t \n\tpushq\t%r8\t\t\t \n\tpushq\t%r11\t\t\t \n\tpushq\t$__USER32_CS\t\t \n\tpushq\t%rcx\t\t\t \nSYM_INNER_LABEL(entry_SYSCALL_compat_after_hwframe, SYM_L_GLOBAL)\n\tmovl\t%eax, %eax\t\t \n\tpushq\t%rax\t\t\t \n\tPUSH_AND_CLEAR_REGS rcx=%rbp rax=$-ENOSYS\n\tUNWIND_HINT_REGS\n\n\tIBRS_ENTER\n\tUNTRAIN_RET\n\n\tmovq\t%rsp, %rdi\n\tcall\tdo_fast_syscall_32\n\t \n\tALTERNATIVE \"testl %eax, %eax; jz swapgs_restore_regs_and_return_to_usermode\", \\\n\t\t    \"jmp swapgs_restore_regs_and_return_to_usermode\", X86_FEATURE_XENPV\n\n\t \nsysret32_from_system_call:\n\t \n\tSTACKLEAK_ERASE\n\n\tIBRS_EXIT\n\n\tmovq\tRBX(%rsp), %rbx\t\t \n\tmovq\tRBP(%rsp), %rbp\t\t \n\tmovq\tEFLAGS(%rsp), %r11\t \n\tmovq\tRIP(%rsp), %rcx\t\t \n\taddq\t$RAX, %rsp\t\t \n\tpopq\t%rax\t\t\t \n\tpopq\t%rdx\t\t\t \n\tpopq\t%rdx\t\t\t \n\tpopq\t%rsi\t\t\t \n\tpopq\t%rdi\t\t\t \n\n         \n\tmovq\tRSP-ORIG_RAX(%rsp), %rsp\nSYM_INNER_LABEL(entry_SYSRETL_compat_unsafe_stack, SYM_L_GLOBAL)\n\tANNOTATE_NOENDBR\n\n\t \n\tSWITCH_TO_USER_CR3_NOSTACK scratch_reg=%r8 scratch_reg2=%r9\n\n\txorl\t%r8d, %r8d\n\txorl\t%r9d, %r9d\n\txorl\t%r10d, %r10d\n\tswapgs\n\tsysretl\nSYM_INNER_LABEL(entry_SYSRETL_compat_end, SYM_L_GLOBAL)\n\tANNOTATE_NOENDBR\n\tint3\nSYM_CODE_END(entry_SYSCALL_compat)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}