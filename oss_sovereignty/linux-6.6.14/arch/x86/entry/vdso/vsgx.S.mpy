{
  "module_name": "vsgx.S",
  "hash_id": "3b90e653f39e432351a09968ecdeeb4c3d51f8d6945cfd733d5e9c807f8b12bc",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/entry/vdso/vsgx.S",
  "human_readable_source": " \n\n#include <linux/linkage.h>\n#include <asm/export.h>\n#include <asm/errno.h>\n#include <asm/enclu.h>\n\n#include \"extable.h\"\n\n \n#define SGX_ENCLAVE_OFFSET_OF_RUN\t\t16\n\n \n#define SGX_ENCLAVE_RUN_TCS\t\t\t0\n#define SGX_ENCLAVE_RUN_LEAF\t\t\t8\n#define SGX_ENCLAVE_RUN_EXCEPTION_VECTOR\t12\n#define SGX_ENCLAVE_RUN_EXCEPTION_ERROR_CODE\t14\n#define SGX_ENCLAVE_RUN_EXCEPTION_ADDR\t\t16\n#define SGX_ENCLAVE_RUN_USER_HANDLER\t\t24\n#define SGX_ENCLAVE_RUN_USER_DATA\t\t32\t \n#define SGX_ENCLAVE_RUN_RESERVED_START\t\t40\n#define SGX_ENCLAVE_RUN_RESERVED_END\t\t256\n\n.code64\n.section .text, \"ax\"\n\nSYM_FUNC_START(__vdso_sgx_enter_enclave)\n\t \n\t.cfi_startproc\n\tpush\t%rbp\n\t.cfi_adjust_cfa_offset\t8\n\t.cfi_rel_offset\t\t%rbp, 0\n\tmov\t%rsp, %rbp\n\t.cfi_def_cfa_register\t%rbp\n\tpush\t%rbx\n\t.cfi_rel_offset\t\t%rbx, -8\n\n\tmov\t%ecx, %eax\n.Lenter_enclave:\n\t \n\tcmp\t$EENTER, %eax\n\tjb\t.Linvalid_input\n\tcmp\t$ERESUME, %eax\n\tja\t.Linvalid_input\n\n\tmov\tSGX_ENCLAVE_OFFSET_OF_RUN(%rbp), %rcx\n\n\t \n\tmov\t$SGX_ENCLAVE_RUN_RESERVED_START, %rbx\n1:\n\tcmpq\t$0, (%rcx, %rbx)\n\tjne\t.Linvalid_input\n\tadd\t$8, %rbx\n\tcmpq\t$SGX_ENCLAVE_RUN_RESERVED_END, %rbx\n\tjne\t1b\n\n\t \n\tmov\tSGX_ENCLAVE_RUN_TCS(%rcx), %rbx\n\tlea\t.Lasync_exit_pointer(%rip), %rcx\n\n\t \n.Lasync_exit_pointer:\n.Lenclu_eenter_eresume:\n\tenclu\n\n\t \n\tmov\tSGX_ENCLAVE_OFFSET_OF_RUN(%rbp), %rbx\n\n\t \n\tmovl\t$EEXIT, SGX_ENCLAVE_RUN_LEAF(%rbx)\n\n\t \n.Lhandle_exit:\n\tcmpq\t$0, SGX_ENCLAVE_RUN_USER_HANDLER(%rbx)\n\tjne\t.Linvoke_userspace_handler\n\n\t \n\txor\t%eax, %eax\n\n.Lout:\n\tpop\t%rbx\n\tleave\n\t.cfi_def_cfa\t\t%rsp, 8\n\tRET\n\n\t \n\t.cfi_def_cfa\t\t%rbp, 16\n\n.Linvalid_input:\n\tmov\t$(-EINVAL), %eax\n\tjmp\t.Lout\n\n.Lhandle_exception:\n\tmov\tSGX_ENCLAVE_OFFSET_OF_RUN(%rbp), %rbx\n\n\t \n\tmov\t%eax, (SGX_ENCLAVE_RUN_LEAF)(%rbx)\n\tmov\t%di,  (SGX_ENCLAVE_RUN_EXCEPTION_VECTOR)(%rbx)\n\tmov\t%si,  (SGX_ENCLAVE_RUN_EXCEPTION_ERROR_CODE)(%rbx)\n\tmov\t%rdx, (SGX_ENCLAVE_RUN_EXCEPTION_ADDR)(%rbx)\n\tjmp\t.Lhandle_exit\n\n.Linvoke_userspace_handler:\n\t \n\tmov\t%rsp, %rcx\n\n\t \n\tmov\t%rbx, %rax\n\n\t \n\tmov\t%rsp, %rbx\n\tand\t$0xf, %rbx\n\n\t \n\tand\t$-0x10, %rsp\n\tpush\t%rax\n\n\t \n\tpush\t%rax\n\n\t \n\tcld\n\n\t \n\tmov\tSGX_ENCLAVE_RUN_USER_HANDLER(%rax), %rax\n\tlfence\n\tcall\t*%rax\n\n\t \n\tlea\t0x10(%rsp, %rbx), %rsp\n\n\t \n\tcmp\t$0, %eax\n\tjle\t.Lout\n\tjmp\t.Lenter_enclave\n\n\t.cfi_endproc\n\n_ASM_VDSO_EXTABLE_HANDLE(.Lenclu_eenter_eresume, .Lhandle_exception)\n\nSYM_FUNC_END(__vdso_sgx_enter_enclave)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}