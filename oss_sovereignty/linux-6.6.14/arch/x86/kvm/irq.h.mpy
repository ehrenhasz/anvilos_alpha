{
  "module_name": "irq.h",
  "hash_id": "59d2f2db4c549f197e30107a00dfcae41d14716046fd5480b43c8cbf4764c5cf",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kvm/irq.h",
  "human_readable_source": " \n \n\n#ifndef __IRQ_H\n#define __IRQ_H\n\n#include <linux/mm_types.h>\n#include <linux/hrtimer.h>\n#include <linux/kvm_host.h>\n#include <linux/spinlock.h>\n\n#include <kvm/iodev.h>\n#include \"lapic.h\"\n\n#define PIC_NUM_PINS 16\n#define SELECT_PIC(irq) \\\n\t((irq) < 8 ? KVM_IRQCHIP_PIC_MASTER : KVM_IRQCHIP_PIC_SLAVE)\n\nstruct kvm;\nstruct kvm_vcpu;\n\nstruct kvm_kpic_state {\n\tu8 last_irr;\t \n\tu8 irr;\t\t \n\tu8 imr;\t\t \n\tu8 isr;\t\t \n\tu8 priority_add;\t \n\tu8 irq_base;\n\tu8 read_reg_select;\n\tu8 poll;\n\tu8 special_mask;\n\tu8 init_state;\n\tu8 auto_eoi;\n\tu8 rotate_on_auto_eoi;\n\tu8 special_fully_nested_mode;\n\tu8 init4;\t\t \n\tu8 elcr;\t\t \n\tu8 elcr_mask;\n\tu8 isr_ack;\t \n\tstruct kvm_pic *pics_state;\n};\n\nstruct kvm_pic {\n\tspinlock_t lock;\n\tbool wakeup_needed;\n\tunsigned pending_acks;\n\tstruct kvm *kvm;\n\tstruct kvm_kpic_state pics[2];  \n\tint output;\t\t \n\tstruct kvm_io_device dev_master;\n\tstruct kvm_io_device dev_slave;\n\tstruct kvm_io_device dev_elcr;\n\tunsigned long irq_states[PIC_NUM_PINS];\n};\n\nint kvm_pic_init(struct kvm *kvm);\nvoid kvm_pic_destroy(struct kvm *kvm);\nint kvm_pic_read_irq(struct kvm *kvm);\nvoid kvm_pic_update_irq(struct kvm_pic *s);\n\nstatic inline int irqchip_split(struct kvm *kvm)\n{\n\tint mode = kvm->arch.irqchip_mode;\n\n\t \n\tsmp_rmb();\n\treturn mode == KVM_IRQCHIP_SPLIT;\n}\n\nstatic inline int irqchip_kernel(struct kvm *kvm)\n{\n\tint mode = kvm->arch.irqchip_mode;\n\n\t \n\tsmp_rmb();\n\treturn mode == KVM_IRQCHIP_KERNEL;\n}\n\nstatic inline int pic_in_kernel(struct kvm *kvm)\n{\n\treturn irqchip_kernel(kvm);\n}\n\nstatic inline int irqchip_in_kernel(struct kvm *kvm)\n{\n\tint mode = kvm->arch.irqchip_mode;\n\n\t \n\tsmp_rmb();\n\treturn mode != KVM_IRQCHIP_NONE;\n}\n\nvoid kvm_inject_pending_timer_irqs(struct kvm_vcpu *vcpu);\nvoid kvm_inject_apic_timer_irqs(struct kvm_vcpu *vcpu);\nvoid kvm_apic_nmi_wd_deliver(struct kvm_vcpu *vcpu);\nvoid __kvm_migrate_apic_timer(struct kvm_vcpu *vcpu);\nvoid __kvm_migrate_pit_timer(struct kvm_vcpu *vcpu);\nvoid __kvm_migrate_timers(struct kvm_vcpu *vcpu);\n\nint apic_has_pending_timer(struct kvm_vcpu *vcpu);\n\nint kvm_setup_default_irq_routing(struct kvm *kvm);\nint kvm_setup_empty_irq_routing(struct kvm *kvm);\nint kvm_irq_delivery_to_apic(struct kvm *kvm, struct kvm_lapic *src,\n\t\t\t     struct kvm_lapic_irq *irq,\n\t\t\t     struct dest_map *dest_map);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}