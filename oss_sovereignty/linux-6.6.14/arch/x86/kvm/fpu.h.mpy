{
  "module_name": "fpu.h",
  "hash_id": "24795b4bcd20f445eab37bdad93fb5402c9f721ca3c369a1496a996494035135",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kvm/fpu.h",
  "human_readable_source": " \n\n#ifndef __KVM_FPU_H_\n#define __KVM_FPU_H_\n\n#include <asm/fpu/api.h>\n\ntypedef u32\t\t__attribute__((vector_size(16))) sse128_t;\n#define __sse128_u\tunion { sse128_t vec; u64 as_u64[2]; u32 as_u32[4]; }\n#define sse128_lo(x)\t({ __sse128_u t; t.vec = x; t.as_u64[0]; })\n#define sse128_hi(x)\t({ __sse128_u t; t.vec = x; t.as_u64[1]; })\n#define sse128_l0(x)\t({ __sse128_u t; t.vec = x; t.as_u32[0]; })\n#define sse128_l1(x)\t({ __sse128_u t; t.vec = x; t.as_u32[1]; })\n#define sse128_l2(x)\t({ __sse128_u t; t.vec = x; t.as_u32[2]; })\n#define sse128_l3(x)\t({ __sse128_u t; t.vec = x; t.as_u32[3]; })\n#define sse128(lo, hi)\t({ __sse128_u t; t.as_u64[0] = lo; t.as_u64[1] = hi; t.vec; })\n\nstatic inline void _kvm_read_sse_reg(int reg, sse128_t *data)\n{\n\tswitch (reg) {\n\tcase 0: asm(\"movdqa %%xmm0, %0\" : \"=m\"(*data)); break;\n\tcase 1: asm(\"movdqa %%xmm1, %0\" : \"=m\"(*data)); break;\n\tcase 2: asm(\"movdqa %%xmm2, %0\" : \"=m\"(*data)); break;\n\tcase 3: asm(\"movdqa %%xmm3, %0\" : \"=m\"(*data)); break;\n\tcase 4: asm(\"movdqa %%xmm4, %0\" : \"=m\"(*data)); break;\n\tcase 5: asm(\"movdqa %%xmm5, %0\" : \"=m\"(*data)); break;\n\tcase 6: asm(\"movdqa %%xmm6, %0\" : \"=m\"(*data)); break;\n\tcase 7: asm(\"movdqa %%xmm7, %0\" : \"=m\"(*data)); break;\n#ifdef CONFIG_X86_64\n\tcase 8: asm(\"movdqa %%xmm8, %0\" : \"=m\"(*data)); break;\n\tcase 9: asm(\"movdqa %%xmm9, %0\" : \"=m\"(*data)); break;\n\tcase 10: asm(\"movdqa %%xmm10, %0\" : \"=m\"(*data)); break;\n\tcase 11: asm(\"movdqa %%xmm11, %0\" : \"=m\"(*data)); break;\n\tcase 12: asm(\"movdqa %%xmm12, %0\" : \"=m\"(*data)); break;\n\tcase 13: asm(\"movdqa %%xmm13, %0\" : \"=m\"(*data)); break;\n\tcase 14: asm(\"movdqa %%xmm14, %0\" : \"=m\"(*data)); break;\n\tcase 15: asm(\"movdqa %%xmm15, %0\" : \"=m\"(*data)); break;\n#endif\n\tdefault: BUG();\n\t}\n}\n\nstatic inline void _kvm_write_sse_reg(int reg, const sse128_t *data)\n{\n\tswitch (reg) {\n\tcase 0: asm(\"movdqa %0, %%xmm0\" : : \"m\"(*data)); break;\n\tcase 1: asm(\"movdqa %0, %%xmm1\" : : \"m\"(*data)); break;\n\tcase 2: asm(\"movdqa %0, %%xmm2\" : : \"m\"(*data)); break;\n\tcase 3: asm(\"movdqa %0, %%xmm3\" : : \"m\"(*data)); break;\n\tcase 4: asm(\"movdqa %0, %%xmm4\" : : \"m\"(*data)); break;\n\tcase 5: asm(\"movdqa %0, %%xmm5\" : : \"m\"(*data)); break;\n\tcase 6: asm(\"movdqa %0, %%xmm6\" : : \"m\"(*data)); break;\n\tcase 7: asm(\"movdqa %0, %%xmm7\" : : \"m\"(*data)); break;\n#ifdef CONFIG_X86_64\n\tcase 8: asm(\"movdqa %0, %%xmm8\" : : \"m\"(*data)); break;\n\tcase 9: asm(\"movdqa %0, %%xmm9\" : : \"m\"(*data)); break;\n\tcase 10: asm(\"movdqa %0, %%xmm10\" : : \"m\"(*data)); break;\n\tcase 11: asm(\"movdqa %0, %%xmm11\" : : \"m\"(*data)); break;\n\tcase 12: asm(\"movdqa %0, %%xmm12\" : : \"m\"(*data)); break;\n\tcase 13: asm(\"movdqa %0, %%xmm13\" : : \"m\"(*data)); break;\n\tcase 14: asm(\"movdqa %0, %%xmm14\" : : \"m\"(*data)); break;\n\tcase 15: asm(\"movdqa %0, %%xmm15\" : : \"m\"(*data)); break;\n#endif\n\tdefault: BUG();\n\t}\n}\n\nstatic inline void _kvm_read_mmx_reg(int reg, u64 *data)\n{\n\tswitch (reg) {\n\tcase 0: asm(\"movq %%mm0, %0\" : \"=m\"(*data)); break;\n\tcase 1: asm(\"movq %%mm1, %0\" : \"=m\"(*data)); break;\n\tcase 2: asm(\"movq %%mm2, %0\" : \"=m\"(*data)); break;\n\tcase 3: asm(\"movq %%mm3, %0\" : \"=m\"(*data)); break;\n\tcase 4: asm(\"movq %%mm4, %0\" : \"=m\"(*data)); break;\n\tcase 5: asm(\"movq %%mm5, %0\" : \"=m\"(*data)); break;\n\tcase 6: asm(\"movq %%mm6, %0\" : \"=m\"(*data)); break;\n\tcase 7: asm(\"movq %%mm7, %0\" : \"=m\"(*data)); break;\n\tdefault: BUG();\n\t}\n}\n\nstatic inline void _kvm_write_mmx_reg(int reg, const u64 *data)\n{\n\tswitch (reg) {\n\tcase 0: asm(\"movq %0, %%mm0\" : : \"m\"(*data)); break;\n\tcase 1: asm(\"movq %0, %%mm1\" : : \"m\"(*data)); break;\n\tcase 2: asm(\"movq %0, %%mm2\" : : \"m\"(*data)); break;\n\tcase 3: asm(\"movq %0, %%mm3\" : : \"m\"(*data)); break;\n\tcase 4: asm(\"movq %0, %%mm4\" : : \"m\"(*data)); break;\n\tcase 5: asm(\"movq %0, %%mm5\" : : \"m\"(*data)); break;\n\tcase 6: asm(\"movq %0, %%mm6\" : : \"m\"(*data)); break;\n\tcase 7: asm(\"movq %0, %%mm7\" : : \"m\"(*data)); break;\n\tdefault: BUG();\n\t}\n}\n\nstatic inline void kvm_fpu_get(void)\n{\n\tfpregs_lock();\n\n\tfpregs_assert_state_consistent();\n\tif (test_thread_flag(TIF_NEED_FPU_LOAD))\n\t\tswitch_fpu_return();\n}\n\nstatic inline void kvm_fpu_put(void)\n{\n\tfpregs_unlock();\n}\n\nstatic inline void kvm_read_sse_reg(int reg, sse128_t *data)\n{\n\tkvm_fpu_get();\n\t_kvm_read_sse_reg(reg, data);\n\tkvm_fpu_put();\n}\n\nstatic inline void kvm_write_sse_reg(int reg, const sse128_t *data)\n{\n\tkvm_fpu_get();\n\t_kvm_write_sse_reg(reg, data);\n\tkvm_fpu_put();\n}\n\nstatic inline void kvm_read_mmx_reg(int reg, u64 *data)\n{\n\tkvm_fpu_get();\n\t_kvm_read_mmx_reg(reg, data);\n\tkvm_fpu_put();\n}\n\nstatic inline void kvm_write_mmx_reg(int reg, const u64 *data)\n{\n\tkvm_fpu_get();\n\t_kvm_write_mmx_reg(reg, data);\n\tkvm_fpu_put();\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}