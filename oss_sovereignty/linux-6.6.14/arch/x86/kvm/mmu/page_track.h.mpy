{
  "module_name": "page_track.h",
  "hash_id": "ce26bacd138f8856775533dfb225d74e8055ce40259531a9443f9bbbb32af5e6",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kvm/mmu/page_track.h",
  "human_readable_source": " \n#ifndef __KVM_X86_PAGE_TRACK_H\n#define __KVM_X86_PAGE_TRACK_H\n\n#include <linux/kvm_host.h>\n\n#include <asm/kvm_page_track.h>\n\n\nbool kvm_page_track_write_tracking_enabled(struct kvm *kvm);\nint kvm_page_track_write_tracking_alloc(struct kvm_memory_slot *slot);\n\nvoid kvm_page_track_free_memslot(struct kvm_memory_slot *slot);\nint kvm_page_track_create_memslot(struct kvm *kvm,\n\t\t\t\t  struct kvm_memory_slot *slot,\n\t\t\t\t  unsigned long npages);\n\nvoid __kvm_write_track_add_gfn(struct kvm *kvm, struct kvm_memory_slot *slot,\n\t\t\t       gfn_t gfn);\nvoid __kvm_write_track_remove_gfn(struct kvm *kvm,\n\t\t\t\t  struct kvm_memory_slot *slot, gfn_t gfn);\n\nbool kvm_gfn_is_write_tracked(struct kvm *kvm,\n\t\t\t      const struct kvm_memory_slot *slot, gfn_t gfn);\n\n#ifdef CONFIG_KVM_EXTERNAL_WRITE_TRACKING\nint kvm_page_track_init(struct kvm *kvm);\nvoid kvm_page_track_cleanup(struct kvm *kvm);\n\nvoid __kvm_page_track_write(struct kvm *kvm, gpa_t gpa, const u8 *new, int bytes);\nvoid kvm_page_track_delete_slot(struct kvm *kvm, struct kvm_memory_slot *slot);\n\nstatic inline bool kvm_page_track_has_external_user(struct kvm *kvm)\n{\n\treturn !hlist_empty(&kvm->arch.track_notifier_head.track_notifier_list);\n}\n#else\nstatic inline int kvm_page_track_init(struct kvm *kvm) { return 0; }\nstatic inline void kvm_page_track_cleanup(struct kvm *kvm) { }\n\nstatic inline void __kvm_page_track_write(struct kvm *kvm, gpa_t gpa,\n\t\t\t\t\t  const u8 *new, int bytes) { }\nstatic inline void kvm_page_track_delete_slot(struct kvm *kvm,\n\t\t\t\t\t      struct kvm_memory_slot *slot) { }\n\nstatic inline bool kvm_page_track_has_external_user(struct kvm *kvm) { return false; }\n\n#endif  \n\nstatic inline void kvm_page_track_write(struct kvm_vcpu *vcpu, gpa_t gpa,\n\t\t\t\t\tconst u8 *new, int bytes)\n{\n\t__kvm_page_track_write(vcpu->kvm, gpa, new, bytes);\n\n\tkvm_mmu_track_write(vcpu, gpa, new, bytes);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}