{
  "module_name": "vmcs12.h",
  "hash_id": "010557ce73266f92df29201a85a7aa413ed42ef4486cf7eb9524df55bfb2d5ea",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/kvm/vmx/vmcs12.h",
  "human_readable_source": " \n#ifndef __KVM_X86_VMX_VMCS12_H\n#define __KVM_X86_VMX_VMCS12_H\n\n#include <linux/build_bug.h>\n\n#include \"vmcs.h\"\n\n \ntypedef u64 natural_width;\nstruct __packed vmcs12 {\n\t \n\tstruct vmcs_hdr hdr;\n\tu32 abort;\n\n\tu32 launch_state;  \n\tu32 padding[7];  \n\n\tu64 io_bitmap_a;\n\tu64 io_bitmap_b;\n\tu64 msr_bitmap;\n\tu64 vm_exit_msr_store_addr;\n\tu64 vm_exit_msr_load_addr;\n\tu64 vm_entry_msr_load_addr;\n\tu64 tsc_offset;\n\tu64 virtual_apic_page_addr;\n\tu64 apic_access_addr;\n\tu64 posted_intr_desc_addr;\n\tu64 ept_pointer;\n\tu64 eoi_exit_bitmap0;\n\tu64 eoi_exit_bitmap1;\n\tu64 eoi_exit_bitmap2;\n\tu64 eoi_exit_bitmap3;\n\tu64 xss_exit_bitmap;\n\tu64 guest_physical_address;\n\tu64 vmcs_link_pointer;\n\tu64 guest_ia32_debugctl;\n\tu64 guest_ia32_pat;\n\tu64 guest_ia32_efer;\n\tu64 guest_ia32_perf_global_ctrl;\n\tu64 guest_pdptr0;\n\tu64 guest_pdptr1;\n\tu64 guest_pdptr2;\n\tu64 guest_pdptr3;\n\tu64 guest_bndcfgs;\n\tu64 host_ia32_pat;\n\tu64 host_ia32_efer;\n\tu64 host_ia32_perf_global_ctrl;\n\tu64 vmread_bitmap;\n\tu64 vmwrite_bitmap;\n\tu64 vm_function_control;\n\tu64 eptp_list_address;\n\tu64 pml_address;\n\tu64 encls_exiting_bitmap;\n\tu64 tsc_multiplier;\n\tu64 padding64[1];  \n\t \n\tnatural_width cr0_guest_host_mask;\n\tnatural_width cr4_guest_host_mask;\n\tnatural_width cr0_read_shadow;\n\tnatural_width cr4_read_shadow;\n\tnatural_width dead_space[4];  \n\tnatural_width exit_qualification;\n\tnatural_width guest_linear_address;\n\tnatural_width guest_cr0;\n\tnatural_width guest_cr3;\n\tnatural_width guest_cr4;\n\tnatural_width guest_es_base;\n\tnatural_width guest_cs_base;\n\tnatural_width guest_ss_base;\n\tnatural_width guest_ds_base;\n\tnatural_width guest_fs_base;\n\tnatural_width guest_gs_base;\n\tnatural_width guest_ldtr_base;\n\tnatural_width guest_tr_base;\n\tnatural_width guest_gdtr_base;\n\tnatural_width guest_idtr_base;\n\tnatural_width guest_dr7;\n\tnatural_width guest_rsp;\n\tnatural_width guest_rip;\n\tnatural_width guest_rflags;\n\tnatural_width guest_pending_dbg_exceptions;\n\tnatural_width guest_sysenter_esp;\n\tnatural_width guest_sysenter_eip;\n\tnatural_width host_cr0;\n\tnatural_width host_cr3;\n\tnatural_width host_cr4;\n\tnatural_width host_fs_base;\n\tnatural_width host_gs_base;\n\tnatural_width host_tr_base;\n\tnatural_width host_gdtr_base;\n\tnatural_width host_idtr_base;\n\tnatural_width host_ia32_sysenter_esp;\n\tnatural_width host_ia32_sysenter_eip;\n\tnatural_width host_rsp;\n\tnatural_width host_rip;\n\tnatural_width paddingl[8];  \n\tu32 pin_based_vm_exec_control;\n\tu32 cpu_based_vm_exec_control;\n\tu32 exception_bitmap;\n\tu32 page_fault_error_code_mask;\n\tu32 page_fault_error_code_match;\n\tu32 cr3_target_count;\n\tu32 vm_exit_controls;\n\tu32 vm_exit_msr_store_count;\n\tu32 vm_exit_msr_load_count;\n\tu32 vm_entry_controls;\n\tu32 vm_entry_msr_load_count;\n\tu32 vm_entry_intr_info_field;\n\tu32 vm_entry_exception_error_code;\n\tu32 vm_entry_instruction_len;\n\tu32 tpr_threshold;\n\tu32 secondary_vm_exec_control;\n\tu32 vm_instruction_error;\n\tu32 vm_exit_reason;\n\tu32 vm_exit_intr_info;\n\tu32 vm_exit_intr_error_code;\n\tu32 idt_vectoring_info_field;\n\tu32 idt_vectoring_error_code;\n\tu32 vm_exit_instruction_len;\n\tu32 vmx_instruction_info;\n\tu32 guest_es_limit;\n\tu32 guest_cs_limit;\n\tu32 guest_ss_limit;\n\tu32 guest_ds_limit;\n\tu32 guest_fs_limit;\n\tu32 guest_gs_limit;\n\tu32 guest_ldtr_limit;\n\tu32 guest_tr_limit;\n\tu32 guest_gdtr_limit;\n\tu32 guest_idtr_limit;\n\tu32 guest_es_ar_bytes;\n\tu32 guest_cs_ar_bytes;\n\tu32 guest_ss_ar_bytes;\n\tu32 guest_ds_ar_bytes;\n\tu32 guest_fs_ar_bytes;\n\tu32 guest_gs_ar_bytes;\n\tu32 guest_ldtr_ar_bytes;\n\tu32 guest_tr_ar_bytes;\n\tu32 guest_interruptibility_info;\n\tu32 guest_activity_state;\n\tu32 guest_sysenter_cs;\n\tu32 host_ia32_sysenter_cs;\n\tu32 vmx_preemption_timer_value;\n\tu32 padding32[7];  \n\tu16 virtual_processor_id;\n\tu16 posted_intr_nv;\n\tu16 guest_es_selector;\n\tu16 guest_cs_selector;\n\tu16 guest_ss_selector;\n\tu16 guest_ds_selector;\n\tu16 guest_fs_selector;\n\tu16 guest_gs_selector;\n\tu16 guest_ldtr_selector;\n\tu16 guest_tr_selector;\n\tu16 guest_intr_status;\n\tu16 host_es_selector;\n\tu16 host_cs_selector;\n\tu16 host_ss_selector;\n\tu16 host_ds_selector;\n\tu16 host_fs_selector;\n\tu16 host_gs_selector;\n\tu16 host_tr_selector;\n\tu16 guest_pml_index;\n};\n\n \n#define VMCS12_REVISION 0x11e57ed0\n\n \n#define VMCS12_SIZE\t\tKVM_STATE_NESTED_VMX_VMCS_SIZE\n\n \n#define CHECK_OFFSET(field, loc) \\\n\tASSERT_STRUCT_OFFSET(struct vmcs12, field, loc)\n\nstatic inline void vmx_check_vmcs12_offsets(void)\n{\n\tCHECK_OFFSET(hdr, 0);\n\tCHECK_OFFSET(abort, 4);\n\tCHECK_OFFSET(launch_state, 8);\n\tCHECK_OFFSET(io_bitmap_a, 40);\n\tCHECK_OFFSET(io_bitmap_b, 48);\n\tCHECK_OFFSET(msr_bitmap, 56);\n\tCHECK_OFFSET(vm_exit_msr_store_addr, 64);\n\tCHECK_OFFSET(vm_exit_msr_load_addr, 72);\n\tCHECK_OFFSET(vm_entry_msr_load_addr, 80);\n\tCHECK_OFFSET(tsc_offset, 88);\n\tCHECK_OFFSET(virtual_apic_page_addr, 96);\n\tCHECK_OFFSET(apic_access_addr, 104);\n\tCHECK_OFFSET(posted_intr_desc_addr, 112);\n\tCHECK_OFFSET(ept_pointer, 120);\n\tCHECK_OFFSET(eoi_exit_bitmap0, 128);\n\tCHECK_OFFSET(eoi_exit_bitmap1, 136);\n\tCHECK_OFFSET(eoi_exit_bitmap2, 144);\n\tCHECK_OFFSET(eoi_exit_bitmap3, 152);\n\tCHECK_OFFSET(xss_exit_bitmap, 160);\n\tCHECK_OFFSET(guest_physical_address, 168);\n\tCHECK_OFFSET(vmcs_link_pointer, 176);\n\tCHECK_OFFSET(guest_ia32_debugctl, 184);\n\tCHECK_OFFSET(guest_ia32_pat, 192);\n\tCHECK_OFFSET(guest_ia32_efer, 200);\n\tCHECK_OFFSET(guest_ia32_perf_global_ctrl, 208);\n\tCHECK_OFFSET(guest_pdptr0, 216);\n\tCHECK_OFFSET(guest_pdptr1, 224);\n\tCHECK_OFFSET(guest_pdptr2, 232);\n\tCHECK_OFFSET(guest_pdptr3, 240);\n\tCHECK_OFFSET(guest_bndcfgs, 248);\n\tCHECK_OFFSET(host_ia32_pat, 256);\n\tCHECK_OFFSET(host_ia32_efer, 264);\n\tCHECK_OFFSET(host_ia32_perf_global_ctrl, 272);\n\tCHECK_OFFSET(vmread_bitmap, 280);\n\tCHECK_OFFSET(vmwrite_bitmap, 288);\n\tCHECK_OFFSET(vm_function_control, 296);\n\tCHECK_OFFSET(eptp_list_address, 304);\n\tCHECK_OFFSET(pml_address, 312);\n\tCHECK_OFFSET(encls_exiting_bitmap, 320);\n\tCHECK_OFFSET(tsc_multiplier, 328);\n\tCHECK_OFFSET(cr0_guest_host_mask, 344);\n\tCHECK_OFFSET(cr4_guest_host_mask, 352);\n\tCHECK_OFFSET(cr0_read_shadow, 360);\n\tCHECK_OFFSET(cr4_read_shadow, 368);\n\tCHECK_OFFSET(dead_space, 376);\n\tCHECK_OFFSET(exit_qualification, 408);\n\tCHECK_OFFSET(guest_linear_address, 416);\n\tCHECK_OFFSET(guest_cr0, 424);\n\tCHECK_OFFSET(guest_cr3, 432);\n\tCHECK_OFFSET(guest_cr4, 440);\n\tCHECK_OFFSET(guest_es_base, 448);\n\tCHECK_OFFSET(guest_cs_base, 456);\n\tCHECK_OFFSET(guest_ss_base, 464);\n\tCHECK_OFFSET(guest_ds_base, 472);\n\tCHECK_OFFSET(guest_fs_base, 480);\n\tCHECK_OFFSET(guest_gs_base, 488);\n\tCHECK_OFFSET(guest_ldtr_base, 496);\n\tCHECK_OFFSET(guest_tr_base, 504);\n\tCHECK_OFFSET(guest_gdtr_base, 512);\n\tCHECK_OFFSET(guest_idtr_base, 520);\n\tCHECK_OFFSET(guest_dr7, 528);\n\tCHECK_OFFSET(guest_rsp, 536);\n\tCHECK_OFFSET(guest_rip, 544);\n\tCHECK_OFFSET(guest_rflags, 552);\n\tCHECK_OFFSET(guest_pending_dbg_exceptions, 560);\n\tCHECK_OFFSET(guest_sysenter_esp, 568);\n\tCHECK_OFFSET(guest_sysenter_eip, 576);\n\tCHECK_OFFSET(host_cr0, 584);\n\tCHECK_OFFSET(host_cr3, 592);\n\tCHECK_OFFSET(host_cr4, 600);\n\tCHECK_OFFSET(host_fs_base, 608);\n\tCHECK_OFFSET(host_gs_base, 616);\n\tCHECK_OFFSET(host_tr_base, 624);\n\tCHECK_OFFSET(host_gdtr_base, 632);\n\tCHECK_OFFSET(host_idtr_base, 640);\n\tCHECK_OFFSET(host_ia32_sysenter_esp, 648);\n\tCHECK_OFFSET(host_ia32_sysenter_eip, 656);\n\tCHECK_OFFSET(host_rsp, 664);\n\tCHECK_OFFSET(host_rip, 672);\n\tCHECK_OFFSET(pin_based_vm_exec_control, 744);\n\tCHECK_OFFSET(cpu_based_vm_exec_control, 748);\n\tCHECK_OFFSET(exception_bitmap, 752);\n\tCHECK_OFFSET(page_fault_error_code_mask, 756);\n\tCHECK_OFFSET(page_fault_error_code_match, 760);\n\tCHECK_OFFSET(cr3_target_count, 764);\n\tCHECK_OFFSET(vm_exit_controls, 768);\n\tCHECK_OFFSET(vm_exit_msr_store_count, 772);\n\tCHECK_OFFSET(vm_exit_msr_load_count, 776);\n\tCHECK_OFFSET(vm_entry_controls, 780);\n\tCHECK_OFFSET(vm_entry_msr_load_count, 784);\n\tCHECK_OFFSET(vm_entry_intr_info_field, 788);\n\tCHECK_OFFSET(vm_entry_exception_error_code, 792);\n\tCHECK_OFFSET(vm_entry_instruction_len, 796);\n\tCHECK_OFFSET(tpr_threshold, 800);\n\tCHECK_OFFSET(secondary_vm_exec_control, 804);\n\tCHECK_OFFSET(vm_instruction_error, 808);\n\tCHECK_OFFSET(vm_exit_reason, 812);\n\tCHECK_OFFSET(vm_exit_intr_info, 816);\n\tCHECK_OFFSET(vm_exit_intr_error_code, 820);\n\tCHECK_OFFSET(idt_vectoring_info_field, 824);\n\tCHECK_OFFSET(idt_vectoring_error_code, 828);\n\tCHECK_OFFSET(vm_exit_instruction_len, 832);\n\tCHECK_OFFSET(vmx_instruction_info, 836);\n\tCHECK_OFFSET(guest_es_limit, 840);\n\tCHECK_OFFSET(guest_cs_limit, 844);\n\tCHECK_OFFSET(guest_ss_limit, 848);\n\tCHECK_OFFSET(guest_ds_limit, 852);\n\tCHECK_OFFSET(guest_fs_limit, 856);\n\tCHECK_OFFSET(guest_gs_limit, 860);\n\tCHECK_OFFSET(guest_ldtr_limit, 864);\n\tCHECK_OFFSET(guest_tr_limit, 868);\n\tCHECK_OFFSET(guest_gdtr_limit, 872);\n\tCHECK_OFFSET(guest_idtr_limit, 876);\n\tCHECK_OFFSET(guest_es_ar_bytes, 880);\n\tCHECK_OFFSET(guest_cs_ar_bytes, 884);\n\tCHECK_OFFSET(guest_ss_ar_bytes, 888);\n\tCHECK_OFFSET(guest_ds_ar_bytes, 892);\n\tCHECK_OFFSET(guest_fs_ar_bytes, 896);\n\tCHECK_OFFSET(guest_gs_ar_bytes, 900);\n\tCHECK_OFFSET(guest_ldtr_ar_bytes, 904);\n\tCHECK_OFFSET(guest_tr_ar_bytes, 908);\n\tCHECK_OFFSET(guest_interruptibility_info, 912);\n\tCHECK_OFFSET(guest_activity_state, 916);\n\tCHECK_OFFSET(guest_sysenter_cs, 920);\n\tCHECK_OFFSET(host_ia32_sysenter_cs, 924);\n\tCHECK_OFFSET(vmx_preemption_timer_value, 928);\n\tCHECK_OFFSET(virtual_processor_id, 960);\n\tCHECK_OFFSET(posted_intr_nv, 962);\n\tCHECK_OFFSET(guest_es_selector, 964);\n\tCHECK_OFFSET(guest_cs_selector, 966);\n\tCHECK_OFFSET(guest_ss_selector, 968);\n\tCHECK_OFFSET(guest_ds_selector, 970);\n\tCHECK_OFFSET(guest_fs_selector, 972);\n\tCHECK_OFFSET(guest_gs_selector, 974);\n\tCHECK_OFFSET(guest_ldtr_selector, 976);\n\tCHECK_OFFSET(guest_tr_selector, 978);\n\tCHECK_OFFSET(guest_intr_status, 980);\n\tCHECK_OFFSET(host_es_selector, 982);\n\tCHECK_OFFSET(host_cs_selector, 984);\n\tCHECK_OFFSET(host_ss_selector, 986);\n\tCHECK_OFFSET(host_ds_selector, 988);\n\tCHECK_OFFSET(host_fs_selector, 990);\n\tCHECK_OFFSET(host_gs_selector, 992);\n\tCHECK_OFFSET(host_tr_selector, 994);\n\tCHECK_OFFSET(guest_pml_index, 996);\n}\n\nextern const unsigned short vmcs12_field_offsets[];\nextern const unsigned int nr_vmcs12_fields;\n\nstatic inline short get_vmcs12_field_offset(unsigned long field)\n{\n\tunsigned short offset;\n\tunsigned int index;\n\n\tif (field >> 15)\n\t\treturn -ENOENT;\n\n\tindex = ROL16(field, 6);\n\tif (index >= nr_vmcs12_fields)\n\t\treturn -ENOENT;\n\n\tindex = array_index_nospec(index, nr_vmcs12_fields);\n\toffset = vmcs12_field_offsets[index];\n\tif (offset == 0)\n\t\treturn -ENOENT;\n\treturn offset;\n}\n\nstatic inline u64 vmcs12_read_any(struct vmcs12 *vmcs12, unsigned long field,\n\t\t\t\t  u16 offset)\n{\n\tchar *p = (char *)vmcs12 + offset;\n\n\tswitch (vmcs_field_width(field)) {\n\tcase VMCS_FIELD_WIDTH_NATURAL_WIDTH:\n\t\treturn *((natural_width *)p);\n\tcase VMCS_FIELD_WIDTH_U16:\n\t\treturn *((u16 *)p);\n\tcase VMCS_FIELD_WIDTH_U32:\n\t\treturn *((u32 *)p);\n\tcase VMCS_FIELD_WIDTH_U64:\n\t\treturn *((u64 *)p);\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\treturn -1;\n\t}\n}\n\nstatic inline void vmcs12_write_any(struct vmcs12 *vmcs12, unsigned long field,\n\t\t\t\t    u16 offset, u64 field_value)\n{\n\tchar *p = (char *)vmcs12 + offset;\n\n\tswitch (vmcs_field_width(field)) {\n\tcase VMCS_FIELD_WIDTH_U16:\n\t\t*(u16 *)p = field_value;\n\t\tbreak;\n\tcase VMCS_FIELD_WIDTH_U32:\n\t\t*(u32 *)p = field_value;\n\t\tbreak;\n\tcase VMCS_FIELD_WIDTH_U64:\n\t\t*(u64 *)p = field_value;\n\t\tbreak;\n\tcase VMCS_FIELD_WIDTH_NATURAL_WIDTH:\n\t\t*(natural_width *)p = field_value;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}