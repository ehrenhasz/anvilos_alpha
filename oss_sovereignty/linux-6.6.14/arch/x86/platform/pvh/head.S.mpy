{
  "module_name": "head.S",
  "hash_id": "1a6823a6bf270900f957b81df58269eab8bad0ae5d56e295436eea6b66743023",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/platform/pvh/head.S",
  "human_readable_source": " \n\n \n\n\t.code32\n\t.text\n#define _pa(x)          ((x) - __START_KERNEL_map)\n\n#include <linux/elfnote.h>\n#include <linux/init.h>\n#include <linux/linkage.h>\n#include <asm/segment.h>\n#include <asm/asm.h>\n#include <asm/boot.h>\n#include <asm/processor-flags.h>\n#include <asm/msr.h>\n#include <asm/nospec-branch.h>\n#include <xen/interface/elfnote.h>\n\n\t__HEAD\n\n \n\n#define PVH_GDT_ENTRY_CS\t1\n#define PVH_GDT_ENTRY_DS\t2\n#define PVH_CS_SEL\t\t(PVH_GDT_ENTRY_CS * 8)\n#define PVH_DS_SEL\t\t(PVH_GDT_ENTRY_DS * 8)\n\nSYM_CODE_START_LOCAL(pvh_start_xen)\n\tUNWIND_HINT_END_OF_STACK\n\tcld\n\n\tlgdt (_pa(gdt))\n\n\tmov $PVH_DS_SEL,%eax\n\tmov %eax,%ds\n\tmov %eax,%es\n\tmov %eax,%ss\n\n\t \n\tmov $_pa(pvh_start_info), %edi\n\tmov %ebx, %esi\n\tmov _pa(pvh_start_info_sz), %ecx\n\tshr $2,%ecx\n\trep\n\tmovsl\n\n\tmov $_pa(early_stack_end), %esp\n\n\t \n\tmov %cr4, %eax\n\torl $X86_CR4_PAE, %eax\n\tmov %eax, %cr4\n\n#ifdef CONFIG_X86_64\n\t \n\tmov $MSR_EFER, %ecx\n\trdmsr\n\tbtsl $_EFER_LME, %eax\n\twrmsr\n\n\t \n\tmov $_pa(init_top_pgt), %eax\n\tmov %eax, %cr3\n\tmov $(X86_CR0_PG | X86_CR0_PE), %eax\n\tmov %eax, %cr0\n\n\t \n\tljmp $PVH_CS_SEL, $_pa(1f)\n\n\t \n\t.code64\n1:\n\t \n\tmov $MSR_GS_BASE,%ecx\n\tmov $_pa(canary), %eax\n\txor %edx, %edx\n\twrmsr\n\n\tcall xen_prepare_pvh\n\n\t \n\tmov $_pa(pvh_bootparams), %rsi\n\tmov $_pa(startup_64), %rax\n\tANNOTATE_RETPOLINE_SAFE\n\tjmp *%rax\n\n#else  \n\n\tcall mk_early_pgtbl_32\n\n\tmov $_pa(initial_page_table), %eax\n\tmov %eax, %cr3\n\n\tmov %cr0, %eax\n\tor $(X86_CR0_PG | X86_CR0_PE), %eax\n\tmov %eax, %cr0\n\n\tljmp $PVH_CS_SEL, $1f\n1:\n\tcall xen_prepare_pvh\n\tmov $_pa(pvh_bootparams), %esi\n\n\t \n\tljmp $PVH_CS_SEL, $_pa(2f)\n2:\n\tmov %cr0, %eax\n\tand $~X86_CR0_PG, %eax\n\tmov %eax, %cr0\n\tmov %cr4, %eax\n\tand $~X86_CR4_PAE, %eax\n\tmov %eax, %cr4\n\n\tljmp $PVH_CS_SEL, $_pa(startup_32)\n#endif\nSYM_CODE_END(pvh_start_xen)\n\n\t.section \".init.data\",\"aw\"\n\t.balign 8\nSYM_DATA_START_LOCAL(gdt)\n\t.word gdt_end - gdt_start\n\t.long _pa(gdt_start)\n\t.word 0\nSYM_DATA_END(gdt)\nSYM_DATA_START_LOCAL(gdt_start)\n\t.quad 0x0000000000000000             \n#ifdef CONFIG_X86_64\n\t.quad GDT_ENTRY(0xa09a, 0, 0xfffff)  \n#else\n\t.quad GDT_ENTRY(0xc09a, 0, 0xfffff)  \n#endif\n\t.quad GDT_ENTRY(0xc092, 0, 0xfffff)  \nSYM_DATA_END_LABEL(gdt_start, SYM_L_LOCAL, gdt_end)\n\n\t.balign 16\nSYM_DATA_LOCAL(canary, .fill 48, 1, 0)\n\nSYM_DATA_START_LOCAL(early_stack)\n\t.fill BOOT_STACK_SIZE, 1, 0\nSYM_DATA_END_LABEL(early_stack, SYM_L_LOCAL, early_stack_end)\n\n\tELFNOTE(Xen, XEN_ELFNOTE_PHYS32_ENTRY,\n\t             _ASM_PTR (pvh_start_xen - __START_KERNEL_map))\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}