{
  "module_name": "xo1-wakeup.S",
  "hash_id": "7548511519eaff22e329fedf0d0f5920e931a66ccc8139accc9ee876eece3c5e",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/platform/olpc/xo1-wakeup.S",
  "human_readable_source": " \n.text\n#include <linux/linkage.h>\n#include <asm/segment.h>\n#include <asm/page.h>\n#include <asm/pgtable_32.h>\n\n\t.macro writepost,value\n\t\tmovb $0x34, %al\n\t\toutb %al, $0x70\n\t\tmovb $\\value, %al\n\t\toutb %al, $0x71\n\t.endm\n\nwakeup_start:\n\t# OFW lands us here, running in protected mode, with a\n\t# kernel-compatible GDT already setup.\n\n\t# Clear any dangerous flags\n\tpushl $0\n\tpopfl\n\n\twritepost 0x31\n\n\t# Set up %cr3\n\tmovl $initial_page_table - __PAGE_OFFSET, %eax\n\tmovl %eax, %cr3\n\n\tmovl saved_cr4, %eax\n\tmovl %eax, %cr4\n\n\tmovl saved_cr0, %eax\n\tmovl %eax, %cr0\n\n\t# Control registers were modified, pipeline resync is needed\n\tjmp 1f\n1:\n\n\tmovw    $__KERNEL_DS, %ax\n\tmovw    %ax, %ss\n\tmovw    %ax, %ds\n\tmovw    %ax, %es\n\tmovw    %ax, %fs\n\tmovw    %ax, %gs\n\n\tlgdt    saved_gdt\n\tlidt    saved_idt\n\tlldt    saved_ldt\n\tljmp    $(__KERNEL_CS),$1f\n1:\n\tmovl    %cr3, %eax\n\tmovl    %eax, %cr3\n\twbinvd\n\n\t# Go back to the return point\n\tjmp ret_point\n\nsave_registers:\n\tsgdt  saved_gdt\n\tsidt  saved_idt\n\tsldt  saved_ldt\n\n\tpushl %edx\n\tmovl %cr4, %edx\n\tmovl %edx, saved_cr4\n\n\tmovl %cr0, %edx\n\tmovl %edx, saved_cr0\n\n\tpopl %edx\n\n\tmovl %ebx, saved_context_ebx\n\tmovl %ebp, saved_context_ebp\n\tmovl %esi, saved_context_esi\n\tmovl %edi, saved_context_edi\n\n\tpushfl\n\tpopl saved_context_eflags\n\n\tRET\n\nrestore_registers:\n\tmovl saved_context_ebp, %ebp\n\tmovl saved_context_ebx, %ebx\n\tmovl saved_context_esi, %esi\n\tmovl saved_context_edi, %edi\n\n\tpushl saved_context_eflags\n\tpopfl\n\n\tRET\n\nSYM_CODE_START(do_olpc_suspend_lowlevel)\n\tcall\tsave_processor_state\n\tcall\tsave_registers\n\n\t# This is the stack context we want to remember\n\tmovl %esp, saved_context_esp\n\n\tpushl\t$3\n\tcall\txo1_do_sleep\n\n\tjmp\twakeup_start\n\t.p2align 4,,7\nret_point:\n\tmovl    saved_context_esp, %esp\n\n\twritepost 0x32\n\n\tcall\trestore_registers\n\tcall\trestore_processor_state\n\tRET\nSYM_CODE_END(do_olpc_suspend_lowlevel)\n\n.data\nsaved_gdt:             .long   0,0\nsaved_idt:             .long   0,0\nsaved_ldt:             .long   0\nsaved_cr4:             .long   0\nsaved_cr0:             .long   0\nsaved_context_esp:     .long   0\nsaved_context_edi:     .long   0\nsaved_context_esi:     .long   0\nsaved_context_ebx:     .long   0\nsaved_context_ebp:     .long   0\nsaved_context_eflags:  .long   0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}