{
  "module_name": "reg_u_sub.S",
  "hash_id": "37e37e801a7e5fe8dc79c93e595085dfe09641620e6a676e0cef5923a1cdf4b1",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/math-emu/reg_u_sub.S",
  "human_readable_source": " \n\t.file\t\"reg_u_sub.S\"\n \n\n \n\n#include \"exception.h\"\n#include \"fpu_emu.h\"\n#include \"control_w.h\"\n\n.text\nSYM_FUNC_START(FPU_u_sub)\n\tpushl\t%ebp\n\tmovl\t%esp,%ebp\n\tpushl\t%esi\n\tpushl\t%edi\n\tpushl\t%ebx\n\n\tmovl\tPARAM1,%esi\t \n\tmovl\tPARAM2,%edi\t \n\t\n\tmovl\tPARAM6,%ecx\n\tsubl\tPARAM7,%ecx\t \n\n#ifdef PARANOID\n\t \n\tjs\tL_bugged_1\n\n\ttestl\t$0x80000000,SIGH(%edi)\t \n\tje\tL_bugged_2\n\n\ttestl\t$0x80000000,SIGH(%esi)\n\tje\tL_bugged_2\n#endif  \n\n \n\tmovl\tSIGH(%edi),%eax\t \n\tmovl\tSIGL(%edi),%ebx\t \n\n\tmovl\tPARAM3,%edi\t \n\tmovl\tPARAM6,%edx\n\tmovw\t%dx,EXP(%edi)\t \n\n\txorl\t%edx,%edx\t \n\n \n\n\tcmpw\t$32,%cx\t\t \n\tjnc\tL_more_than_31\n\n \n\tshrd\t%cl,%ebx,%edx\n\tshrd\t%cl,%eax,%ebx\n\tshr\t%cl,%eax\n\tjmp\tL_shift_done\n\nL_more_than_31:\n\tcmpw\t$64,%cx\n\tjnc\tL_more_than_63\n\n\tsubb\t$32,%cl\n\tjz\tL_exactly_32\n\n\tshrd\t%cl,%eax,%edx\n\tshr\t%cl,%eax\n\torl\t%ebx,%ebx\n\tjz\tL_more_31_no_low\t \n\n\torl\t$1,%edx\t\t\t \n\nL_more_31_no_low:\n\tmovl\t%eax,%ebx\n\txorl\t%eax,%eax\n\tjmp\tL_shift_done\n\nL_exactly_32:\n\tmovl\t%ebx,%edx\n\tmovl\t%eax,%ebx\n\txorl\t%eax,%eax\n\tjmp\tL_shift_done\n\nL_more_than_63:\n\tcmpw\t$65,%cx\n\tjnc\tL_more_than_64\n\n\t \n\tmovl\t%eax,%edx\n\torl\t%ebx,%ebx\n\tjz\tL_more_63_no_low\n\n\torl\t$1,%edx\n\tjmp\tL_more_63_no_low\n\nL_more_than_64:\n\tjne\tL_more_than_65\n\n\t \n\t \n\tmovl\t%eax,%edx\n\trcrl\t%edx\n\tjnc\tL_shift_65_nc\n\n\torl\t$1,%edx\n\tjmp\tL_more_63_no_low\n\nL_shift_65_nc:\n\torl\t%ebx,%ebx\n\tjz\tL_more_63_no_low\n\n\torl\t$1,%edx\n\tjmp\tL_more_63_no_low\n\nL_more_than_65:\n\tmovl\t$1,%edx\t\t \n\nL_more_63_no_low:\n\txorl\t%ebx,%ebx\n\txorl\t%eax,%eax\n\nL_shift_done:\nL_subtr:\n \n\txorl\t%ecx,%ecx\n\tsubl\t%edx,%ecx\n\tmovl\t%ecx,%edx\n\tmovl\tSIGL(%esi),%ecx\n\tsbbl\t%ebx,%ecx\n\tmovl\t%ecx,%ebx\n\tmovl\tSIGH(%esi),%ecx\n\tsbbl\t%eax,%ecx\n\tmovl\t%ecx,%eax\n\n#ifdef PARANOID\n\t \n\tjc\tL_bugged\n#endif  \n\n \n\ttestl\t$0x80000000,%eax\n\tjnz\tL_round\t\t \n\n\torl\t%eax,%eax\n\tjnz\tL_shift_1\t \n\n\torl\t%ebx,%ebx\n\tjnz\tL_shift_32\t \n\n \n\n\tcmpl\t$0x80000000,%edx\n\tjnz\tL_must_be_zero\n\n\t \n\tsubw\t$64,EXP(%edi)\n\txchg\t%edx,%eax\n\tjmp\tfpu_reg_round\n\nL_must_be_zero:\n#ifdef PARANOID\n\torl\t%edx,%edx\n\tjnz\tL_bugged_3\n#endif   \n\n\t \n\tmovw\t$0,EXP(%edi)\t\t \n\tmovl\t$0,SIGL(%edi)\n\tmovl\t$0,SIGH(%edi)\n\tmovl\tTAG_Zero,%eax\n\tjmp\tL_exit\n\nL_shift_32:\n\tmovl\t%ebx,%eax\n\tmovl\t%edx,%ebx\n\tmovl\t$0,%edx\n\tsubw\t$32,EXP(%edi)\t \n\n \nL_shift_1:\n\tbsrl\t%eax,%ecx\t \n\tsubl\t$31,%ecx\n\tnegl\t%ecx\n\tshld\t%cl,%ebx,%eax\n\tshld\t%cl,%edx,%ebx\n\tshl\t%cl,%edx\n\tsubw\t%cx,EXP(%edi)\t \n\nL_round:\n\tjmp\tfpu_reg_round\t \n\n\n#ifdef PARANOID\nL_bugged_1:\n\tpushl\tEX_INTERNAL|0x206\n\tcall\tEXCEPTION\n\tpop\t%ebx\n\tjmp\tL_error_exit\n\nL_bugged_2:\n\tpushl\tEX_INTERNAL|0x209\n\tcall\tEXCEPTION\n\tpop\t%ebx\n\tjmp\tL_error_exit\n\nL_bugged_3:\n\tpushl\tEX_INTERNAL|0x210\n\tcall\tEXCEPTION\n\tpop\t%ebx\n\tjmp\tL_error_exit\n\nL_bugged_4:\n\tpushl\tEX_INTERNAL|0x211\n\tcall\tEXCEPTION\n\tpop\t%ebx\n\tjmp\tL_error_exit\n\nL_bugged:\n\tpushl\tEX_INTERNAL|0x212\n\tcall\tEXCEPTION\n\tpop\t%ebx\n\tjmp\tL_error_exit\n\nL_error_exit:\n\tmovl\t$-1,%eax\n\n#endif  \n\nL_exit:\n\tpopl\t%ebx\n\tpopl\t%edi\n\tpopl\t%esi\n\tleave\n\tRET\nSYM_FUNC_END(FPU_u_sub)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}