{
  "module_name": "reg_round.S",
  "hash_id": "b4ffec1a9bf2263edc69a96ebda7020d2e5d8583d822e999460bbde28dbd85a2",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/math-emu/reg_round.S",
  "human_readable_source": " \n\t.file \"reg_round.S\"\n \n\n \n\n \n\n\n#include \"fpu_emu.h\"\n#include \"exception.h\"\n#include \"control_w.h\"\n\n \n#define\tLOST_DOWN\t$1\n#define\tLOST_UP\t\t$2\n\n \n#define\tDENORMAL\t$1\n#define\tUNMASKED_UNDERFLOW $2\n\n\n#ifndef NON_REENTRANT_FPU\n \n#define FPU_bits_lost\t(%esp)\n#define FPU_denormal\t1(%esp)\n\n#else\n \n.data\n\t.align 4,0\nFPU_bits_lost:\n\t.byte\t0\nFPU_denormal:\n\t.byte\t0\n#endif  \n\n\n.text\n.globl fpu_reg_round\n.globl fpu_Arith_exit\n\n \nSYM_FUNC_START(FPU_round)\n\tpushl\t%ebp\n\tmovl\t%esp,%ebp\n\tpushl\t%esi\n\tpushl\t%edi\n\tpushl\t%ebx\n\n\tmovl\tPARAM1,%edi\n\tmovl\tSIGH(%edi),%eax\n\tmovl\tSIGL(%edi),%ebx\n\tmovl\tPARAM2,%edx\n\nfpu_reg_round:\t\t\t \n\tmovl\tPARAM4,%ecx\n\n#ifndef NON_REENTRANT_FPU\n\tpushl\t%ebx\t\t \n#endif   \n\n#ifdef PARANOID\n \n \n \n#endif  \n\n\tcmpw\tEXP_UNDER,EXP(%edi)\n\tjle\tL_Make_denorm\t\t\t \n\n\tmovb\t$0,FPU_denormal\t\t\t \n\nDenorm_done:\n\tmovb\t$0,FPU_bits_lost\t\t \n\n\tmovl\t%ecx,%esi\n\tandl\tCW_PC,%ecx\n\tcmpl\tPR_64_BITS,%ecx\n\tje\tLRound_To_64\n\n\tcmpl\tPR_53_BITS,%ecx\n\tje\tLRound_To_53\n\n\tcmpl\tPR_24_BITS,%ecx\n\tje\tLRound_To_24\n\n#ifdef PECULIAR_486\n \n\tcmpl\tPR_RESERVED_BITS,%ecx\n\tje\tLRound_To_64\n#ifdef PARANOID\n\tjmp\tL_bugged_denorm_486\n#endif   \n#else\n#ifdef PARANOID\n\tjmp\tL_bugged_denorm\t \n#endif   \n#endif  \n\n\n \nLRound_To_24:\n\tmovl\t%esi,%ecx\n\tandl\tCW_RC,%ecx\n\tcmpl\tRC_RND,%ecx\n\tje\tLRound_nearest_24\n\n\tcmpl\tRC_CHOP,%ecx\n\tje\tLCheck_truncate_24\n\n\tcmpl\tRC_UP,%ecx\t\t \n\tje\tLUp_24\n\n\tcmpl\tRC_DOWN,%ecx\t\t \n\tje\tLDown_24\n\n#ifdef PARANOID\n\tjmp\tL_bugged_round24\n#endif   \n\nLUp_24:\n\tcmpb\tSIGN_POS,PARAM5\n\tjne\tLCheck_truncate_24\t \n\n\tjmp\tLCheck_24_round_up\n\nLDown_24:\n\tcmpb\tSIGN_POS,PARAM5\n\tje\tLCheck_truncate_24\t \n\nLCheck_24_round_up:\n\tmovl\t%eax,%ecx\n\tandl\t$0x000000ff,%ecx\n\torl\t%ebx,%ecx\n\torl\t%edx,%ecx\n\tjnz\tLDo_24_round_up\n\tjmp\tL_Re_normalise\n\nLRound_nearest_24:\n\t \n\tmovl\t%eax,%ecx\n\tandl\t$0x000000ff,%ecx\n\tcmpl\t$0x00000080,%ecx\n\tjc\tLCheck_truncate_24\t \n\n\tjne\tLGreater_Half_24\t \n\n\t \n\torl\t%ebx,%ebx\n\tjnz\tLGreater_Half_24\t \n\n\torl\t%edx,%edx\n\tjnz\tLGreater_Half_24\t \n\n\t \n\ttestl\t$0x00000100,%eax\n\tjz\tLDo_truncate_24\n\nLGreater_Half_24:\t\t\t \nLDo_24_round_up:\n\tandl\t$0xffffff00,%eax\t \n\txorl\t%ebx,%ebx\n\tmovb\tLOST_UP,FPU_bits_lost\n\taddl\t$0x00000100,%eax\n\tjmp\tLCheck_Round_Overflow\n\nLCheck_truncate_24:\n\tmovl\t%eax,%ecx\n\tandl\t$0x000000ff,%ecx\n\torl\t%ebx,%ecx\n\torl\t%edx,%ecx\n\tjz\tL_Re_normalise\t\t \n\nLDo_truncate_24:\n\tandl\t$0xffffff00,%eax\t \n\txorl\t%ebx,%ebx\n\tmovb\tLOST_DOWN,FPU_bits_lost\n\tjmp\tL_Re_normalise\n\n\n \nLRound_To_53:\n\tmovl\t%esi,%ecx\n\tandl\tCW_RC,%ecx\n\tcmpl\tRC_RND,%ecx\n\tje\tLRound_nearest_53\n\n\tcmpl\tRC_CHOP,%ecx\n\tje\tLCheck_truncate_53\n\n\tcmpl\tRC_UP,%ecx\t\t \n\tje\tLUp_53\n\n\tcmpl\tRC_DOWN,%ecx\t\t \n\tje\tLDown_53\n\n#ifdef PARANOID\n\tjmp\tL_bugged_round53\n#endif   \n\nLUp_53:\n\tcmpb\tSIGN_POS,PARAM5\n\tjne\tLCheck_truncate_53\t \n\n\tjmp\tLCheck_53_round_up\n\nLDown_53:\n\tcmpb\tSIGN_POS,PARAM5\n\tje\tLCheck_truncate_53\t \n\nLCheck_53_round_up:\n\tmovl\t%ebx,%ecx\n\tandl\t$0x000007ff,%ecx\n\torl\t%edx,%ecx\n\tjnz\tLDo_53_round_up\n\tjmp\tL_Re_normalise\n\nLRound_nearest_53:\n\t \n\tmovl\t%ebx,%ecx\n\tandl\t$0x000007ff,%ecx\n\tcmpl\t$0x00000400,%ecx\n\tjc\tLCheck_truncate_53\t \n\n\tjnz\tLGreater_Half_53\t \n\n\t \n\torl\t%edx,%edx\n\tjnz\tLGreater_Half_53\t \n\n\t \n\ttestl\t$0x00000800,%ebx\n\tjz\tLTruncate_53\n\nLGreater_Half_53:\t\t\t \nLDo_53_round_up:\n\tmovb\tLOST_UP,FPU_bits_lost\n\tandl\t$0xfffff800,%ebx\t \n\taddl\t$0x00000800,%ebx\n\tadcl\t$0,%eax\n\tjmp\tLCheck_Round_Overflow\n\nLCheck_truncate_53:\n\tmovl\t%ebx,%ecx\n\tandl\t$0x000007ff,%ecx\n\torl\t%edx,%ecx\n\tjz\tL_Re_normalise\n\nLTruncate_53:\n\tmovb\tLOST_DOWN,FPU_bits_lost\n\tandl\t$0xfffff800,%ebx\t \n\tjmp\tL_Re_normalise\n\n\n \nLRound_To_64:\n\tmovl\t%esi,%ecx\n\tandl\tCW_RC,%ecx\n\tcmpl\tRC_RND,%ecx\n\tje\tLRound_nearest_64\n\n\tcmpl\tRC_CHOP,%ecx\n\tje\tLCheck_truncate_64\n\n\tcmpl\tRC_UP,%ecx\t\t \n\tje\tLUp_64\n\n\tcmpl\tRC_DOWN,%ecx\t\t \n\tje\tLDown_64\n\n#ifdef PARANOID\n\tjmp\tL_bugged_round64\n#endif   \n\nLUp_64:\n\tcmpb\tSIGN_POS,PARAM5\n\tjne\tLCheck_truncate_64\t \n\n\torl\t%edx,%edx\n\tjnz\tLDo_64_round_up\n\tjmp\tL_Re_normalise\n\nLDown_64:\n\tcmpb\tSIGN_POS,PARAM5\n\tje\tLCheck_truncate_64\t \n\n\torl\t%edx,%edx\n\tjnz\tLDo_64_round_up\n\tjmp\tL_Re_normalise\n\nLRound_nearest_64:\n\tcmpl\t$0x80000000,%edx\n\tjc\tLCheck_truncate_64\n\n\tjne\tLDo_64_round_up\n\n\t \n\ttestb\t$1,%bl\n\tjz\tLCheck_truncate_64\n\nLDo_64_round_up:\n\tmovb\tLOST_UP,FPU_bits_lost\n\taddl\t$1,%ebx\n\tadcl\t$0,%eax\n\nLCheck_Round_Overflow:\n\tjnc\tL_Re_normalise\n\n\t \n\trcrl\t$1,%eax\n\trcrl\t$1,%ebx\n\tincw\tEXP(%edi)\n\tjmp\tL_Re_normalise\n\nLCheck_truncate_64:\n\torl\t%edx,%edx\n\tjz\tL_Re_normalise\n\nLTruncate_64:\n\tmovb\tLOST_DOWN,FPU_bits_lost\n\nL_Re_normalise:\n\ttestb\t$0xff,FPU_denormal\n\tjnz\tNormalise_result\n\nL_Normalised:\n\tmovl\tTAG_Valid,%edx\n\nL_deNormalised:\n\tcmpb\tLOST_UP,FPU_bits_lost\n\tje\tL_precision_lost_up\n\n\tcmpb\tLOST_DOWN,FPU_bits_lost\n\tje\tL_precision_lost_down\n\nL_no_precision_loss:\n\t \n\nL_Store_significand:\n\tmovl\t%eax,SIGH(%edi)\n\tmovl\t%ebx,SIGL(%edi)\n\n\tcmpw\tEXP_OVER,EXP(%edi)\n\tjge\tL_overflow\n\n\tmovl\t%edx,%eax\n\n\t \n\taddw\tEXTENDED_Ebias,EXP(%edi)\n\tandw\t$0x7fff,EXP(%edi)\n\nfpu_reg_round_signed_special_exit:\n\n\tcmpb\tSIGN_POS,PARAM5\n\tje\tfpu_reg_round_special_exit\n\n\torw\t$0x8000,EXP(%edi)\t \n\nfpu_reg_round_special_exit:\n\n#ifndef NON_REENTRANT_FPU\n\tpopl\t%ebx\t\t \n#endif   \n\nfpu_Arith_exit:\n\tpopl\t%ebx\n\tpopl\t%edi\n\tpopl\t%esi\n\tleave\n\tRET\n\n\n \nL_precision_lost_up:\n\tpush\t%edx\n\tpush\t%eax\n\tcall\tset_precision_flag_up\n\tpopl\t%eax\n\tpopl\t%edx\n\tjmp\tL_no_precision_loss\n\n \nL_precision_lost_down:\n\tpush\t%edx\n\tpush\t%eax\n\tcall\tset_precision_flag_down\n\tpopl\t%eax\n\tpopl\t%edx\n\tjmp\tL_no_precision_loss\n\n\n \nL_Make_denorm:\n\t \n\ttestb\tCW_Underflow,%cl\t\t \n\tjz\tUnmasked_underflow\t\t \n\n\tmovb\tDENORMAL,FPU_denormal\n\n\tpushl\t%ecx\t\t \n\tmovw\tEXP_UNDER+1,%cx\n\tsubw\tEXP(%edi),%cx\n\n\tcmpw\t$64,%cx\t \n\tjnc\tDenorm_shift_more_than_63\n\n\tcmpw\t$32,%cx\t \n\tjnc\tDenorm_shift_more_than_32\n\n \n\taddw\t%cx,EXP(%edi)\n\torl\t%edx,%edx\t \n\tsetne\t%ch\t\t \n\txorl\t%edx,%edx\n\tshrd\t%cl,%ebx,%edx\n\tshrd\t%cl,%eax,%ebx\n\tshr\t%cl,%eax\n\torb\t%ch,%dl\n\tpopl\t%ecx\n\tjmp\tDenorm_done\n\n \nDenorm_shift_more_than_32:\n\taddw\t%cx,EXP(%edi)\n\tsubb\t$32,%cl\n\torl\t%edx,%edx\n\tsetne\t%ch\n\torb\t%ch,%bl\n\txorl\t%edx,%edx\n\tshrd\t%cl,%ebx,%edx\n\tshrd\t%cl,%eax,%ebx\n\tshr\t%cl,%eax\n\torl\t%edx,%edx\t\t \n\tsetne\t%cl\n\torb\t%ch,%bl\n\torb\t%cl,%bl\n\tmovl\t%ebx,%edx\n\tmovl\t%eax,%ebx\n\txorl\t%eax,%eax\n\tpopl\t%ecx\n\tjmp\tDenorm_done\n\n \nDenorm_shift_more_than_63:\n\tcmpw\t$64,%cx\n\tjne\tDenorm_shift_more_than_64\n\n \n\taddw\t%cx,EXP(%edi)\n\txorl\t%ecx,%ecx\n\torl\t%edx,%edx\n\tsetne\t%cl\n\torl\t%ebx,%ebx\n\tsetne\t%ch\n\torb\t%ch,%cl\n\torb\t%cl,%al\n\tmovl\t%eax,%edx\n\txorl\t%eax,%eax\n\txorl\t%ebx,%ebx\n\tpopl\t%ecx\n\tjmp\tDenorm_done\n\nDenorm_shift_more_than_64:\n\tmovw\tEXP_UNDER+1,EXP(%edi)\n \n\tmovl\t$1,%edx\n\txorl\t%eax,%eax\n\txorl\t%ebx,%ebx\n\tpopl\t%ecx\n\tjmp\tDenorm_done\n\n\nUnmasked_underflow:\n\tmovb\tUNMASKED_UNDERFLOW,FPU_denormal\n\tjmp\tDenorm_done\n\n\n \nNormalise_result:\n\tcmpb\tUNMASKED_UNDERFLOW,FPU_denormal\n\tje\tSignal_underflow\n\n \n#ifdef PARANOID\n\t \n\tcmpw\tEXP_UNDER+1,EXP(%edi)\n\tjne\tL_norm_bugged\n#endif  \n\n#ifdef PECULIAR_486\n\t \n\torl\t%eax,%eax\t\t \n\tjs\tLPseudoDenormal\t\t \n#else\n\torl\t%eax,%eax\t\t \n\tjs\tL_Normalised\t\t \n#endif   \n\n\tjnz\tLDenormal_adj_exponent\n\n\torl\t%ebx,%ebx\n\tjz\tL_underflow_to_zero\t \n\nLDenormal_adj_exponent:\n\tdecw\tEXP(%edi)\n\nLPseudoDenormal:\n\ttestb\t$0xff,FPU_bits_lost\t \n\tmovl\tTAG_Special,%edx\n\tjz\tL_deNormalised\n\n\t \n\tpush\t%eax\n\tpushl\tEX_Underflow\n\tcall\tEXCEPTION\n\tpopl\t%eax\n\tpopl\t%eax\n\tmovl\tTAG_Special,%edx\n\tjmp\tL_deNormalised\n\n\n \nL_underflow_to_zero:\n\tpush\t%eax\n\tcall\tset_precision_flag_down\n\tpopl\t%eax\n\n\tpush\t%eax\n\tpushl\tEX_Underflow\n\tcall\tEXCEPTION\n\tpopl\t%eax\n\tpopl\t%eax\n\n \n\tmovw\tEXP_UNDER,EXP(%edi)\n\tmovl\tTAG_Zero,%edx\n\tjmp\tL_Store_significand\n\n\n \nL_overflow:\n\taddw\tEXTENDED_Ebias,EXP(%edi)\t \n\tpush\t%edi\n\tcall\tarith_overflow\n\tpop\t%edi\n\tjmp\tfpu_reg_round_signed_special_exit\n\n\nSignal_underflow:\n\t \n\t \n\tcmpw\tEXP_UNDER,EXP(%edi)\n\tjle\tDo_unmasked_underflow\n\n\tjmp\tL_Normalised\n\nDo_unmasked_underflow:\n\t \n\taddw\t$(3*(1<<13)),EXP(%edi)\n\tpush\t%eax\n\tpushl\tEX_Underflow\n\tcall\tEXCEPTION\n\tpopl\t%eax\n\tpopl\t%eax\n\tjmp\tL_Normalised\n\n\n#ifdef PARANOID\n#ifdef PECULIAR_486\nL_bugged_denorm_486:\n\tpushl\tEX_INTERNAL|0x236\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n#else\nL_bugged_denorm:\n\tpushl\tEX_INTERNAL|0x230\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n#endif   \n\nL_bugged_round24:\n\tpushl\tEX_INTERNAL|0x231\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n\nL_bugged_round53:\n\tpushl\tEX_INTERNAL|0x232\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n\nL_bugged_round64:\n\tpushl\tEX_INTERNAL|0x233\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n\nL_norm_bugged:\n\tpushl\tEX_INTERNAL|0x234\n\tcall\tEXCEPTION\n\tpopl\t%ebx\n\tjmp\tL_exception_exit\n\nL_entry_bugged:\n\tpushl\tEX_INTERNAL|0x235\n\tcall\tEXCEPTION\n\tpopl\t%ebx\nL_exception_exit:\n\tmov\t$-1,%eax\n\tjmp\tfpu_reg_round_special_exit\n#endif   \n\nSYM_FUNC_END(FPU_round)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}