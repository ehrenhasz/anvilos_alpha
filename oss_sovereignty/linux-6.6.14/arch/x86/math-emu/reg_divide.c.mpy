{
  "module_name": "reg_divide.c",
  "hash_id": "ec17856a21356066ac78f86e6d11fbaf70a5ed9b8b05f67c41778d8afaa332e5",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/math-emu/reg_divide.c",
  "human_readable_source": "\n \n\n \n\n#include \"exception.h\"\n#include \"reg_constant.h\"\n#include \"fpu_emu.h\"\n#include \"fpu_system.h\"\n\n \nint FPU_div(int flags, int rm, int control_w)\n{\n\tFPU_REG x, y;\n\tFPU_REG const *a, *b, *st0_ptr, *st_ptr;\n\tFPU_REG *dest;\n\tu_char taga, tagb, signa, signb, sign, saved_sign;\n\tint tag, deststnr;\n\n\tif (flags & DEST_RM)\n\t\tdeststnr = rm;\n\telse\n\t\tdeststnr = 0;\n\n\tif (flags & REV) {\n\t\tb = &st(0);\n\t\tst0_ptr = b;\n\t\ttagb = FPU_gettag0();\n\t\tif (flags & LOADED) {\n\t\t\ta = (FPU_REG *) rm;\n\t\t\ttaga = flags & 0x0f;\n\t\t} else {\n\t\t\ta = &st(rm);\n\t\t\tst_ptr = a;\n\t\t\ttaga = FPU_gettagi(rm);\n\t\t}\n\t} else {\n\t\ta = &st(0);\n\t\tst0_ptr = a;\n\t\ttaga = FPU_gettag0();\n\t\tif (flags & LOADED) {\n\t\t\tb = (FPU_REG *) rm;\n\t\t\ttagb = flags & 0x0f;\n\t\t} else {\n\t\t\tb = &st(rm);\n\t\t\tst_ptr = b;\n\t\t\ttagb = FPU_gettagi(rm);\n\t\t}\n\t}\n\n\tsigna = getsign(a);\n\tsignb = getsign(b);\n\n\tsign = signa ^ signb;\n\n\tdest = &st(deststnr);\n\tsaved_sign = getsign(dest);\n\n\tif (!(taga | tagb)) {\n\t\t \n\t\treg_copy(a, &x);\n\t\treg_copy(b, &y);\n\t\tsetpositive(&x);\n\t\tsetpositive(&y);\n\t\ttag = FPU_u_div(&x, &y, dest, control_w, sign);\n\n\t\tif (tag < 0)\n\t\t\treturn tag;\n\n\t\tFPU_settagi(deststnr, tag);\n\t\treturn tag;\n\t}\n\n\tif (taga == TAG_Special)\n\t\ttaga = FPU_Special(a);\n\tif (tagb == TAG_Special)\n\t\ttagb = FPU_Special(b);\n\n\tif (((taga == TAG_Valid) && (tagb == TW_Denormal))\n\t    || ((taga == TW_Denormal) && (tagb == TAG_Valid))\n\t    || ((taga == TW_Denormal) && (tagb == TW_Denormal))) {\n\t\tif (denormal_operand() < 0)\n\t\t\treturn FPU_Exception;\n\n\t\tFPU_to_exp16(a, &x);\n\t\tFPU_to_exp16(b, &y);\n\t\ttag = FPU_u_div(&x, &y, dest, control_w, sign);\n\t\tif (tag < 0)\n\t\t\treturn tag;\n\n\t\tFPU_settagi(deststnr, tag);\n\t\treturn tag;\n\t} else if ((taga <= TW_Denormal) && (tagb <= TW_Denormal)) {\n\t\tif (tagb != TAG_Zero) {\n\t\t\t \n\t\t\tif (tagb == TW_Denormal) {\n\t\t\t\tif (denormal_operand() < 0)\n\t\t\t\t\treturn FPU_Exception;\n\t\t\t}\n\n\t\t\t \n\t\t\tFPU_copy_to_regi(&CONST_Z, TAG_Zero, deststnr);\n\t\t\tsetsign(dest, sign);\n\t\t\treturn TAG_Zero;\n\t\t}\n\t\t \n\t\tif (taga == TAG_Zero) {\n\t\t\t \n\t\t\treturn arith_invalid(deststnr);\n\t\t}\n\t\t \n\t\treturn FPU_divide_by_zero(deststnr, sign);\n\t}\n\t \n\telse if ((taga == TW_NaN) || (tagb == TW_NaN)) {\n\t\tif (flags & LOADED)\n\t\t\treturn real_2op_NaN((FPU_REG *) rm, flags & 0x0f, 0,\n\t\t\t\t\t    st0_ptr);\n\n\t\tif (flags & DEST_RM) {\n\t\t\tint tag;\n\t\t\ttag = FPU_gettag0();\n\t\t\tif (tag == TAG_Special)\n\t\t\t\ttag = FPU_Special(st0_ptr);\n\t\t\treturn real_2op_NaN(st0_ptr, tag, rm,\n\t\t\t\t\t    (flags & REV) ? st0_ptr : &st(rm));\n\t\t} else {\n\t\t\tint tag;\n\t\t\ttag = FPU_gettagi(rm);\n\t\t\tif (tag == TAG_Special)\n\t\t\t\ttag = FPU_Special(&st(rm));\n\t\t\treturn real_2op_NaN(&st(rm), tag, 0,\n\t\t\t\t\t    (flags & REV) ? st0_ptr : &st(rm));\n\t\t}\n\t} else if (taga == TW_Infinity) {\n\t\tif (tagb == TW_Infinity) {\n\t\t\t \n\t\t\treturn arith_invalid(deststnr);\n\t\t} else {\n\t\t\t \n\t\t\tif ((tagb == TW_Denormal) && (denormal_operand() < 0))\n\t\t\t\treturn FPU_Exception;\n\n\t\t\t \n\t\t\tFPU_copy_to_regi(a, TAG_Special, deststnr);\n\t\t\tsetsign(dest, sign);\n\t\t\treturn taga;\n\t\t}\n\t} else if (tagb == TW_Infinity) {\n\t\tif ((taga == TW_Denormal) && (denormal_operand() < 0))\n\t\t\treturn FPU_Exception;\n\n\t\t \n\t\tFPU_copy_to_regi(&CONST_Z, TAG_Zero, deststnr);\n\t\tsetsign(dest, sign);\n\t\treturn TAG_Zero;\n\t}\n#ifdef PARANOID\n\telse {\n\t\tEXCEPTION(EX_INTERNAL | 0x102);\n\t\treturn FPU_Exception;\n\t}\n#endif  \n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}