{
  "module_name": "desc_defs.h",
  "hash_id": "2bcbe035b5928e48cf4263ecde5f98edfbb29326839c5483264741f2538194a5",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/desc_defs.h",
  "human_readable_source": " \n \n#ifndef _ASM_X86_DESC_DEFS_H\n#define _ASM_X86_DESC_DEFS_H\n\n \n\n#ifndef __ASSEMBLY__\n\n#include <linux/types.h>\n\n \nstruct desc_struct {\n\tu16\tlimit0;\n\tu16\tbase0;\n\tu16\tbase1: 8, type: 4, s: 1, dpl: 2, p: 1;\n\tu16\tlimit1: 4, avl: 1, l: 1, d: 1, g: 1, base2: 8;\n} __attribute__((packed));\n\n#define GDT_ENTRY_INIT(flags, base, limit)\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.limit0\t\t= (u16) (limit),\t\t\\\n\t\t.limit1\t\t= ((limit) >> 16) & 0x0F,\t\\\n\t\t.base0\t\t= (u16) (base),\t\t\t\\\n\t\t.base1\t\t= ((base) >> 16) & 0xFF,\t\\\n\t\t.base2\t\t= ((base) >> 24) & 0xFF,\t\\\n\t\t.type\t\t= (flags & 0x0f),\t\t\\\n\t\t.s\t\t= (flags >> 4) & 0x01,\t\t\\\n\t\t.dpl\t\t= (flags >> 5) & 0x03,\t\t\\\n\t\t.p\t\t= (flags >> 7) & 0x01,\t\t\\\n\t\t.avl\t\t= (flags >> 12) & 0x01,\t\t\\\n\t\t.l\t\t= (flags >> 13) & 0x01,\t\t\\\n\t\t.d\t\t= (flags >> 14) & 0x01,\t\t\\\n\t\t.g\t\t= (flags >> 15) & 0x01,\t\t\\\n\t}\n\nenum {\n\tGATE_INTERRUPT = 0xE,\n\tGATE_TRAP = 0xF,\n\tGATE_CALL = 0xC,\n\tGATE_TASK = 0x5,\n};\n\nenum {\n\tDESC_TSS = 0x9,\n\tDESC_LDT = 0x2,\n\tDESCTYPE_S = 0x10,\t \n};\n\n \nstruct ldttss_desc {\n\tu16\tlimit0;\n\tu16\tbase0;\n\n\tu16\tbase1 : 8, type : 5, dpl : 2, p : 1;\n\tu16\tlimit1 : 4, zero0 : 3, g : 1, base2 : 8;\n#ifdef CONFIG_X86_64\n\tu32\tbase3;\n\tu32\tzero1;\n#endif\n} __attribute__((packed));\n\ntypedef struct ldttss_desc ldt_desc;\ntypedef struct ldttss_desc tss_desc;\n\nstruct idt_bits {\n\tu16\t\tist\t: 3,\n\t\t\tzero\t: 5,\n\t\t\ttype\t: 5,\n\t\t\tdpl\t: 2,\n\t\t\tp\t: 1;\n} __attribute__((packed));\n\nstruct idt_data {\n\tunsigned int\tvector;\n\tunsigned int\tsegment;\n\tstruct idt_bits\tbits;\n\tconst void\t*addr;\n};\n\nstruct gate_struct {\n\tu16\t\toffset_low;\n\tu16\t\tsegment;\n\tstruct idt_bits\tbits;\n\tu16\t\toffset_middle;\n#ifdef CONFIG_X86_64\n\tu32\t\toffset_high;\n\tu32\t\treserved;\n#endif\n} __attribute__((packed));\n\ntypedef struct gate_struct gate_desc;\n\nstatic inline unsigned long gate_offset(const gate_desc *g)\n{\n#ifdef CONFIG_X86_64\n\treturn g->offset_low | ((unsigned long)g->offset_middle << 16) |\n\t\t((unsigned long) g->offset_high << 32);\n#else\n\treturn g->offset_low | ((unsigned long)g->offset_middle << 16);\n#endif\n}\n\nstatic inline unsigned long gate_segment(const gate_desc *g)\n{\n\treturn g->segment;\n}\n\nstruct desc_ptr {\n\tunsigned short size;\n\tunsigned long address;\n} __attribute__((packed)) ;\n\n#endif  \n\n \n#define\tBOOT_IDT_ENTRIES\t32\n\n \n#define AR_TYPE_RODATA\t\t(0 * (1 << 9))\n#define AR_TYPE_RWDATA\t\t(1 * (1 << 9))\n#define AR_TYPE_RODATA_EXPDOWN\t(2 * (1 << 9))\n#define AR_TYPE_RWDATA_EXPDOWN\t(3 * (1 << 9))\n#define AR_TYPE_XOCODE\t\t(4 * (1 << 9))\n#define AR_TYPE_XRCODE\t\t(5 * (1 << 9))\n#define AR_TYPE_XOCODE_CONF\t(6 * (1 << 9))\n#define AR_TYPE_XRCODE_CONF\t(7 * (1 << 9))\n#define AR_TYPE_MASK\t\t(7 * (1 << 9))\n\n#define AR_DPL0\t\t\t(0 * (1 << 13))\n#define AR_DPL3\t\t\t(3 * (1 << 13))\n#define AR_DPL_MASK\t\t(3 * (1 << 13))\n\n#define AR_A\t\t\t(1 << 8)    \n#define AR_S\t\t\t(1 << 12)   \n#define AR_P\t\t\t(1 << 15)   \n#define AR_AVL\t\t\t(1 << 20)   \n#define AR_L\t\t\t(1 << 21)   \n#define AR_DB\t\t\t(1 << 22)   \n#define AR_G\t\t\t(1 << 23)   \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}