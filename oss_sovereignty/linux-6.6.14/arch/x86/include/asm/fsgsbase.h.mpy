{
  "module_name": "fsgsbase.h",
  "hash_id": "312646fd8380e190b615e1f1604b824359a6d0a2fd293621521226dc55452187",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/fsgsbase.h",
  "human_readable_source": " \n#ifndef _ASM_FSGSBASE_H\n#define _ASM_FSGSBASE_H\n\n#ifndef __ASSEMBLY__\n\n#ifdef CONFIG_X86_64\n\n#include <asm/msr-index.h>\n\n \nextern unsigned long x86_fsbase_read_task(struct task_struct *task);\nextern unsigned long x86_gsbase_read_task(struct task_struct *task);\nextern void x86_fsbase_write_task(struct task_struct *task, unsigned long fsbase);\nextern void x86_gsbase_write_task(struct task_struct *task, unsigned long gsbase);\n\n \n\nstatic __always_inline unsigned long rdfsbase(void)\n{\n\tunsigned long fsbase;\n\n\tasm volatile(\"rdfsbase %0\" : \"=r\" (fsbase) :: \"memory\");\n\n\treturn fsbase;\n}\n\nstatic __always_inline unsigned long rdgsbase(void)\n{\n\tunsigned long gsbase;\n\n\tasm volatile(\"rdgsbase %0\" : \"=r\" (gsbase) :: \"memory\");\n\n\treturn gsbase;\n}\n\nstatic __always_inline void wrfsbase(unsigned long fsbase)\n{\n\tasm volatile(\"wrfsbase %0\" :: \"r\" (fsbase) : \"memory\");\n}\n\nstatic __always_inline void wrgsbase(unsigned long gsbase)\n{\n\tasm volatile(\"wrgsbase %0\" :: \"r\" (gsbase) : \"memory\");\n}\n\n#include <asm/cpufeature.h>\n\n \n\nstatic inline unsigned long x86_fsbase_read_cpu(void)\n{\n\tunsigned long fsbase;\n\n\tif (boot_cpu_has(X86_FEATURE_FSGSBASE))\n\t\tfsbase = rdfsbase();\n\telse\n\t\trdmsrl(MSR_FS_BASE, fsbase);\n\n\treturn fsbase;\n}\n\nstatic inline void x86_fsbase_write_cpu(unsigned long fsbase)\n{\n\tif (boot_cpu_has(X86_FEATURE_FSGSBASE))\n\t\twrfsbase(fsbase);\n\telse\n\t\twrmsrl(MSR_FS_BASE, fsbase);\n}\n\nextern unsigned long x86_gsbase_read_cpu_inactive(void);\nextern void x86_gsbase_write_cpu_inactive(unsigned long gsbase);\nextern unsigned long x86_fsgsbase_read_task(struct task_struct *task,\n\t\t\t\t\t    unsigned short selector);\n\n#endif  \n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}