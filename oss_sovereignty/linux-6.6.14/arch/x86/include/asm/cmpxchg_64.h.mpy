{
  "module_name": "cmpxchg_64.h",
  "hash_id": "94436e25941ba7bd0ec1f2c28a97d4cce6a0045d8740c61ac7b535ec326d870f",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/cmpxchg_64.h",
  "human_readable_source": " \n#ifndef _ASM_X86_CMPXCHG_64_H\n#define _ASM_X86_CMPXCHG_64_H\n\n#define arch_cmpxchg64(ptr, o, n)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tBUILD_BUG_ON(sizeof(*(ptr)) != 8);\t\t\t\t\\\n\tarch_cmpxchg((ptr), (o), (n));\t\t\t\t\t\\\n})\n\n#define arch_cmpxchg64_local(ptr, o, n)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tBUILD_BUG_ON(sizeof(*(ptr)) != 8);\t\t\t\t\\\n\tarch_cmpxchg_local((ptr), (o), (n));\t\t\t\t\\\n})\n\n#define arch_try_cmpxchg64(ptr, po, n)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tBUILD_BUG_ON(sizeof(*(ptr)) != 8);\t\t\t\t\\\n\tarch_try_cmpxchg((ptr), (po), (n));\t\t\t\t\\\n})\n\nunion __u128_halves {\n\tu128 full;\n\tstruct {\n\t\tu64 low, high;\n\t};\n};\n\n#define __arch_cmpxchg128(_ptr, _old, _new, _lock)\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tunion __u128_halves o = { .full = (_old), },\t\t\t\\\n\t\t\t    n = { .full = (_new), };\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tasm volatile(_lock \"cmpxchg16b %[ptr]\"\t\t\t\t\\\n\t\t     : [ptr] \"+m\" (*(_ptr)),\t\t\t\t\\\n\t\t       \"+a\" (o.low), \"+d\" (o.high)\t\t\t\\\n\t\t     : \"b\" (n.low), \"c\" (n.high)\t\t\t\\\n\t\t     : \"memory\");\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\to.full;\t\t\t\t\t\t\t\t\\\n})\n\nstatic __always_inline u128 arch_cmpxchg128(volatile u128 *ptr, u128 old, u128 new)\n{\n\treturn __arch_cmpxchg128(ptr, old, new, LOCK_PREFIX);\n}\n#define arch_cmpxchg128 arch_cmpxchg128\n\nstatic __always_inline u128 arch_cmpxchg128_local(volatile u128 *ptr, u128 old, u128 new)\n{\n\treturn __arch_cmpxchg128(ptr, old, new,);\n}\n#define arch_cmpxchg128_local arch_cmpxchg128_local\n\n#define __arch_try_cmpxchg128(_ptr, _oldp, _new, _lock)\t\t\t\\\n({\t\t\t\t\t\t\t\t\t\\\n\tunion __u128_halves o = { .full = *(_oldp), },\t\t\t\\\n\t\t\t    n = { .full = (_new), };\t\t\t\\\n\tbool ret;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tasm volatile(_lock \"cmpxchg16b %[ptr]\"\t\t\t\t\\\n\t\t     CC_SET(e)\t\t\t\t\t\t\\\n\t\t     : CC_OUT(e) (ret),\t\t\t\t\t\\\n\t\t       [ptr] \"+m\" (*ptr),\t\t\t\t\\\n\t\t       \"+a\" (o.low), \"+d\" (o.high)\t\t\t\\\n\t\t     : \"b\" (n.low), \"c\" (n.high)\t\t\t\\\n\t\t     : \"memory\");\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tif (unlikely(!ret))\t\t\t\t\t\t\\\n\t\t*(_oldp) = o.full;\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tlikely(ret);\t\t\t\t\t\t\t\\\n})\n\nstatic __always_inline bool arch_try_cmpxchg128(volatile u128 *ptr, u128 *oldp, u128 new)\n{\n\treturn __arch_try_cmpxchg128(ptr, oldp, new, LOCK_PREFIX);\n}\n#define arch_try_cmpxchg128 arch_try_cmpxchg128\n\nstatic __always_inline bool arch_try_cmpxchg128_local(volatile u128 *ptr, u128 *oldp, u128 new)\n{\n\treturn __arch_try_cmpxchg128(ptr, oldp, new,);\n}\n#define arch_try_cmpxchg128_local arch_try_cmpxchg128_local\n\n#define system_has_cmpxchg128()\t\tboot_cpu_has(X86_FEATURE_CX16)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}