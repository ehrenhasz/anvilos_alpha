{
  "module_name": "sev-common.h",
  "hash_id": "20464aaffb4f83e937b0a56a00da6724f8e5fe5757285de653c612813505c10a",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/sev-common.h",
  "human_readable_source": " \n \n\n#ifndef __ASM_X86_SEV_COMMON_H\n#define __ASM_X86_SEV_COMMON_H\n\n#define GHCB_MSR_INFO_POS\t\t0\n#define GHCB_DATA_LOW\t\t\t12\n#define GHCB_MSR_INFO_MASK\t\t(BIT_ULL(GHCB_DATA_LOW) - 1)\n\n#define GHCB_DATA(v)\t\t\t\\\n\t(((unsigned long)(v) & ~GHCB_MSR_INFO_MASK) >> GHCB_DATA_LOW)\n\n \n#define GHCB_MSR_SEV_INFO_RESP\t\t0x001\n#define GHCB_MSR_SEV_INFO_REQ\t\t0x002\n\n#define GHCB_MSR_SEV_INFO(_max, _min, _cbit)\t\\\n\t \t\t\t\\\n\t((((_max) & 0xffff) << 48) |\t\t\\\n\t  \t\t\t\\\n\t (((_min) & 0xffff) << 32) |\t\t\\\n\t  \t\t\t\\\n\t (((_cbit) & 0xff)  << 24) |\t\t\\\n\t GHCB_MSR_SEV_INFO_RESP)\n\n#define GHCB_MSR_INFO(v)\t\t((v) & 0xfffUL)\n#define GHCB_MSR_PROTO_MAX(v)\t\t(((v) >> 48) & 0xffff)\n#define GHCB_MSR_PROTO_MIN(v)\t\t(((v) >> 32) & 0xffff)\n\n \n#define GHCB_MSR_CPUID_REQ\t\t0x004\n#define GHCB_MSR_CPUID_RESP\t\t0x005\n#define GHCB_MSR_CPUID_FUNC_POS\t\t32\n#define GHCB_MSR_CPUID_FUNC_MASK\t0xffffffff\n#define GHCB_MSR_CPUID_VALUE_POS\t32\n#define GHCB_MSR_CPUID_VALUE_MASK\t0xffffffff\n#define GHCB_MSR_CPUID_REG_POS\t\t30\n#define GHCB_MSR_CPUID_REG_MASK\t\t0x3\n#define GHCB_CPUID_REQ_EAX\t\t0\n#define GHCB_CPUID_REQ_EBX\t\t1\n#define GHCB_CPUID_REQ_ECX\t\t2\n#define GHCB_CPUID_REQ_EDX\t\t3\n#define GHCB_CPUID_REQ(fn, reg)\t\t\t\t\\\n\t \t\t\t\t\\\n\t(GHCB_MSR_CPUID_REQ |\t\t\t\t\\\n\t \t\t\t\t\\\n\t(((unsigned long)(reg) & 0x3) << 30) |\t\t\\\n\t \t\t\t\t\\\n\t(((unsigned long)fn) << 32))\n\n \n#define GHCB_MSR_AP_RESET_HOLD_REQ\t0x006\n#define GHCB_MSR_AP_RESET_HOLD_RESP\t0x007\n\n \n#define GHCB_MSR_REG_GPA_REQ\t\t0x012\n#define GHCB_MSR_REG_GPA_REQ_VAL(v)\t\t\t\\\n\t \t\t\t\t\\\n\t(((u64)((v) & GENMASK_ULL(51, 0)) << 12) |\t\\\n\t \t\t\t\t\\\n\tGHCB_MSR_REG_GPA_REQ)\n\n#define GHCB_MSR_REG_GPA_RESP\t\t0x013\n#define GHCB_MSR_REG_GPA_RESP_VAL(v)\t\t\t\\\n\t \t\t\t\t\\\n\t(((u64)(v) & GENMASK_ULL(63, 12)) >> 12)\n\n \nenum psc_op {\n\tSNP_PAGE_STATE_PRIVATE = 1,\n\tSNP_PAGE_STATE_SHARED,\n};\n\n#define GHCB_MSR_PSC_REQ\t\t0x014\n#define GHCB_MSR_PSC_REQ_GFN(gfn, op)\t\t\t\\\n\t \t\t\t\t\\\n\t(((u64)((op) & 0xf) << 52) |\t\t\t\\\n\t \t\t\t\t\\\n\t((u64)((gfn) & GENMASK_ULL(39, 0)) << 12) |\t\\\n\t \t\t\t\t\\\n\tGHCB_MSR_PSC_REQ)\n\n#define GHCB_MSR_PSC_RESP\t\t0x015\n#define GHCB_MSR_PSC_RESP_VAL(val)\t\t\t\\\n\t \t\t\t\t\\\n\t(((u64)(val) & GENMASK_ULL(63, 32)) >> 32)\n\n \n#define GHCB_MSR_HV_FT_REQ\t\t0x080\n#define GHCB_MSR_HV_FT_RESP\t\t0x081\n#define GHCB_MSR_HV_FT_RESP_VAL(v)\t\t\t\\\n\t \t\t\t\t\\\n\t(((u64)(v) & GENMASK_ULL(63, 12)) >> 12)\n\n#define GHCB_HV_FT_SNP\t\t\tBIT_ULL(0)\n#define GHCB_HV_FT_SNP_AP_CREATION\tBIT_ULL(1)\n\n \n#define VMGEXIT_PSC_MAX_ENTRY\t\t64\n\nstruct psc_hdr {\n\tu16 cur_entry;\n\tu16 end_entry;\n\tu32 reserved;\n} __packed;\n\nstruct psc_entry {\n\tu64\tcur_page\t: 12,\n\t\tgfn\t\t: 40,\n\t\toperation\t: 4,\n\t\tpagesize\t: 1,\n\t\treserved\t: 7;\n} __packed;\n\nstruct snp_psc_desc {\n\tstruct psc_hdr hdr;\n\tstruct psc_entry entries[VMGEXIT_PSC_MAX_ENTRY];\n} __packed;\n\n#define GHCB_MSR_TERM_REQ\t\t0x100\n#define GHCB_MSR_TERM_REASON_SET_POS\t12\n#define GHCB_MSR_TERM_REASON_SET_MASK\t0xf\n#define GHCB_MSR_TERM_REASON_POS\t16\n#define GHCB_MSR_TERM_REASON_MASK\t0xff\n\n#define GHCB_SEV_TERM_REASON(reason_set, reason_val)\t\\\n\t \t\t\t\t\\\n\t(((((u64)reason_set) &  0xf) << 12) |\t\t\\\n\t  \t\t\t\t\\\n\t((((u64)reason_val) & 0xff) << 16))\n\n \n#define SEV_TERM_SET_GEN\t\t0\n#define GHCB_SEV_ES_GEN_REQ\t\t0\n#define GHCB_SEV_ES_PROT_UNSUPPORTED\t1\n#define GHCB_SNP_UNSUPPORTED\t\t2\n\n \n#define SEV_TERM_SET_LINUX\t\t1\n#define GHCB_TERM_REGISTER\t\t0\t \n#define GHCB_TERM_PSC\t\t\t1\t \n#define GHCB_TERM_PVALIDATE\t\t2\t \n#define GHCB_TERM_NOT_VMPL0\t\t3\t \n#define GHCB_TERM_CPUID\t\t\t4\t \n#define GHCB_TERM_CPUID_HV\t\t5\t \n\n#define GHCB_RESP_CODE(v)\t\t((v) & GHCB_MSR_INFO_MASK)\n\n \n#define GHCB_ERR_NOT_REGISTERED\t\t1\n#define GHCB_ERR_INVALID_USAGE\t\t2\n#define GHCB_ERR_INVALID_SCRATCH_AREA\t3\n#define GHCB_ERR_MISSING_INPUT\t\t4\n#define GHCB_ERR_INVALID_INPUT\t\t5\n#define GHCB_ERR_INVALID_EVENT\t\t6\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}