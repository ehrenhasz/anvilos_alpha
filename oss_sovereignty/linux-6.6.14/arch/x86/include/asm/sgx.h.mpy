{
  "module_name": "sgx.h",
  "hash_id": "e918f5bb143f4b5efe71eeacde3a11eeef69d2f3012fb1da5ab8e035cbbe5aa1",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/sgx.h",
  "human_readable_source": " \n \n#ifndef _ASM_X86_SGX_H\n#define _ASM_X86_SGX_H\n\n#include <linux/bits.h>\n#include <linux/types.h>\n\n \n\n \n#define SGX_CPUID\t\t0x12\n \n#define SGX_CPUID_EPC\t\t2\n \n#define SGX_CPUID_EPC_INVALID\t0x0\n \n#define SGX_CPUID_EPC_SECTION\t0x1\n \n#define SGX_CPUID_EPC_MASK\tGENMASK(3, 0)\n\nenum sgx_encls_function {\n\tECREATE\t= 0x00,\n\tEADD\t= 0x01,\n\tEINIT\t= 0x02,\n\tEREMOVE\t= 0x03,\n\tEDGBRD\t= 0x04,\n\tEDGBWR\t= 0x05,\n\tEEXTEND\t= 0x06,\n\tELDU\t= 0x08,\n\tEBLOCK\t= 0x09,\n\tEPA\t= 0x0A,\n\tEWB\t= 0x0B,\n\tETRACK\t= 0x0C,\n\tEAUG\t= 0x0D,\n\tEMODPR\t= 0x0E,\n\tEMODT\t= 0x0F,\n};\n\n \n#define SGX_ENCLS_FAULT_FLAG 0x40000000\n\n \nenum sgx_return_code {\n\tSGX_EPC_PAGE_CONFLICT\t\t= 7,\n\tSGX_NOT_TRACKED\t\t\t= 11,\n\tSGX_CHILD_PRESENT\t\t= 13,\n\tSGX_INVALID_EINITTOKEN\t\t= 16,\n\tSGX_PAGE_NOT_MODIFIABLE\t\t= 20,\n\tSGX_UNMASKED_EVENT\t\t= 128,\n};\n\n \n#define SGX_MODULUS_SIZE 384\n\n \nenum sgx_miscselect {\n\tSGX_MISC_EXINFO\t\t= BIT(0),\n};\n\n#define SGX_MISC_RESERVED_MASK\tGENMASK_ULL(63, 1)\n\n#define SGX_SSA_GPRS_SIZE\t\t184\n#define SGX_SSA_MISC_EXINFO_SIZE\t16\n\n \nenum sgx_attribute {\n\tSGX_ATTR_INIT\t\t   = BIT(0),\n\tSGX_ATTR_DEBUG\t\t   = BIT(1),\n\tSGX_ATTR_MODE64BIT\t   = BIT(2),\n\t\t\t\t   \n\tSGX_ATTR_PROVISIONKEY\t   = BIT(4),\n\tSGX_ATTR_EINITTOKENKEY\t   = BIT(5),\n\t\t\t\t   \n\tSGX_ATTR_KSS\t\t   = BIT(7),\n\t\t\t\t   \n\t\t\t\t   \n\tSGX_ATTR_ASYNC_EXIT_NOTIFY = BIT(10),\n};\n\n#define SGX_ATTR_RESERVED_MASK\t(BIT_ULL(3) | \\\n\t\t\t\t BIT_ULL(6) | \\\n\t\t\t\t BIT_ULL(8) | \\\n\t\t\t\t BIT_ULL(9) | \\\n\t\t\t\t GENMASK_ULL(63, 11))\n\n#define SGX_ATTR_UNPRIV_MASK\t(SGX_ATTR_DEBUG\t    | \\\n\t\t\t\t SGX_ATTR_MODE64BIT | \\\n\t\t\t\t SGX_ATTR_KSS\t    | \\\n\t\t\t\t SGX_ATTR_ASYNC_EXIT_NOTIFY)\n\n#define SGX_ATTR_PRIV_MASK\t(SGX_ATTR_PROVISIONKEY\t| \\\n\t\t\t\t SGX_ATTR_EINITTOKENKEY)\n\n \nstruct sgx_secs {\n\tu64 size;\n\tu64 base;\n\tu32 ssa_frame_size;\n\tu32 miscselect;\n\tu8  reserved1[24];\n\tu64 attributes;\n\tu64 xfrm;\n\tu32 mrenclave[8];\n\tu8  reserved2[32];\n\tu32 mrsigner[8];\n\tu8  reserved3[32];\n\tu32 config_id[16];\n\tu16 isv_prod_id;\n\tu16 isv_svn;\n\tu16 config_svn;\n\tu8  reserved4[3834];\n} __packed;\n\n \nenum sgx_tcs_flags {\n\tSGX_TCS_DBGOPTIN\t= 0x01,\n};\n\n#define SGX_TCS_RESERVED_MASK\tGENMASK_ULL(63, 1)\n#define SGX_TCS_RESERVED_SIZE\t4024\n\n \nstruct sgx_tcs {\n\tu64 state;\n\tu64 flags;\n\tu64 ssa_offset;\n\tu32 ssa_index;\n\tu32 nr_ssa_frames;\n\tu64 entry_offset;\n\tu64 exit_addr;\n\tu64 fs_offset;\n\tu64 gs_offset;\n\tu32 fs_limit;\n\tu32 gs_limit;\n\tu8  reserved[SGX_TCS_RESERVED_SIZE];\n} __packed;\n\n \nstruct sgx_pageinfo {\n\tu64 addr;\n\tu64 contents;\n\tu64 metadata;\n\tu64 secs;\n} __packed __aligned(32);\n\n\n \nenum sgx_page_type {\n\tSGX_PAGE_TYPE_SECS,\n\tSGX_PAGE_TYPE_TCS,\n\tSGX_PAGE_TYPE_REG,\n\tSGX_PAGE_TYPE_VA,\n\tSGX_PAGE_TYPE_TRIM,\n};\n\n#define SGX_NR_PAGE_TYPES\t5\n#define SGX_PAGE_TYPE_MASK\tGENMASK(7, 0)\n\n \nenum sgx_secinfo_flags {\n\tSGX_SECINFO_R\t\t\t= BIT(0),\n\tSGX_SECINFO_W\t\t\t= BIT(1),\n\tSGX_SECINFO_X\t\t\t= BIT(2),\n\tSGX_SECINFO_SECS\t\t= (SGX_PAGE_TYPE_SECS << 8),\n\tSGX_SECINFO_TCS\t\t\t= (SGX_PAGE_TYPE_TCS << 8),\n\tSGX_SECINFO_REG\t\t\t= (SGX_PAGE_TYPE_REG << 8),\n\tSGX_SECINFO_VA\t\t\t= (SGX_PAGE_TYPE_VA << 8),\n\tSGX_SECINFO_TRIM\t\t= (SGX_PAGE_TYPE_TRIM << 8),\n};\n\n#define SGX_SECINFO_PERMISSION_MASK\tGENMASK_ULL(2, 0)\n#define SGX_SECINFO_PAGE_TYPE_MASK\t(SGX_PAGE_TYPE_MASK << 8)\n#define SGX_SECINFO_RESERVED_MASK\t~(SGX_SECINFO_PERMISSION_MASK | \\\n\t\t\t\t\t  SGX_SECINFO_PAGE_TYPE_MASK)\n\n \nstruct sgx_secinfo {\n\tu64 flags;\n\tu8  reserved[56];\n} __packed __aligned(64);\n\n#define SGX_PCMD_RESERVED_SIZE 40\n\n \nstruct sgx_pcmd {\n\tstruct sgx_secinfo secinfo;\n\tu64 enclave_id;\n\tu8  reserved[SGX_PCMD_RESERVED_SIZE];\n\tu8  mac[16];\n} __packed __aligned(128);\n\n#define SGX_SIGSTRUCT_RESERVED1_SIZE 84\n#define SGX_SIGSTRUCT_RESERVED2_SIZE 20\n#define SGX_SIGSTRUCT_RESERVED3_SIZE 32\n#define SGX_SIGSTRUCT_RESERVED4_SIZE 12\n\n \nstruct sgx_sigstruct_header {\n\tu64 header1[2];\n\tu32 vendor;\n\tu32 date;\n\tu64 header2[2];\n\tu32 swdefined;\n\tu8  reserved1[84];\n} __packed;\n\n \nstruct sgx_sigstruct_body {\n\tu32 miscselect;\n\tu32 misc_mask;\n\tu8  reserved2[20];\n\tu64 attributes;\n\tu64 xfrm;\n\tu64 attributes_mask;\n\tu64 xfrm_mask;\n\tu8  mrenclave[32];\n\tu8  reserved3[32];\n\tu16 isvprodid;\n\tu16 isvsvn;\n} __packed;\n\n \nstruct sgx_sigstruct {\n\tstruct sgx_sigstruct_header header;\n\tu8  modulus[SGX_MODULUS_SIZE];\n\tu32 exponent;\n\tu8  signature[SGX_MODULUS_SIZE];\n\tstruct sgx_sigstruct_body body;\n\tu8  reserved4[12];\n\tu8  q1[SGX_MODULUS_SIZE];\n\tu8  q2[SGX_MODULUS_SIZE];\n} __packed;\n\n#define SGX_LAUNCH_TOKEN_SIZE 304\n\n \n\n#ifdef CONFIG_X86_SGX_KVM\nint sgx_virt_ecreate(struct sgx_pageinfo *pageinfo, void __user *secs,\n\t\t     int *trapnr);\nint sgx_virt_einit(void __user *sigstruct, void __user *token,\n\t\t   void __user *secs, u64 *lepubkeyhash, int *trapnr);\n#endif\n\nint sgx_set_attribute(unsigned long *allowed_attributes,\n\t\t      unsigned int attribute_fd);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}