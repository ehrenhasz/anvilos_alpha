{
  "module_name": "bootparam_utils.h",
  "hash_id": "511d407e14330d32d1037188e972cd63b5a3e7e546e00a655451895a89991627",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/bootparam_utils.h",
  "human_readable_source": " \n#ifndef _ASM_X86_BOOTPARAM_UTILS_H\n#define _ASM_X86_BOOTPARAM_UTILS_H\n\n#include <asm/bootparam.h>\n\n \n\n \n\n#define sizeof_mbr(type, member) ({ sizeof(((type *)0)->member); })\n\n#define BOOT_PARAM_PRESERVE(struct_member)\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\t.start = offsetof(struct boot_params, struct_member),\t\\\n\t\t.len   = sizeof_mbr(struct boot_params, struct_member),\t\\\n\t}\n\nstruct boot_params_to_save {\n\tunsigned int start;\n\tunsigned int len;\n};\n\nstatic void sanitize_boot_params(struct boot_params *boot_params)\n{\n\t \n\tif (boot_params->sentinel) {\n\t\tstatic struct boot_params scratch;\n\t\tchar *bp_base = (char *)boot_params;\n\t\tchar *save_base = (char *)&scratch;\n\t\tint i;\n\n\t\tconst struct boot_params_to_save to_save[] = {\n\t\t\tBOOT_PARAM_PRESERVE(screen_info),\n\t\t\tBOOT_PARAM_PRESERVE(apm_bios_info),\n\t\t\tBOOT_PARAM_PRESERVE(tboot_addr),\n\t\t\tBOOT_PARAM_PRESERVE(ist_info),\n\t\t\tBOOT_PARAM_PRESERVE(hd0_info),\n\t\t\tBOOT_PARAM_PRESERVE(hd1_info),\n\t\t\tBOOT_PARAM_PRESERVE(sys_desc_table),\n\t\t\tBOOT_PARAM_PRESERVE(olpc_ofw_header),\n\t\t\tBOOT_PARAM_PRESERVE(efi_info),\n\t\t\tBOOT_PARAM_PRESERVE(alt_mem_k),\n\t\t\tBOOT_PARAM_PRESERVE(scratch),\n\t\t\tBOOT_PARAM_PRESERVE(e820_entries),\n\t\t\tBOOT_PARAM_PRESERVE(eddbuf_entries),\n\t\t\tBOOT_PARAM_PRESERVE(edd_mbr_sig_buf_entries),\n\t\t\tBOOT_PARAM_PRESERVE(edd_mbr_sig_buffer),\n\t\t\tBOOT_PARAM_PRESERVE(secure_boot),\n\t\t\tBOOT_PARAM_PRESERVE(hdr),\n\t\t\tBOOT_PARAM_PRESERVE(e820_table),\n\t\t\tBOOT_PARAM_PRESERVE(eddbuf),\n\t\t\tBOOT_PARAM_PRESERVE(cc_blob_address),\n\t\t};\n\n\t\tmemset(&scratch, 0, sizeof(scratch));\n\n\t\tfor (i = 0; i < ARRAY_SIZE(to_save); i++) {\n\t\t\tmemcpy(save_base + to_save[i].start,\n\t\t\t       bp_base + to_save[i].start, to_save[i].len);\n\t\t}\n\n\t\tmemcpy(boot_params, save_base, sizeof(*boot_params));\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}