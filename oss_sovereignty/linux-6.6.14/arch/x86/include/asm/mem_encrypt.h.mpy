{
  "module_name": "mem_encrypt.h",
  "hash_id": "0ce63e85aef23b348dc6e5f07e42c3b6d902d36d28c2fd5f22ac5643c969df60",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/mem_encrypt.h",
  "human_readable_source": " \n \n\n#ifndef __X86_MEM_ENCRYPT_H__\n#define __X86_MEM_ENCRYPT_H__\n\n#ifndef __ASSEMBLY__\n\n#include <linux/init.h>\n#include <linux/cc_platform.h>\n\n#include <asm/bootparam.h>\n\n#ifdef CONFIG_X86_MEM_ENCRYPT\nvoid __init mem_encrypt_init(void);\n#else\nstatic inline void mem_encrypt_init(void) { }\n#endif\n\n#ifdef CONFIG_AMD_MEM_ENCRYPT\n\nextern u64 sme_me_mask;\nextern u64 sev_status;\n\nvoid sme_encrypt_execute(unsigned long encrypted_kernel_vaddr,\n\t\t\t unsigned long decrypted_kernel_vaddr,\n\t\t\t unsigned long kernel_len,\n\t\t\t unsigned long encryption_wa,\n\t\t\t unsigned long encryption_pgd);\n\nvoid __init sme_early_encrypt(resource_size_t paddr,\n\t\t\t      unsigned long size);\nvoid __init sme_early_decrypt(resource_size_t paddr,\n\t\t\t      unsigned long size);\n\nvoid __init sme_map_bootdata(char *real_mode_data);\nvoid __init sme_unmap_bootdata(char *real_mode_data);\n\nvoid __init sme_early_init(void);\nvoid __init sev_setup_arch(void);\n\nvoid __init sme_encrypt_kernel(struct boot_params *bp);\nvoid __init sme_enable(struct boot_params *bp);\n\nint __init early_set_memory_decrypted(unsigned long vaddr, unsigned long size);\nint __init early_set_memory_encrypted(unsigned long vaddr, unsigned long size);\nvoid __init early_set_mem_enc_dec_hypercall(unsigned long vaddr,\n\t\t\t\t\t    unsigned long size, bool enc);\n\nvoid __init mem_encrypt_free_decrypted_mem(void);\n\nvoid __init sev_es_init_vc_handling(void);\n\n#define __bss_decrypted __section(\".bss..decrypted\")\n\n#else\t \n\n#define sme_me_mask\t0ULL\n#define sev_status\t0ULL\n\nstatic inline void __init sme_early_encrypt(resource_size_t paddr,\n\t\t\t\t\t    unsigned long size) { }\nstatic inline void __init sme_early_decrypt(resource_size_t paddr,\n\t\t\t\t\t    unsigned long size) { }\n\nstatic inline void __init sme_map_bootdata(char *real_mode_data) { }\nstatic inline void __init sme_unmap_bootdata(char *real_mode_data) { }\n\nstatic inline void __init sme_early_init(void) { }\nstatic inline void __init sev_setup_arch(void) { }\n\nstatic inline void __init sme_encrypt_kernel(struct boot_params *bp) { }\nstatic inline void __init sme_enable(struct boot_params *bp) { }\n\nstatic inline void sev_es_init_vc_handling(void) { }\n\nstatic inline int __init\nearly_set_memory_decrypted(unsigned long vaddr, unsigned long size) { return 0; }\nstatic inline int __init\nearly_set_memory_encrypted(unsigned long vaddr, unsigned long size) { return 0; }\nstatic inline void __init\nearly_set_mem_enc_dec_hypercall(unsigned long vaddr, unsigned long size, bool enc) {}\n\nstatic inline void mem_encrypt_free_decrypted_mem(void) { }\n\n#define __bss_decrypted\n\n#endif\t \n\nvoid add_encrypt_protection_map(void);\n\n \n#define __sme_pa(x)\t\t(__pa(x) | sme_me_mask)\n#define __sme_pa_nodebug(x)\t(__pa_nodebug(x) | sme_me_mask)\n\nextern char __start_bss_decrypted[], __end_bss_decrypted[], __start_bss_decrypted_unused[];\n\nstatic inline u64 sme_get_me_mask(void)\n{\n\treturn sme_me_mask;\n}\n\n#endif\t \n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}