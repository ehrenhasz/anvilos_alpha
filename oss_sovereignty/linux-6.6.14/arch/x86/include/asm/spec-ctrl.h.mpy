{
  "module_name": "spec-ctrl.h",
  "hash_id": "ae34aadc524928ddf4d400263d7917e092d6cebda0ed89eec816c96579bc6a12",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/spec-ctrl.h",
  "human_readable_source": " \n#ifndef _ASM_X86_SPECCTRL_H_\n#define _ASM_X86_SPECCTRL_H_\n\n#include <linux/thread_info.h>\n#include <asm/nospec-branch.h>\n\n \nextern void x86_virt_spec_ctrl(u64 guest_virt_spec_ctrl, bool guest);\n\n \nstatic inline\nvoid x86_spec_ctrl_set_guest(u64 guest_virt_spec_ctrl)\n{\n\tx86_virt_spec_ctrl(guest_virt_spec_ctrl, true);\n}\n\n \nstatic inline\nvoid x86_spec_ctrl_restore_host(u64 guest_virt_spec_ctrl)\n{\n\tx86_virt_spec_ctrl(guest_virt_spec_ctrl, false);\n}\n\n \nextern u64 x86_amd_ls_cfg_base;\nextern u64 x86_amd_ls_cfg_ssbd_mask;\n\nstatic inline u64 ssbd_tif_to_spec_ctrl(u64 tifn)\n{\n\tBUILD_BUG_ON(TIF_SSBD < SPEC_CTRL_SSBD_SHIFT);\n\treturn (tifn & _TIF_SSBD) >> (TIF_SSBD - SPEC_CTRL_SSBD_SHIFT);\n}\n\nstatic inline u64 stibp_tif_to_spec_ctrl(u64 tifn)\n{\n\tBUILD_BUG_ON(TIF_SPEC_IB < SPEC_CTRL_STIBP_SHIFT);\n\treturn (tifn & _TIF_SPEC_IB) >> (TIF_SPEC_IB - SPEC_CTRL_STIBP_SHIFT);\n}\n\nstatic inline unsigned long ssbd_spec_ctrl_to_tif(u64 spec_ctrl)\n{\n\tBUILD_BUG_ON(TIF_SSBD < SPEC_CTRL_SSBD_SHIFT);\n\treturn (spec_ctrl & SPEC_CTRL_SSBD) << (TIF_SSBD - SPEC_CTRL_SSBD_SHIFT);\n}\n\nstatic inline unsigned long stibp_spec_ctrl_to_tif(u64 spec_ctrl)\n{\n\tBUILD_BUG_ON(TIF_SPEC_IB < SPEC_CTRL_STIBP_SHIFT);\n\treturn (spec_ctrl & SPEC_CTRL_STIBP) << (TIF_SPEC_IB - SPEC_CTRL_STIBP_SHIFT);\n}\n\nstatic inline u64 ssbd_tif_to_amd_ls_cfg(u64 tifn)\n{\n\treturn (tifn & _TIF_SSBD) ? x86_amd_ls_cfg_ssbd_mask : 0ULL;\n}\n\n#ifdef CONFIG_SMP\nextern void speculative_store_bypass_ht_init(void);\n#else\nstatic inline void speculative_store_bypass_ht_init(void) { }\n#endif\n\nextern void speculation_ctrl_update(unsigned long tif);\nextern void speculation_ctrl_update_current(void);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}