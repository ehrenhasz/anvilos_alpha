{
  "module_name": "syscall_wrapper.h",
  "hash_id": "aa0af5654fd3bf0f35c2a9f8c2990deb8ad69914ba76c9886fea5a299f7fbac9",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/syscall_wrapper.h",
  "human_readable_source": " \n \n\n#ifndef _ASM_X86_SYSCALL_WRAPPER_H\n#define _ASM_X86_SYSCALL_WRAPPER_H\n\n#include <asm/ptrace.h>\n\nextern long __x64_sys_ni_syscall(const struct pt_regs *regs);\nextern long __ia32_sys_ni_syscall(const struct pt_regs *regs);\n\n \n\n \n#define SC_X86_64_REGS_TO_ARGS(x, ...)\t\t\t\t\t\\\n\t__MAP(x,__SC_ARGS\t\t\t\t\t\t\\\n\t\t,,regs->di,,regs->si,,regs->dx\t\t\t\t\\\n\t\t,,regs->r10,,regs->r8,,regs->r9)\t\t\t\\\n\n \n#define SC_IA32_REGS_TO_ARGS(x, ...)\t\t\t\t\t\\\n\t__MAP(x,__SC_ARGS\t\t\t\t\t\t\\\n\t      ,,(unsigned int)regs->bx,,(unsigned int)regs->cx\t\t\\\n\t      ,,(unsigned int)regs->dx,,(unsigned int)regs->si\t\t\\\n\t      ,,(unsigned int)regs->di,,(unsigned int)regs->bp)\n\n#define __SYS_STUB0(abi, name)\t\t\t\t\t\t\\\n\tlong __##abi##_##name(const struct pt_regs *regs);\t\t\\\n\tALLOW_ERROR_INJECTION(__##abi##_##name, ERRNO);\t\t\t\\\n\tlong __##abi##_##name(const struct pt_regs *regs)\t\t\\\n\t\t__alias(__do_##name);\n\n#define __SYS_STUBx(abi, name, ...)\t\t\t\t\t\\\n\tlong __##abi##_##name(const struct pt_regs *regs);\t\t\\\n\tALLOW_ERROR_INJECTION(__##abi##_##name, ERRNO);\t\t\t\\\n\tlong __##abi##_##name(const struct pt_regs *regs)\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\treturn __se_##name(__VA_ARGS__);\t\t\t\\\n\t}\n\n#define __COND_SYSCALL(abi, name)\t\t\t\t\t\\\n\t__weak long __##abi##_##name(const struct pt_regs *__unused);\t\\\n\t__weak long __##abi##_##name(const struct pt_regs *__unused)\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\treturn sys_ni_syscall();\t\t\t\t\\\n\t}\n\n#ifdef CONFIG_X86_64\n#define __X64_SYS_STUB0(name)\t\t\t\t\t\t\\\n\t__SYS_STUB0(x64, sys_##name)\n\n#define __X64_SYS_STUBx(x, name, ...)\t\t\t\t\t\\\n\t__SYS_STUBx(x64, sys##name,\t\t\t\t\t\\\n\t\t    SC_X86_64_REGS_TO_ARGS(x, __VA_ARGS__))\n\n#define __X64_COND_SYSCALL(name)\t\t\t\t\t\\\n\t__COND_SYSCALL(x64, sys_##name)\n\n#else  \n#define __X64_SYS_STUB0(name)\n#define __X64_SYS_STUBx(x, name, ...)\n#define __X64_COND_SYSCALL(name)\n#endif  \n\n#if defined(CONFIG_X86_32) || defined(CONFIG_IA32_EMULATION)\n#define __IA32_SYS_STUB0(name)\t\t\t\t\t\t\\\n\t__SYS_STUB0(ia32, sys_##name)\n\n#define __IA32_SYS_STUBx(x, name, ...)\t\t\t\t\t\\\n\t__SYS_STUBx(ia32, sys##name,\t\t\t\t\t\\\n\t\t    SC_IA32_REGS_TO_ARGS(x, __VA_ARGS__))\n\n#define __IA32_COND_SYSCALL(name)\t\t\t\t\t\\\n\t__COND_SYSCALL(ia32, sys_##name)\n\n#else  \n#define __IA32_SYS_STUB0(name)\n#define __IA32_SYS_STUBx(x, name, ...)\n#define __IA32_COND_SYSCALL(name)\n#endif  \n\n#ifdef CONFIG_IA32_EMULATION\n \n#define __IA32_COMPAT_SYS_STUB0(name)\t\t\t\t\t\\\n\t__SYS_STUB0(ia32, compat_sys_##name)\n\n#define __IA32_COMPAT_SYS_STUBx(x, name, ...)\t\t\t\t\\\n\t__SYS_STUBx(ia32, compat_sys##name,\t\t\t\t\\\n\t\t    SC_IA32_REGS_TO_ARGS(x, __VA_ARGS__))\n\n#define __IA32_COMPAT_COND_SYSCALL(name)\t\t\t\t\\\n\t__COND_SYSCALL(ia32, compat_sys_##name)\n\n#else  \n#define __IA32_COMPAT_SYS_STUB0(name)\n#define __IA32_COMPAT_SYS_STUBx(x, name, ...)\n#define __IA32_COMPAT_COND_SYSCALL(name)\n#endif  \n\n\n#ifdef CONFIG_X86_X32_ABI\n \n#define __X32_COMPAT_SYS_STUB0(name)\t\t\t\t\t\\\n\t__SYS_STUB0(x64, compat_sys_##name)\n\n#define __X32_COMPAT_SYS_STUBx(x, name, ...)\t\t\t\t\\\n\t__SYS_STUBx(x64, compat_sys##name,\t\t\t\t\\\n\t\t    SC_X86_64_REGS_TO_ARGS(x, __VA_ARGS__))\n\n#define __X32_COMPAT_COND_SYSCALL(name)\t\t\t\t\t\\\n\t__COND_SYSCALL(x64, compat_sys_##name)\n\n#else  \n#define __X32_COMPAT_SYS_STUB0(name)\n#define __X32_COMPAT_SYS_STUBx(x, name, ...)\n#define __X32_COMPAT_COND_SYSCALL(name)\n#endif  \n\n\n#ifdef CONFIG_COMPAT\n \n#define COMPAT_SYSCALL_DEFINE0(name)\t\t\t\t\t\\\n\tstatic long\t\t\t\t\t\t\t\\\n\t__do_compat_sys_##name(const struct pt_regs *__unused);\t\t\\\n\t__IA32_COMPAT_SYS_STUB0(name)\t\t\t\t\t\\\n\t__X32_COMPAT_SYS_STUB0(name)\t\t\t\t\t\\\n\tstatic long\t\t\t\t\t\t\t\\\n\t__do_compat_sys_##name(const struct pt_regs *__unused)\n\n#define COMPAT_SYSCALL_DEFINEx(x, name, ...)\t\t\t\t\t\\\n\tstatic long __se_compat_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__));\t\\\n\tstatic inline long __do_compat_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__));\\\n\t__IA32_COMPAT_SYS_STUBx(x, name, __VA_ARGS__)\t\t\t\t\\\n\t__X32_COMPAT_SYS_STUBx(x, name, __VA_ARGS__)\t\t\t\t\\\n\tstatic long __se_compat_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__))\t\\\n\t{\t\t\t\t\t\t\t\t\t\\\n\t\treturn __do_compat_sys##name(__MAP(x,__SC_DELOUSE,__VA_ARGS__));\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\tstatic inline long __do_compat_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__))\n\n \n#define COND_SYSCALL_COMPAT(name) \t\t\t\t\t\\\n\t__IA32_COMPAT_COND_SYSCALL(name)\t\t\t\t\\\n\t__X32_COMPAT_COND_SYSCALL(name)\n\n#endif  \n\n#define __SYSCALL_DEFINEx(x, name, ...)\t\t\t\t\t\\\n\tstatic long __se_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__));\t\\\n\tstatic inline long __do_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__));\\\n\t__X64_SYS_STUBx(x, name, __VA_ARGS__)\t\t\t\t\\\n\t__IA32_SYS_STUBx(x, name, __VA_ARGS__)\t\t\t\t\\\n\tstatic long __se_sys##name(__MAP(x,__SC_LONG,__VA_ARGS__))\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\tlong ret = __do_sys##name(__MAP(x,__SC_CAST,__VA_ARGS__));\\\n\t\t__MAP(x,__SC_TEST,__VA_ARGS__);\t\t\t\t\\\n\t\t__PROTECT(x, ret,__MAP(x,__SC_ARGS,__VA_ARGS__));\t\\\n\t\treturn ret;\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tstatic inline long __do_sys##name(__MAP(x,__SC_DECL,__VA_ARGS__))\n\n \n#define SYSCALL_DEFINE0(sname)\t\t\t\t\t\t\\\n\tSYSCALL_METADATA(_##sname, 0);\t\t\t\t\t\\\n\tstatic long __do_sys_##sname(const struct pt_regs *__unused);\t\\\n\t__X64_SYS_STUB0(sname)\t\t\t\t\t\t\\\n\t__IA32_SYS_STUB0(sname)\t\t\t\t\t\t\\\n\tstatic long __do_sys_##sname(const struct pt_regs *__unused)\n\n#define COND_SYSCALL(name)\t\t\t\t\t\t\\\n\t__X64_COND_SYSCALL(name)\t\t\t\t\t\\\n\t__IA32_COND_SYSCALL(name)\n\n\n \nlong __x64_sys_getcpu(const struct pt_regs *regs);\nlong __x64_sys_gettimeofday(const struct pt_regs *regs);\nlong __x64_sys_time(const struct pt_regs *regs);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}