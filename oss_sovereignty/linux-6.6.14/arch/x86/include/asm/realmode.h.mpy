{
  "module_name": "realmode.h",
  "hash_id": "24de73e15d7424653f6ef11bea5a6334f2e9874dfbba0dc9922413f29e3fdcf5",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/realmode.h",
  "human_readable_source": " \n#ifndef _ARCH_X86_REALMODE_H\n#define _ARCH_X86_REALMODE_H\n\n \n#define TH_FLAGS_SME_ACTIVE_BIT\t\t0\n#define TH_FLAGS_SME_ACTIVE\t\tBIT(TH_FLAGS_SME_ACTIVE_BIT)\n\n#ifndef __ASSEMBLY__\n\n#include <linux/types.h>\n#include <asm/io.h>\n\n \nstruct real_mode_header {\n\tu32\ttext_start;\n\tu32\tro_end;\n\t \n\tu32\ttrampoline_start;\n\tu32\ttrampoline_header;\n#ifdef CONFIG_AMD_MEM_ENCRYPT\n\tu32\tsev_es_trampoline_start;\n#endif\n#ifdef CONFIG_X86_64\n\tu32\ttrampoline_start64;\n\tu32\ttrampoline_pgd;\n#endif\n\t \n#ifdef CONFIG_ACPI_SLEEP\n\tu32\twakeup_start;\n\tu32\twakeup_header;\n#endif\n\t \n\tu32\tmachine_real_restart_asm;\n#ifdef CONFIG_X86_64\n\tu32\tmachine_real_restart_seg;\n#endif\n};\n\n \nstruct trampoline_header {\n#ifdef CONFIG_X86_32\n\tu32 start;\n\tu16 gdt_pad;\n\tu16 gdt_limit;\n\tu32 gdt_base;\n#else\n\tu64 start;\n\tu64 efer;\n\tu32 cr4;\n\tu32 flags;\n\tu32 lock;\n#endif\n};\n\nextern struct real_mode_header *real_mode_header;\nextern unsigned char real_mode_blob_end[];\n\nextern unsigned long initial_code;\nextern unsigned long initial_stack;\n#ifdef CONFIG_AMD_MEM_ENCRYPT\nextern unsigned long initial_vc_handler;\n#endif\n\nextern u32 *trampoline_lock;\n\nextern unsigned char real_mode_blob[];\nextern unsigned char real_mode_relocs[];\n\n#ifdef CONFIG_X86_32\nextern unsigned char startup_32_smp[];\nextern unsigned char boot_gdt[];\n#else\nextern unsigned char secondary_startup_64[];\nextern unsigned char secondary_startup_64_no_verify[];\n#endif\n\nstatic inline size_t real_mode_size_needed(void)\n{\n\tif (real_mode_header)\n\t\treturn 0;\t \n\n\treturn ALIGN(real_mode_blob_end - real_mode_blob, PAGE_SIZE);\n}\n\nstatic inline void set_real_mode_mem(phys_addr_t mem)\n{\n\treal_mode_header = (struct real_mode_header *) __va(mem);\n}\n\nvoid reserve_real_mode(void);\nvoid load_trampoline_pgtable(void);\nvoid init_real_mode(void);\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}