{
  "module_name": "vmx.h",
  "hash_id": "41e854d9a72e1e5de13af94c16734c87b736b7fdc2d697fcaf13b2d86c953d77",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/vmx.h",
  "human_readable_source": " \n \n#ifndef VMX_H\n#define VMX_H\n\n\n#include <linux/bitops.h>\n#include <linux/bug.h>\n#include <linux/types.h>\n\n#include <uapi/asm/vmx.h>\n#include <asm/vmxfeatures.h>\n\n#define VMCS_CONTROL_BIT(x)\tBIT(VMX_FEATURE_##x & 0x1f)\n\n \n#define CPU_BASED_INTR_WINDOW_EXITING           VMCS_CONTROL_BIT(INTR_WINDOW_EXITING)\n#define CPU_BASED_USE_TSC_OFFSETTING            VMCS_CONTROL_BIT(USE_TSC_OFFSETTING)\n#define CPU_BASED_HLT_EXITING                   VMCS_CONTROL_BIT(HLT_EXITING)\n#define CPU_BASED_INVLPG_EXITING                VMCS_CONTROL_BIT(INVLPG_EXITING)\n#define CPU_BASED_MWAIT_EXITING                 VMCS_CONTROL_BIT(MWAIT_EXITING)\n#define CPU_BASED_RDPMC_EXITING                 VMCS_CONTROL_BIT(RDPMC_EXITING)\n#define CPU_BASED_RDTSC_EXITING                 VMCS_CONTROL_BIT(RDTSC_EXITING)\n#define CPU_BASED_CR3_LOAD_EXITING\t\tVMCS_CONTROL_BIT(CR3_LOAD_EXITING)\n#define CPU_BASED_CR3_STORE_EXITING\t\tVMCS_CONTROL_BIT(CR3_STORE_EXITING)\n#define CPU_BASED_ACTIVATE_TERTIARY_CONTROLS\tVMCS_CONTROL_BIT(TERTIARY_CONTROLS)\n#define CPU_BASED_CR8_LOAD_EXITING              VMCS_CONTROL_BIT(CR8_LOAD_EXITING)\n#define CPU_BASED_CR8_STORE_EXITING             VMCS_CONTROL_BIT(CR8_STORE_EXITING)\n#define CPU_BASED_TPR_SHADOW                    VMCS_CONTROL_BIT(VIRTUAL_TPR)\n#define CPU_BASED_NMI_WINDOW_EXITING\t\tVMCS_CONTROL_BIT(NMI_WINDOW_EXITING)\n#define CPU_BASED_MOV_DR_EXITING                VMCS_CONTROL_BIT(MOV_DR_EXITING)\n#define CPU_BASED_UNCOND_IO_EXITING             VMCS_CONTROL_BIT(UNCOND_IO_EXITING)\n#define CPU_BASED_USE_IO_BITMAPS                VMCS_CONTROL_BIT(USE_IO_BITMAPS)\n#define CPU_BASED_MONITOR_TRAP_FLAG             VMCS_CONTROL_BIT(MONITOR_TRAP_FLAG)\n#define CPU_BASED_USE_MSR_BITMAPS               VMCS_CONTROL_BIT(USE_MSR_BITMAPS)\n#define CPU_BASED_MONITOR_EXITING               VMCS_CONTROL_BIT(MONITOR_EXITING)\n#define CPU_BASED_PAUSE_EXITING                 VMCS_CONTROL_BIT(PAUSE_EXITING)\n#define CPU_BASED_ACTIVATE_SECONDARY_CONTROLS   VMCS_CONTROL_BIT(SEC_CONTROLS)\n\n#define CPU_BASED_ALWAYSON_WITHOUT_TRUE_MSR\t0x0401e172\n\n \n#define SECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES VMCS_CONTROL_BIT(VIRT_APIC_ACCESSES)\n#define SECONDARY_EXEC_ENABLE_EPT               VMCS_CONTROL_BIT(EPT)\n#define SECONDARY_EXEC_DESC\t\t\tVMCS_CONTROL_BIT(DESC_EXITING)\n#define SECONDARY_EXEC_ENABLE_RDTSCP\t\tVMCS_CONTROL_BIT(RDTSCP)\n#define SECONDARY_EXEC_VIRTUALIZE_X2APIC_MODE   VMCS_CONTROL_BIT(VIRTUAL_X2APIC)\n#define SECONDARY_EXEC_ENABLE_VPID              VMCS_CONTROL_BIT(VPID)\n#define SECONDARY_EXEC_WBINVD_EXITING\t\tVMCS_CONTROL_BIT(WBINVD_EXITING)\n#define SECONDARY_EXEC_UNRESTRICTED_GUEST\tVMCS_CONTROL_BIT(UNRESTRICTED_GUEST)\n#define SECONDARY_EXEC_APIC_REGISTER_VIRT       VMCS_CONTROL_BIT(APIC_REGISTER_VIRT)\n#define SECONDARY_EXEC_VIRTUAL_INTR_DELIVERY    VMCS_CONTROL_BIT(VIRT_INTR_DELIVERY)\n#define SECONDARY_EXEC_PAUSE_LOOP_EXITING\tVMCS_CONTROL_BIT(PAUSE_LOOP_EXITING)\n#define SECONDARY_EXEC_RDRAND_EXITING\t\tVMCS_CONTROL_BIT(RDRAND_EXITING)\n#define SECONDARY_EXEC_ENABLE_INVPCID\t\tVMCS_CONTROL_BIT(INVPCID)\n#define SECONDARY_EXEC_ENABLE_VMFUNC            VMCS_CONTROL_BIT(VMFUNC)\n#define SECONDARY_EXEC_SHADOW_VMCS              VMCS_CONTROL_BIT(SHADOW_VMCS)\n#define SECONDARY_EXEC_ENCLS_EXITING\t\tVMCS_CONTROL_BIT(ENCLS_EXITING)\n#define SECONDARY_EXEC_RDSEED_EXITING\t\tVMCS_CONTROL_BIT(RDSEED_EXITING)\n#define SECONDARY_EXEC_ENABLE_PML               VMCS_CONTROL_BIT(PAGE_MOD_LOGGING)\n#define SECONDARY_EXEC_PT_CONCEAL_VMX\t\tVMCS_CONTROL_BIT(PT_CONCEAL_VMX)\n#define SECONDARY_EXEC_ENABLE_XSAVES\t\tVMCS_CONTROL_BIT(XSAVES)\n#define SECONDARY_EXEC_MODE_BASED_EPT_EXEC\tVMCS_CONTROL_BIT(MODE_BASED_EPT_EXEC)\n#define SECONDARY_EXEC_PT_USE_GPA\t\tVMCS_CONTROL_BIT(PT_USE_GPA)\n#define SECONDARY_EXEC_TSC_SCALING              VMCS_CONTROL_BIT(TSC_SCALING)\n#define SECONDARY_EXEC_ENABLE_USR_WAIT_PAUSE\tVMCS_CONTROL_BIT(USR_WAIT_PAUSE)\n#define SECONDARY_EXEC_BUS_LOCK_DETECTION\tVMCS_CONTROL_BIT(BUS_LOCK_DETECTION)\n#define SECONDARY_EXEC_NOTIFY_VM_EXITING\tVMCS_CONTROL_BIT(NOTIFY_VM_EXITING)\n\n \n#define TERTIARY_EXEC_IPI_VIRT\t\t\tVMCS_CONTROL_BIT(IPI_VIRT)\n\n#define PIN_BASED_EXT_INTR_MASK                 VMCS_CONTROL_BIT(INTR_EXITING)\n#define PIN_BASED_NMI_EXITING                   VMCS_CONTROL_BIT(NMI_EXITING)\n#define PIN_BASED_VIRTUAL_NMIS                  VMCS_CONTROL_BIT(VIRTUAL_NMIS)\n#define PIN_BASED_VMX_PREEMPTION_TIMER          VMCS_CONTROL_BIT(PREEMPTION_TIMER)\n#define PIN_BASED_POSTED_INTR                   VMCS_CONTROL_BIT(POSTED_INTR)\n\n#define PIN_BASED_ALWAYSON_WITHOUT_TRUE_MSR\t0x00000016\n\n#define VM_EXIT_SAVE_DEBUG_CONTROLS             0x00000004\n#define VM_EXIT_HOST_ADDR_SPACE_SIZE            0x00000200\n#define VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL      0x00001000\n#define VM_EXIT_ACK_INTR_ON_EXIT                0x00008000\n#define VM_EXIT_SAVE_IA32_PAT\t\t\t0x00040000\n#define VM_EXIT_LOAD_IA32_PAT\t\t\t0x00080000\n#define VM_EXIT_SAVE_IA32_EFER                  0x00100000\n#define VM_EXIT_LOAD_IA32_EFER                  0x00200000\n#define VM_EXIT_SAVE_VMX_PREEMPTION_TIMER       0x00400000\n#define VM_EXIT_CLEAR_BNDCFGS                   0x00800000\n#define VM_EXIT_PT_CONCEAL_PIP\t\t\t0x01000000\n#define VM_EXIT_CLEAR_IA32_RTIT_CTL\t\t0x02000000\n\n#define VM_EXIT_ALWAYSON_WITHOUT_TRUE_MSR\t0x00036dff\n\n#define VM_ENTRY_LOAD_DEBUG_CONTROLS            0x00000004\n#define VM_ENTRY_IA32E_MODE                     0x00000200\n#define VM_ENTRY_SMM                            0x00000400\n#define VM_ENTRY_DEACT_DUAL_MONITOR             0x00000800\n#define VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL     0x00002000\n#define VM_ENTRY_LOAD_IA32_PAT\t\t\t0x00004000\n#define VM_ENTRY_LOAD_IA32_EFER                 0x00008000\n#define VM_ENTRY_LOAD_BNDCFGS                   0x00010000\n#define VM_ENTRY_PT_CONCEAL_PIP\t\t\t0x00020000\n#define VM_ENTRY_LOAD_IA32_RTIT_CTL\t\t0x00040000\n\n#define VM_ENTRY_ALWAYSON_WITHOUT_TRUE_MSR\t0x000011ff\n\n#define VMX_MISC_PREEMPTION_TIMER_RATE_MASK\t0x0000001f\n#define VMX_MISC_SAVE_EFER_LMA\t\t\t0x00000020\n#define VMX_MISC_ACTIVITY_HLT\t\t\t0x00000040\n#define VMX_MISC_ACTIVITY_WAIT_SIPI\t\t0x00000100\n#define VMX_MISC_ZERO_LEN_INS\t\t\t0x40000000\n#define VMX_MISC_MSR_LIST_MULTIPLIER\t\t512\n\n \n#define VMFUNC_CONTROL_BIT(x)\tBIT((VMX_FEATURE_##x & 0x1f) - 28)\n\n#define VMX_VMFUNC_EPTP_SWITCHING               VMFUNC_CONTROL_BIT(EPTP_SWITCHING)\n#define VMFUNC_EPTP_ENTRIES  512\n\nstatic inline u32 vmx_basic_vmcs_revision_id(u64 vmx_basic)\n{\n\treturn vmx_basic & GENMASK_ULL(30, 0);\n}\n\nstatic inline u32 vmx_basic_vmcs_size(u64 vmx_basic)\n{\n\treturn (vmx_basic & GENMASK_ULL(44, 32)) >> 32;\n}\n\nstatic inline int vmx_misc_preemption_timer_rate(u64 vmx_misc)\n{\n\treturn vmx_misc & VMX_MISC_PREEMPTION_TIMER_RATE_MASK;\n}\n\nstatic inline int vmx_misc_cr3_count(u64 vmx_misc)\n{\n\treturn (vmx_misc & GENMASK_ULL(24, 16)) >> 16;\n}\n\nstatic inline int vmx_misc_max_msr(u64 vmx_misc)\n{\n\treturn (vmx_misc & GENMASK_ULL(27, 25)) >> 25;\n}\n\nstatic inline int vmx_misc_mseg_revid(u64 vmx_misc)\n{\n\treturn (vmx_misc & GENMASK_ULL(63, 32)) >> 32;\n}\n\n \nenum vmcs_field {\n\tVIRTUAL_PROCESSOR_ID            = 0x00000000,\n\tPOSTED_INTR_NV                  = 0x00000002,\n\tLAST_PID_POINTER_INDEX\t\t= 0x00000008,\n\tGUEST_ES_SELECTOR               = 0x00000800,\n\tGUEST_CS_SELECTOR               = 0x00000802,\n\tGUEST_SS_SELECTOR               = 0x00000804,\n\tGUEST_DS_SELECTOR               = 0x00000806,\n\tGUEST_FS_SELECTOR               = 0x00000808,\n\tGUEST_GS_SELECTOR               = 0x0000080a,\n\tGUEST_LDTR_SELECTOR             = 0x0000080c,\n\tGUEST_TR_SELECTOR               = 0x0000080e,\n\tGUEST_INTR_STATUS               = 0x00000810,\n\tGUEST_PML_INDEX\t\t\t= 0x00000812,\n\tHOST_ES_SELECTOR                = 0x00000c00,\n\tHOST_CS_SELECTOR                = 0x00000c02,\n\tHOST_SS_SELECTOR                = 0x00000c04,\n\tHOST_DS_SELECTOR                = 0x00000c06,\n\tHOST_FS_SELECTOR                = 0x00000c08,\n\tHOST_GS_SELECTOR                = 0x00000c0a,\n\tHOST_TR_SELECTOR                = 0x00000c0c,\n\tIO_BITMAP_A                     = 0x00002000,\n\tIO_BITMAP_A_HIGH                = 0x00002001,\n\tIO_BITMAP_B                     = 0x00002002,\n\tIO_BITMAP_B_HIGH                = 0x00002003,\n\tMSR_BITMAP                      = 0x00002004,\n\tMSR_BITMAP_HIGH                 = 0x00002005,\n\tVM_EXIT_MSR_STORE_ADDR          = 0x00002006,\n\tVM_EXIT_MSR_STORE_ADDR_HIGH     = 0x00002007,\n\tVM_EXIT_MSR_LOAD_ADDR           = 0x00002008,\n\tVM_EXIT_MSR_LOAD_ADDR_HIGH      = 0x00002009,\n\tVM_ENTRY_MSR_LOAD_ADDR          = 0x0000200a,\n\tVM_ENTRY_MSR_LOAD_ADDR_HIGH     = 0x0000200b,\n\tPML_ADDRESS\t\t\t= 0x0000200e,\n\tPML_ADDRESS_HIGH\t\t= 0x0000200f,\n\tTSC_OFFSET                      = 0x00002010,\n\tTSC_OFFSET_HIGH                 = 0x00002011,\n\tVIRTUAL_APIC_PAGE_ADDR          = 0x00002012,\n\tVIRTUAL_APIC_PAGE_ADDR_HIGH     = 0x00002013,\n\tAPIC_ACCESS_ADDR\t\t= 0x00002014,\n\tAPIC_ACCESS_ADDR_HIGH\t\t= 0x00002015,\n\tPOSTED_INTR_DESC_ADDR           = 0x00002016,\n\tPOSTED_INTR_DESC_ADDR_HIGH      = 0x00002017,\n\tVM_FUNCTION_CONTROL             = 0x00002018,\n\tVM_FUNCTION_CONTROL_HIGH        = 0x00002019,\n\tEPT_POINTER                     = 0x0000201a,\n\tEPT_POINTER_HIGH                = 0x0000201b,\n\tEOI_EXIT_BITMAP0                = 0x0000201c,\n\tEOI_EXIT_BITMAP0_HIGH           = 0x0000201d,\n\tEOI_EXIT_BITMAP1                = 0x0000201e,\n\tEOI_EXIT_BITMAP1_HIGH           = 0x0000201f,\n\tEOI_EXIT_BITMAP2                = 0x00002020,\n\tEOI_EXIT_BITMAP2_HIGH           = 0x00002021,\n\tEOI_EXIT_BITMAP3                = 0x00002022,\n\tEOI_EXIT_BITMAP3_HIGH           = 0x00002023,\n\tEPTP_LIST_ADDRESS               = 0x00002024,\n\tEPTP_LIST_ADDRESS_HIGH          = 0x00002025,\n\tVMREAD_BITMAP                   = 0x00002026,\n\tVMREAD_BITMAP_HIGH              = 0x00002027,\n\tVMWRITE_BITMAP                  = 0x00002028,\n\tVMWRITE_BITMAP_HIGH             = 0x00002029,\n\tXSS_EXIT_BITMAP                 = 0x0000202C,\n\tXSS_EXIT_BITMAP_HIGH            = 0x0000202D,\n\tENCLS_EXITING_BITMAP\t\t= 0x0000202E,\n\tENCLS_EXITING_BITMAP_HIGH\t= 0x0000202F,\n\tTSC_MULTIPLIER                  = 0x00002032,\n\tTSC_MULTIPLIER_HIGH             = 0x00002033,\n\tTERTIARY_VM_EXEC_CONTROL\t= 0x00002034,\n\tTERTIARY_VM_EXEC_CONTROL_HIGH\t= 0x00002035,\n\tPID_POINTER_TABLE\t\t= 0x00002042,\n\tPID_POINTER_TABLE_HIGH\t\t= 0x00002043,\n\tGUEST_PHYSICAL_ADDRESS          = 0x00002400,\n\tGUEST_PHYSICAL_ADDRESS_HIGH     = 0x00002401,\n\tVMCS_LINK_POINTER               = 0x00002800,\n\tVMCS_LINK_POINTER_HIGH          = 0x00002801,\n\tGUEST_IA32_DEBUGCTL             = 0x00002802,\n\tGUEST_IA32_DEBUGCTL_HIGH        = 0x00002803,\n\tGUEST_IA32_PAT\t\t\t= 0x00002804,\n\tGUEST_IA32_PAT_HIGH\t\t= 0x00002805,\n\tGUEST_IA32_EFER\t\t\t= 0x00002806,\n\tGUEST_IA32_EFER_HIGH\t\t= 0x00002807,\n\tGUEST_IA32_PERF_GLOBAL_CTRL\t= 0x00002808,\n\tGUEST_IA32_PERF_GLOBAL_CTRL_HIGH= 0x00002809,\n\tGUEST_PDPTR0                    = 0x0000280a,\n\tGUEST_PDPTR0_HIGH               = 0x0000280b,\n\tGUEST_PDPTR1                    = 0x0000280c,\n\tGUEST_PDPTR1_HIGH               = 0x0000280d,\n\tGUEST_PDPTR2                    = 0x0000280e,\n\tGUEST_PDPTR2_HIGH               = 0x0000280f,\n\tGUEST_PDPTR3                    = 0x00002810,\n\tGUEST_PDPTR3_HIGH               = 0x00002811,\n\tGUEST_BNDCFGS                   = 0x00002812,\n\tGUEST_BNDCFGS_HIGH              = 0x00002813,\n\tGUEST_IA32_RTIT_CTL\t\t= 0x00002814,\n\tGUEST_IA32_RTIT_CTL_HIGH\t= 0x00002815,\n\tHOST_IA32_PAT\t\t\t= 0x00002c00,\n\tHOST_IA32_PAT_HIGH\t\t= 0x00002c01,\n\tHOST_IA32_EFER\t\t\t= 0x00002c02,\n\tHOST_IA32_EFER_HIGH\t\t= 0x00002c03,\n\tHOST_IA32_PERF_GLOBAL_CTRL\t= 0x00002c04,\n\tHOST_IA32_PERF_GLOBAL_CTRL_HIGH\t= 0x00002c05,\n\tPIN_BASED_VM_EXEC_CONTROL       = 0x00004000,\n\tCPU_BASED_VM_EXEC_CONTROL       = 0x00004002,\n\tEXCEPTION_BITMAP                = 0x00004004,\n\tPAGE_FAULT_ERROR_CODE_MASK      = 0x00004006,\n\tPAGE_FAULT_ERROR_CODE_MATCH     = 0x00004008,\n\tCR3_TARGET_COUNT                = 0x0000400a,\n\tVM_EXIT_CONTROLS                = 0x0000400c,\n\tVM_EXIT_MSR_STORE_COUNT         = 0x0000400e,\n\tVM_EXIT_MSR_LOAD_COUNT          = 0x00004010,\n\tVM_ENTRY_CONTROLS               = 0x00004012,\n\tVM_ENTRY_MSR_LOAD_COUNT         = 0x00004014,\n\tVM_ENTRY_INTR_INFO_FIELD        = 0x00004016,\n\tVM_ENTRY_EXCEPTION_ERROR_CODE   = 0x00004018,\n\tVM_ENTRY_INSTRUCTION_LEN        = 0x0000401a,\n\tTPR_THRESHOLD                   = 0x0000401c,\n\tSECONDARY_VM_EXEC_CONTROL       = 0x0000401e,\n\tPLE_GAP                         = 0x00004020,\n\tPLE_WINDOW                      = 0x00004022,\n\tNOTIFY_WINDOW                   = 0x00004024,\n\tVM_INSTRUCTION_ERROR            = 0x00004400,\n\tVM_EXIT_REASON                  = 0x00004402,\n\tVM_EXIT_INTR_INFO               = 0x00004404,\n\tVM_EXIT_INTR_ERROR_CODE         = 0x00004406,\n\tIDT_VECTORING_INFO_FIELD        = 0x00004408,\n\tIDT_VECTORING_ERROR_CODE        = 0x0000440a,\n\tVM_EXIT_INSTRUCTION_LEN         = 0x0000440c,\n\tVMX_INSTRUCTION_INFO            = 0x0000440e,\n\tGUEST_ES_LIMIT                  = 0x00004800,\n\tGUEST_CS_LIMIT                  = 0x00004802,\n\tGUEST_SS_LIMIT                  = 0x00004804,\n\tGUEST_DS_LIMIT                  = 0x00004806,\n\tGUEST_FS_LIMIT                  = 0x00004808,\n\tGUEST_GS_LIMIT                  = 0x0000480a,\n\tGUEST_LDTR_LIMIT                = 0x0000480c,\n\tGUEST_TR_LIMIT                  = 0x0000480e,\n\tGUEST_GDTR_LIMIT                = 0x00004810,\n\tGUEST_IDTR_LIMIT                = 0x00004812,\n\tGUEST_ES_AR_BYTES               = 0x00004814,\n\tGUEST_CS_AR_BYTES               = 0x00004816,\n\tGUEST_SS_AR_BYTES               = 0x00004818,\n\tGUEST_DS_AR_BYTES               = 0x0000481a,\n\tGUEST_FS_AR_BYTES               = 0x0000481c,\n\tGUEST_GS_AR_BYTES               = 0x0000481e,\n\tGUEST_LDTR_AR_BYTES             = 0x00004820,\n\tGUEST_TR_AR_BYTES               = 0x00004822,\n\tGUEST_INTERRUPTIBILITY_INFO     = 0x00004824,\n\tGUEST_ACTIVITY_STATE            = 0x00004826,\n\tGUEST_SYSENTER_CS               = 0x0000482A,\n\tVMX_PREEMPTION_TIMER_VALUE      = 0x0000482E,\n\tHOST_IA32_SYSENTER_CS           = 0x00004c00,\n\tCR0_GUEST_HOST_MASK             = 0x00006000,\n\tCR4_GUEST_HOST_MASK             = 0x00006002,\n\tCR0_READ_SHADOW                 = 0x00006004,\n\tCR4_READ_SHADOW                 = 0x00006006,\n\tCR3_TARGET_VALUE0               = 0x00006008,\n\tCR3_TARGET_VALUE1               = 0x0000600a,\n\tCR3_TARGET_VALUE2               = 0x0000600c,\n\tCR3_TARGET_VALUE3               = 0x0000600e,\n\tEXIT_QUALIFICATION              = 0x00006400,\n\tGUEST_LINEAR_ADDRESS            = 0x0000640a,\n\tGUEST_CR0                       = 0x00006800,\n\tGUEST_CR3                       = 0x00006802,\n\tGUEST_CR4                       = 0x00006804,\n\tGUEST_ES_BASE                   = 0x00006806,\n\tGUEST_CS_BASE                   = 0x00006808,\n\tGUEST_SS_BASE                   = 0x0000680a,\n\tGUEST_DS_BASE                   = 0x0000680c,\n\tGUEST_FS_BASE                   = 0x0000680e,\n\tGUEST_GS_BASE                   = 0x00006810,\n\tGUEST_LDTR_BASE                 = 0x00006812,\n\tGUEST_TR_BASE                   = 0x00006814,\n\tGUEST_GDTR_BASE                 = 0x00006816,\n\tGUEST_IDTR_BASE                 = 0x00006818,\n\tGUEST_DR7                       = 0x0000681a,\n\tGUEST_RSP                       = 0x0000681c,\n\tGUEST_RIP                       = 0x0000681e,\n\tGUEST_RFLAGS                    = 0x00006820,\n\tGUEST_PENDING_DBG_EXCEPTIONS    = 0x00006822,\n\tGUEST_SYSENTER_ESP              = 0x00006824,\n\tGUEST_SYSENTER_EIP              = 0x00006826,\n\tHOST_CR0                        = 0x00006c00,\n\tHOST_CR3                        = 0x00006c02,\n\tHOST_CR4                        = 0x00006c04,\n\tHOST_FS_BASE                    = 0x00006c06,\n\tHOST_GS_BASE                    = 0x00006c08,\n\tHOST_TR_BASE                    = 0x00006c0a,\n\tHOST_GDTR_BASE                  = 0x00006c0c,\n\tHOST_IDTR_BASE                  = 0x00006c0e,\n\tHOST_IA32_SYSENTER_ESP          = 0x00006c10,\n\tHOST_IA32_SYSENTER_EIP          = 0x00006c12,\n\tHOST_RSP                        = 0x00006c14,\n\tHOST_RIP                        = 0x00006c16,\n};\n\n \n#define INTR_INFO_VECTOR_MASK           0xff             \n#define INTR_INFO_INTR_TYPE_MASK        0x700            \n#define INTR_INFO_DELIVER_CODE_MASK     0x800            \n#define INTR_INFO_UNBLOCK_NMI\t\t0x1000\t\t \n#define INTR_INFO_VALID_MASK            0x80000000       \n#define INTR_INFO_RESVD_BITS_MASK       0x7ffff000\n\n#define VECTORING_INFO_VECTOR_MASK           \tINTR_INFO_VECTOR_MASK\n#define VECTORING_INFO_TYPE_MASK        \tINTR_INFO_INTR_TYPE_MASK\n#define VECTORING_INFO_DELIVER_CODE_MASK    \tINTR_INFO_DELIVER_CODE_MASK\n#define VECTORING_INFO_VALID_MASK       \tINTR_INFO_VALID_MASK\n\n#define INTR_TYPE_EXT_INTR              (0 << 8)  \n#define INTR_TYPE_RESERVED              (1 << 8)  \n#define INTR_TYPE_NMI_INTR\t\t(2 << 8)  \n#define INTR_TYPE_HARD_EXCEPTION\t(3 << 8)  \n#define INTR_TYPE_SOFT_INTR             (4 << 8)  \n#define INTR_TYPE_PRIV_SW_EXCEPTION\t(5 << 8)  \n#define INTR_TYPE_SOFT_EXCEPTION\t(6 << 8)  \n#define INTR_TYPE_OTHER_EVENT           (7 << 8)  \n\n \n#define GUEST_INTR_STATE_STI\t\t0x00000001\n#define GUEST_INTR_STATE_MOV_SS\t\t0x00000002\n#define GUEST_INTR_STATE_SMI\t\t0x00000004\n#define GUEST_INTR_STATE_NMI\t\t0x00000008\n#define GUEST_INTR_STATE_ENCLAVE_INTR\t0x00000010\n\n \n#define GUEST_ACTIVITY_ACTIVE\t\t0\n#define GUEST_ACTIVITY_HLT\t\t1\n#define GUEST_ACTIVITY_SHUTDOWN\t\t2\n#define GUEST_ACTIVITY_WAIT_SIPI\t3\n\n \n#define CONTROL_REG_ACCESS_NUM          0x7      \n#define CONTROL_REG_ACCESS_TYPE         0x30     \n#define CONTROL_REG_ACCESS_REG          0xf00    \n#define LMSW_SOURCE_DATA_SHIFT 16\n#define LMSW_SOURCE_DATA  (0xFFFF << LMSW_SOURCE_DATA_SHIFT)  \n#define REG_EAX                         (0 << 8)\n#define REG_ECX                         (1 << 8)\n#define REG_EDX                         (2 << 8)\n#define REG_EBX                         (3 << 8)\n#define REG_ESP                         (4 << 8)\n#define REG_EBP                         (5 << 8)\n#define REG_ESI                         (6 << 8)\n#define REG_EDI                         (7 << 8)\n#define REG_R8                         (8 << 8)\n#define REG_R9                         (9 << 8)\n#define REG_R10                        (10 << 8)\n#define REG_R11                        (11 << 8)\n#define REG_R12                        (12 << 8)\n#define REG_R13                        (13 << 8)\n#define REG_R14                        (14 << 8)\n#define REG_R15                        (15 << 8)\n\n \n#define DEBUG_REG_ACCESS_NUM            0x7      \n#define DEBUG_REG_ACCESS_TYPE           0x10     \n#define TYPE_MOV_TO_DR                  (0 << 4)\n#define TYPE_MOV_FROM_DR                (1 << 4)\n#define DEBUG_REG_ACCESS_REG(eq)        (((eq) >> 8) & 0xf)  \n\n\n \n#define APIC_ACCESS_OFFSET              0xfff    \n#define APIC_ACCESS_TYPE                0xf000   \n#define TYPE_LINEAR_APIC_INST_READ      (0 << 12)\n#define TYPE_LINEAR_APIC_INST_WRITE     (1 << 12)\n#define TYPE_LINEAR_APIC_INST_FETCH     (2 << 12)\n#define TYPE_LINEAR_APIC_EVENT          (3 << 12)\n#define TYPE_PHYSICAL_APIC_EVENT        (10 << 12)\n#define TYPE_PHYSICAL_APIC_INST         (15 << 12)\n\n \n#define VMX_SEGMENT_AR_L_MASK (1 << 13)\n\n#define VMX_AR_TYPE_ACCESSES_MASK 1\n#define VMX_AR_TYPE_READABLE_MASK (1 << 1)\n#define VMX_AR_TYPE_WRITEABLE_MASK (1 << 2)\n#define VMX_AR_TYPE_CODE_MASK (1 << 3)\n#define VMX_AR_TYPE_MASK 0x0f\n#define VMX_AR_TYPE_BUSY_64_TSS 11\n#define VMX_AR_TYPE_BUSY_32_TSS 11\n#define VMX_AR_TYPE_BUSY_16_TSS 3\n#define VMX_AR_TYPE_LDT 2\n\n#define VMX_AR_UNUSABLE_MASK (1 << 16)\n#define VMX_AR_S_MASK (1 << 4)\n#define VMX_AR_P_MASK (1 << 7)\n#define VMX_AR_L_MASK (1 << 13)\n#define VMX_AR_DB_MASK (1 << 14)\n#define VMX_AR_G_MASK (1 << 15)\n#define VMX_AR_DPL_SHIFT 5\n#define VMX_AR_DPL(ar) (((ar) >> VMX_AR_DPL_SHIFT) & 3)\n\n#define VMX_AR_RESERVD_MASK 0xfffe0f00\n\n#define TSS_PRIVATE_MEMSLOT\t\t\t(KVM_USER_MEM_SLOTS + 0)\n#define APIC_ACCESS_PAGE_PRIVATE_MEMSLOT\t(KVM_USER_MEM_SLOTS + 1)\n#define IDENTITY_PAGETABLE_PRIVATE_MEMSLOT\t(KVM_USER_MEM_SLOTS + 2)\n\n#define VMX_NR_VPIDS\t\t\t\t(1 << 16)\n#define VMX_VPID_EXTENT_INDIVIDUAL_ADDR\t\t0\n#define VMX_VPID_EXTENT_SINGLE_CONTEXT\t\t1\n#define VMX_VPID_EXTENT_ALL_CONTEXT\t\t2\n#define VMX_VPID_EXTENT_SINGLE_NON_GLOBAL\t3\n\n#define VMX_EPT_EXTENT_CONTEXT\t\t\t1\n#define VMX_EPT_EXTENT_GLOBAL\t\t\t2\n#define VMX_EPT_EXTENT_SHIFT\t\t\t24\n\n#define VMX_EPT_EXECUTE_ONLY_BIT\t\t(1ull)\n#define VMX_EPT_PAGE_WALK_4_BIT\t\t\t(1ull << 6)\n#define VMX_EPT_PAGE_WALK_5_BIT\t\t\t(1ull << 7)\n#define VMX_EPTP_UC_BIT\t\t\t\t(1ull << 8)\n#define VMX_EPTP_WB_BIT\t\t\t\t(1ull << 14)\n#define VMX_EPT_2MB_PAGE_BIT\t\t\t(1ull << 16)\n#define VMX_EPT_1GB_PAGE_BIT\t\t\t(1ull << 17)\n#define VMX_EPT_INVEPT_BIT\t\t\t(1ull << 20)\n#define VMX_EPT_AD_BIT\t\t\t\t    (1ull << 21)\n#define VMX_EPT_EXTENT_CONTEXT_BIT\t\t(1ull << 25)\n#define VMX_EPT_EXTENT_GLOBAL_BIT\t\t(1ull << 26)\n\n#define VMX_VPID_INVVPID_BIT                    (1ull << 0)  \n#define VMX_VPID_EXTENT_INDIVIDUAL_ADDR_BIT     (1ull << 8)  \n#define VMX_VPID_EXTENT_SINGLE_CONTEXT_BIT      (1ull << 9)  \n#define VMX_VPID_EXTENT_GLOBAL_CONTEXT_BIT      (1ull << 10)  \n#define VMX_VPID_EXTENT_SINGLE_NON_GLOBAL_BIT   (1ull << 11)  \n\n#define VMX_EPT_MT_EPTE_SHIFT\t\t\t3\n#define VMX_EPTP_PWL_MASK\t\t\t0x38ull\n#define VMX_EPTP_PWL_4\t\t\t\t0x18ull\n#define VMX_EPTP_PWL_5\t\t\t\t0x20ull\n#define VMX_EPTP_AD_ENABLE_BIT\t\t\t(1ull << 6)\n#define VMX_EPTP_MT_MASK\t\t\t0x7ull\n#define VMX_EPTP_MT_WB\t\t\t\t0x6ull\n#define VMX_EPTP_MT_UC\t\t\t\t0x0ull\n#define VMX_EPT_READABLE_MASK\t\t\t0x1ull\n#define VMX_EPT_WRITABLE_MASK\t\t\t0x2ull\n#define VMX_EPT_EXECUTABLE_MASK\t\t\t0x4ull\n#define VMX_EPT_IPAT_BIT    \t\t\t(1ull << 6)\n#define VMX_EPT_ACCESS_BIT\t\t\t(1ull << 8)\n#define VMX_EPT_DIRTY_BIT\t\t\t(1ull << 9)\n#define VMX_EPT_RWX_MASK                        (VMX_EPT_READABLE_MASK |       \\\n\t\t\t\t\t\t VMX_EPT_WRITABLE_MASK |       \\\n\t\t\t\t\t\t VMX_EPT_EXECUTABLE_MASK)\n#define VMX_EPT_MT_MASK\t\t\t\t(7ull << VMX_EPT_MT_EPTE_SHIFT)\n\nstatic inline u8 vmx_eptp_page_walk_level(u64 eptp)\n{\n\tu64 encoded_level = eptp & VMX_EPTP_PWL_MASK;\n\n\tif (encoded_level == VMX_EPTP_PWL_5)\n\t\treturn 5;\n\n\t \n\tWARN_ON_ONCE(encoded_level != VMX_EPTP_PWL_4);\n\treturn 4;\n}\n\n \n#define VMX_EPT_MISCONFIG_WX_VALUE\t\t(VMX_EPT_WRITABLE_MASK |       \\\n\t\t\t\t\t\t VMX_EPT_EXECUTABLE_MASK)\n\n#define VMX_EPT_IDENTITY_PAGETABLE_ADDR\t\t0xfffbc000ul\n\nstruct vmx_msr_entry {\n\tu32 index;\n\tu32 reserved;\n\tu64 value;\n} __aligned(16);\n\n \nenum vm_entry_failure_code {\n\tENTRY_FAIL_DEFAULT\t\t= 0,\n\tENTRY_FAIL_PDPTE\t\t= 2,\n\tENTRY_FAIL_NMI\t\t\t= 3,\n\tENTRY_FAIL_VMCS_LINK_PTR\t= 4,\n};\n\n \n#define EPT_VIOLATION_ACC_READ_BIT\t0\n#define EPT_VIOLATION_ACC_WRITE_BIT\t1\n#define EPT_VIOLATION_ACC_INSTR_BIT\t2\n#define EPT_VIOLATION_RWX_SHIFT\t\t3\n#define EPT_VIOLATION_GVA_IS_VALID_BIT\t7\n#define EPT_VIOLATION_GVA_TRANSLATED_BIT 8\n#define EPT_VIOLATION_ACC_READ\t\t(1 << EPT_VIOLATION_ACC_READ_BIT)\n#define EPT_VIOLATION_ACC_WRITE\t\t(1 << EPT_VIOLATION_ACC_WRITE_BIT)\n#define EPT_VIOLATION_ACC_INSTR\t\t(1 << EPT_VIOLATION_ACC_INSTR_BIT)\n#define EPT_VIOLATION_RWX_MASK\t\t(VMX_EPT_RWX_MASK << EPT_VIOLATION_RWX_SHIFT)\n#define EPT_VIOLATION_GVA_IS_VALID\t(1 << EPT_VIOLATION_GVA_IS_VALID_BIT)\n#define EPT_VIOLATION_GVA_TRANSLATED\t(1 << EPT_VIOLATION_GVA_TRANSLATED_BIT)\n\n \n#define NOTIFY_VM_CONTEXT_INVALID     BIT(0)\n\n \nenum vm_instruction_error_number {\n\tVMXERR_VMCALL_IN_VMX_ROOT_OPERATION = 1,\n\tVMXERR_VMCLEAR_INVALID_ADDRESS = 2,\n\tVMXERR_VMCLEAR_VMXON_POINTER = 3,\n\tVMXERR_VMLAUNCH_NONCLEAR_VMCS = 4,\n\tVMXERR_VMRESUME_NONLAUNCHED_VMCS = 5,\n\tVMXERR_VMRESUME_AFTER_VMXOFF = 6,\n\tVMXERR_ENTRY_INVALID_CONTROL_FIELD = 7,\n\tVMXERR_ENTRY_INVALID_HOST_STATE_FIELD = 8,\n\tVMXERR_VMPTRLD_INVALID_ADDRESS = 9,\n\tVMXERR_VMPTRLD_VMXON_POINTER = 10,\n\tVMXERR_VMPTRLD_INCORRECT_VMCS_REVISION_ID = 11,\n\tVMXERR_UNSUPPORTED_VMCS_COMPONENT = 12,\n\tVMXERR_VMWRITE_READ_ONLY_VMCS_COMPONENT = 13,\n\tVMXERR_VMXON_IN_VMX_ROOT_OPERATION = 15,\n\tVMXERR_ENTRY_INVALID_EXECUTIVE_VMCS_POINTER = 16,\n\tVMXERR_ENTRY_NONLAUNCHED_EXECUTIVE_VMCS = 17,\n\tVMXERR_ENTRY_EXECUTIVE_VMCS_POINTER_NOT_VMXON_POINTER = 18,\n\tVMXERR_VMCALL_NONCLEAR_VMCS = 19,\n\tVMXERR_VMCALL_INVALID_VM_EXIT_CONTROL_FIELDS = 20,\n\tVMXERR_VMCALL_INCORRECT_MSEG_REVISION_ID = 22,\n\tVMXERR_VMXOFF_UNDER_DUAL_MONITOR_TREATMENT_OF_SMIS_AND_SMM = 23,\n\tVMXERR_VMCALL_INVALID_SMM_MONITOR_FEATURES = 24,\n\tVMXERR_ENTRY_INVALID_VM_EXECUTION_CONTROL_FIELDS_IN_EXECUTIVE_VMCS = 25,\n\tVMXERR_ENTRY_EVENTS_BLOCKED_BY_MOV_SS = 26,\n\tVMXERR_INVALID_OPERAND_TO_INVEPT_INVVPID = 28,\n};\n\n \n#define VMX_VMENTER_INSTRUCTION_ERRORS \\\n\t{ VMXERR_VMLAUNCH_NONCLEAR_VMCS,\t\t\"VMLAUNCH_NONCLEAR_VMCS\" }, \\\n\t{ VMXERR_VMRESUME_NONLAUNCHED_VMCS,\t\t\"VMRESUME_NONLAUNCHED_VMCS\" }, \\\n\t{ VMXERR_VMRESUME_AFTER_VMXOFF,\t\t\t\"VMRESUME_AFTER_VMXOFF\" }, \\\n\t{ VMXERR_ENTRY_INVALID_CONTROL_FIELD,\t\t\"VMENTRY_INVALID_CONTROL_FIELD\" }, \\\n\t{ VMXERR_ENTRY_INVALID_HOST_STATE_FIELD,\t\"VMENTRY_INVALID_HOST_STATE_FIELD\" }, \\\n\t{ VMXERR_ENTRY_EVENTS_BLOCKED_BY_MOV_SS,\t\"VMENTRY_EVENTS_BLOCKED_BY_MOV_SS\" }\n\nenum vmx_l1d_flush_state {\n\tVMENTER_L1D_FLUSH_AUTO,\n\tVMENTER_L1D_FLUSH_NEVER,\n\tVMENTER_L1D_FLUSH_COND,\n\tVMENTER_L1D_FLUSH_ALWAYS,\n\tVMENTER_L1D_FLUSH_EPT_DISABLED,\n\tVMENTER_L1D_FLUSH_NOT_REQUIRED,\n};\n\nextern enum vmx_l1d_flush_state l1tf_vmx_mitigation;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}