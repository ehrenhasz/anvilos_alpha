{
  "module_name": "paravirt_types.h",
  "hash_id": "8a06d350a8eec818e9f6121273b1044b647d1d9ba076657d5b2d2dff5181e9e3",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/paravirt_types.h",
  "human_readable_source": " \n#ifndef _ASM_X86_PARAVIRT_TYPES_H\n#define _ASM_X86_PARAVIRT_TYPES_H\n\n#ifndef __ASSEMBLY__\n \nstruct paravirt_patch_site {\n\tu8 *instr;\t\t \n\tu8 type;\t\t \n\tu8 len;\t\t\t \n};\n#endif\n\n#ifdef CONFIG_PARAVIRT\n\n#ifndef __ASSEMBLY__\n\n#include <asm/desc_defs.h>\n#include <asm/pgtable_types.h>\n#include <asm/nospec-branch.h>\n\nstruct page;\nstruct thread_struct;\nstruct desc_ptr;\nstruct tss_struct;\nstruct mm_struct;\nstruct desc_struct;\nstruct task_struct;\nstruct cpumask;\nstruct flush_tlb_info;\nstruct mmu_gather;\nstruct vm_area_struct;\n\n \nstruct paravirt_callee_save {\n\tvoid *func;\n};\n\n \nstruct pv_info {\n#ifdef CONFIG_PARAVIRT_XXL\n\tu16 extra_user_64bit_cs;   \n#endif\n\n\tconst char *name;\n};\n\n#ifdef CONFIG_PARAVIRT_XXL\nstruct pv_lazy_ops {\n\t \n\tvoid (*enter)(void);\n\tvoid (*leave)(void);\n\tvoid (*flush)(void);\n} __no_randomize_layout;\n#endif\n\nstruct pv_cpu_ops {\n\t \n\tvoid (*io_delay)(void);\n\n#ifdef CONFIG_PARAVIRT_XXL\n\tunsigned long (*get_debugreg)(int regno);\n\tvoid (*set_debugreg)(int regno, unsigned long value);\n\n\tunsigned long (*read_cr0)(void);\n\tvoid (*write_cr0)(unsigned long);\n\n\tvoid (*write_cr4)(unsigned long);\n\n\t \n\tvoid (*load_tr_desc)(void);\n\tvoid (*load_gdt)(const struct desc_ptr *);\n\tvoid (*load_idt)(const struct desc_ptr *);\n\tvoid (*set_ldt)(const void *desc, unsigned entries);\n\tunsigned long (*store_tr)(void);\n\tvoid (*load_tls)(struct thread_struct *t, unsigned int cpu);\n\tvoid (*load_gs_index)(unsigned int idx);\n\tvoid (*write_ldt_entry)(struct desc_struct *ldt, int entrynum,\n\t\t\t\tconst void *desc);\n\tvoid (*write_gdt_entry)(struct desc_struct *,\n\t\t\t\tint entrynum, const void *desc, int size);\n\tvoid (*write_idt_entry)(gate_desc *,\n\t\t\t\tint entrynum, const gate_desc *gate);\n\tvoid (*alloc_ldt)(struct desc_struct *ldt, unsigned entries);\n\tvoid (*free_ldt)(struct desc_struct *ldt, unsigned entries);\n\n\tvoid (*load_sp0)(unsigned long sp0);\n\n#ifdef CONFIG_X86_IOPL_IOPERM\n\tvoid (*invalidate_io_bitmap)(void);\n\tvoid (*update_io_bitmap)(void);\n#endif\n\n\tvoid (*wbinvd)(void);\n\n\t \n\tvoid (*cpuid)(unsigned int *eax, unsigned int *ebx,\n\t\t      unsigned int *ecx, unsigned int *edx);\n\n\t \n\tu64 (*read_msr)(unsigned int msr);\n\tvoid (*write_msr)(unsigned int msr, unsigned low, unsigned high);\n\n\t \n\tu64 (*read_msr_safe)(unsigned int msr, int *err);\n\tint (*write_msr_safe)(unsigned int msr, unsigned low, unsigned high);\n\n\tu64 (*read_pmc)(int counter);\n\n\tvoid (*start_context_switch)(struct task_struct *prev);\n\tvoid (*end_context_switch)(struct task_struct *next);\n#endif\n} __no_randomize_layout;\n\nstruct pv_irq_ops {\n#ifdef CONFIG_PARAVIRT_XXL\n\t \n\tstruct paravirt_callee_save save_fl;\n\tstruct paravirt_callee_save irq_disable;\n\tstruct paravirt_callee_save irq_enable;\n\n\tvoid (*safe_halt)(void);\n\tvoid (*halt)(void);\n#endif\n} __no_randomize_layout;\n\nstruct pv_mmu_ops {\n\t \n\tvoid (*flush_tlb_user)(void);\n\tvoid (*flush_tlb_kernel)(void);\n\tvoid (*flush_tlb_one_user)(unsigned long addr);\n\tvoid (*flush_tlb_multi)(const struct cpumask *cpus,\n\t\t\t\tconst struct flush_tlb_info *info);\n\n\tvoid (*tlb_remove_table)(struct mmu_gather *tlb, void *table);\n\n\t \n\tvoid (*exit_mmap)(struct mm_struct *mm);\n\tvoid (*notify_page_enc_status_changed)(unsigned long pfn, int npages, bool enc);\n\n#ifdef CONFIG_PARAVIRT_XXL\n\tstruct paravirt_callee_save read_cr2;\n\tvoid (*write_cr2)(unsigned long);\n\n\tunsigned long (*read_cr3)(void);\n\tvoid (*write_cr3)(unsigned long);\n\n\t \n\tvoid (*enter_mmap)(struct mm_struct *mm);\n\n\t \n\tint  (*pgd_alloc)(struct mm_struct *mm);\n\tvoid (*pgd_free)(struct mm_struct *mm, pgd_t *pgd);\n\n\t \n\tvoid (*alloc_pte)(struct mm_struct *mm, unsigned long pfn);\n\tvoid (*alloc_pmd)(struct mm_struct *mm, unsigned long pfn);\n\tvoid (*alloc_pud)(struct mm_struct *mm, unsigned long pfn);\n\tvoid (*alloc_p4d)(struct mm_struct *mm, unsigned long pfn);\n\tvoid (*release_pte)(unsigned long pfn);\n\tvoid (*release_pmd)(unsigned long pfn);\n\tvoid (*release_pud)(unsigned long pfn);\n\tvoid (*release_p4d)(unsigned long pfn);\n\n\t \n\tvoid (*set_pte)(pte_t *ptep, pte_t pteval);\n\tvoid (*set_pmd)(pmd_t *pmdp, pmd_t pmdval);\n\n\tpte_t (*ptep_modify_prot_start)(struct vm_area_struct *vma, unsigned long addr,\n\t\t\t\t\tpte_t *ptep);\n\tvoid (*ptep_modify_prot_commit)(struct vm_area_struct *vma, unsigned long addr,\n\t\t\t\t\tpte_t *ptep, pte_t pte);\n\n\tstruct paravirt_callee_save pte_val;\n\tstruct paravirt_callee_save make_pte;\n\n\tstruct paravirt_callee_save pgd_val;\n\tstruct paravirt_callee_save make_pgd;\n\n\tvoid (*set_pud)(pud_t *pudp, pud_t pudval);\n\n\tstruct paravirt_callee_save pmd_val;\n\tstruct paravirt_callee_save make_pmd;\n\n\tstruct paravirt_callee_save pud_val;\n\tstruct paravirt_callee_save make_pud;\n\n\tvoid (*set_p4d)(p4d_t *p4dp, p4d_t p4dval);\n\n#if CONFIG_PGTABLE_LEVELS >= 5\n\tstruct paravirt_callee_save p4d_val;\n\tstruct paravirt_callee_save make_p4d;\n\n\tvoid (*set_pgd)(pgd_t *pgdp, pgd_t pgdval);\n#endif\t \n\n\tstruct pv_lazy_ops lazy_mode;\n\n\t \n\n\t \n\tvoid (*set_fixmap)(unsigned   idx,\n\t\t\t   phys_addr_t phys, pgprot_t flags);\n#endif\n} __no_randomize_layout;\n\nstruct arch_spinlock;\n#ifdef CONFIG_SMP\n#include <asm/spinlock_types.h>\n#endif\n\nstruct qspinlock;\n\nstruct pv_lock_ops {\n\tvoid (*queued_spin_lock_slowpath)(struct qspinlock *lock, u32 val);\n\tstruct paravirt_callee_save queued_spin_unlock;\n\n\tvoid (*wait)(u8 *ptr, u8 val);\n\tvoid (*kick)(int cpu);\n\n\tstruct paravirt_callee_save vcpu_is_preempted;\n} __no_randomize_layout;\n\n \nstruct paravirt_patch_template {\n\tstruct pv_cpu_ops\tcpu;\n\tstruct pv_irq_ops\tirq;\n\tstruct pv_mmu_ops\tmmu;\n\tstruct pv_lock_ops\tlock;\n} __no_randomize_layout;\n\nextern struct pv_info pv_info;\nextern struct paravirt_patch_template pv_ops;\n\n#define PARAVIRT_PATCH(x)\t\t\t\t\t\\\n\t(offsetof(struct paravirt_patch_template, x) / sizeof(void *))\n\n#define paravirt_type(op)\t\t\t\t\\\n\t[paravirt_typenum] \"i\" (PARAVIRT_PATCH(op)),\t\\\n\t[paravirt_opptr] \"m\" (pv_ops.op)\n \n#define _paravirt_alt(insn_string, type)\t\t\\\n\t\"771:\\n\\t\" insn_string \"\\n\" \"772:\\n\"\t\t\\\n\t\".pushsection .parainstructions,\\\"a\\\"\\n\"\t\\\n\t_ASM_ALIGN \"\\n\"\t\t\t\t\t\\\n\t_ASM_PTR \" 771b\\n\"\t\t\t\t\\\n\t\"  .byte \" type \"\\n\"\t\t\t\t\\\n\t\"  .byte 772b-771b\\n\"\t\t\t\t\\\n\t_ASM_ALIGN \"\\n\"\t\t\t\t\t\\\n\t\".popsection\\n\"\n\n \n#define paravirt_alt(insn_string)\t\t\t\t\t\\\n\t_paravirt_alt(insn_string, \"%c[paravirt_typenum]\")\n\n \n#define NATIVE_LABEL(a,x,b) \"\\n\\t.globl \" a #x \"_\" #b \"\\n\" a #x \"_\" #b \":\\n\\t\"\n\nunsigned int paravirt_patch(u8 type, void *insn_buff, unsigned long addr, unsigned int len);\n\nint paravirt_disable_iospace(void);\n\n \n#define PARAVIRT_CALL\t\t\t\t\t\\\n\tANNOTATE_RETPOLINE_SAFE\t\t\t\t\\\n\t\"call *%[paravirt_opptr];\"\n\n \n#ifdef CONFIG_X86_32\n#define PVOP_CALL_ARGS\t\t\t\t\t\t\t\\\n\tunsigned long __eax = __eax, __edx = __edx, __ecx = __ecx;\n\n#define PVOP_CALL_ARG1(x)\t\t\"a\" ((unsigned long)(x))\n#define PVOP_CALL_ARG2(x)\t\t\"d\" ((unsigned long)(x))\n#define PVOP_CALL_ARG3(x)\t\t\"c\" ((unsigned long)(x))\n\n#define PVOP_VCALL_CLOBBERS\t\t\"=a\" (__eax), \"=d\" (__edx),\t\\\n\t\t\t\t\t\"=c\" (__ecx)\n#define PVOP_CALL_CLOBBERS\t\tPVOP_VCALL_CLOBBERS\n\n#define PVOP_VCALLEE_CLOBBERS\t\t\"=a\" (__eax), \"=d\" (__edx)\n#define PVOP_CALLEE_CLOBBERS\t\tPVOP_VCALLEE_CLOBBERS\n\n#define EXTRA_CLOBBERS\n#define VEXTRA_CLOBBERS\n#else   \n \n#define PVOP_CALL_ARGS\t\t\t\t\t\t\\\n\tunsigned long __edi = __edi, __esi = __esi,\t\t\\\n\t\t__edx = __edx, __ecx = __ecx, __eax = __eax;\n\n#define PVOP_CALL_ARG1(x)\t\t\"D\" ((unsigned long)(x))\n#define PVOP_CALL_ARG2(x)\t\t\"S\" ((unsigned long)(x))\n#define PVOP_CALL_ARG3(x)\t\t\"d\" ((unsigned long)(x))\n#define PVOP_CALL_ARG4(x)\t\t\"c\" ((unsigned long)(x))\n\n#define PVOP_VCALL_CLOBBERS\t\"=D\" (__edi),\t\t\t\t\\\n\t\t\t\t\"=S\" (__esi), \"=d\" (__edx),\t\t\\\n\t\t\t\t\"=c\" (__ecx)\n#define PVOP_CALL_CLOBBERS\tPVOP_VCALL_CLOBBERS, \"=a\" (__eax)\n\n \n#ifdef CONFIG_ZERO_CALL_USED_REGS\n#define PVOP_VCALLEE_CLOBBERS\t\"=a\" (__eax), PVOP_VCALL_CLOBBERS\n#else\n#define PVOP_VCALLEE_CLOBBERS\t\"=a\" (__eax)\n#endif\n#define PVOP_CALLEE_CLOBBERS\tPVOP_VCALLEE_CLOBBERS\n\n#define EXTRA_CLOBBERS\t , \"r8\", \"r9\", \"r10\", \"r11\"\n#define VEXTRA_CLOBBERS\t , \"rax\", \"r8\", \"r9\", \"r10\", \"r11\"\n#endif\t \n\n#ifdef CONFIG_PARAVIRT_DEBUG\n#define PVOP_TEST_NULL(op)\tBUG_ON(pv_ops.op == NULL)\n#else\n#define PVOP_TEST_NULL(op)\t((void)pv_ops.op)\n#endif\n\n#define PVOP_RETVAL(rettype)\t\t\t\t\t\t\\\n\t({\tunsigned long __mask = ~0UL;\t\t\t\t\\\n\t\tBUILD_BUG_ON(sizeof(rettype) > sizeof(unsigned long));\t\\\n\t\tswitch (sizeof(rettype)) {\t\t\t\t\\\n\t\tcase 1: __mask =       0xffUL; break;\t\t\t\\\n\t\tcase 2: __mask =     0xffffUL; break;\t\t\t\\\n\t\tcase 4: __mask = 0xffffffffUL; break;\t\t\t\\\n\t\tdefault: break;\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t\t__mask & __eax;\t\t\t\t\t\t\\\n\t})\n\n\n#define ____PVOP_CALL(ret, op, call_clbr, extra_clbr, ...)\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tPVOP_CALL_ARGS;\t\t\t\t\t\t\\\n\t\tPVOP_TEST_NULL(op);\t\t\t\t\t\\\n\t\tasm volatile(paravirt_alt(PARAVIRT_CALL)\t\t\\\n\t\t\t     : call_clbr, ASM_CALL_CONSTRAINT\t\t\\\n\t\t\t     : paravirt_type(op),\t\t\t\\\n\t\t\t       ##__VA_ARGS__\t\t\t\t\\\n\t\t\t     : \"memory\", \"cc\" extra_clbr);\t\t\\\n\t\tret;\t\t\t\t\t\t\t\\\n\t})\n\n#define ____PVOP_ALT_CALL(ret, op, alt, cond, call_clbr,\t\t\\\n\t\t\t  extra_clbr, ...)\t\t\t\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tPVOP_CALL_ARGS;\t\t\t\t\t\t\\\n\t\tPVOP_TEST_NULL(op);\t\t\t\t\t\\\n\t\tasm volatile(ALTERNATIVE(paravirt_alt(PARAVIRT_CALL),\t\\\n\t\t\t\t\t alt, cond)\t\t\t\\\n\t\t\t     : call_clbr, ASM_CALL_CONSTRAINT\t\t\\\n\t\t\t     : paravirt_type(op),\t\t\t\\\n\t\t\t       ##__VA_ARGS__\t\t\t\t\\\n\t\t\t     : \"memory\", \"cc\" extra_clbr);\t\t\\\n\t\tret;\t\t\t\t\t\t\t\\\n\t})\n\n#define __PVOP_CALL(rettype, op, ...)\t\t\t\t\t\\\n\t____PVOP_CALL(PVOP_RETVAL(rettype), op,\t\t\t\t\\\n\t\t      PVOP_CALL_CLOBBERS, EXTRA_CLOBBERS, ##__VA_ARGS__)\n\n#define __PVOP_ALT_CALL(rettype, op, alt, cond, ...)\t\t\t\\\n\t____PVOP_ALT_CALL(PVOP_RETVAL(rettype), op, alt, cond,\t\t\\\n\t\t\t  PVOP_CALL_CLOBBERS, EXTRA_CLOBBERS,\t\t\\\n\t\t\t  ##__VA_ARGS__)\n\n#define __PVOP_CALLEESAVE(rettype, op, ...)\t\t\t\t\\\n\t____PVOP_CALL(PVOP_RETVAL(rettype), op.func,\t\t\t\\\n\t\t      PVOP_CALLEE_CLOBBERS, , ##__VA_ARGS__)\n\n#define __PVOP_ALT_CALLEESAVE(rettype, op, alt, cond, ...)\t\t\\\n\t____PVOP_ALT_CALL(PVOP_RETVAL(rettype), op.func, alt, cond,\t\\\n\t\t\t  PVOP_CALLEE_CLOBBERS, , ##__VA_ARGS__)\n\n\n#define __PVOP_VCALL(op, ...)\t\t\t\t\t\t\\\n\t(void)____PVOP_CALL(, op, PVOP_VCALL_CLOBBERS,\t\t\t\\\n\t\t       VEXTRA_CLOBBERS, ##__VA_ARGS__)\n\n#define __PVOP_ALT_VCALL(op, alt, cond, ...)\t\t\t\t\\\n\t(void)____PVOP_ALT_CALL(, op, alt, cond,\t\t\t\\\n\t\t\t\tPVOP_VCALL_CLOBBERS, VEXTRA_CLOBBERS,\t\\\n\t\t\t\t##__VA_ARGS__)\n\n#define __PVOP_VCALLEESAVE(op, ...)\t\t\t\t\t\\\n\t(void)____PVOP_CALL(, op.func,\t\t\t\t\t\\\n\t\t\t    PVOP_VCALLEE_CLOBBERS, , ##__VA_ARGS__)\n\n#define __PVOP_ALT_VCALLEESAVE(op, alt, cond, ...)\t\t\t\\\n\t(void)____PVOP_ALT_CALL(, op.func, alt, cond,\t\t\t\\\n\t\t\t\tPVOP_VCALLEE_CLOBBERS, , ##__VA_ARGS__)\n\n\n#define PVOP_CALL0(rettype, op)\t\t\t\t\t\t\\\n\t__PVOP_CALL(rettype, op)\n#define PVOP_VCALL0(op)\t\t\t\t\t\t\t\\\n\t__PVOP_VCALL(op)\n#define PVOP_ALT_CALL0(rettype, op, alt, cond)\t\t\t\t\\\n\t__PVOP_ALT_CALL(rettype, op, alt, cond)\n#define PVOP_ALT_VCALL0(op, alt, cond)\t\t\t\t\t\\\n\t__PVOP_ALT_VCALL(op, alt, cond)\n\n#define PVOP_CALLEE0(rettype, op)\t\t\t\t\t\\\n\t__PVOP_CALLEESAVE(rettype, op)\n#define PVOP_VCALLEE0(op)\t\t\t\t\t\t\\\n\t__PVOP_VCALLEESAVE(op)\n#define PVOP_ALT_CALLEE0(rettype, op, alt, cond)\t\t\t\\\n\t__PVOP_ALT_CALLEESAVE(rettype, op, alt, cond)\n#define PVOP_ALT_VCALLEE0(op, alt, cond)\t\t\t\t\\\n\t__PVOP_ALT_VCALLEESAVE(op, alt, cond)\n\n\n#define PVOP_CALL1(rettype, op, arg1)\t\t\t\t\t\\\n\t__PVOP_CALL(rettype, op, PVOP_CALL_ARG1(arg1))\n#define PVOP_VCALL1(op, arg1)\t\t\t\t\t\t\\\n\t__PVOP_VCALL(op, PVOP_CALL_ARG1(arg1))\n#define PVOP_ALT_VCALL1(op, arg1, alt, cond)\t\t\t\t\\\n\t__PVOP_ALT_VCALL(op, alt, cond, PVOP_CALL_ARG1(arg1))\n\n#define PVOP_CALLEE1(rettype, op, arg1)\t\t\t\t\t\\\n\t__PVOP_CALLEESAVE(rettype, op, PVOP_CALL_ARG1(arg1))\n#define PVOP_VCALLEE1(op, arg1)\t\t\t\t\t\t\\\n\t__PVOP_VCALLEESAVE(op, PVOP_CALL_ARG1(arg1))\n#define PVOP_ALT_CALLEE1(rettype, op, arg1, alt, cond)\t\t\t\\\n\t__PVOP_ALT_CALLEESAVE(rettype, op, alt, cond, PVOP_CALL_ARG1(arg1))\n#define PVOP_ALT_VCALLEE1(op, arg1, alt, cond)\t\t\t\t\\\n\t__PVOP_ALT_VCALLEESAVE(op, alt, cond, PVOP_CALL_ARG1(arg1))\n\n\n#define PVOP_CALL2(rettype, op, arg1, arg2)\t\t\t\t\\\n\t__PVOP_CALL(rettype, op, PVOP_CALL_ARG1(arg1), PVOP_CALL_ARG2(arg2))\n#define PVOP_VCALL2(op, arg1, arg2)\t\t\t\t\t\\\n\t__PVOP_VCALL(op, PVOP_CALL_ARG1(arg1), PVOP_CALL_ARG2(arg2))\n\n#define PVOP_CALL3(rettype, op, arg1, arg2, arg3)\t\t\t\\\n\t__PVOP_CALL(rettype, op, PVOP_CALL_ARG1(arg1),\t\t\t\\\n\t\t    PVOP_CALL_ARG2(arg2), PVOP_CALL_ARG3(arg3))\n#define PVOP_VCALL3(op, arg1, arg2, arg3)\t\t\t\t\\\n\t__PVOP_VCALL(op, PVOP_CALL_ARG1(arg1),\t\t\t\t\\\n\t\t     PVOP_CALL_ARG2(arg2), PVOP_CALL_ARG3(arg3))\n\n#define PVOP_CALL4(rettype, op, arg1, arg2, arg3, arg4)\t\t\t\\\n\t__PVOP_CALL(rettype, op,\t\t\t\t\t\\\n\t\t    PVOP_CALL_ARG1(arg1), PVOP_CALL_ARG2(arg2),\t\t\\\n\t\t    PVOP_CALL_ARG3(arg3), PVOP_CALL_ARG4(arg4))\n#define PVOP_VCALL4(op, arg1, arg2, arg3, arg4)\t\t\t\t\\\n\t__PVOP_VCALL(op, PVOP_CALL_ARG1(arg1), PVOP_CALL_ARG2(arg2),\t\\\n\t\t     PVOP_CALL_ARG3(arg3), PVOP_CALL_ARG4(arg4))\n\nvoid _paravirt_nop(void);\nvoid paravirt_BUG(void);\nunsigned long paravirt_ret0(void);\n#ifdef CONFIG_PARAVIRT_XXL\nu64 _paravirt_ident_64(u64);\nunsigned long pv_native_save_fl(void);\nvoid pv_native_irq_disable(void);\nvoid pv_native_irq_enable(void);\nunsigned long pv_native_read_cr2(void);\n#endif\n\n#define paravirt_nop\t((void *)_paravirt_nop)\n\nextern struct paravirt_patch_site __parainstructions[],\n\t__parainstructions_end[];\n\n#endif\t \n#endif   \n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}