{
  "module_name": "amd_nb.h",
  "hash_id": "8f44cd80ce2a16abf37ce27f0cce8069cdd5c88bf7c24cb5cb0721a335394060",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/amd_nb.h",
  "human_readable_source": " \n#ifndef _ASM_X86_AMD_NB_H\n#define _ASM_X86_AMD_NB_H\n\n#include <linux/ioport.h>\n#include <linux/pci.h>\n#include <linux/refcount.h>\n\nstruct amd_nb_bus_dev_range {\n\tu8 bus;\n\tu8 dev_base;\n\tu8 dev_limit;\n};\n\nextern const struct amd_nb_bus_dev_range amd_nb_bus_dev_ranges[];\n\nextern bool early_is_amd_nb(u32 value);\nextern struct resource *amd_get_mmconfig_range(struct resource *res);\nextern void amd_flush_garts(void);\nextern int amd_numa_init(void);\nextern int amd_get_subcaches(int);\nextern int amd_set_subcaches(int, unsigned long);\n\nextern int amd_smn_read(u16 node, u32 address, u32 *value);\nextern int amd_smn_write(u16 node, u32 address, u32 value);\n\nstruct amd_l3_cache {\n\tunsigned indices;\n\tu8\t subcaches[4];\n};\n\nstruct threshold_block {\n\tunsigned int\t block;\t\t\t \n\tunsigned int\t bank;\t\t\t \n\tunsigned int\t cpu;\t\t\t \n\tu32\t\t address;\t\t \n\tu16\t\t interrupt_enable;\t \n\tbool\t\t interrupt_capable;\t \n\n\tu16\t\t threshold_limit;\t \n\n\tstruct kobject\t kobj;\t\t\t \n\tstruct list_head miscj;\t\t\t \n};\n\nstruct threshold_bank {\n\tstruct kobject\t\t*kobj;\n\tstruct threshold_block\t*blocks;\n\n\t \n\trefcount_t\t\tcpus;\n\tunsigned int\t\tshared;\n};\n\nstruct amd_northbridge {\n\tstruct pci_dev *root;\n\tstruct pci_dev *misc;\n\tstruct pci_dev *link;\n\tstruct amd_l3_cache l3_cache;\n\tstruct threshold_bank *bank4;\n};\n\nstruct amd_northbridge_info {\n\tu16 num;\n\tu64 flags;\n\tstruct amd_northbridge *nb;\n};\n\n#define AMD_NB_GART\t\t\tBIT(0)\n#define AMD_NB_L3_INDEX_DISABLE\t\tBIT(1)\n#define AMD_NB_L3_PARTITIONING\t\tBIT(2)\n\n#ifdef CONFIG_AMD_NB\n\nu16 amd_nb_num(void);\nbool amd_nb_has_feature(unsigned int feature);\nstruct amd_northbridge *node_to_amd_nb(int node);\n\nstatic inline u16 amd_pci_dev_to_node_id(struct pci_dev *pdev)\n{\n\tstruct pci_dev *misc;\n\tint i;\n\n\tfor (i = 0; i != amd_nb_num(); i++) {\n\t\tmisc = node_to_amd_nb(i)->misc;\n\n\t\tif (pci_domain_nr(misc->bus) == pci_domain_nr(pdev->bus) &&\n\t\t    PCI_SLOT(misc->devfn) == PCI_SLOT(pdev->devfn))\n\t\t\treturn i;\n\t}\n\n\tWARN(1, \"Unable to find AMD Northbridge id for %s\\n\", pci_name(pdev));\n\treturn 0;\n}\n\nstatic inline bool amd_gart_present(void)\n{\n\tif (boot_cpu_data.x86_vendor != X86_VENDOR_AMD)\n\t\treturn false;\n\n\t \n\tif (boot_cpu_data.x86 == 0xf || boot_cpu_data.x86 == 0x10 ||\n\t    (boot_cpu_data.x86 == 0x15 && boot_cpu_data.x86_model < 0x10))\n\t\treturn true;\n\n\treturn false;\n}\n\n#else\n\n#define amd_nb_num(x)\t\t0\n#define amd_nb_has_feature(x)\tfalse\n#define node_to_amd_nb(x)\tNULL\n#define amd_gart_present(x)\tfalse\n\n#endif\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}