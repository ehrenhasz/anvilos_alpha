{
  "module_name": "cpufeature.h",
  "hash_id": "17ca61bfec6e53fbd7418cc446680effabae9492cbbc4ed29523faffa9483072",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/cpufeature.h",
  "human_readable_source": " \n#ifndef _ASM_X86_CPUFEATURE_H\n#define _ASM_X86_CPUFEATURE_H\n\n#include <asm/processor.h>\n\n#if defined(__KERNEL__) && !defined(__ASSEMBLY__)\n\n#include <asm/asm.h>\n#include <linux/bitops.h>\n#include <asm/alternative.h>\n\nenum cpuid_leafs\n{\n\tCPUID_1_EDX\t\t= 0,\n\tCPUID_8000_0001_EDX,\n\tCPUID_8086_0001_EDX,\n\tCPUID_LNX_1,\n\tCPUID_1_ECX,\n\tCPUID_C000_0001_EDX,\n\tCPUID_8000_0001_ECX,\n\tCPUID_LNX_2,\n\tCPUID_LNX_3,\n\tCPUID_7_0_EBX,\n\tCPUID_D_1_EAX,\n\tCPUID_LNX_4,\n\tCPUID_7_1_EAX,\n\tCPUID_8000_0008_EBX,\n\tCPUID_6_EAX,\n\tCPUID_8000_000A_EDX,\n\tCPUID_7_ECX,\n\tCPUID_8000_0007_EBX,\n\tCPUID_7_EDX,\n\tCPUID_8000_001F_EAX,\n\tCPUID_8000_0021_EAX,\n};\n\n#define X86_CAP_FMT_NUM \"%d:%d\"\n#define x86_cap_flag_num(flag) ((flag) >> 5), ((flag) & 31)\n\nextern const char * const x86_cap_flags[NCAPINTS*32];\nextern const char * const x86_power_flags[32];\n#define X86_CAP_FMT \"%s\"\n#define x86_cap_flag(flag) x86_cap_flags[flag]\n\n \nextern const char * const x86_bug_flags[NBUGINTS*32];\n\n#define test_cpu_cap(c, bit)\t\t\t\t\t\t\\\n\t arch_test_bit(bit, (unsigned long *)((c)->x86_capability))\n\n \n#define CHECK_BIT_IN_MASK_WORD(maskname, word, bit)\t\\\n\t(((bit)>>5)==(word) && (1UL<<((bit)&31) & maskname##word ))\n\n \n#define REQUIRED_MASK_BIT_SET(feature_bit)\t\t\\\n\t ( CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  0, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  1, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  2, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  3, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  4, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  5, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  6, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  7, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  8, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK,  9, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 10, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 11, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 12, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 13, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 14, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 15, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 16, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 17, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 18, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 19, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(REQUIRED_MASK, 20, feature_bit) ||\t\\\n\t   REQUIRED_MASK_CHECK\t\t\t\t\t  ||\t\\\n\t   BUILD_BUG_ON_ZERO(NCAPINTS != 21))\n\n#define DISABLED_MASK_BIT_SET(feature_bit)\t\t\t\t\\\n\t ( CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  0, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  1, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  2, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  3, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  4, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  5, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  6, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  7, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  8, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK,  9, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 10, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 11, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 12, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 13, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 14, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 15, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 16, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 17, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 18, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 19, feature_bit) ||\t\\\n\t   CHECK_BIT_IN_MASK_WORD(DISABLED_MASK, 20, feature_bit) ||\t\\\n\t   DISABLED_MASK_CHECK\t\t\t\t\t  ||\t\\\n\t   BUILD_BUG_ON_ZERO(NCAPINTS != 21))\n\n#define cpu_has(c, bit)\t\t\t\t\t\t\t\\\n\t(__builtin_constant_p(bit) && REQUIRED_MASK_BIT_SET(bit) ? 1 :\t\\\n\t test_cpu_cap(c, bit))\n\n#define this_cpu_has(bit)\t\t\t\t\t\t\\\n\t(__builtin_constant_p(bit) && REQUIRED_MASK_BIT_SET(bit) ? 1 :\t\\\n\t x86_this_cpu_test_bit(bit,\t\t\t\t\t\\\n\t\t(unsigned long __percpu *)&cpu_info.x86_capability))\n\n \n#define cpu_feature_enabled(bit)\t\\\n\t(__builtin_constant_p(bit) && DISABLED_MASK_BIT_SET(bit) ? 0 : static_cpu_has(bit))\n\n#define boot_cpu_has(bit)\tcpu_has(&boot_cpu_data, bit)\n\n#define set_cpu_cap(c, bit)\tset_bit(bit, (unsigned long *)((c)->x86_capability))\n\nextern void setup_clear_cpu_cap(unsigned int bit);\nextern void clear_cpu_cap(struct cpuinfo_x86 *c, unsigned int bit);\n\n#define setup_force_cpu_cap(bit) do { \\\n\tset_cpu_cap(&boot_cpu_data, bit);\t\\\n\tset_bit(bit, (unsigned long *)cpu_caps_set);\t\\\n} while (0)\n\n#define setup_force_cpu_bug(bit) setup_force_cpu_cap(bit)\n\n \nstatic __always_inline bool _static_cpu_has(u16 bit)\n{\n\tasm_volatile_goto(\n\t\tALTERNATIVE_TERNARY(\"jmp 6f\", %P[feature], \"\", \"jmp %l[t_no]\")\n\t\t\".pushsection .altinstr_aux,\\\"ax\\\"\\n\"\n\t\t\"6:\\n\"\n\t\t\" testb %[bitnum],\" _ASM_RIP(%P[cap_byte]) \"\\n\"\n\t\t\" jnz %l[t_yes]\\n\"\n\t\t\" jmp %l[t_no]\\n\"\n\t\t\".popsection\\n\"\n\t\t : : [feature]  \"i\" (bit),\n\t\t     [bitnum]   \"i\" (1 << (bit & 7)),\n\t\t     [cap_byte] \"i\" (&((const char *)boot_cpu_data.x86_capability)[bit >> 3])\n\t\t : : t_yes, t_no);\nt_yes:\n\treturn true;\nt_no:\n\treturn false;\n}\n\n#define static_cpu_has(bit)\t\t\t\t\t\\\n(\t\t\t\t\t\t\t\t\\\n\t__builtin_constant_p(boot_cpu_has(bit)) ?\t\t\\\n\t\tboot_cpu_has(bit) :\t\t\t\t\\\n\t\t_static_cpu_has(bit)\t\t\t\t\\\n)\n\n#define cpu_has_bug(c, bit)\t\tcpu_has(c, (bit))\n#define set_cpu_bug(c, bit)\t\tset_cpu_cap(c, (bit))\n#define clear_cpu_bug(c, bit)\t\tclear_cpu_cap(c, (bit))\n\n#define static_cpu_has_bug(bit)\t\tstatic_cpu_has((bit))\n#define boot_cpu_has_bug(bit)\t\tcpu_has_bug(&boot_cpu_data, (bit))\n#define boot_cpu_set_bug(bit)\t\tset_cpu_cap(&boot_cpu_data, (bit))\n\n#define MAX_CPU_FEATURES\t\t(NCAPINTS * 32)\n#define cpu_have_feature\t\tboot_cpu_has\n\n#define CPU_FEATURE_TYPEFMT\t\t\"x86,ven%04Xfam%04Xmod%04X\"\n#define CPU_FEATURE_TYPEVAL\t\tboot_cpu_data.x86_vendor, boot_cpu_data.x86, \\\n\t\t\t\t\tboot_cpu_data.x86_model\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}