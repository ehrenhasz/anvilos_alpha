{
  "module_name": "kprobes.h",
  "hash_id": "128c6a5f3f000de2b7246cb7ca54cdd522beda9b43a205f66fe25c03c1e41824",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/include/asm/kprobes.h",
  "human_readable_source": " \n#ifndef _ASM_X86_KPROBES_H\n#define _ASM_X86_KPROBES_H\n \n\n#include <asm-generic/kprobes.h>\n\n#ifdef CONFIG_KPROBES\n#include <linux/types.h>\n#include <linux/ptrace.h>\n#include <linux/percpu.h>\n#include <asm/text-patching.h>\n#include <asm/insn.h>\n\n#define  __ARCH_WANT_KPROBES_INSN_SLOT\n\nstruct pt_regs;\nstruct kprobe;\n\ntypedef u8 kprobe_opcode_t;\n\n#define MAX_STACK_SIZE 64\n#define CUR_STACK_SIZE(ADDR) \\\n\t(current_top_of_stack() - (unsigned long)(ADDR))\n#define MIN_STACK_SIZE(ADDR)\t\t\t\t\\\n\t(MAX_STACK_SIZE < CUR_STACK_SIZE(ADDR) ?\t\\\n\t MAX_STACK_SIZE : CUR_STACK_SIZE(ADDR))\n\n#define flush_insn_slot(p)\tdo { } while (0)\n\n \nextern __visible kprobe_opcode_t optprobe_template_entry[];\nextern __visible kprobe_opcode_t optprobe_template_clac[];\nextern __visible kprobe_opcode_t optprobe_template_val[];\nextern __visible kprobe_opcode_t optprobe_template_call[];\nextern __visible kprobe_opcode_t optprobe_template_end[];\n#define MAX_OPTIMIZED_LENGTH (MAX_INSN_SIZE + DISP32_SIZE)\n#define MAX_OPTINSN_SIZE \t\t\t\t\\\n\t(((unsigned long)optprobe_template_end -\t\\\n\t  (unsigned long)optprobe_template_entry) +\t\\\n\t MAX_OPTIMIZED_LENGTH + JMP32_INSN_SIZE)\n\nextern const int kretprobe_blacklist_size;\n\nvoid arch_remove_kprobe(struct kprobe *p);\n\n \nstruct arch_specific_insn {\n\t \n\tkprobe_opcode_t *insn;\n\t \n\tunsigned boostable:1;\n\tunsigned char size;\t \n\tunion {\n\t\tunsigned char opcode;\n\t\tstruct {\n\t\t\tunsigned char type;\n\t\t} jcc;\n\t\tstruct {\n\t\t\tunsigned char type;\n\t\t\tunsigned char asize;\n\t\t} loop;\n\t\tstruct {\n\t\t\tunsigned char reg;\n\t\t} indirect;\n\t};\n\ts32 rel32;\t \n\tvoid (*emulate_op)(struct kprobe *p, struct pt_regs *regs);\n\t \n\tint tp_len;\n};\n\nstruct arch_optimized_insn {\n\t \n\tkprobe_opcode_t copied_insn[DISP32_SIZE];\n\t \n\tkprobe_opcode_t *insn;\n\t \n\tsize_t size;\n};\n\n \nstatic inline int arch_prepared_optinsn(struct arch_optimized_insn *optinsn)\n{\n\treturn optinsn->size;\n}\n\nstruct prev_kprobe {\n\tstruct kprobe *kp;\n\tunsigned long status;\n\tunsigned long old_flags;\n\tunsigned long saved_flags;\n};\n\n \nstruct kprobe_ctlblk {\n\tunsigned long kprobe_status;\n\tunsigned long kprobe_old_flags;\n\tunsigned long kprobe_saved_flags;\n\tstruct prev_kprobe prev_kprobe;\n};\n\nextern int kprobe_fault_handler(struct pt_regs *regs, int trapnr);\nextern int kprobe_exceptions_notify(struct notifier_block *self,\n\t\t\t\t    unsigned long val, void *data);\nextern int kprobe_int3_handler(struct pt_regs *regs);\n\n#else\n\nstatic inline int kprobe_debug_handler(struct pt_regs *regs) { return 0; }\n\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}