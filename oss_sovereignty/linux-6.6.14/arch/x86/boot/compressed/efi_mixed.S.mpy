{
  "module_name": "efi_mixed.S",
  "hash_id": "9c71c114b54b91f5c0860e5008323f52a8faf5bf9bf24983a145332a13289f1d",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/boot/compressed/efi_mixed.S",
  "human_readable_source": " \n \n\n#include <linux/linkage.h>\n#include <asm/msr.h>\n#include <asm/page_types.h>\n#include <asm/processor-flags.h>\n#include <asm/segment.h>\n\n\t.code64\n\t.text\n \nSYM_FUNC_START(startup_64_mixed_mode)\n\tlea\tefi32_boot_args(%rip), %rdx\n\tmov\t0(%rdx), %edi\n\tmov\t4(%rdx), %esi\n#ifdef CONFIG_EFI_HANDOVER_PROTOCOL\n\tmov\t8(%rdx), %edx\t\t \n\ttest\t%edx, %edx\n\tjnz\tefi_stub_entry\n#endif\n\t \n\tsub\t$40, %rsp\n\tmov\t%rdi, %rcx\t\t \n\tmov\t%rsi, %rdx\n\tjmp\tefi_pe_entry\nSYM_FUNC_END(startup_64_mixed_mode)\n\nSYM_FUNC_START(__efi64_thunk)\n\tpush\t%rbp\n\tpush\t%rbx\n\n\tmovl\t%ds, %eax\n\tpush\t%rax\n\tmovl\t%es, %eax\n\tpush\t%rax\n\tmovl\t%ss, %eax\n\tpush\t%rax\n\n\t \n\tmovq\t0x30(%rsp), %rbp\n\tmovq\t0x38(%rsp), %rbx\n\tmovq\t0x40(%rsp), %rax\n\n\t \n\tsubq\t$64, %rsp\n\tmovl\t%esi, 0x0(%rsp)\n\tmovl\t%edx, 0x4(%rsp)\n\tmovl\t%ecx, 0x8(%rsp)\n\tmovl\t%r8d, 0xc(%rsp)\n\tmovl\t%r9d, 0x10(%rsp)\n\tmovl\t%ebp, 0x14(%rsp)\n\tmovl\t%ebx, 0x18(%rsp)\n\tmovl\t%eax, 0x1c(%rsp)\n\n\tleaq\t0x20(%rsp), %rbx\n\tsgdt\t(%rbx)\n\tsidt\t16(%rbx)\n\n\tleaq\t1f(%rip), %rbp\n\n\t \n\tlidt\tefi32_boot_idt(%rip)\n\tlgdt\tefi32_boot_gdt(%rip)\n\n\tmovzwl\tefi32_boot_ds(%rip), %edx\n\tmovzwq\tefi32_boot_cs(%rip), %rax\n\tpushq\t%rax\n\tleaq\tefi_enter32(%rip), %rax\n\tpushq\t%rax\n\tlretq\n\n1:\taddq\t$64, %rsp\n\tmovq\t%rdi, %rax\n\n\tpop\t%rbx\n\tmovl\t%ebx, %ss\n\tpop\t%rbx\n\tmovl\t%ebx, %es\n\tpop\t%rbx\n\tmovl\t%ebx, %ds\n\t \n\txorl\t%ebx, %ebx\n\tmovl\t%ebx, %fs\n\tmovl\t%ebx, %gs\n\n\tpop\t%rbx\n\tpop\t%rbp\n\tRET\nSYM_FUNC_END(__efi64_thunk)\n\n\t.code32\n#ifdef CONFIG_EFI_HANDOVER_PROTOCOL\nSYM_FUNC_START(efi32_stub_entry)\n\tcall\t1f\n1:\tpopl\t%ecx\n\n\t \n\txorl\t%eax, %eax\n\tleal\t(_bss - 1b)(%ecx), %edi\n\tleal\t(_ebss - 1b)(%ecx), %ecx\n\tsubl\t%edi, %ecx\n\tshrl\t$2, %ecx\n\tcld\n\trep\tstosl\n\n\tadd\t$0x4, %esp\t\t \n\tpopl\t%ecx\n\tpopl\t%edx\n\tpopl\t%esi\n\tjmp\tefi32_entry\nSYM_FUNC_END(efi32_stub_entry)\n#endif\n\n \nSYM_FUNC_START_LOCAL(efi_enter32)\n\t \n\tmovl\t%edx, %ds\n\tmovl\t%edx, %es\n\tmovl\t%edx, %fs\n\tmovl\t%edx, %gs\n\tmovl\t%edx, %ss\n\n\t \n\tmovl\t%cr3, %eax\n\tmovl\t%eax, %cr3\n\n\t \n\tmovl\t%cr0, %eax\n\tbtrl\t$X86_CR0_PG_BIT, %eax\n\tmovl\t%eax, %cr0\n\n\t \n\tmovl\t$MSR_EFER, %ecx\n\trdmsr\n\tbtrl\t$_EFER_LME, %eax\n\twrmsr\n\n\tcall\t*%edi\n\n\t \n\tmovl\t%eax, %edi\n\n\t \n\tcli\n\n\tlidtl\t16(%ebx)\n\tlgdtl\t(%ebx)\n\n\tmovl\t%cr4, %eax\n\tbtsl\t$(X86_CR4_PAE_BIT), %eax\n\tmovl\t%eax, %cr4\n\n\tmovl\t%cr3, %eax\n\tmovl\t%eax, %cr3\n\n\tmovl\t$MSR_EFER, %ecx\n\trdmsr\n\tbtsl\t$_EFER_LME, %eax\n\twrmsr\n\n\txorl\t%eax, %eax\n\tlldt\t%ax\n\n\tpushl\t$__KERNEL_CS\n\tpushl\t%ebp\n\n\t \n\tmovl\t%cr0, %eax\n\tbtsl\t$X86_CR0_PG_BIT, %eax\n\tmovl\t%eax, %cr0\n\tlret\nSYM_FUNC_END(efi_enter32)\n\n \nSYM_FUNC_START_LOCAL(efi32_entry)\n\tcall\t1f\n1:\tpop\t%ebx\n\n\t \n\tsgdtl\t(efi32_boot_gdt - 1b)(%ebx)\n\tmovw\t%cs, (efi32_boot_cs - 1b)(%ebx)\n\tmovw\t%ds, (efi32_boot_ds - 1b)(%ebx)\n\n\t \n\tsidtl\t(efi32_boot_idt - 1b)(%ebx)\n\n\t \n\tleal\t(efi32_boot_args - 1b)(%ebx), %ebx\n\tmovl\t%ecx, 0(%ebx)\n\tmovl\t%edx, 4(%ebx)\n\tmovl\t%esi, 8(%ebx)\n\tmovb\t$0x0, 12(%ebx)           \n\n\t \n\tmovl\t%cr0, %eax\n\tbtrl\t$X86_CR0_PG_BIT, %eax\n\tmovl\t%eax, %cr0\n\n\tjmp\tstartup_32\nSYM_FUNC_END(efi32_entry)\n\n \nSYM_FUNC_START(efi32_pe_entry)\n\tpushl\t%ebp\n\tmovl\t%esp, %ebp\n\tpushl\t%ebx\t\t\t\t \n\tpushl\t%edi\n\n\tcall\tverify_cpu\t\t\t \n\ttestl\t%eax, %eax\n\tmovl\t$0x80000003, %eax\t\t \n\tjnz\t2f\n\n\tmovl\t8(%ebp), %ecx\t\t\t \n\tmovl\t12(%ebp), %edx\t\t\t \n\txorl\t%esi, %esi\n\tjmp\tefi32_entry\t\t\t \n\t\t\t\t\t\t \n\n2:\tpopl\t%edi\t\t\t\t \n\tpopl\t%ebx\n\tleave\n\tRET\nSYM_FUNC_END(efi32_pe_entry)\n\n#ifdef CONFIG_EFI_HANDOVER_PROTOCOL\n\t.org\tefi32_stub_entry + 0x200\n\t.code64\nSYM_FUNC_START_NOALIGN(efi64_stub_entry)\n\tjmp\tefi_handover_entry\nSYM_FUNC_END(efi64_stub_entry)\n#endif\n\n\t.data\n\t.balign\t8\nSYM_DATA_START_LOCAL(efi32_boot_gdt)\n\t.word\t0\n\t.quad\t0\nSYM_DATA_END(efi32_boot_gdt)\n\nSYM_DATA_START_LOCAL(efi32_boot_idt)\n\t.word\t0\n\t.quad\t0\nSYM_DATA_END(efi32_boot_idt)\n\nSYM_DATA_LOCAL(efi32_boot_cs, .word 0)\nSYM_DATA_LOCAL(efi32_boot_ds, .word 0)\nSYM_DATA_LOCAL(efi32_boot_args, .long 0, 0, 0)\nSYM_DATA(efi_is64, .byte 1)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}