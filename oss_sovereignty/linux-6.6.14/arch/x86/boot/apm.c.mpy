{
  "module_name": "apm.c",
  "hash_id": "312d019407368e6e8c8b68f3a2ea19e87a1bacf1203aa007799201ca375cc7f8",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/boot/apm.c",
  "human_readable_source": "\n \n\n \n\n#include \"boot.h\"\n\nint query_apm_bios(void)\n{\n\tstruct biosregs ireg, oreg;\n\n\t \n\tinitregs(&ireg);\n\tireg.ah = 0x53;\n\tintcall(0x15, &ireg, &oreg);\n\n\tif (oreg.flags & X86_EFLAGS_CF)\n\t\treturn -1;\t\t \n\n\tif (oreg.bx != 0x504d)\t\t \n\t\treturn -1;\n\n\tif (!(oreg.cx & 0x02))\t\t \n\t\treturn -1;\n\n\t \n\tireg.al = 0x04;\n\tintcall(0x15, &ireg, NULL);\n\n\t \n\tireg.al = 0x03;\n\tintcall(0x15, &ireg, &oreg);\n\n\tboot_params.apm_bios_info.cseg        = oreg.ax;\n\tboot_params.apm_bios_info.offset      = oreg.ebx;\n\tboot_params.apm_bios_info.cseg_16     = oreg.cx;\n\tboot_params.apm_bios_info.dseg        = oreg.dx;\n\tboot_params.apm_bios_info.cseg_len    = oreg.si;\n\tboot_params.apm_bios_info.cseg_16_len = oreg.hsi;\n\tboot_params.apm_bios_info.dseg_len    = oreg.di;\n\n\tif (oreg.flags & X86_EFLAGS_CF)\n\t\treturn -1;\n\n\t \n\n\tireg.al = 0x00;\n\tintcall(0x15, &ireg, &oreg);\n\n\tif ((oreg.eflags & X86_EFLAGS_CF) || oreg.bx != 0x504d) {\n\t\t \n\t\tireg.al = 0x04;\n\t\tintcall(0x15, &ireg, NULL);\n\t\treturn -1;\n\t}\n\n\tboot_params.apm_bios_info.version = oreg.ax;\n\tboot_params.apm_bios_info.flags   = oreg.cx;\n\treturn 0;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}