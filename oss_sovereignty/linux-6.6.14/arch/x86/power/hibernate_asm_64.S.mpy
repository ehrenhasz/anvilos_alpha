{
  "module_name": "hibernate_asm_64.S",
  "hash_id": "2a0c8f249137202f647f8e157f4e94e0f32bf32993b7e05caee4964208416a4a",
  "original_prompt": "Ingested from linux-6.6.14/arch/x86/power/hibernate_asm_64.S",
  "human_readable_source": " \n \n\n\t.text\n#include <linux/linkage.h>\n#include <asm/segment.h>\n#include <asm/page_types.h>\n#include <asm/asm-offsets.h>\n#include <asm/processor-flags.h>\n#include <asm/frame.h>\n#include <asm/nospec-branch.h>\n\n\t  \n\t.align PAGE_SIZE\nSYM_FUNC_START(restore_registers)\n\t \n\tmovq    %r9, %cr3\n\n\t \n\tmovq\tmmu_cr4_features(%rip), %rax\n\tmovq\t%rax, %rdx\n\tandq\t$~(X86_CR4_PGE), %rdx\n\tmovq\t%rdx, %cr4;  # turn off PGE\n\tmovq\t%cr3, %rcx;  # flush TLB\n\tmovq\t%rcx, %cr3\n\tmovq\t%rax, %cr4;  # turn PGE back on\n\n\t \n\tmovq\t$saved_context, %rax\n\tmovq\tpt_regs_sp(%rax), %rsp\n\tmovq\tpt_regs_bp(%rax), %rbp\n\tmovq\tpt_regs_si(%rax), %rsi\n\tmovq\tpt_regs_di(%rax), %rdi\n\tmovq\tpt_regs_bx(%rax), %rbx\n\tmovq\tpt_regs_cx(%rax), %rcx\n\tmovq\tpt_regs_dx(%rax), %rdx\n\tmovq\tpt_regs_r8(%rax), %r8\n\tmovq\tpt_regs_r9(%rax), %r9\n\tmovq\tpt_regs_r10(%rax), %r10\n\tmovq\tpt_regs_r11(%rax), %r11\n\tmovq\tpt_regs_r12(%rax), %r12\n\tmovq\tpt_regs_r13(%rax), %r13\n\tmovq\tpt_regs_r14(%rax), %r14\n\tmovq\tpt_regs_r15(%rax), %r15\n\tpushq\tpt_regs_flags(%rax)\n\tpopfq\n\n\t \n\tlgdt\tsaved_context_gdt_desc(%rax)\n\n\txorl\t%eax, %eax\n\n\t \n\tmovq\t%rax, in_suspend(%rip)\n\n\tRET\nSYM_FUNC_END(restore_registers)\n\nSYM_FUNC_START(swsusp_arch_suspend)\n\tmovq\t$saved_context, %rax\n\tmovq\t%rsp, pt_regs_sp(%rax)\n\tmovq\t%rbp, pt_regs_bp(%rax)\n\tmovq\t%rsi, pt_regs_si(%rax)\n\tmovq\t%rdi, pt_regs_di(%rax)\n\tmovq\t%rbx, pt_regs_bx(%rax)\n\tmovq\t%rcx, pt_regs_cx(%rax)\n\tmovq\t%rdx, pt_regs_dx(%rax)\n\tmovq\t%r8, pt_regs_r8(%rax)\n\tmovq\t%r9, pt_regs_r9(%rax)\n\tmovq\t%r10, pt_regs_r10(%rax)\n\tmovq\t%r11, pt_regs_r11(%rax)\n\tmovq\t%r12, pt_regs_r12(%rax)\n\tmovq\t%r13, pt_regs_r13(%rax)\n\tmovq\t%r14, pt_regs_r14(%rax)\n\tmovq\t%r15, pt_regs_r15(%rax)\n\tpushfq\n\tpopq\tpt_regs_flags(%rax)\n\n\t \n\tmovq\t%cr3, %rax\n\tmovq\t%rax, restore_cr3(%rip)\n\n\tFRAME_BEGIN\n\tcall swsusp_save\n\tFRAME_END\n\tRET\nSYM_FUNC_END(swsusp_arch_suspend)\n\nSYM_FUNC_START(restore_image)\n\t \n\tmovq\trestore_jump_address(%rip), %r8\n\tmovq\trestore_cr3(%rip), %r9\n\n\t \n\tmovq\ttemp_pgt(%rip), %rax\n\tmovq\tmmu_cr4_features(%rip), %rbx\n\n\t \n\tmovq\trestore_pblist(%rip), %rdx\n\n\t \n\tmovq\trelocated_restore_code(%rip), %rcx\n\tANNOTATE_RETPOLINE_SAFE\n\tjmpq\t*%rcx\nSYM_FUNC_END(restore_image)\n\n\t \nSYM_FUNC_START(core_restore_code)\n\t \n\tmovq\t%rax, %cr3\n\t \n\tmovq\t%rbx, %rcx\n\tandq\t$~(X86_CR4_PGE), %rcx\n\tmovq\t%rcx, %cr4;  # turn off PGE\n\tmovq\t%cr3, %rcx;  # flush TLB\n\tmovq\t%rcx, %cr3;\n\tmovq\t%rbx, %cr4;  # turn PGE back on\n.Lloop:\n\ttestq\t%rdx, %rdx\n\tjz\t.Ldone\n\n\t \n\tmovq\tpbe_address(%rdx), %rsi\n\tmovq\tpbe_orig_address(%rdx), %rdi\n\tmovq\t$(PAGE_SIZE >> 3), %rcx\n\trep\n\tmovsq\n\n\t \n\tmovq\tpbe_next(%rdx), %rdx\n\tjmp\t.Lloop\n\n.Ldone:\n\t \n\tANNOTATE_RETPOLINE_SAFE\n\tjmpq\t*%r8\nSYM_FUNC_END(core_restore_code)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}