{
  "module_name": "i810_dvt.c",
  "hash_id": "96d187a91c50569980d5ae398b47244788cc7085a2e2df75ebef50793c495a99",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/i810/i810_dvt.c",
  "human_readable_source": " \n\n#include <linux/kernel.h>\n\n#include \"i810_regs.h\"\n#include \"i810.h\"\n#include \"i810_main.h\"\n\nstruct mode_registers std_modes[] = {\n\t \n\t{ 25000, 0x0013, 0x0003, 0x40, 0x5F, 0x4F, 0x50, 0x82, 0x51, 0x9D,\n\t  0x0B, 0x10, 0x40, 0xE9, 0x0B, 0xDF, 0x50, 0xE7, 0x04, 0x02,\n\t  0x01, 0x01, 0x01, 0x00, 0x01, 0x22002000, 0x22004000, 0x22006000,\n\t  0x22002000, 0x22004000, 0x22006000, 0xC0 }, \n\t  \n\t \n\t{ 28000, 0x0053, 0x0010, 0x40, 0x61, 0x4F, 0x4F, 0x85, 0x52, 0x9A,\n\t  0xF2, 0x10, 0x40, 0xE0, 0x03, 0xDF, 0x50, 0xDF, 0xF3, 0x01, \n\t  0x01, 0x01, 0x01, 0x00, 0x01, 0x22002000, 0x22004000, 0x22005000,\n          0x22002000, 0x22004000, 0x22005000, 0xC0 },\n          \n         \n        { 31000, 0x0013, 0x0002, 0x40, 0x63, 0x4F, 0x4F, 0x87, 0x52, 0x97,\n          0x06, 0x0F, 0x40, 0xE8, 0x0B, 0xDF, 0x50, 0xDF, 0x07, 0x02, \n          0x01, 0x01, 0x01, 0x00, 0x01, 0x22003000, 0x22005000, 0x22007000,\n          0x22003000, 0x22005000, 0x22007000, 0xC0 },\n          \n         \n        { 31000, 0x0013, 0x0002, 0x40, 0x64, 0x4F, 0x4F, 0x88, 0x51, 0x99, \n          0xF2, 0x10, 0x40, 0xE0, 0x03, 0xDF, 0x50, 0xDF, 0xF3, 0x01, \n          0x01, 0x01, 0x01, 0x00, 0x01, 0x22003000, 0x22005000, 0x22007000, \n          0x22003000, 0x22005000, 0x22007000, 0xC0 },\n          \n         \n        { 36000, 0x0010, 0x0001, 0x40, 0x63, 0x4F, 0x4F, 0x87, 0x56, 0x9D,\n          0xFB, 0x10, 0x40, 0xE0, 0x03, 0xDF, 0x50, 0xDF, 0xFC, 0x01,\n          0x01, 0x01, 0x01, 0x00, 0x01, 0x22003000, 0x22005000, 0x22107000,\n          0x22003000, 0x22005000, 0x22107000, 0xC0 },\n          \n         \n        { 36000, 0x0010, 0x0001, 0x40, 0x7B, 0x63, 0x63, 0x9F, 0x66, 0x8F,\n          0x6F, 0x10, 0x40, 0x58, 0x0A, 0x57, 0xC8, 0x57, 0x70, 0x02, \n          0x02, 0x02, 0x02, 0x00, 0x01, 0x22003000, 0x22005000, 0x22107000,\n          0x22003000, 0x22005000, 0x22107000, 0x00 },\n          \n         \n        { 40000, 0x0008, 0x0001, 0x30, 0x7F, 0x63, 0x63, 0x83, 0x68, 0x18, \n          0x72, 0x10, 0x40, 0x58, 0x0C, 0x57, 0xC8, 0x57, 0x73, 0x02,\n          0x02, 0x02, 0x02, 0x00, 0x00, 0x22003000, 0x22006000, 0x22108000,\n          0x22003000, 0x22006000, 0x22108000, 0x00 },\n          \n         \n        { 45000, 0x0054, 0x0015, 0x30, 0x7D, 0x63, 0x63, 0x81, 0x68, 0x12,\n          0x6f, 0x10, 0x40, 0x58, 0x0b, 0x57, 0x64, 0x57, 0x70, 0x02, \n          0x02, 0x02, 0x02, 0x00, 0x00, 0x22004000, 0x22007000, 0x2210A000, \n          0x22004000, 0x22007000, 0x2210A000, 0x00 },\n          \n         \n        { 50000, 0x0017, 0x0004, 0x30, 0x7D, 0x63, 0x63, 0x81, 0x6A, 0x19,\n          0x98, 0x10, 0x40, 0x7C, 0x02, 0x57, 0xC8, 0x57, 0x99, 0x02, \n          0x02, 0x02, 0x02, 0x00, 0x00, 0x22004000, 0x22007000, 0x2210A000,\n          0x22004000, 0x22007000, 0x2210A000, 0x00 }, \n          \n         \n        { 49000, 0x001F, 0x0006, 0x30, 0x7F, 0x63, 0x63, 0x83, 0x65, 0x0F,\n          0x6F, 0x10, 0x40, 0x58, 0x0B, 0x57, 0xC8, 0x57, 0x70, 0x02, \n          0x02, 0x02, 0x02, 0x00, 0x00, 0x22004000, 0x22007000, 0x2210B000,\n          0x22004000, 0x22007000, 0x2210B000, 0x00 },\n          \n         \n        { 56000, 0x0049, 0x000E, 0x30, 0x7E, 0x63, 0x63, 0x82, 0x67, 0x0F,\n          0x75, 0x10, 0x40, 0x58, 0x0B, 0x57, 0xC8, 0x57, 0x76, 0x02,\n          0x02, 0x02, 0x02, 0x00, 0x00, 0x22004000, 0x22108000, 0x2210b000, \n          0x22004000, 0x22108000, 0x2210b000, 0x00 },\n          \n         \n        { 65000, 0x003F, 0x000A, 0x30, 0xA3, 0x7F, 0x7F, 0x87, 0x83, 0x94,\n          0x24, 0x10, 0x40, 0x02, 0x08, 0xFF, 0x80, 0xFF, 0x25, 0x03,\n          0x02, 0x03, 0x02, 0x00, 0x00, 0x22005000, 0x22109000, 0x2220D000,\n          0x22005000, 0x22109000, 0x2220D000, 0xC0 },\n          \n         \n\t{ 75000, 0x0017, 0x0002, 0x30, 0xA1, 0x7F, 0x7F, 0x85, 0x82, 0x93,\n\t  0x24, 0x10, 0x40, 0x02, 0x08, 0xFF, 0x80, 0xFF, 0x25, 0x03,\n\t  0x02, 0x03, 0x02, 0x00, 0x00, 0x22005000, 0x2210A000, 0x2220F000,\n\t  0x22005000, 0x2210A000, 0x2220F000, 0xC0 }, \n\t  \n\t           \n\t{ 78000, 0x0050, 0x0017, 0x20, 0x9F, 0x7F, 0x7F, 0x83, 0x81, 0x8D,\n\t  0x1E, 0x10, 0x40, 0x00, 0x03, 0xFF, 0x80, 0xFF, 0x1F, 0x03,\n\t  0x02, 0x03, 0x02, 0x00, 0x00, 0x22006000, 0x2210B000, 0x22210000,\n\t  0x22006000, 0x2210B000, 0x22210000, 0x00 },\n\t  \n\t \n\t{ 94000, 0x003D, 0x000E, 0x20, 0xA7, 0x7F, 0x7F, 0x8B, 0x85, 0x91,\n\t  0x26, 0x10, 0x40, 0x00, 0x03, 0xFF, 0x80, 0xFF, 0x27, 0x03,\n\t  0x02, 0x03, 0x02, 0x00, 0x00, 0x22007000, 0x2220E000, 0x22212000,\n\t  0x22007000, 0x2220E000, 0x22212000, 0x00 },\n\t  \n\t  \n\t{ 80000, 0x0008, 0x0001, 0x20, 0xB3, 0x8F, 0x8F, 0x97, 0x93, 0x9f,\n\t  0x87, 0x10, 0x40, 0x60, 0x03, 0x5F, 0x90, 0x5f, 0x88, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x00, 0x2220C000, 0x22210000, 0x22415000,   \n\t  0x2220C000, 0x22210000, 0x22415000, 0x00 },\n\t  \n\t \n\t{ 96000, 0x000a, 0x0001, 0x20, 0xbb, 0x8F, 0x8F, 0x9f, 0x98, 0x87, \n\t  0x82, 0x10, 0x40, 0x60, 0x03, 0x5F, 0x90, 0x5F, 0x83, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x00, 0x22107000, 0x22210000, 0x22415000,\n\t  0x22107000, 0x22210000, 0x22415000, 0x00 },\n\t  \n\t \n\t{ 99000, 0x001f, 0x0006, 0x20, 0xbb, 0x8F, 0x8F, 0x9f, 0x98, 0x87,\n\t  0x83, 0x10, 0x40, 0x60, 0x03, 0x5F, 0x90, 0x5F, 0x84, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x00, 0x22107000, 0x22210000, 0x22415000,\n\t  0x22107000, 0x22210000, 0x22415000, 0x00 },\n\t  \n\t \n\t{ 108000, 0x0010, 0x0002, 0x20, 0xC3, 0x8F, 0x8F, 0x87, 0x97, 0x07,\n\t  0x82, 0x10, 0x40, 0x60, 0x03, 0x5F, 0x90, 0x5F, 0x83, 0x03, \n\t  0x03, 0x03, 0x03, 0x00, 0x01, 0x22107000, 0x22210000, 0x22415000,\n\t  0x22107000, 0x22210000, 0x22415000, 0x00 },\n\t  \n\t \n\t{ 121000, 0x006D, 0x0014, 0x20, 0xc0, 0x8F, 0x8F, 0x84, 0x97, 0x07,\n\t  0x93, 0x10, 0x40, 0x60, 0x03, 0x5F, 0x90, 0x5F, 0x94, 0x03, \n\t  0x03, 0x03, 0x03, 0x00, 0x01, 0x2220C000, 0x22210000, 0x22415000,\n\t  0x2220C000, 0x22210000, 0x22415000, 0x0 },\n\t  \n\t \n\t{ 108000, 0x0010, 0x0002, 0x20, 0xDC, 0x9F, 0x9F, 0x80, 0xAB, 0x99,\n\t  0xE6, 0x10, 0x40, 0xC0, 0x03, 0xBF, 0xA0, 0xBF, 0xE7, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x01, 0x2210A000, 0x22210000, 0x22415000,\n\t  0x2210A000, 0x22210000, 0x22415000, 0x00 },\n\t  \n\t \n\t{ 129000, 0x0029, 0x0006, 0x20, 0xD3, 0x9F, 0x9F, 0x97, 0xaa, 0x1b,\n\t  0xE8, 0x10, 0x40, 0xC0, 0x03, 0xBF, 0xA0, 0xBF, 0xE9, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x01, 0x2210A000, 0x22210000, 0x2241B000,\n\t  0x2210A000, 0x22210000, 0x2241B000, 0x00 },\n\t  \n\t \n\t{ 148000, 0x0042, 0x0009, 0x20, 0xD3, 0x9F, 0x9F, 0x97, 0xA7, 0x1B,\n\t  0xF1, 0x10, 0x40, 0xC0, 0x03, 0xBF, 0xA0, 0xBF, 0xF2, 0x03,\n\t  0x03, 0x03, 0x03, 0x00, 0x01, 0x2210A000, 0x22220000, 0x2241D000,       \n\t  0x2210A000, 0x22220000, 0x2241D000, 0x00 },\n\t  \n\t \n\t{ 162000, 0x0019, 0x0006, 0x10, 0x09, 0xC7, 0xC7, 0x8D, 0xcf, 0x07,\n\t  0xE0, 0x10, 0x40, 0xB0, 0x03, 0xAF, 0xC8, 0xAF, 0xE1, 0x04, \n\t  0x04, 0x04, 0x04, 0x01, 0x00, 0x2210b000, 0x22416000, 0x44419000,\n\t  0x2210b000, 0x22416000, 0x44419000, 0x00 },\n\t  \n\t \n\t{ 175000, 0x005d, 0x0018, 0x10, 0x09, 0xC7, 0xC7, 0x8D, 0xcf, 0x07,\n\t  0xE0, 0x10, 0x40, 0xB0, 0x03, 0xAF, 0xC8, 0xAF, 0xE1, 0x04, \n\t  0x04, 0x04, 0x04, 0x01, 0x00, 0x2210c000, 0x22416000, 0x44419000,\n\t  0x2210c000, 0x22416000, 0x44419000, 0x00 },\n\t  \n\t \n\t{ 189000, 0x003D, 0x000e, 0x10, 0x09, 0xC7, 0xC7, 0x8d, 0xcf, 0x07,\n\t  0xE0, 0x10, 0x40, 0xb0, 0x03, 0xAF, 0xC8, 0xaf, 0xE1, 0x04, \n\t  0x04, 0x04, 0x04, 0x01, 0x00, 0x2220e000, 0x22416000, 0x44419000,\n\t  0x2220e000, 0x22416000, 0x44419000, 0x00 },\n\t  \n \t \n \t{ 195000, 0x003f, 0x000e, 0x10, 0x0b, 0xC7, 0xC7, 0x8f, 0xd5, 0x0b,\n \t  0xE1, 0x10, 0x40, 0xb0, 0x03, 0xAF, 0xC8, 0xaf, 0xe2, 0x04, 0x04,\n \t  0x04, 0x04, 0x01, 0x00, 0x2220e000, 0x22416000, 0x44419000,\n \t  0x2220e000, 0x22416000, 0x44419000, 0x00 }, \n \t  \n \t \n \t{ 202000, 0x0024, 0x0007, 0x10, 0x09, 0xC7, 0xC7, 0x8d, 0xcf, 0x07,\n \t  0xE0, 0x10, 0x40, 0xb0, 0x03, 0xAF, 0xC8, 0xaf, 0xE1, 0x04, 0x04,\n \t  0x04, 0x04, 0x01, 0x00, 0x2220e000, 0x22416000, 0x44419000,      \n \t  0x2220e000, 0x22416000, 0x44419000,  0x00 },\n \t  \n \t \n\t{ 229000, 0x0029, 0x0007, 0x10, 0x09, 0xC7, 0xC7, 0x8d, 0xcf, 0x07,\n\t  0xE0, 0x10, 0x40, 0xb0, 0x03, 0xAF, 0xC8, 0xaf, 0xE1, 0x04, 0x04,\n\t  0x04, 0x04, 0x01, 0x00, 0x22210000, 0x22416000, 0x0,\n\t  0x22210000, 0x22416000, 0x0, 0x00 },\n};\t \n\nvoid round_off_xres(u32 *xres) \n{\n\tif (*xres <= 640)\n\t\t*xres = 640;\n\telse if (*xres <= 800)\n\t\t*xres = 800;\n\telse if (*xres <= 1024)\n\t\t*xres = 1024;\n\telse if (*xres <= 1152)\n\t\t*xres = 1152;\n\telse if (*xres <= 1280)\n\t\t*xres = 1280;\n\telse\n\t\t*xres = 1600;\n}\n\ninline void round_off_yres(u32 *xres, u32 *yres)\n{\n\t*yres = (*xres * 3) >> 2;\n}\n\nstatic int i810fb_find_best_mode(u32 xres, u32 yres, u32 pixclock)\n{ \n\tu32 diff = 0, diff_best = 0xFFFFFFFF, i = 0, i_best = 0; \n\tu8 hfl = (u8) ((xres >> 3) - 1);\n\n\tfor (i = 0; i < ARRAY_SIZE(std_modes); i++) { \n\t\tif (std_modes[i].cr01 == hfl) { \n\t\t\tif (std_modes[i].pixclock <= pixclock)\n\t\t\t\tdiff = pixclock - std_modes[i].pixclock;\n\t\t\tif (diff < diff_best) {\t \n\t\t    \t\ti_best = i;\n\t\t    \t\tdiff_best = diff;\n\t\t\t}\n\t\t}\n\t}\n\treturn i_best;\n}\n\nvoid i810fb_encode_registers(const struct fb_var_screeninfo *var,\n\t\t\t     struct i810fb_par *par, u32 xres, u32 yres)\n{\n\tu32 i_best = i810fb_find_best_mode(xres, yres, par->regs.pixclock);\n\n\tpar->regs = std_modes[i_best];\n\n\t \n\tpar->ovract = ((xres + var->right_margin + var->hsync_len + \n\t\t\tvar->left_margin - 32) | ((xres - 32) << 16));\n}\n\nvoid i810fb_fill_var_timings(struct fb_var_screeninfo *var)\n{\n\tu32 total, xres, yres;\n\tu32 mode, pixclock;\n\n\txres = var->xres;\n\tyres = var->yres;\n\t\n\tpixclock = 1000000000 / var->pixclock;\n\tmode = i810fb_find_best_mode(xres, yres, pixclock);\n\t\n\ttotal = (std_modes[mode].cr00 | (std_modes[mode].cr35 & 1) << 8) + 3;\n\ttotal <<= 3;\n\t\n\tvar->pixclock = 1000000000 / std_modes[mode].pixclock;\n\tvar->right_margin = (std_modes[mode].cr04 << 3) - xres;\n\tvar->hsync_len = ((std_modes[mode].cr05 & 0x1F) -\n\t\t\t (std_modes[mode].cr04 & 0x1F)) << 3;\n\tvar->left_margin = (total - (xres + var->right_margin + \n\t\t\t\t     var->hsync_len));\n\tvar->sync = FB_SYNC_ON_GREEN;\n\tif (~(std_modes[mode].msr & (1 << 6)))\n\t\tvar->sync |= FB_SYNC_HOR_HIGH_ACT;\n\tif (~(std_modes[mode].msr & (1 << 7)))\n\t\tvar->sync |= FB_SYNC_VERT_HIGH_ACT;\n\n\ttotal = (std_modes[mode].cr06 | (std_modes[mode].cr30 & 0xF)  << 8) + 2;\n\tvar->lower_margin = (std_modes[mode].cr10 |\n\t\t\t    (std_modes[mode].cr32 & 0x0F) << 8) - yres;\n\tvar->vsync_len = (std_modes[mode].cr11 & 0x0F) -\n\t\t\t (var->lower_margin & 0x0F);\n\tvar->upper_margin = total - (yres + var->lower_margin + var->vsync_len);\n}\n\nu32 i810_get_watermark(const struct fb_var_screeninfo *var,\n\t\t       struct i810fb_par *par)\n{\n\tstruct mode_registers *params = &par->regs;\n\tu32 wmark = 0;\n\t\n\tif (par->mem_freq == 100) {\n\t\tswitch (var->bits_per_pixel) {\n\t\tcase 8:\n\t\t\twmark = params->bpp8_100;\n\t\t\tbreak;\n\t\tcase 16:\n\t\t\twmark = params->bpp16_100;\n\t\t\tbreak;\n\t\tcase 24:\n\t\tcase 32:\n\t\t\twmark = params->bpp24_100;\n\t\t}\n\t} else {\t\t\t\t\t\n\t\tswitch (var->bits_per_pixel) {\n\t\tcase 8:\n\t\t\twmark = params->bpp8_133;\n\t\t\tbreak;\n\t\tcase 16:\n\t\t\twmark = params->bpp16_133;\n\t\t\tbreak;\n\t\tcase 24:\n\t\tcase 32:\n\t\t\twmark = params->bpp24_133;\n\t\t}\n\t}\n\treturn wmark;\n}\t\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}