{
  "module_name": "hdmi.h",
  "hash_id": "cd49d44d596297a32efd592c3fc50ac369c74c862e11af184884e80b89b946a8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/omap2/omapfb/dss/hdmi.h",
  "human_readable_source": " \n \n\n#ifndef _HDMI_H\n#define _HDMI_H\n\n#include <linux/delay.h>\n#include <linux/io.h>\n#include <linux/platform_device.h>\n#include <linux/hdmi.h>\n#include <video/omapfb_dss.h>\n#include <sound/omap-hdmi-audio.h>\n\n#include \"dss.h\"\n\n \n\n#define HDMI_WP_REVISION\t\t\t0x0\n#define HDMI_WP_SYSCONFIG\t\t\t0x10\n#define HDMI_WP_IRQSTATUS_RAW\t\t\t0x24\n#define HDMI_WP_IRQSTATUS\t\t\t0x28\n#define HDMI_WP_IRQENABLE_SET\t\t\t0x2C\n#define HDMI_WP_IRQENABLE_CLR\t\t\t0x30\n#define HDMI_WP_IRQWAKEEN\t\t\t0x34\n#define HDMI_WP_PWR_CTRL\t\t\t0x40\n#define HDMI_WP_DEBOUNCE\t\t\t0x44\n#define HDMI_WP_VIDEO_CFG\t\t\t0x50\n#define HDMI_WP_VIDEO_SIZE\t\t\t0x60\n#define HDMI_WP_VIDEO_TIMING_H\t\t\t0x68\n#define HDMI_WP_VIDEO_TIMING_V\t\t\t0x6C\n#define HDMI_WP_CLK\t\t\t\t0x70\n#define HDMI_WP_AUDIO_CFG\t\t\t0x80\n#define HDMI_WP_AUDIO_CFG2\t\t\t0x84\n#define HDMI_WP_AUDIO_CTRL\t\t\t0x88\n#define HDMI_WP_AUDIO_DATA\t\t\t0x8C\n\n \n#define HDMI_IRQ_CORE\t\t\t\t(1 << 0)\n#define HDMI_IRQ_OCP_TIMEOUT\t\t\t(1 << 4)\n#define HDMI_IRQ_AUDIO_FIFO_UNDERFLOW\t\t(1 << 8)\n#define HDMI_IRQ_AUDIO_FIFO_OVERFLOW\t\t(1 << 9)\n#define HDMI_IRQ_AUDIO_FIFO_SAMPLE_REQ\t\t(1 << 10)\n#define HDMI_IRQ_VIDEO_VSYNC\t\t\t(1 << 16)\n#define HDMI_IRQ_VIDEO_FRAME_DONE\t\t(1 << 17)\n#define HDMI_IRQ_PHY_LINE5V_ASSERT\t\t(1 << 24)\n#define HDMI_IRQ_LINK_CONNECT\t\t\t(1 << 25)\n#define HDMI_IRQ_LINK_DISCONNECT\t\t(1 << 26)\n#define HDMI_IRQ_PLL_LOCK\t\t\t(1 << 29)\n#define HDMI_IRQ_PLL_UNLOCK\t\t\t(1 << 30)\n#define HDMI_IRQ_PLL_RECAL\t\t\t(1 << 31)\n\n \n\n#define PLLCTRL_PLL_CONTROL\t\t\t0x0\n#define PLLCTRL_PLL_STATUS\t\t\t0x4\n#define PLLCTRL_PLL_GO\t\t\t\t0x8\n#define PLLCTRL_CFG1\t\t\t\t0xC\n#define PLLCTRL_CFG2\t\t\t\t0x10\n#define PLLCTRL_CFG3\t\t\t\t0x14\n#define PLLCTRL_SSC_CFG1\t\t\t0x18\n#define PLLCTRL_SSC_CFG2\t\t\t0x1C\n#define PLLCTRL_CFG4\t\t\t\t0x20\n\n \n\n#define HDMI_TXPHY_TX_CTRL\t\t\t0x0\n#define HDMI_TXPHY_DIGITAL_CTRL\t\t\t0x4\n#define HDMI_TXPHY_POWER_CTRL\t\t\t0x8\n#define HDMI_TXPHY_PAD_CFG_CTRL\t\t\t0xC\n#define HDMI_TXPHY_BIST_CONTROL\t\t\t0x1C\n\nenum hdmi_pll_pwr {\n\tHDMI_PLLPWRCMD_ALLOFF = 0,\n\tHDMI_PLLPWRCMD_PLLONLY = 1,\n\tHDMI_PLLPWRCMD_BOTHON_ALLCLKS = 2,\n\tHDMI_PLLPWRCMD_BOTHON_NOPHYCLK = 3\n};\n\nenum hdmi_phy_pwr {\n\tHDMI_PHYPWRCMD_OFF = 0,\n\tHDMI_PHYPWRCMD_LDOON = 1,\n\tHDMI_PHYPWRCMD_TXON = 2\n};\n\nenum hdmi_core_hdmi_dvi {\n\tHDMI_DVI = 0,\n\tHDMI_HDMI = 1\n};\n\nenum hdmi_packing_mode {\n\tHDMI_PACK_10b_RGB_YUV444 = 0,\n\tHDMI_PACK_24b_RGB_YUV444_YUV422 = 1,\n\tHDMI_PACK_20b_YUV422 = 2,\n\tHDMI_PACK_ALREADYPACKED = 7\n};\n\nenum hdmi_stereo_channels {\n\tHDMI_AUDIO_STEREO_NOCHANNELS = 0,\n\tHDMI_AUDIO_STEREO_ONECHANNEL = 1,\n\tHDMI_AUDIO_STEREO_TWOCHANNELS = 2,\n\tHDMI_AUDIO_STEREO_THREECHANNELS = 3,\n\tHDMI_AUDIO_STEREO_FOURCHANNELS = 4\n};\n\nenum hdmi_audio_type {\n\tHDMI_AUDIO_TYPE_LPCM = 0,\n\tHDMI_AUDIO_TYPE_IEC = 1\n};\n\nenum hdmi_audio_justify {\n\tHDMI_AUDIO_JUSTIFY_LEFT = 0,\n\tHDMI_AUDIO_JUSTIFY_RIGHT = 1\n};\n\nenum hdmi_audio_sample_order {\n\tHDMI_AUDIO_SAMPLE_RIGHT_FIRST = 0,\n\tHDMI_AUDIO_SAMPLE_LEFT_FIRST = 1\n};\n\nenum hdmi_audio_samples_perword {\n\tHDMI_AUDIO_ONEWORD_ONESAMPLE = 0,\n\tHDMI_AUDIO_ONEWORD_TWOSAMPLES = 1\n};\n\nenum hdmi_audio_sample_size_omap {\n\tHDMI_AUDIO_SAMPLE_16BITS = 0,\n\tHDMI_AUDIO_SAMPLE_24BITS = 1\n};\n\nenum hdmi_audio_transf_mode {\n\tHDMI_AUDIO_TRANSF_DMA = 0,\n\tHDMI_AUDIO_TRANSF_IRQ = 1\n};\n\nenum hdmi_audio_blk_strt_end_sig {\n\tHDMI_AUDIO_BLOCK_SIG_STARTEND_ON = 0,\n\tHDMI_AUDIO_BLOCK_SIG_STARTEND_OFF = 1\n};\n\nenum hdmi_core_audio_layout {\n\tHDMI_AUDIO_LAYOUT_2CH = 0,\n\tHDMI_AUDIO_LAYOUT_8CH = 1,\n\tHDMI_AUDIO_LAYOUT_6CH = 2\n};\n\nenum hdmi_core_cts_mode {\n\tHDMI_AUDIO_CTS_MODE_HW = 0,\n\tHDMI_AUDIO_CTS_MODE_SW = 1\n};\n\nenum hdmi_audio_mclk_mode {\n\tHDMI_AUDIO_MCLK_128FS = 0,\n\tHDMI_AUDIO_MCLK_256FS = 1,\n\tHDMI_AUDIO_MCLK_384FS = 2,\n\tHDMI_AUDIO_MCLK_512FS = 3,\n\tHDMI_AUDIO_MCLK_768FS = 4,\n\tHDMI_AUDIO_MCLK_1024FS = 5,\n\tHDMI_AUDIO_MCLK_1152FS = 6,\n\tHDMI_AUDIO_MCLK_192FS = 7\n};\n\nstruct hdmi_video_format {\n\tenum hdmi_packing_mode\tpacking_mode;\n\tu32\t\t\ty_res;\t \n\tu32\t\t\tx_res;\t \n};\n\nstruct hdmi_config {\n\tstruct omap_video_timings timings;\n\tstruct hdmi_avi_infoframe infoframe;\n\tenum hdmi_core_hdmi_dvi hdmi_dvi_mode;\n};\n\nstruct hdmi_audio_format {\n\tenum hdmi_stereo_channels\t\tstereo_channels;\n\tu8\t\t\t\t\tactive_chnnls_msk;\n\tenum hdmi_audio_type\t\t\ttype;\n\tenum hdmi_audio_justify\t\t\tjustification;\n\tenum hdmi_audio_sample_order\t\tsample_order;\n\tenum hdmi_audio_samples_perword\t\tsamples_per_word;\n\tenum hdmi_audio_sample_size_omap\tsample_size;\n\tenum hdmi_audio_blk_strt_end_sig\ten_sig_blk_strt_end;\n};\n\nstruct hdmi_audio_dma {\n\tu8\t\t\t\ttransfer_size;\n\tu8\t\t\t\tblock_size;\n\tenum hdmi_audio_transf_mode\tmode;\n\tu16\t\t\t\tfifo_threshold;\n};\n\nstruct hdmi_core_audio_i2s_config {\n\tu8 in_length_bits;\n\tu8 justification;\n\tu8 sck_edge_mode;\n\tu8 vbit;\n\tu8 direction;\n\tu8 shift;\n\tu8 active_sds;\n};\n\nstruct hdmi_core_audio_config {\n\tstruct hdmi_core_audio_i2s_config\ti2s_cfg;\n\tstruct snd_aes_iec958\t\t\t*iec60958_cfg;\n\tbool\t\t\t\t\tfs_override;\n\tu32\t\t\t\t\tn;\n\tu32\t\t\t\t\tcts;\n\tu32\t\t\t\t\taud_par_busclk;\n\tenum hdmi_core_audio_layout\t\tlayout;\n\tenum hdmi_core_cts_mode\t\t\tcts_mode;\n\tbool\t\t\t\t\tuse_mclk;\n\tenum hdmi_audio_mclk_mode\t\tmclk_mode;\n\tbool\t\t\t\t\ten_acr_pkt;\n\tbool\t\t\t\t\ten_dsd_audio;\n\tbool\t\t\t\t\ten_parallel_aud_input;\n\tbool\t\t\t\t\ten_spdif;\n};\n\nstruct hdmi_wp_data {\n\tvoid __iomem *base;\n\tphys_addr_t phys_base;\n};\n\nstruct hdmi_pll_data {\n\tstruct dss_pll pll;\n\n\tvoid __iomem *base;\n\n\tstruct hdmi_wp_data *wp;\n};\n\nstruct hdmi_phy_data {\n\tvoid __iomem *base;\n\n\tu8 lane_function[4];\n\tu8 lane_polarity[4];\n};\n\nstruct hdmi_core_data {\n\tvoid __iomem *base;\n};\n\nstatic inline void hdmi_write_reg(void __iomem *base_addr, const u32 idx,\n\t\tu32 val)\n{\n\t__raw_writel(val, base_addr + idx);\n}\n\nstatic inline u32 hdmi_read_reg(void __iomem *base_addr, const u32 idx)\n{\n\treturn __raw_readl(base_addr + idx);\n}\n\n#define REG_FLD_MOD(base, idx, val, start, end) \\\n\thdmi_write_reg(base, idx, FLD_MOD(hdmi_read_reg(base, idx),\\\n\t\t\t\t\t\t\tval, start, end))\n#define REG_GET(base, idx, start, end) \\\n\tFLD_GET(hdmi_read_reg(base, idx), start, end)\n\nstatic inline int hdmi_wait_for_bit_change(void __iomem *base_addr,\n\t\tconst u32 idx, int b2, int b1, u32 val)\n{\n\tu32 t = 0, v;\n\twhile (val != (v = REG_GET(base_addr, idx, b2, b1))) {\n\t\tif (t++ > 10000)\n\t\t\treturn v;\n\t\tudelay(1);\n\t}\n\treturn v;\n}\n\n \nint hdmi_wp_video_start(struct hdmi_wp_data *wp);\nvoid hdmi_wp_video_stop(struct hdmi_wp_data *wp);\nvoid hdmi_wp_dump(struct hdmi_wp_data *wp, struct seq_file *s);\nu32 hdmi_wp_get_irqstatus(struct hdmi_wp_data *wp);\nvoid hdmi_wp_set_irqstatus(struct hdmi_wp_data *wp, u32 irqstatus);\nvoid hdmi_wp_set_irqenable(struct hdmi_wp_data *wp, u32 mask);\nvoid hdmi_wp_clear_irqenable(struct hdmi_wp_data *wp, u32 mask);\nint hdmi_wp_set_phy_pwr(struct hdmi_wp_data *wp, enum hdmi_phy_pwr val);\nint hdmi_wp_set_pll_pwr(struct hdmi_wp_data *wp, enum hdmi_pll_pwr val);\nvoid hdmi_wp_video_config_format(struct hdmi_wp_data *wp,\n\t\tstruct hdmi_video_format *video_fmt);\nvoid hdmi_wp_video_config_interface(struct hdmi_wp_data *wp,\n\t\tstruct omap_video_timings *timings);\nvoid hdmi_wp_video_config_timing(struct hdmi_wp_data *wp,\n\t\tstruct omap_video_timings *timings);\nvoid hdmi_wp_init_vid_fmt_timings(struct hdmi_video_format *video_fmt,\n\t\tstruct omap_video_timings *timings, struct hdmi_config *param);\nint hdmi_wp_init(struct platform_device *pdev, struct hdmi_wp_data *wp);\nphys_addr_t hdmi_wp_get_audio_dma_addr(struct hdmi_wp_data *wp);\n\n \nvoid hdmi_pll_dump(struct hdmi_pll_data *pll, struct seq_file *s);\nvoid hdmi_pll_compute(struct hdmi_pll_data *pll,\n\tunsigned long target_tmds, struct dss_pll_clock_info *pi);\nint hdmi_pll_init(struct platform_device *pdev, struct hdmi_pll_data *pll,\n\tstruct hdmi_wp_data *wp);\nvoid hdmi_pll_uninit(struct hdmi_pll_data *hpll);\n\n \nint hdmi_phy_configure(struct hdmi_phy_data *phy, unsigned long hfbitclk,\n\tunsigned long lfbitclk);\nvoid hdmi_phy_dump(struct hdmi_phy_data *phy, struct seq_file *s);\nint hdmi_phy_init(struct platform_device *pdev, struct hdmi_phy_data *phy);\nint hdmi_phy_parse_lanes(struct hdmi_phy_data *phy, const u32 *lanes);\n\n \nint hdmi_parse_lanes_of(struct platform_device *pdev, struct device_node *ep,\n\tstruct hdmi_phy_data *phy);\n\n \nint hdmi_compute_acr(u32 pclk, u32 sample_freq, u32 *n, u32 *cts);\nint hdmi_wp_audio_enable(struct hdmi_wp_data *wp, bool enable);\nint hdmi_wp_audio_core_req_enable(struct hdmi_wp_data *wp, bool enable);\nvoid hdmi_wp_audio_config_format(struct hdmi_wp_data *wp,\n\t\tstruct hdmi_audio_format *aud_fmt);\nvoid hdmi_wp_audio_config_dma(struct hdmi_wp_data *wp,\n\t\tstruct hdmi_audio_dma *aud_dma);\nstatic inline bool hdmi_mode_has_audio(struct hdmi_config *cfg)\n{\n\treturn cfg->hdmi_dvi_mode == HDMI_HDMI ? true : false;\n}\n\n \nstruct omap_hdmi {\n\tstruct mutex lock;\n\tstruct platform_device *pdev;\n\n\tstruct hdmi_wp_data\twp;\n\tstruct hdmi_pll_data\tpll;\n\tstruct hdmi_phy_data\tphy;\n\tstruct hdmi_core_data\tcore;\n\n\tstruct hdmi_config cfg;\n\n\tstruct regulator *vdda_reg;\n\n\tbool core_enabled;\n\n\tstruct omap_dss_device output;\n\n\tstruct platform_device *audio_pdev;\n\tvoid (*audio_abort_cb)(struct device *dev);\n\tint wp_idlemode;\n\n\tbool audio_configured;\n\tstruct omap_dss_audio audio_config;\n\n\t \n\tspinlock_t audio_playing_lock;\n\tbool audio_playing;\n\tbool display_enabled;\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}