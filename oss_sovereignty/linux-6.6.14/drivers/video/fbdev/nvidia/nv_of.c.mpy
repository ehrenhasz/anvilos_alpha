{
  "module_name": "nv_of.c",
  "hash_id": "40d539804b236f6a27f13e77b5994ad4822d9f44a576e4f582ea0bcde0b03078",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/nvidia/nv_of.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/delay.h>\n#include <linux/gfp.h>\n#include <linux/pci.h>\n#include <linux/fb.h>\n\n#include <asm/io.h>\n\n#include \"nv_type.h\"\n#include \"nv_local.h\"\n#include \"nv_proto.h\"\n\n#include \"../edid.h\"\n\nint nvidia_probe_of_connector(struct fb_info *info, int conn, u8 **out_edid)\n{\n\tstruct nvidia_par *par = info->par;\n\tstruct device_node *parent, *dp;\n\tconst unsigned char *pedid = NULL;\n\tstatic char *propnames[] = {\n\t\t\"DFP,EDID\", \"LCD,EDID\", \"EDID\", \"EDID1\",\n\t\t\"EDID,B\", \"EDID,A\", NULL };\n\tint i;\n\n\tparent = pci_device_to_OF_node(par->pci_dev);\n\tif (parent == NULL)\n\t\treturn -1;\n\tif (par->twoHeads) {\n\t\tconst char *pname;\n\t\tint len;\n\n\t\tfor_each_child_of_node(parent, dp) {\n\t\t\tpname = of_get_property(dp, \"name\", NULL);\n\t\t\tif (!pname)\n\t\t\t\tcontinue;\n\t\t\tlen = strlen(pname);\n\t\t\tif ((pname[len-1] == 'A' && conn == 1) ||\n\t\t\t    (pname[len-1] == 'B' && conn == 2)) {\n\t\t\t\tfor (i = 0; propnames[i] != NULL; ++i) {\n\t\t\t\t\tpedid = of_get_property(dp,\n\t\t\t\t\t\t\tpropnames[i], NULL);\n\t\t\t\t\tif (pedid != NULL)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tof_node_put(dp);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tif (pedid == NULL) {\n\t\tfor (i = 0; propnames[i] != NULL; ++i) {\n\t\t\tpedid = of_get_property(parent, propnames[i], NULL);\n\t\t\tif (pedid != NULL)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tif (pedid) {\n\t\t*out_edid = kmemdup(pedid, EDID_LENGTH, GFP_KERNEL);\n\t\tif (*out_edid == NULL)\n\t\t\treturn -1;\n\t\tprintk(KERN_DEBUG \"nvidiafb: Found OF EDID for head %d\\n\", conn);\n\t\treturn 0;\n\t}\n\treturn -1;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}