{
  "module_name": "modedb.c",
  "hash_id": "774f37cbc8d6eaf51800bd06af2f47e98452a90b313ccfdf40aea3046ea881af",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/core/modedb.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/fb.h>\n#include <linux/kernel.h>\n\n#undef DEBUG\n\n#define name_matches(v, s, l) \\\n    ((v).name && !strncmp((s), (v).name, (l)) && strlen((v).name) == (l))\n#define res_matches(v, x, y) \\\n    ((v).xres == (x) && (v).yres == (y))\n\n#ifdef DEBUG\n#define DPRINTK(fmt, args...)\tprintk(\"modedb %s: \" fmt, __func__ , ## args)\n#else\n#define DPRINTK(fmt, args...)\n#endif\n\n \n\nstatic const struct fb_videomode modedb[] = {\n\n\t \n\t{ NULL, 70, 640, 400, 39721, 40, 24, 39, 9, 96, 2, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 640, 480, 39721, 40, 24, 32, 11, 96, 2,\t0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 56, 800, 600, 27777, 128, 24, 22, 1, 72, 2,\t0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 87, 1024, 768, 22271, 56, 24, 33, 8, 160, 8, 0,\n\t\tFB_VMODE_INTERLACED },\n\n\t \n\t{ NULL, 85, 640, 400, 31746, 96, 32, 41, 1, 64, 3,\n\t\tFB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 72, 640, 480, 31746, 144, 40, 30, 8, 40, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 75, 640, 480, 31746, 120, 16, 16, 1, 64, 3,\t0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 800, 600, 25000, 88, 40, 23, 1, 128, 4,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 640, 480, 27777, 80, 56, 25, 1, 56, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 89, 1152, 864, 15384, 96, 16, 110, 1, 216, 10, 0,\n\t\tFB_VMODE_INTERLACED },\n\t \n\t{ NULL, 72, 800, 600, 20000, 64, 56, 23, 37, 120, 6,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1024, 768, 15384, 168, 8, 29, 3, 144, 6, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 100, 640, 480, 21834, 96, 32, 36, 8, 96, 6,\t0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1152, 864, 11123, 208, 64, 16, 4, 256, 8, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 800, 600, 16460, 160, 64, 36, 16, 64, 5, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 1024, 768, 13333, 144, 24, 29, 3, 136, 6, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 87, 1280, 1024, 12500, 56, 16, 128, 1, 216, 12,\t0,\n\t\tFB_VMODE_INTERLACED },\n\n\t \n\t{ NULL, 100, 800, 600, 14357, 160, 64, 30, 4, 64, 6, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 76, 1024, 768, 11764, 208, 8, 36, 16, 120, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 1152, 864, 10869, 106, 56, 20, 1, 160, 10, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 61, 1280, 1024, 9090, 200, 48, 26, 1, 184, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1400, 1050, 9259, 136, 40, 13, 1, 112, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 75, 1400, 1050, 7190, 120, 56, 23, 10, 112, 13,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1400, 1050, 9259, 128, 40, 12, 0, 112, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 1024, 768, 10111, 192, 32, 34, 14, 160, 6, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 78, 1152, 864, 9090, 228, 88, 32, 0, 84, 12, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 1280, 1024, 7905, 224, 32, 28, 8, 160, 8, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1600, 1200, 6172, 304, 64, 46, 1, 192, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 84, 1152, 864, 7407, 184, 312, 32, 0, 128, 12, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 74, 1280, 1024, 7407, 256, 32, 34, 3, 144, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 100, 1024, 768, 8658, 192, 32, 21, 3, 192, 10, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 76, 1280, 1024, 7407, 248, 32, 34, 3, 104, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 1600, 1200, 5291, 304, 64, 46, 1, 192, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 100, 1152, 864, 7264, 224, 32, 17, 2, 128, 19, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 1280, 1024, 6349, 224, 64, 44, 1, 160, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 75, 1600, 1200, 4938, 304, 64, 46, 1, 192, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1680, 1050, 6848, 280, 104, 30, 3, 176, 6,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 1600, 1200, 4545, 272, 16, 37, 4, 192, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 100, 1280, 1024, 5502, 256, 32, 26, 7, 128, 15, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 64, 1800, 1440, 4347, 304, 96, 46, 1, 192, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 1800, 1440, 4000, 304, 96, 46, 1, 192, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 78, 512, 384, 49603, 48, 16, 16, 1, 64, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 85, 512, 384, 45454, 48, 16, 16, 1, 64, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 70, 320, 200, 79440, 16, 16, 20, 4, 48, 1, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 60, 320, 240, 79440, 16, 16, 16, 5, 48, 1, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 72, 320, 240, 63492, 16, 16, 16, 4, 48, 2, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 56, 400, 300, 55555, 64, 16, 10, 1, 32, 1, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 60, 400, 300, 50000, 48, 16, 11, 1, 64, 2, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 72, 400, 300, 40000, 32, 24, 11, 19, 64, 3,\t0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 56, 480, 300, 46176, 80, 16, 10, 1, 40, 1, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 60, 480, 300, 41858, 56, 16, 11, 1, 80, 2, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 63, 480, 300, 40000, 56, 16, 11, 1, 80, 2, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 72, 480, 300, 33386, 40, 24, 11, 19, 80, 3, 0,\n\t\tFB_VMODE_DOUBLE },\n\n\t \n\t{ NULL, 60, 1920, 1080, 6734, 148, 88, 36, 4, 44, 5, 0,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1920, 1200, 5177, 128, 336, 1, 38, 208, 3,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1152, 768, 14047, 158, 26, 29, 3, 136, 6,\n\t\tFB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1366, 768, 13806, 120, 10, 14, 3, 32, 5, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 60, 1280, 800, 12048, 200, 64, 24, 1, 136, 3, 0,\n\t\tFB_VMODE_NONINTERLACED },\n\n\t \n\t{ NULL, 50, 720, 576, 74074, 64, 16, 39, 5, 64, 5, 0,\n\t\tFB_VMODE_INTERLACED },\n\n\t \n\t{ NULL, 50, 800, 520, 58823, 144, 64, 72, 28, 80, 5, 0,\n\t\tFB_VMODE_INTERLACED },\n\n\t \n\t{ NULL, 60, 864, 480, 27777, 1, 1, 1, 1, 0, 0,\n\t\t0, FB_VMODE_NONINTERLACED },\n};\n\n#ifdef CONFIG_FB_MODE_HELPERS\nconst struct fb_videomode vesa_modes[] = {\n\t \n\t{ NULL, 85, 640, 350, 31746,  96, 32, 60, 32, 64, 3,\n\t  FB_SYNC_HOR_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA},\n\t \n\t{ NULL, 85, 640, 400, 31746,  96, 32, 41, 01, 64, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 721, 400, 28169, 108, 36, 42, 01, 72, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 640, 480, 39682,  48, 16, 33, 10, 96, 2,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 72, 640, 480, 31746, 128, 24, 29, 9, 40, 2,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 640, 480, 31746, 120, 16, 16, 01, 64, 3,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 640, 480, 27777, 80, 56, 25, 01, 56, 3,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 56, 800, 600, 27777, 128, 24, 22, 01, 72, 2,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 800, 600, 25000, 88, 40, 23, 01, 128, 4,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 72, 800, 600, 20000, 64, 56, 23, 37, 120, 6,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 800, 600, 20202, 160, 16, 21, 01, 80, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 800, 600, 17761, 152, 32, 27, 01, 64, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n         \n\t{ NULL, 43, 1024, 768, 22271, 56, 8, 41, 0, 176, 8,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_INTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1024, 768, 15384, 160, 24, 29, 3, 136, 6,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 70, 1024, 768, 13333, 144, 24, 29, 3, 136, 6,\n\t  0, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1024, 768, 12690, 176, 16, 28, 1, 96, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 1024, 768, 10582, 208, 48, 36, 1, 96, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1152, 864, 9259, 256, 64, 32, 1, 128, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1280, 960, 9259, 312, 96, 36, 1, 112, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 1280, 960, 6734, 224, 64, 47, 1, 160, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1280, 1024, 9259, 248, 48, 38, 1, 112, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1280, 1024, 7407, 248, 16, 38, 1, 144, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 1280, 1024, 6349, 224, 64, 44, 1, 160, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1600, 1200, 6172, 304, 64, 46, 1, 192, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 65, 1600, 1200, 5698, 304,  64, 46, 1, 192, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 70, 1600, 1200, 5291, 304, 64, 46, 1, 192, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1600, 1200, 4938, 304, 64, 46, 1, 192, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 1600, 1200, 4357, 304, 64, 46, 1, 192, 3,\n\t  FB_SYNC_HOR_HIGH_ACT | FB_SYNC_VERT_HIGH_ACT,\n\t  FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1792, 1344, 4882, 328, 128, 46, 1, 200, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1792, 1344, 3831, 352, 96, 69, 1, 216, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1856, 1392, 4580, 352, 96, 43, 1, 224, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1856, 1392, 3472, 352, 128, 104, 1, 224, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1920, 1440, 4273, 344, 128, 56, 1, 200, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1920, 1440, 3367, 352, 144, 56, 1, 224, 3,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1920, 1200, 6493, 80, 48, 26, 3, 32, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 1920, 1200, 5174, 336, 136, 36, 3, 200, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 1920, 1200, 4077, 344, 136, 46, 3, 208, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 1920, 1200, 3555, 352, 144, 53, 3, 208, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 2560, 1600, 3724, 80, 48, 37, 3, 32, 6,\n\t  FB_SYNC_HOR_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 60, 2560, 1600, 2869, 472, 192, 49, 3, 280, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 75, 2560, 1600, 2256, 488, 208, 63, 3, 280, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 85, 2560, 1600, 1979, 488, 208, 73, 3, 280, 6,\n\t  FB_SYNC_VERT_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n\t \n\t{ NULL, 120, 2560, 1600, 1809, 80, 48, 85, 3, 32, 6,\n\t  FB_SYNC_HOR_HIGH_ACT, FB_VMODE_NONINTERLACED, FB_MODE_IS_VESA },\n};\nEXPORT_SYMBOL(vesa_modes);\n\nconst struct dmt_videomode dmt_modes[DMT_SIZE] = {\n\t{ 0x01, 0x0000, 0x000000, &vesa_modes[0] },\n\t{ 0x02, 0x3119, 0x000000, &vesa_modes[1] },\n\t{ 0x03, 0x0000, 0x000000, &vesa_modes[2] },\n\t{ 0x04, 0x3140, 0x000000, &vesa_modes[3] },\n\t{ 0x05, 0x314c, 0x000000, &vesa_modes[4] },\n\t{ 0x06, 0x314f, 0x000000, &vesa_modes[5] },\n\t{ 0x07, 0x3159, 0x000000, &vesa_modes[6] },\n\t{ 0x08, 0x0000, 0x000000, &vesa_modes[7] },\n\t{ 0x09, 0x4540, 0x000000, &vesa_modes[8] },\n\t{ 0x0a, 0x454c, 0x000000, &vesa_modes[9] },\n\t{ 0x0b, 0x454f, 0x000000, &vesa_modes[10] },\n\t{ 0x0c, 0x4559, 0x000000, &vesa_modes[11] },\n\t{ 0x0d, 0x0000, 0x000000, NULL },\n\t{ 0x0e, 0x0000, 0x000000, NULL },\n\t{ 0x0f, 0x0000, 0x000000, &vesa_modes[12] },\n\t{ 0x10, 0x6140, 0x000000, &vesa_modes[13] },\n\t{ 0x11, 0x614a, 0x000000, &vesa_modes[14] },\n\t{ 0x12, 0x614f, 0x000000, &vesa_modes[15] },\n\t{ 0x13, 0x6159, 0x000000, &vesa_modes[16] },\n\t{ 0x14, 0x0000, 0x000000, NULL },\n\t{ 0x15, 0x714f, 0x000000, &vesa_modes[17] },\n\t{ 0x16, 0x0000, 0x7f1c21, NULL },\n\t{ 0x17, 0x0000, 0x7f1c28, NULL },\n\t{ 0x18, 0x0000, 0x7f1c44, NULL },\n\t{ 0x19, 0x0000, 0x7f1c62, NULL },\n\t{ 0x1a, 0x0000, 0x000000, NULL },\n\t{ 0x1b, 0x0000, 0x8f1821, NULL },\n\t{ 0x1c, 0x8100, 0x8f1828, NULL },\n\t{ 0x1d, 0x810f, 0x8f1844, NULL },\n\t{ 0x1e, 0x8119, 0x8f1862, NULL },\n\t{ 0x1f, 0x0000, 0x000000, NULL },\n\t{ 0x20, 0x8140, 0x000000, &vesa_modes[18] },\n\t{ 0x21, 0x8159, 0x000000, &vesa_modes[19] },\n\t{ 0x22, 0x0000, 0x000000, NULL },\n\t{ 0x23, 0x8180, 0x000000, &vesa_modes[20] },\n\t{ 0x24, 0x818f, 0x000000, &vesa_modes[21] },\n\t{ 0x25, 0x8199, 0x000000, &vesa_modes[22] },\n\t{ 0x26, 0x0000, 0x000000, NULL },\n\t{ 0x27, 0x0000, 0x000000, NULL },\n\t{ 0x28, 0x0000, 0x000000, NULL },\n\t{ 0x29, 0x0000, 0x0c2021, NULL },\n\t{ 0x2a, 0x9040, 0x0c2028, NULL },\n\t{ 0x2b, 0x904f, 0x0c2044, NULL },\n\t{ 0x2c, 0x9059, 0x0c2062, NULL },\n\t{ 0x2d, 0x0000, 0x000000, NULL },\n\t{ 0x2e, 0x9500, 0xc11821, NULL },\n\t{ 0x2f, 0x9500, 0xc11828, NULL },\n\t{ 0x30, 0x950f, 0xc11844, NULL },\n\t{ 0x31, 0x9519, 0xc11868, NULL },\n\t{ 0x32, 0x0000, 0x000000, NULL },\n\t{ 0x33, 0xa940, 0x000000, &vesa_modes[23] },\n\t{ 0x34, 0xa945, 0x000000, &vesa_modes[24] },\n\t{ 0x35, 0xa94a, 0x000000, &vesa_modes[25] },\n\t{ 0x36, 0xa94f, 0x000000, &vesa_modes[26] },\n\t{ 0x37, 0xa959, 0x000000, &vesa_modes[27] },\n\t{ 0x38, 0x0000, 0x000000, NULL },\n\t{ 0x39, 0x0000, 0x0c2821, NULL },\n\t{ 0x3a, 0xb300, 0x0c2828, NULL },\n\t{ 0x3b, 0xb30f, 0x0c2844, NULL },\n\t{ 0x3c, 0xb319, 0x0c2868, NULL },\n\t{ 0x3d, 0x0000, 0x000000, NULL },\n\t{ 0x3e, 0xc140, 0x000000, &vesa_modes[28] },\n\t{ 0x3f, 0xc14f, 0x000000, &vesa_modes[29] },\n\t{ 0x40, 0x0000, 0x000000, NULL},\n\t{ 0x41, 0xc940, 0x000000, &vesa_modes[30] },\n\t{ 0x42, 0xc94f, 0x000000, &vesa_modes[31] },\n\t{ 0x43, 0x0000, 0x000000, NULL },\n\t{ 0x44, 0x0000, 0x572821, &vesa_modes[34] },\n\t{ 0x45, 0xd100, 0x572828, &vesa_modes[35] },\n\t{ 0x46, 0xd10f, 0x572844, &vesa_modes[36] },\n\t{ 0x47, 0xd119, 0x572862, &vesa_modes[37] },\n\t{ 0x48, 0x0000, 0x000000, NULL },\n\t{ 0x49, 0xd140, 0x000000, &vesa_modes[32] },\n\t{ 0x4a, 0xd14f, 0x000000, &vesa_modes[33] },\n\t{ 0x4b, 0x0000, 0x000000, NULL },\n\t{ 0x4c, 0x0000, 0x1f3821, &vesa_modes[38] },\n\t{ 0x4d, 0x0000, 0x1f3828, &vesa_modes[39] },\n\t{ 0x4e, 0x0000, 0x1f3844, &vesa_modes[40] },\n\t{ 0x4f, 0x0000, 0x1f3862, &vesa_modes[41] },\n\t{ 0x50, 0x0000, 0x000000, &vesa_modes[42] },\n};\nEXPORT_SYMBOL(dmt_modes);\n#endif  \n\n \n\nstatic int fb_try_mode(struct fb_var_screeninfo *var, struct fb_info *info,\n\t\t       const struct fb_videomode *mode, unsigned int bpp)\n{\n\tint err = 0;\n\n\tDPRINTK(\"Trying mode %s %dx%d-%d@%d\\n\",\n\t\tmode->name ? mode->name : \"noname\",\n\t\tmode->xres, mode->yres, bpp, mode->refresh);\n\tvar->xres = mode->xres;\n\tvar->yres = mode->yres;\n\tvar->xres_virtual = mode->xres;\n\tvar->yres_virtual = mode->yres;\n\tvar->xoffset = 0;\n\tvar->yoffset = 0;\n\tvar->bits_per_pixel = bpp;\n\tvar->activate |= FB_ACTIVATE_TEST;\n\tvar->pixclock = mode->pixclock;\n\tvar->left_margin = mode->left_margin;\n\tvar->right_margin = mode->right_margin;\n\tvar->upper_margin = mode->upper_margin;\n\tvar->lower_margin = mode->lower_margin;\n\tvar->hsync_len = mode->hsync_len;\n\tvar->vsync_len = mode->vsync_len;\n\tvar->sync = mode->sync;\n\tvar->vmode = mode->vmode;\n\tif (info->fbops->fb_check_var)\n\t\terr = info->fbops->fb_check_var(var, info);\n\tvar->activate &= ~FB_ACTIVATE_TEST;\n\treturn err;\n}\n\n \n\nint fb_find_mode(struct fb_var_screeninfo *var,\n\t\t struct fb_info *info, const char *mode_option,\n\t\t const struct fb_videomode *db, unsigned int dbsize,\n\t\t const struct fb_videomode *default_mode,\n\t\t unsigned int default_bpp)\n{\n\tchar *mode_option_buf = NULL;\n\tint i;\n\n\t \n\tif (!db) {\n\t\tdb = modedb;\n\t\tdbsize = ARRAY_SIZE(modedb);\n\t}\n\n\tif (!default_mode)\n\t\tdefault_mode = &db[0];\n\n\tif (!default_bpp)\n\t\tdefault_bpp = 8;\n\n\t \n\tif (!mode_option) {\n\t\tfb_get_options(NULL, &mode_option_buf);\n\t\tmode_option = mode_option_buf;\n\t}\n\tif (mode_option) {\n\t\tconst char *name = mode_option;\n\t\tunsigned int namelen = strlen(name);\n\t\tint res_specified = 0, bpp_specified = 0, refresh_specified = 0;\n\t\tunsigned int xres = 0, yres = 0, bpp = default_bpp, refresh = 0;\n\t\tint yres_specified = 0, cvt = 0, rb = 0;\n\t\tint interlace_specified = 0, interlace = 0;\n\t\tint margins = 0;\n\t\tu32 best, diff, tdiff;\n\n\t\tfor (i = namelen-1; i >= 0; i--) {\n\t\t\tswitch (name[i]) {\n\t\t\tcase '@':\n\t\t\t\tnamelen = i;\n\t\t\t\tif (!refresh_specified && !bpp_specified &&\n\t\t\t\t    !yres_specified) {\n\t\t\t\t\trefresh = simple_strtol(&name[i+1], NULL,\n\t\t\t\t\t\t\t\t10);\n\t\t\t\t\trefresh_specified = 1;\n\t\t\t\t\tif (cvt || rb)\n\t\t\t\t\t\tcvt = 0;\n\t\t\t\t} else\n\t\t\t\t\tgoto done;\n\t\t\t\tbreak;\n\t\t\tcase '-':\n\t\t\t\tnamelen = i;\n\t\t\t\tif (!bpp_specified && !yres_specified) {\n\t\t\t\t\tbpp = simple_strtol(&name[i+1], NULL,\n\t\t\t\t\t\t\t    10);\n\t\t\t\t\tbpp_specified = 1;\n\t\t\t\t\tif (cvt || rb)\n\t\t\t\t\t\tcvt = 0;\n\t\t\t\t} else\n\t\t\t\t\tgoto done;\n\t\t\t\tbreak;\n\t\t\tcase 'x':\n\t\t\t\tif (!yres_specified) {\n\t\t\t\t\tyres = simple_strtol(&name[i+1], NULL,\n\t\t\t\t\t\t\t     10);\n\t\t\t\t\tyres_specified = 1;\n\t\t\t\t} else\n\t\t\t\t\tgoto done;\n\t\t\t\tbreak;\n\t\t\tcase '0' ... '9':\n\t\t\t\tbreak;\n\t\t\tcase 'M':\n\t\t\t\tif (!yres_specified)\n\t\t\t\t\tcvt = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'R':\n\t\t\t\tif (!cvt)\n\t\t\t\t\trb = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'm':\n\t\t\t\tif (!cvt)\n\t\t\t\t\tmargins = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'p':\n\t\t\t\tif (!cvt) {\n\t\t\t\t\tinterlace = 0;\n\t\t\t\t\tinterlace_specified = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'i':\n\t\t\t\tif (!cvt) {\n\t\t\t\t\tinterlace = 1;\n\t\t\t\t\tinterlace_specified = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t\tif (i < 0 && yres_specified) {\n\t\t\txres = simple_strtol(name, NULL, 10);\n\t\t\tres_specified = 1;\n\t\t}\ndone:\n\t\tkfree(mode_option_buf);\n\t\tif (cvt) {\n\t\t\tstruct fb_videomode cvt_mode;\n\t\t\tint ret;\n\n\t\t\tDPRINTK(\"CVT mode %dx%d@%dHz%s%s%s\\n\", xres, yres,\n\t\t\t\t(refresh) ? refresh : 60,\n\t\t\t\t(rb) ? \" reduced blanking\" : \"\",\n\t\t\t\t(margins) ? \" with margins\" : \"\",\n\t\t\t\t(interlace) ? \" interlaced\" : \"\");\n\n\t\t\tmemset(&cvt_mode, 0, sizeof(cvt_mode));\n\t\t\tcvt_mode.xres = xres;\n\t\t\tcvt_mode.yres = yres;\n\t\t\tcvt_mode.refresh = (refresh) ? refresh : 60;\n\n\t\t\tif (interlace)\n\t\t\t\tcvt_mode.vmode |= FB_VMODE_INTERLACED;\n\t\t\telse\n\t\t\t\tcvt_mode.vmode &= ~FB_VMODE_INTERLACED;\n\n\t\t\tret = fb_find_mode_cvt(&cvt_mode, margins, rb);\n\n\t\t\tif (!ret && !fb_try_mode(var, info, &cvt_mode, bpp)) {\n\t\t\t\tDPRINTK(\"modedb CVT: CVT mode ok\\n\");\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tDPRINTK(\"CVT mode invalid, getting mode from database\\n\");\n\t\t}\n\n\t\tDPRINTK(\"Trying specified video mode%s %ix%i\\n\",\n\t\t\trefresh_specified ? \"\" : \" (ignoring refresh rate)\",\n\t\t\txres, yres);\n\n\t\tif (!refresh_specified) {\n\t\t\t \n\t\t\tif (db != modedb &&\n\t\t\t    info->monspecs.vfmin && info->monspecs.vfmax &&\n\t\t\t    info->monspecs.hfmin && info->monspecs.hfmax &&\n\t\t\t    info->monspecs.dclkmax) {\n\t\t\t\trefresh = 1000;\n\t\t\t} else {\n\t\t\t\trefresh = 60;\n\t\t\t}\n\t\t}\n\n\t\tdiff = -1;\n\t\tbest = -1;\n\t\tfor (i = 0; i < dbsize; i++) {\n\t\t\tif ((name_matches(db[i], name, namelen) ||\n\t\t\t     (res_specified && res_matches(db[i], xres, yres))) &&\n\t\t\t    !fb_try_mode(var, info, &db[i], bpp)) {\n\t\t\t\tconst int db_interlace = (db[i].vmode &\n\t\t\t\t\tFB_VMODE_INTERLACED ? 1 : 0);\n\t\t\t\tint score = abs(db[i].refresh - refresh);\n\n\t\t\t\tif (interlace_specified)\n\t\t\t\t\tscore += abs(db_interlace - interlace);\n\n\t\t\t\tif (!interlace_specified ||\n\t\t\t\t    db_interlace == interlace)\n\t\t\t\t\tif (refresh_specified &&\n\t\t\t\t\t    db[i].refresh == refresh)\n\t\t\t\t\t\treturn 1;\n\n\t\t\t\tif (score < diff) {\n\t\t\t\t\tdiff = score;\n\t\t\t\t\tbest = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (best != -1) {\n\t\t\tfb_try_mode(var, info, &db[best], bpp);\n\t\t\treturn (refresh_specified) ? 2 : 1;\n\t\t}\n\n\t\tdiff = 2 * (xres + yres);\n\t\tbest = -1;\n\t\tDPRINTK(\"Trying best-fit modes\\n\");\n\t\tfor (i = 0; i < dbsize; i++) {\n\t\t\tDPRINTK(\"Trying %ix%i\\n\", db[i].xres, db[i].yres);\n\t\t\tif (!fb_try_mode(var, info, &db[i], bpp)) {\n\t\t\t\ttdiff = abs(db[i].xres - xres) +\n\t\t\t\t\tabs(db[i].yres - yres);\n\n\t\t\t\t \n\t\t\t\tif (xres > db[i].xres || yres > db[i].yres)\n\t\t\t\t\ttdiff += xres + yres;\n\n\t\t\t\tif (diff > tdiff) {\n\t\t\t\t\tdiff = tdiff;\n\t\t\t\t\tbest = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (best != -1) {\n\t\t\tfb_try_mode(var, info, &db[best], bpp);\n\t\t\treturn 5;\n\t\t}\n\t}\n\n\tDPRINTK(\"Trying default video mode\\n\");\n\tif (!fb_try_mode(var, info, default_mode, default_bpp))\n\t\treturn 3;\n\n\tDPRINTK(\"Trying all modes\\n\");\n\tfor (i = 0; i < dbsize; i++)\n\t\tif (!fb_try_mode(var, info, &db[i], default_bpp))\n\t\t\treturn 4;\n\n\tDPRINTK(\"No valid mode found\\n\");\n\treturn 0;\n}\n\n \nvoid fb_var_to_videomode(struct fb_videomode *mode,\n\t\t\t const struct fb_var_screeninfo *var)\n{\n\tu32 pixclock, hfreq, htotal, vtotal;\n\n\tmode->name = NULL;\n\tmode->xres = var->xres;\n\tmode->yres = var->yres;\n\tmode->pixclock = var->pixclock;\n\tmode->hsync_len = var->hsync_len;\n\tmode->vsync_len = var->vsync_len;\n\tmode->left_margin = var->left_margin;\n\tmode->right_margin = var->right_margin;\n\tmode->upper_margin = var->upper_margin;\n\tmode->lower_margin = var->lower_margin;\n\tmode->sync = var->sync;\n\tmode->vmode = var->vmode & FB_VMODE_MASK;\n\tmode->flag = FB_MODE_IS_FROM_VAR;\n\tmode->refresh = 0;\n\n\tif (!var->pixclock)\n\t\treturn;\n\n\tpixclock = PICOS2KHZ(var->pixclock) * 1000;\n\n\thtotal = var->xres + var->right_margin + var->hsync_len +\n\t\tvar->left_margin;\n\tvtotal = var->yres + var->lower_margin + var->vsync_len +\n\t\tvar->upper_margin;\n\n\tif (var->vmode & FB_VMODE_INTERLACED)\n\t\tvtotal /= 2;\n\tif (var->vmode & FB_VMODE_DOUBLE)\n\t\tvtotal *= 2;\n\n\tif (!htotal || !vtotal)\n\t\treturn;\n\n\thfreq = pixclock/htotal;\n\tmode->refresh = hfreq/vtotal;\n}\n\n \nvoid fb_videomode_to_var(struct fb_var_screeninfo *var,\n\t\t\t const struct fb_videomode *mode)\n{\n\tvar->xres = mode->xres;\n\tvar->yres = mode->yres;\n\tvar->xres_virtual = mode->xres;\n\tvar->yres_virtual = mode->yres;\n\tvar->xoffset = 0;\n\tvar->yoffset = 0;\n\tvar->pixclock = mode->pixclock;\n\tvar->left_margin = mode->left_margin;\n\tvar->right_margin = mode->right_margin;\n\tvar->upper_margin = mode->upper_margin;\n\tvar->lower_margin = mode->lower_margin;\n\tvar->hsync_len = mode->hsync_len;\n\tvar->vsync_len = mode->vsync_len;\n\tvar->sync = mode->sync;\n\tvar->vmode = mode->vmode & FB_VMODE_MASK;\n}\n\n \nint fb_mode_is_equal(const struct fb_videomode *mode1,\n\t\t     const struct fb_videomode *mode2)\n{\n\treturn (mode1->xres         == mode2->xres &&\n\t\tmode1->yres         == mode2->yres &&\n\t\tmode1->pixclock     == mode2->pixclock &&\n\t\tmode1->hsync_len    == mode2->hsync_len &&\n\t\tmode1->vsync_len    == mode2->vsync_len &&\n\t\tmode1->left_margin  == mode2->left_margin &&\n\t\tmode1->right_margin == mode2->right_margin &&\n\t\tmode1->upper_margin == mode2->upper_margin &&\n\t\tmode1->lower_margin == mode2->lower_margin &&\n\t\tmode1->sync         == mode2->sync &&\n\t\tmode1->vmode        == mode2->vmode);\n}\n\n \nconst struct fb_videomode *fb_find_best_mode(const struct fb_var_screeninfo *var,\n\t\t\t\t\t     struct list_head *head)\n{\n\tstruct fb_modelist *modelist;\n\tstruct fb_videomode *mode, *best = NULL;\n\tu32 diff = -1;\n\n\tlist_for_each_entry(modelist, head, list) {\n\t\tu32 d;\n\t\tmode = &modelist->mode;\n\n\t\tif (mode->xres >= var->xres && mode->yres >= var->yres) {\n\t\t\td = (mode->xres - var->xres) +\n\t\t\t\t(mode->yres - var->yres);\n\t\t\tif (diff > d) {\n\t\t\t\tdiff = d;\n\t\t\t\tbest = mode;\n\t\t\t} else if (diff == d && best &&\n\t\t\t\t   mode->refresh > best->refresh)\n\t\t\t\tbest = mode;\n\t\t}\n\t}\n\treturn best;\n}\n\n \nconst struct fb_videomode *fb_find_nearest_mode(const struct fb_videomode *mode,\n\t\t\t\t\t        struct list_head *head)\n{\n\tstruct fb_modelist *modelist;\n\tstruct fb_videomode *cmode, *best = NULL;\n\tu32 diff = -1, diff_refresh = -1;\n\n\tlist_for_each_entry(modelist, head, list) {\n\t\tu32 d;\n\t\tcmode = &modelist->mode;\n\n\t\td = abs(cmode->xres - mode->xres) +\n\t\t\tabs(cmode->yres - mode->yres);\n\t\tif (diff > d) {\n\t\t\tdiff = d;\n\t\t\tdiff_refresh = abs(cmode->refresh - mode->refresh);\n\t\t\tbest = cmode;\n\t\t} else if (diff == d) {\n\t\t\td = abs(cmode->refresh - mode->refresh);\n\t\t\tif (diff_refresh > d) {\n\t\t\t\tdiff_refresh = d;\n\t\t\t\tbest = cmode;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn best;\n}\n\n \nconst struct fb_videomode *fb_match_mode(const struct fb_var_screeninfo *var,\n\t\t\t\t\t struct list_head *head)\n{\n\tstruct fb_modelist *modelist;\n\tstruct fb_videomode *m, mode;\n\n\tfb_var_to_videomode(&mode, var);\n\tlist_for_each_entry(modelist, head, list) {\n\t\tm = &modelist->mode;\n\t\tif (fb_mode_is_equal(m, &mode))\n\t\t\treturn m;\n\t}\n\treturn NULL;\n}\n\n \nint fb_add_videomode(const struct fb_videomode *mode, struct list_head *head)\n{\n\tstruct fb_modelist *modelist;\n\tstruct fb_videomode *m;\n\tint found = 0;\n\n\tlist_for_each_entry(modelist, head, list) {\n\t\tm = &modelist->mode;\n\t\tif (fb_mode_is_equal(m, mode)) {\n\t\t\tfound = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!found) {\n\t\tmodelist = kmalloc(sizeof(struct fb_modelist),\n\t\t\t\t\t\t  GFP_KERNEL);\n\n\t\tif (!modelist)\n\t\t\treturn -ENOMEM;\n\t\tmodelist->mode = *mode;\n\t\tlist_add(&modelist->list, head);\n\t}\n\treturn 0;\n}\n\n \nvoid fb_delete_videomode(const struct fb_videomode *mode,\n\t\t\t struct list_head *head)\n{\n\tstruct list_head *pos, *n;\n\tstruct fb_modelist *modelist;\n\tstruct fb_videomode *m;\n\n\tlist_for_each_safe(pos, n, head) {\n\t\tmodelist = list_entry(pos, struct fb_modelist, list);\n\t\tm = &modelist->mode;\n\t\tif (fb_mode_is_equal(m, mode)) {\n\t\t\tlist_del(pos);\n\t\t\tkfree(pos);\n\t\t}\n\t}\n}\n\n \nvoid fb_destroy_modelist(struct list_head *head)\n{\n\tstruct list_head *pos, *n;\n\n\tlist_for_each_safe(pos, n, head) {\n\t\tlist_del(pos);\n\t\tkfree(pos);\n\t}\n}\nEXPORT_SYMBOL_GPL(fb_destroy_modelist);\n\n \nvoid fb_videomode_to_modelist(const struct fb_videomode *modedb, int num,\n\t\t\t      struct list_head *head)\n{\n\tint i;\n\n\tINIT_LIST_HEAD(head);\n\n\tfor (i = 0; i < num; i++) {\n\t\tif (fb_add_videomode(&modedb[i], head))\n\t\t\treturn;\n\t}\n}\n\nconst struct fb_videomode *fb_find_best_display(const struct fb_monspecs *specs,\n\t\t\t\t\t        struct list_head *head)\n{\n\tstruct fb_modelist *modelist;\n\tconst struct fb_videomode *m, *m1 = NULL, *md = NULL, *best = NULL;\n\tint first = 0;\n\n\tif (!head->prev || !head->next || list_empty(head))\n\t\tgoto finished;\n\n\t \n\tlist_for_each_entry(modelist, head, list) {\n\t\tm = &modelist->mode;\n\n\t\tif (!first) {\n\t\t\tm1 = m;\n\t\t\tfirst = 1;\n\t\t}\n\n\t\tif (m->flag & FB_MODE_IS_FIRST) {\n \t\t\tmd = m;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t \n\tif (specs->misc & FB_MISC_1ST_DETAIL) {\n\t\tbest = md;\n\t\tgoto finished;\n\t}\n\n\t \n\tif (specs->max_x && specs->max_y) {\n\t\tstruct fb_var_screeninfo var;\n\n\t\tmemset(&var, 0, sizeof(struct fb_var_screeninfo));\n\t\tvar.xres = (specs->max_x * 7200)/254;\n\t\tvar.yres = (specs->max_y * 7200)/254;\n\t\tm = fb_find_best_mode(&var, head);\n\t\tif (m) {\n\t\t\tbest = m;\n\t\t\tgoto finished;\n\t\t}\n\t}\n\n\t \n\tif (md) {\n\t\tbest = md;\n\t\tgoto finished;\n\t}\n\n\t \n\tbest = m1;\nfinished:\n\treturn best;\n}\nEXPORT_SYMBOL(fb_find_best_display);\n\nEXPORT_SYMBOL(fb_videomode_to_var);\nEXPORT_SYMBOL(fb_var_to_videomode);\nEXPORT_SYMBOL(fb_mode_is_equal);\nEXPORT_SYMBOL(fb_add_videomode);\nEXPORT_SYMBOL(fb_match_mode);\nEXPORT_SYMBOL(fb_find_best_mode);\nEXPORT_SYMBOL(fb_find_nearest_mode);\nEXPORT_SYMBOL(fb_videomode_to_modelist);\nEXPORT_SYMBOL(fb_find_mode);\nEXPORT_SYMBOL(fb_find_mode_cvt);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}