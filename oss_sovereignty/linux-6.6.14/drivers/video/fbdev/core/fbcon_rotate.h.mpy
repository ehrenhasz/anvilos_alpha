{
  "module_name": "fbcon_rotate.h",
  "hash_id": "6a4c58809ebeb519c7a82a2a70f24568c5abcb3d177fba82c9b6d1e282936e5b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/core/fbcon_rotate.h",
  "human_readable_source": " \n\n#ifndef _FBCON_ROTATE_H\n#define _FBCON_ROTATE_H\n\n#define GETVYRES(s,i) ({                           \\\n        (fb_scrollmode(s) == SCROLL_REDRAW || fb_scrollmode(s) == SCROLL_MOVE) ? \\\n        (i)->var.yres : (i)->var.yres_virtual; })\n\n#define GETVXRES(s,i) ({                           \\\n        (fb_scrollmode(s) == SCROLL_REDRAW || fb_scrollmode(s) == SCROLL_MOVE || !(i)->fix.xpanstep) ? \\\n        (i)->var.xres : (i)->var.xres_virtual; })\n\n\nstatic inline int pattern_test_bit(u32 x, u32 y, u32 pitch, const char *pat)\n{\n\tu32 tmp = (y * pitch) + x, index = tmp / 8,  bit = tmp % 8;\n\n\tpat +=index;\n\treturn (*pat) & (0x80 >> bit);\n}\n\nstatic inline void pattern_set_bit(u32 x, u32 y, u32 pitch, char *pat)\n{\n\tu32 tmp = (y * pitch) + x, index = tmp / 8, bit = tmp % 8;\n\n\tpat += index;\n\n\t(*pat) |= 0x80 >> bit;\n}\n\nstatic inline void rotate_ud(const char *in, char *out, u32 width, u32 height)\n{\n\tint i, j;\n\tint shift = (8 - (width % 8)) & 7;\n\n\twidth = (width + 7) & ~7;\n\n\tfor (i = 0; i < height; i++) {\n\t\tfor (j = 0; j < width - shift; j++) {\n\t\t\tif (pattern_test_bit(j, i, width, in))\n\t\t\t\tpattern_set_bit(width - (1 + j + shift),\n\t\t\t\t\t\theight - (1 + i),\n\t\t\t\t\t\twidth, out);\n\t\t}\n\n\t}\n}\n\nstatic inline void rotate_cw(const char *in, char *out, u32 width, u32 height)\n{\n\tint i, j, h = height, w = width;\n\tint shift = (8 - (height % 8)) & 7;\n\n\twidth = (width + 7) & ~7;\n\theight = (height + 7) & ~7;\n\n\tfor (i = 0; i < h; i++) {\n\t\tfor (j = 0; j < w; j++) {\n\t\t\tif (pattern_test_bit(j, i, width, in))\n\t\t\t\tpattern_set_bit(height - 1 - i - shift, j,\n\t\t\t\t\t\theight, out);\n\n\t\t}\n\t}\n}\n\nstatic inline void rotate_ccw(const char *in, char *out, u32 width, u32 height)\n{\n\tint i, j, h = height, w = width;\n\tint shift = (8 - (width % 8)) & 7;\n\n\twidth = (width + 7) & ~7;\n\theight = (height + 7) & ~7;\n\n\tfor (i = 0; i < h; i++) {\n\t\tfor (j = 0; j < w; j++) {\n\t\t\tif (pattern_test_bit(j, i, width, in))\n\t\t\t\tpattern_set_bit(i, width - 1 - j - shift,\n\t\t\t\t\t\theight, out);\n\t\t}\n\t}\n}\n\nextern void fbcon_rotate_cw(struct fbcon_ops *ops);\nextern void fbcon_rotate_ud(struct fbcon_ops *ops);\nextern void fbcon_rotate_ccw(struct fbcon_ops *ops);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}