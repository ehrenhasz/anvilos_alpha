{
  "module_name": "fb_draw.h",
  "hash_id": "a04f8d77095a8f358c7d9e74e0d9df8396aa97f94ee41d4bd724951d8a49d62e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/core/fb_draw.h",
  "human_readable_source": " \n#ifndef _FB_DRAW_H\n#define _FB_DRAW_H\n\n#include <asm/types.h>\n#include <linux/fb.h>\n#include <linux/bug.h>\n\n     \n\nstatic inline unsigned long\ncomp(unsigned long a, unsigned long b, unsigned long mask)\n{\n    return ((a ^ b) & mask) ^ b;\n}\n\n     \n\n#if BITS_PER_LONG == 64\nstatic inline unsigned long\npixel_to_pat( u32 bpp, u32 pixel)\n{\n\tswitch (bpp) {\n\tcase 1:\n\t\treturn 0xfffffffffffffffful*pixel;\n\tcase 2:\n\t\treturn 0x5555555555555555ul*pixel;\n\tcase 4:\n\t\treturn 0x1111111111111111ul*pixel;\n\tcase 8:\n\t\treturn 0x0101010101010101ul*pixel;\n\tcase 12:\n\t\treturn 0x1001001001001001ul*pixel;\n\tcase 16:\n\t\treturn 0x0001000100010001ul*pixel;\n\tcase 24:\n\t\treturn 0x0001000001000001ul*pixel;\n\tcase 32:\n\t\treturn 0x0000000100000001ul*pixel;\n\tdefault:\n\t\tWARN(1, \"pixel_to_pat(): unsupported pixelformat %d\\n\", bpp);\n\t\treturn 0;\n    }\n}\n#else\nstatic inline unsigned long\npixel_to_pat( u32 bpp, u32 pixel)\n{\n\tswitch (bpp) {\n\tcase 1:\n\t\treturn 0xfffffffful*pixel;\n\tcase 2:\n\t\treturn 0x55555555ul*pixel;\n\tcase 4:\n\t\treturn 0x11111111ul*pixel;\n\tcase 8:\n\t\treturn 0x01010101ul*pixel;\n\tcase 12:\n\t\treturn 0x01001001ul*pixel;\n\tcase 16:\n\t\treturn 0x00010001ul*pixel;\n\tcase 24:\n\t\treturn 0x01000001ul*pixel;\n\tcase 32:\n\t\treturn 0x00000001ul*pixel;\n\tdefault:\n\t\tWARN(1, \"pixel_to_pat(): unsupported pixelformat %d\\n\", bpp);\n\t\treturn 0;\n    }\n}\n#endif\n\n#ifdef CONFIG_FB_CFB_REV_PIXELS_IN_BYTE\n#if BITS_PER_LONG == 64\n#define REV_PIXELS_MASK1 0x5555555555555555ul\n#define REV_PIXELS_MASK2 0x3333333333333333ul\n#define REV_PIXELS_MASK4 0x0f0f0f0f0f0f0f0ful\n#else\n#define REV_PIXELS_MASK1 0x55555555ul\n#define REV_PIXELS_MASK2 0x33333333ul\n#define REV_PIXELS_MASK4 0x0f0f0f0ful\n#endif\n\nstatic inline unsigned long fb_rev_pixels_in_long(unsigned long val,\n\t\t\t\t\t\t  u32 bswapmask)\n{\n\tif (bswapmask & 1)\n\t\tval = comp(val >> 1, val << 1, REV_PIXELS_MASK1);\n\tif (bswapmask & 2)\n\t\tval = comp(val >> 2, val << 2, REV_PIXELS_MASK2);\n\tif (bswapmask & 3)\n\t\tval = comp(val >> 4, val << 4, REV_PIXELS_MASK4);\n\treturn val;\n}\n\nstatic inline u32 fb_shifted_pixels_mask_u32(struct fb_info *p, u32 index,\n\t\t\t\t\t     u32 bswapmask)\n{\n\tu32 mask;\n\n\tif (!bswapmask) {\n\t\tmask = FB_SHIFT_HIGH(p, ~(u32)0, index);\n\t} else {\n\t\tmask = 0xff << FB_LEFT_POS(p, 8);\n\t\tmask = FB_SHIFT_LOW(p, mask, index & (bswapmask)) & mask;\n\t\tmask = FB_SHIFT_HIGH(p, mask, index & ~(bswapmask));\n#if defined(__i386__) || defined(__x86_64__)\n\t\t \n\t\tif(index + bswapmask < 32)\n#endif\n\t\t\tmask |= FB_SHIFT_HIGH(p, ~(u32)0,\n\t\t\t\t\t(index + bswapmask) & ~(bswapmask));\n\t}\n\treturn mask;\n}\n\nstatic inline unsigned long fb_shifted_pixels_mask_long(struct fb_info *p,\n\t\t\t\t\t\t\tu32 index,\n\t\t\t\t\t\t\tu32 bswapmask)\n{\n\tunsigned long mask;\n\n\tif (!bswapmask) {\n\t\tmask = FB_SHIFT_HIGH(p, ~0UL, index);\n\t} else {\n\t\tmask = 0xff << FB_LEFT_POS(p, 8);\n\t\tmask = FB_SHIFT_LOW(p, mask, index & (bswapmask)) & mask;\n\t\tmask = FB_SHIFT_HIGH(p, mask, index & ~(bswapmask));\n#if defined(__i386__) || defined(__x86_64__)\n\t\t \n\t\tif(index + bswapmask < BITS_PER_LONG)\n#endif\n\t\t\tmask |= FB_SHIFT_HIGH(p, ~0UL,\n\t\t\t\t\t(index + bswapmask) & ~(bswapmask));\n\t}\n\treturn mask;\n}\n\n\nstatic inline u32 fb_compute_bswapmask(struct fb_info *info)\n{\n\tu32 bswapmask = 0;\n\tunsigned bpp = info->var.bits_per_pixel;\n\n\tif ((bpp < 8) && (info->var.nonstd & FB_NONSTD_REV_PIX_IN_B)) {\n\t\t \n\t\tbswapmask = 7 - bpp + 1;\n\t}\n\treturn bswapmask;\n}\n\n#else  \n\nstatic inline unsigned long fb_rev_pixels_in_long(unsigned long val,\n\t\t\t\t\t\t  u32 bswapmask)\n{\n\treturn val;\n}\n\n#define fb_shifted_pixels_mask_u32(p, i, b) FB_SHIFT_HIGH((p), ~(u32)0, (i))\n#define fb_shifted_pixels_mask_long(p, i, b) FB_SHIFT_HIGH((p), ~0UL, (i))\n#define fb_compute_bswapmask(...) 0\n\n#endif   \n\n#define cpu_to_le_long _cpu_to_le_long(BITS_PER_LONG)\n#define _cpu_to_le_long(x) __cpu_to_le_long(x)\n#define __cpu_to_le_long(x) cpu_to_le##x\n\n#define le_long_to_cpu _le_long_to_cpu(BITS_PER_LONG)\n#define _le_long_to_cpu(x) __le_long_to_cpu(x)\n#define __le_long_to_cpu(x) le##x##_to_cpu\n\nstatic inline unsigned long rolx(unsigned long word, unsigned int shift, unsigned int x)\n{\n\treturn (word << shift) | (word >> (x - shift));\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}