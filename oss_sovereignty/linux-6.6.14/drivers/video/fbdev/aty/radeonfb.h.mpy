{
  "module_name": "radeonfb.h",
  "hash_id": "96908b153f55cc72d60a0c5cd992df9b54bc156d56607c2767bee3ed7382d279",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/aty/radeonfb.h",
  "human_readable_source": " \n#ifndef __RADEONFB_H__\n#define __RADEONFB_H__\n\n#ifdef CONFIG_FB_RADEON_DEBUG\n#define DEBUG\t\t1\n#endif\n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/fb.h>\n\n\n#ifdef CONFIG_FB_RADEON_I2C\n#include <linux/i2c.h>\n#include <linux/i2c-algo-bit.h>\n#endif\n\n#include <asm/io.h>\n\n#ifdef CONFIG_SPARC\n#include <asm/prom.h>\n#endif\n\n#include <video/radeon.h>\n\n \n\n\n \nenum radeon_family {\n\tCHIP_FAMILY_UNKNOW,\n\tCHIP_FAMILY_LEGACY,\n\tCHIP_FAMILY_RADEON,\n\tCHIP_FAMILY_RV100,\n\tCHIP_FAMILY_RS100,     \n\tCHIP_FAMILY_RV200,\n\tCHIP_FAMILY_RS200,     \n\tCHIP_FAMILY_R200,\n\tCHIP_FAMILY_RV250,\n\tCHIP_FAMILY_RS300,     \n\tCHIP_FAMILY_RV280,\n\tCHIP_FAMILY_R300,\n\tCHIP_FAMILY_R350,\n\tCHIP_FAMILY_RV350,\n\tCHIP_FAMILY_RV380,     \n\tCHIP_FAMILY_R420,      \n\tCHIP_FAMILY_RC410,\n\tCHIP_FAMILY_RS400,\n\tCHIP_FAMILY_RS480,\n\tCHIP_FAMILY_LAST,\n};\n\n#define IS_RV100_VARIANT(rinfo) (((rinfo)->family == CHIP_FAMILY_RV100)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RV200)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RS100)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RS200)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RV250)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RV280)  || \\\n\t\t\t\t ((rinfo)->family == CHIP_FAMILY_RS300))\n\n\n#define IS_R300_VARIANT(rinfo) (((rinfo)->family == CHIP_FAMILY_R300)  || \\\n\t\t\t\t((rinfo)->family == CHIP_FAMILY_RV350) || \\\n\t\t\t\t((rinfo)->family == CHIP_FAMILY_R350)  || \\\n\t\t\t\t((rinfo)->family == CHIP_FAMILY_RV380) || \\\n\t\t\t\t((rinfo)->family == CHIP_FAMILY_R420)  || \\\n                               ((rinfo)->family == CHIP_FAMILY_RC410) || \\\n                               ((rinfo)->family == CHIP_FAMILY_RS480))\n\n \nenum radeon_chip_flags {\n\tCHIP_FAMILY_MASK\t= 0x0000ffffUL,\n\tCHIP_FLAGS_MASK\t\t= 0xffff0000UL,\n\tCHIP_IS_MOBILITY\t= 0x00010000UL,\n\tCHIP_IS_IGP\t\t= 0x00020000UL,\n\tCHIP_HAS_CRTC2\t\t= 0x00040000UL,\t\n};\n\n \nenum radeon_errata {\n\tCHIP_ERRATA_R300_CG\t\t= 0x00000001,\n\tCHIP_ERRATA_PLL_DUMMYREADS\t= 0x00000002,\n\tCHIP_ERRATA_PLL_DELAY\t\t= 0x00000004,\n};\n\n\n \nenum radeon_montype {\n\tMT_NONE = 0,\n\tMT_CRT,\t\t \n\tMT_LCD,\t\t \n\tMT_DFP,\t\t \n\tMT_CTV,\t\t \n\tMT_STV\t\t \n};\n\n \nenum ddc_type {\n\tddc_none,\n\tddc_monid,\n\tddc_dvi,\n\tddc_vga,\n\tddc_crt2,\n};\n\n \nenum conn_type {\n\tconn_none,\n\tconn_proprietary,\n\tconn_crt,\n\tconn_DVI_I,\n\tconn_DVI_D,\n};\n\n\n \nstruct pll_info {\n\tint ppll_max;\n\tint ppll_min;\n\tint sclk, mclk;\n\tint ref_div;\n\tint ref_clk;\n};\n\n\n \nstruct radeon_regs {\n\t \n\tu32\t\tovr_clr;\n\tu32\t\tovr_wid_left_right;\n\tu32\t\tovr_wid_top_bottom;\n\tu32\t\tov0_scale_cntl;\n\tu32\t\tmpp_tb_config;\n\tu32\t\tmpp_gp_config;\n\tu32\t\tsubpic_cntl;\n\tu32\t\tviph_control;\n\tu32\t\ti2c_cntl_1;\n\tu32\t\tgen_int_cntl;\n\tu32\t\tcap0_trig_cntl;\n\tu32\t\tcap1_trig_cntl;\n\tu32\t\tbus_cntl;\n\tu32\t\tsurface_cntl;\n\tu32\t\tbios_5_scratch;\n\n\t \n\tu32\t\tdp_datatype;\n\tu32\t\trbbm_soft_reset;\n\tu32\t\tclock_cntl_index;\n\tu32\t\tamcgpio_en_reg;\n\tu32\t\tamcgpio_mask;\n\n\t \n\tu32\t\tsurf_lower_bound[8];\n\tu32\t\tsurf_upper_bound[8];\n\tu32\t\tsurf_info[8];\n\n\t \n\tu32\t\tcrtc_gen_cntl;\n\tu32\t\tcrtc_ext_cntl;\n\tu32\t\tdac_cntl;\n\tu32\t\tcrtc_h_total_disp;\n\tu32\t\tcrtc_h_sync_strt_wid;\n\tu32\t\tcrtc_v_total_disp;\n\tu32\t\tcrtc_v_sync_strt_wid;\n\tu32\t\tcrtc_offset;\n\tu32\t\tcrtc_offset_cntl;\n\tu32\t\tcrtc_pitch;\n\tu32\t\tdisp_merge_cntl;\n\tu32\t\tgrph_buffer_cntl;\n\tu32\t\tcrtc_more_cntl;\n\n\t \n\tu32\t\tcrtc2_gen_cntl;\n\tu32\t\tdac2_cntl;\n\tu32\t\tdisp_output_cntl;\n\tu32\t\tdisp_hw_debug;\n\tu32\t\tdisp2_merge_cntl;\n\tu32\t\tgrph2_buffer_cntl;\n\tu32\t\tcrtc2_h_total_disp;\n\tu32\t\tcrtc2_h_sync_strt_wid;\n\tu32\t\tcrtc2_v_total_disp;\n\tu32\t\tcrtc2_v_sync_strt_wid;\n\tu32\t\tcrtc2_offset;\n\tu32\t\tcrtc2_offset_cntl;\n\tu32\t\tcrtc2_pitch;\n\n\t \n\tu32 \t\tfp_crtc_h_total_disp;\n\tu32\t\tfp_crtc_v_total_disp;\n\tu32\t\tfp_gen_cntl;\n\tu32\t\tfp2_gen_cntl;\n\tu32\t\tfp_h_sync_strt_wid;\n\tu32\t\tfp2_h_sync_strt_wid;\n\tu32\t\tfp_horz_stretch;\n\tu32\t\tfp_panel_cntl;\n\tu32\t\tfp_v_sync_strt_wid;\n\tu32\t\tfp2_v_sync_strt_wid;\n\tu32\t\tfp_vert_stretch;\n\tu32\t\tlvds_gen_cntl;\n\tu32\t\tlvds_pll_cntl;\n\tu32\t\ttmds_crc;\n\tu32\t\ttmds_transmitter_cntl;\n\n\t \n\tu32\t\tdot_clock_freq;\n\tint\t\tfeedback_div;\n\tint\t\tpost_div;\t\n\n\t \n\tu32\t\tppll_div_3;\n\tu32\t\tppll_ref_div;\n\tu32\t\tvclk_ecp_cntl;\n\tu32\t\tclk_cntl_index;\n\n\t \n\tu32\t\tdot_clock_freq_2;\n\tint\t\tfeedback_div_2;\n\tint\t\tpost_div_2;\n\n\t \n\tu32\t\tp2pll_ref_div;\n\tu32\t\tp2pll_div_0;\n\tu32\t\thtotal_cntl2;\n\n       \t \n\tint\t\tpalette_valid;\n};\n\nstruct panel_info {\n\tint xres, yres;\n\tint valid;\n\tint clock;\n\tint hOver_plus, hSync_width, hblank;\n\tint vOver_plus, vSync_width, vblank;\n\tint hAct_high, vAct_high, interlaced;\n\tint pwr_delay;\n\tint use_bios_dividers;\n\tint ref_divider;\n\tint post_divider;\n\tint fbk_divider;\n};\n\nstruct radeonfb_info;\n\n#ifdef CONFIG_FB_RADEON_I2C\nstruct radeon_i2c_chan {\n\tstruct radeonfb_info\t\t*rinfo;\n\tu32\t\t \t\tddc_reg;\n\tstruct i2c_adapter\t\tadapter;\n\tstruct i2c_algo_bit_data\talgo;\n};\n#endif\n\nenum radeon_pm_mode {\n\tradeon_pm_none\t= 0,\t\t \n\tradeon_pm_d2\t= 0x00000001,\t \n\tradeon_pm_off\t= 0x00000002,\t \n};\n\ntypedef void (*reinit_function_ptr)(struct radeonfb_info *rinfo);\n\nstruct radeonfb_info {\n\tstruct fb_info\t\t*info;\n\n\tstruct radeon_regs \tstate;\n\tstruct radeon_regs\tinit_state;\n\n\tchar\t\t\tname[50];\n\n\tunsigned long\t\tmmio_base_phys;\n\tunsigned long\t\tfb_base_phys;\n\n\tvoid __iomem\t\t*mmio_base;\n\tvoid __iomem\t\t*fb_base;\n\n\tunsigned long\t\tfb_local_base;\n\n\tstruct pci_dev\t\t*pdev;\n#if defined(CONFIG_PPC) || defined(CONFIG_SPARC)\n\tstruct device_node\t*of_node;\n#endif\n\n\tvoid __iomem\t\t*bios_seg;\n\tint\t\t\tfp_bios_start;\n\n\tu32\t\t\tpseudo_palette[16];\n\tstruct { u8 red, green, blue, pad; }\n\t\t\t\tpalette[256];\n\n\tint\t\t\tchipset;\n\tu8\t\t\tfamily;\n\tu8\t\t\trev;\n\tunsigned int\t\terrata;\n\tunsigned long\t\tvideo_ram;\n\tunsigned long\t\tmapped_vram;\n\tint\t\t\tvram_width;\n\tint\t\t\tvram_ddr;\n\n\tint\t\t\tpitch, bpp, depth;\n\n\tint\t\t\thas_CRTC2;\n\tint\t\t\tis_mobility;\n\tint\t\t\tis_IGP;\n\tint\t\t\treversed_DAC;\n\tint\t\t\treversed_TMDS;\n\tstruct panel_info\tpanel_info;\n\tint\t\t\tmon1_type;\n\tu8\t\t\t*mon1_EDID;\n\tstruct fb_videomode\t*mon1_modedb;\n\tint\t\t\tmon1_dbsize;\n\tint\t\t\tmon2_type;\n\tu8\t\t        *mon2_EDID;\n\n\tu32\t\t\tdp_gui_master_cntl;\n\n\tstruct pll_info\t\tpll;\n\n\tint\t\t\twc_cookie;\n\n\tu32\t\t\tsave_regs[100];\n\tint\t\t\tasleep;\n\tint\t\t\tlock_blank;\n\tint\t\t\tdynclk;\n\tint\t\t\tno_schedule;\n\tenum radeon_pm_mode\tpm_mode;\n\treinit_function_ptr     reinit_func;\n\n\t \n\tspinlock_t\t\treg_lock;\n\n\t \n\tstruct timer_list\tlvds_timer;\n\tu32\t\t\tpending_lvds_gen_cntl;\n\n#ifdef CONFIG_FB_RADEON_I2C\n\tstruct radeon_i2c_chan \ti2c[4];\n#endif\n};\n\n\n#define PRIMARY_MONITOR(rinfo)\t(rinfo->mon1_type)\n\n\n \n\nvoid _radeon_msleep(struct radeonfb_info *rinfo, unsigned long ms);\n\n#define INREG8(addr)\t\treadb((rinfo->mmio_base)+addr)\n#define OUTREG8(addr,val)\twriteb(val, (rinfo->mmio_base)+addr)\n#define INREG16(addr)\t\treadw((rinfo->mmio_base)+addr)\n#define OUTREG16(addr,val)\twritew(val, (rinfo->mmio_base)+addr)\n#define INREG(addr)\t\treadl((rinfo->mmio_base)+addr)\n#define OUTREG(addr,val)\twritel(val, (rinfo->mmio_base)+addr)\n\nvoid _OUTREGP(struct radeonfb_info *rinfo, u32 addr, u32 val, u32 mask);\n\n#define OUTREGP(addr,val,mask)\t_OUTREGP(rinfo, addr, val,mask)\n\n \nvoid radeon_pll_errata_after_index_slow(struct radeonfb_info *rinfo);\nstatic inline void radeon_pll_errata_after_index(struct radeonfb_info *rinfo)\n{\n\tif (rinfo->errata & CHIP_ERRATA_PLL_DUMMYREADS)\n\t\tradeon_pll_errata_after_index_slow(rinfo);\n}\n\nvoid radeon_pll_errata_after_data_slow(struct radeonfb_info *rinfo);\nstatic inline void radeon_pll_errata_after_data(struct radeonfb_info *rinfo)\n{\n\tif (rinfo->errata & (CHIP_ERRATA_PLL_DELAY|CHIP_ERRATA_R300_CG))\n\t\tradeon_pll_errata_after_data_slow(rinfo);\n}\n\nu32 __INPLL(struct radeonfb_info *rinfo, u32 addr);\nvoid __OUTPLL(struct radeonfb_info *rinfo, unsigned int index, u32 val);\nvoid __OUTPLLP(struct radeonfb_info *rinfo, unsigned int index,\n\t\t\t     u32 val, u32 mask);\n\n#define INPLL(addr)\t\t\t__INPLL(rinfo, addr)\n#define OUTPLL(index, val)\t\t__OUTPLL(rinfo, index, val)\n#define OUTPLLP(index, val, mask)\t__OUTPLLP(rinfo, index, val, mask)\n\n\n#define BIOS_IN8(v)  \t(readb(rinfo->bios_seg + (v)))\n#define BIOS_IN16(v) \t(readb(rinfo->bios_seg + (v)) | \\\n\t\t\t  (readb(rinfo->bios_seg + (v) + 1) << 8))\n#define BIOS_IN32(v) \t(readb(rinfo->bios_seg + (v)) | \\\n\t\t\t  (readb(rinfo->bios_seg + (v) + 1) << 8) | \\\n\t\t\t  (readb(rinfo->bios_seg + (v) + 2) << 16) | \\\n\t\t\t  (readb(rinfo->bios_seg + (v) + 3) << 24))\n\n \nstatic inline int round_div(int num, int den)\n{\n        return (num + (den / 2)) / den;\n}\n\nstatic inline int var_to_depth(const struct fb_var_screeninfo *var)\n{\n\tif (var->bits_per_pixel != 16)\n\t\treturn var->bits_per_pixel;\n\treturn (var->green.length == 5) ? 15 : 16;\n}\n\nstatic inline u32 radeon_get_dstbpp(u16 depth)\n{\n\tswitch (depth) {\n       \tcase 8:\n       \t\treturn DST_8BPP;\n       \tcase 15:\n       \t\treturn DST_15BPP;\n       \tcase 16:\n       \t\treturn DST_16BPP;\n       \tcase 32:\n       \t\treturn DST_32BPP;\n       \tdefault:\n       \t\treturn 0;\n\t}\n}\n\n \n\nvoid _radeon_fifo_wait(struct radeonfb_info *rinfo, int entries);\nvoid radeon_engine_flush(struct radeonfb_info *rinfo);\nvoid _radeon_engine_idle(struct radeonfb_info *rinfo);\n\n#define radeon_engine_idle()\t\t_radeon_engine_idle(rinfo)\n#define radeon_fifo_wait(entries)\t_radeon_fifo_wait(rinfo,entries)\n#define radeon_msleep(ms)\t\t_radeon_msleep(rinfo,ms)\n\n\n \nextern void radeon_create_i2c_busses(struct radeonfb_info *rinfo);\nextern void radeon_delete_i2c_busses(struct radeonfb_info *rinfo);\nextern int radeon_probe_i2c_connector(struct radeonfb_info *rinfo, int conn, u8 **out_edid);\n\n \nextern const struct dev_pm_ops radeonfb_pci_pm_ops;\nextern void radeonfb_pm_init(struct radeonfb_info *rinfo, int dynclk, int ignore_devlist, int force_sleep);\nextern void radeonfb_pm_exit(struct radeonfb_info *rinfo);\n\n \nextern void radeon_probe_screens(struct radeonfb_info *rinfo,\n\t\t\t\t const char *monitor_layout, int ignore_edid);\nextern void radeon_check_modes(struct radeonfb_info *rinfo, const char *mode_option);\nextern int radeon_match_mode(struct radeonfb_info *rinfo,\n\t\t\t     struct fb_var_screeninfo *dest,\n\t\t\t     const struct fb_var_screeninfo *src);\n\n \nextern void radeonfb_fillrect(struct fb_info *info, const struct fb_fillrect *region);\nextern void radeonfb_copyarea(struct fb_info *info, const struct fb_copyarea *area);\nextern void radeonfb_imageblit(struct fb_info *p, const struct fb_image *image);\nextern int radeonfb_sync(struct fb_info *info);\nextern void radeonfb_engine_init (struct radeonfb_info *rinfo);\nextern void radeonfb_engine_reset(struct radeonfb_info *rinfo);\n\n \nextern int radeon_screen_blank(struct radeonfb_info *rinfo, int blank, int mode_switch);\nextern void radeon_write_mode (struct radeonfb_info *rinfo, struct radeon_regs *mode,\n\t\t\t       int reg_only);\n\n \n#ifdef CONFIG_FB_RADEON_BACKLIGHT\nextern void radeonfb_bl_init(struct radeonfb_info *rinfo);\nextern void radeonfb_bl_exit(struct radeonfb_info *rinfo);\n#else\nstatic inline void radeonfb_bl_init(struct radeonfb_info *rinfo) {}\nstatic inline void radeonfb_bl_exit(struct radeonfb_info *rinfo) {}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}