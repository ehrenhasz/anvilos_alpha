{
  "module_name": "sis_accel.h",
  "hash_id": "256babe471b6854f873623d2cebfdde1c7affce9b77670d89d7baf6f7183da1c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/video/fbdev/sis/sis_accel.h",
  "human_readable_source": " \n \n\n#ifndef _SISFB_ACCEL_H\n#define _SISFB_ACCEL_H\n\n \n#undef SISFB_USE_SPINLOCKS\n\n#ifdef SISFB_USE_SPINLOCKS\n#include <linux/spinlock.h>\n#define CRITBEGIN  spin_lock_irqsave(&ivideo->lockaccel, critflags);\n#define CRITEND\t   spin_unlock_irqrestore(&ivideo->lockaccel, critflags);\n#define CRITFLAGS  unsigned long critflags;\n#else\n#define CRITBEGIN\n#define CRITEND\n#define CRITFLAGS\n#endif\n\n \n\n#define PATREGSIZE      384   \n#define BR(x)   (0x8200 | (x) << 2)\n#define PBR(x)  (0x8300 | (x) << 2)\n\n \n#define BITBLT                  0x00000000   \n#define COLOREXP                0x00000001   \n#define ENCOLOREXP              0x00000002   \n#define MULTIPLE_SCANLINE       0x00000003   \n#define LINE                    0x00000004   \n#define TRAPAZOID_FILL          0x00000005   \n#define TRANSPARENT_BITBLT      0x00000006   \n\n \n#define ALPHA_BLEND\t\t0x00000007   \n#define A3D_FUNCTION\t\t0x00000008   \n#define\tCLEAR_Z_BUFFER\t\t0x00000009   \n#define GRADIENT_FILL\t\t0x0000000A   \n\n \n#define SRCVIDEO                0x00000000   \n#define SRCSYSTEM               0x00000010   \n#define SRCCPUBLITBUF           SRCSYSTEM    \n#define SRCAGP                  0x00000020   \n\n \n#define PATFG                   0x00000000   \n#define PATPATREG               0x00000040   \n#define PATMONO                 0x00000080   \n\n \n#define X_INC                   0x00010000\n#define X_DEC                   0x00000000\n#define Y_INC                   0x00020000\n#define Y_DEC                   0x00000000\n\n \n#define NOCLIP                  0x00000000\n#define NOMERGECLIP             0x04000000\n#define CLIPENABLE              0x00040000\n#define CLIPWITHOUTMERGE        0x04040000\n\n \n#define OPAQUE                  0x00000000\n#define TRANSPARENT             0x00100000\n\n \n#define DSTAGP                  0x02000000\n#define DSTVIDEO                0x02000000\n\n \n#define COLOR_TO_MONO\t\t0x00100000\n#define AA_TEXT\t\t\t0x00200000\n\n \n#define SRC_ADDR\t\t0x8200\n#define SRC_PITCH\t\t0x8204\n#define AGP_BASE\t\t0x8206  \n#define SRC_Y\t\t\t0x8208\n#define SRC_X\t\t\t0x820A\n#define DST_Y\t\t\t0x820C\n#define DST_X\t\t\t0x820E\n#define DST_ADDR\t\t0x8210\n#define DST_PITCH\t\t0x8214\n#define DST_HEIGHT\t\t0x8216\n#define RECT_WIDTH\t\t0x8218\n#define RECT_HEIGHT\t\t0x821A\n#define PAT_FGCOLOR\t\t0x821C\n#define PAT_BGCOLOR\t\t0x8220\n#define SRC_FGCOLOR\t\t0x8224\n#define SRC_BGCOLOR\t\t0x8228\n#define MONO_MASK\t\t0x822C\n#define LEFT_CLIP\t\t0x8234\n#define TOP_CLIP\t\t0x8236\n#define RIGHT_CLIP\t\t0x8238\n#define BOTTOM_CLIP\t\t0x823A\n#define COMMAND_READY\t\t0x823C\n#define FIRE_TRIGGER      \t0x8240\n\n#define PATTERN_REG\t\t0x8300   \n\n \n#define TRANS_DST_KEY_HIGH\tPAT_FGCOLOR\n#define TRANS_DST_KEY_LOW\tPAT_BGCOLOR\n#define TRANS_SRC_KEY_HIGH\tSRC_FGCOLOR\n#define TRANS_SRC_KEY_LOW\tSRC_BGCOLOR\n\n \n#define CmdQueLen ivideo->cmdqueuelength\n\n \n\n \n\n#define SiS300Idle \\\n  { \\\n\twhile((MMIO_IN16(ivideo->mmio_vbase, BR(16)+2) & 0xE000) != 0xE000){} \\\n\twhile((MMIO_IN16(ivideo->mmio_vbase, BR(16)+2) & 0xE000) != 0xE000){} \\\n\twhile((MMIO_IN16(ivideo->mmio_vbase, BR(16)+2) & 0xE000) != 0xE000){} \\\n  \tCmdQueLen = MMIO_IN16(ivideo->mmio_vbase, 0x8240); \\\n  }\n \n\n#define SiS300SetupSRCBase(base) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(0), base);\\\n\tCmdQueLen--;\n\n#define SiS300SetupSRCPitch(pitch) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT16(ivideo->mmio_vbase, BR(1), pitch);\\\n\tCmdQueLen--;\n\n#define SiS300SetupSRCXY(x,y) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(2), (x)<<16 | (y) );\\\n\tCmdQueLen--;\n\n#define SiS300SetupDSTBase(base) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(4), base);\\\n\tCmdQueLen--;\n\n#define SiS300SetupDSTXY(x,y) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(3), (x)<<16 | (y) );\\\n\tCmdQueLen--;\n\n#define SiS300SetupDSTRect(x,y) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(5), (y)<<16 | (x) );\\\n\tCmdQueLen--;\n\n#define SiS300SetupDSTColorDepth(bpp) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT16(ivideo->mmio_vbase, BR(1)+2, bpp);\\\n\tCmdQueLen--;\n\n#define SiS300SetupRect(w,h) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(6), (h)<<16 | (w) );\\\n\tCmdQueLen--;\n\n#define SiS300SetupPATFG(color) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(7), color);\\\n\tCmdQueLen--;\n\n#define SiS300SetupPATBG(color) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(8), color);\\\n\tCmdQueLen--;\n\n#define SiS300SetupSRCFG(color) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(9), color);\\\n\tCmdQueLen--;\n\n#define SiS300SetupSRCBG(color) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(10), color);\\\n\tCmdQueLen--;\n\n \n \n \n \n#define SiS300SetupSRCTrans(color) \\\n\tif(CmdQueLen <= 1) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, 0x8224, color);\\\n\tMMIO_OUT32(ivideo->mmio_vbase, 0x8228, color);\\\n\tCmdQueLen -= 2;\n\n#define SiS300SetupDSTTrans(color) \\\n\tif(CmdQueLen <= 1) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, 0x821C, color); \\\n\tMMIO_OUT32(ivideo->mmio_vbase, 0x8220, color); \\\n\tCmdQueLen -= 2;\n\n#define SiS300SetupMONOPAT(p0,p1) \\\n\tif(CmdQueLen <= 1) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(11), p0);\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(12), p1);\\\n\tCmdQueLen -= 2;\n\n#define SiS300SetupClipLT(left,top) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(13), ((left) & 0xFFFF) | (top)<<16 );\\\n\tCmdQueLen--;\n\n#define SiS300SetupClipRB(right,bottom) \\\n\tif(CmdQueLen <= 0) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(14), ((right) & 0xFFFF) | (bottom)<<16 );\\\n\tCmdQueLen--;\n\n \n#define SiS300SetupROP(rop) \\\n\tivideo->CommandReg = (rop) << 8;\n\n#define SiS300SetupCMDFlag(flags) \\\n\tivideo->CommandReg |= (flags);\n\n#define SiS300DoCMD \\\n\tif(CmdQueLen <= 1) SiS300Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(15), ivideo->CommandReg); \\\n\tMMIO_OUT32(ivideo->mmio_vbase, BR(16), 0);\\\n\tCmdQueLen -= 2;\n\n \n\n \n\n#define SiS310Idle \\\n  { \\\n\twhile( (MMIO_IN16(ivideo->mmio_vbase, Q_STATUS+2) & 0x8000) != 0x8000){} \\\n\twhile( (MMIO_IN16(ivideo->mmio_vbase, Q_STATUS+2) & 0x8000) != 0x8000){} \\\n\twhile( (MMIO_IN16(ivideo->mmio_vbase, Q_STATUS+2) & 0x8000) != 0x8000){} \\\n\twhile( (MMIO_IN16(ivideo->mmio_vbase, Q_STATUS+2) & 0x8000) != 0x8000){} \\\n  \tCmdQueLen = 0; \\\n  }\n\n#define SiS310SetupSRCBase(base) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, SRC_ADDR, base);\\\n\tCmdQueLen--;\n\n#define SiS310SetupSRCPitch(pitch) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT16(ivideo->mmio_vbase, SRC_PITCH, pitch);\\\n\tCmdQueLen--;\n\n#define SiS310SetupSRCXY(x,y) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, SRC_Y, (x)<<16 | (y) );\\\n\tCmdQueLen--;\n\n#define SiS310SetupDSTBase(base) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, DST_ADDR, base);\\\n\tCmdQueLen--;\n\n#define SiS310SetupDSTXY(x,y) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, DST_Y, (x)<<16 | (y) );\\\n\tCmdQueLen--;\n\n#define SiS310SetupDSTRect(x,y) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, DST_PITCH, (y)<<16 | (x) );\\\n\tCmdQueLen--;\n\n#define SiS310SetupDSTColorDepth(bpp) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT16(ivideo->mmio_vbase, AGP_BASE, bpp);\\\n\tCmdQueLen--;\n\n#define SiS310SetupRect(w,h) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, RECT_WIDTH, (h)<<16 | (w) );\\\n\tCmdQueLen--;\n\n#define SiS310SetupPATFG(color) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, PAT_FGCOLOR, color);\\\n\tCmdQueLen--;\n\n#define SiS310SetupPATBG(color) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, PAT_BGCOLOR, color);\\\n\tCmdQueLen--;\n\n#define SiS310SetupSRCFG(color) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, SRC_FGCOLOR, color);\\\n\tCmdQueLen--;\n\n#define SiS310SetupSRCBG(color) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, SRC_BGCOLOR, color);\\\n\tCmdQueLen--;\n\n#define SiS310SetupSRCTrans(color) \\\n\tif(CmdQueLen <= 1) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, TRANS_SRC_KEY_HIGH, color);\\\n\tMMIO_OUT32(ivideo->mmio_vbase, TRANS_SRC_KEY_LOW, color);\\\n\tCmdQueLen -= 2;\n\n#define SiS310SetupDSTTrans(color) \\\n\tif(CmdQueLen <= 1) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, TRANS_DST_KEY_HIGH, color); \\\n\tMMIO_OUT32(ivideo->mmio_vbase, TRANS_DST_KEY_LOW, color); \\\n\tCmdQueLen -= 2;\n\n#define SiS310SetupMONOPAT(p0,p1) \\\n\tif(CmdQueLen <= 1) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, MONO_MASK, p0);\\\n\tMMIO_OUT32(ivideo->mmio_vbase, MONO_MASK+4, p1);\\\n\tCmdQueLen -= 2;\n\n#define SiS310SetupClipLT(left,top) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, LEFT_CLIP, ((left) & 0xFFFF) | (top)<<16 );\\\n\tCmdQueLen--;\n\n#define SiS310SetupClipRB(right,bottom) \\\n\tif(CmdQueLen <= 0) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, RIGHT_CLIP, ((right) & 0xFFFF) | (bottom)<<16 );\\\n\tCmdQueLen--;\n\n#define SiS310SetupROP(rop) \\\n\tivideo->CommandReg = (rop) << 8;\n\n#define SiS310SetupCMDFlag(flags) \\\n\tivideo->CommandReg |= (flags);\n\n#define SiS310DoCMD \\\n\tif(CmdQueLen <= 1) SiS310Idle;\\\n\tMMIO_OUT32(ivideo->mmio_vbase, COMMAND_READY, ivideo->CommandReg); \\\n\tMMIO_OUT32(ivideo->mmio_vbase, FIRE_TRIGGER, 0); \\\n\tCmdQueLen -= 2;\n\nint  sisfb_initaccel(struct sis_video_info *ivideo);\nvoid sisfb_syncaccel(struct sis_video_info *ivideo);\n\nint  fbcon_sis_sync(struct fb_info *info);\nvoid fbcon_sis_fillrect(struct fb_info *info, const struct fb_fillrect *rect);\nvoid fbcon_sis_copyarea(struct fb_info *info, const struct fb_copyarea *area);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}