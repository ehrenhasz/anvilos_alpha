{
  "module_name": "smccc.c",
  "hash_id": "27eb586984d9745f2f37b868235b8ea805bb55a88172cb45c1301c2b890a5958",
  "original_prompt": "Ingested from linux-6.6.14/drivers/firmware/smccc/smccc.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) \"smccc: \" fmt\n\n#include <linux/cache.h>\n#include <linux/init.h>\n#include <linux/arm-smccc.h>\n#include <linux/kernel.h>\n#include <linux/platform_device.h>\n#include <asm/archrandom.h>\n\nstatic u32 smccc_version = ARM_SMCCC_VERSION_1_0;\nstatic enum arm_smccc_conduit smccc_conduit = SMCCC_CONDUIT_NONE;\n\nbool __ro_after_init smccc_trng_available = false;\nu64 __ro_after_init smccc_has_sve_hint = false;\ns32 __ro_after_init smccc_soc_id_version = SMCCC_RET_NOT_SUPPORTED;\ns32 __ro_after_init smccc_soc_id_revision = SMCCC_RET_NOT_SUPPORTED;\n\nvoid __init arm_smccc_version_init(u32 version, enum arm_smccc_conduit conduit)\n{\n\tstruct arm_smccc_res res;\n\n\tsmccc_version = version;\n\tsmccc_conduit = conduit;\n\n\tsmccc_trng_available = smccc_probe_trng();\n\tif (IS_ENABLED(CONFIG_ARM64_SVE) &&\n\t    smccc_version >= ARM_SMCCC_VERSION_1_3)\n\t\tsmccc_has_sve_hint = true;\n\n\tif ((smccc_version >= ARM_SMCCC_VERSION_1_2) &&\n\t    (smccc_conduit != SMCCC_CONDUIT_NONE)) {\n\t\tarm_smccc_1_1_invoke(ARM_SMCCC_ARCH_FEATURES_FUNC_ID,\n\t\t\t\t     ARM_SMCCC_ARCH_SOC_ID, &res);\n\t\tif ((s32)res.a0 >= 0) {\n\t\t\tarm_smccc_1_1_invoke(ARM_SMCCC_ARCH_SOC_ID, 0, &res);\n\t\t\tsmccc_soc_id_version = (s32)res.a0;\n\t\t\tarm_smccc_1_1_invoke(ARM_SMCCC_ARCH_SOC_ID, 1, &res);\n\t\t\tsmccc_soc_id_revision = (s32)res.a0;\n\t\t}\n\t}\n}\n\nenum arm_smccc_conduit arm_smccc_1_1_get_conduit(void)\n{\n\tif (smccc_version < ARM_SMCCC_VERSION_1_1)\n\t\treturn SMCCC_CONDUIT_NONE;\n\n\treturn smccc_conduit;\n}\nEXPORT_SYMBOL_GPL(arm_smccc_1_1_get_conduit);\n\nu32 arm_smccc_get_version(void)\n{\n\treturn smccc_version;\n}\nEXPORT_SYMBOL_GPL(arm_smccc_get_version);\n\ns32 arm_smccc_get_soc_id_version(void)\n{\n\treturn smccc_soc_id_version;\n}\n\ns32 arm_smccc_get_soc_id_revision(void)\n{\n\treturn smccc_soc_id_revision;\n}\n\nstatic int __init smccc_devices_init(void)\n{\n\tstruct platform_device *pdev;\n\n\tif (smccc_trng_available) {\n\t\tpdev = platform_device_register_simple(\"smccc_trng\", -1,\n\t\t\t\t\t\t       NULL, 0);\n\t\tif (IS_ERR(pdev))\n\t\t\tpr_err(\"smccc_trng: could not register device: %ld\\n\",\n\t\t\t       PTR_ERR(pdev));\n\t}\n\n\treturn 0;\n}\ndevice_initcall(smccc_devices_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}