{
  "module_name": "zboot-header.S",
  "hash_id": "a62acbcee13434af45e2081db438169b19e3d0685bb44f5986e85bcc29c35e76",
  "original_prompt": "Ingested from linux-6.6.14/drivers/firmware/efi/libstub/zboot-header.S",
  "human_readable_source": " \n\n#include <linux/pe.h>\n\n#ifdef CONFIG_64BIT\n\t.set\t\t.Lextra_characteristics, 0x0\n\t.set\t\t.Lpe_opt_magic, PE_OPT_MAGIC_PE32PLUS\n#else\n\t.set\t\t.Lextra_characteristics, IMAGE_FILE_32BIT_MACHINE\n\t.set\t\t.Lpe_opt_magic, PE_OPT_MAGIC_PE32\n#endif\n\n\t.section\t\".head\", \"a\"\n\t.globl\t\t__efistub_efi_zboot_header\n__efistub_efi_zboot_header:\n.Ldoshdr:\n\t.long\t\tMZ_MAGIC\n\t.ascii\t\t\"zimg\"\t\t\t\t\t \n\t.long\t\t__efistub__gzdata_start - .Ldoshdr\t \n\t.long\t\t__efistub__gzdata_size - ZBOOT_SIZE_LEN\t \n\t.long\t\t0, 0\t\t\t\t\t \n\t.asciz\t\tCOMP_TYPE\t\t\t\t \n\t.org\t\t.Ldoshdr + 0x38\n\t.long\t\tLINUX_PE_MAGIC\n\t.long\t\t.Lpehdr - .Ldoshdr\t\t\t \n\n.Lpehdr:\n\t.long\t\tPE_MAGIC\n\t.short\t\tMACHINE_TYPE\n\t.short\t\t.Lsection_count\n\t.long\t\t0\n\t.long\t\t0\n\t.long\t\t0\n\t.short\t\t.Lsection_table - .Loptional_header\n\t.short\t\tIMAGE_FILE_DEBUG_STRIPPED | \\\n\t\t\tIMAGE_FILE_EXECUTABLE_IMAGE | \\\n\t\t\tIMAGE_FILE_LINE_NUMS_STRIPPED |\\\n\t\t\t.Lextra_characteristics\n\n.Loptional_header:\n\t.short\t\t.Lpe_opt_magic\n\t.byte\t\t0, 0\n\t.long\t\t_etext - .Lefi_header_end\n\t.long\t\t__data_size\n\t.long\t\t0\n\t.long\t\t__efistub_efi_zboot_entry - .Ldoshdr\n\t.long\t\t.Lefi_header_end - .Ldoshdr\n\n#ifdef CONFIG_64BIT\n\t.quad\t\t0\n#else\n\t.long\t\t_etext - .Ldoshdr, 0x0\n#endif\n\t.long\t\t4096\n\t.long\t\t512\n\t.short\t\t0, 0\n\t.short\t\tLINUX_EFISTUB_MAJOR_VERSION\t \n\t.short\t\tLINUX_EFISTUB_MINOR_VERSION\t \n\t.short\t\t0, 0\n\t.long\t\t0\n\t.long\t\t_end - .Ldoshdr\n\n\t.long\t\t.Lefi_header_end - .Ldoshdr\n\t.long\t\t0\n\t.short\t\tIMAGE_SUBSYSTEM_EFI_APPLICATION\n\t.short\t\tIMAGE_DLL_CHARACTERISTICS_NX_COMPAT\n#ifdef CONFIG_64BIT\n\t.quad\t\t0, 0, 0, 0\n#else\n\t.long\t\t0, 0, 0, 0\n#endif\n\t.long\t\t0\n\t.long\t\t(.Lsection_table - .) / 8\n\n\t.quad\t\t0\t\t\t\t \n\t.quad\t\t0\t\t\t\t \n\t.quad\t\t0\t\t\t\t \n\t.quad\t\t0\t\t\t\t \n\t.quad\t\t0\t\t\t\t \n\t.quad\t\t0\t\t\t\t \n#if defined(PE_DLL_CHAR_EX) || defined(CONFIG_DEBUG_EFI)\n\t.long\t\t.Lefi_debug_table - .Ldoshdr\t \n\t.long\t\t.Lefi_debug_table_size\n\n\t.section\t\".rodata\", \"a\"\n\t.p2align\t2\n.Lefi_debug_table:\n\t \n#ifdef PE_DLL_CHAR_EX\n\t.long\t\t0\t\t\t\t\t \n\t.long\t\t0\t\t\t\t\t \n\t.short\t\t0\t\t\t\t\t \n\t.short\t\t0\t\t\t\t\t \n\t.long\t\tIMAGE_DEBUG_TYPE_EX_DLLCHARACTERISTICS\t \n\t.long\t\t4\t\t\t\t\t \n\t.long\t\t0\t\t\t\t\t \n\t.long\t\t.Lefi_dll_characteristics_ex - .Ldoshdr\t \n#endif\n#ifdef CONFIG_DEBUG_EFI\n\t.long\t\t0\t\t\t\t\t \n\t.long\t\t0\t\t\t\t\t \n\t.short\t\t0\t\t\t\t\t \n\t.short\t\t0\t\t\t\t\t \n\t.long\t\tIMAGE_DEBUG_TYPE_CODEVIEW\t\t \n\t.long\t\t.Lefi_debug_entry_size\t\t\t \n\t.long\t\t0\t\t\t\t\t \n\t.long\t\t.Lefi_debug_entry - .Ldoshdr\t\t \n#endif\n\t.set\t\t.Lefi_debug_table_size, . - .Lefi_debug_table\n\t.previous\n#endif\n\n.Lsection_table:\n\t.ascii\t\t\".text\\0\\0\\0\"\n\t.long\t\t_etext - .Lefi_header_end\n\t.long\t\t.Lefi_header_end - .Ldoshdr\n\t.long\t\t_etext - .Lefi_header_end\n\t.long\t\t.Lefi_header_end - .Ldoshdr\n\n\t.long\t\t0, 0\n\t.short\t\t0, 0\n\t.long\t\tIMAGE_SCN_CNT_CODE | \\\n\t\t\tIMAGE_SCN_MEM_READ | \\\n\t\t\tIMAGE_SCN_MEM_EXECUTE\n\n\t.ascii\t\t\".data\\0\\0\\0\"\n\t.long\t\t__data_size\n\t.long\t\t_etext - .Ldoshdr\n\t.long\t\t__data_rawsize\n\t.long\t\t_etext - .Ldoshdr\n\n\t.long\t\t0, 0\n\t.short\t\t0, 0\n\t.long\t\tIMAGE_SCN_CNT_INITIALIZED_DATA | \\\n\t\t\tIMAGE_SCN_MEM_READ | \\\n\t\t\tIMAGE_SCN_MEM_WRITE\n\n\t.set\t\t.Lsection_count, (. - .Lsection_table) / 40\n\n#ifdef PE_DLL_CHAR_EX\n.Lefi_dll_characteristics_ex:\n\t.long\t\tPE_DLL_CHAR_EX\n#endif\n#ifdef CONFIG_DEBUG_EFI\n.Lefi_debug_entry:\n\t \n\t.ascii\t\t\"NB10\"\t\t\t\t \n\t.long\t\t0\t\t\t\t \n\t.long\t\t0\t\t\t\t \n\t.long\t\t0\t\t\t\t \n\n\t.asciz\t\tZBOOT_EFI_PATH\n\n\t.set\t\t.Lefi_debug_entry_size, . - .Lefi_debug_entry\n#endif\n\n\t.p2align\t12\n.Lefi_header_end:\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}