{
  "module_name": "cavium.h",
  "hash_id": "c1bb8ad7bee028f76fc55f82ab5fc12f467b32aedbf2f050545580e2a3a8549f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mmc/host/cavium.h",
  "human_readable_source": " \n\n#ifndef _CAVIUM_MMC_H_\n#define _CAVIUM_MMC_H_\n\n#include <linux/bitops.h>\n#include <linux/clk.h>\n#include <linux/gpio/consumer.h>\n#include <linux/io.h>\n#include <linux/mmc/host.h>\n#include <linux/of.h>\n#include <linux/scatterlist.h>\n#include <linux/semaphore.h>\n\n#define CAVIUM_MAX_MMC\t\t4\n\n \n#define MIO_EMM_DMA_FIFO_CFG(x)\t(0x00 + x->reg_off_dma)\n#define MIO_EMM_DMA_FIFO_ADR(x)\t(0x10 + x->reg_off_dma)\n#define MIO_EMM_DMA_FIFO_CMD(x)\t(0x18 + x->reg_off_dma)\n#define MIO_EMM_DMA_CFG(x)\t(0x20 + x->reg_off_dma)\n#define MIO_EMM_DMA_ADR(x)\t(0x28 + x->reg_off_dma)\n#define MIO_EMM_DMA_INT(x)\t(0x30 + x->reg_off_dma)\n#define MIO_EMM_DMA_INT_W1S(x)\t(0x38 + x->reg_off_dma)\n#define MIO_EMM_DMA_INT_ENA_W1S(x) (0x40 + x->reg_off_dma)\n#define MIO_EMM_DMA_INT_ENA_W1C(x) (0x48 + x->reg_off_dma)\n\n \n#define MIO_EMM_CFG(x)\t\t(0x00 + x->reg_off)\n#define MIO_EMM_SWITCH(x)\t(0x48 + x->reg_off)\n#define MIO_EMM_DMA(x)\t\t(0x50 + x->reg_off)\n#define MIO_EMM_CMD(x)\t\t(0x58 + x->reg_off)\n#define MIO_EMM_RSP_STS(x)\t(0x60 + x->reg_off)\n#define MIO_EMM_RSP_LO(x)\t(0x68 + x->reg_off)\n#define MIO_EMM_RSP_HI(x)\t(0x70 + x->reg_off)\n#define MIO_EMM_INT(x)\t\t(0x78 + x->reg_off)\n#define MIO_EMM_INT_EN(x)\t(0x80 + x->reg_off)\n#define MIO_EMM_WDOG(x)\t\t(0x88 + x->reg_off)\n#define MIO_EMM_SAMPLE(x)\t(0x90 + x->reg_off)\n#define MIO_EMM_STS_MASK(x)\t(0x98 + x->reg_off)\n#define MIO_EMM_RCA(x)\t\t(0xa0 + x->reg_off)\n#define MIO_EMM_INT_EN_SET(x)\t(0xb0 + x->reg_off)\n#define MIO_EMM_INT_EN_CLR(x)\t(0xb8 + x->reg_off)\n#define MIO_EMM_BUF_IDX(x)\t(0xe0 + x->reg_off)\n#define MIO_EMM_BUF_DAT(x)\t(0xe8 + x->reg_off)\n\nstruct cvm_mmc_host {\n\tstruct device *dev;\n\tvoid __iomem *base;\n\tvoid __iomem *dma_base;\n\tint reg_off;\n\tint reg_off_dma;\n\tu64 emm_cfg;\n\tu64 n_minus_one;\t \n\tint last_slot;\n\tstruct clk *clk;\n\tint sys_freq;\n\n\tstruct mmc_request *current_req;\n\tstruct sg_mapping_iter smi;\n\tbool dma_active;\n\tbool use_sg;\n\n\tbool has_ciu3;\n\tbool big_dma_addr;\n\tbool need_irq_handler_lock;\n\tspinlock_t irq_handler_lock;\n\tstruct semaphore mmc_serializer;\n\n\tstruct gpio_desc *global_pwr_gpiod;\n\tatomic_t shared_power_users;\n\n\tstruct cvm_mmc_slot *slot[CAVIUM_MAX_MMC];\n\tstruct platform_device *slot_pdev[CAVIUM_MAX_MMC];\n\n\tvoid (*set_shared_power)(struct cvm_mmc_host *, int);\n\tvoid (*acquire_bus)(struct cvm_mmc_host *);\n\tvoid (*release_bus)(struct cvm_mmc_host *);\n\tvoid (*int_enable)(struct cvm_mmc_host *, u64);\n\t \n\tvoid (*dmar_fixup)(struct cvm_mmc_host *, struct mmc_command *,\n\t\t\t   struct mmc_data *, u64);\n\tvoid (*dmar_fixup_done)(struct cvm_mmc_host *);\n};\n\nstruct cvm_mmc_slot {\n\tstruct mmc_host *mmc;\t\t \n\tstruct cvm_mmc_host *host;\t \n\n\tu64 clock;\n\n\tu64 cached_switch;\n\tu64 cached_rca;\n\n\tunsigned int cmd_cnt;\t\t \n\tunsigned int dat_cnt;\t\t \n\n\tint bus_id;\n};\n\nstruct cvm_mmc_cr_type {\n\tu8 ctype;\n\tu8 rtype;\n};\n\nstruct cvm_mmc_cr_mods {\n\tu8 ctype_xor;\n\tu8 rtype_xor;\n};\n\n \n#define MIO_EMM_DMA_FIFO_CFG_CLR\tBIT_ULL(16)\n#define MIO_EMM_DMA_FIFO_CFG_INT_LVL\tGENMASK_ULL(12, 8)\n#define MIO_EMM_DMA_FIFO_CFG_COUNT\tGENMASK_ULL(4, 0)\n\n#define MIO_EMM_DMA_FIFO_CMD_RW\t\tBIT_ULL(62)\n#define MIO_EMM_DMA_FIFO_CMD_INTDIS\tBIT_ULL(60)\n#define MIO_EMM_DMA_FIFO_CMD_SWAP32\tBIT_ULL(59)\n#define MIO_EMM_DMA_FIFO_CMD_SWAP16\tBIT_ULL(58)\n#define MIO_EMM_DMA_FIFO_CMD_SWAP8\tBIT_ULL(57)\n#define MIO_EMM_DMA_FIFO_CMD_ENDIAN\tBIT_ULL(56)\n#define MIO_EMM_DMA_FIFO_CMD_SIZE\tGENMASK_ULL(55, 36)\n\n#define MIO_EMM_CMD_SKIP_BUSY\t\tBIT_ULL(62)\n#define MIO_EMM_CMD_BUS_ID\t\tGENMASK_ULL(61, 60)\n#define MIO_EMM_CMD_VAL\t\t\tBIT_ULL(59)\n#define MIO_EMM_CMD_DBUF\t\tBIT_ULL(55)\n#define MIO_EMM_CMD_OFFSET\t\tGENMASK_ULL(54, 49)\n#define MIO_EMM_CMD_CTYPE_XOR\t\tGENMASK_ULL(42, 41)\n#define MIO_EMM_CMD_RTYPE_XOR\t\tGENMASK_ULL(40, 38)\n#define MIO_EMM_CMD_IDX\t\t\tGENMASK_ULL(37, 32)\n#define MIO_EMM_CMD_ARG\t\t\tGENMASK_ULL(31, 0)\n\n#define MIO_EMM_DMA_SKIP_BUSY\t\tBIT_ULL(62)\n#define MIO_EMM_DMA_BUS_ID\t\tGENMASK_ULL(61, 60)\n#define MIO_EMM_DMA_VAL\t\t\tBIT_ULL(59)\n#define MIO_EMM_DMA_SECTOR\t\tBIT_ULL(58)\n#define MIO_EMM_DMA_DAT_NULL\t\tBIT_ULL(57)\n#define MIO_EMM_DMA_THRES\t\tGENMASK_ULL(56, 51)\n#define MIO_EMM_DMA_REL_WR\t\tBIT_ULL(50)\n#define MIO_EMM_DMA_RW\t\t\tBIT_ULL(49)\n#define MIO_EMM_DMA_MULTI\t\tBIT_ULL(48)\n#define MIO_EMM_DMA_BLOCK_CNT\t\tGENMASK_ULL(47, 32)\n#define MIO_EMM_DMA_CARD_ADDR\t\tGENMASK_ULL(31, 0)\n\n#define MIO_EMM_DMA_CFG_EN\t\tBIT_ULL(63)\n#define MIO_EMM_DMA_CFG_RW\t\tBIT_ULL(62)\n#define MIO_EMM_DMA_CFG_CLR\t\tBIT_ULL(61)\n#define MIO_EMM_DMA_CFG_SWAP32\t\tBIT_ULL(59)\n#define MIO_EMM_DMA_CFG_SWAP16\t\tBIT_ULL(58)\n#define MIO_EMM_DMA_CFG_SWAP8\t\tBIT_ULL(57)\n#define MIO_EMM_DMA_CFG_ENDIAN\t\tBIT_ULL(56)\n#define MIO_EMM_DMA_CFG_SIZE\t\tGENMASK_ULL(55, 36)\n#define MIO_EMM_DMA_CFG_ADR\t\tGENMASK_ULL(35, 0)\n\n#define MIO_EMM_INT_SWITCH_ERR\t\tBIT_ULL(6)\n#define MIO_EMM_INT_SWITCH_DONE\t\tBIT_ULL(5)\n#define MIO_EMM_INT_DMA_ERR\t\tBIT_ULL(4)\n#define MIO_EMM_INT_CMD_ERR\t\tBIT_ULL(3)\n#define MIO_EMM_INT_DMA_DONE\t\tBIT_ULL(2)\n#define MIO_EMM_INT_CMD_DONE\t\tBIT_ULL(1)\n#define MIO_EMM_INT_BUF_DONE\t\tBIT_ULL(0)\n\n#define MIO_EMM_RSP_STS_BUS_ID\t\tGENMASK_ULL(61, 60)\n#define MIO_EMM_RSP_STS_CMD_VAL\t\tBIT_ULL(59)\n#define MIO_EMM_RSP_STS_SWITCH_VAL\tBIT_ULL(58)\n#define MIO_EMM_RSP_STS_DMA_VAL\t\tBIT_ULL(57)\n#define MIO_EMM_RSP_STS_DMA_PEND\tBIT_ULL(56)\n#define MIO_EMM_RSP_STS_DBUF_ERR\tBIT_ULL(28)\n#define MIO_EMM_RSP_STS_DBUF\t\tBIT_ULL(23)\n#define MIO_EMM_RSP_STS_BLK_TIMEOUT\tBIT_ULL(22)\n#define MIO_EMM_RSP_STS_BLK_CRC_ERR\tBIT_ULL(21)\n#define MIO_EMM_RSP_STS_RSP_BUSYBIT\tBIT_ULL(20)\n#define MIO_EMM_RSP_STS_STP_TIMEOUT\tBIT_ULL(19)\n#define MIO_EMM_RSP_STS_STP_CRC_ERR\tBIT_ULL(18)\n#define MIO_EMM_RSP_STS_STP_BAD_STS\tBIT_ULL(17)\n#define MIO_EMM_RSP_STS_STP_VAL\t\tBIT_ULL(16)\n#define MIO_EMM_RSP_STS_RSP_TIMEOUT\tBIT_ULL(15)\n#define MIO_EMM_RSP_STS_RSP_CRC_ERR\tBIT_ULL(14)\n#define MIO_EMM_RSP_STS_RSP_BAD_STS\tBIT_ULL(13)\n#define MIO_EMM_RSP_STS_RSP_VAL\t\tBIT_ULL(12)\n#define MIO_EMM_RSP_STS_RSP_TYPE\tGENMASK_ULL(11, 9)\n#define MIO_EMM_RSP_STS_CMD_TYPE\tGENMASK_ULL(8, 7)\n#define MIO_EMM_RSP_STS_CMD_IDX\t\tGENMASK_ULL(6, 1)\n#define MIO_EMM_RSP_STS_CMD_DONE\tBIT_ULL(0)\n\n#define MIO_EMM_SAMPLE_CMD_CNT\t\tGENMASK_ULL(25, 16)\n#define MIO_EMM_SAMPLE_DAT_CNT\t\tGENMASK_ULL(9, 0)\n\n#define MIO_EMM_SWITCH_BUS_ID\t\tGENMASK_ULL(61, 60)\n#define MIO_EMM_SWITCH_EXE\t\tBIT_ULL(59)\n#define MIO_EMM_SWITCH_ERR0\t\tBIT_ULL(58)\n#define MIO_EMM_SWITCH_ERR1\t\tBIT_ULL(57)\n#define MIO_EMM_SWITCH_ERR2\t\tBIT_ULL(56)\n#define MIO_EMM_SWITCH_HS_TIMING\tBIT_ULL(48)\n#define MIO_EMM_SWITCH_BUS_WIDTH\tGENMASK_ULL(42, 40)\n#define MIO_EMM_SWITCH_POWER_CLASS\tGENMASK_ULL(35, 32)\n#define MIO_EMM_SWITCH_CLK_HI\t\tGENMASK_ULL(31, 16)\n#define MIO_EMM_SWITCH_CLK_LO\t\tGENMASK_ULL(15, 0)\n\n \nirqreturn_t cvm_mmc_interrupt(int irq, void *dev_id);\nint cvm_mmc_of_slot_probe(struct device *dev, struct cvm_mmc_host *host);\nint cvm_mmc_of_slot_remove(struct cvm_mmc_slot *slot);\nextern const char *cvm_mmc_irq_names[];\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}