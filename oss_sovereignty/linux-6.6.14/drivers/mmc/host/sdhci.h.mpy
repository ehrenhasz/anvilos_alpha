{
  "module_name": "sdhci.h",
  "hash_id": "ffa0244c51b701e516c67d10f5071af9952b6c2af2d069b9042a0799dcd8c029",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mmc/host/sdhci.h",
  "human_readable_source": " \n \n#ifndef __SDHCI_HW_H\n#define __SDHCI_HW_H\n\n#include <linux/bits.h>\n#include <linux/scatterlist.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/io.h>\n#include <linux/leds.h>\n#include <linux/interrupt.h>\n\n#include <linux/mmc/host.h>\n\n \n\n#define SDHCI_DMA_ADDRESS\t0x00\n#define SDHCI_ARGUMENT2\t\tSDHCI_DMA_ADDRESS\n#define SDHCI_32BIT_BLK_CNT\tSDHCI_DMA_ADDRESS\n\n#define SDHCI_BLOCK_SIZE\t0x04\n#define  SDHCI_MAKE_BLKSZ(dma, blksz) (((dma & 0x7) << 12) | (blksz & 0xFFF))\n\n#define SDHCI_BLOCK_COUNT\t0x06\n\n#define SDHCI_ARGUMENT\t\t0x08\n\n#define SDHCI_TRANSFER_MODE\t0x0C\n#define  SDHCI_TRNS_DMA\t\t0x01\n#define  SDHCI_TRNS_BLK_CNT_EN\t0x02\n#define  SDHCI_TRNS_AUTO_CMD12\t0x04\n#define  SDHCI_TRNS_AUTO_CMD23\t0x08\n#define  SDHCI_TRNS_AUTO_SEL\t0x0C\n#define  SDHCI_TRNS_READ\t0x10\n#define  SDHCI_TRNS_MULTI\t0x20\n\n#define SDHCI_COMMAND\t\t0x0E\n#define  SDHCI_CMD_RESP_MASK\t0x03\n#define  SDHCI_CMD_CRC\t\t0x08\n#define  SDHCI_CMD_INDEX\t0x10\n#define  SDHCI_CMD_DATA\t\t0x20\n#define  SDHCI_CMD_ABORTCMD\t0xC0\n\n#define  SDHCI_CMD_RESP_NONE\t0x00\n#define  SDHCI_CMD_RESP_LONG\t0x01\n#define  SDHCI_CMD_RESP_SHORT\t0x02\n#define  SDHCI_CMD_RESP_SHORT_BUSY 0x03\n\n#define SDHCI_MAKE_CMD(c, f) (((c & 0xff) << 8) | (f & 0xff))\n#define SDHCI_GET_CMD(c) ((c>>8) & 0x3f)\n\n#define SDHCI_RESPONSE\t\t0x10\n\n#define SDHCI_BUFFER\t\t0x20\n\n#define SDHCI_PRESENT_STATE\t0x24\n#define  SDHCI_CMD_INHIBIT\t0x00000001\n#define  SDHCI_DATA_INHIBIT\t0x00000002\n#define  SDHCI_DOING_WRITE\t0x00000100\n#define  SDHCI_DOING_READ\t0x00000200\n#define  SDHCI_SPACE_AVAILABLE\t0x00000400\n#define  SDHCI_DATA_AVAILABLE\t0x00000800\n#define  SDHCI_CARD_PRESENT\t0x00010000\n#define   SDHCI_CARD_PRES_SHIFT\t16\n#define  SDHCI_CD_STABLE\t0x00020000\n#define  SDHCI_CD_LVL\t\t0x00040000\n#define   SDHCI_CD_LVL_SHIFT\t18\n#define  SDHCI_WRITE_PROTECT\t0x00080000\n#define  SDHCI_DATA_LVL_MASK\t0x00F00000\n#define   SDHCI_DATA_LVL_SHIFT\t20\n#define   SDHCI_DATA_0_LVL_MASK\t0x00100000\n#define  SDHCI_CMD_LVL\t\t0x01000000\n\n#define SDHCI_HOST_CONTROL\t0x28\n#define  SDHCI_CTRL_LED\t\t0x01\n#define  SDHCI_CTRL_4BITBUS\t0x02\n#define  SDHCI_CTRL_HISPD\t0x04\n#define  SDHCI_CTRL_DMA_MASK\t0x18\n#define   SDHCI_CTRL_SDMA\t0x00\n#define   SDHCI_CTRL_ADMA1\t0x08\n#define   SDHCI_CTRL_ADMA32\t0x10\n#define   SDHCI_CTRL_ADMA64\t0x18\n#define   SDHCI_CTRL_ADMA3\t0x18\n#define  SDHCI_CTRL_8BITBUS\t0x20\n#define  SDHCI_CTRL_CDTEST_INS\t0x40\n#define  SDHCI_CTRL_CDTEST_EN\t0x80\n\n#define SDHCI_POWER_CONTROL\t0x29\n#define  SDHCI_POWER_ON\t\t0x01\n#define  SDHCI_POWER_180\t0x0A\n#define  SDHCI_POWER_300\t0x0C\n#define  SDHCI_POWER_330\t0x0E\n \n#define  SDHCI_VDD2_POWER_ON\t0x10\n#define  SDHCI_VDD2_POWER_120\t0x80\n#define  SDHCI_VDD2_POWER_180\t0xA0\n\n#define SDHCI_BLOCK_GAP_CONTROL\t0x2A\n\n#define SDHCI_WAKE_UP_CONTROL\t0x2B\n#define  SDHCI_WAKE_ON_INT\t0x01\n#define  SDHCI_WAKE_ON_INSERT\t0x02\n#define  SDHCI_WAKE_ON_REMOVE\t0x04\n\n#define SDHCI_CLOCK_CONTROL\t0x2C\n#define  SDHCI_DIVIDER_SHIFT\t8\n#define  SDHCI_DIVIDER_HI_SHIFT\t6\n#define  SDHCI_DIV_MASK\t0xFF\n#define  SDHCI_DIV_MASK_LEN\t8\n#define  SDHCI_DIV_HI_MASK\t0x300\n#define  SDHCI_PROG_CLOCK_MODE\t0x0020\n#define  SDHCI_CLOCK_CARD_EN\t0x0004\n#define  SDHCI_CLOCK_PLL_EN\t0x0008\n#define  SDHCI_CLOCK_INT_STABLE\t0x0002\n#define  SDHCI_CLOCK_INT_EN\t0x0001\n\n#define SDHCI_TIMEOUT_CONTROL\t0x2E\n\n#define SDHCI_SOFTWARE_RESET\t0x2F\n#define  SDHCI_RESET_ALL\t0x01\n#define  SDHCI_RESET_CMD\t0x02\n#define  SDHCI_RESET_DATA\t0x04\n\n#define SDHCI_INT_STATUS\t0x30\n#define SDHCI_INT_ENABLE\t0x34\n#define SDHCI_SIGNAL_ENABLE\t0x38\n#define  SDHCI_INT_RESPONSE\t0x00000001\n#define  SDHCI_INT_DATA_END\t0x00000002\n#define  SDHCI_INT_BLK_GAP\t0x00000004\n#define  SDHCI_INT_DMA_END\t0x00000008\n#define  SDHCI_INT_SPACE_AVAIL\t0x00000010\n#define  SDHCI_INT_DATA_AVAIL\t0x00000020\n#define  SDHCI_INT_CARD_INSERT\t0x00000040\n#define  SDHCI_INT_CARD_REMOVE\t0x00000080\n#define  SDHCI_INT_CARD_INT\t0x00000100\n#define  SDHCI_INT_RETUNE\t0x00001000\n#define  SDHCI_INT_CQE\t\t0x00004000\n#define  SDHCI_INT_ERROR\t0x00008000\n#define  SDHCI_INT_TIMEOUT\t0x00010000\n#define  SDHCI_INT_CRC\t\t0x00020000\n#define  SDHCI_INT_END_BIT\t0x00040000\n#define  SDHCI_INT_INDEX\t0x00080000\n#define  SDHCI_INT_DATA_TIMEOUT\t0x00100000\n#define  SDHCI_INT_DATA_CRC\t0x00200000\n#define  SDHCI_INT_DATA_END_BIT\t0x00400000\n#define  SDHCI_INT_BUS_POWER\t0x00800000\n#define  SDHCI_INT_AUTO_CMD_ERR\t0x01000000\n#define  SDHCI_INT_ADMA_ERROR\t0x02000000\n\n#define  SDHCI_INT_NORMAL_MASK\t0x00007FFF\n#define  SDHCI_INT_ERROR_MASK\t0xFFFF8000\n\n#define  SDHCI_INT_CMD_MASK\t(SDHCI_INT_RESPONSE | SDHCI_INT_TIMEOUT | \\\n\t\tSDHCI_INT_CRC | SDHCI_INT_END_BIT | SDHCI_INT_INDEX | \\\n\t\tSDHCI_INT_AUTO_CMD_ERR)\n#define  SDHCI_INT_DATA_MASK\t(SDHCI_INT_DATA_END | SDHCI_INT_DMA_END | \\\n\t\tSDHCI_INT_DATA_AVAIL | SDHCI_INT_SPACE_AVAIL | \\\n\t\tSDHCI_INT_DATA_TIMEOUT | SDHCI_INT_DATA_CRC | \\\n\t\tSDHCI_INT_DATA_END_BIT | SDHCI_INT_ADMA_ERROR | \\\n\t\tSDHCI_INT_BLK_GAP)\n#define SDHCI_INT_ALL_MASK\t((unsigned int)-1)\n\n#define SDHCI_CQE_INT_ERR_MASK ( \\\n\tSDHCI_INT_ADMA_ERROR | SDHCI_INT_BUS_POWER | SDHCI_INT_DATA_END_BIT | \\\n\tSDHCI_INT_DATA_CRC | SDHCI_INT_DATA_TIMEOUT | SDHCI_INT_INDEX | \\\n\tSDHCI_INT_END_BIT | SDHCI_INT_CRC | SDHCI_INT_TIMEOUT)\n\n#define SDHCI_CQE_INT_MASK (SDHCI_CQE_INT_ERR_MASK | SDHCI_INT_CQE)\n\n#define SDHCI_AUTO_CMD_STATUS\t0x3C\n#define  SDHCI_AUTO_CMD_TIMEOUT\t0x00000002\n#define  SDHCI_AUTO_CMD_CRC\t0x00000004\n#define  SDHCI_AUTO_CMD_END_BIT\t0x00000008\n#define  SDHCI_AUTO_CMD_INDEX\t0x00000010\n\n#define SDHCI_HOST_CONTROL2\t\t0x3E\n#define  SDHCI_CTRL_UHS_MASK\t\t0x0007\n#define   SDHCI_CTRL_UHS_SDR12\t\t0x0000\n#define   SDHCI_CTRL_UHS_SDR25\t\t0x0001\n#define   SDHCI_CTRL_UHS_SDR50\t\t0x0002\n#define   SDHCI_CTRL_UHS_SDR104\t\t0x0003\n#define   SDHCI_CTRL_UHS_DDR50\t\t0x0004\n#define   SDHCI_CTRL_HS400\t\t0x0005  \n#define  SDHCI_CTRL_VDD_180\t\t0x0008\n#define  SDHCI_CTRL_DRV_TYPE_MASK\t0x0030\n#define   SDHCI_CTRL_DRV_TYPE_B\t\t0x0000\n#define   SDHCI_CTRL_DRV_TYPE_A\t\t0x0010\n#define   SDHCI_CTRL_DRV_TYPE_C\t\t0x0020\n#define   SDHCI_CTRL_DRV_TYPE_D\t\t0x0030\n#define  SDHCI_CTRL_EXEC_TUNING\t\t0x0040\n#define  SDHCI_CTRL_TUNED_CLK\t\t0x0080\n#define  SDHCI_CMD23_ENABLE\t\t0x0800\n#define  SDHCI_CTRL_V4_MODE\t\t0x1000\n#define  SDHCI_CTRL_64BIT_ADDR\t\t0x2000\n#define  SDHCI_CTRL_PRESET_VAL_ENABLE\t0x8000\n\n#define SDHCI_CAPABILITIES\t0x40\n#define  SDHCI_TIMEOUT_CLK_MASK\t\tGENMASK(5, 0)\n#define  SDHCI_TIMEOUT_CLK_SHIFT 0\n#define  SDHCI_TIMEOUT_CLK_UNIT\t0x00000080\n#define  SDHCI_CLOCK_BASE_MASK\t\tGENMASK(13, 8)\n#define  SDHCI_CLOCK_BASE_SHIFT\t8\n#define  SDHCI_CLOCK_V3_BASE_MASK\tGENMASK(15, 8)\n#define  SDHCI_MAX_BLOCK_MASK\t0x00030000\n#define  SDHCI_MAX_BLOCK_SHIFT  16\n#define  SDHCI_CAN_DO_8BIT\t0x00040000\n#define  SDHCI_CAN_DO_ADMA2\t0x00080000\n#define  SDHCI_CAN_DO_ADMA1\t0x00100000\n#define  SDHCI_CAN_DO_HISPD\t0x00200000\n#define  SDHCI_CAN_DO_SDMA\t0x00400000\n#define  SDHCI_CAN_DO_SUSPEND\t0x00800000\n#define  SDHCI_CAN_VDD_330\t0x01000000\n#define  SDHCI_CAN_VDD_300\t0x02000000\n#define  SDHCI_CAN_VDD_180\t0x04000000\n#define  SDHCI_CAN_64BIT_V4\t0x08000000\n#define  SDHCI_CAN_64BIT\t0x10000000\n\n#define SDHCI_CAPABILITIES_1\t0x44\n#define  SDHCI_SUPPORT_SDR50\t0x00000001\n#define  SDHCI_SUPPORT_SDR104\t0x00000002\n#define  SDHCI_SUPPORT_DDR50\t0x00000004\n#define  SDHCI_DRIVER_TYPE_A\t0x00000010\n#define  SDHCI_DRIVER_TYPE_C\t0x00000020\n#define  SDHCI_DRIVER_TYPE_D\t0x00000040\n#define  SDHCI_RETUNING_TIMER_COUNT_MASK\tGENMASK(11, 8)\n#define  SDHCI_USE_SDR50_TUNING\t\t\t0x00002000\n#define  SDHCI_RETUNING_MODE_MASK\t\tGENMASK(15, 14)\n#define  SDHCI_CLOCK_MUL_MASK\t\t\tGENMASK(23, 16)\n#define  SDHCI_CAN_DO_ADMA3\t0x08000000\n#define  SDHCI_SUPPORT_HS400\t0x80000000  \n\n#define SDHCI_MAX_CURRENT\t\t0x48\n#define  SDHCI_MAX_CURRENT_LIMIT\tGENMASK(7, 0)\n#define  SDHCI_MAX_CURRENT_330_MASK\tGENMASK(7, 0)\n#define  SDHCI_MAX_CURRENT_300_MASK\tGENMASK(15, 8)\n#define  SDHCI_MAX_CURRENT_180_MASK\tGENMASK(23, 16)\n#define   SDHCI_MAX_CURRENT_MULTIPLIER\t4\n\n \n\n#define SDHCI_SET_ACMD12_ERROR\t0x50\n#define SDHCI_SET_INT_ERROR\t0x52\n\n#define SDHCI_ADMA_ERROR\t0x54\n\n \n\n#define SDHCI_ADMA_ADDRESS\t0x58\n#define SDHCI_ADMA_ADDRESS_HI\t0x5C\n\n \n\n#define SDHCI_PRESET_FOR_HIGH_SPEED\t0x64\n#define SDHCI_PRESET_FOR_SDR12 0x66\n#define SDHCI_PRESET_FOR_SDR25 0x68\n#define SDHCI_PRESET_FOR_SDR50 0x6A\n#define SDHCI_PRESET_FOR_SDR104        0x6C\n#define SDHCI_PRESET_FOR_DDR50 0x6E\n#define SDHCI_PRESET_FOR_HS400 0x74  \n#define SDHCI_PRESET_DRV_MASK\t\tGENMASK(15, 14)\n#define SDHCI_PRESET_CLKGEN_SEL\t\tBIT(10)\n#define SDHCI_PRESET_SDCLK_FREQ_MASK\tGENMASK(9, 0)\n\n#define SDHCI_SLOT_INT_STATUS\t0xFC\n\n#define SDHCI_HOST_VERSION\t0xFE\n#define  SDHCI_VENDOR_VER_MASK\t0xFF00\n#define  SDHCI_VENDOR_VER_SHIFT\t8\n#define  SDHCI_SPEC_VER_MASK\t0x00FF\n#define  SDHCI_SPEC_VER_SHIFT\t0\n#define   SDHCI_SPEC_100\t0\n#define   SDHCI_SPEC_200\t1\n#define   SDHCI_SPEC_300\t2\n#define   SDHCI_SPEC_400\t3\n#define   SDHCI_SPEC_410\t4\n#define   SDHCI_SPEC_420\t5\n\n \n\n#define SDHCI_MAX_DIV_SPEC_200\t256\n#define SDHCI_MAX_DIV_SPEC_300\t2046\n\n \n#define SDHCI_DEFAULT_BOUNDARY_SIZE  (512 * 1024)\n#define SDHCI_DEFAULT_BOUNDARY_ARG   (ilog2(SDHCI_DEFAULT_BOUNDARY_SIZE) - 12)\n\n \n#define SDHCI_ADMA2_32_DESC_SZ\t8\n\n \nstruct sdhci_adma2_32_desc {\n\t__le16\tcmd;\n\t__le16\tlen;\n\t__le32\taddr;\n}  __packed __aligned(4);\n\n \n#define SDHCI_ADMA2_ALIGN\t4\n#define SDHCI_ADMA2_MASK\t(SDHCI_ADMA2_ALIGN - 1)\n\n \n#define SDHCI_ADMA2_DESC_ALIGN\t8\n\n \n#define SDHCI_ADMA2_64_DESC_SZ(host)\t((host)->v4_mode ? 16 : 12)\n\n \nstruct sdhci_adma2_64_desc {\n\t__le16\tcmd;\n\t__le16\tlen;\n\t__le32\taddr_lo;\n\t__le32\taddr_hi;\n}  __packed __aligned(4);\n\n#define ADMA2_TRAN_VALID\t0x21\n#define ADMA2_NOP_END_VALID\t0x3\n#define ADMA2_END\t\t0x2\n\n \n#define SDHCI_MAX_SEGS\t\t128\n\n \n#define SDHCI_MAX_MRQS\t\t2\n\n \n#define MMC_CMD_TRANSFER_TIME\t(10 * NSEC_PER_MSEC)  \n\n#define sdhci_err_stats_inc(host, err_name) \\\n\tmmc_debugfs_err_stats_inc((host)->mmc, MMC_ERR_##err_name)\n\nenum sdhci_cookie {\n\tCOOKIE_UNMAPPED,\n\tCOOKIE_PRE_MAPPED,\t \n\tCOOKIE_MAPPED,\t\t \n};\n\nstruct sdhci_host {\n\t \n\tconst char *hw_name;\t \n\n\tunsigned int quirks;\t \n\n \n#define SDHCI_QUIRK_CLOCK_BEFORE_RESET\t\t\t(1<<0)\n \n#define SDHCI_QUIRK_FORCE_DMA\t\t\t\t(1<<1)\n \n#define SDHCI_QUIRK_NO_CARD_NO_RESET\t\t\t(1<<2)\n \n#define SDHCI_QUIRK_SINGLE_POWER_WRITE\t\t\t(1<<3)\n \n#define SDHCI_QUIRK_BROKEN_DMA\t\t\t\t(1<<5)\n \n#define SDHCI_QUIRK_BROKEN_ADMA\t\t\t\t(1<<6)\n \n#define SDHCI_QUIRK_32BIT_DMA_ADDR\t\t\t(1<<7)\n \n#define SDHCI_QUIRK_32BIT_DMA_SIZE\t\t\t(1<<8)\n \n#define SDHCI_QUIRK_32BIT_ADMA_SIZE\t\t\t(1<<9)\n \n#define SDHCI_QUIRK_RESET_AFTER_REQUEST\t\t\t(1<<10)\n \n#define SDHCI_QUIRK_NO_SIMULT_VDD_AND_POWER\t\t(1<<11)\n \n#define SDHCI_QUIRK_BROKEN_TIMEOUT_VAL\t\t\t(1<<12)\n \n#define SDHCI_QUIRK_BROKEN_SMALL_PIO\t\t\t(1<<13)\n \n#define SDHCI_QUIRK_NO_BUSY_IRQ\t\t\t\t(1<<14)\n \n#define SDHCI_QUIRK_BROKEN_CARD_DETECTION\t\t(1<<15)\n \n#define SDHCI_QUIRK_INVERTED_WRITE_PROTECT\t\t(1<<16)\n \n#define SDHCI_QUIRK_BROKEN_CQE\t\t\t\t(1<<17)\n \n#define SDHCI_QUIRK_PIO_NEEDS_DELAY\t\t\t(1<<18)\n \n#define SDHCI_QUIRK_NO_LED\t\t\t\t(1<<19)\n \n#define SDHCI_QUIRK_FORCE_BLK_SZ_2048\t\t\t(1<<20)\n \n#define SDHCI_QUIRK_NO_MULTIBLOCK\t\t\t(1<<21)\n \n#define SDHCI_QUIRK_FORCE_1_BIT_DATA\t\t\t(1<<22)\n \n#define SDHCI_QUIRK_DELAY_AFTER_POWER\t\t\t(1<<23)\n \n#define SDHCI_QUIRK_DATA_TIMEOUT_USES_SDCLK\t\t(1<<24)\n \n#define SDHCI_QUIRK_CAP_CLOCK_BASE_BROKEN\t\t(1<<25)\n \n#define SDHCI_QUIRK_NO_ENDATTR_IN_NOPDESC\t\t(1<<26)\n \n#define SDHCI_QUIRK_MULTIBLOCK_READ_ACMD12\t\t(1<<28)\n \n#define SDHCI_QUIRK_NO_HISPD_BIT\t\t\t(1<<29)\n \n#define SDHCI_QUIRK_BROKEN_ADMA_ZEROLEN_DESC\t\t(1<<30)\n \n#define SDHCI_QUIRK_UNSTABLE_RO_DETECT\t\t\t(1<<31)\n\n\tunsigned int quirks2;\t \n\n#define SDHCI_QUIRK2_HOST_OFF_CARD_ON\t\t\t(1<<0)\n#define SDHCI_QUIRK2_HOST_NO_CMD23\t\t\t(1<<1)\n \n#define SDHCI_QUIRK2_NO_1_8_V\t\t\t\t(1<<2)\n#define SDHCI_QUIRK2_PRESET_VALUE_BROKEN\t\t(1<<3)\n#define SDHCI_QUIRK2_CARD_ON_NEEDS_BUS_ON\t\t(1<<4)\n \n#define SDHCI_QUIRK2_BROKEN_HOST_CONTROL\t\t(1<<5)\n \n#define SDHCI_QUIRK2_BROKEN_HS200\t\t\t(1<<6)\n \n#define SDHCI_QUIRK2_BROKEN_DDR50\t\t\t(1<<7)\n \n#define SDHCI_QUIRK2_STOP_WITH_TC\t\t\t(1<<8)\n \n#define SDHCI_QUIRK2_BROKEN_64_BIT_DMA\t\t\t(1<<9)\n \n#define SDHCI_QUIRK2_CLEAR_TRANSFERMODE_REG_BEFORE_CMD\t(1<<10)\n \n#define SDHCI_QUIRK2_CAPS_BIT63_FOR_HS400\t\t(1<<11)\n \n#define SDHCI_QUIRK2_TUNING_WORK_AROUND\t\t\t(1<<12)\n \n#define SDHCI_QUIRK2_SUPPORT_SINGLE\t\t\t(1<<13)\n \n#define SDHCI_QUIRK2_ACMD23_BROKEN\t\t\t(1<<14)\n \n#define SDHCI_QUIRK2_CLOCK_DIV_ZERO_BROKEN\t\t(1<<15)\n \n#define SDHCI_QUIRK2_RSP_136_HAS_CRC\t\t\t(1<<16)\n \n#define SDHCI_QUIRK2_DISABLE_HW_TIMEOUT\t\t\t(1<<17)\n \n#define SDHCI_QUIRK2_USE_32BIT_BLK_CNT\t\t\t(1<<18)\n \n#define SDHCI_QUIRK2_ISSUE_CMD_DAT_RESET_TOGETHER\t(1<<19)\n\n\tint irq;\t\t \n\tvoid __iomem *ioaddr;\t \n\tphys_addr_t mapbase;\t \n\tchar *bounce_buffer;\t \n\tdma_addr_t bounce_addr;\n\tunsigned int bounce_buffer_size;\n\n\tconst struct sdhci_ops *ops;\t \n\n\t \n\tstruct mmc_host *mmc;\t \n\tstruct mmc_host_ops mmc_host_ops;\t \n\tu64 dma_mask;\t\t \n\n#if IS_ENABLED(CONFIG_LEDS_CLASS)\n\tstruct led_classdev led;\t \n\tchar led_name[32];\n#endif\n\n\tspinlock_t lock;\t \n\n\tint flags;\t\t \n#define SDHCI_USE_SDMA\t\t(1<<0)\t \n#define SDHCI_USE_ADMA\t\t(1<<1)\t \n#define SDHCI_REQ_USE_DMA\t(1<<2)\t \n#define SDHCI_DEVICE_DEAD\t(1<<3)\t \n#define SDHCI_SDR50_NEEDS_TUNING (1<<4)\t \n#define SDHCI_AUTO_CMD12\t(1<<6)\t \n#define SDHCI_AUTO_CMD23\t(1<<7)\t \n#define SDHCI_PV_ENABLED\t(1<<8)\t \n#define SDHCI_USE_64_BIT_DMA\t(1<<12)\t \n#define SDHCI_HS400_TUNING\t(1<<13)\t \n#define SDHCI_SIGNALING_330\t(1<<14)\t \n#define SDHCI_SIGNALING_180\t(1<<15)\t \n#define SDHCI_SIGNALING_120\t(1<<16)\t \n\n\tunsigned int version;\t \n\n\tunsigned int max_clk;\t \n\tunsigned int timeout_clk;\t \n\tu8 max_timeout_count;\t \n\tunsigned int clk_mul;\t \n\n\tunsigned int clock;\t \n\tu8 pwr;\t\t\t \n\tu8 drv_type;\t\t \n\tbool reinit_uhs;\t \n\n\tbool runtime_suspended;\t \n\tbool bus_on;\t\t \n\tbool preset_enabled;\t \n\tbool pending_reset;\t \n\tbool irq_wake_enabled;\t \n\tbool v4_mode;\t\t \n\tbool use_external_dma;\t \n\tbool always_defer_done;\t \n\n\tstruct mmc_request *mrqs_done[SDHCI_MAX_MRQS];\t \n\tstruct mmc_command *cmd;\t \n\tstruct mmc_command *data_cmd;\t \n\tstruct mmc_command *deferred_cmd;\t \n\tstruct mmc_data *data;\t \n\tunsigned int data_early:1;\t \n\n\tstruct sg_mapping_iter sg_miter;\t \n\tunsigned int blocks;\t \n\n\tint sg_count;\t\t \n\tint max_adma;\t\t \n\n\tvoid *adma_table;\t \n\tvoid *align_buffer;\t \n\n\tsize_t adma_table_sz;\t \n\tsize_t align_buffer_sz;\t \n\n\tdma_addr_t adma_addr;\t \n\tdma_addr_t align_addr;\t \n\n\tunsigned int desc_sz;\t \n\tunsigned int alloc_desc_sz;\t \n\n\tstruct workqueue_struct *complete_wq;\t \n\tstruct work_struct\tcomplete_work;\t \n\n\tstruct timer_list timer;\t \n\tstruct timer_list data_timer;\t \n\n#if IS_ENABLED(CONFIG_MMC_SDHCI_EXTERNAL_DMA)\n\tstruct dma_chan *rx_chan;\n\tstruct dma_chan *tx_chan;\n#endif\n\n\tu32 caps;\t\t \n\tu32 caps1;\t\t \n\tbool read_caps;\t\t \n\n\tbool sdhci_core_to_disable_vqmmc;   \n\tunsigned int            ocr_avail_sdio;\t \n\tunsigned int            ocr_avail_sd;\n\tunsigned int            ocr_avail_mmc;\n\tu32 ocr_mask;\t\t \n\n\tunsigned\t\ttiming;\t\t \n\n\tu32\t\t\tthread_isr;\n\n\t \n\tu32\t\t\tier;\n\n\tbool\t\t\tcqe_on;\t\t \n\tu32\t\t\tcqe_ier;\t \n\tu32\t\t\tcqe_err_ier;\t \n\n\twait_queue_head_t\tbuf_ready_int;\t \n\tunsigned int\t\ttuning_done;\t \n\n\tunsigned int\t\ttuning_count;\t \n\tunsigned int\t\ttuning_mode;\t \n\tunsigned int\t\ttuning_err;\t \n#define SDHCI_TUNING_MODE_1\t0\n#define SDHCI_TUNING_MODE_2\t1\n#define SDHCI_TUNING_MODE_3\t2\n\t \n\tint\t\t\ttuning_delay;\n\tint\t\t\ttuning_loop_count;\n\n\t \n\tu32\t\t\tsdma_boundary;\n\n\t \n\tu32\t\t\tadma_table_cnt;\n\n\tu64\t\t\tdata_timeout;\n\n\tunsigned long private[] ____cacheline_aligned;\n};\n\nstruct sdhci_ops {\n#ifdef CONFIG_MMC_SDHCI_IO_ACCESSORS\n\tu32\t\t(*read_l)(struct sdhci_host *host, int reg);\n\tu16\t\t(*read_w)(struct sdhci_host *host, int reg);\n\tu8\t\t(*read_b)(struct sdhci_host *host, int reg);\n\tvoid\t\t(*write_l)(struct sdhci_host *host, u32 val, int reg);\n\tvoid\t\t(*write_w)(struct sdhci_host *host, u16 val, int reg);\n\tvoid\t\t(*write_b)(struct sdhci_host *host, u8 val, int reg);\n#endif\n\n\tvoid\t(*set_clock)(struct sdhci_host *host, unsigned int clock);\n\tvoid\t(*set_power)(struct sdhci_host *host, unsigned char mode,\n\t\t\t     unsigned short vdd);\n\n\tu32\t\t(*irq)(struct sdhci_host *host, u32 intmask);\n\n\tint\t\t(*set_dma_mask)(struct sdhci_host *host);\n\tint\t\t(*enable_dma)(struct sdhci_host *host);\n\tunsigned int\t(*get_max_clock)(struct sdhci_host *host);\n\tunsigned int\t(*get_min_clock)(struct sdhci_host *host);\n\t \n\tunsigned int\t(*get_timeout_clock)(struct sdhci_host *host);\n\tunsigned int\t(*get_max_timeout_count)(struct sdhci_host *host);\n\tvoid\t\t(*set_timeout)(struct sdhci_host *host,\n\t\t\t\t       struct mmc_command *cmd);\n\tvoid\t\t(*set_bus_width)(struct sdhci_host *host, int width);\n\tvoid (*platform_send_init_74_clocks)(struct sdhci_host *host,\n\t\t\t\t\t     u8 power_mode);\n\tunsigned int    (*get_ro)(struct sdhci_host *host);\n\tvoid\t\t(*reset)(struct sdhci_host *host, u8 mask);\n\tint\t(*platform_execute_tuning)(struct sdhci_host *host, u32 opcode);\n\tvoid\t(*set_uhs_signaling)(struct sdhci_host *host, unsigned int uhs);\n\tvoid\t(*hw_reset)(struct sdhci_host *host);\n\tvoid    (*adma_workaround)(struct sdhci_host *host, u32 intmask);\n\tvoid    (*card_event)(struct sdhci_host *host);\n\tvoid\t(*voltage_switch)(struct sdhci_host *host);\n\tvoid\t(*adma_write_desc)(struct sdhci_host *host, void **desc,\n\t\t\t\t   dma_addr_t addr, int len, unsigned int cmd);\n\tvoid\t(*copy_to_bounce_buffer)(struct sdhci_host *host,\n\t\t\t\t\t struct mmc_data *data,\n\t\t\t\t\t unsigned int length);\n\tvoid\t(*request_done)(struct sdhci_host *host,\n\t\t\t\tstruct mmc_request *mrq);\n\tvoid    (*dump_vendor_regs)(struct sdhci_host *host);\n};\n\n#ifdef CONFIG_MMC_SDHCI_IO_ACCESSORS\n\nstatic inline void sdhci_writel(struct sdhci_host *host, u32 val, int reg)\n{\n\tif (unlikely(host->ops->write_l))\n\t\thost->ops->write_l(host, val, reg);\n\telse\n\t\twritel(val, host->ioaddr + reg);\n}\n\nstatic inline void sdhci_writew(struct sdhci_host *host, u16 val, int reg)\n{\n\tif (unlikely(host->ops->write_w))\n\t\thost->ops->write_w(host, val, reg);\n\telse\n\t\twritew(val, host->ioaddr + reg);\n}\n\nstatic inline void sdhci_writeb(struct sdhci_host *host, u8 val, int reg)\n{\n\tif (unlikely(host->ops->write_b))\n\t\thost->ops->write_b(host, val, reg);\n\telse\n\t\twriteb(val, host->ioaddr + reg);\n}\n\nstatic inline u32 sdhci_readl(struct sdhci_host *host, int reg)\n{\n\tif (unlikely(host->ops->read_l))\n\t\treturn host->ops->read_l(host, reg);\n\telse\n\t\treturn readl(host->ioaddr + reg);\n}\n\nstatic inline u16 sdhci_readw(struct sdhci_host *host, int reg)\n{\n\tif (unlikely(host->ops->read_w))\n\t\treturn host->ops->read_w(host, reg);\n\telse\n\t\treturn readw(host->ioaddr + reg);\n}\n\nstatic inline u8 sdhci_readb(struct sdhci_host *host, int reg)\n{\n\tif (unlikely(host->ops->read_b))\n\t\treturn host->ops->read_b(host, reg);\n\telse\n\t\treturn readb(host->ioaddr + reg);\n}\n\n#else\n\nstatic inline void sdhci_writel(struct sdhci_host *host, u32 val, int reg)\n{\n\twritel(val, host->ioaddr + reg);\n}\n\nstatic inline void sdhci_writew(struct sdhci_host *host, u16 val, int reg)\n{\n\twritew(val, host->ioaddr + reg);\n}\n\nstatic inline void sdhci_writeb(struct sdhci_host *host, u8 val, int reg)\n{\n\twriteb(val, host->ioaddr + reg);\n}\n\nstatic inline u32 sdhci_readl(struct sdhci_host *host, int reg)\n{\n\treturn readl(host->ioaddr + reg);\n}\n\nstatic inline u16 sdhci_readw(struct sdhci_host *host, int reg)\n{\n\treturn readw(host->ioaddr + reg);\n}\n\nstatic inline u8 sdhci_readb(struct sdhci_host *host, int reg)\n{\n\treturn readb(host->ioaddr + reg);\n}\n\n#endif  \n\nstruct sdhci_host *sdhci_alloc_host(struct device *dev, size_t priv_size);\nvoid sdhci_free_host(struct sdhci_host *host);\n\nstatic inline void *sdhci_priv(struct sdhci_host *host)\n{\n\treturn host->private;\n}\n\nvoid __sdhci_read_caps(struct sdhci_host *host, const u16 *ver,\n\t\t       const u32 *caps, const u32 *caps1);\nint sdhci_setup_host(struct sdhci_host *host);\nvoid sdhci_cleanup_host(struct sdhci_host *host);\nint __sdhci_add_host(struct sdhci_host *host);\nint sdhci_add_host(struct sdhci_host *host);\nvoid sdhci_remove_host(struct sdhci_host *host, int dead);\n\nstatic inline void sdhci_read_caps(struct sdhci_host *host)\n{\n\t__sdhci_read_caps(host, NULL, NULL, NULL);\n}\n\nu16 sdhci_calc_clk(struct sdhci_host *host, unsigned int clock,\n\t\t   unsigned int *actual_clock);\nvoid sdhci_set_clock(struct sdhci_host *host, unsigned int clock);\nvoid sdhci_enable_clk(struct sdhci_host *host, u16 clk);\nvoid sdhci_set_power(struct sdhci_host *host, unsigned char mode,\n\t\t     unsigned short vdd);\nvoid sdhci_set_power_and_bus_voltage(struct sdhci_host *host,\n\t\t\t\t     unsigned char mode,\n\t\t\t\t     unsigned short vdd);\nvoid sdhci_set_power_noreg(struct sdhci_host *host, unsigned char mode,\n\t\t\t   unsigned short vdd);\nint sdhci_get_cd_nogpio(struct mmc_host *mmc);\nvoid sdhci_request(struct mmc_host *mmc, struct mmc_request *mrq);\nint sdhci_request_atomic(struct mmc_host *mmc, struct mmc_request *mrq);\nvoid sdhci_set_bus_width(struct sdhci_host *host, int width);\nvoid sdhci_reset(struct sdhci_host *host, u8 mask);\nvoid sdhci_set_uhs_signaling(struct sdhci_host *host, unsigned timing);\nint sdhci_execute_tuning(struct mmc_host *mmc, u32 opcode);\nvoid sdhci_set_ios(struct mmc_host *mmc, struct mmc_ios *ios);\nint sdhci_start_signal_voltage_switch(struct mmc_host *mmc,\n\t\t\t\t      struct mmc_ios *ios);\nvoid sdhci_enable_sdio_irq(struct mmc_host *mmc, int enable);\nvoid sdhci_adma_write_desc(struct sdhci_host *host, void **desc,\n\t\t\t   dma_addr_t addr, int len, unsigned int cmd);\n\n#ifdef CONFIG_PM\nint sdhci_suspend_host(struct sdhci_host *host);\nint sdhci_resume_host(struct sdhci_host *host);\nint sdhci_runtime_suspend_host(struct sdhci_host *host);\nint sdhci_runtime_resume_host(struct sdhci_host *host, int soft_reset);\n#endif\n\nvoid sdhci_cqe_enable(struct mmc_host *mmc);\nvoid sdhci_cqe_disable(struct mmc_host *mmc, bool recovery);\nbool sdhci_cqe_irq(struct sdhci_host *host, u32 intmask, int *cmd_error,\n\t\t   int *data_error);\n\nvoid sdhci_dumpregs(struct sdhci_host *host);\nvoid sdhci_enable_v4_mode(struct sdhci_host *host);\n\nvoid sdhci_start_tuning(struct sdhci_host *host);\nvoid sdhci_end_tuning(struct sdhci_host *host);\nvoid sdhci_reset_tuning(struct sdhci_host *host);\nvoid sdhci_send_tuning(struct sdhci_host *host, u32 opcode);\nvoid sdhci_abort_tuning(struct sdhci_host *host, u32 opcode);\nvoid sdhci_switch_external_dma(struct sdhci_host *host, bool en);\nvoid sdhci_set_data_timeout_irq(struct sdhci_host *host, bool enable);\nvoid __sdhci_set_timeout(struct sdhci_host *host, struct mmc_command *cmd);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}