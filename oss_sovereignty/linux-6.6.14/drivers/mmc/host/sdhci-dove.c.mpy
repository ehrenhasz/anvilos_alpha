{
  "module_name": "sdhci-dove.c",
  "hash_id": "b5f75c44bb9752cb89a0fb2a0525edbf70dc8da9a86cc4e94b09d2449c1c707d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mmc/host/sdhci-dove.c",
  "human_readable_source": "\n \n\n#include <linux/clk.h>\n#include <linux/err.h>\n#include <linux/io.h>\n#include <linux/mmc/host.h>\n#include <linux/module.h>\n#include <linux/of.h>\n\n#include \"sdhci-pltfm.h\"\n\nstatic u16 sdhci_dove_readw(struct sdhci_host *host, int reg)\n{\n\tu16 ret;\n\n\tswitch (reg) {\n\tcase SDHCI_HOST_VERSION:\n\tcase SDHCI_SLOT_INT_STATUS:\n\t\t \n\t\treturn 0;\n\tdefault:\n\t\tret = readw(host->ioaddr + reg);\n\t}\n\treturn ret;\n}\n\nstatic u32 sdhci_dove_readl(struct sdhci_host *host, int reg)\n{\n\tu32 ret;\n\n\tret = readl(host->ioaddr + reg);\n\n\tswitch (reg) {\n\tcase SDHCI_CAPABILITIES:\n\t\t \n\t\tret &= ~SDHCI_CAN_VDD_300;\n\t\tbreak;\n\t}\n\treturn ret;\n}\n\nstatic const struct sdhci_ops sdhci_dove_ops = {\n\t.read_w\t= sdhci_dove_readw,\n\t.read_l\t= sdhci_dove_readl,\n\t.set_clock = sdhci_set_clock,\n\t.set_bus_width = sdhci_set_bus_width,\n\t.reset = sdhci_reset,\n\t.set_uhs_signaling = sdhci_set_uhs_signaling,\n};\n\nstatic const struct sdhci_pltfm_data sdhci_dove_pdata = {\n\t.ops\t= &sdhci_dove_ops,\n\t.quirks\t= SDHCI_QUIRK_NO_SIMULT_VDD_AND_POWER |\n\t\t  SDHCI_QUIRK_NO_BUSY_IRQ |\n\t\t  SDHCI_QUIRK_BROKEN_TIMEOUT_VAL |\n\t\t  SDHCI_QUIRK_FORCE_DMA |\n\t\t  SDHCI_QUIRK_NO_HISPD_BIT,\n};\n\nstatic int sdhci_dove_probe(struct platform_device *pdev)\n{\n\tstruct sdhci_host *host;\n\tstruct sdhci_pltfm_host *pltfm_host;\n\tint ret;\n\n\thost = sdhci_pltfm_init(pdev, &sdhci_dove_pdata, 0);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tpltfm_host = sdhci_priv(host);\n\tpltfm_host->clk = devm_clk_get_enabled(&pdev->dev, NULL);\n\n\tret = mmc_of_parse(host->mmc);\n\tif (ret)\n\t\tgoto err_sdhci_add;\n\n\tret = sdhci_add_host(host);\n\tif (ret)\n\t\tgoto err_sdhci_add;\n\n\treturn 0;\n\nerr_sdhci_add:\n\tsdhci_pltfm_free(pdev);\n\treturn ret;\n}\n\nstatic const struct of_device_id sdhci_dove_of_match_table[] = {\n\t{ .compatible = \"marvell,dove-sdhci\", },\n\t{}\n};\nMODULE_DEVICE_TABLE(of, sdhci_dove_of_match_table);\n\nstatic struct platform_driver sdhci_dove_driver = {\n\t.driver\t\t= {\n\t\t.name\t= \"sdhci-dove\",\n\t\t.probe_type = PROBE_PREFER_ASYNCHRONOUS,\n\t\t.pm\t= &sdhci_pltfm_pmops,\n\t\t.of_match_table = sdhci_dove_of_match_table,\n\t},\n\t.probe\t\t= sdhci_dove_probe,\n\t.remove_new\t= sdhci_pltfm_remove,\n};\n\nmodule_platform_driver(sdhci_dove_driver);\n\nMODULE_DESCRIPTION(\"SDHCI driver for Dove\");\nMODULE_AUTHOR(\"Saeed Bishara <saeed@marvell.com>, \"\n\t      \"Mike Rapoport <mike@compulab.co.il>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}