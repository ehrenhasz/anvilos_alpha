{
  "module_name": "crypto.c",
  "hash_id": "e6318a6a3c7d7a0ff3cde056242db03694642f6d24f478cdf9a37d5a342c8da5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mmc/core/crypto.c",
  "human_readable_source": "\n \n\n#include <linux/blk-crypto.h>\n#include <linux/mmc/host.h>\n\n#include \"core.h\"\n#include \"crypto.h\"\n#include \"queue.h\"\n\nvoid mmc_crypto_set_initial_state(struct mmc_host *host)\n{\n\t \n\tif (host->caps2 & MMC_CAP2_CRYPTO)\n\t\tblk_crypto_reprogram_all_keys(&host->crypto_profile);\n}\n\nvoid mmc_crypto_setup_queue(struct request_queue *q, struct mmc_host *host)\n{\n\tif (host->caps2 & MMC_CAP2_CRYPTO)\n\t\tblk_crypto_register(&host->crypto_profile, q);\n}\nEXPORT_SYMBOL_GPL(mmc_crypto_setup_queue);\n\nvoid mmc_crypto_prepare_req(struct mmc_queue_req *mqrq)\n{\n\tstruct request *req = mmc_queue_req_to_req(mqrq);\n\tstruct mmc_request *mrq = &mqrq->brq.mrq;\n\tstruct blk_crypto_keyslot *keyslot;\n\n\tif (!req->crypt_ctx)\n\t\treturn;\n\n\tmrq->crypto_ctx = req->crypt_ctx;\n\n\tkeyslot = req->crypt_keyslot;\n\tif (keyslot)\n\t\tmrq->crypto_key_slot = blk_crypto_keyslot_index(keyslot);\n}\nEXPORT_SYMBOL_GPL(mmc_crypto_prepare_req);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}