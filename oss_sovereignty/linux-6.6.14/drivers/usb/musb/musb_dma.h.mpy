{
  "module_name": "musb_dma.h",
  "hash_id": "4b609bcfa1805074db50b7b95b013f03cf6eadab55e2803f029a6e38dea976a6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/musb/musb_dma.h",
  "human_readable_source": " \n \n\n#ifndef __MUSB_DMA_H__\n#define __MUSB_DMA_H__\n\nstruct musb_hw_ep;\n\n \n\n#define MUSB_HSDMA_BASE\t\t0x200\n#define MUSB_HSDMA_INTR\t\t(MUSB_HSDMA_BASE + 0)\n#define MUSB_HSDMA_CONTROL\t0x4\n#define MUSB_HSDMA_ADDRESS\t0x8\n#define MUSB_HSDMA_COUNT\t0xc\n\n#define\tDMA_ADDR_INVALID\t(~(dma_addr_t)0)\n\n#ifdef CONFIG_MUSB_PIO_ONLY\n#define\tis_dma_capable()\t(0)\n#else\n#define\tis_dma_capable()\t(1)\n#endif\n\n#ifdef CONFIG_USB_UX500_DMA\n#define musb_dma_ux500(musb)\t\t(musb->ops->quirks & MUSB_DMA_UX500)\n#else\n#define musb_dma_ux500(musb)\t\t0\n#endif\n\n#ifdef CONFIG_USB_TI_CPPI41_DMA\n#define musb_dma_cppi41(musb)\t\t(musb->ops->quirks & MUSB_DMA_CPPI41)\n#else\n#define musb_dma_cppi41(musb)\t\t0\n#endif\n\n#ifdef CONFIG_USB_TUSB_OMAP_DMA\n#define tusb_dma_omap(musb)\t\t(musb->ops->quirks & MUSB_DMA_TUSB_OMAP)\n#else\n#define tusb_dma_omap(musb)\t\t0\n#endif\n\n#ifdef CONFIG_USB_INVENTRA_DMA\n#define musb_dma_inventra(musb)\t\t(musb->ops->quirks & MUSB_DMA_INVENTRA)\n#else\n#define musb_dma_inventra(musb)\t\t0\n#endif\n\n#if defined(CONFIG_USB_TI_CPPI41_DMA)\n#define\tis_cppi_enabled(musb)\t\tmusb_dma_cppi41(musb)\n#else\n#define\tis_cppi_enabled(musb)\t\t0\n#endif\n\n \nenum dma_channel_status {\n\t \n\tMUSB_DMA_STATUS_UNKNOWN,\n\t \n\tMUSB_DMA_STATUS_FREE,\n\t \n\tMUSB_DMA_STATUS_BUSY,\n\t \n\tMUSB_DMA_STATUS_BUS_ABORT,\n\t \n\tMUSB_DMA_STATUS_CORE_ABORT\n};\n\nstruct dma_controller;\n\n \nstruct dma_channel {\n\tvoid\t\t\t*private_data;\n\t \n\tsize_t\t\t\tmax_len;\n\tsize_t\t\t\tactual_len;\n\tenum dma_channel_status\tstatus;\n\tbool\t\t\tdesired_mode;\n\tbool\t\t\trx_packet_done;\n};\n\n \nstatic inline enum dma_channel_status\ndma_channel_status(struct dma_channel *c)\n{\n\treturn (is_dma_capable() && c) ? c->status : MUSB_DMA_STATUS_UNKNOWN;\n}\n\n \nstruct dma_controller {\n\tstruct musb *musb;\n\tstruct dma_channel\t*(*channel_alloc)(struct dma_controller *,\n\t\t\t\t\tstruct musb_hw_ep *, u8 is_tx);\n\tvoid\t\t\t(*channel_release)(struct dma_channel *);\n\tint\t\t\t(*channel_program)(struct dma_channel *channel,\n\t\t\t\t\t\t\tu16 maxpacket, u8 mode,\n\t\t\t\t\t\t\tdma_addr_t dma_addr,\n\t\t\t\t\t\t\tu32 length);\n\tint\t\t\t(*channel_abort)(struct dma_channel *);\n\tint\t\t\t(*is_compatible)(struct dma_channel *channel,\n\t\t\t\t\t\t\tu16 maxpacket,\n\t\t\t\t\t\t\tvoid *buf, u32 length);\n\tvoid\t\t\t(*dma_callback)(struct dma_controller *);\n};\n\n \nextern void musb_dma_completion(struct musb *musb, u8 epnum, u8 transmit);\n\n#ifdef CONFIG_MUSB_PIO_ONLY\nstatic inline struct dma_controller *\nmusb_dma_controller_create(struct musb *m, void __iomem *io)\n{\n\treturn NULL;\n}\n\nstatic inline void musb_dma_controller_destroy(struct dma_controller *d) { }\n\n#else\n\nextern struct dma_controller *\n(*musb_dma_controller_create)(struct musb *, void __iomem *);\n\nextern void (*musb_dma_controller_destroy)(struct dma_controller *);\n#endif\n\n \nextern struct dma_controller *\nmusbhs_dma_controller_create(struct musb *musb, void __iomem *base);\nextern void musbhs_dma_controller_destroy(struct dma_controller *c);\nextern struct dma_controller *\nmusbhs_dma_controller_create_noirq(struct musb *musb, void __iomem *base);\nextern irqreturn_t dma_controller_irq(int irq, void *private_data);\n\nextern struct dma_controller *\ntusb_dma_controller_create(struct musb *musb, void __iomem *base);\nextern void tusb_dma_controller_destroy(struct dma_controller *c);\n\nextern struct dma_controller *\ncppi41_dma_controller_create(struct musb *musb, void __iomem *base);\nextern void cppi41_dma_controller_destroy(struct dma_controller *c);\n\nextern struct dma_controller *\nux500_dma_controller_create(struct musb *musb, void __iomem *base);\nextern void ux500_dma_controller_destroy(struct dma_controller *c);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}