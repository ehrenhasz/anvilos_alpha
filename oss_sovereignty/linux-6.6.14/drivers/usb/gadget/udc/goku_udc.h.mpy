{
  "module_name": "goku_udc.h",
  "hash_id": "37c813e84cfad29a65fd8c61bf3865aa66f29c7e8a74a1609ee48b87a9b868bf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/udc/goku_udc.h",
  "human_readable_source": "\n \n\n \nstruct goku_udc_regs {\n\t \n\tu32\tint_status;\t\t \n\tu32\tint_enable;\n#define INT_SUSPEND\t\t0x00001\t\t \n#define INT_USBRESET\t\t0x00002\n#define INT_ENDPOINT0\t\t0x00004\n#define INT_SETUP\t\t0x00008\n#define INT_STATUS\t\t0x00010\n#define INT_STATUSNAK\t\t0x00020\n#define INT_EPxDATASET(n)\t(0x00020 << (n))\t \n#\tdefine INT_EP1DATASET\t\t0x00040\n#\tdefine INT_EP2DATASET\t\t0x00080\n#\tdefine INT_EP3DATASET\t\t0x00100\n#define INT_EPnNAK(n)\t\t(0x00100 << (n))\t \n#\tdefine INT_EP1NAK\t\t0x00200\n#\tdefine INT_EP2NAK\t\t0x00400\n#\tdefine INT_EP3NAK\t\t0x00800\n#define INT_SOF\t\t\t0x01000\n#define INT_ERR\t\t\t0x02000\n#define INT_MSTWRSET\t\t0x04000\n#define INT_MSTWREND\t\t0x08000\n#define INT_MSTWRTMOUT\t\t0x10000\n#define INT_MSTRDEND\t\t0x20000\n#define INT_SYSERROR\t\t0x40000\n#define INT_PWRDETECT\t\t0x80000\n\n#define\tINT_DEVWIDE \\\n\t(INT_PWRDETECT|INT_SYSERROR |INT_USBRESET|INT_SUSPEND)\n#define\tINT_EP0 \\\n\t(INT_SETUP|INT_ENDPOINT0 |INT_STATUSNAK)\n\n\tu32\tdma_master;\n#define MST_EOPB_DIS\t\t0x0800\n#define MST_EOPB_ENA\t\t0x0400\n#define MST_TIMEOUT_DIS\t\t0x0200\n#define MST_TIMEOUT_ENA\t\t0x0100\n#define MST_RD_EOPB\t\t0x0080\t\t \n#define MST_RD_RESET\t\t0x0040\n#define MST_WR_RESET\t\t0x0020\n#define MST_RD_ENA\t\t0x0004\t\t \n#define MST_WR_ENA\t\t0x0002\t\t \n#define MST_CONNECTION\t\t0x0001\t\t \n\n#define MST_R_BITS\t\t(MST_EOPB_DIS|MST_EOPB_ENA \\\n\t\t\t\t\t|MST_RD_ENA|MST_RD_RESET)\n#define MST_W_BITS\t\t(MST_TIMEOUT_DIS|MST_TIMEOUT_ENA \\\n\t\t\t\t\t|MST_WR_ENA|MST_WR_RESET)\n#define MST_RW_BITS\t\t(MST_R_BITS|MST_W_BITS \\\n\t\t\t\t\t|MST_CONNECTION)\n\n \n#define UDC_MSTWR_ENDPOINT        1\n#define UDC_MSTRD_ENDPOINT        2\n\n\t \n\tu32\tout_dma_start;\n\tu32\tout_dma_end;\n\tu32\tout_dma_current;\n\n\t \n\tu32\tin_dma_start;\n\tu32\tin_dma_end;\n\tu32\tin_dma_current;\n\n\tu32\tpower_detect;\n#define PW_DETECT\t\t0x04\n#define PW_RESETB\t\t0x02\n#define PW_PULLUP\t\t0x01\n\n\tu8\t_reserved0 [0x1d8];\n\n\t \n\tu32\tep_fifo [4];\t\t \n\tu8\t_reserved1 [0x10];\n\tu32\tep_mode [4];\t\t \n\tu8\t_reserved2 [0x10];\n\n\tu32\tep_status [4];\n#define EPxSTATUS_TOGGLE\t0x40\n#define EPxSTATUS_SUSPEND\t0x20\n#define EPxSTATUS_EP_MASK\t(0x07<<2)\n#\tdefine EPxSTATUS_EP_READY\t(0<<2)\n#\tdefine EPxSTATUS_EP_DATAIN\t(1<<2)\n#\tdefine EPxSTATUS_EP_FULL\t(2<<2)\n#\tdefine EPxSTATUS_EP_TX_ERR\t(3<<2)\n#\tdefine EPxSTATUS_EP_RX_ERR\t(4<<2)\n#\tdefine EPxSTATUS_EP_BUSY\t(5<<2)\n#\tdefine EPxSTATUS_EP_STALL\t(6<<2)\n#\tdefine EPxSTATUS_EP_INVALID\t(7<<2)\n#define EPxSTATUS_FIFO_DISABLE\t0x02\n#define EPxSTATUS_STAGE_ERROR\t0x01\n\n\tu8\t_reserved3 [0x10];\n\tu32\tEPxSizeLA[4];\n#define PACKET_ACTIVE\t\t(1<<7)\n#define DATASIZE\t\t0x7f\n\tu8\t_reserved3a [0x10];\n\tu32\tEPxSizeLB[4];\t\t \n\tu8\t_reserved3b [0x10];\n\tu32\tEPxSizeHA[4];\t\t \n\tu8\t_reserved3c [0x10];\n\tu32\tEPxSizeHB[4];\t\t \n\tu8\t_reserved4[0x30];\n\n\t \n\tu32\tbRequestType;\t\t \n\tu32\tbRequest;\n\tu32\twValueL;\n\tu32\twValueH;\n\tu32\twIndexL;\n\tu32\twIndexH;\n\tu32\twLengthL;\n\tu32\twLengthH;\n\n\t \n\tu32\tSetupRecv;\t\t \n\tu32\tCurrConfig;\n\tu32\tStdRequest;\n\tu32\tRequest;\n\tu32\tDataSet;\n#define DATASET_A(epnum)\t(1<<(2*(epnum)))\n#define DATASET_B(epnum)\t(2<<(2*(epnum)))\n#define DATASET_AB(epnum)\t(3<<(2*(epnum)))\n\tu8\t_reserved5[4];\n\n\tu32\tUsbState;\n#define USBSTATE_CONFIGURED\t0x04\n#define USBSTATE_ADDRESSED\t0x02\n#define USBSTATE_DEFAULT\t0x01\n\n\tu32\tEOP;\n\n\tu32\tCommand;\t\t \n#define COMMAND_SETDATA0\t2\n#define COMMAND_RESET\t\t3\n#define COMMAND_STALL\t\t4\n#define COMMAND_INVALID\t\t5\n#define COMMAND_FIFO_DISABLE\t7\n#define COMMAND_FIFO_ENABLE\t8\n#define COMMAND_INIT_DESCRIPTOR\t9\n#define COMMAND_FIFO_CLEAR\t10\t \n#define COMMAND_STALL_CLEAR\t11\n#define COMMAND_EP(n)\t\t((n) << 4)\n\n\tu32\tEPxSingle;\n\tu8\t_reserved6[4];\n\tu32\tEPxBCS;\n\tu8\t_reserved7[8];\n\tu32\tIntControl;\n#define ICONTROL_STATUSNAK\t1\n\tu8\t_reserved8[4];\n\n\tu32\treqmode;\t\n#define G_REQMODE_SET_INTF\t(1<<7)\n#define G_REQMODE_GET_INTF\t(1<<6)\n#define G_REQMODE_SET_CONF\t(1<<5)\n#define G_REQMODE_GET_CONF\t(1<<4)\n#define G_REQMODE_GET_DESC\t(1<<3)\n#define G_REQMODE_SET_FEAT\t(1<<2)\n#define G_REQMODE_CLEAR_FEAT\t(1<<1)\n#define G_REQMODE_GET_STATUS\t(1<<0)\n\n\tu32\tReqMode;\n\tu8\t_reserved9[0x18];\n\tu32\tPortStatus;\t\t \n\tu8\t_reserved10[8];\n\tu32\taddress;\n\tu32\tbuff_test;\n\tu8\t_reserved11[4];\n\tu32\tUsbReady;\n\tu8\t_reserved12[4];\n\tu32\tSetDescStall;\t\t \n\tu8\t_reserved13[0x45c];\n\n\t \n#define\tDESC_LEN\t0x80\n\tu32\tdescriptors[DESC_LEN];\t \n\tu8\t_reserved14[0x600];\n\n} __attribute__ ((packed));\n\n#define\tMAX_FIFO_SIZE\t64\n#define\tMAX_EP0_SIZE\t8\t\t \n\n\n \n\n \n\nstruct goku_ep {\n\tstruct usb_ep\t\t\t\tep;\n\tstruct goku_udc\t\t\t\t*dev;\n\tunsigned long\t\t\t\tirqs;\n\n\tunsigned\t\t\t\tnum:8,\n\t\t\t\t\t\tdma:1,\n\t\t\t\t\t\tis_in:1,\n\t\t\t\t\t\tstopped:1;\n\n\t \n\tstruct list_head\t\t\tqueue;\n\n\tu32 __iomem\t\t\t\t*reg_fifo;\n\tu32 __iomem\t\t\t\t*reg_mode;\n\tu32 __iomem\t\t\t\t*reg_status;\n};\n\nstruct goku_request {\n\tstruct usb_request\t\treq;\n\tstruct list_head\t\tqueue;\n\n\tunsigned\t\t\tmapped:1;\n};\n\nenum ep0state {\n\tEP0_DISCONNECT,\t\t \n\tEP0_IDLE,\t\t \n\tEP0_IN, EP0_OUT,\t \n\tEP0_STATUS,\t\t \n\tEP0_STALL,\t\t \n\tEP0_SUSPEND,\t\t \n};\n\nstruct goku_udc {\n\t \n\tstruct usb_gadget\t\tgadget;\n\tspinlock_t\t\t\tlock;\n\tstruct goku_ep\t\t\tep[4];\n\tstruct usb_gadget_driver\t*driver;\n\n\tenum ep0state\t\t\tep0state;\n\tunsigned\t\t\tgot_irq:1,\n\t\t\t\t\tgot_region:1,\n\t\t\t\t\treq_config:1,\n\t\t\t\t\tconfigured:1,\n\t\t\t\t\tenabled:1;\n\n\t \n\tstruct pci_dev\t\t\t*pdev;\n\tstruct goku_udc_regs __iomem\t*regs;\n\tu32\t\t\t\tint_enable;\n\n\t \n\tunsigned long\t\t\tirqs;\n};\n#define to_goku_udc(g)\t\t(container_of((g), struct goku_udc, gadget))\n\n \n\n#define xprintk(dev,level,fmt,args...) \\\n\tprintk(level \"%s %s: \" fmt , driver_name , \\\n\t\t\tpci_name(dev->pdev) , ## args)\n\n#ifdef DEBUG\n#define DBG(dev,fmt,args...) \\\n\txprintk(dev , KERN_DEBUG , fmt , ## args)\n#else\n#define DBG(dev,fmt,args...) \\\n\tdo { } while (0)\n#endif  \n\n#ifdef VERBOSE\n#define VDBG DBG\n#else\n#define VDBG(dev,fmt,args...) \\\n\tdo { } while (0)\n#endif\t \n\n#define ERROR(dev,fmt,args...) \\\n\txprintk(dev , KERN_ERR , fmt , ## args)\n#define WARNING(dev,fmt,args...) \\\n\txprintk(dev , KERN_WARNING , fmt , ## args)\n#define INFO(dev,fmt,args...) \\\n\txprintk(dev , KERN_INFO , fmt , ## args)\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}