{
  "module_name": "mv_u3d.h",
  "hash_id": "fdc4b7f1645d18d87ab684cbd403ea07e806794fc178c2416c0fd05ac52ab9d7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/udc/mv_u3d.h",
  "human_readable_source": "\n \n\n#ifndef __MV_U3D_H\n#define __MV_U3D_H\n\n#define MV_U3D_EP_CONTEXT_ALIGNMENT\t32\n#define MV_U3D_TRB_ALIGNMENT\t16\n#define MV_U3D_DMA_BOUNDARY\t4096\n#define MV_U3D_EP0_MAX_PKT_SIZE\t512\n\n \n#define MV_U3D_WAIT_FOR_SETUP\t\t0\n#define MV_U3D_DATA_STATE_XMIT\t\t1\n#define MV_U3D_DATA_STATE_NEED_ZLP\t2\n#define MV_U3D_WAIT_FOR_OUT_STATUS\t3\n#define MV_U3D_DATA_STATE_RECV\t\t4\n#define MV_U3D_STATUS_STAGE\t\t5\n\n#define MV_U3D_EP_MAX_LENGTH_TRANSFER\t0x10000\n\n \n#define MV_U3D_USBINT_SETUP\t\t0x00000001\n#define MV_U3D_USBINT_RX_COMPLETE\t0x00000002\n#define MV_U3D_USBINT_TX_COMPLETE\t0x00000004\n#define MV_U3D_USBINT_UNDER_RUN\t0x00000008\n#define MV_U3D_USBINT_RXDESC_ERR\t0x00000010\n#define MV_U3D_USBINT_TXDESC_ERR\t0x00000020\n#define MV_U3D_USBINT_RX_TRB_COMPLETE\t0x00000040\n#define MV_U3D_USBINT_TX_TRB_COMPLETE\t0x00000080\n#define MV_U3D_USBINT_VBUS_VALID\t0x00010000\n#define MV_U3D_USBINT_STORAGE_CMD_FULL\t0x00020000\n#define MV_U3D_USBINT_LINK_CHG\t\t0x01000000\n\n \n#define MV_U3D_INTR_ENABLE_SETUP\t\t0x00000001\n#define MV_U3D_INTR_ENABLE_RX_COMPLETE\t\t0x00000002\n#define MV_U3D_INTR_ENABLE_TX_COMPLETE\t\t0x00000004\n#define MV_U3D_INTR_ENABLE_UNDER_RUN\t\t0x00000008\n#define MV_U3D_INTR_ENABLE_RXDESC_ERR\t\t0x00000010\n#define MV_U3D_INTR_ENABLE_TXDESC_ERR\t\t0x00000020\n#define MV_U3D_INTR_ENABLE_RX_TRB_COMPLETE\t0x00000040\n#define MV_U3D_INTR_ENABLE_TX_TRB_COMPLETE\t0x00000080\n#define MV_U3D_INTR_ENABLE_RX_BUFFER_ERR\t0x00000100\n#define MV_U3D_INTR_ENABLE_VBUS_VALID\t\t0x00010000\n#define MV_U3D_INTR_ENABLE_STORAGE_CMD_FULL\t0x00020000\n#define MV_U3D_INTR_ENABLE_LINK_CHG\t\t0x01000000\n#define MV_U3D_INTR_ENABLE_PRIME_STATUS\t0x02000000\n\n \n#define MV_U3D_LINK_CHANGE_LINK_UP\t\t0x00000001\n#define MV_U3D_LINK_CHANGE_SUSPEND\t\t0x00000002\n#define MV_U3D_LINK_CHANGE_RESUME\t\t0x00000004\n#define MV_U3D_LINK_CHANGE_WRESET\t\t0x00000008\n#define MV_U3D_LINK_CHANGE_HRESET\t\t0x00000010\n#define MV_U3D_LINK_CHANGE_VBUS_INVALID\t0x00000020\n#define MV_U3D_LINK_CHANGE_INACT\t\t0x00000040\n#define MV_U3D_LINK_CHANGE_DISABLE_AFTER_U0\t0x00000080\n#define MV_U3D_LINK_CHANGE_U1\t\t\t0x00000100\n#define MV_U3D_LINK_CHANGE_U2\t\t\t0x00000200\n#define MV_U3D_LINK_CHANGE_U3\t\t\t0x00000400\n\n \n#define MV_U3D_BRIDGE_SETTING_VBUS_VALID\t(1 << 16)\n\n \n#define MV_U3D_CMD_RUN_STOP\t\t0x00000001\n#define MV_U3D_CMD_CTRL_RESET\t\t0x00000002\n\n \n#define MV_U3D_EPXCR_EP_TYPE_CONTROL\t\t0\n#define MV_U3D_EPXCR_EP_TYPE_ISOC\t\t1\n#define MV_U3D_EPXCR_EP_TYPE_BULK\t\t2\n#define MV_U3D_EPXCR_EP_TYPE_INT\t\t3\n#define MV_U3D_EPXCR_EP_ENABLE_SHIFT\t\t4\n#define MV_U3D_EPXCR_MAX_BURST_SIZE_SHIFT\t12\n#define MV_U3D_EPXCR_MAX_PACKET_SIZE_SHIFT\t16\n#define MV_U3D_USB_BULK_BURST_OUT\t\t6\n#define MV_U3D_USB_BULK_BURST_IN\t\t14\n\n#define MV_U3D_EPXCR_EP_FLUSH\t\t(1 << 7)\n#define MV_U3D_EPXCR_EP_HALT\t\t(1 << 1)\n#define MV_U3D_EPXCR_EP_INIT\t\t(1)\n\n \n#define MV_U3D_XFERSTATUS_COMPLETE_SHIFT\t24\n#define MV_U3D_COMPLETE_INVALID\t0\n#define MV_U3D_COMPLETE_SUCCESS\t1\n#define MV_U3D_COMPLETE_BUFF_ERR\t2\n#define MV_U3D_COMPLETE_SHORT_PACKET\t3\n#define MV_U3D_COMPLETE_TRB_ERR\t5\n#define MV_U3D_XFERSTATUS_TRB_LENGTH_MASK\t(0xFFFFFF)\n\n#define MV_U3D_USB_LINK_BYPASS_VBUS\t0x8\n\n#define MV_U3D_LTSSM_PHY_INIT_DONE\t\t0x80000000\n#define MV_U3D_LTSSM_NEVER_GO_COMPLIANCE\t0x40000000\n\n#define MV_U3D_USB3_OP_REGS_OFFSET\t0x100\n#define MV_U3D_USB3_PHY_OFFSET\t\t0xB800\n\n#define DCS_ENABLE\t0x1\n\n \n#define MV_U3D_RESET_TIMEOUT\t\t10000\n#define MV_U3D_FLUSH_TIMEOUT\t\t100000\n#define MV_U3D_OWN_TIMEOUT\t\t10000\n#define LOOPS_USEC_SHIFT\t4\n#define LOOPS_USEC\t\t(1 << LOOPS_USEC_SHIFT)\n#define LOOPS(timeout)\t\t((timeout) >> LOOPS_USEC_SHIFT)\n\n \n#define MV_U3D_EP_DIR_IN\t\t1\n#define MV_U3D_EP_DIR_OUT\t\t0\n#define mv_u3d_ep_dir(ep)\t(((ep)->ep_num == 0) ? \\\n\t\t\t\t((ep)->u3d->ep0_dir) : ((ep)->direction))\n\n \nstruct mv_u3d_cap_regs {\n\tu32\trsvd[5];\n\tu32\tdboff;\t \n\tu32\trtsoff;\t \n\tu32\tvuoff;\t \n};\n\n \nstruct mv_u3d_op_regs {\n\tu32\tusbcmd;\t\t \n\tu32\trsvd1[11];\n\tu32\tdcbaapl;\t \n\tu32\tdcbaaph;\t \n\tu32\trsvd2[243];\n\tu32\tportsc;\t\t \n\tu32\tportlinkinfo;\t \n\tu32\trsvd3[9917];\n\tu32\tdoorbell;\t \n};\n\n \nstruct epxcr {\n\tu32\tepxoutcr0;\t \n\tu32\tepxoutcr1;\t \n\tu32\tepxincr0;\t \n\tu32\tepxincr1;\t \n};\n\n \nstruct xferstatus {\n\tu32\tcurdeqlo;\t \n\tu32\tcurdeqhi;\t \n\tu32\tstatuslo;\t \n\tu32\tstatushi;\t \n};\n\n \nstruct mv_u3d_vuc_regs {\n\tu32\tctrlepenable;\t \n\tu32\tsetuplock;\t \n\tu32\tendcomplete;\t \n\tu32\tintrcause;\t \n\tu32\tintrenable;\t \n\tu32\ttrbcomplete;\t \n\tu32\tlinkchange;\t \n\tu32\trsvd1[5];\n\tu32\ttrbunderrun;\t \n\tu32\trsvd2[43];\n\tu32\tbridgesetting;\t \n\tu32\trsvd3[7];\n\tstruct xferstatus\ttxst[16];\t \n\tstruct xferstatus\trxst[16];\t \n\tu32\tltssm;\t\t \n\tu32\tpipe;\t\t \n\tu32\tlinkcr0;\t \n\tu32\tlinkcr1;\t \n\tu32\trsvd6[60];\n\tu32\tmib0;\t\t \n\tu32\tusblink;\t \n\tu32\tltssmstate;\t \n\tu32\tlinkerrorcause;\t \n\tu32\trsvd7[60];\n\tu32\tdevaddrtiebrkr;\t \n\tu32\titpinfo0;\t \n\tu32\titpinfo1;\t \n\tu32\trsvd8[61];\n\tstruct epxcr\tepcr[16];\t \n\tu32\trsvd9[64];\n\tu32\tphyaddr;\t \n\tu32\tphydata;\t \n};\n\n \nstruct mv_u3d_ep_context {\n\tu32\trsvd0;\n\tu32\trsvd1;\n\tu32\ttrb_addr_lo;\t\t \n\tu32\ttrb_addr_hi;\t\t \n\tu32\trsvd2;\n\tu32\trsvd3;\n\tstruct usb_ctrlrequest setup_buffer;\t \n};\n\n \nstruct mv_u3d_trb_ctrl {\n\tu32\town:1;\t\t \n\tu32\trsvd1:3;\n\tu32\tchain:1;\t \n\tu32\tioc:1;\t\t \n\tu32\trsvd2:4;\n\tu32\ttype:6;\t\t \n#define TYPE_NORMAL\t1\n#define TYPE_DATA\t3\n#define TYPE_LINK\t6\n\tu32\tdir:1;\t\t \n\tu32\trsvd3:15;\n};\n\n \nstruct mv_u3d_trb_hw {\n\tu32\tbuf_addr_lo;\t \n\tu32\tbuf_addr_hi;\t \n\tu32\ttrb_len;\t \n\tstruct mv_u3d_trb_ctrl\tctrl;\t \n};\n\n \nstruct mv_u3d_trb {\n\tstruct mv_u3d_trb_hw *trb_hw;\t \n\tdma_addr_t trb_dma;\t\t \n\tstruct list_head trb_list;\t \n};\n\n \nstruct mv_u3d {\n\tstruct usb_gadget\t\tgadget;\n\tstruct usb_gadget_driver\t*driver;\n\tspinlock_t\t\t\tlock;\t \n\tstruct completion\t\t*done;\n\tstruct device\t\t\t*dev;\n\tint\t\t\t\tirq;\n\n\t \n\tstruct mv_u3d_cap_regs __iomem\t*cap_regs;\n\tstruct mv_u3d_op_regs __iomem\t*op_regs;\n\tstruct mv_u3d_vuc_regs __iomem\t*vuc_regs;\n\tvoid __iomem\t\t\t*phy_regs;\n\n\tunsigned int\t\t\tmax_eps;\n\tstruct mv_u3d_ep_context\t*ep_context;\n\tsize_t\t\t\t\tep_context_size;\n\tdma_addr_t\t\t\tep_context_dma;\n\n\tstruct dma_pool\t\t\t*trb_pool;  \n\tstruct mv_u3d_ep\t\t*eps;\n\n\tstruct mv_u3d_req\t\t*status_req;  \n\tstruct usb_ctrlrequest\t\tlocal_setup_buff;  \n\n\tunsigned int\t\tresume_state;\t \n\tunsigned int\t\tusb_state;\t \n\tunsigned int\t\tep0_state;\t \n\tunsigned int\t\tep0_dir;\n\n\tunsigned int\t\tdev_addr;\t \n\n\tunsigned int\t\terrors;\n\n\tunsigned\t\tsoftconnect:1;\n\tunsigned\t\tvbus_active:1;\t \n\tunsigned\t\tremote_wakeup:1;  \n\tunsigned\t\tclock_gating:1;\t \n\tunsigned\t\tactive:1;\t \n\tunsigned\t\tvbus_valid_detect:1;  \n\n\tstruct mv_usb_addon_irq *vbus;\n\tunsigned int\t\tpower;\n\n\tstruct clk\t\t*clk;\n};\n\n \nstruct mv_u3d_ep {\n\tstruct usb_ep\t\tep;\n\tstruct mv_u3d\t\t*u3d;\n\tstruct list_head\tqueue;\t \n\tstruct list_head\treq_list;  \n\tstruct mv_u3d_ep_context\t*ep_context;  \n\tu32\t\t\tdirection;\n\tchar\t\t\tname[14];\n\tu32\t\t\tprocessing;  \n\tspinlock_t\t\treq_lock;  \n\tunsigned\t\twedge:1;\n\tunsigned\t\tenabled:1;\n\tunsigned\t\tep_type:2;\n\tunsigned\t\tep_num:8;\n};\n\n \nstruct mv_u3d_req {\n\tstruct usb_request\treq;\n\tstruct mv_u3d_ep\t*ep;\n\tstruct list_head\tqueue;\t \n\tstruct list_head\tlist;\t \n\tstruct list_head\ttrb_list;  \n\n\tstruct mv_u3d_trb\t*trb_head;  \n\tunsigned\t\ttrb_count;  \n\tunsigned\t\tchain;\t    \n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}