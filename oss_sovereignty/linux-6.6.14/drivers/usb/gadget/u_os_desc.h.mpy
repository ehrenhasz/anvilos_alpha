{
  "module_name": "u_os_desc.h",
  "hash_id": "2f4850c3f71b4c38e93da895364b25746a80209adf4dbff91be38c1573c39344",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/u_os_desc.h",
  "human_readable_source": "\n \n\n#ifndef __U_OS_DESC_H__\n#define __U_OS_DESC_H__\n\n#include <asm/unaligned.h>\n#include <linux/nls.h>\n\n#define USB_EXT_PROP_DW_SIZE\t\t\t0\n#define USB_EXT_PROP_DW_PROPERTY_DATA_TYPE\t4\n#define USB_EXT_PROP_W_PROPERTY_NAME_LENGTH\t8\n#define USB_EXT_PROP_B_PROPERTY_NAME\t\t10\n#define USB_EXT_PROP_DW_PROPERTY_DATA_LENGTH\t10\n#define USB_EXT_PROP_B_PROPERTY_DATA\t\t14\n\n#define USB_EXT_PROP_RESERVED\t\t\t0\n#define USB_EXT_PROP_UNICODE\t\t\t1\n#define USB_EXT_PROP_UNICODE_ENV\t\t2\n#define USB_EXT_PROP_BINARY\t\t\t3\n#define USB_EXT_PROP_LE32\t\t\t4\n#define USB_EXT_PROP_BE32\t\t\t5\n#define USB_EXT_PROP_UNICODE_LINK\t\t6\n#define USB_EXT_PROP_UNICODE_MULTI\t\t7\n\nstatic inline u8 *__usb_ext_prop_ptr(u8 *buf, size_t offset)\n{\n\treturn buf + offset;\n}\n\nstatic inline u8 *usb_ext_prop_size_ptr(u8 *buf)\n{\n\treturn __usb_ext_prop_ptr(buf, USB_EXT_PROP_DW_SIZE);\n}\n\nstatic inline u8 *usb_ext_prop_type_ptr(u8 *buf)\n{\n\treturn __usb_ext_prop_ptr(buf, USB_EXT_PROP_DW_PROPERTY_DATA_TYPE);\n}\n\nstatic inline u8 *usb_ext_prop_name_len_ptr(u8 *buf)\n{\n\treturn __usb_ext_prop_ptr(buf, USB_EXT_PROP_W_PROPERTY_NAME_LENGTH);\n}\n\nstatic inline u8 *usb_ext_prop_name_ptr(u8 *buf)\n{\n\treturn __usb_ext_prop_ptr(buf, USB_EXT_PROP_B_PROPERTY_NAME);\n}\n\nstatic inline u8 *usb_ext_prop_data_len_ptr(u8 *buf, size_t off)\n{\n\treturn __usb_ext_prop_ptr(buf,\n\t\t\t\t  USB_EXT_PROP_DW_PROPERTY_DATA_LENGTH + off);\n}\n\nstatic inline u8 *usb_ext_prop_data_ptr(u8 *buf, size_t off)\n{\n\treturn __usb_ext_prop_ptr(buf, USB_EXT_PROP_B_PROPERTY_DATA + off);\n}\n\nstatic inline void usb_ext_prop_put_size(u8 *buf, int dw_size)\n{\n\tput_unaligned_le32(dw_size, usb_ext_prop_size_ptr(buf));\n}\n\nstatic inline void usb_ext_prop_put_type(u8 *buf, int type)\n{\n\tput_unaligned_le32(type, usb_ext_prop_type_ptr(buf));\n}\n\nstatic inline int usb_ext_prop_put_name(u8 *buf, const char *name, int pnl)\n{\n\tint result;\n\n\tput_unaligned_le16(pnl, usb_ext_prop_name_len_ptr(buf));\n\tresult = utf8s_to_utf16s(name, strlen(name), UTF16_LITTLE_ENDIAN,\n\t\t(wchar_t *) usb_ext_prop_name_ptr(buf), pnl - 2);\n\tif (result < 0)\n\t\treturn result;\n\n\tput_unaligned_le16(0, &buf[USB_EXT_PROP_B_PROPERTY_NAME + pnl - 2]);\n\n\treturn pnl;\n}\n\nstatic inline void usb_ext_prop_put_binary(u8 *buf, int pnl, const u8 *data,\n\t\t\t\t\t   int data_len)\n{\n\tput_unaligned_le32(data_len, usb_ext_prop_data_len_ptr(buf, pnl));\n\tmemcpy(usb_ext_prop_data_ptr(buf, pnl), data, data_len);\n}\n\nstatic inline int usb_ext_prop_put_unicode(u8 *buf, int pnl, const char *string,\n\t\t\t\t\t   int data_len)\n{\n\tint result;\n\tput_unaligned_le32(data_len, usb_ext_prop_data_len_ptr(buf, pnl));\n\tresult = utf8s_to_utf16s(string, data_len >> 1, UTF16_LITTLE_ENDIAN,\n\t\t\t(wchar_t *) usb_ext_prop_data_ptr(buf, pnl),\n\t\t\tdata_len - 2);\n\tif (result < 0)\n\t\treturn result;\n\n\tput_unaligned_le16(0,\n\t\t&buf[USB_EXT_PROP_B_PROPERTY_DATA + pnl + data_len - 2]);\n\n\treturn data_len;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}