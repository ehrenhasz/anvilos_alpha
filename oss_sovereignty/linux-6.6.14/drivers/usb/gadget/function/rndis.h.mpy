{
  "module_name": "rndis.h",
  "hash_id": "3b03aae1d79ef0d0f156f3ce9a17302de7b7e013cf1c8e8cf6cb608676c609f8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/function/rndis.h",
  "human_readable_source": " \n \n\n#ifndef _LINUX_RNDIS_H\n#define _LINUX_RNDIS_H\n\n#include <linux/rndis.h>\n#include \"u_ether.h\"\n#include \"ndis.h\"\n\n#define RNDIS_MAXIMUM_FRAME_SIZE\t1518\n#define RNDIS_MAX_TOTAL_SIZE\t\t1558\n\ntypedef struct rndis_init_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tMajorVersion;\n\t__le32\tMinorVersion;\n\t__le32\tMaxTransferSize;\n} rndis_init_msg_type;\n\ntypedef struct rndis_init_cmplt_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tStatus;\n\t__le32\tMajorVersion;\n\t__le32\tMinorVersion;\n\t__le32\tDeviceFlags;\n\t__le32\tMedium;\n\t__le32\tMaxPacketsPerTransfer;\n\t__le32\tMaxTransferSize;\n\t__le32\tPacketAlignmentFactor;\n\t__le32\tAFListOffset;\n\t__le32\tAFListSize;\n} rndis_init_cmplt_type;\n\ntypedef struct rndis_halt_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n} rndis_halt_msg_type;\n\ntypedef struct rndis_query_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tOID;\n\t__le32\tInformationBufferLength;\n\t__le32\tInformationBufferOffset;\n\t__le32\tDeviceVcHandle;\n} rndis_query_msg_type;\n\ntypedef struct rndis_query_cmplt_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tStatus;\n\t__le32\tInformationBufferLength;\n\t__le32\tInformationBufferOffset;\n} rndis_query_cmplt_type;\n\ntypedef struct rndis_set_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tOID;\n\t__le32\tInformationBufferLength;\n\t__le32\tInformationBufferOffset;\n\t__le32\tDeviceVcHandle;\n} rndis_set_msg_type;\n\ntypedef struct rndis_set_cmplt_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tStatus;\n} rndis_set_cmplt_type;\n\ntypedef struct rndis_reset_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tReserved;\n} rndis_reset_msg_type;\n\ntypedef struct rndis_reset_cmplt_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tStatus;\n\t__le32\tAddressingReset;\n} rndis_reset_cmplt_type;\n\ntypedef struct rndis_indicate_status_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tStatus;\n\t__le32\tStatusBufferLength;\n\t__le32\tStatusBufferOffset;\n} rndis_indicate_status_msg_type;\n\ntypedef struct rndis_keepalive_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n} rndis_keepalive_msg_type;\n\ntypedef struct rndis_keepalive_cmplt_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tRequestID;\n\t__le32\tStatus;\n} rndis_keepalive_cmplt_type;\n\nstruct rndis_packet_msg_type {\n\t__le32\tMessageType;\n\t__le32\tMessageLength;\n\t__le32\tDataOffset;\n\t__le32\tDataLength;\n\t__le32\tOOBDataOffset;\n\t__le32\tOOBDataLength;\n\t__le32\tNumOOBDataElements;\n\t__le32\tPerPacketInfoOffset;\n\t__le32\tPerPacketInfoLength;\n\t__le32\tVcHandle;\n\t__le32\tReserved;\n} __attribute__ ((packed));\n\nstruct rndis_config_parameter {\n\t__le32\tParameterNameOffset;\n\t__le32\tParameterNameLength;\n\t__le32\tParameterType;\n\t__le32\tParameterValueOffset;\n\t__le32\tParameterValueLength;\n};\n\n \nenum rndis_state {\n\tRNDIS_UNINITIALIZED,\n\tRNDIS_INITIALIZED,\n\tRNDIS_DATA_INITIALIZED,\n};\n\ntypedef struct rndis_resp_t {\n\tstruct list_head\tlist;\n\tu8\t\t\t*buf;\n\tu32\t\t\tlength;\n\tint\t\t\tsend;\n} rndis_resp_t;\n\ntypedef struct rndis_params {\n\tint\t\t\tconfignr;\n\tu8\t\t\tused;\n\tu16\t\t\tsaved_filter;\n\tenum rndis_state\tstate;\n\tu32\t\t\tmedium;\n\tu32\t\t\tspeed;\n\tu32\t\t\tmedia_state;\n\n\tconst u8\t\t*host_mac;\n\tu16\t\t\t*filter;\n\tstruct net_device\t*dev;\n\n\tu32\t\t\tvendorID;\n\tconst char\t\t*vendorDescr;\n\tvoid\t\t\t(*resp_avail)(void *v);\n\tvoid\t\t\t*v;\n\tstruct list_head\tresp_queue;\n\tspinlock_t\t\tresp_lock;\n} rndis_params;\n\n \nint  rndis_msg_parser(struct rndis_params *params, u8 *buf);\nstruct rndis_params *rndis_register(void (*resp_avail)(void *v), void *v);\nvoid rndis_deregister(struct rndis_params *params);\nint  rndis_set_param_dev(struct rndis_params *params, struct net_device *dev,\n\t\t\t u16 *cdc_filter);\nint  rndis_set_param_vendor(struct rndis_params *params, u32 vendorID,\n\t\t\t    const char *vendorDescr);\nint  rndis_set_param_medium(struct rndis_params *params, u32 medium,\n\t\t\t     u32 speed);\nvoid rndis_add_hdr(struct sk_buff *skb);\nint rndis_rm_hdr(struct gether *port, struct sk_buff *skb,\n\t\t\tstruct sk_buff_head *list);\nu8   *rndis_get_next_response(struct rndis_params *params, u32 *length);\nvoid rndis_free_response(struct rndis_params *params, u8 *buf);\n\nvoid rndis_uninit(struct rndis_params *params);\nint  rndis_signal_connect(struct rndis_params *params);\nint  rndis_signal_disconnect(struct rndis_params *params);\nint  rndis_state(struct rndis_params *params);\nextern void rndis_set_host_mac(struct rndis_params *params, const u8 *addr);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}