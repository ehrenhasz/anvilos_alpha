{
  "module_name": "f_mass_storage.h",
  "hash_id": "b7f6523affb1309cf7e0cb3d4a906effd1b78b404348b5c4f7a8aa8a2de3369f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/function/f_mass_storage.h",
  "human_readable_source": " \n#ifndef USB_F_MASS_STORAGE_H\n#define USB_F_MASS_STORAGE_H\n\n#include <linux/usb/composite.h>\n#include \"storage_common.h\"\n\nstruct fsg_module_parameters {\n\tchar\t\t*file[FSG_MAX_LUNS];\n\tbool\t\tro[FSG_MAX_LUNS];\n\tbool\t\tremovable[FSG_MAX_LUNS];\n\tbool\t\tcdrom[FSG_MAX_LUNS];\n\tbool\t\tnofua[FSG_MAX_LUNS];\n\n\tunsigned int\tfile_count, ro_count, removable_count, cdrom_count;\n\tunsigned int\tnofua_count;\n\tunsigned int\tluns;\t \n\tbool\t\tstall;\t \n};\n\n#define _FSG_MODULE_PARAM_ARRAY(prefix, params, name, type, desc)\t\\\n\tmodule_param_array_named(prefix ## name, params.name, type,\t\\\n\t\t\t\t &prefix ## params.name ## _count,\t\\\n\t\t\t\t S_IRUGO);\t\t\t\t\\\n\tMODULE_PARM_DESC(prefix ## name, desc)\n\n#define _FSG_MODULE_PARAM(prefix, params, name, type, desc)\t\t\\\n\tmodule_param_named(prefix ## name, params.name, type,\t\t\\\n\t\t\t   S_IRUGO);\t\t\t\t\t\\\n\tMODULE_PARM_DESC(prefix ## name, desc)\n\n#define __FSG_MODULE_PARAMETERS(prefix, params)\t\t\t\t\\\n\t_FSG_MODULE_PARAM_ARRAY(prefix, params, file, charp,\t\t\\\n\t\t\t\t\"names of backing files or devices\");\t\\\n\t_FSG_MODULE_PARAM_ARRAY(prefix, params, ro, bool,\t\t\\\n\t\t\t\t\"true to force read-only\");\t\t\\\n\t_FSG_MODULE_PARAM_ARRAY(prefix, params, removable, bool,\t\\\n\t\t\t\t\"true to simulate removable media\");\t\\\n\t_FSG_MODULE_PARAM_ARRAY(prefix, params, cdrom, bool,\t\t\\\n\t\t\t\t\"true to simulate CD-ROM instead of disk\"); \\\n\t_FSG_MODULE_PARAM_ARRAY(prefix, params, nofua, bool,\t\t\\\n\t\t\t\t\"true to ignore SCSI WRITE(10,12) FUA bit\"); \\\n\t_FSG_MODULE_PARAM(prefix, params, luns, uint,\t\t\t\\\n\t\t\t  \"number of LUNs\");\t\t\t\t\\\n\t_FSG_MODULE_PARAM(prefix, params, stall, bool,\t\t\t\\\n\t\t\t  \"false to prevent bulk stalls\")\n\n#ifdef CONFIG_USB_GADGET_DEBUG_FILES\n\n#define FSG_MODULE_PARAMETERS(prefix, params)\t\t\t\t\\\n\t__FSG_MODULE_PARAMETERS(prefix, params);\t\t\t\\\n\tmodule_param_named(num_buffers, fsg_num_buffers, uint, S_IRUGO);\\\n\tMODULE_PARM_DESC(num_buffers, \"Number of pipeline buffers\")\n#else\n\n#define FSG_MODULE_PARAMETERS(prefix, params)\t\t\t\t\\\n\t__FSG_MODULE_PARAMETERS(prefix, params)\n\n#endif\n\nstruct fsg_common;\n\n \nstruct fsg_lun_opts {\n\tstruct config_group group;\n\tstruct fsg_lun *lun;\n\tint lun_id;\n};\n\nstruct fsg_opts {\n\tstruct fsg_common *common;\n\tstruct usb_function_instance func_inst;\n\tstruct fsg_lun_opts lun0;\n\tstruct config_group *default_groups[2];\n\tbool no_configfs;  \n\n\t \n\tstruct mutex\t\t\tlock;\n\tint\t\t\t\trefcnt;\n};\n\nstruct fsg_lun_config {\n\tconst char *filename;\n\tchar ro;\n\tchar removable;\n\tchar cdrom;\n\tchar nofua;\n\tchar inquiry_string[INQUIRY_STRING_LEN];\n};\n\nstruct fsg_config {\n\tunsigned nluns;\n\tstruct fsg_lun_config luns[FSG_MAX_LUNS];\n\n\t \n\tconst struct fsg_operations\t*ops;\n\t \n\tvoid\t\t\t*private_data;\n\n\tconst char *vendor_name;\t\t \n\tconst char *product_name;\t\t \n\n\tchar\t\t\tcan_stall;\n\tunsigned int\t\tfsg_num_buffers;\n};\n\nstatic inline struct fsg_opts *\nfsg_opts_from_func_inst(const struct usb_function_instance *fi)\n{\n\treturn container_of(fi, struct fsg_opts, func_inst);\n}\n\nvoid fsg_common_set_sysfs(struct fsg_common *common, bool sysfs);\n\nint fsg_common_set_num_buffers(struct fsg_common *common, unsigned int n);\n\nvoid fsg_common_free_buffers(struct fsg_common *common);\n\nint fsg_common_set_cdev(struct fsg_common *common,\n\t\t\tstruct usb_composite_dev *cdev, bool can_stall);\n\nvoid fsg_common_remove_lun(struct fsg_lun *lun);\n\nvoid fsg_common_remove_luns(struct fsg_common *common);\n\nint fsg_common_create_lun(struct fsg_common *common, struct fsg_lun_config *cfg,\n\t\t\t  unsigned int id, const char *name,\n\t\t\t  const char **name_pfx);\n\nint fsg_common_create_luns(struct fsg_common *common, struct fsg_config *cfg);\n\nvoid fsg_common_set_inquiry_string(struct fsg_common *common, const char *vn,\n\t\t\t\t   const char *pn);\n\nvoid fsg_config_from_params(struct fsg_config *cfg,\n\t\t\t    const struct fsg_module_parameters *params,\n\t\t\t    unsigned int fsg_num_buffers);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}