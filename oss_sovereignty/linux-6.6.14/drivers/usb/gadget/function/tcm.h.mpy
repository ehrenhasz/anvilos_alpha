{
  "module_name": "tcm.h",
  "hash_id": "9bc89140f92e16399547d245bb22dcc9ac513f79cca0dc487bb8266d71de8fb3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/gadget/function/tcm.h",
  "human_readable_source": " \n#ifndef __TARGET_USB_GADGET_H__\n#define __TARGET_USB_GADGET_H__\n\n#include <linux/kref.h>\n \n#include <linux/usb/composite.h>\n#include <linux/usb/uas.h>\n#include <linux/usb/storage.h>\n#include <target/target_core_base.h>\n#include <target/target_core_fabric.h>\n\n#define USBG_NAMELEN 32\n\n#define fuas_to_gadget(f)\t(f->function.config->cdev->gadget)\n#define UASP_SS_EP_COMP_LOG_STREAMS 4\n#define UASP_SS_EP_COMP_NUM_STREAMS (1 << UASP_SS_EP_COMP_LOG_STREAMS)\n\nenum {\n\tUSB_G_STR_INT_UAS = 0,\n\tUSB_G_STR_INT_BBB,\n};\n\n#define USB_G_ALT_INT_BBB       0\n#define USB_G_ALT_INT_UAS       1\n\n#define USB_G_DEFAULT_SESSION_TAGS\t128\n\nstruct tcm_usbg_nexus {\n\tstruct se_session *tvn_se_sess;\n};\n\nstruct usbg_tpg {\n\tstruct mutex tpg_mutex;\n\t \n\tu16 tport_tpgt;\n\t \n\tstruct usbg_tport *tport;\n\tstruct workqueue_struct *workqueue;\n\t \n\tstruct se_portal_group se_tpg;\n\tu32 gadget_connect;\n\tstruct tcm_usbg_nexus *tpg_nexus;\n\tatomic_t tpg_port_count;\n\n\tstruct usb_function_instance *fi;\n};\n\nstruct usbg_tport {\n\t \n\tu64 tport_wwpn;\n\t \n\tchar tport_name[USBG_NAMELEN];\n\t \n\tstruct se_wwn tport_wwn;\n};\n\nenum uas_state {\n\tUASP_SEND_DATA,\n\tUASP_RECEIVE_DATA,\n\tUASP_SEND_STATUS,\n\tUASP_QUEUE_COMMAND,\n};\n\n#define USBG_MAX_CMD    64\nstruct usbg_cmd {\n\t \n\tu8 cmd_buf[USBG_MAX_CMD];\n\tu32 data_len;\n\tstruct work_struct work;\n\tint unpacked_lun;\n\tstruct se_cmd se_cmd;\n\tvoid *data_buf;  \n\tstruct f_uas *fu;\n\tstruct completion write_complete;\n\tstruct kref ref;\n\n\t \n\tu16 tag;\n\tu16 prio_attr;\n\tstruct sense_iu sense_iu;\n\tenum uas_state state;\n\tstruct uas_stream *stream;\n\n\t \n\t__le32 bot_tag;\n\tunsigned int csw_code;\n\tunsigned is_read:1;\n\n};\n\nstruct uas_stream {\n\tstruct usb_request\t*req_in;\n\tstruct usb_request\t*req_out;\n\tstruct usb_request\t*req_status;\n};\n\nstruct usbg_cdb {\n\tstruct usb_request\t*req;\n\tvoid\t\t\t*buf;\n};\n\nstruct bot_status {\n\tstruct usb_request\t*req;\n\tstruct bulk_cs_wrap\tcsw;\n};\n\nstruct f_uas {\n\tstruct usbg_tpg\t\t*tpg;\n\tstruct usb_function\tfunction;\n\tu16\t\t\tiface;\n\n\tu32\t\t\tflags;\n#define USBG_ENABLED\t\t(1 << 0)\n#define USBG_IS_UAS\t\t(1 << 1)\n#define USBG_USE_STREAMS\t(1 << 2)\n#define USBG_IS_BOT\t\t(1 << 3)\n#define USBG_BOT_CMD_PEND\t(1 << 4)\n\n\tstruct usbg_cdb\t\tcmd;\n\tstruct usb_ep\t\t*ep_in;\n\tstruct usb_ep\t\t*ep_out;\n\n\t \n\tstruct usb_ep\t\t*ep_status;\n\tstruct usb_ep\t\t*ep_cmd;\n\tstruct uas_stream\tstream[UASP_SS_EP_COMP_NUM_STREAMS];\n\n\t \n\tstruct bot_status\tbot_status;\n\tstruct usb_request\t*bot_req_in;\n\tstruct usb_request\t*bot_req_out;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}