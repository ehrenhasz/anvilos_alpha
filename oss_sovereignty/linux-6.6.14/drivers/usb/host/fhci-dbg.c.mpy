{
  "module_name": "fhci-dbg.c",
  "hash_id": "b106c2ecaa65b33c1727da257a827f2a993fdf84642fe05d033cc1e07f25c6df",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/host/fhci-dbg.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/errno.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/usb.h>\n#include <linux/usb/hcd.h>\n#include \"fhci.h\"\n\nvoid fhci_dbg_isr(struct fhci_hcd *fhci, int usb_er)\n{\n\tint i;\n\n\tif (usb_er == -1) {\n\t\tfhci->usb_irq_stat[12]++;\n\t\treturn;\n\t}\n\n\tfor (i = 0; i < 12; ++i) {\n\t\tif (usb_er & (1 << i))\n\t\t\tfhci->usb_irq_stat[i]++;\n\t}\n}\n\nstatic int fhci_dfs_regs_show(struct seq_file *s, void *v)\n{\n\tstruct fhci_hcd *fhci = s->private;\n\tstruct qe_usb_ctlr __iomem *regs = fhci->regs;\n\n\tseq_printf(s,\n\t\t\"mode: 0x%x\\n\" \"addr: 0x%x\\n\"\n\t\t\"command: 0x%x\\n\" \"ep0: 0x%x\\n\"\n\t\t\"event: 0x%x\\n\" \"mask: 0x%x\\n\"\n\t\t\"status: 0x%x\\n\" \"SOF timer: %d\\n\"\n\t\t\"frame number: %d\\n\"\n\t\t\"lines status: 0x%x\\n\",\n\t\tin_8(&regs->usb_usmod), in_8(&regs->usb_usadr),\n\t\tin_8(&regs->usb_uscom), in_be16(&regs->usb_usep[0]),\n\t\tin_be16(&regs->usb_usber), in_be16(&regs->usb_usbmr),\n\t\tin_8(&regs->usb_usbs), in_be16(&regs->usb_ussft),\n\t\tin_be16(&regs->usb_usfrn),\n\t\tfhci_ioports_check_bus_state(fhci));\n\n\treturn 0;\n}\nDEFINE_SHOW_ATTRIBUTE(fhci_dfs_regs);\n\nstatic int fhci_dfs_irq_stat_show(struct seq_file *s, void *v)\n{\n\tstruct fhci_hcd *fhci = s->private;\n\tint *usb_irq_stat = fhci->usb_irq_stat;\n\n\tseq_printf(s,\n\t\t\"RXB: %d\\n\" \"TXB: %d\\n\" \"BSY: %d\\n\"\n\t\t\"SOF: %d\\n\" \"TXE0: %d\\n\" \"TXE1: %d\\n\"\n\t\t\"TXE2: %d\\n\" \"TXE3: %d\\n\" \"IDLE: %d\\n\"\n\t\t\"RESET: %d\\n\" \"SFT: %d\\n\" \"MSF: %d\\n\"\n\t\t\"IDLE_ONLY: %d\\n\",\n\t\tusb_irq_stat[0], usb_irq_stat[1], usb_irq_stat[2],\n\t\tusb_irq_stat[3], usb_irq_stat[4], usb_irq_stat[5],\n\t\tusb_irq_stat[6], usb_irq_stat[7], usb_irq_stat[8],\n\t\tusb_irq_stat[9], usb_irq_stat[10], usb_irq_stat[11],\n\t\tusb_irq_stat[12]);\n\n\treturn 0;\n}\nDEFINE_SHOW_ATTRIBUTE(fhci_dfs_irq_stat);\n\nvoid fhci_dfs_create(struct fhci_hcd *fhci)\n{\n\tstruct device *dev = fhci_to_hcd(fhci)->self.controller;\n\n\tfhci->dfs_root = debugfs_create_dir(dev_name(dev), usb_debug_root);\n\n\tdebugfs_create_file(\"regs\", S_IFREG | S_IRUGO, fhci->dfs_root, fhci,\n\t\t\t    &fhci_dfs_regs_fops);\n\tdebugfs_create_file(\"irq_stat\", S_IFREG | S_IRUGO, fhci->dfs_root, fhci,\n\t\t\t    &fhci_dfs_irq_stat_fops);\n}\n\nvoid fhci_dfs_destroy(struct fhci_hcd *fhci)\n{\n\tdebugfs_remove_recursive(fhci->dfs_root);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}