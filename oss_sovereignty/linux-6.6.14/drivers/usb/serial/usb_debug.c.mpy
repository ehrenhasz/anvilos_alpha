{
  "module_name": "usb_debug.c",
  "hash_id": "b04e9315c868594cded68ac1a66f774099a536f0b3122d28aabbb6a4241af954",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/serial/usb_debug.c",
  "human_readable_source": "\n \n\n#include <linux/gfp.h>\n#include <linux/kernel.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/usb.h>\n#include <linux/usb/serial.h>\n\n#define USB_DEBUG_MAX_PACKET_SIZE\t8\n#define USB_DEBUG_BRK_SIZE\t\t8\nstatic const char USB_DEBUG_BRK[USB_DEBUG_BRK_SIZE] = {\n\t0x00,\n\t0xff,\n\t0x01,\n\t0xfe,\n\t0x00,\n\t0xfe,\n\t0x01,\n\t0xff,\n};\n\nstatic const struct usb_device_id id_table[] = {\n\t{ USB_DEVICE(0x0525, 0x127a) },\n\t{ },\n};\n\nstatic const struct usb_device_id dbc_id_table[] = {\n\t{ USB_DEVICE(0x1d6b, 0x0010) },\n\t{ USB_DEVICE(0x1d6b, 0x0011) },\n\t{ },\n};\n\nstatic const struct usb_device_id id_table_combined[] = {\n\t{ USB_DEVICE(0x0525, 0x127a) },\n\t{ USB_DEVICE(0x1d6b, 0x0010) },\n\t{ USB_DEVICE(0x1d6b, 0x0011) },\n\t{ },\n};\nMODULE_DEVICE_TABLE(usb, id_table_combined);\n\n \nstatic int usb_debug_break_ctl(struct tty_struct *tty, int break_state)\n{\n\tstruct usb_serial_port *port = tty->driver_data;\n\tint ret;\n\n\tif (!break_state)\n\t\treturn 0;\n\n\tret = usb_serial_generic_write(tty, port, USB_DEBUG_BRK, USB_DEBUG_BRK_SIZE);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nstatic void usb_debug_process_read_urb(struct urb *urb)\n{\n\tstruct usb_serial_port *port = urb->context;\n\n\tif (urb->actual_length == USB_DEBUG_BRK_SIZE &&\n\t\tmemcmp(urb->transfer_buffer, USB_DEBUG_BRK,\n\t\t\t\t\t\tUSB_DEBUG_BRK_SIZE) == 0) {\n\t\tusb_serial_handle_break(port);\n\t\treturn;\n\t}\n\n\tusb_serial_generic_process_read_urb(urb);\n}\n\nstatic struct usb_serial_driver debug_device = {\n\t.driver = {\n\t\t.owner =\tTHIS_MODULE,\n\t\t.name =\t\t\"debug\",\n\t},\n\t.id_table =\t\tid_table,\n\t.num_ports =\t\t1,\n\t.bulk_out_size =\tUSB_DEBUG_MAX_PACKET_SIZE,\n\t.break_ctl =\t\tusb_debug_break_ctl,\n\t.process_read_urb =\tusb_debug_process_read_urb,\n};\n\nstatic struct usb_serial_driver dbc_device = {\n\t.driver = {\n\t\t.owner =\tTHIS_MODULE,\n\t\t.name =\t\t\"xhci_dbc\",\n\t},\n\t.id_table =\t\tdbc_id_table,\n\t.num_ports =\t\t1,\n\t.break_ctl =\t\tusb_debug_break_ctl,\n\t.process_read_urb =\tusb_debug_process_read_urb,\n};\n\nstatic struct usb_serial_driver * const serial_drivers[] = {\n\t&debug_device, &dbc_device, NULL\n};\n\nmodule_usb_serial_driver(serial_drivers, id_table_combined);\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}