{
  "module_name": "wishbone-serial.c",
  "hash_id": "45d7c2cb930313f6bd86e19bb30e3270c690b25db3122b13a887f0d880f11eab",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/serial/wishbone-serial.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/usb.h>\n#include <linux/usb/serial.h>\n#include <linux/uaccess.h>\n\n#define GSI_VENDOR_OPENCLOSE 0xB0\n\nstatic const struct usb_device_id id_table[] = {\n\t{ USB_DEVICE_AND_INTERFACE_INFO(0x1D50, 0x6062, 0xFF, 0xFF, 0xFF) },\n\t{ },\n};\nMODULE_DEVICE_TABLE(usb, id_table);\n\n \nstatic int usb_gsi_openclose(struct usb_serial_port *port, int value)\n{\n\tstruct usb_device *dev = port->serial->dev;\n\n\treturn usb_control_msg(\n\t\tdev,\n\t\tusb_sndctrlpipe(dev, 0),  \n\t\tGSI_VENDOR_OPENCLOSE,\n\t\tUSB_DIR_OUT|USB_TYPE_VENDOR|USB_RECIP_INTERFACE,\n\t\tvalue,  \n\t\tport->serial->interface->cur_altsetting->desc.bInterfaceNumber,\n\t\tNULL, 0,   \n\t\t5000);  \n}\n\nstatic int wishbone_serial_open(struct tty_struct *tty,\n\t\t\t\tstruct usb_serial_port *port)\n{\n\tint retval;\n\n\tretval = usb_gsi_openclose(port, 1);\n\tif (retval) {\n\t\tdev_err(&port->serial->dev->dev,\n\t\t       \"Could not mark device as open (%d)\\n\",\n\t\t       retval);\n\t\treturn retval;\n\t}\n\n\tretval = usb_serial_generic_open(tty, port);\n\tif (retval)\n\t\tusb_gsi_openclose(port, 0);\n\n\treturn retval;\n}\n\nstatic void wishbone_serial_close(struct usb_serial_port *port)\n{\n\tusb_serial_generic_close(port);\n\tusb_gsi_openclose(port, 0);\n}\n\nstatic struct usb_serial_driver wishbone_serial_device = {\n\t.driver = {\n\t\t.owner =\tTHIS_MODULE,\n\t\t.name =\t\t\"wishbone_serial\",\n\t},\n\t.id_table =\t\tid_table,\n\t.num_ports =\t\t1,\n\t.open =\t\t\t&wishbone_serial_open,\n\t.close =\t\t&wishbone_serial_close,\n};\n\nstatic struct usb_serial_driver * const serial_drivers[] = {\n\t&wishbone_serial_device, NULL\n};\n\nmodule_usb_serial_driver(serial_drivers, id_table);\n\nMODULE_AUTHOR(\"Wesley W. Terpstra <w.terpstra@gsi.de>\");\nMODULE_DESCRIPTION(\"USB Wishbone-Serial adapter\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}