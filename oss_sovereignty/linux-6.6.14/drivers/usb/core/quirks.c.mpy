{
  "module_name": "quirks.c",
  "hash_id": "4bc5783fe52f3e2b8ce50ae0b928d9392eadbf1d69b1c79576c20d06d6016dd6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/usb/core/quirks.c",
  "human_readable_source": "\n \n\n#include <linux/moduleparam.h>\n#include <linux/usb.h>\n#include <linux/usb/quirks.h>\n#include <linux/usb/hcd.h>\n#include \"usb.h\"\n\nstruct quirk_entry {\n\tu16 vid;\n\tu16 pid;\n\tu32 flags;\n};\n\nstatic DEFINE_MUTEX(quirk_mutex);\n\nstatic struct quirk_entry *quirk_list;\nstatic unsigned int quirk_count;\n\nstatic char quirks_param[128];\n\nstatic int quirks_param_set(const char *value, const struct kernel_param *kp)\n{\n\tchar *val, *p, *field;\n\tu16 vid, pid;\n\tu32 flags;\n\tsize_t i;\n\tint err;\n\n\tval = kstrdup(value, GFP_KERNEL);\n\tif (!val)\n\t\treturn -ENOMEM;\n\n\terr = param_set_copystring(val, kp);\n\tif (err) {\n\t\tkfree(val);\n\t\treturn err;\n\t}\n\n\tmutex_lock(&quirk_mutex);\n\n\tif (!*val) {\n\t\tquirk_count = 0;\n\t\tkfree(quirk_list);\n\t\tquirk_list = NULL;\n\t\tgoto unlock;\n\t}\n\n\tfor (quirk_count = 1, i = 0; val[i]; i++)\n\t\tif (val[i] == ',')\n\t\t\tquirk_count++;\n\n\tif (quirk_list) {\n\t\tkfree(quirk_list);\n\t\tquirk_list = NULL;\n\t}\n\n\tquirk_list = kcalloc(quirk_count, sizeof(struct quirk_entry),\n\t\t\t     GFP_KERNEL);\n\tif (!quirk_list) {\n\t\tquirk_count = 0;\n\t\tmutex_unlock(&quirk_mutex);\n\t\tkfree(val);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor (i = 0, p = val; p && *p;) {\n\t\t \n\t\tfield = strsep(&p, \":\");\n\t\tif (!field)\n\t\t\tbreak;\n\n\t\tif (kstrtou16(field, 16, &vid))\n\t\t\tbreak;\n\n\t\tfield = strsep(&p, \":\");\n\t\tif (!field)\n\t\t\tbreak;\n\n\t\tif (kstrtou16(field, 16, &pid))\n\t\t\tbreak;\n\n\t\tfield = strsep(&p, \",\");\n\t\tif (!field || !*field)\n\t\t\tbreak;\n\n\t\t \n\t\tfor (flags = 0; *field; field++) {\n\t\t\tswitch (*field) {\n\t\t\tcase 'a':\n\t\t\t\tflags |= USB_QUIRK_STRING_FETCH_255;\n\t\t\t\tbreak;\n\t\t\tcase 'b':\n\t\t\t\tflags |= USB_QUIRK_RESET_RESUME;\n\t\t\t\tbreak;\n\t\t\tcase 'c':\n\t\t\t\tflags |= USB_QUIRK_NO_SET_INTF;\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\tflags |= USB_QUIRK_CONFIG_INTF_STRINGS;\n\t\t\t\tbreak;\n\t\t\tcase 'e':\n\t\t\t\tflags |= USB_QUIRK_RESET;\n\t\t\t\tbreak;\n\t\t\tcase 'f':\n\t\t\t\tflags |= USB_QUIRK_HONOR_BNUMINTERFACES;\n\t\t\t\tbreak;\n\t\t\tcase 'g':\n\t\t\t\tflags |= USB_QUIRK_DELAY_INIT;\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\tflags |= USB_QUIRK_LINEAR_UFRAME_INTR_BINTERVAL;\n\t\t\t\tbreak;\n\t\t\tcase 'i':\n\t\t\t\tflags |= USB_QUIRK_DEVICE_QUALIFIER;\n\t\t\t\tbreak;\n\t\t\tcase 'j':\n\t\t\t\tflags |= USB_QUIRK_IGNORE_REMOTE_WAKEUP;\n\t\t\t\tbreak;\n\t\t\tcase 'k':\n\t\t\t\tflags |= USB_QUIRK_NO_LPM;\n\t\t\t\tbreak;\n\t\t\tcase 'l':\n\t\t\t\tflags |= USB_QUIRK_LINEAR_FRAME_INTR_BINTERVAL;\n\t\t\t\tbreak;\n\t\t\tcase 'm':\n\t\t\t\tflags |= USB_QUIRK_DISCONNECT_SUSPEND;\n\t\t\t\tbreak;\n\t\t\tcase 'n':\n\t\t\t\tflags |= USB_QUIRK_DELAY_CTRL_MSG;\n\t\t\t\tbreak;\n\t\t\tcase 'o':\n\t\t\t\tflags |= USB_QUIRK_HUB_SLOW_RESET;\n\t\t\t\tbreak;\n\t\t\t \n\t\t\t}\n\t\t}\n\n\t\tquirk_list[i++] = (struct quirk_entry)\n\t\t\t{ .vid = vid, .pid = pid, .flags = flags };\n\t}\n\n\tif (i < quirk_count)\n\t\tquirk_count = i;\n\nunlock:\n\tmutex_unlock(&quirk_mutex);\n\tkfree(val);\n\n\treturn 0;\n}\n\nstatic const struct kernel_param_ops quirks_param_ops = {\n\t.set = quirks_param_set,\n\t.get = param_get_string,\n};\n\nstatic struct kparam_string quirks_param_string = {\n\t.maxlen = sizeof(quirks_param),\n\t.string = quirks_param,\n};\n\ndevice_param_cb(quirks, &quirks_param_ops, &quirks_param_string, 0644);\nMODULE_PARM_DESC(quirks, \"Add/modify USB quirks by specifying quirks=vendorID:productID:quirks\");\n\n \nstatic const struct usb_device_id usb_quirk_list[] = {\n\t \n\t{ USB_DEVICE(0x0204, 0x6025), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0218, 0x0201), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x0218, 0x0401), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x03f0, 0x0701), .driver_info =\n\t\t\tUSB_QUIRK_STRING_FETCH_255 },\n\n\t \n\t{ USB_DEVICE(0x03f0, 0x3f40), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x041e, 0x3020), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0424, 0x3503), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x045e, 0x00e1), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x045e, 0x0770), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x045e, 0x07c6), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x046a, 0x0023), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x0825), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x082d), .driver_info = USB_QUIRK_DELAY_INIT },\n\t{ USB_DEVICE(0x046d, 0x0841), .driver_info = USB_QUIRK_DELAY_INIT },\n\t{ USB_DEVICE(0x046d, 0x0843), .driver_info = USB_QUIRK_DELAY_INIT },\n\t{ USB_DEVICE(0x046d, 0x085b), .driver_info = USB_QUIRK_DELAY_INIT },\n\t{ USB_DEVICE(0x046d, 0x085c), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x0847), .driver_info = USB_QUIRK_DELAY_INIT },\n\t{ USB_DEVICE(0x046d, 0x0848), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x0853), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x086c), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c1), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c2), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c3), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c5), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c6), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0x08c7), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0xc122), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x0471, 0x0155), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x047f, 0xc008), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x047f, 0xc013), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x04b4, 0x0526), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x04d8, 0x000c), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x04e7, 0x0009), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x04e7, 0x0030), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x04e8, 0x6601), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x04f3, 0x0089), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t{ USB_DEVICE(0x04f3, 0x009b), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t{ USB_DEVICE(0x04f3, 0x010c), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t{ USB_DEVICE(0x04f3, 0x0125), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t{ USB_DEVICE(0x04f3, 0x016f), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t{ USB_DEVICE(0x04f3, 0x0381), .driver_info =\n\t\t\tUSB_QUIRK_NO_LPM },\n\n\t{ USB_DEVICE(0x04f3, 0x21b8), .driver_info =\n\t\t\tUSB_QUIRK_DEVICE_QUALIFIER },\n\n\t \n\t{ USB_DEVICE(0x0582, 0x0007), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0582, 0x0027), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x058f, 0x9254), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x05ac, 0x021a), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x05e3, 0x0612), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x05cc, 0x2267), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x05e3, 0x0616), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x0638, 0x0a13), .driver_info =\n\t  USB_QUIRK_STRING_FETCH_255 },\n\n\t \n\t{ USB_DEVICE(0x06a3, 0x0006), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x06bd, 0x0001), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x06f8, 0x0804), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x06f8, 0x3005), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x06f8, 0xb000), .driver_info =\n\t\t\tUSB_QUIRK_ENDPOINT_IGNORE },\n\n\t \n\t{ USB_DEVICE(0x0763, 0x0192), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0781, 0x5583), .driver_info = USB_QUIRK_NO_LPM },\n\t{ USB_DEVICE(0x0781, 0x5591), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x0853, 0x011b), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x08ec, 0x1000), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0904, 0x6101), .driver_info =\n\t\t\tUSB_QUIRK_LINEAR_FRAME_INTR_BINTERVAL },\n\t{ USB_DEVICE(0x0904, 0x6102), .driver_info =\n\t\t\tUSB_QUIRK_LINEAR_FRAME_INTR_BINTERVAL },\n\t{ USB_DEVICE(0x0904, 0x6103), .driver_info =\n\t\t\tUSB_QUIRK_LINEAR_FRAME_INTR_BINTERVAL },\n\n\t \n\t{ USB_DEVICE(0x0926, 0x0202), .driver_info =\n\t\t\tUSB_QUIRK_ENDPOINT_IGNORE },\n\n\t \n\t{ USB_DEVICE(0x0926, 0x0208), .driver_info =\n\t\t\tUSB_QUIRK_ENDPOINT_IGNORE },\n\n\t \n\t{ USB_DEVICE(0x0926, 0x3333), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x0951, 0x1666), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x0955, 0x7018), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7019), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7418), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7721), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7c18), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7e19), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x0955, 0x7f21), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0971, 0x2000), .driver_info = USB_QUIRK_NO_SET_INTF },\n\n\t \n\t{ USB_DEVICE(0x09a1, 0x0028), .driver_info = USB_QUIRK_DELAY_CTRL_MSG },\n\n\t \n\t{ USB_DEVICE(0x0a5c, 0x2021), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0a92, 0x0091), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x0b05, 0x17e0), .driver_info =\n\t\t\tUSB_QUIRK_IGNORE_REMOTE_WAKEUP },\n\n\t \n\t{ USB_DEVICE(0x0bda, 0x0151), .driver_info = USB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x0bda, 0x0487), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x0bda, 0x8153), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x0c45, 0x7056), .driver_info =\n\t\t\tUSB_QUIRK_IGNORE_REMOTE_WAKEUP },\n\n\t \n\t{ USB_DEVICE(0x10d6, 0x2200), .driver_info =\n\t\t\tUSB_QUIRK_STRING_FETCH_255 },\n\n\t \n\t{ USB_DEVICE(0x1235, 0x0061), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x1235, 0x8211), .driver_info =\n\t\t\tUSB_QUIRK_DISCONNECT_SUSPEND },\n\n\t \n\t{ USB_DEVICE(0x12d1, 0x15bb), .driver_info =\n\t\t\tUSB_QUIRK_DISCONNECT_SUSPEND },\n\t{ USB_DEVICE(0x12d1, 0x15c3), .driver_info =\n\t\t\tUSB_QUIRK_DISCONNECT_SUSPEND },\n\n\t \n\t{ USB_DEVICE(0x1516, 0x8628), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x1532, 0x0116), .driver_info =\n\t\t\tUSB_QUIRK_LINEAR_UFRAME_INTR_BINTERVAL },\n\n\t \n\t{ USB_DEVICE(0x17ef, 0x1018), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x17ef, 0x1019), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x17ef, 0x720c), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x17ef, 0x721e), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x17ef, 0xa012), .driver_info =\n\t\t\tUSB_QUIRK_DISCONNECT_SUSPEND },\n\n\t \n\t{ USB_DEVICE(0x17ef, 0xa387), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x1908, 0x1315), .driver_info =\n\t\t\tUSB_QUIRK_HONOR_BNUMINTERFACES },\n\n\t \n\t{ USB_DEVICE(0x1a0a, 0x0200), .driver_info =\n\t\t\tUSB_QUIRK_LINEAR_UFRAME_INTR_BINTERVAL },\n\n\t \n\t{ USB_DEVICE(0x1a40, 0x0101), .driver_info = USB_QUIRK_HUB_SLOW_RESET },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b13), .driver_info = USB_QUIRK_DELAY_INIT |\n\t  USB_QUIRK_DELAY_CTRL_MSG },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b15), .driver_info = USB_QUIRK_DELAY_INIT |\n\t  USB_QUIRK_DELAY_CTRL_MSG },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b20), .driver_info = USB_QUIRK_DELAY_INIT |\n\t  USB_QUIRK_DELAY_CTRL_MSG },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b33), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b36), .driver_info = USB_QUIRK_DELAY_INIT },\n\n\t \n\t{ USB_DEVICE(0x1b1c, 0x1b38), .driver_info = USB_QUIRK_DELAY_INIT |\n\t  USB_QUIRK_DELAY_CTRL_MSG },\n\n\t \n\t{ USB_DEVICE(0x1c75, 0x0204), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x1de1, 0xc102), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x1edb, 0xbd3b), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x1edb, 0xbd4f), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x2040, 0x7200), .driver_info =\n\t\t\tUSB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x2386, 0x3114), .driver_info = USB_QUIRK_NO_LPM },\n\n\t{ USB_DEVICE(0x2386, 0x3119), .driver_info = USB_QUIRK_NO_LPM },\n\n\t{ USB_DEVICE(0x2386, 0x350e), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x2ca3, 0x0031), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x2ce3, 0x9563), .driver_info = USB_QUIRK_NO_LPM },\n\n\t \n\t{ USB_DEVICE(0x413c, 0xb062), .driver_info = USB_QUIRK_NO_LPM | USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x4296, 0x7570), .driver_info = USB_QUIRK_CONFIG_INTF_STRINGS },\n\n\t \n\t{ USB_DEVICE(0x8086, 0xf1a5), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t{ }   \n};\n\nstatic const struct usb_device_id usb_interface_quirk_list[] = {\n\t \n\t{ USB_VENDOR_AND_INTERFACE_INFO(0x046d, USB_CLASS_VIDEO, 1, 0),\n\t  .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t{ }   \n};\n\nstatic const struct usb_device_id usb_amd_resume_quirk_list[] = {\n\t \n\t{ USB_DEVICE(0x17ef, 0x602e), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x093a, 0x2500), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x093a, 0x2510), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x093a, 0x2521), .driver_info = USB_QUIRK_RESET_RESUME },\n\t{ USB_DEVICE(0x03f0, 0x2b4a), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t \n\t{ USB_DEVICE(0x046d, 0xc05a), .driver_info = USB_QUIRK_RESET_RESUME },\n\n\t{ }   \n};\n\n \nstatic const struct usb_device_id usb_endpoint_ignore[] = {\n\t{ USB_DEVICE_INTERFACE_NUMBER(0x06f8, 0xb000, 5), .driver_info = 0x01 },\n\t{ USB_DEVICE_INTERFACE_NUMBER(0x06f8, 0xb000, 5), .driver_info = 0x81 },\n\t{ USB_DEVICE_INTERFACE_NUMBER(0x0926, 0x0202, 1), .driver_info = 0x85 },\n\t{ USB_DEVICE_INTERFACE_NUMBER(0x0926, 0x0208, 1), .driver_info = 0x85 },\n\t{ }\n};\n\nbool usb_endpoint_is_ignored(struct usb_device *udev,\n\t\t\t     struct usb_host_interface *intf,\n\t\t\t     struct usb_endpoint_descriptor *epd)\n{\n\tconst struct usb_device_id *id;\n\tunsigned int address;\n\n\tfor (id = usb_endpoint_ignore; id->match_flags; ++id) {\n\t\tif (!usb_match_device(udev, id))\n\t\t\tcontinue;\n\n\t\tif (!usb_match_one_id_intf(udev, intf, id))\n\t\t\tcontinue;\n\n\t\taddress = id->driver_info;\n\t\tif (address == epd->bEndpointAddress)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nstatic bool usb_match_any_interface(struct usb_device *udev,\n\t\t\t\t    const struct usb_device_id *id)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < udev->descriptor.bNumConfigurations; ++i) {\n\t\tstruct usb_host_config *cfg = &udev->config[i];\n\t\tunsigned int j;\n\n\t\tfor (j = 0; j < cfg->desc.bNumInterfaces; ++j) {\n\t\t\tstruct usb_interface_cache *cache;\n\t\t\tstruct usb_host_interface *intf;\n\n\t\t\tcache = cfg->intf_cache[j];\n\t\t\tif (cache->num_altsetting == 0)\n\t\t\t\tcontinue;\n\n\t\t\tintf = &cache->altsetting[0];\n\t\t\tif (usb_match_one_id_intf(udev, intf, id))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nstatic int usb_amd_resume_quirk(struct usb_device *udev)\n{\n\tstruct usb_hcd *hcd;\n\n\thcd = bus_to_hcd(udev->bus);\n\t \n\tif (udev->level == 1 && hcd->amd_resume_bug == 1)\n\t\treturn 1;\n\n\treturn 0;\n}\n\nstatic u32 usb_detect_static_quirks(struct usb_device *udev,\n\t\t\t\t    const struct usb_device_id *id)\n{\n\tu32 quirks = 0;\n\n\tfor (; id->match_flags; id++) {\n\t\tif (!usb_match_device(udev, id))\n\t\t\tcontinue;\n\n\t\tif ((id->match_flags & USB_DEVICE_ID_MATCH_INT_INFO) &&\n\t\t    !usb_match_any_interface(udev, id))\n\t\t\tcontinue;\n\n\t\tquirks |= (u32)(id->driver_info);\n\t}\n\n\treturn quirks;\n}\n\nstatic u32 usb_detect_dynamic_quirks(struct usb_device *udev)\n{\n\tu16 vid = le16_to_cpu(udev->descriptor.idVendor);\n\tu16 pid = le16_to_cpu(udev->descriptor.idProduct);\n\tint i, flags = 0;\n\n\tmutex_lock(&quirk_mutex);\n\n\tfor (i = 0; i < quirk_count; i++) {\n\t\tif (vid == quirk_list[i].vid && pid == quirk_list[i].pid) {\n\t\t\tflags = quirk_list[i].flags;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tmutex_unlock(&quirk_mutex);\n\n\treturn flags;\n}\n\n \nvoid usb_detect_quirks(struct usb_device *udev)\n{\n\tudev->quirks = usb_detect_static_quirks(udev, usb_quirk_list);\n\n\t \n\tif (usb_amd_resume_quirk(udev))\n\t\tudev->quirks |= usb_detect_static_quirks(udev,\n\t\t\t\tusb_amd_resume_quirk_list);\n\n\tudev->quirks ^= usb_detect_dynamic_quirks(udev);\n\n\tif (udev->quirks)\n\t\tdev_dbg(&udev->dev, \"USB quirks for this device: %x\\n\",\n\t\t\tudev->quirks);\n\n#ifdef CONFIG_USB_DEFAULT_PERSIST\n\tif (!(udev->quirks & USB_QUIRK_RESET))\n\t\tudev->persist_enabled = 1;\n#else\n\t \n\tif (udev->descriptor.bDeviceClass == USB_CLASS_HUB)\n\t\tudev->persist_enabled = 1;\n#endif\t \n}\n\nvoid usb_detect_interface_quirks(struct usb_device *udev)\n{\n\tu32 quirks;\n\n\tquirks = usb_detect_static_quirks(udev, usb_interface_quirk_list);\n\tif (quirks == 0)\n\t\treturn;\n\n\tdev_dbg(&udev->dev, \"USB interface quirks for this device: %x\\n\",\n\t\tquirks);\n\tudev->quirks |= quirks;\n}\n\nvoid usb_release_quirk_list(void)\n{\n\tmutex_lock(&quirk_mutex);\n\tkfree(quirk_list);\n\tquirk_list = NULL;\n\tmutex_unlock(&quirk_mutex);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}