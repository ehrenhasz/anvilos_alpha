{
  "module_name": "img-ir-sharp.c",
  "hash_id": "84996d1df78c1c5a4738779a2615000b3e616782ac2e5b8328988a8b59cb8151",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/rc/img-ir/img-ir-sharp.c",
  "human_readable_source": "\n \n\n#include \"img-ir-hw.h\"\n\n \nstatic int img_ir_sharp_scancode(int len, u64 raw, u64 enabled_protocols,\n\t\t\t\t struct img_ir_scancode_req *request)\n{\n\tunsigned int addr, cmd, exp, chk;\n\n\tif (len != 15)\n\t\treturn -EINVAL;\n\n\taddr = (raw >>   0) & 0x1f;\n\tcmd  = (raw >>   5) & 0xff;\n\texp  = (raw >>  13) &  0x1;\n\tchk  = (raw >>  14) &  0x1;\n\n\t \n\tif (!exp)\n\t\treturn -EINVAL;\n\tif (chk)\n\t\t \n\t\treturn -EINVAL;\n\n\trequest->protocol = RC_PROTO_SHARP;\n\trequest->scancode = addr << 8 | cmd;\n\treturn IMG_IR_SCANCODE;\n}\n\n \nstatic int img_ir_sharp_filter(const struct rc_scancode_filter *in,\n\t\t\t       struct img_ir_filter *out, u64 protocols)\n{\n\tunsigned int addr, cmd, exp = 0, chk = 0;\n\tunsigned int addr_m, cmd_m, exp_m = 0, chk_m = 0;\n\n\taddr   = (in->data >> 8) & 0x1f;\n\taddr_m = (in->mask >> 8) & 0x1f;\n\tcmd    = (in->data >> 0) & 0xff;\n\tcmd_m  = (in->mask >> 0) & 0xff;\n\tif (cmd_m) {\n\t\t \n\t\texp   = 1;\n\t\texp_m = 1;\n\t\tchk   = 0;\n\t\tchk_m = 1;\n\t}\n\n\tout->data = addr        |\n\t\t    cmd   <<  5 |\n\t\t    exp   << 13 |\n\t\t    chk   << 14;\n\tout->mask = addr_m      |\n\t\t    cmd_m <<  5 |\n\t\t    exp_m << 13 |\n\t\t    chk_m << 14;\n\n\treturn 0;\n}\n\n \nstruct img_ir_decoder img_ir_sharp = {\n\t.type = RC_PROTO_BIT_SHARP,\n\t.control = {\n\t\t.decoden = 0,\n\t\t.decodend2 = 1,\n\t\t.code_type = IMG_IR_CODETYPE_PULSEDIST,\n\t\t.d1validsel = 1,\n\t},\n\t \n\t.tolerance = 20,\t \n\t.timings = {\n\t\t \n\t\t.s10 = {\n\t\t\t.pulse = { 320\t  },\n\t\t\t.space = { 680\t  },\n\t\t},\n\t\t \n\t\t.s11 = {\n\t\t\t.pulse = { 320\t  },\n\t\t\t.space = { 1680\t  },\n\t\t},\n\t\t \n\t\t.ft = {\n\t\t\t.minlen = 15,\n\t\t\t.maxlen = 15,\n\t\t\t.ft_min = 5000,\t \n\t\t},\n\t},\n\t \n\t.scancode = img_ir_sharp_scancode,\n\t.filter = img_ir_sharp_filter,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}