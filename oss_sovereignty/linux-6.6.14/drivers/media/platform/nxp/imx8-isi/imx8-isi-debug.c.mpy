{
  "module_name": "imx8-isi-debug.c",
  "hash_id": "b1aee48556fff3c4a3295ae6da17c7ca98319c1af94594ea228275a08ce46a0d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/nxp/imx8-isi/imx8-isi-debug.c",
  "human_readable_source": "\n \n\n#include <linux/debugfs.h>\n#include <linux/device.h>\n#include <linux/io.h>\n#include <linux/kernel.h>\n#include <linux/pm_runtime.h>\n#include <linux/seq_file.h>\n#include <linux/types.h>\n\n#include \"imx8-isi-core.h\"\n#include \"imx8-isi-regs.h\"\n\nstatic inline u32 mxc_isi_read(struct mxc_isi_pipe *pipe, u32 reg)\n{\n\treturn readl(pipe->regs + reg);\n}\n\nstatic int mxc_isi_debug_dump_regs_show(struct seq_file *m, void *p)\n{\n#define MXC_ISI_DEBUG_REG(name)\t\t{ name, #name }\n\tstatic const struct {\n\t\tu32 offset;\n\t\tconst char * const name;\n\t} registers[] = {\n\t\tMXC_ISI_DEBUG_REG(CHNL_CTRL),\n\t\tMXC_ISI_DEBUG_REG(CHNL_IMG_CTRL),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF_CTRL),\n\t\tMXC_ISI_DEBUG_REG(CHNL_IMG_CFG),\n\t\tMXC_ISI_DEBUG_REG(CHNL_IER),\n\t\tMXC_ISI_DEBUG_REG(CHNL_STS),\n\t\tMXC_ISI_DEBUG_REG(CHNL_SCALE_FACTOR),\n\t\tMXC_ISI_DEBUG_REG(CHNL_SCALE_OFFSET),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CROP_ULC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CROP_LRC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF0),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF1),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF2),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF3),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF4),\n\t\tMXC_ISI_DEBUG_REG(CHNL_CSC_COEFF5),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_0_ALPHA),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_0_ULC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_0_LRC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_1_ALPHA),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_1_ULC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_1_LRC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_2_ALPHA),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_2_ULC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_2_LRC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_3_ALPHA),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_3_ULC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_ROI_3_LRC),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF1_ADDR_Y),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF1_ADDR_U),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF1_ADDR_V),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF_PITCH),\n\t\tMXC_ISI_DEBUG_REG(CHNL_IN_BUF_ADDR),\n\t\tMXC_ISI_DEBUG_REG(CHNL_IN_BUF_PITCH),\n\t\tMXC_ISI_DEBUG_REG(CHNL_MEM_RD_CTRL),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF2_ADDR_Y),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF2_ADDR_U),\n\t\tMXC_ISI_DEBUG_REG(CHNL_OUT_BUF2_ADDR_V),\n\t\tMXC_ISI_DEBUG_REG(CHNL_SCL_IMG_CFG),\n\t\tMXC_ISI_DEBUG_REG(CHNL_FLOW_CTRL),\n\t};\n\n\tstruct mxc_isi_pipe *pipe = m->private;\n\tunsigned int i;\n\n\tif (!pm_runtime_get_if_in_use(pipe->isi->dev))\n\t\treturn 0;\n\n\tseq_printf(m, \"--- ISI pipe %u registers ---\\n\", pipe->id);\n\n\tfor (i = 0; i < ARRAY_SIZE(registers); ++i)\n\t\tseq_printf(m, \"%20s[0x%02x]: 0x%08x\\n\",\n\t\t\t   registers[i].name, registers[i].offset,\n\t\t\t   mxc_isi_read(pipe, registers[i].offset));\n\n\tpm_runtime_put(pipe->isi->dev);\n\n\treturn 0;\n}\nDEFINE_SHOW_ATTRIBUTE(mxc_isi_debug_dump_regs);\n\nvoid mxc_isi_debug_init(struct mxc_isi_dev *isi)\n{\n\tunsigned int i;\n\n\tisi->debugfs_root = debugfs_create_dir(dev_name(isi->dev), NULL);\n\n\tfor (i = 0; i < isi->pdata->num_channels; ++i) {\n\t\tstruct mxc_isi_pipe *pipe = &isi->pipes[i];\n\t\tchar name[8];\n\n\t\tsprintf(name, \"pipe%u\", pipe->id);\n\t\tdebugfs_create_file(name, 0444, isi->debugfs_root, pipe,\n\t\t\t\t    &mxc_isi_debug_dump_regs_fops);\n\t}\n}\n\nvoid mxc_isi_debug_cleanup(struct mxc_isi_dev *isi)\n{\n\tdebugfs_remove_recursive(isi->debugfs_root);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}