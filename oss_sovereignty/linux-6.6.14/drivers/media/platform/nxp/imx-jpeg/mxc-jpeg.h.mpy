{
  "module_name": "mxc-jpeg.h",
  "hash_id": "5e1fb9c592c6401b0aad0b936a64614b558a93f1155275a398232f4d8ec95dd1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/nxp/imx-jpeg/mxc-jpeg.h",
  "human_readable_source": " \n \n\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-fh.h>\n\n#ifndef _MXC_JPEG_CORE_H\n#define _MXC_JPEG_CORE_H\n\n#define MXC_JPEG_NAME\t\t\t\"mxc-jpeg\"\n#define MXC_JPEG_FMT_TYPE_ENC\t\t0\n#define MXC_JPEG_FMT_TYPE_RAW\t\t1\n#define MXC_JPEG_DEFAULT_WIDTH\t\t1280\n#define MXC_JPEG_DEFAULT_HEIGHT\t\t720\n#define MXC_JPEG_DEFAULT_PFMT\t\tV4L2_PIX_FMT_BGR24\n#define MXC_JPEG_MIN_WIDTH\t\t64\n#define MXC_JPEG_MIN_HEIGHT\t\t64\n#define MXC_JPEG_MAX_WIDTH\t\t0x2000\n#define MXC_JPEG_MAX_HEIGHT\t\t0x2000\n#define MXC_JPEG_MAX_CFG_STREAM\t\t0x1000\n#define MXC_JPEG_H_ALIGN\t\t3\n#define MXC_JPEG_W_ALIGN\t\t3\n#define MXC_JPEG_MAX_SIZEIMAGE\t\t0xFFFFFC00\n#define MXC_JPEG_MAX_PLANES\t\t2\n\nenum mxc_jpeg_enc_state {\n\tMXC_JPEG_ENCODING\t= 0,  \n\tMXC_JPEG_ENC_CONF\t= 1,  \n};\n\nenum mxc_jpeg_mode {\n\tMXC_JPEG_DECODE\t= 0,  \n\tMXC_JPEG_ENCODE\t= 1,  \n};\n\n \nstruct mxc_jpeg_fmt {\n\tconst char\t\t\t\t*name;\n\tu32\t\t\t\t\tfourcc;\n\tenum v4l2_jpeg_chroma_subsampling\tsubsampling;\n\tint\t\t\t\t\tnc;\n\tint\t\t\t\t\tdepth;\n\tint\t\t\t\t\tmem_planes;\n\tint\t\t\t\t\tcomp_planes;\n\tint\t\t\t\t\th_align;\n\tint\t\t\t\t\tv_align;\n\tu32\t\t\t\t\tflags;\n\tu8\t\t\t\t\tprecision;\n\tu8\t\t\t\t\tis_rgb;\n};\n\nstruct mxc_jpeg_desc {\n\tu32 next_descpt_ptr;\n\tu32 buf_base0;\n\tu32 buf_base1;\n\tu32 line_pitch;\n\tu32 stm_bufbase;\n\tu32 stm_bufsize;\n\tu32 imgsize;\n\tu32 stm_ctrl;\n} __packed;\n\nstruct mxc_jpeg_q_data {\n\tconst struct mxc_jpeg_fmt\t*fmt;\n\tu32\t\t\t\tsizeimage[MXC_JPEG_MAX_PLANES];\n\tu32\t\t\t\tbytesperline[MXC_JPEG_MAX_PLANES];\n\tint\t\t\t\tw;\n\tint\t\t\t\tw_adjusted;\n\tint\t\t\t\th;\n\tint\t\t\t\th_adjusted;\n\tunsigned int\t\t\tsequence;\n\tstruct v4l2_rect\t\tcrop;\n};\n\nstruct mxc_jpeg_ctx {\n\tstruct mxc_jpeg_dev\t\t*mxc_jpeg;\n\tstruct mxc_jpeg_q_data\t\tout_q;\n\tstruct mxc_jpeg_q_data\t\tcap_q;\n\tstruct v4l2_fh\t\t\tfh;\n\tenum mxc_jpeg_enc_state\t\tenc_state;\n\tint\t\t\t\tslot;\n\tunsigned int\t\t\tsource_change;\n\tbool\t\t\t\tneed_initial_source_change_evt;\n\tbool\t\t\t\theader_parsed;\n\tstruct v4l2_ctrl_handler\tctrl_handler;\n\tu8\t\t\t\tjpeg_quality;\n\tstruct delayed_work\t\ttask_timer;\n};\n\nstruct mxc_jpeg_slot_data {\n\tint slot;\n\tbool used;\n\tstruct mxc_jpeg_desc *desc; \n\tstruct mxc_jpeg_desc *cfg_desc; \n\tvoid *cfg_stream_vaddr; \n\tunsigned int cfg_stream_size;\n\tdma_addr_t desc_handle;\n\tdma_addr_t cfg_desc_handle; \n\tdma_addr_t cfg_stream_handle; \n};\n\nstruct mxc_jpeg_dev {\n\tspinlock_t\t\t\thw_lock;  \n\tunsigned int\t\t\tmode;\n\tstruct mutex\t\t\tlock;  \n\tstruct clk_bulk_data\t\t*clks;\n\tint\t\t\t\tnum_clks;\n\tstruct platform_device\t\t*pdev;\n\tstruct device\t\t\t*dev;\n\tvoid __iomem\t\t\t*base_reg;\n\tstruct v4l2_device\t\tv4l2_dev;\n\tstruct v4l2_m2m_dev\t\t*m2m_dev;\n\tstruct video_device\t\t*dec_vdev;\n\tstruct mxc_jpeg_slot_data\tslot_data;\n\tint\t\t\t\tnum_domains;\n\tstruct device\t\t\t**pd_dev;\n\tstruct device_link\t\t**pd_link;\n};\n\n \nstruct mxc_jpeg_sof_comp {\n\tu8 id;\n\tu8 v :4;\n\tu8 h :4;\n\tu8 quantization_table_no;\n} __packed;\n\n#define MXC_JPEG_MAX_COMPONENTS 4\n \nstruct mxc_jpeg_sof {\n\tu16 length;\n\tu8 precision;\n\tu16 height, width;\n\tu8 components_no;\n\tstruct mxc_jpeg_sof_comp comp[MXC_JPEG_MAX_COMPONENTS];\n} __packed;\n\n \nstruct mxc_jpeg_sos_comp {\n\tu8 id;  \n\tu8 huffman_table_no;\n} __packed;\n\n \nstruct mxc_jpeg_sos {\n\tu16 length;\n\tu8 components_no;\n\tstruct mxc_jpeg_sos_comp comp[MXC_JPEG_MAX_COMPONENTS];\n\tu8 ignorable_bytes[3];\n} __packed;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}