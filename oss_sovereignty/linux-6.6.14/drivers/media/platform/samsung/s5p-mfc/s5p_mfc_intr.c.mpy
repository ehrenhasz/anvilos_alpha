{
  "module_name": "s5p_mfc_intr.c",
  "hash_id": "5228b9d26343c1511e7fdf7ce3d4a411d9445244377bdb501891c8de0e7555c5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/samsung/s5p-mfc/s5p_mfc_intr.c",
  "human_readable_source": "\n \n\n#include <linux/delay.h>\n#include <linux/errno.h>\n#include <linux/io.h>\n#include <linux/sched.h>\n#include <linux/wait.h>\n#include \"s5p_mfc_common.h\"\n#include \"s5p_mfc_debug.h\"\n#include \"s5p_mfc_intr.h\"\n\nint s5p_mfc_wait_for_done_dev(struct s5p_mfc_dev *dev, int command)\n{\n\tint ret;\n\n\tret = wait_event_interruptible_timeout(dev->queue,\n\t\t(dev->int_cond && (dev->int_type == command\n\t\t|| dev->int_type == S5P_MFC_R2H_CMD_ERR_RET)),\n\t\tmsecs_to_jiffies(MFC_INT_TIMEOUT));\n\tif (ret == 0) {\n\t\tmfc_err(\"Interrupt (dev->int_type:%d, command:%d) timed out\\n\",\n\t\t\t\t\t\t\tdev->int_type, command);\n\t\treturn 1;\n\t} else if (ret == -ERESTARTSYS) {\n\t\tmfc_err(\"Interrupted by a signal\\n\");\n\t\treturn 1;\n\t}\n\tmfc_debug(1, \"Finished waiting (dev->int_type:%d, command: %d)\\n\",\n\t\t\t\t\t\t\tdev->int_type, command);\n\tif (dev->int_type == S5P_MFC_R2H_CMD_ERR_RET)\n\t\treturn 1;\n\treturn 0;\n}\n\nvoid s5p_mfc_clean_dev_int_flags(struct s5p_mfc_dev *dev)\n{\n\tdev->int_cond = 0;\n\tdev->int_type = 0;\n\tdev->int_err = 0;\n}\n\nint s5p_mfc_wait_for_done_ctx(struct s5p_mfc_ctx *ctx,\n\t\t\t\t    int command, int interrupt)\n{\n\tint ret;\n\n\tif (interrupt) {\n\t\tret = wait_event_interruptible_timeout(ctx->queue,\n\t\t\t\t(ctx->int_cond && (ctx->int_type == command\n\t\t\t|| ctx->int_type == S5P_MFC_R2H_CMD_ERR_RET)),\n\t\t\t\t\tmsecs_to_jiffies(MFC_INT_TIMEOUT));\n\t} else {\n\t\tret = wait_event_timeout(ctx->queue,\n\t\t\t\t(ctx->int_cond && (ctx->int_type == command\n\t\t\t|| ctx->int_type == S5P_MFC_R2H_CMD_ERR_RET)),\n\t\t\t\t\tmsecs_to_jiffies(MFC_INT_TIMEOUT));\n\t}\n\tif (ret == 0) {\n\t\tmfc_err(\"Interrupt (ctx->int_type:%d, command:%d) timed out\\n\",\n\t\t\t\t\t\t\tctx->int_type, command);\n\t\treturn 1;\n\t} else if (ret == -ERESTARTSYS) {\n\t\tmfc_err(\"Interrupted by a signal\\n\");\n\t\treturn 1;\n\t}\n\tmfc_debug(1, \"Finished waiting (ctx->int_type:%d, command: %d)\\n\",\n\t\t\t\t\t\t\tctx->int_type, command);\n\tif (ctx->int_type == S5P_MFC_R2H_CMD_ERR_RET)\n\t\treturn 1;\n\treturn 0;\n}\n\nvoid s5p_mfc_clean_ctx_int_flags(struct s5p_mfc_ctx *ctx)\n{\n\tctx->int_cond = 0;\n\tctx->int_type = 0;\n\tctx->int_err = 0;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}