{
  "module_name": "g2d-hw.c",
  "hash_id": "556c8467e2e554c89b420607a39a396255c6a433db80def40fc70cf26064c335",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/samsung/s5p-g2d/g2d-hw.c",
  "human_readable_source": "\n \n\n#include <linux/io.h>\n\n#include \"g2d.h\"\n#include \"g2d-regs.h\"\n\n#define w(x, a)\twritel((x), d->regs + (a))\n#define r(a)\treadl(d->regs + (a))\n\n \nvoid g2d_reset(struct g2d_dev *d)\n{\n\tw(1, SOFT_RESET_REG);\n}\n\nvoid g2d_set_src_size(struct g2d_dev *d, struct g2d_frame *f)\n{\n\tu32 n;\n\n\tw(0, SRC_SELECT_REG);\n\tw(f->stride & 0xFFFF, SRC_STRIDE_REG);\n\n\tn = f->o_height & 0xFFF;\n\tn <<= 16;\n\tn |= f->o_width & 0xFFF;\n\tw(n, SRC_LEFT_TOP_REG);\n\n\tn = f->bottom & 0xFFF;\n\tn <<= 16;\n\tn |= f->right & 0xFFF;\n\tw(n, SRC_RIGHT_BOTTOM_REG);\n\n\tw(f->fmt->hw, SRC_COLOR_MODE_REG);\n}\n\nvoid g2d_set_src_addr(struct g2d_dev *d, dma_addr_t a)\n{\n\tw(a, SRC_BASE_ADDR_REG);\n}\n\nvoid g2d_set_dst_size(struct g2d_dev *d, struct g2d_frame *f)\n{\n\tu32 n;\n\n\tw(0, DST_SELECT_REG);\n\tw(f->stride & 0xFFFF, DST_STRIDE_REG);\n\n\tn = f->o_height & 0xFFF;\n\tn <<= 16;\n\tn |= f->o_width & 0xFFF;\n\tw(n, DST_LEFT_TOP_REG);\n\n\tn = f->bottom & 0xFFF;\n\tn <<= 16;\n\tn |= f->right & 0xFFF;\n\tw(n, DST_RIGHT_BOTTOM_REG);\n\n\tw(f->fmt->hw, DST_COLOR_MODE_REG);\n}\n\nvoid g2d_set_dst_addr(struct g2d_dev *d, dma_addr_t a)\n{\n\tw(a, DST_BASE_ADDR_REG);\n}\n\nvoid g2d_set_rop4(struct g2d_dev *d, u32 r)\n{\n\tw(r, ROP4_REG);\n}\n\nvoid g2d_set_flip(struct g2d_dev *d, u32 r)\n{\n\tw(r, SRC_MSK_DIRECT_REG);\n}\n\nvoid g2d_set_v41_stretch(struct g2d_dev *d, struct g2d_frame *src,\n\t\t\t\t\tstruct g2d_frame *dst)\n{\n\tw(DEFAULT_SCALE_MODE, SRC_SCALE_CTRL_REG);\n\n\t \n\tw((src->c_width << 16) / dst->c_width, SRC_XSCALE_REG);\n\tw((src->c_height << 16) / dst->c_height, SRC_YSCALE_REG);\n}\n\nvoid g2d_set_cmd(struct g2d_dev *d, u32 c)\n{\n\tw(c, BITBLT_COMMAND_REG);\n}\n\nvoid g2d_start(struct g2d_dev *d)\n{\n\t \n\tif (d->variant->hw_rev == TYPE_G2D_3X)\n\t\tw(0x7, CACHECTL_REG);\n\n\t \n\tw(1, INTEN_REG);\n\t \n\tw(1, BITBLT_START_REG);\n}\n\nvoid g2d_clear_int(struct g2d_dev *d)\n{\n\tw(1, INTC_PEND_REG);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}