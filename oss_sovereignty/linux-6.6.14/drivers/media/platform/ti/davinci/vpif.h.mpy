{
  "module_name": "vpif.h",
  "hash_id": "a82f1cdd33a8be4e547125460db7fada18da90cc150d4945aeafd4a2d15260fa",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/ti/davinci/vpif.h",
  "human_readable_source": " \n \n\n#ifndef VPIF_H\n#define VPIF_H\n\n#include <linux/io.h>\n#include <linux/videodev2.h>\n#include <media/davinci/vpif_types.h>\n\n \n#define VPIF_NUM_CHANNELS\t\t(4)\n#define VPIF_CAPTURE_NUM_CHANNELS\t(2)\n#define VPIF_DISPLAY_NUM_CHANNELS\t(2)\n\n \nextern void __iomem *vpif_base;\nextern spinlock_t vpif_lock;\n\n#define regr(reg)               readl((reg) + vpif_base)\n#define regw(value, reg)        writel(value, (reg + vpif_base))\n\n \n#define VPIF_PID\t\t\t(0x0000)\n#define VPIF_CH0_CTRL\t\t\t(0x0004)\n#define VPIF_CH1_CTRL\t\t\t(0x0008)\n#define VPIF_CH2_CTRL\t\t\t(0x000C)\n#define VPIF_CH3_CTRL\t\t\t(0x0010)\n\n#define VPIF_INTEN\t\t\t(0x0020)\n#define VPIF_INTEN_SET\t\t\t(0x0024)\n#define VPIF_INTEN_CLR\t\t\t(0x0028)\n#define VPIF_STATUS\t\t\t(0x002C)\n#define VPIF_STATUS_CLR\t\t\t(0x0030)\n#define VPIF_EMULATION_CTRL\t\t(0x0034)\n#define VPIF_REQ_SIZE\t\t\t(0x0038)\n\n#define VPIF_CH0_TOP_STRT_ADD_LUMA\t(0x0040)\n#define VPIF_CH0_BTM_STRT_ADD_LUMA\t(0x0044)\n#define VPIF_CH0_TOP_STRT_ADD_CHROMA\t(0x0048)\n#define VPIF_CH0_BTM_STRT_ADD_CHROMA\t(0x004c)\n#define VPIF_CH0_TOP_STRT_ADD_HANC\t(0x0050)\n#define VPIF_CH0_BTM_STRT_ADD_HANC\t(0x0054)\n#define VPIF_CH0_TOP_STRT_ADD_VANC\t(0x0058)\n#define VPIF_CH0_BTM_STRT_ADD_VANC\t(0x005c)\n#define VPIF_CH0_SP_CFG\t\t\t(0x0060)\n#define VPIF_CH0_IMG_ADD_OFST\t\t(0x0064)\n#define VPIF_CH0_HANC_ADD_OFST\t\t(0x0068)\n#define VPIF_CH0_H_CFG\t\t\t(0x006c)\n#define VPIF_CH0_V_CFG_00\t\t(0x0070)\n#define VPIF_CH0_V_CFG_01\t\t(0x0074)\n#define VPIF_CH0_V_CFG_02\t\t(0x0078)\n#define VPIF_CH0_V_CFG_03\t\t(0x007c)\n\n#define VPIF_CH1_TOP_STRT_ADD_LUMA\t(0x0080)\n#define VPIF_CH1_BTM_STRT_ADD_LUMA\t(0x0084)\n#define VPIF_CH1_TOP_STRT_ADD_CHROMA\t(0x0088)\n#define VPIF_CH1_BTM_STRT_ADD_CHROMA\t(0x008c)\n#define VPIF_CH1_TOP_STRT_ADD_HANC\t(0x0090)\n#define VPIF_CH1_BTM_STRT_ADD_HANC\t(0x0094)\n#define VPIF_CH1_TOP_STRT_ADD_VANC\t(0x0098)\n#define VPIF_CH1_BTM_STRT_ADD_VANC\t(0x009c)\n#define VPIF_CH1_SP_CFG\t\t\t(0x00a0)\n#define VPIF_CH1_IMG_ADD_OFST\t\t(0x00a4)\n#define VPIF_CH1_HANC_ADD_OFST\t\t(0x00a8)\n#define VPIF_CH1_H_CFG\t\t\t(0x00ac)\n#define VPIF_CH1_V_CFG_00\t\t(0x00b0)\n#define VPIF_CH1_V_CFG_01\t\t(0x00b4)\n#define VPIF_CH1_V_CFG_02\t\t(0x00b8)\n#define VPIF_CH1_V_CFG_03\t\t(0x00bc)\n\n#define VPIF_CH2_TOP_STRT_ADD_LUMA\t(0x00c0)\n#define VPIF_CH2_BTM_STRT_ADD_LUMA\t(0x00c4)\n#define VPIF_CH2_TOP_STRT_ADD_CHROMA\t(0x00c8)\n#define VPIF_CH2_BTM_STRT_ADD_CHROMA\t(0x00cc)\n#define VPIF_CH2_TOP_STRT_ADD_HANC\t(0x00d0)\n#define VPIF_CH2_BTM_STRT_ADD_HANC\t(0x00d4)\n#define VPIF_CH2_TOP_STRT_ADD_VANC\t(0x00d8)\n#define VPIF_CH2_BTM_STRT_ADD_VANC\t(0x00dc)\n#define VPIF_CH2_SP_CFG\t\t\t(0x00e0)\n#define VPIF_CH2_IMG_ADD_OFST\t\t(0x00e4)\n#define VPIF_CH2_HANC_ADD_OFST\t\t(0x00e8)\n#define VPIF_CH2_H_CFG\t\t\t(0x00ec)\n#define VPIF_CH2_V_CFG_00\t\t(0x00f0)\n#define VPIF_CH2_V_CFG_01\t\t(0x00f4)\n#define VPIF_CH2_V_CFG_02\t\t(0x00f8)\n#define VPIF_CH2_V_CFG_03\t\t(0x00fc)\n#define VPIF_CH2_HANC0_STRT\t\t(0x0100)\n#define VPIF_CH2_HANC0_SIZE\t\t(0x0104)\n#define VPIF_CH2_HANC1_STRT\t\t(0x0108)\n#define VPIF_CH2_HANC1_SIZE\t\t(0x010c)\n#define VPIF_CH2_VANC0_STRT\t\t(0x0110)\n#define VPIF_CH2_VANC0_SIZE\t\t(0x0114)\n#define VPIF_CH2_VANC1_STRT\t\t(0x0118)\n#define VPIF_CH2_VANC1_SIZE\t\t(0x011c)\n\n#define VPIF_CH3_TOP_STRT_ADD_LUMA\t(0x0140)\n#define VPIF_CH3_BTM_STRT_ADD_LUMA\t(0x0144)\n#define VPIF_CH3_TOP_STRT_ADD_CHROMA\t(0x0148)\n#define VPIF_CH3_BTM_STRT_ADD_CHROMA\t(0x014c)\n#define VPIF_CH3_TOP_STRT_ADD_HANC\t(0x0150)\n#define VPIF_CH3_BTM_STRT_ADD_HANC\t(0x0154)\n#define VPIF_CH3_TOP_STRT_ADD_VANC\t(0x0158)\n#define VPIF_CH3_BTM_STRT_ADD_VANC\t(0x015c)\n#define VPIF_CH3_SP_CFG\t\t\t(0x0160)\n#define VPIF_CH3_IMG_ADD_OFST\t\t(0x0164)\n#define VPIF_CH3_HANC_ADD_OFST\t\t(0x0168)\n#define VPIF_CH3_H_CFG\t\t\t(0x016c)\n#define VPIF_CH3_V_CFG_00\t\t(0x0170)\n#define VPIF_CH3_V_CFG_01\t\t(0x0174)\n#define VPIF_CH3_V_CFG_02\t\t(0x0178)\n#define VPIF_CH3_V_CFG_03\t\t(0x017c)\n#define VPIF_CH3_HANC0_STRT\t\t(0x0180)\n#define VPIF_CH3_HANC0_SIZE\t\t(0x0184)\n#define VPIF_CH3_HANC1_STRT\t\t(0x0188)\n#define VPIF_CH3_HANC1_SIZE\t\t(0x018c)\n#define VPIF_CH3_VANC0_STRT\t\t(0x0190)\n#define VPIF_CH3_VANC0_SIZE\t\t(0x0194)\n#define VPIF_CH3_VANC1_STRT\t\t(0x0198)\n#define VPIF_CH3_VANC1_SIZE\t\t(0x019c)\n\n#define VPIF_IODFT_CTRL\t\t\t(0x01c0)\n\n \nstatic inline void vpif_set_bit(u32 reg, u32 bit)\n{\n\tregw((regr(reg)) | (0x01 << bit), reg);\n}\n\nstatic inline void vpif_clr_bit(u32 reg, u32 bit)\n{\n\tregw(((regr(reg)) & ~(0x01 << bit)), reg);\n}\n\n \n#ifdef GENERATE_MASK\n#undef GENERATE_MASK\n#endif\n\n#define GENERATE_MASK(bits, pos) \\\n\t\t((((0xFFFFFFFF) << (32 - bits)) >> (32 - bits)) << pos)\n\n \n#define VPIF_CH_DATA_MODE_BIT\t(2)\n#define VPIF_CH_YC_MUX_BIT\t(3)\n#define VPIF_CH_SDR_FMT_BIT\t(4)\n#define VPIF_CH_HANC_EN_BIT\t(8)\n#define VPIF_CH_VANC_EN_BIT\t(9)\n\n#define VPIF_CAPTURE_CH_NIP\t(10)\n#define VPIF_DISPLAY_CH_NIP\t(11)\n\n#define VPIF_DISPLAY_PIX_EN_BIT\t(10)\n\n#define VPIF_CH_INPUT_FIELD_FRAME_BIT\t(12)\n\n#define VPIF_CH_FID_POLARITY_BIT\t(15)\n#define VPIF_CH_V_VALID_POLARITY_BIT\t(14)\n#define VPIF_CH_H_VALID_POLARITY_BIT\t(13)\n#define VPIF_CH_DATA_WIDTH_BIT\t\t(28)\n\n#define VPIF_CH_CLK_EDGE_CTRL_BIT\t(31)\n\n \n#define VPIF_CH_EAVSAV_MASK\tGENERATE_MASK(13, 0)\n#define VPIF_CH_LEN_MASK\tGENERATE_MASK(12, 0)\n#define VPIF_CH_WIDTH_MASK\tGENERATE_MASK(13, 0)\n#define VPIF_CH_LEN_SHIFT\t(16)\n\n \n#define VPIF_REQ_SIZE_MASK\t(0x1ff)\n\n \n#define VPIF_INTEN_FRAME_CH0\t(0x00000001)\n#define VPIF_INTEN_FRAME_CH1\t(0x00000002)\n#define VPIF_INTEN_FRAME_CH2\t(0x00000004)\n#define VPIF_INTEN_FRAME_CH3\t(0x00000008)\n\n \n\n#define VPIF_CH0_CLK_EN\t\t(0x00000002)\n#define VPIF_CH0_EN\t\t(0x00000001)\n#define VPIF_CH1_CLK_EN\t\t(0x00000002)\n#define VPIF_CH1_EN\t\t(0x00000001)\n#define VPIF_CH2_CLK_EN\t\t(0x00000002)\n#define VPIF_CH2_EN\t\t(0x00000001)\n#define VPIF_CH3_CLK_EN\t\t(0x00000002)\n#define VPIF_CH3_EN\t\t(0x00000001)\n#define VPIF_CH_CLK_EN\t\t(0x00000002)\n#define VPIF_CH_EN\t\t(0x00000001)\n\n#define VPIF_INT_TOP\t(0x00)\n#define VPIF_INT_BOTTOM\t(0x01)\n#define VPIF_INT_BOTH\t(0x02)\n\n#define VPIF_CH0_INT_CTRL_SHIFT\t(6)\n#define VPIF_CH1_INT_CTRL_SHIFT\t(6)\n#define VPIF_CH2_INT_CTRL_SHIFT\t(6)\n#define VPIF_CH3_INT_CTRL_SHIFT\t(6)\n#define VPIF_CH_INT_CTRL_SHIFT\t(6)\n\n#define VPIF_CH2_CLIP_ANC_EN\t14\n#define VPIF_CH2_CLIP_ACTIVE_EN\t13\n\n#define VPIF_CH3_CLIP_ANC_EN\t14\n#define VPIF_CH3_CLIP_ACTIVE_EN\t13\n\n \n#define channel0_intr_assert()\t(regw((regr(VPIF_CH0_CTRL)|\\\n\t(VPIF_INT_BOTH << VPIF_CH0_INT_CTRL_SHIFT)), VPIF_CH0_CTRL))\n\n \n#define channel1_intr_assert()\t(regw((regr(VPIF_CH1_CTRL)|\\\n\t(VPIF_INT_BOTH << VPIF_CH1_INT_CTRL_SHIFT)), VPIF_CH1_CTRL))\n\n \n#define channel2_intr_assert()\t(regw((regr(VPIF_CH2_CTRL)|\\\n\t(VPIF_INT_BOTH << VPIF_CH2_INT_CTRL_SHIFT)), VPIF_CH2_CTRL))\n\n \n#define channel3_intr_assert()\t(regw((regr(VPIF_CH3_CTRL)|\\\n\t(VPIF_INT_BOTH << VPIF_CH3_INT_CTRL_SHIFT)), VPIF_CH3_CTRL))\n\n#define VPIF_CH_FID_MASK\t(0x20)\n#define VPIF_CH_FID_SHIFT\t(5)\n\n#define VPIF_NTSC_VBI_START_FIELD0\t(1)\n#define VPIF_NTSC_VBI_START_FIELD1\t(263)\n#define VPIF_PAL_VBI_START_FIELD0\t(624)\n#define VPIF_PAL_VBI_START_FIELD1\t(311)\n\n#define VPIF_NTSC_HBI_START_FIELD0\t(1)\n#define VPIF_NTSC_HBI_START_FIELD1\t(263)\n#define VPIF_PAL_HBI_START_FIELD0\t(624)\n#define VPIF_PAL_HBI_START_FIELD1\t(311)\n\n#define VPIF_NTSC_VBI_COUNT_FIELD0\t(20)\n#define VPIF_NTSC_VBI_COUNT_FIELD1\t(19)\n#define VPIF_PAL_VBI_COUNT_FIELD0\t(24)\n#define VPIF_PAL_VBI_COUNT_FIELD1\t(25)\n\n#define VPIF_NTSC_HBI_COUNT_FIELD0\t(263)\n#define VPIF_NTSC_HBI_COUNT_FIELD1\t(262)\n#define VPIF_PAL_HBI_COUNT_FIELD0\t(312)\n#define VPIF_PAL_HBI_COUNT_FIELD1\t(313)\n\n#define VPIF_NTSC_VBI_SAMPLES_PER_LINE\t(720)\n#define VPIF_PAL_VBI_SAMPLES_PER_LINE\t(720)\n#define VPIF_NTSC_HBI_SAMPLES_PER_LINE\t(268)\n#define VPIF_PAL_HBI_SAMPLES_PER_LINE\t(280)\n\n#define VPIF_CH_VANC_EN\t\t\t(0x20)\n#define VPIF_DMA_REQ_SIZE\t\t(0x080)\n#define VPIF_EMULATION_DISABLE\t\t(0x01)\n\nextern u8 irq_vpif_capture_channel[VPIF_NUM_CHANNELS];\n\n \nstatic inline void enable_channel0(int enable)\n{\n\tif (enable)\n\t\tregw((regr(VPIF_CH0_CTRL) | (VPIF_CH0_EN)), VPIF_CH0_CTRL);\n\telse\n\t\tregw((regr(VPIF_CH0_CTRL) & (~VPIF_CH0_EN)), VPIF_CH0_CTRL);\n}\n\n \nstatic inline void enable_channel1(int enable)\n{\n\tif (enable)\n\t\tregw((regr(VPIF_CH1_CTRL) | (VPIF_CH1_EN)), VPIF_CH1_CTRL);\n\telse\n\t\tregw((regr(VPIF_CH1_CTRL) & (~VPIF_CH1_EN)), VPIF_CH1_CTRL);\n}\n\n \nstatic inline void channel0_intr_enable(int enable)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&vpif_lock, flags);\n\n\tif (enable) {\n\t\tregw((regr(VPIF_INTEN) | 0x10), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | 0x10), VPIF_INTEN_SET);\n\n\t\tregw((regr(VPIF_INTEN) | VPIF_INTEN_FRAME_CH0), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH0),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t} else {\n\t\tregw((regr(VPIF_INTEN) & (~VPIF_INTEN_FRAME_CH0)), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH0),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t}\n\tspin_unlock_irqrestore(&vpif_lock, flags);\n}\n\n \nstatic inline void channel1_intr_enable(int enable)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&vpif_lock, flags);\n\n\tif (enable) {\n\t\tregw((regr(VPIF_INTEN) | 0x10), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | 0x10), VPIF_INTEN_SET);\n\n\t\tregw((regr(VPIF_INTEN) | VPIF_INTEN_FRAME_CH1), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH1),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t} else {\n\t\tregw((regr(VPIF_INTEN) & (~VPIF_INTEN_FRAME_CH1)), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH1),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t}\n\tspin_unlock_irqrestore(&vpif_lock, flags);\n}\n\n \nstatic inline void ch0_set_video_buf_addr_yc_nmux(unsigned long top_strt_luma,\n\t\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH0_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH0_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH1_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH1_BTM_STRT_ADD_CHROMA);\n}\n\n \nstatic inline void ch0_set_video_buf_addr(unsigned long top_strt_luma,\n\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH0_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH0_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH0_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH0_BTM_STRT_ADD_CHROMA);\n}\n\nstatic inline void ch1_set_video_buf_addr(unsigned long top_strt_luma,\n\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\n\tregw(top_strt_luma, VPIF_CH1_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH1_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH1_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH1_BTM_STRT_ADD_CHROMA);\n}\n\nstatic inline void ch0_set_vbi_addr(unsigned long top_vbi,\n\tunsigned long btm_vbi, unsigned long a, unsigned long b)\n{\n\tregw(top_vbi, VPIF_CH0_TOP_STRT_ADD_VANC);\n\tregw(btm_vbi, VPIF_CH0_BTM_STRT_ADD_VANC);\n}\n\nstatic inline void ch0_set_hbi_addr(unsigned long top_vbi,\n\tunsigned long btm_vbi, unsigned long a, unsigned long b)\n{\n\tregw(top_vbi, VPIF_CH0_TOP_STRT_ADD_HANC);\n\tregw(btm_vbi, VPIF_CH0_BTM_STRT_ADD_HANC);\n}\n\nstatic inline void ch1_set_vbi_addr(unsigned long top_vbi,\n\tunsigned long btm_vbi, unsigned long a, unsigned long b)\n{\n\tregw(top_vbi, VPIF_CH1_TOP_STRT_ADD_VANC);\n\tregw(btm_vbi, VPIF_CH1_BTM_STRT_ADD_VANC);\n}\n\nstatic inline void ch1_set_hbi_addr(unsigned long top_vbi,\n\tunsigned long btm_vbi, unsigned long a, unsigned long b)\n{\n\tregw(top_vbi, VPIF_CH1_TOP_STRT_ADD_HANC);\n\tregw(btm_vbi, VPIF_CH1_BTM_STRT_ADD_HANC);\n}\n\n \nstatic inline void disable_raw_feature(u8 channel_id, u8 index)\n{\n\tu32 ctrl_reg;\n\tif (0 == channel_id)\n\t\tctrl_reg = VPIF_CH0_CTRL;\n\telse\n\t\tctrl_reg = VPIF_CH1_CTRL;\n\n\tif (1 == index)\n\t\tvpif_clr_bit(ctrl_reg, VPIF_CH_VANC_EN_BIT);\n\telse\n\t\tvpif_clr_bit(ctrl_reg, VPIF_CH_HANC_EN_BIT);\n}\n\nstatic inline void enable_raw_feature(u8 channel_id, u8 index)\n{\n\tu32 ctrl_reg;\n\tif (0 == channel_id)\n\t\tctrl_reg = VPIF_CH0_CTRL;\n\telse\n\t\tctrl_reg = VPIF_CH1_CTRL;\n\n\tif (1 == index)\n\t\tvpif_set_bit(ctrl_reg, VPIF_CH_VANC_EN_BIT);\n\telse\n\t\tvpif_set_bit(ctrl_reg, VPIF_CH_HANC_EN_BIT);\n}\n\n \nstatic inline void enable_channel2(int enable)\n{\n\tif (enable) {\n\t\tregw((regr(VPIF_CH2_CTRL) | (VPIF_CH2_CLK_EN)), VPIF_CH2_CTRL);\n\t\tregw((regr(VPIF_CH2_CTRL) | (VPIF_CH2_EN)), VPIF_CH2_CTRL);\n\t} else {\n\t\tregw((regr(VPIF_CH2_CTRL) & (~VPIF_CH2_CLK_EN)), VPIF_CH2_CTRL);\n\t\tregw((regr(VPIF_CH2_CTRL) & (~VPIF_CH2_EN)), VPIF_CH2_CTRL);\n\t}\n}\n\n \nstatic inline void enable_channel3(int enable)\n{\n\tif (enable) {\n\t\tregw((regr(VPIF_CH3_CTRL) | (VPIF_CH3_CLK_EN)), VPIF_CH3_CTRL);\n\t\tregw((regr(VPIF_CH3_CTRL) | (VPIF_CH3_EN)), VPIF_CH3_CTRL);\n\t} else {\n\t\tregw((regr(VPIF_CH3_CTRL) & (~VPIF_CH3_CLK_EN)), VPIF_CH3_CTRL);\n\t\tregw((regr(VPIF_CH3_CTRL) & (~VPIF_CH3_EN)), VPIF_CH3_CTRL);\n\t}\n}\n\n \nstatic inline void channel2_intr_enable(int enable)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&vpif_lock, flags);\n\n\tif (enable) {\n\t\tregw((regr(VPIF_INTEN) | 0x10), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | 0x10), VPIF_INTEN_SET);\n\t\tregw((regr(VPIF_INTEN) | VPIF_INTEN_FRAME_CH2), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH2),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t} else {\n\t\tregw((regr(VPIF_INTEN) & (~VPIF_INTEN_FRAME_CH2)), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH2),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t}\n\tspin_unlock_irqrestore(&vpif_lock, flags);\n}\n\n \nstatic inline void channel3_intr_enable(int enable)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&vpif_lock, flags);\n\n\tif (enable) {\n\t\tregw((regr(VPIF_INTEN) | 0x10), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | 0x10), VPIF_INTEN_SET);\n\n\t\tregw((regr(VPIF_INTEN) | VPIF_INTEN_FRAME_CH3), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH3),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t} else {\n\t\tregw((regr(VPIF_INTEN) & (~VPIF_INTEN_FRAME_CH3)), VPIF_INTEN);\n\t\tregw((regr(VPIF_INTEN_SET) | VPIF_INTEN_FRAME_CH3),\n\t\t\t\t\t\t\tVPIF_INTEN_SET);\n\t}\n\tspin_unlock_irqrestore(&vpif_lock, flags);\n}\n\n \nstatic inline void channel2_raw_enable(int enable, u8 index)\n{\n\tu32 mask;\n\n\tif (1 == index)\n\t\tmask = VPIF_CH_VANC_EN_BIT;\n\telse\n\t\tmask = VPIF_CH_HANC_EN_BIT;\n\n\tif (enable)\n\t\tvpif_set_bit(VPIF_CH2_CTRL, mask);\n\telse\n\t\tvpif_clr_bit(VPIF_CH2_CTRL, mask);\n}\n\n \nstatic inline void channel3_raw_enable(int enable, u8 index)\n{\n\tu32 mask;\n\n\tif (1 == index)\n\t\tmask = VPIF_CH_VANC_EN_BIT;\n\telse\n\t\tmask = VPIF_CH_HANC_EN_BIT;\n\n\tif (enable)\n\t\tvpif_set_bit(VPIF_CH3_CTRL, mask);\n\telse\n\t\tvpif_clr_bit(VPIF_CH3_CTRL, mask);\n}\n\n \nstatic inline void channel2_clipping_enable(int enable)\n{\n\tif (enable) {\n\t\tvpif_set_bit(VPIF_CH2_CTRL, VPIF_CH2_CLIP_ANC_EN);\n\t\tvpif_set_bit(VPIF_CH2_CTRL, VPIF_CH2_CLIP_ACTIVE_EN);\n\t} else {\n\t\tvpif_clr_bit(VPIF_CH2_CTRL, VPIF_CH2_CLIP_ANC_EN);\n\t\tvpif_clr_bit(VPIF_CH2_CTRL, VPIF_CH2_CLIP_ACTIVE_EN);\n\t}\n}\n\n \nstatic inline void channel3_clipping_enable(int enable)\n{\n\tif (enable) {\n\t\tvpif_set_bit(VPIF_CH3_CTRL, VPIF_CH3_CLIP_ANC_EN);\n\t\tvpif_set_bit(VPIF_CH3_CTRL, VPIF_CH3_CLIP_ACTIVE_EN);\n\t} else {\n\t\tvpif_clr_bit(VPIF_CH3_CTRL, VPIF_CH3_CLIP_ANC_EN);\n\t\tvpif_clr_bit(VPIF_CH3_CTRL, VPIF_CH3_CLIP_ACTIVE_EN);\n\t}\n}\n\n \nstatic inline void ch2_set_video_buf_addr_yc_nmux(unsigned long top_strt_luma,\n\t\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH2_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH2_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH3_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH3_BTM_STRT_ADD_CHROMA);\n}\n\n \nstatic inline void ch2_set_video_buf_addr(unsigned long top_strt_luma,\n\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH2_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH2_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH2_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH2_BTM_STRT_ADD_CHROMA);\n}\n\nstatic inline void ch3_set_video_buf_addr(unsigned long top_strt_luma,\n\t\t\t\t\t  unsigned long btm_strt_luma,\n\t\t\t\t\t  unsigned long top_strt_chroma,\n\t\t\t\t\t  unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH3_TOP_STRT_ADD_LUMA);\n\tregw(btm_strt_luma, VPIF_CH3_BTM_STRT_ADD_LUMA);\n\tregw(top_strt_chroma, VPIF_CH3_TOP_STRT_ADD_CHROMA);\n\tregw(btm_strt_chroma, VPIF_CH3_BTM_STRT_ADD_CHROMA);\n}\n\n \nstatic inline void ch2_set_vbi_addr(unsigned long top_strt_luma,\n\t\t\t\t    unsigned long btm_strt_luma,\n\t\t\t\t    unsigned long top_strt_chroma,\n\t\t\t\t    unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH2_TOP_STRT_ADD_VANC);\n\tregw(btm_strt_luma, VPIF_CH2_BTM_STRT_ADD_VANC);\n}\n\nstatic inline void ch3_set_vbi_addr(unsigned long top_strt_luma,\n\t\t\t\t    unsigned long btm_strt_luma,\n\t\t\t\t    unsigned long top_strt_chroma,\n\t\t\t\t    unsigned long btm_strt_chroma)\n{\n\tregw(top_strt_luma, VPIF_CH3_TOP_STRT_ADD_VANC);\n\tregw(btm_strt_luma, VPIF_CH3_BTM_STRT_ADD_VANC);\n}\n\nstatic inline int vpif_intr_status(int channel)\n{\n\tint status = 0;\n\tint mask;\n\n\tif (channel < 0 || channel > 3)\n\t\treturn 0;\n\n\tmask = 1 << channel;\n\tstatus = regr(VPIF_STATUS) & mask;\n\tregw(status, VPIF_STATUS_CLR);\n\n\treturn status;\n}\n\n#define VPIF_MAX_NAME\t(30)\n\n \nstruct vpif_channel_config_params {\n\tchar name[VPIF_MAX_NAME];\t \n\tu16 width;\t\t\t \n\tu16 height;\t\t\t \n\tu8 frm_fmt;\t\t\t \n\tu8 ycmux_mode;\t\t\t \n\tu16 eav2sav;\t\t\t \n\tu16 sav2eav;\t\t\t \n\tu16 l1, l3, l5, l7, l9, l11;\t \n\tu16 vsize;\t\t\t \n\tu8 capture_format;\t\t \n\tu8  vbi_supported;\t\t \n\tu8 hd_sd;\t\t\t \n\tv4l2_std_id stdid;\t\t \n\tstruct v4l2_dv_timings dv_timings;\t \n};\n\nextern const unsigned int vpif_ch_params_count;\nextern const struct vpif_channel_config_params vpif_ch_params[];\n\nstruct vpif_video_params;\nstruct vpif_params;\nstruct vpif_vbi_params;\n\nint vpif_set_video_params(struct vpif_params *vpifparams, u8 channel_id);\nvoid vpif_set_vbi_display_params(struct vpif_vbi_params *vbiparams,\n\t\t\t\t\t\t\tu8 channel_id);\nint vpif_channel_getfid(u8 channel_id);\n\nenum data_size {\n\t_8BITS = 0,\n\t_10BITS,\n\t_12BITS,\n};\n\n \nstruct vpif_vbi_params {\n\t__u32 hstart0;   \n\t__u32 vstart0;   \n\t__u32 hsize0;    \n\t__u32 vsize0;    \n\t__u32 hstart1;   \n\t__u32 vstart1;   \n\t__u32 hsize1;    \n\t__u32 vsize1;    \n};\n\n \nstruct vpif_video_params {\n\t__u8 storage_mode;\t \n\tunsigned long hpitch;\n\tv4l2_std_id stdid;\n};\n\nstruct vpif_params {\n\tstruct vpif_interface iface;\n\tstruct vpif_video_params video_params;\n\tstruct vpif_channel_config_params std_info;\n\tunion param {\n\t\tstruct vpif_vbi_params\tvbi_params;\n\t\tenum data_size data_sz;\n\t} params;\n};\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}