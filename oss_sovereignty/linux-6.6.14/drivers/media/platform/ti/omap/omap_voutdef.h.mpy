{
  "module_name": "omap_voutdef.h",
  "hash_id": "7767da99eaf0d566031ed321e695d9d138d17937498b6b0542565f2b6a7d60c2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/ti/omap/omap_voutdef.h",
  "human_readable_source": " \n\n#ifndef OMAP_VOUTDEF_H\n#define OMAP_VOUTDEF_H\n\n#include <media/videobuf2-dma-contig.h>\n#include <media/v4l2-ctrls.h>\n#include <video/omapfb_dss.h>\n#include <video/omapvrfb.h>\n#include <linux/dmaengine.h>\n\n#define YUYV_BPP        2\n#define RGB565_BPP      2\n#define RGB24_BPP       3\n#define RGB32_BPP       4\n#define TILE_SIZE       32\n#define YUYV_VRFB_BPP   2\n#define RGB_VRFB_BPP    1\n#define MAX_CID\t\t3\n#define MAC_VRFB_CTXS\t4\n#define MAX_VOUT_DEV\t2\n#define MAX_OVLS\t3\n#define MAX_DISPLAYS\t10\n#define MAX_MANAGERS\t3\n\n#define QQVGA_WIDTH\t\t160\n#define QQVGA_HEIGHT\t\t120\n\n \n#define VID_MAX_WIDTH\t\t1280\t \n#define VID_MAX_HEIGHT\t\t720\t \n\n \n#define VID_MIN_WIDTH\t\t2\n#define VID_MIN_HEIGHT\t\t2\n\n \n#define MAX_PIXELS_PER_LINE     2048\n\n#define VRFB_TX_TIMEOUT         1000\n#define VRFB_NUM_BUFS\t\t4\n\n \n#define OMAP_VOUT_MAX_BUF_SIZE (VID_MAX_WIDTH*VID_MAX_HEIGHT*4)\n\nenum dma_channel_state {\n\tDMA_CHAN_NOT_ALLOTED,\n\tDMA_CHAN_ALLOTED,\n};\n\n \nenum dss_rotation {\n\tdss_rotation_0_degree\t= 0,\n\tdss_rotation_90_degree\t= 1,\n\tdss_rotation_180_degree\t= 2,\n\tdss_rotation_270_degree = 3,\n};\n\n \nenum vout_rotaion_type {\n\tVOUT_ROT_NONE\t= 0,\n\tVOUT_ROT_VRFB\t= 1,\n};\n\n \nstruct vid_vrfb_dma {\n\tstruct dma_chan *chan;\n\tstruct dma_interleaved_template *xt;\n\n\tint req_status;\n\tint tx_status;\n\twait_queue_head_t wait;\n};\n\nstruct omapvideo_info {\n\tint id;\n\tint num_overlays;\n\tstruct omap_overlay *overlays[MAX_OVLS];\n\tenum vout_rotaion_type rotation_type;\n};\n\nstruct omap2video_device {\n\tstruct mutex  mtx;\n\n\tint state;\n\n\tstruct v4l2_device v4l2_dev;\n\tstruct omap_vout_device *vouts[MAX_VOUT_DEV];\n\n\tint num_displays;\n\tstruct omap_dss_device *displays[MAX_DISPLAYS];\n\tint num_overlays;\n\tstruct omap_overlay *overlays[MAX_OVLS];\n\tint num_managers;\n\tstruct omap_overlay_manager *managers[MAX_MANAGERS];\n};\n\n \nstruct omap_vout_buffer {\n\t \n\tstruct vb2_v4l2_buffer\t\tvbuf;\n\tstruct list_head\t\tqueue;\n};\n\nstatic inline struct omap_vout_buffer *vb2_to_omap_vout_buffer(struct vb2_buffer *vb)\n{\n\tstruct vb2_v4l2_buffer *vbuf = to_vb2_v4l2_buffer(vb);\n\n\treturn container_of(vbuf, struct omap_vout_buffer, vbuf);\n}\n\n \nstruct omap_vout_device {\n\n\tstruct omapvideo_info vid_info;\n\tstruct video_device *vfd;\n\tstruct omap2video_device *vid_dev;\n\tstruct v4l2_ctrl_handler ctrl_handler;\n\tint vid;\n\n\t \n\tint buffer_size;\n\tenum omap_color_mode dss_mode;\n\n\tu32 sequence;\n\n\tstruct v4l2_pix_format pix;\n\tstruct v4l2_rect crop;\n\tstruct v4l2_window win;\n\tstruct v4l2_framebuffer fbuf;\n\n\t \n\tstruct mutex lock;\n\n\tenum dss_rotation rotation;\n\tbool mirror;\n\tint flicker_filter;\n\n\tint bpp;  \n\tint vrfb_bpp;  \n\n\tstruct vid_vrfb_dma vrfb_dma_tx;\n\tunsigned int smsshado_phy_addr[MAC_VRFB_CTXS];\n\tunsigned int smsshado_virt_addr[MAC_VRFB_CTXS];\n\tstruct vrfb vrfb_context[MAC_VRFB_CTXS];\n\tbool vrfb_static_allocation;\n\tunsigned int smsshado_size;\n\tunsigned char pos;\n\n\tint ps, vr_ps, line_length, first_int, field_id;\n\tstruct omap_vout_buffer *cur_frm, *next_frm;\n\tspinlock_t vbq_lock;             \n\tstruct list_head dma_queue;\n\tdma_addr_t queued_buf_addr[VIDEO_MAX_FRAME];\n\tu32 cropped_offset;\n\ts32 tv_field1_offset;\n\tvoid *isr_handle;\n\tstruct vb2_queue vq;\n\n};\n\n \nstatic inline int is_rotation_90_or_270(const struct omap_vout_device *vout)\n{\n\treturn (vout->rotation == dss_rotation_90_degree ||\n\t\t\tvout->rotation == dss_rotation_270_degree);\n}\n\n \nstatic inline int is_rotation_enabled(const struct omap_vout_device *vout)\n{\n\treturn vout->rotation || vout->mirror;\n}\n\n \nstatic inline int calc_rotation(const struct omap_vout_device *vout)\n{\n\tif (!vout->mirror)\n\t\treturn vout->rotation;\n\n\tswitch (vout->rotation) {\n\tcase dss_rotation_90_degree:\n\t\treturn dss_rotation_270_degree;\n\tcase dss_rotation_270_degree:\n\t\treturn dss_rotation_90_degree;\n\tcase dss_rotation_180_degree:\n\t\treturn dss_rotation_0_degree;\n\tdefault:\n\t\treturn dss_rotation_180_degree;\n\t}\n}\n\nvoid omap_vout_free_buffers(struct omap_vout_device *vout);\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}