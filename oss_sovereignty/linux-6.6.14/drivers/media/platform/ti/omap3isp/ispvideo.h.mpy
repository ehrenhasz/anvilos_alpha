{
  "module_name": "ispvideo.h",
  "hash_id": "0fdc7330b27bf03cdaac887df87a0af7d13a1c46311fd946c70bbcebe5c4a707",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/ti/omap3isp/ispvideo.h",
  "human_readable_source": " \n \n\n#ifndef OMAP3_ISP_VIDEO_H\n#define OMAP3_ISP_VIDEO_H\n\n#include <linux/v4l2-mediabus.h>\n#include <media/media-entity.h>\n#include <media/v4l2-dev.h>\n#include <media/v4l2-fh.h>\n#include <media/videobuf2-v4l2.h>\n\n#define ISP_VIDEO_DRIVER_NAME\t\t\"ispvideo\"\n#define ISP_VIDEO_DRIVER_VERSION\t\"0.0.2\"\n\nstruct isp_device;\nstruct isp_video;\nstruct v4l2_mbus_framefmt;\nstruct v4l2_pix_format;\n\n \nstruct isp_format_info {\n\tu32 code;\n\tu32 truncated;\n\tu32 uncompressed;\n\tu32 flavor;\n\tu32 pixelformat;\n\tunsigned int width;\n\tunsigned int bpp;\n};\n\nenum isp_pipeline_stream_state {\n\tISP_PIPELINE_STREAM_STOPPED = 0,\n\tISP_PIPELINE_STREAM_CONTINUOUS = 1,\n\tISP_PIPELINE_STREAM_SINGLESHOT = 2,\n};\n\nenum isp_pipeline_state {\n\t \n\tISP_PIPELINE_STREAM_INPUT = 1,\n\t \n\tISP_PIPELINE_STREAM_OUTPUT = 2,\n\t \n\tISP_PIPELINE_QUEUE_INPUT = 4,\n\t \n\tISP_PIPELINE_QUEUE_OUTPUT = 8,\n\t \n\tISP_PIPELINE_IDLE_INPUT = 16,\n\t \n\tISP_PIPELINE_IDLE_OUTPUT = 32,\n\t \n\tISP_PIPELINE_STREAM = 64,\n};\n\n \nstruct isp_pipeline {\n\tstruct media_pipeline pipe;\n\tspinlock_t lock;\t\t \n\tunsigned int state;\n\tenum isp_pipeline_stream_state stream_state;\n\tstruct isp_video *input;\n\tstruct isp_video *output;\n\tstruct media_entity_enum ent_enum;\n\tunsigned long l3_ick;\n\tunsigned int max_rate;\n\tenum v4l2_field field;\n\tatomic_t frame_number;\n\tbool do_propagation;  \n\tbool error;\n\tstruct v4l2_fract max_timeperframe;\n\tstruct v4l2_subdev *external;\n\tunsigned int external_rate;\n\tunsigned int external_width;\n};\n\nstatic inline struct isp_pipeline *to_isp_pipeline(struct media_entity *entity)\n{\n\tstruct media_pipeline *pipe = media_entity_pipeline(entity);\n\n\tif (!pipe)\n\t\treturn NULL;\n\n\treturn container_of(pipe, struct isp_pipeline, pipe);\n}\n\nstatic inline int isp_pipeline_ready(struct isp_pipeline *pipe)\n{\n\treturn pipe->state == (ISP_PIPELINE_STREAM_INPUT |\n\t\t\t       ISP_PIPELINE_STREAM_OUTPUT |\n\t\t\t       ISP_PIPELINE_QUEUE_INPUT |\n\t\t\t       ISP_PIPELINE_QUEUE_OUTPUT |\n\t\t\t       ISP_PIPELINE_IDLE_INPUT |\n\t\t\t       ISP_PIPELINE_IDLE_OUTPUT);\n}\n\n \nstruct isp_buffer {\n\tstruct vb2_v4l2_buffer vb;\n\tstruct list_head irqlist;\n\tdma_addr_t dma;\n};\n\n#define to_isp_buffer(buf)\tcontainer_of(buf, struct isp_buffer, vb)\n\nenum isp_video_dmaqueue_flags {\n\t \n\tISP_VIDEO_DMAQUEUE_UNDERRUN = (1 << 0),\n\t \n\tISP_VIDEO_DMAQUEUE_QUEUED = (1 << 1),\n};\n\n#define isp_video_dmaqueue_flags_clr(video)\t\\\n\t\t\t({ (video)->dmaqueue_flags = 0; })\n\n \nstruct isp_video_operations {\n\tint(*queue)(struct isp_video *video, struct isp_buffer *buffer);\n};\n\nstruct isp_video {\n\tstruct video_device video;\n\tenum v4l2_buf_type type;\n\tstruct media_pad pad;\n\n\tstruct mutex mutex;\t\t \n\tatomic_t active;\n\n\tstruct isp_device *isp;\n\n\tunsigned int capture_mem;\n\tunsigned int bpl_alignment;\t \n\tunsigned int bpl_zero_padding;\t \n\tunsigned int bpl_max;\t\t \n\tunsigned int bpl_value;\t\t \n\tunsigned int bpl_padding;\t \n\n\t \n\tstruct isp_pipeline pipe;\n\tstruct mutex stream_lock;\t \n\tbool error;\n\n\t \n\tstruct vb2_queue *queue;\n\tstruct mutex queue_lock;\t \n\tspinlock_t irqlock;\t\t \n\tstruct list_head dmaqueue;\n\tenum isp_video_dmaqueue_flags dmaqueue_flags;\n\n\tconst struct isp_video_operations *ops;\n};\n\n#define to_isp_video(vdev)\tcontainer_of(vdev, struct isp_video, video)\n\nstruct isp_video_fh {\n\tstruct v4l2_fh vfh;\n\tstruct isp_video *video;\n\tstruct vb2_queue queue;\n\tstruct v4l2_format format;\n\tstruct v4l2_fract timeperframe;\n};\n\n#define to_isp_video_fh(fh)\tcontainer_of(fh, struct isp_video_fh, vfh)\n#define isp_video_queue_to_isp_video_fh(q) \\\n\t\t\t\tcontainer_of(q, struct isp_video_fh, queue)\n\nint omap3isp_video_init(struct isp_video *video, const char *name);\nvoid omap3isp_video_cleanup(struct isp_video *video);\nint omap3isp_video_register(struct isp_video *video,\n\t\t\t    struct v4l2_device *vdev);\nvoid omap3isp_video_unregister(struct isp_video *video);\nstruct isp_buffer *omap3isp_video_buffer_next(struct isp_video *video);\nvoid omap3isp_video_cancel_stream(struct isp_video *video);\nvoid omap3isp_video_resume(struct isp_video *video, int continuous);\nstruct media_pad *omap3isp_video_remote_pad(struct isp_video *video);\n\nconst struct isp_format_info *\nomap3isp_video_format_info(u32 code);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}