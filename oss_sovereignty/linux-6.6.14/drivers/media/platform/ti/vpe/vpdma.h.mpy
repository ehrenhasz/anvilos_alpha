{
  "module_name": "vpdma.h",
  "hash_id": "e0018cb071b4349f344887ef5baa69ead2a00eafd8da66f96d622a72a2be1fe2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/ti/vpe/vpdma.h",
  "human_readable_source": " \n \n\n#ifndef __TI_VPDMA_H_\n#define __TI_VPDMA_H_\n\n#define VPDMA_MAX_NUM_LIST\t\t8\n \nstruct vpdma_buf {\n\tvoid\t\t\t*addr;\n\tdma_addr_t\t\tdma_addr;\n\tsize_t\t\t\tsize;\n\tbool\t\t\tmapped;\n};\n\nstruct vpdma_desc_list {\n\tstruct vpdma_buf buf;\n\tvoid *next;\n\tint type;\n};\n\nstruct vpdma_data {\n\tvoid __iomem\t\t*base;\n\n\tstruct platform_device\t*pdev;\n\n\tspinlock_t\t\tlock;\n\tbool\t\t\thwlist_used[VPDMA_MAX_NUM_LIST];\n\tvoid\t\t\t*hwlist_priv[VPDMA_MAX_NUM_LIST];\n\t \n\tvoid (*cb)(struct platform_device *pdev);\n};\n\nenum vpdma_data_format_type {\n\tVPDMA_DATA_FMT_TYPE_YUV,\n\tVPDMA_DATA_FMT_TYPE_RGB,\n\tVPDMA_DATA_FMT_TYPE_MISC,\n};\n\nstruct vpdma_data_format {\n\tenum vpdma_data_format_type type;\n\tint data_type;\n\tu8 depth;\n};\n\n#define VPDMA_DESC_ALIGN\t\t16\t \n#define VPDMA_STRIDE_ALIGN\t\t16\t \n#define VPDMA_MAX_STRIDE\t\t65520\t \n#define VPDMA_DTD_DESC_SIZE\t\t32\t \n#define VPDMA_CFD_CTD_DESC_SIZE\t\t16\t \n\n#define VPDMA_LIST_TYPE_NORMAL\t\t0\n#define VPDMA_LIST_TYPE_SELF_MODIFYING\t1\n#define VPDMA_LIST_TYPE_DOORBELL\t2\n\nenum vpdma_yuv_formats {\n\tVPDMA_DATA_FMT_Y444 = 0,\n\tVPDMA_DATA_FMT_Y422,\n\tVPDMA_DATA_FMT_Y420,\n\tVPDMA_DATA_FMT_C444,\n\tVPDMA_DATA_FMT_C422,\n\tVPDMA_DATA_FMT_C420,\n\tVPDMA_DATA_FMT_CB420,\n\tVPDMA_DATA_FMT_YCR422,\n\tVPDMA_DATA_FMT_YC444,\n\tVPDMA_DATA_FMT_CRY422,\n\tVPDMA_DATA_FMT_CBY422,\n\tVPDMA_DATA_FMT_YCB422,\n};\n\nenum vpdma_rgb_formats {\n\tVPDMA_DATA_FMT_RGB565 = 0,\n\tVPDMA_DATA_FMT_ARGB16_1555,\n\tVPDMA_DATA_FMT_ARGB16,\n\tVPDMA_DATA_FMT_RGBA16_5551,\n\tVPDMA_DATA_FMT_RGBA16,\n\tVPDMA_DATA_FMT_ARGB24,\n\tVPDMA_DATA_FMT_RGB24,\n\tVPDMA_DATA_FMT_ARGB32,\n\tVPDMA_DATA_FMT_RGBA24,\n\tVPDMA_DATA_FMT_RGBA32,\n\tVPDMA_DATA_FMT_BGR565,\n\tVPDMA_DATA_FMT_ABGR16_1555,\n\tVPDMA_DATA_FMT_ABGR16,\n\tVPDMA_DATA_FMT_BGRA16_5551,\n\tVPDMA_DATA_FMT_BGRA16,\n\tVPDMA_DATA_FMT_ABGR24,\n\tVPDMA_DATA_FMT_BGR24,\n\tVPDMA_DATA_FMT_ABGR32,\n\tVPDMA_DATA_FMT_BGRA24,\n\tVPDMA_DATA_FMT_BGRA32,\n};\n\nenum vpdma_raw_formats {\n\tVPDMA_DATA_FMT_RAW8 = 0,\n\tVPDMA_DATA_FMT_RAW16,\n};\n\nenum vpdma_misc_formats {\n\tVPDMA_DATA_FMT_MV = 0,\n};\n\nextern const struct vpdma_data_format vpdma_yuv_fmts[];\nextern const struct vpdma_data_format vpdma_rgb_fmts[];\nextern const struct vpdma_data_format vpdma_raw_fmts[];\nextern const struct vpdma_data_format vpdma_misc_fmts[];\n\nenum vpdma_frame_start_event {\n\tVPDMA_FSEVENT_HDMI_FID = 0,\n\tVPDMA_FSEVENT_DVO2_FID,\n\tVPDMA_FSEVENT_HDCOMP_FID,\n\tVPDMA_FSEVENT_SD_FID,\n\tVPDMA_FSEVENT_LM_FID0,\n\tVPDMA_FSEVENT_LM_FID1,\n\tVPDMA_FSEVENT_LM_FID2,\n\tVPDMA_FSEVENT_CHANNEL_ACTIVE,\n};\n\n \nenum vpdma_max_width {\n\tMAX_OUT_WIDTH_UNLIMITED = 0,\n\tMAX_OUT_WIDTH_REG1,\n\tMAX_OUT_WIDTH_REG2,\n\tMAX_OUT_WIDTH_REG3,\n\tMAX_OUT_WIDTH_352,\n\tMAX_OUT_WIDTH_768,\n\tMAX_OUT_WIDTH_1280,\n\tMAX_OUT_WIDTH_1920,\n};\n\n \nenum vpdma_max_height {\n\tMAX_OUT_HEIGHT_UNLIMITED = 0,\n\tMAX_OUT_HEIGHT_REG1,\n\tMAX_OUT_HEIGHT_REG2,\n\tMAX_OUT_HEIGHT_REG3,\n\tMAX_OUT_HEIGHT_288,\n\tMAX_OUT_HEIGHT_576,\n\tMAX_OUT_HEIGHT_720,\n\tMAX_OUT_HEIGHT_1080,\n};\n\n \nenum vpdma_channel {\n\tVPE_CHAN_LUMA1_IN,\n\tVPE_CHAN_CHROMA1_IN,\n\tVPE_CHAN_LUMA2_IN,\n\tVPE_CHAN_CHROMA2_IN,\n\tVPE_CHAN_LUMA3_IN,\n\tVPE_CHAN_CHROMA3_IN,\n\tVPE_CHAN_MV_IN,\n\tVPE_CHAN_MV_OUT,\n\tVPE_CHAN_LUMA_OUT,\n\tVPE_CHAN_CHROMA_OUT,\n\tVPE_CHAN_RGB_OUT,\n};\n\n#define VIP_CHAN_VIP2_OFFSET\t\t70\n#define VIP_CHAN_MULT_PORTB_OFFSET\t16\n#define VIP_CHAN_YUV_PORTB_OFFSET\t2\n#define VIP_CHAN_RGB_PORTB_OFFSET\t1\n\n#define VPDMA_MAX_CHANNELS\t\t256\n\n \n#define VPDMA_DATA_ODD_LINE_SKIP\t(1 << 0)\n#define VPDMA_DATA_EVEN_LINE_SKIP\t(1 << 1)\n#define VPDMA_DATA_FRAME_1D\t\t(1 << 2)\n#define VPDMA_DATA_MODE_TILED\t\t(1 << 3)\n\n \n#define CFD_MMR_CLIENT\t\t0\n#define CFD_SC_CLIENT\t\t4\n\n \nstruct vpdma_adb_hdr {\n\tu32\t\t\toffset;\n\tu32\t\t\tnwords;\n\tu32\t\t\treserved0;\n\tu32\t\t\treserved1;\n};\n\n \n#define ADB_ADDR(dma_buf, str, fld)\t((dma_buf)->addr + offsetof(str, fld))\n#define MMR_ADB_ADDR(buf, str, fld)\tADB_ADDR(&(buf), struct str, fld)\n\n#define VPDMA_SET_MMR_ADB_HDR(buf, str, hdr, regs, offset_a)\t\\\n\tdo {\t\t\t\t\t\t\t\\\n\t\tstruct vpdma_adb_hdr *h;\t\t\t\\\n\t\tstruct str *adb = NULL;\t\t\t\t\\\n\t\th = MMR_ADB_ADDR(buf, str, hdr);\t\t\\\n\t\th->offset = (offset_a);\t\t\t\t\\\n\t\th->nwords = sizeof(adb->regs) >> 2;\t\t\\\n\t} while (0)\n\n \nint vpdma_alloc_desc_buf(struct vpdma_buf *buf, size_t size);\nvoid vpdma_free_desc_buf(struct vpdma_buf *buf);\nint vpdma_map_desc_buf(struct vpdma_data *vpdma, struct vpdma_buf *buf);\nvoid vpdma_unmap_desc_buf(struct vpdma_data *vpdma, struct vpdma_buf *buf);\n\n \nint vpdma_create_desc_list(struct vpdma_desc_list *list, size_t size, int type);\nvoid vpdma_reset_desc_list(struct vpdma_desc_list *list);\nvoid vpdma_free_desc_list(struct vpdma_desc_list *list);\nint vpdma_submit_descs(struct vpdma_data *vpdma, struct vpdma_desc_list *list,\n\t\t       int list_num);\nbool vpdma_list_busy(struct vpdma_data *vpdma, int list_num);\nvoid vpdma_update_dma_addr(struct vpdma_data *vpdma,\n\tstruct vpdma_desc_list *list, dma_addr_t dma_addr,\n\tvoid *write_dtd, int drop, int idx);\n\n \nint vpdma_hwlist_alloc(struct vpdma_data *vpdma, void *priv);\nvoid *vpdma_hwlist_get_priv(struct vpdma_data *vpdma, int list_num);\nvoid *vpdma_hwlist_release(struct vpdma_data *vpdma, int list_num);\n\n \nvoid vpdma_add_cfd_block(struct vpdma_desc_list *list, int client,\n\t\tstruct vpdma_buf *blk, u32 dest_offset);\nvoid vpdma_add_cfd_adb(struct vpdma_desc_list *list, int client,\n\t\tstruct vpdma_buf *adb);\nvoid vpdma_add_sync_on_channel_ctd(struct vpdma_desc_list *list,\n\t\tenum vpdma_channel chan);\nvoid vpdma_add_abort_channel_ctd(struct vpdma_desc_list *list,\n\t\tint chan_num);\nvoid vpdma_add_out_dtd(struct vpdma_desc_list *list, int width,\n\t\tint stride, const struct v4l2_rect *c_rect,\n\t\tconst struct vpdma_data_format *fmt, dma_addr_t dma_addr,\n\t\tint max_w, int max_h, enum vpdma_channel chan, u32 flags);\nvoid vpdma_rawchan_add_out_dtd(struct vpdma_desc_list *list, int width,\n\t\tint stride, const struct v4l2_rect *c_rect,\n\t\tconst struct vpdma_data_format *fmt, dma_addr_t dma_addr,\n\t\tint max_w, int max_h, int raw_vpdma_chan, u32 flags);\n\nvoid vpdma_add_in_dtd(struct vpdma_desc_list *list, int width,\n\t\tint stride, const struct v4l2_rect *c_rect,\n\t\tconst struct vpdma_data_format *fmt, dma_addr_t dma_addr,\n\t\tenum vpdma_channel chan, int field, u32 flags, int frame_width,\n\t\tint frame_height, int start_h, int start_v);\nint vpdma_list_cleanup(struct vpdma_data *vpdma, int list_num,\n\t\tint *channels, int size);\n\n \nvoid vpdma_enable_list_complete_irq(struct vpdma_data *vpdma, int irq_num,\n\t\tint list_num, bool enable);\nvoid vpdma_clear_list_stat(struct vpdma_data *vpdma, int irq_num,\n\t\t\t   int list_num);\nunsigned int vpdma_get_list_stat(struct vpdma_data *vpdma, int irq_num);\nunsigned int vpdma_get_list_mask(struct vpdma_data *vpdma, int irq_num);\n\n \nvoid vpdma_set_line_mode(struct vpdma_data *vpdma, int line_mode,\n\t\tenum vpdma_channel chan);\nvoid vpdma_set_frame_start_event(struct vpdma_data *vpdma,\n\t\tenum vpdma_frame_start_event fs_event, enum vpdma_channel chan);\nvoid vpdma_set_max_size(struct vpdma_data *vpdma, int reg_addr,\n\t\t\tu32 width, u32 height);\n\nvoid vpdma_set_bg_color(struct vpdma_data *vpdma,\n\t\t\tstruct vpdma_data_format *fmt, u32 color);\nvoid vpdma_dump_regs(struct vpdma_data *vpdma);\n\n \nint vpdma_create(struct platform_device *pdev, struct vpdma_data *vpdma,\n\t\tvoid (*cb)(struct platform_device *pdev));\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}