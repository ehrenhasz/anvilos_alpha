{
  "module_name": "vdec_h264_req_common.h",
  "hash_id": "ac47bc7bd0611a98c43635902af300ebc7ae77cd9c7119dc9eeaa35148b5914c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/mediatek/vcodec/decoder/vdec/vdec_h264_req_common.h",
  "human_readable_source": " \n \n\n#ifndef _VDEC_H264_REQ_COMMON_H_\n#define _VDEC_H264_REQ_COMMON_H_\n\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <media/v4l2-h264.h>\n#include <media/v4l2-mem2mem.h>\n#include <media/videobuf2-dma-contig.h>\n\n#include \"../mtk_vcodec_dec_drv.h\"\n\n#define NAL_NON_IDR_SLICE\t\t\t0x01\n#define NAL_IDR_SLICE\t\t\t\t0x05\n#define NAL_TYPE(value)\t\t\t\t((value) & 0x1F)\n\n#define BUF_PREDICTION_SZ\t\t\t(64 * 4096)\n#define MB_UNIT_LEN\t\t\t\t16\n\n \n#define HW_MB_STORE_SZ\t\t\t\t64\n\n#define H264_MAX_MV_NUM\t\t\t\t32\n\n \nstruct mtk_h264_dpb_info {\n\tdma_addr_t y_dma_addr;\n\tdma_addr_t c_dma_addr;\n\tint reference_flag;\n\tint field;\n};\n\n \nstruct mtk_h264_sps_param {\n\tunsigned char chroma_format_idc;\n\tunsigned char bit_depth_luma_minus8;\n\tunsigned char bit_depth_chroma_minus8;\n\tunsigned char log2_max_frame_num_minus4;\n\tunsigned char pic_order_cnt_type;\n\tunsigned char log2_max_pic_order_cnt_lsb_minus4;\n\tunsigned char max_num_ref_frames;\n\tunsigned char separate_colour_plane_flag;\n\tunsigned short pic_width_in_mbs_minus1;\n\tunsigned short pic_height_in_map_units_minus1;\n\tunsigned int max_frame_nums;\n\tunsigned char qpprime_y_zero_transform_bypass_flag;\n\tunsigned char delta_pic_order_always_zero_flag;\n\tunsigned char frame_mbs_only_flag;\n\tunsigned char mb_adaptive_frame_field_flag;\n\tunsigned char direct_8x8_inference_flag;\n\tunsigned char reserved[3];\n};\n\n \nstruct mtk_h264_pps_param {\n\tunsigned char num_ref_idx_l0_default_active_minus1;\n\tunsigned char num_ref_idx_l1_default_active_minus1;\n\tunsigned char weighted_bipred_idc;\n\tchar pic_init_qp_minus26;\n\tchar chroma_qp_index_offset;\n\tchar second_chroma_qp_index_offset;\n\tunsigned char entropy_coding_mode_flag;\n\tunsigned char pic_order_present_flag;\n\tunsigned char deblocking_filter_control_present_flag;\n\tunsigned char constrained_intra_pred_flag;\n\tunsigned char weighted_pred_flag;\n\tunsigned char redundant_pic_cnt_present_flag;\n\tunsigned char transform_8x8_mode_flag;\n\tunsigned char scaling_matrix_present_flag;\n\tunsigned char reserved[2];\n};\n\n \nstruct mtk_h264_slice_hd_param {\n\tunsigned int first_mb_in_slice;\n\tunsigned int field_pic_flag;\n\tunsigned int slice_type;\n\tunsigned int frame_num;\n\tint pic_order_cnt_lsb;\n\tint delta_pic_order_cnt_bottom;\n\tunsigned int bottom_field_flag;\n\tunsigned int direct_spatial_mv_pred_flag;\n\tint delta_pic_order_cnt0;\n\tint delta_pic_order_cnt1;\n\tunsigned int cabac_init_idc;\n\tint slice_qp_delta;\n\tunsigned int disable_deblocking_filter_idc;\n\tint slice_alpha_c0_offset_div2;\n\tint slice_beta_offset_div2;\n\tunsigned int num_ref_idx_l0_active_minus1;\n\tunsigned int num_ref_idx_l1_active_minus1;\n\tunsigned int reserved;\n};\n\n \nstruct slice_api_h264_scaling_matrix {\n\tunsigned char scaling_list_4x4[6][16];\n\tunsigned char scaling_list_8x8[6][64];\n};\n\n \nstruct slice_h264_dpb_entry {\n\tunsigned long long reference_ts;\n\tunsigned short frame_num;\n\tunsigned short pic_num;\n\t \n\tint top_field_order_cnt;\n\tint bottom_field_order_cnt;\n\tunsigned int flags;\n};\n\n \nstruct slice_api_h264_decode_param {\n\tstruct slice_h264_dpb_entry dpb[V4L2_H264_NUM_DPB_ENTRIES];\n\tunsigned short num_slices;\n\tunsigned short nal_ref_idc;\n\tunsigned char ref_pic_list_p0[32];\n\tunsigned char ref_pic_list_b0[32];\n\tunsigned char ref_pic_list_b1[32];\n\tint top_field_order_cnt;\n\tint bottom_field_order_cnt;\n\tunsigned int flags;\n};\n\n \nstruct h264_fb {\n\tu64 vdec_fb_va;\n\tu64 y_fb_dma;\n\tu64 c_fb_dma;\n\ts32 poc;\n\tu32 reserved;\n};\n\n \nvoid mtk_vdec_h264_get_ref_list(u8 *ref_list,\n\t\t\t\tconst struct v4l2_h264_reference *v4l2_ref_list,\n\t\t\t\tint num_valid);\n\n \nvoid *mtk_vdec_h264_get_ctrl_ptr(struct mtk_vcodec_dec_ctx *ctx, int id);\n\n \nvoid mtk_vdec_h264_fill_dpb_info(struct mtk_vcodec_dec_ctx *ctx,\n\t\t\t\t struct slice_api_h264_decode_param *decode_params,\n\t\t\t\t struct mtk_h264_dpb_info *h264_dpb_info);\n\n \nvoid mtk_vdec_h264_copy_sps_params(struct mtk_h264_sps_param *dst_param,\n\t\t\t\t   const struct v4l2_ctrl_h264_sps *src_param);\n\n \nvoid mtk_vdec_h264_copy_pps_params(struct mtk_h264_pps_param *dst_param,\n\t\t\t\t   const struct v4l2_ctrl_h264_pps *src_param);\n\n \nvoid mtk_vdec_h264_copy_slice_hd_params(struct mtk_h264_slice_hd_param *dst_param,\n\t\t\t\t\tconst struct v4l2_ctrl_h264_slice_params *src_param,\n\t\t\t\t\tconst struct v4l2_ctrl_h264_decode_params *dec_param);\n\n \nvoid mtk_vdec_h264_copy_scaling_matrix(struct slice_api_h264_scaling_matrix *dst_matrix,\n\t\t\t\t       const struct v4l2_ctrl_h264_scaling_matrix *src_matrix);\n\n \nvoid\nmtk_vdec_h264_copy_decode_params(struct slice_api_h264_decode_param *dst_params,\n\t\t\t\t const struct v4l2_ctrl_h264_decode_params *src_params,\n\t\t\t\t const struct v4l2_h264_dpb_entry dpb[V4L2_H264_NUM_DPB_ENTRIES]);\n\n \nvoid mtk_vdec_h264_update_dpb(const struct v4l2_ctrl_h264_decode_params *dec_param,\n\t\t\t      struct v4l2_h264_dpb_entry *dpb);\n\n \nint mtk_vdec_h264_find_start_code(unsigned char *data, unsigned int data_sz);\n\n \nunsigned int mtk_vdec_h264_get_mv_buf_size(unsigned int width, unsigned int height);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}