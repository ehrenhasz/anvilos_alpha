{
  "module_name": "mtk-mdp3-comp.h",
  "hash_id": "b6a0b56e6f1c0861d549999c4db44346ed7bd3fa3a889cd18ab1eb964e617643",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/mediatek/mdp3/mtk-mdp3-comp.h",
  "human_readable_source": " \n \n\n#ifndef __MTK_MDP3_COMP_H__\n#define __MTK_MDP3_COMP_H__\n\n#include \"mtk-mdp3-cmdq.h\"\n\n#define MM_REG_WRITE_MASK(cmd, id, base, ofst, val, mask, ...)\t\\\n\tcmdq_pkt_write_mask(&((cmd)->pkt), id,\t\t\t\\\n\t\t(base) + (ofst), (val), (mask), ##__VA_ARGS__)\n\n#define MM_REG_WRITE(cmd, id, base, ofst, val, mask, ...)\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(mask) (m) = (mask);\t\t\t\t\\\n\tMM_REG_WRITE_MASK(cmd, id, base, ofst, val,\t\t\\\n\t\t(((m) & (ofst##_MASK)) == (ofst##_MASK)) ?\t\\\n\t\t\t(0xffffffff) : (m), ##__VA_ARGS__);\t\\\n} while (0)\n\n#define MM_REG_WAIT(cmd, evt)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(cmd) (c) = (cmd);\t\t\t\t\\\n\ttypeof(evt) (e) = (evt);\t\t\t\t\\\n\tcmdq_pkt_wfe(&((c)->pkt), (e), true);\t\t\t\\\n} while (0)\n\n#define MM_REG_WAIT_NO_CLEAR(cmd, evt)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(cmd) (c) = (cmd);\t\t\t\t\\\n\ttypeof(evt) (e) = (evt);\t\t\t\t\\\n\tcmdq_pkt_wfe(&((c)->pkt), (e), false);\t\t\t\\\n} while (0)\n\n#define MM_REG_CLEAR(cmd, evt)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(cmd) (c) = (cmd);\t\t\t\t\\\n\ttypeof(evt) (e) = (evt);\t\t\t\t\\\n\tcmdq_pkt_clear_event(&((c)->pkt), (e));\t\t\t\\\n} while (0)\n\n#define MM_REG_SET_EVENT(cmd, evt)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(cmd) (c) = (cmd);\t\t\t\t\\\n\ttypeof(evt) (e) = (evt);\t\t\t\t\\\n\tcmdq_pkt_set_event(&((c)->pkt), (e));\t\t\t\\\n} while (0)\n\n#define MM_REG_POLL_MASK(cmd, id, base, ofst, val, _mask, ...)\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(_mask) (_m) = (_mask);\t\t\t\t\\\n\tcmdq_pkt_poll_mask(&((cmd)->pkt), id,\t\t\t\\\n\t\t(base) + (ofst), (val), (_m), ##__VA_ARGS__);\t\\\n} while (0)\n\n#define MM_REG_POLL(cmd, id, base, ofst, val, mask, ...)\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\ttypeof(mask) (m) = (mask);\t\t\t\t\\\n\tMM_REG_POLL_MASK((cmd), id, base, ofst, val,\t\t\\\n\t\t(((m) & (ofst##_MASK)) == (ofst##_MASK)) ?\t\\\n\t\t\t(0xffffffff) : (m), ##__VA_ARGS__);\t\\\n} while (0)\n\nenum mtk_mdp_comp_id {\n\tMDP_COMP_NONE = -1,\t \n\n\t \n\tMDP_COMP_WPEI = 0,\n\tMDP_COMP_WPEO,\t\t \n\tMDP_COMP_WPEI2,\t\t \n\tMDP_COMP_WPEO2,\t\t \n\tMDP_COMP_ISP_IMGI,\t \n\tMDP_COMP_ISP_IMGO,\t \n\tMDP_COMP_ISP_IMG2O,\t \n\n\t \n\tMDP_COMP_IPUI,\t\t \n\tMDP_COMP_IPUO,\t\t \n\n\t \n\tMDP_COMP_CAMIN,\t\t \n\tMDP_COMP_CAMIN2,\t \n\tMDP_COMP_RDMA0,\t\t \n\tMDP_COMP_AAL0,\t\t \n\tMDP_COMP_CCORR0,\t \n\tMDP_COMP_RSZ0,\t\t \n\tMDP_COMP_RSZ1,\t\t \n\tMDP_COMP_TDSHP0,\t \n\tMDP_COMP_COLOR0,\t \n\tMDP_COMP_PATH0_SOUT,\t \n\tMDP_COMP_PATH1_SOUT,\t \n\tMDP_COMP_WROT0,\t\t \n\tMDP_COMP_WDMA,\t\t \n\n\t \n\tMDP_COMP_RDMA1,\t\t \n\tMDP_COMP_RSZ2,\t\t \n\tMDP_COMP_TDSHP1,\t \n\tMDP_COMP_WROT1,\t\t \n\n\tMDP_MAX_COMP_COUNT\t \n};\n\nenum mdp_comp_type {\n\tMDP_COMP_TYPE_INVALID = 0,\n\n\tMDP_COMP_TYPE_RDMA,\n\tMDP_COMP_TYPE_RSZ,\n\tMDP_COMP_TYPE_WROT,\n\tMDP_COMP_TYPE_WDMA,\n\tMDP_COMP_TYPE_PATH,\n\n\tMDP_COMP_TYPE_TDSHP,\n\tMDP_COMP_TYPE_COLOR,\n\tMDP_COMP_TYPE_DRE,\n\tMDP_COMP_TYPE_CCORR,\n\tMDP_COMP_TYPE_HDR,\n\n\tMDP_COMP_TYPE_IMGI,\n\tMDP_COMP_TYPE_WPEI,\n\tMDP_COMP_TYPE_EXTO,\t \n\tMDP_COMP_TYPE_DL_PATH,\t \n\n\tMDP_COMP_TYPE_COUNT\t \n};\n\n#define MDP_GCE_NO_EVENT (-1)\nenum {\n\tMDP_GCE_EVENT_SOF = 0,\n\tMDP_GCE_EVENT_EOF = 1,\n\tMDP_GCE_EVENT_MAX,\n};\n\nstruct mdp_comp_match {\n\tenum mdp_comp_type type;\n\tu32 alias_id;\n\ts32 inner_id;\n};\n\n \nstruct mdp_comp_info {\n\tu32 clk_num;\n\tu32 clk_ofst;\n\tu32 dts_reg_ofst;\n};\n\nstruct mdp_comp_data {\n\tstruct mdp_comp_match match;\n\tstruct mdp_comp_info info;\n};\n\nstruct mdp_comp_ops;\n\nstruct mdp_comp {\n\tstruct mdp_dev\t\t\t*mdp_dev;\n\tvoid __iomem\t\t\t*regs;\n\tphys_addr_t\t\t\treg_base;\n\tu8\t\t\t\tsubsys_id;\n\tu8\t\t\t\tclk_num;\n\tstruct clk\t\t\t**clks;\n\tstruct device\t\t\t*comp_dev;\n\tenum mdp_comp_type\t\ttype;\n\tenum mtk_mdp_comp_id\t\tpublic_id;\n\ts32\t\t\t\tinner_id;\n\tu32\t\t\t\talias_id;\n\ts32\t\t\t\tgce_event[MDP_GCE_EVENT_MAX];\n\tconst struct mdp_comp_ops\t*ops;\n};\n\nstruct mdp_comp_ctx {\n\tstruct mdp_comp\t\t\t*comp;\n\tconst struct img_compparam\t*param;\n\tconst struct img_input\t\t*input;\n\tconst struct img_output\t\t*outputs[IMG_MAX_HW_OUTPUTS];\n};\n\nstruct mdp_comp_ops {\n\ts64 (*get_comp_flag)(const struct mdp_comp_ctx *ctx);\n\tint (*init_comp)(struct mdp_comp_ctx *ctx, struct mdp_cmdq_cmd *cmd);\n\tint (*config_frame)(struct mdp_comp_ctx *ctx, struct mdp_cmdq_cmd *cmd,\n\t\t\t    const struct v4l2_rect *compose);\n\tint (*config_subfrm)(struct mdp_comp_ctx *ctx,\n\t\t\t     struct mdp_cmdq_cmd *cmd, u32 index);\n\tint (*wait_comp_event)(struct mdp_comp_ctx *ctx,\n\t\t\t       struct mdp_cmdq_cmd *cmd);\n\tint (*advance_subfrm)(struct mdp_comp_ctx *ctx,\n\t\t\t      struct mdp_cmdq_cmd *cmd, u32 index);\n\tint (*post_process)(struct mdp_comp_ctx *ctx, struct mdp_cmdq_cmd *cmd);\n};\n\nstruct mdp_dev;\n\nint mdp_comp_config(struct mdp_dev *mdp);\nvoid mdp_comp_destroy(struct mdp_dev *mdp);\nint mdp_comp_clock_on(struct device *dev, struct mdp_comp *comp);\nvoid mdp_comp_clock_off(struct device *dev, struct mdp_comp *comp);\nint mdp_comp_clocks_on(struct device *dev, struct mdp_comp *comps, int num);\nvoid mdp_comp_clocks_off(struct device *dev, struct mdp_comp *comps, int num);\nint mdp_comp_ctx_config(struct mdp_dev *mdp, struct mdp_comp_ctx *ctx,\n\t\t\tconst struct img_compparam *param,\n\t\t\tconst struct img_ipi_frameparam *frame);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}