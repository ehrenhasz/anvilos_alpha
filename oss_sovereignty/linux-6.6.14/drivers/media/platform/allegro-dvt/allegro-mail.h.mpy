{
  "module_name": "allegro-mail.h",
  "hash_id": "ce3710afcf280bfe1b281b1ba1c3bb539cfc661b2131749915216a856965bbbf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/allegro-dvt/allegro-mail.h",
  "human_readable_source": " \n \n\n#ifndef ALLEGRO_MAIL_H\n#define ALLEGRO_MAIL_H\n\n#include <linux/kernel.h>\n\nenum mcu_msg_type {\n\tMCU_MSG_TYPE_INIT = 0x0000,\n\tMCU_MSG_TYPE_CREATE_CHANNEL = 0x0005,\n\tMCU_MSG_TYPE_DESTROY_CHANNEL = 0x0006,\n\tMCU_MSG_TYPE_ENCODE_FRAME = 0x0007,\n\tMCU_MSG_TYPE_PUT_STREAM_BUFFER = 0x0012,\n\tMCU_MSG_TYPE_PUSH_BUFFER_INTERMEDIATE = 0x000e,\n\tMCU_MSG_TYPE_PUSH_BUFFER_REFERENCE = 0x000f,\n};\n\nenum mcu_msg_version {\n\tMCU_MSG_VERSION_2018_2,\n\tMCU_MSG_VERSION_2019_2,\n};\n\nconst char *msg_type_name(enum mcu_msg_type type);\n\nstruct mcu_msg_header {\n\tenum mcu_msg_type type;\n\tenum mcu_msg_version version;\n};\n\nstruct mcu_msg_init_request {\n\tstruct mcu_msg_header header;\n\tu32 reserved0;\t\t \n\tu32 suballoc_dma;\n\tu32 suballoc_size;\n\ts32 encoder_buffer_size;\n\ts32 encoder_buffer_color_depth;\n\ts32 num_cores;\n\ts32 clk_rate;\n};\n\nstruct mcu_msg_init_response {\n\tstruct mcu_msg_header header;\n\tu32 reserved0;\n};\n\nstruct create_channel_param {\n\tenum mcu_msg_version version;\n\tu32 layer_id;\n\tu16 width;\n\tu16 height;\n\tu32 videomode;\n\tu32 format;\n\tu32 colorspace;\n\tu32 src_mode;\n\tu32 src_bit_depth;\n\tu8 profile;\n\tu16 constraint_set_flags;\n\tu32 codec;\n\tu16 level;\n\tu16 tier;\n\tu32 log2_max_poc;\n\tu32 log2_max_frame_num;\n\tu32 temporal_mvp_enable;\n\tu32 enable_reordering;\n\tu32 dbf_ovr_en;\n\tu32 override_lf;\n\tu32 num_ref_idx_l0;\n\tu32 num_ref_idx_l1;\n\tu32 custom_lda;\n\tu32 rdo_cost_mode;\n\tu32 lf;\n\tu32 lf_x_tile;\n\tu32 lf_x_slice;\n\ts8 beta_offset;\n\ts8 tc_offset;\n\tu16 reserved10;\n\tu32 unknown11;\n\tu32 unknown12;\n\tu16 num_slices;\n\tu32 encoder_buffer_offset;\n\tu32 encoder_buffer_enabled;\n\tu16 clip_hrz_range;\n\tu16 clip_vrt_range;\n\tu16 me_range[4];\n\tu8 max_cu_size;\n\tu8 min_cu_size;\n\tu8 max_tu_size;\n\tu8 min_tu_size;\n\tu8 max_transfo_depth_inter;\n\tu8 max_transfo_depth_intra;\n\tu16 reserved20;\n\tu32 entropy_mode;\n\tu32 wp_mode;\n\n\t \n\tu32 rate_control_mode;\n\tu32 initial_rem_delay;\n\tu32 cpb_size;\n\tu16 framerate;\n\tu16 clk_ratio;\n\tu32 target_bitrate;\n\tu32 max_bitrate;\n\tu16 initial_qp;\n\tu16 min_qp;\n\tu16 max_qp;\n\ts16 ip_delta;\n\ts16 pb_delta;\n\tu16 golden_ref;\n\tu16 golden_delta;\n\tu16 golden_ref_frequency;\n\tu32 rate_control_option;\n\tu32 num_pixel;\n\tu16 max_psnr;\n\tu16 max_pixel_value;\n\tu32 maxpicturesize[3];\n\n\t \n\tu32 gop_ctrl_mode;\n\tu32 freq_idr;\n\tu32 freq_lt;\n\tu32 gdr_mode;\n\tu16 gop_length;\n\tu8 num_b;\n\tu8 freq_golden_ref;\n\tu32 enable_lt;\n\tu32 tmpdqp;\n\n\tu32 subframe_latency;\n\tu32 lda_control_mode;\n\tu32 unknown41;\n\n\tu32 lda_factors[6];\n\n\tu32 max_num_merge_cand;\n};\n\nstruct mcu_msg_create_channel {\n\tstruct mcu_msg_header header;\n\tu32 user_id;\n\tu32 *blob;\n\tsize_t blob_size;\n\tu32 blob_mcu_addr;\n\tu32 ep1_addr;\n};\n\nstruct mcu_msg_create_channel_response {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n\tu32 user_id;\n\tu32 options;\n\tu32 num_core;\n\tu32 num_ref_idx_l0;\n\tu32 num_ref_idx_l1;\n\tu32 int_buffers_count;\n\tu32 int_buffers_size;\n\tu32 rec_buffers_count;\n\tu32 rec_buffers_size;\n\tu32 reserved;\n\tu32 error_code;\n};\n\nstruct mcu_msg_destroy_channel {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n};\n\nstruct mcu_msg_destroy_channel_response {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n};\n\nstruct mcu_msg_push_buffers_internal_buffer {\n\tu32 dma_addr;\n\tu32 mcu_addr;\n\tu32 size;\n};\n\nstruct mcu_msg_push_buffers_internal {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n\tsize_t num_buffers;\n\tstruct mcu_msg_push_buffers_internal_buffer buffer[];\n};\n\nstruct mcu_msg_put_stream_buffer {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n\tu32 dma_addr;\n\tu32 mcu_addr;\n\tu32 size;\n\tu32 offset;\n\tu64 dst_handle;\n};\n\nstruct mcu_msg_encode_frame {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n\tu32 reserved;\n\n\tu32 encoding_options;\n#define AL_OPT_USE_QP_TABLE\t\tBIT(0)\n#define AL_OPT_FORCE_LOAD\t\tBIT(1)\n#define AL_OPT_USE_L2\t\t\tBIT(2)\n#define AL_OPT_DISABLE_INTRA\t\tBIT(3)\n#define AL_OPT_DEPENDENT_SLICES\t\tBIT(4)\n\n\ts16 pps_qp;\n\tu16 padding;\n\tu64 user_param;\n\tu64 src_handle;\n\n\tu32 request_options;\n#define AL_OPT_SCENE_CHANGE\t\tBIT(0)\n#define AL_OPT_RESTART_GOP\t\tBIT(1)\n#define AL_OPT_USE_LONG_TERM\t\tBIT(2)\n#define AL_OPT_UPDATE_PARAMS\t\tBIT(3)\n\n\t \n\t \n\t \n\t \n\tu32 src_y;\n\tu32 src_uv;\n\tu32 is_10_bit;\n\tu32 stride;\n\tu32 format;\n\tu32 ep2;\n\tu64 ep2_v;\n};\n\nstruct mcu_msg_encode_frame_response {\n\tstruct mcu_msg_header header;\n\tu32 channel_id;\n\tu64 dst_handle;\t\t \n\tu64 user_param;\t\t \n\tu64 src_handle;\t\t \n\tu16 skip;\n\tu16 is_ref;\n\tu32 initial_removal_delay;\n\tu32 dpb_output_delay;\n\tu32 size;\n\tu32 frame_tag_size;\n\ts32 stuffing;\n\ts32 filler;\n\tu16 num_column;\n\tu16 num_row;\n\tu16 qp;\n\tu8 num_ref_idx_l0;\n\tu8 num_ref_idx_l1;\n\tu32 partition_table_offset;\n\ts32 partition_table_size;\n\tu32 sum_complex;\n\ts32 tile_width[4];\n\ts32 tile_height[22];\n\tu32 error_code;\n\n\tu32 slice_type;\n#define AL_ENC_SLICE_TYPE_B             0\n#define AL_ENC_SLICE_TYPE_P             1\n#define AL_ENC_SLICE_TYPE_I             2\n\n\tu32 pic_struct;\n\tu8 is_idr;\n\tu8 is_first_slice;\n\tu8 is_last_slice;\n\tu8 reserved;\n\tu16 pps_qp;\n\tu16 reserved1;\n\tu32 reserved2;\n\tu32 reserved3;\n\tu32 reserved4;\n\tu32 reserved5;\n\tu32 reserved6;\n};\n\nunion mcu_msg_response {\n\tstruct mcu_msg_header header;\n\tstruct mcu_msg_init_response init;\n\tstruct mcu_msg_create_channel_response create_channel;\n\tstruct mcu_msg_destroy_channel_response destroy_channel;\n\tstruct mcu_msg_encode_frame_response encode_frame;\n};\n\nssize_t allegro_encode_config_blob(u32 *dst, struct create_channel_param *param);\nssize_t allegro_decode_config_blob(struct create_channel_param *param,\n\t\t\t\t   struct mcu_msg_create_channel_response *msg,\n\t\t\t\t   u32 *src);\n\nint allegro_decode_mail(void *msg, u32 *src);\nssize_t allegro_encode_mail(u32 *dst, void *msg);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}