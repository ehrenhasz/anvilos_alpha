{
  "module_name": "nal-h264.h",
  "hash_id": "8025d42b211ae6598ef878ae90aa6508eebafd014e37f06c52a496aee9107e6f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/allegro-dvt/nal-h264.h",
  "human_readable_source": " \n \n\n#ifndef __NAL_H264_H__\n#define __NAL_H264_H__\n\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/v4l2-controls.h>\n#include <linux/videodev2.h>\n\n \nstruct nal_h264_hrd_parameters {\n\tunsigned int cpb_cnt_minus1;\n\tunsigned int bit_rate_scale;\n\tunsigned int cpb_size_scale;\n\tstruct {\n\t\tint bit_rate_value_minus1[16];\n\t\tint cpb_size_value_minus1[16];\n\t\tunsigned int cbr_flag[16];\n\t};\n\tunsigned int initial_cpb_removal_delay_length_minus1;\n\tunsigned int cpb_removal_delay_length_minus1;\n\tunsigned int dpb_output_delay_length_minus1;\n\tunsigned int time_offset_length;\n};\n\n \nstruct nal_h264_vui_parameters {\n\tunsigned int aspect_ratio_info_present_flag;\n\tstruct {\n\t\tunsigned int aspect_ratio_idc;\n\t\tunsigned int sar_width;\n\t\tunsigned int sar_height;\n\t};\n\tunsigned int overscan_info_present_flag;\n\tunsigned int overscan_appropriate_flag;\n\tunsigned int video_signal_type_present_flag;\n\tstruct {\n\t\tunsigned int video_format;\n\t\tunsigned int video_full_range_flag;\n\t\tunsigned int colour_description_present_flag;\n\t\tstruct {\n\t\t\tunsigned int colour_primaries;\n\t\t\tunsigned int transfer_characteristics;\n\t\t\tunsigned int matrix_coefficients;\n\t\t};\n\t};\n\tunsigned int chroma_loc_info_present_flag;\n\tstruct {\n\t\tunsigned int chroma_sample_loc_type_top_field;\n\t\tunsigned int chroma_sample_loc_type_bottom_field;\n\t};\n\tunsigned int timing_info_present_flag;\n\tstruct {\n\t\tunsigned int num_units_in_tick;\n\t\tunsigned int time_scale;\n\t\tunsigned int fixed_frame_rate_flag;\n\t};\n\tunsigned int nal_hrd_parameters_present_flag;\n\tstruct nal_h264_hrd_parameters nal_hrd_parameters;\n\tunsigned int vcl_hrd_parameters_present_flag;\n\tstruct nal_h264_hrd_parameters vcl_hrd_parameters;\n\tunsigned int low_delay_hrd_flag;\n\tunsigned int pic_struct_present_flag;\n\tunsigned int bitstream_restriction_flag;\n\tstruct {\n\t\tunsigned int motion_vectors_over_pic_boundaries_flag;\n\t\tunsigned int max_bytes_per_pic_denom;\n\t\tunsigned int max_bits_per_mb_denom;\n\t\tunsigned int log2_max_mv_length_horizontal;\n\t\tunsigned int log21_max_mv_length_vertical;\n\t\tunsigned int max_num_reorder_frames;\n\t\tunsigned int max_dec_frame_buffering;\n\t};\n};\n\n \nstruct nal_h264_sps {\n\tunsigned int profile_idc;\n\tunsigned int constraint_set0_flag;\n\tunsigned int constraint_set1_flag;\n\tunsigned int constraint_set2_flag;\n\tunsigned int constraint_set3_flag;\n\tunsigned int constraint_set4_flag;\n\tunsigned int constraint_set5_flag;\n\tunsigned int reserved_zero_2bits;\n\tunsigned int level_idc;\n\tunsigned int seq_parameter_set_id;\n\tstruct {\n\t\tunsigned int chroma_format_idc;\n\t\tunsigned int separate_colour_plane_flag;\n\t\tunsigned int bit_depth_luma_minus8;\n\t\tunsigned int bit_depth_chroma_minus8;\n\t\tunsigned int qpprime_y_zero_transform_bypass_flag;\n\t\tunsigned int seq_scaling_matrix_present_flag;\n\t};\n\tunsigned int log2_max_frame_num_minus4;\n\tunsigned int pic_order_cnt_type;\n\tunion {\n\t\tunsigned int log2_max_pic_order_cnt_lsb_minus4;\n\t\tstruct {\n\t\t\tunsigned int delta_pic_order_always_zero_flag;\n\t\t\tint offset_for_non_ref_pic;\n\t\t\tint offset_for_top_to_bottom_field;\n\t\t\tunsigned int num_ref_frames_in_pic_order_cnt_cycle;\n\t\t\tint offset_for_ref_frame[255];\n\t\t};\n\t};\n\tunsigned int max_num_ref_frames;\n\tunsigned int gaps_in_frame_num_value_allowed_flag;\n\tunsigned int pic_width_in_mbs_minus1;\n\tunsigned int pic_height_in_map_units_minus1;\n\tunsigned int frame_mbs_only_flag;\n\tunsigned int mb_adaptive_frame_field_flag;\n\tunsigned int direct_8x8_inference_flag;\n\tunsigned int frame_cropping_flag;\n\tstruct {\n\t\tunsigned int crop_left;\n\t\tunsigned int crop_right;\n\t\tunsigned int crop_top;\n\t\tunsigned int crop_bottom;\n\t};\n\tunsigned int vui_parameters_present_flag;\n\tstruct nal_h264_vui_parameters vui;\n};\n\n \nstruct nal_h264_pps {\n\tunsigned int pic_parameter_set_id;\n\tunsigned int seq_parameter_set_id;\n\tunsigned int entropy_coding_mode_flag;\n\tunsigned int bottom_field_pic_order_in_frame_present_flag;\n\tunsigned int num_slice_groups_minus1;\n\tunsigned int slice_group_map_type;\n\tunion {\n\t\tunsigned int run_length_minus1[8];\n\t\tstruct {\n\t\t\tunsigned int top_left[8];\n\t\t\tunsigned int bottom_right[8];\n\t\t};\n\t\tstruct {\n\t\t\tunsigned int slice_group_change_direction_flag;\n\t\t\tunsigned int slice_group_change_rate_minus1;\n\t\t};\n\t\tstruct {\n\t\t\tunsigned int pic_size_in_map_units_minus1;\n\t\t\tunsigned int slice_group_id[8];\n\t\t};\n\t};\n\tunsigned int num_ref_idx_l0_default_active_minus1;\n\tunsigned int num_ref_idx_l1_default_active_minus1;\n\tunsigned int weighted_pred_flag;\n\tunsigned int weighted_bipred_idc;\n\tint pic_init_qp_minus26;\n\tint pic_init_qs_minus26;\n\tint chroma_qp_index_offset;\n\tunsigned int deblocking_filter_control_present_flag;\n\tunsigned int constrained_intra_pred_flag;\n\tunsigned int redundant_pic_cnt_present_flag;\n\tstruct {\n\t\tunsigned int transform_8x8_mode_flag;\n\t\tunsigned int pic_scaling_matrix_present_flag;\n\t\tint second_chroma_qp_index_offset;\n\t};\n};\n\n \nstatic inline int nal_h264_profile(enum v4l2_mpeg_video_h264_profile profile)\n{\n\tswitch (profile) {\n\tcase V4L2_MPEG_VIDEO_H264_PROFILE_BASELINE:\n\t\treturn 66;\n\tcase V4L2_MPEG_VIDEO_H264_PROFILE_MAIN:\n\t\treturn 77;\n\tcase V4L2_MPEG_VIDEO_H264_PROFILE_EXTENDED:\n\t\treturn 88;\n\tcase V4L2_MPEG_VIDEO_H264_PROFILE_HIGH:\n\t\treturn 100;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\n \nstatic inline int nal_h264_level(enum v4l2_mpeg_video_h264_level level)\n{\n\tswitch (level) {\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_1_0:\n\t\treturn 10;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_1B:\n\t\treturn 9;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_1_1:\n\t\treturn 11;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_1_2:\n\t\treturn 12;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_1_3:\n\t\treturn 13;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_2_0:\n\t\treturn 20;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_2_1:\n\t\treturn 21;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_2_2:\n\t\treturn 22;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_3_0:\n\t\treturn 30;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_3_1:\n\t\treturn 31;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_3_2:\n\t\treturn 32;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_4_0:\n\t\treturn 40;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_4_1:\n\t\treturn 41;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_4_2:\n\t\treturn 42;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_5_0:\n\t\treturn 50;\n\tcase V4L2_MPEG_VIDEO_H264_LEVEL_5_1:\n\t\treturn 51;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\n \nstatic inline int nal_h264_full_range(enum v4l2_quantization quantization)\n{\n\tswitch (quantization) {\n\tcase V4L2_QUANTIZATION_FULL_RANGE:\n\t\treturn 1;\n\tcase V4L2_QUANTIZATION_LIM_RANGE:\n\t\treturn 0;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n \nstatic inline int nal_h264_color_primaries(enum v4l2_colorspace colorspace)\n{\n\tswitch (colorspace) {\n\tcase V4L2_COLORSPACE_SMPTE170M:\n\t\treturn 6;\n\tcase V4L2_COLORSPACE_SMPTE240M:\n\t\treturn 7;\n\tcase V4L2_COLORSPACE_REC709:\n\t\treturn 1;\n\tcase V4L2_COLORSPACE_470_SYSTEM_M:\n\t\treturn 4;\n\tcase V4L2_COLORSPACE_JPEG:\n\tcase V4L2_COLORSPACE_SRGB:\n\tcase V4L2_COLORSPACE_470_SYSTEM_BG:\n\t\treturn 5;\n\tcase V4L2_COLORSPACE_BT2020:\n\t\treturn 9;\n\tcase V4L2_COLORSPACE_DEFAULT:\n\tcase V4L2_COLORSPACE_OPRGB:\n\tcase V4L2_COLORSPACE_RAW:\n\tcase V4L2_COLORSPACE_DCI_P3:\n\tdefault:\n\t\treturn 2;\n\t}\n}\n\n \nstatic inline int nal_h264_transfer_characteristics(enum v4l2_colorspace colorspace,\n\t\t\t\t\t\t    enum v4l2_xfer_func xfer_func)\n{\n\tif (xfer_func == V4L2_XFER_FUNC_DEFAULT)\n\t\txfer_func = V4L2_MAP_XFER_FUNC_DEFAULT(colorspace);\n\n\tswitch (xfer_func) {\n\tcase V4L2_XFER_FUNC_709:\n\t\treturn 6;\n\tcase V4L2_XFER_FUNC_SMPTE2084:\n\t\treturn 16;\n\tcase V4L2_XFER_FUNC_SRGB:\n\tcase V4L2_XFER_FUNC_OPRGB:\n\tcase V4L2_XFER_FUNC_NONE:\n\tcase V4L2_XFER_FUNC_DCI_P3:\n\tcase V4L2_XFER_FUNC_SMPTE240M:\n\tdefault:\n\t\treturn 2;\n\t}\n}\n\n \nstatic inline int nal_h264_matrix_coeffs(enum v4l2_colorspace colorspace,\n\t\t\t\t\t enum v4l2_ycbcr_encoding ycbcr_encoding)\n{\n\tif (ycbcr_encoding == V4L2_YCBCR_ENC_DEFAULT)\n\t\tycbcr_encoding = V4L2_MAP_YCBCR_ENC_DEFAULT(colorspace);\n\n\tswitch (ycbcr_encoding) {\n\tcase V4L2_YCBCR_ENC_601:\n\tcase V4L2_YCBCR_ENC_XV601:\n\t\treturn 5;\n\tcase V4L2_YCBCR_ENC_709:\n\tcase V4L2_YCBCR_ENC_XV709:\n\t\treturn 1;\n\tcase V4L2_YCBCR_ENC_BT2020:\n\t\treturn 9;\n\tcase V4L2_YCBCR_ENC_BT2020_CONST_LUM:\n\t\treturn 10;\n\tcase V4L2_YCBCR_ENC_SMPTE240M:\n\tdefault:\n\t\treturn 2;\n\t}\n}\n\nssize_t nal_h264_write_sps(const struct device *dev,\n\t\t\t   void *dest, size_t n, struct nal_h264_sps *sps);\nssize_t nal_h264_read_sps(const struct device *dev,\n\t\t\t  struct nal_h264_sps *sps, void *src, size_t n);\nvoid nal_h264_print_sps(const struct device *dev, struct nal_h264_sps *sps);\n\nssize_t nal_h264_write_pps(const struct device *dev,\n\t\t\t   void *dest, size_t n, struct nal_h264_pps *pps);\nssize_t nal_h264_read_pps(const struct device *dev,\n\t\t\t  struct nal_h264_pps *pps, void *src, size_t n);\nvoid nal_h264_print_pps(const struct device *dev, struct nal_h264_pps *pps);\n\nssize_t nal_h264_write_filler(const struct device *dev, void *dest, size_t n);\nssize_t nal_h264_read_filler(const struct device *dev, void *src, size_t n);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}