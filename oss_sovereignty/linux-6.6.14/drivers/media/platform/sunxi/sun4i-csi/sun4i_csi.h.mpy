{
  "module_name": "sun4i_csi.h",
  "hash_id": "d5a33c65adad855b03dd8c405d5c1a8a06506495c72ab56e65482e31dad8b9ed",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/sunxi/sun4i-csi/sun4i_csi.h",
  "human_readable_source": " \n \n\n#ifndef _SUN4I_CSI_H_\n#define _SUN4I_CSI_H_\n\n#include <media/media-device.h>\n#include <media/v4l2-async.h>\n#include <media/v4l2-dev.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-fwnode.h>\n#include <media/videobuf2-core.h>\n\n#define CSI_EN_REG\t\t\t0x00\n\n#define CSI_CFG_REG\t\t\t0x04\n#define CSI_CFG_INPUT_FMT(fmt)\t\t\t((fmt) << 20)\n#define CSI_CFG_OUTPUT_FMT(fmt)\t\t\t((fmt) << 16)\n#define CSI_CFG_YUV_DATA_SEQ(seq)\t\t((seq) << 8)\n#define CSI_CFG_VREF_POL(pol)\t\t\t((pol) << 2)\n#define CSI_CFG_HREF_POL(pol)\t\t\t((pol) << 1)\n#define CSI_CFG_PCLK_POL(pol)\t\t\t((pol) << 0)\n\n#define CSI_CPT_CTRL_REG\t\t0x08\n#define CSI_CPT_CTRL_VIDEO_START\t\tBIT(1)\n#define CSI_CPT_CTRL_IMAGE_START\t\tBIT(0)\n\n#define CSI_BUF_ADDR_REG(fifo, buf)\t(0x10 + (0x8 * (fifo)) + (0x4 * (buf)))\n\n#define CSI_BUF_CTRL_REG\t\t0x28\n#define CSI_BUF_CTRL_DBN\t\t\tBIT(2)\n#define CSI_BUF_CTRL_DBS\t\t\tBIT(1)\n#define CSI_BUF_CTRL_DBE\t\t\tBIT(0)\n\n#define CSI_INT_EN_REG\t\t\t0x30\n#define CSI_INT_FRM_DONE\t\t\tBIT(1)\n#define CSI_INT_CPT_DONE\t\t\tBIT(0)\n\n#define CSI_INT_STA_REG\t\t\t0x34\n\n#define CSI_WIN_CTRL_W_REG\t\t0x40\n#define CSI_WIN_CTRL_W_ACTIVE(w)\t\t((w) << 16)\n\n#define CSI_WIN_CTRL_H_REG\t\t0x44\n#define CSI_WIN_CTRL_H_ACTIVE(h)\t\t((h) << 16)\n\n#define CSI_BUF_LEN_REG\t\t\t0x48\n\n#define CSI_MAX_BUFFER\t\t2\n#define CSI_MAX_HEIGHT\t\t8192U\n#define CSI_MAX_WIDTH\t\t8192U\n\nenum csi_input {\n\tCSI_INPUT_RAW\t= 0,\n\tCSI_INPUT_BT656\t= 2,\n\tCSI_INPUT_YUV\t= 3,\n};\n\nenum csi_output_raw {\n\tCSI_OUTPUT_RAW_PASSTHROUGH = 0,\n};\n\nenum csi_output_yuv {\n\tCSI_OUTPUT_YUV_422_PLANAR\t= 0,\n\tCSI_OUTPUT_YUV_420_PLANAR\t= 1,\n\tCSI_OUTPUT_YUV_422_UV\t\t= 4,\n\tCSI_OUTPUT_YUV_420_UV\t\t= 5,\n\tCSI_OUTPUT_YUV_422_MACRO\t= 8,\n\tCSI_OUTPUT_YUV_420_MACRO\t= 9,\n};\n\nenum csi_yuv_data_seq {\n\tCSI_YUV_DATA_SEQ_YUYV\t= 0,\n\tCSI_YUV_DATA_SEQ_YVYU\t= 1,\n\tCSI_YUV_DATA_SEQ_UYVY\t= 2,\n\tCSI_YUV_DATA_SEQ_VYUY\t= 3,\n};\n\nenum csi_subdev_pads {\n\tCSI_SUBDEV_SINK,\n\tCSI_SUBDEV_SOURCE,\n\n\tCSI_SUBDEV_PADS,\n};\n\nextern const struct v4l2_subdev_ops sun4i_csi_subdev_ops;\n\nstruct sun4i_csi_format {\n\tu32\t\t\tmbus;\n\tu32\t\t\tfourcc;\n\tenum csi_input\t\tinput;\n\tu32\t\t\toutput;\n\tunsigned int\t\tnum_planes;\n\tu8\t\t\tbpp[3];\n\tunsigned int\t\thsub;\n\tunsigned int\t\tvsub;\n};\n\nconst struct sun4i_csi_format *sun4i_csi_find_format(const u32 *fourcc,\n\t\t\t\t\t\t     const u32 *mbus);\n\nstruct sun4i_csi {\n\t \n\tstruct device\t\t\t*dev;\n\n\tconst struct sun4i_csi_traits\t*traits;\n\n\tvoid __iomem\t\t\t*regs;\n\tstruct clk\t\t\t*bus_clk;\n\tstruct clk\t\t\t*isp_clk;\n\tstruct clk\t\t\t*ram_clk;\n\tstruct reset_control\t\t*rst;\n\n\tstruct vb2_v4l2_buffer\t\t*current_buf[CSI_MAX_BUFFER];\n\n\tstruct {\n\t\tsize_t\t\t\tsize;\n\t\tvoid\t\t\t*vaddr;\n\t\tdma_addr_t\t\tpaddr;\n\t} scratch;\n\n\tstruct v4l2_mbus_config_parallel\tbus;\n\n\t \n\tstruct v4l2_device\t\tv4l;\n\tstruct media_device\t\tmdev;\n\tstruct video_device\t\tvdev;\n\tstruct media_pad\t\tvdev_pad;\n\tstruct v4l2_pix_format_mplane\tfmt;\n\n\t \n\tstruct v4l2_subdev\t\tsubdev;\n\tstruct media_pad\t\tsubdev_pads[CSI_SUBDEV_PADS];\n\tstruct v4l2_mbus_framefmt\tsubdev_fmt;\n\n\t \n\tstruct v4l2_async_notifier\tnotifier;\n\tstruct v4l2_subdev\t\t*src_subdev;\n\tint\t\t\t\tsrc_pad;\n\n\t \n\tstruct mutex\t\t\tlock;\n\n\t \n\tstruct vb2_queue\t\tqueue;\n\tstruct list_head\t\tbuf_list;\n\tspinlock_t\t\t\tqlock;\n\tunsigned int\t\t\tsequence;\n};\n\nint sun4i_csi_dma_register(struct sun4i_csi *csi, int irq);\nvoid sun4i_csi_dma_unregister(struct sun4i_csi *csi);\n\nint sun4i_csi_v4l2_register(struct sun4i_csi *csi);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}