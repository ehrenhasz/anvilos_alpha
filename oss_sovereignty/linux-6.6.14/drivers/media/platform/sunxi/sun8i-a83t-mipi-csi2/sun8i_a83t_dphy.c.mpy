{
  "module_name": "sun8i_a83t_dphy.c",
  "hash_id": "2d8b7594bf357d26d420e276fc4f8f2ce10bd098639d2e3689a9169f71b94e4a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/sunxi/sun8i-a83t-mipi-csi2/sun8i_a83t_dphy.c",
  "human_readable_source": "\n \n\n#include <linux/phy/phy.h>\n#include <linux/regmap.h>\n\n#include \"sun8i_a83t_dphy.h\"\n#include \"sun8i_a83t_mipi_csi2.h\"\n\nstatic int sun8i_a83t_dphy_configure(struct phy *dphy,\n\t\t\t\t     union phy_configure_opts *opts)\n{\n\treturn phy_mipi_dphy_config_validate(&opts->mipi_dphy);\n}\n\nstatic int sun8i_a83t_dphy_power_on(struct phy *dphy)\n{\n\tstruct sun8i_a83t_mipi_csi2_device *csi2_dev = phy_get_drvdata(dphy);\n\tstruct regmap *regmap = csi2_dev->regmap;\n\n\tregmap_write(regmap, SUN8I_A83T_DPHY_CTRL_REG,\n\t\t     SUN8I_A83T_DPHY_CTRL_RESET_N |\n\t\t     SUN8I_A83T_DPHY_CTRL_SHUTDOWN_N);\n\n\tregmap_write(regmap, SUN8I_A83T_DPHY_ANA0_REG,\n\t\t     SUN8I_A83T_DPHY_ANA0_REXT_EN |\n\t\t     SUN8I_A83T_DPHY_ANA0_RINT(2) |\n\t\t     SUN8I_A83T_DPHY_ANA0_SNK(2));\n\n\treturn 0;\n};\n\nstatic int sun8i_a83t_dphy_power_off(struct phy *dphy)\n{\n\tstruct sun8i_a83t_mipi_csi2_device *csi2_dev = phy_get_drvdata(dphy);\n\tstruct regmap *regmap = csi2_dev->regmap;\n\n\tregmap_write(regmap, SUN8I_A83T_DPHY_CTRL_REG, 0);\n\n\treturn 0;\n};\n\nstatic const struct phy_ops sun8i_a83t_dphy_ops = {\n\t.configure\t= sun8i_a83t_dphy_configure,\n\t.power_on\t= sun8i_a83t_dphy_power_on,\n\t.power_off\t= sun8i_a83t_dphy_power_off,\n};\n\nint sun8i_a83t_dphy_register(struct sun8i_a83t_mipi_csi2_device *csi2_dev)\n{\n\tstruct device *dev = csi2_dev->dev;\n\tstruct phy_provider *phy_provider;\n\n\tcsi2_dev->dphy = devm_phy_create(dev, NULL, &sun8i_a83t_dphy_ops);\n\tif (IS_ERR(csi2_dev->dphy)) {\n\t\tdev_err(dev, \"failed to create D-PHY\\n\");\n\t\treturn PTR_ERR(csi2_dev->dphy);\n\t}\n\n\tphy_set_drvdata(csi2_dev->dphy, csi2_dev);\n\n\tphy_provider = devm_of_phy_provider_register(dev, of_phy_simple_xlate);\n\tif (IS_ERR(phy_provider)) {\n\t\tdev_err(dev, \"failed to register D-PHY provider\\n\");\n\t\treturn PTR_ERR(phy_provider);\n\t}\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}