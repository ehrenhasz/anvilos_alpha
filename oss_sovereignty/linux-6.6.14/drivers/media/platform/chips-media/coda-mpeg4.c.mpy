{
  "module_name": "coda-mpeg4.c",
  "hash_id": "305da9c4be92b3199ea5dce604cd103bb365a3c753ec8f2113a6274440614a97",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/chips-media/coda-mpeg4.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/videodev2.h>\n\n#include \"coda.h\"\n\nint coda_mpeg4_profile(int profile_idc)\n{\n\tswitch (profile_idc) {\n\tcase 0:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE;\n\tcase 15:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_SIMPLE;\n\tcase 2:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_PROFILE_CORE;\n\tcase 1:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE_SCALABLE;\n\tcase 11:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_CODING_EFFICIENCY;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\nint coda_mpeg4_level(int level_idc)\n{\n\tswitch (level_idc) {\n\tcase 0:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_0;\n\tcase 1:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_1;\n\tcase 2:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_2;\n\tcase 3:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_3;\n\tcase 4:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_4;\n\tcase 5:\n\t\treturn V4L2_MPEG_VIDEO_MPEG4_LEVEL_5;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\n \nu32 coda_mpeg4_parse_headers(struct coda_ctx *ctx, u8 *buf, u32 size)\n{\n\tstatic const u8 vos_start[4] = { 0x00, 0x00, 0x01, 0xb0 };\n\tstatic const union {\n\t\tu8 vo_start[4];\n\t\tu8 start_code_prefix[3];\n\t} u = { { 0x00, 0x00, 0x01, 0xb5 } };\n\n\tif (size < 30 ||\n\t    memcmp(buf, vos_start, 4) != 0 ||\n\t    memcmp(buf + 5, u.vo_start, 4) != 0)\n\t\treturn 0;\n\n\tif (size == 30 ||\n\t    (size >= 33 && memcmp(buf + 30, u.start_code_prefix, 3) == 0))\n\t\treturn 30;\n\n\tif (size == 31 ||\n\t    (size >= 34 && memcmp(buf + 31, u.start_code_prefix, 3) == 0))\n\t\treturn 31;\n\n\tif (size == 32 ||\n\t    (size >= 35 && memcmp(buf + 32, u.start_code_prefix, 3) == 0))\n\t\treturn 32;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}