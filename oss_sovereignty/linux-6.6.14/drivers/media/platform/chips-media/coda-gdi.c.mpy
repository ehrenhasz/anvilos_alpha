{
  "module_name": "coda-gdi.c",
  "hash_id": "33f94aa416fea0109019f7ba3a4120cd8ef82743d1c67e8270a3591ff8f68601",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/chips-media/coda-gdi.c",
  "human_readable_source": "\n \n\n#include <linux/bitops.h>\n#include \"coda.h\"\n\n#define XY2_INVERT\tBIT(7)\n#define XY2_ZERO\tBIT(6)\n#define XY2_TB_XOR\tBIT(5)\n#define XY2_XYSEL\tBIT(4)\n#define XY2_Y\t\t(1 << 4)\n#define XY2_X\t\t(0 << 4)\n\n#define XY2(luma_sel, luma_bit, chroma_sel, chroma_bit) \\\n\t(((XY2_##luma_sel) | (luma_bit)) << 8 | \\\n\t (XY2_##chroma_sel) | (chroma_bit))\n\nstatic const u16 xy2ca_zero_map[16] = {\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n};\n\nstatic const u16 xy2ca_tiled_map[16] = {\n\tXY2(Y,    0, Y,    0),\n\tXY2(Y,    1, Y,    1),\n\tXY2(Y,    2, Y,    2),\n\tXY2(Y,    3, X,    3),\n\tXY2(X,    3, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n\tXY2(ZERO, 0, ZERO, 0),\n};\n\n \n\n#define RBC_CA\t\t(0 << 4)\n#define RBC_BA\t\t(1 << 4)\n#define RBC_RA\t\t(2 << 4)\n#define RBC_ZERO\t(3 << 4)\n\n#define RBC(luma_sel, luma_bit, chroma_sel, chroma_bit) \\\n\t(((RBC_##luma_sel) | (luma_bit)) << 6 | \\\n\t (RBC_##chroma_sel) | (chroma_bit))\n\nstatic const u16 rbc2axi_tiled_map[32] = {\n\tRBC(ZERO, 0, ZERO, 0),\n\tRBC(ZERO, 0, ZERO, 0),\n\tRBC(ZERO, 0, ZERO, 0),\n\tRBC(CA,   0, CA,   0),\n\tRBC(CA,   1, CA,   1),\n\tRBC(CA,   2, CA,   2),\n\tRBC(CA,   3, CA,   3),\n\tRBC(CA,   4, CA,   8),\n\tRBC(CA,   8, CA,   9),\n\tRBC(CA,   9, CA,  10),\n\tRBC(CA,  10, CA,  11),\n\tRBC(CA,  11, CA,  12),\n\tRBC(CA,  12, CA,  13),\n\tRBC(CA,  13, CA,  14),\n\tRBC(CA,  14, CA,  15),\n\tRBC(CA,  15, RA,   0),\n\tRBC(RA,   0, RA,   1),\n\tRBC(RA,   1, RA,   2),\n\tRBC(RA,   2, RA,   3),\n\tRBC(RA,   3, RA,   4),\n\tRBC(RA,   4, RA,   5),\n\tRBC(RA,   5, RA,   6),\n\tRBC(RA,   6, RA,   7),\n\tRBC(RA,   7, RA,   8),\n\tRBC(RA,   8, RA,   9),\n\tRBC(RA,   9, RA,  10),\n\tRBC(RA,  10, RA,  11),\n\tRBC(RA,  11, RA,  12),\n\tRBC(RA,  12, RA,  13),\n\tRBC(RA,  13, RA,  14),\n\tRBC(RA,  14, RA,  15),\n\tRBC(RA,  15, ZERO, 0),\n};\n\nvoid coda_set_gdi_regs(struct coda_ctx *ctx)\n{\n\tstruct coda_dev *dev = ctx->dev;\n\tconst u16 *xy2ca_map;\n\tu32 xy2rbc_config;\n\tint i;\n\n\tswitch (ctx->tiled_map_type) {\n\tcase GDI_LINEAR_FRAME_MAP:\n\tdefault:\n\t\txy2ca_map = xy2ca_zero_map;\n\t\txy2rbc_config = 0;\n\t\tbreak;\n\tcase GDI_TILED_FRAME_MB_RASTER_MAP:\n\t\txy2ca_map = xy2ca_tiled_map;\n\t\txy2rbc_config = CODA9_XY2RBC_TILED_MAP |\n\t\t\t\tCODA9_XY2RBC_CA_INC_HOR |\n\t\t\t\t(16 - 1) << 12 | (8 - 1) << 4;\n\t\tbreak;\n\t}\n\n\tfor (i = 0; i < 16; i++)\n\t\tcoda_write(dev, xy2ca_map[i],\n\t\t\t\tCODA9_GDI_XY2_CAS_0 + 4 * i);\n\tfor (i = 0; i < 4; i++)\n\t\tcoda_write(dev, XY2(ZERO, 0, ZERO, 0),\n\t\t\t\tCODA9_GDI_XY2_BA_0 + 4 * i);\n\tfor (i = 0; i < 16; i++)\n\t\tcoda_write(dev, XY2(ZERO, 0, ZERO, 0),\n\t\t\t\tCODA9_GDI_XY2_RAS_0 + 4 * i);\n\tcoda_write(dev, xy2rbc_config, CODA9_GDI_XY2_RBC_CONFIG);\n\tif (xy2rbc_config) {\n\t\tfor (i = 0; i < 32; i++)\n\t\t\tcoda_write(dev, rbc2axi_tiled_map[i],\n\t\t\t\t\tCODA9_GDI_RBC2_AXI_0 + 4 * i);\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}