{
  "module_name": "bdisp.h",
  "hash_id": "b29502199b92cde598c6f6ccc962b04b7d431047af640e8382004df440f83b1f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/st/sti/bdisp/bdisp.h",
  "human_readable_source": " \n \n\n#include <linux/clk.h>\n#include <linux/ktime.h>\n#include <linux/platform_device.h>\n#include <linux/spinlock.h>\n\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-mem2mem.h>\n\n#include <media/videobuf2-dma-contig.h>\n\n#define BDISP_NAME              \"bdisp\"\n\n \n#define MAX_OUTPUT_PLANES       2\n#define MAX_VERTICAL_STRIDES    2\n#define MAX_NB_NODE             (MAX_OUTPUT_PLANES * MAX_VERTICAL_STRIDES)\n\n \nstruct bdisp_ctrls {\n\tstruct v4l2_ctrl        *hflip;\n\tstruct v4l2_ctrl        *vflip;\n};\n\n \nstruct bdisp_fmt {\n\tu32                     pixelformat;\n\tu8                      nb_planes;\n\tu8                      bpp;\n\tu8                      bpp_plane0;\n\tu8                      w_align;\n\tu8                      h_align;\n};\n\n \nstruct bdisp_frame {\n\tu32                     width;\n\tu32                     height;\n\tconst struct bdisp_fmt  *fmt;\n\tenum v4l2_field         field;\n\tu32                     bytesperline;\n\tu32                     sizeimage;\n\tenum v4l2_colorspace    colorspace;\n\tstruct v4l2_rect        crop;\n\tdma_addr_t              paddr[4];\n};\n\n \nstruct bdisp_request {\n\tstruct bdisp_frame      src;\n\tstruct bdisp_frame      dst;\n\tunsigned int            hflip:1;\n\tunsigned int            vflip:1;\n\tint                     nb_req;\n};\n\n \nstruct bdisp_ctx {\n\tstruct bdisp_frame      src;\n\tstruct bdisp_frame      dst;\n\tu32                     state;\n\tunsigned int            hflip:1;\n\tunsigned int            vflip:1;\n\tstruct bdisp_dev        *bdisp_dev;\n\tstruct bdisp_node       *node[MAX_NB_NODE];\n\tdma_addr_t              node_paddr[MAX_NB_NODE];\n\tstruct v4l2_fh          fh;\n\tstruct v4l2_ctrl_handler ctrl_handler;\n\tstruct bdisp_ctrls      bdisp_ctrls;\n\tbool                    ctrls_rdy;\n};\n\n \nstruct bdisp_m2m_device {\n\tstruct video_device     *vdev;\n\tstruct v4l2_m2m_dev     *m2m_dev;\n\tstruct bdisp_ctx        *ctx;\n\tint                     refcnt;\n};\n\n \nstruct bdisp_dbg {\n\tstruct dentry           *debugfs_entry;\n\tstruct bdisp_node       *copy_node[MAX_NB_NODE];\n\tstruct bdisp_request    copy_request;\n\tktime_t                 hw_start;\n\ts64                     last_duration;\n\ts64                     min_duration;\n\ts64                     max_duration;\n\ts64                     tot_duration;\n};\n\n \nstruct bdisp_dev {\n\tstruct v4l2_device      v4l2_dev;\n\tstruct video_device     vdev;\n\tstruct platform_device  *pdev;\n\tstruct device           *dev;\n\tspinlock_t              slock;\n\tstruct mutex            lock;\n\tu16                     id;\n\tstruct bdisp_m2m_device m2m;\n\tunsigned long           state;\n\tstruct clk              *clock;\n\tvoid __iomem            *regs;\n\twait_queue_head_t       irq_queue;\n\tstruct workqueue_struct *work_queue;\n\tstruct delayed_work     timeout_work;\n\tstruct bdisp_dbg        dbg;\n};\n\nvoid bdisp_hw_free_nodes(struct bdisp_ctx *ctx);\nint bdisp_hw_alloc_nodes(struct bdisp_ctx *ctx);\nvoid bdisp_hw_free_filters(struct device *dev);\nint bdisp_hw_alloc_filters(struct device *dev);\nint bdisp_hw_reset(struct bdisp_dev *bdisp);\nint bdisp_hw_get_and_clear_irq(struct bdisp_dev *bdisp);\nint bdisp_hw_update(struct bdisp_ctx *ctx);\n\nvoid bdisp_debugfs_remove(struct bdisp_dev *bdisp);\nvoid bdisp_debugfs_create(struct bdisp_dev *bdisp);\nvoid bdisp_dbg_perf_begin(struct bdisp_dev *bdisp);\nvoid bdisp_dbg_perf_end(struct bdisp_dev *bdisp);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}