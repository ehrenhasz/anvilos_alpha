{
  "module_name": "camss.c",
  "hash_id": "5fc31a6fcecabb533a9b4904fa0b0334d6cbba56d694438f888c394982ba79fc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/qcom/camss/camss.c",
  "human_readable_source": "\n \n#include <linux/clk.h>\n#include <linux/interconnect.h>\n#include <linux/media-bus-format.h>\n#include <linux/media.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n#include <linux/of.h>\n#include <linux/of_graph.h>\n#include <linux/pm_runtime.h>\n#include <linux/pm_domain.h>\n#include <linux/slab.h>\n#include <linux/videodev2.h>\n\n#include <media/media-device.h>\n#include <media/v4l2-async.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-mc.h>\n#include <media/v4l2-fwnode.h>\n\n#include \"camss.h\"\n\n#define CAMSS_CLOCK_MARGIN_NUMERATOR 105\n#define CAMSS_CLOCK_MARGIN_DENOMINATOR 100\n\nstatic const struct resources csiphy_res_8x16[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy0_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000 } },\n\t\t.reg = { \"csiphy0\", \"csiphy0_clk_mux\" },\n\t\t.interrupt = { \"csiphy0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy1_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000 } },\n\t\t.reg = { \"csiphy1\", \"csiphy1_clk_mux\" },\n\t\t.interrupt = { \"csiphy1\" }\n\t}\n};\n\nstatic const struct resources csid_res_8x16[] = {\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi0_ahb\", \"ahb\",\n\t\t\t   \"csi0\", \"csi0_phy\", \"csi0_pix\", \"csi0_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid0\" },\n\t\t.interrupt = { \"csid0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi1_ahb\", \"ahb\",\n\t\t\t   \"csi1\", \"csi1_phy\", \"csi1_pix\", \"csi1_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid1\" },\n\t\t.interrupt = { \"csid1\" }\n\t},\n};\n\nstatic const struct resources_ispif ispif_res_8x16 = {\n\t \n\t.clock = { \"top_ahb\", \"ahb\", \"ispif_ahb\",\n\t\t   \"csi0\", \"csi0_pix\", \"csi0_rdi\",\n\t\t   \"csi1\", \"csi1_pix\", \"csi1_rdi\" },\n\t.clock_for_reset = { \"vfe0\", \"csi_vfe0\" },\n\t.reg = { \"ispif\", \"csi_clk_mux\" },\n\t.interrupt = \"ispif\"\n\n};\n\nstatic const struct resources vfe_res_8x16[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"vfe0\", \"csi_vfe0\",\n\t\t\t   \"vfe_ahb\", \"vfe_axi\", \"ahb\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 50000000, 80000000, 100000000, 160000000,\n\t\t\t\t  177780000, 200000000, 266670000, 320000000,\n\t\t\t\t  400000000, 465000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe0\" },\n\t\t.interrupt = { \"vfe0\" }\n\t}\n};\n\nstatic const struct resources csiphy_res_8x96[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy0_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 } },\n\t\t.reg = { \"csiphy0\", \"csiphy0_clk_mux\" },\n\t\t.interrupt = { \"csiphy0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy1_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 } },\n\t\t.reg = { \"csiphy1\", \"csiphy1_clk_mux\" },\n\t\t.interrupt = { \"csiphy1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy2_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 } },\n\t\t.reg = { \"csiphy2\", \"csiphy2_clk_mux\" },\n\t\t.interrupt = { \"csiphy2\" }\n\t}\n};\n\nstatic const struct resources csid_res_8x96[] = {\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi0_ahb\", \"ahb\",\n\t\t\t   \"csi0\", \"csi0_phy\", \"csi0_pix\", \"csi0_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid0\" },\n\t\t.interrupt = { \"csid0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi1_ahb\", \"ahb\",\n\t\t\t   \"csi1\", \"csi1_phy\", \"csi1_pix\", \"csi1_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid1\" },\n\t\t.interrupt = { \"csid1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi2_ahb\", \"ahb\",\n\t\t\t   \"csi2\", \"csi2_phy\", \"csi2_pix\", \"csi2_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid2\" },\n\t\t.interrupt = { \"csid2\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi3_ahb\", \"ahb\",\n\t\t\t   \"csi3\", \"csi3_phy\", \"csi3_pix\", \"csi3_rdi\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 266666667 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid3\" },\n\t\t.interrupt = { \"csid3\" }\n\t}\n};\n\nstatic const struct resources_ispif ispif_res_8x96 = {\n\t \n\t.clock = { \"top_ahb\", \"ahb\", \"ispif_ahb\",\n\t\t   \"csi0\", \"csi0_pix\", \"csi0_rdi\",\n\t\t   \"csi1\", \"csi1_pix\", \"csi1_rdi\",\n\t\t   \"csi2\", \"csi2_pix\", \"csi2_rdi\",\n\t\t   \"csi3\", \"csi3_pix\", \"csi3_rdi\" },\n\t.clock_for_reset = { \"vfe0\", \"csi_vfe0\", \"vfe1\", \"csi_vfe1\" },\n\t.reg = { \"ispif\", \"csi_clk_mux\" },\n\t.interrupt = \"ispif\"\n};\n\nstatic const struct resources vfe_res_8x96[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ahb\", \"vfe0\", \"csi_vfe0\", \"vfe_ahb\",\n\t\t\t   \"vfe0_ahb\", \"vfe_axi\", \"vfe0_stream\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 75000000, 100000000, 300000000,\n\t\t\t\t  320000000, 480000000, 600000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe0\" },\n\t\t.interrupt = { \"vfe0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ahb\", \"vfe1\", \"csi_vfe1\", \"vfe_ahb\",\n\t\t\t   \"vfe1_ahb\", \"vfe_axi\", \"vfe1_stream\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 75000000, 100000000, 300000000,\n\t\t\t\t  320000000, 480000000, 600000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe1\" },\n\t\t.interrupt = { \"vfe1\" }\n\t}\n};\n\nstatic const struct resources csiphy_res_660[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy0_timer\",\n\t\t\t   \"csi0_phy\", \"csiphy_ahb2crif\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 269333333 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csiphy0\", \"csiphy0_clk_mux\" },\n\t\t.interrupt = { \"csiphy0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy1_timer\",\n\t\t\t   \"csi1_phy\", \"csiphy_ahb2crif\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 269333333 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csiphy1\", \"csiphy1_clk_mux\" },\n\t\t.interrupt = { \"csiphy1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"ahb\", \"csiphy2_timer\",\n\t\t\t   \"csi2_phy\", \"csiphy_ahb2crif\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 269333333 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csiphy2\", \"csiphy2_clk_mux\" },\n\t\t.interrupt = { \"csiphy2\" }\n\t}\n};\n\nstatic const struct resources csid_res_660[] = {\n\t \n\t{\n\t\t.regulators = { \"vdda\", \"vdd_sec\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi0_ahb\", \"ahb\",\n\t\t\t   \"csi0\", \"csi0_phy\", \"csi0_pix\", \"csi0_rdi\",\n\t\t\t   \"cphy_csid0\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 310000000,\n\t\t\t\t  404000000, 465000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid0\" },\n\t\t.interrupt = { \"csid0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\", \"vdd_sec\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi1_ahb\", \"ahb\",\n\t\t\t   \"csi1\", \"csi1_phy\", \"csi1_pix\", \"csi1_rdi\",\n\t\t\t   \"cphy_csid1\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 310000000,\n\t\t\t\t  404000000, 465000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid1\" },\n\t\t.interrupt = { \"csid1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\", \"vdd_sec\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi2_ahb\", \"ahb\",\n\t\t\t   \"csi2\", \"csi2_phy\", \"csi2_pix\", \"csi2_rdi\",\n\t\t\t   \"cphy_csid2\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 310000000,\n\t\t\t\t  404000000, 465000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid2\" },\n\t\t.interrupt = { \"csid2\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda\", \"vdd_sec\" },\n\t\t.clock = { \"top_ahb\", \"ispif_ahb\", \"csi3_ahb\", \"ahb\",\n\t\t\t   \"csi3\", \"csi3_phy\", \"csi3_pix\", \"csi3_rdi\",\n\t\t\t   \"cphy_csid3\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 310000000,\n\t\t\t\t  404000000, 465000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid3\" },\n\t\t.interrupt = { \"csid3\" }\n\t}\n};\n\nstatic const struct resources_ispif ispif_res_660 = {\n\t \n\t.clock = { \"top_ahb\", \"ahb\", \"ispif_ahb\",\n\t\t   \"csi0\", \"csi0_pix\", \"csi0_rdi\",\n\t\t   \"csi1\", \"csi1_pix\", \"csi1_rdi\",\n\t\t   \"csi2\", \"csi2_pix\", \"csi2_rdi\",\n\t\t   \"csi3\", \"csi3_pix\", \"csi3_rdi\" },\n\t.clock_for_reset = { \"vfe0\", \"csi_vfe0\", \"vfe1\", \"csi_vfe1\" },\n\t.reg = { \"ispif\", \"csi_clk_mux\" },\n\t.interrupt = \"ispif\"\n};\n\nstatic const struct resources vfe_res_660[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"throttle_axi\", \"top_ahb\", \"ahb\", \"vfe0\",\n\t\t\t   \"csi_vfe0\", \"vfe_ahb\", \"vfe0_ahb\", \"vfe_axi\",\n\t\t\t   \"vfe0_stream\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 120000000, 200000000, 256000000,\n\t\t\t\t  300000000, 404000000, 480000000,\n\t\t\t\t  540000000, 576000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe0\" },\n\t\t.interrupt = { \"vfe0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"throttle_axi\", \"top_ahb\", \"ahb\", \"vfe1\",\n\t\t\t   \"csi_vfe1\", \"vfe_ahb\", \"vfe1_ahb\", \"vfe_axi\",\n\t\t\t   \"vfe1_stream\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 120000000, 200000000, 256000000,\n\t\t\t\t  300000000, 404000000, 480000000,\n\t\t\t\t  540000000, 576000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe1\" },\n\t\t.interrupt = { \"vfe1\" }\n\t}\n};\n\nstatic const struct resources csiphy_res_845[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"soc_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"cpas_ahb\", \"cphy_rx_src\", \"csiphy0\",\n\t\t\t\t\"csiphy0_timer_src\", \"csiphy0_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 240000000, 269333333 } },\n\t\t.reg = { \"csiphy0\" },\n\t\t.interrupt = { \"csiphy0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"soc_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"cpas_ahb\", \"cphy_rx_src\", \"csiphy1\",\n\t\t\t\t\"csiphy1_timer_src\", \"csiphy1_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 240000000, 269333333 } },\n\t\t.reg = { \"csiphy1\" },\n\t\t.interrupt = { \"csiphy1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"soc_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"cpas_ahb\", \"cphy_rx_src\", \"csiphy2\",\n\t\t\t\t\"csiphy2_timer_src\", \"csiphy2_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 240000000, 269333333 } },\n\t\t.reg = { \"csiphy2\" },\n\t\t.interrupt = { \"csiphy2\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"soc_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"cpas_ahb\", \"cphy_rx_src\", \"csiphy3\",\n\t\t\t\t\"csiphy3_timer_src\", \"csiphy3_timer\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 240000000, 269333333 } },\n\t\t.reg = { \"csiphy3\" },\n\t\t.interrupt = { \"csiphy3\" }\n\t}\n};\n\nstatic const struct resources csid_res_845[] = {\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"cpas_ahb\", \"cphy_rx_src\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe0\", \"vfe0_src\",\n\t\t\t\t\"vfe0_cphy_rx\", \"csi0\",\n\t\t\t\t\"csi0_src\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 384000000 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"csid0\" },\n\t\t.interrupt = { \"csid0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"cpas_ahb\", \"cphy_rx_src\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe1\", \"vfe1_src\",\n\t\t\t\t\"vfe1_cphy_rx\", \"csi1\",\n\t\t\t\t\"csi1_src\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 384000000 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"csid1\" },\n\t\t.interrupt = { \"csid1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"cpas_ahb\", \"cphy_rx_src\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe_lite\", \"vfe_lite_src\",\n\t\t\t\t\"vfe_lite_cphy_rx\", \"csi2\",\n\t\t\t\t\"csi2_src\" },\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 384000000 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"csid2\" },\n\t\t.interrupt = { \"csid2\" }\n\t}\n};\n\nstatic const struct resources vfe_res_845[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"cpas_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe0\", \"vfe0_axi\",\n\t\t\t\t\"vfe0_src\", \"csi0\",\n\t\t\t\t\"csi0_src\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"vfe0\" },\n\t\t.interrupt = { \"vfe0\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"cpas_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe1\", \"vfe1_axi\",\n\t\t\t\t\"vfe1_src\", \"csi1\",\n\t\t\t\t\"csi1_src\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"vfe1\" },\n\t\t.interrupt = { \"vfe1\" }\n\t},\n\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi\", \"cpas_ahb\", \"slow_ahb_src\",\n\t\t\t\t\"soc_ahb\", \"vfe_lite\",\n\t\t\t\t\"vfe_lite_src\", \"csi2\",\n\t\t\t\t\"csi2_src\"},\n\t\t.clock_rate = { { 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 80000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 19200000, 100000000, 320000000, 404000000, 480000000, 600000000 },\n\t\t\t\t{ 320000000 },\n\t\t\t\t{ 19200000, 75000000, 384000000, 538666667 },\n\t\t\t\t{ 384000000 } },\n\t\t.reg = { \"vfe_lite\" },\n\t\t.interrupt = { \"vfe_lite\" }\n\t}\n};\n\nstatic const struct resources csiphy_res_8250[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy0\", \"csiphy0_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy0\" },\n\t\t.interrupt = { \"csiphy0\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy1\", \"csiphy1_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy1\" },\n\t\t.interrupt = { \"csiphy1\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy2\", \"csiphy2_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy2\" },\n\t\t.interrupt = { \"csiphy2\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy3\", \"csiphy3_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy3\" },\n\t\t.interrupt = { \"csiphy3\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy4\", \"csiphy4_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy4\" },\n\t\t.interrupt = { \"csiphy4\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"csiphy5\", \"csiphy5_timer\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 300000000 } },\n\t\t.reg = { \"csiphy5\" },\n\t\t.interrupt = { \"csiphy5\" }\n\t}\n};\n\nstatic const struct resources csid_res_8250[] = {\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"vfe0_csid\", \"vfe0_cphy_rx\", \"vfe0\", \"vfe0_areg\", \"vfe0_ahb\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 400000000 },\n\t\t\t\t{ 350000000, 475000000, 576000000, 720000000 },\n\t\t\t\t{ 100000000, 200000000, 300000000, 400000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid0\" },\n\t\t.interrupt = { \"csid0\" }\n\t},\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"vfe1_csid\", \"vfe1_cphy_rx\", \"vfe1\", \"vfe1_areg\", \"vfe1_ahb\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 400000000 },\n\t\t\t\t{ 350000000, 475000000, 576000000, 720000000 },\n\t\t\t\t{ 100000000, 200000000, 300000000, 400000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid1\" },\n\t\t.interrupt = { \"csid1\" }\n\t},\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"vfe_lite_csid\", \"vfe_lite_cphy_rx\", \"vfe_lite\",  \"vfe_lite_ahb\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 400000000 },\n\t\t\t\t{ 400000000, 480000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid2\" },\n\t\t.interrupt = { \"csid2\" }\n\t},\n\t \n\t{\n\t\t.regulators = { \"vdda-phy\", \"vdda-pll\" },\n\t\t.clock = { \"vfe_lite_csid\", \"vfe_lite_cphy_rx\", \"vfe_lite\",  \"vfe_lite_ahb\" },\n\t\t.clock_rate = { { 400000000 },\n\t\t\t\t{ 400000000 },\n\t\t\t\t{ 400000000, 480000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"csid3\" },\n\t\t.interrupt = { \"csid3\" }\n\t}\n};\n\nstatic const struct resources vfe_res_8250[] = {\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi_src\", \"slow_ahb_src\", \"cpas_ahb\",\n\t\t\t   \"camnoc_axi\", \"vfe0_ahb\", \"vfe0_areg\", \"vfe0\",\n\t\t\t   \"vfe0_axi\", \"cam_hf_axi\" },\n\t\t.clock_rate = { { 19200000, 300000000, 400000000, 480000000 },\n\t\t\t\t{ 19200000, 80000000 },\n\t\t\t\t{ 19200000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 300000000, 400000000 },\n\t\t\t\t{ 350000000, 475000000, 576000000, 720000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe0\" },\n\t\t.interrupt = { \"vfe0\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi_src\", \"slow_ahb_src\", \"cpas_ahb\",\n\t\t\t   \"camnoc_axi\", \"vfe1_ahb\", \"vfe1_areg\", \"vfe1\",\n\t\t\t   \"vfe1_axi\", \"cam_hf_axi\" },\n\t\t.clock_rate = { { 19200000, 300000000, 400000000, 480000000 },\n\t\t\t\t{ 19200000, 80000000 },\n\t\t\t\t{ 19200000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 100000000, 200000000, 300000000, 400000000 },\n\t\t\t\t{ 350000000, 475000000, 576000000, 720000000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe1\" },\n\t\t.interrupt = { \"vfe1\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi_src\", \"slow_ahb_src\", \"cpas_ahb\",\n\t\t\t   \"camnoc_axi\", \"vfe_lite_ahb\", \"vfe_lite_axi\",\n\t\t\t   \"vfe_lite\", \"cam_hf_axi\" },\n\t\t.clock_rate = { { 19200000, 300000000, 400000000, 480000000 },\n\t\t\t\t{ 19200000, 80000000 },\n\t\t\t\t{ 19200000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 400000000, 480000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe_lite0\" },\n\t\t.interrupt = { \"vfe_lite0\" }\n\t},\n\t \n\t{\n\t\t.regulators = {},\n\t\t.clock = { \"camnoc_axi_src\", \"slow_ahb_src\", \"cpas_ahb\",\n\t\t\t   \"camnoc_axi\", \"vfe_lite_ahb\", \"vfe_lite_axi\",\n\t\t\t   \"vfe_lite\", \"cam_hf_axi\" },\n\t\t.clock_rate = { { 19200000, 300000000, 400000000, 480000000 },\n\t\t\t\t{ 19200000, 80000000 },\n\t\t\t\t{ 19200000 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 0 },\n\t\t\t\t{ 400000000, 480000000 },\n\t\t\t\t{ 0 } },\n\t\t.reg = { \"vfe_lite1\" },\n\t\t.interrupt = { \"vfe_lite1\" }\n\t},\n};\n\nstatic const struct resources_icc icc_res_sm8250[] = {\n\t{\n\t\t.name = \"cam_ahb\",\n\t\t.icc_bw_tbl.avg = 38400,\n\t\t.icc_bw_tbl.peak = 76800,\n\t},\n\t{\n\t\t.name = \"cam_hf_0_mnoc\",\n\t\t.icc_bw_tbl.avg = 2097152,\n\t\t.icc_bw_tbl.peak = 2097152,\n\t},\n\t{\n\t\t.name = \"cam_sf_0_mnoc\",\n\t\t.icc_bw_tbl.avg = 0,\n\t\t.icc_bw_tbl.peak = 2097152,\n\t},\n\t{\n\t\t.name = \"cam_sf_icp_mnoc\",\n\t\t.icc_bw_tbl.avg = 2097152,\n\t\t.icc_bw_tbl.peak = 2097152,\n\t},\n};\n\n \ninline void camss_add_clock_margin(u64 *rate)\n{\n\t*rate *= CAMSS_CLOCK_MARGIN_NUMERATOR;\n\t*rate = div_u64(*rate, CAMSS_CLOCK_MARGIN_DENOMINATOR);\n}\n\n \nint camss_enable_clocks(int nclocks, struct camss_clock *clock,\n\t\t\tstruct device *dev)\n{\n\tint ret;\n\tint i;\n\n\tfor (i = 0; i < nclocks; i++) {\n\t\tret = clk_prepare_enable(clock[i].clk);\n\t\tif (ret) {\n\t\t\tdev_err(dev, \"clock enable failed: %d\\n\", ret);\n\t\t\tgoto error;\n\t\t}\n\t}\n\n\treturn 0;\n\nerror:\n\tfor (i--; i >= 0; i--)\n\t\tclk_disable_unprepare(clock[i].clk);\n\n\treturn ret;\n}\n\n \nvoid camss_disable_clocks(int nclocks, struct camss_clock *clock)\n{\n\tint i;\n\n\tfor (i = nclocks - 1; i >= 0; i--)\n\t\tclk_disable_unprepare(clock[i].clk);\n}\n\n \nstruct media_entity *camss_find_sensor(struct media_entity *entity)\n{\n\tstruct media_pad *pad;\n\n\twhile (1) {\n\t\tpad = &entity->pads[0];\n\t\tif (!(pad->flags & MEDIA_PAD_FL_SINK))\n\t\t\treturn NULL;\n\n\t\tpad = media_pad_remote_pad_first(pad);\n\t\tif (!pad || !is_media_entity_v4l2_subdev(pad->entity))\n\t\t\treturn NULL;\n\n\t\tentity = pad->entity;\n\n\t\tif (entity->function == MEDIA_ENT_F_CAM_SENSOR)\n\t\t\treturn entity;\n\t}\n}\n\n \ns64 camss_get_link_freq(struct media_entity *entity, unsigned int bpp,\n\t\t\tunsigned int lanes)\n{\n\tstruct media_entity *sensor;\n\tstruct v4l2_subdev *subdev;\n\n\tsensor = camss_find_sensor(entity);\n\tif (!sensor)\n\t\treturn -ENODEV;\n\n\tsubdev = media_entity_to_v4l2_subdev(sensor);\n\n\treturn v4l2_get_link_freq(subdev->ctrl_handler, bpp, 2 * lanes);\n}\n\n \nint camss_get_pixel_clock(struct media_entity *entity, u64 *pixel_clock)\n{\n\tstruct media_entity *sensor;\n\tstruct v4l2_subdev *subdev;\n\tstruct v4l2_ctrl *ctrl;\n\n\tsensor = camss_find_sensor(entity);\n\tif (!sensor)\n\t\treturn -ENODEV;\n\n\tsubdev = media_entity_to_v4l2_subdev(sensor);\n\n\tctrl = v4l2_ctrl_find(subdev->ctrl_handler, V4L2_CID_PIXEL_RATE);\n\n\tif (!ctrl)\n\t\treturn -EINVAL;\n\n\t*pixel_clock = v4l2_ctrl_g_ctrl_int64(ctrl);\n\n\treturn 0;\n}\n\nint camss_pm_domain_on(struct camss *camss, int id)\n{\n\tint ret = 0;\n\n\tif (id < camss->vfe_num) {\n\t\tstruct vfe_device *vfe = &camss->vfe[id];\n\n\t\tret = vfe->ops->pm_domain_on(vfe);\n\t}\n\n\treturn ret;\n}\n\nvoid camss_pm_domain_off(struct camss *camss, int id)\n{\n\tif (id < camss->vfe_num) {\n\t\tstruct vfe_device *vfe = &camss->vfe[id];\n\n\t\tvfe->ops->pm_domain_off(vfe);\n\t}\n}\n\n \nstatic int camss_of_parse_endpoint_node(struct device *dev,\n\t\t\t\t\tstruct device_node *node,\n\t\t\t\t\tstruct camss_async_subdev *csd)\n{\n\tstruct csiphy_lanes_cfg *lncfg = &csd->interface.csi2.lane_cfg;\n\tstruct v4l2_mbus_config_mipi_csi2 *mipi_csi2;\n\tstruct v4l2_fwnode_endpoint vep = { { 0 } };\n\tunsigned int i;\n\n\tv4l2_fwnode_endpoint_parse(of_fwnode_handle(node), &vep);\n\n\tcsd->interface.csiphy_id = vep.base.port;\n\n\tmipi_csi2 = &vep.bus.mipi_csi2;\n\tlncfg->clk.pos = mipi_csi2->clock_lane;\n\tlncfg->clk.pol = mipi_csi2->lane_polarities[0];\n\tlncfg->num_data = mipi_csi2->num_data_lanes;\n\n\tlncfg->data = devm_kcalloc(dev,\n\t\t\t\t   lncfg->num_data, sizeof(*lncfg->data),\n\t\t\t\t   GFP_KERNEL);\n\tif (!lncfg->data)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < lncfg->num_data; i++) {\n\t\tlncfg->data[i].pos = mipi_csi2->data_lanes[i];\n\t\tlncfg->data[i].pol = mipi_csi2->lane_polarities[i + 1];\n\t}\n\n\treturn 0;\n}\n\n \nstatic int camss_of_parse_ports(struct camss *camss)\n{\n\tstruct device *dev = camss->dev;\n\tstruct device_node *node = NULL;\n\tstruct device_node *remote = NULL;\n\tint ret, num_subdevs = 0;\n\n\tfor_each_endpoint_of_node(dev->of_node, node) {\n\t\tstruct camss_async_subdev *csd;\n\n\t\tif (!of_device_is_available(node))\n\t\t\tcontinue;\n\n\t\tremote = of_graph_get_remote_port_parent(node);\n\t\tif (!remote) {\n\t\t\tdev_err(dev, \"Cannot get remote parent\\n\");\n\t\t\tret = -EINVAL;\n\t\t\tgoto err_cleanup;\n\t\t}\n\n\t\tcsd = v4l2_async_nf_add_fwnode(&camss->notifier,\n\t\t\t\t\t       of_fwnode_handle(remote),\n\t\t\t\t\t       struct camss_async_subdev);\n\t\tof_node_put(remote);\n\t\tif (IS_ERR(csd)) {\n\t\t\tret = PTR_ERR(csd);\n\t\t\tgoto err_cleanup;\n\t\t}\n\n\t\tret = camss_of_parse_endpoint_node(dev, node, csd);\n\t\tif (ret < 0)\n\t\t\tgoto err_cleanup;\n\n\t\tnum_subdevs++;\n\t}\n\n\treturn num_subdevs;\n\nerr_cleanup:\n\tof_node_put(node);\n\treturn ret;\n}\n\n \nstatic int camss_init_subdevices(struct camss *camss)\n{\n\tconst struct resources *csiphy_res;\n\tconst struct resources *csid_res;\n\tconst struct resources_ispif *ispif_res;\n\tconst struct resources *vfe_res;\n\tunsigned int i;\n\tint ret;\n\n\tif (camss->version == CAMSS_8x16) {\n\t\tcsiphy_res = csiphy_res_8x16;\n\t\tcsid_res = csid_res_8x16;\n\t\tispif_res = &ispif_res_8x16;\n\t\tvfe_res = vfe_res_8x16;\n\t} else if (camss->version == CAMSS_8x96) {\n\t\tcsiphy_res = csiphy_res_8x96;\n\t\tcsid_res = csid_res_8x96;\n\t\tispif_res = &ispif_res_8x96;\n\t\tvfe_res = vfe_res_8x96;\n\t} else if (camss->version == CAMSS_660) {\n\t\tcsiphy_res = csiphy_res_660;\n\t\tcsid_res = csid_res_660;\n\t\tispif_res = &ispif_res_660;\n\t\tvfe_res = vfe_res_660;\n\t}  else if (camss->version == CAMSS_845) {\n\t\tcsiphy_res = csiphy_res_845;\n\t\tcsid_res = csid_res_845;\n\t\t \n\t\tispif_res = NULL;\n\t\tvfe_res = vfe_res_845;\n\t} else if (camss->version == CAMSS_8250) {\n\t\tcsiphy_res = csiphy_res_8250;\n\t\tcsid_res = csid_res_8250;\n\t\t \n\t\tispif_res = NULL;\n\t\tvfe_res = vfe_res_8250;\n\t} else {\n\t\treturn -EINVAL;\n\t}\n\n\tfor (i = 0; i < camss->csiphy_num; i++) {\n\t\tret = msm_csiphy_subdev_init(camss, &camss->csiphy[i],\n\t\t\t\t\t     &csiphy_res[i], i);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Failed to init csiphy%d sub-device: %d\\n\",\n\t\t\t\ti, ret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\t \n\tfor (i = 0; i < camss->vfe_num + camss->vfe_lite_num; i++) {\n\t\tret = msm_vfe_subdev_init(camss, &camss->vfe[i],\n\t\t\t\t\t  &vfe_res[i], i);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Fail to init vfe%d sub-device: %d\\n\", i, ret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tfor (i = 0; i < camss->csid_num; i++) {\n\t\tret = msm_csid_subdev_init(camss, &camss->csid[i],\n\t\t\t\t\t   &csid_res[i], i);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Failed to init csid%d sub-device: %d\\n\",\n\t\t\t\ti, ret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tret = msm_ispif_subdev_init(camss, ispif_res);\n\tif (ret < 0) {\n\t\tdev_err(camss->dev, \"Failed to init ispif sub-device: %d\\n\",\n\t\tret);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\n \nstatic int camss_register_entities(struct camss *camss)\n{\n\tint i, j, k;\n\tint ret;\n\n\tfor (i = 0; i < camss->csiphy_num; i++) {\n\t\tret = msm_csiphy_register_entity(&camss->csiphy[i],\n\t\t\t\t\t\t &camss->v4l2_dev);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Failed to register csiphy%d entity: %d\\n\",\n\t\t\t\ti, ret);\n\t\t\tgoto err_reg_csiphy;\n\t\t}\n\t}\n\n\tfor (i = 0; i < camss->csid_num; i++) {\n\t\tret = msm_csid_register_entity(&camss->csid[i],\n\t\t\t\t\t       &camss->v4l2_dev);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Failed to register csid%d entity: %d\\n\",\n\t\t\t\ti, ret);\n\t\t\tgoto err_reg_csid;\n\t\t}\n\t}\n\n\tret = msm_ispif_register_entities(camss->ispif,\n\t\t\t\t\t  &camss->v4l2_dev);\n\tif (ret < 0) {\n\t\tdev_err(camss->dev, \"Failed to register ispif entities: %d\\n\",\n\t\tret);\n\t\tgoto err_reg_ispif;\n\t}\n\n\tfor (i = 0; i < camss->vfe_num + camss->vfe_lite_num; i++) {\n\t\tret = msm_vfe_register_entities(&camss->vfe[i],\n\t\t\t\t\t\t&camss->v4l2_dev);\n\t\tif (ret < 0) {\n\t\t\tdev_err(camss->dev,\n\t\t\t\t\"Failed to register vfe%d entities: %d\\n\",\n\t\t\t\ti, ret);\n\t\t\tgoto err_reg_vfe;\n\t\t}\n\t}\n\n\tfor (i = 0; i < camss->csiphy_num; i++) {\n\t\tfor (j = 0; j < camss->csid_num; j++) {\n\t\t\tret = media_create_pad_link(\n\t\t\t\t&camss->csiphy[i].subdev.entity,\n\t\t\t\tMSM_CSIPHY_PAD_SRC,\n\t\t\t\t&camss->csid[j].subdev.entity,\n\t\t\t\tMSM_CSID_PAD_SINK,\n\t\t\t\t0);\n\t\t\tif (ret < 0) {\n\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\"Failed to link %s->%s entities: %d\\n\",\n\t\t\t\t\tcamss->csiphy[i].subdev.entity.name,\n\t\t\t\t\tcamss->csid[j].subdev.entity.name,\n\t\t\t\t\tret);\n\t\t\t\tgoto err_link;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (camss->ispif) {\n\t\tfor (i = 0; i < camss->csid_num; i++) {\n\t\t\tfor (j = 0; j < camss->ispif->line_num; j++) {\n\t\t\t\tret = media_create_pad_link(\n\t\t\t\t\t&camss->csid[i].subdev.entity,\n\t\t\t\t\tMSM_CSID_PAD_SRC,\n\t\t\t\t\t&camss->ispif->line[j].subdev.entity,\n\t\t\t\t\tMSM_ISPIF_PAD_SINK,\n\t\t\t\t\t0);\n\t\t\t\tif (ret < 0) {\n\t\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\t\"Failed to link %s->%s entities: %d\\n\",\n\t\t\t\t\t\tcamss->csid[i].subdev.entity.name,\n\t\t\t\t\t\tcamss->ispif->line[j].subdev.entity.name,\n\t\t\t\t\t\tret);\n\t\t\t\t\tgoto err_link;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < camss->ispif->line_num; i++)\n\t\t\tfor (k = 0; k < camss->vfe_num; k++)\n\t\t\t\tfor (j = 0; j < camss->vfe[k].line_num; j++) {\n\t\t\t\t\tstruct v4l2_subdev *ispif = &camss->ispif->line[i].subdev;\n\t\t\t\t\tstruct v4l2_subdev *vfe = &camss->vfe[k].line[j].subdev;\n\n\t\t\t\t\tret = media_create_pad_link(&ispif->entity,\n\t\t\t\t\t\t\t\t    MSM_ISPIF_PAD_SRC,\n\t\t\t\t\t\t\t\t    &vfe->entity,\n\t\t\t\t\t\t\t\t    MSM_VFE_PAD_SINK,\n\t\t\t\t\t\t\t\t    0);\n\t\t\t\t\tif (ret < 0) {\n\t\t\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\t\t\"Failed to link %s->%s entities: %d\\n\",\n\t\t\t\t\t\t\tispif->entity.name,\n\t\t\t\t\t\t\tvfe->entity.name,\n\t\t\t\t\t\t\tret);\n\t\t\t\t\t\tgoto err_link;\n\t\t\t\t\t}\n\t\t\t\t}\n\t} else {\n\t\tfor (i = 0; i < camss->csid_num; i++)\n\t\t\tfor (k = 0; k < camss->vfe_num + camss->vfe_lite_num; k++)\n\t\t\t\tfor (j = 0; j < camss->vfe[k].line_num; j++) {\n\t\t\t\t\tstruct v4l2_subdev *csid = &camss->csid[i].subdev;\n\t\t\t\t\tstruct v4l2_subdev *vfe = &camss->vfe[k].line[j].subdev;\n\n\t\t\t\t\tret = media_create_pad_link(&csid->entity,\n\t\t\t\t\t\t\t\t    MSM_CSID_PAD_FIRST_SRC + j,\n\t\t\t\t\t\t\t\t    &vfe->entity,\n\t\t\t\t\t\t\t\t    MSM_VFE_PAD_SINK,\n\t\t\t\t\t\t\t\t    0);\n\t\t\t\t\tif (ret < 0) {\n\t\t\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\t\t\"Failed to link %s->%s entities: %d\\n\",\n\t\t\t\t\t\t\tcsid->entity.name,\n\t\t\t\t\t\t\tvfe->entity.name,\n\t\t\t\t\t\t\tret);\n\t\t\t\t\t\tgoto err_link;\n\t\t\t\t\t}\n\t\t\t\t}\n\t}\n\n\treturn 0;\n\nerr_link:\n\ti = camss->vfe_num + camss->vfe_lite_num;\nerr_reg_vfe:\n\tfor (i--; i >= 0; i--)\n\t\tmsm_vfe_unregister_entities(&camss->vfe[i]);\n\nerr_reg_ispif:\n\tmsm_ispif_unregister_entities(camss->ispif);\n\n\ti = camss->csid_num;\nerr_reg_csid:\n\tfor (i--; i >= 0; i--)\n\t\tmsm_csid_unregister_entity(&camss->csid[i]);\n\n\ti = camss->csiphy_num;\nerr_reg_csiphy:\n\tfor (i--; i >= 0; i--)\n\t\tmsm_csiphy_unregister_entity(&camss->csiphy[i]);\n\n\treturn ret;\n}\n\n \nstatic void camss_unregister_entities(struct camss *camss)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < camss->csiphy_num; i++)\n\t\tmsm_csiphy_unregister_entity(&camss->csiphy[i]);\n\n\tfor (i = 0; i < camss->csid_num; i++)\n\t\tmsm_csid_unregister_entity(&camss->csid[i]);\n\n\tmsm_ispif_unregister_entities(camss->ispif);\n\n\tfor (i = 0; i < camss->vfe_num + camss->vfe_lite_num; i++)\n\t\tmsm_vfe_unregister_entities(&camss->vfe[i]);\n}\n\nstatic int camss_subdev_notifier_bound(struct v4l2_async_notifier *async,\n\t\t\t\t       struct v4l2_subdev *subdev,\n\t\t\t\t       struct v4l2_async_connection *asd)\n{\n\tstruct camss *camss = container_of(async, struct camss, notifier);\n\tstruct camss_async_subdev *csd =\n\t\tcontainer_of(asd, struct camss_async_subdev, asd);\n\tu8 id = csd->interface.csiphy_id;\n\tstruct csiphy_device *csiphy = &camss->csiphy[id];\n\n\tcsiphy->cfg.csi2 = &csd->interface.csi2;\n\tsubdev->host_priv = csiphy;\n\n\treturn 0;\n}\n\nstatic int camss_subdev_notifier_complete(struct v4l2_async_notifier *async)\n{\n\tstruct camss *camss = container_of(async, struct camss, notifier);\n\tstruct v4l2_device *v4l2_dev = &camss->v4l2_dev;\n\tstruct v4l2_subdev *sd;\n\tint ret;\n\n\tlist_for_each_entry(sd, &v4l2_dev->subdevs, list) {\n\t\tif (sd->host_priv) {\n\t\t\tstruct media_entity *sensor = &sd->entity;\n\t\t\tstruct csiphy_device *csiphy =\n\t\t\t\t\t(struct csiphy_device *) sd->host_priv;\n\t\t\tstruct media_entity *input = &csiphy->subdev.entity;\n\t\t\tunsigned int i;\n\n\t\t\tfor (i = 0; i < sensor->num_pads; i++) {\n\t\t\t\tif (sensor->pads[i].flags & MEDIA_PAD_FL_SOURCE)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (i == sensor->num_pads) {\n\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\"No source pad in external entity\\n\");\n\t\t\t\treturn -EINVAL;\n\t\t\t}\n\n\t\t\tret = media_create_pad_link(sensor, i,\n\t\t\t\tinput, MSM_CSIPHY_PAD_SINK,\n\t\t\t\tMEDIA_LNK_FL_IMMUTABLE | MEDIA_LNK_FL_ENABLED);\n\t\t\tif (ret < 0) {\n\t\t\t\tdev_err(camss->dev,\n\t\t\t\t\t\"Failed to link %s->%s entities: %d\\n\",\n\t\t\t\t\tsensor->name, input->name, ret);\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\t}\n\n\tret = v4l2_device_register_subdev_nodes(&camss->v4l2_dev);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn media_device_register(&camss->media_dev);\n}\n\nstatic const struct v4l2_async_notifier_operations camss_subdev_notifier_ops = {\n\t.bound = camss_subdev_notifier_bound,\n\t.complete = camss_subdev_notifier_complete,\n};\n\nstatic const struct media_device_ops camss_media_ops = {\n\t.link_notify = v4l2_pipeline_link_notify,\n};\n\nstatic int camss_configure_pd(struct camss *camss)\n{\n\tstruct device *dev = camss->dev;\n\tint i;\n\tint ret;\n\n\tcamss->genpd_num = of_count_phandle_with_args(dev->of_node,\n\t\t\t\t\t\t      \"power-domains\",\n\t\t\t\t\t\t      \"#power-domain-cells\");\n\tif (camss->genpd_num < 0) {\n\t\tdev_err(dev, \"Power domains are not defined for camss\\n\");\n\t\treturn camss->genpd_num;\n\t}\n\n\t \n\tif (camss->genpd_num == 1)\n\t\treturn 0;\n\n\tcamss->genpd = devm_kmalloc_array(dev, camss->genpd_num,\n\t\t\t\t\t  sizeof(*camss->genpd), GFP_KERNEL);\n\tif (!camss->genpd)\n\t\treturn -ENOMEM;\n\n\tcamss->genpd_link = devm_kmalloc_array(dev, camss->genpd_num,\n\t\t\t\t\t       sizeof(*camss->genpd_link),\n\t\t\t\t\t       GFP_KERNEL);\n\tif (!camss->genpd_link)\n\t\treturn -ENOMEM;\n\n\t \n\tfor (i = 0; i < camss->genpd_num; i++) {\n\t\tcamss->genpd[i] = dev_pm_domain_attach_by_id(camss->dev, i);\n\t\tif (IS_ERR(camss->genpd[i])) {\n\t\t\tret = PTR_ERR(camss->genpd[i]);\n\t\t\tgoto fail_pm;\n\t\t}\n\t}\n\n\tif (i > camss->vfe_num) {\n\t\tcamss->genpd_link[i - 1] = device_link_add(camss->dev, camss->genpd[i - 1],\n\t\t\t\t\t\t\t   DL_FLAG_STATELESS | DL_FLAG_PM_RUNTIME |\n\t\t\t\t\t\t\t   DL_FLAG_RPM_ACTIVE);\n\t\tif (!camss->genpd_link[i - 1]) {\n\t\t\tret = -EINVAL;\n\t\t\tgoto fail_pm;\n\t\t}\n\t}\n\n\treturn 0;\n\nfail_pm:\n\tfor (--i ; i >= 0; i--)\n\t\tdev_pm_domain_detach(camss->genpd[i], true);\n\n\treturn ret;\n}\n\nstatic int camss_icc_get(struct camss *camss)\n{\n\tconst struct resources_icc *icc_res;\n\tint nbr_icc_paths = 0;\n\tint i;\n\n\tif (camss->version == CAMSS_8250) {\n\t\ticc_res = &icc_res_sm8250[0];\n\t\tnbr_icc_paths =\tICC_SM8250_COUNT;\n\t}\n\n\tfor (i = 0; i < nbr_icc_paths; i++) {\n\t\tcamss->icc_path[i] = devm_of_icc_get(camss->dev,\n\t\t\t\t\t\t     icc_res[i].name);\n\t\tif (IS_ERR(camss->icc_path[i]))\n\t\t\treturn PTR_ERR(camss->icc_path[i]);\n\n\t\tcamss->icc_bw_tbl[i] = icc_res[i].icc_bw_tbl;\n\t}\n\n\treturn 0;\n}\n\nstatic void camss_genpd_cleanup(struct camss *camss)\n{\n\tint i;\n\n\tif (camss->genpd_num == 1)\n\t\treturn;\n\n\tif (camss->genpd_num > camss->vfe_num)\n\t\tdevice_link_del(camss->genpd_link[camss->genpd_num - 1]);\n\n\tfor (i = 0; i < camss->genpd_num; i++)\n\t\tdev_pm_domain_detach(camss->genpd[i], true);\n}\n\n \nstatic int camss_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct camss *camss;\n\tint num_subdevs, ret;\n\n\tcamss = devm_kzalloc(dev, sizeof(*camss), GFP_KERNEL);\n\tif (!camss)\n\t\treturn -ENOMEM;\n\n\tatomic_set(&camss->ref_count, 0);\n\tcamss->dev = dev;\n\tplatform_set_drvdata(pdev, camss);\n\n\tif (of_device_is_compatible(dev->of_node, \"qcom,msm8916-camss\")) {\n\t\tcamss->version = CAMSS_8x16;\n\t\tcamss->csiphy_num = 2;\n\t\tcamss->csid_num = 2;\n\t\tcamss->vfe_num = 1;\n\t} else if (of_device_is_compatible(dev->of_node,\n\t\t\t\t\t   \"qcom,msm8996-camss\")) {\n\t\tcamss->version = CAMSS_8x96;\n\t\tcamss->csiphy_num = 3;\n\t\tcamss->csid_num = 4;\n\t\tcamss->vfe_num = 2;\n\t} else if (of_device_is_compatible(dev->of_node,\n\t\t\t\t\t   \"qcom,sdm660-camss\")) {\n\t\tcamss->version = CAMSS_660;\n\t\tcamss->csiphy_num = 3;\n\t\tcamss->csid_num = 4;\n\t\tcamss->vfe_num = 2;\n\t} else if (of_device_is_compatible(dev->of_node,\n\t\t\t\t\t   \"qcom,sdm845-camss\")) {\n\t\tcamss->version = CAMSS_845;\n\t\tcamss->csiphy_num = 4;\n\t\tcamss->csid_num = 3;\n\t\tcamss->vfe_num = 2;\n\t\tcamss->vfe_lite_num = 1;\n\t} else if (of_device_is_compatible(dev->of_node,\n\t\t\t\t\t   \"qcom,sm8250-camss\")) {\n\t\tcamss->version = CAMSS_8250;\n\t\tcamss->csiphy_num = 6;\n\t\tcamss->csid_num = 4;\n\t\tcamss->vfe_num = 2;\n\t\tcamss->vfe_lite_num = 2;\n\t} else {\n\t\treturn -EINVAL;\n\t}\n\n\tcamss->csiphy = devm_kcalloc(dev, camss->csiphy_num,\n\t\t\t\t     sizeof(*camss->csiphy), GFP_KERNEL);\n\tif (!camss->csiphy)\n\t\treturn -ENOMEM;\n\n\tcamss->csid = devm_kcalloc(dev, camss->csid_num, sizeof(*camss->csid),\n\t\t\t\t   GFP_KERNEL);\n\tif (!camss->csid)\n\t\treturn -ENOMEM;\n\n\tif (camss->version == CAMSS_8x16 ||\n\t    camss->version == CAMSS_8x96) {\n\t\tcamss->ispif = devm_kcalloc(dev, 1, sizeof(*camss->ispif), GFP_KERNEL);\n\t\tif (!camss->ispif)\n\t\t\treturn -ENOMEM;\n\t}\n\n\tcamss->vfe = devm_kcalloc(dev, camss->vfe_num + camss->vfe_lite_num,\n\t\t\t\t  sizeof(*camss->vfe), GFP_KERNEL);\n\tif (!camss->vfe)\n\t\treturn -ENOMEM;\n\n\tret = camss_icc_get(camss);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = camss_configure_pd(camss);\n\tif (ret < 0) {\n\t\tdev_err(dev, \"Failed to configure power domains: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = camss_init_subdevices(camss);\n\tif (ret < 0)\n\t\tgoto err_genpd_cleanup;\n\n\tret = dma_set_mask_and_coherent(dev, 0xffffffff);\n\tif (ret)\n\t\tgoto err_genpd_cleanup;\n\n\tcamss->media_dev.dev = camss->dev;\n\tstrscpy(camss->media_dev.model, \"Qualcomm Camera Subsystem\",\n\t\tsizeof(camss->media_dev.model));\n\tcamss->media_dev.ops = &camss_media_ops;\n\tmedia_device_init(&camss->media_dev);\n\n\tcamss->v4l2_dev.mdev = &camss->media_dev;\n\tret = v4l2_device_register(camss->dev, &camss->v4l2_dev);\n\tif (ret < 0) {\n\t\tdev_err(dev, \"Failed to register V4L2 device: %d\\n\", ret);\n\t\tgoto err_genpd_cleanup;\n\t}\n\n\tv4l2_async_nf_init(&camss->notifier, &camss->v4l2_dev);\n\n\tnum_subdevs = camss_of_parse_ports(camss);\n\tif (num_subdevs < 0) {\n\t\tret = num_subdevs;\n\t\tgoto err_v4l2_device_unregister;\n\t}\n\n\tret = camss_register_entities(camss);\n\tif (ret < 0)\n\t\tgoto err_v4l2_device_unregister;\n\n\tif (num_subdevs) {\n\t\tcamss->notifier.ops = &camss_subdev_notifier_ops;\n\n\t\tret = v4l2_async_nf_register(&camss->notifier);\n\t\tif (ret) {\n\t\t\tdev_err(dev,\n\t\t\t\t\"Failed to register async subdev nodes: %d\\n\",\n\t\t\t\tret);\n\t\t\tgoto err_register_subdevs;\n\t\t}\n\t} else {\n\t\tret = v4l2_device_register_subdev_nodes(&camss->v4l2_dev);\n\t\tif (ret < 0) {\n\t\t\tdev_err(dev, \"Failed to register subdev nodes: %d\\n\",\n\t\t\t\tret);\n\t\t\tgoto err_register_subdevs;\n\t\t}\n\n\t\tret = media_device_register(&camss->media_dev);\n\t\tif (ret < 0) {\n\t\t\tdev_err(dev, \"Failed to register media device: %d\\n\",\n\t\t\t\tret);\n\t\t\tgoto err_register_subdevs;\n\t\t}\n\t}\n\n\tpm_runtime_enable(dev);\n\n\treturn 0;\n\nerr_register_subdevs:\n\tcamss_unregister_entities(camss);\nerr_v4l2_device_unregister:\n\tv4l2_device_unregister(&camss->v4l2_dev);\n\tv4l2_async_nf_cleanup(&camss->notifier);\nerr_genpd_cleanup:\n\tcamss_genpd_cleanup(camss);\n\n\treturn ret;\n}\n\nvoid camss_delete(struct camss *camss)\n{\n\tv4l2_device_unregister(&camss->v4l2_dev);\n\tmedia_device_unregister(&camss->media_dev);\n\tmedia_device_cleanup(&camss->media_dev);\n\n\tpm_runtime_disable(camss->dev);\n}\n\n \nstatic void camss_remove(struct platform_device *pdev)\n{\n\tstruct camss *camss = platform_get_drvdata(pdev);\n\n\tv4l2_async_nf_unregister(&camss->notifier);\n\tv4l2_async_nf_cleanup(&camss->notifier);\n\tcamss_unregister_entities(camss);\n\n\tif (atomic_read(&camss->ref_count) == 0)\n\t\tcamss_delete(camss);\n\n\tcamss_genpd_cleanup(camss);\n}\n\nstatic const struct of_device_id camss_dt_match[] = {\n\t{ .compatible = \"qcom,msm8916-camss\" },\n\t{ .compatible = \"qcom,msm8996-camss\" },\n\t{ .compatible = \"qcom,sdm660-camss\" },\n\t{ .compatible = \"qcom,sdm845-camss\" },\n\t{ .compatible = \"qcom,sm8250-camss\" },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(of, camss_dt_match);\n\nstatic int __maybe_unused camss_runtime_suspend(struct device *dev)\n{\n\tstruct camss *camss = dev_get_drvdata(dev);\n\tint nbr_icc_paths = 0;\n\tint i;\n\tint ret;\n\n\tif (camss->version == CAMSS_8250)\n\t\tnbr_icc_paths =\tICC_SM8250_COUNT;\n\n\tfor (i = 0; i < nbr_icc_paths; i++) {\n\t\tret = icc_set_bw(camss->icc_path[i], 0, 0);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic int __maybe_unused camss_runtime_resume(struct device *dev)\n{\n\tstruct camss *camss = dev_get_drvdata(dev);\n\tint nbr_icc_paths = 0;\n\tint i;\n\tint ret;\n\n\tif (camss->version == CAMSS_8250)\n\t\tnbr_icc_paths =\tICC_SM8250_COUNT;\n\n\tfor (i = 0; i < nbr_icc_paths; i++) {\n\t\tret = icc_set_bw(camss->icc_path[i],\n\t\t\t\t camss->icc_bw_tbl[i].avg,\n\t\t\t\t camss->icc_bw_tbl[i].peak);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct dev_pm_ops camss_pm_ops = {\n\tSET_SYSTEM_SLEEP_PM_OPS(pm_runtime_force_suspend,\n\t\t\t\tpm_runtime_force_resume)\n\tSET_RUNTIME_PM_OPS(camss_runtime_suspend, camss_runtime_resume, NULL)\n};\n\nstatic struct platform_driver qcom_camss_driver = {\n\t.probe = camss_probe,\n\t.remove_new = camss_remove,\n\t.driver = {\n\t\t.name = \"qcom-camss\",\n\t\t.of_match_table = camss_dt_match,\n\t\t.pm = &camss_pm_ops,\n\t},\n};\n\nmodule_platform_driver(qcom_camss_driver);\n\nMODULE_ALIAS(\"platform:qcom-camss\");\nMODULE_DESCRIPTION(\"Qualcomm Camera Subsystem driver\");\nMODULE_AUTHOR(\"Todor Tomov <todor.tomov@linaro.org>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}