{
  "module_name": "rkisp1-common.c",
  "hash_id": "b490b3ec9916e958bc1565ec5ce03ee42fdb5631dc9f85cd6ce3b2f20c0f3977",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/platform/rockchip/rkisp1/rkisp1-common.c",
  "human_readable_source": "\n \n\n#include <media/mipi-csi2.h>\n#include <media/v4l2-rect.h>\n\n#include \"rkisp1-common.h\"\n\nstatic const struct rkisp1_mbus_info rkisp1_formats[] = {\n\t{\n\t\t.mbus_code\t= MEDIA_BUS_FMT_YUYV8_2X8,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_YUV,\n\t\t.direction\t= RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SRGGB10_1X10,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW10,\n\t\t.bayer_pat\t= RKISP1_RAW_RGGB,\n\t\t.bus_width\t= 10,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SBGGR10_1X10,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW10,\n\t\t.bayer_pat\t= RKISP1_RAW_BGGR,\n\t\t.bus_width\t= 10,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGBRG10_1X10,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW10,\n\t\t.bayer_pat\t= RKISP1_RAW_GBRG,\n\t\t.bus_width\t= 10,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGRBG10_1X10,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW10,\n\t\t.bayer_pat\t= RKISP1_RAW_GRBG,\n\t\t.bus_width\t= 10,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SRGGB12_1X12,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW12,\n\t\t.bayer_pat\t= RKISP1_RAW_RGGB,\n\t\t.bus_width\t= 12,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SBGGR12_1X12,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW12,\n\t\t.bayer_pat\t= RKISP1_RAW_BGGR,\n\t\t.bus_width\t= 12,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGBRG12_1X12,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW12,\n\t\t.bayer_pat\t= RKISP1_RAW_GBRG,\n\t\t.bus_width\t= 12,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGRBG12_1X12,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW12,\n\t\t.bayer_pat\t= RKISP1_RAW_GRBG,\n\t\t.bus_width\t= 12,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SRGGB8_1X8,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW8,\n\t\t.bayer_pat\t= RKISP1_RAW_RGGB,\n\t\t.bus_width\t= 8,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SBGGR8_1X8,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW8,\n\t\t.bayer_pat\t= RKISP1_RAW_BGGR,\n\t\t.bus_width\t= 8,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGBRG8_1X8,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW8,\n\t\t.bayer_pat\t= RKISP1_RAW_GBRG,\n\t\t.bus_width\t= 8,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_SGRBG8_1X8,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_BAYER,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_RAW8,\n\t\t.bayer_pat\t= RKISP1_RAW_GRBG,\n\t\t.bus_width\t= 8,\n\t\t.direction\t= RKISP1_ISP_SD_SINK | RKISP1_ISP_SD_SRC,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_YUYV8_1X16,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_YUV,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_YUV422_8B,\n\t\t.yuv_seq\t= RKISP1_CIF_ISP_ACQ_PROP_YCBYCR,\n\t\t.bus_width\t= 16,\n\t\t.direction\t= RKISP1_ISP_SD_SINK,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_YVYU8_1X16,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_YUV,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_YUV422_8B,\n\t\t.yuv_seq\t= RKISP1_CIF_ISP_ACQ_PROP_YCRYCB,\n\t\t.bus_width\t= 16,\n\t\t.direction\t= RKISP1_ISP_SD_SINK,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_UYVY8_1X16,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_YUV,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_YUV422_8B,\n\t\t.yuv_seq\t= RKISP1_CIF_ISP_ACQ_PROP_CBYCRY,\n\t\t.bus_width\t= 16,\n\t\t.direction\t= RKISP1_ISP_SD_SINK,\n\t}, {\n\t\t.mbus_code\t= MEDIA_BUS_FMT_VYUY8_1X16,\n\t\t.pixel_enc\t= V4L2_PIXEL_ENC_YUV,\n\t\t.mipi_dt\t= MIPI_CSI2_DT_YUV422_8B,\n\t\t.yuv_seq\t= RKISP1_CIF_ISP_ACQ_PROP_CRYCBY,\n\t\t.bus_width\t= 16,\n\t\t.direction\t= RKISP1_ISP_SD_SINK,\n\t},\n};\n\nconst struct rkisp1_mbus_info *rkisp1_mbus_info_get_by_index(unsigned int index)\n{\n\tif (index >= ARRAY_SIZE(rkisp1_formats))\n\t\treturn NULL;\n\n\treturn &rkisp1_formats[index];\n}\n\nconst struct rkisp1_mbus_info *rkisp1_mbus_info_get_by_code(u32 mbus_code)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rkisp1_formats); i++) {\n\t\tconst struct rkisp1_mbus_info *fmt = &rkisp1_formats[i];\n\n\t\tif (fmt->mbus_code == mbus_code)\n\t\t\treturn fmt;\n\t}\n\n\treturn NULL;\n}\n\nstatic const struct v4l2_rect rkisp1_sd_min_crop = {\n\t.width = RKISP1_ISP_MIN_WIDTH,\n\t.height = RKISP1_ISP_MIN_HEIGHT,\n\t.top = 0,\n\t.left = 0,\n};\n\nvoid rkisp1_sd_adjust_crop_rect(struct v4l2_rect *crop,\n\t\t\t\tconst struct v4l2_rect *bounds)\n{\n\tv4l2_rect_set_min_size(crop, &rkisp1_sd_min_crop);\n\tv4l2_rect_map_inside(crop, bounds);\n}\n\nvoid rkisp1_sd_adjust_crop(struct v4l2_rect *crop,\n\t\t\t   const struct v4l2_mbus_framefmt *bounds)\n{\n\tstruct v4l2_rect crop_bounds = {\n\t\t.left = 0,\n\t\t.top = 0,\n\t\t.width = bounds->width,\n\t\t.height = bounds->height,\n\t};\n\n\trkisp1_sd_adjust_crop_rect(crop, &crop_bounds);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}