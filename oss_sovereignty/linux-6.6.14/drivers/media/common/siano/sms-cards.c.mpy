{
  "module_name": "sms-cards.c",
  "hash_id": "da878612dc628a97082443e020f6b46da94f8fdd636b3945db2641508afea040",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/common/siano/sms-cards.c",
  "human_readable_source": "\n \n\n#include \"sms-cards.h\"\n#include \"smsir.h\"\n#include <linux/module.h>\n\nstatic struct sms_board sms_boards[] = {\n\t[SMS_BOARD_UNKNOWN] = {\n\t\t.name\t= \"Unknown board\",\n\t\t.type = SMS_UNKNOWN_TYPE,\n\t\t.default_mode = DEVICE_MODE_NONE,\n\t},\n\t[SMS1XXX_BOARD_SIANO_STELLAR] = {\n\t\t.name\t= \"Siano Stellar Digital Receiver\",\n\t\t.type\t= SMS_STELLAR,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_NOVA_A] = {\n\t\t.name\t= \"Siano Nova A Digital Receiver\",\n\t\t.type\t= SMS_NOVA_A0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_NOVA_B] = {\n\t\t.name\t= \"Siano Nova B Digital Receiver\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_VEGA] = {\n\t\t.name\t= \"Siano Vega Digital Receiver\",\n\t\t.type\t= SMS_VEGA,\n\t\t.default_mode = DEVICE_MODE_CMMB,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_CATAMOUNT] = {\n\t\t.name\t= \"Hauppauge Catamount\",\n\t\t.type\t= SMS_STELLAR,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVBT_STELLAR,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_OKEMO_A] = {\n\t\t.name\t= \"Hauppauge Okemo-A\",\n\t\t.type\t= SMS_NOVA_A0,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVBT_NOVA_A,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_OKEMO_B] = {\n\t\t.name\t= \"Hauppauge Okemo-B\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVBT_NOVA_B,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_WINDHAM] = {\n\t\t.name\t= \"Hauppauge WinTV MiniStick\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.fw[DEVICE_MODE_ISDBT_BDA] = SMS_FW_ISDBT_HCW_55XXX,\n\t\t.fw[DEVICE_MODE_DVBT_BDA]  = SMS_FW_DVBT_HCW_55XXX,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.rc_codes = RC_MAP_HAUPPAUGE,\n\t\t.board_cfg.leds_power = 26,\n\t\t.board_cfg.led0 = 27,\n\t\t.board_cfg.led1 = 28,\n\t\t.board_cfg.ir = 9,\n\t\t.led_power = 26,\n\t\t.led_lo    = 27,\n\t\t.led_hi    = 28,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD] = {\n\t\t.name\t= \"Hauppauge WinTV MiniCard\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVBT_HCW_55XXX,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.lna_ctrl  = 29,\n\t\t.board_cfg.foreign_lna0_ctrl = 29,\n\t\t.rf_switch = 17,\n\t\t.board_cfg.rf_switch_uhf = 17,\n\t},\n\t[SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD_R2] = {\n\t\t.name\t= \"Hauppauge WinTV MiniCard Rev 2\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVBT_HCW_55XXX,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.lna_ctrl  = -1,\n\t},\n\t[SMS1XXX_BOARD_SIANO_NICE] = {\n\t\t.name = \"Siano Nice Digital Receiver\",\n\t\t.type = SMS_NOVA_B0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_VENICE] = {\n\t\t.name = \"Siano Venice Digital Receiver\",\n\t\t.type = SMS_VEGA,\n\t\t.default_mode = DEVICE_MODE_CMMB,\n\t},\n\t[SMS1XXX_BOARD_SIANO_STELLAR_ROM] = {\n\t\t.name = \"Siano Stellar Digital Receiver ROM\",\n\t\t.type = SMS_STELLAR,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.intf_num = 1,\n\t},\n\t[SMS1XXX_BOARD_ZTE_DVB_DATA_CARD] = {\n\t\t.name = \"ZTE Data Card Digital Receiver\",\n\t\t.type = SMS_NOVA_B0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.intf_num = 5,\n\t\t.mtu = 15792,\n\t},\n\t[SMS1XXX_BOARD_ONDA_MDTV_DATA_CARD] = {\n\t\t.name = \"ONDA Data Card Digital Receiver\",\n\t\t.type = SMS_NOVA_B0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t\t.intf_num = 6,\n\t\t.mtu = 15792,\n\t},\n\t[SMS1XXX_BOARD_SIANO_MING] = {\n\t\t.name = \"Siano Ming Digital Receiver\",\n\t\t.type = SMS_MING,\n\t\t.default_mode = DEVICE_MODE_CMMB,\n\t},\n\t[SMS1XXX_BOARD_SIANO_PELE] = {\n\t\t.name = \"Siano Pele Digital Receiver\",\n\t\t.type = SMS_PELE,\n\t\t.default_mode = DEVICE_MODE_ISDBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_RIO] = {\n\t\t.name = \"Siano Rio Digital Receiver\",\n\t\t.type = SMS_RIO,\n\t\t.default_mode = DEVICE_MODE_ISDBT_BDA,\n\t},\n\t[SMS1XXX_BOARD_SIANO_DENVER_1530] = {\n\t\t.name = \"Siano Denver (ATSC-M/H) Digital Receiver\",\n\t\t.type = SMS_DENVER_1530,\n\t\t.default_mode = DEVICE_MODE_ATSC,\n\t\t.crystal = 2400,\n\t},\n\t[SMS1XXX_BOARD_SIANO_DENVER_2160] = {\n\t\t.name = \"Siano Denver (TDMB) Digital Receiver\",\n\t\t.type = SMS_DENVER_2160,\n\t\t.default_mode = DEVICE_MODE_DAB_TDMB,\n\t},\n\t[SMS1XXX_BOARD_PCTV_77E] = {\n\t\t.name\t= \"Hauppauge microStick 77e\",\n\t\t.type\t= SMS_NOVA_B0,\n\t\t.fw[DEVICE_MODE_DVBT_BDA] = SMS_FW_DVB_NOVA_12MHZ_B0,\n\t\t.default_mode = DEVICE_MODE_DVBT_BDA,\n\t},\n};\n\nstruct sms_board *sms_get_board(unsigned id)\n{\n\tBUG_ON(id >= ARRAY_SIZE(sms_boards));\n\n\treturn &sms_boards[id];\n}\nEXPORT_SYMBOL_GPL(sms_get_board);\nstatic inline void sms_gpio_assign_11xx_default_led_config(\n\t\tstruct smscore_config_gpio *p_gpio_config) {\n\tp_gpio_config->direction = SMS_GPIO_DIRECTION_OUTPUT;\n\tp_gpio_config->inputcharacteristics =\n\t\tSMS_GPIO_INPUTCHARACTERISTICS_NORMAL;\n\tp_gpio_config->outputdriving = SMS_GPIO_OUTPUTDRIVING_4mA;\n\tp_gpio_config->outputslewrate = SMS_GPIO_OUTPUT_SLEW_RATE_0_45_V_NS;\n\tp_gpio_config->pullupdown = SMS_GPIO_PULLUPDOWN_NONE;\n}\n\nint sms_board_event(struct smscore_device_t *coredev,\n\t\t    enum SMS_BOARD_EVENTS gevent)\n{\n\tstruct smscore_config_gpio my_gpio_config;\n\n\tsms_gpio_assign_11xx_default_led_config(&my_gpio_config);\n\n\tswitch (gevent) {\n\tcase BOARD_EVENT_POWER_INIT:  \n\t\tbreak;  \n\n\tcase BOARD_EVENT_POWER_SUSPEND:\n\t\tbreak;  \n\n\tcase BOARD_EVENT_POWER_RESUME:\n\t\tbreak;  \n\n\tcase BOARD_EVENT_BIND:\n\t\tbreak;  \n\n\tcase BOARD_EVENT_SCAN_PROG:\n\t\tbreak;  \n\tcase BOARD_EVENT_SCAN_COMP:\n\t\tbreak;  \n\tcase BOARD_EVENT_EMERGENCY_WARNING_SIGNAL:\n\t\tbreak;  \n\tcase BOARD_EVENT_FE_LOCK:\n\t\tbreak;  \n\tcase BOARD_EVENT_FE_UNLOCK:\n\t\tbreak;  \n\tcase BOARD_EVENT_DEMOD_LOCK:\n\t\tbreak;  \n\tcase BOARD_EVENT_DEMOD_UNLOCK:\n\t\tbreak;  \n\tcase BOARD_EVENT_RECEPTION_MAX_4:\n\t\tbreak;  \n\tcase BOARD_EVENT_RECEPTION_3:\n\t\tbreak;  \n\tcase BOARD_EVENT_RECEPTION_2:\n\t\tbreak;  \n\tcase BOARD_EVENT_RECEPTION_1:\n\t\tbreak;  \n\tcase BOARD_EVENT_RECEPTION_LOST_0:\n\t\tbreak;  \n\tcase BOARD_EVENT_MULTIPLEX_OK:\n\t\tbreak;  \n\tcase BOARD_EVENT_MULTIPLEX_ERRORS:\n\t\tbreak;  \n\n\tdefault:\n\t\tpr_err(\"Unknown SMS board event\\n\");\n\t\tbreak;\n\t}\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(sms_board_event);\n\nstatic int sms_set_gpio(struct smscore_device_t *coredev, int pin, int enable)\n{\n\tint lvl, ret;\n\tu32 gpio;\n\tstruct smscore_config_gpio gpioconfig = {\n\t\t.direction            = SMS_GPIO_DIRECTION_OUTPUT,\n\t\t.pullupdown           = SMS_GPIO_PULLUPDOWN_NONE,\n\t\t.inputcharacteristics = SMS_GPIO_INPUTCHARACTERISTICS_NORMAL,\n\t\t.outputslewrate       = SMS_GPIO_OUTPUT_SLEW_RATE_FAST,\n\t\t.outputdriving        = SMS_GPIO_OUTPUTDRIVING_S_4mA,\n\t};\n\n\tif (pin == 0)\n\t\treturn -EINVAL;\n\n\tif (pin < 0) {\n\t\t \n\t\tgpio = pin * -1;\n\t\tlvl = enable ? 0 : 1;\n\t} else {\n\t\tgpio = pin;\n\t\tlvl = enable ? 1 : 0;\n\t}\n\n\tret = smscore_configure_gpio(coredev, gpio, &gpioconfig);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn smscore_set_gpio(coredev, gpio, lvl);\n}\n\nint sms_board_setup(struct smscore_device_t *coredev)\n{\n\tint board_id = smscore_get_board_id(coredev);\n\tstruct sms_board *board = sms_get_board(board_id);\n\n\tswitch (board_id) {\n\tcase SMS1XXX_BOARD_HAUPPAUGE_WINDHAM:\n\t\t \n\t\tsms_set_gpio(coredev, board->led_power, 0);\n\t\tsms_set_gpio(coredev, board->led_hi, 0);\n\t\tsms_set_gpio(coredev, board->led_lo, 0);\n\t\tbreak;\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD_R2:\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD:\n\t\t \n\t\tsms_set_gpio(coredev, board->lna_ctrl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(sms_board_setup);\n\nint sms_board_power(struct smscore_device_t *coredev, int onoff)\n{\n\tint board_id = smscore_get_board_id(coredev);\n\tstruct sms_board *board = sms_get_board(board_id);\n\n\tswitch (board_id) {\n\tcase SMS1XXX_BOARD_HAUPPAUGE_WINDHAM:\n\t\t \n\t\tsms_set_gpio(coredev,\n\t\t\t     board->led_power, onoff ? 1 : 0);\n\t\tbreak;\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD_R2:\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD:\n\t\t \n\t\tif (!onoff)\n\t\t\tsms_set_gpio(coredev, board->lna_ctrl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(sms_board_power);\n\nint sms_board_led_feedback(struct smscore_device_t *coredev, int led)\n{\n\tint board_id = smscore_get_board_id(coredev);\n\tstruct sms_board *board = sms_get_board(board_id);\n\n\t \n\tif (smscore_led_state(coredev, -1) == led)\n\t\treturn 0;\n\n\tswitch (board_id) {\n\tcase SMS1XXX_BOARD_HAUPPAUGE_WINDHAM:\n\t\tsms_set_gpio(coredev,\n\t\t\t     board->led_lo, (led & SMS_LED_LO) ? 1 : 0);\n\t\tsms_set_gpio(coredev,\n\t\t\t     board->led_hi, (led & SMS_LED_HI) ? 1 : 0);\n\n\t\tsmscore_led_state(coredev, led);\n\t\tbreak;\n\t}\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(sms_board_led_feedback);\n\nint sms_board_lna_control(struct smscore_device_t *coredev, int onoff)\n{\n\tint board_id = smscore_get_board_id(coredev);\n\tstruct sms_board *board = sms_get_board(board_id);\n\n\tpr_debug(\"%s: LNA %s\\n\", __func__, onoff ? \"enabled\" : \"disabled\");\n\n\tswitch (board_id) {\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD_R2:\n\tcase SMS1XXX_BOARD_HAUPPAUGE_TIGER_MINICARD:\n\t\tsms_set_gpio(coredev,\n\t\t\t     board->rf_switch, onoff ? 1 : 0);\n\t\treturn sms_set_gpio(coredev,\n\t\t\t\t    board->lna_ctrl, onoff ? 1 : 0);\n\t}\n\treturn -EINVAL;\n}\nEXPORT_SYMBOL_GPL(sms_board_lna_control);\n\nint sms_board_load_modules(int id)\n{\n\trequest_module(\"smsdvb\");\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(sms_board_load_modules);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}