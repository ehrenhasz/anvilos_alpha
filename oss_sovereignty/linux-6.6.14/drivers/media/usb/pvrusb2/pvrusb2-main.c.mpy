{
  "module_name": "pvrusb2-main.c",
  "hash_id": "b1355bd1022906e6e90b16160db44d69db95b594dc35593f543f98ef60d67776",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/pvrusb2/pvrusb2-main.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n#include <linux/usb.h>\n#include <linux/videodev2.h>\n\n#include \"pvrusb2-hdw.h\"\n#include \"pvrusb2-devattr.h\"\n#include \"pvrusb2-context.h\"\n#include \"pvrusb2-debug.h\"\n#include \"pvrusb2-v4l2.h\"\n#include \"pvrusb2-sysfs.h\"\n\n#define DRIVER_AUTHOR \"Mike Isely <isely@pobox.com>\"\n#define DRIVER_DESC \"Hauppauge WinTV-PVR-USB2 MPEG2 Encoder/Tuner\"\n#define DRIVER_VERSION \"V4L in-tree version\"\n\n#define DEFAULT_DEBUG_MASK (PVR2_TRACE_ERROR_LEGS| \\\n\t\t\t    PVR2_TRACE_INFO| \\\n\t\t\t    PVR2_TRACE_STD| \\\n\t\t\t    PVR2_TRACE_TOLERANCE| \\\n\t\t\t    PVR2_TRACE_TRAP| \\\n\t\t\t    0)\n\nint pvrusb2_debug = DEFAULT_DEBUG_MASK;\n\nmodule_param_named(debug,pvrusb2_debug,int,S_IRUGO|S_IWUSR);\nMODULE_PARM_DESC(debug, \"Debug trace mask\");\n\nstatic void pvr_setup_attach(struct pvr2_context *pvr)\n{\n\t \n\tpvr2_v4l2_create(pvr);\n#ifdef CONFIG_VIDEO_PVRUSB2_DVB\n\t \n\tpvr2_dvb_create(pvr);\n#endif\n\tpvr2_sysfs_create(pvr);\n}\n\nstatic int pvr_probe(struct usb_interface *intf,\n\t\t     const struct usb_device_id *devid)\n{\n\tstruct pvr2_context *pvr;\n\n\t \n\tpvr = pvr2_context_create(intf,devid,pvr_setup_attach);\n\tif (!pvr) {\n\t\tpvr2_trace(PVR2_TRACE_ERROR_LEGS,\n\t\t\t   \"Failed to create hdw handler\");\n\t\treturn -ENOMEM;\n\t}\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_probe(pvr=%p)\",pvr);\n\n\tusb_set_intfdata(intf, pvr);\n\n\treturn 0;\n}\n\n \nstatic void pvr_disconnect(struct usb_interface *intf)\n{\n\tstruct pvr2_context *pvr = usb_get_intfdata(intf);\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_disconnect(pvr=%p) BEGIN\",pvr);\n\n\tusb_set_intfdata (intf, NULL);\n\tpvr2_context_disconnect(pvr);\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_disconnect(pvr=%p) DONE\",pvr);\n\n}\n\nstatic struct usb_driver pvr_driver = {\n\t.name =         \"pvrusb2\",\n\t.id_table =     pvr2_device_table,\n\t.probe =        pvr_probe,\n\t.disconnect =   pvr_disconnect\n};\n\n \nstatic int __init pvr_init(void)\n{\n\tint ret;\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_init\");\n\n\tret = pvr2_context_global_init();\n\tif (ret != 0) {\n\t\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_init failure code=%d\",ret);\n\t\treturn ret;\n\t}\n\n\tpvr2_sysfs_class_create();\n\n\tret = usb_register(&pvr_driver);\n\n\tif (ret == 0)\n\t\tpr_info(\"pvrusb2: \" DRIVER_VERSION \":\"\n\t\t       DRIVER_DESC \"\\n\");\n\tif (pvrusb2_debug)\n\t\tpr_info(\"pvrusb2: Debug mask is %d (0x%x)\\n\",\n\t\t       pvrusb2_debug,pvrusb2_debug);\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_init complete\");\n\n\treturn ret;\n}\n\nstatic void __exit pvr_exit(void)\n{\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_exit\");\n\n\tusb_deregister(&pvr_driver);\n\n\tpvr2_context_global_done();\n\n\tpvr2_sysfs_class_destroy();\n\n\tpvr2_trace(PVR2_TRACE_INIT,\"pvr_exit complete\");\n}\n\nmodule_init(pvr_init);\nmodule_exit(pvr_exit);\n\nMODULE_AUTHOR(DRIVER_AUTHOR);\nMODULE_DESCRIPTION(DRIVER_DESC);\nMODULE_LICENSE(\"GPL\");\nMODULE_VERSION(\"0.9.1\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}