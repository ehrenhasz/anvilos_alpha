{
  "module_name": "pwc-uncompress.c",
  "hash_id": "b0eb9411a24ebc03a74f73b824342ff62bea08ba5ed4df84dd89ea0b5c54e241",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/pwc/pwc-uncompress.c",
  "human_readable_source": "\n \n\n#include <asm/current.h>\n#include <asm/types.h>\n\n#include \"pwc.h\"\n#include \"pwc-dec1.h\"\n#include \"pwc-dec23.h\"\n\nint pwc_decompress(struct pwc_device *pdev, struct pwc_frame_buf *fbuf)\n{\n\tint n, line, col;\n\tvoid *yuv, *image;\n\tu16 *src;\n\tu16 *dsty, *dstu, *dstv;\n\n\timage = vb2_plane_vaddr(&fbuf->vb.vb2_buf, 0);\n\n\tyuv = fbuf->data + pdev->frame_header_size;   \n\n\t \n\tif (pdev->pixfmt != V4L2_PIX_FMT_YUV420)\n\t{\n\t\tstruct pwc_raw_frame *raw_frame = image;\n\t\traw_frame->type = cpu_to_le16(pdev->type);\n\t\traw_frame->vbandlength = cpu_to_le16(pdev->vbandlength);\n\t\t\t \n\t\tmemcpy(raw_frame->cmd, pdev->cmd_buf, 4);\n\t\tmemcpy(raw_frame->rawframe, yuv, pdev->frame_size);\n\t\tvb2_set_plane_payload(&fbuf->vb.vb2_buf, 0,\n\t\t\tstruct_size(raw_frame, rawframe, pdev->frame_size));\n\t\treturn 0;\n\t}\n\n\tvb2_set_plane_payload(&fbuf->vb.vb2_buf, 0,\n\t\t\t      pdev->width * pdev->height * 3 / 2);\n\n\tif (pdev->vbandlength == 0) {\n\t\t \n\t\tsrc = (u16 *)yuv;\n\t\tn = pdev->width * pdev->height;\n\t\tdsty = (u16 *)(image);\n\t\tdstu = (u16 *)(image + n);\n\t\tdstv = (u16 *)(image + n + n / 4);\n\n\t\tfor (line = 0; line < pdev->height; line++) {\n\t\t\tfor (col = 0; col < pdev->width; col += 4) {\n\t\t\t\t*dsty++ = *src++;\n\t\t\t\t*dsty++ = *src++;\n\t\t\t\tif (line & 1)\n\t\t\t\t\t*dstv++ = *src++;\n\t\t\t\telse\n\t\t\t\t\t*dstu++ = *src++;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t \n\tif (DEVICE_USE_CODEC1(pdev->type)) {\n\n\t\t \n\t\tPWC_ERROR(\"This chipset is not supported for now\\n\");\n\t\treturn -ENXIO;  \n\n\t} else {\n\t\tpwc_dec23_decompress(pdev, yuv, image);\n\t}\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}