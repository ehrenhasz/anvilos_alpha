{
  "module_name": "pwc.h",
  "hash_id": "efd42207a520773ad6f4a25a61dca60ab056e0122c2de60b983607f37a5abefa",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/pwc/pwc.h",
  "human_readable_source": " \n \n\n#ifndef PWC_H\n#define PWC_H\n\n#include <linux/module.h>\n#include <linux/usb.h>\n#include <linux/spinlock.h>\n#include <linux/wait.h>\n#include <linux/mutex.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <asm/errno.h>\n#include <linux/videodev2.h>\n#include <media/v4l2-common.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-ioctl.h>\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-fh.h>\n#include <media/v4l2-event.h>\n#include <media/videobuf2-v4l2.h>\n#include <media/videobuf2-vmalloc.h>\n#ifdef CONFIG_USB_PWC_INPUT_EVDEV\n#include <linux/input.h>\n#endif\n#include \"pwc-dec1.h\"\n#include \"pwc-dec23.h\"\n\n \n#define PWC_VERSION\t\"10.0.15\"\n#define PWC_NAME\t\"pwc\"\n#define PFX\t\tPWC_NAME \": \"\n\n\n \n#define PWC_DEBUG_LEVEL_MODULE\tBIT(0)\n#define PWC_DEBUG_LEVEL_PROBE\tBIT(1)\n#define PWC_DEBUG_LEVEL_OPEN\tBIT(2)\n#define PWC_DEBUG_LEVEL_READ\tBIT(3)\n#define PWC_DEBUG_LEVEL_MEMORY\tBIT(4)\n#define PWC_DEBUG_LEVEL_FLOW\tBIT(5)\n#define PWC_DEBUG_LEVEL_SIZE\tBIT(6)\n#define PWC_DEBUG_LEVEL_IOCTL\tBIT(7)\n#define PWC_DEBUG_LEVEL_TRACE\tBIT(8)\n\n#define PWC_DEBUG_MODULE(fmt, args...) PWC_DEBUG(MODULE, fmt, ##args)\n#define PWC_DEBUG_PROBE(fmt, args...) PWC_DEBUG(PROBE, fmt, ##args)\n#define PWC_DEBUG_OPEN(fmt, args...) PWC_DEBUG(OPEN, fmt, ##args)\n#define PWC_DEBUG_READ(fmt, args...) PWC_DEBUG(READ, fmt, ##args)\n#define PWC_DEBUG_MEMORY(fmt, args...) PWC_DEBUG(MEMORY, fmt, ##args)\n#define PWC_DEBUG_FLOW(fmt, args...) PWC_DEBUG(FLOW, fmt, ##args)\n#define PWC_DEBUG_SIZE(fmt, args...) PWC_DEBUG(SIZE, fmt, ##args)\n#define PWC_DEBUG_IOCTL(fmt, args...) PWC_DEBUG(IOCTL, fmt, ##args)\n#define PWC_DEBUG_TRACE(fmt, args...) PWC_DEBUG(TRACE, fmt, ##args)\n\n\n#ifdef CONFIG_USB_PWC_DEBUG\n\n#define PWC_DEBUG_LEVEL\t(PWC_DEBUG_LEVEL_MODULE)\n\n#define PWC_DEBUG(level, fmt, args...) do {\\\n\tif ((PWC_DEBUG_LEVEL_ ##level) & pwc_trace) \\\n\t\tprintk(KERN_DEBUG PFX fmt, ##args); \\\n\t} while (0)\n\n#define PWC_ERROR(fmt, args...) printk(KERN_ERR PFX fmt, ##args)\n#define PWC_WARNING(fmt, args...) printk(KERN_WARNING PFX fmt, ##args)\n#define PWC_INFO(fmt, args...) printk(KERN_INFO PFX fmt, ##args)\n#define PWC_TRACE(fmt, args...) PWC_DEBUG(TRACE, fmt, ##args)\n\n#else  \n\n#define PWC_ERROR(fmt, args...) printk(KERN_ERR PFX fmt, ##args)\n#define PWC_WARNING(fmt, args...) printk(KERN_WARNING PFX fmt, ##args)\n#define PWC_INFO(fmt, args...) printk(KERN_INFO PFX fmt, ##args)\n#define PWC_TRACE(fmt, args...) do { } while(0)\n#define PWC_DEBUG(level, fmt, args...) do { } while(0)\n\n#define pwc_trace 0\n\n#endif\n\n \n#define TOUCAM_HEADER_SIZE\t\t8\n#define TOUCAM_TRAILER_SIZE\t\t4\n\n#define FEATURE_MOTOR_PANTILT\t\t0x0001\n#define FEATURE_CODEC1\t\t\t0x0002\n#define FEATURE_CODEC2\t\t\t0x0004\n\n#define MAX_WIDTH\t\t640\n#define MAX_HEIGHT\t\t480\n\n \n#define FRAME_LOWMARK 5\n\n \n#define MAX_ISO_BUFS\t\t3\n#define ISO_FRAMES_PER_DESC\t10\n#define ISO_MAX_FRAME_SIZE\t960\n#define ISO_BUFFER_SIZE\t\t(ISO_FRAMES_PER_DESC * ISO_MAX_FRAME_SIZE)\n\n \n#define PWC_FRAME_SIZE\t\t(460800 + TOUCAM_HEADER_SIZE + TOUCAM_TRAILER_SIZE)\n\n \n#define MIN_FRAMES\t\t2\n#define MAX_FRAMES\t\t16\n\n \n#define DEVICE_USE_CODEC1(x) ((x)<675)\n#define DEVICE_USE_CODEC2(x) ((x)>=675 && (x)<700)\n#define DEVICE_USE_CODEC3(x) ((x)>=700)\n#define DEVICE_USE_CODEC23(x) ((x)>=675)\n\n \n#define SET_LUM_CTL\t\t\t0x01\n#define GET_LUM_CTL\t\t\t0x02\n#define SET_CHROM_CTL\t\t\t0x03\n#define GET_CHROM_CTL\t\t\t0x04\n#define SET_STATUS_CTL\t\t\t0x05\n#define GET_STATUS_CTL\t\t\t0x06\n#define SET_EP_STREAM_CTL\t\t0x07\n#define GET_EP_STREAM_CTL\t\t0x08\n#define GET_XX_CTL\t\t\t0x09\n#define SET_XX_CTL\t\t\t0x0A\n#define GET_XY_CTL\t\t\t0x0B\n#define SET_XY_CTL\t\t\t0x0C\n#define SET_MPT_CTL\t\t\t0x0D\n#define GET_MPT_CTL\t\t\t0x0E\n\n \n#define AGC_MODE_FORMATTER\t\t\t0x2000\n#define PRESET_AGC_FORMATTER\t\t\t0x2100\n#define SHUTTER_MODE_FORMATTER\t\t\t0x2200\n#define PRESET_SHUTTER_FORMATTER\t\t0x2300\n#define PRESET_CONTOUR_FORMATTER\t\t0x2400\n#define AUTO_CONTOUR_FORMATTER\t\t\t0x2500\n#define BACK_LIGHT_COMPENSATION_FORMATTER\t0x2600\n#define CONTRAST_FORMATTER\t\t\t0x2700\n#define DYNAMIC_NOISE_CONTROL_FORMATTER\t\t0x2800\n#define FLICKERLESS_MODE_FORMATTER\t\t0x2900\n#define AE_CONTROL_SPEED\t\t\t0x2A00\n#define BRIGHTNESS_FORMATTER\t\t\t0x2B00\n#define GAMMA_FORMATTER\t\t\t\t0x2C00\n\n \n#define WB_MODE_FORMATTER\t\t\t0x1000\n#define AWB_CONTROL_SPEED_FORMATTER\t\t0x1100\n#define AWB_CONTROL_DELAY_FORMATTER\t\t0x1200\n#define PRESET_MANUAL_RED_GAIN_FORMATTER\t0x1300\n#define PRESET_MANUAL_BLUE_GAIN_FORMATTER\t0x1400\n#define COLOUR_MODE_FORMATTER\t\t\t0x1500\n#define SATURATION_MODE_FORMATTER1\t\t0x1600\n#define SATURATION_MODE_FORMATTER2\t\t0x1700\n\n \n#define SAVE_USER_DEFAULTS_FORMATTER\t\t0x0200\n#define RESTORE_USER_DEFAULTS_FORMATTER\t\t0x0300\n#define RESTORE_FACTORY_DEFAULTS_FORMATTER\t0x0400\n#define READ_AGC_FORMATTER\t\t\t0x0500\n#define READ_SHUTTER_FORMATTER\t\t\t0x0600\n#define READ_RED_GAIN_FORMATTER\t\t\t0x0700\n#define READ_BLUE_GAIN_FORMATTER\t\t0x0800\n\n \n#define PT_RELATIVE_CONTROL_FORMATTER\t\t0x01\n#define PT_RESET_CONTROL_FORMATTER\t\t0x02\n#define PT_STATUS_FORMATTER\t\t\t0x03\n\n \n#define PSZ_SQCIF\t0x00\n#define PSZ_QSIF\t0x01\n#define PSZ_QCIF\t0x02\n#define PSZ_SIF\t\t0x03\n#define PSZ_CIF\t\t0x04\n#define PSZ_VGA\t\t0x05\n#define PSZ_MAX\t\t6\n\nstruct pwc_raw_frame {\n\t__le16 type;\t\t \n\t__le16 vbandlength;\t \n\t__u8   cmd[4];\t\t \n\t__u8   rawframe[];\t \n} __packed;\n\n \nstruct pwc_frame_buf\n{\n\t \n\tstruct vb2_v4l2_buffer vb;\n\tstruct list_head list;\n\tvoid *data;\n\tint filled;\t\t \n};\n\nstruct pwc_device\n{\n\tstruct video_device vdev;\n\tstruct v4l2_device v4l2_dev;\n\n\t \n\tstruct vb2_queue vb_queue;\n\tstruct list_head queued_bufs;\n\tspinlock_t queued_bufs_lock;  \n\n\t \n\tstruct mutex v4l2_lock;       \n\tstruct mutex vb_queue_lock;   \n\n\t \n\tstruct usb_device *udev;  \n\n\t \n\tint type;\n\tint release;\t\t \n\tint features;\t\t \n\n\t \n\tint vendpoint;\t\t \n\tint vcinterface;\t \n\tint valternate;\t\t \n\tint vframes;\t\t \n\tint pixfmt;\t\t \n\tint vframe_count;\t \n\tint vmax_packet_size;\t \n\tint vlast_packet_size;\t \n\tint visoc_errors;\t \n\tint vbandlength;\t \n\tchar vsync;\t\t \n\tchar vmirror;\t\t \n\tchar power_save;\t \n\n\tunsigned char cmd_buf[13];\n\tunsigned char *ctrl_buf;\n\n\tstruct urb *urbs[MAX_ISO_BUFS];\n\n\t \n\tstruct pwc_frame_buf *fill_buf;\n\n\tint frame_header_size, frame_trailer_size;\n\tint frame_size;\n\tint frame_total_size;\t \n\tint drop_frames;\n\n\tunion {\t \n\t\tstruct pwc_dec1_private dec1;\n\t\tstruct pwc_dec23_private dec23;\n\t};\n\n\t \n\tint image_mask;\t\t\t\t \n\tint width, height;\t\t\t \n\n#ifdef CONFIG_USB_PWC_INPUT_EVDEV\n\tstruct input_dev *button_dev;\t \n\tchar button_phys[64];\n#endif\n\n\t \n\tstruct v4l2_ctrl_handler\tctrl_handler;\n\tu16\t\t\t\tsaturation_fmt;\n\tstruct v4l2_ctrl\t\t*brightness;\n\tstruct v4l2_ctrl\t\t*contrast;\n\tstruct v4l2_ctrl\t\t*saturation;\n\tstruct v4l2_ctrl\t\t*gamma;\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl\t*auto_white_balance;\n\t\tstruct v4l2_ctrl\t*red_balance;\n\t\tstruct v4l2_ctrl\t*blue_balance;\n\t\t \n\t\tint\t\t\tcolor_bal_valid;\n\t\tunsigned long\t\tlast_color_bal_update;  \n\t\ts32\t\t\tlast_red_balance;\n\t\ts32\t\t\tlast_blue_balance;\n\t};\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl\t*autogain;\n\t\tstruct v4l2_ctrl\t*gain;\n\t\tint\t\t\tgain_valid;\n\t\tunsigned long\t\tlast_gain_update;  \n\t\ts32\t\t\tlast_gain;\n\t};\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl\t*exposure_auto;\n\t\tstruct v4l2_ctrl\t*exposure;\n\t\tint\t\t\texposure_valid;\n\t\tunsigned long\t\tlast_exposure_update;  \n\t\ts32\t\t\tlast_exposure;\n\t};\n\tstruct v4l2_ctrl\t\t*colorfx;\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl\t*autocontour;\n\t\tstruct v4l2_ctrl\t*contour;\n\t};\n\tstruct v4l2_ctrl\t\t*backlight;\n\tstruct v4l2_ctrl\t\t*flicker;\n\tstruct v4l2_ctrl\t\t*noise_reduction;\n\tstruct v4l2_ctrl\t\t*save_user;\n\tstruct v4l2_ctrl\t\t*restore_user;\n\tstruct v4l2_ctrl\t\t*restore_factory;\n\tstruct v4l2_ctrl\t\t*awb_speed;\n\tstruct v4l2_ctrl\t\t*awb_delay;\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl\t*motor_pan;\n\t\tstruct v4l2_ctrl\t*motor_tilt;\n\t\tstruct v4l2_ctrl\t*motor_pan_reset;\n\t\tstruct v4l2_ctrl\t*motor_tilt_reset;\n\t};\n\t \n\tstruct v4l2_ctrl\t\t*autogain_expo_cluster[3];\n};\n\n \n#ifdef CONFIG_USB_PWC_DEBUG\nextern int pwc_trace;\n#endif\n\n \n \nextern const int pwc_image_sizes[PSZ_MAX][2];\n\nint pwc_get_size(struct pwc_device *pdev, int width, int height);\nvoid pwc_construct(struct pwc_device *pdev);\n\n \n \nextern int pwc_set_video_mode(struct pwc_device *pdev, int width, int height,\n\tint pixfmt, int frames, int *compression, int send_to_cam);\nextern unsigned int pwc_get_fps(struct pwc_device *pdev, unsigned int index, unsigned int size);\nextern int pwc_set_leds(struct pwc_device *pdev, int on_value, int off_value);\nextern int pwc_get_cmos_sensor(struct pwc_device *pdev, int *sensor);\nextern int send_control_msg(struct pwc_device *pdev,\n\t\t\t    u8 request, u16 value, void *buf, int buflen);\n\n \nint pwc_get_u8_ctrl(struct pwc_device *pdev, u8 request, u16 value, int *data);\nint pwc_set_u8_ctrl(struct pwc_device *pdev, u8 request, u16 value, u8 data);\nint pwc_get_s8_ctrl(struct pwc_device *pdev, u8 request, u16 value, int *data);\n#define pwc_set_s8_ctrl pwc_set_u8_ctrl\nint pwc_get_u16_ctrl(struct pwc_device *pdev, u8 request, u16 value, int *dat);\nint pwc_set_u16_ctrl(struct pwc_device *pdev, u8 request, u16 value, u16 data);\nint pwc_button_ctrl(struct pwc_device *pdev, u16 value);\nint pwc_init_controls(struct pwc_device *pdev);\n\n \nextern void pwc_camera_power(struct pwc_device *pdev, int power);\n\nextern const struct v4l2_ioctl_ops pwc_ioctl_ops;\n\n \n \nint pwc_decompress(struct pwc_device *pdev, struct pwc_frame_buf *fbuf);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}