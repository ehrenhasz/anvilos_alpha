{
  "module_name": "umt-010.c",
  "hash_id": "e50981745212b4bd51bc1967d3083b4956f7f82ffb2b0e9ff4b0c3f5fe0525d2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/dvb-usb/umt-010.c",
  "human_readable_source": "\n \n#include \"dibusb.h\"\n\n#include \"mt352.h\"\n\nDVB_DEFINE_MOD_OPT_ADAPTER_NR(adapter_nr);\n\nstatic int umt_mt352_demod_init(struct dvb_frontend *fe)\n{\n\tstatic u8 mt352_clock_config[] = { 0x89, 0xb8, 0x2d };\n\tstatic u8 mt352_reset[] = { 0x50, 0x80 };\n\tstatic u8 mt352_mclk_ratio[] = { 0x8b, 0x00 };\n\tstatic u8 mt352_adc_ctl_1_cfg[] = { 0x8E, 0x40 };\n\tstatic u8 mt352_agc_cfg[] = { 0x67, 0x10, 0xa0 };\n\n\tstatic u8 mt352_sec_agc_cfg1[] = { 0x6a, 0xff };\n\tstatic u8 mt352_sec_agc_cfg2[] = { 0x6d, 0xff };\n\tstatic u8 mt352_sec_agc_cfg3[] = { 0x70, 0x40 };\n\tstatic u8 mt352_sec_agc_cfg4[] = { 0x7b, 0x03 };\n\tstatic u8 mt352_sec_agc_cfg5[] = { 0x7d, 0x0f };\n\n\tstatic u8 mt352_acq_ctl[] = { 0x53, 0x50 };\n\tstatic u8 mt352_input_freq_1[] = { 0x56, 0x31, 0x06 };\n\n\tmt352_write(fe, mt352_clock_config, sizeof(mt352_clock_config));\n\tudelay(2000);\n\tmt352_write(fe, mt352_reset, sizeof(mt352_reset));\n\tmt352_write(fe, mt352_mclk_ratio, sizeof(mt352_mclk_ratio));\n\n\tmt352_write(fe, mt352_adc_ctl_1_cfg, sizeof(mt352_adc_ctl_1_cfg));\n\tmt352_write(fe, mt352_agc_cfg, sizeof(mt352_agc_cfg));\n\n\tmt352_write(fe, mt352_sec_agc_cfg1, sizeof(mt352_sec_agc_cfg1));\n\tmt352_write(fe, mt352_sec_agc_cfg2, sizeof(mt352_sec_agc_cfg2));\n\tmt352_write(fe, mt352_sec_agc_cfg3, sizeof(mt352_sec_agc_cfg3));\n\tmt352_write(fe, mt352_sec_agc_cfg4, sizeof(mt352_sec_agc_cfg4));\n\tmt352_write(fe, mt352_sec_agc_cfg5, sizeof(mt352_sec_agc_cfg5));\n\n\tmt352_write(fe, mt352_acq_ctl, sizeof(mt352_acq_ctl));\n\tmt352_write(fe, mt352_input_freq_1, sizeof(mt352_input_freq_1));\n\n\treturn 0;\n}\n\nstatic int umt_mt352_frontend_attach(struct dvb_usb_adapter *adap)\n{\n\tstruct mt352_config umt_config;\n\n\tmemset(&umt_config,0,sizeof(struct mt352_config));\n\tumt_config.demod_init = umt_mt352_demod_init;\n\tumt_config.demod_address = 0xf;\n\n\tadap->fe_adap[0].fe = dvb_attach(mt352_attach, &umt_config, &adap->dev->i2c_adap);\n\n\treturn 0;\n}\n\nstatic int umt_tuner_attach (struct dvb_usb_adapter *adap)\n{\n\tdvb_attach(dvb_pll_attach, adap->fe_adap[0].fe, 0x61, NULL, DVB_PLL_TUA6034);\n\treturn 0;\n}\n\n \nstatic struct dvb_usb_device_properties umt_properties;\n\nstatic int umt_probe(struct usb_interface *intf,\n\t\tconst struct usb_device_id *id)\n{\n\tif (0 == dvb_usb_device_init(intf, &umt_properties,\n\t\t\t\t     THIS_MODULE, NULL, adapter_nr))\n\t\treturn 0;\n\treturn -EINVAL;\n}\n\n \nenum {\n\tHANFTEK_UMT_010_COLD,\n\tHANFTEK_UMT_010_WARM,\n};\n\nstatic struct usb_device_id umt_table[] = {\n\tDVB_USB_DEV(HANFTEK, HANFTEK_UMT_010_COLD),\n\tDVB_USB_DEV(HANFTEK, HANFTEK_UMT_010_WARM),\n\t{ }\n};\n\nMODULE_DEVICE_TABLE (usb, umt_table);\n\nstatic struct dvb_usb_device_properties umt_properties = {\n\t.caps = DVB_USB_IS_AN_I2C_ADAPTER,\n\n\t.usb_ctrl = CYPRESS_FX2,\n\t.firmware = \"dvb-usb-umt-010-02.fw\",\n\n\t.num_adapters = 1,\n\t.adapter = {\n\t\t{\n\t\t.num_frontends = 1,\n\t\t.fe = {{\n\t\t\t.streaming_ctrl   = dibusb2_0_streaming_ctrl,\n\t\t\t.frontend_attach  = umt_mt352_frontend_attach,\n\t\t\t.tuner_attach     = umt_tuner_attach,\n\n\t\t\t \n\t\t\t.stream = {\n\t\t\t\t.type = USB_BULK,\n\t\t\t\t.count = MAX_NO_URBS_FOR_DATA_STREAM,\n\t\t\t\t.endpoint = 0x06,\n\t\t\t\t.u = {\n\t\t\t\t\t.bulk = {\n\t\t\t\t\t\t.buffersize = 512,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t}},\n\t\t\t.size_of_priv     = sizeof(struct dibusb_state),\n\t\t}\n\t},\n\t.power_ctrl       = dibusb_power_ctrl,\n\n\t.i2c_algo         = &dibusb_i2c_algo,\n\n\t.generic_bulk_ctrl_endpoint = 0x01,\n\n\t.num_device_descs = 1,\n\t.devices = {\n\t\t{\t\"Hanftek UMT-010 DVB-T USB2.0\",\n\t\t\t{ &umt_table[HANFTEK_UMT_010_COLD], NULL },\n\t\t\t{ &umt_table[HANFTEK_UMT_010_WARM], NULL },\n\t\t},\n\t}\n};\n\nstatic struct usb_driver umt_driver = {\n\t.name\t\t= \"dvb_usb_umt_010\",\n\t.probe\t\t= umt_probe,\n\t.disconnect = dvb_usb_device_exit,\n\t.id_table\t= umt_table,\n};\n\nmodule_usb_driver(umt_driver);\n\nMODULE_AUTHOR(\"Patrick Boettcher <patrick.boettcher@posteo.de>\");\nMODULE_DESCRIPTION(\"Driver for HanfTek UMT 010 USB2.0 DVB-T device\");\nMODULE_VERSION(\"1.0\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}