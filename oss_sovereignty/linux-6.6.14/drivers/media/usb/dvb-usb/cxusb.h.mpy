{
  "module_name": "cxusb.h",
  "hash_id": "7a7a0d7475f1dfd13fb650ccfe8ec21feb5ca85c5c896701aa93ec181efa60db",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/dvb-usb/cxusb.h",
  "human_readable_source": " \n#ifndef _DVB_USB_CXUSB_H_\n#define _DVB_USB_CXUSB_H_\n\n#include <linux/completion.h>\n#include <linux/i2c.h>\n#include <linux/list.h>\n#include <linux/mutex.h>\n#include <linux/usb.h>\n#include <linux/workqueue.h>\n#include <media/v4l2-common.h>\n#include <media/v4l2-dev.h>\n#include <media/v4l2-device.h>\n#include <media/videobuf2-core.h>\n#include <media/videobuf2-v4l2.h>\n\n#define DVB_USB_LOG_PREFIX \"cxusb\"\n#include \"dvb-usb.h\"\n\n#define CXUSB_VIDEO_URBS (5)\n#define CXUSB_VIDEO_URB_MAX_SIZE (512 * 1024)\n\n#define CXUSB_VIDEO_PKT_SIZE 3030\n#define CXUSB_VIDEO_MAX_FRAME_PKTS 346\n#define CXUSB_VIDEO_MAX_FRAME_SIZE (CXUSB_VIDEO_MAX_FRAME_PKTS * \\\n\t\t\t\t\tCXUSB_VIDEO_PKT_SIZE)\n\n \n#define CMD_BLUEBIRD_GPIO_RW 0x05\n\n#define CMD_I2C_WRITE     0x08\n#define CMD_I2C_READ      0x09\n\n#define CMD_GPIO_READ     0x0d\n#define CMD_GPIO_WRITE    0x0e\n#define     GPIO_TUNER         0x02\n\n#define CMD_POWER_OFF     0xdc\n#define CMD_POWER_ON      0xde\n\n#define CMD_STREAMING_ON  0x36\n#define CMD_STREAMING_OFF 0x37\n\n#define CMD_AVER_STREAM_ON  0x18\n#define CMD_AVER_STREAM_OFF 0x19\n\n#define CMD_GET_IR_CODE   0x47\n\n#define CMD_ANALOG        0x50\n#define CMD_DIGITAL       0x51\n\n#define CXUSB_BT656_PREAMBLE ((const u8 *)\"\\xff\\x00\\x00\")\n\n#define CXUSB_BT656_FIELD_MASK BIT(6)\n#define CXUSB_BT656_FIELD_1 0\n#define CXUSB_BT656_FIELD_2 BIT(6)\n\n#define CXUSB_BT656_VBI_MASK BIT(5)\n#define CXUSB_BT656_VBI_ON BIT(5)\n#define CXUSB_BT656_VBI_OFF 0\n\n#define CXUSB_BT656_SEAV_MASK BIT(4)\n#define CXUSB_BT656_SEAV_EAV BIT(4)\n#define CXUSB_BT656_SEAV_SAV 0\n\n \n#define MAX_XFER_SIZE  80\n\nstruct cxusb_state {\n\tu8 gpio_write_state[3];\n\tbool gpio_write_refresh[3];\n\tstruct i2c_client *i2c_client_demod;\n\tstruct i2c_client *i2c_client_tuner;\n\n\tunsigned char data[MAX_XFER_SIZE];\n\n\tstruct mutex stream_mutex;\n\tu8 last_lock;\n\tint (*fe_read_status)(struct dvb_frontend *fe,\n\t\t\t      enum fe_status *status);\n};\n\nenum cxusb_open_type {\n\tCXUSB_OPEN_INIT,\n\tCXUSB_OPEN_NONE,\n\tCXUSB_OPEN_ANALOG,\n\tCXUSB_OPEN_DIGITAL\n};\n\nstruct cxusb_medion_auxbuf {\n\tu8 *buf;\n\tunsigned int len;\n\tunsigned int paylen;\n};\n\nenum cxusb_bt656_mode {\n\tNEW_FRAME, FIRST_FIELD, SECOND_FIELD\n};\n\nenum cxusb_bt656_fmode {\n\tSTART_SEARCH, LINE_SAMPLES, VBI_SAMPLES\n};\n\nstruct cxusb_bt656_params {\n\tenum cxusb_bt656_mode mode;\n\tenum cxusb_bt656_fmode fmode;\n\tunsigned int pos;\n\tunsigned int line;\n\tunsigned int linesamples;\n\tu8 *buf;\n};\n\nstruct cxusb_medion_dev {\n\t \n\tstruct cxusb_state state;\n\n\tstruct dvb_usb_device *dvbdev;\n\n\tenum cxusb_open_type open_type;\n\tunsigned int open_ctr;\n\tstruct mutex open_lock;\n\n#ifdef CONFIG_DVB_USB_CXUSB_ANALOG\n\tstruct v4l2_device v4l2dev;\n\tstruct v4l2_subdev *cx25840;\n\tstruct v4l2_subdev *tuner;\n\tstruct v4l2_subdev *tda9887;\n\tstruct video_device *videodev, *radiodev;\n\tstruct mutex dev_lock;\n\n\tstruct vb2_queue videoqueue;\n\tu32 input;\n\tbool stop_streaming;\n\tu32 width, height;\n\tu32 field_order;\n\tstruct cxusb_medion_auxbuf auxbuf;\n\tv4l2_std_id norm;\n\n\tstruct urb *streamurbs[CXUSB_VIDEO_URBS];\n\tunsigned long urbcomplete;\n\tstruct work_struct urbwork;\n\tunsigned int nexturb;\n\n\tstruct cxusb_bt656_params bt656;\n\tstruct cxusb_medion_vbuffer *vbuf;\n\t__u32 vbuf_sequence;\n\n\tstruct list_head buflist;\n\n\tstruct completion v4l2_release;\n#endif\n};\n\nstruct cxusb_medion_vbuffer {\n\tstruct vb2_v4l2_buffer vb2;\n\tstruct list_head list;\n};\n\n \n#define CXUSB_DBG_RC BIT(0)\n#define CXUSB_DBG_I2C BIT(1)\n#define CXUSB_DBG_MISC BIT(2)\n#define CXUSB_DBG_BT656 BIT(3)\n#define CXUSB_DBG_URB BIT(4)\n#define CXUSB_DBG_OPS BIT(5)\n#define CXUSB_DBG_AUXB BIT(6)\n\nextern int dvb_usb_cxusb_debug;\n\n#define cxusb_vprintk(dvbdev, lvl, ...) do {\t\t\t\t\\\n\t\tstruct cxusb_medion_dev *_cxdev = (dvbdev)->priv;\t\\\n\t\tif (dvb_usb_cxusb_debug & CXUSB_DBG_##lvl)\t\t\\\n\t\t\tv4l2_printk(KERN_DEBUG,\t\t\t\\\n\t\t\t\t    &_cxdev->v4l2dev, __VA_ARGS__);\t\\\n\t} while (0)\n\nint cxusb_ctrl_msg(struct dvb_usb_device *d,\n\t\t   u8 cmd, const u8 *wbuf, int wlen, u8 *rbuf, int rlen);\n\n#ifdef CONFIG_DVB_USB_CXUSB_ANALOG\nint cxusb_medion_analog_init(struct dvb_usb_device *dvbdev);\nint cxusb_medion_register_analog(struct dvb_usb_device *dvbdev);\nvoid cxusb_medion_unregister_analog(struct dvb_usb_device *dvbdev);\n#else\nstatic inline int cxusb_medion_analog_init(struct dvb_usb_device *dvbdev)\n{\n\treturn -EINVAL;\n}\n\nstatic inline int cxusb_medion_register_analog(struct dvb_usb_device *dvbdev)\n{\n\treturn 0;\n}\n\nstatic inline void cxusb_medion_unregister_analog(struct dvb_usb_device *dvbdev)\n{\n}\n#endif\n\nint cxusb_medion_get(struct dvb_usb_device *dvbdev,\n\t\t     enum cxusb_open_type open_type);\nvoid cxusb_medion_put(struct dvb_usb_device *dvbdev);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}