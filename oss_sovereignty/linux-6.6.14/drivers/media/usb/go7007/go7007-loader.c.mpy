{
  "module_name": "go7007-loader.c",
  "hash_id": "11b61bfd24413fedb0154a2f4e8e97e7ca9dc18dcc921d3b4def306a147d7d5a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/go7007/go7007-loader.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/usb.h>\n#include <linux/firmware.h>\n#include <cypress_firmware.h>\n\nstruct fw_config {\n\tu16 vendor;\n\tu16 product;\n\tconst char * const fw_name1;\n\tconst char * const fw_name2;\n};\n\nstatic struct fw_config fw_configs[] = {\n\t{ 0x1943, 0xa250, \"go7007/s2250-1.fw\", \"go7007/s2250-2.fw\" },\n\t{ 0x093b, 0xa002, \"go7007/px-m402u.fw\", NULL },\n\t{ 0x093b, 0xa004, \"go7007/px-tv402u.fw\", NULL },\n\t{ 0x0eb1, 0x6666, \"go7007/lr192.fw\", NULL },\n\t{ 0x0eb1, 0x6668, \"go7007/wis-startrek.fw\", NULL },\n\t{ 0, 0, NULL, NULL }\n};\nMODULE_FIRMWARE(\"go7007/s2250-1.fw\");\nMODULE_FIRMWARE(\"go7007/s2250-2.fw\");\nMODULE_FIRMWARE(\"go7007/px-m402u.fw\");\nMODULE_FIRMWARE(\"go7007/px-tv402u.fw\");\nMODULE_FIRMWARE(\"go7007/lr192.fw\");\nMODULE_FIRMWARE(\"go7007/wis-startrek.fw\");\n\nstatic int go7007_loader_probe(struct usb_interface *interface,\n\t\t\t\tconst struct usb_device_id *id)\n{\n\tstruct usb_device *usbdev;\n\tconst struct firmware *fw;\n\tu16 vendor, product;\n\tconst char *fw1, *fw2;\n\tint ret;\n\tint i;\n\n\tusbdev = usb_get_dev(interface_to_usbdev(interface));\n\tif (!usbdev)\n\t\tgoto failed2;\n\n\tif (usbdev->descriptor.bNumConfigurations != 1) {\n\t\tdev_err(&interface->dev, \"can't handle multiple config\\n\");\n\t\tgoto failed2;\n\t}\n\n\tvendor = le16_to_cpu(usbdev->descriptor.idVendor);\n\tproduct = le16_to_cpu(usbdev->descriptor.idProduct);\n\n\tfor (i = 0; fw_configs[i].fw_name1; i++)\n\t\tif (fw_configs[i].vendor == vendor &&\n\t\t    fw_configs[i].product == product)\n\t\t\tbreak;\n\n\t \n\tif (fw_configs[i].fw_name1 == NULL)\n\t\tgoto failed2;\n\n\tfw1 = fw_configs[i].fw_name1;\n\tfw2 = fw_configs[i].fw_name2;\n\n\tdev_info(&interface->dev, \"loading firmware %s\\n\", fw1);\n\n\tif (request_firmware(&fw, fw1, &usbdev->dev)) {\n\t\tdev_err(&interface->dev,\n\t\t\t\"unable to load firmware from file \\\"%s\\\"\\n\", fw1);\n\t\tgoto failed2;\n\t}\n\tret = cypress_load_firmware(usbdev, fw, CYPRESS_FX2);\n\trelease_firmware(fw);\n\tif (0 != ret) {\n\t\tdev_err(&interface->dev, \"loader download failed\\n\");\n\t\tgoto failed2;\n\t}\n\n\tif (fw2 == NULL)\n\t\treturn 0;\n\n\tif (request_firmware(&fw, fw2, &usbdev->dev)) {\n\t\tdev_err(&interface->dev,\n\t\t\t\"unable to load firmware from file \\\"%s\\\"\\n\", fw2);\n\t\tgoto failed2;\n\t}\n\tret = cypress_load_firmware(usbdev, fw, CYPRESS_FX2);\n\trelease_firmware(fw);\n\tif (0 != ret) {\n\t\tdev_err(&interface->dev, \"firmware download failed\\n\");\n\t\tgoto failed2;\n\t}\n\treturn 0;\n\nfailed2:\n\tusb_put_dev(usbdev);\n\tdev_err(&interface->dev, \"probe failed\\n\");\n\treturn -ENODEV;\n}\n\nstatic void go7007_loader_disconnect(struct usb_interface *interface)\n{\n\tdev_info(&interface->dev, \"disconnect\\n\");\n\tusb_put_dev(interface_to_usbdev(interface));\n\tusb_set_intfdata(interface, NULL);\n}\n\nstatic const struct usb_device_id go7007_loader_ids[] = {\n\t{ USB_DEVICE(0x1943, 0xa250) },\n\t{ USB_DEVICE(0x093b, 0xa002) },\n\t{ USB_DEVICE(0x093b, 0xa004) },\n\t{ USB_DEVICE(0x0eb1, 0x6666) },\n\t{ USB_DEVICE(0x0eb1, 0x6668) },\n\t{}                           \n};\n\nMODULE_DEVICE_TABLE(usb, go7007_loader_ids);\n\nstatic struct usb_driver go7007_loader_driver = {\n\t.name\t\t= \"go7007-loader\",\n\t.probe\t\t= go7007_loader_probe,\n\t.disconnect\t= go7007_loader_disconnect,\n\t.id_table\t= go7007_loader_ids,\n};\n\nmodule_usb_driver(go7007_loader_driver);\n\nMODULE_AUTHOR(\"\");\nMODULE_DESCRIPTION(\"firmware loader for go7007-usb\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}