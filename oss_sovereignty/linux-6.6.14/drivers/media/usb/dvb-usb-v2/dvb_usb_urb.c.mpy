{
  "module_name": "dvb_usb_urb.c",
  "hash_id": "c948a8bbbe3b68cc14dcb51554802fb4b777ed7a45a5f713f37a60c5f27c2923",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/dvb-usb-v2/dvb_usb_urb.c",
  "human_readable_source": "\n \n\n#include \"dvb_usb_common.h\"\n\nstatic int dvb_usb_v2_generic_io(struct dvb_usb_device *d,\n\t\tu8 *wbuf, u16 wlen, u8 *rbuf, u16 rlen)\n{\n\tint ret, actual_length;\n\n\tif (!wbuf || !wlen || !d->props->generic_bulk_ctrl_endpoint ||\n\t\t\t!d->props->generic_bulk_ctrl_endpoint_response) {\n\t\tdev_dbg(&d->udev->dev, \"%s: failed=%d\\n\", __func__, -EINVAL);\n\t\treturn -EINVAL;\n\t}\n\n\tdev_dbg(&d->udev->dev, \"%s: >>> %*ph\\n\", __func__, wlen, wbuf);\n\n\tret = usb_bulk_msg(d->udev, usb_sndbulkpipe(d->udev,\n\t\t\td->props->generic_bulk_ctrl_endpoint), wbuf, wlen,\n\t\t\t&actual_length, 2000);\n\tif (ret) {\n\t\tdev_err(&d->udev->dev, \"%s: usb_bulk_msg() failed=%d\\n\",\n\t\t\t\tKBUILD_MODNAME, ret);\n\t\treturn ret;\n\t}\n\tif (actual_length != wlen) {\n\t\tdev_err(&d->udev->dev, \"%s: usb_bulk_msg() write length=%d, actual=%d\\n\",\n\t\t\tKBUILD_MODNAME, wlen, actual_length);\n\t\treturn -EIO;\n\t}\n\n\t \n\tif (rbuf && rlen) {\n\t\tif (d->props->generic_bulk_ctrl_delay)\n\t\t\tusleep_range(d->props->generic_bulk_ctrl_delay,\n\t\t\t\t\td->props->generic_bulk_ctrl_delay\n\t\t\t\t\t+ 20000);\n\n\t\tret = usb_bulk_msg(d->udev, usb_rcvbulkpipe(d->udev,\n\t\t\t\td->props->generic_bulk_ctrl_endpoint_response),\n\t\t\t\trbuf, rlen, &actual_length, 2000);\n\t\tif (ret)\n\t\t\tdev_err(&d->udev->dev,\n\t\t\t\t\t\"%s: 2nd usb_bulk_msg() failed=%d\\n\",\n\t\t\t\t\tKBUILD_MODNAME, ret);\n\n\t\tdev_dbg(&d->udev->dev, \"%s: <<< %*ph\\n\", __func__,\n\t\t\t\tactual_length, rbuf);\n\t}\n\n\treturn ret;\n}\n\nint dvb_usbv2_generic_rw(struct dvb_usb_device *d,\n\t\tu8 *wbuf, u16 wlen, u8 *rbuf, u16 rlen)\n{\n\tint ret;\n\n\tmutex_lock(&d->usb_mutex);\n\tret = dvb_usb_v2_generic_io(d, wbuf, wlen, rbuf, rlen);\n\tmutex_unlock(&d->usb_mutex);\n\n\treturn ret;\n}\nEXPORT_SYMBOL(dvb_usbv2_generic_rw);\n\nint dvb_usbv2_generic_write(struct dvb_usb_device *d, u8 *buf, u16 len)\n{\n\tint ret;\n\n\tmutex_lock(&d->usb_mutex);\n\tret = dvb_usb_v2_generic_io(d, buf, len, NULL, 0);\n\tmutex_unlock(&d->usb_mutex);\n\n\treturn ret;\n}\nEXPORT_SYMBOL(dvb_usbv2_generic_write);\n\nint dvb_usbv2_generic_rw_locked(struct dvb_usb_device *d,\n\t\tu8 *wbuf, u16 wlen, u8 *rbuf, u16 rlen)\n{\n\treturn dvb_usb_v2_generic_io(d, wbuf, wlen, rbuf, rlen);\n}\nEXPORT_SYMBOL(dvb_usbv2_generic_rw_locked);\n\nint dvb_usbv2_generic_write_locked(struct dvb_usb_device *d, u8 *buf, u16 len)\n{\n\treturn dvb_usb_v2_generic_io(d, buf, len, NULL, 0);\n}\nEXPORT_SYMBOL(dvb_usbv2_generic_write_locked);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}