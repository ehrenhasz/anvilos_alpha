{
  "module_name": "usbtv.h",
  "hash_id": "63abb98630c1f5912f306b71d9b94e497c0e75b998b1ca9d01103963d0ea6b64",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/usbtv/usbtv.h",
  "human_readable_source": " \n \n\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/usb.h>\n\n#include <media/v4l2-device.h>\n#include <media/v4l2-ctrls.h>\n#include <media/videobuf2-v4l2.h>\n#include <media/videobuf2-vmalloc.h>\n\n \n#define USBTV_VIDEO_ENDP\t0x81\n#define USBTV_AUDIO_ENDP\t0x83\n#define USBTV_BASE\t\t0xc000\n#define USBTV_CONTROL_REG\t11\n#define USBTV_REQUEST_REG\t12\n\n \n#define USBTV_ISOC_TRANSFERS\t16\n#define USBTV_ISOC_PACKETS\t8\n\n#define USBTV_CHUNK_SIZE\t256\n#define USBTV_CHUNK\t\t240\n\n#define USBTV_AUDIO_URBSIZE\t20480\n#define USBTV_AUDIO_HDRSIZE\t4\n#define USBTV_AUDIO_BUFFER\t65536\n\n \n#define USBTV_MAGIC_OK(chunk)\t((be32_to_cpu(chunk[0]) & 0xff000000) \\\n\t\t\t\t\t\t\t== 0x88000000)\n#define USBTV_FRAME_ID(chunk)\t((be32_to_cpu(chunk[0]) & 0x00ff0000) >> 16)\n#define USBTV_ODD(chunk)\t((be32_to_cpu(chunk[0]) & 0x0000f000) >> 15)\n#define USBTV_CHUNK_NO(chunk)\t(be32_to_cpu(chunk[0]) & 0x00000fff)\n\n#define USBTV_TV_STD\t\t(V4L2_STD_525_60 | V4L2_STD_PAL | \\\n\t\t\t\t V4L2_STD_PAL_Nc | V4L2_STD_SECAM)\n\n \nstruct usbtv_norm_params {\n\tv4l2_std_id norm;\n\tint cap_width, cap_height;\n};\n\n \nstruct usbtv_buf {\n\tstruct vb2_v4l2_buffer vb;\n\tstruct list_head list;\n};\n\n \nstruct usbtv {\n\tstruct device *dev;\n\tstruct usb_device *udev;\n\n\t \n\tstruct v4l2_device v4l2_dev;\n\tstruct v4l2_ctrl_handler ctrl;\n\tstruct video_device vdev;\n\tstruct vb2_queue vb2q;\n\tstruct mutex v4l2_lock;\n\tstruct mutex vb2q_lock;\n\n\t \n\tspinlock_t buflock;\n\tstruct list_head bufs;\n\n\t \n\tu32 frame_id;\n\tint chunks_done;\n\n\tenum {\n\t\tUSBTV_COMPOSITE_INPUT,\n\t\tUSBTV_SVIDEO_INPUT,\n\t} input;\n\tv4l2_std_id norm;\n\tint width, height;\n\tint n_chunks;\n\tint iso_size;\n\tint last_odd;\n\tunsigned int sequence;\n\tstruct urb *isoc_urbs[USBTV_ISOC_TRANSFERS];\n\n\t \n\tstruct snd_card *snd;\n\tstruct snd_pcm_substream *snd_substream;\n\tatomic_t snd_stream;\n\tstruct work_struct snd_trigger;\n\tstruct urb *snd_bulk_urb;\n\tsize_t snd_buffer_pos;\n\tsize_t snd_period_pos;\n};\n\nint usbtv_set_regs(struct usbtv *usbtv, const u16 regs[][2], int size);\n\nint usbtv_video_init(struct usbtv *usbtv);\nvoid usbtv_video_free(struct usbtv *usbtv);\n\nint usbtv_audio_init(struct usbtv *usbtv);\nvoid usbtv_audio_free(struct usbtv *usbtv);\nvoid usbtv_audio_suspend(struct usbtv *usbtv);\nvoid usbtv_audio_resume(struct usbtv *usbtv);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}