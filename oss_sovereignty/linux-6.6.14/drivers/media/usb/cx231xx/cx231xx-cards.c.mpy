{
  "module_name": "cx231xx-cards.c",
  "hash_id": "f295c1c3ffe5dda8f9d0e4700ad1ccf539e08990bec4a2b7e13e630b73d9a9e7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/cx231xx/cx231xx-cards.c",
  "human_readable_source": "\n \n\n#include \"cx231xx.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n#include <linux/delay.h>\n#include <linux/i2c.h>\n#include <media/tuner.h>\n#include <media/tveeprom.h>\n#include <media/v4l2-common.h>\n\n#include <media/drv-intf/cx25840.h>\n#include <media/dvb-usb-ids.h>\n#include \"xc5000.h\"\n#include \"tda18271.h\"\n\n\nstatic int tuner = -1;\nmodule_param(tuner, int, 0444);\nMODULE_PARM_DESC(tuner, \"tuner type\");\n\nstatic int transfer_mode = 1;\nmodule_param(transfer_mode, int, 0444);\nMODULE_PARM_DESC(transfer_mode, \"transfer mode (1-ISO or 0-BULK)\");\n\nstatic unsigned int disable_ir;\nmodule_param(disable_ir, int, 0444);\nMODULE_PARM_DESC(disable_ir, \"disable infrared remote support\");\n\n \nstatic unsigned long cx231xx_devused;\n\n \n\nstatic struct cx231xx_reg_seq RDE250_XCV_TUNER[] = {\n\t{0x03, 0x01, 10},\n\t{0x03, 0x00, 30},\n\t{0x03, 0x01, 10},\n\t{-1, -1, -1},\n};\n\n \nstruct cx231xx_board cx231xx_boards[] = {\n\t[CX231XX_BOARD_UNKNOWN] = {\n\t\t.name = \"Unknown CX231xx video grabber\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_CARRAERA] = {\n\t\t.name = \"Conexant Hybrid TV - CARRAERA\",\n\t\t.tuner_type = TUNER_XC5000,\n\t\t.tuner_addr = 0x61,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x02,\n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_SHELBY] = {\n\t\t.name = \"Conexant Hybrid TV - SHELBY\",\n\t\t.tuner_type = TUNER_XC5000,\n\t\t.tuner_addr = 0x61,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x32,\n\t\t.norm = V4L2_STD_NTSC,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_RDE_253S] = {\n\t\t.name = \"Conexant Hybrid TV - RDE253S\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x1c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x02,\n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\n\t[CX231XX_BOARD_CNXT_RDU_253S] = {\n\t\t.name = \"Conexant Hybrid TV - RDU253S\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x1c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x02,\n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_VIDEO_GRABBER] = {\n\t\t.name = \"Conexant VIDEO GRABBER\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x1c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_PAL,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t \n\t\t.has_417 = 0,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_RDE_250] = {\n\t\t.name = \"Conexant Hybrid TV - rde 250\",\n\t\t.tuner_type = TUNER_XC5000,\n\t\t.tuner_addr = 0x61,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x02,\n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_CNXT_RDU_250] = {\n\t\t.name = \"Conexant Hybrid TV - RDU 250\",\n\t\t.tuner_type = TUNER_XC5000,\n\t\t.tuner_addr = 0x61,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x32,\n\t\t.norm = V4L2_STD_NTSC,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_EXETER] = {\n\t\t.name = \"Hauppauge EXETER\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_1,\n\t\t.demod_i2c_master = I2C_1_MUX_1,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x0e,\n\t\t.norm = V4L2_STD_NTSC,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_USBLIVE2] = {\n\t\t.name = \"Hauppauge USB Live 2\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_NTSC,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_KWORLD_UB430_USB_HYBRID] = {\n\t\t.name = \"Kworld UB430 USB Hybrid\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x11,\t \n\t\t.tuner_sif_gpio = -1,\n\t\t.tuner_scl_gpio = -1,\n\t\t.tuner_sda_gpio = -1,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_2,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.ir_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x10,\n\t\t.norm = V4L2_STD_PAL_M,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_KWORLD_UB445_USB_HYBRID] = {\n\t\t.name = \"Kworld UB445 USB Hybrid\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x11,\t \n\t\t.tuner_sif_gpio = -1,\n\t\t.tuner_scl_gpio = -1,\n\t\t.tuner_sda_gpio = -1,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_2,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.ir_i2c_master = I2C_2,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x10,\n\t\t.norm = V4L2_STD_NTSC_M,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_PV_PLAYTV_USB_HYBRID] = {\n\t\t.name = \"Pixelview PlayTV USB Hybrid\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x1c,\n\t\t.tuner_sif_gpio = -1,\n\t\t.tuner_scl_gpio = -1,\n\t\t.tuner_sda_gpio = -1,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_2,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.ir_i2c_master = I2C_2,\n\t\t.rc_map_name = RC_MAP_PIXELVIEW_002T,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x10,\n\t\t.norm = V4L2_STD_PAL_M,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_PV_XCAPTURE_USB] = {\n\t\t.name = \"Pixelview Xcapture USB\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_NTSC,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\n\t[CX231XX_BOARD_ICONBIT_U100] = {\n\t\t.name = \"Iconbit Analog Stick U100 FM\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x1C,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_USB2_FM_PAL] = {\n\t\t.name = \"Hauppauge WinTV USB2 FM (PAL)\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_USB2_FM_NTSC] = {\n\t\t.name = \"Hauppauge WinTV USB2 FM (NTSC)\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.norm = V4L2_STD_NTSC,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_ELGATO_VIDEO_CAPTURE_V2] = {\n\t\t.name = \"Elgato Video Capture V2\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_NTSC,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_OTG102] = {\n\t\t.name = \"Geniatech OTG102\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t\t \n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_NTSC,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t \n\t\t \n\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t\t.gpio = NULL,\n\t\t\t}\n\t\t},\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_930C_HD_1113xx] = {\n\t\t.name = \"Hauppauge WinTV 930C-HD (1113xx) / HVR-900H (111xxx) / PCTV QuatroStick 521e\",\n\t\t.tuner_type = TUNER_NXP_TDA18271,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x64,  \n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_930C_HD_1114xx] = {\n\t\t.name = \"Hauppauge WinTV 930C-HD (1114xx) / HVR-901H (1114xx) / PCTV QuatroStick 522e\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x64,  \n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_955Q] = {\n\t\t.name = \"Hauppauge WinTV-HVR-955Q (111401)\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x59,  \n\t\t.norm = V4L2_STD_NTSC,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_TERRATEC_GRABBY] = {\n\t\t.name = \"Terratec Grabby\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_PAL,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_EVROMEDIA_FULL_HYBRID_FULLHD] = {\n\t\t.name = \"Evromedia USB Full Hybrid Full HD\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.demod_addr = 0x64,  \n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.norm = V4L2_STD_PAL,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.tuner_addr = 0x60,  \n\t\t.tuner_i2c_master = I2C_2,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = 0,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_ASTROMETA_T2HYBRID] = {\n\t\t.name = \"Astrometa T2hybrid\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.has_dvb = 1,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.agc_analog_digital_select_gpio = 0x01,\n\t\t.ctl_pin_status_mask = 0xffffffc4,\n\t\t.demod_addr = 0x18,  \n\t\t.demod_i2c_master = I2C_1_MUX_1,\n\t\t.gpio_pin_status_mask = 0xa,\n\t\t.norm = V4L2_STD_NTSC,\n\t\t.tuner_addr = 0x3a,  \n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.input = {{\n\t\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t\t.vmux = CX231XX_VIN_1_1,\n\t\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t}, {\n\t\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t},\n\t\t},\n\t},\n\t[CX231XX_BOARD_THE_IMAGING_SOURCE_DFG_USB2_PRO] = {\n\t\t.name = \"The Imaging Source DFG/USB2pro\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.norm = V4L2_STD_PAL,\n\t\t.no_alt_vanc = 1,\n\t\t.external_av = 1,\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_1_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_2_1 |\n\t\t\t\t(CX231XX_VIN_2_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_935C] = {\n\t\t.name = \"Hauppauge WinTV-HVR-935C\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x64,  \n\t\t.norm = V4L2_STD_PAL,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n\t[CX231XX_BOARD_HAUPPAUGE_975] = {\n\t\t.name = \"Hauppauge WinTV-HVR-975\",\n\t\t.tuner_type = TUNER_ABSENT,\n\t\t.tuner_addr = 0x60,\n\t\t.tuner_gpio = RDE250_XCV_TUNER,\n\t\t.tuner_sif_gpio = 0x05,\n\t\t.tuner_scl_gpio = 0x1a,\n\t\t.tuner_sda_gpio = 0x1b,\n\t\t.decoder = CX231XX_AVDECODER,\n\t\t.output_mode = OUT_MODE_VIP11,\n\t\t.demod_xfer_mode = 0,\n\t\t.ctl_pin_status_mask = 0xFFFFFFC4,\n\t\t.agc_analog_digital_select_gpio = 0x0c,\n\t\t.gpio_pin_status_mask = 0x4001000,\n\t\t.tuner_i2c_master = I2C_1_MUX_3,\n\t\t.demod_i2c_master = I2C_1_MUX_3,\n\t\t.has_dvb = 1,\n\t\t.demod_addr = 0x59,  \n\t\t.demod_addr2 = 0x64,  \n\t\t.norm = V4L2_STD_ALL,\n\n\t\t.input = {{\n\t\t\t.type = CX231XX_VMUX_TELEVISION,\n\t\t\t.vmux = CX231XX_VIN_3_1,\n\t\t\t.amux = CX231XX_AMUX_VIDEO,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_COMPOSITE1,\n\t\t\t.vmux = CX231XX_VIN_2_1,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t}, {\n\t\t\t.type = CX231XX_VMUX_SVIDEO,\n\t\t\t.vmux = CX231XX_VIN_1_1 |\n\t\t\t\t(CX231XX_VIN_1_2 << 8) |\n\t\t\t\tCX25840_SVIDEO_ON,\n\t\t\t.amux = CX231XX_AMUX_LINE_IN,\n\t\t\t.gpio = NULL,\n\t\t} },\n\t},\n};\nconst unsigned int cx231xx_bcount = ARRAY_SIZE(cx231xx_boards);\n\n \nstruct usb_device_id cx231xx_id_table[] = {\n\t{USB_DEVICE(0x1D19, 0x6109),\n\t.driver_info = CX231XX_BOARD_PV_XCAPTURE_USB},\n\t{USB_DEVICE(0x0572, 0x5A3C),\n\t .driver_info = CX231XX_BOARD_UNKNOWN},\n\t{USB_DEVICE(0x0572, 0x58A2),\n\t .driver_info = CX231XX_BOARD_CNXT_CARRAERA},\n\t{USB_DEVICE(0x0572, 0x58A1),\n\t .driver_info = CX231XX_BOARD_CNXT_SHELBY},\n\t{USB_DEVICE(0x0572, 0x58A4),\n\t .driver_info = CX231XX_BOARD_CNXT_RDE_253S},\n\t{USB_DEVICE(0x0572, 0x58A5),\n\t .driver_info = CX231XX_BOARD_CNXT_RDU_253S},\n\t{USB_DEVICE(0x0572, 0x58A6),\n\t .driver_info = CX231XX_BOARD_CNXT_VIDEO_GRABBER},\n\t{USB_DEVICE(0x0572, 0x589E),\n\t .driver_info = CX231XX_BOARD_CNXT_RDE_250},\n\t{USB_DEVICE(0x0572, 0x58A0),\n\t .driver_info = CX231XX_BOARD_CNXT_RDU_250},\n\t \n\t{USB_DEVICE(0x07ca, 0xc039),\n\t .driver_info = CX231XX_BOARD_CNXT_VIDEO_GRABBER},\n\t{USB_DEVICE(0x2040, 0xb110),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_USB2_FM_PAL},\n\t{USB_DEVICE(0x2040, 0xb111),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_USB2_FM_NTSC},\n\t{USB_DEVICE(0x2040, 0xb120),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_EXETER},\n\t{USB_DEVICE(0x2040, 0xb123),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_955Q},\n\t{USB_DEVICE(0x2040, 0xb124),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_955Q},\n\t{USB_DEVICE(0x2040, 0xb151),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_935C},\n\t{USB_DEVICE(0x2040, 0xb150),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_975},\n\t{USB_DEVICE(0x2040, 0xb130),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1113xx},\n\t{USB_DEVICE(0x2040, 0xb131),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1114xx},\n\t \n\t{USB_DEVICE(0x2040, 0xb138),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1113xx},\n\t \n\t{USB_DEVICE(0x2040, 0xb139),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1114xx},\n\t{USB_DEVICE(0x2040, 0xb140),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_EXETER},\n\t{USB_DEVICE(0x2040, 0xc200),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_USBLIVE2},\n\t \n\t{USB_DEVICE(0x2013, 0x0259),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1113xx},\n\t \n\t{USB_DEVICE(0x2013, 0x025e),\n\t .driver_info = CX231XX_BOARD_HAUPPAUGE_930C_HD_1114xx},\n\t{USB_DEVICE_VER(USB_VID_PIXELVIEW, USB_PID_PIXELVIEW_SBTVD, 0x4000, 0x4001),\n\t .driver_info = CX231XX_BOARD_PV_PLAYTV_USB_HYBRID},\n\t{USB_DEVICE(USB_VID_PIXELVIEW, 0x5014),\n\t .driver_info = CX231XX_BOARD_PV_XCAPTURE_USB},\n\t{USB_DEVICE(0x1b80, 0xe424),\n\t .driver_info = CX231XX_BOARD_KWORLD_UB430_USB_HYBRID},\n\t{USB_DEVICE(0x1b80, 0xe421),\n\t .driver_info = CX231XX_BOARD_KWORLD_UB445_USB_HYBRID},\n\t{USB_DEVICE(0x1f4d, 0x0237),\n\t .driver_info = CX231XX_BOARD_ICONBIT_U100},\n\t{USB_DEVICE(0x0fd9, 0x0037),\n\t .driver_info = CX231XX_BOARD_ELGATO_VIDEO_CAPTURE_V2},\n\t{USB_DEVICE(0x1f4d, 0x0102),\n\t .driver_info = CX231XX_BOARD_OTG102},\n\t{USB_DEVICE(USB_VID_TERRATEC, 0x00a6),\n\t .driver_info = CX231XX_BOARD_TERRATEC_GRABBY},\n\t{USB_DEVICE(0x1b80, 0xd3b2),\n\t.driver_info = CX231XX_BOARD_EVROMEDIA_FULL_HYBRID_FULLHD},\n\t{USB_DEVICE(0x15f4, 0x0135),\n\t.driver_info = CX231XX_BOARD_ASTROMETA_T2HYBRID},\n\t{USB_DEVICE(0x199e, 0x8002),\n\t .driver_info = CX231XX_BOARD_THE_IMAGING_SOURCE_DFG_USB2_PRO},\n\t{},\n};\n\nMODULE_DEVICE_TABLE(usb, cx231xx_id_table);\n\n \n\nint cx231xx_tuner_callback(void *ptr, int component, int command, int arg)\n{\n\tint rc = 0;\n\tstruct cx231xx *dev = ptr;\n\n\tif (dev->tuner_type == TUNER_XC5000) {\n\t\tif (command == XC5000_TUNER_RESET) {\n\t\t\tdev_dbg(dev->dev,\n\t\t\t\t\"Tuner CB: RESET: cmd %d : tuner type %d\\n\",\n\t\t\t\tcommand, dev->tuner_type);\n\t\t\tcx231xx_set_gpio_value(dev, dev->board.tuner_gpio->bit,\n\t\t\t\t\t       1);\n\t\t\tmsleep(10);\n\t\t\tcx231xx_set_gpio_value(dev, dev->board.tuner_gpio->bit,\n\t\t\t\t\t       0);\n\t\t\tmsleep(330);\n\t\t\tcx231xx_set_gpio_value(dev, dev->board.tuner_gpio->bit,\n\t\t\t\t\t       1);\n\t\t\tmsleep(10);\n\t\t}\n\t} else if (dev->tuner_type == TUNER_NXP_TDA18271) {\n\t\tswitch (command) {\n\t\tcase TDA18271_CALLBACK_CMD_AGC_ENABLE:\n\t\t\tif (dev->model == CX231XX_BOARD_PV_PLAYTV_USB_HYBRID)\n\t\t\t\trc = cx231xx_set_agc_analog_digital_mux_select(dev, arg);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\trc = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn rc;\n}\nEXPORT_SYMBOL_GPL(cx231xx_tuner_callback);\n\nstatic void cx231xx_reset_out(struct cx231xx *dev)\n{\n\tcx231xx_set_gpio_value(dev, CX23417_RESET, 1);\n\tmsleep(200);\n\tcx231xx_set_gpio_value(dev, CX23417_RESET, 0);\n\tmsleep(200);\n\tcx231xx_set_gpio_value(dev, CX23417_RESET, 1);\n}\n\nstatic void cx231xx_enable_OSC(struct cx231xx *dev)\n{\n\tcx231xx_set_gpio_value(dev, CX23417_OSC_EN, 1);\n}\n\nstatic void cx231xx_sleep_s5h1432(struct cx231xx *dev)\n{\n\tcx231xx_set_gpio_value(dev, SLEEP_S5H1432, 0);\n}\n\nstatic inline void cx231xx_set_model(struct cx231xx *dev)\n{\n\tdev->board = cx231xx_boards[dev->model];\n}\n\n \nvoid cx231xx_pre_card_setup(struct cx231xx *dev)\n{\n\tdev_info(dev->dev, \"Identified as %s (card=%d)\\n\",\n\t\tdev->board.name, dev->model);\n\n\tif (CX231XX_BOARD_ASTROMETA_T2HYBRID == dev->model) {\n\t\t \n\t\tcx231xx_set_gpio_value(dev, 0x03, 0x01);\n\t}\n\n\t \n\tif (dev->board.tuner_gpio) {\n\t\tcx231xx_set_gpio_direction(dev, dev->board.tuner_gpio->bit, 1);\n\t\tcx231xx_set_gpio_value(dev, dev->board.tuner_gpio->bit, 1);\n\t}\n\tif (dev->board.tuner_sif_gpio >= 0)\n\t\tcx231xx_set_gpio_direction(dev, dev->board.tuner_sif_gpio, 1);\n\n\t \n\n\t \n\tcx231xx_set_mode(dev, CX231XX_ANALOG_MODE);\n\n\t \n\t \n\n}\n\nstatic void cx231xx_config_tuner(struct cx231xx *dev)\n{\n\tstruct tuner_setup tun_setup;\n\tstruct v4l2_frequency f;\n\n\tif (dev->tuner_type == TUNER_ABSENT)\n\t\treturn;\n\n\ttun_setup.mode_mask = T_ANALOG_TV | T_RADIO;\n\ttun_setup.type = dev->tuner_type;\n\ttun_setup.addr = dev->tuner_addr;\n\ttun_setup.tuner_callback = cx231xx_tuner_callback;\n\n\ttuner_call(dev, tuner, s_type_addr, &tun_setup);\n\n#if 0\n\tif (tun_setup.type == TUNER_XC5000) {\n\t\tstatic struct xc2028_ctrl ctrl = {\n\t\t\t.fname = XC5000_DEFAULT_FIRMWARE,\n\t\t\t.max_len = 64,\n\t\t\t.demod = 0;\n\t\t};\n\t\tstruct v4l2_priv_tun_config cfg = {\n\t\t\t.tuner = dev->tuner_type,\n\t\t\t.priv = &ctrl,\n\t\t};\n\t\ttuner_call(dev, tuner, s_config, &cfg);\n\t}\n#endif\n\t \n\tf.tuner = 0;\n\tf.type = V4L2_TUNER_ANALOG_TV;\n\tf.frequency = 9076;\t \n\tdev->ctl_freq = f.frequency;\n\tcall_all(dev, tuner, s_frequency, &f);\n\n}\n\nstatic int read_eeprom(struct cx231xx *dev, struct i2c_client *client,\n\t\t       u8 *eedata, int len)\n{\n\tint ret;\n\tu8 start_offset = 0;\n\tint len_todo = len;\n\tu8 *eedata_cur = eedata;\n\tint i;\n\tstruct i2c_msg msg_write = { .addr = client->addr, .flags = 0,\n\t\t.buf = &start_offset, .len = 1 };\n\tstruct i2c_msg msg_read = { .addr = client->addr, .flags = I2C_M_RD };\n\n\t \n\tret = i2c_transfer(client->adapter, &msg_write, 1);\n\tif (ret < 0) {\n\t\tdev_err(dev->dev, \"Can't read eeprom\\n\");\n\t\treturn ret;\n\t}\n\n\twhile (len_todo > 0) {\n\t\tmsg_read.len = (len_todo > 64) ? 64 : len_todo;\n\t\tmsg_read.buf = eedata_cur;\n\n\t\tret = i2c_transfer(client->adapter, &msg_read, 1);\n\t\tif (ret < 0) {\n\t\t\tdev_err(dev->dev, \"Can't read eeprom\\n\");\n\t\t\treturn ret;\n\t\t}\n\t\teedata_cur += msg_read.len;\n\t\tlen_todo -= msg_read.len;\n\t}\n\n\tfor (i = 0; i + 15 < len; i += 16)\n\t\tdev_dbg(dev->dev, \"i2c eeprom %02x: %*ph\\n\",\n\t\t\ti, 16, &eedata[i]);\n\n\treturn 0;\n}\n\nvoid cx231xx_card_setup(struct cx231xx *dev)\n{\n\n\tcx231xx_set_model(dev);\n\n\tdev->tuner_type = cx231xx_boards[dev->model].tuner_type;\n\tif (cx231xx_boards[dev->model].tuner_addr)\n\t\tdev->tuner_addr = cx231xx_boards[dev->model].tuner_addr;\n\n\t \n\tif (dev->board.decoder == CX231XX_AVDECODER) {\n\t\tdev->sd_cx25840 = v4l2_i2c_new_subdev(&dev->v4l2_dev,\n\t\t\t\t\tcx231xx_get_i2c_adap(dev, I2C_0),\n\t\t\t\t\t\"cx25840\", 0x88 >> 1, NULL);\n\t\tif (dev->sd_cx25840 == NULL)\n\t\t\tdev_err(dev->dev,\n\t\t\t\t\"cx25840 subdev registration failure\\n\");\n\t\tcx25840_call(dev, core, load_fw);\n\n\t}\n\n\t \n\tif (dev->board.tuner_type != TUNER_ABSENT) {\n\t\tstruct i2c_adapter *tuner_i2c = cx231xx_get_i2c_adap(dev,\n\t\t\t\t\t\tdev->board.tuner_i2c_master);\n\t\tdev->sd_tuner = v4l2_i2c_new_subdev(&dev->v4l2_dev,\n\t\t\t\t\t\t    tuner_i2c,\n\t\t\t\t\t\t    \"tuner\",\n\t\t\t\t\t\t    dev->tuner_addr, NULL);\n\t\tif (dev->sd_tuner == NULL)\n\t\t\tdev_err(dev->dev,\n\t\t\t\t\"tuner subdev registration failure\\n\");\n\t\telse\n\t\t\tcx231xx_config_tuner(dev);\n\t}\n\n\tswitch (dev->model) {\n\tcase CX231XX_BOARD_HAUPPAUGE_930C_HD_1113xx:\n\tcase CX231XX_BOARD_HAUPPAUGE_930C_HD_1114xx:\n\tcase CX231XX_BOARD_HAUPPAUGE_955Q:\n\tcase CX231XX_BOARD_HAUPPAUGE_935C:\n\tcase CX231XX_BOARD_HAUPPAUGE_975:\n\t\t{\n\t\t\tstruct eeprom {\n\t\t\t\tstruct tveeprom tvee;\n\t\t\t\tu8 eeprom[256];\n\t\t\t\tstruct i2c_client client;\n\t\t\t};\n\t\t\tstruct eeprom *e = kzalloc(sizeof(*e), GFP_KERNEL);\n\n\t\t\tif (e == NULL) {\n\t\t\t\tdev_err(dev->dev,\n\t\t\t\t\t\"failed to allocate memory to read eeprom\\n\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\te->client.adapter = cx231xx_get_i2c_adap(dev, I2C_1_MUX_1);\n\t\t\te->client.addr = 0xa0 >> 1;\n\n\t\t\tread_eeprom(dev, &e->client, e->eeprom, sizeof(e->eeprom));\n\t\t\ttveeprom_hauppauge_analog(&e->tvee, e->eeprom + 0xc0);\n\t\t\tkfree(e);\n\t\t\tbreak;\n\t\t}\n\t}\n\n}\n\n \nint cx231xx_config(struct cx231xx *dev)\n{\n\t \n\n\treturn 0;\n}\n\n \nvoid cx231xx_config_i2c(struct cx231xx *dev)\n{\n\t \n\n\tcall_all(dev, video, s_stream, 1);\n}\n\nstatic void cx231xx_unregister_media_device(struct cx231xx *dev)\n{\n#ifdef CONFIG_MEDIA_CONTROLLER\n\tif (dev->media_dev) {\n\t\tmedia_device_unregister(dev->media_dev);\n\t\tmedia_device_cleanup(dev->media_dev);\n\t\tkfree(dev->media_dev);\n\t\tdev->media_dev = NULL;\n\t}\n#endif\n}\n\n \nvoid cx231xx_release_resources(struct cx231xx *dev)\n{\n\tcx231xx_ir_exit(dev);\n\n\tcx231xx_release_analog_resources(dev);\n\n\tcx231xx_remove_from_devlist(dev);\n\n\t \n\tcx231xx_dev_uninit(dev);\n\n\t \n\tv4l2_device_unregister(&dev->v4l2_dev);\n\n\tcx231xx_unregister_media_device(dev);\n\n\tusb_put_dev(dev->udev);\n\n\t \n\tclear_bit(dev->devno, &cx231xx_devused);\n}\n\nstatic int cx231xx_media_device_init(struct cx231xx *dev,\n\t\t\t\t      struct usb_device *udev)\n{\n#ifdef CONFIG_MEDIA_CONTROLLER\n\tstruct media_device *mdev;\n\n\tmdev = kzalloc(sizeof(*mdev), GFP_KERNEL);\n\tif (!mdev)\n\t\treturn -ENOMEM;\n\n\tmedia_device_usb_init(mdev, udev, dev->board.name);\n\n\tdev->media_dev = mdev;\n#endif\n\treturn 0;\n}\n\n \nstatic int cx231xx_init_dev(struct cx231xx *dev, struct usb_device *udev,\n\t\t\t    int minor)\n{\n\tint retval = -ENOMEM;\n\tunsigned int maxh, maxw;\n\n\tdev->udev = udev;\n\tmutex_init(&dev->lock);\n\tmutex_init(&dev->ctrl_urb_lock);\n\tmutex_init(&dev->gpio_i2c_lock);\n\tmutex_init(&dev->i2c_lock);\n\n\tspin_lock_init(&dev->video_mode.slock);\n\tspin_lock_init(&dev->vbi_mode.slock);\n\tspin_lock_init(&dev->sliced_cc_mode.slock);\n\n\tinit_waitqueue_head(&dev->open);\n\tinit_waitqueue_head(&dev->wait_frame);\n\tinit_waitqueue_head(&dev->wait_stream);\n\n\tdev->cx231xx_read_ctrl_reg = cx231xx_read_ctrl_reg;\n\tdev->cx231xx_write_ctrl_reg = cx231xx_write_ctrl_reg;\n\tdev->cx231xx_send_usb_command = cx231xx_send_usb_command;\n\tdev->cx231xx_gpio_i2c_read = cx231xx_gpio_i2c_read;\n\tdev->cx231xx_gpio_i2c_write = cx231xx_gpio_i2c_write;\n\n\t \n\tretval = initialize_cx231xx(dev);\n\tif (retval < 0) {\n\t\tdev_err(dev->dev, \"Failed to read PCB config\\n\");\n\t\treturn retval;\n\t}\n\n\t \n\tif (dev->model == CX231XX_BOARD_CNXT_VIDEO_GRABBER ||\n\t    dev->model == CX231XX_BOARD_HAUPPAUGE_USBLIVE2) {\n\t\tcx231xx_set_alt_setting(dev, INDEX_VIDEO, 3);\n\t\tcx231xx_set_alt_setting(dev, INDEX_VANC, 1);\n\t}\n\t \n\tcx231xx_pre_card_setup(dev);\n\n\tretval = cx231xx_config(dev);\n\tif (retval) {\n\t\tdev_err(dev->dev, \"error configuring device\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\t \n\tdev->norm = dev->board.norm;\n\n\t \n\tretval = cx231xx_dev_init(dev);\n\tif (retval) {\n\t\tdev_err(dev->dev,\n\t\t\t\"%s: cx231xx_i2c_register - errCode [%d]!\\n\",\n\t\t\t__func__, retval);\n\t\tgoto err_dev_init;\n\t}\n\n\t \n\tcx231xx_card_setup(dev);\n\n\t \n\tcx231xx_config_i2c(dev);\n\n\tmaxw = norm_maxw(dev);\n\tmaxh = norm_maxh(dev);\n\n\t \n\tdev->width = maxw;\n\tdev->height = maxh;\n\tdev->interlaced = 0;\n\tdev->video_input = 0;\n\n\tretval = cx231xx_config(dev);\n\tif (retval) {\n\t\tdev_err(dev->dev, \"%s: cx231xx_config - errCode [%d]!\\n\",\n\t\t\t__func__, retval);\n\t\tgoto err_dev_init;\n\t}\n\n\t \n\tINIT_LIST_HEAD(&dev->video_mode.vidq.active);\n\n\t \n\tINIT_LIST_HEAD(&dev->vbi_mode.vidq.active);\n\n\t \n\tcx231xx_add_into_devlist(dev);\n\n\tif (dev->board.has_417) {\n\t\tdev_info(dev->dev, \"attach 417 %d\\n\", dev->model);\n\t\tif (cx231xx_417_register(dev) < 0) {\n\t\t\tdev_err(dev->dev,\n\t\t\t\t\"%s() Failed to register 417 on VID_B\\n\",\n\t\t\t\t__func__);\n\t\t}\n\t}\n\n\tretval = cx231xx_register_analog_devices(dev);\n\tif (retval)\n\t\tgoto err_analog;\n\n\tcx231xx_ir_init(dev);\n\n\tcx231xx_init_extension(dev);\n\n\treturn 0;\nerr_analog:\n\tcx231xx_unregister_media_device(dev);\n\tcx231xx_release_analog_resources(dev);\n\tcx231xx_remove_from_devlist(dev);\nerr_dev_init:\n\tcx231xx_dev_uninit(dev);\n\treturn retval;\n}\n\n#if defined(CONFIG_MODULES) && defined(MODULE)\nstatic void request_module_async(struct work_struct *work)\n{\n\tstruct cx231xx *dev = container_of(work,\n\t\t\t\t\t   struct cx231xx, request_module_wk);\n\n\tif (dev->has_alsa_audio)\n\t\trequest_module(\"cx231xx-alsa\");\n\n\tif (dev->board.has_dvb)\n\t\trequest_module(\"cx231xx-dvb\");\n\n}\n\nstatic void request_modules(struct cx231xx *dev)\n{\n\tINIT_WORK(&dev->request_module_wk, request_module_async);\n\tschedule_work(&dev->request_module_wk);\n}\n\nstatic void flush_request_modules(struct cx231xx *dev)\n{\n\tflush_work(&dev->request_module_wk);\n}\n#else\n#define request_modules(dev)\n#define flush_request_modules(dev)\n#endif  \n\nstatic int cx231xx_init_v4l2(struct cx231xx *dev,\n\t\t\t     struct usb_device *udev,\n\t\t\t     struct usb_interface *interface,\n\t\t\t     int isoc_pipe)\n{\n\tstruct usb_interface *uif;\n\tint i, idx;\n\n\t \n\n\t \n\tidx = dev->current_pcb_config.hs_config_info[0].interface_info.video_index + 1;\n\tif (idx >= dev->max_iad_interface_count) {\n\t\tdev_err(dev->dev,\n\t\t\t\"Video PCB interface #%d doesn't exist\\n\", idx);\n\t\treturn -ENODEV;\n\t}\n\n\tuif = udev->actconfig->interface[idx];\n\n\tif (uif->altsetting[0].desc.bNumEndpoints < isoc_pipe + 1)\n\t\treturn -ENODEV;\n\n\tdev->video_mode.end_point_addr = uif->altsetting[0].endpoint[isoc_pipe].desc.bEndpointAddress;\n\tdev->video_mode.num_alt = uif->num_altsetting;\n\n\tdev_info(dev->dev,\n\t\t \"video EndPoint Addr 0x%x, Alternate settings: %i\\n\",\n\t\t dev->video_mode.end_point_addr,\n\t\t dev->video_mode.num_alt);\n\n\tdev->video_mode.alt_max_pkt_size = devm_kmalloc_array(&udev->dev, 32, dev->video_mode.num_alt, GFP_KERNEL);\n\tif (dev->video_mode.alt_max_pkt_size == NULL)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < dev->video_mode.num_alt; i++) {\n\t\tu16 tmp;\n\n\t\tif (uif->altsetting[i].desc.bNumEndpoints < isoc_pipe + 1)\n\t\t\treturn -ENODEV;\n\n\t\ttmp = le16_to_cpu(uif->altsetting[i].endpoint[isoc_pipe].desc.wMaxPacketSize);\n\t\tdev->video_mode.alt_max_pkt_size[i] = (tmp & 0x07ff) * (((tmp & 0x1800) >> 11) + 1);\n\t\tdev_dbg(dev->dev,\n\t\t\t\"Alternate setting %i, max size= %i\\n\", i,\n\t\t\tdev->video_mode.alt_max_pkt_size[i]);\n\t}\n\n\t \n\n\tidx = dev->current_pcb_config.hs_config_info[0].interface_info.vanc_index + 1;\n\tif (idx >= dev->max_iad_interface_count) {\n\t\tdev_err(dev->dev,\n\t\t\t\"VBI PCB interface #%d doesn't exist\\n\", idx);\n\t\treturn -ENODEV;\n\t}\n\tuif = udev->actconfig->interface[idx];\n\n\tif (uif->altsetting[0].desc.bNumEndpoints < isoc_pipe + 1)\n\t\treturn -ENODEV;\n\n\tdev->vbi_mode.end_point_addr =\n\t    uif->altsetting[0].endpoint[isoc_pipe].desc.\n\t\t\tbEndpointAddress;\n\n\tdev->vbi_mode.num_alt = uif->num_altsetting;\n\tdev_info(dev->dev,\n\t\t \"VBI EndPoint Addr 0x%x, Alternate settings: %i\\n\",\n\t\t dev->vbi_mode.end_point_addr,\n\t\t dev->vbi_mode.num_alt);\n\n\t \n\tdev->vbi_mode.alt_max_pkt_size = devm_kmalloc_array(&udev->dev, 32, dev->vbi_mode.num_alt, GFP_KERNEL);\n\tif (dev->vbi_mode.alt_max_pkt_size == NULL)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < dev->vbi_mode.num_alt; i++) {\n\t\tu16 tmp;\n\n\t\tif (uif->altsetting[i].desc.bNumEndpoints < isoc_pipe + 1)\n\t\t\treturn -ENODEV;\n\n\t\ttmp = le16_to_cpu(uif->altsetting[i].endpoint[isoc_pipe].\n\t\t\t\tdesc.wMaxPacketSize);\n\t\tdev->vbi_mode.alt_max_pkt_size[i] =\n\t\t    (tmp & 0x07ff) * (((tmp & 0x1800) >> 11) + 1);\n\t\tdev_dbg(dev->dev,\n\t\t\t\"Alternate setting %i, max size= %i\\n\", i,\n\t\t\tdev->vbi_mode.alt_max_pkt_size[i]);\n\t}\n\n\t \n\n\t \n\tidx = dev->current_pcb_config.hs_config_info[0].interface_info.hanc_index + 1;\n\tif (idx >= dev->max_iad_interface_count) {\n\t\tdev_err(dev->dev,\n\t\t\t\"Sliced CC PCB interface #%d doesn't exist\\n\", idx);\n\t\treturn -ENODEV;\n\t}\n\tuif = udev->actconfig->interface[idx];\n\n\tif (uif->altsetting[0].desc.bNumEndpoints < isoc_pipe + 1)\n\t\treturn -ENODEV;\n\n\tdev->sliced_cc_mode.end_point_addr =\n\t    uif->altsetting[0].endpoint[isoc_pipe].desc.\n\t\t\tbEndpointAddress;\n\n\tdev->sliced_cc_mode.num_alt = uif->num_altsetting;\n\tdev_info(dev->dev,\n\t\t \"sliced CC EndPoint Addr 0x%x, Alternate settings: %i\\n\",\n\t\t dev->sliced_cc_mode.end_point_addr,\n\t\t dev->sliced_cc_mode.num_alt);\n\tdev->sliced_cc_mode.alt_max_pkt_size = devm_kmalloc_array(&udev->dev, 32, dev->sliced_cc_mode.num_alt, GFP_KERNEL);\n\tif (dev->sliced_cc_mode.alt_max_pkt_size == NULL)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < dev->sliced_cc_mode.num_alt; i++) {\n\t\tu16 tmp;\n\n\t\tif (uif->altsetting[i].desc.bNumEndpoints < isoc_pipe + 1)\n\t\t\treturn -ENODEV;\n\n\t\ttmp = le16_to_cpu(uif->altsetting[i].endpoint[isoc_pipe].\n\t\t\t\tdesc.wMaxPacketSize);\n\t\tdev->sliced_cc_mode.alt_max_pkt_size[i] =\n\t\t    (tmp & 0x07ff) * (((tmp & 0x1800) >> 11) + 1);\n\t\tdev_dbg(dev->dev,\n\t\t\t\"Alternate setting %i, max size= %i\\n\", i,\n\t\t\tdev->sliced_cc_mode.alt_max_pkt_size[i]);\n\t}\n\n\treturn 0;\n}\n\n \nstatic int cx231xx_usb_probe(struct usb_interface *interface,\n\t\t\t     const struct usb_device_id *id)\n{\n\tstruct usb_device *udev;\n\tstruct device *d = &interface->dev;\n\tstruct usb_interface *uif;\n\tstruct cx231xx *dev = NULL;\n\tint retval = -ENODEV;\n\tint nr = 0, ifnum;\n\tint i, isoc_pipe = 0;\n\tchar *speed;\n\tu8 idx;\n\tstruct usb_interface_assoc_descriptor *assoc_desc;\n\n\tifnum = interface->altsetting[0].desc.bInterfaceNumber;\n\n\t \n\tif (ifnum != 1)\n\t\treturn -ENODEV;\n\n\t \n\tdo {\n\t\tnr = find_first_zero_bit(&cx231xx_devused, CX231XX_MAXBOARDS);\n\t\tif (nr >= CX231XX_MAXBOARDS) {\n\t\t\t \n\t\t\tdev_err(d,\n\t\t\t\t\"Supports only %i devices.\\n\",\n\t\t\t\tCX231XX_MAXBOARDS);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t} while (test_and_set_bit(nr, &cx231xx_devused));\n\n\tudev = usb_get_dev(interface_to_usbdev(interface));\n\n\t \n\tdev = devm_kzalloc(&udev->dev, sizeof(*dev), GFP_KERNEL);\n\tif (dev == NULL) {\n\t\tretval = -ENOMEM;\n\t\tgoto err_if;\n\t}\n\n\tsnprintf(dev->name, 29, \"cx231xx #%d\", nr);\n\tdev->devno = nr;\n\tdev->model = id->driver_info;\n\tdev->video_mode.alt = -1;\n\tdev->dev = d;\n\n\tcx231xx_set_model(dev);\n\n\tdev->interface_count++;\n\t \n\tdev->gpio_dir = 0;\n\tdev->gpio_val = 0;\n\tdev->xc_fw_load_done = 0;\n\tdev->has_alsa_audio = 1;\n\tdev->power_mode = -1;\n\tatomic_set(&dev->devlist_count, 0);\n\n\t \n\tdev->vbi_or_sliced_cc_mode = 0;\n\n\t \n\tdev->max_iad_interface_count = udev->config->desc.bNumInterfaces;\n\n\t \n\n\t \n\tdev->mode_tv = 0;\n\n\tdev->USE_ISO = transfer_mode;\n\n\tswitch (udev->speed) {\n\tcase USB_SPEED_LOW:\n\t\tspeed = \"1.5\";\n\t\tbreak;\n\tcase USB_SPEED_UNKNOWN:\n\tcase USB_SPEED_FULL:\n\t\tspeed = \"12\";\n\t\tbreak;\n\tcase USB_SPEED_HIGH:\n\t\tspeed = \"480\";\n\t\tbreak;\n\tdefault:\n\t\tspeed = \"unknown\";\n\t}\n\n\tdev_info(d,\n\t\t \"New device %s %s @ %s Mbps (%04x:%04x) with %d interfaces\\n\",\n\t\t udev->manufacturer ? udev->manufacturer : \"\",\n\t\t udev->product ? udev->product : \"\",\n\t\t speed,\n\t\t le16_to_cpu(udev->descriptor.idVendor),\n\t\t le16_to_cpu(udev->descriptor.idProduct),\n\t\t dev->max_iad_interface_count);\n\n\t \n\tdev->interface_count++;\n\n\t \n\tnr = dev->devno;\n\n\tassoc_desc = udev->actconfig->intf_assoc[0];\n\tif (!assoc_desc || assoc_desc->bFirstInterface != ifnum) {\n\t\tdev_err(d, \"Not found matching IAD interface\\n\");\n\t\tretval = -ENODEV;\n\t\tgoto err_if;\n\t}\n\n\tdev_dbg(d, \"registering interface %d\\n\", ifnum);\n\n\t \n\tusb_set_intfdata(interface, dev);\n\n\t \n\tretval = cx231xx_media_device_init(dev, udev);\n\tif (retval) {\n\t\tdev_err(d, \"cx231xx_media_device_init failed\\n\");\n\t\tgoto err_media_init;\n\t}\n\n\t \n#ifdef CONFIG_MEDIA_CONTROLLER\n\tdev->v4l2_dev.mdev = dev->media_dev;\n#endif\n\tretval = v4l2_device_register(&interface->dev, &dev->v4l2_dev);\n\tif (retval) {\n\t\tdev_err(d, \"v4l2_device_register failed\\n\");\n\t\tgoto err_v4l2;\n\t}\n\n\t \n\tretval = cx231xx_init_dev(dev, udev, nr);\n\tif (retval)\n\t\tgoto err_init;\n\n\tretval = cx231xx_init_v4l2(dev, udev, interface, isoc_pipe);\n\tif (retval)\n\t\tgoto err_init;\n\n\tif (dev->current_pcb_config.ts1_source != 0xff) {\n\t\t \n\t\tidx = dev->current_pcb_config.hs_config_info[0].interface_info.ts1_index + 1;\n\t\tif (idx >= dev->max_iad_interface_count) {\n\t\t\tdev_err(d, \"TS1 PCB interface #%d doesn't exist\\n\",\n\t\t\t\tidx);\n\t\t\tretval = -ENODEV;\n\t\t\tgoto err_video_alt;\n\t\t}\n\t\tuif = udev->actconfig->interface[idx];\n\n\t\tif (uif->altsetting[0].desc.bNumEndpoints < isoc_pipe + 1) {\n\t\t\tretval = -ENODEV;\n\t\t\tgoto err_video_alt;\n\t\t}\n\n\t\tdev->ts1_mode.end_point_addr =\n\t\t    uif->altsetting[0].endpoint[isoc_pipe].\n\t\t\t\tdesc.bEndpointAddress;\n\n\t\tdev->ts1_mode.num_alt = uif->num_altsetting;\n\t\tdev_info(d,\n\t\t\t \"TS EndPoint Addr 0x%x, Alternate settings: %i\\n\",\n\t\t\t dev->ts1_mode.end_point_addr,\n\t\t\t dev->ts1_mode.num_alt);\n\n\t\tdev->ts1_mode.alt_max_pkt_size = devm_kmalloc_array(&udev->dev, 32, dev->ts1_mode.num_alt, GFP_KERNEL);\n\t\tif (dev->ts1_mode.alt_max_pkt_size == NULL) {\n\t\t\tretval = -ENOMEM;\n\t\t\tgoto err_video_alt;\n\t\t}\n\n\t\tfor (i = 0; i < dev->ts1_mode.num_alt; i++) {\n\t\t\tu16 tmp;\n\n\t\t\tif (uif->altsetting[i].desc.bNumEndpoints < isoc_pipe + 1) {\n\t\t\t\tretval = -ENODEV;\n\t\t\t\tgoto err_video_alt;\n\t\t\t}\n\n\t\t\ttmp = le16_to_cpu(uif->altsetting[i].\n\t\t\t\t\t\tendpoint[isoc_pipe].desc.\n\t\t\t\t\t\twMaxPacketSize);\n\t\t\tdev->ts1_mode.alt_max_pkt_size[i] =\n\t\t\t    (tmp & 0x07ff) * (((tmp & 0x1800) >> 11) + 1);\n\t\t\tdev_dbg(d, \"Alternate setting %i, max size= %i\\n\",\n\t\t\t\ti, dev->ts1_mode.alt_max_pkt_size[i]);\n\t\t}\n\t}\n\n\tif (dev->model == CX231XX_BOARD_CNXT_VIDEO_GRABBER) {\n\t\tcx231xx_enable_OSC(dev);\n\t\tcx231xx_reset_out(dev);\n\t\tcx231xx_set_alt_setting(dev, INDEX_VIDEO, 3);\n\t}\n\n\tif (dev->model == CX231XX_BOARD_CNXT_RDE_253S)\n\t\tcx231xx_sleep_s5h1432(dev);\n\n\t \n\trequest_modules(dev);\n\n#ifdef CONFIG_MEDIA_CONTROLLER\n\t \n\tcx231xx_v4l2_create_entities(dev);\n\n\tretval = v4l2_mc_create_media_graph(dev->media_dev);\n\tif (!retval)\n\t\tretval = media_device_register(dev->media_dev);\n#endif\n\tif (retval < 0)\n\t\tcx231xx_release_resources(dev);\n\treturn retval;\n\nerr_video_alt:\n\t \n\tcx231xx_close_extension(dev);\n\tcx231xx_ir_exit(dev);\n\tcx231xx_release_analog_resources(dev);\n\tcx231xx_417_unregister(dev);\n\tcx231xx_remove_from_devlist(dev);\n\tcx231xx_dev_uninit(dev);\nerr_init:\n\tv4l2_device_unregister(&dev->v4l2_dev);\nerr_v4l2:\n\tcx231xx_unregister_media_device(dev);\nerr_media_init:\n\tusb_set_intfdata(interface, NULL);\nerr_if:\n\tusb_put_dev(udev);\n\tclear_bit(nr, &cx231xx_devused);\n\treturn retval;\n}\n\n \nstatic void cx231xx_usb_disconnect(struct usb_interface *interface)\n{\n\tstruct cx231xx *dev;\n\n\tdev = usb_get_intfdata(interface);\n\tusb_set_intfdata(interface, NULL);\n\n\tif (!dev)\n\t\treturn;\n\n\tif (!dev->udev)\n\t\treturn;\n\n\tdev->state |= DEV_DISCONNECTED;\n\n\tflush_request_modules(dev);\n\n\t \n\tmutex_lock(&dev->lock);\n\n\twake_up_interruptible_all(&dev->open);\n\n\tif (dev->users) {\n\t\tdev_warn(dev->dev,\n\t\t\t \"device %s is open! Deregistration and memory deallocation are deferred on close.\\n\",\n\t\t\t video_device_node_name(&dev->vdev));\n\n\t\t \n\t\tcx231xx_ir_exit(dev);\n\n\t\tif (dev->USE_ISO)\n\t\t\tcx231xx_uninit_isoc(dev);\n\t\telse\n\t\t\tcx231xx_uninit_bulk(dev);\n\t\twake_up_interruptible(&dev->wait_frame);\n\t\twake_up_interruptible(&dev->wait_stream);\n\t} else {\n\t}\n\n\tcx231xx_close_extension(dev);\n\n\tmutex_unlock(&dev->lock);\n\n\tif (!dev->users)\n\t\tcx231xx_release_resources(dev);\n}\n\nstatic struct usb_driver cx231xx_usb_driver = {\n\t.name = \"cx231xx\",\n\t.probe = cx231xx_usb_probe,\n\t.disconnect = cx231xx_usb_disconnect,\n\t.id_table = cx231xx_id_table,\n};\n\nmodule_usb_driver(cx231xx_usb_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}