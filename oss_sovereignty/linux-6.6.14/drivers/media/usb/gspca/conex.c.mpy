{
  "module_name": "conex.c",
  "hash_id": "112e636abdecad186e81a4ee1d187da2ff4cdbd08b5aa0f593d5ae645bae9acc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/gspca/conex.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#define MODULE_NAME \"conex\"\n\n#include \"gspca.h\"\n#define CONEX_CAM 1\t\t \n#include \"jpeg.h\"\n\nMODULE_AUTHOR(\"Michel Xhaard <mxhaard@users.sourceforge.net>\");\nMODULE_DESCRIPTION(\"GSPCA USB Conexant Camera Driver\");\nMODULE_LICENSE(\"GPL\");\n\n#define QUALITY 50\n\n \nstruct sd {\n\tstruct gspca_dev gspca_dev;\t \n\tstruct v4l2_ctrl *brightness;\n\tstruct v4l2_ctrl *contrast;\n\tstruct v4l2_ctrl *sat;\n\n\tu8 jpeg_hdr[JPEG_HDR_SZ];\n};\n\nstatic const struct v4l2_pix_format vga_mode[] = {\n\t{176, 144, V4L2_PIX_FMT_JPEG, V4L2_FIELD_NONE,\n\t\t.bytesperline = 176,\n\t\t.sizeimage = 176 * 144 * 3 / 8 + 590,\n\t\t.colorspace = V4L2_COLORSPACE_JPEG,\n\t\t.priv = 3},\n\t{320, 240, V4L2_PIX_FMT_JPEG, V4L2_FIELD_NONE,\n\t\t.bytesperline = 320,\n\t\t.sizeimage = 320 * 240 * 3 / 8 + 590,\n\t\t.colorspace = V4L2_COLORSPACE_JPEG,\n\t\t.priv = 2},\n\t{352, 288, V4L2_PIX_FMT_JPEG, V4L2_FIELD_NONE,\n\t\t.bytesperline = 352,\n\t\t.sizeimage = 352 * 288 * 3 / 8 + 590,\n\t\t.colorspace = V4L2_COLORSPACE_JPEG,\n\t\t.priv = 1},\n\t{640, 480, V4L2_PIX_FMT_JPEG, V4L2_FIELD_NONE,\n\t\t.bytesperline = 640,\n\t\t.sizeimage = 640 * 480 * 3 / 8 + 590,\n\t\t.colorspace = V4L2_COLORSPACE_JPEG,\n\t\t.priv = 0},\n};\n\n \nstatic void reg_r(struct gspca_dev *gspca_dev,\n\t\t  __u16 index,\n\t\t  __u16 len)\n{\n\tstruct usb_device *dev = gspca_dev->dev;\n\n\tif (len > USB_BUF_SZ) {\n\t\tgspca_err(gspca_dev, \"reg_r: buffer overflow\\n\");\n\t\treturn;\n\t}\n\n\tusb_control_msg(dev,\n\t\t\tusb_rcvctrlpipe(dev, 0),\n\t\t\t0,\n\t\t\tUSB_DIR_IN | USB_TYPE_VENDOR | USB_RECIP_DEVICE,\n\t\t\t0,\n\t\t\tindex, gspca_dev->usb_buf, len,\n\t\t\t500);\n\tgspca_dbg(gspca_dev, D_USBI, \"reg read [%02x] -> %02x ..\\n\",\n\t\t  index, gspca_dev->usb_buf[0]);\n}\n\n \nstatic void reg_w_val(struct gspca_dev *gspca_dev,\n\t\t\t__u16 index,\n\t\t\t__u8 val)\n{\n\tstruct usb_device *dev = gspca_dev->dev;\n\n\tgspca_dev->usb_buf[0] = val;\n\tusb_control_msg(dev,\n\t\t\tusb_sndctrlpipe(dev, 0),\n\t\t\t0,\n\t\t\tUSB_DIR_OUT | USB_TYPE_VENDOR | USB_RECIP_DEVICE,\n\t\t\t0,\n\t\t\tindex, gspca_dev->usb_buf, 1, 500);\n}\n\nstatic void reg_w(struct gspca_dev *gspca_dev,\n\t\t  __u16 index,\n\t\t  const __u8 *buffer,\n\t\t  __u16 len)\n{\n\tstruct usb_device *dev = gspca_dev->dev;\n\n\tif (len > USB_BUF_SZ) {\n\t\tgspca_err(gspca_dev, \"reg_w: buffer overflow\\n\");\n\t\treturn;\n\t}\n\tgspca_dbg(gspca_dev, D_USBO, \"reg write [%02x] = %02x..\\n\",\n\t\t  index, *buffer);\n\n\tmemcpy(gspca_dev->usb_buf, buffer, len);\n\tusb_control_msg(dev,\n\t\t\tusb_sndctrlpipe(dev, 0),\n\t\t\t0,\n\t\t\tUSB_DIR_OUT | USB_TYPE_VENDOR | USB_RECIP_DEVICE,\n\t\t\t0,\n\t\t\tindex, gspca_dev->usb_buf, len, 500);\n}\n\nstatic const __u8 cx_sensor_init[][4] = {\n\t{0x88, 0x11, 0x01, 0x01},\n\t{0x88, 0x12, 0x70, 0x01},\n\t{0x88, 0x0f, 0x00, 0x01},\n\t{0x88, 0x05, 0x01, 0x01},\n\t{}\n};\n\nstatic const __u8 cx11646_fw1[][3] = {\n\t{0x00, 0x02, 0x00},\n\t{0x01, 0x43, 0x00},\n\t{0x02, 0xA7, 0x00},\n\t{0x03, 0x8B, 0x01},\n\t{0x04, 0xE9, 0x02},\n\t{0x05, 0x08, 0x04},\n\t{0x06, 0x08, 0x05},\n\t{0x07, 0x07, 0x06},\n\t{0x08, 0xE7, 0x06},\n\t{0x09, 0xC6, 0x07},\n\t{0x0A, 0x86, 0x08},\n\t{0x0B, 0x46, 0x09},\n\t{0x0C, 0x05, 0x0A},\n\t{0x0D, 0xA5, 0x0A},\n\t{0x0E, 0x45, 0x0B},\n\t{0x0F, 0xE5, 0x0B},\n\t{0x10, 0x85, 0x0C},\n\t{0x11, 0x25, 0x0D},\n\t{0x12, 0xC4, 0x0D},\n\t{0x13, 0x45, 0x0E},\n\t{0x14, 0xE4, 0x0E},\n\t{0x15, 0x64, 0x0F},\n\t{0x16, 0xE4, 0x0F},\n\t{0x17, 0x64, 0x10},\n\t{0x18, 0xE4, 0x10},\n\t{0x19, 0x64, 0x11},\n\t{0x1A, 0xE4, 0x11},\n\t{0x1B, 0x64, 0x12},\n\t{0x1C, 0xE3, 0x12},\n\t{0x1D, 0x44, 0x13},\n\t{0x1E, 0xC3, 0x13},\n\t{0x1F, 0x24, 0x14},\n\t{0x20, 0xA3, 0x14},\n\t{0x21, 0x04, 0x15},\n\t{0x22, 0x83, 0x15},\n\t{0x23, 0xE3, 0x15},\n\t{0x24, 0x43, 0x16},\n\t{0x25, 0xA4, 0x16},\n\t{0x26, 0x23, 0x17},\n\t{0x27, 0x83, 0x17},\n\t{0x28, 0xE3, 0x17},\n\t{0x29, 0x43, 0x18},\n\t{0x2A, 0xA3, 0x18},\n\t{0x2B, 0x03, 0x19},\n\t{0x2C, 0x63, 0x19},\n\t{0x2D, 0xC3, 0x19},\n\t{0x2E, 0x22, 0x1A},\n\t{0x2F, 0x63, 0x1A},\n\t{0x30, 0xC3, 0x1A},\n\t{0x31, 0x23, 0x1B},\n\t{0x32, 0x83, 0x1B},\n\t{0x33, 0xE2, 0x1B},\n\t{0x34, 0x23, 0x1C},\n\t{0x35, 0x83, 0x1C},\n\t{0x36, 0xE2, 0x1C},\n\t{0x37, 0x23, 0x1D},\n\t{0x38, 0x83, 0x1D},\n\t{0x39, 0xE2, 0x1D},\n\t{0x3A, 0x23, 0x1E},\n\t{0x3B, 0x82, 0x1E},\n\t{0x3C, 0xC3, 0x1E},\n\t{0x3D, 0x22, 0x1F},\n\t{0x3E, 0x63, 0x1F},\n\t{0x3F, 0xC1, 0x1F},\n\t{}\n};\nstatic void cx11646_fw(struct gspca_dev*gspca_dev)\n{\n\tint i = 0;\n\n\treg_w_val(gspca_dev, 0x006a, 0x02);\n\twhile (cx11646_fw1[i][1]) {\n\t\treg_w(gspca_dev, 0x006b, cx11646_fw1[i], 3);\n\t\ti++;\n\t}\n\treg_w_val(gspca_dev, 0x006a, 0x00);\n}\n\nstatic const __u8 cxsensor[] = {\n\t0x88, 0x12, 0x70, 0x01,\n\t0x88, 0x0d, 0x02, 0x01,\n\t0x88, 0x0f, 0x00, 0x01,\n\t0x88, 0x03, 0x71, 0x01, 0x88, 0x04, 0x00, 0x01,\t \n\t0x88, 0x02, 0x10, 0x01,\n\t0x88, 0x00, 0xD4, 0x01, 0x88, 0x01, 0x01, 0x01,\t \n\t0x88, 0x0B, 0x00, 0x01,\n\t0x88, 0x0A, 0x0A, 0x01,\n\t0x88, 0x00, 0x08, 0x01, 0x88, 0x01, 0x00, 0x01,\t \n\t0x88, 0x05, 0x01, 0x01,\n\t0xA1, 0x18, 0x00, 0x01,\n\t0x00\n};\n\nstatic const __u8 reg20[] = { 0x10, 0x42, 0x81, 0x19, 0xd3, 0xff, 0xa7, 0xff };\nstatic const __u8 reg28[] = { 0x87, 0x00, 0x87, 0x00, 0x8f, 0xff, 0xea, 0xff };\nstatic const __u8 reg10[] = { 0xb1, 0xb1 };\nstatic const __u8 reg71a[] = { 0x08, 0x18, 0x0a, 0x1e };\t \nstatic const __u8 reg71b[] = { 0x04, 0x0c, 0x05, 0x0f };\n\t \nstatic const __u8 reg7b[] = { 0x00, 0xff, 0x00, 0xff, 0x00, 0xff };\n\nstatic void cx_sensor(struct gspca_dev*gspca_dev)\n{\n\tint i = 0;\n\tint length;\n\tconst __u8 *ptsensor = cxsensor;\n\n\treg_w(gspca_dev, 0x0020, reg20, 8);\n\treg_w(gspca_dev, 0x0028, reg28, 8);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0092, 0x03);\n\n\tswitch (gspca_dev->cam.cam_mode[(int) gspca_dev->curr_mode].priv) {\n\tcase 0:\n\t\treg_w(gspca_dev, 0x0071, reg71a, 4);\n\t\tbreak;\n\tcase 1:\n\t\treg_w(gspca_dev, 0x0071, reg71b, 4);\n\t\tbreak;\n\tdefault:\n \n\t\treg_w(gspca_dev, 0x0071, reg71c, 4);\n\t\tbreak;\n\tcase 3:\n\t\treg_w(gspca_dev, 0x0071, reg71d, 4);\n\t\tbreak;\n\t}\n\treg_w(gspca_dev, 0x007b, reg7b, 6);\n\treg_w_val(gspca_dev, 0x00f8, 0x00);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0098, 0x41);\n\tfor (i = 0; i < 11; i++) {\n\t\tif (i == 3 || i == 5 || i == 8)\n\t\t\tlength = 8;\n\t\telse\n\t\t\tlength = 4;\n\t\treg_w(gspca_dev, 0x00e5, ptsensor, length);\n\t\tif (length == 4)\n\t\t\treg_r(gspca_dev, 0x00e8, 1);\n\t\telse\n\t\t\treg_r(gspca_dev, 0x00e8, length);\n\t\tptsensor += length;\n\t}\n\treg_r(gspca_dev, 0x00e7, 8);\n}\n\nstatic const __u8 cx_inits_176[] = {\n\t0x33, 0x81, 0xB0, 0x00, 0x90, 0x00, 0x0A, 0x03,\t \n\t0x00, 0x03, 0x03, 0x03, 0x1B, 0x05, 0x30, 0x03,\n\t0x65, 0x15, 0x18, 0x25, 0x03, 0x25, 0x08, 0x30,\n\t0x3B, 0x25, 0x10, 0x00, 0x04, 0x00, 0x00, 0x00,\n\t0xDC, 0xFF, 0xEE, 0xFF, 0xC5, 0xFF, 0xBF, 0xFF,\n\t0xF7, 0xFF, 0x88, 0xFF, 0x66, 0x02, 0x28, 0x02,\n\t0x1E, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\nstatic const __u8 cx_inits_320[] = {\n\t0x7f, 0x7f, 0x40, 0x01, 0xf0, 0x00, 0x02, 0x01,\n\t0x00, 0x01, 0x01, 0x01, 0x10, 0x00, 0x02, 0x01,\n\t0x65, 0x45, 0xfa, 0x4c, 0x2c, 0xdf, 0xb9, 0x81,\n\t0x30, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,\n\t0xe2, 0xff, 0xf1, 0xff, 0xc2, 0xff, 0xbc, 0xff,\n\t0xf5, 0xff, 0x6d, 0xff, 0xf6, 0x01, 0x43, 0x02,\n\t0xd3, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\nstatic const __u8 cx_inits_352[] = {\n\t0x2e, 0x7c, 0x60, 0x01, 0x20, 0x01, 0x05, 0x03,\n\t0x00, 0x06, 0x03, 0x06, 0x1b, 0x10, 0x05, 0x3b,\n\t0x30, 0x25, 0x18, 0x25, 0x08, 0x30, 0x03, 0x25,\n\t0x3b, 0x30, 0x25, 0x1b, 0x10, 0x05, 0x00, 0x00,\n\t0xe3, 0xff, 0xf1, 0xff, 0xc2, 0xff, 0xbc, 0xff,\n\t0xf5, 0xff, 0x6b, 0xff, 0xee, 0x01, 0x43, 0x02,\n\t0xe4, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\nstatic const __u8 cx_inits_640[] = {\n\t0x7e, 0x7e, 0x80, 0x02, 0xe0, 0x01, 0x01, 0x01,\n\t0x00, 0x02, 0x01, 0x02, 0x10, 0x30, 0x01, 0x01,\n\t0x65, 0x45, 0xf7, 0x52, 0x2c, 0xdf, 0xb9, 0x81,\n\t0x30, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,\n\t0xe2, 0xff, 0xf1, 0xff, 0xc2, 0xff, 0xbc, 0xff,\n\t0xf6, 0xff, 0x7b, 0xff, 0x01, 0x02, 0x43, 0x02,\n\t0x77, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nstatic void cx11646_initsize(struct gspca_dev *gspca_dev)\n{\n\tconst __u8 *cxinit;\n\tstatic const __u8 reg12[] = { 0x08, 0x05, 0x07, 0x04, 0x24 };\n\tstatic const __u8 reg17[] =\n\t\t\t{ 0x0a, 0x00, 0xf2, 0x01, 0x0f, 0x00, 0x97, 0x02 };\n\n\tswitch (gspca_dev->cam.cam_mode[(int) gspca_dev->curr_mode].priv) {\n\tcase 0:\n\t\tcxinit = cx_inits_640;\n\t\tbreak;\n\tcase 1:\n\t\tcxinit = cx_inits_352;\n\t\tbreak;\n\tdefault:\n \n\t\tcxinit = cx_inits_320;\n\t\tbreak;\n\tcase 3:\n\t\tcxinit = cx_inits_176;\n\t\tbreak;\n\t}\n\treg_w_val(gspca_dev, 0x009a, 0x01);\n\treg_w_val(gspca_dev, 0x0010, 0x10);\n\treg_w(gspca_dev, 0x0012, reg12, 5);\n\treg_w(gspca_dev, 0x0017, reg17, 8);\n\treg_w_val(gspca_dev, 0x00c0, 0x00);\n\treg_w_val(gspca_dev, 0x00c1, 0x04);\n\treg_w_val(gspca_dev, 0x00c2, 0x04);\n\n\treg_w(gspca_dev, 0x0061, cxinit, 8);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x00ca, cxinit, 8);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x00d2, cxinit, 8);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x00da, cxinit, 6);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x0041, cxinit, 8);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x0049, cxinit, 8);\n\tcxinit += 8;\n\treg_w(gspca_dev, 0x0051, cxinit, 2);\n\n\treg_r(gspca_dev, 0x0010, 1);\n}\n\nstatic const __u8 cx_jpeg_init[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x15},\t \n\t{0x0f, 0x10, 0x12, 0x10, 0x0d, 0x15, 0x12, 0x11},\n\t{0x12, 0x18, 0x16, 0x15, 0x19, 0x20, 0x35, 0x22},\n\t{0x20, 0x1d, 0x1d, 0x20, 0x41, 0x2e, 0x31, 0x26},\n\t{0x35, 0x4d, 0x43, 0x51, 0x4f, 0x4b, 0x43, 0x4a},\n\t{0x49, 0x55, 0x5F, 0x79, 0x67, 0x55, 0x5A, 0x73},\n\t{0x5B, 0x49, 0x4A, 0x6A, 0x90, 0x6B, 0x73, 0x7D},\n\t{0x81, 0x88, 0x89, 0x88, 0x52, 0x66, 0x95, 0xA0},\n\t{0x94, 0x84, 0x9E, 0x79, 0x85, 0x88, 0x83, 0x01},\n\t{0x15, 0x0F, 0x10, 0x12, 0x10, 0x0D, 0x15, 0x12},\n\t{0x11, 0x12, 0x18, 0x16, 0x15, 0x19, 0x20, 0x35},\n\t{0x22, 0x20, 0x1D, 0x1D, 0x20, 0x41, 0x2E, 0x31},\n\t{0x26, 0x35, 0x4D, 0x43, 0x51, 0x4F, 0x4B, 0x43},\n\t{0x4A, 0x49, 0x55, 0x5F, 0x79, 0x67, 0x55, 0x5A},\n\t{0x73, 0x5B, 0x49, 0x4A, 0x6A, 0x90, 0x6B, 0x73},\n\t{0x7D, 0x81, 0x88, 0x89, 0x88, 0x52, 0x66, 0x95},\n\t{0xA0, 0x94, 0x84, 0x9E, 0x79, 0x85, 0x88, 0x83},\n\t{0xFF, 0xC4, 0x01, 0xA2, 0x00, 0x00, 0x01, 0x05},\n\t{0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00},\n\t{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02},\n\t{0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A},\n\t{0x0B, 0x01, 0x00, 0x03, 0x01, 0x01, 0x01, 0x01},\n\t{0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00},\n\t{0x00, 0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05},\n\t{0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x10, 0x00},\n\t{0x02, 0x01, 0x03, 0x03, 0x02, 0x04, 0x03, 0x05},\n\t{0x05, 0x04, 0x04, 0x00, 0x00, 0x01, 0x7D, 0x01},\n\t{0x02, 0x03, 0x00, 0x04, 0x11, 0x05, 0x12, 0x21},\n\t{0x31, 0x41, 0x06, 0x13, 0x51, 0x61, 0x07, 0x22},\n\t{0x71, 0x14, 0x32, 0x81, 0x91, 0xA1, 0x08, 0x23},\n\t{0x42, 0xB1, 0xC1, 0x15, 0x52, 0xD1, 0xF0, 0x24},\n\t{0x33, 0x62, 0x72, 0x82, 0x09, 0x0A, 0x16, 0x17},\n\t{0x18, 0x19, 0x1A, 0x25, 0x26, 0x27, 0x28, 0x29},\n\t{0x2A, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A},\n\t{0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4A},\n\t{0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A},\n\t{0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6A},\n\t{0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A},\n\t{0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8A},\n\t{0x92, 0x93, 0x94, 0x95, 0x96, 0x97, 0x98, 0x99},\n\t{0x9A, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7, 0xA8},\n\t{0xA9, 0xAA, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7},\n\t{0xB8, 0xB9, 0xBA, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6},\n\t{0xC7, 0xC8, 0xC9, 0xCA, 0xD2, 0xD3, 0xD4, 0xD5},\n\t{0xD6, 0xD7, 0xD8, 0xD9, 0xDA, 0xE1, 0xE2, 0xE3},\n\t{0xE4, 0xE5, 0xE6, 0xE7, 0xE8, 0xE9, 0xEA, 0xF1},\n\t{0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7, 0xF8, 0xF9},\n\t{0xFA, 0x11, 0x00, 0x02, 0x01, 0x02, 0x04, 0x04},\n\t{0x03, 0x04, 0x07, 0x05, 0x04, 0x04, 0x00, 0x01},\n\t{0x02, 0x77, 0x00, 0x01, 0x02, 0x03, 0x11, 0x04},\n\t{0x05, 0x21, 0x31, 0x06, 0x12, 0x41, 0x51, 0x07},\n\t{0x61, 0x71, 0x13, 0x22, 0x32, 0x81, 0x08, 0x14},\n\t{0x42, 0x91, 0xA1, 0xB1, 0xC1, 0x09, 0x23, 0x33},\n\t{0x52, 0xF0, 0x15, 0x62, 0x72, 0xD1, 0x0A, 0x16},\n\t{0x24, 0x34, 0xE1, 0x25, 0xF1, 0x17, 0x18, 0x19},\n\t{0x1A, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x35, 0x36},\n\t{0x37, 0x38, 0x39, 0x3A, 0x43, 0x44, 0x45, 0x46},\n\t{0x47, 0x48, 0x49, 0x4A, 0x53, 0x54, 0x55, 0x56},\n\t{0x57, 0x58, 0x59, 0x5A, 0x63, 0x64, 0x65, 0x66},\n\t{0x67, 0x68, 0x69, 0x6A, 0x73, 0x74, 0x75, 0x76},\n\t{0x77, 0x78, 0x79, 0x7A, 0x82, 0x83, 0x84, 0x85},\n\t{0x86, 0x87, 0x88, 0x89, 0x8A, 0x92, 0x93, 0x94},\n\t{0x95, 0x96, 0x97, 0x98, 0x99, 0x9A, 0xA2, 0xA3},\n\t{0xA4, 0xA5, 0xA6, 0xA7, 0xA8, 0xA9, 0xAA, 0xB2},\n\t{0xB3, 0xB4, 0xB5, 0xB6, 0xB7, 0xB8, 0xB9, 0xBA},\n\t{0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7, 0xC8, 0xC9},\n\t{0xCA, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7, 0xD8},\n\t{0xD9, 0xDA, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7},\n\t{0xE8, 0xE9, 0xEA, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6},\n\t{0xF7, 0xF8, 0xF9, 0xFA, 0xFF, 0x20, 0x00, 0x1F},\n\t{0x02, 0x0C, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00},\n\t{0x00, 0x00, 0x11, 0x00, 0x11, 0x22, 0x00, 0x22},\n\t{0x22, 0x11, 0x22, 0x22, 0x11, 0x33, 0x33, 0x11},\n\t{0x44, 0x66, 0x22, 0x55, 0x66, 0xFF, 0xDD, 0x00},\n\t{0x04, 0x00, 0x14, 0xFF, 0xC0, 0x00, 0x11, 0x08},\n\t{0x00, 0xF0, 0x01, 0x40, 0x03, 0x00, 0x21, 0x00},\n\t{0x01, 0x11, 0x01, 0x02, 0x11, 0x01, 0xFF, 0xDA},\n\t{0x00, 0x0C, 0x03, 0x00, 0x00, 0x01, 0x11, 0x02},\n\t{0x11, 0x00, 0x3F, 0x00, 0xFF, 0xD9, 0x00, 0x00}\t \n};\n\n\nstatic const __u8 cxjpeg_640[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x10},\t \n\t{0x0b, 0x0c, 0x0e, 0x0c, 0x0a, 0x10, 0x0e, 0x0d},\n\t{0x0e, 0x12, 0x11, 0x10, 0x13, 0x18, 0x28, 0x1a},\n\t{0x18, 0x16, 0x16, 0x18, 0x31, 0x23, 0x25, 0x1d},\n\t{0x28, 0x3a, 0x33, 0x3D, 0x3C, 0x39, 0x33, 0x38},\n\t{0x37, 0x40, 0x48, 0x5C, 0x4E, 0x40, 0x44, 0x57},\n\t{0x45, 0x37, 0x38, 0x50, 0x6D, 0x51, 0x57, 0x5F},\n\t{0x62, 0x67, 0x68, 0x67, 0x3E, 0x4D, 0x71, 0x79},\n\t{0x70, 0x64, 0x78, 0x5C, 0x65, 0x67, 0x63, 0x01},\n\t{0x10, 0x0B, 0x0C, 0x0E, 0x0C, 0x0A, 0x10, 0x0E},\n\t{0x0D, 0x0E, 0x12, 0x11, 0x10, 0x13, 0x18, 0x28},\n\t{0x1A, 0x18, 0x16, 0x16, 0x18, 0x31, 0x23, 0x25},\n\t{0x1D, 0x28, 0x3A, 0x33, 0x3D, 0x3C, 0x39, 0x33},\n\t{0x38, 0x37, 0x40, 0x48, 0x5C, 0x4E, 0x40, 0x44},\n\t{0x57, 0x45, 0x37, 0x38, 0x50, 0x6D, 0x51, 0x57},\n\t{0x5F, 0x62, 0x67, 0x68, 0x67, 0x3E, 0x4D, 0x71},\n\t{0x79, 0x70, 0x64, 0x78, 0x5C, 0x65, 0x67, 0x63},\n\t{0xFF, 0x20, 0x00, 0x1F, 0x00, 0x83, 0x00, 0x00},\n\t{0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00},\n\t{0x11, 0x22, 0x00, 0x22, 0x22, 0x11, 0x22, 0x22},\n\t{0x11, 0x33, 0x33, 0x11, 0x44, 0x66, 0x22, 0x55},\n\t{0x66, 0xFF, 0xDD, 0x00, 0x04, 0x00, 0x28, 0xFF},\n\t{0xC0, 0x00, 0x11, 0x08, 0x01, 0xE0, 0x02, 0x80},\n\t{0x03, 0x00, 0x21, 0x00, 0x01, 0x11, 0x01, 0x02},\n\t{0x11, 0x01, 0xFF, 0xDA, 0x00, 0x0C, 0x03, 0x00},\n\t{0x00, 0x01, 0x11, 0x02, 0x11, 0x00, 0x3F, 0x00},\n\t{0xFF, 0xD9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}\t \n};\nstatic const __u8 cxjpeg_352[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x0d},\n\t{0x09, 0x09, 0x0b, 0x09, 0x08, 0x0D, 0x0b, 0x0a},\n\t{0x0b, 0x0e, 0x0d, 0x0d, 0x0f, 0x13, 0x1f, 0x14},\n\t{0x13, 0x11, 0x11, 0x13, 0x26, 0x1b, 0x1d, 0x17},\n\t{0x1F, 0x2D, 0x28, 0x30, 0x2F, 0x2D, 0x28, 0x2C},\n\t{0x2B, 0x32, 0x38, 0x48, 0x3D, 0x32, 0x35, 0x44},\n\t{0x36, 0x2B, 0x2C, 0x3F, 0x55, 0x3F, 0x44, 0x4A},\n\t{0x4D, 0x50, 0x51, 0x50, 0x30, 0x3C, 0x58, 0x5F},\n\t{0x58, 0x4E, 0x5E, 0x48, 0x4F, 0x50, 0x4D, 0x01},\n\t{0x0D, 0x09, 0x09, 0x0B, 0x09, 0x08, 0x0D, 0x0B},\n\t{0x0A, 0x0B, 0x0E, 0x0D, 0x0D, 0x0F, 0x13, 0x1F},\n\t{0x14, 0x13, 0x11, 0x11, 0x13, 0x26, 0x1B, 0x1D},\n\t{0x17, 0x1F, 0x2D, 0x28, 0x30, 0x2F, 0x2D, 0x28},\n\t{0x2C, 0x2B, 0x32, 0x38, 0x48, 0x3D, 0x32, 0x35},\n\t{0x44, 0x36, 0x2B, 0x2C, 0x3F, 0x55, 0x3F, 0x44},\n\t{0x4A, 0x4D, 0x50, 0x51, 0x50, 0x30, 0x3C, 0x58},\n\t{0x5F, 0x58, 0x4E, 0x5E, 0x48, 0x4F, 0x50, 0x4D},\n\t{0xFF, 0x20, 0x00, 0x1F, 0x01, 0x83, 0x00, 0x00},\n\t{0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00},\n\t{0x11, 0x22, 0x00, 0x22, 0x22, 0x11, 0x22, 0x22},\n\t{0x11, 0x33, 0x33, 0x11, 0x44, 0x66, 0x22, 0x55},\n\t{0x66, 0xFF, 0xDD, 0x00, 0x04, 0x00, 0x16, 0xFF},\n\t{0xC0, 0x00, 0x11, 0x08, 0x01, 0x20, 0x01, 0x60},\n\t{0x03, 0x00, 0x21, 0x00, 0x01, 0x11, 0x01, 0x02},\n\t{0x11, 0x01, 0xFF, 0xDA, 0x00, 0x0C, 0x03, 0x00},\n\t{0x00, 0x01, 0x11, 0x02, 0x11, 0x00, 0x3F, 0x00},\n\t{0xFF, 0xD9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}\n};\nstatic const __u8 cxjpeg_320[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x05},\n\t{0x03, 0x04, 0x04, 0x04, 0x03, 0x05, 0x04, 0x04},\n\t{0x04, 0x05, 0x05, 0x05, 0x06, 0x07, 0x0c, 0x08},\n\t{0x07, 0x07, 0x07, 0x07, 0x0f, 0x0b, 0x0b, 0x09},\n\t{0x0C, 0x11, 0x0F, 0x12, 0x12, 0x11, 0x0f, 0x11},\n\t{0x11, 0x13, 0x16, 0x1C, 0x17, 0x13, 0x14, 0x1A},\n\t{0x15, 0x11, 0x11, 0x18, 0x21, 0x18, 0x1A, 0x1D},\n\t{0x1D, 0x1F, 0x1F, 0x1F, 0x13, 0x17, 0x22, 0x24},\n\t{0x22, 0x1E, 0x24, 0x1C, 0x1E, 0x1F, 0x1E, 0x01},\n\t{0x05, 0x03, 0x04, 0x04, 0x04, 0x03, 0x05, 0x04},\n\t{0x04, 0x04, 0x05, 0x05, 0x05, 0x06, 0x07, 0x0C},\n\t{0x08, 0x07, 0x07, 0x07, 0x07, 0x0F, 0x0B, 0x0B},\n\t{0x09, 0x0C, 0x11, 0x0F, 0x12, 0x12, 0x11, 0x0F},\n\t{0x11, 0x11, 0x13, 0x16, 0x1C, 0x17, 0x13, 0x14},\n\t{0x1A, 0x15, 0x11, 0x11, 0x18, 0x21, 0x18, 0x1A},\n\t{0x1D, 0x1D, 0x1F, 0x1F, 0x1F, 0x13, 0x17, 0x22},\n\t{0x24, 0x22, 0x1E, 0x24, 0x1C, 0x1E, 0x1F, 0x1E},\n\t{0xFF, 0x20, 0x00, 0x1F, 0x02, 0x0C, 0x00, 0x00},\n\t{0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00},\n\t{0x11, 0x22, 0x00, 0x22, 0x22, 0x11, 0x22, 0x22},\n\t{0x11, 0x33, 0x33, 0x11, 0x44, 0x66, 0x22, 0x55},\n\t{0x66, 0xFF, 0xDD, 0x00, 0x04, 0x00, 0x14, 0xFF},\n\t{0xC0, 0x00, 0x11, 0x08, 0x00, 0xF0, 0x01, 0x40},\n\t{0x03, 0x00, 0x21, 0x00, 0x01, 0x11, 0x01, 0x02},\n\t{0x11, 0x01, 0xFF, 0xDA, 0x00, 0x0C, 0x03, 0x00},\n\t{0x00, 0x01, 0x11, 0x02, 0x11, 0x00, 0x3F, 0x00},\n\t{0xFF, 0xD9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}\t \n};\nstatic const __u8 cxjpeg_176[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x0d},\n\t{0x09, 0x09, 0x0B, 0x09, 0x08, 0x0D, 0x0B, 0x0A},\n\t{0x0B, 0x0E, 0x0D, 0x0D, 0x0F, 0x13, 0x1F, 0x14},\n\t{0x13, 0x11, 0x11, 0x13, 0x26, 0x1B, 0x1D, 0x17},\n\t{0x1F, 0x2D, 0x28, 0x30, 0x2F, 0x2D, 0x28, 0x2C},\n\t{0x2B, 0x32, 0x38, 0x48, 0x3D, 0x32, 0x35, 0x44},\n\t{0x36, 0x2B, 0x2C, 0x3F, 0x55, 0x3F, 0x44, 0x4A},\n\t{0x4D, 0x50, 0x51, 0x50, 0x30, 0x3C, 0x58, 0x5F},\n\t{0x58, 0x4E, 0x5E, 0x48, 0x4F, 0x50, 0x4D, 0x01},\n\t{0x0D, 0x09, 0x09, 0x0B, 0x09, 0x08, 0x0D, 0x0B},\n\t{0x0A, 0x0B, 0x0E, 0x0D, 0x0D, 0x0F, 0x13, 0x1F},\n\t{0x14, 0x13, 0x11, 0x11, 0x13, 0x26, 0x1B, 0x1D},\n\t{0x17, 0x1F, 0x2D, 0x28, 0x30, 0x2F, 0x2D, 0x28},\n\t{0x2C, 0x2B, 0x32, 0x38, 0x48, 0x3D, 0x32, 0x35},\n\t{0x44, 0x36, 0x2B, 0x2C, 0x3F, 0x55, 0x3F, 0x44},\n\t{0x4A, 0x4D, 0x50, 0x51, 0x50, 0x30, 0x3C, 0x58},\n\t{0x5F, 0x58, 0x4E, 0x5E, 0x48, 0x4F, 0x50, 0x4D},\n\t{0xFF, 0x20, 0x00, 0x1F, 0x03, 0xA1, 0x00, 0x00},\n\t{0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00},\n\t{0x11, 0x22, 0x00, 0x22, 0x22, 0x11, 0x22, 0x22},\n\t{0x11, 0x33, 0x33, 0x11, 0x44, 0x66, 0x22, 0x55},\n\t{0x66, 0xFF, 0xDD, 0x00, 0x04, 0x00, 0x0B, 0xFF},\n\t{0xC0, 0x00, 0x11, 0x08, 0x00, 0x90, 0x00, 0xB0},\n\t{0x03, 0x00, 0x21, 0x00, 0x01, 0x11, 0x01, 0x02},\n\t{0x11, 0x01, 0xFF, 0xDA, 0x00, 0x0C, 0x03, 0x00},\n\t{0x00, 0x01, 0x11, 0x02, 0x11, 0x00, 0x3F, 0x00},\n\t{0xFF, 0xD9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}\n};\n \nstatic const __u8 cxjpeg_qtable[][8] = {\n\t{0xff, 0xd8, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x08},\n\t{0x06, 0x06, 0x07, 0x06, 0x05, 0x08, 0x07, 0x07},\n\t{0x07, 0x09, 0x09, 0x08, 0x0a, 0x0c, 0x14, 0x0a},\n\t{0x0c, 0x0b, 0x0b, 0x0c, 0x19, 0x12, 0x13, 0x0f},\n\t{0x14, 0x1d, 0x1a, 0x1f, 0x1e, 0x1d, 0x1a, 0x1c},\n\t{0x1c, 0x20, 0x24, 0x2e, 0x27, 0x20, 0x22, 0x2c},\n\t{0x23, 0x1c, 0x1c, 0x28, 0x37, 0x29, 0x2c, 0x30},\n\t{0x31, 0x34, 0x34, 0x34, 0x1f, 0x27, 0x39, 0x3d},\n\t{0x38, 0x32, 0x3c, 0x2e, 0x33, 0x34, 0x32, 0x01},\n\t{0x09, 0x09, 0x09, 0x0c, 0x0b, 0x0c, 0x18, 0x0a},\n\t{0x0a, 0x18, 0x32, 0x21, 0x1c, 0x21, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32},\n\t{0xFF, 0xD9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}\t \n};\n\n\nstatic void cx11646_jpegInit(struct gspca_dev*gspca_dev)\n{\n\tint i;\n\tint length;\n\n\treg_w_val(gspca_dev, 0x00c0, 0x01);\n\treg_w_val(gspca_dev, 0x00c3, 0x00);\n\treg_w_val(gspca_dev, 0x00c0, 0x00);\n\treg_r(gspca_dev, 0x0001, 1);\n\tlength = 8;\n\tfor (i = 0; i < 79; i++) {\n\t\tif (i == 78)\n\t\t\tlength = 6;\n\t\treg_w(gspca_dev, 0x0008, cx_jpeg_init[i], length);\n\t}\n\treg_r(gspca_dev, 0x0002, 1);\n\treg_w_val(gspca_dev, 0x0055, 0x14);\n}\n\nstatic const __u8 reg12[] = { 0x0a, 0x05, 0x07, 0x04, 0x19 };\nstatic const __u8 regE5_8[] =\n\t\t{ 0x88, 0x00, 0xd4, 0x01, 0x88, 0x01, 0x01, 0x01 };\nstatic const __u8 regE5a[] = { 0x88, 0x0a, 0x0c, 0x01 };\nstatic const __u8 regE5b[] = { 0x88, 0x0b, 0x12, 0x01 };\nstatic const __u8 regE5c[] = { 0x88, 0x05, 0x01, 0x01 };\nstatic const __u8 reg51[] = { 0x77, 0x03 };\n#define reg70 0x03\n\nstatic void cx11646_jpeg(struct gspca_dev*gspca_dev)\n{\n\tint i;\n\tint length;\n\t__u8 Reg55;\n\tint retry;\n\n\treg_w_val(gspca_dev, 0x00c0, 0x01);\n\treg_w_val(gspca_dev, 0x00c3, 0x00);\n\treg_w_val(gspca_dev, 0x00c0, 0x00);\n\treg_r(gspca_dev, 0x0001, 1);\n\tlength = 8;\n\tswitch (gspca_dev->cam.cam_mode[gspca_dev->curr_mode].priv) {\n\tcase 0:\n\t\tfor (i = 0; i < 27; i++) {\n\t\t\tif (i == 26)\n\t\t\t\tlength = 2;\n\t\t\treg_w(gspca_dev, 0x0008, cxjpeg_640[i], length);\n\t\t}\n\t\tReg55 = 0x28;\n\t\tbreak;\n\tcase 1:\n\t\tfor (i = 0; i < 27; i++) {\n\t\t\tif (i == 26)\n\t\t\t\tlength = 2;\n\t\t\treg_w(gspca_dev, 0x0008, cxjpeg_352[i], length);\n\t\t}\n\t\tReg55 = 0x16;\n\t\tbreak;\n\tdefault:\n \n\t\tfor (i = 0; i < 27; i++) {\n\t\t\tif (i == 26)\n\t\t\t\tlength = 2;\n\t\t\treg_w(gspca_dev, 0x0008, cxjpeg_320[i], length);\n\t\t}\n\t\tReg55 = 0x14;\n\t\tbreak;\n\tcase 3:\n\t\tfor (i = 0; i < 27; i++) {\n\t\t\tif (i == 26)\n\t\t\t\tlength = 2;\n\t\t\treg_w(gspca_dev, 0x0008, cxjpeg_176[i], length);\n\t\t}\n\t\tReg55 = 0x0B;\n\t\tbreak;\n\t}\n\n\treg_r(gspca_dev, 0x0002, 1);\n\treg_w_val(gspca_dev, 0x0055, Reg55);\n\treg_r(gspca_dev, 0x0002, 1);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0054, 0x02);\n\treg_w_val(gspca_dev, 0x0054, 0x01);\n\treg_w_val(gspca_dev, 0x0000, 0x94);\n\treg_w_val(gspca_dev, 0x0053, 0xc0);\n\treg_w_val(gspca_dev, 0x00fc, 0xe1);\n\treg_w_val(gspca_dev, 0x0000, 0x00);\n\t \n\tretry = 50;\n\tdo {\n\t\treg_r(gspca_dev, 0x0002, 1);\n\t\t\t\t\t\t\t \n\t\tif (gspca_dev->usb_buf[0] == 0x00)\n\t\t\tbreak;\n\t\treg_w_val(gspca_dev, 0x0053, 0x00);\n\t} while (--retry);\n\tif (retry == 0)\n\t\tgspca_err(gspca_dev, \"Damned Errors sending jpeg Table\\n\");\n\t \n\treg_r(gspca_dev, 0x0001, 1);\t\t \n\tlength = 8;\n\tfor (i = 0; i < 18; i++) {\n\t\tif (i == 17)\n\t\t\tlength = 2;\n\t\treg_w(gspca_dev, 0x0008, cxjpeg_qtable[i], length);\n\n\t}\n\treg_r(gspca_dev, 0x0002, 1);\t \n\treg_r(gspca_dev, 0x0053, 1);\t \n\treg_w_val(gspca_dev, 0x0054, 0x02);\n\treg_w_val(gspca_dev, 0x0054, 0x01);\n\treg_w_val(gspca_dev, 0x0000, 0x94);\n\treg_w_val(gspca_dev, 0x0053, 0xc0);\n\n\treg_r(gspca_dev, 0x0038, 1);\t\t \n\treg_r(gspca_dev, 0x0038, 1);\t\t \n\treg_r(gspca_dev, 0x001f, 1);\t\t \n\treg_w(gspca_dev, 0x0012, reg12, 5);\n\treg_w(gspca_dev, 0x00e5, regE5_8, 8);\n\treg_r(gspca_dev, 0x00e8, 8);\n\treg_w(gspca_dev, 0x00e5, regE5a, 4);\n\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\treg_w_val(gspca_dev, 0x009a, 0x01);\n\treg_w(gspca_dev, 0x00e5, regE5b, 4);\n\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\treg_w(gspca_dev, 0x00e5, regE5c, 4);\n\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\n\treg_w(gspca_dev, 0x0051, reg51, 2);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0070, reg70);\n}\n\nstatic void cx11646_init1(struct gspca_dev *gspca_dev)\n{\n\tint i = 0;\n\n\treg_w_val(gspca_dev, 0x0010, 0x00);\n\treg_w_val(gspca_dev, 0x0053, 0x00);\n\treg_w_val(gspca_dev, 0x0052, 0x00);\n\treg_w_val(gspca_dev, 0x009b, 0x2f);\n\treg_w_val(gspca_dev, 0x009c, 0x10);\n\treg_r(gspca_dev, 0x0098, 1);\n\treg_w_val(gspca_dev, 0x0098, 0x40);\n\treg_r(gspca_dev, 0x0099, 1);\n\treg_w_val(gspca_dev, 0x0099, 0x07);\n\treg_w_val(gspca_dev, 0x0039, 0x40);\n\treg_w_val(gspca_dev, 0x003c, 0xff);\n\treg_w_val(gspca_dev, 0x003f, 0x1f);\n\treg_w_val(gspca_dev, 0x003d, 0x40);\n \n\treg_r(gspca_dev, 0x0099, 1);\t\t\t \n\n\twhile (cx_sensor_init[i][0]) {\n\t\treg_w_val(gspca_dev, 0x00e5, cx_sensor_init[i][0]);\n\t\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\t\tif (i == 1) {\n\t\t\treg_w_val(gspca_dev, 0x00ed, 0x01);\n\t\t\treg_r(gspca_dev, 0x00ed, 1);\t \n\t\t}\n\t\ti++;\n\t}\n\treg_w_val(gspca_dev, 0x00c3, 0x00);\n}\n\n \nstatic int sd_config(struct gspca_dev *gspca_dev,\n\t\t\tconst struct usb_device_id *id)\n{\n\tstruct cam *cam;\n\n\tcam = &gspca_dev->cam;\n\tcam->cam_mode = vga_mode;\n\tcam->nmodes = ARRAY_SIZE(vga_mode);\n\treturn 0;\n}\n\n \nstatic int sd_init(struct gspca_dev *gspca_dev)\n{\n\tcx11646_init1(gspca_dev);\n\tcx11646_initsize(gspca_dev);\n\tcx11646_fw(gspca_dev);\n\tcx_sensor(gspca_dev);\n\tcx11646_jpegInit(gspca_dev);\n\treturn 0;\n}\n\nstatic int sd_start(struct gspca_dev *gspca_dev)\n{\n\tstruct sd *sd = (struct sd *) gspca_dev;\n\n\t \n\tjpeg_define(sd->jpeg_hdr, gspca_dev->pixfmt.height,\n\t\t\tgspca_dev->pixfmt.width,\n\t\t\t0x22);\t\t \n\tjpeg_set_qual(sd->jpeg_hdr, QUALITY);\n\n\tcx11646_initsize(gspca_dev);\n\tcx11646_fw(gspca_dev);\n\tcx_sensor(gspca_dev);\n\tcx11646_jpeg(gspca_dev);\n\treturn 0;\n}\n\n \nstatic void sd_stop0(struct gspca_dev *gspca_dev)\n{\n\tint retry = 50;\n\n\tif (!gspca_dev->present)\n\t\treturn;\n\treg_w_val(gspca_dev, 0x0000, 0x00);\n\treg_r(gspca_dev, 0x0002, 1);\n\treg_w_val(gspca_dev, 0x0053, 0x00);\n\n\twhile (retry--) {\n \n\t\treg_r(gspca_dev, 0x0053, 1);\n\t\tif (gspca_dev->usb_buf[0] == 0)\n\t\t\tbreak;\n\t}\n\treg_w_val(gspca_dev, 0x0000, 0x00);\n\treg_r(gspca_dev, 0x0002, 1);\n\n\treg_w_val(gspca_dev, 0x0010, 0x00);\n\treg_r(gspca_dev, 0x0033, 1);\n\treg_w_val(gspca_dev, 0x00fc, 0xe0);\n}\n\nstatic void sd_pkt_scan(struct gspca_dev *gspca_dev,\n\t\t\tu8 *data,\t\t\t \n\t\t\tint len)\t\t\t \n{\n\tstruct sd *sd = (struct sd *) gspca_dev;\n\n\tif (data[0] == 0xff && data[1] == 0xd8) {\n\n\t\t \n\t\tgspca_frame_add(gspca_dev, LAST_PACKET, NULL, 0);\n\n\t\t \n\t\tgspca_frame_add(gspca_dev, FIRST_PACKET,\n\t\t\t\tsd->jpeg_hdr, JPEG_HDR_SZ);\n\t\tdata += 2;\n\t\tlen -= 2;\n\t}\n\tgspca_frame_add(gspca_dev, INTER_PACKET, data, len);\n}\n\nstatic void setbrightness(struct gspca_dev *gspca_dev, s32 val, s32 sat)\n{\n\t__u8 regE5cbx[] = { 0x88, 0x00, 0xd4, 0x01, 0x88, 0x01, 0x01, 0x01 };\n\t__u8 reg51c[2];\n\n\tregE5cbx[2] = val;\n\treg_w(gspca_dev, 0x00e5, regE5cbx, 8);\n\treg_r(gspca_dev, 0x00e8, 8);\n\treg_w(gspca_dev, 0x00e5, regE5c, 4);\n\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\n\treg51c[0] = 0x77;\n\treg51c[1] = sat;\n\treg_w(gspca_dev, 0x0051, reg51c, 2);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0070, reg70);\n}\n\nstatic void setcontrast(struct gspca_dev *gspca_dev, s32 val, s32 sat)\n{\n\t__u8 regE5acx[] = { 0x88, 0x0a, 0x0c, 0x01 };\t \n \n\t__u8 reg51c[2];\n\n\tregE5acx[2] = val;\n\treg_w(gspca_dev, 0x00e5, regE5acx, 4);\n\treg_r(gspca_dev, 0x00e8, 1);\t\t \n\treg51c[0] = 0x77;\n\treg51c[1] = sat;\n\treg_w(gspca_dev, 0x0051, reg51c, 2);\n\treg_w(gspca_dev, 0x0010, reg10, 2);\n\treg_w_val(gspca_dev, 0x0070, reg70);\n}\n\nstatic int sd_s_ctrl(struct v4l2_ctrl *ctrl)\n{\n\tstruct gspca_dev *gspca_dev =\n\t\tcontainer_of(ctrl->handler, struct gspca_dev, ctrl_handler);\n\tstruct sd *sd = (struct sd *)gspca_dev;\n\n\tgspca_dev->usb_err = 0;\n\n\tif (!gspca_dev->streaming)\n\t\treturn 0;\n\n\tswitch (ctrl->id) {\n\tcase V4L2_CID_BRIGHTNESS:\n\t\tsetbrightness(gspca_dev, ctrl->val, sd->sat->cur.val);\n\t\tbreak;\n\tcase V4L2_CID_CONTRAST:\n\t\tsetcontrast(gspca_dev, ctrl->val, sd->sat->cur.val);\n\t\tbreak;\n\tcase V4L2_CID_SATURATION:\n\t\tsetbrightness(gspca_dev, sd->brightness->cur.val, ctrl->val);\n\t\tsetcontrast(gspca_dev, sd->contrast->cur.val, ctrl->val);\n\t\tbreak;\n\t}\n\treturn gspca_dev->usb_err;\n}\n\nstatic const struct v4l2_ctrl_ops sd_ctrl_ops = {\n\t.s_ctrl = sd_s_ctrl,\n};\n\nstatic int sd_init_controls(struct gspca_dev *gspca_dev)\n{\n\tstruct sd *sd = (struct sd *)gspca_dev;\n\tstruct v4l2_ctrl_handler *hdl = &gspca_dev->ctrl_handler;\n\n\tgspca_dev->vdev.ctrl_handler = hdl;\n\tv4l2_ctrl_handler_init(hdl, 3);\n\tsd->brightness = v4l2_ctrl_new_std(hdl, &sd_ctrl_ops,\n\t\t\tV4L2_CID_BRIGHTNESS, 0, 255, 1, 0xd4);\n\tsd->contrast = v4l2_ctrl_new_std(hdl, &sd_ctrl_ops,\n\t\t\tV4L2_CID_CONTRAST, 0x0a, 0x1f, 1, 0x0c);\n\tsd->sat = v4l2_ctrl_new_std(hdl, &sd_ctrl_ops,\n\t\t\tV4L2_CID_SATURATION, 0, 7, 1, 3);\n\tif (hdl->error) {\n\t\tpr_err(\"Could not initialize controls\\n\");\n\t\treturn hdl->error;\n\t}\n\treturn 0;\n}\n\n \nstatic const struct sd_desc sd_desc = {\n\t.name = MODULE_NAME,\n\t.config = sd_config,\n\t.init = sd_init,\n\t.init_controls = sd_init_controls,\n\t.start = sd_start,\n\t.stop0 = sd_stop0,\n\t.pkt_scan = sd_pkt_scan,\n};\n\n \nstatic const struct usb_device_id device_table[] = {\n\t{USB_DEVICE(0x0572, 0x0041)},\n\t{}\n};\nMODULE_DEVICE_TABLE(usb, device_table);\n\n \nstatic int sd_probe(struct usb_interface *intf,\n\t\t\tconst struct usb_device_id *id)\n{\n\treturn gspca_dev_probe(intf, id, &sd_desc, sizeof(struct sd),\n\t\t\t\tTHIS_MODULE);\n}\n\nstatic struct usb_driver sd_driver = {\n\t.name = MODULE_NAME,\n\t.id_table = device_table,\n\t.probe = sd_probe,\n\t.disconnect = gspca_disconnect,\n#ifdef CONFIG_PM\n\t.suspend = gspca_suspend,\n\t.resume = gspca_resume,\n\t.reset_resume = gspca_resume,\n#endif\n};\n\nmodule_usb_driver(sd_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}