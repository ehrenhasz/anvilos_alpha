{
  "module_name": "gspca.h",
  "hash_id": "f6e5f7bf8d8bfed2c0d93e6930c073ea28816e91b0cf37b677c4f19713e40d08",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/gspca/gspca.h",
  "human_readable_source": " \n#ifndef GSPCAV2_H\n#define GSPCAV2_H\n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/usb.h>\n#include <linux/videodev2.h>\n#include <media/v4l2-common.h>\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/videobuf2-v4l2.h>\n#include <media/videobuf2-vmalloc.h>\n#include <linux/mutex.h>\n\n\n\n \n\n#define D_PROBE  1\n#define D_CONF   2\n#define D_STREAM 3\n#define D_FRAM   4\n#define D_PACK   5\n#define D_USBI   6\n#define D_USBO   7\n\nextern int gspca_debug;\n\n\n#define gspca_dbg(gspca_dev, level, fmt, ...)\t\t\t\\\n\tv4l2_dbg(level, gspca_debug, &(gspca_dev)->v4l2_dev,\t\\\n\t\t fmt, ##__VA_ARGS__)\n\n#define gspca_err(gspca_dev, fmt, ...)\t\t\t\t\\\n\tv4l2_err(&(gspca_dev)->v4l2_dev, fmt, ##__VA_ARGS__)\n\n#define GSPCA_MAX_FRAMES 16\t \n \n#define MAX_NURBS 4\t\t \n\n\n \nstruct framerates {\n\tconst u8 *rates;\n\tint nrates;\n};\n\n \nstruct cam {\n\tconst struct v4l2_pix_format *cam_mode;\t \n\tconst struct framerates *mode_framerates;  \n\tu32 bulk_size;\t\t \n\tu32 input_flags;\t \n\tu8 nmodes;\t\t \n\tu8 no_urb_create;\t \n\tu8 bulk_nurbs;\t\t \n\tu8 bulk;\t\t \n\tu8 npkt;\t\t \n\tu8 needs_full_bandwidth; \n};\n\nstruct gspca_dev;\nstruct gspca_frame;\n\n \ntypedef int (*cam_op) (struct gspca_dev *);\ntypedef void (*cam_v_op) (struct gspca_dev *);\ntypedef int (*cam_cf_op) (struct gspca_dev *, const struct usb_device_id *);\ntypedef int (*cam_get_jpg_op) (struct gspca_dev *,\n\t\t\t\tstruct v4l2_jpegcompression *);\ntypedef int (*cam_set_jpg_op) (struct gspca_dev *,\n\t\t\t\tconst struct v4l2_jpegcompression *);\ntypedef int (*cam_get_reg_op) (struct gspca_dev *,\n\t\t\t\tstruct v4l2_dbg_register *);\ntypedef int (*cam_set_reg_op) (struct gspca_dev *,\n\t\t\t\tconst struct v4l2_dbg_register *);\ntypedef int (*cam_chip_info_op) (struct gspca_dev *,\n\t\t\t\tstruct v4l2_dbg_chip_info *);\ntypedef void (*cam_streamparm_op) (struct gspca_dev *,\n\t\t\t\t  struct v4l2_streamparm *);\ntypedef void (*cam_pkt_op) (struct gspca_dev *gspca_dev,\n\t\t\t\tu8 *data,\n\t\t\t\tint len);\ntypedef int (*cam_int_pkt_op) (struct gspca_dev *gspca_dev,\n\t\t\t\tu8 *data,\n\t\t\t\tint len);\ntypedef void (*cam_format_op) (struct gspca_dev *gspca_dev,\n\t\t\t\tstruct v4l2_format *fmt);\ntypedef int (*cam_frmsize_op) (struct gspca_dev *gspca_dev,\n\t\t\t\tstruct v4l2_frmsizeenum *fsize);\n\n \nstruct sd_desc {\n \n\tconst char *name;\t \n \n\tcam_cf_op config;\t \n\tcam_op init;\t\t \n\tcam_op init_controls;\t \n\tcam_v_op probe_error;\t \n\tcam_op start;\t\t \n\tcam_pkt_op pkt_scan;\n \n\tcam_op isoc_init;\t \n\tcam_op isoc_nego;\t \n\tcam_v_op stopN;\t\t \n\tcam_v_op stop0;\t\t \n\tcam_v_op dq_callback;\t \n\tcam_get_jpg_op get_jcomp;\n\tcam_set_jpg_op set_jcomp;\n\tcam_streamparm_op get_streamparm;\n\tcam_streamparm_op set_streamparm;\n\tcam_format_op try_fmt;\n\tcam_frmsize_op enum_framesizes;\n#ifdef CONFIG_VIDEO_ADV_DEBUG\n\tcam_set_reg_op set_register;\n\tcam_get_reg_op get_register;\n\tcam_chip_info_op get_chip_info;\n#endif\n#if IS_ENABLED(CONFIG_INPUT)\n\tcam_int_pkt_op int_pkt_scan;\n\t \n\tu8 other_input;\n#endif\n};\n\n \nenum gspca_packet_type {\n\tDISCARD_PACKET,\n\tFIRST_PACKET,\n\tINTER_PACKET,\n\tLAST_PACKET\n};\n\nstruct gspca_buffer {\n\tstruct vb2_v4l2_buffer vb;\n\tstruct list_head list;\n};\n\nstatic inline struct gspca_buffer *to_gspca_buffer(struct vb2_buffer *vb2)\n{\n\treturn container_of(vb2, struct gspca_buffer, vb.vb2_buf);\n}\n\nstruct gspca_dev {\n\tstruct video_device vdev;\t \n\tstruct module *module;\t\t \n\tstruct v4l2_device v4l2_dev;\n\tstruct usb_device *dev;\n\n#if IS_ENABLED(CONFIG_INPUT)\n\tstruct input_dev *input_dev;\n\tchar phys[64];\t\t\t \n#endif\n\n\tstruct cam cam;\t\t\t\t \n\tconst struct sd_desc *sd_desc;\t\t \n\tstruct v4l2_ctrl_handler ctrl_handler;\n\n\t \n\tstruct {\n\t\tstruct v4l2_ctrl *autogain;\n\t\tstruct v4l2_ctrl *exposure;\n\t\tstruct v4l2_ctrl *gain;\n\t\tint exp_too_low_cnt, exp_too_high_cnt;\n\t};\n\n#define USB_BUF_SZ 64\n\t__u8 *usb_buf;\t\t\t\t \n\tstruct urb *urb[MAX_NURBS];\n#if IS_ENABLED(CONFIG_INPUT)\n\tstruct urb *int_urb;\n#endif\n\n\tu8 *image;\t\t\t\t \n\tu32 image_len;\t\t\t\t \n\t__u8 last_packet_type;\n\t__s8 empty_packet;\t\t \n\tbool streaming;\n\n\t__u8 curr_mode;\t\t\t \n\tstruct v4l2_pix_format pixfmt;\t \n\t__u32 sequence;\t\t\t \n\n\tstruct vb2_queue queue;\n\n\tspinlock_t qlock;\n\tstruct list_head buf_list;\n\n\twait_queue_head_t wq;\t\t \n\tstruct mutex usb_lock;\t\t \n\tint usb_err;\t\t\t \n\tu16 pkt_size;\t\t\t \n#ifdef CONFIG_PM\n\tchar frozen;\t\t\t \n#endif\n\tbool present;\n\tchar memory;\t\t\t \n\t__u8 iface;\t\t\t \n\t__u8 alt;\t\t\t \n\tint xfer_ep;\t\t\t \n\tu8 audio;\t\t\t \n\n\t \n};\n\nint gspca_dev_probe(struct usb_interface *intf,\n\t\tconst struct usb_device_id *id,\n\t\tconst struct sd_desc *sd_desc,\n\t\tint dev_size,\n\t\tstruct module *module);\nint gspca_dev_probe2(struct usb_interface *intf,\n\t\tconst struct usb_device_id *id,\n\t\tconst struct sd_desc *sd_desc,\n\t\tint dev_size,\n\t\tstruct module *module);\nvoid gspca_disconnect(struct usb_interface *intf);\nvoid gspca_frame_add(struct gspca_dev *gspca_dev,\n\t\t\tenum gspca_packet_type packet_type,\n\t\t\tconst u8 *data,\n\t\t\tint len);\n#ifdef CONFIG_PM\nint gspca_suspend(struct usb_interface *intf, pm_message_t message);\nint gspca_resume(struct usb_interface *intf);\n#endif\nint gspca_expo_autogain(struct gspca_dev *gspca_dev, int avg_lum,\n\tint desired_avg_lum, int deadzone, int gain_knee, int exposure_knee);\nint gspca_coarse_grained_expo_autogain(struct gspca_dev *gspca_dev,\n\tint avg_lum, int desired_avg_lum, int deadzone);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}