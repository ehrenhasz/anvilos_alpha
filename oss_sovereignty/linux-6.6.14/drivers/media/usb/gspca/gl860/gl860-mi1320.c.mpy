{
  "module_name": "gl860-mi1320.c",
  "hash_id": "183ab930ec20b2fd046ed7a759c682f454213e587f95a2d3b1525213b2ad4640",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/usb/gspca/gl860/gl860-mi1320.c",
  "human_readable_source": "\n \n\n \n\n#include \"gl860.h\"\n\nstatic struct validx tbl_common[] = {\n\t{0xba00, 0x00f0}, {0xba00, 0x00f1}, {0xba51, 0x0066}, {0xba02, 0x00f1},\n\t{0xba05, 0x0067}, {0xba05, 0x00f1}, {0xbaa0, 0x0065}, {0xba00, 0x00f1},\n\t{0xffff, 0xffff},\n\t{0xba00, 0x00f0}, {0xba02, 0x00f1}, {0xbafa, 0x0028}, {0xba02, 0x00f1},\n\t{0xba00, 0x00f0}, {0xba01, 0x00f1}, {0xbaf0, 0x0006}, {0xba0e, 0x00f1},\n\t{0xba70, 0x0006}, {0xba0e, 0x00f1},\n\t{0xffff, 0xffff},\n\t{0xba74, 0x0006}, {0xba0e, 0x00f1},\n\t{0xffff, 0xffff},\n\t{0x0061, 0x0000}, {0x0068, 0x000d},\n};\n\nstatic struct validx tbl_init_at_startup[] = {\n\t{0x0000, 0x0000}, {0x0010, 0x0010},\n\t{35, 0xffff},\n\t{0x0008, 0x00c0}, {0x0001, 0x00c1}, {0x0001, 0x00c2}, {0x0020, 0x0006},\n\t{0x006a, 0x000d},\n};\n\nstatic struct validx tbl_sensor_settings_common[] = {\n\t{0x0010, 0x0010}, {0x0003, 0x00c1}, {0x0042, 0x00c2}, {0x0040, 0x0000},\n\t{0x006a, 0x0007}, {0x006a, 0x000d}, {0x0063, 0x0006},\n};\nstatic struct validx tbl_sensor_settings_1280[] = {\n\t{0xba00, 0x00f0}, {0xba00, 0x00f1}, {0xba5a, 0x0066}, {0xba02, 0x00f1},\n\t{0xba05, 0x0067}, {0xba05, 0x00f1}, {0xba20, 0x0065}, {0xba00, 0x00f1},\n};\nstatic struct validx tbl_sensor_settings_800[] = {\n\t{0xba00, 0x00f0}, {0xba00, 0x00f1}, {0xba5a, 0x0066}, {0xba02, 0x00f1},\n\t{0xba05, 0x0067}, {0xba05, 0x00f1}, {0xba20, 0x0065}, {0xba00, 0x00f1},\n};\nstatic struct validx tbl_sensor_settings_640[] = {\n\t{0xba00, 0x00f0}, {0xba00, 0x00f1}, {0xbaa0, 0x0065}, {0xba00, 0x00f1},\n\t{0xba51, 0x0066}, {0xba02, 0x00f1}, {0xba05, 0x0067}, {0xba05, 0x00f1},\n\t{0xba20, 0x0065}, {0xba00, 0x00f1},\n};\nstatic struct validx tbl_post_unset_alt[] = {\n\t{0xba00, 0x00f0}, {0xba00, 0x00f1}, {0xbaa0, 0x0065}, {0xba00, 0x00f1},\n\t{0x0061, 0x0000}, {0x0068, 0x000d},\n};\n\nstatic u8 *tbl_1280[] = {\n\t(u8[]){\n\t\t0x0d, 0x80, 0xf1, 0x08, 0x03, 0x04, 0xf1, 0x00,\n\t\t0x04, 0x05, 0xf1, 0x02, 0x05, 0x00, 0xf1, 0xf1,\n\t\t0x06, 0x00, 0xf1, 0x0d, 0x20, 0x01, 0xf1, 0x00,\n\t\t0x21, 0x84, 0xf1, 0x00, 0x0d, 0x00, 0xf1, 0x08,\n\t\t0xf0, 0x00, 0xf1, 0x01, 0x34, 0x00, 0xf1, 0x00,\n\t\t0x9b, 0x43, 0xf1, 0x00, 0xa6, 0x05, 0xf1, 0x00,\n\t\t0xa9, 0x04, 0xf1, 0x00, 0xa1, 0x05, 0xf1, 0x00,\n\t\t0xa4, 0x04, 0xf1, 0x00, 0xae, 0x0a, 0xf1, 0x08\n\t}, (u8[]){\n\t\t0xf0, 0x00, 0xf1, 0x02, 0x3a, 0x05, 0xf1, 0xf1,\n\t\t0x3c, 0x05, 0xf1, 0xf1, 0x59, 0x01, 0xf1, 0x47,\n\t\t0x5a, 0x01, 0xf1, 0x88, 0x5c, 0x0a, 0xf1, 0x06,\n\t\t0x5d, 0x0e, 0xf1, 0x0a, 0x64, 0x5e, 0xf1, 0x1c,\n\t\t0xd2, 0x00, 0xf1, 0xcf, 0xcb, 0x00, 0xf1, 0x01\n\t}, (u8[]){\n\t\t0xd3, 0x02, 0xd4, 0x28, 0xd5, 0x01, 0xd0, 0x02,\n\t\t0xd1, 0x18, 0xd2, 0xc1\n\t}\n};\n\nstatic u8 *tbl_800[] = {\n\t(u8[]){\n\t\t0x0d, 0x80, 0xf1, 0x08, 0x03, 0x03, 0xf1, 0xc0,\n\t\t0x04, 0x05, 0xf1, 0x02, 0x05, 0x00, 0xf1, 0xf1,\n\t\t0x06, 0x00, 0xf1, 0x0d, 0x20, 0x01, 0xf1, 0x00,\n\t\t0x21, 0x84, 0xf1, 0x00, 0x0d, 0x00, 0xf1, 0x08,\n\t\t0xf0, 0x00, 0xf1, 0x01, 0x34, 0x00, 0xf1, 0x00,\n\t\t0x9b, 0x43, 0xf1, 0x00, 0xa6, 0x05, 0xf1, 0x00,\n\t\t0xa9, 0x03, 0xf1, 0xc0, 0xa1, 0x03, 0xf1, 0x20,\n\t\t0xa4, 0x02, 0xf1, 0x5a, 0xae, 0x0a, 0xf1, 0x08\n\t}, (u8[]){\n\t\t0xf0, 0x00, 0xf1, 0x02, 0x3a, 0x05, 0xf1, 0xf1,\n\t\t0x3c, 0x05, 0xf1, 0xf1, 0x59, 0x01, 0xf1, 0x47,\n\t\t0x5a, 0x01, 0xf1, 0x88, 0x5c, 0x0a, 0xf1, 0x06,\n\t\t0x5d, 0x0e, 0xf1, 0x0a, 0x64, 0x5e, 0xf1, 0x1c,\n\t\t0xd2, 0x00, 0xf1, 0xcf, 0xcb, 0x00, 0xf1, 0x01\n\t}, (u8[]){\n\t\t0xd3, 0x02, 0xd4, 0x18, 0xd5, 0x21, 0xd0, 0x02,\n\t\t0xd1, 0x10, 0xd2, 0x59\n\t}\n};\n\nstatic u8 *tbl_640[] = {\n\t(u8[]){\n\t\t0x0d, 0x80, 0xf1, 0x08, 0x03, 0x04, 0xf1, 0x04,\n\t\t0x04, 0x05, 0xf1, 0x02, 0x07, 0x01, 0xf1, 0x7c,\n\t\t0x08, 0x00, 0xf1, 0x0e, 0x21, 0x80, 0xf1, 0x00,\n\t\t0x0d, 0x00, 0xf1, 0x08, 0xf0, 0x00, 0xf1, 0x01,\n\t\t0x34, 0x10, 0xf1, 0x10, 0x3a, 0x43, 0xf1, 0x00,\n\t\t0xa6, 0x05, 0xf1, 0x02, 0xa9, 0x04, 0xf1, 0x04,\n\t\t0xa7, 0x02, 0xf1, 0x81, 0xaa, 0x01, 0xf1, 0xe2,\n\t\t0xae, 0x0c, 0xf1, 0x09\n\t}, (u8[]){\n\t\t0xf0, 0x00, 0xf1, 0x02, 0x39, 0x03, 0xf1, 0xfc,\n\t\t0x3b, 0x04, 0xf1, 0x04, 0x57, 0x01, 0xf1, 0xb6,\n\t\t0x58, 0x02, 0xf1, 0x0d, 0x5c, 0x1f, 0xf1, 0x19,\n\t\t0x5d, 0x24, 0xf1, 0x1e, 0x64, 0x5e, 0xf1, 0x1c,\n\t\t0xd2, 0x00, 0xf1, 0x00, 0xcb, 0x00, 0xf1, 0x01\n\t}, (u8[]){\n\t\t0xd3, 0x02, 0xd4, 0x10, 0xd5, 0x81, 0xd0, 0x02,\n\t\t0xd1, 0x08, 0xd2, 0xe1\n\t}\n};\n\nstatic s32 tbl_sat[] = {0x25, 0x1d, 0x15, 0x0d, 0x05, 0x4d, 0x55, 0x5d, 0x2d};\nstatic s32 tbl_bright[] = {0, 8, 0x10, 0x20, 0x30, 0x40, 0x50, 0x60, 0x70};\nstatic s32 tbl_backlight[] = {0x0e, 0x06, 0x02};\n\nstatic s32 tbl_cntr1[] = {\n\t0x90, 0x98, 0xa0, 0xa8, 0xb0, 0xb8, 0xc0, 0xc8, 0xd0, 0xe0, 0xf0};\nstatic s32 tbl_cntr2[] = {\n\t0x70, 0x68, 0x60, 0x58, 0x50, 0x48, 0x40, 0x38, 0x30, 0x20, 0x10};\n\nstatic u8 dat_wbalNL[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x05\\x00\\xf1\\x06\" \"\\x3b\\x04\\xf1\\x2a\\x47\\x10\\xf1\\x10\"\n\t\"\\x9d\\x3c\\xf1\\xae\\xaf\\x10\\xf1\\x00\" \"\\xf0\\x00\\xf1\\x02\\x2f\\x91\\xf1\\x20\"\n\t\"\\x9c\\x91\\xf1\\x20\\x37\\x03\\xf1\\x00\" \"\\x9d\\xc5\\xf1\\x0f\\xf0\\x00\\xf1\\x00\";\n\nstatic u8 dat_wbalLL[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x05\\x00\\xf1\\x0c\" \"\\x3b\\x04\\xf1\\x2a\\x47\\x40\\xf1\\x40\"\n\t\"\\x9d\\x20\\xf1\\xae\\xaf\\x10\\xf1\\x00\" \"\\xf0\\x00\\xf1\\x02\\x2f\\xd1\\xf1\\x00\"\n\t\"\\x9c\\xd1\\xf1\\x00\\x37\\x03\\xf1\\x00\" \"\\x9d\\xc5\\xf1\\x3f\\xf0\\x00\\xf1\\x00\";\n\nstatic u8 dat_wbalBL[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x05\\x00\\xf1\\x06\" \"\\x47\\x10\\xf1\\x30\\x9d\\x3c\\xf1\\xae\"\n\t\"\\xaf\\x10\\xf1\\x00\\xf0\\x00\\xf1\\x02\" \"\\x2f\\x91\\xf1\\x20\\x9c\\x91\\xf1\\x20\"\n\t\"\\x37\\x03\\xf1\\x00\\x9d\\xc5\\xf1\\x2f\" \"\\xf0\\x00\\xf1\\x00\";\n\nstatic u8 dat_hvflip1[] = {0xf0, 0x00, 0xf1, 0x00};\n\nstatic u8 dat_common00[] =\n\t\"\\x00\\x01\\x07\\x6a\\x06\\x63\\x0d\\x6a\" \"\\xc0\\x00\\x10\\x10\\xc1\\x03\\xc2\\x42\"\n\t\"\\xd8\\x04\\x58\\x00\\x04\\x02\";\nstatic u8 dat_common01[] =\n\t\"\\x0d\\x00\\xf1\\x0b\\x0d\\x00\\xf1\\x08\" \"\\x35\\x00\\xf1\\x22\\x68\\x00\\xf1\\x5d\"\n\t\"\\xf0\\x00\\xf1\\x01\\x06\\x70\\xf1\\x0e\" \"\\xf0\\x00\\xf1\\x02\\xdd\\x18\\xf1\\xe0\";\nstatic u8 dat_common02[] =\n\t\"\\x05\\x01\\xf1\\x84\\x06\\x00\\xf1\\x44\" \"\\x07\\x00\\xf1\\xbe\\x08\\x00\\xf1\\x1e\"\n\t\"\\x20\\x01\\xf1\\x03\\x21\\x84\\xf1\\x00\" \"\\x22\\x0d\\xf1\\x0f\\x24\\x80\\xf1\\x00\"\n\t\"\\x34\\x18\\xf1\\x2d\\x35\\x00\\xf1\\x22\" \"\\x43\\x83\\xf1\\x83\\x59\\x00\\xf1\\xff\";\nstatic u8 dat_common03[] =\n\t\"\\xf0\\x00\\xf1\\x02\\x39\\x06\\xf1\\x8c\" \"\\x3a\\x06\\xf1\\x8c\\x3b\\x03\\xf1\\xda\"\n\t\"\\x3c\\x05\\xf1\\x30\\x57\\x01\\xf1\\x0c\" \"\\x58\\x01\\xf1\\x42\\x59\\x01\\xf1\\x0c\"\n\t\"\\x5a\\x01\\xf1\\x42\\x5c\\x13\\xf1\\x0e\" \"\\x5d\\x17\\xf1\\x12\\x64\\x1e\\xf1\\x1c\";\nstatic u8 dat_common04[] =\n\t\"\\xf0\\x00\\xf1\\x02\\x24\\x5f\\xf1\\x20\" \"\\x28\\xea\\xf1\\x02\\x5f\\x41\\xf1\\x43\";\nstatic u8 dat_common05[] =\n\t\"\\x02\\x00\\xf1\\xee\\x03\\x29\\xf1\\x1a\" \"\\x04\\x02\\xf1\\xa4\\x09\\x00\\xf1\\x68\"\n\t\"\\x0a\\x00\\xf1\\x2a\\x0b\\x00\\xf1\\x04\" \"\\x0c\\x00\\xf1\\x93\\x0d\\x00\\xf1\\x82\"\n\t\"\\x0e\\x00\\xf1\\x40\\x0f\\x00\\xf1\\x5f\" \"\\x10\\x00\\xf1\\x4e\\x11\\x00\\xf1\\x5b\";\nstatic u8 dat_common06[] =\n\t\"\\x15\\x00\\xf1\\xc9\\x16\\x00\\xf1\\x5e\" \"\\x17\\x00\\xf1\\x9d\\x18\\x00\\xf1\\x06\"\n\t\"\\x19\\x00\\xf1\\x89\\x1a\\x00\\xf1\\x12\" \"\\x1b\\x00\\xf1\\xa1\\x1c\\x00\\xf1\\xe4\"\n\t\"\\x1d\\x00\\xf1\\x7a\\x1e\\x00\\xf1\\x64\" \"\\xf6\\x00\\xf1\\x5f\";\nstatic u8 dat_common07[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x53\\x09\\xf1\\x03\" \"\\x54\\x3d\\xf1\\x1c\\x55\\x99\\xf1\\x72\"\n\t\"\\x56\\xc1\\xf1\\xb1\\x57\\xd8\\xf1\\xce\" \"\\x58\\xe0\\xf1\\x00\\xdc\\x0a\\xf1\\x03\"\n\t\"\\xdd\\x45\\xf1\\x20\\xde\\xae\\xf1\\x82\" \"\\xdf\\xdc\\xf1\\xc9\\xe0\\xf6\\xf1\\xea\"\n\t\"\\xe1\\xff\\xf1\\x00\";\nstatic u8 dat_common08[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x80\\x00\\xf1\\x06\" \"\\x81\\xf6\\xf1\\x08\\x82\\xfb\\xf1\\xf7\"\n\t\"\\x83\\x00\\xf1\\xfe\\xb6\\x07\\xf1\\x03\" \"\\xb7\\x18\\xf1\\x0c\\x84\\xfb\\xf1\\x06\"\n\t\"\\x85\\xfb\\xf1\\xf9\\x86\\x00\\xf1\\xff\" \"\\xb8\\x07\\xf1\\x04\\xb9\\x16\\xf1\\x0a\";\nstatic u8 dat_common09[] =\n\t\"\\x87\\xfa\\xf1\\x05\\x88\\xfc\\xf1\\xf9\" \"\\x89\\x00\\xf1\\xff\\xba\\x06\\xf1\\x03\"\n\t\"\\xbb\\x17\\xf1\\x09\\x8a\\xe8\\xf1\\x14\" \"\\x8b\\xf7\\xf1\\xf0\\x8c\\xfd\\xf1\\xfa\"\n\t\"\\x8d\\x00\\xf1\\x00\\xbc\\x05\\xf1\\x01\" \"\\xbd\\x0c\\xf1\\x08\\xbe\\x00\\xf1\\x14\";\nstatic u8 dat_common10[] =\n\t\"\\x8e\\xea\\xf1\\x13\\x8f\\xf7\\xf1\\xf2\" \"\\x90\\xfd\\xf1\\xfa\\x91\\x00\\xf1\\x00\"\n\t\"\\xbf\\x05\\xf1\\x01\\xc0\\x0a\\xf1\\x08\" \"\\xc1\\x00\\xf1\\x0c\\x92\\xed\\xf1\\x0f\"\n\t\"\\x93\\xf9\\xf1\\xf4\\x94\\xfe\\xf1\\xfb\" \"\\x95\\x00\\xf1\\x00\\xc2\\x04\\xf1\\x01\"\n\t\"\\xc3\\x0a\\xf1\\x07\\xc4\\x00\\xf1\\x10\";\nstatic u8 dat_common11[] =\n\t\"\\xf0\\x00\\xf1\\x01\\x05\\x00\\xf1\\x06\" \"\\x25\\x00\\xf1\\x55\\x34\\x10\\xf1\\x10\"\n\t\"\\x35\\xf0\\xf1\\x10\\x3a\\x02\\xf1\\x03\" \"\\x3b\\x04\\xf1\\x2a\\x9b\\x43\\xf1\\x00\"\n\t\"\\xa4\\x03\\xf1\\xc0\\xa7\\x02\\xf1\\x81\";\n\nstatic int  mi1320_init_at_startup(struct gspca_dev *gspca_dev);\nstatic int  mi1320_configure_alt(struct gspca_dev *gspca_dev);\nstatic int  mi1320_init_pre_alt(struct gspca_dev *gspca_dev);\nstatic int  mi1320_init_post_alt(struct gspca_dev *gspca_dev);\nstatic void mi1320_post_unset_alt(struct gspca_dev *gspca_dev);\nstatic int  mi1320_sensor_settings(struct gspca_dev *gspca_dev);\nstatic int  mi1320_camera_settings(struct gspca_dev *gspca_dev);\n \n\nvoid mi1320_init_settings(struct gspca_dev *gspca_dev)\n{\n\tstruct sd *sd = (struct sd *) gspca_dev;\n\n\tsd->vcur.backlight  =  0;\n\tsd->vcur.brightness =  0;\n\tsd->vcur.sharpness  =  6;\n\tsd->vcur.contrast   = 10;\n\tsd->vcur.gamma      = 20;\n\tsd->vcur.hue        =  0;\n\tsd->vcur.saturation =  6;\n\tsd->vcur.whitebal   =  0;\n\tsd->vcur.mirror     = 0;\n\tsd->vcur.flip       = 0;\n\tsd->vcur.AC50Hz     = 1;\n\n\tsd->vmax.backlight  =  2;\n\tsd->vmax.brightness =  8;\n\tsd->vmax.sharpness  =  7;\n\tsd->vmax.contrast   =  0;  \n\tsd->vmax.gamma      = 40;\n\tsd->vmax.hue        =  5 + 1;\n\tsd->vmax.saturation =  8;\n\tsd->vmax.whitebal   =  2;\n\tsd->vmax.mirror     = 1;\n\tsd->vmax.flip       = 1;\n\tsd->vmax.AC50Hz     = 1;\n\n\tsd->dev_camera_settings = mi1320_camera_settings;\n\tsd->dev_init_at_startup = mi1320_init_at_startup;\n\tsd->dev_configure_alt   = mi1320_configure_alt;\n\tsd->dev_init_pre_alt    = mi1320_init_pre_alt;\n\tsd->dev_post_unset_alt  = mi1320_post_unset_alt;\n}\n\n \n\nstatic void common(struct gspca_dev *gspca_dev)\n{\n\ts32 n;  \n\n\tctrl_out(gspca_dev, 0x40, 3, 0x0000, 0x0200, 22, dat_common00);\n\tctrl_out(gspca_dev, 0x40, 1, 0x0041, 0x0000, 0, NULL);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 32, dat_common01);\n\tn = fetch_validx(gspca_dev, tbl_common, ARRAY_SIZE(tbl_common));\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 48, dat_common02);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 48, dat_common03);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 16, dat_common04);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 48, dat_common05);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 44, dat_common06);\n\tkeep_on_fetching_validx(gspca_dev, tbl_common,\n\t\t\t\t\tARRAY_SIZE(tbl_common), n);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 52, dat_common07);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 48, dat_common08);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 48, dat_common09);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 56, dat_common10);\n\tkeep_on_fetching_validx(gspca_dev, tbl_common,\n\t\t\t\t\tARRAY_SIZE(tbl_common), n);\n\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 40, dat_common11);\n\tkeep_on_fetching_validx(gspca_dev, tbl_common,\n\t\t\t\t\tARRAY_SIZE(tbl_common), n);\n}\n\nstatic int mi1320_init_at_startup(struct gspca_dev *gspca_dev)\n{\n\tfetch_validx(gspca_dev, tbl_init_at_startup,\n\t\t\t\tARRAY_SIZE(tbl_init_at_startup));\n\n\tcommon(gspca_dev);\n\n \n\n\treturn 0;\n}\n\nstatic int mi1320_init_pre_alt(struct gspca_dev *gspca_dev)\n{\n\tstruct sd *sd = (struct sd *) gspca_dev;\n\n\tsd->mirrorMask = 0;\n\n\tsd->vold.backlight  = -1;\n\tsd->vold.brightness = -1;\n\tsd->vold.sharpness  = -1;\n\tsd->vold.contrast   = -1;\n\tsd->vold.saturation = -1;\n\tsd->vold.gamma    = -1;\n\tsd->vold.hue      = -1;\n\tsd->vold.whitebal = -1;\n\tsd->vold.mirror   = -1;\n\tsd->vold.flip     = -1;\n\tsd->vold.AC50Hz   = -1;\n\n\tcommon(gspca_dev);\n\n\tmi1320_sensor_settings(gspca_dev);\n\n\tmi1320_init_post_alt(gspca_dev);\n\n\treturn 0;\n}\n\nstatic int mi1320_init_post_alt(struct gspca_dev *gspca_dev)\n{\n\tmi1320_camera_settings(gspca_dev);\n\n\treturn 0;\n}\n\nstatic int mi1320_sensor_settings(struct gspca_dev *gspca_dev)\n{\n\ts32 reso = gspca_dev->cam.cam_mode[(s32) gspca_dev->curr_mode].priv;\n\n\tctrl_out(gspca_dev, 0x40, 5, 0x0001, 0x0000, 0, NULL);\n\n\tfetch_validx(gspca_dev, tbl_sensor_settings_common,\n\t\t\t\tARRAY_SIZE(tbl_sensor_settings_common));\n\n\tswitch (reso) {\n\tcase IMAGE_1280:\n\t\tfetch_validx(gspca_dev, tbl_sensor_settings_1280,\n\t\t\t\t\tARRAY_SIZE(tbl_sensor_settings_1280));\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 64, tbl_1280[0]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 40, tbl_1280[1]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0x0000, 0x0200, 12, tbl_1280[2]);\n\t\tbreak;\n\n\tcase IMAGE_800:\n\t\tfetch_validx(gspca_dev, tbl_sensor_settings_800,\n\t\t\t\t\tARRAY_SIZE(tbl_sensor_settings_800));\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 64, tbl_800[0]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 40, tbl_800[1]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0x0000, 0x0200, 12, tbl_800[2]);\n\t\tbreak;\n\n\tdefault:\n\t\tfetch_validx(gspca_dev, tbl_sensor_settings_640,\n\t\t\t\t\tARRAY_SIZE(tbl_sensor_settings_640));\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 60, tbl_640[0]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 40, tbl_640[1]);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0x0000, 0x0200, 12, tbl_640[2]);\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic int mi1320_configure_alt(struct gspca_dev *gspca_dev)\n{\n\ts32 reso = gspca_dev->cam.cam_mode[(s32) gspca_dev->curr_mode].priv;\n\n\tswitch (reso) {\n\tcase IMAGE_640:\n\t\tgspca_dev->alt = 3 + 1;\n\t\tbreak;\n\n\tcase IMAGE_800:\n\tcase IMAGE_1280:\n\t\tgspca_dev->alt = 1 + 1;\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic int mi1320_camera_settings(struct gspca_dev *gspca_dev)\n{\n\tstruct sd *sd = (struct sd *) gspca_dev;\n\n\ts32 backlight = sd->vcur.backlight;\n\ts32 bright = sd->vcur.brightness;\n\ts32 sharp  = sd->vcur.sharpness;\n\ts32 cntr   = sd->vcur.contrast;\n\ts32 gam\t   = sd->vcur.gamma;\n\ts32 hue    = sd->vcur.hue;\n\ts32 sat\t   = sd->vcur.saturation;\n\ts32 wbal   = sd->vcur.whitebal;\n\ts32 mirror = (((sd->vcur.mirror > 0) ^ sd->mirrorMask) > 0);\n\ts32 flip   = (((sd->vcur.flip   > 0) ^ sd->mirrorMask) > 0);\n\ts32 freq   = (sd->vcur.AC50Hz > 0);\n\ts32 i;\n\n\tif (freq != sd->vold.AC50Hz) {\n\t\tsd->vold.AC50Hz = freq;\n\n\t\tfreq = 2 * (freq == 0);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba02, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00       , 0x005b, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01 + freq, 0x00f1, 0, NULL);\n\t}\n\n\tif (wbal != sd->vold.whitebal) {\n\t\tsd->vold.whitebal = wbal;\n\t\tif (wbal < 0 || wbal > sd->vmax.whitebal)\n\t\t\twbal = 0;\n\n\t\tfor (i = 0; i < 2; i++) {\n\t\t\tif (wbal == 0) {  \n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0010, 0x0010, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0003, 0x00c1, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0042, 0x00c2, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 3,\n\t\t\t\t\t\t0xba00, 0x0200, 48, dat_wbalNL);\n\t\t\t}\n\n\t\t\tif (wbal == 1) {  \n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0010, 0x0010, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0004, 0x00c1, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0043, 0x00c2, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 3,\n\t\t\t\t\t\t0xba00, 0x0200, 48, dat_wbalLL);\n\t\t\t}\n\n\t\t\tif (wbal == 2) {  \n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0010, 0x0010, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0003, 0x00c1, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 1,\n\t\t\t\t\t\t0x0042, 0x00c2, 0, NULL);\n\t\t\t\tctrl_out(gspca_dev, 0x40, 3,\n\t\t\t\t\t\t0xba00, 0x0200, 44, dat_wbalBL);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (bright != sd->vold.brightness) {\n\t\tsd->vold.brightness = bright;\n\t\tif (bright < 0 || bright > sd->vmax.brightness)\n\t\t\tbright = 0;\n\n\t\tbright = tbl_bright[bright];\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + bright, 0x0034, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + bright, 0x00f1, 0, NULL);\n\t}\n\n\tif (sat != sd->vold.saturation) {\n\t\tsd->vold.saturation = sat;\n\t\tif (sat < 0 || sat > sd->vmax.saturation)\n\t\t\tsat = 0;\n\n\t\tsat = tbl_sat[sat];\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00      , 0x0025, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + sat, 0x00f1, 0, NULL);\n\t}\n\n\tif (sharp != sd->vold.sharpness) {\n\t\tsd->vold.sharpness = sharp;\n\t\tif (sharp < 0 || sharp > sd->vmax.sharpness)\n\t\t\tsharp = 0;\n\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00        , 0x0005, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + sharp, 0x00f1, 0, NULL);\n\t}\n\n\tif (hue != sd->vold.hue) {\n\t\t \n\t\tif (hue < 0 || hue > sd->vmax.hue)\n\t\t\thue = 0;\n\t\tif (hue == sd->vmax.hue)\n\t\t\tsd->swapRB = 1;\n\t\telse\n\t\t\tsd->swapRB = 0;\n\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba70, 0x00e2, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + hue * (hue < 6), 0x00f1,\n\t\t\t\t\t\t\t0, NULL);\n\t}\n\n\tif (backlight != sd->vold.backlight) {\n\t\tsd->vold.backlight = backlight;\n\t\tif (backlight < 0 || backlight > sd->vmax.backlight)\n\t\t\tbacklight = 0;\n\n\t\tbacklight = tbl_backlight[backlight];\n\t\tfor (i = 0; i < 2; i++) {\n\t\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\t\tctrl_out(gspca_dev, 0x40, 1, 0xba74, 0x0006, 0, NULL);\n\t\t\tctrl_out(gspca_dev, 0x40, 1, 0xba80 + backlight, 0x00f1,\n\t\t\t\t\t\t\t\t0, NULL);\n\t\t}\n\t}\n\n\tif (hue != sd->vold.hue) {\n\t\tsd->vold.hue = hue;\n\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba70, 0x00e2, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + hue * (hue < 6), 0x00f1,\n\t\t\t\t\t\t\t0, NULL);\n\t}\n\n\tif (mirror != sd->vold.mirror || flip != sd->vold.flip) {\n\t\tu8 dat_hvflip2[4] = {0x20, 0x01, 0xf1, 0x00};\n\t\tsd->vold.mirror = mirror;\n\t\tsd->vold.flip = flip;\n\n\t\tdat_hvflip2[3] = flip + 2 * mirror;\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 4, dat_hvflip1);\n\t\tctrl_out(gspca_dev, 0x40, 3, 0xba00, 0x0200, 4, dat_hvflip2);\n\t}\n\n\tif (gam != sd->vold.gamma) {\n\t\tsd->vold.gamma = gam;\n\t\tif (gam < 0 || gam > sd->vmax.gamma)\n\t\t\tgam = 0;\n\n\t\tgam = 2 * gam;\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba04      , 0x003b, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba02 + gam, 0x00f1, 0, NULL);\n\t}\n\n\tif (cntr != sd->vold.contrast) {\n\t\tsd->vold.contrast = cntr;\n\t\tif (cntr < 0 || cntr > sd->vmax.contrast)\n\t\t\tcntr = 0;\n\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00, 0x00f0, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba01, 0x00f1, 0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + tbl_cntr1[cntr], 0x0035,\n\t\t\t\t\t\t\t0, NULL);\n\t\tctrl_out(gspca_dev, 0x40, 1, 0xba00 + tbl_cntr2[cntr], 0x00f1,\n\t\t\t\t\t\t\t0, NULL);\n\t}\n\n\treturn 0;\n}\n\nstatic void mi1320_post_unset_alt(struct gspca_dev *gspca_dev)\n{\n\tctrl_out(gspca_dev, 0x40, 5, 0x0000, 0x0000, 0, NULL);\n\n\tfetch_validx(gspca_dev, tbl_post_unset_alt,\n\t\t\t\tARRAY_SIZE(tbl_post_unset_alt));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}