{
  "module_name": "vidtv_psi.h",
  "hash_id": "73cf36efb230936e5fc427417113170340670693737abb19010d24369fbcfc20",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/test-drivers/vidtv/vidtv_psi.h",
  "human_readable_source": " \n \n\n#ifndef VIDTV_PSI_H\n#define VIDTV_PSI_H\n\n#include <linux/types.h>\n\n \n#define PAT_LEN_UNTIL_LAST_SECTION_NUMBER 5\n#define PMT_LEN_UNTIL_PROGRAM_INFO_LENGTH 9\n#define SDT_LEN_UNTIL_RESERVED_FOR_FUTURE_USE 8\n#define NIT_LEN_UNTIL_NETWORK_DESCRIPTOR_LEN 7\n#define EIT_LEN_UNTIL_LAST_TABLE_ID 11\n#define MAX_SECTION_LEN 1021\n#define EIT_MAX_SECTION_LEN 4093  \n#define VIDTV_PAT_PID 0  \n#define VIDTV_SDT_PID 0x0011  \n#define VIDTV_NIT_PID 0x0010  \n#define VIDTV_EIT_PID 0x0012  \n\nenum vidtv_psi_descriptors {\n\tREGISTRATION_DESCRIPTOR\t= 0x05,  \n\tNETWORK_NAME_DESCRIPTOR = 0x40,  \n\tSERVICE_LIST_DESCRIPTOR = 0x41,  \n\tSERVICE_DESCRIPTOR = 0x48,  \n\tSHORT_EVENT_DESCRIPTOR = 0x4d,  \n};\n\nenum vidtv_psi_stream_types {\n\tSTREAM_PRIVATE_DATA = 0x06,  \n};\n\n \nstruct vidtv_psi_desc {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\tu8 data[];\n} __packed;\n\n \nstruct vidtv_psi_desc_service {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\n\tu8 service_type;\n\tu8 provider_name_len;\n\tchar *provider_name;\n\tu8 service_name_len;\n\tchar *service_name;\n} __packed;\n\n \nstruct vidtv_psi_desc_registration {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\n\t \n\t__be32 format_id;\n\t \n\tu8 additional_identification_info[];\n} __packed;\n\n \nstruct vidtv_psi_desc_network_name {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\tchar *network_name;\n} __packed;\n\nstruct vidtv_psi_desc_service_list_entry {\n\t__be16 service_id;\n\tu8 service_type;\n\tstruct vidtv_psi_desc_service_list_entry *next;\n} __packed;\n\n \nstruct vidtv_psi_desc_service_list {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\tstruct vidtv_psi_desc_service_list_entry *service_list;\n} __packed;\n\n \nstruct vidtv_psi_desc_short_event {\n\tstruct vidtv_psi_desc *next;\n\tu8 type;\n\tu8 length;\n\tchar *iso_language_code;\n\tu8 event_name_len;\n\tchar *event_name;\n\tu8 text_len;\n\tchar *text;\n} __packed;\n\nstruct vidtv_psi_desc_short_event\n*vidtv_psi_short_event_desc_init(struct vidtv_psi_desc *head,\n\t\t\t\t char *iso_language_code,\n\t\t\t\t char *event_name,\n\t\t\t\t char *text);\n\n \nstruct vidtv_psi_table_header {\n\tu8  table_id;\n\n\t__be16 bitfield;  \n\n\t__be16 id;  \n\tu8  current_next:1;\n\tu8  version:5;\n\tu8  one2:2;\n\tu8  section_id;\t \n\tu8  last_section;  \n} __packed;\n\n \nstruct vidtv_psi_table_pat_program {\n\t__be16 service_id;\n\t__be16 bitfield;  \n\tstruct vidtv_psi_table_pat_program *next;\n} __packed;\n\n \nstruct vidtv_psi_table_pat {\n\tstruct vidtv_psi_table_header header;\n\tu16 num_pat;\n\tu16 num_pmt;\n\tstruct vidtv_psi_table_pat_program *program;\n} __packed;\n\n \nstruct vidtv_psi_table_sdt_service {\n\t__be16 service_id;\n\tu8 EIT_present_following:1;\n\tu8 EIT_schedule:1;\n\tu8 reserved:6;\n\t__be16 bitfield;  \n\tstruct vidtv_psi_desc *descriptor;\n\tstruct vidtv_psi_table_sdt_service *next;\n} __packed;\n\n \n\nstruct vidtv_psi_table_sdt {\n\tstruct vidtv_psi_table_header header;\n\t__be16 network_id;  \n\tu8  reserved;\n\tstruct vidtv_psi_table_sdt_service *service;\n} __packed;\n\n \nenum service_running_status {\n\tRUNNING = 0x4,\n};\n\n \nenum service_type {\n\t \n\tDIGITAL_TELEVISION_SERVICE = 0x1,\n\tDIGITAL_RADIO_SOUND_SERVICE = 0X2,\n};\n\n \nstruct vidtv_psi_table_pmt_stream {\n\tu8 type;\n\t__be16 bitfield;  \n\t__be16 bitfield2;  \n\tstruct vidtv_psi_desc *descriptor;\n\tstruct vidtv_psi_table_pmt_stream *next;\n} __packed;\n\n \nstruct vidtv_psi_table_pmt {\n\tstruct vidtv_psi_table_header header;\n\t__be16 bitfield;  \n\t__be16 bitfield2;  \n\tstruct vidtv_psi_desc *descriptor;\n\tstruct vidtv_psi_table_pmt_stream *stream;\n} __packed;\n\n \nstruct psi_write_args {\n\tvoid *dest_buf;\n\tvoid *from;\n\tsize_t len;\n\tu32 dest_offset;\n\tu16 pid;\n\tbool new_psi_section;\n\tu8 *continuity_counter;\n\tbool is_crc;\n\tu32 dest_buf_sz;\n\tu32 *crc;\n};\n\n \nstruct desc_write_args {\n\tvoid *dest_buf;\n\tu32 dest_offset;\n\tstruct vidtv_psi_desc *desc;\n\tu16 pid;\n\tu8 *continuity_counter;\n\tu32 dest_buf_sz;\n\tu32 *crc;\n};\n\n \nstruct crc32_write_args {\n\tvoid *dest_buf;\n\tu32 dest_offset;\n\t__be32 crc;\n\tu16 pid;\n\tu8 *continuity_counter;\n\tu32 dest_buf_sz;\n};\n\n \nstruct header_write_args {\n\tvoid *dest_buf;\n\tu32 dest_offset;\n\tstruct vidtv_psi_table_header *h;\n\tu16 pid;\n\tu8 *continuity_counter;\n\tu32 dest_buf_sz;\n\tu32 *crc;\n};\n\nstruct vidtv_psi_desc_service *vidtv_psi_service_desc_init(struct vidtv_psi_desc *head,\n\t\t\t\t\t\t\t   enum service_type service_type,\n\t\t\t\t\t\t\t   char *service_name,\n\t\t\t\t\t\t\t   char *provider_name);\n\nstruct vidtv_psi_desc_registration\n*vidtv_psi_registration_desc_init(struct vidtv_psi_desc *head,\n\t\t\t\t  __be32 format_id,\n\t\t\t\t  u8 *additional_ident_info,\n\t\t\t\t  u32 additional_info_len);\n\nstruct vidtv_psi_desc_network_name\n*vidtv_psi_network_name_desc_init(struct vidtv_psi_desc *head, char *network_name);\n\nstruct vidtv_psi_desc_service_list\n*vidtv_psi_service_list_desc_init(struct vidtv_psi_desc *head,\n\t\t\t\t  struct vidtv_psi_desc_service_list_entry *entry);\n\nstruct vidtv_psi_table_pat_program\n*vidtv_psi_pat_program_init(struct vidtv_psi_table_pat_program *head,\n\t\t\t    u16 service_id,\n\t\t\t    u16 program_map_pid);\n\nstruct vidtv_psi_table_pmt_stream*\nvidtv_psi_pmt_stream_init(struct vidtv_psi_table_pmt_stream *head,\n\t\t\t  enum vidtv_psi_stream_types stream_type,\n\t\t\t  u16 es_pid);\n\nstruct vidtv_psi_table_pat *vidtv_psi_pat_table_init(u16 transport_stream_id);\n\nstruct vidtv_psi_table_pmt *vidtv_psi_pmt_table_init(u16 program_number,\n\t\t\t\t\t\t     u16 pcr_pid);\n\nstruct vidtv_psi_table_sdt *vidtv_psi_sdt_table_init(u16 network_id,\n\t\t\t\t\t\t     u16 transport_stream_id);\n\nstruct vidtv_psi_table_sdt_service*\nvidtv_psi_sdt_service_init(struct vidtv_psi_table_sdt_service *head,\n\t\t\t   u16 service_id,\n\t\t\t   bool eit_schedule,\n\t\t\t   bool eit_present_following);\n\nvoid\nvidtv_psi_desc_destroy(struct vidtv_psi_desc *desc);\n\nvoid\nvidtv_psi_pat_program_destroy(struct vidtv_psi_table_pat_program *p);\n\nvoid\nvidtv_psi_pat_table_destroy(struct vidtv_psi_table_pat *p);\n\nvoid\nvidtv_psi_pmt_stream_destroy(struct vidtv_psi_table_pmt_stream *s);\n\nvoid\nvidtv_psi_pmt_table_destroy(struct vidtv_psi_table_pmt *pmt);\n\nvoid\nvidtv_psi_sdt_table_destroy(struct vidtv_psi_table_sdt *sdt);\n\nvoid\nvidtv_psi_sdt_service_destroy(struct vidtv_psi_table_sdt_service *service);\n\n \nvoid\nvidtv_psi_sdt_service_assign(struct vidtv_psi_table_sdt *sdt,\n\t\t\t     struct vidtv_psi_table_sdt_service *service);\n\n \nvoid vidtv_psi_desc_assign(struct vidtv_psi_desc **to,\n\t\t\t   struct vidtv_psi_desc *desc);\n\n \nvoid vidtv_pmt_desc_assign(struct vidtv_psi_table_pmt *pmt,\n\t\t\t   struct vidtv_psi_desc **to,\n\t\t\t   struct vidtv_psi_desc *desc);\n\n \nvoid vidtv_sdt_desc_assign(struct vidtv_psi_table_sdt *sdt,\n\t\t\t   struct vidtv_psi_desc **to,\n\t\t\t   struct vidtv_psi_desc *desc);\n\n \nvoid vidtv_psi_pat_program_assign(struct vidtv_psi_table_pat *pat,\n\t\t\t\t  struct vidtv_psi_table_pat_program *p);\n\n \nvoid vidtv_psi_pmt_stream_assign(struct vidtv_psi_table_pmt *pmt,\n\t\t\t\t struct vidtv_psi_table_pmt_stream *s);\n\nstruct vidtv_psi_desc *vidtv_psi_desc_clone(struct vidtv_psi_desc *desc);\n\n \nstruct vidtv_psi_table_pmt**\nvidtv_psi_pmt_create_sec_for_each_pat_entry(struct vidtv_psi_table_pat *pat, u16 pcr_pid);\n\n \nu16 vidtv_psi_pmt_get_pid(struct vidtv_psi_table_pmt *section,\n\t\t\t  struct vidtv_psi_table_pat *pat);\n\n \nvoid vidtv_psi_pat_table_update_sec_len(struct vidtv_psi_table_pat *pat);\n\n \nvoid vidtv_psi_pmt_table_update_sec_len(struct vidtv_psi_table_pmt *pmt);\n\n \nvoid vidtv_psi_sdt_table_update_sec_len(struct vidtv_psi_table_sdt *sdt);\n\n \nstruct vidtv_psi_pat_write_args {\n\tchar *buf;\n\tu32 offset;\n\tstruct vidtv_psi_table_pat *pat;\n\tu32 buf_sz;\n\tu8 *continuity_counter;\n};\n\n \nu32 vidtv_psi_pat_write_into(struct vidtv_psi_pat_write_args *args);\n\n \n\nstruct vidtv_psi_sdt_write_args {\n\tchar *buf;\n\tu32 offset;\n\tstruct vidtv_psi_table_sdt *sdt;\n\tu32 buf_sz;\n\tu8 *continuity_counter;\n};\n\n \nu32 vidtv_psi_sdt_write_into(struct vidtv_psi_sdt_write_args *args);\n\n \nstruct vidtv_psi_pmt_write_args {\n\tchar *buf;\n\tu32 offset;\n\tstruct vidtv_psi_table_pmt *pmt;\n\tu16 pid;\n\tu32 buf_sz;\n\tu8 *continuity_counter;\n\tu16 pcr_pid;\n};\n\n \nu32 vidtv_psi_pmt_write_into(struct vidtv_psi_pmt_write_args *args);\n\n \nstruct vidtv_psi_table_pmt *vidtv_psi_find_pmt_sec(struct vidtv_psi_table_pmt **pmt_sections,\n\t\t\t\t\t\t   u16 nsections,\n\t\t\t\t\t\t   u16 program_num);\n\nu16 vidtv_psi_get_pat_program_pid(struct vidtv_psi_table_pat_program *p);\nu16 vidtv_psi_pmt_stream_get_elem_pid(struct vidtv_psi_table_pmt_stream *s);\n\n \nstruct vidtv_psi_table_transport {\n\t__be16 transport_id;\n\t__be16 network_id;\n\t__be16 bitfield;  \n\tstruct vidtv_psi_desc *descriptor;\n\tstruct vidtv_psi_table_transport *next;\n} __packed;\n\n \nstruct vidtv_psi_table_nit {\n\tstruct vidtv_psi_table_header header;\n\t__be16 bitfield;  \n\tstruct vidtv_psi_desc *descriptor;\n\t__be16 bitfield2;  \n\tstruct vidtv_psi_table_transport *transport;\n} __packed;\n\nstruct vidtv_psi_table_nit\n*vidtv_psi_nit_table_init(u16 network_id,\n\t\t\t  u16 transport_stream_id,\n\t\t\t  char *network_name,\n\t\t\t  struct vidtv_psi_desc_service_list_entry *service_list);\n\n \nstruct vidtv_psi_nit_write_args {\n\tchar *buf;\n\tu32 offset;\n\tstruct vidtv_psi_table_nit *nit;\n\tu32 buf_sz;\n\tu8 *continuity_counter;\n};\n\n \nu32 vidtv_psi_nit_write_into(struct vidtv_psi_nit_write_args *args);\n\nvoid vidtv_psi_nit_table_destroy(struct vidtv_psi_table_nit *nit);\n\n \nstruct vidtv_psi_table_eit_event {\n\t__be16 event_id;\n\tu8 start_time[5];\n\tu8 duration[3];\n\t__be16 bitfield;  \n\tstruct vidtv_psi_desc *descriptor;\n\tstruct vidtv_psi_table_eit_event *next;\n} __packed;\n\n \nstruct vidtv_psi_table_eit {\n\tstruct vidtv_psi_table_header header;\n\t__be16 transport_id;\n\t__be16 network_id;\n\tu8 last_segment;\n\tu8 last_table_id;\n\tstruct vidtv_psi_table_eit_event *event;\n} __packed;\n\nstruct vidtv_psi_table_eit\n*vidtv_psi_eit_table_init(u16 network_id,\n\t\t\t  u16 transport_stream_id,\n\t\t\t  __be16 service_id);\n\n \nstruct vidtv_psi_eit_write_args {\n\tchar *buf;\n\tu32 offset;\n\tstruct vidtv_psi_table_eit *eit;\n\tu32 buf_sz;\n\tu8 *continuity_counter;\n};\n\n \nu32 vidtv_psi_eit_write_into(struct vidtv_psi_eit_write_args *args);\n\nvoid vidtv_psi_eit_table_destroy(struct vidtv_psi_table_eit *eit);\n\n \nvoid vidtv_psi_eit_table_update_sec_len(struct vidtv_psi_table_eit *eit);\n\n \nvoid vidtv_psi_eit_event_assign(struct vidtv_psi_table_eit *eit,\n\t\t\t\tstruct vidtv_psi_table_eit_event *e);\n\nstruct vidtv_psi_table_eit_event\n*vidtv_psi_eit_event_init(struct vidtv_psi_table_eit_event *head, u16 event_id);\n\nvoid vidtv_psi_eit_event_destroy(struct vidtv_psi_table_eit_event *e);\n\n#endif \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}