{
  "module_name": "vivid-vid-common.c",
  "hash_id": "be4d327d7ba7fcd42e0d80c8652ba3dac14b16b039c54b4311a51799a53d723f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/test-drivers/vivid/vivid-vid-common.c",
  "human_readable_source": "\n \n\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/videodev2.h>\n#include <linux/v4l2-dv-timings.h>\n#include <media/v4l2-common.h>\n#include <media/v4l2-event.h>\n#include <media/v4l2-dv-timings.h>\n\n#include \"vivid-core.h\"\n#include \"vivid-vid-common.h\"\n\nconst struct v4l2_dv_timings_cap vivid_dv_timings_cap = {\n\t.type = V4L2_DV_BT_656_1120,\n\t \n\t.reserved = { 0 },\n\tV4L2_INIT_BT_TIMINGS(16, MAX_WIDTH, 16, MAX_HEIGHT, 14000000, 775000000,\n\t\tV4L2_DV_BT_STD_CEA861 | V4L2_DV_BT_STD_DMT |\n\t\tV4L2_DV_BT_STD_CVT | V4L2_DV_BT_STD_GTF,\n\t\tV4L2_DV_BT_CAP_PROGRESSIVE | V4L2_DV_BT_CAP_INTERLACED)\n};\n\n \n\nstruct vivid_fmt vivid_formats[] = {\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUYV,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.data_offset = { PLANE0_DATA_OFFSET },\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_UYVY,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YVYU,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_VYUY,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV422P,\n\t\t.vdownsampling = { 1, 1, 1 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV420,\n\t\t.vdownsampling = { 1, 2, 2 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YVU420,\n\t\t.vdownsampling = { 1, 2, 2 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV12,\n\t\t.vdownsampling = { 1, 2 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV21,\n\t\t.vdownsampling = { 1, 2 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV16,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV61,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV24,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV42,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 16 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x8000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV565,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0xf000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x000000ff,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_AYUV32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x000000ff,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XYUV32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_VUYA32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0xff000000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_VUYX32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUVA32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0xff000000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUVX32,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_GREY,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.color_enc = TGP_COLOR_ENC_LUMA,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_Y10,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_LUMA,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_Y12,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_LUMA,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_Y16,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_LUMA,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_Y16_BE,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.color_enc = TGP_COLOR_ENC_LUMA,\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB332,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB565,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB565X,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XRGB444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ARGB444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x00f0,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBX444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBA444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x00f0,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XBGR444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ABGR444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x00f0,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRX444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRA444,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x00f0,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XRGB555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ARGB555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t\t.alpha_mask = 0x8000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBX555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBA555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t\t.alpha_mask = 0x8000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XBGR555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ABGR555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t\t.alpha_mask = 0x8000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRX555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRA555,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.can_do_overlay = true,\n\t\t.alpha_mask = 0x8000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB555X,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XRGB555X,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ARGB555X,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x0080,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB24,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 24 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGR24,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 24 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGR666,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGB32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGR32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XRGB32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_XBGR32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ARGB32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x000000ff,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_ABGR32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0xff000000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBX32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRX32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_RGBA32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0x000000ff,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_BGRA32,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t\t.alpha_mask = 0xff000000,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SBGGR8,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGBRG8,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGRBG8,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SRGGB8,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 8 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SBGGR10,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGBRG10,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGRBG10,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SRGGB10,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SBGGR12,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGBRG12,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGRBG12,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SRGGB12,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SBGGR16,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGBRG16,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SGRBG16,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_SRGGB16,  \n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 16 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_HSV24,  \n\t\t.color_enc = TGP_COLOR_ENC_HSV,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 24 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_HSV32,  \n\t\t.color_enc = TGP_COLOR_ENC_HSV,\n\t\t.vdownsampling = { 1 },\n\t\t.bit_depth = { 32 },\n\t\t.planes   = 1,\n\t\t.buffers = 1,\n\t},\n\n\t \n\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV16M,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 2,\n\t\t.data_offset = { PLANE0_DATA_OFFSET, 0 },\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV61M,\n\t\t.vdownsampling = { 1, 1 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 2,\n\t\t.data_offset = { 0, PLANE0_DATA_OFFSET },\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV420M,\n\t\t.vdownsampling = { 1, 2, 2 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YVU420M,\n\t\t.vdownsampling = { 1, 2, 2 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV12M,\n\t\t.vdownsampling = { 1, 2 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 2,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_NV21M,\n\t\t.vdownsampling = { 1, 2 },\n\t\t.bit_depth = { 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 2,\n\t\t.buffers = 2,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV422M,\n\t\t.vdownsampling = { 1, 1, 1 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YVU422M,\n\t\t.vdownsampling = { 1, 1, 1 },\n\t\t.bit_depth = { 8, 4, 4 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YUV444M,\n\t\t.vdownsampling = { 1, 1, 1 },\n\t\t.bit_depth = { 8, 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n\t{\n\t\t.fourcc   = V4L2_PIX_FMT_YVU444M,\n\t\t.vdownsampling = { 1, 1, 1 },\n\t\t.bit_depth = { 8, 8, 8 },\n\t\t.color_enc = TGP_COLOR_ENC_YCBCR,\n\t\t.planes   = 3,\n\t\t.buffers = 3,\n\t},\n};\n\n \n#define VIVID_MPLANAR_FORMATS 10\n\nconst struct vivid_fmt *vivid_get_format(struct vivid_dev *dev, u32 pixelformat)\n{\n\tconst struct vivid_fmt *fmt;\n\tunsigned k;\n\n\tfor (k = 0; k < ARRAY_SIZE(vivid_formats); k++) {\n\t\tfmt = &vivid_formats[k];\n\t\tif (fmt->fourcc == pixelformat)\n\t\t\tif (fmt->buffers == 1 || dev->multiplanar)\n\t\t\t\treturn fmt;\n\t}\n\n\treturn NULL;\n}\n\nbool vivid_vid_can_loop(struct vivid_dev *dev)\n{\n\tif (dev->src_rect.width != dev->sink_rect.width ||\n\t    dev->src_rect.height != dev->sink_rect.height)\n\t\treturn false;\n\tif (dev->fmt_cap->fourcc != dev->fmt_out->fourcc)\n\t\treturn false;\n\tif (dev->field_cap != dev->field_out)\n\t\treturn false;\n\t \n\tif (dev->field_cap == V4L2_FIELD_SEQ_TB ||\n\t    dev->field_cap == V4L2_FIELD_SEQ_BT)\n\t\treturn false;\n\tif (vivid_is_svid_cap(dev) && vivid_is_svid_out(dev)) {\n\t\tif (!(dev->std_cap[dev->input] & V4L2_STD_525_60) !=\n\t\t    !(dev->std_out & V4L2_STD_525_60))\n\t\t\treturn false;\n\t\treturn true;\n\t}\n\tif (vivid_is_hdmi_cap(dev) && vivid_is_hdmi_out(dev))\n\t\treturn true;\n\treturn false;\n}\n\nvoid vivid_send_source_change(struct vivid_dev *dev, unsigned type)\n{\n\tstruct v4l2_event ev = {\n\t\t.type = V4L2_EVENT_SOURCE_CHANGE,\n\t\t.u.src_change.changes = V4L2_EVENT_SRC_CH_RESOLUTION,\n\t};\n\tunsigned i;\n\n\tfor (i = 0; i < dev->num_inputs; i++) {\n\t\tev.id = i;\n\t\tif (dev->input_type[i] == type) {\n\t\t\tif (video_is_registered(&dev->vid_cap_dev) && dev->has_vid_cap)\n\t\t\t\tv4l2_event_queue(&dev->vid_cap_dev, &ev);\n\t\t\tif (video_is_registered(&dev->vbi_cap_dev) && dev->has_vbi_cap)\n\t\t\t\tv4l2_event_queue(&dev->vbi_cap_dev, &ev);\n\t\t}\n\t}\n}\n\n \nvoid fmt_sp2mp(const struct v4l2_format *sp_fmt, struct v4l2_format *mp_fmt)\n{\n\tstruct v4l2_pix_format_mplane *mp = &mp_fmt->fmt.pix_mp;\n\tstruct v4l2_plane_pix_format *ppix = &mp->plane_fmt[0];\n\tconst struct v4l2_pix_format *pix = &sp_fmt->fmt.pix;\n\tbool is_out = sp_fmt->type == V4L2_BUF_TYPE_VIDEO_OUTPUT;\n\n\tmemset(mp->reserved, 0, sizeof(mp->reserved));\n\tmp_fmt->type = is_out ? V4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE :\n\t\t\t   V4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE;\n\tmp->width = pix->width;\n\tmp->height = pix->height;\n\tmp->pixelformat = pix->pixelformat;\n\tmp->field = pix->field;\n\tmp->colorspace = pix->colorspace;\n\tmp->xfer_func = pix->xfer_func;\n\t \n\tmp->ycbcr_enc = pix->ycbcr_enc;\n\tmp->quantization = pix->quantization;\n\tmp->num_planes = 1;\n\tmp->flags = pix->flags;\n\tppix->sizeimage = pix->sizeimage;\n\tppix->bytesperline = pix->bytesperline;\n\tmemset(ppix->reserved, 0, sizeof(ppix->reserved));\n}\n\nint fmt_sp2mp_func(struct file *file, void *priv,\n\t\tstruct v4l2_format *f, fmtfunc func)\n{\n\tstruct v4l2_format fmt;\n\tstruct v4l2_pix_format_mplane *mp = &fmt.fmt.pix_mp;\n\tstruct v4l2_plane_pix_format *ppix = &mp->plane_fmt[0];\n\tstruct v4l2_pix_format *pix = &f->fmt.pix;\n\tint ret;\n\n\t \n\tfmt_sp2mp(f, &fmt);\n\t \n\tret = func(file, priv, &fmt);\n\t \n\tpix->width = mp->width;\n\tpix->height = mp->height;\n\tpix->pixelformat = mp->pixelformat;\n\tpix->field = mp->field;\n\tpix->colorspace = mp->colorspace;\n\tpix->xfer_func = mp->xfer_func;\n\t \n\tpix->ycbcr_enc = mp->ycbcr_enc;\n\tpix->quantization = mp->quantization;\n\tpix->sizeimage = ppix->sizeimage;\n\tpix->bytesperline = ppix->bytesperline;\n\tpix->flags = mp->flags;\n\treturn ret;\n}\n\nint vivid_vid_adjust_sel(unsigned flags, struct v4l2_rect *r)\n{\n\tunsigned w = r->width;\n\tunsigned h = r->height;\n\n\t \n\tw &= 0xffff;\n\th &= 0xffff;\n\tif (!(flags & V4L2_SEL_FLAG_LE)) {\n\t\tw++;\n\t\th++;\n\t\tif (w < 2)\n\t\t\tw = 2;\n\t\tif (h < 2)\n\t\t\th = 2;\n\t}\n\tif (!(flags & V4L2_SEL_FLAG_GE)) {\n\t\tif (w > MAX_WIDTH)\n\t\t\tw = MAX_WIDTH;\n\t\tif (h > MAX_HEIGHT)\n\t\t\th = MAX_HEIGHT;\n\t}\n\tw = w & ~1;\n\th = h & ~1;\n\tif (w < 2 || h < 2)\n\t\treturn -ERANGE;\n\tif (w > MAX_WIDTH || h > MAX_HEIGHT)\n\t\treturn -ERANGE;\n\tif (r->top < 0)\n\t\tr->top = 0;\n\tif (r->left < 0)\n\t\tr->left = 0;\n\t \n\tr->left &= 0xfffe;\n\tr->top &= 0xfffe;\n\tif (r->left + w > MAX_WIDTH)\n\t\tr->left = MAX_WIDTH - w;\n\tif (r->top + h > MAX_HEIGHT)\n\t\tr->top = MAX_HEIGHT - h;\n\tif ((flags & (V4L2_SEL_FLAG_GE | V4L2_SEL_FLAG_LE)) ==\n\t\t\t(V4L2_SEL_FLAG_GE | V4L2_SEL_FLAG_LE) &&\n\t    (r->width != w || r->height != h))\n\t\treturn -ERANGE;\n\tr->width = w;\n\tr->height = h;\n\treturn 0;\n}\n\nint vivid_enum_fmt_vid(struct file *file, void  *priv,\n\t\t\t\t\tstruct v4l2_fmtdesc *f)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tconst struct vivid_fmt *fmt;\n\n\tif (f->index >= ARRAY_SIZE(vivid_formats) -\n\t    (dev->multiplanar ? 0 : VIVID_MPLANAR_FORMATS))\n\t\treturn -EINVAL;\n\n\tfmt = &vivid_formats[f->index];\n\n\tf->pixelformat = fmt->fourcc;\n\n\tif (f->type != V4L2_BUF_TYPE_VIDEO_CAPTURE &&\n\t    f->type != V4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE)\n\t\treturn 0;\n\t \n\tf->flags |= V4L2_FMT_FLAG_CSC_COLORSPACE;\n\tf->flags |= V4L2_FMT_FLAG_CSC_XFER_FUNC;\n\n\tif (fmt->color_enc == TGP_COLOR_ENC_YCBCR) {\n\t\tf->flags |= V4L2_FMT_FLAG_CSC_YCBCR_ENC;\n\t\tf->flags |= V4L2_FMT_FLAG_CSC_QUANTIZATION;\n\t} else if (fmt->color_enc == TGP_COLOR_ENC_HSV) {\n\t\tf->flags |= V4L2_FMT_FLAG_CSC_HSV_ENC;\n\t} else if (fmt->color_enc == TGP_COLOR_ENC_RGB) {\n\t\tf->flags |= V4L2_FMT_FLAG_CSC_QUANTIZATION;\n\t}\n\n\treturn 0;\n}\n\nint vidioc_g_std(struct file *file, void *priv, v4l2_std_id *id)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tstruct video_device *vdev = video_devdata(file);\n\n\tif (vdev->vfl_dir == VFL_DIR_RX) {\n\t\tif (!vivid_is_sdtv_cap(dev))\n\t\t\treturn -ENODATA;\n\t\t*id = dev->std_cap[dev->input];\n\t} else {\n\t\tif (!vivid_is_svid_out(dev))\n\t\t\treturn -ENODATA;\n\t\t*id = dev->std_out;\n\t}\n\treturn 0;\n}\n\nint vidioc_g_dv_timings(struct file *file, void *_fh,\n\t\t\t\t    struct v4l2_dv_timings *timings)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tstruct video_device *vdev = video_devdata(file);\n\n\tif (vdev->vfl_dir == VFL_DIR_RX) {\n\t\tif (!vivid_is_hdmi_cap(dev))\n\t\t\treturn -ENODATA;\n\t\t*timings = dev->dv_timings_cap[dev->input];\n\t} else {\n\t\tif (!vivid_is_hdmi_out(dev))\n\t\t\treturn -ENODATA;\n\t\t*timings = dev->dv_timings_out;\n\t}\n\treturn 0;\n}\n\nint vidioc_enum_dv_timings(struct file *file, void *_fh,\n\t\t\t\t    struct v4l2_enum_dv_timings *timings)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tstruct video_device *vdev = video_devdata(file);\n\n\tif (vdev->vfl_dir == VFL_DIR_RX) {\n\t\tif (!vivid_is_hdmi_cap(dev))\n\t\t\treturn -ENODATA;\n\t} else {\n\t\tif (!vivid_is_hdmi_out(dev))\n\t\t\treturn -ENODATA;\n\t}\n\treturn v4l2_enum_dv_timings_cap(timings, &vivid_dv_timings_cap,\n\t\t\tNULL, NULL);\n}\n\nint vidioc_dv_timings_cap(struct file *file, void *_fh,\n\t\t\t\t    struct v4l2_dv_timings_cap *cap)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tstruct video_device *vdev = video_devdata(file);\n\n\tif (vdev->vfl_dir == VFL_DIR_RX) {\n\t\tif (!vivid_is_hdmi_cap(dev))\n\t\t\treturn -ENODATA;\n\t} else {\n\t\tif (!vivid_is_hdmi_out(dev))\n\t\t\treturn -ENODATA;\n\t}\n\t*cap = vivid_dv_timings_cap;\n\treturn 0;\n}\n\nint vidioc_g_edid(struct file *file, void *_fh,\n\t\t\t struct v4l2_edid *edid)\n{\n\tstruct vivid_dev *dev = video_drvdata(file);\n\tstruct video_device *vdev = video_devdata(file);\n\tstruct cec_adapter *adap;\n\n\tmemset(edid->reserved, 0, sizeof(edid->reserved));\n\tif (vdev->vfl_dir == VFL_DIR_RX) {\n\t\tif (edid->pad >= dev->num_inputs)\n\t\t\treturn -EINVAL;\n\t\tif (dev->input_type[edid->pad] != HDMI)\n\t\t\treturn -EINVAL;\n\t\tadap = dev->cec_rx_adap;\n\t} else {\n\t\tunsigned int bus_idx;\n\n\t\tif (edid->pad >= dev->num_outputs)\n\t\t\treturn -EINVAL;\n\t\tif (dev->output_type[edid->pad] != HDMI)\n\t\t\treturn -EINVAL;\n\t\tif (!dev->display_present[edid->pad])\n\t\t\treturn -ENODATA;\n\t\tbus_idx = dev->cec_output2bus_map[edid->pad];\n\t\tadap = dev->cec_tx_adap[bus_idx];\n\t}\n\tif (edid->start_block == 0 && edid->blocks == 0) {\n\t\tedid->blocks = dev->edid_blocks;\n\t\treturn 0;\n\t}\n\tif (dev->edid_blocks == 0)\n\t\treturn -ENODATA;\n\tif (edid->start_block >= dev->edid_blocks)\n\t\treturn -EINVAL;\n\tif (edid->blocks > dev->edid_blocks - edid->start_block)\n\t\tedid->blocks = dev->edid_blocks - edid->start_block;\n\tif (adap)\n\t\tv4l2_set_edid_phys_addr(dev->edid, dev->edid_blocks * 128, adap->phys_addr);\n\tmemcpy(edid->edid, dev->edid + edid->start_block * 128, edid->blocks * 128);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}