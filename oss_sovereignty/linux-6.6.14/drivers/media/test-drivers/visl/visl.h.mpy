{
  "module_name": "visl.h",
  "hash_id": "d8b3a95f92bb169bd8db948744889fe8470c78cfbf4e7468a7abff93449b560f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/test-drivers/visl/visl.h",
  "human_readable_source": " \n \n\n#ifndef _VISL_H_\n#define _VISL_H_\n\n#include <linux/debugfs.h>\n#include <linux/list.h>\n\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/tpg/v4l2-tpg.h>\n\n#define VISL_NAME\t\t\"visl\"\n#define VISL_M2M_NQUEUES\t2\n\n#define TPG_STR_BUF_SZ\t\t2048\n\nextern unsigned int visl_transtime_ms;\n\nstruct visl_ctrls {\n\tconst struct visl_ctrl_desc *ctrls;\n\tunsigned int num_ctrls;\n};\n\nstruct visl_coded_format_desc {\n\tu32 pixelformat;\n\tstruct v4l2_frmsize_stepwise frmsize;\n\tconst struct visl_ctrls *ctrls;\n\tunsigned int num_decoded_fmts;\n\tconst u32 *decoded_fmts;\n};\n\nextern const struct visl_coded_format_desc visl_coded_fmts[];\nextern const size_t num_coded_fmts;\n\nenum {\n\tV4L2_M2M_SRC = 0,\n\tV4L2_M2M_DST = 1,\n};\n\nextern unsigned int visl_debug;\n#define dprintk(dev, fmt, arg...) \\\n\tv4l2_dbg(1, visl_debug, &(dev)->v4l2_dev, \"%s: \" fmt, __func__, ## arg)\n\nextern int visl_dprintk_frame_start;\nextern unsigned int visl_dprintk_nframes;\nextern bool keep_bitstream_buffers;\nextern int bitstream_trace_frame_start;\nextern unsigned int bitstream_trace_nframes;\n\n#define frame_dprintk(dev, current, fmt, arg...) \\\n\tdo { \\\n\t\tif (visl_dprintk_frame_start > -1 && \\\n\t\t    (current) >= visl_dprintk_frame_start && \\\n\t\t    (current) < visl_dprintk_frame_start + visl_dprintk_nframes) \\\n\t\t\tdprintk(dev, fmt, ## arg); \\\n\t} while (0) \\\n\nstruct visl_q_data {\n\tunsigned int\t\tsequence;\n};\n\nstruct visl_dev {\n\tstruct v4l2_device\tv4l2_dev;\n\tstruct video_device\tvfd;\n#ifdef CONFIG_MEDIA_CONTROLLER\n\tstruct media_device\tmdev;\n#endif\n\n\tstruct mutex\t\tdev_mutex;\n\n\tstruct v4l2_m2m_dev\t*m2m_dev;\n\n#ifdef CONFIG_VISL_DEBUGFS\n\tstruct dentry\t\t*debugfs_root;\n\tstruct dentry\t\t*bitstream_debugfs;\n\tstruct list_head\tbitstream_blobs;\n\n\t \n\tstruct mutex\t\tbitstream_lock;\n#endif\n};\n\nenum visl_codec {\n\tVISL_CODEC_NONE,\n\tVISL_CODEC_FWHT,\n\tVISL_CODEC_MPEG2,\n\tVISL_CODEC_VP8,\n\tVISL_CODEC_VP9,\n\tVISL_CODEC_H264,\n\tVISL_CODEC_HEVC,\n};\n\nstruct visl_blob {\n\tstruct list_head list;\n\tstruct dentry *dentry;\n\tstruct debugfs_blob_wrapper blob;\n};\n\nstruct visl_ctx {\n\tstruct v4l2_fh\t\tfh;\n\tstruct visl_dev\t*dev;\n\tstruct v4l2_ctrl_handler hdl;\n\n\tstruct mutex\t\tvb_mutex;\n\n\tstruct visl_q_data\tq_data[VISL_M2M_NQUEUES];\n\tenum   visl_codec\tcurrent_codec;\n\n\tconst struct visl_coded_format_desc *coded_format_desc;\n\n\tstruct v4l2_format\tcoded_fmt;\n\tstruct v4l2_format\tdecoded_fmt;\n\n\tstruct tpg_data\t\ttpg;\n\tu64\t\t\tcapture_streamon_jiffies;\n\tchar\t\t\t*tpg_str_buf;\n};\n\nstruct visl_ctrl_desc {\n\tstruct v4l2_ctrl_config cfg;\n};\n\nstatic inline struct visl_ctx *visl_file_to_ctx(struct file *file)\n{\n\treturn container_of(file->private_data, struct visl_ctx, fh);\n}\n\nstatic inline struct visl_ctx *visl_v4l2fh_to_ctx(struct v4l2_fh *v4l2_fh)\n{\n\treturn container_of(v4l2_fh, struct visl_ctx, fh);\n}\n\nvoid *visl_find_control_data(struct visl_ctx *ctx, u32 id);\nstruct v4l2_ctrl *visl_find_control(struct visl_ctx *ctx, u32 id);\nu32 visl_control_num_elems(struct visl_ctx *ctx, u32 id);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}