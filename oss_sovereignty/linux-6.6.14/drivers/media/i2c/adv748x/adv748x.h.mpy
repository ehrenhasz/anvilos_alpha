{
  "module_name": "adv748x.h",
  "hash_id": "0ee9fa04f53f75c5165853bed9f52fac5acc13f39585000eb65d4130e5d80ef0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/i2c/adv748x/adv748x.h",
  "human_readable_source": " \n \n\n#include <linux/i2c.h>\n\n#ifndef _ADV748X_H_\n#define _ADV748X_H_\n\nenum adv748x_page {\n\tADV748X_PAGE_IO,\n\tADV748X_PAGE_DPLL,\n\tADV748X_PAGE_CP,\n\tADV748X_PAGE_HDMI,\n\tADV748X_PAGE_EDID,\n\tADV748X_PAGE_REPEATER,\n\tADV748X_PAGE_INFOFRAME,\n\tADV748X_PAGE_CBUS,\n\tADV748X_PAGE_CEC,\n\tADV748X_PAGE_SDP,\n\tADV748X_PAGE_TXB,\n\tADV748X_PAGE_TXA,\n\tADV748X_PAGE_MAX,\n\n\t \n\tADV748X_PAGE_EOR,\t\t \n};\n\n \nenum adv748x_ports {\n\tADV748X_PORT_AIN0 = 0,\n\tADV748X_PORT_AIN1 = 1,\n\tADV748X_PORT_AIN2 = 2,\n\tADV748X_PORT_AIN3 = 3,\n\tADV748X_PORT_AIN4 = 4,\n\tADV748X_PORT_AIN5 = 5,\n\tADV748X_PORT_AIN6 = 6,\n\tADV748X_PORT_AIN7 = 7,\n\tADV748X_PORT_HDMI = 8,\n\tADV748X_PORT_TTL = 9,\n\tADV748X_PORT_TXA = 10,\n\tADV748X_PORT_TXB = 11,\n\tADV748X_PORT_MAX = 12,\n};\n\nenum adv748x_csi2_pads {\n\tADV748X_CSI2_SINK,\n\tADV748X_CSI2_SOURCE,\n\tADV748X_CSI2_NR_PADS,\n};\n\n \n#define ADV748X_CSI2_MAX_SUBDEVS 2\n\nstruct adv748x_csi2 {\n\tstruct adv748x_state *state;\n\tstruct v4l2_mbus_framefmt format;\n\tunsigned int page;\n\tunsigned int port;\n\tunsigned int num_lanes;\n\tunsigned int active_lanes;\n\n\tstruct media_pad pads[ADV748X_CSI2_NR_PADS];\n\tstruct v4l2_ctrl_handler ctrl_hdl;\n\tstruct v4l2_ctrl *pixel_rate;\n\tstruct v4l2_subdev *src;\n\tstruct v4l2_subdev sd;\n};\n\n#define notifier_to_csi2(n) container_of(n, struct adv748x_csi2, notifier)\n#define adv748x_sd_to_csi2(sd) container_of(sd, struct adv748x_csi2, sd)\n\n#define is_tx_enabled(_tx) ((_tx)->state->endpoints[(_tx)->port] != NULL)\n#define is_txa(_tx) ((_tx) == &(_tx)->state->txa)\n#define is_txb(_tx) ((_tx) == &(_tx)->state->txb)\n#define is_tx(_tx) (is_txa(_tx) || is_txb(_tx))\n\n#define is_afe_enabled(_state)\t\t\t\t\t\\\n\t((_state)->endpoints[ADV748X_PORT_AIN0] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN1] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN2] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN3] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN4] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN5] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN6] != NULL ||\t\\\n\t (_state)->endpoints[ADV748X_PORT_AIN7] != NULL)\n#define is_hdmi_enabled(_state) ((_state)->endpoints[ADV748X_PORT_HDMI] != NULL)\n\nenum adv748x_hdmi_pads {\n\tADV748X_HDMI_SINK,\n\tADV748X_HDMI_SOURCE,\n\tADV748X_HDMI_NR_PADS,\n};\n\nstruct adv748x_hdmi {\n\tstruct media_pad pads[ADV748X_HDMI_NR_PADS];\n\tstruct v4l2_ctrl_handler ctrl_hdl;\n\tstruct v4l2_subdev sd;\n\tstruct v4l2_mbus_framefmt format;\n\n\tstruct v4l2_dv_timings timings;\n\tstruct v4l2_fract aspect_ratio;\n\n\tstruct adv748x_csi2 *tx;\n\n\tstruct {\n\t\tu8 edid[512];\n\t\tu32 present;\n\t\tunsigned int blocks;\n\t} edid;\n};\n\n#define adv748x_ctrl_to_hdmi(ctrl) \\\n\tcontainer_of(ctrl->handler, struct adv748x_hdmi, ctrl_hdl)\n#define adv748x_sd_to_hdmi(sd) container_of(sd, struct adv748x_hdmi, sd)\n\nenum adv748x_afe_pads {\n\tADV748X_AFE_SINK_AIN0,\n\tADV748X_AFE_SINK_AIN1,\n\tADV748X_AFE_SINK_AIN2,\n\tADV748X_AFE_SINK_AIN3,\n\tADV748X_AFE_SINK_AIN4,\n\tADV748X_AFE_SINK_AIN5,\n\tADV748X_AFE_SINK_AIN6,\n\tADV748X_AFE_SINK_AIN7,\n\tADV748X_AFE_SOURCE,\n\tADV748X_AFE_NR_PADS,\n};\n\nstruct adv748x_afe {\n\tstruct media_pad pads[ADV748X_AFE_NR_PADS];\n\tstruct v4l2_ctrl_handler ctrl_hdl;\n\tstruct v4l2_subdev sd;\n\tstruct v4l2_mbus_framefmt format;\n\n\tstruct adv748x_csi2 *tx;\n\n\tbool streaming;\n\tv4l2_std_id curr_norm;\n\tunsigned int input;\n};\n\n#define adv748x_ctrl_to_afe(ctrl) \\\n\tcontainer_of(ctrl->handler, struct adv748x_afe, ctrl_hdl)\n#define adv748x_sd_to_afe(sd) container_of(sd, struct adv748x_afe, sd)\n\n \nstruct adv748x_state {\n\tstruct device *dev;\n\tstruct i2c_client *client;\n\tstruct mutex mutex;\n\n\tstruct device_node *endpoints[ADV748X_PORT_MAX];\n\n\tstruct i2c_client *i2c_clients[ADV748X_PAGE_MAX];\n\tstruct regmap *regmap[ADV748X_PAGE_MAX];\n\n\tstruct adv748x_hdmi hdmi;\n\tstruct adv748x_afe afe;\n\tstruct adv748x_csi2 txa;\n\tstruct adv748x_csi2 txb;\n};\n\n#define adv748x_hdmi_to_state(h) container_of(h, struct adv748x_state, hdmi)\n#define adv748x_afe_to_state(a) container_of(a, struct adv748x_state, afe)\n\n#define adv_err(a, fmt, arg...)\tdev_err(a->dev, fmt, ##arg)\n#define adv_info(a, fmt, arg...) dev_info(a->dev, fmt, ##arg)\n#define adv_dbg(a, fmt, arg...)\tdev_dbg(a->dev, fmt, ##arg)\n\n \n\n \n#define ADV748X_IO_PD\t\t\t0x00\t \n#define ADV748X_IO_PD_RX_EN\t\tBIT(6)\n\n#define ADV748X_IO_REG_01\t\t0x01\t \n#define ADV748X_IO_REG_01_PWRDN_MASK\t(BIT(7) | BIT(6))\n#define ADV748X_IO_REG_01_PWRDN2B\tBIT(7)\t \n#define ADV748X_IO_REG_01_PWRDNB\tBIT(6)\t \n\n#define ADV748X_IO_REG_04\t\t0x04\n#define ADV748X_IO_REG_04_FORCE_FR\tBIT(0)\t \n\n#define ADV748X_IO_DATAPATH\t\t0x03\t \n#define ADV748X_IO_DATAPATH_VFREQ_M\t0x70\n#define ADV748X_IO_DATAPATH_VFREQ_SHIFT\t4\n\n#define ADV748X_IO_VID_STD\t\t0x05\n\n#define ADV748X_IO_10\t\t\t0x10\t \n#define ADV748X_IO_10_CSI4_EN\t\tBIT(7)\n#define ADV748X_IO_10_CSI1_EN\t\tBIT(6)\n#define ADV748X_IO_10_PIX_OUT_EN\tBIT(5)\n#define ADV748X_IO_10_CSI4_IN_SEL_AFE\tBIT(3)\n\n#define ADV748X_IO_CHIP_REV_ID_1\t0xdf\n#define ADV748X_IO_CHIP_REV_ID_2\t0xe0\n\n#define ADV748X_IO_REG_F2\t\t0xf2\n#define ADV748X_IO_REG_F2_READ_AUTO_INC\tBIT(0)\n\n \n#define ADV748X_IO_SLAVE_ADDR_BASE\t0xf2\n\n \n#define ADV748X_IO_REG_FF\t\t0xff\n#define ADV748X_IO_REG_FF_MAIN_RESET\t0xff\n\n \n#define ADV748X_HDMI_LW1\t\t0x07\t \n#define ADV748X_HDMI_LW1_VERT_FILTER\tBIT(7)\n#define ADV748X_HDMI_LW1_DE_REGEN\tBIT(5)\n#define ADV748X_HDMI_LW1_WIDTH_MASK\t0x1fff\n\n#define ADV748X_HDMI_F0H1\t\t0x09\t \n#define ADV748X_HDMI_F0H1_HEIGHT_MASK\t0x1fff\n\n#define ADV748X_HDMI_F1H1\t\t0x0b\t \n#define ADV748X_HDMI_F1H1_INTERLACED\tBIT(5)\n\n#define ADV748X_HDMI_HFRONT_PORCH\t0x20\t \n#define ADV748X_HDMI_HFRONT_PORCH_MASK\t0x1fff\n\n#define ADV748X_HDMI_HSYNC_WIDTH\t0x22\t \n#define ADV748X_HDMI_HSYNC_WIDTH_MASK\t0x1fff\n\n#define ADV748X_HDMI_HBACK_PORCH\t0x24\t \n#define ADV748X_HDMI_HBACK_PORCH_MASK\t0x1fff\n\n#define ADV748X_HDMI_VFRONT_PORCH\t0x2a\t \n#define ADV748X_HDMI_VFRONT_PORCH_MASK\t0x3fff\n\n#define ADV748X_HDMI_VSYNC_WIDTH\t0x2e\t \n#define ADV748X_HDMI_VSYNC_WIDTH_MASK\t0x3fff\n\n#define ADV748X_HDMI_VBACK_PORCH\t0x32\t \n#define ADV748X_HDMI_VBACK_PORCH_MASK\t0x3fff\n\n#define ADV748X_HDMI_TMDS_1\t\t0x51\t \n#define ADV748X_HDMI_TMDS_2\t\t0x52\t \n\n \n#define ADV748X_REPEATER_EDID_SZ\t0x70\t \n#define ADV748X_REPEATER_EDID_SZ_SHIFT\t4\n\n#define ADV748X_REPEATER_EDID_CTL\t0x74\t \n#define ADV748X_REPEATER_EDID_CTL_EN\tBIT(0)\t \n\n \n#define ADV748X_SDP_INSEL\t\t0x00\t \n\n#define ADV748X_SDP_VID_SEL\t\t0x02\t \n#define ADV748X_SDP_VID_SEL_MASK\t0xf0\n#define ADV748X_SDP_VID_SEL_SHIFT\t4\n\n \n#define ADV748X_SDP_CON\t\t\t0x08\t \n#define ADV748X_SDP_CON_MIN\t\t0\n#define ADV748X_SDP_CON_DEF\t\t128\n#define ADV748X_SDP_CON_MAX\t\t255\n\n \n#define ADV748X_SDP_BRI\t\t\t0x0a\t \n#define ADV748X_SDP_BRI_MIN\t\t-128\n#define ADV748X_SDP_BRI_DEF\t\t0\n#define ADV748X_SDP_BRI_MAX\t\t127\n\n \n#define ADV748X_SDP_HUE\t\t\t0x0b\t \n#define ADV748X_SDP_HUE_MIN\t\t-127\n#define ADV748X_SDP_HUE_DEF\t\t0\n#define ADV748X_SDP_HUE_MAX\t\t128\n\n \n#define ADV748X_SDP_DEF\t\t\t0x0c\t \n#define ADV748X_SDP_DEF_VAL_EN\t\tBIT(0)\t \n#define ADV748X_SDP_DEF_VAL_AUTO_EN\tBIT(1)\t \n\n#define ADV748X_SDP_MAP_SEL\t\t0x0e\t \n#define ADV748X_SDP_MAP_SEL_RO_MAIN\t1\n\n \n#define ADV748X_SDP_FRP\t\t\t0x14\n#define ADV748X_SDP_FRP_MASK\t\tGENMASK(3, 1)\n\n \n#define ADV748X_SDP_SD_SAT_U\t\t0xe3\t \n#define ADV748X_SDP_SD_SAT_V\t\t0xe4\t \n#define ADV748X_SDP_SAT_MIN\t\t0\n#define ADV748X_SDP_SAT_DEF\t\t128\n#define ADV748X_SDP_SAT_MAX\t\t255\n\n \n#define ADV748X_SDP_RO_10\t\t0x10\n#define ADV748X_SDP_RO_10_IN_LOCK\tBIT(0)\n\n \n#define ADV748X_CP_PAT_GEN\t\t0x37\t \n#define ADV748X_CP_PAT_GEN_EN\t\tBIT(7)\n\n \n#define ADV748X_CP_CON\t\t\t0x3a\t \n#define ADV748X_CP_CON_MIN\t\t0\t \n#define ADV748X_CP_CON_DEF\t\t128\t \n#define ADV748X_CP_CON_MAX\t\t255\t \n\n \n#define ADV748X_CP_SAT\t\t\t0x3b\t \n#define ADV748X_CP_SAT_MIN\t\t0\t \n#define ADV748X_CP_SAT_DEF\t\t128\t \n#define ADV748X_CP_SAT_MAX\t\t255\t \n\n \n#define ADV748X_CP_BRI\t\t\t0x3c\t \n#define ADV748X_CP_BRI_MIN\t\t-128\t \n#define ADV748X_CP_BRI_DEF\t\t0\t \n#define ADV748X_CP_BRI_MAX\t\t127\t \n\n \n#define ADV748X_CP_HUE\t\t\t0x3d\t \n#define ADV748X_CP_HUE_MIN\t\t0\t \n#define ADV748X_CP_HUE_DEF\t\t0\t \n#define ADV748X_CP_HUE_MAX\t\t255\t \n\n#define ADV748X_CP_VID_ADJ\t\t0x3e\t \n#define ADV748X_CP_VID_ADJ_ENABLE\tBIT(7)\t \n\n#define ADV748X_CP_DE_POS_HIGH\t\t0x8b\t \n#define ADV748X_CP_DE_POS_HIGH_SET\tBIT(6)\n#define ADV748X_CP_DE_POS_END_LOW\t0x8c\t \n#define ADV748X_CP_DE_POS_START_LOW\t0x8d\t \n\n#define ADV748X_CP_VID_ADJ_2\t\t\t0x91\n#define ADV748X_CP_VID_ADJ_2_INTERLACED\t\tBIT(6)\n#define ADV748X_CP_VID_ADJ_2_INTERLACED_3D\tBIT(4)\n\n#define ADV748X_CP_CLMP_POS\t\t0xc9\t \n#define ADV748X_CP_CLMP_POS_DIS_AUTO\tBIT(0)\t \n\n \n#define ADV748X_CSI_VC_REF\t\t0x0d\t \n#define ADV748X_CSI_VC_REF_SHIFT\t6\n\n#define ADV748X_CSI_FS_AS_LS\t\t0x1e\t \n#define ADV748X_CSI_FS_AS_LS_UNKNOWN\tBIT(6)\t \n\n \n\nint adv748x_read(struct adv748x_state *state, u8 addr, u8 reg);\nint adv748x_write(struct adv748x_state *state, u8 page, u8 reg, u8 value);\nint adv748x_write_block(struct adv748x_state *state, int client_page,\n\t\t\tunsigned int init_reg, const void *val,\n\t\t\tsize_t val_len);\n\n#define io_read(s, r) adv748x_read(s, ADV748X_PAGE_IO, r)\n#define io_write(s, r, v) adv748x_write(s, ADV748X_PAGE_IO, r, v)\n#define io_clrset(s, r, m, v) io_write(s, r, (io_read(s, r) & ~(m)) | (v))\n\n#define hdmi_read(s, r) adv748x_read(s, ADV748X_PAGE_HDMI, r)\n#define hdmi_read16(s, r, m) (((hdmi_read(s, r) << 8) | hdmi_read(s, (r)+1)) & (m))\n#define hdmi_write(s, r, v) adv748x_write(s, ADV748X_PAGE_HDMI, r, v)\n\n#define repeater_read(s, r) adv748x_read(s, ADV748X_PAGE_REPEATER, r)\n#define repeater_write(s, r, v) adv748x_write(s, ADV748X_PAGE_REPEATER, r, v)\n\n#define sdp_read(s, r) adv748x_read(s, ADV748X_PAGE_SDP, r)\n#define sdp_write(s, r, v) adv748x_write(s, ADV748X_PAGE_SDP, r, v)\n#define sdp_clrset(s, r, m, v) sdp_write(s, r, (sdp_read(s, r) & ~(m)) | (v))\n\n#define cp_read(s, r) adv748x_read(s, ADV748X_PAGE_CP, r)\n#define cp_write(s, r, v) adv748x_write(s, ADV748X_PAGE_CP, r, v)\n#define cp_clrset(s, r, m, v) cp_write(s, r, (cp_read(s, r) & ~(m)) | (v))\n\n#define tx_read(t, r) adv748x_read(t->state, t->page, r)\n#define tx_write(t, r, v) adv748x_write(t->state, t->page, r, v)\n\nstatic inline struct v4l2_subdev *adv748x_get_remote_sd(struct media_pad *pad)\n{\n\tpad = media_pad_remote_pad_first(pad);\n\tif (!pad)\n\t\treturn NULL;\n\n\treturn media_entity_to_v4l2_subdev(pad->entity);\n}\n\nvoid adv748x_subdev_init(struct v4l2_subdev *sd, struct adv748x_state *state,\n\t\t\t const struct v4l2_subdev_ops *ops, u32 function,\n\t\t\t const char *ident);\n\nint adv748x_tx_power(struct adv748x_csi2 *tx, bool on);\n\nint adv748x_afe_init(struct adv748x_afe *afe);\nvoid adv748x_afe_cleanup(struct adv748x_afe *afe);\nint adv748x_afe_s_input(struct adv748x_afe *afe, unsigned int input);\n\nint adv748x_csi2_init(struct adv748x_state *state, struct adv748x_csi2 *tx);\nvoid adv748x_csi2_cleanup(struct adv748x_csi2 *tx);\nint adv748x_csi2_set_virtual_channel(struct adv748x_csi2 *tx, unsigned int vc);\nint adv748x_csi2_set_pixelrate(struct v4l2_subdev *sd, s64 rate);\n\nint adv748x_hdmi_init(struct adv748x_hdmi *hdmi);\nvoid adv748x_hdmi_cleanup(struct adv748x_hdmi *hdmi);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}