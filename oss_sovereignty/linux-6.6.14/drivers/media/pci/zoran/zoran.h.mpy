{
  "module_name": "zoran.h",
  "hash_id": "5047b21ea10dd769cb62dd088bd074791a3079be4a8e2d8139558f045acd69e6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/zoran/zoran.h",
  "human_readable_source": " \n \n\n#ifndef _BUZ_H_\n#define _BUZ_H_\n\n#include <linux/debugfs.h>\n#include <linux/pci.h>\n#include <linux/i2c-algo-bit.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-ctrls.h>\n#include <media/videobuf2-core.h>\n#include <media/videobuf2-v4l2.h>\n#include <media/videobuf2-dma-contig.h>\n\n#define ZR_NORM_PAL 0\n#define ZR_NORM_NTSC 1\n#define ZR_NORM_SECAM 2\n\nstruct zr_buffer {\n\t \n\tstruct vb2_v4l2_buffer          vbuf;\n\tstruct list_head                queue;\n};\n\nstatic inline struct zr_buffer *vb2_to_zr_buffer(struct vb2_buffer *vb)\n{\n\tstruct vb2_v4l2_buffer *vbuf = to_vb2_v4l2_buffer(vb);\n\n\treturn container_of(vbuf, struct zr_buffer, vbuf);\n}\n\n#define ZORAN_NAME    \"ZORAN\"\t \n\n#define ZR_DEVNAME(zr) ((zr)->name)\n\n#define   BUZ_MAX_WIDTH   (zr->timing->wa)\n#define   BUZ_MAX_HEIGHT  (zr->timing->ha)\n#define   BUZ_MIN_WIDTH    32\t \n#define   BUZ_MIN_HEIGHT   24\t \n\n#define BUZ_NUM_STAT_COM    4\n#define BUZ_MASK_STAT_COM   3\n\n#define BUZ_MAX_INPUT       16\n\n#include \"zr36057.h\"\n\nenum card_type {\n\tUNKNOWN = -1,\n\n\t \n\tDC10_OLD,\t\t \n\tDC10_NEW,\t\t \n\tDC10_PLUS,\n\tDC30,\n\tDC30_PLUS,\n\n\t \n\tLML33,\n\tLML33R10,\n\n\t \n\tBUZ,\n\n\t \n\tAVS6EYES,\n\n\t \n\tNUM_CARDS\n};\n\nenum zoran_codec_mode {\n\tBUZ_MODE_IDLE,\t\t \n\tBUZ_MODE_MOTION_COMPRESS,\t \n\tBUZ_MODE_MOTION_DECOMPRESS,\t \n\tBUZ_MODE_STILL_COMPRESS,\t \n\tBUZ_MODE_STILL_DECOMPRESS\t \n};\n\nenum zoran_map_mode {\n\tZORAN_MAP_MODE_NONE,\n\tZORAN_MAP_MODE_RAW,\n\tZORAN_MAP_MODE_JPG_REC,\n\tZORAN_MAP_MODE_JPG_PLAY,\n};\n\nenum gpio_type {\n\tZR_GPIO_JPEG_SLEEP = 0,\n\tZR_GPIO_JPEG_RESET,\n\tZR_GPIO_JPEG_FRAME,\n\tZR_GPIO_VID_DIR,\n\tZR_GPIO_VID_EN,\n\tZR_GPIO_VID_RESET,\n\tZR_GPIO_CLK_SEL1,\n\tZR_GPIO_CLK_SEL2,\n\tZR_GPIO_MAX,\n};\n\nenum gpcs_type {\n\tGPCS_JPEG_RESET = 0,\n\tGPCS_JPEG_START,\n\tGPCS_MAX,\n};\n\nstruct zoran_format {\n\tchar *name;\n\t__u32 fourcc;\n\tint colorspace;\n\tint depth;\n\t__u32 flags;\n\t__u32 vfespfr;\n};\n\n \n#define ZORAN_FORMAT_COMPRESSED BIT(0)\n#define ZORAN_FORMAT_OVERLAY BIT(1)\n#define ZORAN_FORMAT_CAPTURE BIT(2)\n#define ZORAN_FORMAT_PLAYBACK BIT(3)\n\n \nstruct zoran_v4l_settings {\n\tint width, height, bytesperline;\t \n\tconst struct zoran_format *format;\t \n};\n\n \nstruct zoran_jpg_settings {\n\t \n\tint decimation;\n\t \n\tint hor_dcm, ver_dcm, tmp_dcm;\n\t \n\tint field_per_buff, odd_even;\n\t \n\tint img_x, img_y, img_width, img_height;\n\t \n\tstruct v4l2_jpegcompression jpg_comp;\n};\n\nstruct zoran;\n\n \nstruct zoran_fh {\n\tstruct v4l2_fh fh;\n\tstruct zoran *zr;\n};\n\nstruct card_info {\n\tenum card_type type;\n\tchar name[32];\n\tconst char *i2c_decoder;\t \n\tconst unsigned short *addrs_decoder;\n\tconst char *i2c_encoder;\t \n\tconst unsigned short *addrs_encoder;\n\tu16 video_vfe, video_codec;\t\t\t \n\tu16 audio_chip;\t\t\t\t\t \n\n\tint inputs;\t\t \n\tstruct input {\n\t\tint muxsel;\n\t\tchar name[32];\n\t} input[BUZ_MAX_INPUT];\n\n\tv4l2_std_id norms;\n\tconst struct tvnorm *tvn[3];\t \n\n\tu32 jpeg_int;\t\t \n\tu32 vsync_int;\t\t \n\ts8 gpio[ZR_GPIO_MAX];\n\tu8 gpcs[GPCS_MAX];\n\n\tstruct vfe_polarity vfe_pol;\n\tu8 gpio_pol[ZR_GPIO_MAX];\n\n\t \n\tu8 gws_not_connected;\n\n\t \n\tu8 input_mux;\n\n\tvoid (*init)(struct zoran *zr);\n};\n\nstruct zoran {\n\tstruct v4l2_device v4l2_dev;\n\tstruct v4l2_ctrl_handler hdl;\n\tstruct video_device *video_dev;\n\tstruct vb2_queue vq;\n\n\tstruct i2c_adapter i2c_adapter;\t \n\tstruct i2c_algo_bit_data i2c_algo;\t \n\tu32 i2cbr;\n\n\tstruct v4l2_subdev *decoder;\t \n\tstruct v4l2_subdev *encoder;\t \n\n\tstruct videocodec *codec;\t \n\tstruct videocodec *vfe;\t \n\n\tstruct mutex lock;\t \n\n\tu8 initialized;\t\t \n\tstruct card_info card;\n\tconst struct tvnorm *timing;\n\n\tunsigned short id;\t \n\tchar name[32];\t\t \n\tstruct pci_dev *pci_dev;\t \n\tunsigned char revision;\t \n\tunsigned char __iomem *zr36057_mem; \n\n\tspinlock_t spinlock;\t \n\n\t \n\tint input;\t \n\tv4l2_std_id norm;\n\n\t \n\tunsigned int buffer_size;\n\n\tstruct zoran_v4l_settings v4l_settings;\t \n\n\t \n\tenum zoran_codec_mode codec_mode;\t \n\tstruct zoran_jpg_settings jpg_settings;\t \n\n\t \n\t \n\t \n\tunsigned long jpg_que_head;\t \n\tunsigned long jpg_dma_head;\t \n\tunsigned long jpg_dma_tail;\t \n\tunsigned long jpg_que_tail;\t \n\tunsigned long jpg_seq_num;\t \n\tunsigned long jpg_err_seq;\t \n\tunsigned long jpg_err_shift;\n\tunsigned long jpg_queued_num;\t \n\tunsigned long vbseq;\n\n\t \n\t \n\t__le32 *stat_com;\n\n\t \n\tunsigned int ghost_int;\n\tint intr_counter_GIRQ1;\n\tint intr_counter_GIRQ0;\n\tint intr_counter_cod_rep_irq;\n\tint intr_counter_jpeg_rep_irq;\n\tint field_counter;\n\tint irq1_in;\n\tint irq1_out;\n\tint jpeg_in;\n\tint jpeg_out;\n\tint JPEG_0;\n\tint JPEG_1;\n\tint end_event_missed;\n\tint jpeg_missed;\n\tint jpeg_error;\n\tint num_errors;\n\tint jpeg_max_missed;\n\tint jpeg_min_missed;\n\tunsigned int prepared;\n\tunsigned int queued;\n\n\tu32 last_isr;\n\tunsigned long frame_num;\n\tint running;\n\tint buf_in_reserve;\n\n\tdma_addr_t p_sc;\n\t__le32 *stat_comb;\n\tdma_addr_t p_scb;\n\tenum zoran_map_mode map_mode;\n\tstruct list_head queued_bufs;\n\tspinlock_t queued_bufs_lock;  \n\tstruct zr_buffer *inuse[BUZ_NUM_STAT_COM * 2];\n\tstruct dentry *dbgfs_dir;\n};\n\nstatic inline struct zoran *to_zoran(struct v4l2_device *v4l2_dev)\n{\n\treturn container_of(v4l2_dev, struct zoran, v4l2_dev);\n}\n\n \n#define btwrite(dat, adr)    writel((dat), zr->zr36057_mem + (adr))\n#define btread(adr)         readl(zr->zr36057_mem + (adr))\n\n#define btand(dat, adr)      btwrite((dat) & btread(adr), (adr))\n#define btor(dat, adr)       btwrite((dat) | btread(adr), (adr))\n#define btaor(dat, mask, adr) btwrite((dat) | ((mask) & btread(adr)), (adr))\n\n#endif\n\n \n#define zrdev_dbg(zr, format, args...) \\\n\tpci_dbg((zr)->pci_dev, format, ##args) \\\n\n#define zrdev_err(zr, format, args...) \\\n\tpci_err((zr)->pci_dev, format, ##args) \\\n\n#define zrdev_info(zr, format, args...) \\\n\tpci_info((zr)->pci_dev, format, ##args) \\\n\nint zoran_queue_init(struct zoran *zr, struct vb2_queue *vq, int dir);\nvoid zoran_queue_exit(struct zoran *zr);\nint zr_set_buf(struct zoran *zr);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}