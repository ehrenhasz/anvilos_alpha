{
  "module_name": "cx23885-ir.c",
  "hash_id": "ffe9d48f37a27184bf1763433c4ac787ea2925dfae144facb2a211a5c62082d8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/cx23885/cx23885-ir.c",
  "human_readable_source": "\n \n\n#include \"cx23885.h\"\n#include \"cx23885-ir.h\"\n#include \"cx23885-input.h\"\n\n#include <media/v4l2-device.h>\n\n#define CX23885_IR_RX_FIFO_SERVICE_REQ\t\t0\n#define CX23885_IR_RX_END_OF_RX_DETECTED\t1\n#define CX23885_IR_RX_HW_FIFO_OVERRUN\t\t2\n#define CX23885_IR_RX_SW_FIFO_OVERRUN\t\t3\n\n#define CX23885_IR_TX_FIFO_SERVICE_REQ\t\t0\n\n\nvoid cx23885_ir_rx_work_handler(struct work_struct *work)\n{\n\tstruct cx23885_dev *dev =\n\t\t\t     container_of(work, struct cx23885_dev, ir_rx_work);\n\tu32 events = 0;\n\tunsigned long *notifications = &dev->ir_rx_notifications;\n\n\tif (test_and_clear_bit(CX23885_IR_RX_SW_FIFO_OVERRUN, notifications))\n\t\tevents |= V4L2_SUBDEV_IR_RX_SW_FIFO_OVERRUN;\n\tif (test_and_clear_bit(CX23885_IR_RX_HW_FIFO_OVERRUN, notifications))\n\t\tevents |= V4L2_SUBDEV_IR_RX_HW_FIFO_OVERRUN;\n\tif (test_and_clear_bit(CX23885_IR_RX_END_OF_RX_DETECTED, notifications))\n\t\tevents |= V4L2_SUBDEV_IR_RX_END_OF_RX_DETECTED;\n\tif (test_and_clear_bit(CX23885_IR_RX_FIFO_SERVICE_REQ, notifications))\n\t\tevents |= V4L2_SUBDEV_IR_RX_FIFO_SERVICE_REQ;\n\n\tif (events == 0)\n\t\treturn;\n\n\tif (dev->kernel_ir)\n\t\tcx23885_input_rx_work_handler(dev, events);\n}\n\nvoid cx23885_ir_tx_work_handler(struct work_struct *work)\n{\n\tstruct cx23885_dev *dev =\n\t\t\t     container_of(work, struct cx23885_dev, ir_tx_work);\n\tu32 events = 0;\n\tunsigned long *notifications = &dev->ir_tx_notifications;\n\n\tif (test_and_clear_bit(CX23885_IR_TX_FIFO_SERVICE_REQ, notifications))\n\t\tevents |= V4L2_SUBDEV_IR_TX_FIFO_SERVICE_REQ;\n\n\tif (events == 0)\n\t\treturn;\n\n}\n\n \nvoid cx23885_ir_rx_v4l2_dev_notify(struct v4l2_subdev *sd, u32 events)\n{\n\tstruct cx23885_dev *dev = to_cx23885(sd->v4l2_dev);\n\tunsigned long *notifications = &dev->ir_rx_notifications;\n\n\tif (events & V4L2_SUBDEV_IR_RX_FIFO_SERVICE_REQ)\n\t\tset_bit(CX23885_IR_RX_FIFO_SERVICE_REQ, notifications);\n\tif (events & V4L2_SUBDEV_IR_RX_END_OF_RX_DETECTED)\n\t\tset_bit(CX23885_IR_RX_END_OF_RX_DETECTED, notifications);\n\tif (events & V4L2_SUBDEV_IR_RX_HW_FIFO_OVERRUN)\n\t\tset_bit(CX23885_IR_RX_HW_FIFO_OVERRUN, notifications);\n\tif (events & V4L2_SUBDEV_IR_RX_SW_FIFO_OVERRUN)\n\t\tset_bit(CX23885_IR_RX_SW_FIFO_OVERRUN, notifications);\n\n\t \n\tif (sd == dev->sd_cx25840)\n\t\tcx23885_ir_rx_work_handler(&dev->ir_rx_work);\n\telse\n\t\tschedule_work(&dev->ir_rx_work);\n}\n\n \nvoid cx23885_ir_tx_v4l2_dev_notify(struct v4l2_subdev *sd, u32 events)\n{\n\tstruct cx23885_dev *dev = to_cx23885(sd->v4l2_dev);\n\tunsigned long *notifications = &dev->ir_tx_notifications;\n\n\tif (events & V4L2_SUBDEV_IR_TX_FIFO_SERVICE_REQ)\n\t\tset_bit(CX23885_IR_TX_FIFO_SERVICE_REQ, notifications);\n\n\t \n\tif (sd == dev->sd_cx25840)\n\t\tcx23885_ir_tx_work_handler(&dev->ir_tx_work);\n\telse\n\t\tschedule_work(&dev->ir_tx_work);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}