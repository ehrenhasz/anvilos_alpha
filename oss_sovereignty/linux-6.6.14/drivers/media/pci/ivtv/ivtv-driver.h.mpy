{
  "module_name": "ivtv-driver.h",
  "hash_id": "98ccd2baa18f7f15c7178e01f1b51884a1f3af4cb8818aae077e61e842124072",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/ivtv/ivtv-driver.h",
  "human_readable_source": " \n\n#ifndef IVTV_DRIVER_H\n#define IVTV_DRIVER_H\n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/pci.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/i2c.h>\n#include <linux/i2c-algo-bit.h>\n#include <linux/list.h>\n#include <linux/unistd.h>\n#include <linux/pagemap.h>\n#include <linux/scatterlist.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/uaccess.h>\n#include <asm/byteorder.h>\n\n#include <media/v4l2-common.h>\n#include <media/v4l2-ioctl.h>\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-fh.h>\n#include <media/tuner.h>\n#include <media/drv-intf/cx2341x.h>\n#include <media/i2c/ir-kbd-i2c.h>\n\n#include <linux/ivtv.h>\n\n \n#define IVTV_ENCODER_OFFSET\t0x00000000\n#define IVTV_ENCODER_SIZE\t0x00800000\t \n#define IVTV_DECODER_OFFSET\t0x01000000\n#define IVTV_DECODER_SIZE\t0x00800000\t \n#define IVTV_REG_OFFSET\t\t0x02000000\n#define IVTV_REG_SIZE\t\t0x00010000\n\n \n#define IVTV_MAX_CARDS 32\n\n#define IVTV_ENC_STREAM_TYPE_MPG  0\n#define IVTV_ENC_STREAM_TYPE_YUV  1\n#define IVTV_ENC_STREAM_TYPE_VBI  2\n#define IVTV_ENC_STREAM_TYPE_PCM  3\n#define IVTV_ENC_STREAM_TYPE_RAD  4\n#define IVTV_DEC_STREAM_TYPE_MPG  5\n#define IVTV_DEC_STREAM_TYPE_VBI  6\n#define IVTV_DEC_STREAM_TYPE_VOUT 7\n#define IVTV_DEC_STREAM_TYPE_YUV  8\n#define IVTV_MAX_STREAMS\t  9\n\n#define IVTV_DMA_SG_OSD_ENT\t(2883584/PAGE_SIZE)\t \n\n \n#define IVTV_REG_DMAXFER\t(0x0000)\n#define IVTV_REG_DMASTATUS\t(0x0004)\n#define IVTV_REG_DECDMAADDR\t(0x0008)\n#define IVTV_REG_ENCDMAADDR\t(0x000c)\n#define IVTV_REG_DMACONTROL\t(0x0010)\n#define IVTV_REG_IRQSTATUS\t(0x0040)\n#define IVTV_REG_IRQMASK\t(0x0048)\n\n \n#define IVTV_REG_ENC_SDRAM_REFRESH\t(0x07F8)\n#define IVTV_REG_ENC_SDRAM_PRECHARGE\t(0x07FC)\n#define IVTV_REG_DEC_SDRAM_REFRESH\t(0x08F8)\n#define IVTV_REG_DEC_SDRAM_PRECHARGE\t(0x08FC)\n#define IVTV_REG_VDM\t\t\t(0x2800)\n#define IVTV_REG_AO\t\t\t(0x2D00)\n#define IVTV_REG_BYTEFLUSH\t\t(0x2D24)\n#define IVTV_REG_SPU\t\t\t(0x9050)\n#define IVTV_REG_HW_BLOCKS\t\t(0x9054)\n#define IVTV_REG_VPU\t\t\t(0x9058)\n#define IVTV_REG_APU\t\t\t(0xA064)\n\n \n#define IVTV_REG_DEC_LINE_FIELD\t\t(0x28C0)\n\n \nextern int ivtv_debug;\n#ifdef CONFIG_VIDEO_ADV_DEBUG\nextern int ivtv_fw_debug;\n#endif\n\n#define IVTV_DBGFLG_WARN    (1 << 0)\n#define IVTV_DBGFLG_INFO    (1 << 1)\n#define IVTV_DBGFLG_MB      (1 << 2)\n#define IVTV_DBGFLG_IOCTL   (1 << 3)\n#define IVTV_DBGFLG_FILE    (1 << 4)\n#define IVTV_DBGFLG_DMA     (1 << 5)\n#define IVTV_DBGFLG_IRQ     (1 << 6)\n#define IVTV_DBGFLG_DEC     (1 << 7)\n#define IVTV_DBGFLG_YUV     (1 << 8)\n#define IVTV_DBGFLG_I2C     (1 << 9)\n \n#define IVTV_DBGFLG_HIGHVOL (1 << 10)\n\n#define IVTV_DEBUG(x, type, fmt, args...) \\\n\tdo { \\\n\t\tif ((x) & ivtv_debug) \\\n\t\t\tv4l2_info(&itv->v4l2_dev, \" \" type \": \" fmt , ##args);\t\\\n\t} while (0)\n#define IVTV_DEBUG_WARN(fmt, args...)  IVTV_DEBUG(IVTV_DBGFLG_WARN,  \"warn\",  fmt , ## args)\n#define IVTV_DEBUG_INFO(fmt, args...)  IVTV_DEBUG(IVTV_DBGFLG_INFO,  \"info\",  fmt , ## args)\n#define IVTV_DEBUG_MB(fmt, args...)    IVTV_DEBUG(IVTV_DBGFLG_MB,    \"mb\",    fmt , ## args)\n#define IVTV_DEBUG_DMA(fmt, args...)   IVTV_DEBUG(IVTV_DBGFLG_DMA,   \"dma\",   fmt , ## args)\n#define IVTV_DEBUG_IOCTL(fmt, args...) IVTV_DEBUG(IVTV_DBGFLG_IOCTL, \"ioctl\", fmt , ## args)\n#define IVTV_DEBUG_FILE(fmt, args...)  IVTV_DEBUG(IVTV_DBGFLG_FILE,  \"file\",  fmt , ## args)\n#define IVTV_DEBUG_I2C(fmt, args...)   IVTV_DEBUG(IVTV_DBGFLG_I2C,   \"i2c\",   fmt , ## args)\n#define IVTV_DEBUG_IRQ(fmt, args...)   IVTV_DEBUG(IVTV_DBGFLG_IRQ,   \"irq\",   fmt , ## args)\n#define IVTV_DEBUG_DEC(fmt, args...)   IVTV_DEBUG(IVTV_DBGFLG_DEC,   \"dec\",   fmt , ## args)\n#define IVTV_DEBUG_YUV(fmt, args...)   IVTV_DEBUG(IVTV_DBGFLG_YUV,   \"yuv\",   fmt , ## args)\n\n#define IVTV_DEBUG_HIGH_VOL(x, type, fmt, args...) \\\n\tdo { \\\n\t\tif (((x) & ivtv_debug) && (ivtv_debug & IVTV_DBGFLG_HIGHVOL))\t\\\n\t\t\tv4l2_info(&itv->v4l2_dev, \" \" type \": \" fmt , ##args);\t\\\n\t} while (0)\n#define IVTV_DEBUG_HI_WARN(fmt, args...)  IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_WARN,  \"warn\",  fmt , ## args)\n#define IVTV_DEBUG_HI_INFO(fmt, args...)  IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_INFO,  \"info\",  fmt , ## args)\n#define IVTV_DEBUG_HI_MB(fmt, args...)    IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_MB,    \"mb\",    fmt , ## args)\n#define IVTV_DEBUG_HI_DMA(fmt, args...)   IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_DMA,   \"dma\",   fmt , ## args)\n#define IVTV_DEBUG_HI_IOCTL(fmt, args...) IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_IOCTL, \"ioctl\", fmt , ## args)\n#define IVTV_DEBUG_HI_FILE(fmt, args...)  IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_FILE,  \"file\",  fmt , ## args)\n#define IVTV_DEBUG_HI_I2C(fmt, args...)   IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_I2C,   \"i2c\",   fmt , ## args)\n#define IVTV_DEBUG_HI_IRQ(fmt, args...)   IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_IRQ,   \"irq\",   fmt , ## args)\n#define IVTV_DEBUG_HI_DEC(fmt, args...)   IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_DEC,   \"dec\",   fmt , ## args)\n#define IVTV_DEBUG_HI_YUV(fmt, args...)   IVTV_DEBUG_HIGH_VOL(IVTV_DBGFLG_YUV,   \"yuv\",   fmt , ## args)\n\n \n#define IVTV_ERR(fmt, args...)      v4l2_err(&itv->v4l2_dev, fmt , ## args)\n#define IVTV_WARN(fmt, args...)     v4l2_warn(&itv->v4l2_dev, fmt , ## args)\n#define IVTV_INFO(fmt, args...)     v4l2_info(&itv->v4l2_dev, fmt , ## args)\n\n \n#define OUT_NONE        0\n#define OUT_MPG         1\n#define OUT_YUV         2\n#define OUT_UDMA_YUV    3\n#define OUT_PASSTHROUGH 4\n\n#define IVTV_MAX_PGM_INDEX (400)\n\n \n#define IVTV_DEFAULT_I2C_CLOCK_PERIOD\t20\n\nstruct ivtv_options {\n\tint kilobytes[IVTV_MAX_STREAMS];         \n\tint cardtype;\t\t\t\t \n\tint tuner;\t\t\t\t \n\tint radio;\t\t\t\t \n\tint newi2c;\t\t\t\t \n\tint i2c_clock_period;\t\t\t \n};\n\n \nstruct ivtv_mailbox {\n\tu32 flags;\n\tu32 cmd;\n\tu32 retval;\n\tu32 timeout;\n\tu32 data[CX2341X_MBOX_MAX_DATA];\n};\n\nstruct ivtv_api_cache {\n\tunsigned long last_jiffies;\t\t \n\tu32 data[CX2341X_MBOX_MAX_DATA];\t \n};\n\nstruct ivtv_mailbox_data {\n\tvolatile struct ivtv_mailbox __iomem *mbox;\n\t \n\tunsigned long busy;\n\tu8 max_mbox;\n};\n\n \n#define IVTV_F_B_NEED_BUF_SWAP  (1 << 0)\t \n\n \n#define IVTV_F_S_DMA_PENDING\t0\t \n#define IVTV_F_S_DMA_HAS_VBI\t1        \n#define IVTV_F_S_NEEDS_DATA\t2\t \n\n#define IVTV_F_S_CLAIMED\t3\t \n#define IVTV_F_S_STREAMING      4\t \n#define IVTV_F_S_INTERNAL_USE\t5\t \n#define IVTV_F_S_PASSTHROUGH\t6\t \n#define IVTV_F_S_STREAMOFF\t7\t \n#define IVTV_F_S_APPL_IO        8\t \n\n#define IVTV_F_S_PIO_PENDING\t9\t \n#define IVTV_F_S_PIO_HAS_VBI\t1        \n\n \n#define IVTV_F_I_DMA\t\t   0\t \n#define IVTV_F_I_UDMA\t\t   1\t \n#define IVTV_F_I_UDMA_PENDING\t   2\t \n#define IVTV_F_I_SPEED_CHANGE\t   3\t \n#define IVTV_F_I_EOS\t\t   4\t \n#define IVTV_F_I_RADIO_USER\t   5\t \n#define IVTV_F_I_DIG_RST\t   6\t \n#define IVTV_F_I_DEC_YUV\t   7\t \n#define IVTV_F_I_UPDATE_CC\t   9\t \n#define IVTV_F_I_UPDATE_WSS\t   10\t \n#define IVTV_F_I_UPDATE_VPS\t   11\t \n#define IVTV_F_I_DECODING_YUV\t   12\t \n#define IVTV_F_I_ENC_PAUSED\t   13\t \n#define IVTV_F_I_VALID_DEC_TIMINGS 14\t \n#define IVTV_F_I_HAVE_WORK\t   15\t \n#define IVTV_F_I_WORK_HANDLER_VBI  16\t \n#define IVTV_F_I_WORK_HANDLER_YUV  17\t \n#define IVTV_F_I_WORK_HANDLER_PIO  18\t \n#define IVTV_F_I_PIO\t\t   19\t \n#define IVTV_F_I_DEC_PAUSED\t   20\t \n#define IVTV_F_I_INITED\t\t   21\t \n#define IVTV_F_I_FAILED\t\t   22\t \n#define IVTV_F_I_WORK_HANDLER_PCM  23\t \n\n \n#define IVTV_F_I_EV_DEC_STOPPED\t   28\t \n#define IVTV_F_I_EV_VSYNC\t   29\t \n#define IVTV_F_I_EV_VSYNC_FIELD    30\t \n#define IVTV_F_I_EV_VSYNC_ENABLED  31\t \n\n \nstruct ivtv_sg_element {\n\t__le32 src;\n\t__le32 dst;\n\t__le32 size;\n};\n\nstruct ivtv_sg_host_element {\n\tu32 src;\n\tu32 dst;\n\tu32 size;\n};\n\nstruct ivtv_user_dma {\n\tstruct mutex lock;\n\tint page_count;\n\tstruct page *map[IVTV_DMA_SG_OSD_ENT];\n\t \n\tstruct page *bouncemap[IVTV_DMA_SG_OSD_ENT];\n\n\t \n\tstruct ivtv_sg_element SGarray[IVTV_DMA_SG_OSD_ENT];\n\tdma_addr_t SG_handle;\n\tint SG_length;\n\n\t \n\tstruct scatterlist SGlist[IVTV_DMA_SG_OSD_ENT];\n};\n\nstruct ivtv_dma_page_info {\n\tunsigned long uaddr;\n\tunsigned long first;\n\tunsigned long last;\n\tunsigned int offset;\n\tunsigned int tail;\n\tint page_count;\n};\n\nstruct ivtv_buffer {\n\tstruct list_head list;\n\tdma_addr_t dma_handle;\n\tunsigned short b_flags;\n\tunsigned short dma_xfer_cnt;\n\tchar *buf;\n\tu32 bytesused;\n\tu32 readpos;\n};\n\nstruct ivtv_queue {\n\tstruct list_head list;           \n\tu32 buffers;                     \n\tu32 length;                      \n\tu32 bytesused;                   \n};\n\nstruct ivtv;\t\t\t\t \n\nstruct ivtv_stream {\n\t \n\tstruct video_device vdev;\t \n\tstruct ivtv *itv;\t\t \n\tconst char *name;\t\t \n\tint type;\t\t\t \n\n\tstruct v4l2_fh *fh;\t\t \n\tspinlock_t qlock;\t\t \n\tunsigned long s_flags;\t\t \n\tint dma;\t\t\t \n\tu32 pending_offset;\n\tu32 pending_backup;\n\tu64 pending_pts;\n\n\tu32 dma_offset;\n\tu32 dma_backup;\n\tu64 dma_pts;\n\n\tint subtype;\n\twait_queue_head_t waitq;\n\tu32 dma_last_offset;\n\n\t \n\tu32 buffers;\n\tu32 buf_size;\n\tu32 buffers_stolen;\n\n\t \n\tstruct ivtv_queue q_free;\t \n\tstruct ivtv_queue q_full;\t \n\tstruct ivtv_queue q_io;\t\t \n\tstruct ivtv_queue q_dma;\t \n\tstruct ivtv_queue q_predma;\t \n\n\t \n\tu16 dma_xfer_cnt;\n\n\t \n\tstruct ivtv_sg_host_element *sg_pending;\n\tstruct ivtv_sg_host_element *sg_processing;\n\tstruct ivtv_sg_element *sg_dma;\n\tdma_addr_t sg_handle;\n\tint sg_pending_size;\n\tint sg_processing_size;\n\tint sg_processed;\n\n\t \n\tstruct scatterlist *SGlist;\n};\n\nstruct ivtv_open_id {\n\tstruct v4l2_fh fh;\n\tint type;                        \n\tint yuv_frames;                  \n\tstruct ivtv *itv;\n};\n\nstatic inline struct ivtv_open_id *fh2id(struct v4l2_fh *fh)\n{\n\treturn container_of(fh, struct ivtv_open_id, fh);\n}\n\nstruct yuv_frame_info\n{\n\tu32 update;\n\ts32 src_x;\n\ts32 src_y;\n\tu32 src_w;\n\tu32 src_h;\n\ts32 dst_x;\n\ts32 dst_y;\n\tu32 dst_w;\n\tu32 dst_h;\n\ts32 pan_x;\n\ts32 pan_y;\n\tu32 vis_w;\n\tu32 vis_h;\n\tu32 interlaced_y;\n\tu32 interlaced_uv;\n\ts32 tru_x;\n\tu32 tru_w;\n\tu32 tru_h;\n\tu32 offset_y;\n\ts32 lace_mode;\n\tu32 sync_field;\n\tu32 delay;\n\tu32 interlaced;\n};\n\n#define IVTV_YUV_MODE_INTERLACED\t0x00\n#define IVTV_YUV_MODE_PROGRESSIVE\t0x01\n#define IVTV_YUV_MODE_AUTO\t\t0x02\n#define IVTV_YUV_MODE_MASK\t\t0x03\n\n#define IVTV_YUV_SYNC_EVEN\t\t0x00\n#define IVTV_YUV_SYNC_ODD\t\t0x04\n#define IVTV_YUV_SYNC_MASK\t\t0x04\n\n#define IVTV_YUV_BUFFERS 8\n\nstruct yuv_playback_info\n{\n\tu32 reg_2834;\n\tu32 reg_2838;\n\tu32 reg_283c;\n\tu32 reg_2840;\n\tu32 reg_2844;\n\tu32 reg_2848;\n\tu32 reg_2854;\n\tu32 reg_285c;\n\tu32 reg_2864;\n\n\tu32 reg_2870;\n\tu32 reg_2874;\n\tu32 reg_2890;\n\tu32 reg_2898;\n\tu32 reg_289c;\n\n\tu32 reg_2918;\n\tu32 reg_291c;\n\tu32 reg_2920;\n\tu32 reg_2924;\n\tu32 reg_2928;\n\tu32 reg_292c;\n\tu32 reg_2930;\n\n\tu32 reg_2934;\n\n\tu32 reg_2938;\n\tu32 reg_293c;\n\tu32 reg_2940;\n\tu32 reg_2944;\n\tu32 reg_2948;\n\tu32 reg_294c;\n\tu32 reg_2950;\n\tu32 reg_2954;\n\tu32 reg_2958;\n\tu32 reg_295c;\n\tu32 reg_2960;\n\tu32 reg_2964;\n\tu32 reg_2968;\n\tu32 reg_296c;\n\n\tu32 reg_2970;\n\n\tint v_filter_1;\n\tint v_filter_2;\n\tint h_filter;\n\n\tu8 track_osd;  \n\n\tu32 osd_x_offset;\n\tu32 osd_y_offset;\n\n\tu32 osd_x_pan;\n\tu32 osd_y_pan;\n\n\tu32 osd_vis_w;\n\tu32 osd_vis_h;\n\n\tu32 osd_full_w;\n\tu32 osd_full_h;\n\n\tint decode_height;\n\n\tint lace_mode;\n\tint lace_threshold;\n\tint lace_sync_field;\n\n\tatomic_t next_dma_frame;\n\tatomic_t next_fill_frame;\n\n\tu32 yuv_forced_update;\n\tint update_frame;\n\n\tu8 fields_lapsed;    \n\n\tstruct yuv_frame_info new_frame_info[IVTV_YUV_BUFFERS];\n\tstruct yuv_frame_info old_frame_info;\n\tstruct yuv_frame_info old_frame_info_args;\n\n\tvoid *blanking_ptr;\n\tdma_addr_t blanking_dmaptr;\n\n\tint stream_size;\n\n\tu8 draw_frame;  \n\tu8 max_frames_buffered;  \n\n\tstruct v4l2_rect main_rect;\n\tu32 v4l2_src_w;\n\tu32 v4l2_src_h;\n\n\tu8 running;  \n};\n\n#define IVTV_VBI_FRAMES 32\n\n \nstruct vbi_cc {\n\tu8 odd[2];\t \n\tu8 even[2];\t ;\n};\n\nstruct vbi_vps {\n\tu8 data[5];\t \n};\n\nstruct vbi_info {\n\t \n\n\tu32 raw_decoder_line_size;               \n\tu8 raw_decoder_sav_odd_field;            \n\tu8 raw_decoder_sav_even_field;           \n\tu32 sliced_decoder_line_size;            \n\tu8 sliced_decoder_sav_odd_field;         \n\tu8 sliced_decoder_sav_even_field;        \n\n\tu32 start[2];\t\t\t\t \n\tu32 count;\t\t\t\t \n\tu32 raw_size;\t\t\t\t \n\tu32 sliced_size;\t\t\t \n\n\tu32 dec_start;\t\t\t\t \n\tu32 enc_start;\t\t\t\t \n\tu32 enc_size;\t\t\t\t \n\tint fpi;\t\t\t\t \n\n\tstruct v4l2_format in;\t\t\t \n\tstruct v4l2_sliced_vbi_format *sliced_in;  \n\tint insert_mpeg;\t\t\t \n\n\t \n\n\tu32 frame;\t\t\t\t \n\n\t \n\n\tstruct vbi_cc cc_payload[256];\t\t \n\tint cc_payload_idx;\t\t\t \n\tu8 cc_missing_cnt;\t\t\t \n\tint wss_payload;\t\t\t \n\tu8 wss_missing_cnt;\t\t\t \n\tstruct vbi_vps vps_payload;\t\t \n\n\t \n\n\tstruct v4l2_sliced_vbi_data sliced_data[36];\t \n\tstruct v4l2_sliced_vbi_data sliced_dec_data[36]; \n\n\t \n\n\t \n\tu8 *sliced_mpeg_data[IVTV_VBI_FRAMES];\n\tu32 sliced_mpeg_size[IVTV_VBI_FRAMES];\n\tstruct ivtv_buffer sliced_mpeg_buf;\t \n\tu32 inserted_frame;\t\t\t \n};\n\n \nstruct ivtv_card;\n\n \nstruct ivtv {\n\t \n\tstruct pci_dev *pdev;\t\t \n\tconst struct ivtv_card *card;\t \n\tconst char *card_name;           \n\tconst struct ivtv_card_tuner_i2c *card_i2c;  \n\tu8 has_cx23415;\t\t\t \n\tu8 pvr150_workaround;            \n\tu8 nof_inputs;\t\t\t \n\tu8 nof_audio_inputs;\t\t \n\tu32 v4l2_cap;\t\t\t \n\tu32 hw_flags;\t\t\t \n\tv4l2_std_id tuner_std;\t\t \n\tstruct v4l2_subdev *sd_video;\t \n\tstruct v4l2_subdev *sd_audio;\t \n\tstruct v4l2_subdev *sd_muxer;\t \n\tresource_size_t base_addr;       \n\tvolatile void __iomem *enc_mem;  \n\tvolatile void __iomem *dec_mem;  \n\tvolatile void __iomem *reg_mem;  \n\tstruct ivtv_options options;\t \n\n\tstruct v4l2_device v4l2_dev;\n\tstruct cx2341x_handler cxhdl;\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl *ctrl_pts;\n\t\tstruct v4l2_ctrl *ctrl_frame;\n\t};\n\tstruct {\n\t\t \n\t\tstruct v4l2_ctrl *ctrl_audio_playback;\n\t\tstruct v4l2_ctrl *ctrl_audio_multilingual_playback;\n\t};\n\tstruct v4l2_ctrl_handler hdl_gpio;\n\tstruct v4l2_subdev sd_gpio;\t \n\tu16 instance;\n\n\t \n\tunsigned long i_flags;           \n\tu8 is_50hz;                      \n\tu8 is_60hz                       ;\n\tu8 is_out_50hz                   ;\n\tu8 is_out_60hz                   ;\n\tint output_mode;                 \n\tu32 audio_input;                 \n\tu32 active_input;                \n\tu32 active_output;               \n\tv4l2_std_id std;                 \n\tv4l2_std_id std_out;             \n\tu8 audio_stereo_mode;            \n\tu8 audio_bilingual_mode;         \n\n\t \n\tspinlock_t lock;                 \n\tstruct mutex serialize_lock;     \n\n\t \n\tint stream_buf_size[IVTV_MAX_STREAMS];           \n\tstruct ivtv_stream streams[IVTV_MAX_STREAMS];\t \n\tatomic_t capturing;\t\t \n\tatomic_t decoding;\t\t \n\n\t \n\tstruct snd_ivtv_card *alsa;\n\tvoid (*pcm_announce_callback)(struct snd_ivtv_card *card, u8 *pcm_data,\n\t\t\t\t      size_t num_bytes);\n\n\t \n\tstruct work_struct request_module_wk;\n\n\t \n\tu32 irqmask;                     \n\tu32 irq_rr_idx;                  \n\tstruct kthread_worker irq_worker;\t\t \n\tstruct task_struct *irq_worker_task;\t\t \n\tstruct kthread_work irq_work;\t \n\tspinlock_t dma_reg_lock;         \n\tint cur_dma_stream;\t\t \n\tint cur_pio_stream;\t\t \n\tu32 dma_data_req_offset;         \n\tu32 dma_data_req_size;           \n\tint dma_retries;                 \n\tstruct ivtv_user_dma udma;       \n\tstruct timer_list dma_timer;     \n\tu32 last_vsync_field;            \n\twait_queue_head_t dma_waitq;     \n\twait_queue_head_t eos_waitq;     \n\twait_queue_head_t event_waitq;   \n\twait_queue_head_t vsync_waitq;   \n\n\n\t \n\tstruct ivtv_mailbox_data enc_mbox;               \n\tstruct ivtv_mailbox_data dec_mbox;               \n\tstruct ivtv_api_cache api_cache[256];\t\t \n\n\n\t \n\tstruct i2c_adapter i2c_adap;\n\tstruct i2c_algo_bit_data i2c_algo;\n\tstruct i2c_client i2c_client;\n\tint i2c_state;                   \n\tstruct mutex i2c_bus_lock;       \n\n\tstruct IR_i2c_init_data ir_i2c_init_data;\n\n\t \n\tu32 pgm_info_offset;             \n\tu32 pgm_info_num;                \n\tu32 pgm_info_write_idx;          \n\tu32 pgm_info_read_idx;           \n\tstruct v4l2_enc_idx_entry pgm_info[IVTV_MAX_PGM_INDEX];  \n\n\n\t \n\tu32 open_id;\t\t\t \n\tint search_pack_header;          \n\tint speed;                       \n\tu8 speed_mute_audio;             \n\tu64 mpg_data_received;           \n\tu64 vbi_data_inserted;           \n\tu32 last_dec_timing[3];          \n\tunsigned long dualwatch_jiffies; \n\tu32 dualwatch_stereo_mode;       \n\n\n\t \n\tstruct vbi_info vbi;             \n\n\n\t \n\tstruct yuv_playback_info yuv_info;               \n\n\n\t \n\tunsigned long osd_video_pbase;\n\tint osd_global_alpha_state;      \n\tint osd_local_alpha_state;       \n\tint osd_chroma_key_state;        \n\tu8  osd_global_alpha;            \n\tu32 osd_chroma_key;              \n\tstruct v4l2_rect osd_rect;       \n\tstruct v4l2_rect main_rect;      \n\tstruct osd_info *osd_info;       \n\tvoid (*ivtvfb_restore)(struct ivtv *itv);  \n};\n\nstatic inline struct ivtv *to_ivtv(struct v4l2_device *v4l2_dev)\n{\n\treturn container_of(v4l2_dev, struct ivtv, v4l2_dev);\n}\n\n \nextern int (*ivtv_ext_init)(struct ivtv *);\n\n \nextern int ivtv_first_minor;\n\n \n\n \nvoid ivtv_set_irq_mask(struct ivtv *itv, u32 mask);\nvoid ivtv_clear_irq_mask(struct ivtv *itv, u32 mask);\n\n \nint ivtv_set_output_mode(struct ivtv *itv, int mode);\n\n \nstruct ivtv_stream *ivtv_get_output_stream(struct ivtv *itv);\n\n \nint ivtv_msleep_timeout(unsigned int msecs, int intr);\n\n \nint ivtv_waitq(wait_queue_head_t *waitq);\n\n \nstruct tveeprom;  \nvoid ivtv_read_eeprom(struct ivtv *itv, struct tveeprom *tv);\n\n \nint ivtv_init_on_first_open(struct ivtv *itv);\n\n \nstatic inline int ivtv_raw_vbi(const struct ivtv *itv)\n{\n\treturn itv->vbi.in.type == V4L2_BUF_TYPE_VBI_CAPTURE;\n}\n\n \n#define write_sync(val, reg) \\\n\tdo { writel(val, reg); readl(reg); } while (0)\n\n#define read_reg(reg) readl(itv->reg_mem + (reg))\n#define write_reg(val, reg) writel(val, itv->reg_mem + (reg))\n#define write_reg_sync(val, reg) \\\n\tdo { write_reg(val, reg); read_reg(reg); } while (0)\n\n#define read_enc(addr) readl(itv->enc_mem + (u32)(addr))\n#define write_enc(val, addr) writel(val, itv->enc_mem + (u32)(addr))\n#define write_enc_sync(val, addr) \\\n\tdo { write_enc(val, addr); read_enc(addr); } while (0)\n\n#define read_dec(addr) readl(itv->dec_mem + (u32)(addr))\n#define write_dec(val, addr) writel(val, itv->dec_mem + (u32)(addr))\n#define write_dec_sync(val, addr) \\\n\tdo { write_dec(val, addr); read_dec(addr); } while (0)\n\n \n#define ivtv_call_hw(itv, hw, o, f, args...)\t\t\t\t\\\n\tv4l2_device_mask_call_all(&(itv)->v4l2_dev, hw, o, f, ##args)\n\n#define ivtv_call_all(itv, o, f, args...) ivtv_call_hw(itv, 0, o, f , ##args)\n\n \n#define ivtv_call_hw_err(itv, hw, o, f, args...)\t\t\t\\\n\tv4l2_device_mask_call_until_err(&(itv)->v4l2_dev, hw, o, f, ##args)\n\n#define ivtv_call_all_err(itv, o, f, args...) ivtv_call_hw_err(itv, 0, o, f , ##args)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}