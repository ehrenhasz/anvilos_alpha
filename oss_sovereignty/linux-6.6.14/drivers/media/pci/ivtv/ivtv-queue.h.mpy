{
  "module_name": "ivtv-queue.h",
  "hash_id": "01f31d697b57853f426d5e8e60c6d126f830cb2945d234a2b7b7ef98187dc445",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/ivtv/ivtv-queue.h",
  "human_readable_source": " \n \n\n#ifndef IVTV_QUEUE_H\n#define IVTV_QUEUE_H\n\n#define IVTV_DMA_UNMAPPED\t((u32) -1)\n#define SLICED_VBI_PIO 0\n\n \n\nstatic inline int ivtv_might_use_pio(struct ivtv_stream *s)\n{\n\treturn s->dma == DMA_NONE || (SLICED_VBI_PIO && s->type == IVTV_ENC_STREAM_TYPE_VBI);\n}\n\nstatic inline int ivtv_use_pio(struct ivtv_stream *s)\n{\n\tstruct ivtv *itv = s->itv;\n\n\treturn s->dma == DMA_NONE ||\n\t    (SLICED_VBI_PIO && s->type == IVTV_ENC_STREAM_TYPE_VBI && itv->vbi.sliced_in->service_set);\n}\n\nstatic inline int ivtv_might_use_dma(struct ivtv_stream *s)\n{\n\treturn s->dma != DMA_NONE;\n}\n\nstatic inline int ivtv_use_dma(struct ivtv_stream *s)\n{\n\treturn !ivtv_use_pio(s);\n}\n\nstatic inline void ivtv_buf_sync_for_cpu(struct ivtv_stream *s, struct ivtv_buffer *buf)\n{\n\tif (ivtv_use_dma(s))\n\t\tdma_sync_single_for_cpu(&s->itv->pdev->dev, buf->dma_handle,\n\t\t\t\t\ts->buf_size + 256, s->dma);\n}\n\nstatic inline void ivtv_buf_sync_for_device(struct ivtv_stream *s, struct ivtv_buffer *buf)\n{\n\tif (ivtv_use_dma(s))\n\t\tdma_sync_single_for_device(&s->itv->pdev->dev,\n\t\t\t\t\t   buf->dma_handle, s->buf_size + 256,\n\t\t\t\t\t   s->dma);\n}\n\nint ivtv_buf_copy_from_user(struct ivtv_stream *s, struct ivtv_buffer *buf, const char __user *src, int copybytes);\nvoid ivtv_buf_swap(struct ivtv_buffer *buf);\n\n \nvoid ivtv_queue_init(struct ivtv_queue *q);\nvoid ivtv_enqueue(struct ivtv_stream *s, struct ivtv_buffer *buf, struct ivtv_queue *q);\nstruct ivtv_buffer *ivtv_dequeue(struct ivtv_stream *s, struct ivtv_queue *q);\nint ivtv_queue_move(struct ivtv_stream *s, struct ivtv_queue *from, struct ivtv_queue *steal,\n\t\t    struct ivtv_queue *to, int needed_bytes);\nvoid ivtv_flush_queues(struct ivtv_stream *s);\n\n \nint ivtv_stream_alloc(struct ivtv_stream *s);\nvoid ivtv_stream_free(struct ivtv_stream *s);\n\nstatic inline void ivtv_stream_sync_for_cpu(struct ivtv_stream *s)\n{\n\tif (ivtv_use_dma(s))\n\t\tdma_sync_single_for_cpu(&s->itv->pdev->dev, s->sg_handle,\n\t\t\t\t\tsizeof(struct ivtv_sg_element),\n\t\t\t\t\tDMA_TO_DEVICE);\n}\n\nstatic inline void ivtv_stream_sync_for_device(struct ivtv_stream *s)\n{\n\tif (ivtv_use_dma(s))\n\t\tdma_sync_single_for_device(&s->itv->pdev->dev, s->sg_handle,\n\t\t\t\t\t   sizeof(struct ivtv_sg_element),\n\t\t\t\t\t   DMA_TO_DEVICE);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}