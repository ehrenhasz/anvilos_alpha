{
  "module_name": "saa7134-dvb.c",
  "hash_id": "fd7b28312a50a19e7c081ff7e415edd0f88e0c08cc4cbf21725ce627c48961a3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/saa7134/saa7134-dvb.c",
  "human_readable_source": "\n \n\n#include \"saa7134.h\"\n#include \"saa7134-reg.h\"\n\n#include <linux/init.h>\n#include <linux/list.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/suspend.h>\n\n#include <media/v4l2-common.h>\n#include \"dvb-pll.h\"\n#include <media/dvb_frontend.h>\n\n#include \"mt352.h\"\n#include \"mt352_priv.h\"  \n#include \"tda1004x.h\"\n#include \"nxt200x.h\"\n#include \"xc2028.h\"\n#include \"xc5000.h\"\n\n#include \"tda10086.h\"\n#include \"tda826x.h\"\n#include \"tda827x.h\"\n#include \"isl6421.h\"\n#include \"isl6405.h\"\n#include \"lnbp21.h\"\n#include \"tuner-simple.h\"\n#include \"tda10048.h\"\n#include \"tda18271.h\"\n#include \"lgdt3305.h\"\n#include \"tda8290.h\"\n#include \"mb86a20s.h\"\n#include \"lgs8gxx.h\"\n\n#include \"zl10353.h\"\n#include \"qt1010.h\"\n\n#include \"zl10036.h\"\n#include \"zl10039.h\"\n#include \"mt312.h\"\n#include \"s5h1411.h\"\n\nMODULE_AUTHOR(\"Gerd Knorr <kraxel@bytesex.org> [SuSE Labs]\");\nMODULE_LICENSE(\"GPL\");\n\nstatic unsigned int antenna_pwr;\n\nmodule_param(antenna_pwr, int, 0444);\nMODULE_PARM_DESC(antenna_pwr,\"enable antenna power (Pinnacle 300i)\");\n\nstatic int use_frontend;\nmodule_param(use_frontend, int, 0644);\nMODULE_PARM_DESC(use_frontend,\"for cards with multiple frontends (0: terrestrial, 1: satellite)\");\n\nDVB_DEFINE_MOD_OPT_ADAPTER_NR(adapter_nr);\n\n \n\nstatic int pinnacle_antenna_pwr(struct saa7134_dev *dev, int on)\n{\n\tu32 ok;\n\n\tif (!on) {\n\t\tsaa_setl(SAA7134_GPIO_GPMODE0 >> 2,     (1 << 26));\n\t\tsaa_clearl(SAA7134_GPIO_GPSTATUS0 >> 2, (1 << 26));\n\t\treturn 0;\n\t}\n\n\tsaa_setl(SAA7134_GPIO_GPMODE0 >> 2,     (1 << 26));\n\tsaa_setl(SAA7134_GPIO_GPSTATUS0 >> 2,   (1 << 26));\n\tudelay(10);\n\n\tsaa_setl(SAA7134_GPIO_GPMODE0 >> 2,     (1 << 28));\n\tsaa_clearl(SAA7134_GPIO_GPSTATUS0 >> 2, (1 << 28));\n\tudelay(10);\n\tsaa_setl(SAA7134_GPIO_GPSTATUS0 >> 2,   (1 << 28));\n\tudelay(10);\n\tok = saa_readl(SAA7134_GPIO_GPSTATUS0) & (1 << 27);\n\tpr_debug(\"%s %s\\n\", __func__, ok ? \"on\" : \"off\");\n\n\tif (!ok)\n\t\tsaa_clearl(SAA7134_GPIO_GPSTATUS0 >> 2,   (1 << 26));\n\treturn ok;\n}\n\nstatic int mt352_pinnacle_init(struct dvb_frontend* fe)\n{\n\tstatic u8 clock_config []  = { CLOCK_CTL,  0x3d, 0x28 };\n\tstatic u8 reset []         = { RESET,      0x80 };\n\tstatic u8 adc_ctl_1_cfg [] = { ADC_CTL_1,  0x40 };\n\tstatic u8 agc_cfg []       = { AGC_TARGET, 0x28, 0xa0 };\n\tstatic u8 capt_range_cfg[] = { CAPT_RANGE, 0x31 };\n\tstatic u8 fsm_ctl_cfg[]    = { 0x7b,       0x04 };\n\tstatic u8 gpp_ctl_cfg []   = { GPP_CTL,    0x0f };\n\tstatic u8 scan_ctl_cfg []  = { SCAN_CTL,   0x0d };\n\tstatic u8 irq_cfg []       = { INTERRUPT_EN_0, 0x00, 0x00, 0x00, 0x00 };\n\n\tpr_debug(\"%s called\\n\", __func__);\n\n\tmt352_write(fe, clock_config,   sizeof(clock_config));\n\tudelay(200);\n\tmt352_write(fe, reset,          sizeof(reset));\n\tmt352_write(fe, adc_ctl_1_cfg,  sizeof(adc_ctl_1_cfg));\n\tmt352_write(fe, agc_cfg,        sizeof(agc_cfg));\n\tmt352_write(fe, capt_range_cfg, sizeof(capt_range_cfg));\n\tmt352_write(fe, gpp_ctl_cfg,    sizeof(gpp_ctl_cfg));\n\n\tmt352_write(fe, fsm_ctl_cfg,    sizeof(fsm_ctl_cfg));\n\tmt352_write(fe, scan_ctl_cfg,   sizeof(scan_ctl_cfg));\n\tmt352_write(fe, irq_cfg,        sizeof(irq_cfg));\n\n\treturn 0;\n}\n\nstatic int mt352_aver777_init(struct dvb_frontend* fe)\n{\n\tstatic u8 clock_config []  = { CLOCK_CTL,  0x38, 0x2d };\n\tstatic u8 reset []         = { RESET,      0x80 };\n\tstatic u8 adc_ctl_1_cfg [] = { ADC_CTL_1,  0x40 };\n\tstatic u8 agc_cfg []       = { AGC_TARGET, 0x28, 0xa0 };\n\tstatic u8 capt_range_cfg[] = { CAPT_RANGE, 0x33 };\n\n\tmt352_write(fe, clock_config,   sizeof(clock_config));\n\tudelay(200);\n\tmt352_write(fe, reset,          sizeof(reset));\n\tmt352_write(fe, adc_ctl_1_cfg,  sizeof(adc_ctl_1_cfg));\n\tmt352_write(fe, agc_cfg,        sizeof(agc_cfg));\n\tmt352_write(fe, capt_range_cfg, sizeof(capt_range_cfg));\n\n\treturn 0;\n}\n\nstatic int mt352_avermedia_xc3028_init(struct dvb_frontend *fe)\n{\n\tstatic u8 clock_config []  = { CLOCK_CTL, 0x38, 0x2d };\n\tstatic u8 reset []         = { RESET, 0x80 };\n\tstatic u8 adc_ctl_1_cfg [] = { ADC_CTL_1, 0x40 };\n\tstatic u8 agc_cfg []       = { AGC_TARGET, 0xe };\n\tstatic u8 capt_range_cfg[] = { CAPT_RANGE, 0x33 };\n\n\tmt352_write(fe, clock_config,   sizeof(clock_config));\n\tudelay(200);\n\tmt352_write(fe, reset,          sizeof(reset));\n\tmt352_write(fe, adc_ctl_1_cfg,  sizeof(adc_ctl_1_cfg));\n\tmt352_write(fe, agc_cfg,        sizeof(agc_cfg));\n\tmt352_write(fe, capt_range_cfg, sizeof(capt_range_cfg));\n\treturn 0;\n}\n\nstatic int mt352_pinnacle_tuner_set_params(struct dvb_frontend *fe)\n{\n\tstruct dtv_frontend_properties *c = &fe->dtv_property_cache;\n\tu8 off[] = { 0x00, 0xf1};\n\tu8 on[]  = { 0x00, 0x71};\n\tstruct i2c_msg msg = {.addr=0x43, .flags=0, .buf=off, .len = sizeof(off)};\n\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct v4l2_frequency f;\n\n\t \n\tf.tuner     = 0;\n\tf.type      = V4L2_TUNER_DIGITAL_TV;\n\tf.frequency = c->frequency / 1000 * 16 / 1000;\n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\ti2c_transfer(&dev->i2c_adap, &msg, 1);\n\tsaa_call_all(dev, tuner, s_frequency, &f);\n\tmsg.buf = on;\n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\ti2c_transfer(&dev->i2c_adap, &msg, 1);\n\n\tpinnacle_antenna_pwr(dev, antenna_pwr);\n\n\t \n\treturn mt352_pinnacle_init(fe);\n}\n\nstatic struct mt352_config pinnacle_300i = {\n\t.demod_address = 0x3c >> 1,\n\t.adc_clock     = 20333,\n\t.if2           = 36150,\n\t.no_tuner      = 1,\n\t.demod_init    = mt352_pinnacle_init,\n};\n\nstatic struct mt352_config avermedia_777 = {\n\t.demod_address = 0xf,\n\t.demod_init    = mt352_aver777_init,\n};\n\nstatic struct mt352_config avermedia_xc3028_mt352_dev = {\n\t.demod_address   = (0x1e >> 1),\n\t.no_tuner        = 1,\n\t.demod_init      = mt352_avermedia_xc3028_init,\n};\n\nstatic struct tda18271_std_map mb86a20s_tda18271_std_map = {\n\t.dvbt_6   = { .if_freq = 3300, .agc_mode = 3, .std = 4,\n\t\t      .if_lvl = 7, .rfagc_top = 0x37, },\n};\n\nstatic struct tda18271_config kworld_tda18271_config = {\n\t.std_map = &mb86a20s_tda18271_std_map,\n\t.gate    = TDA18271_GATE_DIGITAL,\n\t.config  = 3,\t \n\n};\n\nstatic const struct mb86a20s_config kworld_mb86a20s_config = {\n\t.demod_address = 0x10,\n};\n\nstatic int kworld_sbtvd_gate_ctrl(struct dvb_frontend* fe, int enable)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\n\tunsigned char initmsg[] = {0x45, 0x97};\n\tunsigned char msg_enable[] = {0x45, 0xc1};\n\tunsigned char msg_disable[] = {0x45, 0x81};\n\tstruct i2c_msg msg = {.addr = 0x4b, .flags = 0, .buf = initmsg, .len = 2};\n\n\tif (i2c_transfer(&dev->i2c_adap, &msg, 1) != 1) {\n\t\tpr_warn(\"could not access the I2C gate\\n\");\n\t\treturn -EIO;\n\t}\n\tif (enable)\n\t\tmsg.buf = msg_enable;\n\telse\n\t\tmsg.buf = msg_disable;\n\tif (i2c_transfer(&dev->i2c_adap, &msg, 1) != 1) {\n\t\tpr_warn(\"could not access the I2C gate\\n\");\n\t\treturn -EIO;\n\t}\n\tmsleep(20);\n\treturn 0;\n}\n\n \n\nstatic int philips_tda1004x_request_firmware(struct dvb_frontend *fe,\n\t\t\t\t\t   const struct firmware **fw, char *name)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\treturn request_firmware(fw, name, &dev->pci->dev);\n}\n\n \n\nstatic int philips_tda6651_pll_set(struct dvb_frontend *fe)\n{\n\tstruct dtv_frontend_properties *c = &fe->dtv_property_cache;\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\tu8 addr = state->config->tuner_address;\n\tu8 tuner_buf[4];\n\tstruct i2c_msg tuner_msg = {.addr = addr,.flags = 0,.buf = tuner_buf,.len =\n\t\t\tsizeof(tuner_buf) };\n\tint tuner_frequency = 0;\n\tu8 band, cp, filter;\n\n\t \n\ttuner_frequency = c->frequency + 36166000;\n\tif (tuner_frequency < 87000000)\n\t\treturn -EINVAL;\n\telse if (tuner_frequency < 130000000)\n\t\tcp = 3;\n\telse if (tuner_frequency < 160000000)\n\t\tcp = 5;\n\telse if (tuner_frequency < 200000000)\n\t\tcp = 6;\n\telse if (tuner_frequency < 290000000)\n\t\tcp = 3;\n\telse if (tuner_frequency < 420000000)\n\t\tcp = 5;\n\telse if (tuner_frequency < 480000000)\n\t\tcp = 6;\n\telse if (tuner_frequency < 620000000)\n\t\tcp = 3;\n\telse if (tuner_frequency < 830000000)\n\t\tcp = 5;\n\telse if (tuner_frequency < 895000000)\n\t\tcp = 7;\n\telse\n\t\treturn -EINVAL;\n\n\t \n\tif (c->frequency < 49000000)\n\t\treturn -EINVAL;\n\telse if (c->frequency < 161000000)\n\t\tband = 1;\n\telse if (c->frequency < 444000000)\n\t\tband = 2;\n\telse if (c->frequency < 861000000)\n\t\tband = 4;\n\telse\n\t\treturn -EINVAL;\n\n\t \n\tswitch (c->bandwidth_hz) {\n\tcase 6000000:\n\t\tfilter = 0;\n\t\tbreak;\n\n\tcase 7000000:\n\t\tfilter = 0;\n\t\tbreak;\n\n\tcase 8000000:\n\t\tfilter = 1;\n\t\tbreak;\n\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\t \n\ttuner_frequency = (((c->frequency / 1000) * 6) + 217496) / 1000;\n\n\t \n\ttuner_buf[0] = (tuner_frequency >> 8) & 0x7f;\n\ttuner_buf[1] = tuner_frequency & 0xff;\n\ttuner_buf[2] = 0xca;\n\ttuner_buf[3] = (cp << 5) | (filter << 3) | band;\n\n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\tif (i2c_transfer(&dev->i2c_adap, &tuner_msg, 1) != 1) {\n\t\tpr_warn(\"could not write to tuner at addr: 0x%02x\\n\",\n\t\t\taddr << 1);\n\t\treturn -EIO;\n\t}\n\tmsleep(1);\n\treturn 0;\n}\n\nstatic int philips_tu1216_init(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\tu8 addr = state->config->tuner_address;\n\tstatic u8 tu1216_init[] = { 0x0b, 0xf5, 0x85, 0xab };\n\tstruct i2c_msg tuner_msg = {.addr = addr,.flags = 0,.buf = tu1216_init,.len = sizeof(tu1216_init) };\n\n\t \n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\tif (i2c_transfer(&dev->i2c_adap, &tuner_msg, 1) != 1)\n\t\treturn -EIO;\n\tmsleep(1);\n\n\treturn 0;\n}\n\n \n\nstatic struct tda1004x_config philips_tu1216_60_config = {\n\t.demod_address = 0x8,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_4M,\n\t.agc_config    = TDA10046_AGC_DEFAULT,\n\t.if_freq       = TDA10046_FREQ_3617,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config philips_tu1216_61_config = {\n\n\t.demod_address = 0x8,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_4M,\n\t.agc_config    = TDA10046_AGC_DEFAULT,\n\t.if_freq       = TDA10046_FREQ_3617,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\n \n\nstatic int philips_td1316_tuner_init(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\tu8 addr = state->config->tuner_address;\n\tstatic u8 msg[] = { 0x0b, 0xf5, 0x86, 0xab };\n\tstruct i2c_msg init_msg = {.addr = addr,.flags = 0,.buf = msg,.len = sizeof(msg) };\n\n\t \n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\tif (i2c_transfer(&dev->i2c_adap, &init_msg, 1) != 1)\n\t\treturn -EIO;\n\treturn 0;\n}\n\nstatic int philips_td1316_tuner_set_params(struct dvb_frontend *fe)\n{\n\treturn philips_tda6651_pll_set(fe);\n}\n\nstatic int philips_td1316_tuner_sleep(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\tu8 addr = state->config->tuner_address;\n\tstatic u8 msg[] = { 0x0b, 0xdc, 0x86, 0xa4 };\n\tstruct i2c_msg analog_msg = {.addr = addr,.flags = 0,.buf = msg,.len = sizeof(msg) };\n\n\t \n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\tif (i2c_transfer(&dev->i2c_adap, &analog_msg, 1) != 1)\n\t\treturn -EIO;\n\treturn 0;\n}\n\n \n\nstatic int philips_europa_tuner_init(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstatic u8 msg[] = { 0x00, 0x40};\n\tstruct i2c_msg init_msg = {.addr = 0x43,.flags = 0,.buf = msg,.len = sizeof(msg) };\n\n\n\tif (philips_td1316_tuner_init(fe))\n\t\treturn -EIO;\n\tmsleep(1);\n\tif (i2c_transfer(&dev->i2c_adap, &init_msg, 1) != 1)\n\t\treturn -EIO;\n\n\treturn 0;\n}\n\nstatic int philips_europa_tuner_sleep(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\n\tstatic u8 msg[] = { 0x00, 0x14 };\n\tstruct i2c_msg analog_msg = {.addr = 0x43,.flags = 0,.buf = msg,.len = sizeof(msg) };\n\n\tif (philips_td1316_tuner_sleep(fe))\n\t\treturn -EIO;\n\n\t \n\tif (fe->ops.i2c_gate_ctrl)\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\ti2c_transfer(&dev->i2c_adap, &analog_msg, 1);\n\treturn 0;\n}\n\nstatic int philips_europa_demod_sleep(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\n\tif (dev->original_demod_sleep)\n\t\tdev->original_demod_sleep(fe);\n\tfe->ops.i2c_gate_ctrl(fe, 1);\n\treturn 0;\n}\n\nstatic struct tda1004x_config philips_europa_config = {\n\n\t.demod_address = 0x8,\n\t.invert        = 0,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_4M,\n\t.agc_config    = TDA10046_AGC_IFO_AUTO_POS,\n\t.if_freq       = TDA10046_FREQ_052,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config medion_cardbus = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_IFO_AUTO_NEG,\n\t.if_freq       = TDA10046_FREQ_3613,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config technotrend_budget_t3000_config = {\n\t.demod_address = 0x8,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_4M,\n\t.agc_config    = TDA10046_AGC_DEFAULT,\n\t.if_freq       = TDA10046_FREQ_3617,\n\t.tuner_address = 0x63,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\n \n\nstatic int tda8290_i2c_gate_ctrl( struct dvb_frontend* fe, int enable)\n{\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\n\tu8 addr = state->config->i2c_gate;\n\tstatic u8 tda8290_close[] = { 0x21, 0xc0};\n\tstatic u8 tda8290_open[]  = { 0x21, 0x80};\n\tstruct i2c_msg tda8290_msg = {.addr = addr,.flags = 0, .len = 2};\n\tif (enable) {\n\t\ttda8290_msg.buf = tda8290_close;\n\t} else {\n\t\ttda8290_msg.buf = tda8290_open;\n\t}\n\tif (i2c_transfer(state->i2c, &tda8290_msg, 1) != 1) {\n\t\tpr_warn(\"could not access tda8290 I2C gate\\n\");\n\t\treturn -EIO;\n\t}\n\tmsleep(20);\n\treturn 0;\n}\n\nstatic int philips_tda827x_tuner_init(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\n\tswitch (state->config->antenna_switch) {\n\tcase 0:\n\t\tbreak;\n\tcase 1:\n\t\tpr_debug(\"setting GPIO21 to 0 (TV antenna?)\\n\");\n\t\tsaa7134_set_gpio(dev, 21, 0);\n\t\tbreak;\n\tcase 2:\n\t\tpr_debug(\"setting GPIO21 to 1 (Radio antenna?)\\n\");\n\t\tsaa7134_set_gpio(dev, 21, 1);\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic int philips_tda827x_tuner_sleep(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tstruct tda1004x_state *state = fe->demodulator_priv;\n\n\tswitch (state->config->antenna_switch) {\n\tcase 0:\n\t\tbreak;\n\tcase 1:\n\t\tpr_debug(\"setting GPIO21 to 1 (Radio antenna?)\\n\");\n\t\tsaa7134_set_gpio(dev, 21, 1);\n\t\tbreak;\n\tcase 2:\n\t\tpr_debug(\"setting GPIO21 to 0 (TV antenna?)\\n\");\n\t\tsaa7134_set_gpio(dev, 21, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}\n\nstatic int configure_tda827x_fe(struct saa7134_dev *dev,\n\t\t\t\tstruct tda1004x_config *cdec_conf,\n\t\t\t\tstruct tda827x_config *tuner_conf)\n{\n\tstruct vb2_dvb_frontend *fe0;\n\n\t \n\tfe0 = vb2_dvb_get_frontend(&dev->frontends, 1);\n\n\tif (!fe0)\n\t\treturn -EINVAL;\n\n\tfe0->dvb.frontend = dvb_attach(tda10046_attach, cdec_conf, &dev->i2c_adap);\n\tif (fe0->dvb.frontend) {\n\t\tif (cdec_conf->i2c_gate)\n\t\t\tfe0->dvb.frontend->ops.i2c_gate_ctrl = tda8290_i2c_gate_ctrl;\n\t\tif (dvb_attach(tda827x_attach, fe0->dvb.frontend,\n\t\t\t       cdec_conf->tuner_address,\n\t\t\t       &dev->i2c_adap, tuner_conf))\n\t\t\treturn 0;\n\n\t\tpr_warn(\"no tda827x tuner found at addr: %02x\\n\",\n\t\t\t\tcdec_conf->tuner_address);\n\t}\n\treturn -EINVAL;\n}\n\n \n\nstatic struct tda827x_config tda827x_cfg_0 = {\n\t.init = philips_tda827x_tuner_init,\n\t.sleep = philips_tda827x_tuner_sleep,\n\t.config = 0,\n\t.switch_addr = 0\n};\n\nstatic struct tda827x_config tda827x_cfg_1 = {\n\t.init = philips_tda827x_tuner_init,\n\t.sleep = philips_tda827x_tuner_sleep,\n\t.config = 1,\n\t.switch_addr = 0x4b\n};\n\nstatic struct tda827x_config tda827x_cfg_2 = {\n\t.init = philips_tda827x_tuner_init,\n\t.sleep = philips_tda827x_tuner_sleep,\n\t.config = 2,\n\t.switch_addr = 0x4b\n};\n\nstatic struct tda827x_config tda827x_cfg_2_sw42 = {\n\t.init = philips_tda827x_tuner_init,\n\t.sleep = philips_tda827x_tuner_sleep,\n\t.config = 2,\n\t.switch_addr = 0x42\n};\n\n \n\nstatic struct tda1004x_config tda827x_lifeview_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config philips_tiger_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config cinergy_ht_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config cinergy_ht_pci_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config philips_tiger_s_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config pinnacle_pctv_310i_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config hauppauge_hvr_1110_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config asus_p7131_dual_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 2,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config lifeview_trio_config = {\n\t.demod_address = 0x09,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP00_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config tevion_dvbt220rf_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config md8800_dvbt_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x60,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config asus_p7131_4871_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 2,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config asus_p7131_hybrid_lna_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 2,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config kworld_dvb_t_210_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch= 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config avermedia_super_007_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x60,\n\t.antenna_switch= 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config twinhan_dtv_dvb_3056_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP01_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x42,\n\t.tuner_address = 0x61,\n\t.antenna_switch = 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config asus_tiger_3in1_config = {\n\t.demod_address = 0x0b,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch = 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct tda1004x_config asus_ps3_100_config = {\n\t.demod_address = 0x0b,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP11_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.i2c_gate      = 0x4b,\n\t.tuner_address = 0x61,\n\t.antenna_switch = 1,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\n \n\nstatic int ads_duo_tuner_init(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tphilips_tda827x_tuner_init(fe);\n\t \n\tsaa7134_set_gpio(dev, 22, 1);\n\treturn 0;\n}\n\nstatic int ads_duo_tuner_sleep(struct dvb_frontend *fe)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\t \n\tsaa7134_set_gpio(dev, 22, 0);\n\tphilips_tda827x_tuner_sleep(fe);\n\treturn 0;\n}\n\nstatic struct tda827x_config ads_duo_cfg = {\n\t.init = ads_duo_tuner_init,\n\t.sleep = ads_duo_tuner_sleep,\n\t.config = 0\n};\n\nstatic struct tda1004x_config ads_tech_duo_config = {\n\t.demod_address = 0x08,\n\t.invert        = 1,\n\t.invert_oclk   = 0,\n\t.xtal_freq     = TDA10046_XTAL_16M,\n\t.agc_config    = TDA10046_AGC_TDA827X,\n\t.gpio_config   = TDA10046_GP00_I,\n\t.if_freq       = TDA10046_FREQ_045,\n\t.tuner_address = 0x61,\n\t.request_firmware = philips_tda1004x_request_firmware\n};\n\nstatic struct zl10353_config behold_h6_config = {\n\t.demod_address = 0x1e>>1,\n\t.no_tuner      = 1,\n\t.parallel_ts   = 1,\n\t.disable_i2c_gate_ctrl = 1,\n};\n\nstatic struct xc5000_config behold_x7_tunerconfig = {\n\t.i2c_address      = 0xc2>>1,\n\t.if_khz           = 4560,\n\t.radio_input      = XC5000_RADIO_FM1,\n};\n\nstatic struct zl10353_config behold_x7_config = {\n\t.demod_address = 0x1e>>1,\n\t.if2           = 45600,\n\t.no_tuner      = 1,\n\t.parallel_ts   = 1,\n\t.disable_i2c_gate_ctrl = 1,\n};\n\nstatic struct zl10353_config videomate_t750_zl10353_config = {\n\t.demod_address         = 0x0f,\n\t.no_tuner              = 1,\n\t.parallel_ts           = 1,\n\t.disable_i2c_gate_ctrl = 1,\n};\n\nstatic struct qt1010_config videomate_t750_qt1010_config = {\n\t.i2c_address = 0x62\n};\n\n\n \n\nstatic struct tda10086_config flydvbs = {\n\t.demod_address = 0x0e,\n\t.invert = 0,\n\t.diseqc_tone = 0,\n\t.xtal_freq = TDA10086_XTAL_16M,\n};\n\nstatic struct tda10086_config sd1878_4m = {\n\t.demod_address = 0x0e,\n\t.invert = 0,\n\t.diseqc_tone = 0,\n\t.xtal_freq = TDA10086_XTAL_4M,\n};\n\n \n\nstatic int md8800_set_voltage(struct dvb_frontend *fe,\n\t\t\t      enum fe_sec_voltage voltage)\n{\n\tint res = -EIO;\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tif (fe->ops.i2c_gate_ctrl) {\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\t\tif (dev->original_set_voltage)\n\t\t\tres = dev->original_set_voltage(fe, voltage);\n\t\tfe->ops.i2c_gate_ctrl(fe, 0);\n\t}\n\treturn res;\n};\n\nstatic int md8800_set_high_voltage(struct dvb_frontend *fe, long arg)\n{\n\tint res = -EIO;\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tif (fe->ops.i2c_gate_ctrl) {\n\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\t\tif (dev->original_set_high_voltage)\n\t\t\tres = dev->original_set_high_voltage(fe, arg);\n\t\tfe->ops.i2c_gate_ctrl(fe, 0);\n\t}\n\treturn res;\n};\n\nstatic int md8800_set_voltage2(struct dvb_frontend *fe,\n\t\t\t       enum fe_sec_voltage voltage)\n{\n\tstruct saa7134_dev *dev = fe->dvb->priv;\n\tu8 wbuf[2] = { 0x1f, 00 };\n\tu8 rbuf;\n\tstruct i2c_msg msg[] = { { .addr = 0x08, .flags = 0, .buf = wbuf, .len = 1 },\n\t\t\t\t { .addr = 0x08, .flags = I2C_M_RD, .buf = &rbuf, .len = 1 } };\n\n\tif (i2c_transfer(&dev->i2c_adap, msg, 2) != 2)\n\t\treturn -EIO;\n\t \n\tif (voltage == SEC_VOLTAGE_18)\n\t\twbuf[1] = rbuf | 0x10;\n\telse\n\t\twbuf[1] = rbuf & 0xef;\n\tmsg[0].len = 2;\n\ti2c_transfer(&dev->i2c_adap, msg, 1);\n\treturn 0;\n}\n\nstatic int md8800_set_high_voltage2(struct dvb_frontend *fe, long arg)\n{\n\tpr_warn(\"%s: sorry can't set high LNB supply voltage from here\\n\",\n\t\t__func__);\n\treturn -EIO;\n}\n\n \n\nstatic const struct nxt200x_config avertvhda180 = {\n\t.demod_address    = 0x0a,\n};\n\nstatic const struct nxt200x_config kworldatsc110 = {\n\t.demod_address    = 0x0a,\n};\n\n \n\nstatic struct mt312_config avertv_a700_mt312 = {\n\t.demod_address = 0x0e,\n\t.voltage_inverted = 1,\n};\n\nstatic struct zl10036_config avertv_a700_tuner = {\n\t.tuner_address = 0x60,\n};\n\nstatic struct mt312_config zl10313_compro_s350_config = {\n\t.demod_address = 0x0e,\n};\n\nstatic struct mt312_config zl10313_avermedia_a706_config = {\n\t.demod_address = 0x0e,\n};\n\nstatic struct lgdt3305_config hcw_lgdt3305_config = {\n\t.i2c_addr           = 0x0e,\n\t.mpeg_mode          = LGDT3305_MPEG_SERIAL,\n\t.tpclk_edge         = LGDT3305_TPCLK_RISING_EDGE,\n\t.tpvalid_polarity   = LGDT3305_TP_VALID_HIGH,\n\t.deny_i2c_rptr      = 1,\n\t.spectral_inversion = 1,\n\t.qam_if_khz         = 4000,\n\t.vsb_if_khz         = 3250,\n};\n\nstatic struct tda10048_config hcw_tda10048_config = {\n\t.demod_address    = 0x10 >> 1,\n\t.output_mode      = TDA10048_SERIAL_OUTPUT,\n\t.fwbulkwritelen   = TDA10048_BULKWRITE_200,\n\t.inversion        = TDA10048_INVERSION_ON,\n\t.dtv6_if_freq_khz = TDA10048_IF_3300,\n\t.dtv7_if_freq_khz = TDA10048_IF_3500,\n\t.dtv8_if_freq_khz = TDA10048_IF_4000,\n\t.clk_freq_khz     = TDA10048_CLK_16000,\n\t.disable_gate_access = 1,\n};\n\nstatic struct tda18271_std_map hauppauge_tda18271_std_map = {\n\t.atsc_6   = { .if_freq = 3250, .agc_mode = 3, .std = 4,\n\t\t      .if_lvl = 1, .rfagc_top = 0x58, },\n\t.qam_6    = { .if_freq = 4000, .agc_mode = 3, .std = 5,\n\t\t      .if_lvl = 1, .rfagc_top = 0x58, },\n};\n\nstatic struct tda18271_config hcw_tda18271_config = {\n\t.std_map = &hauppauge_tda18271_std_map,\n\t.gate    = TDA18271_GATE_ANALOG,\n\t.config  = 3,\n\t.output_opt = TDA18271_OUTPUT_LT_OFF,\n};\n\nstatic struct tda829x_config tda829x_no_probe = {\n\t.probe_tuner = TDA829X_DONT_PROBE,\n};\n\nstatic struct tda10048_config zolid_tda10048_config = {\n\t.demod_address    = 0x10 >> 1,\n\t.output_mode      = TDA10048_PARALLEL_OUTPUT,\n\t.fwbulkwritelen   = TDA10048_BULKWRITE_200,\n\t.inversion        = TDA10048_INVERSION_ON,\n\t.dtv6_if_freq_khz = TDA10048_IF_3300,\n\t.dtv7_if_freq_khz = TDA10048_IF_3500,\n\t.dtv8_if_freq_khz = TDA10048_IF_4000,\n\t.clk_freq_khz     = TDA10048_CLK_16000,\n\t.disable_gate_access = 1,\n};\n\nstatic struct tda18271_config zolid_tda18271_config = {\n\t.gate    = TDA18271_GATE_ANALOG,\n};\n\nstatic struct tda10048_config dtv1000s_tda10048_config = {\n\t.demod_address    = 0x10 >> 1,\n\t.output_mode      = TDA10048_PARALLEL_OUTPUT,\n\t.fwbulkwritelen   = TDA10048_BULKWRITE_200,\n\t.inversion        = TDA10048_INVERSION_ON,\n\t.dtv6_if_freq_khz = TDA10048_IF_3300,\n\t.dtv7_if_freq_khz = TDA10048_IF_3800,\n\t.dtv8_if_freq_khz = TDA10048_IF_4300,\n\t.clk_freq_khz     = TDA10048_CLK_16000,\n\t.disable_gate_access = 1,\n};\n\nstatic struct tda18271_std_map dtv1000s_tda18271_std_map = {\n\t.dvbt_6   = { .if_freq = 3300, .agc_mode = 3, .std = 4,\n\t\t      .if_lvl = 1, .rfagc_top = 0x37, },\n\t.dvbt_7   = { .if_freq = 3800, .agc_mode = 3, .std = 5,\n\t\t      .if_lvl = 1, .rfagc_top = 0x37, },\n\t.dvbt_8   = { .if_freq = 4300, .agc_mode = 3, .std = 6,\n\t\t      .if_lvl = 1, .rfagc_top = 0x37, },\n};\n\nstatic struct tda18271_config dtv1000s_tda18271_config = {\n\t.std_map = &dtv1000s_tda18271_std_map,\n\t.gate    = TDA18271_GATE_ANALOG,\n};\n\nstatic struct lgs8gxx_config prohdtv_pro2_lgs8g75_config = {\n\t.prod = LGS8GXX_PROD_LGS8G75,\n\t.demod_address = 0x1d,\n\t.serial_ts = 0,\n\t.ts_clk_pol = 1,\n\t.ts_clk_gated = 0,\n\t.if_clk_freq = 30400,  \n\t.if_freq = 4000,  \n\t.if_neg_center = 0,\n\t.ext_adc = 0,\n\t.adc_signed = 1,\n\t.adc_vpp = 3,  \n\t.if_neg_edge = 1,\n};\n\nstatic struct tda18271_config prohdtv_pro2_tda18271_config = {\n\t.gate = TDA18271_GATE_ANALOG,\n\t.output_opt = TDA18271_OUTPUT_LT_OFF,\n};\n\nstatic struct tda18271_std_map kworld_tda18271_std_map = {\n\t.atsc_6   = { .if_freq = 3250, .agc_mode = 3, .std = 3,\n\t\t      .if_lvl = 6, .rfagc_top = 0x37 },\n\t.qam_6    = { .if_freq = 4000, .agc_mode = 3, .std = 0,\n\t\t      .if_lvl = 6, .rfagc_top = 0x37 },\n};\n\nstatic struct tda18271_config kworld_pc150u_tda18271_config = {\n\t.std_map = &kworld_tda18271_std_map,\n\t.gate    = TDA18271_GATE_ANALOG,\n\t.output_opt = TDA18271_OUTPUT_LT_OFF,\n\t.config  = 3,\t \n\t.rf_cal_on_startup = 1\n};\n\nstatic struct s5h1411_config kworld_s5h1411_config = {\n\t.output_mode   = S5H1411_PARALLEL_OUTPUT,\n\t.gpio          = S5H1411_GPIO_OFF,\n\t.qam_if        = S5H1411_IF_4000,\n\t.vsb_if        = S5H1411_IF_3250,\n\t.inversion     = S5H1411_INVERSION_ON,\n\t.status_mode   = S5H1411_DEMODLOCKING,\n\t.mpeg_timing   =\n\t\tS5H1411_MPEGTIMING_CONTINUOUS_NONINVERTING_CLOCK,\n};\n\nstatic struct tda18271_config hdtv200h_tda18271_config = {\n\t.gate    = TDA18271_GATE_ANALOG,\n\t.config  = 3\t \n};\n\nstatic struct s5h1411_config hdtv200h_s5h1411_config = {\n\t.output_mode   = S5H1411_PARALLEL_OUTPUT,\n\t.gpio          = S5H1411_GPIO_OFF,\n\t.qam_if        = S5H1411_IF_4000,\n\t.vsb_if        = S5H1411_IF_3250,\n\t.inversion     = S5H1411_INVERSION_ON,\n\t.status_mode   = S5H1411_DEMODLOCKING,\n\t.mpeg_timing   =\n\t\tS5H1411_MPEGTIMING_CONTINUOUS_NONINVERTING_CLOCK,\n};\n\n\n \n\nstatic int dvb_init(struct saa7134_dev *dev)\n{\n\tint ret;\n\tint attach_xc3028 = 0;\n\tstruct vb2_dvb_frontend *fe0;\n\tstruct vb2_queue *q;\n\n\t \n\tmutex_init(&dev->frontends.lock);\n\tINIT_LIST_HEAD(&dev->frontends.felist);\n\n\tpr_info(\"%s() allocating 1 frontend\\n\", __func__);\n\tfe0 = vb2_dvb_alloc_frontend(&dev->frontends, 1);\n\tif (!fe0) {\n\t\tpr_err(\"%s() failed to alloc\\n\", __func__);\n\t\treturn -ENOMEM;\n\t}\n\n\t \n\tdev->ts.nr_bufs    = 32;\n\tdev->ts.nr_packets = 32*4;\n\tfe0->dvb.name = dev->name;\n\tq = &fe0->dvb.dvbq;\n\tq->type = V4L2_BUF_TYPE_VIDEO_CAPTURE;\n\tq->io_modes = VB2_MMAP | VB2_READ;\n\tq->drv_priv = &dev->ts_q;\n\tq->ops = &saa7134_ts_qops;\n\tq->mem_ops = &vb2_dma_sg_memops;\n\tq->buf_struct_size = sizeof(struct saa7134_buf);\n\tq->timestamp_flags = V4L2_BUF_FLAG_TIMESTAMP_MONOTONIC;\n\tq->lock = &dev->lock;\n\tq->dev = &dev->pci->dev;\n\tret = vb2_queue_init(q);\n\tif (ret) {\n\t\tvb2_dvb_dealloc_frontends(&dev->frontends);\n\t\treturn ret;\n\t}\n\n\tswitch (dev->board) {\n\tcase SAA7134_BOARD_PINNACLE_300I_DVBT_PAL:\n\t\tpr_debug(\"pinnacle 300i dvb setup\\n\");\n\t\tfe0->dvb.frontend = dvb_attach(mt352_attach, &pinnacle_300i,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = mt352_pinnacle_tuner_set_params;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_777:\n\tcase SAA7134_BOARD_AVERMEDIA_A16AR:\n\t\tpr_debug(\"avertv 777 dvb setup\\n\");\n\t\tfe0->dvb.frontend = dvb_attach(mt352_attach, &avermedia_777,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(simple_tuner_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x61,\n\t\t\t\t   TUNER_PHILIPS_TD1316);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_A16D:\n\t\tpr_debug(\"AverMedia A16D dvb setup\\n\");\n\t\tfe0->dvb.frontend = dvb_attach(mt352_attach,\n\t\t\t\t\t\t&avermedia_xc3028_mt352_dev,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tattach_xc3028 = 1;\n\t\tbreak;\n\tcase SAA7134_BOARD_MD7134:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &medion_cardbus,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\t \n\t\t\tfe0->dvb.frontend->ops.i2c_gate_ctrl = NULL;\n\t\t\tdvb_attach(simple_tuner_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, medion_cardbus.tuner_address,\n\t\t\t\t   TUNER_PHILIPS_FMD1216ME_MK3);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_PHILIPS_TOUGH:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &philips_tu1216_60_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.init = philips_tu1216_init;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = philips_tda6651_pll_set;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_FLYDVBTDUO:\n\tcase SAA7134_BOARD_FLYDVBT_DUO_CARDBUS:\n\t\tif (configure_tda827x_fe(dev, &tda827x_lifeview_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_PHILIPS_EUROPA:\n\tcase SAA7134_BOARD_VIDEOMATE_DVBT_300:\n\tcase SAA7134_BOARD_ASUS_EUROPA_HYBRID:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &philips_europa_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdev->original_demod_sleep = fe0->dvb.frontend->ops.sleep;\n\t\t\tfe0->dvb.frontend->ops.sleep = philips_europa_demod_sleep;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.init = philips_europa_tuner_init;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.sleep = philips_europa_tuner_sleep;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = philips_td1316_tuner_set_params;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_TECHNOTREND_BUDGET_T3000:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &technotrend_budget_t3000_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdev->original_demod_sleep = fe0->dvb.frontend->ops.sleep;\n\t\t\tfe0->dvb.frontend->ops.sleep = philips_europa_demod_sleep;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.init = philips_europa_tuner_init;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.sleep = philips_europa_tuner_sleep;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = philips_td1316_tuner_set_params;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_VIDEOMATE_DVBT_200:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &philips_tu1216_61_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.init = philips_tu1216_init;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = philips_tda6651_pll_set;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_KWORLD_DVBT_210:\n\t\tif (configure_tda827x_fe(dev, &kworld_dvb_t_210_config,\n\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_HAUPPAUGE_HVR1120:\n\t\tfe0->dvb.frontend = dvb_attach(tda10048_attach,\n\t\t\t\t\t       &hcw_tda10048_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &hcw_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_PHILIPS_TIGER:\n\t\tif (configure_tda827x_fe(dev, &philips_tiger_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_PINNACLE_PCTV_310i:\n\t\tif (configure_tda827x_fe(dev, &pinnacle_pctv_310i_config,\n\t\t\t\t\t &tda827x_cfg_1) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_HAUPPAUGE_HVR1110:\n\t\tif (configure_tda827x_fe(dev, &hauppauge_hvr_1110_config,\n\t\t\t\t\t &tda827x_cfg_1) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_HAUPPAUGE_HVR1150:\n\t\tfe0->dvb.frontend = dvb_attach(lgdt3305_attach,\n\t\t\t\t\t       &hcw_lgdt3305_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &hcw_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUSTeK_P7131_DUAL:\n\t\tif (configure_tda827x_fe(dev, &asus_p7131_dual_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_FLYDVBT_LR301:\n\t\tif (configure_tda827x_fe(dev, &tda827x_lifeview_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_FLYDVB_TRIO:\n\t\tif (!use_frontend) {\t \n\t\t\tif (configure_tda827x_fe(dev, &lifeview_trio_config,\n\t\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\t\tgoto detach_frontend;\n\t\t} else {\t\t \n\t\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach, &flydvbs, &dev->i2c_adap);\n\t\t\tif (fe0->dvb.frontend) {\n\t\t\t\tif (dvb_attach(tda826x_attach, fe0->dvb.frontend, 0x63,\n\t\t\t\t\t\t\t\t\t&dev->i2c_adap, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Lifeview Trio, No tda826x found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t\tif (dvb_attach(isl6421_attach, fe0->dvb.frontend,\n\t\t\t\t\t       &dev->i2c_adap,\n\t\t\t\t\t       0x08, 0, 0, false) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Lifeview Trio, No ISL6421 found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_ADS_DUO_CARDBUS_PTV331:\n\tcase SAA7134_BOARD_FLYDVBT_HYBRID_CARDBUS:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &ads_tech_duo_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tif (dvb_attach(tda827x_attach,fe0->dvb.frontend,\n\t\t\t\t   ads_tech_duo_config.tuner_address, &dev->i2c_adap,\n\t\t\t\t\t\t\t\t&ads_duo_cfg) == NULL) {\n\t\t\t\tpr_warn(\"no tda827x tuner found at addr: %02x\\n\",\n\t\t\t\t\tads_tech_duo_config.tuner_address);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t} else\n\t\t\tpr_warn(\"failed to attach tda10046\\n\");\n\t\tbreak;\n\tcase SAA7134_BOARD_TEVION_DVBT_220RF:\n\t\tif (configure_tda827x_fe(dev, &tevion_dvbt220rf_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_MEDION_MD8800_QUADRO:\n\t\tif (!use_frontend) {      \n\t\t\tif (configure_tda827x_fe(dev, &md8800_dvbt_config,\n\t\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\t\tgoto detach_frontend;\n\t\t} else {         \n\t\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach,\n\t\t\t\t\t\t\t&flydvbs, &dev->i2c_adap);\n\t\t\tif (fe0->dvb.frontend) {\n\t\t\t\tstruct dvb_frontend *fe = fe0->dvb.frontend;\n\t\t\t\tu8 dev_id = dev->eedata[2];\n\t\t\t\tu8 data = 0xc4;\n\t\t\t\tstruct i2c_msg msg = {.addr = 0x08, .flags = 0, .len = 1};\n\n\t\t\t\tif (dvb_attach(tda826x_attach, fe0->dvb.frontend,\n\t\t\t\t\t\t0x60, &dev->i2c_adap, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Medion Quadro, no tda826x found !\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t\tif (dev_id != 0x08) {\n\t\t\t\t\t \n\t\t\t\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\t\t\t\t\tif (dvb_attach(isl6405_attach, fe,\n\t\t\t\t\t\t\t&dev->i2c_adap, 0x08, 0, 0) == NULL) {\n\t\t\t\t\t\tpr_warn(\"%s: Medion Quadro, no ISL6405 found !\\n\",\n\t\t\t\t\t\t\t__func__);\n\t\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t\t}\n\t\t\t\t\tif (dev_id == 0x07) {\n\t\t\t\t\t\t \n\t\t\t\t\t\tmsg.buf = &data;\n\t\t\t\t\t\ti2c_transfer(&dev->i2c_adap, &msg, 1);\n\t\t\t\t\t}\n\t\t\t\t\tfe->ops.i2c_gate_ctrl(fe, 0);\n\t\t\t\t\tdev->original_set_voltage = fe->ops.set_voltage;\n\t\t\t\t\tfe->ops.set_voltage = md8800_set_voltage;\n\t\t\t\t\tdev->original_set_high_voltage = fe->ops.enable_high_lnb_voltage;\n\t\t\t\t\tfe->ops.enable_high_lnb_voltage = md8800_set_high_voltage;\n\t\t\t\t} else {\n\t\t\t\t\tfe->ops.set_voltage = md8800_set_voltage2;\n\t\t\t\t\tfe->ops.enable_high_lnb_voltage = md8800_set_high_voltage2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_AVERTVHD_A180:\n\t\tfe0->dvb.frontend = dvb_attach(nxt200x_attach, &avertvhda180,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend)\n\t\t\tdvb_attach(dvb_pll_attach, fe0->dvb.frontend, 0x61,\n\t\t\t\t   NULL, DVB_PLL_TDHU2);\n\t\tbreak;\n\tcase SAA7134_BOARD_ADS_INSTANT_HDTV_PCI:\n\tcase SAA7134_BOARD_KWORLD_ATSC110:\n\t\tfe0->dvb.frontend = dvb_attach(nxt200x_attach, &kworldatsc110,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend)\n\t\t\tdvb_attach(simple_tuner_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x61,\n\t\t\t\t   TUNER_PHILIPS_TUV1236D);\n\t\tbreak;\n\tcase SAA7134_BOARD_KWORLD_PC150U:\n\t\tsaa7134_set_gpio(dev, 18, 1);  \n\t\tsaa7134_tuner_callback(dev, 0,\n\t\t\t\t       TDA18271_CALLBACK_CMD_AGC_ENABLE, 1);\n\t\tfe0->dvb.frontend = dvb_attach(s5h1411_attach,\n\t\t\t\t\t       &kworld_s5h1411_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &kworld_pc150u_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_FLYDVBS_LR300:\n\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach, &flydvbs,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tif (dvb_attach(tda826x_attach, fe0->dvb.frontend, 0x60,\n\t\t\t\t       &dev->i2c_adap, 0) == NULL) {\n\t\t\t\tpr_warn(\"%s: No tda826x found!\\n\", __func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t\tif (dvb_attach(isl6421_attach, fe0->dvb.frontend,\n\t\t\t\t       &dev->i2c_adap,\n\t\t\t\t       0x08, 0, 0, false) == NULL) {\n\t\t\t\tpr_warn(\"%s: No ISL6421 found!\\n\", __func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUS_EUROPA2_HYBRID:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t\t       &medion_cardbus,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdev->original_demod_sleep = fe0->dvb.frontend->ops.sleep;\n\t\t\tfe0->dvb.frontend->ops.sleep = philips_europa_demod_sleep;\n\n\t\t\tdvb_attach(simple_tuner_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, medion_cardbus.tuner_address,\n\t\t\t\t   TUNER_PHILIPS_FMD1216ME_MK3);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_VIDEOMATE_DVBT_200A:\n\t\tfe0->dvb.frontend = dvb_attach(tda10046_attach,\n\t\t\t\t&philips_europa_config,\n\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.init = philips_td1316_tuner_init;\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.set_params = philips_td1316_tuner_set_params;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_CINERGY_HT_PCMCIA:\n\t\tif (configure_tda827x_fe(dev, &cinergy_ht_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_CINERGY_HT_PCI:\n\t\tif (configure_tda827x_fe(dev, &cinergy_ht_pci_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_PHILIPS_TIGER_S:\n\t\tif (configure_tda827x_fe(dev, &philips_tiger_s_config,\n\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUS_P7131_4871:\n\t\tif (configure_tda827x_fe(dev, &asus_p7131_4871_config,\n\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUSTeK_P7131_HYBRID_LNA:\n\t\tif (configure_tda827x_fe(dev, &asus_p7131_hybrid_lna_config,\n\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_SUPER_007:\n\t\tif (configure_tda827x_fe(dev, &avermedia_super_007_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_TWINHAN_DTV_DVB_3056:\n\t\tif (configure_tda827x_fe(dev, &twinhan_dtv_dvb_3056_config,\n\t\t\t\t\t &tda827x_cfg_2_sw42) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_PHILIPS_SNAKE:\n\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach, &flydvbs,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tif (dvb_attach(tda826x_attach, fe0->dvb.frontend, 0x60,\n\t\t\t\t\t&dev->i2c_adap, 0) == NULL) {\n\t\t\t\tpr_warn(\"%s: No tda826x found!\\n\", __func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t\tif (dvb_attach(lnbp21_attach, fe0->dvb.frontend,\n\t\t\t\t\t&dev->i2c_adap, 0, 0) == NULL) {\n\t\t\t\tpr_warn(\"%s: No lnbp21 found!\\n\", __func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_CREATIX_CTX953:\n\t\tif (configure_tda827x_fe(dev, &md8800_dvbt_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_MSI_TVANYWHERE_AD11:\n\t\tif (configure_tda827x_fe(dev, &philips_tiger_s_config,\n\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_CARDBUS_506:\n\t\tpr_debug(\"AverMedia E506R dvb setup\\n\");\n\t\tsaa7134_set_gpio(dev, 25, 0);\n\t\tmsleep(10);\n\t\tsaa7134_set_gpio(dev, 25, 1);\n\t\tfe0->dvb.frontend = dvb_attach(mt352_attach,\n\t\t\t\t\t\t&avermedia_xc3028_mt352_dev,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tattach_xc3028 = 1;\n\t\tbreak;\n\tcase SAA7134_BOARD_MD7134_BRIDGE_2:\n\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach,\n\t\t\t\t\t\t&sd1878_4m, &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tstruct dvb_frontend *fe;\n\t\t\tif (dvb_attach(dvb_pll_attach, fe0->dvb.frontend, 0x60,\n\t\t\t\t  &dev->i2c_adap, DVB_PLL_PHILIPS_SD1878_TDA8261) == NULL) {\n\t\t\t\tpr_warn(\"%s: MD7134 DVB-S, no SD1878 found !\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t\t \n\t\t\tfe = fe0->dvb.frontend;\n\t\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\t\t\tif (dvb_attach(isl6405_attach, fe,\n\t\t\t\t\t&dev->i2c_adap, 0x08, 0, 0) == NULL) {\n\t\t\t\tpr_warn(\"%s: MD7134 DVB-S, no ISL6405 found !\\n\",\n\t\t\t\t\t__func__);\n\t\t\t\tgoto detach_frontend;\n\t\t\t}\n\t\t\tfe->ops.i2c_gate_ctrl(fe, 0);\n\t\t\tdev->original_set_voltage = fe->ops.set_voltage;\n\t\t\tfe->ops.set_voltage = md8800_set_voltage;\n\t\t\tdev->original_set_high_voltage = fe->ops.enable_high_lnb_voltage;\n\t\t\tfe->ops.enable_high_lnb_voltage = md8800_set_high_voltage;\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_M103:\n\t\tsaa7134_set_gpio(dev, 25, 0);\n\t\tmsleep(10);\n\t\tsaa7134_set_gpio(dev, 25, 1);\n\t\tfe0->dvb.frontend = dvb_attach(mt352_attach,\n\t\t\t\t\t\t&avermedia_xc3028_mt352_dev,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tattach_xc3028 = 1;\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUSTeK_TIGER_3IN1:\n\t\tif (!use_frontend) {      \n\t\t\tif (configure_tda827x_fe(dev, &asus_tiger_3in1_config,\n\t\t\t\t\t\t\t&tda827x_cfg_2) < 0)\n\t\t\t\tgoto detach_frontend;\n\t\t} else {\t\t \n\t\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach,\n\t\t\t\t\t\t&flydvbs, &dev->i2c_adap);\n\t\t\tif (fe0->dvb.frontend) {\n\t\t\t\tif (dvb_attach(tda826x_attach,\n\t\t\t\t\t\tfe0->dvb.frontend, 0x60,\n\t\t\t\t\t\t&dev->i2c_adap, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Asus Tiger 3in1, no tda826x found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t\tif (dvb_attach(lnbp21_attach, fe0->dvb.frontend,\n\t\t\t\t\t\t&dev->i2c_adap, 0, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Asus Tiger 3in1, no lnbp21 found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t       }\n\t\t       }\n\t       }\n\t       break;\n\tcase SAA7134_BOARD_ASUSTeK_PS3_100:\n\t\tif (!use_frontend) {      \n\t\t\tif (configure_tda827x_fe(dev, &asus_ps3_100_config,\n\t\t\t\t\t\t &tda827x_cfg_2) < 0)\n\t\t\t\tgoto detach_frontend;\n\t       } else {                 \n\t\t\tfe0->dvb.frontend = dvb_attach(tda10086_attach,\n\t\t\t\t\t\t       &flydvbs, &dev->i2c_adap);\n\t\t\tif (fe0->dvb.frontend) {\n\t\t\t\tif (dvb_attach(tda826x_attach,\n\t\t\t\t\t       fe0->dvb.frontend, 0x60,\n\t\t\t\t\t       &dev->i2c_adap, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Asus My Cinema PS3-100, no tda826x found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t\tif (dvb_attach(lnbp21_attach, fe0->dvb.frontend,\n\t\t\t\t\t       &dev->i2c_adap, 0, 0) == NULL) {\n\t\t\t\t\tpr_warn(\"%s: Asus My Cinema PS3-100, no lnbp21 found!\\n\",\n\t\t\t\t\t\t__func__);\n\t\t\t\t\tgoto detach_frontend;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_ASUSTeK_TIGER:\n\t\tif (configure_tda827x_fe(dev, &philips_tiger_config,\n\t\t\t\t\t &tda827x_cfg_0) < 0)\n\t\t\tgoto detach_frontend;\n\t\tbreak;\n\tcase SAA7134_BOARD_BEHOLD_H6:\n\t\tfe0->dvb.frontend = dvb_attach(zl10353_attach,\n\t\t\t\t\t\t&behold_h6_config,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(simple_tuner_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x61,\n\t\t\t\t   TUNER_PHILIPS_FMD1216MEX_MK3);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_BEHOLD_X7:\n\t\tfe0->dvb.frontend = dvb_attach(zl10353_attach,\n\t\t\t\t\t\t&behold_x7_config,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(xc5000_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, &behold_x7_tunerconfig);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_BEHOLD_H7:\n\t\tfe0->dvb.frontend = dvb_attach(zl10353_attach,\n\t\t\t\t\t\t&behold_x7_config,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(xc5000_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, &behold_x7_tunerconfig);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_A700_PRO:\n\tcase SAA7134_BOARD_AVERMEDIA_A700_HYBRID:\n\t\t \n\t\tfe0->dvb.frontend = dvb_attach(mt312_attach,\n\t\t\t&avertv_a700_mt312, &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tif (dvb_attach(zl10036_attach, fe0->dvb.frontend,\n\t\t\t\t\t&avertv_a700_tuner, &dev->i2c_adap) == NULL) {\n\t\t\t\tpr_warn(\"%s: No zl10036 found!\\n\",\n\t\t\t\t\t__func__);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_VIDEOMATE_S350:\n\t\tfe0->dvb.frontend = dvb_attach(mt312_attach,\n\t\t\t\t&zl10313_compro_s350_config, &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend)\n\t\t\tif (dvb_attach(zl10039_attach, fe0->dvb.frontend,\n\t\t\t\t\t0x60, &dev->i2c_adap) == NULL)\n\t\t\t\tpr_warn(\"%s: No zl10039 found!\\n\",\n\t\t\t\t\t__func__);\n\n\t\tbreak;\n\tcase SAA7134_BOARD_VIDEOMATE_T750:\n\t\tfe0->dvb.frontend = dvb_attach(zl10353_attach,\n\t\t\t\t\t\t&videomate_t750_zl10353_config,\n\t\t\t\t\t\t&dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tif (dvb_attach(qt1010_attach,\n\t\t\t\t\tfe0->dvb.frontend,\n\t\t\t\t\t&dev->i2c_adap,\n\t\t\t\t\t&videomate_t750_qt1010_config) == NULL)\n\t\t\t\tpr_warn(\"error attaching QT1010\\n\");\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_ZOLID_HYBRID_PCI:\n\t\tfe0->dvb.frontend = dvb_attach(tda10048_attach,\n\t\t\t\t\t       &zolid_tda10048_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &zolid_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_LEADTEK_WINFAST_DTV1000S:\n\t\tfe0->dvb.frontend = dvb_attach(tda10048_attach,\n\t\t\t\t\t       &dtv1000s_tda10048_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &dtv1000s_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_KWORLD_PCI_SBTVD_FULLSEG:\n\t\t \n\t\tsaa7134_tuner_callback(dev, 0,\n\t\t\t\t       TDA18271_CALLBACK_CMD_AGC_ENABLE, 1);\n\t\tfe0->dvb.frontend = dvb_attach(mb86a20s_attach,\n\t\t\t\t\t       &kworld_mb86a20s_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tfe0->dvb.frontend->ops.i2c_gate_ctrl = kworld_sbtvd_gate_ctrl;\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &kworld_tda18271_config);\n\t\t}\n\n\t\t \n\t\tbreak;\n\tcase SAA7134_BOARD_MAGICPRO_PROHDTV_PRO2:\n\t\tfe0->dvb.frontend = dvb_attach(lgs8gxx_attach,\n\t\t\t\t\t       &prohdtv_pro2_lgs8g75_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend != NULL) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &prohdtv_pro2_tda18271_config);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_AVERMEDIA_A706:\n\t\t \n\t\t \n\t\tsaa7134_set_gpio(dev, 23, 0);\n\t\t \n\t\tsaa7134_set_gpio(dev, 9, 0);\n\t\t \n\t\tsaa7134_set_gpio(dev, 25, 1);\n\t\tmsleep(1);\n\t\tfe0->dvb.frontend = dvb_attach(mt312_attach,\n\t\t\t\t&zl10313_avermedia_a706_config, &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tfe0->dvb.frontend->ops.i2c_gate_ctrl = NULL;\n\t\t\tif (dvb_attach(zl10039_attach, fe0->dvb.frontend,\n\t\t\t\t\t0x60, &dev->i2c_adap) == NULL)\n\t\t\t\tpr_warn(\"%s: No zl10039 found!\\n\",\n\t\t\t\t\t__func__);\n\t\t}\n\t\tbreak;\n\tcase SAA7134_BOARD_LEADTEK_WINFAST_HDTV200_H:\n\t\tfe0->dvb.frontend = dvb_attach(s5h1411_attach,\n\t\t\t\t\t       &hdtv200h_s5h1411_config,\n\t\t\t\t\t       &dev->i2c_adap);\n\t\tif (fe0->dvb.frontend) {\n\t\t\tdvb_attach(tda829x_attach, fe0->dvb.frontend,\n\t\t\t\t   &dev->i2c_adap, 0x4b,\n\t\t\t\t   &tda829x_no_probe);\n\t\t\tdvb_attach(tda18271_attach, fe0->dvb.frontend,\n\t\t\t\t   0x60, &dev->i2c_adap,\n\t\t\t\t   &hdtv200h_tda18271_config);\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tpr_warn(\"Huh? unknown DVB card?\\n\");\n\t\tbreak;\n\t}\n\n\tif (attach_xc3028) {\n\t\tstruct dvb_frontend *fe;\n\t\tstruct xc2028_config cfg = {\n\t\t\t.i2c_adap  = &dev->i2c_adap,\n\t\t\t.i2c_addr  = 0x61,\n\t\t};\n\n\t\tif (!fe0->dvb.frontend)\n\t\t\tgoto detach_frontend;\n\n\t\tfe = dvb_attach(xc2028_attach, fe0->dvb.frontend, &cfg);\n\t\tif (!fe) {\n\t\t\tpr_err(\"%s/2: xc3028 attach failed\\n\",\n\t\t\t       dev->name);\n\t\t\tgoto detach_frontend;\n\t\t}\n\t}\n\n\tif (NULL == fe0->dvb.frontend) {\n\t\tpr_err(\"%s/dvb: frontend initialization failed\\n\", dev->name);\n\t\tgoto detach_frontend;\n\t}\n\t \n\tfe0->dvb.frontend->callback = saa7134_tuner_callback;\n\n\t \n#ifndef CONFIG_MEDIA_CONTROLLER_DVB\n\tret = vb2_dvb_register_bus(&dev->frontends, THIS_MODULE, dev,\n\t\t\t\t   &dev->pci->dev, NULL,\n\t\t\t\t   adapter_nr, 0);\n#else\n\tret = vb2_dvb_register_bus(&dev->frontends, THIS_MODULE, dev,\n\t\t\t\t   &dev->pci->dev, dev->media_dev,\n\t\t\t\t   adapter_nr, 0);\n#endif\n\n\t \n\tif (!ret) {\n\t\tif (fe0->dvb.frontend->ops.init)\n\t\t\tfe0->dvb.frontend->ops.init(fe0->dvb.frontend);\n\t\tif (fe0->dvb.frontend->ops.sleep)\n\t\t\tfe0->dvb.frontend->ops.sleep(fe0->dvb.frontend);\n\t\tif (fe0->dvb.frontend->ops.tuner_ops.sleep)\n\t\t\tfe0->dvb.frontend->ops.tuner_ops.sleep(fe0->dvb.frontend);\n\t}\n\treturn ret;\n\ndetach_frontend:\n\tvb2_dvb_dealloc_frontends(&dev->frontends);\n\tvb2_queue_release(&fe0->dvb.dvbq);\n\treturn -EINVAL;\n}\n\nstatic int dvb_fini(struct saa7134_dev *dev)\n{\n\tstruct vb2_dvb_frontend *fe0;\n\n\t \n\tfe0 = vb2_dvb_get_frontend(&dev->frontends, 1);\n\tif (!fe0)\n\t\treturn -EINVAL;\n\n\t \n\tif (dev->board == SAA7134_BOARD_PINNACLE_300I_DVBT_PAL) {\n\t\tstruct v4l2_priv_tun_config tda9887_cfg;\n\t\tstatic int on  = TDA9887_PRESENT | TDA9887_PORT2_INACTIVE;\n\n\t\ttda9887_cfg.tuner = TUNER_TDA9887;\n\t\ttda9887_cfg.priv  = &on;\n\n\t\t \n\t\tsaa_call_all(dev, tuner, s_config, &tda9887_cfg);\n\t} else if (dev->board == SAA7134_BOARD_MEDION_MD8800_QUADRO) {\n\t\tif ((dev->eedata[2] == 0x07) && use_frontend) {\n\t\t\t \n\t\t\tu8 data = 0x80;\n\t\t\tstruct i2c_msg msg = {.addr = 0x08, .buf = &data, .flags = 0, .len = 1};\n\t\t\tstruct dvb_frontend *fe;\n\t\t\tfe = fe0->dvb.frontend;\n\t\t\tif (fe->ops.i2c_gate_ctrl) {\n\t\t\t\tfe->ops.i2c_gate_ctrl(fe, 1);\n\t\t\t\ti2c_transfer(&dev->i2c_adap, &msg, 1);\n\t\t\t\tfe->ops.i2c_gate_ctrl(fe, 0);\n\t\t\t}\n\t\t}\n\t}\n\tvb2_dvb_unregister_bus(&dev->frontends);\n\tvb2_queue_release(&fe0->dvb.dvbq);\n\treturn 0;\n}\n\nstatic struct saa7134_mpeg_ops dvb_ops = {\n\t.type          = SAA7134_MPEG_DVB,\n\t.init          = dvb_init,\n\t.fini          = dvb_fini,\n};\n\nstatic int __init dvb_register(void)\n{\n\treturn saa7134_ts_register(&dvb_ops);\n}\n\nstatic void __exit dvb_unregister(void)\n{\n\tsaa7134_ts_unregister(&dvb_ops);\n}\n\nmodule_init(dvb_register);\nmodule_exit(dvb_unregister);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}