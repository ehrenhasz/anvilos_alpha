{
  "module_name": "mantis_vp1034.c",
  "hash_id": "a59f5e129ab9a58db10a379633ce6ef84edf6e394e3c6ae441fd1b517b37ec24",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/mantis/mantis_vp1034.c",
  "human_readable_source": "\n \n\n#include <linux/signal.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <asm/io.h>\n\n#include <media/dmxdev.h>\n#include <media/dvbdev.h>\n#include <media/dvb_demux.h>\n#include <media/dvb_frontend.h>\n#include <media/dvb_net.h>\n\n#include \"mb86a16.h\"\n#include \"mantis_common.h\"\n#include \"mantis_ioc.h\"\n#include \"mantis_dvb.h\"\n#include \"mantis_vp1034.h\"\n#include \"mantis_reg.h\"\n\nstatic const struct mb86a16_config vp1034_mb86a16_config = {\n\t.demod_address\t= 0x08,\n\t.set_voltage\t= vp1034_set_voltage,\n};\n\n#define MANTIS_MODEL_NAME\t\"VP-1034\"\n#define MANTIS_DEV_TYPE\t\t\"DVB-S/DSS\"\n\nint vp1034_set_voltage(struct dvb_frontend *fe, enum fe_sec_voltage voltage)\n{\n\tstruct mantis_pci *mantis = fe->dvb->priv;\n\n\tswitch (voltage) {\n\tcase SEC_VOLTAGE_13:\n\t\tdprintk(MANTIS_ERROR, 1, \"Polarization=[13V]\");\n\t\tmantis_gpio_set_bits(mantis, 13, 1);\n\t\tmantis_gpio_set_bits(mantis, 14, 0);\n\t\tbreak;\n\tcase SEC_VOLTAGE_18:\n\t\tdprintk(MANTIS_ERROR, 1, \"Polarization=[18V]\");\n\t\tmantis_gpio_set_bits(mantis, 13, 1);\n\t\tmantis_gpio_set_bits(mantis, 14, 1);\n\t\tbreak;\n\tcase SEC_VOLTAGE_OFF:\n\t\tdprintk(MANTIS_ERROR, 1, \"Frontend (dummy) POWERDOWN\");\n\t\tbreak;\n\tdefault:\n\t\tdprintk(MANTIS_ERROR, 1, \"Invalid = (%d)\", (u32) voltage);\n\t\treturn -EINVAL;\n\t}\n\tmmwrite(0x00, MANTIS_GPIF_DOUT);\n\n\treturn 0;\n}\n\nstatic int vp1034_frontend_init(struct mantis_pci *mantis, struct dvb_frontend *fe)\n{\n\tstruct i2c_adapter *adapter\t= &mantis->adapter;\n\n\tint err = 0;\n\n\terr = mantis_frontend_power(mantis, POWER_ON);\n\tif (err == 0) {\n\t\tmantis_frontend_soft_reset(mantis);\n\t\tmsleep(250);\n\n\t\tdprintk(MANTIS_ERROR, 1, \"Probing for MB86A16 (DVB-S/DSS)\");\n\t\tfe = dvb_attach(mb86a16_attach, &vp1034_mb86a16_config, adapter);\n\t\tif (fe) {\n\t\t\tdprintk(MANTIS_ERROR, 1,\n\t\t\t\"found MB86A16 DVB-S/DSS frontend @0x%02x\",\n\t\t\tvp1034_mb86a16_config.demod_address);\n\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t} else {\n\t\tdprintk(MANTIS_ERROR, 1, \"Frontend on <%s> POWER ON failed! <%d>\",\n\t\t\tadapter->name,\n\t\t\terr);\n\n\t\treturn -EIO;\n\t}\n\tmantis->fe = fe;\n\tdprintk(MANTIS_ERROR, 1, \"Done!\");\n\n\treturn 0;\n}\n\nstruct mantis_hwconfig vp1034_config = {\n\t.model_name\t= MANTIS_MODEL_NAME,\n\t.dev_type\t= MANTIS_DEV_TYPE,\n\t.ts_size\t= MANTIS_TS_204,\n\n\t.baud_rate\t= MANTIS_BAUD_9600,\n\t.parity\t\t= MANTIS_PARITY_NONE,\n\t.bytes\t\t= 0,\n\n\t.frontend_init\t= vp1034_frontend_init,\n\t.power\t\t= GPIF_A12,\n\t.reset\t\t= GPIF_A13,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}