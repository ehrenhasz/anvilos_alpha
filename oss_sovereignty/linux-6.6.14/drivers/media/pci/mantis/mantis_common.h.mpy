{
  "module_name": "mantis_common.h",
  "hash_id": "5b35dddff57cfb88d5e662924128bc914317ceb2485f77679da6fbb992a78169",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/mantis/mantis_common.h",
  "human_readable_source": " \n \n\n#ifndef __MANTIS_COMMON_H\n#define __MANTIS_COMMON_H\n\n#include <linux/interrupt.h>\n#include <linux/mutex.h>\n#include <linux/workqueue.h>\n\n#include \"mantis_reg.h\"\n#include \"mantis_uart.h\"\n\n#include \"mantis_link.h\"\n\n#define MANTIS_ERROR\t\t0\n#define MANTIS_NOTICE\t\t1\n#define MANTIS_INFO\t\t2\n#define MANTIS_DEBUG\t\t3\n#define MANTIS_TMG\t\t9\n\n#define dprintk(y, z, format, arg...) do {\t\t\t\t\t\t\t\t\\\n\tif (z) {\t\t\t\t\t\t\t\t\t\t\t\\\n\t\tif\t((mantis->verbose > MANTIS_ERROR) && (mantis->verbose > y))\t\t\t\\\n\t\t\tprintk(KERN_ERR \"%s (%d): \" format \"\\n\" , __func__ , mantis->num , ##arg);\t\\\n\t\telse if\t((mantis->verbose > MANTIS_NOTICE) && (mantis->verbose > y))\t\t\t\\\n\t\t\tprintk(KERN_NOTICE \"%s (%d): \" format \"\\n\" , __func__ , mantis->num , ##arg);\t\\\n\t\telse if ((mantis->verbose > MANTIS_INFO) && (mantis->verbose > y))\t\t\t\\\n\t\t\tprintk(KERN_INFO \"%s (%d): \" format \"\\n\" , __func__ , mantis->num , ##arg);\t\\\n\t\telse if ((mantis->verbose > MANTIS_DEBUG) && (mantis->verbose > y))\t\t\t\\\n\t\t\tprintk(KERN_DEBUG \"%s (%d): \" format \"\\n\" , __func__ , mantis->num , ##arg);\t\\\n\t\telse if ((mantis->verbose > MANTIS_TMG) && (mantis->verbose > y))\t\t\t\\\n\t\t\tprintk(KERN_DEBUG \"%s (%d): \" format \"\\n\" , __func__ , mantis->num , ##arg);\t\\\n\t} else {\t\t\t\t\t\t\t\t\t\t\t\\\n\t\tif (mantis->verbose > y)\t\t\t\t\t\t\t\t\\\n\t\t\tprintk(format , ##arg);\t\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\t\t\t\\\n} while(0)\n\n#define mwrite(dat, addr)\twritel((dat), addr)\n#define mread(addr)\t\treadl(addr)\n\n#define mmwrite(dat, addr)\tmwrite((dat), (mantis->mmio + (addr)))\n#define mmread(addr)\t\tmread(mantis->mmio + (addr))\n\n#define MANTIS_TS_188\t\t0\n#define MANTIS_TS_204\t\t1\n\n#define TWINHAN_TECHNOLOGIES\t0x1822\n#define MANTIS\t\t\t0x4e35\n\n#define TECHNISAT\t\t0x1ae4\n#define TERRATEC\t\t0x153b\n\n#define MAKE_ENTRY(__subven, __subdev, __configptr, __rc) {\t\t\\\n\t\t.vendor\t\t= TWINHAN_TECHNOLOGIES,\t\t\t\\\n\t\t.device\t\t= MANTIS,\t\t\t\t\\\n\t\t.subvendor\t= (__subven),\t\t\t\t\\\n\t\t.subdevice\t= (__subdev),\t\t\t\t\\\n\t\t.driver_data\t= (unsigned long)\t\t\t\\\n\t\t\t&(struct mantis_pci_drvdata){__configptr, __rc}\t\\\n}\n\nenum mantis_i2c_mode {\n\tMANTIS_PAGE_MODE = 0,\n\tMANTIS_BYTE_MODE,\n};\n\nstruct mantis_pci;\n\nstruct mantis_hwconfig {\n\tchar\t\t\t*model_name;\n\tchar\t\t\t*dev_type;\n\tu32\t\t\tts_size;\n\n\tenum mantis_baud\tbaud_rate;\n\tenum mantis_parity\tparity;\n\tu32\t\t\tbytes;\n\n\tirqreturn_t (*irq_handler)(int irq, void *dev_id);\n\tint (*frontend_init)(struct mantis_pci *mantis, struct dvb_frontend *fe);\n\n\tu8\t\t\tpower;\n\tu8\t\t\treset;\n\n\tenum mantis_i2c_mode\ti2c_mode;\n};\n\nstruct mantis_pci_drvdata {\n\tstruct mantis_hwconfig *hwconfig;\n\tchar *rc_map_name;\n};\n\nstruct mantis_pci {\n\tunsigned int\t\tverbose;\n\n\t \n\tu16\t\t\tvendor_id;\n\tu16\t\t\tdevice_id;\n\tu16\t\t\tsubsystem_vendor;\n\tu16\t\t\tsubsystem_device;\n\n\tu8\t\t\tlatency;\n\n\tstruct pci_dev\t\t*pdev;\n\n\tunsigned long\t\tmantis_addr;\n\tvoid __iomem\t\t*mmio;\n\n\tu8\t\t\tirq;\n\tu8\t\t\trevision;\n\n\tunsigned int\t\tnum;\n\n\t \n\tu32\t\t\tbusy_block;\n\tu32\t\t\tlast_block;\n\tu8\t\t\t*buf_cpu;\n\tdma_addr_t\t\tbuf_dma;\n\t__le32\t\t\t*risc_cpu;\n\tdma_addr_t\t\trisc_dma;\n\n\tstruct tasklet_struct\ttasklet;\n\tspinlock_t\t\tintmask_lock;\n\n\tstruct i2c_adapter\tadapter;\n\tint\t\t\ti2c_rc;\n\twait_queue_head_t\ti2c_wq;\n\tstruct mutex\t\ti2c_lock;\n\n\t \n\tstruct dvb_adapter\tdvb_adapter;\n\tstruct dvb_frontend\t*fe;\n\tstruct dvb_demux\tdemux;\n\tstruct dmxdev\t\tdmxdev;\n\tstruct dmx_frontend\tfe_hw;\n\tstruct dmx_frontend\tfe_mem;\n\tstruct dvb_net\t\tdvbnet;\n\n\tu8\t\t\tfeeds;\n\n\tstruct mantis_hwconfig\t*hwconfig;\n\n\tu32\t\t\tmantis_int_stat;\n\tu32\t\t\tmantis_int_mask;\n\n\t \n\tu8\t\t\tmac_address[8];\n\tu32\t\t\tsub_vendor_id;\n\tu32\t\t\tsub_device_id;\n\n\t  \n\tu32\t\t\tgpio_status;\n\n\tu32\t\t\tgpif_status;\n\n\tstruct mantis_ca\t*mantis_ca;\n\n\tstruct work_struct\tuart_work;\n\n\tstruct rc_dev\t\t*rc;\n\tchar\t\t\tdevice_name[80];\n\tchar\t\t\tinput_phys[80];\n\tchar\t\t\t*rc_map_name;\n};\n\n#define MANTIS_HIF_STATUS\t(mantis->gpio_status)\n\nstatic inline void mantis_mask_ints(struct mantis_pci *mantis, u32 mask)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&mantis->intmask_lock, flags);\n\tmmwrite(mmread(MANTIS_INT_MASK) & ~mask, MANTIS_INT_MASK);\n\tspin_unlock_irqrestore(&mantis->intmask_lock, flags);\n}\n\nstatic inline void mantis_unmask_ints(struct mantis_pci *mantis, u32 mask)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&mantis->intmask_lock, flags);\n\tmmwrite(mmread(MANTIS_INT_MASK) | mask, MANTIS_INT_MASK);\n\tspin_unlock_irqrestore(&mantis->intmask_lock, flags);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}