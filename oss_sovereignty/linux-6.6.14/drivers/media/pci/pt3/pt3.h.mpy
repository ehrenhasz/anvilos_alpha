{
  "module_name": "pt3.h",
  "hash_id": "541af154b59428b81dd89f27727962c4d65356a6deeabf2ce9c94de62cff1cfc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/media/pci/pt3/pt3.h",
  "human_readable_source": " \n \n\n#ifndef PT3_H\n#define PT3_H\n\n#include <linux/atomic.h>\n#include <linux/types.h>\n\n#include <media/dvb_demux.h>\n#include <media/dvb_frontend.h>\n#include <media/dmxdev.h>\n\n#include \"tc90522.h\"\n#include \"mxl301rf.h\"\n#include \"qm1d1c0042.h\"\n\n#define DRV_NAME KBUILD_MODNAME\n\n#define PT3_NUM_FE 4\n\n \n#define REG_VERSION\t0x00\n#define REG_BUS\t\t0x04\n#define REG_SYSTEM_W\t0x08\n#define REG_SYSTEM_R\t0x0c\n#define REG_I2C_W\t0x10\n#define REG_I2C_R\t0x14\n#define REG_RAM_W\t0x18\n#define REG_RAM_R\t0x1c\n#define REG_DMA_BASE\t0x40\t \n#define OFST_DMA_DESC_L\t0x00\n#define OFST_DMA_DESC_H\t0x04\n#define OFST_DMA_CTL\t0x08\n#define OFST_TS_CTL\t0x0c\n#define OFST_STATUS\t0x10\n#define OFST_TS_ERR\t0x14\n\n \n#define PT3_I2C_MAX 4091\nstruct pt3_i2cbuf {\n\tu8  data[PT3_I2C_MAX];\n\tu8  tmp;\n\tu32 num_cmds;\n};\n\n \n#define TS_PACKET_SZ  188\n \n#define DATA_XFER_SZ   4096\n#define DATA_BUF_XFERS 47\n \n#define DATA_BUF_SZ    (DATA_BUF_XFERS * DATA_XFER_SZ)\n#define MAX_DATA_BUFS  16\n#define MIN_DATA_BUFS   2\n\n#define DESCS_IN_PAGE (PAGE_SIZE / sizeof(struct xfer_desc))\n#define MAX_NUM_XFERS (MAX_DATA_BUFS * DATA_BUF_XFERS)\n#define MAX_DESC_BUFS DIV_ROUND_UP(MAX_NUM_XFERS, DESCS_IN_PAGE)\n\n \nstruct xfer_desc {\n\tu32 addr_l;  \n\tu32 addr_h;\n\tu32 size;\n\tu32 next_l;  \n\tu32 next_h;\n};\n\n \nstruct xfer_desc_buffer {\n\tdma_addr_t b_addr;\n\tstruct xfer_desc *descs;  \n};\n\n \nstruct dma_data_buffer {\n\tdma_addr_t b_addr;\n\tu8 *data;  \n};\n\n \nstruct pt3_adap_config {\n\tstruct i2c_board_info demod_info;\n\tstruct tc90522_config demod_cfg;\n\n\tstruct i2c_board_info tuner_info;\n\tunion tuner_config {\n\t\tstruct qm1d1c0042_config qm1d1c0042;\n\t\tstruct mxl301rf_config   mxl301rf;\n\t} tuner_cfg;\n\tu32 init_freq;\n};\n\nstruct pt3_adapter {\n\tstruct dvb_adapter  dvb_adap;   \n\tint adap_idx;\n\n\tstruct dvb_demux    demux;\n\tstruct dmxdev       dmxdev;\n\tstruct dvb_frontend *fe;\n\tstruct i2c_client   *i2c_demod;\n\tstruct i2c_client   *i2c_tuner;\n\n\t \n\tstruct task_struct *thread;\n\tint num_feeds;\n\n\tbool cur_lna;\n\tbool cur_lnb;  \n\n\t \n\tstruct dma_data_buffer buffer[MAX_DATA_BUFS];\n\tint buf_idx;\n\tint buf_ofs;\n\tint num_bufs;   \n\tint num_discard;  \n\n\tstruct xfer_desc_buffer desc_buf[MAX_DESC_BUFS];\n\tint num_desc_bufs;   \n};\n\n\nstruct pt3_board {\n\tstruct pci_dev *pdev;\n\tvoid __iomem *regs[2];\n\t \n\n\tstruct mutex lock;\n\n\t \n\tint lnb_on_cnt;  \n\n\t \n\tint lna_on_cnt;  \n\n\tint num_bufs;   \n\n\tstruct i2c_adapter i2c_adap;\n\tstruct pt3_i2cbuf *i2c_buf;\n\n\tstruct pt3_adapter *adaps[PT3_NUM_FE];\n};\n\n\n \nextern int  pt3_alloc_dmabuf(struct pt3_adapter *adap);\nextern void pt3_init_dmabuf(struct pt3_adapter *adap);\nextern void pt3_free_dmabuf(struct pt3_adapter *adap);\nextern int  pt3_start_dma(struct pt3_adapter *adap);\nextern int  pt3_stop_dma(struct pt3_adapter *adap);\nextern int  pt3_proc_dma(struct pt3_adapter *adap);\n\nextern int  pt3_i2c_master_xfer(struct i2c_adapter *adap,\n\t\t\t\tstruct i2c_msg *msgs, int num);\nextern u32  pt3_i2c_functionality(struct i2c_adapter *adap);\nextern void pt3_i2c_reset(struct pt3_board *pt3);\nextern int  pt3_init_all_demods(struct pt3_board *pt3);\nextern int  pt3_init_all_mxl301rf(struct pt3_board *pt3);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}