{
  "module_name": "amplc_pc263.c",
  "hash_id": "9b17e7a95aa6a816e24b50dcf9b247494e36b3612a1216ed5c24fbe40b4e6bd5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/comedi/drivers/amplc_pc263.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/module.h>\n#include <linux/comedi/comedidev.h>\n\n \n#define PC263_DO_0_7_REG\t0x00\n#define PC263_DO_8_15_REG\t0x01\n\nstruct pc263_board {\n\tconst char *name;\n};\n\nstatic const struct pc263_board pc263_boards[] = {\n\t{\n\t\t.name = \"pc263\",\n\t},\n};\n\nstatic int pc263_do_insn_bits(struct comedi_device *dev,\n\t\t\t      struct comedi_subdevice *s,\n\t\t\t      struct comedi_insn *insn,\n\t\t\t      unsigned int *data)\n{\n\tif (comedi_dio_update_state(s, data)) {\n\t\toutb(s->state & 0xff, dev->iobase + PC263_DO_0_7_REG);\n\t\toutb((s->state >> 8) & 0xff, dev->iobase + PC263_DO_8_15_REG);\n\t}\n\n\tdata[1] = s->state;\n\n\treturn insn->n;\n}\n\nstatic int pc263_attach(struct comedi_device *dev, struct comedi_devconfig *it)\n{\n\tstruct comedi_subdevice *s;\n\tint ret;\n\n\tret = comedi_request_region(dev, it->options[0], 0x2);\n\tif (ret)\n\t\treturn ret;\n\n\tret = comedi_alloc_subdevices(dev, 1);\n\tif (ret)\n\t\treturn ret;\n\n\t \n\ts = &dev->subdevices[0];\n\ts->type\t\t= COMEDI_SUBD_DO;\n\ts->subdev_flags\t= SDF_WRITABLE;\n\ts->n_chan\t= 16;\n\ts->maxdata\t= 1;\n\ts->range_table\t= &range_digital;\n\ts->insn_bits\t= pc263_do_insn_bits;\n\n\t \n\ts->state = inb(dev->iobase + PC263_DO_0_7_REG) |\n\t\t   (inb(dev->iobase + PC263_DO_8_15_REG) << 8);\n\n\treturn 0;\n}\n\nstatic struct comedi_driver amplc_pc263_driver = {\n\t.driver_name\t= \"amplc_pc263\",\n\t.module\t\t= THIS_MODULE,\n\t.attach\t\t= pc263_attach,\n\t.detach\t\t= comedi_legacy_detach,\n\t.board_name\t= &pc263_boards[0].name,\n\t.offset\t\t= sizeof(struct pc263_board),\n\t.num_names\t= ARRAY_SIZE(pc263_boards),\n};\n\nmodule_comedi_driver(amplc_pc263_driver);\n\nMODULE_AUTHOR(\"Comedi https://www.comedi.org\");\nMODULE_DESCRIPTION(\"Comedi driver for Amplicon PC263 relay board\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}