{
  "module_name": "eisa_eeprom.c",
  "hash_id": "f3b6ac954c68d8497f4f305a6bc2d89078c3b70171fe066822a63df5ff31c30a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/parisc/eisa_eeprom.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/miscdevice.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <asm/eisa_eeprom.h>\n\n#define \tEISA_EEPROM_MINOR 241\n\nstatic loff_t eisa_eeprom_llseek(struct file *file, loff_t offset, int origin)\n{\n\treturn fixed_size_llseek(file, offset, origin, HPEE_MAX_LENGTH);\n}\n\nstatic ssize_t eisa_eeprom_read(struct file * file,\n\t\t\t      char __user *buf, size_t count, loff_t *ppos )\n{\n\tunsigned char *tmp;\n\tssize_t ret;\n\tint i;\n\t\n\tif (*ppos < 0 || *ppos >= HPEE_MAX_LENGTH)\n\t\treturn 0;\n\t\n\tcount = *ppos + count < HPEE_MAX_LENGTH ? count : HPEE_MAX_LENGTH - *ppos;\n\ttmp = kmalloc(count, GFP_KERNEL);\n\tif (tmp) {\n\t\tfor (i = 0; i < count; i++)\n\t\t\ttmp[i] = readb(eisa_eeprom_addr+(*ppos)++);\n\n\t\tif (copy_to_user (buf, tmp, count))\n\t\t\tret = -EFAULT;\n\t\telse\n\t\t\tret = count;\n\t\tkfree (tmp);\n\t} else\n\t\tret = -ENOMEM;\n\t\n\treturn ret;\n}\n\nstatic int eisa_eeprom_open(struct inode *inode, struct file *file)\n{\n\tif (file->f_mode & FMODE_WRITE)\n\t\treturn -EINVAL;\n   \n\treturn 0;\n}\n\nstatic int eisa_eeprom_release(struct inode *inode, struct file *file)\n{\n\treturn 0;\n}\n\n \nstatic const struct file_operations eisa_eeprom_fops = {\n\t.owner =\tTHIS_MODULE,\n\t.llseek =\teisa_eeprom_llseek,\n\t.read =\t\teisa_eeprom_read,\n\t.open =\t\teisa_eeprom_open,\n\t.release =\teisa_eeprom_release,\n};\n\nstatic struct miscdevice eisa_eeprom_dev = {\n\tEISA_EEPROM_MINOR,\n\t\"eisa_eeprom\",\n\t&eisa_eeprom_fops\n};\n\nstatic int __init eisa_eeprom_init(void)\n{\n\tint retval;\n\n\tif (!eisa_eeprom_addr)\n\t\treturn -ENODEV;\n\n\tretval = misc_register(&eisa_eeprom_dev);\n\tif (retval < 0) {\n\t\tprintk(KERN_ERR \"EISA EEPROM: cannot register misc device.\\n\");\n\t\treturn retval;\n\t}\n\n\tprintk(KERN_INFO \"EISA EEPROM at 0x%px\\n\", eisa_eeprom_addr);\n\treturn 0;\n}\n\nMODULE_LICENSE(\"GPL\");\n\nmodule_init(eisa_eeprom_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}