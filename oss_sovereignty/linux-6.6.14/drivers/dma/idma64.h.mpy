{
  "module_name": "idma64.h",
  "hash_id": "d1cd675c07734c2f0660ee87c7e1e3c95d838e2010169fa2df800a695b4644bc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dma/idma64.h",
  "human_readable_source": " \n \n\n#ifndef __DMA_IDMA64_H__\n#define __DMA_IDMA64_H__\n\n#include <linux/device.h>\n#include <linux/io.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n\n#include <linux/io-64-nonatomic-lo-hi.h>\n\n#include \"virt-dma.h\"\n\n \n\n#define IDMA64_CH_SAR\t\t0x00\t \n#define IDMA64_CH_DAR\t\t0x08\t \n#define IDMA64_CH_LLP\t\t0x10\t \n#define IDMA64_CH_CTL_LO\t0x18\t \n#define IDMA64_CH_CTL_HI\t0x1c\t \n#define IDMA64_CH_SSTAT\t\t0x20\n#define IDMA64_CH_DSTAT\t\t0x28\n#define IDMA64_CH_SSTATAR\t0x30\n#define IDMA64_CH_DSTATAR\t0x38\n#define IDMA64_CH_CFG_LO\t0x40\t \n#define IDMA64_CH_CFG_HI\t0x44\t \n#define IDMA64_CH_SGR\t\t0x48\n#define IDMA64_CH_DSR\t\t0x50\n\n#define IDMA64_CH_LENGTH\t0x58\n\n \n#define IDMA64C_CTLL_INT_EN\t\t(1 << 0)\t \n#define IDMA64C_CTLL_DST_WIDTH(x)\t((x) << 1)\t \n#define IDMA64C_CTLL_SRC_WIDTH(x)\t((x) << 4)\n#define IDMA64C_CTLL_DST_INC\t\t(0 << 8)\t \n#define IDMA64C_CTLL_DST_FIX\t\t(1 << 8)\n#define IDMA64C_CTLL_SRC_INC\t\t(0 << 10)\t \n#define IDMA64C_CTLL_SRC_FIX\t\t(1 << 10)\n#define IDMA64C_CTLL_DST_MSIZE(x)\t((x) << 11)\t \n#define IDMA64C_CTLL_SRC_MSIZE(x)\t((x) << 14)\n#define IDMA64C_CTLL_FC_M2P\t\t(1 << 20)\t \n#define IDMA64C_CTLL_FC_P2M\t\t(2 << 20)\t \n#define IDMA64C_CTLL_LLP_D_EN\t\t(1 << 27)\t \n#define IDMA64C_CTLL_LLP_S_EN\t\t(1 << 28)\t \n\n \n#define IDMA64C_CTLH_BLOCK_TS_MASK\t((1 << 17) - 1)\n#define IDMA64C_CTLH_BLOCK_TS(x)\t((x) & IDMA64C_CTLH_BLOCK_TS_MASK)\n#define IDMA64C_CTLH_DONE\t\t(1 << 17)\n\n \n#define IDMA64C_CFGL_DST_BURST_ALIGN\t(1 << 0)\t \n#define IDMA64C_CFGL_SRC_BURST_ALIGN\t(1 << 1)\t \n#define IDMA64C_CFGL_CH_SUSP\t\t(1 << 8)\n#define IDMA64C_CFGL_FIFO_EMPTY\t\t(1 << 9)\n#define IDMA64C_CFGL_CH_DRAIN\t\t(1 << 10)\t \n#define IDMA64C_CFGL_DST_OPT_BL\t\t(1 << 20)\t \n#define IDMA64C_CFGL_SRC_OPT_BL\t\t(1 << 21)\t \n\n \n#define IDMA64C_CFGH_SRC_PER(x)\t\t((x) << 0)\t \n#define IDMA64C_CFGH_DST_PER(x)\t\t((x) << 4)\t \n#define IDMA64C_CFGH_RD_ISSUE_THD(x)\t((x) << 8)\n#define IDMA64C_CFGH_WR_ISSUE_THD(x)\t((x) << 18)\n\n \n\n#define IDMA64_INT_XFER\t\t0x00\n#define IDMA64_INT_BLOCK\t0x08\n#define IDMA64_INT_SRC_TRAN\t0x10\n#define IDMA64_INT_DST_TRAN\t0x18\n#define IDMA64_INT_ERROR\t0x20\n\n#define IDMA64_RAW(x)\t\t(0x2c0 + IDMA64_INT_##x)\t \n#define IDMA64_STATUS(x)\t(0x2e8 + IDMA64_INT_##x)\t \n#define IDMA64_MASK(x)\t\t(0x310 + IDMA64_INT_##x)\t \n#define IDMA64_CLEAR(x)\t\t(0x338 + IDMA64_INT_##x)\t \n\n \n\n#define IDMA64_STATUS_INT\t0x360\t \n#define IDMA64_CFG\t\t0x398\n#define IDMA64_CH_EN\t\t0x3a0\n\n \n#define IDMA64_CFG_DMA_EN\t\t(1 << 0)\n\n \nstruct idma64_lli {\n\tu64\t\tsar;\n\tu64\t\tdar;\n\tu64\t\tllp;\n\tu32\t\tctllo;\n\tu32\t\tctlhi;\n\tu32\t\tsstat;\n\tu32\t\tdstat;\n};\n\nstruct idma64_hw_desc {\n\tstruct idma64_lli *lli;\n\tdma_addr_t llp;\n\tdma_addr_t phys;\n\tunsigned int len;\n};\n\nstruct idma64_desc {\n\tstruct virt_dma_desc vdesc;\n\tenum dma_transfer_direction direction;\n\tstruct idma64_hw_desc *hw;\n\tunsigned int ndesc;\n\tsize_t length;\n\tenum dma_status status;\n};\n\nstatic inline struct idma64_desc *to_idma64_desc(struct virt_dma_desc *vdesc)\n{\n\treturn container_of(vdesc, struct idma64_desc, vdesc);\n}\n\nstruct idma64_chan {\n\tstruct virt_dma_chan vchan;\n\n\tvoid __iomem *regs;\n\n\t \n\tenum dma_transfer_direction direction;\n\tunsigned int mask;\n\tstruct dma_slave_config config;\n\n\tvoid *pool;\n\tstruct idma64_desc *desc;\n};\n\nstatic inline struct idma64_chan *to_idma64_chan(struct dma_chan *chan)\n{\n\treturn container_of(chan, struct idma64_chan, vchan.chan);\n}\n\n#define channel_set_bit(idma64, reg, mask)\t\\\n\tdma_writel(idma64, reg, ((mask) << 8) | (mask))\n#define channel_clear_bit(idma64, reg, mask)\t\\\n\tdma_writel(idma64, reg, ((mask) << 8) | 0)\n\nstatic inline u32 idma64c_readl(struct idma64_chan *idma64c, int offset)\n{\n\treturn readl(idma64c->regs + offset);\n}\n\nstatic inline void idma64c_writel(struct idma64_chan *idma64c, int offset,\n\t\t\t\t  u32 value)\n{\n\twritel(value, idma64c->regs + offset);\n}\n\n#define channel_readl(idma64c, reg)\t\t\\\n\tidma64c_readl(idma64c, IDMA64_CH_##reg)\n#define channel_writel(idma64c, reg, value)\t\\\n\tidma64c_writel(idma64c, IDMA64_CH_##reg, (value))\n\nstatic inline u64 idma64c_readq(struct idma64_chan *idma64c, int offset)\n{\n\treturn lo_hi_readq(idma64c->regs + offset);\n}\n\nstatic inline void idma64c_writeq(struct idma64_chan *idma64c, int offset,\n\t\t\t\t  u64 value)\n{\n\tlo_hi_writeq(value, idma64c->regs + offset);\n}\n\n#define channel_readq(idma64c, reg)\t\t\\\n\tidma64c_readq(idma64c, IDMA64_CH_##reg)\n#define channel_writeq(idma64c, reg, value)\t\\\n\tidma64c_writeq(idma64c, IDMA64_CH_##reg, (value))\n\nstruct idma64 {\n\tstruct dma_device dma;\n\n\tvoid __iomem *regs;\n\n\t \n\tunsigned short all_chan_mask;\n\tstruct idma64_chan *chan;\n};\n\nstatic inline struct idma64 *to_idma64(struct dma_device *ddev)\n{\n\treturn container_of(ddev, struct idma64, dma);\n}\n\nstatic inline u32 idma64_readl(struct idma64 *idma64, int offset)\n{\n\treturn readl(idma64->regs + offset);\n}\n\nstatic inline void idma64_writel(struct idma64 *idma64, int offset, u32 value)\n{\n\twritel(value, idma64->regs + offset);\n}\n\n#define dma_readl(idma64, reg)\t\t\t\\\n\tidma64_readl(idma64, IDMA64_##reg)\n#define dma_writel(idma64, reg, value)\t\t\\\n\tidma64_writel(idma64, IDMA64_##reg, (value))\n\n \nstruct idma64_chip {\n\tstruct device\t*dev;\n\tstruct device\t*sysdev;\n\tint\t\tirq;\n\tvoid __iomem\t*regs;\n\tstruct idma64\t*idma64;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}