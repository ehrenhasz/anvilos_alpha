{
  "module_name": "registers.h",
  "hash_id": "4d38b01cecf74ceeca5d0fa8e95b57d4c9de3aaf90cb04dcfa1b88490882d80d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dma/idxd/registers.h",
  "human_readable_source": " \n \n#ifndef _IDXD_REGISTERS_H_\n#define _IDXD_REGISTERS_H_\n\n#include <uapi/linux/idxd.h>\n\n \n#define PCI_DEVICE_ID_INTEL_DSA_SPR0\t0x0b25\n#define PCI_DEVICE_ID_INTEL_IAX_SPR0\t0x0cfe\n\n#define DEVICE_VERSION_1\t\t0x100\n#define DEVICE_VERSION_2\t\t0x200\n\n#define IDXD_MMIO_BAR\t\t0\n#define IDXD_WQ_BAR\t\t2\n#define IDXD_PORTAL_SIZE\tPAGE_SIZE\n\n \n#define IDXD_VER_OFFSET\t\t\t0x00\n#define IDXD_VER_MAJOR_MASK\t\t0xf0\n#define IDXD_VER_MINOR_MASK\t\t0x0f\n#define GET_IDXD_VER_MAJOR(x)\t\t(((x) & IDXD_VER_MAJOR_MASK) >> 4)\n#define GET_IDXD_VER_MINOR(x)\t\t((x) & IDXD_VER_MINOR_MASK)\n\nunion gen_cap_reg {\n\tstruct {\n\t\tu64 block_on_fault:1;\n\t\tu64 overlap_copy:1;\n\t\tu64 cache_control_mem:1;\n\t\tu64 cache_control_cache:1;\n\t\tu64 cmd_cap:1;\n\t\tu64 rsvd:3;\n\t\tu64 dest_readback:1;\n\t\tu64 drain_readback:1;\n\t\tu64 rsvd2:3;\n\t\tu64 evl_support:2;\n\t\tu64 batch_continuation:1;\n\t\tu64 max_xfer_shift:5;\n\t\tu64 max_batch_shift:4;\n\t\tu64 max_ims_mult:6;\n\t\tu64 config_en:1;\n\t\tu64 rsvd3:32;\n\t};\n\tu64 bits;\n} __packed;\n#define IDXD_GENCAP_OFFSET\t\t0x10\n\nunion wq_cap_reg {\n\tstruct {\n\t\tu64 total_wq_size:16;\n\t\tu64 num_wqs:8;\n\t\tu64 wqcfg_size:4;\n\t\tu64 rsvd:20;\n\t\tu64 shared_mode:1;\n\t\tu64 dedicated_mode:1;\n\t\tu64 wq_ats_support:1;\n\t\tu64 priority:1;\n\t\tu64 occupancy:1;\n\t\tu64 occupancy_int:1;\n\t\tu64 op_config:1;\n\t\tu64 wq_prs_support:1;\n\t\tu64 rsvd4:8;\n\t};\n\tu64 bits;\n} __packed;\n#define IDXD_WQCAP_OFFSET\t\t0x20\n#define IDXD_WQCFG_MIN\t\t\t5\n\nunion group_cap_reg {\n\tstruct {\n\t\tu64 num_groups:8;\n\t\tu64 total_rdbufs:8;\t \n\t\tu64 rdbuf_ctrl:1;\t \n\t\tu64 rdbuf_limit:1;\t \n\t\tu64 progress_limit:1;\t \n\t\tu64 rsvd:45;\n\t};\n\tu64 bits;\n} __packed;\n#define IDXD_GRPCAP_OFFSET\t\t0x30\n\nunion engine_cap_reg {\n\tstruct {\n\t\tu64 num_engines:8;\n\t\tu64 rsvd:56;\n\t};\n\tu64 bits;\n} __packed;\n\n#define IDXD_ENGCAP_OFFSET\t\t0x38\n\n#define IDXD_OPCAP_NOOP\t\t\t0x0001\n#define IDXD_OPCAP_BATCH\t\t\t0x0002\n#define IDXD_OPCAP_MEMMOVE\t\t0x0008\nstruct opcap {\n\tu64 bits[4];\n};\n\n#define IDXD_MAX_OPCAP_BITS\t\t256U\n\n#define IDXD_OPCAP_OFFSET\t\t0x40\n\n#define IDXD_TABLE_OFFSET\t\t0x60\nunion offsets_reg {\n\tstruct {\n\t\tu64 grpcfg:16;\n\t\tu64 wqcfg:16;\n\t\tu64 msix_perm:16;\n\t\tu64 ims:16;\n\t\tu64 perfmon:16;\n\t\tu64 rsvd:48;\n\t};\n\tu64 bits[2];\n} __packed;\n\n#define IDXD_TABLE_MULT\t\t\t0x100\n\n#define IDXD_GENCFG_OFFSET\t\t0x80\nunion gencfg_reg {\n\tstruct {\n\t\tu32 rdbuf_limit:8;\n\t\tu32 rsvd:4;\n\t\tu32 user_int_en:1;\n\t\tu32 evl_en:1;\n\t\tu32 rsvd2:18;\n\t};\n\tu32 bits;\n} __packed;\n\n#define IDXD_GENCTRL_OFFSET\t\t0x88\nunion genctrl_reg {\n\tstruct {\n\t\tu32 softerr_int_en:1;\n\t\tu32 halt_int_en:1;\n\t\tu32 evl_int_en:1;\n\t\tu32 rsvd:29;\n\t};\n\tu32 bits;\n} __packed;\n\n#define IDXD_GENSTATS_OFFSET\t\t0x90\nunion gensts_reg {\n\tstruct {\n\t\tu32 state:2;\n\t\tu32 reset_type:2;\n\t\tu32 rsvd:28;\n\t};\n\tu32 bits;\n} __packed;\n\nenum idxd_device_status_state {\n\tIDXD_DEVICE_STATE_DISABLED = 0,\n\tIDXD_DEVICE_STATE_ENABLED,\n\tIDXD_DEVICE_STATE_DRAIN,\n\tIDXD_DEVICE_STATE_HALT,\n};\n\nenum idxd_device_reset_type {\n\tIDXD_DEVICE_RESET_SOFTWARE = 0,\n\tIDXD_DEVICE_RESET_FLR,\n\tIDXD_DEVICE_RESET_WARM,\n\tIDXD_DEVICE_RESET_COLD,\n};\n\n#define IDXD_INTCAUSE_OFFSET\t\t0x98\n#define IDXD_INTC_ERR\t\t\t0x01\n#define IDXD_INTC_CMD\t\t\t0x02\n#define IDXD_INTC_OCCUPY\t\t\t0x04\n#define IDXD_INTC_PERFMON_OVFL\t\t0x08\n#define IDXD_INTC_HALT_STATE\t\t0x10\n#define IDXD_INTC_EVL\t\t\t0x20\n#define IDXD_INTC_INT_HANDLE_REVOKED\t0x80000000\n\n#define IDXD_CMD_OFFSET\t\t\t0xa0\nunion idxd_command_reg {\n\tstruct {\n\t\tu32 operand:20;\n\t\tu32 cmd:5;\n\t\tu32 rsvd:6;\n\t\tu32 int_req:1;\n\t};\n\tu32 bits;\n} __packed;\n\nenum idxd_cmd {\n\tIDXD_CMD_ENABLE_DEVICE = 1,\n\tIDXD_CMD_DISABLE_DEVICE,\n\tIDXD_CMD_DRAIN_ALL,\n\tIDXD_CMD_ABORT_ALL,\n\tIDXD_CMD_RESET_DEVICE,\n\tIDXD_CMD_ENABLE_WQ,\n\tIDXD_CMD_DISABLE_WQ,\n\tIDXD_CMD_DRAIN_WQ,\n\tIDXD_CMD_ABORT_WQ,\n\tIDXD_CMD_RESET_WQ,\n\tIDXD_CMD_DRAIN_PASID,\n\tIDXD_CMD_ABORT_PASID,\n\tIDXD_CMD_REQUEST_INT_HANDLE,\n\tIDXD_CMD_RELEASE_INT_HANDLE,\n};\n\n#define CMD_INT_HANDLE_IMS\t\t0x10000\n\n#define IDXD_CMDSTS_OFFSET\t\t0xa8\nunion cmdsts_reg {\n\tstruct {\n\t\tu8 err;\n\t\tu16 result;\n\t\tu8 rsvd:7;\n\t\tu8 active:1;\n\t};\n\tu32 bits;\n} __packed;\n#define IDXD_CMDSTS_ACTIVE\t\t0x80000000\n#define IDXD_CMDSTS_ERR_MASK\t\t0xff\n#define IDXD_CMDSTS_RES_SHIFT\t\t8\n\nenum idxd_cmdsts_err {\n\tIDXD_CMDSTS_SUCCESS = 0,\n\tIDXD_CMDSTS_INVAL_CMD,\n\tIDXD_CMDSTS_INVAL_WQIDX,\n\tIDXD_CMDSTS_HW_ERR,\n\t \n\tIDXD_CMDSTS_ERR_DEV_ENABLED = 0x10,\n\tIDXD_CMDSTS_ERR_CONFIG,\n\tIDXD_CMDSTS_ERR_BUSMASTER_EN,\n\tIDXD_CMDSTS_ERR_PASID_INVAL,\n\tIDXD_CMDSTS_ERR_WQ_SIZE_ERANGE,\n\tIDXD_CMDSTS_ERR_GRP_CONFIG,\n\tIDXD_CMDSTS_ERR_GRP_CONFIG2,\n\tIDXD_CMDSTS_ERR_GRP_CONFIG3,\n\tIDXD_CMDSTS_ERR_GRP_CONFIG4,\n\t \n\tIDXD_CMDSTS_ERR_DEV_NOTEN = 0x20,\n\tIDXD_CMDSTS_ERR_WQ_ENABLED,\n\tIDXD_CMDSTS_ERR_WQ_SIZE,\n\tIDXD_CMDSTS_ERR_WQ_PRIOR,\n\tIDXD_CMDSTS_ERR_WQ_MODE,\n\tIDXD_CMDSTS_ERR_BOF_EN,\n\tIDXD_CMDSTS_ERR_PASID_EN,\n\tIDXD_CMDSTS_ERR_MAX_BATCH_SIZE,\n\tIDXD_CMDSTS_ERR_MAX_XFER_SIZE,\n\t \n\tIDXD_CMDSTS_ERR_DIS_DEV_EN = 0x31,\n\t \n\tIDXD_CMDSTS_ERR_DEV_NOT_EN,\n\t \n\tIDXD_CMDSTS_ERR_INVAL_INT_IDX = 0x41,\n\tIDXD_CMDSTS_ERR_NO_HANDLE,\n};\n\n#define IDXD_CMDCAP_OFFSET\t\t0xb0\n\n#define IDXD_SWERR_OFFSET\t\t0xc0\n#define IDXD_SWERR_VALID\t\t0x00000001\n#define IDXD_SWERR_OVERFLOW\t\t0x00000002\n#define IDXD_SWERR_ACK\t\t\t(IDXD_SWERR_VALID | IDXD_SWERR_OVERFLOW)\nunion sw_err_reg {\n\tstruct {\n\t\tu64 valid:1;\n\t\tu64 overflow:1;\n\t\tu64 desc_valid:1;\n\t\tu64 wq_idx_valid:1;\n\t\tu64 batch:1;\n\t\tu64 fault_rw:1;\n\t\tu64 priv:1;\n\t\tu64 rsvd:1;\n\t\tu64 error:8;\n\t\tu64 wq_idx:8;\n\t\tu64 rsvd2:8;\n\t\tu64 operation:8;\n\t\tu64 pasid:20;\n\t\tu64 rsvd3:4;\n\n\t\tu64 batch_idx:16;\n\t\tu64 rsvd4:16;\n\t\tu64 invalid_flags:32;\n\n\t\tu64 fault_addr;\n\n\t\tu64 rsvd5;\n\t};\n\tu64 bits[4];\n} __packed;\n\nunion iaa_cap_reg {\n\tstruct {\n\t\tu64 dec_aecs_format_ver:1;\n\t\tu64 drop_init_bits:1;\n\t\tu64 chaining:1;\n\t\tu64 force_array_output_mod:1;\n\t\tu64 load_part_aecs:1;\n\t\tu64 comp_early_abort:1;\n\t\tu64 nested_comp:1;\n\t\tu64 diction_comp:1;\n\t\tu64 header_gen:1;\n\t\tu64 crypto_gcm:1;\n\t\tu64 crypto_cfb:1;\n\t\tu64 crypto_xts:1;\n\t\tu64 rsvd:52;\n\t};\n\tu64 bits;\n} __packed;\n\n#define IDXD_IAACAP_OFFSET\t0x180\n\n#define IDXD_EVLCFG_OFFSET\t0xe0\nunion evlcfg_reg {\n\tstruct {\n\t\tu64 pasid_en:1;\n\t\tu64 priv:1;\n\t\tu64 rsvd:10;\n\t\tu64 base_addr:52;\n\n\t\tu64 size:16;\n\t\tu64 pasid:20;\n\t\tu64 rsvd2:28;\n\t};\n\tu64 bits[2];\n} __packed;\n\n#define IDXD_EVL_SIZE_MIN\t0x0040\n#define IDXD_EVL_SIZE_MAX\t0xffff\n\nunion msix_perm {\n\tstruct {\n\t\tu32 rsvd:2;\n\t\tu32 ignore:1;\n\t\tu32 pasid_en:1;\n\t\tu32 rsvd2:8;\n\t\tu32 pasid:20;\n\t};\n\tu32 bits;\n} __packed;\n\nunion group_flags {\n\tstruct {\n\t\tu64 tc_a:3;\n\t\tu64 tc_b:3;\n\t\tu64 rsvd:1;\n\t\tu64 use_rdbuf_limit:1;\n\t\tu64 rdbufs_reserved:8;\n\t\tu64 rsvd2:4;\n\t\tu64 rdbufs_allowed:8;\n\t\tu64 rsvd3:4;\n\t\tu64 desc_progress_limit:2;\n\t\tu64 rsvd4:2;\n\t\tu64 batch_progress_limit:2;\n\t\tu64 rsvd5:26;\n\t};\n\tu64 bits;\n} __packed;\n\nstruct grpcfg {\n\tu64 wqs[4];\n\tu64 engines;\n\tunion group_flags flags;\n} __packed;\n\nunion wqcfg {\n\tstruct {\n\t\t \n\t\tu16 wq_size;\n\t\tu16 rsvd;\n\n\t\t \n\t\tu16 wq_thresh;\n\t\tu16 rsvd1;\n\n\t\t \n\t\tu32 mode:1;\t \n\t\tu32 bof:1;\t \n\t\tu32 wq_ats_disable:1;\n\t\tu32 wq_prs_disable:1;\n\t\tu32 priority:4;\n\t\tu32 pasid:20;\n\t\tu32 pasid_en:1;\n\t\tu32 priv:1;\n\t\tu32 rsvd3:2;\n\n\t\t \n\t\tu32 max_xfer_shift:5;\n\t\tu32 max_batch_shift:4;\n\t\tu32 rsvd4:23;\n\n\t\t \n\t\tu16 occupancy_inth;\n\t\tu16 occupancy_table_sel:1;\n\t\tu16 rsvd5:15;\n\n\t\t \n\t\tu16 occupancy_limit;\n\t\tu16 occupancy_int_en:1;\n\t\tu16 rsvd6:15;\n\n\t\t \n\t\tu16 occupancy;\n\t\tu16 occupancy_int:1;\n\t\tu16 rsvd7:12;\n\t\tu16 mode_support:1;\n\t\tu16 wq_state:2;\n\n\t\t \n\t\tu32 rsvd8;\n\n\t\t \n\t\tu64 op_config[4];\n\t};\n\tu32 bits[16];\n} __packed;\n\n#define WQCFG_PASID_IDX                2\n#define WQCFG_PRIVL_IDX\t\t2\n#define WQCFG_OCCUP_IDX\t\t6\n\n#define WQCFG_OCCUP_MASK\t0xffff\n\n \n#define WQCFG_OFFSET(_idxd_dev, n, ofs) \\\n({\\\n\ttypeof(_idxd_dev) __idxd_dev = (_idxd_dev);\t\\\n\t(__idxd_dev)->wqcfg_offset + (n) * (__idxd_dev)->wqcfg_size + sizeof(u32) * (ofs);\t\\\n})\n\n#define WQCFG_STRIDES(_idxd_dev) ((_idxd_dev)->wqcfg_size / sizeof(u32))\n\n#define GRPCFG_SIZE\t\t64\n#define GRPWQCFG_STRIDES\t4\n\n \n#define GRPWQCFG_OFFSET(idxd_dev, n, ofs) ((idxd_dev)->grpcfg_offset +\\\n\t\t\t\t\t   (n) * GRPCFG_SIZE + sizeof(u64) * (ofs))\n#define GRPENGCFG_OFFSET(idxd_dev, n) ((idxd_dev)->grpcfg_offset + (n) * GRPCFG_SIZE + 32)\n#define GRPFLGCFG_OFFSET(idxd_dev, n) ((idxd_dev)->grpcfg_offset + (n) * GRPCFG_SIZE + 40)\n\n \n#define IDXD_PERFCAP_OFFSET\t\t0x0\nunion idxd_perfcap {\n\tstruct {\n\t\tu64 num_perf_counter:6;\n\t\tu64 rsvd1:2;\n\t\tu64 counter_width:8;\n\t\tu64 num_event_category:4;\n\t\tu64 global_event_category:16;\n\t\tu64 filter:8;\n\t\tu64 rsvd2:8;\n\t\tu64 cap_per_counter:1;\n\t\tu64 writeable_counter:1;\n\t\tu64 counter_freeze:1;\n\t\tu64 overflow_interrupt:1;\n\t\tu64 rsvd3:8;\n\t};\n\tu64 bits;\n} __packed;\n\n#define IDXD_EVNTCAP_OFFSET\t\t0x80\nunion idxd_evntcap {\n\tstruct {\n\t\tu64 events:28;\n\t\tu64 rsvd:36;\n\t};\n\tu64 bits;\n} __packed;\n\nstruct idxd_event {\n\tunion {\n\t\tstruct {\n\t\t\tu32 event_category:4;\n\t\t\tu32 events:28;\n\t\t};\n\t\tu32 val;\n\t};\n} __packed;\n\n#define IDXD_CNTRCAP_OFFSET\t\t0x800\nstruct idxd_cntrcap {\n\tunion {\n\t\tstruct {\n\t\t\tu32 counter_width:8;\n\t\t\tu32 rsvd:20;\n\t\t\tu32 num_events:4;\n\t\t};\n\t\tu32 val;\n\t};\n\tstruct idxd_event events[];\n} __packed;\n\n#define IDXD_PERFRST_OFFSET\t\t0x10\nunion idxd_perfrst {\n\tstruct {\n\t\tu32 perfrst_config:1;\n\t\tu32 perfrst_counter:1;\n\t\tu32 rsvd:30;\n\t};\n\tu32 val;\n} __packed;\n\n#define IDXD_OVFSTATUS_OFFSET\t\t0x30\n#define IDXD_PERFFRZ_OFFSET\t\t0x20\n#define IDXD_CNTRCFG_OFFSET\t\t0x100\nunion idxd_cntrcfg {\n\tstruct {\n\t\tu64 enable:1;\n\t\tu64 interrupt_ovf:1;\n\t\tu64 global_freeze_ovf:1;\n\t\tu64 rsvd1:5;\n\t\tu64 event_category:4;\n\t\tu64 rsvd2:20;\n\t\tu64 events:28;\n\t\tu64 rsvd3:4;\n\t};\n\tu64 val;\n} __packed;\n\n#define IDXD_FLTCFG_OFFSET\t\t0x300\n\n#define IDXD_CNTRDATA_OFFSET\t\t0x200\nunion idxd_cntrdata {\n\tstruct {\n\t\tu64 event_count_value;\n\t};\n\tu64 val;\n} __packed;\n\nunion event_cfg {\n\tstruct {\n\t\tu64 event_cat:4;\n\t\tu64 event_enc:28;\n\t};\n\tu64 val;\n} __packed;\n\nunion filter_cfg {\n\tstruct {\n\t\tu64 wq:32;\n\t\tu64 tc:8;\n\t\tu64 pg_sz:4;\n\t\tu64 xfer_sz:8;\n\t\tu64 eng:8;\n\t};\n\tu64 val;\n} __packed;\n\n#define IDXD_EVLSTATUS_OFFSET\t\t0xf0\n\nunion evl_status_reg {\n\tstruct {\n\t\tu32 head:16;\n\t\tu32 rsvd:16;\n\t\tu32 tail:16;\n\t\tu32 rsvd2:14;\n\t\tu32 int_pending:1;\n\t\tu32 rsvd3:1;\n\t};\n\tstruct {\n\t\tu32 bits_lower32;\n\t\tu32 bits_upper32;\n\t};\n\tu64 bits;\n} __packed;\n\n#define IDXD_MAX_BATCH_IDENT\t256\n\nstruct __evl_entry {\n\tu64 rsvd:2;\n\tu64 desc_valid:1;\n\tu64 wq_idx_valid:1;\n\tu64 batch:1;\n\tu64 fault_rw:1;\n\tu64 priv:1;\n\tu64 err_info_valid:1;\n\tu64 error:8;\n\tu64 wq_idx:8;\n\tu64 batch_id:8;\n\tu64 operation:8;\n\tu64 pasid:20;\n\tu64 rsvd2:4;\n\n\tu16 batch_idx;\n\tu16 rsvd3;\n\tunion {\n\t\t \n\t\tu32 invalid_flags;\n\t\t \n\t\t \n\t\t \n\t\t \n\t\tstruct {\n\t\t\tu16 int_handle;\n\t\t\tu16 rci:1;\n\t\t\tu16 ims:1;\n\t\t\tu16 rcr:1;\n\t\t\tu16 first_err_in_batch:1;\n\t\t\tu16 rsvd4_2:9;\n\t\t\tu16 operand_id:3;\n\t\t};\n\t};\n\tu64 fault_addr;\n\tu64 rsvd5;\n} __packed;\n\nstruct dsa_evl_entry {\n\tstruct __evl_entry e;\n\tstruct dsa_completion_record cr;\n} __packed;\n\nstruct iax_evl_entry {\n\tstruct __evl_entry e;\n\tu64 rsvd[4];\n\tstruct iax_completion_record cr;\n} __packed;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}