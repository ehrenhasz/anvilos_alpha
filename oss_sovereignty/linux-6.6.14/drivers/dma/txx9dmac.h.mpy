{
  "module_name": "txx9dmac.h",
  "hash_id": "2e26aaf779283236be7466c8188ec9414410cfcd79fb8896b9f3ea79fb58d0d8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dma/txx9dmac.h",
  "human_readable_source": " \n \n#ifndef TXX9DMAC_H\n#define TXX9DMAC_H\n\n#include <linux/dmaengine.h>\n#include <asm/txx9/dmac.h>\n\n \n\n#ifdef CONFIG_MACH_TX49XX\nstatic inline bool txx9_dma_have_SMPCHN(void)\n{\n\treturn true;\n}\n#define TXX9_DMA_USE_SIMPLE_CHAIN\n#else\nstatic inline bool txx9_dma_have_SMPCHN(void)\n{\n\treturn false;\n}\n#endif\n\n#ifdef __LITTLE_ENDIAN\n#ifdef CONFIG_MACH_TX49XX\n#define CCR_LE\tTXX9_DMA_CCR_LE\n#define MCR_LE\t0\n#else\n#define CCR_LE\t0\n#define MCR_LE\tTXX9_DMA_MCR_LE\n#endif\n#else\n#define CCR_LE\t0\n#define MCR_LE\t0\n#endif\n\n \n#ifdef __BIG_ENDIAN\n#define TXX9_DMA_REG32(name)\t\tu32 __pad_##name; u32 name\n#else\n#define TXX9_DMA_REG32(name)\t\tu32 name; u32 __pad_##name\n#endif\n\n \nstruct txx9dmac_cregs {\n#if defined(CONFIG_32BIT) && !defined(CONFIG_PHYS_ADDR_T_64BIT)\n\tTXX9_DMA_REG32(CHAR);\t \n#else\n\tu64 CHAR;\t\t \n#endif\n\tu64 SAR;\t\t \n\tu64 DAR;\t\t \n\tTXX9_DMA_REG32(CNTR);\t \n\tTXX9_DMA_REG32(SAIR);\t \n\tTXX9_DMA_REG32(DAIR);\t \n\tTXX9_DMA_REG32(CCR);\t \n\tTXX9_DMA_REG32(CSR);\t \n};\nstruct txx9dmac_cregs32 {\n\tu32 CHAR;\n\tu32 SAR;\n\tu32 DAR;\n\tu32 CNTR;\n\tu32 SAIR;\n\tu32 DAIR;\n\tu32 CCR;\n\tu32 CSR;\n};\n\nstruct txx9dmac_regs {\n\t \n\tstruct txx9dmac_cregs\tCHAN[TXX9_DMA_MAX_NR_CHANNELS];\n\tu64\t__pad[9];\n\tu64\tMFDR;\t\t \n\tTXX9_DMA_REG32(MCR);\t \n};\nstruct txx9dmac_regs32 {\n\tstruct txx9dmac_cregs32\tCHAN[TXX9_DMA_MAX_NR_CHANNELS];\n\tu32\t__pad[9];\n\tu32\tMFDR;\n\tu32\tMCR;\n};\n\n \n#define TXX9_DMA_MCR_EIS(ch)\t(0x10000000<<(ch))\n#define TXX9_DMA_MCR_DIS(ch)\t(0x01000000<<(ch))\n#define TXX9_DMA_MCR_RSFIF\t0x00000080\n#define TXX9_DMA_MCR_FIFUM(ch)\t(0x00000008<<(ch))\n#define TXX9_DMA_MCR_LE\t\t0x00000004\n#define TXX9_DMA_MCR_RPRT\t0x00000002\n#define TXX9_DMA_MCR_MSTEN\t0x00000001\n\n \n#define TXX9_DMA_CCR_IMMCHN\t0x20000000\n#define TXX9_DMA_CCR_USEXFSZ\t0x10000000\n#define TXX9_DMA_CCR_LE\t\t0x08000000\n#define TXX9_DMA_CCR_DBINH\t0x04000000\n#define TXX9_DMA_CCR_SBINH\t0x02000000\n#define TXX9_DMA_CCR_CHRST\t0x01000000\n#define TXX9_DMA_CCR_RVBYTE\t0x00800000\n#define TXX9_DMA_CCR_ACKPOL\t0x00400000\n#define TXX9_DMA_CCR_REQPL\t0x00200000\n#define TXX9_DMA_CCR_EGREQ\t0x00100000\n#define TXX9_DMA_CCR_CHDN\t0x00080000\n#define TXX9_DMA_CCR_DNCTL\t0x00060000\n#define TXX9_DMA_CCR_EXTRQ\t0x00010000\n#define TXX9_DMA_CCR_INTRQD\t0x0000e000\n#define TXX9_DMA_CCR_INTENE\t0x00001000\n#define TXX9_DMA_CCR_INTENC\t0x00000800\n#define TXX9_DMA_CCR_INTENT\t0x00000400\n#define TXX9_DMA_CCR_CHNEN\t0x00000200\n#define TXX9_DMA_CCR_XFACT\t0x00000100\n#define TXX9_DMA_CCR_SMPCHN\t0x00000020\n#define TXX9_DMA_CCR_XFSZ(order)\t(((order) << 2) & 0x0000001c)\n#define TXX9_DMA_CCR_XFSZ_1\tTXX9_DMA_CCR_XFSZ(0)\n#define TXX9_DMA_CCR_XFSZ_2\tTXX9_DMA_CCR_XFSZ(1)\n#define TXX9_DMA_CCR_XFSZ_4\tTXX9_DMA_CCR_XFSZ(2)\n#define TXX9_DMA_CCR_XFSZ_8\tTXX9_DMA_CCR_XFSZ(3)\n#define TXX9_DMA_CCR_XFSZ_X4\tTXX9_DMA_CCR_XFSZ(4)\n#define TXX9_DMA_CCR_XFSZ_X8\tTXX9_DMA_CCR_XFSZ(5)\n#define TXX9_DMA_CCR_XFSZ_X16\tTXX9_DMA_CCR_XFSZ(6)\n#define TXX9_DMA_CCR_XFSZ_X32\tTXX9_DMA_CCR_XFSZ(7)\n#define TXX9_DMA_CCR_MEMIO\t0x00000002\n#define TXX9_DMA_CCR_SNGAD\t0x00000001\n\n \n#define TXX9_DMA_CSR_CHNEN\t0x00000400\n#define TXX9_DMA_CSR_STLXFER\t0x00000200\n#define TXX9_DMA_CSR_XFACT\t0x00000100\n#define TXX9_DMA_CSR_ABCHC\t0x00000080\n#define TXX9_DMA_CSR_NCHNC\t0x00000040\n#define TXX9_DMA_CSR_NTRNFC\t0x00000020\n#define TXX9_DMA_CSR_EXTDN\t0x00000010\n#define TXX9_DMA_CSR_CFERR\t0x00000008\n#define TXX9_DMA_CSR_CHERR\t0x00000004\n#define TXX9_DMA_CSR_DESERR\t0x00000002\n#define TXX9_DMA_CSR_SORERR\t0x00000001\n\nstruct txx9dmac_chan {\n\tstruct dma_chan\t\tchan;\n\tstruct dma_device\tdma;\n\tstruct txx9dmac_dev\t*ddev;\n\tvoid __iomem\t\t*ch_regs;\n\tstruct tasklet_struct\ttasklet;\n\tint\t\t\tirq;\n\tu32\t\t\tccr;\n\n\tspinlock_t\t\tlock;\n\n\t \n\tstruct list_head\tactive_list;\n\tstruct list_head\tqueue;\n\tstruct list_head\tfree_list;\n\n\tunsigned int\t\tdescs_allocated;\n};\n\nstruct txx9dmac_dev {\n\tvoid __iomem\t\t*regs;\n\tstruct tasklet_struct\ttasklet;\n\tint\t\t\tirq;\n\tstruct txx9dmac_chan\t*chan[TXX9_DMA_MAX_NR_CHANNELS];\n\tbool\t\t\thave_64bit_regs;\n\tunsigned int\t\tdescsize;\n};\n\nstatic inline bool __is_dmac64(const struct txx9dmac_dev *ddev)\n{\n\treturn ddev->have_64bit_regs;\n}\n\nstatic inline bool is_dmac64(const struct txx9dmac_chan *dc)\n{\n\treturn __is_dmac64(dc->ddev);\n}\n\n#ifdef TXX9_DMA_USE_SIMPLE_CHAIN\n \nstruct txx9dmac_hwdesc {\n#if defined(CONFIG_32BIT) && !defined(CONFIG_PHYS_ADDR_T_64BIT)\n\tTXX9_DMA_REG32(CHAR);\n#else\n\tu64 CHAR;\n#endif\n\tu64 SAR;\n\tu64 DAR;\n\tTXX9_DMA_REG32(CNTR);\n};\nstruct txx9dmac_hwdesc32 {\n\tu32 CHAR;\n\tu32 SAR;\n\tu32 DAR;\n\tu32 CNTR;\n};\n#else\n#define txx9dmac_hwdesc txx9dmac_cregs\n#define txx9dmac_hwdesc32 txx9dmac_cregs32\n#endif\n\nstruct txx9dmac_desc {\n\t \n\tunion {\n\t\tstruct txx9dmac_hwdesc hwdesc;\n\t\tstruct txx9dmac_hwdesc32 hwdesc32;\n\t};\n\n\t \n\tstruct list_head\t\tdesc_node ____cacheline_aligned;\n\tstruct list_head\t\ttx_list;\n\tstruct dma_async_tx_descriptor\ttxd;\n\tsize_t\t\t\t\tlen;\n};\n\n#ifdef TXX9_DMA_USE_SIMPLE_CHAIN\n\nstatic inline bool txx9dmac_chan_INTENT(struct txx9dmac_chan *dc)\n{\n\treturn (dc->ccr & TXX9_DMA_CCR_INTENT) != 0;\n}\n\nstatic inline void txx9dmac_chan_set_INTENT(struct txx9dmac_chan *dc)\n{\n\tdc->ccr |= TXX9_DMA_CCR_INTENT;\n}\n\nstatic inline void txx9dmac_desc_set_INTENT(struct txx9dmac_dev *ddev,\n\t\t\t\t\t    struct txx9dmac_desc *desc)\n{\n}\n\nstatic inline void txx9dmac_chan_set_SMPCHN(struct txx9dmac_chan *dc)\n{\n\tdc->ccr |= TXX9_DMA_CCR_SMPCHN;\n}\n\nstatic inline void txx9dmac_desc_set_nosimple(struct txx9dmac_dev *ddev,\n\t\t\t\t\t      struct txx9dmac_desc *desc,\n\t\t\t\t\t      u32 sair, u32 dair, u32 ccr)\n{\n}\n\n#else  \n\nstatic inline bool txx9dmac_chan_INTENT(struct txx9dmac_chan *dc)\n{\n\treturn true;\n}\n\nstatic void txx9dmac_chan_set_INTENT(struct txx9dmac_chan *dc)\n{\n}\n\nstatic inline void txx9dmac_desc_set_INTENT(struct txx9dmac_dev *ddev,\n\t\t\t\t\t    struct txx9dmac_desc *desc)\n{\n\tif (__is_dmac64(ddev))\n\t\tdesc->hwdesc.CCR |= TXX9_DMA_CCR_INTENT;\n\telse\n\t\tdesc->hwdesc32.CCR |= TXX9_DMA_CCR_INTENT;\n}\n\nstatic inline void txx9dmac_chan_set_SMPCHN(struct txx9dmac_chan *dc)\n{\n}\n\nstatic inline void txx9dmac_desc_set_nosimple(struct txx9dmac_dev *ddev,\n\t\t\t\t\t      struct txx9dmac_desc *desc,\n\t\t\t\t\t      u32 sai, u32 dai, u32 ccr)\n{\n\tif (__is_dmac64(ddev)) {\n\t\tdesc->hwdesc.SAIR = sai;\n\t\tdesc->hwdesc.DAIR = dai;\n\t\tdesc->hwdesc.CCR = ccr;\n\t} else {\n\t\tdesc->hwdesc32.SAIR = sai;\n\t\tdesc->hwdesc32.DAIR = dai;\n\t\tdesc->hwdesc32.CCR = ccr;\n\t}\n}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}