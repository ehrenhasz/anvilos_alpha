{
  "module_name": "dw-edma-core.h",
  "hash_id": "2ca7ebd7ca946db70c5b04c7e9770c9e833d718f077963862f765662ce792bc5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dma/dw-edma/dw-edma-core.h",
  "human_readable_source": " \n \n\n#ifndef _DW_EDMA_CORE_H\n#define _DW_EDMA_CORE_H\n\n#include <linux/msi.h>\n#include <linux/dma/edma.h>\n\n#include \"../virt-dma.h\"\n\n#define EDMA_LL_SZ\t\t\t\t\t24\n\nenum dw_edma_dir {\n\tEDMA_DIR_WRITE = 0,\n\tEDMA_DIR_READ\n};\n\nenum dw_edma_request {\n\tEDMA_REQ_NONE = 0,\n\tEDMA_REQ_STOP,\n\tEDMA_REQ_PAUSE\n};\n\nenum dw_edma_status {\n\tEDMA_ST_IDLE = 0,\n\tEDMA_ST_PAUSE,\n\tEDMA_ST_BUSY\n};\n\nenum dw_edma_xfer_type {\n\tEDMA_XFER_SCATTER_GATHER = 0,\n\tEDMA_XFER_CYCLIC,\n\tEDMA_XFER_INTERLEAVED\n};\n\nstruct dw_edma_chan;\nstruct dw_edma_chunk;\n\nstruct dw_edma_burst {\n\tstruct list_head\t\tlist;\n\tu64\t\t\t\tsar;\n\tu64\t\t\t\tdar;\n\tu32\t\t\t\tsz;\n};\n\nstruct dw_edma_chunk {\n\tstruct list_head\t\tlist;\n\tstruct dw_edma_chan\t\t*chan;\n\tstruct dw_edma_burst\t\t*burst;\n\n\tu32\t\t\t\tbursts_alloc;\n\n\tu8\t\t\t\tcb;\n\tstruct dw_edma_region\t\tll_region;\t \n};\n\nstruct dw_edma_desc {\n\tstruct virt_dma_desc\t\tvd;\n\tstruct dw_edma_chan\t\t*chan;\n\tstruct dw_edma_chunk\t\t*chunk;\n\n\tu32\t\t\t\tchunks_alloc;\n\n\tu32\t\t\t\talloc_sz;\n\tu32\t\t\t\txfer_sz;\n};\n\nstruct dw_edma_chan {\n\tstruct virt_dma_chan\t\tvc;\n\tstruct dw_edma\t\t\t*dw;\n\tint\t\t\t\tid;\n\tenum dw_edma_dir\t\tdir;\n\n\tu32\t\t\t\tll_max;\n\n\tstruct msi_msg\t\t\tmsi;\n\n\tenum dw_edma_request\t\trequest;\n\tenum dw_edma_status\t\tstatus;\n\tu8\t\t\t\tconfigured;\n\n\tstruct dma_slave_config\t\tconfig;\n};\n\nstruct dw_edma_irq {\n\tstruct msi_msg                  msi;\n\tu32\t\t\t\twr_mask;\n\tu32\t\t\t\trd_mask;\n\tstruct dw_edma\t\t\t*dw;\n};\n\nstruct dw_edma {\n\tchar\t\t\t\tname[32];\n\n\tstruct dma_device\t\tdma;\n\n\tu16\t\t\t\twr_ch_cnt;\n\tu16\t\t\t\trd_ch_cnt;\n\n\tstruct dw_edma_irq\t\t*irq;\n\tint\t\t\t\tnr_irqs;\n\n\tstruct dw_edma_chan\t\t*chan;\n\n\traw_spinlock_t\t\t\tlock;\t\t \n\n\tstruct dw_edma_chip             *chip;\n\n\tconst struct dw_edma_core_ops\t*core;\n};\n\ntypedef void (*dw_edma_handler_t)(struct dw_edma_chan *);\n\nstruct dw_edma_core_ops {\n\tvoid (*off)(struct dw_edma *dw);\n\tu16 (*ch_count)(struct dw_edma *dw, enum dw_edma_dir dir);\n\tenum dma_status (*ch_status)(struct dw_edma_chan *chan);\n\tirqreturn_t (*handle_int)(struct dw_edma_irq *dw_irq, enum dw_edma_dir dir,\n\t\t\t\t  dw_edma_handler_t done, dw_edma_handler_t abort);\n\tvoid (*start)(struct dw_edma_chunk *chunk, bool first);\n\tvoid (*ch_config)(struct dw_edma_chan *chan);\n\tvoid (*debugfs_on)(struct dw_edma *dw);\n};\n\nstruct dw_edma_sg {\n\tstruct scatterlist\t\t*sgl;\n\tunsigned int\t\t\tlen;\n};\n\nstruct dw_edma_cyclic {\n\tdma_addr_t\t\t\tpaddr;\n\tsize_t\t\t\t\tlen;\n\tsize_t\t\t\t\tcnt;\n};\n\nstruct dw_edma_transfer {\n\tstruct dma_chan\t\t\t*dchan;\n\tunion dw_edma_xfer {\n\t\tstruct dw_edma_sg\t\tsg;\n\t\tstruct dw_edma_cyclic\t\tcyclic;\n\t\tstruct dma_interleaved_template *il;\n\t} xfer;\n\tenum dma_transfer_direction\tdirection;\n\tunsigned long\t\t\tflags;\n\tenum dw_edma_xfer_type\t\ttype;\n};\n\nstatic inline\nstruct dw_edma_chan *vc2dw_edma_chan(struct virt_dma_chan *vc)\n{\n\treturn container_of(vc, struct dw_edma_chan, vc);\n}\n\nstatic inline\nstruct dw_edma_chan *dchan2dw_edma_chan(struct dma_chan *dchan)\n{\n\treturn vc2dw_edma_chan(to_virt_chan(dchan));\n}\n\nstatic inline\nvoid dw_edma_core_off(struct dw_edma *dw)\n{\n\tdw->core->off(dw);\n}\n\nstatic inline\nu16 dw_edma_core_ch_count(struct dw_edma *dw, enum dw_edma_dir dir)\n{\n\treturn dw->core->ch_count(dw, dir);\n}\n\nstatic inline\nenum dma_status dw_edma_core_ch_status(struct dw_edma_chan *chan)\n{\n\treturn chan->dw->core->ch_status(chan);\n}\n\nstatic inline irqreturn_t\ndw_edma_core_handle_int(struct dw_edma_irq *dw_irq, enum dw_edma_dir dir,\n\t\t\tdw_edma_handler_t done, dw_edma_handler_t abort)\n{\n\treturn dw_irq->dw->core->handle_int(dw_irq, dir, done, abort);\n}\n\nstatic inline\nvoid dw_edma_core_start(struct dw_edma *dw, struct dw_edma_chunk *chunk, bool first)\n{\n\tdw->core->start(chunk, first);\n}\n\nstatic inline\nvoid dw_edma_core_ch_config(struct dw_edma_chan *chan)\n{\n\tchan->dw->core->ch_config(chan);\n}\n\nstatic inline\nvoid dw_edma_core_debugfs_on(struct dw_edma *dw)\n{\n\tdw->core->debugfs_on(dw);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}