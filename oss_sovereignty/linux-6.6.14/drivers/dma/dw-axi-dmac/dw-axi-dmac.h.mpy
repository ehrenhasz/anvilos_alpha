{
  "module_name": "dw-axi-dmac.h",
  "hash_id": "2f528a156cfcb2405ca2fbcc840a6ba1bfa178ea7a80a9f26f7b01d91de72201",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dma/dw-axi-dmac/dw-axi-dmac.h",
  "human_readable_source": " \n\n\n \n\n#ifndef _AXI_DMA_PLATFORM_H\n#define _AXI_DMA_PLATFORM_H\n\n#include <linux/bitops.h>\n#include <linux/clk.h>\n#include <linux/device.h>\n#include <linux/dmaengine.h>\n#include <linux/types.h>\n\n#include \"../virt-dma.h\"\n\n#define DMAC_MAX_CHANNELS\t16\n#define DMAC_MAX_MASTERS\t2\n#define DMAC_MAX_BLK_SIZE\t0x200000\n\nstruct dw_axi_dma_hcfg {\n\tu32\tnr_channels;\n\tu32\tnr_masters;\n\tu32\tm_data_width;\n\tu32\tblock_size[DMAC_MAX_CHANNELS];\n\tu32\tpriority[DMAC_MAX_CHANNELS];\n\t \n\tu32\taxi_rw_burst_len;\n\t \n\tbool\treg_map_8_channels;\n\tbool\trestrict_axi_burst_len;\n\tbool\tuse_cfg2;\n};\n\nstruct axi_dma_chan {\n\tstruct axi_dma_chip\t\t*chip;\n\tvoid __iomem\t\t\t*chan_regs;\n\tu8\t\t\t\tid;\n\tu8\t\t\t\thw_handshake_num;\n\tatomic_t\t\t\tdescs_allocated;\n\n\tstruct dma_pool\t\t\t*desc_pool;\n\tstruct virt_dma_chan\t\tvc;\n\n\tstruct axi_dma_desc\t\t*desc;\n\tstruct dma_slave_config\t\tconfig;\n\tenum dma_transfer_direction\tdirection;\n\tbool\t\t\t\tcyclic;\n\t \n\tbool\t\t\t\tis_paused;\n};\n\nstruct dw_axi_dma {\n\tstruct dma_device\tdma;\n\tstruct dw_axi_dma_hcfg\t*hdata;\n\tstruct device_dma_parameters\tdma_parms;\n\n\t \n\tstruct axi_dma_chan\t*chan;\n};\n\nstruct axi_dma_chip {\n\tstruct device\t\t*dev;\n\tint\t\t\tirq;\n\tvoid __iomem\t\t*regs;\n\tvoid __iomem\t\t*apb_regs;\n\tstruct clk\t\t*core_clk;\n\tstruct clk\t\t*cfgr_clk;\n\tstruct dw_axi_dma\t*dw;\n};\n\n \nstruct __packed axi_dma_lli {\n\t__le64\t\tsar;\n\t__le64\t\tdar;\n\t__le32\t\tblock_ts_lo;\n\t__le32\t\tblock_ts_hi;\n\t__le64\t\tllp;\n\t__le32\t\tctl_lo;\n\t__le32\t\tctl_hi;\n\t__le32\t\tsstat;\n\t__le32\t\tdstat;\n\t__le32\t\tstatus_lo;\n\t__le32\t\tstatus_hi;\n\t__le32\t\treserved_lo;\n\t__le32\t\treserved_hi;\n};\n\nstruct axi_dma_hw_desc {\n\tstruct axi_dma_lli\t*lli;\n\tdma_addr_t\t\tllp;\n\tu32\t\t\tlen;\n};\n\nstruct axi_dma_desc {\n\tstruct axi_dma_hw_desc\t*hw_desc;\n\n\tstruct virt_dma_desc\t\tvd;\n\tstruct axi_dma_chan\t\t*chan;\n\tu32\t\t\t\tcompleted_blocks;\n\tu32\t\t\t\tlength;\n\tu32\t\t\t\tperiod_len;\n};\n\nstruct axi_dma_chan_config {\n\tu8 dst_multblk_type;\n\tu8 src_multblk_type;\n\tu8 dst_per;\n\tu8 src_per;\n\tu8 tt_fc;\n\tu8 prior;\n\tu8 hs_sel_dst;\n\tu8 hs_sel_src;\n};\n\nstatic inline struct device *dchan2dev(struct dma_chan *dchan)\n{\n\treturn &dchan->dev->device;\n}\n\nstatic inline struct device *chan2dev(struct axi_dma_chan *chan)\n{\n\treturn &chan->vc.chan.dev->device;\n}\n\nstatic inline struct axi_dma_desc *vd_to_axi_desc(struct virt_dma_desc *vd)\n{\n\treturn container_of(vd, struct axi_dma_desc, vd);\n}\n\nstatic inline struct axi_dma_chan *vc_to_axi_dma_chan(struct virt_dma_chan *vc)\n{\n\treturn container_of(vc, struct axi_dma_chan, vc);\n}\n\nstatic inline struct axi_dma_chan *dchan_to_axi_dma_chan(struct dma_chan *dchan)\n{\n\treturn vc_to_axi_dma_chan(to_virt_chan(dchan));\n}\n\n\n#define COMMON_REG_LEN\t\t0x100\n#define CHAN_REG_LEN\t\t0x100\n\n \n#define DMAC_ID\t\t\t0x000  \n#define DMAC_COMPVER\t\t0x008  \n#define DMAC_CFG\t\t0x010  \n#define DMAC_CHEN\t\t0x018  \n#define DMAC_CHEN_L\t\t0x018  \n#define DMAC_CHEN_H\t\t0x01C  \n#define DMAC_CHSUSPREG\t\t0x020  \n#define DMAC_CHABORTREG\t\t0x028  \n#define DMAC_INTSTATUS\t\t0x030  \n#define DMAC_COMMON_INTCLEAR\t0x038  \n#define DMAC_COMMON_INTSTATUS_ENA 0x040  \n#define DMAC_COMMON_INTSIGNAL_ENA 0x048  \n#define DMAC_COMMON_INTSTATUS\t0x050  \n#define DMAC_RESET\t\t0x058  \n\n \n#define CH_SAR\t\t\t0x000  \n#define CH_DAR\t\t\t0x008  \n#define CH_BLOCK_TS\t\t0x010  \n#define CH_CTL\t\t\t0x018  \n#define CH_CTL_L\t\t0x018  \n#define CH_CTL_H\t\t0x01C  \n#define CH_CFG\t\t\t0x020  \n#define CH_CFG_L\t\t0x020  \n#define CH_CFG_H\t\t0x024  \n#define CH_LLP\t\t\t0x028  \n#define CH_STATUS\t\t0x030  \n#define CH_SWHSSRC\t\t0x038  \n#define CH_SWHSDST\t\t0x040  \n#define CH_BLK_TFR_RESUMEREQ\t0x048  \n#define CH_AXI_ID\t\t0x050  \n#define CH_AXI_QOS\t\t0x058  \n#define CH_SSTAT\t\t0x060  \n#define CH_DSTAT\t\t0x068  \n#define CH_SSTATAR\t\t0x070  \n#define CH_DSTATAR\t\t0x078  \n#define CH_INTSTATUS_ENA\t0x080  \n#define CH_INTSTATUS\t\t0x088  \n#define CH_INTSIGNAL_ENA\t0x090  \n#define CH_INTCLEAR\t\t0x098  \n\n \n#define DMAC_APB_CFG\t\t0x000  \n#define DMAC_APB_STAT\t\t0x004  \n#define DMAC_APB_DEBUG_STAT_0\t0x008  \n#define DMAC_APB_DEBUG_STAT_1\t0x00C  \n#define DMAC_APB_HW_HS_SEL_0\t0x010  \n#define DMAC_APB_HW_HS_SEL_1\t0x014  \n#define DMAC_APB_LPI\t\t0x018  \n#define DMAC_APB_BYTE_WR_CH_EN\t0x01C  \n#define DMAC_APB_HALFWORD_WR_CH_EN\t0x020  \n\n#define UNUSED_CHANNEL\t\t0x3F  \n#define DMA_APB_HS_SEL_BIT_SIZE\t0x08  \n#define DMA_APB_HS_SEL_MASK\t0xFF  \n#define MAX_BLOCK_SIZE\t\t0x1000  \n#define DMA_REG_MAP_CH_REF\t0x08  \n\n \n#define DMAC_EN_POS\t\t\t0\n#define DMAC_EN_MASK\t\t\tBIT(DMAC_EN_POS)\n\n#define INT_EN_POS\t\t\t1\n#define INT_EN_MASK\t\t\tBIT(INT_EN_POS)\n\n \n#define DMAC_CHAN_EN_SHIFT\t\t0\n#define DMAC_CHAN_EN_WE_SHIFT\t\t8\n\n#define DMAC_CHAN_SUSP_SHIFT\t\t16\n#define DMAC_CHAN_SUSP_WE_SHIFT\t\t24\n\n \n#define DMAC_CHAN_EN2_WE_SHIFT\t\t16\n\n \n#define DMAC_CHAN_SUSP2_SHIFT\t\t0\n#define DMAC_CHAN_SUSP2_WE_SHIFT\t16\n\n \n#define CH_CTL_H_ARLEN_EN\t\tBIT(6)\n#define CH_CTL_H_ARLEN_POS\t\t7\n#define CH_CTL_H_AWLEN_EN\t\tBIT(15)\n#define CH_CTL_H_AWLEN_POS\t\t16\n\nenum {\n\tDWAXIDMAC_ARWLEN_1\t\t= 0,\n\tDWAXIDMAC_ARWLEN_2\t\t= 1,\n\tDWAXIDMAC_ARWLEN_4\t\t= 3,\n\tDWAXIDMAC_ARWLEN_8\t\t= 7,\n\tDWAXIDMAC_ARWLEN_16\t\t= 15,\n\tDWAXIDMAC_ARWLEN_32\t\t= 31,\n\tDWAXIDMAC_ARWLEN_64\t\t= 63,\n\tDWAXIDMAC_ARWLEN_128\t\t= 127,\n\tDWAXIDMAC_ARWLEN_256\t\t= 255,\n\tDWAXIDMAC_ARWLEN_MIN\t\t= DWAXIDMAC_ARWLEN_1,\n\tDWAXIDMAC_ARWLEN_MAX\t\t= DWAXIDMAC_ARWLEN_256\n};\n\n#define CH_CTL_H_LLI_LAST\t\tBIT(30)\n#define CH_CTL_H_LLI_VALID\t\tBIT(31)\n\n \n#define CH_CTL_L_LAST_WRITE_EN\t\tBIT(30)\n\n#define CH_CTL_L_DST_MSIZE_POS\t\t18\n#define CH_CTL_L_SRC_MSIZE_POS\t\t14\n\nenum {\n\tDWAXIDMAC_BURST_TRANS_LEN_1\t= 0,\n\tDWAXIDMAC_BURST_TRANS_LEN_4,\n\tDWAXIDMAC_BURST_TRANS_LEN_8,\n\tDWAXIDMAC_BURST_TRANS_LEN_16,\n\tDWAXIDMAC_BURST_TRANS_LEN_32,\n\tDWAXIDMAC_BURST_TRANS_LEN_64,\n\tDWAXIDMAC_BURST_TRANS_LEN_128,\n\tDWAXIDMAC_BURST_TRANS_LEN_256,\n\tDWAXIDMAC_BURST_TRANS_LEN_512,\n\tDWAXIDMAC_BURST_TRANS_LEN_1024\n};\n\n#define CH_CTL_L_DST_WIDTH_POS\t\t11\n#define CH_CTL_L_SRC_WIDTH_POS\t\t8\n\n#define CH_CTL_L_DST_INC_POS\t\t6\n#define CH_CTL_L_SRC_INC_POS\t\t4\nenum {\n\tDWAXIDMAC_CH_CTL_L_INC\t\t= 0,\n\tDWAXIDMAC_CH_CTL_L_NOINC\n};\n\n#define CH_CTL_L_DST_MAST\t\tBIT(2)\n#define CH_CTL_L_SRC_MAST\t\tBIT(0)\n\n \n#define CH_CFG_H_PRIORITY_POS\t\t17\n#define CH_CFG_H_DST_PER_POS\t\t12\n#define CH_CFG_H_SRC_PER_POS\t\t7\n#define CH_CFG_H_HS_SEL_DST_POS\t\t4\n#define CH_CFG_H_HS_SEL_SRC_POS\t\t3\nenum {\n\tDWAXIDMAC_HS_SEL_HW\t\t= 0,\n\tDWAXIDMAC_HS_SEL_SW\n};\n\n#define CH_CFG_H_TT_FC_POS\t\t0\nenum {\n\tDWAXIDMAC_TT_FC_MEM_TO_MEM_DMAC\t= 0,\n\tDWAXIDMAC_TT_FC_MEM_TO_PER_DMAC,\n\tDWAXIDMAC_TT_FC_PER_TO_MEM_DMAC,\n\tDWAXIDMAC_TT_FC_PER_TO_PER_DMAC,\n\tDWAXIDMAC_TT_FC_PER_TO_MEM_SRC,\n\tDWAXIDMAC_TT_FC_PER_TO_PER_SRC,\n\tDWAXIDMAC_TT_FC_MEM_TO_PER_DST,\n\tDWAXIDMAC_TT_FC_PER_TO_PER_DST\n};\n\n \n#define CH_CFG_L_DST_MULTBLK_TYPE_POS\t2\n#define CH_CFG_L_SRC_MULTBLK_TYPE_POS\t0\nenum {\n\tDWAXIDMAC_MBLK_TYPE_CONTIGUOUS\t= 0,\n\tDWAXIDMAC_MBLK_TYPE_RELOAD,\n\tDWAXIDMAC_MBLK_TYPE_SHADOW_REG,\n\tDWAXIDMAC_MBLK_TYPE_LL\n};\n\n \n#define CH_CFG2_L_SRC_PER_POS\t\t4\n#define CH_CFG2_L_DST_PER_POS\t\t11\n\n#define CH_CFG2_H_TT_FC_POS\t\t0\n#define CH_CFG2_H_HS_SEL_SRC_POS\t3\n#define CH_CFG2_H_HS_SEL_DST_POS\t4\n#define CH_CFG2_H_PRIORITY_POS\t\t20\n\n \nenum {\n\tDWAXIDMAC_IRQ_NONE\t\t= 0,\n\tDWAXIDMAC_IRQ_BLOCK_TRF\t\t= BIT(0),\n\tDWAXIDMAC_IRQ_DMA_TRF\t\t= BIT(1),\n\tDWAXIDMAC_IRQ_SRC_TRAN\t\t= BIT(3),\n\tDWAXIDMAC_IRQ_DST_TRAN\t\t= BIT(4),\n\tDWAXIDMAC_IRQ_SRC_DEC_ERR\t= BIT(5),\n\tDWAXIDMAC_IRQ_DST_DEC_ERR\t= BIT(6),\n\tDWAXIDMAC_IRQ_SRC_SLV_ERR\t= BIT(7),\n\tDWAXIDMAC_IRQ_DST_SLV_ERR\t= BIT(8),\n\tDWAXIDMAC_IRQ_LLI_RD_DEC_ERR\t= BIT(9),\n\tDWAXIDMAC_IRQ_LLI_WR_DEC_ERR\t= BIT(10),\n\tDWAXIDMAC_IRQ_LLI_RD_SLV_ERR\t= BIT(11),\n\tDWAXIDMAC_IRQ_LLI_WR_SLV_ERR\t= BIT(12),\n\tDWAXIDMAC_IRQ_INVALID_ERR\t= BIT(13),\n\tDWAXIDMAC_IRQ_MULTIBLKTYPE_ERR\t= BIT(14),\n\tDWAXIDMAC_IRQ_DEC_ERR\t\t= BIT(16),\n\tDWAXIDMAC_IRQ_WR2RO_ERR\t\t= BIT(17),\n\tDWAXIDMAC_IRQ_RD2RWO_ERR\t= BIT(18),\n\tDWAXIDMAC_IRQ_WRONCHEN_ERR\t= BIT(19),\n\tDWAXIDMAC_IRQ_SHADOWREG_ERR\t= BIT(20),\n\tDWAXIDMAC_IRQ_WRONHOLD_ERR\t= BIT(21),\n\tDWAXIDMAC_IRQ_LOCK_CLEARED\t= BIT(27),\n\tDWAXIDMAC_IRQ_SRC_SUSPENDED\t= BIT(28),\n\tDWAXIDMAC_IRQ_SUSPENDED\t\t= BIT(29),\n\tDWAXIDMAC_IRQ_DISABLED\t\t= BIT(30),\n\tDWAXIDMAC_IRQ_ABORTED\t\t= BIT(31),\n\tDWAXIDMAC_IRQ_ALL_ERR\t\t= (GENMASK(21, 16) | GENMASK(14, 5)),\n\tDWAXIDMAC_IRQ_ALL\t\t= GENMASK(31, 0)\n};\n\nenum {\n\tDWAXIDMAC_TRANS_WIDTH_8\t\t= 0,\n\tDWAXIDMAC_TRANS_WIDTH_16,\n\tDWAXIDMAC_TRANS_WIDTH_32,\n\tDWAXIDMAC_TRANS_WIDTH_64,\n\tDWAXIDMAC_TRANS_WIDTH_128,\n\tDWAXIDMAC_TRANS_WIDTH_256,\n\tDWAXIDMAC_TRANS_WIDTH_512,\n\tDWAXIDMAC_TRANS_WIDTH_MAX\t= DWAXIDMAC_TRANS_WIDTH_512\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}