{
  "module_name": "iova_domain.h",
  "hash_id": "37a797566a1c121c1a3aa6a58a99e48b2e5cf73d882b5607ecd35528b0b10205",
  "original_prompt": "Ingested from linux-6.6.14/drivers/vdpa/vdpa_user/iova_domain.h",
  "human_readable_source": " \n \n\n#ifndef _VDUSE_IOVA_DOMAIN_H\n#define _VDUSE_IOVA_DOMAIN_H\n\n#include <linux/iova.h>\n#include <linux/dma-mapping.h>\n#include <linux/vhost_iotlb.h>\n\n#define IOVA_START_PFN 1\n\n#define INVALID_PHYS_ADDR (~(phys_addr_t)0)\n\nstruct vduse_bounce_map {\n\tstruct page *bounce_page;\n\tu64 orig_phys;\n};\n\nstruct vduse_iova_domain {\n\tstruct iova_domain stream_iovad;\n\tstruct iova_domain consistent_iovad;\n\tstruct vduse_bounce_map *bounce_maps;\n\tsize_t bounce_size;\n\tunsigned long iova_limit;\n\tint bounce_map;\n\tstruct vhost_iotlb *iotlb;\n\tspinlock_t iotlb_lock;\n\tstruct file *file;\n\tbool user_bounce_pages;\n\trwlock_t bounce_lock;\n};\n\nint vduse_domain_set_map(struct vduse_iova_domain *domain,\n\t\t\t struct vhost_iotlb *iotlb);\n\nvoid vduse_domain_clear_map(struct vduse_iova_domain *domain,\n\t\t\t    struct vhost_iotlb *iotlb);\n\ndma_addr_t vduse_domain_map_page(struct vduse_iova_domain *domain,\n\t\t\t\t struct page *page, unsigned long offset,\n\t\t\t\t size_t size, enum dma_data_direction dir,\n\t\t\t\t unsigned long attrs);\n\nvoid vduse_domain_unmap_page(struct vduse_iova_domain *domain,\n\t\t\t     dma_addr_t dma_addr, size_t size,\n\t\t\t     enum dma_data_direction dir, unsigned long attrs);\n\nvoid *vduse_domain_alloc_coherent(struct vduse_iova_domain *domain,\n\t\t\t\t  size_t size, dma_addr_t *dma_addr,\n\t\t\t\t  gfp_t flag, unsigned long attrs);\n\nvoid vduse_domain_free_coherent(struct vduse_iova_domain *domain, size_t size,\n\t\t\t\tvoid *vaddr, dma_addr_t dma_addr,\n\t\t\t\tunsigned long attrs);\n\nvoid vduse_domain_reset_bounce_map(struct vduse_iova_domain *domain);\n\nint vduse_domain_add_user_bounce_pages(struct vduse_iova_domain *domain,\n\t\t\t\t       struct page **pages, int count);\n\nvoid vduse_domain_remove_user_bounce_pages(struct vduse_iova_domain *domain);\n\nvoid vduse_domain_destroy(struct vduse_iova_domain *domain);\n\nstruct vduse_iova_domain *vduse_domain_create(unsigned long iova_limit,\n\t\t\t\t\t      size_t bounce_size);\n\nint vduse_domain_init(void);\n\nvoid vduse_domain_exit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}