{
  "module_name": "vmw_pvscsi.h",
  "hash_id": "17a21f769d4c7515caf2f2c6198ede1c8e3b91b236680349366ff58e54be9127",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/vmw_pvscsi.h",
  "human_readable_source": " \n\n#ifndef _VMW_PVSCSI_H_\n#define _VMW_PVSCSI_H_\n\n#include <linux/types.h>\n\n#define PVSCSI_DRIVER_VERSION_STRING   \"1.0.7.0-k\"\n\n#define PVSCSI_MAX_NUM_SG_ENTRIES_PER_SEGMENT 128\n\n#define MASK(n)        ((1 << (n)) - 1)         \n\n#define PCI_DEVICE_ID_VMWARE_PVSCSI\t0x07C0\n\n \nenum HostBusAdapterStatus {\n\tBTSTAT_SUCCESS       = 0x00,   \n\tBTSTAT_LINKED_COMMAND_COMPLETED           = 0x0a,\n\tBTSTAT_LINKED_COMMAND_COMPLETED_WITH_FLAG = 0x0b,\n\tBTSTAT_DATA_UNDERRUN = 0x0c,\n\tBTSTAT_SELTIMEO      = 0x11,   \n\tBTSTAT_DATARUN       = 0x12,   \n\tBTSTAT_BUSFREE       = 0x13,   \n\tBTSTAT_INVPHASE      = 0x14,   \n\tBTSTAT_LUNMISMATCH   = 0x17,   \n\tBTSTAT_INVPARAM      = 0x1a,   \n\tBTSTAT_SENSFAILED    = 0x1b,   \n\tBTSTAT_TAGREJECT     = 0x1c,   \n\tBTSTAT_BADMSG        = 0x1d,   \n\tBTSTAT_HAHARDWARE    = 0x20,   \n\tBTSTAT_NORESPONSE    = 0x21,   \n\tBTSTAT_SENTRST       = 0x22,   \n\tBTSTAT_RECVRST       = 0x23,   \n\tBTSTAT_DISCONNECT    = 0x24,   \n\tBTSTAT_BUSRESET      = 0x25,   \n\tBTSTAT_ABORTQUEUE    = 0x26,   \n\tBTSTAT_HASOFTWARE    = 0x27,   \n\tBTSTAT_HATIMEOUT     = 0x30,   \n\tBTSTAT_SCSIPARITY    = 0x34,   \n};\n\n \nenum ScsiDeviceStatus {\n\tSDSTAT_GOOD  = 0x00,  \n\tSDSTAT_CHECK = 0x02,  \n};\n\n \n\nenum PVSCSIRegOffset {\n\tPVSCSI_REG_OFFSET_COMMAND        =    0x0,\n\tPVSCSI_REG_OFFSET_COMMAND_DATA   =    0x4,\n\tPVSCSI_REG_OFFSET_COMMAND_STATUS =    0x8,\n\tPVSCSI_REG_OFFSET_LAST_STS_0     =  0x100,\n\tPVSCSI_REG_OFFSET_LAST_STS_1     =  0x104,\n\tPVSCSI_REG_OFFSET_LAST_STS_2     =  0x108,\n\tPVSCSI_REG_OFFSET_LAST_STS_3     =  0x10c,\n\tPVSCSI_REG_OFFSET_INTR_STATUS    = 0x100c,\n\tPVSCSI_REG_OFFSET_INTR_MASK      = 0x2010,\n\tPVSCSI_REG_OFFSET_KICK_NON_RW_IO = 0x3014,\n\tPVSCSI_REG_OFFSET_DEBUG          = 0x3018,\n\tPVSCSI_REG_OFFSET_KICK_RW_IO     = 0x4018,\n};\n\n \n\nenum PVSCSICommands {\n\tPVSCSI_CMD_FIRST             = 0,  \n\n\tPVSCSI_CMD_ADAPTER_RESET     = 1,\n\tPVSCSI_CMD_ISSUE_SCSI        = 2,\n\tPVSCSI_CMD_SETUP_RINGS       = 3,\n\tPVSCSI_CMD_RESET_BUS         = 4,\n\tPVSCSI_CMD_RESET_DEVICE      = 5,\n\tPVSCSI_CMD_ABORT_CMD         = 6,\n\tPVSCSI_CMD_CONFIG            = 7,\n\tPVSCSI_CMD_SETUP_MSG_RING    = 8,\n\tPVSCSI_CMD_DEVICE_UNPLUG     = 9,\n\tPVSCSI_CMD_SETUP_REQCALLTHRESHOLD     = 10,\n\n\tPVSCSI_CMD_LAST              = 11   \n};\n\n \n\nstruct PVSCSICmdDescResetDevice {\n\tu32\ttarget;\n\tu8\tlun[8];\n} __packed;\n\n \n\nstruct PVSCSICmdDescConfigCmd {\n\tu64 cmpAddr;\n\tu64 configPageAddress;\n\tu32 configPageNum;\n\tu32 _pad;\n} __packed;\n\n \n\nstruct PVSCSICmdDescSetupReqCall {\n\tu32 enable;\n} __packed;\n\nenum PVSCSIConfigPageType {\n\tPVSCSI_CONFIG_PAGE_CONTROLLER = 0x1958,\n\tPVSCSI_CONFIG_PAGE_PHY        = 0x1959,\n\tPVSCSI_CONFIG_PAGE_DEVICE     = 0x195a,\n};\n\nenum PVSCSIConfigPageAddressType {\n\tPVSCSI_CONFIG_CONTROLLER_ADDRESS = 0x2120,\n\tPVSCSI_CONFIG_BUSTARGET_ADDRESS  = 0x2121,\n\tPVSCSI_CONFIG_PHY_ADDRESS        = 0x2122,\n};\n\n \n\nstruct PVSCSICmdDescAbortCmd {\n\tu64\tcontext;\n\tu32\ttarget;\n\tu32\t_pad;\n} __packed;\n\n \n\n#define PVSCSI_SETUP_RINGS_MAX_NUM_PAGES        32\nstruct PVSCSICmdDescSetupRings {\n\tu32\treqRingNumPages;\n\tu32\tcmpRingNumPages;\n\tu64\tringsStatePPN;\n\tu64\treqRingPPNs[PVSCSI_SETUP_RINGS_MAX_NUM_PAGES];\n\tu64\tcmpRingPPNs[PVSCSI_SETUP_RINGS_MAX_NUM_PAGES];\n} __packed;\n\n \n\n#define PVSCSI_SETUP_MSG_RING_MAX_NUM_PAGES  16\n\nstruct PVSCSICmdDescSetupMsgRing {\n\tu32\tnumPages;\n\tu32\t_pad;\n\tu64\tringPPNs[PVSCSI_SETUP_MSG_RING_MAX_NUM_PAGES];\n} __packed;\n\nenum PVSCSIMsgType {\n\tPVSCSI_MSG_DEV_ADDED          = 0,\n\tPVSCSI_MSG_DEV_REMOVED        = 1,\n\tPVSCSI_MSG_LAST               = 2,\n};\n\n \n\nstruct PVSCSIRingMsgDesc {\n\tu32\ttype;\n\tu32\targs[31];\n} __packed;\n\nstruct PVSCSIMsgDescDevStatusChanged {\n\tu32\ttype;   \n\tu32\tbus;\n\tu32\ttarget;\n\tu8\tlun[8];\n\tu32\tpad[27];\n} __packed;\n\n \n\nstruct PVSCSIRingsState {\n\tu32\treqProdIdx;\n\tu32\treqConsIdx;\n\tu32\treqNumEntriesLog2;\n\n\tu32\tcmpProdIdx;\n\tu32\tcmpConsIdx;\n\tu32\tcmpNumEntriesLog2;\n\n\tu32\treqCallThreshold;\n\n\tu8\t_pad[100];\n\n\tu32\tmsgProdIdx;\n\tu32\tmsgConsIdx;\n\tu32\tmsgNumEntriesLog2;\n} __packed;\n\n \n\n#define PVSCSI_FLAG_CMD_WITH_SG_LIST        (1 << 0)\n#define PVSCSI_FLAG_CMD_OUT_OF_BAND_CDB     (1 << 1)\n#define PVSCSI_FLAG_CMD_DIR_NONE            (1 << 2)\n#define PVSCSI_FLAG_CMD_DIR_TOHOST          (1 << 3)\n#define PVSCSI_FLAG_CMD_DIR_TODEVICE        (1 << 4)\n\nstruct PVSCSIRingReqDesc {\n\tu64\tcontext;\n\tu64\tdataAddr;\n\tu64\tdataLen;\n\tu64\tsenseAddr;\n\tu32\tsenseLen;\n\tu32\tflags;\n\tu8\tcdb[16];\n\tu8\tcdbLen;\n\tu8\tlun[8];\n\tu8\ttag;\n\tu8\tbus;\n\tu8\ttarget;\n\tu16\tvcpuHint;\n\tu8\tunused[58];\n} __packed;\n\n \n\nstruct PVSCSISGElement {\n\tu64\taddr;\n\tu32\tlength;\n\tu32\tflags;\n} __packed;\n\n \n\nstruct PVSCSIRingCmpDesc {\n\tu64\tcontext;\n\tu64\tdataLen;\n\tu32\tsenseLen;\n\tu16\thostStatus;\n\tu16\tscsiStatus;\n\tu32\t_pad[2];\n} __packed;\n\nstruct PVSCSIConfigPageHeader {\n\tu32 pageNum;\n\tu16 numDwords;\n\tu16 hostStatus;\n\tu16 scsiStatus;\n\tu16 reserved[3];\n} __packed;\n\nstruct PVSCSIConfigPageController {\n\tstruct PVSCSIConfigPageHeader header;\n\tu64 nodeWWN;  \n\tu16 manufacturer[64];\n\tu16 serialNumber[64];\n\tu16 opromVersion[32];\n\tu16 hwVersion[32];\n\tu16 firmwareVersion[32];\n\tu32 numPhys;\n\tu8  useConsecutivePhyWWNs;\n\tu8  reserved[3];\n} __packed;\n\n \n\n#define PVSCSI_INTR_CMPL_0                 (1 << 0)\n#define PVSCSI_INTR_CMPL_1                 (1 << 1)\n#define PVSCSI_INTR_CMPL_MASK              MASK(2)\n\n#define PVSCSI_INTR_MSG_0                  (1 << 2)\n#define PVSCSI_INTR_MSG_1                  (1 << 3)\n#define PVSCSI_INTR_MSG_MASK               (MASK(2) << 2)\n\n#define PVSCSI_INTR_ALL_SUPPORTED          MASK(4)\n\n \n#define PVSCSI_MAX_INTRS        24\n\n \n\n#define PVSCSI_MAX_NUM_PAGES_REQ_RING   PVSCSI_SETUP_RINGS_MAX_NUM_PAGES\n#define PVSCSI_MAX_NUM_PAGES_CMP_RING   PVSCSI_SETUP_RINGS_MAX_NUM_PAGES\n#define PVSCSI_MAX_NUM_PAGES_MSG_RING   PVSCSI_SETUP_MSG_RING_MAX_NUM_PAGES\n\n#define PVSCSI_MAX_NUM_REQ_ENTRIES_PER_PAGE \\\n\t\t\t\t(PAGE_SIZE / sizeof(struct PVSCSIRingReqDesc))\n\n#define PVSCSI_MAX_REQ_QUEUE_DEPTH \\\n\t(PVSCSI_MAX_NUM_PAGES_REQ_RING * PVSCSI_MAX_NUM_REQ_ENTRIES_PER_PAGE)\n\n#define PVSCSI_MEM_SPACE_COMMAND_NUM_PAGES     1\n#define PVSCSI_MEM_SPACE_INTR_STATUS_NUM_PAGES 1\n#define PVSCSI_MEM_SPACE_MISC_NUM_PAGES        2\n#define PVSCSI_MEM_SPACE_KICK_IO_NUM_PAGES     2\n#define PVSCSI_MEM_SPACE_MSIX_NUM_PAGES        2\n\nenum PVSCSIMemSpace {\n\tPVSCSI_MEM_SPACE_COMMAND_PAGE\t\t= 0,\n\tPVSCSI_MEM_SPACE_INTR_STATUS_PAGE\t= 1,\n\tPVSCSI_MEM_SPACE_MISC_PAGE\t\t= 2,\n\tPVSCSI_MEM_SPACE_KICK_IO_PAGE\t\t= 4,\n\tPVSCSI_MEM_SPACE_MSIX_TABLE_PAGE\t= 6,\n\tPVSCSI_MEM_SPACE_MSIX_PBA_PAGE\t\t= 7,\n};\n\n#define PVSCSI_MEM_SPACE_NUM_PAGES \\\n\t(PVSCSI_MEM_SPACE_COMMAND_NUM_PAGES +       \\\n\t PVSCSI_MEM_SPACE_INTR_STATUS_NUM_PAGES +   \\\n\t PVSCSI_MEM_SPACE_MISC_NUM_PAGES +          \\\n\t PVSCSI_MEM_SPACE_KICK_IO_NUM_PAGES +       \\\n\t PVSCSI_MEM_SPACE_MSIX_NUM_PAGES)\n\n#define PVSCSI_MEM_SPACE_SIZE        (PVSCSI_MEM_SPACE_NUM_PAGES * PAGE_SIZE)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}