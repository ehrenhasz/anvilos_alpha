{
  "module_name": "snic_trc.h",
  "hash_id": "e25bfd22834253a79be11165dbe124db9cd8b00f88da0f78ade51fd982a00414",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/snic/snic_trc.h",
  "human_readable_source": " \n \n\n#ifndef __SNIC_TRC_H\n#define __SNIC_TRC_H\n\n#ifdef CONFIG_SCSI_SNIC_DEBUG_FS\n\nextern ssize_t simple_read_from_buffer(void __user *to,\n\t\t\t\t\tsize_t count,\n\t\t\t\t\tloff_t *ppos,\n\t\t\t\t\tconst void *from,\n\t\t\t\t\tsize_t available);\n\nextern unsigned int snic_trace_max_pages;\n\n \nstruct snic_trc_data {\n\tu64\tts;\t\t \n\tchar\t*fn;\t\t \n\tu32\thno;\t\t \n\tu32\ttag;\t\t \n\tu64 data[5];\n} __attribute__((__packed__));\n\n#define SNIC_TRC_ENTRY_SZ  64\t \n\nstruct snic_trc {\n\tspinlock_t lock;\n\tstruct snic_trc_data *buf;\t \n\tu32\tmax_idx;\t\t \n\tu32\trd_idx;\n\tu32\twr_idx;\n\tbool\tenable;\t\t\t \n};\n\nint snic_trc_init(void);\nvoid snic_trc_free(void);\nvoid snic_trc_debugfs_init(void);\nvoid snic_trc_debugfs_term(void);\nstruct snic_trc_data *snic_get_trc_buf(void);\nint snic_get_trc_data(char *buf, int buf_sz);\n\nvoid snic_debugfs_init(void);\nvoid snic_debugfs_term(void);\n\nstatic inline void\nsnic_trace(char *fn, u16 hno, u32 tag, u64 d1, u64 d2, u64 d3, u64 d4, u64 d5)\n{\n\tstruct snic_trc_data *tr_rec = snic_get_trc_buf();\n\n\tif (!tr_rec)\n\t\treturn;\n\n\ttr_rec->fn = (char *)fn;\n\ttr_rec->hno = hno;\n\ttr_rec->tag = tag;\n\ttr_rec->data[0] = d1;\n\ttr_rec->data[1] = d2;\n\ttr_rec->data[2] = d3;\n\ttr_rec->data[3] = d4;\n\ttr_rec->data[4] = d5;\n\ttr_rec->ts = jiffies;  \n}\n\n#define SNIC_TRC(_hno, _tag, d1, d2, d3, d4, d5)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tif (unlikely(snic_glob->trc.enable))\t\t\t\\\n\t\t\tsnic_trace((char *)__func__,\t\t\t\\\n\t\t\t\t   (u16)(_hno),\t\t\t\t\\\n\t\t\t\t   (u32)(_tag),\t\t\t\t\\\n\t\t\t\t   (u64)(d1),\t\t\t\t\\\n\t\t\t\t   (u64)(d2),\t\t\t\t\\\n\t\t\t\t   (u64)(d3),\t\t\t\t\\\n\t\t\t\t   (u64)(d4),\t\t\t\t\\\n\t\t\t\t   (u64)(d5));\t\t\t\t\\\n\t} while (0)\n#else\n\n#define SNIC_TRC(_hno, _tag, d1, d2, d3, d4, d5)\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\tif (unlikely(snic_log_level & 0x2))\t\\\n\t\t\tSNIC_DBG(\"SnicTrace: %s %2u %2u %llx %llx %llx %llx %llx\", \\\n\t\t\t\t (char *)__func__,\t\\\n\t\t\t\t (u16)(_hno),\t\t\\\n\t\t\t\t (u32)(_tag),\t\t\\\n\t\t\t\t (u64)(d1),\t\t\\\n\t\t\t\t (u64)(d2),\t\t\\\n\t\t\t\t (u64)(d3),\t\t\\\n\t\t\t\t (u64)(d4),\t\t\\\n\t\t\t\t (u64)(d5));\t\t\\\n\t} while (0)\n#endif  \n\n#define SNIC_TRC_CMD(sc)\t\\\n\t((u64)sc->cmnd[0] << 56 | (u64)sc->cmnd[7] << 40 |\t\\\n\t (u64)sc->cmnd[8] << 32 | (u64)sc->cmnd[2] << 24 |\t\\\n\t (u64)sc->cmnd[3] << 16 | (u64)sc->cmnd[4] << 8 |\t\\\n\t (u64)sc->cmnd[5])\n\n#define SNIC_TRC_CMD_STATE_FLAGS(sc)\t\\\n\t((u64) CMD_FLAGS(sc) << 32 | CMD_STATE(sc))\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}