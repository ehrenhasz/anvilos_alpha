{
  "module_name": "bfad_drv.h",
  "hash_id": "d41038c1403d16043b023b18e74c9bbea52ffa7c293ee531b434baf033364d62",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/bfa/bfad_drv.h",
  "human_readable_source": " \n \n\n \n\n \n\n#ifndef __BFAD_DRV_H__\n#define __BFAD_DRV_H__\n\n#include <linux/types.h>\n#include <linux/pci.h>\n#include <linux/dma-mapping.h>\n#include <linux/idr.h>\n#include <linux/interrupt.h>\n#include <linux/cdev.h>\n#include <linux/fs.h>\n#include <linux/delay.h>\n#include <linux/vmalloc.h>\n#include <linux/workqueue.h>\n#include <linux/bitops.h>\n#include <scsi/scsi.h>\n#include <scsi/scsi_host.h>\n#include <scsi/scsi_tcq.h>\n#include <scsi/scsi_transport_fc.h>\n#include <scsi/scsi_transport.h>\n#include <scsi/scsi_bsg_fc.h>\n#include <scsi/scsi_devinfo.h>\n\n#include \"bfa_modules.h\"\n#include \"bfa_fcs.h\"\n#include \"bfa_defs_fcs.h\"\n\n#include \"bfa_plog.h\"\n#include \"bfa_cs.h\"\n\n#define BFAD_DRIVER_NAME\t\"bfa\"\n#ifdef BFA_DRIVER_VERSION\n#define BFAD_DRIVER_VERSION    BFA_DRIVER_VERSION\n#else\n#define BFAD_DRIVER_VERSION    \"3.2.25.1\"\n#endif\n\n#define BFAD_PROTO_NAME FCPI_NAME\n#define BFAD_IRQ_FLAGS IRQF_SHARED\n\n#ifndef FC_PORTSPEED_8GBIT\n#define FC_PORTSPEED_8GBIT 0x10\n#endif\n\n \n#define BFAD_MSIX_ON\t\t\t\t0x00000001\n#define BFAD_HAL_INIT_DONE\t\t\t0x00000002\n#define BFAD_DRV_INIT_DONE\t\t\t0x00000004\n#define BFAD_CFG_PPORT_DONE\t\t\t0x00000008\n#define BFAD_HAL_START_DONE\t\t\t0x00000010\n#define BFAD_PORT_ONLINE\t\t\t0x00000020\n#define BFAD_RPORT_ONLINE\t\t\t0x00000040\n#define BFAD_FCS_INIT_DONE\t\t\t0x00000080\n#define BFAD_HAL_INIT_FAIL\t\t\t0x00000100\n#define BFAD_FC4_PROBE_DONE\t\t\t0x00000200\n#define BFAD_PORT_DELETE\t\t\t0x00000001\n#define BFAD_INTX_ON\t\t\t\t0x00000400\n#define BFAD_EEH_BUSY\t\t\t\t0x00000800\n#define BFAD_EEH_PCI_CHANNEL_IO_PERM_FAILURE\t0x00001000\n \n#define SCSI_SCAN_DELAY\t\tHZ\n#define BFAD_STOP_TIMEOUT\t30\n#define BFAD_SUSPEND_TIMEOUT\tBFAD_STOP_TIMEOUT\n\n \n#define BFAD_LUN_QUEUE_DEPTH\t32\n#define BFAD_IO_MAX_SGE\t\tSG_ALL\n#define BFAD_MIN_SECTORS\t128  \n#define BFAD_MAX_SECTORS\t0xFFFF   \n\n#define bfad_isr_t irq_handler_t\n\n#define MAX_MSIX_ENTRY 22\n\nstruct bfad_msix_s {\n\tstruct bfad_s *bfad;\n\tstruct msix_entry msix;\n\tchar name[32];\n};\n\n \nenum {\n\tBFA_TRC_LDRV_BFAD\t\t= 1,\n\tBFA_TRC_LDRV_IM\t\t\t= 2,\n\tBFA_TRC_LDRV_BSG\t\t= 3,\n};\n\nenum bfad_port_pvb_type {\n\tBFAD_PORT_PHYS_BASE = 0,\n\tBFAD_PORT_PHYS_VPORT = 1,\n\tBFAD_PORT_VF_BASE = 2,\n\tBFAD_PORT_VF_VPORT = 3,\n};\n\n \nstruct bfad_port_s {\n\tstruct list_head list_entry;\n\tstruct bfad_s\t*bfad;\n\tstruct bfa_fcs_lport_s *fcs_port;\n\tu32\troles;\n\ts32\t\tflags;\n\tu32\tsupported_fc4s;\n\tenum bfad_port_pvb_type pvb_type;\n\tstruct bfad_im_port_s *im_port;\t \n\t \n\tstruct dentry *port_debugfs_root;\n};\n\n \nstruct bfad_vport_s {\n\tstruct bfad_port_s     drv_port;\n\tstruct bfa_fcs_vport_s fcs_vport;\n\tstruct completion *comp_del;\n\tstruct list_head list_entry;\n};\n\n \nstruct bfad_vf_s {\n\tbfa_fcs_vf_t    fcs_vf;\n\tstruct bfad_port_s    base_port;\t \n\tstruct bfad_s   *bfad;\n};\n\nstruct bfad_cfg_param_s {\n\tu32\trport_del_timeout;\n\tu32\tioc_queue_depth;\n\tu32\tlun_queue_depth;\n\tu32\tio_max_sge;\n\tu32\tbinding_method;\n};\n\nunion bfad_tmp_buf {\n\t \n\tchar\t\tmanufacturer[BFA_ADAPTER_MFG_NAME_LEN];\n\tchar\t\tserial_num[BFA_ADAPTER_SERIAL_NUM_LEN];\n\tchar\t\tmodel[BFA_ADAPTER_MODEL_NAME_LEN];\n\tchar\t\tfw_ver[BFA_VERSION_LEN];\n\tchar\t\toptrom_ver[BFA_VERSION_LEN];\n\n\t \n\tu8\t\tchip_rev[BFA_IOC_CHIP_REV_LEN];   \n\n\twwn_t\t\twwn[BFA_FCS_MAX_LPORTS];\n};\n\n \nstruct bfad_s {\n\tbfa_sm_t\tsm;\t \n\tstruct list_head list_entry;\n\tstruct bfa_s\tbfa;\n\tstruct bfa_fcs_s bfa_fcs;\n\tstruct pci_dev *pcidev;\n\tconst char *pci_name;\n\tstruct bfa_pcidev_s hal_pcidev;\n\tstruct bfa_ioc_pci_attr_s pci_attr;\n\tvoid __iomem   *pci_bar0_kva;\n\tvoid __iomem   *pci_bar2_kva;\n\tstruct completion comp;\n\tstruct completion suspend;\n\tstruct completion enable_comp;\n\tstruct completion disable_comp;\n\tbfa_boolean_t   disable_active;\n\tstruct bfad_port_s     pport;\t \n\tstruct bfa_meminfo_s meminfo;\n\tstruct bfa_iocfc_cfg_s   ioc_cfg;\n\tu32\tinst_no;\t \n\tu32\tbfad_flags;\n\tspinlock_t      bfad_lock;\n\tstruct task_struct *bfad_tsk;\n\tstruct bfad_cfg_param_s cfg_data;\n\tstruct bfad_msix_s msix_tab[MAX_MSIX_ENTRY];\n\tint\t\tnvec;\n\tchar\tadapter_name[BFA_ADAPTER_SYM_NAME_LEN];\n\tchar\tport_name[BFA_ADAPTER_SYM_NAME_LEN];\n\tstruct timer_list hal_tmo;\n\tunsigned long   hs_start;\n\tstruct bfad_im_s *im;\t\t \n\tstruct bfa_trc_mod_s  *trcmod;\n\tstruct bfa_plog_s      plog_buf;\n\tint\t\tref_count;\n\tunion bfad_tmp_buf tmp_buf;\n\tstruct fc_host_statistics link_stats;\n\tstruct list_head pbc_vport_list;\n\t \n\tchar *regdata;\n\tu32 reglen;\n\tstruct dentry *bfad_dentry_files[5];\n\tstruct list_head\tfree_aen_q;\n\tstruct list_head\tactive_aen_q;\n\tstruct bfa_aen_entry_s\taen_list[BFA_AEN_MAX_ENTRY];\n\tspinlock_t\t\tbfad_aen_spinlock;\n\tstruct list_head\tvport_list;\n};\n\n \nenum bfad_sm_event {\n\tBFAD_E_CREATE\t\t\t= 1,\n\tBFAD_E_KTHREAD_CREATE_FAILED\t= 2,\n\tBFAD_E_INIT\t\t\t= 3,\n\tBFAD_E_INIT_SUCCESS\t\t= 4,\n\tBFAD_E_HAL_INIT_FAILED\t\t= 5,\n\tBFAD_E_INIT_FAILED\t\t= 6,\n\tBFAD_E_FCS_EXIT_COMP\t\t= 7,\n\tBFAD_E_EXIT_COMP\t\t= 8,\n\tBFAD_E_STOP\t\t\t= 9\n};\n\n \nstruct bfad_rport_s {\n\tstruct bfa_fcs_rport_s fcs_rport;\n};\n\nstruct bfad_buf_info {\n\tvoid\t\t*virt;\n\tdma_addr_t      phys;\n\tu32\tsize;\n};\n\nstruct bfad_fcxp {\n\tstruct bfad_port_s    *port;\n\tstruct bfa_rport_s *bfa_rport;\n\tbfa_status_t    req_status;\n\tu16\ttag;\n\tu16\trsp_len;\n\tu16\trsp_maxlen;\n\tu8\t\tuse_ireqbuf;\n\tu8\t\tuse_irspbuf;\n\tu32\tnum_req_sgles;\n\tu32\tnum_rsp_sgles;\n\tstruct fchs_s\tfchs;\n\tvoid\t\t*reqbuf_info;\n\tvoid\t\t*rspbuf_info;\n\tstruct bfa_sge_s  *req_sge;\n\tstruct bfa_sge_s  *rsp_sge;\n\tfcxp_send_cb_t  send_cbfn;\n\tvoid\t\t*send_cbarg;\n\tvoid\t\t*bfa_fcxp;\n\tstruct completion comp;\n};\n\nstruct bfad_hal_comp {\n\tbfa_status_t    status;\n\tstruct completion comp;\n};\n\n#define BFA_LOG(level, bfad, mask, fmt, arg...)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (((mask) == 4) || (level[1] <= '4'))\t\t\t\t\\\n\t\tdev_printk(level, &((bfad)->pcidev)->dev, fmt, ##arg);\t\\\n} while (0)\n\nbfa_status_t\tbfad_vport_create(struct bfad_s *bfad, u16 vf_id,\n\t\t\t\t  struct bfa_lport_cfg_s *port_cfg,\n\t\t\t\t  struct device *dev);\nbfa_status_t\tbfad_vf_create(struct bfad_s *bfad, u16 vf_id,\n\t\t\t       struct bfa_lport_cfg_s *port_cfg);\nbfa_status_t\tbfad_cfg_pport(struct bfad_s *bfad, enum bfa_lport_role role);\nbfa_status_t\tbfad_drv_init(struct bfad_s *bfad);\nbfa_status_t\tbfad_start_ops(struct bfad_s *bfad);\nvoid\t\tbfad_drv_start(struct bfad_s *bfad);\nvoid\t\tbfad_uncfg_pport(struct bfad_s *bfad);\nvoid\t\tbfad_stop(struct bfad_s *bfad);\nvoid\t\tbfad_fcs_stop(struct bfad_s *bfad);\nvoid\t\tbfad_remove_intr(struct bfad_s *bfad);\nvoid\t\tbfad_hal_mem_release(struct bfad_s *bfad);\nvoid\t\tbfad_hcb_comp(void *arg, bfa_status_t status);\n\nint\t\tbfad_setup_intr(struct bfad_s *bfad);\nvoid\t\tbfad_remove_intr(struct bfad_s *bfad);\nvoid\t\tbfad_update_hal_cfg(struct bfa_iocfc_cfg_s *bfa_cfg);\nbfa_status_t\tbfad_hal_mem_alloc(struct bfad_s *bfad);\nvoid\t\tbfad_bfa_tmo(struct timer_list *t);\nvoid\t\tbfad_init_timer(struct bfad_s *bfad);\nint\t\tbfad_pci_init(struct pci_dev *pdev, struct bfad_s *bfad);\nvoid\t\tbfad_pci_uninit(struct pci_dev *pdev, struct bfad_s *bfad);\nvoid\t\tbfad_drv_uninit(struct bfad_s *bfad);\nint\t\tbfad_worker(void *ptr);\nvoid\t\tbfad_debugfs_init(struct bfad_port_s *port);\nvoid\t\tbfad_debugfs_exit(struct bfad_port_s *port);\n\nvoid bfad_pci_remove(struct pci_dev *pdev);\nint bfad_pci_probe(struct pci_dev *pdev, const struct pci_device_id *pid);\nvoid bfad_rport_online_wait(struct bfad_s *bfad);\nint bfad_get_linkup_delay(struct bfad_s *bfad);\nint bfad_install_msix_handler(struct bfad_s *bfad);\n\nextern struct idr bfad_im_port_index;\nextern struct pci_device_id bfad_id_table[];\nextern struct list_head bfad_list;\nextern char\t*os_name;\nextern char\t*os_patch;\nextern char\t*host_name;\nextern int\tnum_rports;\nextern int\tnum_ios;\nextern int\tnum_tms;\nextern int\tnum_fcxps;\nextern int\tnum_ufbufs;\nextern int\treqq_size;\nextern int\trspq_size;\nextern int\tnum_sgpgs;\nextern int      rport_del_timeout;\nextern int      bfa_lun_queue_depth;\nextern int      bfa_io_max_sge;\nextern int      bfa_log_level;\nextern int      ioc_auto_recover;\nextern int      bfa_linkup_delay;\nextern int      msix_disable_cb;\nextern int      msix_disable_ct;\nextern int      fdmi_enable;\nextern int      supported_fc4s;\nextern int\tpcie_max_read_reqsz;\nextern int\tmax_xfer_size;\nextern int bfa_debugfs_enable;\nextern struct mutex bfad_mutex;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}