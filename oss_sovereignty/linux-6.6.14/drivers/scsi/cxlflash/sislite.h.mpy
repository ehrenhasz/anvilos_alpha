{
  "module_name": "sislite.h",
  "hash_id": "5f7dbae70808ff0001c8afefc9ac5cf37b86797de221e5f4857e5f3ffb92f441",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/cxlflash/sislite.h",
  "human_readable_source": " \n \n\n#ifndef _SISLITE_H\n#define _SISLITE_H\n\n#include <linux/types.h>\n\ntypedef u16 ctx_hndl_t;\ntypedef u32 res_hndl_t;\n\n#define SIZE_4K\t\t4096\n#define SIZE_64K\t65536\n\n \nstruct sisl_ioarcb {\n\tu16 ctx_id;\t\t \n\tu16 req_flags;\n#define SISL_REQ_FLAGS_RES_HNDL       0x8000U\t \n#define SISL_REQ_FLAGS_PORT_LUN_ID    0x0000U\n\n#define SISL_REQ_FLAGS_SUP_UNDERRUN   0x4000U\t \n\n#define SISL_REQ_FLAGS_TIMEOUT_SECS   0x0000U\t \n#define SISL_REQ_FLAGS_TIMEOUT_MSECS  0x0040U\n#define SISL_REQ_FLAGS_TIMEOUT_USECS  0x0080U\n#define SISL_REQ_FLAGS_TIMEOUT_CYCLES 0x00C0U\n\n#define SISL_REQ_FLAGS_TMF_CMD        0x0004u\t \n\n#define SISL_REQ_FLAGS_AFU_CMD        0x0002U\t \n\n#define SISL_REQ_FLAGS_HOST_WRITE     0x0001U\t \n#define SISL_REQ_FLAGS_HOST_READ      0x0000U\n\n\tunion {\n\t\tu32 res_hndl;\t \n\t\tu32 port_sel;\t \n\t};\n\tu64 lun_id;\n\tu32 data_len;\t\t \n\tu32 ioadl_len;\n\tunion {\n\t\tu64 data_ea;\t \n\t\tu64 ioadl_ea;\n\t};\n\tu8 msi;\t\t\t \n#define SISL_MSI_CXL_PFAULT        0\t \n#define SISL_MSI_SYNC_ERROR        1\t \n#define SISL_MSI_RRQ_UPDATED       2\t \n#define SISL_MSI_ASYNC_ERROR       3\t \n\n\tu8 rrq;\t\t\t \n\tu16 timeout;\t\t \n\tu32 rsvd1;\n\tu8 cdb[16];\t\t \n#define SISL_AFU_CMD_SYNC\t\t0xC0\t \n#define SISL_AFU_CMD_LUN_PROVISION\t0xD0\t \n#define SISL_AFU_CMD_DEBUG\t\t0xE0\t \n\n#define SISL_AFU_LUN_PROVISION_CREATE\t0x00\t \n#define SISL_AFU_LUN_PROVISION_DELETE\t0x01\t \n\n\tunion {\n\t\tu64 reserved;\t\t\t \n\t\tstruct sisl_ioasa *ioasa;\t \n\t};\n} __packed;\n\nstruct sisl_rc {\n\tu8 flags;\n#define SISL_RC_FLAGS_SENSE_VALID         0x80U\n#define SISL_RC_FLAGS_FCP_RSP_CODE_VALID  0x40U\n#define SISL_RC_FLAGS_OVERRUN             0x20U\n#define SISL_RC_FLAGS_UNDERRUN            0x10U\n\n\tu8 afu_rc;\n#define SISL_AFU_RC_RHT_INVALID           0x01U\t \n#define SISL_AFU_RC_RHT_UNALIGNED         0x02U\t \n#define SISL_AFU_RC_RHT_OUT_OF_BOUNDS     0x03u\t \n#define SISL_AFU_RC_RHT_DMA_ERR           0x04u\t \n#define SISL_AFU_RC_RHT_RW_PERM           0x05u\t \n#define SISL_AFU_RC_LXT_UNALIGNED         0x12U\t \n#define SISL_AFU_RC_LXT_OUT_OF_BOUNDS     0x13u\t \n#define SISL_AFU_RC_LXT_DMA_ERR           0x14u\t \n#define SISL_AFU_RC_LXT_RW_PERM           0x15u\t \n\n#define SISL_AFU_RC_NOT_XLATE_HOST        0x1au\t \n\n\t \n#define SISL_AFU_RC_NO_CHANNELS           0x20U\t \n#define SISL_AFU_RC_CAP_VIOLATION         0x21U\t \n#define SISL_AFU_RC_OUT_OF_DATA_BUFS      0x30U\t \n#define SISL_AFU_RC_DATA_DMA_ERR          0x31U\t \n\n\tu8 scsi_rc;\t\t \n#define SISL_SCSI_RC_CHECK                0x02U\n#define SISL_SCSI_RC_BUSY                 0x08u\n\n\tu8 fc_rc;\t\t \n\t \n#define SISL_FC_RC_ABORTPEND\t0x52\t \n#define SISL_FC_RC_WRABORTPEND\t0x53\t \n#define SISL_FC_RC_NOLOGI\t0x54\t \n#define SISL_FC_RC_NOEXP\t0x55\t \n#define SISL_FC_RC_INUSE\t0x56\t \n#define SISL_FC_RC_LINKDOWN\t0x57\t \n#define SISL_FC_RC_ABORTOK\t0x58\t \n#define SISL_FC_RC_ABORTFAIL\t0x59\t \n#define SISL_FC_RC_RESID\t0x5A\t \n#define SISL_FC_RC_RESIDERR\t0x5B\t \n#define SISL_FC_RC_TGTABORT\t0x5C\t \n};\n\n#define SISL_SENSE_DATA_LEN     20\t \n#define SISL_WWID_DATA_LEN\t16\t \n\n \nstruct sisl_ioasa {\n\tunion {\n\t\tstruct sisl_rc rc;\n\t\tu32 ioasc;\n#define SISL_IOASC_GOOD_COMPLETION        0x00000000U\n\t};\n\n\tunion {\n\t\tu32 resid;\n\t\tu32 lunid_hi;\n\t};\n\n\tu8 port;\n\tu8 afu_extra;\n\t \n#define SISL_AFU_DMA_ERR_PAGE_IN\t0x0A\t \n#define SISL_AFU_DMA_ERR_INVALID_EA\t0x0B\t \n\t \n#define SISL_AFU_NO_CLANNELS_AMASK(afu_extra) (((afu_extra) & 0x0C) >> 2)\n#define SISL_AFU_NO_CLANNELS_RMASK(afu_extra) ((afu_extra) & 0x03)\n\n\tu8 scsi_extra;\n\tu8 fc_extra;\n\n\tunion {\n\t\tu8 sense_data[SISL_SENSE_DATA_LEN];\n\t\tstruct {\n\t\t\tu32 lunid_lo;\n\t\t\tu8 wwid[SISL_WWID_DATA_LEN];\n\t\t};\n\t};\n\n\t \n\tunion {\n\t\tu64 host_use[4];\n\t\tu8 host_use_b[32];\n\t};\n} __packed;\n\n#define SISL_RESP_HANDLE_T_BIT        0x1ULL\t \n\n \n\n \n#define SISL_ENDIAN_CTRL_BE           0x8000000000000080ULL\n#define SISL_ENDIAN_CTRL_LE           0x0000000000000000ULL\n\n#ifdef __BIG_ENDIAN\n#define SISL_ENDIAN_CTRL              SISL_ENDIAN_CTRL_BE\n#else\n#define SISL_ENDIAN_CTRL              SISL_ENDIAN_CTRL_LE\n#endif\n\n \nstruct sisl_host_map {\n\t__be64 endian_ctrl;\t \n\n\t__be64 intr_status;\t \n#define SISL_ISTATUS_PERM_ERR_LISN_3_EA\t\t0x0400ULL  \n#define SISL_ISTATUS_PERM_ERR_LISN_2_EA\t\t0x0200ULL  \n#define SISL_ISTATUS_PERM_ERR_LISN_1_EA\t\t0x0100ULL  \n#define SISL_ISTATUS_PERM_ERR_LISN_3_PASID\t0x0080ULL  \n#define SISL_ISTATUS_PERM_ERR_LISN_2_PASID\t0x0040ULL  \n#define SISL_ISTATUS_PERM_ERR_LISN_1_PASID\t0x0020ULL  \n#define SISL_ISTATUS_PERM_ERR_CMDROOM\t\t0x0010ULL  \n#define SISL_ISTATUS_PERM_ERR_RCB_READ\t\t0x0008ULL  \n#define SISL_ISTATUS_PERM_ERR_SA_WRITE\t\t0x0004ULL  \n#define SISL_ISTATUS_PERM_ERR_RRQ_WRITE\t\t0x0002ULL  \n\t \n#define SISL_ISTATUS_TEMP_ERR_PAGEIN\t\t0x0001ULL  \n#define SISL_ISTATUS_UNMASK\t(0x07FFULL)\t\t \n#define SISL_ISTATUS_MASK\t~(SISL_ISTATUS_UNMASK)\t \n\n\t__be64 intr_clear;\n\t__be64 intr_mask;\n\t__be64 ioarrin;\t\t \n\t__be64 rrq_start;\t \n\t__be64 rrq_end;\t\t \n\t__be64 cmd_room;\n\t__be64 ctx_ctrl;\t \n#define SISL_CTX_CTRL_UNMAP_SECTOR\t0x8000000000000000ULL  \n#define SISL_CTX_CTRL_LISN_MASK\t\t(0xFFULL)\n\t__be64 mbox_w;\t\t \n\t__be64 sq_start;\t \n\t__be64 sq_end;\t\t \n\t__be64 sq_head;\t\t \n\t__be64 sq_tail;\t\t \n\t__be64 sq_ctx_reset;\t \n};\n\n \nstruct sisl_ctrl_map {\n\t__be64 rht_start;\n\t__be64 rht_cnt_id;\n\t \n#define SISL_RHT_CNT_ID(cnt, ctx_id)  (((cnt) << 48) | ((ctx_id) << 32))\n\n\t__be64 ctx_cap;\t \n#define SISL_CTX_CAP_PROXY_ISSUE       0x8000000000000000ULL  \n#define SISL_CTX_CAP_REAL_MODE         0x4000000000000000ULL  \n#define SISL_CTX_CAP_HOST_XLATE        0x2000000000000000ULL  \n#define SISL_CTX_CAP_PROXY_TARGET      0x1000000000000000ULL  \n#define SISL_CTX_CAP_AFU_CMD           0x0000000000000008ULL  \n#define SISL_CTX_CAP_GSCSI_CMD         0x0000000000000004ULL  \n#define SISL_CTX_CAP_WRITE_CMD         0x0000000000000002ULL  \n#define SISL_CTX_CAP_READ_CMD          0x0000000000000001ULL  \n\t__be64 mbox_r;\n\t__be64 lisn_pasid[2];\n\t \n#define SISL_LISN_PASID(_a, _b)\t(((_a) << 32) | (_b))\n\t__be64 lisn_ea[3];\n};\n\n \nstruct sisl_global_regs {\n\t__be64 aintr_status;\n\t \n#define SISL_ASTATUS_FC2_OTHER\t 0x80000000ULL  \n#define SISL_ASTATUS_FC2_LOGO    0x40000000ULL  \n#define SISL_ASTATUS_FC2_CRC_T   0x20000000ULL  \n#define SISL_ASTATUS_FC2_LOGI_R  0x10000000ULL  \n#define SISL_ASTATUS_FC2_LOGI_F  0x08000000ULL  \n#define SISL_ASTATUS_FC2_LOGI_S  0x04000000ULL  \n#define SISL_ASTATUS_FC2_LINK_DN 0x02000000ULL  \n#define SISL_ASTATUS_FC2_LINK_UP 0x01000000ULL  \n\n#define SISL_ASTATUS_FC3_OTHER   0x00800000ULL  \n#define SISL_ASTATUS_FC3_LOGO    0x00400000ULL  \n#define SISL_ASTATUS_FC3_CRC_T   0x00200000ULL  \n#define SISL_ASTATUS_FC3_LOGI_R  0x00100000ULL  \n#define SISL_ASTATUS_FC3_LOGI_F  0x00080000ULL  \n#define SISL_ASTATUS_FC3_LOGI_S  0x00040000ULL  \n#define SISL_ASTATUS_FC3_LINK_DN 0x00020000ULL  \n#define SISL_ASTATUS_FC3_LINK_UP 0x00010000ULL  \n\n#define SISL_ASTATUS_FC0_OTHER\t 0x00008000ULL  \n#define SISL_ASTATUS_FC0_LOGO    0x00004000ULL  \n#define SISL_ASTATUS_FC0_CRC_T   0x00002000ULL  \n#define SISL_ASTATUS_FC0_LOGI_R  0x00001000ULL  \n#define SISL_ASTATUS_FC0_LOGI_F  0x00000800ULL  \n#define SISL_ASTATUS_FC0_LOGI_S  0x00000400ULL  \n#define SISL_ASTATUS_FC0_LINK_DN 0x00000200ULL  \n#define SISL_ASTATUS_FC0_LINK_UP 0x00000100ULL  \n\n#define SISL_ASTATUS_FC1_OTHER   0x00000080ULL  \n#define SISL_ASTATUS_FC1_LOGO    0x00000040ULL  \n#define SISL_ASTATUS_FC1_CRC_T   0x00000020ULL  \n#define SISL_ASTATUS_FC1_LOGI_R  0x00000010ULL  \n#define SISL_ASTATUS_FC1_LOGI_F  0x00000008ULL  \n#define SISL_ASTATUS_FC1_LOGI_S  0x00000004ULL  \n#define SISL_ASTATUS_FC1_LINK_DN 0x00000002ULL  \n#define SISL_ASTATUS_FC1_LINK_UP 0x00000001ULL  \n\n#define SISL_FC_INTERNAL_UNMASK\t0x0000000300000000ULL\t \n#define SISL_FC_INTERNAL_MASK\t~(SISL_FC_INTERNAL_UNMASK)\n#define SISL_FC_INTERNAL_SHIFT\t32\n\n#define SISL_FC_SHUTDOWN_NORMAL\t\t0x0000000000000010ULL\n#define SISL_FC_SHUTDOWN_ABRUPT\t\t0x0000000000000020ULL\n\n#define SISL_STATUS_SHUTDOWN_ACTIVE\t0x0000000000000010ULL\n#define SISL_STATUS_SHUTDOWN_COMPLETE\t0x0000000000000020ULL\n\n#define SISL_ASTATUS_UNMASK\t0xFFFFFFFFULL\t\t \n#define SISL_ASTATUS_MASK\t~(SISL_ASTATUS_UNMASK)\t \n\n\t__be64 aintr_clear;\n\t__be64 aintr_mask;\n\t__be64 afu_ctrl;\n\t__be64 afu_hb;\n\t__be64 afu_scratch_pad;\n\t__be64 afu_port_sel;\n#define SISL_AFUCONF_AR_IOARCB\t0x4000ULL\n#define SISL_AFUCONF_AR_LXT\t0x2000ULL\n#define SISL_AFUCONF_AR_RHT\t0x1000ULL\n#define SISL_AFUCONF_AR_DATA\t0x0800ULL\n#define SISL_AFUCONF_AR_RSRC\t0x0400ULL\n#define SISL_AFUCONF_AR_IOASA\t0x0200ULL\n#define SISL_AFUCONF_AR_RRQ\t0x0100ULL\n \n#define SISL_AFUCONF_AR_ALL\t(SISL_AFUCONF_AR_IOARCB|SISL_AFUCONF_AR_LXT| \\\n\t\t\t\t SISL_AFUCONF_AR_RHT|SISL_AFUCONF_AR_DATA|   \\\n\t\t\t\t SISL_AFUCONF_AR_RSRC|SISL_AFUCONF_AR_IOASA| \\\n\t\t\t\t SISL_AFUCONF_AR_RRQ)\n#ifdef __BIG_ENDIAN\n#define SISL_AFUCONF_ENDIAN            0x0000ULL\n#else\n#define SISL_AFUCONF_ENDIAN            0x0020ULL\n#endif\n#define SISL_AFUCONF_MBOX_CLR_READ     0x0010ULL\n\t__be64 afu_config;\n\t__be64 rsvd[0xf8];\n\t__le64 afu_version;\n\t__be64 interface_version;\n#define SISL_INTVER_CAP_SHIFT\t\t\t16\n#define SISL_INTVER_MAJ_SHIFT\t\t\t8\n#define SISL_INTVER_CAP_MASK\t\t\t0xFFFFFFFF00000000ULL\n#define SISL_INTVER_MAJ_MASK\t\t\t0x00000000FFFF0000ULL\n#define SISL_INTVER_MIN_MASK\t\t\t0x000000000000FFFFULL\n#define SISL_INTVER_CAP_IOARRIN_CMD_MODE\t0x800000000000ULL\n#define SISL_INTVER_CAP_SQ_CMD_MODE\t\t0x400000000000ULL\n#define SISL_INTVER_CAP_RESERVED_CMD_MODE_A\t0x200000000000ULL\n#define SISL_INTVER_CAP_RESERVED_CMD_MODE_B\t0x100000000000ULL\n#define SISL_INTVER_CAP_LUN_PROVISION\t\t0x080000000000ULL\n#define SISL_INTVER_CAP_AFU_DEBUG\t\t0x040000000000ULL\n#define SISL_INTVER_CAP_OCXL_LISN\t\t0x020000000000ULL\n};\n\n#define CXLFLASH_NUM_FC_PORTS_PER_BANK\t2\t \n#define CXLFLASH_MAX_FC_BANKS\t\t2\t \n#define CXLFLASH_MAX_FC_PORTS\t(CXLFLASH_NUM_FC_PORTS_PER_BANK *\t\\\n\t\t\t\t CXLFLASH_MAX_FC_BANKS)\n#define CXLFLASH_MAX_CONTEXT\t512\t \n#define CXLFLASH_NUM_VLUNS\t512\t \n#define CXLFLASH_NUM_REGS\t512\t \n\nstruct fc_port_bank {\n\t__be64 fc_port_regs[CXLFLASH_NUM_FC_PORTS_PER_BANK][CXLFLASH_NUM_REGS];\n\t__be64 fc_port_luns[CXLFLASH_NUM_FC_PORTS_PER_BANK][CXLFLASH_NUM_VLUNS];\n};\n\nstruct sisl_global_map {\n\tunion {\n\t\tstruct sisl_global_regs regs;\n\t\tchar page0[SIZE_4K];\t \n\t};\n\n\tchar page1[SIZE_4K];\t \n\n\tstruct fc_port_bank bank[CXLFLASH_MAX_FC_BANKS];  \n\n\t \n\n};\n\n \nstruct cxlflash_afu_map {\n\tunion {\n\t\tstruct sisl_host_map host;\n\t\tchar harea[SIZE_64K];\t \n\t} hosts[CXLFLASH_MAX_CONTEXT];\n\n\tunion {\n\t\tstruct sisl_ctrl_map ctrl;\n\t\tchar carea[cache_line_size()];\t \n\t} ctrls[CXLFLASH_MAX_CONTEXT];\n\n\tunion {\n\t\tstruct sisl_global_map global;\n\t\tchar garea[SIZE_64K];\t \n\t};\n};\n\n \nstruct sisl_lxt_entry {\n\tu64 rlba_base;\t \n};\n\n \nstruct sisl_rht_entry {\n\tstruct sisl_lxt_entry *lxt_start;\n\tu32 lxt_cnt;\n\tu16 rsvd;\n\tu8 fp;\t\t\t \n\tu8 nmask;\n} __packed __aligned(16);\n\nstruct sisl_rht_entry_f1 {\n\tu64 lun_id;\n\tunion {\n\t\tstruct {\n\t\t\tu8 valid;\n\t\t\tu8 rsvd[5];\n\t\t\tu8 fp;\n\t\t\tu8 port_sel;\n\t\t};\n\n\t\tu64 dw;\n\t};\n} __packed __aligned(16);\n\n \n#define SISL_RHT_FP(fmt, perm) (((fmt) << 4) | (perm))\n\n \n#define SISL_RHT_FP_CLONE(src_fp, cln_flags) ((src_fp) & (0xFC | (cln_flags)))\n\n#define RHT_PERM_READ  0x01U\n#define RHT_PERM_WRITE 0x02U\n#define RHT_PERM_RW    (RHT_PERM_READ | RHT_PERM_WRITE)\n\n \n#define SISL_RHT_PERM(fp) ((fp) & RHT_PERM_RW)\n\n#define PORT0  0x01U\n#define PORT1  0x02U\n#define PORT2  0x04U\n#define PORT3  0x08U\n#define PORT_MASK(_n)\t((1 << (_n)) - 1)\n\n \n#define AFU_LW_SYNC 0x0U\n#define AFU_HW_SYNC 0x1U\n#define AFU_GSYNC   0x2U\n\n \n#define TMF_LUN_RESET  0x1U\n#define TMF_CLEAR_ACA  0x2U\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}