{
  "module_name": "hisi_sas.h",
  "hash_id": "378e2e54f52cbb3e8a8afb1954a6def0a902bcf174f2155098f3b69b65aac547",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/hisi_sas/hisi_sas.h",
  "human_readable_source": " \n \n\n#ifndef _HISI_SAS_H_\n#define _HISI_SAS_H_\n\n#include <linux/acpi.h>\n#include <linux/blk-mq.h>\n#include <linux/blk-mq-pci.h>\n#include <linux/clk.h>\n#include <linux/debugfs.h>\n#include <linux/dmapool.h>\n#include <linux/iopoll.h>\n#include <linux/irq.h>\n#include <linux/lcm.h>\n#include <linux/libata.h>\n#include <linux/mfd/syscon.h>\n#include <linux/module.h>\n#include <linux/of_address.h>\n#include <linux/pci.h>\n#include <linux/platform_device.h>\n#include <linux/pm_runtime.h>\n#include <linux/property.h>\n#include <linux/regmap.h>\n#include <linux/timer.h>\n#include <scsi/sas_ata.h>\n#include <scsi/libsas.h>\n\n#define HISI_SAS_MAX_PHYS\t9\n#define HISI_SAS_MAX_QUEUES\t32\n#define HISI_SAS_QUEUE_SLOTS\t4096\n#define HISI_SAS_MAX_ITCT_ENTRIES 1024\n#define HISI_SAS_MAX_DEVICES HISI_SAS_MAX_ITCT_ENTRIES\n#define HISI_SAS_RESETTING_BIT\t0\n#define HISI_SAS_REJECT_CMD_BIT\t1\n#define HISI_SAS_PM_BIT\t\t2\n#define HISI_SAS_HW_FAULT_BIT\t3\n#define HISI_SAS_MAX_COMMANDS (HISI_SAS_QUEUE_SLOTS)\n#define HISI_SAS_RESERVED_IPTT  96\n#define HISI_SAS_UNRESERVED_IPTT \\\n\t(HISI_SAS_MAX_COMMANDS - HISI_SAS_RESERVED_IPTT)\n\n#define HISI_SAS_IOST_ITCT_CACHE_NUM 64\n#define HISI_SAS_IOST_ITCT_CACHE_DW_SZ 10\n#define HISI_SAS_FIFO_DATA_DW_SIZE 32\n\n#define HISI_SAS_STATUS_BUF_SZ (sizeof(struct hisi_sas_status_buffer))\n#define HISI_SAS_COMMAND_TABLE_SZ (sizeof(union hisi_sas_command_table))\n\n#define hisi_sas_status_buf_addr(buf) \\\n\t((buf) + offsetof(struct hisi_sas_slot_buf_table, status_buffer))\n#define hisi_sas_status_buf_addr_mem(slot) hisi_sas_status_buf_addr((slot)->buf)\n#define hisi_sas_status_buf_addr_dma(slot) \\\n\thisi_sas_status_buf_addr((slot)->buf_dma)\n\n#define hisi_sas_cmd_hdr_addr(buf) \\\n\t((buf) + offsetof(struct hisi_sas_slot_buf_table, command_header))\n#define hisi_sas_cmd_hdr_addr_mem(slot) hisi_sas_cmd_hdr_addr((slot)->buf)\n#define hisi_sas_cmd_hdr_addr_dma(slot) hisi_sas_cmd_hdr_addr((slot)->buf_dma)\n\n#define hisi_sas_sge_addr(buf) \\\n\t((buf) + offsetof(struct hisi_sas_slot_buf_table, sge_page))\n#define hisi_sas_sge_addr_mem(slot) hisi_sas_sge_addr((slot)->buf)\n#define hisi_sas_sge_addr_dma(slot) hisi_sas_sge_addr((slot)->buf_dma)\n\n#define hisi_sas_sge_dif_addr(buf) \\\n\t((buf) + offsetof(struct hisi_sas_slot_dif_buf_table, sge_dif_page))\n#define hisi_sas_sge_dif_addr_mem(slot) hisi_sas_sge_dif_addr((slot)->buf)\n#define hisi_sas_sge_dif_addr_dma(slot) hisi_sas_sge_dif_addr((slot)->buf_dma)\n\n#define HISI_SAS_MAX_SSP_RESP_SZ (sizeof(struct ssp_frame_hdr) + 1024)\n#define HISI_SAS_MAX_SMP_RESP_SZ 1028\n#define HISI_SAS_MAX_STP_RESP_SZ 28\n\n#define HISI_SAS_SATA_PROTOCOL_NONDATA\t\t0x1\n#define HISI_SAS_SATA_PROTOCOL_PIO\t\t\t0x2\n#define HISI_SAS_SATA_PROTOCOL_DMA\t\t\t0x4\n#define HISI_SAS_SATA_PROTOCOL_FPDMA\t\t0x8\n#define HISI_SAS_SATA_PROTOCOL_ATAPI\t\t0x10\n\n#define HISI_SAS_DIF_PROT_MASK (SHOST_DIF_TYPE1_PROTECTION | \\\n\t\t\t\tSHOST_DIF_TYPE2_PROTECTION | \\\n\t\t\t\tSHOST_DIF_TYPE3_PROTECTION)\n\n#define HISI_SAS_DIX_PROT_MASK (SHOST_DIX_TYPE1_PROTECTION | \\\n\t\t\t\tSHOST_DIX_TYPE2_PROTECTION | \\\n\t\t\t\tSHOST_DIX_TYPE3_PROTECTION)\n\n#define HISI_SAS_PROT_MASK (HISI_SAS_DIF_PROT_MASK | HISI_SAS_DIX_PROT_MASK)\n\n#define HISI_SAS_WAIT_PHYUP_TIMEOUT\t(30 * HZ)\n#define HISI_SAS_CLEAR_ITCT_TIMEOUT\t(20 * HZ)\n\nstruct hisi_hba;\n\nenum {\n\tPORT_TYPE_SAS = (1U << 1),\n\tPORT_TYPE_SATA = (1U << 0),\n};\n\nenum dev_status {\n\tHISI_SAS_DEV_INIT,\n\tHISI_SAS_DEV_NORMAL,\n\tHISI_SAS_DEV_NCQ_ERR,\n};\n\nenum {\n\tHISI_SAS_INT_ABT_CMD = 0,\n\tHISI_SAS_INT_ABT_DEV = 1,\n};\n\nenum hisi_sas_dev_type {\n\tHISI_SAS_DEV_TYPE_STP = 0,\n\tHISI_SAS_DEV_TYPE_SSP,\n\tHISI_SAS_DEV_TYPE_SATA,\n};\n\nstruct hisi_sas_hw_error {\n\tu32 irq_msk;\n\tu32 msk;\n\tint shift;\n\tconst char *msg;\n\tint reg;\n\tconst struct hisi_sas_hw_error *sub;\n};\n\nstruct hisi_sas_rst {\n\tstruct hisi_hba *hisi_hba;\n\tstruct completion *completion;\n\tstruct work_struct work;\n\tbool done;\n};\n\n#define HISI_SAS_RST_WORK_INIT(r, c) \\\n\t{\t.hisi_hba = hisi_hba, \\\n\t\t.completion = &c, \\\n\t\t.work = __WORK_INITIALIZER(r.work, \\\n\t\t\t\thisi_sas_sync_rst_work_handler), \\\n\t\t.done = false, \\\n\t\t}\n\n#define HISI_SAS_DECLARE_RST_WORK_ON_STACK(r) \\\n\tDECLARE_COMPLETION_ONSTACK(c); \\\n\tstruct hisi_sas_rst r = HISI_SAS_RST_WORK_INIT(r, c)\n\nenum hisi_sas_bit_err_type {\n\tHISI_SAS_ERR_SINGLE_BIT_ECC = 0x0,\n\tHISI_SAS_ERR_MULTI_BIT_ECC = 0x1,\n};\n\nenum hisi_sas_phy_event {\n\tHISI_PHYE_PHY_UP   = 0U,\n\tHISI_PHYE_LINK_RESET,\n\tHISI_PHYE_PHY_UP_PM,\n\tHISI_PHYES_NUM,\n};\n\nstruct hisi_sas_debugfs_fifo {\n\tu32 signal_sel;\n\tu32 dump_msk;\n\tu32 dump_mode;\n\tu32 trigger;\n\tu32 trigger_msk;\n\tu32 trigger_mode;\n\tu32 rd_data[HISI_SAS_FIFO_DATA_DW_SIZE];\n};\n\nstruct hisi_sas_phy {\n\tstruct work_struct\tworks[HISI_PHYES_NUM];\n\tstruct hisi_hba\t*hisi_hba;\n\tstruct hisi_sas_port\t*port;\n\tstruct asd_sas_phy\tsas_phy;\n\tstruct sas_identify\tidentify;\n\tstruct completion *reset_completion;\n\tstruct timer_list timer;\n\tspinlock_t lock;\n\tu64\t\tport_id;  \n\tu64\t\tframe_rcvd_size;\n\tu8\t\tframe_rcvd[32];\n\tu8\t\tphy_attached;\n\tu8\t\tin_reset;\n\tu8\t\treserved[2];\n\tu32\t\tphy_type;\n\tu32\t\tcode_violation_err_count;\n\tenum sas_linkrate\tminimum_linkrate;\n\tenum sas_linkrate\tmaximum_linkrate;\n\tint enable;\n\tint wait_phyup_cnt;\n\tatomic_t down_cnt;\n\n\t \n\tstruct hisi_sas_debugfs_fifo fifo;\n};\n\nstruct hisi_sas_port {\n\tstruct asd_sas_port\tsas_port;\n\tu8\tport_attached;\n\tu8\tid;  \n};\n\nstruct hisi_sas_cq {\n\tstruct hisi_hba *hisi_hba;\n\tconst struct cpumask *irq_mask;\n\tint\trd_point;\n\tint\tid;\n\tint\tirq_no;\n\tspinlock_t poll_lock;\n};\n\nstruct hisi_sas_dq {\n\tstruct hisi_hba *hisi_hba;\n\tstruct list_head list;\n\tspinlock_t lock;\n\tint\twr_point;\n\tint\tid;\n};\n\nstruct hisi_sas_device {\n\tstruct hisi_hba\t\t*hisi_hba;\n\tstruct domain_device\t*sas_device;\n\tstruct completion *completion;\n\tstruct hisi_sas_dq\t*dq;\n\tstruct list_head\tlist;\n\tenum sas_device_type\tdev_type;\n\tenum dev_status dev_status;\n\tint device_id;\n\tint sata_idx;\n\tspinlock_t lock;  \n};\n\nstruct hisi_sas_slot {\n\tstruct list_head entry;\n\tstruct list_head delivery;\n\tstruct sas_task *task;\n\tstruct hisi_sas_port\t*port;\n\tu64\tn_elem;\n\tu64\tn_elem_dif;\n\tint\tdlvry_queue;\n\tint\tdlvry_queue_slot;\n\tint\tcmplt_queue;\n\tint\tcmplt_queue_slot;\n\tint\tabort;\n\tint\tready;\n\tint\tdevice_id;\n\tvoid\t*cmd_hdr;\n\tdma_addr_t cmd_hdr_dma;\n\tstruct timer_list internal_abort_timer;\n\tbool is_internal;\n\tstruct sas_tmf_task *tmf;\n\t \n\tvoid\t*buf;\n\tdma_addr_t buf_dma;\n\tu16\tidx;\n};\n\nstruct hisi_sas_iost_itct_cache {\n\tu32 data[HISI_SAS_IOST_ITCT_CACHE_DW_SZ];\n};\n\nenum hisi_sas_debugfs_reg_array_member {\n\tDEBUGFS_GLOBAL = 0,\n\tDEBUGFS_AXI,\n\tDEBUGFS_RAS,\n\tDEBUGFS_REGS_NUM\n};\n\nenum hisi_sas_debugfs_cache_type {\n\tHISI_SAS_ITCT_CACHE,\n\tHISI_SAS_IOST_CACHE,\n};\n\nenum hisi_sas_debugfs_bist_ffe_cfg {\n\tFFE_SAS_1_5_GBPS,\n\tFFE_SAS_3_0_GBPS,\n\tFFE_SAS_6_0_GBPS,\n\tFFE_SAS_12_0_GBPS,\n\tFFE_RESV,\n\tFFE_SATA_1_5_GBPS,\n\tFFE_SATA_3_0_GBPS,\n\tFFE_SATA_6_0_GBPS,\n\tFFE_CFG_MAX\n};\n\nenum hisi_sas_debugfs_bist_fixed_code {\n\tFIXED_CODE,\n\tFIXED_CODE_1,\n\tFIXED_CODE_MAX\n};\n\nenum {\n\tHISI_SAS_BIST_CODE_MODE_PRBS7,\n\tHISI_SAS_BIST_CODE_MODE_PRBS23,\n\tHISI_SAS_BIST_CODE_MODE_PRBS31,\n\tHISI_SAS_BIST_CODE_MODE_JTPAT,\n\tHISI_SAS_BIST_CODE_MODE_CJTPAT,\n\tHISI_SAS_BIST_CODE_MODE_SCRAMBED_0,\n\tHISI_SAS_BIST_CODE_MODE_TRAIN,\n\tHISI_SAS_BIST_CODE_MODE_TRAIN_DONE,\n\tHISI_SAS_BIST_CODE_MODE_HFTP,\n\tHISI_SAS_BIST_CODE_MODE_MFTP,\n\tHISI_SAS_BIST_CODE_MODE_LFTP,\n\tHISI_SAS_BIST_CODE_MODE_FIXED_DATA,\n};\n\nstruct hisi_sas_hw {\n\tint (*hw_init)(struct hisi_hba *hisi_hba);\n\tint (*interrupt_preinit)(struct hisi_hba *hisi_hba);\n\tvoid (*setup_itct)(struct hisi_hba *hisi_hba,\n\t\t\t   struct hisi_sas_device *device);\n\tint (*slot_index_alloc)(struct hisi_hba *hisi_hba,\n\t\t\t\tstruct domain_device *device);\n\tstruct hisi_sas_device *(*alloc_dev)(struct domain_device *device);\n\tvoid (*sl_notify_ssp)(struct hisi_hba *hisi_hba, int phy_no);\n\tvoid (*start_delivery)(struct hisi_sas_dq *dq);\n\tvoid (*prep_ssp)(struct hisi_hba *hisi_hba,\n\t\t\tstruct hisi_sas_slot *slot);\n\tvoid (*prep_smp)(struct hisi_hba *hisi_hba,\n\t\t\tstruct hisi_sas_slot *slot);\n\tvoid (*prep_stp)(struct hisi_hba *hisi_hba,\n\t\t\tstruct hisi_sas_slot *slot);\n\tvoid (*prep_abort)(struct hisi_hba *hisi_hba,\n\t\t\t  struct hisi_sas_slot *slot);\n\tvoid (*phys_init)(struct hisi_hba *hisi_hba);\n\tvoid (*phy_start)(struct hisi_hba *hisi_hba, int phy_no);\n\tvoid (*phy_disable)(struct hisi_hba *hisi_hba, int phy_no);\n\tvoid (*phy_hard_reset)(struct hisi_hba *hisi_hba, int phy_no);\n\tvoid (*get_events)(struct hisi_hba *hisi_hba, int phy_no);\n\tvoid (*phy_set_linkrate)(struct hisi_hba *hisi_hba, int phy_no,\n\t\t\tstruct sas_phy_linkrates *linkrates);\n\tenum sas_linkrate (*phy_get_max_linkrate)(void);\n\tint (*clear_itct)(struct hisi_hba *hisi_hba,\n\t\t\t  struct hisi_sas_device *dev);\n\tvoid (*free_device)(struct hisi_sas_device *sas_dev);\n\tint (*get_wideport_bitmap)(struct hisi_hba *hisi_hba, int port_id);\n\tvoid (*dereg_device)(struct hisi_hba *hisi_hba,\n\t\t\t\tstruct domain_device *device);\n\tint (*soft_reset)(struct hisi_hba *hisi_hba);\n\tu32 (*get_phys_state)(struct hisi_hba *hisi_hba);\n\tint (*write_gpio)(struct hisi_hba *hisi_hba, u8 reg_type,\n\t\t\t\tu8 reg_index, u8 reg_count, u8 *write_data);\n\tvoid (*wait_cmds_complete_timeout)(struct hisi_hba *hisi_hba,\n\t\t\t\t\t   int delay_ms, int timeout_ms);\n\tvoid (*debugfs_snapshot_regs)(struct hisi_hba *hisi_hba);\n\tint complete_hdr_size;\n\tconst struct scsi_host_template *sht;\n};\n\n#define HISI_SAS_MAX_DEBUGFS_DUMP (50)\n\nstruct hisi_sas_debugfs_cq {\n\tstruct hisi_sas_cq *cq;\n\tvoid *complete_hdr;\n};\n\nstruct hisi_sas_debugfs_dq {\n\tstruct hisi_sas_dq *dq;\n\tstruct hisi_sas_cmd_hdr *hdr;\n};\n\nstruct hisi_sas_debugfs_regs {\n\tstruct hisi_hba *hisi_hba;\n\tu32 *data;\n};\n\nstruct hisi_sas_debugfs_port {\n\tstruct hisi_sas_phy *phy;\n\tu32 *data;\n};\n\nstruct hisi_sas_debugfs_iost {\n\tstruct hisi_sas_iost *iost;\n};\n\nstruct hisi_sas_debugfs_itct {\n\tstruct hisi_sas_itct *itct;\n};\n\nstruct hisi_sas_debugfs_iost_cache {\n\tstruct hisi_sas_iost_itct_cache *cache;\n};\n\nstruct hisi_sas_debugfs_itct_cache {\n\tstruct hisi_sas_iost_itct_cache *cache;\n};\n\nstruct hisi_hba {\n\t \n\tstruct sas_ha_struct *p;\n\n\tstruct platform_device *platform_dev;\n\tstruct pci_dev *pci_dev;\n\tstruct device *dev;\n\n\tint prot_mask;\n\n\tvoid __iomem *regs;\n\tvoid __iomem *sgpio_regs;\n\tstruct regmap *ctrl;\n\tu32 ctrl_reset_reg;\n\tu32 ctrl_reset_sts_reg;\n\tu32 ctrl_clock_ena_reg;\n\tu32 refclk_frequency_mhz;\n\tu8 sas_addr[SAS_ADDR_SIZE];\n\n\tint *irq_map;  \n\n\tint n_phy;\n\tspinlock_t lock;\n\tstruct semaphore sem;\n\n\tstruct timer_list timer;\n\tstruct workqueue_struct *wq;\n\n\tint slot_index_count;\n\tint last_slot_index;\n\tint last_dev_id;\n\tunsigned long *slot_index_tags;\n\tunsigned long reject_stp_links_msk;\n\n\t \n\tstruct sas_ha_struct sha;\n\tstruct Scsi_Host *shost;\n\n\tstruct hisi_sas_cq cq[HISI_SAS_MAX_QUEUES];\n\tstruct hisi_sas_dq dq[HISI_SAS_MAX_QUEUES];\n\tstruct hisi_sas_phy phy[HISI_SAS_MAX_PHYS];\n\tstruct hisi_sas_port port[HISI_SAS_MAX_PHYS];\n\n\tint\tqueue_count;\n\n\tstruct hisi_sas_device\tdevices[HISI_SAS_MAX_DEVICES];\n\tstruct hisi_sas_cmd_hdr\t*cmd_hdr[HISI_SAS_MAX_QUEUES];\n\tdma_addr_t cmd_hdr_dma[HISI_SAS_MAX_QUEUES];\n\tvoid *complete_hdr[HISI_SAS_MAX_QUEUES];\n\tdma_addr_t complete_hdr_dma[HISI_SAS_MAX_QUEUES];\n\tstruct hisi_sas_initial_fis *initial_fis;\n\tdma_addr_t initial_fis_dma;\n\tstruct hisi_sas_itct *itct;\n\tdma_addr_t itct_dma;\n\tstruct hisi_sas_iost *iost;\n\tdma_addr_t iost_dma;\n\tstruct hisi_sas_breakpoint *breakpoint;\n\tdma_addr_t breakpoint_dma;\n\tstruct hisi_sas_breakpoint *sata_breakpoint;\n\tdma_addr_t sata_breakpoint_dma;\n\tstruct hisi_sas_slot\t*slot_info;\n\tunsigned long flags;\n\tconst struct hisi_sas_hw *hw;\t \n\tunsigned long sata_dev_bitmap[BITS_TO_LONGS(HISI_SAS_MAX_DEVICES)];\n\tstruct work_struct rst_work;\n\tstruct work_struct debugfs_work;\n\tu32 phy_state;\n\tu32 intr_coal_ticks;\t \n\tu32 intr_coal_count;\t \n\n\tint cq_nvecs;\n\n\t \n\tenum sas_linkrate debugfs_bist_linkrate;\n\tint debugfs_bist_code_mode;\n\tint debugfs_bist_phy_no;\n\tint debugfs_bist_mode;\n\tu32 debugfs_bist_cnt;\n\tint debugfs_bist_enable;\n\tu32 debugfs_bist_ffe[HISI_SAS_MAX_PHYS][FFE_CFG_MAX];\n\tu32 debugfs_bist_fixed_code[FIXED_CODE_MAX];\n\n\t \n\t \n\tstruct hisi_sas_debugfs_regs debugfs_regs[HISI_SAS_MAX_DEBUGFS_DUMP][DEBUGFS_REGS_NUM];\n\tstruct hisi_sas_debugfs_port debugfs_port_reg[HISI_SAS_MAX_DEBUGFS_DUMP][HISI_SAS_MAX_PHYS];\n\tstruct hisi_sas_debugfs_cq debugfs_cq[HISI_SAS_MAX_DEBUGFS_DUMP][HISI_SAS_MAX_QUEUES];\n\tstruct hisi_sas_debugfs_dq debugfs_dq[HISI_SAS_MAX_DEBUGFS_DUMP][HISI_SAS_MAX_QUEUES];\n\tstruct hisi_sas_debugfs_iost debugfs_iost[HISI_SAS_MAX_DEBUGFS_DUMP];\n\tstruct hisi_sas_debugfs_itct debugfs_itct[HISI_SAS_MAX_DEBUGFS_DUMP];\n\tstruct hisi_sas_debugfs_iost_cache debugfs_iost_cache[HISI_SAS_MAX_DEBUGFS_DUMP];\n\tstruct hisi_sas_debugfs_itct_cache debugfs_itct_cache[HISI_SAS_MAX_DEBUGFS_DUMP];\n\n\tu64 debugfs_timestamp[HISI_SAS_MAX_DEBUGFS_DUMP];\n\tint debugfs_dump_index;\n\tstruct dentry *debugfs_dir;\n\tstruct dentry *debugfs_dump_dentry;\n\tstruct dentry *debugfs_bist_dentry;\n\tstruct dentry *debugfs_fifo_dentry;\n\n\tint iopoll_q_cnt;\n};\n\n \n \nstruct hisi_sas_cmd_hdr {\n\t \n\t__le32 dw0;\n\n\t \n\t__le32 dw1;\n\n\t \n\t__le32 dw2;\n\n\t \n\t__le32 transfer_tags;\n\n\t \n\t__le32 data_transfer_len;\n\n\t \n\t__le32 first_burst_num;\n\n\t \n\t__le32 sg_len;\n\n\t \n\t__le32 dw7;\n\n\t \n\t__le64 cmd_table_addr;\n\n\t \n\t__le64 sts_buffer_addr;\n\n\t \n\t__le64 prd_table_addr;\n\n\t \n\t__le64 dif_prd_table_addr;\n};\n\nstruct hisi_sas_itct {\n\t__le64 qw0;\n\t__le64 sas_addr;\n\t__le64 qw2;\n\t__le64 qw3;\n\t__le64 qw4_15[12];\n};\n\nstruct hisi_sas_iost {\n\t__le64 qw0;\n\t__le64 qw1;\n\t__le64 qw2;\n\t__le64 qw3;\n};\n\nstruct hisi_sas_err_record {\n\tu32\tdata[4];\n};\n\nstruct hisi_sas_initial_fis {\n\tstruct hisi_sas_err_record err_record;\n\tstruct dev_to_host_fis fis;\n\tu32 rsvd[3];\n};\n\nstruct hisi_sas_breakpoint {\n\tu8\tdata[128];\n};\n\nstruct hisi_sas_sata_breakpoint {\n\tstruct hisi_sas_breakpoint tag[32];\n};\n\nstruct hisi_sas_sge {\n\t__le64 addr;\n\t__le32 page_ctrl_0;\n\t__le32 page_ctrl_1;\n\t__le32 data_len;\n\t__le32 data_off;\n};\n\nstruct hisi_sas_command_table_smp {\n\tu8 bytes[44];\n};\n\nstruct hisi_sas_command_table_stp {\n\tstruct\thost_to_dev_fis command_fis;\n\tu8\tdummy[12];\n\tu8\tatapi_cdb[ATAPI_CDB_LEN];\n};\n\n#define HISI_SAS_SGE_PAGE_CNT (124)\nstruct hisi_sas_sge_page {\n\tstruct hisi_sas_sge sge[HISI_SAS_SGE_PAGE_CNT];\n}  __aligned(16);\n\n#define HISI_SAS_SGE_DIF_PAGE_CNT   HISI_SAS_SGE_PAGE_CNT\nstruct hisi_sas_sge_dif_page {\n\tstruct hisi_sas_sge sge[HISI_SAS_SGE_DIF_PAGE_CNT];\n}  __aligned(16);\n\nstruct hisi_sas_command_table_ssp {\n\tstruct ssp_frame_hdr hdr;\n\tunion {\n\t\tstruct {\n\t\t\tstruct ssp_command_iu task;\n\t\t\tu32 prot[7];\n\t\t};\n\t\tstruct ssp_tmf_iu ssp_task;\n\t\tstruct xfer_rdy_iu xfer_rdy;\n\t\tstruct ssp_response_iu ssp_res;\n\t} u;\n};\n\nunion hisi_sas_command_table {\n\tstruct hisi_sas_command_table_ssp ssp;\n\tstruct hisi_sas_command_table_smp smp;\n\tstruct hisi_sas_command_table_stp stp;\n}  __aligned(16);\n\nstruct hisi_sas_status_buffer {\n\tstruct hisi_sas_err_record err;\n\tu8\tiu[1024];\n}  __aligned(16);\n\nstruct hisi_sas_slot_buf_table {\n\tstruct hisi_sas_status_buffer status_buffer;\n\tunion hisi_sas_command_table command_header;\n\tstruct hisi_sas_sge_page sge_page;\n};\n\nstruct hisi_sas_slot_dif_buf_table {\n\tstruct hisi_sas_slot_buf_table slot_buf;\n\tstruct hisi_sas_sge_dif_page sge_dif_page;\n};\n\nextern struct scsi_transport_template *hisi_sas_stt;\n\nextern bool hisi_sas_debugfs_enable;\nextern u32 hisi_sas_debugfs_dump_count;\nextern struct dentry *hisi_sas_debugfs_dir;\n\nextern void hisi_sas_stop_phys(struct hisi_hba *hisi_hba);\nextern int hisi_sas_alloc(struct hisi_hba *hisi_hba);\nextern void hisi_sas_free(struct hisi_hba *hisi_hba);\nextern u8 hisi_sas_get_ata_protocol(struct host_to_dev_fis *fis,\n\t\t\t\tint direction);\nextern struct hisi_sas_port *to_hisi_sas_port(struct asd_sas_port *sas_port);\nextern void hisi_sas_sata_done(struct sas_task *task,\n\t\t\t    struct hisi_sas_slot *slot);\nextern int hisi_sas_get_fw_info(struct hisi_hba *hisi_hba);\nextern int hisi_sas_probe(struct platform_device *pdev,\n\t\t\t  const struct hisi_sas_hw *ops);\nextern void hisi_sas_remove(struct platform_device *pdev);\n\nextern int hisi_sas_slave_configure(struct scsi_device *sdev);\nextern int hisi_sas_slave_alloc(struct scsi_device *sdev);\nextern int hisi_sas_scan_finished(struct Scsi_Host *shost, unsigned long time);\nextern void hisi_sas_scan_start(struct Scsi_Host *shost);\nextern int hisi_sas_host_reset(struct Scsi_Host *shost, int reset_type);\nextern void hisi_sas_phy_enable(struct hisi_hba *hisi_hba, int phy_no,\n\t\t\t\tint enable);\nextern void hisi_sas_phy_down(struct hisi_hba *hisi_hba, int phy_no, int rdy,\n\t\t\t      gfp_t gfp_flags);\nextern void hisi_sas_phy_bcast(struct hisi_sas_phy *phy);\nextern void hisi_sas_slot_task_free(struct hisi_hba *hisi_hba,\n\t\t\t\t    struct sas_task *task,\n\t\t\t\t    struct hisi_sas_slot *slot,\n\t\t\t\t    bool need_lock);\nextern void hisi_sas_init_mem(struct hisi_hba *hisi_hba);\nextern void hisi_sas_rst_work_handler(struct work_struct *work);\nextern void hisi_sas_sync_rst_work_handler(struct work_struct *work);\nextern void hisi_sas_phy_oob_ready(struct hisi_hba *hisi_hba, int phy_no);\nextern bool hisi_sas_notify_phy_event(struct hisi_sas_phy *phy,\n\t\t\t\tenum hisi_sas_phy_event event);\nextern void hisi_sas_release_tasks(struct hisi_hba *hisi_hba);\nextern u8 hisi_sas_get_prog_phy_linkrate_mask(enum sas_linkrate max);\nextern void hisi_sas_sync_cqs(struct hisi_hba *hisi_hba);\nextern void hisi_sas_sync_poll_cqs(struct hisi_hba *hisi_hba);\nextern void hisi_sas_controller_reset_prepare(struct hisi_hba *hisi_hba);\nextern void hisi_sas_controller_reset_done(struct hisi_hba *hisi_hba);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}