{
  "module_name": "lpfc.h",
  "hash_id": "b5eb906b669c7db24cbed7ace2fad6b2eae80aabe35f3b298b4045ff1defb665",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/lpfc/lpfc.h",
  "human_readable_source": " \n\n#include <scsi/scsi_host.h>\n#include <linux/hashtable.h>\n#include <linux/ktime.h>\n#include <linux/workqueue.h>\n\n#if defined(CONFIG_DEBUG_FS) && !defined(CONFIG_SCSI_LPFC_DEBUG_FS)\n#define CONFIG_SCSI_LPFC_DEBUG_FS\n#endif\n\nstruct lpfc_sli2_slim;\n\n#define ELX_MODEL_NAME_SIZE\t80\n\n#define LPFC_PCI_DEV_LP\t\t0x1\n#define LPFC_PCI_DEV_OC\t\t0x2\n\n#define LPFC_SLI_REV2\t\t2\n#define LPFC_SLI_REV3\t\t3\n#define LPFC_SLI_REV4\t\t4\n\n#define LPFC_MAX_TARGET\t\t4096\t \n#define LPFC_MAX_DISC_THREADS\t64\t \n#define LPFC_MAX_NS_RETRY\t3\t \n#define LPFC_CMD_PER_LUN\t3\t \n#define LPFC_DEFAULT_SG_SEG_CNT 64\t \n\n#define LPFC_DEFAULT_XPSGL_SIZE\t256\n#define LPFC_MAX_SG_TABLESIZE\t0xffff\n#define LPFC_MIN_SG_SLI4_BUF_SZ\t0x800\t \n#define LPFC_MAX_BG_SLI4_SEG_CNT_DIF 128  \n#define LPFC_MAX_SG_SEG_CNT_DIF 512\t \n#define LPFC_MAX_SG_SEG_CNT\t4096\t \n#define LPFC_MIN_SG_SEG_CNT\t32\t \n#define LPFC_MAX_SGL_SEG_CNT\t512\t \n#define LPFC_MAX_BPL_SEG_CNT\t4096\t \n#define LPFC_MAX_NVME_SEG_CNT\t256\t \n\n#define LPFC_MAX_SGE_SIZE       0x80000000  \n#define LPFC_IOCB_LIST_CNT\t2250\t \n#define LPFC_Q_RAMP_UP_INTERVAL 120      \n#define LPFC_VNAME_LEN\t\t100\t \n#define LPFC_TGTQ_RAMPUP_PCENT\t5\t \n#define LPFC_MIN_TGT_QDEPTH\t10\n#define LPFC_MAX_TGT_QDEPTH\t0xFFFF\n\n \n \n#define QUEUE_RAMP_DOWN_INTERVAL\t(msecs_to_jiffies(1000 * 1))\n\n \n#define LPFC_DISC_IOCB_BUFF_COUNT 20\n\n#define LPFC_HB_MBOX_INTERVAL   5\t \n#define LPFC_HB_MBOX_TIMEOUT    30\t \n\n \n#define LPFC_ERATT_POLL_INTERVAL\t5  \n\n \n#define putPaddrLow(addr)    ((uint32_t) (0xffffffff & (u64)(addr)))\n#define putPaddrHigh(addr)   ((uint32_t) (0xffffffff & (((u64)(addr))>>32)))\n#define getPaddr(high, low)  ((dma_addr_t)( \\\n\t\t\t     (( (u64)(high)<<16 ) << 16)|( (u64)(low))))\n \n#define LPFC_DRVR_TIMEOUT\t16\t \n#define FC_MAX_ADPTMSG\t\t64\n\n#define MAX_HBAEVT\t32\n#define MAX_HBAS_NO_RESET 16\n\n \n#define LPFC_MSIX_VECTORS\t2\n\n \n#define LPFC_DATA_READY\t\t0\t \n\n \n#define LPFC_LBUF_SZ\t\t128\n\n \n#define LPFC_MBX_NO_WAIT\t0\n#define LPFC_MBX_WAIT\t\t1\n\n#define LPFC_CFG_PARAM_MAGIC_NUM 0xFEAA0005\n#define LPFC_PORT_CFG_NAME \"/cfg/port.cfg\"\n\n#define lpfc_rangecheck(val, min, max) \\\n\t((uint)(val) >= (uint)(min) && (val) <= (max))\n\nenum lpfc_polling_flags {\n\tENABLE_FCP_RING_POLLING = 0x1,\n\tDISABLE_FCP_RING_INT    = 0x2\n};\n\nstruct perf_prof {\n\tuint16_t cmd_cpu[40];\n\tuint16_t rsp_cpu[40];\n\tuint16_t qh_cpu[40];\n\tuint16_t wqidx[40];\n};\n\n \n#define LPFC_FC4_TYPE_BITMASK\t0x00000100\n\n \nstruct lpfc_dmabuf {\n\tstruct list_head list;\n\tvoid *virt;\t\t \n\tdma_addr_t phys;\t \n\tuint32_t   buffer_tag;\t \n};\n\nstruct lpfc_nvmet_ctxbuf {\n\tstruct list_head list;\n\tstruct lpfc_async_xchg_ctx *context;\n\tstruct lpfc_iocbq *iocbq;\n\tstruct lpfc_sglq *sglq;\n\tstruct work_struct defer_work;\n};\n\nstruct lpfc_dma_pool {\n\tstruct lpfc_dmabuf   *elements;\n\tuint32_t    max_count;\n\tuint32_t    current_count;\n};\n\nstruct hbq_dmabuf {\n\tstruct lpfc_dmabuf hbuf;\n\tstruct lpfc_dmabuf dbuf;\n\tuint16_t total_size;\n\tuint16_t bytes_recv;\n\tuint32_t tag;\n\tstruct lpfc_cq_event cq_event;\n\tunsigned long time_stamp;\n\tvoid *context;\n};\n\nstruct rqb_dmabuf {\n\tstruct lpfc_dmabuf hbuf;\n\tstruct lpfc_dmabuf dbuf;\n\tuint16_t total_size;\n\tuint16_t bytes_recv;\n\tuint16_t idx;\n\tstruct lpfc_queue *hrq;\t   \n\tstruct lpfc_queue *drq;\t   \n};\n\n \n#define MEM_PRI\t\t0x100\n\n\n \n \n \ntypedef struct lpfc_vpd {\n\tuint32_t status;\t \n\tuint32_t length;\t \n\tstruct {\n\t\tuint32_t rsvd1;\t \n\t\tuint32_t biuRev;\n\t\tuint32_t smRev;\n\t\tuint32_t smFwRev;\n\t\tuint32_t endecRev;\n\t\tuint16_t rBit;\n\t\tuint8_t fcphHigh;\n\t\tuint8_t fcphLow;\n\t\tuint8_t feaLevelHigh;\n\t\tuint8_t feaLevelLow;\n\t\tuint32_t postKernRev;\n\t\tuint32_t opFwRev;\n\t\tuint8_t opFwName[16];\n\t\tuint32_t sli1FwRev;\n\t\tuint8_t sli1FwName[16];\n\t\tuint32_t sli2FwRev;\n\t\tuint8_t sli2FwName[16];\n\t} rev;\n\tstruct {\n#ifdef __BIG_ENDIAN_BITFIELD\n\t\tuint32_t rsvd3  :20;   \n\t\tuint32_t rsvd2\t: 3;   \n\t\tuint32_t cbg\t: 1;   \n\t\tuint32_t cmv\t: 1;   \n\t\tuint32_t ccrp   : 1;   \n\t\tuint32_t csah   : 1;   \n\t\tuint32_t chbs   : 1;   \n\t\tuint32_t cinb   : 1;   \n\t\tuint32_t cerbm\t: 1;   \n\t\tuint32_t cmx\t: 1;   \n\t\tuint32_t cmr\t: 1;   \n#else\t \n\t\tuint32_t cmr\t: 1;   \n\t\tuint32_t cmx\t: 1;   \n\t\tuint32_t cerbm\t: 1;   \n\t\tuint32_t cinb   : 1;   \n\t\tuint32_t chbs   : 1;   \n\t\tuint32_t csah   : 1;   \n\t\tuint32_t ccrp   : 1;   \n\t\tuint32_t cmv\t: 1;   \n\t\tuint32_t cbg\t: 1;   \n\t\tuint32_t rsvd2\t: 3;   \n\t\tuint32_t rsvd3  :20;   \n#endif\n\t} sli3Feat;\n} lpfc_vpd_t;\n\n\n \nstruct lpfc_stats {\n\t \n\tuint32_t elsLogiCol;\n\tuint32_t elsRetryExceeded;\n\tuint32_t elsXmitRetry;\n\tuint32_t elsDelayRetry;\n\tuint32_t elsRcvDrop;\n\tuint32_t elsRcvFrame;\n\tuint32_t elsRcvRSCN;\n\tuint32_t elsRcvRNID;\n\tuint32_t elsRcvFARP;\n\tuint32_t elsRcvFARPR;\n\tuint32_t elsRcvFLOGI;\n\tuint32_t elsRcvPLOGI;\n\tuint32_t elsRcvADISC;\n\tuint32_t elsRcvPDISC;\n\tuint32_t elsRcvFAN;\n\tuint32_t elsRcvLOGO;\n\tuint32_t elsRcvPRLO;\n\tuint32_t elsRcvPRLI;\n\tuint32_t elsRcvLIRR;\n\tuint32_t elsRcvRLS;\n\tuint32_t elsRcvRPL;\n\tuint32_t elsRcvRRQ;\n\tuint32_t elsRcvRTV;\n\tuint32_t elsRcvECHO;\n\tuint32_t elsRcvLCB;\n\tuint32_t elsRcvRDP;\n\tuint32_t elsRcvRDF;\n\tuint32_t elsXmitFLOGI;\n\tuint32_t elsXmitFDISC;\n\tuint32_t elsXmitPLOGI;\n\tuint32_t elsXmitPRLI;\n\tuint32_t elsXmitADISC;\n\tuint32_t elsXmitLOGO;\n\tuint32_t elsXmitSCR;\n\tuint32_t elsXmitRSCN;\n\tuint32_t elsXmitRNID;\n\tuint32_t elsXmitFARP;\n\tuint32_t elsXmitFARPR;\n\tuint32_t elsXmitACC;\n\tuint32_t elsXmitLSRJT;\n\n\tuint32_t frameRcvBcast;\n\tuint32_t frameRcvMulti;\n\tuint32_t strayXmitCmpl;\n\tuint32_t frameXmitDelay;\n\tuint32_t xriCmdCmpl;\n\tuint32_t xriStatErr;\n\tuint32_t LinkUp;\n\tuint32_t LinkDown;\n\tuint32_t LinkMultiEvent;\n\tuint32_t NoRcvBuf;\n\tuint32_t fcpCmd;\n\tuint32_t fcpCmpl;\n\tuint32_t fcpRspErr;\n\tuint32_t fcpRemoteStop;\n\tuint32_t fcpPortRjt;\n\tuint32_t fcpPortBusy;\n\tuint32_t fcpError;\n\tuint32_t fcpLocalErr;\n};\n\nstruct lpfc_hba;\n\n\n#define LPFC_VMID_TIMER   300\t \n\n#define LPFC_MAX_VMID_SIZE      256\n\nunion lpfc_vmid_io_tag {\n\tu32 app_id;\t \n\tu8 cs_ctl_vmid;\t \n};\n\n#define JIFFIES_PER_HR\t(HZ * 60 * 60)\n\nstruct lpfc_vmid {\n\tu8 flag;\n#define LPFC_VMID_SLOT_FREE     0x0\n#define LPFC_VMID_SLOT_USED     0x1\n#define LPFC_VMID_REQ_REGISTER  0x2\n#define LPFC_VMID_REGISTERED    0x4\n#define LPFC_VMID_DE_REGISTER   0x8\n\tchar host_vmid[LPFC_MAX_VMID_SIZE];\n\tunion lpfc_vmid_io_tag un;\n\tstruct hlist_node hnode;\n\tu64 io_rd_cnt;\n\tu64 io_wr_cnt;\n\tu8 vmid_len;\n\tu8 delete_inactive;  \n\tu32 hash_index;\n\tu64 __percpu *last_io_time;\n};\n\n#define lpfc_vmid_is_type_priority_tag(vport)\\\n\t(vport->vmid_priority_tagging ? 1 : 0)\n\n#define LPFC_VMID_HASH_SIZE     256\n#define LPFC_VMID_HASH_MASK     255\n#define LPFC_VMID_HASH_SHIFT    6\n\nstruct lpfc_vmid_context {\n\tstruct lpfc_vmid *vmp;\n\tstruct lpfc_nodelist *nlp;\n\tbool instantiated;\n};\n\nstruct lpfc_vmid_priority_range {\n\tu8 low;\n\tu8 high;\n\tu8 qos;\n};\n\nstruct lpfc_vmid_priority_info {\n\tu32 num_descriptors;\n\tstruct lpfc_vmid_priority_range *vmid_range;\n};\n\n#define QFPA_EVEN_ONLY 0x01\n#define QFPA_ODD_ONLY  0x02\n#define QFPA_EVEN_ODD  0x03\n\nenum discovery_state {\n\tLPFC_VPORT_UNKNOWN     =  0,     \n\tLPFC_VPORT_FAILED      =  1,     \n\tLPFC_LOCAL_CFG_LINK    =  6,     \n\tLPFC_FLOGI             =  7,     \n\tLPFC_FDISC             =  8,     \n\tLPFC_FABRIC_CFG_LINK   =  9,     \n\tLPFC_NS_REG            =  10,    \n\tLPFC_NS_QRY            =  11,    \n\tLPFC_BUILD_DISC_LIST   =  12,    \n\tLPFC_DISC_AUTH         =  13,    \n\tLPFC_VPORT_READY       =  32,\n};\n\nenum hba_state {\n\tLPFC_LINK_UNKNOWN    =   0,    \n\tLPFC_WARM_START      =   1,    \n\tLPFC_INIT_START      =   2,    \n\tLPFC_INIT_MBX_CMDS   =   3,    \n\tLPFC_LINK_DOWN       =   4,    \n\tLPFC_LINK_UP         =   5,    \n\tLPFC_CLEAR_LA        =   6,    \n\tLPFC_HBA_READY       =  32,\n\tLPFC_HBA_ERROR       =  -1\n};\n\nstruct lpfc_trunk_link_state {\n\tenum hba_state state;\n\tuint8_t fault;\n};\n\nstruct lpfc_trunk_link  {\n\tstruct lpfc_trunk_link_state link0,\n\t\t\t\t     link1,\n\t\t\t\t     link2,\n\t\t\t\t     link3;\n\tu32 phy_lnk_speed;\n};\n\n \nstruct lpfc_cgn_param {\n\tuint32_t cgn_param_magic;\n\tuint8_t  cgn_param_version;\t \n\tuint8_t  cgn_param_mode;\t \n#define LPFC_CFG_OFF\t\t0\n#define LPFC_CFG_MANAGED\t1\n#define LPFC_CFG_MONITOR\t2\n\tuint8_t  cgn_rsvd1;\n\tuint8_t  cgn_rsvd2;\n\tuint8_t  cgn_param_level0;\n\tuint8_t  cgn_param_level1;\n\tuint8_t  cgn_param_level2;\n\tuint8_t  byte11;\n\tuint8_t  byte12;\n\tuint8_t  byte13;\n\tuint8_t  byte14;\n\tuint8_t  byte15;\n};\n\n \n#define LPFC_MAX_CGN_DAYS 10\n\nstruct lpfc_cgn_ts {\n\tuint8_t month;\n\tuint8_t day;\n\tuint8_t year;\n\tuint8_t hour;\n\tuint8_t minute;\n\tuint8_t second;\n};\n\n \n\nstruct lpfc_cgn_info {\n\t \n\t__le16   cgn_info_size;\t\t \n\tuint8_t  cgn_info_version;\t \n#define LPFC_CGN_INFO_V1\t1\n#define LPFC_CGN_INFO_V2\t2\n#define LPFC_CGN_INFO_V3\t3\n#define LPFC_CGN_INFO_V4\t4\n\tuint8_t  cgn_info_mode;\t\t \n\tuint8_t  cgn_info_detect;\n\tuint8_t  cgn_info_action;\n\tuint8_t  cgn_info_level0;\n\tuint8_t  cgn_info_level1;\n\tuint8_t  cgn_info_level2;\n\n\t \n\tstruct lpfc_cgn_ts base_time;\n\n\t \n\tuint8_t  cgn_index_minute;\n\tuint8_t  cgn_index_hour;\n\tuint8_t  cgn_index_day;\n\n\t__le16   cgn_warn_freq;\n\t__le16   cgn_alarm_freq;\n\t__le16   cgn_lunq;\n\tuint8_t  cgn_pad1[8];\n\n\t \n\t__le16   cgn_drvr_min[60];\n\t__le32   cgn_drvr_hr[24];\n\t__le32   cgn_drvr_day[LPFC_MAX_CGN_DAYS];\n\n\t \n\t__le16   cgn_warn_min[60];\n\t__le32   cgn_warn_hr[24];\n\t__le32   cgn_warn_day[LPFC_MAX_CGN_DAYS];\n\n\t \n\t__le32   cgn_latency_min[60];\n\t__le32   cgn_latency_hr[24];\n\t__le32   cgn_latency_day[LPFC_MAX_CGN_DAYS];\n\n\t \n\t__le16   cgn_bw_min[60];\n\t__le16   cgn_bw_hr[24];\n\t__le16   cgn_bw_day[LPFC_MAX_CGN_DAYS];\n\n\t \n\t__le16   cgn_alarm_min[60];\n\t__le32   cgn_alarm_hr[24];\n\t__le32   cgn_alarm_day[LPFC_MAX_CGN_DAYS];\n\n\tstruct_group(cgn_stat,\n\t\tuint8_t  cgn_stat_npm;\t\t \n\n\t\t \n\t\tstruct lpfc_cgn_ts stat_start;\t \n\t\tuint8_t cgn_pad2;\n\n\t\t__le32   cgn_notification;\n\t\t__le32   cgn_peer_notification;\n\t\t__le32   link_integ_notification;\n\t\t__le32   delivery_notification;\n\t\tstruct lpfc_cgn_ts stat_fpin;\t \n\t\tstruct lpfc_cgn_ts stat_peer;\t \n\t\tstruct lpfc_cgn_ts stat_lnk;\t \n\t\tstruct lpfc_cgn_ts stat_delivery;\t \n\t);\n\n\t__le32   cgn_info_crc;\n#define LPFC_CGN_CRC32_MAGIC_NUMBER\t0x1EDC6F41\n#define LPFC_CGN_CRC32_SEED\t\t0xFFFFFFFF\n};\n\n#define LPFC_CGN_INFO_SZ\t(sizeof(struct lpfc_cgn_info) -  \\\n\t\t\t\tsizeof(uint32_t))\n\nstruct lpfc_cgn_stat {\n\tatomic64_t total_bytes;\n\tatomic64_t rcv_bytes;\n\tatomic64_t rx_latency;\n#define LPFC_CGN_NOT_SENT\t0xFFFFFFFFFFFFFFFFLL\n\tatomic_t rx_io_cnt;\n};\n\nstruct lpfc_cgn_acqe_stat {\n\tatomic64_t alarm;\n\tatomic64_t warn;\n};\n\nstruct lpfc_vport {\n\tstruct lpfc_hba *phba;\n\tstruct list_head listentry;\n\tuint8_t port_type;\n#define LPFC_PHYSICAL_PORT 1\n#define LPFC_NPIV_PORT  2\n#define LPFC_FABRIC_PORT 3\n\tenum discovery_state port_state;\n\n\tuint16_t vpi;\n\tuint16_t vfi;\n\tuint8_t vpi_state;\n#define LPFC_VPI_REGISTERED\t0x1\n\n\tuint32_t fc_flag;\t \n \n#define FC_PT2PT                0x1\t  \n#define FC_PT2PT_PLOGI          0x2\t  \n#define FC_DISC_TMO             0x4\t  \n#define FC_PUBLIC_LOOP          0x8\t  \n#define FC_LBIT                 0x10\t  \n#define FC_RSCN_MODE            0x20\t  \n#define FC_NLP_MORE             0x40\t  \n#define FC_OFFLINE_MODE         0x80\t  \n#define FC_FABRIC               0x100\t  \n#define FC_VPORT_LOGO_RCVD      0x200     \n#define FC_RSCN_DISCOVERY       0x400\t  \n#define FC_LOGO_RCVD_DID_CHNG   0x800     \n#define FC_PT2PT_NO_NVME        0x1000    \n#define FC_SCSI_SCAN_TMO        0x4000\t  \n#define FC_ABORT_DISCOVERY      0x8000\t  \n#define FC_NDISC_ACTIVE         0x10000\t  \n#define FC_BYPASSED_MODE        0x20000\t  \n#define FC_VPORT_NEEDS_REG_VPI\t0x80000   \n#define FC_RSCN_DEFERRED\t0x100000  \n#define FC_VPORT_NEEDS_INIT_VPI 0x200000  \n#define FC_VPORT_CVL_RCVD\t0x400000  \n#define FC_VFI_REGISTERED\t0x800000  \n#define FC_FDISC_COMPLETED\t0x1000000 \n#define FC_DISC_DELAYED\t\t0x2000000 \n\n\tuint32_t ct_flags;\n#define FC_CT_RFF_ID\t\t0x1\t  \n#define FC_CT_RNN_ID\t\t0x2\t  \n#define FC_CT_RSNN_NN\t\t0x4\t  \n#define FC_CT_RSPN_ID\t\t0x8\t  \n#define FC_CT_RFT_ID\t\t0x10\t  \n#define FC_CT_RPRT_DEFER\t0x20\t  \n\n\tstruct list_head fc_nodes;\n\n\t \n\tuint16_t fc_plogi_cnt;\n\tuint16_t fc_adisc_cnt;\n\tuint16_t fc_reglogin_cnt;\n\tuint16_t fc_prli_cnt;\n\tuint16_t fc_unmap_cnt;\n\tuint16_t fc_map_cnt;\n\tuint16_t fc_npr_cnt;\n\tuint16_t fc_unused_cnt;\n\tstruct serv_parm fc_sparam;\t \n\n\tuint32_t fc_myDID;\t \n\tuint32_t fc_prevDID;\t \n\tstruct lpfc_name fabric_portname;\n\tstruct lpfc_name fabric_nodename;\n\n\tint32_t stopped;    \n\tuint8_t fc_linkspeed;\t \n\n\tuint32_t num_disc_nodes;\t \n\tuint32_t gidft_inp;\t\t \n\n\tuint32_t fc_nlp_cnt;\t \n\tuint32_t fc_rscn_id_cnt;\t \n\tuint32_t fc_rscn_flush;\t\t \n\tstruct lpfc_dmabuf *fc_rscn_id_list[FC_MAX_HOLD_RSCN];\n\tstruct lpfc_name fc_nodename;\t \n\tstruct lpfc_name fc_portname;\t \n\n\tstruct lpfc_work_evt disc_timeout_evt;\n\n\tstruct timer_list fc_disctmo;\t \n\tuint8_t fc_ns_retry;\t \n\tuint32_t fc_prli_sent;\t \n\n\tspinlock_t work_port_lock;\n\tuint32_t work_port_events;  \n#define WORKER_DISC_TMO                0x1\t \n#define WORKER_ELS_TMO                 0x2\t \n#define WORKER_DELAYED_DISC_TMO        0x8\t \n\n#define WORKER_MBOX_TMO                0x100\t \n#define WORKER_HB_TMO                  0x200\t \n#define WORKER_FABRIC_BLOCK_TMO        0x400\t \n#define WORKER_RAMP_DOWN_QUEUE         0x800\t \n#define WORKER_RAMP_UP_QUEUE           0x1000\t \n#define WORKER_SERVICE_TXQ             0x2000\t \n#define WORKER_CHECK_INACTIVE_VMID     0x4000\t \n#define WORKER_CHECK_VMID_ISSUE_QFPA   0x8000\t \n\n\tstruct timer_list els_tmofunc;\n\tstruct timer_list delayed_disc_tmo;\n\n\tuint8_t load_flag;\n#define FC_LOADING\t\t0x1\t \n#define FC_UNLOADING\t\t0x2\t \n#define FC_ALLOW_FDMI\t\t0x4\t \n#define FC_ALLOW_VMID\t\t0x8\t \n#define FC_DEREGISTER_ALL_APP_ID\t0x10\t \n\t \n\tuint32_t cfg_scan_down;\n\tuint32_t cfg_lun_queue_depth;\n\tuint32_t cfg_nodev_tmo;\n\tuint32_t cfg_devloss_tmo;\n\tuint32_t cfg_restrict_login;\n\tuint32_t cfg_peer_port_login;\n\tuint32_t cfg_fcp_class;\n\tuint32_t cfg_use_adisc;\n\tuint32_t cfg_discovery_threads;\n\tuint32_t cfg_log_verbose;\n\tuint32_t cfg_enable_fc4_type;\n\tuint32_t cfg_max_luns;\n\tuint32_t cfg_enable_da_id;\n\tuint32_t cfg_max_scsicmpl_time;\n\tuint32_t cfg_tgt_queue_depth;\n\tuint32_t cfg_first_burst_size;\n\tuint32_t dev_loss_tmo_changed;\n\t \n\tu8 lpfc_vmid_host_uuid[16];\n\tu32 max_vmid;\t \n\tu32 cur_vmid_cnt;\t \n#define LPFC_MIN_VMID\t4\n#define LPFC_MAX_VMID\t255\n\tu32 vmid_inactivity_timeout;\t \n\t\t\t\t\t\t \n\tu32 vmid_priority_tagging;\n#define LPFC_VMID_PRIO_TAG_DISABLE\t0  \n#define LPFC_VMID_PRIO_TAG_SUP_TARGETS\t1  \n#define LPFC_VMID_PRIO_TAG_ALL_TARGETS\t2  \n\tunsigned long *vmid_priority_range;\n#define LPFC_VMID_MAX_PRIORITY_RANGE    256\n#define LPFC_VMID_PRIORITY_BITMAP_SIZE  32\n\tu8 vmid_flag;\n#define LPFC_VMID_IN_USE\t\t0x1\n#define LPFC_VMID_ISSUE_QFPA\t\t0x2\n#define LPFC_VMID_QFPA_CMPL\t\t0x4\n#define LPFC_VMID_QOS_ENABLED\t\t0x8\n#define LPFC_VMID_TIMER_ENBLD\t\t0x10\n#define LPFC_VMID_TYPE_PRIO\t\t0x20\n\tstruct fc_qfpa_res *qfpa_res;\n\n\tstruct fc_vport *fc_vport;\n\n\tstruct lpfc_vmid *vmid;\n\tDECLARE_HASHTABLE(hash_table, 8);\n\trwlock_t vmid_lock;\n\tstruct lpfc_vmid_priority_info vmid_priority;\n\n#ifdef CONFIG_SCSI_LPFC_DEBUG_FS\n\tstruct dentry *debug_disc_trc;\n\tstruct dentry *debug_nodelist;\n\tstruct dentry *debug_nvmestat;\n\tstruct dentry *debug_scsistat;\n\tstruct dentry *debug_ioktime;\n\tstruct dentry *debug_hdwqstat;\n\tstruct dentry *vport_debugfs_root;\n\tstruct lpfc_debugfs_trc *disc_trc;\n\tatomic_t disc_trc_cnt;\n#endif\n\tstruct list_head rcv_buffer_list;\n\tunsigned long rcv_buffer_time_stamp;\n\tuint32_t vport_flag;\n#define STATIC_VPORT\t\t0x1\n#define FAWWPN_PARAM_CHG\t0x2\n\n\tuint16_t fdmi_num_disc;\n\tuint32_t fdmi_hba_mask;\n\tuint32_t fdmi_port_mask;\n\n\t \n\tstruct nvme_fc_local_port *localport;\n\tuint8_t  nvmei_support;  \n\tuint32_t last_fcp_wqidx;\n\tuint32_t rcv_flogi_cnt;  \n};\n\nstruct hbq_s {\n\tuint16_t entry_count;\t   \n\tuint16_t buffer_count;\t   \n\tuint32_t next_hbqPutIdx;   \n\tuint32_t hbqPutIdx;\t   \n\tuint32_t local_hbqGetIdx;  \n\tvoid    *hbq_virt;\t   \n\tstruct list_head hbq_buffer_list;   \n\t\t\t\t   \n\tstruct hbq_dmabuf *(*hbq_alloc_buffer) (struct lpfc_hba *);\n\t\t\t\t   \n\tvoid               (*hbq_free_buffer) (struct lpfc_hba *,\n\t\t\t\t\t       struct hbq_dmabuf *);\n};\n\n \n#define LPFC_ELS_HBQ\t0\n#define LPFC_MAX_HBQS\t1\n\nenum hba_temp_state {\n\tHBA_NORMAL_TEMP,\n\tHBA_OVER_TEMP\n};\n\nenum intr_type_t {\n\tNONE = 0,\n\tINTx,\n\tMSI,\n\tMSIX,\n};\n\n#define LPFC_CT_CTX_MAX\t\t64\nstruct unsol_rcv_ct_ctx {\n\tuint32_t ctxt_id;\n\tuint32_t SID;\n\tuint32_t valid;\n#define UNSOL_INVALID\t\t0\n#define UNSOL_VALID\t\t1\n\tuint16_t oxid;\n\tuint16_t rxid;\n};\n\n#define LPFC_USER_LINK_SPEED_AUTO\t0\t \n#define LPFC_USER_LINK_SPEED_1G\t\t1\t \n#define LPFC_USER_LINK_SPEED_2G\t\t2\t \n#define LPFC_USER_LINK_SPEED_4G\t\t4\t \n#define LPFC_USER_LINK_SPEED_8G\t\t8\t \n#define LPFC_USER_LINK_SPEED_10G\t10\t \n#define LPFC_USER_LINK_SPEED_16G\t16\t \n#define LPFC_USER_LINK_SPEED_32G\t32\t \n#define LPFC_USER_LINK_SPEED_64G\t64\t \n#define LPFC_USER_LINK_SPEED_MAX\tLPFC_USER_LINK_SPEED_64G\n\n#define LPFC_LINK_SPEED_STRING \"0, 1, 2, 4, 8, 10, 16, 32, 64\"\n\nenum nemb_type {\n\tnemb_mse = 1,\n\tnemb_hbd\n};\n\nenum mbox_type {\n\tmbox_rd = 1,\n\tmbox_wr\n};\n\nenum dma_type {\n\tdma_mbox = 1,\n\tdma_ebuf\n};\n\nenum sta_type {\n\tsta_pre_addr = 1,\n\tsta_pos_addr\n};\n\nstruct lpfc_mbox_ext_buf_ctx {\n\tuint32_t state;\n#define LPFC_BSG_MBOX_IDLE\t\t0\n#define LPFC_BSG_MBOX_HOST              1\n#define LPFC_BSG_MBOX_PORT\t\t2\n#define LPFC_BSG_MBOX_DONE\t\t3\n#define LPFC_BSG_MBOX_ABTS\t\t4\n\tenum nemb_type nembType;\n\tenum mbox_type mboxType;\n\tuint32_t numBuf;\n\tuint32_t mbxTag;\n\tuint32_t seqNum;\n\tstruct lpfc_dmabuf *mbx_dmabuf;\n\tstruct list_head ext_dmabuf_list;\n};\n\nstruct lpfc_epd_pool {\n\t \n\tstruct list_head list;\n\tu32 count;\n\tspinlock_t lock;\t \n};\n\nenum ras_state {\n\tINACTIVE,\n\tREG_INPROGRESS,\n\tACTIVE\n};\n\nstruct lpfc_ras_fwlog {\n\tuint8_t *fwlog_buff;\n\tuint32_t fw_buffcount;  \n#define LPFC_RAS_BUFF_ENTERIES  16       \n#define LPFC_RAS_MAX_ENTRY_SIZE (64 * 1024)\n#define LPFC_RAS_MIN_BUFF_POST_SIZE (256 * 1024)\n#define LPFC_RAS_MAX_BUFF_POST_SIZE (1024 * 1024)\n\tuint32_t fw_loglevel;  \n\tstruct lpfc_dmabuf lwpd;\n\tstruct list_head fwlog_buff_list;\n\n\t \n\tbool ras_hwsupport;  \n\tbool ras_enabled;    \n#define LPFC_RAS_DISABLE_LOGGING 0x00\n#define LPFC_RAS_ENABLE_LOGGING 0x01\n\tenum ras_state state;     \n};\n\n#define DBG_LOG_STR_SZ 256\n#define DBG_LOG_SZ 256\n\nstruct dbg_log_ent {\n\tchar log[DBG_LOG_STR_SZ];\n\tu64     t_ns;\n};\n\nenum lpfc_irq_chann_mode {\n\t \n\tNORMAL_MODE,\n\n\t \n\tNUMA_MODE,\n\n\t \n\tNHT_MODE,\n};\n\nenum lpfc_hba_bit_flags {\n\tFABRIC_COMANDS_BLOCKED,\n\tHBA_PCI_ERR,\n\tMBX_TMO_ERR,\n};\n\nstruct lpfc_hba {\n\t \n\tstruct lpfc_io_buf * (*lpfc_get_scsi_buf)\n\t\t(struct lpfc_hba *phba, struct lpfc_nodelist *ndlp,\n\t\tstruct scsi_cmnd *cmnd);\n\tint (*lpfc_scsi_prep_dma_buf)\n\t\t(struct lpfc_hba *, struct lpfc_io_buf *);\n\tvoid (*lpfc_scsi_unprep_dma_buf)\n\t\t(struct lpfc_hba *, struct lpfc_io_buf *);\n\tvoid (*lpfc_release_scsi_buf)\n\t\t(struct lpfc_hba *, struct lpfc_io_buf *);\n\tvoid (*lpfc_rampdown_queue_depth)\n\t\t(struct lpfc_hba *);\n\tvoid (*lpfc_scsi_prep_cmnd)\n\t\t(struct lpfc_vport *, struct lpfc_io_buf *,\n\t\t struct lpfc_nodelist *);\n\tint (*lpfc_scsi_prep_cmnd_buf)\n\t\t(struct lpfc_vport *vport,\n\t\t struct lpfc_io_buf *lpfc_cmd,\n\t\t uint8_t tmo);\n\tint (*lpfc_scsi_prep_task_mgmt_cmd)\n\t\t(struct lpfc_vport *vport,\n\t\t struct lpfc_io_buf *lpfc_cmd,\n\t\t u64 lun, u8 task_mgmt_cmd);\n\n\t \n\tint (*__lpfc_sli_issue_iocb)\n\t\t(struct lpfc_hba *, uint32_t,\n\t\t struct lpfc_iocbq *, uint32_t);\n\tint (*__lpfc_sli_issue_fcp_io)\n\t\t(struct lpfc_hba *phba, uint32_t ring_number,\n\t\t struct lpfc_iocbq *piocb, uint32_t flag);\n\tvoid (*__lpfc_sli_release_iocbq)(struct lpfc_hba *,\n\t\t\t struct lpfc_iocbq *);\n\tint (*lpfc_hba_down_post)(struct lpfc_hba *phba);\n\n\t \n\tint (*lpfc_sli_issue_mbox)\n\t\t(struct lpfc_hba *, LPFC_MBOXQ_t *, uint32_t);\n\n\t \n\tvoid (*lpfc_sli_handle_slow_ring_event)\n\t\t(struct lpfc_hba *phba, struct lpfc_sli_ring *pring,\n\t\t uint32_t mask);\n\n\t \n\tint (*lpfc_sli_hbq_to_firmware)\n\t\t(struct lpfc_hba *, uint32_t, struct hbq_dmabuf *);\n\tint (*lpfc_sli_brdrestart)\n\t\t(struct lpfc_hba *);\n\tint (*lpfc_sli_brdready)\n\t\t(struct lpfc_hba *, uint32_t);\n\tvoid (*lpfc_handle_eratt)\n\t\t(struct lpfc_hba *);\n\tvoid (*lpfc_stop_port)\n\t\t(struct lpfc_hba *);\n\tint (*lpfc_hba_init_link)\n\t\t(struct lpfc_hba *, uint32_t);\n\tint (*lpfc_hba_down_link)\n\t\t(struct lpfc_hba *, uint32_t);\n\tint (*lpfc_selective_reset)\n\t\t(struct lpfc_hba *);\n\n\tint (*lpfc_bg_scsi_prep_dma_buf)\n\t\t(struct lpfc_hba *, struct lpfc_io_buf *);\n\n\t \n\tvoid (*__lpfc_sli_prep_els_req_rsp)(struct lpfc_iocbq *cmdiocbq,\n\t\t\t\t\t    struct lpfc_vport *vport,\n\t\t\t\t\t    struct lpfc_dmabuf *bmp,\n\t\t\t\t\t    u16 cmd_size, u32 did, u32 elscmd,\n\t\t\t\t\t    u8 tmo, u8 expect_rsp);\n\tvoid (*__lpfc_sli_prep_gen_req)(struct lpfc_iocbq *cmdiocbq,\n\t\t\t\t\tstruct lpfc_dmabuf *bmp, u16 rpi,\n\t\t\t\t\tu32 num_entry, u8 tmo);\n\tvoid (*__lpfc_sli_prep_xmit_seq64)(struct lpfc_iocbq *cmdiocbq,\n\t\t\t\t\t   struct lpfc_dmabuf *bmp, u16 rpi,\n\t\t\t\t\t   u16 ox_id, u32 num_entry, u8 rctl,\n\t\t\t\t\t   u8 last_seq, u8 cr_cx_cmd);\n\tvoid (*__lpfc_sli_prep_abort_xri)(struct lpfc_iocbq *cmdiocbq,\n\t\t\t\t\t  u16 ulp_context, u16 iotag,\n\t\t\t\t\t  u8 ulp_class, u16 cqid, bool ia,\n\t\t\t\t\t  bool wqec);\n\n\t \n\tstruct lpfc_epd_pool epd_pool;\n\n\t \n\tstruct lpfc_sli4_hba sli4_hba;\n\n\tstruct workqueue_struct *wq;\n\tstruct delayed_work     eq_delay_work;\n\n#define LPFC_IDLE_STAT_DELAY 1000\n\tstruct delayed_work\tidle_stat_delay_work;\n\n\tstruct lpfc_sli sli;\n\tuint8_t pci_dev_grp;\t \n\tuint32_t sli_rev;\t\t \n\tuint32_t sli3_options;\t\t \n#define LPFC_SLI3_HBQ_ENABLED\t\t0x01\n#define LPFC_SLI3_NPIV_ENABLED\t\t0x02\n#define LPFC_SLI3_VPORT_TEARDOWN\t0x04\n#define LPFC_SLI3_CRP_ENABLED\t\t0x08\n#define LPFC_SLI3_BG_ENABLED\t\t0x20\n#define LPFC_SLI3_DSS_ENABLED\t\t0x40\n#define LPFC_SLI4_PERFH_ENABLED\t\t0x80\n#define LPFC_SLI4_PHWQ_ENABLED\t\t0x100\n\tuint32_t iocb_cmd_size;\n\tuint32_t iocb_rsp_size;\n\n\tstruct lpfc_trunk_link  trunk_link;\n\tenum hba_state link_state;\n\tuint32_t link_flag;\t \n#define LS_LOOPBACK_MODE      0x1\t \n\t\t\t\t\t \n\t\t\t\t\t \n#define LS_NPIV_FAB_SUPPORTED 0x2\t \n#define LS_IGNORE_ERATT       0x4\t \n#define LS_MDS_LINK_DOWN      0x8\t \n#define LS_MDS_LOOPBACK       0x10\t \n#define LS_CT_VEN_RPA         0x20\t \n#define LS_EXTERNAL_LOOPBACK  0x40\t \n\n\tuint32_t hba_flag;\t \n#define HBA_ERATT_HANDLED\t0x1  \n#define DEFER_ERATT\t\t0x2  \n#define HBA_FCOE_MODE\t\t0x4  \n#define HBA_SP_QUEUE_EVT\t0x8  \n#define HBA_POST_RECEIVE_BUFFER 0x10  \n#define HBA_PERSISTENT_TOPO\t0x20  \n#define ELS_XRI_ABORT_EVENT\t0x40  \n#define ASYNC_EVENT\t\t0x80\n#define LINK_DISABLED\t\t0x100  \n#define FCF_TS_INPROG           0x200  \n#define FCF_RR_INPROG           0x400  \n#define HBA_FIP_SUPPORT\t\t0x800  \n#define HBA_DEVLOSS_TMO         0x2000  \n#define HBA_RRQ_ACTIVE\t\t0x4000  \n#define HBA_IOQ_FLUSH\t\t0x8000  \n#define HBA_RECOVERABLE_UE\t0x20000  \n#define HBA_FORCED_LINK_SPEED\t0x40000  \n#define HBA_FLOGI_ISSUED\t0x100000  \n#define HBA_DEFER_FLOGI\t\t0x800000  \n#define HBA_SETUP\t\t0x1000000  \n#define HBA_NEEDS_CFG_PORT\t0x2000000  \n#define HBA_HBEAT_INP\t\t0x4000000  \n#define HBA_HBEAT_TMO\t\t0x8000000  \n#define HBA_FLOGI_OUTSTANDING\t0x10000000  \n#define HBA_RHBA_CMPL\t\t0x20000000  \n\n\tstruct completion *fw_dump_cmpl;  \n\tuint32_t fcp_ring_in_use;  \n\tstruct lpfc_dmabuf slim2p;\n\n\tMAILBOX_t *mbox;\n\tuint32_t *mbox_ext;\n\tstruct lpfc_mbox_ext_buf_ctx mbox_ext_buf_ctx;\n\tuint32_t ha_copy;\n\tstruct _PCB *pcb;\n\tstruct _IOCB *IOCBs;\n\n\tstruct lpfc_dmabuf hbqslimp;\n\n\tuint16_t pci_cfg_value;\n\n\tuint8_t fc_linkspeed;\t \n\n\tuint32_t fc_eventTag;\t \n\tuint32_t link_events;\n\n\t \n\tuint32_t fc_pref_DID;\t \n\tuint8_t  fc_pref_ALPA;\t \n\tuint32_t fc_edtovResol;  \n\tuint32_t fc_edtov;\t \n\tuint32_t fc_arbtov;\t \n\tuint32_t fc_ratov;\t \n\tuint32_t fc_rttov;\t \n\tuint32_t fc_altov;\t \n\tuint32_t fc_crtov;\t \n\n\tstruct serv_parm fc_fabparam;\t \n\tuint8_t alpa_map[128];\t \n\n\tuint32_t lmt;\n\n\tuint32_t fc_topology;\t \n\tuint32_t fc_topology_changed;\t \n\n\tstruct lpfc_stats fc_stat;\n\n\tstruct lpfc_nodelist fc_fcpnodev;  \n\tuint32_t nport_event_cnt;\t \n\n\tuint8_t  wwnn[8];\n\tuint8_t  wwpn[8];\n\tuint32_t RandomData[7];\n\tuint8_t  fcp_embed_io;\n\tuint8_t  nvmet_support;\t \n#define LPFC_NVMET_MAX_PORTS\t32\n\tuint8_t  mds_diags_support;\n\tuint8_t  bbcredit_support;\n\tuint8_t  enab_exp_wqcq_pages;\n\tu8\t nsler;  \n\n\t \n\tuint32_t cfg_ack0;\n\tuint32_t cfg_xri_rebalancing;\n\tuint32_t cfg_xpsgl;\n\tuint32_t cfg_enable_npiv;\n\tuint32_t cfg_enable_rrq;\n\tuint32_t cfg_topology;\n\tuint32_t cfg_link_speed;\n#define LPFC_FCF_FOV 1\t\t \n#define LPFC_FCF_PRIORITY 2\t \n\tuint32_t cfg_fcf_failover_policy;\n\tuint32_t cfg_fcp_io_sched;\n\tuint32_t cfg_ns_query;\n\tuint32_t cfg_fcp2_no_tgt_reset;\n\tuint32_t cfg_cr_delay;\n\tuint32_t cfg_cr_count;\n\tuint32_t cfg_multi_ring_support;\n\tuint32_t cfg_multi_ring_rctl;\n\tuint32_t cfg_multi_ring_type;\n\tuint32_t cfg_poll;\n\tuint32_t cfg_poll_tmo;\n\tuint32_t cfg_task_mgmt_tmo;\n\tuint32_t cfg_use_msi;\n\tuint32_t cfg_auto_imax;\n\tuint32_t cfg_fcp_imax;\n\tuint32_t cfg_force_rscn;\n\tuint32_t cfg_cq_poll_threshold;\n\tuint32_t cfg_cq_max_proc_limit;\n\tuint32_t cfg_fcp_cpu_map;\n\tuint32_t cfg_fcp_mq_threshold;\n\tuint32_t cfg_hdw_queue;\n\tuint32_t cfg_irq_chann;\n\tuint32_t cfg_suppress_rsp;\n\tuint32_t cfg_nvme_oas;\n\tuint32_t cfg_nvme_embed_cmd;\n\tuint32_t cfg_nvmet_mrq_post;\n\tuint32_t cfg_nvmet_mrq;\n\tuint32_t cfg_enable_nvmet;\n\tuint32_t cfg_nvme_enable_fb;\n\tuint32_t cfg_nvmet_fb_size;\n\tuint32_t cfg_total_seg_cnt;\n\tuint32_t cfg_sg_seg_cnt;\n\tuint32_t cfg_nvme_seg_cnt;\n\tuint32_t cfg_scsi_seg_cnt;\n\tuint32_t cfg_sg_dma_buf_size;\n\tuint32_t cfg_hba_queue_depth;\n\tuint32_t cfg_enable_hba_reset;\n\tuint32_t cfg_enable_hba_heartbeat;\n\tuint32_t cfg_fof;\n\tuint32_t cfg_EnableXLane;\n\tuint8_t cfg_oas_tgt_wwpn[8];\n\tuint8_t cfg_oas_vpt_wwpn[8];\n\tuint32_t cfg_oas_lun_state;\n#define OAS_LUN_ENABLE\t1\n#define OAS_LUN_DISABLE\t0\n\tuint32_t cfg_oas_lun_status;\n#define OAS_LUN_STATUS_EXISTS\t0x01\n\tuint32_t cfg_oas_flags;\n#define OAS_FIND_ANY_VPORT\t0x01\n#define OAS_FIND_ANY_TARGET\t0x02\n#define OAS_LUN_VALID\t0x04\n\tuint32_t cfg_oas_priority;\n\tuint32_t cfg_XLanePriority;\n\tuint32_t cfg_enable_bg;\n\tuint32_t cfg_prot_mask;\n\tuint32_t cfg_prot_guard;\n\tuint32_t cfg_hostmem_hgp;\n\tuint32_t cfg_log_verbose;\n\tuint32_t cfg_enable_fc4_type;\n#define LPFC_ENABLE_FCP  1\n#define LPFC_ENABLE_NVME 2\n#define LPFC_ENABLE_BOTH 3\n#if (IS_ENABLED(CONFIG_NVME_FC))\n#define LPFC_MAX_ENBL_FC4_TYPE LPFC_ENABLE_BOTH\n#define LPFC_DEF_ENBL_FC4_TYPE LPFC_ENABLE_BOTH\n#else\n#define LPFC_MAX_ENBL_FC4_TYPE LPFC_ENABLE_FCP\n#define LPFC_DEF_ENBL_FC4_TYPE LPFC_ENABLE_FCP\n#endif\n\tuint32_t cfg_sriov_nr_virtfn;\n\tuint32_t cfg_request_firmware_upgrade;\n\tuint32_t cfg_suppress_link_up;\n\tuint32_t cfg_rrq_xri_bitmap_sz;\n\tu32      cfg_fcp_wait_abts_rsp;\n\tuint32_t cfg_delay_discovery;\n\tuint32_t cfg_sli_mode;\n#define LPFC_INITIALIZE_LINK              0\t \n#define LPFC_DELAY_INIT_LINK              1\t \n#define LPFC_DELAY_INIT_LINK_INDEFINITELY 2\t \n\tuint32_t cfg_fdmi_on;\n#define LPFC_FDMI_NO_SUPPORT\t0\t \n#define LPFC_FDMI_SUPPORT\t1\t \n\tuint32_t cfg_enable_SmartSAN;\n\tuint32_t cfg_enable_mds_diags;\n\tuint32_t cfg_ras_fwlog_level;\n\tuint32_t cfg_ras_fwlog_buffsize;\n\tuint32_t cfg_ras_fwlog_func;\n\tuint32_t cfg_enable_bbcr;\t \n\tuint32_t cfg_enable_dpp;\t \n\tuint32_t cfg_enable_pbde;\n\tuint32_t cfg_enable_mi;\n\tstruct nvmet_fc_target_port *targetport;\n\tlpfc_vpd_t vpd;\t\t \n\n\tu32 cfg_max_vmid;\t \n\tu32 cfg_vmid_app_header;\n#define LPFC_VMID_APP_HEADER_DISABLE\t0\n#define LPFC_VMID_APP_HEADER_ENABLE\t1\n\tu32 cfg_vmid_priority_tagging;\n\tu32 cfg_vmid_inactivity_timeout;\t \n\t\t\t\t\t\t \n\tstruct pci_dev *pcidev;\n\tstruct list_head      work_list;\n\tuint32_t              work_ha;       \n\tuint32_t              work_ha_mask;  \n\tuint32_t              work_hs;       \n\tuint32_t              work_status[2];  \n\n\twait_queue_head_t    work_waitq;\n\tstruct task_struct   *worker_thread;\n\tunsigned long data_flags;\n\tuint32_t border_sge_num;\n\n\tuint32_t hbq_in_use;\t\t \n\tuint32_t hbq_count;\t         \n\tstruct hbq_s hbqs[LPFC_MAX_HBQS];  \n\n\tatomic_t fcp_qidx;          \n\tatomic_t nvme_qidx;         \n\n\tphys_addr_t pci_bar0_map;      \n\tphys_addr_t pci_bar1_map;      \n\tphys_addr_t pci_bar2_map;      \n\tvoid __iomem *slim_memmap_p;\t \n\tvoid __iomem *ctrl_regs_memmap_p; \n\n\tvoid __iomem *pci_bar0_memmap_p;  \n\tvoid __iomem *pci_bar2_memmap_p;  \n\tvoid __iomem *pci_bar4_memmap_p;  \n#define PCI_64BIT_BAR0\t0\n#define PCI_64BIT_BAR2\t2\n#define PCI_64BIT_BAR4\t4\n\tvoid __iomem *MBslimaddr;\t \n\tvoid __iomem *HAregaddr;\t \n\tvoid __iomem *CAregaddr;\t \n\tvoid __iomem *HSregaddr;\t \n\tvoid __iomem *HCregaddr;\t \n\n\tstruct lpfc_hgp __iomem *host_gp;  \n\tstruct lpfc_pgp   *port_gp;\n\tuint32_t __iomem  *hbq_put;      \n\tuint32_t          *hbq_get;      \n\n\tint brd_no;\t\t\t \n\tchar SerialNumber[32];\t\t \n\tchar OptionROMVersion[32];\t \n\tchar BIOSVersion[16];\t\t \n\tchar ModelDesc[256];\t\t \n\tchar ModelName[80];\t\t \n\tchar ProgramType[256];\t\t \n\tchar Port[20];\t\t\t \n\tuint8_t vpd_flag;                \n\n#define VPD_MODEL_DESC      0x1          \n#define VPD_MODEL_NAME      0x2          \n#define VPD_PROGRAM_TYPE    0x4          \n#define VPD_PORT            0x8          \n#define VPD_MASK            0xf          \n\n\n\tstruct timer_list fcp_poll_timer;\n\tstruct timer_list eratt_poll;\n\tuint32_t eratt_poll_interval;\n\n\tuint64_t bg_guard_err_cnt;\n\tuint64_t bg_apptag_err_cnt;\n\tuint64_t bg_reftag_err_cnt;\n\n\t \n\tspinlock_t scsi_buf_list_get_lock;   \n\tspinlock_t scsi_buf_list_put_lock;   \n\tstruct list_head lpfc_scsi_buf_list_get;\n\tstruct list_head lpfc_scsi_buf_list_put;\n\tuint32_t total_scsi_bufs;\n\tstruct list_head lpfc_iocb_list;\n\tuint32_t total_iocbq_bufs;\n\tstruct list_head active_rrq_list;\n\tspinlock_t hbalock;\n\tstruct work_struct  unblock_request_work;  \n\n\t \n\tstruct dma_pool *lpfc_sg_dma_buf_pool;\n\tstruct dma_pool *lpfc_mbuf_pool;\n\tstruct dma_pool *lpfc_hrb_pool;\t \n\tstruct dma_pool *lpfc_drb_pool;  \n\tstruct dma_pool *lpfc_nvmet_drb_pool;  \n\tstruct dma_pool *lpfc_hbq_pool;\t \n\tstruct dma_pool *lpfc_cmd_rsp_buf_pool;\n\tstruct lpfc_dma_pool lpfc_mbuf_safety_pool;\n\n\tmempool_t *mbox_mem_pool;\n\tmempool_t *nlp_mem_pool;\n\tmempool_t *rrq_pool;\n\tmempool_t *active_rrq_pool;\n\n\tstruct fc_host_statistics link_stats;\n\tenum lpfc_irq_chann_mode irq_chann_mode;\n\tenum intr_type_t intr_type;\n\tuint32_t intr_mode;\n#define LPFC_INTR_ERROR\t0xFFFFFFFF\n\tstruct list_head port_list;\n\tspinlock_t port_list_lock;\t \n\tstruct lpfc_vport *pport;\t \n\tuint16_t max_vpi;\t\t \n#define LPFC_MAX_VPI\t0xFF\t\t \n#define LPFC_MAX_VPORTS\t0x100\t\t \n\tuint16_t max_vports;             \n\tuint16_t vpi_base;\n\tuint16_t vfi_base;\n\tunsigned long *vpi_bmask;\t \n\tuint16_t *vpi_ids;\n\tuint16_t vpi_count;\n\tstruct list_head lpfc_vpi_blk_list;\n\n\t \n\tstruct list_head fabric_iocb_list;\n\tatomic_t fabric_iocb_count;\n\tstruct timer_list fabric_block_timer;\n\tunsigned long bit_flags;\n\tatomic_t num_rsrc_err;\n\tatomic_t num_cmd_success;\n\tunsigned long last_rsrc_error_time;\n\tunsigned long last_ramp_down_time;\n#ifdef CONFIG_SCSI_LPFC_DEBUG_FS\n\tstruct dentry *hba_debugfs_root;\n\tatomic_t debugfs_vport_count;\n\tstruct dentry *debug_multixri_pools;\n\tstruct dentry *debug_hbqinfo;\n\tstruct dentry *debug_dumpHostSlim;\n\tstruct dentry *debug_dumpHBASlim;\n\tstruct dentry *debug_InjErrLBA;   \n\tstruct dentry *debug_InjErrNPortID;   \n\tstruct dentry *debug_InjErrWWPN;   \n\tstruct dentry *debug_writeGuard;  \n\tstruct dentry *debug_writeApp;    \n\tstruct dentry *debug_writeRef;    \n\tstruct dentry *debug_readGuard;   \n\tstruct dentry *debug_readApp;     \n\tstruct dentry *debug_readRef;     \n\n\tstruct dentry *debug_nvmeio_trc;\n\tstruct lpfc_debugfs_nvmeio_trc *nvmeio_trc;\n\tstruct dentry *debug_hdwqinfo;\n#ifdef LPFC_HDWQ_LOCK_STAT\n\tstruct dentry *debug_lockstat;\n#endif\n\tstruct dentry *debug_cgn_buffer;\n\tstruct dentry *debug_rx_monitor;\n\tstruct dentry *debug_ras_log;\n\tatomic_t nvmeio_trc_cnt;\n\tuint32_t nvmeio_trc_size;\n\tuint32_t nvmeio_trc_output_idx;\n\n\t \n\tuint32_t lpfc_injerr_wgrd_cnt;\n\tuint32_t lpfc_injerr_wapp_cnt;\n\tuint32_t lpfc_injerr_wref_cnt;\n\tuint32_t lpfc_injerr_rgrd_cnt;\n\tuint32_t lpfc_injerr_rapp_cnt;\n\tuint32_t lpfc_injerr_rref_cnt;\n\tuint32_t lpfc_injerr_nportid;\n\tstruct lpfc_name lpfc_injerr_wwpn;\n\tsector_t lpfc_injerr_lba;\n#define LPFC_INJERR_LBA_OFF\t(sector_t)(-1)\n\n\tstruct dentry *debug_slow_ring_trc;\n\tstruct lpfc_debugfs_trc *slow_ring_trc;\n\tatomic_t slow_ring_trc_cnt;\n\t \n\tstruct dentry *idiag_root;\n\tstruct dentry *idiag_pci_cfg;\n\tstruct dentry *idiag_bar_acc;\n\tstruct dentry *idiag_que_info;\n\tstruct dentry *idiag_que_acc;\n\tstruct dentry *idiag_drb_acc;\n\tstruct dentry *idiag_ctl_acc;\n\tstruct dentry *idiag_mbx_acc;\n\tstruct dentry *idiag_ext_acc;\n\tuint8_t lpfc_idiag_last_eq;\n#endif\n\tuint16_t nvmeio_trc_on;\n\n\t \n\tstruct list_head elsbuf;\n\tint elsbuf_cnt;\n\tint elsbuf_prev_cnt;\n\n\tuint8_t temp_sensor_support;\n\t \n\tunsigned long last_completion_time;\n\tunsigned long skipped_hb;\n\tstruct timer_list hb_tmofunc;\n\tstruct timer_list rrq_tmr;\n\tenum hba_temp_state over_temp_state;\n\t \n#define QUE_BUFTAG_BIT  (1<<31)\n\tuint32_t buffer_tag_count;\n\n \n#define LPFC_MAX_EVT_COUNT 512\n\tatomic_t fast_event_count;\n\tuint32_t fcoe_eventtag;\n\tuint32_t fcoe_eventtag_at_fcf_scan;\n\tuint32_t fcoe_cvl_eventtag;\n\tuint32_t fcoe_cvl_eventtag_attn;\n\tstruct lpfc_fcf fcf;\n\tuint8_t fc_map[3];\n\tuint8_t valid_vlan;\n\tuint16_t vlan_id;\n\tstruct list_head fcf_conn_rec_list;\n\n\tbool defer_flogi_acc_flag;\n\tuint16_t defer_flogi_acc_rx_id;\n\tuint16_t defer_flogi_acc_ox_id;\n\n\tspinlock_t ct_ev_lock;  \n\tstruct list_head ct_ev_waiters;\n\tstruct unsol_rcv_ct_ctx ct_ctx[LPFC_CT_CTX_MAX];\n\tuint32_t ctx_idx;\n\tstruct timer_list inactive_vmid_poll;\n\n\t \n\tstruct lpfc_ras_fwlog ras_fwlog;\n\n\tuint32_t iocb_cnt;\n\tuint32_t iocb_max;\n\tatomic_t sdev_cnt;\n\tspinlock_t devicelock;\t \n\tmempool_t *device_data_mem_pool;\n\tstruct list_head luns;\n#define LPFC_TRANSGRESSION_HIGH_TEMPERATURE\t0x0080\n#define LPFC_TRANSGRESSION_LOW_TEMPERATURE\t0x0040\n#define LPFC_TRANSGRESSION_HIGH_VOLTAGE\t\t0x0020\n#define LPFC_TRANSGRESSION_LOW_VOLTAGE\t\t0x0010\n#define LPFC_TRANSGRESSION_HIGH_TXBIAS\t\t0x0008\n#define LPFC_TRANSGRESSION_LOW_TXBIAS\t\t0x0004\n#define LPFC_TRANSGRESSION_HIGH_TXPOWER\t\t0x0002\n#define LPFC_TRANSGRESSION_LOW_TXPOWER\t\t0x0001\n#define LPFC_TRANSGRESSION_HIGH_RXPOWER\t\t0x8000\n#define LPFC_TRANSGRESSION_LOW_RXPOWER\t\t0x4000\n\tuint16_t sfp_alarm;\n\tuint16_t sfp_warning;\n\n#ifdef CONFIG_SCSI_LPFC_DEBUG_FS\n\tuint16_t hdwqstat_on;\n#define LPFC_CHECK_OFF\t\t0\n#define LPFC_CHECK_NVME_IO\t1\n#define LPFC_CHECK_NVMET_IO\t2\n#define LPFC_CHECK_SCSI_IO\t4\n\tuint16_t ktime_on;\n\tuint64_t ktime_data_samples;\n\tuint64_t ktime_status_samples;\n\tuint64_t ktime_last_cmd;\n\tuint64_t ktime_seg1_total;\n\tuint64_t ktime_seg1_min;\n\tuint64_t ktime_seg1_max;\n\tuint64_t ktime_seg2_total;\n\tuint64_t ktime_seg2_min;\n\tuint64_t ktime_seg2_max;\n\tuint64_t ktime_seg3_total;\n\tuint64_t ktime_seg3_min;\n\tuint64_t ktime_seg3_max;\n\tuint64_t ktime_seg4_total;\n\tuint64_t ktime_seg4_min;\n\tuint64_t ktime_seg4_max;\n\tuint64_t ktime_seg5_total;\n\tuint64_t ktime_seg5_min;\n\tuint64_t ktime_seg5_max;\n\tuint64_t ktime_seg6_total;\n\tuint64_t ktime_seg6_min;\n\tuint64_t ktime_seg6_max;\n\tuint64_t ktime_seg7_total;\n\tuint64_t ktime_seg7_min;\n\tuint64_t ktime_seg7_max;\n\tuint64_t ktime_seg8_total;\n\tuint64_t ktime_seg8_min;\n\tuint64_t ktime_seg8_max;\n\tuint64_t ktime_seg9_total;\n\tuint64_t ktime_seg9_min;\n\tuint64_t ktime_seg9_max;\n\tuint64_t ktime_seg10_total;\n\tuint64_t ktime_seg10_min;\n\tuint64_t ktime_seg10_max;\n#endif\n\t \n\tstruct lpfc_cgn_stat __percpu *cmf_stat;\n\tuint32_t cmf_interval_rate;   \n\tuint32_t cmf_timer_cnt;\n#define LPFC_CMF_INTERVAL 90\n\tuint64_t cmf_link_byte_count;\n\tuint64_t cmf_max_line_rate;\n\tuint64_t cmf_max_bytes_per_interval;\n\tuint64_t cmf_last_sync_bw;\n#define  LPFC_CMF_BLK_SIZE 512\n\tstruct hrtimer cmf_timer;\n\tstruct hrtimer cmf_stats_timer;\t \n\tatomic_t cmf_bw_wait;\n\tatomic_t cmf_busy;\n\tatomic_t cmf_stop_io;       \n\tuint32_t cmf_active_mode;\n\tuint32_t cmf_info_per_interval;\n#define LPFC_MAX_CMF_INFO 32\n\tstruct timespec64 cmf_latency;   \n\tuint32_t cmf_last_ts;    \n\tuint32_t cmf_active_info;\n\n\t \n\tu8 cgn_reg_fpin;            \n\tu8 cgn_init_reg_fpin;       \n#define LPFC_CGN_FPIN_NONE\t0x0\n#define LPFC_CGN_FPIN_WARN\t0x1\n#define LPFC_CGN_FPIN_ALARM\t0x2\n#define LPFC_CGN_FPIN_BOTH\t(LPFC_CGN_FPIN_WARN | LPFC_CGN_FPIN_ALARM)\n\n\tu8 cgn_reg_signal;           \n\tu8 cgn_init_reg_signal;      \n\t\t \n\tu16 cgn_fpin_frequency;\t\t \n#define LPFC_FPIN_INIT_FREQ\t0xffff\n\tu32 cgn_sig_freq;\n\tu32 cgn_acqe_cnt;\n\n\t \n\tstruct lpfc_rx_info_monitor *rx_monitor;\n\tatomic_t rx_max_read_cnt;        \n\tuint64_t rx_block_cnt;\n\n\t \n\tstruct lpfc_cgn_param cgn_p;\n\n\t \n\tstruct lpfc_cgn_acqe_stat cgn_acqe_stat;\n\n\t \n\tstruct lpfc_dmabuf *cgn_i;       \n\tatomic_t cgn_fabric_warn_cnt;    \n\tatomic_t cgn_fabric_alarm_cnt;   \n\tatomic_t cgn_sync_warn_cnt;      \n\tatomic_t cgn_sync_alarm_cnt;     \n\tatomic_t cgn_driver_evt_cnt;     \n\tatomic_t cgn_latency_evt_cnt;\n\tatomic64_t cgn_latency_evt;      \n\tunsigned long cgn_evt_timestamp;\n#define LPFC_CGN_TIMER_TO_MIN   60000  \n\tuint32_t cgn_evt_minute;\n#define LPFC_SEC_MIN\t\t60UL\n#define LPFC_MIN_HOUR\t\t60\n#define LPFC_HOUR_DAY\t\t24\n#define LPFC_MIN_DAY\t\t(LPFC_MIN_HOUR * LPFC_HOUR_DAY)\n\n\tstruct hlist_node cpuhp;\t \n\tstruct timer_list cpuhp_poll_timer;\n\tstruct list_head poll_list;\t \n#define LPFC_POLL_HB\t1\t\t \n\n\tchar os_host_name[MAXHOSTNAMELEN];\n\n\t \n\tu32 degrade_activate_threshold;\n\tu32 degrade_deactivate_threshold;\n\tu32 fec_degrade_interval;\n\n\tatomic_t dbg_log_idx;\n\tatomic_t dbg_log_cnt;\n\tatomic_t dbg_log_dmping;\n\tstruct dbg_log_ent dbg_log[DBG_LOG_SZ];\n};\n\n#define LPFC_MAX_RXMONITOR_ENTRY\t800\n#define LPFC_MAX_RXMONITOR_DUMP\t\t32\nstruct rx_info_entry {\n\tuint64_t cmf_bytes;\t \n\tuint64_t total_bytes;    \n\tuint64_t rcv_bytes;      \n\tuint64_t avg_io_size;\n\tuint64_t avg_io_latency; \n\tuint64_t max_read_cnt;   \n\tuint64_t max_bytes_per_interval;\n\tuint32_t cmf_busy;\n\tuint32_t cmf_info;       \n\tuint32_t io_cnt;\n\tuint32_t timer_utilization;\n\tuint32_t timer_interval;\n};\n\nstruct lpfc_rx_info_monitor {\n\tstruct rx_info_entry *ring;  \n\tu32 head_idx, tail_idx;  \n\tspinlock_t lock;  \n\tu32 entries;  \n};\n\nstatic inline struct Scsi_Host *\nlpfc_shost_from_vport(struct lpfc_vport *vport)\n{\n\treturn container_of((void *) vport, struct Scsi_Host, hostdata[0]);\n}\n\nstatic inline void\nlpfc_set_loopback_flag(struct lpfc_hba *phba)\n{\n\tif (phba->cfg_topology == FLAGS_LOCAL_LB)\n\t\tphba->link_flag |= LS_LOOPBACK_MODE;\n\telse\n\t\tphba->link_flag &= ~LS_LOOPBACK_MODE;\n}\n\nstatic inline int\nlpfc_is_link_up(struct lpfc_hba *phba)\n{\n\treturn  phba->link_state == LPFC_LINK_UP ||\n\t\tphba->link_state == LPFC_CLEAR_LA ||\n\t\tphba->link_state == LPFC_HBA_READY;\n}\n\nstatic inline void\nlpfc_worker_wake_up(struct lpfc_hba *phba)\n{\n\t \n\tset_bit(LPFC_DATA_READY, &phba->data_flags);\n\n\t \n\twake_up(&phba->work_waitq);\n\treturn;\n}\n\nstatic inline int\nlpfc_readl(void __iomem *addr, uint32_t *data)\n{\n\tuint32_t temp;\n\ttemp = readl(addr);\n\tif (temp == 0xffffffff)\n\t\treturn -EIO;\n\t*data = temp;\n\treturn 0;\n}\n\nstatic inline int\nlpfc_sli_read_hs(struct lpfc_hba *phba)\n{\n\t \n\tphba->sli.slistat.err_attn_event++;\n\n\t \n\tif (lpfc_readl(phba->HSregaddr, &phba->work_hs) ||\n\t\tlpfc_readl(phba->MBslimaddr + 0xa8, &phba->work_status[0]) ||\n\t\tlpfc_readl(phba->MBslimaddr + 0xac, &phba->work_status[1])) {\n\t\treturn -EIO;\n\t}\n\n\t \n\twritel(HA_ERATT, phba->HAregaddr);\n\treadl(phba->HAregaddr);  \n\tphba->pport->stopped = 1;\n\n\treturn 0;\n}\n\nstatic inline struct lpfc_sli_ring *\nlpfc_phba_elsring(struct lpfc_hba *phba)\n{\n\t \n\tif (phba->sli_rev != LPFC_SLI_REV4  &&\n\t    phba->sli_rev != LPFC_SLI_REV3  &&\n\t    phba->sli_rev != LPFC_SLI_REV2)\n\t\treturn NULL;\n\n\tif (phba->sli_rev == LPFC_SLI_REV4) {\n\t\tif (phba->sli4_hba.els_wq)\n\t\t\treturn phba->sli4_hba.els_wq->pring;\n\t\telse\n\t\t\treturn NULL;\n\t}\n\treturn &phba->sli.sli3_ring[LPFC_ELS_RING];\n}\n\n \nstatic inline unsigned int\nlpfc_next_online_cpu(const struct cpumask *mask, unsigned int start)\n{\n\tunsigned int cpu_it;\n\n\tfor_each_cpu_wrap(cpu_it, mask, start) {\n\t\tif (cpu_online(cpu_it))\n\t\t\tbreak;\n\t}\n\n\treturn cpu_it;\n}\n \nstatic inline unsigned int lpfc_next_present_cpu(int n)\n{\n\tunsigned int cpu;\n\n\tcpu = cpumask_next(n, cpu_present_mask);\n\n\tif (cpu >= nr_cpu_ids)\n\t\tcpu = cpumask_first(cpu_present_mask);\n\n\treturn cpu;\n}\n\n \nstatic inline void\nlpfc_sli4_mod_hba_eq_delay(struct lpfc_hba *phba, struct lpfc_queue *eq,\n\t\t\t   u32 delay)\n{\n\tstruct lpfc_register reg_data;\n\n\treg_data.word0 = 0;\n\tbf_set(lpfc_sliport_eqdelay_id, &reg_data, eq->queue_id);\n\tbf_set(lpfc_sliport_eqdelay_delay, &reg_data, delay);\n\twritel(reg_data.word0, phba->sli4_hba.u.if_type2.EQDregaddr);\n\teq->q_mode = delay;\n}\n\n\n \n#define DECLARE_ENUM2STR_LOOKUP(routine, enum_name, enum_init)\t\t\\\nstatic struct {\t\t\t\t\t\t\t\t\\\n\tenum enum_name\t\tvalue;\t\t\t\t\t\\\n\tchar\t\t\t*name;\t\t\t\t\t\\\n} fc_##enum_name##_e2str_names[] = enum_init;\t\t\t\t\\\nstatic const char *routine(enum enum_name table_key)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tint i;\t\t\t\t\t\t\t\t\\\n\tchar *name = \"Unrecognized\";\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tfor (i = 0; i < ARRAY_SIZE(fc_##enum_name##_e2str_names); i++) {\\\n\t\tif (fc_##enum_name##_e2str_names[i].value == table_key) {\\\n\t\t\tname = fc_##enum_name##_e2str_names[i].name;\t\\\n\t\t\tbreak;\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\treturn name;\t\t\t\t\t\t\t\\\n}\n\n \nstatic inline int lpfc_is_vmid_enabled(struct lpfc_hba *phba)\n{\n\treturn phba->cfg_vmid_app_header || phba->cfg_vmid_priority_tagging;\n}\n\nstatic inline\nu8 get_job_ulpstatus(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn bf_get(lpfc_wcqe_c_status, &iocbq->wcqe_cmpl);\n\telse\n\t\treturn iocbq->iocb.ulpStatus;\n}\n\nstatic inline\nu32 get_job_word4(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn iocbq->wcqe_cmpl.parameter;\n\telse\n\t\treturn iocbq->iocb.un.ulpWord[4];\n}\n\nstatic inline\nu8 get_job_cmnd(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn bf_get(wqe_cmnd, &iocbq->wqe.generic.wqe_com);\n\telse\n\t\treturn iocbq->iocb.ulpCommand;\n}\n\nstatic inline\nu16 get_job_ulpcontext(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn bf_get(wqe_ctxt_tag, &iocbq->wqe.generic.wqe_com);\n\telse\n\t\treturn iocbq->iocb.ulpContext;\n}\n\nstatic inline\nu16 get_job_rcvoxid(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn bf_get(wqe_rcvoxid, &iocbq->wqe.generic.wqe_com);\n\telse\n\t\treturn iocbq->iocb.unsli3.rcvsli3.ox_id;\n}\n\nstatic inline\nu32 get_job_data_placed(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn iocbq->wcqe_cmpl.total_data_placed;\n\telse\n\t\treturn iocbq->iocb.un.genreq64.bdl.bdeSize;\n}\n\nstatic inline\nu32 get_job_abtsiotag(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn iocbq->wqe.abort_cmd.wqe_com.abort_tag;\n\telse\n\t\treturn iocbq->iocb.un.acxri.abortIoTag;\n}\n\nstatic inline\nu32 get_job_els_rsp64_did(struct lpfc_hba *phba, struct lpfc_iocbq *iocbq)\n{\n\tif (phba->sli_rev == LPFC_SLI_REV4)\n\t\treturn bf_get(wqe_els_did, &iocbq->wqe.els_req.wqe_dest);\n\telse\n\t\treturn iocbq->iocb.un.elsreq64.remoteID;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}