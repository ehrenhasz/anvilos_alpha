{
  "module_name": "lpfc_nvme.h",
  "hash_id": "e61e09652354b6aab4135c0dae55a97630e69a694d84041b3483271d6c85b134",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/lpfc/lpfc_nvme.h",
  "human_readable_source": " \n\n#include <linux/nvme.h>\n#include <linux/nvme-fc-driver.h>\n#include <linux/nvme-fc.h>\n\n#define LPFC_NVME_DEFAULT_SEGS\t\t(64 + 1)\t \n\n#define LPFC_NVME_ERSP_LEN\t\t0x20\n\n#define LPFC_NVME_WAIT_TMO              10\n#define LPFC_NVME_EXPEDITE_XRICNT\t8\n#define LPFC_NVME_FB_SHIFT\t\t9\n#define LPFC_NVME_MAX_FB\t\t(1 << 20)\t \n\n#define lpfc_ndlp_get_nrport(ndlp)\t\t\t\t\\\n\t((!ndlp->nrport || (ndlp->fc4_xpt_flags & NVME_XPT_UNREG_WAIT))\\\n\t? NULL : ndlp->nrport)\n\nstruct lpfc_nvme_qhandle {\n\tuint32_t index;\t\t \n\tuint32_t qidx;\t\t \n\tuint32_t cpu_id;\t \n};\n\n \nstruct lpfc_nvme_lport {\n\tstruct lpfc_vport *vport;\n\tstruct completion *lport_unreg_cmp;\n\t \n\tatomic_t fc4NvmeLsRequests;\n\tatomic_t fc4NvmeLsCmpls;\n\tatomic_t xmt_fcp_noxri;\n\tatomic_t xmt_fcp_bad_ndlp;\n\tatomic_t xmt_fcp_qdepth;\n\tatomic_t xmt_fcp_wqerr;\n\tatomic_t xmt_fcp_err;\n\tatomic_t xmt_fcp_abort;\n\tatomic_t xmt_ls_abort;\n\tatomic_t xmt_ls_err;\n\tatomic_t cmpl_fcp_xb;\n\tatomic_t cmpl_fcp_err;\n\tatomic_t cmpl_ls_xb;\n\tatomic_t cmpl_ls_err;\n};\n\nstruct lpfc_nvme_rport {\n\tstruct lpfc_nvme_lport *lport;\n\tstruct nvme_fc_remote_port *remoteport;\n\tstruct lpfc_nodelist *ndlp;\n\tstruct completion rport_unreg_done;\n};\n\nstruct lpfc_nvme_fcpreq_priv {\n\tstruct lpfc_io_buf *nvme_buf;\n};\n\n \n#define LPFC_NVME_LS_TIMEOUT\t\t30\n\n\n#define LPFC_NVMET_DEFAULT_SEGS\t\t(64 + 1)\t \n#define LPFC_NVMET_RQE_MIN_POST\t\t128\n#define LPFC_NVMET_RQE_DEF_POST\t\t512\n#define LPFC_NVMET_RQE_DEF_COUNT\t2048\n#define LPFC_NVMET_SUCCESS_LEN\t\t12\n\n#define LPFC_NVMET_MRQ_AUTO\t\t0\n#define LPFC_NVMET_MRQ_MAX\t\t16\n\n#define LPFC_NVMET_WAIT_TMO\t\t(5 * MSEC_PER_SEC)\n\n \n#define LPFC_NVMET_INV_HOST_ACTIVE      1\n\nstruct lpfc_nvmet_tgtport {\n\tstruct lpfc_hba *phba;\n\tstruct completion *tport_unreg_cmp;\n\tatomic_t state;\t\t \n\n\t \n\tatomic_t rcv_ls_req_in;\n\tatomic_t rcv_ls_req_out;\n\tatomic_t rcv_ls_req_drop;\n\tatomic_t xmt_ls_abort;\n\tatomic_t xmt_ls_abort_cmpl;\n\n\t \n\tatomic_t xmt_ls_rsp;\n\tatomic_t xmt_ls_drop;\n\n\t \n\tatomic_t xmt_ls_rsp_error;\n\tatomic_t xmt_ls_rsp_aborted;\n\tatomic_t xmt_ls_rsp_xb_set;\n\tatomic_t xmt_ls_rsp_cmpl;\n\n\t \n\tatomic_t rcv_fcp_cmd_in;\n\tatomic_t rcv_fcp_cmd_out;\n\tatomic_t rcv_fcp_cmd_drop;\n\tatomic_t rcv_fcp_cmd_defer;\n\tatomic_t xmt_fcp_release;\n\n\t \n\tatomic_t xmt_fcp_drop;\n\tatomic_t xmt_fcp_read_rsp;\n\tatomic_t xmt_fcp_read;\n\tatomic_t xmt_fcp_write;\n\tatomic_t xmt_fcp_rsp;\n\n\t \n\tatomic_t xmt_fcp_rsp_xb_set;\n\tatomic_t xmt_fcp_rsp_cmpl;\n\tatomic_t xmt_fcp_rsp_error;\n\tatomic_t xmt_fcp_rsp_aborted;\n\tatomic_t xmt_fcp_rsp_drop;\n\n\t \n\tatomic_t xmt_fcp_xri_abort_cqe;\n\tatomic_t xmt_fcp_abort;\n\tatomic_t xmt_fcp_abort_cmpl;\n\tatomic_t xmt_abort_sol;\n\tatomic_t xmt_abort_unsol;\n\tatomic_t xmt_abort_rsp;\n\tatomic_t xmt_abort_rsp_error;\n\n\t \n\tatomic_t defer_ctx;\n\tatomic_t defer_fod;\n\tatomic_t defer_wqfull;\n};\n\nstruct lpfc_nvmet_ctx_info {\n\tstruct list_head nvmet_ctx_list;\n\tspinlock_t\tnvmet_ctx_list_lock;  \n\tstruct lpfc_nvmet_ctx_info *nvmet_ctx_next_cpu;\n\tstruct lpfc_nvmet_ctx_info *nvmet_ctx_start_cpu;\n\tuint16_t\tnvmet_ctx_list_cnt;\n\tchar pad[16];   \n};\n\n \n#define lpfc_get_ctx_list(phba, cpu, mrq)  \\\n\t(phba->sli4_hba.nvmet_ctx_info + ((cpu * phba->cfg_nvmet_mrq) + mrq))\n\n \n#define LPFC_NVME_STE_LS_RCV\t\t1\n#define LPFC_NVME_STE_LS_ABORT\t\t2\n#define LPFC_NVME_STE_LS_RSP\t\t3\n#define LPFC_NVME_STE_RCV\t\t4\n#define LPFC_NVME_STE_DATA\t\t5\n#define LPFC_NVME_STE_ABORT\t\t6\n#define LPFC_NVME_STE_DONE\t\t7\n#define LPFC_NVME_STE_FREE\t\t0xff\n\n \n#define LPFC_NVME_IO_INP\t\t0x1   \n#define LPFC_NVME_ABORT_OP\t\t0x2   \n#define LPFC_NVME_XBUSY\t\t\t0x4   \n#define LPFC_NVME_CTX_RLS\t\t0x8   \n#define LPFC_NVME_ABTS_RCV\t\t0x10   \n#define LPFC_NVME_CTX_REUSE_WQ\t\t0x20   \n#define LPFC_NVME_DEFER_WQFULL\t\t0x40   \n#define LPFC_NVME_TNOTIFY\t\t0x80   \n\nstruct lpfc_async_xchg_ctx {\n\tunion {\n\t\tstruct nvmefc_tgt_fcp_req fcp_req;\n\t} hdlrctx;\n\tstruct list_head list;\n\tstruct lpfc_hba *phba;\n\tstruct lpfc_nodelist *ndlp;\n\tstruct nvmefc_ls_req *ls_req;\n\tstruct nvmefc_ls_rsp ls_rsp;\n\tstruct lpfc_iocbq *wqeq;\n\tstruct lpfc_iocbq *abort_wqeq;\n\tspinlock_t ctxlock;  \n\tuint32_t sid;\n\tuint32_t offset;\n\tuint16_t oxid;\n\tuint16_t size;\n\tuint16_t entry_cnt;\n\tuint16_t cpu;\n\tuint16_t idx;\n\tuint16_t state;\n\tuint16_t flag;\n\tvoid *payload;\n\tstruct rqb_dmabuf *rqb_buffer;\n\tstruct lpfc_nvmet_ctxbuf *ctxbuf;\n\tstruct lpfc_sli4_hdw_queue *hdwq;\n\n#ifdef CONFIG_SCSI_LPFC_DEBUG_FS\n\tuint64_t ts_isr_cmd;\n\tuint64_t ts_cmd_nvme;\n\tuint64_t ts_nvme_data;\n\tuint64_t ts_data_wqput;\n\tuint64_t ts_isr_data;\n\tuint64_t ts_data_nvme;\n\tuint64_t ts_nvme_status;\n\tuint64_t ts_status_wqput;\n\tuint64_t ts_isr_status;\n\tuint64_t ts_status_nvme;\n#endif\n};\n\n\n \nint __lpfc_nvme_ls_req(struct lpfc_vport *vport, struct lpfc_nodelist *ndlp,\n\t\tstruct nvmefc_ls_req *pnvme_lsreq,\n\t\tvoid (*gen_req_cmp)(struct lpfc_hba *phba,\n\t\t\t\tstruct lpfc_iocbq *cmdwqe,\n\t\t\t\tstruct lpfc_iocbq *rspwqe));\nvoid __lpfc_nvme_ls_req_cmp(struct lpfc_hba *phba,  struct lpfc_vport *vport,\n\t\tstruct lpfc_iocbq *cmdwqe, struct lpfc_wcqe_complete *wcqe);\nint __lpfc_nvme_ls_abort(struct lpfc_vport *vport,\n\t\tstruct lpfc_nodelist *ndlp, struct nvmefc_ls_req *pnvme_lsreq);\n\n \nint lpfc_nvme_unsol_ls_issue_abort(struct lpfc_hba *phba,\n\t\t\tstruct lpfc_async_xchg_ctx *ctxp, uint32_t sid,\n\t\t\tuint16_t xri);\nint __lpfc_nvme_xmt_ls_rsp(struct lpfc_async_xchg_ctx *axchg,\n\t\t\tstruct nvmefc_ls_rsp *ls_rsp,\n\t\t\tvoid (*xmt_ls_rsp_cmp)(struct lpfc_hba *phba,\n\t\t\t\tstruct lpfc_iocbq *cmdwqe,\n\t\t\t\tstruct lpfc_iocbq *rspwqe));\nvoid __lpfc_nvme_xmt_ls_rsp_cmp(struct lpfc_hba *phba,\n\t\tstruct lpfc_iocbq *cmdwqe, struct lpfc_iocbq *rspwqe);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}