{
  "module_name": "qlogicpti.h",
  "hash_id": "b66812c32656ce32eabb5fdefde3640722510b134c716b3bca9629250010bf0d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/qlogicpti.h",
  "human_readable_source": " \n \n\n#ifndef _QLOGICPTI_H\n#define _QLOGICPTI_H\n\n \n#define SBUS_CFG1\t0x006UL\n#define SBUS_CTRL\t0x008UL\n#define SBUS_STAT\t0x00aUL\n#define SBUS_SEMAPHORE\t0x00cUL\n#define CMD_DMA_CTRL\t0x022UL\n#define DATA_DMA_CTRL\t0x042UL\n#define MBOX0\t\t0x080UL\n#define MBOX1\t\t0x082UL\n#define MBOX2\t\t0x084UL\n#define MBOX3\t\t0x086UL\n#define MBOX4\t\t0x088UL\n#define MBOX5\t\t0x08aUL\n#define CPU_CMD\t\t0x214UL\n#define CPU_ORIDE\t0x224UL\n#define CPU_PCTRL\t0x272UL\n#define CPU_PDIFF\t0x276UL\n#define RISC_PSR\t0x420UL\n#define RISC_MTREG\t0x42EUL\n#define HCCTRL\t\t0x440UL\n\n \n#define MAX_TARGETS\t16\n#define MAX_LUNS\t8\n\n \n#define QLOGICPTI_REQ_QUEUE_LEN\t255\t \n#define QLOGICPTI_MAX_SG(ql)\t(4 + (((ql) > 0) ? 7*((ql) - 1) : 0))\n\n \n#define MBOX_COMMAND_COMPLETE\t\t0x4000\n#define INVALID_COMMAND\t\t\t0x4001\n#define HOST_INTERFACE_ERROR\t\t0x4002\n#define TEST_FAILED\t\t\t0x4003\n#define COMMAND_ERROR\t\t\t0x4005\n#define COMMAND_PARAM_ERROR\t\t0x4006\n\n \n#define ASYNC_SCSI_BUS_RESET\t\t0x8001\n#define SYSTEM_ERROR\t\t\t0x8002\n#define REQUEST_TRANSFER_ERROR\t\t0x8003\n#define RESPONSE_TRANSFER_ERROR\t\t0x8004\n#define REQUEST_QUEUE_WAKEUP\t\t0x8005\n#define EXECUTION_TIMEOUT_RESET\t\t0x8006\n\n \nstruct Entry_header {\n#ifdef __BIG_ENDIAN\n\tu8\tentry_cnt;\n\tu8\tentry_type;\n\tu8\tflags;\n\tu8\tsys_def_1;\n#else  \n\tu8\tentry_type;\n\tu8\tentry_cnt;\n\tu8\tsys_def_1;\n\tu8\tflags;\n#endif\n};\n\n \n#define ENTRY_COMMAND\t\t1\n#define ENTRY_CONTINUATION\t2\n#define ENTRY_STATUS\t\t3\n#define ENTRY_MARKER\t\t4\n#define ENTRY_EXTENDED_COMMAND\t5\n\n \n#define EFLAG_CONTINUATION\t1\n#define EFLAG_BUSY\t\t2\n#define EFLAG_BAD_HEADER\t4\n#define EFLAG_BAD_PAYLOAD\t8\n\nstruct dataseg {\n\tu32\td_base;\n\tu32\td_count;\n};\n\nstruct Command_Entry {\n\tstruct Entry_header\thdr;\n\tu32\t\t\thandle;\n#ifdef __BIG_ENDIAN\n\tu8\t\t\ttarget_id;\n\tu8\t\t\ttarget_lun;\n#else  \n\tu8\t\t\ttarget_lun;\n\tu8\t\t\ttarget_id;\n#endif\n\tu16\t\t\tcdb_length;\n\tu16\t\t\tcontrol_flags;\n\tu16\t\t\trsvd;\n\tu16\t\t\ttime_out;\n\tu16\t\t\tsegment_cnt;\n\tu8\t\t\tcdb[12];\n\tstruct dataseg\t\tdataseg[4];\n};\n\n \n#define CFLAG_NODISC\t\t0x01\n#define CFLAG_HEAD_TAG\t\t0x02\n#define CFLAG_ORDERED_TAG\t0x04\n#define CFLAG_SIMPLE_TAG\t0x08\n#define CFLAG_TAR_RTN\t\t0x10\n#define CFLAG_READ\t\t0x20\n#define CFLAG_WRITE\t\t0x40\n\nstruct Ext_Command_Entry {\n\tstruct Entry_header\thdr;\n\tu32\t\t\thandle;\n#ifdef __BIG_ENDIAN\n\tu8\t\t\ttarget_id;\n\tu8\t\t\ttarget_lun;\n#else  \n\tu8\t\t\ttarget_lun;\n\tu8\t\t\ttarget_id;\n#endif\n\tu16\t\t\tcdb_length;\n\tu16\t\t\tcontrol_flags;\n\tu16\t\t\trsvd;\n\tu16\t\t\ttime_out;\n\tu16\t\t\tsegment_cnt;\n\tu8\t\t\tcdb[44];\n};\n\nstruct Continuation_Entry {\n\tstruct Entry_header\thdr;\n\tu32\t\t\treserved;\n\tstruct dataseg\t\tdataseg[7];\n};\n\nstruct Marker_Entry {\n\tstruct Entry_header\thdr;\n\tu32\t\t\treserved;\n#ifdef __BIG_ENDIAN\n\tu8\t\t\ttarget_id;\n\tu8\t\t\ttarget_lun;\n#else  \n\tu8\t\t\ttarget_lun;\n\tu8\t\t\ttarget_id;\n#endif\n#ifdef __BIG_ENDIAN\n\tu8\t\t\trsvd;\n\tu8\t\t\tmodifier;\n#else  \n\tu8\t\t\tmodifier;\n\tu8\t\t\trsvd;\n#endif\n\tu8\t\t\trsvds[52];\n};\n\n \n#define SYNC_DEVICE\t0\n#define SYNC_TARGET\t1\n#define SYNC_ALL\t2\n\nstruct Status_Entry {\n\tstruct Entry_header\thdr;\n\tu32\t\t\thandle;\n\tu16\t\t\tscsi_status;\n\tu16\t\t\tcompletion_status;\n\tu16\t\t\tstate_flags;\n\tu16\t\t\tstatus_flags;\n\tu16\t\t\ttime;\n\tu16\t\t\treq_sense_len;\n\tu32\t\t\tresidual;\n\tu8\t\t\trsvd[8];\n\tu8\t\t\treq_sense_data[32];\n};\n\n \n#define CS_COMPLETE\t\t\t0x0000\n#define CS_INCOMPLETE\t\t\t0x0001\n#define CS_DMA_ERROR\t\t\t0x0002\n#define CS_TRANSPORT_ERROR\t\t0x0003\n#define CS_RESET_OCCURRED\t\t0x0004\n#define CS_ABORTED\t\t\t0x0005\n#define CS_TIMEOUT\t\t\t0x0006\n#define CS_DATA_OVERRUN\t\t\t0x0007\n#define CS_COMMAND_OVERRUN\t\t0x0008\n#define CS_STATUS_OVERRUN\t\t0x0009\n#define CS_BAD_MESSAGE\t\t\t0x000a\n#define CS_NO_MESSAGE_OUT\t\t0x000b\n#define CS_EXT_ID_FAILED\t\t0x000c\n#define CS_IDE_MSG_FAILED\t\t0x000d\n#define CS_ABORT_MSG_FAILED\t\t0x000e\n#define CS_REJECT_MSG_FAILED\t\t0x000f\n#define CS_NOP_MSG_FAILED\t\t0x0010\n#define CS_PARITY_ERROR_MSG_FAILED\t0x0011\n#define CS_DEVICE_RESET_MSG_FAILED\t0x0012\n#define CS_ID_MSG_FAILED\t\t0x0013\n#define CS_UNEXP_BUS_FREE\t\t0x0014\n#define CS_DATA_UNDERRUN\t\t0x0015\n#define CS_BUS_RESET\t\t\t0x001c\n\n \n#define SF_GOT_BUS\t\t\t0x0100\n#define SF_GOT_TARGET\t\t\t0x0200\n#define SF_SENT_CDB\t\t\t0x0400\n#define SF_TRANSFERRED_DATA\t\t0x0800\n#define SF_GOT_STATUS\t\t\t0x1000\n#define SF_GOT_SENSE\t\t\t0x2000\n\n \n#define STF_DISCONNECT\t\t\t0x0001\n#define STF_SYNCHRONOUS\t\t\t0x0002\n#define STF_PARITY_ERROR\t\t0x0004\n#define STF_BUS_RESET\t\t\t0x0008\n#define STF_DEVICE_RESET\t\t0x0010\n#define STF_ABORTED\t\t\t0x0020\n#define STF_TIMEOUT\t\t\t0x0040\n#define STF_NEGOTIATION\t\t\t0x0080\n\n \n#define MBOX_NO_OP\t\t\t0x0000\n#define MBOX_LOAD_RAM\t\t\t0x0001\n#define MBOX_EXEC_FIRMWARE\t\t0x0002\n#define MBOX_DUMP_RAM\t\t\t0x0003\n#define MBOX_WRITE_RAM_WORD\t\t0x0004\n#define MBOX_READ_RAM_WORD\t\t0x0005\n#define MBOX_MAILBOX_REG_TEST\t\t0x0006\n#define MBOX_VERIFY_CHECKSUM\t\t0x0007\n#define MBOX_ABOUT_FIRMWARE\t\t0x0008\n#define MBOX_CHECK_FIRMWARE\t\t0x000e\n#define MBOX_INIT_REQ_QUEUE\t\t0x0010\n#define MBOX_INIT_RES_QUEUE\t\t0x0011\n#define MBOX_EXECUTE_IOCB\t\t0x0012\n#define MBOX_WAKE_UP\t\t\t0x0013\n#define MBOX_STOP_FIRMWARE\t\t0x0014\n#define MBOX_ABORT\t\t\t0x0015\n#define MBOX_ABORT_DEVICE\t\t0x0016\n#define MBOX_ABORT_TARGET\t\t0x0017\n#define MBOX_BUS_RESET\t\t\t0x0018\n#define MBOX_STOP_QUEUE\t\t\t0x0019\n#define MBOX_START_QUEUE\t\t0x001a\n#define MBOX_SINGLE_STEP_QUEUE\t\t0x001b\n#define MBOX_ABORT_QUEUE\t\t0x001c\n#define MBOX_GET_DEV_QUEUE_STATUS\t0x001d\n#define MBOX_GET_FIRMWARE_STATUS\t0x001f\n#define MBOX_GET_INIT_SCSI_ID\t\t0x0020\n#define MBOX_GET_SELECT_TIMEOUT\t\t0x0021\n#define MBOX_GET_RETRY_COUNT\t\t0x0022\n#define MBOX_GET_TAG_AGE_LIMIT\t\t0x0023\n#define MBOX_GET_CLOCK_RATE\t\t0x0024\n#define MBOX_GET_ACT_NEG_STATE\t\t0x0025\n#define MBOX_GET_ASYNC_DATA_SETUP_TIME\t0x0026\n#define MBOX_GET_SBUS_PARAMS\t\t0x0027\n#define MBOX_GET_TARGET_PARAMS\t\t0x0028\n#define MBOX_GET_DEV_QUEUE_PARAMS\t0x0029\n#define MBOX_SET_INIT_SCSI_ID\t\t0x0030\n#define MBOX_SET_SELECT_TIMEOUT\t\t0x0031\n#define MBOX_SET_RETRY_COUNT\t\t0x0032\n#define MBOX_SET_TAG_AGE_LIMIT\t\t0x0033\n#define MBOX_SET_CLOCK_RATE\t\t0x0034\n#define MBOX_SET_ACTIVE_NEG_STATE\t0x0035\n#define MBOX_SET_ASYNC_DATA_SETUP_TIME\t0x0036\n#define MBOX_SET_SBUS_CONTROL_PARAMS\t0x0037\n#define MBOX_SET_TARGET_PARAMS\t\t0x0038\n#define MBOX_SET_DEV_QUEUE_PARAMS\t0x0039\n\nstruct host_param {\n\tu_short\t\tinitiator_scsi_id;\n\tu_short\t\tbus_reset_delay;\n\tu_short\t\tretry_count;\n\tu_short\t\tretry_delay;\n\tu_short\t\tasync_data_setup_time;\n\tu_short\t\treq_ack_active_negation;\n\tu_short\t\tdata_line_active_negation;\n\tu_short\t\tdata_dma_burst_enable;\n\tu_short\t\tcommand_dma_burst_enable;\n\tu_short\t\ttag_aging;\n\tu_short\t\tselection_timeout;\n\tu_short\t\tmax_queue_depth;\n};\n\n \n\nstruct dev_param {\n\tu_short\t\tdevice_flags;\n\tu_short\t\texecution_throttle;\n\tu_short\t\tsynchronous_period;\n\tu_short\t\tsynchronous_offset;\n\tu_short\t\tdevice_enable;\n\tu_short\t\treserved;  \n};\n\n \n#define RES_QUEUE_LEN\t\t255\t \n#define QUEUE_ENTRY_LEN\t\t64\n\n#define NEXT_REQ_PTR(wheee)   (((wheee) + 1) & QLOGICPTI_REQ_QUEUE_LEN)\n#define NEXT_RES_PTR(wheee)   (((wheee) + 1) & RES_QUEUE_LEN)\n#define PREV_REQ_PTR(wheee)   (((wheee) - 1) & QLOGICPTI_REQ_QUEUE_LEN)\n#define PREV_RES_PTR(wheee)   (((wheee) - 1) & RES_QUEUE_LEN)\n\nstruct pti_queue_entry {\n\tchar __opaque[QUEUE_ENTRY_LEN];\n};\n\nstruct scsi_cmnd;\n\n \nstruct qlogicpti {\n\t \n\tvoid __iomem             *qregs;                 \n\tstruct pti_queue_entry   *res_cpu;               \n\tstruct pti_queue_entry   *req_cpu;               \n\n\tu_int\t                  req_in_ptr;\t\t \n\tu_int\t                  res_out_ptr;\t\t \n\tlong\t                  send_marker;\t\t \n\tstruct platform_device\t *op;\n\tunsigned long\t\t  __pad;\n\n\tint                       cmd_count[MAX_TARGETS];\n\tunsigned long             tag_ages[MAX_TARGETS];\n\n\t \n\tstruct scsi_cmnd         *cmd_slots[QLOGICPTI_REQ_QUEUE_LEN + 1];\n\n\t \n\tstruct qlogicpti         *next;\n\tdma_addr_t                res_dvma;              \n\tdma_addr_t                req_dvma;              \n\tu_char\t                  fware_majrev, fware_minrev, fware_micrev;\n\tstruct Scsi_Host         *qhost;\n\tint                       qpti_id;\n\tint                       scsi_id;\n\tint                       prom_node;\n\tint                       irq;\n\tchar                      differential, ultra, clock;\n\tunsigned char             bursts;\n\tstruct\thost_param        host_param;\n\tstruct\tdev_param         dev_param[MAX_TARGETS];\n\n\tvoid __iomem              *sreg;\n#define SREG_TPOWER               0x80    \n#define SREG_FUSE                 0x40    \n#define SREG_PDISAB               0x20    \n#define SREG_DSENSE               0x10    \n#define SREG_IMASK                0x0c    \n#define SREG_SPMASK               0x03    \n\tunsigned char             swsreg;\n\tunsigned int\n\t\tgotirq\t:\t1,\t \n\t\tis_pti\t: \t1;\t \n};\n\n \n\n \n#define SBUS_CFG1_EPAR          0x0100       \n#define SBUS_CFG1_FMASK         0x00f0       \n#define SBUS_CFG1_BENAB         0x0004       \n#define SBUS_CFG1_B64           0x0003       \n#define SBUS_CFG1_B32           0x0002       \n#define SBUS_CFG1_B16           0x0001       \n#define SBUS_CFG1_B8            0x0008       \n\n \n#define SBUS_CTRL_EDIRQ         0x0020       \n#define SBUS_CTRL_ECIRQ         0x0010       \n#define SBUS_CTRL_ESIRQ         0x0008       \n#define SBUS_CTRL_ERIRQ         0x0004       \n#define SBUS_CTRL_GENAB         0x0002       \n#define SBUS_CTRL_RESET         0x0001       \n\n \n#define SBUS_STAT_DINT          0x0020       \n#define SBUS_STAT_CINT          0x0010       \n#define SBUS_STAT_SINT          0x0008       \n#define SBUS_STAT_RINT          0x0004       \n#define SBUS_STAT_GINT          0x0002       \n\n \n#define SBUS_SEMAPHORE_STAT     0x0002       \n#define SBUS_SEMAPHORE_LCK      0x0001       \n\n \n#define DMA_CTRL_CSUSPEND       0x0010       \n#define DMA_CTRL_CCLEAR         0x0008       \n#define DMA_CTRL_FCLEAR         0x0004       \n#define DMA_CTRL_CIRQ           0x0002       \n#define DMA_CTRL_DMASTART       0x0001       \n\n \n#define CPU_ORIDE_ETRIG         0x8000       \n#define CPU_ORIDE_STEP          0x4000       \n#define CPU_ORIDE_BKPT          0x2000       \n#define CPU_ORIDE_PWRITE        0x1000       \n#define CPU_ORIDE_OFORCE        0x0800       \n#define CPU_ORIDE_LBACK         0x0400       \n#define CPU_ORIDE_PTEST         0x0200       \n#define CPU_ORIDE_TENAB         0x0100       \n#define CPU_ORIDE_TPINS         0x0080       \n#define CPU_ORIDE_FRESET        0x0008       \n#define CPU_ORIDE_CTERM         0x0004       \n#define CPU_ORIDE_RREG          0x0002       \n#define CPU_ORIDE_RMOD          0x0001       \n\n \n#define CPU_CMD_BRESET          0x300b       \n\n \n#define CPU_PCTRL_PVALID        0x8000       \n#define CPU_PCTRL_PHI           0x0400       \n#define CPU_PCTRL_PLO           0x0200       \n#define CPU_PCTRL_REQ           0x0100       \n#define CPU_PCTRL_ACK           0x0080       \n#define CPU_PCTRL_RST           0x0040       \n#define CPU_PCTRL_BSY           0x0020       \n#define CPU_PCTRL_SEL           0x0010       \n#define CPU_PCTRL_ATN           0x0008       \n#define CPU_PCTRL_MSG           0x0004       \n#define CPU_PCTRL_CD            0x0002       \n#define CPU_PCTRL_IO            0x0001       \n\n \n#define CPU_PDIFF_SENSE         0x0200       \n#define CPU_PDIFF_MODE          0x0100       \n#define CPU_PDIFF_OENAB         0x0080       \n#define CPU_PDIFF_PMASK         0x007c       \n#define CPU_PDIFF_TGT           0x0002       \n#define CPU_PDIFF_INIT          0x0001       \n\n \n#define RISC_PSR_FTRUE          0x8000       \n#define RISC_PSR_LCD            0x4000       \n#define RISC_PSR_RIRQ           0x2000       \n#define RISC_PSR_TOFLOW         0x1000       \n#define RISC_PSR_AOFLOW         0x0800       \n#define RISC_PSR_AMSB           0x0400       \n#define RISC_PSR_ACARRY         0x0200       \n#define RISC_PSR_AZERO          0x0100       \n#define RISC_PSR_ULTRA          0x0020       \n#define RISC_PSR_DIRQ           0x0010       \n#define RISC_PSR_SIRQ           0x0008       \n#define RISC_PSR_HIRQ           0x0004       \n#define RISC_PSR_IPEND          0x0002       \n#define RISC_PSR_FFALSE         0x0001       \n\n \n#define RISC_MTREG_P1DFLT       0x1200       \n#define RISC_MTREG_P0DFLT       0x0012       \n#define RISC_MTREG_P1ULTRA      0x2300       \n#define RISC_MTREG_P0ULTRA      0x0023       \n\n \n#define HCCTRL_NOP              0x0000       \n#define HCCTRL_RESET            0x1000       \n#define HCCTRL_PAUSE            0x2000       \n#define HCCTRL_REL              0x3000       \n#define HCCTRL_STEP             0x4000       \n#define HCCTRL_SHIRQ            0x5000       \n#define HCCTRL_CHIRQ            0x6000       \n#define HCCTRL_CRIRQ            0x7000       \n#define HCCTRL_BKPT             0x8000       \n#define HCCTRL_TMODE            0xf000       \n#define HCCTRL_HIRQ             0x0080       \n#define HCCTRL_RRIP             0x0040       \n#define HCCTRL_RPAUSED          0x0020       \n#define HCCTRL_EBENAB           0x0010       \n#define HCCTRL_B1ENAB           0x0008       \n#define HCCTRL_B0ENAB           0x0004       \n\n \n#define for_each_qlogicpti(qp) \\\n        for((qp) = qptichain; (qp); (qp) = (qp)->next)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}