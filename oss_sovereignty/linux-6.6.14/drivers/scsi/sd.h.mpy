{
  "module_name": "sd.h",
  "hash_id": "e1bf6f40802e7e4c738e25842c5fc32c676f8cd4ee432015db8917f9b63f37e1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/sd.h",
  "human_readable_source": " \n#ifndef _SCSI_DISK_H\n#define _SCSI_DISK_H\n\n \n#define SD_MAJORS\t16\n\n \n#define SD_TIMEOUT\t\t(30 * HZ)\n#define SD_MOD_TIMEOUT\t\t(75 * HZ)\n \n#define SD_FLUSH_TIMEOUT_MULTIPLIER\t2\n#define SD_WRITE_SAME_TIMEOUT\t(120 * HZ)\n\n \n#define SD_MAX_RETRIES\t\t5\n#define SD_PASSTHROUGH_RETRIES\t1\n#define SD_MAX_MEDIUM_TIMEOUTS\t2\n\n \n#define SD_BUF_SIZE\t\t512\n\n \n#define SD_LAST_BUGGY_SECTORS\t8\n\nenum {\n\tSD_EXT_CDB_SIZE = 32,\t \n\tSD_MEMPOOL_SIZE = 2,\t \n};\n\nenum {\n\tSD_DEF_XFER_BLOCKS = 0xffff,\n\tSD_MAX_XFER_BLOCKS = 0xffffffff,\n\tSD_MAX_WS10_BLOCKS = 0xffff,\n\tSD_MAX_WS16_BLOCKS = 0x7fffff,\n};\n\nenum {\n\tSD_LBP_FULL = 0,\t \n\tSD_LBP_UNMAP,\t\t \n\tSD_LBP_WS16,\t\t \n\tSD_LBP_WS10,\t\t \n\tSD_LBP_ZERO,\t\t \n\tSD_LBP_DISABLE,\t\t \n};\n\nenum {\n\tSD_ZERO_WRITE = 0,\t \n\tSD_ZERO_WS,\t\t \n\tSD_ZERO_WS16_UNMAP,\t \n\tSD_ZERO_WS10_UNMAP,\t \n};\n\n \nstruct zoned_disk_info {\n\tu32\t\tnr_zones;\n\tu32\t\tzone_blocks;\n};\n\nstruct scsi_disk {\n\tstruct scsi_device *device;\n\n\t \n\tstruct device\tdisk_dev;\n\tstruct gendisk\t*disk;\n\tstruct opal_dev *opal_dev;\n#ifdef CONFIG_BLK_DEV_ZONED\n\t \n\tstruct zoned_disk_info\tearly_zone_info;\n\t \n\tstruct zoned_disk_info\tzone_info;\n\tu32\t\tzones_optimal_open;\n\tu32\t\tzones_optimal_nonseq;\n\tu32\t\tzones_max_open;\n\t \n\tu32\t\tzone_starting_lba_gran;\n\tu32\t\t*zones_wp_offset;\n\tspinlock_t\tzones_wp_offset_lock;\n\tu32\t\t*rev_wp_offset;\n\tstruct mutex\trev_mutex;\n\tstruct work_struct zone_wp_offset_work;\n\tchar\t\t*zone_wp_update_buf;\n#endif\n\tatomic_t\topeners;\n\tsector_t\tcapacity;\t \n\tint\t\tmax_retries;\n\tu32\t\tmin_xfer_blocks;\n\tu32\t\tmax_xfer_blocks;\n\tu32\t\topt_xfer_blocks;\n\tu32\t\tmax_ws_blocks;\n\tu32\t\tmax_unmap_blocks;\n\tu32\t\tunmap_granularity;\n\tu32\t\tunmap_alignment;\n\tu32\t\tindex;\n\tunsigned int\tphysical_block_size;\n\tunsigned int\tmax_medium_access_timeouts;\n\tunsigned int\tmedium_access_timed_out;\n\tu8\t\tmedia_present;\n\tu8\t\twrite_prot;\n\tu8\t\tprotection_type; \n\tu8\t\tprovisioning_mode;\n\tu8\t\tzeroing_mode;\n\tu8\t\tnr_actuators;\t\t \n\tbool\t\tsuspended;\t \n\tunsigned\tATO : 1;\t \n\tunsigned\tcache_override : 1;  \n\tunsigned\tWCE : 1;\t \n\tunsigned\tRCD : 1;\t \n\tunsigned\tDPOFUA : 1;\t \n\tunsigned\tfirst_scan : 1;\n\tunsigned\tlbpme : 1;\n\tunsigned\tlbprz : 1;\n\tunsigned\tlbpu : 1;\n\tunsigned\tlbpws : 1;\n\tunsigned\tlbpws10 : 1;\n\tunsigned\tlbpvpd : 1;\n\tunsigned\tws10 : 1;\n\tunsigned\tws16 : 1;\n\tunsigned\trc_basis: 2;\n\tunsigned\tzoned: 2;\n\tunsigned\turswrz : 1;\n\tunsigned\tsecurity : 1;\n\tunsigned\tignore_medium_access_errors : 1;\n};\n#define to_scsi_disk(obj) container_of(obj, struct scsi_disk, disk_dev)\n\nstatic inline struct scsi_disk *scsi_disk(struct gendisk *disk)\n{\n\treturn disk->private_data;\n}\n\n#define sd_printk(prefix, sdsk, fmt, a...)\t\t\t\t\\\n        (sdsk)->disk ?\t\t\t\t\t\t\t\\\n\t      sdev_prefix_printk(prefix, (sdsk)->device,\t\t\\\n\t\t\t\t (sdsk)->disk->disk_name, fmt, ##a) :\t\\\n\t      sdev_printk(prefix, (sdsk)->device, fmt, ##a)\n\n#define sd_first_printk(prefix, sdsk, fmt, a...)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tif ((sdsk)->first_scan)\t\t\t\t\t\\\n\t\t\tsd_printk(prefix, sdsk, fmt, ##a);\t\t\\\n\t} while (0)\n\nstatic inline int scsi_medium_access_command(struct scsi_cmnd *scmd)\n{\n\tswitch (scmd->cmnd[0]) {\n\tcase READ_6:\n\tcase READ_10:\n\tcase READ_12:\n\tcase READ_16:\n\tcase SYNCHRONIZE_CACHE:\n\tcase VERIFY:\n\tcase VERIFY_12:\n\tcase VERIFY_16:\n\tcase WRITE_6:\n\tcase WRITE_10:\n\tcase WRITE_12:\n\tcase WRITE_16:\n\tcase WRITE_SAME:\n\tcase WRITE_SAME_16:\n\tcase UNMAP:\n\t\treturn 1;\n\tcase VARIABLE_LENGTH_CMD:\n\t\tswitch (scmd->cmnd[9]) {\n\t\tcase READ_32:\n\t\tcase VERIFY_32:\n\t\tcase WRITE_32:\n\t\tcase WRITE_SAME_32:\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic inline sector_t logical_to_sectors(struct scsi_device *sdev, sector_t blocks)\n{\n\treturn blocks << (ilog2(sdev->sector_size) - 9);\n}\n\nstatic inline unsigned int logical_to_bytes(struct scsi_device *sdev, sector_t blocks)\n{\n\treturn blocks * sdev->sector_size;\n}\n\nstatic inline sector_t bytes_to_logical(struct scsi_device *sdev, unsigned int bytes)\n{\n\treturn bytes >> ilog2(sdev->sector_size);\n}\n\nstatic inline sector_t sectors_to_logical(struct scsi_device *sdev, sector_t sector)\n{\n\treturn sector >> (ilog2(sdev->sector_size) - 9);\n}\n\n#ifdef CONFIG_BLK_DEV_INTEGRITY\n\nextern void sd_dif_config_host(struct scsi_disk *);\n\n#else  \n\nstatic inline void sd_dif_config_host(struct scsi_disk *disk)\n{\n}\n\n#endif  \n\nstatic inline int sd_is_zoned(struct scsi_disk *sdkp)\n{\n\treturn sdkp->zoned == 1 || sdkp->device->type == TYPE_ZBC;\n}\n\n#ifdef CONFIG_BLK_DEV_ZONED\n\nvoid sd_zbc_free_zone_info(struct scsi_disk *sdkp);\nint sd_zbc_read_zones(struct scsi_disk *sdkp, u8 buf[SD_BUF_SIZE]);\nint sd_zbc_revalidate_zones(struct scsi_disk *sdkp);\nblk_status_t sd_zbc_setup_zone_mgmt_cmnd(struct scsi_cmnd *cmd,\n\t\t\t\t\t unsigned char op, bool all);\nunsigned int sd_zbc_complete(struct scsi_cmnd *cmd, unsigned int good_bytes,\n\t\t\t     struct scsi_sense_hdr *sshdr);\nint sd_zbc_report_zones(struct gendisk *disk, sector_t sector,\n\t\tunsigned int nr_zones, report_zones_cb cb, void *data);\n\nblk_status_t sd_zbc_prepare_zone_append(struct scsi_cmnd *cmd, sector_t *lba,\n\t\t\t\t        unsigned int nr_blocks);\n\n#else  \n\nstatic inline void sd_zbc_free_zone_info(struct scsi_disk *sdkp) {}\n\nstatic inline int sd_zbc_read_zones(struct scsi_disk *sdkp, u8 buf[SD_BUF_SIZE])\n{\n\treturn 0;\n}\n\nstatic inline int sd_zbc_revalidate_zones(struct scsi_disk *sdkp)\n{\n\treturn 0;\n}\n\nstatic inline blk_status_t sd_zbc_setup_zone_mgmt_cmnd(struct scsi_cmnd *cmd,\n\t\t\t\t\t\t       unsigned char op,\n\t\t\t\t\t\t       bool all)\n{\n\treturn BLK_STS_TARGET;\n}\n\nstatic inline unsigned int sd_zbc_complete(struct scsi_cmnd *cmd,\n\t\t\tunsigned int good_bytes, struct scsi_sense_hdr *sshdr)\n{\n\treturn good_bytes;\n}\n\nstatic inline blk_status_t sd_zbc_prepare_zone_append(struct scsi_cmnd *cmd,\n\t\t\t\t\t\t      sector_t *lba,\n\t\t\t\t\t\t      unsigned int nr_blocks)\n{\n\treturn BLK_STS_TARGET;\n}\n\n#define sd_zbc_report_zones NULL\n\n#endif  \n\nvoid sd_print_sense_hdr(struct scsi_disk *sdkp, struct scsi_sense_hdr *sshdr);\nvoid sd_print_result(const struct scsi_disk *sdkp, const char *msg, int result);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}