{
  "module_name": "fc_elsct.c",
  "hash_id": "918506e48e47061a1ffd7adf00f10971fd7cf6ba245c495080f9b33d2309e2c5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/libfc/fc_elsct.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/export.h>\n#include <asm/unaligned.h>\n#include <scsi/fc/fc_gs.h>\n#include <scsi/fc/fc_ns.h>\n#include <scsi/fc/fc_els.h>\n#include <scsi/libfc.h>\n#include \"fc_encode.h\"\n#include \"fc_libfc.h\"\n\n \nstruct fc_seq *fc_elsct_send(struct fc_lport *lport, u32 did,\n\t\t\t     struct fc_frame *fp, unsigned int op,\n\t\t\t     void (*resp)(struct fc_seq *,\n\t\t\t\t\t  struct fc_frame *,\n\t\t\t\t\t  void *),\n\t\t\t     void *arg, u32 timer_msec)\n{\n\tenum fc_rctl r_ctl;\n\tenum fc_fh_type fh_type;\n\tint rc;\n\n\t \n\tif ((op >= ELS_LS_RJT) && (op <= ELS_AUTH_ELS))\n\t\trc = fc_els_fill(lport, did, fp, op, &r_ctl, &fh_type);\n\telse {\n\t\t \n\t\trc = fc_ct_fill(lport, did, fp, op, &r_ctl, &fh_type, &did);\n\t}\n\n\tif (rc) {\n\t\tfc_frame_free(fp);\n\t\treturn NULL;\n\t}\n\n\tfc_fill_fc_hdr(fp, r_ctl, did, lport->port_id, fh_type,\n\t\t       FC_FCTL_REQ, 0);\n\n\treturn fc_exch_seq_send(lport, fp, resp, NULL, arg, timer_msec);\n}\nEXPORT_SYMBOL(fc_elsct_send);\n\n \nint fc_elsct_init(struct fc_lport *lport)\n{\n\tif (!lport->tt.elsct_send)\n\t\tlport->tt.elsct_send = fc_elsct_send;\n\n\treturn 0;\n}\nEXPORT_SYMBOL(fc_elsct_init);\n\n \nconst char *fc_els_resp_type(struct fc_frame *fp)\n{\n\tconst char *msg;\n\tstruct fc_frame_header *fh;\n\tstruct fc_ct_hdr *ct;\n\n\tif (IS_ERR(fp)) {\n\t\tswitch (-PTR_ERR(fp)) {\n\t\tcase FC_NO_ERR:\n\t\t\tmsg = \"response no error\";\n\t\t\tbreak;\n\t\tcase FC_EX_TIMEOUT:\n\t\t\tmsg = \"response timeout\";\n\t\t\tbreak;\n\t\tcase FC_EX_CLOSED:\n\t\t\tmsg = \"response closed\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tmsg = \"response unknown error\";\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tfh = fc_frame_header_get(fp);\n\t\tswitch (fh->fh_type) {\n\t\tcase FC_TYPE_ELS:\n\t\t\tswitch (fc_frame_payload_op(fp)) {\n\t\t\tcase ELS_LS_ACC:\n\t\t\t\tmsg = \"accept\";\n\t\t\t\tbreak;\n\t\t\tcase ELS_LS_RJT:\n\t\t\t\tmsg = \"reject\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmsg = \"response unknown ELS\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase FC_TYPE_CT:\n\t\t\tct = fc_frame_payload_get(fp, sizeof(*ct));\n\t\t\tif (ct) {\n\t\t\t\tswitch (ntohs(ct->ct_cmd)) {\n\t\t\t\tcase FC_FS_ACC:\n\t\t\t\t\tmsg = \"CT accept\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase FC_FS_RJT:\n\t\t\t\t\tmsg = \"CT reject\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tmsg = \"response unknown CT\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmsg = \"short CT response\";\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tmsg = \"response not ELS or CT\";\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn msg;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}