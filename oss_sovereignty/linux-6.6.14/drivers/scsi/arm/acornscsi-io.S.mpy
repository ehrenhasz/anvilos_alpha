{
  "module_name": "acornscsi-io.S",
  "hash_id": "095a99ac3823b5182d0f4efb7e3941cbe9ac75148ff79f89725081704fb277f8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/arm/acornscsi-io.S",
  "human_readable_source": " \n \n#include <linux/linkage.h>\n\n#include <asm/assembler.h>\n#include <mach/hardware.h>\n\n#if defined(__APCS_32__)\n#define LOADREGS(t,r,l...)\tldm##t\tr, l\n#elif defined(__APCS_26__)\n#define LOADREGS(t,r,l...)\tldm##t\tr, l##^\n#endif\n\n@ Purpose: transfer a block of data from the acorn scsi card to memory\n@ Proto  : void acornscsi_in(unsigned int addr_start, char *buffer, int length)\n@ Returns: nothing\n\n\t\t.align\nENTRY(__acornscsi_in)\n\t\tstmfd\tsp!, {r4 - r7, lr}\n\t\tbic\tr0, r0, #3\n\t\tmov\tlr, #0xff\n\t\torr\tlr, lr, #0xff00\nacornscsi_in16lp:\n\t\tsubs\tr2, r2, #16\n\t\tbmi\tacornscsi_in8\n\t\tldmia\tr0!, {r3, r4, r5, r6}\n\t\tand\tr3, r3, lr\n\t\torr\tr3, r3, r4, lsl #16\n\t\tand \tr4, r5, lr\n\t\torr\tr4, r4, r6, lsl #16\n\t\tldmia\tr0!, {r5, r6, r7, ip}\n\t\tand\tr5, r5, lr\n\t\torr\tr5, r5, r6, lsl #16\n\t\tand\tr6, r7, lr\n\t\torr\tr6, r6, ip, lsl #16\n\t\tstmia\tr1!, {r3 - r6}\n\t\tbne\tacornscsi_in16lp\n\t\tLOADREGS(fd, sp!, {r4 - r7, pc})\n\nacornscsi_in8:\tadds\tr2, r2, #8\n\t\tbmi\tacornscsi_in4\n\t\tldmia\tr0!, {r3, r4, r5, r6}\n\t\tand\tr3, r3, lr\n\t\torr\tr3, r3, r4, lsl #16\n\t\tand\tr4, r5, lr\n\t\torr\tr4, r4, r6, lsl #16\n\t\tstmia\tr1!, {r3 - r4}\n\t\tLOADREGS(eqfd, sp!, {r4 - r7, pc})\n\t\tsub\tr2, r2, #8\n\nacornscsi_in4:\tadds\tr2, r2, #4\n\t\tbmi\tacornscsi_in2\n\t\tldmia\tr0!, {r3, r4}\n\t\tand\tr3, r3, lr\n\t\torr\tr3, r3, r4, lsl #16\n\t\tstr\tr3, [r1], #4\n\t\tLOADREGS(eqfd, sp!, {r4 - r7, pc})\n\t\tsub\tr2, r2, #4\n\nacornscsi_in2:\tadds\tr2, r2, #2\n\t\tldr\tr3, [r0], #4\n\t\tand\tr3, r3, lr\n\t\tstrb\tr3, [r1], #1\n\t\tmov\tr3, r3, lsr #8\n\t\tstrplb\tr3, [r1], #1\n\t\tLOADREGS(fd, sp!, {r4 - r7, pc})\n\n@ Purpose: transfer a block of data from memory to the acorn scsi card\n@ Proto  : void acornscsi_in(unsigned int addr_start, char *buffer, int length)\n@ Returns: nothing\n\nENTRY(__acornscsi_out)\n\t\tstmfd\tsp!, {r4 - r6, lr}\n\t\tbic\tr0, r0, #3\nacornscsi_out16lp:\n\t\tsubs\tr2, r2, #16\n\t\tbmi\tacornscsi_out8\n\t\tldmia\tr1!, {r4, r6, ip, lr}\n\t\tmov\tr3, r4, lsl #16\n\t\torr\tr3, r3, r3, lsr #16\n\t\tmov\tr4, r4, lsr #16\n\t\torr\tr4, r4, r4, lsl #16\n\t\tmov\tr5, r6, lsl #16\n\t\torr\tr5, r5, r5, lsr #16\n\t\tmov\tr6, r6, lsr #16\n\t\torr\tr6, r6, r6, lsl #16\n\t\tstmia\tr0!, {r3, r4, r5, r6}\n\t\tmov\tr3, ip, lsl #16\n\t\torr\tr3, r3, r3, lsr #16\n\t\tmov\tr4, ip, lsr #16\n\t\torr\tr4, r4, r4, lsl #16\n\t\tmov\tip, lr, lsl #16\n\t\torr\tip, ip, ip, lsr #16\n\t\tmov\tlr, lr, lsr #16\n\t\torr\tlr, lr, lr, lsl #16\n\t\tstmia\tr0!, {r3, r4, ip, lr}\n\t\tbne\tacornscsi_out16lp\n\t\tLOADREGS(fd, sp!, {r4 - r6, pc})\n\nacornscsi_out8:\tadds\tr2, r2, #8\n\t\tbmi\tacornscsi_out4\n\t\tldmia\tr1!, {r4, r6}\n\t\tmov\tr3, r4, lsl #16\n\t\torr\tr3, r3, r3, lsr #16\n\t\tmov\tr4, r4, lsr #16\n\t\torr\tr4, r4, r4, lsl #16\n\t\tmov\tr5, r6, lsl #16\n\t\torr\tr5, r5, r5, lsr #16\n\t\tmov\tr6, r6, lsr #16\n\t\torr\tr6, r6, r6, lsl #16\n\t\tstmia\tr0!, {r3, r4, r5, r6}\n\t\tLOADREGS(eqfd, sp!, {r4 - r6, pc})\n\n\t\tsub\tr2, r2, #8\nacornscsi_out4:\tadds\tr2, r2, #4\n\t\tbmi\tacornscsi_out2\n\t\tldr\tr4, [r1], #4\n\t\tmov\tr3, r4, lsl #16\n\t\torr\tr3, r3, r3, lsr #16\n\t\tmov\tr4, r4, lsr #16\n\t\torr\tr4, r4, r4, lsl #16\n\t\tstmia\tr0!, {r3, r4}\n\t\tLOADREGS(eqfd, sp!, {r4 - r6, pc})\n\n\t\tsub\tr2, r2, #4\nacornscsi_out2:\tadds\tr2, r2, #2\n\t\tldr\tr3, [r1], #2\n\t\tstrb\tr3, [r0], #1\n\t\tmov\tr3, r3, lsr #8\n\t\tstrplb\tr3, [r0], #1\n\t\tLOADREGS(fd, sp!, {r4 - r6, pc})\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}