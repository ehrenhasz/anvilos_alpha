{
  "module_name": "fas216.h",
  "hash_id": "08615ae45c353aadb09365ab36bc2f39187179f14b2d85f12f41e2725d40273b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/arm/fas216.h",
  "human_readable_source": " \n \n#ifndef FAS216_H\n#define FAS216_H\n\n#include <scsi/scsi_eh.h>\n\n#include \"queue.h\"\n#include \"msgqueue.h\"\n\n \n\n \n#define REG_CTCL\t\t(0)\n#define REG_STCL\t\t(0)\n\n \n#define REG_CTCM\t\t(1)\n#define REG_STCM\t\t(1)\n\n \n#define REG_FF\t\t\t(2)\n\n \n#define REG_CMD\t\t\t(3)\n#define CMD_NOP\t\t\t0x00\n#define CMD_FLUSHFIFO\t\t0x01\n#define CMD_RESETCHIP\t\t0x02\n#define CMD_RESETSCSI\t\t0x03\n\n#define CMD_TRANSFERINFO\t0x10\n#define CMD_INITCMDCOMPLETE\t0x11\n#define CMD_MSGACCEPTED\t\t0x12\n#define CMD_PADBYTES\t\t0x18\n#define CMD_SETATN\t\t0x1a\n#define CMD_RSETATN\t\t0x1b\n\n#define CMD_SELECTWOATN\t\t0x41\n#define CMD_SELECTATN\t\t0x42\n#define CMD_SELECTATNSTOP\t0x43\n#define CMD_ENABLESEL\t\t0x44\n#define CMD_DISABLESEL\t\t0x45\n#define CMD_SELECTATN3\t\t0x46\n#define CMD_RESEL3\t\t0x47\n\n#define CMD_WITHDMA\t\t0x80\n\n \n#define REG_STAT\t\t(4)\n#define STAT_IO\t\t\t(1 << 0)\t\t\t \n#define STAT_CD\t\t\t(1 << 1)\t\t\t \n#define STAT_MSG\t\t(1 << 2)\t\t\t \n#define STAT_TRANSFERDONE\t(1 << 3)\t\t\t \n#define STAT_TRANSFERCNTZ\t(1 << 4)\t\t\t \n#define STAT_PARITYERROR\t(1 << 5)\t\t\t \n#define STAT_REALBAD\t\t(1 << 6)\t\t\t \n#define STAT_INT\t\t(1 << 7)\t\t\t \n\n#define STAT_BUSMASK\t\t(STAT_MSG|STAT_CD|STAT_IO)\n#define STAT_DATAOUT\t\t(0)\t\t\t\t \n#define STAT_DATAIN\t\t(STAT_IO)\t\t\t \n#define STAT_COMMAND\t\t(STAT_CD)\t\t\t \n#define STAT_STATUS\t\t(STAT_CD|STAT_IO)\t\t \n#define STAT_MESGOUT\t\t(STAT_MSG|STAT_CD)\t\t \n#define STAT_MESGIN\t\t(STAT_MSG|STAT_CD|STAT_IO)\t \n\n \n#define REG_SDID\t\t(4)\n#define BUSID(target)\t\t((target) & 7)\n\n \n#define REG_INST\t\t(5)\n#define INST_SELWOATN\t\t(1 << 0)\t\t\t \n#define INST_SELATN\t\t(1 << 1)\t\t\t \n#define INST_RESELECTED\t\t(1 << 2)\t\t\t \n#define INST_FUNCDONE\t\t(1 << 3)\t\t\t \n#define INST_BUSSERVICE\t\t(1 << 4)\t\t\t \n#define INST_DISCONNECT\t\t(1 << 5)\t\t\t \n#define INST_ILLEGALCMD\t\t(1 << 6)\t\t\t \n#define INST_BUSRESET\t\t(1 << 7)\t\t\t \n\n \n#define REG_STIM\t\t(5)\n\n \n#define REG_IS\t\t\t(6)\n#define IS_BITS\t\t\t0x07\n#define IS_SELARB\t\t0x00\t\t\t\t \n#define IS_MSGBYTESENT\t\t0x01\t\t\t\t \n#define IS_NOTCOMMAND\t\t0x02\t\t\t\t \n#define IS_EARLYPHASE\t\t0x03\t\t\t\t \n#define IS_COMPLETE\t\t0x04\t\t\t\t \n#define IS_SOF\t\t\t0x08\t\t\t\t \n\n \n#define REG_STP\t\t\t(6)\n\n \n#define REG_SOF\t\t\t(7)\n\n \n#define REG_CFIS\t\t(7)\n#define CFIS_CF\t\t\t0x1f\t\t\t\t \n#define CFIS_IS\t\t\t0xe0\t\t\t\t \n\n \n#define REG_CNTL1\t\t(8)\n#define CNTL1_CID\t\t(7 << 0)\t\t\t \n#define CNTL1_STE\t\t(1 << 3)\t\t\t \n#define CNTL1_PERE\t\t(1 << 4)\t\t\t \n#define CNTL1_PTE\t\t(1 << 5)\t\t\t \n#define CNTL1_DISR\t\t(1 << 6)\t\t\t \n#define CNTL1_ETM\t\t(1 << 7)\t\t\t \n\n \n#define REG_CLKF\t\t(9)\n#define CLKF_F37MHZ\t\t0x00\t\t\t\t \n#define CLKF_F10MHZ\t\t0x02\t\t\t\t \n#define CLKF_F12MHZ\t\t0x03\t\t\t\t \n#define CLKF_F17MHZ\t\t0x04\t\t\t\t \n#define CLKF_F22MHZ\t\t0x05\t\t\t\t \n#define CLKF_F27MHZ\t\t0x06\t\t\t\t \n#define CLKF_F32MHZ\t\t0x07\t\t\t\t \n\n \n#define REG_FTM\t\t\t(10)\n#define TEST_FTM\t\t0x01\t\t\t\t \n#define TEST_FIM\t\t0x02\t\t\t\t \n#define TEST_FHI\t\t0x04\t\t\t\t \n\n \n#define REG_CNTL2\t\t(11)\n#define CNTL2_PGDP\t\t(1 << 0)\t\t\t \n#define CNTL2_PGRP\t\t(1 << 1)\t\t\t \n#define CNTL2_ACDPE\t\t(1 << 2)\t\t\t \n#define CNTL2_S2FE\t\t(1 << 3)\t\t\t \n#define CNTL2_TSDR\t\t(1 << 4)\t\t\t \n#define CNTL2_SBO\t\t(1 << 5)\t\t\t \n#define CNTL2_ENF\t\t(1 << 6)\t\t\t \n#define CNTL2_DAE\t\t(1 << 7)\t\t\t \n\n \n#define REG_CNTL3\t\t(12)\n#define CNTL3_BS8\t\t(1 << 0)\t\t\t \n#define CNTL3_MDM\t\t(1 << 1)\t\t\t \n#define CNTL3_LBTM\t\t(1 << 2)\t\t\t \n#define CNTL3_FASTCLK\t\t(1 << 3)\t\t\t \n#define CNTL3_FASTSCSI\t\t(1 << 4)\t\t\t \n#define CNTL3_G2CB\t\t(1 << 5)\t\t\t \n#define CNTL3_QTAG\t\t(1 << 6)\t\t\t \n#define CNTL3_ADIDCHK\t\t(1 << 7)\t\t\t \n\n \n#define REG_CTCH\t\t(14)\n#define REG_STCH\t\t(14)\n\n \n#define REG_ID\t\t\t(14)\n\n \n#define REG_DAL\t\t\t(15)\n\ntypedef enum {\n\tPHASE_IDLE,\t\t\t\t\t \n\tPHASE_SELECTION,\t\t\t\t \n\tPHASE_SELSTEPS,\t\t\t\t\t \n\tPHASE_COMMAND,\t\t\t\t\t \n\tPHASE_MESSAGESENT,\t\t\t\t \n\tPHASE_DATAOUT,\t\t\t\t\t \n\tPHASE_DATAIN,\t\t\t\t\t \n\tPHASE_MSGIN,\t\t\t\t\t \n\tPHASE_MSGIN_DISCONNECT,\t\t\t\t \n\tPHASE_MSGOUT,\t\t\t\t\t \n\tPHASE_MSGOUT_EXPECT,\t\t\t\t \n\tPHASE_STATUS,\t\t\t\t\t \n\tPHASE_DONE\t\t\t\t\t \n} phase_t;\n\ntypedef enum {\n\tDMA_OUT,\t\t\t\t\t \n\tDMA_IN\t\t\t\t\t\t \n} fasdmadir_t;\n\ntypedef enum {\n\tfasdma_none,\t\t\t\t\t \n\tfasdma_pio,\t\t\t\t\t \n\tfasdma_pseudo,\t\t\t\t\t \n\tfasdma_real_block,\t\t\t\t \n\tfasdma_real_all\t\t\t\t\t \n} fasdmatype_t;\n\ntypedef enum {\n\tneg_wait,\t\t\t\t\t \n\tneg_inprogress,\t\t\t\t\t \n\tneg_complete,\t\t\t\t\t \n\tneg_targcomplete,\t\t\t\t \n\tneg_invalid\t\t\t\t\t \n} neg_t;\n\n#define MAGIC\t0x441296bdUL\n#define NR_MSGS\t8\n\n#define FASCAP_DMA\t\t(1 << 0)\n#define FASCAP_PSEUDODMA\t(1 << 1)\n\ntypedef struct {\n\tunsigned long\t\tmagic_start;\n\tspinlock_t\t\thost_lock;\n\tstruct Scsi_Host\t*host;\t\t\t \n\tstruct scsi_cmnd\t*SCpnt;\t\t\t \n\tstruct scsi_cmnd\t*origSCpnt;\t\t \n\tstruct scsi_cmnd\t*reqSCpnt;\t\t \n\tstruct scsi_cmnd\t*rstSCpnt;\t\t \n\tstruct scsi_cmnd\t*pending_SCpnt[8];\t \n\tint\t\t\tnext_pending;\t\t \n\n\t \n\twait_queue_head_t\teh_wait;\n\tstruct timer_list\teh_timer;\n\tunsigned int\t\trst_dev_status;\n\tunsigned int\t\trst_bus_status;\n\n\t \n\tstruct {\n\t\tphase_t\t\tphase;\t\t\t \n\t\tvoid __iomem\t*io_base;\t\t \n\t\tunsigned int\tio_shift;\t\t \n\t\tunsigned char\tcfg[4];\t\t\t \n\t\tconst char\t*type;\t\t\t \n\t\tunsigned int\tirq;\t\t\t \n\t\tint\t\tdma;\t\t\t \n\n\t\tstruct scsi_pointer\tSCp;\t\t\t \n\n\t\tMsgQueue_t\tmsgs;\t\t\t \n\n\t\tunsigned int\tasync_stp;\t\t \n\t\tunsigned char\tmsgin_fifo;\t\t \n\t\tunsigned char\tmessage[256];\t\t \n\n\t\tunsigned char\tdisconnectable:1;\t \n\t\tunsigned char\taborting:1;\t\t \n\t} scsi;\n\n\t \n\tstruct {\n\t\tunsigned int\tqueues;\n\t\tunsigned int\tremoves;\n\t\tunsigned int\tfins;\n\t\tunsigned int\treads;\n\t\tunsigned int\twrites;\n\t\tunsigned int\tmiscs;\n\t\tunsigned int\tdisconnects;\n\t\tunsigned int\taborts;\n\t\tunsigned int\tbus_resets;\n\t\tunsigned int\thost_resets;\n\t} stats;\n\n\t \n\tstruct {\n\t\tunsigned char\tclockrate;\t\t \n\t\tunsigned char\tselect_timeout;\t\t \n\t\tunsigned char\tsync_max_depth;\t\t \n\t\tunsigned char\twide_max_size;\t\t \n\t\tunsigned char\tcntl3;\t\t\t \n\t\tunsigned int\tasyncperiod;\t\t \n\t\tunsigned int\tcapabilities;\t\t \n\t\tunsigned int\tdisconnect_ok:1;\t \n\t} ifcfg;\n\n\t \n\tstruct {\n\t    \tQueue_t\t\tissue;\t\t\t \n    \t\tQueue_t\t\tdisconnected;\t\t \n\t} queues;\n\n\t \n\tstruct fas216_device {\n\t\tunsigned char\tdisconnect_ok:1;\t \n\t\tunsigned char\tparity_enabled:1;\t \n\t\tunsigned char\tparity_check:1;\t\t \n\t\tunsigned char\tperiod;\t\t\t \n\t\tunsigned char\tstp;\t\t\t \n\t\tunsigned char\tsof;\t\t\t \n\t\tunsigned char\twide_xfer;\t\t \n\t\tneg_t\t\tsync_state;\t\t \n\t\tneg_t\t\twide_state;\t\t \n\t} device[8];\n\tunsigned long\tbusyluns[64/sizeof(unsigned long)]; \n\n\t \n\tstruct {\n\t\tfasdmatype_t\ttransfer_type;\t\t \n\t\tfasdmatype_t\t(*setup) (struct Scsi_Host *host, struct scsi_pointer *SCp, fasdmadir_t direction, fasdmatype_t min_dma);\n\t\tvoid\t\t(*pseudo)(struct Scsi_Host *host, struct scsi_pointer *SCp, fasdmadir_t direction, int transfer);\n\t\tvoid\t\t(*stop)  (struct Scsi_Host *host, struct scsi_pointer *SCp);\n\t} dma;\n\n\t \n\tint\t\t\tinternal_done;\t\t \n\tstruct scsi_eh_save\tses;\t\t \n\tunsigned long\t\tmagic_end;\n} FAS216_Info;\n\n \nstruct fas216_cmd_priv {\n\t \n\tstruct scsi_pointer scsi_pointer;\n\tvoid (*scsi_done)(struct scsi_cmnd *cmd);\n};\n\nstatic inline struct fas216_cmd_priv *fas216_cmd_priv(struct scsi_cmnd *cmd)\n{\n\treturn scsi_cmd_priv(cmd);\n}\n\n \nextern int fas216_init (struct Scsi_Host *instance);\n\n \nextern int fas216_add (struct Scsi_Host *instance, struct device *dev);\n\n \nextern int fas216_queue_command(struct Scsi_Host *h, struct scsi_cmnd *SCpnt);\n\n \nextern int fas216_noqueue_command(struct Scsi_Host *, struct scsi_cmnd *);\n\n \nextern irqreturn_t fas216_intr (FAS216_Info *info);\n\nextern void fas216_remove (struct Scsi_Host *instance);\n\n \nextern void fas216_release (struct Scsi_Host *instance);\n\nextern void fas216_print_host(FAS216_Info *info, struct seq_file *m);\nextern void fas216_print_stats(FAS216_Info *info, struct seq_file *m);\nextern void fas216_print_devices(FAS216_Info *info, struct seq_file *m);\n\n \nextern int fas216_eh_abort(struct scsi_cmnd *SCpnt);\n\n \nextern int fas216_eh_device_reset(struct scsi_cmnd *SCpnt);\n\n \nextern int fas216_eh_bus_reset(struct scsi_cmnd *SCpnt);\n\n \nextern int fas216_eh_host_reset(struct scsi_cmnd *SCpnt);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}