{
  "module_name": "megaraid_sas.h",
  "hash_id": "9a355fcdfdabfecb4a2b766f52dfe270c8f3048d7ee16d696412b1d677fd5371",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/megaraid/megaraid_sas.h",
  "human_readable_source": " \n \n\n#ifndef LSI_MEGARAID_SAS_H\n#define LSI_MEGARAID_SAS_H\n\n#include <scsi/scsi_cmnd.h>\n\n \n#define MEGASAS_VERSION\t\t\t\t\"07.725.01.00-rc1\"\n#define MEGASAS_RELDATE\t\t\t\t\"Mar 2, 2023\"\n\n#define MEGASAS_MSIX_NAME_LEN\t\t\t32\n\n \n#define\tPCI_DEVICE_ID_LSI_SAS1078R\t\t0x0060\n#define\tPCI_DEVICE_ID_LSI_SAS1078DE\t\t0x007C\n#define\tPCI_DEVICE_ID_LSI_VERDE_ZCR\t\t0x0413\n#define\tPCI_DEVICE_ID_LSI_SAS1078GEN2\t\t0x0078\n#define\tPCI_DEVICE_ID_LSI_SAS0079GEN2\t\t0x0079\n#define\tPCI_DEVICE_ID_LSI_SAS0073SKINNY\t\t0x0073\n#define\tPCI_DEVICE_ID_LSI_SAS0071SKINNY\t\t0x0071\n#define\tPCI_DEVICE_ID_LSI_FUSION\t\t0x005b\n#define PCI_DEVICE_ID_LSI_PLASMA\t\t0x002f\n#define PCI_DEVICE_ID_LSI_INVADER\t\t0x005d\n#define PCI_DEVICE_ID_LSI_FURY\t\t\t0x005f\n#define PCI_DEVICE_ID_LSI_INTRUDER\t\t0x00ce\n#define PCI_DEVICE_ID_LSI_INTRUDER_24\t\t0x00cf\n#define PCI_DEVICE_ID_LSI_CUTLASS_52\t\t0x0052\n#define PCI_DEVICE_ID_LSI_CUTLASS_53\t\t0x0053\n#define PCI_DEVICE_ID_LSI_VENTURA\t\t    0x0014\n#define PCI_DEVICE_ID_LSI_CRUSADER\t\t    0x0015\n#define PCI_DEVICE_ID_LSI_HARPOON\t\t    0x0016\n#define PCI_DEVICE_ID_LSI_TOMCAT\t\t    0x0017\n#define PCI_DEVICE_ID_LSI_VENTURA_4PORT\t\t0x001B\n#define PCI_DEVICE_ID_LSI_CRUSADER_4PORT\t0x001C\n#define PCI_DEVICE_ID_LSI_AERO_10E1\t\t0x10e1\n#define PCI_DEVICE_ID_LSI_AERO_10E2\t\t0x10e2\n#define PCI_DEVICE_ID_LSI_AERO_10E5\t\t0x10e5\n#define PCI_DEVICE_ID_LSI_AERO_10E6\t\t0x10e6\n#define PCI_DEVICE_ID_LSI_AERO_10E0\t\t0x10e0\n#define PCI_DEVICE_ID_LSI_AERO_10E3\t\t0x10e3\n#define PCI_DEVICE_ID_LSI_AERO_10E4\t\t0x10e4\n#define PCI_DEVICE_ID_LSI_AERO_10E7\t\t0x10e7\n\n \n#define MEGARAID_INTEL_RS3DC080_SSDID\t\t0x9360\n#define MEGARAID_INTEL_RS3DC040_SSDID\t\t0x9362\n#define MEGARAID_INTEL_RS3SC008_SSDID\t\t0x9380\n#define MEGARAID_INTEL_RS3MC044_SSDID\t\t0x9381\n#define MEGARAID_INTEL_RS3WC080_SSDID\t\t0x9341\n#define MEGARAID_INTEL_RS3WC040_SSDID\t\t0x9343\n#define MEGARAID_INTEL_RMS3BC160_SSDID\t\t0x352B\n\n \n#define MEGARAID_INTRUDER_SSDID1\t\t0x9371\n#define MEGARAID_INTRUDER_SSDID2\t\t0x9390\n#define MEGARAID_INTRUDER_SSDID3\t\t0x9370\n\n \n#define MEGARAID_INTEL_RS3DC080_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3DC080\"\n#define MEGARAID_INTEL_RS3DC040_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3DC040\"\n#define MEGARAID_INTEL_RS3SC008_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3SC008\"\n#define MEGARAID_INTEL_RS3MC044_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3MC044\"\n#define MEGARAID_INTEL_RS3WC080_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3WC080\"\n#define MEGARAID_INTEL_RS3WC040_BRANDING\t\\\n\t\"Intel(R) RAID Controller RS3WC040\"\n#define MEGARAID_INTEL_RMS3BC160_BRANDING\t\\\n\t\"Intel(R) Integrated RAID Module RMS3BC160\"\n\n \n\n \n\n \n#define MFI_STATE_MASK\t\t\t\t0xF0000000\n#define MFI_STATE_UNDEFINED\t\t\t0x00000000\n#define MFI_STATE_BB_INIT\t\t\t0x10000000\n#define MFI_STATE_FW_INIT\t\t\t0x40000000\n#define MFI_STATE_WAIT_HANDSHAKE\t\t0x60000000\n#define MFI_STATE_FW_INIT_2\t\t\t0x70000000\n#define MFI_STATE_DEVICE_SCAN\t\t\t0x80000000\n#define MFI_STATE_BOOT_MESSAGE_PENDING\t\t0x90000000\n#define MFI_STATE_FLUSH_CACHE\t\t\t0xA0000000\n#define MFI_STATE_READY\t\t\t\t0xB0000000\n#define MFI_STATE_OPERATIONAL\t\t\t0xC0000000\n#define MFI_STATE_FAULT\t\t\t\t0xF0000000\n#define MFI_STATE_FORCE_OCR\t\t\t0x00000080\n#define MFI_STATE_DMADONE\t\t\t0x00000008\n#define MFI_STATE_CRASH_DUMP_DONE\t\t0x00000004\n#define MFI_RESET_REQUIRED\t\t\t0x00000001\n#define MFI_RESET_ADAPTER\t\t\t0x00000002\n#define MEGAMFI_FRAME_SIZE\t\t\t64\n\n#define MFI_STATE_FAULT_CODE\t\t\t0x0FFF0000\n#define MFI_STATE_FAULT_SUBCODE\t\t\t0x0000FF00\n \n#define WRITE_SEQUENCE_OFFSET\t\t(0x0000000FC)  \n#define HOST_DIAGNOSTIC_OFFSET\t\t(0x000000F8)   \n#define DIAG_WRITE_ENABLE\t\t\t(0x00000080)\n#define DIAG_RESET_ADAPTER\t\t\t(0x00000004)\n\n#define MFI_ADP_RESET\t\t\t\t0x00000040\n#define MFI_INIT_ABORT\t\t\t\t0x00000001\n#define MFI_INIT_READY\t\t\t\t0x00000002\n#define MFI_INIT_MFIMODE\t\t\t0x00000004\n#define MFI_INIT_CLEAR_HANDSHAKE\t\t0x00000008\n#define MFI_INIT_HOTPLUG\t\t\t0x00000010\n#define MFI_STOP_ADP\t\t\t\t0x00000020\n#define MFI_RESET_FLAGS\t\t\t\tMFI_INIT_READY| \\\n\t\t\t\t\t\tMFI_INIT_MFIMODE| \\\n\t\t\t\t\t\tMFI_INIT_ABORT\n#define MFI_ADP_TRIGGER_SNAP_DUMP\t\t0x00000100\n#define MPI2_IOCINIT_MSGFLAG_RDPQ_ARRAY_MODE    (0x01)\n\n \n#define MFI_FRAME_POST_IN_REPLY_QUEUE\t\t0x0000\n#define MFI_FRAME_DONT_POST_IN_REPLY_QUEUE\t0x0001\n#define MFI_FRAME_SGL32\t\t\t\t0x0000\n#define MFI_FRAME_SGL64\t\t\t\t0x0002\n#define MFI_FRAME_SENSE32\t\t\t0x0000\n#define MFI_FRAME_SENSE64\t\t\t0x0004\n#define MFI_FRAME_DIR_NONE\t\t\t0x0000\n#define MFI_FRAME_DIR_WRITE\t\t\t0x0008\n#define MFI_FRAME_DIR_READ\t\t\t0x0010\n#define MFI_FRAME_DIR_BOTH\t\t\t0x0018\n#define MFI_FRAME_IEEE                          0x0020\n\n \n#define DRV_DCMD_POLLED_MODE\t\t0x1\n#define DRV_DCMD_SKIP_REFIRE\t\t0x2\n\n \n#define MFI_CMD_STATUS_POLL_MODE\t\t0xFF\n\n \nenum MFI_CMD_OP {\n\tMFI_CMD_INIT\t\t= 0x0,\n\tMFI_CMD_LD_READ\t\t= 0x1,\n\tMFI_CMD_LD_WRITE\t= 0x2,\n\tMFI_CMD_LD_SCSI_IO\t= 0x3,\n\tMFI_CMD_PD_SCSI_IO\t= 0x4,\n\tMFI_CMD_DCMD\t\t= 0x5,\n\tMFI_CMD_ABORT\t\t= 0x6,\n\tMFI_CMD_SMP\t\t= 0x7,\n\tMFI_CMD_STP\t\t= 0x8,\n\tMFI_CMD_NVME\t\t= 0x9,\n\tMFI_CMD_TOOLBOX\t\t= 0xa,\n\tMFI_CMD_OP_COUNT,\n\tMFI_CMD_INVALID\t\t= 0xff\n};\n\n#define MR_DCMD_CTRL_GET_INFO\t\t\t0x01010000\n#define MR_DCMD_LD_GET_LIST\t\t\t0x03010000\n#define MR_DCMD_LD_LIST_QUERY\t\t\t0x03010100\n\n#define MR_DCMD_CTRL_CACHE_FLUSH\t\t0x01101000\n#define MR_FLUSH_CTRL_CACHE\t\t\t0x01\n#define MR_FLUSH_DISK_CACHE\t\t\t0x02\n\n#define MR_DCMD_CTRL_SHUTDOWN\t\t\t0x01050000\n#define MR_DCMD_HIBERNATE_SHUTDOWN\t\t0x01060000\n#define MR_ENABLE_DRIVE_SPINDOWN\t\t0x01\n\n#define MR_DCMD_CTRL_EVENT_GET_INFO\t\t0x01040100\n#define MR_DCMD_CTRL_EVENT_GET\t\t\t0x01040300\n#define MR_DCMD_CTRL_EVENT_WAIT\t\t\t0x01040500\n#define MR_DCMD_LD_GET_PROPERTIES\t\t0x03030000\n\n#define MR_DCMD_CLUSTER\t\t\t\t0x08000000\n#define MR_DCMD_CLUSTER_RESET_ALL\t\t0x08010100\n#define MR_DCMD_CLUSTER_RESET_LD\t\t0x08010200\n#define MR_DCMD_PD_LIST_QUERY                   0x02010100\n\n#define MR_DCMD_CTRL_SET_CRASH_DUMP_PARAMS\t0x01190100\n#define MR_DRIVER_SET_APP_CRASHDUMP_MODE\t(0xF0010000 | 0x0600)\n#define MR_DCMD_PD_GET_INFO\t\t\t0x02020000\n\n \nextern u8 MR_ValidateMapInfo(struct megasas_instance *instance, u64 map_id);\n\n\n \nenum MFI_STAT {\n\tMFI_STAT_OK = 0x00,\n\tMFI_STAT_INVALID_CMD = 0x01,\n\tMFI_STAT_INVALID_DCMD = 0x02,\n\tMFI_STAT_INVALID_PARAMETER = 0x03,\n\tMFI_STAT_INVALID_SEQUENCE_NUMBER = 0x04,\n\tMFI_STAT_ABORT_NOT_POSSIBLE = 0x05,\n\tMFI_STAT_APP_HOST_CODE_NOT_FOUND = 0x06,\n\tMFI_STAT_APP_IN_USE = 0x07,\n\tMFI_STAT_APP_NOT_INITIALIZED = 0x08,\n\tMFI_STAT_ARRAY_INDEX_INVALID = 0x09,\n\tMFI_STAT_ARRAY_ROW_NOT_EMPTY = 0x0a,\n\tMFI_STAT_CONFIG_RESOURCE_CONFLICT = 0x0b,\n\tMFI_STAT_DEVICE_NOT_FOUND = 0x0c,\n\tMFI_STAT_DRIVE_TOO_SMALL = 0x0d,\n\tMFI_STAT_FLASH_ALLOC_FAIL = 0x0e,\n\tMFI_STAT_FLASH_BUSY = 0x0f,\n\tMFI_STAT_FLASH_ERROR = 0x10,\n\tMFI_STAT_FLASH_IMAGE_BAD = 0x11,\n\tMFI_STAT_FLASH_IMAGE_INCOMPLETE = 0x12,\n\tMFI_STAT_FLASH_NOT_OPEN = 0x13,\n\tMFI_STAT_FLASH_NOT_STARTED = 0x14,\n\tMFI_STAT_FLUSH_FAILED = 0x15,\n\tMFI_STAT_HOST_CODE_NOT_FOUNT = 0x16,\n\tMFI_STAT_LD_CC_IN_PROGRESS = 0x17,\n\tMFI_STAT_LD_INIT_IN_PROGRESS = 0x18,\n\tMFI_STAT_LD_LBA_OUT_OF_RANGE = 0x19,\n\tMFI_STAT_LD_MAX_CONFIGURED = 0x1a,\n\tMFI_STAT_LD_NOT_OPTIMAL = 0x1b,\n\tMFI_STAT_LD_RBLD_IN_PROGRESS = 0x1c,\n\tMFI_STAT_LD_RECON_IN_PROGRESS = 0x1d,\n\tMFI_STAT_LD_WRONG_RAID_LEVEL = 0x1e,\n\tMFI_STAT_MAX_SPARES_EXCEEDED = 0x1f,\n\tMFI_STAT_MEMORY_NOT_AVAILABLE = 0x20,\n\tMFI_STAT_MFC_HW_ERROR = 0x21,\n\tMFI_STAT_NO_HW_PRESENT = 0x22,\n\tMFI_STAT_NOT_FOUND = 0x23,\n\tMFI_STAT_NOT_IN_ENCL = 0x24,\n\tMFI_STAT_PD_CLEAR_IN_PROGRESS = 0x25,\n\tMFI_STAT_PD_TYPE_WRONG = 0x26,\n\tMFI_STAT_PR_DISABLED = 0x27,\n\tMFI_STAT_ROW_INDEX_INVALID = 0x28,\n\tMFI_STAT_SAS_CONFIG_INVALID_ACTION = 0x29,\n\tMFI_STAT_SAS_CONFIG_INVALID_DATA = 0x2a,\n\tMFI_STAT_SAS_CONFIG_INVALID_PAGE = 0x2b,\n\tMFI_STAT_SAS_CONFIG_INVALID_TYPE = 0x2c,\n\tMFI_STAT_SCSI_DONE_WITH_ERROR = 0x2d,\n\tMFI_STAT_SCSI_IO_FAILED = 0x2e,\n\tMFI_STAT_SCSI_RESERVATION_CONFLICT = 0x2f,\n\tMFI_STAT_SHUTDOWN_FAILED = 0x30,\n\tMFI_STAT_TIME_NOT_SET = 0x31,\n\tMFI_STAT_WRONG_STATE = 0x32,\n\tMFI_STAT_LD_OFFLINE = 0x33,\n\tMFI_STAT_PEER_NOTIFICATION_REJECTED = 0x34,\n\tMFI_STAT_PEER_NOTIFICATION_FAILED = 0x35,\n\tMFI_STAT_RESERVATION_IN_PROGRESS = 0x36,\n\tMFI_STAT_I2C_ERRORS_DETECTED = 0x37,\n\tMFI_STAT_PCI_ERRORS_DETECTED = 0x38,\n\tMFI_STAT_CONFIG_SEQ_MISMATCH = 0x67,\n\n\tMFI_STAT_INVALID_STATUS = 0xFF\n};\n\nenum mfi_evt_class {\n\tMFI_EVT_CLASS_DEBUG =\t\t-2,\n\tMFI_EVT_CLASS_PROGRESS =\t-1,\n\tMFI_EVT_CLASS_INFO =\t\t0,\n\tMFI_EVT_CLASS_WARNING =\t\t1,\n\tMFI_EVT_CLASS_CRITICAL =\t2,\n\tMFI_EVT_CLASS_FATAL =\t\t3,\n\tMFI_EVT_CLASS_DEAD =\t\t4\n};\n\n \n#define MAX_CRASH_DUMP_SIZE 512\n#define CRASH_DMA_BUF_SIZE  (1024 * 1024)\n\nenum MR_FW_CRASH_DUMP_STATE {\n\tUNAVAILABLE = 0,\n\tAVAILABLE = 1,\n\tCOPYING = 2,\n\tCOPIED = 3,\n\tCOPY_ERROR = 4,\n};\n\nenum _MR_CRASH_BUF_STATUS {\n\tMR_CRASH_BUF_TURN_OFF = 0,\n\tMR_CRASH_BUF_TURN_ON = 1,\n};\n\n \n#define MFI_MBOX_SIZE\t\t\t\t12\n\nenum MR_EVT_CLASS {\n\n\tMR_EVT_CLASS_DEBUG = -2,\n\tMR_EVT_CLASS_PROGRESS = -1,\n\tMR_EVT_CLASS_INFO = 0,\n\tMR_EVT_CLASS_WARNING = 1,\n\tMR_EVT_CLASS_CRITICAL = 2,\n\tMR_EVT_CLASS_FATAL = 3,\n\tMR_EVT_CLASS_DEAD = 4,\n\n};\n\nenum MR_EVT_LOCALE {\n\n\tMR_EVT_LOCALE_LD = 0x0001,\n\tMR_EVT_LOCALE_PD = 0x0002,\n\tMR_EVT_LOCALE_ENCL = 0x0004,\n\tMR_EVT_LOCALE_BBU = 0x0008,\n\tMR_EVT_LOCALE_SAS = 0x0010,\n\tMR_EVT_LOCALE_CTRL = 0x0020,\n\tMR_EVT_LOCALE_CONFIG = 0x0040,\n\tMR_EVT_LOCALE_CLUSTER = 0x0080,\n\tMR_EVT_LOCALE_ALL = 0xffff,\n\n};\n\nenum MR_EVT_ARGS {\n\n\tMR_EVT_ARGS_NONE,\n\tMR_EVT_ARGS_CDB_SENSE,\n\tMR_EVT_ARGS_LD,\n\tMR_EVT_ARGS_LD_COUNT,\n\tMR_EVT_ARGS_LD_LBA,\n\tMR_EVT_ARGS_LD_OWNER,\n\tMR_EVT_ARGS_LD_LBA_PD_LBA,\n\tMR_EVT_ARGS_LD_PROG,\n\tMR_EVT_ARGS_LD_STATE,\n\tMR_EVT_ARGS_LD_STRIP,\n\tMR_EVT_ARGS_PD,\n\tMR_EVT_ARGS_PD_ERR,\n\tMR_EVT_ARGS_PD_LBA,\n\tMR_EVT_ARGS_PD_LBA_LD,\n\tMR_EVT_ARGS_PD_PROG,\n\tMR_EVT_ARGS_PD_STATE,\n\tMR_EVT_ARGS_PCI,\n\tMR_EVT_ARGS_RATE,\n\tMR_EVT_ARGS_STR,\n\tMR_EVT_ARGS_TIME,\n\tMR_EVT_ARGS_ECC,\n\tMR_EVT_ARGS_LD_PROP,\n\tMR_EVT_ARGS_PD_SPARE,\n\tMR_EVT_ARGS_PD_INDEX,\n\tMR_EVT_ARGS_DIAG_PASS,\n\tMR_EVT_ARGS_DIAG_FAIL,\n\tMR_EVT_ARGS_PD_LBA_LBA,\n\tMR_EVT_ARGS_PORT_PHY,\n\tMR_EVT_ARGS_PD_MISSING,\n\tMR_EVT_ARGS_PD_ADDRESS,\n\tMR_EVT_ARGS_BITMAP,\n\tMR_EVT_ARGS_CONNECTOR,\n\tMR_EVT_ARGS_PD_PD,\n\tMR_EVT_ARGS_PD_FRU,\n\tMR_EVT_ARGS_PD_PATHINFO,\n\tMR_EVT_ARGS_PD_POWER_STATE,\n\tMR_EVT_ARGS_GENERIC,\n};\n\n\n#define SGE_BUFFER_SIZE\t4096\n#define MEGASAS_CLUSTER_ID_SIZE\t16\n \nenum MR_PD_QUERY_TYPE {\n\tMR_PD_QUERY_TYPE_ALL                = 0,\n\tMR_PD_QUERY_TYPE_STATE              = 1,\n\tMR_PD_QUERY_TYPE_POWER_STATE        = 2,\n\tMR_PD_QUERY_TYPE_MEDIA_TYPE         = 3,\n\tMR_PD_QUERY_TYPE_SPEED              = 4,\n\tMR_PD_QUERY_TYPE_EXPOSED_TO_HOST    = 5,\n};\n\nenum MR_LD_QUERY_TYPE {\n\tMR_LD_QUERY_TYPE_ALL\t         = 0,\n\tMR_LD_QUERY_TYPE_EXPOSED_TO_HOST = 1,\n\tMR_LD_QUERY_TYPE_USED_TGT_IDS    = 2,\n\tMR_LD_QUERY_TYPE_CLUSTER_ACCESS  = 3,\n\tMR_LD_QUERY_TYPE_CLUSTER_LOCALE  = 4,\n};\n\n\n#define MR_EVT_CFG_CLEARED                              0x0004\n#define MR_EVT_LD_STATE_CHANGE                          0x0051\n#define MR_EVT_PD_INSERTED                              0x005b\n#define MR_EVT_PD_REMOVED                               0x0070\n#define MR_EVT_LD_CREATED                               0x008a\n#define MR_EVT_LD_DELETED                               0x008b\n#define MR_EVT_FOREIGN_CFG_IMPORTED                     0x00db\n#define MR_EVT_LD_OFFLINE                               0x00fc\n#define MR_EVT_CTRL_HOST_BUS_SCAN_REQUESTED             0x0152\n#define MR_EVT_CTRL_PROP_CHANGED\t\t\t0x012f\n\nenum MR_PD_STATE {\n\tMR_PD_STATE_UNCONFIGURED_GOOD   = 0x00,\n\tMR_PD_STATE_UNCONFIGURED_BAD    = 0x01,\n\tMR_PD_STATE_HOT_SPARE           = 0x02,\n\tMR_PD_STATE_OFFLINE             = 0x10,\n\tMR_PD_STATE_FAILED              = 0x11,\n\tMR_PD_STATE_REBUILD             = 0x14,\n\tMR_PD_STATE_ONLINE              = 0x18,\n\tMR_PD_STATE_COPYBACK            = 0x20,\n\tMR_PD_STATE_SYSTEM              = 0x40,\n };\n\nunion MR_PD_REF {\n\tstruct {\n\t\tu16\t deviceId;\n\t\tu16\t seqNum;\n\t} mrPdRef;\n\tu32\t ref;\n};\n\n \nunion MR_PD_DDF_TYPE {\n\t struct {\n\t\tunion {\n\t\t\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\t\t\t u16\t forcedPDGUID:1;\n\t\t\t\t u16\t inVD:1;\n\t\t\t\t u16\t isGlobalSpare:1;\n\t\t\t\t u16\t isSpare:1;\n\t\t\t\t u16\t isForeign:1;\n\t\t\t\t u16\t reserved:7;\n\t\t\t\t u16\t intf:4;\n#else\n\t\t\t\t u16\t intf:4;\n\t\t\t\t u16\t reserved:7;\n\t\t\t\t u16\t isForeign:1;\n\t\t\t\t u16\t isSpare:1;\n\t\t\t\t u16\t isGlobalSpare:1;\n\t\t\t\t u16\t inVD:1;\n\t\t\t\t u16\t forcedPDGUID:1;\n#endif\n\t\t\t } pdType;\n\t\t\t u16\t type;\n\t\t };\n\t\t u16\t reserved;\n\t } ddf;\n\t struct {\n\t\t u32\treserved;\n\t } nonDisk;\n\t u32\t type;\n} __packed;\n\n \nunion MR_PROGRESS {\n\tstruct  {\n\t\tu16 progress;\n\t\tunion {\n\t\t\tu16 elapsedSecs;\n\t\t\tu16 elapsedSecsForLastPercent;\n\t\t};\n\t} mrProgress;\n\tu32 w;\n} __packed;\n\n \nstruct MR_PD_PROGRESS {\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu32     rbld:1;\n\t\tu32     patrol:1;\n\t\tu32     clear:1;\n\t\tu32     copyBack:1;\n\t\tu32     erase:1;\n\t\tu32     locate:1;\n\t\tu32     reserved:26;\n#else\n\t\tu32     reserved:26;\n\t\tu32     locate:1;\n\t\tu32     erase:1;\n\t\tu32     copyBack:1;\n\t\tu32     clear:1;\n\t\tu32     patrol:1;\n\t\tu32     rbld:1;\n#endif\n\t} active;\n\tunion MR_PROGRESS     rbld;\n\tunion MR_PROGRESS     patrol;\n\tunion {\n\t\tunion MR_PROGRESS     clear;\n\t\tunion MR_PROGRESS     erase;\n\t};\n\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu32     rbld:1;\n\t\tu32     patrol:1;\n\t\tu32     clear:1;\n\t\tu32     copyBack:1;\n\t\tu32     erase:1;\n\t\tu32     reserved:27;\n#else\n\t\tu32     reserved:27;\n\t\tu32     erase:1;\n\t\tu32     copyBack:1;\n\t\tu32     clear:1;\n\t\tu32     patrol:1;\n\t\tu32     rbld:1;\n#endif\n\t} pause;\n\n\tunion MR_PROGRESS     reserved[3];\n} __packed;\n\nstruct  MR_PD_INFO {\n\tunion MR_PD_REF\tref;\n\tu8 inquiryData[96];\n\tu8 vpdPage83[64];\n\tu8 notSupported;\n\tu8 scsiDevType;\n\n\tunion {\n\t\tu8 connectedPortBitmap;\n\t\tu8 connectedPortNumbers;\n\t};\n\n\tu8 deviceSpeed;\n\tu32 mediaErrCount;\n\tu32 otherErrCount;\n\tu32 predFailCount;\n\tu32 lastPredFailEventSeqNum;\n\n\tu16 fwState;\n\tu8 disabledForRemoval;\n\tu8 linkSpeed;\n\tunion MR_PD_DDF_TYPE state;\n\n\tstruct {\n\t\tu8 count;\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu8 isPathBroken:4;\n\t\tu8 reserved3:3;\n\t\tu8 widePortCapable:1;\n#else\n\t\tu8 widePortCapable:1;\n\t\tu8 reserved3:3;\n\t\tu8 isPathBroken:4;\n#endif\n\n\t\tu8 connectorIndex[2];\n\t\tu8 reserved[4];\n\t\tu64 sasAddr[2];\n\t\tu8 reserved2[16];\n\t} pathInfo;\n\n\tu64 rawSize;\n\tu64 nonCoercedSize;\n\tu64 coercedSize;\n\tu16 enclDeviceId;\n\tu8 enclIndex;\n\n\tunion {\n\t\tu8 slotNumber;\n\t\tu8 enclConnectorIndex;\n\t};\n\n\tstruct MR_PD_PROGRESS progInfo;\n\tu8 badBlockTableFull;\n\tu8 unusableInCurrentConfig;\n\tu8 vpdPage83Ext[64];\n\tu8 powerState;\n\tu8 enclPosition;\n\tu32 allowedOps;\n\tu16 copyBackPartnerId;\n\tu16 enclPartnerDeviceId;\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu16 fdeCapable:1;\n\t\tu16 fdeEnabled:1;\n\t\tu16 secured:1;\n\t\tu16 locked:1;\n\t\tu16 foreign:1;\n\t\tu16 needsEKM:1;\n\t\tu16 reserved:10;\n#else\n\t\tu16 reserved:10;\n\t\tu16 needsEKM:1;\n\t\tu16 foreign:1;\n\t\tu16 locked:1;\n\t\tu16 secured:1;\n\t\tu16 fdeEnabled:1;\n\t\tu16 fdeCapable:1;\n#endif\n\t} security;\n\tu8 mediaType;\n\tu8 notCertified;\n\tu8 bridgeVendor[8];\n\tu8 bridgeProductIdentification[16];\n\tu8 bridgeProductRevisionLevel[4];\n\tu8 satBridgeExists;\n\n\tu8 interfaceType;\n\tu8 temperature;\n\tu8 emulatedBlockSize;\n\tu16 userDataBlockSize;\n\tu16 reserved2;\n\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu32 piType:3;\n\t\tu32 piFormatted:1;\n\t\tu32 piEligible:1;\n\t\tu32 NCQ:1;\n\t\tu32 WCE:1;\n\t\tu32 commissionedSpare:1;\n\t\tu32 emergencySpare:1;\n\t\tu32 ineligibleForSSCD:1;\n\t\tu32 ineligibleForLd:1;\n\t\tu32 useSSEraseType:1;\n\t\tu32 wceUnchanged:1;\n\t\tu32 supportScsiUnmap:1;\n\t\tu32 reserved:18;\n#else\n\t\tu32 reserved:18;\n\t\tu32 supportScsiUnmap:1;\n\t\tu32 wceUnchanged:1;\n\t\tu32 useSSEraseType:1;\n\t\tu32 ineligibleForLd:1;\n\t\tu32 ineligibleForSSCD:1;\n\t\tu32 emergencySpare:1;\n\t\tu32 commissionedSpare:1;\n\t\tu32 WCE:1;\n\t\tu32 NCQ:1;\n\t\tu32 piEligible:1;\n\t\tu32 piFormatted:1;\n\t\tu32 piType:3;\n#endif\n\t} properties;\n\n\tu64 shieldDiagCompletionTime;\n\tu8 shieldCounter;\n\n\tu8 linkSpeedOther;\n\tu8 reserved4[2];\n\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu32 bbmErrCountSupported:1;\n\t\tu32 bbmErrCount:31;\n#else\n\t\tu32 bbmErrCount:31;\n\t\tu32 bbmErrCountSupported:1;\n#endif\n\t} bbmErr;\n\n\tu8 reserved1[512-428];\n} __packed;\n\n \nstruct MR_TARGET_PROPERTIES {\n\tu32    max_io_size_kb;\n\tu32    device_qdepth;\n\tu32    sector_size;\n\tu8     reset_tmo;\n\tu8     reserved[499];\n} __packed;\n\n  \nstruct MR_PD_ADDRESS {\n\t__le16\tdeviceId;\n\tu16     enclDeviceId;\n\n\tunion {\n\t\tstruct {\n\t\t\tu8  enclIndex;\n\t\t\tu8  slotNumber;\n\t\t} mrPdAddress;\n\t\tstruct {\n\t\t\tu8  enclPosition;\n\t\t\tu8  enclConnectorIndex;\n\t\t} mrEnclAddress;\n\t};\n\tu8      scsiDevType;\n\tunion {\n\t\tu8      connectedPortBitmap;\n\t\tu8      connectedPortNumbers;\n\t};\n\tu64     sasAddr[2];\n} __packed;\n\n \nstruct MR_PD_LIST {\n\t__le32\t\tsize;\n\t__le32\t\tcount;\n\tstruct MR_PD_ADDRESS   addr[1];\n} __packed;\n\nstruct megasas_pd_list {\n\tu16             tid;\n\tu8             driveType;\n\tu8             driveState;\n} __packed;\n\n  \nunion  MR_LD_REF {\n\tstruct {\n\t\tu8      targetId;\n\t\tu8      reserved;\n\t\t__le16     seqNum;\n\t};\n\t__le32     ref;\n} __packed;\n\n \nstruct MR_LD_LIST {\n\t__le32     ldCount;\n\t__le32     reserved;\n\tstruct {\n\t\tunion MR_LD_REF   ref;\n\t\tu8          state;\n\t\tu8          reserved[3];\n\t\t__le64\t\tsize;\n\t} ldList[MAX_LOGICAL_DRIVES_EXT];\n} __packed;\n\nstruct MR_LD_TARGETID_LIST {\n\t__le32\tsize;\n\t__le32\tcount;\n\tu8\tpad[3];\n\tu8\ttargetId[MAX_LOGICAL_DRIVES_EXT];\n};\n\nstruct MR_HOST_DEVICE_LIST_ENTRY {\n\tstruct {\n\t\tunion {\n\t\t\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\t\t\tu8 reserved:7;\n\t\t\t\tu8 is_sys_pd:1;\n#else\n\t\t\t\tu8 is_sys_pd:1;\n\t\t\t\tu8 reserved:7;\n#endif\n\t\t\t} bits;\n\t\t\tu8 byte;\n\t\t} u;\n\t} flags;\n\tu8 scsi_type;\n\t__le16 target_id;\n\tu8 reserved[4];\n\t__le64 sas_addr[2];\n} __packed;\n\nstruct MR_HOST_DEVICE_LIST {\n\t__le32\t\t\tsize;\n\t__le32\t\t\tcount;\n\t__le32\t\t\treserved[2];\n\tstruct MR_HOST_DEVICE_LIST_ENTRY\thost_device_list[1];\n} __packed;\n\n#define HOST_DEVICE_LIST_SZ (sizeof(struct MR_HOST_DEVICE_LIST) +\t       \\\n\t\t\t      (sizeof(struct MR_HOST_DEVICE_LIST_ENTRY) *      \\\n\t\t\t      (MEGASAS_MAX_PD + MAX_LOGICAL_DRIVES_EXT - 1)))\n\n\n \nstruct megasas_ctrl_prop {\n\n\tu16 seq_num;\n\tu16 pred_fail_poll_interval;\n\tu16 intr_throttle_count;\n\tu16 intr_throttle_timeouts;\n\tu8 rebuild_rate;\n\tu8 patrol_read_rate;\n\tu8 bgi_rate;\n\tu8 cc_rate;\n\tu8 recon_rate;\n\tu8 cache_flush_interval;\n\tu8 spinup_drv_count;\n\tu8 spinup_delay;\n\tu8 cluster_enable;\n\tu8 coercion_mode;\n\tu8 alarm_enable;\n\tu8 disable_auto_rebuild;\n\tu8 disable_battery_warn;\n\tu8 ecc_bucket_size;\n\tu16 ecc_bucket_leak_rate;\n\tu8 restore_hotspare_on_insertion;\n\tu8 expose_encl_devices;\n\tu8 maintainPdFailHistory;\n\tu8 disallowHostRequestReordering;\n\tu8 abortCCOnError;\n\tu8 loadBalanceMode;\n\tu8 disableAutoDetectBackplane;\n\n\tu8 snapVDSpace;\n\n\t \n\tstruct {\n#if   defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32     reserved:18;\n\t\tu32     enableJBOD:1;\n\t\tu32     disableSpinDownHS:1;\n\t\tu32     allowBootWithPinnedCache:1;\n\t\tu32     disableOnlineCtrlReset:1;\n\t\tu32     enableSecretKeyControl:1;\n\t\tu32     autoEnhancedImport:1;\n\t\tu32     enableSpinDownUnconfigured:1;\n\t\tu32     SSDPatrolReadEnabled:1;\n\t\tu32     SSDSMARTerEnabled:1;\n\t\tu32     disableNCQ:1;\n\t\tu32     useFdeOnly:1;\n\t\tu32     prCorrectUnconfiguredAreas:1;\n\t\tu32     SMARTerEnabled:1;\n\t\tu32     copyBackDisabled:1;\n#else\n\t\tu32     copyBackDisabled:1;\n\t\tu32     SMARTerEnabled:1;\n\t\tu32     prCorrectUnconfiguredAreas:1;\n\t\tu32     useFdeOnly:1;\n\t\tu32     disableNCQ:1;\n\t\tu32     SSDSMARTerEnabled:1;\n\t\tu32     SSDPatrolReadEnabled:1;\n\t\tu32     enableSpinDownUnconfigured:1;\n\t\tu32     autoEnhancedImport:1;\n\t\tu32     enableSecretKeyControl:1;\n\t\tu32     disableOnlineCtrlReset:1;\n\t\tu32     allowBootWithPinnedCache:1;\n\t\tu32     disableSpinDownHS:1;\n\t\tu32     enableJBOD:1;\n\t\tu32     reserved:18;\n#endif\n\t} OnOffProperties;\n\n\tunion {\n\t\tu8 autoSnapVDSpace;\n\t\tu8 viewSpace;\n\t\tstruct {\n#if   defined(__BIG_ENDIAN_BITFIELD)\n\t\t\tu16 reserved3:9;\n\t\t\tu16 enable_fw_dev_list:1;\n\t\t\tu16 reserved2:1;\n\t\t\tu16 enable_snap_dump:1;\n\t\t\tu16 reserved1:4;\n#else\n\t\t\tu16 reserved1:4;\n\t\t\tu16 enable_snap_dump:1;\n\t\t\tu16 reserved2:1;\n\t\t\tu16 enable_fw_dev_list:1;\n\t\t\tu16 reserved3:9;\n#endif\n\t\t} on_off_properties2;\n\t};\n\t__le16 spinDownTime;\n\tu8  reserved[24];\n} __packed;\n\n \nstruct megasas_ctrl_info {\n\n\t \n\tstruct {\n\n\t\t__le16 vendor_id;\n\t\t__le16 device_id;\n\t\t__le16 sub_vendor_id;\n\t\t__le16 sub_device_id;\n\t\tu8 reserved[24];\n\n\t} __attribute__ ((packed)) pci;\n\n\t \n\tstruct {\n\n\t\tu8 PCIX:1;\n\t\tu8 PCIE:1;\n\t\tu8 iSCSI:1;\n\t\tu8 SAS_3G:1;\n\t\tu8 SRIOV:1;\n\t\tu8 reserved_0:3;\n\t\tu8 reserved_1[6];\n\t\tu8 port_count;\n\t\tu64 port_addr[8];\n\n\t} __attribute__ ((packed)) host_interface;\n\n\t \n\tstruct {\n\n\t\tu8 SPI:1;\n\t\tu8 SAS_3G:1;\n\t\tu8 SATA_1_5G:1;\n\t\tu8 SATA_3G:1;\n\t\tu8 reserved_0:4;\n\t\tu8 reserved_1[6];\n\t\tu8 port_count;\n\t\tu64 port_addr[8];\n\n\t} __attribute__ ((packed)) device_interface;\n\n\t \n\t__le32 image_check_word;\n\t__le32 image_component_count;\n\n\tstruct {\n\n\t\tchar name[8];\n\t\tchar version[32];\n\t\tchar build_date[16];\n\t\tchar built_time[16];\n\n\t} __attribute__ ((packed)) image_component[8];\n\n\t \n\t__le32 pending_image_component_count;\n\n\tstruct {\n\n\t\tchar name[8];\n\t\tchar version[32];\n\t\tchar build_date[16];\n\t\tchar build_time[16];\n\n\t} __attribute__ ((packed)) pending_image_component[8];\n\n\tu8 max_arms;\n\tu8 max_spans;\n\tu8 max_arrays;\n\tu8 max_lds;\n\n\tchar product_name[80];\n\tchar serial_no[32];\n\n\t \n\tstruct {\n\n\t\tu32 bbu:1;\n\t\tu32 alarm:1;\n\t\tu32 nvram:1;\n\t\tu32 uart:1;\n\t\tu32 reserved:28;\n\n\t} __attribute__ ((packed)) hw_present;\n\n\t__le32 current_fw_time;\n\n\t \n\t__le16 max_concurrent_cmds;\n\t__le16 max_sge_count;\n\t__le32 max_request_size;\n\n\t \n\t__le16 ld_present_count;\n\t__le16 ld_degraded_count;\n\t__le16 ld_offline_count;\n\n\t__le16 pd_present_count;\n\t__le16 pd_disk_present_count;\n\t__le16 pd_disk_pred_failure_count;\n\t__le16 pd_disk_failed_count;\n\n\t \n\t__le16 nvram_size;\n\t__le16 memory_size;\n\t__le16 flash_size;\n\n\t \n\t__le16 mem_correctable_error_count;\n\t__le16 mem_uncorrectable_error_count;\n\n\t \n\tu8 cluster_permitted;\n\tu8 cluster_active;\n\n\t \n\t__le16 max_strips_per_io;\n\n\t \n\tstruct {\n\n\t\tu32 raid_level_0:1;\n\t\tu32 raid_level_1:1;\n\t\tu32 raid_level_5:1;\n\t\tu32 raid_level_1E:1;\n\t\tu32 raid_level_6:1;\n\t\tu32 reserved:27;\n\n\t} __attribute__ ((packed)) raid_levels;\n\n\tstruct {\n\n\t\tu32 rbld_rate:1;\n\t\tu32 cc_rate:1;\n\t\tu32 bgi_rate:1;\n\t\tu32 recon_rate:1;\n\t\tu32 patrol_rate:1;\n\t\tu32 alarm_control:1;\n\t\tu32 cluster_supported:1;\n\t\tu32 bbu:1;\n\t\tu32 spanning_allowed:1;\n\t\tu32 dedicated_hotspares:1;\n\t\tu32 revertible_hotspares:1;\n\t\tu32 foreign_config_import:1;\n\t\tu32 self_diagnostic:1;\n\t\tu32 mixed_redundancy_arr:1;\n\t\tu32 global_hot_spares:1;\n\t\tu32 reserved:17;\n\n\t} __attribute__ ((packed)) adapter_operations;\n\n\tstruct {\n\n\t\tu32 read_policy:1;\n\t\tu32 write_policy:1;\n\t\tu32 io_policy:1;\n\t\tu32 access_policy:1;\n\t\tu32 disk_cache_policy:1;\n\t\tu32 reserved:27;\n\n\t} __attribute__ ((packed)) ld_operations;\n\n\tstruct {\n\n\t\tu8 min;\n\t\tu8 max;\n\t\tu8 reserved[2];\n\n\t} __attribute__ ((packed)) stripe_sz_ops;\n\n\tstruct {\n\n\t\tu32 force_online:1;\n\t\tu32 force_offline:1;\n\t\tu32 force_rebuild:1;\n\t\tu32 reserved:29;\n\n\t} __attribute__ ((packed)) pd_operations;\n\n\tstruct {\n\n\t\tu32 ctrl_supports_sas:1;\n\t\tu32 ctrl_supports_sata:1;\n\t\tu32 allow_mix_in_encl:1;\n\t\tu32 allow_mix_in_ld:1;\n\t\tu32 allow_sata_in_cluster:1;\n\t\tu32 reserved:27;\n\n\t} __attribute__ ((packed)) pd_mix_support;\n\n\t \n\tu8 ecc_bucket_count;\n\tu8 reserved_2[11];\n\n\t \n\tstruct megasas_ctrl_prop properties;\n\n\t \n\tchar package_version[0x60];\n\n\n\t \n\t__le64\t    deviceInterfacePortAddr2[8];  \n\tu8          reserved3[128];               \n\n\tstruct {                                 \n\t\tu16 minPdRaidLevel_0:4;\n\t\tu16 maxPdRaidLevel_0:12;\n\n\t\tu16 minPdRaidLevel_1:4;\n\t\tu16 maxPdRaidLevel_1:12;\n\n\t\tu16 minPdRaidLevel_5:4;\n\t\tu16 maxPdRaidLevel_5:12;\n\n\t\tu16 minPdRaidLevel_1E:4;\n\t\tu16 maxPdRaidLevel_1E:12;\n\n\t\tu16 minPdRaidLevel_6:4;\n\t\tu16 maxPdRaidLevel_6:12;\n\n\t\tu16 minPdRaidLevel_10:4;\n\t\tu16 maxPdRaidLevel_10:12;\n\n\t\tu16 minPdRaidLevel_50:4;\n\t\tu16 maxPdRaidLevel_50:12;\n\n\t\tu16 minPdRaidLevel_60:4;\n\t\tu16 maxPdRaidLevel_60:12;\n\n\t\tu16 minPdRaidLevel_1E_RLQ0:4;\n\t\tu16 maxPdRaidLevel_1E_RLQ0:12;\n\n\t\tu16 minPdRaidLevel_1E0_RLQ0:4;\n\t\tu16 maxPdRaidLevel_1E0_RLQ0:12;\n\n\t\tu16 reserved[6];\n\t} pdsForRaidLevels;\n\n\t__le16 maxPds;                           \n\t__le16 maxDedHSPs;                       \n\t__le16 maxGlobalHSP;                     \n\t__le16 ddfSize;                          \n\tu8  maxLdsPerArray;                      \n\tu8  partitionsInDDF;                     \n\tu8  lockKeyBinding;                      \n\tu8  maxPITsPerLd;                        \n\tu8  maxViewsPerLd;                       \n\tu8  maxTargetId;                         \n\t__le16 maxBvlVdSize;                     \n\n\t__le16 maxConfigurableSSCSize;           \n\t__le16 currentSSCsize;                   \n\n\tchar    expanderFwVersion[12];           \n\n\t__le16 PFKTrialTimeRemaining;            \n\n\t__le16 cacheMemorySize;                  \n\n\tstruct {                                 \n#if   defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32     reserved:5;\n\t\tu32\tactivePassive:2;\n\t\tu32\tsupportConfigAutoBalance:1;\n\t\tu32\tmpio:1;\n\t\tu32\tsupportDataLDonSSCArray:1;\n\t\tu32\tsupportPointInTimeProgress:1;\n\t\tu32     supportUnevenSpans:1;\n\t\tu32     dedicatedHotSparesLimited:1;\n\t\tu32     headlessMode:1;\n\t\tu32     supportEmulatedDrives:1;\n\t\tu32     supportResetNow:1;\n\t\tu32     realTimeScheduler:1;\n\t\tu32     supportSSDPatrolRead:1;\n\t\tu32     supportPerfTuning:1;\n\t\tu32     disableOnlinePFKChange:1;\n\t\tu32     supportJBOD:1;\n\t\tu32     supportBootTimePFKChange:1;\n\t\tu32     supportSetLinkSpeed:1;\n\t\tu32     supportEmergencySpares:1;\n\t\tu32     supportSuspendResumeBGops:1;\n\t\tu32     blockSSDWriteCacheChange:1;\n\t\tu32     supportShieldState:1;\n\t\tu32     supportLdBBMInfo:1;\n\t\tu32     supportLdPIType3:1;\n\t\tu32     supportLdPIType2:1;\n\t\tu32     supportLdPIType1:1;\n\t\tu32     supportPIcontroller:1;\n#else\n\t\tu32     supportPIcontroller:1;\n\t\tu32     supportLdPIType1:1;\n\t\tu32     supportLdPIType2:1;\n\t\tu32     supportLdPIType3:1;\n\t\tu32     supportLdBBMInfo:1;\n\t\tu32     supportShieldState:1;\n\t\tu32     blockSSDWriteCacheChange:1;\n\t\tu32     supportSuspendResumeBGops:1;\n\t\tu32     supportEmergencySpares:1;\n\t\tu32     supportSetLinkSpeed:1;\n\t\tu32     supportBootTimePFKChange:1;\n\t\tu32     supportJBOD:1;\n\t\tu32     disableOnlinePFKChange:1;\n\t\tu32     supportPerfTuning:1;\n\t\tu32     supportSSDPatrolRead:1;\n\t\tu32     realTimeScheduler:1;\n\n\t\tu32     supportResetNow:1;\n\t\tu32     supportEmulatedDrives:1;\n\t\tu32     headlessMode:1;\n\t\tu32     dedicatedHotSparesLimited:1;\n\n\n\t\tu32     supportUnevenSpans:1;\n\t\tu32\tsupportPointInTimeProgress:1;\n\t\tu32\tsupportDataLDonSSCArray:1;\n\t\tu32\tmpio:1;\n\t\tu32\tsupportConfigAutoBalance:1;\n\t\tu32\tactivePassive:2;\n\t\tu32     reserved:5;\n#endif\n\t} adapterOperations2;\n\n\tu8  driverVersion[32];                   \n\tu8  maxDAPdCountSpinup60;                \n\tu8  temperatureROC;                      \n\tu8  temperatureCtrl;                     \n\tu8  reserved4;                           \n\t__le16 maxConfigurablePds;               \n\n\n\tu8  reserved5[2];                        \n\n\t \n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32     reserved:25;\n\t\tu32     passive:1;\n\t\tu32     premiumFeatureMismatch:1;\n\t\tu32     ctrlPropIncompatible:1;\n\t\tu32     fwVersionMismatch:1;\n\t\tu32     hwIncompatible:1;\n\t\tu32     peerIsIncompatible:1;\n\t\tu32     peerIsPresent:1;\n#else\n\t\tu32     peerIsPresent:1;\n\t\tu32     peerIsIncompatible:1;\n\t\tu32     hwIncompatible:1;\n\t\tu32     fwVersionMismatch:1;\n\t\tu32     ctrlPropIncompatible:1;\n\t\tu32     premiumFeatureMismatch:1;\n\t\tu32     passive:1;\n\t\tu32     reserved:25;\n#endif\n\t} cluster;\n\n\tchar clusterId[MEGASAS_CLUSTER_ID_SIZE];  \n\tstruct {\n\t\tu8  maxVFsSupported;             \n\t\tu8  numVFsEnabled;               \n\t\tu8  requestorId;                 \n\t\tu8  reserved;                    \n\t} iov;\n\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32     reserved:7;\n\t\tu32     useSeqNumJbodFP:1;\n\t\tu32     supportExtendedSSCSize:1;\n\t\tu32     supportDiskCacheSettingForSysPDs:1;\n\t\tu32     supportCPLDUpdate:1;\n\t\tu32     supportTTYLogCompression:1;\n\t\tu32     discardCacheDuringLDDelete:1;\n\t\tu32     supportSecurityonJBOD:1;\n\t\tu32     supportCacheBypassModes:1;\n\t\tu32     supportDisableSESMonitoring:1;\n\t\tu32     supportForceFlash:1;\n\t\tu32     supportNVDRAM:1;\n\t\tu32     supportDrvActivityLEDSetting:1;\n\t\tu32     supportAllowedOpsforDrvRemoval:1;\n\t\tu32     supportHOQRebuild:1;\n\t\tu32     supportForceTo512e:1;\n\t\tu32     supportNVCacheErase:1;\n\t\tu32     supportDebugQueue:1;\n\t\tu32     supportSwZone:1;\n\t\tu32     supportCrashDump:1;\n\t\tu32     supportMaxExtLDs:1;\n\t\tu32     supportT10RebuildAssist:1;\n\t\tu32     supportDisableImmediateIO:1;\n\t\tu32     supportThermalPollInterval:1;\n\t\tu32     supportPersonalityChange:2;\n#else\n\t\tu32     supportPersonalityChange:2;\n\t\tu32     supportThermalPollInterval:1;\n\t\tu32     supportDisableImmediateIO:1;\n\t\tu32     supportT10RebuildAssist:1;\n\t\tu32\tsupportMaxExtLDs:1;\n\t\tu32\tsupportCrashDump:1;\n\t\tu32     supportSwZone:1;\n\t\tu32     supportDebugQueue:1;\n\t\tu32     supportNVCacheErase:1;\n\t\tu32     supportForceTo512e:1;\n\t\tu32     supportHOQRebuild:1;\n\t\tu32     supportAllowedOpsforDrvRemoval:1;\n\t\tu32     supportDrvActivityLEDSetting:1;\n\t\tu32     supportNVDRAM:1;\n\t\tu32     supportForceFlash:1;\n\t\tu32     supportDisableSESMonitoring:1;\n\t\tu32     supportCacheBypassModes:1;\n\t\tu32     supportSecurityonJBOD:1;\n\t\tu32     discardCacheDuringLDDelete:1;\n\t\tu32     supportTTYLogCompression:1;\n\t\tu32     supportCPLDUpdate:1;\n\t\tu32     supportDiskCacheSettingForSysPDs:1;\n\t\tu32     supportExtendedSSCSize:1;\n\t\tu32     useSeqNumJbodFP:1;\n\t\tu32     reserved:7;\n#endif\n\t} adapterOperations3;\n\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\tu8 reserved:7;\n\t \n\tu8 cpld_in_flash:1;\n#else\n\tu8 cpld_in_flash:1;\n\tu8 reserved:7;\n#endif\n\tu8 reserved1[3];\n\t \n\tu8 userCodeDefinition[12];\n\t} cpld;   \n\n\tstruct {\n\t#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu16 reserved:2;\n\t\tu16 support_nvme_passthru:1;\n\t\tu16 support_pl_debug_info:1;\n\t\tu16 support_flash_comp_info:1;\n\t\tu16 support_host_info:1;\n\t\tu16 support_dual_fw_update:1;\n\t\tu16 support_ssc_rev3:1;\n\t\tu16 fw_swaps_bbu_vpd_info:1;\n\t\tu16 support_pd_map_target_id:1;\n\t\tu16 support_ses_ctrl_in_multipathcfg:1;\n\t\tu16 image_upload_supported:1;\n\t\tu16 support_encrypted_mfc:1;\n\t\tu16 supported_enc_algo:1;\n\t\tu16 support_ibutton_less:1;\n\t\tu16 ctrl_info_ext_supported:1;\n\t#else\n\n\t\tu16 ctrl_info_ext_supported:1;\n\t\tu16 support_ibutton_less:1;\n\t\tu16 supported_enc_algo:1;\n\t\tu16 support_encrypted_mfc:1;\n\t\tu16 image_upload_supported:1;\n\t\t \n\t\tu16 support_ses_ctrl_in_multipathcfg:1;\n\t\t \n\t\t \n\t\tu16 support_pd_map_target_id:1;\n\t\t \n\t\tu16 fw_swaps_bbu_vpd_info:1;\n\t\tu16 support_ssc_rev3:1;\n\t\t \n\t\tu16 support_dual_fw_update:1;\n\t\t \n\t\tu16 support_host_info:1;\n\t\t \n\t\tu16 support_flash_comp_info:1;\n\t\t \n\t\tu16 support_pl_debug_info:1;\n\t\t \n\t\tu16 support_nvme_passthru:1;\n\t\t \n\t\tu16 reserved:2;\n\t#endif\n\t\t} adapter_operations4;\n\tu8 pad[0x800 - 0x7FE];  \n\n\tu32 size;\n\tu32 pad1;\n\n\tu8 reserved6[64];\n\n\tstruct {\n\t#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32 reserved:19;\n\t\tu32 support_pci_lane_margining: 1;\n\t\tu32 support_psoc_update:1;\n\t\tu32 support_force_personality_change:1;\n\t\tu32 support_fde_type_mix:1;\n\t\tu32 support_snap_dump:1;\n\t\tu32 support_nvme_tm:1;\n\t\tu32 support_oce_only:1;\n\t\tu32 support_ext_mfg_vpd:1;\n\t\tu32 support_pcie:1;\n\t\tu32 support_cvhealth_info:1;\n\t\tu32 support_profile_change:2;\n\t\tu32 mr_config_ext2_supported:1;\n\t#else\n\t\tu32 mr_config_ext2_supported:1;\n\t\tu32 support_profile_change:2;\n\t\tu32 support_cvhealth_info:1;\n\t\tu32 support_pcie:1;\n\t\tu32 support_ext_mfg_vpd:1;\n\t\tu32 support_oce_only:1;\n\t\tu32 support_nvme_tm:1;\n\t\tu32 support_snap_dump:1;\n\t\tu32 support_fde_type_mix:1;\n\t\tu32 support_force_personality_change:1;\n\t\tu32 support_psoc_update:1;\n\t\tu32 support_pci_lane_margining: 1;\n\t\tu32 reserved:19;\n\t#endif\n\t} adapter_operations5;\n\n\tu32 rsvdForAdptOp[63];\n\n\tu8 reserved7[3];\n\n\tu8 TaskAbortTO;\t \n\tu8 MaxResetTO;\t \n\tu8 reserved8[3];\n} __packed;\n\n \n#define MEGASAS_MAX_PD_CHANNELS\t\t\t2\n#define MEGASAS_MAX_LD_CHANNELS\t\t\t2\n#define MEGASAS_MAX_CHANNELS\t\t\t(MEGASAS_MAX_PD_CHANNELS + \\\n\t\t\t\t\t\tMEGASAS_MAX_LD_CHANNELS)\n#define MEGASAS_MAX_DEV_PER_CHANNEL\t\t128\n#define MEGASAS_DEFAULT_INIT_ID\t\t\t-1\n#define MEGASAS_MAX_LUN\t\t\t\t8\n#define MEGASAS_DEFAULT_CMD_PER_LUN\t\t256\n#define MEGASAS_MAX_PD                          (MEGASAS_MAX_PD_CHANNELS * \\\n\t\t\t\t\t\tMEGASAS_MAX_DEV_PER_CHANNEL)\n#define MEGASAS_MAX_LD_IDS\t\t\t(MEGASAS_MAX_LD_CHANNELS * \\\n\t\t\t\t\t\tMEGASAS_MAX_DEV_PER_CHANNEL)\n\n#define MEGASAS_MAX_SUPPORTED_LD_IDS\t\t240\n\n#define MEGASAS_MAX_SECTORS                    (2*1024)\n#define MEGASAS_MAX_SECTORS_IEEE\t\t(2*128)\n#define MEGASAS_DBG_LVL\t\t\t\t1\n\n#define MEGASAS_FW_BUSY\t\t\t\t1\n\n \n#define OCR_DEBUG    (1 << 0)\n#define TM_DEBUG     (1 << 1)\n#define LD_PD_DEBUG    (1 << 2)\n\n#define SCAN_PD_CHANNEL\t0x1\n#define SCAN_VD_CHANNEL\t0x2\n\n#define MEGASAS_KDUMP_QUEUE_DEPTH               100\n#define MR_LARGE_IO_MIN_SIZE\t\t\t(32 * 1024)\n#define MR_R1_LDIO_PIGGYBACK_DEFAULT\t\t4\n\nenum MR_SCSI_CMD_TYPE {\n\tREAD_WRITE_LDIO = 0,\n\tNON_READ_WRITE_LDIO = 1,\n\tREAD_WRITE_SYSPDIO = 2,\n\tNON_READ_WRITE_SYSPDIO = 3,\n};\n\nenum DCMD_TIMEOUT_ACTION {\n\tINITIATE_OCR = 0,\n\tKILL_ADAPTER = 1,\n\tIGNORE_TIMEOUT = 2,\n};\n\nenum FW_BOOT_CONTEXT {\n\tPROBE_CONTEXT = 0,\n\tOCR_CONTEXT = 1,\n};\n\n \n#define IO_FRAME\t\t\t\t0\n#define PTHRU_FRAME\t\t\t\t1\n\n \n#define MEGASAS_RESET_WAIT_TIME\t\t\t180\n#define MEGASAS_INTERNAL_CMD_WAIT_TIME\t\t180\n#define\tMEGASAS_RESET_NOTICE_INTERVAL\t\t5\n#define MEGASAS_IOCTL_CMD\t\t\t0\n#define MEGASAS_DEFAULT_CMD_TIMEOUT\t\t90\n#define MEGASAS_THROTTLE_QUEUE_DEPTH\t\t16\n#define MEGASAS_DEFAULT_TM_TIMEOUT\t\t50\n \n#define MEGASAS_INT_CMDS\t\t\t32\n#define MEGASAS_SKINNY_INT_CMDS\t\t\t5\n#define MEGASAS_FUSION_INTERNAL_CMDS\t\t8\n#define MEGASAS_FUSION_IOCTL_CMDS\t\t3\n#define MEGASAS_MFI_IOCTL_CMDS\t\t\t27\n\n#define MEGASAS_MAX_MSIX_QUEUES\t\t\t128\n \n#define IS_DMA64\t\t\t\t(sizeof(dma_addr_t) == 8)\n\n#define MFI_XSCALE_OMR0_CHANGE_INTERRUPT\t\t0x00000001\n\n#define MFI_INTR_FLAG_REPLY_MESSAGE\t\t\t0x00000001\n#define MFI_INTR_FLAG_FIRMWARE_STATE_CHANGE\t\t0x00000002\n#define MFI_G2_OUTBOUND_DOORBELL_CHANGE_INTERRUPT\t0x00000004\n\n#define MFI_OB_INTR_STATUS_MASK\t\t\t0x00000002\n#define MFI_POLL_TIMEOUT_SECS\t\t\t60\n#define MFI_IO_TIMEOUT_SECS\t\t\t180\n#define MEGASAS_SRIOV_HEARTBEAT_INTERVAL_VF\t(5 * HZ)\n#define MEGASAS_OCR_SETTLE_TIME_VF\t\t(1000 * 30)\n#define MEGASAS_SRIOV_MAX_RESET_TRIES_VF\t1\n#define MEGASAS_ROUTINE_WAIT_TIME_VF\t\t300\n#define MFI_REPLY_1078_MESSAGE_INTERRUPT\t0x80000000\n#define MFI_REPLY_GEN2_MESSAGE_INTERRUPT\t0x00000001\n#define MFI_GEN2_ENABLE_INTERRUPT_MASK\t\t(0x00000001 | 0x00000004)\n#define MFI_REPLY_SKINNY_MESSAGE_INTERRUPT\t0x40000000\n#define MFI_SKINNY_ENABLE_INTERRUPT_MASK\t(0x00000001)\n\n#define MFI_1068_PCSR_OFFSET\t\t\t0x84\n#define MFI_1068_FW_HANDSHAKE_OFFSET\t\t0x64\n#define MFI_1068_FW_READY\t\t\t0xDDDD0000\n\n#define MR_MAX_REPLY_QUEUES_OFFSET              0X0000001F\n#define MR_MAX_REPLY_QUEUES_EXT_OFFSET          0X003FC000\n#define MR_MAX_REPLY_QUEUES_EXT_OFFSET_SHIFT    14\n#define MR_MAX_MSIX_REG_ARRAY                   16\n#define MR_RDPQ_MODE_OFFSET\t\t\t0X00800000\n\n#define MR_MAX_RAID_MAP_SIZE_OFFSET_SHIFT\t16\n#define MR_MAX_RAID_MAP_SIZE_MASK\t\t0x1FF\n#define MR_MIN_MAP_SIZE\t\t\t\t0x10000\n \n\n#define MR_CAN_HANDLE_SYNC_CACHE_OFFSET\t\t0X01000000\n\n#define MR_ATOMIC_DESCRIPTOR_SUPPORT_OFFSET\t(1 << 24)\n\n#define MR_CAN_HANDLE_64_BIT_DMA_OFFSET\t\t(1 << 25)\n#define MR_INTR_COALESCING_SUPPORT_OFFSET\t(1 << 26)\n\n#define MEGASAS_WATCHDOG_THREAD_INTERVAL\t1000\n#define MEGASAS_WAIT_FOR_NEXT_DMA_MSECS\t\t20\n#define MEGASAS_WATCHDOG_WAIT_COUNT\t\t50\n\nenum MR_ADAPTER_TYPE {\n\tMFI_SERIES = 1,\n\tTHUNDERBOLT_SERIES = 2,\n\tINVADER_SERIES = 3,\n\tVENTURA_SERIES = 4,\n\tAERO_SERIES = 5,\n};\n\n \n\nstruct megasas_register_set {\n\tu32\tdoorbell;                        \n\tu32\tfusion_seq_offset;\t\t \n\tu32\tfusion_host_diag;\t\t \n\tu32\treserved_01;\t\t\t \n\n\tu32 \tinbound_msg_0;\t\t\t \n\tu32 \tinbound_msg_1;\t\t\t \n\tu32 \toutbound_msg_0;\t\t\t \n\tu32 \toutbound_msg_1;\t\t\t \n\n\tu32 \tinbound_doorbell;\t\t \n\tu32 \tinbound_intr_status;\t\t \n\tu32 \tinbound_intr_mask;\t\t \n\n\tu32 \toutbound_doorbell;\t\t \n\tu32 \toutbound_intr_status;\t\t \n\tu32 \toutbound_intr_mask;\t\t \n\n\tu32 \treserved_1[2];\t\t\t \n\n\tu32 \tinbound_queue_port;\t\t \n\tu32 \toutbound_queue_port;\t\t \n\n\tu32\treserved_2[9];\t\t\t \n\tu32\treply_post_host_index;\t\t \n\tu32\treserved_2_2[12];\t\t \n\n\tu32 \toutbound_doorbell_clear;\t \n\n\tu32 \treserved_3[3];\t\t\t \n\n\tu32\toutbound_scratch_pad_0;\t\t \n\tu32\toutbound_scratch_pad_1;          \n\tu32\toutbound_scratch_pad_2;          \n\tu32\toutbound_scratch_pad_3;          \n\n\tu32 \tinbound_low_queue_port ;\t \n\n\tu32 \tinbound_high_queue_port ;\t \n\n\tu32 inbound_single_queue_port;\t \n\tu32\tres_6[11];\t\t\t \n\tu32\thost_diag;\n\tu32\tseq_offset;\n\tu32 \tindex_registers[807];\t\t \n} __attribute__ ((packed));\n\nstruct megasas_sge32 {\n\n\t__le32 phys_addr;\n\t__le32 length;\n\n} __attribute__ ((packed));\n\nstruct megasas_sge64 {\n\n\t__le64 phys_addr;\n\t__le32 length;\n\n} __attribute__ ((packed));\n\nstruct megasas_sge_skinny {\n\t__le64 phys_addr;\n\t__le32 length;\n\t__le32 flag;\n} __packed;\n\nunion megasas_sgl {\n\tDECLARE_FLEX_ARRAY(struct megasas_sge32, sge32);\n\tDECLARE_FLEX_ARRAY(struct megasas_sge64, sge64);\n\tDECLARE_FLEX_ARRAY(struct megasas_sge_skinny, sge_skinny);\n} __attribute__ ((packed));\n\nstruct megasas_header {\n\n\tu8 cmd;\t\t\t \n\tu8 sense_len;\t\t \n\tu8 cmd_status;\t\t \n\tu8 scsi_status;\t\t \n\n\tu8 target_id;\t\t \n\tu8 lun;\t\t\t \n\tu8 cdb_len;\t\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\t__le32 data_xferlen;\t \n\n} __attribute__ ((packed));\n\nunion megasas_sgl_frame {\n\n\tstruct megasas_sge32 sge32[8];\n\tstruct megasas_sge64 sge64[5];\n\n} __attribute__ ((packed));\n\ntypedef union _MFI_CAPABILITIES {\n\tstruct {\n#if   defined(__BIG_ENDIAN_BITFIELD)\n\tu32     reserved:15;\n\tu32\tsupport_memdump:1;\n\tu32\tsupport_fw_exposed_dev_list:1;\n\tu32\tsupport_nvme_passthru:1;\n\tu32     support_64bit_mode:1;\n\tu32 support_pd_map_target_id:1;\n\tu32     support_qd_throttling:1;\n\tu32     support_fp_rlbypass:1;\n\tu32     support_vfid_in_ioframe:1;\n\tu32     support_ext_io_size:1;\n\tu32\t\tsupport_ext_queue_depth:1;\n\tu32     security_protocol_cmds_fw:1;\n\tu32     support_core_affinity:1;\n\tu32     support_ndrive_r1_lb:1;\n\tu32\t\tsupport_max_255lds:1;\n\tu32\t\tsupport_fastpath_wb:1;\n\tu32     support_additional_msix:1;\n\tu32     support_fp_remote_lun:1;\n#else\n\tu32     support_fp_remote_lun:1;\n\tu32     support_additional_msix:1;\n\tu32\t\tsupport_fastpath_wb:1;\n\tu32\t\tsupport_max_255lds:1;\n\tu32     support_ndrive_r1_lb:1;\n\tu32     support_core_affinity:1;\n\tu32     security_protocol_cmds_fw:1;\n\tu32\t\tsupport_ext_queue_depth:1;\n\tu32     support_ext_io_size:1;\n\tu32     support_vfid_in_ioframe:1;\n\tu32     support_fp_rlbypass:1;\n\tu32     support_qd_throttling:1;\n\tu32\tsupport_pd_map_target_id:1;\n\tu32     support_64bit_mode:1;\n\tu32\tsupport_nvme_passthru:1;\n\tu32\tsupport_fw_exposed_dev_list:1;\n\tu32\tsupport_memdump:1;\n\tu32     reserved:15;\n#endif\n\t} mfi_capabilities;\n\t__le32\t\treg;\n} MFI_CAPABILITIES;\n\nstruct megasas_init_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 reserved_0;\t\t \n\tu8 cmd_status;\t\t \n\n\tu8 reserved_1;\t\t \n\tMFI_CAPABILITIES driver_operations;  \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 replyqueue_mask;\t\t \n\t__le32 data_xfer_len;\t \n\n\t__le32 queue_info_new_phys_addr_lo;\t \n\t__le32 queue_info_new_phys_addr_hi;\t \n\t__le32 queue_info_old_phys_addr_lo;\t \n\t__le32 queue_info_old_phys_addr_hi;\t \n\t__le32 reserved_4[2];\t \n\t__le32 system_info_lo;       \n\t__le32 system_info_hi;       \n\t__le32 reserved_5[2];\t \n\n} __attribute__ ((packed));\n\nstruct megasas_init_queue_info {\n\n\t__le32 init_flags;\t\t \n\t__le32 reply_queue_entries;\t \n\n\t__le32 reply_queue_start_phys_addr_lo;\t \n\t__le32 reply_queue_start_phys_addr_hi;\t \n\t__le32 producer_index_phys_addr_lo;\t \n\t__le32 producer_index_phys_addr_hi;\t \n\t__le32 consumer_index_phys_addr_lo;\t \n\t__le32 consumer_index_phys_addr_hi;\t \n\n} __attribute__ ((packed));\n\nstruct megasas_io_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 sense_len;\t\t \n\tu8 cmd_status;\t\t \n\tu8 scsi_status;\t\t \n\n\tu8 target_id;\t\t \n\tu8 access_byte;\t\t \n\tu8 reserved_0;\t\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\t__le32 lba_count;\t \n\n\t__le32 sense_buf_phys_addr_lo;\t \n\t__le32 sense_buf_phys_addr_hi;\t \n\n\t__le32 start_lba_lo;\t \n\t__le32 start_lba_hi;\t \n\n\tunion megasas_sgl sgl;\t \n\n} __attribute__ ((packed));\n\nstruct megasas_pthru_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 sense_len;\t\t \n\tu8 cmd_status;\t\t \n\tu8 scsi_status;\t\t \n\n\tu8 target_id;\t\t \n\tu8 lun;\t\t\t \n\tu8 cdb_len;\t\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\t__le32 data_xfer_len;\t \n\n\t__le32 sense_buf_phys_addr_lo;\t \n\t__le32 sense_buf_phys_addr_hi;\t \n\n\tu8 cdb[16];\t\t \n\tunion megasas_sgl sgl;\t \n\n} __attribute__ ((packed));\n\nstruct megasas_dcmd_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 reserved_0;\t\t \n\tu8 cmd_status;\t\t \n\tu8 reserved_1[4];\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\n\t__le32 data_xfer_len;\t \n\t__le32 opcode;\t\t \n\n\tunion {\t\t\t \n\t\tu8 b[12];\n\t\t__le16 s[6];\n\t\t__le32 w[3];\n\t} mbox;\n\n\tunion megasas_sgl sgl;\t \n\n} __attribute__ ((packed));\n\nstruct megasas_abort_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 reserved_0;\t\t \n\tu8 cmd_status;\t\t \n\n\tu8 reserved_1;\t\t \n\t__le32 reserved_2;\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 reserved_3;\t \n\t__le32 reserved_4;\t \n\n\t__le32 abort_context;\t \n\t__le32 pad_1;\t\t \n\n\t__le32 abort_mfi_phys_addr_lo;\t \n\t__le32 abort_mfi_phys_addr_hi;\t \n\n\t__le32 reserved_5[6];\t \n\n} __attribute__ ((packed));\n\nstruct megasas_smp_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 reserved_1;\t\t \n\tu8 cmd_status;\t\t \n\tu8 connection_status;\t \n\n\tu8 reserved_2[3];\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\n\t__le32 data_xfer_len;\t \n\t__le64 sas_addr;\t \n\n\tunion {\n\t\tstruct megasas_sge32 sge32[2];\t \n\t\tstruct megasas_sge64 sge64[2];\t \n\t} sgl;\n\n} __attribute__ ((packed));\n\nstruct megasas_stp_frame {\n\n\tu8 cmd;\t\t\t \n\tu8 reserved_1;\t\t \n\tu8 cmd_status;\t\t \n\tu8 reserved_2;\t\t \n\n\tu8 target_id;\t\t \n\tu8 reserved_3[2];\t \n\tu8 sge_count;\t\t \n\n\t__le32 context;\t\t \n\t__le32 pad_0;\t\t \n\n\t__le16 flags;\t\t \n\t__le16 timeout;\t\t \n\n\t__le32 data_xfer_len;\t \n\n\t__le16 fis[10];\t\t \n\t__le32 stp_flags;\n\n\tunion {\n\t\tstruct megasas_sge32 sge32[2];\t \n\t\tstruct megasas_sge64 sge64[2];\t \n\t} sgl;\n\n} __attribute__ ((packed));\n\nunion megasas_frame {\n\n\tstruct megasas_header hdr;\n\tstruct megasas_init_frame init;\n\tstruct megasas_io_frame io;\n\tstruct megasas_pthru_frame pthru;\n\tstruct megasas_dcmd_frame dcmd;\n\tstruct megasas_abort_frame abort;\n\tstruct megasas_smp_frame smp;\n\tstruct megasas_stp_frame stp;\n\n\tu8 raw_bytes[64];\n};\n\n \nstruct MR_PRIV_DEVICE {\n\tbool is_tm_capable;\n\tbool tm_busy;\n\tatomic_t sdev_priv_busy;\n\tatomic_t r1_ldio_hint;\n\tu8 interface_type;\n\tu8 task_abort_tmo;\n\tu8 target_reset_tmo;\n};\nstruct megasas_cmd;\n\nunion megasas_evt_class_locale {\n\n\tstruct {\n#ifndef __BIG_ENDIAN_BITFIELD\n\t\tu16 locale;\n\t\tu8 reserved;\n\t\ts8 class;\n#else\n\t\ts8 class;\n\t\tu8 reserved;\n\t\tu16 locale;\n#endif\n\t} __attribute__ ((packed)) members;\n\n\tu32 word;\n\n} __attribute__ ((packed));\n\nstruct megasas_evt_log_info {\n\t__le32 newest_seq_num;\n\t__le32 oldest_seq_num;\n\t__le32 clear_seq_num;\n\t__le32 shutdown_seq_num;\n\t__le32 boot_seq_num;\n\n} __attribute__ ((packed));\n\nstruct megasas_progress {\n\n\t__le16 progress;\n\t__le16 elapsed_seconds;\n\n} __attribute__ ((packed));\n\nstruct megasas_evtarg_ld {\n\n\tu16 target_id;\n\tu8 ld_index;\n\tu8 reserved;\n\n} __attribute__ ((packed));\n\nstruct megasas_evtarg_pd {\n\tu16 device_id;\n\tu8 encl_index;\n\tu8 slot_number;\n\n} __attribute__ ((packed));\n\nstruct megasas_evt_detail {\n\n\t__le32 seq_num;\n\t__le32 time_stamp;\n\t__le32 code;\n\tunion megasas_evt_class_locale cl;\n\tu8 arg_type;\n\tu8 reserved1[15];\n\n\tunion {\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t\tu8 cdb_length;\n\t\t\tu8 sense_length;\n\t\t\tu8 reserved[2];\n\t\t\tu8 cdb[16];\n\t\t\tu8 sense[64];\n\t\t} __attribute__ ((packed)) cdbSense;\n\n\t\tstruct megasas_evtarg_ld ld;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t\t__le64 count;\n\t\t} __attribute__ ((packed)) ld_count;\n\n\t\tstruct {\n\t\t\t__le64 lba;\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t} __attribute__ ((packed)) ld_lba;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t\t__le32 prevOwner;\n\t\t\t__le32 newOwner;\n\t\t} __attribute__ ((packed)) ld_owner;\n\n\t\tstruct {\n\t\t\tu64 ld_lba;\n\t\t\tu64 pd_lba;\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t} __attribute__ ((packed)) ld_lba_pd_lba;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t\tstruct megasas_progress prog;\n\t\t} __attribute__ ((packed)) ld_prog;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t\tu32 prev_state;\n\t\t\tu32 new_state;\n\t\t} __attribute__ ((packed)) ld_state;\n\n\t\tstruct {\n\t\t\tu64 strip;\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t} __attribute__ ((packed)) ld_strip;\n\n\t\tstruct megasas_evtarg_pd pd;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t\tu32 err;\n\t\t} __attribute__ ((packed)) pd_err;\n\n\t\tstruct {\n\t\t\tu64 lba;\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t} __attribute__ ((packed)) pd_lba;\n\n\t\tstruct {\n\t\t\tu64 lba;\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t\tstruct megasas_evtarg_ld ld;\n\t\t} __attribute__ ((packed)) pd_lba_ld;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t\tstruct megasas_progress prog;\n\t\t} __attribute__ ((packed)) pd_prog;\n\n\t\tstruct {\n\t\t\tstruct megasas_evtarg_pd pd;\n\t\t\tu32 prevState;\n\t\t\tu32 newState;\n\t\t} __attribute__ ((packed)) pd_state;\n\n\t\tstruct {\n\t\t\tu16 vendorId;\n\t\t\t__le16 deviceId;\n\t\t\tu16 subVendorId;\n\t\t\tu16 subDeviceId;\n\t\t} __attribute__ ((packed)) pci;\n\n\t\tu32 rate;\n\t\tchar str[96];\n\n\t\tstruct {\n\t\t\tu32 rtc;\n\t\t\tu32 elapsedSeconds;\n\t\t} __attribute__ ((packed)) time;\n\n\t\tstruct {\n\t\t\tu32 ecar;\n\t\t\tu32 elog;\n\t\t\tchar str[64];\n\t\t} __attribute__ ((packed)) ecc;\n\n\t\tu8 b[96];\n\t\t__le16 s[48];\n\t\t__le32 w[24];\n\t\t__le64 d[12];\n\t} args;\n\n\tchar description[128];\n\n} __attribute__ ((packed));\n\nstruct megasas_aen_event {\n\tstruct delayed_work hotplug_work;\n\tstruct megasas_instance *instance;\n};\n\nstruct megasas_irq_context {\n\tchar name[MEGASAS_MSIX_NAME_LEN];\n\tstruct megasas_instance *instance;\n\tu32 MSIxIndex;\n\tu32 os_irq;\n\tstruct irq_poll irqpoll;\n\tbool irq_poll_scheduled;\n\tbool irq_line_enable;\n\tatomic_t   in_used;\n};\n\nstruct MR_DRV_SYSTEM_INFO {\n\tu8\tinfoVersion;\n\tu8\tsystemIdLength;\n\tu16\treserved0;\n\tu8\tsystemId[64];\n\tu8\treserved[1980];\n};\n\nenum MR_PD_TYPE {\n\tUNKNOWN_DRIVE = 0,\n\tPARALLEL_SCSI = 1,\n\tSAS_PD = 2,\n\tSATA_PD = 3,\n\tFC_PD = 4,\n\tNVME_PD = 5,\n};\n\n \n#define MEGASAS_SATA_QD\t32\n#define MEGASAS_SAS_QD 256\n#define MEGASAS_DEFAULT_PD_QD\t64\n#define MEGASAS_NVME_QD        64\n\n#define MR_DEFAULT_NVME_PAGE_SIZE\t4096\n#define MR_DEFAULT_NVME_PAGE_SHIFT\t12\n#define MR_DEFAULT_NVME_MDTS_KB\t\t128\n#define MR_NVME_PAGE_SIZE_MASK\t\t0x000000FF\n\n \n#define MR_HIGH_IOPS_QUEUE_COUNT\t8\n#define MR_DEVICE_HIGH_IOPS_DEPTH\t8\n#define MR_HIGH_IOPS_BATCH_COUNT\t16\n\nenum MR_PERF_MODE {\n\tMR_BALANCED_PERF_MODE\t\t= 0,\n\tMR_IOPS_PERF_MODE\t\t= 1,\n\tMR_LATENCY_PERF_MODE\t\t= 2,\n};\n\n#define MEGASAS_PERF_MODE_2STR(mode) \\\n\t\t((mode) == MR_BALANCED_PERF_MODE ? \"Balanced\" : \\\n\t\t (mode) == MR_IOPS_PERF_MODE ? \"IOPS\" : \\\n\t\t (mode) == MR_LATENCY_PERF_MODE ? \"Latency\" : \\\n\t\t \"Unknown\")\n\nenum MEGASAS_LD_TARGET_ID_STATUS {\n\tLD_TARGET_ID_INITIAL,\n\tLD_TARGET_ID_ACTIVE,\n\tLD_TARGET_ID_DELETED,\n};\n\n#define MEGASAS_TARGET_ID(sdev)\t\t\t\t\t\t\\\n\t(((sdev->channel % 2) * MEGASAS_MAX_DEV_PER_CHANNEL) + sdev->id)\n\nstruct megasas_instance {\n\n\tunsigned int *reply_map;\n\t__le32 *producer;\n\tdma_addr_t producer_h;\n\t__le32 *consumer;\n\tdma_addr_t consumer_h;\n\tstruct MR_DRV_SYSTEM_INFO *system_info_buf;\n\tdma_addr_t system_info_h;\n\tstruct MR_LD_VF_AFFILIATION *vf_affiliation;\n\tdma_addr_t vf_affiliation_h;\n\tstruct MR_LD_VF_AFFILIATION_111 *vf_affiliation_111;\n\tdma_addr_t vf_affiliation_111_h;\n\tstruct MR_CTRL_HB_HOST_MEM *hb_host_mem;\n\tdma_addr_t hb_host_mem_h;\n\tstruct MR_PD_INFO *pd_info;\n\tdma_addr_t pd_info_h;\n\tstruct MR_TARGET_PROPERTIES *tgt_prop;\n\tdma_addr_t tgt_prop_h;\n\n\t__le32 *reply_queue;\n\tdma_addr_t reply_queue_h;\n\n\tu32 *crash_dump_buf;\n\tdma_addr_t crash_dump_h;\n\n\tstruct MR_PD_LIST *pd_list_buf;\n\tdma_addr_t pd_list_buf_h;\n\n\tstruct megasas_ctrl_info *ctrl_info_buf;\n\tdma_addr_t ctrl_info_buf_h;\n\n\tstruct MR_LD_LIST *ld_list_buf;\n\tdma_addr_t ld_list_buf_h;\n\n\tstruct MR_LD_TARGETID_LIST *ld_targetid_list_buf;\n\tdma_addr_t ld_targetid_list_buf_h;\n\n\tstruct MR_HOST_DEVICE_LIST *host_device_list_buf;\n\tdma_addr_t host_device_list_buf_h;\n\n\tstruct MR_SNAPDUMP_PROPERTIES *snapdump_prop;\n\tdma_addr_t snapdump_prop_h;\n\n\tvoid *crash_buf[MAX_CRASH_DUMP_SIZE];\n\tunsigned int    fw_crash_buffer_size;\n\tunsigned int    fw_crash_state;\n\tunsigned int    fw_crash_buffer_offset;\n\tu32 drv_buf_index;\n\tu32 drv_buf_alloc;\n\tu32 crash_dump_fw_support;\n\tu32 crash_dump_drv_support;\n\tu32 crash_dump_app_support;\n\tu32 secure_jbod_support;\n\tu32 support_morethan256jbod;  \n\tbool use_seqnum_jbod_fp;    \n\tbool smp_affinity_enable;\n\tstruct mutex crashdump_lock;\n\n\tstruct megasas_register_set __iomem *reg_set;\n\tu32 __iomem *reply_post_host_index_addr[MR_MAX_MSIX_REG_ARRAY];\n\tstruct megasas_pd_list          pd_list[MEGASAS_MAX_PD];\n\tstruct megasas_pd_list          local_pd_list[MEGASAS_MAX_PD];\n\tu8 ld_ids[MEGASAS_MAX_LD_IDS];\n\tu8 ld_tgtid_status[MEGASAS_MAX_LD_IDS];\n\tu8 ld_ids_prev[MEGASAS_MAX_LD_IDS];\n\tu8 ld_ids_from_raidmap[MEGASAS_MAX_LD_IDS];\n\ts8 init_id;\n\n\tu16 max_num_sge;\n\tu16 max_fw_cmds;\n\tu16 max_mpt_cmds;\n\tu16 max_mfi_cmds;\n\tu16 max_scsi_cmds;\n\tu16 ldio_threshold;\n\tu16 cur_can_queue;\n\tu32 max_sectors_per_req;\n\tbool msix_load_balance;\n\tstruct megasas_aen_event *ev;\n\n\tstruct megasas_cmd **cmd_list;\n\tstruct list_head cmd_pool;\n\t \n\tspinlock_t mfi_pool_lock;\n\t \n\tspinlock_t hba_lock;\n\t \n\tspinlock_t stream_lock;\n\tspinlock_t completion_lock;\n\tstruct dma_pool *frame_dma_pool;\n\tstruct dma_pool *sense_dma_pool;\n\n\tstruct megasas_evt_detail *evt_detail;\n\tdma_addr_t evt_detail_h;\n\tstruct megasas_cmd *aen_cmd;\n\tstruct semaphore ioctl_sem;\n\n\tstruct Scsi_Host *host;\n\n\twait_queue_head_t int_cmd_wait_q;\n\twait_queue_head_t abort_cmd_wait_q;\n\n\tstruct pci_dev *pdev;\n\tu32 unique_id;\n\tu32 fw_support_ieee;\n\tu32 threshold_reply_count;\n\n\tatomic_t fw_outstanding;\n\tatomic_t ldio_outstanding;\n\tatomic_t fw_reset_no_pci_access;\n\tatomic64_t total_io_count;\n\tatomic64_t high_iops_outstanding;\n\n\tstruct megasas_instance_template *instancet;\n\tstruct tasklet_struct isr_tasklet;\n\tstruct work_struct work_init;\n\tstruct delayed_work fw_fault_work;\n\tstruct workqueue_struct *fw_fault_work_q;\n\tchar fault_handler_work_q_name[48];\n\n\tu8 flag;\n\tu8 unload;\n\tu8 flag_ieee;\n\tu8 issuepend_done;\n\tu8 disableOnlineCtrlReset;\n\tu8 UnevenSpanSupport;\n\n\tu8 supportmax256vd;\n\tu8 pd_list_not_supported;\n\tu16 fw_supported_vd_count;\n\tu16 fw_supported_pd_count;\n\n\tu16 drv_supported_vd_count;\n\tu16 drv_supported_pd_count;\n\n\tatomic_t adprecovery;\n\tunsigned long last_time;\n\tu32 mfiStatus;\n\tu32 last_seq_num;\n\n\tstruct list_head internal_reset_pending_q;\n\n\t \n\tvoid *ctrl_context;\n\tunsigned int msix_vectors;\n\tstruct megasas_irq_context irq_context[MEGASAS_MAX_MSIX_QUEUES];\n\tu64 map_id;\n\tu64 pd_seq_map_id;\n\tstruct megasas_cmd *map_update_cmd;\n\tstruct megasas_cmd *jbod_seq_cmd;\n\tunsigned long bar;\n\tlong reset_flags;\n\tstruct mutex reset_mutex;\n\tstruct timer_list sriov_heartbeat_timer;\n\tchar skip_heartbeat_timer_del;\n\tu8 requestorId;\n\tchar PlasmaFW111;\n\tchar clusterId[MEGASAS_CLUSTER_ID_SIZE];\n\tu8 peerIsPresent;\n\tu8 passive;\n\tu16 throttlequeuedepth;\n\tu8 mask_interrupts;\n\tu16 max_chain_frame_sz;\n\tu8 is_imr;\n\tu8 is_rdpq;\n\tbool dev_handle;\n\tbool fw_sync_cache_support;\n\tu32 mfi_frame_size;\n\tbool msix_combined;\n\tu16 max_raid_mapsize;\n\t \n\tu8  r1_ldio_hint_default;\n\tu32 nvme_page_size;\n\tu8 adapter_type;\n\tbool consistent_mask_64bit;\n\tbool support_nvme_passthru;\n\tbool enable_sdev_max_qd;\n\tu8 task_abort_tmo;\n\tu8 max_reset_tmo;\n\tu8 snapdump_wait_time;\n#ifdef CONFIG_DEBUG_FS\n\tstruct dentry *debugfs_root;\n\tstruct dentry *raidmap_dump;\n#endif\n\tu8 enable_fw_dev_list;\n\tbool atomic_desc_support;\n\tbool support_seqnum_jbod_fp;\n\tbool support_pci_lane_margining;\n\tu8  low_latency_index_start;\n\tint perf_mode;\n\tint iopoll_q_count;\n};\n\nstruct MR_LD_VF_MAP {\n\tu32 size;\n\tunion MR_LD_REF ref;\n\tu8 ldVfCount;\n\tu8 reserved[6];\n\tu8 policy[1];\n};\n\nstruct MR_LD_VF_AFFILIATION {\n\tu32 size;\n\tu8 ldCount;\n\tu8 vfCount;\n\tu8 thisVf;\n\tu8 reserved[9];\n\tstruct MR_LD_VF_MAP map[1];\n};\n\n \n#define IOV_111_OFFSET 0x7CE\n#define MAX_VIRTUAL_FUNCTIONS 8\n#define MR_LD_ACCESS_HIDDEN 15\n\nstruct IOV_111 {\n\tu8 maxVFsSupported;\n\tu8 numVFsEnabled;\n\tu8 requestorId;\n\tu8 reserved[5];\n};\n\nstruct MR_LD_VF_MAP_111 {\n\tu8 targetId;\n\tu8 reserved[3];\n\tu8 policy[MAX_VIRTUAL_FUNCTIONS];\n};\n\nstruct MR_LD_VF_AFFILIATION_111 {\n\tu8 vdCount;\n\tu8 vfCount;\n\tu8 thisVf;\n\tu8 reserved[5];\n\tstruct MR_LD_VF_MAP_111 map[MAX_LOGICAL_DRIVES];\n};\n\nstruct MR_CTRL_HB_HOST_MEM {\n\tstruct {\n\t\tu32 fwCounter;\t \n\t\tstruct {\n\t\t\tu32 debugmode:1;  \n\t\t\tu32 reserved:31;\n\t\t} debug;\n\t\tu32 reserved_fw[6];\n\t\tu32 driverCounter;  \n\t\tu32 reserved_driver[7];\n\t} HB;\n\tu8 pad[0x400-0x40];\n};\n\nenum {\n\tMEGASAS_HBA_OPERATIONAL\t\t\t= 0,\n\tMEGASAS_ADPRESET_SM_INFAULT\t\t= 1,\n\tMEGASAS_ADPRESET_SM_FW_RESET_SUCCESS\t= 2,\n\tMEGASAS_ADPRESET_SM_OPERATIONAL\t\t= 3,\n\tMEGASAS_HW_CRITICAL_ERROR\t\t= 4,\n\tMEGASAS_ADPRESET_SM_POLLING\t\t= 5,\n\tMEGASAS_ADPRESET_INPROG_SIGN\t\t= 0xDEADDEAD,\n};\n\nstruct megasas_instance_template {\n\tvoid (*fire_cmd)(struct megasas_instance *, dma_addr_t, \\\n\t\tu32, struct megasas_register_set __iomem *);\n\n\tvoid (*enable_intr)(struct megasas_instance *);\n\tvoid (*disable_intr)(struct megasas_instance *);\n\n\tint (*clear_intr)(struct megasas_instance *);\n\n\tu32 (*read_fw_status_reg)(struct megasas_instance *);\n\tint (*adp_reset)(struct megasas_instance *, \\\n\t\tstruct megasas_register_set __iomem *);\n\tint (*check_reset)(struct megasas_instance *, \\\n\t\tstruct megasas_register_set __iomem *);\n\tirqreturn_t (*service_isr)(int irq, void *devp);\n\tvoid (*tasklet)(unsigned long);\n\tu32 (*init_adapter)(struct megasas_instance *);\n\tu32 (*build_and_issue_cmd) (struct megasas_instance *,\n\t\t\t\t    struct scsi_cmnd *);\n\tvoid (*issue_dcmd)(struct megasas_instance *instance,\n\t\t\t    struct megasas_cmd *cmd);\n};\n\n#define MEGASAS_IS_LOGICAL(sdev)\t\t\t\t\t\\\n\t((sdev->channel < MEGASAS_MAX_PD_CHANNELS) ? 0 : 1)\n\n#define MEGASAS_IS_LUN_VALID(sdev)\t\t\t\t\t\\\n\t(((sdev)->lun == 0) ? 1 : 0)\n\n#define MEGASAS_DEV_INDEX(scp)\t\t\t\t\t\t\\\n\t(((scp->device->channel % 2) * MEGASAS_MAX_DEV_PER_CHANNEL) +\t\\\n\tscp->device->id)\n\n#define MEGASAS_PD_INDEX(scp)\t\t\t\t\t\t\\\n\t((scp->device->channel * MEGASAS_MAX_DEV_PER_CHANNEL) +\t\t\\\n\tscp->device->id)\n\nstruct megasas_cmd {\n\n\tunion megasas_frame *frame;\n\tdma_addr_t frame_phys_addr;\n\tu8 *sense;\n\tdma_addr_t sense_phys_addr;\n\n\tu32 index;\n\tu8 sync_cmd;\n\tu8 cmd_status_drv;\n\tu8 abort_aen;\n\tu8 retry_for_fw_reset;\n\n\n\tstruct list_head list;\n\tstruct scsi_cmnd *scmd;\n\tu8 flags;\n\n\tstruct megasas_instance *instance;\n\tunion {\n\t\tstruct {\n\t\t\tu16 smid;\n\t\t\tu16 resvd;\n\t\t} context;\n\t\tu32 frame_count;\n\t};\n};\n\nstruct megasas_cmd_priv {\n\tvoid\t*cmd_priv;\n\tu8\tstatus;\n};\n\nstatic inline struct megasas_cmd_priv *megasas_priv(struct scsi_cmnd *cmd)\n{\n\treturn scsi_cmd_priv(cmd);\n}\n\n#define MAX_MGMT_ADAPTERS\t\t1024\n#define MAX_IOCTL_SGE\t\t\t16\n\nstruct megasas_iocpacket {\n\n\tu16 host_no;\n\tu16 __pad1;\n\tu32 sgl_off;\n\tu32 sge_count;\n\tu32 sense_off;\n\tu32 sense_len;\n\tunion {\n\t\tu8 raw[128];\n\t\tstruct megasas_header hdr;\n\t} frame;\n\n\tstruct iovec sgl[MAX_IOCTL_SGE];\n\n} __attribute__ ((packed));\n\nstruct megasas_aen {\n\tu16 host_no;\n\tu16 __pad1;\n\tu32 seq_num;\n\tu32 class_locale_word;\n} __attribute__ ((packed));\n\nstruct compat_megasas_iocpacket {\n\tu16 host_no;\n\tu16 __pad1;\n\tu32 sgl_off;\n\tu32 sge_count;\n\tu32 sense_off;\n\tu32 sense_len;\n\tunion {\n\t\tu8 raw[128];\n\t\tstruct megasas_header hdr;\n\t} frame;\n\tstruct compat_iovec sgl[MAX_IOCTL_SGE];\n} __attribute__ ((packed));\n\n#define MEGASAS_IOC_FIRMWARE32\t_IOWR('M', 1, struct compat_megasas_iocpacket)\n\n#define MEGASAS_IOC_FIRMWARE\t_IOWR('M', 1, struct megasas_iocpacket)\n#define MEGASAS_IOC_GET_AEN\t_IOW('M', 3, struct megasas_aen)\n\nstruct megasas_mgmt_info {\n\n\tu16 count;\n\tstruct megasas_instance *instance[MAX_MGMT_ADAPTERS];\n\tint max_index;\n};\n\nenum MEGASAS_OCR_CAUSE {\n\tFW_FAULT_OCR\t\t\t= 0,\n\tSCSIIO_TIMEOUT_OCR\t\t= 1,\n\tMFI_IO_TIMEOUT_OCR\t\t= 2,\n};\n\nenum DCMD_RETURN_STATUS {\n\tDCMD_SUCCESS    = 0x00,\n\tDCMD_TIMEOUT    = 0x01,\n\tDCMD_FAILED     = 0x02,\n\tDCMD_BUSY       = 0x03,\n\tDCMD_INIT       = 0xff,\n};\n\nu8\nMR_BuildRaidContext(struct megasas_instance *instance,\n\t\t    struct IO_REQUEST_INFO *io_info,\n\t\t    struct RAID_CONTEXT *pRAID_Context,\n\t\t    struct MR_DRV_RAID_MAP_ALL *map, u8 **raidLUN);\nu16 MR_TargetIdToLdGet(u32 ldTgtId, struct MR_DRV_RAID_MAP_ALL *map);\nstruct MR_LD_RAID *MR_LdRaidGet(u32 ld, struct MR_DRV_RAID_MAP_ALL *map);\nu16 MR_ArPdGet(u32 ar, u32 arm, struct MR_DRV_RAID_MAP_ALL *map);\nu16 MR_LdSpanArrayGet(u32 ld, u32 span, struct MR_DRV_RAID_MAP_ALL *map);\n__le16 MR_PdDevHandleGet(u32 pd, struct MR_DRV_RAID_MAP_ALL *map);\nu16 MR_GetLDTgtId(u32 ld, struct MR_DRV_RAID_MAP_ALL *map);\n\n__le16 get_updated_dev_handle(struct megasas_instance *instance,\n\t\t\t      struct LD_LOAD_BALANCE_INFO *lbInfo,\n\t\t\t      struct IO_REQUEST_INFO *in_info,\n\t\t\t      struct MR_DRV_RAID_MAP_ALL *drv_map);\nvoid mr_update_load_balance_params(struct MR_DRV_RAID_MAP_ALL *map,\n\tstruct LD_LOAD_BALANCE_INFO *lbInfo);\nint megasas_get_ctrl_info(struct megasas_instance *instance);\n \nint\nmegasas_sync_pd_seq_num(struct megasas_instance *instance, bool pend);\nvoid megasas_set_dynamic_target_properties(struct scsi_device *sdev,\n\t\t\t\t\t   bool is_target_prop);\nint megasas_get_target_prop(struct megasas_instance *instance,\n\t\t\t    struct scsi_device *sdev);\nvoid megasas_get_snapdump_properties(struct megasas_instance *instance);\n\nint megasas_set_crash_dump_params(struct megasas_instance *instance,\n\tu8 crash_buf_state);\nvoid megasas_free_host_crash_buffer(struct megasas_instance *instance);\n\nvoid megasas_return_cmd_fusion(struct megasas_instance *instance,\n\tstruct megasas_cmd_fusion *cmd);\nint megasas_issue_blocked_cmd(struct megasas_instance *instance,\n\tstruct megasas_cmd *cmd, int timeout);\nvoid __megasas_return_cmd(struct megasas_instance *instance,\n\tstruct megasas_cmd *cmd);\n\nvoid megasas_return_mfi_mpt_pthr(struct megasas_instance *instance,\n\tstruct megasas_cmd *cmd_mfi, struct megasas_cmd_fusion *cmd_fusion);\nint megasas_cmd_type(struct scsi_cmnd *cmd);\nvoid megasas_setup_jbod_map(struct megasas_instance *instance);\n\nvoid megasas_update_sdev_properties(struct scsi_device *sdev);\nint megasas_reset_fusion(struct Scsi_Host *shost, int reason);\nint megasas_task_abort_fusion(struct scsi_cmnd *scmd);\nint megasas_reset_target_fusion(struct scsi_cmnd *scmd);\nu32 mega_mod64(u64 dividend, u32 divisor);\nint megasas_alloc_fusion_context(struct megasas_instance *instance);\nvoid megasas_free_fusion_context(struct megasas_instance *instance);\nint megasas_fusion_start_watchdog(struct megasas_instance *instance);\nvoid megasas_fusion_stop_watchdog(struct megasas_instance *instance);\n\nvoid megasas_set_dma_settings(struct megasas_instance *instance,\n\t\t\t      struct megasas_dcmd_frame *dcmd,\n\t\t\t      dma_addr_t dma_addr, u32 dma_len);\nint megasas_adp_reset_wait_for_ready(struct megasas_instance *instance,\n\t\t\t\t     bool do_adp_reset,\n\t\t\t\t     int ocr_context);\nint megasas_irqpoll(struct irq_poll *irqpoll, int budget);\nvoid megasas_dump_fusion_io(struct scsi_cmnd *scmd);\nu32 megasas_readl(struct megasas_instance *instance,\n\t\t  const volatile void __iomem *addr);\nstruct megasas_cmd *megasas_get_cmd(struct megasas_instance *instance);\nvoid megasas_return_cmd(struct megasas_instance *instance,\n\t\t\tstruct megasas_cmd *cmd);\nint megasas_issue_polled(struct megasas_instance *instance,\n\t\t\t struct megasas_cmd *cmd);\nvoid megaraid_sas_kill_hba(struct megasas_instance *instance);\nvoid megasas_check_and_restore_queue_depth(struct megasas_instance *instance);\nvoid megasas_start_timer(struct megasas_instance *instance);\nint megasas_sriov_start_heartbeat(struct megasas_instance *instance,\n\t\t\t\t  int initial);\nint megasas_alloc_cmds(struct megasas_instance *instance);\nvoid megasas_free_cmds(struct megasas_instance *instance);\n\nvoid megasas_init_debugfs(void);\nvoid megasas_exit_debugfs(void);\nvoid megasas_setup_debugfs(struct megasas_instance *instance);\nvoid megasas_destroy_debugfs(struct megasas_instance *instance);\nint megasas_blk_mq_poll(struct Scsi_Host *shost, unsigned int queue_num);\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}