{
  "module_name": "mpi30_image.h",
  "hash_id": "62b986aa78d96437baab36d897eed01a9e1ee0c591f1a024c58235999a300194",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/mpi3mr/mpi/mpi30_image.h",
  "human_readable_source": " \n \n#ifndef MPI30_IMAGE_H\n#define MPI30_IMAGE_H     1\nstruct mpi3_comp_image_version {\n\t__le16     build_num;\n\t__le16     customer_id;\n\tu8         phase_minor;\n\tu8         phase_major;\n\tu8         gen_minor;\n\tu8         gen_major;\n};\n\nstruct mpi3_hash_exclusion_format {\n\t__le32                     offset;\n\t__le32                     size;\n};\n\n#define MPI3_IMAGE_HASH_EXCUSION_NUM                           (4)\nstruct mpi3_component_image_header {\n\t__le32                            signature0;\n\t__le32                            load_address;\n\t__le32                            data_size;\n\t__le32                            start_offset;\n\t__le32                            signature1;\n\t__le32                            flash_offset;\n\t__le32                            image_size;\n\t__le32                            version_string_offset;\n\t__le32                            build_date_string_offset;\n\t__le32                            build_time_string_offset;\n\t__le32                            environment_variable_offset;\n\t__le32                            application_specific;\n\t__le32                            signature2;\n\t__le32                            header_size;\n\t__le32                            crc;\n\t__le32                            flags;\n\t__le32                            secondary_flash_offset;\n\t__le32                            etp_offset;\n\t__le32                            etp_size;\n\tunion mpi3_version_union             rmc_interface_version;\n\tunion mpi3_version_union             etp_interface_version;\n\tstruct mpi3_comp_image_version        component_image_version;\n\tstruct mpi3_hash_exclusion_format     hash_exclusion[MPI3_IMAGE_HASH_EXCUSION_NUM];\n\t__le32                            next_image_header_offset;\n\tunion mpi3_version_union             security_version;\n\t__le32                            reserved84[31];\n};\n\n#define MPI3_IMAGE_HEADER_SIGNATURE0_MPI3                     (0xeb00003e)\n#define MPI3_IMAGE_HEADER_LOAD_ADDRESS_INVALID                (0x00000000)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_APPLICATION              (0x20505041)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_FIRST_MUTABLE            (0x20434d46)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_BSP                      (0x20505342)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_ROM_BIOS                 (0x534f4942)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_HII_X64                  (0x4d494948)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_HII_ARM                  (0x41494948)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_CPLD                     (0x444c5043)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_SPD                      (0x20445053)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_GAS_GAUGE                (0x20534147)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_PBLP                     (0x504c4250)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_MANIFEST                 (0x464e414d)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_OEM                      (0x204d454f)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_RMC                      (0x20434d52)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_SMM                      (0x204d4d53)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_PSW                      (0x20575350)\n#define MPI3_IMAGE_HEADER_SIGNATURE2_VALUE                    (0x50584546)\n#define MPI3_IMAGE_HEADER_FLAGS_DEVICE_KEY_BASIS_MASK         (0x00000030)\n#define MPI3_IMAGE_HEADER_FLAGS_DEVICE_KEY_BASIS_CDI          (0x00000000)\n#define MPI3_IMAGE_HEADER_FLAGS_DEVICE_KEY_BASIS_DI           (0x00000010)\n#define MPI3_IMAGE_HEADER_FLAGS_SIGNED_NVDATA                 (0x00000008)\n#define MPI3_IMAGE_HEADER_FLAGS_REQUIRES_ACTIVATION           (0x00000004)\n#define MPI3_IMAGE_HEADER_FLAGS_COMPRESSED                    (0x00000002)\n#define MPI3_IMAGE_HEADER_FLAGS_FLASH                         (0x00000001)\n#define MPI3_IMAGE_HEADER_SIGNATURE0_OFFSET                   (0x00)\n#define MPI3_IMAGE_HEADER_LOAD_ADDRESS_OFFSET                 (0x04)\n#define MPI3_IMAGE_HEADER_DATA_SIZE_OFFSET                    (0x08)\n#define MPI3_IMAGE_HEADER_START_OFFSET_OFFSET                 (0x0c)\n#define MPI3_IMAGE_HEADER_SIGNATURE1_OFFSET                   (0x10)\n#define MPI3_IMAGE_HEADER_FLASH_OFFSET_OFFSET                 (0x14)\n#define MPI3_IMAGE_HEADER_FLASH_SIZE_OFFSET                   (0x18)\n#define MPI3_IMAGE_HEADER_VERSION_STRING_OFFSET_OFFSET        (0x1c)\n#define MPI3_IMAGE_HEADER_BUILD_DATE_STRING_OFFSET_OFFSET     (0x20)\n#define MPI3_IMAGE_HEADER_BUILD_TIME_OFFSET_OFFSET            (0x24)\n#define MPI3_IMAGE_HEADER_ENVIROMENT_VAR_OFFSET_OFFSET        (0x28)\n#define MPI3_IMAGE_HEADER_APPLICATION_SPECIFIC_OFFSET         (0x2c)\n#define MPI3_IMAGE_HEADER_SIGNATURE2_OFFSET                   (0x30)\n#define MPI3_IMAGE_HEADER_HEADER_SIZE_OFFSET                  (0x34)\n#define MPI3_IMAGE_HEADER_CRC_OFFSET                          (0x38)\n#define MPI3_IMAGE_HEADER_FLAGS_OFFSET                        (0x3c)\n#define MPI3_IMAGE_HEADER_SECONDARY_FLASH_OFFSET_OFFSET       (0x40)\n#define MPI3_IMAGE_HEADER_ETP_OFFSET_OFFSET                   (0x44)\n#define MPI3_IMAGE_HEADER_ETP_SIZE_OFFSET                     (0x48)\n#define MPI3_IMAGE_HEADER_RMC_INTERFACE_VER_OFFSET            (0x4c)\n#define MPI3_IMAGE_HEADER_ETP_INTERFACE_VER_OFFSET            (0x50)\n#define MPI3_IMAGE_HEADER_COMPONENT_IMAGE_VER_OFFSET          (0x54)\n#define MPI3_IMAGE_HEADER_HASH_EXCLUSION_OFFSET               (0x5c)\n#define MPI3_IMAGE_HEADER_NEXT_IMAGE_HEADER_OFFSET_OFFSET     (0x7c)\n#define MPI3_IMAGE_HEADER_SIZE                                (0x100)\n#ifndef MPI3_CI_MANIFEST_MPI_MAX\n#define MPI3_CI_MANIFEST_MPI_MAX                               (1)\n#endif\nstruct mpi3_ci_manifest_mpi_comp_image_ref {\n\t__le32                                signature1;\n\t__le32                                reserved04[3];\n\tstruct mpi3_comp_image_version            component_image_version;\n\t__le32                                component_image_version_string_offset;\n\t__le32                                crc;\n};\n\nstruct mpi3_ci_manifest_mpi {\n\tu8                                       manifest_type;\n\tu8                                       reserved01[3];\n\t__le32                                   reserved04[3];\n\tu8                                       num_image_references;\n\tu8                                       release_level;\n\t__le16                                   reserved12;\n\t__le16                                   reserved14;\n\t__le16                                   flags;\n\t__le32                                   reserved18[2];\n\t__le16                                   vendor_id;\n\t__le16                                   device_id;\n\t__le16                                   subsystem_vendor_id;\n\t__le16                                   subsystem_id;\n\t__le32                                   reserved28[2];\n\tunion mpi3_version_union                    package_security_version;\n\t__le32                                   reserved34;\n\tstruct mpi3_comp_image_version               package_version;\n\t__le32                                   package_version_string_offset;\n\t__le32                                   package_build_date_string_offset;\n\t__le32                                   package_build_time_string_offset;\n\t__le32                                   reserved4c;\n\t__le32                                   diag_authorization_identifier[16];\n\tstruct mpi3_ci_manifest_mpi_comp_image_ref   component_image_ref[MPI3_CI_MANIFEST_MPI_MAX];\n};\n\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_DEV                        (0x00)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_PREALPHA                   (0x10)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_ALPHA                      (0x20)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_BETA                       (0x30)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_RC                         (0x40)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_GCA                        (0x50)\n#define MPI3_CI_MANIFEST_MPI_RELEASE_LEVEL_POINT                      (0x60)\n#define MPI3_CI_MANIFEST_MPI_FLAGS_DIAG_AUTHORIZATION                 (0x01)\n#define MPI3_CI_MANIFEST_MPI_SUBSYSTEMID_IGNORED                   (0xffff)\n#define MPI3_CI_MANIFEST_MPI_PKG_VER_STR_OFF_UNSPECIFIED           (0x00000000)\n#define MPI3_CI_MANIFEST_MPI_PKG_BUILD_DATE_STR_OFF_UNSPECIFIED    (0x00000000)\n#define MPI3_CI_MANIFEST_MPI_PKG_BUILD_TIME_STR_OFF_UNSPECIFIED    (0x00000000)\nunion mpi3_ci_manifest {\n\tstruct mpi3_ci_manifest_mpi               mpi;\n\t__le32                                dword[1];\n};\n\n#define MPI3_CI_MANIFEST_TYPE_MPI                                  (0x00)\nstruct mpi3_extended_image_header {\n\tu8                                image_type;\n\tu8                                reserved01[3];\n\t__le32                            checksum;\n\t__le32                            image_size;\n\t__le32                            next_image_header_offset;\n\t__le32                            reserved10[4];\n\t__le32                            identify_string[8];\n};\n\n#define MPI3_EXT_IMAGE_IMAGETYPE_OFFSET         (0x00)\n#define MPI3_EXT_IMAGE_IMAGESIZE_OFFSET         (0x08)\n#define MPI3_EXT_IMAGE_NEXTIMAGE_OFFSET         (0x0c)\n#define MPI3_EXT_IMAGE_HEADER_SIZE              (0x40)\n#define MPI3_EXT_IMAGE_TYPE_UNSPECIFIED             (0x00)\n#define MPI3_EXT_IMAGE_TYPE_NVDATA                  (0x03)\n#define MPI3_EXT_IMAGE_TYPE_SUPPORTED_DEVICES       (0x07)\n#define MPI3_EXT_IMAGE_TYPE_ENCRYPTED_HASH          (0x09)\n#define MPI3_EXT_IMAGE_TYPE_RDE                     (0x0a)\n#define MPI3_EXT_IMAGE_TYPE_AUXILIARY_PROCESSOR     (0x0b)\n#define MPI3_EXT_IMAGE_TYPE_MIN_PRODUCT_SPECIFIC    (0x80)\n#define MPI3_EXT_IMAGE_TYPE_MAX_PRODUCT_SPECIFIC    (0xff)\nstruct mpi3_supported_device {\n\t__le16                     device_id;\n\t__le16                     vendor_id;\n\t__le16                     device_id_mask;\n\t__le16                     reserved06;\n\tu8                         low_pci_rev;\n\tu8                         high_pci_rev;\n\t__le16                     reserved0a;\n\t__le32                     reserved0c;\n};\n\n#ifndef MPI3_SUPPORTED_DEVICE_MAX\n#define MPI3_SUPPORTED_DEVICE_MAX                      (1)\n#endif\nstruct mpi3_supported_devices_data {\n\tu8                         image_version;\n\tu8                         reserved01;\n\tu8                         num_devices;\n\tu8                         reserved03;\n\t__le32                     reserved04;\n\tstruct mpi3_supported_device   supported_device[MPI3_SUPPORTED_DEVICE_MAX];\n};\n\n#ifndef MPI3_ENCRYPTED_HASH_MAX\n#define MPI3_ENCRYPTED_HASH_MAX                      (1)\n#endif\nstruct mpi3_encrypted_hash_entry {\n\tu8                         hash_image_type;\n\tu8                         hash_algorithm;\n\tu8                         encryption_algorithm;\n\tu8                         reserved03;\n\t__le32                     reserved04;\n\t__le32                     encrypted_hash[MPI3_ENCRYPTED_HASH_MAX];\n};\n\n#define MPI3_HASH_IMAGE_TYPE_KEY_WITH_SIGNATURE      (0x03)\n#define MPI3_HASH_ALGORITHM_VERSION_MASK             (0xe0)\n#define MPI3_HASH_ALGORITHM_VERSION_NONE             (0x00)\n#define MPI3_HASH_ALGORITHM_VERSION_SHA1             (0x20)\n#define MPI3_HASH_ALGORITHM_VERSION_SHA2             (0x40)\n#define MPI3_HASH_ALGORITHM_VERSION_SHA3             (0x60)\n#define MPI3_HASH_ALGORITHM_SIZE_MASK                (0x1f)\n#define MPI3_HASH_ALGORITHM_SIZE_UNUSED              (0x00)\n#define MPI3_HASH_ALGORITHM_SIZE_SHA256              (0x01)\n#define MPI3_HASH_ALGORITHM_SIZE_SHA512              (0x02)\n#define MPI3_HASH_ALGORITHM_SIZE_SHA384              (0x03)\n#define MPI3_ENCRYPTION_ALGORITHM_UNUSED             (0x00)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA256             (0x01)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA512             (0x02)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA1024            (0x03)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA2048            (0x04)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA4096            (0x05)\n#define MPI3_ENCRYPTION_ALGORITHM_RSA3072            (0x06)\n#ifndef MPI3_PUBLIC_KEY_MAX\n#define MPI3_PUBLIC_KEY_MAX                          (1)\n#endif\nstruct mpi3_encrypted_key_with_hash_entry {\n\tu8                         hash_image_type;\n\tu8                         hash_algorithm;\n\tu8                         encryption_algorithm;\n\tu8                         reserved03;\n\t__le32                     reserved04;\n\t__le32                     public_key[MPI3_PUBLIC_KEY_MAX];\n};\n\n#ifndef MPI3_ENCRYPTED_HASH_ENTRY_MAX\n#define MPI3_ENCRYPTED_HASH_ENTRY_MAX               (1)\n#endif\nstruct mpi3_encrypted_hash_data {\n\tu8                                  image_version;\n\tu8                                  num_hash;\n\t__le16                              reserved02;\n\t__le32                              reserved04;\n\tstruct mpi3_encrypted_hash_entry        encrypted_hash_entry[MPI3_ENCRYPTED_HASH_ENTRY_MAX];\n};\n\n#ifndef MPI3_AUX_PROC_DATA_MAX\n#define MPI3_AUX_PROC_DATA_MAX               (1)\n#endif\nstruct mpi3_aux_processor_data {\n\tu8                         boot_method;\n\tu8                         num_load_addr;\n\tu8                         reserved02;\n\tu8                         type;\n\t__le32                     version;\n\t__le32                     load_address[8];\n\t__le32                     reserved28[22];\n\t__le32                     aux_processor_data[MPI3_AUX_PROC_DATA_MAX];\n};\n\n#define MPI3_AUX_PROC_DATA_OFFSET                                     (0x80)\n#define MPI3_AUXPROCESSOR_BOOT_METHOD_MO_MSG                          (0x00)\n#define MPI3_AUXPROCESSOR_BOOT_METHOD_MO_DOORBELL                     (0x01)\n#define MPI3_AUXPROCESSOR_BOOT_METHOD_COMPONENT                       (0x02)\n#define MPI3_AUXPROCESSOR_TYPE_ARM_A15                                (0x00)\n#define MPI3_AUXPROCESSOR_TYPE_ARM_M0                                 (0x01)\n#define MPI3_AUXPROCESSOR_TYPE_ARM_R4                                 (0x02)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}