{
  "module_name": "remote_device.h",
  "hash_id": "18689bf4d95ed97be722d8591bee43cca8d15090af134d728e57625851ee8331",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/isci/remote_device.h",
  "human_readable_source": " \n\n#ifndef _ISCI_REMOTE_DEVICE_H_\n#define _ISCI_REMOTE_DEVICE_H_\n#include <scsi/libsas.h>\n#include <linux/kref.h>\n#include \"scu_remote_node_context.h\"\n#include \"remote_node_context.h\"\n#include \"port.h\"\n\nenum sci_remote_device_not_ready_reason_code {\n\tSCIC_REMOTE_DEVICE_NOT_READY_START_REQUESTED,\n\tSCIC_REMOTE_DEVICE_NOT_READY_STOP_REQUESTED,\n\tSCIC_REMOTE_DEVICE_NOT_READY_SATA_REQUEST_STARTED,\n\tSCIC_REMOTE_DEVICE_NOT_READY_SATA_SDB_ERROR_FIS_RECEIVED,\n\tSCIC_REMOTE_DEVICE_NOT_READY_SMP_REQUEST_STARTED,\n\tSCIC_REMOTE_DEVICE_NOT_READY_REASON_CODE_MAX\n};\n\n \nstruct isci_remote_device {\n\t#define IDEV_START_PENDING 0\n\t#define IDEV_STOP_PENDING 1\n\t#define IDEV_ALLOCATED 2\n\t#define IDEV_GONE 3\n\t#define IDEV_IO_READY 4\n\t#define IDEV_IO_NCQERROR 5\n\t#define IDEV_RNC_LLHANG_ENABLED 6\n\t#define IDEV_ABORT_PATH_ACTIVE 7\n\t#define IDEV_ABORT_PATH_RESUME_PENDING 8\n\tunsigned long flags;\n\tstruct kref kref;\n\tstruct isci_port *isci_port;\n\tstruct domain_device *domain_dev;\n\tstruct list_head node;\n\tstruct sci_base_state_machine sm;\n\tu32 device_port_width;\n\tenum sas_linkrate connection_rate;\n\tstruct isci_port *owning_port;\n\tstruct sci_remote_node_context rnc;\n\t \n\tu32 started_request_count;\n\tstruct isci_request *working_request;\n\tu32 not_ready_reason;\n\tscics_sds_remote_node_context_callback abort_resume_cb;\n\tvoid *abort_resume_cbparam;\n};\n\n#define ISCI_REMOTE_DEVICE_START_TIMEOUT 5000\n\n \nstatic inline struct isci_remote_device *isci_get_device(\n\tstruct isci_remote_device *idev)\n{\n\tif (idev)\n\t\tkref_get(&idev->kref);\n\treturn idev;\n}\n\nstatic inline struct isci_remote_device *isci_lookup_device(struct domain_device *dev)\n{\n\tstruct isci_remote_device *idev = dev->lldd_dev;\n\n\tif (idev && !test_bit(IDEV_GONE, &idev->flags)) {\n\t\tkref_get(&idev->kref);\n\t\treturn idev;\n\t}\n\n\treturn NULL;\n}\n\nvoid isci_remote_device_release(struct kref *kref);\nstatic inline void isci_put_device(struct isci_remote_device *idev)\n{\n\tif (idev)\n\t\tkref_put(&idev->kref, isci_remote_device_release);\n}\n\nenum sci_status isci_remote_device_stop(struct isci_host *ihost,\n\t\t\t\t\tstruct isci_remote_device *idev);\nvoid isci_remote_device_nuke_requests(struct isci_host *ihost,\n\t\t\t\t      struct isci_remote_device *idev);\nvoid isci_remote_device_gone(struct domain_device *domain_dev);\nint isci_remote_device_found(struct domain_device *domain_dev);\n\n \nenum sci_status sci_remote_device_stop(\n\tstruct isci_remote_device *idev,\n\tu32 timeout);\n\n \nenum sci_status sci_remote_device_reset(\n\tstruct isci_remote_device *idev);\n\n \nenum sci_status sci_remote_device_reset_complete(\n\tstruct isci_remote_device *idev);\n\n \n#define REMOTE_DEV_STATES {\\\n\tC(DEV_INITIAL),\\\n\tC(DEV_STOPPED),\\\n\tC(DEV_STARTING),\\\n\tC(DEV_READY),\\\n\tC(STP_DEV_IDLE),\\\n\tC(STP_DEV_CMD),\\\n\tC(STP_DEV_NCQ),\\\n\tC(STP_DEV_NCQ_ERROR),\\\n\tC(STP_DEV_ATAPI_ERROR),\\\n\tC(STP_DEV_AWAIT_RESET),\\\n\tC(SMP_DEV_IDLE),\\\n\tC(SMP_DEV_CMD),\\\n\tC(DEV_STOPPING),\\\n\tC(DEV_FAILED),\\\n\tC(DEV_RESETTING),\\\n\tC(DEV_FINAL),\\\n\t}\n#undef C\n#define C(a) SCI_##a\nenum sci_remote_device_states REMOTE_DEV_STATES;\n#undef C\nconst char *dev_state_name(enum sci_remote_device_states state);\n\nstatic inline struct isci_remote_device *rnc_to_dev(struct sci_remote_node_context *rnc)\n{\n\tstruct isci_remote_device *idev;\n\n\tidev = container_of(rnc, typeof(*idev), rnc);\n\n\treturn idev;\n}\n\nstatic inline void sci_remote_device_decrement_request_count(struct isci_remote_device *idev)\n{\n\t \n\tif (WARN_ONCE(idev->started_request_count == 0,\n\t\t      \"%s: tried to decrement started_request_count past 0!?\",\n\t\t\t__func__))\n\t\t ;\n\telse\n\t\tidev->started_request_count--;\n}\n\nvoid isci_dev_set_hang_detection_timeout(struct isci_remote_device *idev, u32 timeout);\n\nenum sci_status sci_remote_device_frame_handler(\n\tstruct isci_remote_device *idev,\n\tu32 frame_index);\n\nenum sci_status sci_remote_device_event_handler(\n\tstruct isci_remote_device *idev,\n\tu32 event_code);\n\nenum sci_status sci_remote_device_start_io(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev,\n\tstruct isci_request *ireq);\n\nenum sci_status sci_remote_device_start_task(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev,\n\tstruct isci_request *ireq);\n\nenum sci_status sci_remote_device_complete_io(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev,\n\tstruct isci_request *ireq);\n\nvoid sci_remote_device_post_request(\n\tstruct isci_remote_device *idev,\n\tu32 request);\n\nenum sci_status sci_remote_device_terminate_requests(\n\tstruct isci_remote_device *idev);\n\nint isci_remote_device_is_safe_to_abort(\n\tstruct isci_remote_device *idev);\n\nenum sci_status\nsci_remote_device_abort_requests_pending_abort(\n\tstruct isci_remote_device *idev);\n\nenum sci_status isci_remote_device_suspend(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev);\n\nenum sci_status sci_remote_device_resume(\n\tstruct isci_remote_device *idev,\n\tscics_sds_remote_node_context_callback cb_fn,\n\tvoid *cb_p);\n\nenum sci_status isci_remote_device_resume_from_abort(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev);\n\nenum sci_status isci_remote_device_reset(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev);\n\nenum sci_status isci_remote_device_reset_complete(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev);\n\nenum sci_status isci_remote_device_suspend_terminate(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev,\n\tstruct isci_request *ireq);\n\nenum sci_status isci_remote_device_terminate_requests(\n\tstruct isci_host *ihost,\n\tstruct isci_remote_device *idev,\n\tstruct isci_request *ireq);\nenum sci_status sci_remote_device_suspend(struct isci_remote_device *idev,\n\t\t\t\t\t  enum sci_remote_node_suspension_reasons reason);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}