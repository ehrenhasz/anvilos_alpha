{
  "module_name": "phy.h",
  "hash_id": "13a6bfc1c98991b5e28bb4cb0fbf3304d01fe98b0e103be85a7b7a39d53fc569",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/isci/phy.h",
  "human_readable_source": " \n#ifndef _ISCI_PHY_H_\n#define _ISCI_PHY_H_\n\n#include <scsi/sas.h>\n#include <scsi/libsas.h>\n#include \"isci.h\"\n#include \"sas.h\"\n\n \n#define SCIC_SDS_SIGNATURE_FIS_TIMEOUT    25000\n\n \n#define SCIC_SDS_SATA_LINK_TRAINING_TIMEOUT  250\n\n \nstruct isci_phy {\n\tstruct sci_base_state_machine sm;\n\tstruct isci_port *owning_port;\n\tenum sas_linkrate max_negotiated_speed;\n\tenum sas_protocol protocol;\n\tu8 phy_index;\n\tbool bcn_received_while_port_unassigned;\n\tbool is_in_link_training;\n\tstruct sci_timer sata_timer;\n\tstruct scu_transport_layer_registers __iomem *transport_layer_registers;\n\tstruct scu_link_layer_registers __iomem *link_layer_registers;\n\tstruct asd_sas_phy sas_phy;\n\tu8 sas_addr[SAS_ADDR_SIZE];\n\tunion {\n\t\tstruct sas_identify_frame iaf;\n\t\tstruct dev_to_host_fis fis;\n\t} frame_rcvd;\n};\n\nstatic inline struct isci_phy *to_iphy(struct asd_sas_phy *sas_phy)\n{\n\tstruct isci_phy *iphy = container_of(sas_phy, typeof(*iphy), sas_phy);\n\n\treturn iphy;\n}\n\nstruct sci_phy_cap {\n\tunion {\n\t\tstruct {\n\t\t\t \n\t\t\tu8 start:1;\n\t\t\tu8 tx_ssc_type:1;\n\t\t\tu8 res1:2;\n\t\t\tu8 req_logical_linkrate:4;\n\n\t\t\tu32 gen1_no_ssc:1;\n\t\t\tu32 gen1_ssc:1;\n\t\t\tu32 gen2_no_ssc:1;\n\t\t\tu32 gen2_ssc:1;\n\t\t\tu32 gen3_no_ssc:1;\n\t\t\tu32 gen3_ssc:1;\n\t\t\tu32 res2:17;\n\t\t\tu32 parity:1;\n\t\t};\n\t\tu32 all;\n\t};\n}  __packed;\n\n \nstruct sci_phy_proto {\n\tunion {\n\t\tstruct {\n\t\t\tu16 _r_a:1;\n\t\t\tu16 smp_iport:1;\n\t\t\tu16 stp_iport:1;\n\t\t\tu16 ssp_iport:1;\n\t\t\tu16 _r_b:4;\n\t\t\tu16 _r_c:1;\n\t\t\tu16 smp_tport:1;\n\t\t\tu16 stp_tport:1;\n\t\t\tu16 ssp_tport:1;\n\t\t\tu16 _r_d:4;\n\t\t};\n\t\tu16 all;\n\t};\n} __packed;\n\n\n \nstruct sci_phy_properties {\n\t \n\tstruct isci_port *iport;\n\n\t \n\tenum sas_linkrate negotiated_link_rate;\n\n\t \n\tu8 index;\n};\n\n \nstruct sci_sas_phy_properties {\n\t \n\tstruct sas_identify_frame rcvd_iaf;\n\n\t \n\tstruct sci_phy_cap rcvd_cap;\n\n};\n\n \nstruct sci_sata_phy_properties {\n\t \n\tstruct dev_to_host_fis signature_fis;\n\n\t \n\tbool is_port_selector_present;\n\n};\n\n \nenum sci_phy_counter_id {\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_FRAME,\n\n\t \n\tSCIC_PHY_COUNTER_TRANSMITTED_FRAME,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_FRAME_WORD,\n\n\t \n\tSCIC_PHY_COUNTER_TRANSMITTED_FRAME_DWORD,\n\n\t \n\tSCIC_PHY_COUNTER_LOSS_OF_SYNC_ERROR,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_DISPARITY_ERROR,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_FRAME_CRC_ERROR,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_DONE_ACK_NAK_TIMEOUT,\n\n\t \n\tSCIC_PHY_COUNTER_TRANSMITTED_DONE_ACK_NAK_TIMEOUT,\n\n\t \n\tSCIC_PHY_COUNTER_INACTIVITY_TIMER_EXPIRED,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_DONE_CREDIT_TIMEOUT,\n\n\t \n\tSCIC_PHY_COUNTER_TRANSMITTED_DONE_CREDIT_TIMEOUT,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_CREDIT_BLOCKED,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_SHORT_FRAME,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_FRAME_WITHOUT_CREDIT,\n\n\t \n\tSCIC_PHY_COUNTER_RECEIVED_FRAME_AFTER_DONE,\n\n\t \n\tSCIC_PHY_COUNTER_SN_DWORD_SYNC_ERROR\n};\n\n \n#define PHY_STATES {\\\n\tC(PHY_INITIAL),\\\n\tC(PHY_STOPPED),\\\n\tC(PHY_STARTING),\\\n\tC(PHY_SUB_INITIAL),\\\n\tC(PHY_SUB_AWAIT_OSSP_EN),\\\n\tC(PHY_SUB_AWAIT_SAS_SPEED_EN),\\\n\tC(PHY_SUB_AWAIT_IAF_UF),\\\n\tC(PHY_SUB_AWAIT_SAS_POWER),\\\n\tC(PHY_SUB_AWAIT_SATA_POWER),\\\n\tC(PHY_SUB_AWAIT_SATA_PHY_EN),\\\n\tC(PHY_SUB_AWAIT_SATA_SPEED_EN),\\\n\tC(PHY_SUB_AWAIT_SIG_FIS_UF),\\\n\tC(PHY_SUB_FINAL),\\\n\tC(PHY_READY),\\\n\tC(PHY_RESETTING),\\\n\tC(PHY_FINAL),\\\n\t}\n#undef C\n#define C(a) SCI_##a\nenum sci_phy_states PHY_STATES;\n#undef C\n\nvoid sci_phy_construct(\n\tstruct isci_phy *iphy,\n\tstruct isci_port *iport,\n\tu8 phy_index);\n\nstruct isci_port *phy_get_non_dummy_port(struct isci_phy *iphy);\n\nvoid sci_phy_set_port(\n\tstruct isci_phy *iphy,\n\tstruct isci_port *iport);\n\nenum sci_status sci_phy_initialize(\n\tstruct isci_phy *iphy,\n\tstruct scu_transport_layer_registers __iomem *transport_layer_registers,\n\tstruct scu_link_layer_registers __iomem *link_layer_registers);\n\nenum sci_status sci_phy_start(\n\tstruct isci_phy *iphy);\n\nenum sci_status sci_phy_stop(\n\tstruct isci_phy *iphy);\n\nenum sci_status sci_phy_reset(\n\tstruct isci_phy *iphy);\n\nvoid sci_phy_resume(\n\tstruct isci_phy *iphy);\n\nvoid sci_phy_setup_transport(\n\tstruct isci_phy *iphy,\n\tu32 device_id);\n\nenum sci_status sci_phy_event_handler(\n\tstruct isci_phy *iphy,\n\tu32 event_code);\n\nenum sci_status sci_phy_frame_handler(\n\tstruct isci_phy *iphy,\n\tu32 frame_index);\n\nenum sci_status sci_phy_consume_power_handler(\n\tstruct isci_phy *iphy);\n\nvoid sci_phy_get_sas_address(\n\tstruct isci_phy *iphy,\n\tstruct sci_sas_address *sas_address);\n\nvoid sci_phy_get_attached_sas_address(\n\tstruct isci_phy *iphy,\n\tstruct sci_sas_address *sas_address);\n\nvoid sci_phy_get_protocols(\n\tstruct isci_phy *iphy,\n\tstruct sci_phy_proto *protocols);\nenum sas_linkrate sci_phy_linkrate(struct isci_phy *iphy);\n\nstruct isci_host;\nvoid isci_phy_init(struct isci_phy *iphy, struct isci_host *ihost, int index);\nint isci_phy_control(struct asd_sas_phy *phy, enum phy_func func, void *buf);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}