{
  "module_name": "bnx2i_sysfs.c",
  "hash_id": "034e1836f66205fcbf4ea1011473129904ed95a6541eca5e0e521933ca5db275",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/bnx2i/bnx2i_sysfs.c",
  "human_readable_source": " \n\n#include \"bnx2i.h\"\n\n \nstatic inline struct bnx2i_hba *bnx2i_dev_to_hba(struct device *dev)\n{\n\tstruct Scsi_Host *shost = class_to_shost(dev);\n\treturn iscsi_host_priv(shost);\n}\n\n\n \nstatic ssize_t bnx2i_show_sq_info(struct device *dev,\n\t\t\t\t  struct device_attribute *attr, char *buf)\n{\n\tstruct bnx2i_hba *hba = bnx2i_dev_to_hba(dev);\n\n\treturn sprintf(buf, \"0x%x\\n\", hba->max_sqes);\n}\n\n\n \nstatic ssize_t bnx2i_set_sq_info(struct device *dev,\n\t\t\t\t struct device_attribute *attr,\n\t\t\t\t const char *buf, size_t count)\n{\n\tstruct bnx2i_hba *hba = bnx2i_dev_to_hba(dev);\n\tu32 val;\n\tint max_sq_size;\n\n\tif (hba->ofld_conns_active)\n\t\tgoto skip_config;\n\n\tif (test_bit(BNX2I_NX2_DEV_57710, &hba->cnic_dev_type))\n\t\tmax_sq_size = BNX2I_5770X_SQ_WQES_MAX;\n\telse\n\t\tmax_sq_size = BNX2I_570X_SQ_WQES_MAX;\n\n\tif (sscanf(buf, \" 0x%x \", &val) > 0) {\n\t\tif ((val >= BNX2I_SQ_WQES_MIN) && (val <= max_sq_size) &&\n\t\t    (is_power_of_2(val)))\n\t\t\thba->max_sqes = val;\n\t}\n\n\treturn count;\n\nskip_config:\n\tprintk(KERN_ERR \"bnx2i: device busy, cannot change SQ size\\n\");\n\treturn 0;\n}\n\n\n \nstatic ssize_t bnx2i_show_ccell_info(struct device *dev,\n\t\t\t\t     struct device_attribute *attr, char *buf)\n{\n\tstruct bnx2i_hba *hba = bnx2i_dev_to_hba(dev);\n\n\treturn sprintf(buf, \"0x%x\\n\", hba->num_ccell);\n}\n\n\n \nstatic ssize_t bnx2i_set_ccell_info(struct device *dev,\n\t\t\t\t    struct device_attribute *attr,\n\t\t\t\t    const char *buf, size_t count)\n{\n\tu32 val;\n\tstruct bnx2i_hba *hba = bnx2i_dev_to_hba(dev);\n\n\tif (hba->ofld_conns_active)\n\t\tgoto skip_config;\n\n\tif (sscanf(buf, \" 0x%x \", &val) > 0) {\n\t\tif ((val >= BNX2I_CCELLS_MIN) &&\n\t\t    (val <= BNX2I_CCELLS_MAX)) {\n\t\t\thba->num_ccell = val;\n\t\t}\n\t}\n\n\treturn count;\n\nskip_config:\n\tprintk(KERN_ERR \"bnx2i: device busy, cannot change CCELL size\\n\");\n\treturn 0;\n}\n\n\nstatic DEVICE_ATTR(sq_size, S_IRUGO | S_IWUSR,\n\t\t   bnx2i_show_sq_info, bnx2i_set_sq_info);\nstatic DEVICE_ATTR(num_ccell, S_IRUGO | S_IWUSR,\n\t\t   bnx2i_show_ccell_info, bnx2i_set_ccell_info);\n\nstatic struct attribute *bnx2i_dev_attributes[] = {\n\t&dev_attr_sq_size.attr,\n\t&dev_attr_num_ccell.attr,\n\tNULL\n};\n\nstatic const struct attribute_group bnx2i_dev_attr_group = {\n\t.attrs = bnx2i_dev_attributes\n};\n\nconst struct attribute_group *bnx2i_dev_groups[] = {\n\t&bnx2i_dev_attr_group,\n\tNULL\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}