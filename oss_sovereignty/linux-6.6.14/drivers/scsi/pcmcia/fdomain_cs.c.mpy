{
  "module_name": "fdomain_cs.c",
  "hash_id": "7d5deeeea59831a21ddfd8ffdb8c8368a34ab25475077c33ba7bc9c380e1ba03",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/pcmcia/fdomain_cs.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <scsi/scsi_host.h>\n#include <pcmcia/cistpl.h>\n#include <pcmcia/ds.h>\n#include \"fdomain.h\"\n\nMODULE_AUTHOR(\"Ondrej Zary, David Hinds\");\nMODULE_DESCRIPTION(\"Future Domain PCMCIA SCSI driver\");\nMODULE_LICENSE(\"Dual MPL/GPL\");\n\nstatic int fdomain_config_check(struct pcmcia_device *p_dev, void *priv_data)\n{\n\tp_dev->io_lines = 10;\n\tp_dev->resource[0]->end = FDOMAIN_REGION_SIZE;\n\tp_dev->resource[0]->flags &= ~IO_DATA_PATH_WIDTH;\n\tp_dev->resource[0]->flags |= IO_DATA_PATH_WIDTH_AUTO;\n\treturn pcmcia_request_io(p_dev);\n}\n\nstatic int fdomain_probe(struct pcmcia_device *link)\n{\n\tint ret;\n\tstruct Scsi_Host *sh;\n\n\tlink->config_flags |= CONF_ENABLE_IRQ | CONF_AUTO_SET_IO;\n\tlink->config_regs = PRESENT_OPTION;\n\n\tret = pcmcia_loop_config(link, fdomain_config_check, NULL);\n\tif (ret)\n\t\treturn ret;\n\n\tret = pcmcia_enable_device(link);\n\tif (ret)\n\t\tgoto fail_disable;\n\n\tif (!request_region(link->resource[0]->start, FDOMAIN_REGION_SIZE,\n\t\t\t    \"fdomain_cs\")) {\n\t\tret = -EBUSY;\n\t\tgoto fail_disable;\n\t}\n\n\tsh = fdomain_create(link->resource[0]->start, link->irq, 7, &link->dev);\n\tif (!sh) {\n\t\tdev_err(&link->dev, \"Controller initialization failed\");\n\t\tret = -ENODEV;\n\t\tgoto fail_release;\n\t}\n\n\tlink->priv = sh;\n\n\treturn 0;\n\nfail_release:\n\trelease_region(link->resource[0]->start, FDOMAIN_REGION_SIZE);\nfail_disable:\n\tpcmcia_disable_device(link);\n\treturn ret;\n}\n\nstatic void fdomain_remove(struct pcmcia_device *link)\n{\n\tfdomain_destroy(link->priv);\n\trelease_region(link->resource[0]->start, FDOMAIN_REGION_SIZE);\n\tpcmcia_disable_device(link);\n}\n\nstatic const struct pcmcia_device_id fdomain_ids[] = {\n\tPCMCIA_DEVICE_PROD_ID12(\"IBM Corp.\", \"SCSI PCMCIA Card\", 0xe3736c88,\n\t\t\t\t0x859cad20),\n\tPCMCIA_DEVICE_PROD_ID1(\"SCSI PCMCIA Adapter Card\", 0x8dacb57e),\n\tPCMCIA_DEVICE_PROD_ID12(\" SIMPLE TECHNOLOGY Corporation\",\n\t\t\t\t\"SCSI PCMCIA Credit Card Controller\",\n\t\t\t\t0x182bdafe, 0xc80d106f),\n\tPCMCIA_DEVICE_NULL,\n};\nMODULE_DEVICE_TABLE(pcmcia, fdomain_ids);\n\nstatic struct pcmcia_driver fdomain_cs_driver = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"fdomain_cs\",\n\t.probe\t\t= fdomain_probe,\n\t.remove\t\t= fdomain_remove,\n\t.id_table       = fdomain_ids,\n};\n\nmodule_pcmcia_driver(fdomain_cs_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}