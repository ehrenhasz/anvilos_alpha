{
  "module_name": "aicasm_macro_scan.l",
  "hash_id": "0b87680f5c358d6f343d1ef6dd52eaa6eb370b2458e601c3682d19a870680504",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/aic7xxx/aicasm/aicasm_macro_scan.l",
  "human_readable_source": "%{\n/*\n * Sub-Lexical Analyzer for macro invokation in \n * the Aic7xxx SCSI Host adapter sequencer assembler.\n *\n * Copyright (c) 2001 Adaptec Inc.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions, and the following disclaimer,\n *    without modification.\n * 2. Redistributions in binary form must reproduce at minimum a disclaimer\n *    substantially similar to the \"NO WARRANTY\" disclaimer below\n *    (\"Disclaimer\") and any redistribution must be conditioned upon\n *    including a substantially similar Disclaimer requirement for further\n *    binary redistribution.\n * 3. Neither the names of the above-listed copyright holders nor the names\n *    of any contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * Alternatively, this software may be distributed under the terms of the\n * GNU General Public License (\"GPL\") version 2 as published by the Free\n * Software Foundation.\n *\n * NO WARRANTY\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * HOLDERS OR CONTRIBUTORS BE LIABLE FOR SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS\n * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,\n * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING\n * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGES.\n *\n * $Id: //depot/aic7xxx/aic7xxx/aicasm/aicasm_macro_scan.l#8 $\n *\n * $FreeBSD$\n */\n\n#include <sys/types.h>\n\n#include <inttypes.h>\n#include <limits.h>\n#include <regex.h>\n#include <stdio.h>\n#include <string.h>\n#include <sysexits.h>\n#include \"../queue.h\"\n\n#include \"aicasm.h\"\n#include \"aicasm_symbol.h\"\n#include \"aicasm_macro_gram.h\"\n\n#define MAX_STR_CONST 4096\nstatic char string_buf[MAX_STR_CONST];\nstatic char *string_buf_ptr;\nstatic int  parren_count;\nstatic char buf[255];\nint  mmlineno;\n%}\n\nWORD\t\t[A-Za-z_][-A-Za-z_0-9]*\nSPACE\t\t[ \\t]+\nMCARG\t\t[^(), \\t]+\n\n%x ARGLIST\n\n%%\n\\n\t\t\t{\n\t\t\t\t++mmlineno;\n\t\t\t}\n\\r\t\t\t;\n<ARGLIST>{SPACE}\t;\n<ARGLIST>\\(\t\t{\n\t\t\t\tparren_count++;\n\t\t\t\tif (parren_count == 1) {\n\t\t\t\t\tstring_buf_ptr = string_buf;\n\t\t\t\t\treturn ('(');\n\t\t\t\t}\n\t\t\t\t*string_buf_ptr++ = '(';\n\t\t\t}\n<ARGLIST>\\)\t\t{\n\t\t\t\tif (parren_count == 1) {\n\t\t\t\t\tif (string_buf_ptr != string_buf) {\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t * Return an argument and\n\t\t\t\t\t\t * rescan this parren so we\n\t\t\t\t\t\t * can return it as well.\n\t\t\t\t\t\t */\n\t\t\t\t\t\t*string_buf_ptr = '\\0';\n\t\t\t\t\t\tmmlval.str = string_buf;\n\t\t\t\t\t\tstring_buf_ptr = string_buf;\n\t\t\t\t\t\tunput(')');\n\t\t\t\t\t\treturn T_ARG;\n\t\t\t\t\t}\n\t\t\t\t\tBEGIN INITIAL;\n\t\t\t\t\treturn (')');\n\t\t\t\t}\n\t\t\t\tparren_count--;\n\t\t\t\t*string_buf_ptr++ = ')';\n\t\t\t}\n<ARGLIST>{MCARG}\t{\n\t\t\t\tchar *yptr;\n\n\t\t\t\typtr = mmtext;\n\t\t\t\twhile (*yptr)\n\t\t\t\t\t*string_buf_ptr++ = *yptr++;\n\t\t\t}\n<ARGLIST>\\,\t\t{\n\t\t\t\tif (string_buf_ptr != string_buf) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Return an argument and\n\t\t\t\t\t * rescan this comma so we\n\t\t\t\t\t * can return it as well.\n\t\t\t\t\t */\n\t\t\t\t\t*string_buf_ptr = '\\0';\n\t\t\t\t\tmmlval.str = string_buf;\n\t\t\t\t\tstring_buf_ptr = string_buf;\n\t\t\t\t\tunput(',');\n\t\t\t\t\treturn T_ARG;\n\t\t\t\t}\n\t\t\t\treturn ',';\n\t\t\t}\n{WORD}[(]\t\t{\n\t\t\t\t/* May be a symbol or a macro invocation. */\n\t\t\t\tmmlval.sym = symtable_get(mmtext);\n\t\t\t\tif (mmlval.sym->type != MACRO) {\n\t\t\t\t\tstop(\"Expecting Macro Name\",\n\t\t\t\t\t     EX_DATAERR);\n\t\t\t\t}\n\t\t\t\tunput('(');\n\t\t\t\tparren_count = 0;\n\t\t\t\tBEGIN ARGLIST;\n\t\t\t\treturn T_SYMBOL;\n\t\t\t}\n.\t\t\t{ \n\t\t\t\tsnprintf(buf, sizeof(buf), \"Invalid character \"\n\t\t\t\t\t \"'%c'\", mmtext[0]);\n\t\t\t\tstop(buf, EX_DATAERR);\n\t\t\t}\n%%\n\nint\nmmwrap()\n{\n\tstop(\"EOF encountered in macro call\", EX_DATAERR);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}