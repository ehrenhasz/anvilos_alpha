{
  "module_name": "efct_scsi.h",
  "hash_id": "b787d74acca5f0f452807d202cc1252e9328f899709f943beb80d59054381b38",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/elx/efct/efct_scsi.h",
  "human_readable_source": " \n \n\n#if !defined(__EFCT_SCSI_H__)\n#define __EFCT_SCSI_H__\n#include <scsi/scsi_host.h>\n#include <scsi/scsi_transport_fc.h>\n\n \n#define EFCT_SCSI_CMD_DIR_IN\t\t(1 << 0)\n#define EFCT_SCSI_CMD_DIR_OUT\t\t(1 << 1)\n#define EFCT_SCSI_CMD_SIMPLE\t\t(1 << 2)\n#define EFCT_SCSI_CMD_HEAD_OF_QUEUE\t(1 << 3)\n#define EFCT_SCSI_CMD_ORDERED\t\t(1 << 4)\n#define EFCT_SCSI_CMD_UNTAGGED\t\t(1 << 5)\n#define EFCT_SCSI_CMD_ACA\t\t(1 << 6)\n#define EFCT_SCSI_FIRST_BURST_ERR\t(1 << 7)\n#define EFCT_SCSI_FIRST_BURST_ABORTED\t(1 << 8)\n\n \n#define EFCT_SCSI_LAST_DATAPHASE\t(1 << 0)\n#define EFCT_SCSI_NO_AUTO_RESPONSE\t(1 << 1)\n#define EFCT_SCSI_LOW_LATENCY\t\t(1 << 2)\n\n#define EFCT_SCSI_SNS_BUF_VALID(sense)\t((sense) && \\\n\t\t\t(0x70 == (((const u8 *)(sense))[0] & 0x70)))\n\n#define EFCT_SCSI_WQ_STEERING_SHIFT\t16\n#define EFCT_SCSI_WQ_STEERING_MASK\t(0xf << EFCT_SCSI_WQ_STEERING_SHIFT)\n#define EFCT_SCSI_WQ_STEERING_CLASS\t(0 << EFCT_SCSI_WQ_STEERING_SHIFT)\n#define EFCT_SCSI_WQ_STEERING_REQUEST\t(1 << EFCT_SCSI_WQ_STEERING_SHIFT)\n#define EFCT_SCSI_WQ_STEERING_CPU\t(2 << EFCT_SCSI_WQ_STEERING_SHIFT)\n\n#define EFCT_SCSI_WQ_CLASS_SHIFT\t\t(20)\n#define EFCT_SCSI_WQ_CLASS_MASK\t\t(0xf << EFCT_SCSI_WQ_CLASS_SHIFT)\n#define EFCT_SCSI_WQ_CLASS(x)\t\t((x & EFCT_SCSI_WQ_CLASS_MASK) << \\\n\t\t\t\t\t\tEFCT_SCSI_WQ_CLASS_SHIFT)\n\n#define EFCT_SCSI_WQ_CLASS_LOW_LATENCY\t1\n\nstruct efct_scsi_cmd_resp {\n\tu8 scsi_status;\n\tu16 scsi_status_qualifier;\n\tu8 *response_data;\n\tu32 response_data_length;\n\tu8 *sense_data;\n\tu32 sense_data_length;\n\tint residual;\n\tu32 response_wire_length;\n};\n\nstruct efct_vport {\n\tstruct efct\t\t*efct;\n\tbool\t\t\tis_vport;\n\tstruct fc_host_statistics fc_host_stats;\n\tstruct Scsi_Host\t*shost;\n\tstruct fc_vport\t\t*fc_vport;\n\tu64\t\t\tnpiv_wwpn;\n\tu64\t\t\tnpiv_wwnn;\n};\n\n \nenum efct_scsi_io_status {\n\tEFCT_SCSI_STATUS_GOOD = 0,\n\tEFCT_SCSI_STATUS_ABORTED,\n\tEFCT_SCSI_STATUS_ERROR,\n\tEFCT_SCSI_STATUS_DIF_GUARD_ERR,\n\tEFCT_SCSI_STATUS_DIF_REF_TAG_ERROR,\n\tEFCT_SCSI_STATUS_DIF_APP_TAG_ERROR,\n\tEFCT_SCSI_STATUS_DIF_UNKNOWN_ERROR,\n\tEFCT_SCSI_STATUS_PROTOCOL_CRC_ERROR,\n\tEFCT_SCSI_STATUS_NO_IO,\n\tEFCT_SCSI_STATUS_ABORT_IN_PROGRESS,\n\tEFCT_SCSI_STATUS_CHECK_RESPONSE,\n\tEFCT_SCSI_STATUS_COMMAND_TIMEOUT,\n\tEFCT_SCSI_STATUS_TIMEDOUT_AND_ABORTED,\n\tEFCT_SCSI_STATUS_SHUTDOWN,\n\tEFCT_SCSI_STATUS_NEXUS_LOST,\n};\n\nstruct efct_node;\nstruct efct_io;\nstruct efc_node;\nstruct efc_nport;\n\n \ntypedef int (*efct_scsi_io_cb_t)(struct efct_io *io,\n\t\t\t\t    enum efct_scsi_io_status status,\n\t\t\t\t    u32 flags, void *arg);\n\n \ntypedef int (*efct_scsi_rsp_io_cb_t)(struct efct_io *io,\n\t\t\tenum efct_scsi_io_status status,\n\t\t\tstruct efct_scsi_cmd_resp *rsp,\n\t\t\tu32 flags, void *arg);\n\n \n#define EFCT_SCSI_IO_CMPL\t\t(1 << 0)\n \n#define EFCT_SCSI_IO_CMPL_RSP_SENT\t(1 << 1)\n#define EFCT_SCSI_IO_ABORTED\t\t(1 << 2)\n\n \nenum efct_scsi_tmf_cmd {\n\tEFCT_SCSI_TMF_ABORT_TASK = 1,\n\tEFCT_SCSI_TMF_QUERY_TASK_SET,\n\tEFCT_SCSI_TMF_ABORT_TASK_SET,\n\tEFCT_SCSI_TMF_CLEAR_TASK_SET,\n\tEFCT_SCSI_TMF_QUERY_ASYNCHRONOUS_EVENT,\n\tEFCT_SCSI_TMF_LOGICAL_UNIT_RESET,\n\tEFCT_SCSI_TMF_CLEAR_ACA,\n\tEFCT_SCSI_TMF_TARGET_RESET,\n};\n\n \nenum efct_scsi_tmf_resp {\n\tEFCT_SCSI_TMF_FUNCTION_COMPLETE = 1,\n\tEFCT_SCSI_TMF_FUNCTION_SUCCEEDED,\n\tEFCT_SCSI_TMF_FUNCTION_IO_NOT_FOUND,\n\tEFCT_SCSI_TMF_FUNCTION_REJECTED,\n\tEFCT_SCSI_TMF_INCORRECT_LOGICAL_UNIT_NUMBER,\n\tEFCT_SCSI_TMF_SERVICE_DELIVERY,\n};\n\nstruct efct_scsi_sgl {\n\tuintptr_t\taddr;\n\tuintptr_t\tdif_addr;\n\tsize_t\t\tlen;\n};\n\nenum efct_scsi_io_role {\n\tEFCT_SCSI_IO_ROLE_ORIGINATOR,\n\tEFCT_SCSI_IO_ROLE_RESPONDER,\n};\n\nstruct efct_io *\nefct_scsi_io_alloc(struct efct_node *node);\nvoid efct_scsi_io_free(struct efct_io *io);\nstruct efct_io *efct_io_get_instance(struct efct *efct, u32 index);\n\nint efct_scsi_tgt_driver_init(void);\nint efct_scsi_tgt_driver_exit(void);\nint efct_scsi_tgt_new_device(struct efct *efct);\nint efct_scsi_tgt_del_device(struct efct *efct);\nint\nefct_scsi_tgt_new_nport(struct efc *efc, struct efc_nport *nport);\nvoid\nefct_scsi_tgt_del_nport(struct efc *efc, struct efc_nport *nport);\n\nint\nefct_scsi_new_initiator(struct efc *efc, struct efc_node *node);\n\nenum efct_scsi_del_initiator_reason {\n\tEFCT_SCSI_INITIATOR_DELETED,\n\tEFCT_SCSI_INITIATOR_MISSING,\n};\n\nint\nefct_scsi_del_initiator(struct efc *efc, struct efc_node *node,\tint reason);\nvoid\nefct_scsi_recv_cmd(struct efct_io *io, uint64_t lun, u8 *cdb, u32 cdb_len,\n\t\t   u32 flags);\nint\nefct_scsi_recv_tmf(struct efct_io *tmfio, u32 lun, enum efct_scsi_tmf_cmd cmd,\n\t\t   struct efct_io *abortio, u32 flags);\nint\nefct_scsi_send_rd_data(struct efct_io *io, u32 flags, struct efct_scsi_sgl *sgl,\n\t\tu32 sgl_count, u64 wire_len, efct_scsi_io_cb_t cb, void *arg);\nint\nefct_scsi_recv_wr_data(struct efct_io *io, u32 flags, struct efct_scsi_sgl *sgl,\n\t\tu32 sgl_count, u64 wire_len, efct_scsi_io_cb_t cb, void *arg);\nint\nefct_scsi_send_resp(struct efct_io *io, u32 flags,\n\t\tstruct efct_scsi_cmd_resp *rsp, efct_scsi_io_cb_t cb, void *arg);\nint\nefct_scsi_send_tmf_resp(struct efct_io *io, enum efct_scsi_tmf_resp rspcode,\n\t\t\tu8 addl_rsp_info[3], efct_scsi_io_cb_t cb, void *arg);\nint\nefct_scsi_tgt_abort_io(struct efct_io *io, efct_scsi_io_cb_t cb, void *arg);\n\nvoid efct_scsi_io_complete(struct efct_io *io);\n\nint efct_scsi_reg_fc_transport(void);\nvoid efct_scsi_release_fc_transport(void);\nint efct_scsi_new_device(struct efct *efct);\nvoid efct_scsi_del_device(struct efct *efct);\nvoid _efct_scsi_io_free(struct kref *arg);\n\nint\nefct_scsi_del_vport(struct efct *efct, struct Scsi_Host *shost);\nstruct efct_vport *\nefct_scsi_new_vport(struct efct *efct, struct device *dev);\n\nint efct_scsi_io_dispatch(struct efct_io *io, void *cb);\nint efct_scsi_io_dispatch_abort(struct efct_io *io, void *cb);\nvoid efct_scsi_check_pending(struct efct *efct);\nstruct efct_io *\nefct_bls_send_rjt(struct efct_io *io, struct fc_frame_header *hdr);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}