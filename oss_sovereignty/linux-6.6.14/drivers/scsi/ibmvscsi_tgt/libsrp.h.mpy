{
  "module_name": "libsrp.h",
  "hash_id": "9c5b34468ce3ef58d1798c5002c931716bb779b6e31598d8e6ae47e1608ca59c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/scsi/ibmvscsi_tgt/libsrp.h",
  "human_readable_source": " \n#ifndef __LIBSRP_H__\n#define __LIBSRP_H__\n\n#include <linux/list.h>\n#include <linux/kfifo.h>\n#include <scsi/srp.h>\n\nenum srp_valid {\n\tINVALIDATE_CMD_RESP_EL = 0,\n\tVALID_CMD_RESP_EL = 0x80,\n\tVALID_INIT_MSG = 0xC0,\n\tVALID_TRANS_EVENT = 0xFF\n};\n\nenum srp_format {\n\tSRP_FORMAT = 1,\n\tMAD_FORMAT = 2,\n\tOS400_FORMAT = 3,\n\tAIX_FORMAT = 4,\n\tLINUX_FORMAT = 5,\n\tMESSAGE_IN_CRQ = 6\n};\n\nenum srp_init_msg {\n\tINIT_MSG = 1,\n\tINIT_COMPLETE_MSG = 2\n};\n\nenum srp_trans_event {\n\tUNUSED_FORMAT = 0,\n\tPARTNER_FAILED = 1,\n\tPARTNER_DEREGISTER = 2,\n\tMIGRATED = 6,\n\tPREPARE_FOR_SUSPEND = 9,\n\tRESUME_FROM_SUSP = 0xA\n};\n\nenum srp_status {\n\tCRQ_ENTRY_OVERWRITTEN = 0x20,\n\tHEADER_DESCRIPTOR = 0xF1,\n\tPING = 0xF5,\n\tPING_RESPONSE = 0xF6\n};\n\nenum srp_mad_version {\n\tMAD_VERSION_1 = 1\n};\n\nenum srp_os_type {\n\tOS400 = 1,\n\tLINUX = 2,\n\tAIX = 3,\n\tOFW = 4\n};\n\nenum srp_task_attributes {\n\tSRP_SIMPLE_TASK = 0,\n\tSRP_HEAD_TASK = 1,\n\tSRP_ORDERED_TASK = 2,\n\tSRP_ACA_TASK = 4\n};\n\nenum {\n\tSRP_TASK_MANAGEMENT_FUNCTION_COMPLETE           = 0,\n\tSRP_REQUEST_FIELDS_INVALID                      = 2,\n\tSRP_TASK_MANAGEMENT_FUNCTION_NOT_SUPPORTED      = 4,\n\tSRP_TASK_MANAGEMENT_FUNCTION_FAILED             = 5\n};\n\nstruct srp_buf {\n\tdma_addr_t dma;\n\tvoid *buf;\n};\n\nstruct srp_queue {\n\tvoid *pool;\n\tvoid *items;\n\tstruct kfifo queue;\n\tspinlock_t lock;\n};\n\nstruct srp_target {\n\tstruct device *dev;\n\n\tspinlock_t lock;\n\tstruct list_head cmd_queue;\n\n\tsize_t srp_iu_size;\n\tstruct srp_queue iu_queue;\n\tsize_t rx_ring_size;\n\tstruct srp_buf **rx_ring;\n\n\tvoid *ldata;\n};\n\nstruct iu_entry {\n\tstruct srp_target *target;\n\n\tstruct list_head ilist;\n\tdma_addr_t remote_token;\n\tunsigned long flags;\n\n\tstruct srp_buf *sbuf;\n\tu16 iu_len;\n};\n\nstruct ibmvscsis_cmd;\n\ntypedef int (srp_rdma_t)(struct ibmvscsis_cmd *, struct scatterlist *, int,\n\t\t\t struct srp_direct_buf *, int,\n\t\t\t enum dma_data_direction, unsigned int);\nint srp_target_alloc(struct srp_target *, struct device *, size_t, size_t);\nvoid srp_target_free(struct srp_target *);\nstruct iu_entry *srp_iu_get(struct srp_target *);\nvoid srp_iu_put(struct iu_entry *);\nint srp_transfer_data(struct ibmvscsis_cmd *, struct srp_cmd *,\n\t\t      srp_rdma_t, int, int);\nu64 srp_data_length(struct srp_cmd *cmd, enum dma_data_direction dir);\nint srp_get_desc_table(struct srp_cmd *srp_cmd, enum dma_data_direction *dir,\n\t\t       u64 *data_len);\nstatic inline int srp_cmd_direction(struct srp_cmd *cmd)\n{\n\treturn (cmd->buf_fmt >> 4) ? DMA_TO_DEVICE : DMA_FROM_DEVICE;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}