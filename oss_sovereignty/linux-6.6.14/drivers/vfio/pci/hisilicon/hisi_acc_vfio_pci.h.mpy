{
  "module_name": "hisi_acc_vfio_pci.h",
  "hash_id": "e6531d79db77e1ba9c3be0e288dcf4798276b1c38dc50f5999b4e0ce615a1d48",
  "original_prompt": "Ingested from linux-6.6.14/drivers/vfio/pci/hisilicon/hisi_acc_vfio_pci.h",
  "human_readable_source": " \n \n\n#ifndef HISI_ACC_VFIO_PCI_H\n#define HISI_ACC_VFIO_PCI_H\n\n#include <linux/hisi_acc_qm.h>\n\n#define MB_POLL_PERIOD_US\t\t10\n#define MB_POLL_TIMEOUT_US\t\t1000\n#define QM_CACHE_WB_START\t\t0x204\n#define QM_CACHE_WB_DONE\t\t0x208\n#define QM_MB_CMD_PAUSE_QM\t\t0xe\n#define QM_ABNORMAL_INT_STATUS\t\t0x100008\n#define QM_IFC_INT_STATUS\t\t0x0028\n#define SEC_CORE_INT_STATUS\t\t0x301008\n#define HPRE_HAC_INT_STATUS\t\t0x301800\n#define HZIP_CORE_INT_STATUS\t\t0x3010AC\n\n#define QM_VFT_CFG_RDY\t\t\t0x10006c\n#define QM_VFT_CFG_OP_WR\t\t0x100058\n#define QM_VFT_CFG_TYPE\t\t\t0x10005c\n#define QM_VFT_CFG\t\t\t0x100060\n#define QM_VFT_CFG_OP_ENABLE\t\t0x100054\n#define QM_VFT_CFG_DATA_L\t\t0x100064\n#define QM_VFT_CFG_DATA_H\t\t0x100068\n\n#define ERROR_CHECK_TIMEOUT\t\t100\n#define CHECK_DELAY_TIME\t\t100\n\n#define QM_SQC_VFT_BASE_SHIFT_V2\t28\n#define QM_SQC_VFT_BASE_MASK_V2\t\tGENMASK(15, 0)\n#define QM_SQC_VFT_NUM_SHIFT_V2\t\t45\n#define QM_SQC_VFT_NUM_MASK_V2\t\tGENMASK(9, 0)\n\n \n#define QM_REGS_MAX_LEN\t\t7\n#define QM_REG_ADDR_OFFSET\t0x0004\n\n#define QM_XQC_ADDR_OFFSET\t32U\n#define QM_VF_AEQ_INT_MASK\t0x0004\n#define QM_VF_EQ_INT_MASK\t0x000c\n#define QM_IFC_INT_SOURCE_V\t0x0020\n#define QM_IFC_INT_MASK\t\t0x0024\n#define QM_IFC_INT_SET_V\t0x002c\n#define QM_QUE_ISO_CFG_V\t0x0030\n#define QM_PAGE_SIZE\t\t0x0034\n\n#define QM_EQC_DW0\t\t0X8000\n#define QM_AEQC_DW0\t\t0X8020\n\nstruct acc_vf_data {\n#define QM_MATCH_SIZE offsetofend(struct acc_vf_data, qm_rsv_state)\n\t \n#define ACC_DEV_MAGIC\t0XCDCDCDCDFEEDAACC\n\tu64 acc_magic;\n\tu32 qp_num;\n\tu32 dev_id;\n\tu32 que_iso_cfg;\n\tu32 qp_base;\n\tu32 vf_qm_state;\n\t \n\tu32 qm_rsv_state[3];\n\n\t \n\tu32 aeq_int_mask;\n\tu32 eq_int_mask;\n\tu32 ifc_int_source;\n\tu32 ifc_int_mask;\n\tu32 ifc_int_set;\n\tu32 page_size;\n\n\t \n\tu32 qm_eqc_dw[7];\n\n\t \n\tu32 qm_aeqc_dw[7];\n\n\t \n\tu32 qm_rsv_regs[5];\n\tu32 padding;\n\t \n\tu64 eqe_dma;\n\tu64 aeqe_dma;\n\tu64 sqc_dma;\n\tu64 cqc_dma;\n};\n\nstruct hisi_acc_vf_migration_file {\n\tstruct file *filp;\n\tstruct mutex lock;\n\tbool disabled;\n\n\tstruct hisi_acc_vf_core_device *hisi_acc_vdev;\n\tstruct acc_vf_data vf_data;\n\tsize_t total_length;\n};\n\nstruct hisi_acc_vf_core_device {\n\tstruct vfio_pci_core_device core_device;\n\tu8 match_done:1;\n\tu8 deferred_reset:1;\n\t \n\tstruct mutex state_mutex;\n\tenum vfio_device_mig_state mig_state;\n\tstruct pci_dev *pf_dev;\n\tstruct pci_dev *vf_dev;\n\tstruct hisi_qm *pf_qm;\n\tstruct hisi_qm vf_qm;\n\tu32 vf_qm_state;\n\tint vf_id;\n\t \n\tspinlock_t reset_lock;\n\tstruct hisi_acc_vf_migration_file *resuming_migf;\n\tstruct hisi_acc_vf_migration_file *saving_migf;\n};\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}