{
  "module_name": "cap_audit.h",
  "hash_id": "cb6f9385169cf64cb913fa06f00fbc9edd132ef33796d8dd5ac2860bd2598ab5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iommu/intel/cap_audit.h",
  "human_readable_source": " \n \n\n \n#define CAP_FL5LP_MASK\t\tBIT_ULL(60)\n#define CAP_PI_MASK\t\tBIT_ULL(59)\n#define CAP_FL1GP_MASK\t\tBIT_ULL(56)\n#define CAP_RD_MASK\t\tBIT_ULL(55)\n#define CAP_WD_MASK\t\tBIT_ULL(54)\n#define CAP_MAMV_MASK\t\tGENMASK_ULL(53, 48)\n#define CAP_NFR_MASK\t\tGENMASK_ULL(47, 40)\n#define CAP_PSI_MASK\t\tBIT_ULL(39)\n#define CAP_SLLPS_MASK\t\tGENMASK_ULL(37, 34)\n#define CAP_FRO_MASK\t\tGENMASK_ULL(33, 24)\n#define CAP_ZLR_MASK\t\tBIT_ULL(22)\n#define CAP_MGAW_MASK\t\tGENMASK_ULL(21, 16)\n#define CAP_SAGAW_MASK\t\tGENMASK_ULL(12, 8)\n#define CAP_CM_MASK\t\tBIT_ULL(7)\n#define CAP_PHMR_MASK\t\tBIT_ULL(6)\n#define CAP_PLMR_MASK\t\tBIT_ULL(5)\n#define CAP_RWBF_MASK\t\tBIT_ULL(4)\n#define CAP_AFL_MASK\t\tBIT_ULL(3)\n#define CAP_NDOMS_MASK\t\tGENMASK_ULL(2, 0)\n\n \n#define ECAP_RPS_MASK\t\tBIT_ULL(49)\n#define ECAP_SMPWC_MASK\t\tBIT_ULL(48)\n#define ECAP_FLTS_MASK\t\tBIT_ULL(47)\n#define ECAP_SLTS_MASK\t\tBIT_ULL(46)\n#define ECAP_SLADS_MASK\t\tBIT_ULL(45)\n#define ECAP_VCS_MASK\t\tBIT_ULL(44)\n#define ECAP_SMTS_MASK\t\tBIT_ULL(43)\n#define ECAP_PDS_MASK\t\tBIT_ULL(42)\n#define ECAP_DIT_MASK\t\tBIT_ULL(41)\n#define ECAP_PASID_MASK\t\tBIT_ULL(40)\n#define ECAP_PSS_MASK\t\tGENMASK_ULL(39, 35)\n#define ECAP_EAFS_MASK\t\tBIT_ULL(34)\n#define ECAP_NWFS_MASK\t\tBIT_ULL(33)\n#define ECAP_SRS_MASK\t\tBIT_ULL(31)\n#define ECAP_ERS_MASK\t\tBIT_ULL(30)\n#define ECAP_PRS_MASK\t\tBIT_ULL(29)\n#define ECAP_NEST_MASK\t\tBIT_ULL(26)\n#define ECAP_MTS_MASK\t\tBIT_ULL(25)\n#define ECAP_MHMV_MASK\t\tGENMASK_ULL(23, 20)\n#define ECAP_IRO_MASK\t\tGENMASK_ULL(17, 8)\n#define ECAP_SC_MASK\t\tBIT_ULL(7)\n#define ECAP_PT_MASK\t\tBIT_ULL(6)\n#define ECAP_EIM_MASK\t\tBIT_ULL(4)\n#define ECAP_DT_MASK\t\tBIT_ULL(2)\n#define ECAP_QI_MASK\t\tBIT_ULL(1)\n#define ECAP_C_MASK\t\tBIT_ULL(0)\n\n \n#define DO_CHECK_FEATURE_MISMATCH(a, b, cap, feature, MASK) \\\ndo { \\\n\tif (cap##_##feature(a) != cap##_##feature(b)) { \\\n\t\tintel_iommu_##cap##_sanity &= ~(MASK); \\\n\t\tpr_info(\"IOMMU feature %s inconsistent\", #feature); \\\n\t} \\\n} while (0)\n\n#define CHECK_FEATURE_MISMATCH(a, b, cap, feature, MASK) \\\n\tDO_CHECK_FEATURE_MISMATCH((a)->cap, (b)->cap, cap, feature, MASK)\n\n#define CHECK_FEATURE_MISMATCH_HOTPLUG(b, cap, feature, MASK) \\\ndo { \\\n\tif (cap##_##feature(intel_iommu_##cap##_sanity)) \\\n\t\tDO_CHECK_FEATURE_MISMATCH(intel_iommu_##cap##_sanity, \\\n\t\t\t\t\t  (b)->cap, cap, feature, MASK); \\\n} while (0)\n\n#define MINIMAL_FEATURE_IOMMU(iommu, cap, MASK) \\\ndo { \\\n\tu64 min_feature = intel_iommu_##cap##_sanity & (MASK); \\\n\tmin_feature = min_t(u64, min_feature, (iommu)->cap & (MASK)); \\\n\tintel_iommu_##cap##_sanity = (intel_iommu_##cap##_sanity & ~(MASK)) | \\\n\t\t\t\t     min_feature; \\\n} while (0)\n\n#define MINIMAL_FEATURE_HOTPLUG(iommu, cap, feature, MASK, mismatch) \\\ndo { \\\n\tif ((intel_iommu_##cap##_sanity & (MASK)) > \\\n\t    (cap##_##feature((iommu)->cap))) \\\n\t\tmismatch = true; \\\n\telse \\\n\t\t(iommu)->cap = ((iommu)->cap & ~(MASK)) | \\\n\t\t(intel_iommu_##cap##_sanity & (MASK)); \\\n} while (0)\n\nenum cap_audit_type {\n\tCAP_AUDIT_STATIC_DMAR,\n\tCAP_AUDIT_STATIC_IRQR,\n\tCAP_AUDIT_HOTPLUG_DMAR,\n\tCAP_AUDIT_HOTPLUG_IRQR,\n};\n\nbool intel_cap_smts_sanity(void);\nbool intel_cap_pasid_sanity(void);\nbool intel_cap_nest_sanity(void);\nbool intel_cap_flts_sanity(void);\nbool intel_cap_slts_sanity(void);\n\nstatic inline bool scalable_mode_support(void)\n{\n\treturn (intel_iommu_sm && intel_cap_smts_sanity());\n}\n\nstatic inline bool pasid_mode_support(void)\n{\n\treturn scalable_mode_support() && intel_cap_pasid_sanity();\n}\n\nstatic inline bool nested_mode_support(void)\n{\n\treturn scalable_mode_support() && intel_cap_nest_sanity();\n}\n\nint intel_cap_audit(enum cap_audit_type type, struct intel_iommu *iommu);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}