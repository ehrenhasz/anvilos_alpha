{
  "module_name": "fsl_pamu.h",
  "hash_id": "7f499873e7aa8e665de3b44d2765456b344ab6399e9bbf35c0adb6dd94935c5d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iommu/fsl_pamu.h",
  "human_readable_source": " \n \n\n#ifndef __FSL_PAMU_H\n#define __FSL_PAMU_H\n\n#include <linux/iommu.h>\n#include <linux/pci.h>\n\n#include <asm/fsl_pamu_stash.h>\n\n \n#define set_bf(v, m, x)\t\t(v = ((v) & ~(m)) | (((x) << m##_SHIFT) & (m)))\n#define get_bf(v, m)\t\t(((v) & (m)) >> m##_SHIFT)\n\n \n#define PAMU_PGC 0x00000000      \n#define PAMU_PE 0x40000000       \n\n \n#define PAMU_OFFSET 0x1000\n\n#define PAMU_MMAP_REGS_BASE 0\n\nstruct pamu_mmap_regs {\n\tu32 ppbah;\n\tu32 ppbal;\n\tu32 pplah;\n\tu32 pplal;\n\tu32 spbah;\n\tu32 spbal;\n\tu32 splah;\n\tu32 splal;\n\tu32 obah;\n\tu32 obal;\n\tu32 olah;\n\tu32 olal;\n};\n\n \n#define PAMU_POES1 0x0040\n#define PAMU_POES2 0x0044\n#define PAMU_POEAH 0x0048\n#define PAMU_POEAL 0x004C\n#define PAMU_AVS1  0x0050\n#define PAMU_AVS1_AV    0x1\n#define PAMU_AVS1_OTV   0x6\n#define PAMU_AVS1_APV   0x78\n#define PAMU_AVS1_WAV   0x380\n#define PAMU_AVS1_LAV   0x1c00\n#define PAMU_AVS1_GCV   0x2000\n#define PAMU_AVS1_PDV   0x4000\n#define PAMU_AV_MASK    (PAMU_AVS1_AV | PAMU_AVS1_OTV | PAMU_AVS1_APV | PAMU_AVS1_WAV \\\n\t\t\t | PAMU_AVS1_LAV | PAMU_AVS1_GCV | PAMU_AVS1_PDV)\n#define PAMU_AVS1_LIODN_SHIFT 16\n#define PAMU_LAV_LIODN_NOT_IN_PPAACT 0x400\n\n#define PAMU_AVS2  0x0054\n#define PAMU_AVAH  0x0058\n#define PAMU_AVAL  0x005C\n#define PAMU_EECTL 0x0060\n#define PAMU_EEDIS 0x0064\n#define PAMU_EEINTEN 0x0068\n#define PAMU_EEDET 0x006C\n#define PAMU_EEATTR 0x0070\n#define PAMU_EEAHI 0x0074\n#define PAMU_EEALO 0x0078\n#define PAMU_EEDHI 0X007C\n#define PAMU_EEDLO 0x0080\n#define PAMU_EECC  0x0084\n#define PAMU_UDAD  0x0090\n\n \n#define PAMU_PR1 0x0BF8\n#define PAMU_PR2 0x0BFC\n\n \n#define PAMU_PR1_MASK 0xffff\n\n \n#define PAMU_PC1 0x0C00\n#define PAMU_PC2 0x0C04\n#define PAMU_PC3 0x0C08\n#define PAMU_PC4 0x0C0C\n\n \n#define PAMU_PC 0x0C10\n\n \n#define PAMU_CONTROL 0x0C10\n#define PAMU_PC_PGC 0x80000000   \n#define PAMU_PC_PE   0x40000000  \n#define PAMU_PC_SPCC 0x00000010  \n#define PAMU_PC_PPCC 0x00000001  \n#define PAMU_PC_OCE  0x00001000  \n\n#define PAMU_PFA1 0x0C14\n#define PAMU_PFA2 0x0C18\n\n#define PAMU_PC2_MLIODN(X) ((X) >> 16)\n#define PAMU_PC3_MWCE(X) (((X) >> 21) & 0xf)\n\n \n#define PAMU_PICS 0x0C1C\n#define PAMU_ACCESS_VIOLATION_STAT   0x8\n#define PAMU_ACCESS_VIOLATION_ENABLE 0x4\n\n \n#define PAMU_PD1 0x0F00\n#define PAMU_PD2 0x0F04\n#define PAMU_PD3 0x0F08\n#define PAMU_PD4 0x0F0C\n\n#define PAACE_AP_PERMS_DENIED  0x0\n#define PAACE_AP_PERMS_QUERY   0x1\n#define PAACE_AP_PERMS_UPDATE  0x2\n#define PAACE_AP_PERMS_ALL     0x3\n\n#define PAACE_DD_TO_HOST       0x0\n#define PAACE_DD_TO_IO         0x1\n#define PAACE_PT_PRIMARY       0x0\n#define PAACE_PT_SECONDARY     0x1\n#define PAACE_V_INVALID        0x0\n#define PAACE_V_VALID          0x1\n#define PAACE_MW_SUBWINDOWS    0x1\n\n#define PAACE_WSE_4K           0xB\n#define PAACE_WSE_8K           0xC\n#define PAACE_WSE_16K          0xD\n#define PAACE_WSE_32K          0xE\n#define PAACE_WSE_64K          0xF\n#define PAACE_WSE_128K         0x10\n#define PAACE_WSE_256K         0x11\n#define PAACE_WSE_512K         0x12\n#define PAACE_WSE_1M           0x13\n#define PAACE_WSE_2M           0x14\n#define PAACE_WSE_4M           0x15\n#define PAACE_WSE_8M           0x16\n#define PAACE_WSE_16M          0x17\n#define PAACE_WSE_32M          0x18\n#define PAACE_WSE_64M          0x19\n#define PAACE_WSE_128M         0x1A\n#define PAACE_WSE_256M         0x1B\n#define PAACE_WSE_512M         0x1C\n#define PAACE_WSE_1G           0x1D\n#define PAACE_WSE_2G           0x1E\n#define PAACE_WSE_4G           0x1F\n\n#define PAACE_DID_PCI_EXPRESS_1 0x00\n#define PAACE_DID_PCI_EXPRESS_2 0x01\n#define PAACE_DID_PCI_EXPRESS_3 0x02\n#define PAACE_DID_PCI_EXPRESS_4 0x03\n#define PAACE_DID_LOCAL_BUS     0x04\n#define PAACE_DID_SRIO          0x0C\n#define PAACE_DID_MEM_1         0x10\n#define PAACE_DID_MEM_2         0x11\n#define PAACE_DID_MEM_3         0x12\n#define PAACE_DID_MEM_4         0x13\n#define PAACE_DID_MEM_1_2       0x14\n#define PAACE_DID_MEM_3_4       0x15\n#define PAACE_DID_MEM_1_4       0x16\n#define PAACE_DID_BM_SW_PORTAL  0x18\n#define PAACE_DID_PAMU          0x1C\n#define PAACE_DID_CAAM          0x21\n#define PAACE_DID_QM_SW_PORTAL  0x3C\n#define PAACE_DID_CORE0_INST    0x80\n#define PAACE_DID_CORE0_DATA    0x81\n#define PAACE_DID_CORE1_INST    0x82\n#define PAACE_DID_CORE1_DATA    0x83\n#define PAACE_DID_CORE2_INST    0x84\n#define PAACE_DID_CORE2_DATA    0x85\n#define PAACE_DID_CORE3_INST    0x86\n#define PAACE_DID_CORE3_DATA    0x87\n#define PAACE_DID_CORE4_INST    0x88\n#define PAACE_DID_CORE4_DATA    0x89\n#define PAACE_DID_CORE5_INST    0x8A\n#define PAACE_DID_CORE5_DATA    0x8B\n#define PAACE_DID_CORE6_INST    0x8C\n#define PAACE_DID_CORE6_DATA    0x8D\n#define PAACE_DID_CORE7_INST    0x8E\n#define PAACE_DID_CORE7_DATA    0x8F\n#define PAACE_DID_BROADCAST     0xFF\n\n#define PAACE_ATM_NO_XLATE      0x00\n#define PAACE_ATM_WINDOW_XLATE  0x01\n#define PAACE_ATM_PAGE_XLATE    0x02\n#define PAACE_ATM_WIN_PG_XLATE  (PAACE_ATM_WINDOW_XLATE | PAACE_ATM_PAGE_XLATE)\n#define PAACE_OTM_NO_XLATE      0x00\n#define PAACE_OTM_IMMEDIATE     0x01\n#define PAACE_OTM_INDEXED       0x02\n#define PAACE_OTM_RESERVED      0x03\n\n#define PAACE_M_COHERENCE_REQ   0x01\n\n#define PAACE_PID_0             0x0\n#define PAACE_PID_1             0x1\n#define PAACE_PID_2             0x2\n#define PAACE_PID_3             0x3\n#define PAACE_PID_4             0x4\n#define PAACE_PID_5             0x5\n#define PAACE_PID_6             0x6\n#define PAACE_PID_7             0x7\n\n#define PAACE_TCEF_FORMAT0_8B   0x00\n#define PAACE_TCEF_FORMAT1_RSVD 0x01\n \n#define PAACE_NUMBER_ENTRIES    0x500\n \n#define SPAACE_NUMBER_ENTRIES\t0x800\n\n#define\tOME_NUMBER_ENTRIES      16\n\n \n#define PPAACE_AF_WBAL\t\t\t0xfffff000\n#define PPAACE_AF_WBAL_SHIFT\t\t12\n#define PPAACE_AF_WSE\t\t\t0x00000fc0\n#define PPAACE_AF_WSE_SHIFT\t\t6\n#define PPAACE_AF_MW\t\t\t0x00000020\n#define PPAACE_AF_MW_SHIFT\t\t5\n\n#define SPAACE_AF_LIODN\t\t\t0xffff0000\n#define SPAACE_AF_LIODN_SHIFT\t\t16\n\n#define PAACE_AF_AP\t\t\t0x00000018\n#define PAACE_AF_AP_SHIFT\t\t3\n#define PAACE_AF_DD\t\t\t0x00000004\n#define PAACE_AF_DD_SHIFT\t\t2\n#define PAACE_AF_PT\t\t\t0x00000002\n#define PAACE_AF_PT_SHIFT\t\t1\n#define PAACE_AF_V\t\t\t0x00000001\n#define PAACE_AF_V_SHIFT\t\t0\n\n#define PAACE_DA_HOST_CR\t\t0x80\n#define PAACE_DA_HOST_CR_SHIFT\t\t7\n\n#define PAACE_IA_CID\t\t\t0x00FF0000\n#define PAACE_IA_CID_SHIFT\t\t16\n#define PAACE_IA_WCE\t\t\t0x000000F0\n#define PAACE_IA_WCE_SHIFT\t\t4\n#define PAACE_IA_ATM\t\t\t0x0000000C\n#define PAACE_IA_ATM_SHIFT\t\t2\n#define PAACE_IA_OTM\t\t\t0x00000003\n#define PAACE_IA_OTM_SHIFT\t\t0\n\n#define PAACE_WIN_TWBAL\t\t\t0xfffff000\n#define PAACE_WIN_TWBAL_SHIFT\t\t12\n#define PAACE_WIN_SWSE\t\t\t0x00000fc0\n#define PAACE_WIN_SWSE_SHIFT\t\t6\n\n \n \nstruct paace {\n\t \n\tu32 wbah;\t\t\t\t \n\tu32 addr_bitfields;\t\t \n\n\t \n\t \n\tunion {\n\t\tstruct {\n\t\t\t \n\t\t\tu8 did;\n\t\t\t \n\t\t\tu8 pid;\n\t\t\t \n\t\t\tu8 snpid;\n\t\t\t \n\t\t\tu8 coherency_required;  \n\t\t} to_host;\n\t\tstruct {\n\t\t\t \n\t\t\tu8  did;\n\t\t\tu8  reserved1;\n\t\t\tu16 reserved2;\n\t\t} to_io;\n\t} domain_attr;\n\n\t \n\tu32 impl_attr;\t\t\t \n\n\t \n\t \n\tu32 twbah;\n\tu32 win_bitfields;\t\t\t \n\n\t \n\t \n\tu32 fspi;\t\t\t\t \n\tunion {\n\t\tstruct {\n\t\t\tu8 ioea;\n\t\t\tu8 moea;\n\t\t\tu8 ioeb;\n\t\t\tu8 moeb;\n\t\t} immed_ot;\n\t\tstruct {\n\t\t\tu16 reserved;\n\t\t\tu16 omi;\n\t\t} index_ot;\n\t} op_encode;\n\n\t \n\tu32 reserved[8];\t\t\t \n};\n\n \n#define NUM_MOE 128\nstruct ome {\n\tu8 moe[NUM_MOE];\n} __packed;\n\n#define PAACT_SIZE              (sizeof(struct paace) * PAACE_NUMBER_ENTRIES)\n#define SPAACT_SIZE              (sizeof(struct paace) * SPAACE_NUMBER_ENTRIES)\n#define OMT_SIZE                (sizeof(struct ome) * OME_NUMBER_ENTRIES)\n\n#define PAMU_PAGE_SHIFT 12\n#define PAMU_PAGE_SIZE  4096ULL\n\n#define IOE_READ        0x00\n#define IOE_READ_IDX    0x00\n#define IOE_WRITE       0x81\n#define IOE_WRITE_IDX   0x01\n#define IOE_EREAD0      0x82     \n#define IOE_EREAD0_IDX  0x02     \n#define IOE_EWRITE0     0x83     \n#define IOE_EWRITE0_IDX 0x03     \n#define IOE_DIRECT0     0x84     \n#define IOE_DIRECT0_IDX 0x04     \n#define IOE_EREAD1      0x85     \n#define IOE_EREAD1_IDX  0x05     \n#define IOE_EWRITE1     0x86     \n#define IOE_EWRITE1_IDX 0x06     \n#define IOE_DIRECT1     0x87     \n#define IOE_DIRECT1_IDX 0x07     \n#define IOE_RAC         0x8c     \n#define IOE_RAC_IDX     0x0c     \n#define IOE_RAS         0x8d     \n#define IOE_RAS_IDX     0x0d     \n#define IOE_RAD         0x8e     \n#define IOE_RAD_IDX     0x0e     \n#define IOE_RAI         0x8f     \n#define IOE_RAI_IDX     0x0f     \n\n#define EOE_READ        0x00\n#define EOE_WRITE       0x01\n#define EOE_RAC         0x0c     \n#define EOE_RAS         0x0d     \n#define EOE_RAD         0x0e     \n#define EOE_RAI         0x0f     \n#define EOE_LDEC        0x10     \n#define EOE_LDECL       0x11     \n#define EOE_LDECPE      0x12     \n#define EOE_LDECPEL     0x13     \n#define EOE_LDECFE      0x14     \n#define EOE_LDECFEL     0x15     \n#define EOE_RSA         0x16     \n#define EOE_RSAU        0x17     \n#define EOE_READI       0x18     \n#define EOE_RWNITC      0x19     \n#define EOE_WCI         0x1a     \n#define EOE_WWSA        0x1b     \n#define EOE_WWSAL       0x1c     \n#define EOE_WWSAO       0x1d     \n#define EOE_WWSAOL      0x1e     \n#define EOE_VALID       0x80\n\n \nint pamu_domain_init(void);\nint pamu_enable_liodn(int liodn);\nint pamu_disable_liodn(int liodn);\nint pamu_config_ppaace(int liodn, u32 omi, uint32_t stashid, int prot);\n\nu32 get_stash_id(u32 stash_dest_hint, u32 vcpu);\nvoid get_ome_index(u32 *omi_index, struct device *dev);\nint  pamu_update_paace_stash(int liodn, u32 value);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}