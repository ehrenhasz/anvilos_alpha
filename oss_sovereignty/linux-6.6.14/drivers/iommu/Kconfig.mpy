{
  "module_name": "Kconfig",
  "hash_id": "daac751fe0887e861bd6a6f7e3647aa159b5bfe487ba729aa59515bae6660f8d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iommu/Kconfig",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0-only\n# The IOVA library may also be used by non-IOMMU_API users\nconfig IOMMU_IOVA\n\ttristate\n\n# IOMMU_API always gets selected by whoever wants it.\nconfig IOMMU_API\n\tbool\n\nmenuconfig IOMMU_SUPPORT\n\tbool \"IOMMU Hardware Support\"\n\tdepends on MMU\n\tdefault y\n\thelp\n\t  Say Y here if you want to compile device drivers for IO Memory\n\t  Management Units into the kernel. These devices usually allow to\n\t  remap DMA requests and/or remap interrupts from other devices on the\n\t  system.\n\nif IOMMU_SUPPORT\n\nmenu \"Generic IOMMU Pagetable Support\"\n\n# Selected by the actual pagetable implementations\nconfig IOMMU_IO_PGTABLE\n\tbool\n\nconfig IOMMU_IO_PGTABLE_LPAE\n\tbool \"ARMv7/v8 Long Descriptor Format\"\n\tselect IOMMU_IO_PGTABLE\n\tdepends on ARM || ARM64 || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for cmpxchg64()\n\thelp\n\t  Enable support for the ARM long descriptor pagetable format.\n\t  This allocator supports 4K/2M/1G, 16K/32M and 64K/512M page\n\t  sizes at both stage-1 and stage-2, as well as address spaces\n\t  up to 48-bits in size.\n\nconfig IOMMU_IO_PGTABLE_LPAE_SELFTEST\n\tbool \"LPAE selftests\"\n\tdepends on IOMMU_IO_PGTABLE_LPAE\n\thelp\n\t  Enable self-tests for LPAE page table allocator. This performs\n\t  a series of page-table consistency checks during boot.\n\n\t  If unsure, say N here.\n\nconfig IOMMU_IO_PGTABLE_ARMV7S\n\tbool \"ARMv7/v8 Short Descriptor Format\"\n\tselect IOMMU_IO_PGTABLE\n\tdepends on ARM || ARM64 || COMPILE_TEST\n\thelp\n\t  Enable support for the ARM Short-descriptor pagetable format.\n\t  This supports 32-bit virtual and physical addresses mapped using\n\t  2-level tables with 4KB pages/1MB sections, and contiguous entries\n\t  for 64KB pages/16MB supersections if indicated by the IOMMU driver.\n\nconfig IOMMU_IO_PGTABLE_ARMV7S_SELFTEST\n\tbool \"ARMv7s selftests\"\n\tdepends on IOMMU_IO_PGTABLE_ARMV7S\n\thelp\n\t  Enable self-tests for ARMv7s page table allocator. This performs\n\t  a series of page-table consistency checks during boot.\n\n\t  If unsure, say N here.\n\nconfig IOMMU_IO_PGTABLE_DART\n\tbool \"Apple DART Formats\"\n\tselect IOMMU_IO_PGTABLE\n\tdepends on ARM64 || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for cmpxchg64()\n\thelp\n\t  Enable support for the Apple DART pagetable formats. These include\n\t  the t8020 and t6000/t8110 DART formats used in Apple M1/M2 family\n\t  SoCs.\n\n\t  If unsure, say N here.\n\nendmenu\n\nconfig IOMMU_DEBUGFS\n\tbool \"Export IOMMU internals in DebugFS\"\n\tdepends on DEBUG_FS\n\thelp\n\t  Allows exposure of IOMMU device internals. This option enables\n\t  the use of debugfs by IOMMU drivers as required. Devices can,\n\t  at initialization time, cause the IOMMU code to create a top-level\n\t  debug/iommu directory, and then populate a subdirectory with\n\t  entries as required.\n\nchoice\n\tprompt \"IOMMU default domain type\"\n\tdepends on IOMMU_API\n\tdefault IOMMU_DEFAULT_DMA_LAZY if X86 || IA64\n\tdefault IOMMU_DEFAULT_DMA_STRICT\n\thelp\n\t  Choose the type of IOMMU domain used to manage DMA API usage by\n\t  device drivers. The options here typically represent different\n\t  levels of tradeoff between robustness/security and performance,\n\t  depending on the IOMMU driver. Not all IOMMUs support all options.\n\t  This choice can be overridden at boot via the command line, and for\n\t  some devices also at runtime via sysfs.\n\n\t  If unsure, keep the default.\n\nconfig IOMMU_DEFAULT_DMA_STRICT\n\tbool \"Translated - Strict\"\n\thelp\n\t  Trusted devices use translation to restrict their access to only\n\t  DMA-mapped pages, with strict TLB invalidation on unmap. Equivalent\n\t  to passing \"iommu.passthrough=0 iommu.strict=1\" on the command line.\n\n\t  Untrusted devices always use this mode, with an additional layer of\n\t  bounce-buffering such that they cannot gain access to any unrelated\n\t  data within a mapped page.\n\nconfig IOMMU_DEFAULT_DMA_LAZY\n\tbool \"Translated - Lazy\"\n\thelp\n\t  Trusted devices use translation to restrict their access to only\n\t  DMA-mapped pages, but with \"lazy\" batched TLB invalidation. This\n\t  mode allows higher performance with some IOMMUs due to reduced TLB\n\t  flushing, but at the cost of reduced isolation since devices may be\n\t  able to access memory for some time after it has been unmapped.\n\t  Equivalent to passing \"iommu.passthrough=0 iommu.strict=0\" on the\n\t  command line.\n\n\t  If this mode is not supported by the IOMMU driver, the effective\n\t  runtime default will fall back to IOMMU_DEFAULT_DMA_STRICT.\n\nconfig IOMMU_DEFAULT_PASSTHROUGH\n\tbool \"Passthrough\"\n\thelp\n\t  Trusted devices are identity-mapped, giving them unrestricted access\n\t  to memory with minimal performance overhead. Equivalent to passing\n\t  \"iommu.passthrough=1\" (historically \"iommu=pt\") on the command line.\n\n\t  If this mode is not supported by the IOMMU driver, the effective\n\t  runtime default will fall back to IOMMU_DEFAULT_DMA_STRICT.\n\nendchoice\n\nconfig OF_IOMMU\n\tdef_bool y\n\tdepends on OF && IOMMU_API\n\n# IOMMU-agnostic DMA-mapping layer\nconfig IOMMU_DMA\n\tdef_bool ARM64 || IA64 || X86\n\tselect DMA_OPS\n\tselect IOMMU_API\n\tselect IOMMU_IOVA\n\tselect IRQ_MSI_IOMMU\n\tselect NEED_SG_DMA_LENGTH\n\tselect NEED_SG_DMA_FLAGS if SWIOTLB\n\n# Shared Virtual Addressing\nconfig IOMMU_SVA\n\tbool\n\nconfig FSL_PAMU\n\tbool \"Freescale IOMMU support\"\n\tdepends on PCI\n\tdepends on PHYS_64BIT\n\tdepends on PPC_E500MC || (COMPILE_TEST && PPC)\n\tselect IOMMU_API\n\tselect GENERIC_ALLOCATOR\n\thelp\n\t  Freescale PAMU support. PAMU is the IOMMU present on Freescale QorIQ platforms.\n\t  PAMU can authorize memory access, remap the memory address, and remap I/O\n\t  transaction types.\n\n# MSM IOMMU support\nconfig MSM_IOMMU\n\tbool \"MSM IOMMU Support\"\n\tdepends on ARM\n\tdepends on ARCH_MSM8X60 || ARCH_MSM8960 || COMPILE_TEST\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_ARMV7S\n\thelp\n\t  Support for the IOMMUs found on certain Qualcomm SOCs.\n\t  These IOMMUs allow virtualization of the address space used by most\n\t  cores within the multimedia subsystem.\n\n\t  If unsure, say N here.\n\nsource \"drivers/iommu/amd/Kconfig\"\nsource \"drivers/iommu/intel/Kconfig\"\nsource \"drivers/iommu/iommufd/Kconfig\"\n\nconfig IRQ_REMAP\n\tbool \"Support for Interrupt Remapping\"\n\tdepends on X86_64 && X86_IO_APIC && PCI_MSI && ACPI\n\tselect DMAR_TABLE\n\thelp\n\t  Supports Interrupt remapping for IO-APIC and MSI devices.\n\t  To use x2apic mode in the CPU's which support x2APIC enhancements or\n\t  to support platforms with CPU's having > 8 bit APIC ID, say Y.\n\n# OMAP IOMMU support\nconfig OMAP_IOMMU\n\tbool \"OMAP IOMMU Support\"\n\tdepends on ARCH_OMAP2PLUS || COMPILE_TEST\n\tselect IOMMU_API\n\thelp\n\t  The OMAP3 media platform drivers depend on iommu support,\n\t  if you need them say Y here.\n\nconfig OMAP_IOMMU_DEBUG\n\tbool \"Export OMAP IOMMU internals in DebugFS\"\n\tdepends on OMAP_IOMMU && DEBUG_FS\n\thelp\n\t  Select this to see extensive information about\n\t  the internal state of OMAP IOMMU in debugfs.\n\n\t  Say N unless you know you need this.\n\nconfig ROCKCHIP_IOMMU\n\tbool \"Rockchip IOMMU Support\"\n\tdepends on ARCH_ROCKCHIP || COMPILE_TEST\n\tselect IOMMU_API\n\tselect ARM_DMA_USE_IOMMU\n\thelp\n\t  Support for IOMMUs found on Rockchip rk32xx SOCs.\n\t  These IOMMUs allow virtualization of the address space used by most\n\t  cores within the multimedia subsystem.\n\t  Say Y here if you are using a Rockchip SoC that includes an IOMMU\n\t  device.\n\nconfig SUN50I_IOMMU\n\tbool \"Allwinner H6 IOMMU Support\"\n\tdepends on HAS_DMA\n\tdepends on ARCH_SUNXI || COMPILE_TEST\n\tselect ARM_DMA_USE_IOMMU\n\tselect IOMMU_API\n\thelp\n\t  Support for the IOMMU introduced in the Allwinner H6 SoCs.\n\nconfig TEGRA_IOMMU_GART\n\tbool \"Tegra GART IOMMU Support\"\n\tdepends on ARCH_TEGRA_2x_SOC\n\tdepends on TEGRA_MC\n\tselect IOMMU_API\n\thelp\n\t  Enables support for remapping discontiguous physical memory\n\t  shared with the operating system into contiguous I/O virtual\n\t  space through the GART (Graphics Address Relocation Table)\n\t  hardware included on Tegra SoCs.\n\nconfig TEGRA_IOMMU_SMMU\n\tbool \"NVIDIA Tegra SMMU Support\"\n\tdepends on ARCH_TEGRA\n\tdepends on TEGRA_AHB\n\tdepends on TEGRA_MC\n\tselect IOMMU_API\n\thelp\n\t  This driver supports the IOMMU hardware (SMMU) found on NVIDIA Tegra\n\t  SoCs (Tegra30 up to Tegra210).\n\nconfig EXYNOS_IOMMU\n\tbool \"Exynos IOMMU Support\"\n\tdepends on ARCH_EXYNOS || COMPILE_TEST\n\tdepends on !CPU_BIG_ENDIAN # revisit driver if we can enable big-endian ptes\n\tselect IOMMU_API\n\tselect ARM_DMA_USE_IOMMU\n\thelp\n\t  Support for the IOMMU (System MMU) of Samsung Exynos application\n\t  processor family. This enables H/W multimedia accelerators to see\n\t  non-linear physical memory chunks as linear memory in their\n\t  address space.\n\n\t  If unsure, say N here.\n\nconfig EXYNOS_IOMMU_DEBUG\n\tbool \"Debugging log for Exynos IOMMU\"\n\tdepends on EXYNOS_IOMMU\n\thelp\n\t  Select this to see the detailed log message that shows what\n\t  happens in the IOMMU driver.\n\n\t  Say N unless you need kernel log message for IOMMU debugging.\n\nconfig IPMMU_VMSA\n\tbool \"Renesas VMSA-compatible IPMMU\"\n\tdepends on ARCH_RENESAS || COMPILE_TEST\n\tdepends on ARM || ARM64 || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for IOMMU_IO_PGTABLE_LPAE\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_LPAE\n\tselect ARM_DMA_USE_IOMMU\n\thelp\n\t  Support for the Renesas VMSA-compatible IPMMU found in the R-Mobile\n\t  APE6, R-Car Gen{2,3} and RZ/G{1,2} SoCs.\n\n\t  If unsure, say N.\n\nconfig SPAPR_TCE_IOMMU\n\tbool \"sPAPR TCE IOMMU Support\"\n\tdepends on PPC_POWERNV || PPC_PSERIES\n\tselect IOMMU_API\n\thelp\n\t  Enables bits of IOMMU API required by VFIO. The iommu_ops\n\t  is not implemented as it is not necessary for VFIO.\n\nconfig APPLE_DART\n\ttristate \"Apple DART IOMMU Support\"\n\tdepends on ARCH_APPLE || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for IOMMU_IO_PGTABLE_DART\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_DART\n\tdefault ARCH_APPLE\n\thelp\n\t  Support for Apple DART (Device Address Resolution Table) IOMMUs\n\t  found in Apple ARM SoCs like the M1.\n\t  This IOMMU is required for most peripherals using DMA to access\n\t  the main memory.\n\n\t  Say Y here if you are using an Apple SoC.\n\n# ARM IOMMU support\nconfig ARM_SMMU\n\ttristate \"ARM Ltd. System MMU (SMMU) Support\"\n\tdepends on ARM64 || ARM || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for IOMMU_IO_PGTABLE_LPAE\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_LPAE\n\tselect ARM_DMA_USE_IOMMU if ARM\n\thelp\n\t  Support for implementations of the ARM System MMU architecture\n\t  versions 1 and 2.\n\n\t  Say Y here if your SoC includes an IOMMU device implementing\n\t  the ARM SMMU architecture.\n\nconfig ARM_SMMU_LEGACY_DT_BINDINGS\n\tbool \"Support the legacy \\\"mmu-masters\\\" devicetree bindings\"\n\tdepends on ARM_SMMU=y && OF\n\thelp\n\t  Support for the badly designed and deprecated \"mmu-masters\"\n\t  devicetree bindings. This allows some DMA masters to attach\n\t  to the SMMU but does not provide any support via the DMA API.\n\t  If you're lucky, you might be able to get VFIO up and running.\n\n\t  If you say Y here then you'll make me very sad. Instead, say N\n\t  and move your firmware to the utopian future that was 2016.\n\nconfig ARM_SMMU_DISABLE_BYPASS_BY_DEFAULT\n\tbool \"Default to disabling bypass on ARM SMMU v1 and v2\"\n\tdepends on ARM_SMMU\n\tdefault y\n\thelp\n\t  Say Y here to (by default) disable bypass streams such that\n\t  incoming transactions from devices that are not attached to\n\t  an iommu domain will report an abort back to the device and\n\t  will not be allowed to pass through the SMMU.\n\n\t  Any old kernels that existed before this KConfig was\n\t  introduced would default to _allowing_ bypass (AKA the\n\t  equivalent of NO for this config).  However the default for\n\t  this option is YES because the old behavior is insecure.\n\n\t  There are few reasons to allow unmatched stream bypass, and\n\t  even fewer good ones.  If saying YES here breaks your board\n\t  you should work on fixing your board.  This KConfig option\n\t  is expected to be removed in the future and we'll simply\n\t  hardcode the bypass disable in the code.\n\n\t  NOTE: the kernel command line parameter\n\t  'arm-smmu.disable_bypass' will continue to override this\n\t  config.\n\nconfig ARM_SMMU_QCOM\n\tdef_tristate y\n\tdepends on ARM_SMMU && ARCH_QCOM\n\tselect QCOM_SCM\n\thelp\n\t  When running on a Qualcomm platform that has the custom variant\n\t  of the ARM SMMU, this needs to be built into the SMMU driver.\n\nconfig ARM_SMMU_QCOM_DEBUG\n\tbool \"ARM SMMU QCOM implementation defined debug support\"\n\tdepends on ARM_SMMU_QCOM\n\thelp\n\t  Support for implementation specific debug features in ARM SMMU\n\t  hardware found in QTI platforms.\n\n\t  Say Y here to enable debug for issues such as TLB sync timeouts\n\t  which requires implementation defined register dumps.\n\nconfig ARM_SMMU_V3\n\ttristate \"ARM Ltd. System MMU Version 3 (SMMUv3) Support\"\n\tdepends on ARM64\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_LPAE\n\tselect GENERIC_MSI_IRQ\n\thelp\n\t  Support for implementations of the ARM System MMU architecture\n\t  version 3 providing translation support to a PCIe root complex.\n\n\t  Say Y here if your system includes an IOMMU device implementing\n\t  the ARM SMMUv3 architecture.\n\nconfig ARM_SMMU_V3_SVA\n\tbool \"Shared Virtual Addressing support for the ARM SMMUv3\"\n\tdepends on ARM_SMMU_V3\n\tselect IOMMU_SVA\n\tselect MMU_NOTIFIER\n\thelp\n\t  Support for sharing process address spaces with devices using the\n\t  SMMUv3.\n\n\t  Say Y here if your system supports SVA extensions such as PCIe PASID\n\t  and PRI.\n\nconfig S390_IOMMU\n\tdef_bool y if S390 && PCI\n\tdepends on S390 && PCI\n\tselect IOMMU_API\n\thelp\n\t  Support for the IOMMU API for s390 PCI devices.\n\nconfig MTK_IOMMU\n\ttristate \"MediaTek IOMMU Support\"\n\tdepends on ARCH_MEDIATEK || COMPILE_TEST\n\tselect ARM_DMA_USE_IOMMU\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_ARMV7S\n\tselect MEMORY\n\tselect MTK_SMI\n\thelp\n\t  Support for the M4U on certain Mediatek SOCs. M4U is MultiMedia\n\t  Memory Management Unit. This option enables remapping of DMA memory\n\t  accesses for the multimedia subsystem.\n\n\t  If unsure, say N here.\n\nconfig MTK_IOMMU_V1\n\ttristate \"MediaTek IOMMU Version 1 (M4U gen1) Support\"\n\tdepends on ARM\n\tdepends on ARCH_MEDIATEK || COMPILE_TEST\n\tselect ARM_DMA_USE_IOMMU\n\tselect IOMMU_API\n\tselect MEMORY\n\tselect MTK_SMI\n\thelp\n\t  Support for the M4U on certain Mediatek SoCs. M4U generation 1 HW is\n\t  Multimedia Memory Managememt Unit. This option enables remapping of\n\t  DMA memory accesses for the multimedia subsystem.\n\n\t  if unsure, say N here.\n\nconfig QCOM_IOMMU\n\t# Note: iommu drivers cannot (yet?) be built as modules\n\tbool \"Qualcomm IOMMU Support\"\n\tdepends on ARCH_QCOM || COMPILE_TEST\n\tdepends on !GENERIC_ATOMIC64\t# for IOMMU_IO_PGTABLE_LPAE\n\tselect QCOM_SCM\n\tselect IOMMU_API\n\tselect IOMMU_IO_PGTABLE_LPAE\n\tselect ARM_DMA_USE_IOMMU\n\thelp\n\t  Support for IOMMU on certain Qualcomm SoCs.\n\nconfig HYPERV_IOMMU\n\tbool \"Hyper-V IRQ Handling\"\n\tdepends on HYPERV && X86\n\tselect IOMMU_API\n\tdefault HYPERV\n\thelp\n\t  Stub IOMMU driver to handle IRQs to support Hyper-V Linux\n\t  guest and root partitions.\n\nconfig VIRTIO_IOMMU\n\ttristate \"Virtio IOMMU driver\"\n\tdepends on VIRTIO\n\tdepends on (ARM64 || X86)\n\tselect IOMMU_API\n\tselect INTERVAL_TREE\n\tselect ACPI_VIOT if ACPI\n\thelp\n\t  Para-virtualised IOMMU driver with virtio.\n\n\t  Say Y here if you intend to run this kernel as a guest.\n\nconfig SPRD_IOMMU\n\ttristate \"Unisoc IOMMU Support\"\n\tdepends on ARCH_SPRD || COMPILE_TEST\n\tselect IOMMU_API\n\thelp\n\t  Support for IOMMU on Unisoc's SoCs, this IOMMU can be used by\n\t  Unisoc's multimedia devices, such as display, Image codec(jpeg)\n\t  and a few signal processors, including VSP(video), GSP(graphic),\n\t  ISP(image), and CPP(camera pixel processor), etc.\n\n\t  Say Y here if you want to use the multimedia devices listed above.\n\nendif # IOMMU_SUPPORT\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}