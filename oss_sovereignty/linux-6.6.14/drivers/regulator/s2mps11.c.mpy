{
  "module_name": "s2mps11.c",
  "hash_id": "6ca5fec6d1dd423dae755e5ffe67210fb9e33e425e82d7c1fefe12cc9b5c9e29",
  "original_prompt": "Ingested from linux-6.6.14/drivers/regulator/s2mps11.c",
  "human_readable_source": "\n\n\n\n\n#include <linux/bug.h>\n#include <linux/err.h>\n#include <linux/gpio/consumer.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/regmap.h>\n#include <linux/platform_device.h>\n#include <linux/regulator/driver.h>\n#include <linux/regulator/machine.h>\n#include <linux/regulator/of_regulator.h>\n#include <linux/mfd/samsung/core.h>\n#include <linux/mfd/samsung/s2mps11.h>\n#include <linux/mfd/samsung/s2mps13.h>\n#include <linux/mfd/samsung/s2mps14.h>\n#include <linux/mfd/samsung/s2mps15.h>\n#include <linux/mfd/samsung/s2mpu02.h>\n\n \n#define S2MPS_REGULATOR_MAX\t\tS2MPS13_REGULATOR_MAX\nstruct s2mps11_info {\n\tint ramp_delay2;\n\tint ramp_delay34;\n\tint ramp_delay5;\n\tint ramp_delay16;\n\tint ramp_delay7810;\n\tint ramp_delay9;\n\n\tenum sec_device_type dev_type;\n\n\t \n\tDECLARE_BITMAP(suspend_state, S2MPS_REGULATOR_MAX);\n\n\t \n\tstruct gpio_desc **ext_control_gpiod;\n};\n\nstatic int get_ramp_delay(int ramp_delay)\n{\n\tunsigned char cnt = 0;\n\n\tramp_delay /= 6250;\n\n\twhile (true) {\n\t\tramp_delay = ramp_delay >> 1;\n\t\tif (ramp_delay == 0)\n\t\t\tbreak;\n\t\tcnt++;\n\t}\n\n\tif (cnt > 3)\n\t\tcnt = 3;\n\n\treturn cnt;\n}\n\nstatic int s2mps11_regulator_set_voltage_time_sel(struct regulator_dev *rdev,\n\t\t\t\t   unsigned int old_selector,\n\t\t\t\t   unsigned int new_selector)\n{\n\tstruct s2mps11_info *s2mps11 = rdev_get_drvdata(rdev);\n\tint rdev_id = rdev_get_id(rdev);\n\tunsigned int ramp_delay = 0;\n\tint old_volt, new_volt;\n\n\tswitch (rdev_id) {\n\tcase S2MPS11_BUCK2:\n\t\tramp_delay = s2mps11->ramp_delay2;\n\t\tbreak;\n\tcase S2MPS11_BUCK3:\n\tcase S2MPS11_BUCK4:\n\t\tramp_delay = s2mps11->ramp_delay34;\n\t\tbreak;\n\tcase S2MPS11_BUCK5:\n\t\tramp_delay = s2mps11->ramp_delay5;\n\t\tbreak;\n\tcase S2MPS11_BUCK6:\n\tcase S2MPS11_BUCK1:\n\t\tramp_delay = s2mps11->ramp_delay16;\n\t\tbreak;\n\tcase S2MPS11_BUCK7:\n\tcase S2MPS11_BUCK8:\n\tcase S2MPS11_BUCK10:\n\t\tramp_delay = s2mps11->ramp_delay7810;\n\t\tbreak;\n\tcase S2MPS11_BUCK9:\n\t\tramp_delay = s2mps11->ramp_delay9;\n\t}\n\n\tif (ramp_delay == 0)\n\t\tramp_delay = rdev->desc->ramp_delay;\n\n\told_volt = rdev->desc->min_uV + (rdev->desc->uV_step * old_selector);\n\tnew_volt = rdev->desc->min_uV + (rdev->desc->uV_step * new_selector);\n\n\treturn DIV_ROUND_UP(abs(new_volt - old_volt), ramp_delay);\n}\n\nstatic int s2mps11_set_ramp_delay(struct regulator_dev *rdev, int ramp_delay)\n{\n\tstruct s2mps11_info *s2mps11 = rdev_get_drvdata(rdev);\n\tunsigned int ramp_val, ramp_shift, ramp_reg = S2MPS11_REG_RAMP_BUCK;\n\tunsigned int ramp_enable = 1, enable_shift = 0;\n\tint rdev_id = rdev_get_id(rdev);\n\tint ret;\n\n\tswitch (rdev_id) {\n\tcase S2MPS11_BUCK1:\n\t\tif (ramp_delay > s2mps11->ramp_delay16)\n\t\t\ts2mps11->ramp_delay16 = ramp_delay;\n\t\telse\n\t\t\tramp_delay = s2mps11->ramp_delay16;\n\n\t\tramp_shift = S2MPS11_BUCK16_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPS11_BUCK2:\n\t\tenable_shift = S2MPS11_BUCK2_RAMP_EN_SHIFT;\n\t\tif (!ramp_delay) {\n\t\t\tramp_enable = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\ts2mps11->ramp_delay2 = ramp_delay;\n\t\tramp_shift = S2MPS11_BUCK2_RAMP_SHIFT;\n\t\tramp_reg = S2MPS11_REG_RAMP;\n\t\tbreak;\n\tcase S2MPS11_BUCK3:\n\t\tenable_shift = S2MPS11_BUCK3_RAMP_EN_SHIFT;\n\t\tif (!ramp_delay) {\n\t\t\tramp_enable = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (ramp_delay > s2mps11->ramp_delay34)\n\t\t\ts2mps11->ramp_delay34 = ramp_delay;\n\t\telse\n\t\t\tramp_delay = s2mps11->ramp_delay34;\n\n\t\tramp_shift = S2MPS11_BUCK34_RAMP_SHIFT;\n\t\tramp_reg = S2MPS11_REG_RAMP;\n\t\tbreak;\n\tcase S2MPS11_BUCK4:\n\t\tenable_shift = S2MPS11_BUCK4_RAMP_EN_SHIFT;\n\t\tif (!ramp_delay) {\n\t\t\tramp_enable = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (ramp_delay > s2mps11->ramp_delay34)\n\t\t\ts2mps11->ramp_delay34 = ramp_delay;\n\t\telse\n\t\t\tramp_delay = s2mps11->ramp_delay34;\n\n\t\tramp_shift = S2MPS11_BUCK34_RAMP_SHIFT;\n\t\tramp_reg = S2MPS11_REG_RAMP;\n\t\tbreak;\n\tcase S2MPS11_BUCK5:\n\t\ts2mps11->ramp_delay5 = ramp_delay;\n\t\tramp_shift = S2MPS11_BUCK5_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPS11_BUCK6:\n\t\tenable_shift = S2MPS11_BUCK6_RAMP_EN_SHIFT;\n\t\tif (!ramp_delay) {\n\t\t\tramp_enable = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (ramp_delay > s2mps11->ramp_delay16)\n\t\t\ts2mps11->ramp_delay16 = ramp_delay;\n\t\telse\n\t\t\tramp_delay = s2mps11->ramp_delay16;\n\n\t\tramp_shift = S2MPS11_BUCK16_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPS11_BUCK7:\n\tcase S2MPS11_BUCK8:\n\tcase S2MPS11_BUCK10:\n\t\tif (ramp_delay > s2mps11->ramp_delay7810)\n\t\t\ts2mps11->ramp_delay7810 = ramp_delay;\n\t\telse\n\t\t\tramp_delay = s2mps11->ramp_delay7810;\n\n\t\tramp_shift = S2MPS11_BUCK7810_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPS11_BUCK9:\n\t\ts2mps11->ramp_delay9 = ramp_delay;\n\t\tramp_shift = S2MPS11_BUCK9_RAMP_SHIFT;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tif (!ramp_enable)\n\t\tgoto ramp_disable;\n\n\t \n\tif ((rdev_id >= S2MPS11_BUCK2 && rdev_id <= S2MPS11_BUCK4) ||\n\t    rdev_id == S2MPS11_BUCK6)  {\n\t\tret = regmap_update_bits(rdev->regmap, S2MPS11_REG_RAMP,\n\t\t\t\t\t 1 << enable_shift, 1 << enable_shift);\n\t\tif (ret) {\n\t\t\tdev_err(&rdev->dev, \"failed to enable ramp rate\\n\");\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tramp_val = get_ramp_delay(ramp_delay);\n\n\treturn regmap_update_bits(rdev->regmap, ramp_reg, 0x3 << ramp_shift,\n\t\t\t\t  ramp_val << ramp_shift);\n\nramp_disable:\n\treturn regmap_update_bits(rdev->regmap, S2MPS11_REG_RAMP,\n\t\t\t\t  1 << enable_shift, 0);\n}\n\nstatic int s2mps11_regulator_enable(struct regulator_dev *rdev)\n{\n\tstruct s2mps11_info *s2mps11 = rdev_get_drvdata(rdev);\n\tint rdev_id = rdev_get_id(rdev);\n\tunsigned int val;\n\n\tswitch (s2mps11->dev_type) {\n\tcase S2MPS11X:\n\t\tif (test_bit(rdev_id, s2mps11->suspend_state))\n\t\t\tval = S2MPS14_ENABLE_SUSPEND;\n\t\telse\n\t\t\tval = rdev->desc->enable_mask;\n\t\tbreak;\n\tcase S2MPS13X:\n\tcase S2MPS14X:\n\t\tif (test_bit(rdev_id, s2mps11->suspend_state))\n\t\t\tval = S2MPS14_ENABLE_SUSPEND;\n\t\telse if (s2mps11->ext_control_gpiod[rdev_id])\n\t\t\tval = S2MPS14_ENABLE_EXT_CONTROL;\n\t\telse\n\t\t\tval = rdev->desc->enable_mask;\n\t\tbreak;\n\tcase S2MPU02:\n\t\tif (test_bit(rdev_id, s2mps11->suspend_state))\n\t\t\tval = S2MPU02_ENABLE_SUSPEND;\n\t\telse\n\t\t\tval = rdev->desc->enable_mask;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\trdev->desc->enable_mask, val);\n}\n\nstatic int s2mps11_regulator_set_suspend_disable(struct regulator_dev *rdev)\n{\n\tint ret;\n\tunsigned int val, state;\n\tstruct s2mps11_info *s2mps11 = rdev_get_drvdata(rdev);\n\tint rdev_id = rdev_get_id(rdev);\n\n\t \n\tswitch (s2mps11->dev_type) {\n\tcase S2MPS11X:\n\t\tswitch (rdev_id) {\n\t\tcase S2MPS11_LDO2:\n\t\tcase S2MPS11_LDO36:\n\t\tcase S2MPS11_LDO37:\n\t\tcase S2MPS11_LDO38:\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tstate = S2MPS14_ENABLE_SUSPEND;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase S2MPS13X:\n\tcase S2MPS14X:\n\t\tswitch (rdev_id) {\n\t\tcase S2MPS14_LDO3:\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tstate = S2MPS14_ENABLE_SUSPEND;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase S2MPU02:\n\t\tswitch (rdev_id) {\n\t\tcase S2MPU02_LDO13:\n\t\tcase S2MPU02_LDO14:\n\t\tcase S2MPU02_LDO15:\n\t\tcase S2MPU02_LDO17:\n\t\tcase S2MPU02_BUCK7:\n\t\t\tstate = S2MPU02_DISABLE_SUSPEND;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstate = S2MPU02_ENABLE_SUSPEND;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tret = regmap_read(rdev->regmap, rdev->desc->enable_reg, &val);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tset_bit(rdev_id, s2mps11->suspend_state);\n\t \n\tif (!(val & rdev->desc->enable_mask))\n\t\treturn 0;\n\n\treturn regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\t\t  rdev->desc->enable_mask, state);\n}\n\nstatic const struct regulator_ops s2mps11_ldo_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= s2mps11_regulator_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_disable\t= s2mps11_regulator_set_suspend_disable,\n};\n\nstatic const struct regulator_ops s2mps11_buck_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= s2mps11_regulator_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= s2mps11_regulator_set_voltage_time_sel,\n\t.set_ramp_delay\t\t= s2mps11_set_ramp_delay,\n\t.set_suspend_disable\t= s2mps11_regulator_set_suspend_disable,\n};\n\n#define regulator_desc_s2mps11_ldo(num, step) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPS11_LDO##num,\t\t\\\n\t.ops\t\t= &s2mps11_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.ramp_delay\t= RAMP_DELAY_12_MVUS,\t\t\\\n\t.min_uV\t\t= MIN_800_MV,\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\\\n\t.n_voltages\t= S2MPS11_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPS11_REG_L1CTRL + num - 1,\t\\\n\t.vsel_mask\t= S2MPS11_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPS11_REG_L1CTRL + num - 1,\t\\\n\t.enable_mask\t= S2MPS11_ENABLE_MASK\t\t\\\n}\n\n#define regulator_desc_s2mps11_buck1_4(num) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS11_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps11_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= MIN_650_MV,\t\t\t\t\\\n\t.uV_step\t= STEP_6_25_MV,\t\t\t\t\\\n\t.linear_min_sel\t= 8,\t\t\t\t\t\\\n\t.n_voltages\t= S2MPS11_BUCK12346_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS11_RAMP_DELAY,\t\t\t\\\n\t.vsel_reg\t= S2MPS11_REG_B1CTRL2 + (num - 1) * 2,\t\\\n\t.vsel_mask\t= S2MPS11_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS11_REG_B1CTRL1 + (num - 1) * 2,\t\\\n\t.enable_mask\t= S2MPS11_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps11_buck5 {\t\t\t\t\\\n\t.name\t\t= \"BUCK5\",\t\t\t\t\\\n\t.id\t\t= S2MPS11_BUCK5,\t\t\t\\\n\t.ops\t\t= &s2mps11_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= MIN_650_MV,\t\t\t\t\\\n\t.uV_step\t= STEP_6_25_MV,\t\t\t\t\\\n\t.linear_min_sel\t= 8,\t\t\t\t\t\\\n\t.n_voltages\t= S2MPS11_BUCK5_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS11_RAMP_DELAY,\t\t\t\\\n\t.vsel_reg\t= S2MPS11_REG_B5CTRL2,\t\t\t\\\n\t.vsel_mask\t= S2MPS11_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS11_REG_B5CTRL1,\t\t\t\\\n\t.enable_mask\t= S2MPS11_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps11_buck67810(num, min, step, min_sel, voltages) {\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS11_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps11_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.linear_min_sel\t= min_sel,\t\t\t\t\\\n\t.n_voltages\t= voltages,\t\t\t\t\\\n\t.ramp_delay\t= S2MPS11_RAMP_DELAY,\t\t\t\\\n\t.vsel_reg\t= S2MPS11_REG_B6CTRL2 + (num - 6) * 2,\t\\\n\t.vsel_mask\t= S2MPS11_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS11_REG_B6CTRL1 + (num - 6) * 2,\t\\\n\t.enable_mask\t= S2MPS11_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps11_buck9 {\t\t\t\t\\\n\t.name\t\t= \"BUCK9\",\t\t\t\t\\\n\t.id\t\t= S2MPS11_BUCK9,\t\t\t\\\n\t.ops\t\t= &s2mps11_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= MIN_3000_MV,\t\t\t\t\\\n\t.uV_step\t= STEP_25_MV,\t\t\t\t\\\n\t.n_voltages\t= S2MPS11_BUCK9_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS11_RAMP_DELAY,\t\t\t\\\n\t.vsel_reg\t= S2MPS11_REG_B9CTRL2,\t\t\t\\\n\t.vsel_mask\t= S2MPS11_BUCK9_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS11_REG_B9CTRL1,\t\t\t\\\n\t.enable_mask\t= S2MPS11_ENABLE_MASK\t\t\t\\\n}\n\nstatic const struct regulator_desc s2mps11_regulators[] = {\n\tregulator_desc_s2mps11_ldo(1, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(2, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(3, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(4, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(5, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(6, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(7, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(8, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(9, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(10, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(11, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(12, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(13, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(14, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(15, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(16, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(17, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(18, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(19, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(20, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(21, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(22, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(23, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(24, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(25, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(26, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(27, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(28, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(29, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(30, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(31, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(32, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(33, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(34, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(35, STEP_25_MV),\n\tregulator_desc_s2mps11_ldo(36, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(37, STEP_50_MV),\n\tregulator_desc_s2mps11_ldo(38, STEP_50_MV),\n\tregulator_desc_s2mps11_buck1_4(1),\n\tregulator_desc_s2mps11_buck1_4(2),\n\tregulator_desc_s2mps11_buck1_4(3),\n\tregulator_desc_s2mps11_buck1_4(4),\n\tregulator_desc_s2mps11_buck5,\n\tregulator_desc_s2mps11_buck67810(6, MIN_650_MV, STEP_6_25_MV, 8,\n\t\t\t\t\t S2MPS11_BUCK12346_N_VOLTAGES),\n\tregulator_desc_s2mps11_buck67810(7, MIN_750_MV, STEP_12_5_MV, 0,\n\t\t\t\t\t S2MPS11_BUCK7810_N_VOLTAGES),\n\tregulator_desc_s2mps11_buck67810(8, MIN_750_MV, STEP_12_5_MV, 0,\n\t\t\t\t\t S2MPS11_BUCK7810_N_VOLTAGES),\n\tregulator_desc_s2mps11_buck9,\n\tregulator_desc_s2mps11_buck67810(10, MIN_750_MV, STEP_12_5_MV, 0,\n\t\t\t\t\t S2MPS11_BUCK7810_N_VOLTAGES),\n};\n\nstatic const struct regulator_ops s2mps14_reg_ops;\n\n#define regulator_desc_s2mps13_ldo(num, min, step, min_sel) {\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS13_LDO##num,\t\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.linear_min_sel\t= min_sel,\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_LDO_N_VOLTAGES,\t\t\\\n\t.vsel_reg\t= S2MPS13_REG_L1CTRL + num - 1,\t\t\\\n\t.vsel_mask\t= S2MPS14_LDO_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS13_REG_L1CTRL + num - 1,\t\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps13_buck(num, min, step, min_sel) {\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS13_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.linear_min_sel\t= min_sel,\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_BUCK_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS13_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPS13_REG_B1OUT + (num - 1) * 2,\t\\\n\t.vsel_mask\t= S2MPS14_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS13_REG_B1CTRL + (num - 1) * 2,\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps13_buck7(num, min, step, min_sel) {\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS13_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.linear_min_sel\t= min_sel,\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_BUCK_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS13_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPS13_REG_B1OUT + (num) * 2 - 1,\t\\\n\t.vsel_mask\t= S2MPS14_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS13_REG_B1CTRL + (num - 1) * 2,\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\t\\\n}\n\n#define regulator_desc_s2mps13_buck8_10(num, min, step, min_sel) {\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS13_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.linear_min_sel\t= min_sel,\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_BUCK_N_VOLTAGES,\t\t\\\n\t.ramp_delay\t= S2MPS13_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPS13_REG_B1OUT + (num) * 2 - 1,\t\\\n\t.vsel_mask\t= S2MPS14_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS13_REG_B1CTRL + (num) * 2 - 1,\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\t\\\n}\n\nstatic const struct regulator_desc s2mps13_regulators[] = {\n\tregulator_desc_s2mps13_ldo(1,  MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(2,  MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(3,  MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(4,  MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(5,  MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(6,  MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(7,  MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(8,  MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(9,  MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(10, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(11, MIN_800_MV,  STEP_25_MV,   0x10),\n\tregulator_desc_s2mps13_ldo(12, MIN_800_MV,  STEP_25_MV,   0x10),\n\tregulator_desc_s2mps13_ldo(13, MIN_800_MV,  STEP_25_MV,   0x10),\n\tregulator_desc_s2mps13_ldo(14, MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(15, MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(16, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(17, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(18, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(19, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(20, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(21, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(22, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(23, MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(24, MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(25, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(26, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(27, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(28, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(29, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(30, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(31, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(32, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(33, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(34, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(35, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(36, MIN_800_MV,  STEP_12_5_MV, 0x00),\n\tregulator_desc_s2mps13_ldo(37, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(38, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_ldo(39, MIN_1000_MV, STEP_25_MV,   0x08),\n\tregulator_desc_s2mps13_ldo(40, MIN_1400_MV, STEP_50_MV,   0x0C),\n\tregulator_desc_s2mps13_buck(1,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck(2,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck(3,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck(4,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck(5,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck(6,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck7(7,  MIN_500_MV,  STEP_6_25_MV, 0x10),\n\tregulator_desc_s2mps13_buck8_10(8,  MIN_1000_MV, STEP_12_5_MV, 0x20),\n\tregulator_desc_s2mps13_buck8_10(9,  MIN_1000_MV, STEP_12_5_MV, 0x20),\n\tregulator_desc_s2mps13_buck8_10(10, MIN_500_MV,  STEP_6_25_MV, 0x10),\n};\n\nstatic const struct regulator_ops s2mps14_reg_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= s2mps11_regulator_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_disable\t= s2mps11_regulator_set_suspend_disable,\n};\n\n#define regulator_desc_s2mps14_ldo(num, min, step) {\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPS14_LDO##num,\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPS14_REG_L1CTRL + num - 1,\t\\\n\t.vsel_mask\t= S2MPS14_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPS14_REG_L1CTRL + num - 1,\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\\\n}\n\n#define regulator_desc_s2mps14_buck(num, min, step, min_sel) {\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPS14_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mps14_reg_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= min,\t\t\t\t\t\\\n\t.uV_step\t= step,\t\t\t\t\t\\\n\t.n_voltages\t= S2MPS14_BUCK_N_VOLTAGES,\t\t\\\n\t.linear_min_sel = min_sel,\t\t\t\t\\\n\t.ramp_delay\t= S2MPS14_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPS14_REG_B1CTRL2 + (num - 1) * 2,\t\\\n\t.vsel_mask\t= S2MPS14_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPS14_REG_B1CTRL1 + (num - 1) * 2,\t\\\n\t.enable_mask\t= S2MPS14_ENABLE_MASK\t\t\t\\\n}\n\nstatic const struct regulator_desc s2mps14_regulators[] = {\n\tregulator_desc_s2mps14_ldo(1, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(2, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(3, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(4, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(5, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(6, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(7, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(8, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(9, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(10, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(11, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(12, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(13, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(14, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(15, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(16, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(17, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(18, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(19, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(20, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(21, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(22, MIN_800_MV, STEP_12_5_MV),\n\tregulator_desc_s2mps14_ldo(23, MIN_800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(24, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_ldo(25, MIN_1800_MV, STEP_25_MV),\n\tregulator_desc_s2mps14_buck(1, MIN_600_MV, STEP_6_25_MV,\n\t\t\t\t    S2MPS14_BUCK1235_START_SEL),\n\tregulator_desc_s2mps14_buck(2, MIN_600_MV, STEP_6_25_MV,\n\t\t\t\t    S2MPS14_BUCK1235_START_SEL),\n\tregulator_desc_s2mps14_buck(3, MIN_600_MV, STEP_6_25_MV,\n\t\t\t\t    S2MPS14_BUCK1235_START_SEL),\n\tregulator_desc_s2mps14_buck(4, MIN_1400_MV, STEP_12_5_MV,\n\t\t\t\t    S2MPS14_BUCK4_START_SEL),\n\tregulator_desc_s2mps14_buck(5, MIN_600_MV, STEP_6_25_MV,\n\t\t\t\t    S2MPS14_BUCK1235_START_SEL),\n};\n\nstatic const struct regulator_ops s2mps15_reg_ldo_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear_range,\n\t.map_voltage\t\t= regulator_map_voltage_linear_range,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= regulator_enable_regmap,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n};\n\nstatic const struct regulator_ops s2mps15_reg_buck_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear_range,\n\t.map_voltage\t\t= regulator_map_voltage_linear_range,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= regulator_enable_regmap,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n};\n\n#define regulator_desc_s2mps15_ldo(num, range) {\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPS15_LDO##num,\t\t\\\n\t.ops\t\t= &s2mps15_reg_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.linear_ranges\t= range,\t\t\t\\\n\t.n_linear_ranges = ARRAY_SIZE(range),\t\t\\\n\t.n_voltages\t= S2MPS15_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPS15_REG_L1CTRL + num - 1,\t\\\n\t.vsel_mask\t= S2MPS15_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPS15_REG_L1CTRL + num - 1,\t\\\n\t.enable_mask\t= S2MPS15_ENABLE_MASK\t\t\\\n}\n\n#define regulator_desc_s2mps15_buck(num, range) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\t\\\n\t.id\t\t= S2MPS15_BUCK##num,\t\t\t\t\\\n\t.ops\t\t= &s2mps15_reg_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.linear_ranges\t= range,\t\t\t\t\t\\\n\t.n_linear_ranges = ARRAY_SIZE(range),\t\t\t\t\\\n\t.ramp_delay\t= 12500,\t\t\t\t\t\\\n\t.n_voltages\t= S2MPS15_BUCK_N_VOLTAGES,\t\t\t\\\n\t.vsel_reg\t= S2MPS15_REG_B1CTRL2 + ((num - 1) * 2),\t\\\n\t.vsel_mask\t= S2MPS15_BUCK_VSEL_MASK,\t\t\t\\\n\t.enable_reg\t= S2MPS15_REG_B1CTRL1 + ((num - 1) * 2),\t\\\n\t.enable_mask\t= S2MPS15_ENABLE_MASK\t\t\t\t\\\n}\n\n \nstatic const struct linear_range s2mps15_ldo_voltage_ranges1[] = {\n\tREGULATOR_LINEAR_RANGE(1000000, 0xc, 0x38, 25000),\n};\n\n \nstatic const struct linear_range s2mps15_ldo_voltage_ranges2[] = {\n\tREGULATOR_LINEAR_RANGE(1800000, 0x0, 0x3f, 25000),\n};\n\n \nstatic const struct linear_range s2mps15_ldo_voltage_ranges3[] = {\n\tREGULATOR_LINEAR_RANGE(700000, 0x0, 0x34, 12500),\n};\n\n \nstatic const struct linear_range s2mps15_ldo_voltage_ranges4[] = {\n\tREGULATOR_LINEAR_RANGE(700000, 0x10, 0x20, 25000),\n};\n\n \nstatic const struct linear_range s2mps15_ldo_voltage_ranges5[] = {\n\tREGULATOR_LINEAR_RANGE(500000, 0x0, 0x20, 12500),\n};\n\n \nstatic const struct linear_range s2mps15_buck_voltage_ranges1[] = {\n\tREGULATOR_LINEAR_RANGE(500000, 0x20, 0xc0, 6250),\n};\n\n \nstatic const struct linear_range s2mps15_buck_voltage_ranges2[] = {\n\tREGULATOR_LINEAR_RANGE(1000000, 0x20, 0x78, 12500),\n};\n\nstatic const struct regulator_desc s2mps15_regulators[] = {\n\tregulator_desc_s2mps15_ldo(1, s2mps15_ldo_voltage_ranges5),\n\tregulator_desc_s2mps15_ldo(2, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(3, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(4, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(5, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(6, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(7, s2mps15_ldo_voltage_ranges4),\n\tregulator_desc_s2mps15_ldo(8, s2mps15_ldo_voltage_ranges4),\n\tregulator_desc_s2mps15_ldo(9, s2mps15_ldo_voltage_ranges4),\n\tregulator_desc_s2mps15_ldo(10, s2mps15_ldo_voltage_ranges4),\n\tregulator_desc_s2mps15_ldo(11, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(12, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(13, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(14, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(15, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(16, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(17, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(18, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(19, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(20, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(21, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(22, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(23, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_ldo(24, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(25, s2mps15_ldo_voltage_ranges2),\n\tregulator_desc_s2mps15_ldo(26, s2mps15_ldo_voltage_ranges3),\n\tregulator_desc_s2mps15_ldo(27, s2mps15_ldo_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(1, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(2, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(3, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(4, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(5, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(6, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(7, s2mps15_buck_voltage_ranges1),\n\tregulator_desc_s2mps15_buck(8, s2mps15_buck_voltage_ranges2),\n\tregulator_desc_s2mps15_buck(9, s2mps15_buck_voltage_ranges2),\n\tregulator_desc_s2mps15_buck(10, s2mps15_buck_voltage_ranges2),\n};\n\nstatic int s2mps14_pmic_enable_ext_control(struct s2mps11_info *s2mps11,\n\t\tstruct regulator_dev *rdev)\n{\n\treturn regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\trdev->desc->enable_mask, S2MPS14_ENABLE_EXT_CONTROL);\n}\n\nstatic void s2mps14_pmic_dt_parse_ext_control_gpio(struct platform_device *pdev,\n\t\tstruct of_regulator_match *rdata, struct s2mps11_info *s2mps11)\n{\n\tstruct gpio_desc **gpio = s2mps11->ext_control_gpiod;\n\tunsigned int i;\n\tunsigned int valid_regulators[3] = { S2MPS14_LDO10, S2MPS14_LDO11,\n\t\tS2MPS14_LDO12 };\n\n\tfor (i = 0; i < ARRAY_SIZE(valid_regulators); i++) {\n\t\tunsigned int reg = valid_regulators[i];\n\n\t\tif (!rdata[reg].init_data || !rdata[reg].of_node)\n\t\t\tcontinue;\n\n\t\tgpio[reg] = devm_fwnode_gpiod_get(&pdev->dev,\n\t\t\t\tof_fwnode_handle(rdata[reg].of_node),\n\t\t\t\t\"samsung,ext-control\",\n\t\t\t\tGPIOD_OUT_HIGH | GPIOD_FLAGS_BIT_NONEXCLUSIVE,\n\t\t\t\t\"s2mps11-regulator\");\n\t\tif (PTR_ERR(gpio[reg]) == -ENOENT)\n\t\t\tgpio[reg] = NULL;\n\t\telse if (IS_ERR(gpio[reg])) {\n\t\t\tdev_err(&pdev->dev, \"Failed to get control GPIO for %d/%s\\n\",\n\t\t\t\treg, rdata[reg].name);\n\t\t\tgpio[reg] = NULL;\n\t\t\tcontinue;\n\t\t}\n\t\tif (gpio[reg])\n\t\t\tdev_dbg(&pdev->dev, \"Using GPIO for ext-control over %d/%s\\n\",\n\t\t\t\treg, rdata[reg].name);\n\t}\n}\n\nstatic int s2mps11_pmic_dt_parse(struct platform_device *pdev,\n\t\tstruct of_regulator_match *rdata, struct s2mps11_info *s2mps11,\n\t\tunsigned int rdev_num)\n{\n\tstruct device_node *reg_np;\n\n\treg_np = of_get_child_by_name(pdev->dev.parent->of_node, \"regulators\");\n\tif (!reg_np) {\n\t\tdev_err(&pdev->dev, \"could not find regulators sub-node\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tof_regulator_match(&pdev->dev, reg_np, rdata, rdev_num);\n\tif (s2mps11->dev_type == S2MPS14X)\n\t\ts2mps14_pmic_dt_parse_ext_control_gpio(pdev, rdata, s2mps11);\n\n\tof_node_put(reg_np);\n\n\treturn 0;\n}\n\nstatic int s2mpu02_set_ramp_delay(struct regulator_dev *rdev, int ramp_delay)\n{\n\tunsigned int ramp_val, ramp_shift, ramp_reg;\n\tint rdev_id = rdev_get_id(rdev);\n\n\tswitch (rdev_id) {\n\tcase S2MPU02_BUCK1:\n\t\tramp_shift = S2MPU02_BUCK1_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPU02_BUCK2:\n\t\tramp_shift = S2MPU02_BUCK2_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPU02_BUCK3:\n\t\tramp_shift = S2MPU02_BUCK3_RAMP_SHIFT;\n\t\tbreak;\n\tcase S2MPU02_BUCK4:\n\t\tramp_shift = S2MPU02_BUCK4_RAMP_SHIFT;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\tramp_reg = S2MPU02_REG_RAMP1;\n\tramp_val = get_ramp_delay(ramp_delay);\n\n\treturn regmap_update_bits(rdev->regmap, ramp_reg,\n\t\t\t\t  S2MPU02_BUCK1234_RAMP_MASK << ramp_shift,\n\t\t\t\t  ramp_val << ramp_shift);\n}\n\nstatic const struct regulator_ops s2mpu02_ldo_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= s2mps11_regulator_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_disable\t= s2mps11_regulator_set_suspend_disable,\n};\n\nstatic const struct regulator_ops s2mpu02_buck_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= s2mps11_regulator_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_disable\t= s2mps11_regulator_set_suspend_disable,\n\t.set_ramp_delay\t\t= s2mpu02_set_ramp_delay,\n};\n\n#define regulator_desc_s2mpu02_ldo1(num) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPU02_LDO##num,\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= S2MPU02_LDO_MIN_900MV,\t\\\n\t.uV_step\t= S2MPU02_LDO_STEP_12_5MV,\t\\\n\t.linear_min_sel\t= S2MPU02_LDO_GROUP1_START_SEL,\t\\\n\t.n_voltages\t= S2MPU02_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPU02_REG_L1CTRL,\t\t\\\n\t.vsel_mask\t= S2MPU02_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPU02_REG_L1CTRL,\t\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\\\n}\n#define regulator_desc_s2mpu02_ldo2(num) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPU02_LDO##num,\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= S2MPU02_LDO_MIN_1050MV,\t\\\n\t.uV_step\t= S2MPU02_LDO_STEP_25MV,\t\\\n\t.linear_min_sel\t= S2MPU02_LDO_GROUP2_START_SEL,\t\\\n\t.n_voltages\t= S2MPU02_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPU02_REG_L2CTRL1,\t\t\\\n\t.vsel_mask\t= S2MPU02_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPU02_REG_L2CTRL1,\t\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\\\n}\n#define regulator_desc_s2mpu02_ldo3(num) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPU02_LDO##num,\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= S2MPU02_LDO_MIN_900MV,\t\\\n\t.uV_step\t= S2MPU02_LDO_STEP_12_5MV,\t\\\n\t.linear_min_sel\t= S2MPU02_LDO_GROUP1_START_SEL,\t\\\n\t.n_voltages\t= S2MPU02_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.vsel_mask\t= S2MPU02_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\\\n}\n#define regulator_desc_s2mpu02_ldo4(num) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPU02_LDO##num,\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= S2MPU02_LDO_MIN_1050MV,\t\\\n\t.uV_step\t= S2MPU02_LDO_STEP_25MV,\t\\\n\t.linear_min_sel\t= S2MPU02_LDO_GROUP2_START_SEL,\t\\\n\t.n_voltages\t= S2MPU02_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.vsel_mask\t= S2MPU02_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\\\n}\n#define regulator_desc_s2mpu02_ldo5(num) {\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\\\n\t.id\t\t= S2MPU02_LDO##num,\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\\\n\t.min_uV\t\t= S2MPU02_LDO_MIN_1600MV,\t\\\n\t.uV_step\t= S2MPU02_LDO_STEP_50MV,\t\\\n\t.linear_min_sel\t= S2MPU02_LDO_GROUP3_START_SEL,\t\\\n\t.n_voltages\t= S2MPU02_LDO_N_VOLTAGES,\t\\\n\t.vsel_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.vsel_mask\t= S2MPU02_LDO_VSEL_MASK,\t\\\n\t.enable_reg\t= S2MPU02_REG_L3CTRL + num - 3,\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\\\n}\n\n#define regulator_desc_s2mpu02_buck1234(num) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPU02_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mpu02_buck_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= S2MPU02_BUCK1234_MIN_600MV,\t\t\\\n\t.uV_step\t= S2MPU02_BUCK1234_STEP_6_25MV,\t\t\\\n\t.n_voltages\t= S2MPU02_BUCK_N_VOLTAGES,\t\t\\\n\t.linear_min_sel = S2MPU02_BUCK1234_START_SEL,\t\t\\\n\t.ramp_delay\t= S2MPU02_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPU02_REG_B1CTRL2 + (num - 1) * 2,\t\\\n\t.vsel_mask\t= S2MPU02_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPU02_REG_B1CTRL1 + (num - 1) * 2,\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\t\\\n}\n#define regulator_desc_s2mpu02_buck5(num) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPU02_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= S2MPU02_BUCK5_MIN_1081_25MV,\t\t\\\n\t.uV_step\t= S2MPU02_BUCK5_STEP_6_25MV,\t\t\\\n\t.n_voltages\t= S2MPU02_BUCK_N_VOLTAGES,\t\t\\\n\t.linear_min_sel = S2MPU02_BUCK5_START_SEL,\t\t\\\n\t.ramp_delay\t= S2MPU02_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPU02_REG_B5CTRL2,\t\t\t\\\n\t.vsel_mask\t= S2MPU02_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPU02_REG_B5CTRL1,\t\t\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\t\\\n}\n#define regulator_desc_s2mpu02_buck6(num) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPU02_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= S2MPU02_BUCK6_MIN_1700MV,\t\t\\\n\t.uV_step\t= S2MPU02_BUCK6_STEP_2_50MV,\t\t\\\n\t.n_voltages\t= S2MPU02_BUCK_N_VOLTAGES,\t\t\\\n\t.linear_min_sel = S2MPU02_BUCK6_START_SEL,\t\t\\\n\t.ramp_delay\t= S2MPU02_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPU02_REG_B6CTRL2,\t\t\t\\\n\t.vsel_mask\t= S2MPU02_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPU02_REG_B6CTRL1,\t\t\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\t\\\n}\n#define regulator_desc_s2mpu02_buck7(num) {\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\\\n\t.id\t\t= S2MPU02_BUCK##num,\t\t\t\\\n\t.ops\t\t= &s2mpu02_ldo_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\\\n\t.min_uV\t\t= S2MPU02_BUCK7_MIN_900MV,\t\t\\\n\t.uV_step\t= S2MPU02_BUCK7_STEP_6_25MV,\t\t\\\n\t.n_voltages\t= S2MPU02_BUCK_N_VOLTAGES,\t\t\\\n\t.linear_min_sel = S2MPU02_BUCK7_START_SEL,\t\t\\\n\t.ramp_delay\t= S2MPU02_BUCK_RAMP_DELAY,\t\t\\\n\t.vsel_reg\t= S2MPU02_REG_B7CTRL2,\t\t\t\\\n\t.vsel_mask\t= S2MPU02_BUCK_VSEL_MASK,\t\t\\\n\t.enable_reg\t= S2MPU02_REG_B7CTRL1,\t\t\t\\\n\t.enable_mask\t= S2MPU02_ENABLE_MASK\t\t\t\\\n}\n\nstatic const struct regulator_desc s2mpu02_regulators[] = {\n\tregulator_desc_s2mpu02_ldo1(1),\n\tregulator_desc_s2mpu02_ldo2(2),\n\tregulator_desc_s2mpu02_ldo4(3),\n\tregulator_desc_s2mpu02_ldo5(4),\n\tregulator_desc_s2mpu02_ldo4(5),\n\tregulator_desc_s2mpu02_ldo3(6),\n\tregulator_desc_s2mpu02_ldo3(7),\n\tregulator_desc_s2mpu02_ldo4(8),\n\tregulator_desc_s2mpu02_ldo5(9),\n\tregulator_desc_s2mpu02_ldo3(10),\n\tregulator_desc_s2mpu02_ldo4(11),\n\tregulator_desc_s2mpu02_ldo5(12),\n\tregulator_desc_s2mpu02_ldo5(13),\n\tregulator_desc_s2mpu02_ldo5(14),\n\tregulator_desc_s2mpu02_ldo5(15),\n\tregulator_desc_s2mpu02_ldo5(16),\n\tregulator_desc_s2mpu02_ldo4(17),\n\tregulator_desc_s2mpu02_ldo5(18),\n\tregulator_desc_s2mpu02_ldo3(19),\n\tregulator_desc_s2mpu02_ldo4(20),\n\tregulator_desc_s2mpu02_ldo5(21),\n\tregulator_desc_s2mpu02_ldo5(22),\n\tregulator_desc_s2mpu02_ldo5(23),\n\tregulator_desc_s2mpu02_ldo4(24),\n\tregulator_desc_s2mpu02_ldo5(25),\n\tregulator_desc_s2mpu02_ldo4(26),\n\tregulator_desc_s2mpu02_ldo5(27),\n\tregulator_desc_s2mpu02_ldo5(28),\n\tregulator_desc_s2mpu02_buck1234(1),\n\tregulator_desc_s2mpu02_buck1234(2),\n\tregulator_desc_s2mpu02_buck1234(3),\n\tregulator_desc_s2mpu02_buck1234(4),\n\tregulator_desc_s2mpu02_buck5(5),\n\tregulator_desc_s2mpu02_buck6(6),\n\tregulator_desc_s2mpu02_buck7(7),\n};\n\nstatic int s2mps11_pmic_probe(struct platform_device *pdev)\n{\n\tstruct sec_pmic_dev *iodev = dev_get_drvdata(pdev->dev.parent);\n\tstruct of_regulator_match *rdata = NULL;\n\tstruct regulator_config config = { };\n\tstruct s2mps11_info *s2mps11;\n\tunsigned int rdev_num = 0;\n\tint i, ret = 0;\n\tconst struct regulator_desc *regulators;\n\n\ts2mps11 = devm_kzalloc(&pdev->dev, sizeof(struct s2mps11_info),\n\t\t\t\tGFP_KERNEL);\n\tif (!s2mps11)\n\t\treturn -ENOMEM;\n\n\ts2mps11->dev_type = platform_get_device_id(pdev)->driver_data;\n\tswitch (s2mps11->dev_type) {\n\tcase S2MPS11X:\n\t\trdev_num = ARRAY_SIZE(s2mps11_regulators);\n\t\tregulators = s2mps11_regulators;\n\t\tBUILD_BUG_ON(S2MPS_REGULATOR_MAX < ARRAY_SIZE(s2mps11_regulators));\n\t\tbreak;\n\tcase S2MPS13X:\n\t\trdev_num = ARRAY_SIZE(s2mps13_regulators);\n\t\tregulators = s2mps13_regulators;\n\t\tBUILD_BUG_ON(S2MPS_REGULATOR_MAX < ARRAY_SIZE(s2mps13_regulators));\n\t\tbreak;\n\tcase S2MPS14X:\n\t\trdev_num = ARRAY_SIZE(s2mps14_regulators);\n\t\tregulators = s2mps14_regulators;\n\t\tBUILD_BUG_ON(S2MPS_REGULATOR_MAX < ARRAY_SIZE(s2mps14_regulators));\n\t\tbreak;\n\tcase S2MPS15X:\n\t\trdev_num = ARRAY_SIZE(s2mps15_regulators);\n\t\tregulators = s2mps15_regulators;\n\t\tBUILD_BUG_ON(S2MPS_REGULATOR_MAX < ARRAY_SIZE(s2mps15_regulators));\n\t\tbreak;\n\tcase S2MPU02:\n\t\trdev_num = ARRAY_SIZE(s2mpu02_regulators);\n\t\tregulators = s2mpu02_regulators;\n\t\tBUILD_BUG_ON(S2MPS_REGULATOR_MAX < ARRAY_SIZE(s2mpu02_regulators));\n\t\tbreak;\n\tdefault:\n\t\tdev_err(&pdev->dev, \"Invalid device type: %u\\n\",\n\t\t\t\t    s2mps11->dev_type);\n\t\treturn -EINVAL;\n\t}\n\n\ts2mps11->ext_control_gpiod = devm_kcalloc(&pdev->dev, rdev_num,\n\t\t\t       sizeof(*s2mps11->ext_control_gpiod), GFP_KERNEL);\n\tif (!s2mps11->ext_control_gpiod)\n\t\treturn -ENOMEM;\n\n\trdata = kcalloc(rdev_num, sizeof(*rdata), GFP_KERNEL);\n\tif (!rdata)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < rdev_num; i++)\n\t\trdata[i].name = regulators[i].name;\n\n\tret = s2mps11_pmic_dt_parse(pdev, rdata, s2mps11, rdev_num);\n\tif (ret)\n\t\tgoto out;\n\n\tplatform_set_drvdata(pdev, s2mps11);\n\n\tconfig.dev = &pdev->dev;\n\tconfig.regmap = iodev->regmap_pmic;\n\tconfig.driver_data = s2mps11;\n\tfor (i = 0; i < rdev_num; i++) {\n\t\tstruct regulator_dev *regulator;\n\n\t\tconfig.init_data = rdata[i].init_data;\n\t\tconfig.of_node = rdata[i].of_node;\n\t\tconfig.ena_gpiod = s2mps11->ext_control_gpiod[i];\n\t\t \n\t\tif (config.ena_gpiod)\n\t\t\tdevm_gpiod_unhinge(&pdev->dev, config.ena_gpiod);\n\t\tregulator = devm_regulator_register(&pdev->dev,\n\t\t\t\t\t\t&regulators[i], &config);\n\t\tif (IS_ERR(regulator)) {\n\t\t\tret = PTR_ERR(regulator);\n\t\t\tdev_err(&pdev->dev, \"regulator init failed for %d\\n\",\n\t\t\t\ti);\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (config.ena_gpiod) {\n\t\t\tret = s2mps14_pmic_enable_ext_control(s2mps11,\n\t\t\t\t\tregulator);\n\t\t\tif (ret < 0) {\n\t\t\t\tdev_err(&pdev->dev,\n\t\t\t\t\t\t\"failed to enable GPIO control over %s: %d\\n\",\n\t\t\t\t\t\tregulator->desc->name, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t}\n\nout:\n\tkfree(rdata);\n\n\treturn ret;\n}\n\nstatic const struct platform_device_id s2mps11_pmic_id[] = {\n\t{ \"s2mps11-regulator\", S2MPS11X},\n\t{ \"s2mps13-regulator\", S2MPS13X},\n\t{ \"s2mps14-regulator\", S2MPS14X},\n\t{ \"s2mps15-regulator\", S2MPS15X},\n\t{ \"s2mpu02-regulator\", S2MPU02},\n\t{ },\n};\nMODULE_DEVICE_TABLE(platform, s2mps11_pmic_id);\n\nstatic struct platform_driver s2mps11_pmic_driver = {\n\t.driver = {\n\t\t.name = \"s2mps11-pmic\",\n\t\t.probe_type = PROBE_PREFER_ASYNCHRONOUS,\n\t},\n\t.probe = s2mps11_pmic_probe,\n\t.id_table = s2mps11_pmic_id,\n};\n\nmodule_platform_driver(s2mps11_pmic_driver);\n\n \nMODULE_AUTHOR(\"Sangbeom Kim <sbkim73@samsung.com>\");\nMODULE_DESCRIPTION(\"Samsung S2MPS11/S2MPS14/S2MPS15/S2MPU02 Regulator Driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}