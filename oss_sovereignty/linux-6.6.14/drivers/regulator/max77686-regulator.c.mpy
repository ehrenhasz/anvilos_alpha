{
  "module_name": "max77686-regulator.c",
  "hash_id": "241fc78286fe1d5d3bfbb56fbdaa994809caa8c17962aa777e6e6139909b9093",
  "original_prompt": "Ingested from linux-6.6.14/drivers/regulator/max77686-regulator.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n\n\n#include <linux/kernel.h>\n#include <linux/bug.h>\n#include <linux/err.h>\n#include <linux/gpio/consumer.h>\n#include <linux/slab.h>\n#include <linux/platform_device.h>\n#include <linux/regulator/driver.h>\n#include <linux/regulator/machine.h>\n#include <linux/regulator/of_regulator.h>\n#include <linux/mfd/max77686.h>\n#include <linux/mfd/max77686-private.h>\n\n#define MAX77686_LDO_MINUV\t800000\n#define MAX77686_LDO_UVSTEP\t50000\n#define MAX77686_LDO_LOW_MINUV\t800000\n#define MAX77686_LDO_LOW_UVSTEP\t25000\n#define MAX77686_BUCK_MINUV\t750000\n#define MAX77686_BUCK_UVSTEP\t50000\n#define MAX77686_BUCK_ENABLE_TIME\t40\t\t \n#define MAX77686_DVS_ENABLE_TIME\t22\t\t \n#define MAX77686_RAMP_DELAY\t100000\t\t\t \n#define MAX77686_DVS_RAMP_DELAY\t27500\t\t\t \n#define MAX77686_DVS_MINUV\t600000\n#define MAX77686_DVS_UVSTEP\t12500\n\n \n#define MAX77686_GPIO_CONTROL\t\t0x0\n \n#define MAX77686_LDO_LOWPOWER\t\t0x1\n \n#define MAX77686_OFF_PWRREQ\t\t0x1\n \n#define MAX77686_LDO_LOWPOWER_PWRREQ\t0x2\n \n#define MAX77686_BUCK_LOWPOWER\t\t0x2\n#define MAX77686_NORMAL\t\t\t0x3\n\n#define MAX77686_OPMODE_SHIFT\t6\n#define MAX77686_OPMODE_BUCK234_SHIFT\t4\n#define MAX77686_OPMODE_MASK\t0x3\n\n#define MAX77686_VSEL_MASK\t0x3F\n#define MAX77686_DVS_VSEL_MASK\t0xFF\n\n#define MAX77686_RAMP_RATE_MASK\t0xC0\n\n#define MAX77686_REGULATORS\tMAX77686_REG_MAX\n#define MAX77686_LDOS\t\t26\n\nstruct max77686_data {\n\tstruct device *dev;\n\tDECLARE_BITMAP(gpio_enabled, MAX77686_REGULATORS);\n\n\t \n\tunsigned int opmode[MAX77686_REGULATORS];\n};\n\nstatic unsigned int max77686_get_opmode_shift(int id)\n{\n\tswitch (id) {\n\tcase MAX77686_BUCK1:\n\tcase MAX77686_BUCK5 ... MAX77686_BUCK9:\n\t\treturn 0;\n\tcase MAX77686_BUCK2 ... MAX77686_BUCK4:\n\t\treturn MAX77686_OPMODE_BUCK234_SHIFT;\n\tdefault:\n\t\t \n\t\treturn MAX77686_OPMODE_SHIFT;\n\t}\n}\n\n \nstatic unsigned int max77686_map_normal_mode(struct max77686_data *max77686,\n\t\t\t\t\t     int id)\n{\n\tswitch (id) {\n\tcase MAX77686_BUCK8:\n\tcase MAX77686_BUCK9:\n\tcase MAX77686_LDO20 ... MAX77686_LDO22:\n\t\tif (test_bit(id, max77686->gpio_enabled))\n\t\t\treturn MAX77686_GPIO_CONTROL;\n\t}\n\n\treturn MAX77686_NORMAL;\n}\n\n \nstatic int max77686_set_suspend_disable(struct regulator_dev *rdev)\n{\n\tunsigned int val, shift;\n\tstruct max77686_data *max77686 = rdev_get_drvdata(rdev);\n\tint ret, id = rdev_get_id(rdev);\n\n\tshift = max77686_get_opmode_shift(id);\n\tval = MAX77686_OFF_PWRREQ;\n\n\tret = regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\t\t rdev->desc->enable_mask, val << shift);\n\tif (ret)\n\t\treturn ret;\n\n\tmax77686->opmode[id] = val;\n\treturn 0;\n}\n\n \nstatic int max77686_set_suspend_mode(struct regulator_dev *rdev,\n\t\t\t\t     unsigned int mode)\n{\n\tstruct max77686_data *max77686 = rdev_get_drvdata(rdev);\n\tunsigned int val;\n\tint ret, id = rdev_get_id(rdev);\n\n\t \n\tif (id >= MAX77686_BUCK5)\n\t\treturn 0;\n\n\tswitch (mode) {\n\tcase REGULATOR_MODE_IDLE:\t\t\t \n\t\tval = MAX77686_LDO_LOWPOWER_PWRREQ;\n\t\tbreak;\n\tcase REGULATOR_MODE_NORMAL:\t\t\t \n\t\tval = max77686_map_normal_mode(max77686, id);\n\t\tbreak;\n\tdefault:\n\t\tpr_warn(\"%s: regulator_suspend_mode : 0x%x not supported\\n\",\n\t\t\trdev->desc->name, mode);\n\t\treturn -EINVAL;\n\t}\n\n\tret = regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\t\t  rdev->desc->enable_mask,\n\t\t\t\t  val << MAX77686_OPMODE_SHIFT);\n\tif (ret)\n\t\treturn ret;\n\n\tmax77686->opmode[id] = val;\n\treturn 0;\n}\n\n \nstatic int max77686_ldo_set_suspend_mode(struct regulator_dev *rdev,\n\t\t\t\t     unsigned int mode)\n{\n\tunsigned int val;\n\tstruct max77686_data *max77686 = rdev_get_drvdata(rdev);\n\tint ret, id = rdev_get_id(rdev);\n\n\tswitch (mode) {\n\tcase REGULATOR_MODE_STANDBY:\t\t\t \n\t\tval = MAX77686_OFF_PWRREQ;\n\t\tbreak;\n\tcase REGULATOR_MODE_IDLE:\t\t\t \n\t\tval = MAX77686_LDO_LOWPOWER_PWRREQ;\n\t\tbreak;\n\tcase REGULATOR_MODE_NORMAL:\t\t\t \n\t\tval = max77686_map_normal_mode(max77686, id);\n\t\tbreak;\n\tdefault:\n\t\tpr_warn(\"%s: regulator_suspend_mode : 0x%x not supported\\n\",\n\t\t\trdev->desc->name, mode);\n\t\treturn -EINVAL;\n\t}\n\n\tret = regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\t\t rdev->desc->enable_mask,\n\t\t\t\t val << MAX77686_OPMODE_SHIFT);\n\tif (ret)\n\t\treturn ret;\n\n\tmax77686->opmode[id] = val;\n\treturn 0;\n}\n\nstatic int max77686_enable(struct regulator_dev *rdev)\n{\n\tstruct max77686_data *max77686 = rdev_get_drvdata(rdev);\n\tunsigned int shift;\n\tint id = rdev_get_id(rdev);\n\n\tshift = max77686_get_opmode_shift(id);\n\n\tif (max77686->opmode[id] == MAX77686_OFF_PWRREQ)\n\t\tmax77686->opmode[id] = max77686_map_normal_mode(max77686, id);\n\n\treturn regmap_update_bits(rdev->regmap, rdev->desc->enable_reg,\n\t\t\t\t  rdev->desc->enable_mask,\n\t\t\t\t  max77686->opmode[id] << shift);\n}\n\nstatic int max77686_of_parse_cb(struct device_node *np,\n\t\tconst struct regulator_desc *desc,\n\t\tstruct regulator_config *config)\n{\n\tstruct max77686_data *max77686 = config->driver_data;\n\tint ret;\n\n\tswitch (desc->id) {\n\tcase MAX77686_BUCK8:\n\tcase MAX77686_BUCK9:\n\tcase MAX77686_LDO20 ... MAX77686_LDO22:\n\t\tconfig->ena_gpiod = fwnode_gpiod_get_index(\n\t\t\t\tof_fwnode_handle(np),\n\t\t\t\t\"maxim,ena\",\n\t\t\t\t0,\n\t\t\t\tGPIOD_OUT_HIGH | GPIOD_FLAGS_BIT_NONEXCLUSIVE,\n\t\t\t\t\"max77686-regulator\");\n\t\tif (IS_ERR(config->ena_gpiod))\n\t\t\tconfig->ena_gpiod = NULL;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tif (config->ena_gpiod) {\n\t\tset_bit(desc->id, max77686->gpio_enabled);\n\n\t\tret = regmap_update_bits(config->regmap, desc->enable_reg,\n\t\t\t\t\t desc->enable_mask,\n\t\t\t\t\t MAX77686_GPIO_CONTROL);\n\t\tif (ret) {\n\t\t\tgpiod_put(config->ena_gpiod);\n\t\t\tconfig->ena_gpiod = NULL;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic const unsigned int max77686_buck_dvs_ramp_table[] = {\n\t13750, 27500, 55000, 100000\n};\n\nstatic const struct regulator_ops max77686_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= max77686_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_mode\t= max77686_set_suspend_mode,\n};\n\nstatic const struct regulator_ops max77686_ldo_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= max77686_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_mode\t= max77686_ldo_set_suspend_mode,\n\t.set_suspend_disable\t= max77686_set_suspend_disable,\n};\n\nstatic const struct regulator_ops max77686_buck1_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= max77686_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_suspend_disable\t= max77686_set_suspend_disable,\n};\n\nstatic const struct regulator_ops max77686_buck_dvs_ops = {\n\t.list_voltage\t\t= regulator_list_voltage_linear,\n\t.map_voltage\t\t= regulator_map_voltage_linear,\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= max77686_enable,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.set_voltage_time_sel\t= regulator_set_voltage_time_sel,\n\t.set_ramp_delay\t\t= regulator_set_ramp_delay_regmap,\n\t.set_suspend_disable\t= max77686_set_suspend_disable,\n};\n\n#define regulator_desc_ldo(num)\t\t{\t\t\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"LDO\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.of_parse_cb\t= max77686_of_parse_cb,\t\t\t\t\\\n\t.id\t\t= MAX77686_LDO##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_LDO_MINUV,\t\t\t\t\\\n\t.uV_step\t= MAX77686_LDO_UVSTEP,\t\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK\t\t\t\t\\\n\t\t\t<< MAX77686_OPMODE_SHIFT,\t\t\t\\\n}\n#define regulator_desc_lpm_ldo(num)\t{\t\t\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"LDO\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.id\t\t= MAX77686_LDO##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_ldo_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_LDO_MINUV,\t\t\t\t\\\n\t.uV_step\t= MAX77686_LDO_UVSTEP,\t\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK\t\t\t\t\\\n\t\t\t<< MAX77686_OPMODE_SHIFT,\t\t\t\\\n}\n#define regulator_desc_ldo_low(num)\t\t{\t\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"LDO\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.id\t\t= MAX77686_LDO##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_ldo_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_LDO_LOW_MINUV,\t\t\t\\\n\t.uV_step\t= MAX77686_LDO_LOW_UVSTEP,\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK\t\t\t\t\\\n\t\t\t<< MAX77686_OPMODE_SHIFT,\t\t\t\\\n}\n#define regulator_desc_ldo1_low(num)\t\t{\t\t\t\\\n\t.name\t\t= \"LDO\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"LDO\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.id\t\t= MAX77686_LDO##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_LDO_LOW_MINUV,\t\t\t\\\n\t.uV_step\t= MAX77686_LDO_LOW_UVSTEP,\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_LDO1CTRL1 + num - 1,\t\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK\t\t\t\t\\\n\t\t\t<< MAX77686_OPMODE_SHIFT,\t\t\t\\\n}\n#define regulator_desc_buck(num)\t\t{\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"BUCK\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.of_parse_cb\t= max77686_of_parse_cb,\t\t\t\t\\\n\t.id\t\t= MAX77686_BUCK##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_BUCK_MINUV,\t\t\t\t\\\n\t.uV_step\t= MAX77686_BUCK_UVSTEP,\t\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.enable_time\t= MAX77686_BUCK_ENABLE_TIME,\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_BUCK5OUT + (num - 5) * 2,\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_BUCK5CTRL + (num - 5) * 2,\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK,\t\t\t\t\\\n}\n#define regulator_desc_buck1(num)\t\t{\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"BUCK\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.id\t\t= MAX77686_BUCK##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_buck1_ops,\t\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_BUCK_MINUV,\t\t\t\t\\\n\t.uV_step\t= MAX77686_BUCK_UVSTEP,\t\t\t\t\\\n\t.ramp_delay\t= MAX77686_RAMP_DELAY,\t\t\t\t\\\n\t.enable_time\t= MAX77686_BUCK_ENABLE_TIME,\t\t\t\\\n\t.n_voltages\t= MAX77686_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_BUCK1OUT,\t\t\t\\\n\t.vsel_mask\t= MAX77686_VSEL_MASK,\t\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_BUCK1CTRL,\t\t\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK,\t\t\t\t\\\n}\n#define regulator_desc_buck_dvs(num)\t\t{\t\t\t\\\n\t.name\t\t= \"BUCK\"#num,\t\t\t\t\t\\\n\t.of_match\t= of_match_ptr(\"BUCK\"#num),\t\t\t\\\n\t.regulators_node\t= of_match_ptr(\"voltage-regulators\"),\t\\\n\t.id\t\t= MAX77686_BUCK##num,\t\t\t\t\\\n\t.ops\t\t= &max77686_buck_dvs_ops,\t\t\t\\\n\t.type\t\t= REGULATOR_VOLTAGE,\t\t\t\t\\\n\t.owner\t\t= THIS_MODULE,\t\t\t\t\t\\\n\t.min_uV\t\t= MAX77686_DVS_MINUV,\t\t\t\t\\\n\t.uV_step\t= MAX77686_DVS_UVSTEP,\t\t\t\t\\\n\t.ramp_delay\t= MAX77686_DVS_RAMP_DELAY,\t\t\t\\\n\t.enable_time\t= MAX77686_DVS_ENABLE_TIME,\t\t\t\\\n\t.n_voltages\t= MAX77686_DVS_VSEL_MASK + 1,\t\t\t\\\n\t.vsel_reg\t= MAX77686_REG_BUCK2DVS1 + (num - 2) * 10,\t\\\n\t.vsel_mask\t= MAX77686_DVS_VSEL_MASK,\t\t\t\\\n\t.enable_reg\t= MAX77686_REG_BUCK2CTRL1 + (num - 2) * 10,\t\\\n\t.enable_mask\t= MAX77686_OPMODE_MASK\t\t\t\t\\\n\t\t\t<< MAX77686_OPMODE_BUCK234_SHIFT,\t\t\\\n\t.ramp_reg\t= MAX77686_REG_BUCK2CTRL1 + (num - 2) * 10,\t\\\n\t.ramp_mask\t= MAX77686_RAMP_RATE_MASK,\t\t\t\\\n\t.ramp_delay_table = max77686_buck_dvs_ramp_table,\t\t\\\n\t.n_ramp_values\t= ARRAY_SIZE(max77686_buck_dvs_ramp_table),\t\\\n}\n\nstatic const struct regulator_desc regulators[] = {\n\tregulator_desc_ldo1_low(1),\n\tregulator_desc_ldo_low(2),\n\tregulator_desc_ldo(3),\n\tregulator_desc_ldo(4),\n\tregulator_desc_ldo(5),\n\tregulator_desc_ldo_low(6),\n\tregulator_desc_ldo_low(7),\n\tregulator_desc_ldo_low(8),\n\tregulator_desc_ldo(9),\n\tregulator_desc_lpm_ldo(10),\n\tregulator_desc_lpm_ldo(11),\n\tregulator_desc_lpm_ldo(12),\n\tregulator_desc_ldo(13),\n\tregulator_desc_lpm_ldo(14),\n\tregulator_desc_ldo_low(15),\n\tregulator_desc_lpm_ldo(16),\n\tregulator_desc_ldo(17),\n\tregulator_desc_ldo(18),\n\tregulator_desc_ldo(19),\n\tregulator_desc_ldo(20),\n\tregulator_desc_ldo(21),\n\tregulator_desc_ldo(22),\n\tregulator_desc_ldo(23),\n\tregulator_desc_ldo(24),\n\tregulator_desc_ldo(25),\n\tregulator_desc_ldo(26),\n\tregulator_desc_buck1(1),\n\tregulator_desc_buck_dvs(2),\n\tregulator_desc_buck_dvs(3),\n\tregulator_desc_buck_dvs(4),\n\tregulator_desc_buck(5),\n\tregulator_desc_buck(6),\n\tregulator_desc_buck(7),\n\tregulator_desc_buck(8),\n\tregulator_desc_buck(9),\n};\n\nstatic int max77686_pmic_probe(struct platform_device *pdev)\n{\n\tstruct max77686_dev *iodev = dev_get_drvdata(pdev->dev.parent);\n\tstruct max77686_data *max77686;\n\tint i;\n\tstruct regulator_config config = { };\n\n\tdev_dbg(&pdev->dev, \"%s\\n\", __func__);\n\n\tmax77686 = devm_kzalloc(&pdev->dev, sizeof(struct max77686_data),\n\t\t\t\tGFP_KERNEL);\n\tif (!max77686)\n\t\treturn -ENOMEM;\n\n\tmax77686->dev = &pdev->dev;\n\tconfig.dev = iodev->dev;\n\tconfig.regmap = iodev->regmap;\n\tconfig.driver_data = max77686;\n\tplatform_set_drvdata(pdev, max77686);\n\n\tfor (i = 0; i < MAX77686_REGULATORS; i++) {\n\t\tstruct regulator_dev *rdev;\n\t\tint id = regulators[i].id;\n\n\t\tmax77686->opmode[id] = MAX77686_NORMAL;\n\t\trdev = devm_regulator_register(&pdev->dev,\n\t\t\t\t\t\t&regulators[i], &config);\n\t\tif (IS_ERR(rdev)) {\n\t\t\tint ret = PTR_ERR(rdev);\n\t\t\tdev_err(&pdev->dev,\n\t\t\t\t\"regulator init failed for %d: %d\\n\", i, ret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic const struct platform_device_id max77686_pmic_id[] = {\n\t{\"max77686-pmic\", 0},\n\t{ },\n};\nMODULE_DEVICE_TABLE(platform, max77686_pmic_id);\n\nstatic struct platform_driver max77686_pmic_driver = {\n\t.driver = {\n\t\t.name = \"max77686-pmic\",\n\t\t.probe_type = PROBE_PREFER_ASYNCHRONOUS,\n\t},\n\t.probe = max77686_pmic_probe,\n\t.id_table = max77686_pmic_id,\n};\n\nmodule_platform_driver(max77686_pmic_driver);\n\nMODULE_DESCRIPTION(\"MAXIM 77686 Regulator Driver\");\nMODULE_AUTHOR(\"Chiwoong Byun <woong.byun@samsung.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}