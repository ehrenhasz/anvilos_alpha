{
  "module_name": "tps65912-regulator.c",
  "hash_id": "e7c570758f5ac109c6fb64cb0fac36ae51fd59b9c08ac8e7b0309c4df048278e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/regulator/tps65912-regulator.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/platform_device.h>\n#include <linux/regulator/driver.h>\n\n#include <linux/mfd/tps65912.h>\n\nenum tps65912_regulators { DCDC1, DCDC2, DCDC3, DCDC4, LDO1, LDO2, LDO3,\n\tLDO4, LDO5, LDO6, LDO7, LDO8, LDO9, LDO10 };\n\n#define TPS65912_REGULATOR(_name, _id, _of_match, _ops, _vr, _er, _lr)\t\\\n\t[_id] = {\t\t\t\t\t\t\t\\\n\t\t.name\t\t\t= _name,\t\t\t\\\n\t\t.of_match\t\t= _of_match,\t\t\t\\\n\t\t.regulators_node\t= \"regulators\",\t\t\t\\\n\t\t.id\t\t\t= _id,\t\t\t\t\\\n\t\t.ops\t\t\t= &_ops,\t\t\t\\\n\t\t.n_voltages\t\t= 64,\t\t\t\t\\\n\t\t.type\t\t\t= REGULATOR_VOLTAGE,\t\t\\\n\t\t.owner\t\t\t= THIS_MODULE,\t\t\t\\\n\t\t.vsel_reg\t\t= _vr,\t\t\t\t\\\n\t\t.vsel_mask\t\t= 0x3f,\t\t\t\t\\\n\t\t.enable_reg\t\t= _er,\t\t\t\t\\\n\t\t.enable_mask\t\t= BIT(7),\t\t\t\\\n\t\t.volt_table\t\t= NULL,\t\t\t\t\\\n\t\t.linear_ranges\t\t= _lr,\t\t\t\t\\\n\t\t.n_linear_ranges\t= ARRAY_SIZE(_lr),\t\t\\\n\t}\n\nstatic const struct linear_range tps65912_dcdc_ranges[] = {\n\tREGULATOR_LINEAR_RANGE(500000, 0x0, 0x3f, 50000),\n};\n\nstatic const struct linear_range tps65912_ldo_ranges[] = {\n\tREGULATOR_LINEAR_RANGE(800000, 0x0, 0x20, 25000),\n\tREGULATOR_LINEAR_RANGE(1650000, 0x21, 0x3c, 50000),\n\tREGULATOR_LINEAR_RANGE(3100000, 0x3d, 0x3f, 100000),\n};\n\n \nstatic const struct regulator_ops tps65912_ops_dcdc = {\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= regulator_enable_regmap,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.list_voltage\t\t= regulator_list_voltage_linear_range,\n};\n\n \nstatic const struct regulator_ops tps65912_ops_ldo = {\n\t.is_enabled\t\t= regulator_is_enabled_regmap,\n\t.enable\t\t\t= regulator_enable_regmap,\n\t.disable\t\t= regulator_disable_regmap,\n\t.get_voltage_sel\t= regulator_get_voltage_sel_regmap,\n\t.set_voltage_sel\t= regulator_set_voltage_sel_regmap,\n\t.list_voltage\t\t= regulator_list_voltage_linear_range,\n\t.map_voltage\t\t= regulator_map_voltage_linear_range,\n};\n\nstatic const struct regulator_desc regulators[] = {\n\tTPS65912_REGULATOR(\"DCDC1\", DCDC1, \"dcdc1\", tps65912_ops_dcdc,\n\t\t\t   TPS65912_DCDC1_OP, TPS65912_DCDC1_CTRL,\n\t\t\t   tps65912_dcdc_ranges),\n\tTPS65912_REGULATOR(\"DCDC2\", DCDC2, \"dcdc2\", tps65912_ops_dcdc,\n\t\t\t   TPS65912_DCDC2_OP, TPS65912_DCDC2_CTRL,\n\t\t\t   tps65912_dcdc_ranges),\n\tTPS65912_REGULATOR(\"DCDC3\", DCDC3, \"dcdc3\", tps65912_ops_dcdc,\n\t\t\t   TPS65912_DCDC3_OP, TPS65912_DCDC3_CTRL,\n\t\t\t   tps65912_dcdc_ranges),\n\tTPS65912_REGULATOR(\"DCDC4\", DCDC4, \"dcdc4\", tps65912_ops_dcdc,\n\t\t\t   TPS65912_DCDC4_OP, TPS65912_DCDC4_CTRL,\n\t\t\t   tps65912_dcdc_ranges),\n\tTPS65912_REGULATOR(\"LDO1\", LDO1, \"ldo1\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO1_OP, TPS65912_LDO1_AVS,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO2\", LDO2, \"ldo2\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO2_OP, TPS65912_LDO2_AVS,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO3\", LDO3, \"ldo3\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO3_OP, TPS65912_LDO3_AVS,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO4\", LDO4, \"ldo4\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO4_OP, TPS65912_LDO4_AVS,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO5\", LDO5, \"ldo5\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO5, TPS65912_LDO5,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO6\", LDO6, \"ldo6\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO6, TPS65912_LDO6,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO7\", LDO7, \"ldo7\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO7, TPS65912_LDO7,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO8\", LDO8, \"ldo8\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO8, TPS65912_LDO8,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO9\", LDO9, \"ldo9\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO9, TPS65912_LDO9,\n\t\t\t   tps65912_ldo_ranges),\n\tTPS65912_REGULATOR(\"LDO10\", LDO10, \"ldo10\", tps65912_ops_ldo,\n\t\t\t   TPS65912_LDO10, TPS65912_LDO10,\n\t\t\t   tps65912_ldo_ranges),\n};\n\nstatic int tps65912_regulator_probe(struct platform_device *pdev)\n{\n\tstruct tps65912 *tps = dev_get_drvdata(pdev->dev.parent);\n\tstruct regulator_config config = { };\n\tstruct regulator_dev *rdev;\n\tint i;\n\n\tplatform_set_drvdata(pdev, tps);\n\n\tconfig.dev = &pdev->dev;\n\tconfig.driver_data = tps;\n\tconfig.dev->of_node = tps->dev->of_node;\n\tconfig.regmap = tps->regmap;\n\n\tfor (i = 0; i < ARRAY_SIZE(regulators); i++) {\n\t\trdev = devm_regulator_register(&pdev->dev, &regulators[i],\n\t\t\t\t\t       &config);\n\t\tif (IS_ERR(rdev)) {\n\t\t\tdev_err(tps->dev, \"failed to register %s regulator\\n\",\n\t\t\t\tpdev->name);\n\t\t\treturn PTR_ERR(rdev);\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic const struct platform_device_id tps65912_regulator_id_table[] = {\n\t{ \"tps65912-regulator\", },\n\t{   }\n};\nMODULE_DEVICE_TABLE(platform, tps65912_regulator_id_table);\n\nstatic struct platform_driver tps65912_regulator_driver = {\n\t.driver = {\n\t\t.name = \"tps65912-regulator\",\n\t\t.probe_type = PROBE_PREFER_ASYNCHRONOUS,\n\t},\n\t.probe = tps65912_regulator_probe,\n\t.id_table = tps65912_regulator_id_table,\n};\nmodule_platform_driver(tps65912_regulator_driver);\n\nMODULE_AUTHOR(\"Andrew F. Davis <afd@ti.com>\");\nMODULE_DESCRIPTION(\"TPS65912 voltage regulator driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}