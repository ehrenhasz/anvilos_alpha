{
  "module_name": "ab8500.c",
  "hash_id": "1159ed6c56e689c7b3b5cc97e57e998097500d494d459118c596677968fb4bfa",
  "original_prompt": "Ingested from linux-6.6.14/drivers/regulator/ab8500.c",
  "human_readable_source": "\n \n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/platform_device.h>\n#include <linux/mfd/abx500.h>\n#include <linux/mfd/abx500/ab8500.h>\n#include <linux/of.h>\n#include <linux/regulator/of_regulator.h>\n#include <linux/regulator/driver.h>\n#include <linux/regulator/machine.h>\n#include <linux/slab.h>\n\n \nenum ab8500_regulator_id {\n\tAB8500_LDO_AUX1,\n\tAB8500_LDO_AUX2,\n\tAB8500_LDO_AUX3,\n\tAB8500_LDO_INTCORE,\n\tAB8500_LDO_TVOUT,\n\tAB8500_LDO_AUDIO,\n\tAB8500_LDO_ANAMIC1,\n\tAB8500_LDO_ANAMIC2,\n\tAB8500_LDO_DMIC,\n\tAB8500_LDO_ANA,\n\tAB8500_NUM_REGULATORS,\n};\n\n \nenum ab8505_regulator_id {\n\tAB8505_LDO_AUX1,\n\tAB8505_LDO_AUX2,\n\tAB8505_LDO_AUX3,\n\tAB8505_LDO_AUX4,\n\tAB8505_LDO_AUX5,\n\tAB8505_LDO_AUX6,\n\tAB8505_LDO_INTCORE,\n\tAB8505_LDO_ADC,\n\tAB8505_LDO_AUDIO,\n\tAB8505_LDO_ANAMIC1,\n\tAB8505_LDO_ANAMIC2,\n\tAB8505_LDO_AUX8,\n\tAB8505_LDO_ANA,\n\tAB8505_NUM_REGULATORS,\n};\n\n \nenum ab8500_regulator_reg {\n\tAB8500_REGUREQUESTCTRL2,\n\tAB8500_REGUREQUESTCTRL3,\n\tAB8500_REGUREQUESTCTRL4,\n\tAB8500_REGUSYSCLKREQ1HPVALID1,\n\tAB8500_REGUSYSCLKREQ1HPVALID2,\n\tAB8500_REGUHWHPREQ1VALID1,\n\tAB8500_REGUHWHPREQ1VALID2,\n\tAB8500_REGUHWHPREQ2VALID1,\n\tAB8500_REGUHWHPREQ2VALID2,\n\tAB8500_REGUSWHPREQVALID1,\n\tAB8500_REGUSWHPREQVALID2,\n\tAB8500_REGUSYSCLKREQVALID1,\n\tAB8500_REGUSYSCLKREQVALID2,\n\tAB8500_REGUMISC1,\n\tAB8500_VAUDIOSUPPLY,\n\tAB8500_REGUCTRL1VAMIC,\n\tAB8500_VPLLVANAREGU,\n\tAB8500_VREFDDR,\n\tAB8500_EXTSUPPLYREGU,\n\tAB8500_VAUX12REGU,\n\tAB8500_VRF1VAUX3REGU,\n\tAB8500_VAUX1SEL,\n\tAB8500_VAUX2SEL,\n\tAB8500_VRF1VAUX3SEL,\n\tAB8500_REGUCTRL2SPARE,\n\tAB8500_REGUCTRLDISCH,\n\tAB8500_REGUCTRLDISCH2,\n\tAB8500_NUM_REGULATOR_REGISTERS,\n};\n\n \nenum ab8505_regulator_reg {\n\tAB8505_REGUREQUESTCTRL1,\n\tAB8505_REGUREQUESTCTRL2,\n\tAB8505_REGUREQUESTCTRL3,\n\tAB8505_REGUREQUESTCTRL4,\n\tAB8505_REGUSYSCLKREQ1HPVALID1,\n\tAB8505_REGUSYSCLKREQ1HPVALID2,\n\tAB8505_REGUHWHPREQ1VALID1,\n\tAB8505_REGUHWHPREQ1VALID2,\n\tAB8505_REGUHWHPREQ2VALID1,\n\tAB8505_REGUHWHPREQ2VALID2,\n\tAB8505_REGUSWHPREQVALID1,\n\tAB8505_REGUSWHPREQVALID2,\n\tAB8505_REGUSYSCLKREQVALID1,\n\tAB8505_REGUSYSCLKREQVALID2,\n\tAB8505_REGUVAUX4REQVALID,\n\tAB8505_REGUMISC1,\n\tAB8505_VAUDIOSUPPLY,\n\tAB8505_REGUCTRL1VAMIC,\n\tAB8505_VSMPSAREGU,\n\tAB8505_VSMPSBREGU,\n\tAB8505_VSAFEREGU,  \n\tAB8505_VPLLVANAREGU,\n\tAB8505_EXTSUPPLYREGU,\n\tAB8505_VAUX12REGU,\n\tAB8505_VRF1VAUX3REGU,\n\tAB8505_VSMPSASEL1,\n\tAB8505_VSMPSASEL2,\n\tAB8505_VSMPSASEL3,\n\tAB8505_VSMPSBSEL1,\n\tAB8505_VSMPSBSEL2,\n\tAB8505_VSMPSBSEL3,\n\tAB8505_VSAFESEL1,  \n\tAB8505_VSAFESEL2,  \n\tAB8505_VSAFESEL3,  \n\tAB8505_VAUX1SEL,\n\tAB8505_VAUX2SEL,\n\tAB8505_VRF1VAUX3SEL,\n\tAB8505_VAUX4REQCTRL,\n\tAB8505_VAUX4REGU,\n\tAB8505_VAUX4SEL,\n\tAB8505_REGUCTRLDISCH,\n\tAB8505_REGUCTRLDISCH2,\n\tAB8505_REGUCTRLDISCH3,\n\tAB8505_CTRLVAUX5,\n\tAB8505_CTRLVAUX6,\n\tAB8505_NUM_REGULATOR_REGISTERS,\n};\n\n \nstruct ab8500_shared_mode {\n\tstruct ab8500_regulator_info *shared_regulator;\n\tbool lp_mode_req;\n};\n\n \nstruct ab8500_regulator_info {\n\tstruct device\t\t*dev;\n\tstruct regulator_desc\tdesc;\n\tstruct ab8500_shared_mode *shared_mode;\n\tint load_lp_uA;\n\tu8 update_bank;\n\tu8 update_reg;\n\tu8 update_mask;\n\tu8 update_val;\n\tu8 update_val_idle;\n\tu8 update_val_normal;\n\tu8 mode_bank;\n\tu8 mode_reg;\n\tu8 mode_mask;\n\tu8 mode_val_idle;\n\tu8 mode_val_normal;\n\tu8 voltage_bank;\n\tu8 voltage_reg;\n\tu8 voltage_mask;\n};\n\n \nstatic const unsigned int ldo_vauxn_voltages[] = {\n\t1100000,\n\t1200000,\n\t1300000,\n\t1400000,\n\t1500000,\n\t1800000,\n\t1850000,\n\t1900000,\n\t2500000,\n\t2650000,\n\t2700000,\n\t2750000,\n\t2800000,\n\t2900000,\n\t3000000,\n\t3300000,\n};\n\nstatic const unsigned int ldo_vaux3_voltages[] = {\n\t1200000,\n\t1500000,\n\t1800000,\n\t2100000,\n\t2500000,\n\t2750000,\n\t2790000,\n\t2910000,\n};\n\nstatic const unsigned int ldo_vaux56_voltages[] = {\n\t1800000,\n\t1050000,\n\t1100000,\n\t1200000,\n\t1500000,\n\t2200000,\n\t2500000,\n\t2790000,\n};\n\nstatic const unsigned int ldo_vintcore_voltages[] = {\n\t1200000,\n\t1225000,\n\t1250000,\n\t1275000,\n\t1300000,\n\t1325000,\n\t1350000,\n};\n\nstatic const unsigned int fixed_1200000_voltage[] = {\n\t1200000,\n};\n\nstatic const unsigned int fixed_1800000_voltage[] = {\n\t1800000,\n};\n\nstatic const unsigned int fixed_2000000_voltage[] = {\n\t2000000,\n};\n\nstatic const unsigned int fixed_2050000_voltage[] = {\n\t2050000,\n};\n\nstatic const unsigned int ldo_vana_voltages[] = {\n\t1050000,\n\t1075000,\n\t1100000,\n\t1125000,\n\t1150000,\n\t1175000,\n\t1200000,\n\t1225000,\n};\n\nstatic const unsigned int ldo_vaudio_voltages[] = {\n\t2000000,\n\t2100000,\n\t2200000,\n\t2300000,\n\t2400000,\n\t2500000,\n\t2600000,\n\t2600000,\t \n};\n\nstatic DEFINE_MUTEX(shared_mode_mutex);\nstatic struct ab8500_shared_mode ldo_anamic1_shared;\nstatic struct ab8500_shared_mode ldo_anamic2_shared;\n\nstatic int ab8500_regulator_enable(struct regulator_dev *rdev)\n{\n\tint ret;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tret = abx500_mask_and_set_register_interruptible(info->dev,\n\t\tinfo->update_bank, info->update_reg,\n\t\tinfo->update_mask, info->update_val);\n\tif (ret < 0) {\n\t\tdev_err(rdev_get_dev(rdev),\n\t\t\t\"couldn't set enable bits for regulator\\n\");\n\t\treturn ret;\n\t}\n\n\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\"%s-enable (bank, reg, mask, value): 0x%x, 0x%x, 0x%x, 0x%x\\n\",\n\t\tinfo->desc.name, info->update_bank, info->update_reg,\n\t\tinfo->update_mask, info->update_val);\n\n\treturn ret;\n}\n\nstatic int ab8500_regulator_disable(struct regulator_dev *rdev)\n{\n\tint ret;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tret = abx500_mask_and_set_register_interruptible(info->dev,\n\t\tinfo->update_bank, info->update_reg,\n\t\tinfo->update_mask, 0x0);\n\tif (ret < 0) {\n\t\tdev_err(rdev_get_dev(rdev),\n\t\t\t\"couldn't set disable bits for regulator\\n\");\n\t\treturn ret;\n\t}\n\n\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\"%s-disable (bank, reg, mask, value): 0x%x, 0x%x, 0x%x, 0x%x\\n\",\n\t\tinfo->desc.name, info->update_bank, info->update_reg,\n\t\tinfo->update_mask, 0x0);\n\n\treturn ret;\n}\n\nstatic int ab8500_regulator_is_enabled(struct regulator_dev *rdev)\n{\n\tint ret;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\tu8 regval;\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tret = abx500_get_register_interruptible(info->dev,\n\t\tinfo->update_bank, info->update_reg, &regval);\n\tif (ret < 0) {\n\t\tdev_err(rdev_get_dev(rdev),\n\t\t\t\"couldn't read 0x%x register\\n\", info->update_reg);\n\t\treturn ret;\n\t}\n\n\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\"%s-is_enabled (bank, reg, mask, value): 0x%x, 0x%x, 0x%x,\"\n\t\t\" 0x%x\\n\",\n\t\tinfo->desc.name, info->update_bank, info->update_reg,\n\t\tinfo->update_mask, regval);\n\n\tif (regval & info->update_mask)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n\nstatic unsigned int ab8500_regulator_get_optimum_mode(\n\t\tstruct regulator_dev *rdev, int input_uV,\n\t\tint output_uV, int load_uA)\n{\n\tunsigned int mode;\n\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tif (load_uA <= info->load_lp_uA)\n\t\tmode = REGULATOR_MODE_IDLE;\n\telse\n\t\tmode = REGULATOR_MODE_NORMAL;\n\n\treturn mode;\n}\n\nstatic int ab8500_regulator_set_mode(struct regulator_dev *rdev,\n\t\t\t\t     unsigned int mode)\n{\n\tint ret = 0;\n\tu8 bank, reg, mask, val;\n\tbool lp_mode_req = false;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tif (info->mode_mask) {\n\t\tbank = info->mode_bank;\n\t\treg = info->mode_reg;\n\t\tmask = info->mode_mask;\n\t} else {\n\t\tbank = info->update_bank;\n\t\treg = info->update_reg;\n\t\tmask = info->update_mask;\n\t}\n\n\tif (info->shared_mode)\n\t\tmutex_lock(&shared_mode_mutex);\n\n\tswitch (mode) {\n\tcase REGULATOR_MODE_NORMAL:\n\t\tif (info->shared_mode)\n\t\t\tlp_mode_req = false;\n\n\t\tif (info->mode_mask)\n\t\t\tval = info->mode_val_normal;\n\t\telse\n\t\t\tval = info->update_val_normal;\n\t\tbreak;\n\tcase REGULATOR_MODE_IDLE:\n\t\tif (info->shared_mode) {\n\t\t\tstruct ab8500_regulator_info *shared_regulator;\n\n\t\t\tshared_regulator = info->shared_mode->shared_regulator;\n\t\t\tif (!shared_regulator->shared_mode->lp_mode_req) {\n\t\t\t\t \n\t\t\t\tinfo->shared_mode->lp_mode_req = true;\n\t\t\t\tgoto out_unlock;\n\t\t\t}\n\n\t\t\tlp_mode_req = true;\n\t\t}\n\n\t\tif (info->mode_mask)\n\t\t\tval = info->mode_val_idle;\n\t\telse\n\t\t\tval = info->update_val_idle;\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t\tgoto out_unlock;\n\t}\n\n\tif (info->mode_mask || ab8500_regulator_is_enabled(rdev)) {\n\t\tret = abx500_mask_and_set_register_interruptible(info->dev,\n\t\t\tbank, reg, mask, val);\n\t\tif (ret < 0) {\n\t\t\tdev_err(rdev_get_dev(rdev),\n\t\t\t\t\"couldn't set regulator mode\\n\");\n\t\t\tgoto out_unlock;\n\t\t}\n\n\t\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\t\"%s-set_mode (bank, reg, mask, value): \"\n\t\t\t\"0x%x, 0x%x, 0x%x, 0x%x\\n\",\n\t\t\tinfo->desc.name, bank, reg,\n\t\t\tmask, val);\n\t}\n\n\tif (!info->mode_mask)\n\t\tinfo->update_val = val;\n\n\tif (info->shared_mode)\n\t\tinfo->shared_mode->lp_mode_req = lp_mode_req;\n\nout_unlock:\n\tif (info->shared_mode)\n\t\tmutex_unlock(&shared_mode_mutex);\n\n\treturn ret;\n}\n\nstatic unsigned int ab8500_regulator_get_mode(struct regulator_dev *rdev)\n{\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\tint ret;\n\tu8 val;\n\tu8 val_normal;\n\tu8 val_idle;\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\t \n\tif (info->shared_mode) {\n\t\tif (info->shared_mode->lp_mode_req)\n\t\t\treturn REGULATOR_MODE_IDLE;\n\t\telse\n\t\t\treturn REGULATOR_MODE_NORMAL;\n\t}\n\n\tif (info->mode_mask) {\n\t\t \n\t\tret = abx500_get_register_interruptible(info->dev,\n\t\tinfo->mode_bank, info->mode_reg, &val);\n\t\tval = val & info->mode_mask;\n\n\t\tval_normal = info->mode_val_normal;\n\t\tval_idle = info->mode_val_idle;\n\t} else {\n\t\t \n\t\tval = info->update_val;\n\t\tval_normal = info->update_val_normal;\n\t\tval_idle = info->update_val_idle;\n\t}\n\n\tif (val == val_normal)\n\t\tret = REGULATOR_MODE_NORMAL;\n\telse if (val == val_idle)\n\t\tret = REGULATOR_MODE_IDLE;\n\telse\n\t\tret = -EINVAL;\n\n\treturn ret;\n}\n\nstatic int ab8500_regulator_get_voltage_sel(struct regulator_dev *rdev)\n{\n\tint ret, voltage_shift;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\tu8 regval;\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tvoltage_shift = ffs(info->voltage_mask) - 1;\n\n\tret = abx500_get_register_interruptible(info->dev,\n\t\t\tinfo->voltage_bank, info->voltage_reg, &regval);\n\tif (ret < 0) {\n\t\tdev_err(rdev_get_dev(rdev),\n\t\t\t\"couldn't read voltage reg for regulator\\n\");\n\t\treturn ret;\n\t}\n\n\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\"%s-get_voltage (bank, reg, mask, shift, value): \"\n\t\t\"0x%x, 0x%x, 0x%x, 0x%x, 0x%x\\n\",\n\t\tinfo->desc.name, info->voltage_bank,\n\t\tinfo->voltage_reg, info->voltage_mask,\n\t\tvoltage_shift, regval);\n\n\treturn (regval & info->voltage_mask) >> voltage_shift;\n}\n\nstatic int ab8500_regulator_set_voltage_sel(struct regulator_dev *rdev,\n\t\t\t\t\t    unsigned selector)\n{\n\tint ret, voltage_shift;\n\tstruct ab8500_regulator_info *info = rdev_get_drvdata(rdev);\n\tu8 regval;\n\n\tif (info == NULL) {\n\t\tdev_err(rdev_get_dev(rdev), \"regulator info null pointer\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tvoltage_shift = ffs(info->voltage_mask) - 1;\n\n\t \n\tregval = (u8)selector << voltage_shift;\n\tret = abx500_mask_and_set_register_interruptible(info->dev,\n\t\t\tinfo->voltage_bank, info->voltage_reg,\n\t\t\tinfo->voltage_mask, regval);\n\tif (ret < 0)\n\t\tdev_err(rdev_get_dev(rdev),\n\t\t\"couldn't set voltage reg for regulator\\n\");\n\n\tdev_vdbg(rdev_get_dev(rdev),\n\t\t\"%s-set_voltage (bank, reg, mask, value): 0x%x, 0x%x, 0x%x,\"\n\t\t\" 0x%x\\n\",\n\t\tinfo->desc.name, info->voltage_bank, info->voltage_reg,\n\t\tinfo->voltage_mask, regval);\n\n\treturn ret;\n}\n\nstatic const struct regulator_ops ab8500_regulator_volt_mode_ops = {\n\t.enable\t\t\t= ab8500_regulator_enable,\n\t.disable\t\t= ab8500_regulator_disable,\n\t.is_enabled\t\t= ab8500_regulator_is_enabled,\n\t.get_optimum_mode\t= ab8500_regulator_get_optimum_mode,\n\t.set_mode\t\t= ab8500_regulator_set_mode,\n\t.get_mode\t\t= ab8500_regulator_get_mode,\n\t.get_voltage_sel \t= ab8500_regulator_get_voltage_sel,\n\t.set_voltage_sel\t= ab8500_regulator_set_voltage_sel,\n\t.list_voltage\t\t= regulator_list_voltage_table,\n};\n\nstatic const struct regulator_ops ab8500_regulator_volt_ops = {\n\t.enable\t\t= ab8500_regulator_enable,\n\t.disable\t= ab8500_regulator_disable,\n\t.is_enabled\t= ab8500_regulator_is_enabled,\n\t.get_voltage_sel = ab8500_regulator_get_voltage_sel,\n\t.set_voltage_sel = ab8500_regulator_set_voltage_sel,\n\t.list_voltage\t= regulator_list_voltage_table,\n};\n\nstatic const struct regulator_ops ab8500_regulator_mode_ops = {\n\t.enable\t\t\t= ab8500_regulator_enable,\n\t.disable\t\t= ab8500_regulator_disable,\n\t.is_enabled\t\t= ab8500_regulator_is_enabled,\n\t.get_optimum_mode\t= ab8500_regulator_get_optimum_mode,\n\t.set_mode\t\t= ab8500_regulator_set_mode,\n\t.get_mode\t\t= ab8500_regulator_get_mode,\n\t.list_voltage\t\t= regulator_list_voltage_table,\n};\n\nstatic const struct regulator_ops ab8500_regulator_ops = {\n\t.enable\t\t\t= ab8500_regulator_enable,\n\t.disable\t\t= ab8500_regulator_disable,\n\t.is_enabled\t\t= ab8500_regulator_is_enabled,\n\t.list_voltage\t\t= regulator_list_voltage_table,\n};\n\nstatic const struct regulator_ops ab8500_regulator_anamic_mode_ops = {\n\t.enable\t\t= ab8500_regulator_enable,\n\t.disable\t= ab8500_regulator_disable,\n\t.is_enabled\t= ab8500_regulator_is_enabled,\n\t.set_mode\t= ab8500_regulator_set_mode,\n\t.get_mode\t= ab8500_regulator_get_mode,\n\t.list_voltage\t= regulator_list_voltage_table,\n};\n\n \nstatic struct ab8500_regulator_info\n\t\tab8500_regulator_info[AB8500_NUM_REGULATORS] = {\n\t \n\t[AB8500_LDO_AUX1] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX1\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_AUX1,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vauxn_voltages),\n\t\t\t.volt_table\t= ldo_vauxn_voltages,\n\t\t\t.enable_time\t= 200,\n\t\t\t.supply_name    = \"vin\",\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x09,\n\t\t.update_mask\t\t= 0x03,\n\t\t.update_val\t\t= 0x01,\n\t\t.update_val_idle\t= 0x03,\n\t\t.update_val_normal\t= 0x01,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x1f,\n\t\t.voltage_mask\t\t= 0x0f,\n\t},\n\t[AB8500_LDO_AUX2] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX2\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_AUX2,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vauxn_voltages),\n\t\t\t.volt_table\t= ldo_vauxn_voltages,\n\t\t\t.enable_time\t= 200,\n\t\t\t.supply_name    = \"vin\",\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x09,\n\t\t.update_mask\t\t= 0x0c,\n\t\t.update_val\t\t= 0x04,\n\t\t.update_val_idle\t= 0x0c,\n\t\t.update_val_normal\t= 0x04,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x20,\n\t\t.voltage_mask\t\t= 0x0f,\n\t},\n\t[AB8500_LDO_AUX3] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX3\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_AUX3,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vaux3_voltages),\n\t\t\t.volt_table\t= ldo_vaux3_voltages,\n\t\t\t.enable_time\t= 450,\n\t\t\t.supply_name    = \"vin\",\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x0a,\n\t\t.update_mask\t\t= 0x03,\n\t\t.update_val\t\t= 0x01,\n\t\t.update_val_idle\t= 0x03,\n\t\t.update_val_normal\t= 0x01,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x21,\n\t\t.voltage_mask\t\t= 0x07,\n\t},\n\t[AB8500_LDO_INTCORE] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-INTCORE\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_INTCORE,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vintcore_voltages),\n\t\t\t.volt_table\t= ldo_vintcore_voltages,\n\t\t\t.enable_time\t= 750,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x80,\n\t\t.update_mask\t\t= 0x44,\n\t\t.update_val\t\t= 0x44,\n\t\t.update_val_idle\t= 0x44,\n\t\t.update_val_normal\t= 0x04,\n\t\t.voltage_bank\t\t= 0x03,\n\t\t.voltage_reg\t\t= 0x80,\n\t\t.voltage_mask\t\t= 0x38,\n\t},\n\n\t \n\t[AB8500_LDO_TVOUT] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-TVOUT\",\n\t\t\t.ops\t\t= &ab8500_regulator_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_TVOUT,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.volt_table\t= fixed_2000000_voltage,\n\t\t\t.enable_time\t= 500,\n\t\t},\n\t\t.load_lp_uA\t\t= 1000,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x80,\n\t\t.update_mask\t\t= 0x82,\n\t\t.update_val\t\t= 0x02,\n\t\t.update_val_idle\t= 0x82,\n\t\t.update_val_normal\t= 0x02,\n\t},\n\t[AB8500_LDO_AUDIO] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUDIO\",\n\t\t\t.ops\t\t= &ab8500_regulator_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_AUDIO,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.enable_time\t= 140,\n\t\t\t.volt_table\t= fixed_2000000_voltage,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x02,\n\t\t.update_val\t\t= 0x02,\n\t},\n\t[AB8500_LDO_ANAMIC1] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANAMIC1\",\n\t\t\t.ops\t\t= &ab8500_regulator_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_ANAMIC1,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.enable_time\t= 500,\n\t\t\t.volt_table\t= fixed_2050000_voltage,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x08,\n\t\t.update_val\t\t= 0x08,\n\t},\n\t[AB8500_LDO_ANAMIC2] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANAMIC2\",\n\t\t\t.ops\t\t= &ab8500_regulator_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_ANAMIC2,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.enable_time\t= 500,\n\t\t\t.volt_table\t= fixed_2050000_voltage,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x10,\n\t\t.update_val\t\t= 0x10,\n\t},\n\t[AB8500_LDO_DMIC] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-DMIC\",\n\t\t\t.ops\t\t= &ab8500_regulator_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_DMIC,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.enable_time\t= 420,\n\t\t\t.volt_table\t= fixed_1800000_voltage,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x04,\n\t\t.update_val\t\t= 0x04,\n\t},\n\n\t \n\t[AB8500_LDO_ANA] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANA\",\n\t\t\t.ops\t\t= &ab8500_regulator_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8500_LDO_ANA,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.enable_time\t= 140,\n\t\t\t.volt_table\t= fixed_1200000_voltage,\n\t\t},\n\t\t.load_lp_uA\t\t= 1000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x06,\n\t\t.update_mask\t\t= 0x0c,\n\t\t.update_val\t\t= 0x04,\n\t\t.update_val_idle\t= 0x0c,\n\t\t.update_val_normal\t= 0x04,\n\t},\n};\n\n \nstatic struct ab8500_regulator_info\n\t\tab8505_regulator_info[AB8505_NUM_REGULATORS] = {\n\t \n\t[AB8505_LDO_AUX1] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX1\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX1,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vauxn_voltages),\n\t\t\t.volt_table\t= ldo_vauxn_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x09,\n\t\t.update_mask\t\t= 0x03,\n\t\t.update_val\t\t= 0x01,\n\t\t.update_val_idle\t= 0x03,\n\t\t.update_val_normal\t= 0x01,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x1f,\n\t\t.voltage_mask\t\t= 0x0f,\n\t},\n\t[AB8505_LDO_AUX2] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX2\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX2,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vauxn_voltages),\n\t\t\t.volt_table\t= ldo_vauxn_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x09,\n\t\t.update_mask\t\t= 0x0c,\n\t\t.update_val\t\t= 0x04,\n\t\t.update_val_idle\t= 0x0c,\n\t\t.update_val_normal\t= 0x04,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x20,\n\t\t.voltage_mask\t\t= 0x0f,\n\t},\n\t[AB8505_LDO_AUX3] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX3\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX3,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vaux3_voltages),\n\t\t\t.volt_table\t= ldo_vaux3_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x0a,\n\t\t.update_mask\t\t= 0x03,\n\t\t.update_val\t\t= 0x01,\n\t\t.update_val_idle\t= 0x03,\n\t\t.update_val_normal\t= 0x01,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x21,\n\t\t.voltage_mask\t\t= 0x07,\n\t},\n\t[AB8505_LDO_AUX4] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX4\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX4,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vauxn_voltages),\n\t\t\t.volt_table\t= ldo_vauxn_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t \n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x2e,\n\t\t.update_mask\t\t= 0x03,\n\t\t.update_val\t\t= 0x01,\n\t\t.update_val_idle\t= 0x03,\n\t\t.update_val_normal\t= 0x01,\n\t\t \n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x2f,\n\t\t.voltage_mask\t\t= 0x0f,\n\t},\n\t[AB8505_LDO_AUX5] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX5\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX5,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vaux56_voltages),\n\t\t\t.volt_table\t= ldo_vaux56_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 2000,\n\t\t \n\t\t.update_bank\t\t= 0x01,\n\t\t.update_reg\t\t= 0x55,\n\t\t.update_mask\t\t= 0x18,\n\t\t.update_val\t\t= 0x10,\n\t\t.update_val_idle\t= 0x18,\n\t\t.update_val_normal\t= 0x10,\n\t\t.voltage_bank\t\t= 0x01,\n\t\t.voltage_reg\t\t= 0x55,\n\t\t.voltage_mask\t\t= 0x07,\n\t},\n\t[AB8505_LDO_AUX6] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX6\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX6,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vaux56_voltages),\n\t\t\t.volt_table\t= ldo_vaux56_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 2000,\n\t\t \n\t\t.update_bank\t\t= 0x01,\n\t\t.update_reg\t\t= 0x56,\n\t\t.update_mask\t\t= 0x18,\n\t\t.update_val\t\t= 0x10,\n\t\t.update_val_idle\t= 0x18,\n\t\t.update_val_normal\t= 0x10,\n\t\t.voltage_bank\t\t= 0x01,\n\t\t.voltage_reg\t\t= 0x56,\n\t\t.voltage_mask\t\t= 0x07,\n\t},\n\t[AB8505_LDO_INTCORE] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-INTCORE\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_INTCORE,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vintcore_voltages),\n\t\t\t.volt_table\t= ldo_vintcore_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 5000,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x80,\n\t\t.update_mask\t\t= 0x44,\n\t\t.update_val\t\t= 0x04,\n\t\t.update_val_idle\t= 0x44,\n\t\t.update_val_normal\t= 0x04,\n\t\t.voltage_bank\t\t= 0x03,\n\t\t.voltage_reg\t\t= 0x80,\n\t\t.voltage_mask\t\t= 0x38,\n\t},\n\n\t \n\t[AB8505_LDO_ADC] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ADC\",\n\t\t\t.ops\t\t= &ab8500_regulator_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_ADC,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.volt_table\t= fixed_2000000_voltage,\n\t\t\t.enable_time\t= 10000,\n\t\t},\n\t\t.load_lp_uA\t\t= 1000,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x80,\n\t\t.update_mask\t\t= 0x82,\n\t\t.update_val\t\t= 0x02,\n\t\t.update_val_idle\t= 0x82,\n\t\t.update_val_normal\t= 0x02,\n\t},\n\t[AB8505_LDO_AUDIO] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUDIO\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUDIO,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vaudio_voltages),\n\t\t\t.volt_table\t= ldo_vaudio_voltages,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x02,\n\t\t.update_val\t\t= 0x02,\n\t\t.voltage_bank\t\t= 0x01,\n\t\t.voltage_reg\t\t= 0x57,\n\t\t.voltage_mask\t\t= 0x70,\n\t},\n\t[AB8505_LDO_ANAMIC1] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANAMIC1\",\n\t\t\t.ops\t\t= &ab8500_regulator_anamic_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_ANAMIC1,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.volt_table\t= fixed_2050000_voltage,\n\t\t},\n\t\t.shared_mode\t\t= &ldo_anamic1_shared,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x08,\n\t\t.update_val\t\t= 0x08,\n\t\t.mode_bank\t\t= 0x01,\n\t\t.mode_reg\t\t= 0x54,\n\t\t.mode_mask\t\t= 0x04,\n\t\t.mode_val_idle\t\t= 0x04,\n\t\t.mode_val_normal\t= 0x00,\n\t},\n\t[AB8505_LDO_ANAMIC2] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANAMIC2\",\n\t\t\t.ops\t\t= &ab8500_regulator_anamic_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_ANAMIC2,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.volt_table\t= fixed_2050000_voltage,\n\t\t},\n\t\t.shared_mode\t\t= &ldo_anamic2_shared,\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x10,\n\t\t.update_val\t\t= 0x10,\n\t\t.mode_bank\t\t= 0x01,\n\t\t.mode_reg\t\t= 0x54,\n\t\t.mode_mask\t\t= 0x04,\n\t\t.mode_val_idle\t\t= 0x04,\n\t\t.mode_val_normal\t= 0x00,\n\t},\n\t[AB8505_LDO_AUX8] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-AUX8\",\n\t\t\t.ops\t\t= &ab8500_regulator_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_AUX8,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= 1,\n\t\t\t.volt_table\t= fixed_1800000_voltage,\n\t\t},\n\t\t.update_bank\t\t= 0x03,\n\t\t.update_reg\t\t= 0x83,\n\t\t.update_mask\t\t= 0x04,\n\t\t.update_val\t\t= 0x04,\n\t},\n\t \n\t[AB8505_LDO_ANA] = {\n\t\t.desc = {\n\t\t\t.name\t\t= \"LDO-ANA\",\n\t\t\t.ops\t\t= &ab8500_regulator_volt_mode_ops,\n\t\t\t.type\t\t= REGULATOR_VOLTAGE,\n\t\t\t.id\t\t= AB8505_LDO_ANA,\n\t\t\t.owner\t\t= THIS_MODULE,\n\t\t\t.n_voltages\t= ARRAY_SIZE(ldo_vana_voltages),\n\t\t\t.volt_table\t= ldo_vana_voltages,\n\t\t},\n\t\t.load_lp_uA\t\t= 1000,\n\t\t.update_bank\t\t= 0x04,\n\t\t.update_reg\t\t= 0x06,\n\t\t.update_mask\t\t= 0x0c,\n\t\t.update_val\t\t= 0x04,\n\t\t.update_val_idle\t= 0x0c,\n\t\t.update_val_normal\t= 0x04,\n\t\t.voltage_bank\t\t= 0x04,\n\t\t.voltage_reg\t\t= 0x29,\n\t\t.voltage_mask\t\t= 0x7,\n\t},\n};\n\nstatic struct ab8500_shared_mode ldo_anamic1_shared = {\n\t.shared_regulator = &ab8505_regulator_info[AB8505_LDO_ANAMIC2],\n};\n\nstatic struct ab8500_shared_mode ldo_anamic2_shared = {\n\t.shared_regulator = &ab8505_regulator_info[AB8505_LDO_ANAMIC1],\n};\n\nstruct ab8500_reg_init {\n\tu8 bank;\n\tu8 addr;\n\tu8 mask;\n};\n\n#define REG_INIT(_id, _bank, _addr, _mask)\t\\\n\t[_id] = {\t\t\t\t\\\n\t\t.bank = _bank,\t\t\t\\\n\t\t.addr = _addr,\t\t\t\\\n\t\t.mask = _mask,\t\t\t\\\n\t}\n\n \nstatic struct ab8500_reg_init ab8500_reg_init[] = {\n\t \n\tREG_INIT(AB8500_REGUREQUESTCTRL2,\t0x03, 0x04, 0xf0),\n\t \n\tREG_INIT(AB8500_REGUREQUESTCTRL3,\t0x03, 0x05, 0xff),\n\t \n\tREG_INIT(AB8500_REGUREQUESTCTRL4,\t0x03, 0x06, 0x07),\n\t \n\tREG_INIT(AB8500_REGUSYSCLKREQ1HPVALID1,\t0x03, 0x07, 0xe8),\n\t \n\tREG_INIT(AB8500_REGUSYSCLKREQ1HPVALID2,\t0x03, 0x08, 0x70),\n\t \n\tREG_INIT(AB8500_REGUHWHPREQ1VALID1,\t0x03, 0x09, 0xe8),\n\t \n\tREG_INIT(AB8500_REGUHWHPREQ1VALID2,\t0x03, 0x0a, 0x07),\n\t \n\tREG_INIT(AB8500_REGUHWHPREQ2VALID1,\t0x03, 0x0b, 0xe8),\n\t \n\tREG_INIT(AB8500_REGUHWHPREQ2VALID2,\t0x03, 0x0c, 0x07),\n\t \n\tREG_INIT(AB8500_REGUSWHPREQVALID1,\t0x03, 0x0d, 0xa0),\n\t \n\tREG_INIT(AB8500_REGUSWHPREQVALID2,\t0x03, 0x0e, 0x1f),\n\t \n\tREG_INIT(AB8500_REGUSYSCLKREQVALID1,\t0x03, 0x0f, 0xfe),\n\t \n\tREG_INIT(AB8500_REGUSYSCLKREQVALID2,\t0x03, 0x10, 0xfe),\n\t \n\tREG_INIT(AB8500_REGUMISC1,\t\t0x03, 0x80, 0xfe),\n\t \n\tREG_INIT(AB8500_VAUDIOSUPPLY,\t\t0x03, 0x83, 0x1e),\n\t \n\tREG_INIT(AB8500_REGUCTRL1VAMIC,\t\t0x03, 0x84, 0x03),\n\t \n\tREG_INIT(AB8500_VPLLVANAREGU,\t\t0x04, 0x06, 0x0f),\n\t \n\tREG_INIT(AB8500_VREFDDR,\t\t0x04, 0x07, 0x03),\n\t \n\tREG_INIT(AB8500_EXTSUPPLYREGU,\t\t0x04, 0x08, 0xff),\n\t \n\tREG_INIT(AB8500_VAUX12REGU,\t\t0x04, 0x09, 0x0f),\n\t \n\tREG_INIT(AB8500_VRF1VAUX3REGU,\t\t0x04, 0x0a, 0x03),\n\t \n\tREG_INIT(AB8500_VAUX1SEL,\t\t0x04, 0x1f, 0x0f),\n\t \n\tREG_INIT(AB8500_VAUX2SEL,\t\t0x04, 0x20, 0x0f),\n\t \n\tREG_INIT(AB8500_VRF1VAUX3SEL,\t\t0x04, 0x21, 0x07),\n\t \n\tREG_INIT(AB8500_REGUCTRL2SPARE,\t\t0x04, 0x22, 0x01),\n\t \n\tREG_INIT(AB8500_REGUCTRLDISCH,\t\t0x04, 0x43, 0xfc),\n\t \n\tREG_INIT(AB8500_REGUCTRLDISCH2,\t\t0x04, 0x44, 0x16),\n};\n\n \nstatic struct ab8500_reg_init ab8505_reg_init[] = {\n\t \n\tREG_INIT(AB8505_REGUREQUESTCTRL1,\t0x03, 0x03, 0xff),\n\t \n\tREG_INIT(AB8505_REGUREQUESTCTRL2,\t0x03, 0x04, 0x3f),\n\t \n\tREG_INIT(AB8505_REGUREQUESTCTRL3,\t0x03, 0x05, 0xf0),\n\t \n\tREG_INIT(AB8505_REGUREQUESTCTRL4,\t0x03, 0x06, 0x07),\n\t \n\tREG_INIT(AB8505_REGUSYSCLKREQ1HPVALID1,\t0x03, 0x07, 0xff),\n\t \n\tREG_INIT(AB8505_REGUSYSCLKREQ1HPVALID2,\t0x03, 0x08, 0x0f),\n\t \n\tREG_INIT(AB8505_REGUHWHPREQ1VALID1,\t0x03, 0x09, 0xff),\n\t \n\tREG_INIT(AB8505_REGUHWHPREQ1VALID2,\t0x03, 0x0a, 0x08),\n\t \n\tREG_INIT(AB8505_REGUHWHPREQ2VALID1,\t0x03, 0x0b, 0xff),\n\t \n\tREG_INIT(AB8505_REGUHWHPREQ2VALID2,\t0x03, 0x0c, 0x08),\n\t \n\tREG_INIT(AB8505_REGUSWHPREQVALID1,\t0x03, 0x0d, 0xff),\n\t \n\tREG_INIT(AB8505_REGUSWHPREQVALID2,\t0x03, 0x0e, 0x23),\n\t \n\tREG_INIT(AB8505_REGUSYSCLKREQVALID1,\t0x03, 0x0f, 0x0e),\n\t \n\tREG_INIT(AB8505_REGUSYSCLKREQVALID2,\t0x03, 0x10, 0x0e),\n\t \n\tREG_INIT(AB8505_REGUVAUX4REQVALID,\t0x03, 0x11, 0x0f),\n\t \n\tREG_INIT(AB8505_REGUMISC1,\t\t0x03, 0x80, 0xfe),\n\t \n\tREG_INIT(AB8505_VAUDIOSUPPLY,\t\t0x03, 0x83, 0x1e),\n\t \n\tREG_INIT(AB8505_REGUCTRL1VAMIC,\t\t0x03, 0x84, 0x03),\n\t \n\tREG_INIT(AB8505_VSMPSAREGU,\t\t0x04, 0x03, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSBREGU,\t\t0x04, 0x04, 0x3f),\n\t \n\tREG_INIT(AB8505_VSAFEREGU,\t\t0x04, 0x05, 0x3f),\n\t \n\tREG_INIT(AB8505_VPLLVANAREGU,\t\t0x04, 0x06, 0x0f),\n\t \n\tREG_INIT(AB8505_EXTSUPPLYREGU,\t\t0x04, 0x08, 0xff),\n\t \n\tREG_INIT(AB8505_VAUX12REGU,\t\t0x04, 0x09, 0x0f),\n\t \n\tREG_INIT(AB8505_VRF1VAUX3REGU,\t\t0x04, 0x0a, 0x0f),\n\t \n\tREG_INIT(AB8505_VSMPSASEL1,\t\t0x04, 0x13, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSASEL2,\t\t0x04, 0x14, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSASEL3,\t\t0x04, 0x15, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSBSEL1,\t\t0x04, 0x17, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSBSEL2,\t\t0x04, 0x18, 0x3f),\n\t \n\tREG_INIT(AB8505_VSMPSBSEL3,\t\t0x04, 0x19, 0x3f),\n\t \n\tREG_INIT(AB8505_VSAFESEL1,\t\t0x04, 0x1b, 0x7f),\n\t \n\tREG_INIT(AB8505_VSAFESEL2,\t\t0x04, 0x1c, 0x7f),\n\t \n\tREG_INIT(AB8505_VSAFESEL3,\t\t0x04, 0x1d, 0x7f),\n\t \n\tREG_INIT(AB8505_VAUX1SEL,\t\t0x04, 0x1f, 0x0f),\n\t \n\tREG_INIT(AB8505_VAUX2SEL,\t\t0x04, 0x20, 0x0f),\n\t \n\tREG_INIT(AB8505_VRF1VAUX3SEL,\t\t0x04, 0x21, 0x37),\n\t \n\tREG_INIT(AB8505_VAUX4REQCTRL,\t\t0x04, 0x2d, 0x03),\n\t \n\tREG_INIT(AB8505_VAUX4REGU,\t\t0x04, 0x2e, 0x03),\n\t \n\tREG_INIT(AB8505_VAUX4SEL,\t\t0x04, 0x2f, 0x0f),\n\t \n\tREG_INIT(AB8505_REGUCTRLDISCH,\t\t0x04, 0x43, 0xfc),\n\t \n\tREG_INIT(AB8505_REGUCTRLDISCH2,\t\t0x04, 0x44, 0x16),\n\t \n\tREG_INIT(AB8505_REGUCTRLDISCH3,\t\t0x04, 0x48, 0x01),\n\t \n\tREG_INIT(AB8505_CTRLVAUX5,\t\t0x01, 0x55, 0xff),\n\t \n\tREG_INIT(AB8505_CTRLVAUX6,\t\t0x01, 0x56, 0x9f),\n};\n\nstatic struct of_regulator_match ab8500_regulator_match[] = {\n\t{ .name\t= \"ab8500_ldo_aux1\",    .driver_data = (void *) AB8500_LDO_AUX1, },\n\t{ .name\t= \"ab8500_ldo_aux2\",    .driver_data = (void *) AB8500_LDO_AUX2, },\n\t{ .name\t= \"ab8500_ldo_aux3\",    .driver_data = (void *) AB8500_LDO_AUX3, },\n\t{ .name\t= \"ab8500_ldo_intcore\", .driver_data = (void *) AB8500_LDO_INTCORE, },\n\t{ .name\t= \"ab8500_ldo_tvout\",   .driver_data = (void *) AB8500_LDO_TVOUT, },\n\t{ .name = \"ab8500_ldo_audio\",   .driver_data = (void *) AB8500_LDO_AUDIO, },\n\t{ .name\t= \"ab8500_ldo_anamic1\", .driver_data = (void *) AB8500_LDO_ANAMIC1, },\n\t{ .name\t= \"ab8500_ldo_anamic2\", .driver_data = (void *) AB8500_LDO_ANAMIC2, },\n\t{ .name\t= \"ab8500_ldo_dmic\",    .driver_data = (void *) AB8500_LDO_DMIC, },\n\t{ .name\t= \"ab8500_ldo_ana\",     .driver_data = (void *) AB8500_LDO_ANA, },\n};\n\nstatic struct of_regulator_match ab8505_regulator_match[] = {\n\t{ .name\t= \"ab8500_ldo_aux1\",    .driver_data = (void *) AB8505_LDO_AUX1, },\n\t{ .name\t= \"ab8500_ldo_aux2\",    .driver_data = (void *) AB8505_LDO_AUX2, },\n\t{ .name\t= \"ab8500_ldo_aux3\",    .driver_data = (void *) AB8505_LDO_AUX3, },\n\t{ .name\t= \"ab8500_ldo_aux4\",    .driver_data = (void *) AB8505_LDO_AUX4, },\n\t{ .name\t= \"ab8500_ldo_aux5\",    .driver_data = (void *) AB8505_LDO_AUX5, },\n\t{ .name\t= \"ab8500_ldo_aux6\",    .driver_data = (void *) AB8505_LDO_AUX6, },\n\t{ .name\t= \"ab8500_ldo_intcore\", .driver_data = (void *) AB8505_LDO_INTCORE, },\n\t{ .name\t= \"ab8500_ldo_adc\",\t.driver_data = (void *) AB8505_LDO_ADC, },\n\t{ .name = \"ab8500_ldo_audio\",   .driver_data = (void *) AB8505_LDO_AUDIO, },\n\t{ .name\t= \"ab8500_ldo_anamic1\", .driver_data = (void *) AB8505_LDO_ANAMIC1, },\n\t{ .name\t= \"ab8500_ldo_anamic2\", .driver_data = (void *) AB8505_LDO_ANAMIC2, },\n\t{ .name\t= \"ab8500_ldo_aux8\",    .driver_data = (void *) AB8505_LDO_AUX8, },\n\t{ .name\t= \"ab8500_ldo_ana\",     .driver_data = (void *) AB8505_LDO_ANA, },\n};\n\nstatic struct {\n\tstruct ab8500_regulator_info *info;\n\tint info_size;\n\tstruct ab8500_reg_init *init;\n\tint init_size;\n\tstruct of_regulator_match *match;\n\tint match_size;\n} abx500_regulator;\n\nstatic void abx500_get_regulator_info(struct ab8500 *ab8500)\n{\n\tif (is_ab8505(ab8500)) {\n\t\tabx500_regulator.info = ab8505_regulator_info;\n\t\tabx500_regulator.info_size = ARRAY_SIZE(ab8505_regulator_info);\n\t\tabx500_regulator.init = ab8505_reg_init;\n\t\tabx500_regulator.init_size = AB8505_NUM_REGULATOR_REGISTERS;\n\t\tabx500_regulator.match = ab8505_regulator_match;\n\t\tabx500_regulator.match_size = ARRAY_SIZE(ab8505_regulator_match);\n\t} else {\n\t\tabx500_regulator.info = ab8500_regulator_info;\n\t\tabx500_regulator.info_size = ARRAY_SIZE(ab8500_regulator_info);\n\t\tabx500_regulator.init = ab8500_reg_init;\n\t\tabx500_regulator.init_size = AB8500_NUM_REGULATOR_REGISTERS;\n\t\tabx500_regulator.match = ab8500_regulator_match;\n\t\tabx500_regulator.match_size = ARRAY_SIZE(ab8500_regulator_match);\n\t}\n}\n\nstatic int ab8500_regulator_register(struct platform_device *pdev,\n\t\t\t\t     struct regulator_init_data *init_data,\n\t\t\t\t     int id, struct device_node *np)\n{\n\tstruct ab8500 *ab8500 = dev_get_drvdata(pdev->dev.parent);\n\tstruct ab8500_regulator_info *info = NULL;\n\tstruct regulator_config config = { };\n\tstruct regulator_dev *rdev;\n\n\t \n\tinfo = &abx500_regulator.info[id];\n\tinfo->dev = &pdev->dev;\n\n\tconfig.dev = &pdev->dev;\n\tconfig.init_data = init_data;\n\tconfig.driver_data = info;\n\tconfig.of_node = np;\n\n\t \n\tif (is_ab8500_1p1_or_earlier(ab8500)) {\n\t\tif (info->desc.id == AB8500_LDO_AUX3) {\n\t\t\tinfo->desc.n_voltages =\n\t\t\t\tARRAY_SIZE(ldo_vauxn_voltages);\n\t\t\tinfo->desc.volt_table = ldo_vauxn_voltages;\n\t\t\tinfo->voltage_mask = 0xf;\n\t\t}\n\t}\n\n\t \n\trdev = devm_regulator_register(&pdev->dev, &info->desc, &config);\n\tif (IS_ERR(rdev)) {\n\t\tdev_err(&pdev->dev, \"failed to register regulator %s\\n\",\n\t\t\tinfo->desc.name);\n\t\treturn PTR_ERR(rdev);\n\t}\n\n\treturn 0;\n}\n\nstatic int ab8500_regulator_probe(struct platform_device *pdev)\n{\n\tstruct ab8500 *ab8500 = dev_get_drvdata(pdev->dev.parent);\n\tstruct device_node *np = pdev->dev.of_node;\n\tstruct of_regulator_match *match;\n\tint err, i;\n\n\tif (!ab8500) {\n\t\tdev_err(&pdev->dev, \"null mfd parent\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tabx500_get_regulator_info(ab8500);\n\n\terr = of_regulator_match(&pdev->dev, np,\n\t\t\t\t abx500_regulator.match,\n\t\t\t\t abx500_regulator.match_size);\n\tif (err < 0) {\n\t\tdev_err(&pdev->dev,\n\t\t\t\"Error parsing regulator init data: %d\\n\", err);\n\t\treturn err;\n\t}\n\n\tmatch = abx500_regulator.match;\n\tfor (i = 0; i < abx500_regulator.info_size; i++) {\n\t\terr = ab8500_regulator_register(pdev, match[i].init_data, i,\n\t\t\t\t\t\tmatch[i].of_node);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nstatic struct platform_driver ab8500_regulator_driver = {\n\t.probe = ab8500_regulator_probe,\n\t.driver         = {\n\t\t.name   = \"ab8500-regulator\",\n\t\t.probe_type = PROBE_PREFER_ASYNCHRONOUS,\n\t},\n};\n\nstatic int __init ab8500_regulator_init(void)\n{\n\tint ret;\n\n\tret = platform_driver_register(&ab8500_regulator_driver);\n\tif (ret != 0)\n\t\tpr_err(\"Failed to register ab8500 regulator: %d\\n\", ret);\n\n\treturn ret;\n}\nsubsys_initcall(ab8500_regulator_init);\n\nstatic void __exit ab8500_regulator_exit(void)\n{\n\tplatform_driver_unregister(&ab8500_regulator_driver);\n}\nmodule_exit(ab8500_regulator_exit);\n\nMODULE_LICENSE(\"GPL v2\");\nMODULE_AUTHOR(\"Sundar Iyer <sundar.iyer@stericsson.com>\");\nMODULE_AUTHOR(\"Bengt Jonsson <bengt.g.jonsson@stericsson.com>\");\nMODULE_AUTHOR(\"Daniel Willerud <daniel.willerud@stericsson.com>\");\nMODULE_DESCRIPTION(\"Regulator Driver for ST-Ericsson AB8500 Mixed-Sig PMIC\");\nMODULE_ALIAS(\"platform:ab8500-regulator\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}