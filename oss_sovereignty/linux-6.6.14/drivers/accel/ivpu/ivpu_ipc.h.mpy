{
  "module_name": "ivpu_ipc.h",
  "hash_id": "c4240a6a4005d93177ecc82527dab34a7515f0eabe858050aee94c244b29293a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/accel/ivpu/ivpu_ipc.h",
  "human_readable_source": " \n \n\n#ifndef __IVPU_IPC_H__\n#define __IVPU_IPC_H__\n\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n\n#include \"vpu_jsm_api.h\"\n\nstruct ivpu_bo;\n\n \n#define IVPU_IPC_CHAN_BOOT_MSG\t\t0x3ff\n#define IVPU_IPC_BOOT_MSG_DATA_ADDR\t0x424f4f54\n\n \n#define IVPU_IPC_ALIGNMENT\t   64\n\n#define IVPU_IPC_HDR_FREE\t   0\n#define IVPU_IPC_HDR_ALLOCATED\t   1\n\n \nstruct ivpu_ipc_hdr {\n\tu32 data_addr;\n\tu32 data_size;\n\tu16 channel;\n\tu8 src_node;\n\tu8 dst_node;\n\tu8 status;\n} __packed __aligned(IVPU_IPC_ALIGNMENT);\n\nstruct ivpu_ipc_consumer {\n\tstruct list_head link;\n\tu32 channel;\n\tu32 tx_vpu_addr;\n\tu32 request_id;\n\n\tspinlock_t rx_msg_lock;  \n\tstruct list_head rx_msg_list;\n\twait_queue_head_t rx_msg_wq;\n};\n\nstruct ivpu_ipc_info {\n\tstruct gen_pool *mm_tx;\n\tstruct ivpu_bo *mem_tx;\n\tstruct ivpu_bo *mem_rx;\n\n\tatomic_t rx_msg_count;\n\n\tspinlock_t cons_list_lock;  \n\tstruct list_head cons_list;\n\n\tatomic_t request_id;\n\tstruct mutex lock;  \n\tbool on;\n};\n\nint ivpu_ipc_init(struct ivpu_device *vdev);\nvoid ivpu_ipc_fini(struct ivpu_device *vdev);\n\nvoid ivpu_ipc_enable(struct ivpu_device *vdev);\nvoid ivpu_ipc_disable(struct ivpu_device *vdev);\nvoid ivpu_ipc_reset(struct ivpu_device *vdev);\n\nint ivpu_ipc_irq_handler(struct ivpu_device *vdev);\n\nvoid ivpu_ipc_consumer_add(struct ivpu_device *vdev, struct ivpu_ipc_consumer *cons,\n\t\t\t   u32 channel);\nvoid ivpu_ipc_consumer_del(struct ivpu_device *vdev, struct ivpu_ipc_consumer *cons);\n\nint ivpu_ipc_receive(struct ivpu_device *vdev, struct ivpu_ipc_consumer *cons,\n\t\t     struct ivpu_ipc_hdr *ipc_buf, struct vpu_jsm_msg *ipc_payload,\n\t\t     unsigned long timeout_ms);\n\nint ivpu_ipc_send_receive(struct ivpu_device *vdev, struct vpu_jsm_msg *req,\n\t\t\t  enum vpu_ipc_msg_type expected_resp_type,\n\t\t\t  struct vpu_jsm_msg *resp, u32 channel,\n\t\t\t  unsigned long timeout_ms);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}