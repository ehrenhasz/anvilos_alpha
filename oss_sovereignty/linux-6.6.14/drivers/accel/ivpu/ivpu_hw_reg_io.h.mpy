{
  "module_name": "ivpu_hw_reg_io.h",
  "hash_id": "398f3634a1d9608f19094751ad3bcb2af87428ecb6056cd8e4a614af7596c776",
  "original_prompt": "Ingested from linux-6.6.14/drivers/accel/ivpu/ivpu_hw_reg_io.h",
  "human_readable_source": " \n \n\n#ifndef __IVPU_HW_REG_IO_H__\n#define __IVPU_HW_REG_IO_H__\n\n#include <linux/bitfield.h>\n#include <linux/io.h>\n#include <linux/iopoll.h>\n\n#include \"ivpu_drv.h\"\n\n#define REG_POLL_SLEEP_US 50\n#define REG_IO_ERROR      0xffffffff\n\n#define REGB_RD32(reg)          ivpu_hw_reg_rd32(vdev, vdev->regb, (reg), #reg, __func__)\n#define REGB_RD32_SILENT(reg)   readl(vdev->regb + (reg))\n#define REGB_RD64(reg)          ivpu_hw_reg_rd64(vdev, vdev->regb, (reg), #reg, __func__)\n#define REGB_WR32(reg, val)     ivpu_hw_reg_wr32(vdev, vdev->regb, (reg), (val), #reg, __func__)\n#define REGB_WR64(reg, val)     ivpu_hw_reg_wr64(vdev, vdev->regb, (reg), (val), #reg, __func__)\n\n#define REGV_RD32(reg)          ivpu_hw_reg_rd32(vdev, vdev->regv, (reg), #reg, __func__)\n#define REGV_RD32_SILENT(reg)   readl(vdev->regv + (reg))\n#define REGV_RD64(reg)          ivpu_hw_reg_rd64(vdev, vdev->regv, (reg), #reg, __func__)\n#define REGV_WR32(reg, val)     ivpu_hw_reg_wr32(vdev, vdev->regv, (reg), (val), #reg, __func__)\n#define REGV_WR64(reg, val)     ivpu_hw_reg_wr64(vdev, vdev->regv, (reg), (val), #reg, __func__)\n\n#define REGV_WR32I(reg, stride, index, val) \\\n\tivpu_hw_reg_wr32_index(vdev, vdev->regv, (reg), (stride), (index), (val), #reg, __func__)\n\n#define REG_FLD(REG, FLD) \\\n\t(REG##_##FLD##_MASK)\n#define REG_FLD_NUM(REG, FLD, num) \\\n\tFIELD_PREP(REG##_##FLD##_MASK, num)\n#define REG_GET_FLD(REG, FLD, val) \\\n\tFIELD_GET(REG##_##FLD##_MASK, val)\n#define REG_CLR_FLD(REG, FLD, val) \\\n\t((val) & ~(REG##_##FLD##_MASK))\n#define REG_SET_FLD(REG, FLD, val) \\\n\t((val) | (REG##_##FLD##_MASK))\n#define REG_SET_FLD_NUM(REG, FLD, num, val) \\\n\t(((val) & ~(REG##_##FLD##_MASK)) | FIELD_PREP(REG##_##FLD##_MASK, num))\n#define REG_TEST_FLD(REG, FLD, val) \\\n\t((REG##_##FLD##_MASK) == ((val) & (REG##_##FLD##_MASK)))\n#define REG_TEST_FLD_NUM(REG, FLD, num, val) \\\n\t((num) == FIELD_GET(REG##_##FLD##_MASK, val))\n\n#define REGB_POLL(reg, var, cond, timeout_us) \\\n\tread_poll_timeout(REGB_RD32_SILENT, var, cond, REG_POLL_SLEEP_US, timeout_us, false, reg)\n\n#define REGV_POLL(reg, var, cond, timeout_us) \\\n\tread_poll_timeout(REGV_RD32_SILENT, var, cond, REG_POLL_SLEEP_US, timeout_us, false, reg)\n\n#define REGB_POLL_FLD(reg, fld, val, timeout_us) \\\n({ \\\n\tu32 var; \\\n\tREGB_POLL(reg, var, (FIELD_GET(reg##_##fld##_MASK, var) == (val)), timeout_us); \\\n})\n\n#define REGV_POLL_FLD(reg, fld, val, timeout_us) \\\n({ \\\n\tu32 var; \\\n\tREGV_POLL(reg, var, (FIELD_GET(reg##_##fld##_MASK, var) == (val)), timeout_us); \\\n})\n\nstatic inline u32\nivpu_hw_reg_rd32(struct ivpu_device *vdev, void __iomem *base, u32 reg,\n\t\t const char *name, const char *func)\n{\n\tu32 val = readl(base + reg);\n\n\tivpu_dbg(vdev, REG, \"%s RD: %s (0x%08x) => 0x%08x\\n\", func, name, reg, val);\n\treturn val;\n}\n\nstatic inline u64\nivpu_hw_reg_rd64(struct ivpu_device *vdev, void __iomem *base, u32 reg,\n\t\t const char *name, const char *func)\n{\n\tu64 val = readq(base + reg);\n\n\tivpu_dbg(vdev, REG, \"%s RD: %s (0x%08x) => 0x%016llx\\n\", func, name, reg, val);\n\treturn val;\n}\n\nstatic inline void\nivpu_hw_reg_wr32(struct ivpu_device *vdev, void __iomem *base, u32 reg, u32 val,\n\t\t const char *name, const char *func)\n{\n\tivpu_dbg(vdev, REG, \"%s WR: %s (0x%08x) <= 0x%08x\\n\", func, name, reg, val);\n\twritel(val, base + reg);\n}\n\nstatic inline void\nivpu_hw_reg_wr64(struct ivpu_device *vdev, void __iomem *base, u32 reg, u64 val,\n\t\t const char *name, const char *func)\n{\n\tivpu_dbg(vdev, REG, \"%s WR: %s (0x%08x) <= 0x%016llx\\n\", func, name, reg, val);\n\twriteq(val, base + reg);\n}\n\nstatic inline void\nivpu_hw_reg_wr32_index(struct ivpu_device *vdev, void __iomem *base, u32 reg,\n\t\t       u32 stride, u32 index, u32 val, const char *name,\n\t\t       const char *func)\n{\n\treg += index * stride;\n\n\tivpu_dbg(vdev, REG, \"%s WR: %s_%d (0x%08x) <= 0x%08x\\n\", func, name, index, reg, val);\n\twritel(val, base + reg);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}