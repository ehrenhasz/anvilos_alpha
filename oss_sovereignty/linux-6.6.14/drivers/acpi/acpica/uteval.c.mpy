{
  "module_name": "uteval.c",
  "hash_id": "db8222a9f6aabdaaef1846958e458481f54202f8e3e8aed052b92bb86a5ee2f5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/uteval.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acnamesp.h\"\n\n#define _COMPONENT          ACPI_UTILITIES\nACPI_MODULE_NAME(\"uteval\")\n\n \n\nacpi_status\nacpi_ut_evaluate_object(struct acpi_namespace_node *prefix_node,\n\t\t\tconst char *path,\n\t\t\tu32 expected_return_btypes,\n\t\t\tunion acpi_operand_object **return_desc)\n{\n\tstruct acpi_evaluate_info *info;\n\tacpi_status status;\n\tu32 return_btype;\n\n\tACPI_FUNCTION_TRACE(ut_evaluate_object);\n\n\t \n\n\tinfo = ACPI_ALLOCATE_ZEROED(sizeof(struct acpi_evaluate_info));\n\tif (!info) {\n\t\treturn_ACPI_STATUS(AE_NO_MEMORY);\n\t}\n\n\tinfo->prefix_node = prefix_node;\n\tinfo->relative_pathname = path;\n\n\t \n\n\tstatus = acpi_ns_evaluate(info);\n\tif (ACPI_FAILURE(status)) {\n\t\tif (status == AE_NOT_FOUND) {\n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_EXEC,\n\t\t\t\t\t  \"[%4.4s.%s] was not found\\n\",\n\t\t\t\t\t  acpi_ut_get_node_name(prefix_node),\n\t\t\t\t\t  path));\n\t\t} else {\n\t\t\tACPI_ERROR_METHOD(\"Method execution failed\",\n\t\t\t\t\t  prefix_node, path, status);\n\t\t}\n\n\t\tgoto cleanup;\n\t}\n\n\t \n\n\tif (!info->return_object) {\n\t\tif (expected_return_btypes) {\n\t\t\tACPI_ERROR_METHOD(\"No object was returned from\",\n\t\t\t\t\t  prefix_node, path, AE_NOT_EXIST);\n\n\t\t\tstatus = AE_NOT_EXIST;\n\t\t}\n\n\t\tgoto cleanup;\n\t}\n\n\t \n\n\tswitch ((info->return_object)->common.type) {\n\tcase ACPI_TYPE_INTEGER:\n\n\t\treturn_btype = ACPI_BTYPE_INTEGER;\n\t\tbreak;\n\n\tcase ACPI_TYPE_BUFFER:\n\n\t\treturn_btype = ACPI_BTYPE_BUFFER;\n\t\tbreak;\n\n\tcase ACPI_TYPE_STRING:\n\n\t\treturn_btype = ACPI_BTYPE_STRING;\n\t\tbreak;\n\n\tcase ACPI_TYPE_PACKAGE:\n\n\t\treturn_btype = ACPI_BTYPE_PACKAGE;\n\t\tbreak;\n\n\tdefault:\n\n\t\treturn_btype = 0;\n\t\tbreak;\n\t}\n\n\tif ((acpi_gbl_enable_interpreter_slack) && (!expected_return_btypes)) {\n\t\t \n\t\tacpi_ut_remove_reference(info->return_object);\n\t\tgoto cleanup;\n\t}\n\n\t \n\n\tif (!(expected_return_btypes & return_btype)) {\n\t\tACPI_ERROR_METHOD(\"Return object type is incorrect\",\n\t\t\t\t  prefix_node, path, AE_TYPE);\n\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"Type returned from %s was incorrect: %s, expected Btypes: 0x%X\",\n\t\t\t    path,\n\t\t\t    acpi_ut_get_object_type_name(info->return_object),\n\t\t\t    expected_return_btypes));\n\n\t\t \n\n\t\tacpi_ut_remove_reference(info->return_object);\n\t\tstatus = AE_TYPE;\n\t\tgoto cleanup;\n\t}\n\n\t \n\n\t*return_desc = info->return_object;\n\ncleanup:\n\tACPI_FREE(info);\n\treturn_ACPI_STATUS(status);\n}\n\n \n\nacpi_status\nacpi_ut_evaluate_numeric_object(const char *object_name,\n\t\t\t\tstruct acpi_namespace_node *device_node,\n\t\t\t\tu64 *value)\n{\n\tunion acpi_operand_object *obj_desc;\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(ut_evaluate_numeric_object);\n\n\tstatus = acpi_ut_evaluate_object(device_node, object_name,\n\t\t\t\t\t ACPI_BTYPE_INTEGER, &obj_desc);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\t \n\n\t*value = obj_desc->integer.value;\n\n\t \n\n\tacpi_ut_remove_reference(obj_desc);\n\treturn_ACPI_STATUS(status);\n}\n\n \n\nacpi_status\nacpi_ut_execute_STA(struct acpi_namespace_node *device_node, u32 * flags)\n{\n\tunion acpi_operand_object *obj_desc;\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(ut_execute_STA);\n\n\tstatus = acpi_ut_evaluate_object(device_node, METHOD_NAME__STA,\n\t\t\t\t\t ACPI_BTYPE_INTEGER, &obj_desc);\n\tif (ACPI_FAILURE(status)) {\n\t\tif (AE_NOT_FOUND == status) {\n\t\t\t \n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_EXEC,\n\t\t\t\t\t  \"_STA on %4.4s was not found, assuming device is present\\n\",\n\t\t\t\t\t  acpi_ut_get_node_name(device_node)));\n\n\t\t\t*flags = ACPI_UINT32_MAX;\n\t\t\tstatus = AE_OK;\n\t\t}\n\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\t \n\n\t*flags = (u32) obj_desc->integer.value;\n\n\t \n\n\tacpi_ut_remove_reference(obj_desc);\n\treturn_ACPI_STATUS(status);\n}\n\n \n\nacpi_status\nacpi_ut_execute_power_methods(struct acpi_namespace_node *device_node,\n\t\t\t      const char **method_names,\n\t\t\t      u8 method_count, u8 *out_values)\n{\n\tunion acpi_operand_object *obj_desc;\n\tacpi_status status;\n\tacpi_status final_status = AE_NOT_FOUND;\n\tu32 i;\n\n\tACPI_FUNCTION_TRACE(ut_execute_power_methods);\n\n\tfor (i = 0; i < method_count; i++) {\n\t\t \n\t\tstatus = acpi_ut_evaluate_object(device_node,\n\t\t\t\t\t\t ACPI_CAST_PTR(char,\n\t\t\t\t\t\t\t       method_names[i]),\n\t\t\t\t\t\t ACPI_BTYPE_INTEGER, &obj_desc);\n\t\tif (ACPI_SUCCESS(status)) {\n\t\t\tout_values[i] = (u8)obj_desc->integer.value;\n\n\t\t\t \n\n\t\t\tacpi_ut_remove_reference(obj_desc);\n\t\t\tfinal_status = AE_OK;\t \n\t\t\tcontinue;\n\t\t}\n\n\t\tout_values[i] = ACPI_UINT8_MAX;\n\t\tif (status == AE_NOT_FOUND) {\n\t\t\tcontinue;\t \n\t\t}\n\n\t\tACPI_DEBUG_PRINT((ACPI_DB_EXEC,\n\t\t\t\t  \"Failed %s on Device %4.4s, %s\\n\",\n\t\t\t\t  ACPI_CAST_PTR(char, method_names[i]),\n\t\t\t\t  acpi_ut_get_node_name(device_node),\n\t\t\t\t  acpi_format_exception(status)));\n\t}\n\n\treturn_ACPI_STATUS(final_status);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}