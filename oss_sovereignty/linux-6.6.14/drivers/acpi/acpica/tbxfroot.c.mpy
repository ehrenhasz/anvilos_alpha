{
  "module_name": "tbxfroot.c",
  "hash_id": "a420768c99c64bd72fa2afb8004a7d2333446d4fbf62fcc9e1aa65d94681d3e2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/tbxfroot.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"actables.h\"\n\n#define _COMPONENT          ACPI_TABLES\nACPI_MODULE_NAME(\"tbxfroot\")\n\n \nu32 acpi_tb_get_rsdp_length(struct acpi_table_rsdp *rsdp)\n{\n\n\tif (!ACPI_VALIDATE_RSDP_SIG(rsdp->signature)) {\n\n\t\t \n\n\t\treturn (0);\n\t}\n\n\t \n\n\tif (rsdp->revision >= 2) {\n\t\treturn (rsdp->length);\n\t} else {\n\t\treturn (ACPI_RSDP_CHECKSUM_LENGTH);\n\t}\n}\n\n \n\nacpi_status acpi_tb_validate_rsdp(struct acpi_table_rsdp *rsdp)\n{\n\n\t \n\tif (!ACPI_VALIDATE_RSDP_SIG(rsdp->signature)) {\n\n\t\t \n\n\t\treturn (AE_BAD_SIGNATURE);\n\t}\n\n\t \n\n\tif (acpi_ut_checksum((u8 *)rsdp, ACPI_RSDP_CHECKSUM_LENGTH) != 0) {\n\t\treturn (AE_BAD_CHECKSUM);\n\t}\n\n\t \n\n\tif ((rsdp->revision >= 2) &&\n\t    (acpi_ut_checksum((u8 *)rsdp, ACPI_RSDP_XCHECKSUM_LENGTH) != 0)) {\n\t\treturn (AE_BAD_CHECKSUM);\n\t}\n\n\treturn (AE_OK);\n}\n\n \n\nacpi_status ACPI_INIT_FUNCTION\nacpi_find_root_pointer(acpi_physical_address *table_address)\n{\n\tu8 *table_ptr;\n\tu8 *mem_rover;\n\tu32 physical_address;\n\tu32 ebda_window_size;\n\n\tACPI_FUNCTION_TRACE(acpi_find_root_pointer);\n\n\t \n\n\ttable_ptr = acpi_os_map_memory((acpi_physical_address)\n\t\t\t\t       ACPI_EBDA_PTR_LOCATION,\n\t\t\t\t       ACPI_EBDA_PTR_LENGTH);\n\tif (!table_ptr) {\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"Could not map memory at 0x%8.8X for length %u\",\n\t\t\t    ACPI_EBDA_PTR_LOCATION, ACPI_EBDA_PTR_LENGTH));\n\n\t\treturn_ACPI_STATUS(AE_NO_MEMORY);\n\t}\n\n\tACPI_MOVE_16_TO_32(&physical_address, table_ptr);\n\n\t \n\n\tphysical_address <<= 4;\n\tacpi_os_unmap_memory(table_ptr, ACPI_EBDA_PTR_LENGTH);\n\n\t \n\n\t \n\tif (physical_address > 0x400 && physical_address < 0xA0000) {\n\t\t \n\t\tebda_window_size = ACPI_MIN(ACPI_EBDA_WINDOW_SIZE,\n\t\t\t\t\t    0xA0000 - physical_address);\n\n\t\t \n\t\ttable_ptr = acpi_os_map_memory((acpi_physical_address)\n\t\t\t\t\t       physical_address,\n\t\t\t\t\t       ebda_window_size);\n\t\tif (!table_ptr) {\n\t\t\tACPI_ERROR((AE_INFO,\n\t\t\t\t    \"Could not map memory at 0x%8.8X for length %u\",\n\t\t\t\t    physical_address, ebda_window_size));\n\n\t\t\treturn_ACPI_STATUS(AE_NO_MEMORY);\n\t\t}\n\n\t\tmem_rover =\n\t\t    acpi_tb_scan_memory_for_rsdp(table_ptr, ebda_window_size);\n\t\tacpi_os_unmap_memory(table_ptr, ebda_window_size);\n\n\t\tif (mem_rover) {\n\n\t\t\t \n\n\t\t\tphysical_address +=\n\t\t\t    (u32) ACPI_PTR_DIFF(mem_rover, table_ptr);\n\n\t\t\t*table_address =\n\t\t\t    (acpi_physical_address)physical_address;\n\t\t\treturn_ACPI_STATUS(AE_OK);\n\t\t}\n\t}\n\n\t \n\ttable_ptr = acpi_os_map_memory((acpi_physical_address)\n\t\t\t\t       ACPI_HI_RSDP_WINDOW_BASE,\n\t\t\t\t       ACPI_HI_RSDP_WINDOW_SIZE);\n\n\tif (!table_ptr) {\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"Could not map memory at 0x%8.8X for length %u\",\n\t\t\t    ACPI_HI_RSDP_WINDOW_BASE,\n\t\t\t    ACPI_HI_RSDP_WINDOW_SIZE));\n\n\t\treturn_ACPI_STATUS(AE_NO_MEMORY);\n\t}\n\n\tmem_rover =\n\t    acpi_tb_scan_memory_for_rsdp(table_ptr, ACPI_HI_RSDP_WINDOW_SIZE);\n\tacpi_os_unmap_memory(table_ptr, ACPI_HI_RSDP_WINDOW_SIZE);\n\n\tif (mem_rover) {\n\n\t\t \n\n\t\tphysical_address = (u32)\n\t\t    (ACPI_HI_RSDP_WINDOW_BASE +\n\t\t     ACPI_PTR_DIFF(mem_rover, table_ptr));\n\n\t\t*table_address = (acpi_physical_address)physical_address;\n\t\treturn_ACPI_STATUS(AE_OK);\n\t}\n\n\t \n\n\tACPI_BIOS_ERROR((AE_INFO, \"A valid RSDP was not found\"));\n\treturn_ACPI_STATUS(AE_NOT_FOUND);\n}\n\nACPI_EXPORT_SYMBOL_INIT(acpi_find_root_pointer)\n\n \nu8 *acpi_tb_scan_memory_for_rsdp(u8 *start_address, u32 length)\n{\n\tacpi_status status;\n\tu8 *mem_rover;\n\tu8 *end_address;\n\n\tACPI_FUNCTION_TRACE(tb_scan_memory_for_rsdp);\n\n\tend_address = start_address + length;\n\n\t \n\n\tfor (mem_rover = start_address; mem_rover < end_address;\n\t     mem_rover += ACPI_RSDP_SCAN_STEP) {\n\n\t\t \n\n\t\tstatus =\n\t\t    acpi_tb_validate_rsdp(ACPI_CAST_PTR\n\t\t\t\t\t  (struct acpi_table_rsdp, mem_rover));\n\t\tif (ACPI_SUCCESS(status)) {\n\n\t\t\t \n\n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_INFO,\n\t\t\t\t\t  \"RSDP located at physical address %p\\n\",\n\t\t\t\t\t  mem_rover));\n\t\t\treturn_PTR(mem_rover);\n\t\t}\n\n\t\t \n\t}\n\n\t \n\n\tACPI_DEBUG_PRINT((ACPI_DB_INFO,\n\t\t\t  \"Searched entire block from %p, valid RSDP was not found\\n\",\n\t\t\t  start_address));\n\treturn_PTR(NULL);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}