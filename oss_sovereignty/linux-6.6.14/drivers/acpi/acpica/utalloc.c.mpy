{
  "module_name": "utalloc.c",
  "hash_id": "48bf3065180ac184c2e15586fba902e6ab0957bb9a23c2d09499e47b79b96ca2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/utalloc.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acdebug.h\"\n\n#define _COMPONENT          ACPI_UTILITIES\nACPI_MODULE_NAME(\"utalloc\")\n\n#if !defined (USE_NATIVE_ALLOCATE_ZEROED)\n \nvoid *acpi_os_allocate_zeroed(acpi_size size)\n{\n\tvoid *allocation;\n\n\tACPI_FUNCTION_ENTRY();\n\n\tallocation = acpi_os_allocate(size);\n\tif (allocation) {\n\n\t\t \n\n\t\tmemset(allocation, 0, size);\n\t}\n\n\treturn (allocation);\n}\n\n#endif\t\t\t\t \n\n \n\nacpi_status acpi_ut_create_caches(void)\n{\n\tacpi_status status;\n\n\t \n\n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-Namespace\",\n\t\t\t\t sizeof(struct acpi_namespace_node),\n\t\t\t\t ACPI_MAX_NAMESPACE_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_namespace_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-State\", sizeof(union acpi_generic_state),\n\t\t\t\t ACPI_MAX_STATE_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_state_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-Parse\",\n\t\t\t\t sizeof(struct acpi_parse_obj_common),\n\t\t\t\t ACPI_MAX_PARSE_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_ps_node_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-ParseExt\",\n\t\t\t\t sizeof(struct acpi_parse_obj_named),\n\t\t\t\t ACPI_MAX_EXTPARSE_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_ps_node_ext_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-Operand\",\n\t\t\t\t sizeof(union acpi_operand_object),\n\t\t\t\t ACPI_MAX_OBJECT_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_operand_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n#ifdef ACPI_ASL_COMPILER\n\t \n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-Comment\",\n\t\t\t\t sizeof(struct acpi_comment_node),\n\t\t\t\t ACPI_MAX_COMMENT_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_reg_comment_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\t \n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-Comment-Addr\",\n\t\t\t\t sizeof(struct acpi_comment_addr_node),\n\t\t\t\t ACPI_MAX_COMMENT_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_comment_addr_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\t \n\tstatus =\n\t    acpi_os_create_cache(\"Acpi-File\", sizeof(struct acpi_file_node),\n\t\t\t\t ACPI_MAX_COMMENT_CACHE_DEPTH,\n\t\t\t\t &acpi_gbl_file_cache);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n#endif\n\n#ifdef ACPI_DBG_TRACK_ALLOCATIONS\n\n\t \n\n\tstatus = acpi_ut_create_list(\"Acpi-Global\", 0, &acpi_gbl_global_list);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n\n\tstatus =\n\t    acpi_ut_create_list(\"Acpi-Namespace\",\n\t\t\t\tsizeof(struct acpi_namespace_node),\n\t\t\t\t&acpi_gbl_ns_node_list);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn (status);\n\t}\n#endif\n\n\treturn (AE_OK);\n}\n\n \n\nacpi_status acpi_ut_delete_caches(void)\n{\n#ifdef ACPI_DBG_TRACK_ALLOCATIONS\n\tchar buffer[7];\n\n\tif (acpi_gbl_display_final_mem_stats) {\n\t\tstrcpy(buffer, \"MEMORY\");\n\t\t(void)acpi_db_display_statistics(buffer);\n\t}\n#endif\n\n\t(void)acpi_os_delete_cache(acpi_gbl_namespace_cache);\n\tacpi_gbl_namespace_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_state_cache);\n\tacpi_gbl_state_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_operand_cache);\n\tacpi_gbl_operand_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_ps_node_cache);\n\tacpi_gbl_ps_node_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_ps_node_ext_cache);\n\tacpi_gbl_ps_node_ext_cache = NULL;\n\n#ifdef ACPI_ASL_COMPILER\n\t(void)acpi_os_delete_cache(acpi_gbl_reg_comment_cache);\n\tacpi_gbl_reg_comment_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_comment_addr_cache);\n\tacpi_gbl_comment_addr_cache = NULL;\n\n\t(void)acpi_os_delete_cache(acpi_gbl_file_cache);\n\tacpi_gbl_file_cache = NULL;\n#endif\n\n#ifdef ACPI_DBG_TRACK_ALLOCATIONS\n\n\t \n\n\tacpi_ut_dump_allocations(ACPI_UINT32_MAX, NULL);\n\n\t \n\n\tacpi_os_free(acpi_gbl_global_list);\n\tacpi_gbl_global_list = NULL;\n\n\tacpi_os_free(acpi_gbl_ns_node_list);\n\tacpi_gbl_ns_node_list = NULL;\n#endif\n\n\treturn (AE_OK);\n}\n\n \n\nacpi_status acpi_ut_validate_buffer(struct acpi_buffer *buffer)\n{\n\n\t \n\n\tif (!buffer) {\n\t\treturn (AE_BAD_PARAMETER);\n\t}\n\n\t \n\n\tif ((buffer->length == ACPI_NO_BUFFER) ||\n\t    (buffer->length == ACPI_ALLOCATE_BUFFER) ||\n\t    (buffer->length == ACPI_ALLOCATE_LOCAL_BUFFER)) {\n\t\treturn (AE_OK);\n\t}\n\n\t \n\n\tif (!buffer->pointer) {\n\t\treturn (AE_BAD_PARAMETER);\n\t}\n\n\treturn (AE_OK);\n}\n\n \n\nacpi_status\nacpi_ut_initialize_buffer(struct acpi_buffer *buffer, acpi_size required_length)\n{\n\tacpi_size input_buffer_length;\n\n\t \n\n\tif (!buffer || !required_length) {\n\t\treturn (AE_BAD_PARAMETER);\n\t}\n\n\t \n\tinput_buffer_length = buffer->length;\n\tbuffer->length = required_length;\n\n\t \n\tswitch (input_buffer_length) {\n\tcase ACPI_NO_BUFFER:\n\n\t\t \n\n\t\treturn (AE_BUFFER_OVERFLOW);\n\n\tcase ACPI_ALLOCATE_BUFFER:\n\t\t \n\t\tbuffer->pointer = acpi_os_allocate(required_length);\n\t\tbreak;\n\n\tcase ACPI_ALLOCATE_LOCAL_BUFFER:\n\n\t\t \n\n\t\tbuffer->pointer = ACPI_ALLOCATE(required_length);\n\t\tbreak;\n\n\tdefault:\n\n\t\t \n\n\t\tif (input_buffer_length < required_length) {\n\t\t\treturn (AE_BUFFER_OVERFLOW);\n\t\t}\n\t\tbreak;\n\t}\n\n\t \n\n\tif (!buffer->pointer) {\n\t\treturn (AE_NO_MEMORY);\n\t}\n\n\t \n\n\tmemset(buffer->pointer, 0, required_length);\n\treturn (AE_OK);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}