{
  "module_name": "utcksum.c",
  "hash_id": "a12ccce9c86220cc798d2804b6481d1198c3066bb9b94197b9d70da1cd615bc4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/utcksum.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acutils.h\"\n\n \n\n#define _COMPONENT          ACPI_CA_DISASSEMBLER\nACPI_MODULE_NAME(\"utcksum\")\n\n \nacpi_status acpi_ut_verify_checksum(struct acpi_table_header *table, u32 length)\n{\n\tu8 checksum;\n\n\t \n\tif (ACPI_COMPARE_NAMESEG(table->signature, ACPI_SIG_S3PT) ||\n\t    ACPI_COMPARE_NAMESEG(table->signature, ACPI_SIG_FACS)) {\n\t\treturn (AE_OK);\n\t}\n\n\t \n\n\tlength = table->length;\n\tchecksum =\n\t    acpi_ut_generate_checksum(ACPI_CAST_PTR(u8, table), length,\n\t\t\t\t      table->checksum);\n\n\t \n\n\tif (checksum != table->checksum) {\n\t\tACPI_BIOS_WARNING((AE_INFO,\n\t\t\t\t   \"Incorrect checksum in table [%4.4s] - 0x%2.2X, \"\n\t\t\t\t   \"should be 0x%2.2X\",\n\t\t\t\t   table->signature, table->checksum,\n\t\t\t\t   table->checksum - checksum));\n\n#if (ACPI_CHECKSUM_ABORT)\n\t\treturn (AE_BAD_CHECKSUM);\n#endif\n\t}\n\n\treturn (AE_OK);\n}\n\n \n\nacpi_status\nacpi_ut_verify_cdat_checksum(struct acpi_table_cdat *cdat_table, u32 length)\n{\n\tu8 checksum;\n\n\t \n\n\tchecksum = acpi_ut_generate_checksum(ACPI_CAST_PTR(u8, cdat_table),\n\t\t\t\t\t     cdat_table->length,\n\t\t\t\t\t     cdat_table->checksum);\n\n\t \n\n\tif (checksum != cdat_table->checksum) {\n\t\tACPI_BIOS_WARNING((AE_INFO,\n\t\t\t\t   \"Incorrect checksum in table [%4.4s] - 0x%2.2X, \"\n\t\t\t\t   \"should be 0x%2.2X\",\n\t\t\t\t   acpi_gbl_CDAT, cdat_table->checksum,\n\t\t\t\t   checksum));\n\n#if (ACPI_CHECKSUM_ABORT)\n\t\treturn (AE_BAD_CHECKSUM);\n#endif\n\t}\n\n\tcdat_table->checksum = checksum;\n\treturn (AE_OK);\n}\n\n \n\nu8 acpi_ut_generate_checksum(void *table, u32 length, u8 original_checksum)\n{\n\tu8 checksum;\n\n\t \n\n\tchecksum = acpi_ut_checksum((u8 *)table, length);\n\n\t \n\n\tchecksum = (u8)(checksum - original_checksum);\n\n\t \n\n\tchecksum = (u8)(0 - checksum);\n\treturn (checksum);\n}\n\n \n\nu8 acpi_ut_checksum(u8 *buffer, u32 length)\n{\n\tu8 sum = 0;\n\tu8 *end = buffer + length;\n\n\twhile (buffer < end) {\n\t\tsum = (u8)(sum + *(buffer++));\n\t}\n\n\treturn (sum);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}