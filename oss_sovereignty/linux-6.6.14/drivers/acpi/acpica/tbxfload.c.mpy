{
  "module_name": "tbxfload.c",
  "hash_id": "55e90b8bfd50f889f5a4e13b5beb0124a521d97ea5909c1180b598abf79a8ffb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/tbxfload.c",
  "human_readable_source": "\n \n\n#define EXPORT_ACPI_INTERFACES\n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acnamesp.h\"\n#include \"actables.h\"\n#include \"acevents.h\"\n\n#define _COMPONENT          ACPI_TABLES\nACPI_MODULE_NAME(\"tbxfload\")\n\n \nacpi_status ACPI_INIT_FUNCTION acpi_load_tables(void)\n{\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(acpi_load_tables);\n\n\t \n\tstatus = acpi_ev_install_region_handlers();\n\tif (ACPI_FAILURE(status)) {\n\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\"During Region initialization\"));\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\t \n\n\tstatus = acpi_tb_load_namespace();\n\n\t \n\n\tif (status == AE_CTRL_TERMINATE) {\n\t\tstatus = AE_OK;\n\t}\n\n\tif (ACPI_FAILURE(status)) {\n\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\"While loading namespace from ACPI tables\"));\n\t}\n\n\t \n\tstatus = acpi_ns_initialize_objects();\n\tif (ACPI_SUCCESS(status)) {\n\t\tacpi_gbl_namespace_initialized = TRUE;\n\t}\n\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL_INIT(acpi_load_tables)\n\n \nacpi_status acpi_tb_load_namespace(void)\n{\n\tacpi_status status;\n\tu32 i;\n\tstruct acpi_table_header *new_dsdt;\n\tstruct acpi_table_desc *table;\n\tu32 tables_loaded = 0;\n\tu32 tables_failed = 0;\n\n\tACPI_FUNCTION_TRACE(tb_load_namespace);\n\n\t(void)acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\n\t \n\ttable = &acpi_gbl_root_table_list.tables[acpi_gbl_dsdt_index];\n\n\tif (!acpi_gbl_root_table_list.current_table_count ||\n\t    !ACPI_COMPARE_NAMESEG(table->signature.ascii, ACPI_SIG_DSDT) ||\n\t    ACPI_FAILURE(acpi_tb_validate_table(table))) {\n\t\tstatus = AE_NO_ACPI_TABLES;\n\t\tgoto unlock_and_exit;\n\t}\n\n\t \n\tacpi_gbl_DSDT = table->pointer;\n\n\t \n\tif (acpi_gbl_copy_dsdt_locally) {\n\t\tnew_dsdt = acpi_tb_copy_dsdt(acpi_gbl_dsdt_index);\n\t\tif (new_dsdt) {\n\t\t\tacpi_gbl_DSDT = new_dsdt;\n\t\t}\n\t}\n\n\t \n\tmemcpy(&acpi_gbl_original_dsdt_header, acpi_gbl_DSDT,\n\t       sizeof(struct acpi_table_header));\n\n\t \n\n\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\tstatus = acpi_ns_load_table(acpi_gbl_dsdt_index, acpi_gbl_root_node);\n\t(void)acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\tif (ACPI_FAILURE(status)) {\n\t\tACPI_EXCEPTION((AE_INFO, status, \"[DSDT] table load failed\"));\n\t\ttables_failed++;\n\t} else {\n\t\ttables_loaded++;\n\t}\n\n\t \n\n\tfor (i = 0; i < acpi_gbl_root_table_list.current_table_count; ++i) {\n\t\ttable = &acpi_gbl_root_table_list.tables[i];\n\n\t\tif (!table->address ||\n\t\t    (!ACPI_COMPARE_NAMESEG\n\t\t     (table->signature.ascii, ACPI_SIG_SSDT)\n\t\t     && !ACPI_COMPARE_NAMESEG(table->signature.ascii,\n\t\t\t\t\t      ACPI_SIG_PSDT)\n\t\t     && !ACPI_COMPARE_NAMESEG(table->signature.ascii,\n\t\t\t\t\t      ACPI_SIG_OSDT))\n\t\t    || ACPI_FAILURE(acpi_tb_validate_table(table))) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t \n\n\t\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\t\tstatus = acpi_ns_load_table(i, acpi_gbl_root_node);\n\t\t(void)acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\t\tif (ACPI_FAILURE(status)) {\n\t\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\t\"(%4.4s:%8.8s) while loading table\",\n\t\t\t\t\ttable->signature.ascii,\n\t\t\t\t\ttable->pointer->oem_table_id));\n\n\t\t\ttables_failed++;\n\n\t\t\tACPI_DEBUG_PRINT_RAW((ACPI_DB_INIT,\n\t\t\t\t\t      \"Table [%4.4s:%8.8s] (id FF) - Table namespace load failed\\n\\n\",\n\t\t\t\t\t      table->signature.ascii,\n\t\t\t\t\t      table->pointer->oem_table_id));\n\t\t} else {\n\t\t\ttables_loaded++;\n\t\t}\n\t}\n\n\tif (!tables_failed) {\n\t\tACPI_INFO((\"%u ACPI AML tables successfully acquired and loaded\", tables_loaded));\n\t} else {\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"%u table load failures, %u successful\",\n\t\t\t    tables_failed, tables_loaded));\n\n\t\t \n\n\t\tstatus = AE_CTRL_TERMINATE;\n\t}\n\n#ifdef ACPI_APPLICATION\n\tACPI_DEBUG_PRINT_RAW((ACPI_DB_INIT, \"\\n\"));\n#endif\n\nunlock_and_exit:\n\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\treturn_ACPI_STATUS(status);\n}\n\n \n\nacpi_status ACPI_INIT_FUNCTION\nacpi_install_table(struct acpi_table_header *table)\n{\n\tacpi_status status;\n\tu32 table_index;\n\n\tACPI_FUNCTION_TRACE(acpi_install_table);\n\n\tstatus = acpi_tb_install_standard_table(ACPI_PTR_TO_PHYSADDR(table),\n\t\t\t\t\t\tACPI_TABLE_ORIGIN_EXTERNAL_VIRTUAL,\n\t\t\t\t\t\ttable, FALSE, FALSE,\n\t\t\t\t\t\t&table_index);\n\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL_INIT(acpi_install_table)\n\n \nacpi_status ACPI_INIT_FUNCTION\nacpi_install_physical_table(acpi_physical_address address)\n{\n\tacpi_status status;\n\tu32 table_index;\n\n\tACPI_FUNCTION_TRACE(acpi_install_physical_table);\n\n\tstatus = acpi_tb_install_standard_table(address,\n\t\t\t\t\t\tACPI_TABLE_ORIGIN_INTERNAL_PHYSICAL,\n\t\t\t\t\t\tNULL, FALSE, FALSE,\n\t\t\t\t\t\t&table_index);\n\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL_INIT(acpi_install_physical_table)\n\n \nacpi_status acpi_load_table(struct acpi_table_header *table, u32 *table_idx)\n{\n\tacpi_status status;\n\tu32 table_index;\n\n\tACPI_FUNCTION_TRACE(acpi_load_table);\n\n\t \n\n\tif (!table) {\n\t\treturn_ACPI_STATUS(AE_BAD_PARAMETER);\n\t}\n\n\t \n\n\tACPI_INFO((\"Host-directed Dynamic ACPI Table Load:\"));\n\tstatus = acpi_tb_install_and_load_table(ACPI_PTR_TO_PHYSADDR(table),\n\t\t\t\t\t\tACPI_TABLE_ORIGIN_EXTERNAL_VIRTUAL,\n\t\t\t\t\t\ttable, FALSE, &table_index);\n\tif (table_idx) {\n\t\t*table_idx = table_index;\n\t}\n\n\tif (ACPI_SUCCESS(status)) {\n\n\t\t \n\n\t\tacpi_ns_initialize_objects();\n\t}\n\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL(acpi_load_table)\n\n \nacpi_status acpi_unload_parent_table(acpi_handle object)\n{\n\tstruct acpi_namespace_node *node =\n\t    ACPI_CAST_PTR(struct acpi_namespace_node, object);\n\tacpi_status status = AE_NOT_EXIST;\n\tacpi_owner_id owner_id;\n\tu32 i;\n\n\tACPI_FUNCTION_TRACE(acpi_unload_parent_table);\n\n\t \n\n\tif (!object) {\n\t\treturn_ACPI_STATUS(AE_BAD_PARAMETER);\n\t}\n\n\t \n\towner_id = node->owner_id;\n\tif (!owner_id) {\n\n\t\t \n\n\t\treturn_ACPI_STATUS(AE_TYPE);\n\t}\n\n\t \n\n\tstatus = acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\tif (ACPI_FAILURE(status)) {\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\t \n\n\tfor (i = 0; i < acpi_gbl_root_table_list.current_table_count; i++) {\n\t\tif (owner_id != acpi_gbl_root_table_list.tables[i].owner_id) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t \n\t\tif (ACPI_COMPARE_NAMESEG\n\t\t    (acpi_gbl_root_table_list.tables[i].signature.ascii,\n\t\t     ACPI_SIG_DSDT)) {\n\t\t\tstatus = AE_TYPE;\n\t\t\tbreak;\n\t\t}\n\n\t\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\t\tstatus = acpi_tb_unload_table(i);\n\t\t(void)acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\t\tbreak;\n\t}\n\n\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL(acpi_unload_parent_table)\n \nacpi_status acpi_unload_table(u32 table_index)\n{\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(acpi_unload_table);\n\n\tif (table_index == 1) {\n\n\t\t \n\n\t\treturn_ACPI_STATUS(AE_TYPE);\n\t}\n\n\tstatus = acpi_tb_unload_table(table_index);\n\treturn_ACPI_STATUS(status);\n}\n\nACPI_EXPORT_SYMBOL(acpi_unload_table)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}