{
  "module_name": "rslist.c",
  "hash_id": "af5b0eb9fa507675f9efe3c008841e958e44d2f54082c491fd3d77a368ea0acb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/rslist.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acresrc.h\"\n\n#define _COMPONENT          ACPI_RESOURCES\nACPI_MODULE_NAME(\"rslist\")\n\n \nacpi_status\nacpi_rs_convert_aml_to_resources(u8 * aml,\n\t\t\t\t u32 length,\n\t\t\t\t u32 offset, u8 resource_index, void **context)\n{\n\tstruct acpi_resource **resource_ptr =\n\t    ACPI_CAST_INDIRECT_PTR(struct acpi_resource, context);\n\tstruct acpi_resource *resource;\n\tunion aml_resource *aml_resource;\n\tstruct acpi_rsconvert_info *conversion_table;\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(rs_convert_aml_to_resources);\n\n\t \n\tresource = *resource_ptr;\n\tif (ACPI_IS_MISALIGNED(resource)) {\n\t\tACPI_WARNING((AE_INFO,\n\t\t\t      \"Misaligned resource pointer %p\", resource));\n\t}\n\n\t \n\n\taml_resource = ACPI_CAST_PTR(union aml_resource, aml);\n\n\tif (acpi_ut_get_resource_type(aml) == ACPI_RESOURCE_NAME_SERIAL_BUS) {\n\n\t\t \n\n\t\tstruct aml_resource_common_serialbus common_serial_bus;\n\t\tmemcpy(&common_serial_bus, aml_resource,\n\t\t       sizeof(common_serial_bus));\n\n\t\tif (common_serial_bus.type > AML_RESOURCE_MAX_SERIALBUSTYPE) {\n\t\t\tconversion_table = NULL;\n\t\t} else {\n\t\t\t \n\n\t\t\tconversion_table =\n\t\t\t    acpi_gbl_convert_resource_serial_bus_dispatch\n\t\t\t    [common_serial_bus.type];\n\t\t}\n\t} else {\n\t\tconversion_table =\n\t\t    acpi_gbl_get_resource_dispatch[resource_index];\n\t}\n\n\tif (!conversion_table) {\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"Invalid/unsupported resource descriptor: Type 0x%2.2X\",\n\t\t\t    resource_index));\n\t\treturn_ACPI_STATUS(AE_AML_INVALID_RESOURCE_TYPE);\n\t}\n\n\t \n\n\tstatus =\n\t    acpi_rs_convert_aml_to_resource(resource, aml_resource,\n\t\t\t\t\t    conversion_table);\n\tif (ACPI_FAILURE(status)) {\n\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\"Could not convert AML resource (Type 0x%X)\",\n\t\t\t\t*aml));\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\tif (!resource->length) {\n\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\"Zero-length resource returned from RsConvertAmlToResource\"));\n\t}\n\n\tACPI_DEBUG_PRINT((ACPI_DB_RESOURCES,\n\t\t\t  \"Type %.2X, AmlLength %.2X InternalLength %.2X\\n\",\n\t\t\t  acpi_ut_get_resource_type(aml), length,\n\t\t\t  resource->length));\n\n\t \n\n\t*resource_ptr = ACPI_NEXT_RESOURCE(resource);\n\treturn_ACPI_STATUS(AE_OK);\n}\n\n \n\nacpi_status\nacpi_rs_convert_resources_to_aml(struct acpi_resource *resource,\n\t\t\t\t acpi_size aml_size_needed, u8 * output_buffer)\n{\n\tu8 *aml = output_buffer;\n\tu8 *end_aml = output_buffer + aml_size_needed;\n\tstruct acpi_rsconvert_info *conversion_table;\n\tacpi_status status;\n\n\tACPI_FUNCTION_TRACE(rs_convert_resources_to_aml);\n\n\t \n\n\twhile (aml < end_aml) {\n\n\t\t \n\n\t\tif (resource->type > ACPI_RESOURCE_TYPE_MAX) {\n\t\t\tACPI_ERROR((AE_INFO,\n\t\t\t\t    \"Invalid descriptor type (0x%X) in resource list\",\n\t\t\t\t    resource->type));\n\t\t\treturn_ACPI_STATUS(AE_BAD_DATA);\n\t\t}\n\n\t\t \n\n\t\tif (!resource->length) {\n\t\t\tACPI_ERROR((AE_INFO,\n\t\t\t\t    \"Invalid zero length descriptor in resource list\\n\"));\n\t\t\treturn_ACPI_STATUS(AE_AML_BAD_RESOURCE_LENGTH);\n\t\t}\n\n\t\t \n\n\t\tif (resource->type == ACPI_RESOURCE_TYPE_SERIAL_BUS) {\n\t\t\tif (resource->data.common_serial_bus.type >\n\t\t\t    AML_RESOURCE_MAX_SERIALBUSTYPE) {\n\t\t\t\tconversion_table = NULL;\n\t\t\t} else {\n\t\t\t\t \n\n\t\t\t\tconversion_table =\n\t\t\t\t    acpi_gbl_convert_resource_serial_bus_dispatch\n\t\t\t\t    [resource->data.common_serial_bus.type];\n\t\t\t}\n\t\t} else {\n\t\t\tconversion_table =\n\t\t\t    acpi_gbl_set_resource_dispatch[resource->type];\n\t\t}\n\n\t\tif (!conversion_table) {\n\t\t\tACPI_ERROR((AE_INFO,\n\t\t\t\t    \"Invalid/unsupported resource descriptor: Type 0x%2.2X\",\n\t\t\t\t    resource->type));\n\t\t\treturn_ACPI_STATUS(AE_AML_INVALID_RESOURCE_TYPE);\n\t\t}\n\n\t\tstatus = acpi_rs_convert_resource_to_aml(resource,\n\t\t\t\t\t\t         ACPI_CAST_PTR(union\n\t\t\t\t\t\t\t\t       aml_resource,\n\t\t\t\t\t\t\t\t       aml),\n\t\t\t\t\t\t\t conversion_table);\n\t\tif (ACPI_FAILURE(status)) {\n\t\t\tACPI_EXCEPTION((AE_INFO, status,\n\t\t\t\t\t\"Could not convert resource (type 0x%X) to AML\",\n\t\t\t\t\tresource->type));\n\t\t\treturn_ACPI_STATUS(status);\n\t\t}\n\n\t\t \n\n\t\tstatus =\n\t\t    acpi_ut_validate_resource(NULL,\n\t\t\t\t\t      ACPI_CAST_PTR(union aml_resource,\n\t\t\t\t\t\t\t    aml), NULL);\n\t\tif (ACPI_FAILURE(status)) {\n\t\t\treturn_ACPI_STATUS(status);\n\t\t}\n\n\t\t \n\n\t\tif (resource->type == ACPI_RESOURCE_TYPE_END_TAG) {\n\n\t\t\t \n\n\t\t\treturn_ACPI_STATUS(AE_OK);\n\t\t}\n\n\t\t \n\t\taml += acpi_ut_get_descriptor_length(aml);\n\n\t\t \n\n\t\tresource = ACPI_NEXT_RESOURCE(resource);\n\t}\n\n\t \n\n\treturn_ACPI_STATUS(AE_AML_NO_RESOURCE_END_TAG);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}