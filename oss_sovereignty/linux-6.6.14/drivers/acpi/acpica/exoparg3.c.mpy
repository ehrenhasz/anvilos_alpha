{
  "module_name": "exoparg3.c",
  "hash_id": "38e3cce68db3d36ad8ab40e9936d2f7eb6182dd45e687bbb767e7869e7782b51",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/exoparg3.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acinterp.h\"\n#include \"acparser.h\"\n#include \"amlcode.h\"\n\n#define _COMPONENT          ACPI_EXECUTER\nACPI_MODULE_NAME(\"exoparg3\")\n\n \n \nacpi_status acpi_ex_opcode_3A_0T_0R(struct acpi_walk_state *walk_state)\n{\n\tunion acpi_operand_object **operand = &walk_state->operands[0];\n\tstruct acpi_signal_fatal_info *fatal;\n\tacpi_status status = AE_OK;\n\n\tACPI_FUNCTION_TRACE_STR(ex_opcode_3A_0T_0R,\n\t\t\t\tacpi_ps_get_opcode_name(walk_state->opcode));\n\n\tswitch (walk_state->opcode) {\n\tcase AML_FATAL_OP:\t \n\n\t\tACPI_DEBUG_PRINT((ACPI_DB_INFO,\n\t\t\t\t  \"FatalOp: Type %X Code %X Arg %X \"\n\t\t\t\t  \"<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\\n\",\n\t\t\t\t  (u32)operand[0]->integer.value,\n\t\t\t\t  (u32)operand[1]->integer.value,\n\t\t\t\t  (u32)operand[2]->integer.value));\n\n\t\tfatal = ACPI_ALLOCATE(sizeof(struct acpi_signal_fatal_info));\n\t\tif (fatal) {\n\t\t\tfatal->type = (u32) operand[0]->integer.value;\n\t\t\tfatal->code = (u32) operand[1]->integer.value;\n\t\t\tfatal->argument = (u32) operand[2]->integer.value;\n\t\t}\n\n\t\t \n\n\t\tstatus = acpi_os_signal(ACPI_SIGNAL_FATAL, fatal);\n\n\t\t \n\n\t\tACPI_FREE(fatal);\n\t\tgoto cleanup;\n\n\tcase AML_EXTERNAL_OP:\n\t\t \n\t\tACPI_ERROR((AE_INFO, \"Executed External Op\"));\n\t\tstatus = AE_OK;\n\t\tgoto cleanup;\n\n\tdefault:\n\n\t\tACPI_ERROR((AE_INFO, \"Unknown AML opcode 0x%X\",\n\t\t\t    walk_state->opcode));\n\n\t\tstatus = AE_AML_BAD_OPCODE;\n\t\tgoto cleanup;\n\t}\n\ncleanup:\n\n\treturn_ACPI_STATUS(status);\n}\n\n \n\nacpi_status acpi_ex_opcode_3A_1T_1R(struct acpi_walk_state *walk_state)\n{\n\tunion acpi_operand_object **operand = &walk_state->operands[0];\n\tunion acpi_operand_object *return_desc = NULL;\n\tchar *buffer = NULL;\n\tacpi_status status = AE_OK;\n\tu64 index;\n\tacpi_size length;\n\n\tACPI_FUNCTION_TRACE_STR(ex_opcode_3A_1T_1R,\n\t\t\t\tacpi_ps_get_opcode_name(walk_state->opcode));\n\n\tswitch (walk_state->opcode) {\n\tcase AML_MID_OP:\t \n\t\t \n\t\treturn_desc = acpi_ut_create_internal_object((operand[0])->\n\t\t\t\t\t\t\t     common.type);\n\t\tif (!return_desc) {\n\t\t\tstatus = AE_NO_MEMORY;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\t \n\n\t\tindex = operand[1]->integer.value;\n\t\tlength = (acpi_size)operand[2]->integer.value;\n\n\t\t \n\t\tif (index >= operand[0]->string.length) {\n\t\t\tlength = 0;\n\t\t}\n\n\t\t \n\n\t\telse if ((index + length) > operand[0]->string.length) {\n\t\t\tlength =\n\t\t\t    (acpi_size)operand[0]->string.length -\n\t\t\t    (acpi_size)index;\n\t\t}\n\n\t\t \n\n\t\tswitch ((operand[0])->common.type) {\n\t\tcase ACPI_TYPE_STRING:\n\n\t\t\t \n\n\t\t\tbuffer = ACPI_ALLOCATE_ZEROED((acpi_size)length + 1);\n\t\t\tif (!buffer) {\n\t\t\t\tstatus = AE_NO_MEMORY;\n\t\t\t\tgoto cleanup;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase ACPI_TYPE_BUFFER:\n\n\t\t\t \n\n\t\t\tif (length > 0) {\n\n\t\t\t\t \n\n\t\t\t\tbuffer = ACPI_ALLOCATE_ZEROED(length);\n\t\t\t\tif (!buffer) {\n\t\t\t\t\tstatus = AE_NO_MEMORY;\n\t\t\t\t\tgoto cleanup;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\t \n\n\t\t\tstatus = AE_AML_OPERAND_TYPE;\n\t\t\tgoto cleanup;\n\t\t}\n\n\t\tif (buffer) {\n\n\t\t\t \n\n\t\t\tmemcpy(buffer,\n\t\t\t       operand[0]->string.pointer + index, length);\n\t\t}\n\n\t\t \n\n\t\treturn_desc->string.pointer = buffer;\n\t\treturn_desc->string.length = (u32) length;\n\n\t\t \n\n\t\treturn_desc->buffer.flags |= AOPOBJ_DATA_VALID;\n\t\tbreak;\n\n\tdefault:\n\n\t\tACPI_ERROR((AE_INFO, \"Unknown AML opcode 0x%X\",\n\t\t\t    walk_state->opcode));\n\n\t\tstatus = AE_AML_BAD_OPCODE;\n\t\tgoto cleanup;\n\t}\n\n\t \n\n\tstatus = acpi_ex_store(return_desc, operand[3], walk_state);\n\ncleanup:\n\n\t \n\n\tif (ACPI_FAILURE(status) || walk_state->result_obj) {\n\t\tacpi_ut_remove_reference(return_desc);\n\t\twalk_state->result_obj = NULL;\n\t} else {\n\t\t \n\n\t\twalk_state->result_obj = return_desc;\n\t}\n\n\treturn_ACPI_STATUS(status);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}