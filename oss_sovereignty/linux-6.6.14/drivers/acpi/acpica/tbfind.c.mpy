{
  "module_name": "tbfind.c",
  "hash_id": "edf1b14f278c9696f20c191d23866d3e916bd7b656a8899423c82427bb6dbe63",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/tbfind.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"actables.h\"\n\n#define _COMPONENT          ACPI_TABLES\nACPI_MODULE_NAME(\"tbfind\")\n\n \nacpi_status\nacpi_tb_find_table(char *signature,\n\t\t   char *oem_id, char *oem_table_id, u32 *table_index)\n{\n\tacpi_status status = AE_OK;\n\tstruct acpi_table_header header;\n\tu32 i;\n\n\tACPI_FUNCTION_TRACE(tb_find_table);\n\n\t \n\n\tif (!acpi_ut_valid_nameseg(signature)) {\n\t\treturn_ACPI_STATUS(AE_BAD_SIGNATURE);\n\t}\n\n\t \n\n\tif ((strlen(oem_id) > ACPI_OEM_ID_SIZE) ||\n\t    (strlen(oem_table_id) > ACPI_OEM_TABLE_ID_SIZE)) {\n\t\treturn_ACPI_STATUS(AE_AML_STRING_LIMIT);\n\t}\n\n\t \n\n\tmemset(&header, 0, sizeof(struct acpi_table_header));\n\tACPI_COPY_NAMESEG(header.signature, signature);\n\tstrncpy(header.oem_id, oem_id, ACPI_OEM_ID_SIZE);\n\tstrncpy(header.oem_table_id, oem_table_id, ACPI_OEM_TABLE_ID_SIZE);\n\n\t \n\n\t(void)acpi_ut_acquire_mutex(ACPI_MTX_TABLES);\n\tfor (i = 0; i < acpi_gbl_root_table_list.current_table_count; ++i) {\n\t\tif (memcmp(&(acpi_gbl_root_table_list.tables[i].signature),\n\t\t\t   header.signature, ACPI_NAMESEG_SIZE)) {\n\n\t\t\t \n\n\t\t\tcontinue;\n\t\t}\n\n\t\t \n\n\t\tif (!acpi_gbl_root_table_list.tables[i].pointer) {\n\n\t\t\t \n\n\t\t\tstatus =\n\t\t\t    acpi_tb_validate_table(&acpi_gbl_root_table_list.\n\t\t\t\t\t\t   tables[i]);\n\t\t\tif (ACPI_FAILURE(status)) {\n\t\t\t\tgoto unlock_and_exit;\n\t\t\t}\n\n\t\t\tif (!acpi_gbl_root_table_list.tables[i].pointer) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t \n\n\t\tif (!memcmp\n\t\t    (acpi_gbl_root_table_list.tables[i].pointer->signature,\n\t\t     header.signature, ACPI_NAMESEG_SIZE) && (!oem_id[0]\n\t\t\t\t\t\t\t      ||\n\t\t\t\t\t\t\t      !memcmp\n\t\t\t\t\t\t\t      (acpi_gbl_root_table_list.\n\t\t\t\t\t\t\t       tables[i].\n\t\t\t\t\t\t\t       pointer->oem_id,\n\t\t\t\t\t\t\t       header.oem_id,\n\t\t\t\t\t\t\t       ACPI_OEM_ID_SIZE))\n\t\t    && (!oem_table_id[0]\n\t\t\t|| !memcmp(acpi_gbl_root_table_list.tables[i].pointer->\n\t\t\t\t   oem_table_id, header.oem_table_id,\n\t\t\t\t   ACPI_OEM_TABLE_ID_SIZE))) {\n\t\t\t*table_index = i;\n\n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_TABLES,\n\t\t\t\t\t  \"Found table [%4.4s]\\n\",\n\t\t\t\t\t  header.signature));\n\t\t\tgoto unlock_and_exit;\n\t\t}\n\t}\n\tstatus = AE_NOT_FOUND;\n\nunlock_and_exit:\n\t(void)acpi_ut_release_mutex(ACPI_MTX_TABLES);\n\treturn_ACPI_STATUS(status);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}