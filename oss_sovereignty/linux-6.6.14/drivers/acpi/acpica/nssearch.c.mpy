{
  "module_name": "nssearch.c",
  "hash_id": "066c26214d73b9fe1f58f47ac6b09cb4d66d6bf5b6a0d614839999dfba54c6ef",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/acpica/nssearch.c",
  "human_readable_source": "\n \n\n#include <acpi/acpi.h>\n#include \"accommon.h\"\n#include \"acnamesp.h\"\n\n#ifdef ACPI_ASL_COMPILER\n#include \"amlcode.h\"\n#endif\n\n#define _COMPONENT          ACPI_NAMESPACE\nACPI_MODULE_NAME(\"nssearch\")\n\n \nstatic acpi_status\nacpi_ns_search_parent_tree(u32 target_name,\n\t\t\t   struct acpi_namespace_node *node,\n\t\t\t   acpi_object_type type,\n\t\t\t   struct acpi_namespace_node **return_node);\n\n \n\nacpi_status\nacpi_ns_search_one_scope(u32 target_name,\n\t\t\t struct acpi_namespace_node *parent_node,\n\t\t\t acpi_object_type type,\n\t\t\t struct acpi_namespace_node **return_node)\n{\n\tstruct acpi_namespace_node *node;\n\n\tACPI_FUNCTION_TRACE(ns_search_one_scope);\n\n#ifdef ACPI_DEBUG_OUTPUT\n\tif (ACPI_LV_NAMES & acpi_dbg_level) {\n\t\tchar *scope_name;\n\n\t\tscope_name = acpi_ns_get_normalized_pathname(parent_node, TRUE);\n\t\tif (scope_name) {\n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t\t\t  \"Searching %s (%p) For [%4.4s] (%s)\\n\",\n\t\t\t\t\t  scope_name, parent_node,\n\t\t\t\t\t  ACPI_CAST_PTR(char, &target_name),\n\t\t\t\t\t  acpi_ut_get_type_name(type)));\n\n\t\t\tACPI_FREE(scope_name);\n\t\t}\n\t}\n#endif\n\n\t \n\tnode = parent_node->child;\n\twhile (node) {\n\n\t\t \n\n\t\tif (node->name.integer == target_name) {\n\n\t\t\t \n\n\t\t\tif (acpi_ns_get_type(node) ==\n\t\t\t    ACPI_TYPE_LOCAL_METHOD_ALIAS) {\n\t\t\t\tnode =\n\t\t\t\t    ACPI_CAST_PTR(struct acpi_namespace_node,\n\t\t\t\t\t\t  node->object);\n\t\t\t}\n\n\t\t\t \n\n\t\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t\t\t  \"Name [%4.4s] (%s) %p found in scope [%4.4s] %p\\n\",\n\t\t\t\t\t  ACPI_CAST_PTR(char, &target_name),\n\t\t\t\t\t  acpi_ut_get_type_name(node->type),\n\t\t\t\t\t  node,\n\t\t\t\t\t  acpi_ut_get_node_name(parent_node),\n\t\t\t\t\t  parent_node));\n\n\t\t\t*return_node = node;\n\t\t\treturn_ACPI_STATUS(AE_OK);\n\t\t}\n\n\t\t \n\n\t\tnode = node->peer;\n\t}\n\n\t \n\n\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t  \"Name [%4.4s] (%s) not found in search in scope [%4.4s] \"\n\t\t\t  \"%p first child %p\\n\",\n\t\t\t  ACPI_CAST_PTR(char, &target_name),\n\t\t\t  acpi_ut_get_type_name(type),\n\t\t\t  acpi_ut_get_node_name(parent_node), parent_node,\n\t\t\t  parent_node->child));\n\n\treturn_ACPI_STATUS(AE_NOT_FOUND);\n}\n\n \n\nstatic acpi_status\nacpi_ns_search_parent_tree(u32 target_name,\n\t\t\t   struct acpi_namespace_node *node,\n\t\t\t   acpi_object_type type,\n\t\t\t   struct acpi_namespace_node **return_node)\n{\n\tacpi_status status;\n\tstruct acpi_namespace_node *parent_node;\n\n\tACPI_FUNCTION_TRACE(ns_search_parent_tree);\n\n\tparent_node = node->parent;\n\n\t \n\tif (!parent_node) {\n\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES, \"[%4.4s] has no parent\\n\",\n\t\t\t\t  ACPI_CAST_PTR(char, &target_name)));\n\t\treturn_ACPI_STATUS(AE_NOT_FOUND);\n\t}\n\n\tif (acpi_ns_local(type)) {\n\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t\t  \"[%4.4s] type [%s] must be local to this scope (no parent search)\\n\",\n\t\t\t\t  ACPI_CAST_PTR(char, &target_name),\n\t\t\t\t  acpi_ut_get_type_name(type)));\n\t\treturn_ACPI_STATUS(AE_NOT_FOUND);\n\t}\n\n\t \n\n\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t  \"Searching parent [%4.4s] for [%4.4s]\\n\",\n\t\t\t  acpi_ut_get_node_name(parent_node),\n\t\t\t  ACPI_CAST_PTR(char, &target_name)));\n\n\t \n\n\twhile (parent_node) {\n\t\t \n\t\tstatus =\n\t\t    acpi_ns_search_one_scope(target_name, parent_node,\n\t\t\t\t\t     ACPI_TYPE_ANY, return_node);\n\t\tif (ACPI_SUCCESS(status)) {\n\t\t\treturn_ACPI_STATUS(status);\n\t\t}\n\n\t\t \n\n\t\tparent_node = parent_node->parent;\n\t}\n\n\t \n\n\treturn_ACPI_STATUS(AE_NOT_FOUND);\n}\n\n \n\nacpi_status\nacpi_ns_search_and_enter(u32 target_name,\n\t\t\t struct acpi_walk_state *walk_state,\n\t\t\t struct acpi_namespace_node *node,\n\t\t\t acpi_interpreter_mode interpreter_mode,\n\t\t\t acpi_object_type type,\n\t\t\t u32 flags, struct acpi_namespace_node **return_node)\n{\n\tacpi_status status;\n\tstruct acpi_namespace_node *new_node;\n\n\tACPI_FUNCTION_TRACE(ns_search_and_enter);\n\n\t \n\n\tif (!node || !target_name || !return_node) {\n\t\tACPI_ERROR((AE_INFO,\n\t\t\t    \"Null parameter: Node %p Name 0x%X ReturnNode %p\",\n\t\t\t    node, target_name, return_node));\n\t\treturn_ACPI_STATUS(AE_BAD_PARAMETER);\n\t}\n\n\t \n\tacpi_ut_repair_name(ACPI_CAST_PTR(char, &target_name));\n\n\t \n\n\t*return_node = ACPI_ENTRY_NOT_FOUND;\n\tstatus = acpi_ns_search_one_scope(target_name, node, type, return_node);\n\tif (status != AE_NOT_FOUND) {\n\t\t \n\t\tif (status == AE_OK) {\n\n\t\t\t \n\n\t\t\t \n\t\t\tif (flags & ACPI_NS_OVERRIDE_IF_FOUND) {\n\t\t\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t\t\t\t  \"Namespace override: %4.4s pass %u type %X Owner %X\\n\",\n\t\t\t\t\t\t  ACPI_CAST_PTR(char,\n\t\t\t\t\t\t\t\t&target_name),\n\t\t\t\t\t\t  interpreter_mode,\n\t\t\t\t\t\t  (*return_node)->type,\n\t\t\t\t\t\t  walk_state->owner_id));\n\n\t\t\t\tacpi_ns_delete_children(*return_node);\n\t\t\t\tif (acpi_gbl_runtime_namespace_override) {\n\t\t\t\t\tacpi_ut_remove_reference((*return_node)->object);\n\t\t\t\t\t(*return_node)->object = NULL;\n\t\t\t\t\t(*return_node)->owner_id =\n\t\t\t\t\t    walk_state->owner_id;\n\t\t\t\t} else {\n\t\t\t\t\tacpi_ns_remove_node(*return_node);\n\t\t\t\t\t*return_node = ACPI_ENTRY_NOT_FOUND;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t \n\n\t\t\telse if (flags & ACPI_NS_ERROR_IF_FOUND) {\n\t\t\t\tstatus = AE_ALREADY_EXISTS;\n\t\t\t}\n\t\t}\n#ifdef ACPI_ASL_COMPILER\n\t\tif (*return_node && (*return_node)->type == ACPI_TYPE_ANY) {\n\t\t\t(*return_node)->flags |= ANOBJ_IS_EXTERNAL;\n\t\t}\n#endif\n\n\t\t \n\n\t\treturn_ACPI_STATUS(status);\n\t}\n\n\t \n\tif ((interpreter_mode != ACPI_IMODE_LOAD_PASS1) &&\n\t    (flags & ACPI_NS_SEARCH_PARENT)) {\n\t\t \n\t\tstatus =\n\t\t    acpi_ns_search_parent_tree(target_name, node, type,\n\t\t\t\t\t       return_node);\n\t\tif (ACPI_SUCCESS(status)) {\n\t\t\treturn_ACPI_STATUS(status);\n\t\t}\n\t}\n\n\t \n\n\tif (interpreter_mode == ACPI_IMODE_EXECUTE) {\n\t\tACPI_DEBUG_PRINT((ACPI_DB_NAMES,\n\t\t\t\t  \"%4.4s Not found in %p [Not adding]\\n\",\n\t\t\t\t  ACPI_CAST_PTR(char, &target_name), node));\n\n\t\treturn_ACPI_STATUS(AE_NOT_FOUND);\n\t}\n\n\t \n\n\tnew_node = acpi_ns_create_node(target_name);\n\tif (!new_node) {\n\t\treturn_ACPI_STATUS(AE_NO_MEMORY);\n\t}\n#ifdef ACPI_ASL_COMPILER\n\n\t \n\n\tif (flags & ACPI_NS_EXTERNAL ||\n\t    (walk_state && walk_state->opcode == AML_SCOPE_OP)) {\n\t\tnew_node->flags |= ANOBJ_IS_EXTERNAL;\n\t}\n#endif\n\n\tif (flags & ACPI_NS_TEMPORARY) {\n\t\tnew_node->flags |= ANOBJ_TEMPORARY;\n\t}\n\n\t \n\n\tacpi_ns_install_node(walk_state, node, new_node, type);\n\t*return_node = new_node;\n\treturn_ACPI_STATUS(AE_OK);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}