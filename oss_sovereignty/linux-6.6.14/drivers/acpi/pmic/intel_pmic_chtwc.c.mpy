{
  "module_name": "intel_pmic_chtwc.c",
  "hash_id": "03df9b8b612480e3083a4b40b7ff0e1178c61786698a8dcb6bf1cee95a473ed9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/acpi/pmic/intel_pmic_chtwc.c",
  "human_readable_source": "\n \n\n#include <linux/acpi.h>\n#include <linux/init.h>\n#include <linux/mfd/intel_soc_pmic.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n#include \"intel_pmic.h\"\n\n#define CHT_WC_V1P05A_CTRL\t\t0x6e3b\n#define CHT_WC_V1P15_CTRL\t\t0x6e3c\n#define CHT_WC_V1P05A_VSEL\t\t0x6e3d\n#define CHT_WC_V1P15_VSEL\t\t0x6e3e\n#define CHT_WC_V1P8A_CTRL\t\t0x6e56\n#define CHT_WC_V1P8SX_CTRL\t\t0x6e57\n#define CHT_WC_VDDQ_CTRL\t\t0x6e58\n#define CHT_WC_V1P2A_CTRL\t\t0x6e59\n#define CHT_WC_V1P2SX_CTRL\t\t0x6e5a\n#define CHT_WC_V1P8A_VSEL\t\t0x6e5b\n#define CHT_WC_VDDQ_VSEL\t\t0x6e5c\n#define CHT_WC_V2P8SX_CTRL\t\t0x6e5d\n#define CHT_WC_V3P3A_CTRL\t\t0x6e5e\n#define CHT_WC_V3P3SD_CTRL\t\t0x6e5f\n#define CHT_WC_VSDIO_CTRL\t\t0x6e67\n#define CHT_WC_V3P3A_VSEL\t\t0x6e68\n#define CHT_WC_VPROG1A_CTRL\t\t0x6e90\n#define CHT_WC_VPROG1B_CTRL\t\t0x6e91\n#define CHT_WC_VPROG1F_CTRL\t\t0x6e95\n#define CHT_WC_VPROG2D_CTRL\t\t0x6e99\n#define CHT_WC_VPROG3A_CTRL\t\t0x6e9a\n#define CHT_WC_VPROG3B_CTRL\t\t0x6e9b\n#define CHT_WC_VPROG4A_CTRL\t\t0x6e9c\n#define CHT_WC_VPROG4B_CTRL\t\t0x6e9d\n#define CHT_WC_VPROG4C_CTRL\t\t0x6e9e\n#define CHT_WC_VPROG4D_CTRL\t\t0x6e9f\n#define CHT_WC_VPROG5A_CTRL\t\t0x6ea0\n#define CHT_WC_VPROG5B_CTRL\t\t0x6ea1\n#define CHT_WC_VPROG6A_CTRL\t\t0x6ea2\n#define CHT_WC_VPROG6B_CTRL\t\t0x6ea3\n#define CHT_WC_VPROG1A_VSEL\t\t0x6ec0\n#define CHT_WC_VPROG1B_VSEL\t\t0x6ec1\n#define CHT_WC_V1P8SX_VSEL\t\t0x6ec2\n#define CHT_WC_V1P2SX_VSEL\t\t0x6ec3\n#define CHT_WC_V1P2A_VSEL\t\t0x6ec4\n#define CHT_WC_VPROG1F_VSEL\t\t0x6ec5\n#define CHT_WC_VSDIO_VSEL\t\t0x6ec6\n#define CHT_WC_V2P8SX_VSEL\t\t0x6ec7\n#define CHT_WC_V3P3SD_VSEL\t\t0x6ec8\n#define CHT_WC_VPROG2D_VSEL\t\t0x6ec9\n#define CHT_WC_VPROG3A_VSEL\t\t0x6eca\n#define CHT_WC_VPROG3B_VSEL\t\t0x6ecb\n#define CHT_WC_VPROG4A_VSEL\t\t0x6ecc\n#define CHT_WC_VPROG4B_VSEL\t\t0x6ecd\n#define CHT_WC_VPROG4C_VSEL\t\t0x6ece\n#define CHT_WC_VPROG4D_VSEL\t\t0x6ecf\n#define CHT_WC_VPROG5A_VSEL\t\t0x6ed0\n#define CHT_WC_VPROG5B_VSEL\t\t0x6ed1\n#define CHT_WC_VPROG6A_VSEL\t\t0x6ed2\n#define CHT_WC_VPROG6B_VSEL\t\t0x6ed3\n\n \nstatic struct pmic_table power_table[] = {\n\t{\n\t\t.address = 0x0,\n\t\t.reg = CHT_WC_V1P8A_CTRL,\n\t\t.bit = 0x01,\n\t},  \n\t{\n\t\t.address = 0x04,\n\t\t.reg = CHT_WC_V1P8SX_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x08,\n\t\t.reg = CHT_WC_VDDQ_CTRL,\n\t\t.bit = 0x01,\n\t},  \n\t{\n\t\t.address = 0x0c,\n\t\t.reg = CHT_WC_V1P2A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x10,\n\t\t.reg = CHT_WC_V1P2SX_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x14,\n\t\t.reg = CHT_WC_V2P8SX_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x18,\n\t\t.reg = CHT_WC_V3P3A_CTRL,\n\t\t.bit = 0x01,\n\t},  \n\t{\n\t\t.address = 0x1c,\n\t\t.reg = CHT_WC_V3P3SD_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x20,\n\t\t.reg = CHT_WC_VSDIO_CTRL,\n\t\t.bit = 0x07,\n\t},  \n \n \n \n \n\t{\n\t\t.address = 0x34,\n\t\t.reg = CHT_WC_VPROG1A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x38,\n\t\t.reg = CHT_WC_VPROG1B_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x3c,\n\t\t.reg = CHT_WC_VPROG1F_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x40,\n\t\t.reg = CHT_WC_VPROG2D_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x44,\n\t\t.reg = CHT_WC_VPROG3A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x48,\n\t\t.reg = CHT_WC_VPROG3B_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x4c,\n\t\t.reg = CHT_WC_VPROG4A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x50,\n\t\t.reg = CHT_WC_VPROG4B_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x54,\n\t\t.reg = CHT_WC_VPROG4C_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x58,\n\t\t.reg = CHT_WC_VPROG4D_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x5c,\n\t\t.reg = CHT_WC_VPROG5A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x60,\n\t\t.reg = CHT_WC_VPROG5B_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x64,\n\t\t.reg = CHT_WC_VPROG6A_CTRL,\n\t\t.bit = 0x07,\n\t},  \n\t{\n\t\t.address = 0x68,\n\t\t.reg = CHT_WC_VPROG6B_CTRL,\n\t\t.bit = 0x07,\n\t},  \n \n};\n\nstatic int intel_cht_wc_pmic_get_power(struct regmap *regmap, int reg,\n\t\tint bit, u64 *value)\n{\n\tint data;\n\n\tif (regmap_read(regmap, reg, &data))\n\t\treturn -EIO;\n\n\t*value = (data & bit) ? 1 : 0;\n\treturn 0;\n}\n\nstatic int intel_cht_wc_pmic_update_power(struct regmap *regmap, int reg,\n\t\tint bitmask, bool on)\n{\n\treturn regmap_update_bits(regmap, reg, bitmask, on ? 1 : 0);\n}\n\nstatic int intel_cht_wc_exec_mipi_pmic_seq_element(struct regmap *regmap,\n\t\t\t\t\t\t   u16 i2c_client_address,\n\t\t\t\t\t\t   u32 reg_address,\n\t\t\t\t\t\t   u32 value, u32 mask)\n{\n\tu32 address;\n\n\tif (i2c_client_address > 0xff || reg_address > 0xff) {\n\t\tpr_warn(\"%s warning addresses too big client 0x%x reg 0x%x\\n\",\n\t\t\t__func__, i2c_client_address, reg_address);\n\t\treturn -ERANGE;\n\t}\n\n\taddress = (i2c_client_address << 8) | reg_address;\n\n\treturn regmap_update_bits(regmap, address, mask, value);\n}\n\n \nstatic const struct intel_pmic_opregion_data intel_cht_wc_pmic_opregion_data = {\n\t.get_power\t\t= intel_cht_wc_pmic_get_power,\n\t.update_power\t\t= intel_cht_wc_pmic_update_power,\n\t.exec_mipi_pmic_seq_element = intel_cht_wc_exec_mipi_pmic_seq_element,\n\t.lpat_raw_to_temp\t= acpi_lpat_raw_to_temp,\n\t.power_table\t\t= power_table,\n\t.power_table_count\t= ARRAY_SIZE(power_table),\n};\n\nstatic int intel_cht_wc_pmic_opregion_probe(struct platform_device *pdev)\n{\n\tstruct intel_soc_pmic *pmic = dev_get_drvdata(pdev->dev.parent);\n\n\treturn intel_pmic_install_opregion_handler(&pdev->dev,\n\t\t\tACPI_HANDLE(pdev->dev.parent),\n\t\t\tpmic->regmap,\n\t\t\t&intel_cht_wc_pmic_opregion_data);\n}\n\nstatic const struct platform_device_id cht_wc_opregion_id_table[] = {\n\t{ .name = \"cht_wcove_region\" },\n\t{},\n};\n\nstatic struct platform_driver intel_cht_wc_pmic_opregion_driver = {\n\t.probe = intel_cht_wc_pmic_opregion_probe,\n\t.driver = {\n\t\t.name = \"cht_whiskey_cove_pmic\",\n\t},\n\t.id_table = cht_wc_opregion_id_table,\n};\nbuiltin_platform_driver(intel_cht_wc_pmic_opregion_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}