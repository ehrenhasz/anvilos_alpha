{
  "module_name": "firmware.h",
  "hash_id": "29cb17f79714f52e8f551de7dc187a5c4864337b62f51dbc6f91db5440995390",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nfc/s3fwrn5/firmware.h",
  "human_readable_source": " \n \n\n#ifndef __LOCAL_S3FWRN5_FIRMWARE_H_\n#define __LOCAL_S3FWRN5_FIRMWARE_H_\n\n \n#define S3FWRN5_FW_MSG_CMD\t\t\t0x00\n#define S3FWRN5_FW_MSG_RSP\t\t\t0x01\n#define S3FWRN5_FW_MSG_DATA\t\t\t0x02\n\n \n#define S3FWRN5_FW_RET_SUCCESS\t\t\t0x00\n#define S3FWRN5_FW_RET_MESSAGE_TYPE_INVALID\t0x01\n#define S3FWRN5_FW_RET_COMMAND_INVALID\t\t0x02\n#define S3FWRN5_FW_RET_PAGE_DATA_OVERFLOW\t0x03\n#define S3FWRN5_FW_RET_SECT_DATA_OVERFLOW\t0x04\n#define S3FWRN5_FW_RET_AUTHENTICATION_FAIL\t0x05\n#define S3FWRN5_FW_RET_FLASH_OPERATION_FAIL\t0x06\n#define S3FWRN5_FW_RET_ADDRESS_OUT_OF_RANGE\t0x07\n#define S3FWRN5_FW_RET_PARAMETER_INVALID\t0x08\n\n \n#define S3FWRN5_FW_HDR_SIZE 4\n\nstruct s3fwrn5_fw_header {\n\t__u8 type;\n\t__u8 code;\n\t__u16 len;\n};\n\n#define S3FWRN5_FW_CMD_RESET\t\t\t0x00\n\n#define S3FWRN5_FW_CMD_GET_BOOTINFO\t\t0x01\n\nstruct s3fwrn5_fw_cmd_get_bootinfo_rsp {\n\t__u8 hw_version[4];\n\t__u16 sector_size;\n\t__u16 page_size;\n\t__u16 frame_max_size;\n\t__u16 hw_buffer_size;\n};\n\n#define S3FWRN5_FW_CMD_ENTER_UPDATE_MODE\t0x02\n\nstruct s3fwrn5_fw_cmd_enter_updatemode {\n\t__u16 hashcode_size;\n\t__u16 signature_size;\n};\n\n#define S3FWRN5_FW_CMD_UPDATE_SECTOR\t\t0x04\n\nstruct s3fwrn5_fw_cmd_update_sector {\n\t__u32 base_address;\n};\n\n#define S3FWRN5_FW_CMD_COMPLETE_UPDATE_MODE\t0x05\n\nstruct s3fwrn5_fw_image {\n\tconst struct firmware *fw;\n\n\tchar date[13];\n\tu32 version;\n\tconst void *sig;\n\tu32 sig_size;\n\tconst void *image;\n\tu32 image_sectors;\n\tconst void *custom_sig;\n\tu32 custom_sig_size;\n};\n\nstruct s3fwrn5_fw_info {\n\tstruct nci_dev *ndev;\n\tstruct s3fwrn5_fw_image fw;\n\tchar fw_name[NFC_FIRMWARE_NAME_MAXSIZE + 1];\n\n\tconst void *sig;\n\tu32 sig_size;\n\tu32 sector_size;\n\tu32 base_addr;\n\n\tstruct completion completion;\n\tstruct sk_buff *rsp;\n\tchar parity;\n};\n\nint s3fwrn5_fw_request_firmware(struct s3fwrn5_fw_info *fw_info);\nvoid s3fwrn5_fw_init(struct s3fwrn5_fw_info *fw_info, const char *fw_name);\nint s3fwrn5_fw_setup(struct s3fwrn5_fw_info *fw_info);\nbool s3fwrn5_fw_check_version(const struct s3fwrn5_fw_info *fw_info, u32 version);\nint s3fwrn5_fw_download(struct s3fwrn5_fw_info *fw_info);\nvoid s3fwrn5_fw_cleanup(struct s3fwrn5_fw_info *fw_info);\n\nint s3fwrn5_fw_recv_frame(struct nci_dev *ndev, struct sk_buff *skb);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}