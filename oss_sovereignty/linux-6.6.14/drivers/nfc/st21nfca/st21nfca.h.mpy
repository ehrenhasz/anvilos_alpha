{
  "module_name": "st21nfca.h",
  "hash_id": "f1e37be9df4114f95cb5d55e08848c64b7e6e987c005b6293a29164d08f329eb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nfc/st21nfca/st21nfca.h",
  "human_readable_source": " \n \n\n#ifndef __LOCAL_ST21NFCA_H_\n#define __LOCAL_ST21NFCA_H_\n\n#include <net/nfc/hci.h>\n#include <linux/skbuff.h>\n#include <linux/workqueue.h>\n\n#define HCI_MODE 0\n\n \n#define ST21NFCA_SOF_EOF_LEN    2\n\n \n#define ST21NFCA_HCI_LLC_LEN    1\n\n \n#define ST21NFCA_HCI_LLC_CRC    4\n\n#define ST21NFCA_HCI_LLC_LEN_CRC        (ST21NFCA_SOF_EOF_LEN + \\\n\t\t\t\t\t\tST21NFCA_HCI_LLC_LEN + \\\n\t\t\t\t\t\tST21NFCA_HCI_LLC_CRC)\n#define ST21NFCA_HCI_LLC_MIN_SIZE       (1 + ST21NFCA_HCI_LLC_LEN_CRC)\n\n \n#define ST21NFCA_HCI_LLC_MAX_PAYLOAD    29\n#define ST21NFCA_HCI_LLC_MAX_SIZE       (ST21NFCA_HCI_LLC_LEN_CRC + 1 + \\\n\t\t\t\t\tST21NFCA_HCI_LLC_MAX_PAYLOAD)\n\n \n#define ST21NFCA_WR_XCHG_DATA           0x10\n\n#define ST21NFCA_DEVICE_MGNT_GATE       0x01\n#define ST21NFCA_RF_READER_F_GATE       0x14\n#define ST21NFCA_RF_CARD_F_GATE\t\t0x24\n#define ST21NFCA_APDU_READER_GATE\t0xf0\n#define ST21NFCA_CONNECTIVITY_GATE\t0x41\n\n \n#define ST21NFCA_ESE_MAX_LENGTH\t\t33\n#define ST21NFCA_ESE_HOST_ID\t\t0xc0\n\n#define DRIVER_DESC \"HCI NFC driver for ST21NFCA\"\n\n#define ST21NFCA_HCI_MODE\t\t0\n#define ST21NFCA_NUM_DEVICES\t\t256\n\n#define ST21NFCA_VENDOR_OUI\t\t0x0080E1  \n#define ST21NFCA_FACTORY_MODE\t\t2\n\nstruct st21nfca_se_status {\n\tbool is_ese_present;\n\tbool is_uicc_present;\n};\n\nenum st21nfca_state {\n\tST21NFCA_ST_COLD,\n\tST21NFCA_ST_READY,\n};\n\n \nenum nfc_vendor_cmds {\n\tFACTORY_MODE,\n\tHCI_CLEAR_ALL_PIPES,\n\tHCI_DM_PUT_DATA,\n\tHCI_DM_UPDATE_AID,\n\tHCI_DM_GET_INFO,\n\tHCI_DM_GET_DATA,\n\tHCI_DM_LOAD,\n\tHCI_DM_RESET,\n\tHCI_GET_PARAM,\n\tHCI_DM_FIELD_GENERATOR,\n\tHCI_LOOPBACK,\n};\n\nstruct st21nfca_vendor_info {\n\tstruct completion req_completion;\n\tstruct sk_buff *rx_skb;\n};\n\nstruct st21nfca_dep_info {\n\tstruct sk_buff *tx_pending;\n\tstruct work_struct tx_work;\n\tu8 curr_nfc_dep_pni;\n\tu32 idx;\n\tu8 to;\n\tu8 did;\n\tu8 bsi;\n\tu8 bri;\n\tu8 lri;\n} __packed;\n\nstruct st21nfca_se_info {\n\tu8 atr[ST21NFCA_ESE_MAX_LENGTH];\n\tstruct completion req_completion;\n\n\tstruct timer_list bwi_timer;\n\tint wt_timeout;  \n\tbool bwi_active;\n\n\tstruct timer_list se_active_timer;\n\tbool se_active;\n\tint expected_pipes;\n\tint count_pipes;\n\n\tbool xch_error;\n\n\tse_io_cb_t cb;\n\tvoid *cb_context;\n\tstruct work_struct timeout_work;\n};\n\nstruct st21nfca_hci_info {\n\tconst struct nfc_phy_ops *phy_ops;\n\tvoid *phy_id;\n\n\tstruct nfc_hci_dev *hdev;\n\tstruct st21nfca_se_status *se_status;\n\n\tenum st21nfca_state state;\n\n\tstruct mutex info_lock;\n\n\tint async_cb_type;\n\tdata_exchange_cb_t async_cb;\n\tvoid *async_cb_context;\n\n\tstruct st21nfca_dep_info dep_info;\n\tstruct st21nfca_se_info se_info;\n\tstruct st21nfca_vendor_info vendor_info;\n};\n\nint st21nfca_hci_probe(void *phy_id, const struct nfc_phy_ops *phy_ops,\n\t\t       char *llc_name, int phy_headroom, int phy_tailroom,\n\t\t       int phy_payload, struct nfc_hci_dev **hdev,\n\t\t       struct st21nfca_se_status *se_status);\nvoid st21nfca_hci_remove(struct nfc_hci_dev *hdev);\n\nint st21nfca_dep_event_received(struct nfc_hci_dev *hdev,\n\t\t\t\tu8 event, struct sk_buff *skb);\nint st21nfca_tm_send_dep_res(struct nfc_hci_dev *hdev, struct sk_buff *skb);\n\nint st21nfca_im_send_atr_req(struct nfc_hci_dev *hdev, u8 *gb, size_t gb_len);\nint st21nfca_im_send_dep_req(struct nfc_hci_dev *hdev, struct sk_buff *skb);\nvoid st21nfca_dep_init(struct nfc_hci_dev *hdev);\nvoid st21nfca_dep_deinit(struct nfc_hci_dev *hdev);\n\nint st21nfca_connectivity_event_received(struct nfc_hci_dev *hdev, u8 host,\n\t\t\t\t\tu8 event, struct sk_buff *skb);\nint st21nfca_apdu_reader_event_received(struct nfc_hci_dev *hdev,\n\t\t\t\t\tu8 event, struct sk_buff *skb);\n\nint st21nfca_hci_discover_se(struct nfc_hci_dev *hdev);\nint st21nfca_hci_enable_se(struct nfc_hci_dev *hdev, u32 se_idx);\nint st21nfca_hci_disable_se(struct nfc_hci_dev *hdev, u32 se_idx);\nint st21nfca_hci_se_io(struct nfc_hci_dev *hdev, u32 se_idx,\n\t\tu8 *apdu, size_t apdu_length,\n\t\tse_io_cb_t cb, void *cb_context);\n\nvoid st21nfca_se_init(struct nfc_hci_dev *hdev);\nvoid st21nfca_se_deinit(struct nfc_hci_dev *hdev);\n\nint st21nfca_hci_loopback_event_received(struct nfc_hci_dev *ndev, u8 event,\n\t\t\t\t\t struct sk_buff *skb);\nint st21nfca_vendor_cmds_init(struct nfc_hci_dev *ndev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}