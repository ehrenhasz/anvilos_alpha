{
  "module_name": "phy-cadence-sierra.c",
  "hash_id": "dddfd64210c67e82b52d273c53abfb519fb27b953194c7fdd85615e5a0877b1f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/phy/cadence/phy-cadence-sierra.c",
  "human_readable_source": "\n \n#include <linux/clk.h>\n#include <linux/clk-provider.h>\n#include <linux/delay.h>\n#include <linux/err.h>\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/phy/phy.h>\n#include <linux/platform_device.h>\n#include <linux/pm_runtime.h>\n#include <linux/regmap.h>\n#include <linux/reset.h>\n#include <linux/slab.h>\n#include <linux/of.h>\n#include <linux/of_platform.h>\n#include <dt-bindings/phy/phy.h>\n#include <dt-bindings/phy/phy-cadence.h>\n\n#define NUM_SSC_MODE\t\t3\n#define NUM_PHY_TYPE\t\t5\n\n \n#define SIERRA_COMMON_CDB_OFFSET\t\t\t0x0\n#define SIERRA_MACRO_ID_REG\t\t\t\t0x0\n#define SIERRA_CMN_PLLLC_GEN_PREG\t\t\t0x42\n#define SIERRA_CMN_PLLLC_FBDIV_INT_MODE0_PREG\t\t0x43\n#define SIERRA_CMN_PLLLC_DCOCAL_CTRL_PREG\t\t0x45\n#define SIERRA_CMN_PLLLC_INIT_PREG\t\t\t0x46\n#define SIERRA_CMN_PLLLC_ITERTMR_PREG\t\t\t0x47\n#define SIERRA_CMN_PLLLC_MODE_PREG\t\t\t0x48\n#define SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG\t\t0x49\n#define SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG\t\t0x4A\n#define SIERRA_CMN_PLLLC_LOCK_CNTSTART_PREG\t\t0x4B\n#define SIERRA_CMN_PLLLC_LOCKSEARCH_PREG\t\t0x4C\n#define SIERRA_CMN_PLLLC_CLK1_PREG\t\t\t0x4D\n#define SIERRA_CMN_PLLLC_CLK0_PREG\t\t\t0x4E\n#define SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG\t\t0x4F\n#define SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG\t\t0x50\n#define SIERRA_CMN_PLLLC_DSMCORR_PREG\t\t\t0x51\n#define SIERRA_CMN_PLLLC_SS_PREG\t\t\t0x52\n#define SIERRA_CMN_PLLLC_SS_AMP_STEP_SIZE_PREG\t\t0x53\n#define SIERRA_CMN_PLLLC_SSTWOPT_PREG\t\t\t0x54\n#define SIERRA_CMN_PLLCSM_PLLEN_TMR_PREG\t\t0x5D\n#define SIERRA_CMN_PLLCSM_PLLPRE_TMR_PREG\t\t0x5E\n#define SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG\t0x62\n#define SIERRA_CMN_PLLLC_LOCK_DELAY_CTRL_PREG\t\t0x63\n#define SIERRA_SDOSCCAL_CLK_CNT_PREG\t\t\t0x6E\n#define SIERRA_CMN_REFRCV_PREG\t\t\t\t0x98\n#define SIERRA_CMN_RESCAL_CTRLA_PREG\t\t\t0xA0\n#define SIERRA_CMN_REFRCV1_PREG\t\t\t\t0xB8\n#define SIERRA_CMN_PLLLC1_GEN_PREG\t\t\t0xC2\n#define SIERRA_CMN_PLLLC1_FBDIV_INT_PREG\t\t0xC3\n#define SIERRA_CMN_PLLLC1_DCOCAL_CTRL_PREG\t\t0xC5\n#define SIERRA_CMN_PLLLC1_LF_COEFF_MODE0_PREG\t\t0xCA\n#define SIERRA_CMN_PLLLC1_CLK0_PREG\t\t\t0xCE\n#define SIERRA_CMN_PLLLC1_BWCAL_MODE0_PREG\t\t0xD0\n#define SIERRA_CMN_PLLLC1_SS_TIME_STEPSIZE_MODE_PREG\t0xE2\n\n#define SIERRA_LANE_CDB_OFFSET(ln, block_offset, reg_offset)\t\\\n\t\t\t\t((0x4000 << (block_offset)) + \\\n\t\t\t\t (((ln) << 9) << (reg_offset)))\n\n#define SIERRA_DET_STANDEC_A_PREG\t\t\t0x000\n#define SIERRA_DET_STANDEC_B_PREG\t\t\t0x001\n#define SIERRA_DET_STANDEC_C_PREG\t\t\t0x002\n#define SIERRA_DET_STANDEC_D_PREG\t\t\t0x003\n#define SIERRA_DET_STANDEC_E_PREG\t\t\t0x004\n#define SIERRA_PSM_LANECAL_DLY_A1_RESETS_PREG\t\t0x008\n#define SIERRA_PSM_A0IN_TMR_PREG\t\t\t0x009\n#define SIERRA_PSM_A3IN_TMR_PREG\t\t\t0x00C\n#define SIERRA_PSM_DIAG_PREG\t\t\t\t0x015\n#define SIERRA_PSC_LN_A3_PREG\t\t\t\t0x023\n#define SIERRA_PSC_LN_A4_PREG\t\t\t\t0x024\n#define SIERRA_PSC_LN_IDLE_PREG\t\t\t\t0x026\n#define SIERRA_PSC_TX_A0_PREG\t\t\t\t0x028\n#define SIERRA_PSC_TX_A1_PREG\t\t\t\t0x029\n#define SIERRA_PSC_TX_A2_PREG\t\t\t\t0x02A\n#define SIERRA_PSC_TX_A3_PREG\t\t\t\t0x02B\n#define SIERRA_PSC_RX_A0_PREG\t\t\t\t0x030\n#define SIERRA_PSC_RX_A1_PREG\t\t\t\t0x031\n#define SIERRA_PSC_RX_A2_PREG\t\t\t\t0x032\n#define SIERRA_PSC_RX_A3_PREG\t\t\t\t0x033\n#define SIERRA_PLLCTRL_FBDIV_MODE01_PREG\t\t0x039\n#define SIERRA_PLLCTRL_SUBRATE_PREG\t\t\t0x03A\n#define SIERRA_PLLCTRL_GEN_A_PREG\t\t\t0x03B\n#define SIERRA_PLLCTRL_GEN_D_PREG\t\t\t0x03E\n#define SIERRA_PLLCTRL_CPGAIN_MODE_PREG\t\t\t0x03F\n#define SIERRA_PLLCTRL_STATUS_PREG\t\t\t0x044\n#define SIERRA_CLKPATH_BIASTRIM_PREG\t\t\t0x04B\n#define SIERRA_DFE_BIASTRIM_PREG\t\t\t0x04C\n#define SIERRA_DRVCTRL_ATTEN_PREG\t\t\t0x06A\n#define SIERRA_DRVCTRL_BOOST_PREG\t\t\t0x06F\n#define SIERRA_LANE_TX_RECEIVER_DETECT_PREG\t\t0x071\n#define SIERRA_TX_RCVDET_OVRD_PREG\t\t\t0x072\n#define SIERRA_CLKPATHCTRL_TMR_PREG\t\t\t0x081\n#define SIERRA_RX_CREQ_FLTR_A_MODE3_PREG\t\t0x085\n#define SIERRA_RX_CREQ_FLTR_A_MODE2_PREG\t\t0x086\n#define SIERRA_RX_CREQ_FLTR_A_MODE1_PREG\t\t0x087\n#define SIERRA_RX_CREQ_FLTR_A_MODE0_PREG\t\t0x088\n#define SIERRA_CREQ_DCBIASATTEN_OVR_PREG\t\t0x08C\n#define SIERRA_CREQ_CCLKDET_MODE01_PREG\t\t\t0x08E\n#define SIERRA_RX_CTLE_CAL_PREG\t\t\t\t0x08F\n#define SIERRA_RX_CTLE_MAINTENANCE_PREG\t\t\t0x091\n#define SIERRA_CREQ_FSMCLK_SEL_PREG\t\t\t0x092\n#define SIERRA_CREQ_EQ_CTRL_PREG\t\t\t0x093\n#define SIERRA_CREQ_SPARE_PREG\t\t\t\t0x096\n#define SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG\t\t0x097\n#define SIERRA_CTLELUT_CTRL_PREG\t\t\t0x098\n#define SIERRA_DEQ_BLK_TAU_CTRL1_PREG\t\t\t0x0AC\n#define SIERRA_DEQ_BLK_TAU_CTRL4_PREG\t\t\t0x0AF\n#define SIERRA_DFE_ECMP_RATESEL_PREG\t\t\t0x0C0\n#define SIERRA_DFE_SMP_RATESEL_PREG\t\t\t0x0C1\n#define SIERRA_DEQ_PHALIGN_CTRL\t\t\t\t0x0C4\n#define SIERRA_DEQ_CONCUR_CTRL1_PREG\t\t\t0x0C8\n#define SIERRA_DEQ_CONCUR_CTRL2_PREG\t\t\t0x0C9\n#define SIERRA_DEQ_EPIPWR_CTRL2_PREG\t\t\t0x0CD\n#define SIERRA_DEQ_FAST_MAINT_CYCLES_PREG\t\t0x0CE\n#define SIERRA_DEQ_ERRCMP_CTRL_PREG\t\t\t0x0D0\n#define SIERRA_DEQ_OFFSET_CTRL_PREG\t\t\t0x0D8\n#define SIERRA_DEQ_GAIN_CTRL_PREG\t\t\t0x0E0\n#define SIERRA_DEQ_VGATUNE_CTRL_PREG\t\t\t0x0E1\n#define SIERRA_DEQ_GLUT0\t\t\t\t0x0E8\n#define SIERRA_DEQ_GLUT1\t\t\t\t0x0E9\n#define SIERRA_DEQ_GLUT2\t\t\t\t0x0EA\n#define SIERRA_DEQ_GLUT3\t\t\t\t0x0EB\n#define SIERRA_DEQ_GLUT4\t\t\t\t0x0EC\n#define SIERRA_DEQ_GLUT5\t\t\t\t0x0ED\n#define SIERRA_DEQ_GLUT6\t\t\t\t0x0EE\n#define SIERRA_DEQ_GLUT7\t\t\t\t0x0EF\n#define SIERRA_DEQ_GLUT8\t\t\t\t0x0F0\n#define SIERRA_DEQ_GLUT9\t\t\t\t0x0F1\n#define SIERRA_DEQ_GLUT10\t\t\t\t0x0F2\n#define SIERRA_DEQ_GLUT11\t\t\t\t0x0F3\n#define SIERRA_DEQ_GLUT12\t\t\t\t0x0F4\n#define SIERRA_DEQ_GLUT13\t\t\t\t0x0F5\n#define SIERRA_DEQ_GLUT14\t\t\t\t0x0F6\n#define SIERRA_DEQ_GLUT15\t\t\t\t0x0F7\n#define SIERRA_DEQ_GLUT16\t\t\t\t0x0F8\n#define SIERRA_POSTPRECUR_EN_CEPH_CTRL_PREG\t\t0x0F9\n#define SIERRA_TAU_EN_CEPH2TO0_PREG\t\t\t0x0FB\n#define SIERRA_TAU_EN_CEPH5TO3_PREG\t\t\t0x0FC\n#define SIERRA_DEQ_ALUT0\t\t\t\t0x108\n#define SIERRA_DEQ_ALUT1\t\t\t\t0x109\n#define SIERRA_DEQ_ALUT2\t\t\t\t0x10A\n#define SIERRA_DEQ_ALUT3\t\t\t\t0x10B\n#define SIERRA_DEQ_ALUT4\t\t\t\t0x10C\n#define SIERRA_DEQ_ALUT5\t\t\t\t0x10D\n#define SIERRA_DEQ_ALUT6\t\t\t\t0x10E\n#define SIERRA_DEQ_ALUT7\t\t\t\t0x10F\n#define SIERRA_DEQ_ALUT8\t\t\t\t0x110\n#define SIERRA_DEQ_ALUT9\t\t\t\t0x111\n#define SIERRA_DEQ_ALUT10\t\t\t\t0x112\n#define SIERRA_DEQ_ALUT11\t\t\t\t0x113\n#define SIERRA_DEQ_ALUT12\t\t\t\t0x114\n#define SIERRA_DEQ_ALUT13\t\t\t\t0x115\n#define SIERRA_OEPH_EN_CTRL_PREG\t\t\t0x124\n#define SIERRA_DEQ_DFETAP_CTRL_PREG\t\t\t0x128\n#define SIERRA_DEQ_DFETAP0\t\t\t\t0x129\n#define SIERRA_DEQ_DFETAP1\t\t\t\t0x12B\n#define SIERRA_DEQ_DFETAP2\t\t\t\t0x12D\n#define SIERRA_DEQ_DFETAP3\t\t\t\t0x12F\n#define SIERRA_DEQ_DFETAP4\t\t\t\t0x131\n#define SIERRA_DFE_EN_1010_IGNORE_PREG\t\t\t0x134\n#define SIERRA_DEQ_PRECUR_PREG\t\t\t\t0x138\n#define SIERRA_DEQ_POSTCUR_PREG\t\t\t\t0x140\n#define SIERRA_DEQ_POSTCUR_DECR_PREG\t\t\t0x142\n#define SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG\t\t0x150\n#define SIERRA_DEQ_TAU_CTRL2_PREG\t\t\t0x151\n#define SIERRA_DEQ_TAU_CTRL3_PREG\t\t\t0x152\n#define SIERRA_DEQ_OPENEYE_CTRL_PREG\t\t\t0x158\n#define SIERRA_DEQ_CONCUR_EPIOFFSET_MODE_PREG\t\t0x159\n#define SIERRA_DEQ_PICTRL_PREG\t\t\t\t0x161\n#define SIERRA_CPICAL_TMRVAL_MODE1_PREG\t\t\t0x170\n#define SIERRA_CPICAL_TMRVAL_MODE0_PREG\t\t\t0x171\n#define SIERRA_CPICAL_PICNT_MODE1_PREG\t\t\t0x174\n#define SIERRA_CPI_OUTBUF_RATESEL_PREG\t\t\t0x17C\n#define SIERRA_CPI_RESBIAS_BIN_PREG\t\t\t0x17E\n#define SIERRA_CPI_TRIM_PREG\t\t\t\t0x17F\n#define SIERRA_CPICAL_RES_STARTCODE_MODE23_PREG\t\t0x183\n#define SIERRA_CPICAL_RES_STARTCODE_MODE01_PREG\t\t0x184\n#define SIERRA_EPI_CTRL_PREG\t\t\t\t0x187\n#define SIERRA_LFPSDET_SUPPORT_PREG\t\t\t0x188\n#define SIERRA_LFPSFILT_NS_PREG\t\t\t\t0x18A\n#define SIERRA_LFPSFILT_RD_PREG\t\t\t\t0x18B\n#define SIERRA_LFPSFILT_MP_PREG\t\t\t\t0x18C\n#define SIERRA_SIGDET_SUPPORT_PREG\t\t\t0x190\n#define SIERRA_SDFILT_H2L_A_PREG\t\t\t0x191\n#define SIERRA_SDFILT_L2H_PREG\t\t\t\t0x193\n#define SIERRA_RXBUFFER_CTLECTRL_PREG\t\t\t0x19E\n#define SIERRA_RXBUFFER_RCDFECTRL_PREG\t\t\t0x19F\n#define SIERRA_RXBUFFER_DFECTRL_PREG\t\t\t0x1A0\n#define SIERRA_LN_SPARE_REG_PREG\t\t\t0x1B0\n#define SIERRA_DEQ_TAU_CTRL1_FAST_MAINT_PREG\t\t0x14F\n#define SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG\t\t0x150\n\n \n#define SIERRA_PHY_PCS_COMMON_OFFSET(block_offset)\t\\\n\t\t\t\t     (0xc000 << (block_offset))\n#define SIERRA_PHY_PIPE_CMN_CTRL1\t\t\t0x0\n#define SIERRA_PHY_PLL_CFG\t\t\t\t0xe\n\n \n#define SIERRA_PHY_PCS_LANE_CDB_OFFSET(ln, block_offset, reg_offset)\t\\\n\t\t\t\t       ((0xD000 << (block_offset)) +\t\\\n\t\t\t\t       (((ln) << 8) << (reg_offset)))\n\n#define SIERRA_PHY_ISO_LINK_CTRL\t\t\t0xB\n\n \n#define SIERRA_PHY_PMA_COMMON_OFFSET(block_offset)\t\\\n\t\t\t\t     (0xE000 << (block_offset))\n#define SIERRA_PHY_PMA_CMN_CTRL\t\t\t\t0x000\n\n \n#define SIERRA_PHY_PMA_LANE_CDB_OFFSET(ln, block_offset, reg_offset)\t\\\n\t\t\t\t       ((0xF000 << (block_offset)) +\t\\\n\t\t\t\t       (((ln) << 8) << (reg_offset)))\n\n#define SIERRA_PHY_PMA_XCVR_CTRL\t\t\t0x000\n\n#define SIERRA_MACRO_ID\t\t\t\t\t0x00007364\n#define SIERRA_MAX_LANES\t\t\t\t16\n#define PLL_LOCK_TIME\t\t\t\t\t100000\n\n#define CDNS_SIERRA_OUTPUT_CLOCKS\t\t\t3\n#define CDNS_SIERRA_INPUT_CLOCKS\t\t\t3\nenum cdns_sierra_clock_input {\n\tPHY_CLK,\n\tCMN_REFCLK_DIG_DIV,\n\tCMN_REFCLK1_DIG_DIV,\n};\n\n#define SIERRA_NUM_CMN_PLLC\t\t\t\t2\n#define SIERRA_NUM_CMN_PLLC_PARENTS\t\t\t2\n\nstatic const struct reg_field macro_id_type =\n\t\t\t\tREG_FIELD(SIERRA_MACRO_ID_REG, 0, 15);\nstatic const struct reg_field phy_pll_cfg_1 =\n\t\t\t\tREG_FIELD(SIERRA_PHY_PLL_CFG, 1, 1);\nstatic const struct reg_field pma_cmn_ready =\n\t\t\t\tREG_FIELD(SIERRA_PHY_PMA_CMN_CTRL, 0, 0);\nstatic const struct reg_field pllctrl_lock =\n\t\t\t\tREG_FIELD(SIERRA_PLLCTRL_STATUS_PREG, 0, 0);\nstatic const struct reg_field phy_iso_link_ctrl_1 =\n\t\t\t\tREG_FIELD(SIERRA_PHY_ISO_LINK_CTRL, 1, 1);\nstatic const struct reg_field cmn_plllc_clk1outdiv_preg =\n\t\t\t\tREG_FIELD(SIERRA_CMN_PLLLC_CLK1_PREG, 0, 6);\nstatic const struct reg_field cmn_plllc_clk1_en_preg =\n\t\t\t\tREG_FIELD(SIERRA_CMN_PLLLC_CLK1_PREG, 12, 12);\n\nstatic const char * const clk_names[] = {\n\t[CDNS_SIERRA_PLL_CMNLC] = \"pll_cmnlc\",\n\t[CDNS_SIERRA_PLL_CMNLC1] = \"pll_cmnlc1\",\n\t[CDNS_SIERRA_DERIVED_REFCLK] = \"refclk_der\",\n};\n\nenum cdns_sierra_cmn_plllc {\n\tCMN_PLLLC,\n\tCMN_PLLLC1,\n};\n\nstruct cdns_sierra_pll_mux_reg_fields {\n\tstruct reg_field\tpfdclk_sel_preg;\n\tstruct reg_field\tplllc1en_field;\n\tstruct reg_field\ttermen_field;\n};\n\nstatic const struct cdns_sierra_pll_mux_reg_fields cmn_plllc_pfdclk1_sel_preg[] = {\n\t[CMN_PLLLC] = {\n\t\t.pfdclk_sel_preg = REG_FIELD(SIERRA_CMN_PLLLC_GEN_PREG, 1, 1),\n\t\t.plllc1en_field = REG_FIELD(SIERRA_CMN_REFRCV1_PREG, 8, 8),\n\t\t.termen_field = REG_FIELD(SIERRA_CMN_REFRCV1_PREG, 0, 0),\n\t},\n\t[CMN_PLLLC1] = {\n\t\t.pfdclk_sel_preg = REG_FIELD(SIERRA_CMN_PLLLC1_GEN_PREG, 1, 1),\n\t\t.plllc1en_field = REG_FIELD(SIERRA_CMN_REFRCV_PREG, 8, 8),\n\t\t.termen_field = REG_FIELD(SIERRA_CMN_REFRCV_PREG, 0, 0),\n\t},\n};\n\nstruct cdns_sierra_pll_mux {\n\tstruct clk_hw\t\thw;\n\tstruct regmap_field\t*pfdclk_sel_preg;\n\tstruct regmap_field\t*plllc1en_field;\n\tstruct regmap_field\t*termen_field;\n\tstruct clk_init_data\tclk_data;\n};\n\n#define to_cdns_sierra_pll_mux(_hw)\t\\\n\t\t\tcontainer_of(_hw, struct cdns_sierra_pll_mux, hw)\n\n#define PLL0_REFCLK_NAME \"pll0_refclk\"\n#define PLL1_REFCLK_NAME \"pll1_refclk\"\n\nstatic const struct clk_parent_data pll_mux_parent_data[][SIERRA_NUM_CMN_PLLC_PARENTS] = {\n\t[CMN_PLLLC] = {\n\t\t{ .fw_name = PLL0_REFCLK_NAME },\n\t\t{ .fw_name = PLL1_REFCLK_NAME }\n\t},\n\t[CMN_PLLLC1] = {\n\t\t{ .fw_name = PLL1_REFCLK_NAME },\n\t\t{ .fw_name = PLL0_REFCLK_NAME }\n\t},\n};\n\nstatic u32 cdns_sierra_pll_mux_table[][SIERRA_NUM_CMN_PLLC_PARENTS] = {\n\t[CMN_PLLLC] = { 0, 1 },\n\t[CMN_PLLLC1] = { 1, 0 },\n};\n\nstruct cdns_sierra_derived_refclk {\n\tstruct clk_hw           hw;\n\tstruct regmap_field     *cmn_plllc_clk1outdiv_preg;\n\tstruct regmap_field     *cmn_plllc_clk1_en_preg;\n\tstruct clk_init_data\tclk_data;\n};\n\n#define to_cdns_sierra_derived_refclk(_hw)\t\\\n\t\t\tcontainer_of(_hw, struct cdns_sierra_derived_refclk, hw)\n\nenum cdns_sierra_phy_type {\n\tTYPE_NONE,\n\tTYPE_PCIE,\n\tTYPE_USB,\n\tTYPE_SGMII,\n\tTYPE_QSGMII\n};\n\nenum cdns_sierra_ssc_mode {\n\tNO_SSC,\n\tEXTERNAL_SSC,\n\tINTERNAL_SSC\n};\n\nstruct cdns_sierra_inst {\n\tstruct phy *phy;\n\tenum cdns_sierra_phy_type phy_type;\n\tu32 num_lanes;\n\tu32 mlane;\n\tstruct reset_control *lnk_rst;\n\tenum cdns_sierra_ssc_mode ssc_mode;\n};\n\nstruct cdns_reg_pairs {\n\tu16 val;\n\tu32 off;\n};\n\nstruct cdns_sierra_vals {\n\tconst struct cdns_reg_pairs *reg_pairs;\n\tu32 num_regs;\n};\n\nstruct cdns_sierra_data {\n\tu32 id_value;\n\tu8 block_offset_shift;\n\tu8 reg_offset_shift;\n\tstruct cdns_sierra_vals *pcs_cmn_vals[NUM_PHY_TYPE][NUM_PHY_TYPE]\n\t\t\t\t\t     [NUM_SSC_MODE];\n\tstruct cdns_sierra_vals *phy_pma_ln_vals[NUM_PHY_TYPE][NUM_PHY_TYPE]\n\t\t\t\t\t\t[NUM_SSC_MODE];\n\tstruct cdns_sierra_vals *pma_cmn_vals[NUM_PHY_TYPE][NUM_PHY_TYPE]\n\t\t\t\t\t     [NUM_SSC_MODE];\n\tstruct cdns_sierra_vals *pma_ln_vals[NUM_PHY_TYPE][NUM_PHY_TYPE]\n\t\t\t\t\t    [NUM_SSC_MODE];\n};\n\nstruct cdns_regmap_cdb_context {\n\tstruct device *dev;\n\tvoid __iomem *base;\n\tu8 reg_offset_shift;\n};\n\nstruct cdns_sierra_phy {\n\tstruct device *dev;\n\tconst struct cdns_sierra_data *init_data;\n\tstruct cdns_sierra_inst phys[SIERRA_MAX_LANES];\n\tstruct reset_control *phy_rst;\n\tstruct reset_control *apb_rst;\n\tstruct regmap *regmap_lane_cdb[SIERRA_MAX_LANES];\n\tstruct regmap *regmap_phy_pcs_common_cdb;\n\tstruct regmap *regmap_phy_pcs_lane_cdb[SIERRA_MAX_LANES];\n\tstruct regmap *regmap_phy_pma_common_cdb;\n\tstruct regmap *regmap_phy_pma_lane_cdb[SIERRA_MAX_LANES];\n\tstruct regmap *regmap_common_cdb;\n\tstruct regmap_field *macro_id_type;\n\tstruct regmap_field *phy_pll_cfg_1;\n\tstruct regmap_field *pma_cmn_ready;\n\tstruct regmap_field *pllctrl_lock[SIERRA_MAX_LANES];\n\tstruct regmap_field *phy_iso_link_ctrl_1[SIERRA_MAX_LANES];\n\tstruct regmap_field *cmn_refrcv_refclk_plllc1en_preg[SIERRA_NUM_CMN_PLLC];\n\tstruct regmap_field *cmn_refrcv_refclk_termen_preg[SIERRA_NUM_CMN_PLLC];\n\tstruct regmap_field *cmn_plllc_pfdclk1_sel_preg[SIERRA_NUM_CMN_PLLC];\n\tstruct clk *input_clks[CDNS_SIERRA_INPUT_CLOCKS];\n\tint nsubnodes;\n\tu32 num_lanes;\n\tbool autoconf;\n\tint already_configured;\n\tstruct clk *pll_clks[SIERRA_NUM_CMN_PLLC];\n\tstruct clk_hw_onecell_data clk_data;\n};\n\nstatic int cdns_regmap_write(void *context, unsigned int reg, unsigned int val)\n{\n\tstruct cdns_regmap_cdb_context *ctx = context;\n\tu32 offset = reg << ctx->reg_offset_shift;\n\n\twritew(val, ctx->base + offset);\n\n\treturn 0;\n}\n\nstatic int cdns_regmap_read(void *context, unsigned int reg, unsigned int *val)\n{\n\tstruct cdns_regmap_cdb_context *ctx = context;\n\tu32 offset = reg << ctx->reg_offset_shift;\n\n\t*val = readw(ctx->base + offset);\n\treturn 0;\n}\n\n#define SIERRA_LANE_CDB_REGMAP_CONF(n) \\\n{ \\\n\t.name = \"sierra_lane\" n \"_cdb\", \\\n\t.reg_stride = 1, \\\n\t.fast_io = true, \\\n\t.reg_write = cdns_regmap_write, \\\n\t.reg_read = cdns_regmap_read, \\\n}\n\nstatic const struct regmap_config cdns_sierra_lane_cdb_config[] = {\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"0\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"1\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"2\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"3\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"4\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"5\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"6\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"7\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"8\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"9\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"10\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"11\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"12\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"13\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"14\"),\n\tSIERRA_LANE_CDB_REGMAP_CONF(\"15\"),\n};\n\nstatic const struct regmap_config cdns_sierra_common_cdb_config = {\n\t.name = \"sierra_common_cdb\",\n\t.reg_stride = 1,\n\t.fast_io = true,\n\t.reg_write = cdns_regmap_write,\n\t.reg_read = cdns_regmap_read,\n};\n\nstatic const struct regmap_config cdns_sierra_phy_pcs_cmn_cdb_config = {\n\t.name = \"sierra_phy_pcs_cmn_cdb\",\n\t.reg_stride = 1,\n\t.fast_io = true,\n\t.reg_write = cdns_regmap_write,\n\t.reg_read = cdns_regmap_read,\n};\n\n#define SIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(n) \\\n{ \\\n\t.name = \"sierra_phy_pcs_lane\" n \"_cdb\", \\\n\t.reg_stride = 1, \\\n\t.fast_io = true, \\\n\t.reg_write = cdns_regmap_write, \\\n\t.reg_read = cdns_regmap_read, \\\n}\n\nstatic const struct regmap_config cdns_sierra_phy_pcs_lane_cdb_config[] = {\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"0\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"1\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"2\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"3\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"4\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"5\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"6\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"7\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"8\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"9\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"10\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"11\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"12\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"13\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"14\"),\n\tSIERRA_PHY_PCS_LANE_CDB_REGMAP_CONF(\"15\"),\n};\n\nstatic const struct regmap_config cdns_sierra_phy_pma_cmn_cdb_config = {\n\t.name = \"sierra_phy_pma_cmn_cdb\",\n\t.reg_stride = 1,\n\t.fast_io = true,\n\t.reg_write = cdns_regmap_write,\n\t.reg_read = cdns_regmap_read,\n};\n\n#define SIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(n) \\\n{ \\\n\t.name = \"sierra_phy_pma_lane\" n \"_cdb\", \\\n\t.reg_stride = 1, \\\n\t.fast_io = true, \\\n\t.reg_write = cdns_regmap_write, \\\n\t.reg_read = cdns_regmap_read, \\\n}\n\nstatic const struct regmap_config cdns_sierra_phy_pma_lane_cdb_config[] = {\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"0\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"1\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"2\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"3\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"4\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"5\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"6\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"7\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"8\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"9\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"10\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"11\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"12\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"13\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"14\"),\n\tSIERRA_PHY_PMA_LANE_CDB_REGMAP_CONF(\"15\"),\n};\n\nstatic int cdns_sierra_phy_init(struct phy *gphy)\n{\n\tstruct cdns_sierra_inst *ins = phy_get_drvdata(gphy);\n\tstruct cdns_sierra_phy *phy = dev_get_drvdata(gphy->dev.parent);\n\tconst struct cdns_sierra_data *init_data = phy->init_data;\n\tstruct cdns_sierra_vals *pma_cmn_vals, *pma_ln_vals;\n\tenum cdns_sierra_phy_type phy_type = ins->phy_type;\n\tenum cdns_sierra_ssc_mode ssc = ins->ssc_mode;\n\tstruct cdns_sierra_vals *phy_pma_ln_vals;\n\tconst struct cdns_reg_pairs *reg_pairs;\n\tstruct cdns_sierra_vals *pcs_cmn_vals;\n\tstruct regmap *regmap;\n\tu32 num_regs;\n\tint i, j;\n\n\t \n\tif (phy->autoconf || phy->already_configured || phy->nsubnodes > 1)\n\t\treturn 0;\n\n\tclk_set_rate(phy->input_clks[CMN_REFCLK_DIG_DIV], 25000000);\n\tclk_set_rate(phy->input_clks[CMN_REFCLK1_DIG_DIV], 25000000);\n\n\t \n\tpcs_cmn_vals = init_data->pcs_cmn_vals[phy_type][TYPE_NONE][ssc];\n\tif (pcs_cmn_vals) {\n\t\treg_pairs = pcs_cmn_vals->reg_pairs;\n\t\tnum_regs = pcs_cmn_vals->num_regs;\n\t\tregmap = phy->regmap_phy_pcs_common_cdb;\n\t\tfor (i = 0; i < num_regs; i++)\n\t\t\tregmap_write(regmap, reg_pairs[i].off, reg_pairs[i].val);\n\t}\n\n\t \n\tphy_pma_ln_vals = init_data->phy_pma_ln_vals[phy_type][TYPE_NONE][ssc];\n\tif (phy_pma_ln_vals) {\n\t\treg_pairs = phy_pma_ln_vals->reg_pairs;\n\t\tnum_regs = phy_pma_ln_vals->num_regs;\n\t\tfor (i = 0; i < ins->num_lanes; i++) {\n\t\t\tregmap = phy->regmap_phy_pma_lane_cdb[i + ins->mlane];\n\t\t\tfor (j = 0; j < num_regs; j++)\n\t\t\t\tregmap_write(regmap, reg_pairs[j].off, reg_pairs[j].val);\n\t\t}\n\t}\n\n\t \n\tpma_cmn_vals = init_data->pma_cmn_vals[phy_type][TYPE_NONE][ssc];\n\tif (pma_cmn_vals) {\n\t\treg_pairs = pma_cmn_vals->reg_pairs;\n\t\tnum_regs = pma_cmn_vals->num_regs;\n\t\tregmap = phy->regmap_common_cdb;\n\t\tfor (i = 0; i < num_regs; i++)\n\t\t\tregmap_write(regmap, reg_pairs[i].off, reg_pairs[i].val);\n\t}\n\n\t \n\tpma_ln_vals = init_data->pma_ln_vals[phy_type][TYPE_NONE][ssc];\n\tif (pma_ln_vals) {\n\t\treg_pairs = pma_ln_vals->reg_pairs;\n\t\tnum_regs = pma_ln_vals->num_regs;\n\t\tfor (i = 0; i < ins->num_lanes; i++) {\n\t\t\tregmap = phy->regmap_lane_cdb[i + ins->mlane];\n\t\t\tfor (j = 0; j < num_regs; j++)\n\t\t\t\tregmap_write(regmap, reg_pairs[j].off, reg_pairs[j].val);\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_on(struct phy *gphy)\n{\n\tstruct cdns_sierra_phy *sp = dev_get_drvdata(gphy->dev.parent);\n\tstruct cdns_sierra_inst *ins = phy_get_drvdata(gphy);\n\tstruct device *dev = sp->dev;\n\tu32 val;\n\tint ret;\n\n\tif (sp->nsubnodes == 1) {\n\t\t \n\t\tret = reset_control_deassert(sp->phy_rst);\n\t\tif (ret) {\n\t\t\tdev_err(dev, \"Failed to take the PHY out of reset\\n\");\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\t \n\tret = reset_control_deassert(ins->lnk_rst);\n\tif (ret) {\n\t\tdev_err(dev, \"Failed to take the PHY lane out of reset\\n\");\n\t\treturn ret;\n\t}\n\n\tif (ins->phy_type == TYPE_PCIE || ins->phy_type == TYPE_USB) {\n\t\tret = regmap_field_read_poll_timeout(sp->phy_iso_link_ctrl_1[ins->mlane],\n\t\t\t\t\t\t     val, !val, 1000, PLL_LOCK_TIME);\n\t\tif (ret) {\n\t\t\tdev_err(dev, \"Timeout waiting for PHY status ready\\n\");\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\t \n\tret = regmap_field_read_poll_timeout(sp->pma_cmn_ready, val, val,\n\t\t\t\t\t     1000, PLL_LOCK_TIME);\n\tif (ret) {\n\t\tdev_err(dev, \"Timeout waiting for CMN ready\\n\");\n\t\treturn ret;\n\t}\n\n\tret = regmap_field_read_poll_timeout(sp->pllctrl_lock[ins->mlane],\n\t\t\t\t\t     val, val, 1000, PLL_LOCK_TIME);\n\tif (ret < 0)\n\t\tdev_err(dev, \"PLL lock of lane failed\\n\");\n\n\treturn ret;\n}\n\nstatic int cdns_sierra_phy_off(struct phy *gphy)\n{\n\tstruct cdns_sierra_inst *ins = phy_get_drvdata(gphy);\n\n\treturn reset_control_assert(ins->lnk_rst);\n}\n\nstatic int cdns_sierra_phy_reset(struct phy *gphy)\n{\n\tstruct cdns_sierra_phy *sp = dev_get_drvdata(gphy->dev.parent);\n\n\treset_control_assert(sp->phy_rst);\n\treset_control_deassert(sp->phy_rst);\n\treturn 0;\n};\n\nstatic const struct phy_ops ops = {\n\t.init\t\t= cdns_sierra_phy_init,\n\t.power_on\t= cdns_sierra_phy_on,\n\t.power_off\t= cdns_sierra_phy_off,\n\t.reset\t\t= cdns_sierra_phy_reset,\n\t.owner\t\t= THIS_MODULE,\n};\n\nstatic int cdns_sierra_noop_phy_on(struct phy *gphy)\n{\n\tusleep_range(5000, 10000);\n\n\treturn 0;\n}\n\nstatic const struct phy_ops noop_ops = {\n\t.power_on\t= cdns_sierra_noop_phy_on,\n\t.owner\t\t= THIS_MODULE,\n};\n\nstatic u8 cdns_sierra_pll_mux_get_parent(struct clk_hw *hw)\n{\n\tstruct cdns_sierra_pll_mux *mux = to_cdns_sierra_pll_mux(hw);\n\tstruct regmap_field *plllc1en_field = mux->plllc1en_field;\n\tstruct regmap_field *termen_field = mux->termen_field;\n\tstruct regmap_field *field = mux->pfdclk_sel_preg;\n\tunsigned int val;\n\tint index;\n\n\tregmap_field_read(field, &val);\n\n\tif (strstr(clk_hw_get_name(hw), clk_names[CDNS_SIERRA_PLL_CMNLC1])) {\n\t\tindex = clk_mux_val_to_index(hw, cdns_sierra_pll_mux_table[CMN_PLLLC1], 0, val);\n\t\tif (index == 1) {\n\t\t\tregmap_field_write(plllc1en_field, 1);\n\t\t\tregmap_field_write(termen_field, 1);\n\t\t}\n\t} else {\n\t\tindex = clk_mux_val_to_index(hw, cdns_sierra_pll_mux_table[CMN_PLLLC], 0, val);\n\t}\n\n\treturn index;\n}\n\nstatic int cdns_sierra_pll_mux_set_parent(struct clk_hw *hw, u8 index)\n{\n\tstruct cdns_sierra_pll_mux *mux = to_cdns_sierra_pll_mux(hw);\n\tstruct regmap_field *plllc1en_field = mux->plllc1en_field;\n\tstruct regmap_field *termen_field = mux->termen_field;\n\tstruct regmap_field *field = mux->pfdclk_sel_preg;\n\tint val, ret;\n\n\tret = regmap_field_write(plllc1en_field, 0);\n\tret |= regmap_field_write(termen_field, 0);\n\tif (index == 1) {\n\t\tret |= regmap_field_write(plllc1en_field, 1);\n\t\tret |= regmap_field_write(termen_field, 1);\n\t}\n\n\tif (strstr(clk_hw_get_name(hw), clk_names[CDNS_SIERRA_PLL_CMNLC1]))\n\t\tval = cdns_sierra_pll_mux_table[CMN_PLLLC1][index];\n\telse\n\t\tval = cdns_sierra_pll_mux_table[CMN_PLLLC][index];\n\n\tret |= regmap_field_write(field, val);\n\n\treturn ret;\n}\n\nstatic const struct clk_ops cdns_sierra_pll_mux_ops = {\n\t.determine_rate = __clk_mux_determine_rate,\n\t.set_parent = cdns_sierra_pll_mux_set_parent,\n\t.get_parent = cdns_sierra_pll_mux_get_parent,\n};\n\nstatic int cdns_sierra_pll_mux_register(struct cdns_sierra_phy *sp,\n\t\t\t\t\tstruct regmap_field *pfdclk1_sel_field,\n\t\t\t\t\tstruct regmap_field *plllc1en_field,\n\t\t\t\t\tstruct regmap_field *termen_field,\n\t\t\t\t\tint clk_index)\n{\n\tstruct cdns_sierra_pll_mux *mux;\n\tstruct device *dev = sp->dev;\n\tstruct clk_init_data *init;\n\tchar clk_name[100];\n\tint ret;\n\n\tmux = devm_kzalloc(dev, sizeof(*mux), GFP_KERNEL);\n\tif (!mux)\n\t\treturn -ENOMEM;\n\n\tsnprintf(clk_name, sizeof(clk_name), \"%s_%s\", dev_name(dev), clk_names[clk_index]);\n\n\tinit = &mux->clk_data;\n\n\tinit->ops = &cdns_sierra_pll_mux_ops;\n\tinit->flags = CLK_SET_RATE_NO_REPARENT;\n\tinit->parent_data = pll_mux_parent_data[clk_index];\n\tinit->num_parents = SIERRA_NUM_CMN_PLLC_PARENTS;\n\tinit->name = clk_name;\n\n\tmux->pfdclk_sel_preg = pfdclk1_sel_field;\n\tmux->plllc1en_field = plllc1en_field;\n\tmux->termen_field = termen_field;\n\tmux->hw.init = init;\n\n\tret = devm_clk_hw_register(dev, &mux->hw);\n\tif (ret)\n\t\treturn ret;\n\n\tsp->clk_data.hws[clk_index] = &mux->hw;\n\n\tsp->pll_clks[clk_index] = devm_clk_hw_get_clk(dev, &mux->hw,\n\t\t\t\t\t\t      clk_names[clk_index]);\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_register_pll_mux(struct cdns_sierra_phy *sp)\n{\n\tstruct regmap_field *pfdclk1_sel_field;\n\tstruct regmap_field *plllc1en_field;\n\tstruct regmap_field *termen_field;\n\tstruct device *dev = sp->dev;\n\tint ret = 0, i, clk_index;\n\n\tclk_index = CDNS_SIERRA_PLL_CMNLC;\n\tfor (i = 0; i < SIERRA_NUM_CMN_PLLC; i++, clk_index++) {\n\t\tpfdclk1_sel_field = sp->cmn_plllc_pfdclk1_sel_preg[i];\n\t\tplllc1en_field = sp->cmn_refrcv_refclk_plllc1en_preg[i];\n\t\ttermen_field = sp->cmn_refrcv_refclk_termen_preg[i];\n\n\t\tret = cdns_sierra_pll_mux_register(sp, pfdclk1_sel_field, plllc1en_field,\n\t\t\t\t\t\t   termen_field, clk_index);\n\t\tif (ret) {\n\t\t\tdev_err(dev, \"Fail to register cmn plllc mux\\n\");\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_derived_refclk_enable(struct clk_hw *hw)\n{\n\tstruct cdns_sierra_derived_refclk *derived_refclk = to_cdns_sierra_derived_refclk(hw);\n\n\tregmap_field_write(derived_refclk->cmn_plllc_clk1_en_preg, 0x1);\n\n\t \n\tregmap_field_write(derived_refclk->cmn_plllc_clk1outdiv_preg, 0x2E);\n\n\treturn 0;\n}\n\nstatic void cdns_sierra_derived_refclk_disable(struct clk_hw *hw)\n{\n\tstruct cdns_sierra_derived_refclk *derived_refclk = to_cdns_sierra_derived_refclk(hw);\n\n\tregmap_field_write(derived_refclk->cmn_plllc_clk1_en_preg, 0);\n}\n\nstatic int cdns_sierra_derived_refclk_is_enabled(struct clk_hw *hw)\n{\n\tstruct cdns_sierra_derived_refclk *derived_refclk = to_cdns_sierra_derived_refclk(hw);\n\tint val;\n\n\tregmap_field_read(derived_refclk->cmn_plllc_clk1_en_preg, &val);\n\n\treturn !!val;\n}\n\nstatic const struct clk_ops cdns_sierra_derived_refclk_ops = {\n\t.enable = cdns_sierra_derived_refclk_enable,\n\t.disable = cdns_sierra_derived_refclk_disable,\n\t.is_enabled = cdns_sierra_derived_refclk_is_enabled,\n};\n\nstatic int cdns_sierra_derived_refclk_register(struct cdns_sierra_phy *sp)\n{\n\tstruct cdns_sierra_derived_refclk *derived_refclk;\n\tstruct device *dev = sp->dev;\n\tstruct regmap_field *field;\n\tstruct clk_init_data *init;\n\tstruct regmap *regmap;\n\tchar clk_name[100];\n\tint ret;\n\n\tderived_refclk = devm_kzalloc(dev, sizeof(*derived_refclk), GFP_KERNEL);\n\tif (!derived_refclk)\n\t\treturn -ENOMEM;\n\n\tsnprintf(clk_name, sizeof(clk_name), \"%s_%s\", dev_name(dev),\n\t\t clk_names[CDNS_SIERRA_DERIVED_REFCLK]);\n\n\tinit = &derived_refclk->clk_data;\n\n\tinit->ops = &cdns_sierra_derived_refclk_ops;\n\tinit->flags = 0;\n\tinit->name = clk_name;\n\n\tregmap = sp->regmap_common_cdb;\n\n\tfield = devm_regmap_field_alloc(dev, regmap, cmn_plllc_clk1outdiv_preg);\n\tif (IS_ERR(field)) {\n\t\tdev_err(dev, \"cmn_plllc_clk1outdiv_preg reg field init failed\\n\");\n\t\treturn PTR_ERR(field);\n\t}\n\tderived_refclk->cmn_plllc_clk1outdiv_preg = field;\n\n\tfield = devm_regmap_field_alloc(dev, regmap, cmn_plllc_clk1_en_preg);\n\tif (IS_ERR(field)) {\n\t\tdev_err(dev, \"cmn_plllc_clk1_en_preg reg field init failed\\n\");\n\t\treturn PTR_ERR(field);\n\t}\n\tderived_refclk->cmn_plllc_clk1_en_preg = field;\n\n\tderived_refclk->hw.init = init;\n\n\tret = devm_clk_hw_register(dev, &derived_refclk->hw);\n\tif (ret)\n\t\treturn ret;\n\n\tsp->clk_data.hws[CDNS_SIERRA_DERIVED_REFCLK] = &derived_refclk->hw;\n\n\treturn 0;\n}\n\nstatic void cdns_sierra_clk_unregister(struct cdns_sierra_phy *sp)\n{\n\tstruct device *dev = sp->dev;\n\tstruct device_node *node = dev->of_node;\n\n\tof_clk_del_provider(node);\n}\n\nstatic int cdns_sierra_clk_register(struct cdns_sierra_phy *sp)\n{\n\tstruct device *dev = sp->dev;\n\tstruct device_node *node = dev->of_node;\n\tint ret;\n\n\tret = cdns_sierra_phy_register_pll_mux(sp);\n\tif (ret) {\n\t\tdev_err(dev, \"Failed to pll mux clocks\\n\");\n\t\treturn ret;\n\t}\n\n\tret = cdns_sierra_derived_refclk_register(sp);\n\tif (ret) {\n\t\tdev_err(dev, \"Failed to register derived refclk\\n\");\n\t\treturn ret;\n\t}\n\n\tsp->clk_data.num = CDNS_SIERRA_OUTPUT_CLOCKS;\n\tret = of_clk_add_hw_provider(node, of_clk_hw_onecell_get,\n\t\t\t\t     &sp->clk_data);\n\tif (ret)\n\t\tdev_err(dev, \"Failed to add clock provider: %s\\n\", node->name);\n\n\treturn ret;\n}\n\nstatic int cdns_sierra_get_optional(struct cdns_sierra_inst *inst,\n\t\t\t\t    struct device_node *child)\n{\n\tu32 phy_type;\n\n\tif (of_property_read_u32(child, \"reg\", &inst->mlane))\n\t\treturn -EINVAL;\n\n\tif (of_property_read_u32(child, \"cdns,num-lanes\", &inst->num_lanes))\n\t\treturn -EINVAL;\n\n\tif (of_property_read_u32(child, \"cdns,phy-type\", &phy_type))\n\t\treturn -EINVAL;\n\n\tswitch (phy_type) {\n\tcase PHY_TYPE_PCIE:\n\t\tinst->phy_type = TYPE_PCIE;\n\t\tbreak;\n\tcase PHY_TYPE_USB3:\n\t\tinst->phy_type = TYPE_USB;\n\t\tbreak;\n\tcase PHY_TYPE_SGMII:\n\t\tinst->phy_type = TYPE_SGMII;\n\t\tbreak;\n\tcase PHY_TYPE_QSGMII:\n\t\tinst->phy_type = TYPE_QSGMII;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tinst->ssc_mode = EXTERNAL_SSC;\n\tof_property_read_u32(child, \"cdns,ssc-mode\", &inst->ssc_mode);\n\n\treturn 0;\n}\n\nstatic struct regmap *cdns_regmap_init(struct device *dev, void __iomem *base,\n\t\t\t\t       u32 block_offset, u8 reg_offset_shift,\n\t\t\t\t       const struct regmap_config *config)\n{\n\tstruct cdns_regmap_cdb_context *ctx;\n\n\tctx = devm_kzalloc(dev, sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tctx->dev = dev;\n\tctx->base = base + block_offset;\n\tctx->reg_offset_shift = reg_offset_shift;\n\n\treturn devm_regmap_init(dev, NULL, ctx, config);\n}\n\nstatic int cdns_regfield_init(struct cdns_sierra_phy *sp)\n{\n\tstruct device *dev = sp->dev;\n\tstruct regmap_field *field;\n\tstruct reg_field reg_field;\n\tstruct regmap *regmap;\n\tint i;\n\n\tregmap = sp->regmap_common_cdb;\n\tfield = devm_regmap_field_alloc(dev, regmap, macro_id_type);\n\tif (IS_ERR(field)) {\n\t\tdev_err(dev, \"MACRO_ID_TYPE reg field init failed\\n\");\n\t\treturn PTR_ERR(field);\n\t}\n\tsp->macro_id_type = field;\n\n\tfor (i = 0; i < SIERRA_NUM_CMN_PLLC; i++) {\n\t\treg_field = cmn_plllc_pfdclk1_sel_preg[i].pfdclk_sel_preg;\n\t\tfield = devm_regmap_field_alloc(dev, regmap, reg_field);\n\t\tif (IS_ERR(field)) {\n\t\t\tdev_err(dev, \"PLLLC%d_PFDCLK1_SEL failed\\n\", i);\n\t\t\treturn PTR_ERR(field);\n\t\t}\n\t\tsp->cmn_plllc_pfdclk1_sel_preg[i] = field;\n\n\t\treg_field = cmn_plllc_pfdclk1_sel_preg[i].plllc1en_field;\n\t\tfield = devm_regmap_field_alloc(dev, regmap, reg_field);\n\t\tif (IS_ERR(field)) {\n\t\t\tdev_err(dev, \"REFRCV%d_REFCLK_PLLLC1EN failed\\n\", i);\n\t\t\treturn PTR_ERR(field);\n\t\t}\n\t\tsp->cmn_refrcv_refclk_plllc1en_preg[i] = field;\n\n\t\treg_field = cmn_plllc_pfdclk1_sel_preg[i].termen_field;\n\t\tfield = devm_regmap_field_alloc(dev, regmap, reg_field);\n\t\tif (IS_ERR(field)) {\n\t\t\tdev_err(dev, \"REFRCV%d_REFCLK_TERMEN failed\\n\", i);\n\t\t\treturn PTR_ERR(field);\n\t\t}\n\t\tsp->cmn_refrcv_refclk_termen_preg[i] = field;\n\t}\n\n\tregmap = sp->regmap_phy_pcs_common_cdb;\n\tfield = devm_regmap_field_alloc(dev, regmap, phy_pll_cfg_1);\n\tif (IS_ERR(field)) {\n\t\tdev_err(dev, \"PHY_PLL_CFG_1 reg field init failed\\n\");\n\t\treturn PTR_ERR(field);\n\t}\n\tsp->phy_pll_cfg_1 = field;\n\n\tregmap = sp->regmap_phy_pma_common_cdb;\n\tfield = devm_regmap_field_alloc(dev, regmap, pma_cmn_ready);\n\tif (IS_ERR(field)) {\n\t\tdev_err(dev, \"PHY_PMA_CMN_CTRL reg field init failed\\n\");\n\t\treturn PTR_ERR(field);\n\t}\n\tsp->pma_cmn_ready = field;\n\n\tfor (i = 0; i < SIERRA_MAX_LANES; i++) {\n\t\tregmap = sp->regmap_lane_cdb[i];\n\t\tfield = devm_regmap_field_alloc(dev, regmap, pllctrl_lock);\n\t\tif (IS_ERR(field)) {\n\t\t\tdev_err(dev, \"P%d_ENABLE reg field init failed\\n\", i);\n\t\t\treturn PTR_ERR(field);\n\t\t}\n\t\tsp->pllctrl_lock[i] = field;\n\t}\n\n\tfor (i = 0; i < SIERRA_MAX_LANES; i++) {\n\t\tregmap = sp->regmap_phy_pcs_lane_cdb[i];\n\t\tfield = devm_regmap_field_alloc(dev, regmap, phy_iso_link_ctrl_1);\n\t\tif (IS_ERR(field)) {\n\t\t\tdev_err(dev, \"PHY_ISO_LINK_CTRL reg field init for lane %d failed\\n\", i);\n\t\t\treturn PTR_ERR(field);\n\t\t}\n\t\tsp->phy_iso_link_ctrl_1[i] = field;\n\t}\n\n\treturn 0;\n}\n\nstatic int cdns_regmap_init_blocks(struct cdns_sierra_phy *sp,\n\t\t\t\t   void __iomem *base, u8 block_offset_shift,\n\t\t\t\t   u8 reg_offset_shift)\n{\n\tstruct device *dev = sp->dev;\n\tstruct regmap *regmap;\n\tu32 block_offset;\n\tint i;\n\n\tfor (i = 0; i < SIERRA_MAX_LANES; i++) {\n\t\tblock_offset = SIERRA_LANE_CDB_OFFSET(i, block_offset_shift,\n\t\t\t\t\t\t      reg_offset_shift);\n\t\tregmap = cdns_regmap_init(dev, base, block_offset,\n\t\t\t\t\t  reg_offset_shift,\n\t\t\t\t\t  &cdns_sierra_lane_cdb_config[i]);\n\t\tif (IS_ERR(regmap)) {\n\t\t\tdev_err(dev, \"Failed to init lane CDB regmap\\n\");\n\t\t\treturn PTR_ERR(regmap);\n\t\t}\n\t\tsp->regmap_lane_cdb[i] = regmap;\n\t}\n\n\tregmap = cdns_regmap_init(dev, base, SIERRA_COMMON_CDB_OFFSET,\n\t\t\t\t  reg_offset_shift,\n\t\t\t\t  &cdns_sierra_common_cdb_config);\n\tif (IS_ERR(regmap)) {\n\t\tdev_err(dev, \"Failed to init common CDB regmap\\n\");\n\t\treturn PTR_ERR(regmap);\n\t}\n\tsp->regmap_common_cdb = regmap;\n\n\tblock_offset = SIERRA_PHY_PCS_COMMON_OFFSET(block_offset_shift);\n\tregmap = cdns_regmap_init(dev, base, block_offset, reg_offset_shift,\n\t\t\t\t  &cdns_sierra_phy_pcs_cmn_cdb_config);\n\tif (IS_ERR(regmap)) {\n\t\tdev_err(dev, \"Failed to init PHY PCS common CDB regmap\\n\");\n\t\treturn PTR_ERR(regmap);\n\t}\n\tsp->regmap_phy_pcs_common_cdb = regmap;\n\n\tfor (i = 0; i < SIERRA_MAX_LANES; i++) {\n\t\tblock_offset = SIERRA_PHY_PCS_LANE_CDB_OFFSET(i, block_offset_shift,\n\t\t\t\t\t\t\t      reg_offset_shift);\n\t\tregmap = cdns_regmap_init(dev, base, block_offset,\n\t\t\t\t\t  reg_offset_shift,\n\t\t\t\t\t  &cdns_sierra_phy_pcs_lane_cdb_config[i]);\n\t\tif (IS_ERR(regmap)) {\n\t\t\tdev_err(dev, \"Failed to init PHY PCS lane CDB regmap\\n\");\n\t\t\treturn PTR_ERR(regmap);\n\t\t}\n\t\tsp->regmap_phy_pcs_lane_cdb[i] = regmap;\n\t}\n\n\tblock_offset = SIERRA_PHY_PMA_COMMON_OFFSET(block_offset_shift);\n\tregmap = cdns_regmap_init(dev, base, block_offset, reg_offset_shift,\n\t\t\t\t  &cdns_sierra_phy_pma_cmn_cdb_config);\n\tif (IS_ERR(regmap)) {\n\t\tdev_err(dev, \"Failed to init PHY PMA common CDB regmap\\n\");\n\t\treturn PTR_ERR(regmap);\n\t}\n\tsp->regmap_phy_pma_common_cdb = regmap;\n\n\tfor (i = 0; i < SIERRA_MAX_LANES; i++) {\n\t\tblock_offset = SIERRA_PHY_PMA_LANE_CDB_OFFSET(i, block_offset_shift,\n\t\t\t\t\t\t\t      reg_offset_shift);\n\t\tregmap = cdns_regmap_init(dev, base, block_offset,\n\t\t\t\t\t  reg_offset_shift,\n\t\t\t\t\t  &cdns_sierra_phy_pma_lane_cdb_config[i]);\n\t\tif (IS_ERR(regmap)) {\n\t\t\tdev_err(dev, \"Failed to init PHY PMA lane CDB regmap\\n\");\n\t\t\treturn PTR_ERR(regmap);\n\t\t}\n\t\tsp->regmap_phy_pma_lane_cdb[i] = regmap;\n\t}\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_get_clocks(struct cdns_sierra_phy *sp,\n\t\t\t\t      struct device *dev)\n{\n\tstruct clk *clk;\n\tint ret;\n\n\tclk = devm_clk_get_optional(dev, \"cmn_refclk_dig_div\");\n\tif (IS_ERR(clk)) {\n\t\tdev_err(dev, \"cmn_refclk_dig_div clock not found\\n\");\n\t\tret = PTR_ERR(clk);\n\t\treturn ret;\n\t}\n\tsp->input_clks[CMN_REFCLK_DIG_DIV] = clk;\n\n\tclk = devm_clk_get_optional(dev, \"cmn_refclk1_dig_div\");\n\tif (IS_ERR(clk)) {\n\t\tdev_err(dev, \"cmn_refclk1_dig_div clock not found\\n\");\n\t\tret = PTR_ERR(clk);\n\t\treturn ret;\n\t}\n\tsp->input_clks[CMN_REFCLK1_DIG_DIV] = clk;\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_clk(struct cdns_sierra_phy *sp)\n{\n\tstruct device *dev = sp->dev;\n\tstruct clk *clk;\n\tint ret;\n\n\tclk = devm_clk_get_optional(dev, \"phy_clk\");\n\tif (IS_ERR(clk)) {\n\t\tdev_err(dev, \"failed to get clock phy_clk\\n\");\n\t\treturn PTR_ERR(clk);\n\t}\n\tsp->input_clks[PHY_CLK] = clk;\n\n\tret = clk_prepare_enable(sp->input_clks[PHY_CLK]);\n\tif (ret)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_enable_clocks(struct cdns_sierra_phy *sp)\n{\n\tint ret;\n\n\tret = clk_prepare_enable(sp->pll_clks[CDNS_SIERRA_PLL_CMNLC]);\n\tif (ret)\n\t\treturn ret;\n\n\tret = clk_prepare_enable(sp->pll_clks[CDNS_SIERRA_PLL_CMNLC1]);\n\tif (ret)\n\t\tgoto err_pll_cmnlc1;\n\n\treturn 0;\n\nerr_pll_cmnlc1:\n\tclk_disable_unprepare(sp->pll_clks[CDNS_SIERRA_PLL_CMNLC]);\n\n\treturn ret;\n}\n\nstatic void cdns_sierra_phy_disable_clocks(struct cdns_sierra_phy *sp)\n{\n\tclk_disable_unprepare(sp->pll_clks[CDNS_SIERRA_PLL_CMNLC1]);\n\tclk_disable_unprepare(sp->pll_clks[CDNS_SIERRA_PLL_CMNLC]);\n\tif (!sp->already_configured)\n\t\tclk_disable_unprepare(sp->input_clks[PHY_CLK]);\n}\n\nstatic int cdns_sierra_phy_get_resets(struct cdns_sierra_phy *sp,\n\t\t\t\t      struct device *dev)\n{\n\tstruct reset_control *rst;\n\n\trst = devm_reset_control_get_exclusive(dev, \"sierra_reset\");\n\tif (IS_ERR(rst)) {\n\t\tdev_err(dev, \"failed to get reset\\n\");\n\t\treturn PTR_ERR(rst);\n\t}\n\tsp->phy_rst = rst;\n\n\trst = devm_reset_control_get_optional_exclusive(dev, \"sierra_apb\");\n\tif (IS_ERR(rst)) {\n\t\tdev_err(dev, \"failed to get apb reset\\n\");\n\t\treturn PTR_ERR(rst);\n\t}\n\tsp->apb_rst = rst;\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_configure_multilink(struct cdns_sierra_phy *sp)\n{\n\tconst struct cdns_sierra_data *init_data = sp->init_data;\n\tstruct cdns_sierra_vals *pma_cmn_vals, *pma_ln_vals;\n\tenum cdns_sierra_phy_type phy_t1, phy_t2;\n\tstruct cdns_sierra_vals *phy_pma_ln_vals;\n\tconst struct cdns_reg_pairs *reg_pairs;\n\tstruct cdns_sierra_vals *pcs_cmn_vals;\n\tint i, j, node, mlane, num_lanes, ret;\n\tenum cdns_sierra_ssc_mode ssc;\n\tstruct regmap *regmap;\n\tu32 num_regs;\n\n\t \n\tif (sp->nsubnodes != 2)\n\t\treturn -EINVAL;\n\n\tclk_set_rate(sp->input_clks[CMN_REFCLK_DIG_DIV], 25000000);\n\tclk_set_rate(sp->input_clks[CMN_REFCLK1_DIG_DIV], 25000000);\n\n\t \n\tregmap_field_write(sp->phy_pll_cfg_1, 0x1);\n\n\tphy_t1 = sp->phys[0].phy_type;\n\tphy_t2 = sp->phys[1].phy_type;\n\n\t \n\tfor (node = 0; node < sp->nsubnodes; node++) {\n\t\tif (node == 1) {\n\t\t\t \n\t\t\tswap(phy_t1, phy_t2);\n\t\t}\n\n\t\tmlane = sp->phys[node].mlane;\n\t\tssc = sp->phys[node].ssc_mode;\n\t\tnum_lanes = sp->phys[node].num_lanes;\n\n\t\t \n\t\tpcs_cmn_vals = init_data->pcs_cmn_vals[phy_t1][phy_t2][ssc];\n\t\tif (pcs_cmn_vals) {\n\t\t\treg_pairs = pcs_cmn_vals->reg_pairs;\n\t\t\tnum_regs = pcs_cmn_vals->num_regs;\n\t\t\tregmap = sp->regmap_phy_pcs_common_cdb;\n\t\t\tfor (i = 0; i < num_regs; i++)\n\t\t\t\tregmap_write(regmap, reg_pairs[i].off, reg_pairs[i].val);\n\t\t}\n\n\t\t \n\t\tphy_pma_ln_vals = init_data->phy_pma_ln_vals[phy_t1][phy_t2][ssc];\n\t\tif (phy_pma_ln_vals) {\n\t\t\treg_pairs = phy_pma_ln_vals->reg_pairs;\n\t\t\tnum_regs = phy_pma_ln_vals->num_regs;\n\t\t\tfor (i = 0; i < num_lanes; i++) {\n\t\t\t\tregmap = sp->regmap_phy_pma_lane_cdb[i + mlane];\n\t\t\t\tfor (j = 0; j < num_regs; j++)\n\t\t\t\t\tregmap_write(regmap, reg_pairs[j].off, reg_pairs[j].val);\n\t\t\t}\n\t\t}\n\n\t\t \n\t\tpma_cmn_vals = init_data->pma_cmn_vals[phy_t1][phy_t2][ssc];\n\t\tif (pma_cmn_vals) {\n\t\t\treg_pairs = pma_cmn_vals->reg_pairs;\n\t\t\tnum_regs = pma_cmn_vals->num_regs;\n\t\t\tregmap = sp->regmap_common_cdb;\n\t\t\tfor (i = 0; i < num_regs; i++)\n\t\t\t\tregmap_write(regmap, reg_pairs[i].off, reg_pairs[i].val);\n\t\t}\n\n\t\t \n\t\tpma_ln_vals = init_data->pma_ln_vals[phy_t1][phy_t2][ssc];\n\t\tif (pma_ln_vals) {\n\t\t\treg_pairs = pma_ln_vals->reg_pairs;\n\t\t\tnum_regs = pma_ln_vals->num_regs;\n\t\t\tfor (i = 0; i < num_lanes; i++) {\n\t\t\t\tregmap = sp->regmap_lane_cdb[i + mlane];\n\t\t\t\tfor (j = 0; j < num_regs; j++)\n\t\t\t\t\tregmap_write(regmap, reg_pairs[j].off, reg_pairs[j].val);\n\t\t\t}\n\t\t}\n\n\t\tif (phy_t1 == TYPE_SGMII || phy_t1 == TYPE_QSGMII)\n\t\t\treset_control_deassert(sp->phys[node].lnk_rst);\n\t}\n\n\t \n\tret = reset_control_deassert(sp->phy_rst);\n\tif (ret)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nstatic int cdns_sierra_phy_probe(struct platform_device *pdev)\n{\n\tstruct cdns_sierra_phy *sp;\n\tstruct phy_provider *phy_provider;\n\tstruct device *dev = &pdev->dev;\n\tconst struct cdns_sierra_data *data;\n\tunsigned int id_value;\n\tint ret, node = 0;\n\tvoid __iomem *base;\n\tstruct device_node *dn = dev->of_node, *child;\n\n\tif (of_get_child_count(dn) == 0)\n\t\treturn -ENODEV;\n\n\t \n\tdata = of_device_get_match_data(dev);\n\tif (!data)\n\t\treturn -EINVAL;\n\n\tsp = devm_kzalloc(dev, struct_size(sp, clk_data.hws,\n\t\t\t\t\t   CDNS_SIERRA_OUTPUT_CLOCKS),\n\t\t\t  GFP_KERNEL);\n\tif (!sp)\n\t\treturn -ENOMEM;\n\tdev_set_drvdata(dev, sp);\n\tsp->dev = dev;\n\tsp->init_data = data;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base)) {\n\t\tdev_err(dev, \"missing \\\"reg\\\"\\n\");\n\t\treturn PTR_ERR(base);\n\t}\n\n\tret = cdns_regmap_init_blocks(sp, base, data->block_offset_shift,\n\t\t\t\t      data->reg_offset_shift);\n\tif (ret)\n\t\treturn ret;\n\n\tret = cdns_regfield_init(sp);\n\tif (ret)\n\t\treturn ret;\n\n\tplatform_set_drvdata(pdev, sp);\n\n\tret = cdns_sierra_phy_get_clocks(sp, dev);\n\tif (ret)\n\t\treturn ret;\n\n\tret = cdns_sierra_clk_register(sp);\n\tif (ret)\n\t\treturn ret;\n\n\tret = cdns_sierra_phy_enable_clocks(sp);\n\tif (ret)\n\t\tgoto unregister_clk;\n\n\tregmap_field_read(sp->pma_cmn_ready, &sp->already_configured);\n\n\tif (!sp->already_configured) {\n\t\tret = cdns_sierra_phy_clk(sp);\n\t\tif (ret)\n\t\t\tgoto clk_disable;\n\n\t\tret = cdns_sierra_phy_get_resets(sp, dev);\n\t\tif (ret)\n\t\t\tgoto clk_disable;\n\n\t\t \n\t\treset_control_deassert(sp->apb_rst);\n\t}\n\n\t \n\tregmap_field_read(sp->macro_id_type, &id_value);\n\tif  (sp->init_data->id_value != id_value) {\n\t\tret = -EINVAL;\n\t\tgoto ctrl_assert;\n\t}\n\n\tsp->autoconf = of_property_read_bool(dn, \"cdns,autoconf\");\n\n\tfor_each_available_child_of_node(dn, child) {\n\t\tstruct phy *gphy;\n\n\t\tif (!(of_node_name_eq(child, \"phy\") ||\n\t\t      of_node_name_eq(child, \"link\")))\n\t\t\tcontinue;\n\n\t\tsp->phys[node].lnk_rst =\n\t\t\tof_reset_control_array_get_exclusive(child);\n\n\t\tif (IS_ERR(sp->phys[node].lnk_rst)) {\n\t\t\tdev_err(dev, \"failed to get reset %s\\n\",\n\t\t\t\tchild->full_name);\n\t\t\tret = PTR_ERR(sp->phys[node].lnk_rst);\n\t\t\tof_node_put(child);\n\t\t\tgoto put_control;\n\t\t}\n\n\t\tif (!sp->autoconf) {\n\t\t\tret = cdns_sierra_get_optional(&sp->phys[node], child);\n\t\t\tif (ret) {\n\t\t\t\tdev_err(dev, \"missing property in node %s\\n\",\n\t\t\t\t\tchild->name);\n\t\t\t\tof_node_put(child);\n\t\t\t\treset_control_put(sp->phys[node].lnk_rst);\n\t\t\t\tgoto put_control;\n\t\t\t}\n\t\t}\n\n\t\tsp->num_lanes += sp->phys[node].num_lanes;\n\n\t\tif (!sp->already_configured)\n\t\t\tgphy = devm_phy_create(dev, child, &ops);\n\t\telse\n\t\t\tgphy = devm_phy_create(dev, child, &noop_ops);\n\t\tif (IS_ERR(gphy)) {\n\t\t\tret = PTR_ERR(gphy);\n\t\t\tof_node_put(child);\n\t\t\treset_control_put(sp->phys[node].lnk_rst);\n\t\t\tgoto put_control;\n\t\t}\n\t\tsp->phys[node].phy = gphy;\n\t\tphy_set_drvdata(gphy, &sp->phys[node]);\n\n\t\tnode++;\n\t}\n\tsp->nsubnodes = node;\n\n\tif (sp->num_lanes > SIERRA_MAX_LANES) {\n\t\tret = -EINVAL;\n\t\tdev_err(dev, \"Invalid lane configuration\\n\");\n\t\tgoto put_control;\n\t}\n\n\t \n\tif (!sp->already_configured && !sp->autoconf && sp->nsubnodes > 1) {\n\t\tret = cdns_sierra_phy_configure_multilink(sp);\n\t\tif (ret)\n\t\t\tgoto put_control;\n\t}\n\n\tpm_runtime_enable(dev);\n\tphy_provider = devm_of_phy_provider_register(dev, of_phy_simple_xlate);\n\tif (IS_ERR(phy_provider)) {\n\t\tret = PTR_ERR(phy_provider);\n\t\tgoto put_control;\n\t}\n\n\treturn 0;\n\nput_control:\n\twhile (--node >= 0)\n\t\treset_control_put(sp->phys[node].lnk_rst);\nctrl_assert:\n\tif (!sp->already_configured)\n\t\treset_control_assert(sp->apb_rst);\nclk_disable:\n\tcdns_sierra_phy_disable_clocks(sp);\nunregister_clk:\n\tcdns_sierra_clk_unregister(sp);\n\treturn ret;\n}\n\nstatic void cdns_sierra_phy_remove(struct platform_device *pdev)\n{\n\tstruct cdns_sierra_phy *phy = platform_get_drvdata(pdev);\n\tint i;\n\n\treset_control_assert(phy->phy_rst);\n\treset_control_assert(phy->apb_rst);\n\tpm_runtime_disable(&pdev->dev);\n\n\tcdns_sierra_phy_disable_clocks(phy);\n\t \n\tfor (i = 0; i < phy->nsubnodes; i++) {\n\t\treset_control_assert(phy->phys[i].lnk_rst);\n\t\treset_control_put(phy->phys[i].lnk_rst);\n\t}\n\n\tcdns_sierra_clk_unregister(phy);\n}\n\n \nstatic struct cdns_reg_pairs sgmii_phy_pma_ln_regs[] = {\n\t{0x9010, SIERRA_PHY_PMA_XCVR_CTRL}\n};\n\nstatic struct cdns_sierra_vals sgmii_phy_pma_ln_vals = {\n\t.reg_pairs = sgmii_phy_pma_ln_regs,\n\t.num_regs = ARRAY_SIZE(sgmii_phy_pma_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs sgmii_100_no_ssc_plllc1_opt3_cmn_regs[] = {\n\t{0x002D, SIERRA_CMN_PLLLC1_FBDIV_INT_PREG},\n\t{0x2085, SIERRA_CMN_PLLLC1_LF_COEFF_MODE0_PREG},\n\t{0x1005, SIERRA_CMN_PLLLC1_CLK0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC1_BWCAL_MODE0_PREG},\n\t{0x0800, SIERRA_CMN_PLLLC1_SS_TIME_STEPSIZE_MODE_PREG}\n};\n\nstatic const struct cdns_reg_pairs sgmii_100_no_ssc_plllc1_opt3_ln_regs[] = {\n\t{0x688E, SIERRA_DET_STANDEC_D_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x0FFE, SIERRA_PSC_RX_A0_PREG},\n\t{0x0106, SIERRA_PLLCTRL_FBDIV_MODE01_PREG},\n\t{0x0013, SIERRA_PLLCTRL_SUBRATE_PREG},\n\t{0x0003, SIERRA_PLLCTRL_GEN_A_PREG},\n\t{0x0106, SIERRA_PLLCTRL_GEN_D_PREG},\n\t{0x5231, SIERRA_PLLCTRL_CPGAIN_MODE_PREG },\n\t{0x0000, SIERRA_DRVCTRL_ATTEN_PREG},\n\t{0x9702, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x0051, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x3C0E, SIERRA_CREQ_CCLKDET_MODE01_PREG},\n\t{0x3220, SIERRA_CREQ_FSMCLK_SEL_PREG},\n\t{0x0000, SIERRA_CREQ_EQ_CTRL_PREG},\n\t{0x0002, SIERRA_DEQ_PHALIGN_CTRL},\n\t{0x0186, SIERRA_DEQ_GLUT0},\n\t{0x0186, SIERRA_DEQ_GLUT1},\n\t{0x0186, SIERRA_DEQ_GLUT2},\n\t{0x0186, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x0861, SIERRA_DEQ_ALUT0},\n\t{0x07E0, SIERRA_DEQ_ALUT1},\n\t{0x079E, SIERRA_DEQ_ALUT2},\n\t{0x071D, SIERRA_DEQ_ALUT3},\n\t{0x03F5, SIERRA_DEQ_DFETAP_CTRL_PREG},\n\t{0x0C01, SIERRA_DEQ_TAU_CTRL1_FAST_MAINT_PREG},\n\t{0x3C40, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C04, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0033, SIERRA_DEQ_PICTRL_PREG},\n\t{0x0000, SIERRA_CPI_OUTBUF_RATESEL_PREG},\n\t{0x0B6D, SIERRA_CPI_RESBIAS_BIN_PREG},\n\t{0x0102, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x0002, SIERRA_RXBUFFER_RCDFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals sgmii_100_no_ssc_plllc1_opt3_cmn_vals = {\n\t.reg_pairs = sgmii_100_no_ssc_plllc1_opt3_cmn_regs,\n\t.num_regs = ARRAY_SIZE(sgmii_100_no_ssc_plllc1_opt3_cmn_regs),\n};\n\nstatic struct cdns_sierra_vals sgmii_100_no_ssc_plllc1_opt3_ln_vals = {\n\t.reg_pairs = sgmii_100_no_ssc_plllc1_opt3_ln_regs,\n\t.num_regs = ARRAY_SIZE(sgmii_100_no_ssc_plllc1_opt3_ln_regs),\n};\n\n \nstatic struct cdns_reg_pairs qsgmii_phy_pma_ln_regs[] = {\n\t{0x9010, SIERRA_PHY_PMA_XCVR_CTRL}\n};\n\nstatic struct cdns_sierra_vals qsgmii_phy_pma_ln_vals = {\n\t.reg_pairs = qsgmii_phy_pma_ln_regs,\n\t.num_regs = ARRAY_SIZE(qsgmii_phy_pma_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs qsgmii_100_no_ssc_plllc1_cmn_regs[] = {\n\t{0x2085, SIERRA_CMN_PLLLC1_LF_COEFF_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC1_BWCAL_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC1_SS_TIME_STEPSIZE_MODE_PREG}\n};\n\nstatic const struct cdns_reg_pairs qsgmii_100_no_ssc_plllc1_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x0252, SIERRA_DET_STANDEC_E_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x0FFE, SIERRA_PSC_RX_A0_PREG},\n\t{0x0011, SIERRA_PLLCTRL_SUBRATE_PREG},\n\t{0x0001, SIERRA_PLLCTRL_GEN_A_PREG},\n\t{0x5233, SIERRA_PLLCTRL_CPGAIN_MODE_PREG},\n\t{0x0000, SIERRA_DRVCTRL_ATTEN_PREG},\n\t{0x0089, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x3C3C, SIERRA_CREQ_CCLKDET_MODE01_PREG},\n\t{0x3222, SIERRA_CREQ_FSMCLK_SEL_PREG},\n\t{0x0000, SIERRA_CREQ_EQ_CTRL_PREG},\n\t{0x8422, SIERRA_CTLELUT_CTRL_PREG},\n\t{0x4111, SIERRA_DFE_ECMP_RATESEL_PREG},\n\t{0x4111, SIERRA_DFE_SMP_RATESEL_PREG},\n\t{0x0002, SIERRA_DEQ_PHALIGN_CTRL},\n\t{0x9595, SIERRA_DEQ_VGATUNE_CTRL_PREG},\n\t{0x0186, SIERRA_DEQ_GLUT0},\n\t{0x0186, SIERRA_DEQ_GLUT1},\n\t{0x0186, SIERRA_DEQ_GLUT2},\n\t{0x0186, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x0861, SIERRA_DEQ_ALUT0},\n\t{0x07E0, SIERRA_DEQ_ALUT1},\n\t{0x079E, SIERRA_DEQ_ALUT2},\n\t{0x071D, SIERRA_DEQ_ALUT3},\n\t{0x03F5, SIERRA_DEQ_DFETAP_CTRL_PREG},\n\t{0x0C01, SIERRA_DEQ_TAU_CTRL1_FAST_MAINT_PREG},\n\t{0x3C40, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C04, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0033, SIERRA_DEQ_PICTRL_PREG},\n\t{0x0660, SIERRA_CPICAL_TMRVAL_MODE0_PREG},\n\t{0x00D5, SIERRA_CPI_OUTBUF_RATESEL_PREG},\n\t{0x0B6D, SIERRA_CPI_RESBIAS_BIN_PREG},\n\t{0x0102, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x0002, SIERRA_RXBUFFER_RCDFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals qsgmii_100_no_ssc_plllc1_cmn_vals = {\n\t.reg_pairs = qsgmii_100_no_ssc_plllc1_cmn_regs,\n\t.num_regs = ARRAY_SIZE(qsgmii_100_no_ssc_plllc1_cmn_regs),\n};\n\nstatic struct cdns_sierra_vals qsgmii_100_no_ssc_plllc1_ln_vals = {\n\t.reg_pairs = qsgmii_100_no_ssc_plllc1_ln_regs,\n\t.num_regs = ARRAY_SIZE(qsgmii_100_no_ssc_plllc1_ln_regs),\n};\n\n \nstatic struct cdns_reg_pairs pcie_phy_pcs_cmn_regs[] = {\n\t{0x0430, SIERRA_PHY_PIPE_CMN_CTRL1}\n};\n\nstatic struct cdns_sierra_vals pcie_phy_pcs_cmn_vals = {\n\t.reg_pairs = pcie_phy_pcs_cmn_regs,\n\t.num_regs = ARRAY_SIZE(pcie_phy_pcs_cmn_regs),\n};\n\n \nstatic const struct cdns_reg_pairs pcie_100_no_ssc_plllc_cmn_regs[] = {\n\t{0x2105, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x2105, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs ml_pcie_100_no_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x8055, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x80BB, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x8351, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x8349, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_no_ssc_plllc_cmn_vals = {\n\t.reg_pairs = pcie_100_no_ssc_plllc_cmn_regs,\n\t.num_regs = ARRAY_SIZE(pcie_100_no_ssc_plllc_cmn_regs),\n};\n\nstatic struct cdns_sierra_vals ml_pcie_100_no_ssc_ln_vals = {\n\t.reg_pairs = ml_pcie_100_no_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ml_pcie_100_no_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs ti_ml_pcie_100_no_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x8055, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x80BB, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x8351, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x8349, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG},\n\t{0x0002, SIERRA_TX_RCVDET_OVRD_PREG}\n};\n\nstatic struct cdns_sierra_vals ti_ml_pcie_100_no_ssc_ln_vals = {\n\t.reg_pairs = ti_ml_pcie_100_no_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ti_ml_pcie_100_no_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs pcie_100_int_ssc_plllc_cmn_regs[] = {\n\t{0x000E, SIERRA_CMN_PLLLC_MODE_PREG},\n\t{0x4006, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x4006, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x0581, SIERRA_CMN_PLLLC_DSMCORR_PREG},\n\t{0x7F80, SIERRA_CMN_PLLLC_SS_PREG},\n\t{0x0041, SIERRA_CMN_PLLLC_SS_AMP_STEP_SIZE_PREG},\n\t{0x0464, SIERRA_CMN_PLLLC_SSTWOPT_PREG},\n\t{0x0D0D, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG},\n\t{0x0060, SIERRA_CMN_PLLLC_LOCK_DELAY_CTRL_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs ml_pcie_100_int_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_int_ssc_plllc_cmn_vals = {\n\t.reg_pairs = pcie_100_int_ssc_plllc_cmn_regs,\n\t.num_regs = ARRAY_SIZE(pcie_100_int_ssc_plllc_cmn_regs),\n};\n\nstatic struct cdns_sierra_vals ml_pcie_100_int_ssc_ln_vals = {\n\t.reg_pairs = ml_pcie_100_int_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ml_pcie_100_int_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs ti_ml_pcie_100_int_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG},\n\t{0x0002, SIERRA_TX_RCVDET_OVRD_PREG}\n};\n\nstatic struct cdns_sierra_vals ti_ml_pcie_100_int_ssc_ln_vals = {\n\t.reg_pairs = ti_ml_pcie_100_int_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ti_ml_pcie_100_int_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs pcie_100_ext_ssc_plllc_cmn_regs[] = {\n\t{0x2106, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x2106, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x1B1B, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs ml_pcie_100_ext_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_ext_ssc_plllc_cmn_vals = {\n\t.reg_pairs = pcie_100_ext_ssc_plllc_cmn_regs,\n\t.num_regs = ARRAY_SIZE(pcie_100_ext_ssc_plllc_cmn_regs),\n};\n\nstatic struct cdns_sierra_vals ml_pcie_100_ext_ssc_ln_vals = {\n\t.reg_pairs = ml_pcie_100_ext_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ml_pcie_100_ext_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs ti_ml_pcie_100_ext_ssc_ln_regs[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x0004, SIERRA_PSC_LN_A3_PREG},\n\t{0x0004, SIERRA_PSC_LN_A4_PREG},\n\t{0x0004, SIERRA_PSC_LN_IDLE_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG},\n\t{0x0002, SIERRA_TX_RCVDET_OVRD_PREG}\n};\n\nstatic struct cdns_sierra_vals ti_ml_pcie_100_ext_ssc_ln_vals = {\n\t.reg_pairs = ti_ml_pcie_100_ext_ssc_ln_regs,\n\t.num_regs = ARRAY_SIZE(ti_ml_pcie_100_ext_ssc_ln_regs),\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_cmn_regs_no_ssc[] = {\n\t{0x2105, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x2105, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_ln_regs_no_ssc[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x8055, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x80BB, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x8351, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x8349, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_no_ssc_cmn_vals = {\n\t.reg_pairs = cdns_pcie_cmn_regs_no_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_cmn_regs_no_ssc),\n};\n\nstatic struct cdns_sierra_vals pcie_100_no_ssc_ln_vals = {\n\t.reg_pairs = cdns_pcie_ln_regs_no_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_ln_regs_no_ssc),\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_cmn_regs_int_ssc[] = {\n\t{0x000E, SIERRA_CMN_PLLLC_MODE_PREG},\n\t{0x4006, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x4006, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x0581, SIERRA_CMN_PLLLC_DSMCORR_PREG},\n\t{0x7F80, SIERRA_CMN_PLLLC_SS_PREG},\n\t{0x0041, SIERRA_CMN_PLLLC_SS_AMP_STEP_SIZE_PREG},\n\t{0x0464, SIERRA_CMN_PLLLC_SSTWOPT_PREG},\n\t{0x0D0D, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG},\n\t{0x0060, SIERRA_CMN_PLLLC_LOCK_DELAY_CTRL_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_ln_regs_int_ssc[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_int_ssc_cmn_vals = {\n\t.reg_pairs = cdns_pcie_cmn_regs_int_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_cmn_regs_int_ssc),\n};\n\nstatic struct cdns_sierra_vals pcie_100_int_ssc_ln_vals = {\n\t.reg_pairs = cdns_pcie_ln_regs_int_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_ln_regs_int_ssc),\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_cmn_regs_ext_ssc[] = {\n\t{0x2106, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x2106, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE1_PREG},\n\t{0x8A06, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x1B1B, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs cdns_pcie_ln_regs_ext_ssc[] = {\n\t{0xFC08, SIERRA_DET_STANDEC_A_PREG},\n\t{0x001D, SIERRA_PSM_A3IN_TMR_PREG},\n\t{0x1555, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x9703, SIERRA_DRVCTRL_BOOST_PREG},\n\t{0x813E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x8047, SIERRA_RX_CREQ_FLTR_A_MODE3_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE2_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x808F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x0002, SIERRA_CREQ_DCBIASATTEN_OVR_PREG},\n\t{0x9800, SIERRA_RX_CTLE_CAL_PREG},\n\t{0x033C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x44CC, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x5624, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x000F, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x00FF, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x4C4C, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02FA, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x0041, SIERRA_DEQ_GLUT0},\n\t{0x0082, SIERRA_DEQ_GLUT1},\n\t{0x00C3, SIERRA_DEQ_GLUT2},\n\t{0x0145, SIERRA_DEQ_GLUT3},\n\t{0x0186, SIERRA_DEQ_GLUT4},\n\t{0x09E7, SIERRA_DEQ_ALUT0},\n\t{0x09A6, SIERRA_DEQ_ALUT1},\n\t{0x0965, SIERRA_DEQ_ALUT2},\n\t{0x08E3, SIERRA_DEQ_ALUT3},\n\t{0x00FA, SIERRA_DEQ_DFETAP0},\n\t{0x00FA, SIERRA_DEQ_DFETAP1},\n\t{0x00FA, SIERRA_DEQ_DFETAP2},\n\t{0x00FA, SIERRA_DEQ_DFETAP3},\n\t{0x00FA, SIERRA_DEQ_DFETAP4},\n\t{0x000F, SIERRA_DEQ_PRECUR_PREG},\n\t{0x0280, SIERRA_DEQ_POSTCUR_PREG},\n\t{0x8F00, SIERRA_DEQ_POSTCUR_DECR_PREG},\n\t{0x3C0F, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C0C, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0100, SIERRA_DEQ_TAU_CTRL3_PREG},\n\t{0x5E82, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x002B, SIERRA_CPI_TRIM_PREG},\n\t{0x0003, SIERRA_EPI_CTRL_PREG},\n\t{0x803F, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x0004, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x2010, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4432, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals pcie_100_ext_ssc_cmn_vals = {\n\t.reg_pairs = cdns_pcie_cmn_regs_ext_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_cmn_regs_ext_ssc),\n};\n\nstatic struct cdns_sierra_vals pcie_100_ext_ssc_ln_vals = {\n\t.reg_pairs = cdns_pcie_ln_regs_ext_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_pcie_ln_regs_ext_ssc),\n};\n\n \nstatic const struct cdns_reg_pairs cdns_usb_cmn_regs_ext_ssc[] = {\n\t{0x2085, SIERRA_CMN_PLLLC_LF_COEFF_MODE1_PREG},\n\t{0x2085, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG}\n};\n\n \nstatic const struct cdns_reg_pairs cdns_usb_ln_regs_ext_ssc[] = {\n\t{0xFE0A, SIERRA_DET_STANDEC_A_PREG},\n\t{0x000F, SIERRA_DET_STANDEC_B_PREG},\n\t{0x55A5, SIERRA_DET_STANDEC_C_PREG},\n\t{0x69ad, SIERRA_DET_STANDEC_D_PREG},\n\t{0x0241, SIERRA_DET_STANDEC_E_PREG},\n\t{0x0110, SIERRA_PSM_LANECAL_DLY_A1_RESETS_PREG},\n\t{0x0014, SIERRA_PSM_A0IN_TMR_PREG},\n\t{0xCF00, SIERRA_PSM_DIAG_PREG},\n\t{0x001F, SIERRA_PSC_TX_A0_PREG},\n\t{0x0007, SIERRA_PSC_TX_A1_PREG},\n\t{0x0003, SIERRA_PSC_TX_A2_PREG},\n\t{0x0003, SIERRA_PSC_TX_A3_PREG},\n\t{0x0FFF, SIERRA_PSC_RX_A0_PREG},\n\t{0x0003, SIERRA_PSC_RX_A1_PREG},\n\t{0x0003, SIERRA_PSC_RX_A2_PREG},\n\t{0x0001, SIERRA_PSC_RX_A3_PREG},\n\t{0x0001, SIERRA_PLLCTRL_SUBRATE_PREG},\n\t{0x0406, SIERRA_PLLCTRL_GEN_D_PREG},\n\t{0x5233, SIERRA_PLLCTRL_CPGAIN_MODE_PREG},\n\t{0x00CA, SIERRA_CLKPATH_BIASTRIM_PREG},\n\t{0x2512, SIERRA_DFE_BIASTRIM_PREG},\n\t{0x0000, SIERRA_DRVCTRL_ATTEN_PREG},\n\t{0x823E, SIERRA_CLKPATHCTRL_TMR_PREG},\n\t{0x078F, SIERRA_RX_CREQ_FLTR_A_MODE1_PREG},\n\t{0x078F, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x7B3C, SIERRA_CREQ_CCLKDET_MODE01_PREG},\n\t{0x023C, SIERRA_RX_CTLE_MAINTENANCE_PREG},\n\t{0x3232, SIERRA_CREQ_FSMCLK_SEL_PREG},\n\t{0x0000, SIERRA_CREQ_EQ_CTRL_PREG},\n\t{0x0000, SIERRA_CREQ_SPARE_PREG},\n\t{0xCC44, SIERRA_CREQ_EQ_OPEN_EYE_THRESH_PREG},\n\t{0x8452, SIERRA_CTLELUT_CTRL_PREG},\n\t{0x4121, SIERRA_DFE_ECMP_RATESEL_PREG},\n\t{0x4121, SIERRA_DFE_SMP_RATESEL_PREG},\n\t{0x0003, SIERRA_DEQ_PHALIGN_CTRL},\n\t{0x3200, SIERRA_DEQ_CONCUR_CTRL1_PREG},\n\t{0x5064, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x0030, SIERRA_DEQ_EPIPWR_CTRL2_PREG},\n\t{0x0048, SIERRA_DEQ_FAST_MAINT_CYCLES_PREG},\n\t{0x5A5A, SIERRA_DEQ_ERRCMP_CTRL_PREG},\n\t{0x02F5, SIERRA_DEQ_OFFSET_CTRL_PREG},\n\t{0x02F5, SIERRA_DEQ_GAIN_CTRL_PREG},\n\t{0x9999, SIERRA_DEQ_VGATUNE_CTRL_PREG},\n\t{0x0014, SIERRA_DEQ_GLUT0},\n\t{0x0014, SIERRA_DEQ_GLUT1},\n\t{0x0014, SIERRA_DEQ_GLUT2},\n\t{0x0014, SIERRA_DEQ_GLUT3},\n\t{0x0014, SIERRA_DEQ_GLUT4},\n\t{0x0014, SIERRA_DEQ_GLUT5},\n\t{0x0014, SIERRA_DEQ_GLUT6},\n\t{0x0014, SIERRA_DEQ_GLUT7},\n\t{0x0014, SIERRA_DEQ_GLUT8},\n\t{0x0014, SIERRA_DEQ_GLUT9},\n\t{0x0014, SIERRA_DEQ_GLUT10},\n\t{0x0014, SIERRA_DEQ_GLUT11},\n\t{0x0014, SIERRA_DEQ_GLUT12},\n\t{0x0014, SIERRA_DEQ_GLUT13},\n\t{0x0014, SIERRA_DEQ_GLUT14},\n\t{0x0014, SIERRA_DEQ_GLUT15},\n\t{0x0014, SIERRA_DEQ_GLUT16},\n\t{0x0BAE, SIERRA_DEQ_ALUT0},\n\t{0x0AEB, SIERRA_DEQ_ALUT1},\n\t{0x0A28, SIERRA_DEQ_ALUT2},\n\t{0x0965, SIERRA_DEQ_ALUT3},\n\t{0x08A2, SIERRA_DEQ_ALUT4},\n\t{0x07DF, SIERRA_DEQ_ALUT5},\n\t{0x071C, SIERRA_DEQ_ALUT6},\n\t{0x0659, SIERRA_DEQ_ALUT7},\n\t{0x0596, SIERRA_DEQ_ALUT8},\n\t{0x0514, SIERRA_DEQ_ALUT9},\n\t{0x0492, SIERRA_DEQ_ALUT10},\n\t{0x0410, SIERRA_DEQ_ALUT11},\n\t{0x038E, SIERRA_DEQ_ALUT12},\n\t{0x030C, SIERRA_DEQ_ALUT13},\n\t{0x03F4, SIERRA_DEQ_DFETAP_CTRL_PREG},\n\t{0x0001, SIERRA_DFE_EN_1010_IGNORE_PREG},\n\t{0x3C01, SIERRA_DEQ_TAU_CTRL1_FAST_MAINT_PREG},\n\t{0x3C40, SIERRA_DEQ_TAU_CTRL1_SLOW_MAINT_PREG},\n\t{0x1C08, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0033, SIERRA_DEQ_PICTRL_PREG},\n\t{0x0400, SIERRA_CPICAL_TMRVAL_MODE1_PREG},\n\t{0x0330, SIERRA_CPICAL_TMRVAL_MODE0_PREG},\n\t{0x01FF, SIERRA_CPICAL_PICNT_MODE1_PREG},\n\t{0x0009, SIERRA_CPI_OUTBUF_RATESEL_PREG},\n\t{0x3232, SIERRA_CPICAL_RES_STARTCODE_MODE23_PREG},\n\t{0x0005, SIERRA_LFPSDET_SUPPORT_PREG},\n\t{0x000F, SIERRA_LFPSFILT_NS_PREG},\n\t{0x0009, SIERRA_LFPSFILT_RD_PREG},\n\t{0x0001, SIERRA_LFPSFILT_MP_PREG},\n\t{0x6013, SIERRA_SIGDET_SUPPORT_PREG},\n\t{0x8013, SIERRA_SDFILT_H2L_A_PREG},\n\t{0x8009, SIERRA_SDFILT_L2H_PREG},\n\t{0x0024, SIERRA_RXBUFFER_CTLECTRL_PREG},\n\t{0x0020, SIERRA_RXBUFFER_RCDFECTRL_PREG},\n\t{0x4243, SIERRA_RXBUFFER_DFECTRL_PREG}\n};\n\nstatic struct cdns_sierra_vals usb_100_ext_ssc_cmn_vals = {\n\t.reg_pairs = cdns_usb_cmn_regs_ext_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_usb_cmn_regs_ext_ssc),\n};\n\nstatic struct cdns_sierra_vals usb_100_ext_ssc_ln_vals = {\n\t.reg_pairs = cdns_usb_ln_regs_ext_ssc,\n\t.num_regs = ARRAY_SIZE(cdns_usb_ln_regs_ext_ssc),\n};\n\n \nstatic const struct cdns_reg_pairs sgmii_pma_cmn_vals[] = {\n\t{0x0180, SIERRA_SDOSCCAL_CLK_CNT_PREG},\n\t{0x6000, SIERRA_CMN_REFRCV_PREG},\n\t{0x0031, SIERRA_CMN_RESCAL_CTRLA_PREG},\n\t{0x001C, SIERRA_CMN_PLLLC_FBDIV_INT_MODE0_PREG},\n\t{0x2106, SIERRA_CMN_PLLLC_LF_COEFF_MODE0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_LOCKSEARCH_PREG},\n\t{0x8103, SIERRA_CMN_PLLLC_CLK0_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_BWCAL_MODE0_PREG},\n\t{0x0027, SIERRA_CMN_PLLCSM_PLLEN_TMR_PREG},\n\t{0x0062, SIERRA_CMN_PLLCSM_PLLPRE_TMR_PREG},\n\t{0x0800, SIERRA_CMN_PLLLC_SS_TIME_STEPSIZE_MODE_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_INIT_PREG},\n\t{0x0000, SIERRA_CMN_PLLLC_ITERTMR_PREG},\n\t{0x0020, SIERRA_CMN_PLLLC_LOCK_CNTSTART_PREG},\n\t{0x0013, SIERRA_CMN_PLLLC_DCOCAL_CTRL_PREG},\n\t{0x0013, SIERRA_CMN_PLLLC1_DCOCAL_CTRL_PREG},\n};\n\nstatic struct cdns_sierra_vals sgmii_cmn_vals = {\n\t.reg_pairs = sgmii_pma_cmn_vals,\n\t.num_regs = ARRAY_SIZE(sgmii_pma_cmn_vals),\n};\n\n \nstatic const struct cdns_reg_pairs sgmii_ln_regs[] = {\n\t{0x691E, SIERRA_DET_STANDEC_D_PREG},\n\t{0x0FFE, SIERRA_PSC_RX_A0_PREG},\n\t{0x0104, SIERRA_PLLCTRL_FBDIV_MODE01_PREG},\n\t{0x0013, SIERRA_PLLCTRL_SUBRATE_PREG},\n\t{0x0106, SIERRA_PLLCTRL_GEN_D_PREG},\n\t{0x5234, SIERRA_PLLCTRL_CPGAIN_MODE_PREG},\n\t{0x0000, SIERRA_DRVCTRL_ATTEN_PREG},\n\t{0x00AB, SIERRA_RX_CREQ_FLTR_A_MODE0_PREG},\n\t{0x3C0E, SIERRA_CREQ_CCLKDET_MODE01_PREG},\n\t{0x3220, SIERRA_CREQ_FSMCLK_SEL_PREG},\n\t{0x0000, SIERRA_CREQ_EQ_CTRL_PREG},\n\t{0x6320, SIERRA_DEQ_CONCUR_EPIOFFSET_MODE_PREG},\n\t{0x0000, SIERRA_CPI_OUTBUF_RATESEL_PREG},\n\t{0x15A2, SIERRA_LN_SPARE_REG_PREG},\n\t{0x7900, SIERRA_DEQ_BLK_TAU_CTRL1_PREG},\n\t{0x2202, SIERRA_DEQ_BLK_TAU_CTRL4_PREG},\n\t{0x2206, SIERRA_DEQ_TAU_CTRL2_PREG},\n\t{0x0005, SIERRA_LANE_TX_RECEIVER_DETECT_PREG},\n\t{0x8001, SIERRA_CREQ_SPARE_PREG},\n\t{0x0000, SIERRA_DEQ_CONCUR_CTRL1_PREG},\n\t{0xD004, SIERRA_DEQ_CONCUR_CTRL2_PREG},\n\t{0x0101, SIERRA_DEQ_GLUT9},\n\t{0x0101, SIERRA_DEQ_GLUT10},\n\t{0x0101, SIERRA_DEQ_GLUT11},\n\t{0x0101, SIERRA_DEQ_GLUT12},\n\t{0x0000, SIERRA_DEQ_GLUT13},\n\t{0x0000, SIERRA_DEQ_GLUT16},\n\t{0x0000, SIERRA_POSTPRECUR_EN_CEPH_CTRL_PREG},\n\t{0x0000, SIERRA_TAU_EN_CEPH2TO0_PREG},\n\t{0x0003, SIERRA_TAU_EN_CEPH5TO3_PREG},\n\t{0x0101, SIERRA_DEQ_ALUT8},\n\t{0x0101, SIERRA_DEQ_ALUT9},\n\t{0x0100, SIERRA_DEQ_ALUT10},\n\t{0x0000, SIERRA_OEPH_EN_CTRL_PREG},\n\t{0x5425, SIERRA_DEQ_OPENEYE_CTRL_PREG},\n\t{0x7458, SIERRA_CPICAL_RES_STARTCODE_MODE23_PREG},\n\t{0x321F, SIERRA_CPICAL_RES_STARTCODE_MODE01_PREG},\n};\n\nstatic struct cdns_sierra_vals sgmii_pma_ln_vals = {\n\t.reg_pairs = sgmii_ln_regs,\n\t.num_regs = ARRAY_SIZE(sgmii_ln_regs),\n};\n\nstatic const struct cdns_sierra_data cdns_map_sierra = {\n\t.id_value = SIERRA_MACRO_ID,\n\t.block_offset_shift = 0x2,\n\t.reg_offset_shift = 0x2,\n\t.pcs_cmn_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t},\n\t},\n\t.pma_cmn_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_plllc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_plllc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_plllc_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_plllc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_plllc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_plllc_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_USB] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[EXTERNAL_SSC] = &usb_100_ext_ssc_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_SGMII] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &sgmii_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_QSGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t},\n\t\t},\n\t},\n\t.pma_ln_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &ml_pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &ml_pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &ml_pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &ml_pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &ml_pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &ml_pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_USB] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[EXTERNAL_SSC] = &usb_100_ext_ssc_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_SGMII] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &sgmii_pma_ln_vals,\n\t\t\t},\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_QSGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t},\n\t\t},\n\t},\n};\n\nstatic const struct cdns_sierra_data cdns_ti_map_sierra = {\n\t.id_value = SIERRA_MACRO_ID,\n\t.block_offset_shift = 0x0,\n\t.reg_offset_shift = 0x1,\n\t.pcs_cmn_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_phy_pcs_cmn_vals,\n\t\t\t},\n\t\t},\n\t},\n\t.phy_pma_ln_vals = {\n\t\t[TYPE_SGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &sgmii_phy_pma_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &sgmii_phy_pma_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &sgmii_phy_pma_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_QSGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &qsgmii_phy_pma_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &qsgmii_phy_pma_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &qsgmii_phy_pma_ln_vals,\n\t\t\t},\n\t\t},\n\t},\n\t.pma_cmn_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_plllc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_plllc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_plllc_cmn_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_plllc_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_plllc_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_plllc_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_USB] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[EXTERNAL_SSC] = &usb_100_ext_ssc_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_SGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_cmn_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_QSGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t\t[EXTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t\t[INTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_cmn_vals,\n\t\t\t},\n\t\t},\n\t},\n\t.pma_ln_vals = {\n\t\t[TYPE_PCIE] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[NO_SSC] = &pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t\t[TYPE_SGMII] = {\n\t\t\t\t[NO_SSC] = &ti_ml_pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &ti_ml_pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &ti_ml_pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t\t[TYPE_QSGMII] = {\n\t\t\t\t[NO_SSC] = &ti_ml_pcie_100_no_ssc_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &ti_ml_pcie_100_ext_ssc_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &ti_ml_pcie_100_int_ssc_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_USB] = {\n\t\t\t[TYPE_NONE] = {\n\t\t\t\t[EXTERNAL_SSC] = &usb_100_ext_ssc_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_SGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &sgmii_100_no_ssc_plllc1_opt3_ln_vals,\n\t\t\t},\n\t\t},\n\t\t[TYPE_QSGMII] = {\n\t\t\t[TYPE_PCIE] = {\n\t\t\t\t[NO_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t\t[EXTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t\t[INTERNAL_SSC] = &qsgmii_100_no_ssc_plllc1_ln_vals,\n\t\t\t},\n\t\t},\n\t},\n};\n\nstatic const struct of_device_id cdns_sierra_id_table[] = {\n\t{\n\t\t.compatible = \"cdns,sierra-phy-t0\",\n\t\t.data = &cdns_map_sierra,\n\t},\n\t{\n\t\t.compatible = \"ti,sierra-phy-t0\",\n\t\t.data = &cdns_ti_map_sierra,\n\t},\n\t{}\n};\nMODULE_DEVICE_TABLE(of, cdns_sierra_id_table);\n\nstatic struct platform_driver cdns_sierra_driver = {\n\t.probe\t\t= cdns_sierra_phy_probe,\n\t.remove_new\t= cdns_sierra_phy_remove,\n\t.driver\t\t= {\n\t\t.name\t= \"cdns-sierra-phy\",\n\t\t.of_match_table = cdns_sierra_id_table,\n\t},\n};\nmodule_platform_driver(cdns_sierra_driver);\n\nMODULE_ALIAS(\"platform:cdns_sierra\");\nMODULE_AUTHOR(\"Cadence Design Systems\");\nMODULE_DESCRIPTION(\"CDNS sierra phy driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}