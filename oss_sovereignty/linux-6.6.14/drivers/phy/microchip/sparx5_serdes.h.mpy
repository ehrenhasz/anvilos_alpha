{
  "module_name": "sparx5_serdes.h",
  "hash_id": "52f10dd8451af6761f0718d6f14eb685dce76c2f3558ee93832550f8e25efcc5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/phy/microchip/sparx5_serdes.h",
  "human_readable_source": " \n\n#ifndef _SPARX5_SERDES_H_\n#define _SPARX5_SERDES_H_\n\n#include \"sparx5_serdes_regs.h\"\n\n#define SPX5_SERDES_MAX       33\n\nenum sparx5_serdes_type {\n\tSPX5_SDT_6G  = 6,\n\tSPX5_SDT_10G = 10,\n\tSPX5_SDT_25G = 25,\n};\n\nenum sparx5_serdes_mode {\n\tSPX5_SD_MODE_NONE,\n\tSPX5_SD_MODE_2G5,\n\tSPX5_SD_MODE_QSGMII,\n\tSPX5_SD_MODE_100FX,\n\tSPX5_SD_MODE_1000BASEX,\n\tSPX5_SD_MODE_SFI,\n};\n\nstruct sparx5_serdes_private {\n\tstruct device *dev;\n\tvoid __iomem *regs[NUM_TARGETS];\n\tstruct phy *phys[SPX5_SERDES_MAX];\n\tunsigned long coreclock;\n};\n\nstruct sparx5_serdes_macro {\n\tstruct sparx5_serdes_private *priv;\n\tu32 sidx;\n\tu32 stpidx;\n\tenum sparx5_serdes_type serdestype;\n\tenum sparx5_serdes_mode serdesmode;\n\tphy_interface_t portmode;\n\tint speed;\n\tenum phy_media media;\n};\n\n \nstatic inline void __iomem *sdx5_addr(void __iomem *base[],\n\t\t\t\t      int id, int tinst, int tcnt,\n\t\t\t\t      int gbase, int ginst,\n\t\t\t\t      int gcnt, int gwidth,\n\t\t\t\t      int raddr, int rinst,\n\t\t\t\t      int rcnt, int rwidth)\n{\n\tWARN_ON((tinst) >= tcnt);\n\tWARN_ON((ginst) >= gcnt);\n\tWARN_ON((rinst) >= rcnt);\n\treturn base[id + (tinst)] +\n\t\tgbase + ((ginst) * gwidth) +\n\t\traddr + ((rinst) * rwidth);\n}\n\nstatic inline void __iomem *sdx5_inst_baseaddr(void __iomem *base,\n\t\t\t\t\t       int gbase, int ginst,\n\t\t\t\t\t       int gcnt, int gwidth,\n\t\t\t\t\t       int raddr, int rinst,\n\t\t\t\t\t       int rcnt, int rwidth)\n{\n\tWARN_ON((ginst) >= gcnt);\n\tWARN_ON((rinst) >= rcnt);\n\treturn base +\n\t\tgbase + ((ginst) * gwidth) +\n\t\traddr + ((rinst) * rwidth);\n}\n\nstatic inline void sdx5_rmw(u32 val, u32 mask, struct sparx5_serdes_private *priv,\n\t\t\t    int id, int tinst, int tcnt,\n\t\t\t    int gbase, int ginst, int gcnt, int gwidth,\n\t\t\t    int raddr, int rinst, int rcnt, int rwidth)\n{\n\tu32 nval;\n\tvoid __iomem *addr =\n\t\tsdx5_addr(priv->regs, id, tinst, tcnt,\n\t\t\t  gbase, ginst, gcnt, gwidth,\n\t\t\t  raddr, rinst, rcnt, rwidth);\n\tnval = readl(addr);\n\tnval = (nval & ~mask) | (val & mask);\n\twritel(nval, addr);\n}\n\nstatic inline void sdx5_inst_rmw(u32 val, u32 mask, void __iomem *iomem,\n\t\t\t\t int id, int tinst, int tcnt,\n\t\t\t\t int gbase, int ginst, int gcnt, int gwidth,\n\t\t\t\t int raddr, int rinst, int rcnt, int rwidth)\n{\n\tu32 nval;\n\tvoid __iomem *addr =\n\t\tsdx5_inst_baseaddr(iomem,\n\t\t\t\t   gbase, ginst, gcnt, gwidth,\n\t\t\t\t   raddr, rinst, rcnt, rwidth);\n\tnval = readl(addr);\n\tnval = (nval & ~mask) | (val & mask);\n\twritel(nval, addr);\n}\n\nstatic inline void sdx5_rmw_addr(u32 val, u32 mask, void __iomem *addr)\n{\n\tu32 nval;\n\n\tnval = readl(addr);\n\tnval = (nval & ~mask) | (val & mask);\n\twritel(nval, addr);\n}\n\nstatic inline void __iomem *sdx5_inst_get(struct sparx5_serdes_private *priv,\n\t\t\t\t\t  int id, int tinst)\n{\n\treturn priv->regs[id + tinst];\n}\n\nstatic inline void __iomem *sdx5_inst_addr(void __iomem *iomem,\n\t\t\t\t\t   int id, int tinst, int tcnt,\n\t\t\t\t\t   int gbase,\n\t\t\t\t\t   int ginst, int gcnt, int gwidth,\n\t\t\t\t\t   int raddr,\n\t\t\t\t\t   int rinst, int rcnt, int rwidth)\n{\n\treturn sdx5_inst_baseaddr(iomem, gbase, ginst, gcnt, gwidth,\n\t\t\t\t  raddr, rinst, rcnt, rwidth);\n}\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}