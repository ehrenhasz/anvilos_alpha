{
  "module_name": "phy-exynos-dp-video.c",
  "hash_id": "d751ffc9e62abdba2aa09cea979275ffdf8f55613649466051f0965b2f45f51a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/phy/samsung/phy-exynos-dp-video.c",
  "human_readable_source": "\n \n\n#include <linux/err.h>\n#include <linux/io.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/mfd/syscon.h>\n#include <linux/of.h>\n#include <linux/phy/phy.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n#include <linux/soc/samsung/exynos-regs-pmu.h>\n\nstruct exynos_dp_video_phy_drvdata {\n\tu32 phy_ctrl_offset;\n};\n\nstruct exynos_dp_video_phy {\n\tstruct regmap *regs;\n\tconst struct exynos_dp_video_phy_drvdata *drvdata;\n};\n\nstatic int exynos_dp_video_phy_power_on(struct phy *phy)\n{\n\tstruct exynos_dp_video_phy *state = phy_get_drvdata(phy);\n\n\t \n\treturn regmap_update_bits(state->regs, state->drvdata->phy_ctrl_offset,\n\t\t\t\t  EXYNOS4_PHY_ENABLE, EXYNOS4_PHY_ENABLE);\n}\n\nstatic int exynos_dp_video_phy_power_off(struct phy *phy)\n{\n\tstruct exynos_dp_video_phy *state = phy_get_drvdata(phy);\n\n\t \n\treturn regmap_update_bits(state->regs, state->drvdata->phy_ctrl_offset,\n\t\t\t\t  EXYNOS4_PHY_ENABLE, 0);\n}\n\nstatic const struct phy_ops exynos_dp_video_phy_ops = {\n\t.power_on\t= exynos_dp_video_phy_power_on,\n\t.power_off\t= exynos_dp_video_phy_power_off,\n\t.owner\t\t= THIS_MODULE,\n};\n\nstatic const struct exynos_dp_video_phy_drvdata exynos5250_dp_video_phy = {\n\t.phy_ctrl_offset\t= EXYNOS5_DPTX_PHY_CONTROL,\n};\n\nstatic const struct exynos_dp_video_phy_drvdata exynos5420_dp_video_phy = {\n\t.phy_ctrl_offset\t= EXYNOS5420_DPTX_PHY_CONTROL,\n};\n\nstatic const struct of_device_id exynos_dp_video_phy_of_match[] = {\n\t{\n\t\t.compatible = \"samsung,exynos5250-dp-video-phy\",\n\t\t.data = &exynos5250_dp_video_phy,\n\t}, {\n\t\t.compatible = \"samsung,exynos5420-dp-video-phy\",\n\t\t.data = &exynos5420_dp_video_phy,\n\t},\n\t{ },\n};\nMODULE_DEVICE_TABLE(of, exynos_dp_video_phy_of_match);\n\nstatic int exynos_dp_video_phy_probe(struct platform_device *pdev)\n{\n\tstruct exynos_dp_video_phy *state;\n\tstruct device *dev = &pdev->dev;\n\tstruct phy_provider *phy_provider;\n\tstruct phy *phy;\n\n\tstate = devm_kzalloc(dev, sizeof(*state), GFP_KERNEL);\n\tif (!state)\n\t\treturn -ENOMEM;\n\n\tstate->regs = syscon_node_to_regmap(dev->parent->of_node);\n\tif (IS_ERR(state->regs))\n\t\t \n\t\tstate->regs = syscon_regmap_lookup_by_phandle(dev->of_node,\n\t\t\t\t\t\t\t      \"samsung,pmu-syscon\");\n\tif (IS_ERR(state->regs)) {\n\t\tdev_err(dev, \"Failed to lookup PMU regmap\\n\");\n\t\treturn PTR_ERR(state->regs);\n\t}\n\n\tstate->drvdata = of_device_get_match_data(dev);\n\n\tphy = devm_phy_create(dev, NULL, &exynos_dp_video_phy_ops);\n\tif (IS_ERR(phy)) {\n\t\tdev_err(dev, \"failed to create Display Port PHY\\n\");\n\t\treturn PTR_ERR(phy);\n\t}\n\tphy_set_drvdata(phy, state);\n\n\tphy_provider = devm_of_phy_provider_register(dev, of_phy_simple_xlate);\n\n\treturn PTR_ERR_OR_ZERO(phy_provider);\n}\n\nstatic struct platform_driver exynos_dp_video_phy_driver = {\n\t.probe\t= exynos_dp_video_phy_probe,\n\t.driver = {\n\t\t.name\t= \"exynos-dp-video-phy\",\n\t\t.of_match_table\t= exynos_dp_video_phy_of_match,\n\t\t.suppress_bind_attrs = true,\n\t}\n};\nmodule_platform_driver(exynos_dp_video_phy_driver);\n\nMODULE_AUTHOR(\"Jingoo Han <jg1.han@samsung.com>\");\nMODULE_DESCRIPTION(\"Samsung Exynos SoC DP PHY driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}