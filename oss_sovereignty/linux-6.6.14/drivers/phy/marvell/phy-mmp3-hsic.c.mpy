{
  "module_name": "phy-mmp3-hsic.c",
  "hash_id": "a2ff908c05ed68972c50705185c3efdc1ddf39ace28f67a1fa66eb8828373e71",
  "original_prompt": "Ingested from linux-6.6.14/drivers/phy/marvell/phy-mmp3-hsic.c",
  "human_readable_source": "\n \n\n#include <linux/delay.h>\n#include <linux/io.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/phy/phy.h>\n#include <linux/platform_device.h>\n\n#define HSIC_CTRL\t0x08\n#define HSIC_ENABLE\tBIT(7)\n#define PLL_BYPASS\tBIT(4)\n\nstatic int mmp3_hsic_phy_init(struct phy *phy)\n{\n\tvoid __iomem *base = (void __iomem *)phy_get_drvdata(phy);\n\tu32 hsic_ctrl;\n\n\thsic_ctrl = readl_relaxed(base + HSIC_CTRL);\n\thsic_ctrl |= HSIC_ENABLE;\n\thsic_ctrl |= PLL_BYPASS;\n\twritel_relaxed(hsic_ctrl, base + HSIC_CTRL);\n\n\treturn 0;\n}\n\nstatic const struct phy_ops mmp3_hsic_phy_ops = {\n\t.init\t\t= mmp3_hsic_phy_init,\n\t.owner\t\t= THIS_MODULE,\n};\n\nstatic const struct of_device_id mmp3_hsic_phy_of_match[] = {\n\t{ .compatible = \"marvell,mmp3-hsic-phy\", },\n\t{ },\n};\nMODULE_DEVICE_TABLE(of, mmp3_hsic_phy_of_match);\n\nstatic int mmp3_hsic_phy_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct phy_provider *provider;\n\tvoid __iomem *base;\n\tstruct phy *phy;\n\n\tbase = devm_platform_get_and_ioremap_resource(pdev, 0, NULL);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tphy = devm_phy_create(dev, NULL, &mmp3_hsic_phy_ops);\n\tif (IS_ERR(phy)) {\n\t\tdev_err(dev, \"failed to create PHY\\n\");\n\t\treturn PTR_ERR(phy);\n\t}\n\n\tphy_set_drvdata(phy, (void *)base);\n\tprovider = devm_of_phy_provider_register(dev, of_phy_simple_xlate);\n\tif (IS_ERR(provider)) {\n\t\tdev_err(dev, \"failed to register PHY provider\\n\");\n\t\treturn PTR_ERR(provider);\n\t}\n\n\treturn 0;\n}\n\nstatic struct platform_driver mmp3_hsic_phy_driver = {\n\t.probe\t\t= mmp3_hsic_phy_probe,\n\t.driver\t\t= {\n\t\t.name\t= \"mmp3-hsic-phy\",\n\t\t.of_match_table = mmp3_hsic_phy_of_match,\n\t},\n};\nmodule_platform_driver(mmp3_hsic_phy_driver);\n\nMODULE_AUTHOR(\"Lubomir Rintel <lkundrak@v3.sk>\");\nMODULE_DESCRIPTION(\"Marvell MMP3 USB HSIC PHY Driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}