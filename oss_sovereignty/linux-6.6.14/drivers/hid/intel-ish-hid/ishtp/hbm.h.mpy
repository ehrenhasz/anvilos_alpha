{
  "module_name": "hbm.h",
  "hash_id": "d43787353282890e1dedf5d306186f9ffa282678cb6f659180fa8ec46b76da1a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/intel-ish-hid/ishtp/hbm.h",
  "human_readable_source": " \n \n\n#ifndef _ISHTP_HBM_H_\n#define _ISHTP_HBM_H_\n\n#include <linux/uuid.h>\n\nstruct ishtp_device;\nstruct ishtp_msg_hdr;\nstruct ishtp_cl;\n\n \n#define ISHTP_INTEROP_TIMEOUT\t\t7  \n\n#define ISHTP_CL_CONNECT_TIMEOUT\t15  \n\n \n#define HBM_MINOR_VERSION\t\t0\n#define HBM_MAJOR_VERSION\t\t1\n\n \n#define ISHTP_HBM_CMD_OP_MSK\t\t0x7f\n \n#define ISHTP_HBM_CMD_RES_MSK\t\t0x80\n\n \n#define HOST_START_REQ_CMD\t\t0x01\n#define HOST_START_RES_CMD\t\t0x81\n\n#define HOST_STOP_REQ_CMD\t\t0x02\n#define HOST_STOP_RES_CMD\t\t0x82\n\n#define FW_STOP_REQ_CMD\t\t\t0x03\n\n#define HOST_ENUM_REQ_CMD\t\t0x04\n#define HOST_ENUM_RES_CMD\t\t0x84\n\n#define HOST_CLIENT_PROPERTIES_REQ_CMD\t0x05\n#define HOST_CLIENT_PROPERTIES_RES_CMD\t0x85\n\n#define CLIENT_CONNECT_REQ_CMD\t\t0x06\n#define CLIENT_CONNECT_RES_CMD\t\t0x86\n\n#define CLIENT_DISCONNECT_REQ_CMD\t0x07\n#define CLIENT_DISCONNECT_RES_CMD\t0x87\n\n#define ISHTP_FLOW_CONTROL_CMD\t\t0x08\n\n#define DMA_BUFFER_ALLOC_NOTIFY\t\t0x11\n#define DMA_BUFFER_ALLOC_RESPONSE\t0x91\n\n#define DMA_XFER\t\t\t0x12\n#define DMA_XFER_ACK\t\t\t0x92\n\n \n#define\tDRIVER_STOP_REQUEST\t\t0x00\n\n \nstruct ishtp_msg_hdr {\n\tuint32_t fw_addr:8;\n\tuint32_t host_addr:8;\n\tuint32_t length:9;\n\tuint32_t reserved:6;\n\tuint32_t msg_complete:1;\n} __packed;\n\nstruct ishtp_bus_message {\n\tuint8_t hbm_cmd;\n\tuint8_t data[];\n} __packed;\n\n \nstruct ishtp_hbm_cl_cmd {\n\tuint8_t hbm_cmd;\n\tuint8_t fw_addr;\n\tuint8_t host_addr;\n\tuint8_t data;\n};\n\nstruct hbm_version {\n\tuint8_t minor_version;\n\tuint8_t major_version;\n} __packed;\n\nstruct hbm_host_version_request {\n\tuint8_t hbm_cmd;\n\tuint8_t reserved;\n\tstruct hbm_version host_version;\n} __packed;\n\nstruct hbm_host_version_response {\n\tuint8_t hbm_cmd;\n\tuint8_t host_version_supported;\n\tstruct hbm_version fw_max_version;\n} __packed;\n\nstruct hbm_host_stop_request {\n\tuint8_t hbm_cmd;\n\tuint8_t reason;\n\tuint8_t reserved[2];\n} __packed;\n\nstruct hbm_host_stop_response {\n\tuint8_t hbm_cmd;\n\tuint8_t reserved[3];\n} __packed;\n\nstruct hbm_host_enum_request {\n\tuint8_t hbm_cmd;\n\tuint8_t reserved[3];\n} __packed;\n\nstruct hbm_host_enum_response {\n\tuint8_t hbm_cmd;\n\tuint8_t reserved[3];\n\tuint8_t valid_addresses[32];\n} __packed;\n\nstruct ishtp_client_properties {\n\tguid_t protocol_name;\n\tuint8_t protocol_version;\n\tuint8_t max_number_of_connections;\n\tuint8_t fixed_address;\n\tuint8_t single_recv_buf;\n\tuint32_t max_msg_length;\n\tuint8_t dma_hdr_len;\n#define\tISHTP_CLIENT_DMA_ENABLED\t0x80\n\tuint8_t reserved4;\n\tuint8_t reserved5;\n\tuint8_t reserved6;\n} __packed;\n\nstruct hbm_props_request {\n\tuint8_t hbm_cmd;\n\tuint8_t address;\n\tuint8_t reserved[2];\n} __packed;\n\nstruct hbm_props_response {\n\tuint8_t hbm_cmd;\n\tuint8_t address;\n\tuint8_t status;\n\tuint8_t reserved[1];\n\tstruct ishtp_client_properties client_properties;\n} __packed;\n\n \nstruct hbm_client_connect_request {\n\tuint8_t hbm_cmd;\n\tuint8_t fw_addr;\n\tuint8_t host_addr;\n\tuint8_t reserved;\n} __packed;\n\n \nstruct hbm_client_connect_response {\n\tuint8_t hbm_cmd;\n\tuint8_t fw_addr;\n\tuint8_t host_addr;\n\tuint8_t status;\n} __packed;\n\n\n#define ISHTP_FC_MESSAGE_RESERVED_LENGTH\t\t5\n\nstruct hbm_flow_control {\n\tuint8_t hbm_cmd;\n\tuint8_t fw_addr;\n\tuint8_t host_addr;\n\tuint8_t reserved[ISHTP_FC_MESSAGE_RESERVED_LENGTH];\n} __packed;\n\nstruct dma_alloc_notify {\n\tuint8_t hbm;\n\tuint8_t status;\n\tuint8_t reserved[2];\n\tuint32_t buf_size;\n\tuint64_t buf_address;\n\t \n} __packed;\n\nstruct dma_xfer_hbm {\n\tuint8_t hbm;\n\tuint8_t fw_client_id;\n\tuint8_t host_client_id;\n\tuint8_t reserved;\n\tuint64_t msg_addr;\n\tuint32_t msg_length;\n\tuint32_t reserved2;\n} __packed;\n\n \n#define ISHTP_SYSTEM_STATE_CLIENT_ADDR\t\t13\n\n#define SYSTEM_STATE_SUBSCRIBE\t\t\t0x1\n#define SYSTEM_STATE_STATUS\t\t\t0x2\n#define SYSTEM_STATE_QUERY_SUBSCRIBERS\t\t0x3\n#define SYSTEM_STATE_STATE_CHANGE_REQ\t\t0x4\n \n#define CONNECTED_STANDBY_STATE_BIT\t\t(1<<0)\n#define SUSPEND_STATE_BIT\t\t\t(1<<1)\n\nstruct ish_system_states_header {\n\tuint32_t cmd;\n\tuint32_t cmd_status;\t \n} __packed;\n\nstruct ish_system_states_subscribe {\n\tstruct ish_system_states_header hdr;\n\tuint32_t states;\n} __packed;\n\nstruct ish_system_states_status {\n\tstruct ish_system_states_header hdr;\n\tuint32_t supported_states;\n\tuint32_t states_status;\n} __packed;\n\nstruct ish_system_states_query_subscribers {\n\tstruct ish_system_states_header hdr;\n} __packed;\n\nstruct ish_system_states_state_change_req {\n\tstruct ish_system_states_header hdr;\n\tuint32_t requested_states;\n\tuint32_t states_status;\n} __packed;\n\n \nenum ishtp_hbm_state {\n\tISHTP_HBM_IDLE = 0,\n\tISHTP_HBM_START,\n\tISHTP_HBM_STARTED,\n\tISHTP_HBM_ENUM_CLIENTS,\n\tISHTP_HBM_CLIENT_PROPERTIES,\n\tISHTP_HBM_WORKING,\n\tISHTP_HBM_STOPPED,\n};\n\nstatic inline void ishtp_hbm_hdr(struct ishtp_msg_hdr *hdr, size_t length)\n{\n\thdr->host_addr = 0;\n\thdr->fw_addr = 0;\n\thdr->length = length;\n\thdr->msg_complete = 1;\n\thdr->reserved = 0;\n}\n\nint ishtp_hbm_start_req(struct ishtp_device *dev);\nint ishtp_hbm_start_wait(struct ishtp_device *dev);\nint ishtp_hbm_cl_flow_control_req(struct ishtp_device *dev,\n\t\t\t\t  struct ishtp_cl *cl);\nint ishtp_hbm_cl_disconnect_req(struct ishtp_device *dev, struct ishtp_cl *cl);\nint ishtp_hbm_cl_connect_req(struct ishtp_device *dev, struct ishtp_cl *cl);\nvoid ishtp_hbm_enum_clients_req(struct ishtp_device *dev);\nvoid bh_hbm_work_fn(struct work_struct *work);\nvoid recv_hbm(struct ishtp_device *dev, struct ishtp_msg_hdr *ishtp_hdr);\nvoid recv_fixed_cl_msg(struct ishtp_device *dev,\n\tstruct ishtp_msg_hdr *ishtp_hdr);\nvoid ishtp_hbm_dispatch(struct ishtp_device *dev,\n\tstruct ishtp_bus_message *hdr);\n\nvoid ishtp_query_subscribers(struct ishtp_device *dev);\n\n \nvoid ishtp_send_suspend(struct ishtp_device *dev);\nvoid ishtp_send_resume(struct ishtp_device *dev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}