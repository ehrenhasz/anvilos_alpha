{
  "module_name": "client.h",
  "hash_id": "e607f2e2064f996efc9457274eaa8cd038f3bc42b1e0a0553bd359fcfc94272a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/intel-ish-hid/ishtp/client.h",
  "human_readable_source": " \n \n\n#ifndef _ISHTP_CLIENT_H_\n#define _ISHTP_CLIENT_H_\n\n#include <linux/types.h>\n#include \"ishtp-dev.h\"\n\n \n#define\tCL_DEF_RX_RING_SIZE\t2\n#define\tCL_DEF_TX_RING_SIZE\t2\n#define\tCL_MAX_RX_RING_SIZE\t32\n#define\tCL_MAX_TX_RING_SIZE\t32\n\n#define DMA_SLOT_SIZE\t\t4096\n \n#define\tDMA_WORTH_THRESHOLD\t3\n\n \n#define\tCL_TX_PATH_DEFAULT\t0\n#define\tCL_TX_PATH_IPC\t\t1\n#define\tCL_TX_PATH_DMA\t\t2\n\n \nstruct ishtp_cl_tx_ring {\n\tstruct list_head\tlist;\n\tstruct ishtp_msg_data\tsend_buf;\n};\n\n \nstruct ishtp_cl {\n\tstruct list_head\tlink;\n\tstruct ishtp_device\t*dev;\n\tenum cl_state\t\tstate;\n\tint\t\t\tstatus;\n\n\t \n\tstruct ishtp_cl_device\t*device;\n\n\t \n\tuint8_t\thost_client_id;\n\tuint8_t\tfw_client_id;\n\tuint8_t\tishtp_flow_ctrl_creds;\n\tuint8_t\tout_flow_ctrl_creds;\n\n\t \n\tint\tlast_tx_path;\n\t \n\tint\tlast_dma_acked;\n\tunsigned char\t*last_dma_addr;\n\t \n\tint\tlast_ipc_acked;\n\n\t \n\tunsigned int\trx_ring_size;\n\tstruct ishtp_cl_rb\tfree_rb_list;\n\tspinlock_t\tfree_list_spinlock;\n\t \n\tstruct ishtp_cl_rb\tin_process_list;\n\tspinlock_t\tin_process_spinlock;\n\n\t \n\tunsigned int\ttx_ring_size;\n\tstruct ishtp_cl_tx_ring\ttx_list, tx_free_list;\n\tint\t\ttx_ring_free_size;\n\tspinlock_t\ttx_list_spinlock;\n\tspinlock_t\ttx_free_list_spinlock;\n\tsize_t\ttx_offs;\t \n\n\t \n\tint\tsending;\n\n\t \n\tspinlock_t\tfc_spinlock;\n\n\t \n\twait_queue_head_t\twait_ctrl_res;\n\n\t \n\tunsigned int\terr_send_msg;\n\tunsigned int\terr_send_fc;\n\n\t \n\tunsigned int\tsend_msg_cnt_ipc;\n\tunsigned int\tsend_msg_cnt_dma;\n\tunsigned int\trecv_msg_cnt_ipc;\n\tunsigned int\trecv_msg_cnt_dma;\n\tunsigned int\trecv_msg_num_frags;\n\tunsigned int\tishtp_flow_ctrl_cnt;\n\tunsigned int\tout_flow_ctrl_cnt;\n\n\t \n\tktime_t ts_rx;\n\tktime_t ts_out_fc;\n\tktime_t ts_max_fc_delay;\n\tvoid *client_data;\n};\n\n \nint ishtp_can_client_connect(struct ishtp_device *ishtp_dev, guid_t *uuid);\nint ishtp_fw_cl_by_id(struct ishtp_device *dev, uint8_t client_id);\nvoid ishtp_cl_send_msg(struct ishtp_device *dev, struct ishtp_cl *cl);\nvoid recv_ishtp_cl_msg(struct ishtp_device *dev,\n\t\t       struct ishtp_msg_hdr *ishtp_hdr);\nint ishtp_cl_read_start(struct ishtp_cl *cl);\n\n \nint ishtp_cl_alloc_rx_ring(struct ishtp_cl *cl);\nint ishtp_cl_alloc_tx_ring(struct ishtp_cl *cl);\nvoid ishtp_cl_free_rx_ring(struct ishtp_cl *cl);\nvoid ishtp_cl_free_tx_ring(struct ishtp_cl *cl);\nint ishtp_cl_get_tx_free_buffer_size(struct ishtp_cl *cl);\nint ishtp_cl_get_tx_free_rings(struct ishtp_cl *cl);\n\n \nvoid recv_ishtp_cl_msg_dma(struct ishtp_device *dev, void *msg,\n\t\t\t   struct dma_xfer_hbm *hbm);\nvoid ishtp_cl_alloc_dma_buf(struct ishtp_device *dev);\nvoid ishtp_cl_free_dma_buf(struct ishtp_device *dev);\nvoid *ishtp_cl_get_dma_send_buf(struct ishtp_device *dev,\n\t\t\t\tuint32_t size);\nvoid ishtp_cl_release_dma_acked_mem(struct ishtp_device *dev,\n\t\t\t\t    void *msg_addr,\n\t\t\t\t    uint8_t size);\n\n \nstruct ishtp_cl_rb *ishtp_io_rb_init(struct ishtp_cl *cl);\nvoid ishtp_io_rb_free(struct ishtp_cl_rb *priv_rb);\nint ishtp_io_rb_alloc_buf(struct ishtp_cl_rb *rb, size_t length);\n\n \nstatic inline bool ishtp_cl_cmp_id(const struct ishtp_cl *cl1,\n\t\t\t\t   const struct ishtp_cl *cl2)\n{\n\treturn cl1 && cl2 &&\n\t\t(cl1->host_client_id == cl2->host_client_id) &&\n\t\t(cl1->fw_client_id == cl2->fw_client_id);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}