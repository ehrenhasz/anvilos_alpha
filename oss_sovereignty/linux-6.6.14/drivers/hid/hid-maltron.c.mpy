{
  "module_name": "hid-maltron.c",
  "hash_id": "64cc8662eb28f273e53bcd4008bc31694bccd658a7e1e3b7f17f7c7c9f0dfe3d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-maltron.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/hid.h>\n#include <linux/module.h>\n\n#include \"hid-ids.h\"\n\n \nstatic u8 maltron_rdesc_o[] = {\n\t0x05, 0x01,         \n\t0x09, 0x80,         \n\t0xA1, 0x01,         \n\t0x85, 0x02,         \n\t0x75, 0x01,         \n\t0x95, 0x01,         \n\t0x15, 0x00,         \n\t0x25, 0x01,         \n\t0x09, 0x82,         \n\t0x81, 0x06,         \n\t0x09, 0x82,         \n\t0x81, 0x06,         \n\t0x09, 0x83,         \n\t0x81, 0x06,         \n\t0x75, 0x05,         \n\t0x81, 0x01,         \n\t0xC0,               \n\t0x05, 0x0C,         \n\t0x09, 0x01,         \n\t0xA1, 0x01,         \n\t0x85, 0x03,         \n\t0x95, 0x01,         \n\t0x75, 0x10,         \n\t0x19, 0x00,         \n\t0x2A, 0xFF, 0x7F,   \n\t0x81, 0x00,         \n\t0xC0,               \n\t0x06, 0x7F, 0xFF,   \n\t0x09, 0x01,         \n\t0xA1, 0x01,         \n\t0x85, 0x04,         \n\t0x95, 0x01,         \n\t0x75, 0x10,         \n\t0x19, 0x00,         \n\t0x2A, 0xFF, 0x7F,   \n\t0x81, 0x00,         \n\t0x75, 0x02,         \n\t0x25, 0x02,         \n\t0x09, 0x90,         \n\t0xB1, 0x02,         \n\t0x75, 0x06,         \n\t0xB1, 0x01,         \n\t0x75, 0x01,         \n\t0x25, 0x01,         \n\t0x05, 0x08,         \n\t0x09, 0x2A,         \n\t0x91, 0x02,         \n\t0x09, 0x4B,         \n\t0x91, 0x02,         \n\t0x75, 0x06,         \n\t0x95, 0x01,         \n\t0x91, 0x01,         \n\t0xC0                \n};\n\n \nstatic u8 maltron_rdesc[] = {\n\t0x05, 0x01,         \n\t0x09, 0x80,         \n\t0xA1, 0x01,         \n\t0x85, 0x02,         \n\t0x75, 0x01,         \n\t0x95, 0x01,         \n\t0x15, 0x00,         \n\t0x25, 0x01,         \n\t0x09, 0x82,         \n\t0x81, 0x06,         \n\t0x09, 0x82,         \n\t0x81, 0x06,         \n\t0x09, 0x83,         \n\t0x81, 0x06,         \n\t0x75, 0x05,         \n\t0x81, 0x01,         \n\t0xC0,               \n\t0x05, 0x0C,         \n\t0x09, 0x01,         \n\t0xA1, 0x01,         \n\t0x85, 0x03,         \n\t0x15, 0x00,         \n\t0x26, 0xFF, 0x7F,   \n\t0x95, 0x01,         \n\t0x75, 0x10,         \n\t0x19, 0x00,         \n\t0x2A, 0xFF, 0x7F,   \n\t0x81, 0x00,         \n\t0xC0,               \n\t0x06, 0x7F, 0xFF,   \n\t0x09, 0x01,         \n\t0xA1, 0x01,         \n\t0x85, 0x04,         \n\t0x95, 0x01,         \n\t0x75, 0x10,         \n\t0x19, 0x00,         \n\t0x2A, 0xFF, 0x7F,   \n\t0x81, 0x00,         \n\t0x75, 0x02,         \n\t0x25, 0x02,         \n\t0x09, 0x90,         \n\t0xB1, 0x02,         \n\t0x75, 0x06,         \n\t0xB1, 0x01,         \n\t0x75, 0x01,         \n\t0x25, 0x01,         \n\t0x05, 0x08,         \n\t0x09, 0x2A,         \n\t0x91, 0x02,         \n\t0x09, 0x4B,         \n\t0x91, 0x02,         \n\t0x75, 0x06,         \n\t0x95, 0x01,         \n\t0x91, 0x01,         \n\t0xC0                \n};\n\nstatic __u8 *maltron_report_fixup(struct hid_device *hdev, __u8 *rdesc,\n\t\t\t\t  unsigned int *rsize)\n{\n\tif (*rsize == sizeof(maltron_rdesc_o) &&\n\t    !memcmp(maltron_rdesc_o, rdesc, sizeof(maltron_rdesc_o))) {\n\t\thid_info(hdev, \"Replacing Maltron L90 keyboard report descriptor\\n\");\n\t\t*rsize = sizeof(maltron_rdesc);\n\t\treturn maltron_rdesc;\n\t}\n\treturn rdesc;\n}\n\nstatic const struct hid_device_id maltron_devices[] = {\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_ALCOR, USB_DEVICE_ID_ALCOR_MALTRON_KB)},\n\t{ }\n};\nMODULE_DEVICE_TABLE(hid, maltron_devices);\n\nstatic struct hid_driver maltron_driver = {\n\t.name = \"maltron\",\n\t.id_table = maltron_devices,\n\t.report_fixup = maltron_report_fixup\n};\nmodule_hid_driver(maltron_driver);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}