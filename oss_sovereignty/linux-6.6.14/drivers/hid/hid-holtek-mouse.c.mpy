{
  "module_name": "hid-holtek-mouse.c",
  "hash_id": "28e75c022f6cf22b61ae5fa5ea8f6e6bb47b79bd147e427d0f11b67437a27844",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-holtek-mouse.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/hid.h>\n#include <linux/module.h>\n#include <linux/usb.h>\n\n#include \"hid-ids.h\"\n\n \n\nstatic __u8 *holtek_mouse_report_fixup(struct hid_device *hdev, __u8 *rdesc,\n\t\tunsigned int *rsize)\n{\n\tstruct usb_interface *intf = to_usb_interface(hdev->dev.parent);\n\n\tif (intf->cur_altsetting->desc.bInterfaceNumber == 1) {\n\t\t \n\t\tswitch (hdev->product) {\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A067:\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A072:\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A0C2:\n\t\t\tif (*rsize >= 122 && rdesc[115] == 0xff && rdesc[116] == 0x7f\n\t\t\t\t\t&& rdesc[120] == 0xff && rdesc[121] == 0x7f) {\n\t\t\t\thid_info(hdev, \"Fixing up report descriptor\\n\");\n\t\t\t\trdesc[116] = rdesc[121] = 0x2f;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A04A:\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A070:\n\t\tcase USB_DEVICE_ID_HOLTEK_ALT_MOUSE_A081:\n\t\t\tif (*rsize >= 113 && rdesc[106] == 0xff && rdesc[107] == 0x7f\n\t\t\t\t\t&& rdesc[111] == 0xff && rdesc[112] == 0x7f) {\n\t\t\t\thid_info(hdev, \"Fixing up report descriptor\\n\");\n\t\t\t\trdesc[107] = rdesc[112] = 0x2f;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t}\n\treturn rdesc;\n}\n\nstatic int holtek_mouse_probe(struct hid_device *hdev,\n\t\t\t      const struct hid_device_id *id)\n{\n\tint ret;\n\n\tif (!hid_is_usb(hdev))\n\t\treturn -EINVAL;\n\n\tret = hid_parse(hdev);\n\tif (ret) {\n\t\thid_err(hdev, \"hid parse failed: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = hid_hw_start(hdev, HID_CONNECT_DEFAULT);\n\tif (ret) {\n\t\thid_err(hdev, \"hw start failed: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct hid_device_id holtek_mouse_devices[] = {\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A067) },\n        { HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A070) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A04A) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A072) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A081) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_HOLTEK_ALT,\n\t\t\tUSB_DEVICE_ID_HOLTEK_ALT_MOUSE_A0C2) },\n\t{ }\n};\nMODULE_DEVICE_TABLE(hid, holtek_mouse_devices);\n\nstatic struct hid_driver holtek_mouse_driver = {\n\t.name = \"holtek_mouse\",\n\t.id_table = holtek_mouse_devices,\n\t.report_fixup = holtek_mouse_report_fixup,\n\t.probe = holtek_mouse_probe,\n};\n\nmodule_hid_driver(holtek_mouse_driver);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}