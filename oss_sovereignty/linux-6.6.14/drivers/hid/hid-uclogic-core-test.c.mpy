{
  "module_name": "hid-uclogic-core-test.c",
  "hash_id": "99a692b88cff299b03daaffb44818d8227b93563cc172c435c23d98a843f384c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-uclogic-core-test.c",
  "human_readable_source": "\n\n \n\n#include <kunit/test.h>\n#include \"./hid-uclogic-params.h\"\n\n#define MAX_EVENT_SIZE 12\n\nstruct uclogic_raw_event_hook_test {\n\tu8 event[MAX_EVENT_SIZE];\n\tsize_t size;\n\tbool expected;\n};\n\nstatic struct uclogic_raw_event_hook_test hook_events[] = {\n\t{\n\t\t.event = { 0xA1, 0xB2, 0xC3, 0xD4 },\n\t\t.size = 4,\n\t},\n\t{\n\t\t.event = { 0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A },\n\t\t.size = 6,\n\t},\n};\n\nstatic struct uclogic_raw_event_hook_test test_events[] = {\n\t{\n\t\t.event = { 0xA1, 0xB2, 0xC3, 0xD4 },\n\t\t.size = 4,\n\t\t.expected = true,\n\t},\n\t{\n\t\t.event = { 0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A },\n\t\t.size = 6,\n\t\t.expected = true,\n\t},\n\t{\n\t\t.event = { 0xA1, 0xB2, 0xC3 },\n\t\t.size = 3,\n\t\t.expected = false,\n\t},\n\t{\n\t\t.event = { 0xA1, 0xB2, 0xC3, 0xD4, 0x00 },\n\t\t.size = 5,\n\t\t.expected = false,\n\t},\n\t{\n\t\t.event = { 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x1F },\n\t\t.size = 6,\n\t\t.expected = false,\n\t},\n};\n\nstatic void fake_work(struct work_struct *work)\n{\n\n}\n\nstatic void hid_test_uclogic_exec_event_hook_test(struct kunit *test)\n{\n\tstruct uclogic_params p = {0, };\n\tstruct uclogic_raw_event_hook *filter;\n\tbool res;\n\tint n;\n\n\t \n\tp.event_hooks = kunit_kzalloc(test, sizeof(*p.event_hooks), GFP_KERNEL);\n\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, p.event_hooks);\n\tINIT_LIST_HEAD(&p.event_hooks->list);\n\n\tfor (n = 0; n < ARRAY_SIZE(hook_events); n++) {\n\t\tfilter = kunit_kzalloc(test, sizeof(*filter), GFP_KERNEL);\n\t\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, filter);\n\n\t\tfilter->size = hook_events[n].size;\n\t\tfilter->event = kunit_kzalloc(test, filter->size, GFP_KERNEL);\n\t\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, filter->event);\n\t\tmemcpy(filter->event, &hook_events[n].event[0], filter->size);\n\n\t\tINIT_WORK(&filter->work, fake_work);\n\n\t\tlist_add_tail(&filter->list, &p.event_hooks->list);\n\t}\n\n\t \n\tfor (n = 0; n < ARRAY_SIZE(test_events); n++) {\n\t\tres = uclogic_exec_event_hook(&p, &test_events[n].event[0],\n\t\t\t\t\t      test_events[n].size);\n\t\tKUNIT_ASSERT_EQ(test, res, test_events[n].expected);\n\t}\n}\n\nstatic struct kunit_case hid_uclogic_core_test_cases[] = {\n\tKUNIT_CASE(hid_test_uclogic_exec_event_hook_test),\n\t{}\n};\n\nstatic struct kunit_suite hid_uclogic_core_test_suite = {\n\t.name = \"hid_uclogic_core_test\",\n\t.test_cases = hid_uclogic_core_test_cases,\n};\n\nkunit_test_suite(hid_uclogic_core_test_suite);\n\nMODULE_DESCRIPTION(\"KUnit tests for the UC-Logic driver\");\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Jos\u00e9 Exp\u00f3sito <jose.exposito89@gmail.com>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}