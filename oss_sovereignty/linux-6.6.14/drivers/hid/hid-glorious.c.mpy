{
  "module_name": "hid-glorious.c",
  "hash_id": "1c7ab56ba3b5aa4b144cb9d88a1b40d1e1beccc39e258e420949ac0b9aca1440",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-glorious.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/hid.h>\n#include <linux/module.h>\n\n#include \"hid-ids.h\"\n\nMODULE_AUTHOR(\"Samuel \u010cavoj <sammko@sammserver.com>\");\nMODULE_DESCRIPTION(\"HID driver for Glorious PC Gaming Race mice\");\n\n \nstatic __u8 *glorious_report_fixup(struct hid_device *hdev, __u8 *rdesc,\n\t\tunsigned int *rsize)\n{\n\tif (*rsize == 213 &&\n\t\trdesc[84] == 129 && rdesc[112] == 129 && rdesc[140] == 129 &&\n\t\trdesc[85] == 3   && rdesc[113] == 3   && rdesc[141] == 3) {\n\t\thid_info(hdev, \"patching Glorious Model O consumer control report descriptor\\n\");\n\t\trdesc[85] = rdesc[113] = rdesc[141] = \\\n\t\t\tHID_MAIN_ITEM_VARIABLE | HID_MAIN_ITEM_RELATIVE;\n\t}\n\tif (*rsize == 156 && rdesc[41] == 1) {\n\t\thid_info(hdev, \"patching Glorious Model I keyboard report descriptor\\n\");\n\t\trdesc[41] = 0;\n\t}\n\treturn rdesc;\n}\n\nstatic void glorious_update_name(struct hid_device *hdev)\n{\n\tconst char *model = \"Device\";\n\n\tswitch (hdev->product) {\n\tcase USB_DEVICE_ID_GLORIOUS_MODEL_O:\n\t\tmodel = \"Model O\"; break;\n\tcase USB_DEVICE_ID_GLORIOUS_MODEL_D:\n\t\tmodel = \"Model D\"; break;\n\tcase USB_DEVICE_ID_GLORIOUS_MODEL_I:\n\t\tmodel = \"Model I\"; break;\n\t}\n\n\tsnprintf(hdev->name, sizeof(hdev->name), \"%s %s\", \"Glorious\", model);\n}\n\nstatic int glorious_probe(struct hid_device *hdev,\n\t\tconst struct hid_device_id *id)\n{\n\tint ret;\n\n\thdev->quirks |= HID_QUIRK_INPUT_PER_APP;\n\n\tret = hid_parse(hdev);\n\tif (ret)\n\t\treturn ret;\n\n\tglorious_update_name(hdev);\n\n\treturn hid_hw_start(hdev, HID_CONNECT_DEFAULT);\n}\n\nstatic const struct hid_device_id glorious_devices[] = {\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_SINOWEALTH,\n\t\tUSB_DEVICE_ID_GLORIOUS_MODEL_O) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_SINOWEALTH,\n\t\tUSB_DEVICE_ID_GLORIOUS_MODEL_D) },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_LAVIEW,\n\t\tUSB_DEVICE_ID_GLORIOUS_MODEL_I) },\n\t{ }\n};\nMODULE_DEVICE_TABLE(hid, glorious_devices);\n\nstatic struct hid_driver glorious_driver = {\n\t.name = \"glorious\",\n\t.id_table = glorious_devices,\n\t.probe = glorious_probe,\n\t.report_fixup = glorious_report_fixup\n};\n\nmodule_hid_driver(glorious_driver);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}