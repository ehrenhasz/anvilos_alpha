{
  "module_name": "hid-belkin.c",
  "hash_id": "f7d66dc2158de7240eac00e3ae078a1290c036fb56f549020d33504a70352a33",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-belkin.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/device.h>\n#include <linux/hid.h>\n#include <linux/module.h>\n\n#include \"hid-ids.h\"\n\n#define BELKIN_HIDDEV\t0x01\n#define BELKIN_WKBD\t0x02\n\n#define belkin_map_key_clear(c)\thid_map_usage_clear(hi, usage, bit, max, \\\n\t\t\t\t\tEV_KEY, (c))\nstatic int belkin_input_mapping(struct hid_device *hdev, struct hid_input *hi,\n\t\tstruct hid_field *field, struct hid_usage *usage,\n\t\tunsigned long **bit, int *max)\n{\n\tunsigned long quirks = (unsigned long)hid_get_drvdata(hdev);\n\n\tif ((usage->hid & HID_USAGE_PAGE) != HID_UP_CONSUMER ||\n\t\t\t!(quirks & BELKIN_WKBD))\n\t\treturn 0;\n\n\tswitch (usage->hid & HID_USAGE) {\n\tcase 0x03a: belkin_map_key_clear(KEY_SOUND);\t\tbreak;\n\tcase 0x03b: belkin_map_key_clear(KEY_CAMERA);\t\tbreak;\n\tcase 0x03c: belkin_map_key_clear(KEY_DOCUMENTS);\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\treturn 1;\n}\n\nstatic int belkin_probe(struct hid_device *hdev, const struct hid_device_id *id)\n{\n\tunsigned long quirks = id->driver_data;\n\tint ret;\n\n\thid_set_drvdata(hdev, (void *)quirks);\n\n\tret = hid_parse(hdev);\n\tif (ret) {\n\t\thid_err(hdev, \"parse failed\\n\");\n\t\tgoto err_free;\n\t}\n\n\tret = hid_hw_start(hdev, HID_CONNECT_DEFAULT |\n\t\t((quirks & BELKIN_HIDDEV) ? HID_CONNECT_HIDDEV_FORCE : 0));\n\tif (ret) {\n\t\thid_err(hdev, \"hw start failed\\n\");\n\t\tgoto err_free;\n\t}\n\n\treturn 0;\nerr_free:\n\treturn ret;\n}\n\nstatic const struct hid_device_id belkin_devices[] = {\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_BELKIN, USB_DEVICE_ID_FLIP_KVM),\n\t\t.driver_data = BELKIN_HIDDEV },\n\t{ HID_USB_DEVICE(USB_VENDOR_ID_LABTEC, USB_DEVICE_ID_LABTEC_WIRELESS_KEYBOARD),\n\t\t.driver_data = BELKIN_WKBD },\n\t{ }\n};\nMODULE_DEVICE_TABLE(hid, belkin_devices);\n\nstatic struct hid_driver belkin_driver = {\n\t.name = \"belkin\",\n\t.id_table = belkin_devices,\n\t.input_mapping = belkin_input_mapping,\n\t.probe = belkin_probe,\n};\nmodule_hid_driver(belkin_driver);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}