{
  "module_name": "hid-input-test.c",
  "hash_id": "1457b5395d5d41a5110667b3437c9bbb4ce6e6f1241ed930e113c48e91fb8a9e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hid/hid-input-test.c",
  "human_readable_source": "\n \n\n#include <kunit/test.h>\n\nstatic void hid_test_input_set_battery_charge_status(struct kunit *test)\n{\n\tstruct hid_device *dev;\n\tbool handled;\n\n\tdev = kunit_kzalloc(test, sizeof(*dev), GFP_KERNEL);\n\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, dev);\n\n\thandled = hidinput_set_battery_charge_status(dev, HID_DG_HEIGHT, 0);\n\tKUNIT_EXPECT_FALSE(test, handled);\n\tKUNIT_EXPECT_EQ(test, dev->battery_charge_status, POWER_SUPPLY_STATUS_UNKNOWN);\n\n\thandled = hidinput_set_battery_charge_status(dev, HID_BAT_CHARGING, 0);\n\tKUNIT_EXPECT_TRUE(test, handled);\n\tKUNIT_EXPECT_EQ(test, dev->battery_charge_status, POWER_SUPPLY_STATUS_DISCHARGING);\n\n\thandled = hidinput_set_battery_charge_status(dev, HID_BAT_CHARGING, 1);\n\tKUNIT_EXPECT_TRUE(test, handled);\n\tKUNIT_EXPECT_EQ(test, dev->battery_charge_status, POWER_SUPPLY_STATUS_CHARGING);\n}\n\nstatic void hid_test_input_get_battery_property(struct kunit *test)\n{\n\tstruct power_supply *psy;\n\tstruct hid_device *dev;\n\tunion power_supply_propval val;\n\tint ret;\n\n\tdev = kunit_kzalloc(test, sizeof(*dev), GFP_KERNEL);\n\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, dev);\n\tdev->battery_avoid_query = true;\n\n\tpsy = kunit_kzalloc(test, sizeof(*psy), GFP_KERNEL);\n\tKUNIT_ASSERT_NOT_ERR_OR_NULL(test, psy);\n\tpsy->drv_data = dev;\n\n\tdev->battery_status = HID_BATTERY_UNKNOWN;\n\tdev->battery_charge_status = POWER_SUPPLY_STATUS_CHARGING;\n\tret = hidinput_get_battery_property(psy, POWER_SUPPLY_PROP_STATUS, &val);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\tKUNIT_EXPECT_EQ(test, val.intval, POWER_SUPPLY_STATUS_UNKNOWN);\n\n\tdev->battery_status = HID_BATTERY_REPORTED;\n\tdev->battery_charge_status = POWER_SUPPLY_STATUS_CHARGING;\n\tret = hidinput_get_battery_property(psy, POWER_SUPPLY_PROP_STATUS, &val);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\tKUNIT_EXPECT_EQ(test, val.intval, POWER_SUPPLY_STATUS_CHARGING);\n\n\tdev->battery_status = HID_BATTERY_REPORTED;\n\tdev->battery_charge_status = POWER_SUPPLY_STATUS_DISCHARGING;\n\tret = hidinput_get_battery_property(psy, POWER_SUPPLY_PROP_STATUS, &val);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\tKUNIT_EXPECT_EQ(test, val.intval, POWER_SUPPLY_STATUS_DISCHARGING);\n}\n\nstatic struct kunit_case hid_input_tests[] = {\n\tKUNIT_CASE(hid_test_input_set_battery_charge_status),\n\tKUNIT_CASE(hid_test_input_get_battery_property),\n\t{ }\n};\n\nstatic struct kunit_suite hid_input_test_suite = {\n\t.name = \"hid_input\",\n\t.test_cases = hid_input_tests,\n};\n\nkunit_test_suite(hid_input_test_suite);\n\nMODULE_DESCRIPTION(\"HID input KUnit tests\");\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Jos\u00e9 Exp\u00f3sito <jose.exposito89@gmail.com>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}