{
  "module_name": "ufs-exynos.h",
  "hash_id": "f44d1d197a2648f66e1fbb33d76cf2642e2b56d3e5defbaf9d309017124d7e68",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ufs/host/ufs-exynos.h",
  "human_readable_source": " \n \n\n#ifndef _UFS_EXYNOS_H_\n#define _UFS_EXYNOS_H_\n\n \n#define UNIPRO_DBG_FORCE_DME_CTRL_STATE\t\t0x150\n\n \n#define PA_DBG_CLK_PERIOD\t0x9514\n#define PA_DBG_TXPHY_CFGUPDT\t0x9518\n#define PA_DBG_RXPHY_CFGUPDT\t0x9519\n#define PA_DBG_MODE\t\t0x9529\n#define PA_DBG_SKIP_RESET_PHY\t0x9539\n#define PA_DBG_AUTOMODE_THLD\t0x9536\n#define PA_DBG_OV_TM\t\t0x9540\n#define PA_DBG_SKIP_LINE_RESET\t0x9541\n#define PA_DBG_LINE_RESET_REQ\t0x9543\n#define PA_DBG_OPTION_SUITE\t0x9564\n#define PA_DBG_OPTION_SUITE_DYN\t0x9565\n\n \n#define T_DBG_SKIP_INIT_HIBERN8_EXIT\t0xc001\n\n \n#define TX_LINERESET_N_VAL\t0x0277\n#define TX_LINERESET_N(v)\t(((v) >> 10) & 0xFF)\n#define TX_LINERESET_P_VAL\t0x027D\n#define TX_LINERESET_P(v)\t(((v) >> 12) & 0xFF)\n#define TX_OV_SLEEP_CNT_TIMER\t0x028E\n#define TX_OV_H8_ENTER_EN\t(1 << 7)\n#define TX_OV_SLEEP_CNT(v)\t(((v) >> 5) & 0x7F)\n#define TX_HIGH_Z_CNT_11_08\t0x028C\n#define TX_HIGH_Z_CNT_H(v)\t(((v) >> 8) & 0xF)\n#define TX_HIGH_Z_CNT_07_00\t0x028D\n#define TX_HIGH_Z_CNT_L(v)\t((v) & 0xFF)\n#define TX_BASE_NVAL_07_00\t0x0293\n#define TX_BASE_NVAL_L(v)\t((v) & 0xFF)\n#define TX_BASE_NVAL_15_08\t0x0294\n#define TX_BASE_NVAL_H(v)\t(((v) >> 8) & 0xFF)\n#define TX_GRAN_NVAL_07_00\t0x0295\n#define TX_GRAN_NVAL_L(v)\t((v) & 0xFF)\n#define TX_GRAN_NVAL_10_08\t0x0296\n#define TX_GRAN_NVAL_H(v)\t(((v) >> 8) & 0x3)\n\n#define VND_TX_CLK_PRD\t\t0xAA\n#define VND_TX_CLK_PRD_EN\t0xA9\n#define VND_TX_LINERESET_PVALUE0\t0xAD\n#define VND_TX_LINERESET_PVALUE1\t0xAC\n#define VND_TX_LINERESET_PVALUE2\t0xAB\n\n#define TX_LINE_RESET_TIME\t3200\n\n#define VND_RX_CLK_PRD\t\t0x12\n#define VND_RX_CLK_PRD_EN\t0x11\n#define VND_RX_LINERESET_VALUE0\t0x1D\n#define VND_RX_LINERESET_VALUE1\t0x1C\n#define VND_RX_LINERESET_VALUE2\t0x1B\n\n#define RX_LINE_RESET_TIME\t1000\n\n#define RX_FILLER_ENABLE\t0x0316\n#define RX_FILLER_EN\t\t(1 << 1)\n#define RX_LINERESET_VAL\t0x0317\n#define RX_LINERESET(v)\t(((v) >> 12) & 0xFF)\n#define RX_LCC_IGNORE\t\t0x0318\n#define RX_SYNC_MASK_LENGTH\t0x0321\n#define RX_HIBERN8_WAIT_VAL_BIT_20_16\t0x0331\n#define RX_HIBERN8_WAIT_VAL_BIT_15_08\t0x0332\n#define RX_HIBERN8_WAIT_VAL_BIT_07_00\t0x0333\n#define RX_OV_SLEEP_CNT_TIMER\t0x0340\n#define RX_OV_SLEEP_CNT(v)\t(((v) >> 6) & 0x1F)\n#define RX_OV_STALL_CNT_TIMER\t0x0341\n#define RX_OV_STALL_CNT(v)\t(((v) >> 4) & 0xFF)\n#define RX_BASE_NVAL_07_00\t0x0355\n#define RX_BASE_NVAL_L(v)\t((v) & 0xFF)\n#define RX_BASE_NVAL_15_08\t0x0354\n#define RX_BASE_NVAL_H(v)\t(((v) >> 8) & 0xFF)\n#define RX_GRAN_NVAL_07_00\t0x0353\n#define RX_GRAN_NVAL_L(v)\t((v) & 0xFF)\n#define RX_GRAN_NVAL_10_08\t0x0352\n#define RX_GRAN_NVAL_H(v)\t(((v) >> 8) & 0x3)\n\n#define CMN_PWM_CLK_CTRL\t0x0402\n#define PWM_CLK_CTRL_MASK\t0x3\n\n#define IATOVAL_NSEC\t\t20000\t \n#define UNIPRO_PCLK_PERIOD(ufs) (NSEC_PER_SEC / ufs->pclk_rate)\n\nstruct exynos_ufs;\n\n \n#define SLOW 1\n#define FAST 2\n\n#define RX_ADV_FINE_GRAN_SUP_EN\t0x1\n#define RX_ADV_FINE_GRAN_STEP_VAL\t0x3\n#define RX_ADV_MIN_ACTV_TIME_CAP\t0x9\n\n#define PA_GRANULARITY_VAL\t0x6\n#define PA_TACTIVATE_VAL\t0x3\n#define PA_HIBERN8TIME_VAL\t0x20\n\n#define PCLK_AVAIL_MIN\t70000000\n#define PCLK_AVAIL_MAX\t167000000\n\nstruct exynos_ufs_uic_attr {\n\t \n\tunsigned int tx_trailingclks;\n\tunsigned int tx_dif_p_nsec;\n\tunsigned int tx_dif_n_nsec;\n\tunsigned int tx_high_z_cnt_nsec;\n\tunsigned int tx_base_unit_nsec;\n\tunsigned int tx_gran_unit_nsec;\n\tunsigned int tx_sleep_cnt;\n\tunsigned int tx_min_activatetime;\n\t \n\tunsigned int rx_filler_enable;\n\tunsigned int rx_dif_p_nsec;\n\tunsigned int rx_hibern8_wait_nsec;\n\tunsigned int rx_base_unit_nsec;\n\tunsigned int rx_gran_unit_nsec;\n\tunsigned int rx_sleep_cnt;\n\tunsigned int rx_stall_cnt;\n\tunsigned int rx_hs_g1_sync_len_cap;\n\tunsigned int rx_hs_g2_sync_len_cap;\n\tunsigned int rx_hs_g3_sync_len_cap;\n\tunsigned int rx_hs_g1_prep_sync_len_cap;\n\tunsigned int rx_hs_g2_prep_sync_len_cap;\n\tunsigned int rx_hs_g3_prep_sync_len_cap;\n\t \n\tunsigned int cmn_pwm_clk_ctrl;\n\t \n\tunsigned int pa_dbg_option_suite;\n\t \n\tunsigned int rx_adv_fine_gran_sup_en;\n\tunsigned int rx_adv_fine_gran_step;\n\tunsigned int rx_min_actv_time_cap;\n\tunsigned int rx_hibern8_time_cap;\n\tunsigned int rx_adv_min_actv_time_cap;\n\tunsigned int rx_adv_hibern8_time_cap;\n\tunsigned int pa_granularity;\n\tunsigned int pa_tactivate;\n\tunsigned int pa_hibern8time;\n};\n\nstruct exynos_ufs_drv_data {\n\tconst struct ufs_hba_variant_ops *vops;\n\tstruct exynos_ufs_uic_attr *uic_attr;\n\tunsigned int quirks;\n\tunsigned int opts;\n\t \n\tint (*drv_init)(struct device *dev, struct exynos_ufs *ufs);\n\tint (*pre_link)(struct exynos_ufs *ufs);\n\tint (*post_link)(struct exynos_ufs *ufs);\n\tint (*pre_pwr_change)(struct exynos_ufs *ufs,\n\t\t\t\tstruct ufs_pa_layer_attr *pwr);\n\tint (*post_pwr_change)(struct exynos_ufs *ufs,\n\t\t\t\tstruct ufs_pa_layer_attr *pwr);\n\tint (*pre_hce_enable)(struct exynos_ufs *ufs);\n\tint (*post_hce_enable)(struct exynos_ufs *ufs);\n};\n\nstruct ufs_phy_time_cfg {\n\tu32 tx_linereset_p;\n\tu32 tx_linereset_n;\n\tu32 tx_high_z_cnt;\n\tu32 tx_base_n_val;\n\tu32 tx_gran_n_val;\n\tu32 tx_sleep_cnt;\n\tu32 rx_linereset;\n\tu32 rx_hibern8_wait;\n\tu32 rx_base_n_val;\n\tu32 rx_gran_n_val;\n\tu32 rx_sleep_cnt;\n\tu32 rx_stall_cnt;\n};\n\nstruct exynos_ufs {\n\tstruct ufs_hba *hba;\n\tstruct phy *phy;\n\tvoid __iomem *reg_hci;\n\tvoid __iomem *reg_unipro;\n\tvoid __iomem *reg_ufsp;\n\tstruct clk *clk_hci_core;\n\tstruct clk *clk_unipro_main;\n\tstruct clk *clk_apb;\n\tu32 pclk_rate;\n\tu32 pclk_div;\n\tu32 pclk_avail_min;\n\tu32 pclk_avail_max;\n\tunsigned long mclk_rate;\n\tint avail_ln_rx;\n\tint avail_ln_tx;\n\tint rx_sel_idx;\n\tstruct ufs_pa_layer_attr dev_req_params;\n\tstruct ufs_phy_time_cfg t_cfg;\n\tktime_t entry_hibern8_t;\n\tconst struct exynos_ufs_drv_data *drv_data;\n\tstruct regmap *sysreg;\n\tu32 shareability_reg_offset;\n\n\tu32 opts;\n#define EXYNOS_UFS_OPT_HAS_APB_CLK_CTRL\t\tBIT(0)\n#define EXYNOS_UFS_OPT_SKIP_CONNECTION_ESTAB\tBIT(1)\n#define EXYNOS_UFS_OPT_BROKEN_AUTO_CLK_CTRL\tBIT(2)\n#define EXYNOS_UFS_OPT_BROKEN_RX_SEL_IDX\tBIT(3)\n#define EXYNOS_UFS_OPT_USE_SW_HIBERN8_TIMER\tBIT(4)\n#define EXYNOS_UFS_OPT_SKIP_CONFIG_PHY_ATTR\tBIT(5)\n};\n\n#define for_each_ufs_rx_lane(ufs, i) \\\n\tfor (i = (ufs)->rx_sel_idx; \\\n\t\ti < (ufs)->rx_sel_idx + (ufs)->avail_ln_rx; i++)\n#define for_each_ufs_tx_lane(ufs, i) \\\n\tfor (i = 0; i < (ufs)->avail_ln_tx; i++)\n\n#define EXYNOS_UFS_MMIO_FUNC(name)\t\t\t\t\t  \\\nstatic inline void name##_writel(struct exynos_ufs *ufs, u32 val, u32 reg)\\\n{\t\t\t\t\t\t\t\t\t  \\\n\twritel(val, ufs->reg_##name + reg);\t\t\t\t  \\\n}\t\t\t\t\t\t\t\t\t  \\\n\t\t\t\t\t\t\t\t\t  \\\nstatic inline u32 name##_readl(struct exynos_ufs *ufs, u32 reg)\t\t  \\\n{\t\t\t\t\t\t\t\t\t  \\\n\treturn readl(ufs->reg_##name + reg);\t\t\t\t  \\\n}\n\nEXYNOS_UFS_MMIO_FUNC(hci);\nEXYNOS_UFS_MMIO_FUNC(unipro);\nEXYNOS_UFS_MMIO_FUNC(ufsp);\n#undef EXYNOS_UFS_MMIO_FUNC\n\nlong exynos_ufs_calc_time_cntr(struct exynos_ufs *, long);\n\nstatic inline void exynos_ufs_enable_ov_tm(struct ufs_hba *hba)\n{\n\tufshcd_dme_set(hba, UIC_ARG_MIB(PA_DBG_OV_TM), true);\n}\n\nstatic inline void exynos_ufs_disable_ov_tm(struct ufs_hba *hba)\n{\n\tufshcd_dme_set(hba, UIC_ARG_MIB(PA_DBG_OV_TM), false);\n}\n\nstatic inline void exynos_ufs_enable_dbg_mode(struct ufs_hba *hba)\n{\n\tufshcd_dme_set(hba, UIC_ARG_MIB(PA_DBG_MODE), true);\n}\n\nstatic inline void exynos_ufs_disable_dbg_mode(struct ufs_hba *hba)\n{\n\tufshcd_dme_set(hba, UIC_ARG_MIB(PA_DBG_MODE), false);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}