{
  "module_name": "ufs-mediatek.h",
  "hash_id": "66422cba86add703b83d732ddf7ba8926ee7f1ca3e3ec079f3075b63a79abdca",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ufs/host/ufs-mediatek.h",
  "human_readable_source": " \n \n\n#ifndef _UFS_MEDIATEK_H\n#define _UFS_MEDIATEK_H\n\n#include <linux/bitops.h>\n#include <linux/pm_qos.h>\n#include <linux/soc/mediatek/mtk_sip_svc.h>\n\n \n#define UFSHCD_MAX_Q_NR 8\n#define MTK_MCQ_INVALID_IRQ\t0xFFFF\n\n \n#define EHS_EN                  BIT(0)\n#define PFM_IMPV                BIT(1)\n#define MCQ_MULTI_INTR_EN       BIT(2)\n#define MCQ_CMB_INTR_EN         BIT(3)\n#define MCQ_AH8                 BIT(4)\n\n#define MCQ_INTR_EN_MSK         (MCQ_MULTI_INTR_EN | MCQ_CMB_INTR_EN)\n\n \n#define REG_UFS_XOUFS_CTRL          0x140\n#define REG_UFS_REFCLK_CTRL         0x144\n#define REG_UFS_MMIO_OPT_CTRL_0     0x160\n#define REG_UFS_EXTREG              0x2100\n#define REG_UFS_MPHYCTRL            0x2200\n#define REG_UFS_MTK_IP_VER          0x2240\n#define REG_UFS_REJECT_MON          0x22AC\n#define REG_UFS_DEBUG_SEL           0x22C0\n#define REG_UFS_PROBE               0x22C8\n#define REG_UFS_DEBUG_SEL_B0        0x22D0\n#define REG_UFS_DEBUG_SEL_B1        0x22D4\n#define REG_UFS_DEBUG_SEL_B2        0x22D8\n#define REG_UFS_DEBUG_SEL_B3        0x22DC\n\n#define REG_UFS_MTK_SQD             0x2800\n#define REG_UFS_MTK_SQIS            0x2814\n#define REG_UFS_MTK_CQD             0x281C\n#define REG_UFS_MTK_CQIS            0x2824\n\n#define REG_UFS_MCQ_STRIDE          0x30\n\n \n#define REFCLK_RELEASE              0x0\n#define REFCLK_REQUEST              BIT(0)\n#define REFCLK_ACK                  BIT(1)\n\n#define REFCLK_REQ_TIMEOUT_US       3000\n#define REFCLK_DEFAULT_WAIT_US      32\n\n \n#define VS_DEBUGCLOCKENABLE         0xD0A1\n#define VS_SAVEPOWERCONTROL         0xD0A6\n#define VS_UNIPROPOWERDOWNCONTROL   0xD0A8\n\n \nenum {\n\tVS_LINK_DISABLED            = 0,\n\tVS_LINK_DOWN                = 1,\n\tVS_LINK_UP                  = 2,\n\tVS_LINK_HIBERN8             = 3,\n\tVS_LINK_LOST                = 4,\n\tVS_LINK_CFG                 = 5,\n};\n\n \nenum {\n\tVS_HCE_RESET                = 0,\n\tVS_HCE_BASE                 = 1,\n\tVS_HCE_OOCPR_WAIT           = 2,\n\tVS_HCE_DME_RESET            = 3,\n\tVS_HCE_MIDDLE               = 4,\n\tVS_HCE_DME_ENABLE           = 5,\n\tVS_HCE_DEFAULTS             = 6,\n\tVS_HIB_IDLEEN               = 7,\n\tVS_HIB_ENTER                = 8,\n\tVS_HIB_ENTER_CONF           = 9,\n\tVS_HIB_MIDDLE               = 10,\n\tVS_HIB_WAITTIMER            = 11,\n\tVS_HIB_EXIT_CONF            = 12,\n\tVS_HIB_EXIT                 = 13,\n};\n\n \n#define MTK_SIP_UFS_CONTROL               MTK_SIP_SMC_CMD(0x276)\n#define UFS_MTK_SIP_VA09_PWR_CTRL         BIT(0)\n#define UFS_MTK_SIP_DEVICE_RESET          BIT(1)\n#define UFS_MTK_SIP_CRYPTO_CTRL           BIT(2)\n#define UFS_MTK_SIP_REF_CLK_NOTIFICATION  BIT(3)\n#define UFS_MTK_SIP_HOST_PWR_CTRL         BIT(5)\n#define UFS_MTK_SIP_GET_VCC_NUM           BIT(6)\n#define UFS_MTK_SIP_DEVICE_PWR_CTRL       BIT(7)\n\n \nenum {\n\tTX_SYMBOL_CLK_REQ_FORCE = 5,\n};\n\n \nenum {\n\tRX_SYMBOL_CLK_GATE_EN   = 0,\n\tSYS_CLK_GATE_EN         = 2,\n\tTX_CLK_GATE_EN          = 3,\n};\n\n \nenum ufs_mtk_host_caps {\n\tUFS_MTK_CAP_BOOST_CRYPT_ENGINE         = 1 << 0,\n\tUFS_MTK_CAP_VA09_PWR_CTRL              = 1 << 1,\n\tUFS_MTK_CAP_DISABLE_AH8                = 1 << 2,\n\tUFS_MTK_CAP_BROKEN_VCC                 = 1 << 3,\n\tUFS_MTK_CAP_PMC_VIA_FASTAUTO           = 1 << 6,\n};\n\nstruct ufs_mtk_crypt_cfg {\n\tstruct regulator *reg_vcore;\n\tstruct clk *clk_crypt_perf;\n\tstruct clk *clk_crypt_mux;\n\tstruct clk *clk_crypt_lp;\n\tint vcore_volt;\n};\n\nstruct ufs_mtk_clk {\n\tstruct ufs_clk_info *ufs_sel_clki;  \n\tstruct ufs_clk_info *ufs_sel_max_clki;  \n\tstruct ufs_clk_info *ufs_sel_min_clki;  \n};\n\nstruct ufs_mtk_hw_ver {\n\tu8 step;\n\tu8 minor;\n\tu8 major;\n};\n\nstruct ufs_mtk_mcq_intr_info {\n\tstruct ufs_hba *hba;\n\tu32 irq;\n\tu8 qid;\n};\n\nstruct ufs_mtk_host {\n\tstruct phy *mphy;\n\tstruct pm_qos_request pm_qos_req;\n\tstruct regulator *reg_va09;\n\tstruct reset_control *hci_reset;\n\tstruct reset_control *unipro_reset;\n\tstruct reset_control *crypto_reset;\n\tstruct ufs_hba *hba;\n\tstruct ufs_mtk_crypt_cfg *crypt;\n\tstruct ufs_mtk_clk mclk;\n\tstruct ufs_mtk_hw_ver hw_ver;\n\tenum ufs_mtk_host_caps caps;\n\tbool mphy_powered_on;\n\tbool pm_qos_init;\n\tbool unipro_lpm;\n\tbool ref_clk_enabled;\n\tu16 ref_clk_ungating_wait_us;\n\tu16 ref_clk_gating_wait_us;\n\tu32 ip_ver;\n\n\tbool mcq_set_intr;\n\tint mcq_nr_intr;\n\tstruct ufs_mtk_mcq_intr_info mcq_intr_info[UFSHCD_MAX_Q_NR];\n};\n\n \nenum ufs_mtk_vcc_num {\n\tUFS_VCC_NONE = 0,\n\tUFS_VCC_1,\n\tUFS_VCC_2,\n\tUFS_VCC_MAX\n};\n\n \nenum {\n\tHOST_PWR_HCI = 0,\n\tHOST_PWR_MPHY\n};\n\n \nstruct ufs_mtk_smc_arg {\n\tunsigned long cmd;\n\tstruct arm_smccc_res *res;\n\tunsigned long v1;\n\tunsigned long v2;\n\tunsigned long v3;\n\tunsigned long v4;\n\tunsigned long v5;\n\tunsigned long v6;\n\tunsigned long v7;\n};\n\nstatic void _ufs_mtk_smc(struct ufs_mtk_smc_arg s)\n{\n\tarm_smccc_smc(MTK_SIP_UFS_CONTROL,\n\t\t      s.cmd, s.v1, s.v2, s.v3, s.v4, s.v5, s.v6, s.res);\n}\n\n#define ufs_mtk_smc(...) \\\n\t_ufs_mtk_smc((struct ufs_mtk_smc_arg) {__VA_ARGS__})\n\n \n#define ufs_mtk_va09_pwr_ctrl(res, on) \\\n\tufs_mtk_smc(UFS_MTK_SIP_VA09_PWR_CTRL, &(res), on)\n\n#define ufs_mtk_crypto_ctrl(res, enable) \\\n\tufs_mtk_smc(UFS_MTK_SIP_CRYPTO_CTRL, &(res), enable)\n\n#define ufs_mtk_ref_clk_notify(on, stage, res) \\\n\tufs_mtk_smc(UFS_MTK_SIP_REF_CLK_NOTIFICATION, &(res), on, stage)\n\n#define ufs_mtk_device_reset_ctrl(high, res) \\\n\tufs_mtk_smc(UFS_MTK_SIP_DEVICE_RESET, &(res), high)\n\n#define ufs_mtk_host_pwr_ctrl(opt, on, res) \\\n\tufs_mtk_smc(UFS_MTK_SIP_HOST_PWR_CTRL, &(res), opt, on)\n\n#define ufs_mtk_get_vcc_num(res) \\\n\tufs_mtk_smc(UFS_MTK_SIP_GET_VCC_NUM, &(res))\n\n#define ufs_mtk_device_pwr_ctrl(on, ufs_ver, res) \\\n\tufs_mtk_smc(UFS_MTK_SIP_DEVICE_PWR_CTRL, &(res), on, ufs_ver)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}