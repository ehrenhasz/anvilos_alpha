{
  "module_name": "ufshcd-crypto.h",
  "hash_id": "8e4a78b826fe56431e7592c7f096036c75179d55fa41c929ce36202ac4bcd685",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ufs/core/ufshcd-crypto.h",
  "human_readable_source": " \n \n\n#ifndef _UFSHCD_CRYPTO_H\n#define _UFSHCD_CRYPTO_H\n\n#include <scsi/scsi_cmnd.h>\n#include <ufs/ufshcd.h>\n#include \"ufshcd-priv.h\"\n#include <ufs/ufshci.h>\n\n#ifdef CONFIG_SCSI_UFS_CRYPTO\n\nstatic inline void ufshcd_prepare_lrbp_crypto(struct request *rq,\n\t\t\t\t\t      struct ufshcd_lrb *lrbp)\n{\n\tif (!rq || !rq->crypt_keyslot) {\n\t\tlrbp->crypto_key_slot = -1;\n\t\treturn;\n\t}\n\n\tlrbp->crypto_key_slot = blk_crypto_keyslot_index(rq->crypt_keyslot);\n\tlrbp->data_unit_num = rq->crypt_ctx->bc_dun[0];\n}\n\nstatic inline void\nufshcd_prepare_req_desc_hdr_crypto(struct ufshcd_lrb *lrbp,\n\t\t\t\t   struct request_desc_header *h)\n{\n\tif (lrbp->crypto_key_slot < 0)\n\t\treturn;\n\th->enable_crypto = 1;\n\th->cci = lrbp->crypto_key_slot;\n\th->dunl = cpu_to_le32(lower_32_bits(lrbp->data_unit_num));\n\th->dunu = cpu_to_le32(upper_32_bits(lrbp->data_unit_num));\n}\n\nbool ufshcd_crypto_enable(struct ufs_hba *hba);\n\nint ufshcd_hba_init_crypto_capabilities(struct ufs_hba *hba);\n\nvoid ufshcd_init_crypto(struct ufs_hba *hba);\n\nvoid ufshcd_crypto_register(struct ufs_hba *hba, struct request_queue *q);\n\n#else  \n\nstatic inline void ufshcd_prepare_lrbp_crypto(struct request *rq,\n\t\t\t\t\t      struct ufshcd_lrb *lrbp) { }\n\nstatic inline void\nufshcd_prepare_req_desc_hdr_crypto(struct ufshcd_lrb *lrbp,\n\t\t\t\t   struct request_desc_header *h) { }\n\nstatic inline bool ufshcd_crypto_enable(struct ufs_hba *hba)\n{\n\treturn false;\n}\n\nstatic inline int ufshcd_hba_init_crypto_capabilities(struct ufs_hba *hba)\n{\n\treturn 0;\n}\n\nstatic inline void ufshcd_init_crypto(struct ufs_hba *hba) { }\n\nstatic inline void ufshcd_crypto_register(struct ufs_hba *hba,\n\t\t\t\t\t  struct request_queue *q) { }\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}