{
  "module_name": "evbug.c",
  "hash_id": "a99b0133982c6ee4ad881bf8999222226035cc7f45b08a89471985d02d9c2dca",
  "original_prompt": "Ingested from linux-6.6.14/drivers/input/evbug.c",
  "human_readable_source": "\n \n\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/input.h>\n#include <linux/init.h>\n#include <linux/device.h>\n\nMODULE_AUTHOR(\"Vojtech Pavlik <vojtech@ucw.cz>\");\nMODULE_DESCRIPTION(\"Input driver event debug module\");\nMODULE_LICENSE(\"GPL\");\n\nstatic void evbug_event(struct input_handle *handle, unsigned int type, unsigned int code, int value)\n{\n\tprintk(KERN_DEBUG pr_fmt(\"Event. Dev: %s, Type: %d, Code: %d, Value: %d\\n\"),\n\t       dev_name(&handle->dev->dev), type, code, value);\n}\n\nstatic int evbug_connect(struct input_handler *handler, struct input_dev *dev,\n\t\t\t const struct input_device_id *id)\n{\n\tstruct input_handle *handle;\n\tint error;\n\n\thandle = kzalloc(sizeof(struct input_handle), GFP_KERNEL);\n\tif (!handle)\n\t\treturn -ENOMEM;\n\n\thandle->dev = dev;\n\thandle->handler = handler;\n\thandle->name = \"evbug\";\n\n\terror = input_register_handle(handle);\n\tif (error)\n\t\tgoto err_free_handle;\n\n\terror = input_open_device(handle);\n\tif (error)\n\t\tgoto err_unregister_handle;\n\n\tprintk(KERN_DEBUG pr_fmt(\"Connected device: %s (%s at %s)\\n\"),\n\t       dev_name(&dev->dev),\n\t       dev->name ?: \"unknown\",\n\t       dev->phys ?: \"unknown\");\n\n\treturn 0;\n\n err_unregister_handle:\n\tinput_unregister_handle(handle);\n err_free_handle:\n\tkfree(handle);\n\treturn error;\n}\n\nstatic void evbug_disconnect(struct input_handle *handle)\n{\n\tprintk(KERN_DEBUG pr_fmt(\"Disconnected device: %s\\n\"),\n\t       dev_name(&handle->dev->dev));\n\n\tinput_close_device(handle);\n\tinput_unregister_handle(handle);\n\tkfree(handle);\n}\n\nstatic const struct input_device_id evbug_ids[] = {\n\t{ .driver_info = 1 },\t \n\t{ },\t\t\t \n};\n\nMODULE_DEVICE_TABLE(input, evbug_ids);\n\nstatic struct input_handler evbug_handler = {\n\t.event =\tevbug_event,\n\t.connect =\tevbug_connect,\n\t.disconnect =\tevbug_disconnect,\n\t.name =\t\t\"evbug\",\n\t.id_table =\tevbug_ids,\n};\n\nstatic int __init evbug_init(void)\n{\n\treturn input_register_handler(&evbug_handler);\n}\n\nstatic void __exit evbug_exit(void)\n{\n\tinput_unregister_handler(&evbug_handler);\n}\n\nmodule_init(evbug_init);\nmodule_exit(evbug_exit);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}