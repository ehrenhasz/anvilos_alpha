{
  "module_name": "cyttsp_i2c_common.c",
  "hash_id": "cd10cceecd6c68ef86c84b22382960f0e2b058e438501c42a0a9e1346552d145",
  "original_prompt": "Ingested from linux-6.6.14/drivers/input/touchscreen/cyttsp_i2c_common.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/export.h>\n#include <linux/i2c.h>\n#include <linux/module.h>\n#include <linux/types.h>\n\n#include \"cyttsp4_core.h\"\n\nint cyttsp_i2c_read_block_data(struct device *dev, u8 *xfer_buf,\n\t\t\t\t      u16 addr, u8 length, void *values)\n{\n\tstruct i2c_client *client = to_i2c_client(dev);\n\tu8 client_addr = client->addr | ((addr >> 8) & 0x1);\n\tu8 addr_lo = addr & 0xFF;\n\tstruct i2c_msg msgs[] = {\n\t\t{\n\t\t\t.addr = client_addr,\n\t\t\t.flags = 0,\n\t\t\t.len = 1,\n\t\t\t.buf = &addr_lo,\n\t\t},\n\t\t{\n\t\t\t.addr = client_addr,\n\t\t\t.flags = I2C_M_RD,\n\t\t\t.len = length,\n\t\t\t.buf = values,\n\t\t},\n\t};\n\tint retval;\n\n\tretval = i2c_transfer(client->adapter, msgs, ARRAY_SIZE(msgs));\n\tif (retval < 0)\n\t\treturn retval;\n\n\treturn retval != ARRAY_SIZE(msgs) ? -EIO : 0;\n}\nEXPORT_SYMBOL_GPL(cyttsp_i2c_read_block_data);\n\nint cyttsp_i2c_write_block_data(struct device *dev, u8 *xfer_buf,\n\t\t\t\t       u16 addr, u8 length, const void *values)\n{\n\tstruct i2c_client *client = to_i2c_client(dev);\n\tu8 client_addr = client->addr | ((addr >> 8) & 0x1);\n\tu8 addr_lo = addr & 0xFF;\n\tstruct i2c_msg msgs[] = {\n\t\t{\n\t\t\t.addr = client_addr,\n\t\t\t.flags = 0,\n\t\t\t.len = length + 1,\n\t\t\t.buf = xfer_buf,\n\t\t},\n\t};\n\tint retval;\n\n\txfer_buf[0] = addr_lo;\n\tmemcpy(&xfer_buf[1], values, length);\n\n\tretval = i2c_transfer(client->adapter, msgs, ARRAY_SIZE(msgs));\n\tif (retval < 0)\n\t\treturn retval;\n\n\treturn retval != ARRAY_SIZE(msgs) ? -EIO : 0;\n}\nEXPORT_SYMBOL_GPL(cyttsp_i2c_write_block_data);\n\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Cypress\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}