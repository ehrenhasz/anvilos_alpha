{
  "module_name": "makemapdata.c",
  "hash_id": "6ce971da787959a06016d0cc9b46ccce9c480b5e2355305cf80e8e95133b213f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/accessibility/speakup/makemapdata.c",
  "human_readable_source": "\n \n\n#include <stdlib.h>\n#include <stdio.h>\n#include <libgen.h>\n#include <string.h>\n#include <linux/version.h>\n#include <ctype.h>\n#include \"utils.h\"\n\nstatic char buffer[256];\n\nstatic int get_define(void)\n{\n\tchar *c;\n\n\twhile (fgets(buffer, sizeof(buffer)-1, infile)) {\n\t\tlc++;\n\t\tif (strncmp(buffer, \"#define\", 7))\n\t\t\tcontinue;\n\t\tc = buffer + 7;\n\t\twhile (*c == ' ' || *c == '\\t')\n\t\t\tc++;\n\t\tdef_name = c;\n\t\twhile (*c && *c != ' ' && *c != '\\t' && *c != '\\n')\n\t\t\tc++;\n\t\tif (!*c || *c == '\\n')\n\t\t\tcontinue;\n\t\t*c++ = '\\0';\n\t\twhile (*c == ' ' || *c == '\\t' || *c == '(')\n\t\t\tc++;\n\t\tdef_val = c;\n\t\twhile (*c && *c != '\\n' && *c != ')')\n\t\t\tc++;\n\t\t*c++ = '\\0';\n\t\treturn 1;\n\t}\n\tfclose(infile);\n\tinfile = 0;\n\treturn 0;\n}\n\nint\nmain(int argc, char *argv[])\n{\n\tint value, i;\n\tstruct st_key *this;\n\tconst char *dir_name, *spk_dir_name;\n\tchar *cp;\n\n\tdir_name = getenv(\"TOPDIR\");\n\tif (!dir_name)\n\t\tdir_name = \".\";\n\tspk_dir_name = getenv(\"SPKDIR\");\n\tif (!spk_dir_name)\n\t\tspk_dir_name = \"drivers/accessibility/speakup\";\n\tbzero(key_table, sizeof(key_table));\n\tadd_key(\"shift\",\t1, is_shift);\n\tadd_key(\"altgr\",\t2, is_shift);\n\tadd_key(\"ctrl\",\t4, is_shift);\n\tadd_key(\"alt\",\t8, is_shift);\n\tadd_key(\"spk\", 16, is_shift);\n\tadd_key(\"double\", 32, is_shift);\n\n\topen_input(dir_name, \"include/linux/input.h\");\n\twhile (get_define()) {\n\t\tif (strncmp(def_name, \"KEY_\", 4))\n\t\t\tcontinue;\n\t\tvalue = atoi(def_val);\n\t\tif (value > 0 && value < MAXKEYVAL)\n\t\t\tadd_key(def_name, value, is_input);\n\t}\n\n\topen_input(dir_name, \"include/uapi/linux/input-event-codes.h\");\n\twhile (get_define()) {\n\t\tif (strncmp(def_name, \"KEY_\", 4))\n\t\t\tcontinue;\n\t\tvalue = atoi(def_val);\n\t\tif (value > 0 && value < MAXKEYVAL)\n\t\t\tadd_key(def_name, value, is_input);\n\t}\n\n\topen_input(spk_dir_name, \"spk_priv_keyinfo.h\");\n\twhile (get_define()) {\n\t\tif (strlen(def_val) > 5) {\n\t\t\t\n\t\t\t\n\t\t\tcp = strchr(def_val, '+');\n\t\t\tif (!cp)\n\t\t\t\tcontinue;\n\t\t\tif (cp[-1] == ' ')\n\t\t\t\tcp[-1] = '\\0';\n\t\t\t*cp++ = '\\0';\n\t\t\tthis = find_key(def_val);\n\t\t\twhile (*cp == ' ')\n\t\t\t\tcp++;\n\t\t\tif (!this || *cp < '0' || *cp > '9')\n\t\t\t\tcontinue;\n\t\t\tvalue = this->value+atoi(cp);\n\t\t} else if (!strncmp(def_val, \"0x\", 2))\n\t\t\tsscanf(def_val+2, \"%x\", &value);\n\t\telse if (*def_val >= '0' && *def_val <= '9')\n\t\t\tvalue = atoi(def_val);\n\t\telse\n\t\t\tcontinue;\n\t\tadd_key(def_name, value, is_spk);\n\t}\n\n\tprintf(\"struct st_key_init init_key_data[] = {\\n\");\n\tfor (i = 0; i < HASHSIZE; i++) {\n\t\tthis = &key_table[i];\n\t\tif (!this->name)\n\t\t\tcontinue;\n\t\tdo {\n\t\t\tprintf(\"\\t{ \\\"%s\\\", %d, %d, },\\n\", this->name, this->value, this->shift);\n\t\t\tthis = this->next;\n\t\t} while (this);\n\t}\n\tprintf(\"\\t{ \\\".\\\", 0, 0 }\\n};\\n\");\n\n\texit(0);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}