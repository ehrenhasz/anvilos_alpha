{
  "module_name": "utils.h",
  "hash_id": "469e4574033516fe0f46c8825824b75533b5e7eb102a72b7b0aba002ae43fc15",
  "original_prompt": "Ingested from linux-6.6.14/drivers/accessibility/speakup/utils.h",
  "human_readable_source": " \n \n\n#include <stdio.h>\n\n#define MAXKEYS 512\n#define MAXKEYVAL 160\n#define HASHSIZE 101\n#define is_shift -3\n#define is_spk -2\n#define is_input -1\n\nstruct st_key {\n\tchar *name;\n\tstruct st_key *next;\n\tint value, shift;\n};\n\nstruct st_key key_table[MAXKEYS];\nstruct st_key *extra_keys = key_table+HASHSIZE;\nchar *def_name, *def_val;\nFILE *infile;\nint lc;\n\nchar filename[256];\n\nstatic inline void open_input(const char *dir_name, const char *name)\n{\n\tif (dir_name)\n\t\tsnprintf(filename, sizeof(filename), \"%s/%s\", dir_name, name);\n\telse\n\t\tsnprintf(filename, sizeof(filename), \"%s\", name);\n\tinfile = fopen(filename, \"r\");\n\tif (infile == 0) {\n\t\tfprintf(stderr, \"can't open %s\\n\", filename);\n\t\texit(1);\n\t}\n\tlc = 0;\n}\n\nstatic inline int oops(const char *msg, const char *info)\n{\n\tif (info == NULL)\n\t\tinfo = \"\";\n\tfprintf(stderr, \"error: file %s line %d\\n\", filename, lc);\n\tfprintf(stderr, \"%s %s\\n\", msg, info);\n\texit(1);\n}\n\nstatic inline struct st_key *hash_name(char *name)\n{\n\tunsigned char *pn = (unsigned char *)name;\n\tint hash = 0;\n\n\twhile (*pn) {\n\t\thash = (hash * 17) & 0xfffffff;\n\t\tif (isupper(*pn))\n\t\t\t*pn = tolower(*pn);\n\t\thash += (int)*pn;\n\t\tpn++;\n\t}\n\thash %= HASHSIZE;\n\treturn &key_table[hash];\n}\n\nstatic inline struct st_key *find_key(char *name)\n{\n\tstruct st_key *this = hash_name(name);\n\n\twhile (this) {\n\t\tif (this->name && !strcmp(name, this->name))\n\t\t\treturn this;\n\t\tthis = this->next;\n\t}\n\treturn this;\n}\n\nstatic inline struct st_key *add_key(char *name, int value, int shift)\n{\n\tstruct st_key *this = hash_name(name);\n\n\tif (extra_keys-key_table >= MAXKEYS)\n\t\toops(\"out of key table space, enlarge MAXKEYS\", NULL);\n\tif (this->name != NULL) {\n\t\twhile (this->next) {\n\t\t\tif (!strcmp(name, this->name))\n\t\t\t\toops(\"attempt to add duplicate key\", name);\n\t\t\tthis = this->next;\n\t\t}\n\t\tthis->next = extra_keys++;\n\t\tthis = this->next;\n\t}\n\tthis->name = strdup(name);\n\tthis->value = value;\n\tthis->shift = shift;\n\treturn this;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}