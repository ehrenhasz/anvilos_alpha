{
  "module_name": "zcrypt_ep11misc.h",
  "hash_id": "2578cdbbf2b3b8ca382097f6a92cbb7fd5bb43a07eec2e5e279346762e7197cd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/crypto/zcrypt_ep11misc.h",
  "human_readable_source": " \n \n\n#ifndef _ZCRYPT_EP11MISC_H_\n#define _ZCRYPT_EP11MISC_H_\n\n#include <asm/zcrypt.h>\n#include <asm/pkey.h>\n\n#define EP11_API_V1 1   \n#define EP11_API_V4 4   \n#define EP11_API_V6 6   \n#define EP11_STRUCT_MAGIC 0x1234\n#define EP11_BLOB_PKEY_EXTRACTABLE 0x00200000\n\n \n#define TOKVER_EP11_AES  0x03   \n#define TOKVER_EP11_AES_WITH_HEADER 0x06  \n#define TOKVER_EP11_ECC_WITH_HEADER 0x07  \n\n \nstruct ep11keyblob {\n\tunion {\n\t\tu8 session[32];\n\t\t \n\t\tstruct ep11kblob_header head;\n\t};\n\tu8  wkvp[16];   \n\tu64 attr;       \n\tu64 mode;       \n\tu16 version;    \n\tu8  iv[14];\n\tu8  encrypted_key_data[144];\n\tu8  mac[32];\n} __packed;\n\n \nstatic inline bool is_ep11_keyblob(const u8 *key)\n{\n\tstruct ep11keyblob *kb = (struct ep11keyblob *)key;\n\n\treturn (kb->version == EP11_STRUCT_MAGIC);\n}\n\n \nconst u8 *ep11_kb_wkvp(const u8 *kblob, size_t kbloblen);\n\n \nint ep11_check_aes_key_with_hdr(debug_info_t *dbg, int dbflvl,\n\t\t\t\tconst u8 *key, size_t keylen, int checkcpacfexp);\n\n \nint ep11_check_ecc_key_with_hdr(debug_info_t *dbg, int dbflvl,\n\t\t\t\tconst u8 *key, size_t keylen, int checkcpacfexp);\n\n \nint ep11_check_aes_key(debug_info_t *dbg, int dbflvl,\n\t\t       const u8 *key, size_t keylen, int checkcpacfexp);\n\n \nstruct ep11_card_info {\n\tu32  API_ord_nr;     \n\tu16  FW_version;     \n\tchar serial[16];     \n\tu64  op_mode;\t     \n};\n\n \nstruct ep11_domain_info {\n\tchar cur_wk_state;   \n\tchar new_wk_state;   \n\tu8   cur_wkvp[32];   \n\tu8   new_wkvp[32];   \n\tu64  op_mode;\t     \n};\n\n \nint ep11_get_card_info(u16 card, struct ep11_card_info *info, int verify);\n\n \nint ep11_get_domain_info(u16 card, u16 domain, struct ep11_domain_info *info);\n\n \nint ep11_genaeskey(u16 card, u16 domain, u32 keybitsize, u32 keygenflags,\n\t\t   u8 *keybuf, size_t *keybufsize, u32 keybufver);\n\n \nint ep11_clr2keyblob(u16 cardnr, u16 domain, u32 keybitsize, u32 keygenflags,\n\t\t     const u8 *clrkey, u8 *keybuf, size_t *keybufsize,\n\t\t     u32 keytype);\n\n \nint ep11_findcard2(u32 **apqns, u32 *nr_apqns, u16 cardnr, u16 domain,\n\t\t   int minhwtype, int minapi, const u8 *wkvp);\n\n \nint ep11_kblob2protkey(u16 card, u16 dom, const u8 *key, size_t keylen,\n\t\t       u8 *protkey, u32 *protkeylen, u32 *protkeytype);\n\nvoid zcrypt_ep11misc_exit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}