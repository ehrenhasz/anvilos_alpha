{
  "module_name": "vfio_ap_private.h",
  "hash_id": "d8f1337ad5c2c50686a6cc580a2316a6949021d4bf78212bc28d7e1ed14bcf07",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/crypto/vfio_ap_private.h",
  "human_readable_source": " \n \n\n#ifndef _VFIO_AP_PRIVATE_H_\n#define _VFIO_AP_PRIVATE_H_\n\n#include <linux/types.h>\n#include <linux/mdev.h>\n#include <linux/delay.h>\n#include <linux/eventfd.h>\n#include <linux/mutex.h>\n#include <linux/kvm_host.h>\n#include <linux/vfio.h>\n#include <linux/hashtable.h>\n\n#include \"ap_bus.h\"\n\n#define VFIO_AP_MODULE_NAME \"vfio_ap\"\n#define VFIO_AP_DRV_NAME \"vfio_ap\"\n\n \nstruct ap_matrix_dev {\n\tstruct device device;\n\tstruct ap_config_info info;\n\tstruct list_head mdev_list;\n\tstruct mutex mdevs_lock;  \n\tstruct ap_driver  *vfio_ap_drv;\n\tstruct mutex guests_lock;  \n\tstruct mdev_parent parent;\n\tstruct mdev_type mdev_type;\n\tstruct mdev_type *mdev_types[1];\n};\n\nextern struct ap_matrix_dev *matrix_dev;\n\n \nstruct ap_matrix {\n\tunsigned long apm_max;\n\tDECLARE_BITMAP(apm, 256);\n\tunsigned long aqm_max;\n\tDECLARE_BITMAP(aqm, 256);\n\tunsigned long adm_max;\n\tDECLARE_BITMAP(adm, 256);\n};\n\n \nstruct ap_queue_table {\n\tDECLARE_HASHTABLE(queues, 8);\n};\n\n \nstruct ap_matrix_mdev {\n\tstruct vfio_device vdev;\n\tstruct list_head node;\n\tstruct ap_matrix matrix;\n\tstruct ap_matrix shadow_apcb;\n\tstruct kvm *kvm;\n\tcrypto_hook pqap_hook;\n\tstruct mdev_device *mdev;\n\tstruct ap_queue_table qtable;\n\tstruct eventfd_ctx *req_trigger;\n\tDECLARE_BITMAP(apm_add, AP_DEVICES);\n\tDECLARE_BITMAP(aqm_add, AP_DOMAINS);\n\tDECLARE_BITMAP(adm_add, AP_DOMAINS);\n};\n\n \nstruct vfio_ap_queue {\n\tstruct ap_matrix_mdev *matrix_mdev;\n\tdma_addr_t saved_iova;\n\tint\tapqn;\n#define VFIO_AP_ISC_INVALID 0xff\n\tunsigned char saved_isc;\n\tstruct hlist_node mdev_qnode;\n\tstruct ap_queue_status reset_status;\n\tstruct work_struct reset_work;\n};\n\nint vfio_ap_mdev_register(void);\nvoid vfio_ap_mdev_unregister(void);\n\nint vfio_ap_mdev_probe_queue(struct ap_device *queue);\nvoid vfio_ap_mdev_remove_queue(struct ap_device *queue);\n\nint vfio_ap_mdev_resource_in_use(unsigned long *apm, unsigned long *aqm);\n\nvoid vfio_ap_on_cfg_changed(struct ap_config_info *new_config_info,\n\t\t\t    struct ap_config_info *old_config_info);\nvoid vfio_ap_on_scan_complete(struct ap_config_info *new_config_info,\n\t\t\t      struct ap_config_info *old_config_info);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}