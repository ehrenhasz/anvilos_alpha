{
  "module_name": "zcrypt_api.h",
  "hash_id": "beee52ea385e42aade70eb3a423b3c29f08f69c9776b9bc21ab0194768a6312c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/crypto/zcrypt_api.h",
  "human_readable_source": " \n \n\n#ifndef _ZCRYPT_API_H_\n#define _ZCRYPT_API_H_\n\n#include <linux/atomic.h>\n#include <asm/debug.h>\n#include <asm/zcrypt.h>\n#include \"ap_bus.h\"\n\n \n#define ZCRYPT_CEX2C\t\t5\n#define ZCRYPT_CEX2A\t\t6\n#define ZCRYPT_CEX3C\t\t7\n#define ZCRYPT_CEX3A\t\t8\n#define ZCRYPT_CEX4\t       10\n#define ZCRYPT_CEX5\t       11\n#define ZCRYPT_CEX6\t       12\n#define ZCRYPT_CEX7\t       13\n\n \n#define ZCRYPT_RNG_BUFFER_SIZE\t4096\n\n \nenum crypto_ops {\n\tMEX_1K,\n\tMEX_2K,\n\tMEX_4K,\n\tCRT_1K,\n\tCRT_2K,\n\tCRT_4K,\n\tHWRNG,\n\tSECKEY,\n\tNUM_OPS\n};\n\nstruct zcrypt_queue;\n\n \nstruct zcrypt_track {\n\tint again_counter;\t\t \n\tint last_qid;\t\t\t \n\tint last_rc;\t\t\t \n};\n\n \n#define TRACK_AGAIN_MAX 10\n#define TRACK_AGAIN_CARD_WEIGHT_PENALTY  1000\n#define TRACK_AGAIN_QUEUE_WEIGHT_PENALTY 10000\n\nstruct zcrypt_ops {\n\tlong (*rsa_modexpo)(struct zcrypt_queue *, struct ica_rsa_modexpo *,\n\t\t\t    struct ap_message *);\n\tlong (*rsa_modexpo_crt)(struct zcrypt_queue *,\n\t\t\t\tstruct ica_rsa_modexpo_crt *,\n\t\t\t\tstruct ap_message *);\n\tlong (*send_cprb)(bool userspace, struct zcrypt_queue *, struct ica_xcRB *,\n\t\t\t  struct ap_message *);\n\tlong (*send_ep11_cprb)(bool userspace, struct zcrypt_queue *, struct ep11_urb *,\n\t\t\t       struct ap_message *);\n\tlong (*rng)(struct zcrypt_queue *, char *, struct ap_message *);\n\tstruct list_head list;\t\t \n\tstruct module *owner;\n\tint variant;\n\tchar name[128];\n};\n\nstruct zcrypt_card {\n\tstruct list_head list;\t\t \n\tstruct list_head zqueues;\t \n\tstruct kref refcount;\t\t \n\tstruct ap_card *card;\t\t \n\tint online;\t\t\t \n\n\tint user_space_type;\t\t \n\tchar *type_string;\t\t \n\tint min_mod_size;\t\t \n\tint max_mod_size;\t\t \n\tint max_exp_bit_length;\n\tconst int *speed_rating;\t \n\tatomic_t load;\t\t\t \n\n\tint request_count;\t\t \n};\n\nstruct zcrypt_queue {\n\tstruct list_head list;\t\t \n\tstruct kref refcount;\t\t \n\tstruct zcrypt_card *zcard;\n\tstruct zcrypt_ops *ops;\t\t \n\tstruct ap_queue *queue;\t\t \n\tint online;\t\t\t \n\n\tatomic_t load;\t\t\t \n\n\tint request_count;\t\t \n\n\tstruct ap_message reply;\t \n};\n\n \nextern atomic_t zcrypt_rescan_req;\n\nextern spinlock_t zcrypt_list_lock;\nextern struct list_head zcrypt_card_list;\n\n#define for_each_zcrypt_card(_zc) \\\n\tlist_for_each_entry(_zc, &zcrypt_card_list, list)\n\n#define for_each_zcrypt_queue(_zq, _zc) \\\n\tlist_for_each_entry(_zq, &(_zc)->zqueues, list)\n\nstruct zcrypt_card *zcrypt_card_alloc(void);\nvoid zcrypt_card_free(struct zcrypt_card *);\nvoid zcrypt_card_get(struct zcrypt_card *);\nint zcrypt_card_put(struct zcrypt_card *);\nint zcrypt_card_register(struct zcrypt_card *);\nvoid zcrypt_card_unregister(struct zcrypt_card *);\n\nstruct zcrypt_queue *zcrypt_queue_alloc(size_t);\nvoid zcrypt_queue_free(struct zcrypt_queue *);\nvoid zcrypt_queue_get(struct zcrypt_queue *);\nint zcrypt_queue_put(struct zcrypt_queue *);\nint zcrypt_queue_register(struct zcrypt_queue *);\nvoid zcrypt_queue_unregister(struct zcrypt_queue *);\nbool zcrypt_queue_force_online(struct zcrypt_queue *zq, int online);\n\nint zcrypt_rng_device_add(void);\nvoid zcrypt_rng_device_remove(void);\n\nvoid zcrypt_msgtype_register(struct zcrypt_ops *);\nvoid zcrypt_msgtype_unregister(struct zcrypt_ops *);\nstruct zcrypt_ops *zcrypt_msgtype(unsigned char *, int);\nint zcrypt_api_init(void);\nvoid zcrypt_api_exit(void);\nlong zcrypt_send_cprb(struct ica_xcRB *xcRB);\nlong zcrypt_send_ep11_cprb(struct ep11_urb *urb);\nvoid zcrypt_device_status_mask_ext(struct zcrypt_device_status_ext *devstatus);\nint zcrypt_device_status_ext(int card, int queue,\n\t\t\t     struct zcrypt_device_status_ext *devstatus);\n\nint zcrypt_wait_api_operational(void);\n\nstatic inline unsigned long z_copy_from_user(bool userspace,\n\t\t\t\t\t     void *to,\n\t\t\t\t\t     const void __user *from,\n\t\t\t\t\t     unsigned long n)\n{\n\tif (likely(userspace))\n\t\treturn copy_from_user(to, from, n);\n\tmemcpy(to, (void __force *)from, n);\n\treturn 0;\n}\n\nstatic inline unsigned long z_copy_to_user(bool userspace,\n\t\t\t\t\t   void __user *to,\n\t\t\t\t\t   const void *from,\n\t\t\t\t\t   unsigned long n)\n{\n\tif (likely(userspace))\n\t\treturn copy_to_user(to, from, n);\n\tmemcpy((void __force *)to, from, n);\n\treturn 0;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}