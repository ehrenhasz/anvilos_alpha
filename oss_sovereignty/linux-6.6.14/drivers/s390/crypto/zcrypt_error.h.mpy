{
  "module_name": "zcrypt_error.h",
  "hash_id": "c85cf2ba898a304f0e10209b7a05423a8083980f322fa0ec31ed199f148dbfab",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/crypto/zcrypt_error.h",
  "human_readable_source": " \n \n\n#ifndef _ZCRYPT_ERROR_H_\n#define _ZCRYPT_ERROR_H_\n\n#include <linux/atomic.h>\n#include \"zcrypt_debug.h\"\n#include \"zcrypt_api.h\"\n#include \"zcrypt_msgtype6.h\"\n\n \nstruct error_hdr {\n\tunsigned char reserved1;\t \n\tunsigned char type;\t\t \n\tunsigned char reserved2[2];\t \n\tunsigned char reply_code;\t \n\tunsigned char reserved3[3];\t \n};\n\n#define TYPE82_RSP_CODE 0x82\n#define TYPE88_RSP_CODE 0x88\n\n#define REP82_ERROR_MACHINE_FAILURE\t    0x10\n#define REP82_ERROR_PREEMPT_FAILURE\t    0x12\n#define REP82_ERROR_CHECKPT_FAILURE\t    0x14\n#define REP82_ERROR_MESSAGE_TYPE\t    0x20\n#define REP82_ERROR_INVALID_COMM_CD\t    0x21  \n#define REP82_ERROR_INVALID_MSG_LEN\t    0x23\n#define REP82_ERROR_RESERVD_FIELD\t    0x24  \n#define REP82_ERROR_FORMAT_FIELD\t    0x29\n#define REP82_ERROR_INVALID_COMMAND\t    0x30\n#define REP82_ERROR_MALFORMED_MSG\t    0x40\n#define REP82_ERROR_INVALID_SPECIAL_CMD\t    0x41\n#define REP82_ERROR_RESERVED_FIELDO\t    0x50  \n#define REP82_ERROR_WORD_ALIGNMENT\t    0x60\n#define REP82_ERROR_MESSAGE_LENGTH\t    0x80\n#define REP82_ERROR_OPERAND_INVALID\t    0x82\n#define REP82_ERROR_OPERAND_SIZE\t    0x84\n#define REP82_ERROR_EVEN_MOD_IN_OPND\t    0x85\n#define REP82_ERROR_RESERVED_FIELD\t    0x88\n#define REP82_ERROR_INVALID_DOMAIN_PENDING  0x8A\n#define REP82_ERROR_FILTERED_BY_HYPERVISOR  0x8B\n#define REP82_ERROR_TRANSPORT_FAIL\t    0x90\n#define REP82_ERROR_PACKET_TRUNCATED\t    0xA0\n#define REP82_ERROR_ZERO_BUFFER_LEN\t    0xB0\n\n#define REP88_ERROR_MODULE_FAILURE\t    0x10\n#define REP88_ERROR_MESSAGE_TYPE\t    0x20\n#define REP88_ERROR_MESSAGE_MALFORMD\t    0x22\n#define REP88_ERROR_MESSAGE_LENGTH\t    0x23\n#define REP88_ERROR_RESERVED_FIELD\t    0x24\n#define REP88_ERROR_KEY_TYPE\t\t    0x34\n#define REP88_ERROR_INVALID_KEY\t    0x82  \n#define REP88_ERROR_OPERAND\t\t    0x84  \n#define REP88_ERROR_OPERAND_EVEN_MOD\t    0x85  \n\nstatic inline int convert_error(struct zcrypt_queue *zq,\n\t\t\t\tstruct ap_message *reply)\n{\n\tstruct error_hdr *ehdr = reply->msg;\n\tint card = AP_QID_CARD(zq->queue->qid);\n\tint queue = AP_QID_QUEUE(zq->queue->qid);\n\n\tswitch (ehdr->reply_code) {\n\tcase REP82_ERROR_INVALID_MSG_LEN:\t  \n\tcase REP82_ERROR_RESERVD_FIELD:\t\t  \n\tcase REP82_ERROR_FORMAT_FIELD:\t\t  \n\tcase REP82_ERROR_MALFORMED_MSG:\t\t  \n\tcase REP82_ERROR_INVALID_SPECIAL_CMD:\t  \n\tcase REP82_ERROR_MESSAGE_LENGTH:\t  \n\tcase REP82_ERROR_OPERAND_INVALID:\t  \n\tcase REP82_ERROR_OPERAND_SIZE:\t\t  \n\tcase REP82_ERROR_EVEN_MOD_IN_OPND:\t  \n\tcase REP82_ERROR_INVALID_DOMAIN_PENDING:  \n\tcase REP82_ERROR_FILTERED_BY_HYPERVISOR:  \n\tcase REP82_ERROR_PACKET_TRUNCATED:\t  \n\tcase REP88_ERROR_MESSAGE_MALFORMD:\t  \n\tcase REP88_ERROR_KEY_TYPE:\t\t  \n\t\t \n\t\tZCRYPT_DBF_WARN(\"%s dev=%02x.%04x RY=0x%02x => rc=EINVAL\\n\",\n\t\t\t\t__func__, card, queue, ehdr->reply_code);\n\t\treturn -EINVAL;\n\tcase REP82_ERROR_MACHINE_FAILURE:\t  \n\tcase REP82_ERROR_MESSAGE_TYPE:\t\t  \n\tcase REP82_ERROR_TRANSPORT_FAIL:\t  \n\t\t \n\t\tatomic_set(&zcrypt_rescan_req, 1);\n\t\t \n\t\tif (ehdr->reply_code == REP82_ERROR_TRANSPORT_FAIL &&\n\t\t    ehdr->type == TYPE86_RSP_CODE) {\n\t\t\tstruct {\n\t\t\t\tstruct type86_hdr hdr;\n\t\t\t\tstruct type86_fmt2_ext fmt2;\n\t\t\t} __packed * head = reply->msg;\n\t\t\tunsigned int apfs = *((u32 *)head->fmt2.apfs);\n\n\t\t\tZCRYPT_DBF_WARN(\n\t\t\t\t\"%s dev=%02x.%04x RY=0x%02x apfs=0x%x => bus rescan, rc=EAGAIN\\n\",\n\t\t\t\t__func__, card, queue, ehdr->reply_code, apfs);\n\t\t} else {\n\t\t\tZCRYPT_DBF_WARN(\"%s dev=%02x.%04x RY=0x%02x => bus rescan, rc=EAGAIN\\n\",\n\t\t\t\t\t__func__, card, queue,\n\t\t\t\t\tehdr->reply_code);\n\t\t}\n\t\treturn -EAGAIN;\n\tdefault:\n\t\t \n\t\tZCRYPT_DBF_WARN(\"%s dev=%02x.%04x RY=0x%02x => rc=EAGAIN\\n\",\n\t\t\t\t__func__, card, queue, ehdr->reply_code);\n\t\treturn -EAGAIN;\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}