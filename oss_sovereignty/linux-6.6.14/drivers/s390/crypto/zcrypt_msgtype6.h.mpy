{
  "module_name": "zcrypt_msgtype6.h",
  "hash_id": "cf91b1618898de64a76cd1f620b636528cb66f6f91255f01dbd13d060033b5c4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/crypto/zcrypt_msgtype6.h",
  "human_readable_source": " \n \n\n#ifndef _ZCRYPT_MSGTYPE6_H_\n#define _ZCRYPT_MSGTYPE6_H_\n\n#include <asm/zcrypt.h>\n\n#define MSGTYPE06_NAME\t\t\t\"zcrypt_msgtype6\"\n#define MSGTYPE06_VARIANT_DEFAULT\t0\n#define MSGTYPE06_VARIANT_NORNG\t\t1\n#define MSGTYPE06_VARIANT_EP11\t\t2\n\n \nstruct type6_hdr {\n\tunsigned char reserved1;\t \n\tunsigned char type;\t\t \n\tunsigned char reserved2[2];\t \n\tunsigned char right[4];\t\t \n\tunsigned char reserved3[2];\t \n\tunsigned char reserved4[2];\t \n\tunsigned char apfs[4];\t\t \n\tunsigned int  offset1;\t\t \n\tunsigned int  offset2;\t\t \n\tunsigned int  offset3;\t\t \n\tunsigned int  offset4;\t\t \n\tunsigned char agent_id[16];\t \n\t\t\t\t\t \n\tunsigned char rqid[2];\t\t \n\tunsigned char reserved5[2];\t \n\tunsigned char function_code[2];\t \n\tunsigned char reserved6[2];\t \n\tunsigned int  tocardlen1;\t \n\tunsigned int  tocardlen2;\t \n\tunsigned int  tocardlen3;\t \n\tunsigned int  tocardlen4;\t \n\tunsigned int  fromcardlen1;\t \n\tunsigned int  fromcardlen2;\t \n\tunsigned int  fromcardlen3;\t \n\tunsigned int  fromcardlen4;\t \n} __packed;\n\n \nstruct type86_hdr {\n\tunsigned char reserved1;\t \n\tunsigned char type;\t\t \n\tunsigned char format;\t\t \n\tunsigned char reserved2;\t \n\tunsigned char reply_code;\t \n\tunsigned char reserved3[3];\t \n} __packed;\n\n#define TYPE86_RSP_CODE 0x86\n#define TYPE87_RSP_CODE 0x87\n#define TYPE86_FMT2\t0x02\n\nstruct type86_fmt2_ext {\n\tunsigned char\t  reserved[4];\t \n\tunsigned char\t  apfs[4];\t \n\tunsigned int\t  count1;\t \n\tunsigned int\t  offset1;\t \n\tunsigned int\t  count2;\t \n\tunsigned int\t  offset2;\t \n\tunsigned int\t  count3;\t \n\tunsigned int\t  offset3;\t \n\tunsigned int\t  count4;\t \n\tunsigned int\t  offset4;\t \n} __packed;\n\nint prep_cca_ap_msg(bool userspace, struct ica_xcRB *xcrb,\n\t\t    struct ap_message *ap_msg,\n\t\t    unsigned int *fc, unsigned short **dom);\nint prep_ep11_ap_msg(bool userspace, struct ep11_urb *xcrb,\n\t\t     struct ap_message *ap_msg,\n\t\t     unsigned int *fc, unsigned int *dom);\nint prep_rng_ap_msg(struct ap_message *ap_msg,\n\t\t    int *fc, unsigned int *dom);\n\n#define LOW\t10\n#define MEDIUM\t100\n#define HIGH\t500\n\nint speed_idx_cca(int);\nint speed_idx_ep11(int);\n\n \nstatic inline void rng_type6cprb_msgx(struct ap_message *ap_msg,\n\t\t\t\t      unsigned int random_number_length,\n\t\t\t\t      unsigned int *domain)\n{\n\tstruct {\n\t\tstruct type6_hdr hdr;\n\t\tstruct CPRBX cprbx;\n\t\tchar function_code[2];\n\t\tshort int rule_length;\n\t\tchar rule[8];\n\t\tshort int verb_length;\n\t\tshort int key_length;\n\t} __packed * msg = ap_msg->msg;\n\tstatic struct type6_hdr static_type6_hdrX = {\n\t\t.type\t\t= 0x06,\n\t\t.offset1\t= 0x00000058,\n\t\t.agent_id\t= {'C', 'A'},\n\t\t.function_code\t= {'R', 'L'},\n\t\t.tocardlen1\t= sizeof(*msg) - sizeof(msg->hdr),\n\t\t.fromcardlen1\t= sizeof(*msg) - sizeof(msg->hdr),\n\t};\n\tstatic struct CPRBX local_cprbx = {\n\t\t.cprb_len\t= 0x00dc,\n\t\t.cprb_ver_id\t= 0x02,\n\t\t.func_id\t= {0x54, 0x32},\n\t\t.req_parml\t= sizeof(*msg) - sizeof(msg->hdr) -\n\t\t\t\t  sizeof(msg->cprbx),\n\t\t.rpl_msgbl\t= sizeof(*msg) - sizeof(msg->hdr),\n\t};\n\n\tmsg->hdr = static_type6_hdrX;\n\tmsg->hdr.fromcardlen2 = random_number_length;\n\tmsg->cprbx = local_cprbx;\n\tmsg->cprbx.rpl_datal = random_number_length;\n\tmemcpy(msg->function_code, msg->hdr.function_code, 0x02);\n\tmsg->rule_length = 0x0a;\n\tmemcpy(msg->rule, \"RANDOM  \", 8);\n\tmsg->verb_length = 0x02;\n\tmsg->key_length = 0x02;\n\tap_msg->len = sizeof(*msg);\n\t*domain = (unsigned short)msg->cprbx.domain;\n}\n\nvoid zcrypt_msgtype6_init(void);\nvoid zcrypt_msgtype6_exit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}