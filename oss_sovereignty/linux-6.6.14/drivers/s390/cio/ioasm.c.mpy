{
  "module_name": "ioasm.c",
  "hash_id": "fe368e685a4be26cf92349bd0661d9d5367afe15825c6f191827d3fe65e0a9e7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/cio/ioasm.c",
  "human_readable_source": "\n \n\n#include <linux/export.h>\n\n#include <asm/asm-extable.h>\n#include <asm/chpid.h>\n#include <asm/schid.h>\n#include <asm/crw.h>\n\n#include \"ioasm.h\"\n#include \"orb.h\"\n#include \"cio.h\"\n#include \"cio_inject.h\"\n\nstatic inline int __stsch(struct subchannel_id schid, struct schib *addr)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode = -EIO;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\tstsch\t%[addr]\\n\"\n\t\t\"0:\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t\"1:\\n\"\n\t\tEX_TABLE(0b, 1b)\n\t\t: [cc] \"+&d\" (ccode), [addr] \"=Q\" (*addr)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint stsch(struct subchannel_id schid, struct schib *addr)\n{\n\tint ccode;\n\n\tccode = __stsch(schid, addr);\n\ttrace_s390_cio_stsch(schid, addr, ccode);\n\n\treturn ccode;\n}\nEXPORT_SYMBOL(stsch);\n\nstatic inline int __msch(struct subchannel_id schid, struct schib *addr)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode = -EIO;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\tmsch\t%[addr]\\n\"\n\t\t\"0:\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t\"1:\\n\"\n\t\tEX_TABLE(0b, 1b)\n\t\t: [cc] \"+&d\" (ccode)\n\t\t: [r1] \"d\" (r1), [addr] \"Q\" (*addr)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint msch(struct subchannel_id schid, struct schib *addr)\n{\n\tint ccode;\n\n\tccode = __msch(schid, addr);\n\ttrace_s390_cio_msch(schid, addr, ccode);\n\n\treturn ccode;\n}\n\nstatic inline int __tsch(struct subchannel_id schid, struct irb *addr)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\ttsch\t%[addr]\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\"\n\t\t: [cc] \"=&d\" (ccode), [addr] \"=Q\" (*addr)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint tsch(struct subchannel_id schid, struct irb *addr)\n{\n\tint ccode;\n\n\tccode = __tsch(schid, addr);\n\ttrace_s390_cio_tsch(schid, addr, ccode);\n\n\treturn ccode;\n}\n\nstatic inline int __ssch(struct subchannel_id schid, union orb *addr)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode = -EIO;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\tssch\t%[addr]\\n\"\n\t\t\"0:\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t\"1:\\n\"\n\t\tEX_TABLE(0b, 1b)\n\t\t: [cc] \"+&d\" (ccode)\n\t\t: [r1] \"d\" (r1), [addr] \"Q\" (*addr)\n\t\t: \"cc\", \"memory\", \"1\");\n\treturn ccode;\n}\n\nint ssch(struct subchannel_id schid, union orb *addr)\n{\n\tint ccode;\n\n\tccode = __ssch(schid, addr);\n\ttrace_s390_cio_ssch(schid, addr, ccode);\n\n\treturn ccode;\n}\nEXPORT_SYMBOL(ssch);\n\nstatic inline int __csch(struct subchannel_id schid)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\tcsch\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t: [cc] \"=&d\" (ccode)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint csch(struct subchannel_id schid)\n{\n\tint ccode;\n\n\tccode = __csch(schid);\n\ttrace_s390_cio_csch(schid, ccode);\n\n\treturn ccode;\n}\nEXPORT_SYMBOL(csch);\n\nint tpi(struct tpi_info *addr)\n{\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\ttpi\t%[addr]\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\"\n\t\t: [cc] \"=&d\" (ccode), [addr] \"=Q\" (*addr)\n\t\t:\n\t\t: \"cc\");\n\ttrace_s390_cio_tpi(addr, ccode);\n\n\treturn ccode;\n}\n\nint chsc(void *chsc_area)\n{\n\ttypedef struct { char _[4096]; } addr_type;\n\tint cc = -EIO;\n\n\tasm volatile(\n\t\t\"\t.insn\trre,0xb25f0000,%[chsc_area],0\\n\"\n\t\t\"0:\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t\"1:\\n\"\n\t\tEX_TABLE(0b, 1b)\n\t\t: [cc] \"+&d\" (cc), \"+m\" (*(addr_type *)chsc_area)\n\t\t: [chsc_area] \"d\" (chsc_area)\n\t\t: \"cc\");\n\ttrace_s390_cio_chsc(chsc_area, cc);\n\n\treturn cc;\n}\nEXPORT_SYMBOL(chsc);\n\nstatic inline int __rsch(struct subchannel_id schid)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\trsch\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t: [cc] \"=&d\" (ccode)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"memory\", \"1\");\n\treturn ccode;\n}\n\nint rsch(struct subchannel_id schid)\n{\n\tint ccode;\n\n\tccode = __rsch(schid);\n\ttrace_s390_cio_rsch(schid, ccode);\n\n\treturn ccode;\n}\n\nstatic inline int __hsch(struct subchannel_id schid)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\thsch\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t: [cc] \"=&d\" (ccode)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint hsch(struct subchannel_id schid)\n{\n\tint ccode;\n\n\tccode = __hsch(schid);\n\ttrace_s390_cio_hsch(schid, ccode);\n\n\treturn ccode;\n}\nEXPORT_SYMBOL(hsch);\n\nstatic inline int __xsch(struct subchannel_id schid)\n{\n\tunsigned long r1 = *(unsigned int *)&schid;\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tlgr\t1,%[r1]\\n\"\n\t\t\"\txsch\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t: [cc] \"=&d\" (ccode)\n\t\t: [r1] \"d\" (r1)\n\t\t: \"cc\", \"1\");\n\treturn ccode;\n}\n\nint xsch(struct subchannel_id schid)\n{\n\tint ccode;\n\n\tccode = __xsch(schid);\n\ttrace_s390_cio_xsch(schid, ccode);\n\n\treturn ccode;\n}\n\nstatic inline int __stcrw(struct crw *crw)\n{\n\tint ccode;\n\n\tasm volatile(\n\t\t\"\tstcrw\t%[crw]\\n\"\n\t\t\"\tipm\t%[cc]\\n\"\n\t\t\"\tsrl\t%[cc],28\\n\"\n\t\t: [cc] \"=&d\" (ccode), [crw] \"=Q\" (*crw)\n\t\t:\n\t\t: \"cc\");\n\treturn ccode;\n}\n\nstatic inline int _stcrw(struct crw *crw)\n{\n#ifdef CONFIG_CIO_INJECT\n\tif (static_branch_unlikely(&cio_inject_enabled)) {\n\t\tif (stcrw_get_injected(crw) == 0)\n\t\t\treturn 0;\n\t}\n#endif\n\n\treturn __stcrw(crw);\n}\n\nint stcrw(struct crw *crw)\n{\n\tint ccode;\n\n\tccode = _stcrw(crw);\n\ttrace_s390_cio_stcrw(crw, ccode);\n\n\treturn ccode;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}