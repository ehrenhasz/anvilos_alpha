{
  "module_name": "ism.h",
  "hash_id": "2bf842420591d241f06642235d448133a3f628fae8ca4d587036ad99dee0e980",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/net/ism.h",
  "human_readable_source": " \n#ifndef S390_ISM_H\n#define S390_ISM_H\n\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/pci.h>\n#include <linux/ism.h>\n#include <net/smc.h>\n#include <asm/pci_insn.h>\n\n#define UTIL_STR_LEN\t16\n\n \n#define ISM_DMB_WORD_OFFSET\t1\n#define ISM_DMB_BIT_OFFSET\t(ISM_DMB_WORD_OFFSET * 32)\n#define ISM_IDENT_MASK\t\t0x00FFFF\n\n#define ISM_REG_SBA\t0x1\n#define ISM_REG_IEQ\t0x2\n#define ISM_READ_GID\t0x3\n#define ISM_ADD_VLAN_ID\t0x4\n#define ISM_DEL_VLAN_ID\t0x5\n#define ISM_SET_VLAN\t0x6\n#define ISM_RESET_VLAN\t0x7\n#define ISM_QUERY_INFO\t0x8\n#define ISM_QUERY_RGID\t0x9\n#define ISM_REG_DMB\t0xA\n#define ISM_UNREG_DMB\t0xB\n#define ISM_SIGNAL_IEQ\t0xE\n#define ISM_UNREG_SBA\t0x11\n#define ISM_UNREG_IEQ\t0x12\n\nstruct ism_req_hdr {\n\tu32 cmd;\n\tu16 : 16;\n\tu16 len;\n};\n\nstruct ism_resp_hdr {\n\tu32 cmd;\n\tu16 ret;\n\tu16 len;\n};\n\nunion ism_reg_sba {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 sba;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(16);\n\nunion ism_reg_ieq {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 ieq;\n\t\tu64 len;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(16);\n\nunion ism_read_gid {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t\tu64 gid;\n\t} response;\n} __aligned(16);\n\nunion ism_qi {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t\tu32 version;\n\t\tu32 max_len;\n\t\tu64 ism_state;\n\t\tu64 my_gid;\n\t\tu64 sba;\n\t\tu64 ieq;\n\t\tu32 ieq_len;\n\t\tu32 : 32;\n\t\tu32 dmbs_owned;\n\t\tu32 dmbs_used;\n\t\tu32 vlan_required;\n\t\tu32 vlan_nr_ids;\n\t\tu16 vlan_id[64];\n\t} response;\n} __aligned(64);\n\nunion ism_query_rgid {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 rgid;\n\t\tu32 vlan_valid;\n\t\tu32 vlan_id;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(16);\n\nunion ism_reg_dmb {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 dmb;\n\t\tu32 dmb_len;\n\t\tu32 sba_idx;\n\t\tu32 vlan_valid;\n\t\tu32 vlan_id;\n\t\tu64 rgid;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t\tu64 dmb_tok;\n\t} response;\n} __aligned(32);\n\nunion ism_sig_ieq {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 rgid;\n\t\tu32 trigger_irq;\n\t\tu32 event_code;\n\t\tu64 info;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(32);\n\nunion ism_unreg_dmb {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 dmb_tok;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(16);\n\nunion ism_cmd_simple {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(8);\n\nunion ism_set_vlan_id {\n\tstruct {\n\t\tstruct ism_req_hdr hdr;\n\t\tu64 vlan_id;\n\t} request;\n\tstruct {\n\t\tstruct ism_resp_hdr hdr;\n\t} response;\n} __aligned(16);\n\nstruct ism_eq_header {\n\tu64 idx;\n\tu64 ieq_len;\n\tu64 entry_len;\n\tu64 : 64;\n};\n\nstruct ism_eq {\n\tstruct ism_eq_header header;\n\tstruct ism_event entry[15];\n};\n\nstruct ism_sba {\n\tu32 s : 1;\t \n\tu32 e : 1;\t \n\tu32 : 30;\n\tu32 dmb_bits[ISM_NR_DMBS / 32];\n\tu32 reserved[3];\n\tu16 dmbe_mask[ISM_NR_DMBS];\n};\n\n#define ISM_CREATE_REQ(dmb, idx, sf, offset)\t\t\\\n\t((dmb) | (idx) << 24 | (sf) << 23 | (offset))\n\nstruct ism_systemeid {\n\tu8\tseid_string[24];\n\tu8\tserial_number[4];\n\tu8\ttype[4];\n};\n\nstatic inline void __ism_read_cmd(struct ism_dev *ism, void *data,\n\t\t\t\t  unsigned long offset, unsigned long len)\n{\n\tstruct zpci_dev *zdev = to_zpci(ism->pdev);\n\tu64 req = ZPCI_CREATE_REQ(zdev->fh, 2, 8);\n\n\twhile (len > 0) {\n\t\t__zpci_load(data, req, offset);\n\t\toffset += 8;\n\t\tdata += 8;\n\t\tlen -= 8;\n\t}\n}\n\nstatic inline void __ism_write_cmd(struct ism_dev *ism, void *data,\n\t\t\t\t   unsigned long offset, unsigned long len)\n{\n\tstruct zpci_dev *zdev = to_zpci(ism->pdev);\n\tu64 req = ZPCI_CREATE_REQ(zdev->fh, 2, len);\n\n\tif (len)\n\t\t__zpci_store_block(data, req, offset);\n}\n\nstatic inline int __ism_move(struct ism_dev *ism, u64 dmb_req, void *data,\n\t\t\t     unsigned int size)\n{\n\tstruct zpci_dev *zdev = to_zpci(ism->pdev);\n\tu64 req = ZPCI_CREATE_REQ(zdev->fh, 0, size);\n\n\treturn __zpci_store_block(data, req, dmb_req);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}