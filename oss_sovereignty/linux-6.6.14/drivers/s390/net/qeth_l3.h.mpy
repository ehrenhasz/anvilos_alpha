{
  "module_name": "qeth_l3.h",
  "hash_id": "05ae643d934b1e5dde3c968d31df163a211ac0ddce681cc93aa417412b508121",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/net/qeth_l3.h",
  "human_readable_source": " \n \n\n#ifndef __QETH_L3_H__\n#define __QETH_L3_H__\n\n#include \"qeth_core.h\"\n#include <linux/hashtable.h>\n\nenum qeth_ip_types {\n\tQETH_IP_TYPE_NORMAL,\n\tQETH_IP_TYPE_VIPA,\n\tQETH_IP_TYPE_RXIP,\n};\n\nstruct qeth_ipaddr {\n\tstruct hlist_node hnode;\n\tenum qeth_ip_types type;\n\tu8 is_multicast:1;\n\tu8 disp_flag:2;\n\tu8 ipato:1;\t\t\t \n\n\t \n\tint  ref_counter;\n\tenum qeth_prot_versions proto;\n\tunion {\n\t\tstruct {\n\t\t\t__be32 addr;\n\t\t\t__be32 mask;\n\t\t} a4;\n\t\tstruct {\n\t\t\tstruct in6_addr addr;\n\t\t\tunsigned int pfxlen;\n\t\t} a6;\n\t} u;\n};\n\nstatic inline void qeth_l3_init_ipaddr(struct qeth_ipaddr *addr,\n\t\t\t\t       enum qeth_ip_types type,\n\t\t\t\t       enum qeth_prot_versions proto)\n{\n\tmemset(addr, 0, sizeof(*addr));\n\taddr->type = type;\n\taddr->proto = proto;\n\taddr->disp_flag = QETH_DISP_ADDR_DO_NOTHING;\n\taddr->ref_counter = 1;\n}\n\nstatic inline bool qeth_l3_addr_match_ip(struct qeth_ipaddr *a1,\n\t\t\t\t\t struct qeth_ipaddr *a2)\n{\n\tif (a1->proto != a2->proto)\n\t\treturn false;\n\tif (a1->proto == QETH_PROT_IPV6)\n\t\treturn ipv6_addr_equal(&a1->u.a6.addr, &a2->u.a6.addr);\n\treturn a1->u.a4.addr == a2->u.a4.addr;\n}\n\nstatic inline bool qeth_l3_addr_match_all(struct qeth_ipaddr *a1,\n\t\t\t\t\t  struct qeth_ipaddr *a2)\n{\n\t \n\tif (a1->type != a2->type)\n\t\treturn false;\n\tif (a1->proto == QETH_PROT_IPV6)\n\t\treturn a1->u.a6.pfxlen == a2->u.a6.pfxlen;\n\treturn a1->u.a4.mask == a2->u.a4.mask;\n}\n\nstatic inline u32 qeth_l3_ipaddr_hash(struct qeth_ipaddr *addr)\n{\n\tif (addr->proto == QETH_PROT_IPV6)\n\t\treturn ipv6_addr_hash(&addr->u.a6.addr);\n\telse\n\t\treturn ipv4_addr_hash(addr->u.a4.addr);\n}\n\nstruct qeth_ipato_entry {\n\tstruct list_head entry;\n\tenum qeth_prot_versions proto;\n\tchar addr[16];\n\tunsigned int mask_bits;\n};\n\nextern const struct attribute_group *qeth_l3_attr_groups[];\n\nint qeth_l3_ipaddr_to_string(enum qeth_prot_versions proto, const u8 *addr,\n\t\t\t     char *buf);\nint qeth_l3_setrouting_v4(struct qeth_card *);\nint qeth_l3_setrouting_v6(struct qeth_card *);\nint qeth_l3_add_ipato_entry(struct qeth_card *, struct qeth_ipato_entry *);\nint qeth_l3_del_ipato_entry(struct qeth_card *card,\n\t\t\t    enum qeth_prot_versions proto, u8 *addr,\n\t\t\t    unsigned int mask_bits);\nvoid qeth_l3_update_ipato(struct qeth_card *card);\nint qeth_l3_modify_hsuid(struct qeth_card *card, bool add);\nint qeth_l3_modify_rxip_vipa(struct qeth_card *card, bool add, const u8 *ip,\n\t\t\t     enum qeth_ip_types type,\n\t\t\t     enum qeth_prot_versions proto);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}