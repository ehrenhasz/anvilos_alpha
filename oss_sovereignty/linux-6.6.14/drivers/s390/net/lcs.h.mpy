{
  "module_name": "lcs.h",
  "hash_id": "d46743f90e05b4cad5032489a0380e13eba9b417f7cc841d2f484d7e2fa57470",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/net/lcs.h",
  "human_readable_source": " \n \n\n#include <linux/interrupt.h>\n#include <linux/netdevice.h>\n#include <linux/skbuff.h>\n#include <linux/workqueue.h>\n#include <linux/refcount.h>\n#include <asm/ccwdev.h>\n\n#define LCS_DBF_TEXT(level, name, text) \\\n\tdo { \\\n\t\tdebug_text_event(lcs_dbf_##name, level, text); \\\n\t} while (0)\n\n#define LCS_DBF_HEX(level,name,addr,len) \\\ndo { \\\n\tdebug_event(lcs_dbf_##name,level,(void*)(addr),len); \\\n} while (0)\n\n#define LCS_DBF_TEXT_(level,name,text...) \\\n\tdo { \\\n\t\tif (debug_level_enabled(lcs_dbf_##name, level)) { \\\n\t\t\tscnprintf(debug_buffer, sizeof(debug_buffer), text); \\\n\t\t\tdebug_text_event(lcs_dbf_##name, level, debug_buffer); \\\n\t\t} \\\n\t} while (0)\n\n \n#define CARD_FROM_DEV(cdev) \\\n\t(struct lcs_card *) dev_get_drvdata( \\\n\t\t&((struct ccwgroup_device *)dev_get_drvdata(&cdev->dev))->dev);\n\n \nenum lcs_channel_types {\n\t \n\tlcs_channel_type_none,\n\n\t \n\tlcs_channel_type_parallel,\n\n\t \n\tlcs_channel_type_2216,\n\n\t \n\tlcs_channel_type_osa2\n};\n\n \n#define LCS_CCW_WRITE\t\t0x01\n#define LCS_CCW_READ\t\t0x02\n#define LCS_CCW_TRANSFER\t0x08\n\n \n#define LCS_CMD_STARTLAN\t0x01\n#define LCS_CMD_STOPLAN\t\t0x02\n#define LCS_CMD_LANSTAT\t\t0x04\n#define LCS_CMD_STARTUP\t\t0x07\n#define LCS_CMD_SHUTDOWN\t0x08\n#define LCS_CMD_QIPASSIST\t0xb2\n#define LCS_CMD_SETIPM\t\t0xb4\n#define LCS_CMD_DELIPM\t\t0xb5\n\n#define LCS_INITIATOR_TCPIP\t0x00\n#define LCS_INITIATOR_LGW\t0x01\n#define LCS_STD_CMD_SIZE\t16\n#define LCS_MULTICAST_CMD_SIZE\t404\n\n \n \n#define LCS_IPASS_ARP_PROCESSING\t0x0001\n#define LCS_IPASS_IN_CHECKSUM_SUPPORT\t0x0002\n#define LCS_IPASS_OUT_CHECKSUM_SUPPORT\t0x0004\n#define LCS_IPASS_IP_FRAG_REASSEMBLY\t0x0008\n#define LCS_IPASS_IP_FILTERING\t\t0x0010\n \n#define LCS_IPASS_IPV6_SUPPORT\t\t0x0020\n#define LCS_IPASS_MULTICAST_SUPPORT\t0x0040\n\n \n#define LCS_SENSE_BYTE_0 \t\t0\n#define LCS_SENSE_BYTE_1 \t\t1\n#define LCS_SENSE_BYTE_2 \t\t2\n#define LCS_SENSE_BYTE_3 \t\t3\n#define LCS_SENSE_INTERFACE_DISCONNECT\t0x01\n#define LCS_SENSE_EQUIPMENT_CHECK\t0x10\n#define LCS_SENSE_BUS_OUT_CHECK\t\t0x20\n#define LCS_SENSE_INTERVENTION_REQUIRED 0x40\n#define LCS_SENSE_CMD_REJECT\t\t0x80\n#define LCS_SENSE_RESETTING_EVENT\t0x80\n#define LCS_SENSE_DEVICE_ONLINE\t\t0x20\n\n \n#define LCS_FRAME_TYPE_CONTROL\t\t0\n#define LCS_FRAME_TYPE_ENET\t\t1\n#define LCS_FRAME_TYPE_TR\t\t2\n#define LCS_FRAME_TYPE_FDDI\t\t7\n#define LCS_FRAME_TYPE_AUTO\t\t-1\n\n \n#define LCS_ILLEGAL_OFFSET\t\t0xffff\n#define LCS_IOBUFFERSIZE\t\t0x5000\n#define LCS_NUM_BUFFS\t\t\t32\t \n#define LCS_MAC_LENGTH\t\t\t6\n#define LCS_INVALID_PORT_NO\t\t-1\n#define LCS_LANCMD_TIMEOUT_DEFAULT      5\n\n \n#define\t LCS_IPM_STATE_SET_REQUIRED\t0\n#define\t LCS_IPM_STATE_DEL_REQUIRED\t1\n#define\t LCS_IPM_STATE_ON_CARD\t\t2\n\n \n#define\t LCS_IPASS_ARP_PROCESSING\t0x0001\n#define\t LCS_IPASS_INBOUND_CSUM_SUPP\t0x0002\n#define\t LCS_IPASS_OUTBOUND_CSUM_SUPP\t0x0004\n#define\t LCS_IPASS_IP_FRAG_REASSEMBLY\t0x0008\n#define\t LCS_IPASS_IP_FILTERING\t\t0x0010\n#define\t LCS_IPASS_IPV6_SUPPORT\t\t0x0020\n#define\t LCS_IPASS_MULTICAST_SUPPORT\t0x0040\n\n \nenum lcs_buffer_states {\n\tLCS_BUF_STATE_EMPTY,\t \n\tLCS_BUF_STATE_LOCKED,\t \n\tLCS_BUF_STATE_READY,\t \n\tLCS_BUF_STATE_PROCESSED,\n};\n\n \nenum lcs_channel_states {\n\tLCS_CH_STATE_INIT,\n\tLCS_CH_STATE_HALTED,\n\tLCS_CH_STATE_STOPPED,\n\tLCS_CH_STATE_RUNNING,\n\tLCS_CH_STATE_SUSPENDED,\n\tLCS_CH_STATE_CLEARED,\n\tLCS_CH_STATE_ERROR,\n};\n\n \nenum lcs_dev_states {\n\tDEV_STATE_DOWN,\n\tDEV_STATE_UP,\n\tDEV_STATE_RECOVER,\n};\n\nenum lcs_threads {\n\tLCS_SET_MC_THREAD \t= 1,\n\tLCS_RECOVERY_THREAD \t= 2,\n};\n\n \nstruct lcs_header {\n\t__u16  offset;\n\t__u8   type;\n\t__u8   slot;\n}  __attribute__ ((packed));\n\nstruct lcs_ip_mac_pair {\n\t__be32  ip_addr;\n\t__u8   mac_addr[LCS_MAC_LENGTH];\n\t__u8   reserved[2];\n}  __attribute__ ((packed));\n\nstruct lcs_ipm_list {\n\tstruct list_head list;\n\tstruct lcs_ip_mac_pair ipm;\n\t__u8 ipm_state;\n};\n\nstruct lcs_cmd {\n\t__u16  offset;\n\t__u8   type;\n\t__u8   slot;\n\t__u8   cmd_code;\n\t__u8   initiator;\n\t__u16  sequence_no;\n\t__u16  return_code;\n\tunion {\n\t\tstruct {\n\t\t\t__u8   lan_type;\n\t\t\t__u8   portno;\n\t\t\t__u16  parameter_count;\n\t\t\t__u8   operator_flags[3];\n\t\t\t__u8   reserved[3];\n\t\t} lcs_std_cmd;\n\t\tstruct {\n\t\t\t__u16  unused1;\n\t\t\t__u16  buff_size;\n\t\t\t__u8   unused2[6];\n\t\t} lcs_startup;\n\t\tstruct {\n\t\t\t__u8   lan_type;\n\t\t\t__u8   portno;\n\t\t\t__u8   unused[10];\n\t\t\t__u8   mac_addr[LCS_MAC_LENGTH];\n\t\t\t__u32  num_packets_deblocked;\n\t\t\t__u32  num_packets_blocked;\n\t\t\t__u32  num_packets_tx_on_lan;\n\t\t\t__u32  num_tx_errors_detected;\n\t\t\t__u32  num_tx_packets_disgarded;\n\t\t\t__u32  num_packets_rx_from_lan;\n\t\t\t__u32  num_rx_errors_detected;\n\t\t\t__u32  num_rx_discarded_nobuffs_avail;\n\t\t\t__u32  num_rx_packets_too_large;\n\t\t} lcs_lanstat_cmd;\n#ifdef CONFIG_IP_MULTICAST\n\t\tstruct {\n\t\t\t__u8   lan_type;\n\t\t\t__u8   portno;\n\t\t\t__u16  num_ip_pairs;\n\t\t\t__u16  ip_assists_supported;\n\t\t\t__u16  ip_assists_enabled;\n\t\t\t__u16  version;\n\t\t\tstruct {\n\t\t\t\tstruct lcs_ip_mac_pair\n\t\t\t\tip_mac_pair[32];\n\t\t\t\t__u32\t  response_data;\n\t\t\t} lcs_ipass_ctlmsg __attribute ((packed));\n\t\t} lcs_qipassist __attribute__ ((packed));\n#endif  \n\t} cmd __attribute__ ((packed));\n}  __attribute__ ((packed));\n\n \nstruct lcs_card;\nstruct lcs_channel;\n\n \nstruct lcs_buffer {\n\tenum lcs_buffer_states state;\n\tvoid *data;\n\tint count;\n\t \n\tvoid (*callback)(struct lcs_channel *, struct lcs_buffer *);\n};\n\nstruct lcs_reply {\n\tstruct list_head list;\n\t__u16 sequence_no;\n\trefcount_t refcnt;\n\t \n\tvoid (*callback)(struct lcs_card *, struct lcs_cmd *);\n\twait_queue_head_t wait_q;\n\tstruct lcs_card *card;\n\tstruct timer_list timer;\n\tint received;\n\tint rc;\n};\n\n \nstruct lcs_channel {\n\tenum lcs_channel_states state;\n\tstruct ccw_device *ccwdev;\n\tstruct ccw1 ccws[LCS_NUM_BUFFS + 1];\n\twait_queue_head_t wait_q;\n\tstruct tasklet_struct irq_tasklet;\n\tstruct lcs_buffer iob[LCS_NUM_BUFFS];\n\tint io_idx;\n\tint buf_idx;\n};\n\n\n \nstruct lcs_card {\n\tspinlock_t lock;\n\tspinlock_t ipm_lock;\n\tenum lcs_dev_states state;\n\tstruct net_device *dev;\n\tstruct net_device_stats stats;\n\t__be16 (*lan_type_trans)(struct sk_buff *skb,\n\t\t\t\t\t struct net_device *dev);\n\tstruct ccwgroup_device *gdev;\n\tstruct lcs_channel read;\n\tstruct lcs_channel write;\n\tstruct lcs_buffer *tx_buffer;\n\tint tx_emitted;\n\tstruct list_head lancmd_waiters;\n\tint lancmd_timeout;\n\n\tstruct work_struct kernel_thread_starter;\n\tspinlock_t mask_lock;\n\tunsigned long thread_start_mask;\n\tunsigned long thread_running_mask;\n\tunsigned long thread_allowed_mask;\n\twait_queue_head_t wait_q;\n\n#ifdef CONFIG_IP_MULTICAST\n\tstruct list_head ipm_list;\n#endif\n\t__u8 mac[LCS_MAC_LENGTH];\n\t__u16 ip_assists_supported;\n\t__u16 ip_assists_enabled;\n\t__s8 lan_type;\n\t__u32 pkt_seq;\n\t__u16 sequence_no;\n\t__s16 portno;\n\t \n\tu8 device_forced;\n\tu8 max_port_no;\n\tu8 hint_port_no;\n\ts16 port_protocol_no;\n}  __attribute__ ((aligned(8)));\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}