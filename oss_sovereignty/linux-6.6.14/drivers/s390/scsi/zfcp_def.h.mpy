{
  "module_name": "zfcp_def.h",
  "hash_id": "65f177b035f593cf6d039cc4d298fb03c7253305dffee2f3cce69be76500d1bf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/s390/scsi/zfcp_def.h",
  "human_readable_source": " \n \n\n#ifndef ZFCP_DEF_H\n#define ZFCP_DEF_H\n\n \n\n#include <linux/init.h>\n#include <linux/moduleparam.h>\n#include <linux/major.h>\n#include <linux/blkdev.h>\n#include <linux/delay.h>\n#include <linux/timer.h>\n#include <linux/slab.h>\n#include <linux/mempool.h>\n#include <linux/syscalls.h>\n#include <linux/scatterlist.h>\n#include <linux/ioctl.h>\n#include <scsi/fc/fc_fs.h>\n#include <scsi/fc/fc_gs.h>\n#include <scsi/scsi.h>\n#include <scsi/scsi_tcq.h>\n#include <scsi/scsi_cmnd.h>\n#include <scsi/scsi_device.h>\n#include <scsi/scsi_host.h>\n#include <scsi/scsi_transport.h>\n#include <scsi/scsi_transport_fc.h>\n#include <scsi/scsi_bsg_fc.h>\n#include <asm/ccwdev.h>\n#include <asm/debug.h>\n#include <asm/ebcdic.h>\n#include <asm/sysinfo.h>\n#include \"zfcp_fsf.h\"\n#include \"zfcp_fc.h\"\n#include \"zfcp_qdio.h\"\n\n \n\n \n#define FSF_QTCB_UNSOLICITED_STATUS\t\t0x6305\n\n \n\n \n#define ZFCP_COMMON_FLAGS\t\t\t0xfff00000\n\n \n#define ZFCP_STATUS_COMMON_RUNNING\t\t0x40000000\n#define ZFCP_STATUS_COMMON_ERP_FAILED\t\t0x20000000\n#define ZFCP_STATUS_COMMON_UNBLOCKED\t\t0x10000000\n#define ZFCP_STATUS_COMMON_OPEN                 0x04000000\n#define ZFCP_STATUS_COMMON_ERP_INUSE\t\t0x01000000\n#define ZFCP_STATUS_COMMON_ACCESS_DENIED\t0x00800000\n#define ZFCP_STATUS_COMMON_ACCESS_BOXED\t\t0x00400000\n#define ZFCP_STATUS_COMMON_NOESC\t\t0x00200000\n\n \n#define ZFCP_STATUS_ADAPTER_MB_ACT\t\t0x00000001\n#define ZFCP_STATUS_ADAPTER_QDIOUP\t\t0x00000002\n#define ZFCP_STATUS_ADAPTER_SIOSL_ISSUED\t0x00000004\n#define ZFCP_STATUS_ADAPTER_XCONFIG_OK\t\t0x00000008\n#define ZFCP_STATUS_ADAPTER_HOST_CON_INIT\t0x00000010\n#define ZFCP_STATUS_ADAPTER_ERP_PENDING\t\t0x00000100\n#define ZFCP_STATUS_ADAPTER_LINK_UNPLUGGED\t0x00000200\n#define ZFCP_STATUS_ADAPTER_DATA_DIV_ENABLED\t0x00000400\n\n \n#define ZFCP_STATUS_PORT_PHYS_OPEN\t\t0x00000001\n#define ZFCP_STATUS_PORT_LINK_TEST\t\t0x00000002\n\n \n#define ZFCP_STATUS_FSFREQ_ERROR\t\t0x00000008\n#define ZFCP_STATUS_FSFREQ_CLEANUP\t\t0x00000010\n#define ZFCP_STATUS_FSFREQ_ABORTSUCCEEDED\t0x00000040\n#define ZFCP_STATUS_FSFREQ_ABORTNOTNEEDED       0x00000080\n#define ZFCP_STATUS_FSFREQ_TMFUNCFAILED         0x00000200\n#define ZFCP_STATUS_FSFREQ_DISMISSED            0x00001000\n#define ZFCP_STATUS_FSFREQ_XDATAINCOMPLETE\t0x00020000\n\n \n\n \nenum zfcp_erp_act_type {\n\tZFCP_ERP_ACTION_REOPEN_LUN\t   = 1,\n\tZFCP_ERP_ACTION_REOPEN_PORT\t   = 2,\n\tZFCP_ERP_ACTION_REOPEN_PORT_FORCED = 3,\n\tZFCP_ERP_ACTION_REOPEN_ADAPTER\t   = 4,\n};\n\n \nenum zfcp_erp_steps {\n\tZFCP_ERP_STEP_UNINITIALIZED\t= 0x0000,\n\tZFCP_ERP_STEP_PHYS_PORT_CLOSING\t= 0x0010,\n\tZFCP_ERP_STEP_PORT_CLOSING\t= 0x0100,\n\tZFCP_ERP_STEP_PORT_OPENING\t= 0x0800,\n\tZFCP_ERP_STEP_LUN_CLOSING\t= 0x1000,\n\tZFCP_ERP_STEP_LUN_OPENING\t= 0x2000,\n};\n\nstruct zfcp_erp_action {\n\tstruct list_head list;\n\tenum zfcp_erp_act_type type;   \n\tstruct zfcp_adapter *adapter;  \n\tstruct zfcp_port *port;\n\tstruct scsi_device *sdev;\n\tu32\t\tstatus;\t       \n\tenum zfcp_erp_steps\tstep;\t \n\tu64\t\t\tfsf_req_id;\n\tstruct timer_list timer;\n};\n\n \nstruct zfcp_adapter_mempool {\n\tmempool_t *erp_req;\n\tmempool_t *gid_pn_req;\n\tmempool_t *scsi_req;\n\tmempool_t *scsi_abort;\n\tmempool_t *status_read_req;\n\tmempool_t *sr_data;\n\tmempool_t *gid_pn;\n\tmempool_t *qtcb_pool;\n};\n\nstruct zfcp_adapter {\n\tstruct kref\t\tref;\n\tu64\t\t\tpeer_wwnn;\t    \n\tu64\t\t\tpeer_wwpn;\t    \n\tu32\t\t\tpeer_d_id;\t    \n\tstruct ccw_device       *ccw_device;\t    \n\tstruct zfcp_qdio\t*qdio;\n\tu32\t\t\thydra_version;\t    \n\tu32\t\t\tfsf_lic_version;\n\tu32\t\t\tadapter_features;   \n\tu32\t\t\tconnection_features;  \n\tu32\t\t\thardware_version;   \n\tu32\t\t\tfc_security_algorithms;  \n\tu32\t\t\tfc_security_algorithms_old;  \n\tu16\t\t\ttimer_ticks;        \n\tstruct Scsi_Host\t*scsi_host;\t    \n\tstruct list_head\tport_list;\t    \n\trwlock_t\t\tport_list_lock;     \n\tu64\t\t\treq_no;\t\t    \n\tstruct zfcp_reqlist\t*req_list;\n\tu32\t\t\tfsf_req_seq_no;\t    \n\trwlock_t\t\tabort_lock;         \n\tatomic_t\t\tstat_miss;\t    \n\tunsigned int\t\tstat_read_buf_num;\n\tstruct work_struct\tstat_work;\n\tatomic_t\t\tstatus;\t            \n\tstruct list_head\terp_ready_head;\t    \n\twait_queue_head_t\terp_ready_wq;\n\tstruct list_head\terp_running_head;\n\trwlock_t\t\terp_lock;\n\twait_queue_head_t\terp_done_wqh;\n\tstruct zfcp_erp_action\terp_action;\t    \n\tatomic_t\t\terp_counter;\n\tu32\t\t\terp_total_count;    \n\tu32\t\t\terp_low_mem_count;  \n\tstruct task_struct\t*erp_thread;\n\tstruct zfcp_fc_wka_ports *gs;\t\t    \n\tstruct zfcp_dbf\t\t*dbf;\t\t    \n\tstruct zfcp_adapter_mempool\tpool;       \n\tstruct fc_host_statistics *fc_stats;\n\tstruct fsf_qtcb_bottom_port *stats_reset_data;\n\tunsigned long\t\tstats_reset;\n\tstruct delayed_work\tscan_work;\n\tstruct work_struct\tns_up_work;\n\tstruct service_level\tservice_level;\n\tstruct workqueue_struct\t*work_queue;\n\tstruct device_dma_parameters dma_parms;\n\tstruct zfcp_fc_events events;\n\tunsigned long\t\tnext_port_scan;\n\tstruct zfcp_diag_adapter\t*diagnostics;\n\tstruct work_struct\tversion_change_lost_work;\n};\n\nstruct zfcp_port {\n\tstruct device          dev;\n\tstruct fc_rport        *rport;          \n\tstruct list_head       list;\t        \n\tstruct zfcp_adapter    *adapter;        \n\tstruct list_head\tunit_list;\t \n\trwlock_t\t\tunit_list_lock;  \n\tatomic_t\t\tunits;\t        \n\tatomic_t\t       status;\t        \n\tu64\t\t       wwnn;\t        \n\tu64\t\t       wwpn;\t        \n\tu32\t\t       d_id;\t        \n\tu32\t\t       handle;\t        \n\tstruct zfcp_erp_action erp_action;      \n\tatomic_t\t       erp_counter;\n\tu32                    maxframe_size;\n\tu32                    supported_classes;\n\tu32                    connection_info;\n\tu32                    connection_info_old;\n\tstruct work_struct     gid_pn_work;\n\tstruct work_struct     test_link_work;\n\tstruct work_struct     rport_work;\n\tenum { RPORT_NONE, RPORT_ADD, RPORT_DEL }  rport_task;\n\tunsigned int\t\tstarget_id;\n};\n\nstruct zfcp_latency_record {\n\tu32 min;\n\tu32 max;\n\tu64 sum;\n};\n\nstruct zfcp_latency_cont {\n\tstruct zfcp_latency_record channel;\n\tstruct zfcp_latency_record fabric;\n\tu64 counter;\n};\n\nstruct zfcp_latencies {\n\tstruct zfcp_latency_cont read;\n\tstruct zfcp_latency_cont write;\n\tstruct zfcp_latency_cont cmd;\n\tspinlock_t lock;\n};\n\n \nstruct zfcp_unit {\n\tstruct device\t\tdev;\n\tstruct list_head\tlist;\n\tstruct zfcp_port\t*port;\n\tu64\t\t\tfcp_lun;\n\tstruct work_struct\tscsi_work;\n};\n\n \nstruct zfcp_scsi_dev {\n\tatomic_t\t\tstatus;\n\tu32\t\t\tlun_handle;\n\tstruct zfcp_erp_action\terp_action;\n\tatomic_t\t\terp_counter;\n\tstruct zfcp_latencies\tlatencies;\n\tstruct zfcp_port\t*port;\n};\n\n \nstatic inline struct zfcp_scsi_dev *sdev_to_zfcp(struct scsi_device *sdev)\n{\n\treturn scsi_transport_device_data(sdev);\n}\n\n \nstatic inline u64 zfcp_scsi_dev_lun(struct scsi_device *sdev)\n{\n\tu64 fcp_lun;\n\n\tint_to_scsilun(sdev->lun, (struct scsi_lun *)&fcp_lun);\n\treturn fcp_lun;\n}\n\n \nstruct zfcp_fsf_req {\n\tstruct list_head\tlist;\n\tu64\t\t\treq_id;\n\tstruct zfcp_adapter\t*adapter;\n\tstruct zfcp_qdio_req\tqdio_req;\n\tstruct completion\tcompletion;\n\tu32\t\t\tstatus;\n\tstruct fsf_qtcb\t\t*qtcb;\n\tvoid\t\t\t*data;\n\tstruct timer_list\ttimer;\n\tstruct zfcp_erp_action\t*erp_action;\n\tmempool_t\t\t*pool;\n\tunsigned long long\tissued;\n\tvoid\t\t\t(*handler)(struct zfcp_fsf_req *);\n};\n\nstatic inline\nint zfcp_adapter_multi_buffer_active(struct zfcp_adapter *adapter)\n{\n\treturn atomic_read(&adapter->status) & ZFCP_STATUS_ADAPTER_MB_ACT;\n}\n\nstatic inline bool zfcp_fsf_req_is_status_read_buffer(struct zfcp_fsf_req *req)\n{\n\treturn req->qtcb == NULL;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}