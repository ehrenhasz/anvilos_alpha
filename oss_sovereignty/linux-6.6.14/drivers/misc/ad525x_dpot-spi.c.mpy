{
  "module_name": "ad525x_dpot-spi.c",
  "hash_id": "ac26fc4168d196549a9aa39773d11c73c8fcd9af94c1b139a3456457f7a82d4b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/misc/ad525x_dpot-spi.c",
  "human_readable_source": "\n \n\n#include <linux/spi/spi.h>\n#include <linux/module.h>\n\n#include \"ad525x_dpot.h\"\n\n \nstatic int write8(void *client, u8 val)\n{\n\tu8 data = val;\n\n\treturn spi_write(client, &data, 1);\n}\n\nstatic int write16(void *client, u8 reg, u8 val)\n{\n\tu8 data[2] = {reg, val};\n\n\treturn spi_write(client, data, 2);\n}\n\nstatic int write24(void *client, u8 reg, u16 val)\n{\n\tu8 data[3] = {reg, val >> 8, val};\n\n\treturn spi_write(client, data, 3);\n}\n\nstatic int read8(void *client)\n{\n\tint ret;\n\tu8 data;\n\n\tret = spi_read(client, &data, 1);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn data;\n}\n\nstatic int read16(void *client, u8 reg)\n{\n\tint ret;\n\tu8 buf_rx[2];\n\n\twrite16(client, reg, 0);\n\tret = spi_read(client, buf_rx, 2);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn (buf_rx[0] << 8) |  buf_rx[1];\n}\n\nstatic int read24(void *client, u8 reg)\n{\n\tint ret;\n\tu8 buf_rx[3];\n\n\twrite24(client, reg, 0);\n\tret = spi_read(client, buf_rx, 3);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn (buf_rx[1] << 8) |  buf_rx[2];\n}\n\nstatic const struct ad_dpot_bus_ops bops = {\n\t.read_d8\t= read8,\n\t.read_r8d8\t= read16,\n\t.read_r8d16\t= read24,\n\t.write_d8\t= write8,\n\t.write_r8d8\t= write16,\n\t.write_r8d16\t= write24,\n};\nstatic int ad_dpot_spi_probe(struct spi_device *spi)\n{\n\tstruct ad_dpot_bus_data bdata = {\n\t\t.client = spi,\n\t\t.bops = &bops,\n\t};\n\n\treturn ad_dpot_probe(&spi->dev, &bdata,\n\t\t\t     spi_get_device_id(spi)->driver_data,\n\t\t\t     spi_get_device_id(spi)->name);\n}\n\nstatic void ad_dpot_spi_remove(struct spi_device *spi)\n{\n\tad_dpot_remove(&spi->dev);\n}\n\nstatic const struct spi_device_id ad_dpot_spi_id[] = {\n\t{\"ad5160\", AD5160_ID},\n\t{\"ad5161\", AD5161_ID},\n\t{\"ad5162\", AD5162_ID},\n\t{\"ad5165\", AD5165_ID},\n\t{\"ad5200\", AD5200_ID},\n\t{\"ad5201\", AD5201_ID},\n\t{\"ad5203\", AD5203_ID},\n\t{\"ad5204\", AD5204_ID},\n\t{\"ad5206\", AD5206_ID},\n\t{\"ad5207\", AD5207_ID},\n\t{\"ad5231\", AD5231_ID},\n\t{\"ad5232\", AD5232_ID},\n\t{\"ad5233\", AD5233_ID},\n\t{\"ad5235\", AD5235_ID},\n\t{\"ad5260\", AD5260_ID},\n\t{\"ad5262\", AD5262_ID},\n\t{\"ad5263\", AD5263_ID},\n\t{\"ad5290\", AD5290_ID},\n\t{\"ad5291\", AD5291_ID},\n\t{\"ad5292\", AD5292_ID},\n\t{\"ad5293\", AD5293_ID},\n\t{\"ad7376\", AD7376_ID},\n\t{\"ad8400\", AD8400_ID},\n\t{\"ad8402\", AD8402_ID},\n\t{\"ad8403\", AD8403_ID},\n\t{\"adn2850\", ADN2850_ID},\n\t{\"ad5270\", AD5270_ID},\n\t{\"ad5271\", AD5271_ID},\n\t{}\n};\nMODULE_DEVICE_TABLE(spi, ad_dpot_spi_id);\n\nstatic struct spi_driver ad_dpot_spi_driver = {\n\t.driver = {\n\t\t.name\t= \"ad_dpot\",\n\t},\n\t.probe\t\t= ad_dpot_spi_probe,\n\t.remove\t\t= ad_dpot_spi_remove,\n\t.id_table\t= ad_dpot_spi_id,\n};\n\nmodule_spi_driver(ad_dpot_spi_driver);\n\nMODULE_AUTHOR(\"Michael Hennerich <michael.hennerich@analog.com>\");\nMODULE_DESCRIPTION(\"digital potentiometer SPI bus driver\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"spi:ad_dpot\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}