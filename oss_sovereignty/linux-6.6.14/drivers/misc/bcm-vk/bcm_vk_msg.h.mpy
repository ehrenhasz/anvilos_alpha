{
  "module_name": "bcm_vk_msg.h",
  "hash_id": "c777c36e3277daee9c9a1a730bdb9b0a14d6275645c865e3da7cf3fd58aa11e4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/misc/bcm-vk/bcm_vk_msg.h",
  "human_readable_source": " \n \n\n#ifndef BCM_VK_MSG_H\n#define BCM_VK_MSG_H\n\n#include <uapi/linux/misc/bcm_vk.h>\n#include \"bcm_vk_sg.h\"\n\n \nstruct bcm_vk_msgq {\n\tu16 type;\t \n\tu16 num;\t \n\tu32 start;\t \n\n\tu32 rd_idx;  \n\tu32 wr_idx;  \n\n\tu32 size;\t \n\tu32 nxt;\t \n\n \n#define DB_SHIFT 16\n\n\tu32 db_offset;  \n\n\tu32 rsvd;\n};\n\n \nstruct bcm_vk_sync_qinfo {\n\tvoid __iomem *q_start;\n\tu32 q_size;\n\tu32 q_mask;\n\tu32 q_low;\n\tu32 q_db_offset;\n};\n\n#define VK_MSGQ_MAX_NR 4  \n\n \nstruct vk_msg_blk {\n\tu8 function_id;\n#define VK_FID_TRANS_BUF\t5\n#define VK_FID_SHUTDOWN\t\t8\n#define VK_FID_INIT\t\t9\n\tu8 size;  \n\tu16 trans_id;  \n\tu32 context_id;\n#define VK_NEW_CTX\t\t0\n\tu32 cmd;\n#define VK_CMD_PLANES_MASK\t0x000f  \n#define VK_CMD_UPLOAD\t\t0x0400  \n#define VK_CMD_DOWNLOAD\t\t0x0500  \n#define VK_CMD_MASK\t\t0x0f00  \n\tu32 arg;\n};\n\n \n#define VK_MSGQ_BLK_SIZE   (sizeof(struct vk_msg_blk))\n \n#define VK_MSGQ_BLK_SZ_SHIFT 4\n\n \n#define VK_SIMPLEX_MSG_ID 0\n\n \nstruct bcm_vk_ctx {\n\tstruct list_head node;  \n\tunsigned int idx;\n\tbool in_use;\n\tpid_t pid;\n\tu32 hash_idx;\n\tu32 q_num;  \n\tstruct miscdevice *miscdev;\n\tatomic_t pend_cnt;  \n\tatomic_t dma_cnt;  \n\twait_queue_head_t rd_wq;\n};\n\n \nstruct bcm_vk_ht_entry {\n\tstruct list_head head;\n};\n\n#define VK_DMA_MAX_ADDRS 4  \n \nstruct bcm_vk_wkent {\n\tstruct list_head node;  \n\tstruct bcm_vk_ctx *ctx;\n\n\t \n\tstruct bcm_vk_dma dma[VK_DMA_MAX_ADDRS];\n\n\tu32 to_h_blks;  \n\tstruct vk_msg_blk *to_h_msg;\n\n\t \n\tu32 usr_msg_id;\n\tu32 to_v_blks;\n\tu32 seq_num;\n\tstruct vk_msg_blk to_v_msg[];\n};\n\n \nstruct bcm_vk_qs_cnts {\n\tu32 cnt;  \n\tu32 acc_sum;\n\tu32 max_occ;  \n\tu32 max_abs;  \n};\n\n \nstruct bcm_vk_msg_chan {\n\tu32 q_nr;\n\t \n\tstruct mutex msgq_mutex;\n\t \n\tstruct bcm_vk_msgq __iomem *msgq[VK_MSGQ_MAX_NR];\n\t \n\tspinlock_t pendq_lock;\n\t \n\tstruct list_head pendq[VK_MSGQ_MAX_NR];\n\t \n\tstruct bcm_vk_sync_qinfo sync_qinfo[VK_MSGQ_MAX_NR];\n};\n\n \n#define VK_MSGQ_PER_CHAN_MAX\t3\n#define VK_MSGQ_NUM_DEFAULT\t(VK_MSGQ_PER_CHAN_MAX - 1)\n\n \n#define VK_CMPT_CTX_MAX\t\t(32 * 5)\n\n \n#define VK_PID_HT_SHIFT_BIT\t7  \n#define VK_PID_HT_SZ\t\tBIT(VK_PID_HT_SHIFT_BIT)\n\n \n#define VK_BAR0_SEG_SIZE\t(4 * SZ_1K)  \n\n \n#define VK_SHUTDOWN_PID\t\t1\n#define VK_SHUTDOWN_GRACEFUL\t2\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}