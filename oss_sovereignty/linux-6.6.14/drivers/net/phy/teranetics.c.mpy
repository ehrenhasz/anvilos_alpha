{
  "module_name": "teranetics.c",
  "hash_id": "01b33383d98016ed66b7b0ac1b9d63079777365d472d2786137866584b7fcdd4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/teranetics.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <linux/mdio.h>\n#include <linux/phy.h>\n\nMODULE_DESCRIPTION(\"Teranetics PHY driver\");\nMODULE_AUTHOR(\"Shaohui Xie <Shaohui.Xie@freescale.com>\");\nMODULE_LICENSE(\"GPL v2\");\n\n#define PHY_ID_TN2020\t0x00a19410\n#define MDIO_PHYXS_LNSTAT_SYNC0\t0x0001\n#define MDIO_PHYXS_LNSTAT_SYNC1\t0x0002\n#define MDIO_PHYXS_LNSTAT_SYNC2\t0x0004\n#define MDIO_PHYXS_LNSTAT_SYNC3\t0x0008\n#define MDIO_PHYXS_LNSTAT_ALIGN 0x1000\n\n#define MDIO_PHYXS_LANE_READY\t(MDIO_PHYXS_LNSTAT_SYNC0 | \\\n\t\t\t\tMDIO_PHYXS_LNSTAT_SYNC1 | \\\n\t\t\t\tMDIO_PHYXS_LNSTAT_SYNC2 | \\\n\t\t\t\tMDIO_PHYXS_LNSTAT_SYNC3 | \\\n\t\t\t\tMDIO_PHYXS_LNSTAT_ALIGN)\n\nstatic int teranetics_aneg_done(struct phy_device *phydev)\n{\n\t \n\tif (!phy_read_mmd(phydev, MDIO_MMD_VEND1, 93))\n\t\treturn genphy_c45_aneg_done(phydev);\n\n\treturn 1;\n}\n\nstatic int teranetics_read_status(struct phy_device *phydev)\n{\n\tint reg;\n\n\tphydev->link = 1;\n\n\tphydev->speed = SPEED_10000;\n\tphydev->duplex = DUPLEX_FULL;\n\n\tif (!phy_read_mmd(phydev, MDIO_MMD_VEND1, 93)) {\n\t\treg = phy_read_mmd(phydev, MDIO_MMD_PHYXS, MDIO_PHYXS_LNSTAT);\n\t\tif (reg < 0 ||\n\t\t    !((reg & MDIO_PHYXS_LANE_READY) == MDIO_PHYXS_LANE_READY)) {\n\t\t\tphydev->link = 0;\n\t\t\treturn 0;\n\t\t}\n\n\t\treg = phy_read_mmd(phydev, MDIO_MMD_AN, MDIO_STAT1);\n\t\tif (reg < 0 || !(reg & MDIO_STAT1_LSTATUS))\n\t\t\tphydev->link = 0;\n\t}\n\n\treturn 0;\n}\n\nstatic int teranetics_match_phy_device(struct phy_device *phydev)\n{\n\treturn phydev->c45_ids.device_ids[3] == PHY_ID_TN2020;\n}\n\nstatic struct phy_driver teranetics_driver[] = {\n{\n\t.phy_id\t\t= PHY_ID_TN2020,\n\t.phy_id_mask\t= 0xffffffff,\n\t.name\t\t= \"Teranetics TN2020\",\n\t.features       = PHY_10GBIT_FEATURES,\n\t.aneg_done\t= teranetics_aneg_done,\n\t.config_aneg    = gen10g_config_aneg,\n\t.read_status\t= teranetics_read_status,\n\t.match_phy_device = teranetics_match_phy_device,\n},\n};\n\nmodule_phy_driver(teranetics_driver);\n\nstatic struct mdio_device_id __maybe_unused teranetics_tbl[] = {\n\t{ PHY_ID_TN2020, 0xffffffff },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, teranetics_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}