{
  "module_name": "uPD60620.c",
  "hash_id": "6c74fae2524a8fec826c3c0fdda14427c8f9e161f60ed1615292234d6ce8a87a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/uPD60620.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/phy.h>\n\n#define UPD60620_PHY_ID    0xb8242824\n\n \n \n#define PHY_PHYSCR         0x1F       \n#define PHY_PHYSCR_10MB    0x0004     \n#define PHY_PHYSCR_100MB   0x0008     \n#define PHY_PHYSCR_DUPLEX  0x0010     \n\n \n#define PHY_SPM            0x12       \n\n \n\nstatic int upd60620_config_init(struct phy_device *phydev)\n{\n\t \n\t \n\treturn phy_write(phydev, PHY_SPM, 0x0180 | phydev->mdio.addr);\n}\n\n \n\nstatic int upd60620_read_status(struct phy_device *phydev)\n{\n\tint phy_state;\n\n\t \n\tphy_state = phy_read(phydev, MII_BMSR);\n\tif (phy_state < 0)\n\t\treturn phy_state;\n\n\tphydev->link = 0;\n\tlinkmode_zero(phydev->lp_advertising);\n\tphydev->pause = 0;\n\tphydev->asym_pause = 0;\n\n\tif (phy_state & (BMSR_ANEGCOMPLETE | BMSR_LSTATUS)) {\n\t\tphy_state = phy_read(phydev, PHY_PHYSCR);\n\t\tif (phy_state < 0)\n\t\t\treturn phy_state;\n\n\t\tif (phy_state & (PHY_PHYSCR_10MB | PHY_PHYSCR_100MB)) {\n\t\t\tphydev->link = 1;\n\t\t\tphydev->speed = SPEED_10;\n\t\t\tphydev->duplex = DUPLEX_HALF;\n\n\t\t\tif (phy_state & PHY_PHYSCR_100MB)\n\t\t\t\tphydev->speed = SPEED_100;\n\t\t\tif (phy_state & PHY_PHYSCR_DUPLEX)\n\t\t\t\tphydev->duplex = DUPLEX_FULL;\n\n\t\t\tphy_state = phy_read(phydev, MII_LPA);\n\t\t\tif (phy_state < 0)\n\t\t\t\treturn phy_state;\n\n\t\t\tmii_lpa_to_linkmode_lpa_t(phydev->lp_advertising,\n\t\t\t\t\t\t  phy_state);\n\n\t\t\tphy_resolve_aneg_pause(phydev);\n\t\t}\n\t}\n\treturn 0;\n}\n\nMODULE_DESCRIPTION(\"Renesas uPD60620 PHY driver\");\nMODULE_AUTHOR(\"Bernd Edlinger <bernd.edlinger@hotmail.de>\");\nMODULE_LICENSE(\"GPL\");\n\nstatic struct phy_driver upd60620_driver[1] = { {\n\t.phy_id         = UPD60620_PHY_ID,\n\t.phy_id_mask    = 0xfffffffe,\n\t.name           = \"Renesas uPD60620\",\n\t \n\t.flags          = 0,\n\t.config_init    = upd60620_config_init,\n\t.read_status    = upd60620_read_status,\n} };\n\nmodule_phy_driver(upd60620_driver);\n\nstatic struct mdio_device_id __maybe_unused upd60620_tbl[] = {\n\t{ UPD60620_PHY_ID, 0xfffffffe },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, upd60620_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}