{
  "module_name": "et1011c.c",
  "hash_id": "f1499c6d2fcfe7ecfdcb80df04c96f9786ead07dc83cf61a16a6617683191071",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/et1011c.c",
  "human_readable_source": "\n \n#include <linux/kernel.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/unistd.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/netdevice.h>\n#include <linux/etherdevice.h>\n#include <linux/skbuff.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <linux/phy.h>\n#include <linux/io.h>\n#include <linux/uaccess.h>\n#include <asm/irq.h>\n\n#define ET1011C_STATUS_REG\t(0x1A)\n#define ET1011C_CONFIG_REG\t(0x16)\n#define ET1011C_SPEED_MASK\t\t(0x0300)\n#define ET1011C_GIGABIT_SPEED\t\t(0x0200)\n#define ET1011C_TX_FIFO_MASK\t\t(0x3000)\n#define ET1011C_TX_FIFO_DEPTH_8\t\t(0x0000)\n#define ET1011C_TX_FIFO_DEPTH_16\t(0x1000)\n#define ET1011C_INTERFACE_MASK\t\t(0x0007)\n#define ET1011C_GMII_INTERFACE\t\t(0x0002)\n#define ET1011C_SYS_CLK_EN\t\t(0x01 << 4)\n\n\nMODULE_DESCRIPTION(\"LSI ET1011C PHY driver\");\nMODULE_AUTHOR(\"Chaithrika U S\");\nMODULE_LICENSE(\"GPL\");\n\nstatic int et1011c_config_aneg(struct phy_device *phydev)\n{\n\tint ctl = phy_read(phydev, MII_BMCR);\n\n\tif (ctl < 0)\n\t\treturn ctl;\n\tctl &= ~(BMCR_FULLDPLX | BMCR_SPEED100 | BMCR_SPEED1000 |\n\t\t BMCR_ANENABLE);\n\t \n\tphy_write(phydev, MII_BMCR, ctl | BMCR_RESET);\n\n\treturn genphy_config_aneg(phydev);\n}\n\nstatic int et1011c_read_status(struct phy_device *phydev)\n{\n\tstatic int speed;\n\tint ret;\n\tu32 val;\n\n\tret = genphy_read_status(phydev);\n\n\tif (speed != phydev->speed) {\n\t\tspeed = phydev->speed;\n\t\tval = phy_read(phydev, ET1011C_STATUS_REG);\n\t\tif ((val & ET1011C_SPEED_MASK) ==\n\t\t\t\t\tET1011C_GIGABIT_SPEED) {\n\t\t\tval = phy_read(phydev, ET1011C_CONFIG_REG);\n\t\t\tval &= ~ET1011C_TX_FIFO_MASK;\n\t\t\tphy_write(phydev, ET1011C_CONFIG_REG, val |\n\t\t\t\t\t  ET1011C_GMII_INTERFACE |\n\t\t\t\t\t  ET1011C_SYS_CLK_EN |\n\t\t\t\t\t  ET1011C_TX_FIFO_DEPTH_16);\n\n\t\t}\n\t}\n\treturn ret;\n}\n\nstatic struct phy_driver et1011c_driver[] = { {\n\t.phy_id\t\t= 0x0282f014,\n\t.name\t\t= \"ET1011C\",\n\t.phy_id_mask\t= 0xfffffff0,\n\t \n\t.config_aneg\t= et1011c_config_aneg,\n\t.read_status\t= et1011c_read_status,\n} };\n\nmodule_phy_driver(et1011c_driver);\n\nstatic struct mdio_device_id __maybe_unused et1011c_tbl[] = {\n\t{ 0x0282f014, 0xfffffff0 },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, et1011c_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}