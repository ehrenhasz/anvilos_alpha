{
  "module_name": "mediatek-ge.c",
  "hash_id": "2f24db1f6f469ff3192c8a9c2b78a367cd1681cdb508fb6e283cef1c2784406e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/mediatek-ge.c",
  "human_readable_source": "\n#include <linux/bitfield.h>\n#include <linux/module.h>\n#include <linux/phy.h>\n\n#define MTK_EXT_PAGE_ACCESS\t\t0x1f\n#define MTK_PHY_PAGE_STANDARD\t\t0x0000\n#define MTK_PHY_PAGE_EXTENDED\t\t0x0001\n#define MTK_PHY_PAGE_EXTENDED_2\t\t0x0002\n#define MTK_PHY_PAGE_EXTENDED_3\t\t0x0003\n#define MTK_PHY_PAGE_EXTENDED_2A30\t0x2a30\n#define MTK_PHY_PAGE_EXTENDED_52B5\t0x52b5\n\nstatic int mtk_gephy_read_page(struct phy_device *phydev)\n{\n\treturn __phy_read(phydev, MTK_EXT_PAGE_ACCESS);\n}\n\nstatic int mtk_gephy_write_page(struct phy_device *phydev, int page)\n{\n\treturn __phy_write(phydev, MTK_EXT_PAGE_ACCESS, page);\n}\n\nstatic void mtk_gephy_config_init(struct phy_device *phydev)\n{\n\t \n\tphy_write_mmd(phydev, MDIO_MMD_AN, MDIO_AN_EEE_ADV, 0);\n\n\t \n\tphy_modify_paged(phydev, MTK_PHY_PAGE_EXTENDED, 0x14, 0, BIT(4));\n\n\t \n\tphy_select_page(phydev, MTK_PHY_PAGE_EXTENDED_52B5);\n\t__phy_write(phydev, 0x10, 0xafae);\n\t__phy_write(phydev, 0x12, 0x2f);\n\t__phy_write(phydev, 0x10, 0x8fae);\n\tphy_restore_page(phydev, MTK_PHY_PAGE_STANDARD, 0);\n\n\t \n\tphy_write_mmd(phydev, MDIO_MMD_VEND1, 0x123, 0xffff);\n\n\t \n\tphy_write_mmd(phydev, MDIO_MMD_VEND1, 0xa6, 0x300);\n}\n\nstatic int mt7530_phy_config_init(struct phy_device *phydev)\n{\n\tmtk_gephy_config_init(phydev);\n\n\t \n\tphy_write_paged(phydev, MTK_PHY_PAGE_EXTENDED_3, 0x11, 0x4b);\n\n\treturn 0;\n}\n\nstatic int mt7531_phy_config_init(struct phy_device *phydev)\n{\n\tmtk_gephy_config_init(phydev);\n\n\t \n\tphy_set_bits(phydev, 0x17, BIT(4));\n\tphy_clear_bits_mmd(phydev, MDIO_MMD_VEND1, 0xc6, 0x300);\n\n\t \n\tphy_write_mmd(phydev, MDIO_MMD_VEND1, 0x13, 0x404);\n\tphy_write_mmd(phydev, MDIO_MMD_VEND1, 0x14, 0x404);\n\n\treturn 0;\n}\n\nstatic struct phy_driver mtk_gephy_driver[] = {\n\t{\n\t\tPHY_ID_MATCH_EXACT(0x03a29412),\n\t\t.name\t\t= \"MediaTek MT7530 PHY\",\n\t\t.config_init\t= mt7530_phy_config_init,\n\t\t \n\t\t.config_intr\t= genphy_no_config_intr,\n\t\t.handle_interrupt = genphy_handle_interrupt_no_ack,\n\t\t.suspend\t= genphy_suspend,\n\t\t.resume\t\t= genphy_resume,\n\t\t.read_page\t= mtk_gephy_read_page,\n\t\t.write_page\t= mtk_gephy_write_page,\n\t},\n\t{\n\t\tPHY_ID_MATCH_EXACT(0x03a29441),\n\t\t.name\t\t= \"MediaTek MT7531 PHY\",\n\t\t.config_init\t= mt7531_phy_config_init,\n\t\t \n\t\t.config_intr\t= genphy_no_config_intr,\n\t\t.handle_interrupt = genphy_handle_interrupt_no_ack,\n\t\t.suspend\t= genphy_suspend,\n\t\t.resume\t\t= genphy_resume,\n\t\t.read_page\t= mtk_gephy_read_page,\n\t\t.write_page\t= mtk_gephy_write_page,\n\t},\n};\n\nmodule_phy_driver(mtk_gephy_driver);\n\nstatic struct mdio_device_id __maybe_unused mtk_gephy_tbl[] = {\n\t{ PHY_ID_MATCH_EXACT(0x03a29441) },\n\t{ PHY_ID_MATCH_EXACT(0x03a29412) },\n\t{ }\n};\n\nMODULE_DESCRIPTION(\"MediaTek Gigabit Ethernet PHY driver\");\nMODULE_AUTHOR(\"DENG, Qingfang <dqfext@gmail.com>\");\nMODULE_LICENSE(\"GPL\");\n\nMODULE_DEVICE_TABLE(mdio, mtk_gephy_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}