{
  "module_name": "cortina.c",
  "hash_id": "70e607d51792475283e65baa103c4fc22be1beed1f9e66ed1aa89c0950c33cdf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/cortina.c",
  "human_readable_source": "\n \n#include <linux/module.h>\n#include <linux/phy.h>\n\n#define PHY_ID_CS4340\t0x13e51002\n\n#define VILLA_GLOBAL_CHIP_ID_LSB\t\t\t0x0\n#define VILLA_GLOBAL_CHIP_ID_MSB\t\t\t0x1\n\n#define VILLA_GLOBAL_GPIO_1_INTS\t\t\t0x017\n\nstatic int cortina_read_reg(struct phy_device *phydev, u16 regnum)\n{\n\treturn mdiobus_c45_read(phydev->mdio.bus, phydev->mdio.addr, 0, regnum);\n}\n\nstatic int cortina_read_status(struct phy_device *phydev)\n{\n\tint gpio_int_status, ret = 0;\n\n\tgpio_int_status = cortina_read_reg(phydev, VILLA_GLOBAL_GPIO_1_INTS);\n\tif (gpio_int_status < 0) {\n\t\tret = gpio_int_status;\n\t\tgoto err;\n\t}\n\n\tif (gpio_int_status & 0x8) {\n\t\t \n\t\tphydev->speed = SPEED_10000;\n\t\tphydev->duplex = DUPLEX_FULL;\n\t\tphydev->link = 1;\n\t} else {\n\t\tphydev->link = 0;\n\t}\n\nerr:\n\treturn ret;\n}\n\nstatic int cortina_probe(struct phy_device *phydev)\n{\n\tu32 phy_id = 0;\n\tint id_lsb = 0, id_msb = 0;\n\n\t \n\tid_lsb = cortina_read_reg(phydev, VILLA_GLOBAL_CHIP_ID_LSB);\n\tif (id_lsb < 0)\n\t\treturn -ENXIO;\n\n\tphy_id = id_lsb << 16;\n\n\tid_msb = cortina_read_reg(phydev, VILLA_GLOBAL_CHIP_ID_MSB);\n\tif (id_msb < 0)\n\t\treturn -ENXIO;\n\n\tphy_id |= id_msb;\n\n\t \n\tif (phy_id != phydev->drv->phy_id) {\n\t\tphydev_err(phydev, \"Error matching phy with %s driver\\n\",\n\t\t\t   phydev->drv->name);\n\t\treturn -ENODEV;\n\t}\n\n\treturn 0;\n}\n\nstatic struct phy_driver cortina_driver[] = {\n{\n\t.phy_id\t\t= PHY_ID_CS4340,\n\t.phy_id_mask\t= 0xffffffff,\n\t.name\t\t= \"Cortina CS4340\",\n\t.features       = PHY_10GBIT_FEATURES,\n\t.config_aneg\t= gen10g_config_aneg,\n\t.read_status\t= cortina_read_status,\n\t.probe\t\t= cortina_probe,\n},\n};\n\nmodule_phy_driver(cortina_driver);\n\nstatic struct mdio_device_id __maybe_unused cortina_tbl[] = {\n\t{ PHY_ID_CS4340, 0xffffffff},\n\t{},\n};\n\nMODULE_DEVICE_TABLE(mdio, cortina_tbl);\n\nMODULE_DESCRIPTION(\"Cortina EDC CDR 10G Ethernet PHY driver\");\nMODULE_AUTHOR(\"NXP\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}