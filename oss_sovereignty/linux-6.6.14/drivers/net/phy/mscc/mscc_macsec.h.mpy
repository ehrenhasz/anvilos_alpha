{
  "module_name": "mscc_macsec.h",
  "hash_id": "e3fad7ea323888b521157a4ec0683706e619078284d28c84979ecb7ed9770e0a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/mscc/mscc_macsec.h",
  "human_readable_source": " \n \n\n#ifndef _MSCC_PHY_MACSEC_H_\n#define _MSCC_PHY_MACSEC_H_\n\n#include <net/macsec.h>\n\n#define MSCC_MS_MAX_FLOWS\t\t16\n\n#define CONTROL_TYPE_EGRESS\t\t0x6\n#define CONTROL_TYPE_INGRESS\t\t0xf\n#define CONTROL_IV0\t\t\tBIT(5)\n#define CONTROL_IV1\t\t\tBIT(6)\n#define CONTROL_IV2\t\t\tBIT(7)\n#define CONTROL_UPDATE_SEQ\t\tBIT(13)\n#define CONTROL_IV_IN_SEQ\t\tBIT(14)\n#define CONTROL_ENCRYPT_AUTH\t\tBIT(15)\n#define CONTROL_KEY_IN_CTX\t\tBIT(16)\n#define CONTROL_CRYPTO_ALG(x)\t\t((x) << 17)\n#define     CTRYPTO_ALG_AES_CTR_128\t0x5\n#define     CTRYPTO_ALG_AES_CTR_192\t0x6\n#define     CTRYPTO_ALG_AES_CTR_256\t0x7\n#define CONTROL_DIGEST_TYPE(x)\t\t((x) << 21)\n#define CONTROL_AUTH_ALG(x)\t\t((x) << 23)\n#define     AUTH_ALG_AES_GHAS\t\t0x4\n#define CONTROL_AN(x)\t\t\t((x) << 26)\n#define CONTROL_SEQ_TYPE(x)\t\t((x) << 28)\n#define CONTROL_SEQ_MASK\t\tBIT(30)\n#define CONTROL_CONTEXT_ID\t\tBIT(31)\n\nenum mscc_macsec_destination_ports {\n\tMSCC_MS_PORT_COMMON\t\t= 0,\n\tMSCC_MS_PORT_RSVD\t\t= 1,\n\tMSCC_MS_PORT_CONTROLLED\t\t= 2,\n\tMSCC_MS_PORT_UNCONTROLLED\t= 3,\n};\n\nenum mscc_macsec_drop_actions {\n\tMSCC_MS_ACTION_BYPASS_CRC\t= 0,\n\tMSCC_MS_ACTION_BYPASS_BAD\t= 1,\n\tMSCC_MS_ACTION_DROP\t\t= 2,\n\tMSCC_MS_ACTION_BYPASS\t\t= 3,\n};\n\nenum mscc_macsec_flow_types {\n\tMSCC_MS_FLOW_BYPASS\t\t= 0,\n\tMSCC_MS_FLOW_DROP\t\t= 1,\n\tMSCC_MS_FLOW_INGRESS\t\t= 2,\n\tMSCC_MS_FLOW_EGRESS\t\t= 3,\n};\n\nenum mscc_macsec_validate_levels {\n\tMSCC_MS_VALIDATE_DISABLED\t= 0,\n\tMSCC_MS_VALIDATE_CHECK\t\t= 1,\n\tMSCC_MS_VALIDATE_STRICT\t\t= 2,\n};\n\nenum macsec_bank {\n\tFC_BUFFER   = 0x04,\n\tHOST_MAC    = 0x05,\n\tLINE_MAC    = 0x06,\n\tPROC_0      = 0x0e,\n\tPROC_2      = 0x0f,\n\tMACSEC_INGR = 0x38,\n\tMACSEC_EGR  = 0x3c,\n};\n\nstruct macsec_flow {\n\tstruct list_head list;\n\tenum mscc_macsec_destination_ports port;\n\tenum macsec_bank bank;\n\tu32 index;\n\tint assoc_num;\n\tbool has_transformation;\n\n\t \n\tu8 priority;\n\n\tunion {\n\t\tstruct macsec_rx_sa *rx_sa;\n\t\tstruct macsec_tx_sa *tx_sa;\n\t};\n\n\t \n\tstruct {\n\t\tu8 sci:1;\n\t\tu8 tagged:1;\n\t\tu8 untagged:1;\n\t\tu8 etype:1;\n\t} match;\n\n\tu16 etype;\n\n\t \n\tstruct {\n\t\tu8 bypass:1;\n\t\tu8 drop:1;\n\t} action;\n};\n\n#define MSCC_EXT_PAGE_MACSEC_17\t\t17\n#define MSCC_EXT_PAGE_MACSEC_18\t\t18\n\n#define MSCC_EXT_PAGE_MACSEC_19\t\t19\n#define MSCC_PHY_MACSEC_19_REG_ADDR(x)\t(x)\n#define MSCC_PHY_MACSEC_19_TARGET(x)\t((x) << 12)\n#define MSCC_PHY_MACSEC_19_READ\t\tBIT(14)\n#define MSCC_PHY_MACSEC_19_CMD\t\tBIT(15)\n\n#define MSCC_EXT_PAGE_MACSEC_20\t\t20\n#define MSCC_PHY_MACSEC_20_TARGET(x)\t(x)\n\n#define MSCC_MS_XFORM_REC(x, y)\t\t(((x) << 5) + (y))\n#define MSCC_MS_ENA_CFG\t\t\t0x800\n#define MSCC_MS_FC_CFG\t\t\t0x804\n#define MSCC_MS_SAM_MAC_SA_MATCH_LO(x)\t(0x1000 + ((x) << 4))\n#define MSCC_MS_SAM_MAC_SA_MATCH_HI(x)\t(0x1001 + ((x) << 4))\n#define MSCC_MS_SAM_MISC_MATCH(x)\t(0x1004 + ((x) << 4))\n#define MSCC_MS_SAM_MATCH_SCI_LO(x)\t(0x1005 + ((x) << 4))\n#define MSCC_MS_SAM_MATCH_SCI_HI(x)\t(0x1006 + ((x) << 4))\n#define MSCC_MS_SAM_MASK(x)\t\t(0x1007 + ((x) << 4))\n#define MSCC_MS_SAM_ENTRY_SET1\t\t0x1808\n#define MSCC_MS_SAM_ENTRY_CLEAR1\t0x180c\n#define MSCC_MS_SAM_FLOW_CTRL(x)\t(0x1c00 + (x))\n#define MSCC_MS_SAM_CP_TAG\t\t0x1e40\n#define MSCC_MS_SAM_NM_FLOW_NCP\t\t0x1e51\n#define MSCC_MS_SAM_NM_FLOW_CP\t\t0x1e52\n#define MSCC_MS_MISC_CONTROL\t\t0x1e5f\n#define MSCC_MS_COUNT_CONTROL\t\t0x3204\n#define MSCC_MS_PARAMS2_IG_CC_CONTROL\t0x3a10\n#define MSCC_MS_PARAMS2_IG_CP_TAG\t0x3a14\n#define MSCC_MS_VLAN_MTU_CHECK(x)\t(0x3c40 + (x))\n#define MSCC_MS_NON_VLAN_MTU_CHECK\t0x3c48\n#define MSCC_MS_PP_CTRL\t\t\t0x3c4b\n#define MSCC_MS_STATUS_CONTEXT_CTRL\t0x3d02\n#define MSCC_MS_INTR_CTRL_STATUS\t0x3d04\n#define MSCC_MS_BLOCK_CTX_UPDATE\t0x3d0c\n#define MSCC_MS_AIC_CTRL\t\t0x3e02\n\n \n#define MSCC_MS_ENA_CFG_CLK_ENA\t\t\t\tBIT(0)\n#define MSCC_MS_ENA_CFG_SW_RST\t\t\t\tBIT(1)\n#define MSCC_MS_ENA_CFG_MACSEC_BYPASS_ENA\t\tBIT(8)\n#define MSCC_MS_ENA_CFG_MACSEC_ENA\t\t\tBIT(9)\n#define MSCC_MS_ENA_CFG_MACSEC_SPEED_MODE(x)\t\t((x) << 10)\n#define MSCC_MS_ENA_CFG_MACSEC_SPEED_MODE_M\t\tGENMASK(12, 10)\n\n \n#define MSCC_MS_FC_CFG_FCBUF_ENA\t\t\tBIT(0)\n#define MSCC_MS_FC_CFG_USE_PKT_EXPANSION_INDICATION\tBIT(1)\n#define MSCC_MS_FC_CFG_LOW_THRESH(x)\t\t\t((x) << 4)\n#define MSCC_MS_FC_CFG_LOW_THRESH_M\t\t\tGENMASK(7, 4)\n#define MSCC_MS_FC_CFG_HIGH_THRESH(x)\t\t\t((x) << 8)\n#define MSCC_MS_FC_CFG_HIGH_THRESH_M\t\t\tGENMASK(11, 8)\n#define MSCC_MS_FC_CFG_LOW_BYTES_VAL(x)\t\t\t((x) << 12)\n#define MSCC_MS_FC_CFG_LOW_BYTES_VAL_M\t\t\tGENMASK(14, 12)\n#define MSCC_MS_FC_CFG_HIGH_BYTES_VAL(x)\t\t((x) << 16)\n#define MSCC_MS_FC_CFG_HIGH_BYTES_VAL_M\t\t\tGENMASK(18, 16)\n\n \n#define MSCC_MS_SAM_MAC_SA_MATCH_HI_ETYPE(x)\t\t((x) << 16)\n#define MSCC_MS_SAM_MAC_SA_MATCH_HI_ETYPE_M\t\tGENMASK(31, 16)\n\n \n#define MSCC_MS_SAM_MISC_MATCH_VLAN_VALID\t\tBIT(0)\n#define MSCC_MS_SAM_MISC_MATCH_QINQ_FOUND\t\tBIT(1)\n#define MSCC_MS_SAM_MISC_MATCH_STAG_VALID\t\tBIT(2)\n#define MSCC_MS_SAM_MISC_MATCH_QTAG_VALID\t\tBIT(3)\n#define MSCC_MS_SAM_MISC_MATCH_VLAN_UP(x)\t\t((x) << 4)\n#define MSCC_MS_SAM_MISC_MATCH_VLAN_UP_M\t\tGENMASK(6, 4)\n#define MSCC_MS_SAM_MISC_MATCH_CONTROL_PACKET\t\tBIT(7)\n#define MSCC_MS_SAM_MISC_MATCH_UNTAGGED\t\t\tBIT(8)\n#define MSCC_MS_SAM_MISC_MATCH_TAGGED\t\t\tBIT(9)\n#define MSCC_MS_SAM_MISC_MATCH_BAD_TAG\t\t\tBIT(10)\n#define MSCC_MS_SAM_MISC_MATCH_KAY_TAG\t\t\tBIT(11)\n#define MSCC_MS_SAM_MISC_MATCH_SOURCE_PORT(x)\t\t((x) << 12)\n#define MSCC_MS_SAM_MISC_MATCH_SOURCE_PORT_M\t\tGENMASK(13, 12)\n#define MSCC_MS_SAM_MISC_MATCH_PRIORITY(x)\t\t((x) << 16)\n#define MSCC_MS_SAM_MISC_MATCH_PRIORITY_M\t\tGENMASK(19, 16)\n#define MSCC_MS_SAM_MISC_MATCH_AN(x)\t\t\t((x) << 24)\n#define MSCC_MS_SAM_MISC_MATCH_TCI(x)\t\t\t((x) << 26)\n\n \n#define MSCC_MS_SAM_MASK_MAC_SA_MASK(x)\t\t\t(x)\n#define MSCC_MS_SAM_MASK_MAC_SA_MASK_M\t\t\tGENMASK(5, 0)\n#define MSCC_MS_SAM_MASK_MAC_DA_MASK(x)\t\t\t((x) << 6)\n#define MSCC_MS_SAM_MASK_MAC_DA_MASK_M\t\t\tGENMASK(11, 6)\n#define MSCC_MS_SAM_MASK_MAC_ETYPE_MASK\t\t\tBIT(12)\n#define MSCC_MS_SAM_MASK_VLAN_VLD_MASK\t\t\tBIT(13)\n#define MSCC_MS_SAM_MASK_QINQ_FOUND_MASK\t\tBIT(14)\n#define MSCC_MS_SAM_MASK_STAG_VLD_MASK\t\t\tBIT(15)\n#define MSCC_MS_SAM_MASK_QTAG_VLD_MASK\t\t\tBIT(16)\n#define MSCC_MS_SAM_MASK_VLAN_UP_MASK\t\t\tBIT(17)\n#define MSCC_MS_SAM_MASK_VLAN_ID_MASK\t\t\tBIT(18)\n#define MSCC_MS_SAM_MASK_SOURCE_PORT_MASK\t\tBIT(19)\n#define MSCC_MS_SAM_MASK_CTL_PACKET_MASK\t\tBIT(20)\n#define MSCC_MS_SAM_MASK_VLAN_UP_INNER_MASK\t\tBIT(21)\n#define MSCC_MS_SAM_MASK_VLAN_ID_INNER_MASK\t\tBIT(22)\n#define MSCC_MS_SAM_MASK_SCI_MASK\t\t\tBIT(23)\n#define MSCC_MS_SAM_MASK_AN_MASK(x)\t\t\t((x) << 24)\n#define MSCC_MS_SAM_MASK_TCI_MASK(x)\t\t\t((x) << 26)\n\n \n#define MSCC_MS_SAM_FLOW_CTRL_FLOW_TYPE(x)\t\t(x)\n#define MSCC_MS_SAM_FLOW_CTRL_FLOW_TYPE_M\t\tGENMASK(1, 0)\n#define MSCC_MS_SAM_FLOW_CTRL_DEST_PORT(x)\t\t((x) << 2)\n#define MSCC_MS_SAM_FLOW_CTRL_DEST_PORT_M\t\tGENMASK(3, 2)\n#define MSCC_MS_SAM_FLOW_CTRL_RESV_4\t\t\tBIT(4)\n#define MSCC_MS_SAM_FLOW_CTRL_FLOW_CRYPT_AUTH\t\tBIT(5)\n#define MSCC_MS_SAM_FLOW_CTRL_DROP_ACTION(x)\t\t((x) << 6)\n#define MSCC_MS_SAM_FLOW_CTRL_DROP_ACTION_M\t\tGENMASK(7, 6)\n#define MSCC_MS_SAM_FLOW_CTRL_RESV_15_TO_8(x)\t\t((x) << 8)\n#define MSCC_MS_SAM_FLOW_CTRL_RESV_15_TO_8_M\t\tGENMASK(15, 8)\n#define MSCC_MS_SAM_FLOW_CTRL_PROTECT_FRAME\t\tBIT(16)\n#define MSCC_MS_SAM_FLOW_CTRL_REPLAY_PROTECT\t\tBIT(16)\n#define MSCC_MS_SAM_FLOW_CTRL_SA_IN_USE\t\t\tBIT(17)\n#define MSCC_MS_SAM_FLOW_CTRL_INCLUDE_SCI\t\tBIT(18)\n#define MSCC_MS_SAM_FLOW_CTRL_USE_ES\t\t\tBIT(19)\n#define MSCC_MS_SAM_FLOW_CTRL_USE_SCB\t\t\tBIT(20)\n#define MSCC_MS_SAM_FLOW_CTRL_VALIDATE_FRAMES(x)\t((x) << 19)\n#define MSCC_MS_SAM_FLOW_CTRL_TAG_BYPASS_SIZE(x)\t((x) << 21)\n#define MSCC_MS_SAM_FLOW_CTRL_TAG_BYPASS_SIZE_M\t\tGENMASK(22, 21)\n#define MSCC_MS_SAM_FLOW_CTRL_RESV_23\t\t\tBIT(23)\n#define MSCC_MS_SAM_FLOW_CTRL_CONFIDENTIALITY_OFFSET(x)\t((x) << 24)\n#define MSCC_MS_SAM_FLOW_CTRL_CONFIDENTIALITY_OFFSET_M\tGENMASK(30, 24)\n#define MSCC_MS_SAM_FLOW_CTRL_CONF_PROTECT\t\tBIT(31)\n\n \n#define MSCC_MS_SAM_CP_TAG_MAP_TBL(x)\t\t\t(x)\n#define MSCC_MS_SAM_CP_TAG_MAP_TBL_M\t\t\tGENMASK(23, 0)\n#define MSCC_MS_SAM_CP_TAG_DEF_UP(x)\t\t\t((x) << 24)\n#define MSCC_MS_SAM_CP_TAG_DEF_UP_M\t\t\tGENMASK(26, 24)\n#define MSCC_MS_SAM_CP_TAG_STAG_UP_EN\t\t\tBIT(27)\n#define MSCC_MS_SAM_CP_TAG_QTAG_UP_EN\t\t\tBIT(28)\n#define MSCC_MS_SAM_CP_TAG_PARSE_QINQ\t\t\tBIT(29)\n#define MSCC_MS_SAM_CP_TAG_PARSE_STAG\t\t\tBIT(30)\n#define MSCC_MS_SAM_CP_TAG_PARSE_QTAG\t\t\tBIT(31)\n\n \n#define MSCC_MS_SAM_NM_FLOW_NCP_UNTAGGED_FLOW_TYPE(x)\t(x)\n#define MSCC_MS_SAM_NM_FLOW_NCP_UNTAGGED_DEST_PORT(x)\t((x) << 2)\n#define MSCC_MS_SAM_NM_FLOW_NCP_UNTAGGED_DROP_ACTION(x)\t((x) << 6)\n#define MSCC_MS_SAM_NM_FLOW_NCP_TAGGED_FLOW_TYPE(x)\t((x) << 8)\n#define MSCC_MS_SAM_NM_FLOW_NCP_TAGGED_DEST_PORT(x)\t((x) << 10)\n#define MSCC_MS_SAM_NM_FLOW_NCP_TAGGED_DROP_ACTION(x)\t((x) << 14)\n#define MSCC_MS_SAM_NM_FLOW_NCP_BADTAG_FLOW_TYPE(x)\t((x) << 16)\n#define MSCC_MS_SAM_NM_FLOW_NCP_BADTAG_DEST_PORT(x)\t((x) << 18)\n#define MSCC_MS_SAM_NM_FLOW_NCP_BADTAG_DROP_ACTION(x)\t((x) << 22)\n#define MSCC_MS_SAM_NM_FLOW_NCP_KAY_FLOW_TYPE(x)\t((x) << 24)\n#define MSCC_MS_SAM_NM_FLOW_NCP_KAY_DEST_PORT(x)\t((x) << 26)\n#define MSCC_MS_SAM_NM_FLOW_NCP_KAY_DROP_ACTION(x)\t((x) << 30)\n\n \n#define MSCC_MS_SAM_NM_FLOW_CP_UNTAGGED_FLOW_TYPE(x)\t(x)\n#define MSCC_MS_SAM_NM_FLOW_CP_UNTAGGED_DEST_PORT(x)\t((x) << 2)\n#define MSCC_MS_SAM_NM_FLOW_CP_UNTAGGED_DROP_ACTION(x)\t((x) << 6)\n#define MSCC_MS_SAM_NM_FLOW_CP_TAGGED_FLOW_TYPE(x)\t((x) << 8)\n#define MSCC_MS_SAM_NM_FLOW_CP_TAGGED_DEST_PORT(x)\t((x) << 10)\n#define MSCC_MS_SAM_NM_FLOW_CP_TAGGED_DROP_ACTION(x)\t((x) << 14)\n#define MSCC_MS_SAM_NM_FLOW_CP_BADTAG_FLOW_TYPE(x)\t((x) << 16)\n#define MSCC_MS_SAM_NM_FLOW_CP_BADTAG_DEST_PORT(x)\t((x) << 18)\n#define MSCC_MS_SAM_NM_FLOW_CP_BADTAG_DROP_ACTION(x)\t((x) << 22)\n#define MSCC_MS_SAM_NM_FLOW_CP_KAY_FLOW_TYPE(x)\t\t((x) << 24)\n#define MSCC_MS_SAM_NM_FLOW_CP_KAY_DEST_PORT(x)\t\t((x) << 26)\n#define MSCC_MS_SAM_NM_FLOW_CP_KAY_DROP_ACTION(x)\t((x) << 30)\n\n \n#define MSCC_MS_MISC_CONTROL_MC_LATENCY_FIX(x)\t\t(x)\n#define MSCC_MS_MISC_CONTROL_MC_LATENCY_FIX_M\t\tGENMASK(5, 0)\n#define MSCC_MS_MISC_CONTROL_STATIC_BYPASS\t\tBIT(8)\n#define MSCC_MS_MISC_CONTROL_NM_MACSEC_EN\t\tBIT(9)\n#define MSCC_MS_MISC_CONTROL_VALIDATE_FRAMES(x)\t\t((x) << 10)\n#define MSCC_MS_MISC_CONTROL_VALIDATE_FRAMES_M\t\tGENMASK(11, 10)\n#define MSCC_MS_MISC_CONTROL_XFORM_REC_SIZE(x)\t\t((x) << 24)\n#define MSCC_MS_MISC_CONTROL_XFORM_REC_SIZE_M\t\tGENMASK(25, 24)\n\n \n#define MSCC_MS_COUNT_CONTROL_RESET_ALL\t\t\tBIT(0)\n#define MSCC_MS_COUNT_CONTROL_DEBUG_ACCESS\t\tBIT(1)\n#define MSCC_MS_COUNT_CONTROL_SATURATE_CNTRS\t\tBIT(2)\n#define MSCC_MS_COUNT_CONTROL_AUTO_CNTR_RESET\t\tBIT(3)\n\n \n#define MSCC_MS_PARAMS2_IG_CC_CONTROL_NON_MATCH_CTRL_ACT\tBIT(14)\n#define MSCC_MS_PARAMS2_IG_CC_CONTROL_NON_MATCH_ACT\tBIT(15)\n\n \n#define MSCC_MS_PARAMS2_IG_CP_TAG_MAP_TBL(x)\t\t(x)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_MAP_TBL_M\t\tGENMASK(23, 0)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_DEF_UP(x)\t\t((x) << 24)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_DEF_UP_M\t\tGENMASK(26, 24)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_STAG_UP_EN\t\tBIT(27)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_QTAG_UP_EN\t\tBIT(28)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_PARSE_QINQ\t\tBIT(29)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_PARSE_STAG\t\tBIT(30)\n#define MSCC_MS_PARAMS2_IG_CP_TAG_PARSE_QTAG\t\tBIT(31)\n\n \n#define MSCC_MS_VLAN_MTU_CHECK_MTU_COMPARE(x)\t\t(x)\n#define MSCC_MS_VLAN_MTU_CHECK_MTU_COMPARE_M\t\tGENMASK(14, 0)\n#define MSCC_MS_VLAN_MTU_CHECK_MTU_COMP_DROP\t\tBIT(15)\n\n \n#define MSCC_MS_NON_VLAN_MTU_CHECK_NV_MTU_COMPARE(x)\t(x)\n#define MSCC_MS_NON_VLAN_MTU_CHECK_NV_MTU_COMPARE_M\tGENMASK(14, 0)\n#define MSCC_MS_NON_VLAN_MTU_CHECK_NV_MTU_COMP_DROP\tBIT(15)\n\n \n#define MSCC_MS_PP_CTRL_MACSEC_OCTET_INCR_MODE\t\tBIT(0)\n\n \n#define MSCC_MS_INTR_CTRL_STATUS_INTR_CLR_STATUS(x)\t(x)\n#define MSCC_MS_INTR_CTRL_STATUS_INTR_CLR_STATUS_M\tGENMASK(15, 0)\n#define MSCC_MS_INTR_CTRL_STATUS_INTR_ENABLE(x)\t\t((x) << 16)\n#define MSCC_MS_INTR_CTRL_STATUS_INTR_ENABLE_M\t\tGENMASK(31, 16)\n#define MACSEC_INTR_CTRL_STATUS_ROLLOVER\t\tBIT(5)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}