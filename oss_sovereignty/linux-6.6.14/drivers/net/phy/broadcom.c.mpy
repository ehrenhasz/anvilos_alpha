{
  "module_name": "broadcom.c",
  "hash_id": "18a4b109b7209b651098516f5e949aeb992fbe197440f4eb404e3d6815459a58",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/broadcom.c",
  "human_readable_source": "\n \n\n#include \"bcm-phy-lib.h\"\n#include <linux/delay.h>\n#include <linux/module.h>\n#include <linux/phy.h>\n#include <linux/pm_wakeup.h>\n#include <linux/brcmphy.h>\n#include <linux/of.h>\n#include <linux/interrupt.h>\n#include <linux/irq.h>\n#include <linux/gpio/consumer.h>\n\n#define BRCM_PHY_MODEL(phydev) \\\n\t((phydev)->drv->phy_id & (phydev)->drv->phy_id_mask)\n\n#define BRCM_PHY_REV(phydev) \\\n\t((phydev)->drv->phy_id & ~((phydev)->drv->phy_id_mask))\n\nMODULE_DESCRIPTION(\"Broadcom PHY driver\");\nMODULE_AUTHOR(\"Maciej W. Rozycki\");\nMODULE_LICENSE(\"GPL\");\n\nstruct bcm54xx_phy_priv {\n\tu64\t*stats;\n\tstruct bcm_ptp_private *ptp;\n\tint\twake_irq;\n\tbool\twake_irq_enabled;\n};\n\nstatic bool bcm54xx_phy_can_wakeup(struct phy_device *phydev)\n{\n\tstruct bcm54xx_phy_priv *priv = phydev->priv;\n\n\treturn phy_interrupt_is_valid(phydev) || priv->wake_irq >= 0;\n}\n\nstatic int bcm54xx_config_clock_delay(struct phy_device *phydev)\n{\n\tint rc, val;\n\n\t \n\tval = bcm54xx_auxctl_read(phydev, MII_BCM54XX_AUXCTL_SHDWSEL_MISC);\n\tval |= MII_BCM54XX_AUXCTL_MISC_WREN;\n\tif (phydev->interface == PHY_INTERFACE_MODE_RGMII ||\n\t    phydev->interface == PHY_INTERFACE_MODE_RGMII_TXID) {\n\t\t \n\t\tval &= ~MII_BCM54XX_AUXCTL_SHDWSEL_MISC_RGMII_SKEW_EN;\n\t}\n\tif (phydev->interface == PHY_INTERFACE_MODE_RGMII_ID ||\n\t    phydev->interface == PHY_INTERFACE_MODE_RGMII_RXID) {\n\t\t \n\t\tval |= MII_BCM54XX_AUXCTL_SHDWSEL_MISC_RGMII_SKEW_EN;\n\t}\n\trc = bcm54xx_auxctl_write(phydev, MII_BCM54XX_AUXCTL_SHDWSEL_MISC,\n\t\t\t\t  val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\tval = bcm_phy_read_shadow(phydev, BCM54810_SHD_CLK_CTL);\n\tif (phydev->interface == PHY_INTERFACE_MODE_RGMII ||\n\t    phydev->interface == PHY_INTERFACE_MODE_RGMII_RXID) {\n\t\t \n\t\tval &= ~BCM54810_SHD_CLK_CTL_GTXCLK_EN;\n\t}\n\tif (phydev->interface == PHY_INTERFACE_MODE_RGMII_ID ||\n\t    phydev->interface == PHY_INTERFACE_MODE_RGMII_TXID) {\n\t\t \n\t\tval |= BCM54810_SHD_CLK_CTL_GTXCLK_EN;\n\t}\n\trc = bcm_phy_write_shadow(phydev, BCM54810_SHD_CLK_CTL, val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\treturn 0;\n}\n\nstatic int bcm54210e_config_init(struct phy_device *phydev)\n{\n\tint val;\n\n\tbcm54xx_config_clock_delay(phydev);\n\n\tif (phydev->dev_flags & PHY_BRCM_EN_MASTER_MODE) {\n\t\tval = phy_read(phydev, MII_CTRL1000);\n\t\tval |= CTL1000_AS_MASTER | CTL1000_ENABLE_MASTER;\n\t\tphy_write(phydev, MII_CTRL1000, val);\n\t}\n\n\treturn 0;\n}\n\nstatic int bcm54612e_config_init(struct phy_device *phydev)\n{\n\tint reg;\n\n\tbcm54xx_config_clock_delay(phydev);\n\n\t \n\tif (!(phydev->dev_flags & PHY_BRCM_RX_REFCLK_UNUSED)) {\n\t\tint err;\n\n\t\treg = bcm_phy_read_exp(phydev, BCM54612E_EXP_SPARE0);\n\t\terr = bcm_phy_write_exp(phydev, BCM54612E_EXP_SPARE0,\n\t\t\t\t\tBCM54612E_LED4_CLK125OUT_EN | reg);\n\n\t\tif (err < 0)\n\t\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nstatic int bcm54616s_config_init(struct phy_device *phydev)\n{\n\tint rc, val;\n\n\tif (phydev->interface != PHY_INTERFACE_MODE_SGMII &&\n\t    phydev->interface != PHY_INTERFACE_MODE_1000BASEX)\n\t\treturn 0;\n\n\t \n\t \n\tval = bcm54xx_auxctl_read(phydev, MII_BCM54XX_AUXCTL_SHDWSEL_MISC);\n\tif (val < 0)\n\t\treturn val;\n\tval &= ~MII_BCM54XX_AUXCTL_SHDWSEL_MISC_RGMII_EN;\n\tval |= MII_BCM54XX_AUXCTL_MISC_WREN;\n\trc = bcm54xx_auxctl_write(phydev, MII_BCM54XX_AUXCTL_SHDWSEL_MISC,\n\t\t\t\t  val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\tval = bcm_phy_read_shadow(phydev, BCM54XX_SHD_MODE);\n\tif (val < 0)\n\t\treturn val;\n\tval |= BCM54XX_SHD_MODE_1000BX;\n\trc = bcm_phy_write_shadow(phydev, BCM54XX_SHD_MODE, val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\trc = phy_set_bits(phydev, MII_BMCR, BMCR_PDOWN);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\tval &= ~BCM54XX_SHD_INTF_SEL_MASK;\n\tval |= phydev->interface == PHY_INTERFACE_MODE_SGMII ?\n\t\tBCM54XX_SHD_INTF_SEL_SGMII :\n\t\tBCM54XX_SHD_INTF_SEL_GBIC;\n\trc = bcm_phy_write_shadow(phydev, BCM54XX_SHD_MODE, val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\trc = phy_clear_bits(phydev, MII_BMCR, BMCR_PDOWN);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\tval &= ~BCM54XX_SHD_MODE_1000BX;\n\trc = bcm_phy_write_shadow(phydev, BCM54XX_SHD_MODE, val);\n\tif (rc < 0)\n\t\treturn rc;\n\n\t \n\treturn phy_clear_bits(phydev, MII_BMCR, BMCR_PDOWN);\n}\n\n \nstatic int bcm50610_a0_workaround(struct phy_device *phydev)\n{\n\tint err;\n\n\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_AADJ1CH0,\n\t\t\t\tMII_BCM54XX_EXP_AADJ1CH0_SWP_ABCD_OEN |\n\t\t\t\tMII_BCM54XX_EXP_AADJ1CH0_SWSEL_THPF);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_AADJ1CH3,\n\t\t\t\tMII_BCM54XX_EXP_AADJ1CH3_ADCCKADJ);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP75,\n\t\t\t\tMII_BCM54XX_EXP_EXP75_VDACCTRL);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP96,\n\t\t\t\tMII_BCM54XX_EXP_EXP96_MYST);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP97,\n\t\t\t\tMII_BCM54XX_EXP_EXP97_MYST);\n\n\treturn err;\n}\n\nstatic int bcm54xx_phydsp_config(struct phy_device *phydev)\n{\n\tint err, err2;\n\n\t \n\terr = bcm54xx_auxctl_write(phydev,\n\t\t\t\t   MII_BCM54XX_AUXCTL_SHDWSEL_AUXCTL,\n\t\t\t\t   MII_BCM54XX_AUXCTL_ACTL_SMDSP_ENA |\n\t\t\t\t   MII_BCM54XX_AUXCTL_ACTL_TX_6DB);\n\tif (err < 0)\n\t\treturn err;\n\n\tif (BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610 ||\n\t    BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610M) {\n\t\t \n\t\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP08,\n\t\t\t\t\tMII_BCM54XX_EXP_EXP08_RJCT_2MHZ);\n\t\tif (err < 0)\n\t\t\tgoto error;\n\n\t\tif (phydev->drv->phy_id == PHY_ID_BCM50610) {\n\t\t\terr = bcm50610_a0_workaround(phydev);\n\t\t\tif (err < 0)\n\t\t\t\tgoto error;\n\t\t}\n\t}\n\n\tif (BRCM_PHY_MODEL(phydev) == PHY_ID_BCM57780) {\n\t\tint val;\n\n\t\tval = bcm_phy_read_exp(phydev, MII_BCM54XX_EXP_EXP75);\n\t\tif (val < 0)\n\t\t\tgoto error;\n\n\t\tval |= MII_BCM54XX_EXP_EXP75_CM_OSC;\n\t\terr = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP75, val);\n\t}\n\nerror:\n\t \n\terr2 = bcm54xx_auxctl_write(phydev,\n\t\t\t\t    MII_BCM54XX_AUXCTL_SHDWSEL_AUXCTL,\n\t\t\t\t    MII_BCM54XX_AUXCTL_ACTL_TX_6DB);\n\n\t \n\treturn err ? err : err2;\n}\n\nstatic void bcm54xx_adjust_rxrefclk(struct phy_device *phydev)\n{\n\tu32 orig;\n\tint val;\n\tbool clk125en = true;\n\n\t \n\tif (BRCM_PHY_MODEL(phydev) != PHY_ID_BCM57780 &&\n\t    BRCM_PHY_MODEL(phydev) != PHY_ID_BCM50610 &&\n\t    BRCM_PHY_MODEL(phydev) != PHY_ID_BCM50610M &&\n\t    BRCM_PHY_MODEL(phydev) != PHY_ID_BCM54210E &&\n\t    BRCM_PHY_MODEL(phydev) != PHY_ID_BCM54810 &&\n\t    BRCM_PHY_MODEL(phydev) != PHY_ID_BCM54811)\n\t\treturn;\n\n\tval = bcm_phy_read_shadow(phydev, BCM54XX_SHD_SCR3);\n\tif (val < 0)\n\t\treturn;\n\n\torig = val;\n\n\tif ((BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610 ||\n\t     BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610M) &&\n\t    BRCM_PHY_REV(phydev) >= 0x3) {\n\t\t \n\t\tclk125en = false;\n\t} else {\n\t\tif (phydev->dev_flags & PHY_BRCM_RX_REFCLK_UNUSED) {\n\t\t\tif (BRCM_PHY_MODEL(phydev) != PHY_ID_BCM54811) {\n\t\t\t\t \n\t\t\t\tval &= ~BCM54XX_SHD_SCR3_DEF_CLK125;\n\t\t\t}\n\t\t\tclk125en = false;\n\t\t}\n\t}\n\n\tif (!clk125en || (phydev->dev_flags & PHY_BRCM_AUTO_PWRDWN_ENABLE))\n\t\tval &= ~BCM54XX_SHD_SCR3_DLLAPD_DIS;\n\telse\n\t\tval |= BCM54XX_SHD_SCR3_DLLAPD_DIS;\n\n\tif (phydev->dev_flags & PHY_BRCM_DIS_TXCRXC_NOENRGY) {\n\t\tif (BRCM_PHY_MODEL(phydev) == PHY_ID_BCM54210E ||\n\t\t    BRCM_PHY_MODEL(phydev) == PHY_ID_BCM54810 ||\n\t\t    BRCM_PHY_MODEL(phydev) == PHY_ID_BCM54811)\n\t\t\tval |= BCM54XX_SHD_SCR3_RXCTXC_DIS;\n\t\telse\n\t\t\tval |= BCM54XX_SHD_SCR3_TRDDAPD;\n\t}\n\n\tif (orig != val)\n\t\tbcm_phy_write_shadow(phydev, BCM54XX_SHD_SCR3, val);\n\n\tval = bcm_phy_read_shadow(phydev, BCM54XX_SHD_APD);\n\tif (val < 0)\n\t\treturn;\n\n\torig = val;\n\n\tif (!clk125en || (phydev->dev_flags & PHY_BRCM_AUTO_PWRDWN_ENABLE))\n\t\tval |= BCM54XX_SHD_APD_EN;\n\telse\n\t\tval &= ~BCM54XX_SHD_APD_EN;\n\n\tif (orig != val)\n\t\tbcm_phy_write_shadow(phydev, BCM54XX_SHD_APD, val);\n}\n\nstatic void bcm54xx_ptp_stop(struct phy_device *phydev)\n{\n\tstruct bcm54xx_phy_priv *priv = phydev->priv;\n\n\tif (priv->ptp)\n\t\tbcm_ptp_stop(priv->ptp);\n}\n\nstatic void bcm54xx_ptp_config_init(struct phy_device *phydev)\n{\n\tstruct bcm54xx_phy_priv *priv = phydev->priv;\n\n\tif (priv->ptp)\n\t\tbcm_ptp_config_init(phydev);\n}\n\nstatic int bcm54xx_config_init(struct phy_device *phydev)\n{\n\tint reg, err, val;\n\n\treg = phy_read(phydev, MII_BCM54XX_ECR);\n\tif (reg < 0)\n\t\treturn reg;\n\n\t \n\treg |= MII_BCM54XX_ECR_IM;\n\terr = phy_write(phydev, MII_BCM54XX_ECR, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\treg = ~(MII_BCM54XX_INT_DUPLEX |\n\t\tMII_BCM54XX_INT_SPEED |\n\t\tMII_BCM54XX_INT_LINK);\n\terr = phy_write(phydev, MII_BCM54XX_IMR, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\tif ((BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610 ||\n\t     BRCM_PHY_MODEL(phydev) == PHY_ID_BCM50610M) &&\n\t    (phydev->dev_flags & PHY_BRCM_CLEAR_RGMII_MODE))\n\t\tbcm_phy_write_shadow(phydev, BCM54XX_SHD_RGMII_MODE, 0);\n\n\tbcm54xx_adjust_rxrefclk(phydev);\n\n\tswitch (BRCM_PHY_MODEL(phydev)) {\n\tcase PHY_ID_BCM50610:\n\tcase PHY_ID_BCM50610M:\n\t\terr = bcm54xx_config_clock_delay(phydev);\n\t\tbreak;\n\tcase PHY_ID_BCM54210E:\n\t\terr = bcm54210e_config_init(phydev);\n\t\tbreak;\n\tcase PHY_ID_BCM54612E:\n\t\terr = bcm54612e_config_init(phydev);\n\t\tbreak;\n\tcase PHY_ID_BCM54616S:\n\t\terr = bcm54616s_config_init(phydev);\n\t\tbreak;\n\tcase PHY_ID_BCM54810:\n\t\t \n\t\tval = bcm_phy_read_exp(phydev,\n\t\t\t\t       BCM54810_EXP_BROADREACH_LRE_MISC_CTL);\n\t\tval &= ~BCM54810_EXP_BROADREACH_LRE_MISC_CTL_EN;\n\t\terr = bcm_phy_write_exp(phydev,\n\t\t\t\t\tBCM54810_EXP_BROADREACH_LRE_MISC_CTL,\n\t\t\t\t\tval);\n\t\tbreak;\n\t}\n\tif (err)\n\t\treturn err;\n\n\tbcm54xx_phydsp_config(phydev);\n\n\t \n\tif (!phy_on_sfp(phydev)) {\n\t\tval = BCM54XX_SHD_LEDS1_LED1(BCM_LED_SRC_MULTICOLOR1) |\n\t\t\tBCM54XX_SHD_LEDS1_LED3(BCM_LED_SRC_MULTICOLOR1);\n\t\tbcm_phy_write_shadow(phydev, BCM54XX_SHD_LEDS1, val);\n\n\t\tval = BCM_LED_MULTICOLOR_IN_PHASE |\n\t\t\tBCM54XX_SHD_LEDS1_LED1(BCM_LED_MULTICOLOR_LINK_ACT) |\n\t\t\tBCM54XX_SHD_LEDS1_LED3(BCM_LED_MULTICOLOR_LINK_ACT);\n\t\tbcm_phy_write_exp(phydev, BCM_EXP_MULTICOLOR, val);\n\t}\n\n\tbcm54xx_ptp_config_init(phydev);\n\n\t \n\terr = bcm_phy_read_exp(phydev, BCM54XX_WOL_INT_STATUS);\n\tif (err < 0)\n\t\treturn err;\n\n\tif (err)\n\t\tpm_wakeup_event(&phydev->mdio.dev, 0);\n\n\treturn 0;\n}\n\nstatic int bcm54xx_iddq_set(struct phy_device *phydev, bool enable)\n{\n\tint ret = 0;\n\n\tif (!(phydev->dev_flags & PHY_BRCM_IDDQ_SUSPEND))\n\t\treturn ret;\n\n\tret = bcm_phy_read_exp(phydev, BCM54XX_TOP_MISC_IDDQ_CTRL);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (enable)\n\t\tret |= BCM54XX_TOP_MISC_IDDQ_SR | BCM54XX_TOP_MISC_IDDQ_LP;\n\telse\n\t\tret &= ~(BCM54XX_TOP_MISC_IDDQ_SR | BCM54XX_TOP_MISC_IDDQ_LP);\n\n\tret = bcm_phy_write_exp(phydev, BCM54XX_TOP_MISC_IDDQ_CTRL, ret);\nout:\n\treturn ret;\n}\n\nstatic int bcm54xx_set_wakeup_irq(struct phy_device *phydev, bool state)\n{\n\tstruct bcm54xx_phy_priv *priv = phydev->priv;\n\tint ret = 0;\n\n\tif (!bcm54xx_phy_can_wakeup(phydev))\n\t\treturn ret;\n\n\tif (priv->wake_irq_enabled != state) {\n\t\tif (state)\n\t\t\tret = enable_irq_wake(priv->wake_irq);\n\t\telse\n\t\t\tret = disable_irq_wake(priv->wake_irq);\n\t\tpriv->wake_irq_enabled = state;\n\t}\n\n\treturn ret;\n}\n\nstatic int bcm54xx_suspend(struct phy_device *phydev)\n{\n\tint ret = 0;\n\n\tbcm54xx_ptp_stop(phydev);\n\n\t \n\tret = bcm_phy_read_exp(phydev, BCM54XX_WOL_INT_STATUS);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (phydev->wol_enabled)\n\t\treturn bcm54xx_set_wakeup_irq(phydev, true);\n\n\t \n\tret = phy_write(phydev, MII_BMCR, BMCR_PDOWN);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn bcm54xx_iddq_set(phydev, true);\n}\n\nstatic int bcm54xx_resume(struct phy_device *phydev)\n{\n\tint ret = 0;\n\n\tif (phydev->wol_enabled) {\n\t\tret = bcm54xx_set_wakeup_irq(phydev, false);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tret = bcm54xx_iddq_set(phydev, false);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = genphy_resume(phydev);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tfsleep(40);\n\n\t \n\tif (phydev->dev_flags & PHY_BRCM_IDDQ_SUSPEND) {\n\t\tret = genphy_soft_reset(phydev);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\treturn bcm54xx_config_init(phydev);\n}\n\nstatic int bcm54810_read_mmd(struct phy_device *phydev, int devnum, u16 regnum)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic int bcm54810_write_mmd(struct phy_device *phydev, int devnum, u16 regnum,\n\t\t\t      u16 val)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic int bcm54811_config_init(struct phy_device *phydev)\n{\n\tint err, reg;\n\n\t \n\treg = bcm_phy_read_exp(phydev, BCM54810_EXP_BROADREACH_LRE_MISC_CTL);\n\treg &= ~BCM54810_EXP_BROADREACH_LRE_MISC_CTL_EN;\n\terr = bcm_phy_write_exp(phydev, BCM54810_EXP_BROADREACH_LRE_MISC_CTL,\n\t\t\t\treg);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = bcm54xx_config_init(phydev);\n\n\t \n\tif (!(phydev->dev_flags & PHY_BRCM_RX_REFCLK_UNUSED)) {\n\t\treg = bcm_phy_read_exp(phydev, BCM54612E_EXP_SPARE0);\n\t\terr = bcm_phy_write_exp(phydev, BCM54612E_EXP_SPARE0,\n\t\t\t\t\tBCM54612E_LED4_CLK125OUT_EN | reg);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t}\n\n\treturn err;\n}\n\nstatic int bcm5481_config_aneg(struct phy_device *phydev)\n{\n\tstruct device_node *np = phydev->mdio.dev.of_node;\n\tint ret;\n\n\t \n\tret = genphy_config_aneg(phydev);\n\n\t \n\tbcm54xx_config_clock_delay(phydev);\n\n\tif (of_property_read_bool(np, \"enet-phy-lane-swap\")) {\n\t\t \n\t\tret = bcm_phy_write_exp(phydev, MII_BCM54XX_EXP_SEL_ER + 0x9,\n\t\t\t\t\t0x11B);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\treturn ret;\n}\n\nstruct bcm54616s_phy_priv {\n\tbool mode_1000bx_en;\n};\n\nstatic int bcm54616s_probe(struct phy_device *phydev)\n{\n\tstruct bcm54616s_phy_priv *priv;\n\tint val;\n\n\tpriv = devm_kzalloc(&phydev->mdio.dev, sizeof(*priv), GFP_KERNEL);\n\tif (!priv)\n\t\treturn -ENOMEM;\n\n\tphydev->priv = priv;\n\n\tval = bcm_phy_read_shadow(phydev, BCM54XX_SHD_MODE);\n\tif (val < 0)\n\t\treturn val;\n\n\t \n\tif ((val & BCM54XX_SHD_INTF_SEL_MASK) == BCM54XX_SHD_INTF_SEL_RGMII) {\n\t\tval = bcm_phy_read_shadow(phydev, BCM54616S_SHD_100FX_CTRL);\n\t\tif (val < 0)\n\t\t\treturn val;\n\n\t\t \n\t\tif (!(val & BCM54616S_100FX_MODE))\n\t\t\tpriv->mode_1000bx_en = true;\n\n\t\tphydev->port = PORT_FIBRE;\n\t}\n\n\treturn 0;\n}\n\nstatic int bcm54616s_config_aneg(struct phy_device *phydev)\n{\n\tstruct bcm54616s_phy_priv *priv = phydev->priv;\n\tint ret;\n\n\t \n\tif (priv->mode_1000bx_en)\n\t\tret = genphy_c37_config_aneg(phydev);\n\telse\n\t\tret = genphy_config_aneg(phydev);\n\n\t \n\tbcm54xx_config_clock_delay(phydev);\n\n\treturn ret;\n}\n\nstatic int bcm54616s_read_status(struct phy_device *phydev)\n{\n\tstruct bcm54616s_phy_priv *priv = phydev->priv;\n\tint err;\n\n\tif (priv->mode_1000bx_en)\n\t\terr = genphy_c37_read_status(phydev);\n\telse\n\t\terr = genphy_read_status(phydev);\n\n\treturn err;\n}\n\nstatic int brcm_fet_config_init(struct phy_device *phydev)\n{\n\tint reg, err, err2, brcmtest;\n\n\t \n\terr = phy_write(phydev, MII_BMCR, BMCR_RESET);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\tusleep_range(1000, 2000);\n\n\t \n\terr = phy_read(phydev, MII_BMCR);\n\tif (err < 0 && err != -EIO)\n\t\treturn err;\n\n\treg = phy_read(phydev, MII_BRCM_FET_INTREG);\n\tif (reg < 0)\n\t\treturn reg;\n\n\t \n\treg = MII_BRCM_FET_IR_DUPLEX_EN |\n\t      MII_BRCM_FET_IR_SPEED_EN |\n\t      MII_BRCM_FET_IR_LINK_EN |\n\t      MII_BRCM_FET_IR_ENABLE |\n\t      MII_BRCM_FET_IR_MASK;\n\n\terr = phy_write(phydev, MII_BRCM_FET_INTREG, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\tbrcmtest = phy_read(phydev, MII_BRCM_FET_BRCMTEST);\n\tif (brcmtest < 0)\n\t\treturn brcmtest;\n\n\treg = brcmtest | MII_BRCM_FET_BT_SRE;\n\n\terr = phy_write(phydev, MII_BRCM_FET_BRCMTEST, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\treg = phy_read(phydev, MII_BRCM_FET_SHDW_AUXMODE4);\n\tif (reg < 0) {\n\t\terr = reg;\n\t\tgoto done;\n\t}\n\n\treg &= ~MII_BRCM_FET_SHDW_AM4_LED_MASK;\n\treg |= MII_BRCM_FET_SHDW_AM4_LED_MODE1;\n\n\terr = phy_write(phydev, MII_BRCM_FET_SHDW_AUXMODE4, reg);\n\tif (err < 0)\n\t\tgoto done;\n\n\t \n\terr = phy_set_bits(phydev, MII_BRCM_FET_SHDW_MISCCTRL,\n\t\t\t   MII_BRCM_FET_SHDW_MC_FAME);\n\tif (err < 0)\n\t\tgoto done;\n\n\tif (phydev->dev_flags & PHY_BRCM_AUTO_PWRDWN_ENABLE) {\n\t\t \n\t\terr = phy_set_bits(phydev, MII_BRCM_FET_SHDW_AUXSTAT2,\n\t\t\t\t   MII_BRCM_FET_SHDW_AS2_APDE);\n\t}\n\ndone:\n\t \n\terr2 = phy_write(phydev, MII_BRCM_FET_BRCMTEST, brcmtest);\n\tif (!err)\n\t\terr = err2;\n\n\treturn err;\n}\n\nstatic int brcm_fet_ack_interrupt(struct phy_device *phydev)\n{\n\tint reg;\n\n\t \n\treg = phy_read(phydev, MII_BRCM_FET_INTREG);\n\tif (reg < 0)\n\t\treturn reg;\n\n\treturn 0;\n}\n\nstatic int brcm_fet_config_intr(struct phy_device *phydev)\n{\n\tint reg, err;\n\n\treg = phy_read(phydev, MII_BRCM_FET_INTREG);\n\tif (reg < 0)\n\t\treturn reg;\n\n\tif (phydev->interrupts == PHY_INTERRUPT_ENABLED) {\n\t\terr = brcm_fet_ack_interrupt(phydev);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\treg &= ~MII_BRCM_FET_IR_MASK;\n\t\terr = phy_write(phydev, MII_BRCM_FET_INTREG, reg);\n\t} else {\n\t\treg |= MII_BRCM_FET_IR_MASK;\n\t\terr = phy_write(phydev, MII_BRCM_FET_INTREG, reg);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\terr = brcm_fet_ack_interrupt(phydev);\n\t}\n\n\treturn err;\n}\n\nstatic irqreturn_t brcm_fet_handle_interrupt(struct phy_device *phydev)\n{\n\tint irq_status;\n\n\tirq_status = phy_read(phydev, MII_BRCM_FET_INTREG);\n\tif (irq_status < 0) {\n\t\tphy_error(phydev);\n\t\treturn IRQ_NONE;\n\t}\n\n\tif (irq_status == 0)\n\t\treturn IRQ_NONE;\n\n\tphy_trigger_machine(phydev);\n\n\treturn IRQ_HANDLED;\n}\n\nstatic int brcm_fet_suspend(struct phy_device *phydev)\n{\n\tint reg, err, err2, brcmtest;\n\n\t \n\terr = phy_write(phydev, MII_BMCR, BMCR_PDOWN);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\tbrcmtest = phy_read(phydev, MII_BRCM_FET_BRCMTEST);\n\tif (brcmtest < 0)\n\t\treturn brcmtest;\n\n\treg = brcmtest | MII_BRCM_FET_BT_SRE;\n\n\terr = phy_write(phydev, MII_BRCM_FET_BRCMTEST, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\terr = phy_modify(phydev, MII_BRCM_FET_SHDW_AUXMODE4,\n\t\t\t MII_BRCM_FET_SHDW_AM4_STANDBY,\n\t\t\t MII_BRCM_FET_SHDW_AM4_STANDBY);\n\n\t \n\terr2 = phy_write(phydev, MII_BRCM_FET_BRCMTEST, brcmtest);\n\tif (!err)\n\t\terr = err2;\n\n\treturn err;\n}\n\nstatic void bcm54xx_phy_get_wol(struct phy_device *phydev,\n\t\t\t\tstruct ethtool_wolinfo *wol)\n{\n\t \n\tif (!bcm54xx_phy_can_wakeup(phydev)) {\n\t\twol->supported = 0;\n\t\treturn;\n\t}\n\n\tbcm_phy_get_wol(phydev, wol);\n}\n\nstatic int bcm54xx_phy_set_wol(struct phy_device *phydev,\n\t\t\t       struct ethtool_wolinfo *wol)\n{\n\tint ret;\n\n\t \n\tif (!bcm54xx_phy_can_wakeup(phydev))\n\t\treturn -EOPNOTSUPP;\n\n\tret = bcm_phy_set_wol(phydev, wol);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nstatic int bcm54xx_phy_probe(struct phy_device *phydev)\n{\n\tstruct bcm54xx_phy_priv *priv;\n\tstruct gpio_desc *wakeup_gpio;\n\tint ret = 0;\n\n\tpriv = devm_kzalloc(&phydev->mdio.dev, sizeof(*priv), GFP_KERNEL);\n\tif (!priv)\n\t\treturn -ENOMEM;\n\n\tpriv->wake_irq = -ENXIO;\n\n\tphydev->priv = priv;\n\n\tpriv->stats = devm_kcalloc(&phydev->mdio.dev,\n\t\t\t\t   bcm_phy_get_sset_count(phydev), sizeof(u64),\n\t\t\t\t   GFP_KERNEL);\n\tif (!priv->stats)\n\t\treturn -ENOMEM;\n\n\tpriv->ptp = bcm_ptp_probe(phydev);\n\tif (IS_ERR(priv->ptp))\n\t\treturn PTR_ERR(priv->ptp);\n\n\t \n\twakeup_gpio = devm_gpiod_get(&phydev->mdio.dev, \"wakeup\", GPIOD_IN);\n\tif (PTR_ERR(wakeup_gpio) == -EPROBE_DEFER)\n\t\treturn PTR_ERR(wakeup_gpio);\n\n\tif (!IS_ERR(wakeup_gpio)) {\n\t\tpriv->wake_irq = gpiod_to_irq(wakeup_gpio);\n\n\t\t \n\t\tret = devm_request_irq(&phydev->mdio.dev, priv->wake_irq,\n\t\t\t\t       bcm_phy_wol_isr,\n\t\t\t\t       IRQF_TRIGGER_LOW | IRQF_NO_AUTOEN,\n\t\t\t\t       dev_name(&phydev->mdio.dev), phydev);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\t \n\tif (!bcm54xx_phy_can_wakeup(phydev))\n\t\treturn 0;\n\n\treturn device_init_wakeup(&phydev->mdio.dev, true);\n}\n\nstatic void bcm54xx_get_stats(struct phy_device *phydev,\n\t\t\t      struct ethtool_stats *stats, u64 *data)\n{\n\tstruct bcm54xx_phy_priv *priv = phydev->priv;\n\n\tbcm_phy_get_stats(phydev, priv->stats, stats, data);\n}\n\nstatic void bcm54xx_link_change_notify(struct phy_device *phydev)\n{\n\tu16 mask = MII_BCM54XX_EXP_EXP08_EARLY_DAC_WAKE |\n\t\t   MII_BCM54XX_EXP_EXP08_FORCE_DAC_WAKE;\n\tint ret;\n\n\tif (phydev->state != PHY_RUNNING)\n\t\treturn;\n\n\t \n\tif (!(phydev->dev_flags & PHY_BRCM_AUTO_PWRDWN_ENABLE))\n\t\treturn;\n\n\tret = bcm_phy_read_exp(phydev, MII_BCM54XX_EXP_EXP08);\n\tif (ret < 0)\n\t\treturn;\n\n\t \n\tif (phydev->speed == SPEED_10)\n\t\tret |= mask;\n\telse\n\t\tret &= ~mask;\n\tbcm_phy_write_exp(phydev, MII_BCM54XX_EXP_EXP08, ret);\n}\n\nstatic struct phy_driver broadcom_drivers[] = {\n{\n\t.phy_id\t\t= PHY_ID_BCM5411,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5411\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5421,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5421\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM54210E,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM54210E\",\n\t \n\t.flags\t\t= PHY_ALWAYS_CALL_SUSPEND,\n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.suspend\t= bcm54xx_suspend,\n\t.resume\t\t= bcm54xx_resume,\n\t.get_wol\t= bcm54xx_phy_get_wol,\n\t.set_wol\t= bcm54xx_phy_set_wol,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5461,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5461\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM54612E,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM54612E\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM54616S,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM54616S\",\n\t \n\t.soft_reset     = genphy_soft_reset,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_aneg\t= bcm54616s_config_aneg,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.read_status\t= bcm54616s_read_status,\n\t.probe\t\t= bcm54616s_probe,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5464,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5464\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.suspend\t= genphy_suspend,\n\t.resume\t\t= genphy_resume,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5481,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5481\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_aneg\t= bcm5481_config_aneg,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id         = PHY_ID_BCM54810,\n\t.phy_id_mask    = 0xfffffff0,\n\t.name           = \"Broadcom BCM54810\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.read_mmd\t= bcm54810_read_mmd,\n\t.write_mmd\t= bcm54810_write_mmd,\n\t.config_init    = bcm54xx_config_init,\n\t.config_aneg    = bcm5481_config_aneg,\n\t.config_intr    = bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.suspend\t= bcm54xx_suspend,\n\t.resume\t\t= bcm54xx_resume,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id         = PHY_ID_BCM54811,\n\t.phy_id_mask    = 0xfffffff0,\n\t.name           = \"Broadcom BCM54811\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init    = bcm54811_config_init,\n\t.config_aneg    = bcm5481_config_aneg,\n\t.config_intr    = bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.suspend\t= bcm54xx_suspend,\n\t.resume\t\t= bcm54xx_resume,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5482,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5482\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM50610,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM50610\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.suspend\t= bcm54xx_suspend,\n\t.resume\t\t= bcm54xx_resume,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM50610M,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM50610M\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.suspend\t= bcm54xx_suspend,\n\t.resume\t\t= bcm54xx_resume,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM57780,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM57780\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCMAC131,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCMAC131\",\n\t \n\t.config_init\t= brcm_fet_config_init,\n\t.config_intr\t= brcm_fet_config_intr,\n\t.handle_interrupt = brcm_fet_handle_interrupt,\n\t.suspend\t= brcm_fet_suspend,\n\t.resume\t\t= brcm_fet_config_init,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5241,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5241\",\n\t \n\t.config_init\t= brcm_fet_config_init,\n\t.config_intr\t= brcm_fet_config_intr,\n\t.handle_interrupt = brcm_fet_handle_interrupt,\n\t.suspend\t= brcm_fet_suspend,\n\t.resume\t\t= brcm_fet_config_init,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM5395,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM5395\",\n\t.flags\t\t= PHY_IS_INTERNAL,\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM53125,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM53125\",\n\t.flags\t\t= PHY_IS_INTERNAL,\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id\t\t= PHY_ID_BCM53128,\n\t.phy_id_mask\t= 0xfffffff0,\n\t.name\t\t= \"Broadcom BCM53128\",\n\t.flags\t\t= PHY_IS_INTERNAL,\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init\t= bcm54xx_config_init,\n\t.config_intr\t= bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n\t.led_brightness_set\t= bcm_phy_led_brightness_set,\n}, {\n\t.phy_id         = PHY_ID_BCM89610,\n\t.phy_id_mask    = 0xfffffff0,\n\t.name           = \"Broadcom BCM89610\",\n\t \n\t.get_sset_count\t= bcm_phy_get_sset_count,\n\t.get_strings\t= bcm_phy_get_strings,\n\t.get_stats\t= bcm54xx_get_stats,\n\t.probe\t\t= bcm54xx_phy_probe,\n\t.config_init    = bcm54xx_config_init,\n\t.config_intr    = bcm_phy_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n\t.link_change_notify\t= bcm54xx_link_change_notify,\n} };\n\nmodule_phy_driver(broadcom_drivers);\n\nstatic struct mdio_device_id __maybe_unused broadcom_tbl[] = {\n\t{ PHY_ID_BCM5411, 0xfffffff0 },\n\t{ PHY_ID_BCM5421, 0xfffffff0 },\n\t{ PHY_ID_BCM54210E, 0xfffffff0 },\n\t{ PHY_ID_BCM5461, 0xfffffff0 },\n\t{ PHY_ID_BCM54612E, 0xfffffff0 },\n\t{ PHY_ID_BCM54616S, 0xfffffff0 },\n\t{ PHY_ID_BCM5464, 0xfffffff0 },\n\t{ PHY_ID_BCM5481, 0xfffffff0 },\n\t{ PHY_ID_BCM54810, 0xfffffff0 },\n\t{ PHY_ID_BCM54811, 0xfffffff0 },\n\t{ PHY_ID_BCM5482, 0xfffffff0 },\n\t{ PHY_ID_BCM50610, 0xfffffff0 },\n\t{ PHY_ID_BCM50610M, 0xfffffff0 },\n\t{ PHY_ID_BCM57780, 0xfffffff0 },\n\t{ PHY_ID_BCMAC131, 0xfffffff0 },\n\t{ PHY_ID_BCM5241, 0xfffffff0 },\n\t{ PHY_ID_BCM5395, 0xfffffff0 },\n\t{ PHY_ID_BCM53125, 0xfffffff0 },\n\t{ PHY_ID_BCM53128, 0xfffffff0 },\n\t{ PHY_ID_BCM89610, 0xfffffff0 },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, broadcom_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}