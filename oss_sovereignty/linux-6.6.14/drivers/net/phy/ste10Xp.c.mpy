{
  "module_name": "ste10Xp.c",
  "hash_id": "e62d14057407e15c04344529d43bfcbf51eba1981aef2cac73aeb9dd4ed6ed2a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/ste10Xp.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/moduleparam.h>\n#include <linux/interrupt.h>\n#include <linux/netdevice.h>\n#include <linux/ethtool.h>\n#include <linux/mii.h>\n#include <linux/phy.h>\n\n#define MII_XCIIS\t0x11\t \n#define MII_XIE\t\t0x12\t \n#define MII_XIE_DEFAULT_MASK 0x0070  \n\n#define STE101P_PHY_ID\t\t0x00061c50\n#define STE100P_PHY_ID\t\t0x1c040011\n\nstatic int ste10Xp_config_init(struct phy_device *phydev)\n{\n\tint value, err;\n\n\t \n\tvalue = phy_read(phydev, MII_BMCR);\n\tif (value < 0)\n\t\treturn value;\n\n\tvalue |= BMCR_RESET;\n\terr = phy_write(phydev, MII_BMCR, value);\n\tif (err < 0)\n\t\treturn err;\n\n\tdo {\n\t\tvalue = phy_read(phydev, MII_BMCR);\n\t} while (value & BMCR_RESET);\n\n\treturn 0;\n}\n\nstatic int ste10Xp_ack_interrupt(struct phy_device *phydev)\n{\n\tint err = phy_read(phydev, MII_XCIIS);\n\n\tif (err < 0)\n\t\treturn err;\n\n\treturn 0;\n}\n\nstatic int ste10Xp_config_intr(struct phy_device *phydev)\n{\n\tint err;\n\n\tif (phydev->interrupts == PHY_INTERRUPT_ENABLED) {\n\t\t \n\t\terr = ste10Xp_ack_interrupt(phydev);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\t \n\t\terr = phy_write(phydev, MII_XIE, MII_XIE_DEFAULT_MASK);\n\t} else {\n\t\terr = phy_write(phydev, MII_XIE, 0);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\terr = ste10Xp_ack_interrupt(phydev);\n\t}\n\n\treturn err;\n}\n\nstatic irqreturn_t ste10Xp_handle_interrupt(struct phy_device *phydev)\n{\n\tint irq_status;\n\n\tirq_status = phy_read(phydev, MII_XCIIS);\n\tif (irq_status < 0) {\n\t\tphy_error(phydev);\n\t\treturn IRQ_NONE;\n\t}\n\n\tif (!(irq_status & MII_XIE_DEFAULT_MASK))\n\t\treturn IRQ_NONE;\n\n\tphy_trigger_machine(phydev);\n\n\treturn IRQ_HANDLED;\n}\n\nstatic struct phy_driver ste10xp_pdriver[] = {\n{\n\t.phy_id = STE101P_PHY_ID,\n\t.phy_id_mask = 0xfffffff0,\n\t.name = \"STe101p\",\n\t \n\t.config_init = ste10Xp_config_init,\n\t.config_intr = ste10Xp_config_intr,\n\t.handle_interrupt = ste10Xp_handle_interrupt,\n\t.suspend = genphy_suspend,\n\t.resume = genphy_resume,\n}, {\n\t.phy_id = STE100P_PHY_ID,\n\t.phy_id_mask = 0xffffffff,\n\t.name = \"STe100p\",\n\t \n\t.config_init = ste10Xp_config_init,\n\t.config_intr = ste10Xp_config_intr,\n\t.handle_interrupt = ste10Xp_handle_interrupt,\n\t.suspend = genphy_suspend,\n\t.resume = genphy_resume,\n} };\n\nmodule_phy_driver(ste10xp_pdriver);\n\nstatic struct mdio_device_id __maybe_unused ste10Xp_tbl[] = {\n\t{ STE101P_PHY_ID, 0xfffffff0 },\n\t{ STE100P_PHY_ID, 0xffffffff },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, ste10Xp_tbl);\n\nMODULE_DESCRIPTION(\"STMicroelectronics STe10Xp PHY driver\");\nMODULE_AUTHOR(\"Giuseppe Cavallaro <peppe.cavallaro@st.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}