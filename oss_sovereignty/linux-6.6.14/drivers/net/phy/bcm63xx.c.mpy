{
  "module_name": "bcm63xx.c",
  "hash_id": "9c0f8162a9dea88e661e471898eb854b34dc54edaad5940c177ce45aa4c9f09b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/phy/bcm63xx.c",
  "human_readable_source": "\n \n#include \"bcm-phy-lib.h\"\n#include <linux/module.h>\n#include <linux/phy.h>\n\n#define MII_BCM63XX_IR\t\t0x1a\t \n#define MII_BCM63XX_IR_EN\t0x4000\t \n#define MII_BCM63XX_IR_DUPLEX\t0x0800\t \n#define MII_BCM63XX_IR_SPEED\t0x0400\t \n#define MII_BCM63XX_IR_LINK\t0x0200\t \n#define MII_BCM63XX_IR_GMASK\t0x0100\t \n\nMODULE_DESCRIPTION(\"Broadcom 63xx internal PHY driver\");\nMODULE_AUTHOR(\"Maxime Bizon <mbizon@freebox.fr>\");\nMODULE_LICENSE(\"GPL\");\n\nstatic int bcm63xx_config_intr(struct phy_device *phydev)\n{\n\tint reg, err;\n\n\treg = phy_read(phydev, MII_BCM63XX_IR);\n\tif (reg < 0)\n\t\treturn reg;\n\n\tif (phydev->interrupts == PHY_INTERRUPT_ENABLED) {\n\t\terr = bcm_phy_ack_intr(phydev);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\treg &= ~MII_BCM63XX_IR_GMASK;\n\t\terr = phy_write(phydev, MII_BCM63XX_IR, reg);\n\t} else {\n\t\treg |= MII_BCM63XX_IR_GMASK;\n\t\terr = phy_write(phydev, MII_BCM63XX_IR, reg);\n\t\tif (err)\n\t\t\treturn err;\n\n\t\terr = bcm_phy_ack_intr(phydev);\n\t}\n\n\treturn err;\n}\n\nstatic int bcm63xx_config_init(struct phy_device *phydev)\n{\n\tint reg, err;\n\n\t \n\tlinkmode_set_bit(ETHTOOL_LINK_MODE_Pause_BIT, phydev->supported);\n\n\treg = phy_read(phydev, MII_BCM63XX_IR);\n\tif (reg < 0)\n\t\treturn reg;\n\n\t \n\treg |= MII_BCM63XX_IR_GMASK;\n\terr = phy_write(phydev, MII_BCM63XX_IR, reg);\n\tif (err < 0)\n\t\treturn err;\n\n\t \n\treg = ~(MII_BCM63XX_IR_DUPLEX |\n\t\tMII_BCM63XX_IR_SPEED |\n\t\tMII_BCM63XX_IR_LINK) |\n\t\tMII_BCM63XX_IR_EN;\n\treturn phy_write(phydev, MII_BCM63XX_IR, reg);\n}\n\nstatic struct phy_driver bcm63xx_driver[] = {\n{\n\t.phy_id\t\t= 0x00406000,\n\t.phy_id_mask\t= 0xfffffc00,\n\t.name\t\t= \"Broadcom BCM63XX (1)\",\n\t \n\t.flags\t\t= PHY_IS_INTERNAL,\n\t.config_init\t= bcm63xx_config_init,\n\t.config_intr\t= bcm63xx_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n}, {\n\t \n\t.phy_id\t\t= 0x002bdc00,\n\t.phy_id_mask\t= 0xfffffc00,\n\t.name\t\t= \"Broadcom BCM63XX (2)\",\n\t \n\t.flags\t\t= PHY_IS_INTERNAL,\n\t.config_init\t= bcm63xx_config_init,\n\t.config_intr\t= bcm63xx_config_intr,\n\t.handle_interrupt = bcm_phy_handle_interrupt,\n} };\n\nmodule_phy_driver(bcm63xx_driver);\n\nstatic struct mdio_device_id __maybe_unused bcm63xx_tbl[] = {\n\t{ 0x00406000, 0xfffffc00 },\n\t{ 0x002bdc00, 0xfffffc00 },\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(mdio, bcm63xx_tbl);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}