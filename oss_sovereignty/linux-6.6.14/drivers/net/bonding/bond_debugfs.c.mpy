{
  "module_name": "bond_debugfs.c",
  "hash_id": "3bc081c8e0af65e0d7b30a7465dad4079ff3b8925fcb4ecb006141443950f378",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/bonding/bond_debugfs.c",
  "human_readable_source": "\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/device.h>\n#include <linux/netdevice.h>\n\n#include <net/bonding.h>\n#include <net/bond_alb.h>\n\n#if defined(CONFIG_DEBUG_FS) && !defined(CONFIG_NET_NS)\n\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n\nstatic struct dentry *bonding_debug_root;\n\n \nstatic int bond_debug_rlb_hash_show(struct seq_file *m, void *v)\n{\n\tstruct bonding *bond = m->private;\n\tstruct alb_bond_info *bond_info = &(BOND_ALB_INFO(bond));\n\tstruct rlb_client_info *client_info;\n\tu32 hash_index;\n\n\tif (BOND_MODE(bond) != BOND_MODE_ALB)\n\t\treturn 0;\n\n\tseq_printf(m, \"SourceIP        DestinationIP   \"\n\t\t\t\"Destination MAC   DEV\\n\");\n\n\tspin_lock_bh(&bond->mode_lock);\n\n\thash_index = bond_info->rx_hashtbl_used_head;\n\tfor (; hash_index != RLB_NULL_INDEX;\n\t     hash_index = client_info->used_next) {\n\t\tclient_info = &(bond_info->rx_hashtbl[hash_index]);\n\t\tseq_printf(m, \"%-15pI4 %-15pI4 %-17pM %s\\n\",\n\t\t\t&client_info->ip_src,\n\t\t\t&client_info->ip_dst,\n\t\t\t&client_info->mac_dst,\n\t\t\tclient_info->slave->dev->name);\n\t}\n\n\tspin_unlock_bh(&bond->mode_lock);\n\n\treturn 0;\n}\nDEFINE_SHOW_ATTRIBUTE(bond_debug_rlb_hash);\n\nvoid bond_debug_register(struct bonding *bond)\n{\n\tbond->debug_dir =\n\t\tdebugfs_create_dir(bond->dev->name, bonding_debug_root);\n\n\tdebugfs_create_file(\"rlb_hash_table\", 0400, bond->debug_dir,\n\t\t\t\tbond, &bond_debug_rlb_hash_fops);\n}\n\nvoid bond_debug_unregister(struct bonding *bond)\n{\n\tdebugfs_remove_recursive(bond->debug_dir);\n}\n\nvoid bond_debug_reregister(struct bonding *bond)\n{\n\tstruct dentry *d;\n\n\td = debugfs_rename(bonding_debug_root, bond->debug_dir,\n\t\t\t   bonding_debug_root, bond->dev->name);\n\tif (!IS_ERR(d)) {\n\t\tbond->debug_dir = d;\n\t} else {\n\t\tnetdev_warn(bond->dev, \"failed to reregister, so just unregister old one\\n\");\n\t\tbond_debug_unregister(bond);\n\t}\n}\n\nvoid __init bond_create_debugfs(void)\n{\n\tbonding_debug_root = debugfs_create_dir(\"bonding\", NULL);\n\n\tif (IS_ERR(bonding_debug_root))\n\t\tpr_warn(\"Warning: Cannot create bonding directory in debugfs\\n\");\n}\n\nvoid bond_destroy_debugfs(void)\n{\n\tdebugfs_remove_recursive(bonding_debug_root);\n\tbonding_debug_root = NULL;\n}\n\n\n#else  \n\nvoid bond_debug_register(struct bonding *bond)\n{\n}\n\nvoid bond_debug_unregister(struct bonding *bond)\n{\n}\n\nvoid bond_debug_reregister(struct bonding *bond)\n{\n}\n\nvoid __init bond_create_debugfs(void)\n{\n}\n\nvoid bond_destroy_debugfs(void)\n{\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}