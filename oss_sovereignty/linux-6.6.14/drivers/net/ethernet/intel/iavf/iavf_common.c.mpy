{
  "module_name": "iavf_common.c",
  "hash_id": "20b74b2341c0b57de8700a7a3e870c9d7658d98c9065f9c7a9c42083d71d8303",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/iavf/iavf_common.c",
  "human_readable_source": "\n \n\n#include \"iavf_type.h\"\n#include \"iavf_adminq.h\"\n#include \"iavf_prototype.h\"\n#include <linux/avf/virtchnl.h>\n\n \nenum iavf_status iavf_set_mac_type(struct iavf_hw *hw)\n{\n\tenum iavf_status status = 0;\n\n\tif (hw->vendor_id == PCI_VENDOR_ID_INTEL) {\n\t\tswitch (hw->device_id) {\n\t\tcase IAVF_DEV_ID_X722_VF:\n\t\t\thw->mac.type = IAVF_MAC_X722_VF;\n\t\t\tbreak;\n\t\tcase IAVF_DEV_ID_VF:\n\t\tcase IAVF_DEV_ID_VF_HV:\n\t\tcase IAVF_DEV_ID_ADAPTIVE_VF:\n\t\t\thw->mac.type = IAVF_MAC_VF;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\thw->mac.type = IAVF_MAC_GENERIC;\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tstatus = IAVF_ERR_DEVICE_NOT_SUPPORTED;\n\t}\n\n\treturn status;\n}\n\n \nconst char *iavf_aq_str(struct iavf_hw *hw, enum iavf_admin_queue_err aq_err)\n{\n\tswitch (aq_err) {\n\tcase IAVF_AQ_RC_OK:\n\t\treturn \"OK\";\n\tcase IAVF_AQ_RC_EPERM:\n\t\treturn \"IAVF_AQ_RC_EPERM\";\n\tcase IAVF_AQ_RC_ENOENT:\n\t\treturn \"IAVF_AQ_RC_ENOENT\";\n\tcase IAVF_AQ_RC_ESRCH:\n\t\treturn \"IAVF_AQ_RC_ESRCH\";\n\tcase IAVF_AQ_RC_EINTR:\n\t\treturn \"IAVF_AQ_RC_EINTR\";\n\tcase IAVF_AQ_RC_EIO:\n\t\treturn \"IAVF_AQ_RC_EIO\";\n\tcase IAVF_AQ_RC_ENXIO:\n\t\treturn \"IAVF_AQ_RC_ENXIO\";\n\tcase IAVF_AQ_RC_E2BIG:\n\t\treturn \"IAVF_AQ_RC_E2BIG\";\n\tcase IAVF_AQ_RC_EAGAIN:\n\t\treturn \"IAVF_AQ_RC_EAGAIN\";\n\tcase IAVF_AQ_RC_ENOMEM:\n\t\treturn \"IAVF_AQ_RC_ENOMEM\";\n\tcase IAVF_AQ_RC_EACCES:\n\t\treturn \"IAVF_AQ_RC_EACCES\";\n\tcase IAVF_AQ_RC_EFAULT:\n\t\treturn \"IAVF_AQ_RC_EFAULT\";\n\tcase IAVF_AQ_RC_EBUSY:\n\t\treturn \"IAVF_AQ_RC_EBUSY\";\n\tcase IAVF_AQ_RC_EEXIST:\n\t\treturn \"IAVF_AQ_RC_EEXIST\";\n\tcase IAVF_AQ_RC_EINVAL:\n\t\treturn \"IAVF_AQ_RC_EINVAL\";\n\tcase IAVF_AQ_RC_ENOTTY:\n\t\treturn \"IAVF_AQ_RC_ENOTTY\";\n\tcase IAVF_AQ_RC_ENOSPC:\n\t\treturn \"IAVF_AQ_RC_ENOSPC\";\n\tcase IAVF_AQ_RC_ENOSYS:\n\t\treturn \"IAVF_AQ_RC_ENOSYS\";\n\tcase IAVF_AQ_RC_ERANGE:\n\t\treturn \"IAVF_AQ_RC_ERANGE\";\n\tcase IAVF_AQ_RC_EFLUSHED:\n\t\treturn \"IAVF_AQ_RC_EFLUSHED\";\n\tcase IAVF_AQ_RC_BAD_ADDR:\n\t\treturn \"IAVF_AQ_RC_BAD_ADDR\";\n\tcase IAVF_AQ_RC_EMODE:\n\t\treturn \"IAVF_AQ_RC_EMODE\";\n\tcase IAVF_AQ_RC_EFBIG:\n\t\treturn \"IAVF_AQ_RC_EFBIG\";\n\t}\n\n\tsnprintf(hw->err_str, sizeof(hw->err_str), \"%d\", aq_err);\n\treturn hw->err_str;\n}\n\n \nconst char *iavf_stat_str(struct iavf_hw *hw, enum iavf_status stat_err)\n{\n\tswitch (stat_err) {\n\tcase 0:\n\t\treturn \"OK\";\n\tcase IAVF_ERR_NVM:\n\t\treturn \"IAVF_ERR_NVM\";\n\tcase IAVF_ERR_NVM_CHECKSUM:\n\t\treturn \"IAVF_ERR_NVM_CHECKSUM\";\n\tcase IAVF_ERR_PHY:\n\t\treturn \"IAVF_ERR_PHY\";\n\tcase IAVF_ERR_CONFIG:\n\t\treturn \"IAVF_ERR_CONFIG\";\n\tcase IAVF_ERR_PARAM:\n\t\treturn \"IAVF_ERR_PARAM\";\n\tcase IAVF_ERR_MAC_TYPE:\n\t\treturn \"IAVF_ERR_MAC_TYPE\";\n\tcase IAVF_ERR_UNKNOWN_PHY:\n\t\treturn \"IAVF_ERR_UNKNOWN_PHY\";\n\tcase IAVF_ERR_LINK_SETUP:\n\t\treturn \"IAVF_ERR_LINK_SETUP\";\n\tcase IAVF_ERR_ADAPTER_STOPPED:\n\t\treturn \"IAVF_ERR_ADAPTER_STOPPED\";\n\tcase IAVF_ERR_INVALID_MAC_ADDR:\n\t\treturn \"IAVF_ERR_INVALID_MAC_ADDR\";\n\tcase IAVF_ERR_DEVICE_NOT_SUPPORTED:\n\t\treturn \"IAVF_ERR_DEVICE_NOT_SUPPORTED\";\n\tcase IAVF_ERR_PRIMARY_REQUESTS_PENDING:\n\t\treturn \"IAVF_ERR_PRIMARY_REQUESTS_PENDING\";\n\tcase IAVF_ERR_INVALID_LINK_SETTINGS:\n\t\treturn \"IAVF_ERR_INVALID_LINK_SETTINGS\";\n\tcase IAVF_ERR_AUTONEG_NOT_COMPLETE:\n\t\treturn \"IAVF_ERR_AUTONEG_NOT_COMPLETE\";\n\tcase IAVF_ERR_RESET_FAILED:\n\t\treturn \"IAVF_ERR_RESET_FAILED\";\n\tcase IAVF_ERR_SWFW_SYNC:\n\t\treturn \"IAVF_ERR_SWFW_SYNC\";\n\tcase IAVF_ERR_NO_AVAILABLE_VSI:\n\t\treturn \"IAVF_ERR_NO_AVAILABLE_VSI\";\n\tcase IAVF_ERR_NO_MEMORY:\n\t\treturn \"IAVF_ERR_NO_MEMORY\";\n\tcase IAVF_ERR_BAD_PTR:\n\t\treturn \"IAVF_ERR_BAD_PTR\";\n\tcase IAVF_ERR_RING_FULL:\n\t\treturn \"IAVF_ERR_RING_FULL\";\n\tcase IAVF_ERR_INVALID_PD_ID:\n\t\treturn \"IAVF_ERR_INVALID_PD_ID\";\n\tcase IAVF_ERR_INVALID_QP_ID:\n\t\treturn \"IAVF_ERR_INVALID_QP_ID\";\n\tcase IAVF_ERR_INVALID_CQ_ID:\n\t\treturn \"IAVF_ERR_INVALID_CQ_ID\";\n\tcase IAVF_ERR_INVALID_CEQ_ID:\n\t\treturn \"IAVF_ERR_INVALID_CEQ_ID\";\n\tcase IAVF_ERR_INVALID_AEQ_ID:\n\t\treturn \"IAVF_ERR_INVALID_AEQ_ID\";\n\tcase IAVF_ERR_INVALID_SIZE:\n\t\treturn \"IAVF_ERR_INVALID_SIZE\";\n\tcase IAVF_ERR_INVALID_ARP_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_ARP_INDEX\";\n\tcase IAVF_ERR_INVALID_FPM_FUNC_ID:\n\t\treturn \"IAVF_ERR_INVALID_FPM_FUNC_ID\";\n\tcase IAVF_ERR_QP_INVALID_MSG_SIZE:\n\t\treturn \"IAVF_ERR_QP_INVALID_MSG_SIZE\";\n\tcase IAVF_ERR_QP_TOOMANY_WRS_POSTED:\n\t\treturn \"IAVF_ERR_QP_TOOMANY_WRS_POSTED\";\n\tcase IAVF_ERR_INVALID_FRAG_COUNT:\n\t\treturn \"IAVF_ERR_INVALID_FRAG_COUNT\";\n\tcase IAVF_ERR_QUEUE_EMPTY:\n\t\treturn \"IAVF_ERR_QUEUE_EMPTY\";\n\tcase IAVF_ERR_INVALID_ALIGNMENT:\n\t\treturn \"IAVF_ERR_INVALID_ALIGNMENT\";\n\tcase IAVF_ERR_FLUSHED_QUEUE:\n\t\treturn \"IAVF_ERR_FLUSHED_QUEUE\";\n\tcase IAVF_ERR_INVALID_PUSH_PAGE_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_PUSH_PAGE_INDEX\";\n\tcase IAVF_ERR_INVALID_IMM_DATA_SIZE:\n\t\treturn \"IAVF_ERR_INVALID_IMM_DATA_SIZE\";\n\tcase IAVF_ERR_TIMEOUT:\n\t\treturn \"IAVF_ERR_TIMEOUT\";\n\tcase IAVF_ERR_OPCODE_MISMATCH:\n\t\treturn \"IAVF_ERR_OPCODE_MISMATCH\";\n\tcase IAVF_ERR_CQP_COMPL_ERROR:\n\t\treturn \"IAVF_ERR_CQP_COMPL_ERROR\";\n\tcase IAVF_ERR_INVALID_VF_ID:\n\t\treturn \"IAVF_ERR_INVALID_VF_ID\";\n\tcase IAVF_ERR_INVALID_HMCFN_ID:\n\t\treturn \"IAVF_ERR_INVALID_HMCFN_ID\";\n\tcase IAVF_ERR_BACKING_PAGE_ERROR:\n\t\treturn \"IAVF_ERR_BACKING_PAGE_ERROR\";\n\tcase IAVF_ERR_NO_PBLCHUNKS_AVAILABLE:\n\t\treturn \"IAVF_ERR_NO_PBLCHUNKS_AVAILABLE\";\n\tcase IAVF_ERR_INVALID_PBLE_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_PBLE_INDEX\";\n\tcase IAVF_ERR_INVALID_SD_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_SD_INDEX\";\n\tcase IAVF_ERR_INVALID_PAGE_DESC_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_PAGE_DESC_INDEX\";\n\tcase IAVF_ERR_INVALID_SD_TYPE:\n\t\treturn \"IAVF_ERR_INVALID_SD_TYPE\";\n\tcase IAVF_ERR_MEMCPY_FAILED:\n\t\treturn \"IAVF_ERR_MEMCPY_FAILED\";\n\tcase IAVF_ERR_INVALID_HMC_OBJ_INDEX:\n\t\treturn \"IAVF_ERR_INVALID_HMC_OBJ_INDEX\";\n\tcase IAVF_ERR_INVALID_HMC_OBJ_COUNT:\n\t\treturn \"IAVF_ERR_INVALID_HMC_OBJ_COUNT\";\n\tcase IAVF_ERR_INVALID_SRQ_ARM_LIMIT:\n\t\treturn \"IAVF_ERR_INVALID_SRQ_ARM_LIMIT\";\n\tcase IAVF_ERR_SRQ_ENABLED:\n\t\treturn \"IAVF_ERR_SRQ_ENABLED\";\n\tcase IAVF_ERR_ADMIN_QUEUE_ERROR:\n\t\treturn \"IAVF_ERR_ADMIN_QUEUE_ERROR\";\n\tcase IAVF_ERR_ADMIN_QUEUE_TIMEOUT:\n\t\treturn \"IAVF_ERR_ADMIN_QUEUE_TIMEOUT\";\n\tcase IAVF_ERR_BUF_TOO_SHORT:\n\t\treturn \"IAVF_ERR_BUF_TOO_SHORT\";\n\tcase IAVF_ERR_ADMIN_QUEUE_FULL:\n\t\treturn \"IAVF_ERR_ADMIN_QUEUE_FULL\";\n\tcase IAVF_ERR_ADMIN_QUEUE_NO_WORK:\n\t\treturn \"IAVF_ERR_ADMIN_QUEUE_NO_WORK\";\n\tcase IAVF_ERR_BAD_RDMA_CQE:\n\t\treturn \"IAVF_ERR_BAD_RDMA_CQE\";\n\tcase IAVF_ERR_NVM_BLANK_MODE:\n\t\treturn \"IAVF_ERR_NVM_BLANK_MODE\";\n\tcase IAVF_ERR_NOT_IMPLEMENTED:\n\t\treturn \"IAVF_ERR_NOT_IMPLEMENTED\";\n\tcase IAVF_ERR_PE_DOORBELL_NOT_ENABLED:\n\t\treturn \"IAVF_ERR_PE_DOORBELL_NOT_ENABLED\";\n\tcase IAVF_ERR_DIAG_TEST_FAILED:\n\t\treturn \"IAVF_ERR_DIAG_TEST_FAILED\";\n\tcase IAVF_ERR_NOT_READY:\n\t\treturn \"IAVF_ERR_NOT_READY\";\n\tcase IAVF_NOT_SUPPORTED:\n\t\treturn \"IAVF_NOT_SUPPORTED\";\n\tcase IAVF_ERR_FIRMWARE_API_VERSION:\n\t\treturn \"IAVF_ERR_FIRMWARE_API_VERSION\";\n\tcase IAVF_ERR_ADMIN_QUEUE_CRITICAL_ERROR:\n\t\treturn \"IAVF_ERR_ADMIN_QUEUE_CRITICAL_ERROR\";\n\t}\n\n\tsnprintf(hw->err_str, sizeof(hw->err_str), \"%d\", stat_err);\n\treturn hw->err_str;\n}\n\n \nvoid iavf_debug_aq(struct iavf_hw *hw, enum iavf_debug_mask mask, void *desc,\n\t\t   void *buffer, u16 buf_len)\n{\n\tstruct iavf_aq_desc *aq_desc = (struct iavf_aq_desc *)desc;\n\tu8 *buf = (u8 *)buffer;\n\n\tif ((!(mask & hw->debug_mask)) || !desc)\n\t\treturn;\n\n\tiavf_debug(hw, mask,\n\t\t   \"AQ CMD: opcode 0x%04X, flags 0x%04X, datalen 0x%04X, retval 0x%04X\\n\",\n\t\t   le16_to_cpu(aq_desc->opcode),\n\t\t   le16_to_cpu(aq_desc->flags),\n\t\t   le16_to_cpu(aq_desc->datalen),\n\t\t   le16_to_cpu(aq_desc->retval));\n\tiavf_debug(hw, mask, \"\\tcookie (h,l) 0x%08X 0x%08X\\n\",\n\t\t   le32_to_cpu(aq_desc->cookie_high),\n\t\t   le32_to_cpu(aq_desc->cookie_low));\n\tiavf_debug(hw, mask, \"\\tparam (0,1)  0x%08X 0x%08X\\n\",\n\t\t   le32_to_cpu(aq_desc->params.internal.param0),\n\t\t   le32_to_cpu(aq_desc->params.internal.param1));\n\tiavf_debug(hw, mask, \"\\taddr (h,l)   0x%08X 0x%08X\\n\",\n\t\t   le32_to_cpu(aq_desc->params.external.addr_high),\n\t\t   le32_to_cpu(aq_desc->params.external.addr_low));\n\n\tif (buffer && aq_desc->datalen) {\n\t\tu16 len = le16_to_cpu(aq_desc->datalen);\n\n\t\tiavf_debug(hw, mask, \"AQ CMD Buffer:\\n\");\n\t\tif (buf_len < len)\n\t\t\tlen = buf_len;\n\t\t \n\t\tif (hw->debug_mask & mask) {\n\t\t\tchar prefix[27];\n\n\t\t\tsnprintf(prefix, sizeof(prefix),\n\t\t\t\t \"iavf %02x:%02x.%x: \\t0x\",\n\t\t\t\t hw->bus.bus_id,\n\t\t\t\t hw->bus.device,\n\t\t\t\t hw->bus.func);\n\n\t\t\tprint_hex_dump(KERN_INFO, prefix, DUMP_PREFIX_OFFSET,\n\t\t\t\t       16, 1, buf, len, false);\n\t\t}\n\t}\n}\n\n \nbool iavf_check_asq_alive(struct iavf_hw *hw)\n{\n\tif (hw->aq.asq.len)\n\t\treturn !!(rd32(hw, hw->aq.asq.len) &\n\t\t\t  IAVF_VF_ATQLEN1_ATQENABLE_MASK);\n\telse\n\t\treturn false;\n}\n\n \nenum iavf_status iavf_aq_queue_shutdown(struct iavf_hw *hw, bool unloading)\n{\n\tstruct iavf_aq_desc desc;\n\tstruct iavf_aqc_queue_shutdown *cmd =\n\t\t(struct iavf_aqc_queue_shutdown *)&desc.params.raw;\n\tenum iavf_status status;\n\n\tiavf_fill_default_direct_cmd_desc(&desc, iavf_aqc_opc_queue_shutdown);\n\n\tif (unloading)\n\t\tcmd->driver_unloading = cpu_to_le32(IAVF_AQ_DRIVER_UNLOADING);\n\tstatus = iavf_asq_send_command(hw, &desc, NULL, 0, NULL);\n\n\treturn status;\n}\n\n \nstatic enum iavf_status iavf_aq_get_set_rss_lut(struct iavf_hw *hw,\n\t\t\t\t\t\tu16 vsi_id, bool pf_lut,\n\t\t\t\t\t\tu8 *lut, u16 lut_size,\n\t\t\t\t\t\tbool set)\n{\n\tenum iavf_status status;\n\tstruct iavf_aq_desc desc;\n\tstruct iavf_aqc_get_set_rss_lut *cmd_resp =\n\t\t   (struct iavf_aqc_get_set_rss_lut *)&desc.params.raw;\n\n\tif (set)\n\t\tiavf_fill_default_direct_cmd_desc(&desc,\n\t\t\t\t\t\t  iavf_aqc_opc_set_rss_lut);\n\telse\n\t\tiavf_fill_default_direct_cmd_desc(&desc,\n\t\t\t\t\t\t  iavf_aqc_opc_get_rss_lut);\n\n\t \n\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_BUF);\n\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_RD);\n\n\tcmd_resp->vsi_id =\n\t\t\tcpu_to_le16((u16)((vsi_id <<\n\t\t\t\t\t  IAVF_AQC_SET_RSS_LUT_VSI_ID_SHIFT) &\n\t\t\t\t\t  IAVF_AQC_SET_RSS_LUT_VSI_ID_MASK));\n\tcmd_resp->vsi_id |= cpu_to_le16((u16)IAVF_AQC_SET_RSS_LUT_VSI_VALID);\n\n\tif (pf_lut)\n\t\tcmd_resp->flags |= cpu_to_le16((u16)\n\t\t\t\t\t((IAVF_AQC_SET_RSS_LUT_TABLE_TYPE_PF <<\n\t\t\t\t\tIAVF_AQC_SET_RSS_LUT_TABLE_TYPE_SHIFT) &\n\t\t\t\t\tIAVF_AQC_SET_RSS_LUT_TABLE_TYPE_MASK));\n\telse\n\t\tcmd_resp->flags |= cpu_to_le16((u16)\n\t\t\t\t\t((IAVF_AQC_SET_RSS_LUT_TABLE_TYPE_VSI <<\n\t\t\t\t\tIAVF_AQC_SET_RSS_LUT_TABLE_TYPE_SHIFT) &\n\t\t\t\t\tIAVF_AQC_SET_RSS_LUT_TABLE_TYPE_MASK));\n\n\tstatus = iavf_asq_send_command(hw, &desc, lut, lut_size, NULL);\n\n\treturn status;\n}\n\n \nenum iavf_status iavf_aq_set_rss_lut(struct iavf_hw *hw, u16 vsi_id,\n\t\t\t\t     bool pf_lut, u8 *lut, u16 lut_size)\n{\n\treturn iavf_aq_get_set_rss_lut(hw, vsi_id, pf_lut, lut, lut_size, true);\n}\n\n \nstatic enum\niavf_status iavf_aq_get_set_rss_key(struct iavf_hw *hw, u16 vsi_id,\n\t\t\t\t    struct iavf_aqc_get_set_rss_key_data *key,\n\t\t\t\t    bool set)\n{\n\tenum iavf_status status;\n\tstruct iavf_aq_desc desc;\n\tstruct iavf_aqc_get_set_rss_key *cmd_resp =\n\t\t\t(struct iavf_aqc_get_set_rss_key *)&desc.params.raw;\n\tu16 key_size = sizeof(struct iavf_aqc_get_set_rss_key_data);\n\n\tif (set)\n\t\tiavf_fill_default_direct_cmd_desc(&desc,\n\t\t\t\t\t\t  iavf_aqc_opc_set_rss_key);\n\telse\n\t\tiavf_fill_default_direct_cmd_desc(&desc,\n\t\t\t\t\t\t  iavf_aqc_opc_get_rss_key);\n\n\t \n\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_BUF);\n\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_RD);\n\n\tcmd_resp->vsi_id =\n\t\t\tcpu_to_le16((u16)((vsi_id <<\n\t\t\t\t\t  IAVF_AQC_SET_RSS_KEY_VSI_ID_SHIFT) &\n\t\t\t\t\t  IAVF_AQC_SET_RSS_KEY_VSI_ID_MASK));\n\tcmd_resp->vsi_id |= cpu_to_le16((u16)IAVF_AQC_SET_RSS_KEY_VSI_VALID);\n\n\tstatus = iavf_asq_send_command(hw, &desc, key, key_size, NULL);\n\n\treturn status;\n}\n\n \nenum iavf_status iavf_aq_set_rss_key(struct iavf_hw *hw, u16 vsi_id,\n\t\t\t\t     struct iavf_aqc_get_set_rss_key_data *key)\n{\n\treturn iavf_aq_get_set_rss_key(hw, vsi_id, key, true);\n}\n\n \n\n \n#define IAVF_PTT(PTYPE, OUTER_IP, OUTER_IP_VER, OUTER_FRAG, T, TE, TEF, I, PL)\\\n\t[PTYPE] = { \\\n\t\t1, \\\n\t\tIAVF_RX_PTYPE_OUTER_##OUTER_IP, \\\n\t\tIAVF_RX_PTYPE_OUTER_##OUTER_IP_VER, \\\n\t\tIAVF_RX_PTYPE_##OUTER_FRAG, \\\n\t\tIAVF_RX_PTYPE_TUNNEL_##T, \\\n\t\tIAVF_RX_PTYPE_TUNNEL_END_##TE, \\\n\t\tIAVF_RX_PTYPE_##TEF, \\\n\t\tIAVF_RX_PTYPE_INNER_PROT_##I, \\\n\t\tIAVF_RX_PTYPE_PAYLOAD_LAYER_##PL }\n\n#define IAVF_PTT_UNUSED_ENTRY(PTYPE) [PTYPE] = { 0, 0, 0, 0, 0, 0, 0, 0, 0 }\n\n \n#define IAVF_RX_PTYPE_NOF\t\tIAVF_RX_PTYPE_NOT_FRAG\n#define IAVF_RX_PTYPE_FRG\t\tIAVF_RX_PTYPE_FRAG\n#define IAVF_RX_PTYPE_INNER_PROT_TS\tIAVF_RX_PTYPE_INNER_PROT_TIMESYNC\n\n \nstruct iavf_rx_ptype_decoded iavf_ptype_lookup[BIT(8)] = {\n\t \n\tIAVF_PTT_UNUSED_ENTRY(0),\n\tIAVF_PTT(1,  L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY2),\n\tIAVF_PTT(2,  L2, NONE, NOF, NONE, NONE, NOF, TS,   PAY2),\n\tIAVF_PTT(3,  L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY2),\n\tIAVF_PTT_UNUSED_ENTRY(4),\n\tIAVF_PTT_UNUSED_ENTRY(5),\n\tIAVF_PTT(6,  L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY2),\n\tIAVF_PTT(7,  L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY2),\n\tIAVF_PTT_UNUSED_ENTRY(8),\n\tIAVF_PTT_UNUSED_ENTRY(9),\n\tIAVF_PTT(10, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY2),\n\tIAVF_PTT(11, L2, NONE, NOF, NONE, NONE, NOF, NONE, NONE),\n\tIAVF_PTT(12, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(13, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(14, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(15, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(16, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(17, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(18, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(19, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(20, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(21, L2, NONE, NOF, NONE, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(22, IP, IPV4, FRG, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(23, IP, IPV4, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(24, IP, IPV4, NOF, NONE, NONE, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(25),\n\tIAVF_PTT(26, IP, IPV4, NOF, NONE, NONE, NOF, TCP,  PAY4),\n\tIAVF_PTT(27, IP, IPV4, NOF, NONE, NONE, NOF, SCTP, PAY4),\n\tIAVF_PTT(28, IP, IPV4, NOF, NONE, NONE, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(29, IP, IPV4, NOF, IP_IP, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(30, IP, IPV4, NOF, IP_IP, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(31, IP, IPV4, NOF, IP_IP, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(32),\n\tIAVF_PTT(33, IP, IPV4, NOF, IP_IP, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(34, IP, IPV4, NOF, IP_IP, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(35, IP, IPV4, NOF, IP_IP, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(36, IP, IPV4, NOF, IP_IP, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(37, IP, IPV4, NOF, IP_IP, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(38, IP, IPV4, NOF, IP_IP, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(39),\n\tIAVF_PTT(40, IP, IPV4, NOF, IP_IP, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(41, IP, IPV4, NOF, IP_IP, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(42, IP, IPV4, NOF, IP_IP, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(43, IP, IPV4, NOF, IP_GRENAT, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(44, IP, IPV4, NOF, IP_GRENAT, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(45, IP, IPV4, NOF, IP_GRENAT, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(46, IP, IPV4, NOF, IP_GRENAT, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(47),\n\tIAVF_PTT(48, IP, IPV4, NOF, IP_GRENAT, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(49, IP, IPV4, NOF, IP_GRENAT, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(50, IP, IPV4, NOF, IP_GRENAT, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(51, IP, IPV4, NOF, IP_GRENAT, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(52, IP, IPV4, NOF, IP_GRENAT, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(53, IP, IPV4, NOF, IP_GRENAT, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(54),\n\tIAVF_PTT(55, IP, IPV4, NOF, IP_GRENAT, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(56, IP, IPV4, NOF, IP_GRENAT, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(57, IP, IPV4, NOF, IP_GRENAT, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(58, IP, IPV4, NOF, IP_GRENAT_MAC, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(59, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(60, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(61, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(62),\n\tIAVF_PTT(63, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(64, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(65, IP, IPV4, NOF, IP_GRENAT_MAC, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(66, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(67, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(68, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(69),\n\tIAVF_PTT(70, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(71, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(72, IP, IPV4, NOF, IP_GRENAT_MAC, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(73, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(74, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(75, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(76, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(77),\n\tIAVF_PTT(78, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(79, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(80, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(81, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(82, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(83, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(84),\n\tIAVF_PTT(85, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(86, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(87, IP, IPV4, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(88, IP, IPV6, FRG, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(89, IP, IPV6, NOF, NONE, NONE, NOF, NONE, PAY3),\n\tIAVF_PTT(90, IP, IPV6, NOF, NONE, NONE, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(91),\n\tIAVF_PTT(92, IP, IPV6, NOF, NONE, NONE, NOF, TCP,  PAY4),\n\tIAVF_PTT(93, IP, IPV6, NOF, NONE, NONE, NOF, SCTP, PAY4),\n\tIAVF_PTT(94, IP, IPV6, NOF, NONE, NONE, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(95,  IP, IPV6, NOF, IP_IP, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(96,  IP, IPV6, NOF, IP_IP, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(97,  IP, IPV6, NOF, IP_IP, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(98),\n\tIAVF_PTT(99,  IP, IPV6, NOF, IP_IP, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(100, IP, IPV6, NOF, IP_IP, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(101, IP, IPV6, NOF, IP_IP, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(102, IP, IPV6, NOF, IP_IP, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(103, IP, IPV6, NOF, IP_IP, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(104, IP, IPV6, NOF, IP_IP, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(105),\n\tIAVF_PTT(106, IP, IPV6, NOF, IP_IP, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(107, IP, IPV6, NOF, IP_IP, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(108, IP, IPV6, NOF, IP_IP, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(109, IP, IPV6, NOF, IP_GRENAT, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(110, IP, IPV6, NOF, IP_GRENAT, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(111, IP, IPV6, NOF, IP_GRENAT, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(112, IP, IPV6, NOF, IP_GRENAT, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(113),\n\tIAVF_PTT(114, IP, IPV6, NOF, IP_GRENAT, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(115, IP, IPV6, NOF, IP_GRENAT, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(116, IP, IPV6, NOF, IP_GRENAT, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(117, IP, IPV6, NOF, IP_GRENAT, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(118, IP, IPV6, NOF, IP_GRENAT, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(119, IP, IPV6, NOF, IP_GRENAT, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(120),\n\tIAVF_PTT(121, IP, IPV6, NOF, IP_GRENAT, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(122, IP, IPV6, NOF, IP_GRENAT, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(123, IP, IPV6, NOF, IP_GRENAT, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(124, IP, IPV6, NOF, IP_GRENAT_MAC, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(125, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(126, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(127, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(128),\n\tIAVF_PTT(129, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(130, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(131, IP, IPV6, NOF, IP_GRENAT_MAC, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(132, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(133, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(134, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(135),\n\tIAVF_PTT(136, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(137, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(138, IP, IPV6, NOF, IP_GRENAT_MAC, IPV6, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(139, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, NONE, NOF, NONE, PAY3),\n\n\t \n\tIAVF_PTT(140, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, FRG, NONE, PAY3),\n\tIAVF_PTT(141, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, NONE, PAY3),\n\tIAVF_PTT(142, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(143),\n\tIAVF_PTT(144, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, TCP,  PAY4),\n\tIAVF_PTT(145, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, SCTP, PAY4),\n\tIAVF_PTT(146, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV4, NOF, ICMP, PAY4),\n\n\t \n\tIAVF_PTT(147, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, FRG, NONE, PAY3),\n\tIAVF_PTT(148, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, NONE, PAY3),\n\tIAVF_PTT(149, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, UDP,  PAY4),\n\tIAVF_PTT_UNUSED_ENTRY(150),\n\tIAVF_PTT(151, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, TCP,  PAY4),\n\tIAVF_PTT(152, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, SCTP, PAY4),\n\tIAVF_PTT(153, IP, IPV6, NOF, IP_GRENAT_MAC_VLAN, IPV6, NOF, ICMP, PAY4),\n\n\t \n\t[154 ... 255] = { 0, 0, 0, 0, 0, 0, 0, 0, 0 }\n};\n\n \nenum iavf_status iavf_aq_send_msg_to_pf(struct iavf_hw *hw,\n\t\t\t\t\tenum virtchnl_ops v_opcode,\n\t\t\t\t\tenum iavf_status v_retval,\n\t\t\t\t\tu8 *msg, u16 msglen,\n\t\t\t\t\tstruct iavf_asq_cmd_details *cmd_details)\n{\n\tstruct iavf_asq_cmd_details details;\n\tstruct iavf_aq_desc desc;\n\tenum iavf_status status;\n\n\tiavf_fill_default_direct_cmd_desc(&desc, iavf_aqc_opc_send_msg_to_pf);\n\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_SI);\n\tdesc.cookie_high = cpu_to_le32(v_opcode);\n\tdesc.cookie_low = cpu_to_le32(v_retval);\n\tif (msglen) {\n\t\tdesc.flags |= cpu_to_le16((u16)(IAVF_AQ_FLAG_BUF\n\t\t\t\t\t\t| IAVF_AQ_FLAG_RD));\n\t\tif (msglen > IAVF_AQ_LARGE_BUF)\n\t\t\tdesc.flags |= cpu_to_le16((u16)IAVF_AQ_FLAG_LB);\n\t\tdesc.datalen = cpu_to_le16(msglen);\n\t}\n\tif (!cmd_details) {\n\t\tmemset(&details, 0, sizeof(details));\n\t\tdetails.async = true;\n\t\tcmd_details = &details;\n\t}\n\tstatus = iavf_asq_send_command(hw, &desc, msg, msglen, cmd_details);\n\treturn status;\n}\n\n \nvoid iavf_vf_parse_hw_config(struct iavf_hw *hw,\n\t\t\t     struct virtchnl_vf_resource *msg)\n{\n\tstruct virtchnl_vsi_resource *vsi_res;\n\tint i;\n\n\tvsi_res = &msg->vsi_res[0];\n\n\thw->dev_caps.num_vsis = msg->num_vsis;\n\thw->dev_caps.num_rx_qp = msg->num_queue_pairs;\n\thw->dev_caps.num_tx_qp = msg->num_queue_pairs;\n\thw->dev_caps.num_msix_vectors_vf = msg->max_vectors;\n\thw->dev_caps.dcb = msg->vf_cap_flags &\n\t\t\t   VIRTCHNL_VF_OFFLOAD_L2;\n\thw->dev_caps.fcoe = 0;\n\tfor (i = 0; i < msg->num_vsis; i++) {\n\t\tif (vsi_res->vsi_type == VIRTCHNL_VSI_SRIOV) {\n\t\t\tether_addr_copy(hw->mac.perm_addr,\n\t\t\t\t\tvsi_res->default_mac_addr);\n\t\t\tether_addr_copy(hw->mac.addr,\n\t\t\t\t\tvsi_res->default_mac_addr);\n\t\t}\n\t\tvsi_res++;\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}