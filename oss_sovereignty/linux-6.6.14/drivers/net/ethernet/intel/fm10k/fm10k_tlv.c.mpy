{
  "module_name": "fm10k_tlv.c",
  "hash_id": "29810891889f6786279af54ea04e2d0c3c0ef9eeaaad1083cd37f1d7677e3d41",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/fm10k/fm10k_tlv.c",
  "human_readable_source": "\n \n\n#include \"fm10k_tlv.h\"\n\n \ns32 fm10k_tlv_msg_init(u32 *msg, u16 msg_id)\n{\n\t \n\tif (!msg)\n\t\treturn FM10K_ERR_PARAM;\n\n\t*msg = (FM10K_TLV_FLAGS_MSG << FM10K_TLV_FLAGS_SHIFT) | msg_id;\n\n\treturn 0;\n}\n\n \nstatic s32 fm10k_tlv_attr_put_null_string(u32 *msg, u16 attr_id,\n\t\t\t\t\t  const unsigned char *string)\n{\n\tu32 attr_data = 0, len = 0;\n\tu32 *attr;\n\n\t \n\tif (!string || !msg)\n\t\treturn FM10K_ERR_PARAM;\n\n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\n\t \n\tdo {\n\t\t \n\t\tif (len && !(len % 4)) {\n\t\t\tattr[len / 4] = attr_data;\n\t\t\tattr_data = 0;\n\t\t}\n\n\t\t \n\t\tattr_data |= (u32)(*string) << (8 * (len % 4));\n\t\tlen++;\n\n\t\t \n\t} while (*(string++));\n\n\t \n\tattr[(len + 3) / 4] = attr_data;\n\n\t \n\tlen <<= FM10K_TLV_LEN_SHIFT;\n\tattr[0] = len | attr_id;\n\n\t \n\tlen += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\t*msg += FM10K_TLV_LEN_ALIGN(len);\n\n\treturn 0;\n}\n\n \nstatic s32 fm10k_tlv_attr_get_null_string(u32 *attr, unsigned char *string)\n{\n\tu32 len;\n\n\t \n\tif (!string || !attr)\n\t\treturn FM10K_ERR_PARAM;\n\n\tlen = *attr >> FM10K_TLV_LEN_SHIFT;\n\tattr++;\n\n\twhile (len--)\n\t\tstring[len] = (u8)(attr[len / 4] >> (8 * (len % 4)));\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_put_mac_vlan(u32 *msg, u16 attr_id,\n\t\t\t\tconst u8 *mac_addr, u16 vlan)\n{\n\tu32 len = ETH_ALEN << FM10K_TLV_LEN_SHIFT;\n\tu32 *attr;\n\n\t \n\tif (!msg || !mac_addr)\n\t\treturn FM10K_ERR_PARAM;\n\n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\n\t \n\tattr[0] = len | attr_id;\n\n\t \n\tattr[1] = le32_to_cpu(*(const __le32 *)&mac_addr[0]);\n\tattr[2] = le16_to_cpu(*(const __le16 *)&mac_addr[4]);\n\tattr[2] |= (u32)vlan << 16;\n\n\t \n\tlen += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\t*msg += FM10K_TLV_LEN_ALIGN(len);\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_get_mac_vlan(u32 *attr, u8 *mac_addr, u16 *vlan)\n{\n\t \n\tif (!mac_addr || !attr)\n\t\treturn FM10K_ERR_PARAM;\n\n\t*(__le32 *)&mac_addr[0] = cpu_to_le32(attr[1]);\n\t*(__le16 *)&mac_addr[4] = cpu_to_le16((u16)(attr[2]));\n\t*vlan = (u16)(attr[2] >> 16);\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_put_bool(u32 *msg, u16 attr_id)\n{\n\t \n\tif (!msg)\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\tmsg[FM10K_TLV_DWORD_LEN(*msg)] = attr_id;\n\n\t \n\t*msg += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_put_value(u32 *msg, u16 attr_id, s64 value, u32 len)\n{\n\tu32 *attr;\n\n\t \n\tif (!msg || !len || len > 8 || (len & (len - 1)))\n\t\treturn FM10K_ERR_PARAM;\n\n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\n\tif (len < 4) {\n\t\tattr[1] = (u32)value & (BIT(8 * len) - 1);\n\t} else {\n\t\tattr[1] = (u32)value;\n\t\tif (len > 4)\n\t\t\tattr[2] = (u32)(value >> 32);\n\t}\n\n\t \n\tlen <<= FM10K_TLV_LEN_SHIFT;\n\tattr[0] = len | attr_id;\n\n\t \n\tlen += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\t*msg += FM10K_TLV_LEN_ALIGN(len);\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_get_value(u32 *attr, void *value, u32 len)\n{\n\t \n\tif (!attr || !value)\n\t\treturn FM10K_ERR_PARAM;\n\n\tif ((*attr >> FM10K_TLV_LEN_SHIFT) != len)\n\t\treturn FM10K_ERR_PARAM;\n\n\tif (len == 8)\n\t\t*(u64 *)value = ((u64)attr[2] << 32) | attr[1];\n\telse if (len == 4)\n\t\t*(u32 *)value = attr[1];\n\telse if (len == 2)\n\t\t*(u16 *)value = (u16)attr[1];\n\telse\n\t\t*(u8 *)value = (u8)attr[1];\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_put_le_struct(u32 *msg, u16 attr_id,\n\t\t\t\t const void *le_struct, u32 len)\n{\n\tconst __le32 *le32_ptr = (const __le32 *)le_struct;\n\tu32 *attr;\n\tu32 i;\n\n\t \n\tif (!msg || !len || (len % 4))\n\t\treturn FM10K_ERR_PARAM;\n\n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\n\t \n\tfor (i = 0; i < (len / 4); i++)\n\t\tattr[i + 1] = le32_to_cpu(le32_ptr[i]);\n\n\t \n\tlen <<= FM10K_TLV_LEN_SHIFT;\n\tattr[0] = len | attr_id;\n\n\t \n\tlen += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\t*msg += FM10K_TLV_LEN_ALIGN(len);\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_attr_get_le_struct(u32 *attr, void *le_struct, u32 len)\n{\n\t__le32 *le32_ptr = (__le32 *)le_struct;\n\tu32 i;\n\n\t \n\tif (!le_struct || !attr)\n\t\treturn FM10K_ERR_PARAM;\n\n\tif ((*attr >> FM10K_TLV_LEN_SHIFT) != len)\n\t\treturn FM10K_ERR_PARAM;\n\n\tattr++;\n\n\tfor (i = 0; len; i++, len -= 4)\n\t\tle32_ptr[i] = cpu_to_le32(attr[i]);\n\n\treturn 0;\n}\n\n \nstatic u32 *fm10k_tlv_attr_nest_start(u32 *msg, u16 attr_id)\n{\n\tu32 *attr;\n\n\t \n\tif (!msg)\n\t\treturn NULL;\n\n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\n\tattr[0] = attr_id;\n\n\t \n\treturn attr;\n}\n\n \nstatic s32 fm10k_tlv_attr_nest_stop(u32 *msg)\n{\n\tu32 *attr;\n\tu32 len;\n\n\t \n\tif (!msg)\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\tattr = &msg[FM10K_TLV_DWORD_LEN(*msg)];\n\tlen = (attr[0] >> FM10K_TLV_LEN_SHIFT) << FM10K_TLV_LEN_SHIFT;\n\n\t \n\tif (len) {\n\t\tlen += FM10K_TLV_HDR_LEN << FM10K_TLV_LEN_SHIFT;\n\t\t*msg += len;\n\t}\n\n\treturn 0;\n}\n\n \nstatic s32 fm10k_tlv_attr_validate(u32 *attr,\n\t\t\t\t   const struct fm10k_tlv_attr *tlv_attr)\n{\n\tu32 attr_id = *attr & FM10K_TLV_ID_MASK;\n\tu16 len = *attr >> FM10K_TLV_LEN_SHIFT;\n\n\t \n\tif (*attr & (FM10K_TLV_FLAGS_MSG << FM10K_TLV_FLAGS_SHIFT))\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\twhile (tlv_attr->id < attr_id)\n\t\ttlv_attr++;\n\n\t \n\tif (tlv_attr->id != attr_id)\n\t\treturn FM10K_NOT_IMPLEMENTED;\n\n\t \n\tattr++;\n\n\tswitch (tlv_attr->type) {\n\tcase FM10K_TLV_NULL_STRING:\n\t\tif (!len ||\n\t\t    (attr[(len - 1) / 4] & (0xFF << (8 * ((len - 1) % 4)))))\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tif (len > tlv_attr->len)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tcase FM10K_TLV_MAC_ADDR:\n\t\tif (len != ETH_ALEN)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tcase FM10K_TLV_BOOL:\n\t\tif (len)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tcase FM10K_TLV_UNSIGNED:\n\tcase FM10K_TLV_SIGNED:\n\t\tif (len != tlv_attr->len)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tcase FM10K_TLV_LE_STRUCT:\n\t\t \n\t\tif ((len % 4) || len != tlv_attr->len)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tcase FM10K_TLV_NESTED:\n\t\t \n\t\tif (len % 4)\n\t\t\treturn FM10K_ERR_PARAM;\n\t\tbreak;\n\tdefault:\n\t\t \n\t\treturn FM10K_ERR_PARAM;\n\t}\n\n\treturn 0;\n}\n\n \nstatic s32 fm10k_tlv_attr_parse(u32 *attr, u32 **results,\n\t\t\t\tconst struct fm10k_tlv_attr *tlv_attr)\n{\n\tu32 i, attr_id, offset = 0;\n\ts32 err;\n\tu16 len;\n\n\t \n\tif (!attr || !results)\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\tfor (i = 0; i < FM10K_TLV_RESULTS_MAX; i++)\n\t\tresults[i] = NULL;\n\n\t \n\tlen = *attr >> FM10K_TLV_LEN_SHIFT;\n\n\t \n\tif (!len)\n\t\treturn 0;\n\n\t \n\tif (!tlv_attr) {\n\t\tresults[0] = attr;\n\t\treturn 0;\n\t}\n\n\t \n\tattr++;\n\n\t \n\twhile (offset < len) {\n\t\tattr_id = *attr & FM10K_TLV_ID_MASK;\n\n\t\tif (attr_id >= FM10K_TLV_RESULTS_MAX)\n\t\t\treturn FM10K_NOT_IMPLEMENTED;\n\n\t\terr = fm10k_tlv_attr_validate(attr, tlv_attr);\n\t\tif (err == FM10K_NOT_IMPLEMENTED)\n\t\t\t;  \n\t\telse if (err)\n\t\t\treturn err;\n\t\telse\n\t\t\tresults[attr_id] = attr;\n\n\t\t \n\t\toffset += FM10K_TLV_DWORD_LEN(*attr) * 4;\n\n\t\t \n\t\tattr = &attr[FM10K_TLV_DWORD_LEN(*attr)];\n\t}\n\n\t \n\tif (offset != len)\n\t\treturn FM10K_ERR_PARAM;\n\n\treturn 0;\n}\n\n \ns32 fm10k_tlv_msg_parse(struct fm10k_hw *hw, u32 *msg,\n\t\t\tstruct fm10k_mbx_info *mbx,\n\t\t\tconst struct fm10k_msg_data *data)\n{\n\tu32 *results[FM10K_TLV_RESULTS_MAX];\n\tu32 msg_id;\n\ts32 err;\n\n\t \n\tif (!msg || !data)\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\tif (!(*msg & (FM10K_TLV_FLAGS_MSG << FM10K_TLV_FLAGS_SHIFT)))\n\t\treturn FM10K_ERR_PARAM;\n\n\t \n\tmsg_id = *msg & FM10K_TLV_ID_MASK;\n\n\twhile (data->id < msg_id)\n\t\tdata++;\n\n\t \n\tif (data->id != msg_id) {\n\t\twhile (data->id != FM10K_TLV_ERROR)\n\t\t\tdata++;\n\t}\n\n\t \n\terr = fm10k_tlv_attr_parse(msg, results, data->attr);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn data->func(hw, results, mbx);\n}\n\n \ns32 fm10k_tlv_msg_error(struct fm10k_hw __always_unused *hw,\n\t\t\tu32 __always_unused **results,\n\t\t\tstruct fm10k_mbx_info __always_unused *mbx)\n{\n\treturn FM10K_NOT_IMPLEMENTED;\n}\n\nstatic const unsigned char test_str[] =\t\"fm10k\";\nstatic const unsigned char test_mac[ETH_ALEN] = { 0x12, 0x34, 0x56,\n\t\t\t\t\t\t  0x78, 0x9a, 0xbc };\nstatic const u16 test_vlan = 0x0FED;\nstatic const u64 test_u64 = 0xfedcba9876543210ull;\nstatic const u32 test_u32 = 0x87654321;\nstatic const u16 test_u16 = 0x8765;\nstatic const u8  test_u8  = 0x87;\nstatic const s64 test_s64 = -0x123456789abcdef0ll;\nstatic const s32 test_s32 = -0x1235678;\nstatic const s16 test_s16 = -0x1234;\nstatic const s8  test_s8  = -0x12;\nstatic const __le32 test_le[2] = { cpu_to_le32(0x12345678),\n\t\t\t\t   cpu_to_le32(0x9abcdef0)};\n\n \nconst struct fm10k_tlv_attr fm10k_tlv_msg_test_attr[] = {\n\tFM10K_TLV_ATTR_NULL_STRING(FM10K_TEST_MSG_STRING, 80),\n\tFM10K_TLV_ATTR_MAC_ADDR(FM10K_TEST_MSG_MAC_ADDR),\n\tFM10K_TLV_ATTR_U8(FM10K_TEST_MSG_U8),\n\tFM10K_TLV_ATTR_U16(FM10K_TEST_MSG_U16),\n\tFM10K_TLV_ATTR_U32(FM10K_TEST_MSG_U32),\n\tFM10K_TLV_ATTR_U64(FM10K_TEST_MSG_U64),\n\tFM10K_TLV_ATTR_S8(FM10K_TEST_MSG_S8),\n\tFM10K_TLV_ATTR_S16(FM10K_TEST_MSG_S16),\n\tFM10K_TLV_ATTR_S32(FM10K_TEST_MSG_S32),\n\tFM10K_TLV_ATTR_S64(FM10K_TEST_MSG_S64),\n\tFM10K_TLV_ATTR_LE_STRUCT(FM10K_TEST_MSG_LE_STRUCT, 8),\n\tFM10K_TLV_ATTR_NESTED(FM10K_TEST_MSG_NESTED),\n\tFM10K_TLV_ATTR_S32(FM10K_TEST_MSG_RESULT),\n\tFM10K_TLV_ATTR_LAST\n};\n\n \nstatic void fm10k_tlv_msg_test_generate_data(u32 *msg, u32 attr_flags)\n{\n\tif (attr_flags & BIT(FM10K_TEST_MSG_STRING))\n\t\tfm10k_tlv_attr_put_null_string(msg, FM10K_TEST_MSG_STRING,\n\t\t\t\t\t       test_str);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_MAC_ADDR))\n\t\tfm10k_tlv_attr_put_mac_vlan(msg, FM10K_TEST_MSG_MAC_ADDR,\n\t\t\t\t\t    test_mac, test_vlan);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_U8))\n\t\tfm10k_tlv_attr_put_u8(msg, FM10K_TEST_MSG_U8,  test_u8);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_U16))\n\t\tfm10k_tlv_attr_put_u16(msg, FM10K_TEST_MSG_U16, test_u16);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_U32))\n\t\tfm10k_tlv_attr_put_u32(msg, FM10K_TEST_MSG_U32, test_u32);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_U64))\n\t\tfm10k_tlv_attr_put_u64(msg, FM10K_TEST_MSG_U64, test_u64);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_S8))\n\t\tfm10k_tlv_attr_put_s8(msg, FM10K_TEST_MSG_S8,  test_s8);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_S16))\n\t\tfm10k_tlv_attr_put_s16(msg, FM10K_TEST_MSG_S16, test_s16);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_S32))\n\t\tfm10k_tlv_attr_put_s32(msg, FM10K_TEST_MSG_S32, test_s32);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_S64))\n\t\tfm10k_tlv_attr_put_s64(msg, FM10K_TEST_MSG_S64, test_s64);\n\tif (attr_flags & BIT(FM10K_TEST_MSG_LE_STRUCT))\n\t\tfm10k_tlv_attr_put_le_struct(msg, FM10K_TEST_MSG_LE_STRUCT,\n\t\t\t\t\t     test_le, 8);\n}\n\n \nvoid fm10k_tlv_msg_test_create(u32 *msg, u32 attr_flags)\n{\n\tu32 *nest = NULL;\n\n\tfm10k_tlv_msg_init(msg, FM10K_TLV_MSG_ID_TEST);\n\n\tfm10k_tlv_msg_test_generate_data(msg, attr_flags);\n\n\t \n\tattr_flags >>= FM10K_TEST_MSG_NESTED;\n\n\tif (attr_flags) {\n\t\tnest = fm10k_tlv_attr_nest_start(msg, FM10K_TEST_MSG_NESTED);\n\n\t\tfm10k_tlv_msg_test_generate_data(nest, attr_flags);\n\n\t\tfm10k_tlv_attr_nest_stop(msg);\n\t}\n}\n\n \ns32 fm10k_tlv_msg_test(struct fm10k_hw *hw, u32 **results,\n\t\t       struct fm10k_mbx_info *mbx)\n{\n\tu32 *nest_results[FM10K_TLV_RESULTS_MAX];\n\tunsigned char result_str[80];\n\tunsigned char result_mac[ETH_ALEN];\n\ts32 err = 0;\n\t__le32 result_le[2];\n\tu16 result_vlan;\n\tu64 result_u64;\n\tu32 result_u32;\n\tu16 result_u16;\n\tu8  result_u8;\n\ts64 result_s64;\n\ts32 result_s32;\n\ts16 result_s16;\n\ts8  result_s8;\n\tu32 reply[3];\n\n\t \n\tif (!!results[FM10K_TEST_MSG_RESULT])\n\t\treturn fm10k_tlv_attr_get_s32(results[FM10K_TEST_MSG_RESULT],\n\t\t\t\t\t      &mbx->test_result);\n\nparse_nested:\n\tif (!!results[FM10K_TEST_MSG_STRING]) {\n\t\terr = fm10k_tlv_attr_get_null_string(\n\t\t\t\t\tresults[FM10K_TEST_MSG_STRING],\n\t\t\t\t\tresult_str);\n\t\tif (!err && memcmp(test_str, result_str, sizeof(test_str)))\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_MAC_ADDR]) {\n\t\terr = fm10k_tlv_attr_get_mac_vlan(\n\t\t\t\t\tresults[FM10K_TEST_MSG_MAC_ADDR],\n\t\t\t\t\tresult_mac, &result_vlan);\n\t\tif (!err && !ether_addr_equal(test_mac, result_mac))\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (!err && test_vlan != result_vlan)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_U8]) {\n\t\terr = fm10k_tlv_attr_get_u8(results[FM10K_TEST_MSG_U8],\n\t\t\t\t\t    &result_u8);\n\t\tif (!err && test_u8 != result_u8)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_U16]) {\n\t\terr = fm10k_tlv_attr_get_u16(results[FM10K_TEST_MSG_U16],\n\t\t\t\t\t     &result_u16);\n\t\tif (!err && test_u16 != result_u16)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_U32]) {\n\t\terr = fm10k_tlv_attr_get_u32(results[FM10K_TEST_MSG_U32],\n\t\t\t\t\t     &result_u32);\n\t\tif (!err && test_u32 != result_u32)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_U64]) {\n\t\terr = fm10k_tlv_attr_get_u64(results[FM10K_TEST_MSG_U64],\n\t\t\t\t\t     &result_u64);\n\t\tif (!err && test_u64 != result_u64)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_S8]) {\n\t\terr = fm10k_tlv_attr_get_s8(results[FM10K_TEST_MSG_S8],\n\t\t\t\t\t    &result_s8);\n\t\tif (!err && test_s8 != result_s8)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_S16]) {\n\t\terr = fm10k_tlv_attr_get_s16(results[FM10K_TEST_MSG_S16],\n\t\t\t\t\t     &result_s16);\n\t\tif (!err && test_s16 != result_s16)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_S32]) {\n\t\terr = fm10k_tlv_attr_get_s32(results[FM10K_TEST_MSG_S32],\n\t\t\t\t\t     &result_s32);\n\t\tif (!err && test_s32 != result_s32)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_S64]) {\n\t\terr = fm10k_tlv_attr_get_s64(results[FM10K_TEST_MSG_S64],\n\t\t\t\t\t     &result_s64);\n\t\tif (!err && test_s64 != result_s64)\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\tif (!!results[FM10K_TEST_MSG_LE_STRUCT]) {\n\t\terr = fm10k_tlv_attr_get_le_struct(\n\t\t\t\t\tresults[FM10K_TEST_MSG_LE_STRUCT],\n\t\t\t\t\tresult_le,\n\t\t\t\t\tsizeof(result_le));\n\t\tif (!err && memcmp(test_le, result_le, sizeof(test_le)))\n\t\t\terr = FM10K_ERR_INVALID_VALUE;\n\t\tif (err)\n\t\t\tgoto report_result;\n\t}\n\n\tif (!!results[FM10K_TEST_MSG_NESTED]) {\n\t\t \n\t\tmemset(nest_results, 0, sizeof(nest_results));\n\n\t\t \n\t\terr = fm10k_tlv_attr_parse(results[FM10K_TEST_MSG_NESTED],\n\t\t\t\t\t   nest_results,\n\t\t\t\t\t   fm10k_tlv_msg_test_attr);\n\t\tif (err)\n\t\t\tgoto report_result;\n\n\t\t \n\t\tresults = nest_results;\n\t\tgoto parse_nested;\n\t}\n\nreport_result:\n\t \n\tfm10k_tlv_msg_init(reply, FM10K_TLV_MSG_ID_TEST);\n\tfm10k_tlv_attr_put_s32(reply, FM10K_TEST_MSG_RESULT, err);\n\n\t \n\treturn mbx->ops.enqueue_tx(hw, mbx, reply);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}