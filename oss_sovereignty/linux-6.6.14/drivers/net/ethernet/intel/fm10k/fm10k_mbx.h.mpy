{
  "module_name": "fm10k_mbx.h",
  "hash_id": "0ea3e8903fee6b10180b74da7a5f37edd84c4612f8b7fad736786ffc31974abb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/fm10k/fm10k_mbx.h",
  "human_readable_source": " \n \n\n#ifndef _FM10K_MBX_H_\n#define _FM10K_MBX_H_\n\n \nstruct fm10k_mbx_info;\n\n#include \"fm10k_type.h\"\n#include \"fm10k_tlv.h\"\n\n \n#define FM10K_MBMEM(_n)\t\t((_n) + 0x18000)\n#define FM10K_MBMEM_VF(_n, _m)\t(((_n) * 0x10) + (_m) + 0x18000)\n#define FM10K_MBMEM_SM(_n)\t((_n) + 0x18400)\n#define FM10K_MBMEM_PF(_n)\t((_n) + 0x18600)\n \n#define FM10K_MBMEM_PF_XOR\t(FM10K_MBMEM_SM(0) ^ FM10K_MBMEM_PF(0))\n#define FM10K_MBX(_n)\t\t((_n) + 0x18800)\n#define FM10K_MBX_REQ\t\t\t\t0x00000002\n#define FM10K_MBX_ACK\t\t\t\t0x00000004\n#define FM10K_MBX_REQ_INTERRUPT\t\t\t0x00000008\n#define FM10K_MBX_ACK_INTERRUPT\t\t\t0x00000010\n#define FM10K_MBX_INTERRUPT_ENABLE\t\t0x00000020\n#define FM10K_MBX_INTERRUPT_DISABLE\t\t0x00000040\n#define FM10K_MBX_GLOBAL_REQ_INTERRUPT\t\t0x00000200\n#define FM10K_MBX_GLOBAL_ACK_INTERRUPT\t\t0x00000400\n#define FM10K_MBICR(_n)\t\t((_n) + 0x18840)\n#define FM10K_GMBX\t\t0x18842\n\n \n#define FM10K_VFMBX\t\t0x00010\n#define FM10K_VFMBMEM(_n)\t((_n) + 0x00020)\n#define FM10K_VFMBMEM_LEN\t16\n#define FM10K_VFMBMEM_VF_XOR\t(FM10K_VFMBMEM_LEN / 2)\n\n \n#define FM10K_MBX_DISCONNECT_TIMEOUT\t\t500\n#define FM10K_MBX_POLL_DELAY\t\t\t19\n#define FM10K_MBX_INT_DELAY\t\t\t20\n\n \nenum fm10k_mbx_state {\n\tFM10K_STATE_CLOSED,\n\tFM10K_STATE_CONNECT,\n\tFM10K_STATE_OPEN,\n\tFM10K_STATE_DISCONNECT,\n};\n\n \n\n \n#define FM10K_MSG_HDR_MASK(name) \\\n\t((0x1u << FM10K_MSG_##name##_SIZE) - 1)\n#define FM10K_MSG_HDR_FIELD_SET(value, name) \\\n\t(((u32)(value) & FM10K_MSG_HDR_MASK(name)) << FM10K_MSG_##name##_SHIFT)\n#define FM10K_MSG_HDR_FIELD_GET(value, name) \\\n\t((u16)((value) >> FM10K_MSG_##name##_SHIFT) & FM10K_MSG_HDR_MASK(name))\n\n \n#define FM10K_MSG_TYPE_SHIFT\t\t\t0\n#define FM10K_MSG_TYPE_SIZE\t\t\t4\n#define FM10K_MSG_TAIL_SHIFT\t\t\t4\n#define FM10K_MSG_TAIL_SIZE\t\t\t4\n#define FM10K_MSG_HEAD_SHIFT\t\t\t8\n#define FM10K_MSG_HEAD_SIZE\t\t\t4\n#define FM10K_MSG_RSVD0_SHIFT\t\t\t12\n#define FM10K_MSG_RSVD0_SIZE\t\t\t4\n\n \n#define FM10K_MSG_CRC_SHIFT\t\t\t16\n#define FM10K_MSG_CRC_SIZE\t\t\t16\n\n \n#define FM10K_MSG_CONNECT_SIZE_SHIFT\t\t16\n#define FM10K_MSG_CONNECT_SIZE_SIZE\t\t16\n\n \n#define FM10K_MSG_ERR_NO_SHIFT\t\t\t16\n#define FM10K_MSG_ERR_NO_SIZE\t\t\t16\n\nenum fm10k_msg_type {\n\tFM10K_MSG_DATA\t\t\t= 0x8,\n\tFM10K_MSG_CONNECT\t\t= 0xC,\n\tFM10K_MSG_DISCONNECT\t\t= 0xD,\n\tFM10K_MSG_ERROR\t\t\t= 0xE,\n};\n\n \n\n \n#define FM10K_SM_MBX_VERSION\t\t1\n#define FM10K_SM_MBX_FIFO_LEN\t\t(FM10K_MBMEM_PF_XOR - 1)\n\n \n#define FM10K_MSG_SM_TAIL_SHIFT\t\t\t0\n#define FM10K_MSG_SM_TAIL_SIZE\t\t\t12\n#define FM10K_MSG_SM_VER_SHIFT\t\t\t12\n#define FM10K_MSG_SM_VER_SIZE\t\t\t4\n#define FM10K_MSG_SM_HEAD_SHIFT\t\t\t16\n#define FM10K_MSG_SM_HEAD_SIZE\t\t\t12\n#define FM10K_MSG_SM_ERR_SHIFT\t\t\t28\n#define FM10K_MSG_SM_ERR_SIZE\t\t\t4\n\n \n#define FM10K_MBX_ERR(_n) ((_n) - 512)\n#define FM10K_MBX_ERR_NO_MBX\t\tFM10K_MBX_ERR(0x01)\n#define FM10K_MBX_ERR_NO_SPACE\t\tFM10K_MBX_ERR(0x03)\n#define FM10K_MBX_ERR_TAIL\t\tFM10K_MBX_ERR(0x05)\n#define FM10K_MBX_ERR_HEAD\t\tFM10K_MBX_ERR(0x06)\n#define FM10K_MBX_ERR_SRC\t\tFM10K_MBX_ERR(0x08)\n#define FM10K_MBX_ERR_TYPE\t\tFM10K_MBX_ERR(0x09)\n#define FM10K_MBX_ERR_SIZE\t\tFM10K_MBX_ERR(0x0B)\n#define FM10K_MBX_ERR_BUSY\t\tFM10K_MBX_ERR(0x0C)\n#define FM10K_MBX_ERR_RSVD0\t\tFM10K_MBX_ERR(0x0E)\n#define FM10K_MBX_ERR_CRC\t\tFM10K_MBX_ERR(0x0F)\n\n#define FM10K_MBX_CRC_SEED\t\t0xFFFF\n\nstruct fm10k_mbx_ops {\n\ts32 (*connect)(struct fm10k_hw *, struct fm10k_mbx_info *);\n\tvoid (*disconnect)(struct fm10k_hw *, struct fm10k_mbx_info *);\n\tbool (*rx_ready)(struct fm10k_mbx_info *);\n\tbool (*tx_ready)(struct fm10k_mbx_info *, u16);\n\tbool (*tx_complete)(struct fm10k_mbx_info *);\n\ts32 (*enqueue_tx)(struct fm10k_hw *, struct fm10k_mbx_info *,\n\t\t\t  const u32 *);\n\ts32 (*process)(struct fm10k_hw *, struct fm10k_mbx_info *);\n\ts32 (*register_handlers)(struct fm10k_mbx_info *,\n\t\t\t\t const struct fm10k_msg_data *);\n};\n\nstruct fm10k_mbx_fifo {\n\tu32 *buffer;\n\tu16 head;\n\tu16 tail;\n\tu16 size;\n};\n\n \n#define FM10K_MBX_TX_BUFFER_SIZE\t512\n#define FM10K_MBX_RX_BUFFER_SIZE\t128\n#define FM10K_MBX_BUFFER_SIZE \\\n\t(FM10K_MBX_TX_BUFFER_SIZE + FM10K_MBX_RX_BUFFER_SIZE)\n\n \n#define FM10K_MBX_MSG_MAX_SIZE \\\n\t((FM10K_MBX_TX_BUFFER_SIZE - 1) & (FM10K_MBX_RX_BUFFER_SIZE - 1))\n#define FM10K_VFMBX_MSG_MTU\t((FM10K_VFMBMEM_LEN / 2) - 1)\n\n#define FM10K_MBX_INIT_TIMEOUT\t2000  \n#define FM10K_MBX_INIT_DELAY\t500   \n\nstruct fm10k_mbx_info {\n\t \n\tstruct fm10k_mbx_ops ops;\n\tconst struct fm10k_msg_data *msg_data;\n\n\t \n\tstruct fm10k_mbx_fifo rx;\n\tstruct fm10k_mbx_fifo tx;\n\n\t \n\tu32 timeout;\n\tu32 udelay;\n\n\t \n\tu32 mbx_reg, mbmem_reg, mbx_lock, mbx_hdr;\n\tu16 max_size, mbmem_len;\n\tu16 tail, tail_len, pulled;\n\tu16 head, head_len, pushed;\n\tu16 local, remote;\n\tenum fm10k_mbx_state state;\n\n\t \n\ts32 test_result;\n\n\t \n\tu64 tx_busy;\n\tu64 tx_dropped;\n\tu64 tx_messages;\n\tu64 tx_dwords;\n\tu64 tx_mbmem_pulled;\n\tu64 rx_messages;\n\tu64 rx_dwords;\n\tu64 rx_mbmem_pushed;\n\tu64 rx_parse_err;\n\n\t \n\tu32 buffer[FM10K_MBX_BUFFER_SIZE];\n};\n\ns32 fm10k_pfvf_mbx_init(struct fm10k_hw *, struct fm10k_mbx_info *,\n\t\t\tconst struct fm10k_msg_data *, u8);\ns32 fm10k_sm_mbx_init(struct fm10k_hw *, struct fm10k_mbx_info *,\n\t\t      const struct fm10k_msg_data *);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}