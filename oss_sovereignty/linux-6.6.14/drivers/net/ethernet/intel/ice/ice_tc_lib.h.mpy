{
  "module_name": "ice_tc_lib.h",
  "hash_id": "01a8f23980727320f60f220d5bfb0b7f957459ed2e145c6f3852e34a96d9399a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/ice/ice_tc_lib.h",
  "human_readable_source": " \n \n\n#ifndef _ICE_TC_LIB_H_\n#define _ICE_TC_LIB_H_\n\n#define ICE_TC_FLWR_FIELD_DST_MAC\t\tBIT(0)\n#define ICE_TC_FLWR_FIELD_SRC_MAC\t\tBIT(1)\n#define ICE_TC_FLWR_FIELD_VLAN\t\t\tBIT(2)\n#define ICE_TC_FLWR_FIELD_DEST_IPV4\t\tBIT(3)\n#define ICE_TC_FLWR_FIELD_SRC_IPV4\t\tBIT(4)\n#define ICE_TC_FLWR_FIELD_DEST_IPV6\t\tBIT(5)\n#define ICE_TC_FLWR_FIELD_SRC_IPV6\t\tBIT(6)\n#define ICE_TC_FLWR_FIELD_DEST_L4_PORT\t\tBIT(7)\n#define ICE_TC_FLWR_FIELD_SRC_L4_PORT\t\tBIT(8)\n#define ICE_TC_FLWR_FIELD_TENANT_ID\t\tBIT(9)\n#define ICE_TC_FLWR_FIELD_ENC_DEST_IPV4\t\tBIT(10)\n#define ICE_TC_FLWR_FIELD_ENC_SRC_IPV4\t\tBIT(11)\n#define ICE_TC_FLWR_FIELD_ENC_DEST_IPV6\t\tBIT(12)\n#define ICE_TC_FLWR_FIELD_ENC_SRC_IPV6\t\tBIT(13)\n#define ICE_TC_FLWR_FIELD_ENC_DEST_L4_PORT\tBIT(14)\n#define ICE_TC_FLWR_FIELD_ENC_SRC_L4_PORT\tBIT(15)\n#define ICE_TC_FLWR_FIELD_ENC_DST_MAC\t\tBIT(16)\n#define ICE_TC_FLWR_FIELD_ETH_TYPE_ID\t\tBIT(17)\n#define ICE_TC_FLWR_FIELD_ENC_OPTS\t\tBIT(18)\n#define ICE_TC_FLWR_FIELD_CVLAN\t\t\tBIT(19)\n#define ICE_TC_FLWR_FIELD_PPPOE_SESSID\t\tBIT(20)\n#define ICE_TC_FLWR_FIELD_PPP_PROTO\t\tBIT(21)\n#define ICE_TC_FLWR_FIELD_IP_TOS\t\tBIT(22)\n#define ICE_TC_FLWR_FIELD_IP_TTL\t\tBIT(23)\n#define ICE_TC_FLWR_FIELD_ENC_IP_TOS\t\tBIT(24)\n#define ICE_TC_FLWR_FIELD_ENC_IP_TTL\t\tBIT(25)\n#define ICE_TC_FLWR_FIELD_L2TPV3_SESSID\t\tBIT(26)\n#define ICE_TC_FLWR_FIELD_VLAN_PRIO\t\tBIT(27)\n#define ICE_TC_FLWR_FIELD_CVLAN_PRIO\t\tBIT(28)\n#define ICE_TC_FLWR_FIELD_VLAN_TPID\t\tBIT(29)\n\n#define ICE_TC_FLOWER_MASK_32   0xFFFFFFFF\n\n#define ICE_IPV6_HDR_TC_MASK 0xFF00000\n\nstruct ice_indr_block_priv {\n\tstruct net_device *netdev;\n\tstruct ice_netdev_priv *np;\n\tstruct list_head list;\n};\n\nstruct ice_tc_flower_action {\n\t \n\tunion {\n\t\tstruct {\n\t\t\tu32 tc_class;  \n\t\t\tu32 rsvd;\n\t\t} tc;\n\t\tstruct {\n\t\t\tu16 queue;  \n\t\t\t \n\t\t\tu16 hw_queue;\n\t\t} q;\n\t} fwd;\n\tenum ice_sw_fwd_act_type fltr_act;\n};\n\nstruct ice_tc_vlan_hdr {\n\t__be16 vlan_id;  \n\t__be16 vlan_prio;  \n\t__be16 vlan_tpid;\n};\n\nstruct ice_tc_pppoe_hdr {\n\t__be16 session_id;\n\t__be16 ppp_proto;\n};\n\nstruct ice_tc_l2_hdr {\n\tu8 dst_mac[ETH_ALEN];\n\tu8 src_mac[ETH_ALEN];\n\t__be16 n_proto;     \n};\n\nstruct ice_tc_l3_hdr {\n\tu8 ip_proto;     \n\tunion {\n\t\tstruct {\n\t\t\tstruct in_addr dst_ip;\n\t\t\tstruct in_addr src_ip;\n\t\t} v4;\n\t\tstruct {\n\t\t\tstruct in6_addr dst_ip6;\n\t\t\tstruct in6_addr src_ip6;\n\t\t} v6;\n\t} ip;\n#define dst_ipv6\tip.v6.dst_ip6.s6_addr32\n#define dst_ipv6_addr\tip.v6.dst_ip6.s6_addr\n#define src_ipv6\tip.v6.src_ip6.s6_addr32\n#define src_ipv6_addr\tip.v6.src_ip6.s6_addr\n#define dst_ipv4\tip.v4.dst_ip.s_addr\n#define src_ipv4\tip.v4.src_ip.s_addr\n\n\tu8 tos;\n\tu8 ttl;\n};\n\nstruct ice_tc_l2tpv3_hdr {\n\t__be32 session_id;\n};\n\nstruct ice_tc_l4_hdr {\n\t__be16 dst_port;\n\t__be16 src_port;\n};\n\nstruct ice_tc_flower_lyr_2_4_hdrs {\n\t \n\tstruct ice_tc_l2_hdr l2_key;\n\tstruct ice_tc_l2_hdr l2_mask;\n\tstruct ice_tc_vlan_hdr vlan_hdr;\n\tstruct ice_tc_vlan_hdr cvlan_hdr;\n\tstruct ice_tc_pppoe_hdr pppoe_hdr;\n\tstruct ice_tc_l2tpv3_hdr l2tpv3_hdr;\n\t \n\tstruct ice_tc_l3_hdr l3_key;\n\tstruct ice_tc_l3_hdr l3_mask;\n\n\t \n\tstruct ice_tc_l4_hdr l4_key;\n\tstruct ice_tc_l4_hdr l4_mask;\n};\n\nenum ice_eswitch_fltr_direction {\n\tICE_ESWITCH_FLTR_INGRESS,\n\tICE_ESWITCH_FLTR_EGRESS,\n};\n\nstruct ice_tc_flower_fltr {\n\tstruct hlist_node tc_flower_node;\n\n\t \n\tunsigned long cookie;\n\n\t \n\tu16 rid;\n\tu16 rule_id;\n\t \n\tu16 dest_vsi_handle;\n\t \n\tstruct ice_vsi *dest_vsi;\n\t \n\tenum ice_eswitch_fltr_direction direction;\n\n\t \n\tstruct ice_tc_flower_lyr_2_4_hdrs outer_headers;\n\tstruct ice_tc_flower_lyr_2_4_hdrs inner_headers;\n\tstruct ice_vsi *src_vsi;\n\t__be32 tenant_id;\n\tstruct gtp_pdu_session_info gtp_pdu_info_keys;\n\tstruct gtp_pdu_session_info gtp_pdu_info_masks;\n\tu32 flags;\n\tu8 tunnel_type;\n\tstruct ice_tc_flower_action\taction;\n\n\t \n\tstruct netlink_ext_ack *extack;\n};\n\n \nstatic inline bool ice_is_chnl_fltr(struct ice_tc_flower_fltr *f)\n{\n\tif (f->action.fltr_act == ICE_FWD_TO_VSI)\n\t\treturn f->action.fwd.tc.tc_class >= ICE_CHNL_START_TC &&\n\t\t       f->action.fwd.tc.tc_class < ICE_CHNL_MAX_TC;\n\telse if (f->action.fltr_act == ICE_FWD_TO_Q)\n\t\treturn f->dest_vsi && f->dest_vsi->type == ICE_VSI_CHNL;\n\n\treturn false;\n}\n\n \nstatic inline int ice_chnl_dmac_fltr_cnt(struct ice_pf *pf)\n{\n\treturn pf->num_dmac_chnl_fltrs;\n}\n\nstruct ice_vsi *ice_locate_vsi_using_queue(struct ice_vsi *vsi, int queue);\nint\nice_add_cls_flower(struct net_device *netdev, struct ice_vsi *vsi,\n\t\t   struct flow_cls_offload *cls_flower);\nint\nice_del_cls_flower(struct ice_vsi *vsi, struct flow_cls_offload *cls_flower);\nvoid ice_replay_tc_fltrs(struct ice_pf *pf);\nbool ice_is_tunnel_supported(struct net_device *dev);\n\nstatic inline bool ice_is_forward_action(enum ice_sw_fwd_act_type fltr_act)\n{\n\tswitch (fltr_act) {\n\tcase ICE_FWD_TO_VSI:\n\tcase ICE_FWD_TO_Q:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}