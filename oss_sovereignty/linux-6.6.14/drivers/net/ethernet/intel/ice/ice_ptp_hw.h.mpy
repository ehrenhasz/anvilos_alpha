{
  "module_name": "ice_ptp_hw.h",
  "hash_id": "8f063a998e6ee807f2fe68fa0e7ce5c03a66eb55c1885f61737fa5064aa9c860",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/ice/ice_ptp_hw.h",
  "human_readable_source": " \n \n\n#ifndef _ICE_PTP_HW_H_\n#define _ICE_PTP_HW_H_\n\nenum ice_ptp_tmr_cmd {\n\tINIT_TIME,\n\tINIT_INCVAL,\n\tADJ_TIME,\n\tADJ_TIME_AT_TIME,\n\tREAD_TIME,\n\tICE_PTP_NOP,\n};\n\nenum ice_ptp_serdes {\n\tICE_PTP_SERDES_1G,\n\tICE_PTP_SERDES_10G,\n\tICE_PTP_SERDES_25G,\n\tICE_PTP_SERDES_40G,\n\tICE_PTP_SERDES_50G,\n\tICE_PTP_SERDES_100G\n};\n\nenum ice_ptp_link_spd {\n\tICE_PTP_LNK_SPD_1G,\n\tICE_PTP_LNK_SPD_10G,\n\tICE_PTP_LNK_SPD_25G,\n\tICE_PTP_LNK_SPD_25G_RS,\n\tICE_PTP_LNK_SPD_40G,\n\tICE_PTP_LNK_SPD_50G,\n\tICE_PTP_LNK_SPD_50G_RS,\n\tICE_PTP_LNK_SPD_100G_RS,\n\tNUM_ICE_PTP_LNK_SPD  \n};\n\nenum ice_ptp_fec_mode {\n\tICE_PTP_FEC_MODE_NONE,\n\tICE_PTP_FEC_MODE_CLAUSE74,\n\tICE_PTP_FEC_MODE_RS_FEC\n};\n\n \nstruct ice_time_ref_info_e822 {\n\tu64 pll_freq;\n\tu64 nominal_incval;\n\tu8 pps_delay;\n};\n\n \nstruct ice_vernier_info_e822 {\n\tu32 tx_par_clk;\n\tu32 rx_par_clk;\n\tu32 tx_pcs_clk;\n\tu32 rx_pcs_clk;\n\tu32 tx_desk_rsgb_par;\n\tu32 rx_desk_rsgb_par;\n\tu32 tx_desk_rsgb_pcs;\n\tu32 rx_desk_rsgb_pcs;\n\tu32 tx_fixed_delay;\n\tu32 pmd_adj_divisor;\n\tu32 rx_fixed_delay;\n};\n\n \nstruct ice_cgu_pll_params_e822 {\n\tu32 refclk_pre_div;\n\tu32 feedback_div;\n\tu32 frac_n_div;\n\tu32 post_pll_div;\n};\n\nextern const struct\nice_cgu_pll_params_e822 e822_cgu_params[NUM_ICE_TIME_REF_FREQ];\n\n#define E810C_QSFP_C827_0_HANDLE 2\n#define E810C_QSFP_C827_1_HANDLE 3\n\n \nextern const struct ice_time_ref_info_e822 e822_time_ref[NUM_ICE_TIME_REF_FREQ];\n\n \nextern const struct ice_vernier_info_e822 e822_vernier[NUM_ICE_PTP_LNK_SPD];\n\n \n#define ICE_PTP_NOMINAL_INCVAL_E810 0x13b13b13bULL\n\n \nu8 ice_get_ptp_src_clock_index(struct ice_hw *hw);\nbool ice_ptp_lock(struct ice_hw *hw);\nvoid ice_ptp_unlock(struct ice_hw *hw);\nint ice_ptp_init_time(struct ice_hw *hw, u64 time);\nint ice_ptp_write_incval(struct ice_hw *hw, u64 incval);\nint ice_ptp_write_incval_locked(struct ice_hw *hw, u64 incval);\nint ice_ptp_adj_clock(struct ice_hw *hw, s32 adj);\nint ice_read_phy_tstamp(struct ice_hw *hw, u8 block, u8 idx, u64 *tstamp);\nint ice_clear_phy_tstamp(struct ice_hw *hw, u8 block, u8 idx);\nvoid ice_ptp_reset_ts_memory(struct ice_hw *hw);\nint ice_ptp_init_phc(struct ice_hw *hw);\nint ice_get_phy_tx_tstamp_ready(struct ice_hw *hw, u8 block, u64 *tstamp_ready);\n\n \nint ice_read_quad_reg_e822(struct ice_hw *hw, u8 quad, u16 offset, u32 *val);\nint ice_write_quad_reg_e822(struct ice_hw *hw, u8 quad, u16 offset, u32 val);\nvoid ice_ptp_reset_ts_memory_quad_e822(struct ice_hw *hw, u8 quad);\n\n \nstatic inline enum ice_time_ref_freq ice_e822_time_ref(struct ice_hw *hw)\n{\n\treturn hw->func_caps.ts_func_info.time_ref;\n}\n\n \nstatic inline void\nice_set_e822_time_ref(struct ice_hw *hw, enum ice_time_ref_freq time_ref)\n{\n\thw->func_caps.ts_func_info.time_ref = time_ref;\n}\n\nstatic inline u64 ice_e822_pll_freq(enum ice_time_ref_freq time_ref)\n{\n\treturn e822_time_ref[time_ref].pll_freq;\n}\n\nstatic inline u64 ice_e822_nominal_incval(enum ice_time_ref_freq time_ref)\n{\n\treturn e822_time_ref[time_ref].nominal_incval;\n}\n\nstatic inline u64 ice_e822_pps_delay(enum ice_time_ref_freq time_ref)\n{\n\treturn e822_time_ref[time_ref].pps_delay;\n}\n\n \nint ice_stop_phy_timer_e822(struct ice_hw *hw, u8 port, bool soft_reset);\nint ice_start_phy_timer_e822(struct ice_hw *hw, u8 port);\nint ice_phy_cfg_tx_offset_e822(struct ice_hw *hw, u8 port);\nint ice_phy_cfg_rx_offset_e822(struct ice_hw *hw, u8 port);\n\n \nint ice_ptp_init_phy_e810(struct ice_hw *hw);\nint ice_read_sma_ctrl_e810t(struct ice_hw *hw, u8 *data);\nint ice_write_sma_ctrl_e810t(struct ice_hw *hw, u8 data);\nint ice_read_pca9575_reg_e810t(struct ice_hw *hw, u8 offset, u8 *data);\n\n#define PFTSYN_SEM_BYTES\t4\n\n#define ICE_PTP_CLOCK_INDEX_0\t0x00\n#define ICE_PTP_CLOCK_INDEX_1\t0x01\n\n \n#define SEL_CPK_SRC\t8\n#define SEL_PHY_SRC\t3\n\n \n#define GLTSYN_CMD_INIT_TIME\t\tBIT(0)\n#define GLTSYN_CMD_INIT_INCVAL\t\tBIT(1)\n#define GLTSYN_CMD_INIT_TIME_INCVAL\t(BIT(0) | BIT(1))\n#define GLTSYN_CMD_ADJ_TIME\t\tBIT(2)\n#define GLTSYN_CMD_ADJ_INIT_TIME\t(BIT(2) | BIT(3))\n#define GLTSYN_CMD_READ_TIME\t\tBIT(7)\n\n \n#define PHY_CMD_INIT_TIME\t\tBIT(0)\n#define PHY_CMD_INIT_INCVAL\t\tBIT(1)\n#define PHY_CMD_ADJ_TIME\t\t(BIT(0) | BIT(1))\n#define PHY_CMD_ADJ_TIME_AT_TIME\t(BIT(0) | BIT(2))\n#define PHY_CMD_READ_TIME\t\t(BIT(0) | BIT(1) | BIT(2))\n\n#define TS_CMD_MASK_E810\t\t0xFF\n#define TS_CMD_MASK\t\t\t0xF\n#define SYNC_EXEC_CMD\t\t\t0x3\n\n \n#define P_Q0_L(a, p) ((((a) + (0x2000 * (p)))) & 0xFFFF)\n#define P_Q0_H(a, p) ((((a) + (0x2000 * (p)))) >> 16)\n#define P_Q1_L(a, p) ((((a) - (0x2000 * ((p) - ICE_PORTS_PER_QUAD)))) & 0xFFFF)\n#define P_Q1_H(a, p) ((((a) - (0x2000 * ((p) - ICE_PORTS_PER_QUAD)))) >> 16)\n\n \n#define Q_0_BASE\t\t\t0x94000\n#define Q_1_BASE\t\t\t0x114000\n\n \n#define Q_REG_TS_CTRL\t\t\t0x618\n#define Q_REG_TS_CTRL_S\t\t\t0\n#define Q_REG_TS_CTRL_M\t\t\tBIT(0)\n\n \n#define Q_REG_TX_MEMORY_STATUS_L\t0xCF0\n#define Q_REG_TX_MEMORY_STATUS_U\t0xCF4\n\n \n#define Q_REG_FIFO23_STATUS\t\t0xCF8\n#define Q_REG_FIFO01_STATUS\t\t0xCFC\n#define Q_REG_FIFO02_S\t\t\t0\n#define Q_REG_FIFO02_M\t\t\tICE_M(0x3FF, 0)\n#define Q_REG_FIFO13_S\t\t\t10\n#define Q_REG_FIFO13_M\t\t\tICE_M(0x3FF, 10)\n\n \n#define Q_REG_TX_MEM_GBL_CFG\t\t0xC08\n#define Q_REG_TX_MEM_GBL_CFG_LANE_TYPE_S\t0\n#define Q_REG_TX_MEM_GBL_CFG_LANE_TYPE_M\tBIT(0)\n#define Q_REG_TX_MEM_GBL_CFG_TX_TYPE_S\t1\n#define Q_REG_TX_MEM_GBL_CFG_TX_TYPE_M\tICE_M(0xFF, 1)\n#define Q_REG_TX_MEM_GBL_CFG_INTR_THR_S\t9\n#define Q_REG_TX_MEM_GBL_CFG_INTR_THR_M ICE_M(0x3F, 9)\n#define Q_REG_TX_MEM_GBL_CFG_INTR_ENA_S\t15\n#define Q_REG_TX_MEM_GBL_CFG_INTR_ENA_M\tBIT(15)\n\n \n#define Q_REG_TX_MEMORY_BANK_START\t0xA00\n\n \n#define P_0_BASE\t\t\t0x80000\n#define P_4_BASE\t\t\t0x106000\n\n \n#define P_REG_RX_TIMER_INC_PRE_L\t0x46C\n#define P_REG_RX_TIMER_INC_PRE_U\t0x470\n#define P_REG_TX_TIMER_INC_PRE_L\t0x44C\n#define P_REG_TX_TIMER_INC_PRE_U\t0x450\n\n \n#define P_REG_RX_TIMER_CNT_ADJ_L\t0x474\n#define P_REG_RX_TIMER_CNT_ADJ_U\t0x478\n#define P_REG_TX_TIMER_CNT_ADJ_L\t0x454\n#define P_REG_TX_TIMER_CNT_ADJ_U\t0x458\n\n \n#define P_REG_RX_CAPTURE_L\t\t0x4D8\n#define P_REG_RX_CAPTURE_U\t\t0x4DC\n#define P_REG_TX_CAPTURE_L\t\t0x4B4\n#define P_REG_TX_CAPTURE_U\t\t0x4B8\n\n \n#define P_REG_TIMETUS_L\t\t\t0x410\n#define P_REG_TIMETUS_U\t\t\t0x414\n\n#define P_REG_40B_LOW_M\t\t\t0xFF\n#define P_REG_40B_HIGH_S\t\t8\n\n \n#define P_REG_WL\t\t\t0x40C\n\n#define PTP_VERNIER_WL\t\t\t0x111ed\n\n \n#define P_REG_PS\t\t\t0x408\n#define P_REG_PS_START_S\t\t0\n#define P_REG_PS_START_M\t\tBIT(0)\n#define P_REG_PS_BYPASS_MODE_S\t\t1\n#define P_REG_PS_BYPASS_MODE_M\t\tBIT(1)\n#define P_REG_PS_ENA_CLK_S\t\t2\n#define P_REG_PS_ENA_CLK_M\t\tBIT(2)\n#define P_REG_PS_LOAD_OFFSET_S\t\t3\n#define P_REG_PS_LOAD_OFFSET_M\t\tBIT(3)\n#define P_REG_PS_SFT_RESET_S\t\t11\n#define P_REG_PS_SFT_RESET_M\t\tBIT(11)\n\n \n#define P_REG_TX_OV_STATUS\t\t0x4D4\n#define P_REG_TX_OV_STATUS_OV_S\t\t0\n#define P_REG_TX_OV_STATUS_OV_M\t\tBIT(0)\n#define P_REG_RX_OV_STATUS\t\t0x4F8\n#define P_REG_RX_OV_STATUS_OV_S\t\t0\n#define P_REG_RX_OV_STATUS_OV_M\t\tBIT(0)\n\n \n#define P_REG_TX_OR\t\t\t0x45C\n#define P_REG_RX_OR\t\t\t0x47C\n\n \n#define P_REG_TOTAL_RX_OFFSET_L\t\t0x460\n#define P_REG_TOTAL_RX_OFFSET_U\t\t0x464\n#define P_REG_TOTAL_TX_OFFSET_L\t\t0x440\n#define P_REG_TOTAL_TX_OFFSET_U\t\t0x444\n\n \n#define P_REG_UIX66_10G_40G_L\t\t0x480\n#define P_REG_UIX66_10G_40G_U\t\t0x484\n#define P_REG_UIX66_25G_100G_L\t\t0x488\n#define P_REG_UIX66_25G_100G_U\t\t0x48C\n#define P_REG_DESK_PAR_RX_TUS_L\t\t0x490\n#define P_REG_DESK_PAR_RX_TUS_U\t\t0x494\n#define P_REG_DESK_PAR_TX_TUS_L\t\t0x498\n#define P_REG_DESK_PAR_TX_TUS_U\t\t0x49C\n#define P_REG_DESK_PCS_RX_TUS_L\t\t0x4A0\n#define P_REG_DESK_PCS_RX_TUS_U\t\t0x4A4\n#define P_REG_DESK_PCS_TX_TUS_L\t\t0x4A8\n#define P_REG_DESK_PCS_TX_TUS_U\t\t0x4AC\n#define P_REG_PAR_RX_TUS_L\t\t0x420\n#define P_REG_PAR_RX_TUS_U\t\t0x424\n#define P_REG_PAR_TX_TUS_L\t\t0x428\n#define P_REG_PAR_TX_TUS_U\t\t0x42C\n#define P_REG_PCS_RX_TUS_L\t\t0x430\n#define P_REG_PCS_RX_TUS_U\t\t0x434\n#define P_REG_PCS_TX_TUS_L\t\t0x438\n#define P_REG_PCS_TX_TUS_U\t\t0x43C\n#define P_REG_PAR_RX_TIME_L\t\t0x4F0\n#define P_REG_PAR_RX_TIME_U\t\t0x4F4\n#define P_REG_PAR_TX_TIME_L\t\t0x4CC\n#define P_REG_PAR_TX_TIME_U\t\t0x4D0\n#define P_REG_PAR_PCS_RX_OFFSET_L\t0x4E8\n#define P_REG_PAR_PCS_RX_OFFSET_U\t0x4EC\n#define P_REG_PAR_PCS_TX_OFFSET_L\t0x4C4\n#define P_REG_PAR_PCS_TX_OFFSET_U\t0x4C8\n#define P_REG_LINK_SPEED\t\t0x4FC\n#define P_REG_LINK_SPEED_SERDES_S\t0\n#define P_REG_LINK_SPEED_SERDES_M\tICE_M(0x7, 0)\n#define P_REG_LINK_SPEED_FEC_MODE_S\t3\n#define P_REG_LINK_SPEED_FEC_MODE_M\tICE_M(0x3, 3)\n#define P_REG_LINK_SPEED_FEC_MODE(reg)\t\t\t\\\n\t(((reg) & P_REG_LINK_SPEED_FEC_MODE_M) >>\t\\\n\t P_REG_LINK_SPEED_FEC_MODE_S)\n\n \n#define P_REG_PMD_ALIGNMENT\t\t0x0FC\n#define P_REG_RX_80_TO_160_CNT\t\t0x6FC\n#define P_REG_RX_80_TO_160_CNT_RXCYC_S\t0\n#define P_REG_RX_80_TO_160_CNT_RXCYC_M\tBIT(0)\n#define P_REG_RX_40_TO_160_CNT\t\t0x8FC\n#define P_REG_RX_40_TO_160_CNT_RXCYC_S\t0\n#define P_REG_RX_40_TO_160_CNT_RXCYC_M\tICE_M(0x3, 0)\n\n \n#define P_REG_RX_OV_FS\t\t\t0x4F8\n#define P_REG_RX_OV_FS_FIFO_STATUS_S\t2\n#define P_REG_RX_OV_FS_FIFO_STATUS_M\tICE_M(0x3FF, 2)\n\n \n#define P_REG_TX_TMR_CMD\t\t0x448\n#define P_REG_RX_TMR_CMD\t\t0x468\n\n \n#define ETH_GLTSYN_ENA(_i)\t\t(0x03000348 + ((_i) * 4))\n\n \n#define ETH_GLTSYN_SHTIME_0(i)\t\t(0x03000368 + ((i) * 32))\n#define ETH_GLTSYN_SHTIME_L(i)\t\t(0x0300036C + ((i) * 32))\n\n \n#define ETH_GLTSYN_SHADJ_L(_i)\t\t(0x03000378 + ((_i) * 32))\n#define ETH_GLTSYN_SHADJ_H(_i)\t\t(0x0300037C + ((_i) * 32))\n\n \n#define ETH_GLTSYN_CMD\t\t\t0x03000344\n\n \n#define INCVAL_HIGH_M\t\t\t0xFF\n\n \n#define TS_VALID\t\t\tBIT(0)\n#define TS_LOW_M\t\t\t0xFFFFFFFF\n#define TS_HIGH_M\t\t\t0xFF\n#define TS_HIGH_S\t\t\t32\n\n#define TS_PHY_LOW_M\t\t\t0xFF\n#define TS_PHY_HIGH_M\t\t\t0xFFFFFFFF\n#define TS_PHY_HIGH_S\t\t\t8\n\n#define BYTES_PER_IDX_ADDR_L_U\t\t8\n#define BYTES_PER_IDX_ADDR_L\t\t4\n\n \n#define TS_LL_READ_RETRIES\t\t200\n#define TS_LL_READ_TS_HIGH\t\tGENMASK(23, 16)\n#define TS_LL_READ_TS_IDX\t\tGENMASK(29, 24)\n#define TS_LL_READ_TS\t\t\tBIT(31)\n\n \n#define TS_L(a, idx) ((a) + ((idx) * BYTES_PER_IDX_ADDR_L_U))\n#define TS_H(a, idx) ((a) + ((idx) * BYTES_PER_IDX_ADDR_L_U +\t\t\\\n\t\t\t     BYTES_PER_IDX_ADDR_L))\n\n \n#define TS_EXT(a, port, idx) ((a) + (0x1000 * (port)) +\t\t\t\\\n\t\t\t\t ((idx) * BYTES_PER_IDX_ADDR_L_U))\n\n#define LOW_TX_MEMORY_BANK_START\t0x03090000\n#define HIGH_TX_MEMORY_BANK_START\t0x03090004\n\n \n#define ICE_SMA1_DIR_EN_E810T\t\tBIT(4)\n#define ICE_SMA1_TX_EN_E810T\t\tBIT(5)\n#define ICE_SMA2_UFL2_RX_DIS_E810T\tBIT(3)\n#define ICE_SMA2_DIR_EN_E810T\t\tBIT(6)\n#define ICE_SMA2_TX_EN_E810T\t\tBIT(7)\n\n#define ICE_SMA1_MASK_E810T\t(ICE_SMA1_DIR_EN_E810T | \\\n\t\t\t\t ICE_SMA1_TX_EN_E810T)\n#define ICE_SMA2_MASK_E810T\t(ICE_SMA2_UFL2_RX_DIS_E810T | \\\n\t\t\t\t ICE_SMA2_DIR_EN_E810T | \\\n\t\t\t\t ICE_SMA2_TX_EN_E810T)\n#define ICE_ALL_SMA_MASK_E810T\t(ICE_SMA1_MASK_E810T | \\\n\t\t\t\t ICE_SMA2_MASK_E810T)\n\n#define ICE_SMA_MIN_BIT_E810T\t3\n#define ICE_SMA_MAX_BIT_E810T\t7\n#define ICE_PCA9575_P1_OFFSET\t8\n\n \n#define ICE_PCA9575_P0_IN\t0x0\n\n \n#define ICE_E810T_P0_GNSS_PRSNT_N\tBIT(4)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}