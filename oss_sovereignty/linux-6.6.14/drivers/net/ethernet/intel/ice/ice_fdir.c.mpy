{
  "module_name": "ice_fdir.c",
  "hash_id": "cecb503ad534951b2d7b563e0152537a0bef9c057d735deaf563d87a263da5f5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/ice/ice_fdir.c",
  "human_readable_source": "\n \n\n#include \"ice_common.h\"\n\n \nstatic const u8 ice_fdir_tcpv4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x28, 0x00, 0x01, 0x00, 0x00, 0x40, 0x06,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x50, 0x00,\n\t0x20, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nstatic const u8 ice_fdir_udpv4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x1C, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_sctpv4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x20, 0x00, 0x00, 0x40, 0x00, 0x40, 0x84,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x14, 0x00, 0x00, 0x40, 0x00, 0x40, 0x10,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00\n};\n\nstatic const u8 ice_fdir_udp4_gtpu4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x4c, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x08, 0x68, 0x08, 0x68, 0x00, 0x00,\n\t0x00, 0x00, 0x34, 0xff, 0x00, 0x28, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x85, 0x02, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00,\n\t0x00, 0x1c, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_tcp4_gtpu4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x58, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x08, 0x68, 0x08, 0x68, 0x00, 0x00,\n\t0x00, 0x00, 0x34, 0xff, 0x00, 0x28, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x85, 0x02, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00,\n\t0x00, 0x28, 0x00, 0x00, 0x40, 0x00, 0x40, 0x06,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_icmp4_gtpu4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x4c, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x08, 0x68, 0x08, 0x68, 0x00, 0x00,\n\t0x00, 0x00, 0x34, 0xff, 0x00, 0x28, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x85, 0x02, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00,\n\t0x00, 0x1c, 0x00, 0x00, 0x40, 0x00, 0x40, 0x01,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_gtpu4_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x44, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x08, 0x68, 0x08, 0x68, 0x00, 0x00,\n\t0x00, 0x00, 0x34, 0xff, 0x00, 0x28, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x85, 0x02, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x00,\n\t0x00, 0x14, 0x00, 0x00, 0x40, 0x00, 0x40, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_l2tpv3_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x14, 0x00, 0x00, 0x40, 0x00, 0x40, 0x73,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv6_l2tpv3_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x73, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_esp_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x14, 0x00, 0x00, 0x40, 0x00, 0x40, 0x32,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00\n};\n\nstatic const u8 ice_fdir_ipv6_esp_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x32, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_ah_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x14, 0x00, 0x00, 0x40, 0x00, 0x40, 0x33,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00\n};\n\nstatic const u8 ice_fdir_ipv6_ah_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x33, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_nat_t_esp_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x1C, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x11, 0x94, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv6_nat_t_esp_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x08, 0x11, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x11, 0x94, 0x00, 0x00, 0x00, 0x08,\n};\n\nstatic const u8 ice_fdir_ipv4_pfcp_node_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x2C, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x22, 0x65, 0x22, 0x65, 0x00, 0x00,\n\t0x00, 0x00, 0x20, 0x00, 0x00, 0x10, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv4_pfcp_session_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x2C, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x22, 0x65, 0x22, 0x65, 0x00, 0x00,\n\t0x00, 0x00, 0x21, 0x00, 0x00, 0x10, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv6_pfcp_node_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x18, 0x11, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x22, 0x65,\n\t0x22, 0x65, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00,\n\t0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv6_pfcp_session_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x18, 0x11, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x22, 0x65,\n\t0x22, 0x65, 0x00, 0x00, 0x00, 0x00, 0x21, 0x00,\n\t0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_non_ip_l2_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_tcpv6_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x14, 0x06, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x50, 0x00, 0x20, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_udpv6_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x08, 0x11, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x08, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_sctpv6_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x0C, 0x84, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ipv6_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x86, 0xDD, 0x60, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x3B, 0x40, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_tcp4_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x5a, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,\n\t0x45, 0x00, 0x00, 0x28, 0x00, 0x00, 0x40, 0x00,\n\t0x40, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x50, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_udp4_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x4e, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,\n\t0x45, 0x00, 0x00, 0x1c, 0x00, 0x00, 0x40, 0x00,\n\t0x40, 0x11, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_sctp4_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x52, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,\n\t0x45, 0x00, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00,\n\t0x40, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ip4_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x46, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,\n\t0x45, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x00,\n\t0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_tcp6_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x6e, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x86, 0xdd,\n\t0x60, 0x00, 0x00, 0x00, 0x00, 0x14, 0x06, 0x40,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x50, 0x00, 0x20, 0x00,\n\t0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_udp6_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x62, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x86, 0xdd,\n\t0x60, 0x00, 0x00, 0x00, 0x00, 0x08, 0x11, 0x40,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_sctp6_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x66, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x86, 0xdd,\n\t0x60, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x84, 0x40,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00,\n};\n\nstatic const u8 ice_fdir_ip6_tun_pkt[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x45, 0x00,\n\t0x00, 0x5a, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x04, 0x00, 0x00, 0x03, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x86, 0xdd,\n\t0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3b, 0x40,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n};\n\n \nstatic const struct ice_fdir_base_pkt ice_fdir_pkt[] = {\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_TCP,\n\t\tsizeof(ice_fdir_tcpv4_pkt), ice_fdir_tcpv4_pkt,\n\t\tsizeof(ice_fdir_tcp4_tun_pkt), ice_fdir_tcp4_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_UDP,\n\t\tsizeof(ice_fdir_udpv4_pkt), ice_fdir_udpv4_pkt,\n\t\tsizeof(ice_fdir_udp4_tun_pkt), ice_fdir_udp4_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_SCTP,\n\t\tsizeof(ice_fdir_sctpv4_pkt), ice_fdir_sctpv4_pkt,\n\t\tsizeof(ice_fdir_sctp4_tun_pkt), ice_fdir_sctp4_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_OTHER,\n\t\tsizeof(ice_fdir_ipv4_pkt), ice_fdir_ipv4_pkt,\n\t\tsizeof(ice_fdir_ip4_tun_pkt), ice_fdir_ip4_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_UDP,\n\t\tsizeof(ice_fdir_udp4_gtpu4_pkt),\n\t\tice_fdir_udp4_gtpu4_pkt,\n\t\tsizeof(ice_fdir_udp4_gtpu4_pkt),\n\t\tice_fdir_udp4_gtpu4_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_TCP,\n\t\tsizeof(ice_fdir_tcp4_gtpu4_pkt),\n\t\tice_fdir_tcp4_gtpu4_pkt,\n\t\tsizeof(ice_fdir_tcp4_gtpu4_pkt),\n\t\tice_fdir_tcp4_gtpu4_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_ICMP,\n\t\tsizeof(ice_fdir_icmp4_gtpu4_pkt),\n\t\tice_fdir_icmp4_gtpu4_pkt,\n\t\tsizeof(ice_fdir_icmp4_gtpu4_pkt),\n\t\tice_fdir_icmp4_gtpu4_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_OTHER,\n\t\tsizeof(ice_fdir_ipv4_gtpu4_pkt),\n\t\tice_fdir_ipv4_gtpu4_pkt,\n\t\tsizeof(ice_fdir_ipv4_gtpu4_pkt),\n\t\tice_fdir_ipv4_gtpu4_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_L2TPV3,\n\t\tsizeof(ice_fdir_ipv4_l2tpv3_pkt), ice_fdir_ipv4_l2tpv3_pkt,\n\t\tsizeof(ice_fdir_ipv4_l2tpv3_pkt), ice_fdir_ipv4_l2tpv3_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_L2TPV3,\n\t\tsizeof(ice_fdir_ipv6_l2tpv3_pkt), ice_fdir_ipv6_l2tpv3_pkt,\n\t\tsizeof(ice_fdir_ipv6_l2tpv3_pkt), ice_fdir_ipv6_l2tpv3_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_ESP,\n\t\tsizeof(ice_fdir_ipv4_esp_pkt), ice_fdir_ipv4_esp_pkt,\n\t\tsizeof(ice_fdir_ipv4_esp_pkt), ice_fdir_ipv4_esp_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_ESP,\n\t\tsizeof(ice_fdir_ipv6_esp_pkt), ice_fdir_ipv6_esp_pkt,\n\t\tsizeof(ice_fdir_ipv6_esp_pkt), ice_fdir_ipv6_esp_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_AH,\n\t\tsizeof(ice_fdir_ipv4_ah_pkt), ice_fdir_ipv4_ah_pkt,\n\t\tsizeof(ice_fdir_ipv4_ah_pkt), ice_fdir_ipv4_ah_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_AH,\n\t\tsizeof(ice_fdir_ipv6_ah_pkt), ice_fdir_ipv6_ah_pkt,\n\t\tsizeof(ice_fdir_ipv6_ah_pkt), ice_fdir_ipv6_ah_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_NAT_T_ESP,\n\t\tsizeof(ice_fdir_ipv4_nat_t_esp_pkt),\n\t\tice_fdir_ipv4_nat_t_esp_pkt,\n\t\tsizeof(ice_fdir_ipv4_nat_t_esp_pkt),\n\t\tice_fdir_ipv4_nat_t_esp_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_NAT_T_ESP,\n\t\tsizeof(ice_fdir_ipv6_nat_t_esp_pkt),\n\t\tice_fdir_ipv6_nat_t_esp_pkt,\n\t\tsizeof(ice_fdir_ipv6_nat_t_esp_pkt),\n\t\tice_fdir_ipv6_nat_t_esp_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_PFCP_NODE,\n\t\tsizeof(ice_fdir_ipv4_pfcp_node_pkt),\n\t\tice_fdir_ipv4_pfcp_node_pkt,\n\t\tsizeof(ice_fdir_ipv4_pfcp_node_pkt),\n\t\tice_fdir_ipv4_pfcp_node_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV4_PFCP_SESSION,\n\t\tsizeof(ice_fdir_ipv4_pfcp_session_pkt),\n\t\tice_fdir_ipv4_pfcp_session_pkt,\n\t\tsizeof(ice_fdir_ipv4_pfcp_session_pkt),\n\t\tice_fdir_ipv4_pfcp_session_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_PFCP_NODE,\n\t\tsizeof(ice_fdir_ipv6_pfcp_node_pkt),\n\t\tice_fdir_ipv6_pfcp_node_pkt,\n\t\tsizeof(ice_fdir_ipv6_pfcp_node_pkt),\n\t\tice_fdir_ipv6_pfcp_node_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_PFCP_SESSION,\n\t\tsizeof(ice_fdir_ipv6_pfcp_session_pkt),\n\t\tice_fdir_ipv6_pfcp_session_pkt,\n\t\tsizeof(ice_fdir_ipv6_pfcp_session_pkt),\n\t\tice_fdir_ipv6_pfcp_session_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NON_IP_L2,\n\t\tsizeof(ice_fdir_non_ip_l2_pkt), ice_fdir_non_ip_l2_pkt,\n\t\tsizeof(ice_fdir_non_ip_l2_pkt), ice_fdir_non_ip_l2_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_TCP,\n\t\tsizeof(ice_fdir_tcpv6_pkt), ice_fdir_tcpv6_pkt,\n\t\tsizeof(ice_fdir_tcp6_tun_pkt), ice_fdir_tcp6_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_UDP,\n\t\tsizeof(ice_fdir_udpv6_pkt), ice_fdir_udpv6_pkt,\n\t\tsizeof(ice_fdir_udp6_tun_pkt), ice_fdir_udp6_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_SCTP,\n\t\tsizeof(ice_fdir_sctpv6_pkt), ice_fdir_sctpv6_pkt,\n\t\tsizeof(ice_fdir_sctp6_tun_pkt), ice_fdir_sctp6_tun_pkt,\n\t},\n\t{\n\t\tICE_FLTR_PTYPE_NONF_IPV6_OTHER,\n\t\tsizeof(ice_fdir_ipv6_pkt), ice_fdir_ipv6_pkt,\n\t\tsizeof(ice_fdir_ip6_tun_pkt), ice_fdir_ip6_tun_pkt,\n\t},\n};\n\n#define ICE_FDIR_NUM_PKT ARRAY_SIZE(ice_fdir_pkt)\n\n \nstatic void ice_set_dflt_val_fd_desc(struct ice_fd_fltr_desc_ctx *fd_fltr_ctx)\n{\n\tfd_fltr_ctx->comp_q = ICE_FXD_FLTR_QW0_COMP_Q_ZERO;\n\tfd_fltr_ctx->comp_report = ICE_FXD_FLTR_QW0_COMP_REPORT_SW_FAIL;\n\tfd_fltr_ctx->fd_space = ICE_FXD_FLTR_QW0_FD_SPACE_GUAR_BEST;\n\tfd_fltr_ctx->cnt_ena = ICE_FXD_FLTR_QW0_STAT_ENA_PKTS;\n\tfd_fltr_ctx->evict_ena = ICE_FXD_FLTR_QW0_EVICT_ENA_TRUE;\n\tfd_fltr_ctx->toq = ICE_FXD_FLTR_QW0_TO_Q_EQUALS_QINDEX;\n\tfd_fltr_ctx->toq_prio = ICE_FXD_FLTR_QW0_TO_Q_PRIO1;\n\tfd_fltr_ctx->dpu_recipe = ICE_FXD_FLTR_QW0_DPU_RECIPE_DFLT;\n\tfd_fltr_ctx->drop = ICE_FXD_FLTR_QW0_DROP_NO;\n\tfd_fltr_ctx->flex_prio = ICE_FXD_FLTR_QW0_FLEX_PRI_NONE;\n\tfd_fltr_ctx->flex_mdid = ICE_FXD_FLTR_QW0_FLEX_MDID0;\n\tfd_fltr_ctx->flex_val = ICE_FXD_FLTR_QW0_FLEX_VAL0;\n\tfd_fltr_ctx->dtype = ICE_TX_DESC_DTYPE_FLTR_PROG;\n\tfd_fltr_ctx->desc_prof_prio = ICE_FXD_FLTR_QW1_PROF_PRIO_ZERO;\n\tfd_fltr_ctx->desc_prof = ICE_FXD_FLTR_QW1_PROF_ZERO;\n\tfd_fltr_ctx->swap = ICE_FXD_FLTR_QW1_SWAP_SET;\n\tfd_fltr_ctx->fdid_prio = ICE_FXD_FLTR_QW1_FDID_PRI_ONE;\n\tfd_fltr_ctx->fdid_mdid = ICE_FXD_FLTR_QW1_FDID_MDID_FD;\n\tfd_fltr_ctx->fdid = ICE_FXD_FLTR_QW1_FDID_ZERO;\n}\n\n \nstatic void\nice_set_fd_desc_val(struct ice_fd_fltr_desc_ctx *ctx,\n\t\t    struct ice_fltr_desc *fdir_desc)\n{\n\tu64 qword;\n\n\t \n\tqword = ((u64)ctx->qindex << ICE_FXD_FLTR_QW0_QINDEX_S) &\n\t\tICE_FXD_FLTR_QW0_QINDEX_M;\n\tqword |= ((u64)ctx->comp_q << ICE_FXD_FLTR_QW0_COMP_Q_S) &\n\t\t ICE_FXD_FLTR_QW0_COMP_Q_M;\n\tqword |= ((u64)ctx->comp_report << ICE_FXD_FLTR_QW0_COMP_REPORT_S) &\n\t\t ICE_FXD_FLTR_QW0_COMP_REPORT_M;\n\tqword |= ((u64)ctx->fd_space << ICE_FXD_FLTR_QW0_FD_SPACE_S) &\n\t\t ICE_FXD_FLTR_QW0_FD_SPACE_M;\n\tqword |= ((u64)ctx->cnt_index << ICE_FXD_FLTR_QW0_STAT_CNT_S) &\n\t\t ICE_FXD_FLTR_QW0_STAT_CNT_M;\n\tqword |= ((u64)ctx->cnt_ena << ICE_FXD_FLTR_QW0_STAT_ENA_S) &\n\t\t ICE_FXD_FLTR_QW0_STAT_ENA_M;\n\tqword |= ((u64)ctx->evict_ena << ICE_FXD_FLTR_QW0_EVICT_ENA_S) &\n\t\t ICE_FXD_FLTR_QW0_EVICT_ENA_M;\n\tqword |= ((u64)ctx->toq << ICE_FXD_FLTR_QW0_TO_Q_S) &\n\t\t ICE_FXD_FLTR_QW0_TO_Q_M;\n\tqword |= ((u64)ctx->toq_prio << ICE_FXD_FLTR_QW0_TO_Q_PRI_S) &\n\t\t ICE_FXD_FLTR_QW0_TO_Q_PRI_M;\n\tqword |= ((u64)ctx->dpu_recipe << ICE_FXD_FLTR_QW0_DPU_RECIPE_S) &\n\t\t ICE_FXD_FLTR_QW0_DPU_RECIPE_M;\n\tqword |= ((u64)ctx->drop << ICE_FXD_FLTR_QW0_DROP_S) &\n\t\t ICE_FXD_FLTR_QW0_DROP_M;\n\tqword |= ((u64)ctx->flex_prio << ICE_FXD_FLTR_QW0_FLEX_PRI_S) &\n\t\t ICE_FXD_FLTR_QW0_FLEX_PRI_M;\n\tqword |= ((u64)ctx->flex_mdid << ICE_FXD_FLTR_QW0_FLEX_MDID_S) &\n\t\t ICE_FXD_FLTR_QW0_FLEX_MDID_M;\n\tqword |= ((u64)ctx->flex_val << ICE_FXD_FLTR_QW0_FLEX_VAL_S) &\n\t\t ICE_FXD_FLTR_QW0_FLEX_VAL_M;\n\tfdir_desc->qidx_compq_space_stat = cpu_to_le64(qword);\n\n\t \n\tqword = ((u64)ctx->dtype << ICE_FXD_FLTR_QW1_DTYPE_S) &\n\t\tICE_FXD_FLTR_QW1_DTYPE_M;\n\tqword |= ((u64)ctx->pcmd << ICE_FXD_FLTR_QW1_PCMD_S) &\n\t\t ICE_FXD_FLTR_QW1_PCMD_M;\n\tqword |= ((u64)ctx->desc_prof_prio << ICE_FXD_FLTR_QW1_PROF_PRI_S) &\n\t\t ICE_FXD_FLTR_QW1_PROF_PRI_M;\n\tqword |= ((u64)ctx->desc_prof << ICE_FXD_FLTR_QW1_PROF_S) &\n\t\t ICE_FXD_FLTR_QW1_PROF_M;\n\tqword |= ((u64)ctx->fd_vsi << ICE_FXD_FLTR_QW1_FD_VSI_S) &\n\t\t ICE_FXD_FLTR_QW1_FD_VSI_M;\n\tqword |= ((u64)ctx->swap << ICE_FXD_FLTR_QW1_SWAP_S) &\n\t\t ICE_FXD_FLTR_QW1_SWAP_M;\n\tqword |= ((u64)ctx->fdid_prio << ICE_FXD_FLTR_QW1_FDID_PRI_S) &\n\t\t ICE_FXD_FLTR_QW1_FDID_PRI_M;\n\tqword |= ((u64)ctx->fdid_mdid << ICE_FXD_FLTR_QW1_FDID_MDID_S) &\n\t\t ICE_FXD_FLTR_QW1_FDID_MDID_M;\n\tqword |= ((u64)ctx->fdid << ICE_FXD_FLTR_QW1_FDID_S) &\n\t\t ICE_FXD_FLTR_QW1_FDID_M;\n\tfdir_desc->dtype_cmd_vsi_fdid = cpu_to_le64(qword);\n}\n\n \nvoid\nice_fdir_get_prgm_desc(struct ice_hw *hw, struct ice_fdir_fltr *input,\n\t\t       struct ice_fltr_desc *fdesc, bool add)\n{\n\tstruct ice_fd_fltr_desc_ctx fdir_fltr_ctx = { 0 };\n\n\t \n\tice_set_dflt_val_fd_desc(&fdir_fltr_ctx);\n\n\t \n\tfdir_fltr_ctx.fdid = input->fltr_id;\n\tif (input->dest_ctl == ICE_FLTR_PRGM_DESC_DEST_DROP_PKT) {\n\t\tfdir_fltr_ctx.drop = ICE_FXD_FLTR_QW0_DROP_YES;\n\t\tfdir_fltr_ctx.qindex = 0;\n\t} else if (input->dest_ctl ==\n\t\t   ICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_OTHER) {\n\t\tfdir_fltr_ctx.drop = ICE_FXD_FLTR_QW0_DROP_NO;\n\t\tfdir_fltr_ctx.qindex = 0;\n\t} else {\n\t\tif (input->dest_ctl ==\n\t\t    ICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_QGROUP)\n\t\t\tfdir_fltr_ctx.toq = input->q_region;\n\t\tfdir_fltr_ctx.drop = ICE_FXD_FLTR_QW0_DROP_NO;\n\t\tfdir_fltr_ctx.qindex = input->q_index;\n\t}\n\tfdir_fltr_ctx.cnt_ena = input->cnt_ena;\n\tfdir_fltr_ctx.cnt_index = input->cnt_index;\n\tfdir_fltr_ctx.fd_vsi = ice_get_hw_vsi_num(hw, input->dest_vsi);\n\tfdir_fltr_ctx.evict_ena = ICE_FXD_FLTR_QW0_EVICT_ENA_FALSE;\n\tif (input->dest_ctl == ICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_OTHER)\n\t\tfdir_fltr_ctx.toq_prio = 0;\n\telse\n\t\tfdir_fltr_ctx.toq_prio = 3;\n\tfdir_fltr_ctx.pcmd = add ? ICE_FXD_FLTR_QW1_PCMD_ADD :\n\t\tICE_FXD_FLTR_QW1_PCMD_REMOVE;\n\tfdir_fltr_ctx.swap = ICE_FXD_FLTR_QW1_SWAP_NOT_SET;\n\tfdir_fltr_ctx.comp_q = ICE_FXD_FLTR_QW0_COMP_Q_ZERO;\n\tfdir_fltr_ctx.comp_report = input->comp_report;\n\tfdir_fltr_ctx.fdid_prio = input->fdid_prio;\n\tfdir_fltr_ctx.desc_prof = 1;\n\tfdir_fltr_ctx.desc_prof_prio = 3;\n\tice_set_fd_desc_val(&fdir_fltr_ctx, fdesc);\n}\n\n \nint ice_alloc_fd_res_cntr(struct ice_hw *hw, u16 *cntr_id)\n{\n\treturn ice_alloc_res_cntr(hw, ICE_AQC_RES_TYPE_FDIR_COUNTER_BLOCK,\n\t\t\t\t  ICE_AQC_RES_TYPE_FLAG_DEDICATED, 1, cntr_id);\n}\n\n \nint ice_free_fd_res_cntr(struct ice_hw *hw, u16 cntr_id)\n{\n\treturn ice_free_res_cntr(hw, ICE_AQC_RES_TYPE_FDIR_COUNTER_BLOCK,\n\t\t\t\t ICE_AQC_RES_TYPE_FLAG_DEDICATED, 1, cntr_id);\n}\n\n \nint ice_alloc_fd_guar_item(struct ice_hw *hw, u16 *cntr_id, u16 num_fltr)\n{\n\treturn ice_alloc_res_cntr(hw, ICE_AQC_RES_TYPE_FDIR_GUARANTEED_ENTRIES,\n\t\t\t\t  ICE_AQC_RES_TYPE_FLAG_DEDICATED, num_fltr,\n\t\t\t\t  cntr_id);\n}\n\n \nint ice_alloc_fd_shrd_item(struct ice_hw *hw, u16 *cntr_id, u16 num_fltr)\n{\n\treturn ice_alloc_res_cntr(hw, ICE_AQC_RES_TYPE_FDIR_SHARED_ENTRIES,\n\t\t\t\t  ICE_AQC_RES_TYPE_FLAG_DEDICATED, num_fltr,\n\t\t\t\t  cntr_id);\n}\n\n \nint ice_get_fdir_cnt_all(struct ice_hw *hw)\n{\n\treturn hw->func_caps.fd_fltr_guar + hw->func_caps.fd_fltr_best_effort;\n}\n\n \nstatic void ice_pkt_insert_ipv6_addr(u8 *pkt, int offset, __be32 *addr)\n{\n\tint idx;\n\n\tfor (idx = 0; idx < ICE_IPV6_ADDR_LEN_AS_U32; idx++)\n\t\tmemcpy(pkt + offset + idx * sizeof(*addr), &addr[idx],\n\t\t       sizeof(*addr));\n}\n\n \nstatic void ice_pkt_insert_u6_qfi(u8 *pkt, int offset, u8 data)\n{\n\tu8 ret;\n\n\tret = (data & 0x3F) + (*(pkt + offset) & 0xC0);\n\tmemcpy(pkt + offset, &ret, sizeof(ret));\n}\n\n \nstatic void ice_pkt_insert_u8(u8 *pkt, int offset, u8 data)\n{\n\tmemcpy(pkt + offset, &data, sizeof(data));\n}\n\n \nstatic void ice_pkt_insert_u8_tc(u8 *pkt, int offset, u8 data)\n{\n\tu8 high, low;\n\n\thigh = (data >> 4) + (*(pkt + offset) & 0xF0);\n\tmemcpy(pkt + offset, &high, sizeof(high));\n\n\tlow = (*(pkt + offset + 1) & 0x0F) + ((data & 0x0F) << 4);\n\tmemcpy(pkt + offset + 1, &low, sizeof(low));\n}\n\n \nstatic void ice_pkt_insert_u16(u8 *pkt, int offset, __be16 data)\n{\n\tmemcpy(pkt + offset, &data, sizeof(data));\n}\n\n \nstatic void ice_pkt_insert_u32(u8 *pkt, int offset, __be32 data)\n{\n\tmemcpy(pkt + offset, &data, sizeof(data));\n}\n\n \nstatic void ice_pkt_insert_mac_addr(u8 *pkt, u8 *addr)\n{\n\tether_addr_copy(pkt, addr);\n}\n\n \nint\nice_fdir_get_gen_prgm_pkt(struct ice_hw *hw, struct ice_fdir_fltr *input,\n\t\t\t  u8 *pkt, bool frag, bool tun)\n{\n\tenum ice_fltr_ptype flow;\n\tu16 tnl_port;\n\tu8 *loc;\n\tu16 idx;\n\n\tif (input->flow_type == ICE_FLTR_PTYPE_NONF_IPV4_OTHER) {\n\t\tswitch (input->ip.v4.proto) {\n\t\tcase IPPROTO_TCP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV4_TCP;\n\t\t\tbreak;\n\t\tcase IPPROTO_UDP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV4_UDP;\n\t\t\tbreak;\n\t\tcase IPPROTO_SCTP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV4_SCTP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV4_OTHER;\n\t\t\tbreak;\n\t\t}\n\t} else if (input->flow_type == ICE_FLTR_PTYPE_NONF_IPV6_OTHER) {\n\t\tswitch (input->ip.v6.proto) {\n\t\tcase IPPROTO_TCP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV6_TCP;\n\t\t\tbreak;\n\t\tcase IPPROTO_UDP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV6_UDP;\n\t\t\tbreak;\n\t\tcase IPPROTO_SCTP:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV6_SCTP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tflow = ICE_FLTR_PTYPE_NONF_IPV6_OTHER;\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tflow = input->flow_type;\n\t}\n\n\tfor (idx = 0; idx < ICE_FDIR_NUM_PKT; idx++)\n\t\tif (ice_fdir_pkt[idx].flow == flow)\n\t\t\tbreak;\n\tif (idx == ICE_FDIR_NUM_PKT)\n\t\treturn -EINVAL;\n\tif (!tun) {\n\t\tmemcpy(pkt, ice_fdir_pkt[idx].pkt, ice_fdir_pkt[idx].pkt_len);\n\t\tloc = pkt;\n\t} else {\n\t\tif (!ice_get_open_tunnel_port(hw, &tnl_port, TNL_ALL))\n\t\t\treturn -ENOENT;\n\t\tif (!ice_fdir_pkt[idx].tun_pkt)\n\t\t\treturn -EINVAL;\n\t\tmemcpy(pkt, ice_fdir_pkt[idx].tun_pkt,\n\t\t       ice_fdir_pkt[idx].tun_pkt_len);\n\t\tice_pkt_insert_u16(pkt, ICE_IPV4_UDP_DST_PORT_OFFSET,\n\t\t\t\t   htons(tnl_port));\n\t\tloc = &pkt[ICE_FDIR_TUN_PKT_OFF];\n\t}\n\n\t \n\tswitch (flow) {\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_TCP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_TCP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.src_port);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_TCP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.dst_port);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TOS_OFFSET, input->ip.v4.tos);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TTL_OFFSET, input->ip.v4.ttl);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tif (frag)\n\t\t\tloc[20] = ICE_FDIR_IPV4_PKT_FLAG_MF;\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_UDP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_UDP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.src_port);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_UDP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.dst_port);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TOS_OFFSET, input->ip.v4.tos);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TTL_OFFSET, input->ip.v4.ttl);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tice_pkt_insert_mac_addr(loc + ETH_ALEN,\n\t\t\t\t\tinput->ext_data.src_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_SCTP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_SCTP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.src_port);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_SCTP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.dst_port);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TOS_OFFSET, input->ip.v4.tos);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TTL_OFFSET, input->ip.v4.ttl);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_OTHER:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TOS_OFFSET, input->ip.v4.tos);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_TTL_OFFSET, input->ip.v4.ttl);\n\t\tice_pkt_insert_u8(loc, ICE_IPV4_PROTO_OFFSET,\n\t\t\t\t  input->ip.v4.proto);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_UDP:\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_TCP:\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_ICMP:\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_GTPU_IPV4_OTHER:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_GTPU_TEID_OFFSET,\n\t\t\t\t   input->gtpu_data.teid);\n\t\tice_pkt_insert_u6_qfi(loc, ICE_IPV4_GTPU_QFI_OFFSET,\n\t\t\t\t      input->gtpu_data.qfi);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_L2TPV3:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_L2TPV3_SESS_ID_OFFSET,\n\t\t\t\t   input->l2tpv3_data.session_id);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_L2TPV3:\n\t\tice_pkt_insert_u32(loc, ICE_IPV6_L2TPV3_SESS_ID_OFFSET,\n\t\t\t\t   input->l2tpv3_data.session_id);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_ESP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_ESP_SPI_OFFSET,\n\t\t\t\t   input->ip.v4.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_ESP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV6_ESP_SPI_OFFSET,\n\t\t\t\t   input->ip.v6.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_AH:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_AH_SPI_OFFSET,\n\t\t\t\t   input->ip.v4.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_AH:\n\t\tice_pkt_insert_u32(loc, ICE_IPV6_AH_SPI_OFFSET,\n\t\t\t\t   input->ip.v6.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_NAT_T_ESP:\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_DST_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.src_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_SRC_ADDR_OFFSET,\n\t\t\t\t   input->ip.v4.dst_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV4_NAT_T_ESP_SPI_OFFSET,\n\t\t\t\t   input->ip.v4.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_NAT_T_ESP:\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_DST_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.src_ip);\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_SRC_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.dst_ip);\n\t\tice_pkt_insert_u32(loc, ICE_IPV6_NAT_T_ESP_SPI_OFFSET,\n\t\t\t\t   input->ip.v6.sec_parm_idx);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_PFCP_NODE:\n\tcase ICE_FLTR_PTYPE_NONF_IPV4_PFCP_SESSION:\n\t\tice_pkt_insert_u16(loc, ICE_IPV4_UDP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v4.dst_port);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_PFCP_NODE:\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_PFCP_SESSION:\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_UDP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.dst_port);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NON_IP_L2:\n\t\tice_pkt_insert_u16(loc, ICE_MAC_ETHTYPE_OFFSET,\n\t\t\t\t   input->ext_data.ether_type);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_TCP:\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_DST_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.src_ip);\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_SRC_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_TCP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.src_port);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_TCP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.dst_port);\n\t\tice_pkt_insert_u8_tc(loc, ICE_IPV6_TC_OFFSET, input->ip.v6.tc);\n\t\tice_pkt_insert_u8(loc, ICE_IPV6_HLIM_OFFSET, input->ip.v6.hlim);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_UDP:\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_DST_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.src_ip);\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_SRC_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_UDP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.src_port);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_UDP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.dst_port);\n\t\tice_pkt_insert_u8_tc(loc, ICE_IPV6_TC_OFFSET, input->ip.v6.tc);\n\t\tice_pkt_insert_u8(loc, ICE_IPV6_HLIM_OFFSET, input->ip.v6.hlim);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_SCTP:\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_DST_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.src_ip);\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_SRC_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.dst_ip);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_SCTP_DST_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.src_port);\n\t\tice_pkt_insert_u16(loc, ICE_IPV6_SCTP_SRC_PORT_OFFSET,\n\t\t\t\t   input->ip.v6.dst_port);\n\t\tice_pkt_insert_u8_tc(loc, ICE_IPV6_TC_OFFSET, input->ip.v6.tc);\n\t\tice_pkt_insert_u8(loc, ICE_IPV6_HLIM_OFFSET, input->ip.v6.hlim);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tcase ICE_FLTR_PTYPE_NONF_IPV6_OTHER:\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_DST_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.src_ip);\n\t\tice_pkt_insert_ipv6_addr(loc, ICE_IPV6_SRC_ADDR_OFFSET,\n\t\t\t\t\t input->ip.v6.dst_ip);\n\t\tice_pkt_insert_u8_tc(loc, ICE_IPV6_TC_OFFSET, input->ip.v6.tc);\n\t\tice_pkt_insert_u8(loc, ICE_IPV6_HLIM_OFFSET, input->ip.v6.hlim);\n\t\tice_pkt_insert_u8(loc, ICE_IPV6_PROTO_OFFSET,\n\t\t\t\t  input->ip.v6.proto);\n\t\tice_pkt_insert_mac_addr(loc, input->ext_data.dst_mac);\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tif (input->flex_fltr)\n\t\tice_pkt_insert_u16(loc, input->flex_offset, input->flex_word);\n\n\treturn 0;\n}\n\n \nbool ice_fdir_has_frag(enum ice_fltr_ptype flow)\n{\n\tif (flow == ICE_FLTR_PTYPE_NONF_IPV4_OTHER)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n\n \nstruct ice_fdir_fltr *\nice_fdir_find_fltr_by_idx(struct ice_hw *hw, u32 fltr_idx)\n{\n\tstruct ice_fdir_fltr *rule;\n\n\tlist_for_each_entry(rule, &hw->fdir_list_head, fltr_node) {\n\t\t \n\t\tif (fltr_idx == rule->fltr_id)\n\t\t\treturn rule;\n\t\tif (fltr_idx < rule->fltr_id)\n\t\t\tbreak;\n\t}\n\treturn NULL;\n}\n\n \nvoid ice_fdir_list_add_fltr(struct ice_hw *hw, struct ice_fdir_fltr *fltr)\n{\n\tstruct ice_fdir_fltr *rule, *parent = NULL;\n\n\tlist_for_each_entry(rule, &hw->fdir_list_head, fltr_node) {\n\t\t \n\t\tif (rule->fltr_id >= fltr->fltr_id)\n\t\t\tbreak;\n\t\tparent = rule;\n\t}\n\n\tif (parent)\n\t\tlist_add(&fltr->fltr_node, &parent->fltr_node);\n\telse\n\t\tlist_add(&fltr->fltr_node, &hw->fdir_list_head);\n}\n\n \nvoid\nice_fdir_update_cntrs(struct ice_hw *hw, enum ice_fltr_ptype flow, bool add)\n{\n\tint incr;\n\n\tincr = add ? 1 : -1;\n\thw->fdir_active_fltr += incr;\n\n\tif (flow == ICE_FLTR_PTYPE_NONF_NONE || flow >= ICE_FLTR_PTYPE_MAX)\n\t\tice_debug(hw, ICE_DBG_SW, \"Unknown filter type %d\\n\", flow);\n\telse\n\t\thw->fdir_fltr_cnt[flow] += incr;\n}\n\n \nstatic int ice_cmp_ipv6_addr(__be32 *a, __be32 *b)\n{\n\treturn memcmp(a, b, 4 * sizeof(__be32));\n}\n\n \nstatic bool\nice_fdir_comp_rules(struct ice_fdir_fltr *a,  struct ice_fdir_fltr *b, bool v6)\n{\n\tenum ice_fltr_ptype flow_type = a->flow_type;\n\n\t \n\tif (!v6) {\n\t\tif (flow_type == ICE_FLTR_PTYPE_NONF_IPV4_TCP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV4_UDP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV4_SCTP) {\n\t\t\tif (a->ip.v4.dst_ip == b->ip.v4.dst_ip &&\n\t\t\t    a->ip.v4.src_ip == b->ip.v4.src_ip &&\n\t\t\t    a->ip.v4.dst_port == b->ip.v4.dst_port &&\n\t\t\t    a->ip.v4.src_port == b->ip.v4.src_port)\n\t\t\t\treturn true;\n\t\t} else if (flow_type == ICE_FLTR_PTYPE_NONF_IPV4_OTHER) {\n\t\t\tif (a->ip.v4.dst_ip == b->ip.v4.dst_ip &&\n\t\t\t    a->ip.v4.src_ip == b->ip.v4.src_ip &&\n\t\t\t    a->ip.v4.l4_header == b->ip.v4.l4_header &&\n\t\t\t    a->ip.v4.proto == b->ip.v4.proto &&\n\t\t\t    a->ip.v4.ip_ver == b->ip.v4.ip_ver &&\n\t\t\t    a->ip.v4.tos == b->ip.v4.tos)\n\t\t\t\treturn true;\n\t\t}\n\t} else {\n\t\tif (flow_type == ICE_FLTR_PTYPE_NONF_IPV6_UDP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV6_TCP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV6_SCTP) {\n\t\t\tif (a->ip.v6.dst_port == b->ip.v6.dst_port &&\n\t\t\t    a->ip.v6.src_port == b->ip.v6.src_port &&\n\t\t\t    !ice_cmp_ipv6_addr(a->ip.v6.dst_ip,\n\t\t\t\t\t       b->ip.v6.dst_ip) &&\n\t\t\t    !ice_cmp_ipv6_addr(a->ip.v6.src_ip,\n\t\t\t\t\t       b->ip.v6.src_ip))\n\t\t\t\treturn true;\n\t\t} else if (flow_type == ICE_FLTR_PTYPE_NONF_IPV6_OTHER) {\n\t\t\tif (a->ip.v6.dst_port == b->ip.v6.dst_port &&\n\t\t\t    a->ip.v6.src_port == b->ip.v6.src_port)\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\n \nbool ice_fdir_is_dup_fltr(struct ice_hw *hw, struct ice_fdir_fltr *input)\n{\n\tstruct ice_fdir_fltr *rule;\n\tbool ret = false;\n\n\tlist_for_each_entry(rule, &hw->fdir_list_head, fltr_node) {\n\t\tenum ice_fltr_ptype flow_type;\n\n\t\tif (rule->flow_type != input->flow_type)\n\t\t\tcontinue;\n\n\t\tflow_type = input->flow_type;\n\t\tif (flow_type == ICE_FLTR_PTYPE_NONF_IPV4_TCP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV4_UDP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV4_SCTP ||\n\t\t    flow_type == ICE_FLTR_PTYPE_NONF_IPV4_OTHER)\n\t\t\tret = ice_fdir_comp_rules(rule, input, false);\n\t\telse\n\t\t\tret = ice_fdir_comp_rules(rule, input, true);\n\t\tif (ret) {\n\t\t\tif (rule->fltr_id == input->fltr_id &&\n\t\t\t    rule->q_index != input->q_index)\n\t\t\t\tret = false;\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}