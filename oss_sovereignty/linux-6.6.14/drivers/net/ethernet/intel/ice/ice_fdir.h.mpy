{
  "module_name": "ice_fdir.h",
  "hash_id": "e66f4146ed1a84fbcbb77a2fcc3afb5440d287280c3cf40abfe72e75f67177f5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/ice/ice_fdir.h",
  "human_readable_source": " \n \n\n#ifndef _ICE_FDIR_H_\n#define _ICE_FDIR_H_\n\n#define ICE_FDIR_TUN_PKT_OFF\t\t50\n#define ICE_FDIR_MAX_RAW_PKT_SIZE\t(512 + ICE_FDIR_TUN_PKT_OFF)\n\n \n#define ICE_IPV4_SRC_ADDR_OFFSET\t26\n#define ICE_IPV4_DST_ADDR_OFFSET\t30\n#define ICE_IPV4_TCP_SRC_PORT_OFFSET\t34\n#define ICE_IPV4_TCP_DST_PORT_OFFSET\t36\n#define ICE_IPV4_UDP_SRC_PORT_OFFSET\t34\n#define ICE_IPV4_UDP_DST_PORT_OFFSET\t36\n#define ICE_IPV4_SCTP_SRC_PORT_OFFSET\t34\n#define ICE_IPV4_SCTP_DST_PORT_OFFSET\t36\n#define ICE_IPV4_PROTO_OFFSET\t\t23\n#define ICE_IPV6_SRC_ADDR_OFFSET\t22\n#define ICE_IPV6_DST_ADDR_OFFSET\t38\n#define ICE_IPV6_TCP_SRC_PORT_OFFSET\t54\n#define ICE_IPV6_TCP_DST_PORT_OFFSET\t56\n#define ICE_IPV6_UDP_SRC_PORT_OFFSET\t54\n#define ICE_IPV6_UDP_DST_PORT_OFFSET\t56\n#define ICE_IPV6_SCTP_SRC_PORT_OFFSET\t54\n#define ICE_IPV6_SCTP_DST_PORT_OFFSET\t56\n#define ICE_MAC_ETHTYPE_OFFSET\t\t12\n#define ICE_IPV4_TOS_OFFSET\t\t15\n#define ICE_IPV4_TTL_OFFSET\t\t22\n#define ICE_IPV6_TC_OFFSET\t\t14\n#define ICE_IPV6_HLIM_OFFSET\t\t21\n#define ICE_IPV6_PROTO_OFFSET\t\t20\n#define ICE_IPV4_GTPU_TEID_OFFSET\t46\n#define ICE_IPV4_GTPU_QFI_OFFSET\t56\n#define ICE_IPV4_L2TPV3_SESS_ID_OFFSET\t34\n#define ICE_IPV6_L2TPV3_SESS_ID_OFFSET\t54\n#define ICE_IPV4_ESP_SPI_OFFSET\t\t34\n#define ICE_IPV6_ESP_SPI_OFFSET\t\t54\n#define ICE_IPV4_AH_SPI_OFFSET\t\t38\n#define ICE_IPV6_AH_SPI_OFFSET\t\t58\n#define ICE_IPV4_NAT_T_ESP_SPI_OFFSET\t42\n#define ICE_IPV6_NAT_T_ESP_SPI_OFFSET\t62\n\n#define ICE_FDIR_MAX_FLTRS\t\t16384\n\n \n#define ICE_FDIR_IPV4_PKT_FLAG_MF\t\t0x20\n\nenum ice_fltr_prgm_desc_dest {\n\tICE_FLTR_PRGM_DESC_DEST_DROP_PKT,\n\tICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_QINDEX,\n\tICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_QGROUP,\n\tICE_FLTR_PRGM_DESC_DEST_DIRECT_PKT_OTHER,\n};\n\nenum ice_fltr_prgm_desc_fd_status {\n\tICE_FLTR_PRGM_DESC_FD_STATUS_NONE,\n\tICE_FLTR_PRGM_DESC_FD_STATUS_FD_ID,\n};\n\n \nstruct ice_fd_fltr_desc_ctx {\n\tu32 fdid;\n\tu16 qindex;\n\tu16 cnt_index;\n\tu16 fd_vsi;\n\tu16 flex_val;\n\tu8 comp_q;\n\tu8 comp_report;\n\tu8 fd_space;\n\tu8 cnt_ena;\n\tu8 evict_ena;\n\tu8 toq;\n\tu8 toq_prio;\n\tu8 dpu_recipe;\n\tu8 drop;\n\tu8 flex_prio;\n\tu8 flex_mdid;\n\tu8 dtype;\n\tu8 pcmd;\n\tu8 desc_prof_prio;\n\tu8 desc_prof;\n\tu8 swap;\n\tu8 fdid_prio;\n\tu8 fdid_mdid;\n};\n\n#define ICE_FLTR_PRGM_FLEX_WORD_SIZE\tsizeof(__be16)\n\nstruct ice_rx_flow_userdef {\n\tu16 flex_word;\n\tu16 flex_offset;\n\tu16 flex_fltr;\n};\n\nstruct ice_fdir_v4 {\n\t__be32 dst_ip;\n\t__be32 src_ip;\n\t__be16 dst_port;\n\t__be16 src_port;\n\t__be32 l4_header;\n\t__be32 sec_parm_idx;\t \n\tu8 tos;\n\tu8 ip_ver;\n\tu8 proto;\n\tu8 ttl;\n};\n\n#define ICE_IPV6_ADDR_LEN_AS_U32\t\t4\n\nstruct ice_fdir_v6 {\n\t__be32 dst_ip[ICE_IPV6_ADDR_LEN_AS_U32];\n\t__be32 src_ip[ICE_IPV6_ADDR_LEN_AS_U32];\n\t__be16 dst_port;\n\t__be16 src_port;\n\t__be32 l4_header;  \n\t__be32 sec_parm_idx;  \n\tu8 tc;\n\tu8 proto;\n\tu8 hlim;\n};\n\nstruct ice_fdir_udp_gtp {\n\tu8 flags;\n\tu8 msg_type;\n\t__be16 rsrvd_len;\n\t__be32 teid;\n\t__be16 rsrvd_seq_nbr;\n\tu8 rsrvd_n_pdu_nbr;\n\tu8 rsrvd_next_ext_type;\n\tu8 rsvrd_ext_len;\n\tu8\tpdu_type:4,\n\t\tspare:4;\n\tu8\tppp:1,\n\t\trqi:1,\n\t\tqfi:6;\n\tu32 rsvrd;\n\tu8 next_ext;\n};\n\nstruct ice_fdir_l2tpv3 {\n\t__be32 session_id;\n};\n\nstruct ice_fdir_extra {\n\tu8 dst_mac[ETH_ALEN];\t \n\tu8 src_mac[ETH_ALEN];\t \n\t__be16 ether_type;\t \n\tu32 usr_def[2];\t\t \n\t__be16 vlan_type;\t \n\t__be16 vlan_tag;\t \n};\n\nstruct ice_fdir_fltr {\n\tstruct list_head fltr_node;\n\tenum ice_fltr_ptype flow_type;\n\n\tunion {\n\t\tstruct ice_fdir_v4 v4;\n\t\tstruct ice_fdir_v6 v6;\n\t} ip, mask;\n\n\tstruct ice_fdir_udp_gtp gtpu_data;\n\tstruct ice_fdir_udp_gtp gtpu_mask;\n\n\tstruct ice_fdir_l2tpv3 l2tpv3_data;\n\tstruct ice_fdir_l2tpv3 l2tpv3_mask;\n\n\tstruct ice_fdir_extra ext_data;\n\tstruct ice_fdir_extra ext_mask;\n\n\t \n\t__be16 flex_word;\n\t \n\tu8 q_region;\n\tu16 flex_offset;\n\tu16 flex_fltr;\n\n\t \n\tu16 q_index;\n\tu16 orig_q_index;\n\tu16 dest_vsi;\n\tu8 dest_ctl;\n\tu8 cnt_ena;\n\tu8 fltr_status;\n\tu16 cnt_index;\n\tu32 fltr_id;\n\tu8 fdid_prio;\n\tu8 comp_report;\n};\n\n \nstruct ice_fdir_base_pkt {\n\tenum ice_fltr_ptype flow;\n\tu16 pkt_len;\n\tconst u8 *pkt;\n\tu16 tun_pkt_len;\n\tconst u8 *tun_pkt;\n};\n\nint ice_alloc_fd_res_cntr(struct ice_hw *hw, u16 *cntr_id);\nint ice_free_fd_res_cntr(struct ice_hw *hw, u16 cntr_id);\nint ice_alloc_fd_guar_item(struct ice_hw *hw, u16 *cntr_id, u16 num_fltr);\nint ice_alloc_fd_shrd_item(struct ice_hw *hw, u16 *cntr_id, u16 num_fltr);\nvoid\nice_fdir_get_prgm_desc(struct ice_hw *hw, struct ice_fdir_fltr *input,\n\t\t       struct ice_fltr_desc *fdesc, bool add);\nint\nice_fdir_get_gen_prgm_pkt(struct ice_hw *hw, struct ice_fdir_fltr *input,\n\t\t\t  u8 *pkt, bool frag, bool tun);\nint ice_get_fdir_cnt_all(struct ice_hw *hw);\nbool ice_fdir_is_dup_fltr(struct ice_hw *hw, struct ice_fdir_fltr *input);\nbool ice_fdir_has_frag(enum ice_fltr_ptype flow);\nstruct ice_fdir_fltr *\nice_fdir_find_fltr_by_idx(struct ice_hw *hw, u32 fltr_idx);\nvoid\nice_fdir_update_cntrs(struct ice_hw *hw, enum ice_fltr_ptype flow, bool add);\nvoid ice_fdir_list_add_fltr(struct ice_hw *hw, struct ice_fdir_fltr *input);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}