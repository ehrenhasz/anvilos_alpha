{
  "module_name": "ice_protocol_type.h",
  "hash_id": "e8c49ddd2dca252be10d082e51a6cff28445f64c860fd331382ea4a71e92f343",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/intel/ice/ice_protocol_type.h",
  "human_readable_source": " \n \n\n#ifndef _ICE_PROTOCOL_TYPE_H_\n#define _ICE_PROTOCOL_TYPE_H_\n#define ICE_IPV6_ADDR_LENGTH 16\n\n \n#define ICE_NUM_WORDS_RECIPE 4\n\n \n#define ICE_MAX_CHAIN_RECIPE 5\n\n \n#define ICE_MAX_CHAIN_WORDS (ICE_NUM_WORDS_RECIPE * ICE_MAX_CHAIN_RECIPE)\n\n \n#define ICE_CHAIN_FV_INDEX_START 47\n\nenum ice_protocol_type {\n\tICE_MAC_OFOS = 0,\n\tICE_MAC_IL,\n\tICE_ETYPE_OL,\n\tICE_ETYPE_IL,\n\tICE_VLAN_OFOS,\n\tICE_IPV4_OFOS,\n\tICE_IPV4_IL,\n\tICE_IPV6_OFOS,\n\tICE_IPV6_IL,\n\tICE_TCP_IL,\n\tICE_UDP_OF,\n\tICE_UDP_ILOS,\n\tICE_VXLAN,\n\tICE_GENEVE,\n\tICE_NVGRE,\n\tICE_GTP,\n\tICE_GTP_NO_PAY,\n\tICE_PPPOE,\n\tICE_L2TPV3,\n\tICE_VLAN_EX,\n\tICE_VLAN_IN,\n\tICE_HW_METADATA,\n\tICE_VXLAN_GPE,\n\tICE_SCTP_IL,\n\tICE_PROTOCOL_LAST\n};\n\nenum ice_sw_tunnel_type {\n\tICE_NON_TUN = 0,\n\tICE_SW_TUN_AND_NON_TUN,\n\tICE_SW_TUN_VXLAN,\n\tICE_SW_TUN_GENEVE,\n\tICE_SW_TUN_NVGRE,\n\tICE_SW_TUN_GTPU,\n\tICE_SW_TUN_GTPC,\n\tICE_ALL_TUNNELS  \n};\n\n \nenum ice_prot_id {\n\tICE_PROT_ID_INVAL\t= 0,\n\tICE_PROT_MAC_OF_OR_S\t= 1,\n\tICE_PROT_MAC_IL\t\t= 4,\n\tICE_PROT_ETYPE_OL\t= 9,\n\tICE_PROT_ETYPE_IL\t= 10,\n\tICE_PROT_IPV4_OF_OR_S\t= 32,\n\tICE_PROT_IPV4_IL\t= 33,\n\tICE_PROT_IPV6_OF_OR_S\t= 40,\n\tICE_PROT_IPV6_IL\t= 41,\n\tICE_PROT_TCP_IL\t\t= 49,\n\tICE_PROT_UDP_OF\t\t= 52,\n\tICE_PROT_UDP_IL_OR_S\t= 53,\n\tICE_PROT_GRE_OF\t\t= 64,\n\tICE_PROT_ESP_F\t\t= 88,\n\tICE_PROT_ESP_2\t\t= 89,\n\tICE_PROT_SCTP_IL\t= 96,\n\tICE_PROT_ICMP_IL\t= 98,\n\tICE_PROT_ICMPV6_IL\t= 100,\n\tICE_PROT_PPPOE\t\t= 103,\n\tICE_PROT_L2TPV3\t\t= 104,\n\tICE_PROT_ARP_OF\t\t= 118,\n\tICE_PROT_META_ID\t= 255,  \n\tICE_PROT_INVALID\t= 255   \n};\n\n#define ICE_VNI_OFFSET\t\t12  \n\n#define ICE_MAC_OFOS_HW\t\t1\n#define ICE_MAC_IL_HW\t\t4\n#define ICE_ETYPE_OL_HW\t\t9\n#define ICE_ETYPE_IL_HW\t\t10\n#define ICE_VLAN_OF_HW\t\t16\n#define ICE_VLAN_OL_HW\t\t17\n#define ICE_IPV4_OFOS_HW\t32\n#define ICE_IPV4_IL_HW\t\t33\n#define ICE_IPV6_OFOS_HW\t40\n#define ICE_IPV6_IL_HW\t\t41\n#define ICE_TCP_IL_HW\t\t49\n#define ICE_UDP_ILOS_HW\t\t53\n#define ICE_GRE_OF_HW\t\t64\n#define ICE_PPPOE_HW\t\t103\n#define ICE_L2TPV3_HW\t\t104\n\n#define ICE_UDP_OF_HW\t52  \n\n\n#define ICE_TUN_FLAG_FV_IND 2\n\n \nstruct ice_protocol_entry {\n\tenum ice_protocol_type type;\n\tu8 protocol_id;\n};\n\nstruct ice_ether_hdr {\n\tu8 dst_addr[ETH_ALEN];\n\tu8 src_addr[ETH_ALEN];\n};\n\nstruct ice_ethtype_hdr {\n\t__be16 ethtype_id;\n};\n\nstruct ice_ether_vlan_hdr {\n\tu8 dst_addr[ETH_ALEN];\n\tu8 src_addr[ETH_ALEN];\n\t__be32 vlan_id;\n};\n\nstruct ice_vlan_hdr {\n\t__be16 type;\n\t__be16 vlan;\n};\n\nstruct ice_ipv4_hdr {\n\tu8 version;\n\tu8 tos;\n\t__be16 total_length;\n\t__be16 id;\n\t__be16 frag_off;\n\tu8 time_to_live;\n\tu8 protocol;\n\t__be16 check;\n\t__be32 src_addr;\n\t__be32 dst_addr;\n};\n\nstruct ice_ipv6_hdr {\n\t__be32 be_ver_tc_flow;\n\t__be16 payload_len;\n\tu8 next_hdr;\n\tu8 hop_limit;\n\tu8 src_addr[ICE_IPV6_ADDR_LENGTH];\n\tu8 dst_addr[ICE_IPV6_ADDR_LENGTH];\n};\n\nstruct ice_sctp_hdr {\n\t__be16 src_port;\n\t__be16 dst_port;\n\t__be32 verification_tag;\n\t__be32 check;\n};\n\nstruct ice_l4_hdr {\n\t__be16 src_port;\n\t__be16 dst_port;\n\t__be16 len;\n\t__be16 check;\n};\n\nstruct ice_udp_tnl_hdr {\n\t__be16 field;\n\t__be16 proto_type;\n\t__be32 vni;      \n};\n\nstruct ice_udp_gtp_hdr {\n\tu8 flags;\n\tu8 msg_type;\n\t__be16 rsrvd_len;\n\t__be32 teid;\n\t__be16 rsrvd_seq_nbr;\n\tu8 rsrvd_n_pdu_nbr;\n\tu8 rsrvd_next_ext;\n\tu8 rsvrd_ext_len;\n\tu8 pdu_type;\n\tu8 qfi;\n\tu8 rsvrd;\n};\n\nstruct ice_pppoe_hdr {\n\tu8 rsrvd_ver_type;\n\tu8 rsrvd_code;\n\t__be16 session_id;\n\t__be16 length;\n\t__be16 ppp_prot_id;  \n};\n\nstruct ice_l2tpv3_sess_hdr {\n\t__be32 session_id;\n\t__be64 cookie;\n};\n\nstruct ice_nvgre_hdr {\n\t__be16 flags;\n\t__be16 protocol;\n\t__be32 tni_flow;\n};\n\n \n#define ICE_MDID_SOURCE_VSI_MASK GENMASK(9, 0)\n\n \n#define ICE_PKT_FROM_NETWORK\tBIT(3)\n#define ICE_PKT_VLAN_STAG\tBIT(12)\n#define ICE_PKT_VLAN_ITAG\tBIT(13)\n#define ICE_PKT_VLAN_EVLAN\t(BIT(14) | BIT(15))\n#define ICE_PKT_VLAN_MASK\t(ICE_PKT_VLAN_STAG | ICE_PKT_VLAN_ITAG | \\\n\t\t\t\tICE_PKT_VLAN_EVLAN)\n \n#define ICE_PKT_TUNNEL_MAC\tBIT(6)\n#define ICE_PKT_TUNNEL_VLAN\tBIT(7)\n#define ICE_PKT_TUNNEL_MASK\t(ICE_PKT_TUNNEL_MAC | ICE_PKT_TUNNEL_VLAN)\n\n \n#define ICE_MDID_SIZE 2\n#define ICE_META_DATA_ID_HW 255\n\nenum ice_hw_metadata_id {\n\tICE_SOURCE_PORT_MDID = 16,\n\tICE_PTYPE_MDID = 17,\n\tICE_PACKET_LENGTH_MDID = 18,\n\tICE_SOURCE_VSI_MDID = 19,\n\tICE_PKT_VLAN_MDID = 20,\n\tICE_PKT_TUNNEL_MDID = 21,\n\tICE_PKT_TCP_MDID = 22,\n\tICE_PKT_ERROR_MDID = 23,\n};\n\nenum ice_hw_metadata_offset {\n\tICE_SOURCE_PORT_MDID_OFFSET = ICE_MDID_SIZE * ICE_SOURCE_PORT_MDID,\n\tICE_PTYPE_MDID_OFFSET = ICE_MDID_SIZE * ICE_PTYPE_MDID,\n\tICE_PACKET_LENGTH_MDID_OFFSET = ICE_MDID_SIZE * ICE_PACKET_LENGTH_MDID,\n\tICE_SOURCE_VSI_MDID_OFFSET = ICE_MDID_SIZE * ICE_SOURCE_VSI_MDID,\n\tICE_PKT_VLAN_MDID_OFFSET = ICE_MDID_SIZE * ICE_PKT_VLAN_MDID,\n\tICE_PKT_TUNNEL_MDID_OFFSET = ICE_MDID_SIZE * ICE_PKT_TUNNEL_MDID,\n\tICE_PKT_TCP_MDID_OFFSET = ICE_MDID_SIZE * ICE_PKT_TCP_MDID,\n\tICE_PKT_ERROR_MDID_OFFSET = ICE_MDID_SIZE * ICE_PKT_ERROR_MDID,\n};\n\nenum ice_pkt_flags {\n\tICE_PKT_FLAGS_MDID20 = 0,\n\tICE_PKT_FLAGS_MDID21 = 1,\n\tICE_PKT_FLAGS_MDID22 = 2,\n\tICE_PKT_FLAGS_MDID23 = 3,\n};\n\nstruct ice_hw_metadata {\n\t__be16 source_port;\n\t__be16 ptype;\n\t__be16 packet_length;\n\t__be16 source_vsi;\n\t__be16 flags[4];\n};\n\nunion ice_prot_hdr {\n\tstruct ice_ether_hdr eth_hdr;\n\tstruct ice_ethtype_hdr ethertype;\n\tstruct ice_vlan_hdr vlan_hdr;\n\tstruct ice_ipv4_hdr ipv4_hdr;\n\tstruct ice_ipv6_hdr ipv6_hdr;\n\tstruct ice_l4_hdr l4_hdr;\n\tstruct ice_sctp_hdr sctp_hdr;\n\tstruct ice_udp_tnl_hdr tnl_hdr;\n\tstruct ice_nvgre_hdr nvgre_hdr;\n\tstruct ice_udp_gtp_hdr gtp_hdr;\n\tstruct ice_pppoe_hdr pppoe_hdr;\n\tstruct ice_l2tpv3_sess_hdr l2tpv3_sess_hdr;\n\tstruct ice_hw_metadata metadata;\n};\n\n \nstruct ice_prot_ext_tbl_entry {\n\tenum ice_protocol_type prot_type;\n\t \n\tu8 offs[sizeof(union ice_prot_hdr)];\n};\n\n \nstruct ice_prot_lkup_ext {\n\tu16 prot_type;\n\tu8 n_val_words;\n\t \n\tu16 field_off[ICE_MAX_CHAIN_WORDS];\n\tu16 field_mask[ICE_MAX_CHAIN_WORDS];\n\n\tstruct ice_fv_word fv_words[ICE_MAX_CHAIN_WORDS];\n\n\t \n\tDECLARE_BITMAP(done, ICE_MAX_CHAIN_WORDS);\n};\n\nstruct ice_pref_recipe_group {\n\tu8 n_val_pairs;\t\t \n\tstruct ice_fv_word pairs[ICE_NUM_WORDS_RECIPE];\n\tu16 mask[ICE_NUM_WORDS_RECIPE];\n};\n\nstruct ice_recp_grp_entry {\n\tstruct list_head l_entry;\n\n#define ICE_INVAL_CHAIN_IND 0xFF\n\tu16 rid;\n\tu8 chain_idx;\n\tu16 fv_idx[ICE_NUM_WORDS_RECIPE];\n\tu16 fv_mask[ICE_NUM_WORDS_RECIPE];\n\tstruct ice_pref_recipe_group r_group;\n};\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}