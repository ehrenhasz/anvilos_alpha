{
  "module_name": "aq_macsec.h",
  "hash_id": "14d3bae40632589b60b2142a6d5e946e763fa18e53683b5a85f80e42827fe55f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/aquantia/atlantic/aq_macsec.h",
  "human_readable_source": " \n \n\n#ifndef AQ_MACSEC_H\n#define AQ_MACSEC_H\n\n#include <linux/netdevice.h>\n#if IS_ENABLED(CONFIG_MACSEC)\n\n#include \"net/macsec.h\"\n\nstruct aq_nic_s;\n\n#define AQ_MACSEC_MAX_SC 32\n#define AQ_MACSEC_MAX_SA 32\n\nenum aq_macsec_sc_sa {\n\taq_macsec_sa_sc_4sa_8sc,\n\taq_macsec_sa_sc_not_used,\n\taq_macsec_sa_sc_2sa_16sc,\n\taq_macsec_sa_sc_1sa_32sc,\n};\n\nstruct aq_macsec_common_stats {\n\t \n\tstruct {\n\t\tu64 ctl_pkts;\n\t\tu64 tagged_miss_pkts;\n\t\tu64 untagged_miss_pkts;\n\t\tu64 notag_pkts;\n\t\tu64 untagged_pkts;\n\t\tu64 bad_tag_pkts;\n\t\tu64 no_sci_pkts;\n\t\tu64 unknown_sci_pkts;\n\t\tu64 ctrl_prt_pass_pkts;\n\t\tu64 unctrl_prt_pass_pkts;\n\t\tu64 ctrl_prt_fail_pkts;\n\t\tu64 unctrl_prt_fail_pkts;\n\t\tu64 too_long_pkts;\n\t\tu64 igpoc_ctl_pkts;\n\t\tu64 ecc_error_pkts;\n\t\tu64 unctrl_hit_drop_redir;\n\t} in;\n\n\t \n\tstruct {\n\t\tu64 ctl_pkts;\n\t\tu64 unknown_sa_pkts;\n\t\tu64 untagged_pkts;\n\t\tu64 too_long;\n\t\tu64 ecc_error_pkts;\n\t\tu64 unctrl_hit_drop_redir;\n\t} out;\n};\n\n \nstruct aq_macsec_rx_sa_stats {\n\tu64 untagged_hit_pkts;\n\tu64 ctrl_hit_drop_redir_pkts;\n\tu64 not_using_sa;\n\tu64 unused_sa;\n\tu64 not_valid_pkts;\n\tu64 invalid_pkts;\n\tu64 ok_pkts;\n\tu64 late_pkts;\n\tu64 delayed_pkts;\n\tu64 unchecked_pkts;\n\tu64 validated_octets;\n\tu64 decrypted_octets;\n};\n\n \nstruct aq_macsec_tx_sa_stats {\n\tu64 sa_hit_drop_redirect;\n\tu64 sa_protected2_pkts;\n\tu64 sa_protected_pkts;\n\tu64 sa_encrypted_pkts;\n};\n\n \nstruct aq_macsec_tx_sc_stats {\n\tu64 sc_protected_pkts;\n\tu64 sc_encrypted_pkts;\n\tu64 sc_protected_octets;\n\tu64 sc_encrypted_octets;\n};\n\nstruct aq_macsec_txsc {\n\tu32 hw_sc_idx;\n\tunsigned long tx_sa_idx_busy;\n\tconst struct macsec_secy *sw_secy;\n\tu8 tx_sa_key[MACSEC_NUM_AN][MACSEC_MAX_KEY_LEN];\n\tstruct aq_macsec_tx_sc_stats stats;\n\tstruct aq_macsec_tx_sa_stats tx_sa_stats[MACSEC_NUM_AN];\n};\n\nstruct aq_macsec_rxsc {\n\tu32 hw_sc_idx;\n\tunsigned long rx_sa_idx_busy;\n\tconst struct macsec_secy *sw_secy;\n\tconst struct macsec_rx_sc *sw_rxsc;\n\tu8 rx_sa_key[MACSEC_NUM_AN][MACSEC_MAX_KEY_LEN];\n\tstruct aq_macsec_rx_sa_stats rx_sa_stats[MACSEC_NUM_AN];\n};\n\nstruct aq_macsec_cfg {\n\tenum aq_macsec_sc_sa sc_sa;\n\t \n\tunsigned long txsc_idx_busy;\n\tstruct aq_macsec_txsc aq_txsc[AQ_MACSEC_MAX_SC];\n\t \n\tunsigned long rxsc_idx_busy;\n\tstruct aq_macsec_rxsc aq_rxsc[AQ_MACSEC_MAX_SC];\n\t \n\tstruct aq_macsec_common_stats stats;\n};\n\nextern const struct macsec_ops aq_macsec_ops;\n\nint aq_macsec_init(struct aq_nic_s *nic);\nvoid aq_macsec_free(struct aq_nic_s *nic);\nint aq_macsec_enable(struct aq_nic_s *nic);\nvoid aq_macsec_work(struct aq_nic_s *nic);\nu64 *aq_macsec_get_stats(struct aq_nic_s *nic, u64 *data);\nint aq_macsec_rx_sa_cnt(struct aq_nic_s *nic);\nint aq_macsec_tx_sc_cnt(struct aq_nic_s *nic);\nint aq_macsec_tx_sa_cnt(struct aq_nic_s *nic);\n\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}