{
  "module_name": "aq_hw.h",
  "hash_id": "12629194fc1b00b39672b69be2c74eab27167af53c26ef1e0ce60e34a6b48be9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/aquantia/atlantic/aq_hw.h",
  "human_readable_source": " \n \n\n \n\n#ifndef AQ_HW_H\n#define AQ_HW_H\n\n#include \"aq_common.h\"\n#include \"aq_rss.h\"\n#include \"hw_atl/hw_atl_utils.h\"\n\n#define AQ_HW_MAC_COUNTER_HZ   312500000ll\n#define AQ_HW_PHY_COUNTER_HZ   160000000ll\n\nenum aq_tc_mode {\n\tAQ_TC_MODE_INVALID = -1,\n\tAQ_TC_MODE_8TCS,\n\tAQ_TC_MODE_4TCS,\n};\n\n#define AQ_RX_FIRST_LOC_FVLANID     0U\n#define AQ_RX_LAST_LOC_FVLANID\t   15U\n#define AQ_RX_FIRST_LOC_FETHERT    16U\n#define AQ_RX_LAST_LOC_FETHERT\t   31U\n#define AQ_RX_FIRST_LOC_FL3L4\t   32U\n#define AQ_RX_LAST_LOC_FL3L4\t   39U\n#define AQ_RX_MAX_RXNFC_LOC\t   AQ_RX_LAST_LOC_FL3L4\n#define AQ_VLAN_MAX_FILTERS   \\\n\t\t\t(AQ_RX_LAST_LOC_FVLANID - AQ_RX_FIRST_LOC_FVLANID + 1U)\n#define AQ_RX_QUEUE_NOT_ASSIGNED   0xFFU\n\n#define AQ_FRAC_PER_NS 0x100000000LL\n\n \n#define AQ_MBPS_DIVISOR         125000  \n\n \nstruct aq_hw_caps_s {\n\tu64 hw_features;\n\tu64 link_speed_msk;\n\tunsigned int hw_priv_flags;\n\tu32 media_type;\n\tu32 rxds_max;\n\tu32 txds_max;\n\tu32 rxds_min;\n\tu32 txds_min;\n\tu32 txhwb_alignment;\n\tu32 irq_mask;\n\tu32 vecs;\n\tu32 mtu;\n\tu32 mac_regs_count;\n\tu32 hw_alive_check_addr;\n\tu8 msix_irqs;\n\tu8 tcs_max;\n\tu8 rxd_alignment;\n\tu8 rxd_size;\n\tu8 txd_alignment;\n\tu8 txd_size;\n\tu8 tx_rings;\n\tu8 rx_rings;\n\tbool flow_control;\n\tbool is_64_dma;\n\tbool op64bit;\n\tu32 quirks;\n\tu32 priv_data_len;\n};\n\nstruct aq_hw_link_status_s {\n\tunsigned int mbps;\n\tbool full_duplex;\n\tu32 lp_link_speed_msk;\n\tu32 lp_flow_control;\n};\n\nstruct aq_stats_s {\n\tu64 brc;\n\tu64 btc;\n\tu64 uprc;\n\tu64 mprc;\n\tu64 bprc;\n\tu64 erpt;\n\tu64 uptc;\n\tu64 mptc;\n\tu64 bptc;\n\tu64 erpr;\n\tu64 mbtc;\n\tu64 bbtc;\n\tu64 mbrc;\n\tu64 bbrc;\n\tu64 ubrc;\n\tu64 ubtc;\n\tu64 dpc;\n\tu64 dma_pkt_rc;\n\tu64 dma_pkt_tc;\n\tu64 dma_oct_rc;\n\tu64 dma_oct_tc;\n};\n\n#define AQ_HW_IRQ_INVALID 0U\n#define AQ_HW_IRQ_LEGACY  1U\n#define AQ_HW_IRQ_MSI     2U\n#define AQ_HW_IRQ_MSIX    3U\n\n#define AQ_HW_SERVICE_IRQS   1U\n\n#define AQ_HW_POWER_STATE_D0   0U\n#define AQ_HW_POWER_STATE_D3   3U\n\n#define AQ_HW_FLAG_STARTED     0x00000004U\n#define AQ_HW_FLAG_STOPPING    0x00000008U\n#define AQ_HW_FLAG_RESETTING   0x00000010U\n#define AQ_HW_FLAG_CLOSING     0x00000020U\n#define AQ_HW_PTP_AVAILABLE    0x01000000U\n#define AQ_HW_LINK_DOWN        0x04000000U\n#define AQ_HW_FLAG_ERR_UNPLUG  0x40000000U\n#define AQ_HW_FLAG_ERR_HW      0x80000000U\n\n#define AQ_HW_FLAG_ERRORS      (AQ_HW_FLAG_ERR_HW | AQ_HW_FLAG_ERR_UNPLUG)\n\n#define AQ_NIC_FLAGS_IS_NOT_READY (AQ_NIC_FLAG_STOPPING | \\\n\t\t\tAQ_NIC_FLAG_RESETTING | AQ_NIC_FLAG_CLOSING | \\\n\t\t\tAQ_NIC_FLAG_ERR_UNPLUG | AQ_NIC_FLAG_ERR_HW)\n\n#define AQ_NIC_FLAGS_IS_NOT_TX_READY (AQ_NIC_FLAGS_IS_NOT_READY | \\\n\t\t\t\t\tAQ_NIC_LINK_DOWN)\n\n#define AQ_HW_MEDIA_TYPE_TP    1U\n#define AQ_HW_MEDIA_TYPE_FIBRE 2U\n\n#define AQ_HW_TXD_MULTIPLE 8U\n#define AQ_HW_RXD_MULTIPLE 8U\n\n#define AQ_HW_QUEUES_MAX                32U\n#define AQ_HW_MULTICAST_ADDRESS_MAX     32U\n\n#define AQ_HW_PTP_TC                    2U\n\n#define AQ_HW_LED_BLINK    0x2U\n#define AQ_HW_LED_DEFAULT  0x0U\n\n#define AQ_HW_MEDIA_DETECT_CNT 6000\n\nenum aq_priv_flags {\n\tAQ_HW_LOOPBACK_DMA_SYS,\n\tAQ_HW_LOOPBACK_PKT_SYS,\n\tAQ_HW_LOOPBACK_DMA_NET,\n\tAQ_HW_LOOPBACK_PHYINT_SYS,\n\tAQ_HW_LOOPBACK_PHYEXT_SYS,\n};\n\n#define AQ_HW_LOOPBACK_MASK\t(BIT(AQ_HW_LOOPBACK_DMA_SYS) |\\\n\t\t\t\t BIT(AQ_HW_LOOPBACK_PKT_SYS) |\\\n\t\t\t\t BIT(AQ_HW_LOOPBACK_DMA_NET) |\\\n\t\t\t\t BIT(AQ_HW_LOOPBACK_PHYINT_SYS) |\\\n\t\t\t\t BIT(AQ_HW_LOOPBACK_PHYEXT_SYS))\n\n#define ATL_HW_CHIP_MIPS         0x00000001U\n#define ATL_HW_CHIP_TPO2         0x00000002U\n#define ATL_HW_CHIP_RPF2         0x00000004U\n#define ATL_HW_CHIP_MPI_AQ       0x00000010U\n#define ATL_HW_CHIP_ATLANTIC     0x00800000U\n#define ATL_HW_CHIP_REVISION_A0  0x01000000U\n#define ATL_HW_CHIP_REVISION_B0  0x02000000U\n#define ATL_HW_CHIP_REVISION_B1  0x04000000U\n#define ATL_HW_CHIP_ANTIGUA      0x08000000U\n\n#define ATL_HW_IS_CHIP_FEATURE(_HW_, _F_) (!!(ATL_HW_CHIP_##_F_ & \\\n\t(_HW_)->chip_features))\n\nstruct aq_hw_s {\n\tatomic_t flags;\n\tu8 rbl_enabled:1;\n\tstruct aq_nic_cfg_s *aq_nic_cfg;\n\tconst struct aq_fw_ops *aq_fw_ops;\n\tvoid __iomem *mmio;\n\tstruct aq_hw_link_status_s aq_link_status;\n\tstruct hw_atl_utils_mbox mbox;\n\tstruct hw_atl_stats_s last_stats;\n\tstruct aq_stats_s curr_stats;\n\tu64 speed;\n\tu32 itr_tx;\n\tu32 itr_rx;\n\tunsigned int chip_features;\n\tu32 fw_ver_actual;\n\tatomic_t dpc;\n\tu32 mbox_addr;\n\tu32 rpc_addr;\n\tu32 settings_addr;\n\tu32 rpc_tid;\n\tstruct hw_atl_utils_fw_rpc rpc;\n\ts64 ptp_clk_offset;\n\tu16 phy_id;\n\tvoid *priv;\n};\n\nstruct aq_ring_s;\nstruct aq_ring_param_s;\nstruct sk_buff;\nstruct aq_rx_filter_l3l4;\n\nstruct aq_hw_ops {\n\n\tint (*hw_ring_tx_xmit)(struct aq_hw_s *self, struct aq_ring_s *aq_ring,\n\t\t\t       unsigned int frags);\n\n\tint (*hw_ring_rx_receive)(struct aq_hw_s *self,\n\t\t\t\t  struct aq_ring_s *aq_ring);\n\n\tint (*hw_ring_rx_fill)(struct aq_hw_s *self, struct aq_ring_s *aq_ring,\n\t\t\t       unsigned int sw_tail_old);\n\n\tint (*hw_ring_tx_head_update)(struct aq_hw_s *self,\n\t\t\t\t      struct aq_ring_s *aq_ring);\n\n\tint (*hw_set_mac_address)(struct aq_hw_s *self, const u8 *mac_addr);\n\n\tint (*hw_soft_reset)(struct aq_hw_s *self);\n\n\tint (*hw_prepare)(struct aq_hw_s *self,\n\t\t\t  const struct aq_fw_ops **fw_ops);\n\n\tint (*hw_reset)(struct aq_hw_s *self);\n\n\tint (*hw_init)(struct aq_hw_s *self, const u8 *mac_addr);\n\n\tint (*hw_start)(struct aq_hw_s *self);\n\n\tint (*hw_stop)(struct aq_hw_s *self);\n\n\tint (*hw_ring_tx_init)(struct aq_hw_s *self, struct aq_ring_s *aq_ring,\n\t\t\t       struct aq_ring_param_s *aq_ring_param);\n\n\tint (*hw_ring_tx_start)(struct aq_hw_s *self,\n\t\t\t\tstruct aq_ring_s *aq_ring);\n\n\tint (*hw_ring_tx_stop)(struct aq_hw_s *self,\n\t\t\t       struct aq_ring_s *aq_ring);\n\n\tint (*hw_ring_rx_init)(struct aq_hw_s *self,\n\t\t\t       struct aq_ring_s *aq_ring,\n\t\t\t       struct aq_ring_param_s *aq_ring_param);\n\n\tint (*hw_ring_rx_start)(struct aq_hw_s *self,\n\t\t\t\tstruct aq_ring_s *aq_ring);\n\n\tint (*hw_ring_rx_stop)(struct aq_hw_s *self,\n\t\t\t       struct aq_ring_s *aq_ring);\n\n\tint (*hw_irq_enable)(struct aq_hw_s *self, u64 mask);\n\n\tint (*hw_irq_disable)(struct aq_hw_s *self, u64 mask);\n\n\tint (*hw_irq_read)(struct aq_hw_s *self, u64 *mask);\n\n\tint (*hw_packet_filter_set)(struct aq_hw_s *self,\n\t\t\t\t    unsigned int packet_filter);\n\n\tint (*hw_filter_l3l4_set)(struct aq_hw_s *self,\n\t\t\t\t  struct aq_rx_filter_l3l4 *data);\n\n\tint (*hw_filter_l3l4_clear)(struct aq_hw_s *self,\n\t\t\t\t    struct aq_rx_filter_l3l4 *data);\n\n\tint (*hw_filter_l2_set)(struct aq_hw_s *self,\n\t\t\t\tstruct aq_rx_filter_l2 *data);\n\n\tint (*hw_filter_l2_clear)(struct aq_hw_s *self,\n\t\t\t\t  struct aq_rx_filter_l2 *data);\n\n\tint (*hw_filter_vlan_set)(struct aq_hw_s *self,\n\t\t\t\t  struct aq_rx_filter_vlan *aq_vlans);\n\n\tint (*hw_filter_vlan_ctrl)(struct aq_hw_s *self, bool enable);\n\n\tint (*hw_multicast_list_set)(struct aq_hw_s *self,\n\t\t\t\t     u8 ar_mac[AQ_HW_MULTICAST_ADDRESS_MAX]\n\t\t\t\t     [ETH_ALEN],\n\t\t\t\t     u32 count);\n\n\tint (*hw_interrupt_moderation_set)(struct aq_hw_s *self);\n\n\tint (*hw_rss_set)(struct aq_hw_s *self,\n\t\t\t  struct aq_rss_parameters *rss_params);\n\n\tint (*hw_rss_hash_set)(struct aq_hw_s *self,\n\t\t\t       struct aq_rss_parameters *rss_params);\n\n\tint (*hw_tc_rate_limit_set)(struct aq_hw_s *self);\n\n\tint (*hw_get_regs)(struct aq_hw_s *self,\n\t\t\t   const struct aq_hw_caps_s *aq_hw_caps,\n\t\t\t   u32 *regs_buff);\n\n\tstruct aq_stats_s *(*hw_get_hw_stats)(struct aq_hw_s *self);\n\n\tu32 (*hw_get_fw_version)(struct aq_hw_s *self);\n\n\tint (*hw_set_offload)(struct aq_hw_s *self,\n\t\t\t      struct aq_nic_cfg_s *aq_nic_cfg);\n\n\tint (*hw_ring_hwts_rx_fill)(struct aq_hw_s *self,\n\t\t\t\t    struct aq_ring_s *aq_ring);\n\n\tint (*hw_ring_hwts_rx_receive)(struct aq_hw_s *self,\n\t\t\t\t       struct aq_ring_s *ring);\n\n\tvoid (*hw_get_ptp_ts)(struct aq_hw_s *self, u64 *stamp);\n\n\tint (*hw_adj_clock_freq)(struct aq_hw_s *self, s32 delta);\n\n\tint (*hw_adj_sys_clock)(struct aq_hw_s *self, s64 delta);\n\n\tint (*hw_set_sys_clock)(struct aq_hw_s *self, u64 time, u64 ts);\n\n\tint (*hw_ts_to_sys_clock)(struct aq_hw_s *self, u64 ts, u64 *time);\n\n\tint (*hw_gpio_pulse)(struct aq_hw_s *self, u32 index, u64 start,\n\t\t\t     u32 period);\n\n\tint (*hw_extts_gpio_enable)(struct aq_hw_s *self, u32 index,\n\t\t\t\t    u32 enable);\n\n\tint (*hw_get_sync_ts)(struct aq_hw_s *self, u64 *ts);\n\n\tu16 (*rx_extract_ts)(struct aq_hw_s *self, u8 *p, unsigned int len,\n\t\t\t     u64 *timestamp);\n\n\tint (*extract_hwts)(struct aq_hw_s *self, u8 *p, unsigned int len,\n\t\t\t    u64 *timestamp);\n\n\tint (*hw_set_fc)(struct aq_hw_s *self, u32 fc, u32 tc);\n\n\tint (*hw_set_loopback)(struct aq_hw_s *self, u32 mode, bool enable);\n\n\tint (*hw_get_mac_temp)(struct aq_hw_s *self, u32 *temp);\n};\n\nstruct aq_fw_ops {\n\tint (*init)(struct aq_hw_s *self);\n\n\tint (*deinit)(struct aq_hw_s *self);\n\n\tint (*reset)(struct aq_hw_s *self);\n\n\tint (*renegotiate)(struct aq_hw_s *self);\n\n\tint (*get_mac_permanent)(struct aq_hw_s *self, u8 *mac);\n\n\tint (*set_link_speed)(struct aq_hw_s *self, u32 speed);\n\n\tint (*set_state)(struct aq_hw_s *self,\n\t\t\t enum hal_atl_utils_fw_state_e state);\n\n\tint (*update_link_status)(struct aq_hw_s *self);\n\n\tint (*update_stats)(struct aq_hw_s *self);\n\n\tint (*get_mac_temp)(struct aq_hw_s *self, int *temp);\n\n\tint (*get_phy_temp)(struct aq_hw_s *self, int *temp);\n\n\tu32 (*get_flow_control)(struct aq_hw_s *self, u32 *fcmode);\n\n\tint (*set_flow_control)(struct aq_hw_s *self);\n\n\tint (*led_control)(struct aq_hw_s *self, u32 mode);\n\n\tint (*set_phyloopback)(struct aq_hw_s *self, u32 mode, bool enable);\n\n\tint (*set_power)(struct aq_hw_s *self, unsigned int power_state,\n\t\t\t const u8 *mac);\n\n\tint (*send_fw_request)(struct aq_hw_s *self,\n\t\t\t       const struct hw_fw_request_iface *fw_req,\n\t\t\t       size_t size);\n\n\tvoid (*enable_ptp)(struct aq_hw_s *self, int enable);\n\n\tvoid (*adjust_ptp)(struct aq_hw_s *self, uint64_t adj);\n\n\tint (*set_eee_rate)(struct aq_hw_s *self, u32 speed);\n\n\tint (*get_eee_rate)(struct aq_hw_s *self, u32 *rate,\n\t\t\t    u32 *supported_rates);\n\n\tint (*set_downshift)(struct aq_hw_s *self, u32 counter);\n\n\tint (*set_media_detect)(struct aq_hw_s *self, bool enable);\n\n\tu32 (*get_link_capabilities)(struct aq_hw_s *self);\n\n\tint (*send_macsec_req)(struct aq_hw_s *self,\n\t\t\t       struct macsec_msg_fw_request *msg,\n\t\t\t       struct macsec_msg_fw_response *resp);\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}