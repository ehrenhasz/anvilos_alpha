{
  "module_name": "mlxfw_mfa2_tlv.h",
  "hash_id": "14d768749fbac858c8a12cd0d8e3d18e182a6a7336010a6073ead064b3b00c92",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlxfw/mlxfw_mfa2_tlv.h",
  "human_readable_source": " \n \n\n#ifndef _MLXFW_MFA2_TLV_H\n#define _MLXFW_MFA2_TLV_H\n\n#include <linux/kernel.h>\n#include \"mlxfw_mfa2_file.h\"\n\nstruct mlxfw_mfa2_tlv {\n\tu8 version;\n\tu8 type;\n\t__be16 len;\n\tu8 data[];\n} __packed;\n\nstatic inline const struct mlxfw_mfa2_tlv *\nmlxfw_mfa2_tlv_get(const struct mlxfw_mfa2_file *mfa2_file, const void *ptr)\n{\n\tif (!mlxfw_mfa2_valid_ptr(mfa2_file, ptr) ||\n\t    !mlxfw_mfa2_valid_ptr(mfa2_file, ptr + sizeof(struct mlxfw_mfa2_tlv)))\n\t\treturn NULL;\n\treturn ptr;\n}\n\nstatic inline const void *\nmlxfw_mfa2_tlv_payload_get(const struct mlxfw_mfa2_file *mfa2_file,\n\t\t\t   const struct mlxfw_mfa2_tlv *tlv, u8 payload_type,\n\t\t\t   size_t payload_size, bool varsize)\n{\n\tvoid *tlv_top;\n\n\ttlv_top = (void *) tlv + be16_to_cpu(tlv->len) - 1;\n\tif (!mlxfw_mfa2_valid_ptr(mfa2_file, tlv) ||\n\t    !mlxfw_mfa2_valid_ptr(mfa2_file, tlv_top))\n\t\treturn NULL;\n\tif (tlv->type != payload_type)\n\t\treturn NULL;\n\tif (varsize && (be16_to_cpu(tlv->len) < payload_size))\n\t\treturn NULL;\n\tif (!varsize && (be16_to_cpu(tlv->len) != payload_size))\n\t\treturn NULL;\n\n\treturn tlv->data;\n}\n\n#define MLXFW_MFA2_TLV(name, payload_type, tlv_type)\t\t\t       \\\nstatic inline const payload_type *\t\t\t\t\t       \\\nmlxfw_mfa2_tlv_ ## name ## _get(const struct mlxfw_mfa2_file *mfa2_file,       \\\n\t\t\t\tconst struct mlxfw_mfa2_tlv *tlv)\t       \\\n{\t\t\t\t\t\t\t\t\t       \\\n\treturn mlxfw_mfa2_tlv_payload_get(mfa2_file, tlv,\t\t       \\\n\t\t\t\t\t  tlv_type, sizeof(payload_type),      \\\n\t\t\t\t\t  false);\t\t\t       \\\n}\n\n#define MLXFW_MFA2_TLV_VARSIZE(name, payload_type, tlv_type)\t\t       \\\nstatic inline const payload_type *\t\t\t\t\t       \\\nmlxfw_mfa2_tlv_ ## name ## _get(const struct mlxfw_mfa2_file *mfa2_file,       \\\n\t\t\t\tconst struct mlxfw_mfa2_tlv *tlv)\t       \\\n{\t\t\t\t\t\t\t\t\t       \\\n\treturn mlxfw_mfa2_tlv_payload_get(mfa2_file, tlv,\t\t       \\\n\t\t\t\t\t  tlv_type, sizeof(payload_type),      \\\n\t\t\t\t\t  true);\t\t\t       \\\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}