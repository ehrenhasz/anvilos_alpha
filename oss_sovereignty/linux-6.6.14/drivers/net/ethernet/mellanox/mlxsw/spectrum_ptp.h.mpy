{
  "module_name": "spectrum_ptp.h",
  "hash_id": "4fead04e9089d7a00e44700f331135bd4c9644cfa83b6dceaba07fad05fc83ff",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlxsw/spectrum_ptp.h",
  "human_readable_source": " \n \n\n#ifndef _MLXSW_SPECTRUM_PTP_H\n#define _MLXSW_SPECTRUM_PTP_H\n\n#include <linux/device.h>\n#include <linux/rhashtable.h>\n\nstruct mlxsw_sp;\nstruct mlxsw_sp_port;\nstruct mlxsw_sp_ptp_clock;\n\nstatic inline int mlxsw_sp_ptp_get_ts_info_noptp(struct ethtool_ts_info *info)\n{\n\tinfo->so_timestamping = SOF_TIMESTAMPING_RX_SOFTWARE |\n\t\t\t\tSOF_TIMESTAMPING_SOFTWARE;\n\tinfo->phc_index = -1;\n\treturn 0;\n}\n\n#if IS_REACHABLE(CONFIG_PTP_1588_CLOCK)\n\nstruct mlxsw_sp_ptp_clock *\nmlxsw_sp1_ptp_clock_init(struct mlxsw_sp *mlxsw_sp, struct device *dev);\n\nvoid mlxsw_sp1_ptp_clock_fini(struct mlxsw_sp_ptp_clock *clock);\n\nstruct mlxsw_sp_ptp_state *mlxsw_sp1_ptp_init(struct mlxsw_sp *mlxsw_sp);\n\nvoid mlxsw_sp1_ptp_fini(struct mlxsw_sp_ptp_state *ptp_state);\n\nvoid mlxsw_sp1_ptp_receive(struct mlxsw_sp *mlxsw_sp, struct sk_buff *skb,\n\t\t\t   u16 local_port);\n\nvoid mlxsw_sp1_ptp_transmitted(struct mlxsw_sp *mlxsw_sp,\n\t\t\t       struct sk_buff *skb, u16 local_port);\n\nvoid mlxsw_sp1_ptp_got_timestamp(struct mlxsw_sp *mlxsw_sp, bool ingress,\n\t\t\t\t u16 local_port, u8 message_type,\n\t\t\t\t u8 domain_number, u16 sequence_id,\n\t\t\t\t u64 timestamp);\n\nint mlxsw_sp1_ptp_hwtstamp_get(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t       struct hwtstamp_config *config);\n\nint mlxsw_sp1_ptp_hwtstamp_set(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t       struct hwtstamp_config *config);\n\nvoid mlxsw_sp1_ptp_shaper_work(struct work_struct *work);\n\nint mlxsw_sp1_ptp_get_ts_info(struct mlxsw_sp *mlxsw_sp,\n\t\t\t      struct ethtool_ts_info *info);\n\nint mlxsw_sp1_get_stats_count(void);\nvoid mlxsw_sp1_get_stats_strings(u8 **p);\nvoid mlxsw_sp1_get_stats(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t u64 *data, int data_index);\n\nint mlxsw_sp_ptp_txhdr_construct(struct mlxsw_core *mlxsw_core,\n\t\t\t\t struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t\t struct sk_buff *skb,\n\t\t\t\t const struct mlxsw_tx_info *tx_info);\n\nstruct mlxsw_sp_ptp_clock *\nmlxsw_sp2_ptp_clock_init(struct mlxsw_sp *mlxsw_sp, struct device *dev);\n\nvoid mlxsw_sp2_ptp_clock_fini(struct mlxsw_sp_ptp_clock *clock);\n\nstruct mlxsw_sp_ptp_state *mlxsw_sp2_ptp_init(struct mlxsw_sp *mlxsw_sp);\n\nvoid mlxsw_sp2_ptp_fini(struct mlxsw_sp_ptp_state *ptp_state);\n\nvoid mlxsw_sp2_ptp_receive(struct mlxsw_sp *mlxsw_sp, struct sk_buff *skb,\n\t\t\t   u16 local_port);\n\nvoid mlxsw_sp2_ptp_transmitted(struct mlxsw_sp *mlxsw_sp,\n\t\t\t       struct sk_buff *skb, u16 local_port);\n\nint mlxsw_sp2_ptp_hwtstamp_get(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t       struct hwtstamp_config *config);\n\nint mlxsw_sp2_ptp_hwtstamp_set(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t       struct hwtstamp_config *config);\n\nint mlxsw_sp2_ptp_get_ts_info(struct mlxsw_sp *mlxsw_sp,\n\t\t\t      struct ethtool_ts_info *info);\n\nint mlxsw_sp2_ptp_txhdr_construct(struct mlxsw_core *mlxsw_core,\n\t\t\t\t  struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t\t  struct sk_buff *skb,\n\t\t\t\t  const struct mlxsw_tx_info *tx_info);\n\n#else\n\nstatic inline struct mlxsw_sp_ptp_clock *\nmlxsw_sp1_ptp_clock_init(struct mlxsw_sp *mlxsw_sp, struct device *dev)\n{\n\treturn NULL;\n}\n\nstatic inline void mlxsw_sp1_ptp_clock_fini(struct mlxsw_sp_ptp_clock *clock)\n{\n}\n\nstatic inline struct mlxsw_sp_ptp_state *\nmlxsw_sp1_ptp_init(struct mlxsw_sp *mlxsw_sp)\n{\n\treturn NULL;\n}\n\nstatic inline void mlxsw_sp1_ptp_fini(struct mlxsw_sp_ptp_state *ptp_state)\n{\n}\n\nstatic inline void mlxsw_sp1_ptp_receive(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t struct sk_buff *skb, u16 local_port)\n{\n\tmlxsw_sp_rx_listener_no_mark_func(skb, local_port, mlxsw_sp);\n}\n\nstatic inline void mlxsw_sp1_ptp_transmitted(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t     struct sk_buff *skb, u16 local_port)\n{\n\tdev_kfree_skb_any(skb);\n}\n\nstatic inline void\nmlxsw_sp1_ptp_got_timestamp(struct mlxsw_sp *mlxsw_sp, bool ingress,\n\t\t\t    u16 local_port, u8 message_type,\n\t\t\t    u8 domain_number,\n\t\t\t    u16 sequence_id, u64 timestamp)\n{\n}\n\nstatic inline int\nmlxsw_sp1_ptp_hwtstamp_get(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t   struct hwtstamp_config *config)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int\nmlxsw_sp1_ptp_hwtstamp_set(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t   struct hwtstamp_config *config)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline void mlxsw_sp1_ptp_shaper_work(struct work_struct *work)\n{\n}\n\nstatic inline int mlxsw_sp1_ptp_get_ts_info(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t    struct ethtool_ts_info *info)\n{\n\treturn mlxsw_sp_ptp_get_ts_info_noptp(info);\n}\n\nstatic inline int mlxsw_sp1_get_stats_count(void)\n{\n\treturn 0;\n}\n\nstatic inline void mlxsw_sp1_get_stats_strings(u8 **p)\n{\n}\n\nstatic inline void mlxsw_sp1_get_stats(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t\t       u64 *data, int data_index)\n{\n}\n\nstatic inline int\nmlxsw_sp_ptp_txhdr_construct(struct mlxsw_core *mlxsw_core,\n\t\t\t     struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t     struct sk_buff *skb,\n\t\t\t     const struct mlxsw_tx_info *tx_info)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline struct mlxsw_sp_ptp_clock *\nmlxsw_sp2_ptp_clock_init(struct mlxsw_sp *mlxsw_sp, struct device *dev)\n{\n\treturn NULL;\n}\n\nstatic inline void mlxsw_sp2_ptp_clock_fini(struct mlxsw_sp_ptp_clock *clock)\n{\n}\n\nstatic inline struct mlxsw_sp_ptp_state *\nmlxsw_sp2_ptp_init(struct mlxsw_sp *mlxsw_sp)\n{\n\treturn NULL;\n}\n\nstatic inline void mlxsw_sp2_ptp_fini(struct mlxsw_sp_ptp_state *ptp_state)\n{\n}\n\nstatic inline void mlxsw_sp2_ptp_receive(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t struct sk_buff *skb, u16 local_port)\n{\n\tmlxsw_sp_rx_listener_no_mark_func(skb, local_port, mlxsw_sp);\n}\n\nstatic inline void mlxsw_sp2_ptp_transmitted(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t     struct sk_buff *skb, u16 local_port)\n{\n\tdev_kfree_skb_any(skb);\n}\n\nstatic inline int\nmlxsw_sp2_ptp_hwtstamp_get(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t   struct hwtstamp_config *config)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int\nmlxsw_sp2_ptp_hwtstamp_set(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t   struct hwtstamp_config *config)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int mlxsw_sp2_ptp_get_ts_info(struct mlxsw_sp *mlxsw_sp,\n\t\t\t\t\t    struct ethtool_ts_info *info)\n{\n\treturn mlxsw_sp_ptp_get_ts_info_noptp(info);\n}\n\nstatic inline int\nmlxsw_sp2_ptp_txhdr_construct(struct mlxsw_core *mlxsw_core,\n\t\t\t      struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t      struct sk_buff *skb,\n\t\t\t      const struct mlxsw_tx_info *tx_info)\n{\n\treturn -EOPNOTSUPP;\n}\n#endif\n\nstatic inline void mlxsw_sp2_ptp_shaper_work(struct work_struct *work)\n{\n}\n\nstatic inline int mlxsw_sp2_get_stats_count(void)\n{\n\treturn 0;\n}\n\nstatic inline void mlxsw_sp2_get_stats_strings(u8 **p)\n{\n}\n\nstatic inline void mlxsw_sp2_get_stats(struct mlxsw_sp_port *mlxsw_sp_port,\n\t\t\t\t       u64 *data, int data_index)\n{\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}