{
  "module_name": "tun.c",
  "hash_id": "f30edda7b457d4bbe41fe4ad50b47172a63c46bfd24903d39c35770ada61da35",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/en/tc/act/tun.c",
  "human_readable_source": "\n\n\n#include \"act.h\"\n#include \"en/tc_tun_encap.h\"\n#include \"en/tc_priv.h\"\n\nstatic bool\ntc_act_can_offload_tun_encap(struct mlx5e_tc_act_parse_state *parse_state,\n\t\t\t     const struct flow_action_entry *act,\n\t\t\t     int act_index,\n\t\t\t     struct mlx5_flow_attr *attr)\n{\n\tif (!act->tunnel) {\n\t\tNL_SET_ERR_MSG_MOD(parse_state->extack,\n\t\t\t\t   \"Zero tunnel attributes is not supported\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nstatic int\ntc_act_parse_tun_encap(struct mlx5e_tc_act_parse_state *parse_state,\n\t\t       const struct flow_action_entry *act,\n\t\t       struct mlx5e_priv *priv,\n\t\t       struct mlx5_flow_attr *attr)\n{\n\tparse_state->tun_info = act->tunnel;\n\tparse_state->encap = true;\n\n\treturn 0;\n}\n\nstatic int\ntc_act_parse_tun_decap(struct mlx5e_tc_act_parse_state *parse_state,\n\t\t       const struct flow_action_entry *act,\n\t\t       struct mlx5e_priv *priv,\n\t\t       struct mlx5_flow_attr *attr)\n{\n\tparse_state->decap = true;\n\n\treturn 0;\n}\n\nstruct mlx5e_tc_act mlx5e_tc_act_tun_encap = {\n\t.can_offload = tc_act_can_offload_tun_encap,\n\t.parse_action = tc_act_parse_tun_encap,\n};\n\nstruct mlx5e_tc_act mlx5e_tc_act_tun_decap = {\n\t.parse_action = tc_act_parse_tun_decap,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}