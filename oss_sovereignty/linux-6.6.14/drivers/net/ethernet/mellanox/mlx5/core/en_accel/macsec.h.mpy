{
  "module_name": "macsec.h",
  "hash_id": "a250ea0a2befdd4dfbdf3ba4d56cee4425c2af727a15f9b650e2bafeb84ec54f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/en_accel/macsec.h",
  "human_readable_source": " \n \n\n#ifndef __MLX5_EN_ACCEL_MACSEC_H__\n#define __MLX5_EN_ACCEL_MACSEC_H__\n\n#ifdef CONFIG_MLX5_MACSEC\n\n#include <linux/mlx5/driver.h>\n#include <net/macsec.h>\n#include <net/dst_metadata.h>\n#include \"lib/macsec_fs.h\"\n\nstruct mlx5e_priv;\nstruct mlx5e_macsec;\n\nvoid mlx5e_macsec_build_netdev(struct mlx5e_priv *priv);\nint mlx5e_macsec_init(struct mlx5e_priv *priv);\nvoid mlx5e_macsec_cleanup(struct mlx5e_priv *priv);\nbool mlx5e_macsec_handle_tx_skb(struct mlx5e_macsec *macsec, struct sk_buff *skb);\nvoid mlx5e_macsec_tx_build_eseg(struct mlx5e_macsec *macsec,\n\t\t\t\tstruct sk_buff *skb,\n\t\t\t\tstruct mlx5_wqe_eth_seg *eseg);\n\nstatic inline bool mlx5e_macsec_skb_is_offload(struct sk_buff *skb)\n{\n\tstruct metadata_dst *md_dst = skb_metadata_dst(skb);\n\n\treturn md_dst && (md_dst->type == METADATA_MACSEC);\n}\n\nstatic inline bool mlx5e_macsec_is_rx_flow(struct mlx5_cqe64 *cqe)\n{\n\treturn MLX5_MACSEC_METADATA_MARKER(be32_to_cpu(cqe->ft_metadata));\n}\n\nvoid mlx5e_macsec_offload_handle_rx_skb(struct net_device *netdev, struct sk_buff *skb,\n\t\t\t\t\tstruct mlx5_cqe64 *cqe);\n\n#else\n\nstatic inline void mlx5e_macsec_build_netdev(struct mlx5e_priv *priv) {}\nstatic inline int mlx5e_macsec_init(struct mlx5e_priv *priv) { return 0; }\nstatic inline void mlx5e_macsec_cleanup(struct mlx5e_priv *priv) {}\nstatic inline bool mlx5e_macsec_skb_is_offload(struct sk_buff *skb) { return false; }\nstatic inline bool mlx5e_macsec_is_rx_flow(struct mlx5_cqe64 *cqe) { return false; }\nstatic inline void mlx5e_macsec_offload_handle_rx_skb(struct net_device *netdev,\n\t\t\t\t\t\t      struct sk_buff *skb,\n\t\t\t\t\t\t      struct mlx5_cqe64 *cqe)\n{}\n#endif   \n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}