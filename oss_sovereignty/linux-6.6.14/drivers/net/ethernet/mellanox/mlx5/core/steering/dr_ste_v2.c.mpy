{
  "module_name": "dr_ste_v2.c",
  "hash_id": "0fd50bc1bac774176a8a507fecc3a538dc939dc5a3fd2a75a31331d536c307ad",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/steering/dr_ste_v2.c",
  "human_readable_source": "\n \n\n#include \"dr_ste_v1.h\"\n\nenum {\n\tDR_STE_V2_ACTION_MDFY_FLD_L2_OUT_0\t\t= 0x00,\n\tDR_STE_V2_ACTION_MDFY_FLD_L2_OUT_1\t\t= 0x01,\n\tDR_STE_V2_ACTION_MDFY_FLD_L2_OUT_2\t\t= 0x02,\n\tDR_STE_V2_ACTION_MDFY_FLD_SRC_L2_OUT_0\t\t= 0x08,\n\tDR_STE_V2_ACTION_MDFY_FLD_SRC_L2_OUT_1\t\t= 0x09,\n\tDR_STE_V2_ACTION_MDFY_FLD_L3_OUT_0\t\t= 0x0e,\n\tDR_STE_V2_ACTION_MDFY_FLD_L4_OUT_0\t\t= 0x18,\n\tDR_STE_V2_ACTION_MDFY_FLD_L4_OUT_1\t\t= 0x19,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV4_OUT_0\t\t= 0x40,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV4_OUT_1\t\t= 0x41,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_0\t= 0x44,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_1\t= 0x45,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_2\t= 0x46,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_3\t= 0x47,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_0\t= 0x4c,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_1\t= 0x4d,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_2\t= 0x4e,\n\tDR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_3\t= 0x4f,\n\tDR_STE_V2_ACTION_MDFY_FLD_TCP_MISC_0\t\t= 0x5e,\n\tDR_STE_V2_ACTION_MDFY_FLD_TCP_MISC_1\t\t= 0x5f,\n\tDR_STE_V2_ACTION_MDFY_FLD_CFG_HDR_0_0\t\t= 0x6f,\n\tDR_STE_V2_ACTION_MDFY_FLD_CFG_HDR_0_1\t\t= 0x70,\n\tDR_STE_V2_ACTION_MDFY_FLD_METADATA_2_CQE\t= 0x7b,\n\tDR_STE_V2_ACTION_MDFY_FLD_GNRL_PURPOSE\t\t= 0x7c,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_2_0\t\t= 0x90,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_2_1\t\t= 0x91,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_1_0\t\t= 0x92,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_1_1\t\t= 0x93,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_0_0\t\t= 0x94,\n\tDR_STE_V2_ACTION_MDFY_FLD_REGISTER_0_1\t\t= 0x95,\n};\n\nstatic const struct mlx5dr_ste_action_modify_field dr_ste_v2_action_modify_field_arr[] = {\n\t[MLX5_ACTION_IN_FIELD_OUT_SMAC_47_16] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_SRC_L2_OUT_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SMAC_15_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_SRC_L2_OUT_1, .start = 16, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_ETHERTYPE] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L2_OUT_1, .start = 0, .end = 15,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DMAC_47_16] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L2_OUT_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DMAC_15_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L2_OUT_1, .start = 16, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_IP_DSCP] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L3_OUT_0, .start = 18, .end = 23,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_TCP_FLAGS] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L4_OUT_1, .start = 16, .end = 24,\n\t\t.l4_type = DR_STE_ACTION_MDFY_TYPE_L4_TCP,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_TCP_SPORT] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L4_OUT_0, .start = 16, .end = 31,\n\t\t.l4_type = DR_STE_ACTION_MDFY_TYPE_L4_TCP,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_TCP_DPORT] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L4_OUT_0, .start = 0, .end = 15,\n\t\t.l4_type = DR_STE_ACTION_MDFY_TYPE_L4_TCP,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_IP_TTL] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L3_OUT_0, .start = 8, .end = 15,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV4,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_IPV6_HOPLIMIT] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L3_OUT_0, .start = 8, .end = 15,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_UDP_SPORT] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L4_OUT_0, .start = 16, .end = 31,\n\t\t.l4_type = DR_STE_ACTION_MDFY_TYPE_L4_UDP,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_UDP_DPORT] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L4_OUT_0, .start = 0, .end = 15,\n\t\t.l4_type = DR_STE_ACTION_MDFY_TYPE_L4_UDP,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SIPV6_127_96] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_0, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SIPV6_95_64] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_1, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SIPV6_63_32] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_2, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SIPV6_31_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_SRC_OUT_3, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DIPV6_127_96] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_0, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DIPV6_95_64] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_1, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DIPV6_63_32] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_2, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DIPV6_31_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV6_DST_OUT_3, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV6,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_SIPV4] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV4_OUT_0, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV4,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_DIPV4] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_IPV4_OUT_1, .start = 0, .end = 31,\n\t\t.l3_type = DR_STE_ACTION_MDFY_TYPE_L3_IPV4,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_A] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_GNRL_PURPOSE, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_B] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_METADATA_2_CQE, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_0_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_1] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_0_1, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_2] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_1_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_3] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_1_1, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_4] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_2_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_METADATA_REG_C_5] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_REGISTER_2_1, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_TCP_SEQ_NUM] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_TCP_MISC_0, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_TCP_ACK_NUM] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_TCP_MISC_1, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_FIRST_VID] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_L2_OUT_2, .start = 0, .end = 15,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_EMD_31_0] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_CFG_HDR_0_1, .start = 0, .end = 31,\n\t},\n\t[MLX5_ACTION_IN_FIELD_OUT_EMD_47_32] = {\n\t\t.hw_field = DR_STE_V2_ACTION_MDFY_FLD_CFG_HDR_0_0, .start = 0, .end = 15,\n\t},\n};\n\nstatic struct mlx5dr_ste_ctx ste_ctx_v2 = {\n\t \n\t.build_eth_l2_src_dst_init\t= &dr_ste_v1_build_eth_l2_src_dst_init,\n\t.build_eth_l3_ipv6_src_init\t= &dr_ste_v1_build_eth_l3_ipv6_src_init,\n\t.build_eth_l3_ipv6_dst_init\t= &dr_ste_v1_build_eth_l3_ipv6_dst_init,\n\t.build_eth_l3_ipv4_5_tuple_init\t= &dr_ste_v1_build_eth_l3_ipv4_5_tuple_init,\n\t.build_eth_l2_src_init\t\t= &dr_ste_v1_build_eth_l2_src_init,\n\t.build_eth_l2_dst_init\t\t= &dr_ste_v1_build_eth_l2_dst_init,\n\t.build_eth_l2_tnl_init\t\t= &dr_ste_v1_build_eth_l2_tnl_init,\n\t.build_eth_l3_ipv4_misc_init\t= &dr_ste_v1_build_eth_l3_ipv4_misc_init,\n\t.build_eth_ipv6_l3_l4_init\t= &dr_ste_v1_build_eth_ipv6_l3_l4_init,\n\t.build_mpls_init\t\t= &dr_ste_v1_build_mpls_init,\n\t.build_tnl_gre_init\t\t= &dr_ste_v1_build_tnl_gre_init,\n\t.build_tnl_mpls_init\t\t= &dr_ste_v1_build_tnl_mpls_init,\n\t.build_tnl_mpls_over_udp_init\t= &dr_ste_v1_build_tnl_mpls_over_udp_init,\n\t.build_tnl_mpls_over_gre_init\t= &dr_ste_v1_build_tnl_mpls_over_gre_init,\n\t.build_icmp_init\t\t= &dr_ste_v1_build_icmp_init,\n\t.build_general_purpose_init\t= &dr_ste_v1_build_general_purpose_init,\n\t.build_eth_l4_misc_init\t\t= &dr_ste_v1_build_eth_l4_misc_init,\n\t.build_tnl_vxlan_gpe_init\t= &dr_ste_v1_build_flex_parser_tnl_vxlan_gpe_init,\n\t.build_tnl_geneve_init\t\t= &dr_ste_v1_build_flex_parser_tnl_geneve_init,\n\t.build_tnl_geneve_tlv_opt_init\t= &dr_ste_v1_build_flex_parser_tnl_geneve_tlv_opt_init,\n\t.build_tnl_geneve_tlv_opt_exist_init =\n\t\t\t\t  &dr_ste_v1_build_flex_parser_tnl_geneve_tlv_opt_exist_init,\n\t.build_register_0_init\t\t= &dr_ste_v1_build_register_0_init,\n\t.build_register_1_init\t\t= &dr_ste_v1_build_register_1_init,\n\t.build_src_gvmi_qpn_init\t= &dr_ste_v1_build_src_gvmi_qpn_init,\n\t.build_flex_parser_0_init\t= &dr_ste_v1_build_flex_parser_0_init,\n\t.build_flex_parser_1_init\t= &dr_ste_v1_build_flex_parser_1_init,\n\t.build_tnl_gtpu_init\t\t= &dr_ste_v1_build_flex_parser_tnl_gtpu_init,\n\t.build_tnl_header_0_1_init\t= &dr_ste_v1_build_tnl_header_0_1_init,\n\t.build_tnl_gtpu_flex_parser_0_init = &dr_ste_v1_build_tnl_gtpu_flex_parser_0_init,\n\t.build_tnl_gtpu_flex_parser_1_init = &dr_ste_v1_build_tnl_gtpu_flex_parser_1_init,\n\n\t \n\t.ste_init\t\t\t= &dr_ste_v1_init,\n\t.set_next_lu_type\t\t= &dr_ste_v1_set_next_lu_type,\n\t.get_next_lu_type\t\t= &dr_ste_v1_get_next_lu_type,\n\t.is_miss_addr_set\t\t= &dr_ste_v1_is_miss_addr_set,\n\t.set_miss_addr\t\t\t= &dr_ste_v1_set_miss_addr,\n\t.get_miss_addr\t\t\t= &dr_ste_v1_get_miss_addr,\n\t.set_hit_addr\t\t\t= &dr_ste_v1_set_hit_addr,\n\t.set_byte_mask\t\t\t= &dr_ste_v1_set_byte_mask,\n\t.get_byte_mask\t\t\t= &dr_ste_v1_get_byte_mask,\n\n\t \n\t.actions_caps\t\t\t= DR_STE_CTX_ACTION_CAP_TX_POP |\n\t\t\t\t\t  DR_STE_CTX_ACTION_CAP_RX_PUSH |\n\t\t\t\t\t  DR_STE_CTX_ACTION_CAP_RX_ENCAP,\n\t.set_actions_rx\t\t\t= &dr_ste_v1_set_actions_rx,\n\t.set_actions_tx\t\t\t= &dr_ste_v1_set_actions_tx,\n\t.modify_field_arr_sz\t\t= ARRAY_SIZE(dr_ste_v2_action_modify_field_arr),\n\t.modify_field_arr\t\t= dr_ste_v2_action_modify_field_arr,\n\t.set_action_set\t\t\t= &dr_ste_v1_set_action_set,\n\t.set_action_add\t\t\t= &dr_ste_v1_set_action_add,\n\t.set_action_copy\t\t= &dr_ste_v1_set_action_copy,\n\t.set_action_decap_l3_list\t= &dr_ste_v1_set_action_decap_l3_list,\n\t.alloc_modify_hdr_chunk\t\t= &dr_ste_v1_alloc_modify_hdr_ptrn_arg,\n\t.dealloc_modify_hdr_chunk\t= &dr_ste_v1_free_modify_hdr_ptrn_arg,\n\n\t \n\t.prepare_for_postsend\t\t= &dr_ste_v1_prepare_for_postsend,\n};\n\nstruct mlx5dr_ste_ctx *mlx5dr_ste_get_ctx_v2(void)\n{\n\treturn &ste_ctx_v2;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}