{
  "module_name": "ktls_utils.h",
  "hash_id": "2ab4a8561f5c4ce5a587e57f87862fcf077d9069ce1f1d5966c7e34d03811741",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/en_accel/ktls_utils.h",
  "human_readable_source": " \n \n\n#ifndef __MLX5E_KTLS_UTILS_H__\n#define __MLX5E_KTLS_UTILS_H__\n\n#include <net/tls.h>\n#include \"en.h\"\n\nenum {\n\tMLX5E_TLS_PROGRESS_PARAMS_AUTH_STATE_NO_OFFLOAD     = 0,\n\tMLX5E_TLS_PROGRESS_PARAMS_AUTH_STATE_OFFLOAD        = 1,\n\tMLX5E_TLS_PROGRESS_PARAMS_AUTH_STATE_AUTHENTICATION = 2,\n};\n\nenum {\n\tMLX5E_TLS_PROGRESS_PARAMS_RECORD_TRACKER_STATE_START     = 0,\n\tMLX5E_TLS_PROGRESS_PARAMS_RECORD_TRACKER_STATE_TRACKING  = 1,\n\tMLX5E_TLS_PROGRESS_PARAMS_RECORD_TRACKER_STATE_SEARCHING = 2,\n};\n\nint mlx5e_ktls_add_tx(struct net_device *netdev, struct sock *sk,\n\t\t      struct tls_crypto_info *crypto_info, u32 start_offload_tcp_sn);\nvoid mlx5e_ktls_del_tx(struct net_device *netdev, struct tls_context *tls_ctx);\nint mlx5e_ktls_add_rx(struct net_device *netdev, struct sock *sk,\n\t\t      struct tls_crypto_info *crypto_info, u32 start_offload_tcp_sn);\nvoid mlx5e_ktls_del_rx(struct net_device *netdev, struct tls_context *tls_ctx);\nvoid mlx5e_ktls_rx_resync(struct net_device *netdev, struct sock *sk, u32 seq, u8 *rcd_sn);\n\nunion mlx5e_crypto_info {\n\tstruct tls_crypto_info crypto_info;\n\tstruct tls12_crypto_info_aes_gcm_128 crypto_info_128;\n\tstruct tls12_crypto_info_aes_gcm_256 crypto_info_256;\n};\n\nstruct mlx5e_set_tls_static_params_wqe {\n\tstruct mlx5_wqe_ctrl_seg ctrl;\n\tstruct mlx5_wqe_umr_ctrl_seg uctrl;\n\tstruct mlx5_mkey_seg mkc;\n\tstruct mlx5_wqe_tls_static_params_seg params;\n};\n\nstruct mlx5e_set_tls_progress_params_wqe {\n\tstruct mlx5_wqe_ctrl_seg ctrl;\n\tstruct mlx5_wqe_tls_progress_params_seg params;\n};\n\nstruct mlx5e_get_tls_progress_params_wqe {\n\tstruct mlx5_wqe_ctrl_seg ctrl;\n\tstruct mlx5_seg_get_psv  psv;\n};\n\n#define MLX5E_TLS_SET_STATIC_PARAMS_WQEBBS \\\n\t(DIV_ROUND_UP(sizeof(struct mlx5e_set_tls_static_params_wqe), MLX5_SEND_WQE_BB))\n\n#define MLX5E_TLS_SET_PROGRESS_PARAMS_WQEBBS \\\n\t(DIV_ROUND_UP(sizeof(struct mlx5e_set_tls_progress_params_wqe), MLX5_SEND_WQE_BB))\n\n#define MLX5E_KTLS_GET_PROGRESS_WQEBBS \\\n\t(DIV_ROUND_UP(sizeof(struct mlx5e_get_tls_progress_params_wqe), MLX5_SEND_WQE_BB))\n\n#define MLX5E_TLS_FETCH_SET_STATIC_PARAMS_WQE(sq, pi) \\\n\t((struct mlx5e_set_tls_static_params_wqe *)\\\n\t mlx5e_fetch_wqe(&(sq)->wq, pi, sizeof(struct mlx5e_set_tls_static_params_wqe)))\n\n#define MLX5E_TLS_FETCH_SET_PROGRESS_PARAMS_WQE(sq, pi) \\\n\t((struct mlx5e_set_tls_progress_params_wqe *)\\\n\t mlx5e_fetch_wqe(&(sq)->wq, pi, sizeof(struct mlx5e_set_tls_progress_params_wqe)))\n\n#define MLX5E_TLS_FETCH_GET_PROGRESS_PARAMS_WQE(sq, pi) \\\n\t((struct mlx5e_get_tls_progress_params_wqe *)\\\n\t mlx5e_fetch_wqe(&(sq)->wq, pi, sizeof(struct mlx5e_get_tls_progress_params_wqe)))\n\n#define MLX5E_TLS_FETCH_DUMP_WQE(sq, pi) \\\n\t((struct mlx5e_dump_wqe *)\\\n\t mlx5e_fetch_wqe(&(sq)->wq, pi, sizeof(struct mlx5e_dump_wqe)))\n\nvoid\nmlx5e_ktls_build_static_params(struct mlx5e_set_tls_static_params_wqe *wqe,\n\t\t\t       u16 pc, u32 sqn,\n\t\t\t       union mlx5e_crypto_info *crypto_info,\n\t\t\t       u32 tis_tir_num, u32 key_id, u32 resync_tcp_sn,\n\t\t\t       bool fence, enum tls_offload_ctx_dir direction);\nvoid\nmlx5e_ktls_build_progress_params(struct mlx5e_set_tls_progress_params_wqe *wqe,\n\t\t\t\t u16 pc, u32 sqn,\n\t\t\t\t u32 tis_tir_num, bool fence,\n\t\t\t\t u32 next_record_tcp_sn,\n\t\t\t\t enum tls_offload_ctx_dir direction);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}