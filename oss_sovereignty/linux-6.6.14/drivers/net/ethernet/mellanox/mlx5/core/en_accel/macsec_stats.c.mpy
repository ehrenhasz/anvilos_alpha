{
  "module_name": "macsec_stats.c",
  "hash_id": "c8eff61c3fb33bf0397cdf66b8fa47d68fbdee96d403a6cb7195b0c81a43cf9f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/en_accel/macsec_stats.c",
  "human_readable_source": "\n \n\n#include <linux/ethtool.h>\n#include <net/sock.h>\n\n#include \"en.h\"\n#include \"en_accel/macsec.h\"\n\nstatic const struct counter_desc mlx5e_macsec_hw_stats_desc[] = {\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_rx_pkts) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_rx_bytes) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_rx_pkts_drop) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_rx_bytes_drop) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_tx_pkts) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_tx_bytes) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_tx_pkts_drop) },\n\t{ MLX5E_DECLARE_STAT(struct mlx5_macsec_stats, macsec_tx_bytes_drop) },\n};\n\n#define NUM_MACSEC_HW_COUNTERS ARRAY_SIZE(mlx5e_macsec_hw_stats_desc)\n\nstatic MLX5E_DECLARE_STATS_GRP_OP_NUM_STATS(macsec_hw)\n{\n\tif (!priv->macsec)\n\t\treturn 0;\n\n\tif (mlx5e_is_macsec_device(priv->mdev))\n\t\treturn NUM_MACSEC_HW_COUNTERS;\n\n\treturn 0;\n}\n\nstatic MLX5E_DECLARE_STATS_GRP_OP_UPDATE_STATS(macsec_hw) {}\n\nstatic MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(macsec_hw)\n{\n\tunsigned int i;\n\n\tif (!priv->macsec)\n\t\treturn idx;\n\n\tif (!mlx5e_is_macsec_device(priv->mdev))\n\t\treturn idx;\n\n\tfor (i = 0; i < NUM_MACSEC_HW_COUNTERS; i++)\n\t\tstrcpy(data + (idx++) * ETH_GSTRING_LEN,\n\t\t       mlx5e_macsec_hw_stats_desc[i].format);\n\n\treturn idx;\n}\n\nstatic MLX5E_DECLARE_STATS_GRP_OP_FILL_STATS(macsec_hw)\n{\n\tstruct mlx5_macsec_fs *macsec_fs;\n\tint i;\n\n\tif (!priv->macsec)\n\t\treturn idx;\n\n\tif (!mlx5e_is_macsec_device(priv->mdev))\n\t\treturn idx;\n\n\tmacsec_fs = priv->mdev->macsec_fs;\n\tmlx5_macsec_fs_get_stats_fill(macsec_fs, mlx5_macsec_fs_get_stats(macsec_fs));\n\tfor (i = 0; i < NUM_MACSEC_HW_COUNTERS; i++)\n\t\tdata[idx++] = MLX5E_READ_CTR64_CPU(mlx5_macsec_fs_get_stats(macsec_fs),\n\t\t\t\t\t\t   mlx5e_macsec_hw_stats_desc,\n\t\t\t\t\t\t   i);\n\n\treturn idx;\n}\n\nMLX5E_DEFINE_STATS_GRP(macsec_hw, 0);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}