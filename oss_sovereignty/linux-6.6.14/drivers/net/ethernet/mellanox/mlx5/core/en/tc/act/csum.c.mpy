{
  "module_name": "csum.c",
  "hash_id": "f504b4afc8d300e28e0e210e6b26990624d023bcbeb9eb6675b02acffec5d05e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/en/tc/act/csum.c",
  "human_readable_source": "\n\n\n#include <linux/tc_act/tc_csum.h>\n#include \"act.h\"\n#include \"en/tc_priv.h\"\n\nstatic bool\ncsum_offload_supported(struct mlx5e_priv *priv,\n\t\t       u32 action,\n\t\t       u32 update_flags,\n\t\t       struct netlink_ext_ack *extack)\n{\n\tu32 prot_flags = TCA_CSUM_UPDATE_FLAG_IPV4HDR | TCA_CSUM_UPDATE_FLAG_TCP |\n\t\t\t TCA_CSUM_UPDATE_FLAG_UDP;\n\n\t \n\tif (!(action & MLX5_FLOW_CONTEXT_ACTION_MOD_HDR)) {\n\t\tNL_SET_ERR_MSG_MOD(extack,\n\t\t\t\t   \"TC csum action is only offloaded with pedit\");\n\t\tnetdev_warn(priv->netdev,\n\t\t\t    \"TC csum action is only offloaded with pedit\\n\");\n\t\treturn false;\n\t}\n\n\tif (update_flags & ~prot_flags) {\n\t\tNL_SET_ERR_MSG_MOD(extack,\n\t\t\t\t   \"can't offload TC csum action for some header/s\");\n\t\tnetdev_warn(priv->netdev,\n\t\t\t    \"can't offload TC csum action for some header/s - flags %#x\\n\",\n\t\t\t    update_flags);\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nstatic bool\ntc_act_can_offload_csum(struct mlx5e_tc_act_parse_state *parse_state,\n\t\t\tconst struct flow_action_entry *act,\n\t\t\tint act_index,\n\t\t\tstruct mlx5_flow_attr *attr)\n{\n\tstruct mlx5e_tc_flow *flow = parse_state->flow;\n\n\treturn csum_offload_supported(flow->priv, attr->action,\n\t\t\t\t      act->csum_flags, parse_state->extack);\n}\n\nstatic int\ntc_act_parse_csum(struct mlx5e_tc_act_parse_state *parse_state,\n\t\t  const struct flow_action_entry *act,\n\t\t  struct mlx5e_priv *priv,\n\t\t  struct mlx5_flow_attr *attr)\n{\n\treturn 0;\n}\n\nstruct mlx5e_tc_act mlx5e_tc_act_csum = {\n\t.can_offload = tc_act_can_offload_csum,\n\t.parse_action = tc_act_parse_csum,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}