{
  "module_name": "fs_tracepoint.h",
  "hash_id": "01e3345d9a7ee4bdedb198c42f96b3edb60924867be0c6642875192f4c4a8358",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/diag/fs_tracepoint.h",
  "human_readable_source": " \n\n#if !defined(_MLX5_FS_TP_) || defined(TRACE_HEADER_MULTI_READ)\n#define _MLX5_FS_TP_\n\n#include <linux/tracepoint.h>\n#include <linux/trace_seq.h>\n#include \"../fs_core.h\"\n\n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM mlx5\n\n#define __parse_fs_hdrs(match_criteria_enable, mouter, mmisc, minner, vouter, \\\n\t\t\tvinner, vmisc)\t\t\t\t\t      \\\n\tparse_fs_hdrs(p, match_criteria_enable, mouter, mmisc, minner, vouter,\\\n\t\t      vinner, vmisc)\n\nconst char *parse_fs_hdrs(struct trace_seq *p,\n\t\t\t  u8 match_criteria_enable,\n\t\t\t  const u32 *mask_outer,\n\t\t\t  const u32 *mask_misc,\n\t\t\t  const u32 *mask_inner,\n\t\t\t  const u32 *value_outer,\n\t\t\t  const u32 *value_misc,\n\t\t\t  const u32 *value_inner);\n\n#define __parse_fs_dst(dst, counter_id) \\\n\tparse_fs_dst(p, (const struct mlx5_flow_destination *)dst, counter_id)\n\nconst char *parse_fs_dst(struct trace_seq *p,\n\t\t\t const struct mlx5_flow_destination *dst,\n\t\t\t u32 counter_id);\n\nTRACE_EVENT(mlx5_fs_add_ft,\n\t    TP_PROTO(const struct mlx5_flow_table *ft),\n\t    TP_ARGS(ft),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_table *, ft)\n\t\t__field(u32, id)\n\t\t__field(u32, level)\n\t\t__field(u32, type)\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->ft = ft;\n\t\t\t   __entry->id = ft->id;\n\t\t\t   __entry->level = ft->level;\n\t\t\t   __entry->type = ft->type;\n\t    ),\n\t    TP_printk(\"ft=%p id=%u level=%u type=%u \\n\",\n\t\t      __entry->ft, __entry->id, __entry->level, __entry->type)\n\t    );\n\nTRACE_EVENT(mlx5_fs_del_ft,\n\t    TP_PROTO(const struct mlx5_flow_table *ft),\n\t    TP_ARGS(ft),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_table *, ft)\n\t\t__field(u32, id)\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->ft = ft;\n\t\t\t   __entry->id = ft->id;\n\n\t    ),\n\t    TP_printk(\"ft=%p id=%u\\n\",\n\t\t      __entry->ft, __entry->id)\n\t    );\n\nTRACE_EVENT(mlx5_fs_add_fg,\n\t    TP_PROTO(const struct mlx5_flow_group *fg),\n\t    TP_ARGS(fg),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_group *, fg)\n\t\t__field(const struct mlx5_flow_table *, ft)\n\t\t__field(u32, start_index)\n\t\t__field(u32, end_index)\n\t\t__field(u32, id)\n\t\t__field(u8, mask_enable)\n\t\t__array(u32, mask_outer, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, mask_inner, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, mask_misc, MLX5_ST_SZ_DW(fte_match_set_misc))\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->fg = fg;\n\t\t\t   fs_get_obj(__entry->ft, fg->node.parent);\n\t\t\t   __entry->start_index = fg->start_index;\n\t\t\t   __entry->end_index = fg->start_index + fg->max_ftes;\n\t\t\t   __entry->id = fg->id;\n\t\t\t   __entry->mask_enable = fg->mask.match_criteria_enable;\n\t\t\t   memcpy(__entry->mask_outer,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fg->mask.match_criteria,\n\t\t\t\t\t       outer_headers),\n\t\t\t\t  sizeof(__entry->mask_outer));\n\t\t\t   memcpy(__entry->mask_inner,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fg->mask.match_criteria,\n\t\t\t\t\t       inner_headers),\n\t\t\t\t  sizeof(__entry->mask_inner));\n\t\t\t   memcpy(__entry->mask_misc,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fg->mask.match_criteria,\n\t\t\t\t\t       misc_parameters),\n\t\t\t\t  sizeof(__entry->mask_misc));\n\n\t    ),\n\t    TP_printk(\"fg=%p ft=%p id=%u start=%u end=%u bit_mask=%02x %s\\n\",\n\t\t      __entry->fg, __entry->ft, __entry->id,\n\t\t      __entry->start_index, __entry->end_index,\n\t\t      __entry->mask_enable,\n\t\t      __parse_fs_hdrs(__entry->mask_enable,\n\t\t\t\t      __entry->mask_outer,\n\t\t\t\t      __entry->mask_misc,\n\t\t\t\t      __entry->mask_inner,\n\t\t\t\t      __entry->mask_outer,\n\t\t\t\t      __entry->mask_misc,\n\t\t\t\t      __entry->mask_inner))\n\t    );\n\nTRACE_EVENT(mlx5_fs_del_fg,\n\t    TP_PROTO(const struct mlx5_flow_group *fg),\n\t    TP_ARGS(fg),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_group *, fg)\n\t\t__field(u32, id)\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->fg = fg;\n\t\t\t   __entry->id = fg->id;\n\n\t    ),\n\t    TP_printk(\"fg=%p id=%u\\n\",\n\t\t      __entry->fg, __entry->id)\n\t    );\n\n#define ACTION_FLAGS \\\n\t{MLX5_FLOW_CONTEXT_ACTION_ALLOW,\t \"ALLOW\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_DROP,\t\t \"DROP\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_FWD_DEST,\t \"FWD\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_COUNT,\t \"CNT\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_PACKET_REFORMAT, \"REFORMAT\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_DECAP,\t \"DECAP\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_MOD_HDR,\t \"MOD_HDR\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_VLAN_PUSH,\t \"VLAN_PUSH\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_VLAN_POP,\t \"VLAN_POP\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_VLAN_PUSH_2,\t \"VLAN_PUSH_2\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_VLAN_POP_2,\t \"VLAN_POP_2\"},\\\n\t{MLX5_FLOW_CONTEXT_ACTION_FWD_NEXT_PRIO, \"NEXT_PRIO\"}\n\nTRACE_EVENT(mlx5_fs_set_fte,\n\t    TP_PROTO(const struct fs_fte *fte, int new_fte),\n\t    TP_ARGS(fte, new_fte),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct fs_fte *, fte)\n\t\t__field(const struct mlx5_flow_group *, fg)\n\t\t__field(u32, group_index)\n\t\t__field(u32, index)\n\t\t__field(u32, action)\n\t\t__field(u32, flow_tag)\n\t\t__field(u32, flow_source)\n\t\t__field(u8,  mask_enable)\n\t\t__field(int, new_fte)\n\t\t__array(u32, mask_outer, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, mask_inner, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, mask_misc, MLX5_ST_SZ_DW(fte_match_set_misc))\n\t\t__array(u32, value_outer, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, value_inner, MLX5_ST_SZ_DW(fte_match_set_lyr_2_4))\n\t\t__array(u32, value_misc, MLX5_ST_SZ_DW(fte_match_set_misc))\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->fte = fte;\n\t\t\t   __entry->new_fte = new_fte;\n\t\t\t   fs_get_obj(__entry->fg, fte->node.parent);\n\t\t\t   __entry->group_index = __entry->fg->id;\n\t\t\t   __entry->index = fte->index;\n\t\t\t   __entry->action = fte->action.action;\n\t\t\t   __entry->mask_enable = __entry->fg->mask.match_criteria_enable;\n\t\t\t   __entry->flow_tag = fte->flow_context.flow_tag;\n\t\t\t   __entry->flow_source = fte->flow_context.flow_source;\n\t\t\t   memcpy(__entry->mask_outer,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &__entry->fg->mask.match_criteria,\n\t\t\t\t\t       outer_headers),\n\t\t\t\t  sizeof(__entry->mask_outer));\n\t\t\t   memcpy(__entry->mask_inner,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &__entry->fg->mask.match_criteria,\n\t\t\t\t\t       inner_headers),\n\t\t\t\t  sizeof(__entry->mask_inner));\n\t\t\t   memcpy(__entry->mask_misc,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &__entry->fg->mask.match_criteria,\n\t\t\t\t\t       misc_parameters),\n\t\t\t\t  sizeof(__entry->mask_misc));\n\t\t\t   memcpy(__entry->value_outer,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fte->val,\n\t\t\t\t\t       outer_headers),\n\t\t\t\t  sizeof(__entry->value_outer));\n\t\t\t   memcpy(__entry->value_inner,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fte->val,\n\t\t\t\t\t       inner_headers),\n\t\t\t\t  sizeof(__entry->value_inner));\n\t\t\t   memcpy(__entry->value_misc,\n\t\t\t\t  MLX5_ADDR_OF(fte_match_param,\n\t\t\t\t\t       &fte->val,\n\t\t\t\t\t       misc_parameters),\n\t\t\t\t  sizeof(__entry->value_misc));\n\n\t    ),\n\t    TP_printk(\"op=%s fte=%p fg=%p index=%u group_index=%u action=<%s> flow_tag=%x %s\\n\",\n\t\t      __entry->new_fte ? \"add\" : \"set\",\n\t\t      __entry->fte, __entry->fg, __entry->index,\n\t\t      __entry->group_index, __print_flags(__entry->action, \"|\",\n\t\t\t\t\t\t\t  ACTION_FLAGS),\n\t\t      __entry->flow_tag,\n\t\t      __parse_fs_hdrs(__entry->mask_enable,\n\t\t\t\t      __entry->mask_outer,\n\t\t\t\t      __entry->mask_misc,\n\t\t\t\t      __entry->mask_inner,\n\t\t\t\t      __entry->value_outer,\n\t\t\t\t      __entry->value_misc,\n\t\t\t\t      __entry->value_inner))\n\t    );\n\nTRACE_EVENT(mlx5_fs_del_fte,\n\t    TP_PROTO(const struct fs_fte *fte),\n\t    TP_ARGS(fte),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct fs_fte *, fte)\n\t\t__field(u32, index)\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->fte = fte;\n\t\t\t   __entry->index = fte->index;\n\n\t    ),\n\t    TP_printk(\"fte=%p index=%u\\n\",\n\t\t      __entry->fte, __entry->index)\n\t    );\n\nTRACE_EVENT(mlx5_fs_add_rule,\n\t    TP_PROTO(const struct mlx5_flow_rule *rule),\n\t    TP_ARGS(rule),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_rule *, rule)\n\t\t__field(const struct fs_fte *, fte)\n\t\t__field(u32, sw_action)\n\t\t__field(u32, index)\n\t\t__field(u32, counter_id)\n\t\t__array(u8, destination, sizeof(struct mlx5_flow_destination))\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->rule = rule;\n\t\t\t   fs_get_obj(__entry->fte, rule->node.parent);\n\t\t\t   __entry->index = __entry->fte->dests_size - 1;\n\t\t\t   __entry->sw_action = rule->sw_action;\n\t\t\t   memcpy(__entry->destination,\n\t\t\t\t  &rule->dest_attr,\n\t\t\t\t  sizeof(__entry->destination));\n\t\t\t   if (rule->dest_attr.type &\n\t\t\t       MLX5_FLOW_DESTINATION_TYPE_COUNTER)\n\t\t\t\t__entry->counter_id =\n\t\t\t\t\trule->dest_attr.counter_id;\n\t    ),\n\t    TP_printk(\"rule=%p fte=%p index=%u sw_action=<%s> [dst] %s\\n\",\n\t\t      __entry->rule, __entry->fte, __entry->index,\n\t\t      __print_flags(__entry->sw_action, \"|\", ACTION_FLAGS),\n\t\t      __parse_fs_dst(__entry->destination, __entry->counter_id))\n\t    );\n\nTRACE_EVENT(mlx5_fs_del_rule,\n\t    TP_PROTO(const struct mlx5_flow_rule *rule),\n\t    TP_ARGS(rule),\n\t    TP_STRUCT__entry(\n\t\t__field(const struct mlx5_flow_rule *, rule)\n\t\t__field(const struct fs_fte *, fte)\n\t    ),\n\t    TP_fast_assign(\n\t\t\t   __entry->rule = rule;\n\t\t\t   fs_get_obj(__entry->fte, rule->node.parent);\n\t    ),\n\t    TP_printk(\"rule=%p fte=%p\\n\",\n\t\t      __entry->rule, __entry->fte)\n\t    );\n#endif\n\n#undef TRACE_INCLUDE_PATH\n#define TRACE_INCLUDE_PATH ./diag\n#undef TRACE_INCLUDE_FILE\n#define TRACE_INCLUDE_FILE fs_tracepoint\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}