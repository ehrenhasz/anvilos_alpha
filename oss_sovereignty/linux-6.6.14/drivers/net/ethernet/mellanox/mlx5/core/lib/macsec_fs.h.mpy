{
  "module_name": "macsec_fs.h",
  "hash_id": "afccaafd3c669fba71a8c5045a96558300df1c4eab9b44fd1447136af85de4ea",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/mellanox/mlx5/core/lib/macsec_fs.h",
  "human_readable_source": " \n \n\n#ifndef __MLX5_MACSEC_STEERING_H__\n#define __MLX5_MACSEC_STEERING_H__\n\n#ifdef CONFIG_MLX5_MACSEC\n\n \n#define MLX5_MACEC_RX_FS_ID_MAX USHRT_MAX  \n#define MLX5_MACSEC_RX_FS_ID_MASK MLX5_MACEC_RX_FS_ID_MAX\n#define MLX5_MACSEC_METADATA_MARKER(metadata)  ((((metadata) >> 30) & 0x3)  == 0x1)\n#define MLX5_MACSEC_RX_METADAT_HANDLE(metadata)  ((metadata) & MLX5_MACSEC_RX_FS_ID_MASK)\n\n#define MLX5_MACSEC_NUM_OF_SUPPORTED_INTERFACES 16\n\nstruct mlx5_macsec_fs;\nunion mlx5_macsec_rule;\n\nstruct mlx5_macsec_rule_attrs {\n\tsci_t sci;\n\tu32 macsec_obj_id;\n\tu8 assoc_num;\n\tint action;\n};\n\nstruct mlx5_macsec_stats {\n\tu64 macsec_rx_pkts;\n\tu64 macsec_rx_bytes;\n\tu64 macsec_rx_pkts_drop;\n\tu64 macsec_rx_bytes_drop;\n\tu64 macsec_tx_pkts;\n\tu64 macsec_tx_bytes;\n\tu64 macsec_tx_pkts_drop;\n\tu64 macsec_tx_bytes_drop;\n};\n\nenum mlx5_macsec_action {\n\tMLX5_ACCEL_MACSEC_ACTION_ENCRYPT,\n\tMLX5_ACCEL_MACSEC_ACTION_DECRYPT,\n};\n\nvoid mlx5_macsec_fs_cleanup(struct mlx5_macsec_fs *macsec_fs);\n\nstruct mlx5_macsec_fs *\nmlx5_macsec_fs_init(struct mlx5_core_dev *mdev);\n\nunion mlx5_macsec_rule *\nmlx5_macsec_fs_add_rule(struct mlx5_macsec_fs *macsec_fs,\n\t\t\tconst struct macsec_context *ctx,\n\t\t\tstruct mlx5_macsec_rule_attrs *attrs,\n\t\t\tu32 *sa_fs_id);\n\nvoid mlx5_macsec_fs_del_rule(struct mlx5_macsec_fs *macsec_fs,\n\t\t\t     union mlx5_macsec_rule *macsec_rule,\n\t\t\t     int action, void *macdev, u32 sa_fs_id);\n\nvoid mlx5_macsec_fs_get_stats_fill(struct mlx5_macsec_fs *macsec_fs, void *macsec_stats);\nstruct mlx5_macsec_stats *mlx5_macsec_fs_get_stats(struct mlx5_macsec_fs *macsec_fs);\nu32 mlx5_macsec_fs_get_fs_id_from_hashtable(struct mlx5_macsec_fs *macsec_fs, sci_t *sci);\n\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}