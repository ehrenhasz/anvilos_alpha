{
  "module_name": "s2io.h",
  "hash_id": "fdd7bf5a60bff65c04484e408f134cb4c9b66ca6c963db22354f4f660ae782ec",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/neterion/s2io.h",
  "human_readable_source": " \n#include <linux/io-64-nonatomic-lo-hi.h>\n#ifndef _S2IO_H\n#define _S2IO_H\n\n#define TBD 0\n#define s2BIT(loc)\t\t(0x8000000000000000ULL >> (loc))\n#define vBIT(val, loc, sz)\t(((u64)val) << (64-loc-sz))\n#define INV(d)  ((d&0xff)<<24) | (((d>>8)&0xff)<<16) | (((d>>16)&0xff)<<8)| ((d>>24)&0xff)\n\n#undef SUCCESS\n#define SUCCESS 0\n#define FAILURE -1\n#define S2IO_MINUS_ONE 0xFFFFFFFFFFFFFFFFULL\n#define S2IO_DISABLE_MAC_ENTRY 0xFFFFFFFFFFFFULL\n#define S2IO_MAX_PCI_CONFIG_SPACE_REINIT 100\n#define S2IO_BIT_RESET 1\n#define S2IO_BIT_SET 2\n#define CHECKBIT(value, nbit) (value & (1 << nbit))\n\n \n#define MAX_FLICKER_TIME\t60000  \n\n \nenum {\n\tXENA_ONE_SPLIT_TRANSACTION = 0,\n\tXENA_TWO_SPLIT_TRANSACTION = 1,\n\tXENA_THREE_SPLIT_TRANSACTION = 2,\n\tXENA_FOUR_SPLIT_TRANSACTION = 3,\n\tXENA_EIGHT_SPLIT_TRANSACTION = 4,\n\tXENA_TWELVE_SPLIT_TRANSACTION = 5,\n\tXENA_SIXTEEN_SPLIT_TRANSACTION = 6,\n\tXENA_THIRTYTWO_SPLIT_TRANSACTION = 7\n};\n#define XENA_MAX_OUTSTANDING_SPLITS(n) (n << 4)\n\n \n#define WATCH_DOG_TIMEOUT\t\t15*HZ\n#define EFILL\t\t\t\t0x1234\n#define ALIGN_SIZE\t\t\t127\n#define\tPCIX_COMMAND_REGISTER\t\t0x62\n\n \n \n#define\tERR_DBG\t\t0\n#define\tINIT_DBG\t1\n#define\tINFO_DBG\t2\n#define\tTX_DBG\t\t3\n#define\tINTR_DBG\t4\n\n \nstatic int debug_level = ERR_DBG;\n\n \n#define DBG_PRINT(dbg_level, fmt, args...) do {\t\t\t\\\n\tif (dbg_level <= debug_level)\t\t\t\t\\\n\t\tpr_info(fmt, ##args);\t\t\t\t\\\n\t} while (0)\n\n \n#define L3_CKSUM_OK 0xFFFF\n#define L4_CKSUM_OK 0xFFFF\n#define S2IO_JUMBO_SIZE 9600\n\n \nstruct swStat {\n\tunsigned long long single_ecc_errs;\n\tunsigned long long double_ecc_errs;\n\tunsigned long long parity_err_cnt;\n\tunsigned long long serious_err_cnt;\n\tunsigned long long soft_reset_cnt;\n\tunsigned long long fifo_full_cnt;\n\tunsigned long long ring_full_cnt[8];\n\t \n\tunsigned long long clubbed_frms_cnt;\n\tunsigned long long sending_both;\n\tunsigned long long outof_sequence_pkts;\n\tunsigned long long flush_max_pkts;\n\tunsigned long long sum_avg_pkts_aggregated;\n\tunsigned long long num_aggregations;\n\t \n\tunsigned long long mem_alloc_fail_cnt;\n\tunsigned long long pci_map_fail_cnt;\n\tunsigned long long watchdog_timer_cnt;\n\tunsigned long long mem_allocated;\n\tunsigned long long mem_freed;\n\tunsigned long long link_up_cnt;\n\tunsigned long long link_down_cnt;\n\tunsigned long long link_up_time;\n\tunsigned long long link_down_time;\n\n\t \n\tunsigned long long tx_buf_abort_cnt;\n\tunsigned long long tx_desc_abort_cnt;\n\tunsigned long long tx_parity_err_cnt;\n\tunsigned long long tx_link_loss_cnt;\n\tunsigned long long tx_list_proc_err_cnt;\n\n\tunsigned long long rx_parity_err_cnt;\n\tunsigned long long rx_abort_cnt;\n\tunsigned long long rx_parity_abort_cnt;\n\tunsigned long long rx_rda_fail_cnt;\n\tunsigned long long rx_unkn_prot_cnt;\n\tunsigned long long rx_fcs_err_cnt;\n\tunsigned long long rx_buf_size_err_cnt;\n\tunsigned long long rx_rxd_corrupt_cnt;\n\tunsigned long long rx_unkn_err_cnt;\n\n\t \n\tunsigned long long tda_err_cnt;\n\tunsigned long long pfc_err_cnt;\n\tunsigned long long pcc_err_cnt;\n\tunsigned long long tti_err_cnt;\n\tunsigned long long lso_err_cnt;\n\tunsigned long long tpa_err_cnt;\n\tunsigned long long sm_err_cnt;\n\tunsigned long long mac_tmac_err_cnt;\n\tunsigned long long mac_rmac_err_cnt;\n\tunsigned long long xgxs_txgxs_err_cnt;\n\tunsigned long long xgxs_rxgxs_err_cnt;\n\tunsigned long long rc_err_cnt;\n\tunsigned long long prc_pcix_err_cnt;\n\tunsigned long long rpa_err_cnt;\n\tunsigned long long rda_err_cnt;\n\tunsigned long long rti_err_cnt;\n\tunsigned long long mc_err_cnt;\n\n};\n\n \nstruct xpakStat {\n\tu64 alarm_transceiver_temp_high;\n\tu64 alarm_transceiver_temp_low;\n\tu64 alarm_laser_bias_current_high;\n\tu64 alarm_laser_bias_current_low;\n\tu64 alarm_laser_output_power_high;\n\tu64 alarm_laser_output_power_low;\n\tu64 warn_transceiver_temp_high;\n\tu64 warn_transceiver_temp_low;\n\tu64 warn_laser_bias_current_high;\n\tu64 warn_laser_bias_current_low;\n\tu64 warn_laser_output_power_high;\n\tu64 warn_laser_output_power_low;\n\tu64 xpak_regs_stat;\n\tu32 xpak_timer_count;\n};\n\n\n \nstruct stat_block {\n \n\t__le32 tmac_data_octets;\n\t__le32 tmac_frms;\n\t__le64 tmac_drop_frms;\n\t__le32 tmac_bcst_frms;\n\t__le32 tmac_mcst_frms;\n\t__le64 tmac_pause_ctrl_frms;\n\t__le32 tmac_ucst_frms;\n\t__le32 tmac_ttl_octets;\n\t__le32 tmac_any_err_frms;\n\t__le32 tmac_nucst_frms;\n\t__le64 tmac_ttl_less_fb_octets;\n\t__le64 tmac_vld_ip_octets;\n\t__le32 tmac_drop_ip;\n\t__le32 tmac_vld_ip;\n\t__le32 tmac_rst_tcp;\n\t__le32 tmac_icmp;\n\t__le64 tmac_tcp;\n\t__le32 reserved_0;\n\t__le32 tmac_udp;\n\n \n\t__le32 rmac_data_octets;\n\t__le32 rmac_vld_frms;\n\t__le64 rmac_fcs_err_frms;\n\t__le64 rmac_drop_frms;\n\t__le32 rmac_vld_bcst_frms;\n\t__le32 rmac_vld_mcst_frms;\n\t__le32 rmac_out_rng_len_err_frms;\n\t__le32 rmac_in_rng_len_err_frms;\n\t__le64 rmac_long_frms;\n\t__le64 rmac_pause_ctrl_frms;\n\t__le64 rmac_unsup_ctrl_frms;\n\t__le32 rmac_accepted_ucst_frms;\n\t__le32 rmac_ttl_octets;\n\t__le32 rmac_discarded_frms;\n\t__le32 rmac_accepted_nucst_frms;\n\t__le32 reserved_1;\n\t__le32 rmac_drop_events;\n\t__le64 rmac_ttl_less_fb_octets;\n\t__le64 rmac_ttl_frms;\n\t__le64 reserved_2;\n\t__le32 rmac_usized_frms;\n\t__le32 reserved_3;\n\t__le32 rmac_frag_frms;\n\t__le32 rmac_osized_frms;\n\t__le32 reserved_4;\n\t__le32 rmac_jabber_frms;\n\t__le64 rmac_ttl_64_frms;\n\t__le64 rmac_ttl_65_127_frms;\n\t__le64 reserved_5;\n\t__le64 rmac_ttl_128_255_frms;\n\t__le64 rmac_ttl_256_511_frms;\n\t__le64 reserved_6;\n\t__le64 rmac_ttl_512_1023_frms;\n\t__le64 rmac_ttl_1024_1518_frms;\n\t__le32 rmac_ip;\n\t__le32 reserved_7;\n\t__le64 rmac_ip_octets;\n\t__le32 rmac_drop_ip;\n\t__le32 rmac_hdr_err_ip;\n\t__le32 reserved_8;\n\t__le32 rmac_icmp;\n\t__le64 rmac_tcp;\n\t__le32 rmac_err_drp_udp;\n\t__le32 rmac_udp;\n\t__le64 rmac_xgmii_err_sym;\n\t__le64 rmac_frms_q0;\n\t__le64 rmac_frms_q1;\n\t__le64 rmac_frms_q2;\n\t__le64 rmac_frms_q3;\n\t__le64 rmac_frms_q4;\n\t__le64 rmac_frms_q5;\n\t__le64 rmac_frms_q6;\n\t__le64 rmac_frms_q7;\n\t__le16 rmac_full_q3;\n\t__le16 rmac_full_q2;\n\t__le16 rmac_full_q1;\n\t__le16 rmac_full_q0;\n\t__le16 rmac_full_q7;\n\t__le16 rmac_full_q6;\n\t__le16 rmac_full_q5;\n\t__le16 rmac_full_q4;\n\t__le32 reserved_9;\n\t__le32 rmac_pause_cnt;\n\t__le64 rmac_xgmii_data_err_cnt;\n\t__le64 rmac_xgmii_ctrl_err_cnt;\n\t__le32 rmac_err_tcp;\n\t__le32 rmac_accepted_ip;\n\n \n\t__le32 new_rd_req_cnt;\n\t__le32 rd_req_cnt;\n\t__le32 rd_rtry_cnt;\n\t__le32 new_rd_req_rtry_cnt;\n\n \n\t__le32 wr_req_cnt;\n\t__le32 wr_rtry_rd_ack_cnt;\n\t__le32 new_wr_req_rtry_cnt;\n\t__le32 new_wr_req_cnt;\n\t__le32 wr_disc_cnt;\n\t__le32 wr_rtry_cnt;\n\n \n\t__le32 txp_wr_cnt;\n\t__le32 rd_rtry_wr_ack_cnt;\n\t__le32 txd_wr_cnt;\n\t__le32 txd_rd_cnt;\n\t__le32 rxd_wr_cnt;\n\t__le32 rxd_rd_cnt;\n\t__le32 rxf_wr_cnt;\n\t__le32 txf_rd_cnt;\n\n \n\t__le32 tmac_data_octets_oflow;\n\t__le32 tmac_frms_oflow;\n\t__le32 tmac_bcst_frms_oflow;\n\t__le32 tmac_mcst_frms_oflow;\n\t__le32 tmac_ucst_frms_oflow;\n\t__le32 tmac_ttl_octets_oflow;\n\t__le32 tmac_any_err_frms_oflow;\n\t__le32 tmac_nucst_frms_oflow;\n\t__le64 tmac_vlan_frms;\n\t__le32 tmac_drop_ip_oflow;\n\t__le32 tmac_vld_ip_oflow;\n\t__le32 tmac_rst_tcp_oflow;\n\t__le32 tmac_icmp_oflow;\n\t__le32 tpa_unknown_protocol;\n\t__le32 tmac_udp_oflow;\n\t__le32 reserved_10;\n\t__le32 tpa_parse_failure;\n\n \n\t__le32 rmac_data_octets_oflow;\n\t__le32 rmac_vld_frms_oflow;\n\t__le32 rmac_vld_bcst_frms_oflow;\n\t__le32 rmac_vld_mcst_frms_oflow;\n\t__le32 rmac_accepted_ucst_frms_oflow;\n\t__le32 rmac_ttl_octets_oflow;\n\t__le32 rmac_discarded_frms_oflow;\n\t__le32 rmac_accepted_nucst_frms_oflow;\n\t__le32 rmac_usized_frms_oflow;\n\t__le32 rmac_drop_events_oflow;\n\t__le32 rmac_frag_frms_oflow;\n\t__le32 rmac_osized_frms_oflow;\n\t__le32 rmac_ip_oflow;\n\t__le32 rmac_jabber_frms_oflow;\n\t__le32 rmac_icmp_oflow;\n\t__le32 rmac_drop_ip_oflow;\n\t__le32 rmac_err_drp_udp_oflow;\n\t__le32 rmac_udp_oflow;\n\t__le32 reserved_11;\n\t__le32 rmac_pause_cnt_oflow;\n\t__le64 rmac_ttl_1519_4095_frms;\n\t__le64 rmac_ttl_4096_8191_frms;\n\t__le64 rmac_ttl_8192_max_frms;\n\t__le64 rmac_ttl_gt_max_frms;\n\t__le64 rmac_osized_alt_frms;\n\t__le64 rmac_jabber_alt_frms;\n\t__le64 rmac_gt_max_alt_frms;\n\t__le64 rmac_vlan_frms;\n\t__le32 rmac_len_discard;\n\t__le32 rmac_fcs_discard;\n\t__le32 rmac_pf_discard;\n\t__le32 rmac_da_discard;\n\t__le32 rmac_red_discard;\n\t__le32 rmac_rts_discard;\n\t__le32 reserved_12;\n\t__le32 rmac_ingm_full_discard;\n\t__le32 reserved_13;\n\t__le32 rmac_accepted_ip_oflow;\n\t__le32 reserved_14;\n\t__le32 link_fault_cnt;\n\tu8  buffer[20];\n\tstruct swStat sw_stat;\n\tstruct xpakStat xpak_stat;\n};\n\n \n#define NO_STRIP_IN_PROMISC 2\n\n \n\n#define MAX_TX_FIFOS 8\n#define MAX_RX_RINGS 8\n\n#define FIFO_DEFAULT_NUM\t5\n#define FIFO_UDP_MAX_NUM\t\t\t2  \n#define FIFO_OTHER_MAX_NUM\t\t\t1\n\n\n#define MAX_RX_DESC_1  (MAX_RX_RINGS * MAX_RX_BLOCKS_PER_RING * 128)\n#define MAX_RX_DESC_2  (MAX_RX_RINGS * MAX_RX_BLOCKS_PER_RING * 86)\n#define MAX_TX_DESC    (MAX_AVAILABLE_TXDS)\n\n \nstatic const int fifo_map[][MAX_TX_FIFOS] = {\n\t{0, 0, 0, 0, 0, 0, 0, 0},\n\t{0, 0, 0, 0, 1, 1, 1, 1},\n\t{0, 0, 0, 1, 1, 1, 2, 2},\n\t{0, 0, 1, 1, 2, 2, 3, 3},\n\t{0, 0, 1, 1, 2, 2, 3, 4},\n\t{0, 0, 1, 1, 2, 3, 4, 5},\n\t{0, 0, 1, 2, 3, 4, 5, 6},\n\t{0, 1, 2, 3, 4, 5, 6, 7},\n};\n\nstatic const u16 fifo_selector[MAX_TX_FIFOS] = {0, 1, 3, 3, 7, 7, 7, 7};\n\n \nstruct tx_fifo_config {\n#define\tMAX_AVAILABLE_TXDS\t8192\n\tu32 fifo_len;\t\t \n \n#define TX_FIFO_PRI_0               0\t \n#define TX_FIFO_PRI_1               1\n#define TX_FIFO_PRI_2               2\n#define TX_FIFO_PRI_3               3\n#define TX_FIFO_PRI_4               4\n#define TX_FIFO_PRI_5               5\n#define TX_FIFO_PRI_6               6\n#define TX_FIFO_PRI_7               7\t \n\tu8 fifo_priority;\t \n\t \n\tu8 f_no_snoop;\n#define NO_SNOOP_TXD                0x01\n#define NO_SNOOP_TXD_BUFFER          0x02\n};\n\n\n \nstruct rx_ring_config {\n\tu32 num_rxd;\t\t \n#define RX_RING_PRI_0               0\t \n#define RX_RING_PRI_1               1\n#define RX_RING_PRI_2               2\n#define RX_RING_PRI_3               3\n#define RX_RING_PRI_4               4\n#define RX_RING_PRI_5               5\n#define RX_RING_PRI_6               6\n#define RX_RING_PRI_7               7\t \n\n\tu8 ring_priority;\t \n\t \n\tu8 ring_org;\t\t \n#define RING_ORG_BUFF1\t\t0x01\n#define RX_RING_ORG_BUFF3\t0x03\n#define RX_RING_ORG_BUFF5\t0x05\n\n\tu8 f_no_snoop;\n#define NO_SNOOP_RXD                0x01\n#define NO_SNOOP_RXD_BUFFER         0x02\n};\n\n \nstruct config_param {\n \n\tu32 tx_fifo_num;\t \n\n\t \n#define\tNO_STEERING\t\t\t\t0\n#define\tTX_PRIORITY_STEERING\t\t\t0x1\n#define TX_DEFAULT_STEERING \t\t\t0x2\n\tu8 tx_steering_type;\n\n\tu8 fifo_mapping[MAX_TX_FIFOS];\n\tstruct tx_fifo_config tx_cfg[MAX_TX_FIFOS];\t \n\tu32 max_txds;\t\t \n\tu64 tx_intr_type;\n#define INTA\t0\n#define MSI_X\t2\n\tu8 intr_type;\n\tu8 napi;\n\n\t \n\n \n\tu32 rx_ring_num;\t \n#define MAX_RX_BLOCKS_PER_RING  150\n\n\tstruct rx_ring_config rx_cfg[MAX_RX_RINGS];\t \n\n#define HEADER_ETHERNET_II_802_3_SIZE 14\n#define HEADER_802_2_SIZE              3\n#define HEADER_SNAP_SIZE               5\n#define HEADER_VLAN_SIZE               4\n\n#define MIN_MTU                       46\n#define MAX_PYLD                    1500\n#define MAX_MTU                     (MAX_PYLD+18)\n#define MAX_MTU_VLAN                (MAX_PYLD+22)\n#define MAX_PYLD_JUMBO              9600\n#define MAX_MTU_JUMBO               (MAX_PYLD_JUMBO+18)\n#define MAX_MTU_JUMBO_VLAN          (MAX_PYLD_JUMBO+22)\n\tu16 bus_speed;\n\tint max_mc_addr;\t \n\tint max_mac_addr;\t \n\tint mc_start_offset;\t \n\tu8 multiq;\n};\n\n \nstruct mac_addr {\n\tu8 mac_addr[ETH_ALEN];\n};\n\n \nstruct TxFIFO_element {\n\tu64 TxDL_Pointer;\n\n\tu64 List_Control;\n#define TX_FIFO_LAST_TXD_NUM( val)     vBIT(val,0,8)\n#define TX_FIFO_FIRST_LIST             s2BIT(14)\n#define TX_FIFO_LAST_LIST              s2BIT(15)\n#define TX_FIFO_FIRSTNLAST_LIST        vBIT(3,14,2)\n#define TX_FIFO_SPECIAL_FUNC           s2BIT(23)\n#define TX_FIFO_DS_NO_SNOOP            s2BIT(31)\n#define TX_FIFO_BUFF_NO_SNOOP          s2BIT(30)\n};\n\n \nstruct TxD {\n\tu64 Control_1;\n \n#define TXD_LIST_OWN_XENA       s2BIT(7)\n#define TXD_T_CODE              (s2BIT(12)|s2BIT(13)|s2BIT(14)|s2BIT(15))\n#define TXD_T_CODE_OK(val)      (|(val & TXD_T_CODE))\n#define GET_TXD_T_CODE(val)     ((val & TXD_T_CODE)<<12)\n#define TXD_GATHER_CODE         (s2BIT(22) | s2BIT(23))\n#define TXD_GATHER_CODE_FIRST   s2BIT(22)\n#define TXD_GATHER_CODE_LAST    s2BIT(23)\n#define TXD_TCP_LSO_EN          s2BIT(30)\n#define TXD_UDP_COF_EN          s2BIT(31)\n#define TXD_UFO_EN\t\ts2BIT(31) | s2BIT(30)\n#define TXD_TCP_LSO_MSS(val)    vBIT(val,34,14)\n#define TXD_UFO_MSS(val)\tvBIT(val,34,14)\n#define TXD_BUFFER0_SIZE(val)   vBIT(val,48,16)\n\n\tu64 Control_2;\n#define TXD_TX_CKO_CONTROL      (s2BIT(5)|s2BIT(6)|s2BIT(7))\n#define TXD_TX_CKO_IPV4_EN      s2BIT(5)\n#define TXD_TX_CKO_TCP_EN       s2BIT(6)\n#define TXD_TX_CKO_UDP_EN       s2BIT(7)\n#define TXD_VLAN_ENABLE         s2BIT(15)\n#define TXD_VLAN_TAG(val)       vBIT(val,16,16)\n#define TXD_INT_NUMBER(val)     vBIT(val,34,6)\n#define TXD_INT_TYPE_PER_LIST   s2BIT(47)\n#define TXD_INT_TYPE_UTILZ      s2BIT(46)\n#define TXD_SET_MARKER         vBIT(0x6,0,4)\n\n\tu64 Buffer_Pointer;\n\tu64 Host_Control;\t \n};\n\n \nstruct list_info_hold {\n\tdma_addr_t list_phy_addr;\n\tvoid *list_virt_addr;\n};\n\n \nstruct RxD_t {\n\tu64 Host_Control;\t \n\tu64 Control_1;\n#define RXD_OWN_XENA            s2BIT(7)\n#define RXD_T_CODE              (s2BIT(12)|s2BIT(13)|s2BIT(14)|s2BIT(15))\n#define RXD_FRAME_PROTO         vBIT(0xFFFF,24,8)\n#define RXD_FRAME_VLAN_TAG      s2BIT(24)\n#define RXD_FRAME_PROTO_IPV4    s2BIT(27)\n#define RXD_FRAME_PROTO_IPV6    s2BIT(28)\n#define RXD_FRAME_IP_FRAG\ts2BIT(29)\n#define RXD_FRAME_PROTO_TCP     s2BIT(30)\n#define RXD_FRAME_PROTO_UDP     s2BIT(31)\n#define TCP_OR_UDP_FRAME        (RXD_FRAME_PROTO_TCP | RXD_FRAME_PROTO_UDP)\n#define RXD_GET_L3_CKSUM(val)   ((u16)(val>> 16) & 0xFFFF)\n#define RXD_GET_L4_CKSUM(val)   ((u16)(val) & 0xFFFF)\n\n\tu64 Control_2;\n#define\tTHE_RXD_MARK\t\t0x3\n#define\tSET_RXD_MARKER\t\tvBIT(THE_RXD_MARK, 0, 2)\n#define\tGET_RXD_MARKER(ctrl)\t((ctrl & SET_RXD_MARKER) >> 62)\n\n#define MASK_VLAN_TAG           vBIT(0xFFFF,48,16)\n#define SET_VLAN_TAG(val)       vBIT(val,48,16)\n#define SET_NUM_TAG(val)       vBIT(val,16,32)\n\n\n};\n \nstruct RxD1 {\n\tstruct RxD_t h;\n\n#define MASK_BUFFER0_SIZE_1       vBIT(0x3FFF,2,14)\n#define SET_BUFFER0_SIZE_1(val)   vBIT(val,2,14)\n#define RXD_GET_BUFFER0_SIZE_1(_Control_2) \\\n\t(u16)((_Control_2 & MASK_BUFFER0_SIZE_1) >> 48)\n\tu64 Buffer0_ptr;\n};\n \n\nstruct RxD3 {\n\tstruct RxD_t h;\n\n#define MASK_BUFFER0_SIZE_3       vBIT(0xFF,2,14)\n#define MASK_BUFFER1_SIZE_3       vBIT(0xFFFF,16,16)\n#define MASK_BUFFER2_SIZE_3       vBIT(0xFFFF,32,16)\n#define SET_BUFFER0_SIZE_3(val)   vBIT(val,8,8)\n#define SET_BUFFER1_SIZE_3(val)   vBIT(val,16,16)\n#define SET_BUFFER2_SIZE_3(val)   vBIT(val,32,16)\n#define RXD_GET_BUFFER0_SIZE_3(Control_2) \\\n\t(u8)((Control_2 & MASK_BUFFER0_SIZE_3) >> 48)\n#define RXD_GET_BUFFER1_SIZE_3(Control_2) \\\n\t(u16)((Control_2 & MASK_BUFFER1_SIZE_3) >> 32)\n#define RXD_GET_BUFFER2_SIZE_3(Control_2) \\\n\t(u16)((Control_2 & MASK_BUFFER2_SIZE_3) >> 16)\n#define BUF0_LEN\t40\n#define BUF1_LEN\t1\n\n\tu64 Buffer0_ptr;\n\tu64 Buffer1_ptr;\n\tu64 Buffer2_ptr;\n};\n\n\n \nstruct RxD_block {\n#define MAX_RXDS_PER_BLOCK_1            127\n\tstruct RxD1 rxd[MAX_RXDS_PER_BLOCK_1];\n\n\tu64 reserved_0;\n#define END_OF_BLOCK    0xFEFFFFFFFFFFFFFFULL\n\tu64 reserved_1;\t\t \n\tu64 reserved_2_pNext_RxD_block;\t \n\tu64 pNext_RxD_Blk_physical;\t \n};\n\n#define SIZE_OF_BLOCK\t4096\n\n#define RXD_MODE_1\t0  \n#define RXD_MODE_3B\t1  \n\n \nstruct buffAdd {\n\tvoid *ba_0_org;\n\tvoid *ba_1_org;\n\tvoid *ba_0;\n\tvoid *ba_1;\n};\n\n \n\n \nstruct rx_curr_get_info {\n\tu32 block_index;\n\tu32 offset;\n\tu32 ring_len;\n};\n\nstruct rx_curr_put_info {\n\tu32 block_index;\n\tu32 offset;\n\tu32 ring_len;\n};\n\n \nstruct tx_curr_get_info {\n\tu32 offset;\n\tu32 fifo_len;\n};\n\nstruct tx_curr_put_info {\n\tu32 offset;\n\tu32 fifo_len;\n};\n\nstruct rxd_info {\n\tvoid *virt_addr;\n\tdma_addr_t dma_addr;\n};\n\n \nstruct rx_block_info {\n\tvoid *block_virt_addr;\n\tdma_addr_t block_dma_addr;\n\tstruct rxd_info *rxds;\n};\n\n \nstruct lro {\n\tstruct sk_buff\t*parent;\n\tstruct sk_buff  *last_frag;\n\tu8\t\t*l2h;\n\tstruct iphdr\t*iph;\n\tstruct tcphdr\t*tcph;\n\tu32\t\ttcp_next_seq;\n\t__be32\t\ttcp_ack;\n\tint\t\ttotal_len;\n\tint\t\tfrags_len;\n\tint\t\tsg_num;\n\tint\t\tin_use;\n\t__be16\t\twindow;\n\tu16             vlan_tag;\n\tu32\t\tcur_tsval;\n\t__be32\t\tcur_tsecr;\n\tu8\t\tsaw_ts;\n} ____cacheline_aligned;\n\n \nstruct ring_info {\n\t \n\tint ring_no;\n\n\t \n\tu32 rx_bufs_left;\n\n#define MAX_LRO_SESSIONS       32\n\tstruct lro lro0_n[MAX_LRO_SESSIONS];\n\tu8\t\tlro;\n\n\t \n\tint rxd_mode;\n\n\t \n\tint rxd_count;\n\n\t \n\tstruct s2io_nic *nic;\n\n\t \n\tstruct net_device *dev;\n\n\t \n\tstruct pci_dev *pdev;\n\n\t \n\tstruct napi_struct napi;\n\n\tunsigned long interrupt_count;\n\n\t \n\tstruct rx_block_info rx_blocks[MAX_RX_BLOCKS_PER_RING];\n\tint block_count;\n\tint pkt_cnt;\n\n\t \n\tstruct rx_curr_put_info rx_curr_put_info;\n\n\t \n\tstruct rx_curr_get_info rx_curr_get_info;\n\n\t \n        unsigned mtu;\n\n\t \n\tstruct buffAdd **ba;\n} ____cacheline_aligned;\n\n \nstruct fifo_info {\n\t \n\tint fifo_no;\n\n\t \n\tint max_txds;\n\n\t \n\tstruct list_info_hold *list_info;\n\n\t \n\tstruct tx_curr_put_info tx_curr_put_info;\n\n\t \n\tstruct tx_curr_get_info tx_curr_get_info;\n#define FIFO_QUEUE_START 0\n#define FIFO_QUEUE_STOP 1\n\tint queue_state;\n\n\t \n\tstruct net_device *dev;\n\n\t \n\tu8 multiq;\n\n\t \n\tspinlock_t tx_lock;\n\n\t \n\tu64 *ufo_in_band_v;\n\n\tstruct s2io_nic *nic;\n} ____cacheline_aligned;\n\n \nstruct mac_info {\n \n\t \n\tstruct TxFIFO_element __iomem *tx_FIFO_start[MAX_TX_FIFOS];\n\n\t \n\tstruct fifo_info fifos[MAX_TX_FIFOS];\n\n\t \n\tvoid *zerodma_virt_addr;\n\n \n\t \n\tstruct ring_info rings[MAX_RX_RINGS];\n\n\tu16 rmac_pause_time;\n\tu16 mc_pause_threshold_q0q3;\n\tu16 mc_pause_threshold_q4q7;\n\n\tvoid *stats_mem;\t \n\tdma_addr_t stats_mem_phy;\t \n\tu32 stats_mem_sz;\n\tstruct stat_block *stats_info;\t \n};\n\n \n#define DEFAULT_FIFO_0_LEN 4096\n#define DEFAULT_FIFO_1_7_LEN 512\n#define SMALL_BLK_CNT\t30\n#define LARGE_BLK_CNT\t100\n\n \n#define MAX_REQUESTED_MSI_X\t9\nstruct s2io_msix_entry\n{\n\tu16 vector;\n\tu16 entry;\n\tvoid *arg;\n\n\tu8 type;\n#define        MSIX_ALARM_TYPE         1\n#define        MSIX_RING_TYPE          2\n\n\tu8 in_use;\n#define MSIX_REGISTERED_SUCCESS\t0xAA\n};\n\nstruct msix_info_st {\n\tu64 addr;\n\tu64 data;\n};\n\n \nenum s2io_device_state_t\n{\n\t__S2IO_STATE_LINK_TASK=0,\n\t__S2IO_STATE_CARD_UP\n};\n\n \nstruct s2io_nic {\n\tint rxd_mode;\n\t \n\tint pkts_to_process;\n\tstruct net_device *dev;\n\tstruct mac_info mac_control;\n\tstruct config_param config;\n\tstruct pci_dev *pdev;\n\tvoid __iomem *bar0;\n\tvoid __iomem *bar1;\n#define MAX_MAC_SUPPORTED   16\n#define MAX_SUPPORTED_MULTICASTS MAX_MAC_SUPPORTED\n\n\tstruct mac_addr def_mac_addr[256];\n\n\tstruct net_device_stats stats;\n\tint device_enabled_once;\n\n\tchar name[60];\n\n\t \n\tstruct timer_list alarm_timer;\n\n\t \n\tu32 config_space[256 / sizeof(u32)];\n\n#define PROMISC     1\n#define ALL_MULTI   2\n\n#define MAX_ADDRS_SUPPORTED 64\n\tu16 mc_addr_count;\n\n\tu16 m_cast_flg;\n\tu16 all_multi_pos;\n\tu16 promisc_flg;\n\n\t \n\tstruct work_struct rst_timer_task;\n\tstruct work_struct set_link_task;\n\n\t \n\tint rx_csum;\n\n\t \n\tu16 fifo_selector[MAX_TX_FIFOS];\n\n\t \n\tu8 total_tcp_fifos;\n\n\t \n\tu8 udp_fifo_idx;\n\n\tu8 total_udp_fifos;\n\n\t \n\tu8 other_fifo_idx;\n\n\tstruct napi_struct napi;\n\t \n\tu64 adapt_ctrl_org;\n\n\t \n\tu16 last_link_state;\n#define\tLINK_DOWN\t1\n#define\tLINK_UP\t\t2\n\n\tint task_flag;\n\tunsigned long long start_time;\n\tint vlan_strip_flag;\n#define MSIX_FLG                0xA5\n\tint num_entries;\n\tstruct msix_entry *entries;\n\tint msi_detected;\n\twait_queue_head_t msi_wait;\n\tstruct s2io_msix_entry *s2io_entries;\n\tchar desc[MAX_REQUESTED_MSI_X][25];\n\n\tint avail_msix_vectors;  \n\n\tstruct msix_info_st msix_info[0x3f];\n\n#define XFRAME_I_DEVICE\t\t1\n#define XFRAME_II_DEVICE\t2\n\tu8 device_type;\n\n\tunsigned long\tclubbed_frms_cnt;\n\tunsigned long\tsending_both;\n\tu16\t\tlro_max_aggr_per_sess;\n\tvolatile unsigned long state;\n\tu64\t\tgeneral_int_mask;\n\n#define VPD_STRING_LEN 80\n\tu8  product_name[VPD_STRING_LEN];\n\tu8  serial_num[VPD_STRING_LEN];\n};\n\n#define RESET_ERROR 1\n#define CMD_ERROR   2\n\n \n#define UF\t1\n#define LF\t2\nstatic inline void SPECIAL_REG_WRITE(u64 val, void __iomem *addr, int order)\n{\n\tif (order == LF) {\n\t\twritel((u32) (val), addr);\n\t\t(void) readl(addr);\n\t\twritel((u32) (val >> 32), (addr + 4));\n\t\t(void) readl(addr + 4);\n\t} else {\n\t\twritel((u32) (val >> 32), (addr + 4));\n\t\t(void) readl(addr + 4);\n\t\twritel((u32) (val), addr);\n\t\t(void) readl(addr);\n\t}\n}\n\n \n\n#define ENABLE_INTRS    1\n#define DISABLE_INTRS   2\n\n \n#define TX_PIC_INTR     (0x0001<<0)\n#define TX_DMA_INTR     (0x0001<<1)\n#define TX_MAC_INTR     (0x0001<<2)\n#define TX_XGXS_INTR    (0x0001<<3)\n#define TX_TRAFFIC_INTR (0x0001<<4)\n#define RX_PIC_INTR     (0x0001<<5)\n#define RX_DMA_INTR     (0x0001<<6)\n#define RX_MAC_INTR     (0x0001<<7)\n#define RX_XGXS_INTR    (0x0001<<8)\n#define RX_TRAFFIC_INTR (0x0001<<9)\n#define MC_INTR         (0x0001<<10)\n#define ENA_ALL_INTRS    (   TX_PIC_INTR     | \\\n                            TX_DMA_INTR     | \\\n                            TX_MAC_INTR     | \\\n                            TX_XGXS_INTR    | \\\n                            TX_TRAFFIC_INTR | \\\n                            RX_PIC_INTR     | \\\n                            RX_DMA_INTR     | \\\n                            RX_MAC_INTR     | \\\n                            RX_XGXS_INTR    | \\\n                            RX_TRAFFIC_INTR | \\\n                            MC_INTR )\n\n \n#define DISABLE_ALL_INTRS   0xFFFFFFFFFFFFFFFFULL\n\n#define TXPIC_INT_M         s2BIT(0)\n#define TXDMA_INT_M         s2BIT(1)\n#define TXMAC_INT_M         s2BIT(2)\n#define TXXGXS_INT_M        s2BIT(3)\n#define TXTRAFFIC_INT_M     s2BIT(8)\n#define PIC_RX_INT_M        s2BIT(32)\n#define RXDMA_INT_M         s2BIT(33)\n#define RXMAC_INT_M         s2BIT(34)\n#define MC_INT_M            s2BIT(35)\n#define RXXGXS_INT_M        s2BIT(36)\n#define RXTRAFFIC_INT_M     s2BIT(40)\n\n \n\n \n#define TXDMA_PFC_INT_M     s2BIT(0)\n#define TXDMA_PCC_INT_M     s2BIT(2)\n\n \n#define PFC_MISC_ERR_1      s2BIT(0)\t \n\n \n#define\tPCC_FB_ECC_ERR\t   vBIT(0xff, 16, 8)\t \n\n#define RXD_GET_VLAN_TAG(Control_2) (u16)(Control_2 & MASK_VLAN_TAG)\n \nstatic int s2io_init_nic(struct pci_dev *pdev, const struct pci_device_id *pre);\nstatic void s2io_rem_nic(struct pci_dev *pdev);\nstatic int init_shared_mem(struct s2io_nic *sp);\nstatic void free_shared_mem(struct s2io_nic *sp);\nstatic int init_nic(struct s2io_nic *nic);\nstatic int rx_intr_handler(struct ring_info *ring_data, int budget);\nstatic void s2io_txpic_intr_handle(struct s2io_nic *sp);\nstatic void tx_intr_handler(struct fifo_info *fifo_data);\nstatic void s2io_handle_errors(void * dev_id);\n\nstatic void s2io_tx_watchdog(struct net_device *dev, unsigned int txqueue);\nstatic void s2io_set_multicast(struct net_device *dev, bool may_sleep);\nstatic int rx_osm_handler(struct ring_info *ring_data, struct RxD_t * rxdp);\nstatic void s2io_link(struct s2io_nic * sp, int link);\nstatic void s2io_reset(struct s2io_nic * sp);\nstatic int s2io_poll_msix(struct napi_struct *napi, int budget);\nstatic int s2io_poll_inta(struct napi_struct *napi, int budget);\nstatic void s2io_init_pci(struct s2io_nic * sp);\nstatic int do_s2io_prog_unicast(struct net_device *dev, const u8 *addr);\nstatic void s2io_alarm_handle(struct timer_list *t);\nstatic irqreturn_t\ns2io_msix_ring_handle(int irq, void *dev_id);\nstatic irqreturn_t\ns2io_msix_fifo_handle(int irq, void *dev_id);\nstatic irqreturn_t s2io_isr(int irq, void *dev_id);\nstatic int verify_xena_quiescence(struct s2io_nic *sp);\nstatic const struct ethtool_ops netdev_ethtool_ops;\nstatic void s2io_set_link(struct work_struct *work);\nstatic int s2io_set_swapper(struct s2io_nic * sp);\nstatic void s2io_card_down(struct s2io_nic *nic);\nstatic int s2io_card_up(struct s2io_nic *nic);\nstatic int wait_for_cmd_complete(void __iomem *addr, u64 busy_bit,\n\t\t\t\t int bit_state, bool may_sleep);\nstatic int s2io_add_isr(struct s2io_nic * sp);\nstatic void s2io_rem_isr(struct s2io_nic * sp);\n\nstatic void restore_xmsi_data(struct s2io_nic *nic);\nstatic void do_s2io_store_unicast_mc(struct s2io_nic *sp);\nstatic void do_s2io_restore_unicast_mc(struct s2io_nic *sp);\nstatic u64 do_s2io_read_unicast_mc(struct s2io_nic *sp, int offset);\nstatic int do_s2io_add_mc(struct s2io_nic *sp, u8 *addr);\nstatic int do_s2io_add_mac(struct s2io_nic *sp, u64 addr, int offset);\nstatic int do_s2io_delete_unicast_mc(struct s2io_nic *sp, u64 addr);\n\nstatic int s2io_club_tcp_session(struct ring_info *ring_data, u8 *buffer,\n\tu8 **tcp, u32 *tcp_len, struct lro **lro, struct RxD_t *rxdp,\n\tstruct s2io_nic *sp);\nstatic void clear_lro_session(struct lro *lro);\nstatic void queue_rx_frame(struct sk_buff *skb, u16 vlan_tag);\nstatic void update_L3L4_header(struct s2io_nic *sp, struct lro *lro);\nstatic void lro_append_pkt(struct s2io_nic *sp, struct lro *lro,\n\t\t\t   struct sk_buff *skb, u32 tcp_len);\nstatic int rts_ds_steer(struct s2io_nic *nic, u8 ds_codepoint, u8 ring);\n\nstatic pci_ers_result_t s2io_io_error_detected(struct pci_dev *pdev,\n\t\t\t                      pci_channel_state_t state);\nstatic pci_ers_result_t s2io_io_slot_reset(struct pci_dev *pdev);\nstatic void s2io_io_resume(struct pci_dev *pdev);\n\n#define s2io_tcp_mss(skb) skb_shinfo(skb)->gso_size\n#define s2io_udp_mss(skb) skb_shinfo(skb)->gso_size\n#define s2io_offload_type(skb) skb_shinfo(skb)->gso_type\n\n#define S2IO_PARM_INT(X, def_val) \\\n\tstatic unsigned int X = def_val;\\\n\t\tmodule_param(X , uint, 0);\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}