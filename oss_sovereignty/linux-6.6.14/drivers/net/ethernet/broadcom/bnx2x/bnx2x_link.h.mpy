{
  "module_name": "bnx2x_link.h",
  "hash_id": "ecbf4f327d5555a55a4b30e92bc8bbdbd2be5b44bd0895b58f431e47b463151d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/broadcom/bnx2x/bnx2x_link.h",
  "human_readable_source": " \n\n#ifndef BNX2X_LINK_H\n#define BNX2X_LINK_H\n\n\n\n \n \n \n#define DEFAULT_PHY_DEV_ADDR\t3\n#define E2_DEFAULT_PHY_DEV_ADDR\t5\n\n\n\n#define BNX2X_FLOW_CTRL_AUTO\t\tPORT_FEATURE_FLOW_CONTROL_AUTO\n#define BNX2X_FLOW_CTRL_TX\t\tPORT_FEATURE_FLOW_CONTROL_TX\n#define BNX2X_FLOW_CTRL_RX\t\tPORT_FEATURE_FLOW_CONTROL_RX\n#define BNX2X_FLOW_CTRL_BOTH\t\tPORT_FEATURE_FLOW_CONTROL_BOTH\n#define BNX2X_FLOW_CTRL_NONE\t\tPORT_FEATURE_FLOW_CONTROL_NONE\n\n#define NET_SERDES_IF_XFI\t\t1\n#define NET_SERDES_IF_SFI\t\t2\n#define NET_SERDES_IF_KR\t\t3\n#define NET_SERDES_IF_DXGXS\t4\n\n#define SPEED_AUTO_NEG\t\t0\n#define SPEED_20000\t\t20000\n\n#define I2C_DEV_ADDR_A0\t\t\t0xa0\n#define I2C_DEV_ADDR_A2\t\t\t0xa2\n\n#define SFP_EEPROM_PAGE_SIZE\t\t\t16\n#define SFP_EEPROM_VENDOR_NAME_ADDR\t\t0x14\n#define SFP_EEPROM_VENDOR_NAME_SIZE\t\t16\n#define SFP_EEPROM_VENDOR_OUI_ADDR\t\t0x25\n#define SFP_EEPROM_VENDOR_OUI_SIZE\t\t3\n#define SFP_EEPROM_PART_NO_ADDR\t\t\t0x28\n#define SFP_EEPROM_PART_NO_SIZE\t\t\t16\n#define SFP_EEPROM_REVISION_ADDR\t\t0x38\n#define SFP_EEPROM_REVISION_SIZE\t\t4\n#define SFP_EEPROM_SERIAL_ADDR\t\t\t0x44\n#define SFP_EEPROM_SERIAL_SIZE\t\t\t16\n#define SFP_EEPROM_DATE_ADDR\t\t\t0x54  \n#define SFP_EEPROM_DATE_SIZE\t\t\t6\n#define SFP_EEPROM_DIAG_TYPE_ADDR\t\t0x5c\n#define SFP_EEPROM_DIAG_TYPE_SIZE\t\t1\n#define SFP_EEPROM_DIAG_ADDR_CHANGE_REQ\t\t(1<<2)\n#define SFP_EEPROM_DDM_IMPLEMENTED\t\t(1<<6)\n#define SFP_EEPROM_SFF_8472_COMP_ADDR\t\t0x5e\n#define SFP_EEPROM_SFF_8472_COMP_SIZE\t\t1\n\n#define SFP_EEPROM_A2_CHECKSUM_RANGE\t\t0x5e\n#define SFP_EEPROM_A2_CC_DMI_ADDR\t\t0x5f\n\n#define PWR_FLT_ERR_MSG_LEN\t\t\t250\n\n#define XGXS_EXT_PHY_TYPE(ext_phy_config) \\\n\t\t((ext_phy_config) & PORT_HW_CFG_XGXS_EXT_PHY_TYPE_MASK)\n#define XGXS_EXT_PHY_ADDR(ext_phy_config) \\\n\t\t(((ext_phy_config) & PORT_HW_CFG_XGXS_EXT_PHY_ADDR_MASK) >> \\\n\t\t PORT_HW_CFG_XGXS_EXT_PHY_ADDR_SHIFT)\n#define SERDES_EXT_PHY_TYPE(ext_phy_config) \\\n\t\t((ext_phy_config) & PORT_HW_CFG_SERDES_EXT_PHY_TYPE_MASK)\n\n \n#define SINGLE_MEDIA_DIRECT(params)\t(params->num_phys == 1)\n \n#define SINGLE_MEDIA(params)\t\t(params->num_phys == 2)\n \n#define DUAL_MEDIA(params)\t\t(params->num_phys == 3)\n\n#define FW_PARAM_PHY_ADDR_MASK\t\t0x000000FF\n#define FW_PARAM_PHY_TYPE_MASK\t\t0x0000FF00\n#define FW_PARAM_MDIO_CTRL_MASK\t\t0xFFFF0000\n#define FW_PARAM_MDIO_CTRL_OFFSET\t\t16\n#define FW_PARAM_PHY_ADDR(fw_param) (fw_param & \\\n\t\t\t\t\t   FW_PARAM_PHY_ADDR_MASK)\n#define FW_PARAM_PHY_TYPE(fw_param) (fw_param & \\\n\t\t\t\t\t   FW_PARAM_PHY_TYPE_MASK)\n#define FW_PARAM_MDIO_CTRL(fw_param) ((fw_param & \\\n\t\t\t\t\t    FW_PARAM_MDIO_CTRL_MASK) >> \\\n\t\t\t\t\t    FW_PARAM_MDIO_CTRL_OFFSET)\n#define FW_PARAM_SET(phy_addr, phy_type, mdio_access) \\\n\t(phy_addr | phy_type | mdio_access << FW_PARAM_MDIO_CTRL_OFFSET)\n\n\n#define PFC_BRB_FULL_LB_XOFF_THRESHOLD\t\t\t\t170\n#define PFC_BRB_FULL_LB_XON_THRESHOLD\t\t\t\t250\n\n#define MAXVAL(a, b) (((a) > (b)) ? (a) : (b))\n\n#define BMAC_CONTROL_RX_ENABLE\t\t2\n \n \n \n#define INT_PHY\t\t0\n#define EXT_PHY1\t1\n#define EXT_PHY2\t2\n#define MAX_PHYS\t3\n\n \n#define LINK_CONFIG_SIZE (MAX_PHYS - 1)\n#define LINK_CONFIG_IDX(_phy_idx) ((_phy_idx == INT_PHY) ? \\\n\t\t\t\t\t 0 : (_phy_idx - 1))\n \n \n \n \nstruct link_vars;\nstruct link_params;\nstruct bnx2x_phy;\n\ntypedef void (*config_init_t)(struct bnx2x_phy *phy, struct link_params *params,\n\t\t\t      struct link_vars *vars);\ntypedef u8 (*read_status_t)(struct bnx2x_phy *phy, struct link_params *params,\n\t\t\t    struct link_vars *vars);\ntypedef void (*link_reset_t)(struct bnx2x_phy *phy,\n\t\t\t     struct link_params *params);\ntypedef void (*config_loopback_t)(struct bnx2x_phy *phy,\n\t\t\t\t  struct link_params *params);\ntypedef int (*format_fw_ver_t)(u32 raw, u8 *str, u16 *len);\ntypedef void (*hw_reset_t)(struct bnx2x_phy *phy, struct link_params *params);\ntypedef void (*set_link_led_t)(struct bnx2x_phy *phy,\n\t\t\t       struct link_params *params, u8 mode);\ntypedef void (*phy_specific_func_t)(struct bnx2x_phy *phy,\n\t\t\t\t    struct link_params *params, u32 action);\nstruct bnx2x_reg_set {\n\tu8  devad;\n\tu16 reg;\n\tu16 val;\n};\n\nstruct bnx2x_phy {\n\tu32 type;\n\n\t \n\tu8 addr;\n\tu8 def_md_devad;\n\tu16 flags;\n\t \n#define FLAGS_NOC\t\t\t(1<<1)\n\t \n#define FLAGS_FAN_FAILURE_DET_REQ\t(1<<2)\n\t \n#define FLAGS_INIT_XGXS_FIRST\t\t(1<<3)\n#define FLAGS_WC_DUAL_MODE\t\t(1<<4)\n#define FLAGS_4_PORT_MODE\t\t(1<<5)\n#define FLAGS_REARM_LATCH_SIGNAL\t(1<<6)\n#define FLAGS_SFP_NOT_APPROVED\t\t(1<<7)\n#define FLAGS_MDC_MDIO_WA\t\t(1<<8)\n#define FLAGS_DUMMY_READ\t\t(1<<9)\n#define FLAGS_MDC_MDIO_WA_B0\t\t(1<<10)\n#define FLAGS_TX_ERROR_CHECK\t\t(1<<12)\n#define FLAGS_EEE\t\t\t(1<<13)\n#define FLAGS_MDC_MDIO_WA_G\t\t(1<<15)\n\n\t \n\tu16 rx_preemphasis[4];\n\n\t \n\tu16 tx_preemphasis[4];\n\n\t \n\tu32 mdio_ctrl;\n\n\tu32 supported;\n\n\tu32 media_type;\n#define\tETH_PHY_UNSPECIFIED\t0x0\n#define\tETH_PHY_SFPP_10G_FIBER\t0x1\n#define\tETH_PHY_XFP_FIBER\t\t0x2\n#define\tETH_PHY_DA_TWINAX\t\t0x3\n#define\tETH_PHY_BASE_T\t\t0x4\n#define\tETH_PHY_SFP_1G_FIBER\t0x5\n#define\tETH_PHY_KR\t\t0xf0\n#define\tETH_PHY_CX4\t\t0xf1\n#define\tETH_PHY_NOT_PRESENT\t0xff\n\n\t \n\tu32 ver_addr;\n\n\tu16 req_flow_ctrl;\n\n\tu16 req_line_speed;\n\n\tu32 speed_cap_mask;\n\n\tu16 req_duplex;\n\tu16 rsrv;\n\t \n\tconfig_init_t config_init;\n\n\t \n\tread_status_t read_status;\n\n\t \n\tlink_reset_t link_reset;\n\n\t \n\tconfig_loopback_t config_loopback;\n\n\t \n\tformat_fw_ver_t format_fw_ver;\n\n\t \n\thw_reset_t hw_reset;\n\n\t \n\tset_link_led_t set_link_led;\n\n\t \n\tphy_specific_func_t phy_specific_func;\n#define DISABLE_TX\t1\n#define ENABLE_TX\t2\n#define PHY_INIT\t3\n};\n\n \nstruct link_params {\n\n\tu8 port;\n\n\t \n\tu8 loopback_mode;\n#define LOOPBACK_NONE\t\t0\n#define LOOPBACK_EMAC\t\t1\n#define LOOPBACK_BMAC\t\t2\n#define LOOPBACK_XGXS\t\t3\n#define LOOPBACK_EXT_PHY\t4\n#define LOOPBACK_EXT\t\t5\n#define LOOPBACK_UMAC\t\t6\n#define LOOPBACK_XMAC\t\t7\n\n\t \n\tu8 mac_addr[6];\n\n\tu16 req_duplex[LINK_CONFIG_SIZE];\n\tu16 req_flow_ctrl[LINK_CONFIG_SIZE];\n\n\tu16 req_line_speed[LINK_CONFIG_SIZE];  \n\n\t \n\tu32 shmem_base;\n\tu32 shmem2_base;\n\tu32 speed_cap_mask[LINK_CONFIG_SIZE];\n\tu32 switch_cfg;\n#define SWITCH_CFG_1G\t\tPORT_FEATURE_CON_SWITCH_1G_SWITCH\n#define SWITCH_CFG_10G\t\tPORT_FEATURE_CON_SWITCH_10G_SWITCH\n#define SWITCH_CFG_AUTO_DETECT\tPORT_FEATURE_CON_SWITCH_AUTO_DETECT\n\n\tu32 lane_config;\n\n\t \n\tu32 chip_id;\n\n\t \n\tu32 feature_config_flags;\n#define FEATURE_CONFIG_OVERRIDE_PREEMPHASIS_ENABLED\t(1<<0)\n#define FEATURE_CONFIG_PFC_ENABLED\t\t\t(1<<1)\n#define FEATURE_CONFIG_BC_SUPPORTS_OPT_MDL_VRFY\t\t(1<<2)\n#define FEATURE_CONFIG_BC_SUPPORTS_DUAL_PHY_OPT_MDL_VRFY\t(1<<3)\n#define FEATURE_CONFIG_BC_SUPPORTS_AFEX\t\t\t(1<<8)\n#define FEATURE_CONFIG_AUTOGREEEN_ENABLED\t\t\t(1<<9)\n#define FEATURE_CONFIG_BC_SUPPORTS_SFP_TX_DISABLED\t\t(1<<10)\n#define FEATURE_CONFIG_DISABLE_REMOTE_FAULT_DET\t\t(1<<11)\n#define FEATURE_CONFIG_MT_SUPPORT\t\t\t(1<<13)\n#define FEATURE_CONFIG_BOOT_FROM_SAN\t\t\t(1<<14)\n\n\t \n\tstruct bnx2x_phy phy[MAX_PHYS];\n\n\t \n\tu8 num_phys;\n\n\tu8 rsrv;\n\n\t \n\tu32 eee_mode;\n#define EEE_MODE_NVRAM_BALANCED_TIME\t\t(0xa00)\n#define EEE_MODE_NVRAM_AGGRESSIVE_TIME\t\t(0x100)\n#define EEE_MODE_NVRAM_LATENCY_TIME\t\t(0x6000)\n#define EEE_MODE_NVRAM_MASK\t\t(0x3)\n#define EEE_MODE_TIMER_MASK\t\t(0xfffff)\n#define EEE_MODE_OUTPUT_TIME\t\t(1<<28)\n#define EEE_MODE_OVERRIDE_NVRAM\t\t(1<<29)\n#define EEE_MODE_ENABLE_LPI\t\t(1<<30)\n#define EEE_MODE_ADV_LPI\t\t\t(1<<31)\n\n\tu16 hw_led_mode;  \n\tu32 multi_phy_config;\n\n\t \n\tstruct bnx2x *bp;\n\tu16 req_fc_auto_adv;  \n\tu16 link_flags;\n#define LINK_FLAGS_INT_DISABLED\t\t(1<<0)\n#define PHY_INITIALIZED\t\t(1<<1)\n\tu32 lfa_base;\n\n\t \n\tu32 link_attr_sync;\n};\n\n \nstruct link_vars {\n\tu8 phy_flags;\n#define PHY_XGXS_FLAG\t\t\t(1<<0)\n#define PHY_SGMII_FLAG\t\t\t(1<<1)\n#define PHY_PHYSICAL_LINK_FLAG\t\t(1<<2)\n#define PHY_HALF_OPEN_CONN_FLAG\t\t(1<<3)\n#define PHY_OVER_CURRENT_FLAG\t\t(1<<4)\n#define PHY_SFP_TX_FAULT_FLAG\t\t(1<<5)\n\n\tu8 mac_type;\n#define MAC_TYPE_NONE\t\t0\n#define MAC_TYPE_EMAC\t\t1\n#define MAC_TYPE_BMAC\t\t2\n#define MAC_TYPE_UMAC\t\t3\n#define MAC_TYPE_XMAC\t\t4\n\n\tu8 phy_link_up;  \n\tu8 link_up;\n\n\tu16 line_speed;\n\tu16 duplex;\n\n\tu16 flow_ctrl;\n\tu16 ieee_fc;\n\n\t \n\tu32 link_status;\n\tu32 eee_status;\n\tu8 fault_detected;\n\tu8 check_kr2_recovery_cnt;\n#define CHECK_KR2_RECOVERY_CNT\t5\n\tu16 periodic_flags;\n#define PERIODIC_FLAGS_LINK_EVENT\t0x0001\n\n\tu32 aeu_int_mask;\n\tu8 rx_tx_asic_rst;\n\tu8 turn_to_run_wc_rt;\n\tu16 rsrv2;\n};\n\n \n \n \nint bnx2x_phy_init(struct link_params *params, struct link_vars *vars);\n\n \nint bnx2x_link_reset(struct link_params *params, struct link_vars *vars,\n\t\t     u8 reset_ext_phy);\nint bnx2x_lfa_reset(struct link_params *params, struct link_vars *vars);\n \nint bnx2x_link_update(struct link_params *params, struct link_vars *vars);\n\n \nint bnx2x_phy_read(struct link_params *params, u8 phy_addr,\n\t\t   u8 devad, u16 reg, u16 *ret_val);\n\nint bnx2x_phy_write(struct link_params *params, u8 phy_addr,\n\t\t    u8 devad, u16 reg, u16 val);\n\n \nvoid bnx2x_link_status_update(struct link_params *input,\n\t\t\t    struct link_vars *output);\n \nint bnx2x_get_ext_phy_fw_version(struct link_params *params, u8 *version,\n\t\t\t\t u16 len);\n\n \nint bnx2x_set_led(struct link_params *params,\n\t\t  struct link_vars *vars, u8 mode, u32 speed);\n#define LED_MODE_OFF\t\t\t0\n#define LED_MODE_ON\t\t\t1\n#define LED_MODE_OPER\t\t\t2\n#define LED_MODE_FRONT_PANEL_OFF\t3\n\n \nvoid bnx2x_handle_module_detect_int(struct link_params *params);\n\n \nint bnx2x_test_link(struct link_params *params, struct link_vars *vars,\n\t\t    u8 is_serdes);\n\n \nint bnx2x_common_init_phy(struct bnx2x *bp, u32 shmem_base_path[],\n\t\t\t  u32 shmem2_base_path[], u32 chip_id);\n\n \nvoid bnx2x_ext_phy_hw_reset(struct bnx2x *bp, u8 port);\n\n \nvoid bnx2x_sfx7101_sp_sw_reset(struct bnx2x *bp, struct bnx2x_phy *phy);\n\n \nint bnx2x_read_sfp_module_eeprom(struct bnx2x_phy *phy,\n\t\t\t\t struct link_params *params, u8 dev_addr,\n\t\t\t\t u16 addr, u16 byte_cnt, u8 *o_buf);\n\nvoid bnx2x_hw_reset_phy(struct link_params *params);\n\n \nu32 bnx2x_phy_selection(struct link_params *params);\n\n \nint bnx2x_phy_probe(struct link_params *params);\n\n \nu8 bnx2x_fan_failure_det_req(struct bnx2x *bp, u32 shmem_base,\n\t\t\t     u32 shmem2_base, u8 port);\n\n \nvoid bnx2x_set_rx_filter(struct link_params *params, u8 en);\n\n \n\n \n#define DCBX_E2E3_MAX_NUM_COS\t\t(2)\n#define DCBX_E3B0_MAX_NUM_COS_PORT0\t(6)\n#define DCBX_E3B0_MAX_NUM_COS_PORT1\t(3)\n#define DCBX_E3B0_MAX_NUM_COS\t\t( \\\n\t\t\tMAXVAL(DCBX_E3B0_MAX_NUM_COS_PORT0, \\\n\t\t\t    DCBX_E3B0_MAX_NUM_COS_PORT1))\n\n#define DCBX_MAX_NUM_COS\t\t\t( \\\n\t\t\tMAXVAL(DCBX_E3B0_MAX_NUM_COS, \\\n\t\t\t    DCBX_E2E3_MAX_NUM_COS))\n\n \nstruct bnx2x_nig_brb_pfc_port_params {\n\t \n\tu32 pause_enable;\n\tu32 llfc_out_en;\n\tu32 llfc_enable;\n\tu32 pkt_priority_to_cos;\n\tu8 num_of_rx_cos_priority_mask;\n\tu32 rx_cos_priority_mask[DCBX_MAX_NUM_COS];\n\tu32 llfc_high_priority_classes;\n\tu32 llfc_low_priority_classes;\n};\n\n\n \nstruct bnx2x_ets_bw_params {\n\tu8 bw;\n};\n\nstruct bnx2x_ets_sp_params {\n\t \n\tu8 pri;\n};\n\nenum bnx2x_cos_state {\n\tbnx2x_cos_state_strict = 0,\n\tbnx2x_cos_state_bw = 1,\n};\n\nstruct bnx2x_ets_cos_params {\n\tenum bnx2x_cos_state state ;\n\tunion {\n\t\tstruct bnx2x_ets_bw_params bw_params;\n\t\tstruct bnx2x_ets_sp_params sp_params;\n\t} params;\n};\n\nstruct bnx2x_ets_params {\n\tu8 num_of_cos;  \n\tstruct bnx2x_ets_cos_params cos[DCBX_MAX_NUM_COS];\n};\n\n \nint bnx2x_update_pfc(struct link_params *params,\n\t\t      struct link_vars *vars,\n\t\t      struct bnx2x_nig_brb_pfc_port_params *pfc_params);\n\n\n \nint bnx2x_ets_disabled(struct link_params *params,\n\t\t       struct link_vars *vars);\n\n \nvoid bnx2x_ets_bw_limit(const struct link_params *params, const u32 cos0_bw,\n\t\t\tconst u32 cos1_bw);\n\n \nint bnx2x_ets_strict(const struct link_params *params, const u8 strict_cos);\n\n\n \nint bnx2x_ets_e3b0_config(const struct link_params *params,\n\t\t\t const struct link_vars *vars,\n\t\t\t struct bnx2x_ets_params *ets_params);\n\nvoid bnx2x_init_mod_abs_int(struct bnx2x *bp, struct link_vars *vars,\n\t\t\t    u32 chip_id, u32 shmem_base, u32 shmem2_base,\n\t\t\t    u8 port);\n\nvoid bnx2x_period_func(struct link_params *params, struct link_vars *vars);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}