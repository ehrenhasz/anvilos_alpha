{
  "module_name": "bcmgenet.h",
  "hash_id": "a8552fdfd3c24d21c72f1b1c3beea5742a6c7b960c9703a8bbb232727ee9b5cc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/broadcom/genet/bcmgenet.h",
  "human_readable_source": " \n \n\n#ifndef __BCMGENET_H__\n#define __BCMGENET_H__\n\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <linux/spinlock.h>\n#include <linux/clk.h>\n#include <linux/mii.h>\n#include <linux/if_vlan.h>\n#include <linux/phy.h>\n#include <linux/dim.h>\n#include <linux/ethtool.h>\n\n#include \"../unimac.h\"\n\n \n#define TOTAL_DESC\t\t\t\t256\n\n \n#define DESC_INDEX\t\t\t\t16\n\n \n#define ENET_BRCM_TAG_LEN\t6\n#define ENET_PAD\t\t8\n#define ENET_MAX_MTU_SIZE\t(ETH_DATA_LEN + ETH_HLEN + VLAN_HLEN + \\\n\t\t\t\t ENET_BRCM_TAG_LEN + ETH_FCS_LEN + ENET_PAD)\n#define DMA_MAX_BURST_LENGTH    0x10\n\n \n#define MAX_NUM_OF_FS_RULES\t\t16\n#define CLEAR_ALL_HFB\t\t\t0xFF\n#define DMA_FC_THRESH_HI\t\t(TOTAL_DESC >> 4)\n#define DMA_FC_THRESH_LO\t\t5\n\n \nstruct status_64 {\n\tu32\tlength_status;\t\t \n\tu32\text_status;\t\t \n\tu32\trx_csum;\t\t \n\tu32\tunused1[9];\t\t \n\tu32\ttx_csum_info;\t\t \n\tu32\tunused2[3];\t\t \n};\n\n \n#define STATUS_RX_EXT_MASK\t\t0x1FFFFF\n#define STATUS_RX_CSUM_MASK\t\t0xFFFF\n#define STATUS_RX_CSUM_OK\t\t0x10000\n#define STATUS_RX_CSUM_FR\t\t0x20000\n#define STATUS_RX_PROTO_TCP\t\t0\n#define STATUS_RX_PROTO_UDP\t\t1\n#define STATUS_RX_PROTO_ICMP\t\t2\n#define STATUS_RX_PROTO_OTHER\t\t3\n#define STATUS_RX_PROTO_MASK\t\t3\n#define STATUS_RX_PROTO_SHIFT\t\t18\n#define STATUS_FILTER_INDEX_MASK\t0xFFFF\n \n#define STATUS_TX_CSUM_START_MASK\t0X7FFF\n#define STATUS_TX_CSUM_START_SHIFT\t16\n#define STATUS_TX_CSUM_PROTO_UDP\t0x8000\n#define STATUS_TX_CSUM_OFFSET_MASK\t0x7FFF\n#define STATUS_TX_CSUM_LV\t\t0x80000000\n\n \n#define DMA_DESC_LENGTH_STATUS\t0x00\t \n#define DMA_DESC_ADDRESS_LO\t0x04\t \n#define DMA_DESC_ADDRESS_HI\t0x08\t \n\n \nstruct bcmgenet_pkt_counters {\n\tu32\tcnt_64;\t\t \n\tu32\tcnt_127;\t \n\tu32\tcnt_255;\t \n\tu32\tcnt_511;\t \n\tu32\tcnt_1023;\t \n\tu32\tcnt_1518;\t \n\tu32\tcnt_mgv;\t \n\tu32\tcnt_2047;\t \n\tu32\tcnt_4095;\t \n\tu32\tcnt_9216;\t \n};\n\n \nstruct bcmgenet_rx_counters {\n\tstruct  bcmgenet_pkt_counters pkt_cnt;\n\tu32\tpkt;\t\t \n\tu32\tbytes;\t\t \n\tu32\tmca;\t\t \n\tu32\tbca;\t\t \n\tu32\tfcs;\t\t \n\tu32\tcf;\t\t \n\tu32\tpf;\t\t \n\tu32\tuo;\t\t \n\tu32\taln;\t\t \n\tu32\tflr;\t\t \n\tu32\tcde;\t\t \n\tu32\tfcr;\t\t \n\tu32\tovr;\t\t \n\tu32\tjbr;\t\t \n\tu32\tmtue;\t\t \n\tu32\tpok;\t\t \n\tu32\tuc;\t\t \n\tu32\tppp;\t\t \n\tu32\trcrc;\t\t \n};\n\n \nstruct bcmgenet_tx_counters {\n\tstruct bcmgenet_pkt_counters pkt_cnt;\n\tu32\tpkts;\t\t \n\tu32\tmca;\t\t \n\tu32\tbca;\t\t \n\tu32\tpf;\t\t \n\tu32\tcf;\t\t \n\tu32\tfcs;\t\t \n\tu32\tovr;\t\t \n\tu32\tdrf;\t\t \n\tu32\tedf;\t\t \n\tu32\tscl;\t\t \n\tu32\tmcl;\t\t \n\tu32\tlcl;\t\t \n\tu32\tecl;\t\t \n\tu32\tfrg;\t\t \n\tu32\tncl;\t\t \n\tu32\tjbr;\t\t \n\tu32\tbytes;\t\t \n\tu32\tpok;\t\t \n\tu32\tuc;\t\t \n};\n\nstruct bcmgenet_mib_counters {\n\tstruct bcmgenet_rx_counters rx;\n\tstruct bcmgenet_tx_counters tx;\n\tu32\trx_runt_cnt;\n\tu32\trx_runt_fcs;\n\tu32\trx_runt_fcs_align;\n\tu32\trx_runt_bytes;\n\tu32\trbuf_ovflow_cnt;\n\tu32\trbuf_err_cnt;\n\tu32\tmdf_err_cnt;\n\tu32\talloc_rx_buff_failed;\n\tu32\trx_dma_failed;\n\tu32\ttx_dma_failed;\n\tu32\ttx_realloc_tsb;\n\tu32\ttx_realloc_tsb_failed;\n};\n\n#define UMAC_MIB_START\t\t\t0x400\n\n#define UMAC_MDIO_CMD\t\t\t0x614\n#define  MDIO_START_BUSY\t\t(1 << 29)\n#define  MDIO_READ_FAIL\t\t\t(1 << 28)\n#define  MDIO_RD\t\t\t(2 << 26)\n#define  MDIO_WR\t\t\t(1 << 26)\n#define  MDIO_PMD_SHIFT\t\t\t21\n#define  MDIO_PMD_MASK\t\t\t0x1F\n#define  MDIO_REG_SHIFT\t\t\t16\n#define  MDIO_REG_MASK\t\t\t0x1F\n\n#define UMAC_RBUF_OVFL_CNT_V1\t\t0x61C\n#define RBUF_OVFL_CNT_V2\t\t0x80\n#define RBUF_OVFL_CNT_V3PLUS\t\t0x94\n\n#define UMAC_MPD_CTRL\t\t\t0x620\n#define  MPD_EN\t\t\t\t(1 << 0)\n#define  MPD_PW_EN\t\t\t(1 << 27)\n#define  MPD_MSEQ_LEN_SHIFT\t\t16\n#define  MPD_MSEQ_LEN_MASK\t\t0xFF\n\n#define UMAC_MPD_PW_MS\t\t\t0x624\n#define UMAC_MPD_PW_LS\t\t\t0x628\n#define UMAC_RBUF_ERR_CNT_V1\t\t0x634\n#define RBUF_ERR_CNT_V2\t\t\t0x84\n#define RBUF_ERR_CNT_V3PLUS\t\t0x98\n#define UMAC_MDF_ERR_CNT\t\t0x638\n#define UMAC_MDF_CTRL\t\t\t0x650\n#define UMAC_MDF_ADDR\t\t\t0x654\n#define UMAC_MIB_CTRL\t\t\t0x580\n#define  MIB_RESET_RX\t\t\t(1 << 0)\n#define  MIB_RESET_RUNT\t\t\t(1 << 1)\n#define  MIB_RESET_TX\t\t\t(1 << 2)\n\n#define RBUF_CTRL\t\t\t0x00\n#define  RBUF_64B_EN\t\t\t(1 << 0)\n#define  RBUF_ALIGN_2B\t\t\t(1 << 1)\n#define  RBUF_BAD_DIS\t\t\t(1 << 2)\n\n#define RBUF_STATUS\t\t\t0x0C\n#define  RBUF_STATUS_WOL\t\t(1 << 0)\n#define  RBUF_STATUS_MPD_INTR_ACTIVE\t(1 << 1)\n#define  RBUF_STATUS_ACPI_INTR_ACTIVE\t(1 << 2)\n\n#define RBUF_CHK_CTRL\t\t\t0x14\n#define  RBUF_RXCHK_EN\t\t\t(1 << 0)\n#define  RBUF_SKIP_FCS\t\t\t(1 << 4)\n#define  RBUF_L3_PARSE_DIS\t\t(1 << 5)\n\n#define RBUF_ENERGY_CTRL\t\t0x9c\n#define  RBUF_EEE_EN\t\t\t(1 << 0)\n#define  RBUF_PM_EN\t\t\t(1 << 1)\n\n#define RBUF_TBUF_SIZE_CTRL\t\t0xb4\n\n#define RBUF_HFB_CTRL_V1\t\t0x38\n#define  RBUF_HFB_FILTER_EN_SHIFT\t16\n#define  RBUF_HFB_FILTER_EN_MASK\t0xffff0000\n#define  RBUF_HFB_EN\t\t\t(1 << 0)\n#define  RBUF_HFB_256B\t\t\t(1 << 1)\n#define  RBUF_ACPI_EN\t\t\t(1 << 2)\n\n#define RBUF_HFB_LEN_V1\t\t\t0x3C\n#define  RBUF_FLTR_LEN_MASK\t\t0xFF\n#define  RBUF_FLTR_LEN_SHIFT\t\t8\n\n#define TBUF_CTRL\t\t\t0x00\n#define  TBUF_64B_EN\t\t\t(1 << 0)\n#define TBUF_BP_MC\t\t\t0x0C\n#define TBUF_ENERGY_CTRL\t\t0x14\n#define  TBUF_EEE_EN\t\t\t(1 << 0)\n#define  TBUF_PM_EN\t\t\t(1 << 1)\n\n#define TBUF_CTRL_V1\t\t\t0x80\n#define TBUF_BP_MC_V1\t\t\t0xA0\n\n#define HFB_CTRL\t\t\t0x00\n#define HFB_FLT_ENABLE_V3PLUS\t\t0x04\n#define HFB_FLT_LEN_V2\t\t\t0x04\n#define HFB_FLT_LEN_V3PLUS\t\t0x1C\n\n \n#define INTRL2_CPU_STAT\t\t\t0x00\n#define INTRL2_CPU_SET\t\t\t0x04\n#define INTRL2_CPU_CLEAR\t\t0x08\n#define INTRL2_CPU_MASK_STATUS\t\t0x0C\n#define INTRL2_CPU_MASK_SET\t\t0x10\n#define INTRL2_CPU_MASK_CLEAR\t\t0x14\n\n \n#define UMAC_IRQ_SCB\t\t\t(1 << 0)\n#define UMAC_IRQ_EPHY\t\t\t(1 << 1)\n#define UMAC_IRQ_PHY_DET_R\t\t(1 << 2)\n#define UMAC_IRQ_PHY_DET_F\t\t(1 << 3)\n#define UMAC_IRQ_LINK_UP\t\t(1 << 4)\n#define UMAC_IRQ_LINK_DOWN\t\t(1 << 5)\n#define UMAC_IRQ_LINK_EVENT\t\t(UMAC_IRQ_LINK_UP | UMAC_IRQ_LINK_DOWN)\n#define UMAC_IRQ_UMAC\t\t\t(1 << 6)\n#define UMAC_IRQ_UMAC_TSV\t\t(1 << 7)\n#define UMAC_IRQ_TBUF_UNDERRUN\t\t(1 << 8)\n#define UMAC_IRQ_RBUF_OVERFLOW\t\t(1 << 9)\n#define UMAC_IRQ_HFB_SM\t\t\t(1 << 10)\n#define UMAC_IRQ_HFB_MM\t\t\t(1 << 11)\n#define UMAC_IRQ_MPD_R\t\t\t(1 << 12)\n#define UMAC_IRQ_WAKE_EVENT\t\t(UMAC_IRQ_HFB_SM | UMAC_IRQ_HFB_MM | \\\n\t\t\t\t\t UMAC_IRQ_MPD_R)\n#define UMAC_IRQ_RXDMA_MBDONE\t\t(1 << 13)\n#define UMAC_IRQ_RXDMA_PDONE\t\t(1 << 14)\n#define UMAC_IRQ_RXDMA_BDONE\t\t(1 << 15)\n#define UMAC_IRQ_RXDMA_DONE\t\tUMAC_IRQ_RXDMA_MBDONE\n#define UMAC_IRQ_TXDMA_MBDONE\t\t(1 << 16)\n#define UMAC_IRQ_TXDMA_PDONE\t\t(1 << 17)\n#define UMAC_IRQ_TXDMA_BDONE\t\t(1 << 18)\n#define UMAC_IRQ_TXDMA_DONE\t\tUMAC_IRQ_TXDMA_MBDONE\n\n \n#define UMAC_IRQ_MDIO_DONE\t\t(1 << 23)\n#define UMAC_IRQ_MDIO_ERROR\t\t(1 << 24)\n\n \n#define UMAC_IRQ1_TX_INTR_MASK\t\t0xFFFF\n#define UMAC_IRQ1_RX_INTR_MASK\t\t0xFFFF\n#define UMAC_IRQ1_RX_INTR_SHIFT\t\t16\n\n \n#define GENET_SYS_OFF\t\t\t0x0000\n#define GENET_GR_BRIDGE_OFF\t\t0x0040\n#define GENET_EXT_OFF\t\t\t0x0080\n#define GENET_INTRL2_0_OFF\t\t0x0200\n#define GENET_INTRL2_1_OFF\t\t0x0240\n#define GENET_RBUF_OFF\t\t\t0x0300\n#define GENET_UMAC_OFF\t\t\t0x0800\n\n \n#define SYS_REV_CTRL\t\t\t0x00\n#define SYS_PORT_CTRL\t\t\t0x04\n#define  PORT_MODE_INT_EPHY\t\t0\n#define  PORT_MODE_INT_GPHY\t\t1\n#define  PORT_MODE_EXT_EPHY\t\t2\n#define  PORT_MODE_EXT_GPHY\t\t3\n#define  PORT_MODE_EXT_RVMII_25\t\t(4 | BIT(4))\n#define  PORT_MODE_EXT_RVMII_50\t\t4\n#define  LED_ACT_SOURCE_MAC\t\t(1 << 9)\n\n#define SYS_RBUF_FLUSH_CTRL\t\t0x08\n#define SYS_TBUF_FLUSH_CTRL\t\t0x0C\n#define RBUF_FLUSH_CTRL_V1\t\t0x04\n\n \n#define EXT_EXT_PWR_MGMT\t\t0x00\n#define  EXT_PWR_DOWN_BIAS\t\t(1 << 0)\n#define  EXT_PWR_DOWN_DLL\t\t(1 << 1)\n#define  EXT_PWR_DOWN_PHY\t\t(1 << 2)\n#define  EXT_PWR_DN_EN_LD\t\t(1 << 3)\n#define  EXT_ENERGY_DET\t\t\t(1 << 4)\n#define  EXT_IDDQ_FROM_PHY\t\t(1 << 5)\n#define  EXT_IDDQ_GLBL_PWR\t\t(1 << 7)\n#define  EXT_PHY_RESET\t\t\t(1 << 8)\n#define  EXT_ENERGY_DET_MASK\t\t(1 << 12)\n#define  EXT_PWR_DOWN_PHY_TX\t\t(1 << 16)\n#define  EXT_PWR_DOWN_PHY_RX\t\t(1 << 17)\n#define  EXT_PWR_DOWN_PHY_SD\t\t(1 << 18)\n#define  EXT_PWR_DOWN_PHY_RD\t\t(1 << 19)\n#define  EXT_PWR_DOWN_PHY_EN\t\t(1 << 20)\n\n#define EXT_RGMII_OOB_CTRL\t\t0x0C\n#define  RGMII_MODE_EN_V123\t\t(1 << 0)\n#define  RGMII_LINK\t\t\t(1 << 4)\n#define  OOB_DISABLE\t\t\t(1 << 5)\n#define  RGMII_MODE_EN\t\t\t(1 << 6)\n#define  ID_MODE_DIS\t\t\t(1 << 16)\n\n#define EXT_GPHY_CTRL\t\t\t0x1C\n#define  EXT_CFG_IDDQ_BIAS\t\t(1 << 0)\n#define  EXT_CFG_PWR_DOWN\t\t(1 << 1)\n#define  EXT_CK25_DIS\t\t\t(1 << 4)\n#define  EXT_CFG_IDDQ_GLOBAL_PWR\t(1 << 3)\n#define  EXT_GPHY_RESET\t\t\t(1 << 5)\n\n \n#define DMA_RING_SIZE\t\t\t(0x40)\n#define DMA_RINGS_SIZE\t\t\t(DMA_RING_SIZE * (DESC_INDEX + 1))\n\n \n#define DMA_RW_POINTER_MASK\t\t0x1FF\n#define DMA_P_INDEX_DISCARD_CNT_MASK\t0xFFFF\n#define DMA_P_INDEX_DISCARD_CNT_SHIFT\t16\n#define DMA_BUFFER_DONE_CNT_MASK\t0xFFFF\n#define DMA_BUFFER_DONE_CNT_SHIFT\t16\n#define DMA_P_INDEX_MASK\t\t0xFFFF\n#define DMA_C_INDEX_MASK\t\t0xFFFF\n\n \n#define DMA_RING_SIZE_MASK\t\t0xFFFF\n#define DMA_RING_SIZE_SHIFT\t\t16\n#define DMA_RING_BUFFER_SIZE_MASK\t0xFFFF\n\n \n#define DMA_INTR_THRESHOLD_MASK\t\t0x01FF\n\n \n#define DMA_XON_THREHOLD_MASK\t\t0xFFFF\n#define DMA_XOFF_THRESHOLD_MASK\t\t0xFFFF\n#define DMA_XOFF_THRESHOLD_SHIFT\t16\n\n \n#define DMA_FLOW_PERIOD_MASK\t\t0xFFFF\n#define DMA_MAX_PKT_SIZE_MASK\t\t0xFFFF\n#define DMA_MAX_PKT_SIZE_SHIFT\t\t16\n\n\n \n#define DMA_EN\t\t\t\t(1 << 0)\n#define DMA_RING_BUF_EN_SHIFT\t\t0x01\n#define DMA_RING_BUF_EN_MASK\t\t0xFFFF\n#define DMA_TSB_SWAP_EN\t\t\t(1 << 20)\n\n \n#define DMA_DISABLED\t\t\t(1 << 0)\n#define DMA_DESC_RAM_INIT_BUSY\t\t(1 << 1)\n\n \n#define DMA_SCB_BURST_SIZE_MASK\t\t0x1F\n\n \n#define DMA_ACTIVITY_VECTOR_MASK\t0x1FFFF\n\n \n#define DMA_BACKPRESSURE_MASK\t\t0x1FFFF\n#define DMA_PFC_ENABLE\t\t\t(1 << 31)\n\n \n#define DMA_BACKPRESSURE_STATUS_MASK\t0x1FFFF\n\n \n#define DMA_LITTLE_ENDIAN_MODE\t\t(1 << 0)\n#define DMA_REGISTER_MODE\t\t(1 << 1)\n\n \n#define DMA_TIMEOUT_MASK\t\t0xFFFF\n#define DMA_TIMEOUT_VAL\t\t\t5000\t \n\n \n#define DMA_RATE_LIMIT_EN_MASK\t\t0xFFFF\n\n \n#define DMA_ARBITER_MODE_MASK\t\t0x03\n#define DMA_RING_BUF_PRIORITY_MASK\t0x1F\n#define DMA_RING_BUF_PRIORITY_SHIFT\t5\n#define DMA_PRIO_REG_INDEX(q)\t\t((q) / 6)\n#define DMA_PRIO_REG_SHIFT(q)\t\t(((q) % 6) * DMA_RING_BUF_PRIORITY_SHIFT)\n#define DMA_RATE_ADJ_MASK\t\t0xFF\n\n \n#define DMA_BUFLENGTH_MASK\t\t0x0fff\n#define DMA_BUFLENGTH_SHIFT\t\t16\n#define DMA_OWN\t\t\t\t0x8000\n#define DMA_EOP\t\t\t\t0x4000\n#define DMA_SOP\t\t\t\t0x2000\n#define DMA_WRAP\t\t\t0x1000\n \n#define DMA_TX_UNDERRUN\t\t\t0x0200\n#define DMA_TX_APPEND_CRC\t\t0x0040\n#define DMA_TX_OW_CRC\t\t\t0x0020\n#define DMA_TX_DO_CSUM\t\t\t0x0010\n#define DMA_TX_QTAG_SHIFT\t\t7\n\n \n#define DMA_RX_CHK_V3PLUS\t\t0x8000\n#define DMA_RX_CHK_V12\t\t\t0x1000\n#define DMA_RX_BRDCAST\t\t\t0x0040\n#define DMA_RX_MULT\t\t\t0x0020\n#define DMA_RX_LG\t\t\t0x0010\n#define DMA_RX_NO\t\t\t0x0008\n#define DMA_RX_RXER\t\t\t0x0004\n#define DMA_RX_CRC_ERROR\t\t0x0002\n#define DMA_RX_OV\t\t\t0x0001\n#define DMA_RX_FI_MASK\t\t\t0x001F\n#define DMA_RX_FI_SHIFT\t\t\t0x0007\n#define DMA_DESC_ALLOC_MASK\t\t0x00FF\n\n#define DMA_ARBITER_RR\t\t\t0x00\n#define DMA_ARBITER_WRR\t\t\t0x01\n#define DMA_ARBITER_SP\t\t\t0x02\n\nstruct enet_cb {\n\tstruct sk_buff      *skb;\n\tvoid __iomem *bd_addr;\n\tDEFINE_DMA_UNMAP_ADDR(dma_addr);\n\tDEFINE_DMA_UNMAP_LEN(dma_len);\n};\n\n \nenum bcmgenet_power_mode {\n\tGENET_POWER_CABLE_SENSE = 0,\n\tGENET_POWER_PASSIVE,\n\tGENET_POWER_WOL_MAGIC,\n};\n\nstruct bcmgenet_priv;\n\n \nenum bcmgenet_version {\n\tGENET_V1 = 1,\n\tGENET_V2,\n\tGENET_V3,\n\tGENET_V4,\n\tGENET_V5\n};\n\n#define GENET_IS_V1(p)\t((p)->version == GENET_V1)\n#define GENET_IS_V2(p)\t((p)->version == GENET_V2)\n#define GENET_IS_V3(p)\t((p)->version == GENET_V3)\n#define GENET_IS_V4(p)\t((p)->version == GENET_V4)\n#define GENET_IS_V5(p)\t((p)->version == GENET_V5)\n\n \n#define GENET_HAS_40BITS\t(1 << 0)\n#define GENET_HAS_EXT\t\t(1 << 1)\n#define GENET_HAS_MDIO_INTR\t(1 << 2)\n#define GENET_HAS_MOCA_LINK_DET\t(1 << 3)\n\n \nstruct bcmgenet_hw_params {\n\tu8\t\ttx_queues;\n\tu8\t\ttx_bds_per_q;\n\tu8\t\trx_queues;\n\tu8\t\trx_bds_per_q;\n\tu8\t\tbp_in_en_shift;\n\tu32\t\tbp_in_mask;\n\tu8\t\thfb_filter_cnt;\n\tu8\t\thfb_filter_size;\n\tu8\t\tqtag_mask;\n\tu16\t\ttbuf_offset;\n\tu32\t\thfb_offset;\n\tu32\t\thfb_reg_offset;\n\tu32\t\trdma_offset;\n\tu32\t\ttdma_offset;\n\tu32\t\twords_per_bd;\n\tu32\t\tflags;\n};\n\nstruct bcmgenet_skb_cb {\n\tstruct enet_cb *first_cb;\t \n\tstruct enet_cb *last_cb;\t \n\tunsigned int bytes_sent;\t \n};\n\n#define GENET_CB(skb)\t((struct bcmgenet_skb_cb *)((skb)->cb))\n\nstruct bcmgenet_tx_ring {\n\tspinlock_t\tlock;\t\t \n\tstruct napi_struct napi;\t \n\tunsigned long\tpackets;\n\tunsigned long\tbytes;\n\tunsigned int\tindex;\t\t \n\tunsigned int\tqueue;\t\t \n\tstruct enet_cb\t*cbs;\t\t \n\tunsigned int\tsize;\t\t \n\tunsigned int    clean_ptr;       \n\tunsigned int\tc_index;\t \n\tunsigned int\tfree_bds;\t \n\tunsigned int\twrite_ptr;\t \n\tunsigned int\tprod_index;\t \n\tunsigned int\tcb_ptr;\t\t \n\tunsigned int\tend_ptr;\t \n\tvoid (*int_enable)(struct bcmgenet_tx_ring *);\n\tvoid (*int_disable)(struct bcmgenet_tx_ring *);\n\tstruct bcmgenet_priv *priv;\n};\n\nstruct bcmgenet_net_dim {\n\tu16\t\tuse_dim;\n\tu16\t\tevent_ctr;\n\tunsigned long\tpackets;\n\tunsigned long\tbytes;\n\tstruct dim\tdim;\n};\n\nstruct bcmgenet_rx_ring {\n\tstruct napi_struct napi;\t \n\tunsigned long\tbytes;\n\tunsigned long\tpackets;\n\tunsigned long\terrors;\n\tunsigned long\tdropped;\n\tunsigned int\tindex;\t\t \n\tstruct enet_cb\t*cbs;\t\t \n\tunsigned int\tsize;\t\t \n\tunsigned int\tc_index;\t \n\tunsigned int\tread_ptr;\t \n\tunsigned int\tcb_ptr;\t\t \n\tunsigned int\tend_ptr;\t \n\tunsigned int\told_discards;\n\tstruct bcmgenet_net_dim dim;\n\tu32\t\trx_max_coalesced_frames;\n\tu32\t\trx_coalesce_usecs;\n\tvoid (*int_enable)(struct bcmgenet_rx_ring *);\n\tvoid (*int_disable)(struct bcmgenet_rx_ring *);\n\tstruct bcmgenet_priv *priv;\n};\n\nenum bcmgenet_rxnfc_state {\n\tBCMGENET_RXNFC_STATE_UNUSED = 0,\n\tBCMGENET_RXNFC_STATE_DISABLED,\n\tBCMGENET_RXNFC_STATE_ENABLED\n};\n\nstruct bcmgenet_rxnfc_rule {\n\tstruct\tlist_head list;\n\tstruct ethtool_rx_flow_spec\tfs;\n\tenum bcmgenet_rxnfc_state state;\n};\n\n \nstruct bcmgenet_priv {\n\tvoid __iomem *base;\n\tenum bcmgenet_version version;\n\tstruct net_device *dev;\n\n\t \n\tvoid __iomem *tx_bds;\n\tstruct enet_cb *tx_cbs;\n\tunsigned int num_tx_bds;\n\n\tstruct bcmgenet_tx_ring tx_rings[DESC_INDEX + 1];\n\n\t \n\tvoid __iomem *rx_bds;\n\tstruct enet_cb *rx_cbs;\n\tunsigned int num_rx_bds;\n\tunsigned int rx_buf_len;\n\tstruct bcmgenet_rxnfc_rule rxnfc_rules[MAX_NUM_OF_FS_RULES];\n\tstruct list_head rxnfc_list;\n\n\tstruct bcmgenet_rx_ring rx_rings[DESC_INDEX + 1];\n\n\t \n\tstruct bcmgenet_hw_params *hw_params;\n\tunsigned autoneg_pause:1;\n\tunsigned tx_pause:1;\n\tunsigned rx_pause:1;\n\n\t \n\twait_queue_head_t wq;\n\tbool internal_phy;\n\tstruct device_node *phy_dn;\n\tstruct device_node *mdio_dn;\n\tstruct mii_bus *mii_bus;\n\tu16 gphy_rev;\n\tstruct clk *clk_eee;\n\tbool clk_eee_enabled;\n\n\t \n\tphy_interface_t phy_interface;\n\tint phy_addr;\n\tint ext_phy;\n\tbool ephy_16nm;\n\n\t \n\tstruct work_struct bcmgenet_irq_work;\n\tint irq0;\n\tint irq1;\n\tint wol_irq;\n\tbool wol_irq_disabled;\n\n\t \n\tspinlock_t lock;\n\tunsigned int irq0_stat;\n\n\t \n\tbool crc_fwd_en;\n\n\tu32 dma_max_burst_length;\n\n\tu32 msg_enable;\n\n\tstruct clk *clk;\n\tstruct platform_device *pdev;\n\tstruct platform_device *mii_pdev;\n\n\t \n\tstruct clk *clk_wol;\n\tu32 wolopts;\n\tu8 sopass[SOPASS_MAX];\n\tbool wol_active;\n\n\tstruct bcmgenet_mib_counters mib;\n\n\tstruct ethtool_eee eee;\n};\n\n#define GENET_IO_MACRO(name, offset)\t\t\t\t\t\\\nstatic inline u32 bcmgenet_##name##_readl(struct bcmgenet_priv *priv,\t\\\n\t\t\t\t\tu32 off)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t \t\t\t\t\t\t\t\t\\\n\tif (IS_ENABLED(CONFIG_MIPS) && IS_ENABLED(CONFIG_CPU_BIG_ENDIAN)) \\\n\t\treturn __raw_readl(priv->base + offset + off);\t\t\\\n\telse\t\t\t\t\t\t\t\t\\\n\t\treturn readl_relaxed(priv->base + offset + off);\t\\\n}\t\t\t\t\t\t\t\t\t\\\nstatic inline void bcmgenet_##name##_writel(struct bcmgenet_priv *priv,\t\\\n\t\t\t\t\tu32 val, u32 off)\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tif (IS_ENABLED(CONFIG_MIPS) && IS_ENABLED(CONFIG_CPU_BIG_ENDIAN)) \\\n\t\t__raw_writel(val, priv->base + offset + off);\t\t\\\n\telse\t\t\t\t\t\t\t\t\\\n\t\twritel_relaxed(val, priv->base + offset + off);\t\t\\\n}\n\nGENET_IO_MACRO(ext, GENET_EXT_OFF);\nGENET_IO_MACRO(umac, GENET_UMAC_OFF);\nGENET_IO_MACRO(sys, GENET_SYS_OFF);\n\n \nGENET_IO_MACRO(intrl2_0, GENET_INTRL2_0_OFF);\nGENET_IO_MACRO(intrl2_1, GENET_INTRL2_1_OFF);\n\n \nGENET_IO_MACRO(hfb, priv->hw_params->hfb_offset);\n\n \nGENET_IO_MACRO(hfb_reg, priv->hw_params->hfb_reg_offset);\n\n \nGENET_IO_MACRO(rbuf, GENET_RBUF_OFF);\n\n \nint bcmgenet_mii_init(struct net_device *dev);\nint bcmgenet_mii_config(struct net_device *dev, bool init);\nint bcmgenet_mii_probe(struct net_device *dev);\nvoid bcmgenet_mii_exit(struct net_device *dev);\nvoid bcmgenet_phy_pause_set(struct net_device *dev, bool rx, bool tx);\nvoid bcmgenet_phy_power_set(struct net_device *dev, bool enable);\nvoid bcmgenet_mii_setup(struct net_device *dev);\n\n \nvoid bcmgenet_get_wol(struct net_device *dev, struct ethtool_wolinfo *wol);\nint bcmgenet_set_wol(struct net_device *dev, struct ethtool_wolinfo *wol);\nint bcmgenet_wol_power_down_cfg(struct bcmgenet_priv *priv,\n\t\t\t\tenum bcmgenet_power_mode mode);\nvoid bcmgenet_wol_power_up_cfg(struct bcmgenet_priv *priv,\n\t\t\t       enum bcmgenet_power_mode mode);\n\nvoid bcmgenet_eee_enable_set(struct net_device *dev, bool enable,\n\t\t\t     bool tx_lpi_enabled);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}