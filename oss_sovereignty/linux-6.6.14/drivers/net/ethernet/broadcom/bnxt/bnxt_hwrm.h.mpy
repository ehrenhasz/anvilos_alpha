{
  "module_name": "bnxt_hwrm.h",
  "hash_id": "953f3443f46f016ae6570457bebc60262d2f648111f2426a246ff687fcdd191b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/broadcom/bnxt/bnxt_hwrm.h",
  "human_readable_source": " \n\n#ifndef BNXT_HWRM_H\n#define BNXT_HWRM_H\n\n#include \"bnxt_hsi.h\"\n\nenum bnxt_hwrm_ctx_flags {\n\t \n\tBNXT_HWRM_INTERNAL_CTX_OWNED\t= BIT(0),  \n\tBNXT_HWRM_INTERNAL_RESP_DIRTY\t= BIT(1),  \n\tBNXT_HWRM_CTX_SILENT\t\t= BIT(2),  \n\tBNXT_HWRM_FULL_WAIT\t\t= BIT(3),  \n};\n\n#define HWRM_API_FLAGS (BNXT_HWRM_CTX_SILENT | BNXT_HWRM_FULL_WAIT)\n\nstruct bnxt_hwrm_ctx {\n\tu64 sentinel;\n\tdma_addr_t dma_handle;\n\tstruct output *resp;\n\tstruct input *req;\n\tdma_addr_t slice_handle;\n\tvoid *slice_addr;\n\tu32 slice_size;\n\tu32 req_len;\n\tenum bnxt_hwrm_ctx_flags flags;\n\tunsigned int timeout;\n\tu32 allocated;\n\tgfp_t gfp;\n};\n\nenum bnxt_hwrm_wait_state {\n\tBNXT_HWRM_PENDING,\n\tBNXT_HWRM_DEFERRED,\n\tBNXT_HWRM_COMPLETE,\n\tBNXT_HWRM_CANCELLED,\n};\n\nenum bnxt_hwrm_chnl { BNXT_HWRM_CHNL_CHIMP, BNXT_HWRM_CHNL_KONG };\n\nstruct bnxt_hwrm_wait_token {\n\tstruct rcu_head rcu;\n\tstruct hlist_node node;\n\tenum bnxt_hwrm_wait_state state;\n\tenum bnxt_hwrm_chnl dst;\n\tu16 seq_id;\n};\n\nvoid hwrm_update_token(struct bnxt *bp, u16 seq, enum bnxt_hwrm_wait_state s);\n\n#define BNXT_HWRM_MAX_REQ_LEN\t\t(bp->hwrm_max_req_len)\n#define BNXT_HWRM_SHORT_REQ_LEN\t\tsizeof(struct hwrm_short_input)\n#define HWRM_CMD_MAX_TIMEOUT\t\t40000U\n#define SHORT_HWRM_CMD_TIMEOUT\t\t20\n#define HWRM_CMD_TIMEOUT\t\t(bp->hwrm_cmd_timeout)\n#define HWRM_RESET_TIMEOUT\t\t((HWRM_CMD_TIMEOUT) * 4)\n#define BNXT_HWRM_TARGET\t\t0xffff\n#define BNXT_HWRM_NO_CMPL_RING\t\t-1\n#define BNXT_HWRM_REQ_MAX_SIZE\t\t128\n#define BNXT_HWRM_DMA_SIZE\t\t(2 * PAGE_SIZE)  \n#define BNXT_HWRM_RESP_RESERVED\t\tPAGE_SIZE\n#define BNXT_HWRM_RESP_OFFSET\t\t(BNXT_HWRM_DMA_SIZE -\t\t\\\n\t\t\t\t\t BNXT_HWRM_RESP_RESERVED)\n#define BNXT_HWRM_CTX_OFFSET\t\t(BNXT_HWRM_RESP_OFFSET -\t\\\n\t\t\t\t\t sizeof(struct bnxt_hwrm_ctx))\n#define BNXT_HWRM_DMA_ALIGN\t\t16\n#define BNXT_HWRM_SENTINEL\t\t0xb6e1f68a12e9a7eb  \n#define BNXT_HWRM_REQS_PER_PAGE\t\t(BNXT_PAGE_SIZE /\t\\\n\t\t\t\t\t BNXT_HWRM_REQ_MAX_SIZE)\n#define HWRM_SHORT_MIN_TIMEOUT\t\t3\n#define HWRM_SHORT_MAX_TIMEOUT\t\t10\n#define HWRM_SHORT_TIMEOUT_COUNTER\t5\n\n#define HWRM_MIN_TIMEOUT\t\t25\n#define HWRM_MAX_TIMEOUT\t\t40\n\nstatic inline unsigned int hwrm_total_timeout(unsigned int n)\n{\n\treturn n <= HWRM_SHORT_TIMEOUT_COUNTER ? n * HWRM_SHORT_MIN_TIMEOUT :\n\t\tHWRM_SHORT_TIMEOUT_COUNTER * HWRM_SHORT_MIN_TIMEOUT +\n\t\t(n - HWRM_SHORT_TIMEOUT_COUNTER) * HWRM_MIN_TIMEOUT;\n}\n\n\n#define HWRM_VALID_BIT_DELAY_USEC\t50000\n\nstatic inline bool bnxt_cfa_hwrm_message(u16 req_type)\n{\n\tswitch (req_type) {\n\tcase HWRM_CFA_ENCAP_RECORD_ALLOC:\n\tcase HWRM_CFA_ENCAP_RECORD_FREE:\n\tcase HWRM_CFA_DECAP_FILTER_ALLOC:\n\tcase HWRM_CFA_DECAP_FILTER_FREE:\n\tcase HWRM_CFA_EM_FLOW_ALLOC:\n\tcase HWRM_CFA_EM_FLOW_FREE:\n\tcase HWRM_CFA_EM_FLOW_CFG:\n\tcase HWRM_CFA_FLOW_ALLOC:\n\tcase HWRM_CFA_FLOW_FREE:\n\tcase HWRM_CFA_FLOW_INFO:\n\tcase HWRM_CFA_FLOW_FLUSH:\n\tcase HWRM_CFA_FLOW_STATS:\n\tcase HWRM_CFA_METER_PROFILE_ALLOC:\n\tcase HWRM_CFA_METER_PROFILE_FREE:\n\tcase HWRM_CFA_METER_PROFILE_CFG:\n\tcase HWRM_CFA_METER_INSTANCE_ALLOC:\n\tcase HWRM_CFA_METER_INSTANCE_FREE:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic inline bool bnxt_kong_hwrm_message(struct bnxt *bp, struct input *req)\n{\n\treturn (bp->fw_cap & BNXT_FW_CAP_KONG_MB_CHNL &&\n\t\t(bnxt_cfa_hwrm_message(le16_to_cpu(req->req_type)) ||\n\t\t le16_to_cpu(req->target_id) == HWRM_TARGET_ID_KONG));\n}\n\nint __hwrm_req_init(struct bnxt *bp, void **req, u16 req_type, u32 req_len);\n#define hwrm_req_init(bp, req, req_type) \\\n\t__hwrm_req_init((bp), (void **)&(req), (req_type), sizeof(*(req)))\nvoid *hwrm_req_hold(struct bnxt *bp, void *req);\nvoid hwrm_req_drop(struct bnxt *bp, void *req);\nvoid hwrm_req_flags(struct bnxt *bp, void *req, enum bnxt_hwrm_ctx_flags flags);\nvoid hwrm_req_timeout(struct bnxt *bp, void *req, unsigned int timeout);\nint hwrm_req_send(struct bnxt *bp, void *req);\nint hwrm_req_send_silent(struct bnxt *bp, void *req);\nint hwrm_req_replace(struct bnxt *bp, void *req, void *new_req, u32 len);\nvoid hwrm_req_alloc_flags(struct bnxt *bp, void *req, gfp_t flags);\nvoid *hwrm_req_dma_slice(struct bnxt *bp, void *req, u32 size, dma_addr_t *dma);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}