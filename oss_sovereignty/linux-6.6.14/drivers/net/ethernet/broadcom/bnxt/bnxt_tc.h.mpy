{
  "module_name": "bnxt_tc.h",
  "hash_id": "4062141b6b8baa719f9498f895c77908225ddd262861b2a1152c361511893971",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/broadcom/bnxt/bnxt_tc.h",
  "human_readable_source": " \n\n#ifndef BNXT_TC_H\n#define BNXT_TC_H\n\n#ifdef CONFIG_BNXT_FLOWER_OFFLOAD\n\n#include <net/ip_tunnels.h>\n\n \nstruct bnxt_tc_l2_key {\n\tu8\t\tdmac[ETH_ALEN];\n\tu8\t\tsmac[ETH_ALEN];\n\t__be16\t\tinner_vlan_tpid;\n\t__be16\t\tinner_vlan_tci;\n\t__be16\t\tether_type;\n\tu8\t\tnum_vlans;\n\tu8\t\tdir;\n#define BNXT_DIR_RX\t1\n#define BNXT_DIR_TX\t0\n};\n\nstruct bnxt_tc_l3_key {\n\tunion {\n\t\tstruct {\n\t\t\tstruct in_addr daddr;\n\t\t\tstruct in_addr saddr;\n\t\t} ipv4;\n\t\tstruct {\n\t\t\tstruct in6_addr daddr;\n\t\t\tstruct in6_addr saddr;\n\t\t} ipv6;\n\t};\n};\n\nstruct bnxt_tc_l4_key {\n\tu8  ip_proto;\n\tunion {\n\t\tstruct {\n\t\t\t__be16 sport;\n\t\t\t__be16 dport;\n\t\t} ports;\n\t\tstruct {\n\t\t\tu8 type;\n\t\t\tu8 code;\n\t\t} icmp;\n\t};\n};\n\nstruct bnxt_tc_tunnel_key {\n\tstruct bnxt_tc_l2_key\tl2;\n\tstruct bnxt_tc_l3_key\tl3;\n\tstruct bnxt_tc_l4_key\tl4;\n\t__be32\t\t\tid;\n};\n\n#define bnxt_eth_addr_key_mask_invalid(eth_addr, eth_addr_mask)\t\t\\\n\t((is_wildcard(&(eth_addr)[0], ETH_ALEN) &&\t\t\t\\\n\t is_wildcard(&(eth_addr)[ETH_ALEN / 2], ETH_ALEN)) ||\t\t\\\n\t(is_wildcard(&(eth_addr_mask)[0], ETH_ALEN) &&\t\t\t\\\n\t is_wildcard(&(eth_addr_mask)[ETH_ALEN / 2], ETH_ALEN)))\n\nstruct bnxt_tc_actions {\n\tu32\t\t\t\tflags;\n#define BNXT_TC_ACTION_FLAG_FWD\t\t\tBIT(0)\n#define BNXT_TC_ACTION_FLAG_FWD_VXLAN\t\tBIT(1)\n#define BNXT_TC_ACTION_FLAG_PUSH_VLAN\t\tBIT(3)\n#define BNXT_TC_ACTION_FLAG_POP_VLAN\t\tBIT(4)\n#define BNXT_TC_ACTION_FLAG_DROP\t\tBIT(5)\n#define BNXT_TC_ACTION_FLAG_TUNNEL_ENCAP\tBIT(6)\n#define BNXT_TC_ACTION_FLAG_TUNNEL_DECAP\tBIT(7)\n#define BNXT_TC_ACTION_FLAG_L2_REWRITE\t\tBIT(8)\n#define BNXT_TC_ACTION_FLAG_NAT_XLATE\t\tBIT(9)\n\n\tu16\t\t\t\tdst_fid;\n\tstruct net_device\t\t*dst_dev;\n\t__be16\t\t\t\tpush_vlan_tpid;\n\t__be16\t\t\t\tpush_vlan_tci;\n\n\t \n\tstruct ip_tunnel_key\t\ttun_encap_key;\n#define\tPEDIT_OFFSET_SMAC_LAST_4_BYTES\t\t0x8\n\t__be16\t\t\t\tl2_rewrite_dmac[3];\n\t__be16\t\t\t\tl2_rewrite_smac[3];\n\tstruct {\n\t\tbool src_xlate;   \n\t\tbool l3_is_ipv4;  \n\t\tstruct bnxt_tc_l3_key l3;\n\t\tstruct bnxt_tc_l4_key l4;\n\t} nat;\n};\n\nstruct bnxt_tc_flow {\n\tu32\t\t\t\tflags;\n#define BNXT_TC_FLOW_FLAGS_ETH_ADDRS\t\tBIT(1)\n#define BNXT_TC_FLOW_FLAGS_IPV4_ADDRS\t\tBIT(2)\n#define BNXT_TC_FLOW_FLAGS_IPV6_ADDRS\t\tBIT(3)\n#define BNXT_TC_FLOW_FLAGS_PORTS\t\tBIT(4)\n#define BNXT_TC_FLOW_FLAGS_ICMP\t\t\tBIT(5)\n#define BNXT_TC_FLOW_FLAGS_TUNL_ETH_ADDRS\tBIT(6)\n#define BNXT_TC_FLOW_FLAGS_TUNL_IPV4_ADDRS\tBIT(7)\n#define BNXT_TC_FLOW_FLAGS_TUNL_IPV6_ADDRS\tBIT(8)\n#define BNXT_TC_FLOW_FLAGS_TUNL_PORTS\t\tBIT(9)\n#define BNXT_TC_FLOW_FLAGS_TUNL_ID\t\tBIT(10)\n#define BNXT_TC_FLOW_FLAGS_TUNNEL\t(BNXT_TC_FLOW_FLAGS_TUNL_ETH_ADDRS | \\\n\t\t\t\t\t BNXT_TC_FLOW_FLAGS_TUNL_IPV4_ADDRS | \\\n\t\t\t\t\t BNXT_TC_FLOW_FLAGS_TUNL_IPV6_ADDRS |\\\n\t\t\t\t\t BNXT_TC_FLOW_FLAGS_TUNL_PORTS |\\\n\t\t\t\t\t BNXT_TC_FLOW_FLAGS_TUNL_ID)\n\n\t \n\tu16\t\t\t\tsrc_fid;\n\tstruct bnxt_tc_l2_key\t\tl2_key;\n\tstruct bnxt_tc_l2_key\t\tl2_mask;\n\tstruct bnxt_tc_l3_key\t\tl3_key;\n\tstruct bnxt_tc_l3_key\t\tl3_mask;\n\tstruct bnxt_tc_l4_key\t\tl4_key;\n\tstruct bnxt_tc_l4_key\t\tl4_mask;\n\tstruct ip_tunnel_key\t\ttun_key;\n\tstruct ip_tunnel_key\t\ttun_mask;\n\n\tstruct bnxt_tc_actions\t\tactions;\n\n\t \n\tstruct bnxt_tc_flow_stats\tstats;\n\t \n\tstruct bnxt_tc_flow_stats\tprev_stats;\n\tunsigned long\t\t\tlastused;  \n\t \n\tspinlock_t\t\t\tstats_lock;\n};\n\n \nstruct bnxt_tc_tunnel_node {\n\tstruct ip_tunnel_key\t\tkey;\n\tstruct rhash_head\t\tnode;\n\n\t \n\tstruct bnxt_tc_l2_key\t\tl2_info;\n\n#define\tINVALID_TUNNEL_HANDLE\t\tcpu_to_le32(0xffffffff)\n\t \n\t__le32\t\t\t\ttunnel_handle;\n\n\tu32\t\t\t\trefcount;\n\tstruct rcu_head\t\t\trcu;\n};\n\n \nstruct bnxt_tc_l2_node {\n\t \n#define BNXT_TC_L2_KEY_LEN\t\t\t16\n\tstruct bnxt_tc_l2_key\tkey;\n\tstruct rhash_head\tnode;\n\n\t \n\tstruct list_head\tcommon_l2_flows;\n\n\t \n\tu16\t\t\trefcount;\n\n\tstruct rcu_head\t\trcu;\n};\n\nstruct bnxt_tc_flow_node {\n\t \n\tunsigned long\t\t\tcookie;\n\tstruct rhash_head\t\tnode;\n\n\tstruct bnxt_tc_flow\t\tflow;\n\n\t__le64\t\t\t\text_flow_handle;\n\t__le16\t\t\t\tflow_handle;\n\t__le32\t\t\t\tflow_id;\n\n\t \n\tstruct bnxt_tc_l2_node\t\t*l2_node;\n\t \n\tstruct list_head\t\tl2_list_node;\n\n\t \n\tstruct bnxt_tc_tunnel_node\t*encap_node;\n\n\t \n\tstruct bnxt_tc_tunnel_node\t*decap_node;\n\t \n\tstruct bnxt_tc_l2_node\t\t*decap_l2_node;\n\t \n\tstruct list_head\t\tdecap_l2_list_node;\n\n\tstruct rcu_head\t\t\trcu;\n};\n\nint bnxt_tc_setup_flower(struct bnxt *bp, u16 src_fid,\n\t\t\t struct flow_cls_offload *cls_flower);\nint bnxt_init_tc(struct bnxt *bp);\nvoid bnxt_shutdown_tc(struct bnxt *bp);\nvoid bnxt_tc_flow_stats_work(struct bnxt *bp);\n\nstatic inline bool bnxt_tc_flower_enabled(struct bnxt *bp)\n{\n\treturn bp->tc_info && bp->tc_info->enabled;\n}\n\n#else  \n\nstatic inline int bnxt_tc_setup_flower(struct bnxt *bp, u16 src_fid,\n\t\t\t\t       struct flow_cls_offload *cls_flower)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline int bnxt_init_tc(struct bnxt *bp)\n{\n\treturn 0;\n}\n\nstatic inline void bnxt_shutdown_tc(struct bnxt *bp)\n{\n}\n\nstatic inline void bnxt_tc_flow_stats_work(struct bnxt *bp)\n{\n}\n\nstatic inline bool bnxt_tc_flower_enabled(struct bnxt *bp)\n{\n\treturn false;\n}\n#endif  \n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}