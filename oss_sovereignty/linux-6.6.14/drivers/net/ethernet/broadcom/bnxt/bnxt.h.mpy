{
  "module_name": "bnxt.h",
  "hash_id": "625f20f91ff92018a8598e092a776c9fce4385da83514cde6c58b9e6b388beaf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/broadcom/bnxt/bnxt.h",
  "human_readable_source": " \n\n#ifndef BNXT_H\n#define BNXT_H\n\n#define DRV_MODULE_NAME\t\t\"bnxt_en\"\n\n \n#define DRV_VER_MAJ\t1\n#define DRV_VER_MIN\t10\n#define DRV_VER_UPD\t2\n\n#include <linux/ethtool.h>\n#include <linux/interrupt.h>\n#include <linux/rhashtable.h>\n#include <linux/crash_dump.h>\n#include <linux/auxiliary_bus.h>\n#include <net/devlink.h>\n#include <net/dst_metadata.h>\n#include <net/xdp.h>\n#include <linux/dim.h>\n#include <linux/io-64-nonatomic-lo-hi.h>\n#ifdef CONFIG_TEE_BNXT_FW\n#include <linux/firmware/broadcom/tee_bnxt_fw.h>\n#endif\n\nextern struct list_head bnxt_block_cb_list;\n\nstruct page_pool;\n\nstruct tx_bd {\n\t__le32 tx_bd_len_flags_type;\n\t#define TX_BD_TYPE\t\t\t\t\t(0x3f << 0)\n\t #define TX_BD_TYPE_SHORT_TX_BD\t\t\t\t (0x00 << 0)\n\t #define TX_BD_TYPE_LONG_TX_BD\t\t\t\t (0x10 << 0)\n\t#define TX_BD_FLAGS_PACKET_END\t\t\t\t(1 << 6)\n\t#define TX_BD_FLAGS_NO_CMPL\t\t\t\t(1 << 7)\n\t#define TX_BD_FLAGS_BD_CNT\t\t\t\t(0x1f << 8)\n\t #define TX_BD_FLAGS_BD_CNT_SHIFT\t\t\t 8\n\t#define TX_BD_FLAGS_LHINT\t\t\t\t(3 << 13)\n\t #define TX_BD_FLAGS_LHINT_SHIFT\t\t\t 13\n\t #define TX_BD_FLAGS_LHINT_512_AND_SMALLER\t\t (0 << 13)\n\t #define TX_BD_FLAGS_LHINT_512_TO_1023\t\t\t (1 << 13)\n\t #define TX_BD_FLAGS_LHINT_1024_TO_2047\t\t\t (2 << 13)\n\t #define TX_BD_FLAGS_LHINT_2048_AND_LARGER\t\t (3 << 13)\n\t#define TX_BD_FLAGS_COAL_NOW\t\t\t\t(1 << 15)\n\t#define TX_BD_LEN\t\t\t\t\t(0xffff << 16)\n\t #define TX_BD_LEN_SHIFT\t\t\t\t 16\n\n\tu32 tx_bd_opaque;\n\t__le64 tx_bd_haddr;\n} __packed;\n\nstruct tx_bd_ext {\n\t__le32 tx_bd_hsize_lflags;\n\t#define TX_BD_FLAGS_TCP_UDP_CHKSUM\t\t\t(1 << 0)\n\t#define TX_BD_FLAGS_IP_CKSUM\t\t\t\t(1 << 1)\n\t#define TX_BD_FLAGS_NO_CRC\t\t\t\t(1 << 2)\n\t#define TX_BD_FLAGS_STAMP\t\t\t\t(1 << 3)\n\t#define TX_BD_FLAGS_T_IP_CHKSUM\t\t\t\t(1 << 4)\n\t#define TX_BD_FLAGS_LSO\t\t\t\t\t(1 << 5)\n\t#define TX_BD_FLAGS_IPID_FMT\t\t\t\t(1 << 6)\n\t#define TX_BD_FLAGS_T_IPID\t\t\t\t(1 << 7)\n\t#define TX_BD_HSIZE\t\t\t\t\t(0xff << 16)\n\t #define TX_BD_HSIZE_SHIFT\t\t\t\t 16\n\n\t__le32 tx_bd_mss;\n\t__le32 tx_bd_cfa_action;\n\t#define TX_BD_CFA_ACTION\t\t\t\t(0xffff << 16)\n\t #define TX_BD_CFA_ACTION_SHIFT\t\t\t\t 16\n\n\t__le32 tx_bd_cfa_meta;\n\t#define TX_BD_CFA_META_MASK                             0xfffffff\n\t#define TX_BD_CFA_META_VID_MASK                         0xfff\n\t#define TX_BD_CFA_META_PRI_MASK                         (0xf << 12)\n\t #define TX_BD_CFA_META_PRI_SHIFT                        12\n\t#define TX_BD_CFA_META_TPID_MASK                        (3 << 16)\n\t #define TX_BD_CFA_META_TPID_SHIFT                       16\n\t#define TX_BD_CFA_META_KEY                              (0xf << 28)\n\t #define TX_BD_CFA_META_KEY_SHIFT\t\t\t 28\n\t#define TX_BD_CFA_META_KEY_VLAN                         (1 << 28)\n};\n\n#define BNXT_TX_PTP_IS_SET(lflags) ((lflags) & cpu_to_le32(TX_BD_FLAGS_STAMP))\n\nstruct rx_bd {\n\t__le32 rx_bd_len_flags_type;\n\t#define RX_BD_TYPE\t\t\t\t\t(0x3f << 0)\n\t #define RX_BD_TYPE_RX_PACKET_BD\t\t\t 0x4\n\t #define RX_BD_TYPE_RX_BUFFER_BD\t\t\t 0x5\n\t #define RX_BD_TYPE_RX_AGG_BD\t\t\t\t 0x6\n\t #define RX_BD_TYPE_16B_BD_SIZE\t\t\t\t (0 << 4)\n\t #define RX_BD_TYPE_32B_BD_SIZE\t\t\t\t (1 << 4)\n\t #define RX_BD_TYPE_48B_BD_SIZE\t\t\t\t (2 << 4)\n\t #define RX_BD_TYPE_64B_BD_SIZE\t\t\t\t (3 << 4)\n\t#define RX_BD_FLAGS_SOP\t\t\t\t\t(1 << 6)\n\t#define RX_BD_FLAGS_EOP\t\t\t\t\t(1 << 7)\n\t#define RX_BD_FLAGS_BUFFERS\t\t\t\t(3 << 8)\n\t #define RX_BD_FLAGS_1_BUFFER_PACKET\t\t\t (0 << 8)\n\t #define RX_BD_FLAGS_2_BUFFER_PACKET\t\t\t (1 << 8)\n\t #define RX_BD_FLAGS_3_BUFFER_PACKET\t\t\t (2 << 8)\n\t #define RX_BD_FLAGS_4_BUFFER_PACKET\t\t\t (3 << 8)\n\t#define RX_BD_LEN\t\t\t\t\t(0xffff << 16)\n\t #define RX_BD_LEN_SHIFT\t\t\t\t 16\n\n\tu32 rx_bd_opaque;\n\t__le64 rx_bd_haddr;\n};\n\nstruct tx_cmp {\n\t__le32 tx_cmp_flags_type;\n\t#define CMP_TYPE\t\t\t\t\t(0x3f << 0)\n\t #define CMP_TYPE_TX_L2_CMP\t\t\t\t 0\n\t #define CMP_TYPE_RX_L2_CMP\t\t\t\t 17\n\t #define CMP_TYPE_RX_AGG_CMP\t\t\t\t 18\n\t #define CMP_TYPE_RX_L2_TPA_START_CMP\t\t\t 19\n\t #define CMP_TYPE_RX_L2_TPA_END_CMP\t\t\t 21\n\t #define CMP_TYPE_RX_TPA_AGG_CMP\t\t\t 22\n\t #define CMP_TYPE_STATUS_CMP\t\t\t\t 32\n\t #define CMP_TYPE_REMOTE_DRIVER_REQ\t\t\t 34\n\t #define CMP_TYPE_REMOTE_DRIVER_RESP\t\t\t 36\n\t #define CMP_TYPE_ERROR_STATUS\t\t\t\t 48\n\t #define CMPL_BASE_TYPE_STAT_EJECT\t\t\t 0x1aUL\n\t #define CMPL_BASE_TYPE_HWRM_DONE\t\t\t 0x20UL\n\t #define CMPL_BASE_TYPE_HWRM_FWD_REQ\t\t\t 0x22UL\n\t #define CMPL_BASE_TYPE_HWRM_FWD_RESP\t\t\t 0x24UL\n\t #define CMPL_BASE_TYPE_HWRM_ASYNC_EVENT\t\t 0x2eUL\n\n\t#define TX_CMP_FLAGS_ERROR\t\t\t\t(1 << 6)\n\t#define TX_CMP_FLAGS_PUSH\t\t\t\t(1 << 7)\n\n\tu32 tx_cmp_opaque;\n\t__le32 tx_cmp_errors_v;\n\t#define TX_CMP_V\t\t\t\t\t(1 << 0)\n\t#define TX_CMP_ERRORS_BUFFER_ERROR\t\t\t(7 << 1)\n\t #define TX_CMP_ERRORS_BUFFER_ERROR_NO_ERROR\t\t 0\n\t #define TX_CMP_ERRORS_BUFFER_ERROR_BAD_FORMAT\t\t 2\n\t #define TX_CMP_ERRORS_BUFFER_ERROR_INVALID_STAG\t 4\n\t #define TX_CMP_ERRORS_BUFFER_ERROR_STAG_BOUNDS\t\t 5\n\t #define TX_CMP_ERRORS_ZERO_LENGTH_PKT\t\t\t (1 << 4)\n\t #define TX_CMP_ERRORS_EXCESSIVE_BD_LEN\t\t\t (1 << 5)\n\t #define TX_CMP_ERRORS_DMA_ERROR\t\t\t (1 << 6)\n\t #define TX_CMP_ERRORS_HINT_TOO_SHORT\t\t\t (1 << 7)\n\n\t__le32 tx_cmp_unsed_3;\n};\n\nstruct rx_cmp {\n\t__le32 rx_cmp_len_flags_type;\n\t#define RX_CMP_CMP_TYPE\t\t\t\t\t(0x3f << 0)\n\t#define RX_CMP_FLAGS_ERROR\t\t\t\t(1 << 6)\n\t#define RX_CMP_FLAGS_PLACEMENT\t\t\t\t(7 << 7)\n\t#define RX_CMP_FLAGS_RSS_VALID\t\t\t\t(1 << 10)\n\t#define RX_CMP_FLAGS_PKT_METADATA_PRESENT\t\t(1 << 11)\n\t #define RX_CMP_FLAGS_ITYPES_SHIFT\t\t\t 12\n\t #define RX_CMP_FLAGS_ITYPES_MASK\t\t\t 0xf000\n\t #define RX_CMP_FLAGS_ITYPE_UNKNOWN\t\t\t (0 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_IP\t\t\t\t (1 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_TCP\t\t\t\t (2 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_UDP\t\t\t\t (3 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_FCOE\t\t\t (4 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_ROCE\t\t\t (5 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_PTP_WO_TS\t\t\t (8 << 12)\n\t #define RX_CMP_FLAGS_ITYPE_PTP_W_TS\t\t\t (9 << 12)\n\t#define RX_CMP_LEN\t\t\t\t\t(0xffff << 16)\n\t #define RX_CMP_LEN_SHIFT\t\t\t\t 16\n\n\tu32 rx_cmp_opaque;\n\t__le32 rx_cmp_misc_v1;\n\t#define RX_CMP_V1\t\t\t\t\t(1 << 0)\n\t#define RX_CMP_AGG_BUFS\t\t\t\t\t(0x1f << 1)\n\t #define RX_CMP_AGG_BUFS_SHIFT\t\t\t\t 1\n\t#define RX_CMP_RSS_HASH_TYPE\t\t\t\t(0x7f << 9)\n\t #define RX_CMP_RSS_HASH_TYPE_SHIFT\t\t\t 9\n\t#define RX_CMP_PAYLOAD_OFFSET\t\t\t\t(0xff << 16)\n\t #define RX_CMP_PAYLOAD_OFFSET_SHIFT\t\t\t 16\n\n\t__le32 rx_cmp_rss_hash;\n};\n\n#define BNXT_PTP_RX_TS_VALID(flags)\t\t\t\t\\\n\t(((flags) & RX_CMP_FLAGS_ITYPES_MASK) == RX_CMP_FLAGS_ITYPE_PTP_W_TS)\n\n#define BNXT_ALL_RX_TS_VALID(flags)\t\t\t\t\\\n\t!((flags) & RX_CMP_FLAGS_PKT_METADATA_PRESENT)\n\n#define RX_CMP_HASH_VALID(rxcmp)\t\t\t\t\\\n\t((rxcmp)->rx_cmp_len_flags_type & cpu_to_le32(RX_CMP_FLAGS_RSS_VALID))\n\n#define RSS_PROFILE_ID_MASK\t0x1f\n\n#define RX_CMP_HASH_TYPE(rxcmp)\t\t\t\t\t\\\n\t(((le32_to_cpu((rxcmp)->rx_cmp_misc_v1) & RX_CMP_RSS_HASH_TYPE) >>\\\n\t  RX_CMP_RSS_HASH_TYPE_SHIFT) & RSS_PROFILE_ID_MASK)\n\nstruct rx_cmp_ext {\n\t__le32 rx_cmp_flags2;\n\t#define RX_CMP_FLAGS2_IP_CS_CALC\t\t\t0x1\n\t#define RX_CMP_FLAGS2_L4_CS_CALC\t\t\t(0x1 << 1)\n\t#define RX_CMP_FLAGS2_T_IP_CS_CALC\t\t\t(0x1 << 2)\n\t#define RX_CMP_FLAGS2_T_L4_CS_CALC\t\t\t(0x1 << 3)\n\t#define RX_CMP_FLAGS2_META_FORMAT_VLAN\t\t\t(0x1 << 4)\n\t__le32 rx_cmp_meta_data;\n\t#define RX_CMP_FLAGS2_METADATA_TCI_MASK\t\t\t0xffff\n\t#define RX_CMP_FLAGS2_METADATA_VID_MASK\t\t\t0xfff\n\t#define RX_CMP_FLAGS2_METADATA_TPID_MASK\t\t0xffff0000\n\t #define RX_CMP_FLAGS2_METADATA_TPID_SFT\t\t 16\n\t__le32 rx_cmp_cfa_code_errors_v2;\n\t#define RX_CMP_V\t\t\t\t\t(1 << 0)\n\t#define RX_CMPL_ERRORS_MASK\t\t\t\t(0x7fff << 1)\n\t #define RX_CMPL_ERRORS_SFT\t\t\t\t 1\n\t#define RX_CMPL_ERRORS_BUFFER_ERROR_MASK\t\t(0x7 << 1)\n\t #define RX_CMPL_ERRORS_BUFFER_ERROR_NO_BUFFER\t\t (0x0 << 1)\n\t #define RX_CMPL_ERRORS_BUFFER_ERROR_DID_NOT_FIT\t (0x1 << 1)\n\t #define RX_CMPL_ERRORS_BUFFER_ERROR_NOT_ON_CHIP\t (0x2 << 1)\n\t #define RX_CMPL_ERRORS_BUFFER_ERROR_BAD_FORMAT\t\t (0x3 << 1)\n\t#define RX_CMPL_ERRORS_IP_CS_ERROR\t\t\t(0x1 << 4)\n\t#define RX_CMPL_ERRORS_L4_CS_ERROR\t\t\t(0x1 << 5)\n\t#define RX_CMPL_ERRORS_T_IP_CS_ERROR\t\t\t(0x1 << 6)\n\t#define RX_CMPL_ERRORS_T_L4_CS_ERROR\t\t\t(0x1 << 7)\n\t#define RX_CMPL_ERRORS_CRC_ERROR\t\t\t(0x1 << 8)\n\t#define RX_CMPL_ERRORS_T_PKT_ERROR_MASK\t\t\t(0x7 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_NO_ERROR\t\t (0x0 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_T_L3_BAD_VERSION\t (0x1 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_T_L3_BAD_HDR_LEN\t (0x2 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_TUNNEL_TOTAL_ERROR\t (0x3 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_T_IP_TOTAL_ERROR\t (0x4 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_T_UDP_TOTAL_ERROR\t (0x5 << 9)\n\t #define RX_CMPL_ERRORS_T_PKT_ERROR_T_L3_BAD_TTL\t (0x6 << 9)\n\t#define RX_CMPL_ERRORS_PKT_ERROR_MASK\t\t\t(0xf << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_NO_ERROR\t\t (0x0 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L3_BAD_VERSION\t (0x1 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L3_BAD_HDR_LEN\t (0x2 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L3_BAD_TTL\t\t (0x3 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_IP_TOTAL_ERROR\t (0x4 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_UDP_TOTAL_ERROR\t (0x5 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L4_BAD_HDR_LEN\t (0x6 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L4_BAD_HDR_LEN_TOO_SMALL (0x7 << 12)\n\t #define RX_CMPL_ERRORS_PKT_ERROR_L4_BAD_OPT_LEN\t (0x8 << 12)\n\n\t#define RX_CMPL_CFA_CODE_MASK\t\t\t\t(0xffff << 16)\n\t #define RX_CMPL_CFA_CODE_SFT\t\t\t\t 16\n\n\t__le32 rx_cmp_timestamp;\n};\n\n#define RX_CMP_L2_ERRORS\t\t\t\t\t\t\\\n\tcpu_to_le32(RX_CMPL_ERRORS_BUFFER_ERROR_MASK | RX_CMPL_ERRORS_CRC_ERROR)\n\n#define RX_CMP_L4_CS_BITS\t\t\t\t\t\t\\\n\t(cpu_to_le32(RX_CMP_FLAGS2_L4_CS_CALC | RX_CMP_FLAGS2_T_L4_CS_CALC))\n\n#define RX_CMP_L4_CS_ERR_BITS\t\t\t\t\t\t\\\n\t(cpu_to_le32(RX_CMPL_ERRORS_L4_CS_ERROR | RX_CMPL_ERRORS_T_L4_CS_ERROR))\n\n#define RX_CMP_L4_CS_OK(rxcmp1)\t\t\t\t\t\t\\\n\t    (((rxcmp1)->rx_cmp_flags2 &\tRX_CMP_L4_CS_BITS) &&\t\t\\\n\t     !((rxcmp1)->rx_cmp_cfa_code_errors_v2 & RX_CMP_L4_CS_ERR_BITS))\n\n#define RX_CMP_ENCAP(rxcmp1)\t\t\t\t\t\t\\\n\t    ((le32_to_cpu((rxcmp1)->rx_cmp_flags2) &\t\t\t\\\n\t     RX_CMP_FLAGS2_T_L4_CS_CALC) >> 3)\n\n#define RX_CMP_CFA_CODE(rxcmpl1)\t\t\t\t\t\\\n\t((le32_to_cpu((rxcmpl1)->rx_cmp_cfa_code_errors_v2) &\t\t\\\n\t  RX_CMPL_CFA_CODE_MASK) >> RX_CMPL_CFA_CODE_SFT)\n\nstruct rx_agg_cmp {\n\t__le32 rx_agg_cmp_len_flags_type;\n\t#define RX_AGG_CMP_TYPE\t\t\t\t\t(0x3f << 0)\n\t#define RX_AGG_CMP_LEN\t\t\t\t\t(0xffff << 16)\n\t #define RX_AGG_CMP_LEN_SHIFT\t\t\t\t 16\n\tu32 rx_agg_cmp_opaque;\n\t__le32 rx_agg_cmp_v;\n\t#define RX_AGG_CMP_V\t\t\t\t\t(1 << 0)\n\t#define RX_AGG_CMP_AGG_ID\t\t\t\t(0xffff << 16)\n\t #define RX_AGG_CMP_AGG_ID_SHIFT\t\t\t 16\n\t__le32 rx_agg_cmp_unused;\n};\n\n#define TPA_AGG_AGG_ID(rx_agg)\t\t\t\t\\\n\t((le32_to_cpu((rx_agg)->rx_agg_cmp_v) &\t\t\\\n\t RX_AGG_CMP_AGG_ID) >> RX_AGG_CMP_AGG_ID_SHIFT)\n\nstruct rx_tpa_start_cmp {\n\t__le32 rx_tpa_start_cmp_len_flags_type;\n\t#define RX_TPA_START_CMP_TYPE\t\t\t\t(0x3f << 0)\n\t#define RX_TPA_START_CMP_FLAGS\t\t\t\t(0x3ff << 6)\n\t #define RX_TPA_START_CMP_FLAGS_SHIFT\t\t\t 6\n\t#define RX_TPA_START_CMP_FLAGS_ERROR\t\t\t(0x1 << 6)\n\t#define RX_TPA_START_CMP_FLAGS_PLACEMENT\t\t(0x7 << 7)\n\t #define RX_TPA_START_CMP_FLAGS_PLACEMENT_SHIFT\t\t 7\n\t #define RX_TPA_START_CMP_FLAGS_PLACEMENT_JUMBO\t\t (0x1 << 7)\n\t #define RX_TPA_START_CMP_FLAGS_PLACEMENT_HDS\t\t (0x2 << 7)\n\t #define RX_TPA_START_CMP_FLAGS_PLACEMENT_GRO_JUMBO\t (0x5 << 7)\n\t #define RX_TPA_START_CMP_FLAGS_PLACEMENT_GRO_HDS\t (0x6 << 7)\n\t#define RX_TPA_START_CMP_FLAGS_RSS_VALID\t\t(0x1 << 10)\n\t#define RX_TPA_START_CMP_FLAGS_TIMESTAMP\t\t(0x1 << 11)\n\t#define RX_TPA_START_CMP_FLAGS_ITYPES\t\t\t(0xf << 12)\n\t #define RX_TPA_START_CMP_FLAGS_ITYPES_SHIFT\t\t 12\n\t #define RX_TPA_START_CMP_FLAGS_ITYPE_TCP\t\t (0x2 << 12)\n\t#define RX_TPA_START_CMP_LEN\t\t\t\t(0xffff << 16)\n\t #define RX_TPA_START_CMP_LEN_SHIFT\t\t\t 16\n\n\tu32 rx_tpa_start_cmp_opaque;\n\t__le32 rx_tpa_start_cmp_misc_v1;\n\t#define RX_TPA_START_CMP_V1\t\t\t\t(0x1 << 0)\n\t#define RX_TPA_START_CMP_RSS_HASH_TYPE\t\t\t(0x7f << 9)\n\t #define RX_TPA_START_CMP_RSS_HASH_TYPE_SHIFT\t\t 9\n\t#define RX_TPA_START_CMP_AGG_ID\t\t\t\t(0x7f << 25)\n\t #define RX_TPA_START_CMP_AGG_ID_SHIFT\t\t\t 25\n\t#define RX_TPA_START_CMP_AGG_ID_P5\t\t\t(0xffff << 16)\n\t #define RX_TPA_START_CMP_AGG_ID_SHIFT_P5\t\t 16\n\n\t__le32 rx_tpa_start_cmp_rss_hash;\n};\n\n#define TPA_START_HASH_VALID(rx_tpa_start)\t\t\t\t\\\n\t((rx_tpa_start)->rx_tpa_start_cmp_len_flags_type &\t\t\\\n\t cpu_to_le32(RX_TPA_START_CMP_FLAGS_RSS_VALID))\n\n#define TPA_START_HASH_TYPE(rx_tpa_start)\t\t\t\t\\\n\t(((le32_to_cpu((rx_tpa_start)->rx_tpa_start_cmp_misc_v1) &\t\\\n\t   RX_TPA_START_CMP_RSS_HASH_TYPE) >>\t\t\t\t\\\n\t  RX_TPA_START_CMP_RSS_HASH_TYPE_SHIFT) & RSS_PROFILE_ID_MASK)\n\n#define TPA_START_AGG_ID(rx_tpa_start)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_start)->rx_tpa_start_cmp_misc_v1) &\t\\\n\t RX_TPA_START_CMP_AGG_ID) >> RX_TPA_START_CMP_AGG_ID_SHIFT)\n\n#define TPA_START_AGG_ID_P5(rx_tpa_start)\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_start)->rx_tpa_start_cmp_misc_v1) &\t\\\n\t RX_TPA_START_CMP_AGG_ID_P5) >> RX_TPA_START_CMP_AGG_ID_SHIFT_P5)\n\n#define TPA_START_ERROR(rx_tpa_start)\t\t\t\t\t\\\n\t((rx_tpa_start)->rx_tpa_start_cmp_len_flags_type &\t\t\\\n\t cpu_to_le32(RX_TPA_START_CMP_FLAGS_ERROR))\n\nstruct rx_tpa_start_cmp_ext {\n\t__le32 rx_tpa_start_cmp_flags2;\n\t#define RX_TPA_START_CMP_FLAGS2_IP_CS_CALC\t\t(0x1 << 0)\n\t#define RX_TPA_START_CMP_FLAGS2_L4_CS_CALC\t\t(0x1 << 1)\n\t#define RX_TPA_START_CMP_FLAGS2_T_IP_CS_CALC\t\t(0x1 << 2)\n\t#define RX_TPA_START_CMP_FLAGS2_T_L4_CS_CALC\t\t(0x1 << 3)\n\t#define RX_TPA_START_CMP_FLAGS2_IP_TYPE\t\t\t(0x1 << 8)\n\t#define RX_TPA_START_CMP_FLAGS2_CSUM_CMPL_VALID\t\t(0x1 << 9)\n\t#define RX_TPA_START_CMP_FLAGS2_EXT_META_FORMAT\t\t(0x3 << 10)\n\t #define RX_TPA_START_CMP_FLAGS2_EXT_META_FORMAT_SHIFT\t 10\n\t#define RX_TPA_START_CMP_FLAGS2_CSUM_CMPL\t\t(0xffff << 16)\n\t #define RX_TPA_START_CMP_FLAGS2_CSUM_CMPL_SHIFT\t 16\n\n\t__le32 rx_tpa_start_cmp_metadata;\n\t__le32 rx_tpa_start_cmp_cfa_code_v2;\n\t#define RX_TPA_START_CMP_V2\t\t\t\t(0x1 << 0)\n\t#define RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_MASK\t(0x7 << 1)\n\t #define RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_SHIFT\t 1\n\t #define RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_NO_BUFFER\t (0x0 << 1)\n\t #define RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_BAD_FORMAT (0x3 << 1)\n\t #define RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_FLUSH\t (0x5 << 1)\n\t#define RX_TPA_START_CMP_CFA_CODE\t\t\t(0xffff << 16)\n\t #define RX_TPA_START_CMPL_CFA_CODE_SHIFT\t\t 16\n\t__le32 rx_tpa_start_cmp_hdr_info;\n};\n\n#define TPA_START_CFA_CODE(rx_tpa_start)\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_start)->rx_tpa_start_cmp_cfa_code_v2) &\t\\\n\t RX_TPA_START_CMP_CFA_CODE) >> RX_TPA_START_CMPL_CFA_CODE_SHIFT)\n\n#define TPA_START_IS_IPV6(rx_tpa_start)\t\t\t\t\\\n\t(!!((rx_tpa_start)->rx_tpa_start_cmp_flags2 &\t\t\\\n\t    cpu_to_le32(RX_TPA_START_CMP_FLAGS2_IP_TYPE)))\n\n#define TPA_START_ERROR_CODE(rx_tpa_start)\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_start)->rx_tpa_start_cmp_cfa_code_v2) &\t\\\n\t  RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_MASK) >>\t\t\t\\\n\t RX_TPA_START_CMP_ERRORS_BUFFER_ERROR_SHIFT)\n\nstruct rx_tpa_end_cmp {\n\t__le32 rx_tpa_end_cmp_len_flags_type;\n\t#define RX_TPA_END_CMP_TYPE\t\t\t\t(0x3f << 0)\n\t#define RX_TPA_END_CMP_FLAGS\t\t\t\t(0x3ff << 6)\n\t #define RX_TPA_END_CMP_FLAGS_SHIFT\t\t\t 6\n\t#define RX_TPA_END_CMP_FLAGS_PLACEMENT\t\t\t(0x7 << 7)\n\t #define RX_TPA_END_CMP_FLAGS_PLACEMENT_SHIFT\t\t 7\n\t #define RX_TPA_END_CMP_FLAGS_PLACEMENT_JUMBO\t\t (0x1 << 7)\n\t #define RX_TPA_END_CMP_FLAGS_PLACEMENT_HDS\t\t (0x2 << 7)\n\t #define RX_TPA_END_CMP_FLAGS_PLACEMENT_GRO_JUMBO\t (0x5 << 7)\n\t #define RX_TPA_END_CMP_FLAGS_PLACEMENT_GRO_HDS\t\t (0x6 << 7)\n\t#define RX_TPA_END_CMP_FLAGS_RSS_VALID\t\t\t(0x1 << 10)\n\t#define RX_TPA_END_CMP_FLAGS_ITYPES\t\t\t(0xf << 12)\n\t #define RX_TPA_END_CMP_FLAGS_ITYPES_SHIFT\t\t 12\n\t #define RX_TPA_END_CMP_FLAGS_ITYPE_TCP\t\t\t (0x2 << 12)\n\t#define RX_TPA_END_CMP_LEN\t\t\t\t(0xffff << 16)\n\t #define RX_TPA_END_CMP_LEN_SHIFT\t\t\t 16\n\n\tu32 rx_tpa_end_cmp_opaque;\n\t__le32 rx_tpa_end_cmp_misc_v1;\n\t#define RX_TPA_END_CMP_V1\t\t\t\t(0x1 << 0)\n\t#define RX_TPA_END_CMP_AGG_BUFS\t\t\t\t(0x3f << 1)\n\t #define RX_TPA_END_CMP_AGG_BUFS_SHIFT\t\t\t 1\n\t#define RX_TPA_END_CMP_TPA_SEGS\t\t\t\t(0xff << 8)\n\t #define RX_TPA_END_CMP_TPA_SEGS_SHIFT\t\t\t 8\n\t#define RX_TPA_END_CMP_PAYLOAD_OFFSET\t\t\t(0xff << 16)\n\t #define RX_TPA_END_CMP_PAYLOAD_OFFSET_SHIFT\t\t 16\n\t#define RX_TPA_END_CMP_AGG_ID\t\t\t\t(0x7f << 25)\n\t #define RX_TPA_END_CMP_AGG_ID_SHIFT\t\t\t 25\n\t#define RX_TPA_END_CMP_AGG_ID_P5\t\t\t(0xffff << 16)\n\t #define RX_TPA_END_CMP_AGG_ID_SHIFT_P5\t\t\t 16\n\n\t__le32 rx_tpa_end_cmp_tsdelta;\n\t#define RX_TPA_END_GRO_TS\t\t\t\t(0x1 << 31)\n};\n\n#define TPA_END_AGG_ID(rx_tpa_end)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end)->rx_tpa_end_cmp_misc_v1) &\t\t\\\n\t RX_TPA_END_CMP_AGG_ID) >> RX_TPA_END_CMP_AGG_ID_SHIFT)\n\n#define TPA_END_AGG_ID_P5(rx_tpa_end)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end)->rx_tpa_end_cmp_misc_v1) &\t\t\\\n\t RX_TPA_END_CMP_AGG_ID_P5) >> RX_TPA_END_CMP_AGG_ID_SHIFT_P5)\n\n#define TPA_END_PAYLOAD_OFF(rx_tpa_end)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end)->rx_tpa_end_cmp_misc_v1) &\t\t\\\n\t RX_TPA_END_CMP_PAYLOAD_OFFSET) >> RX_TPA_END_CMP_PAYLOAD_OFFSET_SHIFT)\n\n#define TPA_END_AGG_BUFS(rx_tpa_end)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end)->rx_tpa_end_cmp_misc_v1) &\t\t\\\n\t RX_TPA_END_CMP_AGG_BUFS) >> RX_TPA_END_CMP_AGG_BUFS_SHIFT)\n\n#define TPA_END_TPA_SEGS(rx_tpa_end)\t\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end)->rx_tpa_end_cmp_misc_v1) &\t\t\\\n\t RX_TPA_END_CMP_TPA_SEGS) >> RX_TPA_END_CMP_TPA_SEGS_SHIFT)\n\n#define RX_TPA_END_CMP_FLAGS_PLACEMENT_ANY_GRO\t\t\t\t\\\n\tcpu_to_le32(RX_TPA_END_CMP_FLAGS_PLACEMENT_GRO_JUMBO &\t\t\\\n\t\t    RX_TPA_END_CMP_FLAGS_PLACEMENT_GRO_HDS)\n\n#define TPA_END_GRO(rx_tpa_end)\t\t\t\t\t\t\\\n\t((rx_tpa_end)->rx_tpa_end_cmp_len_flags_type &\t\t\t\\\n\t RX_TPA_END_CMP_FLAGS_PLACEMENT_ANY_GRO)\n\n#define TPA_END_GRO_TS(rx_tpa_end)\t\t\t\t\t\\\n\t(!!((rx_tpa_end)->rx_tpa_end_cmp_tsdelta &\t\t\t\\\n\t    cpu_to_le32(RX_TPA_END_GRO_TS)))\n\nstruct rx_tpa_end_cmp_ext {\n\t__le32 rx_tpa_end_cmp_dup_acks;\n\t#define RX_TPA_END_CMP_TPA_DUP_ACKS\t\t\t(0xf << 0)\n\t#define RX_TPA_END_CMP_PAYLOAD_OFFSET_P5\t\t(0xff << 16)\n\t #define RX_TPA_END_CMP_PAYLOAD_OFFSET_SHIFT_P5\t\t 16\n\t#define RX_TPA_END_CMP_AGG_BUFS_P5\t\t\t(0xff << 24)\n\t #define RX_TPA_END_CMP_AGG_BUFS_SHIFT_P5\t\t 24\n\n\t__le32 rx_tpa_end_cmp_seg_len;\n\t#define RX_TPA_END_CMP_TPA_SEG_LEN\t\t\t(0xffff << 0)\n\n\t__le32 rx_tpa_end_cmp_errors_v2;\n\t#define RX_TPA_END_CMP_V2\t\t\t\t(0x1 << 0)\n\t#define RX_TPA_END_CMP_ERRORS\t\t\t\t(0x3 << 1)\n\t#define RX_TPA_END_CMP_ERRORS_P5\t\t\t(0x7 << 1)\n\t#define RX_TPA_END_CMPL_ERRORS_SHIFT\t\t\t 1\n\t #define RX_TPA_END_CMP_ERRORS_BUFFER_ERROR_NO_BUFFER\t (0x0 << 1)\n\t #define RX_TPA_END_CMP_ERRORS_BUFFER_ERROR_NOT_ON_CHIP\t (0x2 << 1)\n\t #define RX_TPA_END_CMP_ERRORS_BUFFER_ERROR_BAD_FORMAT\t (0x3 << 1)\n\t #define RX_TPA_END_CMP_ERRORS_BUFFER_ERROR_RSV_ERROR\t (0x4 << 1)\n\t #define RX_TPA_END_CMP_ERRORS_BUFFER_ERROR_FLUSH\t (0x5 << 1)\n\n\tu32 rx_tpa_end_cmp_start_opaque;\n};\n\n#define TPA_END_ERRORS(rx_tpa_end_ext)\t\t\t\t\t\\\n\t((rx_tpa_end_ext)->rx_tpa_end_cmp_errors_v2 &\t\t\t\\\n\t cpu_to_le32(RX_TPA_END_CMP_ERRORS))\n\n#define TPA_END_PAYLOAD_OFF_P5(rx_tpa_end_ext)\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end_ext)->rx_tpa_end_cmp_dup_acks) &\t\\\n\t RX_TPA_END_CMP_PAYLOAD_OFFSET_P5) >>\t\t\t\t\\\n\tRX_TPA_END_CMP_PAYLOAD_OFFSET_SHIFT_P5)\n\n#define TPA_END_AGG_BUFS_P5(rx_tpa_end_ext)\t\t\t\t\\\n\t((le32_to_cpu((rx_tpa_end_ext)->rx_tpa_end_cmp_dup_acks) &\t\\\n\t RX_TPA_END_CMP_AGG_BUFS_P5) >> RX_TPA_END_CMP_AGG_BUFS_SHIFT_P5)\n\n#define EVENT_DATA1_RESET_NOTIFY_FATAL(data1)\t\t\t\t\\\n\t(((data1) &\t\t\t\t\t\t\t\\\n\t  ASYNC_EVENT_CMPL_RESET_NOTIFY_EVENT_DATA1_REASON_CODE_MASK) ==\\\n\t ASYNC_EVENT_CMPL_RESET_NOTIFY_EVENT_DATA1_REASON_CODE_FW_EXCEPTION_FATAL)\n\n#define EVENT_DATA1_RESET_NOTIFY_FW_ACTIVATION(data1)\t\t\t\\\n\t(((data1) &\t\t\t\t\t\t\t\\\n\t  ASYNC_EVENT_CMPL_RESET_NOTIFY_EVENT_DATA1_REASON_CODE_MASK) ==\\\n\tASYNC_EVENT_CMPL_RESET_NOTIFY_EVENT_DATA1_REASON_CODE_FW_ACTIVATION)\n\n#define EVENT_DATA2_RESET_NOTIFY_FW_STATUS_CODE(data2)\t\t\t\\\n\t((data2) &\t\t\t\t\t\t\t\\\n\tASYNC_EVENT_CMPL_RESET_NOTIFY_EVENT_DATA2_FW_STATUS_CODE_MASK)\n\n#define EVENT_DATA1_RECOVERY_MASTER_FUNC(data1)\t\t\t\t\\\n\t!!((data1) &\t\t\t\t\t\t\t\\\n\t   ASYNC_EVENT_CMPL_ERROR_RECOVERY_EVENT_DATA1_FLAGS_MASTER_FUNC)\n\n#define EVENT_DATA1_RECOVERY_ENABLED(data1)\t\t\t\t\\\n\t!!((data1) &\t\t\t\t\t\t\t\\\n\t   ASYNC_EVENT_CMPL_ERROR_RECOVERY_EVENT_DATA1_FLAGS_RECOVERY_ENABLED)\n\n#define BNXT_EVENT_ERROR_REPORT_TYPE(data1)\t\t\t\t\\\n\t(((data1) &\t\t\t\t\t\t\t\\\n\t  ASYNC_EVENT_CMPL_ERROR_REPORT_BASE_EVENT_DATA1_ERROR_TYPE_MASK) >>\\\n\t ASYNC_EVENT_CMPL_ERROR_REPORT_BASE_EVENT_DATA1_ERROR_TYPE_SFT)\n\n#define BNXT_EVENT_INVALID_SIGNAL_DATA(data2)\t\t\t\t\\\n\t(((data2) &\t\t\t\t\t\t\t\\\n\t  ASYNC_EVENT_CMPL_ERROR_REPORT_INVALID_SIGNAL_EVENT_DATA2_PIN_ID_MASK) >>\\\n\t ASYNC_EVENT_CMPL_ERROR_REPORT_INVALID_SIGNAL_EVENT_DATA2_PIN_ID_SFT)\n\nstruct nqe_cn {\n\t__le16\ttype;\n\t#define NQ_CN_TYPE_MASK           0x3fUL\n\t#define NQ_CN_TYPE_SFT            0\n\t#define NQ_CN_TYPE_CQ_NOTIFICATION  0x30UL\n\t#define NQ_CN_TYPE_LAST            NQ_CN_TYPE_CQ_NOTIFICATION\n\t__le16\treserved16;\n\t__le32\tcq_handle_low;\n\t__le32\tv;\n\t#define NQ_CN_V     0x1UL\n\t__le32\tcq_handle_high;\n};\n\n#define DB_IDX_MASK\t\t\t\t\t\t0xffffff\n#define DB_IDX_VALID\t\t\t\t\t\t(0x1 << 26)\n#define DB_IRQ_DIS\t\t\t\t\t\t(0x1 << 27)\n#define DB_KEY_TX\t\t\t\t\t\t(0x0 << 28)\n#define DB_KEY_RX\t\t\t\t\t\t(0x1 << 28)\n#define DB_KEY_CP\t\t\t\t\t\t(0x2 << 28)\n#define DB_KEY_ST\t\t\t\t\t\t(0x3 << 28)\n#define DB_KEY_TX_PUSH\t\t\t\t\t\t(0x4 << 28)\n#define DB_LONG_TX_PUSH\t\t\t\t\t\t(0x2 << 24)\n\n#define BNXT_MIN_ROCE_CP_RINGS\t2\n#define BNXT_MIN_ROCE_STAT_CTXS\t1\n\n \n#define DBR_INDEX_MASK\t\t\t\t\t0x0000000000ffffffULL\n#define DBR_XID_MASK\t\t\t\t\t0x000fffff00000000ULL\n#define DBR_XID_SFT\t\t\t\t\t32\n#define DBR_PATH_L2\t\t\t\t\t(0x1ULL << 56)\n#define DBR_TYPE_SQ\t\t\t\t\t(0x0ULL << 60)\n#define DBR_TYPE_RQ\t\t\t\t\t(0x1ULL << 60)\n#define DBR_TYPE_SRQ\t\t\t\t\t(0x2ULL << 60)\n#define DBR_TYPE_SRQ_ARM\t\t\t\t(0x3ULL << 60)\n#define DBR_TYPE_CQ\t\t\t\t\t(0x4ULL << 60)\n#define DBR_TYPE_CQ_ARMSE\t\t\t\t(0x5ULL << 60)\n#define DBR_TYPE_CQ_ARMALL\t\t\t\t(0x6ULL << 60)\n#define DBR_TYPE_CQ_ARMENA\t\t\t\t(0x7ULL << 60)\n#define DBR_TYPE_SRQ_ARMENA\t\t\t\t(0x8ULL << 60)\n#define DBR_TYPE_CQ_CUTOFF_ACK\t\t\t\t(0x9ULL << 60)\n#define DBR_TYPE_NQ\t\t\t\t\t(0xaULL << 60)\n#define DBR_TYPE_NQ_ARM\t\t\t\t\t(0xbULL << 60)\n#define DBR_TYPE_NULL\t\t\t\t\t(0xfULL << 60)\n\n#define DB_PF_OFFSET_P5\t\t\t\t\t0x10000\n#define DB_VF_OFFSET_P5\t\t\t\t\t0x4000\n\n#define INVALID_HW_RING_ID\t((u16)-1)\n\n \n#if (PAGE_SHIFT < 12)\n#define BNXT_PAGE_SHIFT\t12\n#elif (PAGE_SHIFT <= 13)\n#define BNXT_PAGE_SHIFT\tPAGE_SHIFT\n#elif (PAGE_SHIFT < 16)\n#define BNXT_PAGE_SHIFT\t13\n#else\n#define BNXT_PAGE_SHIFT\t16\n#endif\n\n#define BNXT_PAGE_SIZE\t(1 << BNXT_PAGE_SHIFT)\n\n \n#if (PAGE_SHIFT > 15)\n#define BNXT_RX_PAGE_SHIFT 15\n#else\n#define BNXT_RX_PAGE_SHIFT PAGE_SHIFT\n#endif\n\n#define BNXT_RX_PAGE_SIZE (1 << BNXT_RX_PAGE_SHIFT)\n\n#define BNXT_MAX_MTU\t\t9500\n\n \n#define BNXT_MAX_PAGE_MODE_MTU_SBUF \\\n\t((unsigned int)PAGE_SIZE - VLAN_ETH_HLEN - NET_IP_ALIGN -\t\\\n\t XDP_PACKET_HEADROOM)\n#define BNXT_MAX_PAGE_MODE_MTU\t\\\n\t(BNXT_MAX_PAGE_MODE_MTU_SBUF - \\\n\t SKB_DATA_ALIGN((unsigned int)sizeof(struct skb_shared_info)))\n\n#define BNXT_MIN_PKT_SIZE\t52\n\n#define BNXT_DEFAULT_RX_RING_SIZE\t511\n#define BNXT_DEFAULT_TX_RING_SIZE\t511\n\n#define MAX_TPA\t\t64\n#define MAX_TPA_P5\t256\n#define MAX_TPA_P5_MASK\t(MAX_TPA_P5 - 1)\n#define MAX_TPA_SEGS_P5\t0x3f\n\n#if (BNXT_PAGE_SHIFT == 16)\n#define MAX_RX_PAGES_AGG_ENA\t1\n#define MAX_RX_PAGES\t4\n#define MAX_RX_AGG_PAGES\t4\n#define MAX_TX_PAGES\t1\n#define MAX_CP_PAGES\t16\n#else\n#define MAX_RX_PAGES_AGG_ENA\t8\n#define MAX_RX_PAGES\t32\n#define MAX_RX_AGG_PAGES\t32\n#define MAX_TX_PAGES\t8\n#define MAX_CP_PAGES\t128\n#endif\n\n#define RX_DESC_CNT (BNXT_PAGE_SIZE / sizeof(struct rx_bd))\n#define TX_DESC_CNT (BNXT_PAGE_SIZE / sizeof(struct tx_bd))\n#define CP_DESC_CNT (BNXT_PAGE_SIZE / sizeof(struct tx_cmp))\n\n#define SW_RXBD_RING_SIZE (sizeof(struct bnxt_sw_rx_bd) * RX_DESC_CNT)\n#define HW_RXBD_RING_SIZE (sizeof(struct rx_bd) * RX_DESC_CNT)\n\n#define SW_RXBD_AGG_RING_SIZE (sizeof(struct bnxt_sw_rx_agg_bd) * RX_DESC_CNT)\n\n#define SW_TXBD_RING_SIZE (sizeof(struct bnxt_sw_tx_bd) * TX_DESC_CNT)\n#define HW_TXBD_RING_SIZE (sizeof(struct tx_bd) * TX_DESC_CNT)\n\n#define HW_CMPD_RING_SIZE (sizeof(struct tx_cmp) * CP_DESC_CNT)\n\n#define BNXT_MAX_RX_DESC_CNT\t\t(RX_DESC_CNT * MAX_RX_PAGES - 1)\n#define BNXT_MAX_RX_DESC_CNT_JUM_ENA\t(RX_DESC_CNT * MAX_RX_PAGES_AGG_ENA - 1)\n#define BNXT_MAX_RX_JUM_DESC_CNT\t(RX_DESC_CNT * MAX_RX_AGG_PAGES - 1)\n#define BNXT_MAX_TX_DESC_CNT\t\t(TX_DESC_CNT * MAX_TX_PAGES - 1)\n\n \n#define BNXT_MIN_TX_DESC_CNT\t\t(MAX_SKB_FRAGS + 2)\n\n#define RX_RING(x)\t(((x) & ~(RX_DESC_CNT - 1)) >> (BNXT_PAGE_SHIFT - 4))\n#define RX_IDX(x)\t((x) & (RX_DESC_CNT - 1))\n\n#define TX_RING(x)\t(((x) & ~(TX_DESC_CNT - 1)) >> (BNXT_PAGE_SHIFT - 4))\n#define TX_IDX(x)\t((x) & (TX_DESC_CNT - 1))\n\n#define CP_RING(x)\t(((x) & ~(CP_DESC_CNT - 1)) >> (BNXT_PAGE_SHIFT - 4))\n#define CP_IDX(x)\t((x) & (CP_DESC_CNT - 1))\n\n#define TX_CMP_VALID(txcmp, raw_cons)\t\t\t\t\t\\\n\t(!!((txcmp)->tx_cmp_errors_v & cpu_to_le32(TX_CMP_V)) ==\t\\\n\t !((raw_cons) & bp->cp_bit))\n\n#define RX_CMP_VALID(rxcmp1, raw_cons)\t\t\t\t\t\\\n\t(!!((rxcmp1)->rx_cmp_cfa_code_errors_v2 & cpu_to_le32(RX_CMP_V)) ==\\\n\t !((raw_cons) & bp->cp_bit))\n\n#define RX_AGG_CMP_VALID(agg, raw_cons)\t\t\t\t\\\n\t(!!((agg)->rx_agg_cmp_v & cpu_to_le32(RX_AGG_CMP_V)) ==\t\\\n\t !((raw_cons) & bp->cp_bit))\n\n#define NQ_CMP_VALID(nqcmp, raw_cons)\t\t\t\t\\\n\t(!!((nqcmp)->v & cpu_to_le32(NQ_CN_V)) == !((raw_cons) & bp->cp_bit))\n\n#define TX_CMP_TYPE(txcmp)\t\t\t\t\t\\\n\t(le32_to_cpu((txcmp)->tx_cmp_flags_type) & CMP_TYPE)\n\n#define RX_CMP_TYPE(rxcmp)\t\t\t\t\t\\\n\t(le32_to_cpu((rxcmp)->rx_cmp_len_flags_type) & RX_CMP_CMP_TYPE)\n\n#define NEXT_RX(idx)\t\t(((idx) + 1) & bp->rx_ring_mask)\n\n#define NEXT_RX_AGG(idx)\t(((idx) + 1) & bp->rx_agg_ring_mask)\n\n#define NEXT_TX(idx)\t\t(((idx) + 1) & bp->tx_ring_mask)\n\n#define ADV_RAW_CMP(idx, n)\t((idx) + (n))\n#define NEXT_RAW_CMP(idx)\tADV_RAW_CMP(idx, 1)\n#define RING_CMP(idx)\t\t((idx) & bp->cp_ring_mask)\n#define NEXT_CMP(idx)\t\tRING_CMP(ADV_RAW_CMP(idx, 1))\n\n#define DFLT_HWRM_CMD_TIMEOUT\t\t500\n\n#define BNXT_RX_EVENT\t\t1\n#define BNXT_AGG_EVENT\t\t2\n#define BNXT_TX_EVENT\t\t4\n#define BNXT_REDIRECT_EVENT\t8\n\nstruct bnxt_sw_tx_bd {\n\tunion {\n\t\tstruct sk_buff\t\t*skb;\n\t\tstruct xdp_frame\t*xdpf;\n\t};\n\tDEFINE_DMA_UNMAP_ADDR(mapping);\n\tDEFINE_DMA_UNMAP_LEN(len);\n\tstruct page\t\t*page;\n\tu8\t\t\tis_gso;\n\tu8\t\t\tis_push;\n\tu8\t\t\taction;\n\tunsigned short\t\tnr_frags;\n\tu16\t\t\trx_prod;\n};\n\nstruct bnxt_sw_rx_bd {\n\tvoid\t\t\t*data;\n\tu8\t\t\t*data_ptr;\n\tdma_addr_t\t\tmapping;\n};\n\nstruct bnxt_sw_rx_agg_bd {\n\tstruct page\t\t*page;\n\tunsigned int\t\toffset;\n\tdma_addr_t\t\tmapping;\n};\n\nstruct bnxt_mem_init {\n\tu8\tinit_val;\n\tu16\toffset;\n#define\tBNXT_MEM_INVALID_OFFSET\t0xffff\n\tu16\tsize;\n};\n\nstruct bnxt_ring_mem_info {\n\tint\t\t\tnr_pages;\n\tint\t\t\tpage_size;\n\tu16\t\t\tflags;\n#define BNXT_RMEM_VALID_PTE_FLAG\t1\n#define BNXT_RMEM_RING_PTE_FLAG\t\t2\n#define BNXT_RMEM_USE_FULL_PAGE_FLAG\t4\n\n\tu16\t\t\tdepth;\n\tstruct bnxt_mem_init\t*mem_init;\n\n\tvoid\t\t\t**pg_arr;\n\tdma_addr_t\t\t*dma_arr;\n\n\t__le64\t\t\t*pg_tbl;\n\tdma_addr_t\t\tpg_tbl_map;\n\n\tint\t\t\tvmem_size;\n\tvoid\t\t\t**vmem;\n};\n\nstruct bnxt_ring_struct {\n\tstruct bnxt_ring_mem_info\tring_mem;\n\n\tu16\t\t\tfw_ring_id;  \n\tunion {\n\t\tu16\t\tgrp_idx;\n\t\tu16\t\tmap_idx;  \n\t};\n\tu32\t\t\thandle;\n\tu8\t\t\tqueue_id;\n};\n\nstruct tx_push_bd {\n\t__le32\t\t\tdoorbell;\n\t__le32\t\t\ttx_bd_len_flags_type;\n\tu32\t\t\ttx_bd_opaque;\n\tstruct tx_bd_ext\ttxbd2;\n};\n\nstruct tx_push_buffer {\n\tstruct tx_push_bd\tpush_bd;\n\tu32\t\t\tdata[25];\n};\n\nstruct bnxt_db_info {\n\tvoid __iomem\t\t*doorbell;\n\tunion {\n\t\tu64\t\tdb_key64;\n\t\tu32\t\tdb_key32;\n\t};\n};\n\nstruct bnxt_tx_ring_info {\n\tstruct bnxt_napi\t*bnapi;\n\tu16\t\t\ttx_prod;\n\tu16\t\t\ttx_cons;\n\tu16\t\t\ttxq_index;\n\tu8\t\t\tkick_pending;\n\tstruct bnxt_db_info\ttx_db;\n\n\tstruct tx_bd\t\t*tx_desc_ring[MAX_TX_PAGES];\n\tstruct bnxt_sw_tx_bd\t*tx_buf_ring;\n\n\tdma_addr_t\t\ttx_desc_mapping[MAX_TX_PAGES];\n\n\tstruct tx_push_buffer\t*tx_push;\n\tdma_addr_t\t\ttx_push_mapping;\n\t__le64\t\t\tdata_mapping;\n\n#define BNXT_DEV_STATE_CLOSING\t0x1\n\tu32\t\t\tdev_state;\n\n\tstruct bnxt_ring_struct\ttx_ring_struct;\n\t \n\tspinlock_t\t\txdp_tx_lock;\n};\n\n#define BNXT_LEGACY_COAL_CMPL_PARAMS\t\t\t\t\t\\\n\t(RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_INT_LAT_TMR_MIN |\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_INT_LAT_TMR_MAX |\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_TIMER_RESET |\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_RING_IDLE |\t\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_NUM_CMPL_DMA_AGGR |\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_NUM_CMPL_DMA_AGGR_DURING_INT | \\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_CMPL_AGGR_DMA_TMR |\t\t\\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_CMPL_AGGR_DMA_TMR_DURING_INT | \\\n\t RING_AGGINT_QCAPS_RESP_CMPL_PARAMS_NUM_CMPL_AGGR_INT)\n\n#define BNXT_COAL_CMPL_ENABLES\t\t\t\t\t\t\\\n\t(RING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_NUM_CMPL_DMA_AGGR | \\\n\t RING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_CMPL_AGGR_DMA_TMR | \\\n\t RING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_INT_LAT_TMR_MAX | \\\n\t RING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_NUM_CMPL_AGGR_INT)\n\n#define BNXT_COAL_CMPL_MIN_TMR_ENABLE\t\t\t\t\t\\\n\tRING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_INT_LAT_TMR_MIN\n\n#define BNXT_COAL_CMPL_AGGR_TMR_DURING_INT_ENABLE\t\t\t\\\n\tRING_CMPL_RING_CFG_AGGINT_PARAMS_REQ_ENABLES_NUM_CMPL_DMA_AGGR_DURING_INT\n\nstruct bnxt_coal_cap {\n\tu32\t\t\tcmpl_params;\n\tu32\t\t\tnq_params;\n\tu16\t\t\tnum_cmpl_dma_aggr_max;\n\tu16\t\t\tnum_cmpl_dma_aggr_during_int_max;\n\tu16\t\t\tcmpl_aggr_dma_tmr_max;\n\tu16\t\t\tcmpl_aggr_dma_tmr_during_int_max;\n\tu16\t\t\tint_lat_tmr_min_max;\n\tu16\t\t\tint_lat_tmr_max_max;\n\tu16\t\t\tnum_cmpl_aggr_int_max;\n\tu16\t\t\ttimer_units;\n};\n\nstruct bnxt_coal {\n\tu16\t\t\tcoal_ticks;\n\tu16\t\t\tcoal_ticks_irq;\n\tu16\t\t\tcoal_bufs;\n\tu16\t\t\tcoal_bufs_irq;\n\t\t\t \n\tu16\t\t\tidle_thresh;\n\tu8\t\t\tbufs_per_record;\n\tu8\t\t\tbudget;\n\tu16\t\t\tflags;\n};\n\nstruct bnxt_tpa_info {\n\tvoid\t\t\t*data;\n\tu8\t\t\t*data_ptr;\n\tdma_addr_t\t\tmapping;\n\tu16\t\t\tlen;\n\tunsigned short\t\tgso_type;\n\tu32\t\t\tflags2;\n\tu32\t\t\tmetadata;\n\tenum pkt_hash_types\thash_type;\n\tu32\t\t\trss_hash;\n\tu32\t\t\thdr_info;\n\n#define BNXT_TPA_L4_SIZE(hdr_info)\t\\\n\t(((hdr_info) & 0xf8000000) ? ((hdr_info) >> 27) : 32)\n\n#define BNXT_TPA_INNER_L3_OFF(hdr_info)\t\\\n\t(((hdr_info) >> 18) & 0x1ff)\n\n#define BNXT_TPA_INNER_L2_OFF(hdr_info)\t\\\n\t(((hdr_info) >> 9) & 0x1ff)\n\n#define BNXT_TPA_OUTER_L3_OFF(hdr_info)\t\\\n\t((hdr_info) & 0x1ff)\n\n\tu16\t\t\tcfa_code;  \n\tu8\t\t\tagg_count;\n\tstruct rx_agg_cmp\t*agg_arr;\n};\n\n#define BNXT_AGG_IDX_BMAP_SIZE\t(MAX_TPA_P5 / BITS_PER_LONG)\n\nstruct bnxt_tpa_idx_map {\n\tu16\t\tagg_id_tbl[1024];\n\tunsigned long\tagg_idx_bmap[BNXT_AGG_IDX_BMAP_SIZE];\n};\n\nstruct bnxt_rx_ring_info {\n\tstruct bnxt_napi\t*bnapi;\n\tu16\t\t\trx_prod;\n\tu16\t\t\trx_agg_prod;\n\tu16\t\t\trx_sw_agg_prod;\n\tu16\t\t\trx_next_cons;\n\tstruct bnxt_db_info\trx_db;\n\tstruct bnxt_db_info\trx_agg_db;\n\n\tstruct bpf_prog\t\t*xdp_prog;\n\n\tstruct rx_bd\t\t*rx_desc_ring[MAX_RX_PAGES];\n\tstruct bnxt_sw_rx_bd\t*rx_buf_ring;\n\n\tstruct rx_bd\t\t*rx_agg_desc_ring[MAX_RX_AGG_PAGES];\n\tstruct bnxt_sw_rx_agg_bd\t*rx_agg_ring;\n\n\tunsigned long\t\t*rx_agg_bmap;\n\tu16\t\t\trx_agg_bmap_size;\n\n\tdma_addr_t\t\trx_desc_mapping[MAX_RX_PAGES];\n\tdma_addr_t\t\trx_agg_desc_mapping[MAX_RX_AGG_PAGES];\n\n\tstruct bnxt_tpa_info\t*rx_tpa;\n\tstruct bnxt_tpa_idx_map *rx_tpa_idx_map;\n\n\tstruct bnxt_ring_struct\trx_ring_struct;\n\tstruct bnxt_ring_struct\trx_agg_ring_struct;\n\tstruct xdp_rxq_info\txdp_rxq;\n\tstruct page_pool\t*page_pool;\n};\n\nstruct bnxt_rx_sw_stats {\n\tu64\t\t\trx_l4_csum_errors;\n\tu64\t\t\trx_resets;\n\tu64\t\t\trx_buf_errors;\n\tu64\t\t\trx_oom_discards;\n\tu64\t\t\trx_netpoll_discards;\n};\n\nstruct bnxt_tx_sw_stats {\n\tu64\t\t\ttx_resets;\n};\n\nstruct bnxt_cmn_sw_stats {\n\tu64\t\t\tmissed_irqs;\n};\n\nstruct bnxt_sw_stats {\n\tstruct bnxt_rx_sw_stats rx;\n\tstruct bnxt_tx_sw_stats tx;\n\tstruct bnxt_cmn_sw_stats cmn;\n};\n\nstruct bnxt_total_ring_err_stats {\n\tu64\t\t\trx_total_l4_csum_errors;\n\tu64\t\t\trx_total_resets;\n\tu64\t\t\trx_total_buf_errors;\n\tu64\t\t\trx_total_oom_discards;\n\tu64\t\t\trx_total_netpoll_discards;\n\tu64\t\t\trx_total_ring_discards;\n\tu64\t\t\ttx_total_resets;\n\tu64\t\t\ttx_total_ring_discards;\n\tu64\t\t\ttotal_missed_irqs;\n};\n\nstruct bnxt_stats_mem {\n\tu64\t\t*sw_stats;\n\tu64\t\t*hw_masks;\n\tvoid\t\t*hw_stats;\n\tdma_addr_t\thw_stats_map;\n\tint\t\tlen;\n};\n\nstruct bnxt_cp_ring_info {\n\tstruct bnxt_napi\t*bnapi;\n\tu32\t\t\tcp_raw_cons;\n\tstruct bnxt_db_info\tcp_db;\n\n\tu8\t\t\thad_work_done:1;\n\tu8\t\t\thas_more_work:1;\n\n\tu32\t\t\tlast_cp_raw_cons;\n\n\tstruct bnxt_coal\trx_ring_coal;\n\tu64\t\t\trx_packets;\n\tu64\t\t\trx_bytes;\n\tu64\t\t\tevent_ctr;\n\n\tstruct dim\t\tdim;\n\n\tunion {\n\t\tstruct tx_cmp\t**cp_desc_ring;\n\t\tstruct nqe_cn\t**nq_desc_ring;\n\t};\n\n\tdma_addr_t\t\t*cp_desc_mapping;\n\n\tstruct bnxt_stats_mem\tstats;\n\tu32\t\t\thw_stats_ctx_id;\n\n\tstruct bnxt_sw_stats\tsw_stats;\n\n\tstruct bnxt_ring_struct\tcp_ring_struct;\n\n\tstruct bnxt_cp_ring_info *cp_ring_arr[2];\n#define BNXT_RX_HDL\t0\n#define BNXT_TX_HDL\t1\n};\n\nstruct bnxt_napi {\n\tstruct napi_struct\tnapi;\n\tstruct bnxt\t\t*bp;\n\n\tint\t\t\tindex;\n\tstruct bnxt_cp_ring_info\tcp_ring;\n\tstruct bnxt_rx_ring_info\t*rx_ring;\n\tstruct bnxt_tx_ring_info\t*tx_ring;\n\n\tvoid\t\t\t(*tx_int)(struct bnxt *, struct bnxt_napi *,\n\t\t\t\t\t  int budget);\n\tint\t\t\ttx_pkts;\n\tu8\t\t\tevents;\n\tu8\t\t\ttx_fault:1;\n\n\tu32\t\t\tflags;\n#define BNXT_NAPI_FLAG_XDP\t0x1\n\n\tbool\t\t\tin_reset;\n};\n\nstruct bnxt_irq {\n\tirq_handler_t\thandler;\n\tunsigned int\tvector;\n\tu8\t\trequested:1;\n\tu8\t\thave_cpumask:1;\n\tchar\t\tname[IFNAMSIZ + 2];\n\tcpumask_var_t\tcpu_mask;\n};\n\n#define HWRM_RING_ALLOC_TX\t0x1\n#define HWRM_RING_ALLOC_RX\t0x2\n#define HWRM_RING_ALLOC_AGG\t0x4\n#define HWRM_RING_ALLOC_CMPL\t0x8\n#define HWRM_RING_ALLOC_NQ\t0x10\n\n#define INVALID_STATS_CTX_ID\t-1\n\nstruct bnxt_ring_grp_info {\n\tu16\tfw_stats_ctx;\n\tu16\tfw_grp_id;\n\tu16\trx_fw_ring_id;\n\tu16\tagg_fw_ring_id;\n\tu16\tcp_fw_ring_id;\n};\n\nstruct bnxt_vnic_info {\n\tu16\t\tfw_vnic_id;  \n#define BNXT_MAX_CTX_PER_VNIC\t8\n\tu16\t\tfw_rss_cos_lb_ctx[BNXT_MAX_CTX_PER_VNIC];\n\tu16\t\tfw_l2_ctx_id;\n#define BNXT_MAX_UC_ADDRS\t4\n\t__le64\t\tfw_l2_filter_id[BNXT_MAX_UC_ADDRS];\n\t\t\t\t \n\tu16\t\tuc_filter_count;\n\tu8\t\t*uc_list;\n\n\tu16\t\t*fw_grp_ids;\n\tdma_addr_t\trss_table_dma_addr;\n\t__le16\t\t*rss_table;\n\tdma_addr_t\trss_hash_key_dma_addr;\n\tu64\t\t*rss_hash_key;\n\tint\t\trss_table_size;\n#define BNXT_RSS_TABLE_ENTRIES_P5\t64\n#define BNXT_RSS_TABLE_SIZE_P5\t\t(BNXT_RSS_TABLE_ENTRIES_P5 * 4)\n#define BNXT_RSS_TABLE_MAX_TBL_P5\t8\n#define BNXT_MAX_RSS_TABLE_SIZE_P5\t\t\t\t\\\n\t(BNXT_RSS_TABLE_SIZE_P5 * BNXT_RSS_TABLE_MAX_TBL_P5)\n#define BNXT_MAX_RSS_TABLE_ENTRIES_P5\t\t\t\t\\\n\t(BNXT_RSS_TABLE_ENTRIES_P5 * BNXT_RSS_TABLE_MAX_TBL_P5)\n\n\tu32\t\trx_mask;\n\n\tu8\t\t*mc_list;\n\tint\t\tmc_list_size;\n\tint\t\tmc_list_count;\n\tdma_addr_t\tmc_list_mapping;\n#define BNXT_MAX_MC_ADDRS\t16\n\n\tu32\t\tflags;\n#define BNXT_VNIC_RSS_FLAG\t1\n#define BNXT_VNIC_RFS_FLAG\t2\n#define BNXT_VNIC_MCAST_FLAG\t4\n#define BNXT_VNIC_UCAST_FLAG\t8\n#define BNXT_VNIC_RFS_NEW_RSS_FLAG\t0x10\n};\n\nstruct bnxt_hw_resc {\n\tu16\tmin_rsscos_ctxs;\n\tu16\tmax_rsscos_ctxs;\n\tu16\tmin_cp_rings;\n\tu16\tmax_cp_rings;\n\tu16\tresv_cp_rings;\n\tu16\tmin_tx_rings;\n\tu16\tmax_tx_rings;\n\tu16\tresv_tx_rings;\n\tu16\tmax_tx_sch_inputs;\n\tu16\tmin_rx_rings;\n\tu16\tmax_rx_rings;\n\tu16\tresv_rx_rings;\n\tu16\tmin_hw_ring_grps;\n\tu16\tmax_hw_ring_grps;\n\tu16\tresv_hw_ring_grps;\n\tu16\tmin_l2_ctxs;\n\tu16\tmax_l2_ctxs;\n\tu16\tmin_vnics;\n\tu16\tmax_vnics;\n\tu16\tresv_vnics;\n\tu16\tmin_stat_ctxs;\n\tu16\tmax_stat_ctxs;\n\tu16\tresv_stat_ctxs;\n\tu16\tmax_nqs;\n\tu16\tmax_irqs;\n\tu16\tresv_irqs;\n};\n\n#if defined(CONFIG_BNXT_SRIOV)\nstruct bnxt_vf_info {\n\tu16\tfw_fid;\n\tu8\tmac_addr[ETH_ALEN];\t \n\tu8\tvf_mac_addr[ETH_ALEN];\t \n\tu16\tvlan;\n\tu16\tfunc_qcfg_flags;\n\tu32\tflags;\n#define BNXT_VF_QOS\t\t0x1\n#define BNXT_VF_SPOOFCHK\t0x2\n#define BNXT_VF_LINK_FORCED\t0x4\n#define BNXT_VF_LINK_UP\t\t0x8\n#define BNXT_VF_TRUST\t\t0x10\n\tu32\tmin_tx_rate;\n\tu32\tmax_tx_rate;\n\tvoid\t*hwrm_cmd_req_addr;\n\tdma_addr_t\thwrm_cmd_req_dma_addr;\n};\n#endif\n\nstruct bnxt_pf_info {\n#define BNXT_FIRST_PF_FID\t1\n#define BNXT_FIRST_VF_FID\t128\n\tu16\tfw_fid;\n\tu16\tport_id;\n\tu8\tmac_addr[ETH_ALEN];\n\tu32\tfirst_vf_id;\n\tu16\tactive_vfs;\n\tu16\tregistered_vfs;\n\tu16\tmax_vfs;\n\tu32\tmax_encap_records;\n\tu32\tmax_decap_records;\n\tu32\tmax_tx_em_flows;\n\tu32\tmax_tx_wm_flows;\n\tu32\tmax_rx_em_flows;\n\tu32\tmax_rx_wm_flows;\n\tunsigned long\t*vf_event_bmap;\n\tu16\thwrm_cmd_req_pages;\n\tu8\tvf_resv_strategy;\n#define BNXT_VF_RESV_STRATEGY_MAXIMAL\t0\n#define BNXT_VF_RESV_STRATEGY_MINIMAL\t1\n#define BNXT_VF_RESV_STRATEGY_MINIMAL_STATIC\t2\n\tvoid\t\t\t*hwrm_cmd_req_addr[4];\n\tdma_addr_t\t\thwrm_cmd_req_dma_addr[4];\n\tstruct bnxt_vf_info\t*vf;\n};\n\nstruct bnxt_ntuple_filter {\n\tstruct hlist_node\thash;\n\tu8\t\t\tdst_mac_addr[ETH_ALEN];\n\tu8\t\t\tsrc_mac_addr[ETH_ALEN];\n\tstruct flow_keys\tfkeys;\n\t__le64\t\t\tfilter_id;\n\tu16\t\t\tsw_id;\n\tu8\t\t\tl2_fltr_idx;\n\tu16\t\t\trxq;\n\tu32\t\t\tflow_id;\n\tunsigned long\t\tstate;\n#define BNXT_FLTR_VALID\t\t0\n#define BNXT_FLTR_UPDATE\t1\n};\n\nstruct bnxt_link_info {\n\tu8\t\t\tphy_type;\n\tu8\t\t\tmedia_type;\n\tu8\t\t\ttransceiver;\n\tu8\t\t\tphy_addr;\n\tu8\t\t\tphy_link_status;\n#define BNXT_LINK_NO_LINK\tPORT_PHY_QCFG_RESP_LINK_NO_LINK\n#define BNXT_LINK_SIGNAL\tPORT_PHY_QCFG_RESP_LINK_SIGNAL\n#define BNXT_LINK_LINK\t\tPORT_PHY_QCFG_RESP_LINK_LINK\n\tu8\t\t\twire_speed;\n\tu8\t\t\tphy_state;\n#define BNXT_PHY_STATE_ENABLED\t\t0\n#define BNXT_PHY_STATE_DISABLED\t\t1\n\n\tu8\t\t\tlink_state;\n#define BNXT_LINK_STATE_UNKNOWN\t0\n#define BNXT_LINK_STATE_DOWN\t1\n#define BNXT_LINK_STATE_UP\t2\n#define BNXT_LINK_IS_UP(bp)\t((bp)->link_info.link_state == BNXT_LINK_STATE_UP)\n\tu8\t\t\tduplex;\n#define BNXT_LINK_DUPLEX_HALF\tPORT_PHY_QCFG_RESP_DUPLEX_STATE_HALF\n#define BNXT_LINK_DUPLEX_FULL\tPORT_PHY_QCFG_RESP_DUPLEX_STATE_FULL\n\tu8\t\t\tpause;\n#define BNXT_LINK_PAUSE_TX\tPORT_PHY_QCFG_RESP_PAUSE_TX\n#define BNXT_LINK_PAUSE_RX\tPORT_PHY_QCFG_RESP_PAUSE_RX\n#define BNXT_LINK_PAUSE_BOTH\t(PORT_PHY_QCFG_RESP_PAUSE_RX | \\\n\t\t\t\t PORT_PHY_QCFG_RESP_PAUSE_TX)\n\tu8\t\t\tlp_pause;\n\tu8\t\t\tauto_pause_setting;\n\tu8\t\t\tforce_pause_setting;\n\tu8\t\t\tduplex_setting;\n\tu8\t\t\tauto_mode;\n#define BNXT_AUTO_MODE(mode)\t((mode) > BNXT_LINK_AUTO_NONE && \\\n\t\t\t\t (mode) <= BNXT_LINK_AUTO_MSK)\n#define BNXT_LINK_AUTO_NONE     PORT_PHY_QCFG_RESP_AUTO_MODE_NONE\n#define BNXT_LINK_AUTO_ALLSPDS\tPORT_PHY_QCFG_RESP_AUTO_MODE_ALL_SPEEDS\n#define BNXT_LINK_AUTO_ONESPD\tPORT_PHY_QCFG_RESP_AUTO_MODE_ONE_SPEED\n#define BNXT_LINK_AUTO_ONEORBELOW PORT_PHY_QCFG_RESP_AUTO_MODE_ONE_OR_BELOW\n#define BNXT_LINK_AUTO_MSK\tPORT_PHY_QCFG_RESP_AUTO_MODE_SPEED_MASK\n#define PHY_VER_LEN\t\t3\n\tu8\t\t\tphy_ver[PHY_VER_LEN];\n\tu16\t\t\tlink_speed;\n#define BNXT_LINK_SPEED_100MB\tPORT_PHY_QCFG_RESP_LINK_SPEED_100MB\n#define BNXT_LINK_SPEED_1GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_1GB\n#define BNXT_LINK_SPEED_2GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_2GB\n#define BNXT_LINK_SPEED_2_5GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_2_5GB\n#define BNXT_LINK_SPEED_10GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_10GB\n#define BNXT_LINK_SPEED_20GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_20GB\n#define BNXT_LINK_SPEED_25GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_25GB\n#define BNXT_LINK_SPEED_40GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_40GB\n#define BNXT_LINK_SPEED_50GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_50GB\n#define BNXT_LINK_SPEED_100GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_100GB\n#define BNXT_LINK_SPEED_200GB\tPORT_PHY_QCFG_RESP_LINK_SPEED_200GB\n\tu16\t\t\tsupport_speeds;\n\tu16\t\t\tsupport_pam4_speeds;\n\tu16\t\t\tauto_link_speeds;\t \n#define BNXT_LINK_SPEED_MSK_100MB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_100MB\n#define BNXT_LINK_SPEED_MSK_1GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_1GB\n#define BNXT_LINK_SPEED_MSK_2GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_2GB\n#define BNXT_LINK_SPEED_MSK_10GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_10GB\n#define BNXT_LINK_SPEED_MSK_2_5GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_2_5GB\n#define BNXT_LINK_SPEED_MSK_20GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_20GB\n#define BNXT_LINK_SPEED_MSK_25GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_25GB\n#define BNXT_LINK_SPEED_MSK_40GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_40GB\n#define BNXT_LINK_SPEED_MSK_50GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_50GB\n#define BNXT_LINK_SPEED_MSK_100GB PORT_PHY_QCFG_RESP_SUPPORT_SPEEDS_100GB\n\tu16\t\t\tauto_pam4_link_speeds;\n#define BNXT_LINK_PAM4_SPEED_MSK_50GB PORT_PHY_QCFG_RESP_SUPPORT_PAM4_SPEEDS_50G\n#define BNXT_LINK_PAM4_SPEED_MSK_100GB PORT_PHY_QCFG_RESP_SUPPORT_PAM4_SPEEDS_100G\n#define BNXT_LINK_PAM4_SPEED_MSK_200GB PORT_PHY_QCFG_RESP_SUPPORT_PAM4_SPEEDS_200G\n\tu16\t\t\tsupport_auto_speeds;\n\tu16\t\t\tsupport_pam4_auto_speeds;\n\tu16\t\t\tlp_auto_link_speeds;\n\tu16\t\t\tlp_auto_pam4_link_speeds;\n\tu16\t\t\tforce_link_speed;\n\tu16\t\t\tforce_pam4_link_speed;\n\tu32\t\t\tpreemphasis;\n\tu8\t\t\tmodule_status;\n\tu8\t\t\tactive_fec_sig_mode;\n\tu16\t\t\tfec_cfg;\n#define BNXT_FEC_NONE\t\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_NONE_SUPPORTED\n#define BNXT_FEC_AUTONEG_CAP\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_AUTONEG_SUPPORTED\n#define BNXT_FEC_AUTONEG\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_AUTONEG_ENABLED\n#define BNXT_FEC_ENC_BASE_R_CAP\t\\\n\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_CLAUSE74_SUPPORTED\n#define BNXT_FEC_ENC_BASE_R\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_CLAUSE74_ENABLED\n#define BNXT_FEC_ENC_RS_CAP\t\\\n\tPORT_PHY_QCFG_RESP_FEC_CFG_FEC_CLAUSE91_SUPPORTED\n#define BNXT_FEC_ENC_LLRS_CAP\t\\\n\t(PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS272_1XN_SUPPORTED |\t\\\n\t PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS272_IEEE_SUPPORTED)\n#define BNXT_FEC_ENC_RS\t\t\\\n\t(PORT_PHY_QCFG_RESP_FEC_CFG_FEC_CLAUSE91_ENABLED |\t\\\n\t PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS544_1XN_ENABLED |\t\\\n\t PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS544_IEEE_ENABLED)\n#define BNXT_FEC_ENC_LLRS\t\\\n\t(PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS272_1XN_ENABLED |\t\\\n\t PORT_PHY_QCFG_RESP_FEC_CFG_FEC_RS272_IEEE_ENABLED)\n\n\t \n\tu8\t\t\tautoneg;\n#define BNXT_AUTONEG_SPEED\t\t1\n#define BNXT_AUTONEG_FLOW_CTRL\t\t2\n\tu8\t\t\treq_signal_mode;\n#define BNXT_SIG_MODE_NRZ\tPORT_PHY_QCFG_RESP_SIGNAL_MODE_NRZ\n#define BNXT_SIG_MODE_PAM4\tPORT_PHY_QCFG_RESP_SIGNAL_MODE_PAM4\n\tu8\t\t\treq_duplex;\n\tu8\t\t\treq_flow_ctrl;\n\tu16\t\t\treq_link_speed;\n\tu16\t\t\tadvertising;\t \n\tu16\t\t\tadvertising_pam4;\n\tbool\t\t\tforce_link_chng;\n\n\tbool\t\t\tphy_retry;\n\tunsigned long\t\tphy_retry_expires;\n\n\t \n\tstruct hwrm_port_phy_qcfg_output phy_qcfg_resp;\n};\n\n#define BNXT_FEC_RS544_ON\t\t\t\t\t\\\n\t (PORT_PHY_CFG_REQ_FLAGS_FEC_RS544_1XN_ENABLE |\t\t\\\n\t  PORT_PHY_CFG_REQ_FLAGS_FEC_RS544_IEEE_ENABLE)\n\n#define BNXT_FEC_RS544_OFF\t\t\t\t\t\\\n\t (PORT_PHY_CFG_REQ_FLAGS_FEC_RS544_1XN_DISABLE |\t\\\n\t  PORT_PHY_CFG_REQ_FLAGS_FEC_RS544_IEEE_DISABLE)\n\n#define BNXT_FEC_RS272_ON\t\t\t\t\t\\\n\t (PORT_PHY_CFG_REQ_FLAGS_FEC_RS272_1XN_ENABLE |\t\t\\\n\t  PORT_PHY_CFG_REQ_FLAGS_FEC_RS272_IEEE_ENABLE)\n\n#define BNXT_FEC_RS272_OFF\t\t\t\t\t\\\n\t (PORT_PHY_CFG_REQ_FLAGS_FEC_RS272_1XN_DISABLE |\t\\\n\t  PORT_PHY_CFG_REQ_FLAGS_FEC_RS272_IEEE_DISABLE)\n\n#define BNXT_PAM4_SUPPORTED(link_info)\t\t\t\t\\\n\t((link_info)->support_pam4_speeds)\n\n#define BNXT_FEC_RS_ON(link_info)\t\t\t\t\\\n\t(PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE91_ENABLE |\t\t\\\n\t PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE74_DISABLE |\t\t\\\n\t (BNXT_PAM4_SUPPORTED(link_info) ?\t\t\t\\\n\t  (BNXT_FEC_RS544_ON | BNXT_FEC_RS272_OFF) : 0))\n\n#define BNXT_FEC_LLRS_ON\t\t\t\t\t\\\n\t(PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE91_ENABLE |\t\t\\\n\t PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE74_DISABLE |\t\t\\\n\t BNXT_FEC_RS272_ON | BNXT_FEC_RS544_OFF)\n\n#define BNXT_FEC_RS_OFF(link_info)\t\t\t\t\\\n\t(PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE91_DISABLE |\t\t\\\n\t (BNXT_PAM4_SUPPORTED(link_info) ?\t\t\t\\\n\t  (BNXT_FEC_RS544_OFF | BNXT_FEC_RS272_OFF) : 0))\n\n#define BNXT_FEC_BASE_R_ON(link_info)\t\t\t\t\\\n\t(PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE74_ENABLE |\t\t\\\n\t BNXT_FEC_RS_OFF(link_info))\n\n#define BNXT_FEC_ALL_OFF(link_info)\t\t\t\t\\\n\t(PORT_PHY_CFG_REQ_FLAGS_FEC_CLAUSE74_DISABLE |\t\t\\\n\t BNXT_FEC_RS_OFF(link_info))\n\n#define BNXT_MAX_QUEUE\t8\n\nstruct bnxt_queue_info {\n\tu8\tqueue_id;\n\tu8\tqueue_profile;\n};\n\n#define BNXT_MAX_LED\t\t\t4\n\nstruct bnxt_led_info {\n\tu8\tled_id;\n\tu8\tled_type;\n\tu8\tled_group_id;\n\tu8\tunused;\n\t__le16\tled_state_caps;\n#define BNXT_LED_ALT_BLINK_CAP(x)\t((x) &\t\\\n\tcpu_to_le16(PORT_LED_QCAPS_RESP_LED0_STATE_CAPS_BLINK_ALT_SUPPORTED))\n\n\t__le16\tled_color_caps;\n};\n\n#define BNXT_MAX_TEST\t8\n\nstruct bnxt_test_info {\n\tu8 offline_mask;\n\tu16 timeout;\n\tchar string[BNXT_MAX_TEST][ETH_GSTRING_LEN];\n};\n\n#define CHIMP_REG_VIEW_ADDR\t\t\t\t\\\n\t((bp->flags & BNXT_FLAG_CHIP_P5) ? 0x80000000 : 0xb1000000)\n\n#define BNXT_GRCPF_REG_CHIMP_COMM\t\t0x0\n#define BNXT_GRCPF_REG_CHIMP_COMM_TRIGGER\t0x100\n#define BNXT_GRCPF_REG_WINDOW_BASE_OUT\t\t0x400\n#define BNXT_CAG_REG_LEGACY_INT_STATUS\t\t0x4014\n#define BNXT_CAG_REG_BASE\t\t\t0x300000\n\n#define BNXT_GRC_REG_STATUS_P5\t\t\t0x520\n\n#define BNXT_GRCPF_REG_KONG_COMM\t\t0xA00\n#define BNXT_GRCPF_REG_KONG_COMM_TRIGGER\t0xB00\n\n#define BNXT_GRC_REG_CHIP_NUM\t\t\t0x48\n#define BNXT_GRC_REG_BASE\t\t\t0x260000\n\n#define BNXT_TS_REG_TIMESYNC_TS0_LOWER\t\t0x640180c\n#define BNXT_TS_REG_TIMESYNC_TS0_UPPER\t\t0x6401810\n\n#define BNXT_GRC_BASE_MASK\t\t\t0xfffff000\n#define BNXT_GRC_OFFSET_MASK\t\t\t0x00000ffc\n\nstruct bnxt_tc_flow_stats {\n\tu64\t\tpackets;\n\tu64\t\tbytes;\n};\n\n#ifdef CONFIG_BNXT_FLOWER_OFFLOAD\nstruct bnxt_flower_indr_block_cb_priv {\n\tstruct net_device *tunnel_netdev;\n\tstruct bnxt *bp;\n\tstruct list_head list;\n};\n#endif\n\nstruct bnxt_tc_info {\n\tbool\t\t\t\tenabled;\n\n\t \n\tstruct rhashtable\t\tflow_table;\n\tstruct rhashtable_params\tflow_ht_params;\n\n\t \n\tstruct rhashtable\t\tl2_table;\n\tstruct rhashtable_params\tl2_ht_params;\n\t \n\tstruct rhashtable\t\tdecap_l2_table;\n\tstruct rhashtable_params\tdecap_l2_ht_params;\n\t \n\tstruct rhashtable\t\tdecap_table;\n\tstruct rhashtable_params\tdecap_ht_params;\n\t \n\tstruct rhashtable\t\tencap_table;\n\tstruct rhashtable_params\tencap_ht_params;\n\n\t \n\tstruct mutex\t\t\tlock;\n\n\t \n\tstruct rhashtable_iter\t\titer;\n#define BNXT_FLOW_STATS_BATCH_MAX\t10\n\tstruct bnxt_tc_stats_batch {\n\t\tvoid\t\t\t  *flow_node;\n\t\tstruct bnxt_tc_flow_stats hw_stats;\n\t} stats_batch[BNXT_FLOW_STATS_BATCH_MAX];\n\n\t \n\tu64\t\t\t\tbytes_mask;\n\tu64\t\t\t\tpackets_mask;\n};\n\nstruct bnxt_vf_rep_stats {\n\tu64\t\t\tpackets;\n\tu64\t\t\tbytes;\n\tu64\t\t\tdropped;\n};\n\nstruct bnxt_vf_rep {\n\tstruct bnxt\t\t\t*bp;\n\tstruct net_device\t\t*dev;\n\tstruct metadata_dst\t\t*dst;\n\tu16\t\t\t\tvf_idx;\n\tu16\t\t\t\ttx_cfa_action;\n\tu16\t\t\t\trx_cfa_code;\n\n\tstruct bnxt_vf_rep_stats\trx_stats;\n\tstruct bnxt_vf_rep_stats\ttx_stats;\n};\n\n#define PTU_PTE_VALID             0x1UL\n#define PTU_PTE_LAST              0x2UL\n#define PTU_PTE_NEXT_TO_LAST      0x4UL\n\n#define MAX_CTX_PAGES\t(BNXT_PAGE_SIZE / 8)\n#define MAX_CTX_TOTAL_PAGES\t(MAX_CTX_PAGES * MAX_CTX_PAGES)\n\nstruct bnxt_ctx_pg_info {\n\tu32\t\tentries;\n\tu32\t\tnr_pages;\n\tvoid\t\t*ctx_pg_arr[MAX_CTX_PAGES];\n\tdma_addr_t\tctx_dma_arr[MAX_CTX_PAGES];\n\tstruct bnxt_ring_mem_info ring_mem;\n\tstruct bnxt_ctx_pg_info **ctx_pg_tbl;\n};\n\n#define BNXT_MAX_TQM_SP_RINGS\t\t1\n#define BNXT_MAX_TQM_FP_RINGS\t\t8\n#define BNXT_MAX_TQM_RINGS\t\t\\\n\t(BNXT_MAX_TQM_SP_RINGS + BNXT_MAX_TQM_FP_RINGS)\n\n#define BNXT_BACKING_STORE_CFG_LEGACY_LEN\t256\n\n#define BNXT_SET_CTX_PAGE_ATTR(attr)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif (BNXT_PAGE_SIZE == 0x2000)\t\t\t\t\t\\\n\t\tattr = FUNC_BACKING_STORE_CFG_REQ_SRQ_PG_SIZE_PG_8K;\t\\\n\telse if (BNXT_PAGE_SIZE == 0x10000)\t\t\t\t\\\n\t\tattr = FUNC_BACKING_STORE_CFG_REQ_QPC_PG_SIZE_PG_64K;\t\\\n\telse\t\t\t\t\t\t\t\t\\\n\t\tattr = FUNC_BACKING_STORE_CFG_REQ_QPC_PG_SIZE_PG_4K;\t\\\n} while (0)\n\nstruct bnxt_ctx_mem_info {\n\tu32\tqp_max_entries;\n\tu16\tqp_min_qp1_entries;\n\tu16\tqp_max_l2_entries;\n\tu16\tqp_entry_size;\n\tu16\tsrq_max_l2_entries;\n\tu32\tsrq_max_entries;\n\tu16\tsrq_entry_size;\n\tu16\tcq_max_l2_entries;\n\tu32\tcq_max_entries;\n\tu16\tcq_entry_size;\n\tu16\tvnic_max_vnic_entries;\n\tu16\tvnic_max_ring_table_entries;\n\tu16\tvnic_entry_size;\n\tu32\tstat_max_entries;\n\tu16\tstat_entry_size;\n\tu16\ttqm_entry_size;\n\tu32\ttqm_min_entries_per_ring;\n\tu32\ttqm_max_entries_per_ring;\n\tu32\tmrav_max_entries;\n\tu16\tmrav_entry_size;\n\tu16\ttim_entry_size;\n\tu32\ttim_max_entries;\n\tu16\tmrav_num_entries_units;\n\tu8\ttqm_entries_multiple;\n\tu8\ttqm_fp_rings_count;\n\n\tu32\tflags;\n\t#define BNXT_CTX_FLAG_INITED\t0x01\n\n\tstruct bnxt_ctx_pg_info qp_mem;\n\tstruct bnxt_ctx_pg_info srq_mem;\n\tstruct bnxt_ctx_pg_info cq_mem;\n\tstruct bnxt_ctx_pg_info vnic_mem;\n\tstruct bnxt_ctx_pg_info stat_mem;\n\tstruct bnxt_ctx_pg_info mrav_mem;\n\tstruct bnxt_ctx_pg_info tim_mem;\n\tstruct bnxt_ctx_pg_info *tqm_mem[BNXT_MAX_TQM_RINGS];\n\n#define BNXT_CTX_MEM_INIT_QP\t0\n#define BNXT_CTX_MEM_INIT_SRQ\t1\n#define BNXT_CTX_MEM_INIT_CQ\t2\n#define BNXT_CTX_MEM_INIT_VNIC\t3\n#define BNXT_CTX_MEM_INIT_STAT\t4\n#define BNXT_CTX_MEM_INIT_MRAV\t5\n#define BNXT_CTX_MEM_INIT_MAX\t6\n\tstruct bnxt_mem_init\tmem_init[BNXT_CTX_MEM_INIT_MAX];\n};\n\nenum bnxt_health_severity {\n\tSEVERITY_NORMAL = 0,\n\tSEVERITY_WARNING,\n\tSEVERITY_RECOVERABLE,\n\tSEVERITY_FATAL,\n};\n\nenum bnxt_health_remedy {\n\tREMEDY_DEVLINK_RECOVER,\n\tREMEDY_POWER_CYCLE_DEVICE,\n\tREMEDY_POWER_CYCLE_HOST,\n\tREMEDY_FW_UPDATE,\n\tREMEDY_HW_REPLACE,\n};\n\nstruct bnxt_fw_health {\n\tu32 flags;\n\tu32 polling_dsecs;\n\tu32 master_func_wait_dsecs;\n\tu32 normal_func_wait_dsecs;\n\tu32 post_reset_wait_dsecs;\n\tu32 post_reset_max_wait_dsecs;\n\tu32 regs[4];\n\tu32 mapped_regs[4];\n#define BNXT_FW_HEALTH_REG\t\t0\n#define BNXT_FW_HEARTBEAT_REG\t\t1\n#define BNXT_FW_RESET_CNT_REG\t\t2\n#define BNXT_FW_RESET_INPROG_REG\t3\n\tu32 fw_reset_inprog_reg_mask;\n\tu32 last_fw_heartbeat;\n\tu32 last_fw_reset_cnt;\n\tu8 enabled:1;\n\tu8 primary:1;\n\tu8 status_reliable:1;\n\tu8 resets_reliable:1;\n\tu8 tmr_multiplier;\n\tu8 tmr_counter;\n\tu8 fw_reset_seq_cnt;\n\tu32 fw_reset_seq_regs[16];\n\tu32 fw_reset_seq_vals[16];\n\tu32 fw_reset_seq_delay_msec[16];\n\tu32 echo_req_data1;\n\tu32 echo_req_data2;\n\tstruct devlink_health_reporter\t*fw_reporter;\n\t \n\tstruct mutex lock;\n\tenum bnxt_health_severity severity;\n\tenum bnxt_health_remedy remedy;\n\tu32 arrests;\n\tu32 discoveries;\n\tu32 survivals;\n\tu32 fatalities;\n\tu32 diagnoses;\n};\n\n#define BNXT_FW_HEALTH_REG_TYPE_MASK\t3\n#define BNXT_FW_HEALTH_REG_TYPE_CFG\t0\n#define BNXT_FW_HEALTH_REG_TYPE_GRC\t1\n#define BNXT_FW_HEALTH_REG_TYPE_BAR0\t2\n#define BNXT_FW_HEALTH_REG_TYPE_BAR1\t3\n\n#define BNXT_FW_HEALTH_REG_TYPE(reg)\t((reg) & BNXT_FW_HEALTH_REG_TYPE_MASK)\n#define BNXT_FW_HEALTH_REG_OFF(reg)\t((reg) & ~BNXT_FW_HEALTH_REG_TYPE_MASK)\n\n#define BNXT_FW_HEALTH_WIN_BASE\t\t0x3000\n#define BNXT_FW_HEALTH_WIN_MAP_OFF\t8\n\n#define BNXT_FW_HEALTH_WIN_OFF(reg)\t(BNXT_FW_HEALTH_WIN_BASE +\t\\\n\t\t\t\t\t ((reg) & BNXT_GRC_OFFSET_MASK))\n\n#define BNXT_FW_STATUS_HEALTH_MSK\t0xffff\n#define BNXT_FW_STATUS_HEALTHY\t\t0x8000\n#define BNXT_FW_STATUS_SHUTDOWN\t\t0x100000\n#define BNXT_FW_STATUS_RECOVERING\t0x400000\n\n#define BNXT_FW_IS_HEALTHY(sts)\t\t(((sts) & BNXT_FW_STATUS_HEALTH_MSK) ==\\\n\t\t\t\t\t BNXT_FW_STATUS_HEALTHY)\n\n#define BNXT_FW_IS_BOOTING(sts)\t\t(((sts) & BNXT_FW_STATUS_HEALTH_MSK) < \\\n\t\t\t\t\t BNXT_FW_STATUS_HEALTHY)\n\n#define BNXT_FW_IS_ERR(sts)\t\t(((sts) & BNXT_FW_STATUS_HEALTH_MSK) > \\\n\t\t\t\t\t BNXT_FW_STATUS_HEALTHY)\n\n#define BNXT_FW_IS_RECOVERING(sts)\t(BNXT_FW_IS_ERR(sts) &&\t\t       \\\n\t\t\t\t\t ((sts) & BNXT_FW_STATUS_RECOVERING))\n\n#define BNXT_FW_RETRY\t\t\t5\n#define BNXT_FW_IF_RETRY\t\t10\n#define BNXT_FW_SLOT_RESET_RETRY\t4\n\nstruct bnxt_aux_priv {\n\tstruct auxiliary_device aux_dev;\n\tstruct bnxt_en_dev *edev;\n\tint id;\n};\n\nenum board_idx {\n\tBCM57301,\n\tBCM57302,\n\tBCM57304,\n\tBCM57417_NPAR,\n\tBCM58700,\n\tBCM57311,\n\tBCM57312,\n\tBCM57402,\n\tBCM57404,\n\tBCM57406,\n\tBCM57402_NPAR,\n\tBCM57407,\n\tBCM57412,\n\tBCM57414,\n\tBCM57416,\n\tBCM57417,\n\tBCM57412_NPAR,\n\tBCM57314,\n\tBCM57417_SFP,\n\tBCM57416_SFP,\n\tBCM57404_NPAR,\n\tBCM57406_NPAR,\n\tBCM57407_SFP,\n\tBCM57407_NPAR,\n\tBCM57414_NPAR,\n\tBCM57416_NPAR,\n\tBCM57452,\n\tBCM57454,\n\tBCM5745x_NPAR,\n\tBCM57508,\n\tBCM57504,\n\tBCM57502,\n\tBCM57508_NPAR,\n\tBCM57504_NPAR,\n\tBCM57502_NPAR,\n\tBCM58802,\n\tBCM58804,\n\tBCM58808,\n\tNETXTREME_E_VF,\n\tNETXTREME_C_VF,\n\tNETXTREME_S_VF,\n\tNETXTREME_C_VF_HV,\n\tNETXTREME_E_VF_HV,\n\tNETXTREME_E_P5_VF,\n\tNETXTREME_E_P5_VF_HV,\n};\n\nstruct bnxt {\n\tvoid __iomem\t\t*bar0;\n\tvoid __iomem\t\t*bar1;\n\tvoid __iomem\t\t*bar2;\n\n\tu32\t\t\treg_base;\n\tu16\t\t\tchip_num;\n#define CHIP_NUM_57301\t\t0x16c8\n#define CHIP_NUM_57302\t\t0x16c9\n#define CHIP_NUM_57304\t\t0x16ca\n#define CHIP_NUM_58700\t\t0x16cd\n#define CHIP_NUM_57402\t\t0x16d0\n#define CHIP_NUM_57404\t\t0x16d1\n#define CHIP_NUM_57406\t\t0x16d2\n#define CHIP_NUM_57407\t\t0x16d5\n\n#define CHIP_NUM_57311\t\t0x16ce\n#define CHIP_NUM_57312\t\t0x16cf\n#define CHIP_NUM_57314\t\t0x16df\n#define CHIP_NUM_57317\t\t0x16e0\n#define CHIP_NUM_57412\t\t0x16d6\n#define CHIP_NUM_57414\t\t0x16d7\n#define CHIP_NUM_57416\t\t0x16d8\n#define CHIP_NUM_57417\t\t0x16d9\n#define CHIP_NUM_57412L\t\t0x16da\n#define CHIP_NUM_57414L\t\t0x16db\n\n#define CHIP_NUM_5745X\t\t0xd730\n#define CHIP_NUM_57452\t\t0xc452\n#define CHIP_NUM_57454\t\t0xc454\n\n#define CHIP_NUM_57508\t\t0x1750\n#define CHIP_NUM_57504\t\t0x1751\n#define CHIP_NUM_57502\t\t0x1752\n\n#define CHIP_NUM_58802\t\t0xd802\n#define CHIP_NUM_58804\t\t0xd804\n#define CHIP_NUM_58808\t\t0xd808\n\n\tu8\t\t\tchip_rev;\n\n#define CHIP_NUM_58818\t\t0xd818\n\n#define BNXT_CHIP_NUM_5730X(chip_num)\t\t\\\n\t((chip_num) >= CHIP_NUM_57301 &&\t\\\n\t (chip_num) <= CHIP_NUM_57304)\n\n#define BNXT_CHIP_NUM_5740X(chip_num)\t\t\\\n\t(((chip_num) >= CHIP_NUM_57402 &&\t\\\n\t  (chip_num) <= CHIP_NUM_57406) ||\t\\\n\t (chip_num) == CHIP_NUM_57407)\n\n#define BNXT_CHIP_NUM_5731X(chip_num)\t\t\\\n\t((chip_num) == CHIP_NUM_57311 ||\t\\\n\t (chip_num) == CHIP_NUM_57312 ||\t\\\n\t (chip_num) == CHIP_NUM_57314 ||\t\\\n\t (chip_num) == CHIP_NUM_57317)\n\n#define BNXT_CHIP_NUM_5741X(chip_num)\t\t\\\n\t((chip_num) >= CHIP_NUM_57412 &&\t\\\n\t (chip_num) <= CHIP_NUM_57414L)\n\n#define BNXT_CHIP_NUM_58700(chip_num)\t\t\\\n\t ((chip_num) == CHIP_NUM_58700)\n\n#define BNXT_CHIP_NUM_5745X(chip_num)\t\t\\\n\t((chip_num) == CHIP_NUM_5745X ||\t\\\n\t (chip_num) == CHIP_NUM_57452 ||\t\\\n\t (chip_num) == CHIP_NUM_57454)\n\n\n#define BNXT_CHIP_NUM_57X0X(chip_num)\t\t\\\n\t(BNXT_CHIP_NUM_5730X(chip_num) || BNXT_CHIP_NUM_5740X(chip_num))\n\n#define BNXT_CHIP_NUM_57X1X(chip_num)\t\t\\\n\t(BNXT_CHIP_NUM_5731X(chip_num) || BNXT_CHIP_NUM_5741X(chip_num))\n\n#define BNXT_CHIP_NUM_588XX(chip_num)\t\t\\\n\t((chip_num) == CHIP_NUM_58802 ||\t\\\n\t (chip_num) == CHIP_NUM_58804 ||        \\\n\t (chip_num) == CHIP_NUM_58808)\n\n#define BNXT_VPD_FLD_LEN\t32\n\tchar\t\t\tboard_partno[BNXT_VPD_FLD_LEN];\n\tchar\t\t\tboard_serialno[BNXT_VPD_FLD_LEN];\n\n\tstruct net_device\t*dev;\n\tstruct pci_dev\t\t*pdev;\n\n\tatomic_t\t\tintr_sem;\n\n\tu32\t\t\tflags;\n\t#define BNXT_FLAG_CHIP_P5\t0x1\n\t#define BNXT_FLAG_VF\t\t0x2\n\t#define BNXT_FLAG_LRO\t\t0x4\n#ifdef CONFIG_INET\n\t#define BNXT_FLAG_GRO\t\t0x8\n#else\n\t \n\t#define BNXT_FLAG_GRO\t\t0x0\n#endif\n\t#define BNXT_FLAG_TPA\t\t(BNXT_FLAG_LRO | BNXT_FLAG_GRO)\n\t#define BNXT_FLAG_JUMBO\t\t0x10\n\t#define BNXT_FLAG_STRIP_VLAN\t0x20\n\t#define BNXT_FLAG_AGG_RINGS\t(BNXT_FLAG_JUMBO | BNXT_FLAG_GRO | \\\n\t\t\t\t\t BNXT_FLAG_LRO)\n\t#define BNXT_FLAG_USING_MSIX\t0x40\n\t#define BNXT_FLAG_MSIX_CAP\t0x80\n\t#define BNXT_FLAG_RFS\t\t0x100\n\t#define BNXT_FLAG_SHARED_RINGS\t0x200\n\t#define BNXT_FLAG_PORT_STATS\t0x400\n\t#define BNXT_FLAG_UDP_RSS_CAP\t0x800\n\t#define BNXT_FLAG_NEW_RSS_CAP\t0x2000\n\t#define BNXT_FLAG_WOL_CAP\t0x4000\n\t#define BNXT_FLAG_ROCEV1_CAP\t0x8000\n\t#define BNXT_FLAG_ROCEV2_CAP\t0x10000\n\t#define BNXT_FLAG_ROCE_CAP\t(BNXT_FLAG_ROCEV1_CAP |\t\\\n\t\t\t\t\t BNXT_FLAG_ROCEV2_CAP)\n\t#define BNXT_FLAG_NO_AGG_RINGS\t0x20000\n\t#define BNXT_FLAG_RX_PAGE_MODE\t0x40000\n\t#define BNXT_FLAG_CHIP_SR2\t0x80000\n\t#define BNXT_FLAG_MULTI_HOST\t0x100000\n\t#define BNXT_FLAG_DSN_VALID\t0x200000\n\t#define BNXT_FLAG_DOUBLE_DB\t0x400000\n\t#define BNXT_FLAG_CHIP_NITRO_A0\t0x1000000\n\t#define BNXT_FLAG_DIM\t\t0x2000000\n\t#define BNXT_FLAG_ROCE_MIRROR_CAP\t0x4000000\n\t#define BNXT_FLAG_PORT_STATS_EXT\t0x10000000\n\n\t#define BNXT_FLAG_ALL_CONFIG_FEATS (BNXT_FLAG_TPA |\t\t\\\n\t\t\t\t\t    BNXT_FLAG_RFS |\t\t\\\n\t\t\t\t\t    BNXT_FLAG_STRIP_VLAN)\n\n#define BNXT_PF(bp)\t\t(!((bp)->flags & BNXT_FLAG_VF))\n#define BNXT_VF(bp)\t\t((bp)->flags & BNXT_FLAG_VF)\n#define BNXT_NPAR(bp)\t\t((bp)->port_partition_type)\n#define BNXT_MH(bp)\t\t((bp)->flags & BNXT_FLAG_MULTI_HOST)\n#define BNXT_SINGLE_PF(bp)\t(BNXT_PF(bp) && !BNXT_NPAR(bp) && !BNXT_MH(bp))\n#define BNXT_SH_PORT_CFG_OK(bp)\t(BNXT_PF(bp) &&\t\t\t\t\\\n\t\t\t\t ((bp)->phy_flags & BNXT_PHY_FL_SHARED_PORT_CFG))\n#define BNXT_PHY_CFG_ABLE(bp)\t((BNXT_SINGLE_PF(bp) ||\t\t\t\\\n\t\t\t\t  BNXT_SH_PORT_CFG_OK(bp)) &&\t\t\\\n\t\t\t\t (bp)->link_info.phy_state == BNXT_PHY_STATE_ENABLED)\n#define BNXT_CHIP_TYPE_NITRO_A0(bp) ((bp)->flags & BNXT_FLAG_CHIP_NITRO_A0)\n#define BNXT_RX_PAGE_MODE(bp)\t((bp)->flags & BNXT_FLAG_RX_PAGE_MODE)\n#define BNXT_SUPPORTS_TPA(bp)\t(!BNXT_CHIP_TYPE_NITRO_A0(bp) &&\t\\\n\t\t\t\t (!((bp)->flags & BNXT_FLAG_CHIP_P5) ||\t\\\n\t\t\t\t  (bp)->max_tpa_v2) && !is_kdump_kernel())\n#define BNXT_RX_JUMBO_MODE(bp)\t((bp)->flags & BNXT_FLAG_JUMBO)\n\n#define BNXT_CHIP_SR2(bp)\t\t\t\\\n\t((bp)->chip_num == CHIP_NUM_58818)\n\n#define BNXT_CHIP_P5_THOR(bp)\t\t\t\\\n\t((bp)->chip_num == CHIP_NUM_57508 ||\t\\\n\t (bp)->chip_num == CHIP_NUM_57504 ||\t\\\n\t (bp)->chip_num == CHIP_NUM_57502)\n\n \n#define BNXT_CHIP_P5(bp)\t\t\t\\\n\t(BNXT_CHIP_P5_THOR(bp) || BNXT_CHIP_SR2(bp))\n\n \n#define BNXT_CHIP_P4(bp)\t\t\t\\\n\t(BNXT_CHIP_NUM_57X1X((bp)->chip_num) ||\t\\\n\t BNXT_CHIP_NUM_5745X((bp)->chip_num) ||\t\\\n\t BNXT_CHIP_NUM_588XX((bp)->chip_num) ||\t\\\n\t (BNXT_CHIP_NUM_58700((bp)->chip_num) &&\t\\\n\t  !BNXT_CHIP_TYPE_NITRO_A0(bp)))\n\n#define BNXT_CHIP_P4_PLUS(bp)\t\t\t\\\n\t(BNXT_CHIP_P4(bp) || BNXT_CHIP_P5(bp))\n\n\tstruct bnxt_aux_priv\t*aux_priv;\n\tstruct bnxt_en_dev\t*edev;\n\n\tstruct bnxt_napi\t**bnapi;\n\n\tstruct bnxt_rx_ring_info\t*rx_ring;\n\tstruct bnxt_tx_ring_info\t*tx_ring;\n\tu16\t\t\t*tx_ring_map;\n\n\tstruct sk_buff *\t(*gro_func)(struct bnxt_tpa_info *, int, int,\n\t\t\t\t\t    struct sk_buff *);\n\n\tstruct sk_buff *\t(*rx_skb_func)(struct bnxt *,\n\t\t\t\t\t       struct bnxt_rx_ring_info *,\n\t\t\t\t\t       u16, void *, u8 *, dma_addr_t,\n\t\t\t\t\t       unsigned int);\n\n\tu16\t\t\tmax_tpa_v2;\n\tu16\t\t\tmax_tpa;\n\tu32\t\t\trx_buf_size;\n\tu32\t\t\trx_buf_use_size;\t \n\tu16\t\t\trx_offset;\n\tu16\t\t\trx_dma_offset;\n\tenum dma_data_direction\trx_dir;\n\tu32\t\t\trx_ring_size;\n\tu32\t\t\trx_agg_ring_size;\n\tu32\t\t\trx_copy_thresh;\n\tu32\t\t\trx_ring_mask;\n\tu32\t\t\trx_agg_ring_mask;\n\tint\t\t\trx_nr_pages;\n\tint\t\t\trx_agg_nr_pages;\n\tint\t\t\trx_nr_rings;\n\tint\t\t\trsscos_nr_ctxs;\n\n\tu32\t\t\ttx_ring_size;\n\tu32\t\t\ttx_ring_mask;\n\tint\t\t\ttx_nr_pages;\n\tint\t\t\ttx_nr_rings;\n\tint\t\t\ttx_nr_rings_per_tc;\n\tint\t\t\ttx_nr_rings_xdp;\n\n\tint\t\t\ttx_wake_thresh;\n\tint\t\t\ttx_push_thresh;\n\tint\t\t\ttx_push_size;\n\n\tu32\t\t\tcp_ring_size;\n\tu32\t\t\tcp_ring_mask;\n\tu32\t\t\tcp_bit;\n\tint\t\t\tcp_nr_pages;\n\tint\t\t\tcp_nr_rings;\n\n\t \n\tstruct bnxt_ring_grp_info\t*grp_info;\n\tstruct bnxt_vnic_info\t*vnic_info;\n\tint\t\t\tnr_vnics;\n\tu16\t\t\t*rss_indir_tbl;\n\tu16\t\t\trss_indir_tbl_entries;\n\tu32\t\t\trss_hash_cfg;\n\tu32\t\t\trss_hash_delta;\n\n\tu16\t\t\tmax_mtu;\n\tu8\t\t\tmax_tc;\n\tu8\t\t\tmax_lltc;\t \n\tstruct bnxt_queue_info\tq_info[BNXT_MAX_QUEUE];\n\tu8\t\t\ttc_to_qidx[BNXT_MAX_QUEUE];\n\tu8\t\t\tq_ids[BNXT_MAX_QUEUE];\n\tu8\t\t\tmax_q;\n\n\tunsigned int\t\tcurrent_interval;\n#define BNXT_TIMER_INTERVAL\tHZ\n\n\tstruct timer_list\ttimer;\n\n\tunsigned long\t\tstate;\n#define BNXT_STATE_OPEN\t\t0\n#define BNXT_STATE_IN_SP_TASK\t1\n#define BNXT_STATE_READ_STATS\t2\n#define BNXT_STATE_FW_RESET_DET 3\n#define BNXT_STATE_IN_FW_RESET\t4\n#define BNXT_STATE_ABORT_ERR\t5\n#define BNXT_STATE_FW_FATAL_COND\t6\n#define BNXT_STATE_DRV_REGISTERED\t7\n#define BNXT_STATE_PCI_CHANNEL_IO_FROZEN\t8\n#define BNXT_STATE_NAPI_DISABLED\t9\n#define BNXT_STATE_L2_FILTER_RETRY\t10\n#define BNXT_STATE_FW_ACTIVATE\t\t11\n#define BNXT_STATE_RECOVER\t\t12\n#define BNXT_STATE_FW_NON_FATAL_COND\t13\n#define BNXT_STATE_FW_ACTIVATE_RESET\t14\n#define BNXT_STATE_HALF_OPEN\t\t15\t \n\n#define BNXT_NO_FW_ACCESS(bp)\t\t\t\t\t\\\n\t(test_bit(BNXT_STATE_FW_FATAL_COND, &(bp)->state) ||\t\\\n\t pci_channel_offline((bp)->pdev))\n\n\tstruct bnxt_irq\t*irq_tbl;\n\tint\t\t\ttotal_irqs;\n\tu8\t\t\tmac_addr[ETH_ALEN];\n\n#ifdef CONFIG_BNXT_DCB\n\tstruct ieee_pfc\t\t*ieee_pfc;\n\tstruct ieee_ets\t\t*ieee_ets;\n\tu8\t\t\tdcbx_cap;\n\tu8\t\t\tdefault_pri;\n\tu8\t\t\tmax_dscp_value;\n#endif  \n\n\tu32\t\t\tmsg_enable;\n\n\tu64\t\t\tfw_cap;\n\t#define BNXT_FW_CAP_SHORT_CMD\t\t\tBIT_ULL(0)\n\t#define BNXT_FW_CAP_LLDP_AGENT\t\t\tBIT_ULL(1)\n\t#define BNXT_FW_CAP_DCBX_AGENT\t\t\tBIT_ULL(2)\n\t#define BNXT_FW_CAP_NEW_RM\t\t\tBIT_ULL(3)\n\t#define BNXT_FW_CAP_IF_CHANGE\t\t\tBIT_ULL(4)\n\t#define BNXT_FW_CAP_KONG_MB_CHNL\t\tBIT_ULL(7)\n\t#define BNXT_FW_CAP_OVS_64BIT_HANDLE\t\tBIT_ULL(10)\n\t#define BNXT_FW_CAP_TRUSTED_VF\t\t\tBIT_ULL(11)\n\t#define BNXT_FW_CAP_ERROR_RECOVERY\t\tBIT_ULL(13)\n\t#define BNXT_FW_CAP_PKG_VER\t\t\tBIT_ULL(14)\n\t#define BNXT_FW_CAP_CFA_ADV_FLOW\t\tBIT_ULL(15)\n\t#define BNXT_FW_CAP_CFA_RFS_RING_TBL_IDX_V2\tBIT_ULL(16)\n\t#define BNXT_FW_CAP_PCIE_STATS_SUPPORTED\tBIT_ULL(17)\n\t#define BNXT_FW_CAP_EXT_STATS_SUPPORTED\t\tBIT_ULL(18)\n\t#define BNXT_FW_CAP_RSS_HASH_TYPE_DELTA\t\tBIT_ULL(19)\n\t#define BNXT_FW_CAP_ERR_RECOVER_RELOAD\t\tBIT_ULL(20)\n\t#define BNXT_FW_CAP_HOT_RESET\t\t\tBIT_ULL(21)\n\t#define BNXT_FW_CAP_PTP_RTC\t\t\tBIT_ULL(22)\n\t#define BNXT_FW_CAP_RX_ALL_PKT_TS\t\tBIT_ULL(23)\n\t#define BNXT_FW_CAP_VLAN_RX_STRIP\t\tBIT_ULL(24)\n\t#define BNXT_FW_CAP_VLAN_TX_INSERT\t\tBIT_ULL(25)\n\t#define BNXT_FW_CAP_EXT_HW_STATS_SUPPORTED\tBIT_ULL(26)\n\t#define BNXT_FW_CAP_LIVEPATCH\t\t\tBIT_ULL(27)\n\t#define BNXT_FW_CAP_PTP_PPS\t\t\tBIT_ULL(28)\n\t#define BNXT_FW_CAP_HOT_RESET_IF\t\tBIT_ULL(29)\n\t#define BNXT_FW_CAP_RING_MONITOR\t\tBIT_ULL(30)\n\t#define BNXT_FW_CAP_DBG_QCAPS\t\t\tBIT_ULL(31)\n\t#define BNXT_FW_CAP_PTP\t\t\t\tBIT_ULL(32)\n\n\tu32\t\t\tfw_dbg_cap;\n\n#define BNXT_NEW_RM(bp)\t\t((bp)->fw_cap & BNXT_FW_CAP_NEW_RM)\n#define BNXT_PTP_USE_RTC(bp)\t(!BNXT_MH(bp) && \\\n\t\t\t\t ((bp)->fw_cap & BNXT_FW_CAP_PTP_RTC))\n\tu32\t\t\thwrm_spec_code;\n\tu16\t\t\thwrm_cmd_seq;\n\tu16                     hwrm_cmd_kong_seq;\n\tstruct dma_pool\t\t*hwrm_dma_pool;\n\tstruct hlist_head\thwrm_pending_list;\n\n\tstruct rtnl_link_stats64\tnet_stats_prev;\n\tstruct bnxt_stats_mem\tport_stats;\n\tstruct bnxt_stats_mem\trx_port_stats_ext;\n\tstruct bnxt_stats_mem\ttx_port_stats_ext;\n\tu16\t\t\tfw_rx_stats_ext_size;\n\tu16\t\t\tfw_tx_stats_ext_size;\n\tu16\t\t\thw_ring_stats_size;\n\tu8\t\t\tpri2cos_idx[8];\n\tu8\t\t\tpri2cos_valid;\n\n\tstruct bnxt_total_ring_err_stats ring_err_stats_prev;\n\n\tu16\t\t\thwrm_max_req_len;\n\tu16\t\t\thwrm_max_ext_req_len;\n\tunsigned int\t\thwrm_cmd_timeout;\n\tunsigned int\t\thwrm_cmd_max_timeout;\n\tstruct mutex\t\thwrm_cmd_lock;\t \n\tstruct hwrm_ver_get_output\tver_resp;\n#define FW_VER_STR_LEN\t\t32\n#define BC_HWRM_STR_LEN\t\t21\n#define PHY_VER_STR_LEN         (FW_VER_STR_LEN - BC_HWRM_STR_LEN)\n\tchar\t\t\tfw_ver_str[FW_VER_STR_LEN];\n\tchar\t\t\thwrm_ver_supp[FW_VER_STR_LEN];\n\tchar\t\t\tnvm_cfg_ver[FW_VER_STR_LEN];\n\tu64\t\t\tfw_ver_code;\n#define BNXT_FW_VER_CODE(maj, min, bld, rsv)\t\t\t\\\n\t((u64)(maj) << 48 | (u64)(min) << 32 | (u64)(bld) << 16 | (rsv))\n#define BNXT_FW_MAJ(bp)\t\t((bp)->fw_ver_code >> 48)\n\n\tu16\t\t\tvxlan_fw_dst_port_id;\n\tu16\t\t\tnge_fw_dst_port_id;\n\t__be16\t\t\tvxlan_port;\n\t__be16\t\t\tnge_port;\n\tu8\t\t\tport_partition_type;\n\tu8\t\t\tport_count;\n\tu16\t\t\tbr_mode;\n\n\tstruct bnxt_coal_cap\tcoal_cap;\n\tstruct bnxt_coal\trx_coal;\n\tstruct bnxt_coal\ttx_coal;\n\n\tu32\t\t\tstats_coal_ticks;\n#define BNXT_DEF_STATS_COAL_TICKS\t 1000000\n#define BNXT_MIN_STATS_COAL_TICKS\t  250000\n#define BNXT_MAX_STATS_COAL_TICKS\t 1000000\n\n\tstruct work_struct\tsp_task;\n\tunsigned long\t\tsp_event;\n#define BNXT_RX_MASK_SP_EVENT\t\t0\n#define BNXT_RX_NTP_FLTR_SP_EVENT\t1\n#define BNXT_LINK_CHNG_SP_EVENT\t\t2\n#define BNXT_HWRM_EXEC_FWD_REQ_SP_EVENT\t3\n#define BNXT_RESET_TASK_SP_EVENT\t6\n#define BNXT_RST_RING_SP_EVENT\t\t7\n#define BNXT_HWRM_PF_UNLOAD_SP_EVENT\t8\n#define BNXT_PERIODIC_STATS_SP_EVENT\t9\n#define BNXT_HWRM_PORT_MODULE_SP_EVENT\t10\n#define BNXT_RESET_TASK_SILENT_SP_EVENT\t11\n#define BNXT_LINK_SPEED_CHNG_SP_EVENT\t14\n#define BNXT_FLOW_STATS_SP_EVENT\t15\n#define BNXT_UPDATE_PHY_SP_EVENT\t16\n#define BNXT_RING_COAL_NOW_SP_EVENT\t17\n#define BNXT_FW_RESET_NOTIFY_SP_EVENT\t18\n#define BNXT_FW_EXCEPTION_SP_EVENT\t19\n#define BNXT_LINK_CFG_CHANGE_SP_EVENT\t21\n#define BNXT_FW_ECHO_REQUEST_SP_EVENT\t23\n\n\tstruct delayed_work\tfw_reset_task;\n\tint\t\t\tfw_reset_state;\n#define BNXT_FW_RESET_STATE_POLL_VF\t1\n#define BNXT_FW_RESET_STATE_RESET_FW\t2\n#define BNXT_FW_RESET_STATE_ENABLE_DEV\t3\n#define BNXT_FW_RESET_STATE_POLL_FW\t4\n#define BNXT_FW_RESET_STATE_OPENING\t5\n#define BNXT_FW_RESET_STATE_POLL_FW_DOWN\t6\n\n\tu16\t\t\tfw_reset_min_dsecs;\n#define BNXT_DFLT_FW_RST_MIN_DSECS\t20\n\tu16\t\t\tfw_reset_max_dsecs;\n#define BNXT_DFLT_FW_RST_MAX_DSECS\t60\n\tunsigned long\t\tfw_reset_timestamp;\n\n\tstruct bnxt_fw_health\t*fw_health;\n\n\tstruct bnxt_hw_resc\thw_resc;\n\tstruct bnxt_pf_info\tpf;\n\tstruct bnxt_ctx_mem_info\t*ctx;\n#ifdef CONFIG_BNXT_SRIOV\n\tint\t\t\tnr_vfs;\n\tstruct bnxt_vf_info\tvf;\n\twait_queue_head_t\tsriov_cfg_wait;\n\tbool\t\t\tsriov_cfg;\n#define BNXT_SRIOV_CFG_WAIT_TMO\tmsecs_to_jiffies(10000)\n#endif\n\n#if BITS_PER_LONG == 32\n\t \n\tspinlock_t\t\tdb_lock;\n#endif\n\tint\t\t\tdb_size;\n\n#define BNXT_NTP_FLTR_MAX_FLTR\t4096\n#define BNXT_NTP_FLTR_HASH_SIZE\t512\n#define BNXT_NTP_FLTR_HASH_MASK\t(BNXT_NTP_FLTR_HASH_SIZE - 1)\n\tstruct hlist_head\tntp_fltr_hash_tbl[BNXT_NTP_FLTR_HASH_SIZE];\n\tspinlock_t\t\tntp_fltr_lock;\t \n\n\tunsigned long\t\t*ntp_fltr_bmap;\n\tint\t\t\tntp_fltr_count;\n\n\t \n\tstruct mutex\t\tlink_lock;\n\tstruct bnxt_link_info\tlink_info;\n\tstruct ethtool_eee\teee;\n\tu32\t\t\tlpi_tmr_lo;\n\tu32\t\t\tlpi_tmr_hi;\n\n\t \n\tu32\t\t\tphy_flags;\n#define BNXT_PHY_FL_EEE_CAP\t\tPORT_PHY_QCAPS_RESP_FLAGS_EEE_SUPPORTED\n#define BNXT_PHY_FL_EXT_LPBK\t\tPORT_PHY_QCAPS_RESP_FLAGS_EXTERNAL_LPBK_SUPPORTED\n#define BNXT_PHY_FL_AN_PHY_LPBK\t\tPORT_PHY_QCAPS_RESP_FLAGS_AUTONEG_LPBK_SUPPORTED\n#define BNXT_PHY_FL_SHARED_PORT_CFG\tPORT_PHY_QCAPS_RESP_FLAGS_SHARED_PHY_CFG_SUPPORTED\n#define BNXT_PHY_FL_PORT_STATS_NO_RESET\tPORT_PHY_QCAPS_RESP_FLAGS_CUMULATIVE_COUNTERS_ON_RESET\n#define BNXT_PHY_FL_NO_PHY_LPBK\t\tPORT_PHY_QCAPS_RESP_FLAGS_LOCAL_LPBK_NOT_SUPPORTED\n#define BNXT_PHY_FL_FW_MANAGED_LKDN\tPORT_PHY_QCAPS_RESP_FLAGS_FW_MANAGED_LINK_DOWN\n#define BNXT_PHY_FL_NO_FCS\t\tPORT_PHY_QCAPS_RESP_FLAGS_NO_FCS\n#define BNXT_PHY_FL_NO_PAUSE\t\t(PORT_PHY_QCAPS_RESP_FLAGS2_PAUSE_UNSUPPORTED << 8)\n#define BNXT_PHY_FL_NO_PFC\t\t(PORT_PHY_QCAPS_RESP_FLAGS2_PFC_UNSUPPORTED << 8)\n#define BNXT_PHY_FL_BANK_SEL\t\t(PORT_PHY_QCAPS_RESP_FLAGS2_BANK_ADDR_SUPPORTED << 8)\n\n\tu8\t\t\tnum_tests;\n\tstruct bnxt_test_info\t*test_info;\n\n\tu8\t\t\twol_filter_id;\n\tu8\t\t\twol;\n\n\tu8\t\t\tnum_leds;\n\tstruct bnxt_led_info\tleds[BNXT_MAX_LED];\n\tu16\t\t\tdump_flag;\n#define BNXT_DUMP_LIVE\t\t0\n#define BNXT_DUMP_CRASH\t\t1\n\n\tstruct bpf_prog\t\t*xdp_prog;\n\n\tstruct bnxt_ptp_cfg\t*ptp_cfg;\n\tu8\t\t\tptp_all_rx_tstamp;\n\n\t \n\tstruct devlink\t\t*dl;\n\tstruct devlink_port\tdl_port;\n\tenum devlink_eswitch_mode eswitch_mode;\n\tstruct bnxt_vf_rep\t**vf_reps;  \n\tu16\t\t\t*cfa_code_map;  \n\tu8\t\t\tdsn[8];\n\tstruct bnxt_tc_info\t*tc_info;\n\tstruct list_head\ttc_indr_block_list;\n\tstruct dentry\t\t*debugfs_pdev;\n\tstruct device\t\t*hwmon_dev;\n\tenum board_idx\t\tboard_idx;\n};\n\n#define BNXT_NUM_RX_RING_STATS\t\t\t8\n#define BNXT_NUM_TX_RING_STATS\t\t\t8\n#define BNXT_NUM_TPA_RING_STATS\t\t\t4\n#define BNXT_NUM_TPA_RING_STATS_P5\t\t5\n#define BNXT_NUM_TPA_RING_STATS_P5_SR2\t\t6\n\n#define BNXT_RING_STATS_SIZE_P5\t\t\t\t\t\\\n\t((BNXT_NUM_RX_RING_STATS + BNXT_NUM_TX_RING_STATS +\t\\\n\t  BNXT_NUM_TPA_RING_STATS_P5) * 8)\n\n#define BNXT_RING_STATS_SIZE_P5_SR2\t\t\t\t\\\n\t((BNXT_NUM_RX_RING_STATS + BNXT_NUM_TX_RING_STATS +\t\\\n\t  BNXT_NUM_TPA_RING_STATS_P5_SR2) * 8)\n\n#define BNXT_GET_RING_STATS64(sw, counter)\t\t\\\n\t(*((sw) + offsetof(struct ctx_hw_stats, counter) / 8))\n\n#define BNXT_GET_RX_PORT_STATS64(sw, counter)\t\t\\\n\t(*((sw) + offsetof(struct rx_port_stats, counter) / 8))\n\n#define BNXT_GET_TX_PORT_STATS64(sw, counter)\t\t\\\n\t(*((sw) + offsetof(struct tx_port_stats, counter) / 8))\n\n#define BNXT_PORT_STATS_SIZE\t\t\t\t\\\n\t(sizeof(struct rx_port_stats) + sizeof(struct tx_port_stats) + 1024)\n\n#define BNXT_TX_PORT_STATS_BYTE_OFFSET\t\t\t\\\n\t(sizeof(struct rx_port_stats) + 512)\n\n#define BNXT_RX_STATS_OFFSET(counter)\t\t\t\\\n\t(offsetof(struct rx_port_stats, counter) / 8)\n\n#define BNXT_TX_STATS_OFFSET(counter)\t\t\t\\\n\t((offsetof(struct tx_port_stats, counter) +\t\\\n\t  BNXT_TX_PORT_STATS_BYTE_OFFSET) / 8)\n\n#define BNXT_RX_STATS_EXT_OFFSET(counter)\t\t\\\n\t(offsetof(struct rx_port_stats_ext, counter) / 8)\n\n#define BNXT_RX_STATS_EXT_NUM_LEGACY                   \\\n\tBNXT_RX_STATS_EXT_OFFSET(rx_fec_corrected_blocks)\n\n#define BNXT_TX_STATS_EXT_OFFSET(counter)\t\t\\\n\t(offsetof(struct tx_port_stats_ext, counter) / 8)\n\n#define BNXT_HW_FEATURE_VLAN_ALL_RX\t\t\t\t\\\n\t(NETIF_F_HW_VLAN_CTAG_RX | NETIF_F_HW_VLAN_STAG_RX)\n#define BNXT_HW_FEATURE_VLAN_ALL_TX\t\t\t\t\\\n\t(NETIF_F_HW_VLAN_CTAG_TX | NETIF_F_HW_VLAN_STAG_TX)\n\n#define I2C_DEV_ADDR_A0\t\t\t\t0xa0\n#define I2C_DEV_ADDR_A2\t\t\t\t0xa2\n#define SFF_DIAG_SUPPORT_OFFSET\t\t\t0x5c\n#define SFF_MODULE_ID_SFP\t\t\t0x3\n#define SFF_MODULE_ID_QSFP\t\t\t0xc\n#define SFF_MODULE_ID_QSFP_PLUS\t\t\t0xd\n#define SFF_MODULE_ID_QSFP28\t\t\t0x11\n#define BNXT_MAX_PHY_I2C_RESP_SIZE\t\t64\n\nstatic inline u32 bnxt_tx_avail(struct bnxt *bp,\n\t\t\t\tconst struct bnxt_tx_ring_info *txr)\n{\n\tu32 used = READ_ONCE(txr->tx_prod) - READ_ONCE(txr->tx_cons);\n\n\treturn bp->tx_ring_size - (used & bp->tx_ring_mask);\n}\n\nstatic inline void bnxt_writeq(struct bnxt *bp, u64 val,\n\t\t\t       volatile void __iomem *addr)\n{\n#if BITS_PER_LONG == 32\n\tspin_lock(&bp->db_lock);\n\tlo_hi_writeq(val, addr);\n\tspin_unlock(&bp->db_lock);\n#else\n\twriteq(val, addr);\n#endif\n}\n\nstatic inline void bnxt_writeq_relaxed(struct bnxt *bp, u64 val,\n\t\t\t\t       volatile void __iomem *addr)\n{\n#if BITS_PER_LONG == 32\n\tspin_lock(&bp->db_lock);\n\tlo_hi_writeq_relaxed(val, addr);\n\tspin_unlock(&bp->db_lock);\n#else\n\twriteq_relaxed(val, addr);\n#endif\n}\n\n \nstatic inline void bnxt_db_write_relaxed(struct bnxt *bp,\n\t\t\t\t\t struct bnxt_db_info *db, u32 idx)\n{\n\tif (bp->flags & BNXT_FLAG_CHIP_P5) {\n\t\tbnxt_writeq_relaxed(bp, db->db_key64 | idx, db->doorbell);\n\t} else {\n\t\tu32 db_val = db->db_key32 | idx;\n\n\t\twritel_relaxed(db_val, db->doorbell);\n\t\tif (bp->flags & BNXT_FLAG_DOUBLE_DB)\n\t\t\twritel_relaxed(db_val, db->doorbell);\n\t}\n}\n\n \nstatic inline void bnxt_db_write(struct bnxt *bp, struct bnxt_db_info *db,\n\t\t\t\t u32 idx)\n{\n\tif (bp->flags & BNXT_FLAG_CHIP_P5) {\n\t\tbnxt_writeq(bp, db->db_key64 | idx, db->doorbell);\n\t} else {\n\t\tu32 db_val = db->db_key32 | idx;\n\n\t\twritel(db_val, db->doorbell);\n\t\tif (bp->flags & BNXT_FLAG_DOUBLE_DB)\n\t\t\twritel(db_val, db->doorbell);\n\t}\n}\n\n \nstatic inline bool bnxt_sriov_cfg(struct bnxt *bp)\n{\n#if defined(CONFIG_BNXT_SRIOV)\n\treturn BNXT_PF(bp) && (bp->pf.active_vfs || bp->sriov_cfg);\n#else\n\treturn false;\n#endif\n}\n\nextern const u16 bnxt_lhint_arr[];\n\nint bnxt_alloc_rx_data(struct bnxt *bp, struct bnxt_rx_ring_info *rxr,\n\t\t       u16 prod, gfp_t gfp);\nvoid bnxt_reuse_rx_data(struct bnxt_rx_ring_info *rxr, u16 cons, void *data);\nu32 bnxt_fw_health_readl(struct bnxt *bp, int reg_idx);\nvoid bnxt_set_tpa_flags(struct bnxt *bp);\nvoid bnxt_set_ring_params(struct bnxt *);\nint bnxt_set_rx_skb_mode(struct bnxt *bp, bool page_mode);\nint bnxt_hwrm_func_drv_rgtr(struct bnxt *bp, unsigned long *bmap,\n\t\t\t    int bmap_size, bool async_only);\nint bnxt_hwrm_func_drv_unrgtr(struct bnxt *bp);\nint bnxt_get_nr_rss_ctxs(struct bnxt *bp, int rx_rings);\nint bnxt_hwrm_vnic_cfg(struct bnxt *bp, u16 vnic_id);\nint __bnxt_hwrm_get_tx_rings(struct bnxt *bp, u16 fid, int *tx_rings);\nint bnxt_nq_rings_in_use(struct bnxt *bp);\nint bnxt_hwrm_set_coal(struct bnxt *);\nvoid bnxt_free_ctx_mem(struct bnxt *bp);\nunsigned int bnxt_get_max_func_stat_ctxs(struct bnxt *bp);\nunsigned int bnxt_get_avail_stat_ctxs_for_en(struct bnxt *bp);\nunsigned int bnxt_get_max_func_cp_rings(struct bnxt *bp);\nunsigned int bnxt_get_avail_cp_rings_for_en(struct bnxt *bp);\nint bnxt_get_avail_msix(struct bnxt *bp, int num);\nint bnxt_reserve_rings(struct bnxt *bp, bool irq_re_init);\nvoid bnxt_tx_disable(struct bnxt *bp);\nvoid bnxt_tx_enable(struct bnxt *bp);\nvoid bnxt_sched_reset_txr(struct bnxt *bp, struct bnxt_tx_ring_info *txr,\n\t\t\t  int idx);\nvoid bnxt_report_link(struct bnxt *bp);\nint bnxt_update_link(struct bnxt *bp, bool chng_link_state);\nint bnxt_hwrm_set_pause(struct bnxt *);\nint bnxt_hwrm_set_link_setting(struct bnxt *, bool, bool);\nint bnxt_cancel_reservations(struct bnxt *bp, bool fw_reset);\nint bnxt_hwrm_alloc_wol_fltr(struct bnxt *bp);\nint bnxt_hwrm_free_wol_fltr(struct bnxt *bp);\nint bnxt_hwrm_func_resc_qcaps(struct bnxt *bp, bool all);\nint bnxt_hwrm_func_qcaps(struct bnxt *bp);\nint bnxt_hwrm_fw_set_time(struct bnxt *);\nint bnxt_open_nic(struct bnxt *, bool, bool);\nint bnxt_half_open_nic(struct bnxt *bp);\nvoid bnxt_half_close_nic(struct bnxt *bp);\nvoid bnxt_reenable_sriov(struct bnxt *bp);\nvoid bnxt_close_nic(struct bnxt *, bool, bool);\nvoid bnxt_get_ring_err_stats(struct bnxt *bp,\n\t\t\t     struct bnxt_total_ring_err_stats *stats);\nint bnxt_dbg_hwrm_rd_reg(struct bnxt *bp, u32 reg_off, u16 num_words,\n\t\t\t u32 *reg_buf);\nvoid bnxt_fw_exception(struct bnxt *bp);\nvoid bnxt_fw_reset(struct bnxt *bp);\nint bnxt_check_rings(struct bnxt *bp, int tx, int rx, bool sh, int tcs,\n\t\t     int tx_xdp);\nint bnxt_fw_init_one(struct bnxt *bp);\nbool bnxt_hwrm_reset_permitted(struct bnxt *bp);\nint bnxt_setup_mq_tc(struct net_device *dev, u8 tc);\nint bnxt_get_max_rings(struct bnxt *, int *, int *, bool);\nint bnxt_restore_pf_fw_resources(struct bnxt *bp);\nint bnxt_get_port_parent_id(struct net_device *dev,\n\t\t\t    struct netdev_phys_item_id *ppid);\nvoid bnxt_dim_work(struct work_struct *work);\nint bnxt_hwrm_set_ring_coal(struct bnxt *bp, struct bnxt_napi *bnapi);\nvoid bnxt_print_device_info(struct bnxt *bp);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}