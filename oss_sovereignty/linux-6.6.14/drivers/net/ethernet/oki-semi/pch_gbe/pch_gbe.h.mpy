{
  "module_name": "pch_gbe.h",
  "hash_id": "98cd1618b2b5794aa244b6489873a9e1f652d1eb857a69d823a90a166b02669d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/oki-semi/pch_gbe/pch_gbe.h",
  "human_readable_source": " \n \n\n#ifndef _PCH_GBE_H_\n#define _PCH_GBE_H_\n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/mii.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/netdevice.h>\n#include <linux/etherdevice.h>\n#include <linux/ethtool.h>\n#include <linux/vmalloc.h>\n#include <net/ip.h>\n#include <net/tcp.h>\n#include <net/udp.h>\n\n \nstruct pch_gbe_regs_mac_adr {\n\tu32 high;\n\tu32 low;\n};\n \nstruct pch_gbe_regs {\n\tu32 INT_ST;\n\tu32 INT_EN;\n\tu32 MODE;\n\tu32 RESET;\n\tu32 TCPIP_ACC;\n\tu32 EX_LIST;\n\tu32 INT_ST_HOLD;\n\tu32 PHY_INT_CTRL;\n\tu32 MAC_RX_EN;\n\tu32 RX_FCTRL;\n\tu32 PAUSE_REQ;\n\tu32 RX_MODE;\n\tu32 TX_MODE;\n\tu32 RX_FIFO_ST;\n\tu32 TX_FIFO_ST;\n\tu32 TX_FID;\n\tu32 TX_RESULT;\n\tu32 PAUSE_PKT1;\n\tu32 PAUSE_PKT2;\n\tu32 PAUSE_PKT3;\n\tu32 PAUSE_PKT4;\n\tu32 PAUSE_PKT5;\n\tu32 reserve[2];\n\tstruct pch_gbe_regs_mac_adr mac_adr[16];\n\tu32 ADDR_MASK;\n\tu32 MIIM;\n\tu32 MAC_ADDR_LOAD;\n\tu32 RGMII_ST;\n\tu32 RGMII_CTRL;\n\tu32 reserve3[3];\n\tu32 DMA_CTRL;\n\tu32 reserve4[3];\n\tu32 RX_DSC_BASE;\n\tu32 RX_DSC_SIZE;\n\tu32 RX_DSC_HW_P;\n\tu32 RX_DSC_HW_P_HLD;\n\tu32 RX_DSC_SW_P;\n\tu32 reserve5[3];\n\tu32 TX_DSC_BASE;\n\tu32 TX_DSC_SIZE;\n\tu32 TX_DSC_HW_P;\n\tu32 TX_DSC_HW_P_HLD;\n\tu32 TX_DSC_SW_P;\n\tu32 reserve6[3];\n\tu32 RX_DMA_ST;\n\tu32 TX_DMA_ST;\n\tu32 reserve7[2];\n\tu32 WOL_ST;\n\tu32 WOL_CTRL;\n\tu32 WOL_ADDR_MASK;\n};\n\n \n \n \n#define PCH_GBE_INT_RX_DMA_CMPLT  0x00000001  \n#define PCH_GBE_INT_RX_VALID      0x00000002  \n#define PCH_GBE_INT_RX_FRAME_ERR  0x00000004  \n#define PCH_GBE_INT_RX_FIFO_ERR   0x00000008  \n#define PCH_GBE_INT_RX_DMA_ERR    0x00000010  \n#define PCH_GBE_INT_RX_DSC_EMP    0x00000020  \n#define PCH_GBE_INT_TX_CMPLT      0x00000100  \n#define PCH_GBE_INT_TX_DMA_CMPLT  0x00000200  \n#define PCH_GBE_INT_TX_FIFO_ERR   0x00000400  \n#define PCH_GBE_INT_TX_DMA_ERR    0x00000800  \n#define PCH_GBE_INT_PAUSE_CMPLT   0x00001000  \n#define PCH_GBE_INT_MIIM_CMPLT    0x00010000  \n#define PCH_GBE_INT_PHY_INT       0x00100000  \n#define PCH_GBE_INT_WOL_DET       0x01000000  \n#define PCH_GBE_INT_TCPIP_ERR     0x10000000  \n\n \n#define PCH_GBE_MODE_MII_ETHER      0x00000000   \n#define PCH_GBE_MODE_GMII_ETHER     0x80000000   \n#define PCH_GBE_MODE_HALF_DUPLEX    0x00000000   \n#define PCH_GBE_MODE_FULL_DUPLEX    0x40000000   \n#define PCH_GBE_MODE_FR_BST         0x04000000   \n\n \n#define PCH_GBE_ALL_RST         0x80000000   \n#define PCH_GBE_TX_RST          0x00008000   \n#define PCH_GBE_RX_RST          0x00004000   \n\n \n#define PCH_GBE_EX_LIST_EN      0x00000008   \n#define PCH_GBE_RX_TCPIPACC_OFF 0x00000004   \n#define PCH_GBE_TX_TCPIPACC_EN  0x00000002   \n#define PCH_GBE_RX_TCPIPACC_EN  0x00000001   \n\n \n#define PCH_GBE_MRE_MAC_RX_EN   0x00000001       \n\n \n#define PCH_GBE_FL_CTRL_EN      0x80000000   \n\n \n#define PCH_GBE_PS_PKT_RQ       0x80000000   \n\n \n#define PCH_GBE_ADD_FIL_EN      0x80000000   \n \n#define PCH_GBE_MLT_FIL_EN      0x40000000\n \n#define PCH_GBE_RH_ALM_EMP_4    0x00000000       \n#define PCH_GBE_RH_ALM_EMP_8    0x00004000       \n#define PCH_GBE_RH_ALM_EMP_16   0x00008000       \n#define PCH_GBE_RH_ALM_EMP_32   0x0000C000       \n \n#define PCH_GBE_RH_ALM_FULL_4   0x00000000       \n#define PCH_GBE_RH_ALM_FULL_8   0x00001000       \n#define PCH_GBE_RH_ALM_FULL_16  0x00002000       \n#define PCH_GBE_RH_ALM_FULL_32  0x00003000       \n \n#define PCH_GBE_RH_RD_TRG_4     0x00000000       \n#define PCH_GBE_RH_RD_TRG_8     0x00000200       \n#define PCH_GBE_RH_RD_TRG_16    0x00000400       \n#define PCH_GBE_RH_RD_TRG_32    0x00000600       \n#define PCH_GBE_RH_RD_TRG_64    0x00000800       \n#define PCH_GBE_RH_RD_TRG_128   0x00000A00       \n#define PCH_GBE_RH_RD_TRG_256   0x00000C00       \n#define PCH_GBE_RH_RD_TRG_512   0x00000E00       \n\n \n#define PCH_GBE_RXD_ACC_STAT_BCAST          0x00000400\n#define PCH_GBE_RXD_ACC_STAT_MCAST          0x00000200\n#define PCH_GBE_RXD_ACC_STAT_UCAST          0x00000100\n#define PCH_GBE_RXD_ACC_STAT_TCPIPOK        0x000000C0\n#define PCH_GBE_RXD_ACC_STAT_IPOK           0x00000080\n#define PCH_GBE_RXD_ACC_STAT_TCPOK          0x00000040\n#define PCH_GBE_RXD_ACC_STAT_IP6ERR         0x00000020\n#define PCH_GBE_RXD_ACC_STAT_OFLIST         0x00000010\n#define PCH_GBE_RXD_ACC_STAT_TYPEIP         0x00000008\n#define PCH_GBE_RXD_ACC_STAT_MACL           0x00000004\n#define PCH_GBE_RXD_ACC_STAT_PPPOE          0x00000002\n#define PCH_GBE_RXD_ACC_STAT_VTAGT          0x00000001\n#define PCH_GBE_RXD_GMAC_STAT_PAUSE         0x0200\n#define PCH_GBE_RXD_GMAC_STAT_MARBR         0x0100\n#define PCH_GBE_RXD_GMAC_STAT_MARMLT        0x0080\n#define PCH_GBE_RXD_GMAC_STAT_MARIND        0x0040\n#define PCH_GBE_RXD_GMAC_STAT_MARNOTMT      0x0020\n#define PCH_GBE_RXD_GMAC_STAT_TLONG         0x0010\n#define PCH_GBE_RXD_GMAC_STAT_TSHRT         0x0008\n#define PCH_GBE_RXD_GMAC_STAT_NOTOCTAL      0x0004\n#define PCH_GBE_RXD_GMAC_STAT_NBLERR        0x0002\n#define PCH_GBE_RXD_GMAC_STAT_CRCERR        0x0001\n\n \n#define PCH_GBE_TXD_CTRL_TCPIP_ACC_OFF      0x0008\n#define PCH_GBE_TXD_CTRL_ITAG               0x0004\n#define PCH_GBE_TXD_CTRL_ICRC               0x0002\n#define PCH_GBE_TXD_CTRL_APAD               0x0001\n#define PCH_GBE_TXD_WORDS_SHIFT             2\n#define PCH_GBE_TXD_GMAC_STAT_CMPLT         0x2000\n#define PCH_GBE_TXD_GMAC_STAT_ABT           0x1000\n#define PCH_GBE_TXD_GMAC_STAT_EXCOL         0x0800\n#define PCH_GBE_TXD_GMAC_STAT_SNGCOL        0x0400\n#define PCH_GBE_TXD_GMAC_STAT_MLTCOL        0x0200\n#define PCH_GBE_TXD_GMAC_STAT_CRSER         0x0100\n#define PCH_GBE_TXD_GMAC_STAT_TLNG          0x0080\n#define PCH_GBE_TXD_GMAC_STAT_TSHRT         0x0040\n#define PCH_GBE_TXD_GMAC_STAT_LTCOL         0x0020\n#define PCH_GBE_TXD_GMAC_STAT_TFUNDFLW      0x0010\n#define PCH_GBE_TXD_GMAC_STAT_RTYCNT_MASK   0x000F\n\n \n#define PCH_GBE_TM_NO_RTRY     0x80000000  \n#define PCH_GBE_TM_LONG_PKT    0x40000000  \n#define PCH_GBE_TM_ST_AND_FD   0x20000000  \n#define PCH_GBE_TM_SHORT_PKT   0x10000000  \n#define PCH_GBE_TM_LTCOL_RETX  0x08000000  \n \n#define PCH_GBE_TM_TH_TX_STRT_4    0x00000000     \n#define PCH_GBE_TM_TH_TX_STRT_8    0x00004000     \n#define PCH_GBE_TM_TH_TX_STRT_16   0x00008000     \n#define PCH_GBE_TM_TH_TX_STRT_32   0x0000C000     \n \n#define PCH_GBE_TM_TH_ALM_EMP_4    0x00000000     \n#define PCH_GBE_TM_TH_ALM_EMP_8    0x00000800     \n#define PCH_GBE_TM_TH_ALM_EMP_16   0x00001000     \n#define PCH_GBE_TM_TH_ALM_EMP_32   0x00001800     \n#define PCH_GBE_TM_TH_ALM_EMP_64   0x00002000     \n#define PCH_GBE_TM_TH_ALM_EMP_128  0x00002800     \n#define PCH_GBE_TM_TH_ALM_EMP_256  0x00003000     \n#define PCH_GBE_TM_TH_ALM_EMP_512  0x00003800     \n \n#define PCH_GBE_TM_TH_ALM_FULL_4   0x00000000     \n#define PCH_GBE_TM_TH_ALM_FULL_8   0x00000200     \n#define PCH_GBE_TM_TH_ALM_FULL_16  0x00000400     \n#define PCH_GBE_TM_TH_ALM_FULL_32  0x00000600     \n\n \n#define PCH_GBE_RF_ALM_FULL     0x80000000   \n#define PCH_GBE_RF_ALM_EMP      0x40000000   \n#define PCH_GBE_RF_RD_TRG       0x20000000   \n#define PCH_GBE_RF_STRWD        0x1FFE0000   \n#define PCH_GBE_RF_RCVING       0x00010000   \n\n \n#define PCH_GBE_BUSY                0x80000000\n\n \n#define PCH_GBE_MIIM_OPER_WRITE     0x04000000\n#define PCH_GBE_MIIM_OPER_READ      0x00000000\n#define PCH_GBE_MIIM_OPER_READY     0x04000000\n#define PCH_GBE_MIIM_PHY_ADDR_SHIFT 21\n#define PCH_GBE_MIIM_REG_ADDR_SHIFT 16\n\n \n#define PCH_GBE_LINK_UP             0x80000008\n#define PCH_GBE_RXC_SPEED_MSK       0x00000006\n#define PCH_GBE_RXC_SPEED_2_5M      0x00000000     \n#define PCH_GBE_RXC_SPEED_25M       0x00000002     \n#define PCH_GBE_RXC_SPEED_125M      0x00000004     \n#define PCH_GBE_DUPLEX_FULL         0x00000001\n\n \n#define PCH_GBE_CRS_SEL             0x00000010\n#define PCH_GBE_RGMII_RATE_125M     0x00000000\n#define PCH_GBE_RGMII_RATE_25M      0x00000008\n#define PCH_GBE_RGMII_RATE_2_5M     0x0000000C\n#define PCH_GBE_RGMII_MODE_GMII     0x00000000\n#define PCH_GBE_RGMII_MODE_RGMII    0x00000002\n#define PCH_GBE_CHIP_TYPE_EXTERNAL  0x00000000\n#define PCH_GBE_CHIP_TYPE_INTERNAL  0x00000001\n\n \n#define PCH_GBE_RX_DMA_EN       0x00000002    \n#define PCH_GBE_TX_DMA_EN       0x00000001    \n\n \n#define PCH_GBE_IDLE_CHECK       0xFFFFFFFE\n\n \n#define PCH_GBE_WLS_BR          0x00000008  \n#define PCH_GBE_WLS_MLT         0x00000004  \n\n \n#define PCH_GBE_WLS_IND         0x00000002\n#define PCH_GBE_WLS_MP          0x00000001  \n\n \n#define PCH_GBE_WLC_WOL_MODE    0x00010000\n#define PCH_GBE_WLC_IGN_TLONG   0x00000100\n#define PCH_GBE_WLC_IGN_TSHRT   0x00000080\n#define PCH_GBE_WLC_IGN_OCTER   0x00000040\n#define PCH_GBE_WLC_IGN_NBLER   0x00000020\n#define PCH_GBE_WLC_IGN_CRCER   0x00000010\n#define PCH_GBE_WLC_BR          0x00000008\n#define PCH_GBE_WLC_MLT         0x00000004\n#define PCH_GBE_WLC_IND         0x00000002\n#define PCH_GBE_WLC_MP          0x00000001\n\n \n#define PCH_GBE_WLA_BUSY        0x80000000\n\n\n\n \n#define PCH_GBE_MAX_TXD                     4096\n#define PCH_GBE_DEFAULT_TXD                  256\n#define PCH_GBE_MIN_TXD                        8\n#define PCH_GBE_MAX_RXD                     4096\n#define PCH_GBE_DEFAULT_RXD                  256\n#define PCH_GBE_MIN_RXD                        8\n\n \n#define PCH_GBE_TX_DESC_MULTIPLE               8\n#define PCH_GBE_RX_DESC_MULTIPLE               8\n\n \n#define PCH_GBE_HAL_MIIM_READ          ((u32)0x00000000)\n#define PCH_GBE_HAL_MIIM_WRITE         ((u32)0x04000000)\n\n \n#define PCH_GBE_FC_NONE\t\t\t0\n#define PCH_GBE_FC_RX_PAUSE\t\t1\n#define PCH_GBE_FC_TX_PAUSE\t\t2\n#define PCH_GBE_FC_FULL\t\t\t3\n#define PCH_GBE_FC_DEFAULT\t\tPCH_GBE_FC_FULL\n\n \nstruct pch_gbe_mac_info {\n\tu8 addr[6];\n\tu8 fc;\n\tu8 fc_autoneg;\n\tu8 tx_fc_enable;\n\tu32 max_frame_size;\n\tu32 min_frame_size;\n\tu8 autoneg;\n\tu16 link_speed;\n\tu16 link_duplex;\n};\n\n \nstruct pch_gbe_phy_info {\n\tu32 addr;\n\tu32 id;\n\tu32 revision;\n\tu32 reset_delay_us;\n\tu16 autoneg_advertised;\n};\n\n \nstruct pch_gbe_hw {\n\tvoid *back;\n\n\tstruct pch_gbe_regs  __iomem *reg;\n\tspinlock_t miim_lock;\n\n\tstruct pch_gbe_mac_info mac;\n\tstruct pch_gbe_phy_info phy;\n};\n\n \nstruct pch_gbe_rx_desc {\n\tu32 buffer_addr;\n\tu32 tcp_ip_status;\n\tu16 rx_words_eob;\n\tu16 gbec_status;\n\tu8 dma_status;\n\tu8 reserved1;\n\tu16 reserved2;\n};\n\n \nstruct pch_gbe_tx_desc {\n\tu32 buffer_addr;\n\tu16 length;\n\tu16 reserved1;\n\tu16 tx_words_eob;\n\tu16 tx_frame_ctrl;\n\tu8 dma_status;\n\tu8 reserved2;\n\tu16 gbec_status;\n};\n\n\n \nstruct pch_gbe_buffer {\n\tstruct sk_buff *skb;\n\tdma_addr_t dma;\n\tunsigned char *rx_buffer;\n\tunsigned long time_stamp;\n\tu16 length;\n\tbool mapped;\n};\n\n \nstruct pch_gbe_tx_ring {\n\tstruct pch_gbe_tx_desc *desc;\n\tdma_addr_t dma;\n\tunsigned int size;\n\tunsigned int count;\n\tunsigned int next_to_use;\n\tunsigned int next_to_clean;\n\tstruct pch_gbe_buffer *buffer_info;\n};\n\n \nstruct pch_gbe_rx_ring {\n\tstruct pch_gbe_rx_desc *desc;\n\tdma_addr_t dma;\n\tunsigned char *rx_buff_pool;\n\tdma_addr_t rx_buff_pool_logic;\n\tunsigned int rx_buff_pool_size;\n\tunsigned int size;\n\tunsigned int count;\n\tunsigned int next_to_use;\n\tunsigned int next_to_clean;\n\tstruct pch_gbe_buffer *buffer_info;\n};\n\n \nstruct pch_gbe_hw_stats {\n\tu32 rx_packets;\n\tu32 tx_packets;\n\tu32 rx_bytes;\n\tu32 tx_bytes;\n\tu32 rx_errors;\n\tu32 tx_errors;\n\tu32 rx_dropped;\n\tu32 tx_dropped;\n\tu32 multicast;\n\tu32 collisions;\n\tu32 rx_crc_errors;\n\tu32 rx_frame_errors;\n\tu32 rx_alloc_buff_failed;\n\tu32 tx_length_errors;\n\tu32 tx_aborted_errors;\n\tu32 tx_carrier_errors;\n\tu32 tx_timeout_count;\n\tu32 tx_restart_count;\n\tu32 intr_rx_dsc_empty_count;\n\tu32 intr_rx_frame_err_count;\n\tu32 intr_rx_fifo_err_count;\n\tu32 intr_rx_dma_err_count;\n\tu32 intr_tx_fifo_err_count;\n\tu32 intr_tx_dma_err_count;\n\tu32 intr_tcpip_err_count;\n};\n\n \nstruct pch_gbe_privdata {\n\tbool phy_tx_clk_delay;\n\tbool phy_disable_hibernate;\n\tint (*platform_init)(struct pci_dev *pdev);\n};\n\n \n\nstruct pch_gbe_adapter {\n\tspinlock_t stats_lock;\n\tspinlock_t ethtool_lock;\n\tatomic_t irq_sem;\n\tstruct net_device *netdev;\n\tstruct pci_dev *pdev;\n\tint irq;\n\tstruct net_device *polling_netdev;\n\tstruct napi_struct napi;\n\tstruct pch_gbe_hw hw;\n\tstruct pch_gbe_hw_stats stats;\n\tstruct work_struct reset_task;\n\tstruct mii_if_info mii;\n\tstruct timer_list watchdog_timer;\n\tu32 wake_up_evt;\n\tu32 *config_space;\n\tunsigned long led_status;\n\tstruct pch_gbe_tx_ring *tx_ring;\n\tstruct pch_gbe_rx_ring *rx_ring;\n\tunsigned long rx_buffer_len;\n\tunsigned long tx_queue_len;\n\tbool rx_stop_flag;\n\tint hwts_tx_en;\n\tint hwts_rx_en;\n\tstruct pci_dev *ptp_pdev;\n\tstruct pch_gbe_privdata *pdata;\n};\n\n#define pch_gbe_hw_to_adapter(hw)\tcontainer_of(hw, struct pch_gbe_adapter, hw)\n\n \nint pch_gbe_up(struct pch_gbe_adapter *adapter);\nvoid pch_gbe_down(struct pch_gbe_adapter *adapter);\nvoid pch_gbe_reinit_locked(struct pch_gbe_adapter *adapter);\nvoid pch_gbe_reset(struct pch_gbe_adapter *adapter);\nint pch_gbe_setup_tx_resources(struct pch_gbe_adapter *adapter,\n\t\t\t       struct pch_gbe_tx_ring *txdr);\nint pch_gbe_setup_rx_resources(struct pch_gbe_adapter *adapter,\n\t\t\t       struct pch_gbe_rx_ring *rxdr);\nvoid pch_gbe_free_tx_resources(struct pch_gbe_adapter *adapter,\n\t\t\t       struct pch_gbe_tx_ring *tx_ring);\nvoid pch_gbe_free_rx_resources(struct pch_gbe_adapter *adapter,\n\t\t\t       struct pch_gbe_rx_ring *rx_ring);\nvoid pch_gbe_update_stats(struct pch_gbe_adapter *adapter);\n\n \nvoid pch_gbe_check_options(struct pch_gbe_adapter *adapter);\n\n \nvoid pch_gbe_set_ethtool_ops(struct net_device *netdev);\n\n \ns32 pch_gbe_mac_force_mac_fc(struct pch_gbe_hw *hw);\nu16 pch_gbe_mac_ctrl_miim(struct pch_gbe_hw *hw, u32 addr, u32 dir, u32 reg,\n\t\t\t  u16 data);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}