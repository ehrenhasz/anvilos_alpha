{
  "module_name": "xilinx_axienet.h",
  "hash_id": "af5f54a0aa9de9a7d7aebbe9d8d771b72fff376999c3549cb23f3039b06faf42",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/xilinx/xilinx_axienet.h",
  "human_readable_source": " \n \n\n#ifndef XILINX_AXIENET_H\n#define XILINX_AXIENET_H\n\n#include <linux/netdevice.h>\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <linux/if_vlan.h>\n#include <linux/phylink.h>\n\n \n#define XAE_HDR_SIZE\t\t\t14  \n#define XAE_TRL_SIZE\t\t\t 4  \n#define XAE_MTU\t\t\t      1500  \n#define XAE_JUMBO_MTU\t\t      9000  \n\n#define XAE_MAX_FRAME_SIZE\t (XAE_MTU + XAE_HDR_SIZE + XAE_TRL_SIZE)\n#define XAE_MAX_VLAN_FRAME_SIZE  (XAE_MTU + VLAN_ETH_HLEN + XAE_TRL_SIZE)\n#define XAE_MAX_JUMBO_FRAME_SIZE (XAE_JUMBO_MTU + XAE_HDR_SIZE + XAE_TRL_SIZE)\n\n \n\n \n#define XAE_OPTION_PROMISC\t\t\t(1 << 0)\n\n \n#define XAE_OPTION_JUMBO\t\t\t(1 << 1)\n\n \n#define XAE_OPTION_VLAN\t\t\t\t(1 << 2)\n\n \n#define XAE_OPTION_FLOW_CONTROL\t\t\t(1 << 4)\n\n \n#define XAE_OPTION_FCS_STRIP\t\t\t(1 << 5)\n\n \n#define XAE_OPTION_FCS_INSERT\t\t\t(1 << 6)\n\n \n#define XAE_OPTION_LENTYPE_ERR\t\t\t(1 << 7)\n\n \n#define XAE_OPTION_TXEN\t\t\t\t(1 << 11)\n\n \n#define XAE_OPTION_RXEN\t\t\t\t(1 << 12)\n\n \n#define XAE_OPTION_DEFAULTS\t\t\t\t   \\\n\t\t\t\t(XAE_OPTION_TXEN |\t   \\\n\t\t\t\t XAE_OPTION_FLOW_CONTROL | \\\n\t\t\t\t XAE_OPTION_RXEN)\n\n \n\n#define XAXIDMA_TX_CR_OFFSET\t0x00000000  \n#define XAXIDMA_TX_SR_OFFSET\t0x00000004  \n#define XAXIDMA_TX_CDESC_OFFSET\t0x00000008  \n#define XAXIDMA_TX_TDESC_OFFSET\t0x00000010  \n\n#define XAXIDMA_RX_CR_OFFSET\t0x00000030  \n#define XAXIDMA_RX_SR_OFFSET\t0x00000034  \n#define XAXIDMA_RX_CDESC_OFFSET\t0x00000038  \n#define XAXIDMA_RX_TDESC_OFFSET\t0x00000040  \n\n#define XAXIDMA_CR_RUNSTOP_MASK\t0x00000001  \n#define XAXIDMA_CR_RESET_MASK\t0x00000004  \n\n#define XAXIDMA_SR_HALT_MASK\t0x00000001  \n\n#define XAXIDMA_BD_NDESC_OFFSET\t\t0x00  \n#define XAXIDMA_BD_BUFA_OFFSET\t\t0x08  \n#define XAXIDMA_BD_CTRL_LEN_OFFSET\t0x18  \n#define XAXIDMA_BD_STS_OFFSET\t\t0x1C  \n#define XAXIDMA_BD_USR0_OFFSET\t\t0x20  \n#define XAXIDMA_BD_USR1_OFFSET\t\t0x24  \n#define XAXIDMA_BD_USR2_OFFSET\t\t0x28  \n#define XAXIDMA_BD_USR3_OFFSET\t\t0x2C  \n#define XAXIDMA_BD_USR4_OFFSET\t\t0x30  \n#define XAXIDMA_BD_ID_OFFSET\t\t0x34  \n#define XAXIDMA_BD_HAS_STSCNTRL_OFFSET\t0x38  \n#define XAXIDMA_BD_HAS_DRE_OFFSET\t0x3C  \n\n#define XAXIDMA_BD_HAS_DRE_SHIFT\t8  \n#define XAXIDMA_BD_HAS_DRE_MASK\t\t0xF00  \n#define XAXIDMA_BD_WORDLEN_MASK\t\t0xFF  \n\n#define XAXIDMA_BD_CTRL_LENGTH_MASK\t0x007FFFFF  \n#define XAXIDMA_BD_CTRL_TXSOF_MASK\t0x08000000  \n#define XAXIDMA_BD_CTRL_TXEOF_MASK\t0x04000000  \n#define XAXIDMA_BD_CTRL_ALL_MASK\t0x0C000000  \n\n#define XAXIDMA_DELAY_MASK\t\t0xFF000000  \n#define XAXIDMA_COALESCE_MASK\t\t0x00FF0000  \n\n#define XAXIDMA_DELAY_SHIFT\t\t24\n#define XAXIDMA_COALESCE_SHIFT\t\t16\n\n#define XAXIDMA_IRQ_IOC_MASK\t\t0x00001000  \n#define XAXIDMA_IRQ_DELAY_MASK\t\t0x00002000  \n#define XAXIDMA_IRQ_ERROR_MASK\t\t0x00004000  \n#define XAXIDMA_IRQ_ALL_MASK\t\t0x00007000  \n\n \n#define XAXIDMA_DFT_TX_THRESHOLD\t24\n#define XAXIDMA_DFT_TX_USEC\t\t50\n#define XAXIDMA_DFT_RX_THRESHOLD\t1\n#define XAXIDMA_DFT_RX_USEC\t\t50\n\n#define XAXIDMA_BD_CTRL_TXSOF_MASK\t0x08000000  \n#define XAXIDMA_BD_CTRL_TXEOF_MASK\t0x04000000  \n#define XAXIDMA_BD_CTRL_ALL_MASK\t0x0C000000  \n\n#define XAXIDMA_BD_STS_ACTUAL_LEN_MASK\t0x007FFFFF  \n#define XAXIDMA_BD_STS_COMPLETE_MASK\t0x80000000  \n#define XAXIDMA_BD_STS_DEC_ERR_MASK\t0x40000000  \n#define XAXIDMA_BD_STS_SLV_ERR_MASK\t0x20000000  \n#define XAXIDMA_BD_STS_INT_ERR_MASK\t0x10000000  \n#define XAXIDMA_BD_STS_ALL_ERR_MASK\t0x70000000  \n#define XAXIDMA_BD_STS_RXSOF_MASK\t0x08000000  \n#define XAXIDMA_BD_STS_RXEOF_MASK\t0x04000000  \n#define XAXIDMA_BD_STS_ALL_MASK\t\t0xFC000000  \n\n#define XAXIDMA_BD_MINIMUM_ALIGNMENT\t0x40\n\n \n#define XAE_RAF_OFFSET\t\t0x00000000  \n#define XAE_TPF_OFFSET\t\t0x00000004  \n#define XAE_IFGP_OFFSET\t\t0x00000008  \n#define XAE_IS_OFFSET\t\t0x0000000C  \n#define XAE_IP_OFFSET\t\t0x00000010  \n#define XAE_IE_OFFSET\t\t0x00000014  \n#define XAE_TTAG_OFFSET\t\t0x00000018  \n#define XAE_RTAG_OFFSET\t\t0x0000001C  \n#define XAE_UAWL_OFFSET\t\t0x00000020  \n#define XAE_UAWU_OFFSET\t\t0x00000024  \n#define XAE_TPID0_OFFSET\t0x00000028  \n#define XAE_TPID1_OFFSET\t0x0000002C  \n#define XAE_PPST_OFFSET\t\t0x00000030  \n#define XAE_RCW0_OFFSET\t\t0x00000400  \n#define XAE_RCW1_OFFSET\t\t0x00000404  \n#define XAE_TC_OFFSET\t\t0x00000408  \n#define XAE_FCC_OFFSET\t\t0x0000040C  \n#define XAE_EMMC_OFFSET\t\t0x00000410  \n#define XAE_PHYC_OFFSET\t\t0x00000414  \n#define XAE_ID_OFFSET\t\t0x000004F8  \n#define XAE_MDIO_MC_OFFSET\t0x00000500  \n#define XAE_MDIO_MCR_OFFSET\t0x00000504  \n#define XAE_MDIO_MWD_OFFSET\t0x00000508  \n#define XAE_MDIO_MRD_OFFSET\t0x0000050C  \n#define XAE_UAW0_OFFSET\t\t0x00000700  \n#define XAE_UAW1_OFFSET\t\t0x00000704  \n#define XAE_FMI_OFFSET\t\t0x00000708  \n#define XAE_AF0_OFFSET\t\t0x00000710  \n#define XAE_AF1_OFFSET\t\t0x00000714  \n\n#define XAE_TX_VLAN_DATA_OFFSET 0x00004000  \n#define XAE_RX_VLAN_DATA_OFFSET 0x00008000  \n#define XAE_MCAST_TABLE_OFFSET\t0x00020000  \n\n \n \n#define XAE_RAF_MCSTREJ_MASK\t\t0x00000002\n \n#define XAE_RAF_BCSTREJ_MASK\t\t0x00000004\n#define XAE_RAF_TXVTAGMODE_MASK\t\t0x00000018  \n#define XAE_RAF_RXVTAGMODE_MASK\t\t0x00000060  \n#define XAE_RAF_TXVSTRPMODE_MASK\t0x00000180  \n#define XAE_RAF_RXVSTRPMODE_MASK\t0x00000600  \n#define XAE_RAF_NEWFNCENBL_MASK\t\t0x00000800  \n \n#define XAE_RAF_EMULTIFLTRENBL_MASK\t0x00001000\n#define XAE_RAF_STATSRST_MASK\t\t0x00002000  \n#define XAE_RAF_RXBADFRMEN_MASK\t\t0x00004000  \n#define XAE_RAF_TXVTAGMODE_SHIFT\t3  \n#define XAE_RAF_RXVTAGMODE_SHIFT\t5  \n#define XAE_RAF_TXVSTRPMODE_SHIFT\t7  \n#define XAE_RAF_RXVSTRPMODE_SHIFT\t9  \n\n \n#define XAE_TPF_TPFV_MASK\t\t0x0000FFFF  \n \n#define XAE_IFGP0_IFGP_MASK\t\t0x0000007F\n\n \n \n#define XAE_INT_HARDACSCMPLT_MASK\t0x00000001\n \n#define XAE_INT_AUTONEG_MASK\t\t0x00000002\n#define XAE_INT_RXCMPIT_MASK\t\t0x00000004  \n#define XAE_INT_RXRJECT_MASK\t\t0x00000008  \n#define XAE_INT_RXFIFOOVR_MASK\t\t0x00000010  \n#define XAE_INT_TXCMPIT_MASK\t\t0x00000020  \n#define XAE_INT_RXDCMLOCK_MASK\t\t0x00000040  \n#define XAE_INT_MGTRDY_MASK\t\t0x00000080  \n#define XAE_INT_PHYRSTCMPLT_MASK\t0x00000100  \n#define XAE_INT_ALL_MASK\t\t0x0000003F  \n\n \n#define XAE_INT_RECV_ERROR_MASK\t\t\t\t\\\n\t(XAE_INT_RXRJECT_MASK | XAE_INT_RXFIFOOVR_MASK)\n\n \n#define XAE_TPID_0_MASK\t\t0x0000FFFF  \n#define XAE_TPID_1_MASK\t\t0xFFFF0000  \n\n \n#define XAE_TPID_2_MASK\t\t0x0000FFFF  \n#define XAE_TPID_3_MASK\t\t0xFFFF0000  \n\n \n#define XAE_RCW1_RST_MASK\t0x80000000  \n#define XAE_RCW1_JUM_MASK\t0x40000000  \n \n#define XAE_RCW1_FCS_MASK\t0x20000000\n#define XAE_RCW1_RX_MASK\t0x10000000  \n#define XAE_RCW1_VLAN_MASK\t0x08000000  \n \n#define XAE_RCW1_LT_DIS_MASK\t0x02000000\n \n#define XAE_RCW1_CL_DIS_MASK\t0x01000000\n \n#define XAE_RCW1_PAUSEADDR_MASK 0x0000FFFF\n\n \n#define XAE_TC_RST_MASK\t\t0x80000000  \n#define XAE_TC_JUM_MASK\t\t0x40000000  \n \n#define XAE_TC_FCS_MASK\t\t0x20000000\n#define XAE_TC_TX_MASK\t\t0x10000000  \n#define XAE_TC_VLAN_MASK\t0x08000000  \n \n#define XAE_TC_IFG_MASK\t\t0x02000000\n\n \n#define XAE_FCC_FCRX_MASK\t0x20000000  \n#define XAE_FCC_FCTX_MASK\t0x40000000  \n\n \n#define XAE_EMMC_LINKSPEED_MASK\t0xC0000000  \n#define XAE_EMMC_RGMII_MASK\t0x20000000  \n#define XAE_EMMC_SGMII_MASK\t0x10000000  \n#define XAE_EMMC_GPCS_MASK\t0x08000000  \n#define XAE_EMMC_HOST_MASK\t0x04000000  \n#define XAE_EMMC_TX16BIT\t0x02000000  \n#define XAE_EMMC_RX16BIT\t0x01000000  \n#define XAE_EMMC_LINKSPD_10\t0x00000000  \n#define XAE_EMMC_LINKSPD_100\t0x40000000  \n#define XAE_EMMC_LINKSPD_1000\t0x80000000  \n\n \n#define XAE_PHYC_SGMIILINKSPEED_MASK\t0xC0000000  \n#define XAE_PHYC_RGMIILINKSPEED_MASK\t0x0000000C  \n#define XAE_PHYC_RGMIIHD_MASK\t\t0x00000002  \n#define XAE_PHYC_RGMIILINK_MASK\t\t0x00000001  \n#define XAE_PHYC_RGLINKSPD_10\t\t0x00000000  \n#define XAE_PHYC_RGLINKSPD_100\t\t0x00000004  \n#define XAE_PHYC_RGLINKSPD_1000\t\t0x00000008  \n#define XAE_PHYC_SGLINKSPD_10\t\t0x00000000  \n#define XAE_PHYC_SGLINKSPD_100\t\t0x40000000  \n#define XAE_PHYC_SGLINKSPD_1000\t\t0x80000000  \n\n \n#define XAE_MDIO_MC_MDIOEN_MASK\t\t0x00000040  \n#define XAE_MDIO_MC_CLOCK_DIVIDE_MAX\t0x3F\t    \n\n \n#define XAE_MDIO_MCR_PHYAD_MASK\t\t0x1F000000  \n#define XAE_MDIO_MCR_PHYAD_SHIFT\t24\t    \n#define XAE_MDIO_MCR_REGAD_MASK\t\t0x001F0000  \n#define XAE_MDIO_MCR_REGAD_SHIFT\t16\t    \n#define XAE_MDIO_MCR_OP_MASK\t\t0x0000C000  \n#define XAE_MDIO_MCR_OP_SHIFT\t\t13\t    \n#define XAE_MDIO_MCR_OP_READ_MASK\t0x00008000  \n#define XAE_MDIO_MCR_OP_WRITE_MASK\t0x00004000  \n#define XAE_MDIO_MCR_INITIATE_MASK\t0x00000800  \n#define XAE_MDIO_MCR_READY_MASK\t\t0x00000080  \n\n \n#define XAE_MDIO_INT_MIIM_RDY_MASK\t0x00000001  \n\n \n \n#define XAE_UAW1_UNICASTADDR_MASK\t0x0000FFFF\n\n \n#define XAE_FMI_PM_MASK\t\t\t0x80000000  \n#define XAE_FMI_IND_MASK\t\t0x00000003  \n\n#define XAE_MDIO_DIV_DFT\t\t29  \n\n \n#define XAE_PHY_TYPE_MII\t\t0\n#define XAE_PHY_TYPE_GMII\t\t1\n#define XAE_PHY_TYPE_RGMII_1_3\t\t2\n#define XAE_PHY_TYPE_RGMII_2_0\t\t3\n#define XAE_PHY_TYPE_SGMII\t\t4\n#define XAE_PHY_TYPE_1000BASE_X\t\t5\n\n  \n#define XAE_MULTICAST_CAM_TABLE_NUM\t4\n\n \n#define XAE_FEATURE_PARTIAL_RX_CSUM\t(1 << 0)\n#define XAE_FEATURE_PARTIAL_TX_CSUM\t(1 << 1)\n#define XAE_FEATURE_FULL_RX_CSUM\t(1 << 2)\n#define XAE_FEATURE_FULL_TX_CSUM\t(1 << 3)\n#define XAE_FEATURE_DMA_64BIT\t\t(1 << 4)\n\n#define XAE_NO_CSUM_OFFLOAD\t\t0\n\n#define XAE_FULL_CSUM_STATUS_MASK\t0x00000038\n#define XAE_IP_UDP_CSUM_VALIDATED\t0x00000003\n#define XAE_IP_TCP_CSUM_VALIDATED\t0x00000002\n\n#define DELAY_OF_ONE_MILLISEC\t\t1000\n\n \n#define XLNX_MII_STD_SELECT_REG\t\t0x11\n#define XLNX_MII_STD_SELECT_SGMII\tBIT(0)\n\n \nstruct axidma_bd {\n\tu32 next;\t \n\tu32 next_msb;\t \n\tu32 phys;\n\tu32 phys_msb;\t \n\tu32 reserved3;\n\tu32 reserved4;\n\tu32 cntrl;\n\tu32 status;\n\tu32 app0;\n\tu32 app1;\t \n\tu32 app2;\t \n\tu32 app3;\n\tu32 app4;    \n\tstruct sk_buff *skb;\n} __aligned(XAXIDMA_BD_MINIMUM_ALIGNMENT);\n\n#define XAE_NUM_MISC_CLOCKS 3\n\n \nstruct axienet_local {\n\tstruct net_device *ndev;\n\tstruct device *dev;\n\n\tstruct phylink *phylink;\n\tstruct phylink_config phylink_config;\n\n\tstruct mdio_device *pcs_phy;\n\tstruct phylink_pcs pcs;\n\n\tbool switch_x_sgmii;\n\n\tstruct clk *axi_clk;\n\tstruct clk_bulk_data misc_clks[XAE_NUM_MISC_CLOCKS];\n\n\tstruct mii_bus *mii_bus;\n\tu8 mii_clk_div;\n\n\tresource_size_t regs_start;\n\tvoid __iomem *regs;\n\tvoid __iomem *dma_regs;\n\n\tstruct napi_struct napi_rx;\n\tu32 rx_dma_cr;\n\tstruct axidma_bd *rx_bd_v;\n\tdma_addr_t rx_bd_p;\n\tu32 rx_bd_num;\n\tu32 rx_bd_ci;\n\tu64_stats_t rx_packets;\n\tu64_stats_t rx_bytes;\n\tstruct u64_stats_sync rx_stat_sync;\n\n\tstruct napi_struct napi_tx;\n\tu32 tx_dma_cr;\n\tstruct axidma_bd *tx_bd_v;\n\tdma_addr_t tx_bd_p;\n\tu32 tx_bd_num;\n\tu32 tx_bd_ci;\n\tu32 tx_bd_tail;\n\tu64_stats_t tx_packets;\n\tu64_stats_t tx_bytes;\n\tstruct u64_stats_sync tx_stat_sync;\n\n\tstruct work_struct dma_err_task;\n\n\tint tx_irq;\n\tint rx_irq;\n\tint eth_irq;\n\tphy_interface_t phy_mode;\n\n\tu32 options;\n\tu32 features;\n\n\tu32 max_frm_size;\n\tu32 rxmem;\n\n\tint csum_offload_on_tx_path;\n\tint csum_offload_on_rx_path;\n\n\tu32 coalesce_count_rx;\n\tu32 coalesce_usec_rx;\n\tu32 coalesce_count_tx;\n\tu32 coalesce_usec_tx;\n};\n\n \nstruct axienet_option {\n\tu32 opt;\n\tu32 reg;\n\tu32 m_or;\n};\n\n \nstatic inline u32 axienet_ior(struct axienet_local *lp, off_t offset)\n{\n\treturn ioread32(lp->regs + offset);\n}\n\nstatic inline u32 axinet_ior_read_mcr(struct axienet_local *lp)\n{\n\treturn axienet_ior(lp, XAE_MDIO_MCR_OFFSET);\n}\n\nstatic inline void axienet_lock_mii(struct axienet_local *lp)\n{\n\tif (lp->mii_bus)\n\t\tmutex_lock(&lp->mii_bus->mdio_lock);\n}\n\nstatic inline void axienet_unlock_mii(struct axienet_local *lp)\n{\n\tif (lp->mii_bus)\n\t\tmutex_unlock(&lp->mii_bus->mdio_lock);\n}\n\n \nstatic inline void axienet_iow(struct axienet_local *lp, off_t offset,\n\t\t\t       u32 value)\n{\n\tiowrite32(value, lp->regs + offset);\n}\n\n \n\nstatic inline void axienet_dma_out32(struct axienet_local *lp,\n\t\t\t\t     off_t reg, u32 value)\n{\n\tiowrite32(value, lp->dma_regs + reg);\n}\n\n#if defined(CONFIG_64BIT) && defined(iowrite64)\n \nstatic inline void axienet_dma_out64(struct axienet_local *lp,\n\t\t\t\t     off_t reg, u64 value)\n{\n\tiowrite64(value, lp->dma_regs + reg);\n}\n\nstatic inline void axienet_dma_out_addr(struct axienet_local *lp, off_t reg,\n\t\t\t\t\tdma_addr_t addr)\n{\n\tif (lp->features & XAE_FEATURE_DMA_64BIT)\n\t\taxienet_dma_out64(lp, reg, addr);\n\telse\n\t\taxienet_dma_out32(lp, reg, lower_32_bits(addr));\n}\n\n#else  \n\nstatic inline void axienet_dma_out_addr(struct axienet_local *lp, off_t reg,\n\t\t\t\t\tdma_addr_t addr)\n{\n\taxienet_dma_out32(lp, reg, lower_32_bits(addr));\n}\n\n#endif  \n\n \nint axienet_mdio_setup(struct axienet_local *lp);\nvoid axienet_mdio_teardown(struct axienet_local *lp);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}