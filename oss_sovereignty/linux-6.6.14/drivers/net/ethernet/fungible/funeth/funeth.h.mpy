{
  "module_name": "funeth.h",
  "hash_id": "349c68514746220e6706ec949e9f6dc48ec149a8b05b3a23a2985fd73a8cd0c9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/fungible/funeth/funeth.h",
  "human_readable_source": " \n\n#ifndef _FUNETH_H\n#define _FUNETH_H\n\n#include <uapi/linux/if_ether.h>\n#include <uapi/linux/net_tstamp.h>\n#include <linux/mutex.h>\n#include <linux/seqlock.h>\n#include <linux/xarray.h>\n#include <net/devlink.h>\n#include \"fun_dev.h\"\n\n#define ADMIN_SQE_SIZE SZ_128\n#define ADMIN_CQE_SIZE SZ_64\n#define ADMIN_RSP_MAX_LEN (ADMIN_CQE_SIZE - sizeof(struct fun_cqe_info))\n\n#define FUN_MAX_MTU 9024\n\n#define SQ_DEPTH 512U\n#define CQ_DEPTH 1024U\n#define RQ_DEPTH (512U / (PAGE_SIZE / 4096))\n\n#define CQ_INTCOAL_USEC 10\n#define CQ_INTCOAL_NPKT 16\n#define SQ_INTCOAL_USEC 10\n#define SQ_INTCOAL_NPKT 16\n\n#define INVALID_LPORT 0xffff\n\n#define FUN_PORT_CAP_PAUSE_MASK (FUN_PORT_CAP_TX_PAUSE | FUN_PORT_CAP_RX_PAUSE)\n\nstruct fun_vport_info {\n\tu8 mac[ETH_ALEN];\n\tu16 vlan;\n\t__be16 vlan_proto;\n\tu8 qos;\n\tu8 spoofchk:1;\n\tu8 trusted:1;\n\tunsigned int max_rate;\n};\n\n \nstruct fun_ethdev {\n\tstruct fun_dev fdev;\n\n\t \n\tstruct net_device **netdevs;\n\tunsigned int num_ports;\n\n\t \n\tunsigned int num_vports;\n\tstruct fun_vport_info *vport_info;\n\n\tstruct mutex state_mutex;  \n\n\tunsigned int nsqs_per_port;\n};\n\nstatic inline struct fun_ethdev *to_fun_ethdev(struct fun_dev *p)\n{\n\treturn container_of(p, struct fun_ethdev, fdev);\n}\n\nstruct fun_qset {\n\tstruct funeth_rxq **rxqs;\n\tstruct funeth_txq **txqs;\n\tstruct funeth_txq **xdpqs;\n\tunsigned int nrxqs;\n\tunsigned int ntxqs;\n\tunsigned int nxdpqs;\n\tunsigned int rxq_start;\n\tunsigned int txq_start;\n\tunsigned int xdpq_start;\n\tunsigned int cq_depth;\n\tunsigned int rq_depth;\n\tunsigned int sq_depth;\n\tint state;\n};\n\n \nstruct funeth_priv {\n\tstruct fun_dev *fdev;\n\tstruct pci_dev *pdev;\n\tstruct net_device *netdev;\n\n\tstruct funeth_rxq * __rcu *rxqs;\n\tstruct funeth_txq **txqs;\n\tstruct funeth_txq * __rcu *xdpqs;\n\n\tstruct xarray irqs;\n\tunsigned int num_tx_irqs;\n\tunsigned int num_rx_irqs;\n\tunsigned int rx_irq_ofst;\n\n\tunsigned int lane_attrs;\n\tu16 lport;\n\n\t \n\tu64 port_caps;\n\tu64 advertising;\n\tu64 lp_advertising;\n\tunsigned int link_speed;\n\tu8 xcvr_type;\n\tu8 active_fc;\n\tu8 active_fec;\n\tu8 link_down_reason;\n\tseqcount_t link_seq;\n\n\tu32 msg_enable;\n\n\tunsigned int num_xdpqs;\n\n\t \n\tunsigned int sq_depth;\n\tunsigned int rq_depth;\n\tunsigned int cq_depth;\n\tunsigned int cq_irq_db;\n\tu8 tx_coal_usec;\n\tu8 tx_coal_count;\n\tu8 rx_coal_usec;\n\tu8 rx_coal_count;\n\n\tstruct hwtstamp_config hwtstamp_cfg;\n\n\t \n\tu64 tx_packets;\n\tu64 tx_bytes;\n\tu64 tx_dropped;\n\tu64 rx_packets;\n\tu64 rx_bytes;\n\tu64 rx_dropped;\n\n\t \n\tunsigned int rss_hw_id;\n\tenum fun_eth_hash_alg hash_algo;\n\tu8 rss_key[FUN_ETH_RSS_MAX_KEY_SIZE];\n\tunsigned int indir_table_nentries;\n\tu32 indir_table[FUN_ETH_RSS_MAX_INDIR_ENT];\n\tdma_addr_t rss_dma_addr;\n\tvoid *rss_cfg;\n\n\t \n\tdma_addr_t stats_dma_addr;\n\t__be64 *stats;\n\n\tstruct bpf_prog *xdp_prog;\n\n\tstruct devlink_port dl_port;\n\n\t \n\tunsigned int ktls_id;\n\tatomic64_t tx_tls_add;\n\tatomic64_t tx_tls_del;\n\tatomic64_t tx_tls_resync;\n};\n\nvoid fun_set_ethtool_ops(struct net_device *netdev);\nint fun_port_write_cmd(struct funeth_priv *fp, int key, u64 data);\nint fun_port_read_cmd(struct funeth_priv *fp, int key, u64 *data);\nint fun_create_and_bind_tx(struct funeth_priv *fp, u32 sqid);\nint fun_replace_queues(struct net_device *dev, struct fun_qset *newqs,\n\t\t       struct netlink_ext_ack *extack);\nint fun_change_num_queues(struct net_device *dev, unsigned int ntx,\n\t\t\t  unsigned int nrx);\nvoid fun_set_ring_count(struct net_device *netdev, unsigned int ntx,\n\t\t\tunsigned int nrx);\nint fun_config_rss(struct net_device *dev, int algo, const u8 *key,\n\t\t   const u32 *qtable, u8 op);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}