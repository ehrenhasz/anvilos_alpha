{
  "module_name": "dpaa2-eth.h",
  "hash_id": "61ad77f38f76f090b2b8f5c1e0d615ed5a4fe278be2f75809e13ed7f3d3d2474",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/freescale/dpaa2/dpaa2-eth.h",
  "human_readable_source": " \n \n\n#ifndef __DPAA2_ETH_H\n#define __DPAA2_ETH_H\n\n#include <linux/dcbnl.h>\n#include <linux/netdevice.h>\n#include <linux/if_vlan.h>\n#include <linux/fsl/mc.h>\n#include <linux/net_tstamp.h>\n#include <net/devlink.h>\n#include <net/xdp.h>\n\n#include <soc/fsl/dpaa2-io.h>\n#include <soc/fsl/dpaa2-fd.h>\n#include \"dpni.h\"\n#include \"dpni-cmd.h\"\n\n#include \"dpaa2-eth-trace.h\"\n#include \"dpaa2-eth-debugfs.h\"\n#include \"dpaa2-mac.h\"\n\n#define DPAA2_WRIOP_VERSION(x, y, z) ((x) << 10 | (y) << 5 | (z) << 0)\n\n#define DPAA2_ETH_STORE_SIZE\t\t16\n\n \n#define DPAA2_ETH_MAX_SG_ENTRIES\t((64 * 1024) / DPAA2_ETH_RX_BUF_SIZE)\n\n \n#define DPAA2_ETH_MFL\t\t\t(10 * 1024)\n#define DPAA2_ETH_MAX_MTU\t\t(DPAA2_ETH_MFL - VLAN_ETH_HLEN)\n \n#define DPAA2_ETH_L2_MAX_FRM(mtu)\t((mtu) + VLAN_ETH_HLEN)\n\n \n#define DPAA2_ETH_FQ_TAILDROP_THRESH\t(1024 * 1024)\n\n \n#define DPAA2_ETH_MAX_BURST_SIZE\t0xF7FF\n\n \n#define DPAA2_ETH_TXCONF_PER_NAPI\t256\n\n \n#define DPAA2_ETH_TX_ZC_PER_NAPI\tDPAA2_ETH_TXCONF_PER_NAPI\n\n \n#define DPAA2_ETH_NUM_BUFS\t\t1280\n#define DPAA2_ETH_REFILL_THRESH \\\n\t(DPAA2_ETH_NUM_BUFS - DPAA2_ETH_BUFS_PER_CMD)\n\n \n#define DPAA2_ETH_CG_TAILDROP_THRESH(priv)\t\t\t\t\\\n\t(1024 * dpaa2_eth_queue_count(priv) / dpaa2_eth_tc_count(priv))\n\n \n#define DPAA2_ETH_CN_THRESH_ENTRY(priv) \\\n\t(DPAA2_ETH_CG_TAILDROP_THRESH(priv) / 2)\n#define DPAA2_ETH_CN_THRESH_EXIT(priv) \\\n\t(DPAA2_ETH_CN_THRESH_ENTRY(priv) * 3 / 4)\n\n \n#define DPAA2_ETH_BUFS_PER_CMD\t\t7\n\n \n#define DPAA2_ETH_TX_BUF_ALIGN\t\t64\n\n#define DPAA2_ETH_RX_BUF_RAW_SIZE\tPAGE_SIZE\n#define DPAA2_ETH_RX_BUF_TAILROOM \\\n\tSKB_DATA_ALIGN(sizeof(struct skb_shared_info))\n#define DPAA2_ETH_RX_BUF_SIZE \\\n\t(DPAA2_ETH_RX_BUF_RAW_SIZE - DPAA2_ETH_RX_BUF_TAILROOM)\n\n \n#define DPAA2_ETH_RX_HWA_SIZE\t\t64\n#define DPAA2_ETH_TX_HWA_SIZE\t\t128\n\n \n#define DPAA2_PTP_CLK_PERIOD_NS\t\t1\n\n \n#define DPAA2_ETH_RX_BUF_ALIGN_REV1\t256\n#define DPAA2_ETH_RX_BUF_ALIGN\t\t64\n\n \n#define DPAA2_ETH_DEFAULT_BP_IDX\t0\n#define DPAA2_ETH_MAX_BPS\t\t9\n\n \n#define DPAA2_ETH_SWA_SIZE\t\t64\n\n \nenum dpaa2_eth_swa_type {\n\tDPAA2_ETH_SWA_SINGLE,\n\tDPAA2_ETH_SWA_SG,\n\tDPAA2_ETH_SWA_XDP,\n\tDPAA2_ETH_SWA_XSK,\n\tDPAA2_ETH_SWA_SW_TSO,\n};\n\n \nstruct dpaa2_eth_swa {\n\tenum dpaa2_eth_swa_type type;\n\tunion {\n\t\tstruct {\n\t\t\tstruct sk_buff *skb;\n\t\t\tint sgt_size;\n\t\t} single;\n\t\tstruct {\n\t\t\tstruct sk_buff *skb;\n\t\t\tstruct scatterlist *scl;\n\t\t\tint num_sg;\n\t\t\tint sgt_size;\n\t\t} sg;\n\t\tstruct {\n\t\t\tint dma_size;\n\t\t\tstruct xdp_frame *xdpf;\n\t\t} xdp;\n\t\tstruct {\n\t\t\tstruct xdp_buff *xdp_buff;\n\t\t\tint sgt_size;\n\t\t} xsk;\n\t\tstruct {\n\t\t\tstruct sk_buff *skb;\n\t\t\tint num_sg;\n\t\t\tint sgt_size;\n\t\t\tint is_last_fd;\n\t\t} tso;\n\t};\n};\n\n \n#define DPAA2_FD_FRC_FASV\t\t0x8000\n#define DPAA2_FD_FRC_FAEADV\t\t0x4000\n#define DPAA2_FD_FRC_FAPRV\t\t0x2000\n#define DPAA2_FD_FRC_FAIADV\t\t0x1000\n#define DPAA2_FD_FRC_FASWOV\t\t0x0800\n#define DPAA2_FD_FRC_FAICFDV\t\t0x0400\n\n \n#define DPAA2_FD_RX_ERR_MASK\t\t(FD_CTRL_SBE | FD_CTRL_FAERR)\n#define DPAA2_FD_TX_ERR_MASK\t\t(FD_CTRL_UFD\t| \\\n\t\t\t\t\t FD_CTRL_SBE\t| \\\n\t\t\t\t\t FD_CTRL_FSE\t| \\\n\t\t\t\t\t FD_CTRL_FAERR)\n\n \n#define DPAA2_FD_CTRL_ASAL\t\t0x00020000\t \n\n \nstruct dpaa2_fas {\n\tu8 reserved;\n\tu8 ppid;\n\t__le16 ifpid;\n\t__le32 status;\n};\n\n \n#define DPAA2_FAS_OFFSET\t\t0\n#define DPAA2_FAS_SIZE\t\t\t(sizeof(struct dpaa2_fas))\n\n \n#define DPAA2_TS_OFFSET\t\t\t0x8\n\n \nstruct dpaa2_fapr {\n\t \n\t__le32 faf_lo;\n\t__le16 faf_ext;\n\t__le16 nxt_hdr;\n\t \n\t__le64 faf_hi;\n\t \n\tu8 last_ethertype_offset;\n\tu8 vlan_tci_offset_n;\n\tu8 vlan_tci_offset_1;\n\tu8 llc_snap_offset;\n\tu8 eth_offset;\n\tu8 ip1_pid_offset;\n\tu8 shim_offset_2;\n\tu8 shim_offset_1;\n\t \n\tu8 l5_offset;\n\tu8 l4_offset;\n\tu8 gre_offset;\n\tu8 l3_offset_n;\n\tu8 l3_offset_1;\n\tu8 mpls_offset_n;\n\tu8 mpls_offset_1;\n\tu8 pppoe_offset;\n\t \n\t__le16 running_sum;\n\t__le16 gross_running_sum;\n\tu8 ipv6_frag_offset;\n\tu8 nxt_hdr_offset;\n\tu8 routing_hdr_offset_2;\n\tu8 routing_hdr_offset_1;\n\t \n\tu8 reserved[5];  \n\tu8 ip_proto_offset_n;\n\tu8 nxt_hdr_frag_offset;\n\tu8 parse_error_code;\n};\n\n#define DPAA2_FAPR_OFFSET\t\t0x10\n#define DPAA2_FAPR_SIZE\t\t\tsizeof((struct dpaa2_fapr))\n\n \n#define DPAA2_FAEAD_OFFSET\t\t0x58\n\nstruct dpaa2_faead {\n\t__le32 conf_fqid;\n\t__le32 ctrl;\n};\n\n#define DPAA2_FAEAD_A2V\t\t\t0x20000000\n#define DPAA2_FAEAD_A4V\t\t\t0x08000000\n#define DPAA2_FAEAD_UPDV\t\t0x00001000\n#define DPAA2_FAEAD_EBDDV\t\t0x00002000\n#define DPAA2_FAEAD_UPD\t\t\t0x00000010\n\nstruct ptp_tstamp {\n\tu16 sec_msb;\n\tu32 sec_lsb;\n\tu32 nsec;\n};\n\nstatic inline void ns_to_ptp_tstamp(struct ptp_tstamp *tstamp, u64 ns)\n{\n\tu64 sec, nsec;\n\n\tsec = ns;\n\tnsec = do_div(sec, 1000000000);\n\n\ttstamp->sec_lsb = sec & 0xFFFFFFFF;\n\ttstamp->sec_msb = (sec >> 32) & 0xFFFF;\n\ttstamp->nsec = nsec;\n}\n\n \nstatic inline void *dpaa2_get_hwa(void *buf_addr, bool swa)\n{\n\treturn buf_addr + (swa ? DPAA2_ETH_SWA_SIZE : 0);\n}\n\nstatic inline struct dpaa2_fas *dpaa2_get_fas(void *buf_addr, bool swa)\n{\n\treturn dpaa2_get_hwa(buf_addr, swa) + DPAA2_FAS_OFFSET;\n}\n\nstatic inline __le64 *dpaa2_get_ts(void *buf_addr, bool swa)\n{\n\treturn dpaa2_get_hwa(buf_addr, swa) + DPAA2_TS_OFFSET;\n}\n\nstatic inline struct dpaa2_fapr *dpaa2_get_fapr(void *buf_addr, bool swa)\n{\n\treturn dpaa2_get_hwa(buf_addr, swa) + DPAA2_FAPR_OFFSET;\n}\n\nstatic inline struct dpaa2_faead *dpaa2_get_faead(void *buf_addr, bool swa)\n{\n\treturn dpaa2_get_hwa(buf_addr, swa) + DPAA2_FAEAD_OFFSET;\n}\n\n \n \n#define DPAA2_FAS_DISC\t\t\t0x80000000\n \n#define DPAA2_FAS_MS\t\t\t0x40000000\n#define DPAA2_FAS_PTP\t\t\t0x08000000\n \n#define DPAA2_FAS_MC\t\t\t0x04000000\n \n#define DPAA2_FAS_BC\t\t\t0x02000000\n#define DPAA2_FAS_KSE\t\t\t0x00040000\n#define DPAA2_FAS_EOFHE\t\t\t0x00020000\n#define DPAA2_FAS_MNLE\t\t\t0x00010000\n#define DPAA2_FAS_TIDE\t\t\t0x00008000\n#define DPAA2_FAS_PIEE\t\t\t0x00004000\n \n#define DPAA2_FAS_FLE\t\t\t0x00002000\n \n#define DPAA2_FAS_FPE\t\t\t0x00001000\n#define DPAA2_FAS_PTE\t\t\t0x00000080\n#define DPAA2_FAS_ISP\t\t\t0x00000040\n#define DPAA2_FAS_PHE\t\t\t0x00000020\n#define DPAA2_FAS_BLE\t\t\t0x00000010\n \n#define DPAA2_FAS_L3CV\t\t\t0x00000008\n \n#define DPAA2_FAS_L3CE\t\t\t0x00000004\n \n#define DPAA2_FAS_L4CV\t\t\t0x00000002\n \n#define DPAA2_FAS_L4CE\t\t\t0x00000001\n \n#define DPAA2_FAS_RX_ERR_MASK\t\t(DPAA2_FAS_KSE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_EOFHE\t| \\\n\t\t\t\t\t DPAA2_FAS_MNLE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_TIDE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_PIEE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_FLE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_FPE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_PTE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_ISP\t\t| \\\n\t\t\t\t\t DPAA2_FAS_PHE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_BLE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_L3CE\t\t| \\\n\t\t\t\t\t DPAA2_FAS_L4CE)\n\n \n#define DPAA2_ETH_LINK_STATE_REFRESH\t1000\n\n \n#define DPAA2_ETH_ENQUEUE_RETRIES\t10\n\n \n#define DPAA2_ETH_SWP_BUSY_RETRIES\t1000\n\n \nstruct dpaa2_eth_drv_stats {\n\t__u64\ttx_conf_frames;\n\t__u64\ttx_conf_bytes;\n\t__u64\ttx_sg_frames;\n\t__u64\ttx_sg_bytes;\n\t__u64\ttx_tso_frames;\n\t__u64\ttx_tso_bytes;\n\t__u64\trx_sg_frames;\n\t__u64\trx_sg_bytes;\n\t \n\t__u64\ttx_converted_sg_frames;\n\t__u64\ttx_converted_sg_bytes;\n\t \n\t__u64\ttx_portal_busy;\n};\n\n \nstruct dpaa2_eth_fq_stats {\n\t \n\t__u64 frames;\n};\n\n \nstruct dpaa2_eth_ch_stats {\n\t \n\t__u64 dequeue_portal_busy;\n\t \n\t__u64 pull_err;\n\t \n\t__u64 cdan;\n\t \n\t__u64 xdp_drop;\n\t__u64 xdp_tx;\n\t__u64 xdp_tx_err;\n\t__u64 xdp_redirect;\n\t \n\t__u64 frames;\n\t__u64 frames_per_cdan;\n\t__u64 bytes_per_cdan;\n};\n\n#define DPAA2_ETH_CH_STATS\t7\n\n \n#define DPAA2_ETH_MAX_TCS\t\t8\n#define DPAA2_ETH_MAX_RX_QUEUES_PER_TC\t16\n#define DPAA2_ETH_MAX_RX_QUEUES\t\t\\\n\t(DPAA2_ETH_MAX_RX_QUEUES_PER_TC * DPAA2_ETH_MAX_TCS)\n#define DPAA2_ETH_MAX_TX_QUEUES\t\t16\n#define DPAA2_ETH_MAX_RX_ERR_QUEUES\t1\n#define DPAA2_ETH_MAX_QUEUES\t\t(DPAA2_ETH_MAX_RX_QUEUES + \\\n\t\t\t\t\tDPAA2_ETH_MAX_TX_QUEUES + \\\n\t\t\t\t\tDPAA2_ETH_MAX_RX_ERR_QUEUES)\n#define DPAA2_ETH_MAX_NETDEV_QUEUES\t\\\n\t(DPAA2_ETH_MAX_TX_QUEUES * DPAA2_ETH_MAX_TCS)\n\n#define DPAA2_ETH_MAX_DPCONS\t\t16\n\nenum dpaa2_eth_fq_type {\n\tDPAA2_RX_FQ = 0,\n\tDPAA2_TX_CONF_FQ,\n\tDPAA2_RX_ERR_FQ\n};\n\nstruct dpaa2_eth_priv;\nstruct dpaa2_eth_channel;\nstruct dpaa2_eth_fq;\n\nstruct dpaa2_eth_xdp_fds {\n\tstruct dpaa2_fd fds[DEV_MAP_BULK_SIZE];\n\tssize_t num;\n};\n\ntypedef void dpaa2_eth_consume_cb_t(struct dpaa2_eth_priv *priv,\n\t\t\t\t    struct dpaa2_eth_channel *ch,\n\t\t\t\t    const struct dpaa2_fd *fd,\n\t\t\t\t    struct dpaa2_eth_fq *fq);\n\nstruct dpaa2_eth_fq {\n\tu32 fqid;\n\tu32 tx_qdbin;\n\tu32 tx_fqid[DPAA2_ETH_MAX_TCS];\n\tu16 flowid;\n\tu8 tc;\n\tint target_cpu;\n\tu32 dq_frames;\n\tu32 dq_bytes;\n\tstruct dpaa2_eth_channel *channel;\n\tenum dpaa2_eth_fq_type type;\n\n\tdpaa2_eth_consume_cb_t *consume;\n\tstruct dpaa2_eth_fq_stats stats;\n\n\tstruct dpaa2_eth_xdp_fds xdp_redirect_fds;\n\tstruct dpaa2_eth_xdp_fds xdp_tx_fds;\n};\n\nstruct dpaa2_eth_ch_xdp {\n\tstruct bpf_prog *prog;\n\tunsigned int res;\n};\n\nstruct dpaa2_eth_bp {\n\tstruct fsl_mc_device *dev;\n\tint bpid;\n};\n\nstruct dpaa2_eth_channel {\n\tstruct dpaa2_io_notification_ctx nctx;\n\tstruct fsl_mc_device *dpcon;\n\tint dpcon_id;\n\tint ch_id;\n\tstruct napi_struct napi;\n\tstruct dpaa2_io *dpio;\n\tstruct dpaa2_io_store *store;\n\tstruct dpaa2_eth_priv *priv;\n\tint buf_count;\n\tstruct dpaa2_eth_ch_stats stats;\n\tstruct dpaa2_eth_ch_xdp xdp;\n\tstruct xdp_rxq_info xdp_rxq;\n\tstruct list_head *rx_list;\n\n\t \n\tu64 recycled_bufs[DPAA2_ETH_BUFS_PER_CMD];\n\tint recycled_bufs_cnt;\n\n\tbool xsk_zc;\n\tint xsk_tx_pkts_sent;\n\tstruct xsk_buff_pool *xsk_pool;\n\tstruct dpaa2_eth_bp *bp;\n};\n\nstruct dpaa2_eth_dist_fields {\n\tu64 rxnfc_field;\n\tenum net_prot cls_prot;\n\tint cls_field;\n\tint size;\n\tu64 id;\n};\n\nstruct dpaa2_eth_cls_rule {\n\tstruct ethtool_rx_flow_spec fs;\n\tu8 in_use;\n};\n\n#define DPAA2_ETH_SGT_CACHE_SIZE\t256\nstruct dpaa2_eth_sgt_cache {\n\tvoid *buf[DPAA2_ETH_SGT_CACHE_SIZE];\n\tu16 count;\n};\n\nstruct dpaa2_eth_trap_item {\n\tvoid *trap_ctx;\n};\n\nstruct dpaa2_eth_trap_data {\n\tstruct dpaa2_eth_trap_item *trap_items_arr;\n\tstruct dpaa2_eth_priv *priv;\n};\n\n#define DPAA2_ETH_SG_ENTRIES_MAX\t(PAGE_SIZE / sizeof(struct scatterlist))\n\n#define DPAA2_ETH_DEFAULT_COPYBREAK\t512\n\n#define DPAA2_ETH_ENQUEUE_MAX_FDS\t256\nstruct dpaa2_eth_fds {\n\tstruct dpaa2_fd array[DPAA2_ETH_ENQUEUE_MAX_FDS];\n};\n\n \nstruct dpaa2_eth_priv {\n\tstruct net_device *net_dev;\n\n\tu8 num_fqs;\n\tstruct dpaa2_eth_fq fq[DPAA2_ETH_MAX_QUEUES];\n\tint (*enqueue)(struct dpaa2_eth_priv *priv,\n\t\t       struct dpaa2_eth_fq *fq,\n\t\t       struct dpaa2_fd *fd, u8 prio,\n\t\t       u32 num_frames,\n\t\t       int *frames_enqueued);\n\n\tu8 num_channels;\n\tstruct dpaa2_eth_channel *channel[DPAA2_ETH_MAX_DPCONS];\n\tstruct dpaa2_eth_sgt_cache __percpu *sgt_cache;\n\tunsigned long features;\n\tstruct dpni_attr dpni_attrs;\n\tu16 dpni_ver_major;\n\tu16 dpni_ver_minor;\n\tu16 tx_data_offset;\n\tvoid __iomem *onestep_reg_base;\n\tu8 ptp_correction_off;\n\tvoid (*dpaa2_set_onestep_params_cb)(struct dpaa2_eth_priv *priv,\n\t\t\t\t\t    u32 offset, u8 udp);\n\tu16 rx_buf_size;\n\tstruct iommu_domain *iommu_domain;\n\n\tenum hwtstamp_tx_types tx_tstamp_type;\t \n\tbool rx_tstamp;\t\t\t\t \n\n\t \n\tstruct dpaa2_eth_bp *bp[DPAA2_ETH_MAX_BPS];\n\tint num_bps;\n\n\tu16 tx_qdid;\n\tstruct fsl_mc_io *mc_io;\n\t \n\tstruct cpumask dpio_cpumask;\n\n\t \n\tstruct rtnl_link_stats64 __percpu *percpu_stats;\n\t \n\tstruct dpaa2_eth_drv_stats __percpu *percpu_extras;\n\n\tu16 mc_token;\n\tu8 rx_fqtd_enabled;\n\tu8 rx_cgtd_enabled;\n\n\tstruct dpni_link_state link_state;\n\tbool do_link_poll;\n\tstruct task_struct *poll_thread;\n\n\t \n\tu64 rx_hash_fields;\n\tu64 rx_cls_fields;\n\tstruct dpaa2_eth_cls_rule *cls_rules;\n\tu8 rx_cls_enabled;\n\tu8 vlan_cls_enabled;\n\tu8 pfc_enabled;\n#ifdef CONFIG_FSL_DPAA2_ETH_DCB\n\tu8 dcbx_mode;\n\tstruct ieee_pfc pfc;\n#endif\n\tstruct bpf_prog *xdp_prog;\n#ifdef CONFIG_DEBUG_FS\n\tstruct dpaa2_debugfs dbg;\n#endif\n\n\tstruct dpaa2_mac *mac;\n\t \n\tstruct mutex\t\tmac_lock;\n\tstruct workqueue_struct\t*dpaa2_ptp_wq;\n\tstruct work_struct\ttx_onestep_tstamp;\n\tstruct sk_buff_head\ttx_skbs;\n\t \n\tstruct mutex\t\tonestep_tstamp_lock;\n\tstruct devlink *devlink;\n\tstruct dpaa2_eth_trap_data *trap_data;\n\tstruct devlink_port devlink_port;\n\n\tu32 rx_copybreak;\n\n\tstruct dpaa2_eth_fds __percpu *fd;\n};\n\nstruct dpaa2_eth_devlink_priv {\n\tstruct dpaa2_eth_priv *dpaa2_priv;\n};\n\n#define TX_TSTAMP\t\t0x1\n#define TX_TSTAMP_ONESTEP_SYNC\t0x2\n\n#define DPAA2_RXH_SUPPORTED\t(RXH_L2DA | RXH_VLAN | RXH_L3_PROTO \\\n\t\t\t\t| RXH_IP_SRC | RXH_IP_DST | RXH_L4_B_0_1 \\\n\t\t\t\t| RXH_L4_B_2_3)\n\n \n#define DPAA2_RXH_DEFAULT\t(RXH_L3_PROTO | RXH_IP_SRC | RXH_IP_DST | \\\n\t\t\t\t RXH_L4_B_0_1 | RXH_L4_B_2_3)\n\n#define dpaa2_eth_hash_enabled(priv)\t\\\n\t((priv)->dpni_attrs.num_queues > 1)\n\n \n#define DPAA2_CLASSIFIER_DMA_SIZE 256\n\nextern const struct ethtool_ops dpaa2_ethtool_ops;\nextern int dpaa2_phc_index;\nextern struct ptp_qoriq *dpaa2_ptp;\n\nstatic inline int dpaa2_eth_cmp_dpni_ver(struct dpaa2_eth_priv *priv,\n\t\t\t\t\t u16 ver_major, u16 ver_minor)\n{\n\tif (priv->dpni_ver_major == ver_major)\n\t\treturn priv->dpni_ver_minor - ver_minor;\n\treturn priv->dpni_ver_major - ver_major;\n}\n\n \n#define DPNI_RX_DIST_KEY_VER_MAJOR\t7\n#define DPNI_RX_DIST_KEY_VER_MINOR\t5\n\n#define dpaa2_eth_has_legacy_dist(priv)\t\t\t\t\t\\\n\t(dpaa2_eth_cmp_dpni_ver((priv), DPNI_RX_DIST_KEY_VER_MAJOR,\t\\\n\t\t\t\tDPNI_RX_DIST_KEY_VER_MINOR) < 0)\n\n#define dpaa2_eth_fs_enabled(priv)\t\\\n\t(!((priv)->dpni_attrs.options & DPNI_OPT_NO_FS))\n\n#define dpaa2_eth_fs_mask_enabled(priv)\t\\\n\t((priv)->dpni_attrs.options & DPNI_OPT_HAS_KEY_MASKING)\n\n#define dpaa2_eth_fs_count(priv)        \\\n\t((priv)->dpni_attrs.fs_entries)\n\n#define dpaa2_eth_tc_count(priv)\t\\\n\t((priv)->dpni_attrs.num_tcs)\n\n \n#define dpaa2_eth_queue_count(priv)     \\\n\t((priv)->num_channels)\n\nenum dpaa2_eth_rx_dist {\n\tDPAA2_ETH_RX_DIST_HASH,\n\tDPAA2_ETH_RX_DIST_CLS\n};\n\n \n#define DPAA2_ETH_DIST_ETHDST\t\tBIT(0)\n#define DPAA2_ETH_DIST_ETHSRC\t\tBIT(1)\n#define DPAA2_ETH_DIST_ETHTYPE\t\tBIT(2)\n#define DPAA2_ETH_DIST_VLAN\t\tBIT(3)\n#define DPAA2_ETH_DIST_IPSRC\t\tBIT(4)\n#define DPAA2_ETH_DIST_IPDST\t\tBIT(5)\n#define DPAA2_ETH_DIST_IPPROTO\t\tBIT(6)\n#define DPAA2_ETH_DIST_L4SRC\t\tBIT(7)\n#define DPAA2_ETH_DIST_L4DST\t\tBIT(8)\n#define DPAA2_ETH_DIST_ALL\t\t(~0ULL)\n\n#define DPNI_PTP_ONESTEP_VER_MAJOR 8\n#define DPNI_PTP_ONESTEP_VER_MINOR 2\n#define DPAA2_ETH_FEATURE_ONESTEP_CFG_DIRECT BIT(0)\n#define DPAA2_PTP_SINGLE_STEP_ENABLE\tBIT(31)\n#define DPAA2_PTP_SINGLE_STEP_CH\tBIT(7)\n#define DPAA2_PTP_SINGLE_CORRECTION_OFF(v) ((v) << 8)\n\n#define DPNI_PAUSE_VER_MAJOR\t\t7\n#define DPNI_PAUSE_VER_MINOR\t\t13\n#define dpaa2_eth_has_pause_support(priv)\t\t\t\\\n\t(dpaa2_eth_cmp_dpni_ver((priv), DPNI_PAUSE_VER_MAJOR,\t\\\n\t\t\t\tDPNI_PAUSE_VER_MINOR) >= 0)\n\nstatic inline bool dpaa2_eth_tx_pause_enabled(u64 link_options)\n{\n\treturn !!(link_options & DPNI_LINK_OPT_PAUSE) ^\n\t       !!(link_options & DPNI_LINK_OPT_ASYM_PAUSE);\n}\n\nstatic inline bool dpaa2_eth_rx_pause_enabled(u64 link_options)\n{\n\treturn !!(link_options & DPNI_LINK_OPT_PAUSE);\n}\n\nstatic inline unsigned int dpaa2_eth_needed_headroom(struct sk_buff *skb)\n{\n\tunsigned int headroom = DPAA2_ETH_SWA_SIZE + DPAA2_ETH_TX_BUF_ALIGN;\n\n\t \n\tif (!skb)\n\t\treturn headroom;\n\n\t \n\tif (skb_is_nonlinear(skb))\n\t\treturn 0;\n\n\t \n\tif (skb->cb[0])\n\t\theadroom += DPAA2_ETH_TX_HWA_SIZE;\n\n\treturn headroom;\n}\n\n \nstatic inline unsigned int dpaa2_eth_rx_head_room(struct dpaa2_eth_priv *priv)\n{\n\treturn priv->tx_data_offset - DPAA2_ETH_RX_HWA_SIZE;\n}\n\nstatic inline bool dpaa2_eth_is_type_phy(struct dpaa2_eth_priv *priv)\n{\n\tlockdep_assert_held(&priv->mac_lock);\n\n\treturn dpaa2_mac_is_type_phy(priv->mac);\n}\n\nstatic inline bool dpaa2_eth_has_mac(struct dpaa2_eth_priv *priv)\n{\n\tlockdep_assert_held(&priv->mac_lock);\n\n\treturn priv->mac ? true : false;\n}\n\nint dpaa2_eth_set_hash(struct net_device *net_dev, u64 flags);\nint dpaa2_eth_set_cls(struct net_device *net_dev, u64 key);\nint dpaa2_eth_cls_key_size(u64 key);\nint dpaa2_eth_cls_fld_off(int prot, int field);\nvoid dpaa2_eth_cls_trim_rule(void *key_mem, u64 fields);\n\nvoid dpaa2_eth_set_rx_taildrop(struct dpaa2_eth_priv *priv,\n\t\t\t       bool tx_pause, bool pfc);\n\nextern const struct dcbnl_rtnl_ops dpaa2_eth_dcbnl_ops;\n\nint dpaa2_eth_dl_alloc(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_dl_free(struct dpaa2_eth_priv *priv);\n\nvoid dpaa2_eth_dl_register(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_dl_unregister(struct dpaa2_eth_priv *priv);\n\nint dpaa2_eth_dl_port_add(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_dl_port_del(struct dpaa2_eth_priv *priv);\n\nint dpaa2_eth_dl_traps_register(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_dl_traps_unregister(struct dpaa2_eth_priv *priv);\n\nstruct dpaa2_eth_trap_item *dpaa2_eth_dl_get_trap(struct dpaa2_eth_priv *priv,\n\t\t\t\t\t\t  struct dpaa2_fapr *fapr);\n\nstruct dpaa2_eth_bp *dpaa2_eth_allocate_dpbp(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_free_dpbp(struct dpaa2_eth_priv *priv, struct dpaa2_eth_bp *bp);\n\nstruct sk_buff *dpaa2_eth_alloc_skb(struct dpaa2_eth_priv *priv,\n\t\t\t\t    struct dpaa2_eth_channel *ch,\n\t\t\t\t    const struct dpaa2_fd *fd, u32 fd_length,\n\t\t\t\t    void *fd_vaddr);\n\nvoid dpaa2_eth_receive_skb(struct dpaa2_eth_priv *priv,\n\t\t\t   struct dpaa2_eth_channel *ch,\n\t\t\t   const struct dpaa2_fd *fd, void *vaddr,\n\t\t\t   struct dpaa2_eth_fq *fq,\n\t\t\t   struct rtnl_link_stats64 *percpu_stats,\n\t\t\t   struct sk_buff *skb);\n\nvoid dpaa2_eth_rx(struct dpaa2_eth_priv *priv,\n\t\t  struct dpaa2_eth_channel *ch,\n\t\t  const struct dpaa2_fd *fd,\n\t\t  struct dpaa2_eth_fq *fq);\n\nstruct dpaa2_eth_bp *dpaa2_eth_allocate_dpbp(struct dpaa2_eth_priv *priv);\nvoid dpaa2_eth_free_dpbp(struct dpaa2_eth_priv *priv,\n\t\t\t struct dpaa2_eth_bp *bp);\n\nvoid *dpaa2_iova_to_virt(struct iommu_domain *domain, dma_addr_t iova_addr);\nvoid dpaa2_eth_recycle_buf(struct dpaa2_eth_priv *priv,\n\t\t\t   struct dpaa2_eth_channel *ch,\n\t\t\t   dma_addr_t addr);\n\nvoid dpaa2_eth_xdp_enqueue(struct dpaa2_eth_priv *priv,\n\t\t\t   struct dpaa2_eth_channel *ch,\n\t\t\t   struct dpaa2_fd *fd,\n\t\t\t   void *buf_start, u16 queue_id);\n\nint dpaa2_xsk_wakeup(struct net_device *dev, u32 qid, u32 flags);\nint dpaa2_xsk_setup_pool(struct net_device *dev, struct xsk_buff_pool *pool, u16 qid);\n\nvoid dpaa2_eth_free_tx_fd(struct dpaa2_eth_priv *priv,\n\t\t\t  struct dpaa2_eth_channel *ch,\n\t\t\t  struct dpaa2_eth_fq *fq,\n\t\t\t  const struct dpaa2_fd *fd, bool in_napi);\nbool dpaa2_xsk_tx(struct dpaa2_eth_priv *priv,\n\t\t  struct dpaa2_eth_channel *ch);\n\n \nvoid *dpaa2_eth_sgt_get(struct dpaa2_eth_priv *priv);\n\nvoid dpaa2_eth_sgt_recycle(struct dpaa2_eth_priv *priv, void *sgt_buf);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}