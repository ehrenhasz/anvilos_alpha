{
  "module_name": "gianfar.h",
  "hash_id": "919630705807b73114e391cb7b7b1dd914d6e2f0b2336d8893dae6fe5d9da085",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/freescale/gianfar.h",
  "human_readable_source": " \n \n#ifndef __GIANFAR_H\n#define __GIANFAR_H\n\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/netdevice.h>\n#include <linux/etherdevice.h>\n#include <linux/skbuff.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/mii.h>\n#include <linux/phy.h>\n\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n#include <linux/crc32.h>\n#include <linux/workqueue.h>\n#include <linux/ethtool.h>\n\nstruct ethtool_flow_spec_container {\n\tstruct ethtool_rx_flow_spec fs;\n\tstruct list_head list;\n};\n\nstruct ethtool_rx_list {\n\tstruct list_head list;\n\tunsigned int count;\n};\n\n \n#define GMAC_FCB_LEN 8\n\n \n#define GMAC_TXPAL_LEN 16\n\n \n#define DEFAULT_PADDING 2\n\n \n#define RXBUF_ALIGNMENT 64\n\n#define DRV_NAME \"gfar-enet\"\n\n \n#define MAX_TX_QS\t0x8\n#define MAX_RX_QS\t0x8\n\n \n#define MAXGROUPS 0x2\n\n \n#define DEFAULT_TX_RING_SIZE\t256\n#define DEFAULT_RX_RING_SIZE\t256\n\n#define GFAR_RX_BUFF_ALLOC\t16\n\n#define GFAR_RX_MAX_RING_SIZE   256\n#define GFAR_TX_MAX_RING_SIZE   256\n\n#define FBTHR_SHIFT        24\n#define DEFAULT_RX_LFC_THR  16\n#define DEFAULT_LFC_PTVVAL  4\n\n#define GFAR_RXB_TRUESIZE 2048\n#define GFAR_SKBFRAG_OVR (RXBUF_ALIGNMENT \\\n\t\t\t  + SKB_DATA_ALIGN(sizeof(struct skb_shared_info)))\n#define GFAR_RXB_SIZE rounddown(GFAR_RXB_TRUESIZE - GFAR_SKBFRAG_OVR, 64)\n#define GFAR_SKBFRAG_SIZE (GFAR_RXB_SIZE + GFAR_SKBFRAG_OVR)\n\n#define TX_RING_MOD_MASK(size) (size-1)\n#define RX_RING_MOD_MASK(size) (size-1)\n#define GFAR_JUMBO_FRAME_SIZE 9600\n\n#define DEFAULT_FIFO_TX_THR 0x100\n#define DEFAULT_FIFO_TX_STARVE 0x40\n#define DEFAULT_FIFO_TX_STARVE_OFF 0x80\n\n \n#define GFAR_EM_NUM\t15\n\n \n \n#define GFAR_GBIT_TIME  512\n#define GFAR_100_TIME   2560\n#define GFAR_10_TIME    25600\n\n#define DEFAULT_TX_COALESCE 1\n#define DEFAULT_TXCOUNT\t16\n#define DEFAULT_TXTIME\t21\n\n#define DEFAULT_RXTIME\t21\n\n#define DEFAULT_RX_COALESCE 0\n#define DEFAULT_RXCOUNT\t0\n\n \n#define MII_TBICON\t\t0x11\n\n \n#define TBICON_CLK_SELECT\t0x0020\n\n \n#define MACCFG1_SOFT_RESET\t0x80000000\n#define MACCFG1_RESET_RX_MC\t0x00080000\n#define MACCFG1_RESET_TX_MC\t0x00040000\n#define MACCFG1_RESET_RX_FUN\t0x00020000\n#define\tMACCFG1_RESET_TX_FUN\t0x00010000\n#define MACCFG1_LOOPBACK\t0x00000100\n#define MACCFG1_RX_FLOW\t\t0x00000020\n#define MACCFG1_TX_FLOW\t\t0x00000010\n#define MACCFG1_SYNCD_RX_EN\t0x00000008\n#define MACCFG1_RX_EN\t\t0x00000004\n#define MACCFG1_SYNCD_TX_EN\t0x00000002\n#define MACCFG1_TX_EN\t\t0x00000001\n\n#define MACCFG2_INIT_SETTINGS\t0x00007205\n#define MACCFG2_FULL_DUPLEX\t0x00000001\n#define MACCFG2_IF              0x00000300\n#define MACCFG2_MII             0x00000100\n#define MACCFG2_GMII            0x00000200\n#define MACCFG2_HUGEFRAME\t0x00000020\n#define MACCFG2_LENGTHCHECK\t0x00000010\n#define MACCFG2_MPEN\t\t0x00000008\n\n#define ECNTRL_FIFM\t\t0x00008000\n#define ECNTRL_INIT_SETTINGS\t0x00001000\n#define ECNTRL_TBI_MODE         0x00000020\n#define ECNTRL_REDUCED_MODE\t0x00000010\n#define ECNTRL_R100\t\t0x00000008\n#define ECNTRL_REDUCED_MII_MODE\t0x00000004\n#define ECNTRL_SGMII_MODE\t0x00000002\n\n#define MINFLR_INIT_SETTINGS\t0x00000040\n\n \n#define TQUEUE_EN0\t\t0x00008000\n#define TQUEUE_EN1\t\t0x00004000\n#define TQUEUE_EN2\t\t0x00002000\n#define TQUEUE_EN3\t\t0x00001000\n#define TQUEUE_EN4\t\t0x00000800\n#define TQUEUE_EN5\t\t0x00000400\n#define TQUEUE_EN6\t\t0x00000200\n#define TQUEUE_EN7\t\t0x00000100\n#define TQUEUE_EN_ALL\t\t0x0000FF00\n\n#define TR03WT_WT0_MASK\t\t0xFF000000\n#define TR03WT_WT1_MASK\t\t0x00FF0000\n#define TR03WT_WT2_MASK\t\t0x0000FF00\n#define TR03WT_WT3_MASK\t\t0x000000FF\n\n#define TR47WT_WT4_MASK\t\t0xFF000000\n#define TR47WT_WT5_MASK\t\t0x00FF0000\n#define TR47WT_WT6_MASK\t\t0x0000FF00\n#define TR47WT_WT7_MASK\t\t0x000000FF\n\n \n#define RQUEUE_EX0\t\t0x00800000\n#define RQUEUE_EX1\t\t0x00400000\n#define RQUEUE_EX2\t\t0x00200000\n#define RQUEUE_EX3\t\t0x00100000\n#define RQUEUE_EX4\t\t0x00080000\n#define RQUEUE_EX5\t\t0x00040000\n#define RQUEUE_EX6\t\t0x00020000\n#define RQUEUE_EX7\t\t0x00010000\n#define RQUEUE_EX_ALL\t\t0x00FF0000\n\n#define RQUEUE_EN0\t\t0x00000080\n#define RQUEUE_EN1\t\t0x00000040\n#define RQUEUE_EN2\t\t0x00000020\n#define RQUEUE_EN3\t\t0x00000010\n#define RQUEUE_EN4\t\t0x00000008\n#define RQUEUE_EN5\t\t0x00000004\n#define RQUEUE_EN6\t\t0x00000002\n#define RQUEUE_EN7\t\t0x00000001\n#define RQUEUE_EN_ALL\t\t0x000000FF\n\n \n#define DMACTRL_INIT_SETTINGS   0x000000c3\n#define DMACTRL_GRS             0x00000010\n#define DMACTRL_GTS             0x00000008\n\n#define TSTAT_CLEAR_THALT_ALL\t0xFF000000\n#define TSTAT_CLEAR_THALT\t0x80000000\n#define TSTAT_CLEAR_THALT0\t0x80000000\n#define TSTAT_CLEAR_THALT1\t0x40000000\n#define TSTAT_CLEAR_THALT2\t0x20000000\n#define TSTAT_CLEAR_THALT3\t0x10000000\n#define TSTAT_CLEAR_THALT4\t0x08000000\n#define TSTAT_CLEAR_THALT5\t0x04000000\n#define TSTAT_CLEAR_THALT6\t0x02000000\n#define TSTAT_CLEAR_THALT7\t0x01000000\n\n \n#define IC_ICEN\t\t\t0x80000000\n#define IC_ICFT_MASK\t\t0x1fe00000\n#define IC_ICFT_SHIFT\t\t21\n#define mk_ic_icft(x)\t\t\\\n\t(((unsigned int)x << IC_ICFT_SHIFT)&IC_ICFT_MASK)\n#define IC_ICTT_MASK\t\t0x0000ffff\n#define mk_ic_ictt(x)\t\t(x&IC_ICTT_MASK)\n\n#define mk_ic_value(count, time) (IC_ICEN | \\\n\t\t\t\tmk_ic_icft(count) | \\\n\t\t\t\tmk_ic_ictt(time))\n#define get_icft_value(ic)\t(((unsigned long)ic & IC_ICFT_MASK) >> \\\n\t\t\t\t IC_ICFT_SHIFT)\n#define get_ictt_value(ic)\t((unsigned long)ic & IC_ICTT_MASK)\n\n#define DEFAULT_TXIC mk_ic_value(DEFAULT_TXCOUNT, DEFAULT_TXTIME)\n#define DEFAULT_RXIC mk_ic_value(DEFAULT_RXCOUNT, DEFAULT_RXTIME)\n\n#define RCTRL_TS_ENABLE \t0x01000000\n#define RCTRL_PAL_MASK\t\t0x001f0000\n#define RCTRL_LFC\t\t0x00004000\n#define RCTRL_VLEX\t\t0x00002000\n#define RCTRL_FILREN\t\t0x00001000\n#define RCTRL_GHTX\t\t0x00000400\n#define RCTRL_IPCSEN\t\t0x00000200\n#define RCTRL_TUCSEN\t\t0x00000100\n#define RCTRL_PRSDEP_MASK\t0x000000c0\n#define RCTRL_PRSDEP_INIT\t0x000000c0\n#define RCTRL_PRSFM\t\t0x00000020\n#define RCTRL_PROM\t\t0x00000008\n#define RCTRL_EMEN\t\t0x00000002\n#define RCTRL_REQ_PARSER\t(RCTRL_VLEX | RCTRL_IPCSEN | \\\n\t\t\t\t RCTRL_TUCSEN | RCTRL_FILREN)\n#define RCTRL_CHECKSUMMING\t(RCTRL_IPCSEN | RCTRL_TUCSEN | \\\n\t\t\t\tRCTRL_PRSDEP_INIT)\n#define RCTRL_EXTHASH\t\t(RCTRL_GHTX)\n#define RCTRL_VLAN\t\t(RCTRL_PRSDEP_INIT)\n#define RCTRL_PADDING(x)\t((x << 16) & RCTRL_PAL_MASK)\n\n\n#define RSTAT_CLEAR_RHALT\t0x00800000\n#define RSTAT_CLEAR_RXF0\t0x00000080\n#define RSTAT_RXF_MASK\t\t0x000000ff\n\n#define TCTRL_IPCSEN\t\t0x00004000\n#define TCTRL_TUCSEN\t\t0x00002000\n#define TCTRL_VLINS\t\t0x00001000\n#define TCTRL_THDF\t\t0x00000800\n#define TCTRL_RFCPAUSE\t\t0x00000010\n#define TCTRL_TFCPAUSE\t\t0x00000008\n#define TCTRL_TXSCHED_MASK\t0x00000006\n#define TCTRL_TXSCHED_INIT\t0x00000000\n \n#define TCTRL_TXSCHED_PRIO\t0x00000002\n \n#define TCTRL_TXSCHED_WRRS\t0x00000004\n \n#define DEFAULT_WRRS_WEIGHT\t0x18181818\n\n#define TCTRL_INIT_CSUM\t\t(TCTRL_TUCSEN | TCTRL_IPCSEN)\n\n#define IEVENT_INIT_CLEAR\t0xffffffff\n#define IEVENT_BABR\t\t0x80000000\n#define IEVENT_RXC\t\t0x40000000\n#define IEVENT_BSY\t\t0x20000000\n#define IEVENT_EBERR\t\t0x10000000\n#define IEVENT_MSRO\t\t0x04000000\n#define IEVENT_GTSC\t\t0x02000000\n#define IEVENT_BABT\t\t0x01000000\n#define IEVENT_TXC\t\t0x00800000\n#define IEVENT_TXE\t\t0x00400000\n#define IEVENT_TXB\t\t0x00200000\n#define IEVENT_TXF\t\t0x00100000\n#define IEVENT_LC\t\t0x00040000\n#define IEVENT_CRL\t\t0x00020000\n#define IEVENT_XFUN\t\t0x00010000\n#define IEVENT_RXB0\t\t0x00008000\n#define IEVENT_MAG\t\t0x00000800\n#define IEVENT_GRSC\t\t0x00000100\n#define IEVENT_RXF0\t\t0x00000080\n#define IEVENT_FGPI\t\t0x00000010\n#define IEVENT_FIR\t\t0x00000008\n#define IEVENT_FIQ\t\t0x00000004\n#define IEVENT_DPE\t\t0x00000002\n#define IEVENT_PERR\t\t0x00000001\n#define IEVENT_RX_MASK          (IEVENT_RXB0 | IEVENT_RXF0 | IEVENT_BSY)\n#define IEVENT_TX_MASK          (IEVENT_TXB | IEVENT_TXF)\n#define IEVENT_RTX_MASK         (IEVENT_RX_MASK | IEVENT_TX_MASK)\n#define IEVENT_ERR_MASK         \\\n(IEVENT_RXC | IEVENT_BSY | IEVENT_EBERR | IEVENT_MSRO | \\\n IEVENT_BABT | IEVENT_TXC | IEVENT_TXE | IEVENT_LC \\\n | IEVENT_CRL | IEVENT_XFUN | IEVENT_DPE | IEVENT_PERR \\\n | IEVENT_MAG | IEVENT_BABR)\n\n#define IMASK_INIT_CLEAR\t0x00000000\n#define IMASK_BABR              0x80000000\n#define IMASK_RXC               0x40000000\n#define IMASK_BSY               0x20000000\n#define IMASK_EBERR             0x10000000\n#define IMASK_MSRO\t\t0x04000000\n#define IMASK_GTSC              0x02000000\n#define IMASK_BABT\t\t0x01000000\n#define IMASK_TXC               0x00800000\n#define IMASK_TXEEN\t\t0x00400000\n#define IMASK_TXBEN\t\t0x00200000\n#define IMASK_TXFEN             0x00100000\n#define IMASK_LC\t\t0x00040000\n#define IMASK_CRL\t\t0x00020000\n#define IMASK_XFUN\t\t0x00010000\n#define IMASK_RXB0              0x00008000\n#define IMASK_MAG\t\t0x00000800\n#define IMASK_GRSC              0x00000100\n#define IMASK_RXFEN0\t\t0x00000080\n#define IMASK_FGPI\t\t0x00000010\n#define IMASK_FIR\t\t0x00000008\n#define IMASK_FIQ\t\t0x00000004\n#define IMASK_DPE\t\t0x00000002\n#define IMASK_PERR\t\t0x00000001\n#define IMASK_DEFAULT  (IMASK_TXEEN | IMASK_TXFEN | IMASK_TXBEN | \\\n\t\tIMASK_RXFEN0 | IMASK_BSY | IMASK_EBERR | IMASK_BABR | \\\n\t\tIMASK_XFUN | IMASK_RXC | IMASK_BABT | IMASK_DPE \\\n\t\t| IMASK_PERR)\n#define IMASK_RX_DEFAULT (IMASK_RXFEN0 | IMASK_BSY)\n#define IMASK_TX_DEFAULT (IMASK_TXFEN | IMASK_TXBEN)\n\n#define IMASK_RX_DISABLED ((~(IMASK_RX_DEFAULT)) & IMASK_DEFAULT)\n#define IMASK_TX_DISABLED ((~(IMASK_TX_DEFAULT)) & IMASK_DEFAULT)\n\n \n\n \n#define ATTR_BDSTASH\t\t0x00000800\n\n#define ATTR_BUFSTASH\t\t0x00004000\n\n#define ATTR_SNOOPING\t\t0x000000c0\n#define ATTR_INIT_SETTINGS      ATTR_SNOOPING\n\n#define ATTRELI_INIT_SETTINGS   0x0\n#define ATTRELI_EL_MASK\t\t0x3fff0000\n#define ATTRELI_EL(x) (x << 16)\n#define ATTRELI_EI_MASK\t\t0x00003fff\n#define ATTRELI_EI(x) (x)\n\n#define BD_LFLAG(flags) ((flags) << 16)\n#define BD_LENGTH_MASK\t\t0x0000ffff\n\n#define FPR_FILER_MASK\t0xFFFFFFFF\n#define MAX_FILER_IDX\t0xFF\n\n \n#define DEFAULT_8RXQ_RIR0\t0x05397700\n \n#define DEFAULT_2RXQ_RIR0\t0x04104100\n\n \n#define RQFCR_GPI\t\t0x80000000\n#define RQFCR_HASHTBL_Q\t\t0x00000000\n#define RQFCR_HASHTBL_0\t\t0x00020000\n#define RQFCR_HASHTBL_1\t\t0x00040000\n#define RQFCR_HASHTBL_2\t\t0x00060000\n#define RQFCR_HASHTBL_3\t\t0x00080000\n#define RQFCR_HASH\t\t0x00010000\n#define RQFCR_QUEUE\t\t0x0000FC00\n#define RQFCR_CLE\t\t0x00000200\n#define RQFCR_RJE\t\t0x00000100\n#define RQFCR_AND\t\t0x00000080\n#define RQFCR_CMP_EXACT\t\t0x00000000\n#define RQFCR_CMP_MATCH\t\t0x00000020\n#define RQFCR_CMP_NOEXACT\t0x00000040\n#define RQFCR_CMP_NOMATCH\t0x00000060\n\n \n#define\tRQFCR_PID_MASK\t\t0x00000000\n#define\tRQFCR_PID_PARSE\t\t0x00000001\n#define\tRQFCR_PID_ARB\t\t0x00000002\n#define\tRQFCR_PID_DAH\t\t0x00000003\n#define\tRQFCR_PID_DAL\t\t0x00000004\n#define\tRQFCR_PID_SAH\t\t0x00000005\n#define\tRQFCR_PID_SAL\t\t0x00000006\n#define\tRQFCR_PID_ETY\t\t0x00000007\n#define\tRQFCR_PID_VID\t\t0x00000008\n#define\tRQFCR_PID_PRI\t\t0x00000009\n#define\tRQFCR_PID_TOS\t\t0x0000000A\n#define\tRQFCR_PID_L4P\t\t0x0000000B\n#define\tRQFCR_PID_DIA\t\t0x0000000C\n#define\tRQFCR_PID_SIA\t\t0x0000000D\n#define\tRQFCR_PID_DPT\t\t0x0000000E\n#define\tRQFCR_PID_SPT\t\t0x0000000F\n\n \n#define RQFPR_HDR_GE_512\t0x00200000\n#define RQFPR_LERR\t\t0x00100000\n#define RQFPR_RAR\t\t0x00080000\n#define RQFPR_RARQ\t\t0x00040000\n#define RQFPR_AR\t\t0x00020000\n#define RQFPR_ARQ\t\t0x00010000\n#define RQFPR_EBC\t\t0x00008000\n#define RQFPR_VLN\t\t0x00004000\n#define RQFPR_CFI\t\t0x00002000\n#define RQFPR_JUM\t\t0x00001000\n#define RQFPR_IPF\t\t0x00000800\n#define RQFPR_FIF\t\t0x00000400\n#define RQFPR_IPV4\t\t0x00000200\n#define RQFPR_IPV6\t\t0x00000100\n#define RQFPR_ICC\t\t0x00000080\n#define RQFPR_ICV\t\t0x00000040\n#define RQFPR_TCP\t\t0x00000020\n#define RQFPR_UDP\t\t0x00000010\n#define RQFPR_TUC\t\t0x00000008\n#define RQFPR_TUV\t\t0x00000004\n#define RQFPR_PER\t\t0x00000002\n#define RQFPR_EER\t\t0x00000001\n\n \n#define CAR1_C164\t\t0x80000000\n#define CAR1_C1127\t\t0x40000000\n#define CAR1_C1255\t\t0x20000000\n#define CAR1_C1511\t\t0x10000000\n#define CAR1_C11K\t\t0x08000000\n#define CAR1_C1MAX\t\t0x04000000\n#define CAR1_C1MGV\t\t0x02000000\n#define CAR1_C1REJ\t\t0x00020000\n#define CAR1_C1RBY\t\t0x00010000\n#define CAR1_C1RPK\t\t0x00008000\n#define CAR1_C1RFC\t\t0x00004000\n#define CAR1_C1RMC\t\t0x00002000\n#define CAR1_C1RBC\t\t0x00001000\n#define CAR1_C1RXC\t\t0x00000800\n#define CAR1_C1RXP\t\t0x00000400\n#define CAR1_C1RXU\t\t0x00000200\n#define CAR1_C1RAL\t\t0x00000100\n#define CAR1_C1RFL\t\t0x00000080\n#define CAR1_C1RCD\t\t0x00000040\n#define CAR1_C1RCS\t\t0x00000020\n#define CAR1_C1RUN\t\t0x00000010\n#define CAR1_C1ROV\t\t0x00000008\n#define CAR1_C1RFR\t\t0x00000004\n#define CAR1_C1RJB\t\t0x00000002\n#define CAR1_C1RDR\t\t0x00000001\n\n \n#define CAM1_M164\t\t0x80000000\n#define CAM1_M1127\t\t0x40000000\n#define CAM1_M1255\t\t0x20000000\n#define CAM1_M1511\t\t0x10000000\n#define CAM1_M11K\t\t0x08000000\n#define CAM1_M1MAX\t\t0x04000000\n#define CAM1_M1MGV\t\t0x02000000\n#define CAM1_M1REJ\t\t0x00020000\n#define CAM1_M1RBY\t\t0x00010000\n#define CAM1_M1RPK\t\t0x00008000\n#define CAM1_M1RFC\t\t0x00004000\n#define CAM1_M1RMC\t\t0x00002000\n#define CAM1_M1RBC\t\t0x00001000\n#define CAM1_M1RXC\t\t0x00000800\n#define CAM1_M1RXP\t\t0x00000400\n#define CAM1_M1RXU\t\t0x00000200\n#define CAM1_M1RAL\t\t0x00000100\n#define CAM1_M1RFL\t\t0x00000080\n#define CAM1_M1RCD\t\t0x00000040\n#define CAM1_M1RCS\t\t0x00000020\n#define CAM1_M1RUN\t\t0x00000010\n#define CAM1_M1ROV\t\t0x00000008\n#define CAM1_M1RFR\t\t0x00000004\n#define CAM1_M1RJB\t\t0x00000002\n#define CAM1_M1RDR\t\t0x00000001\n\n \n#define TXBD_READY\t\t0x8000\n#define TXBD_PADCRC\t\t0x4000\n#define TXBD_WRAP\t\t0x2000\n#define TXBD_INTERRUPT\t\t0x1000\n#define TXBD_LAST\t\t0x0800\n#define TXBD_CRC\t\t0x0400\n#define TXBD_DEF\t\t0x0200\n#define TXBD_HUGEFRAME\t\t0x0080\n#define TXBD_LATECOLLISION\t0x0080\n#define TXBD_RETRYLIMIT\t\t0x0040\n#define\tTXBD_RETRYCOUNTMASK\t0x003c\n#define TXBD_UNDERRUN\t\t0x0002\n#define TXBD_TOE\t\t0x0002\n\n \n#define TXFCB_VLN\t\t0x80\n#define TXFCB_IP\t\t0x40\n#define TXFCB_IP6\t\t0x20\n#define TXFCB_TUP\t\t0x10\n#define TXFCB_UDP\t\t0x08\n#define TXFCB_CIP\t\t0x04\n#define TXFCB_CTU\t\t0x02\n#define TXFCB_NPH\t\t0x01\n#define TXFCB_DEFAULT \t\t(TXFCB_IP|TXFCB_TUP|TXFCB_CTU|TXFCB_NPH)\n\n \n#define RXBD_EMPTY\t\t0x8000\n#define RXBD_RO1\t\t0x4000\n#define RXBD_WRAP\t\t0x2000\n#define RXBD_INTERRUPT\t\t0x1000\n#define RXBD_LAST\t\t0x0800\n#define RXBD_FIRST\t\t0x0400\n#define RXBD_MISS\t\t0x0100\n#define RXBD_BROADCAST\t\t0x0080\n#define RXBD_MULTICAST\t\t0x0040\n#define RXBD_LARGE\t\t0x0020\n#define RXBD_NONOCTET\t\t0x0010\n#define RXBD_SHORT\t\t0x0008\n#define RXBD_CRCERR\t\t0x0004\n#define RXBD_OVERRUN\t\t0x0002\n#define RXBD_TRUNCATED\t\t0x0001\n#define RXBD_STATS\t\t0x01ff\n#define RXBD_ERR\t\t(RXBD_LARGE | RXBD_SHORT | RXBD_NONOCTET \t\\\n\t\t\t\t| RXBD_CRCERR | RXBD_OVERRUN\t\t\t\\\n\t\t\t\t| RXBD_TRUNCATED)\n\n \n#define RXFCB_VLN\t\t0x8000\n#define RXFCB_IP\t\t0x4000\n#define RXFCB_IP6\t\t0x2000\n#define RXFCB_TUP\t\t0x1000\n#define RXFCB_CIP\t\t0x0800\n#define RXFCB_CTU\t\t0x0400\n#define RXFCB_EIP\t\t0x0200\n#define RXFCB_ETU\t\t0x0100\n#define RXFCB_CSUM_MASK\t\t0x0f00\n#define RXFCB_PERR_MASK\t\t0x000c\n#define RXFCB_PERR_BADL3\t0x0008\n\n#define GFAR_INT_NAME_MAX\t(IFNAMSIZ + 6)\t \n\n#define GFAR_WOL_MAGIC\t\t0x00000001\n#define GFAR_WOL_FILER_UCAST\t0x00000002\n\nstruct txbd8\n{\n\tunion {\n\t\tstruct {\n\t\t\t__be16\tstatus;\t \n\t\t\t__be16\tlength;\t \n\t\t};\n\t\t__be32 lstatus;\n\t};\n\t__be32\tbufPtr;\t \n};\n\nstruct txfcb {\n\tu8\tflags;\n\tu8\tptp;     \n\tu8\tl4os;\t \n\tu8\tl3os; \t \n\t__be16\tphcs;\t \n\t__be16\tvlctl;\t \n};\n\nstruct rxbd8\n{\n\tunion {\n\t\tstruct {\n\t\t\t__be16\tstatus;\t \n\t\t\t__be16\tlength;\t \n\t\t};\n\t\t__be32 lstatus;\n\t};\n\t__be32\tbufPtr;\t \n};\n\nstruct rxfcb {\n\t__be16\tflags;\n\tu8\trq;\t \n\tu8\tpro;\t \n\tu16\treserved;\n\t__be16\tvlctl;\t \n};\n\nstruct gianfar_skb_cb {\n\tunsigned int bytes_sent;  \n};\n\n#define GFAR_CB(skb) ((struct gianfar_skb_cb *)((skb)->cb))\n\nstruct rmon_mib\n{\n\tu32\ttr64;\t \n\tu32\ttr127;\t \n\tu32\ttr255;\t \n\tu32\ttr511;\t \n\tu32\ttr1k;\t \n\tu32\ttrmax;\t \n\tu32\ttrmgv;\t \n\tu32\trbyt;\t \n\tu32\trpkt;\t \n\tu32\trfcs;\t \n\tu32\trmca;\t \n\tu32\trbca;\t \n\tu32\trxcf;\t \n\tu32\trxpf;\t \n\tu32\trxuo;\t \n\tu32\traln;\t \n\tu32\trflr;\t \n\tu32\trcde;\t \n\tu32\trcse;\t \n\tu32\trund;\t \n\tu32\trovr;\t \n\tu32\trfrg;\t \n\tu32\trjbr;\t \n\tu32\trdrp;\t \n\tu32\ttbyt;\t \n\tu32\ttpkt;\t \n\tu32\ttmca;\t \n\tu32\ttbca;\t \n\tu32\ttxpf;\t \n\tu32\ttdfr;\t \n\tu32\ttedf;\t \n\tu32\ttscl;\t \n\tu32\ttmcl;\t \n\tu32\ttlcl;\t \n\tu32\ttxcl;\t \n\tu32\ttncl;\t \n\tu8\tres1[4];\n\tu32\ttdrp;\t \n\tu32\ttjbr;\t \n\tu32\ttfcs;\t \n\tu32\ttxcf;\t \n\tu32\ttovr;\t \n\tu32\ttund;\t \n\tu32\ttfrg;\t \n\tu32\tcar1;\t \n\tu32\tcar2;\t \n\tu32\tcam1;\t \n\tu32\tcam2;\t \n};\n\nstruct rmon_overflow {\n\t \n\tspinlock_t lock;\n\tu32\timask;\n\tu64\trdrp;\n};\n\nstruct gfar_extra_stats {\n\tatomic64_t rx_alloc_err;\n\tatomic64_t rx_large;\n\tatomic64_t rx_short;\n\tatomic64_t rx_nonoctet;\n\tatomic64_t rx_crcerr;\n\tatomic64_t rx_overrun;\n\tatomic64_t rx_bsy;\n\tatomic64_t rx_babr;\n\tatomic64_t rx_trunc;\n\tatomic64_t eberr;\n\tatomic64_t tx_babt;\n\tatomic64_t tx_underrun;\n\tatomic64_t tx_timeout;\n};\n\n#define GFAR_RMON_LEN ((sizeof(struct rmon_mib) - 16)/sizeof(u32))\n#define GFAR_EXTRA_STATS_LEN \\\n\t(sizeof(struct gfar_extra_stats)/sizeof(atomic64_t))\n\n \n#define GFAR_STATS_LEN (GFAR_RMON_LEN + GFAR_EXTRA_STATS_LEN)\n\nstruct gfar {\n\tu32\ttsec_id;\t \n\tu32\ttsec_id2;\t \n\tu8\tres1[8];\n\tu32\tievent;\t\t \n\tu32\timask;\t\t \n\tu32\tedis;\t\t \n\tu32\temapg;\t\t \n\tu32\tecntrl;\t\t \n\tu32\tminflr;\t\t \n\tu32\tptv;\t\t \n\tu32\tdmactrl;\t \n\tu32\ttbipa;\t\t \n\tu8\tres2[28];\n\tu32\tfifo_rx_pause;\t \n\tu32\tfifo_rx_pause_shutoff;\t \n\tu32\tfifo_rx_alarm;\t \n\tu32\tfifo_rx_alarm_shutoff;\t \n\tu8\tres3[44];\n\tu32\tfifo_tx_thr;\t \n\tu8\tres4[8];\n\tu32\tfifo_tx_starve;\t \n\tu32\tfifo_tx_starve_shutoff;\t \n\tu8\tres5[96];\n\tu32\ttctrl;\t\t \n\tu32\ttstat;\t\t \n\tu32\tdfvlan;\t\t \n\tu32\ttbdlen;\t\t \n\tu32\ttxic;\t\t \n\tu32\ttqueue;\t\t \n\tu8\tres7[40];\n\tu32\ttr03wt;\t\t \n\tu32\ttr47wt;\t\t \n\tu8\tres8[52];\n\tu32\ttbdbph;\t\t \n\tu8\tres9a[4];\n\tu32\ttbptr0;\t\t \n\tu8\tres9b[4];\n\tu32\ttbptr1;\t\t \n\tu8\tres9c[4];\n\tu32\ttbptr2;\t\t \n\tu8\tres9d[4];\n\tu32\ttbptr3;\t\t \n\tu8\tres9e[4];\n\tu32\ttbptr4;\t\t \n\tu8\tres9f[4];\n\tu32\ttbptr5;\t\t \n\tu8\tres9g[4];\n\tu32\ttbptr6;\t\t \n\tu8\tres9h[4];\n\tu32\ttbptr7;\t\t \n\tu8\tres9[64];\n\tu32\ttbaseh;\t\t \n\tu32\ttbase0;\t\t \n\tu8\tres10a[4];\n\tu32\ttbase1;\t\t \n\tu8\tres10b[4];\n\tu32\ttbase2;\t\t \n\tu8\tres10c[4];\n\tu32\ttbase3;\t\t \n\tu8\tres10d[4];\n\tu32\ttbase4;\t\t \n\tu8\tres10e[4];\n\tu32\ttbase5;\t\t \n\tu8\tres10f[4];\n\tu32\ttbase6;\t\t \n\tu8\tres10g[4];\n\tu32\ttbase7;\t\t \n\tu8\tres10[192];\n\tu32\trctrl;\t\t \n\tu32\trstat;\t\t \n\tu8\tres12[8];\n\tu32\trxic;\t\t \n\tu32\trqueue;\t\t \n\tu32\trir0;\t\t \n\tu32\trir1;\t\t \n\tu32\trir2;\t\t \n\tu32\trir3;\t\t \n\tu8\tres13[8];\n\tu32\trbifx;\t\t \n\tu32\trqfar;\t\t \n\tu32\trqfcr;\t\t \n\tu32\trqfpr;\t\t \n\tu32\tmrblr;\t\t \n\tu8\tres14[56];\n\tu32\trbdbph;\t\t \n\tu8\tres15a[4];\n\tu32\trbptr0;\t\t \n\tu8\tres15b[4];\n\tu32\trbptr1;\t\t \n\tu8\tres15c[4];\n\tu32\trbptr2;\t\t \n\tu8\tres15d[4];\n\tu32\trbptr3;\t\t \n\tu8\tres15e[4];\n\tu32\trbptr4;\t\t \n\tu8\tres15f[4];\n\tu32\trbptr5;\t\t \n\tu8\tres15g[4];\n\tu32\trbptr6;\t\t \n\tu8\tres15h[4];\n\tu32\trbptr7;\t\t \n\tu8\tres16[64];\n\tu32\trbaseh;\t\t \n\tu32\trbase0;\t\t \n\tu8\tres17a[4];\n\tu32\trbase1;\t\t \n\tu8\tres17b[4];\n\tu32\trbase2;\t\t \n\tu8\tres17c[4];\n\tu32\trbase3;\t\t \n\tu8\tres17d[4];\n\tu32\trbase4;\t\t \n\tu8\tres17e[4];\n\tu32\trbase5;\t\t \n\tu8\tres17f[4];\n\tu32\trbase6;\t\t \n\tu8\tres17g[4];\n\tu32\trbase7;\t\t \n\tu8\tres17[192];\n\tu32\tmaccfg1;\t \n\tu32\tmaccfg2;\t \n\tu32\tipgifg;\t\t \n\tu32\thafdup;\t\t \n\tu32\tmaxfrm;\t\t \n\tu8\tres18[12];\n\tu8\tgfar_mii_regs[24];\t \n\tu32\tifctrl;\t\t \n\tu32\tifstat;\t\t \n\tu32\tmacstnaddr1;\t \n\tu32\tmacstnaddr2;\t \n\tu32\tmac01addr1;\t \n\tu32\tmac01addr2;\t \n\tu32\tmac02addr1;\t \n\tu32\tmac02addr2;\t \n\tu32\tmac03addr1;\t \n\tu32\tmac03addr2;\t \n\tu32\tmac04addr1;\t \n\tu32\tmac04addr2;\t \n\tu32\tmac05addr1;\t \n\tu32\tmac05addr2;\t \n\tu32\tmac06addr1;\t \n\tu32\tmac06addr2;\t \n\tu32\tmac07addr1;\t \n\tu32\tmac07addr2;\t \n\tu32\tmac08addr1;\t \n\tu32\tmac08addr2;\t \n\tu32\tmac09addr1;\t \n\tu32\tmac09addr2;\t \n\tu32\tmac10addr1;\t \n\tu32\tmac10addr2;\t \n\tu32\tmac11addr1;\t \n\tu32\tmac11addr2;\t \n\tu32\tmac12addr1;\t \n\tu32\tmac12addr2;\t \n\tu32\tmac13addr1;\t \n\tu32\tmac13addr2;\t \n\tu32\tmac14addr1;\t \n\tu32\tmac14addr2;\t \n\tu32\tmac15addr1;\t \n\tu32\tmac15addr2;\t \n\tu8\tres20[192];\n\tstruct rmon_mib\trmon;\t \n\tu32\trrej;\t\t \n\tu8\tres21[188];\n\tu32\tigaddr0;\t \n\tu32\tigaddr1;\t \n\tu32\tigaddr2;\t \n\tu32\tigaddr3;\t \n\tu32\tigaddr4;\t \n\tu32\tigaddr5;\t \n\tu32\tigaddr6;\t \n\tu32\tigaddr7;\t \n\tu8\tres22[96];\n\tu32\tgaddr0;\t\t \n\tu32\tgaddr1;\t\t \n\tu32\tgaddr2;\t\t \n\tu32\tgaddr3;\t\t \n\tu32\tgaddr4;\t\t \n\tu32\tgaddr5;\t\t \n\tu32\tgaddr6;\t\t \n\tu32\tgaddr7;\t\t \n\tu8\tres23a[352];\n\tu32\tfifocfg;\t \n\tu8\tres23b[252];\n\tu8\tres23c[248];\n\tu32\tattr;\t\t \n\tu32\tattreli;\t \n\tu32\trqprm0;\t \n\tu32\trqprm1;\t \n\tu32\trqprm2;\t \n\tu32\trqprm3;\t \n\tu32\trqprm4;\t \n\tu32\trqprm5;\t \n\tu32\trqprm6;\t \n\tu32\trqprm7;\t \n\tu8\tres24[36];\n\tu32\trfbptr0;  \n\tu8\tres24a[4];\n\tu32\trfbptr1;  \n\tu8\tres24b[4];\n\tu32\trfbptr2;  \n\tu8\tres24c[4];\n\tu32\trfbptr3;  \n\tu8\tres24d[4];\n\tu32\trfbptr4;  \n\tu8\tres24e[4];\n\tu32\trfbptr5;  \n\tu8\tres24f[4];\n\tu32\trfbptr6;  \n\tu8\tres24g[4];\n\tu32\trfbptr7;  \n\tu8\tres24h[4];\n\tu8\tres24x[556];\n\tu32\tisrg0;\t\t \n\tu32\tisrg1;\t\t \n\tu32\tisrg2;\t\t \n\tu32\tisrg3;\t\t \n\tu8\tres25[16];\n\tu32\trxic0;\t\t \n\tu32\trxic1;\t\t \n\tu32\trxic2;\t\t \n\tu32\trxic3;\t\t \n\tu32\trxic4;\t\t \n\tu32\trxic5;\t\t \n\tu32\trxic6;\t\t \n\tu32\trxic7;\t\t \n\tu8\tres26[32];\n\tu32\ttxic0;\t\t \n\tu32\ttxic1;\t\t \n\tu32\ttxic2;\t\t \n\tu32\ttxic3;\t\t \n\tu32\ttxic4;\t\t \n\tu32\ttxic5;\t\t \n\tu32\ttxic6;\t\t \n\tu32\ttxic7;\t\t \n\tu8\tres27[208];\n};\n\n \n#define FSL_GIANFAR_DEV_HAS_GIGABIT\t\t0x00000001\n#define FSL_GIANFAR_DEV_HAS_COALESCE\t\t0x00000002\n#define FSL_GIANFAR_DEV_HAS_RMON\t\t0x00000004\n#define FSL_GIANFAR_DEV_HAS_MULTI_INTR\t\t0x00000008\n#define FSL_GIANFAR_DEV_HAS_CSUM\t\t0x00000010\n#define FSL_GIANFAR_DEV_HAS_VLAN\t\t0x00000020\n#define FSL_GIANFAR_DEV_HAS_EXTENDED_HASH\t0x00000040\n#define FSL_GIANFAR_DEV_HAS_MAGIC_PACKET\t0x00000100\n#define FSL_GIANFAR_DEV_HAS_BD_STASHING\t\t0x00000200\n#define FSL_GIANFAR_DEV_HAS_BUF_STASHING\t0x00000400\n#define FSL_GIANFAR_DEV_HAS_TIMER\t\t0x00000800\n#define FSL_GIANFAR_DEV_HAS_WAKE_ON_FILER\t0x00001000\n#define FSL_GIANFAR_DEV_HAS_RX_FILER\t\t0x00002000\n\n#if (MAXGROUPS == 2)\n#define DEFAULT_MAPPING \t0xAA\n#else\n#define DEFAULT_MAPPING \t0xFF\n#endif\n\n#define ISRG_RR0\t0x80000000\n#define ISRG_TR0\t0x00800000\n\n \n \nenum {\n\tSQ_SG_MODE = 0,\n\tMQ_MG_MODE\n};\n\n \nstruct tx_q_stats {\n\tu64 tx_packets;\n\tu64 tx_bytes;\n};\n\n \nstruct gfar_priv_tx_q {\n\t \n\tspinlock_t txlock __attribute__ ((aligned (SMP_CACHE_BYTES)));\n\tstruct\ttxbd8 *tx_bd_base;\n\tstruct\ttxbd8 *cur_tx;\n\tunsigned int num_txbdfree;\n\tunsigned short skb_curtx;\n\tunsigned short tx_ring_size;\n\tstruct tx_q_stats stats;\n\tstruct gfar_priv_grp *grp;\n\t \n\tstruct net_device *dev;\n\tstruct sk_buff **tx_skbuff;\n\tstruct\ttxbd8 *dirty_tx;\n\tunsigned short skb_dirtytx;\n\tunsigned short qindex;\n\t \n\tunsigned int txcoalescing;\n\tunsigned long txic;\n\tdma_addr_t tx_bd_dma_base;\n};\n\n \nstruct rx_q_stats {\n\tu64 rx_packets;\n\tu64 rx_bytes;\n\tu64 rx_dropped;\n};\n\nstruct gfar_rx_buff {\n\tdma_addr_t dma;\n\tstruct page *page;\n\tunsigned int page_offset;\n};\n\n \n\nstruct gfar_priv_rx_q {\n\tstruct\tgfar_rx_buff *rx_buff __aligned(SMP_CACHE_BYTES);\n\tstruct\trxbd8 *rx_bd_base;\n\tstruct\tnet_device *ndev;\n\tstruct\tdevice *dev;\n\tu16 rx_ring_size;\n\tu16 qindex;\n\tstruct\tgfar_priv_grp *grp;\n\tu16 next_to_clean;\n\tu16 next_to_use;\n\tu16 next_to_alloc;\n\tstruct\tsk_buff *skb;\n\tstruct rx_q_stats stats;\n\tu32 __iomem *rfbptr;\n\tunsigned char rxcoalescing;\n\tunsigned long rxic;\n\tdma_addr_t rx_bd_dma_base;\n};\n\nenum gfar_irqinfo_id {\n\tGFAR_TX = 0,\n\tGFAR_RX = 1,\n\tGFAR_ER = 2,\n\tGFAR_NUM_IRQS = 3\n};\n\nstruct gfar_irqinfo {\n\tunsigned int irq;\n\tchar name[GFAR_INT_NAME_MAX];\n};\n\n \n\nstruct gfar_priv_grp {\n\tspinlock_t grplock __aligned(SMP_CACHE_BYTES);\n\tstruct\tnapi_struct napi_rx;\n\tstruct\tnapi_struct napi_tx;\n\tstruct gfar __iomem *regs;\n\tstruct gfar_priv_tx_q *tx_queue;\n\tstruct gfar_priv_rx_q *rx_queue;\n\tunsigned int tstat;\n\tunsigned int rstat;\n\n\tstruct gfar_private *priv;\n\tunsigned long num_tx_queues;\n\tunsigned long tx_bit_map;\n\tunsigned long num_rx_queues;\n\tunsigned long rx_bit_map;\n\n\tstruct gfar_irqinfo *irqinfo[GFAR_NUM_IRQS];\n};\n\n#define gfar_irq(grp, ID) \\\n\t((grp)->irqinfo[GFAR_##ID])\n\nenum gfar_errata {\n\tGFAR_ERRATA_74\t\t= 0x01,\n\tGFAR_ERRATA_76\t\t= 0x02,\n\tGFAR_ERRATA_A002\t= 0x04,\n\tGFAR_ERRATA_12\t\t= 0x08,  \n};\n\nenum gfar_dev_state {\n\tGFAR_DOWN = 1,\n\tGFAR_RESETTING\n};\n\n \nstruct gfar_private {\n\tstruct device *dev;\n\tstruct net_device *ndev;\n\tenum gfar_errata errata;\n\n\tu16 uses_rxfcb;\n\tu16 padding;\n\tu32 device_flags;\n\n\t \n\tint hwts_rx_en;\n\tint hwts_tx_en;\n\n\tstruct gfar_priv_tx_q *tx_queue[MAX_TX_QS];\n\tstruct gfar_priv_rx_q *rx_queue[MAX_RX_QS];\n\tstruct gfar_priv_grp gfargrp[MAXGROUPS];\n\n\tunsigned long state;\n\n\tunsigned short mode;\n\tunsigned int num_tx_queues;\n\tunsigned int num_rx_queues;\n\tunsigned int num_grps;\n\tint tx_actual_en;\n\n\t \n\tstruct gfar_extra_stats extra_stats;\n\tstruct rmon_overflow rmon_overflow;\n\n\t \n\tphy_interface_t interface;\n\tstruct device_node *phy_node;\n\tstruct device_node *tbi_node;\n\tstruct mii_bus *mii_bus;\n\tint oldspeed;\n\tint oldduplex;\n\tint oldlink;\n\n\tuint32_t msg_enable;\n\n\tstruct work_struct reset_task;\n\n\tstruct platform_device *ofdev;\n\tunsigned char\n\t\textended_hash:1,\n\t\tbd_stash_en:1,\n\t\trx_filer_enable:1,\n\t\t \n\t\tprio_sched_en:1,\n\t\t \n\t\tpause_aneg_en:1,\n\t\ttx_pause_en:1,\n\t\trx_pause_en:1;\n\n\t \n\tunsigned int total_tx_ring_size;\n\tunsigned int total_rx_ring_size;\n\n\tu32 rqueue;\n\tu32 tqueue;\n\n\t \n\tunsigned int rx_stash_size;\n\tunsigned int rx_stash_index;\n\n\tu32 cur_filer_idx;\n\n\t \n\tstruct ethtool_rx_list rx_list;\n\tstruct mutex rx_queue_access;\n\n\t \n\tu32 __iomem *hash_regs[16];\n\tint hash_width;\n\n\t \n\tu16 wol_opts;\n\tu16 wol_supported;\n\n\t \n\tunsigned int ftp_rqfpr[MAX_FILER_IDX + 1];\n\tunsigned int ftp_rqfcr[MAX_FILER_IDX + 1];\n};\n\n\nstatic inline int gfar_has_errata(struct gfar_private *priv,\n\t\t\t\t  enum gfar_errata err)\n{\n\treturn priv->errata & err;\n}\n\nstatic inline u32 gfar_read(unsigned __iomem *addr)\n{\n\tu32 val;\n\tval = ioread32be(addr);\n\treturn val;\n}\n\nstatic inline void gfar_write(unsigned __iomem *addr, u32 val)\n{\n\tiowrite32be(val, addr);\n}\n\nstatic inline void gfar_write_filer(struct gfar_private *priv,\n\t\tunsigned int far, unsigned int fcr, unsigned int fpr)\n{\n\tstruct gfar __iomem *regs = priv->gfargrp[0].regs;\n\n\tgfar_write(&regs->rqfar, far);\n\tgfar_write(&regs->rqfcr, fcr);\n\tgfar_write(&regs->rqfpr, fpr);\n}\n\nstatic inline void gfar_read_filer(struct gfar_private *priv,\n\t\tunsigned int far, unsigned int *fcr, unsigned int *fpr)\n{\n\tstruct gfar __iomem *regs = priv->gfargrp[0].regs;\n\n\tgfar_write(&regs->rqfar, far);\n\t*fcr = gfar_read(&regs->rqfcr);\n\t*fpr = gfar_read(&regs->rqfpr);\n}\n\nstatic inline void gfar_write_isrg(struct gfar_private *priv)\n{\n\tstruct gfar __iomem *regs = priv->gfargrp[0].regs;\n\tu32 __iomem *baddr = &regs->isrg0;\n\tu32 isrg = 0;\n\tint grp_idx, i;\n\n\tfor (grp_idx = 0; grp_idx < priv->num_grps; grp_idx++) {\n\t\tstruct gfar_priv_grp *grp = &priv->gfargrp[grp_idx];\n\n\t\tfor_each_set_bit(i, &grp->rx_bit_map, priv->num_rx_queues) {\n\t\t\tisrg |= (ISRG_RR0 >> i);\n\t\t}\n\n\t\tfor_each_set_bit(i, &grp->tx_bit_map, priv->num_tx_queues) {\n\t\t\tisrg |= (ISRG_TR0 >> i);\n\t\t}\n\n\t\tgfar_write(baddr, isrg);\n\n\t\tbaddr++;\n\t\tisrg = 0;\n\t}\n}\n\nstatic inline int gfar_is_dma_stopped(struct gfar_private *priv)\n{\n\tstruct gfar __iomem *regs = priv->gfargrp[0].regs;\n\n\treturn ((gfar_read(&regs->ievent) & (IEVENT_GRSC | IEVENT_GTSC)) ==\n\t       (IEVENT_GRSC | IEVENT_GTSC));\n}\n\nstatic inline int gfar_is_rx_dma_stopped(struct gfar_private *priv)\n{\n\tstruct gfar __iomem *regs = priv->gfargrp[0].regs;\n\n\treturn gfar_read(&regs->ievent) & IEVENT_GRSC;\n}\n\nstatic inline void gfar_wmb(void)\n{\n#if defined(CONFIG_PPC)\n\t \n\teieio();\n#else\n\twmb();  \n#endif\n}\n\nstatic inline void gfar_clear_txbd_status(struct txbd8 *bdp)\n{\n\tu32 lstatus = be32_to_cpu(bdp->lstatus);\n\n\tlstatus &= BD_LFLAG(TXBD_WRAP);\n\tbdp->lstatus = cpu_to_be32(lstatus);\n}\n\nstatic inline int gfar_rxbd_unused(struct gfar_priv_rx_q *rxq)\n{\n\tif (rxq->next_to_clean > rxq->next_to_use)\n\t\treturn rxq->next_to_clean - rxq->next_to_use - 1;\n\n\treturn rxq->rx_ring_size + rxq->next_to_clean - rxq->next_to_use - 1;\n}\n\nstatic inline u32 gfar_rxbd_dma_lastfree(struct gfar_priv_rx_q *rxq)\n{\n\tstruct rxbd8 *bdp;\n\tu32 bdp_dma;\n\tint i;\n\n\ti = rxq->next_to_use ? rxq->next_to_use - 1 : rxq->rx_ring_size - 1;\n\tbdp = &rxq->rx_bd_base[i];\n\tbdp_dma = lower_32_bits(rxq->rx_bd_dma_base);\n\tbdp_dma += (uintptr_t)bdp - (uintptr_t)rxq->rx_bd_base;\n\n\treturn bdp_dma;\n}\n\nint startup_gfar(struct net_device *dev);\nvoid stop_gfar(struct net_device *dev);\nvoid gfar_mac_reset(struct gfar_private *priv);\nint gfar_set_features(struct net_device *dev, netdev_features_t features);\n\nextern const struct ethtool_ops gfar_ethtool_ops;\n\n#define MAX_FILER_CACHE_IDX (2*(MAX_FILER_IDX))\n\n#define RQFCR_PID_PRI_MASK 0xFFFFFFF8\n#define RQFCR_PID_L4P_MASK 0xFFFFFF00\n#define RQFCR_PID_VID_MASK 0xFFFFF000\n#define RQFCR_PID_PORT_MASK 0xFFFF0000\n#define RQFCR_PID_MAC_MASK 0xFF000000\n\n \nstruct gfar_filer_entry {\n\tu32 ctrl;\n\tu32 prop;\n};\n\n\n \nstruct filer_table {\n\tu32 index;\n\tstruct gfar_filer_entry fe[MAX_FILER_CACHE_IDX + 20];\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}