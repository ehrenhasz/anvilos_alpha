{
  "module_name": "macb.h",
  "hash_id": "79d1a185cd35a804c9b4806aab4554433556d027e135e3753fbaa3b6d2d450c8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/cadence/macb.h",
  "human_readable_source": " \n \n#ifndef _MACB_H\n#define _MACB_H\n\n#include <linux/clk.h>\n#include <linux/phylink.h>\n#include <linux/ptp_clock_kernel.h>\n#include <linux/net_tstamp.h>\n#include <linux/interrupt.h>\n#include <linux/phy/phy.h>\n\n#if defined(CONFIG_ARCH_DMA_ADDR_T_64BIT) || defined(CONFIG_MACB_USE_HWSTAMP)\n#define MACB_EXT_DESC\n#endif\n\n#define MACB_GREGS_NBR 16\n#define MACB_GREGS_VERSION 2\n#define MACB_MAX_QUEUES 8\n\n \n#define MACB_NCR\t\t0x0000  \n#define MACB_NCFGR\t\t0x0004  \n#define MACB_NSR\t\t0x0008  \n#define MACB_TAR\t\t0x000c  \n#define MACB_TCR\t\t0x0010  \n#define MACB_TSR\t\t0x0014  \n#define MACB_RBQP\t\t0x0018  \n#define MACB_TBQP\t\t0x001c  \n#define MACB_RSR\t\t0x0020  \n#define MACB_ISR\t\t0x0024  \n#define MACB_IER\t\t0x0028  \n#define MACB_IDR\t\t0x002c  \n#define MACB_IMR\t\t0x0030  \n#define MACB_MAN\t\t0x0034  \n#define MACB_PTR\t\t0x0038\n#define MACB_PFR\t\t0x003c\n#define MACB_FTO\t\t0x0040\n#define MACB_SCF\t\t0x0044\n#define MACB_MCF\t\t0x0048\n#define MACB_FRO\t\t0x004c\n#define MACB_FCSE\t\t0x0050\n#define MACB_ALE\t\t0x0054\n#define MACB_DTF\t\t0x0058\n#define MACB_LCOL\t\t0x005c\n#define MACB_EXCOL\t\t0x0060\n#define MACB_TUND\t\t0x0064\n#define MACB_CSE\t\t0x0068\n#define MACB_RRE\t\t0x006c\n#define MACB_ROVR\t\t0x0070\n#define MACB_RSE\t\t0x0074\n#define MACB_ELE\t\t0x0078\n#define MACB_RJA\t\t0x007c\n#define MACB_USF\t\t0x0080\n#define MACB_STE\t\t0x0084\n#define MACB_RLE\t\t0x0088\n#define MACB_TPF\t\t0x008c\n#define MACB_HRB\t\t0x0090\n#define MACB_HRT\t\t0x0094\n#define MACB_SA1B\t\t0x0098\n#define MACB_SA1T\t\t0x009c\n#define MACB_SA2B\t\t0x00a0\n#define MACB_SA2T\t\t0x00a4\n#define MACB_SA3B\t\t0x00a8\n#define MACB_SA3T\t\t0x00ac\n#define MACB_SA4B\t\t0x00b0\n#define MACB_SA4T\t\t0x00b4\n#define MACB_TID\t\t0x00b8\n#define MACB_TPQ\t\t0x00bc\n#define MACB_USRIO\t\t0x00c0\n#define MACB_WOL\t\t0x00c4\n#define MACB_MID\t\t0x00fc\n#define MACB_TBQPH\t\t0x04C8\n#define MACB_RBQPH\t\t0x04D4\n\n \n#define GEM_NCR\t\t\t0x0000  \n#define GEM_NCFGR\t\t0x0004  \n#define GEM_USRIO\t\t0x000c  \n#define GEM_DMACFG\t\t0x0010  \n#define GEM_PBUFRXCUT\t\t0x0044  \n#define GEM_JML\t\t\t0x0048  \n#define GEM_HS_MAC_CONFIG\t0x0050  \n#define GEM_HRB\t\t\t0x0080  \n#define GEM_HRT\t\t\t0x0084  \n#define GEM_SA1B\t\t0x0088  \n#define GEM_SA1T\t\t0x008C  \n#define GEM_SA2B\t\t0x0090  \n#define GEM_SA2T\t\t0x0094  \n#define GEM_SA3B\t\t0x0098  \n#define GEM_SA3T\t\t0x009C  \n#define GEM_SA4B\t\t0x00A0  \n#define GEM_SA4T\t\t0x00A4  \n#define GEM_WOL\t\t\t0x00b8  \n#define GEM_RXPTPUNI\t\t0x00D4  \n#define GEM_TXPTPUNI\t\t0x00D8  \n#define GEM_EFTSH\t\t0x00e8  \n#define GEM_EFRSH\t\t0x00ec  \n#define GEM_PEFTSH\t\t0x00f0  \n#define GEM_PEFRSH\t\t0x00f4  \n#define GEM_OTX\t\t\t0x0100  \n#define GEM_OCTTXL\t\t0x0100  \n#define GEM_OCTTXH\t\t0x0104  \n#define GEM_TXCNT\t\t0x0108  \n#define GEM_TXBCCNT\t\t0x010c  \n#define GEM_TXMCCNT\t\t0x0110  \n#define GEM_TXPAUSECNT\t\t0x0114  \n#define GEM_TX64CNT\t\t0x0118  \n#define GEM_TX65CNT\t\t0x011c  \n#define GEM_TX128CNT\t\t0x0120  \n#define GEM_TX256CNT\t\t0x0124  \n#define GEM_TX512CNT\t\t0x0128  \n#define GEM_TX1024CNT\t\t0x012c  \n#define GEM_TX1519CNT\t\t0x0130  \n#define GEM_TXURUNCNT\t\t0x0134  \n#define GEM_SNGLCOLLCNT\t\t0x0138  \n#define GEM_MULTICOLLCNT\t0x013c  \n#define GEM_EXCESSCOLLCNT\t0x0140  \n#define GEM_LATECOLLCNT\t\t0x0144  \n#define GEM_TXDEFERCNT\t\t0x0148  \n#define GEM_TXCSENSECNT\t\t0x014c  \n#define GEM_ORX\t\t\t0x0150  \n#define GEM_OCTRXL\t\t0x0150  \n#define GEM_OCTRXH\t\t0x0154  \n#define GEM_RXCNT\t\t0x0158  \n#define GEM_RXBROADCNT\t\t0x015c  \n#define GEM_RXMULTICNT\t\t0x0160  \n#define GEM_RXPAUSECNT\t\t0x0164  \n#define GEM_RX64CNT\t\t0x0168  \n#define GEM_RX65CNT\t\t0x016c  \n#define GEM_RX128CNT\t\t0x0170  \n#define GEM_RX256CNT\t\t0x0174  \n#define GEM_RX512CNT\t\t0x0178  \n#define GEM_RX1024CNT\t\t0x017c  \n#define GEM_RX1519CNT\t\t0x0180  \n#define GEM_RXUNDRCNT\t\t0x0184  \n#define GEM_RXOVRCNT\t\t0x0188  \n#define GEM_RXJABCNT\t\t0x018c  \n#define GEM_RXFCSCNT\t\t0x0190  \n#define GEM_RXLENGTHCNT\t\t0x0194  \n#define GEM_RXSYMBCNT\t\t0x0198  \n#define GEM_RXALIGNCNT\t\t0x019c  \n#define GEM_RXRESERRCNT\t\t0x01a0  \n#define GEM_RXORCNT\t\t0x01a4  \n#define GEM_RXIPCCNT\t\t0x01a8  \n#define GEM_RXTCPCCNT\t\t0x01ac  \n#define GEM_RXUDPCCNT\t\t0x01b0  \n#define GEM_TISUBN\t\t0x01bc  \n#define GEM_TSH\t\t\t0x01c0  \n#define GEM_TSL\t\t\t0x01d0  \n#define GEM_TN\t\t\t0x01d4  \n#define GEM_TA\t\t\t0x01d8  \n#define GEM_TI\t\t\t0x01dc  \n#define GEM_EFTSL\t\t0x01e0  \n#define GEM_EFTN\t\t0x01e4  \n#define GEM_EFRSL\t\t0x01e8  \n#define GEM_EFRN\t\t0x01ec  \n#define GEM_PEFTSL\t\t0x01f0  \n#define GEM_PEFTN\t\t0x01f4  \n#define GEM_PEFRSL\t\t0x01f8  \n#define GEM_PEFRN\t\t0x01fc  \n#define GEM_PCSCNTRL\t\t0x0200  \n#define GEM_PCSSTS\t\t0x0204  \n#define GEM_PCSPHYTOPID\t\t0x0208  \n#define GEM_PCSPHYBOTID\t\t0x020c  \n#define GEM_PCSANADV\t\t0x0210  \n#define GEM_PCSANLPBASE\t\t0x0214  \n#define GEM_PCSANEXP\t\t0x0218  \n#define GEM_PCSANNPTX\t\t0x021c  \n#define GEM_PCSANNPLP\t\t0x0220  \n#define GEM_PCSANEXTSTS\t\t0x023c  \n#define GEM_DCFG1\t\t0x0280  \n#define GEM_DCFG2\t\t0x0284  \n#define GEM_DCFG3\t\t0x0288  \n#define GEM_DCFG4\t\t0x028c  \n#define GEM_DCFG5\t\t0x0290  \n#define GEM_DCFG6\t\t0x0294  \n#define GEM_DCFG7\t\t0x0298  \n#define GEM_DCFG8\t\t0x029C  \n#define GEM_DCFG10\t\t0x02A4  \n#define GEM_DCFG12\t\t0x02AC  \n#define GEM_USX_CONTROL\t\t0x0A80  \n#define GEM_USX_STATUS\t\t0x0A88  \n\n#define GEM_TXBDCTRL\t0x04cc  \n#define GEM_RXBDCTRL\t0x04d0  \n\n \n#define GEM_SCRT2\t\t0x540\n\n \n#define GEM_ETHT\t\t0x06E0\n\n \n#define GEM_T2CMPW0\t\t0x0700\n#define GEM_T2CMPW1\t\t0x0704\n#define T2CMP_OFST(t2idx)\t(t2idx * 2)\n\n \n#define GEM_IP4SRC_CMP(idx)\t\t(idx * 3)\n#define GEM_IP4DST_CMP(idx)\t\t(idx * 3 + 1)\n#define GEM_PORT_CMP(idx)\t\t(idx * 3 + 2)\n\n \n#define SCRT2_ETHT\t\t0\n\n#define GEM_ISR(hw_q)\t\t(0x0400 + ((hw_q) << 2))\n#define GEM_TBQP(hw_q)\t\t(0x0440 + ((hw_q) << 2))\n#define GEM_TBQPH(hw_q)\t\t(0x04C8)\n#define GEM_RBQP(hw_q)\t\t(0x0480 + ((hw_q) << 2))\n#define GEM_RBQS(hw_q)\t\t(0x04A0 + ((hw_q) << 2))\n#define GEM_RBQPH(hw_q)\t\t(0x04D4)\n#define GEM_IER(hw_q)\t\t(0x0600 + ((hw_q) << 2))\n#define GEM_IDR(hw_q)\t\t(0x0620 + ((hw_q) << 2))\n#define GEM_IMR(hw_q)\t\t(0x0640 + ((hw_q) << 2))\n\n \n#define MACB_LB_OFFSET\t\t0  \n#define MACB_LB_SIZE\t\t1\n#define MACB_LLB_OFFSET\t\t1  \n#define MACB_LLB_SIZE\t\t1\n#define MACB_RE_OFFSET\t\t2  \n#define MACB_RE_SIZE\t\t1\n#define MACB_TE_OFFSET\t\t3  \n#define MACB_TE_SIZE\t\t1\n#define MACB_MPE_OFFSET\t\t4  \n#define MACB_MPE_SIZE\t\t1\n#define MACB_CLRSTAT_OFFSET\t5  \n#define MACB_CLRSTAT_SIZE\t1\n#define MACB_INCSTAT_OFFSET\t6  \n#define MACB_INCSTAT_SIZE\t1\n#define MACB_WESTAT_OFFSET\t7  \n#define MACB_WESTAT_SIZE\t1\n#define MACB_BP_OFFSET\t\t8  \n#define MACB_BP_SIZE\t\t1\n#define MACB_TSTART_OFFSET\t9  \n#define MACB_TSTART_SIZE\t1\n#define MACB_THALT_OFFSET\t10  \n#define MACB_THALT_SIZE\t\t1\n#define MACB_NCR_TPF_OFFSET\t11  \n#define MACB_NCR_TPF_SIZE\t1\n#define MACB_TZQ_OFFSET\t\t12  \n#define MACB_TZQ_SIZE\t\t1\n#define MACB_SRTSM_OFFSET\t15  \n#define MACB_PTPUNI_OFFSET\t20  \n#define MACB_PTPUNI_SIZE\t1\n#define MACB_OSSMODE_OFFSET\t24  \n#define MACB_OSSMODE_SIZE\t1\n#define MACB_MIIONRGMII_OFFSET\t28  \n#define MACB_MIIONRGMII_SIZE\t1\n\n \n#define MACB_SPD_OFFSET\t\t0  \n#define MACB_SPD_SIZE\t\t1\n#define MACB_FD_OFFSET\t\t1  \n#define MACB_FD_SIZE\t\t1\n#define MACB_BIT_RATE_OFFSET\t2  \n#define MACB_BIT_RATE_SIZE\t1\n#define MACB_JFRAME_OFFSET\t3  \n#define MACB_JFRAME_SIZE\t1\n#define MACB_CAF_OFFSET\t\t4  \n#define MACB_CAF_SIZE\t\t1\n#define MACB_NBC_OFFSET\t\t5  \n#define MACB_NBC_SIZE\t\t1\n#define MACB_NCFGR_MTI_OFFSET\t6  \n#define MACB_NCFGR_MTI_SIZE\t1\n#define MACB_UNI_OFFSET\t\t7  \n#define MACB_UNI_SIZE\t\t1\n#define MACB_BIG_OFFSET\t\t8  \n#define MACB_BIG_SIZE\t\t1\n#define MACB_EAE_OFFSET\t\t9  \n#define MACB_EAE_SIZE\t\t1\n#define MACB_CLK_OFFSET\t\t10\n#define MACB_CLK_SIZE\t\t2\n#define MACB_RTY_OFFSET\t\t12  \n#define MACB_RTY_SIZE\t\t1\n#define MACB_PAE_OFFSET\t\t13  \n#define MACB_PAE_SIZE\t\t1\n#define MACB_RM9200_RMII_OFFSET\t13  \n#define MACB_RM9200_RMII_SIZE\t1   \n#define MACB_RBOF_OFFSET\t14  \n#define MACB_RBOF_SIZE\t\t2\n#define MACB_RLCE_OFFSET\t16  \n#define MACB_RLCE_SIZE\t\t1\n#define MACB_DRFCS_OFFSET\t17  \n#define MACB_DRFCS_SIZE\t\t1\n#define MACB_EFRHD_OFFSET\t18\n#define MACB_EFRHD_SIZE\t\t1\n#define MACB_IRXFCS_OFFSET\t19\n#define MACB_IRXFCS_SIZE\t1\n\n \n#define GEM_ENABLE_HS_MAC_OFFSET\t31\n#define GEM_ENABLE_HS_MAC_SIZE\t\t1\n\n \n#define GEM_FD_OFFSET\t\t1  \n#define GEM_FD_SIZE\t\t1\n#define GEM_GBE_OFFSET\t\t10  \n#define GEM_GBE_SIZE\t\t1\n#define GEM_PCSSEL_OFFSET\t11\n#define GEM_PCSSEL_SIZE\t\t1\n#define GEM_PAE_OFFSET\t\t13  \n#define GEM_PAE_SIZE\t\t1\n#define GEM_CLK_OFFSET\t\t18  \n#define GEM_CLK_SIZE\t\t3\n#define GEM_DBW_OFFSET\t\t21  \n#define GEM_DBW_SIZE\t\t2\n#define GEM_RXCOEN_OFFSET\t24\n#define GEM_RXCOEN_SIZE\t\t1\n#define GEM_SGMIIEN_OFFSET\t27\n#define GEM_SGMIIEN_SIZE\t1\n\n\n \n#define GEM_DBW32\t\t0  \n#define GEM_DBW64\t\t1  \n#define GEM_DBW128\t\t2  \n\n \n#define GEM_FBLDO_OFFSET\t0  \n#define GEM_FBLDO_SIZE\t\t5\n#define GEM_ENDIA_DESC_OFFSET\t6  \n#define GEM_ENDIA_DESC_SIZE\t1\n#define GEM_ENDIA_PKT_OFFSET\t7  \n#define GEM_ENDIA_PKT_SIZE\t1\n#define GEM_RXBMS_OFFSET\t8  \n#define GEM_RXBMS_SIZE\t\t2\n#define GEM_TXPBMS_OFFSET\t10  \n#define GEM_TXPBMS_SIZE\t\t1\n#define GEM_TXCOEN_OFFSET\t11  \n#define GEM_TXCOEN_SIZE\t\t1\n#define GEM_RXBS_OFFSET\t\t16  \n#define GEM_RXBS_SIZE\t\t8\n#define GEM_DDRP_OFFSET\t\t24  \n#define GEM_DDRP_SIZE\t\t1\n#define GEM_RXEXT_OFFSET\t28  \n#define GEM_RXEXT_SIZE\t\t1\n#define GEM_TXEXT_OFFSET\t29  \n#define GEM_TXEXT_SIZE\t\t1\n#define GEM_ADDR64_OFFSET\t30  \n#define GEM_ADDR64_SIZE\t\t1\n\n\n \n#define GEM_ENCUTTHRU_OFFSET\t31  \n#define GEM_ENCUTTHRU_SIZE\t1\n\n \n#define MACB_NSR_LINK_OFFSET\t0  \n#define MACB_NSR_LINK_SIZE\t1\n#define MACB_MDIO_OFFSET\t1  \n#define MACB_MDIO_SIZE\t\t1\n#define MACB_IDLE_OFFSET\t2  \n#define MACB_IDLE_SIZE\t\t1\n\n \n#define MACB_UBR_OFFSET\t\t0  \n#define MACB_UBR_SIZE\t\t1\n#define MACB_COL_OFFSET\t\t1  \n#define MACB_COL_SIZE\t\t1\n#define MACB_TSR_RLE_OFFSET\t2  \n#define MACB_TSR_RLE_SIZE\t1\n#define MACB_TGO_OFFSET\t\t3  \n#define MACB_TGO_SIZE\t\t1\n#define MACB_BEX_OFFSET\t\t4  \n#define MACB_BEX_SIZE\t\t1\n#define MACB_RM9200_BNQ_OFFSET\t4  \n#define MACB_RM9200_BNQ_SIZE\t1  \n#define MACB_COMP_OFFSET\t5  \n#define MACB_COMP_SIZE\t\t1\n#define MACB_UND_OFFSET\t\t6  \n#define MACB_UND_SIZE\t\t1\n\n \n#define MACB_BNA_OFFSET\t\t0  \n#define MACB_BNA_SIZE\t\t1\n#define MACB_REC_OFFSET\t\t1  \n#define MACB_REC_SIZE\t\t1\n#define MACB_OVR_OFFSET\t\t2  \n#define MACB_OVR_SIZE\t\t1\n\n \n#define MACB_MFD_OFFSET\t\t0  \n#define MACB_MFD_SIZE\t\t1\n#define MACB_RCOMP_OFFSET\t1  \n#define MACB_RCOMP_SIZE\t\t1\n#define MACB_RXUBR_OFFSET\t2  \n#define MACB_RXUBR_SIZE\t\t1\n#define MACB_TXUBR_OFFSET\t3  \n#define MACB_TXUBR_SIZE\t\t1\n#define MACB_ISR_TUND_OFFSET\t4  \n#define MACB_ISR_TUND_SIZE\t1\n#define MACB_ISR_RLE_OFFSET\t5  \n#define MACB_ISR_RLE_SIZE\t1\n#define MACB_TXERR_OFFSET\t6  \n#define MACB_TXERR_SIZE\t\t1\n#define MACB_RM9200_TBRE_OFFSET\t6  \n#define MACB_RM9200_TBRE_SIZE\t1\n#define MACB_TCOMP_OFFSET\t7  \n#define MACB_TCOMP_SIZE\t\t1\n#define MACB_ISR_LINK_OFFSET\t9  \n#define MACB_ISR_LINK_SIZE\t1\n#define MACB_ISR_ROVR_OFFSET\t10  \n#define MACB_ISR_ROVR_SIZE\t1\n#define MACB_HRESP_OFFSET\t11  \n#define MACB_HRESP_SIZE\t\t1\n#define MACB_PFR_OFFSET\t\t12  \n#define MACB_PFR_SIZE\t\t1\n#define MACB_PTZ_OFFSET\t\t13  \n#define MACB_PTZ_SIZE\t\t1\n#define MACB_WOL_OFFSET\t\t14  \n#define MACB_WOL_SIZE\t\t1\n#define MACB_DRQFR_OFFSET\t18  \n#define MACB_DRQFR_SIZE\t\t1\n#define MACB_SFR_OFFSET\t\t19  \n#define MACB_SFR_SIZE\t\t1\n#define MACB_DRQFT_OFFSET\t20  \n#define MACB_DRQFT_SIZE\t\t1\n#define MACB_SFT_OFFSET\t\t21  \n#define MACB_SFT_SIZE\t\t1\n#define MACB_PDRQFR_OFFSET\t22  \n#define MACB_PDRQFR_SIZE\t1\n#define MACB_PDRSFR_OFFSET\t23  \n#define MACB_PDRSFR_SIZE\t1\n#define MACB_PDRQFT_OFFSET\t24  \n#define MACB_PDRQFT_SIZE\t1\n#define MACB_PDRSFT_OFFSET\t25  \n#define MACB_PDRSFT_SIZE\t1\n#define MACB_SRI_OFFSET\t\t26  \n#define MACB_SRI_SIZE\t\t1\n#define GEM_WOL_OFFSET\t\t28  \n#define GEM_WOL_SIZE\t\t1\n\n \n#define MACB_TI_CNS_OFFSET\t0\n#define MACB_TI_CNS_SIZE\t8\n#define MACB_TI_ACNS_OFFSET\t8\n#define MACB_TI_ACNS_SIZE\t8\n#define MACB_TI_NIT_OFFSET\t16\n#define MACB_TI_NIT_SIZE\t8\n\n \n#define MACB_DATA_OFFSET\t0  \n#define MACB_DATA_SIZE\t\t16\n#define MACB_CODE_OFFSET\t16  \n#define MACB_CODE_SIZE\t\t2\n#define MACB_REGA_OFFSET\t18  \n#define MACB_REGA_SIZE\t\t5\n#define MACB_PHYA_OFFSET\t23  \n#define MACB_PHYA_SIZE\t\t5\n#define MACB_RW_OFFSET\t\t28  \n#define MACB_RW_SIZE\t\t2\n#define MACB_SOF_OFFSET\t\t30  \n#define MACB_SOF_SIZE\t\t2\n\n \n#define MACB_MII_OFFSET\t\t\t\t0\n#define MACB_MII_SIZE\t\t\t\t1\n#define MACB_EAM_OFFSET\t\t\t\t1\n#define MACB_EAM_SIZE\t\t\t\t1\n#define MACB_TX_PAUSE_OFFSET\t\t\t2\n#define MACB_TX_PAUSE_SIZE\t\t\t1\n#define MACB_TX_PAUSE_ZERO_OFFSET\t\t3\n#define MACB_TX_PAUSE_ZERO_SIZE\t\t\t1\n\n \n#define MACB_RMII_OFFSET\t\t\t0\n#define MACB_RMII_SIZE\t\t\t\t1\n#define GEM_RGMII_OFFSET\t\t\t0  \n#define GEM_RGMII_SIZE\t\t\t\t1\n#define MACB_CLKEN_OFFSET\t\t\t1\n#define MACB_CLKEN_SIZE\t\t\t\t1\n\n \n#define MACB_IP_OFFSET\t\t\t\t0\n#define MACB_IP_SIZE\t\t\t\t16\n#define MACB_MAG_OFFSET\t\t\t\t16\n#define MACB_MAG_SIZE\t\t\t\t1\n#define MACB_ARP_OFFSET\t\t\t\t17\n#define MACB_ARP_SIZE\t\t\t\t1\n#define MACB_SA1_OFFSET\t\t\t\t18\n#define MACB_SA1_SIZE\t\t\t\t1\n#define MACB_WOL_MTI_OFFSET\t\t\t19\n#define MACB_WOL_MTI_SIZE\t\t\t1\n\n \n#define MACB_IDNUM_OFFSET\t\t\t16\n#define MACB_IDNUM_SIZE\t\t\t\t12\n#define MACB_REV_OFFSET\t\t\t\t0\n#define MACB_REV_SIZE\t\t\t\t16\n\n \n#define GEM_HS_MAC_SPEED_OFFSET\t\t\t0\n#define GEM_HS_MAC_SPEED_SIZE\t\t\t3\n\n \n#define GEM_PCSAUTONEG_OFFSET\t\t\t12\n#define GEM_PCSAUTONEG_SIZE\t\t\t1\n\n \n#define GEM_IRQCOR_OFFSET\t\t\t23\n#define GEM_IRQCOR_SIZE\t\t\t\t1\n#define GEM_DBWDEF_OFFSET\t\t\t25\n#define GEM_DBWDEF_SIZE\t\t\t\t3\n#define GEM_NO_PCS_OFFSET\t\t\t0\n#define GEM_NO_PCS_SIZE\t\t\t\t1\n\n \n#define GEM_RX_PKT_BUFF_OFFSET\t\t\t20\n#define GEM_RX_PKT_BUFF_SIZE\t\t\t1\n#define GEM_TX_PKT_BUFF_OFFSET\t\t\t21\n#define GEM_TX_PKT_BUFF_SIZE\t\t\t1\n\n#define GEM_RX_PBUF_ADDR_OFFSET\t\t\t22\n#define GEM_RX_PBUF_ADDR_SIZE\t\t\t4\n\n \n#define GEM_TSU_OFFSET\t\t\t\t8\n#define GEM_TSU_SIZE\t\t\t\t1\n\n \n#define GEM_PBUF_LSO_OFFSET\t\t\t27\n#define GEM_PBUF_LSO_SIZE\t\t\t1\n#define GEM_PBUF_CUTTHRU_OFFSET\t\t\t25\n#define GEM_PBUF_CUTTHRU_SIZE\t\t\t1\n#define GEM_DAW64_OFFSET\t\t\t23\n#define GEM_DAW64_SIZE\t\t\t\t1\n\n \n#define GEM_T1SCR_OFFSET\t\t\t24\n#define GEM_T1SCR_SIZE\t\t\t\t8\n#define GEM_T2SCR_OFFSET\t\t\t16\n#define GEM_T2SCR_SIZE\t\t\t\t8\n#define GEM_SCR2ETH_OFFSET\t\t\t8\n#define GEM_SCR2ETH_SIZE\t\t\t8\n#define GEM_SCR2CMP_OFFSET\t\t\t0\n#define GEM_SCR2CMP_SIZE\t\t\t8\n\n \n#define GEM_TXBD_RDBUFF_OFFSET\t\t\t12\n#define GEM_TXBD_RDBUFF_SIZE\t\t\t4\n#define GEM_RXBD_RDBUFF_OFFSET\t\t\t8\n#define GEM_RXBD_RDBUFF_SIZE\t\t\t4\n\n \n#define GEM_HIGH_SPEED_OFFSET\t\t\t26\n#define GEM_HIGH_SPEED_SIZE\t\t\t1\n\n \n#define GEM_USX_CTRL_SPEED_OFFSET\t\t14\n#define GEM_USX_CTRL_SPEED_SIZE\t\t\t3\n#define GEM_SERDES_RATE_OFFSET\t\t\t12\n#define GEM_SERDES_RATE_SIZE\t\t\t2\n#define GEM_RX_SCR_BYPASS_OFFSET\t\t9\n#define GEM_RX_SCR_BYPASS_SIZE\t\t\t1\n#define GEM_TX_SCR_BYPASS_OFFSET\t\t8\n#define GEM_TX_SCR_BYPASS_SIZE\t\t\t1\n#define GEM_TX_EN_OFFSET\t\t\t1\n#define GEM_TX_EN_SIZE\t\t\t\t1\n#define GEM_SIGNAL_OK_OFFSET\t\t\t0\n#define GEM_SIGNAL_OK_SIZE\t\t\t1\n\n \n#define GEM_USX_BLOCK_LOCK_OFFSET\t\t0\n#define GEM_USX_BLOCK_LOCK_SIZE\t\t\t1\n\n \n#define GEM_SUBNSINCR_OFFSET\t\t\t0\n#define GEM_SUBNSINCRL_OFFSET\t\t\t24\n#define GEM_SUBNSINCRL_SIZE\t\t\t8\n#define GEM_SUBNSINCRH_OFFSET\t\t\t0\n#define GEM_SUBNSINCRH_SIZE\t\t\t16\n#define GEM_SUBNSINCR_SIZE\t\t\t24\n\n \n#define GEM_NSINCR_OFFSET\t\t\t0\n#define GEM_NSINCR_SIZE\t\t\t\t8\n\n \n#define GEM_TSH_OFFSET\t\t\t\t0  \n#define GEM_TSH_SIZE\t\t\t\t16\n\n \n#define GEM_TSL_OFFSET\t\t\t\t0  \n#define GEM_TSL_SIZE\t\t\t\t32\n\n \n#define GEM_TN_OFFSET\t\t\t\t0  \n#define GEM_TN_SIZE\t\t\t\t\t30\n\n \n#define GEM_TXTSMODE_OFFSET\t\t\t4  \n#define GEM_TXTSMODE_SIZE\t\t\t2\n\n \n#define GEM_RXTSMODE_OFFSET\t\t\t4  \n#define GEM_RXTSMODE_SIZE\t\t\t2\n\n \n#define GEM_QUEUE_OFFSET\t\t\t0  \n#define GEM_QUEUE_SIZE\t\t\t\t4\n#define GEM_VLANPR_OFFSET\t\t\t4  \n#define GEM_VLANPR_SIZE\t\t\t\t3\n#define GEM_VLANEN_OFFSET\t\t\t8  \n#define GEM_VLANEN_SIZE\t\t\t\t1\n#define GEM_ETHT2IDX_OFFSET\t\t\t9  \n#define GEM_ETHT2IDX_SIZE\t\t\t3\n#define GEM_ETHTEN_OFFSET\t\t\t12  \n#define GEM_ETHTEN_SIZE\t\t\t\t1\n#define GEM_CMPA_OFFSET\t\t\t\t13  \n#define GEM_CMPA_SIZE\t\t\t\t5\n#define GEM_CMPAEN_OFFSET\t\t\t18  \n#define GEM_CMPAEN_SIZE\t\t\t\t1\n#define GEM_CMPB_OFFSET\t\t\t\t19  \n#define GEM_CMPB_SIZE\t\t\t\t5\n#define GEM_CMPBEN_OFFSET\t\t\t24  \n#define GEM_CMPBEN_SIZE\t\t\t\t1\n#define GEM_CMPC_OFFSET\t\t\t\t25  \n#define GEM_CMPC_SIZE\t\t\t\t5\n#define GEM_CMPCEN_OFFSET\t\t\t30  \n#define GEM_CMPCEN_SIZE\t\t\t\t1\n\n \n#define GEM_ETHTCMP_OFFSET\t\t\t0  \n#define GEM_ETHTCMP_SIZE\t\t\t16\n\n \n#define GEM_T2CMP_OFFSET\t\t\t16  \n#define GEM_T2CMP_SIZE\t\t\t\t16\n#define GEM_T2MASK_OFFSET\t\t\t0  \n#define GEM_T2MASK_SIZE\t\t\t\t16\n\n \n#define GEM_T2DISMSK_OFFSET\t\t\t9  \n#define GEM_T2DISMSK_SIZE\t\t\t1\n#define GEM_T2CMPOFST_OFFSET\t\t\t7  \n#define GEM_T2CMPOFST_SIZE\t\t\t2\n#define GEM_T2OFST_OFFSET\t\t\t0  \n#define GEM_T2OFST_SIZE\t\t\t\t7\n\n \n#define GEM_T2COMPOFST_SOF\t\t0\n#define GEM_T2COMPOFST_ETYPE\t1\n#define GEM_T2COMPOFST_IPHDR\t2\n#define GEM_T2COMPOFST_TCPUDP\t3\n\n \n#define ETYPE_SRCIP_OFFSET\t\t\t12\n#define ETYPE_DSTIP_OFFSET\t\t\t16\n\n \n#define IPHDR_SRCPORT_OFFSET\t\t0\n#define IPHDR_DSTPORT_OFFSET\t\t2\n\n \n#define GEM_DMA_TXVALID_OFFSET\t\t23  \n#define GEM_DMA_TXVALID_SIZE\t\t1\n\n \n#define GEM_DMA_RXVALID_OFFSET\t\t2  \n#define GEM_DMA_RXVALID_SIZE\t\t1\n\n \n#define GEM_DMA_SECL_OFFSET\t\t\t30  \n#define GEM_DMA_SECL_SIZE\t\t\t2\n#define GEM_DMA_NSEC_OFFSET\t\t\t0  \n#define GEM_DMA_NSEC_SIZE\t\t\t30\n\n \n\n \n#define GEM_DMA_SECH_OFFSET\t\t\t0  \n#define GEM_DMA_SECH_SIZE\t\t\t4\n#define GEM_DMA_SEC_WIDTH\t\t\t(GEM_DMA_SECH_SIZE + GEM_DMA_SECL_SIZE)\n#define GEM_DMA_SEC_TOP\t\t\t\t(1 << GEM_DMA_SEC_WIDTH)\n#define GEM_DMA_SEC_MASK\t\t\t(GEM_DMA_SEC_TOP - 1)\n\n \n#define GEM_ADDSUB_OFFSET\t\t\t31\n#define GEM_ADDSUB_SIZE\t\t\t\t1\n \n#define MACB_CLK_DIV8\t\t\t\t0\n#define MACB_CLK_DIV16\t\t\t\t1\n#define MACB_CLK_DIV32\t\t\t\t2\n#define MACB_CLK_DIV64\t\t\t\t3\n\n \n#define GEM_CLK_DIV8\t\t\t\t0\n#define GEM_CLK_DIV16\t\t\t\t1\n#define GEM_CLK_DIV32\t\t\t\t2\n#define GEM_CLK_DIV48\t\t\t\t3\n#define GEM_CLK_DIV64\t\t\t\t4\n#define GEM_CLK_DIV96\t\t\t\t5\n#define GEM_CLK_DIV128\t\t\t\t6\n#define GEM_CLK_DIV224\t\t\t\t7\n\n \n#define MACB_MAN_C22_SOF\t\t\t1\n#define MACB_MAN_C22_WRITE\t\t\t1\n#define MACB_MAN_C22_READ\t\t\t2\n#define MACB_MAN_C22_CODE\t\t\t2\n\n#define MACB_MAN_C45_SOF\t\t\t0\n#define MACB_MAN_C45_ADDR\t\t\t0\n#define MACB_MAN_C45_WRITE\t\t\t1\n#define MACB_MAN_C45_POST_READ_INCR\t\t2\n#define MACB_MAN_C45_READ\t\t\t3\n#define MACB_MAN_C45_CODE\t\t\t2\n\n \n#define MACB_CAPS_ISR_CLEAR_ON_WRITE\t\t0x00000001\n#define MACB_CAPS_USRIO_HAS_CLKEN\t\t0x00000002\n#define MACB_CAPS_USRIO_DEFAULT_IS_MII_GMII\t0x00000004\n#define MACB_CAPS_NO_GIGABIT_HALF\t\t0x00000008\n#define MACB_CAPS_USRIO_DISABLED\t\t0x00000010\n#define MACB_CAPS_JUMBO\t\t\t\t0x00000020\n#define MACB_CAPS_GEM_HAS_PTP\t\t\t0x00000040\n#define MACB_CAPS_BD_RD_PREFETCH\t\t0x00000080\n#define MACB_CAPS_NEEDS_RSTONUBR\t\t0x00000100\n#define MACB_CAPS_MIIONRGMII\t\t\t0x00000200\n#define MACB_CAPS_NEED_TSUCLK\t\t\t0x00000400\n#define MACB_CAPS_PCS\t\t\t\t0x01000000\n#define MACB_CAPS_HIGH_SPEED\t\t\t0x02000000\n#define MACB_CAPS_CLK_HW_CHG\t\t\t0x04000000\n#define MACB_CAPS_MACB_IS_EMAC\t\t\t0x08000000\n#define MACB_CAPS_FIFO_MODE\t\t\t0x10000000\n#define MACB_CAPS_GIGABIT_MODE_AVAILABLE\t0x20000000\n#define MACB_CAPS_SG_DISABLED\t\t\t0x40000000\n#define MACB_CAPS_MACB_IS_GEM\t\t\t0x80000000\n\n \n#define MACB_LSO_UFO_ENABLE\t\t\t0x01\n#define MACB_LSO_TSO_ENABLE\t\t\t0x02\n\n \n#define MACB_BIT(name)\t\t\t\t\t\\\n\t(1 << MACB_##name##_OFFSET)\n#define MACB_BF(name,value)\t\t\t\t\\\n\t(((value) & ((1 << MACB_##name##_SIZE) - 1))\t\\\n\t << MACB_##name##_OFFSET)\n#define MACB_BFEXT(name,value)\\\n\t(((value) >> MACB_##name##_OFFSET)\t\t\\\n\t & ((1 << MACB_##name##_SIZE) - 1))\n#define MACB_BFINS(name,value,old)\t\t\t\\\n\t(((old) & ~(((1 << MACB_##name##_SIZE) - 1)\t\\\n\t\t    << MACB_##name##_OFFSET))\t\t\\\n\t | MACB_BF(name,value))\n\n#define GEM_BIT(name)\t\t\t\t\t\\\n\t(1 << GEM_##name##_OFFSET)\n#define GEM_BF(name, value)\t\t\t\t\\\n\t(((value) & ((1 << GEM_##name##_SIZE) - 1))\t\\\n\t << GEM_##name##_OFFSET)\n#define GEM_BFEXT(name, value)\\\n\t(((value) >> GEM_##name##_OFFSET)\t\t\\\n\t & ((1 << GEM_##name##_SIZE) - 1))\n#define GEM_BFINS(name, value, old)\t\t\t\\\n\t(((old) & ~(((1 << GEM_##name##_SIZE) - 1)\t\\\n\t\t    << GEM_##name##_OFFSET))\t\t\\\n\t | GEM_BF(name, value))\n\n \n#define macb_readl(port, reg)\t\t(port)->macb_reg_readl((port), MACB_##reg)\n#define macb_writel(port, reg, value)\t(port)->macb_reg_writel((port), MACB_##reg, (value))\n#define gem_readl(port, reg)\t\t(port)->macb_reg_readl((port), GEM_##reg)\n#define gem_writel(port, reg, value)\t(port)->macb_reg_writel((port), GEM_##reg, (value))\n#define queue_readl(queue, reg)\t\t(queue)->bp->macb_reg_readl((queue)->bp, (queue)->reg)\n#define queue_writel(queue, reg, value)\t(queue)->bp->macb_reg_writel((queue)->bp, (queue)->reg, (value))\n#define gem_readl_n(port, reg, idx)\t\t(port)->macb_reg_readl((port), GEM_##reg + idx * 4)\n#define gem_writel_n(port, reg, idx, value)\t(port)->macb_reg_writel((port), GEM_##reg + idx * 4, (value))\n\n \n#define macb_or_gem_writel(__bp, __reg, __value) \\\n\t({ \\\n\t\tif (macb_is_gem((__bp))) \\\n\t\t\tgem_writel((__bp), __reg, __value); \\\n\t\telse \\\n\t\t\tmacb_writel((__bp), __reg, __value); \\\n\t})\n\n#define macb_or_gem_readl(__bp, __reg) \\\n\t({ \\\n\t\tu32 __v; \\\n\t\tif (macb_is_gem((__bp))) \\\n\t\t\t__v = gem_readl((__bp), __reg); \\\n\t\telse \\\n\t\t\t__v = macb_readl((__bp), __reg); \\\n\t\t__v; \\\n\t})\n\n#define MACB_READ_NSR(bp)\tmacb_readl(bp, NSR)\n\n \nstruct macb_dma_desc {\n\tu32\taddr;\n\tu32\tctrl;\n};\n\n#ifdef MACB_EXT_DESC\n#define HW_DMA_CAP_32B\t\t0\n#define HW_DMA_CAP_64B\t\t(1 << 0)\n#define HW_DMA_CAP_PTP\t\t(1 << 1)\n#define HW_DMA_CAP_64B_PTP\t(HW_DMA_CAP_64B | HW_DMA_CAP_PTP)\n\nstruct macb_dma_desc_64 {\n\tu32 addrh;\n\tu32 resvd;\n};\n\nstruct macb_dma_desc_ptp {\n\tu32\tts_1;\n\tu32\tts_2;\n};\n#endif\n\n \n#define MACB_RX_USED_OFFSET\t\t\t0\n#define MACB_RX_USED_SIZE\t\t\t1\n#define MACB_RX_WRAP_OFFSET\t\t\t1\n#define MACB_RX_WRAP_SIZE\t\t\t1\n#define MACB_RX_WADDR_OFFSET\t\t\t2\n#define MACB_RX_WADDR_SIZE\t\t\t30\n\n#define MACB_RX_FRMLEN_OFFSET\t\t\t0\n#define MACB_RX_FRMLEN_SIZE\t\t\t12\n#define MACB_RX_OFFSET_OFFSET\t\t\t12\n#define MACB_RX_OFFSET_SIZE\t\t\t2\n#define MACB_RX_SOF_OFFSET\t\t\t14\n#define MACB_RX_SOF_SIZE\t\t\t1\n#define MACB_RX_EOF_OFFSET\t\t\t15\n#define MACB_RX_EOF_SIZE\t\t\t1\n#define MACB_RX_CFI_OFFSET\t\t\t16\n#define MACB_RX_CFI_SIZE\t\t\t1\n#define MACB_RX_VLAN_PRI_OFFSET\t\t\t17\n#define MACB_RX_VLAN_PRI_SIZE\t\t\t3\n#define MACB_RX_PRI_TAG_OFFSET\t\t\t20\n#define MACB_RX_PRI_TAG_SIZE\t\t\t1\n#define MACB_RX_VLAN_TAG_OFFSET\t\t\t21\n#define MACB_RX_VLAN_TAG_SIZE\t\t\t1\n#define MACB_RX_TYPEID_MATCH_OFFSET\t\t22\n#define MACB_RX_TYPEID_MATCH_SIZE\t\t1\n#define MACB_RX_SA4_MATCH_OFFSET\t\t23\n#define MACB_RX_SA4_MATCH_SIZE\t\t\t1\n#define MACB_RX_SA3_MATCH_OFFSET\t\t24\n#define MACB_RX_SA3_MATCH_SIZE\t\t\t1\n#define MACB_RX_SA2_MATCH_OFFSET\t\t25\n#define MACB_RX_SA2_MATCH_SIZE\t\t\t1\n#define MACB_RX_SA1_MATCH_OFFSET\t\t26\n#define MACB_RX_SA1_MATCH_SIZE\t\t\t1\n#define MACB_RX_EXT_MATCH_OFFSET\t\t28\n#define MACB_RX_EXT_MATCH_SIZE\t\t\t1\n#define MACB_RX_UHASH_MATCH_OFFSET\t\t29\n#define MACB_RX_UHASH_MATCH_SIZE\t\t1\n#define MACB_RX_MHASH_MATCH_OFFSET\t\t30\n#define MACB_RX_MHASH_MATCH_SIZE\t\t1\n#define MACB_RX_BROADCAST_OFFSET\t\t31\n#define MACB_RX_BROADCAST_SIZE\t\t\t1\n\n#define MACB_RX_FRMLEN_MASK\t\t\t0xFFF\n#define MACB_RX_JFRMLEN_MASK\t\t\t0x3FFF\n\n \n#define GEM_RX_TYPEID_MATCH_OFFSET\t\t22\n#define GEM_RX_TYPEID_MATCH_SIZE\t\t2\n\n \n#define GEM_RX_CSUM_OFFSET\t\t\t22\n#define GEM_RX_CSUM_SIZE\t\t\t2\n\n#define MACB_TX_FRMLEN_OFFSET\t\t\t0\n#define MACB_TX_FRMLEN_SIZE\t\t\t11\n#define MACB_TX_LAST_OFFSET\t\t\t15\n#define MACB_TX_LAST_SIZE\t\t\t1\n#define MACB_TX_NOCRC_OFFSET\t\t\t16\n#define MACB_TX_NOCRC_SIZE\t\t\t1\n#define MACB_MSS_MFS_OFFSET\t\t\t16\n#define MACB_MSS_MFS_SIZE\t\t\t14\n#define MACB_TX_LSO_OFFSET\t\t\t17\n#define MACB_TX_LSO_SIZE\t\t\t2\n#define MACB_TX_TCP_SEQ_SRC_OFFSET\t\t19\n#define MACB_TX_TCP_SEQ_SRC_SIZE\t\t1\n#define MACB_TX_BUF_EXHAUSTED_OFFSET\t\t27\n#define MACB_TX_BUF_EXHAUSTED_SIZE\t\t1\n#define MACB_TX_UNDERRUN_OFFSET\t\t\t28\n#define MACB_TX_UNDERRUN_SIZE\t\t\t1\n#define MACB_TX_ERROR_OFFSET\t\t\t29\n#define MACB_TX_ERROR_SIZE\t\t\t1\n#define MACB_TX_WRAP_OFFSET\t\t\t30\n#define MACB_TX_WRAP_SIZE\t\t\t1\n#define MACB_TX_USED_OFFSET\t\t\t31\n#define MACB_TX_USED_SIZE\t\t\t1\n\n#define GEM_TX_FRMLEN_OFFSET\t\t\t0\n#define GEM_TX_FRMLEN_SIZE\t\t\t14\n\n \n#define GEM_RX_CSUM_NONE\t\t\t0\n#define GEM_RX_CSUM_IP_ONLY\t\t\t1\n#define GEM_RX_CSUM_IP_TCP\t\t\t2\n#define GEM_RX_CSUM_IP_UDP\t\t\t3\n\n \n#define GEM_RX_CSUM_CHECKED_MASK\t\t2\n\n \n#define PPM_FRACTION\t16\n\n \nstruct macb_tx_skb {\n\tstruct sk_buff\t\t*skb;\n\tdma_addr_t\t\tmapping;\n\tsize_t\t\t\tsize;\n\tbool\t\t\tmapped_as_page;\n};\n\n \nstruct macb_stats {\n\tu32\trx_pause_frames;\n\tu32\ttx_ok;\n\tu32\ttx_single_cols;\n\tu32\ttx_multiple_cols;\n\tu32\trx_ok;\n\tu32\trx_fcs_errors;\n\tu32\trx_align_errors;\n\tu32\ttx_deferred;\n\tu32\ttx_late_cols;\n\tu32\ttx_excessive_cols;\n\tu32\ttx_underruns;\n\tu32\ttx_carrier_errors;\n\tu32\trx_resource_errors;\n\tu32\trx_overruns;\n\tu32\trx_symbol_errors;\n\tu32\trx_oversize_pkts;\n\tu32\trx_jabbers;\n\tu32\trx_undersize_pkts;\n\tu32\tsqe_test_errors;\n\tu32\trx_length_mismatch;\n\tu32\ttx_pause_frames;\n};\n\nstruct gem_stats {\n\tu32\ttx_octets_31_0;\n\tu32\ttx_octets_47_32;\n\tu32\ttx_frames;\n\tu32\ttx_broadcast_frames;\n\tu32\ttx_multicast_frames;\n\tu32\ttx_pause_frames;\n\tu32\ttx_64_byte_frames;\n\tu32\ttx_65_127_byte_frames;\n\tu32\ttx_128_255_byte_frames;\n\tu32\ttx_256_511_byte_frames;\n\tu32\ttx_512_1023_byte_frames;\n\tu32\ttx_1024_1518_byte_frames;\n\tu32\ttx_greater_than_1518_byte_frames;\n\tu32\ttx_underrun;\n\tu32\ttx_single_collision_frames;\n\tu32\ttx_multiple_collision_frames;\n\tu32\ttx_excessive_collisions;\n\tu32\ttx_late_collisions;\n\tu32\ttx_deferred_frames;\n\tu32\ttx_carrier_sense_errors;\n\tu32\trx_octets_31_0;\n\tu32\trx_octets_47_32;\n\tu32\trx_frames;\n\tu32\trx_broadcast_frames;\n\tu32\trx_multicast_frames;\n\tu32\trx_pause_frames;\n\tu32\trx_64_byte_frames;\n\tu32\trx_65_127_byte_frames;\n\tu32\trx_128_255_byte_frames;\n\tu32\trx_256_511_byte_frames;\n\tu32\trx_512_1023_byte_frames;\n\tu32\trx_1024_1518_byte_frames;\n\tu32\trx_greater_than_1518_byte_frames;\n\tu32\trx_undersized_frames;\n\tu32\trx_oversize_frames;\n\tu32\trx_jabbers;\n\tu32\trx_frame_check_sequence_errors;\n\tu32\trx_length_field_frame_errors;\n\tu32\trx_symbol_errors;\n\tu32\trx_alignment_errors;\n\tu32\trx_resource_errors;\n\tu32\trx_overruns;\n\tu32\trx_ip_header_checksum_errors;\n\tu32\trx_tcp_checksum_errors;\n\tu32\trx_udp_checksum_errors;\n};\n\n \nstruct gem_statistic {\n\tchar stat_string[ETH_GSTRING_LEN];\n\tint offset;\n\tu32 stat_bits;\n};\n\n \n#define GEM_NDS_RXERR_OFFSET\t\t0\n#define GEM_NDS_RXLENERR_OFFSET\t\t1\n#define GEM_NDS_RXOVERERR_OFFSET\t2\n#define GEM_NDS_RXCRCERR_OFFSET\t\t3\n#define GEM_NDS_RXFRAMEERR_OFFSET\t4\n#define GEM_NDS_RXFIFOERR_OFFSET\t5\n#define GEM_NDS_TXERR_OFFSET\t\t6\n#define GEM_NDS_TXABORTEDERR_OFFSET\t7\n#define GEM_NDS_TXCARRIERERR_OFFSET\t8\n#define GEM_NDS_TXFIFOERR_OFFSET\t9\n#define GEM_NDS_COLLISIONS_OFFSET\t10\n\n#define GEM_STAT_TITLE(name, title) GEM_STAT_TITLE_BITS(name, title, 0)\n#define GEM_STAT_TITLE_BITS(name, title, bits) {\t\\\n\t.stat_string = title,\t\t\t\t\\\n\t.offset = GEM_##name,\t\t\t\t\\\n\t.stat_bits = bits\t\t\t\t\\\n}\n\n \nstatic const struct gem_statistic gem_statistics[] = {\n\tGEM_STAT_TITLE(OCTTXL, \"tx_octets\"),  \n\tGEM_STAT_TITLE(TXCNT, \"tx_frames\"),\n\tGEM_STAT_TITLE(TXBCCNT, \"tx_broadcast_frames\"),\n\tGEM_STAT_TITLE(TXMCCNT, \"tx_multicast_frames\"),\n\tGEM_STAT_TITLE(TXPAUSECNT, \"tx_pause_frames\"),\n\tGEM_STAT_TITLE(TX64CNT, \"tx_64_byte_frames\"),\n\tGEM_STAT_TITLE(TX65CNT, \"tx_65_127_byte_frames\"),\n\tGEM_STAT_TITLE(TX128CNT, \"tx_128_255_byte_frames\"),\n\tGEM_STAT_TITLE(TX256CNT, \"tx_256_511_byte_frames\"),\n\tGEM_STAT_TITLE(TX512CNT, \"tx_512_1023_byte_frames\"),\n\tGEM_STAT_TITLE(TX1024CNT, \"tx_1024_1518_byte_frames\"),\n\tGEM_STAT_TITLE(TX1519CNT, \"tx_greater_than_1518_byte_frames\"),\n\tGEM_STAT_TITLE_BITS(TXURUNCNT, \"tx_underrun\",\n\t\t\t    GEM_BIT(NDS_TXERR)|GEM_BIT(NDS_TXFIFOERR)),\n\tGEM_STAT_TITLE_BITS(SNGLCOLLCNT, \"tx_single_collision_frames\",\n\t\t\t    GEM_BIT(NDS_TXERR)|GEM_BIT(NDS_COLLISIONS)),\n\tGEM_STAT_TITLE_BITS(MULTICOLLCNT, \"tx_multiple_collision_frames\",\n\t\t\t    GEM_BIT(NDS_TXERR)|GEM_BIT(NDS_COLLISIONS)),\n\tGEM_STAT_TITLE_BITS(EXCESSCOLLCNT, \"tx_excessive_collisions\",\n\t\t\t    GEM_BIT(NDS_TXERR)|\n\t\t\t    GEM_BIT(NDS_TXABORTEDERR)|\n\t\t\t    GEM_BIT(NDS_COLLISIONS)),\n\tGEM_STAT_TITLE_BITS(LATECOLLCNT, \"tx_late_collisions\",\n\t\t\t    GEM_BIT(NDS_TXERR)|GEM_BIT(NDS_COLLISIONS)),\n\tGEM_STAT_TITLE(TXDEFERCNT, \"tx_deferred_frames\"),\n\tGEM_STAT_TITLE_BITS(TXCSENSECNT, \"tx_carrier_sense_errors\",\n\t\t\t    GEM_BIT(NDS_TXERR)|GEM_BIT(NDS_COLLISIONS)),\n\tGEM_STAT_TITLE(OCTRXL, \"rx_octets\"),  \n\tGEM_STAT_TITLE(RXCNT, \"rx_frames\"),\n\tGEM_STAT_TITLE(RXBROADCNT, \"rx_broadcast_frames\"),\n\tGEM_STAT_TITLE(RXMULTICNT, \"rx_multicast_frames\"),\n\tGEM_STAT_TITLE(RXPAUSECNT, \"rx_pause_frames\"),\n\tGEM_STAT_TITLE(RX64CNT, \"rx_64_byte_frames\"),\n\tGEM_STAT_TITLE(RX65CNT, \"rx_65_127_byte_frames\"),\n\tGEM_STAT_TITLE(RX128CNT, \"rx_128_255_byte_frames\"),\n\tGEM_STAT_TITLE(RX256CNT, \"rx_256_511_byte_frames\"),\n\tGEM_STAT_TITLE(RX512CNT, \"rx_512_1023_byte_frames\"),\n\tGEM_STAT_TITLE(RX1024CNT, \"rx_1024_1518_byte_frames\"),\n\tGEM_STAT_TITLE(RX1519CNT, \"rx_greater_than_1518_byte_frames\"),\n\tGEM_STAT_TITLE_BITS(RXUNDRCNT, \"rx_undersized_frames\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXLENERR)),\n\tGEM_STAT_TITLE_BITS(RXOVRCNT, \"rx_oversize_frames\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXLENERR)),\n\tGEM_STAT_TITLE_BITS(RXJABCNT, \"rx_jabbers\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXLENERR)),\n\tGEM_STAT_TITLE_BITS(RXFCSCNT, \"rx_frame_check_sequence_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXCRCERR)),\n\tGEM_STAT_TITLE_BITS(RXLENGTHCNT, \"rx_length_field_frame_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)),\n\tGEM_STAT_TITLE_BITS(RXSYMBCNT, \"rx_symbol_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXFRAMEERR)),\n\tGEM_STAT_TITLE_BITS(RXALIGNCNT, \"rx_alignment_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXOVERERR)),\n\tGEM_STAT_TITLE_BITS(RXRESERRCNT, \"rx_resource_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXOVERERR)),\n\tGEM_STAT_TITLE_BITS(RXORCNT, \"rx_overruns\",\n\t\t\t    GEM_BIT(NDS_RXERR)|GEM_BIT(NDS_RXFIFOERR)),\n\tGEM_STAT_TITLE_BITS(RXIPCCNT, \"rx_ip_header_checksum_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)),\n\tGEM_STAT_TITLE_BITS(RXTCPCCNT, \"rx_tcp_checksum_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)),\n\tGEM_STAT_TITLE_BITS(RXUDPCCNT, \"rx_udp_checksum_errors\",\n\t\t\t    GEM_BIT(NDS_RXERR)),\n};\n\n#define GEM_STATS_LEN ARRAY_SIZE(gem_statistics)\n\n#define QUEUE_STAT_TITLE(title) {\t\\\n\t.stat_string = title,\t\t\t\\\n}\n\n \nstruct queue_stats {\n\tunion {\n\t\tunsigned long first;\n\t\tunsigned long rx_packets;\n\t};\n\tunsigned long rx_bytes;\n\tunsigned long rx_dropped;\n\tunsigned long tx_packets;\n\tunsigned long tx_bytes;\n\tunsigned long tx_dropped;\n};\n\nstatic const struct gem_statistic queue_statistics[] = {\n\t\tQUEUE_STAT_TITLE(\"rx_packets\"),\n\t\tQUEUE_STAT_TITLE(\"rx_bytes\"),\n\t\tQUEUE_STAT_TITLE(\"rx_dropped\"),\n\t\tQUEUE_STAT_TITLE(\"tx_packets\"),\n\t\tQUEUE_STAT_TITLE(\"tx_bytes\"),\n\t\tQUEUE_STAT_TITLE(\"tx_dropped\"),\n};\n\n#define QUEUE_STATS_LEN ARRAY_SIZE(queue_statistics)\n\nstruct macb;\nstruct macb_queue;\n\nstruct macb_or_gem_ops {\n\tint\t(*mog_alloc_rx_buffers)(struct macb *bp);\n\tvoid\t(*mog_free_rx_buffers)(struct macb *bp);\n\tvoid\t(*mog_init_rings)(struct macb *bp);\n\tint\t(*mog_rx)(struct macb_queue *queue, struct napi_struct *napi,\n\t\t\t  int budget);\n};\n\n \nstruct macb_ptp_info {\n\tvoid (*ptp_init)(struct net_device *ndev);\n\tvoid (*ptp_remove)(struct net_device *ndev);\n\ts32 (*get_ptp_max_adj)(void);\n\tunsigned int (*get_tsu_rate)(struct macb *bp);\n\tint (*get_ts_info)(struct net_device *dev,\n\t\t\t   struct ethtool_ts_info *info);\n\tint (*get_hwtst)(struct net_device *netdev,\n\t\t\t struct ifreq *ifr);\n\tint (*set_hwtst)(struct net_device *netdev,\n\t\t\t struct ifreq *ifr, int cmd);\n};\n\nstruct macb_pm_data {\n\tu32 scrt2;\n\tu32 usrio;\n};\n\nstruct macb_usrio_config {\n\tu32 mii;\n\tu32 rmii;\n\tu32 rgmii;\n\tu32 refclk;\n\tu32 hdfctlen;\n};\n\nstruct macb_config {\n\tu32\t\t\tcaps;\n\tunsigned int\t\tdma_burst_length;\n\tint\t(*clk_init)(struct platform_device *pdev, struct clk **pclk,\n\t\t\t    struct clk **hclk, struct clk **tx_clk,\n\t\t\t    struct clk **rx_clk, struct clk **tsu_clk);\n\tint\t(*init)(struct platform_device *pdev);\n\tunsigned int\t\tmax_tx_length;\n\tint\tjumbo_max_len;\n\tconst struct macb_usrio_config *usrio;\n};\n\nstruct tsu_incr {\n\tu32 sub_ns;\n\tu32 ns;\n};\n\nstruct macb_queue {\n\tstruct macb\t\t*bp;\n\tint\t\t\tirq;\n\n\tunsigned int\t\tISR;\n\tunsigned int\t\tIER;\n\tunsigned int\t\tIDR;\n\tunsigned int\t\tIMR;\n\tunsigned int\t\tTBQP;\n\tunsigned int\t\tTBQPH;\n\tunsigned int\t\tRBQS;\n\tunsigned int\t\tRBQP;\n\tunsigned int\t\tRBQPH;\n\n\t \n\tspinlock_t\t\ttx_ptr_lock;\n\tunsigned int\t\ttx_head, tx_tail;\n\tstruct macb_dma_desc\t*tx_ring;\n\tstruct macb_tx_skb\t*tx_skb;\n\tdma_addr_t\t\ttx_ring_dma;\n\tstruct work_struct\ttx_error_task;\n\tbool\t\t\ttxubr_pending;\n\tstruct napi_struct\tnapi_tx;\n\n\tdma_addr_t\t\trx_ring_dma;\n\tdma_addr_t\t\trx_buffers_dma;\n\tunsigned int\t\trx_tail;\n\tunsigned int\t\trx_prepared_head;\n\tstruct macb_dma_desc\t*rx_ring;\n\tstruct sk_buff\t\t**rx_skbuff;\n\tvoid\t\t\t*rx_buffers;\n\tstruct napi_struct\tnapi_rx;\n\tstruct queue_stats stats;\n};\n\nstruct ethtool_rx_fs_item {\n\tstruct ethtool_rx_flow_spec fs;\n\tstruct list_head list;\n};\n\nstruct ethtool_rx_fs_list {\n\tstruct list_head list;\n\tunsigned int count;\n};\n\nstruct macb {\n\tvoid __iomem\t\t*regs;\n\tbool\t\t\tnative_io;\n\n\t \n\tu32\t(*macb_reg_readl)(struct macb *bp, int offset);\n\tvoid\t(*macb_reg_writel)(struct macb *bp, int offset, u32 value);\n\n\tsize_t\t\t\trx_buffer_size;\n\n\tunsigned int\t\trx_ring_size;\n\tunsigned int\t\ttx_ring_size;\n\n\tunsigned int\t\tnum_queues;\n\tunsigned int\t\tqueue_mask;\n\tstruct macb_queue\tqueues[MACB_MAX_QUEUES];\n\n\tspinlock_t\t\tlock;\n\tstruct platform_device\t*pdev;\n\tstruct clk\t\t*pclk;\n\tstruct clk\t\t*hclk;\n\tstruct clk\t\t*tx_clk;\n\tstruct clk\t\t*rx_clk;\n\tstruct clk\t\t*tsu_clk;\n\tstruct net_device\t*dev;\n\tunion {\n\t\tstruct macb_stats\tmacb;\n\t\tstruct gem_stats\tgem;\n\t}\t\t\thw_stats;\n\n\tstruct macb_or_gem_ops\tmacbgem_ops;\n\n\tstruct mii_bus\t\t*mii_bus;\n\tstruct phylink\t\t*phylink;\n\tstruct phylink_config\tphylink_config;\n\tstruct phylink_pcs\tphylink_usx_pcs;\n\tstruct phylink_pcs\tphylink_sgmii_pcs;\n\n\tu32\t\t\tcaps;\n\tunsigned int\t\tdma_burst_length;\n\n\tphy_interface_t\t\tphy_interface;\n\n\t \n\tstruct macb_tx_skb\trm9200_txq[2];\n\tunsigned int\t\tmax_tx_length;\n\n\tu64\t\t\tethtool_stats[GEM_STATS_LEN + QUEUE_STATS_LEN * MACB_MAX_QUEUES];\n\n\tunsigned int\t\trx_frm_len_mask;\n\tunsigned int\t\tjumbo_max_len;\n\n\tu32\t\t\twol;\n\n\t \n\tu32\t\t\trx_watermark;\n\n\tstruct macb_ptp_info\t*ptp_info;\t \n\n\tstruct phy\t\t*sgmii_phy;\t \n\n#ifdef MACB_EXT_DESC\n\tuint8_t hw_dma_cap;\n#endif\n\tspinlock_t tsu_clk_lock;  \n\tunsigned int tsu_rate;\n\tstruct ptp_clock *ptp_clock;\n\tstruct ptp_clock_info ptp_clock_info;\n\tstruct tsu_incr tsu_incr;\n\tstruct hwtstamp_config tstamp_config;\n\n\t \n\tstruct ethtool_rx_fs_list rx_fs_list;\n\tspinlock_t rx_fs_lock;\n\tunsigned int max_tuples;\n\n\tstruct tasklet_struct\thresp_err_tasklet;\n\n\tint\trx_bd_rd_prefetch;\n\tint\ttx_bd_rd_prefetch;\n\n\tu32\trx_intr_mask;\n\n\tstruct macb_pm_data pm_data;\n\tconst struct macb_usrio_config *usrio;\n};\n\n#ifdef CONFIG_MACB_USE_HWSTAMP\n#define GEM_TSEC_SIZE  (GEM_TSH_SIZE + GEM_TSL_SIZE)\n#define TSU_SEC_MAX_VAL (((u64)1 << GEM_TSEC_SIZE) - 1)\n#define TSU_NSEC_MAX_VAL ((1 << GEM_TN_SIZE) - 1)\n\nenum macb_bd_control {\n\tTSTAMP_DISABLED,\n\tTSTAMP_FRAME_PTP_EVENT_ONLY,\n\tTSTAMP_ALL_PTP_FRAMES,\n\tTSTAMP_ALL_FRAMES,\n};\n\nvoid gem_ptp_init(struct net_device *ndev);\nvoid gem_ptp_remove(struct net_device *ndev);\nvoid gem_ptp_txstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc);\nvoid gem_ptp_rxstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc);\nstatic inline void gem_ptp_do_txstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc)\n{\n\tif (bp->tstamp_config.tx_type == TSTAMP_DISABLED)\n\t\treturn;\n\n\tgem_ptp_txstamp(bp, skb, desc);\n}\n\nstatic inline void gem_ptp_do_rxstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc)\n{\n\tif (bp->tstamp_config.rx_filter == TSTAMP_DISABLED)\n\t\treturn;\n\n\tgem_ptp_rxstamp(bp, skb, desc);\n}\nint gem_get_hwtst(struct net_device *dev, struct ifreq *rq);\nint gem_set_hwtst(struct net_device *dev, struct ifreq *ifr, int cmd);\n#else\nstatic inline void gem_ptp_init(struct net_device *ndev) { }\nstatic inline void gem_ptp_remove(struct net_device *ndev) { }\n\nstatic inline void gem_ptp_do_txstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc) { }\nstatic inline void gem_ptp_do_rxstamp(struct macb *bp, struct sk_buff *skb, struct macb_dma_desc *desc) { }\n#endif\n\nstatic inline bool macb_is_gem(struct macb *bp)\n{\n\treturn !!(bp->caps & MACB_CAPS_MACB_IS_GEM);\n}\n\nstatic inline bool gem_has_ptp(struct macb *bp)\n{\n\treturn IS_ENABLED(CONFIG_MACB_USE_HWSTAMP) && (bp->caps & MACB_CAPS_GEM_HAS_PTP);\n}\n\n \nstruct macb_platform_data {\n\tstruct clk\t*pclk;\n\tstruct clk\t*hclk;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}