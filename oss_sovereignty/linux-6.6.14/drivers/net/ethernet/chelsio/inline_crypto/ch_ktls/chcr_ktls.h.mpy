{
  "module_name": "chcr_ktls.h",
  "hash_id": "861bc753351e6f36ef7cb37ca5f41ac6d1e4adc97a1049b6de8d8b28356cfba9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/chelsio/inline_crypto/ch_ktls/chcr_ktls.h",
  "human_readable_source": " \n \n\n#ifndef __CHCR_KTLS_H__\n#define __CHCR_KTLS_H__\n\n#include \"cxgb4.h\"\n#include \"t4_msg.h\"\n#include \"t4_tcb.h\"\n#include \"l2t.h\"\n#include \"chcr_common.h\"\n#include \"cxgb4_uld.h\"\n#include \"clip_tbl.h\"\n\n#define CHCR_KTLS_DRV_MODULE_NAME \"ch_ktls\"\n#define CHCR_KTLS_DRV_VERSION \"1.0.0.0-ko\"\n#define CHCR_KTLS_DRV_DESC \"Chelsio NIC TLS ULD Driver\"\n\n#define CHCR_TCB_STATE_CLOSED\t0\n#define CHCR_KTLS_KEY_CTX_LEN\t16\n#define CHCR_SET_TCB_FIELD_LEN\tsizeof(struct cpl_set_tcb_field)\n#define CHCR_PLAIN_TX_DATA_LEN\t(sizeof(struct fw_ulptx_wr) +\\\n\t\t\t\t sizeof(struct ulp_txpkt) +\\\n\t\t\t\t sizeof(struct ulptx_idata) +\\\n\t\t\t\t sizeof(struct cpl_tx_data))\n\n#define CHCR_KTLS_WR_SIZE\t(CHCR_PLAIN_TX_DATA_LEN +\\\n\t\t\t\t sizeof(struct cpl_tx_sec_pdu))\n#define FALLBACK\t\t35\n\nenum ch_ktls_open_state {\n\tCH_KTLS_OPEN_SUCCESS = 0,\n\tCH_KTLS_OPEN_PENDING = 1,\n\tCH_KTLS_OPEN_FAILURE = 2,\n};\n\nstruct chcr_ktls_info {\n\tstruct sock *sk;\n\tspinlock_t lock;  \n\tstruct ktls_key_ctx key_ctx;\n\tstruct adapter *adap;\n\tstruct l2t_entry *l2te;\n\tstruct net_device *netdev;\n\tstruct completion completion;\n\tu64 iv;\n\tu64 record_no;\n\tint tid;\n\tint atid;\n\tint rx_qid;\n\tu32 iv_size;\n\tu32 prev_seq;\n\tu32 prev_ack;\n\tu32 salt_size;\n\tu32 key_ctx_len;\n\tu32 scmd0_seqno_numivs;\n\tu32 scmd0_ivgen_hdrlen;\n\tu32 tcp_start_seq_number;\n\tu32 scmd0_short_seqno_numivs;\n\tu32 scmd0_short_ivgen_hdrlen;\n\tu16 prev_win;\n\tu8 tx_chan;\n\tu8 smt_idx;\n\tu8 port_id;\n\tu8 ip_family;\n\tu8 first_qset;\n\tenum ch_ktls_open_state open_state;\n\tbool pending_close;\n};\n\nstruct chcr_ktls_ofld_ctx_tx {\n\tstruct tls_offload_context_tx base;\n\tstruct chcr_ktls_info *chcr_info;\n};\n\nstruct chcr_ktls_uld_ctx {\n\tstruct list_head entry;\n\tstruct cxgb4_lld_info lldi;\n\tstruct xarray tid_list;\n\tbool detach;\n};\n\nstatic inline struct chcr_ktls_ofld_ctx_tx *\nchcr_get_ktls_tx_context(struct tls_context *tls_ctx)\n{\n\tBUILD_BUG_ON(sizeof(struct chcr_ktls_ofld_ctx_tx) >\n\t\t     TLS_OFFLOAD_CONTEXT_SIZE_TX);\n\treturn container_of(tls_offload_ctx_tx(tls_ctx),\n\t\t\t    struct chcr_ktls_ofld_ctx_tx,\n\t\t\t    base);\n}\n\nstatic inline int chcr_get_first_rx_qid(struct adapter *adap)\n{\n\t \n\tstruct chcr_ktls_uld_ctx *u_ctx = adap->uld[CXGB4_ULD_KTLS].handle;\n\n\tif (!u_ctx)\n\t\treturn -1;\n\treturn u_ctx->lldi.rxq_ids[0];\n}\n\ntypedef int (*chcr_handler_func)(struct adapter *adap, unsigned char *input);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}