{
  "module_name": "common.h",
  "hash_id": "dbed665b4b0368635e3b5d763b46502340b1602cc295629534691a2c2ee08a95",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/chelsio/cxgb/common.h",
  "human_readable_source": " \n \n\n#define pr_fmt(fmt) \"cxgb: \" fmt\n\n#ifndef _CXGB_COMMON_H_\n#define _CXGB_COMMON_H_\n\n#include <linux/module.h>\n#include <linux/netdevice.h>\n#include <linux/types.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/ethtool.h>\n#include <linux/if_vlan.h>\n#include <linux/mdio.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <asm/io.h>\n#include <linux/pci_ids.h>\n\n#define DRV_DESCRIPTION \"Chelsio 10Gb Ethernet Driver\"\n#define DRV_NAME \"cxgb\"\n\n#define CH_DEVICE(devid, ssid, idx) \\\n\t{ PCI_VENDOR_ID_CHELSIO, devid, PCI_ANY_ID, ssid, 0, 0, idx }\n\n#define SUPPORTED_PAUSE       (1 << 13)\n#define SUPPORTED_LOOPBACK    (1 << 15)\n\n#define ADVERTISED_PAUSE      (1 << 13)\n#define ADVERTISED_ASYM_PAUSE (1 << 14)\n\ntypedef struct adapter adapter_t;\n\nstruct t1_rx_mode {\n       struct net_device *dev;\n};\n\n#define t1_rx_mode_promisc(rm)\t(rm->dev->flags & IFF_PROMISC)\n#define t1_rx_mode_allmulti(rm)\t(rm->dev->flags & IFF_ALLMULTI)\n#define t1_rx_mode_mc_cnt(rm)\t(netdev_mc_count(rm->dev))\n#define t1_get_netdev(rm)\t(rm->dev)\n\n#define\tMAX_NPORTS 4\n#define PORT_MASK ((1 << MAX_NPORTS) - 1)\n#define NMTUS      8\n#define TCB_SIZE   128\n\n#define SPEED_INVALID 0xffff\n#define DUPLEX_INVALID 0xff\n\n \n#define PM3393_MAX_FRAME_SIZE 9600\n\n#define VSC7326_MAX_MTU 9600\n\nenum {\n\tCHBT_BOARD_N110,\n\tCHBT_BOARD_N210,\n\tCHBT_BOARD_7500,\n\tCHBT_BOARD_8000,\n\tCHBT_BOARD_CHT101,\n\tCHBT_BOARD_CHT110,\n\tCHBT_BOARD_CHT210,\n\tCHBT_BOARD_CHT204,\n\tCHBT_BOARD_CHT204V,\n\tCHBT_BOARD_CHT204E,\n\tCHBT_BOARD_CHN204,\n\tCHBT_BOARD_COUGAR,\n\tCHBT_BOARD_6800,\n\tCHBT_BOARD_SIMUL,\n};\n\nenum {\n\tCHBT_TERM_FPGA,\n\tCHBT_TERM_T1,\n\tCHBT_TERM_T2,\n\tCHBT_TERM_T3\n};\n\nenum {\n\tCHBT_MAC_CHELSIO_A,\n\tCHBT_MAC_IXF1010,\n\tCHBT_MAC_PM3393,\n\tCHBT_MAC_VSC7321,\n\tCHBT_MAC_DUMMY\n};\n\nenum {\n\tCHBT_PHY_88E1041,\n\tCHBT_PHY_88E1111,\n\tCHBT_PHY_88X2010,\n\tCHBT_PHY_XPAK,\n\tCHBT_PHY_MY3126,\n\tCHBT_PHY_8244,\n\tCHBT_PHY_DUMMY\n};\n\nenum {\n\tPAUSE_RX      = 1 << 0,\n\tPAUSE_TX      = 1 << 1,\n\tPAUSE_AUTONEG = 1 << 2\n};\n\n \nenum {\n\tTERM_T1A   = 0,\n\tTERM_T1B   = 1,\n\tTERM_T2    = 3\n};\n\nstruct sge_params {\n\tunsigned int cmdQ_size[2];\n\tunsigned int freelQ_size[2];\n\tunsigned int large_buf_capacity;\n\tunsigned int rx_coalesce_usecs;\n\tunsigned int last_rx_coalesce_raw;\n\tunsigned int default_rx_coalesce_usecs;\n\tunsigned int sample_interval_usecs;\n\tunsigned int coalesce_enable;\n\tunsigned int polling;\n};\n\nstruct chelsio_pci_params {\n\tunsigned short speed;\n\tunsigned char  width;\n\tunsigned char  is_pcix;\n};\n\nstruct tp_params {\n\tunsigned int pm_size;\n\tunsigned int cm_size;\n\tunsigned int pm_rx_base;\n\tunsigned int pm_tx_base;\n\tunsigned int pm_rx_pg_size;\n\tunsigned int pm_tx_pg_size;\n\tunsigned int pm_rx_num_pgs;\n\tunsigned int pm_tx_num_pgs;\n\tunsigned int rx_coalescing_size;\n\tunsigned int use_5tuple_mode;\n};\n\nstruct mc5_params {\n\tunsigned int mode;        \n\tunsigned int nservers;    \n\tunsigned int nroutes;     \n};\n\n \n#define DEFAULT_SERVER_REGION_LEN 256\n#define DEFAULT_RT_REGION_LEN 1024\n\nstruct adapter_params {\n\tstruct sge_params sge;\n\tstruct mc5_params mc5;\n\tstruct tp_params  tp;\n\tstruct chelsio_pci_params pci;\n\n\tconst struct board_info *brd_info;\n\n\tunsigned short mtus[NMTUS];\n\tunsigned int   nports;           \n\tunsigned int   stats_update_period;\n\tunsigned short chip_revision;\n\tunsigned char  chip_version;\n\tunsigned char  is_asic;\n\tunsigned char  has_msi;\n};\n\nstruct link_config {\n\tunsigned int   supported;         \n\tunsigned int   advertising;       \n\tunsigned short requested_speed;   \n\tunsigned short speed;             \n\tunsigned char  requested_duplex;  \n\tunsigned char  duplex;            \n\tunsigned char  requested_fc;      \n\tunsigned char  fc;                \n\tunsigned char  autoneg;           \n};\n\nstruct cmac;\nstruct cphy;\n\nstruct port_info {\n\tstruct net_device *dev;\n\tstruct cmac *mac;\n\tstruct cphy *phy;\n\tstruct link_config link_config;\n};\n\nstruct sge;\nstruct peespi;\n\nstruct adapter {\n\tu8 __iomem *regs;\n\tstruct pci_dev *pdev;\n\tunsigned long registered_device_map;\n\tunsigned long open_device_map;\n\tunsigned long flags;\n\n\tconst char *name;\n\tint msg_enable;\n\tu32 mmio_len;\n\n\tstruct adapter_params params;\n\n\t \n\tstruct sge    *sge;\n\tstruct peespi *espi;\n\tstruct petp   *tp;\n\n\tstruct napi_struct napi;\n\tstruct port_info port[MAX_NPORTS];\n\tstruct delayed_work stats_update_task;\n\tstruct timer_list stats_update_timer;\n\n\tspinlock_t tpi_lock;\n\tspinlock_t work_lock;\n\tspinlock_t mac_lock;\n\n\t \n\tspinlock_t async_lock ____cacheline_aligned;\n\tu32 pending_thread_intr;\n\tu32 slow_intr_mask;\n\tint t1powersave;\n};\n\nenum {                                            \n\tFULL_INIT_DONE        = 1 << 0,\n};\n\nstruct mdio_ops;\nstruct gmac;\nstruct gphy;\n\nstruct board_info {\n\tunsigned char           board;\n\tunsigned char           port_number;\n\tunsigned long           caps;\n\tunsigned char           chip_term;\n\tunsigned char           chip_mac;\n\tunsigned char           chip_phy;\n\tunsigned int            clock_core;\n\tunsigned int            clock_mc3;\n\tunsigned int            clock_mc4;\n\tunsigned int            espi_nports;\n\tunsigned int            clock_elmer0;\n\tunsigned char           mdio_mdien;\n\tunsigned char           mdio_mdiinv;\n\tunsigned char           mdio_mdc;\n\tunsigned char           mdio_phybaseaddr;\n\tconst struct gmac      *gmac;\n\tconst struct gphy      *gphy;\n\tconst struct mdio_ops  *mdio_ops;\n\tconst char             *desc;\n};\n\nstatic inline int t1_is_asic(const adapter_t *adapter)\n{\n\treturn adapter->params.is_asic;\n}\n\nextern const struct pci_device_id t1_pci_tbl[];\n\nstatic inline int adapter_matches_type(const adapter_t *adapter,\n\t\t\t\t       int version, int revision)\n{\n\treturn adapter->params.chip_version == version &&\n\t       adapter->params.chip_revision == revision;\n}\n\n#define t1_is_T1B(adap) adapter_matches_type(adap, CHBT_TERM_T1, TERM_T1B)\n#define is_T2(adap)     adapter_matches_type(adap, CHBT_TERM_T2, TERM_T2)\n\n \nstatic inline int vlan_tso_capable(const adapter_t *adapter)\n{\n\treturn !t1_is_T1B(adapter);\n}\n\n#define for_each_port(adapter, iter) \\\n\tfor (iter = 0; iter < (adapter)->params.nports; ++iter)\n\n#define board_info(adapter) ((adapter)->params.brd_info)\n#define is_10G(adapter) (board_info(adapter)->caps & SUPPORTED_10000baseT_Full)\n\nstatic inline unsigned int core_ticks_per_usec(const adapter_t *adap)\n{\n\treturn board_info(adap)->clock_core / 1000000;\n}\n\nint __t1_tpi_read(adapter_t *adapter, u32 addr, u32 *valp);\nint __t1_tpi_write(adapter_t *adapter, u32 addr, u32 value);\nint t1_tpi_write(adapter_t *adapter, u32 addr, u32 value);\nint t1_tpi_read(adapter_t *adapter, u32 addr, u32 *value);\n\nvoid t1_interrupts_enable(adapter_t *adapter);\nvoid t1_interrupts_disable(adapter_t *adapter);\nvoid t1_interrupts_clear(adapter_t *adapter);\nint t1_elmer0_ext_intr_handler(adapter_t *adapter);\nirqreturn_t t1_slow_intr_handler(adapter_t *adapter);\n\nint t1_link_start(struct cphy *phy, struct cmac *mac, struct link_config *lc);\nconst struct board_info *t1_get_board_info(unsigned int board_id);\nconst struct board_info *t1_get_board_info_from_ids(unsigned int devid,\n\t\t\t\t\t\t    unsigned short ssid);\nint t1_seeprom_read(adapter_t *adapter, u32 addr, __le32 *data);\nint t1_get_board_rev(adapter_t *adapter, const struct board_info *bi,\n\t\t     struct adapter_params *p);\nint t1_init_hw_modules(adapter_t *adapter);\nint t1_init_sw_modules(adapter_t *adapter, const struct board_info *bi);\nvoid t1_free_sw_modules(adapter_t *adapter);\nvoid t1_link_changed(adapter_t *adapter, int port_id);\nvoid t1_link_negotiated(adapter_t *adapter, int port_id, int link_stat,\n\t\t\t    int speed, int duplex, int pause);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}