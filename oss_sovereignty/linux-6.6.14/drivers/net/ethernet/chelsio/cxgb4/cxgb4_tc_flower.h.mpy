{
  "module_name": "cxgb4_tc_flower.h",
  "hash_id": "4fd14ba3f421a4a53b9210f667dad741a29f957b480ee101266a3247b9b3b109",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/chelsio/cxgb4/cxgb4_tc_flower.h",
  "human_readable_source": " \n\n#ifndef __CXGB4_TC_FLOWER_H\n#define __CXGB4_TC_FLOWER_H\n\n#include <net/pkt_cls.h>\n\nstruct ch_tc_flower_stats {\n\tu64 prev_packet_count;\n\tu64 packet_count;\n\tu64 byte_count;\n\tu64 last_used;\n};\n\nstruct ch_tc_flower_entry {\n\tstruct ch_filter_specification fs;\n\tstruct ch_tc_flower_stats stats;\n\tunsigned long tc_flower_cookie;\n\tstruct rhash_head node;\n\tstruct rcu_head rcu;\n\tspinlock_t lock;  \n\tu32 filter_id;\n};\n\nenum {\n\tETH_DMAC_31_0,\t \n\tETH_DMAC_47_32,\t \n\tETH_SMAC_15_0,\t \n\tETH_SMAC_47_16,\t \n\n\tIP4_SRC,\t \n\tIP4_DST,\t \n\n\tIP6_SRC_31_0,\t \n\tIP6_SRC_63_32,\t \n\tIP6_SRC_95_64,\t \n\tIP6_SRC_127_96,\t \n\n\tIP6_DST_31_0,\t \n\tIP6_DST_63_32,\t \n\tIP6_DST_95_64,\t \n\tIP6_DST_127_96,\t \n\n\tTCP_SPORT,\t \n\tTCP_DPORT,\t \n\n\tUDP_SPORT,\t \n\tUDP_DPORT,\t \n};\n\nstruct ch_tc_pedit_fields {\n\tu8 field;\n\tu8 size;\n\tu32 offset;\n};\n\n#define PEDIT_FIELDS(type, field, size, fs_field, offset) \\\n\t{ type## field, size, \\\n\t\toffsetof(struct ch_filter_specification, fs_field) + (offset) }\n\n#define PEDIT_ETH_DMAC_MASK\t\t0xffff\n#define PEDIT_TCP_UDP_SPORT_MASK\t0xffff\n#define PEDIT_ETH_DMAC_31_0\t\t0x0\n#define PEDIT_ETH_DMAC_47_32_SMAC_15_0\t0x4\n#define PEDIT_ETH_SMAC_47_16\t\t0x8\n#define PEDIT_IP4_SRC\t\t\t0xC\n#define PEDIT_IP4_DST\t\t\t0x10\n#define PEDIT_IP6_SRC_31_0\t\t0x8\n#define PEDIT_IP6_SRC_63_32\t\t0xC\n#define PEDIT_IP6_SRC_95_64\t\t0x10\n#define PEDIT_IP6_SRC_127_96\t\t0x14\n#define PEDIT_IP6_DST_31_0\t\t0x18\n#define PEDIT_IP6_DST_63_32\t\t0x1C\n#define PEDIT_IP6_DST_95_64\t\t0x20\n#define PEDIT_IP6_DST_127_96\t\t0x24\n#define PEDIT_TCP_SPORT_DPORT\t\t0x0\n#define PEDIT_UDP_SPORT_DPORT\t\t0x0\n\nenum cxgb4_action_natmode_flags {\n\tCXGB4_ACTION_NATMODE_NONE = 0,\n\tCXGB4_ACTION_NATMODE_DIP = (1 << 0),\n\tCXGB4_ACTION_NATMODE_SIP = (1 << 1),\n\tCXGB4_ACTION_NATMODE_DPORT = (1 << 2),\n\tCXGB4_ACTION_NATMODE_SPORT = (1 << 3),\n};\n\n \nstruct cxgb4_natmode_config {\n\tenum chip_type chip;\n\tu8 flags;\n\tu8 natmode;\n};\n\nvoid cxgb4_process_flow_actions(struct net_device *in,\n\t\t\t\tstruct flow_action *actions,\n\t\t\t\tstruct ch_filter_specification *fs);\nint cxgb4_validate_flow_actions(struct net_device *dev,\n\t\t\t\tstruct flow_action *actions,\n\t\t\t\tstruct netlink_ext_ack *extack,\n\t\t\t\tu8 matchall_filter);\n\nint cxgb4_tc_flower_replace(struct net_device *dev,\n\t\t\t    struct flow_cls_offload *cls);\nint cxgb4_tc_flower_destroy(struct net_device *dev,\n\t\t\t    struct flow_cls_offload *cls);\nint cxgb4_tc_flower_stats(struct net_device *dev,\n\t\t\t  struct flow_cls_offload *cls);\nint cxgb4_flow_rule_replace(struct net_device *dev, struct flow_rule *rule,\n\t\t\t    u32 tc_prio, struct netlink_ext_ack *extack,\n\t\t\t    struct ch_filter_specification *fs, u32 *tid);\nint cxgb4_flow_rule_destroy(struct net_device *dev, u32 tc_prio,\n\t\t\t    struct ch_filter_specification *fs, int tid);\n\nint cxgb4_init_tc_flower(struct adapter *adap);\nvoid cxgb4_cleanup_tc_flower(struct adapter *adap);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}