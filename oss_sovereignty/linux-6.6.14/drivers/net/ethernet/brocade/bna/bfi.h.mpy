{
  "module_name": "bfi.h",
  "hash_id": "4533461e7ac07fe35c1d82eea02dd9d8c723f61ba42b6913aa3b1dd28aff2edd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/brocade/bna/bfi.h",
  "human_readable_source": " \n \n \n#ifndef __BFI_H__\n#define __BFI_H__\n\n#include \"bfa_defs.h\"\n\n \n#define\tBFI_FLASH_CHUNK_SZ\t\t\t256\t \n#define\tBFI_FLASH_CHUNK_SZ_WORDS\t(BFI_FLASH_CHUNK_SZ/sizeof(u32))\n#define BFI_FLASH_IMAGE_SZ\t\t0x100000\n\n \nstruct bfi_mhdr {\n\tu8\t\tmsg_class;\t \n\tu8\t\tmsg_id;\t\t \n\tunion {\n\t\tstruct {\n\t\t\tu8\tqid;\n\t\t\tu8\tfn_lpu;\t \n\t\t} __packed h2i;\n\t\tu16\ti2htok;\t \n\t} __packed mtag;\n} __packed;\n\n#define bfi_fn_lpu(__fn, __lpu)\t((__fn) << 1 | (__lpu))\n#define bfi_mhdr_2_fn(_mh)\t((_mh)->mtag.h2i.fn_lpu >> 1)\n#define bfi_mhdr_2_qid(_mh)\t((_mh)->mtag.h2i.qid)\n\n#define bfi_h2i_set(_mh, _mc, _op, _fn_lpu) do {\t\t\\\n\t(_mh).msg_class\t\t\t= (_mc);\t\t\\\n\t(_mh).msg_id\t\t\t= (_op);\t\t\\\n\t(_mh).mtag.h2i.fn_lpu\t= (_fn_lpu);\t\t\t\\\n} while (0)\n\n#define bfi_i2h_set(_mh, _mc, _op, _i2htok) do {\t\t\\\n\t(_mh).msg_class\t\t\t= (_mc);\t\t\\\n\t(_mh).msg_id\t\t\t= (_op);\t\t\\\n\t(_mh).mtag.i2htok\t\t= (_i2htok);\t\t\\\n} while (0)\n\n \n#define BFI_I2H_OPCODE_BASE\t128\n#define BFA_I2HM(_x)\t\t\t((_x) + BFI_I2H_OPCODE_BASE)\n\n \n\n \nunion bfi_addr_u {\n\tstruct {\n\t\tu32\taddr_lo;\n\t\tu32\taddr_hi;\n\t} __packed a32;\n} __packed;\n\n \nstruct bfi_alen {\n\tunion bfi_addr_u\tal_addr;\t \n\tu32\t\t\tal_len;\t\t \n} __packed;\n\n \n#define BFI_LMSG_SZ\t\t128\n#define BFI_LMSG_PL_WSZ\t\\\n\t\t\t((BFI_LMSG_SZ - sizeof(struct bfi_mhdr)) / 4)\n\n \n#define BFI_MBMSG_SZ\t\t7\nstruct bfi_mbmsg {\n\tstruct bfi_mhdr mh;\n\tu32\t\tpl[BFI_MBMSG_SZ];\n} __packed;\n\n \nenum bfi_pcifn_class {\n\tBFI_PCIFN_CLASS_FC\t= 0x0c04,\n\tBFI_PCIFN_CLASS_ETH\t= 0x0200,\n};\n\n \nenum bfi_mclass {\n\tBFI_MC_IOC\t\t= 1,\t \n\tBFI_MC_DIAG\t\t= 2,\t \n\tBFI_MC_FLASH\t\t= 3,\t \n\tBFI_MC_CEE\t\t= 4,\t \n\tBFI_MC_FCPORT\t\t= 5,\t \n\tBFI_MC_IOCFC\t\t= 6,\t \n\tBFI_MC_LL\t\t= 7,\t \n\tBFI_MC_UF\t\t= 8,\t \n\tBFI_MC_FCXP\t\t= 9,\t \n\tBFI_MC_LPS\t\t= 10,\t \n\tBFI_MC_RPORT\t\t= 11,\t \n\tBFI_MC_ITNIM\t\t= 12,\t \n\tBFI_MC_IOIM_READ\t= 13,\t \n\tBFI_MC_IOIM_WRITE\t= 14,\t \n\tBFI_MC_IOIM_IO\t\t= 15,\t \n\tBFI_MC_IOIM\t\t= 16,\t \n\tBFI_MC_IOIM_IOCOM\t= 17,\t \n\tBFI_MC_TSKIM\t\t= 18,\t \n\tBFI_MC_SBOOT\t\t= 19,\t \n\tBFI_MC_IPFC\t\t= 20,\t \n\tBFI_MC_PORT\t\t= 21,\t \n\tBFI_MC_SFP\t\t= 22,\t \n\tBFI_MC_MSGQ\t\t= 23,\t \n\tBFI_MC_ENET\t\t= 24,\t \n\tBFI_MC_PHY\t\t= 25,\t \n\tBFI_MC_NBOOT\t\t= 26,\t \n\tBFI_MC_TIO_READ\t\t= 27,\t \n\tBFI_MC_TIO_WRITE\t= 28,\t \n\tBFI_MC_TIO_DATA_XFERED\t= 29,\t \n\tBFI_MC_TIO_IO\t\t= 30,\t \n\tBFI_MC_TIO\t\t= 31,\t \n\tBFI_MC_MFG\t\t= 32,\t \n\tBFI_MC_EDMA\t\t= 33,\t \n\tBFI_MC_MAX\t\t= 34\n};\n\n#define BFI_IOC_MSGLEN_MAX\t32\t \n\n#define BFI_FWBOOT_ENV_OS\t\t0\n\n \n\n \nenum bfi_asic_gen {\n\tBFI_ASIC_GEN_CB\t\t= 1,\n\tBFI_ASIC_GEN_CT\t\t= 2,\n\tBFI_ASIC_GEN_CT2\t= 3,\n};\n\nenum bfi_asic_mode {\n\tBFI_ASIC_MODE_FC\t= 1,\t \n\tBFI_ASIC_MODE_FC16\t= 2,\t \n\tBFI_ASIC_MODE_ETH\t= 3,\t \n\tBFI_ASIC_MODE_COMBO\t= 4,\t \n};\n\nenum bfi_ioc_h2i_msgs {\n\tBFI_IOC_H2I_ENABLE_REQ\t\t= 1,\n\tBFI_IOC_H2I_DISABLE_REQ\t\t= 2,\n\tBFI_IOC_H2I_GETATTR_REQ\t\t= 3,\n\tBFI_IOC_H2I_DBG_SYNC\t\t= 4,\n\tBFI_IOC_H2I_DBG_DUMP\t\t= 5,\n};\n\nenum bfi_ioc_i2h_msgs {\n\tBFI_IOC_I2H_ENABLE_REPLY\t= BFA_I2HM(1),\n\tBFI_IOC_I2H_DISABLE_REPLY\t= BFA_I2HM(2),\n\tBFI_IOC_I2H_GETATTR_REPLY\t= BFA_I2HM(3),\n\tBFI_IOC_I2H_HBEAT\t\t= BFA_I2HM(4),\n};\n\n \nstruct bfi_ioc_getattr_req {\n\tstruct bfi_mhdr mh;\n\tunion bfi_addr_u\tattr_addr;\n} __packed;\n\nstruct bfi_ioc_attr {\n\tu64\t\tmfg_pwwn;\t \n\tu64\t\tmfg_nwwn;\t \n\tu8\t\tmfg_mac[ETH_ALEN];  \n\tu8\t\tport_mode;\t \n\tu8\t\trsvd_a;\n\tu64\t\tpwwn;\n\tu64\t\tnwwn;\n\tu8\t\tmac[ETH_ALEN];\t \n\tu16\trsvd_b;\n\tu8\t\tfcoe_mac[ETH_ALEN];\n\tu16\trsvd_c;\n\tchar\t\tbrcd_serialnum[STRSZ(BFA_MFG_SERIALNUM_SIZE)];\n\tu8\t\tpcie_gen;\n\tu8\t\tpcie_lanes_orig;\n\tu8\t\tpcie_lanes;\n\tu8\t\trx_bbcredit;\t \n\tu32\tadapter_prop;\t \n\tu16\tmaxfrsize;\t \n\tchar\t\tasic_rev;\n\tu8\t\trsvd_d;\n\tchar\t\tfw_version[BFA_VERSION_LEN];\n\tchar\t\toptrom_version[BFA_VERSION_LEN];\n\tstruct bfa_mfg_vpd vpd;\n\tu32\tcard_type;\t \n} __packed;\n\n \nstruct bfi_ioc_getattr_reply {\n\tstruct bfi_mhdr mh;\t \n\tu8\t\t\tstatus;\t \n\tu8\t\t\trsvd[3];\n} __packed;\n\n \n#define BFI_IOC_SMEM_PG0_CB\t(0x40)\n#define BFI_IOC_SMEM_PG0_CT\t(0x180)\n\n \n#define BFI_IOC_FWSTATS_OFF\t(0x6B40)\n#define BFI_IOC_FWSTATS_SZ\t(4096)\n\n \n#define BFI_IOC_TRC_OFF\t\t(0x4b00)\n#define BFI_IOC_TRC_ENTS\t256\n#define BFI_IOC_TRC_ENT_SZ\t16\n#define BFI_IOC_TRC_HDR_SZ\t32\n\n#define BFI_IOC_FW_SIGNATURE\t(0xbfadbfad)\n#define BFI_IOC_FW_INV_SIGN\t(0xdeaddead)\n#define BFI_IOC_MD5SUM_SZ\t4\n\nstruct bfi_ioc_fwver {\n#ifdef __BIG_ENDIAN\n\tu8 patch;\n\tu8 maint;\n\tu8 minor;\n\tu8 major;\n\tu8 rsvd[2];\n\tu8 build;\n\tu8 phase;\n#else\n\tu8 major;\n\tu8 minor;\n\tu8 maint;\n\tu8 patch;\n\tu8 phase;\n\tu8 build;\n\tu8 rsvd[2];\n#endif\n} __packed;\n\nstruct bfi_ioc_image_hdr {\n\tu32\tsignature;\t \n\tu8\tasic_gen;\t \n\tu8\tasic_mode;\n\tu8\tport0_mode;\t \n\tu8\tport1_mode;\t \n\tu32\texec;\t\t \n\tu32\tbootenv;\t \n\tu32\trsvd_b[2];\n\tstruct bfi_ioc_fwver fwver;\n\tu32\tmd5sum[BFI_IOC_MD5SUM_SZ];\n} __packed;\n\nenum bfi_ioc_img_ver_cmp {\n\tBFI_IOC_IMG_VER_INCOMP,\n\tBFI_IOC_IMG_VER_OLD,\n\tBFI_IOC_IMG_VER_SAME,\n\tBFI_IOC_IMG_VER_BETTER\n};\n\n#define BFI_FWBOOT_DEVMODE_OFF\t\t4\n#define BFI_FWBOOT_TYPE_OFF\t\t8\n#define BFI_FWBOOT_ENV_OFF\t\t12\n#define BFI_FWBOOT_DEVMODE(__asic_gen, __asic_mode, __p0_mode, __p1_mode) \\\n\t(((u32)(__asic_gen)) << 24 |\t\\\n\t ((u32)(__asic_mode)) << 16 |\t\\\n\t ((u32)(__p0_mode)) << 8 |\t\\\n\t ((u32)(__p1_mode)))\n\nenum bfi_fwboot_type {\n\tBFI_FWBOOT_TYPE_NORMAL\t= 0,\n\tBFI_FWBOOT_TYPE_FLASH\t= 1,\n\tBFI_FWBOOT_TYPE_MEMTEST\t= 2,\n};\n\nenum bfi_port_mode {\n\tBFI_PORT_MODE_FC\t= 1,\n\tBFI_PORT_MODE_ETH\t= 2,\n};\n\nstruct bfi_ioc_hbeat {\n\tstruct bfi_mhdr mh;\t\t \n\tu32\t   hb_count;\t \n} __packed;\n\n \nenum bfi_ioc_state {\n\tBFI_IOC_UNINIT\t\t= 0,\t \n\tBFI_IOC_INITING\t\t= 1,\t \n\tBFI_IOC_HWINIT\t\t= 2,\t \n\tBFI_IOC_CFG\t\t= 3,\t \n\tBFI_IOC_OP\t\t= 4,\t \n\tBFI_IOC_DISABLING\t= 5,\t \n\tBFI_IOC_DISABLED\t= 6,\t \n\tBFI_IOC_CFG_DISABLED\t= 7,\t \n\tBFI_IOC_FAIL\t\t= 8,\t \n\tBFI_IOC_MEMTEST\t\t= 9,\t \n};\n\nenum {\n\tBFI_ADAPTER_TYPE_FC\t= 0x01,\t\t \n\tBFI_ADAPTER_TYPE_MK\t= 0x0f0000,\t \n\tBFI_ADAPTER_TYPE_SH\t= 16,\t         \n\tBFI_ADAPTER_NPORTS_MK\t= 0xff00,\t \n\tBFI_ADAPTER_NPORTS_SH\t= 8,\t         \n\tBFI_ADAPTER_SPEED_MK\t= 0xff,\t\t \n\tBFI_ADAPTER_SPEED_SH\t= 0,\t         \n\tBFI_ADAPTER_PROTO\t= 0x100000,\t \n\tBFI_ADAPTER_TTV\t\t= 0x200000,\t \n\tBFI_ADAPTER_UNSUPP\t= 0x400000,\t \n};\n\n#define BFI_ADAPTER_GETP(__prop, __adap_prop)\t\t\t\\\n\t(((__adap_prop) & BFI_ADAPTER_ ## __prop ## _MK) >>\t\\\n\t\tBFI_ADAPTER_ ## __prop ## _SH)\n#define BFI_ADAPTER_SETP(__prop, __val)\t\t\t\t\\\n\t((__val) << BFI_ADAPTER_ ## __prop ## _SH)\n#define BFI_ADAPTER_IS_SPECIAL(__adap_type)\t\t\t\\\n\t((__adap_type) & (BFI_ADAPTER_TTV | BFI_ADAPTER_PROTO |\t\\\n\t\t\tBFI_ADAPTER_UNSUPP))\n\n \nstruct bfi_ioc_ctrl_req {\n\tstruct bfi_mhdr mh;\n\tu16\t\t\tclscode;\n\tu16\t\t\trsvd;\n\tu32\t\ttv_sec;\n} __packed;\n\n \nstruct bfi_ioc_ctrl_reply {\n\tstruct bfi_mhdr mh;\t\t\t \n\tu8\t\t\tstatus;\t\t \n\tu8\t\t\tport_mode;\t \n\tu8\t\t\tcap_bm;\t\t \n\tu8\t\t\trsvd;\n} __packed;\n\n#define BFI_IOC_MSGSZ   8\n \nunion bfi_ioc_h2i_msg_u {\n\tstruct bfi_mhdr mh;\n\tstruct bfi_ioc_ctrl_req enable_req;\n\tstruct bfi_ioc_ctrl_req disable_req;\n\tstruct bfi_ioc_getattr_req getattr_req;\n\tu32\t\t\tmboxmsg[BFI_IOC_MSGSZ];\n} __packed;\n\n \nunion bfi_ioc_i2h_msg_u {\n\tstruct bfi_mhdr mh;\n\tstruct bfi_ioc_ctrl_reply fw_event;\n\tu32\t\t\tmboxmsg[BFI_IOC_MSGSZ];\n} __packed;\n\n \n\nenum bfi_msgq_h2i_msgs {\n\tBFI_MSGQ_H2I_INIT_REQ\t   = 1,\n\tBFI_MSGQ_H2I_DOORBELL_PI\t= 2,\n\tBFI_MSGQ_H2I_DOORBELL_CI\t= 3,\n\tBFI_MSGQ_H2I_CMDQ_COPY_RSP      = 4,\n};\n\nenum bfi_msgq_i2h_msgs {\n\tBFI_MSGQ_I2H_INIT_RSP\t   = BFA_I2HM(BFI_MSGQ_H2I_INIT_REQ),\n\tBFI_MSGQ_I2H_DOORBELL_PI\t= BFA_I2HM(BFI_MSGQ_H2I_DOORBELL_PI),\n\tBFI_MSGQ_I2H_DOORBELL_CI\t= BFA_I2HM(BFI_MSGQ_H2I_DOORBELL_CI),\n\tBFI_MSGQ_I2H_CMDQ_COPY_REQ      = BFA_I2HM(BFI_MSGQ_H2I_CMDQ_COPY_RSP),\n};\n\n \nstruct bfi_msgq_mhdr {\n\tu8\tmsg_class;\n\tu8\tmsg_id;\n\tu16\tmsg_token;\n\tu16\tnum_entries;\n\tu8\tenet_id;\n\tu8\trsvd;\n} __packed;\n\n#define bfi_msgq_mhdr_set(_mh, _mc, _mid, _tok, _enet_id) do {\t\\\n\t(_mh).msg_class\t = (_mc);\t\\\n\t(_mh).msg_id\t    = (_mid);       \\\n\t(_mh).msg_token\t = (_tok);       \\\n\t(_mh).enet_id\t   = (_enet_id);   \\\n} while (0)\n\n \n#define BFI_MSGQ_CMD_ENTRY_SIZE\t (64)     \n#define BFI_MSGQ_RSP_ENTRY_SIZE\t (64)     \n\n#define bfi_msgq_num_cmd_entries(_size)\t\t\t\t \\\n\t(((_size) + BFI_MSGQ_CMD_ENTRY_SIZE - 1) / BFI_MSGQ_CMD_ENTRY_SIZE)\n\nstruct bfi_msgq {\n\tunion bfi_addr_u addr;\n\tu16 q_depth;      \n\tu8 rsvd[2];\n} __packed;\n\n \nstruct bfi_msgq_cfg_req {\n\tstruct bfi_mhdr mh;\n\tstruct bfi_msgq cmdq;\n\tstruct bfi_msgq rspq;\n} __packed;\n\n \nstruct bfi_msgq_cfg_rsp {\n\tstruct bfi_mhdr mh;\n\tu8 cmd_status;\n\tu8 rsvd[3];\n} __packed;\n\n \nstruct bfi_msgq_h2i_db {\n\tstruct bfi_mhdr mh;\n\tunion {\n\t\tu16 cmdq_pi;\n\t\tu16 rspq_ci;\n\t} __packed idx;\n} __packed;\n\n \nstruct bfi_msgq_i2h_db {\n\tstruct bfi_mhdr mh;\n\tunion {\n\t\tu16 rspq_pi;\n\t\tu16 cmdq_ci;\n\t} __packed idx;\n} __packed;\n\n#define BFI_CMD_COPY_SZ 28\n\n \nstruct bfi_msgq_h2i_cmdq_copy_rsp {\n\tstruct bfi_mhdr mh;\n\tu8\t      data[BFI_CMD_COPY_SZ];\n} __packed;\n\n \nstruct bfi_msgq_i2h_cmdq_copy_req {\n\tstruct bfi_mhdr mh;\n\tu16     offset;\n\tu16     len;\n} __packed;\n\n \nenum bfi_flash_h2i_msgs {\n\tBFI_FLASH_H2I_QUERY_REQ = 1,\n\tBFI_FLASH_H2I_ERASE_REQ = 2,\n\tBFI_FLASH_H2I_WRITE_REQ = 3,\n\tBFI_FLASH_H2I_READ_REQ = 4,\n\tBFI_FLASH_H2I_BOOT_VER_REQ = 5,\n};\n\nenum bfi_flash_i2h_msgs {\n\tBFI_FLASH_I2H_QUERY_RSP = BFA_I2HM(1),\n\tBFI_FLASH_I2H_ERASE_RSP = BFA_I2HM(2),\n\tBFI_FLASH_I2H_WRITE_RSP = BFA_I2HM(3),\n\tBFI_FLASH_I2H_READ_RSP = BFA_I2HM(4),\n\tBFI_FLASH_I2H_BOOT_VER_RSP = BFA_I2HM(5),\n\tBFI_FLASH_I2H_EVENT = BFA_I2HM(127),\n};\n\n \nstruct bfi_flash_query_req {\n\tstruct bfi_mhdr mh;    \n\tstruct bfi_alen alen;\n} __packed;\n\n \nstruct bfi_flash_write_req {\n\tstruct bfi_mhdr mh;\t \n\tstruct bfi_alen alen;\n\tu32\ttype;    \n\tu8\tinstance;  \n\tu8\tlast;\n\tu8\trsv[2];\n\tu32\toffset;\n\tu32\tlength;\n} __packed;\n\n \nstruct bfi_flash_read_req {\n\tstruct bfi_mhdr mh;\t \n\tu32\ttype;\t\t \n\tu8\tinstance;\t \n\tu8\trsv[3];\n\tu32\toffset;\n\tu32\tlength;\n\tstruct bfi_alen alen;\n} __packed;\n\n \nstruct bfi_flash_query_rsp {\n\tstruct bfi_mhdr mh;\t \n\tu32\tstatus;\n} __packed;\n\n \nstruct bfi_flash_read_rsp {\n\tstruct bfi_mhdr mh;\t \n\tu32\ttype;\t\t \n\tu8\tinstance;\t \n\tu8\trsv[3];\n\tu32\tstatus;\n\tu32\tlength;\n} __packed;\n\n \nstruct bfi_flash_write_rsp {\n\tstruct bfi_mhdr mh;\t \n\tu32\ttype;\t\t \n\tu8\tinstance;\t \n\tu8\trsv[3];\n\tu32\tstatus;\n\tu32\tlength;\n} __packed;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}