{
  "module_name": "bna.h",
  "hash_id": "0145ce2d8d4bf2ff2ae598549334e6f506f974d4893ea1df3cea952eb96a3398",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/brocade/bna/bna.h",
  "human_readable_source": " \n \n \n#ifndef __BNA_H__\n#define __BNA_H__\n\n#include \"bfa_defs.h\"\n#include \"bfa_ioc.h\"\n#include \"bfi_enet.h\"\n#include \"bna_types.h\"\n\nextern const u32 bna_napi_dim_vector[][BNA_BIAS_T_MAX];\n\n \n\n#define bna_is_small_rxq(_id) ((_id) & 0x1)\n\n \n#define BNA_SET_DMA_ADDR(_addr, _bna_dma_addr)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tu64 tmp_addr =\t\t\t\t\t\t\\\n\tcpu_to_be64((u64)(_addr));\t\t\t\t\\\n\t(_bna_dma_addr)->msb = ((struct bna_dma_addr *)&tmp_addr)->msb; \\\n\t(_bna_dma_addr)->lsb = ((struct bna_dma_addr *)&tmp_addr)->lsb; \\\n} while (0)\n\n \n#define BNA_GET_DMA_ADDR(_bna_dma_addr, _addr)\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\t(_addr) = ((((u64)ntohl((_bna_dma_addr)->msb))) << 32)\t\t\\\n\t| ((ntohl((_bna_dma_addr)->lsb) & 0xffffffff));\t\\\n} while (0)\n\n#define BNA_TXQ_WI_NEEDED(_vectors)\t(((_vectors) + 3) >> 2)\n\n#define BNA_QE_INDX_ADD(_qe_idx, _qe_num, _q_depth)\t\t\t\\\n\t((_qe_idx) = ((_qe_idx) + (_qe_num)) & ((_q_depth) - 1))\n\n#define BNA_QE_INDX_INC(_idx, _q_depth) BNA_QE_INDX_ADD(_idx, 1, _q_depth)\n\n#define BNA_Q_INDEX_CHANGE(_old_idx, _updated_idx, _q_depth)\t\t\\\n\t(((_updated_idx) - (_old_idx)) & ((_q_depth) - 1))\n\n#define BNA_QE_FREE_CNT(_q_ptr, _q_depth)\t\t\t\t\\\n\t(((_q_ptr)->consumer_index - (_q_ptr)->producer_index - 1) &\t\\\n\t ((_q_depth) - 1))\n#define BNA_QE_IN_USE_CNT(_q_ptr, _q_depth)\t\t\t\t\\\n\t((((_q_ptr)->producer_index - (_q_ptr)->consumer_index)) &\t\\\n\t (_q_depth - 1))\n\n#define BNA_LARGE_PKT_SIZE\t\t1000\n\n#define BNA_UPDATE_PKT_CNT(_pkt, _len)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif ((_len) > BNA_LARGE_PKT_SIZE) {\t\t\t\t\\\n\t\t(_pkt)->large_pkt_cnt++;\t\t\t\t\\\n\t} else {\t\t\t\t\t\t\t\\\n\t\t(_pkt)->small_pkt_cnt++;\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define\tcall_rxf_stop_cbfn(rxf)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif ((rxf)->stop_cbfn) {\t\t\t\t\t\t\\\n\t\tvoid (*cbfn)(struct bna_rx *);\t\t\t\\\n\t\tstruct bna_rx *cbarg;\t\t\t\t\t\\\n\t\tcbfn = (rxf)->stop_cbfn;\t\t\t\t\\\n\t\tcbarg = (rxf)->stop_cbarg;\t\t\t\t\\\n\t\t(rxf)->stop_cbfn = NULL;\t\t\t\t\\\n\t\t(rxf)->stop_cbarg = NULL;\t\t\t\t\\\n\t\tcbfn(cbarg);\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define\tcall_rxf_start_cbfn(rxf)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif ((rxf)->start_cbfn) {\t\t\t\t\t\\\n\t\tvoid (*cbfn)(struct bna_rx *);\t\t\t\\\n\t\tstruct bna_rx *cbarg;\t\t\t\t\t\\\n\t\tcbfn = (rxf)->start_cbfn;\t\t\t\t\\\n\t\tcbarg = (rxf)->start_cbarg;\t\t\t\t\\\n\t\t(rxf)->start_cbfn = NULL;\t\t\t\t\\\n\t\t(rxf)->start_cbarg = NULL;\t\t\t\t\\\n\t\tcbfn(cbarg);\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define\tcall_rxf_cam_fltr_cbfn(rxf)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tif ((rxf)->cam_fltr_cbfn) {\t\t\t\t\t\\\n\t\tvoid (*cbfn)(struct bnad *, struct bna_rx *);\t\\\n\t\tstruct bnad *cbarg;\t\t\t\t\t\\\n\t\tcbfn = (rxf)->cam_fltr_cbfn;\t\t\t\t\\\n\t\tcbarg = (rxf)->cam_fltr_cbarg;\t\t\t\t\\\n\t\t(rxf)->cam_fltr_cbfn = NULL;\t\t\t\t\\\n\t\t(rxf)->cam_fltr_cbarg = NULL;\t\t\t\t\\\n\t\tcbfn(cbarg, rxf->rx);\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define is_xxx_enable(mode, bitmask, xxx) ((bitmask & xxx) && (mode & xxx))\n\n#define is_xxx_disable(mode, bitmask, xxx) ((bitmask & xxx) && !(mode & xxx))\n\n#define xxx_enable(mode, bitmask, xxx)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tbitmask |= xxx;\t\t\t\t\t\t\t\\\n\tmode |= xxx;\t\t\t\t\t\t\t\\\n} while (0)\n\n#define xxx_disable(mode, bitmask, xxx)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tbitmask |= xxx;\t\t\t\t\t\t\t\\\n\tmode &= ~xxx;\t\t\t\t\t\t\t\\\n} while (0)\n\n#define xxx_inactive(mode, bitmask, xxx)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tbitmask &= ~xxx;\t\t\t\t\t\t\\\n\tmode &= ~xxx;\t\t\t\t\t\t\t\\\n} while (0)\n\n#define is_promisc_enable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_enable(mode, bitmask, BNA_RXMODE_PROMISC)\n\n#define is_promisc_disable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_disable(mode, bitmask, BNA_RXMODE_PROMISC)\n\n#define promisc_enable(mode, bitmask)\t\t\t\t\t\\\n\txxx_enable(mode, bitmask, BNA_RXMODE_PROMISC)\n\n#define promisc_disable(mode, bitmask)\t\t\t\t\t\\\n\txxx_disable(mode, bitmask, BNA_RXMODE_PROMISC)\n\n#define promisc_inactive(mode, bitmask)\t\t\t\t\t\\\n\txxx_inactive(mode, bitmask, BNA_RXMODE_PROMISC)\n\n#define is_default_enable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_enable(mode, bitmask, BNA_RXMODE_DEFAULT)\n\n#define is_default_disable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_disable(mode, bitmask, BNA_RXMODE_DEFAULT)\n\n#define default_enable(mode, bitmask)\t\t\t\t\t\\\n\txxx_enable(mode, bitmask, BNA_RXMODE_DEFAULT)\n\n#define default_disable(mode, bitmask)\t\t\t\t\t\\\n\txxx_disable(mode, bitmask, BNA_RXMODE_DEFAULT)\n\n#define default_inactive(mode, bitmask)\t\t\t\t\t\\\n\txxx_inactive(mode, bitmask, BNA_RXMODE_DEFAULT)\n\n#define is_allmulti_enable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_enable(mode, bitmask, BNA_RXMODE_ALLMULTI)\n\n#define is_allmulti_disable(mode, bitmask)\t\t\t\t\\\n\tis_xxx_disable(mode, bitmask, BNA_RXMODE_ALLMULTI)\n\n#define allmulti_enable(mode, bitmask)\t\t\t\t\t\\\n\txxx_enable(mode, bitmask, BNA_RXMODE_ALLMULTI)\n\n#define allmulti_disable(mode, bitmask)\t\t\t\t\t\\\n\txxx_disable(mode, bitmask, BNA_RXMODE_ALLMULTI)\n\n#define allmulti_inactive(mode, bitmask)\t\t\t\t\\\n\txxx_inactive(mode, bitmask, BNA_RXMODE_ALLMULTI)\n\n#define\tGET_RXQS(rxp, q0, q1)\tdo {\t\t\t\t\t\\\n\tswitch ((rxp)->type) {\t\t\t\t\t\t\\\n\tcase BNA_RXP_SINGLE:\t\t\t\t\t\t\\\n\t\t(q0) = rxp->rxq.single.only;\t\t\t\t\\\n\t\t(q1) = NULL;\t\t\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\tcase BNA_RXP_SLR:\t\t\t\t\t\t\\\n\t\t(q0) = rxp->rxq.slr.large;\t\t\t\t\\\n\t\t(q1) = rxp->rxq.slr.small;\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\tcase BNA_RXP_HDS:\t\t\t\t\t\t\\\n\t\t(q0) = rxp->rxq.hds.data;\t\t\t\t\\\n\t\t(q1) = rxp->rxq.hds.hdr;\t\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define bna_tx_rid_mask(_bna) ((_bna)->tx_mod.rid_mask)\n\n#define bna_rx_rid_mask(_bna) ((_bna)->rx_mod.rid_mask)\n\n#define bna_tx_from_rid(_bna, _rid, _tx)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tstruct bna_tx_mod *__tx_mod = &(_bna)->tx_mod;\t\t\t\\\n\tstruct bna_tx *__tx;\t\t\t\t\t\t\\\n\t_tx = NULL;\t\t\t\t\t\t\t\\\n\tlist_for_each_entry(__tx, &__tx_mod->tx_active_q, qe) {\t\t\\\n\t\tif (__tx->rid == (_rid)) {\t\t\t\t\\\n\t\t\t(_tx) = __tx;\t\t\t\t\t\\\n\t\t\tbreak;\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define bna_rx_from_rid(_bna, _rid, _rx)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tstruct bna_rx_mod *__rx_mod = &(_bna)->rx_mod;\t\t\t\\\n\tstruct bna_rx *__rx;\t\t\t\t\t\t\\\n\t_rx = NULL;\t\t\t\t\t\t\t\\\n\tlist_for_each_entry(__rx, &__rx_mod->rx_active_q, qe) {\t\t\\\n\t\tif (__rx->rid == (_rid)) {\t\t\t\t\\\n\t\t\t(_rx) = __rx;\t\t\t\t\t\\\n\t\t\tbreak;\t\t\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n} while (0)\n\n#define bna_mcam_mod_free_q(_bna) (&(_bna)->mcam_mod.free_q)\n\n#define bna_mcam_mod_del_q(_bna) (&(_bna)->mcam_mod.del_q)\n\n#define bna_ucam_mod_free_q(_bna) (&(_bna)->ucam_mod.free_q)\n\n#define bna_ucam_mod_del_q(_bna) (&(_bna)->ucam_mod.del_q)\n\n \n\nstatic inline struct bna_mac *bna_mac_find(struct list_head *q, const u8 *addr)\n{\n\tstruct bna_mac *mac;\n\n\tlist_for_each_entry(mac, q, qe)\n\t\tif (ether_addr_equal(mac->addr, addr))\n\t\t\treturn mac;\n\treturn NULL;\n}\n\n#define bna_attr(_bna) (&(_bna)->ioceth.attr)\n\n \n\n \n\n \nvoid bna_bfi_stats_clr_rsp(struct bna *bna, struct bfi_msgq_mhdr *msghdr);\n\n \nvoid bna_res_req(struct bna_res_info *res_info);\nvoid bna_mod_res_req(struct bna *bna, struct bna_res_info *res_info);\nvoid bna_init(struct bna *bna, struct bnad *bnad,\n\t\t\tstruct bfa_pcidev *pcidev,\n\t\t\tstruct bna_res_info *res_info);\nvoid bna_mod_init(struct bna *bna, struct bna_res_info *res_info);\nvoid bna_uninit(struct bna *bna);\nint bna_num_txq_set(struct bna *bna, int num_txq);\nint bna_num_rxp_set(struct bna *bna, int num_rxp);\nvoid bna_hw_stats_get(struct bna *bna);\n\n \nstruct bna_mac *bna_cam_mod_mac_get(struct list_head *head);\nstruct bna_mcam_handle *bna_mcam_mod_handle_get(struct bna_mcam_mod *mod);\nvoid bna_mcam_mod_handle_put(struct bna_mcam_mod *mcam_mod,\n\t\t\t  struct bna_mcam_handle *handle);\n\n \n\n \nvoid bna_mbox_handler(struct bna *bna, u32 intr_status);\n\n \n\n \nvoid bna_ethport_cb_rx_started(struct bna_ethport *ethport);\nvoid bna_ethport_cb_rx_stopped(struct bna_ethport *ethport);\n\n \n\n \nvoid bna_bfi_tx_enet_start_rsp(struct bna_tx *tx,\n\t\t\t       struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_tx_enet_stop_rsp(struct bna_tx *tx,\n\t\t\t      struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_bw_update_aen(struct bna_tx_mod *tx_mod);\n\n \nvoid bna_tx_mod_init(struct bna_tx_mod *tx_mod, struct bna *bna,\n\t\t     struct bna_res_info *res_info);\nvoid bna_tx_mod_uninit(struct bna_tx_mod *tx_mod);\n\n \nvoid bna_tx_mod_start(struct bna_tx_mod *tx_mod, enum bna_tx_type type);\nvoid bna_tx_mod_stop(struct bna_tx_mod *tx_mod, enum bna_tx_type type);\nvoid bna_tx_mod_fail(struct bna_tx_mod *tx_mod);\n\n \nvoid bna_tx_res_req(int num_txq, int txq_depth,\n\t\t    struct bna_res_info *res_info);\nstruct bna_tx *bna_tx_create(struct bna *bna, struct bnad *bnad,\n\t\t\t       struct bna_tx_config *tx_cfg,\n\t\t\t       const struct bna_tx_event_cbfn *tx_cbfn,\n\t\t\t       struct bna_res_info *res_info, void *priv);\nvoid bna_tx_destroy(struct bna_tx *tx);\nvoid bna_tx_enable(struct bna_tx *tx);\nvoid bna_tx_disable(struct bna_tx *tx, enum bna_cleanup_type type,\n\t\t    void (*cbfn)(void *, struct bna_tx *));\nvoid bna_tx_cleanup_complete(struct bna_tx *tx);\nvoid bna_tx_coalescing_timeo_set(struct bna_tx *tx, int coalescing_timeo);\n\n \n\n \nvoid bna_bfi_rx_enet_start_rsp(struct bna_rx *rx,\n\t\t\t       struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_rx_enet_stop_rsp(struct bna_rx *rx,\n\t\t\t      struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_rxf_cfg_rsp(struct bna_rxf *rxf, struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_rxf_mcast_add_rsp(struct bna_rxf *rxf,\n\t\t\t       struct bfi_msgq_mhdr *msghdr);\nvoid bna_bfi_rxf_ucast_set_rsp(struct bna_rxf *rxf,\n\t\t\t       struct bfi_msgq_mhdr *msghdr);\n\n \nvoid bna_rx_mod_init(struct bna_rx_mod *rx_mod, struct bna *bna,\n\t\t     struct bna_res_info *res_info);\nvoid bna_rx_mod_uninit(struct bna_rx_mod *rx_mod);\n\n \nvoid bna_rx_mod_start(struct bna_rx_mod *rx_mod, enum bna_rx_type type);\nvoid bna_rx_mod_stop(struct bna_rx_mod *rx_mod, enum bna_rx_type type);\nvoid bna_rx_mod_fail(struct bna_rx_mod *rx_mod);\n\n \nvoid bna_rx_res_req(struct bna_rx_config *rx_config,\n\t\t    struct bna_res_info *res_info);\nstruct bna_rx *bna_rx_create(struct bna *bna, struct bnad *bnad,\n\t\t\t       struct bna_rx_config *rx_cfg,\n\t\t\t       const struct bna_rx_event_cbfn *rx_cbfn,\n\t\t\t       struct bna_res_info *res_info, void *priv);\nvoid bna_rx_destroy(struct bna_rx *rx);\nvoid bna_rx_enable(struct bna_rx *rx);\nvoid bna_rx_disable(struct bna_rx *rx, enum bna_cleanup_type type,\n\t\t    void (*cbfn)(void *, struct bna_rx *));\nvoid bna_rx_cleanup_complete(struct bna_rx *rx);\nvoid bna_rx_coalescing_timeo_set(struct bna_rx *rx, int coalescing_timeo);\nvoid bna_rx_dim_reconfig(struct bna *bna, const u32 vector[][BNA_BIAS_T_MAX]);\nvoid bna_rx_dim_update(struct bna_ccb *ccb);\nenum bna_cb_status bna_rx_ucast_set(struct bna_rx *rx, const u8 *ucmac);\nenum bna_cb_status bna_rx_ucast_listset(struct bna_rx *rx, int count,\n\t\t\t\t\tconst u8 *uclist);\nenum bna_cb_status bna_rx_mcast_add(struct bna_rx *rx, const u8 *mcmac,\n\t\t\t\t    void (*cbfn)(struct bnad *,\n\t\t\t\t\t\t struct bna_rx *));\nenum bna_cb_status bna_rx_mcast_listset(struct bna_rx *rx, int count,\n\t\t\t\t\tconst u8 *mcmac);\nvoid\nbna_rx_mcast_delall(struct bna_rx *rx);\nenum bna_cb_status\nbna_rx_mode_set(struct bna_rx *rx, enum bna_rxmode rxmode,\n\t\tenum bna_rxmode bitmask);\nvoid bna_rx_vlan_add(struct bna_rx *rx, int vlan_id);\nvoid bna_rx_vlan_del(struct bna_rx *rx, int vlan_id);\nvoid bna_rx_vlanfilter_enable(struct bna_rx *rx);\nvoid bna_rx_vlan_strip_enable(struct bna_rx *rx);\nvoid bna_rx_vlan_strip_disable(struct bna_rx *rx);\n \n\n \nint bna_enet_mtu_get(struct bna_enet *enet);\n\n \nvoid bna_enet_cb_tx_stopped(struct bna_enet *enet);\nvoid bna_enet_cb_rx_stopped(struct bna_enet *enet);\n\n \nvoid bna_enet_enable(struct bna_enet *enet);\nvoid bna_enet_disable(struct bna_enet *enet, enum bna_cleanup_type type,\n\t\t      void (*cbfn)(void *));\nvoid bna_enet_pause_config(struct bna_enet *enet,\n\t\t\t   struct bna_pause_config *pause_config);\nvoid bna_enet_mtu_set(struct bna_enet *enet, int mtu,\n\t\t      void (*cbfn)(struct bnad *));\nvoid bna_enet_perm_mac_get(struct bna_enet *enet, u8 *mac);\n\n \n\n \nvoid bna_ioceth_enable(struct bna_ioceth *ioceth);\nvoid bna_ioceth_disable(struct bna_ioceth *ioceth,\n\t\t\tenum bna_cleanup_type type);\n\n \n\n \nvoid bnad_cb_ethport_link_status(struct bnad *bnad,\n\t\t\t      enum bna_link_status status);\n\n \nvoid bnad_cb_ioceth_ready(struct bnad *bnad);\nvoid bnad_cb_ioceth_failed(struct bnad *bnad);\nvoid bnad_cb_ioceth_disabled(struct bnad *bnad);\nvoid bnad_cb_mbox_intr_enable(struct bnad *bnad);\nvoid bnad_cb_mbox_intr_disable(struct bnad *bnad);\n\n \nvoid bnad_cb_stats_get(struct bnad *bnad, enum bna_cb_status status,\n\t\t       struct bna_stats *stats);\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}