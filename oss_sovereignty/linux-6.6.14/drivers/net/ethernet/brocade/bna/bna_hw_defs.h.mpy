{
  "module_name": "bna_hw_defs.h",
  "hash_id": "07d52ad5818c4f594d7a3e97c89c455bb20432a6fff4231a942219a8e4332ea3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/brocade/bna/bna_hw_defs.h",
  "human_readable_source": " \n \n \n\n \n\n#ifndef __BNA_HW_DEFS_H__\n#define __BNA_HW_DEFS_H__\n\n#include \"bfi_reg.h\"\n\n \n\n#define BFI_ENET_DEF_TXQ\t\t1\n#define BFI_ENET_DEF_RXP\t\t1\n#define BFI_ENET_DEF_UCAM\t\t1\n#define BFI_ENET_DEF_RITSZ\t\t1\n\n#define BFI_ENET_MAX_MCAM\t\t256\n\n#define BFI_INVALID_RID\t\t\t-1\n\n#define BFI_IBIDX_SIZE\t\t\t4\n\n#define BFI_VLAN_WORD_SHIFT\t\t5\t \n#define BFI_VLAN_WORD_MASK\t\t0x1F\n#define BFI_VLAN_BLOCK_SHIFT\t\t9\t \n#define BFI_VLAN_BMASK_ALL\t\t0xFF\n\n#define BFI_COALESCING_TIMER_UNIT\t5\t \n#define BFI_MAX_COALESCING_TIMEO\t0xFF\t \n#define BFI_MAX_INTERPKT_COUNT\t\t0xFF\n#define BFI_MAX_INTERPKT_TIMEO\t\t0xF\t \n#define BFI_TX_COALESCING_TIMEO\t\t20\t \n#define BFI_TX_INTERPKT_COUNT\t\t12\t \n#define BFI_TX_INTERPKT_TIMEO\t\t15\t \n#define\tBFI_RX_COALESCING_TIMEO\t\t12\t \n#define\tBFI_RX_INTERPKT_COUNT\t\t6\t \n#define\tBFI_RX_INTERPKT_TIMEO\t\t3\t \n\n#define BFI_TXQ_WI_SIZE\t\t\t64\t \n#define BFI_RXQ_WI_SIZE\t\t\t8\t \n#define BFI_CQ_WI_SIZE\t\t\t16\t \n#define BFI_TX_MAX_WRR_QUOTA\t\t0xFFF\n\n#define BFI_TX_MAX_VECTORS_PER_WI\t4\n#define BFI_TX_MAX_VECTORS_PER_PKT\t0xFF\n#define BFI_TX_MAX_DATA_PER_VECTOR\t0xFFFF\n#define BFI_TX_MAX_DATA_PER_PKT\t\t0xFFFFFF\n\n \n#define BFI_SMALL_RXBUF_SIZE\t\t128\n\n#define BFI_TX_MAX_PRIO\t\t\t8\n#define BFI_TX_PRIO_MAP_ALL\t\t0xFF\n\n \n\n#define BNA_PCI_REG_CT_ADDRSZ\t\t(0x40000)\n\n#define ct_reg_addr_init(_bna, _pcidev)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct bna_reg_offset reg_offset[] =\t\t\t\t\\\n\t{{HOSTFN0_INT_STATUS, HOSTFN0_INT_MSK},\t\t\t\t\\\n\t {HOSTFN1_INT_STATUS, HOSTFN1_INT_MSK},\t\t\t\t\\\n\t {HOSTFN2_INT_STATUS, HOSTFN2_INT_MSK},\t\t\t\t\\\n\t {HOSTFN3_INT_STATUS, HOSTFN3_INT_MSK} };\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t(_bna)->regs.fn_int_status = (_pcidev)->pci_bar_kva +\t\t\\\n\t\t\t\treg_offset[(_pcidev)->pci_func].fn_int_status;\\\n\t(_bna)->regs.fn_int_mask = (_pcidev)->pci_bar_kva +\t\t\\\n\t\t\t\treg_offset[(_pcidev)->pci_func].fn_int_mask;\\\n}\n\n#define ct_bit_defn_init(_bna, _pcidev)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t(_bna)->bits.mbox_status_bits = (__HFN_INT_MBOX_LPU0 |\t\t\\\n\t\t\t\t\t__HFN_INT_MBOX_LPU1);\t\t\\\n\t(_bna)->bits.mbox_mask_bits = (__HFN_INT_MBOX_LPU0 |\t\t\\\n\t\t\t\t\t__HFN_INT_MBOX_LPU1);\t\t\\\n\t(_bna)->bits.error_status_bits = (__HFN_INT_ERR_MASK);\t\t\\\n\t(_bna)->bits.error_mask_bits = (__HFN_INT_ERR_MASK);\t\t\\\n\t(_bna)->bits.halt_status_bits = __HFN_INT_LL_HALT;\t\t\\\n\t(_bna)->bits.halt_mask_bits = __HFN_INT_LL_HALT;\t\t\\\n}\n\n#define ct2_reg_addr_init(_bna, _pcidev)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t(_bna)->regs.fn_int_status = (_pcidev)->pci_bar_kva +\t\t\\\n\t\t\t\tCT2_HOSTFN_INT_STATUS;\t\t\t\\\n\t(_bna)->regs.fn_int_mask = (_pcidev)->pci_bar_kva +\t\t\\\n\t\t\t\tCT2_HOSTFN_INTR_MASK;\t\t\t\\\n}\n\n#define ct2_bit_defn_init(_bna, _pcidev)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t(_bna)->bits.mbox_status_bits = (__HFN_INT_MBOX_LPU0_CT2 |\t\\\n\t\t\t\t\t__HFN_INT_MBOX_LPU1_CT2);\t\\\n\t(_bna)->bits.mbox_mask_bits = (__HFN_INT_MBOX_LPU0_CT2 |\t\\\n\t\t\t\t\t__HFN_INT_MBOX_LPU1_CT2);\t\\\n\t(_bna)->bits.error_status_bits = (__HFN_INT_ERR_MASK_CT2);\t\\\n\t(_bna)->bits.error_mask_bits = (__HFN_INT_ERR_MASK_CT2);\t\\\n\t(_bna)->bits.halt_status_bits = __HFN_INT_CPQ_HALT_CT2;\t\t\\\n\t(_bna)->bits.halt_mask_bits = __HFN_INT_CPQ_HALT_CT2;\t\t\\\n}\n\n#define bna_reg_addr_init(_bna, _pcidev)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tswitch ((_pcidev)->device_id) {\t\t\t\t\t\\\n\tcase PCI_DEVICE_ID_BROCADE_CT:\t\t\t\t\t\\\n\t\tct_reg_addr_init((_bna), (_pcidev));\t\t\t\\\n\t\tct_bit_defn_init((_bna), (_pcidev));\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\tcase BFA_PCI_DEVICE_ID_CT2:\t\t\t\t\t\\\n\t\tct2_reg_addr_init((_bna), (_pcidev));\t\t\t\\\n\t\tct2_bit_defn_init((_bna), (_pcidev));\t\t\t\\\n\t\tbreak;\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n}\n\n#define bna_port_id_get(_bna) ((_bna)->ioceth.ioc.port_id)\n\n \n\n#define IB_STATUS_BITS\t\t0x0000ffff\n\n#define BNA_IS_MBOX_INTR(_bna, _intr_status)\t\t\t\t\\\n\t((_intr_status) & (_bna)->bits.mbox_status_bits)\n\n#define BNA_IS_HALT_INTR(_bna, _intr_status)\t\t\t\t\\\n\t((_intr_status) & (_bna)->bits.halt_status_bits)\n\n#define BNA_IS_ERR_INTR(_bna, _intr_status)\t\\\n\t((_intr_status) & (_bna)->bits.error_status_bits)\n\n#define BNA_IS_MBOX_ERR_INTR(_bna, _intr_status)\t\\\n\t(BNA_IS_MBOX_INTR(_bna, _intr_status) |\t\t\\\n\tBNA_IS_ERR_INTR(_bna, _intr_status))\n\n#define BNA_IS_INTX_DATA_INTR(_intr_status)\t\t\\\n\t\t((_intr_status) & IB_STATUS_BITS)\n\n#define bna_halt_clear(_bna)\t\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tu32 init_halt;\t\t\t\t\t\t\\\n\tinit_halt = readl((_bna)->ioceth.ioc.ioc_regs.ll_halt);\t\\\n\tinit_halt &= ~__FW_INIT_HALT_P;\t\t\t\t\t\\\n\twritel(init_halt, (_bna)->ioceth.ioc.ioc_regs.ll_halt);\t\\\n\tinit_halt = readl((_bna)->ioceth.ioc.ioc_regs.ll_halt);\t\\\n} while (0)\n\n#define bna_intx_disable(_bna, _cur_mask)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t(_cur_mask) = readl((_bna)->regs.fn_int_mask);\t\t\\\n\twritel(0xffffffff, (_bna)->regs.fn_int_mask);\t\t\\\n}\n\n#define bna_intx_enable(bna, new_mask)\t\t\t\t\t\\\n\twritel((new_mask), (bna)->regs.fn_int_mask)\n#define bna_mbox_intr_disable(bna)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tu32 mask;\t\t\t\t\t\t\t\\\n\tmask = readl((bna)->regs.fn_int_mask);\t\t\t\t\\\n\twritel((mask | (bna)->bits.mbox_mask_bits |\t\t\t\\\n\t\t(bna)->bits.error_mask_bits), (bna)->regs.fn_int_mask); \\\n\tmask = readl((bna)->regs.fn_int_mask);\t\t\t\t\\\n} while (0)\n\n#define bna_mbox_intr_enable(bna)\t\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\tu32 mask;\t\t\t\t\t\t\t\\\n\tmask = readl((bna)->regs.fn_int_mask);\t\t\t\t\\\n\twritel((mask & ~((bna)->bits.mbox_mask_bits |\t\t\t\\\n\t\t(bna)->bits.error_mask_bits)), (bna)->regs.fn_int_mask);\\\n\tmask = readl((bna)->regs.fn_int_mask);\t\t\t\t\\\n} while (0)\n\n#define bna_intr_status_get(_bna, _status)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\t(_status) = readl((_bna)->regs.fn_int_status);\t\t\t\\\n\tif (_status) {\t\t\t\t\t\t\t\\\n\t\twritel(((_status) & ~(_bna)->bits.mbox_status_bits),\t\\\n\t\t\t(_bna)->regs.fn_int_status);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n}\n\n \n#define BNA_IB_MAX_ACK_EVENTS\t\tBIT(15)\n\n \n#define BNA_DOORBELL_Q_PRD_IDX(_pi)\t(0x80000000 | (_pi))\n#define BNA_DOORBELL_Q_STOP\t\t(0x40000000)\n\n \n#define BNA_DOORBELL_IB_INT_ACK(_timeout, _events)\t\t\t\\\n\t(0x80000000 | ((_timeout) << 16) | (_events))\n#define BNA_DOORBELL_IB_INT_DISABLE\t(0x40000000)\n\n \n#define bna_ib_coalescing_timer_set(_i_dbell, _cls_timer)\t\t\\\n\t((_i_dbell)->doorbell_ack = BNA_DOORBELL_IB_INT_ACK((_cls_timer), 0))\n\n \n#define bna_ib_ack_disable_irq(_i_dbell, _events)\t\t\t\\\n\t(writel(BNA_DOORBELL_IB_INT_ACK(0, (_events)),\t\t\t\\\n\t\t(_i_dbell)->doorbell_addr))\n\n \n#define bna_ib_ack(_i_dbell, _events)\t\t\t\t\t\\\n\t(writel(((_i_dbell)->doorbell_ack | (_events)),\t\t\\\n\t\t(_i_dbell)->doorbell_addr))\n\n#define bna_ib_start(_bna, _ib, _is_regular)\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tu32 intx_mask;\t\t\t\t\t\t\\\n\tstruct bna_ib *ib = _ib;\t\t\t\t\t\\\n\tif ((ib->intr_type == BNA_INTR_T_INTX)) {\t\t\t\\\n\t\tbna_intx_disable((_bna), intx_mask);\t\t\t\\\n\t\tintx_mask &= ~(ib->intr_vector);\t\t\t\\\n\t\tbna_intx_enable((_bna), intx_mask);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tbna_ib_coalescing_timer_set(&ib->door_bell,\t\t\t\\\n\t\t\tib->coalescing_timeo);\t\t\t\t\\\n\tif (_is_regular)\t\t\t\t\t\t\\\n\t\tbna_ib_ack(&ib->door_bell, 0);\t\t\t\t\\\n}\n\n#define bna_ib_stop(_bna, _ib)\t\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tu32 intx_mask;\t\t\t\t\t\t\\\n\tstruct bna_ib *ib = _ib;\t\t\t\t\t\\\n\twritel(BNA_DOORBELL_IB_INT_DISABLE,\t\t\t\t\\\n\t\tib->door_bell.doorbell_addr);\t\t\t\t\\\n\tif (ib->intr_type == BNA_INTR_T_INTX) {\t\t\t\t\\\n\t\tbna_intx_disable((_bna), intx_mask);\t\t\t\\\n\t\tintx_mask |= ib->intr_vector;\t\t\t\t\\\n\t\tbna_intx_enable((_bna), intx_mask);\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n}\n\n#define bna_txq_prod_indx_doorbell(_tcb)\t\t\t\t\\\n\t(writel(BNA_DOORBELL_Q_PRD_IDX((_tcb)->producer_index),\t\t\\\n\t\t(_tcb)->q_dbell))\n\n#define bna_rxq_prod_indx_doorbell(_rcb)\t\t\t\t\\\n\t(writel(BNA_DOORBELL_Q_PRD_IDX((_rcb)->producer_index),\t\t\\\n\t\t(_rcb)->q_dbell))\n\n \n\n \n#define BNA_TXQ_WI_SEND\t\t\t(0x402)\t \n#define BNA_TXQ_WI_SEND_LSO\t\t(0x403)\t \n#define BNA_TXQ_WI_EXTENSION\t\t(0x104)\t \n\n \n#define BNA_TXQ_WI_CF_FCOE_CRC\t\tBIT(8)\n#define BNA_TXQ_WI_CF_IPID_MODE\t\tBIT(5)\n#define BNA_TXQ_WI_CF_INS_PRIO\t\tBIT(4)\n#define BNA_TXQ_WI_CF_INS_VLAN\t\tBIT(3)\n#define BNA_TXQ_WI_CF_UDP_CKSUM\t\tBIT(2)\n#define BNA_TXQ_WI_CF_TCP_CKSUM\t\tBIT(1)\n#define BNA_TXQ_WI_CF_IP_CKSUM\t\tBIT(0)\n\n#define BNA_TXQ_WI_L4_HDR_N_OFFSET(_hdr_size, _offset) \\\n\t\t(((_hdr_size) << 10) | ((_offset) & 0x3FF))\n\n \n \n#define BNA_CQ_EF_MAC_ERROR\tBIT(0)\n#define BNA_CQ_EF_FCS_ERROR\tBIT(1)\n#define BNA_CQ_EF_TOO_LONG\tBIT(2)\n#define BNA_CQ_EF_FC_CRC_OK\tBIT(3)\n\n#define BNA_CQ_EF_RSVD1\t\tBIT(4)\n#define BNA_CQ_EF_L4_CKSUM_OK\tBIT(5)\n#define BNA_CQ_EF_L3_CKSUM_OK\tBIT(6)\n#define BNA_CQ_EF_HDS_HEADER\tBIT(7)\n\n#define BNA_CQ_EF_UDP\t\tBIT(8)\n#define BNA_CQ_EF_TCP\t\tBIT(9)\n#define BNA_CQ_EF_IP_OPTIONS\tBIT(10)\n#define BNA_CQ_EF_IPV6\t\tBIT(11)\n\n#define BNA_CQ_EF_IPV4\t\tBIT(12)\n#define BNA_CQ_EF_VLAN\t\tBIT(13)\n#define BNA_CQ_EF_RSS\t\tBIT(14)\n#define BNA_CQ_EF_RSVD2\t\tBIT(15)\n\n#define BNA_CQ_EF_MCAST_MATCH   BIT(16)\n#define BNA_CQ_EF_MCAST\t\tBIT(17)\n#define BNA_CQ_EF_BCAST\t\tBIT(18)\n#define BNA_CQ_EF_REMOTE\tBIT(19)\n\n#define BNA_CQ_EF_LOCAL\t\tBIT(20)\n \n#define BNA_CQ_EF_EOP\t\tBIT(31)\n\n \n\nstruct bna_reg_offset {\n\tu32 fn_int_status;\n\tu32 fn_int_mask;\n};\n\nstruct bna_bit_defn {\n\tu32 mbox_status_bits;\n\tu32 mbox_mask_bits;\n\tu32 error_status_bits;\n\tu32 error_mask_bits;\n\tu32 halt_status_bits;\n\tu32 halt_mask_bits;\n};\n\nstruct bna_reg {\n\tvoid __iomem *fn_int_status;\n\tvoid __iomem *fn_int_mask;\n};\n\n \nstruct bna_dma_addr {\n\tu32\t\tmsb;\n\tu32\t\tlsb;\n};\n\nstruct bna_txq_wi_vector {\n\tu16\t\treserved;\n\tu16\t\tlength;\t\t \n\tstruct bna_dma_addr host_addr;  \n};\n\n \nstruct bna_txq_entry {\n\tunion {\n\t\tstruct {\n\t\t\tu8 reserved;\n\t\t\tu8 num_vectors;\t \n\t\t\tu16 opcode;  \n\t\t\t\t\t\t     \n\t\t\t\t\t\t     \n\t\t\tu16 flags;  \n\t\t\tu16 l4_hdr_size_n_offset;\n\t\t\tu16 vlan_tag;\n\t\t\tu16 lso_mss;\t \n\t\t\tu32 frame_length;\t \n\t\t} wi;\n\n\t\tstruct {\n\t\t\tu16 reserved;\n\t\t\tu16 opcode;  \n\t\t\t\t\t\t     \n\t\t\tu32 reserved2[3];\t \n\t\t\t\t\t\t \n\t\t} wi_ext;\n\t} hdr;\n\tstruct bna_txq_wi_vector vector[4];\n};\n\n \nstruct bna_rxq_entry {\t\t \n\tstruct bna_dma_addr host_addr;  \n};\n\n \nstruct bna_cq_entry {\n\tu32 flags;\n\tu16 vlan_tag;\n\tu16 length;\n\tu32 rss_hash;\n\tu8 valid;\n\tu8 reserved1;\n\tu8 reserved2;\n\tu8 rxq_id;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}