{
  "module_name": "cna_fwimg.c",
  "hash_id": "85c1ff1ff72dedfbd439ed71c01892e4f8fe6f11d28fa210dad57e28b5b66fbf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/brocade/bna/cna_fwimg.c",
  "human_readable_source": "\n \n \n#include <linux/firmware.h>\n#include \"bnad.h\"\n#include \"bfi.h\"\n#include \"cna.h\"\n\nconst struct firmware *bfi_fw;\nstatic u32 *bfi_image_ct_cna, *bfi_image_ct2_cna;\nstatic u32 bfi_image_ct_cna_size, bfi_image_ct2_cna_size;\n\nstatic u32 *\ncna_read_firmware(struct pci_dev *pdev, u32 **bfi_image,\n\t\t\tu32 *bfi_image_size, char *fw_name)\n{\n\tconst struct firmware *fw;\n\tu32 n;\n\n\tif (request_firmware(&fw, fw_name, &pdev->dev)) {\n\t\tdev_alert(&pdev->dev, \"can't load firmware %s\\n\", fw_name);\n\t\tgoto error;\n\t}\n\n\t*bfi_image = (u32 *)fw->data;\n\t*bfi_image_size = fw->size/sizeof(u32);\n\tbfi_fw = fw;\n\n\t \n\tfor (n = 0; n < *bfi_image_size; n++)\n\t\tle32_to_cpus(*bfi_image + n);\n\n\treturn *bfi_image;\nerror:\n\treturn NULL;\n}\n\nu32 *\ncna_get_firmware_buf(struct pci_dev *pdev)\n{\n\tif (pdev->device == BFA_PCI_DEVICE_ID_CT2) {\n\t\tif (bfi_image_ct2_cna_size == 0)\n\t\t\tcna_read_firmware(pdev, &bfi_image_ct2_cna,\n\t\t\t\t&bfi_image_ct2_cna_size, CNA_FW_FILE_CT2);\n\t\treturn bfi_image_ct2_cna;\n\t} else if (bfa_asic_id_ct(pdev->device)) {\n\t\tif (bfi_image_ct_cna_size == 0)\n\t\t\tcna_read_firmware(pdev, &bfi_image_ct_cna,\n\t\t\t\t&bfi_image_ct_cna_size, CNA_FW_FILE_CT);\n\t\treturn bfi_image_ct_cna;\n\t}\n\n\treturn NULL;\n}\n\nu32 *\nbfa_cb_image_get_chunk(enum bfi_asic_gen asic_gen, u32 off)\n{\n\tswitch (asic_gen) {\n\tcase BFI_ASIC_GEN_CT:\n\t\treturn (bfi_image_ct_cna + off);\n\tcase BFI_ASIC_GEN_CT2:\n\t\treturn (bfi_image_ct2_cna + off);\n\tdefault:\n\t\treturn NULL;\n\t}\n}\n\nu32\nbfa_cb_image_get_size(enum bfi_asic_gen asic_gen)\n{\n\tswitch (asic_gen) {\n\tcase BFI_ASIC_GEN_CT:\n\t\treturn bfi_image_ct_cna_size;\n\tcase BFI_ASIC_GEN_CT2:\n\t\treturn bfi_image_ct2_cna_size;\n\tdefault:\n\t\treturn 0;\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}