{
  "module_name": "bfa_msgq.h",
  "hash_id": "d53fbc8b569583fe87105cc240996c0ef22dd998d5e7080453e07ed3112ec857",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/brocade/bna/bfa_msgq.h",
  "human_readable_source": " \n \n \n\n#ifndef __BFA_MSGQ_H__\n#define __BFA_MSGQ_H__\n\n#include \"bfa_defs.h\"\n#include \"bfi.h\"\n#include \"bfa_ioc.h\"\n#include \"bfa_cs.h\"\n\n#define BFA_MSGQ_FREE_CNT(_q)\t\t\t\t\t\t\\\n\t(((_q)->consumer_index - (_q)->producer_index - 1) & ((_q)->depth - 1))\n\n#define BFA_MSGQ_INDX_ADD(_q_indx, _qe_num, _q_depth)\t\t\t\\\n\t((_q_indx) = (((_q_indx) + (_qe_num)) & ((_q_depth) - 1)))\n\n#define BFA_MSGQ_CMDQ_NUM_ENTRY\t\t128\n#define BFA_MSGQ_CMDQ_SIZE\t\t\t\t\t\t\\\n\t(BFI_MSGQ_CMD_ENTRY_SIZE * BFA_MSGQ_CMDQ_NUM_ENTRY)\n\n#define BFA_MSGQ_RSPQ_NUM_ENTRY\t\t128\n#define BFA_MSGQ_RSPQ_SIZE\t\t\t\t\t\t\\\n\t(BFI_MSGQ_RSP_ENTRY_SIZE * BFA_MSGQ_RSPQ_NUM_ENTRY)\n\n#define bfa_msgq_cmd_set(_cmd, _cbfn, _cbarg, _msg_size, _msg_hdr)\t\\\ndo {\t\t\t\t\t\t\t\t\t\\\n\t(_cmd)->cbfn = (_cbfn);\t\t\t\t\t\t\\\n\t(_cmd)->cbarg = (_cbarg);\t\t\t\t\t\\\n\t(_cmd)->msg_size = (_msg_size);\t\t\t\t\t\\\n\t(_cmd)->msg_hdr = (_msg_hdr);\t\t\t\t\t\\\n} while (0)\n\nstruct bfa_msgq;\n\ntypedef void (*bfa_msgq_cmdcbfn_t)(void *cbarg, enum bfa_status status);\n\nstruct bfa_msgq_cmd_entry {\n\tstruct list_head\t\t\t\tqe;\n\tbfa_msgq_cmdcbfn_t\t\tcbfn;\n\tvoid\t\t\t\t*cbarg;\n\tsize_t\t\t\t\tmsg_size;\n\tstruct bfi_msgq_mhdr *msg_hdr;\n};\n\nenum bfa_msgq_cmdq_flags {\n\tBFA_MSGQ_CMDQ_F_DB_UPDATE\t= 1,\n};\n\nenum cmdq_event;\n\nstruct bfa_msgq_cmdq {\n\tvoid (*fsm)(struct bfa_msgq_cmdq *s, enum cmdq_event e);\n\tenum bfa_msgq_cmdq_flags flags;\n\n\tu16\t\t\tproducer_index;\n\tu16\t\t\tconsumer_index;\n\tu16\t\t\tdepth;  \n\tstruct bfa_dma addr;\n\tstruct bfa_mbox_cmd dbell_mb;\n\n\tu16\t\t\ttoken;\n\tint\t\t\t\toffset;\n\tint\t\t\t\tbytes_to_copy;\n\tstruct bfa_mbox_cmd copy_mb;\n\n\tstruct list_head\t\tpending_q;  \n\n\tstruct bfa_msgq *msgq;\n};\n\nenum bfa_msgq_rspq_flags {\n\tBFA_MSGQ_RSPQ_F_DB_UPDATE\t= 1,\n};\n\ntypedef void (*bfa_msgq_mcfunc_t)(void *cbarg, struct bfi_msgq_mhdr *mhdr);\n\nenum rspq_event;\n\nstruct bfa_msgq_rspq {\n\tvoid (*fsm)(struct bfa_msgq_rspq *s, enum rspq_event e);\n\tenum bfa_msgq_rspq_flags flags;\n\n\tu16\t\t\tproducer_index;\n\tu16\t\t\tconsumer_index;\n\tu16\t\t\tdepth;  \n\tstruct bfa_dma addr;\n\tstruct bfa_mbox_cmd dbell_mb;\n\n\tint\t\t\t\tnmclass;\n\tstruct {\n\t\tbfa_msgq_mcfunc_t\tcbfn;\n\t\tvoid\t\t\t*cbarg;\n\t} rsphdlr[BFI_MC_MAX];\n\n\tstruct bfa_msgq *msgq;\n};\n\nstruct bfa_msgq {\n\tstruct bfa_msgq_cmdq cmdq;\n\tstruct bfa_msgq_rspq rspq;\n\n\tstruct bfa_wc\t\t\tinit_wc;\n\tstruct bfa_mbox_cmd init_mb;\n\n\tstruct bfa_ioc_notify ioc_notify;\n\tstruct bfa_ioc *ioc;\n};\n\nu32 bfa_msgq_meminfo(void);\nvoid bfa_msgq_memclaim(struct bfa_msgq *msgq, u8 *kva, u64 pa);\nvoid bfa_msgq_attach(struct bfa_msgq *msgq, struct bfa_ioc *ioc);\nvoid bfa_msgq_regisr(struct bfa_msgq *msgq, enum bfi_mclass mc,\n\t\t     bfa_msgq_mcfunc_t cbfn, void *cbarg);\nvoid bfa_msgq_cmd_post(struct bfa_msgq *msgq,\n\t\t       struct bfa_msgq_cmd_entry *cmd);\nvoid bfa_msgq_rsp_copy(struct bfa_msgq *msgq, u8 *buf, size_t buf_len);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}