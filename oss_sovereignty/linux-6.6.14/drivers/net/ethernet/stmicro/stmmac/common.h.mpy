{
  "module_name": "common.h",
  "hash_id": "6f067ffddbcfe5370c3e5b4fdbd6504521f98326f43ce8fd2e5d0cdcf2093fdf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/stmicro/stmmac/common.h",
  "human_readable_source": " \n \n\n#ifndef __COMMON_H__\n#define __COMMON_H__\n\n#include <linux/etherdevice.h>\n#include <linux/netdevice.h>\n#include <linux/stmmac.h>\n#include <linux/phy.h>\n#include <linux/pcs/pcs-xpcs.h>\n#include <linux/module.h>\n#if IS_ENABLED(CONFIG_VLAN_8021Q)\n#define STMMAC_VLAN_TAG_USED\n#include <linux/if_vlan.h>\n#endif\n\n#include \"descs.h\"\n#include \"hwif.h\"\n#include \"mmc.h\"\n\n \n#define\tDWMAC_CORE_3_40\t\t0x34\n#define\tDWMAC_CORE_3_50\t\t0x35\n#define\tDWMAC_CORE_4_00\t\t0x40\n#define DWMAC_CORE_4_10\t\t0x41\n#define DWMAC_CORE_5_00\t\t0x50\n#define DWMAC_CORE_5_10\t\t0x51\n#define DWMAC_CORE_5_20\t\t0x52\n#define DWXGMAC_CORE_2_10\t0x21\n#define DWXGMAC_CORE_2_20\t0x22\n#define DWXLGMAC_CORE_2_00\t0x20\n\n \n#define DWXGMAC_ID\t\t0x76\n#define DWXLGMAC_ID\t\t0x27\n\n#define STMMAC_CHAN0\t0\t \n\n \n#define DMA_MIN_TX_SIZE\t\t64\n#define DMA_MAX_TX_SIZE\t\t1024\n#define DMA_DEFAULT_TX_SIZE\t512\n#define DMA_MIN_RX_SIZE\t\t64\n#define DMA_MAX_RX_SIZE\t\t1024\n#define DMA_DEFAULT_RX_SIZE\t512\n#define STMMAC_GET_ENTRY(x, size)\t((x + 1) & (size - 1))\n\n#undef FRAME_FILTER_DEBUG\n \n\nstruct stmmac_txq_stats {\n\tu64 tx_bytes;\n\tu64 tx_packets;\n\tu64 tx_pkt_n;\n\tu64 tx_normal_irq_n;\n\tu64 napi_poll;\n\tu64 tx_clean;\n\tu64 tx_set_ic_bit;\n\tu64 tx_tso_frames;\n\tu64 tx_tso_nfrags;\n\tstruct u64_stats_sync syncp;\n} ____cacheline_aligned_in_smp;\n\nstruct stmmac_rxq_stats {\n\tu64 rx_bytes;\n\tu64 rx_packets;\n\tu64 rx_pkt_n;\n\tu64 rx_normal_irq_n;\n\tu64 napi_poll;\n\tstruct u64_stats_sync syncp;\n} ____cacheline_aligned_in_smp;\n\n \nstruct stmmac_extra_stats {\n\t \n\tunsigned long tx_underflow ____cacheline_aligned;\n\tunsigned long tx_carrier;\n\tunsigned long tx_losscarrier;\n\tunsigned long vlan_tag;\n\tunsigned long tx_deferred;\n\tunsigned long tx_vlan;\n\tunsigned long tx_jabber;\n\tunsigned long tx_frame_flushed;\n\tunsigned long tx_payload_error;\n\tunsigned long tx_ip_header_error;\n\tunsigned long tx_collision;\n\t \n\tunsigned long rx_desc;\n\tunsigned long sa_filter_fail;\n\tunsigned long overflow_error;\n\tunsigned long ipc_csum_error;\n\tunsigned long rx_collision;\n\tunsigned long rx_crc_errors;\n\tunsigned long dribbling_bit;\n\tunsigned long rx_length;\n\tunsigned long rx_mii;\n\tunsigned long rx_multicast;\n\tunsigned long rx_gmac_overflow;\n\tunsigned long rx_watchdog;\n\tunsigned long da_rx_filter_fail;\n\tunsigned long sa_rx_filter_fail;\n\tunsigned long rx_missed_cntr;\n\tunsigned long rx_overflow_cntr;\n\tunsigned long rx_vlan;\n\tunsigned long rx_split_hdr_pkt_n;\n\t \n\tunsigned long tx_undeflow_irq;\n\tunsigned long tx_process_stopped_irq;\n\tunsigned long tx_jabber_irq;\n\tunsigned long rx_overflow_irq;\n\tunsigned long rx_buf_unav_irq;\n\tunsigned long rx_process_stopped_irq;\n\tunsigned long rx_watchdog_irq;\n\tunsigned long tx_early_irq;\n\tunsigned long fatal_bus_error_irq;\n\t \n\tunsigned long rx_early_irq;\n\tunsigned long threshold;\n\tunsigned long irq_receive_pmt_irq_n;\n\t \n\tunsigned long mmc_tx_irq_n;\n\tunsigned long mmc_rx_irq_n;\n\tunsigned long mmc_rx_csum_offload_irq_n;\n\t \n\tunsigned long irq_tx_path_in_lpi_mode_n;\n\tunsigned long irq_tx_path_exit_lpi_mode_n;\n\tunsigned long irq_rx_path_in_lpi_mode_n;\n\tunsigned long irq_rx_path_exit_lpi_mode_n;\n\tunsigned long phy_eee_wakeup_error_n;\n\t \n\tunsigned long ip_hdr_err;\n\tunsigned long ip_payload_err;\n\tunsigned long ip_csum_bypassed;\n\tunsigned long ipv4_pkt_rcvd;\n\tunsigned long ipv6_pkt_rcvd;\n\tunsigned long no_ptp_rx_msg_type_ext;\n\tunsigned long ptp_rx_msg_type_sync;\n\tunsigned long ptp_rx_msg_type_follow_up;\n\tunsigned long ptp_rx_msg_type_delay_req;\n\tunsigned long ptp_rx_msg_type_delay_resp;\n\tunsigned long ptp_rx_msg_type_pdelay_req;\n\tunsigned long ptp_rx_msg_type_pdelay_resp;\n\tunsigned long ptp_rx_msg_type_pdelay_follow_up;\n\tunsigned long ptp_rx_msg_type_announce;\n\tunsigned long ptp_rx_msg_type_management;\n\tunsigned long ptp_rx_msg_pkt_reserved_type;\n\tunsigned long ptp_frame_type;\n\tunsigned long ptp_ver;\n\tunsigned long timestamp_dropped;\n\tunsigned long av_pkt_rcvd;\n\tunsigned long av_tagged_pkt_rcvd;\n\tunsigned long vlan_tag_priority_val;\n\tunsigned long l3_filter_match;\n\tunsigned long l4_filter_match;\n\tunsigned long l3_l4_filter_no_match;\n\t \n\tunsigned long irq_pcs_ane_n;\n\tunsigned long irq_pcs_link_n;\n\tunsigned long irq_rgmii_n;\n\tunsigned long pcs_link;\n\tunsigned long pcs_duplex;\n\tunsigned long pcs_speed;\n\t \n\tunsigned long mtl_tx_status_fifo_full;\n\tunsigned long mtl_tx_fifo_not_empty;\n\tunsigned long mmtl_fifo_ctrl;\n\tunsigned long mtl_tx_fifo_read_ctrl_write;\n\tunsigned long mtl_tx_fifo_read_ctrl_wait;\n\tunsigned long mtl_tx_fifo_read_ctrl_read;\n\tunsigned long mtl_tx_fifo_read_ctrl_idle;\n\tunsigned long mac_tx_in_pause;\n\tunsigned long mac_tx_frame_ctrl_xfer;\n\tunsigned long mac_tx_frame_ctrl_idle;\n\tunsigned long mac_tx_frame_ctrl_wait;\n\tunsigned long mac_tx_frame_ctrl_pause;\n\tunsigned long mac_gmii_tx_proto_engine;\n\tunsigned long mtl_rx_fifo_fill_level_full;\n\tunsigned long mtl_rx_fifo_fill_above_thresh;\n\tunsigned long mtl_rx_fifo_fill_below_thresh;\n\tunsigned long mtl_rx_fifo_fill_level_empty;\n\tunsigned long mtl_rx_fifo_read_ctrl_flush;\n\tunsigned long mtl_rx_fifo_read_ctrl_read_data;\n\tunsigned long mtl_rx_fifo_read_ctrl_status;\n\tunsigned long mtl_rx_fifo_read_ctrl_idle;\n\tunsigned long mtl_rx_fifo_ctrl_active;\n\tunsigned long mac_rx_frame_ctrl_fifo;\n\tunsigned long mac_gmii_rx_proto_engine;\n\t \n\tunsigned long mtl_est_cgce;\n\tunsigned long mtl_est_hlbs;\n\tunsigned long mtl_est_hlbf;\n\tunsigned long mtl_est_btre;\n\tunsigned long mtl_est_btrlm;\n\t \n\tstruct stmmac_txq_stats txq_stats[MTL_MAX_TX_QUEUES];\n\tstruct stmmac_rxq_stats rxq_stats[MTL_MAX_RX_QUEUES];\n\tunsigned long rx_dropped;\n\tunsigned long rx_errors;\n\tunsigned long tx_dropped;\n\tunsigned long tx_errors;\n};\n\n \nstruct stmmac_safety_stats {\n\tunsigned long mac_errors[32];\n\tunsigned long mtl_errors[32];\n\tunsigned long dma_errors[32];\n};\n\n \n#define STMMAC_SAFETY_FEAT_SIZE\t\\\n\t(sizeof(struct stmmac_safety_stats) / sizeof(unsigned long))\n\n \n#define CSR_F_35M\t35000000\n#define CSR_F_60M\t60000000\n#define CSR_F_100M\t100000000\n#define CSR_F_150M\t150000000\n#define CSR_F_250M\t250000000\n#define CSR_F_300M\t300000000\n\n#define\tMAC_CSR_H_FRQ_MASK\t0x20\n\n#define HASH_TABLE_SIZE 64\n#define PAUSE_TIME 0xffff\n\n \n#define FLOW_OFF\t0\n#define FLOW_RX\t\t1\n#define FLOW_TX\t\t2\n#define FLOW_AUTO\t(FLOW_TX | FLOW_RX)\n\n \n#define STMMAC_PCS_RGMII\t(1 << 0)\n#define STMMAC_PCS_SGMII\t(1 << 1)\n#define STMMAC_PCS_TBI\t\t(1 << 2)\n#define STMMAC_PCS_RTBI\t\t(1 << 3)\n\n#define SF_DMA_MODE 1\t\t \n\n \n#define DMA_HW_FEAT_MIISEL\t0x00000001\t \n#define DMA_HW_FEAT_GMIISEL\t0x00000002\t \n#define DMA_HW_FEAT_HDSEL\t0x00000004\t \n#define DMA_HW_FEAT_EXTHASHEN\t0x00000008\t \n#define DMA_HW_FEAT_HASHSEL\t0x00000010\t \n#define DMA_HW_FEAT_ADDMAC\t0x00000020\t \n#define DMA_HW_FEAT_PCSSEL\t0x00000040\t \n#define DMA_HW_FEAT_L3L4FLTREN\t0x00000080\t \n#define DMA_HW_FEAT_SMASEL\t0x00000100\t \n#define DMA_HW_FEAT_RWKSEL\t0x00000200\t \n#define DMA_HW_FEAT_MGKSEL\t0x00000400\t \n#define DMA_HW_FEAT_MMCSEL\t0x00000800\t \n#define DMA_HW_FEAT_TSVER1SEL\t0x00001000\t \n#define DMA_HW_FEAT_TSVER2SEL\t0x00002000\t \n#define DMA_HW_FEAT_EEESEL\t0x00004000\t \n#define DMA_HW_FEAT_AVSEL\t0x00008000\t \n#define DMA_HW_FEAT_TXCOESEL\t0x00010000\t \n#define DMA_HW_FEAT_RXTYP1COE\t0x00020000\t \n#define DMA_HW_FEAT_RXTYP2COE\t0x00040000\t \n#define DMA_HW_FEAT_RXFIFOSIZE\t0x00080000\t \n#define DMA_HW_FEAT_RXCHCNT\t0x00300000\t \n#define DMA_HW_FEAT_TXCHCNT\t0x00c00000\t \n#define DMA_HW_FEAT_ENHDESSEL\t0x01000000\t \n \n#define DMA_HW_FEAT_INTTSEN\t0x02000000\n#define DMA_HW_FEAT_FLEXIPPSEN\t0x04000000\t \n#define DMA_HW_FEAT_SAVLANINS\t0x08000000\t \n#define DMA_HW_FEAT_ACTPHYIF\t0x70000000\t \n#define DEFAULT_DMA_PBL\t\t8\n\n \n#define STMMAC_MSI_VEC_MAX\t32\n\n \n#define\tPCS_ANE_IRQ\t\tBIT(2)\t \n#define\tPCS_LINK_IRQ\t\tBIT(1)\t \n#define\tPCS_RGSMIIIS_IRQ\tBIT(0)\t \n\n \n#define MAX_DMA_RIWT\t\t0xff\n#define MIN_DMA_RIWT\t\t0x10\n#define DEF_DMA_RIWT\t\t0xa0\n \n#define STMMAC_COAL_TX_TIMER\t1000\n#define STMMAC_MAX_COAL_TX_TICK\t100000\n#define STMMAC_TX_MAX_FRAMES\t256\n#define STMMAC_TX_FRAMES\t25\n#define STMMAC_RX_FRAMES\t0\n\n \nenum packets_types {\n\tPACKET_AVCPQ = 0x1,  \n\tPACKET_PTPQ = 0x2,  \n\tPACKET_DCBCPQ = 0x3,  \n\tPACKET_UPQ = 0x4,  \n\tPACKET_MCBCQ = 0x5,  \n};\n\n \nenum rx_frame_status {\n\tgood_frame = 0x0,\n\tdiscard_frame = 0x1,\n\tcsum_none = 0x2,\n\tllc_snap = 0x4,\n\tdma_own = 0x8,\n\trx_not_ls = 0x10,\n};\n\n \nenum tx_frame_status {\n\ttx_done = 0x0,\n\ttx_not_ls = 0x1,\n\ttx_err = 0x2,\n\ttx_dma_own = 0x4,\n\ttx_err_bump_tc = 0x8,\n};\n\nenum dma_irq_status {\n\ttx_hard_error = 0x1,\n\ttx_hard_error_bump_tc = 0x2,\n\thandle_rx = 0x4,\n\thandle_tx = 0x8,\n};\n\nenum dma_irq_dir {\n\tDMA_DIR_RX = 0x1,\n\tDMA_DIR_TX = 0x2,\n\tDMA_DIR_RXTX = 0x3,\n};\n\nenum request_irq_err {\n\tREQ_IRQ_ERR_ALL,\n\tREQ_IRQ_ERR_TX,\n\tREQ_IRQ_ERR_RX,\n\tREQ_IRQ_ERR_SFTY_UE,\n\tREQ_IRQ_ERR_SFTY_CE,\n\tREQ_IRQ_ERR_LPI,\n\tREQ_IRQ_ERR_WOL,\n\tREQ_IRQ_ERR_MAC,\n\tREQ_IRQ_ERR_NO,\n};\n\n \n#define\tCORE_IRQ_TX_PATH_IN_LPI_MODE\t(1 << 0)\n#define\tCORE_IRQ_TX_PATH_EXIT_LPI_MODE\t(1 << 1)\n#define\tCORE_IRQ_RX_PATH_IN_LPI_MODE\t(1 << 2)\n#define\tCORE_IRQ_RX_PATH_EXIT_LPI_MODE\t(1 << 3)\n\n \n#define FPE_EVENT_UNKNOWN\t\t0\n#define FPE_EVENT_TRSP\t\t\tBIT(0)\n#define FPE_EVENT_TVER\t\t\tBIT(1)\n#define FPE_EVENT_RRSP\t\t\tBIT(2)\n#define FPE_EVENT_RVER\t\t\tBIT(3)\n\n#define CORE_IRQ_MTL_RX_OVERFLOW\tBIT(8)\n\n \nstruct rgmii_adv {\n\tunsigned int pause;\n\tunsigned int duplex;\n\tunsigned int lp_pause;\n\tunsigned int lp_duplex;\n};\n\n#define STMMAC_PCS_PAUSE\t1\n#define STMMAC_PCS_ASYM_PAUSE\t2\n\n \nstruct dma_features {\n\tunsigned int mbps_10_100;\n\tunsigned int mbps_1000;\n\tunsigned int half_duplex;\n\tunsigned int hash_filter;\n\tunsigned int multi_addr;\n\tunsigned int pcs;\n\tunsigned int sma_mdio;\n\tunsigned int pmt_remote_wake_up;\n\tunsigned int pmt_magic_frame;\n\tunsigned int rmon;\n\t \n\tunsigned int time_stamp;\n\t \n\tunsigned int atime_stamp;\n\t \n\tunsigned int eee;\n\tunsigned int av;\n\tunsigned int hash_tb_sz;\n\tunsigned int tsoen;\n\t \n\tunsigned int tx_coe;\n\tunsigned int rx_coe;\n\tunsigned int rx_coe_type1;\n\tunsigned int rx_coe_type2;\n\tunsigned int rxfifo_over_2048;\n\t \n\tunsigned int number_rx_channel;\n\tunsigned int number_tx_channel;\n\t \n\tunsigned int number_rx_queues;\n\tunsigned int number_tx_queues;\n\t \n\tunsigned int pps_out_num;\n\t \n\tunsigned int numtc;\n\t \n\tunsigned int dcben;\n\t \n\tunsigned int advthword;\n\t \n\tunsigned int ptoen;\n\t \n\tunsigned int osten;\n\t \n\tunsigned int pfcen;\n\t \n\tunsigned int enh_desc;\n\t \n\tunsigned int tx_fifo_size;\n\tunsigned int rx_fifo_size;\n\t \n\tunsigned int asp;\n\t \n\tunsigned int frpsel;\n\tunsigned int frpbs;\n\tunsigned int frpes;\n\tunsigned int addr64;\n\tunsigned int host_dma_width;\n\tunsigned int rssen;\n\tunsigned int vlhash;\n\tunsigned int sphen;\n\tunsigned int vlins;\n\tunsigned int dvlan;\n\tunsigned int l3l4fnum;\n\tunsigned int arpoffsel;\n\t \n\tunsigned int pou_ost_en;\n\t \n\tunsigned int ttsfd;\n\t \n\tunsigned int cbtisel;\n\t \n\tunsigned int frppipe_num;\n\t \n\tunsigned int nrvf_num;\n\t \n\tunsigned int estwid;\n\tunsigned int estdep;\n\tunsigned int estsel;\n\tunsigned int fpesel;\n\tunsigned int tbssel;\n\t \n\tunsigned int tbs_ch_num;\n\t \n\tunsigned int sgfsel;\n\t \n\tunsigned int aux_snapshot_n;\n\t \n\tunsigned int tssrc;\n\t \n\tunsigned int edma;\n\t \n\tunsigned int ediffc;\n\t \n\tunsigned int vxn;\n\t \n\tunsigned int dbgmem;\n\t \n\tunsigned int pcsel;\n};\n\n \n#define BUF_SIZE_16KiB 16368\n#define BUF_SIZE_8KiB 8188\n#define BUF_SIZE_4KiB 4096\n#define BUF_SIZE_2KiB 2048\n\n \n#define PMT_NOT_SUPPORTED 0\n#define PMT_SUPPORTED 1\n\n \n#define MAC_CTRL_REG\t\t0x00000000\t \n#define MAC_ENABLE_TX\t\t0x00000008\t \n#define MAC_ENABLE_RX\t\t0x00000004\t \n\n \n#define STMMAC_DEFAULT_LIT_LS\t0x3E8\n#define STMMAC_DEFAULT_TWT_LS\t0x1E\n#define STMMAC_ET_MAX\t\t0xFFFFF\n\n#define STMMAC_CHAIN_MODE\t0x1\n#define STMMAC_RING_MODE\t0x2\n\n#define JUMBO_LEN\t\t9000\n\n \n#define STMMAC_RSS_HASH_KEY_SIZE\t40\n#define STMMAC_RSS_MAX_TABLE_SIZE\t256\n\n \n#define STMMAC_VLAN_NONE\t0x0\n#define STMMAC_VLAN_REMOVE\t0x1\n#define STMMAC_VLAN_INSERT\t0x2\n#define STMMAC_VLAN_REPLACE\t0x3\n\nextern const struct stmmac_desc_ops enh_desc_ops;\nextern const struct stmmac_desc_ops ndesc_ops;\n\nstruct mac_device_info;\n\nextern const struct stmmac_hwtimestamp stmmac_ptp;\nextern const struct stmmac_mode_ops dwmac4_ring_mode_ops;\n\nstruct mac_link {\n\tu32 speed_mask;\n\tu32 speed10;\n\tu32 speed100;\n\tu32 speed1000;\n\tu32 speed2500;\n\tu32 duplex;\n\tstruct {\n\t\tu32 speed2500;\n\t\tu32 speed5000;\n\t\tu32 speed10000;\n\t} xgmii;\n\tstruct {\n\t\tu32 speed25000;\n\t\tu32 speed40000;\n\t\tu32 speed50000;\n\t\tu32 speed100000;\n\t} xlgmii;\n};\n\nstruct mii_regs {\n\tunsigned int addr;\t \n\tunsigned int data;\t \n\tunsigned int addr_shift;\t \n\tunsigned int reg_shift;\t\t \n\tunsigned int addr_mask;\t\t \n\tunsigned int reg_mask;\t\t \n\tunsigned int clk_csr_shift;\n\tunsigned int clk_csr_mask;\n};\n\nstruct mac_device_info {\n\tconst struct stmmac_ops *mac;\n\tconst struct stmmac_desc_ops *desc;\n\tconst struct stmmac_dma_ops *dma;\n\tconst struct stmmac_mode_ops *mode;\n\tconst struct stmmac_hwtimestamp *ptp;\n\tconst struct stmmac_tc_ops *tc;\n\tconst struct stmmac_mmc_ops *mmc;\n\tstruct dw_xpcs *xpcs;\n\tstruct phylink_pcs *lynx_pcs;  \n\tstruct mii_regs mii;\t \n\tstruct mac_link link;\n\tvoid __iomem *pcsr;      \n\tunsigned int multicast_filter_bins;\n\tunsigned int unicast_filter_entries;\n\tunsigned int mcast_bits_log2;\n\tunsigned int rx_csum;\n\tunsigned int pcs;\n\tunsigned int pmt;\n\tunsigned int ps;\n\tunsigned int xlgmac;\n\tunsigned int num_vlan;\n\tu32 vlan_filter[32];\n\tbool vlan_fail_q_en;\n\tu8 vlan_fail_q;\n};\n\nstruct stmmac_rx_routing {\n\tu32 reg_mask;\n\tu32 reg_shift;\n};\n\nint dwmac100_setup(struct stmmac_priv *priv);\nint dwmac1000_setup(struct stmmac_priv *priv);\nint dwmac4_setup(struct stmmac_priv *priv);\nint dwxgmac2_setup(struct stmmac_priv *priv);\nint dwxlgmac2_setup(struct stmmac_priv *priv);\n\nvoid stmmac_set_mac_addr(void __iomem *ioaddr, const u8 addr[6],\n\t\t\t unsigned int high, unsigned int low);\nvoid stmmac_get_mac_addr(void __iomem *ioaddr, unsigned char *addr,\n\t\t\t unsigned int high, unsigned int low);\nvoid stmmac_set_mac(void __iomem *ioaddr, bool enable);\n\nvoid stmmac_dwmac4_set_mac_addr(void __iomem *ioaddr, const u8 addr[6],\n\t\t\t\tunsigned int high, unsigned int low);\nvoid stmmac_dwmac4_get_mac_addr(void __iomem *ioaddr, unsigned char *addr,\n\t\t\t\tunsigned int high, unsigned int low);\nvoid stmmac_dwmac4_set_mac(void __iomem *ioaddr, bool enable);\n\nvoid dwmac_dma_flush_tx_fifo(void __iomem *ioaddr);\n\nextern const struct stmmac_mode_ops ring_mode_ops;\nextern const struct stmmac_mode_ops chain_mode_ops;\nextern const struct stmmac_desc_ops dwmac4_desc_ops;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}