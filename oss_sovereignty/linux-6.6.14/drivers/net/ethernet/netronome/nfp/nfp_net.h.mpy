{
  "module_name": "nfp_net.h",
  "hash_id": "f5cd79321c9d0167908e8c67ccab57248f839f6331316b256be6a220f8f31704",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/netronome/nfp/nfp_net.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _NFP_NET_H_\n#define _NFP_NET_H_\n\n#include <linux/atomic.h>\n#include <linux/interrupt.h>\n#include <linux/list.h>\n#include <linux/netdevice.h>\n#include <linux/pci.h>\n#include <linux/dim.h>\n#include <linux/io-64-nonatomic-hi-lo.h>\n#include <linux/semaphore.h>\n#include <linux/workqueue.h>\n#include <net/xdp.h>\n\n#include \"nfp_net_ctrl.h\"\n\n#define nn_pr(nn, lvl, fmt, args...)\t\t\t\t\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tstruct nfp_net *__nn = (nn);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\tif (__nn->dp.netdev)\t\t\t\t\t\\\n\t\t\tnetdev_printk(lvl, __nn->dp.netdev, fmt, ## args); \\\n\t\telse\t\t\t\t\t\t\t\\\n\t\t\tdev_printk(lvl, __nn->dp.dev, \"ctrl: \" fmt, ## args); \\\n\t})\n\n#define nn_err(nn, fmt, args...)\tnn_pr(nn, KERN_ERR, fmt, ## args)\n#define nn_warn(nn, fmt, args...)\tnn_pr(nn, KERN_WARNING, fmt, ## args)\n#define nn_info(nn, fmt, args...)\tnn_pr(nn, KERN_INFO, fmt, ## args)\n#define nn_dbg(nn, fmt, args...)\tnn_pr(nn, KERN_DEBUG, fmt, ## args)\n\n#define nn_dp_warn(dp, fmt, args...)\t\t\t\t\t\\\n\t({\t\t\t\t\t\t\t\t\\\n\t\tstruct nfp_net_dp *__dp = (dp);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\tif (unlikely(net_ratelimit())) {\t\t\t\\\n\t\t\tif (__dp->netdev)\t\t\t\t\\\n\t\t\t\tnetdev_warn(__dp->netdev, fmt, ## args); \\\n\t\t\telse\t\t\t\t\t\t\\\n\t\t\t\tdev_warn(__dp->dev, fmt, ## args);\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t})\n\n \n#define NFP_NET_POLL_TIMEOUT\t5\n\n \n#define NFP_NET_STAT_POLL_IVL\tmsecs_to_jiffies(100)\n\n \n#define NFP_NET_CTRL_BAR\t0\n#define NFP_NET_Q0_BAR\t\t2\n#define NFP_NET_Q1_BAR\t\t4\t \n\n \n#define NFP_NET_DEFAULT_MTU\t\t1500U\n\n \n#define NFP_NET_MAX_PREPEND\t\t64\n\n \n#define NFP_NET_NON_Q_VECTORS\t\t2\n#define NFP_NET_IRQ_LSC_IDX\t\t0\n#define NFP_NET_IRQ_EXN_IDX\t\t1\n#define NFP_NET_MIN_VNIC_IRQS\t\t(NFP_NET_NON_Q_VECTORS + 1)\n\n \n#define NFP_NET_MAX_TX_RINGS\t64\t \n#define NFP_NET_MAX_RX_RINGS\t64\t \n#define NFP_NET_MAX_R_VECS\t(NFP_NET_MAX_TX_RINGS > NFP_NET_MAX_RX_RINGS ? \\\n\t\t\t\t NFP_NET_MAX_TX_RINGS : NFP_NET_MAX_RX_RINGS)\n#define NFP_NET_MAX_IRQS\t(NFP_NET_NON_Q_VECTORS + NFP_NET_MAX_R_VECS)\n\n#define NFP_NET_TX_DESCS_DEFAULT 4096\t \n#define NFP_NET_RX_DESCS_DEFAULT 4096\t \n\n#define NFP_NET_FL_BATCH\t16\t \n#define NFP_NET_XDP_MAX_COMPLETE 2048\t \n\n \n#define NFP_NET_CFG_MAC_MC_MAX\t1024\t \n\n \n#define NFP_NET_N_VXLAN_PORTS\t(NFP_NET_CFG_VXLAN_SZ / sizeof(__be16))\n\n#define NFP_NET_RX_BUF_HEADROOM\t(NET_SKB_PAD + NET_IP_ALIGN)\n#define NFP_NET_RX_BUF_NON_DATA\t(NFP_NET_RX_BUF_HEADROOM +\t\t\\\n\t\t\t\t SKB_DATA_ALIGN(sizeof(struct skb_shared_info)))\n\n \nstruct nfp_cpp;\nstruct nfp_dev_info;\nstruct nfp_dp_ops;\nstruct nfp_eth_table_port;\nstruct nfp_net;\nstruct nfp_net_r_vector;\nstruct nfp_port;\nstruct xsk_buff_pool;\n\nstruct nfp_nfd3_tx_desc;\nstruct nfp_nfd3_tx_buf;\n\nstruct nfp_nfdk_tx_desc;\nstruct nfp_nfdk_tx_buf;\n\n \n#define D_IDX(ring, idx)\t((idx) & ((ring)->cnt - 1))\n\n \n#define nfp_desc_set_dma_addr_40b(desc, dma_addr)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t__typeof__(desc) __d = (desc);\t\t\t\t\\\n\t\tdma_addr_t __addr = (dma_addr);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\t__d->dma_addr_lo = cpu_to_le32(lower_32_bits(__addr));\t\\\n\t\t__d->dma_addr_hi = upper_32_bits(__addr) & 0xff;\t\\\n\t} while (0)\n\n#define nfp_desc_set_dma_addr_48b(desc, dma_addr)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\t__typeof__(desc) __d = (desc);\t\t\t\t\\\n\t\tdma_addr_t __addr = (dma_addr);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\t\t__d->dma_addr_hi = cpu_to_le16(upper_32_bits(__addr));\t\\\n\t\t__d->dma_addr_lo = cpu_to_le32(lower_32_bits(__addr));\t\\\n\t} while (0)\n\n \nstruct nfp_net_tx_ring {\n\tstruct nfp_net_r_vector *r_vec;\n\n\tu16 idx;\n\tu16 data_pending;\n\tu8 __iomem *qcp_q;\n\tu64 *txrwb;\n\n\tu32 cnt;\n\tu32 wr_p;\n\tu32 rd_p;\n\tu32 qcp_rd_p;\n\n\tu32 wr_ptr_add;\n\n\tunion {\n\t\tstruct nfp_nfd3_tx_buf *txbufs;\n\t\tstruct nfp_nfdk_tx_buf *ktxbufs;\n\t};\n\tunion {\n\t\tstruct nfp_nfd3_tx_desc *txds;\n\t\tstruct nfp_nfdk_tx_desc *ktxds;\n\t};\n\n\t \n\tint qcidx;\n\n\tdma_addr_t dma;\n\tsize_t size;\n\tbool is_xdp;\n} ____cacheline_aligned;\n\n \n\n#define PCIE_DESC_RX_DD\t\t\tBIT(7)\n#define PCIE_DESC_RX_META_LEN_MASK\tGENMASK(6, 0)\n\n \n#define PCIE_DESC_RX_RSS\t\tcpu_to_le16(BIT(15))\n#define PCIE_DESC_RX_I_IP4_CSUM\t\tcpu_to_le16(BIT(14))\n#define PCIE_DESC_RX_I_IP4_CSUM_OK\tcpu_to_le16(BIT(13))\n#define PCIE_DESC_RX_I_TCP_CSUM\t\tcpu_to_le16(BIT(12))\n#define PCIE_DESC_RX_I_TCP_CSUM_OK\tcpu_to_le16(BIT(11))\n#define PCIE_DESC_RX_I_UDP_CSUM\t\tcpu_to_le16(BIT(10))\n#define PCIE_DESC_RX_I_UDP_CSUM_OK\tcpu_to_le16(BIT(9))\n#define PCIE_DESC_RX_DECRYPTED\t\tcpu_to_le16(BIT(8))\n#define PCIE_DESC_RX_EOP\t\tcpu_to_le16(BIT(7))\n#define PCIE_DESC_RX_IP4_CSUM\t\tcpu_to_le16(BIT(6))\n#define PCIE_DESC_RX_IP4_CSUM_OK\tcpu_to_le16(BIT(5))\n#define PCIE_DESC_RX_TCP_CSUM\t\tcpu_to_le16(BIT(4))\n#define PCIE_DESC_RX_TCP_CSUM_OK\tcpu_to_le16(BIT(3))\n#define PCIE_DESC_RX_UDP_CSUM\t\tcpu_to_le16(BIT(2))\n#define PCIE_DESC_RX_UDP_CSUM_OK\tcpu_to_le16(BIT(1))\n#define PCIE_DESC_RX_VLAN\t\tcpu_to_le16(BIT(0))\n\n#define PCIE_DESC_RX_CSUM_ALL\t\t(PCIE_DESC_RX_IP4_CSUM |\t\\\n\t\t\t\t\t PCIE_DESC_RX_TCP_CSUM |\t\\\n\t\t\t\t\t PCIE_DESC_RX_UDP_CSUM |\t\\\n\t\t\t\t\t PCIE_DESC_RX_I_IP4_CSUM |\t\\\n\t\t\t\t\t PCIE_DESC_RX_I_TCP_CSUM |\t\\\n\t\t\t\t\t PCIE_DESC_RX_I_UDP_CSUM)\n#define PCIE_DESC_RX_CSUM_OK_SHIFT\t1\n#define __PCIE_DESC_RX_CSUM_ALL\t\tle16_to_cpu(PCIE_DESC_RX_CSUM_ALL)\n#define __PCIE_DESC_RX_CSUM_ALL_OK\t(__PCIE_DESC_RX_CSUM_ALL >>\t\\\n\t\t\t\t\t PCIE_DESC_RX_CSUM_OK_SHIFT)\n\nstruct nfp_net_rx_desc {\n\tunion {\n\t\tstruct {\n\t\t\t__le16 dma_addr_hi;  \n\t\t\tu8 reserved;  \n\t\t\tu8 meta_len_dd;  \n\n\t\t\t__le32 dma_addr_lo;  \n\t\t} __packed fld;\n\n\t\tstruct {\n\t\t\t__le16 data_len;  \n\t\t\tu8 reserved;\n\t\t\tu8 meta_len_dd;\t \n\n\t\t\t__le16 flags;\t \n\t\t\t__le16 vlan;\t \n\t\t} __packed rxd;\n\n\t\t__le32 vals[2];\n\t};\n};\n\n#define NFP_NET_META_FIELD_MASK GENMASK(NFP_NET_META_FIELD_SIZE - 1, 0)\n#define NFP_NET_VLAN_CTAG\t0\n#define NFP_NET_VLAN_STAG\t1\n\nstruct nfp_meta_parsed {\n\tu8 hash_type;\n\tu8 csum_type;\n\tu32 hash;\n\tu32 mark;\n\tu32 portid;\n\t__wsum csum;\n\tstruct {\n\t\tbool stripped;\n\t\tu8 tpid;\n\t\tu16 tci;\n\t} vlan;\n\n#ifdef CONFIG_NFP_NET_IPSEC\n\tu32 ipsec_saidx;\n#endif\n};\n\nstruct nfp_net_rx_hash {\n\t__be32 hash_type;\n\t__be32 hash;\n};\n\n \nstruct nfp_net_rx_buf {\n\tvoid *frag;\n\tdma_addr_t dma_addr;\n};\n\n \nstruct nfp_net_xsk_rx_buf {\n\tdma_addr_t dma_addr;\n\tstruct xdp_buff *xdp;\n};\n\n \nstruct nfp_net_rx_ring {\n\tstruct nfp_net_r_vector *r_vec;\n\n\tu32 cnt;\n\tu32 wr_p;\n\tu32 rd_p;\n\n\tu32 idx;\n\n\tint fl_qcidx;\n\tu8 __iomem *qcp_fl;\n\n\tstruct nfp_net_rx_buf *rxbufs;\n\tstruct nfp_net_xsk_rx_buf *xsk_rxbufs;\n\tstruct nfp_net_rx_desc *rxds;\n\n\tstruct xdp_rxq_info xdp_rxq;\n\n\tdma_addr_t dma;\n\tsize_t size;\n} ____cacheline_aligned;\n\n \nstruct nfp_net_r_vector {\n\tstruct nfp_net *nfp_net;\n\tunion {\n\t\tstruct napi_struct napi;\n\t\tstruct {\n\t\t\tstruct tasklet_struct tasklet;\n\t\t\tstruct sk_buff_head queue;\n\t\t\tspinlock_t lock;\n\t\t};\n\t};\n\n\tstruct nfp_net_tx_ring *tx_ring;\n\tstruct nfp_net_rx_ring *rx_ring;\n\n\tu16 irq_entry;\n\n\tu16 event_ctr;\n\tstruct dim rx_dim;\n\tstruct dim tx_dim;\n\n\tstruct u64_stats_sync rx_sync;\n\tu64 rx_pkts;\n\tu64 rx_bytes;\n\tu64 rx_drops;\n\tu64 hw_csum_rx_ok;\n\tu64 hw_csum_rx_inner_ok;\n\tu64 hw_csum_rx_complete;\n\tu64 hw_tls_rx;\n\n\tu64 hw_csum_rx_error;\n\tu64 rx_replace_buf_alloc_fail;\n\n\tstruct nfp_net_tx_ring *xdp_ring;\n\tstruct xsk_buff_pool *xsk_pool;\n\n\tstruct u64_stats_sync tx_sync;\n\tu64 tx_pkts;\n\tu64 tx_bytes;\n\n\tu64 ____cacheline_aligned_in_smp hw_csum_tx;\n\tu64 hw_csum_tx_inner;\n\tu64 tx_gather;\n\tu64 tx_lso;\n\tu64 hw_tls_tx;\n\n\tu64 tls_tx_fallback;\n\tu64 tls_tx_no_fallback;\n\tu64 tx_errors;\n\tu64 tx_busy;\n\n\t \n\n\tu32 irq_vector;\n\tirq_handler_t handler;\n\tchar name[IFNAMSIZ + 8];\n\tcpumask_t affinity_mask;\n} ____cacheline_aligned;\n\n \nstruct nfp_net_fw_version {\n\tu8 minor;\n\tu8 major;\n\tu8 class;\n\n\t \n\tu8 extend;\n} __packed;\n\nstatic inline bool nfp_net_fw_ver_eq(struct nfp_net_fw_version *fw_ver,\n\t\t\t\t     u8 extend, u8 class, u8 major, u8 minor)\n{\n\treturn fw_ver->extend == extend &&\n\t       fw_ver->class == class &&\n\t       fw_ver->major == major &&\n\t       fw_ver->minor == minor;\n}\n\nstruct nfp_stat_pair {\n\tu64 pkts;\n\tu64 bytes;\n};\n\n \nstruct nfp_net_dp {\n\tstruct device *dev;\n\tstruct net_device *netdev;\n\n\tu8 is_vf:1;\n\tu8 chained_metadata_format:1;\n\tu8 ktls_tx:1;\n\n\tu8 rx_dma_dir;\n\tu8 rx_offset;\n\n\tu32 rx_dma_off;\n\n\tu32 ctrl;\n\tu32 ctrl_w1;\n\tu32 fl_bufsz;\n\n\tstruct bpf_prog *xdp_prog;\n\n\tstruct nfp_net_tx_ring *tx_rings;\n\tstruct nfp_net_rx_ring *rx_rings;\n\n\tu8 __iomem *ctrl_bar;\n\n\t \n\n\tconst struct nfp_dp_ops *ops;\n\n\tu64 *txrwb;\n\tdma_addr_t txrwb_dma;\n\n\tunsigned int txd_cnt;\n\tunsigned int rxd_cnt;\n\n\tunsigned int num_r_vecs;\n\n\tunsigned int num_tx_rings;\n\tunsigned int num_stack_tx_rings;\n\tunsigned int num_rx_rings;\n\n\tunsigned int mtu;\n\n\tstruct xsk_buff_pool **xsk_pools;\n};\n\n \nstruct nfp_net {\n\tstruct nfp_net_dp dp;\n\n\tconst struct nfp_dev_info *dev_info;\n\tstruct nfp_net_fw_version fw_ver;\n\n\tu32 id;\n\n\tu32 cap;\n\tu32 cap_w1;\n\tu32 max_mtu;\n\n\tu8 rss_hfunc;\n\tu32 rss_cfg;\n\tu8 rss_key[NFP_NET_CFG_RSS_KEY_SZ];\n\tu8 rss_itbl[NFP_NET_CFG_RSS_ITBL_SZ];\n\n\tstruct xdp_attachment_info xdp;\n\tstruct xdp_attachment_info xdp_hw;\n\n\tunsigned int max_tx_rings;\n\tunsigned int max_rx_rings;\n\n\tint stride_tx;\n\tint stride_rx;\n\n\tunsigned int max_r_vecs;\n\tstruct nfp_net_r_vector r_vecs[NFP_NET_MAX_R_VECS];\n\tstruct msix_entry irq_entries[NFP_NET_MAX_IRQS];\n\n\tirq_handler_t lsc_handler;\n\tchar lsc_name[IFNAMSIZ + 8];\n\n\tirq_handler_t exn_handler;\n\tchar exn_name[IFNAMSIZ + 8];\n\n\tirq_handler_t shared_handler;\n\tchar shared_name[IFNAMSIZ + 8];\n\n\tbool link_up;\n\tspinlock_t link_status_lock;\n\n\tspinlock_t reconfig_lock;\n\tu32 reconfig_posted;\n\tbool reconfig_timer_active;\n\tbool reconfig_sync_present;\n\tstruct timer_list reconfig_timer;\n\tu32 reconfig_in_progress_update;\n\n\tstruct semaphore bar_lock;\n\n\tbool rx_coalesce_adapt_on;\n\tbool tx_coalesce_adapt_on;\n\tu32 rx_coalesce_usecs;\n\tu32 rx_coalesce_max_frames;\n\tu32 tx_coalesce_usecs;\n\tu32 tx_coalesce_max_frames;\n\n\tu8 __iomem *qcp_cfg;\n\n\tu8 __iomem *tx_bar;\n\tu8 __iomem *rx_bar;\n\n#ifdef CONFIG_NFP_NET_IPSEC\n\tstruct xarray xa_ipsec;\n#endif\n\n\tstruct nfp_net_tlv_caps tlv_caps;\n\n\tunsigned int ktls_tx_conn_cnt;\n\tunsigned int ktls_rx_conn_cnt;\n\n\tatomic64_t ktls_conn_id_gen;\n\n\tatomic_t ktls_no_space;\n\tatomic_t ktls_rx_resync_req;\n\tatomic_t ktls_rx_resync_ign;\n\tatomic_t ktls_rx_resync_sent;\n\n\tstruct {\n\t\tstruct sk_buff_head queue;\n\t\twait_queue_head_t wq;\n\t\tstruct workqueue_struct *workq;\n\t\tstruct work_struct wait_work;\n\t\tstruct work_struct runq_work;\n\t\tu16 tag;\n\t} mbox_cmsg;\n\n\tstruct dentry *debugfs_dir;\n\n\tstruct list_head vnic_list;\n\n\tstruct pci_dev *pdev;\n\tstruct nfp_app *app;\n\n\tbool vnic_no_name;\n\n\tstruct nfp_port *port;\n\n\tstruct {\n\t\tspinlock_t lock;\n\t\tstruct list_head list;\n\t\tstruct work_struct work;\n\t} mbox_amsg;\n\n\tvoid *app_priv;\n};\n\nstruct nfp_mbox_amsg_entry {\n\tstruct list_head list;\n\tint (*cfg)(struct nfp_net *nn, struct nfp_mbox_amsg_entry *entry);\n\tu32 cmd;\n\tchar msg[];\n};\n\nint nfp_net_sched_mbox_amsg_work(struct nfp_net *nn, u32 cmd, const void *data, size_t len,\n\t\t\t\t int (*cb)(struct nfp_net *, struct nfp_mbox_amsg_entry *));\n\n \nstatic inline u16 nn_readb(struct nfp_net *nn, int off)\n{\n\treturn readb(nn->dp.ctrl_bar + off);\n}\n\nstatic inline void nn_writeb(struct nfp_net *nn, int off, u8 val)\n{\n\twriteb(val, nn->dp.ctrl_bar + off);\n}\n\nstatic inline u16 nn_readw(struct nfp_net *nn, int off)\n{\n\treturn readw(nn->dp.ctrl_bar + off);\n}\n\nstatic inline void nn_writew(struct nfp_net *nn, int off, u16 val)\n{\n\twritew(val, nn->dp.ctrl_bar + off);\n}\n\nstatic inline u32 nn_readl(struct nfp_net *nn, int off)\n{\n\treturn readl(nn->dp.ctrl_bar + off);\n}\n\nstatic inline void nn_writel(struct nfp_net *nn, int off, u32 val)\n{\n\twritel(val, nn->dp.ctrl_bar + off);\n}\n\nstatic inline u64 nn_readq(struct nfp_net *nn, int off)\n{\n\treturn readq(nn->dp.ctrl_bar + off);\n}\n\nstatic inline void nn_writeq(struct nfp_net *nn, int off, u64 val)\n{\n\twriteq(val, nn->dp.ctrl_bar + off);\n}\n\n \nstatic inline void nn_pci_flush(struct nfp_net *nn)\n{\n\tnn_readl(nn, NFP_NET_CFG_VERSION);\n}\n\n \n#define NFP_QCP_QUEUE_ADDR_SZ\t\t\t0x800\n#define NFP_QCP_QUEUE_OFF(_x)\t\t\t((_x) * NFP_QCP_QUEUE_ADDR_SZ)\n#define NFP_QCP_QUEUE_ADD_RPTR\t\t\t0x0000\n#define NFP_QCP_QUEUE_ADD_WPTR\t\t\t0x0004\n#define NFP_QCP_QUEUE_STS_LO\t\t\t0x0008\n#define NFP_QCP_QUEUE_STS_LO_READPTR_mask\t0x3ffff\n#define NFP_QCP_QUEUE_STS_HI\t\t\t0x000c\n#define NFP_QCP_QUEUE_STS_HI_WRITEPTR_mask\t0x3ffff\n\n \nenum nfp_qcp_ptr {\n\tNFP_QCP_READ_PTR = 0,\n\tNFP_QCP_WRITE_PTR\n};\n\n \nstatic inline void nfp_qcp_rd_ptr_add(u8 __iomem *q, u32 val)\n{\n\twritel(val, q + NFP_QCP_QUEUE_ADD_RPTR);\n}\n\n \nstatic inline void nfp_qcp_wr_ptr_add(u8 __iomem *q, u32 val)\n{\n\twritel(val, q + NFP_QCP_QUEUE_ADD_WPTR);\n}\n\nstatic inline u32 _nfp_qcp_read(u8 __iomem *q, enum nfp_qcp_ptr ptr)\n{\n\tu32 off;\n\tu32 val;\n\n\tif (ptr == NFP_QCP_READ_PTR)\n\t\toff = NFP_QCP_QUEUE_STS_LO;\n\telse\n\t\toff = NFP_QCP_QUEUE_STS_HI;\n\n\tval = readl(q + off);\n\n\tif (ptr == NFP_QCP_READ_PTR)\n\t\treturn val & NFP_QCP_QUEUE_STS_LO_READPTR_mask;\n\telse\n\t\treturn val & NFP_QCP_QUEUE_STS_HI_WRITEPTR_mask;\n}\n\n \nstatic inline u32 nfp_qcp_rd_ptr_read(u8 __iomem *q)\n{\n\treturn _nfp_qcp_read(q, NFP_QCP_READ_PTR);\n}\n\n \nstatic inline u32 nfp_qcp_wr_ptr_read(u8 __iomem *q)\n{\n\treturn _nfp_qcp_read(q, NFP_QCP_WRITE_PTR);\n}\n\nu32 nfp_qcp_queue_offset(const struct nfp_dev_info *dev_info, u16 queue);\n\nstatic inline bool nfp_net_is_data_vnic(struct nfp_net *nn)\n{\n\tWARN_ON_ONCE(!nn->dp.netdev && nn->port);\n\treturn !!nn->dp.netdev;\n}\n\nstatic inline bool nfp_net_running(struct nfp_net *nn)\n{\n\treturn nn->dp.ctrl & NFP_NET_CFG_CTRL_ENABLE;\n}\n\nstatic inline const char *nfp_net_name(struct nfp_net *nn)\n{\n\treturn nn->dp.netdev ? nn->dp.netdev->name : \"ctrl\";\n}\n\nstatic inline void nfp_ctrl_lock(struct nfp_net *nn)\n\t__acquires(&nn->r_vecs[0].lock)\n{\n\tspin_lock_bh(&nn->r_vecs[0].lock);\n}\n\nstatic inline void nfp_ctrl_unlock(struct nfp_net *nn)\n\t__releases(&nn->r_vecs[0].lock)\n{\n\tspin_unlock_bh(&nn->r_vecs[0].lock);\n}\n\nstatic inline void nn_ctrl_bar_lock(struct nfp_net *nn)\n{\n\tdown(&nn->bar_lock);\n}\n\nstatic inline bool nn_ctrl_bar_trylock(struct nfp_net *nn)\n{\n\treturn !down_trylock(&nn->bar_lock);\n}\n\nstatic inline void nn_ctrl_bar_unlock(struct nfp_net *nn)\n{\n\tup(&nn->bar_lock);\n}\n\n \nextern const char nfp_driver_version[];\n\nextern const struct net_device_ops nfp_nfd3_netdev_ops;\nextern const struct net_device_ops nfp_nfdk_netdev_ops;\n\nstatic inline bool nfp_netdev_is_nfp_net(struct net_device *netdev)\n{\n\treturn netdev->netdev_ops == &nfp_nfd3_netdev_ops ||\n\t       netdev->netdev_ops == &nfp_nfdk_netdev_ops;\n}\n\nstatic inline int nfp_net_coalesce_para_check(u32 usecs, u32 pkts)\n{\n\tif ((usecs >= ((1 << 16) - 1)) || (pkts >= ((1 << 16) - 1)))\n\t\treturn -EINVAL;\n\n\treturn 0;\n}\n\n \nvoid nfp_net_get_fw_version(struct nfp_net_fw_version *fw_ver,\n\t\t\t    void __iomem *ctrl_bar);\n\nstruct nfp_net *\nnfp_net_alloc(struct pci_dev *pdev, const struct nfp_dev_info *dev_info,\n\t      void __iomem *ctrl_bar, bool needs_netdev,\n\t      unsigned int max_tx_rings, unsigned int max_rx_rings);\nvoid nfp_net_free(struct nfp_net *nn);\n\nint nfp_net_init(struct nfp_net *nn);\nvoid nfp_net_clean(struct nfp_net *nn);\n\nint nfp_ctrl_open(struct nfp_net *nn);\nvoid nfp_ctrl_close(struct nfp_net *nn);\n\nvoid nfp_net_set_ethtool_ops(struct net_device *netdev);\nvoid nfp_net_info(struct nfp_net *nn);\nint __nfp_net_reconfig(struct nfp_net *nn, u32 update);\nint nfp_net_reconfig(struct nfp_net *nn, u32 update);\nunsigned int nfp_net_rss_key_sz(struct nfp_net *nn);\nvoid nfp_net_rss_write_itbl(struct nfp_net *nn);\nvoid nfp_net_rss_write_key(struct nfp_net *nn);\nvoid nfp_net_coalesce_write_cfg(struct nfp_net *nn);\nint nfp_net_mbox_lock(struct nfp_net *nn, unsigned int data_size);\nint nfp_net_mbox_reconfig(struct nfp_net *nn, u32 mbox_cmd);\nint nfp_net_mbox_reconfig_and_unlock(struct nfp_net *nn, u32 mbox_cmd);\nvoid nfp_net_mbox_reconfig_post(struct nfp_net *nn, u32 update);\nint nfp_net_mbox_reconfig_wait_posted(struct nfp_net *nn);\n\nunsigned int\nnfp_net_irqs_alloc(struct pci_dev *pdev, struct msix_entry *irq_entries,\n\t\t   unsigned int min_irqs, unsigned int want_irqs);\nvoid nfp_net_irqs_disable(struct pci_dev *pdev);\nvoid\nnfp_net_irqs_assign(struct nfp_net *nn, struct msix_entry *irq_entries,\n\t\t    unsigned int n);\nstruct sk_buff *\nnfp_net_tls_tx(struct nfp_net_dp *dp, struct nfp_net_r_vector *r_vec,\n\t       struct sk_buff *skb, u64 *tls_handle, int *nr_frags);\nvoid nfp_net_tls_tx_undo(struct sk_buff *skb, u64 tls_handle);\n\nstruct nfp_net_dp *nfp_net_clone_dp(struct nfp_net *nn);\nint nfp_net_ring_reconfig(struct nfp_net *nn, struct nfp_net_dp *new,\n\t\t\t  struct netlink_ext_ack *extack);\n\n#ifdef CONFIG_NFP_DEBUG\nvoid nfp_net_debugfs_create(void);\nvoid nfp_net_debugfs_destroy(void);\nstruct dentry *nfp_net_debugfs_device_add(struct pci_dev *pdev);\nvoid nfp_net_debugfs_vnic_add(struct nfp_net *nn, struct dentry *ddir);\nvoid nfp_net_debugfs_dir_clean(struct dentry **dir);\n#else\nstatic inline void nfp_net_debugfs_create(void)\n{\n}\n\nstatic inline void nfp_net_debugfs_destroy(void)\n{\n}\n\nstatic inline struct dentry *nfp_net_debugfs_device_add(struct pci_dev *pdev)\n{\n\treturn NULL;\n}\n\nstatic inline void\nnfp_net_debugfs_vnic_add(struct nfp_net *nn, struct dentry *ddir)\n{\n}\n\nstatic inline void nfp_net_debugfs_dir_clean(struct dentry **dir)\n{\n}\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}