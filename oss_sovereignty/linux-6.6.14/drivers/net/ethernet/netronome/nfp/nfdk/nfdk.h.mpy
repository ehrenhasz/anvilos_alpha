{
  "module_name": "nfdk.h",
  "hash_id": "61005448ae2c4eca3ae9b4a2d98f75ec2623978ceca3ec0749c81ce990d140f8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/netronome/nfp/nfdk/nfdk.h",
  "human_readable_source": " \n \n\n#ifndef _NFP_DP_NFDK_H_\n#define _NFP_DP_NFDK_H_\n\n#include <linux/bitops.h>\n#include <linux/types.h>\n\n#define NFDK_TX_DESC_PER_SIMPLE_PKT\t2\n\n#define NFDK_TX_MAX_DATA_PER_HEAD\tSZ_4K\n#define NFDK_TX_MAX_DATA_PER_DESC\tSZ_16K\n#define NFDK_TX_DESC_BLOCK_SZ\t\t256\n#define NFDK_TX_DESC_BLOCK_CNT\t\t(NFDK_TX_DESC_BLOCK_SZ /\t\\\n\t\t\t\t\t sizeof(struct nfp_nfdk_tx_desc))\n#define NFDK_TX_DESC_STOP_CNT\t\t(NFDK_TX_DESC_BLOCK_CNT *\t\\\n\t\t\t\t\t NFDK_TX_DESC_PER_SIMPLE_PKT)\n#define NFDK_TX_MAX_DATA_PER_BLOCK\tSZ_64K\n#define NFDK_TX_DESC_GATHER_MAX\t\t17\n\n \n\n#define NFDK_DESC_TX_MSS_MASK\t\tGENMASK(13, 0)\n\n#define NFDK_DESC_TX_CHAIN_META\t\tBIT(3)\n#define NFDK_DESC_TX_ENCAP\t\tBIT(2)\n#define NFDK_DESC_TX_L4_CSUM\t\tBIT(1)\n#define NFDK_DESC_TX_L3_CSUM\t\tBIT(0)\n\n#define NFDK_DESC_TX_DMA_LEN_HEAD\tGENMASK(11, 0)\n#define NFDK_DESC_TX_TYPE_HEAD\t\tGENMASK(15, 12)\n#define NFDK_DESC_TX_DMA_LEN\t\tGENMASK(13, 0)\n#define NFDK_DESC_TX_TYPE_NOP\t\t0\n#define NFDK_DESC_TX_TYPE_GATHER\t1\n#define NFDK_DESC_TX_TYPE_TSO\t\t2\n#define NFDK_DESC_TX_TYPE_SIMPLE\t8\n#define NFDK_DESC_TX_EOP\t\tBIT(14)\n\n#define NFDK_META_LEN\t\t\tGENMASK(7, 0)\n#define NFDK_META_FIELDS\t\tGENMASK(31, 8)\n\n#define D_BLOCK_CPL(idx)\t\t(NFDK_TX_DESC_BLOCK_CNT -\t\\\n\t\t\t\t\t (idx) % NFDK_TX_DESC_BLOCK_CNT)\n\nstruct nfp_nfdk_tx_desc {\n\tunion {\n\t\tstruct {\n\t\t\t__le16 dma_addr_hi;   \n\t\t\t__le16 dma_len_type;  \n\t\t\t__le32 dma_addr_lo;   \n\t\t};\n\n\t\tstruct {\n\t\t\t__le16 mss;\t \n\t\t\tu8 lso_hdrlen;   \n\t\t\tu8 lso_totsegs;  \n\t\t\tu8 l3_offset;    \n\t\t\tu8 l4_offset;    \n\t\t\t__le16 lso_meta_res;  \n\t\t};\n\n\t\tstruct {\n\t\t\tu8 flags;\t \n\t\t\tu8 reserved[7];\t \n\t\t};\n\n\t\t__le32 vals[2];\n\t\t__le64 raw;\n\t};\n};\n\n \n#define NFDK_TX_BUF_PTR(val) ((val) & ~(sizeof(void *) - 1))\n#define NFDK_TX_BUF_INFO(val) ((val) & (sizeof(void *) - 1))\n#define NFDK_TX_BUF_INFO_SOP BIT(0)\n\nstruct nfp_nfdk_tx_buf {\n\tunion {\n\t\t \n\t\tunion {\n\t\t\tstruct sk_buff *skb;\n\t\t\tvoid *frag;\n\t\t\tunsigned long val;\n\t\t};\n\n\t\t \n\t\tdma_addr_t dma_addr;\n\n\t\t \n\t\tstruct {\n\t\t\tu32 pkt_cnt;\n\t\t\tu32 real_len;\n\t\t};\n\n\t\tu64 raw;\n\t};\n};\n\nstatic inline int nfp_nfdk_headlen_to_segs(unsigned int headlen)\n{\n\t \n\treturn DIV_ROUND_UP(headlen +\n\t\t\t    NFDK_TX_MAX_DATA_PER_DESC -\n\t\t\t    NFDK_TX_MAX_DATA_PER_HEAD,\n\t\t\t    NFDK_TX_MAX_DATA_PER_DESC);\n}\n\nint nfp_nfdk_poll(struct napi_struct *napi, int budget);\nnetdev_tx_t nfp_nfdk_tx(struct sk_buff *skb, struct net_device *netdev);\nbool\nnfp_nfdk_ctrl_tx_one(struct nfp_net *nn, struct nfp_net_r_vector *r_vec,\n\t\t     struct sk_buff *skb, bool old);\nvoid nfp_nfdk_ctrl_poll(struct tasklet_struct *t);\nvoid nfp_nfdk_rx_ring_fill_freelist(struct nfp_net_dp *dp,\n\t\t\t\t    struct nfp_net_rx_ring *rx_ring);\n#ifndef CONFIG_NFP_NET_IPSEC\nstatic inline u64 nfp_nfdk_ipsec_tx(u64 flags, struct sk_buff *skb)\n{\n\treturn flags;\n}\n#else\nu64 nfp_nfdk_ipsec_tx(u64 flags, struct sk_buff *skb);\n#endif\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}