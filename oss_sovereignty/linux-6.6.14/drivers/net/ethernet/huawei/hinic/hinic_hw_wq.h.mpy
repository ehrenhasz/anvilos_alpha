{
  "module_name": "hinic_hw_wq.h",
  "hash_id": "ba3045056f9482c5bbbdc9dff4cec035951f7a9839659b0c73ca09d0c8e456d1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/huawei/hinic/hinic_hw_wq.h",
  "human_readable_source": " \n \n\n#ifndef HINIC_HW_WQ_H\n#define HINIC_HW_WQ_H\n\n#include <linux/types.h>\n#include <linux/semaphore.h>\n#include <linux/atomic.h>\n\n#include \"hinic_hw_if.h\"\n#include \"hinic_hw_wqe.h\"\n\nstruct hinic_free_block {\n\tint     page_idx;\n\tint     block_idx;\n};\n\nstruct hinic_wq {\n\tstruct hinic_hwif       *hwif;\n\n\tint             page_idx;\n\tint             block_idx;\n\n\tu16             wqebb_size;\n\tu32             wq_page_size;\n\tu16             q_depth;\n\tu16             max_wqe_size;\n\tu16             num_wqebbs_per_page;\n\tu16\t\twqebbs_per_page_shift;\n\tu16\t\twqebb_size_shift;\n\t \n\tu64             block_paddr;\n\tvoid            **shadow_block_vaddr;\n\tu64             *block_vaddr;\n\n\tint             num_q_pages;\n\tu8              *shadow_wqe;\n\tu16             *shadow_idx;\n\n\tatomic_t        cons_idx;\n\tatomic_t        prod_idx;\n\tatomic_t        delta;\n\tu16             mask;\n};\n\nstruct hinic_wqs {\n\tstruct hinic_hwif       *hwif;\n\tint                     num_pages;\n\n\t \n\tu64                     *page_paddr;\n\tu64                     **page_vaddr;\n\tvoid                    ***shadow_page_vaddr;\n\n\tstruct hinic_free_block *free_blocks;\n\tint                     alloc_blk_pos;\n\tint                     return_blk_pos;\n\tint                     num_free_blks;\n\n\t \n\tstruct semaphore        alloc_blocks_lock;\n};\n\nstruct hinic_cmdq_pages {\n\t \n\tu64                     page_paddr;\n\tu64                     *page_vaddr;\n\tvoid                    **shadow_page_vaddr;\n\n\tstruct hinic_hwif       *hwif;\n};\n\nint hinic_wqs_cmdq_alloc(struct hinic_cmdq_pages *cmdq_pages,\n\t\t\t struct hinic_wq *wq, struct hinic_hwif *hwif,\n\t\t\t int cmdq_blocks, u16 wqebb_size, u32 wq_page_size,\n\t\t\t u16 q_depth, u16 max_wqe_size);\n\nvoid hinic_wqs_cmdq_free(struct hinic_cmdq_pages *cmdq_pages,\n\t\t\t struct hinic_wq *wq, int cmdq_blocks);\n\nint hinic_wqs_alloc(struct hinic_wqs *wqs, int num_wqs,\n\t\t    struct hinic_hwif *hwif);\n\nvoid hinic_wqs_free(struct hinic_wqs *wqs);\n\nint hinic_wq_allocate(struct hinic_wqs *wqs, struct hinic_wq *wq,\n\t\t      u16 wqebb_size, u32 wq_page_size, u16 q_depth,\n\t\t      u16 max_wqe_size);\n\nvoid hinic_wq_free(struct hinic_wqs *wqs, struct hinic_wq *wq);\n\nstruct hinic_hw_wqe *hinic_get_wqe(struct hinic_wq *wq, unsigned int wqe_size,\n\t\t\t\t   u16 *prod_idx);\n\nvoid hinic_return_wqe(struct hinic_wq *wq, unsigned int wqe_size);\n\nvoid hinic_put_wqe(struct hinic_wq *wq, unsigned int wqe_size);\n\nstruct hinic_hw_wqe *hinic_read_wqe(struct hinic_wq *wq, unsigned int wqe_size,\n\t\t\t\t    u16 *cons_idx);\n\nstruct hinic_hw_wqe *hinic_read_wqe_direct(struct hinic_wq *wq, u16 cons_idx);\n\nvoid hinic_write_wqe(struct hinic_wq *wq, struct hinic_hw_wqe *wqe,\n\t\t     unsigned int wqe_size);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}