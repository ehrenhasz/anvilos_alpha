{
  "module_name": "hinic_hw_if.h",
  "hash_id": "a8b7d8217f2fb78f143eb6cd4dc4a426fe40b083ea281d0ed299ad1332fc4579",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/huawei/hinic/hinic_hw_if.h",
  "human_readable_source": " \n \n\n#ifndef HINIC_HW_IF_H\n#define HINIC_HW_IF_H\n\n#include <linux/pci.h>\n#include <linux/io.h>\n#include <linux/types.h>\n#include <asm/byteorder.h>\n\n#define HINIC_PCIE_LINK_DOWN\t\t\t\t\t0xFFFFFFFF\n\n#define HINIC_DMA_ATTR_ST_SHIFT                                 0\n#define HINIC_DMA_ATTR_AT_SHIFT                                 8\n#define HINIC_DMA_ATTR_PH_SHIFT                                 10\n#define HINIC_DMA_ATTR_NO_SNOOPING_SHIFT                        12\n#define HINIC_DMA_ATTR_TPH_EN_SHIFT                             13\n\n#define HINIC_DMA_ATTR_ST_MASK                                  0xFF\n#define HINIC_DMA_ATTR_AT_MASK                                  0x3\n#define HINIC_DMA_ATTR_PH_MASK                                  0x3\n#define HINIC_DMA_ATTR_NO_SNOOPING_MASK                         0x1\n#define HINIC_DMA_ATTR_TPH_EN_MASK                              0x1\n\n#define HINIC_DMA_ATTR_SET(val, member)                         \\\n\t(((u32)(val) & HINIC_DMA_ATTR_##member##_MASK) <<       \\\n\t HINIC_DMA_ATTR_##member##_SHIFT)\n\n#define HINIC_DMA_ATTR_CLEAR(val, member)                       \\\n\t((val) & (~(HINIC_DMA_ATTR_##member##_MASK              \\\n\t << HINIC_DMA_ATTR_##member##_SHIFT)))\n\n#define HINIC_FA0_FUNC_IDX_SHIFT                                0\n#define HINIC_FA0_PF_IDX_SHIFT                                  10\n#define HINIC_FA0_PCI_INTF_IDX_SHIFT                            14\n#define HINIC_FA0_VF_IN_PF_SHIFT\t\t\t\t16\n \n#define HINIC_FA0_FUNC_TYPE_SHIFT                               24\n\n#define HINIC_FA0_FUNC_IDX_MASK                                 0x3FF\n#define HINIC_FA0_PF_IDX_MASK                                   0xF\n#define HINIC_FA0_PCI_INTF_IDX_MASK                             0x3\n#define HINIC_FA0_FUNC_TYPE_MASK                                0x1\n#define HINIC_FA0_VF_IN_PF_MASK\t\t\t\t\t0xFF\n\n#define HINIC_FA0_GET(val, member)                              \\\n\t(((val) >> HINIC_FA0_##member##_SHIFT) & HINIC_FA0_##member##_MASK)\n\n#define HINIC_FA1_AEQS_PER_FUNC_SHIFT                           8\n \n#define HINIC_FA1_CEQS_PER_FUNC_SHIFT                           12\n \n#define HINIC_FA1_IRQS_PER_FUNC_SHIFT                           20\n#define HINIC_FA1_DMA_ATTR_PER_FUNC_SHIFT                       24\n \n#define HINIC_FA1_MGMT_INIT_STATUS_SHIFT\t\t\t30\n#define HINIC_FA1_PF_INIT_STATUS_SHIFT\t\t\t\t31\n\n#define HINIC_FA1_AEQS_PER_FUNC_MASK                            0x3\n#define HINIC_FA1_CEQS_PER_FUNC_MASK                            0x7\n#define HINIC_FA1_IRQS_PER_FUNC_MASK                            0xF\n#define HINIC_FA1_DMA_ATTR_PER_FUNC_MASK                        0x7\n#define HINIC_FA1_MGMT_INIT_STATUS_MASK                         0x1\n#define HINIC_FA1_PF_INIT_STATUS_MASK\t\t\t\t0x1\n\n#define HINIC_FA1_GET(val, member)                              \\\n\t(((val) >> HINIC_FA1_##member##_SHIFT) & HINIC_FA1_##member##_MASK)\n\n#define HINIC_FA2_GLOBAL_VF_ID_OF_PF_SHIFT\t16\n#define HINIC_FA2_GLOBAL_VF_ID_OF_PF_MASK\t0x3FF\n\n#define HINIC_FA2_GET(val, member)\t\t\t\t\\\n\t(((val) >> HINIC_FA2_##member##_SHIFT) & HINIC_FA2_##member##_MASK)\n\n#define HINIC_FA4_OUTBOUND_STATE_SHIFT                          0\n#define HINIC_FA4_DB_STATE_SHIFT                                1\n\n#define HINIC_FA4_OUTBOUND_STATE_MASK                           0x1\n#define HINIC_FA4_DB_STATE_MASK                                 0x1\n\n#define HINIC_FA4_GET(val, member)                              \\\n\t(((val) >> HINIC_FA4_##member##_SHIFT) & HINIC_FA4_##member##_MASK)\n\n#define HINIC_FA4_SET(val, member)                              \\\n\t((((u32)val) & HINIC_FA4_##member##_MASK) << HINIC_FA4_##member##_SHIFT)\n\n#define HINIC_FA4_CLEAR(val, member)                            \\\n\t((val) & (~(HINIC_FA4_##member##_MASK << HINIC_FA4_##member##_SHIFT)))\n\n#define HINIC_FA5_PF_ACTION_SHIFT                               0\n#define HINIC_FA5_PF_ACTION_MASK                                0xFFFF\n\n#define HINIC_FA5_SET(val, member)                              \\\n\t(((u32)(val) & HINIC_FA5_##member##_MASK) << HINIC_FA5_##member##_SHIFT)\n\n#define HINIC_FA5_CLEAR(val, member)                            \\\n\t((val) & (~(HINIC_FA5_##member##_MASK << HINIC_FA5_##member##_SHIFT)))\n\n#define HINIC_PPF_ELECTION_IDX_SHIFT                            0\n#define HINIC_PPF_ELECTION_IDX_MASK                             0x1F\n\n#define HINIC_PPF_ELECTION_SET(val, member)                     \\\n\t(((u32)(val) & HINIC_PPF_ELECTION_##member##_MASK) <<   \\\n\t HINIC_PPF_ELECTION_##member##_SHIFT)\n\n#define HINIC_PPF_ELECTION_GET(val, member)                     \\\n\t(((val) >> HINIC_PPF_ELECTION_##member##_SHIFT) &       \\\n\t HINIC_PPF_ELECTION_##member##_MASK)\n\n#define HINIC_PPF_ELECTION_CLEAR(val, member)                   \\\n\t((val) & (~(HINIC_PPF_ELECTION_##member##_MASK          \\\n\t << HINIC_PPF_ELECTION_##member##_SHIFT)))\n\n#define HINIC_MSIX_PENDING_LIMIT_SHIFT                          0\n#define HINIC_MSIX_COALESC_TIMER_SHIFT                          8\n#define HINIC_MSIX_LLI_TIMER_SHIFT                              16\n#define HINIC_MSIX_LLI_CREDIT_SHIFT                             24\n#define HINIC_MSIX_RESEND_TIMER_SHIFT                           29\n\n#define HINIC_MSIX_PENDING_LIMIT_MASK                           0xFF\n#define HINIC_MSIX_COALESC_TIMER_MASK                           0xFF\n#define HINIC_MSIX_LLI_TIMER_MASK                               0xFF\n#define HINIC_MSIX_LLI_CREDIT_MASK                              0x1F\n#define HINIC_MSIX_RESEND_TIMER_MASK                            0x7\n\n#define HINIC_MSIX_ATTR_SET(val, member)                        \\\n\t(((u32)(val) & HINIC_MSIX_##member##_MASK) <<           \\\n\t HINIC_MSIX_##member##_SHIFT)\n\n#define HINIC_MSIX_CNT_RESEND_TIMER_SHIFT                       29\n\n#define HINIC_MSIX_CNT_RESEND_TIMER_MASK                        0x1\n\n#define HINIC_MSIX_CNT_SET(val, member)                         \\\n\t(((u32)(val) & HINIC_MSIX_CNT_##member##_MASK) <<       \\\n\t HINIC_MSIX_CNT_##member##_SHIFT)\n\n#define HINIC_HWIF_NUM_AEQS(hwif)       ((hwif)->attr.num_aeqs)\n#define HINIC_HWIF_NUM_CEQS(hwif)       ((hwif)->attr.num_ceqs)\n#define HINIC_HWIF_NUM_IRQS(hwif)       ((hwif)->attr.num_irqs)\n#define HINIC_HWIF_FUNC_IDX(hwif)       ((hwif)->attr.func_idx)\n#define HINIC_HWIF_PCI_INTF(hwif)       ((hwif)->attr.pci_intf_idx)\n#define HINIC_HWIF_PF_IDX(hwif)         ((hwif)->attr.pf_idx)\n#define HINIC_HWIF_PPF_IDX(hwif)        ((hwif)->attr.ppf_idx)\n\n#define HINIC_FUNC_TYPE(hwif)           ((hwif)->attr.func_type)\n#define HINIC_IS_VF(hwif)               (HINIC_FUNC_TYPE(hwif) == HINIC_VF)\n#define HINIC_IS_PF(hwif)               (HINIC_FUNC_TYPE(hwif) == HINIC_PF)\n#define HINIC_IS_PPF(hwif)              (HINIC_FUNC_TYPE(hwif) == HINIC_PPF)\n\n#define HINIC_PCI_CFG_REGS_BAR          0\n#define HINIC_PCI_INTR_REGS_BAR         2\n#define HINIC_PCI_DB_BAR                4\n\n#define HINIC_PCIE_ST_DISABLE           0\n#define HINIC_PCIE_AT_DISABLE           0\n#define HINIC_PCIE_PH_DISABLE           0\n\n#define HINIC_EQ_MSIX_PENDING_LIMIT_DEFAULT     0        \n#define HINIC_EQ_MSIX_COALESC_TIMER_DEFAULT     0xFF     \n#define HINIC_EQ_MSIX_LLI_TIMER_DEFAULT         0        \n#define HINIC_EQ_MSIX_LLI_CREDIT_LIMIT_DEFAULT  0        \n#define HINIC_EQ_MSIX_RESEND_TIMER_DEFAULT      7        \n\n#define HINIC_PCI_MSIX_ENTRY_SIZE               16\n#define HINIC_PCI_MSIX_ENTRY_VECTOR_CTRL        12\n#define HINIC_PCI_MSIX_ENTRY_CTRL_MASKBIT       1\n\nenum hinic_pcie_nosnoop {\n\tHINIC_PCIE_SNOOP        = 0,\n\tHINIC_PCIE_NO_SNOOP     = 1,\n};\n\nenum hinic_pcie_tph {\n\tHINIC_PCIE_TPH_DISABLE  = 0,\n\tHINIC_PCIE_TPH_ENABLE   = 1,\n};\n\nenum hinic_func_type {\n\tHINIC_PF        = 0,\n\tHINIC_VF\t    = 1,\n\tHINIC_PPF       = 2,\n};\n\nenum hinic_mod_type {\n\tHINIC_MOD_COMM  = 0,     \n\tHINIC_MOD_L2NIC = 1,     \n\tHINIC_MOD_CFGM  = 7,     \n\tHINIC_MOD_HILINK = 14,   \n\tHINIC_MOD_MAX   = 15\n};\n\nenum hinic_node_id {\n\tHINIC_NODE_ID_MGMT = 21,\n};\n\nenum hinic_pf_action {\n\tHINIC_PF_MGMT_INIT = 0x0,\n\n\tHINIC_PF_MGMT_ACTIVE = 0x11,\n};\n\nenum hinic_outbound_state {\n\tHINIC_OUTBOUND_ENABLE  = 0,\n\tHINIC_OUTBOUND_DISABLE = 1,\n};\n\nenum hinic_db_state {\n\tHINIC_DB_ENABLE  = 0,\n\tHINIC_DB_DISABLE = 1,\n};\n\nenum hinic_msix_state {\n\tHINIC_MSIX_ENABLE,\n\tHINIC_MSIX_DISABLE,\n};\n\nstruct hinic_func_attr {\n\tu16                     func_idx;\n\tu8                      pf_idx;\n\tu8                      pci_intf_idx;\n\n\tenum hinic_func_type    func_type;\n\n\tu8                      ppf_idx;\n\n\tu16                     num_irqs;\n\tu8                      num_aeqs;\n\tu8                      num_ceqs;\n\n\tu8                      num_dma_attr;\n\n\tu16\t\t\t\t\t\tglobal_vf_id_of_pf;\n};\n\nstruct hinic_hwif {\n\tstruct pci_dev          *pdev;\n\tvoid __iomem            *cfg_regs_bar;\n\tvoid __iomem\t\t*intr_regs_base;\n\n\tstruct hinic_func_attr  attr;\n};\n\nstatic inline u32 hinic_hwif_read_reg(struct hinic_hwif *hwif, u32 reg)\n{\n\tu32 out = readl(hwif->cfg_regs_bar + reg);\n\n\treturn be32_to_cpu(*(__be32 *)&out);\n}\n\nstatic inline void hinic_hwif_write_reg(struct hinic_hwif *hwif, u32 reg,\n\t\t\t\t\tu32 val)\n{\n\t__be32 in = cpu_to_be32(val);\n\n\twritel(*(u32 *)&in, hwif->cfg_regs_bar + reg);\n}\n\nint hinic_msix_attr_set(struct hinic_hwif *hwif, u16 msix_index,\n\t\t\tu8 pending_limit, u8 coalesc_timer,\n\t\t\tu8 lli_timer_cfg, u8 lli_credit_limit,\n\t\t\tu8 resend_timer);\n\nvoid hinic_set_msix_state(struct hinic_hwif *hwif, u16 msix_idx,\n\t\t\t  enum hinic_msix_state flag);\n\nint hinic_msix_attr_cnt_clear(struct hinic_hwif *hwif, u16 msix_index);\n\nvoid hinic_set_pf_action(struct hinic_hwif *hwif, enum hinic_pf_action action);\n\nenum hinic_outbound_state hinic_outbound_state_get(struct hinic_hwif *hwif);\n\nvoid hinic_outbound_state_set(struct hinic_hwif *hwif,\n\t\t\t      enum hinic_outbound_state outbound_state);\n\nenum hinic_db_state hinic_db_state_get(struct hinic_hwif *hwif);\n\nvoid hinic_db_state_set(struct hinic_hwif *hwif,\n\t\t\tenum hinic_db_state db_state);\n\nu16 hinic_glb_pf_vf_offset(struct hinic_hwif *hwif);\n\nu16 hinic_global_func_id_hw(struct hinic_hwif *hwif);\n\nu16 hinic_pf_id_of_vf_hw(struct hinic_hwif *hwif);\n\nint hinic_init_hwif(struct hinic_hwif *hwif, struct pci_dev *pdev);\n\nvoid hinic_free_hwif(struct hinic_hwif *hwif);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}