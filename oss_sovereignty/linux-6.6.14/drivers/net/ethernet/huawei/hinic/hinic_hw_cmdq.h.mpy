{
  "module_name": "hinic_hw_cmdq.h",
  "hash_id": "e11741490f1b7e500bb124ae353d607af9f8b505fac52e54980912b6e9ecaa52",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/huawei/hinic/hinic_hw_cmdq.h",
  "human_readable_source": " \n \n\n#ifndef HINIC_CMDQ_H\n#define HINIC_CMDQ_H\n\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/completion.h>\n#include <linux/pci.h>\n\n#include \"hinic_hw_if.h\"\n#include \"hinic_hw_wq.h\"\n\n#define HINIC_CMDQ_CTXT_CURR_WQE_PAGE_PFN_SHIFT         0\n#define HINIC_CMDQ_CTXT_EQ_ID_SHIFT                     56\n#define HINIC_CMDQ_CTXT_CEQ_ARM_SHIFT                   61\n#define HINIC_CMDQ_CTXT_CEQ_EN_SHIFT                    62\n#define HINIC_CMDQ_CTXT_WRAPPED_SHIFT                   63\n\n#define HINIC_CMDQ_CTXT_CURR_WQE_PAGE_PFN_MASK          0xFFFFFFFFFFFFF\n#define HINIC_CMDQ_CTXT_EQ_ID_MASK                      0x1F\n#define HINIC_CMDQ_CTXT_CEQ_ARM_MASK                    0x1\n#define HINIC_CMDQ_CTXT_CEQ_EN_MASK                     0x1\n#define HINIC_CMDQ_CTXT_WRAPPED_MASK                    0x1\n\n#define HINIC_CMDQ_CTXT_PAGE_INFO_SET(val, member)      \\\n\t\t\t(((u64)(val) & HINIC_CMDQ_CTXT_##member##_MASK) \\\n\t\t\t << HINIC_CMDQ_CTXT_##member##_SHIFT)\n\n#define HINIC_CMDQ_CTXT_PAGE_INFO_GET(val, member)\t\\\n\t\t\t(((u64)(val) >> HINIC_CMDQ_CTXT_##member##_SHIFT) \\\n\t\t\t & HINIC_CMDQ_CTXT_##member##_MASK)\n\n#define HINIC_CMDQ_CTXT_PAGE_INFO_CLEAR(val, member)    \\\n\t\t\t((val) & (~((u64)HINIC_CMDQ_CTXT_##member##_MASK \\\n\t\t\t << HINIC_CMDQ_CTXT_##member##_SHIFT)))\n\n#define HINIC_CMDQ_CTXT_WQ_BLOCK_PFN_SHIFT              0\n#define HINIC_CMDQ_CTXT_CI_SHIFT                        52\n\n#define HINIC_CMDQ_CTXT_WQ_BLOCK_PFN_MASK               0xFFFFFFFFFFFFF\n#define HINIC_CMDQ_CTXT_CI_MASK                         0xFFF\n\n#define HINIC_CMDQ_CTXT_BLOCK_INFO_SET(val, member)     \\\n\t\t\t(((u64)(val) & HINIC_CMDQ_CTXT_##member##_MASK) \\\n\t\t\t << HINIC_CMDQ_CTXT_##member##_SHIFT)\n\n#define HINIC_CMDQ_CTXT_BLOCK_INFO_GET(val, member)\t\\\n\t\t\t(((u64)(val) >> HINIC_CMDQ_CTXT_##member##_SHIFT) \\\n\t\t\t& HINIC_CMDQ_CTXT_##member##_MASK)\n\n#define HINIC_CMDQ_CTXT_BLOCK_INFO_CLEAR(val, member)   \\\n\t\t\t((val) & (~((u64)HINIC_CMDQ_CTXT_##member##_MASK \\\n\t\t\t << HINIC_CMDQ_CTXT_##member##_SHIFT)))\n\n#define HINIC_SAVED_DATA_ARM_SHIFT                      31\n\n#define HINIC_SAVED_DATA_ARM_MASK                       0x1\n\n#define HINIC_SAVED_DATA_SET(val, member)               \\\n\t\t\t(((u32)(val) & HINIC_SAVED_DATA_##member##_MASK) \\\n\t\t\t << HINIC_SAVED_DATA_##member##_SHIFT)\n\n#define HINIC_SAVED_DATA_GET(val, member)               \\\n\t\t\t(((val) >> HINIC_SAVED_DATA_##member##_SHIFT) \\\n\t\t\t & HINIC_SAVED_DATA_##member##_MASK)\n\n#define HINIC_SAVED_DATA_CLEAR(val, member)             \\\n\t\t\t((val) & (~(HINIC_SAVED_DATA_##member##_MASK \\\n\t\t\t << HINIC_SAVED_DATA_##member##_SHIFT)))\n\n#define HINIC_CMDQ_DB_INFO_HI_PROD_IDX_SHIFT            0\n#define HINIC_CMDQ_DB_INFO_PATH_SHIFT                   23\n#define HINIC_CMDQ_DB_INFO_CMDQ_TYPE_SHIFT              24\n#define HINIC_CMDQ_DB_INFO_DB_TYPE_SHIFT                27\n\n#define HINIC_CMDQ_DB_INFO_HI_PROD_IDX_MASK             0xFF\n#define HINIC_CMDQ_DB_INFO_PATH_MASK                    0x1\n#define HINIC_CMDQ_DB_INFO_CMDQ_TYPE_MASK               0x7\n#define HINIC_CMDQ_DB_INFO_DB_TYPE_MASK                 0x1F\n\n#define HINIC_CMDQ_DB_INFO_SET(val, member)             \\\n\t\t\t(((u32)(val) & HINIC_CMDQ_DB_INFO_##member##_MASK) \\\n\t\t\t << HINIC_CMDQ_DB_INFO_##member##_SHIFT)\n\n#define HINIC_CMDQ_BUF_SIZE             2048\n\n#define HINIC_CMDQ_BUF_HW_RSVD          8\n#define HINIC_CMDQ_MAX_DATA_SIZE        (HINIC_CMDQ_BUF_SIZE - \\\n\t\t\t\t\t HINIC_CMDQ_BUF_HW_RSVD)\n\nenum hinic_cmdq_type {\n\tHINIC_CMDQ_SYNC,\n\n\tHINIC_MAX_CMDQ_TYPES,\n};\n\nenum hinic_set_arm_qtype {\n\tHINIC_SET_ARM_CMDQ,\n};\n\nenum hinic_cmd_ack_type {\n\tHINIC_CMD_ACK_TYPE_CMDQ,\n};\n\nstruct hinic_cmdq_buf {\n\tvoid            *buf;\n\tdma_addr_t      dma_addr;\n\tsize_t          size;\n};\n\nstruct hinic_cmdq_arm_bit {\n\tu32     q_type;\n\tu32     q_id;\n};\n\nstruct hinic_cmdq_ctxt_info {\n\tu64     curr_wqe_page_pfn;\n\tu64     wq_block_pfn;\n};\n\nstruct hinic_cmdq_ctxt {\n\tu8      status;\n\tu8      version;\n\tu8      rsvd0[6];\n\n\tu16     func_idx;\n\tu8      cmdq_type;\n\tu8      ppf_idx;\n\n\tu8      rsvd2[4];\n\n\tstruct hinic_cmdq_ctxt_info ctxt_info;\n};\n\nstruct hinic_cmdq {\n\tstruct hinic_hwdev      *hwdev;\n\n\tstruct hinic_wq         *wq;\n\n\tenum hinic_cmdq_type    cmdq_type;\n\tint                     wrapped;\n\n\t \n\tspinlock_t              cmdq_lock;\n\n\tstruct completion       **done;\n\tint                     **errcode;\n\n\t \n\tvoid __iomem            *db_base;\n};\n\nstruct hinic_cmdqs {\n\tstruct hinic_hwif       *hwif;\n\n\tstruct dma_pool         *cmdq_buf_pool;\n\n\tstruct hinic_wq         *saved_wqs;\n\n\tstruct hinic_cmdq_pages cmdq_pages;\n\n\tstruct hinic_cmdq       cmdq[HINIC_MAX_CMDQ_TYPES];\n};\n\nint hinic_alloc_cmdq_buf(struct hinic_cmdqs *cmdqs,\n\t\t\t struct hinic_cmdq_buf *cmdq_buf);\n\nvoid hinic_free_cmdq_buf(struct hinic_cmdqs *cmdqs,\n\t\t\t struct hinic_cmdq_buf *cmdq_buf);\n\nint hinic_cmdq_direct_resp(struct hinic_cmdqs *cmdqs,\n\t\t\t   enum hinic_mod_type mod, u8 cmd,\n\t\t\t   struct hinic_cmdq_buf *buf_in, u64 *out_param);\n\nint hinic_init_cmdqs(struct hinic_cmdqs *cmdqs, struct hinic_hwif *hwif,\n\t\t     void __iomem **db_area);\n\nvoid hinic_free_cmdqs(struct hinic_cmdqs *cmdqs);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}