{
  "module_name": "altera_tse.h",
  "hash_id": "0868863585815a989a76af479bef6f99e87bf9d4f976988c32401da8e9de250e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/altera/altera_tse.h",
  "human_readable_source": " \n \n\n#ifndef __ALTERA_TSE_H__\n#define __ALTERA_TSE_H__\n\n#define ALTERA_TSE_RESOURCE_NAME\t\"altera_tse\"\n\n#include <linux/bitops.h>\n#include <linux/if_vlan.h>\n#include <linux/list.h>\n#include <linux/netdevice.h>\n#include <linux/phy.h>\n#include <linux/phylink.h>\n\n#define ALTERA_TSE_SW_RESET_WATCHDOG_CNTR\t10000\n#define ALTERA_TSE_MAC_FIFO_WIDTH\t\t4\t \n \n#define ALTERA_TSE_RX_SECTION_EMPTY\t16\n#define ALTERA_TSE_RX_SECTION_FULL\t0\n#define ALTERA_TSE_RX_ALMOST_EMPTY\t8\n#define ALTERA_TSE_RX_ALMOST_FULL\t8\n\n \n#define ALTERA_TSE_TX_SECTION_EMPTY\t16\n#define ALTERA_TSE_TX_SECTION_FULL\t0\n#define ALTERA_TSE_TX_ALMOST_EMPTY\t8\n#define ALTERA_TSE_TX_ALMOST_FULL\t3\n\n \n#define ALTERA_TSE_TX_IPG_LENGTH\t12\n\n#define ALTERA_TSE_PAUSE_QUANTA\t\t0xffff\n\n#define GET_BIT_VALUE(v, bit)\t\t(((v) >> (bit)) & 0x1)\n\n \n#define MAC_CMDCFG_TX_ENA\t\t\tBIT(0)\n#define MAC_CMDCFG_RX_ENA\t\t\tBIT(1)\n#define MAC_CMDCFG_XON_GEN\t\t\tBIT(2)\n#define MAC_CMDCFG_ETH_SPEED\t\t\tBIT(3)\n#define MAC_CMDCFG_PROMIS_EN\t\t\tBIT(4)\n#define MAC_CMDCFG_PAD_EN\t\t\tBIT(5)\n#define MAC_CMDCFG_CRC_FWD\t\t\tBIT(6)\n#define MAC_CMDCFG_PAUSE_FWD\t\t\tBIT(7)\n#define MAC_CMDCFG_PAUSE_IGNORE\t\t\tBIT(8)\n#define MAC_CMDCFG_TX_ADDR_INS\t\t\tBIT(9)\n#define MAC_CMDCFG_HD_ENA\t\t\tBIT(10)\n#define MAC_CMDCFG_EXCESS_COL\t\t\tBIT(11)\n#define MAC_CMDCFG_LATE_COL\t\t\tBIT(12)\n#define MAC_CMDCFG_SW_RESET\t\t\tBIT(13)\n#define MAC_CMDCFG_MHASH_SEL\t\t\tBIT(14)\n#define MAC_CMDCFG_LOOP_ENA\t\t\tBIT(15)\n#define MAC_CMDCFG_TX_ADDR_SEL(v)\t\t(((v) & 0x7) << 16)\n#define MAC_CMDCFG_MAGIC_ENA\t\t\tBIT(19)\n#define MAC_CMDCFG_SLEEP\t\t\tBIT(20)\n#define MAC_CMDCFG_WAKEUP\t\t\tBIT(21)\n#define MAC_CMDCFG_XOFF_GEN\t\t\tBIT(22)\n#define MAC_CMDCFG_CNTL_FRM_ENA\t\t\tBIT(23)\n#define MAC_CMDCFG_NO_LGTH_CHECK\t\tBIT(24)\n#define MAC_CMDCFG_ENA_10\t\t\tBIT(25)\n#define MAC_CMDCFG_RX_ERR_DISC\t\t\tBIT(26)\n#define MAC_CMDCFG_DISABLE_READ_TIMEOUT\t\tBIT(27)\n#define MAC_CMDCFG_CNT_RESET\t\t\tBIT(31)\n\n#define MAC_CMDCFG_TX_ENA_GET(v)\t\tGET_BIT_VALUE(v, 0)\n#define MAC_CMDCFG_RX_ENA_GET(v)\t\tGET_BIT_VALUE(v, 1)\n#define MAC_CMDCFG_XON_GEN_GET(v)\t\tGET_BIT_VALUE(v, 2)\n#define MAC_CMDCFG_ETH_SPEED_GET(v)\t\tGET_BIT_VALUE(v, 3)\n#define MAC_CMDCFG_PROMIS_EN_GET(v)\t\tGET_BIT_VALUE(v, 4)\n#define MAC_CMDCFG_PAD_EN_GET(v)\t\tGET_BIT_VALUE(v, 5)\n#define MAC_CMDCFG_CRC_FWD_GET(v)\t\tGET_BIT_VALUE(v, 6)\n#define MAC_CMDCFG_PAUSE_FWD_GET(v)\t\tGET_BIT_VALUE(v, 7)\n#define MAC_CMDCFG_PAUSE_IGNORE_GET(v)\t\tGET_BIT_VALUE(v, 8)\n#define MAC_CMDCFG_TX_ADDR_INS_GET(v)\t\tGET_BIT_VALUE(v, 9)\n#define MAC_CMDCFG_HD_ENA_GET(v)\t\tGET_BIT_VALUE(v, 10)\n#define MAC_CMDCFG_EXCESS_COL_GET(v)\t\tGET_BIT_VALUE(v, 11)\n#define MAC_CMDCFG_LATE_COL_GET(v)\t\tGET_BIT_VALUE(v, 12)\n#define MAC_CMDCFG_SW_RESET_GET(v)\t\tGET_BIT_VALUE(v, 13)\n#define MAC_CMDCFG_MHASH_SEL_GET(v)\t\tGET_BIT_VALUE(v, 14)\n#define MAC_CMDCFG_LOOP_ENA_GET(v)\t\tGET_BIT_VALUE(v, 15)\n#define MAC_CMDCFG_TX_ADDR_SEL_GET(v)\t\t(((v) >> 16) & 0x7)\n#define MAC_CMDCFG_MAGIC_ENA_GET(v)\t\tGET_BIT_VALUE(v, 19)\n#define MAC_CMDCFG_SLEEP_GET(v)\t\t\tGET_BIT_VALUE(v, 20)\n#define MAC_CMDCFG_WAKEUP_GET(v)\t\tGET_BIT_VALUE(v, 21)\n#define MAC_CMDCFG_XOFF_GEN_GET(v)\t\tGET_BIT_VALUE(v, 22)\n#define MAC_CMDCFG_CNTL_FRM_ENA_GET(v)\t\tGET_BIT_VALUE(v, 23)\n#define MAC_CMDCFG_NO_LGTH_CHECK_GET(v)\t\tGET_BIT_VALUE(v, 24)\n#define MAC_CMDCFG_ENA_10_GET(v)\t\tGET_BIT_VALUE(v, 25)\n#define MAC_CMDCFG_RX_ERR_DISC_GET(v)\t\tGET_BIT_VALUE(v, 26)\n#define MAC_CMDCFG_DISABLE_READ_TIMEOUT_GET(v)\tGET_BIT_VALUE(v, 27)\n#define MAC_CMDCFG_CNT_RESET_GET(v)\t\tGET_BIT_VALUE(v, 31)\n\n \nstruct altera_tse_mdio {\n\tu32 control;\t \n\tu32 status;\t \n\tu32 phy_id1;\t \n\tu32 phy_id2;\t \n\tu32 auto_negotiation_advertisement;\t \n\tu32 remote_partner_base_page_ability;\n\n\tu32 reg6;\n\tu32 reg7;\n\tu32 reg8;\n\tu32 reg9;\n\tu32 rega;\n\tu32 regb;\n\tu32 regc;\n\tu32 regd;\n\tu32 rege;\n\tu32 regf;\n\tu32 reg10;\n\tu32 reg11;\n\tu32 reg12;\n\tu32 reg13;\n\tu32 reg14;\n\tu32 reg15;\n\tu32 reg16;\n\tu32 reg17;\n\tu32 reg18;\n\tu32 reg19;\n\tu32 reg1a;\n\tu32 reg1b;\n\tu32 reg1c;\n\tu32 reg1d;\n\tu32 reg1e;\n\tu32 reg1f;\n};\n\n \nstruct altera_tse_mac {\n\t \n\tu32 megacore_revision;\n\t \n\tu32 scratch_pad;\n\t \n\tu32 command_config;\n\t \n\tu32 mac_addr_0;\n\t \n\tu32 mac_addr_1;\n\t \n\tu32 frm_length;\n\t \n\tu32 pause_quanta;\n\t \n\tu32 rx_section_empty;\n\t \n\tu32 rx_section_full;\n\t \n\tu32 tx_section_empty;\n\t \n\tu32 tx_section_full;\n\t \n\tu32 rx_almost_empty;\n\t \n\tu32 rx_almost_full;\n\t \n\tu32 tx_almost_empty;\n\t \n\tu32 tx_almost_full;\n\t \n\tu32 mdio_phy0_addr;\n\t \n\tu32 mdio_phy1_addr;\n\n\t \n\tu32 holdoff_quant;\n\n\t \n\tu32 reserved1[5];\n\n\t \n\tu32 tx_ipg_length;\n\n\t \n\n\t \n\tu32 mac_id_1;\n\tu32 mac_id_2;\n\n\t \n\tu32 frames_transmitted_ok;\n\t \n\tu32 frames_received_ok;\n\t \n\tu32 frames_check_sequence_errors;\n\t \n\tu32 alignment_errors;\n\t \n\tu32 octets_transmitted_ok;\n\t \n\tu32 octets_received_ok;\n\n\t \n\n\t \n\tu32 tx_pause_mac_ctrl_frames;\n\t \n\tu32 rx_pause_mac_ctrl_frames;\n\n\t \n\n\t \n\tu32 if_in_errors;\n\t \n\tu32 if_out_errors;\n\t \n\tu32 if_in_ucast_pkts;\n\t \n\tu32 if_in_multicast_pkts;\n\t \n\tu32 if_in_broadcast_pkts;\n\tu32 if_out_discards;\n\t \n\tu32 if_out_ucast_pkts;\n\t \n\tu32 if_out_multicast_pkts;\n\tu32 if_out_broadcast_pkts;\n\n\t \n\n\t \n\tu32 ether_stats_drop_events;\n\t \n\tu32 ether_stats_octets;\n\t \n\tu32 ether_stats_pkts;\n\t \n\tu32 ether_stats_undersize_pkts;\n\t \n\tu32 ether_stats_oversize_pkts;\n\t \n\tu32 ether_stats_pkts_64_octets;\n\t \n\tu32 ether_stats_pkts_65to127_octets;\n\t \n\tu32 ether_stats_pkts_128to255_octets;\n\t \n\tu32 ether_stats_pkts_256to511_octets;\n\t \n\tu32 ether_stats_pkts_512to1023_octets;\n\t \n\tu32 ether_stats_pkts_1024to1518_octets;\n\n\t \n\tu32 ether_stats_pkts_1519tox_octets;\n\t \n\tu32 ether_stats_jabbers;\n\t \n\tu32 ether_stats_fragments;\n\n\tu32 reserved2;\n\n\t \n\tu32 tx_cmd_stat;\n\tu32 rx_cmd_stat;\n\n\t \n\tu32 msb_octets_transmitted_ok;\n\tu32 msb_octets_received_ok;\n\tu32 msb_ether_stats_octets;\n\n\tu32 reserved3;\n\n\t \n\tu32 hash_table[64];\n\n\t \n\tstruct altera_tse_mdio mdio_phy0;\n\tstruct altera_tse_mdio mdio_phy1;\n\n\t \n\tu32 supp_mac_addr_0_0;\n\tu32 supp_mac_addr_0_1;\n\tu32 supp_mac_addr_1_0;\n\tu32 supp_mac_addr_1_1;\n\tu32 supp_mac_addr_2_0;\n\tu32 supp_mac_addr_2_1;\n\tu32 supp_mac_addr_3_0;\n\tu32 supp_mac_addr_3_1;\n\n\tu32 reserved4[8];\n\n\t \n\tu32 tx_period;\n\tu32 tx_adjust_fns;\n\tu32 tx_adjust_ns;\n\tu32 rx_period;\n\tu32 rx_adjust_fns;\n\tu32 rx_adjust_ns;\n\n\tu32 reserved5[42];\n};\n\n#define tse_csroffs(a) (offsetof(struct altera_tse_mac, a))\n\n \n#define ALTERA_TSE_TX_CMD_STAT_OMIT_CRC\t\tBIT(17)\n#define ALTERA_TSE_TX_CMD_STAT_TX_SHIFT16\tBIT(18)\n#define ALTERA_TSE_RX_CMD_STAT_RX_SHIFT16\tBIT(25)\n\n \nstruct tse_buffer {\n\tstruct list_head lh;\n\tstruct sk_buff *skb;\n\tdma_addr_t dma_addr;\n\tu32 len;\n\tint mapped_as_page;\n};\n\nstruct altera_tse_private;\n\n#define ALTERA_DTYPE_SGDMA 1\n#define ALTERA_DTYPE_MSGDMA 2\n\n \nstruct altera_dmaops {\n\tint altera_dtype;\n\tint dmamask;\n\tvoid (*reset_dma)(struct altera_tse_private *);\n\tvoid (*enable_txirq)(struct altera_tse_private *);\n\tvoid (*enable_rxirq)(struct altera_tse_private *);\n\tvoid (*disable_txirq)(struct altera_tse_private *);\n\tvoid (*disable_rxirq)(struct altera_tse_private *);\n\tvoid (*clear_txirq)(struct altera_tse_private *);\n\tvoid (*clear_rxirq)(struct altera_tse_private *);\n\tint (*tx_buffer)(struct altera_tse_private *, struct tse_buffer *);\n\tu32 (*tx_completions)(struct altera_tse_private *);\n\tvoid (*add_rx_desc)(struct altera_tse_private *, struct tse_buffer *);\n\tu32 (*get_rx_status)(struct altera_tse_private *);\n\tint (*init_dma)(struct altera_tse_private *);\n\tvoid (*uninit_dma)(struct altera_tse_private *);\n\tvoid (*start_rxdma)(struct altera_tse_private *);\n};\n\n \nstruct altera_tse_private {\n\tstruct net_device *dev;\n\tstruct device *device;\n\tstruct napi_struct napi;\n\n\t \n\tstruct altera_tse_mac __iomem *mac_dev;\n\n\t \n\tu32\trevision;\n\n\t \n\tvoid __iomem *rx_dma_csr;\n\tvoid __iomem *rx_dma_desc;\n\tvoid __iomem *rx_dma_resp;\n\n\t \n\tvoid __iomem *tx_dma_csr;\n\tvoid __iomem *tx_dma_desc;\n\n\t \n\tvoid __iomem *pcs_base;\n\n\t \n\tstruct tse_buffer *rx_ring;\n\tu32 rx_cons;\n\tu32 rx_prod;\n\tu32 rx_ring_size;\n\tu32 rx_dma_buf_sz;\n\n\t \n\tstruct tse_buffer *tx_ring;\n\tu32 tx_prod;\n\tu32 tx_cons;\n\tu32 tx_ring_size;\n\n\t \n\tu32 tx_irq;\n\tu32 rx_irq;\n\n\t \n\tu32 tx_fifo_depth;\n\tu32 rx_fifo_depth;\n\n\t \n\tu32 hash_filter;\n\tu32 added_unicast;\n\n\t \n\tu32 txdescmem;\n\tu32 rxdescmem;\n\tdma_addr_t rxdescmem_busaddr;\n\tdma_addr_t txdescmem_busaddr;\n\tu32 txctrlreg;\n\tu32 rxctrlreg;\n\tdma_addr_t rxdescphys;\n\tdma_addr_t txdescphys;\n\n\tstruct list_head txlisthd;\n\tstruct list_head rxlisthd;\n\n\t \n\tspinlock_t mac_cfg_lock;\n\t \n\tspinlock_t tx_lock;\n\t \n\tspinlock_t rxdma_irq_lock;\n\n\t \n\tint phy_addr;\t\t \n\tphy_interface_t phy_iface;\n\tstruct mii_bus *mdio;\n\tint oldspeed;\n\tint oldduplex;\n\tint oldlink;\n\n\t \n\tu32 msg_enable;\n\n\tstruct altera_dmaops *dmaops;\n\n\tstruct phylink *phylink;\n\tstruct phylink_config phylink_config;\n\tstruct phylink_pcs *pcs;\n};\n\n \nvoid altera_tse_set_ethtool_ops(struct net_device *);\n\nstatic inline\nu32 csrrd32(void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\treturn readl(paddr);\n}\n\nstatic inline\nu16 csrrd16(void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\treturn readw(paddr);\n}\n\nstatic inline\nu8 csrrd8(void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\treturn readb(paddr);\n}\n\nstatic inline\nvoid csrwr32(u32 val, void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\n\twritel(val, paddr);\n}\n\nstatic inline\nvoid csrwr16(u16 val, void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\n\twritew(val, paddr);\n}\n\nstatic inline\nvoid csrwr8(u8 val, void __iomem *mac, size_t offs)\n{\n\tvoid __iomem *paddr = (void __iomem *)((uintptr_t)mac + offs);\n\n\twriteb(val, paddr);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}