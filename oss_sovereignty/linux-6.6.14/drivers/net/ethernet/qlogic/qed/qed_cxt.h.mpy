{
  "module_name": "qed_cxt.h",
  "hash_id": "686d469af9f231d8bb69693ad1c6050094e4d3e77c1b14dd92bcffe467edbe6a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/qlogic/qed/qed_cxt.h",
  "human_readable_source": " \n \n\n#ifndef _QED_CXT_H\n#define _QED_CXT_H\n\n#include <linux/types.h>\n#include <linux/slab.h>\n#include <linux/qed/qed_if.h>\n#include \"qed_hsi.h\"\n#include \"qed.h\"\n\nstruct qed_cxt_info {\n\tvoid\t\t\t*p_cxt;\n\tu32\t\t\tiid;\n\tenum protocol_type\ttype;\n};\n\n#define MAX_TID_BLOCKS                  512\nstruct qed_tid_mem {\n\tu32 tid_size;\n\tu32 num_tids_per_block;\n\tu32 waste;\n\tu8 *blocks[MAX_TID_BLOCKS];\t \n};\n\n \nint qed_cxt_get_cid_info(struct qed_hwfn *p_hwfn,\n\t\t\t struct qed_cxt_info *p_info);\n\n \nint qed_cxt_get_tid_mem_info(struct qed_hwfn *p_hwfn,\n\t\t\t     struct qed_tid_mem *p_info);\n\n#define QED_CXT_TCP_ULP_TID_SEG\tPROTOCOLID_TCP_ULP\n#define QED_CXT_ROCE_TID_SEG\tPROTOCOLID_ROCE\n#define QED_CXT_FCOE_TID_SEG\tPROTOCOLID_FCOE\nenum qed_cxt_elem_type {\n\tQED_ELEM_CXT,\n\tQED_ELEM_SRQ,\n\tQED_ELEM_TASK,\n\tQED_ELEM_XRC_SRQ,\n};\n\nu32 qed_cxt_get_proto_cid_count(struct qed_hwfn *p_hwfn,\n\t\t\t\tenum protocol_type type, u32 *vf_cid);\n\n \nint qed_cxt_set_pf_params(struct qed_hwfn *p_hwfn, u32 rdma_tasks);\n\n \nint qed_cxt_cfg_ilt_compute(struct qed_hwfn *p_hwfn, u32 *last_line);\n\n \nu32 qed_cxt_cfg_ilt_compute_excess(struct qed_hwfn *p_hwfn, u32 used_lines);\n\n \nint qed_cxt_mngr_alloc(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_cxt_mngr_free(struct qed_hwfn *p_hwfn);\n\n \nint qed_cxt_tables_alloc(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_cxt_mngr_setup(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_cxt_hw_init_common(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_cxt_hw_init_pf(struct qed_hwfn *p_hwfn, struct qed_ptt *p_ptt);\n\n \nvoid qed_qm_init_pf(struct qed_hwfn *p_hwfn,\n\t\t    struct qed_ptt *p_ptt, bool is_pf_loading);\n\n \nint qed_qm_reconf(struct qed_hwfn *p_hwfn, struct qed_ptt *p_ptt);\n\n#define QED_CXT_PF_CID (0xff)\n\n \nvoid qed_cxt_release_cid(struct qed_hwfn *p_hwfn, u32 cid);\n\n \nvoid _qed_cxt_release_cid(struct qed_hwfn *p_hwfn, u32 cid, u8 vfid);\n\n \nint qed_cxt_acquire_cid(struct qed_hwfn *p_hwfn,\n\t\t\tenum protocol_type type, u32 *p_cid);\n\n \nint _qed_cxt_acquire_cid(struct qed_hwfn *p_hwfn,\n\t\t\t enum protocol_type type, u32 *p_cid, u8 vfid);\n\nint qed_cxt_dynamic_ilt_alloc(struct qed_hwfn *p_hwfn,\n\t\t\t      enum qed_cxt_elem_type elem_type, u32 iid);\nu32 qed_cxt_get_proto_tid_count(struct qed_hwfn *p_hwfn,\n\t\t\t\tenum protocol_type type);\nu32 qed_cxt_get_proto_cid_start(struct qed_hwfn *p_hwfn,\n\t\t\t\tenum protocol_type type);\nint qed_cxt_free_proto_ilt(struct qed_hwfn *p_hwfn, enum protocol_type proto);\n\n#define QED_CTX_WORKING_MEM 0\n#define QED_CTX_FL_MEM 1\nint qed_cxt_get_task_ctx(struct qed_hwfn *p_hwfn,\n\t\t\t u32 tid, u8 ctx_type, void **task_ctx);\n\n \n#define MAX_CONN_TYPES          PROTOCOLID_COMMON\n#define NUM_TASK_TYPES          2\n#define NUM_TASK_PF_SEGMENTS    4\n#define NUM_TASK_VF_SEGMENTS    1\n\n \n#define TASK_SEGMENTS   (NUM_TASK_PF_SEGMENTS + NUM_TASK_VF_SEGMENTS)\n#define TASK_SEGMENT_VF (NUM_TASK_PF_SEGMENTS)\n\nstruct qed_tid_seg {\n\tu32 count;\n\tu8 type;\n\tbool has_fl_mem;\n};\n\nstruct qed_conn_type_cfg {\n\tu32 cid_count;\n\tu32 cids_per_vf;\n\tstruct qed_tid_seg tid_seg[TASK_SEGMENTS];\n};\n\n \n#define ILT_CLI_PF_BLOCKS       (1 + NUM_TASK_PF_SEGMENTS * 2)\n#define ILT_CLI_VF_BLOCKS       (1 + NUM_TASK_VF_SEGMENTS * 2)\n#define CDUC_BLK                (0)\n#define SRQ_BLK                 (0)\n#define CDUT_SEG_BLK(n)         (1 + (u8)(n))\n#define CDUT_FL_SEG_BLK(n, X)   (1 + (n) + NUM_TASK_ ## X ## _SEGMENTS)\n\nstruct ilt_cfg_pair {\n\tu32 reg;\n\tu32 val;\n};\n\nstruct qed_ilt_cli_blk {\n\tu32 total_size;\t\t \n\tu32 real_size_in_page;\n\tu32 start_line;\n\tu32 dynamic_line_offset;\n\tu32 dynamic_line_cnt;\n};\n\nstruct qed_ilt_client_cfg {\n\tbool active;\n\n\t \n\tstruct ilt_cfg_pair first;\n\tstruct ilt_cfg_pair last;\n\tstruct ilt_cfg_pair p_size;\n\n\t \n\tstruct qed_ilt_cli_blk pf_blks[ILT_CLI_PF_BLOCKS];\n\tu32 pf_total_lines;\n\n\t \n\tstruct qed_ilt_cli_blk vf_blks[ILT_CLI_VF_BLOCKS];\n\tu32 vf_total_lines;\n};\n\nstruct qed_cid_acquired_map {\n\tu32\t\tstart_cid;\n\tu32\t\tmax_count;\n\tunsigned long\t*cid_map;\n};\n\nstruct qed_src_t2 {\n\tstruct phys_mem_desc *dma_mem;\n\tu32 num_pages;\n\tu64 first_free;\n\tu64 last_free;\n};\n\nstruct qed_cxt_mngr {\n\t \n\tstruct qed_conn_type_cfg\tconn_cfg[MAX_CONN_TYPES];\n\n\t \n\tstruct qed_ilt_client_cfg\tclients[MAX_ILT_CLIENTS];\n\n\t \n\tu32 task_type_size[NUM_TASK_TYPES];\n\n\t \n\tu32 vf_count;\n\tu32 first_vf_in_pf;\n\n\t \n\tstruct qed_cid_acquired_map\tacquired[MAX_CONN_TYPES];\n\n\tstruct qed_cid_acquired_map\n\tacquired_vf[MAX_CONN_TYPES][MAX_NUM_VFS];\n\n\t \n\tstruct phys_mem_desc *ilt_shadow;\n\tu32 ilt_shadow_size;\n\tu32 pf_start_line;\n\n\t \n\tstruct mutex mutex;\n\n\t \n\tstruct qed_src_t2 src_t2;\n\n\t \n\tu32 srq_count;\n\tu32 xrc_srq_count;\n\n\t \n\tu32 arfs_count;\n\n\tu16 iscsi_task_pages;\n\tu16 fcoe_task_pages;\n\tu16 roce_task_pages;\n\tu16 eth_task_pages;\n\tu16 task_ctx_size;\n\tu16 conn_ctx_size;\n};\n\nu16 qed_get_cdut_num_pf_init_pages(struct qed_hwfn *p_hwfn);\nu16 qed_get_cdut_num_vf_init_pages(struct qed_hwfn *p_hwfn);\nu16 qed_get_cdut_num_pf_work_pages(struct qed_hwfn *p_hwfn);\nu16 qed_get_cdut_num_vf_work_pages(struct qed_hwfn *p_hwfn);\n\nu32 qed_cxt_get_ilt_page_size(struct qed_hwfn *p_hwfn,\n\t\t\t      enum ilt_clients ilt_client);\n\nu32 qed_cxt_get_total_srq_count(struct qed_hwfn *p_hwfn);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}