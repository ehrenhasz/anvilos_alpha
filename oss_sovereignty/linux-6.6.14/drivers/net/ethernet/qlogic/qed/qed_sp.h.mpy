{
  "module_name": "qed_sp.h",
  "hash_id": "d5cf52887656422251936949bd2abba4283f3ba8051e997416fd7cbe0c565ee3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/qlogic/qed/qed_sp.h",
  "human_readable_source": " \n \n\n#ifndef _QED_SP_H\n#define _QED_SP_H\n\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/qed/qed_chain.h>\n#include \"qed.h\"\n#include \"qed_hsi.h\"\n\nenum spq_mode {\n\tQED_SPQ_MODE_BLOCK,      \n\tQED_SPQ_MODE_CB,         \n\tQED_SPQ_MODE_EBLOCK,     \n};\n\nstruct qed_spq_comp_cb {\n\tvoid\t(*function)(struct qed_hwfn *p_hwfn,\n\t\t\t    void *cookie,\n\t\t\t    union event_ring_data *data,\n\t\t\t    u8 fw_return_code);\n\tvoid\t*cookie;\n};\n\n \nint qed_eth_cqe_completion(struct qed_hwfn *p_hwfn,\n\t\t\t   struct eth_slow_path_rx_cqe *cqe);\n\n  \nunion ramrod_data {\n\tstruct pf_start_ramrod_data pf_start;\n\tstruct pf_update_ramrod_data pf_update;\n\tstruct rx_queue_start_ramrod_data rx_queue_start;\n\tstruct rx_queue_update_ramrod_data rx_queue_update;\n\tstruct rx_queue_stop_ramrod_data rx_queue_stop;\n\tstruct tx_queue_start_ramrod_data tx_queue_start;\n\tstruct tx_queue_stop_ramrod_data tx_queue_stop;\n\tstruct vport_start_ramrod_data vport_start;\n\tstruct vport_stop_ramrod_data vport_stop;\n\tstruct rx_update_gft_filter_ramrod_data rx_update_gft;\n\tstruct vport_update_ramrod_data vport_update;\n\tstruct core_rx_start_ramrod_data core_rx_queue_start;\n\tstruct core_rx_stop_ramrod_data core_rx_queue_stop;\n\tstruct core_tx_start_ramrod_data core_tx_queue_start;\n\tstruct core_tx_stop_ramrod_data core_tx_queue_stop;\n\tstruct vport_filter_update_ramrod_data vport_filter_update;\n\n\tstruct rdma_init_func_ramrod_data rdma_init_func;\n\tstruct rdma_close_func_ramrod_data rdma_close_func;\n\tstruct rdma_register_tid_ramrod_data rdma_register_tid;\n\tstruct rdma_deregister_tid_ramrod_data rdma_deregister_tid;\n\tstruct roce_create_qp_resp_ramrod_data roce_create_qp_resp;\n\tstruct roce_create_qp_req_ramrod_data roce_create_qp_req;\n\tstruct roce_modify_qp_resp_ramrod_data roce_modify_qp_resp;\n\tstruct roce_modify_qp_req_ramrod_data roce_modify_qp_req;\n\tstruct roce_query_qp_resp_ramrod_data roce_query_qp_resp;\n\tstruct roce_query_qp_req_ramrod_data roce_query_qp_req;\n\tstruct roce_destroy_qp_resp_ramrod_data roce_destroy_qp_resp;\n\tstruct roce_destroy_qp_req_ramrod_data roce_destroy_qp_req;\n\tstruct roce_init_func_ramrod_data roce_init_func;\n\tstruct rdma_create_cq_ramrod_data rdma_create_cq;\n\tstruct rdma_destroy_cq_ramrod_data rdma_destroy_cq;\n\tstruct rdma_srq_create_ramrod_data rdma_create_srq;\n\tstruct rdma_srq_destroy_ramrod_data rdma_destroy_srq;\n\tstruct rdma_srq_modify_ramrod_data rdma_modify_srq;\n\tstruct iwarp_create_qp_ramrod_data iwarp_create_qp;\n\tstruct iwarp_tcp_offload_ramrod_data iwarp_tcp_offload;\n\tstruct iwarp_mpa_offload_ramrod_data iwarp_mpa_offload;\n\tstruct iwarp_modify_qp_ramrod_data iwarp_modify_qp;\n\tstruct iwarp_init_func_ramrod_data iwarp_init_func;\n\tstruct fcoe_init_ramrod_params fcoe_init;\n\tstruct fcoe_conn_offload_ramrod_params fcoe_conn_ofld;\n\tstruct fcoe_conn_terminate_ramrod_params fcoe_conn_terminate;\n\tstruct fcoe_stat_ramrod_params fcoe_stat;\n\n\tstruct iscsi_init_ramrod_params iscsi_init;\n\tstruct iscsi_spe_conn_offload iscsi_conn_offload;\n\tstruct iscsi_conn_update_ramrod_params iscsi_conn_update;\n\tstruct iscsi_spe_conn_mac_update iscsi_conn_mac_update;\n\tstruct iscsi_spe_conn_termination iscsi_conn_terminate;\n\n\tstruct nvmetcp_init_ramrod_params nvmetcp_init;\n\tstruct nvmetcp_spe_conn_offload nvmetcp_conn_offload;\n\tstruct nvmetcp_conn_update_ramrod_params nvmetcp_conn_update;\n\tstruct nvmetcp_spe_conn_termination nvmetcp_conn_terminate;\n\n\tstruct vf_start_ramrod_data vf_start;\n\tstruct vf_stop_ramrod_data vf_stop;\n};\n\n#define EQ_MAX_CREDIT   0xffffffff\n\nenum spq_priority {\n\tQED_SPQ_PRIORITY_NORMAL,\n\tQED_SPQ_PRIORITY_HIGH,\n};\n\nunion qed_spq_req_comp {\n\tstruct qed_spq_comp_cb\tcb;\n\tu64\t\t\t*done_addr;\n};\n\nstruct qed_spq_comp_done {\n\tunsigned int\tdone;\n\tu8\t\tfw_return_code;\n};\n\nstruct qed_spq_entry {\n\tstruct list_head\t\tlist;\n\n\tu8\t\t\t\tflags;\n\n\t \n\tstruct slow_path_element\telem;\n\n\tunion ramrod_data\t\tramrod;\n\n\tenum spq_priority\t\tpriority;\n\n\t \n\tstruct list_head\t\t*queue;\n\n\tenum spq_mode\t\t\tcomp_mode;\n\tstruct qed_spq_comp_cb\t\tcomp_cb;\n\tstruct qed_spq_comp_done\tcomp_done;  \n\n\t \n\tstruct qed_spq_entry\t\t*post_ent;\n};\n\nstruct qed_eq {\n\tstruct qed_chain\tchain;\n\tu8\t\t\teq_sb_index;     \n\t__le16\t\t\t*p_fw_cons;      \n};\n\nstruct qed_consq {\n\tstruct qed_chain chain;\n};\n\ntypedef int (*qed_spq_async_comp_cb)(struct qed_hwfn *p_hwfn, u8 opcode,\n\t\t\t\t     __le16 echo, union event_ring_data *data,\n\t\t\t\t     u8 fw_return_code);\n\nint\nqed_spq_register_async_cb(struct qed_hwfn *p_hwfn,\n\t\t\t  enum protocol_type protocol_id,\n\t\t\t  qed_spq_async_comp_cb cb);\n\nvoid\nqed_spq_unregister_async_cb(struct qed_hwfn *p_hwfn,\n\t\t\t    enum protocol_type protocol_id);\n\nstruct qed_spq {\n\tspinlock_t\t\tlock;  \n\n\tstruct list_head\tunlimited_pending;\n\tstruct list_head\tpending;\n\tstruct list_head\tcompletion_pending;\n\tstruct list_head\tfree_pool;\n\n\tstruct qed_chain\tchain;\n\n\t \n\tdma_addr_t\t\tp_phys;\n\tstruct qed_spq_entry\t*p_virt;\n\n#define SPQ_RING_SIZE \\\n\t(CORE_SPQE_PAGE_SIZE_BYTES / sizeof(struct slow_path_element))\n\n\t \n\tDECLARE_BITMAP(p_comp_bitmap, SPQ_RING_SIZE);\n\tu8\t\t\tcomp_bitmap_idx;\n\n\t \n\tu32\t\t\tunlimited_pending_count;\n\tu32\t\t\tnormal_count;\n\tu32\t\t\thigh_count;\n\tu32\t\t\tcomp_sent_count;\n\tu32\t\t\tcomp_count;\n\n\tu32\t\t\tcid;\n\tu32\t\t\tdb_addr_offset;\n\tstruct core_db_data\tdb_data;\n\tqed_spq_async_comp_cb\tasync_comp_cb[MAX_PROTOCOL_TYPE];\n};\n\n \nint qed_spq_post(struct qed_hwfn *p_hwfn,\n\t\t struct qed_spq_entry *p_ent,\n\t\t u8 *fw_return_code);\n\n \nint qed_spq_alloc(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_spq_setup(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_spq_free(struct qed_hwfn *p_hwfn);\n\n \nint\nqed_spq_get_entry(struct qed_hwfn *p_hwfn,\n\t\t  struct qed_spq_entry **pp_ent);\n\n \nvoid qed_spq_return_entry(struct qed_hwfn *p_hwfn,\n\t\t\t  struct qed_spq_entry *p_ent);\n \nint qed_eq_alloc(struct qed_hwfn *p_hwfn, u16 num_elem);\n\n \nvoid qed_eq_setup(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_eq_free(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_eq_prod_update(struct qed_hwfn *p_hwfn,\n\t\t\tu16 prod);\n\n \nint qed_eq_completion(struct qed_hwfn *p_hwfn,\n\t\t      void *cookie);\n\n \nint qed_spq_completion(struct qed_hwfn *p_hwfn,\n\t\t       __le16 echo,\n\t\t       u8 fw_return_code,\n\t\t       union event_ring_data *p_data);\n\n \nu32 qed_spq_get_cid(struct qed_hwfn *p_hwfn);\n\n \nint qed_consq_alloc(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_consq_setup(struct qed_hwfn *p_hwfn);\n\n \nvoid qed_consq_free(struct qed_hwfn *p_hwfn);\nint qed_spq_pend_post(struct qed_hwfn *p_hwfn);\n\n \n\n#define QED_SP_EQ_COMPLETION  0x01\n#define QED_SP_CQE_COMPLETION 0x02\n\nstruct qed_sp_init_data {\n\tu32\t\t\tcid;\n\tu16\t\t\topaque_fid;\n\n\t \n\tenum spq_mode\t\tcomp_mode;\n\tstruct qed_spq_comp_cb *p_comp_data;\n};\n\n \nvoid qed_sp_destroy_request(struct qed_hwfn *p_hwfn,\n\t\t\t    struct qed_spq_entry *p_ent);\n\nint qed_sp_init_request(struct qed_hwfn *p_hwfn,\n\t\t\tstruct qed_spq_entry **pp_ent,\n\t\t\tu8 cmd,\n\t\t\tu8 protocol,\n\t\t\tstruct qed_sp_init_data *p_data);\n\n \n\nint qed_sp_pf_start(struct qed_hwfn *p_hwfn,\n\t\t    struct qed_ptt *p_ptt,\n\t\t    struct qed_tunnel_info *p_tunn,\n\t\t    bool allow_npar_tx_switch);\n\n \n\nint qed_sp_pf_update(struct qed_hwfn *p_hwfn);\n\n \nint qed_sp_pf_update_stag(struct qed_hwfn *p_hwfn);\n\n \nint qed_sp_pf_update_ufp(struct qed_hwfn *p_hwfn);\n\nint qed_sp_pf_stop(struct qed_hwfn *p_hwfn);\n\nint qed_sp_pf_update_tunn_cfg(struct qed_hwfn *p_hwfn,\n\t\t\t      struct qed_ptt *p_ptt,\n\t\t\t      struct qed_tunnel_info *p_tunn,\n\t\t\t      enum spq_mode comp_mode,\n\t\t\t      struct qed_spq_comp_cb *p_comp_data);\n \n\nint qed_sp_heartbeat_ramrod(struct qed_hwfn *p_hwfn);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}