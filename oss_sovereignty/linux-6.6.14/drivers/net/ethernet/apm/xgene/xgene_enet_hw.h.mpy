{
  "module_name": "xgene_enet_hw.h",
  "hash_id": "053a957930e99f25e9c0f5b3d0eee1538078c91a2bf9e8fdbf1cc779dfb630b2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/apm/xgene/xgene_enet_hw.h",
  "human_readable_source": " \n \n\n#ifndef __XGENE_ENET_HW_H__\n#define __XGENE_ENET_HW_H__\n\n#include \"xgene_enet_main.h\"\n\nstruct xgene_enet_pdata;\nstruct xgene_enet_stats;\nstruct xgene_enet_desc_ring;\n\n \nstatic inline void xgene_set_bits(u32 *dst, u32 val, u32 start, u32 len)\n{\n\tu32 end = start + len - 1;\n\tu32 mask = GENMASK(end, start);\n\n\t*dst &= ~mask;\n\t*dst |= (val << start) & mask;\n}\n\nstatic inline u32 xgene_get_bits(u32 val, u32 start, u32 end)\n{\n\treturn (val & GENMASK(end, start)) >> start;\n}\n\nenum xgene_enet_rm {\n\tRM0,\n\tRM1,\n\tRM3 = 3\n};\n\n#define CSR_RING_ID\t\t0x0008\n#define OVERWRITE\t\tBIT(31)\n#define IS_BUFFER_POOL\t\tBIT(20)\n#define PREFETCH_BUF_EN\t\tBIT(21)\n#define CSR_RING_ID_BUF\t\t0x000c\n#define CSR_PBM_COAL\t\t0x0014\n#define CSR_PBM_CTICK0\t\t0x0018\n#define CSR_PBM_CTICK1\t\t0x001c\n#define CSR_PBM_CTICK2\t\t0x0020\n#define CSR_PBM_CTICK3\t\t0x0024\n#define CSR_THRESHOLD0_SET1\t0x0030\n#define CSR_THRESHOLD1_SET1\t0x0034\n#define CSR_RING_NE_INT_MODE\t0x017c\n#define CSR_RING_CONFIG\t\t0x006c\n#define CSR_RING_WR_BASE\t0x0070\n#define NUM_RING_CONFIG\t\t5\n#define BUFPOOL_MODE\t\t3\n#define INC_DEC_CMD_ADDR\t0x002c\n#define UDP_HDR_SIZE\t\t2\n#define BUF_LEN_CODE_2K\t\t0x5000\n\n#define CREATE_MASK(pos, len)\t\tGENMASK((pos)+(len)-1, (pos))\n#define CREATE_MASK_ULL(pos, len)\tGENMASK_ULL((pos)+(len)-1, (pos))\n\n \n#define EMPTY_SLOT_INDEX\t1\n#define EMPTY_SLOT\t\t~0ULL\n\n#define WORK_DESC_SIZE\t\t32\n#define BUFPOOL_DESC_SIZE\t16\n\n#define RING_OWNER_MASK\t\tGENMASK(9, 6)\n#define RING_BUFNUM_MASK\tGENMASK(5, 0)\n\n#define SELTHRSH_POS\t\t3\n#define SELTHRSH_LEN\t\t3\n#define RINGADDRL_POS\t\t5\n#define RINGADDRL_LEN\t\t27\n#define RINGADDRH_POS\t\t0\n#define RINGADDRH_LEN\t\t7\n#define RINGSIZE_POS\t\t23\n#define RINGSIZE_LEN\t\t3\n#define RINGTYPE_POS\t\t19\n#define RINGTYPE_LEN\t\t2\n#define RINGMODE_POS\t\t20\n#define RINGMODE_LEN\t\t3\n#define RECOMTIMEOUTL_POS\t28\n#define RECOMTIMEOUTL_LEN\t4\n#define RECOMTIMEOUTH_POS\t0\n#define RECOMTIMEOUTH_LEN\t3\n#define NUMMSGSINQ_POS\t\t1\n#define NUMMSGSINQ_LEN\t\t16\n#define ACCEPTLERR\t\tBIT(19)\n#define QCOHERENT\t\tBIT(4)\n#define RECOMBBUF\t\tBIT(27)\n\n#define MAC_OFFSET\t\t\t0x30\n#define OFFSET_4\t\t\t0x04\n#define OFFSET_8\t\t\t0x08\n\n#define BLOCK_ETH_CSR_OFFSET\t\t0x2000\n#define BLOCK_ETH_CLE_CSR_OFFSET\t0x6000\n#define BLOCK_ETH_RING_IF_OFFSET\t0x9000\n#define BLOCK_ETH_CLKRST_CSR_OFFSET\t0xc000\n#define BLOCK_ETH_DIAG_CSR_OFFSET\t0xD000\n#define BLOCK_ETH_MAC_OFFSET\t\t0x0000\n#define BLOCK_ETH_STATS_OFFSET\t\t0x0000\n#define BLOCK_ETH_MAC_CSR_OFFSET\t0x2800\n\n#define CLKEN_ADDR\t\t\t0xc208\n#define SRST_ADDR\t\t\t0xc200\n\n#define MAC_ADDR_REG_OFFSET\t\t0x00\n#define MAC_COMMAND_REG_OFFSET\t\t0x04\n#define MAC_WRITE_REG_OFFSET\t\t0x08\n#define MAC_READ_REG_OFFSET\t\t0x0c\n#define MAC_COMMAND_DONE_REG_OFFSET\t0x10\n\n#define STAT_ADDR_REG_OFFSET            0x14\n#define STAT_COMMAND_REG_OFFSET         0x18\n#define STAT_WRITE_REG_OFFSET           0x1c\n#define STAT_READ_REG_OFFSET            0x20\n#define STAT_COMMAND_DONE_REG_OFFSET    0x24\n\n#define PCS_ADDR_REG_OFFSET\t\t0x00\n#define PCS_COMMAND_REG_OFFSET\t\t0x04\n#define PCS_WRITE_REG_OFFSET\t\t0x08\n#define PCS_READ_REG_OFFSET\t\t0x0c\n#define PCS_COMMAND_DONE_REG_OFFSET\t0x10\n\n#define MII_MGMT_CONFIG_ADDR\t\t0x20\n#define MII_MGMT_COMMAND_ADDR\t\t0x24\n#define MII_MGMT_ADDRESS_ADDR\t\t0x28\n#define MII_MGMT_CONTROL_ADDR\t\t0x2c\n#define MII_MGMT_STATUS_ADDR\t\t0x30\n#define MII_MGMT_INDICATORS_ADDR\t0x34\n\n#define BUSY_MASK\t\t\tBIT(0)\n#define READ_CYCLE_MASK\t\t\tBIT(0)\n#define PHY_CONTROL_SET(dst, val)\txgene_set_bits(dst, val, 0, 16)\n\n#define ENET_SPARE_CFG_REG_ADDR\t\t0x0750\n#define RSIF_CONFIG_REG_ADDR\t\t0x0010\n#define RSIF_RAM_DBG_REG0_ADDR\t\t0x0048\n#define RGMII_REG_0_ADDR\t\t0x07e0\n#define CFG_LINK_AGGR_RESUME_0_ADDR\t0x07c8\n#define DEBUG_REG_ADDR\t\t\t0x0700\n#define CFG_BYPASS_ADDR\t\t\t0x0294\n#define CLE_BYPASS_REG0_0_ADDR\t\t0x0490\n#define CLE_BYPASS_REG1_0_ADDR\t\t0x0494\n#define CFG_RSIF_FPBUFF_TIMEOUT_EN\tBIT(31)\n#define RESUME_TX\t\t\tBIT(0)\n#define CFG_SPEED_1250\t\t\tBIT(24)\n#define TX_PORT0\t\t\tBIT(0)\n#define CFG_BYPASS_UNISEC_TX\t\tBIT(2)\n#define CFG_BYPASS_UNISEC_RX\t\tBIT(1)\n#define CFG_CLE_BYPASS_EN0\t\tBIT(31)\n#define CFG_TXCLK_MUXSEL0_SET(dst, val)\txgene_set_bits(dst, val, 29, 3)\n#define CFG_RXCLK_MUXSEL0_SET(dst, val)\txgene_set_bits(dst, val, 26, 3)\n\n#define CFG_CLE_IP_PROTOCOL0_SET(dst, val)\txgene_set_bits(dst, val, 16, 2)\n#define CFG_CLE_IP_HDR_LEN_SET(dst, val)\txgene_set_bits(dst, val, 8, 5)\n#define CFG_CLE_DSTQID0_SET(dst, val)\t\txgene_set_bits(dst, val, 0, 12)\n#define CFG_CLE_FPSEL0_SET(dst, val)\t\txgene_set_bits(dst, val, 16, 4)\n#define CFG_CLE_NXTFPSEL0_SET(dst, val)\t\txgene_set_bits(dst, val, 20, 4)\n#define CFG_MACMODE_SET(dst, val)\t\txgene_set_bits(dst, val, 18, 2)\n#define CFG_WAITASYNCRD_SET(dst, val)\t\txgene_set_bits(dst, val, 0, 16)\n#define CFG_CLE_DSTQID0(val)\t\t((val) & GENMASK(11, 0))\n#define CFG_CLE_FPSEL0(val)\t\t(((val) << 16) & GENMASK(19, 16))\n#define CSR_ECM_CFG_0_ADDR\t\t0x0220\n#define CSR_ECM_CFG_1_ADDR\t\t0x0224\n#define CSR_MULTI_DPF0_ADDR\t\t0x0230\n#define RXBUF_PAUSE_THRESH\t\t0x0534\n#define RXBUF_PAUSE_OFF_THRESH\t\t0x0540\n#define DEF_PAUSE_THRES\t\t\t0x7d\n#define DEF_PAUSE_OFF_THRES\t\t0x6d\n#define DEF_QUANTA\t\t\t0x8000\n#define NORM_PAUSE_OPCODE\t\t0x0001\n#define PAUSE_XON_EN\t\t\tBIT(30)\n#define MULTI_DPF_AUTOCTRL\t\tBIT(28)\n#define CFG_CLE_NXTFPSEL0(val)\t\t(((val) << 20) & GENMASK(23, 20))\n#define ICM_CONFIG0_REG_0_ADDR\t\t0x0400\n#define ICM_CONFIG2_REG_0_ADDR\t\t0x0410\n#define ECM_CONFIG0_REG_0_ADDR\t\t0x0500\n#define ECM_CONFIG0_REG_1_ADDR\t\t0x0504\n#define ICM_ECM_DROP_COUNT_REG0_ADDR\t0x0508\n#define ICM_ECM_DROP_COUNT_REG1_ADDR\t0x050c\n#define RX_DV_GATE_REG_0_ADDR\t\t0x05fc\n#define TX_DV_GATE_EN0\t\t\tBIT(2)\n#define RX_DV_GATE_EN0\t\t\tBIT(1)\n#define RESUME_RX0\t\t\tBIT(0)\n#define ENET_CFGSSQMIFPRESET_ADDR\t\t0x14\n#define ENET_CFGSSQMIWQRESET_ADDR\t\t0x1c\n#define ENET_CFGSSQMIWQASSOC_ADDR\t\t0xe0\n#define ENET_CFGSSQMIFPQASSOC_ADDR\t\t0xdc\n#define ENET_CFGSSQMIQMLITEFPQASSOC_ADDR\t0xf0\n#define ENET_CFGSSQMIQMLITEWQASSOC_ADDR\t\t0xf4\n#define ENET_CFG_MEM_RAM_SHUTDOWN_ADDR\t\t0x70\n#define ENET_BLOCK_MEM_RDY_ADDR\t\t\t0x74\n#define MAC_CONFIG_1_ADDR\t\t\t0x00\n#define MAC_CONFIG_2_ADDR\t\t\t0x04\n#define MAX_FRAME_LEN_ADDR\t\t\t0x10\n#define INTERFACE_CONTROL_ADDR\t\t\t0x38\n#define STATION_ADDR0_ADDR\t\t\t0x40\n#define STATION_ADDR1_ADDR\t\t\t0x44\n#define PHY_ADDR_SET(dst, val)\t\t\txgene_set_bits(dst, val, 8, 5)\n#define REG_ADDR_SET(dst, val)\t\t\txgene_set_bits(dst, val, 0, 5)\n#define ENET_INTERFACE_MODE2_SET(dst, val)\txgene_set_bits(dst, val, 8, 2)\n#define MGMT_CLOCK_SEL_SET(dst, val)\t\txgene_set_bits(dst, val, 0, 3)\n#define SOFT_RESET1\t\t\tBIT(31)\n#define TX_EN\t\t\t\tBIT(0)\n#define RX_EN\t\t\t\tBIT(2)\n#define TX_FLOW_EN\t\t\tBIT(4)\n#define RX_FLOW_EN\t\t\tBIT(5)\n#define ENET_LHD_MODE\t\t\tBIT(25)\n#define ENET_GHD_MODE\t\t\tBIT(26)\n#define FULL_DUPLEX2\t\t\tBIT(0)\n#define PAD_CRC\t\t\t\tBIT(2)\n#define LENGTH_CHK\t\t\tBIT(4)\n\n#define TR64_ADDR\t0x20\n#define TR127_ADDR\t0x21\n#define TR255_ADDR\t0x22\n#define TR511_ADDR\t0x23\n#define TR1K_ADDR\t0x24\n#define TRMAX_ADDR\t0x25\n#define TRMGV_ADDR\t0x26\n\n#define RFCS_ADDR\t0x29\n#define RMCA_ADDR\t0x2a\n#define RBCA_ADDR\t0x2b\n#define RXCF_ADDR\t0x2c\n#define RXPF_ADDR\t0x2d\n#define RXUO_ADDR\t0x2e\n#define RALN_ADDR\t0x2f\n#define RFLR_ADDR\t0x30\n#define RCDE_ADDR\t0x31\n#define RCSE_ADDR\t0x32\n#define RUND_ADDR\t0x33\n#define ROVR_ADDR\t0x34\n#define RFRG_ADDR\t0x35\n#define RJBR_ADDR\t0x36\n#define RDRP_ADDR\t0x37\n\n#define TMCA_ADDR\t0x3a\n#define TBCA_ADDR\t0x3b\n#define TXPF_ADDR\t0x3c\n#define TDFR_ADDR\t0x3d\n#define TEDF_ADDR\t0x3e\n#define TSCL_ADDR\t0x3f\n#define TMCL_ADDR\t0x40\n#define TLCL_ADDR\t0x41\n#define TXCL_ADDR\t0x42\n#define TNCL_ADDR\t0x43\n#define TPFH_ADDR\t0x44\n#define TDRP_ADDR\t0x45\n#define TJBR_ADDR\t0x46\n#define TFCS_ADDR\t0x47\n#define TXCF_ADDR\t0x48\n#define TOVR_ADDR\t0x49\n#define TUND_ADDR\t0x4a\n#define TFRG_ADDR\t0x4b\n#define DUMP_ADDR\t0x27\n\n#define ECM_DROP_COUNT(src)\txgene_get_bits(src, 0, 15)\n#define ICM_DROP_COUNT(src)\txgene_get_bits(src, 16, 31)\n\n#define TSO_IPPROTO_TCP\t\t\t1\n\n#define USERINFO_POS\t\t\t0\n#define USERINFO_LEN\t\t\t32\n#define FPQNUM_POS\t\t\t32\n#define FPQNUM_LEN\t\t\t12\n#define ELERR_POS                       46\n#define ELERR_LEN                       2\n#define NV_POS\t\t\t\t50\n#define NV_LEN\t\t\t\t1\n#define LL_POS\t\t\t\t51\n#define LL_LEN\t\t\t\t1\n#define LERR_POS\t\t\t60\n#define LERR_LEN\t\t\t3\n#define STASH_POS\t\t\t52\n#define STASH_LEN\t\t\t2\n#define BUFDATALEN_POS\t\t\t48\n#define BUFDATALEN_LEN\t\t\t15\n#define DATAADDR_POS\t\t\t0\n#define DATAADDR_LEN\t\t\t42\n#define COHERENT_POS\t\t\t63\n#define HENQNUM_POS\t\t\t48\n#define HENQNUM_LEN\t\t\t12\n#define TYPESEL_POS\t\t\t44\n#define TYPESEL_LEN\t\t\t4\n#define ETHHDR_POS\t\t\t12\n#define ETHHDR_LEN\t\t\t8\n#define IC_POS\t\t\t\t35\t \n#define TCPHDR_POS\t\t\t0\n#define TCPHDR_LEN\t\t\t6\n#define IPHDR_POS\t\t\t6\n#define IPHDR_LEN\t\t\t6\n#define MSS_POS\t\t\t\t20\n#define MSS_LEN\t\t\t\t2\n#define EC_POS\t\t\t\t22\t \n#define EC_LEN\t\t\t\t1\n#define ET_POS\t\t\t\t23\t \n#define IS_POS\t\t\t\t24\t \n#define IS_LEN\t\t\t\t1\n#define TYPE_ETH_WORK_MESSAGE_POS\t44\n#define LL_BYTES_MSB_POS\t\t56\n#define LL_BYTES_MSB_LEN\t\t8\n#define LL_BYTES_LSB_POS\t\t48\n#define LL_BYTES_LSB_LEN\t\t12\n#define LL_LEN_POS\t\t\t48\n#define LL_LEN_LEN\t\t\t8\n#define DATALEN_MASK\t\t\tGENMASK(11, 0)\n\n#define LAST_BUFFER\t\t\t(0x7800ULL << BUFDATALEN_POS)\n\n#define TSO_MSS0_POS\t\t\t0\n#define TSO_MSS0_LEN\t\t\t14\n#define TSO_MSS1_POS\t\t\t16\n#define TSO_MSS1_LEN\t\t\t14\n\nstruct xgene_enet_raw_desc {\n\t__le64 m0;\n\t__le64 m1;\n\t__le64 m2;\n\t__le64 m3;\n};\n\nstruct xgene_enet_raw_desc16 {\n\t__le64 m0;\n\t__le64 m1;\n};\n\nstatic inline void xgene_enet_mark_desc_slot_empty(void *desc_slot_ptr)\n{\n\t__le64 *desc_slot = desc_slot_ptr;\n\n\tdesc_slot[EMPTY_SLOT_INDEX] = cpu_to_le64(EMPTY_SLOT);\n}\n\nstatic inline bool xgene_enet_is_desc_slot_empty(void *desc_slot_ptr)\n{\n\t__le64 *desc_slot = desc_slot_ptr;\n\n\treturn (desc_slot[EMPTY_SLOT_INDEX] == cpu_to_le64(EMPTY_SLOT));\n}\n\nenum xgene_enet_ring_cfgsize {\n\tRING_CFGSIZE_512B,\n\tRING_CFGSIZE_2KB,\n\tRING_CFGSIZE_16KB,\n\tRING_CFGSIZE_64KB,\n\tRING_CFGSIZE_512KB,\n\tRING_CFGSIZE_INVALID\n};\n\nenum xgene_enet_ring_type {\n\tRING_DISABLED,\n\tRING_REGULAR,\n\tRING_BUFPOOL\n};\n\nenum xgene_ring_owner {\n\tRING_OWNER_ETH0,\n\tRING_OWNER_ETH1,\n\tRING_OWNER_CPU = 15,\n\tRING_OWNER_INVALID\n};\n\nenum xgene_enet_ring_bufnum {\n\tRING_BUFNUM_REGULAR = 0x0,\n\tRING_BUFNUM_BUFPOOL = 0x20,\n\tRING_BUFNUM_INVALID\n};\n\nenum xgene_enet_err_code {\n\tHBF_READ_DATA = 3,\n\tHBF_LL_READ = 4,\n\tBAD_WORK_MSG = 6,\n\tBUFPOOL_TIMEOUT = 15,\n\tINGRESS_CRC = 16,\n\tINGRESS_CHECKSUM = 17,\n\tINGRESS_TRUNC_FRAME = 18,\n\tINGRESS_PKT_LEN = 19,\n\tINGRESS_PKT_UNDER = 20,\n\tINGRESS_FIFO_OVERRUN = 21,\n\tINGRESS_CHECKSUM_COMPUTE = 26,\n\tERR_CODE_INVALID\n};\n\nstatic inline enum xgene_ring_owner xgene_enet_ring_owner(u16 id)\n{\n\treturn (id & RING_OWNER_MASK) >> 6;\n}\n\nstatic inline u8 xgene_enet_ring_bufnum(u16 id)\n{\n\treturn id & RING_BUFNUM_MASK;\n}\n\nstatic inline bool xgene_enet_is_bufpool(u16 id)\n{\n\treturn ((id & RING_BUFNUM_MASK) >= 0x20) ? true : false;\n}\n\nstatic inline u8 xgene_enet_get_fpsel(u16 id)\n{\n\tif (xgene_enet_is_bufpool(id))\n\t\treturn xgene_enet_ring_bufnum(id) - RING_BUFNUM_BUFPOOL;\n\n\treturn 0;\n}\n\nstatic inline u16 xgene_enet_get_numslots(u16 id, u32 size)\n{\n\tbool is_bufpool = xgene_enet_is_bufpool(id);\n\n\treturn (is_bufpool) ? size / BUFPOOL_DESC_SIZE :\n\t\t      size / WORK_DESC_SIZE;\n}\n\nvoid xgene_enet_parse_error(struct xgene_enet_desc_ring *ring,\n\t\t\t    enum xgene_enet_err_code status);\nint xgene_enet_mdio_config(struct xgene_enet_pdata *pdata);\nvoid xgene_enet_mdio_remove(struct xgene_enet_pdata *pdata);\nbool xgene_ring_mgr_init(struct xgene_enet_pdata *p);\nint xgene_enet_phy_connect(struct net_device *ndev);\nvoid xgene_enet_phy_disconnect(struct xgene_enet_pdata *pdata);\nu32 xgene_enet_rd_mac(struct xgene_enet_pdata *pdata, u32 rd_addr);\nvoid xgene_enet_wr_mac(struct xgene_enet_pdata *pdata, u32 wr_addr,\n\t\t       u32 wr_data);\nu32 xgene_enet_rd_stat(struct xgene_enet_pdata *pdata, u32 rd_addr);\n\nextern const struct xgene_mac_ops xgene_gmac_ops;\nextern const struct xgene_port_ops xgene_gport_ops;\nextern struct xgene_ring_ops xgene_ring1_ops;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}