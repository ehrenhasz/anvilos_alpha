{
  "module_name": "hnae3.h",
  "hash_id": "0c0e6a60c4014354583e852a6ba432867b6603dc9bf3e23d8857bd3d21d8f757",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hnae3.h",
  "human_readable_source": " \n\n\n#ifndef __HNAE3_H\n#define __HNAE3_H\n\n \n\n#include <linux/acpi.h>\n#include <linux/dcbnl.h>\n#include <linux/delay.h>\n#include <linux/device.h>\n#include <linux/ethtool.h>\n#include <linux/module.h>\n#include <linux/netdevice.h>\n#include <linux/pci.h>\n#include <linux/pkt_sched.h>\n#include <linux/types.h>\n#include <linux/bitmap.h>\n#include <net/pkt_cls.h>\n#include <net/pkt_sched.h>\n\n#define HNAE3_MOD_VERSION \"1.0\"\n\n#define HNAE3_MIN_VECTOR_NUM\t2  \n\n \n#define HNAE3_DEVICE_VERSION_V1   0x00020\n#define HNAE3_DEVICE_VERSION_V2   0x00021\n#define HNAE3_DEVICE_VERSION_V3   0x00030\n\n#define HNAE3_PCI_REVISION_BIT_SIZE\t\t8\n\n \n#define HNAE3_DEV_ID_GE\t\t\t\t0xA220\n#define HNAE3_DEV_ID_25GE\t\t\t0xA221\n#define HNAE3_DEV_ID_25GE_RDMA\t\t\t0xA222\n#define HNAE3_DEV_ID_25GE_RDMA_MACSEC\t\t0xA223\n#define HNAE3_DEV_ID_50GE_RDMA\t\t\t0xA224\n#define HNAE3_DEV_ID_50GE_RDMA_MACSEC\t\t0xA225\n#define HNAE3_DEV_ID_100G_RDMA_MACSEC\t\t0xA226\n#define HNAE3_DEV_ID_200G_RDMA\t\t\t0xA228\n#define HNAE3_DEV_ID_VF\t\t\t\t0xA22E\n#define HNAE3_DEV_ID_RDMA_DCB_PFC_VF\t\t0xA22F\n\n#define HNAE3_CLASS_NAME_SIZE 16\n\n#define HNAE3_DEV_INITED_B\t\t\t0x0\n#define HNAE3_DEV_SUPPORT_ROCE_B\t\t0x1\n#define HNAE3_DEV_SUPPORT_DCB_B\t\t\t0x2\n#define HNAE3_KNIC_CLIENT_INITED_B\t\t0x3\n#define HNAE3_UNIC_CLIENT_INITED_B\t\t0x4\n#define HNAE3_ROCE_CLIENT_INITED_B\t\t0x5\n\n#define HNAE3_DEV_SUPPORT_ROCE_DCB_BITS (BIT(HNAE3_DEV_SUPPORT_DCB_B) | \\\n\t\tBIT(HNAE3_DEV_SUPPORT_ROCE_B))\n\n#define hnae3_dev_roce_supported(hdev) \\\n\thnae3_get_bit((hdev)->ae_dev->flag, HNAE3_DEV_SUPPORT_ROCE_B)\n\n#define hnae3_dev_dcb_supported(hdev) \\\n\thnae3_get_bit((hdev)->ae_dev->flag, HNAE3_DEV_SUPPORT_DCB_B)\n\nenum HNAE3_DEV_CAP_BITS {\n\tHNAE3_DEV_SUPPORT_FD_B,\n\tHNAE3_DEV_SUPPORT_GRO_B,\n\tHNAE3_DEV_SUPPORT_FEC_B,\n\tHNAE3_DEV_SUPPORT_UDP_GSO_B,\n\tHNAE3_DEV_SUPPORT_QB_B,\n\tHNAE3_DEV_SUPPORT_FD_FORWARD_TC_B,\n\tHNAE3_DEV_SUPPORT_PTP_B,\n\tHNAE3_DEV_SUPPORT_INT_QL_B,\n\tHNAE3_DEV_SUPPORT_HW_TX_CSUM_B,\n\tHNAE3_DEV_SUPPORT_TX_PUSH_B,\n\tHNAE3_DEV_SUPPORT_PHY_IMP_B,\n\tHNAE3_DEV_SUPPORT_TQP_TXRX_INDEP_B,\n\tHNAE3_DEV_SUPPORT_HW_PAD_B,\n\tHNAE3_DEV_SUPPORT_STASH_B,\n\tHNAE3_DEV_SUPPORT_UDP_TUNNEL_CSUM_B,\n\tHNAE3_DEV_SUPPORT_PAUSE_B,\n\tHNAE3_DEV_SUPPORT_RAS_IMP_B,\n\tHNAE3_DEV_SUPPORT_RXD_ADV_LAYOUT_B,\n\tHNAE3_DEV_SUPPORT_PORT_VLAN_BYPASS_B,\n\tHNAE3_DEV_SUPPORT_VLAN_FLTR_MDF_B,\n\tHNAE3_DEV_SUPPORT_MC_MAC_MNG_B,\n\tHNAE3_DEV_SUPPORT_CQ_B,\n\tHNAE3_DEV_SUPPORT_FEC_STATS_B,\n\tHNAE3_DEV_SUPPORT_LANE_NUM_B,\n\tHNAE3_DEV_SUPPORT_WOL_B,\n\tHNAE3_DEV_SUPPORT_TM_FLUSH_B,\n};\n\n#define hnae3_ae_dev_fd_supported(ae_dev) \\\n\t\ttest_bit(HNAE3_DEV_SUPPORT_FD_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_gro_supported(ae_dev) \\\n\t\ttest_bit(HNAE3_DEV_SUPPORT_GRO_B, (ae_dev)->caps)\n\n#define hnae3_dev_fec_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_FEC_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_udp_gso_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_UDP_GSO_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_qb_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_QB_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_fd_forward_tc_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_FD_FORWARD_TC_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_ptp_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_PTP_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_int_ql_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_INT_QL_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_hw_csum_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_HW_TX_CSUM_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_tx_push_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_TX_PUSH_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_phy_imp_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_PHY_IMP_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_ras_imp_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_RAS_IMP_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_tqp_txrx_indep_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_TQP_TXRX_INDEP_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_hw_pad_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_HW_PAD_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_stash_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_STASH_B, (hdev)->ae_dev->caps)\n\n#define hnae3_dev_pause_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_PAUSE_B, (hdev)->ae_dev->caps)\n\n#define hnae3_ae_dev_tqp_txrx_indep_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_TQP_TXRX_INDEP_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_rxd_adv_layout_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_RXD_ADV_LAYOUT_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_mc_mac_mng_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_MC_MAC_MNG_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_cq_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_CQ_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_fec_stats_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_FEC_STATS_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_lane_num_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_LANE_NUM_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_wol_supported(ae_dev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_WOL_B, (ae_dev)->caps)\n\n#define hnae3_ae_dev_tm_flush_supported(hdev) \\\n\ttest_bit(HNAE3_DEV_SUPPORT_TM_FLUSH_B, (hdev)->ae_dev->caps)\n\nenum HNAE3_PF_CAP_BITS {\n\tHNAE3_PF_SUPPORT_VLAN_FLTR_MDF_B = 0,\n};\n#define ring_ptr_move_fw(ring, p) \\\n\t((ring)->p = ((ring)->p + 1) % (ring)->desc_num)\n#define ring_ptr_move_bw(ring, p) \\\n\t((ring)->p = ((ring)->p - 1 + (ring)->desc_num) % (ring)->desc_num)\n\nstruct hnae3_handle;\n\nstruct hnae3_queue {\n\tvoid __iomem *io_base;\n\tvoid __iomem *mem_base;\n\tstruct hnae3_ae_algo *ae_algo;\n\tstruct hnae3_handle *handle;\n\tint tqp_index;\t\t \n\tu32 buf_size;\t\t \n\tu16 tx_desc_num;\t \n\tu16 rx_desc_num;\t \n};\n\nstruct hns3_mac_stats {\n\tu64 tx_pause_cnt;\n\tu64 rx_pause_cnt;\n};\n\n \nenum hnae3_loop {\n\tHNAE3_LOOP_EXTERNAL,\n\tHNAE3_LOOP_APP,\n\tHNAE3_LOOP_SERIAL_SERDES,\n\tHNAE3_LOOP_PARALLEL_SERDES,\n\tHNAE3_LOOP_PHY,\n\tHNAE3_LOOP_NONE,\n};\n\nenum hnae3_client_type {\n\tHNAE3_CLIENT_KNIC,\n\tHNAE3_CLIENT_ROCE,\n};\n\n \nenum hnae3_media_type {\n\tHNAE3_MEDIA_TYPE_UNKNOWN,\n\tHNAE3_MEDIA_TYPE_FIBER,\n\tHNAE3_MEDIA_TYPE_COPPER,\n\tHNAE3_MEDIA_TYPE_BACKPLANE,\n\tHNAE3_MEDIA_TYPE_NONE,\n};\n\n \nenum hnae3_module_type {\n\tHNAE3_MODULE_TYPE_UNKNOWN\t= 0x00,\n\tHNAE3_MODULE_TYPE_FIBRE_LR\t= 0x01,\n\tHNAE3_MODULE_TYPE_FIBRE_SR\t= 0x02,\n\tHNAE3_MODULE_TYPE_AOC\t\t= 0x03,\n\tHNAE3_MODULE_TYPE_CR\t\t= 0x04,\n\tHNAE3_MODULE_TYPE_KR\t\t= 0x05,\n\tHNAE3_MODULE_TYPE_TP\t\t= 0x06,\n};\n\nenum hnae3_fec_mode {\n\tHNAE3_FEC_AUTO = 0,\n\tHNAE3_FEC_BASER,\n\tHNAE3_FEC_RS,\n\tHNAE3_FEC_LLRS,\n\tHNAE3_FEC_NONE,\n\tHNAE3_FEC_USER_DEF,\n};\n\nenum hnae3_reset_notify_type {\n\tHNAE3_UP_CLIENT,\n\tHNAE3_DOWN_CLIENT,\n\tHNAE3_INIT_CLIENT,\n\tHNAE3_UNINIT_CLIENT,\n};\n\nenum hnae3_hw_error_type {\n\tHNAE3_PPU_POISON_ERROR,\n\tHNAE3_CMDQ_ECC_ERROR,\n\tHNAE3_IMP_RD_POISON_ERROR,\n\tHNAE3_ROCEE_AXI_RESP_ERROR,\n};\n\nenum hnae3_reset_type {\n\tHNAE3_VF_RESET,\n\tHNAE3_VF_FUNC_RESET,\n\tHNAE3_VF_PF_FUNC_RESET,\n\tHNAE3_VF_FULL_RESET,\n\tHNAE3_FLR_RESET,\n\tHNAE3_FUNC_RESET,\n\tHNAE3_GLOBAL_RESET,\n\tHNAE3_IMP_RESET,\n\tHNAE3_NONE_RESET,\n\tHNAE3_MAX_RESET,\n};\n\nenum hnae3_port_base_vlan_state {\n\tHNAE3_PORT_BASE_VLAN_DISABLE,\n\tHNAE3_PORT_BASE_VLAN_ENABLE,\n\tHNAE3_PORT_BASE_VLAN_MODIFY,\n\tHNAE3_PORT_BASE_VLAN_NOCHANGE,\n};\n\nenum hnae3_dbg_cmd {\n\tHNAE3_DBG_CMD_TM_NODES,\n\tHNAE3_DBG_CMD_TM_PRI,\n\tHNAE3_DBG_CMD_TM_QSET,\n\tHNAE3_DBG_CMD_TM_MAP,\n\tHNAE3_DBG_CMD_TM_PG,\n\tHNAE3_DBG_CMD_TM_PORT,\n\tHNAE3_DBG_CMD_TC_SCH_INFO,\n\tHNAE3_DBG_CMD_QOS_PAUSE_CFG,\n\tHNAE3_DBG_CMD_QOS_PRI_MAP,\n\tHNAE3_DBG_CMD_QOS_DSCP_MAP,\n\tHNAE3_DBG_CMD_QOS_BUF_CFG,\n\tHNAE3_DBG_CMD_DEV_INFO,\n\tHNAE3_DBG_CMD_TX_BD,\n\tHNAE3_DBG_CMD_RX_BD,\n\tHNAE3_DBG_CMD_MAC_UC,\n\tHNAE3_DBG_CMD_MAC_MC,\n\tHNAE3_DBG_CMD_MNG_TBL,\n\tHNAE3_DBG_CMD_LOOPBACK,\n\tHNAE3_DBG_CMD_PTP_INFO,\n\tHNAE3_DBG_CMD_INTERRUPT_INFO,\n\tHNAE3_DBG_CMD_RESET_INFO,\n\tHNAE3_DBG_CMD_IMP_INFO,\n\tHNAE3_DBG_CMD_NCL_CONFIG,\n\tHNAE3_DBG_CMD_REG_BIOS_COMMON,\n\tHNAE3_DBG_CMD_REG_SSU,\n\tHNAE3_DBG_CMD_REG_IGU_EGU,\n\tHNAE3_DBG_CMD_REG_RPU,\n\tHNAE3_DBG_CMD_REG_NCSI,\n\tHNAE3_DBG_CMD_REG_RTC,\n\tHNAE3_DBG_CMD_REG_PPP,\n\tHNAE3_DBG_CMD_REG_RCB,\n\tHNAE3_DBG_CMD_REG_TQP,\n\tHNAE3_DBG_CMD_REG_MAC,\n\tHNAE3_DBG_CMD_REG_DCB,\n\tHNAE3_DBG_CMD_VLAN_CONFIG,\n\tHNAE3_DBG_CMD_QUEUE_MAP,\n\tHNAE3_DBG_CMD_RX_QUEUE_INFO,\n\tHNAE3_DBG_CMD_TX_QUEUE_INFO,\n\tHNAE3_DBG_CMD_FD_TCAM,\n\tHNAE3_DBG_CMD_FD_COUNTER,\n\tHNAE3_DBG_CMD_MAC_TNL_STATUS,\n\tHNAE3_DBG_CMD_SERV_INFO,\n\tHNAE3_DBG_CMD_UMV_INFO,\n\tHNAE3_DBG_CMD_PAGE_POOL_INFO,\n\tHNAE3_DBG_CMD_COAL_INFO,\n\tHNAE3_DBG_CMD_UNKNOWN,\n};\n\nenum hnae3_tc_map_mode {\n\tHNAE3_TC_MAP_MODE_PRIO,\n\tHNAE3_TC_MAP_MODE_DSCP,\n};\n\nstruct hnae3_vector_info {\n\tu8 __iomem *io_addr;\n\tint vector;\n};\n\n#define HNAE3_RING_TYPE_B 0\n#define HNAE3_RING_TYPE_TX 0\n#define HNAE3_RING_TYPE_RX 1\n#define HNAE3_RING_GL_IDX_S 0\n#define HNAE3_RING_GL_IDX_M GENMASK(1, 0)\n#define HNAE3_RING_GL_RX 0\n#define HNAE3_RING_GL_TX 1\n\n#define HNAE3_FW_VERSION_BYTE3_SHIFT\t24\n#define HNAE3_FW_VERSION_BYTE3_MASK\tGENMASK(31, 24)\n#define HNAE3_FW_VERSION_BYTE2_SHIFT\t16\n#define HNAE3_FW_VERSION_BYTE2_MASK\tGENMASK(23, 16)\n#define HNAE3_FW_VERSION_BYTE1_SHIFT\t8\n#define HNAE3_FW_VERSION_BYTE1_MASK\tGENMASK(15, 8)\n#define HNAE3_FW_VERSION_BYTE0_SHIFT\t0\n#define HNAE3_FW_VERSION_BYTE0_MASK\tGENMASK(7, 0)\n\nstruct hnae3_ring_chain_node {\n\tstruct hnae3_ring_chain_node *next;\n\tu32 tqp_index;\n\tu32 flag;\n\tu32 int_gl_idx;\n};\n\n#define HNAE3_IS_TX_RING(node) \\\n\t(((node)->flag & 1 << HNAE3_RING_TYPE_B) == HNAE3_RING_TYPE_TX)\n\n \nstruct hnae3_dev_specs {\n\tu32 mac_entry_num;  \n\tu32 mng_entry_num;  \n\tu32 max_tm_rate;\n\tu16 rss_ind_tbl_size;\n\tu16 rss_key_size;\n\tu16 int_ql_max;  \n\tu16 max_int_gl;  \n\tu8 max_non_tso_bd_num;  \n\tu16 max_frm_size;\n\tu16 max_qset_num;\n\tu16 umv_size;\n\tu16 mc_mac_size;\n\tu32 mac_stats_num;\n\tu8 tnl_num;\n};\n\nstruct hnae3_client_ops {\n\tint (*init_instance)(struct hnae3_handle *handle);\n\tvoid (*uninit_instance)(struct hnae3_handle *handle, bool reset);\n\tvoid (*link_status_change)(struct hnae3_handle *handle, bool state);\n\tint (*reset_notify)(struct hnae3_handle *handle,\n\t\t\t    enum hnae3_reset_notify_type type);\n\tvoid (*process_hw_error)(struct hnae3_handle *handle,\n\t\t\t\t enum hnae3_hw_error_type);\n};\n\n#define HNAE3_CLIENT_NAME_LENGTH 16\nstruct hnae3_client {\n\tchar name[HNAE3_CLIENT_NAME_LENGTH];\n\tunsigned long state;\n\tenum hnae3_client_type type;\n\tconst struct hnae3_client_ops *ops;\n\tstruct list_head node;\n};\n\n#define HNAE3_DEV_CAPS_MAX_NUM\t96\nstruct hnae3_ae_dev {\n\tstruct pci_dev *pdev;\n\tconst struct hnae3_ae_ops *ops;\n\tstruct list_head node;\n\tu32 flag;\n\tunsigned long hw_err_reset_req;\n\tstruct hnae3_dev_specs dev_specs;\n\tu32 dev_version;\n\tDECLARE_BITMAP(caps, HNAE3_DEV_CAPS_MAX_NUM);\n\tvoid *priv;\n};\n\n \nstruct hnae3_ae_ops {\n\tint (*init_ae_dev)(struct hnae3_ae_dev *ae_dev);\n\tvoid (*uninit_ae_dev)(struct hnae3_ae_dev *ae_dev);\n\tvoid (*reset_prepare)(struct hnae3_ae_dev *ae_dev,\n\t\t\t      enum hnae3_reset_type rst_type);\n\tvoid (*reset_done)(struct hnae3_ae_dev *ae_dev);\n\tint (*init_client_instance)(struct hnae3_client *client,\n\t\t\t\t    struct hnae3_ae_dev *ae_dev);\n\tvoid (*uninit_client_instance)(struct hnae3_client *client,\n\t\t\t\t       struct hnae3_ae_dev *ae_dev);\n\tint (*start)(struct hnae3_handle *handle);\n\tvoid (*stop)(struct hnae3_handle *handle);\n\tint (*client_start)(struct hnae3_handle *handle);\n\tvoid (*client_stop)(struct hnae3_handle *handle);\n\tint (*get_status)(struct hnae3_handle *handle);\n\tvoid (*get_ksettings_an_result)(struct hnae3_handle *handle,\n\t\t\t\t\tu8 *auto_neg, u32 *speed, u8 *duplex,\n\t\t\t\t\tu32 *lane_num);\n\n\tint (*cfg_mac_speed_dup_h)(struct hnae3_handle *handle, int speed,\n\t\t\t\t   u8 duplex, u8 lane_num);\n\n\tvoid (*get_media_type)(struct hnae3_handle *handle, u8 *media_type,\n\t\t\t       u8 *module_type);\n\tint (*check_port_speed)(struct hnae3_handle *handle, u32 speed);\n\tvoid (*get_fec_stats)(struct hnae3_handle *handle,\n\t\t\t      struct ethtool_fec_stats *fec_stats);\n\tvoid (*get_fec)(struct hnae3_handle *handle, u8 *fec_ability,\n\t\t\tu8 *fec_mode);\n\tint (*set_fec)(struct hnae3_handle *handle, u32 fec_mode);\n\tvoid (*adjust_link)(struct hnae3_handle *handle, int speed, int duplex);\n\tint (*set_loopback)(struct hnae3_handle *handle,\n\t\t\t    enum hnae3_loop loop_mode, bool en);\n\n\tint (*set_promisc_mode)(struct hnae3_handle *handle, bool en_uc_pmc,\n\t\t\t\tbool en_mc_pmc);\n\tvoid (*request_update_promisc_mode)(struct hnae3_handle *handle);\n\tint (*set_mtu)(struct hnae3_handle *handle, int new_mtu);\n\n\tvoid (*get_pauseparam)(struct hnae3_handle *handle,\n\t\t\t       u32 *auto_neg, u32 *rx_en, u32 *tx_en);\n\tint (*set_pauseparam)(struct hnae3_handle *handle,\n\t\t\t      u32 auto_neg, u32 rx_en, u32 tx_en);\n\n\tint (*set_autoneg)(struct hnae3_handle *handle, bool enable);\n\tint (*get_autoneg)(struct hnae3_handle *handle);\n\tint (*restart_autoneg)(struct hnae3_handle *handle);\n\tint (*halt_autoneg)(struct hnae3_handle *handle, bool halt);\n\n\tvoid (*get_coalesce_usecs)(struct hnae3_handle *handle,\n\t\t\t\t   u32 *tx_usecs, u32 *rx_usecs);\n\tvoid (*get_rx_max_coalesced_frames)(struct hnae3_handle *handle,\n\t\t\t\t\t    u32 *tx_frames, u32 *rx_frames);\n\tint (*set_coalesce_usecs)(struct hnae3_handle *handle, u32 timeout);\n\tint (*set_coalesce_frames)(struct hnae3_handle *handle,\n\t\t\t\t   u32 coalesce_frames);\n\tvoid (*get_coalesce_range)(struct hnae3_handle *handle,\n\t\t\t\t   u32 *tx_frames_low, u32 *rx_frames_low,\n\t\t\t\t   u32 *tx_frames_high, u32 *rx_frames_high,\n\t\t\t\t   u32 *tx_usecs_low, u32 *rx_usecs_low,\n\t\t\t\t   u32 *tx_usecs_high, u32 *rx_usecs_high);\n\n\tvoid (*get_mac_addr)(struct hnae3_handle *handle, u8 *p);\n\tint (*set_mac_addr)(struct hnae3_handle *handle, const void *p,\n\t\t\t    bool is_first);\n\tint (*do_ioctl)(struct hnae3_handle *handle,\n\t\t\tstruct ifreq *ifr, int cmd);\n\tint (*add_uc_addr)(struct hnae3_handle *handle,\n\t\t\t   const unsigned char *addr);\n\tint (*rm_uc_addr)(struct hnae3_handle *handle,\n\t\t\t  const unsigned char *addr);\n\tint (*set_mc_addr)(struct hnae3_handle *handle, void *addr);\n\tint (*add_mc_addr)(struct hnae3_handle *handle,\n\t\t\t   const unsigned char *addr);\n\tint (*rm_mc_addr)(struct hnae3_handle *handle,\n\t\t\t  const unsigned char *addr);\n\tvoid (*set_tso_stats)(struct hnae3_handle *handle, int enable);\n\tvoid (*update_stats)(struct hnae3_handle *handle);\n\tvoid (*get_stats)(struct hnae3_handle *handle, u64 *data);\n\tvoid (*get_mac_stats)(struct hnae3_handle *handle,\n\t\t\t      struct hns3_mac_stats *mac_stats);\n\tvoid (*get_strings)(struct hnae3_handle *handle,\n\t\t\t    u32 stringset, u8 *data);\n\tint (*get_sset_count)(struct hnae3_handle *handle, int stringset);\n\n\tvoid (*get_regs)(struct hnae3_handle *handle, u32 *version,\n\t\t\t void *data);\n\tint (*get_regs_len)(struct hnae3_handle *handle);\n\n\tu32 (*get_rss_key_size)(struct hnae3_handle *handle);\n\tint (*get_rss)(struct hnae3_handle *handle, u32 *indir, u8 *key,\n\t\t       u8 *hfunc);\n\tint (*set_rss)(struct hnae3_handle *handle, const u32 *indir,\n\t\t       const u8 *key, const u8 hfunc);\n\tint (*set_rss_tuple)(struct hnae3_handle *handle,\n\t\t\t     struct ethtool_rxnfc *cmd);\n\tint (*get_rss_tuple)(struct hnae3_handle *handle,\n\t\t\t     struct ethtool_rxnfc *cmd);\n\n\tint (*get_tc_size)(struct hnae3_handle *handle);\n\n\tint (*get_vector)(struct hnae3_handle *handle, u16 vector_num,\n\t\t\t  struct hnae3_vector_info *vector_info);\n\tint (*put_vector)(struct hnae3_handle *handle, int vector_num);\n\tint (*map_ring_to_vector)(struct hnae3_handle *handle,\n\t\t\t\t  int vector_num,\n\t\t\t\t  struct hnae3_ring_chain_node *vr_chain);\n\tint (*unmap_ring_from_vector)(struct hnae3_handle *handle,\n\t\t\t\t      int vector_num,\n\t\t\t\t      struct hnae3_ring_chain_node *vr_chain);\n\n\tint (*reset_queue)(struct hnae3_handle *handle);\n\tu32 (*get_fw_version)(struct hnae3_handle *handle);\n\tvoid (*get_mdix_mode)(struct hnae3_handle *handle,\n\t\t\t      u8 *tp_mdix_ctrl, u8 *tp_mdix);\n\n\tint (*enable_vlan_filter)(struct hnae3_handle *handle, bool enable);\n\tint (*set_vlan_filter)(struct hnae3_handle *handle, __be16 proto,\n\t\t\t       u16 vlan_id, bool is_kill);\n\tint (*set_vf_vlan_filter)(struct hnae3_handle *handle, int vfid,\n\t\t\t\t  u16 vlan, u8 qos, __be16 proto);\n\tint (*enable_hw_strip_rxvtag)(struct hnae3_handle *handle, bool enable);\n\tvoid (*reset_event)(struct pci_dev *pdev, struct hnae3_handle *handle);\n\tenum hnae3_reset_type (*get_reset_level)(struct hnae3_ae_dev *ae_dev,\n\t\t\t\t\t\t unsigned long *addr);\n\tvoid (*set_default_reset_request)(struct hnae3_ae_dev *ae_dev,\n\t\t\t\t\t  enum hnae3_reset_type rst_type);\n\tvoid (*get_channels)(struct hnae3_handle *handle,\n\t\t\t     struct ethtool_channels *ch);\n\tvoid (*get_tqps_and_rss_info)(struct hnae3_handle *h,\n\t\t\t\t      u16 *alloc_tqps, u16 *max_rss_size);\n\tint (*set_channels)(struct hnae3_handle *handle, u32 new_tqps_num,\n\t\t\t    bool rxfh_configured);\n\tvoid (*get_flowctrl_adv)(struct hnae3_handle *handle,\n\t\t\t\t u32 *flowctrl_adv);\n\tint (*set_led_id)(struct hnae3_handle *handle,\n\t\t\t  enum ethtool_phys_id_state status);\n\tvoid (*get_link_mode)(struct hnae3_handle *handle,\n\t\t\t      unsigned long *supported,\n\t\t\t      unsigned long *advertising);\n\tint (*add_fd_entry)(struct hnae3_handle *handle,\n\t\t\t    struct ethtool_rxnfc *cmd);\n\tint (*del_fd_entry)(struct hnae3_handle *handle,\n\t\t\t    struct ethtool_rxnfc *cmd);\n\tint (*get_fd_rule_cnt)(struct hnae3_handle *handle,\n\t\t\t       struct ethtool_rxnfc *cmd);\n\tint (*get_fd_rule_info)(struct hnae3_handle *handle,\n\t\t\t\tstruct ethtool_rxnfc *cmd);\n\tint (*get_fd_all_rules)(struct hnae3_handle *handle,\n\t\t\t\tstruct ethtool_rxnfc *cmd, u32 *rule_locs);\n\tvoid (*enable_fd)(struct hnae3_handle *handle, bool enable);\n\tint (*add_arfs_entry)(struct hnae3_handle *handle, u16 queue_id,\n\t\t\t      u16 flow_id, struct flow_keys *fkeys);\n\tint (*dbg_read_cmd)(struct hnae3_handle *handle, enum hnae3_dbg_cmd cmd,\n\t\t\t    char *buf, int len);\n\tpci_ers_result_t (*handle_hw_ras_error)(struct hnae3_ae_dev *ae_dev);\n\tbool (*get_hw_reset_stat)(struct hnae3_handle *handle);\n\tbool (*ae_dev_resetting)(struct hnae3_handle *handle);\n\tunsigned long (*ae_dev_reset_cnt)(struct hnae3_handle *handle);\n\tint (*set_gro_en)(struct hnae3_handle *handle, bool enable);\n\tu16 (*get_global_queue_id)(struct hnae3_handle *handle, u16 queue_id);\n\tvoid (*set_timer_task)(struct hnae3_handle *handle, bool enable);\n\tint (*mac_connect_phy)(struct hnae3_handle *handle);\n\tvoid (*mac_disconnect_phy)(struct hnae3_handle *handle);\n\tint (*get_vf_config)(struct hnae3_handle *handle, int vf,\n\t\t\t     struct ifla_vf_info *ivf);\n\tint (*set_vf_link_state)(struct hnae3_handle *handle, int vf,\n\t\t\t\t int link_state);\n\tint (*set_vf_spoofchk)(struct hnae3_handle *handle, int vf,\n\t\t\t       bool enable);\n\tint (*set_vf_trust)(struct hnae3_handle *handle, int vf, bool enable);\n\tint (*set_vf_rate)(struct hnae3_handle *handle, int vf,\n\t\t\t   int min_tx_rate, int max_tx_rate, bool force);\n\tint (*set_vf_mac)(struct hnae3_handle *handle, int vf, u8 *p);\n\tint (*get_module_eeprom)(struct hnae3_handle *handle, u32 offset,\n\t\t\t\t u32 len, u8 *data);\n\tbool (*get_cmdq_stat)(struct hnae3_handle *handle);\n\tint (*add_cls_flower)(struct hnae3_handle *handle,\n\t\t\t      struct flow_cls_offload *cls_flower, int tc);\n\tint (*del_cls_flower)(struct hnae3_handle *handle,\n\t\t\t      struct flow_cls_offload *cls_flower);\n\tbool (*cls_flower_active)(struct hnae3_handle *handle);\n\tint (*get_phy_link_ksettings)(struct hnae3_handle *handle,\n\t\t\t\t      struct ethtool_link_ksettings *cmd);\n\tint (*set_phy_link_ksettings)(struct hnae3_handle *handle,\n\t\t\t\t      const struct ethtool_link_ksettings *cmd);\n\tbool (*set_tx_hwts_info)(struct hnae3_handle *handle,\n\t\t\t\t struct sk_buff *skb);\n\tvoid (*get_rx_hwts)(struct hnae3_handle *handle, struct sk_buff *skb,\n\t\t\t    u32 nsec, u32 sec);\n\tint (*get_ts_info)(struct hnae3_handle *handle,\n\t\t\t   struct ethtool_ts_info *info);\n\tint (*get_link_diagnosis_info)(struct hnae3_handle *handle,\n\t\t\t\t       u32 *status_code);\n\tvoid (*clean_vf_config)(struct hnae3_ae_dev *ae_dev, int num_vfs);\n\tint (*get_dscp_prio)(struct hnae3_handle *handle, u8 dscp,\n\t\t\t     u8 *tc_map_mode, u8 *priority);\n\tvoid (*get_wol)(struct hnae3_handle *handle,\n\t\t\tstruct ethtool_wolinfo *wol);\n\tint (*set_wol)(struct hnae3_handle *handle,\n\t\t       struct ethtool_wolinfo *wol);\n};\n\nstruct hnae3_dcb_ops {\n\t \n\tint (*ieee_getets)(struct hnae3_handle *, struct ieee_ets *);\n\tint (*ieee_setets)(struct hnae3_handle *, struct ieee_ets *);\n\tint (*ieee_getpfc)(struct hnae3_handle *, struct ieee_pfc *);\n\tint (*ieee_setpfc)(struct hnae3_handle *, struct ieee_pfc *);\n\tint (*ieee_setapp)(struct hnae3_handle *h, struct dcb_app *app);\n\tint (*ieee_delapp)(struct hnae3_handle *h, struct dcb_app *app);\n\n\t \n\tu8   (*getdcbx)(struct hnae3_handle *);\n\tu8   (*setdcbx)(struct hnae3_handle *, u8);\n\n\tint (*setup_tc)(struct hnae3_handle *handle,\n\t\t\tstruct tc_mqprio_qopt_offload *mqprio_qopt);\n};\n\nstruct hnae3_ae_algo {\n\tconst struct hnae3_ae_ops *ops;\n\tstruct list_head node;\n\tconst struct pci_device_id *pdev_id_table;\n};\n\n#define HNAE3_INT_NAME_LEN        32\n#define HNAE3_ITR_COUNTDOWN_START 100\n\n#define HNAE3_MAX_TC\t\t8\n#define HNAE3_MAX_USER_PRIO\t8\nstruct hnae3_tc_info {\n\tu8 prio_tc[HNAE3_MAX_USER_PRIO];  \n\tu16 tqp_count[HNAE3_MAX_TC];\n\tu16 tqp_offset[HNAE3_MAX_TC];\n\tu8 max_tc;  \n\tu8 num_tc;  \n\tbool mqprio_active;\n\tbool dcb_ets_active;\n};\n\n#define HNAE3_MAX_DSCP\t\t\t64\n#define HNAE3_PRIO_ID_INVALID\t\t0xff\nstruct hnae3_knic_private_info {\n\tstruct net_device *netdev;  \n\tu16 rss_size;\t\t    \n\tu16 req_rss_size;\n\tu16 rx_buf_len;\n\tu16 num_tx_desc;\n\tu16 num_rx_desc;\n\tu32 tx_spare_buf_size;\n\n\tstruct hnae3_tc_info tc_info;\n\tu8 tc_map_mode;\n\tu8 dscp_app_cnt;\n\tu8 dscp_prio[HNAE3_MAX_DSCP];\n\n\tu16 num_tqps;\t\t   \n\tstruct hnae3_queue **tqp;   \n\tconst struct hnae3_dcb_ops *dcb_ops;\n\n\tu16 int_rl_setting;\n\tvoid __iomem *io_base;\n};\n\nstruct hnae3_roce_private_info {\n\tstruct net_device *netdev;\n\tvoid __iomem *roce_io_base;\n\tvoid __iomem *roce_mem_base;\n\tint base_vector;\n\tint num_vectors;\n\n\t \n\tunsigned long reset_state;\n\tunsigned long instance_state;\n\tunsigned long state;\n};\n\n#define HNAE3_SUPPORT_APP_LOOPBACK    BIT(0)\n#define HNAE3_SUPPORT_PHY_LOOPBACK    BIT(1)\n#define HNAE3_SUPPORT_SERDES_SERIAL_LOOPBACK\tBIT(2)\n#define HNAE3_SUPPORT_VF\t      BIT(3)\n#define HNAE3_SUPPORT_SERDES_PARALLEL_LOOPBACK\tBIT(4)\n#define HNAE3_SUPPORT_EXTERNAL_LOOPBACK\tBIT(5)\n\n#define HNAE3_USER_UPE\t\tBIT(0)\t \n#define HNAE3_USER_MPE\t\tBIT(1)\t \n#define HNAE3_BPE\t\tBIT(2)\t \n#define HNAE3_OVERFLOW_UPE\tBIT(3)\t \n#define HNAE3_OVERFLOW_MPE\tBIT(4)\t \n#define HNAE3_UPE\t\t(HNAE3_USER_UPE | HNAE3_OVERFLOW_UPE)\n#define HNAE3_MPE\t\t(HNAE3_USER_MPE | HNAE3_OVERFLOW_MPE)\n\nenum hnae3_pflag {\n\tHNAE3_PFLAG_LIMIT_PROMISC,\n\tHNAE3_PFLAG_MAX\n};\n\nstruct hnae3_handle {\n\tstruct hnae3_client *client;\n\tstruct pci_dev *pdev;\n\tvoid *priv;\n\tstruct hnae3_ae_algo *ae_algo;   \n\tu64 flags;  \n\n\tunion {\n\t\tstruct net_device *netdev;  \n\t\tstruct hnae3_knic_private_info kinfo;\n\t\tstruct hnae3_roce_private_info rinfo;\n\t};\n\n\tu32 numa_node_mask;\t \n\n\tenum hnae3_port_base_vlan_state port_base_vlan_state;\n\n\tu8 netdev_flags;\n\tstruct dentry *hnae3_dbgfs;\n\t \n\tstruct mutex dbgfs_lock;\n\tchar **dbgfs_buf;\n\n\t \n\tu32 msg_enable;\n\n\tunsigned long supported_pflags;\n\tunsigned long priv_flags;\n};\n\n#define hnae3_set_field(origin, mask, shift, val) \\\n\tdo { \\\n\t\t(origin) &= (~(mask)); \\\n\t\t(origin) |= ((val) << (shift)) & (mask); \\\n\t} while (0)\n#define hnae3_get_field(origin, mask, shift) (((origin) & (mask)) >> (shift))\n\n#define hnae3_set_bit(origin, shift, val) \\\n\thnae3_set_field(origin, 0x1 << (shift), shift, val)\n#define hnae3_get_bit(origin, shift) \\\n\thnae3_get_field(origin, 0x1 << (shift), shift)\n\n#define HNAE3_FORMAT_MAC_ADDR_LEN\t18\n#define HNAE3_FORMAT_MAC_ADDR_OFFSET_0\t0\n#define HNAE3_FORMAT_MAC_ADDR_OFFSET_4\t4\n#define HNAE3_FORMAT_MAC_ADDR_OFFSET_5\t5\n\nstatic inline void hnae3_format_mac_addr(char *format_mac_addr,\n\t\t\t\t\t const u8 *mac_addr)\n{\n\tsnprintf(format_mac_addr, HNAE3_FORMAT_MAC_ADDR_LEN, \"%02x:**:**:**:%02x:%02x\",\n\t\t mac_addr[HNAE3_FORMAT_MAC_ADDR_OFFSET_0],\n\t\t mac_addr[HNAE3_FORMAT_MAC_ADDR_OFFSET_4],\n\t\t mac_addr[HNAE3_FORMAT_MAC_ADDR_OFFSET_5]);\n}\n\nint hnae3_register_ae_dev(struct hnae3_ae_dev *ae_dev);\nvoid hnae3_unregister_ae_dev(struct hnae3_ae_dev *ae_dev);\n\nvoid hnae3_unregister_ae_algo_prepare(struct hnae3_ae_algo *ae_algo);\nvoid hnae3_unregister_ae_algo(struct hnae3_ae_algo *ae_algo);\nvoid hnae3_register_ae_algo(struct hnae3_ae_algo *ae_algo);\n\nvoid hnae3_unregister_client(struct hnae3_client *client);\nint hnae3_register_client(struct hnae3_client *client);\n\nvoid hnae3_set_client_init_flag(struct hnae3_client *client,\n\t\t\t\tstruct hnae3_ae_dev *ae_dev,\n\t\t\t\tunsigned int inited);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}