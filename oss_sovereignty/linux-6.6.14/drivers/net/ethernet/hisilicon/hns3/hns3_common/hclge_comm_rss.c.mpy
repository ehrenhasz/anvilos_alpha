{
  "module_name": "hclge_comm_rss.c",
  "hash_id": "2a0b14dbfc638452d846d69974f7933b3a6e07c91bfeaf4ded3157a992bb4c57",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hns3_common/hclge_comm_rss.c",
  "human_readable_source": "\n\n#include <linux/skbuff.h>\n\n#include \"hnae3.h\"\n#include \"hclge_comm_cmd.h\"\n#include \"hclge_comm_rss.h\"\n\nstatic const u8 hclge_comm_hash_key[] = {\n\t0x6D, 0x5A, 0x56, 0xDA, 0x25, 0x5B, 0x0E, 0xC2,\n\t0x41, 0x67, 0x25, 0x3D, 0x43, 0xA3, 0x8F, 0xB0,\n\t0xD0, 0xCA, 0x2B, 0xCB, 0xAE, 0x7B, 0x30, 0xB4,\n\t0x77, 0xCB, 0x2D, 0xA3, 0x80, 0x30, 0xF2, 0x0C,\n\t0x6A, 0x42, 0xB7, 0x3B, 0xBE, 0xAC, 0x01, 0xFA\n};\n\nstatic void\nhclge_comm_init_rss_tuple(struct hnae3_ae_dev *ae_dev,\n\t\t\t  struct hclge_comm_rss_tuple_cfg *rss_tuple_cfg)\n{\n\trss_tuple_cfg->ipv4_tcp_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\trss_tuple_cfg->ipv4_udp_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\trss_tuple_cfg->ipv4_sctp_en = HCLGE_COMM_RSS_INPUT_TUPLE_SCTP;\n\trss_tuple_cfg->ipv4_fragment_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\trss_tuple_cfg->ipv6_tcp_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\trss_tuple_cfg->ipv6_udp_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\trss_tuple_cfg->ipv6_sctp_en =\n\t\tae_dev->dev_version <= HNAE3_DEVICE_VERSION_V2 ?\n\t\tHCLGE_COMM_RSS_INPUT_TUPLE_SCTP_NO_PORT :\n\t\tHCLGE_COMM_RSS_INPUT_TUPLE_SCTP;\n\trss_tuple_cfg->ipv6_fragment_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n}\n\nint hclge_comm_rss_init_cfg(struct hnae3_handle *nic,\n\t\t\t    struct hnae3_ae_dev *ae_dev,\n\t\t\t    struct hclge_comm_rss_cfg *rss_cfg)\n{\n\tu16 rss_ind_tbl_size = ae_dev->dev_specs.rss_ind_tbl_size;\n\tint rss_algo = HCLGE_COMM_RSS_HASH_ALGO_TOEPLITZ;\n\tu16 *rss_ind_tbl;\n\n\tif (nic->flags & HNAE3_SUPPORT_VF)\n\t\trss_cfg->rss_size = nic->kinfo.rss_size;\n\n\tif (ae_dev->dev_version >= HNAE3_DEVICE_VERSION_V2)\n\t\trss_algo = HCLGE_COMM_RSS_HASH_ALGO_SIMPLE;\n\n\thclge_comm_init_rss_tuple(ae_dev, &rss_cfg->rss_tuple_sets);\n\n\trss_cfg->rss_algo = rss_algo;\n\n\trss_ind_tbl = devm_kcalloc(&ae_dev->pdev->dev, rss_ind_tbl_size,\n\t\t\t\t   sizeof(*rss_ind_tbl), GFP_KERNEL);\n\tif (!rss_ind_tbl)\n\t\treturn -ENOMEM;\n\n\trss_cfg->rss_indirection_tbl = rss_ind_tbl;\n\tmemcpy(rss_cfg->rss_hash_key, hclge_comm_hash_key,\n\t       HCLGE_COMM_RSS_KEY_SIZE);\n\n\thclge_comm_rss_indir_init_cfg(ae_dev, rss_cfg);\n\n\treturn 0;\n}\n\nvoid hclge_comm_get_rss_tc_info(u16 rss_size, u8 hw_tc_map, u16 *tc_offset,\n\t\t\t\tu16 *tc_valid, u16 *tc_size)\n{\n\tu16 roundup_size;\n\tu32 i;\n\n\troundup_size = roundup_pow_of_two(rss_size);\n\troundup_size = ilog2(roundup_size);\n\n\tfor (i = 0; i < HCLGE_COMM_MAX_TC_NUM; i++) {\n\t\ttc_valid[i] = 1;\n\t\ttc_size[i] = roundup_size;\n\t\ttc_offset[i] = (hw_tc_map & BIT(i)) ? rss_size * i : 0;\n\t}\n}\n\nint hclge_comm_set_rss_tc_mode(struct hclge_comm_hw *hw, u16 *tc_offset,\n\t\t\t       u16 *tc_valid, u16 *tc_size)\n{\n\tstruct hclge_comm_rss_tc_mode_cmd *req;\n\tstruct hclge_desc desc;\n\tunsigned int i;\n\tint ret;\n\n\treq = (struct hclge_comm_rss_tc_mode_cmd *)desc.data;\n\n\thclge_comm_cmd_setup_basic_desc(&desc, HCLGE_OPC_RSS_TC_MODE, false);\n\tfor (i = 0; i < HCLGE_COMM_MAX_TC_NUM; i++) {\n\t\tu16 mode = 0;\n\n\t\thnae3_set_bit(mode, HCLGE_COMM_RSS_TC_VALID_B,\n\t\t\t      (tc_valid[i] & 0x1));\n\t\thnae3_set_field(mode, HCLGE_COMM_RSS_TC_SIZE_M,\n\t\t\t\tHCLGE_COMM_RSS_TC_SIZE_S, tc_size[i]);\n\t\thnae3_set_bit(mode, HCLGE_COMM_RSS_TC_SIZE_MSB_B,\n\t\t\t      tc_size[i] >> HCLGE_COMM_RSS_TC_SIZE_MSB_OFFSET &\n\t\t\t      0x1);\n\t\thnae3_set_field(mode, HCLGE_COMM_RSS_TC_OFFSET_M,\n\t\t\t\tHCLGE_COMM_RSS_TC_OFFSET_S, tc_offset[i]);\n\n\t\treq->rss_tc_mode[i] = cpu_to_le16(mode);\n\t}\n\n\tret = hclge_comm_cmd_send(hw, &desc, 1);\n\tif (ret)\n\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\"failed to set rss tc mode, ret = %d.\\n\", ret);\n\n\treturn ret;\n}\n\nint hclge_comm_set_rss_hash_key(struct hclge_comm_rss_cfg *rss_cfg,\n\t\t\t\tstruct hclge_comm_hw *hw, const u8 *key,\n\t\t\t\tconst u8 hfunc)\n{\n\tu8 hash_algo;\n\tint ret;\n\n\tret = hclge_comm_parse_rss_hfunc(rss_cfg, hfunc, &hash_algo);\n\tif (ret)\n\t\treturn ret;\n\n\t \n\tif (key) {\n\t\tret = hclge_comm_set_rss_algo_key(hw, hash_algo, key);\n\t\tif (ret)\n\t\t\treturn ret;\n\n\t\t \n\t\tmemcpy(rss_cfg->rss_hash_key, key, HCLGE_COMM_RSS_KEY_SIZE);\n\t} else {\n\t\tret = hclge_comm_set_rss_algo_key(hw, hash_algo,\n\t\t\t\t\t\t  rss_cfg->rss_hash_key);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\trss_cfg->rss_algo = hash_algo;\n\n\treturn 0;\n}\n\nint hclge_comm_set_rss_tuple(struct hnae3_ae_dev *ae_dev,\n\t\t\t     struct hclge_comm_hw *hw,\n\t\t\t     struct hclge_comm_rss_cfg *rss_cfg,\n\t\t\t     struct ethtool_rxnfc *nfc)\n{\n\tstruct hclge_comm_rss_input_tuple_cmd *req;\n\tstruct hclge_desc desc;\n\tint ret;\n\n\tif (nfc->data &\n\t    ~(RXH_IP_SRC | RXH_IP_DST | RXH_L4_B_0_1 | RXH_L4_B_2_3))\n\t\treturn -EINVAL;\n\n\treq = (struct hclge_comm_rss_input_tuple_cmd *)desc.data;\n\thclge_comm_cmd_setup_basic_desc(&desc, HCLGE_OPC_RSS_INPUT_TUPLE,\n\t\t\t\t\tfalse);\n\n\tret = hclge_comm_init_rss_tuple_cmd(rss_cfg, nfc, ae_dev, req);\n\tif (ret) {\n\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\"failed to init rss tuple cmd, ret = %d.\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = hclge_comm_cmd_send(hw, &desc, 1);\n\tif (ret) {\n\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\"failed to set rss tuple, ret = %d.\\n\", ret);\n\t\treturn ret;\n\t}\n\n\trss_cfg->rss_tuple_sets.ipv4_tcp_en = req->ipv4_tcp_en;\n\trss_cfg->rss_tuple_sets.ipv4_udp_en = req->ipv4_udp_en;\n\trss_cfg->rss_tuple_sets.ipv4_sctp_en = req->ipv4_sctp_en;\n\trss_cfg->rss_tuple_sets.ipv4_fragment_en = req->ipv4_fragment_en;\n\trss_cfg->rss_tuple_sets.ipv6_tcp_en = req->ipv6_tcp_en;\n\trss_cfg->rss_tuple_sets.ipv6_udp_en = req->ipv6_udp_en;\n\trss_cfg->rss_tuple_sets.ipv6_sctp_en = req->ipv6_sctp_en;\n\trss_cfg->rss_tuple_sets.ipv6_fragment_en = req->ipv6_fragment_en;\n\treturn 0;\n}\n\nu32 hclge_comm_get_rss_key_size(struct hnae3_handle *handle)\n{\n\treturn HCLGE_COMM_RSS_KEY_SIZE;\n}\n\nint hclge_comm_parse_rss_hfunc(struct hclge_comm_rss_cfg *rss_cfg,\n\t\t\t       const u8 hfunc, u8 *hash_algo)\n{\n\tswitch (hfunc) {\n\tcase ETH_RSS_HASH_TOP:\n\t\t*hash_algo = HCLGE_COMM_RSS_HASH_ALGO_TOEPLITZ;\n\t\treturn 0;\n\tcase ETH_RSS_HASH_XOR:\n\t\t*hash_algo = HCLGE_COMM_RSS_HASH_ALGO_SIMPLE;\n\t\treturn 0;\n\tcase ETH_RSS_HASH_NO_CHANGE:\n\t\t*hash_algo = rss_cfg->rss_algo;\n\t\treturn 0;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\nvoid hclge_comm_rss_indir_init_cfg(struct hnae3_ae_dev *ae_dev,\n\t\t\t\t   struct hclge_comm_rss_cfg *rss_cfg)\n{\n\tu16 i;\n\t \n\tfor (i = 0; i < ae_dev->dev_specs.rss_ind_tbl_size; i++)\n\t\trss_cfg->rss_indirection_tbl[i] = i % rss_cfg->rss_size;\n}\n\nint hclge_comm_get_rss_tuple(struct hclge_comm_rss_cfg *rss_cfg, int flow_type,\n\t\t\t     u8 *tuple_sets)\n{\n\tswitch (flow_type) {\n\tcase TCP_V4_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv4_tcp_en;\n\t\tbreak;\n\tcase UDP_V4_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv4_udp_en;\n\t\tbreak;\n\tcase TCP_V6_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv6_tcp_en;\n\t\tbreak;\n\tcase UDP_V6_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv6_udp_en;\n\t\tbreak;\n\tcase SCTP_V4_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv4_sctp_en;\n\t\tbreak;\n\tcase SCTP_V6_FLOW:\n\t\t*tuple_sets = rss_cfg->rss_tuple_sets.ipv6_sctp_en;\n\t\tbreak;\n\tcase IPV4_FLOW:\n\tcase IPV6_FLOW:\n\t\t*tuple_sets = HCLGE_COMM_S_IP_BIT | HCLGE_COMM_D_IP_BIT;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nstatic void\nhclge_comm_append_rss_msb_info(struct hclge_comm_rss_ind_tbl_cmd *req,\n\t\t\t       u16 qid, u32 j)\n{\n\tu8 rss_msb_oft;\n\tu8 rss_msb_val;\n\n\trss_msb_oft =\n\t\tj * HCLGE_COMM_RSS_CFG_TBL_BW_H / BITS_PER_BYTE;\n\trss_msb_val = (qid >> HCLGE_COMM_RSS_CFG_TBL_BW_L & 0x1) <<\n\t\t(j * HCLGE_COMM_RSS_CFG_TBL_BW_H % BITS_PER_BYTE);\n\treq->rss_qid_h[rss_msb_oft] |= rss_msb_val;\n}\n\nint hclge_comm_set_rss_indir_table(struct hnae3_ae_dev *ae_dev,\n\t\t\t\t   struct hclge_comm_hw *hw, const u16 *indir)\n{\n\tstruct hclge_comm_rss_ind_tbl_cmd *req;\n\tstruct hclge_desc desc;\n\tu16 rss_cfg_tbl_num;\n\tint ret;\n\tu16 qid;\n\tu16 i;\n\tu32 j;\n\n\treq = (struct hclge_comm_rss_ind_tbl_cmd *)desc.data;\n\trss_cfg_tbl_num = ae_dev->dev_specs.rss_ind_tbl_size /\n\t\t\t  HCLGE_COMM_RSS_CFG_TBL_SIZE;\n\n\tfor (i = 0; i < rss_cfg_tbl_num; i++) {\n\t\thclge_comm_cmd_setup_basic_desc(&desc,\n\t\t\t\t\t\tHCLGE_OPC_RSS_INDIR_TABLE,\n\t\t\t\t\t\tfalse);\n\n\t\treq->start_table_index =\n\t\t\tcpu_to_le16(i * HCLGE_COMM_RSS_CFG_TBL_SIZE);\n\t\treq->rss_set_bitmap =\n\t\t\tcpu_to_le16(HCLGE_COMM_RSS_SET_BITMAP_MSK);\n\t\tfor (j = 0; j < HCLGE_COMM_RSS_CFG_TBL_SIZE; j++) {\n\t\t\tqid = indir[i * HCLGE_COMM_RSS_CFG_TBL_SIZE + j];\n\t\t\treq->rss_qid_l[j] = qid & 0xff;\n\t\t\thclge_comm_append_rss_msb_info(req, qid, j);\n\t\t}\n\t\tret = hclge_comm_cmd_send(hw, &desc, 1);\n\t\tif (ret) {\n\t\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\t\"failed to configure rss table, ret = %d.\\n\",\n\t\t\t\tret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\treturn 0;\n}\n\nint hclge_comm_set_rss_input_tuple(struct hclge_comm_hw *hw,\n\t\t\t\t   struct hclge_comm_rss_cfg *rss_cfg)\n{\n\tstruct hclge_comm_rss_input_tuple_cmd *req;\n\tstruct hclge_desc desc;\n\tint ret;\n\n\thclge_comm_cmd_setup_basic_desc(&desc, HCLGE_OPC_RSS_INPUT_TUPLE,\n\t\t\t\t\tfalse);\n\n\treq = (struct hclge_comm_rss_input_tuple_cmd *)desc.data;\n\n\treq->ipv4_tcp_en = rss_cfg->rss_tuple_sets.ipv4_tcp_en;\n\treq->ipv4_udp_en = rss_cfg->rss_tuple_sets.ipv4_udp_en;\n\treq->ipv4_sctp_en = rss_cfg->rss_tuple_sets.ipv4_sctp_en;\n\treq->ipv4_fragment_en = rss_cfg->rss_tuple_sets.ipv4_fragment_en;\n\treq->ipv6_tcp_en = rss_cfg->rss_tuple_sets.ipv6_tcp_en;\n\treq->ipv6_udp_en = rss_cfg->rss_tuple_sets.ipv6_udp_en;\n\treq->ipv6_sctp_en = rss_cfg->rss_tuple_sets.ipv6_sctp_en;\n\treq->ipv6_fragment_en = rss_cfg->rss_tuple_sets.ipv6_fragment_en;\n\n\tret = hclge_comm_cmd_send(hw, &desc, 1);\n\tif (ret)\n\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\"failed to configure rss input, ret = %d.\\n\", ret);\n\treturn ret;\n}\n\nvoid hclge_comm_get_rss_hash_info(struct hclge_comm_rss_cfg *rss_cfg, u8 *key,\n\t\t\t\t  u8 *hfunc)\n{\n\t \n\tif (hfunc) {\n\t\tswitch (rss_cfg->rss_algo) {\n\t\tcase HCLGE_COMM_RSS_HASH_ALGO_TOEPLITZ:\n\t\t\t*hfunc = ETH_RSS_HASH_TOP;\n\t\t\tbreak;\n\t\tcase HCLGE_COMM_RSS_HASH_ALGO_SIMPLE:\n\t\t\t*hfunc = ETH_RSS_HASH_XOR;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t*hfunc = ETH_RSS_HASH_UNKNOWN;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t \n\tif (key)\n\t\tmemcpy(key, rss_cfg->rss_hash_key, HCLGE_COMM_RSS_KEY_SIZE);\n}\n\nvoid hclge_comm_get_rss_indir_tbl(struct hclge_comm_rss_cfg *rss_cfg,\n\t\t\t\t  u32 *indir, u16 rss_ind_tbl_size)\n{\n\tu16 i;\n\n\tif (!indir)\n\t\treturn;\n\n\tfor (i = 0; i < rss_ind_tbl_size; i++)\n\t\tindir[i] = rss_cfg->rss_indirection_tbl[i];\n}\n\nint hclge_comm_set_rss_algo_key(struct hclge_comm_hw *hw, const u8 hfunc,\n\t\t\t\tconst u8 *key)\n{\n\tstruct hclge_comm_rss_config_cmd *req;\n\tunsigned int key_offset = 0;\n\tstruct hclge_desc desc;\n\tint key_counts;\n\tint key_size;\n\tint ret;\n\n\tkey_counts = HCLGE_COMM_RSS_KEY_SIZE;\n\treq = (struct hclge_comm_rss_config_cmd *)desc.data;\n\n\twhile (key_counts) {\n\t\thclge_comm_cmd_setup_basic_desc(&desc,\n\t\t\t\t\t\tHCLGE_OPC_RSS_GENERIC_CONFIG,\n\t\t\t\t\t\tfalse);\n\n\t\treq->hash_config |= (hfunc & HCLGE_COMM_RSS_HASH_ALGO_MASK);\n\t\treq->hash_config |=\n\t\t\t(key_offset << HCLGE_COMM_RSS_HASH_KEY_OFFSET_B);\n\n\t\tkey_size = min(HCLGE_COMM_RSS_HASH_KEY_NUM, key_counts);\n\t\tmemcpy(req->hash_key,\n\t\t       key + key_offset * HCLGE_COMM_RSS_HASH_KEY_NUM,\n\t\t       key_size);\n\n\t\tkey_counts -= key_size;\n\t\tkey_offset++;\n\t\tret = hclge_comm_cmd_send(hw, &desc, 1);\n\t\tif (ret) {\n\t\t\tdev_err(&hw->cmq.csq.pdev->dev,\n\t\t\t\t\"failed to configure RSS key, ret = %d.\\n\",\n\t\t\t\tret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic u8 hclge_comm_get_rss_hash_bits(struct ethtool_rxnfc *nfc)\n{\n\tu8 hash_sets = nfc->data & RXH_L4_B_0_1 ? HCLGE_COMM_S_PORT_BIT : 0;\n\n\tif (nfc->data & RXH_L4_B_2_3)\n\t\thash_sets |= HCLGE_COMM_D_PORT_BIT;\n\telse\n\t\thash_sets &= ~HCLGE_COMM_D_PORT_BIT;\n\n\tif (nfc->data & RXH_IP_SRC)\n\t\thash_sets |= HCLGE_COMM_S_IP_BIT;\n\telse\n\t\thash_sets &= ~HCLGE_COMM_S_IP_BIT;\n\n\tif (nfc->data & RXH_IP_DST)\n\t\thash_sets |= HCLGE_COMM_D_IP_BIT;\n\telse\n\t\thash_sets &= ~HCLGE_COMM_D_IP_BIT;\n\n\tif (nfc->flow_type == SCTP_V4_FLOW || nfc->flow_type == SCTP_V6_FLOW)\n\t\thash_sets |= HCLGE_COMM_V_TAG_BIT;\n\n\treturn hash_sets;\n}\n\nint hclge_comm_init_rss_tuple_cmd(struct hclge_comm_rss_cfg *rss_cfg,\n\t\t\t\t  struct ethtool_rxnfc *nfc,\n\t\t\t\t  struct hnae3_ae_dev *ae_dev,\n\t\t\t\t  struct hclge_comm_rss_input_tuple_cmd *req)\n{\n\tu8 tuple_sets;\n\n\treq->ipv4_tcp_en = rss_cfg->rss_tuple_sets.ipv4_tcp_en;\n\treq->ipv4_udp_en = rss_cfg->rss_tuple_sets.ipv4_udp_en;\n\treq->ipv4_sctp_en = rss_cfg->rss_tuple_sets.ipv4_sctp_en;\n\treq->ipv4_fragment_en = rss_cfg->rss_tuple_sets.ipv4_fragment_en;\n\treq->ipv6_tcp_en = rss_cfg->rss_tuple_sets.ipv6_tcp_en;\n\treq->ipv6_udp_en = rss_cfg->rss_tuple_sets.ipv6_udp_en;\n\treq->ipv6_sctp_en = rss_cfg->rss_tuple_sets.ipv6_sctp_en;\n\treq->ipv6_fragment_en = rss_cfg->rss_tuple_sets.ipv6_fragment_en;\n\n\ttuple_sets = hclge_comm_get_rss_hash_bits(nfc);\n\tswitch (nfc->flow_type) {\n\tcase TCP_V4_FLOW:\n\t\treq->ipv4_tcp_en = tuple_sets;\n\t\tbreak;\n\tcase TCP_V6_FLOW:\n\t\treq->ipv6_tcp_en = tuple_sets;\n\t\tbreak;\n\tcase UDP_V4_FLOW:\n\t\treq->ipv4_udp_en = tuple_sets;\n\t\tbreak;\n\tcase UDP_V6_FLOW:\n\t\treq->ipv6_udp_en = tuple_sets;\n\t\tbreak;\n\tcase SCTP_V4_FLOW:\n\t\treq->ipv4_sctp_en = tuple_sets;\n\t\tbreak;\n\tcase SCTP_V6_FLOW:\n\t\tif (ae_dev->dev_version <= HNAE3_DEVICE_VERSION_V2 &&\n\t\t    (nfc->data & (RXH_L4_B_0_1 | RXH_L4_B_2_3)))\n\t\t\treturn -EINVAL;\n\n\t\treq->ipv6_sctp_en = tuple_sets;\n\t\tbreak;\n\tcase IPV4_FLOW:\n\t\treq->ipv4_fragment_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\t\tbreak;\n\tcase IPV6_FLOW:\n\t\treq->ipv6_fragment_en = HCLGE_COMM_RSS_INPUT_TUPLE_OTHER;\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nu64 hclge_comm_convert_rss_tuple(u8 tuple_sets)\n{\n\tu64 tuple_data = 0;\n\n\tif (tuple_sets & HCLGE_COMM_D_PORT_BIT)\n\t\ttuple_data |= RXH_L4_B_2_3;\n\tif (tuple_sets & HCLGE_COMM_S_PORT_BIT)\n\t\ttuple_data |= RXH_L4_B_0_1;\n\tif (tuple_sets & HCLGE_COMM_D_IP_BIT)\n\t\ttuple_data |= RXH_IP_DST;\n\tif (tuple_sets & HCLGE_COMM_S_IP_BIT)\n\t\ttuple_data |= RXH_IP_SRC;\n\n\treturn tuple_data;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}