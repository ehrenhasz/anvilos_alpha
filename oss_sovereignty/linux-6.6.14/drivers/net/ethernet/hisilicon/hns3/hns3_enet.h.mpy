{
  "module_name": "hns3_enet.h",
  "hash_id": "774a10bebee281a55b3497a9946aa67ed1afe3a33cada5b2df216afd4d37de18",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hns3_enet.h",
  "human_readable_source": " \n\n\n#ifndef __HNS3_ENET_H\n#define __HNS3_ENET_H\n\n#include <linux/dim.h>\n#include <linux/if_vlan.h>\n#include <net/page_pool/types.h>\n#include <asm/barrier.h>\n\n#include \"hnae3.h\"\n\nstruct iphdr;\nstruct ipv6hdr;\n\nenum hns3_nic_state {\n\tHNS3_NIC_STATE_TESTING,\n\tHNS3_NIC_STATE_RESETTING,\n\tHNS3_NIC_STATE_INITED,\n\tHNS3_NIC_STATE_DOWN,\n\tHNS3_NIC_STATE_DISABLED,\n\tHNS3_NIC_STATE_REMOVING,\n\tHNS3_NIC_STATE_SERVICE_INITED,\n\tHNS3_NIC_STATE_SERVICE_SCHED,\n\tHNS3_NIC_STATE2_RESET_REQUESTED,\n\tHNS3_NIC_STATE_HW_TX_CSUM_ENABLE,\n\tHNS3_NIC_STATE_RXD_ADV_LAYOUT_ENABLE,\n\tHNS3_NIC_STATE_TX_PUSH_ENABLE,\n\tHNS3_NIC_STATE_MAX\n};\n\n#define HNS3_MAX_PUSH_BD_NUM\t\t2\n\n#define HNS3_RING_RX_RING_BASEADDR_L_REG\t0x00000\n#define HNS3_RING_RX_RING_BASEADDR_H_REG\t0x00004\n#define HNS3_RING_RX_RING_BD_NUM_REG\t\t0x00008\n#define HNS3_RING_RX_RING_BD_LEN_REG\t\t0x0000C\n#define HNS3_RING_RX_RING_TAIL_REG\t\t0x00018\n#define HNS3_RING_RX_RING_HEAD_REG\t\t0x0001C\n#define HNS3_RING_RX_RING_FBDNUM_REG\t\t0x00020\n#define HNS3_RING_RX_RING_PKTNUM_RECORD_REG\t0x0002C\n\n#define HNS3_RING_TX_RING_BASEADDR_L_REG\t0x00040\n#define HNS3_RING_TX_RING_BASEADDR_H_REG\t0x00044\n#define HNS3_RING_TX_RING_BD_NUM_REG\t\t0x00048\n#define HNS3_RING_TX_RING_TC_REG\t\t0x00050\n#define HNS3_RING_TX_RING_TAIL_REG\t\t0x00058\n#define HNS3_RING_TX_RING_HEAD_REG\t\t0x0005C\n#define HNS3_RING_TX_RING_FBDNUM_REG\t\t0x00060\n#define HNS3_RING_TX_RING_OFFSET_REG\t\t0x00064\n#define HNS3_RING_TX_RING_EBDNUM_REG\t\t0x00068\n#define HNS3_RING_TX_RING_PKTNUM_RECORD_REG\t0x0006C\n#define HNS3_RING_TX_RING_EBD_OFFSET_REG\t0x00070\n#define HNS3_RING_TX_RING_BD_ERR_REG\t\t0x00074\n#define HNS3_RING_EN_REG\t\t\t0x00090\n#define HNS3_RING_RX_EN_REG\t\t\t0x00098\n#define HNS3_RING_TX_EN_REG\t\t\t0x000D4\n\n#define HNS3_RX_HEAD_SIZE\t\t\t256\n\n#define HNS3_TX_TIMEOUT (5 * HZ)\n#define HNS3_RING_NAME_LEN\t\t\t16\n#define HNS3_BUFFER_SIZE_2048\t\t\t2048\n#define HNS3_RING_MAX_PENDING\t\t\t32760\n#define HNS3_RING_MIN_PENDING\t\t\t72\n#define HNS3_RING_BD_MULTIPLE\t\t\t8\n \n#define HNS3_MAX_MTU(max_frm_size) \\\n\t((max_frm_size) - (ETH_HLEN + ETH_FCS_LEN + 2 * VLAN_HLEN))\n\n#define HNS3_BD_SIZE_512_TYPE\t\t\t0\n#define HNS3_BD_SIZE_1024_TYPE\t\t\t1\n#define HNS3_BD_SIZE_2048_TYPE\t\t\t2\n#define HNS3_BD_SIZE_4096_TYPE\t\t\t3\n\n#define HNS3_RX_FLAG_VLAN_PRESENT\t\t0x1\n#define HNS3_RX_FLAG_L3ID_IPV4\t\t\t0x0\n#define HNS3_RX_FLAG_L3ID_IPV6\t\t\t0x1\n#define HNS3_RX_FLAG_L4ID_UDP\t\t\t0x0\n#define HNS3_RX_FLAG_L4ID_TCP\t\t\t0x1\n\n#define HNS3_RXD_DMAC_S\t\t\t\t0\n#define HNS3_RXD_DMAC_M\t\t\t\t(0x3 << HNS3_RXD_DMAC_S)\n#define HNS3_RXD_VLAN_S\t\t\t\t2\n#define HNS3_RXD_VLAN_M\t\t\t\t(0x3 << HNS3_RXD_VLAN_S)\n#define HNS3_RXD_L3ID_S\t\t\t\t4\n#define HNS3_RXD_L3ID_M\t\t\t\t(0xf << HNS3_RXD_L3ID_S)\n#define HNS3_RXD_L4ID_S\t\t\t\t8\n#define HNS3_RXD_L4ID_M\t\t\t\t(0xf << HNS3_RXD_L4ID_S)\n#define HNS3_RXD_FRAG_B\t\t\t\t12\n#define HNS3_RXD_STRP_TAGP_S\t\t\t13\n#define HNS3_RXD_STRP_TAGP_M\t\t\t(0x3 << HNS3_RXD_STRP_TAGP_S)\n\n#define HNS3_RXD_L2E_B\t\t\t\t16\n#define HNS3_RXD_L3E_B\t\t\t\t17\n#define HNS3_RXD_L4E_B\t\t\t\t18\n#define HNS3_RXD_TRUNCAT_B\t\t\t19\n#define HNS3_RXD_HOI_B\t\t\t\t20\n#define HNS3_RXD_DOI_B\t\t\t\t21\n#define HNS3_RXD_OL3E_B\t\t\t\t22\n#define HNS3_RXD_OL4E_B\t\t\t\t23\n#define HNS3_RXD_GRO_COUNT_S\t\t\t24\n#define HNS3_RXD_GRO_COUNT_M\t\t\t(0x3f << HNS3_RXD_GRO_COUNT_S)\n#define HNS3_RXD_GRO_FIXID_B\t\t\t30\n#define HNS3_RXD_GRO_ECN_B\t\t\t31\n\n#define HNS3_RXD_ODMAC_S\t\t\t0\n#define HNS3_RXD_ODMAC_M\t\t\t(0x3 << HNS3_RXD_ODMAC_S)\n#define HNS3_RXD_OVLAN_S\t\t\t2\n#define HNS3_RXD_OVLAN_M\t\t\t(0x3 << HNS3_RXD_OVLAN_S)\n#define HNS3_RXD_OL3ID_S\t\t\t4\n#define HNS3_RXD_OL3ID_M\t\t\t(0xf << HNS3_RXD_OL3ID_S)\n#define HNS3_RXD_OL4ID_S\t\t\t8\n#define HNS3_RXD_OL4ID_M\t\t\t(0xf << HNS3_RXD_OL4ID_S)\n#define HNS3_RXD_FBHI_S\t\t\t\t12\n#define HNS3_RXD_FBHI_M\t\t\t\t(0x3 << HNS3_RXD_FBHI_S)\n#define HNS3_RXD_FBLI_S\t\t\t\t14\n#define HNS3_RXD_FBLI_M\t\t\t\t(0x3 << HNS3_RXD_FBLI_S)\n\n#define HNS3_RXD_PTYPE_S\t\t\t4\n#define HNS3_RXD_PTYPE_M\t\t\tGENMASK(11, 4)\n\n#define HNS3_RXD_BDTYPE_S\t\t\t0\n#define HNS3_RXD_BDTYPE_M\t\t\t(0xf << HNS3_RXD_BDTYPE_S)\n#define HNS3_RXD_VLD_B\t\t\t\t4\n#define HNS3_RXD_UDP0_B\t\t\t\t5\n#define HNS3_RXD_EXTEND_B\t\t\t7\n#define HNS3_RXD_FE_B\t\t\t\t8\n#define HNS3_RXD_LUM_B\t\t\t\t9\n#define HNS3_RXD_CRCP_B\t\t\t\t10\n#define HNS3_RXD_L3L4P_B\t\t\t11\n#define HNS3_RXD_TSIDX_S\t\t\t12\n#define HNS3_RXD_TSIDX_M\t\t\t(0x3 << HNS3_RXD_TSIDX_S)\n#define HNS3_RXD_TS_VLD_B\t\t\t14\n#define HNS3_RXD_LKBK_B\t\t\t\t15\n#define HNS3_RXD_GRO_SIZE_S\t\t\t16\n#define HNS3_RXD_GRO_SIZE_M\t\t\t(0x3fff << HNS3_RXD_GRO_SIZE_S)\n\n#define HNS3_TXD_L3T_S\t\t\t\t0\n#define HNS3_TXD_L3T_M\t\t\t\t(0x3 << HNS3_TXD_L3T_S)\n#define HNS3_TXD_L4T_S\t\t\t\t2\n#define HNS3_TXD_L4T_M\t\t\t\t(0x3 << HNS3_TXD_L4T_S)\n#define HNS3_TXD_L3CS_B\t\t\t\t4\n#define HNS3_TXD_L4CS_B\t\t\t\t5\n#define HNS3_TXD_VLAN_B\t\t\t\t6\n#define HNS3_TXD_TSO_B\t\t\t\t7\n\n#define HNS3_TXD_L2LEN_S\t\t\t8\n#define HNS3_TXD_L2LEN_M\t\t\t(0xff << HNS3_TXD_L2LEN_S)\n#define HNS3_TXD_L3LEN_S\t\t\t16\n#define HNS3_TXD_L3LEN_M\t\t\t(0xff << HNS3_TXD_L3LEN_S)\n#define HNS3_TXD_L4LEN_S\t\t\t24\n#define HNS3_TXD_L4LEN_M\t\t\t(0xff << HNS3_TXD_L4LEN_S)\n\n#define HNS3_TXD_CSUM_START_S\t\t8\n#define HNS3_TXD_CSUM_START_M\t\t(0xffff << HNS3_TXD_CSUM_START_S)\n\n#define HNS3_TXD_OL3T_S\t\t\t\t0\n#define HNS3_TXD_OL3T_M\t\t\t\t(0x3 << HNS3_TXD_OL3T_S)\n#define HNS3_TXD_OVLAN_B\t\t\t2\n#define HNS3_TXD_MACSEC_B\t\t\t3\n#define HNS3_TXD_TUNTYPE_S\t\t\t4\n#define HNS3_TXD_TUNTYPE_M\t\t\t(0xf << HNS3_TXD_TUNTYPE_S)\n\n#define HNS3_TXD_CSUM_OFFSET_S\t\t8\n#define HNS3_TXD_CSUM_OFFSET_M\t\t(0xffff << HNS3_TXD_CSUM_OFFSET_S)\n\n#define HNS3_TXD_BDTYPE_S\t\t\t0\n#define HNS3_TXD_BDTYPE_M\t\t\t(0xf << HNS3_TXD_BDTYPE_S)\n#define HNS3_TXD_FE_B\t\t\t\t4\n#define HNS3_TXD_SC_S\t\t\t\t5\n#define HNS3_TXD_SC_M\t\t\t\t(0x3 << HNS3_TXD_SC_S)\n#define HNS3_TXD_EXTEND_B\t\t\t7\n#define HNS3_TXD_VLD_B\t\t\t\t8\n#define HNS3_TXD_RI_B\t\t\t\t9\n#define HNS3_TXD_RA_B\t\t\t\t10\n#define HNS3_TXD_TSYN_B\t\t\t\t11\n#define HNS3_TXD_DECTTL_S\t\t\t12\n#define HNS3_TXD_DECTTL_M\t\t\t(0xf << HNS3_TXD_DECTTL_S)\n\n#define HNS3_TXD_OL4CS_B\t\t\t22\n\n#define HNS3_TXD_MSS_S\t\t\t\t0\n#define HNS3_TXD_MSS_M\t\t\t\t(0x3fff << HNS3_TXD_MSS_S)\n#define HNS3_TXD_HW_CS_B\t\t\t14\n\n#define HNS3_VECTOR_TX_IRQ\t\t\tBIT_ULL(0)\n#define HNS3_VECTOR_RX_IRQ\t\t\tBIT_ULL(1)\n\n#define HNS3_VECTOR_NOT_INITED\t\t\t0\n#define HNS3_VECTOR_INITED\t\t\t1\n\n#define HNS3_MAX_BD_SIZE\t\t\t65535\n#define HNS3_MAX_TSO_BD_NUM\t\t\t63U\n#define HNS3_MAX_TSO_SIZE\t\t\t1048576U\n#define HNS3_MAX_NON_TSO_SIZE\t\t\t9728U\n\n#define HNS3_VECTOR_GL_MASK\t\t\tGENMASK(11, 0)\n#define HNS3_VECTOR_GL0_OFFSET\t\t\t0x100\n#define HNS3_VECTOR_GL1_OFFSET\t\t\t0x200\n#define HNS3_VECTOR_GL2_OFFSET\t\t\t0x300\n#define HNS3_VECTOR_RL_OFFSET\t\t\t0x900\n#define HNS3_VECTOR_RL_EN_B\t\t\t6\n#define HNS3_VECTOR_QL_MASK\t\t\tGENMASK(9, 0)\n#define HNS3_VECTOR_TX_QL_OFFSET\t\t0xe00\n#define HNS3_VECTOR_RX_QL_OFFSET\t\t0xf00\n\n#define HNS3_RING_EN_B\t\t\t\t0\n\n#define HNS3_GL0_CQ_MODE_REG\t\t\t0x20d00\n#define HNS3_GL1_CQ_MODE_REG\t\t\t0x20d04\n#define HNS3_GL2_CQ_MODE_REG\t\t\t0x20d08\n#define HNS3_CQ_MODE_EQE\t\t\t1U\n#define HNS3_CQ_MODE_CQE\t\t\t0U\n\nenum hns3_pkt_l2t_type {\n\tHNS3_L2_TYPE_UNICAST,\n\tHNS3_L2_TYPE_MULTICAST,\n\tHNS3_L2_TYPE_BROADCAST,\n\tHNS3_L2_TYPE_INVALID,\n};\n\nenum hns3_pkt_l3t_type {\n\tHNS3_L3T_NONE,\n\tHNS3_L3T_IPV6,\n\tHNS3_L3T_IPV4,\n\tHNS3_L3T_RESERVED\n};\n\nenum hns3_pkt_l4t_type {\n\tHNS3_L4T_UNKNOWN,\n\tHNS3_L4T_TCP,\n\tHNS3_L4T_UDP,\n\tHNS3_L4T_SCTP\n};\n\nenum hns3_pkt_ol3t_type {\n\tHNS3_OL3T_NONE,\n\tHNS3_OL3T_IPV6,\n\tHNS3_OL3T_IPV4_NO_CSUM,\n\tHNS3_OL3T_IPV4_CSUM\n};\n\nenum hns3_pkt_tun_type {\n\tHNS3_TUN_NONE,\n\tHNS3_TUN_MAC_IN_UDP,\n\tHNS3_TUN_NVGRE,\n\tHNS3_TUN_OTHER\n};\n\n \nstruct __packed hns3_desc {\n\tunion {\n\t\t__le64 addr;\n\t\t__le16 csum;\n\t\tstruct {\n\t\t\t__le32 ts_nsec;\n\t\t\t__le32 ts_sec;\n\t\t};\n\t};\n\tunion {\n\t\tstruct {\n\t\t\t__le16 vlan_tag;\n\t\t\t__le16 send_size;\n\t\t\tunion {\n\t\t\t\t__le32 type_cs_vlan_tso_len;\n\t\t\t\tstruct {\n\t\t\t\t\t__u8 type_cs_vlan_tso;\n\t\t\t\t\t__u8 l2_len;\n\t\t\t\t\t__u8 l3_len;\n\t\t\t\t\t__u8 l4_len;\n\t\t\t\t};\n\t\t\t};\n\t\t\t__le16 outer_vlan_tag;\n\t\t\t__le16 tv;\n\n\t\tunion {\n\t\t\t__le32 ol_type_vlan_len_msec;\n\t\t\tstruct {\n\t\t\t\t__u8 ol_type_vlan_msec;\n\t\t\t\t__u8 ol2_len;\n\t\t\t\t__u8 ol3_len;\n\t\t\t\t__u8 ol4_len;\n\t\t\t};\n\t\t};\n\n\t\t\t__le32 paylen_ol4cs;\n\t\t\t__le16 bdtp_fe_sc_vld_ra_ri;\n\t\t\t__le16 mss_hw_csum;\n\t\t} tx;\n\n\t\tstruct {\n\t\t\t__le32 l234_info;\n\t\t\t__le16 pkt_len;\n\t\t\t__le16 size;\n\n\t\t\t__le32 rss_hash;\n\t\t\t__le16 fd_id;\n\t\t\t__le16 vlan_tag;\n\n\t\t\tunion {\n\t\t\t\t__le32 ol_info;\n\t\t\t\tstruct {\n\t\t\t\t\t__le16 o_dm_vlan_id_fb;\n\t\t\t\t\t__le16 ot_vlan_tag;\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t__le32 bd_base_info;\n\t\t} rx;\n\t};\n};\n\nenum hns3_desc_type {\n\tDESC_TYPE_UNKNOWN\t\t= 0,\n\tDESC_TYPE_SKB\t\t\t= 1 << 0,\n\tDESC_TYPE_FRAGLIST_SKB\t\t= 1 << 1,\n\tDESC_TYPE_PAGE\t\t\t= 1 << 2,\n\tDESC_TYPE_BOUNCE_ALL\t\t= 1 << 3,\n\tDESC_TYPE_BOUNCE_HEAD\t\t= 1 << 4,\n\tDESC_TYPE_SGL_SKB\t\t= 1 << 5,\n\tDESC_TYPE_PP_FRAG\t\t= 1 << 6,\n};\n\nstruct hns3_desc_cb {\n\tdma_addr_t dma;  \n\tvoid *buf;       \n\n\t \n\tvoid *priv;\n\n\tunion {\n\t\tu32 page_offset;\t \n\t\tu32 send_bytes;\t\t \n\t};\n\n\tu32 length;      \n\n\tu16 reuse_flag;\n\tu16 refill;\n\n\t \n\tu16 type;\n\tu16 pagecnt_bias;\n};\n\nenum hns3_pkt_l3type {\n\tHNS3_L3_TYPE_IPV4,\n\tHNS3_L3_TYPE_IPV6,\n\tHNS3_L3_TYPE_ARP,\n\tHNS3_L3_TYPE_RARP,\n\tHNS3_L3_TYPE_IPV4_OPT,\n\tHNS3_L3_TYPE_IPV6_EXT,\n\tHNS3_L3_TYPE_LLDP,\n\tHNS3_L3_TYPE_BPDU,\n\tHNS3_L3_TYPE_MAC_PAUSE,\n\tHNS3_L3_TYPE_PFC_PAUSE,  \n\n\t \n\n\tHNS3_L3_TYPE_CNM = 0xc,\n\n\t \n\n\tHNS3_L3_TYPE_PARSE_FAIL\t= 0xf  \n};\n\nenum hns3_pkt_l4type {\n\tHNS3_L4_TYPE_UDP,\n\tHNS3_L4_TYPE_TCP,\n\tHNS3_L4_TYPE_GRE,\n\tHNS3_L4_TYPE_SCTP,\n\tHNS3_L4_TYPE_IGMP,\n\tHNS3_L4_TYPE_ICMP,\n\n\t \n\n\tHNS3_L4_TYPE_PARSE_FAIL\t= 0xf  \n};\n\nenum hns3_pkt_ol3type {\n\tHNS3_OL3_TYPE_IPV4 = 0,\n\tHNS3_OL3_TYPE_IPV6,\n\t \n\tHNS3_OL3_TYPE_IPV4_OPT = 4,\n\tHNS3_OL3_TYPE_IPV6_EXT,\n\n\t \n\n\tHNS3_OL3_TYPE_PARSE_FAIL = 0xf\t \n};\n\nenum hns3_pkt_ol4type {\n\tHNS3_OL4_TYPE_NO_TUN,\n\tHNS3_OL4_TYPE_MAC_IN_UDP,\n\tHNS3_OL4_TYPE_NVGRE,\n\tHNS3_OL4_TYPE_UNKNOWN\n};\n\nstruct hns3_rx_ptype {\n\tu32 ptype : 8;\n\tu32 csum_level : 2;\n\tu32 ip_summed : 2;\n\tu32 l3_type : 4;\n\tu32 valid : 1;\n\tu32 hash_type: 3;\n};\n\nstruct ring_stats {\n\tu64 sw_err_cnt;\n\tu64 seg_pkt_cnt;\n\tunion {\n\t\tstruct {\n\t\t\tu64 tx_pkts;\n\t\t\tu64 tx_bytes;\n\t\t\tu64 tx_more;\n\t\t\tu64 tx_push;\n\t\t\tu64 tx_mem_doorbell;\n\t\t\tu64 restart_queue;\n\t\t\tu64 tx_busy;\n\t\t\tu64 tx_copy;\n\t\t\tu64 tx_vlan_err;\n\t\t\tu64 tx_l4_proto_err;\n\t\t\tu64 tx_l2l3l4_err;\n\t\t\tu64 tx_tso_err;\n\t\t\tu64 over_max_recursion;\n\t\t\tu64 hw_limitation;\n\t\t\tu64 tx_bounce;\n\t\t\tu64 tx_spare_full;\n\t\t\tu64 copy_bits_err;\n\t\t\tu64 tx_sgl;\n\t\t\tu64 skb2sgl_err;\n\t\t\tu64 map_sg_err;\n\t\t};\n\t\tstruct {\n\t\t\tu64 rx_pkts;\n\t\t\tu64 rx_bytes;\n\t\t\tu64 rx_err_cnt;\n\t\t\tu64 reuse_pg_cnt;\n\t\t\tu64 err_pkt_len;\n\t\t\tu64 err_bd_num;\n\t\t\tu64 l2_err;\n\t\t\tu64 l3l4_csum_err;\n\t\t\tu64 csum_complete;\n\t\t\tu64 rx_multicast;\n\t\t\tu64 non_reuse_pg;\n\t\t\tu64 frag_alloc_err;\n\t\t\tu64 frag_alloc;\n\t\t};\n\t\t__le16 csum;\n\t};\n};\n\nstruct hns3_tx_spare {\n\tdma_addr_t dma;\n\tvoid *buf;\n\tu32 next_to_use;\n\tu32 next_to_clean;\n\tu32 last_to_clean;\n\tu32 len;\n};\n\nstruct hns3_enet_ring {\n\tstruct hns3_desc *desc;  \n\tstruct hns3_desc_cb *desc_cb;\n\tstruct hns3_enet_ring *next;\n\tstruct hns3_enet_tqp_vector *tqp_vector;\n\tstruct hnae3_queue *tqp;\n\tint queue_index;\n\tstruct device *dev;  \n\tstruct page_pool *page_pool;\n\n\t \n\tstruct ring_stats stats;\n\tstruct u64_stats_sync syncp;\n\n\tdma_addr_t desc_dma_addr;\n\tu32 buf_size;        \n\tu16 desc_num;        \n\tint next_to_use;     \n\n\t \n\tint next_to_clean;\n\tu32 flag;           \n\n\tint pending_buf;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\tu32 fd_qb_tx_sample;\n\t\t\tint last_to_use;         \n\t\t\tu32 tx_copybreak;\n\t\t\tstruct hns3_tx_spare *tx_spare;\n\t\t};\n\n\t\t \n\t\tstruct {\n\t\t\tu32 pull_len;    \n\t\t\tu32 rx_copybreak;\n\t\t\tu32 frag_num;\n\t\t\t \n\t\t\tunsigned char *va;\n\t\t\tstruct sk_buff *skb;\n\t\t\tstruct sk_buff *tail_skb;\n\t\t};\n\t};\n} ____cacheline_internodealigned_in_smp;\n\nenum hns3_flow_level_range {\n\tHNS3_FLOW_LOW = 0,\n\tHNS3_FLOW_MID = 1,\n\tHNS3_FLOW_HIGH = 2,\n\tHNS3_FLOW_ULTRA = 3,\n};\n\n#define HNS3_INT_GL_50K\t\t\t0x0014\n#define HNS3_INT_GL_20K\t\t\t0x0032\n#define HNS3_INT_GL_18K\t\t\t0x0036\n#define HNS3_INT_GL_8K\t\t\t0x007C\n\n#define HNS3_INT_GL_1US\t\t\tBIT(31)\n\n#define HNS3_INT_RL_MAX\t\t\t0x00EC\n#define HNS3_INT_RL_ENABLE_MASK\t\t0x40\n\n#define HNS3_INT_QL_DEFAULT_CFG\t\t0x20\n\nstruct hns3_enet_coalesce {\n\tu16 int_gl;\n\tu16 int_ql;\n\tu16 int_ql_max;\n\tu8 adapt_enable : 1;\n\tu8 ql_enable : 1;\n\tu8 unit_1us : 1;\n\tenum hns3_flow_level_range flow_level;\n};\n\nstruct hns3_enet_ring_group {\n\t \n\tstruct hns3_enet_ring *ring;\n\tu64 total_bytes;\t \n\tu64 total_packets;\t \n\tu16 count;\n\tstruct hns3_enet_coalesce coal;\n\tstruct dim dim;\n};\n\nstruct hns3_enet_tqp_vector {\n\tstruct hnae3_handle *handle;\n\tu8 __iomem *mask_addr;\n\tint vector_irq;\n\tint irq_init_flag;\n\n\tu16 idx;\t\t \n\n\tstruct napi_struct napi;\n\n\tstruct hns3_enet_ring_group rx_group;\n\tstruct hns3_enet_ring_group tx_group;\n\n\tcpumask_t affinity_mask;\n\tu16 num_tqps;\t \n\tstruct irq_affinity_notify affinity_notify;\n\n\tchar name[HNAE3_INT_NAME_LEN];\n\n\tu64 event_cnt;\n} ____cacheline_internodealigned_in_smp;\n\nstruct hns3_nic_priv {\n\tstruct hnae3_handle *ae_handle;\n\tstruct net_device *netdev;\n\tstruct device *dev;\n\n\t \n\tstruct hns3_enet_ring *ring;\n\tstruct hns3_enet_tqp_vector *tqp_vector;\n\tu16 vector_num;\n\tu8 max_non_tso_bd_num;\n\n\tu64 tx_timeout_count;\n\n\tunsigned long state;\n\n\tenum dim_cq_period_mode tx_cqe_mode;\n\tenum dim_cq_period_mode rx_cqe_mode;\n\tstruct hns3_enet_coalesce tx_coal;\n\tstruct hns3_enet_coalesce rx_coal;\n\tu32 tx_copybreak;\n\tu32 rx_copybreak;\n};\n\nunion l3_hdr_info {\n\tstruct iphdr *v4;\n\tstruct ipv6hdr *v6;\n\tunsigned char *hdr;\n};\n\nunion l4_hdr_info {\n\tstruct tcphdr *tcp;\n\tstruct udphdr *udp;\n\tstruct gre_base_hdr *gre;\n\tunsigned char *hdr;\n};\n\nstruct hns3_hw_error_info {\n\tenum hnae3_hw_error_type type;\n\tconst char *msg;\n};\n\nstruct hns3_reset_type_map {\n\tenum ethtool_reset_flags rst_flags;\n\tenum hnae3_reset_type rst_type;\n};\n\nstatic inline int ring_space(struct hns3_enet_ring *ring)\n{\n\t \n\tint begin = smp_load_acquire(&ring->next_to_clean);\n\tint end = READ_ONCE(ring->next_to_use);\n\n\treturn ((end >= begin) ? (ring->desc_num - end + begin) :\n\t\t\t(begin - end)) - 1;\n}\n\nstatic inline u32 hns3_tqp_read_reg(struct hns3_enet_ring *ring, u32 reg)\n{\n\treturn readl_relaxed(ring->tqp->io_base + reg);\n}\n\nstatic inline u32 hns3_read_reg(void __iomem *base, u32 reg)\n{\n\treturn readl(base + reg);\n}\n\nstatic inline void hns3_write_reg(void __iomem *base, u32 reg, u32 value)\n{\n\tu8 __iomem *reg_addr = READ_ONCE(base);\n\n\twritel(value, reg_addr + reg);\n}\n\n#define hns3_read_dev(a, reg) \\\n\thns3_read_reg((a)->io_base, reg)\n\nstatic inline bool hns3_nic_resetting(struct net_device *netdev)\n{\n\tstruct hns3_nic_priv *priv = netdev_priv(netdev);\n\n\treturn test_bit(HNS3_NIC_STATE_RESETTING, &priv->state);\n}\n\n#define hns3_write_dev(a, reg, value) \\\n\thns3_write_reg((a)->io_base, reg, value)\n\n#define ring_to_dev(ring) ((ring)->dev)\n\n#define ring_to_netdev(ring)\t((ring)->tqp_vector->napi.dev)\n\n#define ring_to_dma_dir(ring) (HNAE3_IS_TX_RING(ring) ? \\\n\tDMA_TO_DEVICE : DMA_FROM_DEVICE)\n\n#define hns3_buf_size(_ring) ((_ring)->buf_size)\n\n#define hns3_ring_stats_update(ring, cnt) do { \\\n\ttypeof(ring) (tmp) = (ring); \\\n\tu64_stats_update_begin(&(tmp)->syncp); \\\n\t((tmp)->stats.cnt)++; \\\n\tu64_stats_update_end(&(tmp)->syncp); \\\n} while (0) \\\n\nstatic inline unsigned int hns3_page_order(struct hns3_enet_ring *ring)\n{\n#if (PAGE_SIZE < 8192)\n\tif (ring->buf_size > (PAGE_SIZE / 2))\n\t\treturn 1;\n#endif\n\treturn 0;\n}\n\n#define hns3_page_size(_ring) (PAGE_SIZE << hns3_page_order(_ring))\n\n \n#define hns3_for_each_ring(pos, head) \\\n\tfor (pos = (head).ring; (pos); pos = (pos)->next)\n\n#define hns3_get_handle(ndev) \\\n\t(((struct hns3_nic_priv *)netdev_priv(ndev))->ae_handle)\n\n#define hns3_get_ae_dev(handle) \\\n\t(pci_get_drvdata((handle)->pdev))\n\n#define hns3_get_ops(handle) \\\n\t((handle)->ae_algo->ops)\n\n#define hns3_gl_usec_to_reg(int_gl) ((int_gl) >> 1)\n#define hns3_gl_round_down(int_gl) round_down(int_gl, 2)\n\n#define hns3_rl_usec_to_reg(int_rl) ((int_rl) >> 2)\n#define hns3_rl_round_down(int_rl) round_down(int_rl, 4)\n\nvoid hns3_ethtool_set_ops(struct net_device *netdev);\nint hns3_set_channels(struct net_device *netdev,\n\t\t      struct ethtool_channels *ch);\n\nvoid hns3_clean_tx_ring(struct hns3_enet_ring *ring, int budget);\nint hns3_init_all_ring(struct hns3_nic_priv *priv);\nint hns3_nic_reset_all_ring(struct hnae3_handle *h);\nvoid hns3_fini_ring(struct hns3_enet_ring *ring);\nnetdev_tx_t hns3_nic_net_xmit(struct sk_buff *skb, struct net_device *netdev);\nbool hns3_is_phys_func(struct pci_dev *pdev);\nint hns3_clean_rx_ring(\n\t\tstruct hns3_enet_ring *ring, int budget,\n\t\tvoid (*rx_fn)(struct hns3_enet_ring *, struct sk_buff *));\n\nvoid hns3_set_vector_coalesce_rx_gl(struct hns3_enet_tqp_vector *tqp_vector,\n\t\t\t\t    u32 gl_value);\nvoid hns3_set_vector_coalesce_tx_gl(struct hns3_enet_tqp_vector *tqp_vector,\n\t\t\t\t    u32 gl_value);\nvoid hns3_set_vector_coalesce_rl(struct hns3_enet_tqp_vector *tqp_vector,\n\t\t\t\t u32 rl_value);\nvoid hns3_set_vector_coalesce_rx_ql(struct hns3_enet_tqp_vector *tqp_vector,\n\t\t\t\t    u32 ql_value);\nvoid hns3_set_vector_coalesce_tx_ql(struct hns3_enet_tqp_vector *tqp_vector,\n\t\t\t\t    u32 ql_value);\n\nvoid hns3_request_update_promisc_mode(struct hnae3_handle *handle);\nint hns3_reset_notify(struct hnae3_handle *handle,\n\t\t      enum hnae3_reset_notify_type type);\n\n#ifdef CONFIG_HNS3_DCB\nvoid hns3_dcbnl_setup(struct hnae3_handle *handle);\n#else\nstatic inline void hns3_dcbnl_setup(struct hnae3_handle *handle) {}\n#endif\n\nint hns3_dbg_init(struct hnae3_handle *handle);\nvoid hns3_dbg_uninit(struct hnae3_handle *handle);\nvoid hns3_dbg_register_debugfs(const char *debugfs_dir_name);\nvoid hns3_dbg_unregister_debugfs(void);\nvoid hns3_shinfo_pack(struct skb_shared_info *shinfo, __u32 *size);\nu16 hns3_get_max_available_channels(struct hnae3_handle *h);\nvoid hns3_cq_period_mode_init(struct hns3_nic_priv *priv,\n\t\t\t      enum dim_cq_period_mode tx_mode,\n\t\t\t      enum dim_cq_period_mode rx_mode);\n\nvoid hns3_external_lb_prepare(struct net_device *ndev, bool if_running);\nvoid hns3_external_lb_restore(struct net_device *ndev, bool if_running);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}