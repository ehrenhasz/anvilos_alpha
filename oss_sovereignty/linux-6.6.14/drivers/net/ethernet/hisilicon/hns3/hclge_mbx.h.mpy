{
  "module_name": "hclge_mbx.h",
  "hash_id": "e1fe53b9883d8ab204b064caaa2edc154b0ef7d989349b7845eacaa8dd1772fa",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hclge_mbx.h",
  "human_readable_source": " \n \n\n#ifndef __HCLGE_MBX_H\n#define __HCLGE_MBX_H\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/types.h>\n\nenum HCLGE_MBX_OPCODE {\n\tHCLGE_MBX_RESET = 0x01,\t\t \n\tHCLGE_MBX_ASSERTING_RESET,\t \n\tHCLGE_MBX_SET_UNICAST,\t\t \n\tHCLGE_MBX_SET_MULTICAST,\t \n\tHCLGE_MBX_SET_VLAN,\t\t \n\tHCLGE_MBX_MAP_RING_TO_VECTOR,\t \n\tHCLGE_MBX_UNMAP_RING_TO_VECTOR,\t \n\tHCLGE_MBX_SET_PROMISC_MODE,\t \n\tHCLGE_MBX_SET_MACVLAN,\t\t \n\tHCLGE_MBX_API_NEGOTIATE,\t \n\tHCLGE_MBX_GET_QINFO,\t\t \n\tHCLGE_MBX_GET_QDEPTH,\t\t \n\tHCLGE_MBX_GET_BASIC_INFO,\t \n\tHCLGE_MBX_GET_RETA,\t\t \n\tHCLGE_MBX_GET_RSS_KEY,\t\t \n\tHCLGE_MBX_GET_MAC_ADDR,\t\t \n\tHCLGE_MBX_PF_VF_RESP,\t\t \n\tHCLGE_MBX_GET_BDNUM,\t\t \n\tHCLGE_MBX_GET_BUFSIZE,\t\t \n\tHCLGE_MBX_GET_STREAMID,\t\t \n\tHCLGE_MBX_SET_AESTART,\t\t \n\tHCLGE_MBX_SET_TSOSTATS,\t\t \n\tHCLGE_MBX_LINK_STAT_CHANGE,\t \n\tHCLGE_MBX_GET_BASE_CONFIG,\t \n\tHCLGE_MBX_BIND_FUNC_QUEUE,\t \n\tHCLGE_MBX_GET_LINK_STATUS,\t \n\tHCLGE_MBX_QUEUE_RESET,\t\t \n\tHCLGE_MBX_KEEP_ALIVE,\t\t \n\tHCLGE_MBX_SET_ALIVE,\t\t \n\tHCLGE_MBX_SET_MTU,\t\t \n\tHCLGE_MBX_GET_QID_IN_PF,\t \n\tHCLGE_MBX_LINK_STAT_MODE,\t \n\tHCLGE_MBX_GET_LINK_MODE,\t \n\tHCLGE_MBX_PUSH_VLAN_INFO,\t \n\tHCLGE_MBX_GET_MEDIA_TYPE,        \n\tHCLGE_MBX_PUSH_PROMISC_INFO,\t \n\tHCLGE_MBX_VF_UNINIT,             \n\tHCLGE_MBX_HANDLE_VF_TBL,\t \n\tHCLGE_MBX_GET_RING_VECTOR_MAP,\t \n\n\tHCLGE_MBX_GET_VF_FLR_STATUS = 200,  \n\tHCLGE_MBX_PUSH_LINK_STATUS,\t \n\tHCLGE_MBX_NCSI_ERROR,\t\t \n};\n\n \nenum hclge_mbx_mac_vlan_subcode {\n\tHCLGE_MBX_MAC_VLAN_UC_MODIFY = 0,\t \n\tHCLGE_MBX_MAC_VLAN_UC_ADD,\t\t \n\tHCLGE_MBX_MAC_VLAN_UC_REMOVE,\t\t \n\tHCLGE_MBX_MAC_VLAN_MC_MODIFY,\t\t \n\tHCLGE_MBX_MAC_VLAN_MC_ADD,\t\t \n\tHCLGE_MBX_MAC_VLAN_MC_REMOVE,\t\t \n};\n\n \nenum hclge_mbx_vlan_cfg_subcode {\n\tHCLGE_MBX_VLAN_FILTER = 0,\t \n\tHCLGE_MBX_VLAN_TX_OFF_CFG,\t \n\tHCLGE_MBX_VLAN_RX_OFF_CFG,\t \n\tHCLGE_MBX_PORT_BASE_VLAN_CFG,\t \n\tHCLGE_MBX_GET_PORT_BASE_VLAN_STATE,\t \n\tHCLGE_MBX_ENABLE_VLAN_FILTER,\n};\n\nenum hclge_mbx_tbl_cfg_subcode {\n\tHCLGE_MBX_VPORT_LIST_CLEAR,\n};\n\n#define HCLGE_MBX_MAX_MSG_SIZE\t14\n#define HCLGE_MBX_MAX_RESP_DATA_SIZE\t8U\n#define HCLGE_MBX_MAX_RING_CHAIN_PARAM_NUM\t4\n\n#define HCLGE_RESET_SCHED_TIMEOUT\t(3 * HZ)\n#define HCLGE_MBX_SCHED_TIMEOUT\t(HZ / 2)\n\nstruct hclge_ring_chain_param {\n\tu8 ring_type;\n\tu8 tqp_index;\n\tu8 int_gl_index;\n};\n\nstruct hclge_basic_info {\n\tu8 hw_tc_map;\n\tu8 rsv;\n\t__le16 mbx_api_version;\n\t__le32 pf_caps;\n};\n\nstruct hclgevf_mbx_resp_status {\n\tstruct mutex mbx_mutex;  \n\tu32 origin_mbx_msg;\n\tbool received_resp;\n\tint resp_status;\n\tu16 match_id;\n\tu8 additional_info[HCLGE_MBX_MAX_RESP_DATA_SIZE];\n};\n\nstruct hclge_respond_to_vf_msg {\n\tint status;\n\tu8 data[HCLGE_MBX_MAX_RESP_DATA_SIZE];\n\tu16 len;\n};\n\nstruct hclge_vf_to_pf_msg {\n\tu8 code;\n\tunion {\n\t\tstruct {\n\t\t\tu8 subcode;\n\t\t\tu8 data[HCLGE_MBX_MAX_MSG_SIZE];\n\t\t};\n\t\tstruct {\n\t\t\tu8 en_bc;\n\t\t\tu8 en_uc;\n\t\t\tu8 en_mc;\n\t\t\tu8 en_limit_promisc;\n\t\t};\n\t\tstruct {\n\t\t\tu8 vector_id;\n\t\t\tu8 ring_num;\n\t\t\tstruct hclge_ring_chain_param\n\t\t\t\tparam[HCLGE_MBX_MAX_RING_CHAIN_PARAM_NUM];\n\t\t};\n\t};\n};\n\nstruct hclge_pf_to_vf_msg {\n\t__le16 code;\n\tunion {\n\t\t \n\t\tstruct {\n\t\t\t__le16 vf_mbx_msg_code;\n\t\t\t__le16 vf_mbx_msg_subcode;\n\t\t\t__le16 resp_status;\n\t\t\tu8 resp_data[HCLGE_MBX_MAX_RESP_DATA_SIZE];\n\t\t};\n\t\t \n\t\tstruct {\n\t\t\tu8 msg_data[HCLGE_MBX_MAX_MSG_SIZE];\n\t\t};\n\t};\n};\n\nstruct hclge_mbx_vf_to_pf_cmd {\n\tu8 rsv;\n\tu8 mbx_src_vfid;  \n\tu8 mbx_need_resp;\n\tu8 rsv1[1];\n\tu8 msg_len;\n\tu8 rsv2;\n\t__le16 match_id;\n\tstruct hclge_vf_to_pf_msg msg;\n};\n\n#define HCLGE_MBX_NEED_RESP_B\t\t0\n\nstruct hclge_mbx_pf_to_vf_cmd {\n\tu8 dest_vfid;\n\tu8 rsv[3];\n\tu8 msg_len;\n\tu8 rsv1;\n\t__le16 match_id;\n\tstruct hclge_pf_to_vf_msg msg;\n};\n\nstruct hclge_vf_rst_cmd {\n\tu8 dest_vfid;\n\tu8 vf_rst;\n\tu8 rsv[22];\n};\n\n#pragma pack(1)\nstruct hclge_mbx_link_status {\n\t__le16 link_status;\n\t__le32 speed;\n\t__le16 duplex;\n\tu8 flag;\n};\n\nstruct hclge_mbx_link_mode {\n\t__le16 idx;\n\t__le64 link_mode;\n};\n\nstruct hclge_mbx_port_base_vlan {\n\t__le16 state;\n\t__le16 vlan_proto;\n\t__le16 qos;\n\t__le16 vlan_tag;\n};\n\nstruct hclge_mbx_vf_queue_info {\n\t__le16 num_tqps;\n\t__le16 rss_size;\n\t__le16 rx_buf_len;\n};\n\nstruct hclge_mbx_vf_queue_depth {\n\t__le16 num_tx_desc;\n\t__le16 num_rx_desc;\n};\n\nstruct hclge_mbx_vlan_filter {\n\tu8 is_kill;\n\t__le16 vlan_id;\n\t__le16 proto;\n};\n\nstruct hclge_mbx_mtu_info {\n\t__le32 mtu;\n};\n\n#pragma pack()\n\n \nstruct hclgevf_mbx_arq_ring {\n#define HCLGE_MBX_MAX_ARQ_MSG_SIZE\t8\n#define HCLGE_MBX_MAX_ARQ_MSG_NUM\t1024\n\tstruct hclgevf_dev *hdev;\n\tu32 head;\n\tu32 tail;\n\tatomic_t count;\n\t__le16 msg_q[HCLGE_MBX_MAX_ARQ_MSG_NUM][HCLGE_MBX_MAX_ARQ_MSG_SIZE];\n};\n\nstruct hclge_dev;\n\n#define HCLGE_MBX_OPCODE_MAX 256\nstruct hclge_mbx_ops_param {\n\tstruct hclge_vport *vport;\n\tstruct hclge_mbx_vf_to_pf_cmd *req;\n\tstruct hclge_respond_to_vf_msg *resp_msg;\n};\n\ntypedef int (*hclge_mbx_ops_fn)(struct hclge_mbx_ops_param *param);\n\n#define hclge_mbx_ring_ptr_move_crq(crq) \\\n\t(crq->next_to_use = (crq->next_to_use + 1) % crq->desc_num)\n#define hclge_mbx_tail_ptr_move_arq(arq) \\\n\t\t(arq.tail = (arq.tail + 1) % HCLGE_MBX_MAX_ARQ_MSG_NUM)\n#define hclge_mbx_head_ptr_move_arq(arq) \\\n\t\t(arq.head = (arq.head + 1) % HCLGE_MBX_MAX_ARQ_MSG_NUM)\n\n \n#define HCLGE_MBX_PUSH_LINK_STATUS_EN\t\t\tBIT(0)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}