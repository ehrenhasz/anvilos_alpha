{
  "module_name": "hclge_tm.h",
  "hash_id": "c3d0bbfa7c501d1302675200d9eb68d2495e9ac9e45f52a5da2012f86567a377",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hns3pf/hclge_tm.h",
  "human_readable_source": " \n\n\n#ifndef __HCLGE_TM_H\n#define __HCLGE_TM_H\n\n#include <linux/types.h>\n\n#include \"hnae3.h\"\n\nstruct hclge_dev;\nstruct hclge_vport;\nenum hclge_opcode_type;\n\n \n#define HCLGE_TX_MAC_PAUSE_EN_MSK\tBIT(0)\n#define HCLGE_RX_MAC_PAUSE_EN_MSK\tBIT(1)\n\n#define HCLGE_TM_PORT_BASE_MODE_MSK\tBIT(0)\n\n#define HCLGE_DEFAULT_PAUSE_TRANS_GAP\t0x7F\n#define HCLGE_DEFAULT_PAUSE_TRANS_TIME\t0xFFFF\n\n \n#define HCLGE_TM_TX_SCHD_DWRR_MSK\tBIT(0)\n#define HCLGE_TM_TX_SCHD_SP_MSK\t\t0xFE\n\n#define HCLGE_ETHER_MAX_RATE\t100000\n\n#define HCLGE_TM_PF_MAX_PRI_NUM\t\t8\n#define HCLGE_TM_PF_MAX_QSET_NUM\t8\n\n#define HCLGE_DSCP_MAP_TC_BD_NUM\t2\n#define HCLGE_DSCP_TC_SHIFT(n)\t\t(((n) & 1) * 4)\n\n#define HCLGE_TM_FLUSH_TIME_MS\t10\n#define HCLGE_TM_FLUSH_EN_MSK\tBIT(0)\n\nstruct hclge_pg_to_pri_link_cmd {\n\tu8 pg_id;\n\tu8 rsvd1[3];\n\tu8 pri_bit_map;\n};\n\nstruct hclge_qs_to_pri_link_cmd {\n\t__le16 qs_id;\n\t__le16 rsvd;\n\tu8 priority;\n#define HCLGE_TM_QS_PRI_LINK_VLD_MSK\tBIT(0)\n\tu8 link_vld;\n};\n\nstruct hclge_nq_to_qs_link_cmd {\n\t__le16 nq_id;\n\t__le16 rsvd;\n#define HCLGE_TM_Q_QS_LINK_VLD_MSK\tBIT(10)\n#define HCLGE_TM_QS_ID_L_MSK\t\tGENMASK(9, 0)\n#define HCLGE_TM_QS_ID_L_S\t\t0\n#define HCLGE_TM_QS_ID_H_MSK\t\tGENMASK(14, 10)\n#define HCLGE_TM_QS_ID_H_S\t\t10\n#define HCLGE_TM_QS_ID_H_EXT_S\t\t11\n#define HCLGE_TM_QS_ID_H_EXT_MSK\tGENMASK(15, 11)\n\t__le16 qset_id;\n};\n\nstruct hclge_tqp_tx_queue_tc_cmd {\n\t__le16 queue_id;\n\t__le16 rsvd;\n\tu8 tc_id;\n\tu8 rev[3];\n};\n\nstruct hclge_pg_weight_cmd {\n\tu8 pg_id;\n\tu8 dwrr;\n};\n\nstruct hclge_priority_weight_cmd {\n\tu8 pri_id;\n\tu8 dwrr;\n};\n\nstruct hclge_pri_sch_mode_cfg_cmd {\n\tu8 pri_id;\n\tu8 rsvd[3];\n\tu8 sch_mode;\n};\n\nstruct hclge_qs_sch_mode_cfg_cmd {\n\t__le16 qs_id;\n\tu8 rsvd[2];\n\tu8 sch_mode;\n};\n\nstruct hclge_qs_weight_cmd {\n\t__le16 qs_id;\n\tu8 dwrr;\n};\n\nstruct hclge_ets_tc_weight_cmd {\n\tu8 tc_weight[HNAE3_MAX_TC];\n\tu8 weight_offset;\n\tu8 rsvd[15];\n};\n\n#define HCLGE_TM_SHAP_IR_B_MSK  GENMASK(7, 0)\n#define HCLGE_TM_SHAP_IR_B_LSH\t0\n#define HCLGE_TM_SHAP_IR_U_MSK  GENMASK(11, 8)\n#define HCLGE_TM_SHAP_IR_U_LSH\t8\n#define HCLGE_TM_SHAP_IR_S_MSK  GENMASK(15, 12)\n#define HCLGE_TM_SHAP_IR_S_LSH\t12\n#define HCLGE_TM_SHAP_BS_B_MSK  GENMASK(20, 16)\n#define HCLGE_TM_SHAP_BS_B_LSH\t16\n#define HCLGE_TM_SHAP_BS_S_MSK  GENMASK(25, 21)\n#define HCLGE_TM_SHAP_BS_S_LSH\t21\n\nenum hclge_shap_bucket {\n\tHCLGE_TM_SHAP_C_BUCKET = 0,\n\tHCLGE_TM_SHAP_P_BUCKET,\n};\n\n \n#define HCLGE_TM_RATE_VLD\t0\n\nstruct hclge_pri_shapping_cmd {\n\tu8 pri_id;\n\tu8 rsvd[3];\n\t__le32 pri_shapping_para;\n\tu8 flag;\n\tu8 rsvd1[3];\n\t__le32 pri_rate;\n};\n\nstruct hclge_pg_shapping_cmd {\n\tu8 pg_id;\n\tu8 rsvd[3];\n\t__le32 pg_shapping_para;\n\tu8 flag;\n\tu8 rsvd1[3];\n\t__le32 pg_rate;\n};\n\nstruct hclge_qs_shapping_cmd {\n\t__le16 qs_id;\n\tu8 rsvd[2];\n\t__le32 qs_shapping_para;\n\tu8 flag;\n\tu8 rsvd1[3];\n\t__le32 qs_rate;\n};\n\n#define HCLGE_BP_GRP_NUM\t\t32\n#define HCLGE_BP_SUB_GRP_ID_S\t\t0\n#define HCLGE_BP_SUB_GRP_ID_M\t\tGENMASK(4, 0)\n#define HCLGE_BP_GRP_ID_S\t\t5\n#define HCLGE_BP_GRP_ID_M\t\tGENMASK(9, 5)\n\n#define HCLGE_BP_EXT_GRP_NUM\t\t40\n#define HCLGE_BP_EXT_GRP_ID_S\t\t5\n#define HCLGE_BP_EXT_GRP_ID_M\t\tGENMASK(10, 5)\n\nstruct hclge_bp_to_qs_map_cmd {\n\tu8 tc_id;\n\tu8 rsvd[2];\n\tu8 qs_group_id;\n\t__le32 qs_bit_map;\n\tu32 rsvd1;\n};\n\n#define HCLGE_PFC_DISABLE\t0\n#define HCLGE_PFC_TX_RX_DISABLE\t0\n\nstruct hclge_pfc_en_cmd {\n\tu8 tx_rx_en_bitmap;\n\tu8 pri_en_bitmap;\n};\n\nstruct hclge_cfg_pause_param_cmd {\n\tu8 mac_addr[ETH_ALEN];\n\tu8 pause_trans_gap;\n\tu8 rsvd;\n\t__le16 pause_trans_time;\n\tu8 rsvd1[6];\n\t \n\tu8 mac_addr_extra[ETH_ALEN];\n\tu16 rsvd2;\n};\n\nstruct hclge_pfc_stats_cmd {\n\t__le64 pkt_num[3];\n};\n\nstruct hclge_port_shapping_cmd {\n\t__le32 port_shapping_para;\n\tu8 flag;\n\tu8 rsvd[3];\n\t__le32 port_rate;\n};\n\nstruct hclge_shaper_ir_para {\n\tu8 ir_b;  \n\tu8 ir_u;  \n\tu8 ir_s;  \n};\n\nstruct hclge_tm_nodes_cmd {\n\tu8 pg_base_id;\n\tu8 pri_base_id;\n\t__le16 qset_base_id;\n\t__le16 queue_base_id;\n\tu8 pg_num;\n\tu8 pri_num;\n\t__le16 qset_num;\n\t__le16 queue_num;\n};\n\nstruct hclge_tm_shaper_para {\n\tu32 rate;\n\tu8 ir_b;\n\tu8 ir_u;\n\tu8 ir_s;\n\tu8 bs_b;\n\tu8 bs_s;\n\tu8 flag;\n};\n\n#define hclge_tm_set_field(dest, string, val) \\\n\t\t\t   hnae3_set_field((dest), \\\n\t\t\t   (HCLGE_TM_SHAP_##string##_MSK), \\\n\t\t\t   (HCLGE_TM_SHAP_##string##_LSH), val)\n#define hclge_tm_get_field(src, string) \\\n\t\t\thnae3_get_field((src), HCLGE_TM_SHAP_##string##_MSK, \\\n\t\t\t\t\tHCLGE_TM_SHAP_##string##_LSH)\n\nint hclge_tm_schd_init(struct hclge_dev *hdev);\nint hclge_tm_vport_map_update(struct hclge_dev *hdev);\nint hclge_pause_setup_hw(struct hclge_dev *hdev, bool init);\nint hclge_tm_schd_setup_hw(struct hclge_dev *hdev);\nvoid hclge_tm_prio_tc_info_update(struct hclge_dev *hdev, u8 *prio_tc);\nvoid hclge_tm_schd_info_update(struct hclge_dev *hdev, u8 num_tc);\nvoid hclge_tm_pfc_info_update(struct hclge_dev *hdev);\nint hclge_tm_dwrr_cfg(struct hclge_dev *hdev);\nint hclge_tm_init_hw(struct hclge_dev *hdev, bool init);\nint hclge_pfc_pause_en_cfg(struct hclge_dev *hdev, u8 tx_rx_bitmap,\n\t\t\t   u8 pfc_bitmap);\nint hclge_mac_pause_en_cfg(struct hclge_dev *hdev, bool tx, bool rx);\nint hclge_pause_addr_cfg(struct hclge_dev *hdev, const u8 *mac_addr);\nint hclge_mac_pause_setup_hw(struct hclge_dev *hdev);\nvoid hclge_pfc_rx_stats_get(struct hclge_dev *hdev, u64 *stats);\nvoid hclge_pfc_tx_stats_get(struct hclge_dev *hdev, u64 *stats);\nint hclge_tm_qs_shaper_cfg(struct hclge_vport *vport, int max_tx_rate);\nint hclge_tm_port_shaper_cfg(struct hclge_dev *hdev);\nint hclge_tm_get_qset_num(struct hclge_dev *hdev, u16 *qset_num);\nint hclge_tm_get_pri_num(struct hclge_dev *hdev, u8 *pri_num);\nint hclge_tm_get_qset_map_pri(struct hclge_dev *hdev, u16 qset_id, u8 *priority,\n\t\t\t      u8 *link_vld);\nint hclge_tm_get_qset_sch_mode(struct hclge_dev *hdev, u16 qset_id, u8 *mode);\nint hclge_tm_get_qset_weight(struct hclge_dev *hdev, u16 qset_id, u8 *weight);\nint hclge_tm_get_qset_shaper(struct hclge_dev *hdev, u16 qset_id,\n\t\t\t     struct hclge_tm_shaper_para *para);\nint hclge_tm_get_pri_sch_mode(struct hclge_dev *hdev, u8 pri_id, u8 *mode);\nint hclge_tm_get_pri_weight(struct hclge_dev *hdev, u8 pri_id, u8 *weight);\nint hclge_tm_get_pri_shaper(struct hclge_dev *hdev, u8 pri_id,\n\t\t\t    enum hclge_opcode_type cmd,\n\t\t\t    struct hclge_tm_shaper_para *para);\nint hclge_tm_get_q_to_qs_map(struct hclge_dev *hdev, u16 q_id, u16 *qset_id);\nint hclge_tm_get_q_to_tc(struct hclge_dev *hdev, u16 q_id, u8 *tc_id);\nint hclge_tm_get_pg_to_pri_map(struct hclge_dev *hdev, u8 pg_id,\n\t\t\t       u8 *pri_bit_map);\nint hclge_tm_get_pg_weight(struct hclge_dev *hdev, u8 pg_id, u8 *weight);\nint hclge_tm_get_pg_sch_mode(struct hclge_dev *hdev, u8 pg_id, u8 *mode);\nint hclge_tm_get_pg_shaper(struct hclge_dev *hdev, u8 pg_id,\n\t\t\t   enum hclge_opcode_type cmd,\n\t\t\t   struct hclge_tm_shaper_para *para);\nint hclge_tm_get_port_shaper(struct hclge_dev *hdev,\n\t\t\t     struct hclge_tm_shaper_para *para);\nint hclge_up_to_tc_map(struct hclge_dev *hdev);\nint hclge_dscp_to_tc_map(struct hclge_dev *hdev);\nint hclge_tm_flush_cfg(struct hclge_dev *hdev, bool enable);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}