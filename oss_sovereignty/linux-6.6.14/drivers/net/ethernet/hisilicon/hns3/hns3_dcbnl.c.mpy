{
  "module_name": "hns3_dcbnl.c",
  "hash_id": "8dcda1f44b5c6770ba2cad5fcacdb865c68891e309270f896aaf1724236a7c95",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns3/hns3_dcbnl.c",
  "human_readable_source": "\n\n\n#include \"hnae3.h\"\n#include \"hns3_enet.h\"\n\nstatic int hns3_dcbnl_ieee_getets(struct net_device *ndev, struct ieee_ets *ets)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_getets)\n\t\treturn h->kinfo.dcb_ops->ieee_getets(h, ets);\n\n\treturn -EOPNOTSUPP;\n}\n\nstatic int hns3_dcbnl_ieee_setets(struct net_device *ndev, struct ieee_ets *ets)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_setets)\n\t\treturn h->kinfo.dcb_ops->ieee_setets(h, ets);\n\n\treturn -EOPNOTSUPP;\n}\n\nstatic int hns3_dcbnl_ieee_getpfc(struct net_device *ndev, struct ieee_pfc *pfc)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_getpfc)\n\t\treturn h->kinfo.dcb_ops->ieee_getpfc(h, pfc);\n\n\treturn -EOPNOTSUPP;\n}\n\nstatic int hns3_dcbnl_ieee_setpfc(struct net_device *ndev, struct ieee_pfc *pfc)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_setpfc)\n\t\treturn h->kinfo.dcb_ops->ieee_setpfc(h, pfc);\n\n\treturn -EOPNOTSUPP;\n}\n\nstatic int hns3_dcbnl_ieee_setapp(struct net_device *ndev, struct dcb_app *app)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_setapp)\n\t\treturn h->kinfo.dcb_ops->ieee_setapp(h, app);\n\n\treturn -EOPNOTSUPP;\n}\n\nstatic int hns3_dcbnl_ieee_delapp(struct net_device *ndev, struct dcb_app *app)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (hns3_nic_resetting(ndev))\n\t\treturn -EBUSY;\n\n\tif (h->kinfo.dcb_ops->ieee_setapp)\n\t\treturn h->kinfo.dcb_ops->ieee_delapp(h, app);\n\n\treturn -EOPNOTSUPP;\n}\n\n \nstatic u8 hns3_dcbnl_getdcbx(struct net_device *ndev)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (h->kinfo.dcb_ops->getdcbx)\n\t\treturn h->kinfo.dcb_ops->getdcbx(h);\n\n\treturn 0;\n}\n\n \nstatic u8 hns3_dcbnl_setdcbx(struct net_device *ndev, u8 mode)\n{\n\tstruct hnae3_handle *h = hns3_get_handle(ndev);\n\n\tif (h->kinfo.dcb_ops->setdcbx)\n\t\treturn h->kinfo.dcb_ops->setdcbx(h, mode);\n\n\treturn 1;\n}\n\nstatic const struct dcbnl_rtnl_ops hns3_dcbnl_ops = {\n\t.ieee_getets\t= hns3_dcbnl_ieee_getets,\n\t.ieee_setets\t= hns3_dcbnl_ieee_setets,\n\t.ieee_getpfc\t= hns3_dcbnl_ieee_getpfc,\n\t.ieee_setpfc\t= hns3_dcbnl_ieee_setpfc,\n\t.ieee_setapp    = hns3_dcbnl_ieee_setapp,\n\t.ieee_delapp    = hns3_dcbnl_ieee_delapp,\n\t.getdcbx\t= hns3_dcbnl_getdcbx,\n\t.setdcbx\t= hns3_dcbnl_setdcbx,\n};\n\n \nvoid hns3_dcbnl_setup(struct hnae3_handle *handle)\n{\n\tstruct net_device *dev = handle->kinfo.netdev;\n\n\tif ((!handle->kinfo.dcb_ops) || (handle->flags & HNAE3_SUPPORT_VF))\n\t\treturn;\n\n\tdev->dcbnl_ops = &hns3_dcbnl_ops;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}