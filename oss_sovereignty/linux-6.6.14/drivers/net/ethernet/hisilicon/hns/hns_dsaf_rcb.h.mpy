{
  "module_name": "hns_dsaf_rcb.h",
  "hash_id": "fc8cfcf2910d2839485c28b86f64cb6822e39ae12b2d12375ebd73c2e34de371",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/hisilicon/hns/hns_dsaf_rcb.h",
  "human_readable_source": " \n \n\n#ifndef _HNS_DSAF_RCB_H\n#define _HNS_DSAF_RCB_H\n\n#include <linux/netdevice.h>\n#include <linux/platform_device.h>\n\n#include \"hnae.h\"\n#include \"hns_dsaf_main.h\"\n\nstruct rcb_common_cb;\n\n#define HNS_RCB_IRQ_NUM_PER_QUEUE\t\t2\n#define HNS_RCB_IRQ_IDX_TX\t\t\t0\n#define HNS_RCB_IRQ_IDX_RX\t\t\t1\n#define HNS_RCB_TX_REG_OFFSET\t\t\t0x40\n\n#define HNS_RCB_SERVICE_NW_ENGINE_NUM\t\tDSAF_COMM_CHN\n#define HNS_RCB_DEBUG_NW_ENGINE_NUM\t\t1\n#define HNS_RCB_RING_MAX_BD_PER_PKT\t\t3\n#define HNS_RCB_RING_MAX_TXBD_PER_PKT\t\t3\n#define HNS_RCBV2_RING_MAX_TXBD_PER_PKT\t\t8\n#define HNS_RCB_MAX_PKT_SIZE MAC_MAX_MTU\n\n#define HNS_RCB_RING_MAX_PENDING_BD\t\t1024\n#define HNS_RCB_RING_MIN_PENDING_BD\t\t16\n\n#define HNS_RCB_REG_OFFSET\t\t\t0x10000\n\n#define HNS_RCB_TX_FRAMES_LOW\t\t1\n#define HNS_RCB_RX_FRAMES_LOW\t\t1\n#define HNS_RCB_TX_FRAMES_HIGH\t\t1023\n#define HNS_RCB_RX_FRAMES_HIGH\t\t1023\n#define HNS_RCB_TX_USECS_LOW\t\t1\n#define HNS_RCB_RX_USECS_LOW\t\t1\n#define HNS_RCB_TX_USECS_HIGH\t\t1023\n#define HNS_RCB_RX_USECS_HIGH\t\t1023\n#define HNS_RCB_MAX_COALESCED_FRAMES\t\t1023\n#define HNS_RCB_MIN_COALESCED_FRAMES\t\t1\n#define HNS_RCB_DEF_RX_COALESCED_FRAMES\t\t50\n#define HNS_RCB_DEF_TX_COALESCED_FRAMES\t\t1\n#define HNS_RCB_CLK_FREQ_MHZ\t\t\t350\n#define HNS_RCB_MAX_COALESCED_USECS\t\t0x3ff\n#define HNS_RCB_DEF_COALESCED_USECS\t\t30\n#define HNS_RCB_DEF_GAP_TIME_USECS\t\t20\n#define HNS_RCB_TX_PKTLINE_OFFSET\t\t8\n\n#define HNS_RCB_COMMON_ENDIAN\t\t\t1\n\n#define HNS_BD_SIZE_512_TYPE\t\t\t0\n#define HNS_BD_SIZE_1024_TYPE\t\t\t1\n#define HNS_BD_SIZE_2048_TYPE\t\t\t2\n#define HNS_BD_SIZE_4096_TYPE\t\t\t3\n\n#define HNS_RCB_COMMON_DUMP_REG_NUM 80\n#define HNS_RCB_RING_DUMP_REG_NUM 40\n#define HNS_RING_STATIC_REG_NUM 28\n\n#define HNS_DUMP_REG_NUM\t\t\t500\n#define HNS_STATIC_REG_NUM\t\t\t12\n\n#define HNS_TSO_MODE_8BD_32K\t\t\t1\n#define HNS_TSO_MDOE_4BD_16K\t\t\t0\n\nenum rcb_int_flag {\n\tRCB_INT_FLAG_TX = 0x1,\n\tRCB_INT_FLAG_RX = (0x1 << 1),\n\tRCB_INT_FLAG_MAX = (0x1 << 2),\t \n};\n\nstruct hns_ring_hw_stats {\n\tu64 tx_pkts;\n\tu64 ppe_tx_ok_pkts;\n\tu64 ppe_tx_drop_pkts;\n\tu64 rx_pkts;\n\tu64 ppe_rx_ok_pkts;\n\tu64 ppe_rx_drop_pkts;\n};\n\nstruct ring_pair_cb {\n\tstruct rcb_common_cb *rcb_common;\t \n\tstruct device *dev;\t \n\tstruct hnae_queue q;\n\n\tu16 index;\t \n\tu16 buf_size;\n\n\tint virq[HNS_RCB_IRQ_NUM_PER_QUEUE];\n\n\tu8 port_id_in_comm;\n\tu8 used_by_vf;\n\n\tstruct hns_ring_hw_stats hw_stats;\n};\n\nstruct rcb_common_cb {\n\tu8 __iomem *io_base;\n\tphys_addr_t phy_base;\n\tstruct dsaf_device *dsaf_dev;\n\tu16 max_vfn;\n\tu16 max_q_per_vf;\n\n\tu8 comm_index;\n\tu32 ring_num;\n\tu32 desc_num;  \n\n\tstruct ring_pair_cb ring_pair_cb[];\n};\n\nint hns_rcb_buf_size2type(u32 buf_size);\n\nint hns_rcb_common_get_cfg(struct dsaf_device *dsaf_dev, int comm_index);\nvoid hns_rcb_common_free_cfg(struct dsaf_device *dsaf_dev, u32 comm_index);\nint hns_rcb_common_init_hw(struct rcb_common_cb *rcb_common);\nvoid hns_rcb_start(struct hnae_queue *q, u32 val);\nint hns_rcb_get_cfg(struct rcb_common_cb *rcb_common);\nvoid hns_rcb_get_queue_mode(enum dsaf_mode dsaf_mode,\n\t\t\t    u16 *max_vfn, u16 *max_q_per_vf);\n\nvoid hns_rcb_common_init_commit_hw(struct rcb_common_cb *rcb_common);\n\nvoid hns_rcb_ring_enable_hw(struct hnae_queue *q, u32 val);\nvoid hns_rcb_int_clr_hw(struct hnae_queue *q, u32 flag);\nvoid hns_rcb_int_ctrl_hw(struct hnae_queue *q, u32 flag, u32 enable);\nvoid hns_rcbv2_int_ctrl_hw(struct hnae_queue *q, u32 flag, u32 mask);\nvoid hns_rcbv2_int_clr_hw(struct hnae_queue *q, u32 flag);\n\nvoid hns_rcb_init_hw(struct ring_pair_cb *ring);\nvoid hns_rcb_reset_ring_hw(struct hnae_queue *q);\nvoid hns_rcb_wait_fbd_clean(struct hnae_queue **qs, int q_num, u32 flag);\nint hns_rcb_wait_tx_ring_clean(struct hnae_queue *qs);\nu32 hns_rcb_get_rx_coalesced_frames(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx);\nu32 hns_rcb_get_tx_coalesced_frames(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx);\nu32 hns_rcb_get_coalesce_usecs(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx);\nint hns_rcb_set_coalesce_usecs(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx, u32 timeout);\nint hns_rcb_set_rx_coalesced_frames(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx, u32 coalesced_frames);\nint hns_rcb_set_tx_coalesced_frames(\n\tstruct rcb_common_cb *rcb_common, u32 port_idx, u32 coalesced_frames);\nvoid hns_rcb_update_stats(struct hnae_queue *queue);\n\nvoid hns_rcb_get_stats(struct hnae_queue *queue, u64 *data);\n\nvoid hns_rcb_get_common_regs(struct rcb_common_cb *rcb_common, void *data);\n\nint hns_rcb_get_ring_sset_count(int stringset);\nint hns_rcb_get_common_regs_count(void);\nint hns_rcb_get_ring_regs_count(void);\n\nvoid hns_rcb_get_ring_regs(struct hnae_queue *queue, void *data);\n\nvoid hns_rcb_get_strings(int stringset, u8 *data, int index);\nvoid hns_rcb_set_rx_ring_bs(struct hnae_queue *q, u32 buf_size);\nvoid hns_rcb_set_tx_ring_bs(struct hnae_queue *q, u32 buf_size);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}