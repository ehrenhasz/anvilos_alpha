{
  "module_name": "lan966x_main.h",
  "hash_id": "3804019b41de544d7ed5e5cd7663582ffeeebba8c37ca74b2cf854fd30ef361a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/microchip/lan966x/lan966x_main.h",
  "human_readable_source": " \n\n#ifndef __LAN966X_MAIN_H__\n#define __LAN966X_MAIN_H__\n\n#include <linux/debugfs.h>\n#include <linux/etherdevice.h>\n#include <linux/if_vlan.h>\n#include <linux/jiffies.h>\n#include <linux/phy.h>\n#include <linux/phylink.h>\n#include <linux/ptp_clock_kernel.h>\n#include <net/page_pool/types.h>\n#include <net/pkt_cls.h>\n#include <net/pkt_sched.h>\n#include <net/switchdev.h>\n#include <net/xdp.h>\n\n#include <vcap_api.h>\n#include <vcap_api_client.h>\n\n#include \"lan966x_regs.h\"\n#include \"lan966x_ifh.h\"\n\n#define TABLE_UPDATE_SLEEP_US\t\t10\n#define TABLE_UPDATE_TIMEOUT_US\t\t100000\n\n#define READL_SLEEP_US\t\t\t10\n#define READL_TIMEOUT_US\t\t100000000\n\n#define LAN966X_BUFFER_CELL_SZ\t\t64\n#define LAN966X_BUFFER_MEMORY\t\t(160 * 1024)\n#define LAN966X_BUFFER_MIN_SZ\t\t60\n\n#define LAN966X_HW_MTU(mtu)\t\t((mtu) + ETH_HLEN + ETH_FCS_LEN)\n\n#define PGID_AGGR\t\t\t64\n#define PGID_SRC\t\t\t80\n#define PGID_ENTRIES\t\t\t89\n\n#define UNAWARE_PVID\t\t\t0\n#define HOST_PVID\t\t\t4095\n\n \n#define QSYS_Q_RSRV\t\t\t95\n\n#define NUM_PHYS_PORTS\t\t\t8\n#define CPU_PORT\t\t\t8\n#define NUM_PRIO_QUEUES\t\t\t8\n\n \n#define PGID_CPU\t\t\t(PGID_AGGR - 6)\n#define PGID_UC\t\t\t\t(PGID_AGGR - 5)\n#define PGID_BC\t\t\t\t(PGID_AGGR - 4)\n#define PGID_MC\t\t\t\t(PGID_AGGR - 3)\n#define PGID_MCIPV4\t\t\t(PGID_AGGR - 2)\n#define PGID_MCIPV6\t\t\t(PGID_AGGR - 1)\n\n \n#define PGID_GP_START\t\t\t(CPU_PORT + 1)\n#define PGID_GP_END\t\t\tPGID_CPU\n\n#define LAN966X_SPEED_NONE\t\t0\n#define LAN966X_SPEED_2500\t\t1\n#define LAN966X_SPEED_1000\t\t1\n#define LAN966X_SPEED_100\t\t2\n#define LAN966X_SPEED_10\t\t3\n\n#define LAN966X_PHC_COUNT\t\t3\n#define LAN966X_PHC_PORT\t\t0\n#define LAN966X_PHC_PINS_NUM\t\t7\n\n#define IFH_REW_OP_NOOP\t\t\t0x0\n#define IFH_REW_OP_ONE_STEP_PTP\t\t0x3\n#define IFH_REW_OP_TWO_STEP_PTP\t\t0x4\n\n#define FDMA_RX_DCB_MAX_DBS\t\t1\n#define FDMA_TX_DCB_MAX_DBS\t\t1\n#define FDMA_DCB_INFO_DATAL(x)\t\t((x) & GENMASK(15, 0))\n\n#define FDMA_DCB_STATUS_BLOCKL(x)\t((x) & GENMASK(15, 0))\n#define FDMA_DCB_STATUS_SOF\t\tBIT(16)\n#define FDMA_DCB_STATUS_EOF\t\tBIT(17)\n#define FDMA_DCB_STATUS_INTR\t\tBIT(18)\n#define FDMA_DCB_STATUS_DONE\t\tBIT(19)\n#define FDMA_DCB_STATUS_BLOCKO(x)\t(((x) << 20) & GENMASK(31, 20))\n#define FDMA_DCB_INVALID_DATA\t\t0x1\n\n#define FDMA_XTR_CHANNEL\t\t6\n#define FDMA_INJ_CHANNEL\t\t0\n#define FDMA_DCB_MAX\t\t\t512\n\n#define SE_IDX_QUEUE\t\t\t0   \n#define SE_IDX_PORT\t\t\t80  \n\n#define LAN966X_VCAP_CID_IS1_L0 VCAP_CID_INGRESS_L0  \n#define LAN966X_VCAP_CID_IS1_L1 VCAP_CID_INGRESS_L1  \n#define LAN966X_VCAP_CID_IS1_L2 VCAP_CID_INGRESS_L2  \n#define LAN966X_VCAP_CID_IS1_MAX (VCAP_CID_INGRESS_L3 - 1)  \n\n#define LAN966X_VCAP_CID_IS2_L0 VCAP_CID_INGRESS_STAGE2_L0  \n#define LAN966X_VCAP_CID_IS2_L1 VCAP_CID_INGRESS_STAGE2_L1  \n#define LAN966X_VCAP_CID_IS2_MAX (VCAP_CID_INGRESS_STAGE2_L2 - 1)  \n\n#define LAN966X_VCAP_CID_ES0_L0 VCAP_CID_EGRESS_L0  \n#define LAN966X_VCAP_CID_ES0_MAX (VCAP_CID_EGRESS_L1 - 1)  \n\n#define LAN966X_PORT_QOS_PCP_COUNT\t8\n#define LAN966X_PORT_QOS_DEI_COUNT\t8\n#define LAN966X_PORT_QOS_PCP_DEI_COUNT \\\n\t(LAN966X_PORT_QOS_PCP_COUNT + LAN966X_PORT_QOS_DEI_COUNT)\n\n#define LAN966X_PORT_QOS_DSCP_COUNT\t64\n\n \n#define LAN966X_PORT_REW_TAG_CTRL_CLASSIFIED\t0\n#define LAN966X_PORT_REW_TAG_CTRL_MAPPED\t2\n\n \n#define LAN966X_PORT_REW_DSCP_FRAME\t\t0\n#define LAN966X_PORT_REW_DSCP_ANALIZER\t\t1\n#define LAN966X_PORT_QOS_REWR_DSCP_ALL\t\t3\n\n \nenum macaccess_entry_type {\n\tENTRYTYPE_NORMAL = 0,\n\tENTRYTYPE_LOCKED,\n\tENTRYTYPE_MACV4,\n\tENTRYTYPE_MACV6,\n};\n\n \nenum lan966x_fdma_action {\n\tFDMA_PASS = 0,\n\tFDMA_ERROR,\n\tFDMA_DROP,\n\tFDMA_TX,\n\tFDMA_REDIRECT,\n};\n\n \nenum LAN966X_PORT_MASK_MODE {\n\tLAN966X_PMM_NO_ACTION,\n\tLAN966X_PMM_REPLACE,\n\tLAN966X_PMM_FORWARDING,\n\tLAN966X_PMM_REDIRECT,\n};\n\nenum vcap_is2_port_sel_ipv6 {\n\tVCAP_IS2_PS_IPV6_TCPUDP_OTHER,\n\tVCAP_IS2_PS_IPV6_STD,\n\tVCAP_IS2_PS_IPV6_IP4_TCPUDP_IP4_OTHER,\n\tVCAP_IS2_PS_IPV6_MAC_ETYPE,\n};\n\nenum vcap_is1_port_sel_other {\n\tVCAP_IS1_PS_OTHER_NORMAL,\n\tVCAP_IS1_PS_OTHER_7TUPLE,\n\tVCAP_IS1_PS_OTHER_DBL_VID,\n\tVCAP_IS1_PS_OTHER_DMAC_VID,\n};\n\nenum vcap_is1_port_sel_ipv4 {\n\tVCAP_IS1_PS_IPV4_NORMAL,\n\tVCAP_IS1_PS_IPV4_7TUPLE,\n\tVCAP_IS1_PS_IPV4_5TUPLE_IP4,\n\tVCAP_IS1_PS_IPV4_DBL_VID,\n\tVCAP_IS1_PS_IPV4_DMAC_VID,\n};\n\nenum vcap_is1_port_sel_ipv6 {\n\tVCAP_IS1_PS_IPV6_NORMAL,\n\tVCAP_IS1_PS_IPV6_7TUPLE,\n\tVCAP_IS1_PS_IPV6_5TUPLE_IP4,\n\tVCAP_IS1_PS_IPV6_NORMAL_IP6,\n\tVCAP_IS1_PS_IPV6_5TUPLE_IP6,\n\tVCAP_IS1_PS_IPV6_DBL_VID,\n\tVCAP_IS1_PS_IPV6_DMAC_VID,\n};\n\nenum vcap_is1_port_sel_rt {\n\tVCAP_IS1_PS_RT_NORMAL,\n\tVCAP_IS1_PS_RT_7TUPLE,\n\tVCAP_IS1_PS_RT_DBL_VID,\n\tVCAP_IS1_PS_RT_DMAC_VID,\n\tVCAP_IS1_PS_RT_FOLLOW_OTHER = 7,\n};\n\nstruct lan966x_port;\n\nstruct lan966x_db {\n\tu64 dataptr;\n\tu64 status;\n};\n\nstruct lan966x_rx_dcb {\n\tu64 nextptr;\n\tu64 info;\n\tstruct lan966x_db db[FDMA_RX_DCB_MAX_DBS];\n};\n\nstruct lan966x_tx_dcb {\n\tu64 nextptr;\n\tu64 info;\n\tstruct lan966x_db db[FDMA_TX_DCB_MAX_DBS];\n};\n\nstruct lan966x_rx {\n\tstruct lan966x *lan966x;\n\n\t \n\tstruct lan966x_rx_dcb *dcbs;\n\n\t \n\tstruct lan966x_rx_dcb *last_entry;\n\n\t \n\tstruct page *page[FDMA_DCB_MAX][FDMA_RX_DCB_MAX_DBS];\n\n\t \n\tint db_index;\n\n\t \n\tint dcb_index;\n\n\t \n\tdma_addr_t dma;\n\n\t \n\tu8 page_order;\n\n\t \n\tu32 max_mtu;\n\n\tu8 channel_id;\n\n\tstruct page_pool *page_pool;\n};\n\nstruct lan966x_tx_dcb_buf {\n\tdma_addr_t dma_addr;\n\tstruct net_device *dev;\n\tunion {\n\t\tstruct sk_buff *skb;\n\t\tstruct xdp_frame *xdpf;\n\t\tstruct page *page;\n\t} data;\n\tu32 len;\n\tu32 used : 1;\n\tu32 ptp : 1;\n\tu32 use_skb : 1;\n\tu32 xdp_ndo : 1;\n};\n\nstruct lan966x_tx {\n\tstruct lan966x *lan966x;\n\n\t \n\tstruct lan966x_tx_dcb *dcbs;\n\tu16 last_in_use;\n\n\t \n\tdma_addr_t dma;\n\n\t \n\tstruct lan966x_tx_dcb_buf *dcbs_buf;\n\n\tu8 channel_id;\n\n\tbool activated;\n};\n\nstruct lan966x_stat_layout {\n\tu32 offset;\n\tchar name[ETH_GSTRING_LEN];\n};\n\nstruct lan966x_phc {\n\tstruct ptp_clock *clock;\n\tstruct ptp_clock_info info;\n\tstruct ptp_pin_desc pins[LAN966X_PHC_PINS_NUM];\n\tstruct kernel_hwtstamp_config hwtstamp_config;\n\tstruct lan966x *lan966x;\n\tu8 index;\n};\n\nstruct lan966x_skb_cb {\n\tu8 rew_op;\n\tu16 ts_id;\n\tunsigned long jiffies;\n};\n\n#define LAN966X_PTP_TIMEOUT\t\tmsecs_to_jiffies(10)\n#define LAN966X_SKB_CB(skb) \\\n\t((struct lan966x_skb_cb *)((skb)->cb))\n\nstruct lan966x {\n\tstruct device *dev;\n\n\tu8 num_phys_ports;\n\tstruct lan966x_port **ports;\n\n\tvoid __iomem *regs[NUM_TARGETS];\n\n\tint shared_queue_sz;\n\n\tu8 base_mac[ETH_ALEN];\n\n\tspinlock_t tx_lock;  \n\n\tstruct net_device *bridge;\n\tu16 bridge_mask;\n\tu16 bridge_fwd_mask;\n\n\tstruct list_head mac_entries;\n\tspinlock_t mac_lock;  \n\n\tu16 vlan_mask[VLAN_N_VID];\n\tDECLARE_BITMAP(cpu_vlan_mask, VLAN_N_VID);\n\n\t \n\tconst struct lan966x_stat_layout *stats_layout;\n\tu32 num_stats;\n\n\t \n\tstruct mutex stats_lock;\n\tu64 *stats;\n\tstruct delayed_work stats_work;\n\tstruct workqueue_struct *stats_queue;\n\n\t \n\tint xtr_irq;\n\tint ana_irq;\n\tint ptp_irq;\n\tint fdma_irq;\n\tint ptp_ext_irq;\n\n\t \n\tstruct workqueue_struct *fdb_work;\n\tstruct list_head fdb_entries;\n\n\t \n\tstruct list_head mdb_entries;\n\tstruct list_head pgid_entries;\n\n\t \n\tbool ptp;\n\tstruct lan966x_phc phc[LAN966X_PHC_COUNT];\n\tspinlock_t ptp_clock_lock;  \n\tspinlock_t ptp_ts_id_lock;  \n\tstruct mutex ptp_lock;  \n\tu16 ptp_skbs;\n\n\t \n\tbool fdma;\n\tstruct net_device *fdma_ndev;\n\tstruct lan966x_rx rx;\n\tstruct lan966x_tx tx;\n\tstruct napi_struct napi;\n\n\t \n\tstruct lan966x_port *mirror_monitor;\n\tu32 mirror_mask[2];\n\tu32 mirror_count;\n\n\t \n\tstruct vcap_control *vcap_ctrl;\n\n\t \n\tstruct dentry *debugfs_root;\n};\n\nstruct lan966x_port_config {\n\tphy_interface_t portmode;\n\tconst unsigned long *advertising;\n\tint speed;\n\tint duplex;\n\tu32 pause;\n\tbool inband;\n\tbool autoneg;\n};\n\nstruct lan966x_port_tc {\n\tbool ingress_shared_block;\n\tunsigned long police_id;\n\tunsigned long ingress_mirror_id;\n\tunsigned long egress_mirror_id;\n\tstruct flow_stats police_stat;\n\tstruct flow_stats mirror_stat;\n};\n\nstruct lan966x_port_qos_pcp {\n\tu8 map[LAN966X_PORT_QOS_PCP_DEI_COUNT];\n\tbool enable;\n};\n\nstruct lan966x_port_qos_dscp {\n\tu8 map[LAN966X_PORT_QOS_DSCP_COUNT];\n\tbool enable;\n};\n\nstruct lan966x_port_qos_pcp_rewr {\n\tu16 map[NUM_PRIO_QUEUES];\n\tbool enable;\n};\n\nstruct lan966x_port_qos_dscp_rewr {\n\tu16 map[LAN966X_PORT_QOS_DSCP_COUNT];\n\tbool enable;\n};\n\nstruct lan966x_port_qos {\n\tstruct lan966x_port_qos_pcp pcp;\n\tstruct lan966x_port_qos_dscp dscp;\n\tstruct lan966x_port_qos_pcp_rewr pcp_rewr;\n\tstruct lan966x_port_qos_dscp_rewr dscp_rewr;\n\tu8 default_prio;\n};\n\nstruct lan966x_port {\n\tstruct net_device *dev;\n\tstruct lan966x *lan966x;\n\n\tu8 chip_port;\n\tu16 pvid;\n\tu16 vid;\n\tbool vlan_aware;\n\n\tbool learn_ena;\n\tbool mcast_ena;\n\n\tstruct phylink_config phylink_config;\n\tstruct phylink_pcs phylink_pcs;\n\tstruct lan966x_port_config config;\n\tstruct phylink *phylink;\n\tstruct phy *serdes;\n\tstruct fwnode_handle *fwnode;\n\n\tu8 ptp_tx_cmd;\n\tbool ptp_rx_cmd;\n\tu16 ts_id;\n\tstruct sk_buff_head tx_skbs;\n\n\tstruct net_device *bond;\n\tbool lag_tx_active;\n\tenum netdev_lag_hash hash_type;\n\n\tstruct lan966x_port_tc tc;\n\n\tstruct bpf_prog *xdp_prog;\n\tstruct xdp_rxq_info xdp_rxq;\n};\n\nextern const struct phylink_mac_ops lan966x_phylink_mac_ops;\nextern const struct phylink_pcs_ops lan966x_phylink_pcs_ops;\nextern const struct ethtool_ops lan966x_ethtool_ops;\nextern struct notifier_block lan966x_switchdev_nb __read_mostly;\nextern struct notifier_block lan966x_switchdev_blocking_nb __read_mostly;\n\nbool lan966x_netdevice_check(const struct net_device *dev);\n\nvoid lan966x_register_notifier_blocks(void);\nvoid lan966x_unregister_notifier_blocks(void);\n\nbool lan966x_hw_offload(struct lan966x *lan966x, u32 port, struct sk_buff *skb);\n\nvoid lan966x_ifh_get_src_port(void *ifh, u64 *src_port);\nvoid lan966x_ifh_get_timestamp(void *ifh, u64 *timestamp);\nvoid lan966x_ifh_set_bypass(void *ifh, u64 bypass);\nvoid lan966x_ifh_set_port(void *ifh, u64 bypass);\n\nvoid lan966x_stats_get(struct net_device *dev,\n\t\t       struct rtnl_link_stats64 *stats);\nint lan966x_stats_init(struct lan966x *lan966x);\n\nvoid lan966x_port_config_down(struct lan966x_port *port);\nvoid lan966x_port_config_up(struct lan966x_port *port);\nvoid lan966x_port_status_get(struct lan966x_port *port,\n\t\t\t     struct phylink_link_state *state);\nint lan966x_port_pcs_set(struct lan966x_port *port,\n\t\t\t struct lan966x_port_config *config);\nvoid lan966x_port_init(struct lan966x_port *port);\n\nvoid lan966x_port_qos_set(struct lan966x_port *port,\n\t\t\t  struct lan966x_port_qos *qos);\nvoid lan966x_port_qos_dscp_rewr_mode_set(struct lan966x_port *port,\n\t\t\t\t\t int mode);\n\nint lan966x_mac_ip_learn(struct lan966x *lan966x,\n\t\t\t bool cpu_copy,\n\t\t\t const unsigned char mac[ETH_ALEN],\n\t\t\t unsigned int vid,\n\t\t\t enum macaccess_entry_type type);\nint lan966x_mac_learn(struct lan966x *lan966x, int port,\n\t\t      const unsigned char mac[ETH_ALEN],\n\t\t      unsigned int vid,\n\t\t      enum macaccess_entry_type type);\nint lan966x_mac_forget(struct lan966x *lan966x,\n\t\t       const unsigned char mac[ETH_ALEN],\n\t\t       unsigned int vid,\n\t\t       enum macaccess_entry_type type);\nint lan966x_mac_cpu_learn(struct lan966x *lan966x, const char *addr, u16 vid);\nint lan966x_mac_cpu_forget(struct lan966x *lan966x, const char *addr, u16 vid);\nvoid lan966x_mac_init(struct lan966x *lan966x);\nvoid lan966x_mac_set_ageing(struct lan966x *lan966x,\n\t\t\t    u32 ageing);\nint lan966x_mac_del_entry(struct lan966x *lan966x,\n\t\t\t  const unsigned char *addr,\n\t\t\t  u16 vid);\nint lan966x_mac_add_entry(struct lan966x *lan966x,\n\t\t\t  struct lan966x_port *port,\n\t\t\t  const unsigned char *addr,\n\t\t\t  u16 vid);\nvoid lan966x_mac_lag_replace_port_entry(struct lan966x *lan966x,\n\t\t\t\t\tstruct lan966x_port *src,\n\t\t\t\t\tstruct lan966x_port *dst);\nvoid lan966x_mac_lag_remove_port_entry(struct lan966x *lan966x,\n\t\t\t\t       struct lan966x_port *src);\nvoid lan966x_mac_purge_entries(struct lan966x *lan966x);\nirqreturn_t lan966x_mac_irq_handler(struct lan966x *lan966x);\n\nvoid lan966x_vlan_init(struct lan966x *lan966x);\nvoid lan966x_vlan_port_apply(struct lan966x_port *port);\nbool lan966x_vlan_cpu_member_cpu_vlan_mask(struct lan966x *lan966x, u16 vid);\nvoid lan966x_vlan_port_set_vlan_aware(struct lan966x_port *port,\n\t\t\t\t      bool vlan_aware);\nint lan966x_vlan_port_set_vid(struct lan966x_port *port,\n\t\t\t      u16 vid,\n\t\t\t      bool pvid,\n\t\t\t      bool untagged);\nvoid lan966x_vlan_port_add_vlan(struct lan966x_port *port,\n\t\t\t\tu16 vid,\n\t\t\t\tbool pvid,\n\t\t\t\tbool untagged);\nvoid lan966x_vlan_port_del_vlan(struct lan966x_port *port, u16 vid);\nvoid lan966x_vlan_cpu_add_vlan(struct lan966x *lan966x, u16 vid);\nvoid lan966x_vlan_cpu_del_vlan(struct lan966x *lan966x, u16 vid);\n\nvoid lan966x_fdb_write_entries(struct lan966x *lan966x, u16 vid);\nvoid lan966x_fdb_erase_entries(struct lan966x *lan966x, u16 vid);\nint lan966x_fdb_init(struct lan966x *lan966x);\nvoid lan966x_fdb_deinit(struct lan966x *lan966x);\nvoid lan966x_fdb_flush_workqueue(struct lan966x *lan966x);\nint lan966x_handle_fdb(struct net_device *dev,\n\t\t       struct net_device *orig_dev,\n\t\t       unsigned long event, const void *ctx,\n\t\t       const struct switchdev_notifier_fdb_info *fdb_info);\n\nvoid lan966x_mdb_init(struct lan966x *lan966x);\nvoid lan966x_mdb_deinit(struct lan966x *lan966x);\nint lan966x_handle_port_mdb_add(struct lan966x_port *port,\n\t\t\t\tconst struct switchdev_obj *obj);\nint lan966x_handle_port_mdb_del(struct lan966x_port *port,\n\t\t\t\tconst struct switchdev_obj *obj);\nvoid lan966x_mdb_erase_entries(struct lan966x *lan966x, u16 vid);\nvoid lan966x_mdb_write_entries(struct lan966x *lan966x, u16 vid);\nvoid lan966x_mdb_clear_entries(struct lan966x *lan966x);\nvoid lan966x_mdb_restore_entries(struct lan966x *lan966x);\n\nint lan966x_ptp_init(struct lan966x *lan966x);\nvoid lan966x_ptp_deinit(struct lan966x *lan966x);\nint lan966x_ptp_hwtstamp_set(struct lan966x_port *port,\n\t\t\t     struct kernel_hwtstamp_config *cfg,\n\t\t\t     struct netlink_ext_ack *extack);\nvoid lan966x_ptp_hwtstamp_get(struct lan966x_port *port,\n\t\t\t      struct kernel_hwtstamp_config *cfg);\nvoid lan966x_ptp_rxtstamp(struct lan966x *lan966x, struct sk_buff *skb,\n\t\t\t  u64 src_port, u64 timestamp);\nint lan966x_ptp_txtstamp_request(struct lan966x_port *port,\n\t\t\t\t struct sk_buff *skb);\nvoid lan966x_ptp_txtstamp_release(struct lan966x_port *port,\n\t\t\t\t  struct sk_buff *skb);\nirqreturn_t lan966x_ptp_irq_handler(int irq, void *args);\nirqreturn_t lan966x_ptp_ext_irq_handler(int irq, void *args);\nu32 lan966x_ptp_get_period_ps(void);\nint lan966x_ptp_gettime64(struct ptp_clock_info *ptp, struct timespec64 *ts);\nint lan966x_ptp_setup_traps(struct lan966x_port *port,\n\t\t\t    struct kernel_hwtstamp_config *cfg);\nint lan966x_ptp_del_traps(struct lan966x_port *port);\n\nint lan966x_fdma_xmit(struct sk_buff *skb, __be32 *ifh, struct net_device *dev);\nint lan966x_fdma_xmit_xdpf(struct lan966x_port *port, void *ptr, u32 len);\nint lan966x_fdma_change_mtu(struct lan966x *lan966x);\nvoid lan966x_fdma_netdev_init(struct lan966x *lan966x, struct net_device *dev);\nvoid lan966x_fdma_netdev_deinit(struct lan966x *lan966x, struct net_device *dev);\nint lan966x_fdma_init(struct lan966x *lan966x);\nvoid lan966x_fdma_deinit(struct lan966x *lan966x);\nirqreturn_t lan966x_fdma_irq_handler(int irq, void *args);\nint lan966x_fdma_reload_page_pool(struct lan966x *lan966x);\n\nint lan966x_lag_port_join(struct lan966x_port *port,\n\t\t\t  struct net_device *brport_dev,\n\t\t\t  struct net_device *bond,\n\t\t\t  struct netlink_ext_ack *extack);\nvoid lan966x_lag_port_leave(struct lan966x_port *port, struct net_device *bond);\nint lan966x_lag_port_prechangeupper(struct net_device *dev,\n\t\t\t\t    struct netdev_notifier_changeupper_info *info);\nint lan966x_lag_port_changelowerstate(struct net_device *dev,\n\t\t\t\t      struct netdev_notifier_changelowerstate_info *info);\nint lan966x_lag_netdev_prechangeupper(struct net_device *dev,\n\t\t\t\t      struct netdev_notifier_changeupper_info *info);\nint lan966x_lag_netdev_changeupper(struct net_device *dev,\n\t\t\t\t   struct netdev_notifier_changeupper_info *info);\nbool lan966x_lag_first_port(struct net_device *lag, struct net_device *dev);\nu32 lan966x_lag_get_mask(struct lan966x *lan966x, struct net_device *bond);\n\nint lan966x_port_changeupper(struct net_device *dev,\n\t\t\t     struct net_device *brport_dev,\n\t\t\t     struct netdev_notifier_changeupper_info *info);\nint lan966x_port_prechangeupper(struct net_device *dev,\n\t\t\t\tstruct net_device *brport_dev,\n\t\t\t\tstruct netdev_notifier_changeupper_info *info);\nvoid lan966x_port_stp_state_set(struct lan966x_port *port, u8 state);\nvoid lan966x_port_ageing_set(struct lan966x_port *port,\n\t\t\t     unsigned long ageing_clock_t);\nvoid lan966x_update_fwd_mask(struct lan966x *lan966x);\n\nint lan966x_tc_setup(struct net_device *dev, enum tc_setup_type type,\n\t\t     void *type_data);\n\nint lan966x_mqprio_add(struct lan966x_port *port, u8 num_tc);\nint lan966x_mqprio_del(struct lan966x_port *port);\n\nvoid lan966x_taprio_init(struct lan966x *lan966x);\nvoid lan966x_taprio_deinit(struct lan966x *lan966x);\nint lan966x_taprio_add(struct lan966x_port *port,\n\t\t       struct tc_taprio_qopt_offload *qopt);\nint lan966x_taprio_del(struct lan966x_port *port);\nint lan966x_taprio_speed_set(struct lan966x_port *port, int speed);\n\nint lan966x_tbf_add(struct lan966x_port *port,\n\t\t    struct tc_tbf_qopt_offload *qopt);\nint lan966x_tbf_del(struct lan966x_port *port,\n\t\t    struct tc_tbf_qopt_offload *qopt);\n\nint lan966x_cbs_add(struct lan966x_port *port,\n\t\t    struct tc_cbs_qopt_offload *qopt);\nint lan966x_cbs_del(struct lan966x_port *port,\n\t\t    struct tc_cbs_qopt_offload *qopt);\n\nint lan966x_ets_add(struct lan966x_port *port,\n\t\t    struct tc_ets_qopt_offload *qopt);\nint lan966x_ets_del(struct lan966x_port *port,\n\t\t    struct tc_ets_qopt_offload *qopt);\n\nint lan966x_tc_matchall(struct lan966x_port *port,\n\t\t\tstruct tc_cls_matchall_offload *f,\n\t\t\tbool ingress);\n\nint lan966x_police_port_add(struct lan966x_port *port,\n\t\t\t    struct flow_action *action,\n\t\t\t    struct flow_action_entry *act,\n\t\t\t    unsigned long police_id,\n\t\t\t    bool ingress,\n\t\t\t    struct netlink_ext_ack *extack);\nint lan966x_police_port_del(struct lan966x_port *port,\n\t\t\t    unsigned long police_id,\n\t\t\t    struct netlink_ext_ack *extack);\nvoid lan966x_police_port_stats(struct lan966x_port *port,\n\t\t\t       struct flow_stats *stats);\n\nint lan966x_mirror_port_add(struct lan966x_port *port,\n\t\t\t    struct flow_action_entry *action,\n\t\t\t    unsigned long mirror_id,\n\t\t\t    bool ingress,\n\t\t\t    struct netlink_ext_ack *extack);\nint lan966x_mirror_port_del(struct lan966x_port *port,\n\t\t\t    bool ingress,\n\t\t\t    struct netlink_ext_ack *extack);\nvoid lan966x_mirror_port_stats(struct lan966x_port *port,\n\t\t\t       struct flow_stats *stats,\n\t\t\t       bool ingress);\n\nint lan966x_xdp_port_init(struct lan966x_port *port);\nvoid lan966x_xdp_port_deinit(struct lan966x_port *port);\nint lan966x_xdp(struct net_device *dev, struct netdev_bpf *xdp);\nint lan966x_xdp_run(struct lan966x_port *port,\n\t\t    struct page *page,\n\t\t    u32 data_len);\nint lan966x_xdp_xmit(struct net_device *dev,\n\t\t     int n,\n\t\t     struct xdp_frame **frames,\n\t\t     u32 flags);\nbool lan966x_xdp_present(struct lan966x *lan966x);\nstatic inline bool lan966x_xdp_port_present(struct lan966x_port *port)\n{\n\treturn !!port->xdp_prog;\n}\n\nint lan966x_vcap_init(struct lan966x *lan966x);\nvoid lan966x_vcap_deinit(struct lan966x *lan966x);\n#if defined(CONFIG_DEBUG_FS)\nint lan966x_vcap_port_info(struct net_device *dev,\n\t\t\t   struct vcap_admin *admin,\n\t\t\t   struct vcap_output_print *out);\n#else\nstatic inline int lan966x_vcap_port_info(struct net_device *dev,\n\t\t\t\t\t struct vcap_admin *admin,\n\t\t\t\t\t struct vcap_output_print *out)\n{\n\treturn 0;\n}\n#endif\n\nint lan966x_tc_flower(struct lan966x_port *port,\n\t\t      struct flow_cls_offload *f,\n\t\t      bool ingress);\n\nint lan966x_goto_port_add(struct lan966x_port *port,\n\t\t\t  int from_cid, int to_cid,\n\t\t\t  unsigned long goto_id,\n\t\t\t  struct netlink_ext_ack *extack);\nint lan966x_goto_port_del(struct lan966x_port *port,\n\t\t\t  unsigned long goto_id,\n\t\t\t  struct netlink_ext_ack *extack);\n\n#ifdef CONFIG_LAN966X_DCB\nvoid lan966x_dcb_init(struct lan966x *lan966x);\n#else\nstatic inline void lan966x_dcb_init(struct lan966x *lan966x)\n{\n}\n#endif\n\nstatic inline void __iomem *lan_addr(void __iomem *base[],\n\t\t\t\t     int id, int tinst, int tcnt,\n\t\t\t\t     int gbase, int ginst,\n\t\t\t\t     int gcnt, int gwidth,\n\t\t\t\t     int raddr, int rinst,\n\t\t\t\t     int rcnt, int rwidth)\n{\n\tWARN_ON((tinst) >= tcnt);\n\tWARN_ON((ginst) >= gcnt);\n\tWARN_ON((rinst) >= rcnt);\n\treturn base[id + (tinst)] +\n\t\tgbase + ((ginst) * gwidth) +\n\t\traddr + ((rinst) * rwidth);\n}\n\nstatic inline u32 lan_rd(struct lan966x *lan966x, int id, int tinst, int tcnt,\n\t\t\t int gbase, int ginst, int gcnt, int gwidth,\n\t\t\t int raddr, int rinst, int rcnt, int rwidth)\n{\n\treturn readl(lan_addr(lan966x->regs, id, tinst, tcnt, gbase, ginst,\n\t\t\t      gcnt, gwidth, raddr, rinst, rcnt, rwidth));\n}\n\nstatic inline void lan_wr(u32 val, struct lan966x *lan966x,\n\t\t\t  int id, int tinst, int tcnt,\n\t\t\t  int gbase, int ginst, int gcnt, int gwidth,\n\t\t\t  int raddr, int rinst, int rcnt, int rwidth)\n{\n\twritel(val, lan_addr(lan966x->regs, id, tinst, tcnt,\n\t\t\t     gbase, ginst, gcnt, gwidth,\n\t\t\t     raddr, rinst, rcnt, rwidth));\n}\n\nstatic inline void lan_rmw(u32 val, u32 mask, struct lan966x *lan966x,\n\t\t\t   int id, int tinst, int tcnt,\n\t\t\t   int gbase, int ginst, int gcnt, int gwidth,\n\t\t\t   int raddr, int rinst, int rcnt, int rwidth)\n{\n\tu32 nval;\n\n\tnval = readl(lan_addr(lan966x->regs, id, tinst, tcnt, gbase, ginst,\n\t\t\t      gcnt, gwidth, raddr, rinst, rcnt, rwidth));\n\tnval = (nval & ~mask) | (val & mask);\n\twritel(nval, lan_addr(lan966x->regs, id, tinst, tcnt, gbase, ginst,\n\t\t\t      gcnt, gwidth, raddr, rinst, rcnt, rwidth));\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}