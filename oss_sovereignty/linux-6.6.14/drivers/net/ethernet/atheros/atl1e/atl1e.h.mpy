{
  "module_name": "atl1e.h",
  "hash_id": "6626cf54f706329a70f62f4575b1832995a05d066ef3d15aec07c1f1555f0862",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/atheros/atl1e/atl1e.h",
  "human_readable_source": " \n \n\n#ifndef _ATL1E_H_\n#define _ATL1E_H_\n\n#include <linux/interrupt.h>\n#include <linux/types.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n#include <linux/pci.h>\n#include <linux/netdevice.h>\n#include <linux/etherdevice.h>\n#include <linux/skbuff.h>\n#include <linux/ioport.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/in.h>\n#include <linux/ip.h>\n#include <linux/ipv6.h>\n#include <linux/udp.h>\n#include <linux/mii.h>\n#include <linux/io.h>\n#include <linux/vmalloc.h>\n#include <linux/pagemap.h>\n#include <linux/tcp.h>\n#include <linux/ethtool.h>\n#include <linux/if_vlan.h>\n#include <linux/workqueue.h>\n#include <net/checksum.h>\n#include <net/ip6_checksum.h>\n\n#include \"atl1e_hw.h\"\n\n#define PCI_REG_COMMAND\t 0x04     \n#define CMD_IO_SPACE\t 0x0001\n#define CMD_MEMORY_SPACE 0x0002\n#define CMD_BUS_MASTER   0x0004\n\n#define BAR_0   0\n#define BAR_1   1\n#define BAR_5   5\n\n \n#define AT_WUFC_LNKC 0x00000001  \n#define AT_WUFC_MAG  0x00000002  \n#define AT_WUFC_EX   0x00000004  \n#define AT_WUFC_MC   0x00000008  \n#define AT_WUFC_BC   0x00000010  \n\n#define SPEED_0\t\t   0xffff\n#define HALF_DUPLEX        1\n#define FULL_DUPLEX        2\n\n \n#define AT_ERR_EEPROM      1\n#define AT_ERR_PHY         2\n#define AT_ERR_CONFIG      3\n#define AT_ERR_PARAM       4\n#define AT_ERR_MAC_TYPE    5\n#define AT_ERR_PHY_TYPE    6\n#define AT_ERR_PHY_SPEED   7\n#define AT_ERR_PHY_RES     8\n#define AT_ERR_TIMEOUT     9\n\n#define MAX_JUMBO_FRAME_SIZE 0x2000\n\n#define AT_VLAN_TAG_TO_TPD_TAG(_vlan, _tpd)    \\\n\t_tpd = (((_vlan) << (4)) | (((_vlan) >> 13) & 7) |\\\n\t\t (((_vlan) >> 9) & 8))\n\n#define AT_TPD_TAG_TO_VLAN_TAG(_tpd, _vlan)    \\\n\t_vlan = (((_tpd) >> 8) | (((_tpd) & 0x77) << 9) |\\\n\t\t   (((_tdp) & 0x88) << 5))\n\n#define AT_MAX_RECEIVE_QUEUE    4\n#define AT_PAGE_NUM_PER_QUEUE   2\n\n#define AT_DMA_HI_ADDR_MASK     0xffffffff00000000ULL\n#define AT_DMA_LO_ADDR_MASK     0x00000000ffffffffULL\n\n#define AT_TX_WATCHDOG  (5 * HZ)\n#define AT_MAX_INT_WORK\t\t10\n#define AT_TWSI_EEPROM_TIMEOUT \t100\n#define AT_HW_MAX_IDLE_DELAY \t10\n#define AT_SUSPEND_LINK_TIMEOUT 28\n\n#define AT_REGS_LEN\t75\n#define AT_EEPROM_LEN \t512\n#define AT_ADV_MASK\t(ADVERTISE_10_HALF  |\\\n\t\t\t ADVERTISE_10_FULL  |\\\n\t\t\t ADVERTISE_100_HALF |\\\n\t\t\t ADVERTISE_100_FULL |\\\n\t\t\t ADVERTISE_1000_FULL)\n\n \n#define TPD_BUFLEN_MASK \t0x3FFF\n#define TPD_BUFLEN_SHIFT        0\n#define TPD_DMAINT_MASK\t\t0x0001\n#define TPD_DMAINT_SHIFT        14\n#define TPD_PKTNT_MASK          0x0001\n#define TPD_PKTINT_SHIFT        15\n#define TPD_VLANTAG_MASK        0xFFFF\n#define TPD_VLAN_SHIFT          16\n\n \n#define TPD_EOP_MASK            0x0001\n#define TPD_EOP_SHIFT           0\n#define TPD_IP_VERSION_MASK\t0x0001\n#define TPD_IP_VERSION_SHIFT\t1\t \n#define TPD_INS_VL_TAG_MASK\t0x0001\n#define TPD_INS_VL_TAG_SHIFT\t2\n#define TPD_CC_SEGMENT_EN_MASK\t0x0001\n#define TPD_CC_SEGMENT_EN_SHIFT\t3\n#define TPD_SEGMENT_EN_MASK     0x0001\n#define TPD_SEGMENT_EN_SHIFT    4\n\n \n#define TPD_IP_CSUM_MASK        0x0001\n#define TPD_IP_CSUM_SHIFT       5\n#define TPD_TCP_CSUM_MASK       0x0001\n#define TPD_TCP_CSUM_SHIFT      6\n#define TPD_UDP_CSUM_MASK       0x0001\n#define TPD_UDP_CSUM_SHIFT      7\n\n \n#define TPD_V6_IPHLLO_MASK\t0x0007\n#define TPD_V6_IPHLLO_SHIFT\t7\n\n \n#define TPD_VL_TAGGED_MASK      0x0001\n#define TPD_VL_TAGGED_SHIFT     8\n#define TPD_ETHTYPE_MASK        0x0001\n#define TPD_ETHTYPE_SHIFT       9\n\n \n#define TDP_V4_IPHL_MASK\t0x000F\n#define TPD_V4_IPHL_SHIFT\t10\n\n \n#define TPD_V6_IPHLHI_MASK\t0x000F\n#define TPD_V6_IPHLHI_SHIFT\t10\n\n \n#define TPD_TCPHDRLEN_MASK      0x000F\n#define TPD_TCPHDRLEN_SHIFT     14\n#define TPD_HDRFLAG_MASK        0x0001\n#define TPD_HDRFLAG_SHIFT       18\n#define TPD_MSS_MASK            0x1FFF\n#define TPD_MSS_SHIFT           19\n\n \n#define TPD_PLOADOFFSET_MASK    0x00FF\n#define TPD_PLOADOFFSET_SHIFT   16\n#define TPD_CCSUMOFFSET_MASK    0x00FF\n#define TPD_CCSUMOFFSET_SHIFT   24\n\nstruct atl1e_tpd_desc {\n\t__le64 buffer_addr;\n\t__le32 word2;\n\t__le32 word3;\n};\n\n \n#define MAX_TX_BUF_LEN      0x2000\n#define MAX_TX_BUF_SHIFT    13\n#define MAX_TSO_SEG_SIZE    0x3c00\n\n \n#define RRS_RX_CSUM_MASK\t0xFFFF\n#define RRS_RX_CSUM_SHIFT\t0\n#define RRS_PKT_SIZE_MASK\t0x3FFF\n#define RRS_PKT_SIZE_SHIFT\t16\n#define RRS_CPU_NUM_MASK\t0x0003\n#define\tRRS_CPU_NUM_SHIFT\t30\n\n#define\tRRS_IS_RSS_IPV4\t\t0x0001\n#define RRS_IS_RSS_IPV4_TCP\t0x0002\n#define RRS_IS_RSS_IPV6\t\t0x0004\n#define RRS_IS_RSS_IPV6_TCP\t0x0008\n#define RRS_IS_IPV6\t\t0x0010\n#define RRS_IS_IP_FRAG\t\t0x0020\n#define RRS_IS_IP_DF\t\t0x0040\n#define RRS_IS_802_3\t\t0x0080\n#define RRS_IS_VLAN_TAG\t\t0x0100\n#define RRS_IS_ERR_FRAME\t0x0200\n#define RRS_IS_IPV4\t\t0x0400\n#define RRS_IS_UDP\t\t0x0800\n#define RRS_IS_TCP\t\t0x1000\n#define RRS_IS_BCAST\t\t0x2000\n#define RRS_IS_MCAST\t\t0x4000\n#define RRS_IS_PAUSE\t\t0x8000\n\n#define RRS_ERR_BAD_CRC\t\t0x0001\n#define RRS_ERR_CODE\t\t0x0002\n#define RRS_ERR_DRIBBLE\t\t0x0004\n#define RRS_ERR_RUNT\t\t0x0008\n#define RRS_ERR_RX_OVERFLOW\t0x0010\n#define RRS_ERR_TRUNC\t\t0x0020\n#define RRS_ERR_IP_CSUM\t\t0x0040\n#define RRS_ERR_L4_CSUM\t\t0x0080\n#define RRS_ERR_LENGTH\t\t0x0100\n#define RRS_ERR_DES_ADDR\t0x0200\n\nstruct atl1e_recv_ret_status {\n\tu16 seq_num;\n\tu16 hash_lo;\n\t__le32\tword1;\n\tu16 pkt_flag;\n\tu16 err_flag;\n\tu16 hash_hi;\n\tu16 vtag;\n};\n\nenum atl1e_dma_req_block {\n\tatl1e_dma_req_128 = 0,\n\tatl1e_dma_req_256 = 1,\n\tatl1e_dma_req_512 = 2,\n\tatl1e_dma_req_1024 = 3,\n\tatl1e_dma_req_2048 = 4,\n\tatl1e_dma_req_4096 = 5\n};\n\nenum atl1e_rrs_type {\n\tatl1e_rrs_disable = 0,\n\tatl1e_rrs_ipv4 = 1,\n\tatl1e_rrs_ipv4_tcp = 2,\n\tatl1e_rrs_ipv6 = 4,\n\tatl1e_rrs_ipv6_tcp = 8\n};\n\nenum atl1e_nic_type {\n\tathr_l1e = 0,\n\tathr_l2e_revA = 1,\n\tathr_l2e_revB = 2\n};\n\nstruct atl1e_hw_stats {\n\t \n\tunsigned long rx_ok;\t       \n\tunsigned long rx_bcast;        \n\tunsigned long rx_mcast;        \n\tunsigned long rx_pause;        \n\tunsigned long rx_ctrl;         \n\tunsigned long rx_fcs_err;      \n\tunsigned long rx_len_err;      \n\tunsigned long rx_byte_cnt;     \n\tunsigned long rx_runt;         \n\tunsigned long rx_frag;         \n\tunsigned long rx_sz_64;        \n\tunsigned long rx_sz_65_127;    \n\tunsigned long rx_sz_128_255;   \n\tunsigned long rx_sz_256_511;   \n\tunsigned long rx_sz_512_1023;  \n\tunsigned long rx_sz_1024_1518;     \n\tunsigned long rx_sz_1519_max;  \n\tunsigned long rx_sz_ov;        \n\tunsigned long rx_rxf_ov;       \n\tunsigned long rx_rrd_ov;       \n\tunsigned long rx_align_err;    \n\tunsigned long rx_bcast_byte_cnt;   \n\tunsigned long rx_mcast_byte_cnt;   \n\tunsigned long rx_err_addr;     \n\n\t \n\tunsigned long tx_ok;       \n\tunsigned long tx_bcast;        \n\tunsigned long tx_mcast;        \n\tunsigned long tx_pause;        \n\tunsigned long tx_exc_defer;    \n\tunsigned long tx_ctrl;         \n\tunsigned long tx_defer;        \n\tunsigned long tx_byte_cnt;     \n\tunsigned long tx_sz_64;        \n\tunsigned long tx_sz_65_127;    \n\tunsigned long tx_sz_128_255;   \n\tunsigned long tx_sz_256_511;   \n\tunsigned long tx_sz_512_1023;  \n\tunsigned long tx_sz_1024_1518;     \n\tunsigned long tx_sz_1519_max;  \n\tunsigned long tx_1_col;        \n\tunsigned long tx_2_col;        \n\tunsigned long tx_late_col;     \n\tunsigned long tx_abort_col;    \n\tunsigned long tx_underrun;     \n\tunsigned long tx_rd_eop;       \n\tunsigned long tx_len_err;      \n\tunsigned long tx_trunc;        \n\tunsigned long tx_bcast_byte;   \n\tunsigned long tx_mcast_byte;   \n};\n\nstruct atl1e_hw {\n\tu8 __iomem      *hw_addr;             \n\tresource_size_t mem_rang;\n\tstruct atl1e_adapter *adapter;\n\tenum atl1e_nic_type  nic_type;\n\tu16 device_id;\n\tu16 vendor_id;\n\tu16 subsystem_id;\n\tu16 subsystem_vendor_id;\n\tu8  revision_id;\n\tu16 pci_cmd_word;\n\tu8 mac_addr[ETH_ALEN];\n\tu8 perm_mac_addr[ETH_ALEN];\n\tu8 preamble_len;\n\tu16 max_frame_size;\n\tu16 rx_jumbo_th;\n\tu16 tx_jumbo_th;\n\n\tu16 media_type;\n#define MEDIA_TYPE_AUTO_SENSOR  0\n#define MEDIA_TYPE_100M_FULL    1\n#define MEDIA_TYPE_100M_HALF    2\n#define MEDIA_TYPE_10M_FULL     3\n#define MEDIA_TYPE_10M_HALF     4\n\n\tu16 autoneg_advertised;\n#define ADVERTISE_10_HALF               0x0001\n#define ADVERTISE_10_FULL               0x0002\n#define ADVERTISE_100_HALF              0x0004\n#define ADVERTISE_100_FULL              0x0008\n#define ADVERTISE_1000_HALF             0x0010  \n#define ADVERTISE_1000_FULL             0x0020\n\tu16 mii_autoneg_adv_reg;\n\tu16 mii_1000t_ctrl_reg;\n\n\tu16 imt;         \n\tu16 ict;         \n\tu32 smb_timer;\n\tu16 rrd_thresh;  \n\tu16 tpd_thresh;\n\tu16 rx_count_down;  \n\tu16 tx_count_down;\n\n\tu8 tpd_burst;    \n\tenum atl1e_rrs_type rrs_type;\n\tu32 base_cpu;\n\tu32 indirect_tab;\n\n\tenum atl1e_dma_req_block dmar_block;\n\tenum atl1e_dma_req_block dmaw_block;\n\tu8 dmaw_dly_cnt;\n\tu8 dmar_dly_cnt;\n\n\tbool phy_configured;\n\tbool re_autoneg;\n\tbool emi_ca;\n};\n\n \nstruct atl1e_tx_buffer {\n\tstruct sk_buff *skb;\n\tu16 flags;\n#define ATL1E_TX_PCIMAP_SINGLE\t\t0x0001\n#define ATL1E_TX_PCIMAP_PAGE\t\t0x0002\n#define ATL1E_TX_PCIMAP_TYPE_MASK\t0x0003\n\tu16 length;\n\tdma_addr_t dma;\n};\n\n#define ATL1E_SET_PCIMAP_TYPE(tx_buff, type) do {\t\t\\\n\t((tx_buff)->flags) &= ~ATL1E_TX_PCIMAP_TYPE_MASK;\t\\\n\t((tx_buff)->flags) |= (type);\t\t\t\t\\\n\t} while (0)\n\nstruct atl1e_rx_page {\n\tdma_addr_t\tdma;     \n\tu8\t\t*addr;    \n\tdma_addr_t\twrite_offset_dma;   \n\tu32\t\t*write_offset_addr;  \n\tu32\t\tread_offset;        \n};\n\nstruct atl1e_rx_page_desc {\n\tstruct atl1e_rx_page   rx_page[AT_PAGE_NUM_PER_QUEUE];\n\tu8  rx_using;\n\tu16 rx_nxseq;\n};\n\n \nstruct atl1e_tx_ring {\n\tstruct atl1e_tpd_desc *desc;   \n\tdma_addr_t\t   dma;     \n\tu16       \t   count;   \n\trwlock_t\t   tx_lock;\n\tu16\t\t   next_to_use;\n\tatomic_t\t   next_to_clean;\n\tstruct atl1e_tx_buffer *tx_buffer;\n\tdma_addr_t\t   cmb_dma;\n\tu32\t\t   *cmb;\n};\n\n \nstruct atl1e_rx_ring {\n\tvoid        \t*desc;\n\tdma_addr_t  \tdma;\n\tint         \tsize;\n\tu32\t    \tpage_size;  \n\tu32\t\treal_page_size;  \n\tstruct atl1e_rx_page_desc\trx_page_desc[AT_MAX_RECEIVE_QUEUE];\n};\n\n \nstruct atl1e_adapter {\n\tstruct net_device   *netdev;\n\tstruct pci_dev      *pdev;\n\tstruct napi_struct  napi;\n\tstruct mii_if_info  mii;     \n\tstruct atl1e_hw        hw;\n\tstruct atl1e_hw_stats  hw_stats;\n\n\tu32 wol;\n\tu16 link_speed;\n\tu16 link_duplex;\n\n\tspinlock_t mdio_lock;\n\tatomic_t irq_sem;\n\n\tstruct work_struct reset_task;\n\tstruct work_struct link_chg_task;\n\tstruct timer_list watchdog_timer;\n\tstruct timer_list phy_config_timer;\n\n\t \n\tdma_addr_t  \tring_dma;\n\tvoid     \t*ring_vir_addr;\n\tu32             ring_size;\n\n\tstruct atl1e_tx_ring tx_ring;\n\tstruct atl1e_rx_ring rx_ring;\n\tint num_rx_queues;\n\tunsigned long flags;\n#define __AT_TESTING        0x0001\n#define __AT_RESETTING      0x0002\n#define __AT_DOWN           0x0003\n\n\tu32 bd_number;      \n\tu32 pci_state[16];\n\tu32 *config_space;\n};\n\n#define AT_WRITE_REG(a, reg, value) ( \\\n\t\twritel((value), ((a)->hw_addr + reg)))\n\n#define AT_WRITE_FLUSH(a) (\\\n\t\treadl((a)->hw_addr))\n\n#define AT_READ_REG(a, reg) ( \\\n\t\treadl((a)->hw_addr + reg))\n\n#define AT_WRITE_REGB(a, reg, value) (\\\n\t\twriteb((value), ((a)->hw_addr + reg)))\n\n#define AT_READ_REGB(a, reg) (\\\n\t\treadb((a)->hw_addr + reg))\n\n#define AT_WRITE_REGW(a, reg, value) (\\\n\t\twritew((value), ((a)->hw_addr + reg)))\n\n#define AT_READ_REGW(a, reg) (\\\n\t\treadw((a)->hw_addr + reg))\n\n#define AT_WRITE_REG_ARRAY(a, reg, offset, value) ( \\\n\t\twritel((value), (((a)->hw_addr + reg) + ((offset) << 2))))\n\n#define AT_READ_REG_ARRAY(a, reg, offset) ( \\\n\t\treadl(((a)->hw_addr + reg) + ((offset) << 2)))\n\nextern char atl1e_driver_name[];\n\nvoid atl1e_check_options(struct atl1e_adapter *adapter);\nint atl1e_up(struct atl1e_adapter *adapter);\nvoid atl1e_down(struct atl1e_adapter *adapter);\nvoid atl1e_reinit_locked(struct atl1e_adapter *adapter);\ns32 atl1e_reset_hw(struct atl1e_hw *hw);\nvoid atl1e_set_ethtool_ops(struct net_device *netdev);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}