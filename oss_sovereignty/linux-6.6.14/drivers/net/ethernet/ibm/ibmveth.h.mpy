{
  "module_name": "ibmveth.h",
  "hash_id": "3f05165fb26a43d8eb698a305a280769a04c083a1b588614d9f49a03031ea455",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/ibm/ibmveth.h",
  "human_readable_source": " \n \n\n#ifndef _IBMVETH_H\n#define _IBMVETH_H\n\n \n#define IbmVethMcastReceptionModifyBit     0x80000UL\n#define IbmVethMcastReceptionEnableBit     0x20000UL\n#define IbmVethMcastFilterModifyBit        0x40000UL\n#define IbmVethMcastFilterEnableBit        0x10000UL\n\n#define IbmVethMcastEnableRecv       (IbmVethMcastReceptionModifyBit | IbmVethMcastReceptionEnableBit)\n#define IbmVethMcastDisableRecv      (IbmVethMcastReceptionModifyBit)\n#define IbmVethMcastEnableFiltering  (IbmVethMcastFilterModifyBit | IbmVethMcastFilterEnableBit)\n#define IbmVethMcastDisableFiltering (IbmVethMcastFilterModifyBit)\n#define IbmVethMcastAddFilter        0x1UL\n#define IbmVethMcastRemoveFilter     0x2UL\n#define IbmVethMcastClearFilterTable 0x3UL\n\n#define IBMVETH_ILLAN_LRG_SR_ENABLED\t0x0000000000010000UL\n#define IBMVETH_ILLAN_LRG_SND_SUPPORT\t0x0000000000008000UL\n#define IBMVETH_ILLAN_PADDED_PKT_CSUM\t0x0000000000002000UL\n#define IBMVETH_ILLAN_TRUNK_PRI_MASK\t0x0000000000000F00UL\n#define IBMVETH_ILLAN_IPV6_TCP_CSUM\t\t0x0000000000000004UL\n#define IBMVETH_ILLAN_IPV4_TCP_CSUM\t\t0x0000000000000002UL\n#define IBMVETH_ILLAN_ACTIVE_TRUNK\t\t0x0000000000000001UL\n\n \n#define h_register_logical_lan(ua, buflst, rxq, fltlst, mac) \\\n  plpar_hcall_norets(H_REGISTER_LOGICAL_LAN, ua, buflst, rxq, fltlst, mac)\n\n#define h_free_logical_lan(ua) \\\n  plpar_hcall_norets(H_FREE_LOGICAL_LAN, ua)\n\n#define h_add_logical_lan_buffer(ua, buf) \\\n  plpar_hcall_norets(H_ADD_LOGICAL_LAN_BUFFER, ua, buf)\n\n \nstatic inline long h_send_logical_lan(unsigned long unit_address,\n\t\tunsigned long desc, unsigned long corellator_in,\n\t\tunsigned long *corellator_out, unsigned long mss,\n\t\tunsigned long large_send_support)\n{\n\tlong rc;\n\tunsigned long retbuf[PLPAR_HCALL9_BUFSIZE];\n\n\tif (large_send_support)\n\t\trc = plpar_hcall9(H_SEND_LOGICAL_LAN, retbuf, unit_address,\n\t\t\t\t  desc, 0, 0, 0, 0, 0, corellator_in, mss);\n\telse\n\t\trc = plpar_hcall9(H_SEND_LOGICAL_LAN, retbuf, unit_address,\n\t\t\t\t  desc, 0, 0, 0, 0, 0, corellator_in);\n\n\t*corellator_out = retbuf[0];\n\n\treturn rc;\n}\n\nstatic inline long h_illan_attributes(unsigned long unit_address,\n\t\t\t\t      unsigned long reset_mask, unsigned long set_mask,\n\t\t\t\t      unsigned long *ret_attributes)\n{\n\tlong rc;\n\tunsigned long retbuf[PLPAR_HCALL_BUFSIZE];\n\n\trc = plpar_hcall(H_ILLAN_ATTRIBUTES, retbuf, unit_address,\n\t\t\t reset_mask, set_mask);\n\n\t*ret_attributes = retbuf[0];\n\n\treturn rc;\n}\n\n#define h_multicast_ctrl(ua, cmd, mac) \\\n  plpar_hcall_norets(H_MULTICAST_CTRL, ua, cmd, mac)\n\n#define h_change_logical_lan_mac(ua, mac) \\\n  plpar_hcall_norets(H_CHANGE_LOGICAL_LAN_MAC, ua, mac)\n\n#define IBMVETH_NUM_BUFF_POOLS 5\n#define IBMVETH_IO_ENTITLEMENT_DEFAULT 4243456  \n#define IBMVETH_BUFF_OH 22  \n#define IBMVETH_MIN_MTU 68\n#define IBMVETH_MAX_POOL_COUNT 4096\n#define IBMVETH_BUFF_LIST_SIZE 4096\n#define IBMVETH_FILT_LIST_SIZE 4096\n#define IBMVETH_MAX_BUF_SIZE (1024 * 128)\n#define IBMVETH_MAX_TX_BUF_SIZE (1024 * 64)\n#define IBMVETH_MAX_QUEUES 16U\n#define IBMVETH_DEFAULT_QUEUES 8U\n\nstatic int pool_size[] = { 512, 1024 * 2, 1024 * 16, 1024 * 32, 1024 * 64 };\nstatic int pool_count[] = { 256, 512, 256, 256, 256 };\nstatic int pool_count_cmo[] = { 256, 512, 256, 256, 64 };\nstatic int pool_active[] = { 1, 1, 0, 0, 1};\n\n#define IBM_VETH_INVALID_MAP ((u16)0xffff)\n\nstruct ibmveth_buff_pool {\n    u32 size;\n    u32 index;\n    u32 buff_size;\n    u32 threshold;\n    atomic_t available;\n    u32 consumer_index;\n    u32 producer_index;\n    u16 *free_map;\n    dma_addr_t *dma_addr;\n    struct sk_buff **skbuff;\n    int active;\n    struct kobject kobj;\n};\n\nstruct ibmveth_rx_q {\n    u64        index;\n    u64        num_slots;\n    u64        toggle;\n    dma_addr_t queue_dma;\n    u32        queue_len;\n    struct ibmveth_rx_q_entry *queue_addr;\n};\n\nstruct ibmveth_adapter {\n    struct vio_dev *vdev;\n    struct net_device *netdev;\n    struct napi_struct napi;\n    unsigned int mcastFilterSize;\n    void * buffer_list_addr;\n    void * filter_list_addr;\n    void *tx_ltb_ptr[IBMVETH_MAX_QUEUES];\n    unsigned int tx_ltb_size;\n    dma_addr_t tx_ltb_dma[IBMVETH_MAX_QUEUES];\n    dma_addr_t buffer_list_dma;\n    dma_addr_t filter_list_dma;\n    struct ibmveth_buff_pool rx_buff_pool[IBMVETH_NUM_BUFF_POOLS];\n    struct ibmveth_rx_q rx_queue;\n    int rx_csum;\n    int large_send;\n    bool is_active_trunk;\n\n    u64 fw_ipv6_csum_support;\n    u64 fw_ipv4_csum_support;\n    u64 fw_large_send_support;\n     \n    u64 replenish_task_cycles;\n    u64 replenish_no_mem;\n    u64 replenish_add_buff_failure;\n    u64 replenish_add_buff_success;\n    u64 rx_invalid_buffer;\n    u64 rx_no_buffer;\n    u64 tx_map_failed;\n    u64 tx_send_failed;\n    u64 tx_large_packets;\n    u64 rx_large_packets;\n     \n\tu8 duplex;\n\tu32 speed;\n};\n\n \nstruct ibmveth_buf_desc_fields {\n#ifdef __BIG_ENDIAN\n\tu32 flags_len;\n\tu32 address;\n#else\n\tu32 address;\n\tu32 flags_len;\n#endif\n#define IBMVETH_BUF_VALID\t0x80000000\n#define IBMVETH_BUF_TOGGLE\t0x40000000\n#define IBMVETH_BUF_LRG_SND     0x04000000\n#define IBMVETH_BUF_NO_CSUM\t0x02000000\n#define IBMVETH_BUF_CSUM_GOOD\t0x01000000\n#define IBMVETH_BUF_LEN_MASK\t0x00FFFFFF\n};\n\nunion ibmveth_buf_desc {\n    u64 desc;\n    struct ibmveth_buf_desc_fields fields;\n};\n\nstruct ibmveth_rx_q_entry {\n\t__be32 flags_off;\n#define IBMVETH_RXQ_TOGGLE\t\t0x80000000\n#define IBMVETH_RXQ_TOGGLE_SHIFT\t31\n#define IBMVETH_RXQ_VALID\t\t0x40000000\n#define IBMVETH_RXQ_LRG_PKT\t\t0x04000000\n#define IBMVETH_RXQ_NO_CSUM\t\t0x02000000\n#define IBMVETH_RXQ_CSUM_GOOD\t\t0x01000000\n#define IBMVETH_RXQ_OFF_MASK\t\t0x0000FFFF\n\n\t__be32 length;\n\t \n\tu64 correlator;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}