{
  "module_name": "emac.h",
  "hash_id": "8b7c06348a91bacb1b19b53c028459fa74f83f9aa610769d112b335265c77682",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/arc/emac.h",
  "human_readable_source": " \n \n\n#ifndef ARC_EMAC_H\n#define ARC_EMAC_H\n\n#include <linux/device.h>\n#include <linux/dma-mapping.h>\n#include <linux/netdevice.h>\n#include <linux/phy.h>\n#include <linux/clk.h>\n\n \n#define TXINT_MASK\t(1 << 0)\t \n#define RXINT_MASK\t(1 << 1)\t \n#define ERR_MASK\t(1 << 2)\t \n#define TXCH_MASK\t(1 << 3)\t \n#define MSER_MASK\t(1 << 4)\t \n#define RXCR_MASK\t(1 << 8)\t \n#define RXFR_MASK\t(1 << 9)\t \n#define RXFL_MASK\t(1 << 10)\t \n#define MDIO_MASK\t(1 << 12)\t \n#define TXPL_MASK\t(1 << 31)\t \n\n \n#define EN_MASK\t\t(1 << 0)\t \n#define TXRN_MASK\t(1 << 3)\t \n#define RXRN_MASK\t(1 << 4)\t \n#define DSBC_MASK\t(1 << 8)\t \n#define ENFL_MASK\t(1 << 10)\t \n#define PROM_MASK\t(1 << 11)\t \n\n \n#define OWN_MASK\t(1 << 31)\t \n#define FIRST_MASK\t(1 << 16)\t \n#define LAST_MASK\t(1 << 17)\t \n#define LEN_MASK\t0x000007FF\t \n#define CRLS\t\t(1 << 21)\n#define DEFR\t\t(1 << 22)\n#define DROP\t\t(1 << 23)\n#define RTRY\t\t(1 << 24)\n#define LTCL\t\t(1 << 28)\n#define UFLO\t\t(1 << 29)\n\n#define FOR_EMAC\tOWN_MASK\n#define FOR_CPU\t\t0\n\n \nenum {\n\tR_ID = 0,\n\tR_STATUS,\n\tR_ENABLE,\n\tR_CTRL,\n\tR_POLLRATE,\n\tR_RXERR,\n\tR_MISS,\n\tR_TX_RING,\n\tR_RX_RING,\n\tR_ADDRL,\n\tR_ADDRH,\n\tR_LAFL,\n\tR_LAFH,\n\tR_MDIO,\n};\n\n#define TX_TIMEOUT\t\t(400 * HZ / 1000)  \n\n#define ARC_EMAC_NAPI_WEIGHT\t40\t\t \n\n#define EMAC_BUFFER_SIZE\t1536\t\t \n\n \nstruct arc_emac_bd {\n\t__le32 info;\n\tdma_addr_t data;\n};\n\n \n#define RX_BD_NUM\t128\n#define TX_BD_NUM\t128\n\n#define RX_RING_SZ\t(RX_BD_NUM * sizeof(struct arc_emac_bd))\n#define TX_RING_SZ\t(TX_BD_NUM * sizeof(struct arc_emac_bd))\n\n \nstruct buffer_state {\n\tstruct sk_buff *skb;\n\tDEFINE_DMA_UNMAP_ADDR(addr);\n\tDEFINE_DMA_UNMAP_LEN(len);\n};\n\nstruct arc_emac_mdio_bus_data {\n\tstruct gpio_desc *reset_gpio;\n\tint msec;\n};\n\n \nstruct arc_emac_priv {\n\tconst char *drv_name;\n\tvoid (*set_mac_speed)(void *priv, unsigned int speed);\n\n\t \n\tstruct device *dev;\n\tstruct mii_bus *bus;\n\tstruct arc_emac_mdio_bus_data bus_data;\n\n\tvoid __iomem *regs;\n\tstruct clk *clk;\n\n\tstruct napi_struct napi;\n\n\tstruct arc_emac_bd *rxbd;\n\tstruct arc_emac_bd *txbd;\n\n\tdma_addr_t rxbd_dma;\n\tdma_addr_t txbd_dma;\n\n\tstruct buffer_state rx_buff[RX_BD_NUM];\n\tstruct buffer_state tx_buff[TX_BD_NUM];\n\tunsigned int txbd_curr;\n\tunsigned int txbd_dirty;\n\n\tunsigned int last_rx_bd;\n\n\tunsigned int link;\n\tunsigned int duplex;\n\tunsigned int speed;\n\n\tunsigned int rx_missed_errors;\n};\n\n \nstatic inline void arc_reg_set(struct arc_emac_priv *priv, int reg, int value)\n{\n\tiowrite32(value, priv->regs + reg * sizeof(int));\n}\n\n \nstatic inline unsigned int arc_reg_get(struct arc_emac_priv *priv, int reg)\n{\n\treturn ioread32(priv->regs + reg * sizeof(int));\n}\n\n \nstatic inline void arc_reg_or(struct arc_emac_priv *priv, int reg, int mask)\n{\n\tunsigned int value = arc_reg_get(priv, reg);\n\n\tarc_reg_set(priv, reg, value | mask);\n}\n\n \nstatic inline void arc_reg_clr(struct arc_emac_priv *priv, int reg, int mask)\n{\n\tunsigned int value = arc_reg_get(priv, reg);\n\n\tarc_reg_set(priv, reg, value & ~mask);\n}\n\nint arc_mdio_probe(struct arc_emac_priv *priv);\nint arc_mdio_remove(struct arc_emac_priv *priv);\nint arc_emac_probe(struct net_device *ndev, int interface);\nvoid arc_emac_remove(struct net_device *ndev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}