{
  "module_name": "emac_arc.c",
  "hash_id": "4f61621e19c0dd00ef495dc3cac6bbd02d07d69c34da6b41f672b272cec12e87",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/arc/emac_arc.c",
  "human_readable_source": "\n \n\n#include <linux/etherdevice.h>\n#include <linux/module.h>\n#include <linux/of_net.h>\n#include <linux/platform_device.h>\n\n#include \"emac.h\"\n\n#define DRV_NAME    \"emac_arc\"\n\nstatic int emac_arc_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct arc_emac_priv *priv;\n\tphy_interface_t interface;\n\tstruct net_device *ndev;\n\tint err;\n\n\tif (!dev->of_node)\n\t\treturn -ENODEV;\n\n\tndev = alloc_etherdev(sizeof(struct arc_emac_priv));\n\tif (!ndev)\n\t\treturn -ENOMEM;\n\tplatform_set_drvdata(pdev, ndev);\n\tSET_NETDEV_DEV(ndev, dev);\n\n\tpriv = netdev_priv(ndev);\n\tpriv->drv_name = DRV_NAME;\n\n\terr = of_get_phy_mode(dev->of_node, &interface);\n\tif (err) {\n\t\tif (err == -ENODEV)\n\t\t\tinterface = PHY_INTERFACE_MODE_MII;\n\t\telse\n\t\t\tgoto out_netdev;\n\t}\n\n\tpriv->clk = devm_clk_get(dev, \"hclk\");\n\tif (IS_ERR(priv->clk)) {\n\t\tdev_err(dev, \"failed to retrieve host clock from device tree\\n\");\n\t\terr = -EINVAL;\n\t\tgoto out_netdev;\n\t}\n\n\terr = arc_emac_probe(ndev, interface);\nout_netdev:\n\tif (err)\n\t\tfree_netdev(ndev);\n\treturn err;\n}\n\nstatic int emac_arc_remove(struct platform_device *pdev)\n{\n\tstruct net_device *ndev = platform_get_drvdata(pdev);\n\n\tarc_emac_remove(ndev);\n\tfree_netdev(ndev);\n\n\treturn 0;\n}\n\nstatic const struct of_device_id emac_arc_dt_ids[] = {\n\t{ .compatible = \"snps,arc-emac\" },\n\t{   }\n};\nMODULE_DEVICE_TABLE(of, emac_arc_dt_ids);\n\nstatic struct platform_driver emac_arc_driver = {\n\t.probe = emac_arc_probe,\n\t.remove = emac_arc_remove,\n\t.driver = {\n\t\t.name = DRV_NAME,\n\t\t.of_match_table  = emac_arc_dt_ids,\n\t},\n};\n\nmodule_platform_driver(emac_arc_driver);\n\nMODULE_AUTHOR(\"Romain Perier <romain.perier@gmail.com>\");\nMODULE_DESCRIPTION(\"ARC EMAC platform driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}