{
  "module_name": "mvpp2_cls.h",
  "hash_id": "2b0a66763a3a57fdd9c1f3de7597a33e072812d63ebbc8af2a82b2f11714a4cc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/marvell/mvpp2/mvpp2_cls.h",
  "human_readable_source": " \n \n\n#ifndef _MVPP2_CLS_H_\n#define _MVPP2_CLS_H_\n\n#include \"mvpp2.h\"\n#include \"mvpp2_prs.h\"\n\n \n#define MVPP2_CLS_FLOWS_TBL_SIZE\t512\n#define MVPP2_CLS_FLOWS_TBL_DATA_WORDS\t3\n#define MVPP2_CLS_LKP_TBL_SIZE\t\t64\n#define MVPP2_CLS_RX_QUEUES\t\t256\n\n \n\n#define MVPP2_FLOW_N_FIELDS\t\t4\n\nenum mvpp2_cls_engine {\n\tMVPP22_CLS_ENGINE_C2 = 1,\n\tMVPP22_CLS_ENGINE_C3A,\n\tMVPP22_CLS_ENGINE_C3B,\n\tMVPP22_CLS_ENGINE_C4,\n\tMVPP22_CLS_ENGINE_C3HA = 6,\n\tMVPP22_CLS_ENGINE_C3HB = 7,\n};\n\n#define MVPP22_CLS_HEK_OPT_MAC_DA\tBIT(0)\n#define MVPP22_CLS_HEK_OPT_VLAN_PRI\tBIT(1)\n#define MVPP22_CLS_HEK_OPT_VLAN\t\tBIT(2)\n#define MVPP22_CLS_HEK_OPT_L3_PROTO\tBIT(3)\n#define MVPP22_CLS_HEK_OPT_IP4SA\tBIT(4)\n#define MVPP22_CLS_HEK_OPT_IP4DA\tBIT(5)\n#define MVPP22_CLS_HEK_OPT_IP6SA\tBIT(6)\n#define MVPP22_CLS_HEK_OPT_IP6DA\tBIT(7)\n#define MVPP22_CLS_HEK_OPT_L4SIP\tBIT(8)\n#define MVPP22_CLS_HEK_OPT_L4DIP\tBIT(9)\n#define MVPP22_CLS_HEK_N_FIELDS\t\t10\n\n#define MVPP22_CLS_HEK_L4_OPTS\t(MVPP22_CLS_HEK_OPT_L4SIP | \\\n\t\t\t\t MVPP22_CLS_HEK_OPT_L4DIP)\n\n#define MVPP22_CLS_HEK_IP4_2T\t(MVPP22_CLS_HEK_OPT_IP4SA | \\\n\t\t\t\t MVPP22_CLS_HEK_OPT_IP4DA)\n\n#define MVPP22_CLS_HEK_IP6_2T\t(MVPP22_CLS_HEK_OPT_IP6SA | \\\n\t\t\t\t MVPP22_CLS_HEK_OPT_IP6DA)\n\n \n#define MVPP22_CLS_HEK_IP4_5T\t(MVPP22_CLS_HEK_IP4_2T | \\\n\t\t\t\t MVPP22_CLS_HEK_L4_OPTS)\n\n#define MVPP22_CLS_HEK_IP6_5T\t(MVPP22_CLS_HEK_IP6_2T | \\\n\t\t\t\t MVPP22_CLS_HEK_L4_OPTS)\n\n#define MVPP22_CLS_HEK_TAGGED\t(MVPP22_CLS_HEK_OPT_VLAN | \\\n\t\t\t\t MVPP22_CLS_HEK_OPT_VLAN_PRI)\n\nenum mvpp2_cls_field_id {\n\tMVPP22_CLS_FIELD_MAC_DA = 0x03,\n\tMVPP22_CLS_FIELD_VLAN_PRI = 0x05,\n\tMVPP22_CLS_FIELD_VLAN = 0x06,\n\tMVPP22_CLS_FIELD_L3_PROTO = 0x0f,\n\tMVPP22_CLS_FIELD_IP4SA = 0x10,\n\tMVPP22_CLS_FIELD_IP4DA = 0x11,\n\tMVPP22_CLS_FIELD_IP6SA = 0x17,\n\tMVPP22_CLS_FIELD_IP6DA = 0x1a,\n\tMVPP22_CLS_FIELD_L4SIP = 0x1d,\n\tMVPP22_CLS_FIELD_L4DIP = 0x1e,\n};\n\n \n#define MVPP22_CLS_C2_TCAM_EN(data)\t\t((data) << 16)\n\nenum mvpp22_cls_c2_action {\n\tMVPP22_C2_NO_UPD = 0,\n\tMVPP22_C2_NO_UPD_LOCK,\n\tMVPP22_C2_UPD,\n\tMVPP22_C2_UPD_LOCK,\n};\n\nenum mvpp22_cls_c2_fwd_action {\n\tMVPP22_C2_FWD_NO_UPD = 0,\n\tMVPP22_C2_FWD_NO_UPD_LOCK,\n\tMVPP22_C2_FWD_SW,\n\tMVPP22_C2_FWD_SW_LOCK,\n\tMVPP22_C2_FWD_HW,\n\tMVPP22_C2_FWD_HW_LOCK,\n\tMVPP22_C2_FWD_HW_LOW_LAT,\n\tMVPP22_C2_FWD_HW_LOW_LAT_LOCK,\n};\n\nenum mvpp22_cls_c2_color_action {\n\tMVPP22_C2_COL_NO_UPD = 0,\n\tMVPP22_C2_COL_NO_UPD_LOCK,\n\tMVPP22_C2_COL_GREEN,\n\tMVPP22_C2_COL_GREEN_LOCK,\n\tMVPP22_C2_COL_YELLOW,\n\tMVPP22_C2_COL_YELLOW_LOCK,\n\tMVPP22_C2_COL_RED,\t\t \n\tMVPP22_C2_COL_RED_LOCK,\t\t \n};\n\n#define MVPP2_CLS_C2_TCAM_WORDS\t\t\t5\n#define MVPP2_CLS_C2_ATTR_WORDS\t\t\t5\n\nstruct mvpp2_cls_c2_entry {\n\tu32 index;\n\t \n\tu32 tcam[MVPP2_CLS_C2_TCAM_WORDS];\n\t \n\tu32 act;\n\t \n\tu32 attr[MVPP2_CLS_C2_ATTR_WORDS];\n\t \n\tu8 valid;\n};\n\n#define MVPP22_FLOW_ETHER_BIT\tBIT(0)\n#define MVPP22_FLOW_IP4_BIT\tBIT(1)\n#define MVPP22_FLOW_IP6_BIT\tBIT(2)\n#define MVPP22_FLOW_TCP_BIT\tBIT(3)\n#define MVPP22_FLOW_UDP_BIT\tBIT(4)\n\n#define MVPP22_FLOW_TCP4\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP4_BIT | MVPP22_FLOW_TCP_BIT)\n#define MVPP22_FLOW_TCP6\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP6_BIT | MVPP22_FLOW_TCP_BIT)\n#define MVPP22_FLOW_UDP4\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP4_BIT | MVPP22_FLOW_UDP_BIT)\n#define MVPP22_FLOW_UDP6\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP6_BIT | MVPP22_FLOW_UDP_BIT)\n#define MVPP22_FLOW_IP4\t\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP4_BIT)\n#define MVPP22_FLOW_IP6\t\t(MVPP22_FLOW_ETHER_BIT | MVPP22_FLOW_IP6_BIT)\n#define MVPP22_FLOW_ETHERNET\t(MVPP22_FLOW_ETHER_BIT)\n\n \n#define MVPP22_CLS_C2_N_ENTRIES\t\t256\n\n \n#define MVPP22_CLS_C2_PORT_N_FLOWS\tMVPP2_N_RFS_ENTRIES_PER_FLOW\n\n \n#define MVPP22_CLS_C2_PORT_RANGE\t(MVPP22_CLS_C2_PORT_N_FLOWS + 1)\n#define MVPP22_CLS_C2_PORT_FIRST(p)\t((p) * MVPP22_CLS_C2_PORT_RANGE)\n#define MVPP22_CLS_C2_RSS_ENTRY(p)\t(MVPP22_CLS_C2_PORT_FIRST((p) + 1) - 1)\n\n#define MVPP22_CLS_C2_PORT_FLOW_FIRST(p)\t(MVPP22_CLS_C2_PORT_FIRST(p))\n\n#define MVPP22_CLS_C2_RFS_LOC(p, loc)\t(MVPP22_CLS_C2_PORT_FLOW_FIRST(p) + (loc))\n\n \nenum mvpp2_prs_flow {\n\tMVPP2_FL_START = 8,\n\tMVPP2_FL_IP4_TCP_NF_UNTAG = MVPP2_FL_START,\n\tMVPP2_FL_IP4_UDP_NF_UNTAG,\n\tMVPP2_FL_IP4_TCP_NF_TAG,\n\tMVPP2_FL_IP4_UDP_NF_TAG,\n\tMVPP2_FL_IP6_TCP_NF_UNTAG,\n\tMVPP2_FL_IP6_UDP_NF_UNTAG,\n\tMVPP2_FL_IP6_TCP_NF_TAG,\n\tMVPP2_FL_IP6_UDP_NF_TAG,\n\tMVPP2_FL_IP4_TCP_FRAG_UNTAG,\n\tMVPP2_FL_IP4_UDP_FRAG_UNTAG,\n\tMVPP2_FL_IP4_TCP_FRAG_TAG,\n\tMVPP2_FL_IP4_UDP_FRAG_TAG,\n\tMVPP2_FL_IP6_TCP_FRAG_UNTAG,\n\tMVPP2_FL_IP6_UDP_FRAG_UNTAG,\n\tMVPP2_FL_IP6_TCP_FRAG_TAG,\n\tMVPP2_FL_IP6_UDP_FRAG_TAG,\n\tMVPP2_FL_IP4_UNTAG,  \n\tMVPP2_FL_IP4_TAG,\n\tMVPP2_FL_IP6_UNTAG,\n\tMVPP2_FL_IP6_TAG,\n\tMVPP2_FL_NON_IP_UNTAG,\n\tMVPP2_FL_NON_IP_TAG,\n\tMVPP2_FL_LAST,\n};\n\n \n#define MVPP2_CLS_LU_TYPE_MASK\t\t\t0x3f\n\nenum mvpp2_cls_lu_type {\n\t \n\tMVPP22_CLS_LU_TYPE_ALL = 63,\n};\n\n#define MVPP2_N_FLOWS\t\t(MVPP2_FL_LAST - MVPP2_FL_START)\n\nstruct mvpp2_cls_flow {\n\t \n\tint flow_type;\n\n\t \n\tu16 flow_id;\n\n\t \n\tu16 supported_hash_opts;\n\n\t \n\tstruct mvpp2_prs_result_info prs_ri;\n};\n\n#define MVPP2_CLS_FLT_ENTRIES_PER_FLOW\t\t(MVPP2_MAX_PORTS + 1 + 16)\n#define MVPP2_CLS_FLT_FIRST(id)\t\t\t(((id) - MVPP2_FL_START) * \\\n\t\t\t\t\t\t MVPP2_CLS_FLT_ENTRIES_PER_FLOW)\n\n#define MVPP2_CLS_FLT_C2_RFS(port, id, rfs_n)\t(MVPP2_CLS_FLT_FIRST(id) + \\\n\t\t\t\t\t\t ((port) * MVPP2_MAX_PORTS) + \\\n\t\t\t\t\t\t (rfs_n))\n\n#define MVPP2_CLS_FLT_C2_RSS_ENTRY(id)\t\t(MVPP2_CLS_FLT_C2_RFS(MVPP2_MAX_PORTS, id, 0))\n#define MVPP2_CLS_FLT_HASH_ENTRY(port, id)\t(MVPP2_CLS_FLT_C2_RSS_ENTRY(id) + 1 + (port))\n#define MVPP2_CLS_FLT_LAST(id)\t\t\t(MVPP2_CLS_FLT_FIRST(id) + \\\n\t\t\t\t\t\t MVPP2_CLS_FLT_ENTRIES_PER_FLOW - 1)\n\n \n#define for_each_cls_flow_id(i)\t\t\t\t\t\t      \\\n\tfor ((i) = 0; (i) < MVPP2_N_PRS_FLOWS; (i)++)\t\t\t      \\\n\t\tif ((i) > 0 &&\t\t\t\t\t\t      \\\n\t\t    cls_flows[(i)].flow_id == cls_flows[(i) - 1].flow_id)       \\\n\t\t\tcontinue;\t\t\t\t\t      \\\n\t\telse\n\n \n#define for_each_cls_flow_id_with_type(i, type)\t\t\t\t      \\\n\tfor_each_cls_flow_id((i))\t\t\t\t\t      \\\n\t\tif (cls_flows[(i)].flow_type != (type))\t\t\t      \\\n\t\t\tcontinue;\t\t\t\t\t      \\\n\t\telse\n\n#define for_each_cls_flow_id_containing_type(i, type)\t\t\t      \\\n\tfor_each_cls_flow_id((i))\t\t\t\t\t      \\\n\t\tif ((cls_flows[(i)].flow_type & (type)) != (type))\t      \\\n\t\t\tcontinue;\t\t\t\t\t      \\\n\t\telse\n\nstruct mvpp2_cls_flow_entry {\n\tu32 index;\n\tu32 data[MVPP2_CLS_FLOWS_TBL_DATA_WORDS];\n};\n\nstruct mvpp2_cls_lookup_entry {\n\tu32 lkpid;\n\tu32 way;\n\tu32 data;\n};\n\nint mvpp22_port_rss_init(struct mvpp2_port *port);\n\nint mvpp22_port_rss_enable(struct mvpp2_port *port);\nint mvpp22_port_rss_disable(struct mvpp2_port *port);\n\nint mvpp22_port_rss_ctx_create(struct mvpp2_port *port, u32 *rss_ctx);\nint mvpp22_port_rss_ctx_delete(struct mvpp2_port *port, u32 rss_ctx);\n\nint mvpp22_port_rss_ctx_indir_set(struct mvpp2_port *port, u32 rss_ctx,\n\t\t\t\t  const u32 *indir);\nint mvpp22_port_rss_ctx_indir_get(struct mvpp2_port *port, u32 rss_ctx,\n\t\t\t\t  u32 *indir);\n\nint mvpp2_ethtool_rxfh_get(struct mvpp2_port *port, struct ethtool_rxnfc *info);\nint mvpp2_ethtool_rxfh_set(struct mvpp2_port *port, struct ethtool_rxnfc *info);\n\nvoid mvpp2_cls_init(struct mvpp2 *priv);\n\nvoid mvpp2_cls_port_config(struct mvpp2_port *port);\n\nvoid mvpp2_cls_oversize_rxq_set(struct mvpp2_port *port);\n\nint mvpp2_cls_flow_eng_get(struct mvpp2_cls_flow_entry *fe);\n\nu16 mvpp2_flow_get_hek_fields(struct mvpp2_cls_flow_entry *fe);\n\nconst struct mvpp2_cls_flow *mvpp2_cls_flow_get(int flow);\n\nu32 mvpp2_cls_flow_hits(struct mvpp2 *priv, int index);\n\nvoid mvpp2_cls_flow_read(struct mvpp2 *priv, int index,\n\t\t\t struct mvpp2_cls_flow_entry *fe);\n\nu32 mvpp2_cls_lookup_hits(struct mvpp2 *priv, int index);\n\nvoid mvpp2_cls_lookup_read(struct mvpp2 *priv, int lkpid, int way,\n\t\t\t   struct mvpp2_cls_lookup_entry *le);\n\nu32 mvpp2_cls_c2_hit_count(struct mvpp2 *priv, int c2_index);\n\nvoid mvpp2_cls_c2_read(struct mvpp2 *priv, int index,\n\t\t       struct mvpp2_cls_c2_entry *c2);\n\nint mvpp2_ethtool_cls_rule_get(struct mvpp2_port *port,\n\t\t\t       struct ethtool_rxnfc *rxnfc);\n\nint mvpp2_ethtool_cls_rule_ins(struct mvpp2_port *port,\n\t\t\t       struct ethtool_rxnfc *info);\n\nint mvpp2_ethtool_cls_rule_del(struct mvpp2_port *port,\n\t\t\t       struct ethtool_rxnfc *info);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}