{
  "module_name": "mvpp2_prs.h",
  "hash_id": "14d7f84cdb84df19f2db136551529a8e0facf8007b6fcfa9f8d858b2ae5c1532",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/marvell/mvpp2/mvpp2_prs.h",
  "human_readable_source": " \n \n#ifndef _MVPP2_PRS_H_\n#define _MVPP2_PRS_H_\n\n#include <linux/kernel.h>\n#include <linux/netdevice.h>\n#include <linux/platform_device.h>\n\n#include \"mvpp2.h\"\n\n \n#define MVPP2_PRS_TCAM_SRAM_SIZE\t256\n#define MVPP2_PRS_TCAM_WORDS\t\t6\n#define MVPP2_PRS_SRAM_WORDS\t\t4\n#define MVPP2_PRS_FLOW_ID_SIZE\t\t64\n#define MVPP2_PRS_FLOW_ID_MASK\t\t0x3f\n#define MVPP2_PRS_TCAM_ENTRY_INVALID\t1\n#define MVPP2_PRS_TCAM_DSA_TAGGED_BIT\tBIT(5)\n#define MVPP2_PRS_IPV4_HEAD\t\t0x40\n#define MVPP2_PRS_IPV4_HEAD_MASK\t0xf0\n#define MVPP2_PRS_IPV4_MC\t\t0xe0\n#define MVPP2_PRS_IPV4_MC_MASK\t\t0xf0\n#define MVPP2_PRS_IPV4_BC_MASK\t\t0xff\n#define MVPP2_PRS_IPV4_IHL_MIN\t\t0x5\n#define MVPP2_PRS_IPV4_IHL_MAX\t\t0xf\n#define MVPP2_PRS_IPV4_IHL_MASK\t\t0xf\n#define MVPP2_PRS_IPV6_MC\t\t0xff\n#define MVPP2_PRS_IPV6_MC_MASK\t\t0xff\n#define MVPP2_PRS_IPV6_HOP_MASK\t\t0xff\n#define MVPP2_PRS_TCAM_PROTO_MASK\t0xff\n#define MVPP2_PRS_TCAM_PROTO_MASK_L\t0x3f\n#define MVPP2_PRS_DBL_VLANS_MAX\t\t100\n#define MVPP2_PRS_CAST_MASK\t\tBIT(0)\n#define MVPP2_PRS_MCAST_VAL\t\tBIT(0)\n#define MVPP2_PRS_UCAST_VAL\t\t0x0\n\n \n#define MVPP2_PRS_AI_BITS\t\t\t8\n#define MVPP2_PRS_AI_MASK\t\t\t0xff\n#define MVPP2_PRS_PORT_MASK\t\t\t0xff\n#define MVPP2_PRS_LU_MASK\t\t\t0xf\n\n \n#define MVPP2_PRS_BYTE_TO_WORD(byte)\t((byte) / 2)\n#define MVPP2_PRS_BYTE_IN_WORD(byte)\t((byte) % 2)\n\n#define MVPP2_PRS_TCAM_EN(data)\t\t((data) << 16)\n#define MVPP2_PRS_TCAM_AI_WORD\t\t4\n#define MVPP2_PRS_TCAM_AI(ai)\t\t(ai)\n#define MVPP2_PRS_TCAM_AI_EN(ai)\tMVPP2_PRS_TCAM_EN(MVPP2_PRS_TCAM_AI(ai))\n#define MVPP2_PRS_TCAM_PORT_WORD\t4\n#define MVPP2_PRS_TCAM_PORT(p)\t\t((p) << 8)\n#define MVPP2_PRS_TCAM_PORT_EN(p)\tMVPP2_PRS_TCAM_EN(MVPP2_PRS_TCAM_PORT(p))\n#define MVPP2_PRS_TCAM_LU_WORD\t\t5\n#define MVPP2_PRS_TCAM_LU(lu)\t\t(lu)\n#define MVPP2_PRS_TCAM_LU_EN(lu)\tMVPP2_PRS_TCAM_EN(MVPP2_PRS_TCAM_LU(lu))\n#define MVPP2_PRS_TCAM_INV_WORD\t\t5\n\n#define MVPP2_PRS_VID_TCAM_BYTE         2\n\n \n#define MVPP2_PRS_MAC_UC_MC_FILT_MAX\t25\n#define MVPP2_PRS_MAC_RANGE_SIZE\t80\n\n \n#define MVPP2_PRS_MAC_UC_FILT_MAX\t4\n#define MVPP2_PRS_MAC_MC_FILT_MAX\t(MVPP2_PRS_MAC_UC_MC_FILT_MAX - \\\n\t\t\t\t\t MVPP2_PRS_MAC_UC_FILT_MAX)\n\n \n#define MVPP2_PRS_VLAN_FILT_MAX\t\t11\n#define MVPP2_PRS_VLAN_FILT_RANGE_SIZE\t33\n\n#define MVPP2_PRS_VLAN_FILT_MAX_ENTRY   (MVPP2_PRS_VLAN_FILT_MAX - 2)\n#define MVPP2_PRS_VLAN_FILT_DFLT_ENTRY  (MVPP2_PRS_VLAN_FILT_MAX - 1)\n\n \n#define MVPP2_PE_DROP_ALL\t\t0\n#define MVPP2_PE_FIRST_FREE_TID\t\t1\n\n \n#define MVPP2_PE_MAC_RANGE_END\t\t(MVPP2_PE_VID_FILT_RANGE_START - 1)\n#define MVPP2_PE_MAC_RANGE_START\t(MVPP2_PE_MAC_RANGE_END - \\\n\t\t\t\t\t\tMVPP2_PRS_MAC_RANGE_SIZE + 1)\n \n#define MVPP2_PE_VID_FILT_RANGE_END     (MVPP2_PRS_TCAM_SRAM_SIZE - 32)\n#define MVPP2_PE_VID_FILT_RANGE_START   (MVPP2_PE_VID_FILT_RANGE_END - \\\n\t\t\t\t\t MVPP2_PRS_VLAN_FILT_RANGE_SIZE + 1)\n#define MVPP2_PE_LAST_FREE_TID          (MVPP2_PE_MAC_RANGE_START - 1)\n#define MVPP2_PE_MH_SKIP_PRS\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 31)\n#define MVPP2_PE_IP6_EXT_PROTO_UN\t(MVPP2_PRS_TCAM_SRAM_SIZE - 30)\n#define MVPP2_PE_IP6_ADDR_UN\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 29)\n#define MVPP2_PE_IP4_ADDR_UN\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 28)\n#define MVPP2_PE_LAST_DEFAULT_FLOW\t(MVPP2_PRS_TCAM_SRAM_SIZE - 27)\n#define MVPP2_PE_FIRST_DEFAULT_FLOW\t(MVPP2_PRS_TCAM_SRAM_SIZE - 22)\n#define MVPP2_PE_EDSA_TAGGED\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 21)\n#define MVPP2_PE_EDSA_UNTAGGED\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 20)\n#define MVPP2_PE_DSA_TAGGED\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 19)\n#define MVPP2_PE_DSA_UNTAGGED\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 18)\n#define MVPP2_PE_ETYPE_EDSA_TAGGED\t(MVPP2_PRS_TCAM_SRAM_SIZE - 17)\n#define MVPP2_PE_ETYPE_EDSA_UNTAGGED\t(MVPP2_PRS_TCAM_SRAM_SIZE - 16)\n#define MVPP2_PE_ETYPE_DSA_TAGGED\t(MVPP2_PRS_TCAM_SRAM_SIZE - 15)\n#define MVPP2_PE_ETYPE_DSA_UNTAGGED\t(MVPP2_PRS_TCAM_SRAM_SIZE - 14)\n#define MVPP2_PE_MH_DEFAULT\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 13)\n#define MVPP2_PE_DSA_DEFAULT\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 12)\n#define MVPP2_PE_IP6_PROTO_UN\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 11)\n#define MVPP2_PE_IP4_PROTO_UN\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 10)\n#define MVPP2_PE_ETH_TYPE_UN\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 9)\n#define MVPP2_PE_VID_FLTR_DEFAULT\t(MVPP2_PRS_TCAM_SRAM_SIZE - 8)\n#define MVPP2_PE_VID_EDSA_FLTR_DEFAULT\t(MVPP2_PRS_TCAM_SRAM_SIZE - 7)\n#define MVPP2_PE_VLAN_DBL\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 6)\n#define MVPP2_PE_VLAN_NONE\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 5)\n#define MVPP2_PE_FC_DROP\t\t(MVPP2_PRS_TCAM_SRAM_SIZE - 4)\n#define MVPP2_PE_MAC_MC_PROMISCUOUS\t(MVPP2_PRS_TCAM_SRAM_SIZE - 3)\n#define MVPP2_PE_MAC_UC_PROMISCUOUS\t(MVPP2_PRS_TCAM_SRAM_SIZE - 2)\n#define MVPP2_PE_MAC_NON_PROMISCUOUS\t(MVPP2_PRS_TCAM_SRAM_SIZE - 1)\n\n#define MVPP2_PRS_VID_PORT_FIRST(port)\t(MVPP2_PE_VID_FILT_RANGE_START + \\\n\t\t\t\t\t ((port) * MVPP2_PRS_VLAN_FILT_MAX))\n#define MVPP2_PRS_VID_PORT_LAST(port)\t(MVPP2_PRS_VID_PORT_FIRST(port) \\\n\t\t\t\t\t + MVPP2_PRS_VLAN_FILT_MAX_ENTRY)\n \n#define MVPP2_PRS_VID_PORT_DFLT(port)\t(MVPP2_PRS_VID_PORT_FIRST(port) \\\n\t\t\t\t\t + MVPP2_PRS_VLAN_FILT_DFLT_ENTRY)\n\n \n#define MVPP2_PRS_SRAM_RI_OFFS\t\t\t0\n#define MVPP2_PRS_SRAM_RI_WORD\t\t\t0\n#define MVPP2_PRS_SRAM_RI_CTRL_OFFS\t\t32\n#define MVPP2_PRS_SRAM_RI_CTRL_WORD\t\t1\n#define MVPP2_PRS_SRAM_RI_CTRL_BITS\t\t32\n#define MVPP2_PRS_SRAM_SHIFT_OFFS\t\t64\n#define MVPP2_PRS_SRAM_SHIFT_SIGN_BIT\t\t72\n#define MVPP2_PRS_SRAM_SHIFT_MASK\t\t0xff\n#define MVPP2_PRS_SRAM_UDF_OFFS\t\t\t73\n#define MVPP2_PRS_SRAM_UDF_BITS\t\t\t8\n#define MVPP2_PRS_SRAM_UDF_MASK\t\t\t0xff\n#define MVPP2_PRS_SRAM_UDF_SIGN_BIT\t\t81\n#define MVPP2_PRS_SRAM_UDF_TYPE_OFFS\t\t82\n#define MVPP2_PRS_SRAM_UDF_TYPE_MASK\t\t0x7\n#define MVPP2_PRS_SRAM_UDF_TYPE_L3\t\t1\n#define MVPP2_PRS_SRAM_UDF_TYPE_L4\t\t4\n#define MVPP2_PRS_SRAM_OP_SEL_SHIFT_OFFS\t85\n#define MVPP2_PRS_SRAM_OP_SEL_SHIFT_MASK\t0x3\n#define MVPP2_PRS_SRAM_OP_SEL_SHIFT_ADD\t\t1\n#define MVPP2_PRS_SRAM_OP_SEL_SHIFT_IP4_ADD\t2\n#define MVPP2_PRS_SRAM_OP_SEL_SHIFT_IP6_ADD\t3\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_OFFS\t\t87\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_BITS\t\t2\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_MASK\t\t0x3\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_ADD\t\t0\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_IP4_ADD\t2\n#define MVPP2_PRS_SRAM_OP_SEL_UDF_IP6_ADD\t3\n#define MVPP2_PRS_SRAM_OP_SEL_BASE_OFFS\t\t89\n#define MVPP2_PRS_SRAM_AI_OFFS\t\t\t90\n#define MVPP2_PRS_SRAM_AI_CTRL_OFFS\t\t98\n#define MVPP2_PRS_SRAM_AI_CTRL_BITS\t\t8\n#define MVPP2_PRS_SRAM_AI_MASK\t\t\t0xff\n#define MVPP2_PRS_SRAM_NEXT_LU_OFFS\t\t106\n#define MVPP2_PRS_SRAM_NEXT_LU_MASK\t\t0xf\n#define MVPP2_PRS_SRAM_LU_DONE_BIT\t\t110\n#define MVPP2_PRS_SRAM_LU_GEN_BIT\t\t111\n\n \n#define MVPP2_PRS_RI_MAC_ME_MASK\t\t0x1\n#define MVPP2_PRS_RI_DSA_MASK\t\t\t0x2\n#define MVPP2_PRS_RI_VLAN_MASK\t\t\t(BIT(2) | BIT(3))\n#define MVPP2_PRS_RI_VLAN_NONE\t\t\t0x0\n#define MVPP2_PRS_RI_VLAN_SINGLE\t\tBIT(2)\n#define MVPP2_PRS_RI_VLAN_DOUBLE\t\tBIT(3)\n#define MVPP2_PRS_RI_VLAN_TRIPLE\t\t(BIT(2) | BIT(3))\n#define MVPP2_PRS_RI_CPU_CODE_MASK\t\t0x70\n#define MVPP2_PRS_RI_CPU_CODE_RX_SPEC\t\tBIT(4)\n#define MVPP2_PRS_RI_L2_CAST_MASK\t\t(BIT(9) | BIT(10))\n#define MVPP2_PRS_RI_L2_UCAST\t\t\t0x0\n#define MVPP2_PRS_RI_L2_MCAST\t\t\tBIT(9)\n#define MVPP2_PRS_RI_L2_BCAST\t\t\tBIT(10)\n#define MVPP2_PRS_RI_PPPOE_MASK\t\t\t0x800\n#define MVPP2_PRS_RI_L3_PROTO_MASK\t\t(BIT(12) | BIT(13) | BIT(14))\n#define MVPP2_PRS_RI_L3_UN\t\t\t0x0\n#define MVPP2_PRS_RI_L3_IP4\t\t\tBIT(12)\n#define MVPP2_PRS_RI_L3_IP4_OPT\t\t\tBIT(13)\n#define MVPP2_PRS_RI_L3_IP4_OTHER\t\t(BIT(12) | BIT(13))\n#define MVPP2_PRS_RI_L3_IP6\t\t\tBIT(14)\n#define MVPP2_PRS_RI_L3_IP6_EXT\t\t\t(BIT(12) | BIT(14))\n#define MVPP2_PRS_RI_L3_ARP\t\t\t(BIT(13) | BIT(14))\n#define MVPP2_PRS_RI_L3_ADDR_MASK\t\t(BIT(15) | BIT(16))\n#define MVPP2_PRS_RI_L3_UCAST\t\t\t0x0\n#define MVPP2_PRS_RI_L3_MCAST\t\t\tBIT(15)\n#define MVPP2_PRS_RI_L3_BCAST\t\t\t(BIT(15) | BIT(16))\n#define MVPP2_PRS_RI_IP_FRAG_MASK\t\t0x20000\n#define MVPP2_PRS_RI_IP_FRAG_TRUE\t\tBIT(17)\n#define MVPP2_PRS_RI_UDF3_MASK\t\t\t0x300000\n#define MVPP2_PRS_RI_UDF3_RX_SPECIAL\t\tBIT(21)\n#define MVPP2_PRS_RI_L4_PROTO_MASK\t\t0x1c00000\n#define MVPP2_PRS_RI_L4_TCP\t\t\tBIT(22)\n#define MVPP2_PRS_RI_L4_UDP\t\t\tBIT(23)\n#define MVPP2_PRS_RI_L4_OTHER\t\t\t(BIT(22) | BIT(23))\n#define MVPP2_PRS_RI_UDF7_MASK\t\t\t0x60000000\n#define MVPP2_PRS_RI_UDF7_IP6_LITE\t\tBIT(29)\n#define MVPP2_PRS_RI_DROP_MASK\t\t\t0x80000000\n\n#define MVPP2_PRS_IP_MASK\t\t\t(MVPP2_PRS_RI_L3_PROTO_MASK | \\\n\t\t\t\t\t\tMVPP2_PRS_RI_IP_FRAG_MASK | \\\n\t\t\t\t\t\tMVPP2_PRS_RI_L4_PROTO_MASK)\n\n \n#define MVPP2_PRS_IPV4_DIP_AI_BIT\t\tBIT(0)\n#define MVPP2_PRS_IPV6_NO_EXT_AI_BIT\t\tBIT(0)\n#define MVPP2_PRS_IPV6_EXT_AI_BIT\t\tBIT(1)\n#define MVPP2_PRS_IPV6_EXT_AH_AI_BIT\t\tBIT(2)\n#define MVPP2_PRS_IPV6_EXT_AH_LEN_AI_BIT\tBIT(3)\n#define MVPP2_PRS_IPV6_EXT_AH_L4_AI_BIT\t\tBIT(4)\n#define MVPP2_PRS_SINGLE_VLAN_AI\t\t0\n#define MVPP2_PRS_DBL_VLAN_AI_BIT\t\tBIT(7)\n#define MVPP2_PRS_EDSA_VID_AI_BIT\t\tBIT(0)\n\n \n#define MVPP2_PRS_TAGGED\t\ttrue\n#define MVPP2_PRS_UNTAGGED\t\tfalse\n#define MVPP2_PRS_EDSA\t\t\ttrue\n#define MVPP2_PRS_DSA\t\t\tfalse\n\n \nenum mvpp2_prs_udf {\n\tMVPP2_PRS_UDF_MAC_DEF,\n\tMVPP2_PRS_UDF_MAC_RANGE,\n\tMVPP2_PRS_UDF_L2_DEF,\n\tMVPP2_PRS_UDF_L2_DEF_COPY,\n\tMVPP2_PRS_UDF_L2_USER,\n};\n\n \nenum mvpp2_prs_lookup {\n\tMVPP2_PRS_LU_MH,\n\tMVPP2_PRS_LU_MAC,\n\tMVPP2_PRS_LU_DSA,\n\tMVPP2_PRS_LU_VLAN,\n\tMVPP2_PRS_LU_VID,\n\tMVPP2_PRS_LU_L2,\n\tMVPP2_PRS_LU_PPPOE,\n\tMVPP2_PRS_LU_IP4,\n\tMVPP2_PRS_LU_IP6,\n\tMVPP2_PRS_LU_FLOWS,\n\tMVPP2_PRS_LU_LAST,\n};\n\nstruct mvpp2_prs_entry {\n\tu32 index;\n\tu32 tcam[MVPP2_PRS_TCAM_WORDS];\n\tu32 sram[MVPP2_PRS_SRAM_WORDS];\n};\n\nstruct mvpp2_prs_result_info {\n\tu32 ri;\n\tu32 ri_mask;\n};\n\nstruct mvpp2_prs_shadow {\n\tbool valid;\n\tbool finish;\n\n\t \n\tint lu;\n\n\t \n\tint udf;\n\n\t \n\tu32 ri;\n\tu32 ri_mask;\n};\n\nint mvpp2_prs_default_init(struct platform_device *pdev, struct mvpp2 *priv);\n\nint mvpp2_prs_init_from_hw(struct mvpp2 *priv, struct mvpp2_prs_entry *pe,\n\t\t\t   int tid);\n\nunsigned int mvpp2_prs_tcam_port_map_get(struct mvpp2_prs_entry *pe);\n\nvoid mvpp2_prs_tcam_data_byte_get(struct mvpp2_prs_entry *pe,\n\t\t\t\t  unsigned int offs, unsigned char *byte,\n\t\t\t\t  unsigned char *enable);\n\nint mvpp2_prs_mac_da_accept(struct mvpp2_port *port, const u8 *da, bool add);\n\nint mvpp2_prs_tag_mode_set(struct mvpp2 *priv, int port, int type);\n\nint mvpp2_prs_add_flow(struct mvpp2 *priv, int flow, u32 ri, u32 ri_mask);\n\nint mvpp2_prs_def_flow(struct mvpp2_port *port);\n\nvoid mvpp2_prs_vid_enable_filtering(struct mvpp2_port *port);\n\nvoid mvpp2_prs_vid_disable_filtering(struct mvpp2_port *port);\n\nint mvpp2_prs_vid_entry_add(struct mvpp2_port *port, u16 vid);\n\nvoid mvpp2_prs_vid_entry_remove(struct mvpp2_port *port, u16 vid);\n\nvoid mvpp2_prs_vid_remove_all(struct mvpp2_port *port);\n\nvoid mvpp2_prs_mac_promisc_set(struct mvpp2 *priv, int port,\n\t\t\t       enum mvpp2_prs_l2_cast l2_cast, bool add);\n\nvoid mvpp2_prs_mac_del_all(struct mvpp2_port *port);\n\nint mvpp2_prs_update_mac_da(struct net_device *dev, const u8 *da);\n\nint mvpp2_prs_hits(struct mvpp2 *priv, int index);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}