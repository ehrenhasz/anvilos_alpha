{
  "module_name": "otx2_txrx.h",
  "hash_id": "254f66b54b379689c843f1a96a5f8f72343b262a182a6ce8d7b1509753266aca",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/marvell/octeontx2/nic/otx2_txrx.h",
  "human_readable_source": " \n \n\n#ifndef OTX2_TXRX_H\n#define OTX2_TXRX_H\n\n#include <linux/etherdevice.h>\n#include <linux/iommu.h>\n#include <linux/if_vlan.h>\n#include <net/xdp.h>\n\n#define LBK_CHAN_BASE\t0x000\n#define SDP_CHAN_BASE\t0x700\n#define CGX_CHAN_BASE\t0x800\n\n#define OTX2_DATA_ALIGN(X)\tALIGN(X, OTX2_ALIGN)\n#define OTX2_HEAD_ROOM\t\tOTX2_ALIGN\n\n#define\tOTX2_ETH_HLEN\t\t(VLAN_ETH_HLEN + VLAN_HLEN)\n#define\tOTX2_MIN_MTU\t\t60\n\n#define OTX2_PAGE_POOL_SZ\t2048\n\n#define OTX2_MAX_GSO_SEGS\t255\n#define OTX2_MAX_FRAGS_IN_SQE\t9\n\n#define MAX_XDP_MTU\t(1530 - OTX2_ETH_HLEN)\n\n \n#define RCV_FRAG_LEN1(x)\t\t\t\t\\\n\t\t((OTX2_HEAD_ROOM + OTX2_DATA_ALIGN(x)) + \\\n\t\tOTX2_DATA_ALIGN(sizeof(struct skb_shared_info)))\n\n \n#define RCV_FRAG_LEN(x)\t\\\n\t\t((RCV_FRAG_LEN1(x) < 2048) ? 2048 : RCV_FRAG_LEN1(x))\n\n#define DMA_BUFFER_LEN(x)\t((x) - OTX2_HEAD_ROOM)\n\n \n#define CQ_CQE_THRESH_DEFAULT\t10\n\n \n#define CQ_TIMER_THRESH_DEFAULT\t1   \n#define CQ_TIMER_THRESH_MAX     25  \n\n \n#define CQ_QCOUNT_DEFAULT\t1\n\n#define CQ_OP_STAT_OP_ERR       63\n#define CQ_OP_STAT_CQ_ERR       46\n\nstruct queue_stats {\n\tu64\tbytes;\n\tu64\tpkts;\n};\n\nstruct otx2_rcv_queue {\n\tstruct queue_stats\tstats;\n};\n\nstruct sg_list {\n\tu16\tnum_segs;\n\tu64\tskb;\n\tu64\tsize[OTX2_MAX_FRAGS_IN_SQE];\n\tu64\tdma_addr[OTX2_MAX_FRAGS_IN_SQE];\n};\n\nstruct otx2_snd_queue {\n\tu8\t\t\taura_id;\n\tu16\t\t\thead;\n\tu16\t\t\tcons_head;\n\tu16\t\t\tsqe_size;\n\tu32\t\t\tsqe_cnt;\n\tu16\t\t\tnum_sqbs;\n\tu16\t\t\tsqe_thresh;\n\tu8\t\t\tsqe_per_sqb;\n\tu64\t\t\t io_addr;\n\tu64\t\t\t*aura_fc_addr;\n\tu64\t\t\t*lmt_addr;\n\tvoid\t\t\t*sqe_base;\n\tstruct qmem\t\t*sqe;\n\tstruct qmem\t\t*tso_hdrs;\n\tstruct sg_list\t\t*sg;\n\tstruct qmem\t\t*timestamps;\n\tstruct queue_stats\tstats;\n\tu16\t\t\tsqb_count;\n\tu64\t\t\t*sqb_ptrs;\n} ____cacheline_aligned_in_smp;\n\nenum cq_type {\n\tCQ_RX,\n\tCQ_TX,\n\tCQ_XDP,\n\tCQ_QOS,\n\tCQS_PER_CINT = 4,  \n};\n\nstruct otx2_cq_poll {\n\tvoid\t\t\t*dev;\n#define CINT_INVALID_CQ\t\t255\n\tu8\t\t\tcint_idx;\n\tu8\t\t\tcq_ids[CQS_PER_CINT];\n\tstruct dim\t\tdim;\n\tstruct napi_struct\tnapi;\n};\n\nstruct otx2_pool {\n\tstruct qmem\t\t*stack;\n\tstruct qmem\t\t*fc_addr;\n\tstruct page_pool\t*page_pool;\n\tu16\t\t\trbsize;\n};\n\nstruct otx2_cq_queue {\n\tu8\t\t\tcq_idx;\n\tu8\t\t\tcq_type;\n\tu8\t\t\tcint_idx;  \n\tu8\t\t\trefill_task_sched;\n\tu16\t\t\tcqe_size;\n\tu16\t\t\tpool_ptrs;\n\tu32\t\t\tcqe_cnt;\n\tu32\t\t\tcq_head;\n\tu32\t\t\tcq_tail;\n\tu32\t\t\tpend_cqe;\n\tvoid\t\t\t*cqe_base;\n\tstruct qmem\t\t*cqe;\n\tstruct otx2_pool\t*rbpool;\n\tstruct xdp_rxq_info xdp_rxq;\n} ____cacheline_aligned_in_smp;\n\nstruct otx2_qset {\n\tu32\t\t\trqe_cnt;\n\tu32\t\t\tsqe_cnt;  \n#define OTX2_MAX_CQ_CNT\t\t64\n\tu16\t\t\tcq_cnt;\n\tu16\t\t\txqe_size;\n\tstruct otx2_pool\t*pool;\n\tstruct otx2_cq_poll\t*napi;\n\tstruct otx2_cq_queue\t*cq;\n\tstruct otx2_snd_queue\t*sq;\n\tstruct otx2_rcv_queue\t*rq;\n};\n\n \nstatic inline u64 otx2_iova_to_phys(void *iommu_domain, dma_addr_t dma_addr)\n{\n\t \n\tif (likely(iommu_domain))\n\t\treturn iommu_iova_to_phys(iommu_domain, dma_addr);\n\treturn dma_addr;\n}\n\nint otx2_napi_handler(struct napi_struct *napi, int budget);\nbool otx2_sq_append_skb(struct net_device *netdev, struct otx2_snd_queue *sq,\n\t\t\tstruct sk_buff *skb, u16 qidx);\nvoid cn10k_sqe_flush(void *dev, struct otx2_snd_queue *sq,\n\t\t     int size, int qidx);\nvoid otx2_sqe_flush(void *dev, struct otx2_snd_queue *sq,\n\t\t    int size, int qidx);\nint otx2_refill_pool_ptrs(void *dev, struct otx2_cq_queue *cq);\nint cn10k_refill_pool_ptrs(void *dev, struct otx2_cq_queue *cq);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}