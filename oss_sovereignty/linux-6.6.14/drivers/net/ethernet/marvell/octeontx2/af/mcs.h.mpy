{
  "module_name": "mcs.h",
  "hash_id": "48e16d9a1846dd181e594d4046fa1ad8c864f3495efe8bf2bc0cb417897f3741",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/marvell/octeontx2/af/mcs.h",
  "human_readable_source": " \n \n\n#ifndef MCS_H\n#define MCS_H\n\n#include <linux/bits.h>\n#include \"rvu.h\"\n\n#define PCI_DEVID_CN10K_MCS\t\t0xA096\n\n#define MCSX_LINK_LMAC_RANGE_MASK\tGENMASK_ULL(19, 16)\n#define MCSX_LINK_LMAC_BASE_MASK\tGENMASK_ULL(11, 0)\n\n#define MCS_ID_MASK\t\t\t0x7\n#define MCS_MAX_PFS                     128\n\n#define MCS_PORT_MODE_MASK\t\t0x3\n#define MCS_PORT_FIFO_SKID_MASK\t\t0x3F\n#define MCS_MAX_CUSTOM_TAGS\t\t0x8\n\n#define MCS_CTRLPKT_ETYPE_RULE_MAX\t8\n#define MCS_CTRLPKT_DA_RULE_MAX\t\t8\n#define MCS_CTRLPKT_DA_RANGE_RULE_MAX\t4\n#define MCS_CTRLPKT_COMBO_RULE_MAX\t4\n#define MCS_CTRLPKT_MAC_RULE_MAX\t1\n\n#define MCS_MAX_CTRLPKT_RULES\t(MCS_CTRLPKT_ETYPE_RULE_MAX + \\\n\t\t\t\tMCS_CTRLPKT_DA_RULE_MAX + \\\n\t\t\t\tMCS_CTRLPKT_DA_RANGE_RULE_MAX + \\\n\t\t\t\tMCS_CTRLPKT_COMBO_RULE_MAX + \\\n\t\t\t\tMCS_CTRLPKT_MAC_RULE_MAX)\n\n#define MCS_CTRLPKT_ETYPE_RULE_OFFSET\t\t0\n#define MCS_CTRLPKT_DA_RULE_OFFSET\t\t8\n#define MCS_CTRLPKT_DA_RANGE_RULE_OFFSET\t16\n#define MCS_CTRLPKT_COMBO_RULE_OFFSET\t\t20\n#define MCS_CTRLPKT_MAC_EN_RULE_OFFSET\t\t24\n\n \n#define MCS_RSRC_RSVD_CNT\t\t1\n\n \n#define MCS_CNF10KB_INT_VEC_IP\t0x13\n#define MCS_CN10KB_INT_VEC_IP\t0x53\n\n#define MCS_MAX_BBE_INT\t\t\t8ULL\n#define MCS_BBE_INT_MASK\t\t0xFFULL\n\n#define MCS_MAX_PAB_INT\t\t8ULL\n#define MCS_PAB_INT_MASK\t0xFULL\n\n#define MCS_BBE_RX_INT_ENA\t\tBIT_ULL(0)\n#define MCS_BBE_TX_INT_ENA\t\tBIT_ULL(1)\n#define MCS_CPM_RX_INT_ENA\t\tBIT_ULL(2)\n#define MCS_CPM_TX_INT_ENA\t\tBIT_ULL(3)\n#define MCS_PAB_RX_INT_ENA\t\tBIT_ULL(4)\n#define MCS_PAB_TX_INT_ENA\t\tBIT_ULL(5)\n\n#define MCS_CPM_TX_INT_PACKET_XPN_EQ0\t\tBIT_ULL(0)\n#define MCS_CPM_TX_INT_PN_THRESH_REACHED\tBIT_ULL(1)\n#define MCS_CPM_TX_INT_SA_NOT_VALID\t\tBIT_ULL(2)\n\n#define MCS_CPM_RX_INT_SECTAG_V_EQ1\t\tBIT_ULL(0)\n#define MCS_CPM_RX_INT_SECTAG_E_EQ0_C_EQ1\tBIT_ULL(1)\n#define MCS_CPM_RX_INT_SL_GTE48\t\t\tBIT_ULL(2)\n#define MCS_CPM_RX_INT_ES_EQ1_SC_EQ1\t\tBIT_ULL(3)\n#define MCS_CPM_RX_INT_SC_EQ1_SCB_EQ1\t\tBIT_ULL(4)\n#define MCS_CPM_RX_INT_PACKET_XPN_EQ0\t\tBIT_ULL(5)\n#define MCS_CPM_RX_INT_PN_THRESH_REACHED\tBIT_ULL(6)\n\n#define MCS_CPM_RX_INT_ALL\t(MCS_CPM_RX_INT_SECTAG_V_EQ1 |\t\t\\\n\t\t\t\t MCS_CPM_RX_INT_SECTAG_E_EQ0_C_EQ1 |    \\\n\t\t\t\t MCS_CPM_RX_INT_SL_GTE48 |\t\t\\\n\t\t\t\t MCS_CPM_RX_INT_ES_EQ1_SC_EQ1 |\t\t\\\n\t\t\t\t MCS_CPM_RX_INT_SC_EQ1_SCB_EQ1 |\t\\\n\t\t\t\t MCS_CPM_RX_INT_PACKET_XPN_EQ0 |\t\\\n\t\t\t\t MCS_CPM_RX_INT_PN_THRESH_REACHED)\n\nstruct mcs_pfvf {\n\tu64 intr_mask;\t \n};\n\nstruct mcs_intr_event {\n\tu16 pcifunc;\n\tu64 intr_mask;\n\tu64 sa_id;\n\tu8 mcs_id;\n\tu8 lmac_id;\n};\n\nstruct mcs_intrq_entry {\n\tstruct list_head node;\n\tstruct mcs_intr_event intr_event;\n};\n\nstruct secy_mem_map {\n\tu8 flow_id;\n\tu8 secy;\n\tu8 ctrl_pkt;\n\tu8 sc;\n\tu64 sci;\n};\n\nstruct mcs_rsrc_map {\n\tu16 *flowid2pf_map;\n\tu16 *secy2pf_map;\n\tu16 *sc2pf_map;\n\tu16 *sa2pf_map;\n\tu16 *flowid2secy_map;\t \n\tu16 *ctrlpktrule2pf_map;\n\tstruct rsrc_bmap\tflow_ids;\n\tstruct rsrc_bmap\tsecy;\n\tstruct rsrc_bmap\tsc;\n\tstruct rsrc_bmap\tsa;\n\tstruct rsrc_bmap\tctrlpktrule;\n};\n\nstruct hwinfo {\n\tu8 tcam_entries;\n\tu8 secy_entries;\n\tu8 sc_entries;\n\tu16 sa_entries;\n\tu8 mcs_x2p_intf;\n\tu8 lmac_cnt;\n\tu8 mcs_blks;\n\tunsigned long\tlmac_bmap;  \n\tu16 ip_vec;\n};\n\nstruct mcs {\n\tvoid __iomem\t\t*reg_base;\n\tstruct pci_dev\t\t*pdev;\n\tstruct device\t\t*dev;\n\tstruct hwinfo\t\t*hw;\n\tstruct mcs_rsrc_map\ttx;\n\tstruct mcs_rsrc_map\trx;\n\tu16                     pf_map[MCS_MAX_PFS];  \n\tu8\t\t\tmcs_id;\n\tstruct mcs_ops\t\t*mcs_ops;\n\tstruct list_head\tmcs_list;\n\t \n\tstruct mutex\t\tstats_lock;\n\tstruct mcs_pfvf\t\t*pf;\n\tstruct mcs_pfvf\t\t*vf;\n\tu16\t\t\tnum_vec;\n\tvoid\t\t\t*rvu;\n\tu16\t\t\t*tx_sa_active;\n\tbool                      bypass;\n};\n\nstruct mcs_ops {\n\tvoid\t(*mcs_set_hw_capabilities)(struct mcs *mcs);\n\tvoid\t(*mcs_parser_cfg)(struct mcs *mcs);\n\tvoid\t(*mcs_tx_sa_mem_map_write)(struct mcs *mcs, struct mcs_tx_sc_sa_map *map);\n\tvoid\t(*mcs_rx_sa_mem_map_write)(struct mcs *mcs, struct mcs_rx_sc_sa_map *map);\n\tvoid\t(*mcs_flowid_secy_map)(struct mcs *mcs, struct secy_mem_map *map, int dir);\n\tvoid\t(*mcs_bbe_intr_handler)(struct mcs *mcs, u64 intr, enum mcs_direction dir);\n\tvoid\t(*mcs_pab_intr_handler)(struct mcs *mcs, u64 intr, enum mcs_direction dir);\n};\n\nextern struct pci_driver mcs_driver;\n\nstatic inline void mcs_reg_write(struct mcs *mcs, u64 offset, u64 val)\n{\n\twriteq(val, mcs->reg_base + offset);\n}\n\nstatic inline u64 mcs_reg_read(struct mcs *mcs, u64 offset)\n{\n\treturn readq(mcs->reg_base + offset);\n}\n\n \nstruct mcs *mcs_get_pdata(int mcs_id);\nint mcs_get_blkcnt(void);\nint mcs_set_lmac_channels(int mcs_id, u16 base);\nint mcs_alloc_rsrc(struct rsrc_bmap *rsrc, u16 *pf_map, u16 pcifunc);\nint mcs_free_rsrc(struct rsrc_bmap *rsrc, u16 *pf_map, int rsrc_id, u16 pcifunc);\nint mcs_alloc_all_rsrc(struct mcs *mcs, u8 *flowid, u8 *secy_id,\n\t\t       u8 *sc_id, u8 *sa1_id, u8 *sa2_id, u16 pcifunc, int dir);\nint mcs_free_all_rsrc(struct mcs *mcs, int dir, u16 pcifunc);\nvoid mcs_clear_secy_plcy(struct mcs *mcs, int secy_id, int dir);\nvoid mcs_ena_dis_flowid_entry(struct mcs *mcs, int id, int dir, int ena);\nvoid mcs_ena_dis_sc_cam_entry(struct mcs *mcs, int id, int ena);\nvoid mcs_flowid_entry_write(struct mcs *mcs, u64 *data, u64 *mask, int id, int dir);\nvoid mcs_secy_plcy_write(struct mcs *mcs, u64 plcy, int id, int dir);\nvoid mcs_rx_sc_cam_write(struct mcs *mcs, u64 sci, u64 secy, int sc_id);\nvoid mcs_sa_plcy_write(struct mcs *mcs, u64 *plcy, int sa, int dir);\nvoid mcs_map_sc_to_sa(struct mcs *mcs, u64 *sa_map, int sc, int dir);\nvoid mcs_pn_table_write(struct mcs *mcs, u8 pn_id, u64 next_pn, u8 dir);\nvoid mcs_tx_sa_mem_map_write(struct mcs *mcs, struct mcs_tx_sc_sa_map *map);\nvoid mcs_flowid_secy_map(struct mcs *mcs, struct secy_mem_map *map, int dir);\nvoid mcs_rx_sa_mem_map_write(struct mcs *mcs, struct mcs_rx_sc_sa_map *map);\nvoid mcs_pn_threshold_set(struct mcs *mcs, struct mcs_set_pn_threshold *pn);\nint mcs_install_flowid_bypass_entry(struct mcs *mcs);\nvoid mcs_set_lmac_mode(struct mcs *mcs, int lmac_id, u8 mode);\nvoid mcs_reset_port(struct mcs *mcs, u8 port_id, u8 reset);\nvoid mcs_set_port_cfg(struct mcs *mcs, struct mcs_port_cfg_set_req *req);\nvoid mcs_get_port_cfg(struct mcs *mcs, struct mcs_port_cfg_get_req *req,\n\t\t      struct mcs_port_cfg_get_rsp *rsp);\nvoid mcs_get_custom_tag_cfg(struct mcs *mcs, struct mcs_custom_tag_cfg_get_req *req,\n\t\t\t    struct mcs_custom_tag_cfg_get_rsp *rsp);\nint mcs_alloc_ctrlpktrule(struct rsrc_bmap *rsrc, u16 *pf_map, u16 offset, u16 pcifunc);\nint mcs_free_ctrlpktrule(struct mcs *mcs, struct mcs_free_ctrl_pkt_rule_req *req);\nint mcs_ctrlpktrule_write(struct mcs *mcs, struct mcs_ctrl_pkt_rule_write_req *req);\nbool is_mcs_bypass(int mcs_id);\n\n \nvoid cn10kb_mcs_set_hw_capabilities(struct mcs *mcs);\nvoid cn10kb_mcs_tx_sa_mem_map_write(struct mcs *mcs, struct mcs_tx_sc_sa_map *map);\nvoid cn10kb_mcs_flowid_secy_map(struct mcs *mcs, struct secy_mem_map *map, int dir);\nvoid cn10kb_mcs_rx_sa_mem_map_write(struct mcs *mcs, struct mcs_rx_sc_sa_map *map);\nvoid cn10kb_mcs_parser_cfg(struct mcs *mcs);\nvoid cn10kb_mcs_pab_intr_handler(struct mcs *mcs, u64 intr, enum mcs_direction dir);\nvoid cn10kb_mcs_bbe_intr_handler(struct mcs *mcs, u64 intr, enum mcs_direction dir);\n\n \nstruct mcs_ops *cnf10kb_get_mac_ops(void);\nvoid cnf10kb_mcs_set_hw_capabilities(struct mcs *mcs);\nvoid cnf10kb_mcs_tx_sa_mem_map_write(struct mcs *mcs, struct mcs_tx_sc_sa_map *map);\nvoid cnf10kb_mcs_flowid_secy_map(struct mcs *mcs, struct secy_mem_map *map, int dir);\nvoid cnf10kb_mcs_rx_sa_mem_map_write(struct mcs *mcs, struct mcs_rx_sc_sa_map *map);\nvoid cnf10kb_mcs_parser_cfg(struct mcs *mcs);\nvoid cnf10kb_mcs_tx_pn_thresh_reached_handler(struct mcs *mcs);\nvoid cnf10kb_mcs_tx_pn_wrapped_handler(struct mcs *mcs);\nvoid cnf10kb_mcs_bbe_intr_handler(struct mcs *mcs, u64 intr, enum mcs_direction dir);\nvoid cnf10kb_mcs_pab_intr_handler(struct mcs *mcs, u64 intr, enum mcs_direction dir);\n\n \nvoid mcs_get_sc_stats(struct mcs *mcs, struct mcs_sc_stats *stats, int id, int dir);\nvoid mcs_get_sa_stats(struct mcs *mcs, struct mcs_sa_stats *stats, int id, int dir);\nvoid mcs_get_port_stats(struct mcs *mcs, struct mcs_port_stats *stats, int id, int dir);\nvoid mcs_get_flowid_stats(struct mcs *mcs, struct mcs_flowid_stats *stats, int id, int dir);\nvoid mcs_get_rx_secy_stats(struct mcs *mcs, struct mcs_secy_stats *stats, int id);\nvoid mcs_get_tx_secy_stats(struct mcs *mcs, struct mcs_secy_stats *stats, int id);\nvoid mcs_clear_stats(struct mcs *mcs, u8 type, u8 id, int dir);\nint mcs_clear_all_stats(struct mcs *mcs, u16 pcifunc, int dir);\nint mcs_set_force_clk_en(struct mcs *mcs, bool set);\n\nint mcs_add_intr_wq_entry(struct mcs *mcs, struct mcs_intr_event *event);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}