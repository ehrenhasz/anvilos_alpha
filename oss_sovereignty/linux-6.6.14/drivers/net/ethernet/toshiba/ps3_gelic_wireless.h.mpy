{
  "module_name": "ps3_gelic_wireless.h",
  "hash_id": "dd73dbbe48c678dc6de0ecf201038cd237f6e532f3825e8bd4e7907035fb7057",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/toshiba/ps3_gelic_wireless.h",
  "human_readable_source": " \n \n#ifndef _GELIC_WIRELESS_H\n#define _GELIC_WIRELESS_H\n\n#include <linux/wireless.h>\n#include <net/iw_handler.h>\n\n\n \nenum gelic_lv1_wl_event {\n\tGELIC_LV1_WL_EVENT_DEVICE_READY   = 0x01,  \n\tGELIC_LV1_WL_EVENT_SCAN_COMPLETED = 0x02,  \n\tGELIC_LV1_WL_EVENT_DEAUTH         = 0x04,  \n\tGELIC_LV1_WL_EVENT_BEACON_LOST    = 0x08,  \n\tGELIC_LV1_WL_EVENT_CONNECTED      = 0x10,  \n\tGELIC_LV1_WL_EVENT_WPA_CONNECTED  = 0x20,  \n\tGELIC_LV1_WL_EVENT_WPA_ERROR      = 0x40,  \n};\n\n \nenum gelic_eurus_command {\n\tGELIC_EURUS_CMD_ASSOC\t\t=  1,  \n\tGELIC_EURUS_CMD_DISASSOC\t=  2,  \n\tGELIC_EURUS_CMD_START_SCAN\t=  3,  \n\tGELIC_EURUS_CMD_GET_SCAN\t=  4,  \n\tGELIC_EURUS_CMD_SET_COMMON_CFG\t=  5,  \n\tGELIC_EURUS_CMD_GET_COMMON_CFG\t=  6,  \n\tGELIC_EURUS_CMD_SET_WEP_CFG\t=  7,  \n\tGELIC_EURUS_CMD_GET_WEP_CFG\t=  8,  \n\tGELIC_EURUS_CMD_SET_WPA_CFG\t=  9,  \n\tGELIC_EURUS_CMD_GET_WPA_CFG\t= 10,  \n\tGELIC_EURUS_CMD_GET_RSSI_CFG\t= 11,  \n\tGELIC_EURUS_CMD_MAX_INDEX\n};\n\n \nenum gelic_eurus_bss_type {\n\tGELIC_EURUS_BSS_INFRA = 0,\n\tGELIC_EURUS_BSS_ADHOC = 1,  \n};\n\nenum gelic_eurus_auth_method {\n\tGELIC_EURUS_AUTH_OPEN = 0,  \n\tGELIC_EURUS_AUTH_SHARED = 1,  \n};\n\nenum gelic_eurus_opmode {\n\tGELIC_EURUS_OPMODE_11BG = 0,  \n\tGELIC_EURUS_OPMODE_11B = 1,  \n\tGELIC_EURUS_OPMODE_11G = 2,  \n};\n\nstruct gelic_eurus_common_cfg {\n\t \n\tu16 scan_index;\n\tu16 bss_type;     \n\tu16 auth_method;  \n\tu16 op_mode;  \n} __packed;\n\n\n \nenum gelic_eurus_wep_security {\n\tGELIC_EURUS_WEP_SEC_NONE\t= 0,\n\tGELIC_EURUS_WEP_SEC_40BIT\t= 1,\n\tGELIC_EURUS_WEP_SEC_104BIT\t= 2,\n};\n\nstruct gelic_eurus_wep_cfg {\n\t \n\tu16 security;\n\tu8 key[4][16];\n} __packed;\n\n \nenum gelic_eurus_wpa_security {\n\tGELIC_EURUS_WPA_SEC_NONE\t\t= 0x0000,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA_TKIP_TKIP\t= 0x0001,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA_AES_AES\t\t= 0x0002,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA2_TKIP_TKIP\t= 0x0004,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA2_AES_AES\t= 0x0008,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA_TKIP_AES\t= 0x0010,\n\t \n\tGELIC_EURUS_WPA_SEC_WPA2_TKIP_AES\t= 0x0020,\n};\n\nenum gelic_eurus_wpa_psk_type {\n\tGELIC_EURUS_WPA_PSK_PASSPHRASE\t= 0,  \n\tGELIC_EURUS_WPA_PSK_BIN\t\t= 1,  \n};\n\n#define GELIC_WL_EURUS_PSK_MAX_LEN\t64\n#define WPA_PSK_LEN\t\t\t32  \n\nstruct gelic_eurus_wpa_cfg {\n\t \n\tu16 security;\n\tu16 psk_type;  \n\tu8 psk[GELIC_WL_EURUS_PSK_MAX_LEN];  \n} __packed;\n\n \nenum gelic_eurus_scan_capability {\n\tGELIC_EURUS_SCAN_CAP_ADHOC\t= 0x0000,\n\tGELIC_EURUS_SCAN_CAP_INFRA\t= 0x0001,\n\tGELIC_EURUS_SCAN_CAP_MASK\t= 0x0001,\n};\n\nenum gelic_eurus_scan_sec_type {\n\tGELIC_EURUS_SCAN_SEC_NONE\t= 0x0000,\n\tGELIC_EURUS_SCAN_SEC_WEP\t= 0x0100,\n\tGELIC_EURUS_SCAN_SEC_WPA\t= 0x0200,\n\tGELIC_EURUS_SCAN_SEC_WPA2\t= 0x0400,\n\tGELIC_EURUS_SCAN_SEC_MASK\t= 0x0f00,\n};\n\nenum gelic_eurus_scan_sec_wep_type {\n\tGELIC_EURUS_SCAN_SEC_WEP_UNKNOWN\t= 0x0000,\n\tGELIC_EURUS_SCAN_SEC_WEP_40\t\t= 0x0001,\n\tGELIC_EURUS_SCAN_SEC_WEP_104\t\t= 0x0002,\n\tGELIC_EURUS_SCAN_SEC_WEP_MASK\t\t= 0x0003,\n};\n\nenum gelic_eurus_scan_sec_wpa_type {\n\tGELIC_EURUS_SCAN_SEC_WPA_UNKNOWN\t= 0x0000,\n\tGELIC_EURUS_SCAN_SEC_WPA_TKIP\t\t= 0x0001,\n\tGELIC_EURUS_SCAN_SEC_WPA_AES\t\t= 0x0002,\n\tGELIC_EURUS_SCAN_SEC_WPA_MASK\t\t= 0x0003,\n};\n\n \nstruct gelic_eurus_scan_info {\n\t \n\t__be16 size;\n\t__be16 rssi;  \n\t__be16 channel;  \n\t__be16 beacon_period;  \n\t__be16 capability;\n\t__be16 security;\n\tu8  bssid[8];  \n\tu8  essid[32];  \n\tu8  rate[16];  \n\tu8  ext_rate[16];  \n\t__be32 reserved1;\n\t__be32 reserved2;\n\t__be32 reserved3;\n\t__be32 reserved4;\n\tu8 elements[];  \n} __packed;\n\n \n#define GELIC_EURUS_MAX_SCAN  (16)\nstruct gelic_wl_scan_info {\n\tstruct list_head list;\n\tstruct gelic_eurus_scan_info *hwinfo;\n\n\tint valid;  \n\tunsigned int eurus_index;  \n\tunsigned long last_scanned;  \n\n\tunsigned int rate_len;\n\tunsigned int rate_ext_len;\n\tunsigned int essid_len;\n};\n\n \nstruct gelic_eurus_rssi_info {\n\t \n\t__be16 rssi;\n} __packed;\n\n\n \nenum gelic_wl_info_status_bit {\n\tGELIC_WL_STAT_CONFIGURED,\n\tGELIC_WL_STAT_CH_INFO,    \n\tGELIC_WL_STAT_ESSID_SET,  \n\tGELIC_WL_STAT_BSSID_SET,  \n\tGELIC_WL_STAT_WPA_PSK_SET,  \n\tGELIC_WL_STAT_WPA_LEVEL_SET,  \n};\n\n \nenum gelic_wl_scan_state {\n\t \n\tGELIC_WL_SCAN_STAT_INIT,\n\t \n\tGELIC_WL_SCAN_STAT_SCANNING,\n\t \n\tGELIC_WL_SCAN_STAT_GOT_LIST,\n};\n\n \nenum gelic_wl_cipher_method {\n\tGELIC_WL_CIPHER_NONE,\n\tGELIC_WL_CIPHER_WEP,\n\tGELIC_WL_CIPHER_TKIP,\n\tGELIC_WL_CIPHER_AES,\n};\n\n \nenum gelic_wl_wpa_level {\n\tGELIC_WL_WPA_LEVEL_NONE,\n\tGELIC_WL_WPA_LEVEL_WPA,\n\tGELIC_WL_WPA_LEVEL_WPA2,\n};\n\n \nenum gelic_wl_assoc_state {\n\tGELIC_WL_ASSOC_STAT_DISCONN,\n\tGELIC_WL_ASSOC_STAT_ASSOCIATING,\n\tGELIC_WL_ASSOC_STAT_ASSOCIATED,\n};\n \n#define GELIC_WEP_KEYS 4\nstruct gelic_wl_info {\n\t \n\tstruct mutex scan_lock;\n\tstruct list_head network_list;\n\tstruct list_head network_free_list;\n\tstruct gelic_wl_scan_info *networks;\n\n\tunsigned long scan_age;  \n\tenum gelic_wl_scan_state scan_stat;\n\tstruct completion scan_done;\n\n\t \n\tstruct workqueue_struct *eurus_cmd_queue;\n\tstruct completion cmd_done_intr;\n\n\t \n\tstruct workqueue_struct *event_queue;\n\tstruct delayed_work event_work;\n\n\t \n\tunsigned long stat;\n\tenum gelic_eurus_auth_method auth_method;  \n\tenum gelic_wl_cipher_method group_cipher_method;\n\tenum gelic_wl_cipher_method pairwise_cipher_method;\n\tenum gelic_wl_wpa_level wpa_level;  \n\n\t \n\tstruct mutex assoc_stat_lock;\n\tstruct delayed_work assoc_work;\n\tenum gelic_wl_assoc_state assoc_stat;\n\tstruct completion assoc_done;\n\n\tspinlock_t lock;\n\tu16 ch_info;  \n\t \n\tu8 key[GELIC_WEP_KEYS][IW_ENCODING_TOKEN_MAX];\n\tunsigned long key_enabled;\n\tunsigned int key_len[GELIC_WEP_KEYS];\n\tunsigned int current_key;\n\t \n\tu8 psk[GELIC_WL_EURUS_PSK_MAX_LEN];\n\tenum gelic_eurus_wpa_psk_type psk_type;\n\tunsigned int psk_len;\n\n\tu8 essid[IW_ESSID_MAX_SIZE];\n\tu8 bssid[ETH_ALEN];  \n\tu8 active_bssid[ETH_ALEN];  \n\tunsigned int essid_len;\n\n\tstruct iw_public_data wireless_data;\n\tstruct iw_statistics iwstat;\n};\n\n#define GELIC_WL_BSS_MAX_ENT 32\n#define GELIC_WL_ASSOC_RETRY 50\nstatic inline struct gelic_port *wl_port(struct gelic_wl_info *wl)\n{\n\treturn container_of((void *)wl, struct gelic_port, priv);\n}\nstatic inline struct gelic_wl_info *port_wl(struct gelic_port *port)\n{\n\treturn port_priv(port);\n}\n\nstruct gelic_eurus_cmd {\n\tstruct work_struct work;\n\tstruct gelic_wl_info *wl;\n\tunsigned int cmd;  \n\tu64 tag;\n\tu64 size;\n\tvoid *buffer;\n\tunsigned int buf_size;\n\tstruct completion done;\n\tint status;\n\tu64 cmd_status;\n};\n\n \n#define GELIC_WL_PRIV_SET_PSK\t\t(SIOCIWFIRSTPRIV + 0)\n#define GELIC_WL_PRIV_GET_PSK\t\t(SIOCIWFIRSTPRIV + 1)\n\nint gelic_wl_driver_probe(struct gelic_card *card);\nint gelic_wl_driver_remove(struct gelic_card *card);\nvoid gelic_wl_interrupt(struct net_device *netdev, u64 status);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}