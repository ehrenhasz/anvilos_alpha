{
  "module_name": "ps3_gelic_net.h",
  "hash_id": "be013b02f1779e2fe24f7d81e6db6686a2bf23ea691137fa3a136da3bed1349f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/ethernet/toshiba/ps3_gelic_net.h",
  "human_readable_source": " \n \n#ifndef _GELIC_NET_H\n#define _GELIC_NET_H\n\n \n#define GELIC_NET_RX_DESCRIPTORS        128  \n#define GELIC_NET_TX_DESCRIPTORS        128  \n\n#define GELIC_NET_MAX_FRAME             2312\n#define GELIC_NET_MAX_MTU               2294\n#define GELIC_NET_MIN_MTU               64\n#define GELIC_NET_RXBUF_ALIGN           128\n#define GELIC_CARD_RX_CSUM_DEFAULT      1  \n#define GELIC_NET_WATCHDOG_TIMEOUT      5*HZ\n#define GELIC_NET_BROADCAST_ADDR        0xffffffffffffL\n\n#define GELIC_NET_MC_COUNT_MAX          32  \n\n \n\t \n#define GELIC_CARD_TX_RAM_FULL_ERR           0x0000000000000001L\n#define GELIC_CARD_RX_RAM_FULL_ERR           0x0000000000000002L\n#define GELIC_CARD_TX_SHORT_FRAME_ERR        0x0000000000000004L\n#define GELIC_CARD_TX_INVALID_DESCR_ERR      0x0000000000000008L\n#define GELIC_CARD_RX_FIFO_FULL_ERR          0x0000000000002000L\n#define GELIC_CARD_RX_DESCR_CHAIN_END        0x0000000000004000L\n#define GELIC_CARD_RX_INVALID_DESCR_ERR      0x0000000000008000L\n#define GELIC_CARD_TX_RESPONCE_ERR           0x0000000000010000L\n#define GELIC_CARD_RX_RESPONCE_ERR           0x0000000000100000L\n#define GELIC_CARD_TX_PROTECTION_ERR         0x0000000000400000L\n#define GELIC_CARD_RX_PROTECTION_ERR         0x0000000004000000L\n#define GELIC_CARD_TX_TCP_UDP_CHECKSUM_ERR   0x0000000008000000L\n#define GELIC_CARD_PORT_STATUS_CHANGED       0x0000000020000000L\n#define GELIC_CARD_WLAN_EVENT_RECEIVED       0x0000000040000000L\n#define GELIC_CARD_WLAN_COMMAND_COMPLETED    0x0000000080000000L\n\t \n#define GELIC_CARD_TX_FLAGGED_DESCR          0x0004000000000000L\n#define GELIC_CARD_RX_FLAGGED_DESCR          0x0040000000000000L\n#define GELIC_CARD_TX_TRANSFER_END           0x0080000000000000L\n#define GELIC_CARD_TX_DESCR_CHAIN_END        0x0100000000000000L\n#define GELIC_CARD_NUMBER_OF_RX_FRAME        0x1000000000000000L\n#define GELIC_CARD_ONE_TIME_COUNT_TIMER      0x4000000000000000L\n#define GELIC_CARD_FREE_RUN_COUNT_TIMER      0x8000000000000000L\n\n \n#define GELIC_CARD_TXINT\tGELIC_CARD_TX_DESCR_CHAIN_END\n\n#define GELIC_CARD_RXINT\t(GELIC_CARD_RX_DESCR_CHAIN_END | \\\n\t\t\t\t GELIC_CARD_NUMBER_OF_RX_FRAME)\n\n  \nenum gelic_descr_rx_status {\n\tGELIC_DESCR_RXDMADU\t= 0x80000000,  \n\tGELIC_DESCR_RXLSTFBF\t= 0x40000000,  \n\tGELIC_DESCR_RXIPCHK\t= 0x20000000,  \n\tGELIC_DESCR_RXTCPCHK\t= 0x10000000,  \n\tGELIC_DESCR_RXWTPKT\t= 0x00C00000,  \n\tGELIC_DESCR_RXVLNPKT\t= 0x00200000,  \n\t \n\tGELIC_DESCR_RXRRECNUM\t= 0x0000ff00,  \n\t \n};\n\n#define GELIC_DESCR_DATA_STATUS_CHK_MASK\t\\\n\t(GELIC_DESCR_RXIPCHK | GELIC_DESCR_RXTCPCHK)\n\n  \nenum gelic_descr_tx_status {\n\tGELIC_DESCR_TX_TAIL\t= 0x00000001,  \n};\n\n \nenum gelic_descr_rx_error {\n\t \n\tGELIC_DESCR_RXALNERR\t= 0x40000000,  \n\tGELIC_DESCR_RXOVERERR\t= 0x20000000,  \n\tGELIC_DESCR_RXRNTERR\t= 0x10000000,  \n\tGELIC_DESCR_RXIPCHKERR\t= 0x08000000,  \n\tGELIC_DESCR_RXTCPCHKERR\t= 0x04000000,  \n\tGELIC_DESCR_RXDRPPKT\t= 0x00100000,  \n\tGELIC_DESCR_RXIPFMTERR\t= 0x00080000,  \n\t \n\tGELIC_DESCR_RXDATAERR\t= 0x00020000,  \n\tGELIC_DESCR_RXCALERR\t= 0x00010000,  \n\tGELIC_DESCR_RXCREXERR\t= 0x00008000,  \n\tGELIC_DESCR_RXMLTCST\t= 0x00004000,  \n\t \n};\n#define GELIC_DESCR_DATA_ERROR_CHK_MASK\t\t\\\n\t(GELIC_DESCR_RXIPCHKERR | GELIC_DESCR_RXTCPCHKERR)\n\n \nenum gelic_descr_dma_status {\n\tGELIC_DESCR_DMA_COMPLETE            = 0x00000000,  \n\tGELIC_DESCR_DMA_BUFFER_FULL         = 0x00000000,  \n\tGELIC_DESCR_DMA_RESPONSE_ERROR      = 0x10000000,  \n\tGELIC_DESCR_DMA_PROTECTION_ERROR    = 0x20000000,  \n\tGELIC_DESCR_DMA_FRAME_END           = 0x40000000,  \n\tGELIC_DESCR_DMA_FORCE_END           = 0x50000000,  \n\tGELIC_DESCR_DMA_CARDOWNED           = 0xa0000000,  \n\tGELIC_DESCR_DMA_NOT_IN_USE          = 0xb0000000,  \n};\n\n#define GELIC_DESCR_DMA_STAT_MASK\t(0xf0000000)\n\n \nenum gelic_descr_tx_dma_status {\n\t \n\tGELIC_DESCR_TX_DMA_IKE\t\t= 0x00080000,  \n\t \n\tGELIC_DESCR_TX_DMA_FRAME_TAIL\t= 0x00040000,  \n\t \n\tGELIC_DESCR_TX_DMA_TCP_CHKSUM\t= 0x00020000,  \n\tGELIC_DESCR_TX_DMA_UDP_CHKSUM\t= 0x00030000,  \n\tGELIC_DESCR_TX_DMA_NO_CHKSUM\t= 0x00000000,  \n\n\t \n\tGELIC_DESCR_TX_DMA_CHAIN_END\t= 0x00000002,  \n};\n\n#define GELIC_DESCR_DMA_CMD_NO_CHKSUM\t\\\n\t(GELIC_DESCR_DMA_CARDOWNED | GELIC_DESCR_TX_DMA_IKE | \\\n\tGELIC_DESCR_TX_DMA_NO_CHKSUM)\n\n#define GELIC_DESCR_DMA_CMD_TCP_CHKSUM\t\\\n\t(GELIC_DESCR_DMA_CARDOWNED | GELIC_DESCR_TX_DMA_IKE | \\\n\tGELIC_DESCR_TX_DMA_TCP_CHKSUM)\n\n#define GELIC_DESCR_DMA_CMD_UDP_CHKSUM\t\\\n\t(GELIC_DESCR_DMA_CARDOWNED | GELIC_DESCR_TX_DMA_IKE | \\\n\tGELIC_DESCR_TX_DMA_UDP_CHKSUM)\n\nenum gelic_descr_rx_dma_status {\n\t \n\tGELIC_DESCR_RX_DMA_CHAIN_END\t= 0x00000002,  \n};\n\n \nenum gelic_lv1_net_control_code {\n\tGELIC_LV1_GET_MAC_ADDRESS\t= 1,\n\tGELIC_LV1_GET_ETH_PORT_STATUS\t= 2,\n\tGELIC_LV1_SET_NEGOTIATION_MODE\t= 3,\n\tGELIC_LV1_GET_VLAN_ID\t\t= 4,\n\tGELIC_LV1_SET_WOL\t\t= 5,\n\tGELIC_LV1_GET_CHANNEL           = 6,\n\tGELIC_LV1_POST_WLAN_CMD\t\t= 9,\n\tGELIC_LV1_GET_WLAN_CMD_RESULT\t= 10,\n\tGELIC_LV1_GET_WLAN_EVENT\t= 11,\n};\n\n \nenum gelic_lv1_wol_command {\n\tGELIC_LV1_WOL_MAGIC_PACKET\t= 1,\n\tGELIC_LV1_WOL_ADD_MATCH_ADDR\t= 6,\n\tGELIC_LV1_WOL_DELETE_MATCH_ADDR\t= 7,\n};\n\n \nenum gelic_lv1_wol_mp_arg {\n\tGELIC_LV1_WOL_MP_DISABLE\t= 0,\n\tGELIC_LV1_WOL_MP_ENABLE\t\t= 1,\n};\n\n \nenum gelic_lv1_wol_match_arg {\n\tGELIC_LV1_WOL_MATCH_INDIVIDUAL\t= 0,\n\tGELIC_LV1_WOL_MATCH_ALL\t\t= 1,\n};\n\n \nenum gelic_lv1_ether_port_status {\n\tGELIC_LV1_ETHER_LINK_UP\t\t= 0x0000000000000001L,\n\tGELIC_LV1_ETHER_FULL_DUPLEX\t= 0x0000000000000002L,\n\tGELIC_LV1_ETHER_AUTO_NEG\t= 0x0000000000000004L,\n\n\tGELIC_LV1_ETHER_SPEED_10\t= 0x0000000000000010L,\n\tGELIC_LV1_ETHER_SPEED_100\t= 0x0000000000000020L,\n\tGELIC_LV1_ETHER_SPEED_1000\t= 0x0000000000000040L,\n\tGELIC_LV1_ETHER_SPEED_MASK\t= 0x0000000000000070L,\n};\n\nenum gelic_lv1_vlan_index {\n\t \n\tGELIC_LV1_VLAN_TX_ETHERNET_0\t= 0x0000000000000002L,\n\tGELIC_LV1_VLAN_TX_WIRELESS\t= 0x0000000000000003L,\n\n\t \n\tGELIC_LV1_VLAN_RX_ETHERNET_0\t= 0x0000000000000012L,\n\tGELIC_LV1_VLAN_RX_WIRELESS\t= 0x0000000000000013L,\n};\n\nenum gelic_lv1_phy {\n\tGELIC_LV1_PHY_ETHERNET_0\t= 0x0000000000000002L,\n};\n\n \n#define GELIC_DESCR_SIZE\t(32)\n\nenum gelic_port_type {\n\tGELIC_PORT_ETHERNET_0\t= 0,\n\tGELIC_PORT_WIRELESS\t= 1,\n\tGELIC_PORT_MAX\n};\n\nstruct gelic_descr {\n\t \n\t__be32 buf_addr;\n\t__be32 buf_size;\n\t__be32 next_descr_addr;\n\t__be32 dmac_cmd_status;\n\t__be32 result_size;\n\t__be32 valid_size;\t \n\t__be32 data_status;\n\t__be32 data_error;\t \n\n\t \n\tstruct sk_buff *skb;\n\tdma_addr_t bus_addr;\n\tstruct gelic_descr *next;\n\tstruct gelic_descr *prev;\n} __attribute__((aligned(32)));\n\nstruct gelic_descr_chain {\n\t \n\tstruct gelic_descr *head;\n\tstruct gelic_descr *tail;\n};\n\nstruct gelic_vlan_id {\n\tu16 tx;\n\tu16 rx;\n};\n\nstruct gelic_card {\n\tstruct napi_struct napi;\n\tstruct net_device *netdev[GELIC_PORT_MAX];\n\t \n\tu64 irq_status;\n\tu64 irq_mask;\n\n\tstruct ps3_system_bus_device *dev;\n\tstruct gelic_vlan_id vlan[GELIC_PORT_MAX];\n\tint vlan_required;\n\n\tstruct gelic_descr_chain tx_chain;\n\tstruct gelic_descr_chain rx_chain;\n\t \n\tspinlock_t tx_lock;\n\tint tx_dma_progress;\n\n\tstruct work_struct tx_timeout_task;\n\tatomic_t tx_timeout_task_counter;\n\twait_queue_head_t waitq;\n\n\t \n\tstruct mutex updown_lock;\n\tatomic_t users;\n\n\tu64 ether_port_status;\n\tint link_mode;\n\n\t \n\tvoid *unalign;\n\n\t \n\tunsigned int irq;\n\tstruct gelic_descr *tx_top, *rx_top;\n\tstruct gelic_descr descr[];  \n};\n\nstruct gelic_port {\n\tstruct gelic_card *card;\n\tstruct net_device *netdev;\n\tenum gelic_port_type type;\n\tlong priv[];  \n};\n\nstatic inline struct gelic_card *port_to_card(struct gelic_port *p)\n{\n\treturn p->card;\n}\nstatic inline struct net_device *port_to_netdev(struct gelic_port *p)\n{\n\treturn p->netdev;\n}\nstatic inline struct gelic_card *netdev_card(struct net_device *d)\n{\n\treturn ((struct gelic_port *)netdev_priv(d))->card;\n}\nstatic inline struct gelic_port *netdev_port(struct net_device *d)\n{\n\treturn (struct gelic_port *)netdev_priv(d);\n}\nstatic inline struct device *ctodev(struct gelic_card *card)\n{\n\treturn &card->dev->core;\n}\nstatic inline u64 bus_id(struct gelic_card *card)\n{\n\treturn card->dev->bus_id;\n}\nstatic inline u64 dev_id(struct gelic_card *card)\n{\n\treturn card->dev->dev_id;\n}\n\nstatic inline void *port_priv(struct gelic_port *port)\n{\n\treturn port->priv;\n}\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_PS3GELIC\nvoid udbg_shutdown_ps3gelic(void);\n#else\nstatic inline void udbg_shutdown_ps3gelic(void) {}\n#endif\n\nint gelic_card_set_irq_mask(struct gelic_card *card, u64 mask);\n \nvoid gelic_card_up(struct gelic_card *card);\nvoid gelic_card_down(struct gelic_card *card);\nint gelic_net_open(struct net_device *netdev);\nint gelic_net_stop(struct net_device *netdev);\nnetdev_tx_t gelic_net_xmit(struct sk_buff *skb, struct net_device *netdev);\nvoid gelic_net_set_multi(struct net_device *netdev);\nvoid gelic_net_tx_timeout(struct net_device *netdev, unsigned int txqueue);\nint gelic_net_setup_netdev(struct net_device *netdev, struct gelic_card *card);\n\n \nvoid gelic_net_get_drvinfo(struct net_device *netdev,\n\t\t\t   struct ethtool_drvinfo *info);\nvoid gelic_net_poll_controller(struct net_device *netdev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}