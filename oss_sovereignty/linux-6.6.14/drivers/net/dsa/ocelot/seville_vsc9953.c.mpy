{
  "module_name": "seville_vsc9953.c",
  "hash_id": "c324e472e8393c806a452df8e8cb81519db35e144e933eef89241b076a957f0c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/dsa/ocelot/seville_vsc9953.c",
  "human_readable_source": "\n \n#include <linux/platform_device.h>\n#include <linux/types.h>\n#include <soc/mscc/ocelot_vcap.h>\n#include <soc/mscc/ocelot_sys.h>\n#include <soc/mscc/ocelot.h>\n#include <linux/mdio/mdio-mscc-miim.h>\n#include <linux/mod_devicetable.h>\n#include <linux/of_mdio.h>\n#include <linux/pcs-lynx.h>\n#include <linux/dsa/ocelot.h>\n#include <linux/iopoll.h>\n#include \"felix.h\"\n\n#define VSC9953_NUM_PORTS\t\t\t10\n\n#define VSC9953_VCAP_POLICER_BASE\t\t11\n#define VSC9953_VCAP_POLICER_MAX\t\t31\n#define VSC9953_VCAP_POLICER_BASE2\t\t120\n#define VSC9953_VCAP_POLICER_MAX2\t\t161\n\n#define VSC9953_PORT_MODE_SERDES\t\t(OCELOT_PORT_MODE_1000BASEX | \\\n\t\t\t\t\t\t OCELOT_PORT_MODE_SGMII | \\\n\t\t\t\t\t\t OCELOT_PORT_MODE_QSGMII)\n\nstatic const u32 vsc9953_port_modes[VSC9953_NUM_PORTS] = {\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tVSC9953_PORT_MODE_SERDES,\n\tOCELOT_PORT_MODE_INTERNAL,\n\tOCELOT_PORT_MODE_INTERNAL,\n};\n\nstatic const u32 vsc9953_ana_regmap[] = {\n\tREG(ANA_ADVLEARN,\t\t\t0x00b500),\n\tREG(ANA_VLANMASK,\t\t\t0x00b504),\n\tREG_RESERVED(ANA_PORT_B_DOMAIN),\n\tREG(ANA_ANAGEFIL,\t\t\t0x00b50c),\n\tREG(ANA_ANEVENTS,\t\t\t0x00b510),\n\tREG(ANA_STORMLIMIT_BURST,\t\t0x00b514),\n\tREG(ANA_STORMLIMIT_CFG,\t\t\t0x00b518),\n\tREG(ANA_ISOLATED_PORTS,\t\t\t0x00b528),\n\tREG(ANA_COMMUNITY_PORTS,\t\t0x00b52c),\n\tREG(ANA_AUTOAGE,\t\t\t0x00b530),\n\tREG(ANA_MACTOPTIONS,\t\t\t0x00b534),\n\tREG(ANA_LEARNDISC,\t\t\t0x00b538),\n\tREG(ANA_AGENCTRL,\t\t\t0x00b53c),\n\tREG(ANA_MIRRORPORTS,\t\t\t0x00b540),\n\tREG(ANA_EMIRRORPORTS,\t\t\t0x00b544),\n\tREG(ANA_FLOODING,\t\t\t0x00b548),\n\tREG(ANA_FLOODING_IPMC,\t\t\t0x00b54c),\n\tREG(ANA_SFLOW_CFG,\t\t\t0x00b550),\n\tREG(ANA_PORT_MODE,\t\t\t0x00b57c),\n\tREG_RESERVED(ANA_CUT_THRU_CFG),\n\tREG(ANA_PGID_PGID,\t\t\t0x00b600),\n\tREG(ANA_TABLES_ANMOVED,\t\t\t0x00b4ac),\n\tREG(ANA_TABLES_MACHDATA,\t\t0x00b4b0),\n\tREG(ANA_TABLES_MACLDATA,\t\t0x00b4b4),\n\tREG_RESERVED(ANA_TABLES_STREAMDATA),\n\tREG(ANA_TABLES_MACACCESS,\t\t0x00b4b8),\n\tREG(ANA_TABLES_MACTINDX,\t\t0x00b4bc),\n\tREG(ANA_TABLES_VLANACCESS,\t\t0x00b4c0),\n\tREG(ANA_TABLES_VLANTIDX,\t\t0x00b4c4),\n\tREG_RESERVED(ANA_TABLES_ISDXACCESS),\n\tREG_RESERVED(ANA_TABLES_ISDXTIDX),\n\tREG(ANA_TABLES_ENTRYLIM,\t\t0x00b480),\n\tREG_RESERVED(ANA_TABLES_PTP_ID_HIGH),\n\tREG_RESERVED(ANA_TABLES_PTP_ID_LOW),\n\tREG_RESERVED(ANA_TABLES_STREAMACCESS),\n\tREG_RESERVED(ANA_TABLES_STREAMTIDX),\n\tREG_RESERVED(ANA_TABLES_SEQ_HISTORY),\n\tREG_RESERVED(ANA_TABLES_SEQ_MASK),\n\tREG_RESERVED(ANA_TABLES_SFID_MASK),\n\tREG_RESERVED(ANA_TABLES_SFIDACCESS),\n\tREG_RESERVED(ANA_TABLES_SFIDTIDX),\n\tREG_RESERVED(ANA_MSTI_STATE),\n\tREG_RESERVED(ANA_OAM_UPM_LM_CNT),\n\tREG_RESERVED(ANA_SG_ACCESS_CTRL),\n\tREG_RESERVED(ANA_SG_CONFIG_REG_1),\n\tREG_RESERVED(ANA_SG_CONFIG_REG_2),\n\tREG_RESERVED(ANA_SG_CONFIG_REG_3),\n\tREG_RESERVED(ANA_SG_CONFIG_REG_4),\n\tREG_RESERVED(ANA_SG_CONFIG_REG_5),\n\tREG_RESERVED(ANA_SG_GCL_GS_CONFIG),\n\tREG_RESERVED(ANA_SG_GCL_TI_CONFIG),\n\tREG_RESERVED(ANA_SG_STATUS_REG_1),\n\tREG_RESERVED(ANA_SG_STATUS_REG_2),\n\tREG_RESERVED(ANA_SG_STATUS_REG_3),\n\tREG(ANA_PORT_VLAN_CFG,\t\t\t0x000000),\n\tREG(ANA_PORT_DROP_CFG,\t\t\t0x000004),\n\tREG(ANA_PORT_QOS_CFG,\t\t\t0x000008),\n\tREG(ANA_PORT_VCAP_CFG,\t\t\t0x00000c),\n\tREG(ANA_PORT_VCAP_S1_KEY_CFG,\t\t0x000010),\n\tREG(ANA_PORT_VCAP_S2_CFG,\t\t0x00001c),\n\tREG(ANA_PORT_PCP_DEI_MAP,\t\t0x000020),\n\tREG(ANA_PORT_CPU_FWD_CFG,\t\t0x000060),\n\tREG(ANA_PORT_CPU_FWD_BPDU_CFG,\t\t0x000064),\n\tREG(ANA_PORT_CPU_FWD_GARP_CFG,\t\t0x000068),\n\tREG(ANA_PORT_CPU_FWD_CCM_CFG,\t\t0x00006c),\n\tREG(ANA_PORT_PORT_CFG,\t\t\t0x000070),\n\tREG(ANA_PORT_POL_CFG,\t\t\t0x000074),\n\tREG_RESERVED(ANA_PORT_PTP_CFG),\n\tREG_RESERVED(ANA_PORT_PTP_DLY1_CFG),\n\tREG_RESERVED(ANA_PORT_PTP_DLY2_CFG),\n\tREG_RESERVED(ANA_PORT_SFID_CFG),\n\tREG(ANA_PFC_PFC_CFG,\t\t\t0x00c000),\n\tREG_RESERVED(ANA_PFC_PFC_TIMER),\n\tREG_RESERVED(ANA_IPT_OAM_MEP_CFG),\n\tREG_RESERVED(ANA_IPT_IPT),\n\tREG_RESERVED(ANA_PPT_PPT),\n\tREG_RESERVED(ANA_FID_MAP_FID_MAP),\n\tREG(ANA_AGGR_CFG,\t\t\t0x00c600),\n\tREG(ANA_CPUQ_CFG,\t\t\t0x00c604),\n\tREG_RESERVED(ANA_CPUQ_CFG2),\n\tREG(ANA_CPUQ_8021_CFG,\t\t\t0x00c60c),\n\tREG(ANA_DSCP_CFG,\t\t\t0x00c64c),\n\tREG(ANA_DSCP_REWR_CFG,\t\t\t0x00c74c),\n\tREG(ANA_VCAP_RNG_TYPE_CFG,\t\t0x00c78c),\n\tREG(ANA_VCAP_RNG_VAL_CFG,\t\t0x00c7ac),\n\tREG_RESERVED(ANA_VRAP_CFG),\n\tREG_RESERVED(ANA_VRAP_HDR_DATA),\n\tREG_RESERVED(ANA_VRAP_HDR_MASK),\n\tREG(ANA_DISCARD_CFG,\t\t\t0x00c7d8),\n\tREG(ANA_FID_CFG,\t\t\t0x00c7dc),\n\tREG(ANA_POL_PIR_CFG,\t\t\t0x00a000),\n\tREG(ANA_POL_CIR_CFG,\t\t\t0x00a004),\n\tREG(ANA_POL_MODE_CFG,\t\t\t0x00a008),\n\tREG(ANA_POL_PIR_STATE,\t\t\t0x00a00c),\n\tREG(ANA_POL_CIR_STATE,\t\t\t0x00a010),\n\tREG_RESERVED(ANA_POL_STATE),\n\tREG(ANA_POL_FLOWC,\t\t\t0x00c280),\n\tREG(ANA_POL_HYST,\t\t\t0x00c2ec),\n\tREG_RESERVED(ANA_POL_MISC_CFG),\n};\n\nstatic const u32 vsc9953_qs_regmap[] = {\n\tREG(QS_XTR_GRP_CFG,\t\t\t0x000000),\n\tREG(QS_XTR_RD,\t\t\t\t0x000008),\n\tREG(QS_XTR_FRM_PRUNING,\t\t\t0x000010),\n\tREG(QS_XTR_FLUSH,\t\t\t0x000018),\n\tREG(QS_XTR_DATA_PRESENT,\t\t0x00001c),\n\tREG(QS_XTR_CFG,\t\t\t\t0x000020),\n\tREG(QS_INJ_GRP_CFG,\t\t\t0x000024),\n\tREG(QS_INJ_WR,\t\t\t\t0x00002c),\n\tREG(QS_INJ_CTRL,\t\t\t0x000034),\n\tREG(QS_INJ_STATUS,\t\t\t0x00003c),\n\tREG(QS_INJ_ERR,\t\t\t\t0x000040),\n\tREG_RESERVED(QS_INH_DBG),\n};\n\nstatic const u32 vsc9953_vcap_regmap[] = {\n\t \n\tREG(VCAP_CORE_UPDATE_CTRL,\t\t0x000000),\n\tREG(VCAP_CORE_MV_CFG,\t\t\t0x000004),\n\t \n\tREG(VCAP_CACHE_ENTRY_DAT,\t\t0x000008),\n\tREG(VCAP_CACHE_MASK_DAT,\t\t0x000108),\n\tREG(VCAP_CACHE_ACTION_DAT,\t\t0x000208),\n\tREG(VCAP_CACHE_CNT_DAT,\t\t\t0x000308),\n\tREG(VCAP_CACHE_TG_DAT,\t\t\t0x000388),\n\t \n\tREG(VCAP_CONST_VCAP_VER,\t\t0x000398),\n\tREG(VCAP_CONST_ENTRY_WIDTH,\t\t0x00039c),\n\tREG(VCAP_CONST_ENTRY_CNT,\t\t0x0003a0),\n\tREG(VCAP_CONST_ENTRY_SWCNT,\t\t0x0003a4),\n\tREG(VCAP_CONST_ENTRY_TG_WIDTH,\t\t0x0003a8),\n\tREG(VCAP_CONST_ACTION_DEF_CNT,\t\t0x0003ac),\n\tREG(VCAP_CONST_ACTION_WIDTH,\t\t0x0003b0),\n\tREG(VCAP_CONST_CNT_WIDTH,\t\t0x0003b4),\n\tREG_RESERVED(VCAP_CONST_CORE_CNT),\n\tREG_RESERVED(VCAP_CONST_IF_CNT),\n};\n\nstatic const u32 vsc9953_qsys_regmap[] = {\n\tREG(QSYS_PORT_MODE,\t\t\t0x003600),\n\tREG(QSYS_SWITCH_PORT_MODE,\t\t0x003630),\n\tREG(QSYS_STAT_CNT_CFG,\t\t\t0x00365c),\n\tREG(QSYS_EEE_CFG,\t\t\t0x003660),\n\tREG(QSYS_EEE_THRES,\t\t\t0x003688),\n\tREG(QSYS_IGR_NO_SHARING,\t\t0x00368c),\n\tREG(QSYS_EGR_NO_SHARING,\t\t0x003690),\n\tREG(QSYS_SW_STATUS,\t\t\t0x003694),\n\tREG(QSYS_EXT_CPU_CFG,\t\t\t0x0036c0),\n\tREG_RESERVED(QSYS_PAD_CFG),\n\tREG(QSYS_CPU_GROUP_MAP,\t\t\t0x0036c8),\n\tREG_RESERVED(QSYS_QMAP),\n\tREG_RESERVED(QSYS_ISDX_SGRP),\n\tREG_RESERVED(QSYS_TIMED_FRAME_ENTRY),\n\tREG_RESERVED(QSYS_TFRM_MISC),\n\tREG_RESERVED(QSYS_TFRM_PORT_DLY),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_1),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_2),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_3),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_4),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_5),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_6),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_7),\n\tREG_RESERVED(QSYS_TFRM_TIMER_CFG_8),\n\tREG(QSYS_RED_PROFILE,\t\t\t0x003724),\n\tREG(QSYS_RES_QOS_MODE,\t\t\t0x003764),\n\tREG(QSYS_RES_CFG,\t\t\t0x004000),\n\tREG(QSYS_RES_STAT,\t\t\t0x004004),\n\tREG(QSYS_EGR_DROP_MODE,\t\t\t0x003768),\n\tREG(QSYS_EQ_CTRL,\t\t\t0x00376c),\n\tREG_RESERVED(QSYS_EVENTS_CORE),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_0),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_1),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_2),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_3),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_4),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_5),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_6),\n\tREG_RESERVED(QSYS_QMAXSDU_CFG_7),\n\tREG_RESERVED(QSYS_PREEMPTION_CFG),\n\tREG(QSYS_CIR_CFG,\t\t\t0x000000),\n\tREG_RESERVED(QSYS_EIR_CFG),\n\tREG(QSYS_SE_CFG,\t\t\t0x000008),\n\tREG(QSYS_SE_DWRR_CFG,\t\t\t0x00000c),\n\tREG_RESERVED(QSYS_SE_CONNECT),\n\tREG_RESERVED(QSYS_SE_DLB_SENSE),\n\tREG(QSYS_CIR_STATE,\t\t\t0x000044),\n\tREG_RESERVED(QSYS_EIR_STATE),\n\tREG_RESERVED(QSYS_SE_STATE),\n\tREG(QSYS_HSCH_MISC_CFG,\t\t\t0x003774),\n\tREG_RESERVED(QSYS_TAG_CONFIG),\n\tREG_RESERVED(QSYS_TAS_PARAM_CFG_CTRL),\n\tREG_RESERVED(QSYS_PORT_MAX_SDU),\n\tREG_RESERVED(QSYS_PARAM_CFG_REG_1),\n\tREG_RESERVED(QSYS_PARAM_CFG_REG_2),\n\tREG_RESERVED(QSYS_PARAM_CFG_REG_3),\n\tREG_RESERVED(QSYS_PARAM_CFG_REG_4),\n\tREG_RESERVED(QSYS_PARAM_CFG_REG_5),\n\tREG_RESERVED(QSYS_GCL_CFG_REG_1),\n\tREG_RESERVED(QSYS_GCL_CFG_REG_2),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_1),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_2),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_3),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_4),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_5),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_6),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_7),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_8),\n\tREG_RESERVED(QSYS_PARAM_STATUS_REG_9),\n\tREG_RESERVED(QSYS_GCL_STATUS_REG_1),\n\tREG_RESERVED(QSYS_GCL_STATUS_REG_2),\n};\n\nstatic const u32 vsc9953_rew_regmap[] = {\n\tREG(REW_PORT_VLAN_CFG,\t\t\t0x000000),\n\tREG(REW_TAG_CFG,\t\t\t0x000004),\n\tREG(REW_PORT_CFG,\t\t\t0x000008),\n\tREG(REW_DSCP_CFG,\t\t\t0x00000c),\n\tREG(REW_PCP_DEI_QOS_MAP_CFG,\t\t0x000010),\n\tREG_RESERVED(REW_PTP_CFG),\n\tREG_RESERVED(REW_PTP_DLY1_CFG),\n\tREG_RESERVED(REW_RED_TAG_CFG),\n\tREG(REW_DSCP_REMAP_DP1_CFG,\t\t0x000610),\n\tREG(REW_DSCP_REMAP_CFG,\t\t\t0x000710),\n\tREG_RESERVED(REW_STAT_CFG),\n\tREG_RESERVED(REW_REW_STICKY),\n\tREG_RESERVED(REW_PPT),\n};\n\nstatic const u32 vsc9953_sys_regmap[] = {\n\tREG(SYS_COUNT_RX_OCTETS,\t\t0x000000),\n\tREG(SYS_COUNT_RX_UNICAST,\t\t0x000004),\n\tREG(SYS_COUNT_RX_MULTICAST,\t\t0x000008),\n\tREG(SYS_COUNT_RX_BROADCAST,\t\t0x00000c),\n\tREG(SYS_COUNT_RX_SHORTS,\t\t0x000010),\n\tREG(SYS_COUNT_RX_FRAGMENTS,\t\t0x000014),\n\tREG(SYS_COUNT_RX_JABBERS,\t\t0x000018),\n\tREG(SYS_COUNT_RX_CRC_ALIGN_ERRS,\t0x00001c),\n\tREG(SYS_COUNT_RX_SYM_ERRS,\t\t0x000020),\n\tREG(SYS_COUNT_RX_64,\t\t\t0x000024),\n\tREG(SYS_COUNT_RX_65_127,\t\t0x000028),\n\tREG(SYS_COUNT_RX_128_255,\t\t0x00002c),\n\tREG(SYS_COUNT_RX_256_511,\t\t0x000030),\n\tREG(SYS_COUNT_RX_512_1023,\t\t0x000034),\n\tREG(SYS_COUNT_RX_1024_1526,\t\t0x000038),\n\tREG(SYS_COUNT_RX_1527_MAX,\t\t0x00003c),\n\tREG(SYS_COUNT_RX_PAUSE,\t\t\t0x000040),\n\tREG(SYS_COUNT_RX_CONTROL,\t\t0x000044),\n\tREG(SYS_COUNT_RX_LONGS,\t\t\t0x000048),\n\tREG(SYS_COUNT_RX_CLASSIFIED_DROPS,\t0x00004c),\n\tREG(SYS_COUNT_RX_RED_PRIO_0,\t\t0x000050),\n\tREG(SYS_COUNT_RX_RED_PRIO_1,\t\t0x000054),\n\tREG(SYS_COUNT_RX_RED_PRIO_2,\t\t0x000058),\n\tREG(SYS_COUNT_RX_RED_PRIO_3,\t\t0x00005c),\n\tREG(SYS_COUNT_RX_RED_PRIO_4,\t\t0x000060),\n\tREG(SYS_COUNT_RX_RED_PRIO_5,\t\t0x000064),\n\tREG(SYS_COUNT_RX_RED_PRIO_6,\t\t0x000068),\n\tREG(SYS_COUNT_RX_RED_PRIO_7,\t\t0x00006c),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_0,\t\t0x000070),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_1,\t\t0x000074),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_2,\t\t0x000078),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_3,\t\t0x00007c),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_4,\t\t0x000080),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_5,\t\t0x000084),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_6,\t\t0x000088),\n\tREG(SYS_COUNT_RX_YELLOW_PRIO_7,\t\t0x00008c),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_0,\t\t0x000090),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_1,\t\t0x000094),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_2,\t\t0x000098),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_3,\t\t0x00009c),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_4,\t\t0x0000a0),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_5,\t\t0x0000a4),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_6,\t\t0x0000a8),\n\tREG(SYS_COUNT_RX_GREEN_PRIO_7,\t\t0x0000ac),\n\tREG(SYS_COUNT_TX_OCTETS,\t\t0x000100),\n\tREG(SYS_COUNT_TX_UNICAST,\t\t0x000104),\n\tREG(SYS_COUNT_TX_MULTICAST,\t\t0x000108),\n\tREG(SYS_COUNT_TX_BROADCAST,\t\t0x00010c),\n\tREG(SYS_COUNT_TX_COLLISION,\t\t0x000110),\n\tREG(SYS_COUNT_TX_DROPS,\t\t\t0x000114),\n\tREG(SYS_COUNT_TX_PAUSE,\t\t\t0x000118),\n\tREG(SYS_COUNT_TX_64,\t\t\t0x00011c),\n\tREG(SYS_COUNT_TX_65_127,\t\t0x000120),\n\tREG(SYS_COUNT_TX_128_255,\t\t0x000124),\n\tREG(SYS_COUNT_TX_256_511,\t\t0x000128),\n\tREG(SYS_COUNT_TX_512_1023,\t\t0x00012c),\n\tREG(SYS_COUNT_TX_1024_1526,\t\t0x000130),\n\tREG(SYS_COUNT_TX_1527_MAX,\t\t0x000134),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_0,\t\t0x000138),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_1,\t\t0x00013c),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_2,\t\t0x000140),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_3,\t\t0x000144),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_4,\t\t0x000148),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_5,\t\t0x00014c),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_6,\t\t0x000150),\n\tREG(SYS_COUNT_TX_YELLOW_PRIO_7,\t\t0x000154),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_0,\t\t0x000158),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_1,\t\t0x00015c),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_2,\t\t0x000160),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_3,\t\t0x000164),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_4,\t\t0x000168),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_5,\t\t0x00016c),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_6,\t\t0x000170),\n\tREG(SYS_COUNT_TX_GREEN_PRIO_7,\t\t0x000174),\n\tREG(SYS_COUNT_TX_AGED,\t\t\t0x000178),\n\tREG(SYS_COUNT_DROP_LOCAL,\t\t0x000200),\n\tREG(SYS_COUNT_DROP_TAIL,\t\t0x000204),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_0,\t0x000208),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_1,\t0x00020c),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_2,\t0x000210),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_3,\t0x000214),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_4,\t0x000218),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_5,\t0x00021c),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_6,\t0x000220),\n\tREG(SYS_COUNT_DROP_YELLOW_PRIO_7,\t0x000224),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_0,\t0x000228),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_1,\t0x00022c),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_2,\t0x000230),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_3,\t0x000234),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_4,\t0x000238),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_5,\t0x00023c),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_6,\t0x000240),\n\tREG(SYS_COUNT_DROP_GREEN_PRIO_7,\t0x000244),\n\tREG(SYS_RESET_CFG,\t\t\t0x000318),\n\tREG_RESERVED(SYS_SR_ETYPE_CFG),\n\tREG(SYS_VLAN_ETYPE_CFG,\t\t\t0x000320),\n\tREG(SYS_PORT_MODE,\t\t\t0x000324),\n\tREG(SYS_FRONT_PORT_MODE,\t\t0x000354),\n\tREG(SYS_FRM_AGING,\t\t\t0x00037c),\n\tREG(SYS_STAT_CFG,\t\t\t0x000380),\n\tREG_RESERVED(SYS_SW_STATUS),\n\tREG_RESERVED(SYS_MISC_CFG),\n\tREG_RESERVED(SYS_REW_MAC_HIGH_CFG),\n\tREG_RESERVED(SYS_REW_MAC_LOW_CFG),\n\tREG_RESERVED(SYS_TIMESTAMP_OFFSET),\n\tREG(SYS_PAUSE_CFG,\t\t\t0x00044c),\n\tREG(SYS_PAUSE_TOT_CFG,\t\t\t0x000478),\n\tREG(SYS_ATOP,\t\t\t\t0x00047c),\n\tREG(SYS_ATOP_TOT_CFG,\t\t\t0x0004a8),\n\tREG(SYS_MAC_FC_CFG,\t\t\t0x0004ac),\n\tREG(SYS_MMGT,\t\t\t\t0x0004d4),\n\tREG_RESERVED(SYS_MMGT_FAST),\n\tREG_RESERVED(SYS_EVENTS_DIF),\n\tREG_RESERVED(SYS_EVENTS_CORE),\n\tREG_RESERVED(SYS_PTP_STATUS),\n\tREG_RESERVED(SYS_PTP_TXSTAMP),\n\tREG_RESERVED(SYS_PTP_NXT),\n\tREG_RESERVED(SYS_PTP_CFG),\n\tREG_RESERVED(SYS_RAM_INIT),\n\tREG_RESERVED(SYS_CM_ADDR),\n\tREG_RESERVED(SYS_CM_DATA_WR),\n\tREG_RESERVED(SYS_CM_DATA_RD),\n\tREG_RESERVED(SYS_CM_OP),\n\tREG_RESERVED(SYS_CM_DATA),\n};\n\nstatic const u32 vsc9953_gcb_regmap[] = {\n\tREG(GCB_SOFT_RST,\t\t\t0x000008),\n\tREG(GCB_MIIM_MII_STATUS,\t\t0x0000ac),\n\tREG(GCB_MIIM_MII_CMD,\t\t\t0x0000b4),\n\tREG(GCB_MIIM_MII_DATA,\t\t\t0x0000b8),\n};\n\nstatic const u32 vsc9953_dev_gmii_regmap[] = {\n\tREG(DEV_CLOCK_CFG,\t\t\t0x0),\n\tREG(DEV_PORT_MISC,\t\t\t0x4),\n\tREG_RESERVED(DEV_EVENTS),\n\tREG(DEV_EEE_CFG,\t\t\t0xc),\n\tREG_RESERVED(DEV_RX_PATH_DELAY),\n\tREG_RESERVED(DEV_TX_PATH_DELAY),\n\tREG_RESERVED(DEV_PTP_PREDICT_CFG),\n\tREG(DEV_MAC_ENA_CFG,\t\t\t0x10),\n\tREG(DEV_MAC_MODE_CFG,\t\t\t0x14),\n\tREG(DEV_MAC_MAXLEN_CFG,\t\t\t0x18),\n\tREG(DEV_MAC_TAGS_CFG,\t\t\t0x1c),\n\tREG(DEV_MAC_ADV_CHK_CFG,\t\t0x20),\n\tREG(DEV_MAC_IFG_CFG,\t\t\t0x24),\n\tREG(DEV_MAC_HDX_CFG,\t\t\t0x28),\n\tREG_RESERVED(DEV_MAC_DBG_CFG),\n\tREG(DEV_MAC_FC_MAC_LOW_CFG,\t\t0x30),\n\tREG(DEV_MAC_FC_MAC_HIGH_CFG,\t\t0x34),\n\tREG(DEV_MAC_STICKY,\t\t\t0x38),\n\tREG_RESERVED(PCS1G_CFG),\n\tREG_RESERVED(PCS1G_MODE_CFG),\n\tREG_RESERVED(PCS1G_SD_CFG),\n\tREG_RESERVED(PCS1G_ANEG_CFG),\n\tREG_RESERVED(PCS1G_ANEG_NP_CFG),\n\tREG_RESERVED(PCS1G_LB_CFG),\n\tREG_RESERVED(PCS1G_DBG_CFG),\n\tREG_RESERVED(PCS1G_CDET_CFG),\n\tREG_RESERVED(PCS1G_ANEG_STATUS),\n\tREG_RESERVED(PCS1G_ANEG_NP_STATUS),\n\tREG_RESERVED(PCS1G_LINK_STATUS),\n\tREG_RESERVED(PCS1G_LINK_DOWN_CNT),\n\tREG_RESERVED(PCS1G_STICKY),\n\tREG_RESERVED(PCS1G_DEBUG_STATUS),\n\tREG_RESERVED(PCS1G_LPI_CFG),\n\tREG_RESERVED(PCS1G_LPI_WAKE_ERROR_CNT),\n\tREG_RESERVED(PCS1G_LPI_STATUS),\n\tREG_RESERVED(PCS1G_TSTPAT_MODE_CFG),\n\tREG_RESERVED(PCS1G_TSTPAT_STATUS),\n\tREG_RESERVED(DEV_PCS_FX100_CFG),\n\tREG_RESERVED(DEV_PCS_FX100_STATUS),\n};\n\nstatic const u32 *vsc9953_regmap[TARGET_MAX] = {\n\t[ANA]\t\t= vsc9953_ana_regmap,\n\t[QS]\t\t= vsc9953_qs_regmap,\n\t[QSYS]\t\t= vsc9953_qsys_regmap,\n\t[REW]\t\t= vsc9953_rew_regmap,\n\t[SYS]\t\t= vsc9953_sys_regmap,\n\t[S0]\t\t= vsc9953_vcap_regmap,\n\t[S1]\t\t= vsc9953_vcap_regmap,\n\t[S2]\t\t= vsc9953_vcap_regmap,\n\t[GCB]\t\t= vsc9953_gcb_regmap,\n\t[DEV_GMII]\t= vsc9953_dev_gmii_regmap,\n};\n\n \nstatic const struct resource vsc9953_resources[] = {\n\tDEFINE_RES_MEM_NAMED(0x0010000, 0x0010000, \"sys\"),\n\tDEFINE_RES_MEM_NAMED(0x0030000, 0x0010000, \"rew\"),\n\tDEFINE_RES_MEM_NAMED(0x0040000, 0x0000400, \"s0\"),\n\tDEFINE_RES_MEM_NAMED(0x0050000, 0x0000400, \"s1\"),\n\tDEFINE_RES_MEM_NAMED(0x0060000, 0x0000400, \"s2\"),\n\tDEFINE_RES_MEM_NAMED(0x0070000, 0x0000200, \"devcpu_gcb\"),\n\tDEFINE_RES_MEM_NAMED(0x0080000, 0x0000100, \"qs\"),\n\tDEFINE_RES_MEM_NAMED(0x0090000, 0x00000cc, \"ptp\"),\n\tDEFINE_RES_MEM_NAMED(0x0100000, 0x0010000, \"port0\"),\n\tDEFINE_RES_MEM_NAMED(0x0110000, 0x0010000, \"port1\"),\n\tDEFINE_RES_MEM_NAMED(0x0120000, 0x0010000, \"port2\"),\n\tDEFINE_RES_MEM_NAMED(0x0130000, 0x0010000, \"port3\"),\n\tDEFINE_RES_MEM_NAMED(0x0140000, 0x0010000, \"port4\"),\n\tDEFINE_RES_MEM_NAMED(0x0150000, 0x0010000, \"port5\"),\n\tDEFINE_RES_MEM_NAMED(0x0160000, 0x0010000, \"port6\"),\n\tDEFINE_RES_MEM_NAMED(0x0170000, 0x0010000, \"port7\"),\n\tDEFINE_RES_MEM_NAMED(0x0180000, 0x0010000, \"port8\"),\n\tDEFINE_RES_MEM_NAMED(0x0190000, 0x0010000, \"port9\"),\n\tDEFINE_RES_MEM_NAMED(0x0200000, 0x0020000, \"qsys\"),\n\tDEFINE_RES_MEM_NAMED(0x0280000, 0x0010000, \"ana\"),\n};\n\nstatic const char * const vsc9953_resource_names[TARGET_MAX] = {\n\t[SYS] = \"sys\",\n\t[REW] = \"rew\",\n\t[S0] = \"s0\",\n\t[S1] = \"s1\",\n\t[S2] = \"s2\",\n\t[GCB] = \"devcpu_gcb\",\n\t[QS] = \"qs\",\n\t[PTP] = \"ptp\",\n\t[QSYS] = \"qsys\",\n\t[ANA] = \"ana\",\n};\n\nstatic const struct reg_field vsc9953_regfields[REGFIELD_MAX] = {\n\t[ANA_ADVLEARN_VLAN_CHK] = REG_FIELD(ANA_ADVLEARN, 10, 10),\n\t[ANA_ADVLEARN_LEARN_MIRROR] = REG_FIELD(ANA_ADVLEARN, 0, 9),\n\t[ANA_ANEVENTS_AUTOAGE] = REG_FIELD(ANA_ANEVENTS, 24, 24),\n\t[ANA_ANEVENTS_STORM_DROP] = REG_FIELD(ANA_ANEVENTS, 22, 22),\n\t[ANA_ANEVENTS_LEARN_DROP] = REG_FIELD(ANA_ANEVENTS, 21, 21),\n\t[ANA_ANEVENTS_AGED_ENTRY] = REG_FIELD(ANA_ANEVENTS, 20, 20),\n\t[ANA_ANEVENTS_CPU_LEARN_FAILED] = REG_FIELD(ANA_ANEVENTS, 19, 19),\n\t[ANA_ANEVENTS_AUTO_LEARN_FAILED] = REG_FIELD(ANA_ANEVENTS, 18, 18),\n\t[ANA_ANEVENTS_LEARN_REMOVE] = REG_FIELD(ANA_ANEVENTS, 17, 17),\n\t[ANA_ANEVENTS_AUTO_LEARNED] = REG_FIELD(ANA_ANEVENTS, 16, 16),\n\t[ANA_ANEVENTS_AUTO_MOVED] = REG_FIELD(ANA_ANEVENTS, 15, 15),\n\t[ANA_ANEVENTS_CLASSIFIED_DROP] = REG_FIELD(ANA_ANEVENTS, 13, 13),\n\t[ANA_ANEVENTS_CLASSIFIED_COPY] = REG_FIELD(ANA_ANEVENTS, 12, 12),\n\t[ANA_ANEVENTS_VLAN_DISCARD] = REG_FIELD(ANA_ANEVENTS, 11, 11),\n\t[ANA_ANEVENTS_FWD_DISCARD] = REG_FIELD(ANA_ANEVENTS, 10, 10),\n\t[ANA_ANEVENTS_MULTICAST_FLOOD] = REG_FIELD(ANA_ANEVENTS, 9, 9),\n\t[ANA_ANEVENTS_UNICAST_FLOOD] = REG_FIELD(ANA_ANEVENTS, 8, 8),\n\t[ANA_ANEVENTS_DEST_KNOWN] = REG_FIELD(ANA_ANEVENTS, 7, 7),\n\t[ANA_ANEVENTS_BUCKET3_MATCH] = REG_FIELD(ANA_ANEVENTS, 6, 6),\n\t[ANA_ANEVENTS_BUCKET2_MATCH] = REG_FIELD(ANA_ANEVENTS, 5, 5),\n\t[ANA_ANEVENTS_BUCKET1_MATCH] = REG_FIELD(ANA_ANEVENTS, 4, 4),\n\t[ANA_ANEVENTS_BUCKET0_MATCH] = REG_FIELD(ANA_ANEVENTS, 3, 3),\n\t[ANA_ANEVENTS_CPU_OPERATION] = REG_FIELD(ANA_ANEVENTS, 2, 2),\n\t[ANA_ANEVENTS_DMAC_LOOKUP] = REG_FIELD(ANA_ANEVENTS, 1, 1),\n\t[ANA_ANEVENTS_SMAC_LOOKUP] = REG_FIELD(ANA_ANEVENTS, 0, 0),\n\t[ANA_TABLES_MACACCESS_B_DOM] = REG_FIELD(ANA_TABLES_MACACCESS, 16, 16),\n\t[ANA_TABLES_MACTINDX_BUCKET] = REG_FIELD(ANA_TABLES_MACTINDX, 11, 12),\n\t[ANA_TABLES_MACTINDX_M_INDEX] = REG_FIELD(ANA_TABLES_MACTINDX, 0, 10),\n\t[SYS_RESET_CFG_CORE_ENA] = REG_FIELD(SYS_RESET_CFG, 7, 7),\n\t[SYS_RESET_CFG_MEM_ENA] = REG_FIELD(SYS_RESET_CFG, 6, 6),\n\t[SYS_RESET_CFG_MEM_INIT] = REG_FIELD(SYS_RESET_CFG, 5, 5),\n\t[GCB_SOFT_RST_SWC_RST] = REG_FIELD(GCB_SOFT_RST, 0, 0),\n\t[GCB_MIIM_MII_STATUS_PENDING] = REG_FIELD(GCB_MIIM_MII_STATUS, 2, 2),\n\t[GCB_MIIM_MII_STATUS_BUSY] = REG_FIELD(GCB_MIIM_MII_STATUS, 3, 3),\n\t \n\t[QSYS_SWITCH_PORT_MODE_PORT_ENA] = REG_FIELD_ID(QSYS_SWITCH_PORT_MODE, 13, 13, 11, 4),\n\t[QSYS_SWITCH_PORT_MODE_YEL_RSRVD] = REG_FIELD_ID(QSYS_SWITCH_PORT_MODE, 10, 10, 11, 4),\n\t[QSYS_SWITCH_PORT_MODE_INGRESS_DROP_MODE] = REG_FIELD_ID(QSYS_SWITCH_PORT_MODE, 9, 9, 11, 4),\n\t[QSYS_SWITCH_PORT_MODE_TX_PFC_ENA] = REG_FIELD_ID(QSYS_SWITCH_PORT_MODE, 1, 8, 11, 4),\n\t[QSYS_SWITCH_PORT_MODE_TX_PFC_MODE] = REG_FIELD_ID(QSYS_SWITCH_PORT_MODE, 0, 0, 11, 4),\n\t[SYS_PORT_MODE_INCL_INJ_HDR] = REG_FIELD_ID(SYS_PORT_MODE, 4, 5, 11, 4),\n\t[SYS_PORT_MODE_INCL_XTR_HDR] = REG_FIELD_ID(SYS_PORT_MODE, 2, 3, 11, 4),\n\t[SYS_PORT_MODE_INCL_HDR_ERR] = REG_FIELD_ID(SYS_PORT_MODE, 0, 0, 11, 4),\n\t[SYS_PAUSE_CFG_PAUSE_START] = REG_FIELD_ID(SYS_PAUSE_CFG, 11, 20, 11, 4),\n\t[SYS_PAUSE_CFG_PAUSE_STOP] = REG_FIELD_ID(SYS_PAUSE_CFG, 1, 10, 11, 4),\n\t[SYS_PAUSE_CFG_PAUSE_ENA] = REG_FIELD_ID(SYS_PAUSE_CFG, 0, 1, 11, 4),\n};\n\nstatic const struct vcap_field vsc9953_vcap_es0_keys[] = {\n\t[VCAP_ES0_EGR_PORT]\t\t\t= {  0,  4},\n\t[VCAP_ES0_IGR_PORT]\t\t\t= {  4,  4},\n\t[VCAP_ES0_RSV]\t\t\t\t= {  8,  2},\n\t[VCAP_ES0_L2_MC]\t\t\t= { 10,  1},\n\t[VCAP_ES0_L2_BC]\t\t\t= { 11,  1},\n\t[VCAP_ES0_VID]\t\t\t\t= { 12, 12},\n\t[VCAP_ES0_DP]\t\t\t\t= { 24,  1},\n\t[VCAP_ES0_PCP]\t\t\t\t= { 25,  3},\n};\n\nstatic const struct vcap_field vsc9953_vcap_es0_actions[] = {\n\t[VCAP_ES0_ACT_PUSH_OUTER_TAG]\t\t= {  0,  2},\n\t[VCAP_ES0_ACT_PUSH_INNER_TAG]\t\t= {  2,  1},\n\t[VCAP_ES0_ACT_TAG_A_TPID_SEL]\t\t= {  3,  2},\n\t[VCAP_ES0_ACT_TAG_A_VID_SEL]\t\t= {  5,  1},\n\t[VCAP_ES0_ACT_TAG_A_PCP_SEL]\t\t= {  6,  2},\n\t[VCAP_ES0_ACT_TAG_A_DEI_SEL]\t\t= {  8,  2},\n\t[VCAP_ES0_ACT_TAG_B_TPID_SEL]\t\t= { 10,  2},\n\t[VCAP_ES0_ACT_TAG_B_VID_SEL]\t\t= { 12,  1},\n\t[VCAP_ES0_ACT_TAG_B_PCP_SEL]\t\t= { 13,  2},\n\t[VCAP_ES0_ACT_TAG_B_DEI_SEL]\t\t= { 15,  2},\n\t[VCAP_ES0_ACT_VID_A_VAL]\t\t= { 17, 12},\n\t[VCAP_ES0_ACT_PCP_A_VAL]\t\t= { 29,  3},\n\t[VCAP_ES0_ACT_DEI_A_VAL]\t\t= { 32,  1},\n\t[VCAP_ES0_ACT_VID_B_VAL]\t\t= { 33, 12},\n\t[VCAP_ES0_ACT_PCP_B_VAL]\t\t= { 45,  3},\n\t[VCAP_ES0_ACT_DEI_B_VAL]\t\t= { 48,  1},\n\t[VCAP_ES0_ACT_RSV]\t\t\t= { 49, 24},\n\t[VCAP_ES0_ACT_HIT_STICKY]\t\t= { 73,  1},\n};\n\nstatic const struct vcap_field vsc9953_vcap_is1_keys[] = {\n\t[VCAP_IS1_HK_TYPE]\t\t\t= {  0,   1},\n\t[VCAP_IS1_HK_LOOKUP]\t\t\t= {  1,   2},\n\t[VCAP_IS1_HK_IGR_PORT_MASK]\t\t= {  3,  11},\n\t[VCAP_IS1_HK_RSV]\t\t\t= { 14,  10},\n\t \n\t[VCAP_IS1_HK_L2_MC]\t\t\t= { 24,   1},\n\t[VCAP_IS1_HK_L2_BC]\t\t\t= { 25,   1},\n\t[VCAP_IS1_HK_IP_MC]\t\t\t= { 26,   1},\n\t[VCAP_IS1_HK_VLAN_TAGGED]\t\t= { 27,   1},\n\t[VCAP_IS1_HK_VLAN_DBL_TAGGED]\t\t= { 28,   1},\n\t[VCAP_IS1_HK_TPID]\t\t\t= { 29,   1},\n\t[VCAP_IS1_HK_VID]\t\t\t= { 30,  12},\n\t[VCAP_IS1_HK_DEI]\t\t\t= { 42,   1},\n\t[VCAP_IS1_HK_PCP]\t\t\t= { 43,   3},\n\t \n\t[VCAP_IS1_HK_L2_SMAC]\t\t\t= { 46,  48},\n\t[VCAP_IS1_HK_ETYPE_LEN]\t\t\t= { 94,   1},\n\t[VCAP_IS1_HK_ETYPE]\t\t\t= { 95,  16},\n\t[VCAP_IS1_HK_IP_SNAP]\t\t\t= {111,   1},\n\t[VCAP_IS1_HK_IP4]\t\t\t= {112,   1},\n\t \n\t[VCAP_IS1_HK_L3_FRAGMENT]\t\t= {113,   1},\n\t[VCAP_IS1_HK_L3_FRAG_OFS_GT0]\t\t= {114,   1},\n\t[VCAP_IS1_HK_L3_OPTIONS]\t\t= {115,   1},\n\t[VCAP_IS1_HK_L3_DSCP]\t\t\t= {116,   6},\n\t[VCAP_IS1_HK_L3_IP4_SIP]\t\t= {122,  32},\n\t \n\t[VCAP_IS1_HK_TCP_UDP]\t\t\t= {154,   1},\n\t[VCAP_IS1_HK_TCP]\t\t\t= {155,   1},\n\t[VCAP_IS1_HK_L4_SPORT]\t\t\t= {156,  16},\n\t[VCAP_IS1_HK_L4_RNG]\t\t\t= {172,   8},\n\t \n\t[VCAP_IS1_HK_IP4_INNER_TPID]            = { 46,   1},\n\t[VCAP_IS1_HK_IP4_INNER_VID]\t\t= { 47,  12},\n\t[VCAP_IS1_HK_IP4_INNER_DEI]\t\t= { 59,   1},\n\t[VCAP_IS1_HK_IP4_INNER_PCP]\t\t= { 60,   3},\n\t[VCAP_IS1_HK_IP4_IP4]\t\t\t= { 63,   1},\n\t[VCAP_IS1_HK_IP4_L3_FRAGMENT]\t\t= { 64,   1},\n\t[VCAP_IS1_HK_IP4_L3_FRAG_OFS_GT0]\t= { 65,   1},\n\t[VCAP_IS1_HK_IP4_L3_OPTIONS]\t\t= { 66,   1},\n\t[VCAP_IS1_HK_IP4_L3_DSCP]\t\t= { 67,   6},\n\t[VCAP_IS1_HK_IP4_L3_IP4_DIP]\t\t= { 73,  32},\n\t[VCAP_IS1_HK_IP4_L3_IP4_SIP]\t\t= {105,  32},\n\t[VCAP_IS1_HK_IP4_L3_PROTO]\t\t= {137,   8},\n\t[VCAP_IS1_HK_IP4_TCP_UDP]\t\t= {145,   1},\n\t[VCAP_IS1_HK_IP4_TCP]\t\t\t= {146,   1},\n\t[VCAP_IS1_HK_IP4_L4_RNG]\t\t= {147,   8},\n\t[VCAP_IS1_HK_IP4_IP_PAYLOAD_S1_5TUPLE]\t= {155,  32},\n};\n\nstatic const struct vcap_field vsc9953_vcap_is1_actions[] = {\n\t[VCAP_IS1_ACT_DSCP_ENA]\t\t\t= {  0,  1},\n\t[VCAP_IS1_ACT_DSCP_VAL]\t\t\t= {  1,  6},\n\t[VCAP_IS1_ACT_QOS_ENA]\t\t\t= {  7,  1},\n\t[VCAP_IS1_ACT_QOS_VAL]\t\t\t= {  8,  3},\n\t[VCAP_IS1_ACT_DP_ENA]\t\t\t= { 11,  1},\n\t[VCAP_IS1_ACT_DP_VAL]\t\t\t= { 12,  1},\n\t[VCAP_IS1_ACT_PAG_OVERRIDE_MASK]\t= { 13,  8},\n\t[VCAP_IS1_ACT_PAG_VAL]\t\t\t= { 21,  8},\n\t[VCAP_IS1_ACT_RSV]\t\t\t= { 29, 11},\n\t[VCAP_IS1_ACT_VID_REPLACE_ENA]\t\t= { 40,  1},\n\t[VCAP_IS1_ACT_VID_ADD_VAL]\t\t= { 41, 12},\n\t[VCAP_IS1_ACT_FID_SEL]\t\t\t= { 53,  2},\n\t[VCAP_IS1_ACT_FID_VAL]\t\t\t= { 55, 13},\n\t[VCAP_IS1_ACT_PCP_DEI_ENA]\t\t= { 68,  1},\n\t[VCAP_IS1_ACT_PCP_VAL]\t\t\t= { 69,  3},\n\t[VCAP_IS1_ACT_DEI_VAL]\t\t\t= { 72,  1},\n\t[VCAP_IS1_ACT_VLAN_POP_CNT_ENA]\t\t= { 73,  1},\n\t[VCAP_IS1_ACT_VLAN_POP_CNT]\t\t= { 74,  2},\n\t[VCAP_IS1_ACT_CUSTOM_ACE_TYPE_ENA]\t= { 76,  4},\n\t[VCAP_IS1_ACT_HIT_STICKY]\t\t= { 80,  1},\n};\n\nstatic struct vcap_field vsc9953_vcap_is2_keys[] = {\n\t \n\t[VCAP_IS2_TYPE]\t\t\t\t= {  0,   4},\n\t[VCAP_IS2_HK_FIRST]\t\t\t= {  4,   1},\n\t[VCAP_IS2_HK_PAG]\t\t\t= {  5,   8},\n\t[VCAP_IS2_HK_IGR_PORT_MASK]\t\t= { 13,  11},\n\t[VCAP_IS2_HK_RSV2]\t\t\t= { 24,   1},\n\t[VCAP_IS2_HK_HOST_MATCH]\t\t= { 25,   1},\n\t[VCAP_IS2_HK_L2_MC]\t\t\t= { 26,   1},\n\t[VCAP_IS2_HK_L2_BC]\t\t\t= { 27,   1},\n\t[VCAP_IS2_HK_VLAN_TAGGED]\t\t= { 28,   1},\n\t[VCAP_IS2_HK_VID]\t\t\t= { 29,  12},\n\t[VCAP_IS2_HK_DEI]\t\t\t= { 41,   1},\n\t[VCAP_IS2_HK_PCP]\t\t\t= { 42,   3},\n\t \n\t[VCAP_IS2_HK_L2_DMAC]\t\t\t= { 45,  48},\n\t[VCAP_IS2_HK_L2_SMAC]\t\t\t= { 93,  48},\n\t \n\t[VCAP_IS2_HK_MAC_ETYPE_ETYPE]\t\t= {141,  16},\n\t[VCAP_IS2_HK_MAC_ETYPE_L2_PAYLOAD0]\t= {157,  16},\n\t[VCAP_IS2_HK_MAC_ETYPE_L2_PAYLOAD1]\t= {173,   8},\n\t[VCAP_IS2_HK_MAC_ETYPE_L2_PAYLOAD2]\t= {181,   3},\n\t \n\t[VCAP_IS2_HK_MAC_LLC_L2_LLC]\t\t= {141,  40},\n\t \n\t[VCAP_IS2_HK_MAC_SNAP_L2_SNAP]\t\t= {141,  40},\n\t \n\t[VCAP_IS2_HK_MAC_ARP_SMAC]\t\t= { 45,  48},\n\t[VCAP_IS2_HK_MAC_ARP_ADDR_SPACE_OK]\t= { 93,   1},\n\t[VCAP_IS2_HK_MAC_ARP_PROTO_SPACE_OK]\t= { 94,   1},\n\t[VCAP_IS2_HK_MAC_ARP_LEN_OK]\t\t= { 95,   1},\n\t[VCAP_IS2_HK_MAC_ARP_TARGET_MATCH]\t= { 96,   1},\n\t[VCAP_IS2_HK_MAC_ARP_SENDER_MATCH]\t= { 97,   1},\n\t[VCAP_IS2_HK_MAC_ARP_OPCODE_UNKNOWN]\t= { 98,   1},\n\t[VCAP_IS2_HK_MAC_ARP_OPCODE]\t\t= { 99,   2},\n\t[VCAP_IS2_HK_MAC_ARP_L3_IP4_DIP]\t= {101,  32},\n\t[VCAP_IS2_HK_MAC_ARP_L3_IP4_SIP]\t= {133,  32},\n\t[VCAP_IS2_HK_MAC_ARP_DIP_EQ_SIP]\t= {165,   1},\n\t \n\t[VCAP_IS2_HK_IP4]\t\t\t= { 45,   1},\n\t[VCAP_IS2_HK_L3_FRAGMENT]\t\t= { 46,   1},\n\t[VCAP_IS2_HK_L3_FRAG_OFS_GT0]\t\t= { 47,   1},\n\t[VCAP_IS2_HK_L3_OPTIONS]\t\t= { 48,   1},\n\t[VCAP_IS2_HK_IP4_L3_TTL_GT0]\t\t= { 49,   1},\n\t[VCAP_IS2_HK_L3_TOS]\t\t\t= { 50,   8},\n\t[VCAP_IS2_HK_L3_IP4_DIP]\t\t= { 58,  32},\n\t[VCAP_IS2_HK_L3_IP4_SIP]\t\t= { 90,  32},\n\t[VCAP_IS2_HK_DIP_EQ_SIP]\t\t= {122,   1},\n\t \n\t[VCAP_IS2_HK_TCP]\t\t\t= {123,   1},\n\t[VCAP_IS2_HK_L4_DPORT]\t\t\t= {124,  16},\n\t[VCAP_IS2_HK_L4_SPORT]\t\t\t= {140,  16},\n\t[VCAP_IS2_HK_L4_RNG]\t\t\t= {156,   8},\n\t[VCAP_IS2_HK_L4_SPORT_EQ_DPORT]\t\t= {164,   1},\n\t[VCAP_IS2_HK_L4_SEQUENCE_EQ0]\t\t= {165,   1},\n\t[VCAP_IS2_HK_L4_FIN]\t\t\t= {166,   1},\n\t[VCAP_IS2_HK_L4_SYN]\t\t\t= {167,   1},\n\t[VCAP_IS2_HK_L4_RST]\t\t\t= {168,   1},\n\t[VCAP_IS2_HK_L4_PSH]\t\t\t= {169,   1},\n\t[VCAP_IS2_HK_L4_ACK]\t\t\t= {170,   1},\n\t[VCAP_IS2_HK_L4_URG]\t\t\t= {171,   1},\n\t \n\t[VCAP_IS2_HK_IP4_L3_PROTO]\t\t= {123,   8},\n\t[VCAP_IS2_HK_L3_PAYLOAD]\t\t= {131,  56},\n\t \n\t[VCAP_IS2_HK_IP6_L3_TTL_GT0]\t\t= { 45,   1},\n\t[VCAP_IS2_HK_L3_IP6_SIP]\t\t= { 46, 128},\n\t[VCAP_IS2_HK_IP6_L3_PROTO]\t\t= {174,   8},\n};\n\nstatic struct vcap_field vsc9953_vcap_is2_actions[] = {\n\t[VCAP_IS2_ACT_HIT_ME_ONCE]\t\t= {  0,  1},\n\t[VCAP_IS2_ACT_CPU_COPY_ENA]\t\t= {  1,  1},\n\t[VCAP_IS2_ACT_CPU_QU_NUM]\t\t= {  2,  3},\n\t[VCAP_IS2_ACT_MASK_MODE]\t\t= {  5,  2},\n\t[VCAP_IS2_ACT_MIRROR_ENA]\t\t= {  7,  1},\n\t[VCAP_IS2_ACT_LRN_DIS]\t\t\t= {  8,  1},\n\t[VCAP_IS2_ACT_POLICE_ENA]\t\t= {  9,  1},\n\t[VCAP_IS2_ACT_POLICE_IDX]\t\t= { 10,  8},\n\t[VCAP_IS2_ACT_POLICE_VCAP_ONLY]\t\t= { 21,  1},\n\t[VCAP_IS2_ACT_PORT_MASK]\t\t= { 22, 10},\n\t[VCAP_IS2_ACT_ACL_ID]\t\t\t= { 44,  6},\n\t[VCAP_IS2_ACT_HIT_CNT]\t\t\t= { 50, 32},\n};\n\nstatic struct vcap_props vsc9953_vcap_props[] = {\n\t[VCAP_ES0] = {\n\t\t.action_type_width = 0,\n\t\t.action_table = {\n\t\t\t[ES0_ACTION_TYPE_NORMAL] = {\n\t\t\t\t.width = 73,  \n\t\t\t\t.count = 1,\n\t\t\t},\n\t\t},\n\t\t.target = S0,\n\t\t.keys = vsc9953_vcap_es0_keys,\n\t\t.actions = vsc9953_vcap_es0_actions,\n\t},\n\t[VCAP_IS1] = {\n\t\t.action_type_width = 0,\n\t\t.action_table = {\n\t\t\t[IS1_ACTION_TYPE_NORMAL] = {\n\t\t\t\t.width = 80,  \n\t\t\t\t.count = 4,\n\t\t\t},\n\t\t},\n\t\t.target = S1,\n\t\t.keys = vsc9953_vcap_is1_keys,\n\t\t.actions = vsc9953_vcap_is1_actions,\n\t},\n\t[VCAP_IS2] = {\n\t\t.action_type_width = 1,\n\t\t.action_table = {\n\t\t\t[IS2_ACTION_TYPE_NORMAL] = {\n\t\t\t\t.width = 50,  \n\t\t\t\t.count = 2\n\t\t\t},\n\t\t\t[IS2_ACTION_TYPE_SMAC_SIP] = {\n\t\t\t\t.width = 6,\n\t\t\t\t.count = 4\n\t\t\t},\n\t\t},\n\t\t.target = S2,\n\t\t.keys = vsc9953_vcap_is2_keys,\n\t\t.actions = vsc9953_vcap_is2_actions,\n\t},\n};\n\n#define VSC9953_INIT_TIMEOUT\t\t\t50000\n#define VSC9953_GCB_RST_SLEEP\t\t\t100\n#define VSC9953_SYS_RAMINIT_SLEEP\t\t80\n\nstatic int vsc9953_gcb_soft_rst_status(struct ocelot *ocelot)\n{\n\tint val;\n\n\tocelot_field_read(ocelot, GCB_SOFT_RST_SWC_RST, &val);\n\n\treturn val;\n}\n\nstatic int vsc9953_sys_ram_init_status(struct ocelot *ocelot)\n{\n\tint val;\n\n\tocelot_field_read(ocelot, SYS_RESET_CFG_MEM_INIT, &val);\n\n\treturn val;\n}\n\n\n \nstatic int vsc9953_reset(struct ocelot *ocelot)\n{\n\tint val, err;\n\n\t \n\tocelot_field_write(ocelot, GCB_SOFT_RST_SWC_RST, 1);\n\n\terr = readx_poll_timeout(vsc9953_gcb_soft_rst_status, ocelot, val, !val,\n\t\t\t\t VSC9953_GCB_RST_SLEEP, VSC9953_INIT_TIMEOUT);\n\tif (err) {\n\t\tdev_err(ocelot->dev, \"timeout: switch core reset\\n\");\n\t\treturn err;\n\t}\n\n\t \n\tocelot_field_write(ocelot, SYS_RESET_CFG_MEM_ENA, 1);\n\tocelot_field_write(ocelot, SYS_RESET_CFG_MEM_INIT, 1);\n\n\terr = readx_poll_timeout(vsc9953_sys_ram_init_status, ocelot, val, !val,\n\t\t\t\t VSC9953_SYS_RAMINIT_SLEEP,\n\t\t\t\t VSC9953_INIT_TIMEOUT);\n\tif (err) {\n\t\tdev_err(ocelot->dev, \"timeout: switch sram init\\n\");\n\t\treturn err;\n\t}\n\n\t \n\tocelot_field_write(ocelot, SYS_RESET_CFG_CORE_ENA, 1);\n\n\treturn 0;\n}\n\n \nstatic u16 vsc9953_wm_enc(u16 value)\n{\n\tWARN_ON(value >= 16 * BIT(9));\n\n\tif (value >= BIT(9))\n\t\treturn BIT(9) | (value / 16);\n\n\treturn value;\n}\n\nstatic u16 vsc9953_wm_dec(u16 wm)\n{\n\tWARN_ON(wm & ~GENMASK(9, 0));\n\n\tif (wm & BIT(9))\n\t\treturn (wm & GENMASK(8, 0)) * 16;\n\n\treturn wm;\n}\n\nstatic void vsc9953_wm_stat(u32 val, u32 *inuse, u32 *maxuse)\n{\n\t*inuse = (val & GENMASK(25, 13)) >> 13;\n\t*maxuse = val & GENMASK(12, 0);\n}\n\nstatic const struct ocelot_ops vsc9953_ops = {\n\t.reset\t\t\t= vsc9953_reset,\n\t.wm_enc\t\t\t= vsc9953_wm_enc,\n\t.wm_dec\t\t\t= vsc9953_wm_dec,\n\t.wm_stat\t\t= vsc9953_wm_stat,\n\t.port_to_netdev\t\t= felix_port_to_netdev,\n\t.netdev_to_port\t\t= felix_netdev_to_port,\n};\n\nstatic int vsc9953_mdio_bus_alloc(struct ocelot *ocelot)\n{\n\tstruct felix *felix = ocelot_to_felix(ocelot);\n\tstruct device *dev = ocelot->dev;\n\tstruct mii_bus *bus;\n\tint port;\n\tint rc;\n\n\tfelix->pcs = devm_kcalloc(dev, felix->info->num_ports,\n\t\t\t\t  sizeof(struct phylink_pcs *),\n\t\t\t\t  GFP_KERNEL);\n\tif (!felix->pcs) {\n\t\tdev_err(dev, \"failed to allocate array for PCS PHYs\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\trc = mscc_miim_setup(dev, &bus, \"VSC9953 internal MDIO bus\",\n\t\t\t     ocelot->targets[GCB],\n\t\t\t     ocelot->map[GCB][GCB_MIIM_MII_STATUS & REG_MASK],\n\t\t\t     true);\n\tif (rc) {\n\t\tdev_err(dev, \"failed to setup MDIO bus\\n\");\n\t\treturn rc;\n\t}\n\n\t \n\trc = devm_of_mdiobus_register(dev, bus, NULL);\n\tif (rc < 0) {\n\t\tdev_err(dev, \"failed to register MDIO bus\\n\");\n\t\treturn rc;\n\t}\n\n\tfelix->imdio = bus;\n\n\tfor (port = 0; port < felix->info->num_ports; port++) {\n\t\tstruct ocelot_port *ocelot_port = ocelot->ports[port];\n\t\tstruct phylink_pcs *phylink_pcs;\n\t\tint addr = port + 4;\n\n\t\tif (dsa_is_unused_port(felix->ds, port))\n\t\t\tcontinue;\n\n\t\tif (ocelot_port->phy_mode == PHY_INTERFACE_MODE_INTERNAL)\n\t\t\tcontinue;\n\n\t\tphylink_pcs = lynx_pcs_create_mdiodev(felix->imdio, addr);\n\t\tif (IS_ERR(phylink_pcs))\n\t\t\tcontinue;\n\n\t\tfelix->pcs[port] = phylink_pcs;\n\n\t\tdev_info(dev, \"Found PCS at internal MDIO address %d\\n\", addr);\n\t}\n\n\treturn 0;\n}\n\nstatic void vsc9953_mdio_bus_free(struct ocelot *ocelot)\n{\n\tstruct felix *felix = ocelot_to_felix(ocelot);\n\tint port;\n\n\tfor (port = 0; port < ocelot->num_phys_ports; port++) {\n\t\tstruct phylink_pcs *phylink_pcs = felix->pcs[port];\n\n\t\tif (phylink_pcs)\n\t\t\tlynx_pcs_destroy(phylink_pcs);\n\t}\n\n\t \n}\n\nstatic const struct felix_info seville_info_vsc9953 = {\n\t.resources\t\t= vsc9953_resources,\n\t.num_resources\t\t= ARRAY_SIZE(vsc9953_resources),\n\t.resource_names\t\t= vsc9953_resource_names,\n\t.regfields\t\t= vsc9953_regfields,\n\t.map\t\t\t= vsc9953_regmap,\n\t.ops\t\t\t= &vsc9953_ops,\n\t.vcap\t\t\t= vsc9953_vcap_props,\n\t.vcap_pol_base\t\t= VSC9953_VCAP_POLICER_BASE,\n\t.vcap_pol_max\t\t= VSC9953_VCAP_POLICER_MAX,\n\t.vcap_pol_base2\t\t= VSC9953_VCAP_POLICER_BASE2,\n\t.vcap_pol_max2\t\t= VSC9953_VCAP_POLICER_MAX2,\n\t.quirks\t\t\t= FELIX_MAC_QUIRKS,\n\t.num_mact_rows\t\t= 2048,\n\t.num_ports\t\t= VSC9953_NUM_PORTS,\n\t.num_tx_queues\t\t= OCELOT_NUM_TC,\n\t.mdio_bus_alloc\t\t= vsc9953_mdio_bus_alloc,\n\t.mdio_bus_free\t\t= vsc9953_mdio_bus_free,\n\t.port_modes\t\t= vsc9953_port_modes,\n};\n\nstatic int seville_probe(struct platform_device *pdev)\n{\n\tstruct dsa_switch *ds;\n\tstruct ocelot *ocelot;\n\tstruct resource *res;\n\tstruct felix *felix;\n\tint err;\n\n\tfelix = kzalloc(sizeof(struct felix), GFP_KERNEL);\n\tif (!felix) {\n\t\terr = -ENOMEM;\n\t\tdev_err(&pdev->dev, \"Failed to allocate driver memory\\n\");\n\t\tgoto err_alloc_felix;\n\t}\n\n\tplatform_set_drvdata(pdev, felix);\n\n\tocelot = &felix->ocelot;\n\tocelot->dev = &pdev->dev;\n\tocelot->num_flooding_pgids = 1;\n\tfelix->info = &seville_info_vsc9953;\n\n\tres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\n\tif (!res) {\n\t\terr = -EINVAL;\n\t\tdev_err(&pdev->dev, \"Invalid resource\\n\");\n\t\tgoto err_alloc_felix;\n\t}\n\tfelix->switch_base = res->start;\n\n\tds = kzalloc(sizeof(struct dsa_switch), GFP_KERNEL);\n\tif (!ds) {\n\t\terr = -ENOMEM;\n\t\tdev_err(&pdev->dev, \"Failed to allocate DSA switch\\n\");\n\t\tgoto err_alloc_ds;\n\t}\n\n\tds->dev = &pdev->dev;\n\tds->num_ports = felix->info->num_ports;\n\tds->ops = &felix_switch_ops;\n\tds->priv = ocelot;\n\tfelix->ds = ds;\n\tfelix->tag_proto = DSA_TAG_PROTO_SEVILLE;\n\n\terr = dsa_register_switch(ds);\n\tif (err) {\n\t\tdev_err(&pdev->dev, \"Failed to register DSA switch: %d\\n\", err);\n\t\tgoto err_register_ds;\n\t}\n\n\treturn 0;\n\nerr_register_ds:\n\tkfree(ds);\nerr_alloc_ds:\nerr_alloc_felix:\n\tkfree(felix);\n\treturn err;\n}\n\nstatic int seville_remove(struct platform_device *pdev)\n{\n\tstruct felix *felix = platform_get_drvdata(pdev);\n\n\tif (!felix)\n\t\treturn 0;\n\n\tdsa_unregister_switch(felix->ds);\n\n\tkfree(felix->ds);\n\tkfree(felix);\n\n\treturn 0;\n}\n\nstatic void seville_shutdown(struct platform_device *pdev)\n{\n\tstruct felix *felix = platform_get_drvdata(pdev);\n\n\tif (!felix)\n\t\treturn;\n\n\tdsa_switch_shutdown(felix->ds);\n\n\tplatform_set_drvdata(pdev, NULL);\n}\n\nstatic const struct of_device_id seville_of_match[] = {\n\t{ .compatible = \"mscc,vsc9953-switch\" },\n\t{ },\n};\nMODULE_DEVICE_TABLE(of, seville_of_match);\n\nstatic struct platform_driver seville_vsc9953_driver = {\n\t.probe\t\t= seville_probe,\n\t.remove\t\t= seville_remove,\n\t.shutdown\t= seville_shutdown,\n\t.driver = {\n\t\t.name\t\t= \"mscc_seville\",\n\t\t.of_match_table\t= seville_of_match,\n\t},\n};\nmodule_platform_driver(seville_vsc9953_driver);\n\nMODULE_DESCRIPTION(\"Seville Switch driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}