{
  "module_name": "sja1105_static_config.c",
  "hash_id": "bdbc1ec4209c1358211b8b20e33d64aa51f4029a418b26f892c41f69d80b7c73",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/dsa/sja1105/sja1105_static_config.c",
  "human_readable_source": "\n \n#include \"sja1105_static_config.h\"\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n\n \nvoid sja1105_pack(void *buf, const u64 *val, int start, int end, size_t len)\n{\n\tint rc = packing(buf, (u64 *)val, start, end, len,\n\t\t\t PACK, QUIRK_LSW32_IS_FIRST);\n\n\tif (likely(!rc))\n\t\treturn;\n\n\tif (rc == -EINVAL) {\n\t\tpr_err(\"Start bit (%d) expected to be larger than end (%d)\\n\",\n\t\t       start, end);\n\t} else if (rc == -ERANGE) {\n\t\tif ((start - end + 1) > 64)\n\t\t\tpr_err(\"Field %d-%d too large for 64 bits!\\n\",\n\t\t\t       start, end);\n\t\telse\n\t\t\tpr_err(\"Cannot store %llx inside bits %d-%d (would truncate)\\n\",\n\t\t\t       *val, start, end);\n\t}\n\tdump_stack();\n}\n\nvoid sja1105_unpack(const void *buf, u64 *val, int start, int end, size_t len)\n{\n\tint rc = packing((void *)buf, val, start, end, len,\n\t\t\t UNPACK, QUIRK_LSW32_IS_FIRST);\n\n\tif (likely(!rc))\n\t\treturn;\n\n\tif (rc == -EINVAL)\n\t\tpr_err(\"Start bit (%d) expected to be larger than end (%d)\\n\",\n\t\t       start, end);\n\telse if (rc == -ERANGE)\n\t\tpr_err(\"Field %d-%d too large for 64 bits!\\n\",\n\t\t       start, end);\n\tdump_stack();\n}\n\nvoid sja1105_packing(void *buf, u64 *val, int start, int end,\n\t\t     size_t len, enum packing_op op)\n{\n\tint rc = packing(buf, val, start, end, len, op, QUIRK_LSW32_IS_FIRST);\n\n\tif (likely(!rc))\n\t\treturn;\n\n\tif (rc == -EINVAL) {\n\t\tpr_err(\"Start bit (%d) expected to be larger than end (%d)\\n\",\n\t\t       start, end);\n\t} else if (rc == -ERANGE) {\n\t\tif ((start - end + 1) > 64)\n\t\t\tpr_err(\"Field %d-%d too large for 64 bits!\\n\",\n\t\t\t       start, end);\n\t\telse\n\t\t\tpr_err(\"Cannot store %llx inside bits %d-%d (would truncate)\\n\",\n\t\t\t       *val, start, end);\n\t}\n\tdump_stack();\n}\n\n \nu32 sja1105_crc32(const void *buf, size_t len)\n{\n\tunsigned int i;\n\tu64 word;\n\tu32 crc;\n\n\t \n\tcrc = ~0;\n\tfor (i = 0; i < len; i += 4) {\n\t\tsja1105_unpack(buf + i, &word, 31, 0, 4);\n\t\tcrc = crc32_le(crc, (u8 *)&word, 4);\n\t}\n\treturn ~crc;\n}\n\nstatic size_t sja1105et_avb_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1105ET_SIZE_AVB_PARAMS_ENTRY;\n\tstruct sja1105_avb_params_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->destmeta, 95, 48, size, op);\n\tsja1105_packing(buf, &entry->srcmeta,  47,  0, size, op);\n\treturn size;\n}\n\nsize_t sja1105pqrs_avb_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t    enum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY;\n\tstruct sja1105_avb_params_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->cas_master, 126, 126, size, op);\n\tsja1105_packing(buf, &entry->destmeta,   125,  78, size, op);\n\tsja1105_packing(buf, &entry->srcmeta,     77,  30, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105et_general_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t     enum packing_op op)\n{\n\tconst size_t size = SJA1105ET_SIZE_GENERAL_PARAMS_ENTRY;\n\tstruct sja1105_general_params_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->vllupformat, 319, 319, size, op);\n\tsja1105_packing(buf, &entry->mirr_ptacu,  318, 318, size, op);\n\tsja1105_packing(buf, &entry->switchid,    317, 315, size, op);\n\tsja1105_packing(buf, &entry->hostprio,    314, 312, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres1, 311, 264, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres0, 263, 216, size, op);\n\tsja1105_packing(buf, &entry->mac_flt1,    215, 168, size, op);\n\tsja1105_packing(buf, &entry->mac_flt0,    167, 120, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt1, 119, 119, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt0, 118, 118, size, op);\n\tsja1105_packing(buf, &entry->send_meta1,  117, 117, size, op);\n\tsja1105_packing(buf, &entry->send_meta0,  116, 116, size, op);\n\tsja1105_packing(buf, &entry->casc_port,   115, 113, size, op);\n\tsja1105_packing(buf, &entry->host_port,   112, 110, size, op);\n\tsja1105_packing(buf, &entry->mirr_port,   109, 107, size, op);\n\tsja1105_packing(buf, &entry->vlmarker,    106,  75, size, op);\n\tsja1105_packing(buf, &entry->vlmask,       74,  43, size, op);\n\tsja1105_packing(buf, &entry->tpid,         42,  27, size, op);\n\tsja1105_packing(buf, &entry->ignore2stf,   26,  26, size, op);\n\tsja1105_packing(buf, &entry->tpid2,        25,  10, size, op);\n\treturn size;\n}\n\n \nsize_t sja1105pqrs_general_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\tenum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_GENERAL_PARAMS_ENTRY;\n\tstruct sja1105_general_params_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->vllupformat, 351, 351, size, op);\n\tsja1105_packing(buf, &entry->mirr_ptacu,  350, 350, size, op);\n\tsja1105_packing(buf, &entry->switchid,    349, 347, size, op);\n\tsja1105_packing(buf, &entry->hostprio,    346, 344, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres1, 343, 296, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres0, 295, 248, size, op);\n\tsja1105_packing(buf, &entry->mac_flt1,    247, 200, size, op);\n\tsja1105_packing(buf, &entry->mac_flt0,    199, 152, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt1, 151, 151, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt0, 150, 150, size, op);\n\tsja1105_packing(buf, &entry->send_meta1,  149, 149, size, op);\n\tsja1105_packing(buf, &entry->send_meta0,  148, 148, size, op);\n\tsja1105_packing(buf, &entry->casc_port,   147, 145, size, op);\n\tsja1105_packing(buf, &entry->host_port,   144, 142, size, op);\n\tsja1105_packing(buf, &entry->mirr_port,   141, 139, size, op);\n\tsja1105_packing(buf, &entry->vlmarker,    138, 107, size, op);\n\tsja1105_packing(buf, &entry->vlmask,      106,  75, size, op);\n\tsja1105_packing(buf, &entry->tpid2,        74,  59, size, op);\n\tsja1105_packing(buf, &entry->ignore2stf,   58,  58, size, op);\n\tsja1105_packing(buf, &entry->tpid,         57,  42, size, op);\n\tsja1105_packing(buf, &entry->queue_ts,     41,  41, size, op);\n\tsja1105_packing(buf, &entry->egrmirrvid,   40,  29, size, op);\n\tsja1105_packing(buf, &entry->egrmirrpcp,   28,  26, size, op);\n\tsja1105_packing(buf, &entry->egrmirrdei,   25,  25, size, op);\n\tsja1105_packing(buf, &entry->replay_port,  24,  22, size, op);\n\treturn size;\n}\n\nsize_t sja1110_general_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t    enum packing_op op)\n{\n\tstruct sja1105_general_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1110_SIZE_GENERAL_PARAMS_ENTRY;\n\n\tsja1105_packing(buf, &entry->vllupformat,  447, 447, size, op);\n\tsja1105_packing(buf, &entry->mirr_ptacu,   446, 446, size, op);\n\tsja1105_packing(buf, &entry->switchid,     445, 442, size, op);\n\tsja1105_packing(buf, &entry->hostprio,     441, 439, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres1,  438, 391, size, op);\n\tsja1105_packing(buf, &entry->mac_fltres0,  390, 343, size, op);\n\tsja1105_packing(buf, &entry->mac_flt1,     342, 295, size, op);\n\tsja1105_packing(buf, &entry->mac_flt0,     294, 247, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt1,  246, 246, size, op);\n\tsja1105_packing(buf, &entry->incl_srcpt0,  245, 245, size, op);\n\tsja1105_packing(buf, &entry->send_meta1,   244, 244, size, op);\n\tsja1105_packing(buf, &entry->send_meta0,   243, 243, size, op);\n\tsja1105_packing(buf, &entry->casc_port,    242, 232, size, op);\n\tsja1105_packing(buf, &entry->host_port,    231, 228, size, op);\n\tsja1105_packing(buf, &entry->mirr_port,    227, 224, size, op);\n\tsja1105_packing(buf, &entry->vlmarker,     223, 192, size, op);\n\tsja1105_packing(buf, &entry->vlmask,       191, 160, size, op);\n\tsja1105_packing(buf, &entry->tpid2,        159, 144, size, op);\n\tsja1105_packing(buf, &entry->ignore2stf,   143, 143, size, op);\n\tsja1105_packing(buf, &entry->tpid,         142, 127, size, op);\n\tsja1105_packing(buf, &entry->queue_ts,     126, 126, size, op);\n\tsja1105_packing(buf, &entry->egrmirrvid,   125, 114, size, op);\n\tsja1105_packing(buf, &entry->egrmirrpcp,   113, 111, size, op);\n\tsja1105_packing(buf, &entry->egrmirrdei,   110, 110, size, op);\n\tsja1105_packing(buf, &entry->replay_port,  109, 106, size, op);\n\tsja1105_packing(buf, &entry->tdmaconfigidx, 70,  67, size, op);\n\tsja1105_packing(buf, &entry->header_type,   64,  49, size, op);\n\tsja1105_packing(buf, &entry->tte_en,        16,  16, size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1105_l2_forwarding_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY;\n\tstruct sja1105_l2_forwarding_params_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tsja1105_packing(buf, &entry->max_dynp, 95, 93, size, op);\n\tfor (i = 0, offset = 13; i < 8; i++, offset += 10)\n\t\tsja1105_packing(buf, &entry->part_spc[i],\n\t\t\t\toffset + 9, offset + 0, size, op);\n\treturn size;\n}\n\nsize_t sja1110_l2_forwarding_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t  enum packing_op op)\n{\n\tstruct sja1105_l2_forwarding_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY;\n\tint offset, i;\n\n\tsja1105_packing(buf, &entry->max_dynp, 95, 93, size, op);\n\tfor (i = 0, offset = 5; i < 8; i++, offset += 11)\n\t\tsja1105_packing(buf, &entry->part_spc[i],\n\t\t\t\toffset + 10, offset + 0, size, op);\n\treturn size;\n}\n\nsize_t sja1105_l2_forwarding_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_L2_FORWARDING_ENTRY;\n\tstruct sja1105_l2_forwarding_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tsja1105_packing(buf, &entry->bc_domain,  63, 59, size, op);\n\tsja1105_packing(buf, &entry->reach_port, 58, 54, size, op);\n\tsja1105_packing(buf, &entry->fl_domain,  53, 49, size, op);\n\tfor (i = 0, offset = 25; i < 8; i++, offset += 3)\n\t\tsja1105_packing(buf, &entry->vlan_pmap[i],\n\t\t\t\toffset + 2, offset + 0, size, op);\n\treturn size;\n}\n\nsize_t sja1110_l2_forwarding_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tstruct sja1105_l2_forwarding_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_L2_FORWARDING_ENTRY;\n\tint offset, i;\n\n\tif (entry->type_egrpcp2outputq) {\n\t\tfor (i = 0, offset = 31; i < SJA1110_NUM_PORTS;\n\t\t     i++, offset += 3) {\n\t\t\tsja1105_packing(buf, &entry->vlan_pmap[i],\n\t\t\t\t\toffset + 2, offset + 0, size, op);\n\t\t}\n\t} else {\n\t\tsja1105_packing(buf, &entry->bc_domain,  63, 53, size, op);\n\t\tsja1105_packing(buf, &entry->reach_port, 52, 42, size, op);\n\t\tsja1105_packing(buf, &entry->fl_domain,  41, 31, size, op);\n\t}\n\treturn size;\n}\n\nstatic size_t\nsja1105et_l2_lookup_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1105ET_SIZE_L2_LOOKUP_PARAMS_ENTRY;\n\tstruct sja1105_l2_lookup_params_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->maxage,         31, 17, size, op);\n\tsja1105_packing(buf, &entry->dyn_tbsz,       16, 14, size, op);\n\tsja1105_packing(buf, &entry->poly,           13,  6, size, op);\n\tsja1105_packing(buf, &entry->shared_learn,    5,  5, size, op);\n\tsja1105_packing(buf, &entry->no_enf_hostprt,  4,  4, size, op);\n\tsja1105_packing(buf, &entry->no_mgmt_learn,   3,  3, size, op);\n\treturn size;\n}\n\nsize_t sja1105pqrs_l2_lookup_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t  enum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_L2_LOOKUP_PARAMS_ENTRY;\n\tstruct sja1105_l2_lookup_params_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 58; i < 5; i++, offset += 11)\n\t\tsja1105_packing(buf, &entry->maxaddrp[i],\n\t\t\t\toffset + 10, offset + 0, size, op);\n\tsja1105_packing(buf, &entry->maxage,         57,  43, size, op);\n\tsja1105_packing(buf, &entry->start_dynspc,   42,  33, size, op);\n\tsja1105_packing(buf, &entry->drpnolearn,     32,  28, size, op);\n\tsja1105_packing(buf, &entry->shared_learn,   27,  27, size, op);\n\tsja1105_packing(buf, &entry->no_enf_hostprt, 26,  26, size, op);\n\tsja1105_packing(buf, &entry->no_mgmt_learn,  25,  25, size, op);\n\tsja1105_packing(buf, &entry->use_static,     24,  24, size, op);\n\tsja1105_packing(buf, &entry->owr_dyn,        23,  23, size, op);\n\tsja1105_packing(buf, &entry->learn_once,     22,  22, size, op);\n\treturn size;\n}\n\nsize_t sja1110_l2_lookup_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t      enum packing_op op)\n{\n\tstruct sja1105_l2_lookup_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1110_SIZE_L2_LOOKUP_PARAMS_ENTRY;\n\tint offset, i;\n\n\tfor (i = 0, offset = 70; i < SJA1110_NUM_PORTS; i++, offset += 11)\n\t\tsja1105_packing(buf, &entry->maxaddrp[i],\n\t\t\t\toffset + 10, offset + 0, size, op);\n\tsja1105_packing(buf, &entry->maxage,         69,  55, size, op);\n\tsja1105_packing(buf, &entry->start_dynspc,   54,  45, size, op);\n\tsja1105_packing(buf, &entry->drpnolearn,     44,  34, size, op);\n\tsja1105_packing(buf, &entry->shared_learn,   33,  33, size, op);\n\tsja1105_packing(buf, &entry->no_enf_hostprt, 32,  32, size, op);\n\tsja1105_packing(buf, &entry->no_mgmt_learn,  31,  31, size, op);\n\tsja1105_packing(buf, &entry->use_static,     30,  30, size, op);\n\tsja1105_packing(buf, &entry->owr_dyn,        29,  29, size, op);\n\tsja1105_packing(buf, &entry->learn_once,     28,  28, size, op);\n\treturn size;\n}\n\nsize_t sja1105et_l2_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1105ET_SIZE_L2_LOOKUP_ENTRY;\n\tstruct sja1105_l2_lookup_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->vlanid,    95, 84, size, op);\n\tsja1105_packing(buf, &entry->macaddr,   83, 36, size, op);\n\tsja1105_packing(buf, &entry->destports, 35, 31, size, op);\n\tsja1105_packing(buf, &entry->enfport,   30, 30, size, op);\n\tsja1105_packing(buf, &entry->index,     29, 20, size, op);\n\treturn size;\n}\n\nsize_t sja1105pqrs_l2_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_L2_LOOKUP_ENTRY;\n\tstruct sja1105_l2_lookup_entry *entry = entry_ptr;\n\n\tif (entry->lockeds) {\n\t\tsja1105_packing(buf, &entry->tsreg,    159, 159, size, op);\n\t\tsja1105_packing(buf, &entry->mirrvlan, 158, 147, size, op);\n\t\tsja1105_packing(buf, &entry->takets,   146, 146, size, op);\n\t\tsja1105_packing(buf, &entry->mirr,     145, 145, size, op);\n\t\tsja1105_packing(buf, &entry->retag,    144, 144, size, op);\n\t} else {\n\t\tsja1105_packing(buf, &entry->touched,  159, 159, size, op);\n\t\tsja1105_packing(buf, &entry->age,      158, 144, size, op);\n\t}\n\tsja1105_packing(buf, &entry->mask_iotag,   143, 143, size, op);\n\tsja1105_packing(buf, &entry->mask_vlanid,  142, 131, size, op);\n\tsja1105_packing(buf, &entry->mask_macaddr, 130,  83, size, op);\n\tsja1105_packing(buf, &entry->iotag,         82,  82, size, op);\n\tsja1105_packing(buf, &entry->vlanid,        81,  70, size, op);\n\tsja1105_packing(buf, &entry->macaddr,       69,  22, size, op);\n\tsja1105_packing(buf, &entry->destports,     21,  17, size, op);\n\tsja1105_packing(buf, &entry->enfport,       16,  16, size, op);\n\tsja1105_packing(buf, &entry->index,         15,   6, size, op);\n\treturn size;\n}\n\nsize_t sja1110_l2_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t       enum packing_op op)\n{\n\tconst size_t size = SJA1110_SIZE_L2_LOOKUP_ENTRY;\n\tstruct sja1105_l2_lookup_entry *entry = entry_ptr;\n\n\tif (entry->lockeds) {\n\t\tsja1105_packing(buf, &entry->trap,     168, 168, size, op);\n\t\tsja1105_packing(buf, &entry->mirrvlan, 167, 156, size, op);\n\t\tsja1105_packing(buf, &entry->takets,   155, 155, size, op);\n\t\tsja1105_packing(buf, &entry->mirr,     154, 154, size, op);\n\t\tsja1105_packing(buf, &entry->retag,    153, 153, size, op);\n\t} else {\n\t\tsja1105_packing(buf, &entry->touched,  168, 168, size, op);\n\t\tsja1105_packing(buf, &entry->age,      167, 153, size, op);\n\t}\n\tsja1105_packing(buf, &entry->mask_iotag,   152, 152, size, op);\n\tsja1105_packing(buf, &entry->mask_vlanid,  151, 140, size, op);\n\tsja1105_packing(buf, &entry->mask_macaddr, 139,  92, size, op);\n\tsja1105_packing(buf, &entry->mask_srcport,  91,  88, size, op);\n\tsja1105_packing(buf, &entry->iotag,         87,  87, size, op);\n\tsja1105_packing(buf, &entry->vlanid,        86,  75, size, op);\n\tsja1105_packing(buf, &entry->macaddr,       74,  27, size, op);\n\tsja1105_packing(buf, &entry->srcport,       26,  23, size, op);\n\tsja1105_packing(buf, &entry->destports,     22,  12, size, op);\n\tsja1105_packing(buf, &entry->enfport,       11,  11, size, op);\n\tsja1105_packing(buf, &entry->index,         10,   1, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105_l2_policing_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\tenum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_L2_POLICING_ENTRY;\n\tstruct sja1105_l2_policing_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->sharindx,  63, 58, size, op);\n\tsja1105_packing(buf, &entry->smax,      57, 42, size, op);\n\tsja1105_packing(buf, &entry->rate,      41, 26, size, op);\n\tsja1105_packing(buf, &entry->maxlen,    25, 15, size, op);\n\tsja1105_packing(buf, &entry->partition, 14, 12, size, op);\n\treturn size;\n}\n\nsize_t sja1110_l2_policing_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tstruct sja1105_l2_policing_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_L2_POLICING_ENTRY;\n\n\tsja1105_packing(buf, &entry->sharindx, 63, 57, size, op);\n\tsja1105_packing(buf, &entry->smax,     56, 39, size, op);\n\tsja1105_packing(buf, &entry->rate,     38, 21, size, op);\n\tsja1105_packing(buf, &entry->maxlen,   20, 10, size, op);\n\tsja1105_packing(buf, &entry->partition, 9,  7, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105et_mac_config_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1105ET_SIZE_MAC_CONFIG_ENTRY;\n\tstruct sja1105_mac_config_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 72; i < 8; i++, offset += 19) {\n\t\tsja1105_packing(buf, &entry->enabled[i],\n\t\t\t\toffset +  0, offset +  0, size, op);\n\t\tsja1105_packing(buf, &entry->base[i],\n\t\t\t\toffset +  9, offset +  1, size, op);\n\t\tsja1105_packing(buf, &entry->top[i],\n\t\t\t\toffset + 18, offset + 10, size, op);\n\t}\n\tsja1105_packing(buf, &entry->ifg,       71, 67, size, op);\n\tsja1105_packing(buf, &entry->speed,     66, 65, size, op);\n\tsja1105_packing(buf, &entry->tp_delin,  64, 49, size, op);\n\tsja1105_packing(buf, &entry->tp_delout, 48, 33, size, op);\n\tsja1105_packing(buf, &entry->maxage,    32, 25, size, op);\n\tsja1105_packing(buf, &entry->vlanprio,  24, 22, size, op);\n\tsja1105_packing(buf, &entry->vlanid,    21, 10, size, op);\n\tsja1105_packing(buf, &entry->ing_mirr,   9,  9, size, op);\n\tsja1105_packing(buf, &entry->egr_mirr,   8,  8, size, op);\n\tsja1105_packing(buf, &entry->drpnona664, 7,  7, size, op);\n\tsja1105_packing(buf, &entry->drpdtag,    6,  6, size, op);\n\tsja1105_packing(buf, &entry->drpuntag,   5,  5, size, op);\n\tsja1105_packing(buf, &entry->retag,      4,  4, size, op);\n\tsja1105_packing(buf, &entry->dyn_learn,  3,  3, size, op);\n\tsja1105_packing(buf, &entry->egress,     2,  2, size, op);\n\tsja1105_packing(buf, &entry->ingress,    1,  1, size, op);\n\treturn size;\n}\n\nsize_t sja1105pqrs_mac_config_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t    enum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY;\n\tstruct sja1105_mac_config_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 104; i < 8; i++, offset += 19) {\n\t\tsja1105_packing(buf, &entry->enabled[i],\n\t\t\t\toffset +  0, offset +  0, size, op);\n\t\tsja1105_packing(buf, &entry->base[i],\n\t\t\t\toffset +  9, offset +  1, size, op);\n\t\tsja1105_packing(buf, &entry->top[i],\n\t\t\t\toffset + 18, offset + 10, size, op);\n\t}\n\tsja1105_packing(buf, &entry->ifg,       103, 99, size, op);\n\tsja1105_packing(buf, &entry->speed,      98, 97, size, op);\n\tsja1105_packing(buf, &entry->tp_delin,   96, 81, size, op);\n\tsja1105_packing(buf, &entry->tp_delout,  80, 65, size, op);\n\tsja1105_packing(buf, &entry->maxage,     64, 57, size, op);\n\tsja1105_packing(buf, &entry->vlanprio,   56, 54, size, op);\n\tsja1105_packing(buf, &entry->vlanid,     53, 42, size, op);\n\tsja1105_packing(buf, &entry->ing_mirr,   41, 41, size, op);\n\tsja1105_packing(buf, &entry->egr_mirr,   40, 40, size, op);\n\tsja1105_packing(buf, &entry->drpnona664, 39, 39, size, op);\n\tsja1105_packing(buf, &entry->drpdtag,    38, 38, size, op);\n\tsja1105_packing(buf, &entry->drpuntag,   35, 35, size, op);\n\tsja1105_packing(buf, &entry->retag,      34, 34, size, op);\n\tsja1105_packing(buf, &entry->dyn_learn,  33, 33, size, op);\n\tsja1105_packing(buf, &entry->egress,     32, 32, size, op);\n\tsja1105_packing(buf, &entry->ingress,    31, 31, size, op);\n\treturn size;\n}\n\nsize_t sja1110_mac_config_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\tenum packing_op op)\n{\n\tconst size_t size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY;\n\tstruct sja1105_mac_config_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 104; i < 8; i++, offset += 19) {\n\t\tsja1105_packing(buf, &entry->enabled[i],\n\t\t\t\toffset +  0, offset +  0, size, op);\n\t\tsja1105_packing(buf, &entry->base[i],\n\t\t\t\toffset +  9, offset +  1, size, op);\n\t\tsja1105_packing(buf, &entry->top[i],\n\t\t\t\toffset + 18, offset + 10, size, op);\n\t}\n\tsja1105_packing(buf, &entry->speed,      98, 96, size, op);\n\tsja1105_packing(buf, &entry->tp_delin,   95, 80, size, op);\n\tsja1105_packing(buf, &entry->tp_delout,  79, 64, size, op);\n\tsja1105_packing(buf, &entry->maxage,     63, 56, size, op);\n\tsja1105_packing(buf, &entry->vlanprio,   55, 53, size, op);\n\tsja1105_packing(buf, &entry->vlanid,     52, 41, size, op);\n\tsja1105_packing(buf, &entry->ing_mirr,   40, 40, size, op);\n\tsja1105_packing(buf, &entry->egr_mirr,   39, 39, size, op);\n\tsja1105_packing(buf, &entry->drpnona664, 38, 38, size, op);\n\tsja1105_packing(buf, &entry->drpdtag,    37, 37, size, op);\n\tsja1105_packing(buf, &entry->drpuntag,   34, 34, size, op);\n\tsja1105_packing(buf, &entry->retag,      33, 33, size, op);\n\tsja1105_packing(buf, &entry->dyn_learn,  32, 32, size, op);\n\tsja1105_packing(buf, &entry->egress,     31, 31, size, op);\n\tsja1105_packing(buf, &entry->ingress,    30, 30, size, op);\n\tsja1105_packing(buf, &entry->ifg,        10,  5, size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1105_schedule_entry_points_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t   enum packing_op op)\n{\n\tstruct sja1105_schedule_entry_points_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_PARAMS_ENTRY;\n\n\tsja1105_packing(buf, &entry->clksrc,    31, 30, size, op);\n\tsja1105_packing(buf, &entry->actsubsch, 29, 27, size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1105_schedule_entry_points_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t    enum packing_op op)\n{\n\tstruct sja1105_schedule_entry_points_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY;\n\n\tsja1105_packing(buf, &entry->subschindx, 31, 29, size, op);\n\tsja1105_packing(buf, &entry->delta,      28, 11, size, op);\n\tsja1105_packing(buf, &entry->address,    10, 1,  size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1110_schedule_entry_points_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t    enum packing_op op)\n{\n\tstruct sja1105_schedule_entry_points_entry *entry = entry_ptr;\n\tconst size_t size = SJA1110_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY;\n\n\tsja1105_packing(buf, &entry->subschindx, 63, 61, size, op);\n\tsja1105_packing(buf, &entry->delta,      60, 43, size, op);\n\tsja1105_packing(buf, &entry->address,    42, 31, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105_schedule_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t    enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY;\n\tstruct sja1105_schedule_params_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 16; i < 8; i++, offset += 10)\n\t\tsja1105_packing(buf, &entry->subscheind[i],\n\t\t\t\toffset + 9, offset + 0, size, op);\n\treturn size;\n}\n\nstatic size_t sja1110_schedule_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t    enum packing_op op)\n{\n\tstruct sja1105_schedule_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY;\n\tint offset, i;\n\n\tfor (i = 0, offset = 0; i < 8; i++, offset += 12)\n\t\tsja1105_packing(buf, &entry->subscheind[i],\n\t\t\t\toffset + 11, offset + 0, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105_schedule_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t     enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_SCHEDULE_ENTRY;\n\tstruct sja1105_schedule_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->winstindex,  63, 54, size, op);\n\tsja1105_packing(buf, &entry->winend,      53, 53, size, op);\n\tsja1105_packing(buf, &entry->winst,       52, 52, size, op);\n\tsja1105_packing(buf, &entry->destports,   51, 47, size, op);\n\tsja1105_packing(buf, &entry->setvalid,    46, 46, size, op);\n\tsja1105_packing(buf, &entry->txen,        45, 45, size, op);\n\tsja1105_packing(buf, &entry->resmedia_en, 44, 44, size, op);\n\tsja1105_packing(buf, &entry->resmedia,    43, 36, size, op);\n\tsja1105_packing(buf, &entry->vlindex,     35, 26, size, op);\n\tsja1105_packing(buf, &entry->delta,       25, 8,  size, op);\n\treturn size;\n}\n\nstatic size_t sja1110_schedule_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t     enum packing_op op)\n{\n\tconst size_t size = SJA1110_SIZE_SCHEDULE_ENTRY;\n\tstruct sja1105_schedule_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->winstindex,  95, 84, size, op);\n\tsja1105_packing(buf, &entry->winend,      83, 83, size, op);\n\tsja1105_packing(buf, &entry->winst,       82, 82, size, op);\n\tsja1105_packing(buf, &entry->destports,   81, 71, size, op);\n\tsja1105_packing(buf, &entry->setvalid,    70, 70, size, op);\n\tsja1105_packing(buf, &entry->txen,        69, 69, size, op);\n\tsja1105_packing(buf, &entry->resmedia_en, 68, 68, size, op);\n\tsja1105_packing(buf, &entry->resmedia,    67, 60, size, op);\n\tsja1105_packing(buf, &entry->vlindex,     59, 48, size, op);\n\tsja1105_packing(buf, &entry->delta,       47, 30, size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1105_vl_forwarding_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tstruct sja1105_vl_forwarding_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY;\n\tint offset, i;\n\n\tfor (i = 0, offset = 16; i < 8; i++, offset += 10)\n\t\tsja1105_packing(buf, &entry->partspc[i],\n\t\t\t\toffset + 9, offset + 0, size, op);\n\tsja1105_packing(buf, &entry->debugen, 15, 15, size, op);\n\treturn size;\n}\n\nstatic size_t\nsja1110_vl_forwarding_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t   enum packing_op op)\n{\n\tstruct sja1105_vl_forwarding_params_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY;\n\tint offset, i;\n\n\tfor (i = 0, offset = 8; i < 8; i++, offset += 11)\n\t\tsja1105_packing(buf, &entry->partspc[i],\n\t\t\t\toffset + 10, offset + 0, size, op);\n\tsja1105_packing(buf, &entry->debugen, 7, 7, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105_vl_forwarding_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t  enum packing_op op)\n{\n\tstruct sja1105_vl_forwarding_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_FORWARDING_ENTRY;\n\n\tsja1105_packing(buf, &entry->type,      31, 31, size, op);\n\tsja1105_packing(buf, &entry->priority,  30, 28, size, op);\n\tsja1105_packing(buf, &entry->partition, 27, 25, size, op);\n\tsja1105_packing(buf, &entry->destports, 24, 20, size, op);\n\treturn size;\n}\n\nstatic size_t sja1110_vl_forwarding_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t  enum packing_op op)\n{\n\tstruct sja1105_vl_forwarding_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_FORWARDING_ENTRY;\n\n\tsja1105_packing(buf, &entry->type,      31, 31, size, op);\n\tsja1105_packing(buf, &entry->priority,  30, 28, size, op);\n\tsja1105_packing(buf, &entry->partition, 27, 25, size, op);\n\tsja1105_packing(buf, &entry->destports, 24, 14, size, op);\n\treturn size;\n}\n\nsize_t sja1105_vl_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t       enum packing_op op)\n{\n\tstruct sja1105_vl_lookup_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_LOOKUP_ENTRY;\n\n\tif (entry->format == SJA1105_VL_FORMAT_PSFP) {\n\t\t \n\t\tsja1105_packing(buf, &entry->destports,\n\t\t\t\t95, 91, size, op);\n\t\tsja1105_packing(buf, &entry->iscritical,\n\t\t\t\t90, 90, size, op);\n\t\tsja1105_packing(buf, &entry->macaddr,\n\t\t\t\t89, 42, size, op);\n\t\tsja1105_packing(buf, &entry->vlanid,\n\t\t\t\t41, 30, size, op);\n\t\tsja1105_packing(buf, &entry->port,\n\t\t\t\t29, 27, size, op);\n\t\tsja1105_packing(buf, &entry->vlanprior,\n\t\t\t\t26, 24, size, op);\n\t} else {\n\t\t \n\t\tsja1105_packing(buf, &entry->egrmirr,\n\t\t\t\t95, 91, size, op);\n\t\tsja1105_packing(buf, &entry->ingrmirr,\n\t\t\t\t90, 90, size, op);\n\t\tsja1105_packing(buf, &entry->vlid,\n\t\t\t\t57, 42, size, op);\n\t\tsja1105_packing(buf, &entry->port,\n\t\t\t\t29, 27, size, op);\n\t}\n\treturn size;\n}\n\nsize_t sja1110_vl_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t       enum packing_op op)\n{\n\tstruct sja1105_vl_lookup_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_LOOKUP_ENTRY;\n\n\tif (entry->format == SJA1105_VL_FORMAT_PSFP) {\n\t\t \n\t\tsja1105_packing(buf, &entry->destports,\n\t\t\t\t94, 84, size, op);\n\t\tsja1105_packing(buf, &entry->iscritical,\n\t\t\t\t83, 83, size, op);\n\t\tsja1105_packing(buf, &entry->macaddr,\n\t\t\t\t82, 35, size, op);\n\t\tsja1105_packing(buf, &entry->vlanid,\n\t\t\t\t34, 23, size, op);\n\t\tsja1105_packing(buf, &entry->port,\n\t\t\t\t22, 19, size, op);\n\t\tsja1105_packing(buf, &entry->vlanprior,\n\t\t\t\t18, 16, size, op);\n\t} else {\n\t\t \n\t\tsja1105_packing(buf, &entry->egrmirr,\n\t\t\t\t94, 84, size, op);\n\t\tsja1105_packing(buf, &entry->ingrmirr,\n\t\t\t\t83, 83, size, op);\n\t\tsja1105_packing(buf, &entry->vlid,\n\t\t\t\t50, 35, size, op);\n\t\tsja1105_packing(buf, &entry->port,\n\t\t\t\t22, 19, size, op);\n\t}\n\treturn size;\n}\n\nstatic size_t sja1105_vl_policing_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\tenum packing_op op)\n{\n\tstruct sja1105_vl_policing_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_POLICING_ENTRY;\n\n\tsja1105_packing(buf, &entry->type,      63, 63, size, op);\n\tsja1105_packing(buf, &entry->maxlen,    62, 52, size, op);\n\tsja1105_packing(buf, &entry->sharindx,  51, 42, size, op);\n\tif (entry->type == 0) {\n\t\tsja1105_packing(buf, &entry->bag,    41, 28, size, op);\n\t\tsja1105_packing(buf, &entry->jitter, 27, 18, size, op);\n\t}\n\treturn size;\n}\n\nsize_t sja1110_vl_policing_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tstruct sja1105_vl_policing_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_VL_POLICING_ENTRY;\n\n\tsja1105_packing(buf, &entry->type,      63, 63, size, op);\n\tsja1105_packing(buf, &entry->maxlen,    62, 52, size, op);\n\tsja1105_packing(buf, &entry->sharindx,  51, 40, size, op);\n\tif (entry->type == 0) {\n\t\tsja1105_packing(buf, &entry->bag,    41, 28, size, op);\n\t\tsja1105_packing(buf, &entry->jitter, 27, 18, size, op);\n\t}\n\treturn size;\n}\n\nsize_t sja1105_vlan_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY;\n\tstruct sja1105_vlan_lookup_entry *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->ving_mirr,  63, 59, size, op);\n\tsja1105_packing(buf, &entry->vegr_mirr,  58, 54, size, op);\n\tsja1105_packing(buf, &entry->vmemb_port, 53, 49, size, op);\n\tsja1105_packing(buf, &entry->vlan_bc,    48, 44, size, op);\n\tsja1105_packing(buf, &entry->tag_port,   43, 39, size, op);\n\tsja1105_packing(buf, &entry->vlanid,     38, 27, size, op);\n\treturn size;\n}\n\nsize_t sja1110_vlan_lookup_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tstruct sja1105_vlan_lookup_entry *entry = entry_ptr;\n\tconst size_t size = SJA1110_SIZE_VLAN_LOOKUP_ENTRY;\n\n\tsja1105_packing(buf, &entry->ving_mirr,  95, 85, size, op);\n\tsja1105_packing(buf, &entry->vegr_mirr,  84, 74, size, op);\n\tsja1105_packing(buf, &entry->vmemb_port, 73, 63, size, op);\n\tsja1105_packing(buf, &entry->vlan_bc,    62, 52, size, op);\n\tsja1105_packing(buf, &entry->tag_port,   51, 41, size, op);\n\tsja1105_packing(buf, &entry->type_entry, 40, 39, size, op);\n\tsja1105_packing(buf, &entry->vlanid,     38, 27, size, op);\n\treturn size;\n}\n\nstatic size_t sja1105_xmii_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\tenum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_XMII_PARAMS_ENTRY;\n\tstruct sja1105_xmii_params_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 17; i < 5; i++, offset += 3) {\n\t\tsja1105_packing(buf, &entry->xmii_mode[i],\n\t\t\t\toffset + 1, offset + 0, size, op);\n\t\tsja1105_packing(buf, &entry->phy_mac[i],\n\t\t\t\toffset + 2, offset + 2, size, op);\n\t}\n\treturn size;\n}\n\nsize_t sja1110_xmii_params_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t enum packing_op op)\n{\n\tconst size_t size = SJA1110_SIZE_XMII_PARAMS_ENTRY;\n\tstruct sja1105_xmii_params_entry *entry = entry_ptr;\n\tint offset, i;\n\n\tfor (i = 0, offset = 20; i < SJA1110_NUM_PORTS; i++, offset += 4) {\n\t\tsja1105_packing(buf, &entry->xmii_mode[i],\n\t\t\t\toffset + 1, offset + 0, size, op);\n\t\tsja1105_packing(buf, &entry->phy_mac[i],\n\t\t\t\toffset + 2, offset + 2, size, op);\n\t\tsja1105_packing(buf, &entry->special[i],\n\t\t\t\toffset + 3, offset + 3, size, op);\n\t}\n\treturn size;\n}\n\nsize_t sja1105_retagging_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t       enum packing_op op)\n{\n\tstruct sja1105_retagging_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_RETAGGING_ENTRY;\n\n\tsja1105_packing(buf, &entry->egr_port,       63, 59, size, op);\n\tsja1105_packing(buf, &entry->ing_port,       58, 54, size, op);\n\tsja1105_packing(buf, &entry->vlan_ing,       53, 42, size, op);\n\tsja1105_packing(buf, &entry->vlan_egr,       41, 30, size, op);\n\tsja1105_packing(buf, &entry->do_not_learn,   29, 29, size, op);\n\tsja1105_packing(buf, &entry->use_dest_ports, 28, 28, size, op);\n\tsja1105_packing(buf, &entry->destports,      27, 23, size, op);\n\treturn size;\n}\n\nsize_t sja1110_retagging_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t       enum packing_op op)\n{\n\tstruct sja1105_retagging_entry *entry = entry_ptr;\n\tconst size_t size = SJA1105_SIZE_RETAGGING_ENTRY;\n\n\tsja1105_packing(buf, &entry->egr_port,       63, 53, size, op);\n\tsja1105_packing(buf, &entry->ing_port,       52, 42, size, op);\n\tsja1105_packing(buf, &entry->vlan_ing,       41, 30, size, op);\n\tsja1105_packing(buf, &entry->vlan_egr,       29, 18, size, op);\n\tsja1105_packing(buf, &entry->do_not_learn,   17, 17, size, op);\n\tsja1105_packing(buf, &entry->use_dest_ports, 16, 16, size, op);\n\tsja1105_packing(buf, &entry->destports,      15, 5, size, op);\n\treturn size;\n}\n\nstatic size_t sja1110_pcp_remapping_entry_packing(void *buf, void *entry_ptr,\n\t\t\t\t\t\t  enum packing_op op)\n{\n\tstruct sja1110_pcp_remapping_entry *entry = entry_ptr;\n\tconst size_t size = SJA1110_SIZE_PCP_REMAPPING_ENTRY;\n\tint offset, i;\n\n\tfor (i = 0, offset = 8; i < SJA1105_NUM_TC; i++, offset += 3)\n\t\tsja1105_packing(buf, &entry->egrpcp[i],\n\t\t\t\toffset + 2, offset + 0, size, op);\n\n\treturn size;\n}\n\nsize_t sja1105_table_header_packing(void *buf, void *entry_ptr,\n\t\t\t\t    enum packing_op op)\n{\n\tconst size_t size = SJA1105_SIZE_TABLE_HEADER;\n\tstruct sja1105_table_header *entry = entry_ptr;\n\n\tsja1105_packing(buf, &entry->block_id, 31, 24, size, op);\n\tsja1105_packing(buf, &entry->len,      55, 32, size, op);\n\tsja1105_packing(buf, &entry->crc,      95, 64, size, op);\n\treturn size;\n}\n\n \nvoid\nsja1105_table_header_pack_with_crc(void *buf, struct sja1105_table_header *hdr)\n{\n\t \n\tmemset(buf, 0, SJA1105_SIZE_TABLE_HEADER);\n\tsja1105_table_header_packing(buf, hdr, PACK);\n\thdr->crc = sja1105_crc32(buf, SJA1105_SIZE_TABLE_HEADER - 4);\n\tsja1105_pack(buf + SJA1105_SIZE_TABLE_HEADER - 4, &hdr->crc, 31, 0, 4);\n}\n\nstatic void sja1105_table_write_crc(u8 *table_start, u8 *crc_ptr)\n{\n\tu64 computed_crc;\n\tint len_bytes;\n\n\tlen_bytes = (uintptr_t)(crc_ptr - table_start);\n\tcomputed_crc = sja1105_crc32(table_start, len_bytes);\n\tsja1105_pack(crc_ptr, &computed_crc, 31, 0, 4);\n}\n\n \nstatic u64 blk_id_map[BLK_IDX_MAX] = {\n\t[BLK_IDX_SCHEDULE] = BLKID_SCHEDULE,\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS] = BLKID_SCHEDULE_ENTRY_POINTS,\n\t[BLK_IDX_VL_LOOKUP] = BLKID_VL_LOOKUP,\n\t[BLK_IDX_VL_POLICING] = BLKID_VL_POLICING,\n\t[BLK_IDX_VL_FORWARDING] = BLKID_VL_FORWARDING,\n\t[BLK_IDX_L2_LOOKUP] = BLKID_L2_LOOKUP,\n\t[BLK_IDX_L2_POLICING] = BLKID_L2_POLICING,\n\t[BLK_IDX_VLAN_LOOKUP] = BLKID_VLAN_LOOKUP,\n\t[BLK_IDX_L2_FORWARDING] = BLKID_L2_FORWARDING,\n\t[BLK_IDX_MAC_CONFIG] = BLKID_MAC_CONFIG,\n\t[BLK_IDX_SCHEDULE_PARAMS] = BLKID_SCHEDULE_PARAMS,\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS] = BLKID_SCHEDULE_ENTRY_POINTS_PARAMS,\n\t[BLK_IDX_VL_FORWARDING_PARAMS] = BLKID_VL_FORWARDING_PARAMS,\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = BLKID_L2_LOOKUP_PARAMS,\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = BLKID_L2_FORWARDING_PARAMS,\n\t[BLK_IDX_AVB_PARAMS] = BLKID_AVB_PARAMS,\n\t[BLK_IDX_GENERAL_PARAMS] = BLKID_GENERAL_PARAMS,\n\t[BLK_IDX_RETAGGING] = BLKID_RETAGGING,\n\t[BLK_IDX_XMII_PARAMS] = BLKID_XMII_PARAMS,\n\t[BLK_IDX_PCP_REMAPPING] = BLKID_PCP_REMAPPING,\n};\n\nconst char *sja1105_static_config_error_msg[] = {\n\t[SJA1105_CONFIG_OK] = \"\",\n\t[SJA1105_TTETHERNET_NOT_SUPPORTED] =\n\t\t\"schedule-table present, but TTEthernet is \"\n\t\t\"only supported on T and Q/S\",\n\t[SJA1105_INCORRECT_TTETHERNET_CONFIGURATION] =\n\t\t\"schedule-table present, but one of \"\n\t\t\"schedule-entry-points-table, schedule-parameters-table or \"\n\t\t\"schedule-entry-points-parameters table is empty\",\n\t[SJA1105_INCORRECT_VIRTUAL_LINK_CONFIGURATION] =\n\t\t\"vl-lookup-table present, but one of vl-policing-table, \"\n\t\t\"vl-forwarding-table or vl-forwarding-parameters-table is empty\",\n\t[SJA1105_MISSING_L2_POLICING_TABLE] =\n\t\t\"l2-policing-table needs to have at least one entry\",\n\t[SJA1105_MISSING_L2_FORWARDING_TABLE] =\n\t\t\"l2-forwarding-table is either missing or incomplete\",\n\t[SJA1105_MISSING_L2_FORWARDING_PARAMS_TABLE] =\n\t\t\"l2-forwarding-parameters-table is missing\",\n\t[SJA1105_MISSING_GENERAL_PARAMS_TABLE] =\n\t\t\"general-parameters-table is missing\",\n\t[SJA1105_MISSING_VLAN_TABLE] =\n\t\t\"vlan-lookup-table needs to have at least the default untagged VLAN\",\n\t[SJA1105_MISSING_XMII_TABLE] =\n\t\t\"xmii-table is missing\",\n\t[SJA1105_MISSING_MAC_TABLE] =\n\t\t\"mac-configuration-table needs to contain an entry for each port\",\n\t[SJA1105_OVERCOMMITTED_FRAME_MEMORY] =\n\t\t\"Not allowed to overcommit frame memory. L2 memory partitions \"\n\t\t\"and VL memory partitions share the same space. The sum of all \"\n\t\t\"16 memory partitions is not allowed to be larger than 929 \"\n\t\t\"128-byte blocks (or 910 with retagging). Please adjust \"\n\t\t\"l2-forwarding-parameters-table.part_spc and/or \"\n\t\t\"vl-forwarding-parameters-table.partspc.\",\n};\n\nstatic sja1105_config_valid_t\nstatic_config_check_memory_size(const struct sja1105_table *tables, int max_mem)\n{\n\tconst struct sja1105_l2_forwarding_params_entry *l2_fwd_params;\n\tconst struct sja1105_vl_forwarding_params_entry *vl_fwd_params;\n\tint i, mem = 0;\n\n\tl2_fwd_params = tables[BLK_IDX_L2_FORWARDING_PARAMS].entries;\n\n\tfor (i = 0; i < 8; i++)\n\t\tmem += l2_fwd_params->part_spc[i];\n\n\tif (tables[BLK_IDX_VL_FORWARDING_PARAMS].entry_count) {\n\t\tvl_fwd_params = tables[BLK_IDX_VL_FORWARDING_PARAMS].entries;\n\t\tfor (i = 0; i < 8; i++)\n\t\t\tmem += vl_fwd_params->partspc[i];\n\t}\n\n\tif (tables[BLK_IDX_RETAGGING].entry_count)\n\t\tmax_mem -= SJA1105_FRAME_MEMORY_RETAGGING_OVERHEAD;\n\n\tif (mem > max_mem)\n\t\treturn SJA1105_OVERCOMMITTED_FRAME_MEMORY;\n\n\treturn SJA1105_CONFIG_OK;\n}\n\nsja1105_config_valid_t\nsja1105_static_config_check_valid(const struct sja1105_static_config *config,\n\t\t\t\t  int max_mem)\n{\n\tconst struct sja1105_table *tables = config->tables;\n#define IS_FULL(blk_idx) \\\n\t(tables[blk_idx].entry_count == tables[blk_idx].ops->max_entry_count)\n\n\tif (tables[BLK_IDX_SCHEDULE].entry_count) {\n\t\tif (!tables[BLK_IDX_SCHEDULE].ops->max_entry_count)\n\t\t\treturn SJA1105_TTETHERNET_NOT_SUPPORTED;\n\n\t\tif (tables[BLK_IDX_SCHEDULE_ENTRY_POINTS].entry_count == 0)\n\t\t\treturn SJA1105_INCORRECT_TTETHERNET_CONFIGURATION;\n\n\t\tif (!IS_FULL(BLK_IDX_SCHEDULE_PARAMS))\n\t\t\treturn SJA1105_INCORRECT_TTETHERNET_CONFIGURATION;\n\n\t\tif (!IS_FULL(BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS))\n\t\t\treturn SJA1105_INCORRECT_TTETHERNET_CONFIGURATION;\n\t}\n\tif (tables[BLK_IDX_VL_LOOKUP].entry_count) {\n\t\tstruct sja1105_vl_lookup_entry *vl_lookup;\n\t\tbool has_critical_links = false;\n\t\tint i;\n\n\t\tvl_lookup = tables[BLK_IDX_VL_LOOKUP].entries;\n\n\t\tfor (i = 0; i < tables[BLK_IDX_VL_LOOKUP].entry_count; i++) {\n\t\t\tif (vl_lookup[i].iscritical) {\n\t\t\t\thas_critical_links = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (tables[BLK_IDX_VL_POLICING].entry_count == 0 &&\n\t\t    has_critical_links)\n\t\t\treturn SJA1105_INCORRECT_VIRTUAL_LINK_CONFIGURATION;\n\n\t\tif (tables[BLK_IDX_VL_FORWARDING].entry_count == 0 &&\n\t\t    has_critical_links)\n\t\t\treturn SJA1105_INCORRECT_VIRTUAL_LINK_CONFIGURATION;\n\n\t\tif (tables[BLK_IDX_VL_FORWARDING_PARAMS].entry_count == 0 &&\n\t\t    has_critical_links)\n\t\t\treturn SJA1105_INCORRECT_VIRTUAL_LINK_CONFIGURATION;\n\t}\n\n\tif (tables[BLK_IDX_L2_POLICING].entry_count == 0)\n\t\treturn SJA1105_MISSING_L2_POLICING_TABLE;\n\n\tif (tables[BLK_IDX_VLAN_LOOKUP].entry_count == 0)\n\t\treturn SJA1105_MISSING_VLAN_TABLE;\n\n\tif (!IS_FULL(BLK_IDX_L2_FORWARDING))\n\t\treturn SJA1105_MISSING_L2_FORWARDING_TABLE;\n\n\tif (!IS_FULL(BLK_IDX_MAC_CONFIG))\n\t\treturn SJA1105_MISSING_MAC_TABLE;\n\n\tif (!IS_FULL(BLK_IDX_L2_FORWARDING_PARAMS))\n\t\treturn SJA1105_MISSING_L2_FORWARDING_PARAMS_TABLE;\n\n\tif (!IS_FULL(BLK_IDX_GENERAL_PARAMS))\n\t\treturn SJA1105_MISSING_GENERAL_PARAMS_TABLE;\n\n\tif (!IS_FULL(BLK_IDX_XMII_PARAMS))\n\t\treturn SJA1105_MISSING_XMII_TABLE;\n\n\treturn static_config_check_memory_size(tables, max_mem);\n#undef IS_FULL\n}\n\nvoid\nsja1105_static_config_pack(void *buf, struct sja1105_static_config *config)\n{\n\tstruct sja1105_table_header header = {0};\n\tenum sja1105_blk_idx i;\n\tchar *p = buf;\n\tint j;\n\n\tsja1105_pack(p, &config->device_id, 31, 0, 4);\n\tp += SJA1105_SIZE_DEVICE_ID;\n\n\tfor (i = 0; i < BLK_IDX_MAX; i++) {\n\t\tconst struct sja1105_table *table;\n\t\tchar *table_start;\n\n\t\ttable = &config->tables[i];\n\t\tif (!table->entry_count)\n\t\t\tcontinue;\n\n\t\theader.block_id = blk_id_map[i];\n\t\theader.len = table->entry_count *\n\t\t\t     table->ops->packed_entry_size / 4;\n\t\tsja1105_table_header_pack_with_crc(p, &header);\n\t\tp += SJA1105_SIZE_TABLE_HEADER;\n\t\ttable_start = p;\n\t\tfor (j = 0; j < table->entry_count; j++) {\n\t\t\tu8 *entry_ptr = table->entries;\n\n\t\t\tentry_ptr += j * table->ops->unpacked_entry_size;\n\t\t\tmemset(p, 0, table->ops->packed_entry_size);\n\t\t\ttable->ops->packing(p, entry_ptr, PACK);\n\t\t\tp += table->ops->packed_entry_size;\n\t\t}\n\t\tsja1105_table_write_crc(table_start, p);\n\t\tp += 4;\n\t}\n\t \n\theader.block_id = 0;\n\theader.len = 0;\n\theader.crc = 0xDEADBEEF;\n\tmemset(p, 0, SJA1105_SIZE_TABLE_HEADER);\n\tsja1105_table_header_packing(p, &header, PACK);\n}\n\nsize_t\nsja1105_static_config_get_length(const struct sja1105_static_config *config)\n{\n\tunsigned int sum;\n\tunsigned int header_count;\n\tenum sja1105_blk_idx i;\n\n\t \n\theader_count = 1;\n\tsum = SJA1105_SIZE_DEVICE_ID;\n\n\t \n\tfor (i = 0; i < BLK_IDX_MAX; i++) {\n\t\tconst struct sja1105_table *table;\n\n\t\ttable = &config->tables[i];\n\t\tif (table->entry_count)\n\t\t\theader_count++;\n\n\t\tsum += table->ops->packed_entry_size * table->entry_count;\n\t}\n\t \n\tsum += header_count * (SJA1105_SIZE_TABLE_HEADER + 4);\n\t \n\tsum -= 4;\n\n\treturn sum;\n}\n\n \n\n \nconst struct sja1105_table_ops sja1105e_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105et_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105et_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105et_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105et_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105et_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1105t_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_SCHEDULE] = {\n\t\t.packing = sja1105_schedule_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS] = {\n\t\t.packing = sja1105_schedule_entry_points_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_COUNT,\n\t},\n\t[BLK_IDX_VL_LOOKUP] = {\n\t\t.packing = sja1105_vl_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_VL_POLICING] = {\n\t\t.packing = sja1105_vl_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING] = {\n\t\t.packing = sja1105_vl_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105et_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105et_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_PARAMS] = {\n\t\t.packing = sja1105_schedule_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS] = {\n\t\t.packing = sja1105_schedule_entry_points_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_vl_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105et_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105et_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105et_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105ET_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1105p_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105pqrs_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105pqrs_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105pqrs_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105pqrs_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105pqrs_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1105q_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_SCHEDULE] = {\n\t\t.packing = sja1105_schedule_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS] = {\n\t\t.packing = sja1105_schedule_entry_points_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_COUNT,\n\t},\n\t[BLK_IDX_VL_LOOKUP] = {\n\t\t.packing = sja1105_vl_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_VL_POLICING] = {\n\t\t.packing = sja1105_vl_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING] = {\n\t\t.packing = sja1105_vl_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105pqrs_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105pqrs_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_PARAMS] = {\n\t\t.packing = sja1105_schedule_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS] = {\n\t\t.packing = sja1105_schedule_entry_points_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_vl_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105pqrs_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105pqrs_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105pqrs_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1105r_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105pqrs_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105pqrs_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105pqrs_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105pqrs_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105pqrs_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1105s_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_SCHEDULE] = {\n\t\t.packing = sja1105_schedule_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS] = {\n\t\t.packing = sja1105_schedule_entry_points_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_COUNT,\n\t},\n\t[BLK_IDX_VL_LOOKUP] = {\n\t\t.packing = sja1105_vl_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_VL_POLICING] = {\n\t\t.packing = sja1105_vl_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING] = {\n\t\t.packing = sja1105_vl_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1105pqrs_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1105_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1105_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1105_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1105pqrs_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_PARAMS] = {\n\t\t.packing = sja1105_schedule_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS] = {\n\t\t.packing = sja1105_schedule_entry_points_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_vl_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1105pqrs_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1105_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105pqrs_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1105pqrs_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1105_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1105_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n};\n\n \nconst struct sja1105_table_ops sja1110_table_ops[BLK_IDX_MAX] = {\n\t[BLK_IDX_SCHEDULE] = {\n\t\t.packing = sja1110_schedule_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_SCHEDULE_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_SCHEDULE_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS] = {\n\t\t.packing = sja1110_schedule_entry_points_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_SCHEDULE_ENTRY_POINTS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_COUNT,\n\t},\n\t[BLK_IDX_VL_LOOKUP] = {\n\t\t.packing = sja1110_vl_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_lookup_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_VL_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_VL_POLICING] = {\n\t\t.packing = sja1110_vl_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_VL_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING] = {\n\t\t.packing = sja1110_vl_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_VL_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP] = {\n\t\t.packing = sja1110_l2_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_L2_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_POLICING] = {\n\t\t.packing = sja1110_l2_policing_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_policing_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_POLICING_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_L2_POLICING_COUNT,\n\t},\n\t[BLK_IDX_VLAN_LOOKUP] = {\n\t\t.packing = sja1110_vlan_lookup_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vlan_lookup_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_VLAN_LOOKUP_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VLAN_LOOKUP_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING] = {\n\t\t.packing = sja1110_l2_forwarding_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_L2_FORWARDING_COUNT,\n\t},\n\t[BLK_IDX_MAC_CONFIG] = {\n\t\t.packing = sja1110_mac_config_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_mac_config_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_MAC_CONFIG_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_MAC_CONFIG_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_PARAMS] = {\n\t\t.packing = sja1110_schedule_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_SCHEDULE_ENTRY_POINTS_PARAMS] = {\n\t\t.packing = sja1105_schedule_entry_points_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_schedule_entry_points_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_SCHEDULE_ENTRY_POINTS_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_SCHEDULE_ENTRY_POINTS_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_VL_FORWARDING_PARAMS] = {\n\t\t.packing = sja1110_vl_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_vl_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_VL_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_VL_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_LOOKUP_PARAMS] = {\n\t\t.packing = sja1110_l2_lookup_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_lookup_params_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_L2_LOOKUP_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_LOOKUP_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_L2_FORWARDING_PARAMS] = {\n\t\t.packing = sja1110_l2_forwarding_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_l2_forwarding_params_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_L2_FORWARDING_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_L2_FORWARDING_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_AVB_PARAMS] = {\n\t\t.packing = sja1105pqrs_avb_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_avb_params_entry),\n\t\t.packed_entry_size = SJA1105PQRS_SIZE_AVB_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_AVB_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_GENERAL_PARAMS] = {\n\t\t.packing = sja1110_general_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_general_params_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_GENERAL_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_GENERAL_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_RETAGGING] = {\n\t\t.packing = sja1110_retagging_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_retagging_entry),\n\t\t.packed_entry_size = SJA1105_SIZE_RETAGGING_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_RETAGGING_COUNT,\n\t},\n\t[BLK_IDX_XMII_PARAMS] = {\n\t\t.packing = sja1110_xmii_params_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1105_xmii_params_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_XMII_PARAMS_ENTRY,\n\t\t.max_entry_count = SJA1105_MAX_XMII_PARAMS_COUNT,\n\t},\n\t[BLK_IDX_PCP_REMAPPING] = {\n\t\t.packing = sja1110_pcp_remapping_entry_packing,\n\t\t.unpacked_entry_size = sizeof(struct sja1110_pcp_remapping_entry),\n\t\t.packed_entry_size = SJA1110_SIZE_PCP_REMAPPING_ENTRY,\n\t\t.max_entry_count = SJA1110_MAX_PCP_REMAPPING_COUNT,\n\t},\n};\n\nint sja1105_static_config_init(struct sja1105_static_config *config,\n\t\t\t       const struct sja1105_table_ops *static_ops,\n\t\t\t       u64 device_id)\n{\n\tenum sja1105_blk_idx i;\n\n\t*config = (struct sja1105_static_config) {0};\n\n\t \n\tfor (i = 0; i < BLK_IDX_MAX; i++)\n\t\tconfig->tables[i].ops = &static_ops[i];\n\n\tconfig->device_id = device_id;\n\treturn 0;\n}\n\nvoid sja1105_static_config_free(struct sja1105_static_config *config)\n{\n\tenum sja1105_blk_idx i;\n\n\tfor (i = 0; i < BLK_IDX_MAX; i++) {\n\t\tif (config->tables[i].entry_count) {\n\t\t\tkfree(config->tables[i].entries);\n\t\t\tconfig->tables[i].entry_count = 0;\n\t\t}\n\t}\n}\n\nint sja1105_table_delete_entry(struct sja1105_table *table, int i)\n{\n\tsize_t entry_size = table->ops->unpacked_entry_size;\n\tu8 *entries = table->entries;\n\n\tif (i > table->entry_count)\n\t\treturn -ERANGE;\n\n\tmemmove(entries + i * entry_size, entries + (i + 1) * entry_size,\n\t\t(table->entry_count - i) * entry_size);\n\n\ttable->entry_count--;\n\n\treturn 0;\n}\n\n \nint sja1105_table_resize(struct sja1105_table *table, size_t new_count)\n{\n\tsize_t entry_size = table->ops->unpacked_entry_size;\n\tvoid *new_entries, *old_entries = table->entries;\n\n\tif (new_count > table->ops->max_entry_count)\n\t\treturn -ERANGE;\n\n\tnew_entries = kcalloc(new_count, entry_size, GFP_KERNEL);\n\tif (!new_entries)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_entries, old_entries, min(new_count, table->entry_count) *\n\t\tentry_size);\n\n\ttable->entries = new_entries;\n\ttable->entry_count = new_count;\n\tkfree(old_entries);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}