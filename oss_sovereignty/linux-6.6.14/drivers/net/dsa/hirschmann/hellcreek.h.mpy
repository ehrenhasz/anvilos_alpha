{
  "module_name": "hellcreek.h",
  "hash_id": "a5e085ecfc90a8f0621174942fef4717e5f6d68ad6d056d501312108c157c548",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/dsa/hirschmann/hellcreek.h",
  "human_readable_source": " \n \n\n#ifndef _HELLCREEK_H_\n#define _HELLCREEK_H_\n\n#include <linux/bitmap.h>\n#include <linux/bitops.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/mutex.h>\n#include <linux/workqueue.h>\n#include <linux/leds.h>\n#include <linux/platform_data/hirschmann-hellcreek.h>\n#include <linux/ptp_clock_kernel.h>\n#include <linux/timecounter.h>\n#include <net/dsa.h>\n#include <net/pkt_sched.h>\n\n \n#define CPU_PORT\t\t\t0\n#define TUNNEL_PORT\t\t\t1\n\n#define HELLCREEK_VLAN_NO_MEMBER\t0x0\n#define HELLCREEK_VLAN_UNTAGGED_MEMBER\t0x1\n#define HELLCREEK_VLAN_TAGGED_MEMBER\t0x3\n#define HELLCREEK_NUM_EGRESS_QUEUES\t8\n#define HELLCREEK_DEFAULT_MAX_SDU\t1536\n\n \n#define HR_MODID_C\t\t\t(0 * 2)\n#define HR_REL_L_C\t\t\t(1 * 2)\n#define HR_REL_H_C\t\t\t(2 * 2)\n#define HR_BLD_L_C\t\t\t(3 * 2)\n#define HR_BLD_H_C\t\t\t(4 * 2)\n#define HR_CTRL_C\t\t\t(5 * 2)\n#define HR_CTRL_C_READY\t\t\tBIT(14)\n#define HR_CTRL_C_TRANSITION\t\tBIT(13)\n#define HR_CTRL_C_ENABLE\t\tBIT(0)\n\n#define HR_PSEL\t\t\t\t(0xa6 * 2)\n#define HR_PSEL_PTWSEL_SHIFT\t\t4\n#define HR_PSEL_PTWSEL_MASK\t\tGENMASK(5, 4)\n#define HR_PSEL_PRTCWSEL_SHIFT\t\t0\n#define HR_PSEL_PRTCWSEL_MASK\t\tGENMASK(2, 0)\n\n#define HR_PTCFG\t\t\t(0xa7 * 2)\n#define HR_PTCFG_MLIMIT_EN\t\tBIT(13)\n#define HR_PTCFG_UMC_FLT\t\tBIT(10)\n#define HR_PTCFG_UUC_FLT\t\tBIT(9)\n#define HR_PTCFG_UNTRUST\t\tBIT(8)\n#define HR_PTCFG_TAG_REQUIRED\t\tBIT(7)\n#define HR_PTCFG_PPRIO_SHIFT\t\t4\n#define HR_PTCFG_PPRIO_MASK\t\tGENMASK(6, 4)\n#define HR_PTCFG_INGRESSFLT\t\tBIT(3)\n#define HR_PTCFG_BLOCKED\t\tBIT(2)\n#define HR_PTCFG_LEARNING_EN\t\tBIT(1)\n#define HR_PTCFG_ADMIN_EN\t\tBIT(0)\n\n#define HR_PRTCCFG\t\t\t(0xa8 * 2)\n#define HR_PRTCCFG_PCP_TC_MAP_SHIFT\t0\n#define HR_PRTCCFG_PCP_TC_MAP_MASK\tGENMASK(2, 0)\n\n#define HR_PTPRTCCFG\t\t\t(0xa9 * 2)\n#define HR_PTPRTCCFG_SET_QTRACK\t\tBIT(15)\n#define HR_PTPRTCCFG_REJECT\t\tBIT(14)\n#define HR_PTPRTCCFG_MAXSDU_SHIFT\t0\n#define HR_PTPRTCCFG_MAXSDU_MASK\tGENMASK(10, 0)\n\n#define HR_CSEL\t\t\t\t(0x8d * 2)\n#define HR_CSEL_SHIFT\t\t\t0\n#define HR_CSEL_MASK\t\t\tGENMASK(7, 0)\n#define HR_CRDL\t\t\t\t(0x8e * 2)\n#define HR_CRDH\t\t\t\t(0x8f * 2)\n\n#define HR_SWTRC_CFG\t\t\t(0x90 * 2)\n#define HR_SWTRC0\t\t\t(0x91 * 2)\n#define HR_SWTRC1\t\t\t(0x92 * 2)\n#define HR_PFREE\t\t\t(0x93 * 2)\n#define HR_MFREE\t\t\t(0x94 * 2)\n\n#define HR_FDBAGE\t\t\t(0x97 * 2)\n#define HR_FDBMAX\t\t\t(0x98 * 2)\n#define HR_FDBRDL\t\t\t(0x99 * 2)\n#define HR_FDBRDM\t\t\t(0x9a * 2)\n#define HR_FDBRDH\t\t\t(0x9b * 2)\n\n#define HR_FDBMDRD\t\t\t(0x9c * 2)\n#define HR_FDBMDRD_PORTMASK_SHIFT\t0\n#define HR_FDBMDRD_PORTMASK_MASK\tGENMASK(3, 0)\n#define HR_FDBMDRD_AGE_SHIFT\t\t4\n#define HR_FDBMDRD_AGE_MASK\t\tGENMASK(7, 4)\n#define HR_FDBMDRD_OBT\t\t\tBIT(8)\n#define HR_FDBMDRD_PASS_BLOCKED\t\tBIT(9)\n#define HR_FDBMDRD_STATIC\t\tBIT(11)\n#define HR_FDBMDRD_REPRIO_TC_SHIFT\t12\n#define HR_FDBMDRD_REPRIO_TC_MASK\tGENMASK(14, 12)\n#define HR_FDBMDRD_REPRIO_EN\t\tBIT(15)\n\n#define HR_FDBWDL\t\t\t(0x9d * 2)\n#define HR_FDBWDM\t\t\t(0x9e * 2)\n#define HR_FDBWDH\t\t\t(0x9f * 2)\n#define HR_FDBWRM0\t\t\t(0xa0 * 2)\n#define HR_FDBWRM0_PORTMASK_SHIFT\t0\n#define HR_FDBWRM0_PORTMASK_MASK\tGENMASK(3, 0)\n#define HR_FDBWRM0_OBT\t\t\tBIT(8)\n#define HR_FDBWRM0_PASS_BLOCKED\t\tBIT(9)\n#define HR_FDBWRM0_REPRIO_TC_SHIFT\t12\n#define HR_FDBWRM0_REPRIO_TC_MASK\tGENMASK(14, 12)\n#define HR_FDBWRM0_REPRIO_EN\t\tBIT(15)\n#define HR_FDBWRM1\t\t\t(0xa1 * 2)\n\n#define HR_FDBWRCMD\t\t\t(0xa2 * 2)\n#define HR_FDBWRCMD_FDBDEL\t\tBIT(9)\n\n#define HR_SWCFG\t\t\t(0xa3 * 2)\n#define HR_SWCFG_GM_STATEMD\t\tBIT(15)\n#define HR_SWCFG_LAS_MODE_SHIFT\t\t12\n#define HR_SWCFG_LAS_MODE_MASK\t\tGENMASK(13, 12)\n#define HR_SWCFG_LAS_OFF\t\t(0x00)\n#define HR_SWCFG_LAS_ON\t\t\t(0x01)\n#define HR_SWCFG_LAS_STATIC\t\t(0x10)\n#define HR_SWCFG_CT_EN\t\t\tBIT(11)\n#define HR_SWCFG_VLAN_UNAWARE\t\tBIT(10)\n#define HR_SWCFG_ALWAYS_OBT\t\tBIT(9)\n#define HR_SWCFG_FDBAGE_EN\t\tBIT(5)\n#define HR_SWCFG_FDBLRN_EN\t\tBIT(4)\n\n#define HR_SWSTAT\t\t\t(0xa4 * 2)\n#define HR_SWSTAT_FAIL\t\t\tBIT(4)\n#define HR_SWSTAT_BUSY\t\t\tBIT(0)\n\n#define HR_SWCMD\t\t\t(0xa5 * 2)\n#define HW_SWCMD_FLUSH\t\t\tBIT(0)\n\n#define HR_VIDCFG\t\t\t(0xaa * 2)\n#define HR_VIDCFG_VID_SHIFT\t\t0\n#define HR_VIDCFG_VID_MASK\t\tGENMASK(11, 0)\n#define HR_VIDCFG_PVID\t\t\tBIT(12)\n\n#define HR_VIDMBRCFG\t\t\t(0xab * 2)\n#define HR_VIDMBRCFG_P0MBR_SHIFT\t0\n#define HR_VIDMBRCFG_P0MBR_MASK\t\tGENMASK(1, 0)\n#define HR_VIDMBRCFG_P1MBR_SHIFT\t2\n#define HR_VIDMBRCFG_P1MBR_MASK\t\tGENMASK(3, 2)\n#define HR_VIDMBRCFG_P2MBR_SHIFT\t4\n#define HR_VIDMBRCFG_P2MBR_MASK\t\tGENMASK(5, 4)\n#define HR_VIDMBRCFG_P3MBR_SHIFT\t6\n#define HR_VIDMBRCFG_P3MBR_MASK\t\tGENMASK(7, 6)\n\n#define HR_FEABITS0\t\t\t(0xac * 2)\n#define HR_FEABITS0_FDBBINS_SHIFT\t4\n#define HR_FEABITS0_FDBBINS_MASK\tGENMASK(7, 4)\n#define HR_FEABITS0_PCNT_SHIFT\t\t8\n#define HR_FEABITS0_PCNT_MASK\t\tGENMASK(11, 8)\n#define HR_FEABITS0_MCNT_SHIFT\t\t12\n#define HR_FEABITS0_MCNT_MASK\t\tGENMASK(15, 12)\n\n#define TR_QTRACK\t\t\t(0xb1 * 2)\n#define TR_TGDVER\t\t\t(0xb3 * 2)\n#define TR_TGDVER_REV_MIN_MASK\t\tGENMASK(7, 0)\n#define TR_TGDVER_REV_MIN_SHIFT\t\t0\n#define TR_TGDVER_REV_MAJ_MASK\t\tGENMASK(15, 8)\n#define TR_TGDVER_REV_MAJ_SHIFT\t\t8\n#define TR_TGDSEL\t\t\t(0xb4 * 2)\n#define TR_TGDSEL_TDGSEL_MASK\t\tGENMASK(1, 0)\n#define TR_TGDSEL_TDGSEL_SHIFT\t\t0\n#define TR_TGDCTRL\t\t\t(0xb5 * 2)\n#define TR_TGDCTRL_GATE_EN\t\tBIT(0)\n#define TR_TGDCTRL_CYC_SNAP\t\tBIT(4)\n#define TR_TGDCTRL_SNAP_EST\t\tBIT(5)\n#define TR_TGDCTRL_ADMINGATESTATES_MASK\tGENMASK(15, 8)\n#define TR_TGDCTRL_ADMINGATESTATES_SHIFT\t8\n#define TR_TGDSTAT0\t\t\t(0xb6 * 2)\n#define TR_TGDSTAT1\t\t\t(0xb7 * 2)\n#define TR_ESTWRL\t\t\t(0xb8 * 2)\n#define TR_ESTWRH\t\t\t(0xb9 * 2)\n#define TR_ESTCMD\t\t\t(0xba * 2)\n#define TR_ESTCMD_ESTSEC_MASK\t\tGENMASK(2, 0)\n#define TR_ESTCMD_ESTSEC_SHIFT\t\t0\n#define TR_ESTCMD_ESTARM\t\tBIT(4)\n#define TR_ESTCMD_ESTSWCFG\t\tBIT(5)\n#define TR_EETWRL\t\t\t(0xbb * 2)\n#define TR_EETWRH\t\t\t(0xbc * 2)\n#define TR_EETCMD\t\t\t(0xbd * 2)\n#define TR_EETCMD_EETSEC_MASK\t\tGEMASK(2, 0)\n#define TR_EETCMD_EETSEC_SHIFT\t\t0\n#define TR_EETCMD_EETARM\t\tBIT(4)\n#define TR_CTWRL\t\t\t(0xbe * 2)\n#define TR_CTWRH\t\t\t(0xbf * 2)\n#define TR_LCNSL\t\t\t(0xc1 * 2)\n#define TR_LCNSH\t\t\t(0xc2 * 2)\n#define TR_LCS\t\t\t\t(0xc3 * 2)\n#define TR_GCLDAT\t\t\t(0xc4 * 2)\n#define TR_GCLDAT_GCLWRGATES_MASK\tGENMASK(7, 0)\n#define TR_GCLDAT_GCLWRGATES_SHIFT\t0\n#define TR_GCLDAT_GCLWRLAST\t\tBIT(8)\n#define TR_GCLDAT_GCLOVRI\t\tBIT(9)\n#define TR_GCLTIL\t\t\t(0xc5 * 2)\n#define TR_GCLTIH\t\t\t(0xc6 * 2)\n#define TR_GCLCMD\t\t\t(0xc7 * 2)\n#define TR_GCLCMD_GCLWRADR_MASK\t\tGENMASK(7, 0)\n#define TR_GCLCMD_GCLWRADR_SHIFT\t0\n#define TR_GCLCMD_INIT_GATE_STATES_MASK\tGENMASK(15, 8)\n#define TR_GCLCMD_INIT_GATE_STATES_SHIFT\t8\n\nstruct hellcreek_counter {\n\tu8 offset;\n\tconst char *name;\n};\n\nstruct hellcreek;\n\n \nenum {\n\tHELLCREEK_HWTSTAMP_ENABLED,\n\tHELLCREEK_HWTSTAMP_TX_IN_PROGRESS,\n};\n\n \nstruct hellcreek_port_hwtstamp {\n\t \n\tunsigned long state;\n\n\t \n\tstruct sk_buff_head rx_queue;  \n\n\t \n\tunsigned long tx_tstamp_start;\n\tstruct sk_buff *tx_skb;\n\n\t \n\tstruct hwtstamp_config tstamp_config;\n};\n\nstruct hellcreek_port {\n\tstruct hellcreek *hellcreek;\n\tunsigned long *vlan_dev_bitmap;\n\tint port;\n\tu16 ptcfg;\t\t \n\tu64 *counter_values;\n\n\t \n\tstruct hellcreek_port_hwtstamp port_hwtstamp;\n\n\t \n\tstruct tc_taprio_qopt_offload *current_schedule;\n\tstruct delayed_work schedule_work;\n};\n\nstruct hellcreek_fdb_entry {\n\tsize_t idx;\n\tunsigned char mac[ETH_ALEN];\n\tu8 portmask;\n\tu8 age;\n\tu8 is_obt;\n\tu8 pass_blocked;\n\tu8 is_static;\n\tu8 reprio_tc;\n\tu8 reprio_en;\n};\n\nstruct hellcreek {\n\tconst struct hellcreek_platform_data *pdata;\n\tstruct device *dev;\n\tstruct dsa_switch *ds;\n\tstruct ptp_clock *ptp_clock;\n\tstruct ptp_clock_info ptp_clock_info;\n\tstruct hellcreek_port *ports;\n\tstruct delayed_work overflow_work;\n\tstruct led_classdev led_is_gm;\n\tstruct led_classdev led_sync_good;\n\tstruct mutex reg_lock;\t \n\tstruct mutex vlan_lock;\t \n\tstruct mutex ptp_lock;\t \n\tstruct devlink_region *vlan_region;\n\tstruct devlink_region *fdb_region;\n\tvoid __iomem *base;\n\tvoid __iomem *ptp_base;\n\tu16 swcfg;\t\t \n\tu8 *vidmbrcfg;\t\t \n\tu64 seconds;\t\t \n\tu64 last_ts;\t\t \n\tu16 status_out;\t\t \n\tsize_t fdb_entries;\n};\n\n \n#define HELLCREEK_SCHEDULE_PERIOD\t(2 * HZ)\n#define dw_to_hellcreek_port(dw)\t\t\t\t\\\n\tcontainer_of(dw, struct hellcreek_port, schedule_work)\n\n \nenum hellcreek_devlink_resource_id {\n\tHELLCREEK_DEVLINK_PARAM_ID_VLAN_TABLE,\n\tHELLCREEK_DEVLINK_PARAM_ID_FDB_TABLE,\n};\n\nstruct hellcreek_devlink_vlan_entry {\n\tu16 vid;\n\tu16 member;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}