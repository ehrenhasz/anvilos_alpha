{
  "module_name": "mii.c",
  "hash_id": "237a51d7c96ad2bc1c84d2ecb80589105774884d9a5ef6829163aa8fe821b3e0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/mii.c",
  "human_readable_source": " \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/netdevice.h>\n#include <linux/ethtool.h>\n#include <linux/mii.h>\n\nstatic u32 mii_get_an(struct mii_if_info *mii, u16 addr)\n{\n\tint advert;\n\n\tadvert = mii->mdio_read(mii->dev, mii->phy_id, addr);\n\n\treturn mii_lpa_to_ethtool_lpa_t(advert);\n}\n\n \nvoid mii_ethtool_gset(struct mii_if_info *mii, struct ethtool_cmd *ecmd)\n{\n\tstruct net_device *dev = mii->dev;\n\tu16 bmcr, bmsr, ctrl1000 = 0, stat1000 = 0;\n\tu32 nego;\n\n\tecmd->supported =\n\t    (SUPPORTED_10baseT_Half | SUPPORTED_10baseT_Full |\n\t     SUPPORTED_100baseT_Half | SUPPORTED_100baseT_Full |\n\t     SUPPORTED_Autoneg | SUPPORTED_TP | SUPPORTED_MII);\n\tif (mii->supports_gmii)\n\t\tecmd->supported |= SUPPORTED_1000baseT_Half |\n\t\t\tSUPPORTED_1000baseT_Full;\n\n\t \n\tecmd->port = PORT_MII;\n\n\t \n\tecmd->transceiver = XCVR_INTERNAL;\n\n\t \n\tecmd->phy_address = mii->phy_id;\n\tecmd->mdio_support = ETH_MDIO_SUPPORTS_C22;\n\n\tecmd->advertising = ADVERTISED_TP | ADVERTISED_MII;\n\n\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\tbmsr = mii->mdio_read(dev, mii->phy_id, MII_BMSR);\n\tif (mii->supports_gmii) {\n\t\tctrl1000 = mii->mdio_read(dev, mii->phy_id, MII_CTRL1000);\n\t\tstat1000 = mii->mdio_read(dev, mii->phy_id, MII_STAT1000);\n\t}\n\n\tecmd->advertising |= mii_get_an(mii, MII_ADVERTISE);\n\tif (mii->supports_gmii)\n\t\tecmd->advertising |=\n\t\t\tmii_ctrl1000_to_ethtool_adv_t(ctrl1000);\n\n\tif (bmcr & BMCR_ANENABLE) {\n\t\tecmd->advertising |= ADVERTISED_Autoneg;\n\t\tecmd->autoneg = AUTONEG_ENABLE;\n\n\t\tif (bmsr & BMSR_ANEGCOMPLETE) {\n\t\t\tecmd->lp_advertising = mii_get_an(mii, MII_LPA);\n\t\t\tecmd->lp_advertising |=\n\t\t\t\t\tmii_stat1000_to_ethtool_lpa_t(stat1000);\n\t\t} else {\n\t\t\tecmd->lp_advertising = 0;\n\t\t}\n\n\t\tnego = ecmd->advertising & ecmd->lp_advertising;\n\n\t\tif (nego & (ADVERTISED_1000baseT_Full |\n\t\t\t    ADVERTISED_1000baseT_Half)) {\n\t\t\tethtool_cmd_speed_set(ecmd, SPEED_1000);\n\t\t\tecmd->duplex = !!(nego & ADVERTISED_1000baseT_Full);\n\t\t} else if (nego & (ADVERTISED_100baseT_Full |\n\t\t\t\t   ADVERTISED_100baseT_Half)) {\n\t\t\tethtool_cmd_speed_set(ecmd, SPEED_100);\n\t\t\tecmd->duplex = !!(nego & ADVERTISED_100baseT_Full);\n\t\t} else {\n\t\t\tethtool_cmd_speed_set(ecmd, SPEED_10);\n\t\t\tecmd->duplex = !!(nego & ADVERTISED_10baseT_Full);\n\t\t}\n\t} else {\n\t\tecmd->autoneg = AUTONEG_DISABLE;\n\n\t\tethtool_cmd_speed_set(ecmd,\n\t\t\t\t      ((bmcr & BMCR_SPEED1000 &&\n\t\t\t\t\t(bmcr & BMCR_SPEED100) == 0) ?\n\t\t\t\t       SPEED_1000 :\n\t\t\t\t       ((bmcr & BMCR_SPEED100) ?\n\t\t\t\t\tSPEED_100 : SPEED_10)));\n\t\tecmd->duplex = (bmcr & BMCR_FULLDPLX) ? DUPLEX_FULL : DUPLEX_HALF;\n\t}\n\n\tmii->full_duplex = ecmd->duplex;\n\n\t \n}\n\n \nvoid mii_ethtool_get_link_ksettings(struct mii_if_info *mii,\n\t\t\t\t    struct ethtool_link_ksettings *cmd)\n{\n\tstruct net_device *dev = mii->dev;\n\tu16 bmcr, bmsr, ctrl1000 = 0, stat1000 = 0;\n\tu32 nego, supported, advertising, lp_advertising;\n\n\tsupported = (SUPPORTED_10baseT_Half | SUPPORTED_10baseT_Full |\n\t\t     SUPPORTED_100baseT_Half | SUPPORTED_100baseT_Full |\n\t\t     SUPPORTED_Autoneg | SUPPORTED_TP | SUPPORTED_MII);\n\tif (mii->supports_gmii)\n\t\tsupported |= SUPPORTED_1000baseT_Half |\n\t\t\tSUPPORTED_1000baseT_Full;\n\n\t \n\tcmd->base.port = PORT_MII;\n\n\t \n\tcmd->base.phy_address = mii->phy_id;\n\tcmd->base.mdio_support = ETH_MDIO_SUPPORTS_C22;\n\n\tadvertising = ADVERTISED_TP | ADVERTISED_MII;\n\n\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\tbmsr = mii->mdio_read(dev, mii->phy_id, MII_BMSR);\n\tif (mii->supports_gmii) {\n\t\tctrl1000 = mii->mdio_read(dev, mii->phy_id, MII_CTRL1000);\n\t\tstat1000 = mii->mdio_read(dev, mii->phy_id, MII_STAT1000);\n\t}\n\n\tadvertising |= mii_get_an(mii, MII_ADVERTISE);\n\tif (mii->supports_gmii)\n\t\tadvertising |= mii_ctrl1000_to_ethtool_adv_t(ctrl1000);\n\n\tif (bmcr & BMCR_ANENABLE) {\n\t\tadvertising |= ADVERTISED_Autoneg;\n\t\tcmd->base.autoneg = AUTONEG_ENABLE;\n\n\t\tif (bmsr & BMSR_ANEGCOMPLETE) {\n\t\t\tlp_advertising = mii_get_an(mii, MII_LPA);\n\t\t\tlp_advertising |=\n\t\t\t\t\tmii_stat1000_to_ethtool_lpa_t(stat1000);\n\t\t} else {\n\t\t\tlp_advertising = 0;\n\t\t}\n\n\t\tnego = advertising & lp_advertising;\n\n\t\tif (nego & (ADVERTISED_1000baseT_Full |\n\t\t\t    ADVERTISED_1000baseT_Half)) {\n\t\t\tcmd->base.speed = SPEED_1000;\n\t\t\tcmd->base.duplex = !!(nego & ADVERTISED_1000baseT_Full);\n\t\t} else if (nego & (ADVERTISED_100baseT_Full |\n\t\t\t\t   ADVERTISED_100baseT_Half)) {\n\t\t\tcmd->base.speed = SPEED_100;\n\t\t\tcmd->base.duplex = !!(nego & ADVERTISED_100baseT_Full);\n\t\t} else {\n\t\t\tcmd->base.speed = SPEED_10;\n\t\t\tcmd->base.duplex = !!(nego & ADVERTISED_10baseT_Full);\n\t\t}\n\t} else {\n\t\tcmd->base.autoneg = AUTONEG_DISABLE;\n\n\t\tcmd->base.speed = ((bmcr & BMCR_SPEED1000 &&\n\t\t\t\t    (bmcr & BMCR_SPEED100) == 0) ?\n\t\t\t\t   SPEED_1000 :\n\t\t\t\t   ((bmcr & BMCR_SPEED100) ?\n\t\t\t\t    SPEED_100 : SPEED_10));\n\t\tcmd->base.duplex = (bmcr & BMCR_FULLDPLX) ?\n\t\t\tDUPLEX_FULL : DUPLEX_HALF;\n\n\t\tlp_advertising = 0;\n\t}\n\n\tmii->full_duplex = cmd->base.duplex;\n\n\tethtool_convert_legacy_u32_to_link_mode(cmd->link_modes.supported,\n\t\t\t\t\t\tsupported);\n\tethtool_convert_legacy_u32_to_link_mode(cmd->link_modes.advertising,\n\t\t\t\t\t\tadvertising);\n\tethtool_convert_legacy_u32_to_link_mode(cmd->link_modes.lp_advertising,\n\t\t\t\t\t\tlp_advertising);\n\n\t \n}\n\n \nint mii_ethtool_sset(struct mii_if_info *mii, struct ethtool_cmd *ecmd)\n{\n\tstruct net_device *dev = mii->dev;\n\tu32 speed = ethtool_cmd_speed(ecmd);\n\n\tif (speed != SPEED_10 &&\n\t    speed != SPEED_100 &&\n\t    speed != SPEED_1000)\n\t\treturn -EINVAL;\n\tif (ecmd->duplex != DUPLEX_HALF && ecmd->duplex != DUPLEX_FULL)\n\t\treturn -EINVAL;\n\tif (ecmd->port != PORT_MII)\n\t\treturn -EINVAL;\n\tif (ecmd->transceiver != XCVR_INTERNAL)\n\t\treturn -EINVAL;\n\tif (ecmd->phy_address != mii->phy_id)\n\t\treturn -EINVAL;\n\tif (ecmd->autoneg != AUTONEG_DISABLE && ecmd->autoneg != AUTONEG_ENABLE)\n\t\treturn -EINVAL;\n\tif ((speed == SPEED_1000) && (!mii->supports_gmii))\n\t\treturn -EINVAL;\n\n\t \n\n\tif (ecmd->autoneg == AUTONEG_ENABLE) {\n\t\tu32 bmcr, advert, tmp;\n\t\tu32 advert2 = 0, tmp2 = 0;\n\n\t\tif ((ecmd->advertising & (ADVERTISED_10baseT_Half |\n\t\t\t\t\t  ADVERTISED_10baseT_Full |\n\t\t\t\t\t  ADVERTISED_100baseT_Half |\n\t\t\t\t\t  ADVERTISED_100baseT_Full |\n\t\t\t\t\t  ADVERTISED_1000baseT_Half |\n\t\t\t\t\t  ADVERTISED_1000baseT_Full)) == 0)\n\t\t\treturn -EINVAL;\n\n\t\t \n\t\tadvert = mii->mdio_read(dev, mii->phy_id, MII_ADVERTISE);\n\t\ttmp = advert & ~(ADVERTISE_ALL | ADVERTISE_100BASE4);\n\t\tif (mii->supports_gmii) {\n\t\t\tadvert2 = mii->mdio_read(dev, mii->phy_id, MII_CTRL1000);\n\t\t\ttmp2 = advert2 & ~(ADVERTISE_1000HALF | ADVERTISE_1000FULL);\n\t\t}\n\t\ttmp |= ethtool_adv_to_mii_adv_t(ecmd->advertising);\n\n\t\tif (mii->supports_gmii)\n\t\t\ttmp2 |=\n\t\t\t      ethtool_adv_to_mii_ctrl1000_t(ecmd->advertising);\n\t\tif (advert != tmp) {\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_ADVERTISE, tmp);\n\t\t\tmii->advertising = tmp;\n\t\t}\n\t\tif ((mii->supports_gmii) && (advert2 != tmp2))\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_CTRL1000, tmp2);\n\n\t\t \n\t\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\t\tbmcr |= (BMCR_ANENABLE | BMCR_ANRESTART);\n\t\tmii->mdio_write(dev, mii->phy_id, MII_BMCR, bmcr);\n\n\t\tmii->force_media = 0;\n\t} else {\n\t\tu32 bmcr, tmp;\n\n\t\t \n\t\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\t\ttmp = bmcr & ~(BMCR_ANENABLE | BMCR_SPEED100 |\n\t\t\t       BMCR_SPEED1000 | BMCR_FULLDPLX);\n\t\tif (speed == SPEED_1000)\n\t\t\ttmp |= BMCR_SPEED1000;\n\t\telse if (speed == SPEED_100)\n\t\t\ttmp |= BMCR_SPEED100;\n\t\tif (ecmd->duplex == DUPLEX_FULL) {\n\t\t\ttmp |= BMCR_FULLDPLX;\n\t\t\tmii->full_duplex = 1;\n\t\t} else\n\t\t\tmii->full_duplex = 0;\n\t\tif (bmcr != tmp)\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_BMCR, tmp);\n\n\t\tmii->force_media = 1;\n\t}\n\treturn 0;\n}\n\n \nint mii_ethtool_set_link_ksettings(struct mii_if_info *mii,\n\t\t\t\t   const struct ethtool_link_ksettings *cmd)\n{\n\tstruct net_device *dev = mii->dev;\n\tu32 speed = cmd->base.speed;\n\n\tif (speed != SPEED_10 &&\n\t    speed != SPEED_100 &&\n\t    speed != SPEED_1000)\n\t\treturn -EINVAL;\n\tif (cmd->base.duplex != DUPLEX_HALF && cmd->base.duplex != DUPLEX_FULL)\n\t\treturn -EINVAL;\n\tif (cmd->base.port != PORT_MII)\n\t\treturn -EINVAL;\n\tif (cmd->base.phy_address != mii->phy_id)\n\t\treturn -EINVAL;\n\tif (cmd->base.autoneg != AUTONEG_DISABLE &&\n\t    cmd->base.autoneg != AUTONEG_ENABLE)\n\t\treturn -EINVAL;\n\tif ((speed == SPEED_1000) && (!mii->supports_gmii))\n\t\treturn -EINVAL;\n\n\t \n\n\tif (cmd->base.autoneg == AUTONEG_ENABLE) {\n\t\tu32 bmcr, advert, tmp;\n\t\tu32 advert2 = 0, tmp2 = 0;\n\t\tu32 advertising;\n\n\t\tethtool_convert_link_mode_to_legacy_u32(\n\t\t\t&advertising, cmd->link_modes.advertising);\n\n\t\tif ((advertising & (ADVERTISED_10baseT_Half |\n\t\t\t\t    ADVERTISED_10baseT_Full |\n\t\t\t\t    ADVERTISED_100baseT_Half |\n\t\t\t\t    ADVERTISED_100baseT_Full |\n\t\t\t\t    ADVERTISED_1000baseT_Half |\n\t\t\t\t    ADVERTISED_1000baseT_Full)) == 0)\n\t\t\treturn -EINVAL;\n\n\t\t \n\t\tadvert = mii->mdio_read(dev, mii->phy_id, MII_ADVERTISE);\n\t\ttmp = advert & ~(ADVERTISE_ALL | ADVERTISE_100BASE4);\n\t\tif (mii->supports_gmii) {\n\t\t\tadvert2 = mii->mdio_read(dev, mii->phy_id,\n\t\t\t\t\t\t MII_CTRL1000);\n\t\t\ttmp2 = advert2 &\n\t\t\t\t~(ADVERTISE_1000HALF | ADVERTISE_1000FULL);\n\t\t}\n\t\ttmp |= ethtool_adv_to_mii_adv_t(advertising);\n\n\t\tif (mii->supports_gmii)\n\t\t\ttmp2 |= ethtool_adv_to_mii_ctrl1000_t(advertising);\n\t\tif (advert != tmp) {\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_ADVERTISE, tmp);\n\t\t\tmii->advertising = tmp;\n\t\t}\n\t\tif ((mii->supports_gmii) && (advert2 != tmp2))\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_CTRL1000, tmp2);\n\n\t\t \n\t\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\t\tbmcr |= (BMCR_ANENABLE | BMCR_ANRESTART);\n\t\tmii->mdio_write(dev, mii->phy_id, MII_BMCR, bmcr);\n\n\t\tmii->force_media = 0;\n\t} else {\n\t\tu32 bmcr, tmp;\n\n\t\t \n\t\tbmcr = mii->mdio_read(dev, mii->phy_id, MII_BMCR);\n\t\ttmp = bmcr & ~(BMCR_ANENABLE | BMCR_SPEED100 |\n\t\t\t       BMCR_SPEED1000 | BMCR_FULLDPLX);\n\t\tif (speed == SPEED_1000)\n\t\t\ttmp |= BMCR_SPEED1000;\n\t\telse if (speed == SPEED_100)\n\t\t\ttmp |= BMCR_SPEED100;\n\t\tif (cmd->base.duplex == DUPLEX_FULL) {\n\t\t\ttmp |= BMCR_FULLDPLX;\n\t\t\tmii->full_duplex = 1;\n\t\t} else {\n\t\t\tmii->full_duplex = 0;\n\t\t}\n\t\tif (bmcr != tmp)\n\t\t\tmii->mdio_write(dev, mii->phy_id, MII_BMCR, tmp);\n\n\t\tmii->force_media = 1;\n\t}\n\treturn 0;\n}\n\n \nint mii_check_gmii_support(struct mii_if_info *mii)\n{\n\tint reg;\n\n\treg = mii->mdio_read(mii->dev, mii->phy_id, MII_BMSR);\n\tif (reg & BMSR_ESTATEN) {\n\t\treg = mii->mdio_read(mii->dev, mii->phy_id, MII_ESTATUS);\n\t\tif (reg & (ESTATUS_1000_TFULL | ESTATUS_1000_THALF))\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}\n\n \nint mii_link_ok (struct mii_if_info *mii)\n{\n\t \n\tmii->mdio_read(mii->dev, mii->phy_id, MII_BMSR);\n\tif (mii->mdio_read(mii->dev, mii->phy_id, MII_BMSR) & BMSR_LSTATUS)\n\t\treturn 1;\n\treturn 0;\n}\n\n \nint mii_nway_restart (struct mii_if_info *mii)\n{\n\tint bmcr;\n\tint r = -EINVAL;\n\n\t \n\tbmcr = mii->mdio_read(mii->dev, mii->phy_id, MII_BMCR);\n\n\tif (bmcr & BMCR_ANENABLE) {\n\t\tbmcr |= BMCR_ANRESTART;\n\t\tmii->mdio_write(mii->dev, mii->phy_id, MII_BMCR, bmcr);\n\t\tr = 0;\n\t}\n\n\treturn r;\n}\n\n \nvoid mii_check_link (struct mii_if_info *mii)\n{\n\tint cur_link = mii_link_ok(mii);\n\tint prev_link = netif_carrier_ok(mii->dev);\n\n\tif (cur_link && !prev_link)\n\t\tnetif_carrier_on(mii->dev);\n\telse if (prev_link && !cur_link)\n\t\tnetif_carrier_off(mii->dev);\n}\n\n \nunsigned int mii_check_media (struct mii_if_info *mii,\n\t\t\t      unsigned int ok_to_print,\n\t\t\t      unsigned int init_media)\n{\n\tunsigned int old_carrier, new_carrier;\n\tint advertise, lpa, media, duplex;\n\tint lpa2 = 0;\n\n\t \n\told_carrier = netif_carrier_ok(mii->dev) ? 1 : 0;\n\tnew_carrier = (unsigned int) mii_link_ok(mii);\n\n\t \n\tif ((!init_media) && (old_carrier == new_carrier))\n\t\treturn 0;  \n\n\t \n\tif (!new_carrier) {\n\t\tnetif_carrier_off(mii->dev);\n\t\tif (ok_to_print)\n\t\t\tnetdev_info(mii->dev, \"link down\\n\");\n\t\treturn 0;  \n\t}\n\n\t \n\tnetif_carrier_on(mii->dev);\n\n\tif (mii->force_media) {\n\t\tif (ok_to_print)\n\t\t\tnetdev_info(mii->dev, \"link up\\n\");\n\t\treturn 0;  \n\t}\n\n\t \n\tif ((!init_media) && (mii->advertising))\n\t\tadvertise = mii->advertising;\n\telse {\n\t\tadvertise = mii->mdio_read(mii->dev, mii->phy_id, MII_ADVERTISE);\n\t\tmii->advertising = advertise;\n\t}\n\tlpa = mii->mdio_read(mii->dev, mii->phy_id, MII_LPA);\n\tif (mii->supports_gmii)\n\t\tlpa2 = mii->mdio_read(mii->dev, mii->phy_id, MII_STAT1000);\n\n\t \n\tmedia = mii_nway_result(lpa & advertise);\n\tduplex = (media & ADVERTISE_FULL) ? 1 : 0;\n\tif (lpa2 & LPA_1000FULL)\n\t\tduplex = 1;\n\n\tif (ok_to_print)\n\t\tnetdev_info(mii->dev, \"link up, %uMbps, %s-duplex, lpa 0x%04X\\n\",\n\t\t\t    lpa2 & (LPA_1000FULL | LPA_1000HALF) ? 1000 :\n\t\t\t    media & (ADVERTISE_100FULL | ADVERTISE_100HALF) ?\n\t\t\t    100 : 10,\n\t\t\t    duplex ? \"full\" : \"half\",\n\t\t\t    lpa);\n\n\tif ((init_media) || (mii->full_duplex != duplex)) {\n\t\tmii->full_duplex = duplex;\n\t\treturn 1;  \n\t}\n\n\treturn 0;  \n}\n\n \nint generic_mii_ioctl(struct mii_if_info *mii_if,\n\t\t      struct mii_ioctl_data *mii_data, int cmd,\n\t\t      unsigned int *duplex_chg_out)\n{\n\tint rc = 0;\n\tunsigned int duplex_changed = 0;\n\n\tif (duplex_chg_out)\n\t\t*duplex_chg_out = 0;\n\n\tmii_data->phy_id &= mii_if->phy_id_mask;\n\tmii_data->reg_num &= mii_if->reg_num_mask;\n\n\tswitch(cmd) {\n\tcase SIOCGMIIPHY:\n\t\tmii_data->phy_id = mii_if->phy_id;\n\t\tfallthrough;\n\n\tcase SIOCGMIIREG:\n\t\tmii_data->val_out =\n\t\t\tmii_if->mdio_read(mii_if->dev, mii_data->phy_id,\n\t\t\t\t\t  mii_data->reg_num);\n\t\tbreak;\n\n\tcase SIOCSMIIREG: {\n\t\tu16 val = mii_data->val_in;\n\n\t\tif (mii_data->phy_id == mii_if->phy_id) {\n\t\t\tswitch(mii_data->reg_num) {\n\t\t\tcase MII_BMCR: {\n\t\t\t\tunsigned int new_duplex = 0;\n\t\t\t\tif (val & (BMCR_RESET|BMCR_ANENABLE))\n\t\t\t\t\tmii_if->force_media = 0;\n\t\t\t\telse\n\t\t\t\t\tmii_if->force_media = 1;\n\t\t\t\tif (mii_if->force_media &&\n\t\t\t\t    (val & BMCR_FULLDPLX))\n\t\t\t\t\tnew_duplex = 1;\n\t\t\t\tif (mii_if->full_duplex != new_duplex) {\n\t\t\t\t\tduplex_changed = 1;\n\t\t\t\t\tmii_if->full_duplex = new_duplex;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MII_ADVERTISE:\n\t\t\t\tmii_if->advertising = val;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t \n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tmii_if->mdio_write(mii_if->dev, mii_data->phy_id,\n\t\t\t\t   mii_data->reg_num, val);\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\trc = -EOPNOTSUPP;\n\t\tbreak;\n\t}\n\n\tif ((rc == 0) && (duplex_chg_out) && (duplex_changed))\n\t\t*duplex_chg_out = 1;\n\n\treturn rc;\n}\n\nMODULE_AUTHOR (\"Jeff Garzik <jgarzik@pobox.com>\");\nMODULE_DESCRIPTION (\"MII hardware support library\");\nMODULE_LICENSE(\"GPL\");\n\nEXPORT_SYMBOL(mii_link_ok);\nEXPORT_SYMBOL(mii_nway_restart);\nEXPORT_SYMBOL(mii_ethtool_gset);\nEXPORT_SYMBOL(mii_ethtool_get_link_ksettings);\nEXPORT_SYMBOL(mii_ethtool_sset);\nEXPORT_SYMBOL(mii_ethtool_set_link_ksettings);\nEXPORT_SYMBOL(mii_check_link);\nEXPORT_SYMBOL(mii_check_media);\nEXPORT_SYMBOL(mii_check_gmii_support);\nEXPORT_SYMBOL(generic_mii_ioctl);\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}