{
  "module_name": "kvaser_usb.h",
  "hash_id": "0a4f60adf28a5965e06e44dada481a0f9a761eecb4b023e1046aeb80961ac70c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/can/usb/kvaser_usb/kvaser_usb.h",
  "human_readable_source": " \n \n\n#ifndef KVASER_USB_H\n#define KVASER_USB_H\n\n \n\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/usb.h>\n\n#include <linux/can.h>\n#include <linux/can/dev.h>\n\n#define KVASER_USB_MAX_RX_URBS\t\t\t4\n#define KVASER_USB_MAX_TX_URBS\t\t\t128\n#define KVASER_USB_TIMEOUT\t\t\t1000  \n#define KVASER_USB_RX_BUFFER_SIZE\t\t3072\n#define KVASER_USB_MAX_NET_DEVICES\t\t5\n\n \n#define KVASER_USB_QUIRK_HAS_SILENT_MODE\tBIT(0)\n#define KVASER_USB_QUIRK_HAS_TXRX_ERRORS\tBIT(1)\n#define KVASER_USB_QUIRK_IGNORE_CLK_FREQ\tBIT(2)\n#define KVASER_USB_QUIRK_HAS_HARDWARE_TIMESTAMP\tBIT(3)\n\n \n#define KVASER_USB_CAP_BERR_CAP\t\t\t0x01\n#define KVASER_USB_CAP_EXT_CAP\t\t\t0x02\n#define KVASER_USB_HYDRA_CAP_EXT_CMD\t\t0x04\n\nstruct kvaser_usb_dev_cfg;\n\nenum kvaser_usb_leaf_family {\n\tKVASER_LEAF,\n\tKVASER_USBCAN,\n};\n\n#define KVASER_USB_HYDRA_MAX_CMD_LEN\t\t128\nstruct kvaser_usb_dev_card_data_hydra {\n\tu8 channel_to_he[KVASER_USB_MAX_NET_DEVICES];\n\tu8 sysdbg_he;\n\tspinlock_t transid_lock;  \n\tu16 transid;\n\t \n\tspinlock_t usb_rx_leftover_lock;\n\tu8 usb_rx_leftover[KVASER_USB_HYDRA_MAX_CMD_LEN];\n\tu8 usb_rx_leftover_len;\n};\nstruct kvaser_usb_dev_card_data {\n\tu32 ctrlmode_supported;\n\tu32 capabilities;\n\tstruct kvaser_usb_dev_card_data_hydra hydra;\n};\n\n \nstruct kvaser_usb_tx_urb_context {\n\tstruct kvaser_usb_net_priv *priv;\n\tu32 echo_index;\n};\n\nstruct kvaser_usb_busparams {\n\t__le32 bitrate;\n\tu8 tseg1;\n\tu8 tseg2;\n\tu8 sjw;\n\tu8 nsamples;\n} __packed;\n\nstruct kvaser_usb {\n\tstruct usb_device *udev;\n\tstruct usb_interface *intf;\n\tstruct kvaser_usb_net_priv *nets[KVASER_USB_MAX_NET_DEVICES];\n\tconst struct kvaser_usb_driver_info *driver_info;\n\tconst struct kvaser_usb_dev_cfg *cfg;\n\n\tstruct usb_endpoint_descriptor *bulk_in, *bulk_out;\n\tstruct usb_anchor rx_submitted;\n\n\t \n\tu32 fw_version;\n\tunsigned int nchannels;\n\tunsigned int max_tx_urbs;\n\tstruct kvaser_usb_dev_card_data card_data;\n\n\tbool rxinitdone;\n\tvoid *rxbuf[KVASER_USB_MAX_RX_URBS];\n\tdma_addr_t rxbuf_dma[KVASER_USB_MAX_RX_URBS];\n};\n\nstruct kvaser_usb_net_priv {\n\tstruct can_priv can;\n\tstruct can_berr_counter bec;\n\n\t \n\tvoid *sub_priv;\n\n\tstruct kvaser_usb *dev;\n\tstruct net_device *netdev;\n\tint channel;\n\n\tstruct completion start_comp, stop_comp, flush_comp,\n\t\t\t  get_busparams_comp;\n\tstruct usb_anchor tx_submitted;\n\n\tstruct kvaser_usb_busparams busparams_nominal, busparams_data;\n\n\tspinlock_t tx_contexts_lock;  \n\tint active_tx_contexts;\n\tstruct kvaser_usb_tx_urb_context tx_contexts[];\n};\n\n \nstruct kvaser_usb_dev_ops {\n\tint (*dev_set_mode)(struct net_device *netdev, enum can_mode mode);\n\tint (*dev_set_bittiming)(const struct net_device *netdev,\n\t\t\t\t const struct kvaser_usb_busparams *busparams);\n\tint (*dev_get_busparams)(struct kvaser_usb_net_priv *priv);\n\tint (*dev_set_data_bittiming)(const struct net_device *netdev,\n\t\t\t\t      const struct kvaser_usb_busparams *busparams);\n\tint (*dev_get_data_busparams)(struct kvaser_usb_net_priv *priv);\n\tint (*dev_get_berr_counter)(const struct net_device *netdev,\n\t\t\t\t    struct can_berr_counter *bec);\n\tint (*dev_setup_endpoints)(struct kvaser_usb *dev);\n\tint (*dev_init_card)(struct kvaser_usb *dev);\n\tint (*dev_init_channel)(struct kvaser_usb_net_priv *priv);\n\tvoid (*dev_remove_channel)(struct kvaser_usb_net_priv *priv);\n\tint (*dev_get_software_info)(struct kvaser_usb *dev);\n\tint (*dev_get_software_details)(struct kvaser_usb *dev);\n\tint (*dev_get_card_info)(struct kvaser_usb *dev);\n\tint (*dev_get_capabilities)(struct kvaser_usb *dev);\n\tint (*dev_set_opt_mode)(const struct kvaser_usb_net_priv *priv);\n\tint (*dev_start_chip)(struct kvaser_usb_net_priv *priv);\n\tint (*dev_stop_chip)(struct kvaser_usb_net_priv *priv);\n\tint (*dev_reset_chip)(struct kvaser_usb *dev, int channel);\n\tint (*dev_flush_queue)(struct kvaser_usb_net_priv *priv);\n\tvoid (*dev_read_bulk_callback)(struct kvaser_usb *dev, void *buf,\n\t\t\t\t       int len);\n\tvoid *(*dev_frame_to_cmd)(const struct kvaser_usb_net_priv *priv,\n\t\t\t\t  const struct sk_buff *skb, int *cmd_len,\n\t\t\t\t  u16 transid);\n};\n\nstruct kvaser_usb_driver_info {\n\tu32 quirks;\n\tenum kvaser_usb_leaf_family family;\n\tconst struct kvaser_usb_dev_ops *ops;\n};\n\nstruct kvaser_usb_dev_cfg {\n\tconst struct can_clock clock;\n\tconst unsigned int timestamp_freq;\n\tconst struct can_bittiming_const * const bittiming_const;\n\tconst struct can_bittiming_const * const data_bittiming_const;\n};\n\nextern const struct kvaser_usb_dev_ops kvaser_usb_hydra_dev_ops;\nextern const struct kvaser_usb_dev_ops kvaser_usb_leaf_dev_ops;\n\nvoid kvaser_usb_unlink_tx_urbs(struct kvaser_usb_net_priv *priv);\n\nint kvaser_usb_recv_cmd(const struct kvaser_usb *dev, void *cmd, int len,\n\t\t\tint *actual_len);\n\nint kvaser_usb_send_cmd(const struct kvaser_usb *dev, void *cmd, int len);\n\nint kvaser_usb_send_cmd_async(struct kvaser_usb_net_priv *priv, void *cmd,\n\t\t\t      int len);\n\nint kvaser_usb_can_rx_over_error(struct net_device *netdev);\n\nextern const struct can_bittiming_const kvaser_usb_flexc_bittiming_const;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}