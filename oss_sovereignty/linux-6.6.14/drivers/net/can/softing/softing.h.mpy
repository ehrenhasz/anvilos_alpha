{
  "module_name": "softing.h",
  "hash_id": "a0d073f3fcd87d94791650ecafb7305cb7443bfe2ea5c511ecac4323b6b5c91e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/can/softing/softing.h",
  "human_readable_source": " \n \n\n#include <linux/atomic.h>\n#include <linux/netdevice.h>\n#include <linux/ktime.h>\n#include <linux/mutex.h>\n#include <linux/spinlock.h>\n#include <linux/can.h>\n#include <linux/can/dev.h>\n\n#include \"softing_platform.h\"\n\nstruct softing;\n\nstruct softing_priv {\n\tstruct can_priv can;  \n\tstruct net_device *netdev;\n\tstruct softing *card;\n\tstruct {\n\t\tint pending;\n\t\t \n\t\tint echo_put;\n\t\tint echo_get;\n\t} tx;\n\tstruct can_bittiming_const btr_const;\n\tint index;\n\tuint8_t output;\n\tuint16_t chip;\n};\n#define netdev2softing(netdev)\t((struct softing_priv *)netdev_priv(netdev))\n\nstruct softing {\n\tconst struct softing_platform_data *pdat;\n\tstruct platform_device *pdev;\n\tstruct net_device *net[2];\n\tspinlock_t spin;  \n\tktime_t ts_ref;\n\tktime_t ts_overflow;  \n\n\tstruct {\n\t\t \n\t\tint up;\n\t\t \n\t\tstruct mutex lock;\n\t} fw;\n\tstruct {\n\t\tint nr;\n\t\tint requested;\n\t\tint svc_count;\n\t\tunsigned int dpram_position;\n\t} irq;\n\tstruct {\n\t\tint pending;\n\t\tint last_bus;\n\t\t \n\t} tx;\n\t__iomem uint8_t *dpram;\n\tunsigned long dpram_phys;\n\tunsigned long dpram_size;\n\tstruct {\n\t\tuint16_t fw_version, hw_version, license, serial;\n\t\tuint16_t chip[2];\n\t\tunsigned int freq;  \n\t} id;\n};\n\nint softing_default_output(struct net_device *netdev);\n\nktime_t softing_raw2ktime(struct softing *card, u32 raw);\n\nint softing_chip_poweron(struct softing *card);\n\nint softing_bootloader_command(struct softing *card, int16_t cmd,\n\t\t\t       const char *msg);\n\n \nint softing_load_fw(const char *file, struct softing *card,\n\t\t    __iomem uint8_t *virt, unsigned int size, int offset);\n\n \nint softing_load_app_fw(const char *file, struct softing *card);\n\n \nint softing_enable_irq(struct softing *card, int enable);\n\n \nint softing_startstop(struct net_device *netdev, int up);\n\n \nint softing_netdev_rx(struct net_device *netdev, const struct can_frame *msg,\n\t\t      ktime_t ktime);\n\n \n#define DPRAM_RX\t\t0x0000\n\t#define DPRAM_RX_SIZE\t32\n\t#define DPRAM_RX_CNT\t16\n#define DPRAM_RX_RD\t\t0x0201\t \n#define DPRAM_RX_WR\t\t0x0205\t \n#define DPRAM_RX_LOST\t\t0x0207\t \n\n#define DPRAM_FCT_PARAM\t\t0x0300\t \n#define DPRAM_FCT_RESULT\t0x0328\t \n#define DPRAM_FCT_HOST\t\t0x032b\t \n\n#define DPRAM_INFO_BUSSTATE\t0x0331\t \n#define DPRAM_INFO_BUSSTATE2\t0x0335\t \n#define DPRAM_INFO_ERRSTATE\t0x0339\t \n#define DPRAM_INFO_ERRSTATE2\t0x033d\t \n#define DPRAM_RESET\t\t0x0341\t \n#define DPRAM_CLR_RECV_FIFO\t0x0345\t \n#define DPRAM_RESET_TIME\t0x034d\t \n#define DPRAM_TIME\t\t0x0350\t \n#define DPRAM_WR_START\t\t0x0358\t \n#define DPRAM_WR_END\t\t0x0359\t \n#define DPRAM_RESET_RX_FIFO\t0x0361\t \n#define DPRAM_RESET_TX_FIFO\t0x0364\t \n#define DPRAM_READ_FIFO_LEVEL\t0x0365\t \n#define DPRAM_RX_FIFO_LEVEL\t0x0366\t \n#define DPRAM_TX_FIFO_LEVEL\t0x0366\t \n\n#define DPRAM_TX\t\t0x0400\t \n\t#define DPRAM_TX_SIZE\t16\n\t#define DPRAM_TX_CNT\t32\n#define DPRAM_TX_RD\t\t0x0601\t \n#define DPRAM_TX_WR\t\t0x0605\t \n\n#define DPRAM_COMMAND\t\t0x07e0\t \n#define DPRAM_RECEIPT\t\t0x07f0\t \n#define DPRAM_IRQ_TOHOST\t0x07fe\t \n#define DPRAM_IRQ_TOCARD\t0x07ff\t \n\n#define DPRAM_V2_RESET\t\t0x0e00\t \n#define DPRAM_V2_IRQ_TOHOST\t0x0e02\t \n\n#define TXMAX\t(DPRAM_TX_CNT - 1)\n\n \n#define RES_NONE\t0\n#define RES_OK\t\t1\n#define RES_NOK\t\t2\n#define RES_UNKNOWN\t3\n \n#define CMD_TX\t\t0x01\n#define CMD_ACK\t\t0x02\n#define CMD_XTD\t\t0x04\n#define CMD_RTR\t\t0x08\n#define CMD_ERR\t\t0x10\n#define CMD_BUS2\t0x80\n\n \n#define SF_MASK_BUSOFF\t\t0x80\n#define SF_MASK_EPASSIVE\t0x60\n\n \n#define STATE_BUSOFF\t2\n#define STATE_EPASSIVE\t1\n#define STATE_EACTIVE\t0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}