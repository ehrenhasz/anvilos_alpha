{
  "module_name": "mcp251xfd.h",
  "hash_id": "980ecb1f806e657716828d26f0799b6c1f5a2ddcc47cd83d04113eec65de9643",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/can/spi/mcp251xfd/mcp251xfd.h",
  "human_readable_source": " \n\n#ifndef _MCP251XFD_H\n#define _MCP251XFD_H\n\n#include <linux/bitfield.h>\n#include <linux/can/core.h>\n#include <linux/can/dev.h>\n#include <linux/can/rx-offload.h>\n#include <linux/gpio/consumer.h>\n#include <linux/kernel.h>\n#include <linux/netdevice.h>\n#include <linux/regmap.h>\n#include <linux/regulator/consumer.h>\n#include <linux/spi/spi.h>\n#include <linux/timecounter.h>\n#include <linux/workqueue.h>\n\n \n\n \n#define MCP251XFD_REG_CON 0x00\n#define MCP251XFD_REG_CON_TXBWS_MASK GENMASK(31, 28)\n#define MCP251XFD_REG_CON_ABAT BIT(27)\n#define MCP251XFD_REG_CON_REQOP_MASK GENMASK(26, 24)\n#define MCP251XFD_REG_CON_MODE_MIXED 0\n#define MCP251XFD_REG_CON_MODE_SLEEP 1\n#define MCP251XFD_REG_CON_MODE_INT_LOOPBACK 2\n#define MCP251XFD_REG_CON_MODE_LISTENONLY 3\n#define MCP251XFD_REG_CON_MODE_CONFIG 4\n#define MCP251XFD_REG_CON_MODE_EXT_LOOPBACK 5\n#define MCP251XFD_REG_CON_MODE_CAN2_0 6\n#define MCP251XFD_REG_CON_MODE_RESTRICTED 7\n#define MCP251XFD_REG_CON_OPMOD_MASK GENMASK(23, 21)\n#define MCP251XFD_REG_CON_TXQEN BIT(20)\n#define MCP251XFD_REG_CON_STEF BIT(19)\n#define MCP251XFD_REG_CON_SERR2LOM BIT(18)\n#define MCP251XFD_REG_CON_ESIGM BIT(17)\n#define MCP251XFD_REG_CON_RTXAT BIT(16)\n#define MCP251XFD_REG_CON_BRSDIS BIT(12)\n#define MCP251XFD_REG_CON_BUSY BIT(11)\n#define MCP251XFD_REG_CON_WFT_MASK GENMASK(10, 9)\n#define MCP251XFD_REG_CON_WFT_T00FILTER 0x0\n#define MCP251XFD_REG_CON_WFT_T01FILTER 0x1\n#define MCP251XFD_REG_CON_WFT_T10FILTER 0x2\n#define MCP251XFD_REG_CON_WFT_T11FILTER 0x3\n#define MCP251XFD_REG_CON_WAKFIL BIT(8)\n#define MCP251XFD_REG_CON_PXEDIS BIT(6)\n#define MCP251XFD_REG_CON_ISOCRCEN BIT(5)\n#define MCP251XFD_REG_CON_DNCNT_MASK GENMASK(4, 0)\n\n#define MCP251XFD_REG_NBTCFG 0x04\n#define MCP251XFD_REG_NBTCFG_BRP_MASK GENMASK(31, 24)\n#define MCP251XFD_REG_NBTCFG_TSEG1_MASK GENMASK(23, 16)\n#define MCP251XFD_REG_NBTCFG_TSEG2_MASK GENMASK(14, 8)\n#define MCP251XFD_REG_NBTCFG_SJW_MASK GENMASK(6, 0)\n\n#define MCP251XFD_REG_DBTCFG 0x08\n#define MCP251XFD_REG_DBTCFG_BRP_MASK GENMASK(31, 24)\n#define MCP251XFD_REG_DBTCFG_TSEG1_MASK GENMASK(20, 16)\n#define MCP251XFD_REG_DBTCFG_TSEG2_MASK GENMASK(11, 8)\n#define MCP251XFD_REG_DBTCFG_SJW_MASK GENMASK(3, 0)\n\n#define MCP251XFD_REG_TDC 0x0c\n#define MCP251XFD_REG_TDC_EDGFLTEN BIT(25)\n#define MCP251XFD_REG_TDC_SID11EN BIT(24)\n#define MCP251XFD_REG_TDC_TDCMOD_MASK GENMASK(17, 16)\n#define MCP251XFD_REG_TDC_TDCMOD_AUTO 2\n#define MCP251XFD_REG_TDC_TDCMOD_MANUAL 1\n#define MCP251XFD_REG_TDC_TDCMOD_DISABLED 0\n#define MCP251XFD_REG_TDC_TDCO_MASK GENMASK(14, 8)\n#define MCP251XFD_REG_TDC_TDCV_MASK GENMASK(5, 0)\n\n#define MCP251XFD_REG_TBC 0x10\n\n#define MCP251XFD_REG_TSCON 0x14\n#define MCP251XFD_REG_TSCON_TSRES BIT(18)\n#define MCP251XFD_REG_TSCON_TSEOF BIT(17)\n#define MCP251XFD_REG_TSCON_TBCEN BIT(16)\n#define MCP251XFD_REG_TSCON_TBCPRE_MASK GENMASK(9, 0)\n\n#define MCP251XFD_REG_VEC 0x18\n#define MCP251XFD_REG_VEC_RXCODE_MASK GENMASK(30, 24)\n#define MCP251XFD_REG_VEC_TXCODE_MASK GENMASK(22, 16)\n#define MCP251XFD_REG_VEC_FILHIT_MASK GENMASK(12, 8)\n#define MCP251XFD_REG_VEC_ICODE_MASK GENMASK(6, 0)\n\n#define MCP251XFD_REG_INT 0x1c\n#define MCP251XFD_REG_INT_IF_MASK GENMASK(15, 0)\n#define MCP251XFD_REG_INT_IE_MASK GENMASK(31, 16)\n#define MCP251XFD_REG_INT_IVMIE BIT(31)\n#define MCP251XFD_REG_INT_WAKIE BIT(30)\n#define MCP251XFD_REG_INT_CERRIE BIT(29)\n#define MCP251XFD_REG_INT_SERRIE BIT(28)\n#define MCP251XFD_REG_INT_RXOVIE BIT(27)\n#define MCP251XFD_REG_INT_TXATIE BIT(26)\n#define MCP251XFD_REG_INT_SPICRCIE BIT(25)\n#define MCP251XFD_REG_INT_ECCIE BIT(24)\n#define MCP251XFD_REG_INT_TEFIE BIT(20)\n#define MCP251XFD_REG_INT_MODIE BIT(19)\n#define MCP251XFD_REG_INT_TBCIE BIT(18)\n#define MCP251XFD_REG_INT_RXIE BIT(17)\n#define MCP251XFD_REG_INT_TXIE BIT(16)\n#define MCP251XFD_REG_INT_IVMIF BIT(15)\n#define MCP251XFD_REG_INT_WAKIF BIT(14)\n#define MCP251XFD_REG_INT_CERRIF BIT(13)\n#define MCP251XFD_REG_INT_SERRIF BIT(12)\n#define MCP251XFD_REG_INT_RXOVIF BIT(11)\n#define MCP251XFD_REG_INT_TXATIF BIT(10)\n#define MCP251XFD_REG_INT_SPICRCIF BIT(9)\n#define MCP251XFD_REG_INT_ECCIF BIT(8)\n#define MCP251XFD_REG_INT_TEFIF BIT(4)\n#define MCP251XFD_REG_INT_MODIF BIT(3)\n#define MCP251XFD_REG_INT_TBCIF BIT(2)\n#define MCP251XFD_REG_INT_RXIF BIT(1)\n#define MCP251XFD_REG_INT_TXIF BIT(0)\n \n#define MCP251XFD_REG_INT_IF_CLEARABLE_MASK \\\n\t(MCP251XFD_REG_INT_IVMIF | MCP251XFD_REG_INT_WAKIF | \\\n\t MCP251XFD_REG_INT_CERRIF |  MCP251XFD_REG_INT_SERRIF | \\\n\t MCP251XFD_REG_INT_MODIF)\n\n#define MCP251XFD_REG_RXIF 0x20\n#define MCP251XFD_REG_TXIF 0x24\n#define MCP251XFD_REG_RXOVIF 0x28\n#define MCP251XFD_REG_TXATIF 0x2c\n#define MCP251XFD_REG_TXREQ 0x30\n\n#define MCP251XFD_REG_TREC 0x34\n#define MCP251XFD_REG_TREC_TXBO BIT(21)\n#define MCP251XFD_REG_TREC_TXBP BIT(20)\n#define MCP251XFD_REG_TREC_RXBP BIT(19)\n#define MCP251XFD_REG_TREC_TXWARN BIT(18)\n#define MCP251XFD_REG_TREC_RXWARN BIT(17)\n#define MCP251XFD_REG_TREC_EWARN BIT(16)\n#define MCP251XFD_REG_TREC_TEC_MASK GENMASK(15, 8)\n#define MCP251XFD_REG_TREC_REC_MASK GENMASK(7, 0)\n\n#define MCP251XFD_REG_BDIAG0 0x38\n#define MCP251XFD_REG_BDIAG0_DTERRCNT_MASK GENMASK(31, 24)\n#define MCP251XFD_REG_BDIAG0_DRERRCNT_MASK GENMASK(23, 16)\n#define MCP251XFD_REG_BDIAG0_NTERRCNT_MASK GENMASK(15, 8)\n#define MCP251XFD_REG_BDIAG0_NRERRCNT_MASK GENMASK(7, 0)\n\n#define MCP251XFD_REG_BDIAG1 0x3c\n#define MCP251XFD_REG_BDIAG1_DLCMM BIT(31)\n#define MCP251XFD_REG_BDIAG1_ESI BIT(30)\n#define MCP251XFD_REG_BDIAG1_DCRCERR BIT(29)\n#define MCP251XFD_REG_BDIAG1_DSTUFERR BIT(28)\n#define MCP251XFD_REG_BDIAG1_DFORMERR BIT(27)\n#define MCP251XFD_REG_BDIAG1_DBIT1ERR BIT(25)\n#define MCP251XFD_REG_BDIAG1_DBIT0ERR BIT(24)\n#define MCP251XFD_REG_BDIAG1_TXBOERR BIT(23)\n#define MCP251XFD_REG_BDIAG1_NCRCERR BIT(21)\n#define MCP251XFD_REG_BDIAG1_NSTUFERR BIT(20)\n#define MCP251XFD_REG_BDIAG1_NFORMERR BIT(19)\n#define MCP251XFD_REG_BDIAG1_NACKERR BIT(18)\n#define MCP251XFD_REG_BDIAG1_NBIT1ERR BIT(17)\n#define MCP251XFD_REG_BDIAG1_NBIT0ERR BIT(16)\n#define MCP251XFD_REG_BDIAG1_BERR_MASK \\\n\t(MCP251XFD_REG_BDIAG1_DLCMM | MCP251XFD_REG_BDIAG1_ESI | \\\n\t MCP251XFD_REG_BDIAG1_DCRCERR | MCP251XFD_REG_BDIAG1_DSTUFERR | \\\n\t MCP251XFD_REG_BDIAG1_DFORMERR | MCP251XFD_REG_BDIAG1_DBIT1ERR | \\\n\t MCP251XFD_REG_BDIAG1_DBIT0ERR | MCP251XFD_REG_BDIAG1_TXBOERR | \\\n\t MCP251XFD_REG_BDIAG1_NCRCERR | MCP251XFD_REG_BDIAG1_NSTUFERR | \\\n\t MCP251XFD_REG_BDIAG1_NFORMERR | MCP251XFD_REG_BDIAG1_NACKERR | \\\n\t MCP251XFD_REG_BDIAG1_NBIT1ERR | MCP251XFD_REG_BDIAG1_NBIT0ERR)\n#define MCP251XFD_REG_BDIAG1_EFMSGCNT_MASK GENMASK(15, 0)\n\n#define MCP251XFD_REG_TEFCON 0x40\n#define MCP251XFD_REG_TEFCON_FSIZE_MASK GENMASK(28, 24)\n#define MCP251XFD_REG_TEFCON_FRESET BIT(10)\n#define MCP251XFD_REG_TEFCON_UINC BIT(8)\n#define MCP251XFD_REG_TEFCON_TEFTSEN BIT(5)\n#define MCP251XFD_REG_TEFCON_TEFOVIE BIT(3)\n#define MCP251XFD_REG_TEFCON_TEFFIE BIT(2)\n#define MCP251XFD_REG_TEFCON_TEFHIE BIT(1)\n#define MCP251XFD_REG_TEFCON_TEFNEIE BIT(0)\n\n#define MCP251XFD_REG_TEFSTA 0x44\n#define MCP251XFD_REG_TEFSTA_TEFOVIF BIT(3)\n#define MCP251XFD_REG_TEFSTA_TEFFIF BIT(2)\n#define MCP251XFD_REG_TEFSTA_TEFHIF BIT(1)\n#define MCP251XFD_REG_TEFSTA_TEFNEIF BIT(0)\n\n#define MCP251XFD_REG_TEFUA 0x48\n\n#define MCP251XFD_REG_TXQCON 0x50\n#define MCP251XFD_REG_TXQCON_PLSIZE_MASK GENMASK(31, 29)\n#define MCP251XFD_REG_TXQCON_PLSIZE_8 0\n#define MCP251XFD_REG_TXQCON_PLSIZE_12 1\n#define MCP251XFD_REG_TXQCON_PLSIZE_16 2\n#define MCP251XFD_REG_TXQCON_PLSIZE_20 3\n#define MCP251XFD_REG_TXQCON_PLSIZE_24 4\n#define MCP251XFD_REG_TXQCON_PLSIZE_32 5\n#define MCP251XFD_REG_TXQCON_PLSIZE_48 6\n#define MCP251XFD_REG_TXQCON_PLSIZE_64 7\n#define MCP251XFD_REG_TXQCON_FSIZE_MASK GENMASK(28, 24)\n#define MCP251XFD_REG_TXQCON_TXAT_UNLIMITED 3\n#define MCP251XFD_REG_TXQCON_TXAT_THREE_SHOT 1\n#define MCP251XFD_REG_TXQCON_TXAT_ONE_SHOT 0\n#define MCP251XFD_REG_TXQCON_TXAT_MASK GENMASK(22, 21)\n#define MCP251XFD_REG_TXQCON_TXPRI_MASK GENMASK(20, 16)\n#define MCP251XFD_REG_TXQCON_FRESET BIT(10)\n#define MCP251XFD_REG_TXQCON_TXREQ BIT(9)\n#define MCP251XFD_REG_TXQCON_UINC BIT(8)\n#define MCP251XFD_REG_TXQCON_TXEN BIT(7)\n#define MCP251XFD_REG_TXQCON_TXATIE BIT(4)\n#define MCP251XFD_REG_TXQCON_TXQEIE BIT(2)\n#define MCP251XFD_REG_TXQCON_TXQNIE BIT(0)\n\n#define MCP251XFD_REG_TXQSTA 0x54\n#define MCP251XFD_REG_TXQSTA_TXQCI_MASK GENMASK(12, 8)\n#define MCP251XFD_REG_TXQSTA_TXABT BIT(7)\n#define MCP251XFD_REG_TXQSTA_TXLARB BIT(6)\n#define MCP251XFD_REG_TXQSTA_TXERR BIT(5)\n#define MCP251XFD_REG_TXQSTA_TXATIF BIT(4)\n#define MCP251XFD_REG_TXQSTA_TXQEIF BIT(2)\n#define MCP251XFD_REG_TXQSTA_TXQNIF BIT(0)\n\n#define MCP251XFD_REG_TXQUA 0x58\n\n#define MCP251XFD_REG_FIFOCON(x) (0x50 + 0xc * (x))\n#define MCP251XFD_REG_FIFOCON_PLSIZE_MASK GENMASK(31, 29)\n#define MCP251XFD_REG_FIFOCON_PLSIZE_8 0\n#define MCP251XFD_REG_FIFOCON_PLSIZE_12 1\n#define MCP251XFD_REG_FIFOCON_PLSIZE_16 2\n#define MCP251XFD_REG_FIFOCON_PLSIZE_20 3\n#define MCP251XFD_REG_FIFOCON_PLSIZE_24 4\n#define MCP251XFD_REG_FIFOCON_PLSIZE_32 5\n#define MCP251XFD_REG_FIFOCON_PLSIZE_48 6\n#define MCP251XFD_REG_FIFOCON_PLSIZE_64 7\n#define MCP251XFD_REG_FIFOCON_FSIZE_MASK GENMASK(28, 24)\n#define MCP251XFD_REG_FIFOCON_TXAT_MASK GENMASK(22, 21)\n#define MCP251XFD_REG_FIFOCON_TXAT_ONE_SHOT 0\n#define MCP251XFD_REG_FIFOCON_TXAT_THREE_SHOT 1\n#define MCP251XFD_REG_FIFOCON_TXAT_UNLIMITED 3\n#define MCP251XFD_REG_FIFOCON_TXPRI_MASK GENMASK(20, 16)\n#define MCP251XFD_REG_FIFOCON_FRESET BIT(10)\n#define MCP251XFD_REG_FIFOCON_TXREQ BIT(9)\n#define MCP251XFD_REG_FIFOCON_UINC BIT(8)\n#define MCP251XFD_REG_FIFOCON_TXEN BIT(7)\n#define MCP251XFD_REG_FIFOCON_RTREN BIT(6)\n#define MCP251XFD_REG_FIFOCON_RXTSEN BIT(5)\n#define MCP251XFD_REG_FIFOCON_TXATIE BIT(4)\n#define MCP251XFD_REG_FIFOCON_RXOVIE BIT(3)\n#define MCP251XFD_REG_FIFOCON_TFERFFIE BIT(2)\n#define MCP251XFD_REG_FIFOCON_TFHRFHIE BIT(1)\n#define MCP251XFD_REG_FIFOCON_TFNRFNIE BIT(0)\n\n#define MCP251XFD_REG_FIFOSTA(x) (0x54 + 0xc * (x))\n#define MCP251XFD_REG_FIFOSTA_FIFOCI_MASK GENMASK(12, 8)\n#define MCP251XFD_REG_FIFOSTA_TXABT BIT(7)\n#define MCP251XFD_REG_FIFOSTA_TXLARB BIT(6)\n#define MCP251XFD_REG_FIFOSTA_TXERR BIT(5)\n#define MCP251XFD_REG_FIFOSTA_TXATIF BIT(4)\n#define MCP251XFD_REG_FIFOSTA_RXOVIF BIT(3)\n#define MCP251XFD_REG_FIFOSTA_TFERFFIF BIT(2)\n#define MCP251XFD_REG_FIFOSTA_TFHRFHIF BIT(1)\n#define MCP251XFD_REG_FIFOSTA_TFNRFNIF BIT(0)\n\n#define MCP251XFD_REG_FIFOUA(x) (0x58 + 0xc * (x))\n\n#define MCP251XFD_REG_FLTCON(x) (0x1d0 + 0x4 * (x))\n#define MCP251XFD_REG_FLTCON_FLTEN3 BIT(31)\n#define MCP251XFD_REG_FLTCON_F3BP_MASK GENMASK(28, 24)\n#define MCP251XFD_REG_FLTCON_FLTEN2 BIT(23)\n#define MCP251XFD_REG_FLTCON_F2BP_MASK GENMASK(20, 16)\n#define MCP251XFD_REG_FLTCON_FLTEN1 BIT(15)\n#define MCP251XFD_REG_FLTCON_F1BP_MASK GENMASK(12, 8)\n#define MCP251XFD_REG_FLTCON_FLTEN0 BIT(7)\n#define MCP251XFD_REG_FLTCON_F0BP_MASK GENMASK(4, 0)\n#define MCP251XFD_REG_FLTCON_FLTEN(x) (BIT(7) << 8 * ((x) & 0x3))\n#define MCP251XFD_REG_FLTCON_FLT_MASK(x) (GENMASK(7, 0) << (8 * ((x) & 0x3)))\n#define MCP251XFD_REG_FLTCON_FBP(x, fifo) ((fifo) << 8 * ((x) & 0x3))\n\n#define MCP251XFD_REG_FLTOBJ(x) (0x1f0 + 0x8 * (x))\n#define MCP251XFD_REG_FLTOBJ_EXIDE BIT(30)\n#define MCP251XFD_REG_FLTOBJ_SID11 BIT(29)\n#define MCP251XFD_REG_FLTOBJ_EID_MASK GENMASK(28, 11)\n#define MCP251XFD_REG_FLTOBJ_SID_MASK GENMASK(10, 0)\n\n#define MCP251XFD_REG_FLTMASK(x) (0x1f4 + 0x8 * (x))\n#define MCP251XFD_REG_MASK_MIDE BIT(30)\n#define MCP251XFD_REG_MASK_MSID11 BIT(29)\n#define MCP251XFD_REG_MASK_MEID_MASK GENMASK(28, 11)\n#define MCP251XFD_REG_MASK_MSID_MASK GENMASK(10, 0)\n\n \n#define MCP251XFD_RAM_START 0x400\n#define MCP251XFD_RAM_SIZE SZ_2K\n\n \n#define MCP251XFD_OBJ_ID_SID11 BIT(29)\n#define MCP251XFD_OBJ_ID_EID_MASK GENMASK(28, 11)\n#define MCP251XFD_OBJ_ID_SID_MASK GENMASK(10, 0)\n#define MCP251XFD_OBJ_FLAGS_SEQ_MCP2518FD_MASK GENMASK(31, 9)\n#define MCP251XFD_OBJ_FLAGS_SEQ_MCP2517FD_MASK GENMASK(15, 9)\n#define MCP251XFD_OBJ_FLAGS_SEQ_MASK MCP251XFD_OBJ_FLAGS_SEQ_MCP2518FD_MASK\n#define MCP251XFD_OBJ_FLAGS_ESI BIT(8)\n#define MCP251XFD_OBJ_FLAGS_FDF BIT(7)\n#define MCP251XFD_OBJ_FLAGS_BRS BIT(6)\n#define MCP251XFD_OBJ_FLAGS_RTR BIT(5)\n#define MCP251XFD_OBJ_FLAGS_IDE BIT(4)\n#define MCP251XFD_OBJ_FLAGS_DLC_MASK GENMASK(3, 0)\n\n#define MCP251XFD_REG_FRAME_EFF_SID_MASK GENMASK(28, 18)\n#define MCP251XFD_REG_FRAME_EFF_EID_MASK GENMASK(17, 0)\n\n \n#define MCP251XFD_REG_OSC 0xe00\n#define MCP251XFD_REG_OSC_SCLKRDY BIT(12)\n#define MCP251XFD_REG_OSC_OSCRDY BIT(10)\n#define MCP251XFD_REG_OSC_PLLRDY BIT(8)\n#define MCP251XFD_REG_OSC_CLKODIV_10 3\n#define MCP251XFD_REG_OSC_CLKODIV_4 2\n#define MCP251XFD_REG_OSC_CLKODIV_2 1\n#define MCP251XFD_REG_OSC_CLKODIV_1 0\n#define MCP251XFD_REG_OSC_CLKODIV_MASK GENMASK(6, 5)\n#define MCP251XFD_REG_OSC_SCLKDIV BIT(4)\n#define MCP251XFD_REG_OSC_LPMEN BIT(3)\t \n#define MCP251XFD_REG_OSC_OSCDIS BIT(2)\n#define MCP251XFD_REG_OSC_PLLEN BIT(0)\n\n#define MCP251XFD_REG_IOCON 0xe04\n#define MCP251XFD_REG_IOCON_INTOD BIT(30)\n#define MCP251XFD_REG_IOCON_SOF BIT(29)\n#define MCP251XFD_REG_IOCON_TXCANOD BIT(28)\n#define MCP251XFD_REG_IOCON_PM1 BIT(25)\n#define MCP251XFD_REG_IOCON_PM0 BIT(24)\n#define MCP251XFD_REG_IOCON_GPIO1 BIT(17)\n#define MCP251XFD_REG_IOCON_GPIO0 BIT(16)\n#define MCP251XFD_REG_IOCON_LAT1 BIT(9)\n#define MCP251XFD_REG_IOCON_LAT0 BIT(8)\n#define MCP251XFD_REG_IOCON_XSTBYEN BIT(6)\n#define MCP251XFD_REG_IOCON_TRIS1 BIT(1)\n#define MCP251XFD_REG_IOCON_TRIS0 BIT(0)\n\n#define MCP251XFD_REG_CRC 0xe08\n#define MCP251XFD_REG_CRC_FERRIE BIT(25)\n#define MCP251XFD_REG_CRC_CRCERRIE BIT(24)\n#define MCP251XFD_REG_CRC_FERRIF BIT(17)\n#define MCP251XFD_REG_CRC_CRCERRIF BIT(16)\n#define MCP251XFD_REG_CRC_IF_MASK GENMASK(17, 16)\n#define MCP251XFD_REG_CRC_MASK GENMASK(15, 0)\n\n#define MCP251XFD_REG_ECCCON 0xe0c\n#define MCP251XFD_REG_ECCCON_PARITY_MASK GENMASK(14, 8)\n#define MCP251XFD_REG_ECCCON_DEDIE BIT(2)\n#define MCP251XFD_REG_ECCCON_SECIE BIT(1)\n#define MCP251XFD_REG_ECCCON_ECCEN BIT(0)\n\n#define MCP251XFD_REG_ECCSTAT 0xe10\n#define MCP251XFD_REG_ECCSTAT_ERRADDR_MASK GENMASK(27, 16)\n#define MCP251XFD_REG_ECCSTAT_IF_MASK GENMASK(2, 1)\n#define MCP251XFD_REG_ECCSTAT_DEDIF BIT(2)\n#define MCP251XFD_REG_ECCSTAT_SECIF BIT(1)\n\n#define MCP251XFD_REG_DEVID 0xe14\t \n#define MCP251XFD_REG_DEVID_ID_MASK GENMASK(7, 4)\n#define MCP251XFD_REG_DEVID_REV_MASK GENMASK(3, 0)\n\n \n#define MCP251XFD_SPI_INSTRUCTION_RESET 0x0000\n#define MCP251XFD_SPI_INSTRUCTION_WRITE 0x2000\n#define MCP251XFD_SPI_INSTRUCTION_READ 0x3000\n#define MCP251XFD_SPI_INSTRUCTION_WRITE_CRC 0xa000\n#define MCP251XFD_SPI_INSTRUCTION_READ_CRC 0xb000\n#define MCP251XFD_SPI_INSTRUCTION_WRITE_CRC_SAFE 0xc000\n#define MCP251XFD_SPI_ADDRESS_MASK GENMASK(11, 0)\n\n#define MCP251XFD_SYSCLOCK_HZ_MAX 40000000\n#define MCP251XFD_SYSCLOCK_HZ_MIN 1000000\n#define MCP251XFD_SPICLOCK_HZ_MAX 20000000\n#define MCP251XFD_TIMESTAMP_WORK_DELAY_SEC 45\nstatic_assert(MCP251XFD_TIMESTAMP_WORK_DELAY_SEC <\n\t      CYCLECOUNTER_MASK(32) / MCP251XFD_SYSCLOCK_HZ_MAX / 2);\n#define MCP251XFD_OSC_PLL_MULTIPLIER 10\n#define MCP251XFD_OSC_STAB_SLEEP_US (3 * USEC_PER_MSEC)\n#define MCP251XFD_OSC_STAB_TIMEOUT_US (10 * MCP251XFD_OSC_STAB_SLEEP_US)\n#define MCP251XFD_POLL_SLEEP_US (10)\n#define MCP251XFD_POLL_TIMEOUT_US (USEC_PER_MSEC)\n#define MCP251XFD_FRAME_LEN_MAX_BITS (736)\n\n \n#define MCP251XFD_NAPI_WEIGHT 32\n#define MCP251XFD_SOFTRESET_RETRIES_MAX 3\n#define MCP251XFD_READ_CRC_RETRIES_MAX 3\n#define MCP251XFD_ECC_CNT_MAX 2\n#define MCP251XFD_SANITIZE_SPI 1\n#define MCP251XFD_SANITIZE_CAN 1\n\n \n#define MCP251XFD_FIFO_TEF_NUM 1U\n#define MCP251XFD_FIFO_RX_NUM 3U\n#define MCP251XFD_FIFO_TX_NUM 1U\n\n#define MCP251XFD_FIFO_DEPTH 32U\n\n#define MCP251XFD_RX_OBJ_NUM_MIN 16U\n#define MCP251XFD_RX_OBJ_NUM_MAX (MCP251XFD_FIFO_RX_NUM * MCP251XFD_FIFO_DEPTH)\n#define MCP251XFD_RX_FIFO_DEPTH_MIN 4U\n#define MCP251XFD_RX_FIFO_DEPTH_COALESCE_MIN 8U\n\n#define MCP251XFD_TX_OBJ_NUM_MIN 2U\n#define MCP251XFD_TX_OBJ_NUM_MAX 16U\n#define MCP251XFD_TX_OBJ_NUM_CAN_DEFAULT 8U\n#define MCP251XFD_TX_OBJ_NUM_CANFD_DEFAULT 4U\n#define MCP251XFD_TX_FIFO_DEPTH_MIN 2U\n#define MCP251XFD_TX_FIFO_DEPTH_COALESCE_MIN 2U\n\nstatic_assert(MCP251XFD_FIFO_TEF_NUM == 1U);\nstatic_assert(MCP251XFD_FIFO_TEF_NUM == MCP251XFD_FIFO_TX_NUM);\nstatic_assert(MCP251XFD_FIFO_RX_NUM <= 4U);\n\n \n#define MCP251XFD_QUIRK_MAB_NO_WARN BIT(0)\n \n#define MCP251XFD_QUIRK_CRC_REG BIT(1)\n \n#define MCP251XFD_QUIRK_CRC_RX BIT(2)\n \n#define MCP251XFD_QUIRK_CRC_TX BIT(3)\n \n#define MCP251XFD_QUIRK_ECC BIT(4)\n \n#define MCP251XFD_QUIRK_HALF_DUPLEX BIT(5)\n\nstruct mcp251xfd_hw_tef_obj {\n\tu32 id;\n\tu32 flags;\n\tu32 ts;\n};\n\n \nstruct __packed mcp251xfd_hw_tx_obj_raw {\n\t__le32 id;\n\t__le32 flags;\n\tu8 data[sizeof_field(struct canfd_frame, data)];\n};\n\nstruct mcp251xfd_hw_tx_obj_can {\n\tu32 id;\n\tu32 flags;\n\tu8 data[sizeof_field(struct can_frame, data)];\n};\n\nstruct mcp251xfd_hw_tx_obj_canfd {\n\tu32 id;\n\tu32 flags;\n\tu8 data[sizeof_field(struct canfd_frame, data)];\n};\n\nstruct mcp251xfd_hw_rx_obj_can {\n\tu32 id;\n\tu32 flags;\n\tu32 ts;\n\tu8 data[sizeof_field(struct can_frame, data)];\n};\n\nstruct mcp251xfd_hw_rx_obj_canfd {\n\tu32 id;\n\tu32 flags;\n\tu32 ts;\n\tu8 data[sizeof_field(struct canfd_frame, data)];\n};\n\nstruct __packed mcp251xfd_buf_cmd {\n\t__be16 cmd;\n};\n\nstruct __packed mcp251xfd_buf_cmd_crc {\n\t__be16 cmd;\n\tu8 len;\n};\n\nunion mcp251xfd_tx_obj_load_buf {\n\tstruct __packed {\n\t\tstruct mcp251xfd_buf_cmd cmd;\n\t\tstruct mcp251xfd_hw_tx_obj_raw hw_tx_obj;\n\t} nocrc;\n\tstruct __packed {\n\t\tstruct mcp251xfd_buf_cmd_crc cmd;\n\t\tstruct mcp251xfd_hw_tx_obj_raw hw_tx_obj;\n\t\t__be16 crc;\n\t} crc;\n} ____cacheline_aligned;\n\nunion mcp251xfd_write_reg_buf {\n\tstruct __packed {\n\t\tstruct mcp251xfd_buf_cmd cmd;\n\t\tu8 data[4];\n\t} nocrc;\n\tstruct __packed {\n\t\tstruct mcp251xfd_buf_cmd_crc cmd;\n\t\tu8 data[4];\n\t\t__be16 crc;\n\t} crc;\n\tstruct __packed {\n\t\tstruct mcp251xfd_buf_cmd cmd;\n\t\tu8 data[1];\n\t\t__be16 crc;\n\t} safe;\n} ____cacheline_aligned;\n\nstruct mcp251xfd_tx_obj {\n\tstruct spi_message msg;\n\tstruct spi_transfer xfer[2];\n\tunion mcp251xfd_tx_obj_load_buf buf;\n};\n\nstruct mcp251xfd_tef_ring {\n\tunsigned int head;\n\tunsigned int tail;\n\n\t \n\t \n\n\tunion mcp251xfd_write_reg_buf irq_enable_buf;\n\tstruct spi_transfer irq_enable_xfer;\n\tstruct spi_message irq_enable_msg;\n\n\tunion mcp251xfd_write_reg_buf uinc_buf;\n\tunion mcp251xfd_write_reg_buf uinc_irq_disable_buf;\n\tstruct spi_transfer uinc_xfer[MCP251XFD_TX_OBJ_NUM_MAX];\n};\n\nstruct mcp251xfd_tx_ring {\n\tunsigned int head;\n\tunsigned int tail;\n\n\tu16 base;\n\tu8 nr;\n\tu8 fifo_nr;\n\tu8 obj_num;\n\tu8 obj_size;\n\n\tstruct mcp251xfd_tx_obj obj[MCP251XFD_TX_OBJ_NUM_MAX];\n\tunion mcp251xfd_write_reg_buf rts_buf;\n};\n\nstruct mcp251xfd_rx_ring {\n\tunsigned int head;\n\tunsigned int tail;\n\n\tu16 base;\n\tu8 nr;\n\tu8 fifo_nr;\n\tu8 obj_num;\n\tu8 obj_size;\n\n\tunion mcp251xfd_write_reg_buf irq_enable_buf;\n\tstruct spi_transfer irq_enable_xfer;\n\tstruct spi_message irq_enable_msg;\n\n\tunion mcp251xfd_write_reg_buf uinc_buf;\n\tunion mcp251xfd_write_reg_buf uinc_irq_disable_buf;\n\tstruct spi_transfer uinc_xfer[MCP251XFD_FIFO_DEPTH];\n\tstruct mcp251xfd_hw_rx_obj_canfd obj[];\n};\n\nstruct __packed mcp251xfd_map_buf_nocrc {\n\tstruct mcp251xfd_buf_cmd cmd;\n\tu8 data[256];\n} ____cacheline_aligned;\n\nstruct __packed mcp251xfd_map_buf_crc {\n\tstruct mcp251xfd_buf_cmd_crc cmd;\n\tu8 data[256 - 4];\n\t__be16 crc;\n} ____cacheline_aligned;\n\nstruct mcp251xfd_ecc {\n\tu32 ecc_stat;\n\tint cnt;\n};\n\nstruct mcp251xfd_regs_status {\n\tu32 intf;\n\tu32 rxif;\n};\n\nenum mcp251xfd_model {\n\tMCP251XFD_MODEL_MCP2517FD = 0x2517,\n\tMCP251XFD_MODEL_MCP2518FD = 0x2518,\n\tMCP251XFD_MODEL_MCP251863 = 0x251863,\n\tMCP251XFD_MODEL_MCP251XFD = 0xffffffff,\t \n};\n\nstruct mcp251xfd_devtype_data {\n\tenum mcp251xfd_model model;\n\tu32 quirks;\n};\n\nenum mcp251xfd_flags {\n\tMCP251XFD_FLAGS_DOWN,\n\tMCP251XFD_FLAGS_FD_MODE,\n\n\t__MCP251XFD_FLAGS_SIZE__\n};\n\nstruct mcp251xfd_priv {\n\tstruct can_priv can;\n\tstruct can_rx_offload offload;\n\tstruct net_device *ndev;\n\n\tstruct regmap *map_reg;\t\t\t \n\tstruct regmap *map_rx;\t\t\t \n\n\tstruct regmap *map_nocrc;\n\tstruct mcp251xfd_map_buf_nocrc *map_buf_nocrc_rx;\n\tstruct mcp251xfd_map_buf_nocrc *map_buf_nocrc_tx;\n\n\tstruct regmap *map_crc;\n\tstruct mcp251xfd_map_buf_crc *map_buf_crc_rx;\n\tstruct mcp251xfd_map_buf_crc *map_buf_crc_tx;\n\n\tstruct spi_device *spi;\n\tu32 spi_max_speed_hz_orig;\n\tu32 spi_max_speed_hz_fast;\n\tu32 spi_max_speed_hz_slow;\n\n\tstruct mcp251xfd_tef_ring tef[MCP251XFD_FIFO_TEF_NUM];\n\tstruct mcp251xfd_rx_ring *rx[MCP251XFD_FIFO_RX_NUM];\n\tstruct mcp251xfd_tx_ring tx[MCP251XFD_FIFO_TX_NUM];\n\n\tDECLARE_BITMAP(flags, __MCP251XFD_FLAGS_SIZE__);\n\n\tu8 rx_ring_num;\n\tu8 rx_obj_num;\n\tu8 rx_obj_num_coalesce_irq;\n\tu8 tx_obj_num_coalesce_irq;\n\n\tu32 rx_coalesce_usecs_irq;\n\tu32 tx_coalesce_usecs_irq;\n\tstruct hrtimer rx_irq_timer;\n\tstruct hrtimer tx_irq_timer;\n\n\tstruct mcp251xfd_ecc ecc;\n\tstruct mcp251xfd_regs_status regs_status;\n\n\tstruct cyclecounter cc;\n\tstruct timecounter tc;\n\tstruct delayed_work timestamp;\n\n\tstruct gpio_desc *rx_int;\n\tstruct clk *clk;\n\tbool pll_enable;\n\tstruct regulator *reg_vdd;\n\tstruct regulator *reg_xceiver;\n\n\tstruct mcp251xfd_devtype_data devtype_data;\n\tstruct can_berr_counter bec;\n};\n\n#define MCP251XFD_IS(_model) \\\nstatic inline bool \\\nmcp251xfd_is_##_model(const struct mcp251xfd_priv *priv) \\\n{ \\\n\treturn priv->devtype_data.model == MCP251XFD_MODEL_MCP##_model; \\\n}\n\nMCP251XFD_IS(2517FD);\nMCP251XFD_IS(2518FD);\nMCP251XFD_IS(251863);\nMCP251XFD_IS(251XFD);\n\nstatic inline bool mcp251xfd_is_fd_mode(const struct mcp251xfd_priv *priv)\n{\n\t \n\treturn priv->can.ctrlmode & (CAN_CTRLMODE_LISTENONLY | CAN_CTRLMODE_FD);\n}\n\nstatic inline u8 mcp251xfd_first_byte_set(u32 mask)\n{\n\treturn (mask & 0x0000ffff) ?\n\t\t((mask & 0x000000ff) ? 0 : 1) :\n\t\t((mask & 0x00ff0000) ? 2 : 3);\n}\n\nstatic inline u8 mcp251xfd_last_byte_set(u32 mask)\n{\n\treturn (mask & 0xffff0000) ?\n\t\t((mask & 0xff000000) ? 3 : 2) :\n\t\t((mask & 0x0000ff00) ? 1 : 0);\n}\n\nstatic inline __be16 mcp251xfd_cmd_reset(void)\n{\n\treturn cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_RESET);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_read_nocrc(struct mcp251xfd_buf_cmd *cmd, u16 addr)\n{\n\tcmd->cmd = cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_READ | addr);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_write_nocrc(struct mcp251xfd_buf_cmd *cmd, u16 addr)\n{\n\tcmd->cmd = cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_WRITE | addr);\n}\n\nstatic inline bool mcp251xfd_reg_in_ram(unsigned int reg)\n{\n\tstatic const struct regmap_range range =\n\t\tregmap_reg_range(MCP251XFD_RAM_START,\n\t\t\t\t MCP251XFD_RAM_START + MCP251XFD_RAM_SIZE - 4);\n\n\treturn regmap_reg_in_range(reg, &range);\n}\n\nstatic inline void\n__mcp251xfd_spi_cmd_crc_set_len(struct mcp251xfd_buf_cmd_crc *cmd,\n\t\t\t\tu16 len, bool in_ram)\n{\n\t \n\tif (in_ram)\n\t\tcmd->len = len >> 2;\n\telse\n\t\tcmd->len = len;\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_crc_set_len_in_ram(struct mcp251xfd_buf_cmd_crc *cmd, u16 len)\n{\n\t__mcp251xfd_spi_cmd_crc_set_len(cmd, len, true);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_crc_set_len_in_reg(struct mcp251xfd_buf_cmd_crc *cmd, u16 len)\n{\n\t__mcp251xfd_spi_cmd_crc_set_len(cmd, len, false);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_read_crc_set_addr(struct mcp251xfd_buf_cmd_crc *cmd, u16 addr)\n{\n\tcmd->cmd = cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_READ_CRC | addr);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_read_crc(struct mcp251xfd_buf_cmd_crc *cmd,\n\t\t\t   u16 addr, u16 len)\n{\n\tmcp251xfd_spi_cmd_read_crc_set_addr(cmd, addr);\n\t__mcp251xfd_spi_cmd_crc_set_len(cmd, len, mcp251xfd_reg_in_ram(addr));\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_write_crc_set_addr(struct mcp251xfd_buf_cmd_crc *cmd,\n\t\t\t\t     u16 addr)\n{\n\tcmd->cmd = cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_WRITE_CRC | addr);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_write_safe_set_addr(struct mcp251xfd_buf_cmd *cmd,\n\t\t\t\t     u16 addr)\n{\n\tcmd->cmd = cpu_to_be16(MCP251XFD_SPI_INSTRUCTION_WRITE_CRC_SAFE | addr);\n}\n\nstatic inline void\nmcp251xfd_spi_cmd_write_crc(struct mcp251xfd_buf_cmd_crc *cmd,\n\t\t\t    u16 addr, u16 len)\n{\n\tmcp251xfd_spi_cmd_write_crc_set_addr(cmd, addr);\n\t__mcp251xfd_spi_cmd_crc_set_len(cmd, len, mcp251xfd_reg_in_ram(addr));\n}\n\nstatic inline u8 *\nmcp251xfd_spi_cmd_write(const struct mcp251xfd_priv *priv,\n\t\t\tunion mcp251xfd_write_reg_buf *write_reg_buf,\n\t\t\tu16 addr, u8 len)\n{\n\tu8 *data;\n\n\tif (priv->devtype_data.quirks & MCP251XFD_QUIRK_CRC_REG) {\n\t\tif (len == 1) {\n\t\t\tmcp251xfd_spi_cmd_write_safe_set_addr(&write_reg_buf->safe.cmd,\n\t\t\t\t\t\t\t     addr);\n\t\t\tdata = write_reg_buf->safe.data;\n\t\t} else {\n\t\t\tmcp251xfd_spi_cmd_write_crc_set_addr(&write_reg_buf->crc.cmd,\n\t\t\t\t\t\t\t     addr);\n\t\t\tdata = write_reg_buf->crc.data;\n\t\t}\n\t} else {\n\t\tmcp251xfd_spi_cmd_write_nocrc(&write_reg_buf->nocrc.cmd,\n\t\t\t\t\t      addr);\n\t\tdata = write_reg_buf->nocrc.data;\n\t}\n\n\treturn data;\n}\n\nstatic inline int mcp251xfd_get_timestamp(const struct mcp251xfd_priv *priv,\n\t\t\t\t\t  u32 *timestamp)\n{\n\treturn regmap_read(priv->map_reg, MCP251XFD_REG_TBC, timestamp);\n}\n\nstatic inline u16 mcp251xfd_get_tef_obj_addr(u8 n)\n{\n\treturn MCP251XFD_RAM_START +\n\t\tsizeof(struct mcp251xfd_hw_tef_obj) * n;\n}\n\nstatic inline u16\nmcp251xfd_get_tx_obj_addr(const struct mcp251xfd_tx_ring *ring, u8 n)\n{\n\treturn ring->base + ring->obj_size * n;\n}\n\nstatic inline u16\nmcp251xfd_get_rx_obj_addr(const struct mcp251xfd_rx_ring *ring, u8 n)\n{\n\treturn ring->base + ring->obj_size * n;\n}\n\nstatic inline int\nmcp251xfd_tx_tail_get_from_chip(const struct mcp251xfd_priv *priv,\n\t\t\t\tu8 *tx_tail)\n{\n\tu32 fifo_sta;\n\tint err;\n\n\terr = regmap_read(priv->map_reg,\n\t\t\t  MCP251XFD_REG_FIFOSTA(priv->tx->fifo_nr),\n\t\t\t  &fifo_sta);\n\tif (err)\n\t\treturn err;\n\n\t*tx_tail = FIELD_GET(MCP251XFD_REG_FIFOSTA_FIFOCI_MASK, fifo_sta);\n\n\treturn 0;\n}\n\nstatic inline u8 mcp251xfd_get_tef_head(const struct mcp251xfd_priv *priv)\n{\n\treturn priv->tef->head & (priv->tx->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_tef_tail(const struct mcp251xfd_priv *priv)\n{\n\treturn priv->tef->tail & (priv->tx->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_tef_len(const struct mcp251xfd_priv *priv)\n{\n\treturn priv->tef->head - priv->tef->tail;\n}\n\nstatic inline u8 mcp251xfd_get_tef_linear_len(const struct mcp251xfd_priv *priv)\n{\n\tu8 len;\n\n\tlen = mcp251xfd_get_tef_len(priv);\n\n\treturn min_t(u8, len, priv->tx->obj_num - mcp251xfd_get_tef_tail(priv));\n}\n\nstatic inline u8 mcp251xfd_get_tx_head(const struct mcp251xfd_tx_ring *ring)\n{\n\treturn ring->head & (ring->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_tx_tail(const struct mcp251xfd_tx_ring *ring)\n{\n\treturn ring->tail & (ring->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_tx_free(const struct mcp251xfd_tx_ring *ring)\n{\n\treturn ring->obj_num - (ring->head - ring->tail);\n}\n\nstatic inline int\nmcp251xfd_get_tx_nr_by_addr(const struct mcp251xfd_tx_ring *tx_ring, u8 *nr,\n\t\t\t    u16 addr)\n{\n\tif (addr < mcp251xfd_get_tx_obj_addr(tx_ring, 0) ||\n\t    addr >= mcp251xfd_get_tx_obj_addr(tx_ring, tx_ring->obj_num))\n\t\treturn -ENOENT;\n\n\t*nr = (addr - mcp251xfd_get_tx_obj_addr(tx_ring, 0)) /\n\t\ttx_ring->obj_size;\n\n\treturn 0;\n}\n\nstatic inline u8 mcp251xfd_get_rx_head(const struct mcp251xfd_rx_ring *ring)\n{\n\treturn ring->head & (ring->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_rx_tail(const struct mcp251xfd_rx_ring *ring)\n{\n\treturn ring->tail & (ring->obj_num - 1);\n}\n\nstatic inline u8 mcp251xfd_get_rx_len(const struct mcp251xfd_rx_ring *ring)\n{\n\treturn ring->head - ring->tail;\n}\n\nstatic inline u8\nmcp251xfd_get_rx_linear_len(const struct mcp251xfd_rx_ring *ring)\n{\n\tu8 len;\n\n\tlen = mcp251xfd_get_rx_len(ring);\n\n\treturn min_t(u8, len, ring->obj_num - mcp251xfd_get_rx_tail(ring));\n}\n\n#define mcp251xfd_for_each_tx_obj(ring, _obj, n) \\\n\tfor ((n) = 0, (_obj) = &(ring)->obj[(n)]; \\\n\t     (n) < (ring)->obj_num; \\\n\t     (n)++, (_obj) = &(ring)->obj[(n)])\n\n#define mcp251xfd_for_each_rx_ring(priv, ring, n) \\\n\tfor ((n) = 0, (ring) = *((priv)->rx + (n)); \\\n\t     (n) < (priv)->rx_ring_num; \\\n\t     (n)++, (ring) = *((priv)->rx + (n)))\n\nint mcp251xfd_chip_fifo_init(const struct mcp251xfd_priv *priv);\nu16 mcp251xfd_crc16_compute2(const void *cmd, size_t cmd_size,\n\t\t\t     const void *data, size_t data_size);\nu16 mcp251xfd_crc16_compute(const void *data, size_t data_size);\nvoid mcp251xfd_ethtool_init(struct mcp251xfd_priv *priv);\nint mcp251xfd_regmap_init(struct mcp251xfd_priv *priv);\nextern const struct can_ram_config mcp251xfd_ram_config;\nint mcp251xfd_ring_init(struct mcp251xfd_priv *priv);\nvoid mcp251xfd_ring_free(struct mcp251xfd_priv *priv);\nint mcp251xfd_ring_alloc(struct mcp251xfd_priv *priv);\nint mcp251xfd_handle_rxif(struct mcp251xfd_priv *priv);\nint mcp251xfd_handle_tefif(struct mcp251xfd_priv *priv);\nvoid mcp251xfd_skb_set_timestamp(const struct mcp251xfd_priv *priv,\n\t\t\t\t struct sk_buff *skb, u32 timestamp);\nvoid mcp251xfd_timestamp_init(struct mcp251xfd_priv *priv);\nvoid mcp251xfd_timestamp_stop(struct mcp251xfd_priv *priv);\n\nnetdev_tx_t mcp251xfd_start_xmit(struct sk_buff *skb,\n\t\t\t\t struct net_device *ndev);\n\n#if IS_ENABLED(CONFIG_DEV_COREDUMP)\nvoid mcp251xfd_dump(const struct mcp251xfd_priv *priv);\n#else\nstatic inline void mcp251xfd_dump(const struct mcp251xfd_priv *priv)\n{\n}\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}