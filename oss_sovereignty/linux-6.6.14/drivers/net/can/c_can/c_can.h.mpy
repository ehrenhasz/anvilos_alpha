{
  "module_name": "c_can.h",
  "hash_id": "0266cd3976ad2de4444658c01890ddf152473c2443669cedf2857d71c9945c47",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/can/c_can/c_can.h",
  "human_readable_source": " \n\n#ifndef C_CAN_H\n#define C_CAN_H\n\nenum reg {\n\tC_CAN_CTRL_REG = 0,\n\tC_CAN_CTRL_EX_REG,\n\tC_CAN_STS_REG,\n\tC_CAN_ERR_CNT_REG,\n\tC_CAN_BTR_REG,\n\tC_CAN_INT_REG,\n\tC_CAN_TEST_REG,\n\tC_CAN_BRPEXT_REG,\n\tC_CAN_IF1_COMREQ_REG,\n\tC_CAN_IF1_COMMSK_REG,\n\tC_CAN_IF1_MASK1_REG,\n\tC_CAN_IF1_MASK2_REG,\n\tC_CAN_IF1_ARB1_REG,\n\tC_CAN_IF1_ARB2_REG,\n\tC_CAN_IF1_MSGCTRL_REG,\n\tC_CAN_IF1_DATA1_REG,\n\tC_CAN_IF1_DATA2_REG,\n\tC_CAN_IF1_DATA3_REG,\n\tC_CAN_IF1_DATA4_REG,\n\tC_CAN_IF2_COMREQ_REG,\n\tC_CAN_IF2_COMMSK_REG,\n\tC_CAN_IF2_MASK1_REG,\n\tC_CAN_IF2_MASK2_REG,\n\tC_CAN_IF2_ARB1_REG,\n\tC_CAN_IF2_ARB2_REG,\n\tC_CAN_IF2_MSGCTRL_REG,\n\tC_CAN_IF2_DATA1_REG,\n\tC_CAN_IF2_DATA2_REG,\n\tC_CAN_IF2_DATA3_REG,\n\tC_CAN_IF2_DATA4_REG,\n\tC_CAN_TXRQST1_REG,\n\tC_CAN_TXRQST2_REG,\n\tC_CAN_NEWDAT1_REG,\n\tC_CAN_NEWDAT2_REG,\n\tC_CAN_INTPND1_REG,\n\tC_CAN_INTPND2_REG,\n\tC_CAN_INTPND3_REG,\n\tC_CAN_MSGVAL1_REG,\n\tC_CAN_MSGVAL2_REG,\n\tC_CAN_FUNCTION_REG,\n};\n\nstatic const u16 __maybe_unused reg_map_c_can[] = {\n\t[C_CAN_CTRL_REG]\t= 0x00,\n\t[C_CAN_STS_REG]\t\t= 0x02,\n\t[C_CAN_ERR_CNT_REG]\t= 0x04,\n\t[C_CAN_BTR_REG]\t\t= 0x06,\n\t[C_CAN_INT_REG]\t\t= 0x08,\n\t[C_CAN_TEST_REG]\t= 0x0A,\n\t[C_CAN_BRPEXT_REG]\t= 0x0C,\n\t[C_CAN_IF1_COMREQ_REG]\t= 0x10,\n\t[C_CAN_IF1_COMMSK_REG]\t= 0x12,\n\t[C_CAN_IF1_MASK1_REG]\t= 0x14,\n\t[C_CAN_IF1_MASK2_REG]\t= 0x16,\n\t[C_CAN_IF1_ARB1_REG]\t= 0x18,\n\t[C_CAN_IF1_ARB2_REG]\t= 0x1A,\n\t[C_CAN_IF1_MSGCTRL_REG]\t= 0x1C,\n\t[C_CAN_IF1_DATA1_REG]\t= 0x1E,\n\t[C_CAN_IF1_DATA2_REG]\t= 0x20,\n\t[C_CAN_IF1_DATA3_REG]\t= 0x22,\n\t[C_CAN_IF1_DATA4_REG]\t= 0x24,\n\t[C_CAN_IF2_COMREQ_REG]\t= 0x40,\n\t[C_CAN_IF2_COMMSK_REG]\t= 0x42,\n\t[C_CAN_IF2_MASK1_REG]\t= 0x44,\n\t[C_CAN_IF2_MASK2_REG]\t= 0x46,\n\t[C_CAN_IF2_ARB1_REG]\t= 0x48,\n\t[C_CAN_IF2_ARB2_REG]\t= 0x4A,\n\t[C_CAN_IF2_MSGCTRL_REG]\t= 0x4C,\n\t[C_CAN_IF2_DATA1_REG]\t= 0x4E,\n\t[C_CAN_IF2_DATA2_REG]\t= 0x50,\n\t[C_CAN_IF2_DATA3_REG]\t= 0x52,\n\t[C_CAN_IF2_DATA4_REG]\t= 0x54,\n\t[C_CAN_TXRQST1_REG]\t= 0x80,\n\t[C_CAN_TXRQST2_REG]\t= 0x82,\n\t[C_CAN_NEWDAT1_REG]\t= 0x90,\n\t[C_CAN_NEWDAT2_REG]\t= 0x92,\n\t[C_CAN_INTPND1_REG]\t= 0xA0,\n\t[C_CAN_INTPND2_REG]\t= 0xA2,\n\t[C_CAN_MSGVAL1_REG]\t= 0xB0,\n\t[C_CAN_MSGVAL2_REG]\t= 0xB2,\n};\n\nstatic const u16 __maybe_unused reg_map_d_can[] = {\n\t[C_CAN_CTRL_REG]\t= 0x00,\n\t[C_CAN_CTRL_EX_REG]\t= 0x02,\n\t[C_CAN_STS_REG]\t\t= 0x04,\n\t[C_CAN_ERR_CNT_REG]\t= 0x08,\n\t[C_CAN_BTR_REG]\t\t= 0x0C,\n\t[C_CAN_BRPEXT_REG]\t= 0x0E,\n\t[C_CAN_INT_REG]\t\t= 0x10,\n\t[C_CAN_TEST_REG]\t= 0x14,\n\t[C_CAN_FUNCTION_REG]\t= 0x18,\n\t[C_CAN_TXRQST1_REG]\t= 0x88,\n\t[C_CAN_TXRQST2_REG]\t= 0x8A,\n\t[C_CAN_NEWDAT1_REG]\t= 0x9C,\n\t[C_CAN_NEWDAT2_REG]\t= 0x9E,\n\t[C_CAN_INTPND1_REG]\t= 0xB0,\n\t[C_CAN_INTPND2_REG]\t= 0xB2,\n\t[C_CAN_INTPND3_REG]\t= 0xB4,\n\t[C_CAN_MSGVAL1_REG]\t= 0xC4,\n\t[C_CAN_MSGVAL2_REG]\t= 0xC6,\n\t[C_CAN_IF1_COMREQ_REG]\t= 0x100,\n\t[C_CAN_IF1_COMMSK_REG]\t= 0x102,\n\t[C_CAN_IF1_MASK1_REG]\t= 0x104,\n\t[C_CAN_IF1_MASK2_REG]\t= 0x106,\n\t[C_CAN_IF1_ARB1_REG]\t= 0x108,\n\t[C_CAN_IF1_ARB2_REG]\t= 0x10A,\n\t[C_CAN_IF1_MSGCTRL_REG]\t= 0x10C,\n\t[C_CAN_IF1_DATA1_REG]\t= 0x110,\n\t[C_CAN_IF1_DATA2_REG]\t= 0x112,\n\t[C_CAN_IF1_DATA3_REG]\t= 0x114,\n\t[C_CAN_IF1_DATA4_REG]\t= 0x116,\n\t[C_CAN_IF2_COMREQ_REG]\t= 0x120,\n\t[C_CAN_IF2_COMMSK_REG]\t= 0x122,\n\t[C_CAN_IF2_MASK1_REG]\t= 0x124,\n\t[C_CAN_IF2_MASK2_REG]\t= 0x126,\n\t[C_CAN_IF2_ARB1_REG]\t= 0x128,\n\t[C_CAN_IF2_ARB2_REG]\t= 0x12A,\n\t[C_CAN_IF2_MSGCTRL_REG]\t= 0x12C,\n\t[C_CAN_IF2_DATA1_REG]\t= 0x130,\n\t[C_CAN_IF2_DATA2_REG]\t= 0x132,\n\t[C_CAN_IF2_DATA3_REG]\t= 0x134,\n\t[C_CAN_IF2_DATA4_REG]\t= 0x136,\n};\n\nenum c_can_dev_id {\n\tBOSCH_C_CAN,\n\tBOSCH_D_CAN,\n};\n\nstruct raminit_bits {\n\tu8 start;\n\tu8 done;\n};\n\nstruct c_can_driver_data {\n\tenum c_can_dev_id id;\n\tunsigned int msg_obj_num;\n\n\t \n\tconst struct raminit_bits *raminit_bits;  \n\tu8 raminit_num;\t\t \n\tbool raminit_pulse;\t \n};\n\n \nstruct c_can_raminit {\n\tstruct regmap *syscon;\t \n\tunsigned int reg;\t \n\tstruct raminit_bits bits;\n\tbool needs_pulse;\n};\n\n \nstruct c_can_tx_ring {\n\tunsigned int head;\n\tunsigned int tail;\n\tunsigned int obj_num;\n};\n\n \nstruct c_can_priv {\n\tstruct can_priv can;\t \n\tstruct napi_struct napi;\n\tstruct net_device *dev;\n\tstruct device *device;\n\tunsigned int msg_obj_num;\n\tunsigned int msg_obj_rx_num;\n\tunsigned int msg_obj_tx_num;\n\tunsigned int msg_obj_rx_first;\n\tunsigned int msg_obj_rx_last;\n\tunsigned int msg_obj_tx_first;\n\tunsigned int msg_obj_tx_last;\n\tu32 msg_obj_rx_mask;\n\tatomic_t sie_pending;\n\tunsigned long tx_dir;\n\tint last_status;\n\tstruct c_can_tx_ring tx;\n\tu16 (*read_reg)(const struct c_can_priv *priv, enum reg index);\n\tvoid (*write_reg)(const struct c_can_priv *priv, enum reg index, u16 val);\n\tu32 (*read_reg32)(const struct c_can_priv *priv, enum reg index);\n\tvoid (*write_reg32)(const struct c_can_priv *priv, enum reg index, u32 val);\n\tvoid __iomem *base;\n\tconst u16 *regs;\n\tenum c_can_dev_id type;\n\tstruct c_can_raminit raminit_sys;\t \n\tvoid (*raminit)(const struct c_can_priv *priv, bool enable);\n\tu32 comm_rcv_high;\n};\n\nstruct net_device *alloc_c_can_dev(int msg_obj_num);\nvoid free_c_can_dev(struct net_device *dev);\nint register_c_can_dev(struct net_device *dev);\nvoid unregister_c_can_dev(struct net_device *dev);\n\n#ifdef CONFIG_PM\nint c_can_power_up(struct net_device *dev);\nint c_can_power_down(struct net_device *dev);\n#endif\n\nextern const struct ethtool_ops c_can_ethtool_ops;\n\nstatic inline u8 c_can_get_tx_head(const struct c_can_tx_ring *ring)\n{\n\treturn ring->head & (ring->obj_num - 1);\n}\n\nstatic inline u8 c_can_get_tx_tail(const struct c_can_tx_ring *ring)\n{\n\treturn ring->tail & (ring->obj_num - 1);\n}\n\nstatic inline u8 c_can_get_tx_free(const struct c_can_priv *priv,\n\t\t\t\t   const struct c_can_tx_ring *ring)\n{\n\tu8 head = c_can_get_tx_head(ring);\n\tu8 tail = c_can_get_tx_tail(ring);\n\n\tif (priv->type == BOSCH_D_CAN)\n\t\treturn ring->obj_num - (ring->head - ring->tail);\n\n\t \n\tif (head < tail)\n\t\treturn 0;\n\n\treturn ring->obj_num - head;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}