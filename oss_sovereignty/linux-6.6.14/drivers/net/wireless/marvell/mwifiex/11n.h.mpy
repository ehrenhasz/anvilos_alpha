{
  "module_name": "11n.h",
  "hash_id": "9765d44ac78e4ef8a4fda55680f3d03a4711d3e498b5c47e030099d5486c1ab1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/marvell/mwifiex/11n.h",
  "human_readable_source": " \n \n\n#ifndef _MWIFIEX_11N_H_\n#define _MWIFIEX_11N_H_\n\n#include \"11n_aggr.h\"\n#include \"11n_rxreorder.h\"\n#include \"wmm.h\"\n\nint mwifiex_ret_11n_delba(struct mwifiex_private *priv,\n\t\t\t  struct host_cmd_ds_command *resp);\nint mwifiex_ret_11n_addba_req(struct mwifiex_private *priv,\n\t\t\t      struct host_cmd_ds_command *resp);\nint mwifiex_cmd_11n_cfg(struct mwifiex_private *priv,\n\t\t\tstruct host_cmd_ds_command *cmd, u16 cmd_action,\n\t\t\tstruct mwifiex_ds_11n_tx_cfg *txcfg);\nint mwifiex_cmd_append_11n_tlv(struct mwifiex_private *priv,\n\t\t\t       struct mwifiex_bssdescriptor *bss_desc,\n\t\t\t       u8 **buffer);\nint mwifiex_fill_cap_info(struct mwifiex_private *, u8 radio_type,\n\t\t\t  struct ieee80211_ht_cap *);\nint mwifiex_set_get_11n_htcap_cfg(struct mwifiex_private *priv,\n\t\t\t\t  u16 action, int *htcap_cfg);\nvoid mwifiex_11n_delete_tx_ba_stream_tbl_entry(struct mwifiex_private *priv,\n\t\t\t\t\t     struct mwifiex_tx_ba_stream_tbl\n\t\t\t\t\t     *tx_tbl);\nvoid mwifiex_11n_delete_all_tx_ba_stream_tbl(struct mwifiex_private *priv);\nstruct mwifiex_tx_ba_stream_tbl *mwifiex_get_ba_tbl(struct\n\t\t\t\t\t\t\t     mwifiex_private\n\t\t\t\t\t\t\t     *priv, int tid,\n\t\t\t\t\t\t\t     u8 *ra);\nvoid mwifiex_create_ba_tbl(struct mwifiex_private *priv, u8 *ra, int tid,\n\t\t\t   enum mwifiex_ba_status ba_status);\nint mwifiex_send_addba(struct mwifiex_private *priv, int tid, u8 *peer_mac);\nint mwifiex_send_delba(struct mwifiex_private *priv, int tid, u8 *peer_mac,\n\t\t       int initiator);\nvoid mwifiex_11n_delete_ba_stream(struct mwifiex_private *priv, u8 *del_ba);\nint mwifiex_get_rx_reorder_tbl(struct mwifiex_private *priv,\n\t\t\t      struct mwifiex_ds_rx_reorder_tbl *buf);\nint mwifiex_get_tx_ba_stream_tbl(struct mwifiex_private *priv,\n\t\t\t       struct mwifiex_ds_tx_ba_stream_tbl *buf);\nint mwifiex_cmd_recfg_tx_buf(struct mwifiex_private *priv,\n\t\t\t     struct host_cmd_ds_command *cmd,\n\t\t\t     int cmd_action, u16 *buf_size);\nint mwifiex_cmd_amsdu_aggr_ctrl(struct host_cmd_ds_command *cmd,\n\t\t\t\tint cmd_action,\n\t\t\t\tstruct mwifiex_ds_11n_amsdu_aggr_ctrl *aa_ctrl);\nvoid mwifiex_del_tx_ba_stream_tbl_by_ra(struct mwifiex_private *priv, u8 *ra);\nu8 mwifiex_get_sec_chan_offset(int chan);\n\nstatic inline u8\nmwifiex_is_station_ampdu_allowed(struct mwifiex_private *priv,\n\t\t\t\t struct mwifiex_ra_list_tbl *ptr, int tid)\n{\n\tstruct mwifiex_sta_node *node = mwifiex_get_sta_entry(priv, ptr->ra);\n\n\tif (unlikely(!node))\n\t\treturn false;\n\n\treturn (node->ampdu_sta[tid] != BA_STREAM_NOT_ALLOWED) ? true : false;\n}\n\n \nstatic inline u8\nmwifiex_is_ampdu_allowed(struct mwifiex_private *priv,\n\t\t\t struct mwifiex_ra_list_tbl *ptr, int tid)\n{\n\tif (is_broadcast_ether_addr(ptr->ra))\n\t\treturn false;\n\tif (GET_BSS_ROLE(priv) == MWIFIEX_BSS_ROLE_UAP) {\n\t\treturn mwifiex_is_station_ampdu_allowed(priv, ptr, tid);\n\t} else {\n\t\tif (ptr->tdls_link)\n\t\t\treturn mwifiex_is_station_ampdu_allowed(priv, ptr, tid);\n\n\t\treturn (priv->aggr_prio_tbl[tid].ampdu_ap !=\n\t\t\tBA_STREAM_NOT_ALLOWED) ? true : false;\n\t}\n}\n\n \nstatic inline u8\nmwifiex_is_amsdu_allowed(struct mwifiex_private *priv, int tid)\n{\n\treturn (((priv->aggr_prio_tbl[tid].amsdu != BA_STREAM_NOT_ALLOWED) &&\n\t\t (priv->is_data_rate_auto || !(priv->bitmap_rates[2] & 0x03)))\n\t\t? true : false);\n}\n\n \nstatic inline u8 mwifiex_space_avail_for_new_ba_stream(\n\t\t\t\t\tstruct mwifiex_adapter *adapter)\n{\n\tstruct mwifiex_private *priv;\n\tu8 i;\n\tsize_t ba_stream_num = 0, ba_stream_max;\n\n\tba_stream_max = MWIFIEX_MAX_TX_BASTREAM_SUPPORTED;\n\n\tfor (i = 0; i < adapter->priv_num; i++) {\n\t\tpriv = adapter->priv[i];\n\t\tif (priv)\n\t\t\tba_stream_num += list_count_nodes(\n\t\t\t\t&priv->tx_ba_stream_tbl_ptr);\n\t}\n\n\tif (adapter->fw_api_ver == MWIFIEX_FW_V15) {\n\t\tba_stream_max =\n\t\t\t       GETSUPP_TXBASTREAMS(adapter->hw_dot_11n_dev_cap);\n\t\tif (!ba_stream_max)\n\t\t\tba_stream_max = MWIFIEX_MAX_TX_BASTREAM_SUPPORTED;\n\t}\n\n\treturn ((ba_stream_num < ba_stream_max) ? true : false);\n}\n\n \nstatic inline u8\nmwifiex_find_stream_to_delete(struct mwifiex_private *priv, int ptr_tid,\n\t\t\t      int *ptid, u8 *ra)\n{\n\tint tid;\n\tu8 ret = false;\n\tstruct mwifiex_tx_ba_stream_tbl *tx_tbl;\n\n\ttid = priv->aggr_prio_tbl[ptr_tid].ampdu_user;\n\n\tspin_lock_bh(&priv->tx_ba_stream_tbl_lock);\n\tlist_for_each_entry(tx_tbl, &priv->tx_ba_stream_tbl_ptr, list) {\n\t\tif (tid > priv->aggr_prio_tbl[tx_tbl->tid].ampdu_user) {\n\t\t\ttid = priv->aggr_prio_tbl[tx_tbl->tid].ampdu_user;\n\t\t\t*ptid = tx_tbl->tid;\n\t\t\tmemcpy(ra, tx_tbl->ra, ETH_ALEN);\n\t\t\tret = true;\n\t\t}\n\t}\n\tspin_unlock_bh(&priv->tx_ba_stream_tbl_lock);\n\n\treturn ret;\n}\n\n \nstatic inline int mwifiex_is_sta_11n_enabled(struct mwifiex_private *priv,\n\t\t\t\t\t     struct mwifiex_sta_node *node)\n{\n\tif (!node || ((priv->bss_role == MWIFIEX_BSS_ROLE_UAP) &&\n\t\t      !priv->ap_11n_enabled) ||\n\t    ((priv->bss_mode == NL80211_IFTYPE_ADHOC) &&\n\t     !priv->adapter->adhoc_11n_enabled))\n\t\treturn 0;\n\n\treturn node->is_11n_enabled;\n}\n\nstatic inline u8\nmwifiex_tdls_peer_11n_enabled(struct mwifiex_private *priv, const u8 *ra)\n{\n\tstruct mwifiex_sta_node *node = mwifiex_get_sta_entry(priv, ra);\n\tif (node)\n\t\treturn node->is_11n_enabled;\n\n\treturn false;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}