{
  "module_name": "hostap_ap.h",
  "hash_id": "bd53d68f87eed01e98fbcca03d317bc710b02a69b229ceaea760c4e67129b165",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/intersil/hostap/hostap_ap.h",
  "human_readable_source": " \n#ifndef HOSTAP_AP_H\n#define HOSTAP_AP_H\n\n#include \"hostap_80211.h\"\n\n \n\n \n#define STA_MAX_TX_BUFFER 32\n\n \n#define WLAN_STA_AUTH BIT(0)\n#define WLAN_STA_ASSOC BIT(1)\n#define WLAN_STA_PS BIT(2)\n#define WLAN_STA_TIM BIT(3)  \n#define WLAN_STA_PERM BIT(4)  \n#define WLAN_STA_AUTHORIZED BIT(5)  \n#define WLAN_STA_PENDING_POLL BIT(6)  \n\n#define WLAN_RATE_1M BIT(0)\n#define WLAN_RATE_2M BIT(1)\n#define WLAN_RATE_5M5 BIT(2)\n#define WLAN_RATE_11M BIT(3)\n#define WLAN_RATE_COUNT 4\n\n \n#define WLAN_SUPP_RATES_MAX 32\n\n \n#define WLAN_RATE_UPDATE_COUNT 50\n\n \n#define WLAN_RATE_DECREASE_THRESHOLD 2\n\nstruct sta_info {\n\tstruct list_head list;\n\tstruct sta_info *hnext;  \n\tatomic_t users;  \n\tstruct proc_dir_entry *proc;\n\n\tu8 addr[6];\n\tu16 aid;  \n\tu32 flags;\n\tu16 capability;\n\tu16 listen_interval;  \n\tu8 supported_rates[WLAN_SUPP_RATES_MAX];\n\n\tunsigned long last_auth;\n\tunsigned long last_assoc;\n\tunsigned long last_rx;\n\tunsigned long last_tx;\n\tunsigned long rx_packets, tx_packets;\n\tunsigned long rx_bytes, tx_bytes;\n\tstruct sk_buff_head tx_buf;\n\t \n\n\ts8 last_rx_silence;  \n\ts8 last_rx_signal;  \n\tu8 last_rx_rate;  \n\tu8 last_rx_updated;  \n\n\tu8 tx_supp_rates;  \n\tu8 tx_rate;  \n\tu8 tx_rate_idx;  \n\tu8 tx_max_rate;  \n\tu32 tx_count[WLAN_RATE_COUNT];  \n\tu32 rx_count[WLAN_RATE_COUNT];  \n\tu32 tx_since_last_failure;\n\tu32 tx_consecutive_exc;\n\n\tstruct lib80211_crypt_data *crypt;\n\n\tint ap;  \n\n\tlocal_info_t *local;\n\n#ifndef PRISM2_NO_KERNEL_IEEE80211_MGMT\n\tunion {\n\t\tstruct {\n\t\t\tchar *challenge;  \n\t\t} sta;\n\t\tstruct {\n\t\t\tint ssid_len;\n\t\t\tunsigned char ssid[MAX_SSID_LEN + 1];  \n\t\t\tint channel;\n\t\t\tunsigned long last_beacon;  \n\t\t} ap;\n\t} u;\n\n\tstruct timer_list timer;\n\tenum { STA_NULLFUNC = 0, STA_DISASSOC, STA_DEAUTH } timeout_next;\n#endif  \n};\n\n\n#define MAX_STA_COUNT 1024\n\n \n#define MAX_AID_TABLE_SIZE 128\n\n#define STA_HASH_SIZE 256\n#define STA_HASH(sta) (sta[5])\n\n\n \n#define AP_MAX_INACTIVITY_SEC (5 * 60)\n#define AP_DISASSOC_DELAY (HZ)\n#define AP_DEAUTH_DELAY (HZ)\n\n \ntypedef enum {\n\tAP_OTHER_AP_SKIP_ALL = 0,\n\tAP_OTHER_AP_SAME_SSID = 1,\n\tAP_OTHER_AP_ALL = 2,\n\tAP_OTHER_AP_EVEN_IBSS = 3\n} ap_policy_enum;\n\n#define PRISM2_AUTH_OPEN BIT(0)\n#define PRISM2_AUTH_SHARED_KEY BIT(1)\n\n\n \nstruct mac_entry {\n\tstruct list_head list;\n\tu8 addr[6];\n};\n\nstruct mac_restrictions {\n\tenum { MAC_POLICY_OPEN = 0, MAC_POLICY_ALLOW, MAC_POLICY_DENY } policy;\n\tunsigned int entries;\n\tstruct list_head mac_list;\n\tspinlock_t lock;\n};\n\n\nstruct add_sta_proc_data {\n\tu8 addr[ETH_ALEN];\n\tstruct add_sta_proc_data *next;\n};\n\n\ntypedef enum { WDS_ADD, WDS_DEL } wds_oper_type;\nstruct wds_oper_data {\n\twds_oper_type type;\n\tu8 addr[ETH_ALEN];\n\tstruct wds_oper_data *next;\n};\n\n\nstruct ap_data {\n\tint initialized;  \n\tlocal_info_t *local;\n\tint bridge_packets;  \n\tunsigned int bridged_unicast;  \n\tunsigned int bridged_multicast;  \n\tunsigned int tx_drop_nonassoc;  \n\tint nullfunc_ack;  \n\n\tspinlock_t sta_table_lock;\n\tint num_sta;  \n\tstruct list_head sta_list;  \n\tstruct sta_info *sta_hash[STA_HASH_SIZE];\n\n\tstruct proc_dir_entry *proc;\n\n\tap_policy_enum ap_policy;\n\tunsigned int max_inactivity;\n\tint autom_ap_wds;\n\n\tstruct mac_restrictions mac_restrictions;  \n\tint last_tx_rate;\n\n\tstruct work_struct add_sta_proc_queue;\n\tstruct add_sta_proc_data *add_sta_proc_entries;\n\n\tstruct work_struct wds_oper_queue;\n\tstruct wds_oper_data *wds_oper_entries;\n\n\tu16 tx_callback_idx;\n\n#ifndef PRISM2_NO_KERNEL_IEEE80211_MGMT\n\t \n\tstruct sta_info *sta_aid[MAX_AID_TABLE_SIZE];\n\n\tu16 tx_callback_auth, tx_callback_assoc, tx_callback_poll;\n\n\t \n\tstruct lib80211_crypto_ops *crypt;\n\tvoid *crypt_priv;\n#endif  \n};\n\n\nvoid hostap_rx(struct net_device *dev, struct sk_buff *skb,\n\t       struct hostap_80211_rx_status *rx_stats);\nvoid hostap_init_data(local_info_t *local);\nvoid hostap_init_ap_proc(local_info_t *local);\nvoid hostap_free_data(struct ap_data *ap);\nvoid hostap_check_sta_fw_version(struct ap_data *ap, int sta_fw_ver);\n\ntypedef enum {\n\tAP_TX_CONTINUE, AP_TX_DROP, AP_TX_RETRY, AP_TX_BUFFERED,\n\tAP_TX_CONTINUE_NOT_AUTHORIZED\n} ap_tx_ret;\nstruct hostap_tx_data {\n\tstruct sk_buff *skb;\n\tint host_encrypt;\n\tstruct lib80211_crypt_data *crypt;\n\tvoid *sta_ptr;\n};\nap_tx_ret hostap_handle_sta_tx(local_info_t *local, struct hostap_tx_data *tx);\nvoid hostap_handle_sta_release(void *ptr);\nvoid hostap_handle_sta_tx_exc(local_info_t *local, struct sk_buff *skb);\nint hostap_update_sta_ps(local_info_t *local, struct ieee80211_hdr *hdr);\ntypedef enum {\n\tAP_RX_CONTINUE, AP_RX_DROP, AP_RX_EXIT, AP_RX_CONTINUE_NOT_AUTHORIZED\n} ap_rx_ret;\nap_rx_ret hostap_handle_sta_rx(local_info_t *local, struct net_device *dev,\n\t\t\t       struct sk_buff *skb,\n\t\t\t       struct hostap_80211_rx_status *rx_stats,\n\t\t\t       int wds);\nint hostap_handle_sta_crypto(local_info_t *local, struct ieee80211_hdr *hdr,\n\t\t\t     struct lib80211_crypt_data **crypt,\n\t\t\t     void **sta_ptr);\nint hostap_is_sta_assoc(struct ap_data *ap, u8 *sta_addr);\nint hostap_is_sta_authorized(struct ap_data *ap, u8 *sta_addr);\nint hostap_add_sta(struct ap_data *ap, u8 *sta_addr);\nint hostap_update_rx_stats(struct ap_data *ap, struct ieee80211_hdr *hdr,\n\t\t\t   struct hostap_80211_rx_status *rx_stats);\nvoid hostap_update_rates(local_info_t *local);\nvoid hostap_add_wds_links(local_info_t *local);\nvoid hostap_wds_link_oper(local_info_t *local, u8 *addr, wds_oper_type type);\n\n#ifndef PRISM2_NO_KERNEL_IEEE80211_MGMT\nvoid hostap_deauth_all_stas(struct net_device *dev, struct ap_data *ap,\n\t\t\t    int resend);\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}