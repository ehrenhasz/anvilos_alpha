{
  "module_name": "orinoco.h",
  "hash_id": "ff26f3b921fc3f1e9ed538c63003548ed898d571e441685fe05cef9ff7c75ece",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/intersil/orinoco/orinoco.h",
  "human_readable_source": " \n\n#ifndef _ORINOCO_H\n#define _ORINOCO_H\n\n#define DRIVER_VERSION \"0.15\"\n\n#include <linux/interrupt.h>\n#include <linux/suspend.h>\n#include <linux/netdevice.h>\n#include <linux/wireless.h>\n#include <net/iw_handler.h>\n#include <net/cfg80211.h>\n\n#include \"hermes.h\"\n\n \n \n\n#define WIRELESS_SPY\t\t \n\n#define MAX_SCAN_LEN\t\t4096\n\n#define ORINOCO_SEQ_LEN\t\t8\n#define ORINOCO_MAX_KEY_SIZE\t14\n#define ORINOCO_MAX_KEYS\t4\n\nstruct orinoco_key {\n\t__le16 len;\t \n\tchar data[ORINOCO_MAX_KEY_SIZE];\n} __packed;\n\n#define TKIP_KEYLEN\t16\n#define MIC_KEYLEN\t8\n\nstruct orinoco_tkip_key {\n\tu8 tkip[TKIP_KEYLEN];\n\tu8 tx_mic[MIC_KEYLEN];\n\tu8 rx_mic[MIC_KEYLEN];\n};\n\nenum orinoco_alg {\n\tORINOCO_ALG_NONE,\n\tORINOCO_ALG_WEP,\n\tORINOCO_ALG_TKIP\n};\n\nenum fwtype {\n\tFIRMWARE_TYPE_AGERE,\n\tFIRMWARE_TYPE_INTERSIL,\n\tFIRMWARE_TYPE_SYMBOL\n};\n\nstruct firmware;\n\nstruct orinoco_private {\n\tvoid *card;\t \n\tstruct device *dev;\n\tint (*hard_reset)(struct orinoco_private *);\n\tint (*stop_fw)(struct orinoco_private *, int);\n\n\tstruct ieee80211_supported_band band;\n\tstruct ieee80211_channel channels[14];\n\tu32 cipher_suites[3];\n\n\t \n\tspinlock_t lock;\n\tint hw_unavailable;\n\tstruct work_struct reset_work;\n\n\t \n\tstruct tasklet_struct rx_tasklet;\n\tstruct list_head rx_list;\n\n\t \n\tint open;\n\tu16 last_linkstatus;\n\tstruct work_struct join_work;\n\tstruct work_struct wevent_work;\n\n\t \n\tstruct net_device *ndev;\n\tstruct iw_statistics wstats;\n\n\t \n\tstruct hermes hw;\n\tu16 txfid;\n\n\t \n\tenum fwtype firmware_type;\n\tint ibss_port;\n\tint nicbuf_size;\n\tu16 channel_mask;\n\n\t \n\tunsigned int has_ibss:1;\n\tunsigned int has_port3:1;\n\tunsigned int has_wep:1;\n\tunsigned int has_big_wep:1;\n\tunsigned int has_mwo:1;\n\tunsigned int has_pm:1;\n\tunsigned int has_preamble:1;\n\tunsigned int has_sensitivity:1;\n\tunsigned int has_hostscan:1;\n\tunsigned int has_alt_txcntl:1;\n\tunsigned int has_ext_scan:1;\n\tunsigned int has_wpa:1;\n\tunsigned int do_fw_download:1;\n\tunsigned int broken_disableport:1;\n\tunsigned int broken_monitor:1;\n\tunsigned int prefer_port3:1;\n\n\t \n\tenum nl80211_iftype iw_mode;\n\tenum orinoco_alg encode_alg;\n\tu16 wep_restrict, tx_key;\n\tstruct key_params keys[ORINOCO_MAX_KEYS];\n\n\tint bitratemode;\n\tchar nick[IW_ESSID_MAX_SIZE + 1];\n\tchar desired_essid[IW_ESSID_MAX_SIZE + 1];\n\tchar desired_bssid[ETH_ALEN];\n\tint bssid_fixed;\n\tu16 frag_thresh, mwo_robust;\n\tu16 channel;\n\tu16 ap_density, rts_thresh;\n\tu16 pm_on, pm_mcast, pm_period, pm_timeout;\n\tu16 preamble;\n\tu16 short_retry_limit, long_retry_limit;\n\tu16 retry_lifetime;\n#ifdef WIRELESS_SPY\n\tstruct iw_spy_data spy_data;  \n\tstruct iw_public_data\twireless_data;\n#endif\n\n\t \n\tint port_type, createibss;\n\tint promiscuous, mc_count;\n\n\t \n\tstruct cfg80211_scan_request *scan_request;\n\tstruct work_struct process_scan;\n\tstruct list_head scan_list;\n\tspinlock_t scan_lock;  \n\n\t \n\tu8 *wpa_ie;\n\tint wpa_ie_len;\n\n\tstruct crypto_shash *rx_tfm_mic;\n\tstruct crypto_shash *tx_tfm_mic;\n\n\tunsigned int wpa_enabled:1;\n\tunsigned int tkip_cm_active:1;\n\tunsigned int key_mgmt:3;\n\n#if defined(CONFIG_HERMES_CACHE_FW_ON_INIT) || defined(CONFIG_PM_SLEEP)\n\t \n\tconst struct firmware *cached_pri_fw;\n\tconst struct firmware *cached_fw;\n#endif\n\n\tstruct notifier_block pm_notifier;\n};\n\n#ifdef ORINOCO_DEBUG\nextern int orinoco_debug;\n#define DEBUG(n, args...) do { \\\n\tif (orinoco_debug > (n)) \\\n\t\tprintk(KERN_DEBUG args); \\\n} while (0)\n#else\n#define DEBUG(n, args...) do { } while (0)\n#endif\t \n\n \n \n \n\nstruct orinoco_private *alloc_orinocodev(int sizeof_card, struct device *device,\n\t\t\t\t\t int (*hard_reset)(struct orinoco_private *),\n\t\t\t\t\t int (*stop_fw)(struct orinoco_private *, int));\nvoid free_orinocodev(struct orinoco_private *priv);\nint orinoco_init(struct orinoco_private *priv);\nint orinoco_if_add(struct orinoco_private *priv, unsigned long base_addr,\n\t\t   unsigned int irq, const struct net_device_ops *ops);\nvoid orinoco_if_del(struct orinoco_private *priv);\nint orinoco_up(struct orinoco_private *priv);\nvoid orinoco_down(struct orinoco_private *priv);\nirqreturn_t orinoco_interrupt(int irq, void *dev_id);\n\nvoid __orinoco_ev_info(struct net_device *dev, struct hermes *hw);\nvoid __orinoco_ev_rx(struct net_device *dev, struct hermes *hw);\n\nint orinoco_process_xmit_skb(struct sk_buff *skb,\n\t\t\t     struct net_device *dev,\n\t\t\t     struct orinoco_private *priv,\n\t\t\t     int *tx_control,\n\t\t\t     u8 *mic);\n\n \nint orinoco_open(struct net_device *dev);\nint orinoco_stop(struct net_device *dev);\nvoid orinoco_set_multicast_list(struct net_device *dev);\nint orinoco_change_mtu(struct net_device *dev, int new_mtu);\nvoid orinoco_tx_timeout(struct net_device *dev, unsigned int txqueue);\n\n \n \n \n\nstatic inline int orinoco_lock(struct orinoco_private *priv,\n\t\t\t       unsigned long *flags)\n{\n\tpriv->hw.ops->lock_irqsave(&priv->lock, flags);\n\tif (priv->hw_unavailable) {\n\t\tDEBUG(1, \"orinoco_lock() called with hw_unavailable (dev=%p)\\n\",\n\t\t       priv->ndev);\n\t\tpriv->hw.ops->unlock_irqrestore(&priv->lock, flags);\n\t\treturn -EBUSY;\n\t}\n\treturn 0;\n}\n\nstatic inline void orinoco_unlock(struct orinoco_private *priv,\n\t\t\t\t  unsigned long *flags)\n{\n\tpriv->hw.ops->unlock_irqrestore(&priv->lock, flags);\n}\n\nstatic inline void orinoco_lock_irq(struct orinoco_private *priv)\n{\n\tpriv->hw.ops->lock_irq(&priv->lock);\n}\n\nstatic inline void orinoco_unlock_irq(struct orinoco_private *priv)\n{\n\tpriv->hw.ops->unlock_irq(&priv->lock);\n}\n\n \nstatic inline struct orinoco_private *ndev_priv(struct net_device *dev)\n{\n\tstruct wireless_dev *wdev = netdev_priv(dev);\n\treturn wdev_priv(wdev);\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}