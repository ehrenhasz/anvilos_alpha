{
  "module_name": "hermes.h",
  "hash_id": "7faf16dde238dbc706f364e29caecabce5d8b72276981f5a49c73af46bba626a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/intersil/orinoco/hermes.h",
  "human_readable_source": " \n \n\n#ifndef _HERMES_H\n#define _HERMES_H\n\n \n\n#include <linux/if_ether.h>\n#include <linux/io.h>\n\n \n#define\t\tHERMES_ALLOC_LEN_MIN\t\t(4)\n#define\t\tHERMES_ALLOC_LEN_MAX\t\t(2400)\n#define\t\tHERMES_LTV_LEN_MAX\t\t(34)\n#define\t\tHERMES_BAP_DATALEN_MAX\t\t(4096)\n#define\t\tHERMES_BAP_OFFSET_MAX\t\t(4096)\n#define\t\tHERMES_PORTID_MAX\t\t(7)\n#define\t\tHERMES_NUMPORTS_MAX\t\t(HERMES_PORTID_MAX + 1)\n#define\t\tHERMES_PDR_LEN_MAX\t\t(260)\t \n#define\t\tHERMES_PDA_RECS_MAX\t\t(200)\t \n#define\t\tHERMES_PDA_LEN_MAX\t\t(1024)\t \n#define\t\tHERMES_SCANRESULT_MAX\t\t(35)\n#define\t\tHERMES_CHINFORESULT_MAX\t\t(8)\n#define\t\tHERMES_MAX_MULTICAST\t\t(16)\n#define\t\tHERMES_MAGIC\t\t\t(0x7d1f)\n\n \n#define\t\tHERMES_CMD\t\t\t(0x00)\n#define\t\tHERMES_PARAM0\t\t\t(0x02)\n#define\t\tHERMES_PARAM1\t\t\t(0x04)\n#define\t\tHERMES_PARAM2\t\t\t(0x06)\n#define\t\tHERMES_STATUS\t\t\t(0x08)\n#define\t\tHERMES_RESP0\t\t\t(0x0A)\n#define\t\tHERMES_RESP1\t\t\t(0x0C)\n#define\t\tHERMES_RESP2\t\t\t(0x0E)\n#define\t\tHERMES_INFOFID\t\t\t(0x10)\n#define\t\tHERMES_RXFID\t\t\t(0x20)\n#define\t\tHERMES_ALLOCFID\t\t\t(0x22)\n#define\t\tHERMES_TXCOMPLFID\t\t(0x24)\n#define\t\tHERMES_SELECT0\t\t\t(0x18)\n#define\t\tHERMES_OFFSET0\t\t\t(0x1C)\n#define\t\tHERMES_DATA0\t\t\t(0x36)\n#define\t\tHERMES_SELECT1\t\t\t(0x1A)\n#define\t\tHERMES_OFFSET1\t\t\t(0x1E)\n#define\t\tHERMES_DATA1\t\t\t(0x38)\n#define\t\tHERMES_EVSTAT\t\t\t(0x30)\n#define\t\tHERMES_INTEN\t\t\t(0x32)\n#define\t\tHERMES_EVACK\t\t\t(0x34)\n#define\t\tHERMES_CONTROL\t\t\t(0x14)\n#define\t\tHERMES_SWSUPPORT0\t\t(0x28)\n#define\t\tHERMES_SWSUPPORT1\t\t(0x2A)\n#define\t\tHERMES_SWSUPPORT2\t\t(0x2C)\n#define\t\tHERMES_AUXPAGE\t\t\t(0x3A)\n#define\t\tHERMES_AUXOFFSET\t\t(0x3C)\n#define\t\tHERMES_AUXDATA\t\t\t(0x3E)\n\n \n#define\t\tHERMES_CMD_BUSY\t\t\t(0x8000)\n#define\t\tHERMES_CMD_AINFO\t\t(0x7f00)\n#define\t\tHERMES_CMD_MACPORT\t\t(0x0700)\n#define\t\tHERMES_CMD_RECL\t\t\t(0x0100)\n#define\t\tHERMES_CMD_WRITE\t\t(0x0100)\n#define\t\tHERMES_CMD_PROGMODE\t\t(0x0300)\n#define\t\tHERMES_CMD_CMDCODE\t\t(0x003f)\n\n \n#define\t\tHERMES_STATUS_RESULT\t\t(0x7f00)\n#define\t\tHERMES_STATUS_CMDCODE\t\t(0x003f)\n\n \n#define\t\tHERMES_OFFSET_BUSY\t\t(0x8000)\n#define\t\tHERMES_OFFSET_ERR\t\t(0x4000)\n#define\t\tHERMES_OFFSET_DATAOFF\t\t(0x0ffe)\n\n \n#define\t\tHERMES_EV_TICK\t\t\t(0x8000)\n#define\t\tHERMES_EV_WTERR\t\t\t(0x4000)\n#define\t\tHERMES_EV_INFDROP\t\t(0x2000)\n#define\t\tHERMES_EV_INFO\t\t\t(0x0080)\n#define\t\tHERMES_EV_DTIM\t\t\t(0x0020)\n#define\t\tHERMES_EV_CMD\t\t\t(0x0010)\n#define\t\tHERMES_EV_ALLOC\t\t\t(0x0008)\n#define\t\tHERMES_EV_TXEXC\t\t\t(0x0004)\n#define\t\tHERMES_EV_TX\t\t\t(0x0002)\n#define\t\tHERMES_EV_RX\t\t\t(0x0001)\n\n \n \n#define\t\tHERMES_CMD_INIT\t\t\t(0x0000)\n#define\t\tHERMES_CMD_ENABLE\t\t(0x0001)\n#define\t\tHERMES_CMD_DISABLE\t\t(0x0002)\n#define\t\tHERMES_CMD_DIAG\t\t\t(0x0003)\n\n \n#define\t\tHERMES_CMD_ALLOC\t\t(0x000A)\n#define\t\tHERMES_CMD_TX\t\t\t(0x000B)\n\n \n#define\t\tHERMES_CMD_NOTIFY\t\t(0x0010)\n#define\t\tHERMES_CMD_INQUIRE\t\t(0x0011)\n\n \n#define\t\tHERMES_CMD_ACCESS\t\t(0x0021)\n#define\t\tHERMES_CMD_DOWNLD\t\t(0x0022)\n\n \n#define\t\tHERMES_CMD_READMIF\t\t(0x0030)\n#define\t\tHERMES_CMD_WRITEMIF\t\t(0x0031)\n\n \n#define\t\tHERMES_CMD_TEST\t\t\t(0x0038)\n\n\n \n#define\t\tHERMES_TEST_SET_CHANNEL\t\t0x0800\n#define\t\tHERMES_TEST_MONITOR\t\t0x0b00\n#define\t\tHERMES_TEST_STOP\t\t0x0f00\n\n \n#define\t\tHERMES_AUTH_OPEN\t\t1\n#define\t\tHERMES_AUTH_SHARED_KEY\t\t2\n\n \n#define\t\tHERMES_WEP_PRIVACY_INVOKED\t0x0001\n#define\t\tHERMES_WEP_EXCL_UNENCRYPTED\t0x0002\n#define\t\tHERMES_WEP_HOST_ENCRYPT\t\t0x0010\n#define\t\tHERMES_WEP_HOST_DECRYPT\t\t0x0080\n\n \n#define\t\tHERMES_HOSTSCAN_SYMBOL_5SEC\t0x0001\n#define\t\tHERMES_HOSTSCAN_SYMBOL_ONCE\t0x0002\n#define\t\tHERMES_HOSTSCAN_SYMBOL_PASSIVE\t0x0040\n#define\t\tHERMES_HOSTSCAN_SYMBOL_BCAST\t0x0080\n\n \n\n#define HERMES_DESCRIPTOR_OFFSET\t0\n#define HERMES_802_11_OFFSET\t\t(14)\n#define HERMES_802_3_OFFSET\t\t(14 + 32)\n#define HERMES_802_2_OFFSET\t\t(14 + 32 + 14)\n#define HERMES_TXCNTL2_OFFSET\t\t(HERMES_802_3_OFFSET - 2)\n\n#define HERMES_RXSTAT_ERR\t\t(0x0003)\n#define\tHERMES_RXSTAT_BADCRC\t\t(0x0001)\n#define\tHERMES_RXSTAT_UNDECRYPTABLE\t(0x0002)\n#define\tHERMES_RXSTAT_MIC\t\t(0x0010)\t \n#define\tHERMES_RXSTAT_MACPORT\t\t(0x0700)\n#define HERMES_RXSTAT_PCF\t\t(0x1000)\t \n#define\tHERMES_RXSTAT_MIC_KEY_ID\t(0x1800)\t \n#define\tHERMES_RXSTAT_MSGTYPE\t\t(0xE000)\n#define\tHERMES_RXSTAT_1042\t\t(0x2000)\t \n#define\tHERMES_RXSTAT_TUNNEL\t\t(0x4000)\t \n#define\tHERMES_RXSTAT_WMP\t\t(0x6000)\t \n\n \n#define\tHERMES_MIC_KEY_ID_SHIFT\t\t11\n\nstruct hermes_tx_descriptor {\n\t__le16 status;\n\t__le16 reserved1;\n\t__le16 reserved2;\n\t__le32 sw_support;\n\tu8 retry_count;\n\tu8 tx_rate;\n\t__le16 tx_control;\n} __packed;\n\n#define HERMES_TXSTAT_RETRYERR\t\t(0x0001)\n#define HERMES_TXSTAT_AGEDERR\t\t(0x0002)\n#define HERMES_TXSTAT_DISCON\t\t(0x0004)\n#define HERMES_TXSTAT_FORMERR\t\t(0x0008)\n\n#define HERMES_TXCTRL_TX_OK\t\t(0x0002)\t \n#define HERMES_TXCTRL_TX_EX\t\t(0x0004)\t \n#define HERMES_TXCTRL_802_11\t\t(0x0008)\t \n#define HERMES_TXCTRL_MIC\t\t(0x0010)\t \n#define HERMES_TXCTRL_MIC_KEY_ID\t(0x1800)\t \n#define HERMES_TXCTRL_ALT_RTRY\t\t(0x0020)\n\n \n\n#define HERMES_INQ_TALLIES\t\t(0xF100)\n#define HERMES_INQ_SCAN\t\t\t(0xF101)\n#define HERMES_INQ_CHANNELINFO\t\t(0xF102)\n#define HERMES_INQ_HOSTSCAN\t\t(0xF103)\n#define HERMES_INQ_HOSTSCAN_SYMBOL\t(0xF104)\n#define HERMES_INQ_LINKSTATUS\t\t(0xF200)\n#define HERMES_INQ_SEC_STAT_AGERE\t(0xF202)\n\nstruct hermes_tallies_frame {\n\t__le16 TxUnicastFrames;\n\t__le16 TxMulticastFrames;\n\t__le16 TxFragments;\n\t__le16 TxUnicastOctets;\n\t__le16 TxMulticastOctets;\n\t__le16 TxDeferredTransmissions;\n\t__le16 TxSingleRetryFrames;\n\t__le16 TxMultipleRetryFrames;\n\t__le16 TxRetryLimitExceeded;\n\t__le16 TxDiscards;\n\t__le16 RxUnicastFrames;\n\t__le16 RxMulticastFrames;\n\t__le16 RxFragments;\n\t__le16 RxUnicastOctets;\n\t__le16 RxMulticastOctets;\n\t__le16 RxFCSErrors;\n\t__le16 RxDiscards_NoBuffer;\n\t__le16 TxDiscardsWrongSA;\n\t__le16 RxWEPUndecryptable;\n\t__le16 RxMsgInMsgFragments;\n\t__le16 RxMsgInBadMsgFragments;\n\t \n\t__le16 RxDiscards_WEPICVError;\n\t__le16 RxDiscards_WEPExcluded;\n} __packed;\n\n \n \nstruct prism2_scan_apinfo {\n\t__le16 channel;\t\t \n\t__le16 noise;\t\t \n\t__le16 level;\t\t \n\tu8 bssid[ETH_ALEN];\t \n\t__le16 beacon_interv;\t \n\t__le16 capabilities;\t \n\t__le16 essid_len;\t \n\tu8 essid[32];\t\t \n\tu8 rates[10];\t\t \n\t__le16 proberesp_rate;\t \n\t__le16 atim;\t\t \n} __packed;\n\n \nstruct agere_scan_apinfo {\n\t__le16 channel;\t\t \n\t__le16 noise;\t\t \n\t__le16 level;\t\t \n\tu8 bssid[ETH_ALEN];\t \n\t__le16 beacon_interv;\t \n\t__le16 capabilities;\t \n\t \n\t__le16 essid_len;\t \n\tu8 essid[32];\t\t \n} __packed;\n\n \nstruct symbol_scan_apinfo {\n\tu8 channel;\t\t \n\tu8 unknown1;\t\t \n\t__le16 noise;\t\t \n\t__le16 level;\t\t \n\tu8 bssid[ETH_ALEN];\t \n\t__le16 beacon_interv;\t \n\t__le16 capabilities;\t \n\t \n\t__le16 essid_len;\t \n\tu8 essid[32];\t\t \n\t__le16 rates[5];\t \n\t__le16 basic_rates;\t \n\tu8 unknown2[6];\t\t \n\tu8 unknown3[8];\t\t \n} __packed;\n\nunion hermes_scan_info {\n\tstruct agere_scan_apinfo\ta;\n\tstruct prism2_scan_apinfo\tp;\n\tstruct symbol_scan_apinfo\ts;\n};\n\n \nstruct agere_ext_scan_info {\n\t__le16\treserved0;\n\n\tu8\tnoise;\n\tu8\tlevel;\n\tu8\trx_flow;\n\tu8\trate;\n\t__le16\treserved1[2];\n\n\t__le16\tframe_control;\n\t__le16\tdur_id;\n\tu8\taddr1[ETH_ALEN];\n\tu8\taddr2[ETH_ALEN];\n\tu8\tbssid[ETH_ALEN];\n\t__le16\tsequence;\n\tu8\taddr4[ETH_ALEN];\n\n\t__le16\tdata_length;\n\n\t \n\tu8\tdaddr[ETH_ALEN];\n\tu8\tsaddr[ETH_ALEN];\n\t__le16\tlen_type;\n\n\t__le64\ttimestamp;\n\t__le16\tbeacon_interval;\n\t__le16\tcapabilities;\n\tu8\tdata[];\n} __packed;\n\n#define HERMES_LINKSTATUS_NOT_CONNECTED   (0x0000)\n#define HERMES_LINKSTATUS_CONNECTED       (0x0001)\n#define HERMES_LINKSTATUS_DISCONNECTED    (0x0002)\n#define HERMES_LINKSTATUS_AP_CHANGE       (0x0003)\n#define HERMES_LINKSTATUS_AP_OUT_OF_RANGE (0x0004)\n#define HERMES_LINKSTATUS_AP_IN_RANGE     (0x0005)\n#define HERMES_LINKSTATUS_ASSOC_FAILED    (0x0006)\n\nstruct hermes_linkstatus {\n\t__le16 linkstatus;          \n} __packed;\n\nstruct hermes_response {\n\tu16 status, resp0, resp1, resp2;\n};\n\n \nstruct hermes_idstring {\n\t__le16 len;\n\t__le16 val[16];\n} __packed;\n\nstruct hermes_multicast {\n\tu8 addr[HERMES_MAX_MULTICAST][ETH_ALEN];\n} __packed;\n\n \n#define HERMES_BAP_BUSY_TIMEOUT (10000)  \n\nstruct hermes;\n\n \nstruct hermes_ops {\n\tint (*init)(struct hermes *hw);\n\tint (*cmd_wait)(struct hermes *hw, u16 cmd, u16 parm0,\n\t\t\tstruct hermes_response *resp);\n\tint (*init_cmd_wait)(struct hermes *hw, u16 cmd,\n\t\t\t     u16 parm0, u16 parm1, u16 parm2,\n\t\t\t     struct hermes_response *resp);\n\tint (*allocate)(struct hermes *hw, u16 size, u16 *fid);\n\tint (*read_ltv)(struct hermes *hw, int bap, u16 rid, unsigned buflen,\n\t\t\tu16 *length, void *buf);\n\tint (*read_ltv_pr)(struct hermes *hw, int bap, u16 rid,\n\t\t\t      unsigned buflen, u16 *length, void *buf);\n\tint (*write_ltv)(struct hermes *hw, int bap, u16 rid,\n\t\t\t u16 length, const void *value);\n\tint (*bap_pread)(struct hermes *hw, int bap, void *buf, int len,\n\t\t\t u16 id, u16 offset);\n\tint (*bap_pwrite)(struct hermes *hw, int bap, const void *buf,\n\t\t\t  int len, u16 id, u16 offset);\n\tint (*read_pda)(struct hermes *hw, __le16 *pda,\n\t\t\tu32 pda_addr, u16 pda_len);\n\tint (*program_init)(struct hermes *hw, u32 entry_point);\n\tint (*program_end)(struct hermes *hw);\n\tint (*program)(struct hermes *hw, const char *buf,\n\t\t       u32 addr, u32 len);\n\tvoid (*lock_irqsave)(spinlock_t *lock, unsigned long *flags);\n\tvoid (*unlock_irqrestore)(spinlock_t *lock, unsigned long *flags);\n\tvoid (*lock_irq)(spinlock_t *lock);\n\tvoid (*unlock_irq)(spinlock_t *lock);\n};\n\n \nstruct hermes {\n\tvoid __iomem *iobase;\n\tint reg_spacing;\n#define HERMES_16BIT_REGSPACING\t0\n#define HERMES_32BIT_REGSPACING\t1\n\tu16 inten;  \n\tbool eeprom_pda;\n\tconst struct hermes_ops *ops;\n\tvoid *priv;\n};\n\n \n#define hermes_read_reg(hw, off) \\\n\t(ioread16((hw)->iobase + ((off) << (hw)->reg_spacing)))\n#define hermes_write_reg(hw, off, val) \\\n\t(iowrite16((val), (hw)->iobase + ((off) << (hw)->reg_spacing)))\n#define hermes_read_regn(hw, name) hermes_read_reg((hw), HERMES_##name)\n#define hermes_write_regn(hw, name, val) \\\n\thermes_write_reg((hw), HERMES_##name, (val))\n\n \nvoid hermes_struct_init(struct hermes *hw, void __iomem *address,\n\t\t\tint reg_spacing);\n\n \n\nstatic inline int hermes_present(struct hermes *hw)\n{\n\treturn hermes_read_regn(hw, SWSUPPORT0) == HERMES_MAGIC;\n}\n\nstatic inline void hermes_set_irqmask(struct hermes *hw, u16 events)\n{\n\thw->inten = events;\n\thermes_write_regn(hw, INTEN, events);\n}\n\nstatic inline int hermes_enable_port(struct hermes *hw, int port)\n{\n\treturn hw->ops->cmd_wait(hw, HERMES_CMD_ENABLE | (port << 8),\n\t\t\t\t 0, NULL);\n}\n\nstatic inline int hermes_disable_port(struct hermes *hw, int port)\n{\n\treturn hw->ops->cmd_wait(hw, HERMES_CMD_DISABLE | (port << 8),\n\t\t\t\t 0, NULL);\n}\n\n \nstatic inline int hermes_inquire(struct hermes *hw, u16 rid)\n{\n\treturn hw->ops->cmd_wait(hw, HERMES_CMD_INQUIRE, rid, NULL);\n}\n\n#define HERMES_BYTES_TO_RECLEN(n) ((((n) + 1) / 2) + 1)\n#define HERMES_RECLEN_TO_BYTES(n) (((n) - 1) * 2)\n\n \nstatic inline void hermes_read_words(struct hermes *hw, int off,\n\t\t\t\t     void *buf, unsigned count)\n{\n\toff = off << hw->reg_spacing;\n\tioread16_rep(hw->iobase + off, buf, count);\n}\n\nstatic inline void hermes_write_bytes(struct hermes *hw, int off,\n\t\t\t\t      const char *buf, unsigned count)\n{\n\toff = off << hw->reg_spacing;\n\tiowrite16_rep(hw->iobase + off, buf, count >> 1);\n\tif (unlikely(count & 1))\n\t\tiowrite8(buf[count - 1], hw->iobase + off);\n}\n\nstatic inline void hermes_clear_words(struct hermes *hw, int off,\n\t\t\t\t      unsigned count)\n{\n\tunsigned i;\n\n\toff = off << hw->reg_spacing;\n\n\tfor (i = 0; i < count; i++)\n\t\tiowrite16(0, hw->iobase + off);\n}\n\n#define HERMES_READ_RECORD(hw, bap, rid, buf) \\\n\t(hw->ops->read_ltv((hw), (bap), (rid), sizeof(*buf), NULL, (buf)))\n#define HERMES_READ_RECORD_PR(hw, bap, rid, buf) \\\n\t(hw->ops->read_ltv_pr((hw), (bap), (rid), sizeof(*buf), NULL, (buf)))\n#define HERMES_WRITE_RECORD(hw, bap, rid, buf) \\\n\t(hw->ops->write_ltv((hw), (bap), (rid), \\\n\t\t\t    HERMES_BYTES_TO_RECLEN(sizeof(*buf)), (buf)))\n\nstatic inline int hermes_read_wordrec(struct hermes *hw, int bap, u16 rid,\n\t\t\t\t      u16 *word)\n{\n\t__le16 rec;\n\tint err;\n\n\terr = HERMES_READ_RECORD(hw, bap, rid, &rec);\n\t*word = le16_to_cpu(rec);\n\treturn err;\n}\n\nstatic inline int hermes_read_wordrec_pr(struct hermes *hw, int bap, u16 rid,\n\t\t\t\t\t u16 *word)\n{\n\t__le16 rec;\n\tint err;\n\n\terr = HERMES_READ_RECORD_PR(hw, bap, rid, &rec);\n\t*word = le16_to_cpu(rec);\n\treturn err;\n}\n\nstatic inline int hermes_write_wordrec(struct hermes *hw, int bap, u16 rid,\n\t\t\t\t       u16 word)\n{\n\t__le16 rec = cpu_to_le16(word);\n\treturn HERMES_WRITE_RECORD(hw, bap, rid, &rec);\n}\n\n#endif   \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}