{
  "module_name": "wlcore_i.h",
  "hash_id": "63518e9531b1ab91d1251cd855a82b6b50e0a5bdb695e6fb25c3fd9fe3cdcb9f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ti/wlcore/wlcore_i.h",
  "human_readable_source": " \n \n\n#ifndef __WLCORE_I_H__\n#define __WLCORE_I_H__\n\n#include <linux/mutex.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/bitops.h>\n#include <net/mac80211.h>\n\n#include \"conf.h\"\n#include \"ini.h\"\n\nstruct wilink_family_data {\n\tconst char *name;\n\tconst char *nvs_name;\t \n\tconst char *cfg_name;\t \n};\n\n#define WL1271_TX_SECURITY_LO16(s) ((u16)((s) & 0xffff))\n#define WL1271_TX_SECURITY_HI32(s) ((u32)(((s) >> 16) & 0xffffffff))\n#define WL1271_TX_SQN_POST_RECOVERY_PADDING 0xff\n \n#define WL1271_TX_SQN_POST_RECOVERY_PADDING_GEM 0x20\n\n\n#define WL1271_CIPHER_SUITE_GEM 0x00147201\n\n#define WL1271_BUSY_WORD_CNT 1\n#define WL1271_BUSY_WORD_LEN (WL1271_BUSY_WORD_CNT * sizeof(u32))\n\n#define WL1271_ELP_HW_STATE_ASLEEP 0\n#define WL1271_ELP_HW_STATE_IRQ    1\n\n#define WL1271_DEFAULT_BEACON_INT  100\n#define WL1271_DEFAULT_DTIM_PERIOD 1\n\n#define WL12XX_MAX_ROLES           4\n#define WL12XX_INVALID_ROLE_ID     0xff\n#define WL12XX_INVALID_LINK_ID     0xff\n\n \n#define WLCORE_MAX_LINKS 16\n\n \n#define WLCORE_NUM_BANDS           2\n\n#define WL12XX_MAX_RATE_POLICIES 16\n#define WLCORE_MAX_KLV_TEMPLATES 4\n\n \n#define WL12XX_SYSTEM_HLID         0\n\n \n#define WL1271_PS_STA_MAX_PACKETS  2\n\n#define WL1271_AP_BSS_INDEX        0\n#define WL1271_AP_DEF_BEACON_EXP   20\n\nenum wlcore_state {\n\tWLCORE_STATE_OFF,\n\tWLCORE_STATE_RESTARTING,\n\tWLCORE_STATE_ON,\n};\n\nenum wl12xx_fw_type {\n\tWL12XX_FW_TYPE_NONE,\n\tWL12XX_FW_TYPE_NORMAL,\n\tWL12XX_FW_TYPE_MULTI,\n\tWL12XX_FW_TYPE_PLT,\n};\n\nstruct wl1271;\n\nenum {\n\tFW_VER_CHIP,\n\tFW_VER_IF_TYPE,\n\tFW_VER_MAJOR,\n\tFW_VER_SUBTYPE,\n\tFW_VER_MINOR,\n\n\tNUM_FW_VER\n};\n\nstruct wl1271_chip {\n\tu32 id;\n\tchar fw_ver_str[ETHTOOL_FWVERS_LEN];\n\tunsigned int fw_ver[NUM_FW_VER];\n\tchar phy_fw_ver_str[ETHTOOL_FWVERS_LEN];\n};\n\n#define NUM_TX_QUEUES              4\n\nstruct wl_fw_status {\n\tu32 intr;\n\tu8  fw_rx_counter;\n\tu8  drv_rx_counter;\n\tu8  tx_results_counter;\n\t__le32 *rx_pkt_descs;\n\n\tu32 fw_localtime;\n\n\t \n\tu32 link_ps_bitmap;\n\n\t \n\tu32 link_fast_bitmap;\n\n\t \n\tu32 total_released_blks;\n\n\t \n\tu32 tx_total;\n\n\tstruct {\n\t\t \n\t\tu8 *tx_released_pkts;\n\n\t\t \n\t\tu8 *tx_lnk_free_pkts;\n\n\t\t \n\t\tu8 tx_voice_released_blks;\n\n\t\t \n\t\tu8 tx_last_rate;\n\n\t\t \n\t\tu8 tx_last_rate_mbps;\n\n\t\t \n\t\tu8 hlid;\n\t} counters;\n\n\tu32 log_start_addr;\n\n\t \n\tvoid *priv;\n};\n\n#define WL1271_MAX_CHANNELS 64\nstruct wl1271_scan {\n\tstruct cfg80211_scan_request *req;\n\tunsigned long scanned_ch[BITS_TO_LONGS(WL1271_MAX_CHANNELS)];\n\tbool failed;\n\tu8 state;\n\tu8 ssid[IEEE80211_MAX_SSID_LEN+1];\n\tsize_t ssid_len;\n};\n\nstruct wl1271_if_operations {\n\tint __must_check (*read)(struct device *child, int addr, void *buf,\n\t\t\t\t size_t len, bool fixed);\n\tint __must_check (*write)(struct device *child, int addr, void *buf,\n\t\t\t\t  size_t len, bool fixed);\n\tvoid (*reset)(struct device *child);\n\tvoid (*init)(struct device *child);\n\tint (*power)(struct device *child, bool enable);\n\tvoid (*set_block_size) (struct device *child, unsigned int blksz);\n};\n\nstruct wlcore_platdev_data {\n\tstruct wl1271_if_operations *if_ops;\n\tconst struct wilink_family_data *family;\n\n\tbool ref_clock_xtal;\t \n\tu32 ref_clock_freq;\t \n\tu32 tcxo_clock_freq;\t \n\tbool pwr_in_suspend;\n};\n\n#define MAX_NUM_KEYS 14\n#define MAX_KEY_SIZE 32\n\nstruct wl1271_ap_key {\n\tu8 id;\n\tu8 key_type;\n\tu8 key_size;\n\tu8 key[MAX_KEY_SIZE];\n\tu8 hlid;\n\tu32 tx_seq_32;\n\tu16 tx_seq_16;\n\tbool is_pairwise;\n};\n\nenum wl12xx_flags {\n\tWL1271_FLAG_GPIO_POWER,\n\tWL1271_FLAG_TX_QUEUE_STOPPED,\n\tWL1271_FLAG_TX_PENDING,\n\tWL1271_FLAG_IN_ELP,\n\tWL1271_FLAG_IRQ_RUNNING,\n\tWL1271_FLAG_FW_TX_BUSY,\n\tWL1271_FLAG_DUMMY_PACKET_PENDING,\n\tWL1271_FLAG_SUSPENDED,\n\tWL1271_FLAG_PENDING_WORK,\n\tWL1271_FLAG_SOFT_GEMINI,\n\tWL1271_FLAG_RECOVERY_IN_PROGRESS,\n\tWL1271_FLAG_VIF_CHANGE_IN_PROGRESS,\n\tWL1271_FLAG_INTENDED_FW_RECOVERY,\n\tWL1271_FLAG_IO_FAILED,\n\tWL1271_FLAG_REINIT_TX_WDOG,\n};\n\nenum wl12xx_vif_flags {\n\tWLVIF_FLAG_INITIALIZED,\n\tWLVIF_FLAG_STA_ASSOCIATED,\n\tWLVIF_FLAG_STA_AUTHORIZED,\n\tWLVIF_FLAG_IBSS_JOINED,\n\tWLVIF_FLAG_AP_STARTED,\n\tWLVIF_FLAG_IN_PS,\n\tWLVIF_FLAG_STA_STATE_SENT,\n\tWLVIF_FLAG_RX_STREAMING_STARTED,\n\tWLVIF_FLAG_PSPOLL_FAILURE,\n\tWLVIF_FLAG_CS_PROGRESS,\n\tWLVIF_FLAG_AP_PROBE_RESP_SET,\n\tWLVIF_FLAG_IN_USE,\n\tWLVIF_FLAG_ACTIVE,\n\tWLVIF_FLAG_BEACON_DISABLED,\n};\n\nstruct wl12xx_vif;\n\nstruct wl1271_link {\n\t \n\tstruct sk_buff_head tx_queue[NUM_TX_QUEUES];\n\n\t \n\tu8 allocated_pkts;\n\tu8 prev_freed_pkts;\n\n\tu8 addr[ETH_ALEN];\n\n\t \n\tu8 ba_bitmap;\n\n\t \n\tu8 fw_rate_idx;\n\n\t \n\tu8 fw_rate_mbps;\n\n\t \n\tstruct wl12xx_vif *wlvif;\n\n\t \n\tu64 total_freed_pkts;\n};\n\n#define WL1271_MAX_RX_FILTERS 5\n#define WL1271_RX_FILTER_MAX_FIELDS 8\n\n#define WL1271_RX_FILTER_ETH_HEADER_SIZE 14\n#define WL1271_RX_FILTER_MAX_FIELDS_SIZE 95\n#define RX_FILTER_FIELD_OVERHEAD\t\t\t\t\\\n\t(sizeof(struct wl12xx_rx_filter_field) - sizeof(u8 *))\n#define WL1271_RX_FILTER_MAX_PATTERN_SIZE\t\t\t\\\n\t(WL1271_RX_FILTER_MAX_FIELDS_SIZE - RX_FILTER_FIELD_OVERHEAD)\n\n#define WL1271_RX_FILTER_FLAG_MASK                BIT(0)\n#define WL1271_RX_FILTER_FLAG_IP_HEADER           0\n#define WL1271_RX_FILTER_FLAG_ETHERNET_HEADER     BIT(1)\n\nenum rx_filter_action {\n\tFILTER_DROP = 0,\n\tFILTER_SIGNAL = 1,\n\tFILTER_FW_HANDLE = 2\n};\n\nenum plt_mode {\n\tPLT_OFF = 0,\n\tPLT_ON = 1,\n\tPLT_FEM_DETECT = 2,\n\tPLT_CHIP_AWAKE = 3\n};\n\nstruct wl12xx_rx_filter_field {\n\t__le16 offset;\n\tu8 len;\n\tu8 flags;\n\tu8 *pattern;\n} __packed;\n\nstruct wl12xx_rx_filter {\n\tu8 action;\n\tint num_fields;\n\tstruct wl12xx_rx_filter_field fields[WL1271_RX_FILTER_MAX_FIELDS];\n};\n\nstruct wl1271_station {\n\tu8 hlid;\n\tbool in_connection;\n\n\t \n\tu64 total_freed_pkts;\n};\n\nstruct wl12xx_vif {\n\tstruct wl1271 *wl;\n\tstruct list_head list;\n\tunsigned long flags;\n\tu8 bss_type;\n\tu8 p2p;  \n\tu8 role_id;\n\n\t \n\tu8 dev_role_id;\n\tu8 dev_hlid;\n\n\tunion {\n\t\tstruct {\n\t\t\tu8 hlid;\n\n\t\t\tu8 basic_rate_idx;\n\t\t\tu8 ap_rate_idx;\n\t\t\tu8 p2p_rate_idx;\n\n\t\t\tu8 klv_template_id;\n\n\t\t\tbool qos;\n\t\t\t \n\t\t\tenum nl80211_channel_type role_chan_type;\n\t\t} sta;\n\t\tstruct {\n\t\t\tu8 global_hlid;\n\t\t\tu8 bcast_hlid;\n\n\t\t\t \n\t\t\tunsigned long sta_hlid_map[BITS_TO_LONGS(\n\t\t\t\t\t\t\tWLCORE_MAX_LINKS)];\n\n\t\t\t \n\t\t\tstruct wl1271_ap_key *recorded_keys[MAX_NUM_KEYS];\n\n\t\t\tu8 mgmt_rate_idx;\n\t\t\tu8 bcast_rate_idx;\n\t\t\tu8 ucast_rate_idx[CONF_TX_MAX_AC_COUNT];\n\t\t} ap;\n\t};\n\n\t \n\tint last_tx_hlid;\n\n\t \n\tint tx_queue_count[NUM_TX_QUEUES];\n\n\tunsigned long links_map[BITS_TO_LONGS(WLCORE_MAX_LINKS)];\n\n\tu8 ssid[IEEE80211_MAX_SSID_LEN + 1];\n\tu8 ssid_len;\n\n\t \n\tenum nl80211_band band;\n\tint channel;\n\tenum nl80211_channel_type channel_type;\n\n\tu32 bitrate_masks[WLCORE_NUM_BANDS];\n\tu32 basic_rate_set;\n\n\t \n\tu32 basic_rate;\n\tu32 rate_set;\n\n\t \n\tstruct sk_buff *probereq;\n\n\t \n\tu32 beacon_int;\n\n\t \n\tu32 default_key;\n\n\t \n\tu16 aid;\n\n\t \n\tu8 psm_entry_retry;\n\n\t \n\tint power_level;\n\n\tint rssi_thold;\n\tint last_rssi_event;\n\n\t \n\tu8 encryption_type;\n\t__be32 ip_addr;\n\n\t \n\tbool ba_support;\n\tbool ba_allowed;\n\n\tbool wmm_enabled;\n\n\tbool radar_enabled;\n\n\t \n\tstruct work_struct rx_streaming_enable_work;\n\tstruct work_struct rx_streaming_disable_work;\n\tstruct timer_list rx_streaming_timer;\n\n\tstruct delayed_work channel_switch_work;\n\tstruct delayed_work connection_loss_work;\n\n\t \n\tint inconn_count;\n\n\t \n\tint hw_queue_base;\n\n\t \n\tbool ap_pending_auth_reply;\n\n\t \n\tunsigned long pending_auth_reply_time;\n\n\t \n\tstruct delayed_work pending_auth_complete_work;\n\n\t \n\tenum ieee80211_sta_rx_bandwidth rc_update_bw;\n\tstruct ieee80211_sta_ht_cap rc_ht_cap;\n\tstruct work_struct rc_update_work;\n\n\t \n\tu64 total_freed_pkts;\n\n\t \n\tstruct {\n\t\tu8 persistent[0];\n\t};\n};\n\nstatic inline struct wl12xx_vif *wl12xx_vif_to_data(struct ieee80211_vif *vif)\n{\n\tWARN_ON(!vif);\n\treturn (struct wl12xx_vif *)vif->drv_priv;\n}\n\nstatic inline\nstruct ieee80211_vif *wl12xx_wlvif_to_vif(struct wl12xx_vif *wlvif)\n{\n\treturn container_of((void *)wlvif, struct ieee80211_vif, drv_priv);\n}\n\nstatic inline bool wlcore_is_p2p_mgmt(struct wl12xx_vif *wlvif)\n{\n\treturn wl12xx_wlvif_to_vif(wlvif)->type == NL80211_IFTYPE_P2P_DEVICE;\n}\n\n#define wl12xx_for_each_wlvif(wl, wlvif) \\\n\t\tlist_for_each_entry(wlvif, &wl->wlvif_list, list)\n\n#define wl12xx_for_each_wlvif_continue(wl, wlvif) \\\n\t\tlist_for_each_entry_continue(wlvif, &wl->wlvif_list, list)\n\n#define wl12xx_for_each_wlvif_bss_type(wl, wlvif, _bss_type)\t\\\n\t\twl12xx_for_each_wlvif(wl, wlvif)\t\t\\\n\t\t\tif (wlvif->bss_type == _bss_type)\n\n#define wl12xx_for_each_wlvif_sta(wl, wlvif)\t\\\n\t\twl12xx_for_each_wlvif_bss_type(wl, wlvif, BSS_TYPE_STA_BSS)\n\n#define wl12xx_for_each_wlvif_ap(wl, wlvif)\t\\\n\t\twl12xx_for_each_wlvif_bss_type(wl, wlvif, BSS_TYPE_AP_BSS)\n\nint wl1271_plt_start(struct wl1271 *wl, const enum plt_mode plt_mode);\nint wl1271_plt_stop(struct wl1271 *wl);\nint wl1271_recalc_rx_streaming(struct wl1271 *wl, struct wl12xx_vif *wlvif);\nvoid wl12xx_queue_recovery_work(struct wl1271 *wl);\nsize_t wl12xx_copy_fwlog(struct wl1271 *wl, u8 *memblock, size_t maxlen);\nint wl1271_rx_filter_alloc_field(struct wl12xx_rx_filter *filter,\n\t\t\t\t u16 offset, u8 flags,\n\t\t\t\t const u8 *pattern, u8 len);\nvoid wl1271_rx_filter_free(struct wl12xx_rx_filter *filter);\nstruct wl12xx_rx_filter *wl1271_rx_filter_alloc(void);\nint wl1271_rx_filter_get_fields_size(struct wl12xx_rx_filter *filter);\nvoid wl1271_rx_filter_flatten_fields(struct wl12xx_rx_filter *filter,\n\t\t\t\t     u8 *buf);\n\n#define JOIN_TIMEOUT 5000  \n\n#define SESSION_COUNTER_MAX 6  \n#define SESSION_COUNTER_INVALID 7  \n\n#define WL1271_DEFAULT_POWER_LEVEL 0\n\n#define WL1271_TX_QUEUE_LOW_WATERMARK  32\n#define WL1271_TX_QUEUE_HIGH_WATERMARK 256\n\n#define WL1271_DEFERRED_QUEUE_LIMIT    64\n\n \n#define WL1271_PRE_POWER_ON_SLEEP 20  \n#define WL1271_POWER_ON_SLEEP 200  \n\n \n#define HW_BG_RATES_MASK\t0xffff\n#define HW_HT_RATES_OFFSET\t16\n#define HW_MIMO_RATES_OFFSET\t24\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}