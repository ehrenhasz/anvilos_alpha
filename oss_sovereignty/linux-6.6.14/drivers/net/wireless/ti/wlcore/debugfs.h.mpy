{
  "module_name": "debugfs.h",
  "hash_id": "d5319f5f64ef056210d15d9d4a5938434e58233d15a383edd2c77833ec7f38fb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ti/wlcore/debugfs.h",
  "human_readable_source": " \n \n\n#ifndef __DEBUGFS_H__\n#define __DEBUGFS_H__\n\n#include \"wlcore.h\"\n\n__printf(4, 5) int wl1271_format_buffer(char __user *userbuf, size_t count,\n\t\t\t\t\tloff_t *ppos, char *fmt, ...);\n\nint wl1271_debugfs_init(struct wl1271 *wl);\nvoid wl1271_debugfs_exit(struct wl1271 *wl);\nvoid wl1271_debugfs_reset(struct wl1271 *wl);\nvoid wl1271_debugfs_update_stats(struct wl1271 *wl);\n\n#define DEBUGFS_FORMAT_BUFFER_SIZE 256\n\n#define DEBUGFS_READONLY_FILE(name, fmt, value...)\t\t\t\\\nstatic ssize_t name## _read(struct file *file, char __user *userbuf,\t\\\n\t\t\t    size_t count, loff_t *ppos)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct wl1271 *wl = file->private_data;\t\t\t\t\\\n\treturn wl1271_format_buffer(userbuf, count, ppos,\t\t\\\n\t\t\t\t    fmt \"\\n\", ##value);\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic const struct file_operations name## _ops = {\t\t\t\\\n\t.read = name## _read,\t\t\t\t\t\t\\\n\t.open = simple_open,\t\t\t\t\t\t\\\n\t.llseek\t= generic_file_llseek,\t\t\t\t\t\\\n};\n\n#define DEBUGFS_ADD(name, parent)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tdebugfs_create_file(#name, 0400, parent,\t\t\\\n\t\t\t\t    wl, &name## _ops);\t\t\t\\\n\t} while (0)\n\n\n#define DEBUGFS_ADD_PREFIX(prefix, name, parent)\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tdebugfs_create_file(#name, 0400, parent,\t\t\\\n\t\t\t\t    wl, &prefix## _## name## _ops);\t\\\n\t} while (0)\n\n#define DEBUGFS_FWSTATS_FILE(sub, name, fmt, struct_type)\t\t\\\nstatic ssize_t sub## _ ##name## _read(struct file *file,\t\t\\\n\t\t\t\t      char __user *userbuf,\t\t\\\n\t\t\t\t      size_t count, loff_t *ppos)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct wl1271 *wl = file->private_data;\t\t\t\t\\\n\tstruct struct_type *stats = wl->stats.fw_stats;\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\twl1271_debugfs_update_stats(wl);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn wl1271_format_buffer(userbuf, count, ppos, fmt \"\\n\",\t\\\n\t\t\t\t    stats->sub.name);\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic const struct file_operations sub## _ ##name## _ops = {\t\t\\\n\t.read = sub## _ ##name## _read,\t\t\t\t\t\\\n\t.open = simple_open,\t\t\t\t\t\t\\\n\t.llseek\t= generic_file_llseek,\t\t\t\t\t\\\n};\n\n#define DEBUGFS_FWSTATS_FILE_ARRAY(sub, name, len, struct_type)\t\t\\\nstatic ssize_t sub## _ ##name## _read(struct file *file,\t\t\\\n\t\t\t\t      char __user *userbuf,\t\t\\\n\t\t\t\t      size_t count, loff_t *ppos)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct wl1271 *wl = file->private_data;\t\t\t\t\\\n\tstruct struct_type *stats = wl->stats.fw_stats;\t\t\t\\\n\tchar buf[DEBUGFS_FORMAT_BUFFER_SIZE] = \"\";\t\t\t\\\n\tint pos = 0;\t\t\t\t\t\t\t\\\n\tint i;\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\twl1271_debugfs_update_stats(wl);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tfor (i = 0; i < len && pos < sizeof(buf); i++)\t\t\t\\\n\t\tpos += snprintf(buf + pos, sizeof(buf) - pos,\t\t\\\n\t\t\t \"[%d] = %d\\n\", i, stats->sub.name[i]);\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\treturn wl1271_format_buffer(userbuf, count, ppos, \"%s\", buf);\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic const struct file_operations sub## _ ##name## _ops = {\t\t\\\n\t.read = sub## _ ##name## _read,\t\t\t\t\t\\\n\t.open = simple_open,\t\t\t\t\t\t\\\n\t.llseek\t= generic_file_llseek,\t\t\t\t\t\\\n};\n\n#define DEBUGFS_FWSTATS_ADD(sub, name)\t\t\t\t\t\\\n\tDEBUGFS_ADD(sub## _ ##name, stats)\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}