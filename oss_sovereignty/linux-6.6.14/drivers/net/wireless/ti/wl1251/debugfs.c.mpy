{
  "module_name": "debugfs.c",
  "hash_id": "663167dd6ce0162312d11908dd67140f91f2f7be814594eec117532f4e0799ae",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ti/wl1251/debugfs.c",
  "human_readable_source": "\n \n\n#include \"debugfs.h\"\n\n#include <linux/skbuff.h>\n#include <linux/slab.h>\n\n#include \"wl1251.h\"\n#include \"acx.h\"\n#include \"ps.h\"\n\n \n#define WL1251_DEBUGFS_STATS_LIFETIME 1000\n\n \n\n#define DEBUGFS_READONLY_FILE(name, buflen, fmt, value...)\t\t\\\nstatic ssize_t name## _read(struct file *file, char __user *userbuf,\t\\\n\t\t\t    size_t count, loff_t *ppos)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct wl1251 *wl = file->private_data;\t\t\t\t\\\n\tchar buf[buflen];\t\t\t\t\t\t\\\n\tint res;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tres = scnprintf(buf, buflen, fmt \"\\n\", ##value);\t\t\\\n\treturn simple_read_from_buffer(userbuf, count, ppos, buf, res);\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic const struct file_operations name## _ops = {\t\t\t\\\n\t.read = name## _read,\t\t\t\t\t\t\\\n\t.open = simple_open,\t\t\t\t\t\t\\\n\t.llseek\t= generic_file_llseek,\t\t\t\t\t\\\n};\n\n#define DEBUGFS_ADD(name, parent)\t\t\t\t\t\\\n\twl->debugfs.name = debugfs_create_file(#name, 0400, parent,\t\\\n\t\t\t\t\t       wl, &name## _ops)\t\\\n\n#define DEBUGFS_DEL(name)\t\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tdebugfs_remove(wl->debugfs.name);\t\t\t\\\n\t\twl->debugfs.name = NULL;\t\t\t\t\\\n\t} while (0)\n\n#define DEBUGFS_FWSTATS_FILE(sub, name, buflen, fmt)\t\t\t\\\nstatic ssize_t sub## _ ##name## _read(struct file *file,\t\t\\\n\t\t\t\t      char __user *userbuf,\t\t\\\n\t\t\t\t      size_t count, loff_t *ppos)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct wl1251 *wl = file->private_data;\t\t\t\t\\\n\tchar buf[buflen];\t\t\t\t\t\t\\\n\tint res;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\twl1251_debugfs_update_stats(wl);\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tres = scnprintf(buf, buflen, fmt \"\\n\",\t\t\t\t\\\n\t\t\twl->stats.fw_stats->sub.name);\t\t\t\\\n\treturn simple_read_from_buffer(userbuf, count, ppos, buf, res);\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic const struct file_operations sub## _ ##name## _ops = {\t\t\\\n\t.read = sub## _ ##name## _read,\t\t\t\t\t\\\n\t.open = simple_open,\t\t\t\t\t\t\\\n\t.llseek\t= generic_file_llseek,\t\t\t\t\t\\\n};\n\n#define DEBUGFS_FWSTATS_ADD(sub, name)\t\t\t\t\\\n\tDEBUGFS_ADD(sub## _ ##name, wl->debugfs.fw_statistics)\n\n#define DEBUGFS_FWSTATS_DEL(sub, name)\t\t\t\t\\\n\tDEBUGFS_DEL(sub## _ ##name)\n\nstatic void wl1251_debugfs_update_stats(struct wl1251 *wl)\n{\n\tint ret;\n\n\tmutex_lock(&wl->mutex);\n\n\tret = wl1251_ps_elp_wakeup(wl);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (wl->state == WL1251_STATE_ON &&\n\t    time_after(jiffies, wl->stats.fw_stats_update +\n\t\t       msecs_to_jiffies(WL1251_DEBUGFS_STATS_LIFETIME))) {\n\t\twl1251_acx_statistics(wl, wl->stats.fw_stats);\n\t\twl->stats.fw_stats_update = jiffies;\n\t}\n\n\twl1251_ps_elp_sleep(wl);\n\nout:\n\tmutex_unlock(&wl->mutex);\n}\n\nDEBUGFS_FWSTATS_FILE(tx, internal_desc_overflow, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(rx, out_of_mem, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, hdr_overflow, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, hw_stuck, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, dropped, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, fcs_err, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, xfr_hint_trig, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, path_reset, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rx, reset_counter, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(dma, rx_requested, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(dma, rx_errors, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(dma, tx_requested, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(dma, tx_errors, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(isr, cmd_cmplt, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, fiqs, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, rx_headers, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, rx_mem_overflow, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, rx_rdys, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, irqs, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, tx_procs, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, decrypt_done, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, dma0_done, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, dma1_done, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, tx_exch_complete, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, commands, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, rx_procs, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, hw_pm_mode_changes, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, host_acknowledges, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, pci_pm, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, wakeups, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(isr, low_rssi, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(wep, addr_key_count, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(wep, default_key_count, 20, \"%u\");\n \nDEBUGFS_FWSTATS_FILE(wep, key_not_found, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(wep, decrypt_fail, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(wep, packets, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(wep, interrupt, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(pwr, ps_enter, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, elp_enter, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, missing_bcns, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, wake_on_host, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, wake_on_timer_exp, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, tx_with_ps, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, tx_without_ps, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, rcvd_beacons, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, power_save_off, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, enable_ps, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, disable_ps, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(pwr, fix_tsf_ps, 20, \"%u\");\n \nDEBUGFS_FWSTATS_FILE(pwr, rcvd_awake_beacons, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(mic, rx_pkts, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(mic, calc_failure, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(aes, encrypt_fail, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(aes, decrypt_fail, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(aes, encrypt_packets, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(aes, decrypt_packets, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(aes, encrypt_interrupt, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(aes, decrypt_interrupt, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(event, heart_beat, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, calibration, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, rx_mismatch, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, rx_mem_empty, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, rx_pool, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, oom_late, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, phy_transmit_error, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(event, tx_stuck, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(ps, pspoll_timeouts, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, upsd_timeouts, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, upsd_max_sptime, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, upsd_max_apturn, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, pspoll_max_apturn, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, pspoll_utilization, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(ps, upsd_utilization, 20, \"%u\");\n\nDEBUGFS_FWSTATS_FILE(rxpipe, rx_prep_beacon_drop, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rxpipe, descr_host_int_trig_rx_data, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rxpipe, beacon_buffer_thres_host_int_trig_rx_data,\n\t\t     20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rxpipe, missed_beacon_host_int_trig_rx_data, 20, \"%u\");\nDEBUGFS_FWSTATS_FILE(rxpipe, tx_xfr_host_int_trig_rx_data, 20, \"%u\");\n\nDEBUGFS_READONLY_FILE(retry_count, 20, \"%u\", wl->stats.retry_count);\nDEBUGFS_READONLY_FILE(excessive_retries, 20, \"%u\",\n\t\t      wl->stats.excessive_retries);\n\nstatic ssize_t tx_queue_len_read(struct file *file, char __user *userbuf,\n\t\t\t\t size_t count, loff_t *ppos)\n{\n\tstruct wl1251 *wl = file->private_data;\n\tu32 queue_len;\n\tchar buf[20];\n\tint res;\n\n\tqueue_len = skb_queue_len(&wl->tx_queue);\n\n\tres = scnprintf(buf, sizeof(buf), \"%u\\n\", queue_len);\n\treturn simple_read_from_buffer(userbuf, count, ppos, buf, res);\n}\n\nstatic const struct file_operations tx_queue_len_ops = {\n\t.read = tx_queue_len_read,\n\t.open = simple_open,\n\t.llseek = generic_file_llseek,\n};\n\nstatic ssize_t tx_queue_status_read(struct file *file, char __user *userbuf,\n\t\t\t\t    size_t count, loff_t *ppos)\n{\n\tstruct wl1251 *wl = file->private_data;\n\tchar buf[3], status;\n\tint len;\n\n\tif (wl->tx_queue_stopped)\n\t\tstatus = 's';\n\telse\n\t\tstatus = 'r';\n\n\tlen = scnprintf(buf, sizeof(buf), \"%c\\n\", status);\n\treturn simple_read_from_buffer(userbuf, count, ppos, buf, len);\n}\n\nstatic const struct file_operations tx_queue_status_ops = {\n\t.read = tx_queue_status_read,\n\t.open = simple_open,\n\t.llseek = generic_file_llseek,\n};\n\nstatic void wl1251_debugfs_delete_files(struct wl1251 *wl)\n{\n\tDEBUGFS_FWSTATS_DEL(tx, internal_desc_overflow);\n\n\tDEBUGFS_FWSTATS_DEL(rx, out_of_mem);\n\tDEBUGFS_FWSTATS_DEL(rx, hdr_overflow);\n\tDEBUGFS_FWSTATS_DEL(rx, hw_stuck);\n\tDEBUGFS_FWSTATS_DEL(rx, dropped);\n\tDEBUGFS_FWSTATS_DEL(rx, fcs_err);\n\tDEBUGFS_FWSTATS_DEL(rx, xfr_hint_trig);\n\tDEBUGFS_FWSTATS_DEL(rx, path_reset);\n\tDEBUGFS_FWSTATS_DEL(rx, reset_counter);\n\n\tDEBUGFS_FWSTATS_DEL(dma, rx_requested);\n\tDEBUGFS_FWSTATS_DEL(dma, rx_errors);\n\tDEBUGFS_FWSTATS_DEL(dma, tx_requested);\n\tDEBUGFS_FWSTATS_DEL(dma, tx_errors);\n\n\tDEBUGFS_FWSTATS_DEL(isr, cmd_cmplt);\n\tDEBUGFS_FWSTATS_DEL(isr, fiqs);\n\tDEBUGFS_FWSTATS_DEL(isr, rx_headers);\n\tDEBUGFS_FWSTATS_DEL(isr, rx_mem_overflow);\n\tDEBUGFS_FWSTATS_DEL(isr, rx_rdys);\n\tDEBUGFS_FWSTATS_DEL(isr, irqs);\n\tDEBUGFS_FWSTATS_DEL(isr, tx_procs);\n\tDEBUGFS_FWSTATS_DEL(isr, decrypt_done);\n\tDEBUGFS_FWSTATS_DEL(isr, dma0_done);\n\tDEBUGFS_FWSTATS_DEL(isr, dma1_done);\n\tDEBUGFS_FWSTATS_DEL(isr, tx_exch_complete);\n\tDEBUGFS_FWSTATS_DEL(isr, commands);\n\tDEBUGFS_FWSTATS_DEL(isr, rx_procs);\n\tDEBUGFS_FWSTATS_DEL(isr, hw_pm_mode_changes);\n\tDEBUGFS_FWSTATS_DEL(isr, host_acknowledges);\n\tDEBUGFS_FWSTATS_DEL(isr, pci_pm);\n\tDEBUGFS_FWSTATS_DEL(isr, wakeups);\n\tDEBUGFS_FWSTATS_DEL(isr, low_rssi);\n\n\tDEBUGFS_FWSTATS_DEL(wep, addr_key_count);\n\tDEBUGFS_FWSTATS_DEL(wep, default_key_count);\n\t \n\tDEBUGFS_FWSTATS_DEL(wep, key_not_found);\n\tDEBUGFS_FWSTATS_DEL(wep, decrypt_fail);\n\tDEBUGFS_FWSTATS_DEL(wep, packets);\n\tDEBUGFS_FWSTATS_DEL(wep, interrupt);\n\n\tDEBUGFS_FWSTATS_DEL(pwr, ps_enter);\n\tDEBUGFS_FWSTATS_DEL(pwr, elp_enter);\n\tDEBUGFS_FWSTATS_DEL(pwr, missing_bcns);\n\tDEBUGFS_FWSTATS_DEL(pwr, wake_on_host);\n\tDEBUGFS_FWSTATS_DEL(pwr, wake_on_timer_exp);\n\tDEBUGFS_FWSTATS_DEL(pwr, tx_with_ps);\n\tDEBUGFS_FWSTATS_DEL(pwr, tx_without_ps);\n\tDEBUGFS_FWSTATS_DEL(pwr, rcvd_beacons);\n\tDEBUGFS_FWSTATS_DEL(pwr, power_save_off);\n\tDEBUGFS_FWSTATS_DEL(pwr, enable_ps);\n\tDEBUGFS_FWSTATS_DEL(pwr, disable_ps);\n\tDEBUGFS_FWSTATS_DEL(pwr, fix_tsf_ps);\n\t \n\tDEBUGFS_FWSTATS_DEL(pwr, rcvd_awake_beacons);\n\n\tDEBUGFS_FWSTATS_DEL(mic, rx_pkts);\n\tDEBUGFS_FWSTATS_DEL(mic, calc_failure);\n\n\tDEBUGFS_FWSTATS_DEL(aes, encrypt_fail);\n\tDEBUGFS_FWSTATS_DEL(aes, decrypt_fail);\n\tDEBUGFS_FWSTATS_DEL(aes, encrypt_packets);\n\tDEBUGFS_FWSTATS_DEL(aes, decrypt_packets);\n\tDEBUGFS_FWSTATS_DEL(aes, encrypt_interrupt);\n\tDEBUGFS_FWSTATS_DEL(aes, decrypt_interrupt);\n\n\tDEBUGFS_FWSTATS_DEL(event, heart_beat);\n\tDEBUGFS_FWSTATS_DEL(event, calibration);\n\tDEBUGFS_FWSTATS_DEL(event, rx_mismatch);\n\tDEBUGFS_FWSTATS_DEL(event, rx_mem_empty);\n\tDEBUGFS_FWSTATS_DEL(event, rx_pool);\n\tDEBUGFS_FWSTATS_DEL(event, oom_late);\n\tDEBUGFS_FWSTATS_DEL(event, phy_transmit_error);\n\tDEBUGFS_FWSTATS_DEL(event, tx_stuck);\n\n\tDEBUGFS_FWSTATS_DEL(ps, pspoll_timeouts);\n\tDEBUGFS_FWSTATS_DEL(ps, upsd_timeouts);\n\tDEBUGFS_FWSTATS_DEL(ps, upsd_max_sptime);\n\tDEBUGFS_FWSTATS_DEL(ps, upsd_max_apturn);\n\tDEBUGFS_FWSTATS_DEL(ps, pspoll_max_apturn);\n\tDEBUGFS_FWSTATS_DEL(ps, pspoll_utilization);\n\tDEBUGFS_FWSTATS_DEL(ps, upsd_utilization);\n\n\tDEBUGFS_FWSTATS_DEL(rxpipe, rx_prep_beacon_drop);\n\tDEBUGFS_FWSTATS_DEL(rxpipe, descr_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_DEL(rxpipe, beacon_buffer_thres_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_DEL(rxpipe, missed_beacon_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_DEL(rxpipe, tx_xfr_host_int_trig_rx_data);\n\n\tDEBUGFS_DEL(tx_queue_len);\n\tDEBUGFS_DEL(tx_queue_status);\n\tDEBUGFS_DEL(retry_count);\n\tDEBUGFS_DEL(excessive_retries);\n}\n\nstatic void wl1251_debugfs_add_files(struct wl1251 *wl)\n{\n\tDEBUGFS_FWSTATS_ADD(tx, internal_desc_overflow);\n\n\tDEBUGFS_FWSTATS_ADD(rx, out_of_mem);\n\tDEBUGFS_FWSTATS_ADD(rx, hdr_overflow);\n\tDEBUGFS_FWSTATS_ADD(rx, hw_stuck);\n\tDEBUGFS_FWSTATS_ADD(rx, dropped);\n\tDEBUGFS_FWSTATS_ADD(rx, fcs_err);\n\tDEBUGFS_FWSTATS_ADD(rx, xfr_hint_trig);\n\tDEBUGFS_FWSTATS_ADD(rx, path_reset);\n\tDEBUGFS_FWSTATS_ADD(rx, reset_counter);\n\n\tDEBUGFS_FWSTATS_ADD(dma, rx_requested);\n\tDEBUGFS_FWSTATS_ADD(dma, rx_errors);\n\tDEBUGFS_FWSTATS_ADD(dma, tx_requested);\n\tDEBUGFS_FWSTATS_ADD(dma, tx_errors);\n\n\tDEBUGFS_FWSTATS_ADD(isr, cmd_cmplt);\n\tDEBUGFS_FWSTATS_ADD(isr, fiqs);\n\tDEBUGFS_FWSTATS_ADD(isr, rx_headers);\n\tDEBUGFS_FWSTATS_ADD(isr, rx_mem_overflow);\n\tDEBUGFS_FWSTATS_ADD(isr, rx_rdys);\n\tDEBUGFS_FWSTATS_ADD(isr, irqs);\n\tDEBUGFS_FWSTATS_ADD(isr, tx_procs);\n\tDEBUGFS_FWSTATS_ADD(isr, decrypt_done);\n\tDEBUGFS_FWSTATS_ADD(isr, dma0_done);\n\tDEBUGFS_FWSTATS_ADD(isr, dma1_done);\n\tDEBUGFS_FWSTATS_ADD(isr, tx_exch_complete);\n\tDEBUGFS_FWSTATS_ADD(isr, commands);\n\tDEBUGFS_FWSTATS_ADD(isr, rx_procs);\n\tDEBUGFS_FWSTATS_ADD(isr, hw_pm_mode_changes);\n\tDEBUGFS_FWSTATS_ADD(isr, host_acknowledges);\n\tDEBUGFS_FWSTATS_ADD(isr, pci_pm);\n\tDEBUGFS_FWSTATS_ADD(isr, wakeups);\n\tDEBUGFS_FWSTATS_ADD(isr, low_rssi);\n\n\tDEBUGFS_FWSTATS_ADD(wep, addr_key_count);\n\tDEBUGFS_FWSTATS_ADD(wep, default_key_count);\n\t \n\tDEBUGFS_FWSTATS_ADD(wep, key_not_found);\n\tDEBUGFS_FWSTATS_ADD(wep, decrypt_fail);\n\tDEBUGFS_FWSTATS_ADD(wep, packets);\n\tDEBUGFS_FWSTATS_ADD(wep, interrupt);\n\n\tDEBUGFS_FWSTATS_ADD(pwr, ps_enter);\n\tDEBUGFS_FWSTATS_ADD(pwr, elp_enter);\n\tDEBUGFS_FWSTATS_ADD(pwr, missing_bcns);\n\tDEBUGFS_FWSTATS_ADD(pwr, wake_on_host);\n\tDEBUGFS_FWSTATS_ADD(pwr, wake_on_timer_exp);\n\tDEBUGFS_FWSTATS_ADD(pwr, tx_with_ps);\n\tDEBUGFS_FWSTATS_ADD(pwr, tx_without_ps);\n\tDEBUGFS_FWSTATS_ADD(pwr, rcvd_beacons);\n\tDEBUGFS_FWSTATS_ADD(pwr, power_save_off);\n\tDEBUGFS_FWSTATS_ADD(pwr, enable_ps);\n\tDEBUGFS_FWSTATS_ADD(pwr, disable_ps);\n\tDEBUGFS_FWSTATS_ADD(pwr, fix_tsf_ps);\n\t \n\tDEBUGFS_FWSTATS_ADD(pwr, rcvd_awake_beacons);\n\n\tDEBUGFS_FWSTATS_ADD(mic, rx_pkts);\n\tDEBUGFS_FWSTATS_ADD(mic, calc_failure);\n\n\tDEBUGFS_FWSTATS_ADD(aes, encrypt_fail);\n\tDEBUGFS_FWSTATS_ADD(aes, decrypt_fail);\n\tDEBUGFS_FWSTATS_ADD(aes, encrypt_packets);\n\tDEBUGFS_FWSTATS_ADD(aes, decrypt_packets);\n\tDEBUGFS_FWSTATS_ADD(aes, encrypt_interrupt);\n\tDEBUGFS_FWSTATS_ADD(aes, decrypt_interrupt);\n\n\tDEBUGFS_FWSTATS_ADD(event, heart_beat);\n\tDEBUGFS_FWSTATS_ADD(event, calibration);\n\tDEBUGFS_FWSTATS_ADD(event, rx_mismatch);\n\tDEBUGFS_FWSTATS_ADD(event, rx_mem_empty);\n\tDEBUGFS_FWSTATS_ADD(event, rx_pool);\n\tDEBUGFS_FWSTATS_ADD(event, oom_late);\n\tDEBUGFS_FWSTATS_ADD(event, phy_transmit_error);\n\tDEBUGFS_FWSTATS_ADD(event, tx_stuck);\n\n\tDEBUGFS_FWSTATS_ADD(ps, pspoll_timeouts);\n\tDEBUGFS_FWSTATS_ADD(ps, upsd_timeouts);\n\tDEBUGFS_FWSTATS_ADD(ps, upsd_max_sptime);\n\tDEBUGFS_FWSTATS_ADD(ps, upsd_max_apturn);\n\tDEBUGFS_FWSTATS_ADD(ps, pspoll_max_apturn);\n\tDEBUGFS_FWSTATS_ADD(ps, pspoll_utilization);\n\tDEBUGFS_FWSTATS_ADD(ps, upsd_utilization);\n\n\tDEBUGFS_FWSTATS_ADD(rxpipe, rx_prep_beacon_drop);\n\tDEBUGFS_FWSTATS_ADD(rxpipe, descr_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_ADD(rxpipe, beacon_buffer_thres_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_ADD(rxpipe, missed_beacon_host_int_trig_rx_data);\n\tDEBUGFS_FWSTATS_ADD(rxpipe, tx_xfr_host_int_trig_rx_data);\n\n\tDEBUGFS_ADD(tx_queue_len, wl->debugfs.rootdir);\n\tDEBUGFS_ADD(tx_queue_status, wl->debugfs.rootdir);\n\tDEBUGFS_ADD(retry_count, wl->debugfs.rootdir);\n\tDEBUGFS_ADD(excessive_retries, wl->debugfs.rootdir);\n}\n\nvoid wl1251_debugfs_reset(struct wl1251 *wl)\n{\n\tif (wl->stats.fw_stats != NULL)\n\t\tmemset(wl->stats.fw_stats, 0, sizeof(*wl->stats.fw_stats));\n\twl->stats.retry_count = 0;\n\twl->stats.excessive_retries = 0;\n}\n\nint wl1251_debugfs_init(struct wl1251 *wl)\n{\n\twl->stats.fw_stats = kzalloc(sizeof(*wl->stats.fw_stats), GFP_KERNEL);\n\tif (!wl->stats.fw_stats)\n\t\treturn -ENOMEM;\n\n\twl->debugfs.rootdir = debugfs_create_dir(KBUILD_MODNAME, NULL);\n\n\twl->debugfs.fw_statistics = debugfs_create_dir(\"fw-statistics\",\n\t\t\t\t\t\t       wl->debugfs.rootdir);\n\n\twl->stats.fw_stats_update = jiffies;\n\n\twl1251_debugfs_add_files(wl);\n\n\treturn 0;\n}\n\nvoid wl1251_debugfs_exit(struct wl1251 *wl)\n{\n\twl1251_debugfs_delete_files(wl);\n\n\tkfree(wl->stats.fw_stats);\n\twl->stats.fw_stats = NULL;\n\n\tdebugfs_remove(wl->debugfs.fw_statistics);\n\twl->debugfs.fw_statistics = NULL;\n\n\tdebugfs_remove(wl->debugfs.rootdir);\n\twl->debugfs.rootdir = NULL;\n\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}