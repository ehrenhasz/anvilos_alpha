{
  "module_name": "zd_mac.h",
  "hash_id": "1c2479ce9551a8ff5d6a21c5439fbb3e30da8d189c0ca55b5601aa8f2a6bac0c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/zydas/zd1211rw/zd_mac.h",
  "human_readable_source": " \n \n\n#ifndef _ZD_MAC_H\n#define _ZD_MAC_H\n\n#include <linux/kernel.h>\n#include <net/mac80211.h>\n\n#include \"zd_chip.h\"\n\nstruct zd_ctrlset {\n\tu8     modulation;\n\t__le16 tx_length;\n\tu8     control;\n\t \n\t__le16 packet_length;\n\t__le16 current_length;\n\tu8     service;\n\t__le16  next_frame_length;\n} __packed;\n\n#define ZD_CS_RESERVED_SIZE\t25\n\n \n#define ZD_PURE_RATE_MASK       0x0f\n#define ZD_MODULATION_TYPE_MASK 0x10\n#define ZD_RATE_MASK            (ZD_PURE_RATE_MASK|ZD_MODULATION_TYPE_MASK)\n#define ZD_PURE_RATE(modulation) ((modulation) & ZD_PURE_RATE_MASK)\n#define ZD_MODULATION_TYPE(modulation) ((modulation) & ZD_MODULATION_TYPE_MASK)\n#define ZD_RATE(modulation) ((modulation) & ZD_RATE_MASK)\n\n \n#define ZD_CCK                  0x00\n#define ZD_OFDM                 0x10\n\n \n#define ZD_CCK_RATE_1M          (ZD_CCK|0x00)\n#define ZD_CCK_RATE_2M          (ZD_CCK|0x01)\n#define ZD_CCK_RATE_5_5M        (ZD_CCK|0x02)\n#define ZD_CCK_RATE_11M         (ZD_CCK|0x03)\n#define ZD_OFDM_RATE_6M         (ZD_OFDM|ZD_OFDM_PLCP_RATE_6M)\n#define ZD_OFDM_RATE_9M         (ZD_OFDM|ZD_OFDM_PLCP_RATE_9M)\n#define ZD_OFDM_RATE_12M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_12M)\n#define ZD_OFDM_RATE_18M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_18M)\n#define ZD_OFDM_RATE_24M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_24M)\n#define ZD_OFDM_RATE_36M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_36M)\n#define ZD_OFDM_RATE_48M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_48M)\n#define ZD_OFDM_RATE_54M        (ZD_OFDM|ZD_OFDM_PLCP_RATE_54M)\n\n \n#define ZD_CCK_PREA_LONG        0x00\n#define ZD_CCK_PREA_SHORT       0x20\n#define ZD_OFDM_MODE_11G        0x00\n#define ZD_OFDM_MODE_11A        0x20\n\n \n#define ZD_CS_NEED_RANDOM_BACKOFF\t0x01\n#define ZD_CS_NO_ACK\t\t\t0x02\n\n#define ZD_CS_FRAME_TYPE_MASK\t\t0x0c\n#define ZD_CS_DATA_FRAME\t\t0x00\n#define ZD_CS_PS_POLL_FRAME\t\t0x04\n#define ZD_CS_MANAGEMENT_FRAME\t\t0x08\n#define ZD_CS_NO_SEQUENCE_CTL_FRAME\t0x0c\n\n#define ZD_CS_WAKE_DESTINATION\t\t0x10\n#define ZD_CS_RTS\t\t\t0x20\n#define ZD_CS_ENCRYPT\t\t\t0x40\n#define ZD_CS_SELF_CTS\t\t\t0x80\n\n \n#define ZD_PLCP_HEADER_SIZE\t\t5\n\nstruct rx_length_info {\n\t__le16 length[3];\n\t__le16 tag;\n} __packed;\n\n#define RX_LENGTH_INFO_TAG\t\t0x697e\n\nstruct rx_status {\n\tu8 signal_quality_cck;\n\t \n\tu8 signal_strength;\n\tu8 signal_quality_ofdm;\n\tu8 decryption_type;\n\tu8 frame_status;\n} __packed;\n\n \n#define ZD_RX_NO_WEP\t0\n#define ZD_RX_WEP64\t1\n#define ZD_RX_TKIP\t2\n#define ZD_RX_AES\t4\n#define ZD_RX_WEP128\t5\n#define ZD_RX_WEP256\t6\n\n \n#define ZD_RX_FRAME_MODULATION_MASK\t0x01\n#define ZD_RX_CCK\t\t\t0x00\n#define ZD_RX_OFDM\t\t\t0x01\n\n#define ZD_RX_TIMEOUT_ERROR\t\t0x02\n#define ZD_RX_FIFO_OVERRUN_ERROR\t0x04\n#define ZD_RX_DECRYPTION_ERROR\t\t0x08\n#define ZD_RX_CRC32_ERROR\t\t0x10\n#define ZD_RX_NO_ADDR1_MATCH_ERROR\t0x20\n#define ZD_RX_CRC16_ERROR\t\t0x40\n#define ZD_RX_ERROR\t\t\t0x80\n\nstruct tx_retry_rate {\n\tint count;\t \n\tint rate[10];\t \n};\n\nstruct tx_status {\n\tu8 type;\t \n\tu8 id;\t\t \n\tu8 rate;\n\tu8 pad;\n\tu8 mac[ETH_ALEN];\n\tu8 retry;\n\tu8 failure;\n} __packed;\n\nenum mac_flags {\n\tMAC_FIXED_CHANNEL = 0x01,\n};\n\nstruct housekeeping {\n\tstruct delayed_work link_led_work;\n};\n\nstruct beacon {\n\tstruct delayed_work watchdog_work;\n\tstruct sk_buff *cur_beacon;\n\tunsigned long last_update;\n\tu16 interval;\n\tu8 period;\n};\n\nenum zd_device_flags {\n\tZD_DEVICE_RUNNING,\n};\n\n#define ZD_MAC_STATS_BUFFER_SIZE 16\n\n#define ZD_MAC_MAX_ACK_WAITERS 50\n\nstruct zd_mac {\n\tstruct zd_chip chip;\n\tspinlock_t lock;\n\tspinlock_t intr_lock;\n\tstruct ieee80211_hw *hw;\n\tstruct ieee80211_vif *vif;\n\tstruct housekeeping housekeeping;\n\tstruct beacon beacon;\n\tstruct work_struct set_rts_cts_work;\n\tstruct work_struct process_intr;\n\tstruct zd_mc_hash multicast_hash;\n\tu8 intr_buffer[USB_MAX_EP_INT_BUFFER];\n\tu8 regdomain;\n\tu8 default_regdomain;\n\tu8 channel;\n\tint type;\n\tint associated;\n\tunsigned long flags;\n\tstruct sk_buff_head ack_wait_queue;\n\tstruct ieee80211_channel channels[14];\n\tstruct ieee80211_rate rates[12];\n\tstruct ieee80211_supported_band band;\n\n\t \n\tunsigned int short_preamble:1;\n\n\t \n\tunsigned int pass_failed_fcs:1;\n\n\t \n\tunsigned int pass_ctrl:1;\n\n\t \n\tunsigned int ack_pending:1;\n\n\t \n\tint ack_signal;\n};\n\n#define ZD_REGDOMAIN_FCC\t0x10\n#define ZD_REGDOMAIN_IC\t\t0x20\n#define ZD_REGDOMAIN_ETSI\t0x30\n#define ZD_REGDOMAIN_SPAIN\t0x31\n#define ZD_REGDOMAIN_FRANCE\t0x32\n#define ZD_REGDOMAIN_JAPAN_2\t0x40\n#define ZD_REGDOMAIN_JAPAN\t0x41\n#define ZD_REGDOMAIN_JAPAN_3\t0x49\n\nenum {\n\tMIN_CHANNEL24 = 1,\n\tMAX_CHANNEL24 = 14,\n};\n\n#define ZD_PLCP_SERVICE_LENGTH_EXTENSION 0x80\n\nstruct ofdm_plcp_header {\n\tu8 prefix[3];\n\t__le16 service;\n} __packed;\n\nstatic inline u8 zd_ofdm_plcp_header_rate(const struct ofdm_plcp_header *header)\n{\n\treturn header->prefix[0] & 0xf;\n}\n\n \n#define ZD_OFDM_PLCP_RATE_6M\t0xb\n#define ZD_OFDM_PLCP_RATE_9M\t0xf\n#define ZD_OFDM_PLCP_RATE_12M\t0xa\n#define ZD_OFDM_PLCP_RATE_18M\t0xe\n#define ZD_OFDM_PLCP_RATE_24M\t0x9\n#define ZD_OFDM_PLCP_RATE_36M\t0xd\n#define ZD_OFDM_PLCP_RATE_48M\t0x8\n#define ZD_OFDM_PLCP_RATE_54M\t0xc\n\nstruct cck_plcp_header {\n\tu8 signal;\n\tu8 service;\n\t__le16 length;\n\t__le16 crc16;\n} __packed;\n\nstatic inline u8 zd_cck_plcp_header_signal(const struct cck_plcp_header *header)\n{\n\treturn header->signal;\n}\n\n \n#define ZD_CCK_PLCP_SIGNAL_1M\t0x0a\n#define ZD_CCK_PLCP_SIGNAL_2M\t0x14\n#define ZD_CCK_PLCP_SIGNAL_5M5\t0x37\n#define ZD_CCK_PLCP_SIGNAL_11M\t0x6e\n\nstatic inline struct zd_mac *zd_hw_mac(struct ieee80211_hw *hw)\n{\n\treturn hw->priv;\n}\n\nstatic inline struct zd_mac *zd_chip_to_mac(struct zd_chip *chip)\n{\n\treturn container_of(chip, struct zd_mac, chip);\n}\n\nstatic inline struct zd_mac *zd_usb_to_mac(struct zd_usb *usb)\n{\n\treturn zd_chip_to_mac(zd_usb_to_chip(usb));\n}\n\nstatic inline u8 *zd_mac_get_perm_addr(struct zd_mac *mac)\n{\n\treturn mac->hw->wiphy->perm_addr;\n}\n\n#define zd_mac_dev(mac) (zd_chip_dev(&(mac)->chip))\n\nstruct ieee80211_hw *zd_mac_alloc_hw(struct usb_interface *intf);\nvoid zd_mac_clear(struct zd_mac *mac);\n\nint zd_mac_preinit_hw(struct ieee80211_hw *hw);\nint zd_mac_init_hw(struct ieee80211_hw *hw);\n\nint zd_mac_rx(struct ieee80211_hw *hw, const u8 *buffer, unsigned int length);\nvoid zd_mac_tx_failed(struct urb *urb);\nvoid zd_mac_tx_to_dev(struct sk_buff *skb, int error);\n\nint zd_op_start(struct ieee80211_hw *hw);\nvoid zd_op_stop(struct ieee80211_hw *hw);\nint zd_restore_settings(struct zd_mac *mac);\n\n#ifdef DEBUG\nvoid zd_dump_rx_status(const struct rx_status *status);\n#else\n#define zd_dump_rx_status(status)\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}