{
  "module_name": "bus.h",
  "hash_id": "86bf198d3e38f6c66f182a36ea606cfe384589514c9b0a38b5fc87364a9d7f15",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/quantenna/qtnfmac/bus.h",
  "human_readable_source": " \n \n\n#ifndef QTNFMAC_BUS_H\n#define QTNFMAC_BUS_H\n\n#include <linux/netdevice.h>\n#include <linux/workqueue.h>\n\n#include \"trans.h\"\n#include \"core.h\"\n\n#define QTNF_MAX_MAC\t\t3\n\n#define HBM_FRAME_META_MAGIC_PATTERN_S\t0xAB\n#define HBM_FRAME_META_MAGIC_PATTERN_E\t0xBA\n\nstruct qtnf_frame_meta_info {\n\tu8 magic_s;\n\tu8 ifidx;\n\tu8 macid;\n\tu8 magic_e;\n} __packed;\n\nenum qtnf_fw_state {\n\tQTNF_FW_STATE_DETACHED,\n\tQTNF_FW_STATE_BOOT_DONE,\n\tQTNF_FW_STATE_ACTIVE,\n\tQTNF_FW_STATE_RUNNING,\n\tQTNF_FW_STATE_DEAD,\n};\n\nstruct qtnf_bus;\n\nstruct qtnf_bus_ops {\n\t \n\tint (*preinit)(struct qtnf_bus *);\n\tvoid (*stop)(struct qtnf_bus *);\n\n\t \n\tint (*control_tx)(struct qtnf_bus *, struct sk_buff *);\n\n\t \n\tint (*data_tx)(struct qtnf_bus *bus, struct sk_buff *skb,\n\t\t       unsigned int macid, unsigned int vifid);\n\tvoid (*data_tx_timeout)(struct qtnf_bus *, struct net_device *);\n\tvoid (*data_tx_use_meta_set)(struct qtnf_bus *bus, bool use_meta);\n\tvoid (*data_rx_start)(struct qtnf_bus *);\n\tvoid (*data_rx_stop)(struct qtnf_bus *);\n};\n\nstruct qtnf_bus {\n\tstruct device *dev;\n\tenum qtnf_fw_state fw_state;\n\tu32 chip;\n\tu32 chiprev;\n\tstruct qtnf_bus_ops *bus_ops;\n\tstruct qtnf_wmac *mac[QTNF_MAX_MAC];\n\tstruct qtnf_qlink_transport trans;\n\tstruct qtnf_hw_info hw_info;\n\tstruct napi_struct mux_napi;\n\tstruct net_device mux_dev;\n\tstruct workqueue_struct *workqueue;\n\tstruct workqueue_struct *hprio_workqueue;\n\tstruct work_struct fw_work;\n\tstruct work_struct event_work;\n\tstruct mutex bus_lock;  \n\tstruct dentry *dbg_dir;\n\tstruct notifier_block netdev_nb;\n\tu8 hw_id[ETH_ALEN];\n\t \n\tchar bus_priv[] __aligned(sizeof(void *));\n};\n\nstatic inline bool qtnf_fw_is_up(struct qtnf_bus *bus)\n{\n\tenum qtnf_fw_state state = bus->fw_state;\n\n\treturn ((state == QTNF_FW_STATE_ACTIVE) ||\n\t\t(state == QTNF_FW_STATE_RUNNING));\n}\n\nstatic inline bool qtnf_fw_is_attached(struct qtnf_bus *bus)\n{\n\tenum qtnf_fw_state state = bus->fw_state;\n\n\treturn ((state == QTNF_FW_STATE_ACTIVE) ||\n\t\t(state == QTNF_FW_STATE_RUNNING) ||\n\t\t(state == QTNF_FW_STATE_DEAD));\n}\n\nstatic inline void *get_bus_priv(struct qtnf_bus *bus)\n{\n\tif (WARN(!bus, \"qtnfmac: invalid bus pointer\"))\n\t\treturn NULL;\n\n\treturn &bus->bus_priv;\n}\n\n \n\nstatic inline int qtnf_bus_preinit(struct qtnf_bus *bus)\n{\n\tif (!bus->bus_ops->preinit)\n\t\treturn 0;\n\treturn bus->bus_ops->preinit(bus);\n}\n\nstatic inline void qtnf_bus_stop(struct qtnf_bus *bus)\n{\n\tif (!bus->bus_ops->stop)\n\t\treturn;\n\tbus->bus_ops->stop(bus);\n}\n\nstatic inline int qtnf_bus_data_tx(struct qtnf_bus *bus, struct sk_buff *skb,\n\t\t\t\t   unsigned int macid, unsigned int vifid)\n{\n\treturn bus->bus_ops->data_tx(bus, skb, macid, vifid);\n}\n\nstatic inline void\nqtnf_bus_data_tx_timeout(struct qtnf_bus *bus, struct net_device *ndev)\n{\n\treturn bus->bus_ops->data_tx_timeout(bus, ndev);\n}\n\nstatic inline int qtnf_bus_control_tx(struct qtnf_bus *bus, struct sk_buff *skb)\n{\n\treturn bus->bus_ops->control_tx(bus, skb);\n}\n\nstatic inline void qtnf_bus_data_rx_start(struct qtnf_bus *bus)\n{\n\treturn bus->bus_ops->data_rx_start(bus);\n}\n\nstatic inline void qtnf_bus_data_rx_stop(struct qtnf_bus *bus)\n{\n\treturn bus->bus_ops->data_rx_stop(bus);\n}\n\nstatic __always_inline void qtnf_bus_lock(struct qtnf_bus *bus)\n{\n\tmutex_lock(&bus->bus_lock);\n}\n\nstatic __always_inline void qtnf_bus_unlock(struct qtnf_bus *bus)\n{\n\tmutex_unlock(&bus->bus_lock);\n}\n\n \n\nint qtnf_core_attach(struct qtnf_bus *bus);\nvoid qtnf_core_detach(struct qtnf_bus *bus);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}