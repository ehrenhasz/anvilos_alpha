{
  "module_name": "util.c",
  "hash_id": "647b0bbdb25681c0bc4a2ce3482b2316c45a2edca4717a2b980e5ab74ddebae4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/quantenna/qtnfmac/util.c",
  "human_readable_source": "\n \n\n#include \"util.h\"\n#include \"qtn_hw_ids.h\"\n\nvoid qtnf_sta_list_init(struct qtnf_sta_list *list)\n{\n\tif (unlikely(!list))\n\t\treturn;\n\n\tINIT_LIST_HEAD(&list->head);\n\tatomic_set(&list->size, 0);\n}\n\nstruct qtnf_sta_node *qtnf_sta_list_lookup(struct qtnf_sta_list *list,\n\t\t\t\t\t   const u8 *mac)\n{\n\tstruct qtnf_sta_node *node;\n\n\tif (unlikely(!mac))\n\t\treturn NULL;\n\n\tlist_for_each_entry(node, &list->head, list) {\n\t\tif (ether_addr_equal(node->mac_addr, mac))\n\t\t\treturn node;\n\t}\n\n\treturn NULL;\n}\n\nstruct qtnf_sta_node *qtnf_sta_list_lookup_index(struct qtnf_sta_list *list,\n\t\t\t\t\t\t size_t index)\n{\n\tstruct qtnf_sta_node *node;\n\n\tif (qtnf_sta_list_size(list) <= index)\n\t\treturn NULL;\n\n\tlist_for_each_entry(node, &list->head, list) {\n\t\tif (index-- == 0)\n\t\t\treturn node;\n\t}\n\n\treturn NULL;\n}\n\nstruct qtnf_sta_node *qtnf_sta_list_add(struct qtnf_vif *vif,\n\t\t\t\t\tconst u8 *mac)\n{\n\tstruct qtnf_sta_list *list = &vif->sta_list;\n\tstruct qtnf_sta_node *node;\n\n\tif (unlikely(!mac))\n\t\treturn NULL;\n\n\tnode = qtnf_sta_list_lookup(list, mac);\n\n\tif (node)\n\t\tgoto done;\n\n\tnode = kzalloc(sizeof(*node), GFP_KERNEL);\n\tif (unlikely(!node))\n\t\tgoto done;\n\n\tether_addr_copy(node->mac_addr, mac);\n\tlist_add_tail(&node->list, &list->head);\n\tatomic_inc(&list->size);\n\t++vif->generation;\n\ndone:\n\treturn node;\n}\n\nbool qtnf_sta_list_del(struct qtnf_vif *vif, const u8 *mac)\n{\n\tstruct qtnf_sta_list *list = &vif->sta_list;\n\tstruct qtnf_sta_node *node;\n\tbool ret = false;\n\n\tnode = qtnf_sta_list_lookup(list, mac);\n\n\tif (node) {\n\t\tlist_del(&node->list);\n\t\tatomic_dec(&list->size);\n\t\tkfree(node);\n\t\t++vif->generation;\n\t\tret = true;\n\t}\n\n\treturn ret;\n}\n\nvoid qtnf_sta_list_free(struct qtnf_sta_list *list)\n{\n\tstruct qtnf_sta_node *node, *tmp;\n\n\tatomic_set(&list->size, 0);\n\n\tlist_for_each_entry_safe(node, tmp, &list->head, list) {\n\t\tlist_del(&node->list);\n\t\tkfree(node);\n\t}\n\n\tINIT_LIST_HEAD(&list->head);\n}\n\nconst char *qtnf_chipid_to_string(unsigned long chip_id)\n{\n\tswitch (chip_id) {\n\tcase QTN_CHIP_ID_TOPAZ:\n\t\treturn \"Topaz\";\n\tcase QTN_CHIP_ID_PEARL:\n\t\treturn \"Pearl revA\";\n\tcase QTN_CHIP_ID_PEARL_B:\n\t\treturn \"Pearl revB\";\n\tcase QTN_CHIP_ID_PEARL_C:\n\t\treturn \"Pearl revC\";\n\tdefault:\n\t\treturn \"unknown\";\n\t}\n}\nEXPORT_SYMBOL_GPL(qtnf_chipid_to_string);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}