{
  "module_name": "bus.c",
  "hash_id": "34096f6d9c702701e7317005f70d6355ac8d75de73f68c1d07f1700893511338",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/broadcom/b43/bus.c",
  "human_readable_source": "\n \n\n#ifdef CONFIG_BCM47XX_BCMA\n#include <asm/mach-bcm47xx/bcm47xx.h>\n#endif\n\n#include \"b43.h\"\n#include \"bus.h\"\n\n \n#ifdef CONFIG_B43_BCMA\nstatic int b43_bus_bcma_bus_may_powerdown(struct b43_bus_dev *dev)\n{\n\treturn 0;  \n}\nstatic int b43_bus_bcma_bus_powerup(struct b43_bus_dev *dev,\n\t\t\t\t\t  bool dynamic_pctl)\n{\n\treturn 0;  \n}\nstatic int b43_bus_bcma_device_is_enabled(struct b43_bus_dev *dev)\n{\n\treturn bcma_core_is_enabled(dev->bdev);\n}\nstatic void b43_bus_bcma_device_enable(struct b43_bus_dev *dev,\n\t\t\t\t\t     u32 core_specific_flags)\n{\n\tbcma_core_enable(dev->bdev, core_specific_flags);\n}\nstatic void b43_bus_bcma_device_disable(struct b43_bus_dev *dev,\n\t\t\t\t\t      u32 core_specific_flags)\n{\n\tbcma_core_disable(dev->bdev, core_specific_flags);\n}\nstatic u16 b43_bus_bcma_read16(struct b43_bus_dev *dev, u16 offset)\n{\n\treturn bcma_read16(dev->bdev, offset);\n}\nstatic u32 b43_bus_bcma_read32(struct b43_bus_dev *dev, u16 offset)\n{\n\treturn bcma_read32(dev->bdev, offset);\n}\nstatic\nvoid b43_bus_bcma_write16(struct b43_bus_dev *dev, u16 offset, u16 value)\n{\n\tbcma_write16(dev->bdev, offset, value);\n}\nstatic\nvoid b43_bus_bcma_write32(struct b43_bus_dev *dev, u16 offset, u32 value)\n{\n\tbcma_write32(dev->bdev, offset, value);\n}\nstatic\nvoid b43_bus_bcma_block_read(struct b43_bus_dev *dev, void *buffer,\n\t\t\t     size_t count, u16 offset, u8 reg_width)\n{\n\tbcma_block_read(dev->bdev, buffer, count, offset, reg_width);\n}\nstatic\nvoid b43_bus_bcma_block_write(struct b43_bus_dev *dev, const void *buffer,\n\t\t\t      size_t count, u16 offset, u8 reg_width)\n{\n\tbcma_block_write(dev->bdev, buffer, count, offset, reg_width);\n}\n\nstruct b43_bus_dev *b43_bus_dev_bcma_init(struct bcma_device *core)\n{\n\tstruct b43_bus_dev *dev = kzalloc(sizeof(*dev), GFP_KERNEL);\n\tif (!dev)\n\t\treturn NULL;\n\n\tdev->bus_type = B43_BUS_BCMA;\n\tdev->bdev = core;\n\n\tdev->bus_may_powerdown = b43_bus_bcma_bus_may_powerdown;\n\tdev->bus_powerup = b43_bus_bcma_bus_powerup;\n\tdev->device_is_enabled = b43_bus_bcma_device_is_enabled;\n\tdev->device_enable = b43_bus_bcma_device_enable;\n\tdev->device_disable = b43_bus_bcma_device_disable;\n\n\tdev->read16 = b43_bus_bcma_read16;\n\tdev->read32 = b43_bus_bcma_read32;\n\tdev->write16 = b43_bus_bcma_write16;\n\tdev->write32 = b43_bus_bcma_write32;\n\tdev->block_read = b43_bus_bcma_block_read;\n\tdev->block_write = b43_bus_bcma_block_write;\n#ifdef CONFIG_BCM47XX_BCMA\n\tif (b43_bus_host_is_pci(dev) &&\n\t    bcm47xx_bus_type == BCM47XX_BUS_TYPE_BCMA &&\n\t    bcm47xx_bus.bcma.bus.chipinfo.id == BCMA_CHIP_ID_BCM4716)\n\t\tdev->flush_writes = true;\n#endif\n\n\tdev->dev = &core->dev;\n\tdev->dma_dev = core->dma_dev;\n\tdev->irq = core->irq;\n\n\tdev->board_vendor = core->bus->boardinfo.vendor;\n\tdev->board_type = core->bus->boardinfo.type;\n\tdev->board_rev = core->bus->sprom.board_rev;\n\n\tdev->chip_id = core->bus->chipinfo.id;\n\tdev->chip_rev = core->bus->chipinfo.rev;\n\tdev->chip_pkg = core->bus->chipinfo.pkg;\n\n\tdev->bus_sprom = &core->bus->sprom;\n\n\tdev->core_id = core->id.id;\n\tdev->core_rev = core->id.rev;\n\n\treturn dev;\n}\n#endif  \n\n \n#ifdef CONFIG_B43_SSB\nstatic int b43_bus_ssb_bus_may_powerdown(struct b43_bus_dev *dev)\n{\n\treturn ssb_bus_may_powerdown(dev->sdev->bus);\n}\nstatic int b43_bus_ssb_bus_powerup(struct b43_bus_dev *dev,\n\t\t\t\t\t  bool dynamic_pctl)\n{\n\treturn ssb_bus_powerup(dev->sdev->bus, dynamic_pctl);\n}\nstatic int b43_bus_ssb_device_is_enabled(struct b43_bus_dev *dev)\n{\n\treturn ssb_device_is_enabled(dev->sdev);\n}\nstatic void b43_bus_ssb_device_enable(struct b43_bus_dev *dev,\n\t\t\t\t\t     u32 core_specific_flags)\n{\n\tssb_device_enable(dev->sdev, core_specific_flags);\n}\nstatic void b43_bus_ssb_device_disable(struct b43_bus_dev *dev,\n\t\t\t\t\t      u32 core_specific_flags)\n{\n\tssb_device_disable(dev->sdev, core_specific_flags);\n}\n\nstatic u16 b43_bus_ssb_read16(struct b43_bus_dev *dev, u16 offset)\n{\n\treturn ssb_read16(dev->sdev, offset);\n}\nstatic u32 b43_bus_ssb_read32(struct b43_bus_dev *dev, u16 offset)\n{\n\treturn ssb_read32(dev->sdev, offset);\n}\nstatic void b43_bus_ssb_write16(struct b43_bus_dev *dev, u16 offset, u16 value)\n{\n\tssb_write16(dev->sdev, offset, value);\n}\nstatic void b43_bus_ssb_write32(struct b43_bus_dev *dev, u16 offset, u32 value)\n{\n\tssb_write32(dev->sdev, offset, value);\n}\nstatic void b43_bus_ssb_block_read(struct b43_bus_dev *dev, void *buffer,\n\t\t\t\t   size_t count, u16 offset, u8 reg_width)\n{\n\tssb_block_read(dev->sdev, buffer, count, offset, reg_width);\n}\nstatic\nvoid b43_bus_ssb_block_write(struct b43_bus_dev *dev, const void *buffer,\n\t\t\t     size_t count, u16 offset, u8 reg_width)\n{\n\tssb_block_write(dev->sdev, buffer, count, offset, reg_width);\n}\n\nstruct b43_bus_dev *b43_bus_dev_ssb_init(struct ssb_device *sdev)\n{\n\tstruct b43_bus_dev *dev;\n\n\tdev = kzalloc(sizeof(*dev), GFP_KERNEL);\n\tif (!dev)\n\t\treturn NULL;\n\n\tdev->bus_type = B43_BUS_SSB;\n\tdev->sdev = sdev;\n\n\tdev->bus_may_powerdown = b43_bus_ssb_bus_may_powerdown;\n\tdev->bus_powerup = b43_bus_ssb_bus_powerup;\n\tdev->device_is_enabled = b43_bus_ssb_device_is_enabled;\n\tdev->device_enable = b43_bus_ssb_device_enable;\n\tdev->device_disable = b43_bus_ssb_device_disable;\n\n\tdev->read16 = b43_bus_ssb_read16;\n\tdev->read32 = b43_bus_ssb_read32;\n\tdev->write16 = b43_bus_ssb_write16;\n\tdev->write32 = b43_bus_ssb_write32;\n\tdev->block_read = b43_bus_ssb_block_read;\n\tdev->block_write = b43_bus_ssb_block_write;\n\n\tdev->dev = sdev->dev;\n\tdev->dma_dev = sdev->dma_dev;\n\tdev->irq = sdev->irq;\n\n\tdev->board_vendor = sdev->bus->boardinfo.vendor;\n\tdev->board_type = sdev->bus->boardinfo.type;\n\tdev->board_rev = sdev->bus->sprom.board_rev;\n\n\tdev->chip_id = sdev->bus->chip_id;\n\tdev->chip_rev = sdev->bus->chip_rev;\n\tdev->chip_pkg = sdev->bus->chip_package;\n\n\tdev->bus_sprom = &sdev->bus->sprom;\n\n\tdev->core_id = sdev->id.coreid;\n\tdev->core_rev = sdev->id.revision;\n\n\treturn dev;\n}\n#endif  \n\nvoid *b43_bus_get_wldev(struct b43_bus_dev *dev)\n{\n\tswitch (dev->bus_type) {\n#ifdef CONFIG_B43_BCMA\n\tcase B43_BUS_BCMA:\n\t\treturn bcma_get_drvdata(dev->bdev);\n#endif\n#ifdef CONFIG_B43_SSB\n\tcase B43_BUS_SSB:\n\t\treturn ssb_get_drvdata(dev->sdev);\n#endif\n\t}\n\treturn NULL;\n}\n\nvoid b43_bus_set_wldev(struct b43_bus_dev *dev, void *wldev)\n{\n\tswitch (dev->bus_type) {\n#ifdef CONFIG_B43_BCMA\n\tcase B43_BUS_BCMA:\n\t\tbcma_set_drvdata(dev->bdev, wldev);\n\t\tbreak;\n#endif\n#ifdef CONFIG_B43_SSB\n\tcase B43_BUS_SSB:\n\t\tssb_set_drvdata(dev->sdev, wldev);\n\t\tbreak;\n#endif\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}