{
  "module_name": "rate.h",
  "hash_id": "9102ec1c1e7f619968212de68d73faa4e800ae9c4b068aaeaf76133e361d7bf0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/broadcom/brcm80211/brcmsmac/rate.h",
  "human_readable_source": " \n\n#ifndef _BRCM_RATE_H_\n#define _BRCM_RATE_H_\n\n#include \"types.h\"\n#include \"d11.h\"\n#include \"phy_hal.h\"\n\nextern const u8 rate_info[];\nextern const struct brcms_c_rateset cck_ofdm_mimo_rates;\nextern const struct brcms_c_rateset ofdm_mimo_rates;\nextern const struct brcms_c_rateset cck_ofdm_rates;\nextern const struct brcms_c_rateset ofdm_rates;\nextern const struct brcms_c_rateset cck_rates;\nextern const struct brcms_c_rateset gphy_legacy_rates;\nextern const struct brcms_c_rateset rate_limit_1_2;\n\nstruct brcms_mcs_info {\n\t \n\tu32 phy_rate_20;\n\t \n\tu32 phy_rate_40;\n\t \n\tu32 phy_rate_20_sgi;\n\t \n\tu32 phy_rate_40_sgi;\n\t \n\tu8 tx_phy_ctl3;\n\t \n\tu8 leg_ofdm;\n};\n\n#define BRCMS_MAXMCS\t32\t \n#define MCS_TABLE_SIZE\t33\t \nextern const struct brcms_mcs_info mcs_table[];\n\n#define MCS_TXS_MASK\t0xc0\t \n#define MCS_TXS_SHIFT\t6\t \n\n \nstatic inline u8 mcs_2_txstreams(u8 mcs)\n{\n\treturn (mcs_table[mcs].tx_phy_ctl3 & MCS_TXS_MASK) >> MCS_TXS_SHIFT;\n}\n\nstatic inline uint mcs_2_rate(u8 mcs, bool is40, bool sgi)\n{\n\tif (sgi) {\n\t\tif (is40)\n\t\t\treturn mcs_table[mcs].phy_rate_40_sgi;\n\t\treturn mcs_table[mcs].phy_rate_20_sgi;\n\t}\n\tif (is40)\n\t\treturn mcs_table[mcs].phy_rate_40;\n\n\treturn mcs_table[mcs].phy_rate_20;\n}\n\n \n#define\tBRCMS_RATE_MASK_FULL 0xff  \n\n \n\n \n\n \n#define RSPEC_RATE_MASK\t\t0x0000007F\n \n#define RSPEC_MIMORATE\t\t0x08000000\n \n#define RSPEC_BW_MASK\t\t0x00000700\n \n#define RSPEC_BW_SHIFT\t\t8\n \n#define RSPEC_STF_MASK\t\t0x00003800\n \n#define RSPEC_STF_SHIFT\t\t11\n \n#define RSPEC_CT_MASK\t\t0x0000C000\n \n#define RSPEC_CT_SHIFT\t\t14\n \n#define RSPEC_STC_MASK\t\t0x00300000\n \n#define RSPEC_STC_SHIFT\t\t20\n \n#define RSPEC_LDPC_CODING\t0x00400000\n \n#define RSPEC_SHORT_GI\t\t0x00800000\n \n#define RSPEC_OVERRIDE\t\t0x80000000\n \n#define RSPEC_OVERRIDE_MCS_ONLY 0x40000000\n\nstatic inline bool rspec_active(u32 rspec)\n{\n\treturn rspec & (RSPEC_RATE_MASK | RSPEC_MIMORATE);\n}\n\nstatic inline u8 rspec_phytxbyte2(u32 rspec)\n{\n\treturn (rspec & 0xff00) >> 8;\n}\n\nstatic inline u32 rspec_get_bw(u32 rspec)\n{\n\treturn (rspec & RSPEC_BW_MASK) >> RSPEC_BW_SHIFT;\n}\n\nstatic inline bool rspec_issgi(u32 rspec)\n{\n\treturn (rspec & RSPEC_SHORT_GI) == RSPEC_SHORT_GI;\n}\n\nstatic inline bool rspec_is40mhz(u32 rspec)\n{\n\tu32 bw = rspec_get_bw(rspec);\n\n\treturn bw == PHY_TXC1_BW_40MHZ || bw == PHY_TXC1_BW_40MHZ_DUP;\n}\n\nstatic inline uint rspec2rate(u32 rspec)\n{\n\tif (rspec & RSPEC_MIMORATE)\n\t\treturn mcs_2_rate(rspec & RSPEC_RATE_MASK, rspec_is40mhz(rspec),\n\t\t\t\t  rspec_issgi(rspec));\n\treturn rspec & RSPEC_RATE_MASK;\n}\n\nstatic inline u8 rspec_mimoplcp3(u32 rspec)\n{\n\treturn (rspec & 0xf00000) >> 16;\n}\n\nstatic inline bool plcp3_issgi(u8 plcp)\n{\n\treturn (plcp & (RSPEC_SHORT_GI >> 16)) != 0;\n}\n\nstatic inline uint rspec_stc(u32 rspec)\n{\n\treturn (rspec & RSPEC_STC_MASK) >> RSPEC_STC_SHIFT;\n}\n\nstatic inline uint rspec_stf(u32 rspec)\n{\n\treturn (rspec & RSPEC_STF_MASK) >> RSPEC_STF_SHIFT;\n}\n\nstatic inline bool is_mcs_rate(u32 ratespec)\n{\n\treturn (ratespec & RSPEC_MIMORATE) != 0;\n}\n\nstatic inline bool is_ofdm_rate(u32 ratespec)\n{\n\treturn !is_mcs_rate(ratespec) &&\n\t       (rate_info[ratespec & RSPEC_RATE_MASK] & BRCMS_RATE_FLAG);\n}\n\nstatic inline bool is_cck_rate(u32 ratespec)\n{\n\tu32 rate = (ratespec & BRCMS_RATE_MASK);\n\n\treturn !is_mcs_rate(ratespec) && (\n\t\t\trate == BRCM_RATE_1M || rate == BRCM_RATE_2M ||\n\t\t\trate == BRCM_RATE_5M5 || rate == BRCM_RATE_11M);\n}\n\nstatic inline bool is_single_stream(u8 mcs)\n{\n\treturn mcs <= HIGHEST_SINGLE_STREAM_MCS || mcs == 32;\n}\n\nstatic inline u8 cck_rspec(u8 cck)\n{\n\treturn cck & RSPEC_RATE_MASK;\n}\n\n \nstatic inline u8 ofdm_phy2mac_rate(u8 rlpt)\n{\n\treturn wlc_phy_get_ofdm_rate_lookup()[rlpt & 0x7];\n}\n\nstatic inline u8 cck_phy2mac_rate(u8 signal)\n{\n\treturn signal/5;\n}\n\n \n#define BRCMS_RATES_CCK_OFDM\t0\n#define BRCMS_RATES_CCK\t\t1\n#define BRCMS_RATES_OFDM\t\t2\n\n \nbool brcms_c_rate_hwrs_filter_sort_validate(struct brcms_c_rateset *rs,\n\t\t\t\t\t    const struct brcms_c_rateset *hw_rs,\n\t\t\t\t\t    bool check_brate, u8 txstreams);\n \nvoid brcms_c_rateset_copy(const struct brcms_c_rateset *src,\n\t\t\t  struct brcms_c_rateset *dst);\n\n \nu32 brcms_c_compute_rspec(struct d11rxhdr *rxh, u8 *plcp);\n\nvoid brcms_c_rateset_filter(struct brcms_c_rateset *src,\n\t\t\t    struct brcms_c_rateset *dst, bool basic_only,\n\t\t\t    u8 rates, uint xmask, bool mcsallow);\n\nvoid brcms_c_rateset_default(struct brcms_c_rateset *rs_tgt,\n\t\t\t     const struct brcms_c_rateset *rs_hw, uint phy_type,\n\t\t\t     int bandtype, bool cck_only, uint rate_mask,\n\t\t\t     bool mcsallow, u8 bw, u8 txstreams);\n\ns16 brcms_c_rate_legacy_phyctl(uint rate);\n\nvoid brcms_c_rateset_mcs_upd(struct brcms_c_rateset *rs, u8 txstreams);\nvoid brcms_c_rateset_mcs_clear(struct brcms_c_rateset *rateset);\nvoid brcms_c_rateset_mcs_build(struct brcms_c_rateset *rateset, u8 txstreams);\nvoid brcms_c_rateset_bw_mcs_filter(struct brcms_c_rateset *rateset, u8 bw);\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}