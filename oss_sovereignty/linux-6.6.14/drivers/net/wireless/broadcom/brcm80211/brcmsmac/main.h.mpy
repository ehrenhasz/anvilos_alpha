{
  "module_name": "main.h",
  "hash_id": "e9ba67b939ead4223bb116ab60043f0b800cc4da5d77c74967e3faed1b489755",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/broadcom/brcm80211/brcmsmac/main.h",
  "human_readable_source": " \n\n#ifndef _BRCM_MAIN_H_\n#define _BRCM_MAIN_H_\n\n#include <linux/etherdevice.h>\n\n#include <brcmu_utils.h>\n#include \"types.h\"\n#include \"d11.h\"\n#include \"scb.h\"\n\n#define\tINVCHANNEL\t\t255\t \n\n \n#define BRCMS_MAXMODULES\t22\n\n#define SEQNUM_SHIFT\t\t4\n#define SEQNUM_MAX\t\t0x1000\n\n#define NTXRATE\t\t\t64\t \n\n \n \n#define\tBRCMS_MAX_MAC_SUSPEND\t83000\n\n \n#define BRCMS_PRB_RESP_TIMEOUT\t0\t \n\n \n#define TXOFF (D11_TXH_LEN + D11_PHY_HDR_LEN)\n\n \n#define BITFIELD_MASK(width) \\\n\t\t(((unsigned)1 << (width)) - 1)\n#define GFIELD(val, field) \\\n\t\t(((val) >> field ## _S) & field ## _M)\n#define SFIELD(val, field, bits) \\\n\t\t(((val) & (~(field ## _M << field ## _S))) | \\\n\t\t ((unsigned)(bits) << field ## _S))\n\n#define\tSW_TIMER_MAC_STAT_UPD\t\t30\t \n\n \n#define\tMAXCOREREV\t\t28\n\n \n#if CONF_MSK(D11CONF, 0x4f) || CONF_GE(D11CONF, MAXCOREREV)\n#error \"Configuration for D11CONF includes unsupported versions.\"\n#endif\t\t\t\t \n\n \n#define BRCMS_SHORTSLOT_AUTO\t-1  \n#define BRCMS_SHORTSLOT_OFF\t0   \n#define BRCMS_SHORTSLOT_ON\t1   \n\n \n#define BRCMS_LONG_PREAMBLE\t(0)\n#define BRCMS_SHORT_PREAMBLE\t(1 << 0)\n#define BRCMS_GF_PREAMBLE\t\t(1 << 1)\n#define BRCMS_MM_PREAMBLE\t\t(1 << 2)\n#define BRCMS_IS_MIMO_PREAMBLE(_pre) (((_pre) == BRCMS_GF_PREAMBLE) || \\\n\t\t\t\t      ((_pre) == BRCMS_MM_PREAMBLE))\n\n \n \n \n#define TXFID_QUEUE_MASK\t0x0007\t \n#define TXFID_SEQ_MASK\t\t0x7FE0\t \n#define TXFID_SEQ_SHIFT\t\t5\t \n#define\tTXFID_RATE_PROBE_MASK\t0x8000\t \n#define TXFID_RATE_MASK\t\t0x0018\t \n#define TXFID_RATE_SHIFT\t3\t \n\n \n#define BOARDREV_PROMOTABLE\t0xFF\t \n#define BOARDREV_PROMOTED\t1\t \n\n#define DATA_BLOCK_TX_SUPR\t(1 << 4)\n\n \n#define BRCMS_WAKE_OVERRIDE_CLKCTL\t0x01\n#define BRCMS_WAKE_OVERRIDE_PHYREG\t0x02\n#define BRCMS_WAKE_OVERRIDE_MACSUSPEND\t0x04\n#define BRCMS_WAKE_OVERRIDE_TXFIFO\t0x08\n#define BRCMS_WAKE_OVERRIDE_FORCEFAST\t0x10\n\n \n\n \n#define\tI_ERRORS\t(I_PC | I_PD | I_DE | I_RO | I_XU)\n \n#define\tDEF_RXINTMASK\t(I_RI)\t \n#define\tDEF_MACINTMASK\t(MI_TXSTOP | MI_TBTT | MI_ATIMWINEND | MI_PMQ | \\\n\t\t\t MI_PHYTXERR | MI_DMAINT | MI_TFS | MI_BG_NOISE | \\\n\t\t\t MI_CCA | MI_TO | MI_GP0 | MI_RFDISABLE | MI_PWRUP)\n\n#define\tMAXTXPKTS\t\t6\t \n\n \n#define\tMAXTXFRAMEBURST\t\t8  \n#define\tMAXFRAMEBURST_TXOP\t10000\t \n\n#define\tNFIFO\t\t\t6\t \n\n \n\n \n#define BRCMS_PLLREQ_SHARED\t0x1\n \n#define BRCMS_PLLREQ_RADIO_MON\t0x2\n \n#define BRCMS_PLLREQ_FLIP\t\t0x4\n\n#define\tCHANNEL_BANDUNIT(wlc, ch) \\\n\t(((ch) <= CH_MAX_2G_CHANNEL) ? BAND_2G_INDEX : BAND_5G_INDEX)\n\n#define\tOTHERBANDUNIT(wlc) \\\n\t((uint)((wlc)->band->bandunit ? BAND_2G_INDEX : BAND_5G_INDEX))\n\n \nstruct brcms_protection {\n\tbool _g;\n\ts8 g_override;\n\tu8 gmode_user;\n\ts8 overlap;\n\ts8 nmode_user;\n\ts8 n_cfg;\n\ts8 n_cfg_override;\n\tbool nongf;\n\ts8 nongf_override;\n\ts8 n_pam_override;\n\tbool n_obss;\n};\n\n \nstruct brcms_stf {\n\tu8 hw_txchain;\n\tu8 txchain;\n\tu8 txstreams;\n\tu8 hw_rxchain;\n\tu8 rxchain;\n\tu8 rxstreams;\n\tu8 ant_rx_ovr;\n\ts8 txant;\n\tu16 phytxant;\n\tu8 ss_opmode;\n\tbool ss_algosel_auto;\n\tu16 ss_algo_channel;\n\tu8 rxchain_restore_delay;\n\ts8 ldpc;\n\tu8 txcore[MAX_STREAMS_SUPPORTED + 1];\n\ts8 spatial_policy;\n};\n\n#define BRCMS_STF_SS_STBC_TX(wlc, scb) \\\n\t(((wlc)->stf->txstreams > 1) && (((wlc)->band->band_stf_stbc_tx == ON) \\\n\t || (((scb)->flags & SCB_STBCCAP) && \\\n\t     (wlc)->band->band_stf_stbc_tx == AUTO && \\\n\t     isset(&((wlc)->stf->ss_algo_channel), PHY_TXC1_MODE_STBC))))\n\n#define BRCMS_STBC_CAP_PHY(wlc) (BRCMS_ISNPHY(wlc->band) && \\\n\t\t\t\t NREV_GE(wlc->band->phyrev, 3))\n\n#define BRCMS_SGI_CAP_PHY(wlc) ((BRCMS_ISNPHY(wlc->band) && \\\n\t\t\t\t NREV_GE(wlc->band->phyrev, 3)) || \\\n\t\t\t\tBRCMS_ISLCNPHY(wlc->band))\n\n#define BRCMS_CHAN_PHYTYPE(x)     (((x) & RXS_CHAN_PHYTYPE_MASK) \\\n\t\t\t\t   >> RXS_CHAN_PHYTYPE_SHIFT)\n#define BRCMS_CHAN_CHANNEL(x)     (((x) & RXS_CHAN_ID_MASK) \\\n\t\t\t\t   >> RXS_CHAN_ID_SHIFT)\n\n \nstruct brcms_core {\n\tuint coreidx;\t\t \n\n\t \n\tuint *txavail[NFIFO];\t \n\n\tstruct macstat *macstat_snapshot;\t \n};\n\n \nstruct brcms_band {\n\tint bandtype;\t\t \n\tuint bandunit;\t\t \n\n\tu16 phytype;\t\t \n\tu16 phyrev;\n\tu16 radioid;\n\tu16 radiorev;\n\tstruct brcms_phy_pub *pi;  \n\tbool abgphy_encore;\n\n\tu8 gmode;\t\t \n\n\tstruct scb *hwrs_scb;\t \n\n\t \n\tstruct brcms_c_rateset defrateset;\n\n\tu8 band_stf_ss_mode;\t \n\ts8 band_stf_stbc_tx;\t \n\t \n\tstruct brcms_c_rateset hw_rateset;\n\tu8 basic_rate[BRCM_MAXRATE + 1];  \n\tbool mimo_cap_40;\t \n\ts8 antgain;\t\t \n\n\tu16 CWmin;  \n\tu16 CWmax;  \n\tstruct ieee80211_supported_band band;\n};\n\n \nstruct modulecb {\n\t \n\tchar name[32];\n\t \n\tstruct brcms_info *hdl;\n\n\tint (*down_fn)(void *handle);  \n\n};\n\nstruct brcms_hw_band {\n\tint bandtype;\t\t \n\tuint bandunit;\t\t \n\tu16 mhfs[MHFMAX];\t \n\tu8 bandhw_stf_ss_mode;\t \n\tu16 CWmin;\n\tu16 CWmax;\n\tu32 core_flags;\n\n\tu16 phytype;\t\t \n\tu16 phyrev;\n\tu16 radioid;\n\tu16 radiorev;\n\tstruct brcms_phy_pub *pi;  \n\tbool abgphy_encore;\n};\n\nstruct brcms_hardware {\n\tbool _piomode;\t\t \n\tstruct brcms_c_info *wlc;\n\n\t \n\tstruct dma_pub *di[NFIFO];\t \n\n\tuint unit;\t\t \n\n\t \n\tu16 vendorid;\t \n\tu16 deviceid;\t \n\tuint corerev;\t\t \n\tu8 sromrev;\t\t \n\tu16 boardrev;\t \n\tu32 boardflags;\t \n\tu32 boardflags2;\t \n\tu32 machwcap;\t \n\tu32 machwcap_backup;\t \n\n\tstruct si_pub *sih;\t \n\tstruct bcma_device *d11core;\t \n\tstruct phy_shim_info *physhim;  \n\tstruct shared_phy *phy_sh;\t \n\tstruct brcms_hw_band *band; \n\t \n\tstruct brcms_hw_band *bandstate[MAXBANDS];\n\tu16 bmac_phytxant;\t \n\tbool shortslot;\t\t \n\tu16 SRL;\t\t \n\tu16 LRL;\t\t \n\tu16 SFBL;\t\t \n\tu16 LFBL;\t\t \n\n\tbool up;\t\t \n\tuint now;\t\t \n\tuint _nbands;\t\t \n\tu16 chanspec;\t \n\n\tuint *txavail[NFIFO];\t \n\tconst u16 *xmtfifo_sz;\t \n\n\tu32 pllreq;\t\t \n\n\tu8 suspended_fifos;\t \n\tu32 maccontrol;\t \n\tuint mac_suspend_depth;\t \n\tu32 wake_override;\t \n\tu32 mute_override;\t \n\tu8 etheraddr[ETH_ALEN];\t \n\tbool noreset;\t\t \n\tbool forcefastclk;\t \n\tbool clk;\t\t \n\tbool sbclk;\t\t \n\tbool phyclk;\t\t \n\n\tbool ucode_loaded;\t \n\n\n\tu8 hw_stf_ss_opmode;\t \n\tu8 antsel_type;\t \n\tu32 antsel_avail;\t \n};\n\n \nstruct brcms_c_info {\n\tstruct brcms_pub *pub;\n\tstruct brcms_info *wl;\n\tstruct brcms_hardware *hw;\n\n\t \n\tu16 fastpwrup_dly;\n\n\t \n\tu32 macintstatus;\n\tu32 macintmask;\n\tu32 defmacintmask;\n\n\tbool clk;\n\n\t \n\tstruct brcms_core *core;\n\tstruct brcms_band *band;\n\tstruct brcms_core *corestate;\n\tstruct brcms_band *bandstate[MAXBANDS];\n\n\t \n\tuint qvalid;\n\n\tstruct ampdu_info *ampdu;\n\tstruct antsel_info *asi;\n\tstruct brcms_cm_info *cmi;\n\n\tu16 vendorid;\n\tu16 deviceid;\n\tuint ucode_rev;\n\n\tu8 perm_etheraddr[ETH_ALEN];\n\n\tbool bandlocked;\n\tbool bandinit_pending;\n\n\tbool radio_monitor;\n\tbool going_down;\n\n\tbool beacon_template_virgin;\n\n\tstruct brcms_timer *wdtimer;\n\tstruct brcms_timer *radio_timer;\n\n\t \n\tuint filter_flags;\n\n\t \n\tbool _rifs;\n\n\t \n\tu8 bcn_li_bcn;\n\tu8 bcn_li_dtim;\n\n\tbool WDarmed;\n\tu32 WDlast;\n\n\t \n\tu16 edcf_txop[IEEE80211_NUM_ACS];\n\n\tu16 wme_retries[IEEE80211_NUM_ACS];\n\n\tstruct brcms_bss_cfg *bsscfg;\n\n\tstruct modulecb *modulecb;\n\n\tu8 mimoft;\n\ts8 cck_40txbw;\n\ts8 ofdm_40txbw;\n\ts8 mimo_40txbw;\n\n\tstruct brcms_bss_info *default_bss;\n\n\tu16 mc_fid_counter;\n\n\tchar country_default[BRCM_CNTRY_BUF_SZ];\n\tchar autocountry_default[BRCM_CNTRY_BUF_SZ];\n\tu16 prb_resp_timeout;\n\n\tu16 home_chanspec;\n\n\t \n\tu16 chanspec;\n\tu16 usr_fragthresh;\n\tu16 fragthresh[NFIFO];\n\tu16 RTSThresh;\n\tu16 SRL;\n\tu16 LRL;\n\tu16 SFBL;\n\tu16 LFBL;\n\n\t \n\tbool shortslot;\n\ts8 shortslot_override;\n\tbool include_legacy_erp;\n\n\tstruct brcms_protection *protection;\n\ts8 PLCPHdr_override;\n\n\tstruct brcms_stf *stf;\n\n\tu32 bcn_rspec;\n\n\tuint tempsense_lasttime;\n\n\tu16 tx_duty_cycle_ofdm;\n\tu16 tx_duty_cycle_cck;\n\n\tstruct wiphy *wiphy;\n\tstruct scb pri_scb;\n\tstruct ieee80211_vif *vif;\n\n\tstruct sk_buff *beacon;\n\tu16 beacon_tim_offset;\n\tu16 beacon_dtim_period;\n\tstruct sk_buff *probe_resp;\n};\n\n \nstruct antsel_info {\n\tstruct brcms_c_info *wlc;\t \n\tstruct brcms_pub *pub;\t\t \n\tu8 antsel_type;\t \n\tu8 antsel_antswitch;\t \n\tbool antsel_avail;\t \n\tstruct brcms_antselcfg antcfg_11n;  \n\tstruct brcms_antselcfg antcfg_cur;  \n};\n\nenum brcms_bss_type {\n\tBRCMS_TYPE_STATION,\n\tBRCMS_TYPE_AP,\n\tBRCMS_TYPE_ADHOC,\n};\n\n \nstruct brcms_bss_cfg {\n\tstruct brcms_c_info *wlc;\n\tenum brcms_bss_type type;\n\tu8 SSID_len;\n\tu8 SSID[IEEE80211_MAX_SSID_LEN];\n\tu8 BSSID[ETH_ALEN];\n\tstruct brcms_bss_info *current_bss;\n};\n\nint brcms_c_txfifo(struct brcms_c_info *wlc, uint fifo, struct sk_buff *p);\nint brcms_b_xmtfifo_sz_get(struct brcms_hardware *wlc_hw, uint fifo,\n\t\t\t   uint *blocks);\n\nint brcms_c_set_gmode(struct brcms_c_info *wlc, u8 gmode, bool config);\nvoid brcms_c_mac_promisc(struct brcms_c_info *wlc, uint filter_flags);\nu16 brcms_c_calc_lsig_len(struct brcms_c_info *wlc, u32 ratespec, uint mac_len);\nu32 brcms_c_rspec_to_rts_rspec(struct brcms_c_info *wlc, u32 rspec,\n\t\t\t       bool use_rspec, u16 mimo_ctlchbw);\nu16 brcms_c_compute_rtscts_dur(struct brcms_c_info *wlc, bool cts_only,\n\t\t\t       u32 rts_rate, u32 frame_rate,\n\t\t\t       u8 rts_preamble_type, u8 frame_preamble_type,\n\t\t\t       uint frame_len, bool ba);\nvoid brcms_c_inval_dma_pkts(struct brcms_hardware *hw,\n\t\t\t    struct ieee80211_sta *sta, void (*dma_callback_fn));\nvoid brcms_c_update_probe_resp(struct brcms_c_info *wlc, bool suspend);\nint brcms_c_set_nmode(struct brcms_c_info *wlc);\nvoid brcms_c_beacon_phytxctl_txant_upd(struct brcms_c_info *wlc, u32 bcn_rate);\nvoid brcms_b_antsel_type_set(struct brcms_hardware *wlc_hw, u8 antsel_type);\nvoid brcms_b_set_chanspec(struct brcms_hardware *wlc_hw, u16 chanspec,\n\t\t\t  bool mute, struct txpwr_limits *txpwr);\nvoid brcms_b_write_shm(struct brcms_hardware *wlc_hw, uint offset, u16 v);\nu16 brcms_b_read_shm(struct brcms_hardware *wlc_hw, uint offset);\nvoid brcms_b_mhf(struct brcms_hardware *wlc_hw, u8 idx, u16 mask, u16 val,\n\t\t int bands);\nvoid brcms_b_corereset(struct brcms_hardware *wlc_hw, u32 flags);\nvoid brcms_b_mctrl(struct brcms_hardware *wlc_hw, u32 mask, u32 val);\nvoid brcms_b_phy_reset(struct brcms_hardware *wlc_hw);\nvoid brcms_b_bw_set(struct brcms_hardware *wlc_hw, u16 bw);\nvoid brcms_b_core_phypll_reset(struct brcms_hardware *wlc_hw);\nvoid brcms_c_ucode_wake_override_set(struct brcms_hardware *wlc_hw,\n\t\t\t\t     u32 override_bit);\nvoid brcms_c_ucode_wake_override_clear(struct brcms_hardware *wlc_hw,\n\t\t\t\t       u32 override_bit);\nvoid brcms_b_write_template_ram(struct brcms_hardware *wlc_hw, int offset,\n\t\t\t\tint len, void *buf);\nu16 brcms_b_rate_shm_offset(struct brcms_hardware *wlc_hw, u8 rate);\nvoid brcms_b_copyto_objmem(struct brcms_hardware *wlc_hw, uint offset,\n\t\t\t   const void *buf, int len, u32 sel);\nvoid brcms_b_copyfrom_objmem(struct brcms_hardware *wlc_hw, uint offset,\n\t\t\t     void *buf, int len, u32 sel);\nvoid brcms_b_switch_macfreq(struct brcms_hardware *wlc_hw, u8 spurmode);\nu16 brcms_b_get_txant(struct brcms_hardware *wlc_hw);\nvoid brcms_b_phyclk_fgc(struct brcms_hardware *wlc_hw, bool clk);\nvoid brcms_b_macphyclk_set(struct brcms_hardware *wlc_hw, bool clk);\nvoid brcms_b_core_phypll_ctl(struct brcms_hardware *wlc_hw, bool on);\nvoid brcms_b_txant_set(struct brcms_hardware *wlc_hw, u16 phytxant);\nvoid brcms_b_band_stf_ss_set(struct brcms_hardware *wlc_hw, u8 stf_mode);\nvoid brcms_c_init_scb(struct scb *scb);\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}