{
  "module_name": "fweh.h",
  "hash_id": "82709202a28688473d17c39fd42c811773ec8cdca079d2b041281a2109b603ec",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/broadcom/brcm80211/brcmfmac/fweh.h",
  "human_readable_source": "\n \n\n\n#ifndef FWEH_H_\n#define FWEH_H_\n\n#include <asm/unaligned.h>\n#include <linux/skbuff.h>\n#include <linux/if_ether.h>\n#include <linux/if.h>\n\n \nstruct brcmf_pub;\nstruct brcmf_if;\nstruct brcmf_cfg80211_info;\n\n \n#define BRCMF_FWEH_EVENT_ENUM_DEFLIST \\\n\tBRCMF_ENUM_DEF(SET_SSID, 0) \\\n\tBRCMF_ENUM_DEF(JOIN, 1) \\\n\tBRCMF_ENUM_DEF(START, 2) \\\n\tBRCMF_ENUM_DEF(AUTH, 3) \\\n\tBRCMF_ENUM_DEF(AUTH_IND, 4) \\\n\tBRCMF_ENUM_DEF(DEAUTH, 5) \\\n\tBRCMF_ENUM_DEF(DEAUTH_IND, 6) \\\n\tBRCMF_ENUM_DEF(ASSOC, 7) \\\n\tBRCMF_ENUM_DEF(ASSOC_IND, 8) \\\n\tBRCMF_ENUM_DEF(REASSOC, 9) \\\n\tBRCMF_ENUM_DEF(REASSOC_IND, 10) \\\n\tBRCMF_ENUM_DEF(DISASSOC, 11) \\\n\tBRCMF_ENUM_DEF(DISASSOC_IND, 12) \\\n\tBRCMF_ENUM_DEF(QUIET_START, 13) \\\n\tBRCMF_ENUM_DEF(QUIET_END, 14) \\\n\tBRCMF_ENUM_DEF(BEACON_RX, 15) \\\n\tBRCMF_ENUM_DEF(LINK, 16) \\\n\tBRCMF_ENUM_DEF(MIC_ERROR, 17) \\\n\tBRCMF_ENUM_DEF(NDIS_LINK, 18) \\\n\tBRCMF_ENUM_DEF(ROAM, 19) \\\n\tBRCMF_ENUM_DEF(TXFAIL, 20) \\\n\tBRCMF_ENUM_DEF(PMKID_CACHE, 21) \\\n\tBRCMF_ENUM_DEF(RETROGRADE_TSF, 22) \\\n\tBRCMF_ENUM_DEF(PRUNE, 23) \\\n\tBRCMF_ENUM_DEF(AUTOAUTH, 24) \\\n\tBRCMF_ENUM_DEF(EAPOL_MSG, 25) \\\n\tBRCMF_ENUM_DEF(SCAN_COMPLETE, 26) \\\n\tBRCMF_ENUM_DEF(ADDTS_IND, 27) \\\n\tBRCMF_ENUM_DEF(DELTS_IND, 28) \\\n\tBRCMF_ENUM_DEF(BCNSENT_IND, 29) \\\n\tBRCMF_ENUM_DEF(BCNRX_MSG, 30) \\\n\tBRCMF_ENUM_DEF(BCNLOST_MSG, 31) \\\n\tBRCMF_ENUM_DEF(ROAM_PREP, 32) \\\n\tBRCMF_ENUM_DEF(PFN_NET_FOUND, 33) \\\n\tBRCMF_ENUM_DEF(PFN_NET_LOST, 34) \\\n\tBRCMF_ENUM_DEF(RESET_COMPLETE, 35) \\\n\tBRCMF_ENUM_DEF(JOIN_START, 36) \\\n\tBRCMF_ENUM_DEF(ROAM_START, 37) \\\n\tBRCMF_ENUM_DEF(ASSOC_START, 38) \\\n\tBRCMF_ENUM_DEF(IBSS_ASSOC, 39) \\\n\tBRCMF_ENUM_DEF(RADIO, 40) \\\n\tBRCMF_ENUM_DEF(PSM_WATCHDOG, 41) \\\n\tBRCMF_ENUM_DEF(PROBREQ_MSG, 44) \\\n\tBRCMF_ENUM_DEF(SCAN_CONFIRM_IND, 45) \\\n\tBRCMF_ENUM_DEF(PSK_SUP, 46) \\\n\tBRCMF_ENUM_DEF(COUNTRY_CODE_CHANGED, 47) \\\n\tBRCMF_ENUM_DEF(EXCEEDED_MEDIUM_TIME, 48) \\\n\tBRCMF_ENUM_DEF(ICV_ERROR, 49) \\\n\tBRCMF_ENUM_DEF(UNICAST_DECODE_ERROR, 50) \\\n\tBRCMF_ENUM_DEF(MULTICAST_DECODE_ERROR, 51) \\\n\tBRCMF_ENUM_DEF(TRACE, 52) \\\n\tBRCMF_ENUM_DEF(IF, 54) \\\n\tBRCMF_ENUM_DEF(P2P_DISC_LISTEN_COMPLETE, 55) \\\n\tBRCMF_ENUM_DEF(RSSI, 56) \\\n\tBRCMF_ENUM_DEF(EXTLOG_MSG, 58) \\\n\tBRCMF_ENUM_DEF(ACTION_FRAME, 59) \\\n\tBRCMF_ENUM_DEF(ACTION_FRAME_COMPLETE, 60) \\\n\tBRCMF_ENUM_DEF(PRE_ASSOC_IND, 61) \\\n\tBRCMF_ENUM_DEF(PRE_REASSOC_IND, 62) \\\n\tBRCMF_ENUM_DEF(CHANNEL_ADOPTED, 63) \\\n\tBRCMF_ENUM_DEF(AP_STARTED, 64) \\\n\tBRCMF_ENUM_DEF(DFS_AP_STOP, 65) \\\n\tBRCMF_ENUM_DEF(DFS_AP_RESUME, 66) \\\n\tBRCMF_ENUM_DEF(ESCAN_RESULT, 69) \\\n\tBRCMF_ENUM_DEF(ACTION_FRAME_OFF_CHAN_COMPLETE, 70) \\\n\tBRCMF_ENUM_DEF(PROBERESP_MSG, 71) \\\n\tBRCMF_ENUM_DEF(P2P_PROBEREQ_MSG, 72) \\\n\tBRCMF_ENUM_DEF(DCS_REQUEST, 73) \\\n\tBRCMF_ENUM_DEF(FIFO_CREDIT_MAP, 74) \\\n\tBRCMF_ENUM_DEF(ACTION_FRAME_RX, 75) \\\n\tBRCMF_ENUM_DEF(TDLS_PEER_EVENT, 92) \\\n\tBRCMF_ENUM_DEF(BCMC_CREDIT_SUPPORT, 127)\n\n#define BRCMF_ENUM_DEF(id, val) \\\n\tBRCMF_E_##id = (val),\n\n \nenum brcmf_fweh_event_code {\n\tBRCMF_FWEH_EVENT_ENUM_DEFLIST\n\t \n\tBRCMF_E_LAST = 139\n};\n#undef BRCMF_ENUM_DEF\n\n#define BRCMF_EVENTING_MASK_LEN\t\tDIV_ROUND_UP(BRCMF_E_LAST, 8)\n\n \n#define BRCMF_EVENT_MSG_LINK\t\t0x01\n#define BRCMF_EVENT_MSG_FLUSHTXQ\t0x02\n#define BRCMF_EVENT_MSG_GROUP\t\t0x04\n\n \n#define BRCMF_E_STATUS_SUCCESS\t\t\t0\n#define BRCMF_E_STATUS_FAIL\t\t\t1\n#define BRCMF_E_STATUS_TIMEOUT\t\t\t2\n#define BRCMF_E_STATUS_NO_NETWORKS\t\t3\n#define BRCMF_E_STATUS_ABORT\t\t\t4\n#define BRCMF_E_STATUS_NO_ACK\t\t\t5\n#define BRCMF_E_STATUS_UNSOLICITED\t\t6\n#define BRCMF_E_STATUS_ATTEMPT\t\t\t7\n#define BRCMF_E_STATUS_PARTIAL\t\t\t8\n#define BRCMF_E_STATUS_NEWSCAN\t\t\t9\n#define BRCMF_E_STATUS_NEWASSOC\t\t\t10\n#define BRCMF_E_STATUS_11HQUIET\t\t\t11\n#define BRCMF_E_STATUS_SUPPRESS\t\t\t12\n#define BRCMF_E_STATUS_NOCHANS\t\t\t13\n#define BRCMF_E_STATUS_CS_ABORT\t\t\t15\n#define BRCMF_E_STATUS_ERROR\t\t\t16\n\n \n#define BRCMF_E_STATUS_FWSUP_WAIT_M1\t\t4\n#define BRCMF_E_STATUS_FWSUP_PREP_M2\t\t5\n#define BRCMF_E_STATUS_FWSUP_COMPLETED\t\t6\n#define BRCMF_E_STATUS_FWSUP_TIMEOUT\t\t7\n#define BRCMF_E_STATUS_FWSUP_WAIT_M3\t\t8\n#define BRCMF_E_STATUS_FWSUP_PREP_M4\t\t9\n#define BRCMF_E_STATUS_FWSUP_WAIT_G1\t\t10\n#define BRCMF_E_STATUS_FWSUP_PREP_G2\t\t11\n\n \n#define BRCMF_E_REASON_INITIAL_ASSOC\t\t0\n#define BRCMF_E_REASON_LOW_RSSI\t\t\t1\n#define BRCMF_E_REASON_DEAUTH\t\t\t2\n#define BRCMF_E_REASON_DISASSOC\t\t\t3\n#define BRCMF_E_REASON_BCNS_LOST\t\t4\n#define BRCMF_E_REASON_MINTXRATE\t\t9\n#define BRCMF_E_REASON_TXFAIL\t\t\t10\n\n#define BRCMF_E_REASON_LINK_BSSCFG_DIS\t\t4\n#define BRCMF_E_REASON_FAST_ROAM_FAILED\t\t5\n#define BRCMF_E_REASON_DIRECTED_ROAM\t\t6\n#define BRCMF_E_REASON_TSPEC_REJECTED\t\t7\n#define BRCMF_E_REASON_BETTER_AP\t\t8\n\n#define BRCMF_E_REASON_TDLS_PEER_DISCOVERED\t0\n#define BRCMF_E_REASON_TDLS_PEER_CONNECTED\t1\n#define BRCMF_E_REASON_TDLS_PEER_DISCONNECTED\t2\n\n \n#define BRCMF_E_REASON_FWSUP_OTHER\t\t0\n#define BRCMF_E_REASON_FWSUP_DECRYPT_KEY_DATA\t1\n#define BRCMF_E_REASON_FWSUP_BAD_UCAST_WEP128\t2\n#define BRCMF_E_REASON_FWSUP_BAD_UCAST_WEP40\t3\n#define BRCMF_E_REASON_FWSUP_UNSUP_KEY_LEN\t4\n#define BRCMF_E_REASON_FWSUP_PW_KEY_CIPHER\t5\n#define BRCMF_E_REASON_FWSUP_MSG3_TOO_MANY_IE\t6\n#define BRCMF_E_REASON_FWSUP_MSG3_IE_MISMATCH\t7\n#define BRCMF_E_REASON_FWSUP_NO_INSTALL_FLAG\t8\n#define BRCMF_E_REASON_FWSUP_MSG3_NO_GTK\t9\n#define BRCMF_E_REASON_FWSUP_GRP_KEY_CIPHER\t10\n#define BRCMF_E_REASON_FWSUP_GRP_MSG1_NO_GTK\t11\n#define BRCMF_E_REASON_FWSUP_GTK_DECRYPT_FAIL\t12\n#define BRCMF_E_REASON_FWSUP_SEND_FAIL\t\t13\n#define BRCMF_E_REASON_FWSUP_DEAUTH\t\t14\n#define BRCMF_E_REASON_FWSUP_WPA_PSK_TMO\t15\n#define BRCMF_E_REASON_FWSUP_WPA_PSK_M1_TMO\t16\n#define BRCMF_E_REASON_FWSUP_WPA_PSK_M3_TMO\t17\n\n \n#define BRCMF_E_IF_ADD\t\t\t\t1\n#define BRCMF_E_IF_DEL\t\t\t\t2\n#define BRCMF_E_IF_CHANGE\t\t\t3\n\n \n#define BRCMF_E_IF_FLAG_NOIF\t\t\t1\n\n \n#define BRCMF_E_IF_ROLE_STA\t\t\t0\n#define BRCMF_E_IF_ROLE_AP\t\t\t1\n#define BRCMF_E_IF_ROLE_WDS\t\t\t2\n#define BRCMF_E_IF_ROLE_P2P_GO\t\t\t3\n#define BRCMF_E_IF_ROLE_P2P_CLIENT\t\t4\n\n \n#define BRCM_OUI\t\t\t\t\"\\x00\\x10\\x18\"\n#define BCMILCP_BCM_SUBTYPE_EVENT\t\t1\n#define BCMILCP_SUBTYPE_VENDOR_LONG\t\t32769\n\n \nstruct brcm_ethhdr {\n\t__be16 subtype;\n\t__be16 length;\n\tu8 version;\n\tu8 oui[3];\n\t__be16 usr_subtype;\n} __packed;\n\nstruct brcmf_event_msg_be {\n\t__be16 version;\n\t__be16 flags;\n\t__be32 event_type;\n\t__be32 status;\n\t__be32 reason;\n\t__be32 auth_type;\n\t__be32 datalen;\n\tu8 addr[ETH_ALEN];\n\tchar ifname[IFNAMSIZ];\n\tu8 ifidx;\n\tu8 bsscfgidx;\n} __packed;\n\n \nstruct brcmf_event {\n\tstruct ethhdr eth;\n\tstruct brcm_ethhdr hdr;\n\tstruct brcmf_event_msg_be msg;\n} __packed;\n\n \nstruct brcmf_event_msg {\n\tu16 version;\n\tu16 flags;\n\tu32 event_code;\n\tu32 status;\n\tu32 reason;\n\ts32 auth_type;\n\tu32 datalen;\n\tu8 addr[ETH_ALEN];\n\tchar ifname[IFNAMSIZ];\n\tu8 ifidx;\n\tu8 bsscfgidx;\n};\n\nstruct brcmf_if_event {\n\tu8 ifidx;\n\tu8 action;\n\tu8 flags;\n\tu8 bsscfgidx;\n\tu8 role;\n};\n\ntypedef int (*brcmf_fweh_handler_t)(struct brcmf_if *ifp,\n\t\t\t\t    const struct brcmf_event_msg *evtmsg,\n\t\t\t\t    void *data);\n\n \nstruct brcmf_fweh_info {\n\tbool p2pdev_setup_ongoing;\n\tstruct work_struct event_work;\n\tspinlock_t evt_q_lock;\n\tstruct list_head event_q;\n\tint (*evt_handler[BRCMF_E_LAST])(struct brcmf_if *ifp,\n\t\t\t\t\t const struct brcmf_event_msg *evtmsg,\n\t\t\t\t\t void *data);\n};\n\nconst char *brcmf_fweh_event_name(enum brcmf_fweh_event_code code);\n\nvoid brcmf_fweh_attach(struct brcmf_pub *drvr);\nvoid brcmf_fweh_detach(struct brcmf_pub *drvr);\nint brcmf_fweh_register(struct brcmf_pub *drvr, enum brcmf_fweh_event_code code,\n\t\t\tint (*handler)(struct brcmf_if *ifp,\n\t\t\t\t       const struct brcmf_event_msg *evtmsg,\n\t\t\t\t       void *data));\nvoid brcmf_fweh_unregister(struct brcmf_pub *drvr,\n\t\t\t   enum brcmf_fweh_event_code code);\nint brcmf_fweh_activate_events(struct brcmf_if *ifp);\nvoid brcmf_fweh_process_event(struct brcmf_pub *drvr,\n\t\t\t      struct brcmf_event *event_packet,\n\t\t\t      u32 packet_len, gfp_t gfp);\nvoid brcmf_fweh_p2pdev_setup(struct brcmf_if *ifp, bool ongoing);\n\nstatic inline void brcmf_fweh_process_skb(struct brcmf_pub *drvr,\n\t\t\t\t\t  struct sk_buff *skb, u16 stype,\n\t\t\t\t\t  gfp_t gfp)\n{\n\tstruct brcmf_event *event_packet;\n\tu16 subtype, usr_stype;\n\n\t \n\tif (skb->protocol != cpu_to_be16(ETH_P_LINK_CTL))\n\t\treturn;\n\n\tif ((skb->len + ETH_HLEN) < sizeof(*event_packet))\n\t\treturn;\n\n\tevent_packet = (struct brcmf_event *)skb_mac_header(skb);\n\n\t \n\tif (unlikely(stype)) {\n\t\tsubtype = get_unaligned_be16(&event_packet->hdr.subtype);\n\t\tif (subtype != stype)\n\t\t\treturn;\n\t}\n\n\t \n\tif (memcmp(BRCM_OUI, &event_packet->hdr.oui[0],\n\t\t   sizeof(event_packet->hdr.oui)))\n\t\treturn;\n\n\t \n\tusr_stype = get_unaligned_be16(&event_packet->hdr.usr_subtype);\n\tif (usr_stype != BCMILCP_BCM_SUBTYPE_EVENT)\n\t\treturn;\n\n\tbrcmf_fweh_process_event(drvr, event_packet, skb->len + ETH_HLEN, gfp);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}