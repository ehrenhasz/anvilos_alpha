{
  "module_name": "rsi_main.h",
  "hash_id": "824313c7b8d30aa75d0b34fe59e5187d8ecb5a74b588849f26b8d81cf795dbe8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/rsi/rsi_main.h",
  "human_readable_source": " \n\n#ifndef __RSI_MAIN_H__\n#define __RSI_MAIN_H__\n\n#include <linux/string.h>\n#include <linux/skbuff.h>\n#include <net/mac80211.h>\n#include <net/rsi_91x.h>\n\nstruct rsi_sta {\n\tstruct ieee80211_sta *sta;\n\ts16 sta_id;\n\tu16 seq_start[IEEE80211_NUM_TIDS];\n\tbool start_tx_aggr[IEEE80211_NUM_TIDS];\n};\n\nstruct rsi_hw;\n\n#include \"rsi_ps.h\"\n\n#define ERR_ZONE                        BIT(0)   \n#define INFO_ZONE                       BIT(1)   \n#define INIT_ZONE                       BIT(2)   \n#define MGMT_TX_ZONE                    BIT(3)   \n#define MGMT_RX_ZONE                    BIT(4)   \n#define DATA_TX_ZONE                    BIT(5)   \n#define DATA_RX_ZONE                    BIT(6)   \n#define FSM_ZONE                        BIT(7)   \n#define ISR_ZONE                        BIT(8)   \n\nenum RSI_FSM_STATES {\n\tFSM_FW_NOT_LOADED,\n\tFSM_CARD_NOT_READY,\n\tFSM_COMMON_DEV_PARAMS_SENT,\n\tFSM_BOOT_PARAMS_SENT,\n\tFSM_EEPROM_READ_MAC_ADDR,\n\tFSM_EEPROM_READ_RF_TYPE,\n\tFSM_RESET_MAC_SENT,\n\tFSM_RADIO_CAPS_SENT,\n\tFSM_BB_RF_PROG_SENT,\n\tFSM_MAC_INIT_DONE,\n\n\tNUM_FSM_STATES\n};\n\nextern u32 rsi_zone_enabled;\nextern __printf(2, 3) void rsi_dbg(u32 zone, const char *fmt, ...);\n\n#define RSI_MAX_BANDS\t\t\t2\n#define RSI_MAX_VIFS                    3\n#define NUM_EDCA_QUEUES                 4\n#define IEEE80211_ADDR_LEN              6\n#define FRAME_DESC_SZ                   16\n#define MIN_802_11_HDR_LEN              24\n#define RSI_DEF_KEEPALIVE               90\n#define RSI_WOW_KEEPALIVE                5\n#define RSI_BCN_MISS_THRESHOLD           24\n\n#define DATA_QUEUE_WATER_MARK           400\n#define MIN_DATA_QUEUE_WATER_MARK       300\n#define MULTICAST_WATER_MARK            200\n#define MAC_80211_HDR_FRAME_CONTROL     0\n#define WME_NUM_AC                      4\n#define NUM_SOFT_QUEUES                 6\n#define MAX_HW_QUEUES                   12\n#define INVALID_QUEUE                   0xff\n#define MAX_CONTINUOUS_VO_PKTS          8\n#define MAX_CONTINUOUS_VI_PKTS          4\n\n \n#define BROADCAST_HW_Q\t\t\t9\n#define MGMT_HW_Q\t\t\t10\n#define BEACON_HW_Q\t\t\t11\n\n#define IEEE80211_MGMT_FRAME            0x00\n#define IEEE80211_CTL_FRAME             0x04\n\n#define RSI_MAX_ASSOC_STAS\t\t32\n#define IEEE80211_QOS_TID               0x0f\n#define IEEE80211_NONQOS_TID            16\n\n#define MAX_DEBUGFS_ENTRIES             4\n\n#define TID_TO_WME_AC(_tid) (      \\\n\t((_tid) == 0 || (_tid) == 3) ? BE_Q : \\\n\t((_tid) < 3) ? BK_Q : \\\n\t((_tid) < 6) ? VI_Q : \\\n\tVO_Q)\n\n#define WME_AC(_q) (    \\\n\t((_q) == BK_Q) ? IEEE80211_AC_BK : \\\n\t((_q) == BE_Q) ? IEEE80211_AC_BE : \\\n\t((_q) == VI_Q) ? IEEE80211_AC_VI : \\\n\tIEEE80211_AC_VO)\n\n \n#define RSI_WOW_ENABLED\t\t\tBIT(0)\n#define RSI_WOW_NO_CONNECTION\t\tBIT(1)\n\n#define RSI_MAX_RX_PKTS\t\t64\n\nenum rsi_dev_model {\n\tRSI_DEV_9113 = 0,\n\tRSI_DEV_9116\n};\n\nstruct version_info {\n\tu16 major;\n\tu16 minor;\n\tu8 release_num;\n\tu8 patch_num;\n\tunion {\n\t\tstruct {\n\t\t\tu8 fw_ver[8];\n\t\t} info;\n\t} ver;\n} __packed;\n\nstruct skb_info {\n\ts8 rssi;\n\tu32 flags;\n\tu16 channel;\n\ts8 tid;\n\ts8 sta_id;\n\tu8 internal_hdr_size;\n\tstruct ieee80211_vif *vif;\n\tu8 vap_id;\n\tbool have_key;\n};\n\nenum edca_queue {\n\tBK_Q,\n\tBE_Q,\n\tVI_Q,\n\tVO_Q,\n\tMGMT_SOFT_Q,\n\tMGMT_BEACON_Q\n};\n\nstruct security_info {\n\tu32 ptk_cipher;\n\tu32 gtk_cipher;\n};\n\nstruct wmm_qinfo {\n\ts32 weight;\n\ts32 wme_params;\n\ts32 pkt_contended;\n\ts32 txop;\n};\n\nstruct transmit_q_stats {\n\tu32 total_tx_pkt_send[NUM_EDCA_QUEUES + 2];\n\tu32 total_tx_pkt_freed[NUM_EDCA_QUEUES + 2];\n};\n\n#define MAX_BGSCAN_CHANNELS_DUAL_BAND\t38\n#define MAX_BGSCAN_PROBE_REQ_LEN\t0x64\n#define RSI_DEF_BGSCAN_THRLD\t\t0x0\n#define RSI_DEF_ROAM_THRLD\t\t0xa\n#define RSI_BGSCAN_PERIODICITY\t\t0x1e\n#define RSI_ACTIVE_SCAN_TIME\t\t0x14\n#define RSI_PASSIVE_SCAN_TIME\t\t0x46\n#define RSI_CHANNEL_SCAN_TIME\t\t20\nstruct rsi_bgscan_params {\n\tu16 bgscan_threshold;\n\tu16 roam_threshold;\n\tu16 bgscan_periodicity;\n\tu8 num_bgscan_channels;\n\tu8 two_probe;\n\tu16 active_scan_duration;\n\tu16 passive_scan_duration;\n};\n\nstruct vif_priv {\n\tbool is_ht;\n\tbool sgi;\n\tu16 seq_start;\n\tint vap_id;\n};\n\nstruct rsi_event {\n\tatomic_t event_condition;\n\twait_queue_head_t event_queue;\n};\n\nstruct rsi_thread {\n\tvoid (*thread_function)(void *);\n\tstruct completion completion;\n\tstruct task_struct *task;\n\tstruct rsi_event event;\n\tatomic_t thread_done;\n};\n\nstruct cqm_info {\n\ts8 last_cqm_event_rssi;\n\tint rssi_thold;\n\tu32 rssi_hyst;\n};\n\nenum rsi_dfs_regions {\n\tRSI_REGION_FCC = 0,\n\tRSI_REGION_ETSI,\n\tRSI_REGION_TELEC,\n\tRSI_REGION_WORLD\n};\n\nstruct rsi_9116_features {\n\tu8 pll_mode;\n\tu8 rf_type;\n\tu8 wireless_mode;\n\tu8 afe_type;\n\tu8 enable_ppe;\n\tu8 dpd;\n\tu32 sifs_tx_enable;\n\tu32 ps_options;\n};\n\nstruct rsi_rate_config {\n\tu32 configured_mask;\t \n\tu16 fixed_hw_rate;\n\tbool fixed_enabled;\n};\n\nstruct rsi_common {\n\tstruct rsi_hw *priv;\n\tstruct vif_priv vif_info[RSI_MAX_VIFS];\n\n\tvoid *coex_cb;\n\tbool mgmt_q_block;\n\tstruct version_info lmac_ver;\n\n\tstruct rsi_thread tx_thread;\n\tstruct sk_buff_head tx_queue[NUM_EDCA_QUEUES + 2];\n\tstruct completion wlan_init_completion;\n\t \n\tstruct mutex mutex;\n\t \n\tstruct mutex tx_lock;\n\t \n\tstruct mutex rx_lock;\n\tu8 endpoint;\n\n\t \n\tu8 band;\n\tu8 num_supp_bands;\n\tu8 channel_width;\n\n\tu16 rts_threshold;\n\tu32 bitrate_mask[RSI_MAX_BANDS];\n\tstruct rsi_rate_config rate_config[RSI_MAX_BANDS];\n\n\tu8 rf_reset;\n\tstruct transmit_q_stats tx_stats;\n\tstruct security_info secinfo;\n\tstruct wmm_qinfo tx_qinfo[NUM_EDCA_QUEUES];\n\tstruct ieee80211_tx_queue_params edca_params[NUM_EDCA_QUEUES];\n\tu8 mac_addr[IEEE80211_ADDR_LEN];\n\n\t \n\tu32 fsm_state;\n\tbool init_done;\n\tu8 bb_rf_prog_count;\n\tbool iface_down;\n\n\t \n\tu8 channel;\n\tu8 *rx_data_pkt;\n\tu8 mac_id;\n\tu8 radio_id;\n\tu16 rate_pwr[20];\n\n\t \n\tu8 selected_qnum;\n\tu32 pkt_cnt;\n\tu8 min_weight;\n\n\t \n\tstruct cqm_info cqm_info;\n\n\tbool hw_data_qs_blocked;\n\tu8 driver_mode;\n\tu8 coex_mode;\n\tu16 oper_mode;\n\tu8 lp_ps_handshake_mode;\n\tu8 ulp_ps_handshake_mode;\n\tu8 uapsd_bitmap;\n\tu8 rf_power_val;\n\tu8 wlan_rf_power_mode;\n\tu8 obm_ant_sel_val;\n\tint tx_power;\n\tu8 ant_in_use;\n\t \n\tstruct mutex tx_bus_mutex;\n\tbool hibernate_resume;\n\tbool reinit_hw;\n\tu8 wow_flags;\n\tu16 beacon_interval;\n\tu8 dtim_cnt;\n\n\t \n\tu8 beacon_enabled;\n\tu16 beacon_cnt;\n\tstruct rsi_sta stations[RSI_MAX_ASSOC_STAS + 1];\n\tint num_stations;\n\tint max_stations;\n\tstruct ieee80211_key_conf *key;\n\n\t \n\tbool p2p_enabled;\n\tstruct timer_list roc_timer;\n\tstruct ieee80211_vif *roc_vif;\n\n\tbool eapol4_confirm;\n\tbool bt_defer_attach;\n\tvoid *bt_adapter;\n\n\tstruct cfg80211_scan_request *hwscan;\n\tstruct rsi_bgscan_params bgscan;\n\tstruct rsi_9116_features w9116_features;\n\tu8 bgscan_en;\n\tu8 mac_ops_resumed;\n};\n\nstruct eepromrw_info {\n\tu32 offset;\n\tu32 length;\n\tu8  write;\n\tu16 eeprom_erase;\n\tu8 data[480];\n};\n\nstruct eeprom_read {\n\tu16 length;\n\tu16 off_set;\n};\n\nstruct rsi_hw {\n\tstruct rsi_common *priv;\n\tenum rsi_dev_model device_model;\n\tstruct ieee80211_hw *hw;\n\tstruct ieee80211_vif *vifs[RSI_MAX_VIFS];\n\tstruct ieee80211_tx_queue_params edca_params[NUM_EDCA_QUEUES];\n\tstruct ieee80211_supported_band sbands[NUM_NL80211_BANDS];\n\n\tstruct device *device;\n\tu8 sc_nvifs;\n\n\tenum rsi_host_intf rsi_host_intf;\n\tu16 block_size;\n\tenum ps_state ps_state;\n\tstruct rsi_ps_info ps_info;\n\tspinlock_t ps_lock;  \n\tu32 usb_buffer_status_reg;\n#ifdef CONFIG_RSI_DEBUGFS\n\tstruct rsi_debugfs *dfsentry;\n\tu8 num_debugfs_entries;\n#endif\n\tchar *fw_file_name;\n\tstruct timer_list bl_cmd_timer;\n\tbool blcmd_timer_expired;\n\tu32 flash_capacity;\n\tstruct eepromrw_info eeprom;\n\tu32 interrupt_status;\n\tu8 dfs_region;\n\tchar country[2];\n\tvoid *rsi_dev;\n\tstruct rsi_host_intf_ops *host_intf_ops;\n\tint (*check_hw_queue_status)(struct rsi_hw *adapter, u8 q_num);\n\tint (*determine_event_timeout)(struct rsi_hw *adapter);\n};\n\nvoid rsi_print_version(struct rsi_common *common);\n\nstruct rsi_host_intf_ops {\n\tint (*read_pkt)(struct rsi_hw *adapter, u8 *pkt, u32 len);\n\tint (*write_pkt)(struct rsi_hw *adapter, u8 *pkt, u32 len);\n\tint (*master_access_msword)(struct rsi_hw *adapter, u16 ms_word);\n\tint (*read_reg_multiple)(struct rsi_hw *adapter, u32 addr,\n\t\t\t\t u8 *data, u16 count);\n\tint (*write_reg_multiple)(struct rsi_hw *adapter, u32 addr,\n\t\t\t\t  u8 *data, u16 count);\n\tint (*master_reg_read)(struct rsi_hw *adapter, u32 addr,\n\t\t\t       u32 *read_buf, u16 size);\n\tint (*master_reg_write)(struct rsi_hw *adapter,\n\t\t\t\tunsigned long addr, unsigned long data,\n\t\t\t\tu16 size);\n\tint (*load_data_master_write)(struct rsi_hw *adapter, u32 addr,\n\t\t\t\t      u32 instructions_size, u16 block_size,\n\t\t\t\t      u8 *fw);\n\tint (*reinit_device)(struct rsi_hw *adapter);\n\tint (*ta_reset)(struct rsi_hw *adapter);\n};\n\nenum rsi_host_intf rsi_get_host_intf(void *priv);\nvoid rsi_set_bt_context(void *priv, void *bt_context);\nvoid rsi_attach_bt(struct rsi_common *common);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}