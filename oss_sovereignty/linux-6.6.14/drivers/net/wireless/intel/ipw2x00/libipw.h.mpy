{
  "module_name": "libipw.h",
  "hash_id": "2d2c4e6910a80f46dd0138d96dc077f8d1da66f60362adcbab6b7f506b559540",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/intel/ipw2x00/libipw.h",
  "human_readable_source": " \n \n#ifndef LIBIPW_H\n#define LIBIPW_H\n#include <linux/if_ether.h>\t \n#include <linux/kernel.h>\t \n#include <linux/wireless.h>\n#include <linux/ieee80211.h>\n\n#include <net/lib80211.h>\n#include <net/cfg80211.h>\n\n#define LIBIPW_VERSION \"git-1.1.13\"\n\n#define LIBIPW_DATA_LEN\t\t2304\n \n\n#define LIBIPW_1ADDR_LEN 10\n#define LIBIPW_2ADDR_LEN 16\n#define LIBIPW_3ADDR_LEN 24\n#define LIBIPW_4ADDR_LEN 30\n#define LIBIPW_FCS_LEN    4\n#define LIBIPW_HLEN\t\t\t(LIBIPW_4ADDR_LEN)\n#define LIBIPW_FRAME_LEN\t\t(LIBIPW_DATA_LEN + LIBIPW_HLEN)\n\n#define MIN_FRAG_THRESHOLD     256U\n#define\tMAX_FRAG_THRESHOLD     2346U\n\n \n#define LIBIPW_QCTL_TID\t\t0x000F\n\n \n\n#ifdef CONFIG_LIBIPW_DEBUG\nextern u32 libipw_debug_level;\n#define LIBIPW_DEBUG(level, fmt, args...) \\\ndo { if (libipw_debug_level & (level)) \\\n  printk(KERN_DEBUG \"libipw: %s \" fmt, __func__ , ## args); } while (0)\n#else\n#define LIBIPW_DEBUG(level, fmt, args...) do {} while (0)\n#endif\t\t\t\t \n\n \n\n#define LIBIPW_DL_INFO          (1<<0)\n#define LIBIPW_DL_WX            (1<<1)\n#define LIBIPW_DL_SCAN          (1<<2)\n#define LIBIPW_DL_STATE         (1<<3)\n#define LIBIPW_DL_MGMT          (1<<4)\n#define LIBIPW_DL_FRAG          (1<<5)\n#define LIBIPW_DL_DROP          (1<<7)\n\n#define LIBIPW_DL_TX            (1<<8)\n#define LIBIPW_DL_RX            (1<<9)\n#define LIBIPW_DL_QOS           (1<<31)\n\n#define LIBIPW_ERROR(f, a...) printk(KERN_ERR \"libipw: \" f, ## a)\n#define LIBIPW_WARNING(f, a...) printk(KERN_WARNING \"libipw: \" f, ## a)\n#define LIBIPW_DEBUG_INFO(f, a...)   LIBIPW_DEBUG(LIBIPW_DL_INFO, f, ## a)\n\n#define LIBIPW_DEBUG_WX(f, a...)     LIBIPW_DEBUG(LIBIPW_DL_WX, f, ## a)\n#define LIBIPW_DEBUG_SCAN(f, a...)   LIBIPW_DEBUG(LIBIPW_DL_SCAN, f, ## a)\n#define LIBIPW_DEBUG_STATE(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_STATE, f, ## a)\n#define LIBIPW_DEBUG_MGMT(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_MGMT, f, ## a)\n#define LIBIPW_DEBUG_FRAG(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_FRAG, f, ## a)\n#define LIBIPW_DEBUG_DROP(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_DROP, f, ## a)\n#define LIBIPW_DEBUG_TX(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_TX, f, ## a)\n#define LIBIPW_DEBUG_RX(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_RX, f, ## a)\n#define LIBIPW_DEBUG_QOS(f, a...)  LIBIPW_DEBUG(LIBIPW_DL_QOS, f, ## a)\n#include <linux/netdevice.h>\n#include <linux/if_arp.h>\t \n\n#ifndef WIRELESS_SPY\n#define WIRELESS_SPY\t\t \n#endif\n#include <net/iw_handler.h>\t \n\n#define ETH_P_PREAUTH 0x88C7\t \n\n#ifndef ETH_P_80211_RAW\n#define ETH_P_80211_RAW (ETH_P_ECONET + 1)\n#endif\n\n \n\n#define P80211_OUI_LEN 3\n\nstruct libipw_snap_hdr {\n\n\tu8 dsap;\t\t \n\tu8 ssap;\t\t \n\tu8 ctrl;\t\t \n\tu8 oui[P80211_OUI_LEN];\t \n\n} __packed;\n\n#define SNAP_SIZE sizeof(struct libipw_snap_hdr)\n\n#define WLAN_FC_GET_VERS(fc) ((fc) & IEEE80211_FCTL_VERS)\n#define WLAN_FC_GET_TYPE(fc) ((fc) & IEEE80211_FCTL_FTYPE)\n#define WLAN_FC_GET_STYPE(fc) ((fc) & IEEE80211_FCTL_STYPE)\n\n#define WLAN_GET_SEQ_FRAG(seq) ((seq) & IEEE80211_SCTL_FRAG)\n#define WLAN_GET_SEQ_SEQ(seq)  (((seq) & IEEE80211_SCTL_SEQ) >> 4)\n\n#define LIBIPW_STATMASK_SIGNAL (1<<0)\n#define LIBIPW_STATMASK_RSSI (1<<1)\n#define LIBIPW_STATMASK_NOISE (1<<2)\n#define LIBIPW_STATMASK_RATE (1<<3)\n#define LIBIPW_STATMASK_WEMASK 0x7\n\n#define LIBIPW_CCK_MODULATION    (1<<0)\n#define LIBIPW_OFDM_MODULATION   (1<<1)\n\n#define LIBIPW_24GHZ_BAND     (1<<0)\n#define LIBIPW_52GHZ_BAND     (1<<1)\n\n#define LIBIPW_CCK_RATE_1MB\t\t        0x02\n#define LIBIPW_CCK_RATE_2MB\t\t        0x04\n#define LIBIPW_CCK_RATE_5MB\t\t        0x0B\n#define LIBIPW_CCK_RATE_11MB\t\t        0x16\n#define LIBIPW_OFDM_RATE_6MB\t\t        0x0C\n#define LIBIPW_OFDM_RATE_9MB\t\t        0x12\n#define LIBIPW_OFDM_RATE_12MB\t\t0x18\n#define LIBIPW_OFDM_RATE_18MB\t\t0x24\n#define LIBIPW_OFDM_RATE_24MB\t\t0x30\n#define LIBIPW_OFDM_RATE_36MB\t\t0x48\n#define LIBIPW_OFDM_RATE_48MB\t\t0x60\n#define LIBIPW_OFDM_RATE_54MB\t\t0x6C\n#define LIBIPW_BASIC_RATE_MASK\t\t0x80\n\n#define LIBIPW_CCK_RATE_1MB_MASK\t\t(1<<0)\n#define LIBIPW_CCK_RATE_2MB_MASK\t\t(1<<1)\n#define LIBIPW_CCK_RATE_5MB_MASK\t\t(1<<2)\n#define LIBIPW_CCK_RATE_11MB_MASK\t\t(1<<3)\n#define LIBIPW_OFDM_RATE_6MB_MASK\t\t(1<<4)\n#define LIBIPW_OFDM_RATE_9MB_MASK\t\t(1<<5)\n#define LIBIPW_OFDM_RATE_12MB_MASK\t\t(1<<6)\n#define LIBIPW_OFDM_RATE_18MB_MASK\t\t(1<<7)\n#define LIBIPW_OFDM_RATE_24MB_MASK\t\t(1<<8)\n#define LIBIPW_OFDM_RATE_36MB_MASK\t\t(1<<9)\n#define LIBIPW_OFDM_RATE_48MB_MASK\t\t(1<<10)\n#define LIBIPW_OFDM_RATE_54MB_MASK\t\t(1<<11)\n\n#define LIBIPW_CCK_RATES_MASK\t        0x0000000F\n#define LIBIPW_CCK_BASIC_RATES_MASK\t(LIBIPW_CCK_RATE_1MB_MASK | \\\n\tLIBIPW_CCK_RATE_2MB_MASK)\n#define LIBIPW_CCK_DEFAULT_RATES_MASK\t(LIBIPW_CCK_BASIC_RATES_MASK | \\\n        LIBIPW_CCK_RATE_5MB_MASK | \\\n        LIBIPW_CCK_RATE_11MB_MASK)\n\n#define LIBIPW_OFDM_RATES_MASK\t\t0x00000FF0\n#define LIBIPW_OFDM_BASIC_RATES_MASK\t(LIBIPW_OFDM_RATE_6MB_MASK | \\\n\tLIBIPW_OFDM_RATE_12MB_MASK | \\\n\tLIBIPW_OFDM_RATE_24MB_MASK)\n#define LIBIPW_OFDM_DEFAULT_RATES_MASK\t(LIBIPW_OFDM_BASIC_RATES_MASK | \\\n\tLIBIPW_OFDM_RATE_9MB_MASK  | \\\n\tLIBIPW_OFDM_RATE_18MB_MASK | \\\n\tLIBIPW_OFDM_RATE_36MB_MASK | \\\n\tLIBIPW_OFDM_RATE_48MB_MASK | \\\n\tLIBIPW_OFDM_RATE_54MB_MASK)\n#define LIBIPW_DEFAULT_RATES_MASK (LIBIPW_OFDM_DEFAULT_RATES_MASK | \\\n                                LIBIPW_CCK_DEFAULT_RATES_MASK)\n\n#define LIBIPW_NUM_OFDM_RATES\t    8\n#define LIBIPW_NUM_CCK_RATES\t            4\n#define LIBIPW_OFDM_SHIFT_MASK_A         4\n\n \nstruct libipw_rx_stats {\n\tu32 mac_time;\n\ts8 rssi;\n\tu8 signal;\n\tu8 noise;\n\tu16 rate;\t\t \n\tu8 received_channel;\n\tu8 control;\n\tu8 mask;\n\tu8 freq;\n\tu16 len;\n\tu64 tsf;\n\tu32 beacon_time;\n};\n\n \n#define LIBIPW_FRAG_CACHE_LEN 4\n\nstruct libipw_frag_entry {\n\tunsigned long first_frag_time;\n\tunsigned int seq;\n\tunsigned int last_frag;\n\tstruct sk_buff *skb;\n\tu8 src_addr[ETH_ALEN];\n\tu8 dst_addr[ETH_ALEN];\n};\n\nstruct libipw_stats {\n\tunsigned int tx_unicast_frames;\n\tunsigned int tx_multicast_frames;\n\tunsigned int tx_fragments;\n\tunsigned int tx_unicast_octets;\n\tunsigned int tx_multicast_octets;\n\tunsigned int tx_deferred_transmissions;\n\tunsigned int tx_single_retry_frames;\n\tunsigned int tx_multiple_retry_frames;\n\tunsigned int tx_retry_limit_exceeded;\n\tunsigned int tx_discards;\n\tunsigned int rx_unicast_frames;\n\tunsigned int rx_multicast_frames;\n\tunsigned int rx_fragments;\n\tunsigned int rx_unicast_octets;\n\tunsigned int rx_multicast_octets;\n\tunsigned int rx_fcs_errors;\n\tunsigned int rx_discards_no_buffer;\n\tunsigned int tx_discards_wrong_sa;\n\tunsigned int rx_discards_undecryptable;\n\tunsigned int rx_message_in_msg_fragments;\n\tunsigned int rx_message_in_bad_msg_fragments;\n};\n\nstruct libipw_device;\n\n#define SEC_KEY_1\t\t(1<<0)\n#define SEC_KEY_2\t\t(1<<1)\n#define SEC_KEY_3\t\t(1<<2)\n#define SEC_KEY_4\t\t(1<<3)\n#define SEC_ACTIVE_KEY\t\t(1<<4)\n#define SEC_AUTH_MODE\t\t(1<<5)\n#define SEC_UNICAST_GROUP\t(1<<6)\n#define SEC_LEVEL\t\t(1<<7)\n#define SEC_ENABLED\t\t(1<<8)\n#define SEC_ENCRYPT\t\t(1<<9)\n\n#define SEC_LEVEL_0\t\t0\t \n#define SEC_LEVEL_1\t\t1\t \n#define SEC_LEVEL_2\t\t2\t \n#define SEC_LEVEL_2_CKIP\t3\t \n#define SEC_LEVEL_3\t\t4\t \n\n#define SEC_ALG_NONE\t\t0\n#define SEC_ALG_WEP\t\t1\n#define SEC_ALG_TKIP\t\t2\n#define SEC_ALG_CCMP\t\t3\n\n#define WEP_KEYS\t\t4\n#define WEP_KEY_LEN\t\t13\n#define SCM_KEY_LEN\t\t32\n#define SCM_TEMPORAL_KEY_LENGTH\t16\n\nstruct libipw_security {\n\tu16 active_key:2, enabled:1, unicast_uses_group:1, encrypt:1;\n\tu8 auth_mode;\n\tu8 encode_alg[WEP_KEYS];\n\tu8 key_sizes[WEP_KEYS];\n\tu8 keys[WEP_KEYS][SCM_KEY_LEN];\n\tu8 level;\n\tu16 flags;\n} __packed;\n\n \n\n#define BEACON_PROBE_SSID_ID_POSITION 12\n\nstruct libipw_hdr_1addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct libipw_hdr_2addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct libipw_hdr_3addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 payload[];\n} __packed;\n\nstruct libipw_hdr_4addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 addr4[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct libipw_hdr_3addrqos {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 payload[0];\n\t__le16 qos_ctl;\n} __packed;\n\nstruct libipw_info_element {\n\tu8 id;\n\tu8 len;\n\tu8 data[];\n} __packed;\n\n \n\nstruct libipw_auth {\n\tstruct libipw_hdr_3addr header;\n\t__le16 algorithm;\n\t__le16 transaction;\n\t__le16 status;\n\t \n\tu8 variable[];\n} __packed;\n\nstruct libipw_channel_switch {\n\tu8 id;\n\tu8 len;\n\tu8 mode;\n\tu8 channel;\n\tu8 count;\n} __packed;\n\nstruct libipw_action {\n\tstruct libipw_hdr_3addr header;\n\tu8 category;\n\tu8 action;\n\tunion {\n\t\tstruct libipw_action_exchange {\n\t\t\tu8 token;\n\t\t} exchange;\n\t\tstruct libipw_channel_switch channel_switch;\n\n\t} format;\n} __packed;\n\nstruct libipw_disassoc {\n\tstruct libipw_hdr_3addr header;\n\t__le16 reason;\n} __packed;\n\n \n#define libipw_deauth libipw_disassoc\n\nstruct libipw_probe_request {\n\tstruct libipw_hdr_3addr header;\n\t \n\tu8 variable[];\n} __packed;\n\nstruct libipw_probe_response {\n\tstruct libipw_hdr_3addr header;\n\t__le32 time_stamp[2];\n\t__le16 beacon_interval;\n\t__le16 capability;\n\t \n\tu8 variable[];\n} __packed;\n\n \n#define libipw_beacon libipw_probe_response\n\nstruct libipw_assoc_request {\n\tstruct libipw_hdr_3addr header;\n\t__le16 capability;\n\t__le16 listen_interval;\n\t \n\tu8 variable[];\n} __packed;\n\nstruct libipw_reassoc_request {\n\tstruct libipw_hdr_3addr header;\n\t__le16 capability;\n\t__le16 listen_interval;\n\tu8 current_ap[ETH_ALEN];\n\tu8 variable[];\n} __packed;\n\nstruct libipw_assoc_response {\n\tstruct libipw_hdr_3addr header;\n\t__le16 capability;\n\t__le16 status;\n\t__le16 aid;\n\t \n\tu8 variable[];\n} __packed;\n\nstruct libipw_txb {\n\tu8 nr_frags;\n\tu8 encrypted;\n\tu8 rts_included;\n\tu8 reserved;\n\tu16 frag_size;\n\tu16 payload_size;\n\tstruct sk_buff *fragments[];\n};\n\n \n#define MAX_SWEEP_TAB_ENTRIES\t\t  42\n#define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7\n \n#define MAX_RATES_LENGTH                  ((u8)12)\n#define MAX_RATES_EX_LENGTH               ((u8)16)\n#define MAX_NETWORK_COUNT                  128\n\n#define CRC_LENGTH                 4U\n\n#define MAX_WPA_IE_LEN 64\n\n#define NETWORK_HAS_OFDM       (1<<1)\n#define NETWORK_HAS_CCK        (1<<2)\n\n \n#define NETWORK_HAS_QOS_PARAMETERS      (1<<3)\n#define NETWORK_HAS_QOS_INFORMATION     (1<<4)\n#define NETWORK_HAS_QOS_MASK            (NETWORK_HAS_QOS_PARAMETERS | \\\n\t\t\t\t\t NETWORK_HAS_QOS_INFORMATION)\n\n \n#define NETWORK_HAS_POWER_CONSTRAINT    (1<<5)\n#define NETWORK_HAS_CSA                 (1<<6)\n#define NETWORK_HAS_QUIET               (1<<7)\n#define NETWORK_HAS_IBSS_DFS            (1<<8)\n#define NETWORK_HAS_TPC_REPORT          (1<<9)\n\n#define NETWORK_HAS_ERP_VALUE           (1<<10)\n\n#define QOS_QUEUE_NUM                   4\n#define QOS_OUI_LEN                     3\n#define QOS_OUI_TYPE                    2\n#define QOS_ELEMENT_ID                  221\n#define QOS_OUI_INFO_SUB_TYPE           0\n#define QOS_OUI_PARAM_SUB_TYPE          1\n#define QOS_VERSION_1                   1\n#define QOS_AIFSN_MIN_VALUE             2\n\nstruct libipw_qos_information_element {\n\tu8 elementID;\n\tu8 length;\n\tu8 qui[QOS_OUI_LEN];\n\tu8 qui_type;\n\tu8 qui_subtype;\n\tu8 version;\n\tu8 ac_info;\n} __packed;\n\nstruct libipw_qos_ac_parameter {\n\tu8 aci_aifsn;\n\tu8 ecw_min_max;\n\t__le16 tx_op_limit;\n} __packed;\n\nstruct libipw_qos_parameter_info {\n\tstruct libipw_qos_information_element info_element;\n\tu8 reserved;\n\tstruct libipw_qos_ac_parameter ac_params_record[QOS_QUEUE_NUM];\n} __packed;\n\nstruct libipw_qos_parameters {\n\t__le16 cw_min[QOS_QUEUE_NUM];\n\t__le16 cw_max[QOS_QUEUE_NUM];\n\tu8 aifs[QOS_QUEUE_NUM];\n\tu8 flag[QOS_QUEUE_NUM];\n\t__le16 tx_op_limit[QOS_QUEUE_NUM];\n} __packed;\n\nstruct libipw_qos_data {\n\tstruct libipw_qos_parameters parameters;\n\tint active;\n\tint supported;\n\tu8 param_count;\n\tu8 old_param_count;\n};\n\nstruct libipw_tim_parameters {\n\tu8 tim_count;\n\tu8 tim_period;\n} __packed;\n\n \n\nstruct libipw_tpc_report {\n\tu8 transmit_power;\n\tu8 link_margin;\n} __packed;\n\nstruct libipw_channel_map {\n\tu8 channel;\n\tu8 map;\n} __packed;\n\nstruct libipw_ibss_dfs {\n\tstruct libipw_info_element ie;\n\tu8 owner[ETH_ALEN];\n\tu8 recovery_interval;\n\tstruct libipw_channel_map channel_map[];\n};\n\nstruct libipw_csa {\n\tu8 mode;\n\tu8 channel;\n\tu8 count;\n} __packed;\n\nstruct libipw_quiet {\n\tu8 count;\n\tu8 period;\n\tu8 duration;\n\tu8 offset;\n} __packed;\n\nstruct libipw_network {\n\t \n\tu8 bssid[ETH_ALEN];\n\tu8 channel;\n\t \n\tu8 ssid[IW_ESSID_MAX_SIZE + 1];\n\tu8 ssid_len;\n\n\tstruct libipw_qos_data qos_data;\n\n\t \n\tstruct libipw_rx_stats stats;\n\tu16 capability;\n\tu8 rates[MAX_RATES_LENGTH];\n\tu8 rates_len;\n\tu8 rates_ex[MAX_RATES_EX_LENGTH];\n\tu8 rates_ex_len;\n\tunsigned long last_scanned;\n\tu8 mode;\n\tu32 flags;\n\tu32 last_associate;\n\tu32 time_stamp[2];\n\tu16 beacon_interval;\n\tu16 listen_interval;\n\tu16 atim_window;\n\tu8 erp_value;\n\tu8 wpa_ie[MAX_WPA_IE_LEN];\n\tsize_t wpa_ie_len;\n\tu8 rsn_ie[MAX_WPA_IE_LEN];\n\tsize_t rsn_ie_len;\n\tstruct libipw_tim_parameters tim;\n\n\t \n\n\t \n\tu8 power_constraint;\n\n\t \n\tstruct libipw_tpc_report tpc_report;\n\n\t \n\tstruct libipw_csa csa;\n\n\t \n\tstruct libipw_quiet quiet;\n\n\tstruct list_head list;\n};\n\nenum libipw_state {\n\tLIBIPW_UNINITIALIZED = 0,\n\tLIBIPW_INITIALIZED,\n\tLIBIPW_ASSOCIATING,\n\tLIBIPW_ASSOCIATED,\n\tLIBIPW_AUTHENTICATING,\n\tLIBIPW_AUTHENTICATED,\n\tLIBIPW_SHUTDOWN\n};\n\n#define DEFAULT_MAX_SCAN_AGE (15 * HZ)\n#define DEFAULT_FTS 2346\n\n#define CFG_LIBIPW_RESERVE_FCS (1<<0)\n#define CFG_LIBIPW_COMPUTE_FCS (1<<1)\n#define CFG_LIBIPW_RTS (1<<2)\n\n#define LIBIPW_24GHZ_MIN_CHANNEL 1\n#define LIBIPW_24GHZ_MAX_CHANNEL 14\n#define LIBIPW_24GHZ_CHANNELS (LIBIPW_24GHZ_MAX_CHANNEL - \\\n\t\t\t\t  LIBIPW_24GHZ_MIN_CHANNEL + 1)\n\n#define LIBIPW_52GHZ_MIN_CHANNEL 34\n#define LIBIPW_52GHZ_MAX_CHANNEL 165\n#define LIBIPW_52GHZ_CHANNELS (LIBIPW_52GHZ_MAX_CHANNEL - \\\n\t\t\t\t  LIBIPW_52GHZ_MIN_CHANNEL + 1)\n\nenum {\n\tLIBIPW_CH_PASSIVE_ONLY = (1 << 0),\n\tLIBIPW_CH_80211H_RULES = (1 << 1),\n\tLIBIPW_CH_B_ONLY = (1 << 2),\n\tLIBIPW_CH_NO_IBSS = (1 << 3),\n\tLIBIPW_CH_UNIFORM_SPREADING = (1 << 4),\n\tLIBIPW_CH_RADAR_DETECT = (1 << 5),\n\tLIBIPW_CH_INVALID = (1 << 6),\n};\n\nstruct libipw_channel {\n\tu32 freq;\t \n\tu8 channel;\n\tu8 flags;\n\tu8 max_power;\t \n};\n\nstruct libipw_geo {\n\tu8 name[4];\n\tu8 bg_channels;\n\tu8 a_channels;\n\tstruct libipw_channel bg[LIBIPW_24GHZ_CHANNELS];\n\tstruct libipw_channel a[LIBIPW_52GHZ_CHANNELS];\n};\n\nstruct libipw_device {\n\tstruct net_device *dev;\n\tstruct wireless_dev wdev;\n\tstruct libipw_security sec;\n\n\t \n\tstruct libipw_stats ieee_stats;\n\n\tstruct libipw_geo geo;\n\tstruct ieee80211_supported_band bg_band;\n\tstruct ieee80211_supported_band a_band;\n\n\t \n\tstruct list_head network_free_list;\n\tstruct list_head network_list;\n\tstruct libipw_network *networks[MAX_NETWORK_COUNT];\n\tint scans;\n\tint scan_age;\n\n\tint iw_mode;\t\t \n\tstruct iw_spy_data spy_data;\t \n\n\tspinlock_t lock;\n\n\tint tx_headroom;\t \n\tu32 config;\n\n\t \n\tint open_wep;\t\t \n\n\t \n\tint host_encrypt;\n\tint host_encrypt_msdu;\n\tint host_decrypt;\n\t \n\tint host_mc_decrypt;\n\n\t \n\t \n\tint host_strip_iv_icv;\n\n\tint host_open_frag;\n\tint ieee802_1x;\t\t \n\n\t \n\tint wpa_enabled;\n\tint drop_unencrypted;\n\tint privacy_invoked;\n\tsize_t wpa_ie_len;\n\tu8 *wpa_ie;\n\n\tstruct lib80211_crypt_info crypt_info;\n\n\tint bcrx_sta_key;\t \n\n\t \n\tstruct libipw_frag_entry frag_cache[LIBIPW_FRAG_CACHE_LEN];\n\tunsigned int frag_next_idx;\n\tu16 fts;\t\t \n\tu16 rts;\t\t \n\n\t \n\tu8 bssid[ETH_ALEN];\n\n\tenum libipw_state state;\n\n\tint mode;\t\t \n\tint modulation;\t\t \n\tint freq_band;\t\t \n\tint abg_true;\t\t \n\n\tint perfect_rssi;\n\tint worst_rssi;\n\n\tu16 prev_seq_ctl;\t \n\n\t \n\tvoid (*set_security) (struct net_device * dev,\n\t\t\t      struct libipw_security * sec);\n\tnetdev_tx_t (*hard_start_xmit) (struct libipw_txb * txb,\n\t\t\t\t\tstruct net_device * dev, int pri);\n\tint (*is_queue_full) (struct net_device * dev, int pri);\n\n\tint (*handle_management) (struct net_device * dev,\n\t\t\t\t  struct libipw_network * network, u16 type);\n\tint (*is_qos_active) (struct net_device *dev, struct sk_buff *skb);\n\n\t \n\tint (*handle_auth) (struct net_device * dev,\n\t\t\t    struct libipw_auth * auth);\n\tint (*handle_deauth) (struct net_device * dev,\n\t\t\t      struct libipw_deauth * auth);\n\tint (*handle_action) (struct net_device * dev,\n\t\t\t      struct libipw_action * action,\n\t\t\t      struct libipw_rx_stats * stats);\n\tint (*handle_disassoc) (struct net_device * dev,\n\t\t\t\tstruct libipw_disassoc * assoc);\n\tint (*handle_beacon) (struct net_device * dev,\n\t\t\t      struct libipw_beacon * beacon,\n\t\t\t      struct libipw_network * network);\n\tint (*handle_probe_response) (struct net_device * dev,\n\t\t\t\t      struct libipw_probe_response * resp,\n\t\t\t\t      struct libipw_network * network);\n\tint (*handle_probe_request) (struct net_device * dev,\n\t\t\t\t     struct libipw_probe_request * req,\n\t\t\t\t     struct libipw_rx_stats * stats);\n\tint (*handle_assoc_response) (struct net_device * dev,\n\t\t\t\t      struct libipw_assoc_response * resp,\n\t\t\t\t      struct libipw_network * network);\n\n\t \n\tint (*handle_assoc_request) (struct net_device * dev);\n\tint (*handle_reassoc_request) (struct net_device * dev,\n\t\t\t\t       struct libipw_reassoc_request * req);\n\n\t \n\tu8 priv[];\n};\n\n#define IEEE_A            (1<<0)\n#define IEEE_B            (1<<1)\n#define IEEE_G            (1<<2)\n#define IEEE_MODE_MASK    (IEEE_A|IEEE_B|IEEE_G)\n\nstatic inline void *libipw_priv(struct net_device *dev)\n{\n\treturn ((struct libipw_device *)netdev_priv(dev))->priv;\n}\n\nstatic inline int libipw_is_valid_mode(struct libipw_device *ieee,\n\t\t\t\t\t  int mode)\n{\n\t \n\tif ((mode & IEEE_A) &&\n\t    (ieee->modulation & LIBIPW_OFDM_MODULATION) &&\n\t    (ieee->freq_band & LIBIPW_52GHZ_BAND))\n\t\treturn 1;\n\n\tif ((mode & IEEE_G) &&\n\t    (ieee->modulation & LIBIPW_OFDM_MODULATION) &&\n\t    (ieee->freq_band & LIBIPW_24GHZ_BAND))\n\t\treturn 1;\n\n\tif ((mode & IEEE_B) &&\n\t    (ieee->modulation & LIBIPW_CCK_MODULATION) &&\n\t    (ieee->freq_band & LIBIPW_24GHZ_BAND))\n\t\treturn 1;\n\n\treturn 0;\n}\n\nstatic inline int libipw_get_hdrlen(u16 fc)\n{\n\tint hdrlen = LIBIPW_3ADDR_LEN;\n\tu16 stype = WLAN_FC_GET_STYPE(fc);\n\n\tswitch (WLAN_FC_GET_TYPE(fc)) {\n\tcase IEEE80211_FTYPE_DATA:\n\t\tif ((fc & IEEE80211_FCTL_FROMDS) && (fc & IEEE80211_FCTL_TODS))\n\t\t\thdrlen = LIBIPW_4ADDR_LEN;\n\t\tif (stype & IEEE80211_STYPE_QOS_DATA)\n\t\t\thdrlen += 2;\n\t\tbreak;\n\tcase IEEE80211_FTYPE_CTL:\n\t\tswitch (WLAN_FC_GET_STYPE(fc)) {\n\t\tcase IEEE80211_STYPE_CTS:\n\t\tcase IEEE80211_STYPE_ACK:\n\t\t\thdrlen = LIBIPW_1ADDR_LEN;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\thdrlen = LIBIPW_2ADDR_LEN;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t}\n\n\treturn hdrlen;\n}\n\nstatic inline u8 *libipw_get_payload(struct ieee80211_hdr *hdr)\n{\n\tswitch (libipw_get_hdrlen(le16_to_cpu(hdr->frame_control))) {\n\tcase LIBIPW_1ADDR_LEN:\n\t\treturn ((struct libipw_hdr_1addr *)hdr)->payload;\n\tcase LIBIPW_2ADDR_LEN:\n\t\treturn ((struct libipw_hdr_2addr *)hdr)->payload;\n\tcase LIBIPW_3ADDR_LEN:\n\t\treturn ((struct libipw_hdr_3addr *)hdr)->payload;\n\tcase LIBIPW_4ADDR_LEN:\n\t\treturn ((struct libipw_hdr_4addr *)hdr)->payload;\n\t}\n\treturn NULL;\n}\n\nstatic inline int libipw_is_ofdm_rate(u8 rate)\n{\n\tswitch (rate & ~LIBIPW_BASIC_RATE_MASK) {\n\tcase LIBIPW_OFDM_RATE_6MB:\n\tcase LIBIPW_OFDM_RATE_9MB:\n\tcase LIBIPW_OFDM_RATE_12MB:\n\tcase LIBIPW_OFDM_RATE_18MB:\n\tcase LIBIPW_OFDM_RATE_24MB:\n\tcase LIBIPW_OFDM_RATE_36MB:\n\tcase LIBIPW_OFDM_RATE_48MB:\n\tcase LIBIPW_OFDM_RATE_54MB:\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nstatic inline int libipw_is_cck_rate(u8 rate)\n{\n\tswitch (rate & ~LIBIPW_BASIC_RATE_MASK) {\n\tcase LIBIPW_CCK_RATE_1MB:\n\tcase LIBIPW_CCK_RATE_2MB:\n\tcase LIBIPW_CCK_RATE_5MB:\n\tcase LIBIPW_CCK_RATE_11MB:\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\n \nvoid free_libipw(struct net_device *dev, int monitor);\nstruct net_device *alloc_libipw(int sizeof_priv, int monitor);\n\nvoid libipw_networks_age(struct libipw_device *ieee, unsigned long age_secs);\n\nint libipw_set_encryption(struct libipw_device *ieee);\n\n \nnetdev_tx_t libipw_xmit(struct sk_buff *skb, struct net_device *dev);\nvoid libipw_txb_free(struct libipw_txb *);\n\n \nvoid libipw_rx_any(struct libipw_device *ieee, struct sk_buff *skb,\n\t\t   struct libipw_rx_stats *stats);\nint libipw_rx(struct libipw_device *ieee, struct sk_buff *skb,\n\t      struct libipw_rx_stats *rx_stats);\n \nvoid libipw_rx_mgt(struct libipw_device *ieee, struct libipw_hdr_4addr *header,\n\t\t   struct libipw_rx_stats *stats);\n\n \nconst struct libipw_geo *libipw_get_geo(struct libipw_device *ieee);\nvoid libipw_set_geo(struct libipw_device *ieee, const struct libipw_geo *geo);\n\nint libipw_is_valid_channel(struct libipw_device *ieee, u8 channel);\nint libipw_channel_to_index(struct libipw_device *ieee, u8 channel);\nu8 libipw_freq_to_channel(struct libipw_device *ieee, u32 freq);\nu8 libipw_get_channel_flags(struct libipw_device *ieee, u8 channel);\nconst struct libipw_channel *libipw_get_channel(struct libipw_device *ieee,\n\t\t\t\t\t\tu8 channel);\nu32 libipw_channel_to_freq(struct libipw_device *ieee, u8 channel);\n\n \nint libipw_wx_get_scan(struct libipw_device *ieee, struct iw_request_info *info,\n\t\t       union iwreq_data *wrqu, char *key);\nint libipw_wx_set_encode(struct libipw_device *ieee,\n\t\t\t struct iw_request_info *info, union iwreq_data *wrqu,\n\t\t\t char *key);\nint libipw_wx_get_encode(struct libipw_device *ieee,\n\t\t\t struct iw_request_info *info, union iwreq_data *wrqu,\n\t\t\t char *key);\nint libipw_wx_set_encodeext(struct libipw_device *ieee,\n\t\t\t    struct iw_request_info *info,\n\t\t\t    union iwreq_data *wrqu, char *extra);\nint libipw_wx_get_encodeext(struct libipw_device *ieee,\n\t\t\t    struct iw_request_info *info,\n\t\t\t    union iwreq_data *wrqu, char *extra);\n\nstatic inline void libipw_increment_scans(struct libipw_device *ieee)\n{\n\tieee->scans++;\n}\n\nstatic inline int libipw_get_scans(struct libipw_device *ieee)\n{\n\treturn ieee->scans;\n}\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}