{
  "module_name": "mt76x02_dfs.h",
  "hash_id": "322360e9afe501b55c21b91b9c4ea13ea2022913dfa762160fd2da1c7dd71736",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt76x02_dfs.h",
  "human_readable_source": " \n \n\n#ifndef __MT76x02_DFS_H\n#define __MT76x02_DFS_H\n\n#include <linux/types.h>\n#include <linux/nl80211.h>\n\n#define MT_DFS_GP_INTERVAL\t\t(10 << 4)  \n#define MT_DFS_NUM_ENGINES\t\t4\n\n \n#define MT_DFS_SYM_ROUND\t\t0\n#define MT_DFS_DELTA_DELAY\t\t2\n#define MT_DFS_VGA_MASK\t\t\t0\n#define MT_DFS_PWR_GAIN_OFFSET\t\t3\n#define MT_DFS_PWR_DOWN_TIME\t\t0xf\n#define MT_DFS_RX_PE_MASK\t\t0xff\n#define MT_DFS_PKT_END_MASK\t\t0\n#define MT_DFS_CH_EN\t\t\t0xf\n\n \n#define MT_DFS_EVENT_LOOP\t\t64\n#define MT_DFS_SW_TIMEOUT\t\t(HZ / 20)\n#define MT_DFS_EVENT_WINDOW\t\t(HZ / 5)\n#define MT_DFS_SEQUENCE_WINDOW\t\t(200 * (1 << 20))\n#define MT_DFS_EVENT_TIME_MARGIN\t2000\n#define MT_DFS_PRI_MARGIN\t\t4\n#define MT_DFS_SEQUENCE_TH\t\t6\n\n#define MT_DFS_FCC_MAX_PRI\t\t((28570 << 1) + 1000)\n#define MT_DFS_FCC_MIN_PRI\t\t(3000 - 2)\n#define MT_DFS_JP_MAX_PRI\t\t((80000 << 1) + 1000)\n#define MT_DFS_JP_MIN_PRI\t\t(28500 - 2)\n#define MT_DFS_ETSI_MAX_PRI\t\t(133333 + 125000 + 117647 + 1000)\n#define MT_DFS_ETSI_MIN_PRI\t\t(4500 - 20)\n\nstruct mt76x02_radar_specs {\n\tu8 mode;\n\tu16 avg_len;\n\tu16 e_low;\n\tu16 e_high;\n\tu16 w_low;\n\tu16 w_high;\n\tu16 w_margin;\n\tu32 t_low;\n\tu32 t_high;\n\tu16 t_margin;\n\tu32 b_low;\n\tu32 b_high;\n\tu32 event_expiration;\n\tu16 pwr_jmp;\n};\n\n#define MT_DFS_CHECK_EVENT(x)\t\t((x) != GENMASK(31, 0))\n#define MT_DFS_EVENT_ENGINE(x)\t\t(((x) & BIT(31)) ? 2 : 0)\n#define MT_DFS_EVENT_TIMESTAMP(x)\t((x) & GENMASK(21, 0))\n#define MT_DFS_EVENT_WIDTH(x)\t\t((x) & GENMASK(11, 0))\nstruct mt76x02_dfs_event {\n\tunsigned long fetch_ts;\n\tu32 ts;\n\tu16 width;\n\tu8 engine;\n};\n\n#define MT_DFS_EVENT_BUFLEN\t\t256\nstruct mt76x02_dfs_event_rb {\n\tstruct mt76x02_dfs_event data[MT_DFS_EVENT_BUFLEN];\n\tint h_rb, t_rb;\n};\n\nstruct mt76x02_dfs_sequence {\n\tstruct list_head head;\n\tu32 first_ts;\n\tu32 last_ts;\n\tu32 pri;\n\tu16 count;\n\tu8 engine;\n};\n\nstruct mt76x02_dfs_hw_pulse {\n\tu8 engine;\n\tu32 period;\n\tu32 w1;\n\tu32 w2;\n\tu32 burst;\n};\n\nstruct mt76x02_dfs_sw_detector_params {\n\tu32 min_pri;\n\tu32 max_pri;\n\tu32 pri_margin;\n};\n\nstruct mt76x02_dfs_engine_stats {\n\tu32 hw_pattern;\n\tu32 hw_pulse_discarded;\n\tu32 sw_pattern;\n};\n\nstruct mt76x02_dfs_seq_stats {\n\tu32 seq_pool_len;\n\tu32 seq_len;\n};\n\nstruct mt76x02_dfs_pattern_detector {\n\tu8 chirp_pulse_cnt;\n\tu32 chirp_pulse_ts;\n\n\tstruct mt76x02_dfs_sw_detector_params sw_dpd_params;\n\tstruct mt76x02_dfs_event_rb event_rb[2];\n\n\tstruct list_head sequences;\n\tstruct list_head seq_pool;\n\tstruct mt76x02_dfs_seq_stats seq_stats;\n\n\tunsigned long last_sw_check;\n\tu32 last_event_ts;\n\n\tstruct mt76x02_dfs_engine_stats stats[MT_DFS_NUM_ENGINES];\n\tstruct tasklet_struct dfs_tasklet;\n};\n\nvoid mt76x02_dfs_init_params(struct mt76x02_dev *dev);\nvoid mt76x02_dfs_init_detector(struct mt76x02_dev *dev);\nvoid mt76x02_regd_notifier(struct wiphy *wiphy,\n\t\t\t   struct regulatory_request *request);\nvoid mt76x02_phy_dfs_adjust_agc(struct mt76x02_dev *dev);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}