{
  "module_name": "mt7921.h",
  "hash_id": "f623b64a800acfdb20ee9742e7698fbacb78601520b2d5ec5216a19f4be15241",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt7921/mt7921.h",
  "human_readable_source": " \n \n\n#ifndef __MT7921_H\n#define __MT7921_H\n\n#include \"../mt792x.h\"\n#include \"regs.h\"\n\n#define MT7921_TX_RING_SIZE\t\t2048\n#define MT7921_TX_MCU_RING_SIZE\t\t256\n#define MT7921_TX_FWDL_RING_SIZE\t128\n\n#define MT7921_RX_RING_SIZE\t\t1536\n#define MT7921_RX_MCU_RING_SIZE\t\t512\n\n#define MT7921_EEPROM_SIZE\t\t3584\n#define MT7921_TOKEN_SIZE\t\t8192\n\n#define MT7921_EEPROM_BLOCK_SIZE\t16\n\n#define MT7921_SKU_RATE_NUM\t\t161\n#define MT7921_SKU_MAX_DELTA_IDX\tMT7921_SKU_RATE_NUM\n#define MT7921_SKU_TABLE_SIZE\t\t(MT7921_SKU_RATE_NUM + 1)\n\n#define MT7921_SDIO_HDR_TX_BYTES\tGENMASK(15, 0)\n#define MT7921_SDIO_HDR_PKT_TYPE\tGENMASK(17, 16)\n\n#define MCU_UNI_EVENT_ROC  0x27\n\nenum {\n\tUNI_ROC_ACQUIRE,\n\tUNI_ROC_ABORT,\n\tUNI_ROC_NUM\n};\n\nenum mt7921_roc_req {\n\tMT7921_ROC_REQ_JOIN,\n\tMT7921_ROC_REQ_ROC,\n\tMT7921_ROC_REQ_NUM\n};\n\nenum {\n\tUNI_EVENT_ROC_GRANT = 0,\n\tUNI_EVENT_ROC_TAG_NUM\n};\n\nstruct mt7921_realease_info {\n\t__le16 len;\n\tu8 pad_len;\n\tu8 tag;\n} __packed;\n\nstruct mt7921_fw_features {\n\tu8 segment;\n\tu8 data;\n\tu8 rsv[14];\n} __packed;\n\nstruct mt7921_roc_grant_tlv {\n\t__le16 tag;\n\t__le16 len;\n\tu8 bss_idx;\n\tu8 tokenid;\n\tu8 status;\n\tu8 primarychannel;\n\tu8 rfsco;\n\tu8 rfband;\n\tu8 channelwidth;\n\tu8 centerfreqseg1;\n\tu8 centerfreqseg2;\n\tu8 reqtype;\n\tu8 dbdcband;\n\tu8 rsv[1];\n\t__le32 max_interval;\n} __packed;\n\nenum mt7921_sdio_pkt_type {\n\tMT7921_SDIO_TXD,\n\tMT7921_SDIO_DATA,\n\tMT7921_SDIO_CMD,\n\tMT7921_SDIO_FWDL,\n};\n\nstruct mt7921_sdio_intr {\n\tu32 isr;\n\tstruct {\n\t\tu32 wtqcr[16];\n\t} tx;\n\tstruct {\n\t\tu16 num[2];\n\t\tu16 len0[16];\n\t\tu16 len1[128];\n\t} rx;\n\tu32 rec_mb[2];\n} __packed;\n\n#define to_rssi(field, rxv)\t\t((FIELD_GET(field, rxv) - 220) / 2)\n#define to_rcpi(rssi)\t\t\t(2 * (rssi) + 220)\n\nenum mt7921_txq_id {\n\tMT7921_TXQ_BAND0,\n\tMT7921_TXQ_BAND1,\n\tMT7921_TXQ_FWDL = 16,\n\tMT7921_TXQ_MCU_WM,\n};\n\nenum mt7921_rxq_id {\n\tMT7921_RXQ_BAND0 = 0,\n\tMT7921_RXQ_BAND1,\n\tMT7921_RXQ_MCU_WM = 0,\n};\n\nenum {\n\tMT7921_CLC_POWER,\n\tMT7921_CLC_CHAN,\n\tMT7921_CLC_MAX_NUM,\n};\n\nstruct mt7921_clc_rule {\n\tu8 alpha2[2];\n\tu8 type[2];\n\t__le16 len;\n\tu8 data[];\n} __packed;\n\nstruct mt7921_clc {\n\t__le32 len;\n\tu8 idx;\n\tu8 ver;\n\tu8 nr_country;\n\tu8 type;\n\tu8 rsv[8];\n\tu8 data[];\n} __packed;\n\nenum mt7921_eeprom_field {\n\tMT_EE_CHIP_ID =\t\t0x000,\n\tMT_EE_VERSION =\t\t0x002,\n\tMT_EE_MAC_ADDR =\t0x004,\n\tMT_EE_WIFI_CONF =\t0x07c,\n\tMT_EE_HW_TYPE =\t\t0x55b,\n\t__MT_EE_MAX =\t\t0x9ff\n};\n\n#define MT_EE_HW_TYPE_ENCAP\t\t\tBIT(0)\n\nenum {\n\tTXPWR_USER,\n\tTXPWR_EEPROM,\n\tTXPWR_MAC,\n\tTXPWR_MAX_NUM,\n};\n\nstruct mt7921_txpwr {\n\tu8 ch;\n\tu8 rsv[3];\n\tstruct {\n\t\tu8 ch;\n\t\tu8 cck[4];\n\t\tu8 ofdm[8];\n\t\tu8 ht20[8];\n\t\tu8 ht40[9];\n\t\tu8 vht20[12];\n\t\tu8 vht40[12];\n\t\tu8 vht80[12];\n\t\tu8 vht160[12];\n\t\tu8 he26[12];\n\t\tu8 he52[12];\n\t\tu8 he106[12];\n\t\tu8 he242[12];\n\t\tu8 he484[12];\n\t\tu8 he996[12];\n\t\tu8 he996x2[12];\n\t} data[TXPWR_MAX_NUM];\n};\n\nextern const struct ieee80211_ops mt7921_ops;\n\nu32 mt7921_reg_map(struct mt792x_dev *dev, u32 addr);\n\nint __mt7921_start(struct mt792x_phy *phy);\nint mt7921_register_device(struct mt792x_dev *dev);\nvoid mt7921_unregister_device(struct mt792x_dev *dev);\nint mt7921_run_firmware(struct mt792x_dev *dev);\nint mt7921_mcu_set_bss_pm(struct mt792x_dev *dev, struct ieee80211_vif *vif,\n\t\t\t  bool enable);\nint mt7921_mcu_sta_update(struct mt792x_dev *dev, struct ieee80211_sta *sta,\n\t\t\t  struct ieee80211_vif *vif, bool enable,\n\t\t\t  enum mt76_sta_info_state state);\nint mt7921_mcu_set_chan_info(struct mt792x_phy *phy, int cmd);\nint mt7921_mcu_set_tx(struct mt792x_dev *dev, struct ieee80211_vif *vif);\nint mt7921_mcu_set_eeprom(struct mt792x_dev *dev);\nint mt7921_mcu_get_rx_rate(struct mt792x_phy *phy, struct ieee80211_vif *vif,\n\t\t\t   struct ieee80211_sta *sta, struct rate_info *rate);\nint mt7921_mcu_fw_log_2_host(struct mt792x_dev *dev, u8 ctrl);\nvoid mt7921_mcu_rx_event(struct mt792x_dev *dev, struct sk_buff *skb);\nint mt7921_mcu_set_rxfilter(struct mt792x_dev *dev, u32 fif,\n\t\t\t    u8 bit_op, u32 bit_map);\n\nstatic inline u32\nmt7921_reg_map_l1(struct mt792x_dev *dev, u32 addr)\n{\n\tu32 offset = FIELD_GET(MT_HIF_REMAP_L1_OFFSET, addr);\n\tu32 base = FIELD_GET(MT_HIF_REMAP_L1_BASE, addr);\n\n\tmt76_rmw_field(dev, MT_HIF_REMAP_L1, MT_HIF_REMAP_L1_MASK, base);\n\t \n\tmt76_rr(dev, MT_HIF_REMAP_L1);\n\n\treturn MT_HIF_REMAP_BASE_L1 + offset;\n}\n\nstatic inline u32\nmt7921_l1_rr(struct mt792x_dev *dev, u32 addr)\n{\n\treturn mt76_rr(dev, mt7921_reg_map_l1(dev, addr));\n}\n\nstatic inline void\nmt7921_l1_wr(struct mt792x_dev *dev, u32 addr, u32 val)\n{\n\tmt76_wr(dev, mt7921_reg_map_l1(dev, addr), val);\n}\n\nstatic inline u32\nmt7921_l1_rmw(struct mt792x_dev *dev, u32 addr, u32 mask, u32 val)\n{\n\tval |= mt7921_l1_rr(dev, addr) & ~mask;\n\tmt7921_l1_wr(dev, addr, val);\n\n\treturn val;\n}\n\n#define mt7921_l1_set(dev, addr, val)\tmt7921_l1_rmw(dev, addr, 0, val)\n#define mt7921_l1_clear(dev, addr, val)\tmt7921_l1_rmw(dev, addr, val, 0)\n\nstatic inline void\nmt7921_skb_add_usb_sdio_hdr(struct mt792x_dev *dev, struct sk_buff *skb,\n\t\t\t    int type)\n{\n\tu32 hdr, len;\n\n\tlen = mt76_is_usb(&dev->mt76) ? skb->len : skb->len + sizeof(hdr);\n\thdr = FIELD_PREP(MT7921_SDIO_HDR_TX_BYTES, len) |\n\t      FIELD_PREP(MT7921_SDIO_HDR_PKT_TYPE, type);\n\n\tput_unaligned_le32(hdr, skb_push(skb, sizeof(hdr)));\n}\n\nvoid mt7921_stop(struct ieee80211_hw *hw);\nint mt7921_mac_init(struct mt792x_dev *dev);\nbool mt7921_mac_wtbl_update(struct mt792x_dev *dev, int idx, u32 mask);\nint mt7921_mac_sta_add(struct mt76_dev *mdev, struct ieee80211_vif *vif,\n\t\t       struct ieee80211_sta *sta);\nvoid mt7921_mac_sta_assoc(struct mt76_dev *mdev, struct ieee80211_vif *vif,\n\t\t\t  struct ieee80211_sta *sta);\nvoid mt7921_mac_sta_remove(struct mt76_dev *mdev, struct ieee80211_vif *vif,\n\t\t\t   struct ieee80211_sta *sta);\nvoid mt7921_mac_reset_work(struct work_struct *work);\nint mt7921e_tx_prepare_skb(struct mt76_dev *mdev, void *txwi_ptr,\n\t\t\t   enum mt76_txq_id qid, struct mt76_wcid *wcid,\n\t\t\t   struct ieee80211_sta *sta,\n\t\t\t   struct mt76_tx_info *tx_info);\n\nbool mt7921_rx_check(struct mt76_dev *mdev, void *data, int len);\nvoid mt7921_queue_rx_skb(struct mt76_dev *mdev, enum mt76_rxq_id q,\n\t\t\t struct sk_buff *skb, u32 *info);\nvoid mt7921_stats_work(struct work_struct *work);\nvoid mt7921_set_stream_he_caps(struct mt792x_phy *phy);\nint mt7921_init_debugfs(struct mt792x_dev *dev);\n\nint mt7921_mcu_set_beacon_filter(struct mt792x_dev *dev,\n\t\t\t\t struct ieee80211_vif *vif,\n\t\t\t\t bool enable);\nint mt7921_mcu_uni_tx_ba(struct mt792x_dev *dev,\n\t\t\t struct ieee80211_ampdu_params *params,\n\t\t\t bool enable);\nint mt7921_mcu_uni_rx_ba(struct mt792x_dev *dev,\n\t\t\t struct ieee80211_ampdu_params *params,\n\t\t\t bool enable);\nvoid mt7921_scan_work(struct work_struct *work);\nvoid mt7921_roc_work(struct work_struct *work);\nint mt7921_mcu_uni_bss_ps(struct mt792x_dev *dev, struct ieee80211_vif *vif);\nvoid mt7921_coredump_work(struct work_struct *work);\nint mt7921_get_txpwr_info(struct mt792x_dev *dev, struct mt7921_txpwr *txpwr);\nint mt7921_testmode_cmd(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t\tvoid *data, int len);\nint mt7921_testmode_dump(struct ieee80211_hw *hw, struct sk_buff *msg,\n\t\t\t struct netlink_callback *cb, void *data, int len);\nint mt7921_mcu_parse_response(struct mt76_dev *mdev, int cmd,\n\t\t\t      struct sk_buff *skb, int seq);\n\nint mt7921e_driver_own(struct mt792x_dev *dev);\nint mt7921e_mac_reset(struct mt792x_dev *dev);\nint mt7921e_mcu_init(struct mt792x_dev *dev);\nint mt7921s_wfsys_reset(struct mt792x_dev *dev);\nint mt7921s_mac_reset(struct mt792x_dev *dev);\nint mt7921s_init_reset(struct mt792x_dev *dev);\n\nint mt7921s_mcu_init(struct mt792x_dev *dev);\nint mt7921s_mcu_drv_pmctrl(struct mt792x_dev *dev);\nint mt7921s_mcu_fw_pmctrl(struct mt792x_dev *dev);\nvoid mt7921_mac_add_txs(struct mt792x_dev *dev, void *data);\nvoid mt7921_set_runtime_pm(struct mt792x_dev *dev);\nvoid mt7921_mcu_set_suspend_iter(void *priv, u8 *mac,\n\t\t\t\t struct ieee80211_vif *vif);\nvoid mt7921_set_ipv6_ns_work(struct work_struct *work);\n\nint mt7921_mcu_set_sniffer(struct mt792x_dev *dev, struct ieee80211_vif *vif,\n\t\t\t   bool enable);\nint mt7921_mcu_config_sniffer(struct mt792x_vif *vif,\n\t\t\t      struct ieee80211_chanctx_conf *ctx);\nint mt7921_mcu_get_temperature(struct mt792x_phy *phy);\n\nint mt7921_usb_sdio_tx_prepare_skb(struct mt76_dev *mdev, void *txwi_ptr,\n\t\t\t\t   enum mt76_txq_id qid, struct mt76_wcid *wcid,\n\t\t\t\t   struct ieee80211_sta *sta,\n\t\t\t\t   struct mt76_tx_info *tx_info);\nvoid mt7921_usb_sdio_tx_complete_skb(struct mt76_dev *mdev,\n\t\t\t\t     struct mt76_queue_entry *e);\nbool mt7921_usb_sdio_tx_status_data(struct mt76_dev *mdev, u8 *update);\n\n \nint mt7921_mcu_uni_add_beacon_offload(struct mt792x_dev *dev,\n\t\t\t\t      struct ieee80211_hw *hw,\n\t\t\t\t      struct ieee80211_vif *vif,\n\t\t\t\t      bool enable);\nint mt7921_set_tx_sar_pwr(struct ieee80211_hw *hw,\n\t\t\t  const struct cfg80211_sar_specs *sar);\n\nint mt7921_mcu_set_clc(struct mt792x_dev *dev, u8 *alpha2,\n\t\t       enum environment_cap env_cap);\nint mt7921_mcu_set_roc(struct mt792x_phy *phy, struct mt792x_vif *vif,\n\t\t       struct ieee80211_channel *chan, int duration,\n\t\t       enum mt7921_roc_req type, u8 token_id);\nint mt7921_mcu_abort_roc(struct mt792x_phy *phy, struct mt792x_vif *vif,\n\t\t\t u8 token_id);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}