{
  "module_name": "mt792x.h",
  "hash_id": "caa2888ee1463743e3a69d8bdd8a614913aa9f8fd38e38189af9d7db40288909",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt792x.h",
  "human_readable_source": " \n \n\n#ifndef __MT792X_H\n#define __MT792X_H\n\n#include <linux/interrupt.h>\n#include <linux/ktime.h>\n\n#include \"mt76_connac_mcu.h\"\n#include \"mt792x_regs.h\"\n#include \"mt792x_acpi_sar.h\"\n\n#define MT792x_PM_TIMEOUT\t(HZ / 12)\n#define MT792x_HW_SCAN_TIMEOUT\t(HZ / 10)\n\n#define MT792x_MAX_INTERFACES\t4\n#define MT792x_WTBL_SIZE\t20\n#define MT792x_WTBL_RESERVED\t(MT792x_WTBL_SIZE - 1)\n#define MT792x_WTBL_STA\t\t(MT792x_WTBL_RESERVED - MT792x_MAX_INTERFACES)\n\n#define MT792x_CFEND_RATE_DEFAULT\t0x49\t \n#define MT792x_CFEND_RATE_11B\t\t0x03\t \n\n#define MT792x_FW_TAG_FEATURE\t4\n#define MT792x_FW_CAP_CNM\tBIT(7)\n\n \n#define MT792x_BASIC_RATES_TBL\t11\n\n#define MT792x_WATCHDOG_TIME\t(HZ / 4)\n\n#define MT792x_DRV_OWN_RETRY_COUNT\t10\n#define MT792x_MCU_INIT_RETRY_COUNT\t10\n#define MT792x_WFSYS_INIT_RETRY_COUNT\t2\n\n#define MT7921_FIRMWARE_WM\t\"mediatek/WIFI_RAM_CODE_MT7961_1.bin\"\n#define MT7922_FIRMWARE_WM\t\"mediatek/WIFI_RAM_CODE_MT7922_1.bin\"\n\n#define MT7921_ROM_PATCH\t\"mediatek/WIFI_MT7961_patch_mcu_1_2_hdr.bin\"\n#define MT7922_ROM_PATCH\t\"mediatek/WIFI_MT7922_patch_mcu_1_1_hdr.bin\"\n\nstruct mt792x_vif;\nstruct mt792x_sta;\n\nstruct mt792x_realease_info {\n\t__le16 len;\n\tu8 pad_len;\n\tu8 tag;\n} __packed;\n\nstruct mt792x_fw_features {\n\tu8 segment;\n\tu8 data;\n\tu8 rsv[14];\n} __packed;\n\nenum {\n\tMT792x_CLC_POWER,\n\tMT792x_CLC_CHAN,\n\tMT792x_CLC_MAX_NUM,\n};\n\nDECLARE_EWMA(avg_signal, 10, 8)\n\nstruct mt792x_sta {\n\tstruct mt76_wcid wcid;  \n\n\tstruct mt792x_vif *vif;\n\n\tu32 airtime_ac[8];\n\n\tint ack_signal;\n\tstruct ewma_avg_signal avg_ack_signal;\n\n\tunsigned long last_txs;\n\n\tstruct mt76_connac_sta_key_conf bip;\n};\n\nDECLARE_EWMA(rssi, 10, 8);\n\nstruct mt792x_vif {\n\tstruct mt76_vif mt76;  \n\n\tstruct mt792x_sta sta;\n\tstruct mt792x_sta *wep_sta;\n\n\tstruct mt792x_phy *phy;\n\n\tstruct ewma_rssi rssi;\n\n\tstruct ieee80211_tx_queue_params queue_params[IEEE80211_NUM_ACS];\n};\n\nstruct mt792x_phy {\n\tstruct mt76_phy *mt76;\n\tstruct mt792x_dev *dev;\n\n\tstruct ieee80211_sband_iftype_data iftype[NUM_NL80211_BANDS][NUM_NL80211_IFTYPES];\n\n\tu64 omac_mask;\n\n\tu16 noise;\n\n\ts16 coverage_class;\n\tu8 slottime;\n\n\tu32 rx_ampdu_ts;\n\tu32 ampdu_ref;\n\n\tstruct mt76_mib_stats mib;\n\n\tu8 sta_work_count;\n\n\tstruct sk_buff_head scan_event_list;\n\tstruct delayed_work scan_work;\n#ifdef CONFIG_ACPI\n\tvoid *acpisar;\n#endif\n\tvoid *clc[MT792x_CLC_MAX_NUM];\n\n\tstruct work_struct roc_work;\n\tstruct timer_list roc_timer;\n\twait_queue_head_t roc_wait;\n\tu8 roc_token_id;\n\tbool roc_grant;\n};\n\nstruct mt792x_irq_map {\n\tu32 host_irq_enable;\n\tstruct {\n\t\tu32 all_complete_mask;\n\t\tu32 mcu_complete_mask;\n\t} tx;\n\tstruct {\n\t\tu32 data_complete_mask;\n\t\tu32 wm_complete_mask;\n\t\tu32 wm2_complete_mask;\n\t} rx;\n};\n\n#define mt792x_init_reset(dev)\t\t((dev)->hif_ops->init_reset(dev))\n#define mt792x_dev_reset(dev)\t\t((dev)->hif_ops->reset(dev))\n#define mt792x_mcu_init(dev)\t\t((dev)->hif_ops->mcu_init(dev))\n#define __mt792x_mcu_drv_pmctrl(dev)\t((dev)->hif_ops->drv_own(dev))\n#define\t__mt792x_mcu_fw_pmctrl(dev)\t((dev)->hif_ops->fw_own(dev))\n\nstruct mt792x_hif_ops {\n\tint (*init_reset)(struct mt792x_dev *dev);\n\tint (*reset)(struct mt792x_dev *dev);\n\tint (*mcu_init)(struct mt792x_dev *dev);\n\tint (*drv_own)(struct mt792x_dev *dev);\n\tint (*fw_own)(struct mt792x_dev *dev);\n};\n\nstruct mt792x_dev {\n\tunion {  \n\t\tstruct mt76_dev mt76;\n\t\tstruct mt76_phy mphy;\n\t};\n\n\tconst struct mt76_bus_ops *bus_ops;\n\tstruct mt792x_phy phy;\n\n\tstruct work_struct reset_work;\n\tbool hw_full_reset:1;\n\tbool hw_init_done:1;\n\tbool fw_assert:1;\n\tbool has_eht:1;\n\n\tstruct work_struct init_work;\n\n\tu8 fw_debug;\n\tu8 fw_features;\n\n\tstruct mt76_connac_pm pm;\n\tstruct mt76_connac_coredump coredump;\n\tconst struct mt792x_hif_ops *hif_ops;\n\tconst struct mt792x_irq_map *irq_map;\n\n\tstruct work_struct ipv6_ns_work;\n\t \n\tstruct sk_buff_head ipv6_ns_list;\n\n\tenum environment_cap country_ie_env;\n\tu32 backup_l1;\n\tu32 backup_l2;\n};\n\nstatic inline struct mt792x_dev *\nmt792x_hw_dev(struct ieee80211_hw *hw)\n{\n\tstruct mt76_phy *phy = hw->priv;\n\n\treturn container_of(phy->dev, struct mt792x_dev, mt76);\n}\n\nstatic inline struct mt792x_phy *\nmt792x_hw_phy(struct ieee80211_hw *hw)\n{\n\tstruct mt76_phy *phy = hw->priv;\n\n\treturn phy->priv;\n}\n\nstatic inline void\nmt792x_get_status_freq_info(struct mt76_rx_status *status, u8 chfreq)\n{\n\tif (chfreq > 180) {\n\t\tstatus->band = NL80211_BAND_6GHZ;\n\t\tchfreq = (chfreq - 181) * 4 + 1;\n\t} else if (chfreq > 14) {\n\t\tstatus->band = NL80211_BAND_5GHZ;\n\t} else {\n\t\tstatus->band = NL80211_BAND_2GHZ;\n\t}\n\tstatus->freq = ieee80211_channel_to_frequency(chfreq, status->band);\n}\n\nstatic inline bool mt792x_dma_need_reinit(struct mt792x_dev *dev)\n{\n\treturn !mt76_get_field(dev, MT_WFDMA_DUMMY_CR, MT_WFDMA_NEED_REINIT);\n}\n\n#define mt792x_mutex_acquire(dev)\t\\\n\tmt76_connac_mutex_acquire(&(dev)->mt76, &(dev)->pm)\n#define mt792x_mutex_release(dev)\t\\\n\tmt76_connac_mutex_release(&(dev)->mt76, &(dev)->pm)\n\nvoid mt792x_pm_wake_work(struct work_struct *work);\nvoid mt792x_pm_power_save_work(struct work_struct *work);\nvoid mt792x_reset(struct mt76_dev *mdev);\nvoid mt792x_update_channel(struct mt76_phy *mphy);\nvoid mt792x_mac_reset_counters(struct mt792x_phy *phy);\nvoid mt792x_mac_init_band(struct mt792x_dev *dev, u8 band);\nvoid mt792x_mac_assoc_rssi(struct mt792x_dev *dev, struct sk_buff *skb);\nstruct mt76_wcid *mt792x_rx_get_wcid(struct mt792x_dev *dev, u16 idx,\n\t\t\t\t     bool unicast);\nvoid mt792x_mac_update_mib_stats(struct mt792x_phy *phy);\nvoid mt792x_mac_set_timeing(struct mt792x_phy *phy);\nvoid mt792x_mac_work(struct work_struct *work);\nvoid mt792x_remove_interface(struct ieee80211_hw *hw,\n\t\t\t     struct ieee80211_vif *vif);\nvoid mt792x_tx(struct ieee80211_hw *hw, struct ieee80211_tx_control *control,\n\t       struct sk_buff *skb);\nint mt792x_conf_tx(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t   unsigned int link_id, u16 queue,\n\t\t   const struct ieee80211_tx_queue_params *params);\nint mt792x_get_stats(struct ieee80211_hw *hw,\n\t\t     struct ieee80211_low_level_stats *stats);\nu64 mt792x_get_tsf(struct ieee80211_hw *hw, struct ieee80211_vif *vif);\nvoid mt792x_set_tsf(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t    u64 timestamp);\nvoid mt792x_tx_worker(struct mt76_worker *w);\nvoid mt792x_roc_timer(struct timer_list *timer);\nvoid mt792x_flush(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t  u32 queues, bool drop);\nint mt792x_assign_vif_chanctx(struct ieee80211_hw *hw,\n\t\t\t      struct ieee80211_vif *vif,\n\t\t\t      struct ieee80211_bss_conf *link_conf,\n\t\t\t      struct ieee80211_chanctx_conf *ctx);\nvoid mt792x_unassign_vif_chanctx(struct ieee80211_hw *hw,\n\t\t\t\t struct ieee80211_vif *vif,\n\t\t\t\t struct ieee80211_bss_conf *link_conf,\n\t\t\t\t struct ieee80211_chanctx_conf *ctx);\nvoid mt792x_set_wakeup(struct ieee80211_hw *hw, bool enabled);\nvoid mt792x_get_et_strings(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t\t   u32 sset, u8 *data);\nint mt792x_get_et_sset_count(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t\t     int sset);\nvoid mt792x_get_et_stats(struct ieee80211_hw *hw, struct ieee80211_vif *vif,\n\t\t\t struct ethtool_stats *stats, u64 *data);\nvoid mt792x_sta_statistics(struct ieee80211_hw *hw,\n\t\t\t   struct ieee80211_vif *vif,\n\t\t\t   struct ieee80211_sta *sta,\n\t\t\t   struct station_info *sinfo);\nvoid mt792x_set_coverage_class(struct ieee80211_hw *hw, s16 coverage_class);\nvoid mt792x_dma_cleanup(struct mt792x_dev *dev);\nint mt792x_dma_enable(struct mt792x_dev *dev);\nint mt792x_wpdma_reset(struct mt792x_dev *dev, bool force);\nint mt792x_wpdma_reinit_cond(struct mt792x_dev *dev);\nint mt792x_dma_disable(struct mt792x_dev *dev, bool force);\nirqreturn_t mt792x_irq_handler(int irq, void *dev_instance);\nvoid mt792x_rx_poll_complete(struct mt76_dev *mdev, enum mt76_rxq_id q);\nint mt792x_poll_tx(struct napi_struct *napi, int budget);\nint mt792x_poll_rx(struct napi_struct *napi, int budget);\nvoid mt792x_irq_tasklet(unsigned long data);\nint mt792x_wfsys_reset(struct mt792x_dev *dev);\nint mt792x_tx_stats_show(struct seq_file *file, void *data);\nint mt792x_queues_acq(struct seq_file *s, void *data);\nint mt792x_queues_read(struct seq_file *s, void *data);\nint mt792x_pm_stats(struct seq_file *s, void *data);\nint mt792x_pm_idle_timeout_set(void *data, u64 val);\nint mt792x_pm_idle_timeout_get(void *data, u64 *val);\nint mt792x_init_wiphy(struct ieee80211_hw *hw);\nstruct ieee80211_ops *\nmt792x_get_mac80211_ops(struct device *dev,\n\t\t\tconst struct ieee80211_ops *mac80211_ops,\n\t\t\tvoid *drv_data, u8 *fw_features);\nint mt792x_init_wcid(struct mt792x_dev *dev);\nint mt792x_mcu_drv_pmctrl(struct mt792x_dev *dev);\nint mt792x_mcu_fw_pmctrl(struct mt792x_dev *dev);\n\nstatic inline char *mt792x_ram_name(struct mt792x_dev *dev)\n{\n\tswitch (mt76_chip(&dev->mt76)) {\n\tcase 0x7922:\n\t\treturn MT7922_FIRMWARE_WM;\n\tdefault:\n\t\treturn MT7921_FIRMWARE_WM;\n\t}\n}\n\nstatic inline char *mt792x_patch_name(struct mt792x_dev *dev)\n{\n\tswitch (mt76_chip(&dev->mt76)) {\n\tcase 0x7922:\n\t\treturn MT7922_ROM_PATCH;\n\tdefault:\n\t\treturn MT7921_ROM_PATCH;\n\t}\n}\n\nint mt792x_load_firmware(struct mt792x_dev *dev);\n\n \n#define MT_USB_TYPE_VENDOR\t(USB_TYPE_VENDOR | 0x1f)\n#define MT_USB_TYPE_UHW_VENDOR\t(USB_TYPE_VENDOR | 0x1e)\nint mt792xu_dma_init(struct mt792x_dev *dev, bool resume);\nint mt792xu_mcu_power_on(struct mt792x_dev *dev);\nint mt792xu_wfsys_reset(struct mt792x_dev *dev);\nint mt792xu_init_reset(struct mt792x_dev *dev);\nu32 mt792xu_rr(struct mt76_dev *dev, u32 addr);\nvoid mt792xu_wr(struct mt76_dev *dev, u32 addr, u32 val);\nu32 mt792xu_rmw(struct mt76_dev *dev, u32 addr, u32 mask, u32 val);\nvoid mt792xu_copy(struct mt76_dev *dev, u32 offset, const void *data, int len);\nvoid mt792xu_disconnect(struct usb_interface *usb_intf);\n\nint __mt792xe_mcu_drv_pmctrl(struct mt792x_dev *dev);\nint mt792xe_mcu_drv_pmctrl(struct mt792x_dev *dev);\nint mt792xe_mcu_fw_pmctrl(struct mt792x_dev *dev);\n\n#ifdef CONFIG_ACPI\nint mt792x_init_acpi_sar(struct mt792x_dev *dev);\nint mt792x_init_acpi_sar_power(struct mt792x_phy *phy, bool set_default);\nu8 mt792x_acpi_get_flags(struct mt792x_phy *phy);\n#else\nstatic inline int mt792x_init_acpi_sar(struct mt792x_dev *dev)\n{\n\treturn 0;\n}\n\nstatic inline int mt792x_init_acpi_sar_power(struct mt792x_phy *phy,\n\t\t\t\t\t     bool set_default)\n{\n\treturn 0;\n}\n\nstatic inline u8 mt792x_acpi_get_flags(struct mt792x_phy *phy)\n{\n\treturn 0;\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}