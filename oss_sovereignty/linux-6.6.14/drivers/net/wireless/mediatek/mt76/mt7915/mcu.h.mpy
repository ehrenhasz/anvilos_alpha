{
  "module_name": "mcu.h",
  "hash_id": "3e121b43d2810cd90bd94c3c5dbd8910eb6265940f5790cd0f890fa7821cdebc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt7915/mcu.h",
  "human_readable_source": " \n \n\n#ifndef __MT7915_MCU_H\n#define __MT7915_MCU_H\n\n#include \"../mt76_connac_mcu.h\"\n\nenum {\n\tMCU_ATE_SET_TRX = 0x1,\n\tMCU_ATE_SET_FREQ_OFFSET = 0xa,\n\tMCU_ATE_SET_SLOT_TIME = 0x13,\n\tMCU_ATE_CLEAN_TXQUEUE = 0x1c,\n};\n\nstruct mt7915_mcu_thermal_ctrl {\n\tu8 ctrl_id;\n\tu8 band_idx;\n\tunion {\n\t\tstruct {\n\t\t\tu8 protect_type;  \n\t\t\tu8 trigger_type;  \n\t\t} __packed type;\n\t\tstruct {\n\t\t\tu8 duty_level;\t \n\t\t\tu8 duty_cycle;\n\t\t} __packed duty;\n\t};\n} __packed;\n\nstruct mt7915_mcu_thermal_notify {\n\tstruct mt76_connac2_mcu_rxd rxd;\n\n\tstruct mt7915_mcu_thermal_ctrl ctrl;\n\t__le32 temperature;\n\tu8 rsv[8];\n} __packed;\n\nstruct mt7915_mcu_csa_notify {\n\tstruct mt76_connac2_mcu_rxd rxd;\n\n\tu8 omac_idx;\n\tu8 csa_count;\n\tu8 band_idx;\n\tu8 rsv;\n} __packed;\n\nstruct mt7915_mcu_bcc_notify {\n\tstruct mt76_connac2_mcu_rxd rxd;\n\n\tu8 band_idx;\n\tu8 omac_idx;\n\tu8 cca_count;\n\tu8 rsv;\n} __packed;\n\nstruct mt7915_mcu_rdd_report {\n\tstruct mt76_connac2_mcu_rxd rxd;\n\n\tu8 band_idx;\n\tu8 long_detected;\n\tu8 constant_prf_detected;\n\tu8 staggered_prf_detected;\n\tu8 radar_type_idx;\n\tu8 periodic_pulse_num;\n\tu8 long_pulse_num;\n\tu8 hw_pulse_num;\n\n\tu8 out_lpn;\n\tu8 out_spn;\n\tu8 out_crpn;\n\tu8 out_crpw;\n\tu8 out_crbn;\n\tu8 out_stgpn;\n\tu8 out_stgpw;\n\n\tu8 rsv;\n\n\t__le32 out_pri_const;\n\t__le32 out_pri_stg[3];\n\n\tstruct {\n\t\t__le32 start;\n\t\t__le16 pulse_width;\n\t\t__le16 pulse_power;\n\t\tu8 mdrdy_flag;\n\t\tu8 rsv[3];\n\t} long_pulse[32];\n\n\tstruct {\n\t\t__le32 start;\n\t\t__le16 pulse_width;\n\t\t__le16 pulse_power;\n\t\tu8 mdrdy_flag;\n\t\tu8 rsv[3];\n\t} periodic_pulse[32];\n\n\tstruct {\n\t\t__le32 start;\n\t\t__le16 pulse_width;\n\t\t__le16 pulse_power;\n\t\tu8 sc_pass;\n\t\tu8 sw_reset;\n\t\tu8 mdrdy_flag;\n\t\tu8 tx_active;\n\t} hw_pulse[32];\n} __packed;\n\nstruct mt7915_mcu_background_chain_ctrl {\n\tu8 chan;\t\t \n\tu8 central_chan;\t \n\tu8 bw;\n\tu8 tx_stream;\n\tu8 rx_stream;\n\n\tu8 monitor_chan;\t \n\tu8 monitor_central_chan; \n\tu8 monitor_bw;\n\tu8 monitor_tx_stream;\n\tu8 monitor_rx_stream;\n\n\tu8 scan_mode;\t\t \n\tu8 band_idx;\t\t \n\tu8 monitor_scan_type;\n\tu8 band;\t\t \n\tu8 rsv[2];\n} __packed;\n\nstruct mt7915_mcu_sr_ctrl {\n\tu8 action;\n\tu8 argnum;\n\tu8 band_idx;\n\tu8 status;\n\tu8 drop_ta_idx;\n\tu8 sta_idx;\t \n\tu8 rsv[2];\n\t__le32 val;\n} __packed;\n\nstruct mt7915_mcu_eeprom {\n\tu8 buffer_mode;\n\tu8 format;\n\t__le16 len;\n} __packed;\n\nstruct mt7915_mcu_eeprom_info {\n\t__le32 addr;\n\t__le32 valid;\n\tu8 data[16];\n} __packed;\n\nstruct mt7915_mcu_phy_rx_info {\n\tu8 category;\n\tu8 rate;\n\tu8 mode;\n\tu8 nsts;\n\tu8 gi;\n\tu8 coding;\n\tu8 stbc;\n\tu8 bw;\n};\n\nstruct mt7915_mcu_mib {\n\t__le32 band;\n\t__le32 offs;\n\t__le64 data;\n} __packed;\n\nenum mt7915_chan_mib_offs {\n\t \n\tMIB_TX_TIME = 81,\n\tMIB_RX_TIME,\n\tMIB_OBSS_AIRTIME = 86,\n\tMIB_NON_WIFI_TIME,\n\tMIB_TXOP_INIT_COUNT,\n\n\t \n\tMIB_TX_TIME_V2 = 6,\n\tMIB_RX_TIME_V2 = 8,\n\tMIB_OBSS_AIRTIME_V2 = 490,\n\tMIB_NON_WIFI_TIME_V2\n};\n\nstruct mt7915_mcu_txpower_sku {\n\tu8 format_id;\n\tu8 limit_type;\n\tu8 band_idx;\n\ts8 txpower_sku[MT7915_SKU_RATE_NUM];\n} __packed;\n\nstruct edca {\n\tu8 queue;\n\tu8 set;\n\tu8 aifs;\n\tu8 cw_min;\n\t__le16 cw_max;\n\t__le16 txop;\n};\n\nstruct mt7915_mcu_tx {\n\tu8 total;\n\tu8 action;\n\tu8 valid;\n\tu8 mode;\n\n\tstruct edca edca[IEEE80211_NUM_ACS];\n} __packed;\n\nstruct mt7915_mcu_muru_stats {\n\t__le32 event_id;\n\tstruct {\n\t\t__le32 cck_cnt;\n\t\t__le32 ofdm_cnt;\n\t\t__le32 htmix_cnt;\n\t\t__le32 htgf_cnt;\n\t\t__le32 vht_su_cnt;\n\t\t__le32 vht_2mu_cnt;\n\t\t__le32 vht_3mu_cnt;\n\t\t__le32 vht_4mu_cnt;\n\t\t__le32 he_su_cnt;\n\t\t__le32 he_ext_su_cnt;\n\t\t__le32 he_2ru_cnt;\n\t\t__le32 he_2mu_cnt;\n\t\t__le32 he_3ru_cnt;\n\t\t__le32 he_3mu_cnt;\n\t\t__le32 he_4ru_cnt;\n\t\t__le32 he_4mu_cnt;\n\t\t__le32 he_5to8ru_cnt;\n\t\t__le32 he_9to16ru_cnt;\n\t\t__le32 he_gtr16ru_cnt;\n\t} dl;\n\n\tstruct {\n\t\t__le32 hetrig_su_cnt;\n\t\t__le32 hetrig_2ru_cnt;\n\t\t__le32 hetrig_3ru_cnt;\n\t\t__le32 hetrig_4ru_cnt;\n\t\t__le32 hetrig_5to8ru_cnt;\n\t\t__le32 hetrig_9to16ru_cnt;\n\t\t__le32 hetrig_gtr16ru_cnt;\n\t\t__le32 hetrig_2mu_cnt;\n\t\t__le32 hetrig_3mu_cnt;\n\t\t__le32 hetrig_4mu_cnt;\n\t} ul;\n};\n\n#define WMM_AIFS_SET\t\tBIT(0)\n#define WMM_CW_MIN_SET\t\tBIT(1)\n#define WMM_CW_MAX_SET\t\tBIT(2)\n#define WMM_TXOP_SET\t\tBIT(3)\n#define WMM_PARAM_SET\t\tGENMASK(3, 0)\n\nenum {\n\tMCU_FW_LOG_WM,\n\tMCU_FW_LOG_WA,\n\tMCU_FW_LOG_TO_HOST,\n};\n\nenum {\n\tMCU_TWT_AGRT_ADD,\n\tMCU_TWT_AGRT_MODIFY,\n\tMCU_TWT_AGRT_DELETE,\n\tMCU_TWT_AGRT_TEARDOWN,\n\tMCU_TWT_AGRT_GET_TSF,\n};\n\nenum {\n\tMCU_WA_PARAM_CMD_QUERY,\n\tMCU_WA_PARAM_CMD_SET,\n\tMCU_WA_PARAM_CMD_CAPABILITY,\n\tMCU_WA_PARAM_CMD_DEBUG,\n};\n\nenum {\n\tMCU_WA_PARAM_PDMA_RX = 0x04,\n\tMCU_WA_PARAM_CPU_UTIL = 0x0b,\n\tMCU_WA_PARAM_RED = 0x0e,\n\tMCU_WA_PARAM_RED_SETTING = 0x40,\n};\n\nenum mcu_mmps_mode {\n\tMCU_MMPS_STATIC,\n\tMCU_MMPS_DYNAMIC,\n\tMCU_MMPS_RSV,\n\tMCU_MMPS_DISABLE,\n};\n\nstruct bss_info_bmc_rate {\n\t__le16 tag;\n\t__le16 len;\n\t__le16 bc_trans;\n\t__le16 mc_trans;\n\tu8 short_preamble;\n\tu8 rsv[7];\n} __packed;\n\nstruct bss_info_ra {\n\t__le16 tag;\n\t__le16 len;\n\tu8 op_mode;\n\tu8 adhoc_en;\n\tu8 short_preamble;\n\tu8 tx_streams;\n\tu8 rx_streams;\n\tu8 algo;\n\tu8 force_sgi;\n\tu8 force_gf;\n\tu8 ht_mode;\n\tu8 has_20_sta;\t\t \n\tu8 bss_width_trigger_events;\n\tu8 vht_nss_cap;\n\tu8 vht_bw_signal;\t \n\tu8 vht_force_sgi;\t \n\tu8 se_off;\n\tu8 antenna_idx;\n\tu8 train_up_rule;\n\tu8 rsv[3];\n\tunsigned short train_up_high_thres;\n\tshort train_up_rule_rssi;\n\tunsigned short low_traffic_thres;\n\t__le16 max_phyrate;\n\t__le32 phy_cap;\n\t__le32 interval;\n\t__le32 fast_interval;\n} __packed;\n\nstruct bss_info_hw_amsdu {\n\t__le16 tag;\n\t__le16 len;\n\t__le32 cmp_bitmap_0;\n\t__le32 cmp_bitmap_1;\n\t__le16 trig_thres;\n\tu8 enable;\n\tu8 rsv;\n} __packed;\n\nstruct bss_info_color {\n\t__le16 tag;\n\t__le16 len;\n\tu8 disable;\n\tu8 color;\n\tu8 rsv[2];\n} __packed;\n\nstruct bss_info_he {\n\t__le16 tag;\n\t__le16 len;\n\tu8 he_pe_duration;\n\tu8 vht_op_info_present;\n\t__le16 he_rts_thres;\n\t__le16 max_nss_mcs[CMD_HE_MCS_BW_NUM];\n\tu8 rsv[6];\n} __packed;\n\nstruct bss_info_bcn {\n\t__le16 tag;\n\t__le16 len;\n\tu8 ver;\n\tu8 enable;\n\t__le16 sub_ntlv;\n} __packed __aligned(4);\n\nstruct bss_info_bcn_cntdwn {\n\t__le16 tag;\n\t__le16 len;\n\tu8 cnt;\n\tu8 rsv[3];\n} __packed __aligned(4);\n\nstruct bss_info_bcn_mbss {\n#define MAX_BEACON_NUM\t32\n\t__le16 tag;\n\t__le16 len;\n\t__le32 bitmap;\n\t__le16 offset[MAX_BEACON_NUM];\n\tu8 rsv[8];\n} __packed __aligned(4);\n\nstruct bss_info_bcn_cont {\n\t__le16 tag;\n\t__le16 len;\n\t__le16 tim_ofs;\n\t__le16 csa_ofs;\n\t__le16 bcc_ofs;\n\t__le16 pkt_len;\n} __packed __aligned(4);\n\nstruct bss_info_inband_discovery {\n\t__le16 tag;\n\t__le16 len;\n\tu8 tx_type;\n\tu8 tx_mode;\n\tu8 tx_interval;\n\tu8 enable;\n\t__le16 rsv;\n\t__le16 prob_rsp_len;\n} __packed __aligned(4);\n\nenum {\n\tBSS_INFO_BCN_CSA,\n\tBSS_INFO_BCN_BCC,\n\tBSS_INFO_BCN_MBSSID,\n\tBSS_INFO_BCN_CONTENT,\n\tBSS_INFO_BCN_DISCOV,\n\tBSS_INFO_BCN_MAX\n};\n\nenum {\n\tRATE_PARAM_FIXED = 3,\n\tRATE_PARAM_MMPS_UPDATE = 5,\n\tRATE_PARAM_FIXED_HE_LTF = 7,\n\tRATE_PARAM_FIXED_MCS,\n\tRATE_PARAM_FIXED_GI = 11,\n\tRATE_PARAM_AUTO = 20,\n\tRATE_PARAM_SPE_UPDATE = 22,\n};\n\n#define RATE_CFG_MCS\t\t\tGENMASK(3, 0)\n#define RATE_CFG_NSS\t\t\tGENMASK(7, 4)\n#define RATE_CFG_GI\t\t\tGENMASK(11, 8)\n#define RATE_CFG_BW\t\t\tGENMASK(15, 12)\n#define RATE_CFG_STBC\t\t\tGENMASK(19, 16)\n#define RATE_CFG_LDPC\t\t\tGENMASK(23, 20)\n#define RATE_CFG_PHY_TYPE\t\tGENMASK(27, 24)\n#define RATE_CFG_HE_LTF\t\t\tGENMASK(31, 28)\n\nenum {\n\tTX_POWER_LIMIT_ENABLE,\n\tTX_POWER_LIMIT_TABLE = 0x4,\n\tTX_POWER_LIMIT_INFO = 0x7,\n\tTX_POWER_LIMIT_FRAME = 0x11,\n\tTX_POWER_LIMIT_FRAME_MIN = 0x12,\n};\n\nenum {\n\tSPR_ENABLE = 0x1,\n\tSPR_ENABLE_SD = 0x3,\n\tSPR_ENABLE_MODE = 0x5,\n\tSPR_ENABLE_DPD = 0x23,\n\tSPR_ENABLE_TX = 0x25,\n\tSPR_SET_SRG_BITMAP = 0x80,\n\tSPR_SET_PARAM = 0xc2,\n\tSPR_SET_SIGA = 0xdc,\n};\n\nenum {\n\tTHERMAL_PROTECT_PARAMETER_CTRL,\n\tTHERMAL_PROTECT_BASIC_INFO,\n\tTHERMAL_PROTECT_ENABLE,\n\tTHERMAL_PROTECT_DISABLE,\n\tTHERMAL_PROTECT_DUTY_CONFIG,\n\tTHERMAL_PROTECT_MECH_INFO,\n\tTHERMAL_PROTECT_DUTY_INFO,\n\tTHERMAL_PROTECT_STATE_ACT,\n};\n\nenum {\n\tMT_BF_SOUNDING_ON = 1,\n\tMT_BF_TYPE_UPDATE = 20,\n\tMT_BF_MODULE_UPDATE = 25\n};\n\nenum {\n\tMURU_SET_ARB_OP_MODE = 14,\n\tMURU_SET_PLATFORM_TYPE = 25,\n};\n\nenum {\n\tMURU_PLATFORM_TYPE_PERF_LEVEL_1 = 1,\n\tMURU_PLATFORM_TYPE_PERF_LEVEL_2,\n};\n\n \nenum {\n\tMURU_SET_TXC_TX_STATS_EN = 150,\n\tMURU_GET_TXC_TX_STATS = 151,\n};\n\nenum {\n\tSER_QUERY,\n\t \n\tSER_SET_RECOVER_L1,\n\tSER_SET_RECOVER_L2,\n\tSER_SET_RECOVER_L3_RX_ABORT,\n\tSER_SET_RECOVER_L3_TX_ABORT,\n\tSER_SET_RECOVER_L3_TX_DISABLE,\n\tSER_SET_RECOVER_L3_BF,\n\tSER_SET_RECOVER_FULL,\n\tSER_SET_SYSTEM_ASSERT,\n\t \n\tSER_ENABLE = 2,\n\tSER_RECOVER\n};\n\n#define MT7915_MAX_BEACON_SIZE\t\t1308\n#define MT7915_BEACON_UPDATE_SIZE\t(sizeof(struct sta_req_hdr) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_bcn) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_bcn_cntdwn) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_bcn_mbss) +\t\\\n\t\t\t\t\t MT_TXD_SIZE +\t\\\n\t\t\t\t\t sizeof(struct bss_info_bcn_cont))\n#define MT7915_MAX_BSS_OFFLOAD_SIZE\t(MT7915_MAX_BEACON_SIZE +\t\\\n\t\t\t\t\t MT7915_BEACON_UPDATE_SIZE)\n\n#define MT7915_BSS_UPDATE_MAX_SIZE\t(sizeof(struct sta_req_hdr) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_omac) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_basic) +\\\n\t\t\t\t\t sizeof(struct bss_info_rf_ch) +\\\n\t\t\t\t\t sizeof(struct bss_info_ra) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_hw_amsdu) +\\\n\t\t\t\t\t sizeof(struct bss_info_he) +\t\\\n\t\t\t\t\t sizeof(struct bss_info_bmc_rate) +\\\n\t\t\t\t\t sizeof(struct bss_info_ext_bss))\n\nstatic inline s8\nmt7915_get_power_bound(struct mt7915_phy *phy, s8 txpower)\n{\n\tstruct mt76_phy *mphy = phy->mt76;\n\tint n_chains = hweight8(mphy->antenna_mask);\n\n\ttxpower = mt76_get_sar_power(mphy, mphy->chandef.chan, txpower * 2);\n\ttxpower -= mt76_tx_power_nss_delta(n_chains);\n\n\treturn txpower;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}