{
  "module_name": "soc.c",
  "hash_id": "b5e1e9701c5f5bc948f681fe87296ba45af068a01f9eb2abed3a3523b03de050",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt7603/soc.c",
  "human_readable_source": "\n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n\n#include \"mt7603.h\"\n\nstatic int\nmt76_wmac_probe(struct platform_device *pdev)\n{\n\tstruct mt7603_dev *dev;\n\tvoid __iomem *mem_base;\n\tstruct mt76_dev *mdev;\n\tint irq;\n\tint ret;\n\n\tirq = platform_get_irq(pdev, 0);\n\tif (irq < 0)\n\t\treturn irq;\n\n\tmem_base = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(mem_base))\n\t\treturn PTR_ERR(mem_base);\n\n\tmdev = mt76_alloc_device(&pdev->dev, sizeof(*dev), &mt7603_ops,\n\t\t\t\t &mt7603_drv_ops);\n\tif (!mdev)\n\t\treturn -ENOMEM;\n\n\tdev = container_of(mdev, struct mt7603_dev, mt76);\n\tmt76_mmio_init(mdev, mem_base);\n\n\tmdev->rev = (mt76_rr(dev, MT_HW_CHIPID) << 16) |\n\t\t    (mt76_rr(dev, MT_HW_REV) & 0xff);\n\tdev_info(mdev->dev, \"ASIC revision: %04x\\n\", mdev->rev);\n\n\tmt76_wr(dev, MT_INT_MASK_CSR, 0);\n\n\tret = devm_request_irq(mdev->dev, irq, mt7603_irq_handler,\n\t\t\t       IRQF_SHARED, KBUILD_MODNAME, dev);\n\tif (ret)\n\t\tgoto error;\n\n\tret = mt7603_register_device(dev);\n\tif (ret)\n\t\tgoto error;\n\n\treturn 0;\nerror:\n\tieee80211_free_hw(mt76_hw(dev));\n\treturn ret;\n}\n\nstatic int\nmt76_wmac_remove(struct platform_device *pdev)\n{\n\tstruct mt76_dev *mdev = platform_get_drvdata(pdev);\n\tstruct mt7603_dev *dev = container_of(mdev, struct mt7603_dev, mt76);\n\n\tmt7603_unregister_device(dev);\n\n\treturn 0;\n}\n\nstatic const struct of_device_id of_wmac_match[] = {\n\t{ .compatible = \"mediatek,mt7628-wmac\" },\n\t{},\n};\n\nMODULE_DEVICE_TABLE(of, of_wmac_match);\nMODULE_FIRMWARE(MT7628_FIRMWARE_E1);\nMODULE_FIRMWARE(MT7628_FIRMWARE_E2);\n\nstruct platform_driver mt76_wmac_driver = {\n\t.probe\t\t= mt76_wmac_probe,\n\t.remove\t\t= mt76_wmac_remove,\n\t.driver = {\n\t\t.name = \"mt76_wmac\",\n\t\t.of_match_table = of_wmac_match,\n\t},\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}