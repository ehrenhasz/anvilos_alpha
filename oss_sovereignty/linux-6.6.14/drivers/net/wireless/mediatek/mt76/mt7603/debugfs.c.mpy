{
  "module_name": "debugfs.c",
  "hash_id": "445444796afb287140f5cc672ae5b5f32bd4dc6f1ca1dc74cb88286ecca9ca6c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt76/mt7603/debugfs.c",
  "human_readable_source": "\n\n#include \"mt7603.h\"\n\nstatic int\nmt7603_reset_read(struct seq_file *s, void *data)\n{\n\tstruct mt7603_dev *dev = dev_get_drvdata(s->private);\n\tstatic const char * const reset_cause_str[] = {\n\t\t[RESET_CAUSE_TX_HANG] = \"TX hang\",\n\t\t[RESET_CAUSE_TX_BUSY] = \"TX DMA busy stuck\",\n\t\t[RESET_CAUSE_RX_BUSY] = \"RX DMA busy stuck\",\n\t\t[RESET_CAUSE_RX_PSE_BUSY] = \"RX PSE busy stuck\",\n\t\t[RESET_CAUSE_BEACON_STUCK] = \"Beacon stuck\",\n\t\t[RESET_CAUSE_MCU_HANG] = \"MCU hang\",\n\t\t[RESET_CAUSE_RESET_FAILED] = \"PSE reset failed\",\n\t};\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(reset_cause_str); i++) {\n\t\tif (!reset_cause_str[i])\n\t\t\tcontinue;\n\n\t\tseq_printf(s, \"%20s: %u\\n\", reset_cause_str[i],\n\t\t\t   dev->reset_cause[i]);\n\t}\n\n\treturn 0;\n}\n\nstatic int\nmt7603_radio_read(struct seq_file *s, void *data)\n{\n\tstruct mt7603_dev *dev = dev_get_drvdata(s->private);\n\n\tseq_printf(s, \"Sensitivity: %d\\n\", dev->sensitivity);\n\tseq_printf(s, \"False CCA: ofdm=%d cck=%d\\n\",\n\t\t   dev->false_cca_ofdm, dev->false_cca_cck);\n\n\treturn 0;\n}\n\nstatic int\nmt7603_edcca_set(void *data, u64 val)\n{\n\tstruct mt7603_dev *dev = data;\n\n\tmutex_lock(&dev->mt76.mutex);\n\n\tdev->ed_monitor_enabled = !!val;\n\tdev->ed_monitor = dev->ed_monitor_enabled &&\n\t\t\t  dev->mt76.region == NL80211_DFS_ETSI;\n\tmt7603_init_edcca(dev);\n\n\tmutex_unlock(&dev->mt76.mutex);\n\n\treturn 0;\n}\n\nstatic int\nmt7603_edcca_get(void *data, u64 *val)\n{\n\tstruct mt7603_dev *dev = data;\n\n\t*val = dev->ed_monitor_enabled;\n\treturn 0;\n}\n\nDEFINE_DEBUGFS_ATTRIBUTE(fops_edcca, mt7603_edcca_get,\n\t\t\t mt7603_edcca_set, \"%lld\\n\");\n\nstatic int\nmt7603_ampdu_stat_show(struct seq_file *file, void *data)\n{\n\tstruct mt7603_dev *dev = file->private;\n\tint bound[3], i, range;\n\n\trange = mt76_rr(dev, MT_AGG_ASRCR);\n\tfor (i = 0; i < ARRAY_SIZE(bound); i++)\n\t\tbound[i] = MT_AGG_ASRCR_RANGE(range, i) + 1;\n\n\tseq_printf(file, \"Length: %8d | \", bound[0]);\n\tfor (i = 0; i < ARRAY_SIZE(bound) - 1; i++)\n\t\tseq_printf(file, \"%3d -%3d | \",\n\t\t\t   bound[i], bound[i + 1]);\n\tseq_puts(file, \"\\nCount:  \");\n\tfor (i = 0; i < ARRAY_SIZE(bound); i++)\n\t\tseq_printf(file, \"%8d | \", dev->mphy.aggr_stats[i]);\n\tseq_puts(file, \"\\n\");\n\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(mt7603_ampdu_stat);\n\nvoid mt7603_init_debugfs(struct mt7603_dev *dev)\n{\n\tstruct dentry *dir;\n\n\tdir = mt76_register_debugfs(&dev->mt76);\n\tif (!dir)\n\t\treturn;\n\n\tdebugfs_create_file(\"ampdu_stat\", 0400, dir, dev,\n\t\t\t     &mt7603_ampdu_stat_fops);\n\tdebugfs_create_devm_seqfile(dev->mt76.dev, \"xmit-queues\", dir,\n\t\t\t\t    mt76_queues_read);\n\tdebugfs_create_file(\"edcca\", 0600, dir, dev, &fops_edcca);\n\tdebugfs_create_u32(\"reset_test\", 0600, dir, &dev->reset_test);\n\tdebugfs_create_devm_seqfile(dev->mt76.dev, \"reset\", dir,\n\t\t\t\t    mt7603_reset_read);\n\tdebugfs_create_devm_seqfile(dev->mt76.dev, \"radio\", dir,\n\t\t\t\t    mt7603_radio_read);\n\tdebugfs_create_u8(\"sensitivity_limit\", 0600, dir,\n\t\t\t    &dev->sensitivity_limit);\n\tdebugfs_create_bool(\"dynamic_sensitivity\", 0600, dir,\n\t\t\t    &dev->dynamic_sensitivity);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}