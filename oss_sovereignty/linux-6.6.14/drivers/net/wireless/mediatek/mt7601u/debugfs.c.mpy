{
  "module_name": "debugfs.c",
  "hash_id": "9e9ba96a2bc997bb2a666160f209d3582b97915975a316e266f940415cd43aad",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/mediatek/mt7601u/debugfs.c",
  "human_readable_source": "\n \n\n#include <linux/debugfs.h>\n\n#include \"mt7601u.h\"\n#include \"eeprom.h\"\n\nstatic int\nmt76_reg_set(void *data, u64 val)\n{\n\tstruct mt7601u_dev *dev = data;\n\n\tmt76_wr(dev, dev->debugfs_reg, val);\n\treturn 0;\n}\n\nstatic int\nmt76_reg_get(void *data, u64 *val)\n{\n\tstruct mt7601u_dev *dev = data;\n\n\t*val = mt76_rr(dev, dev->debugfs_reg);\n\treturn 0;\n}\n\nDEFINE_DEBUGFS_ATTRIBUTE(fops_regval, mt76_reg_get, mt76_reg_set, \"0x%08llx\\n\");\n\nstatic int\nmt7601u_ampdu_stat_show(struct seq_file *file, void *data)\n{\n\tstruct mt7601u_dev *dev = file->private;\n\tint i, j;\n\n#define stat_printf(grp, off, name)\t\t\t\t\t\\\n\tseq_printf(file, #name \":\\t%llu\\n\", dev->stats.grp[off])\n\n\tstat_printf(rx_stat, 0, rx_crc_err);\n\tstat_printf(rx_stat, 1, rx_phy_err);\n\tstat_printf(rx_stat, 2, rx_false_cca);\n\tstat_printf(rx_stat, 3, rx_plcp_err);\n\tstat_printf(rx_stat, 4, rx_fifo_overflow);\n\tstat_printf(rx_stat, 5, rx_duplicate);\n\n\tstat_printf(tx_stat, 0, tx_fail_cnt);\n\tstat_printf(tx_stat, 1, tx_bcn_cnt);\n\tstat_printf(tx_stat, 2, tx_success);\n\tstat_printf(tx_stat, 3, tx_retransmit);\n\tstat_printf(tx_stat, 4, tx_zero_len);\n\tstat_printf(tx_stat, 5, tx_underflow);\n\n\tstat_printf(aggr_stat, 0, non_aggr_tx);\n\tstat_printf(aggr_stat, 1, aggr_tx);\n\n\tstat_printf(zero_len_del, 0, tx_zero_len_del);\n\tstat_printf(zero_len_del, 1, rx_zero_len_del);\n#undef stat_printf\n\n\tseq_puts(file, \"Aggregations stats:\\n\");\n\tfor (i = 0; i < 4; i++) {\n\t\tfor (j = 0; j < 8; j++)\n\t\t\tseq_printf(file, \"%08llx \",\n\t\t\t\t   dev->stats.aggr_n[i * 8 + j]);\n\t\tseq_putc(file, '\\n');\n\t}\n\n\tseq_printf(file, \"recent average AMPDU len: %d\\n\",\n\t\t   atomic_read(&dev->avg_ampdu_len));\n\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(mt7601u_ampdu_stat);\n\nstatic int\nmt7601u_eeprom_param_show(struct seq_file *file, void *data)\n{\n\tstruct mt7601u_dev *dev = file->private;\n\tstruct mt7601u_rate_power *rp = &dev->ee->power_rate_table;\n\tstruct tssi_data *td = &dev->ee->tssi_data;\n\tint i;\n\n\tseq_printf(file, \"RF freq offset: %hhx\\n\", dev->ee->rf_freq_off);\n\tseq_printf(file, \"RSSI offset: %hhx %hhx\\n\",\n\t\t   dev->ee->rssi_offset[0], dev->ee->rssi_offset[1]);\n\tseq_printf(file, \"Reference temp: %hhx\\n\", dev->ee->ref_temp);\n\tseq_printf(file, \"LNA gain: %hhx\\n\", dev->ee->lna_gain);\n\tseq_printf(file, \"Reg channels: %hhu-%d\\n\", dev->ee->reg.start,\n\t\t   dev->ee->reg.start + dev->ee->reg.num - 1);\n\n\tseq_puts(file, \"Per rate power:\\n\");\n\tfor (i = 0; i < 2; i++)\n\t\tseq_printf(file, \"\\t raw:%02hhx bw20:%02hhx bw40:%02hhx\\n\",\n\t\t\t   rp->cck[i].raw, rp->cck[i].bw20, rp->cck[i].bw40);\n\tfor (i = 0; i < 4; i++)\n\t\tseq_printf(file, \"\\t raw:%02hhx bw20:%02hhx bw40:%02hhx\\n\",\n\t\t\t   rp->ofdm[i].raw, rp->ofdm[i].bw20, rp->ofdm[i].bw40);\n\tfor (i = 0; i < 4; i++)\n\t\tseq_printf(file, \"\\t raw:%02hhx bw20:%02hhx bw40:%02hhx\\n\",\n\t\t\t   rp->ht[i].raw, rp->ht[i].bw20, rp->ht[i].bw40);\n\n\tseq_puts(file, \"Per channel power:\\n\");\n\tfor (i = 0; i < 7; i++)\n\t\tseq_printf(file, \"\\t tx_power  ch%u:%02hhx ch%u:%02hhx\\n\",\n\t\t\t   i * 2 + 1, dev->ee->chan_pwr[i * 2],\n\t\t\t   i * 2 + 2, dev->ee->chan_pwr[i * 2 + 1]);\n\n\tif (!dev->ee->tssi_enabled)\n\t\treturn 0;\n\n\tseq_puts(file, \"TSSI:\\n\");\n\tseq_printf(file, \"\\t slope:%02hhx\\n\", td->slope);\n\tseq_printf(file, \"\\t offset=%02hhx %02hhx %02hhx\\n\",\n\t\t   td->offset[0], td->offset[1], td->offset[2]);\n\tseq_printf(file, \"\\t delta_off:%08x\\n\", td->tx0_delta_offset);\n\n\treturn 0;\n}\n\nDEFINE_SHOW_ATTRIBUTE(mt7601u_eeprom_param);\n\nvoid mt7601u_init_debugfs(struct mt7601u_dev *dev)\n{\n\tstruct dentry *dir;\n\n\tdir = debugfs_create_dir(\"mt7601u\", dev->hw->wiphy->debugfsdir);\n\n\tdebugfs_create_u8(\"temperature\", 0400, dir, &dev->raw_temp);\n\tdebugfs_create_u32(\"temp_mode\", 0400, dir, &dev->temp_mode);\n\n\tdebugfs_create_u32(\"regidx\", 0600, dir, &dev->debugfs_reg);\n\tdebugfs_create_file(\"regval\", 0600, dir, dev, &fops_regval);\n\tdebugfs_create_file(\"ampdu_stat\", 0400, dir, dev, &mt7601u_ampdu_stat_fops);\n\tdebugfs_create_file(\"eeprom_param\", 0400, dir, dev, &mt7601u_eeprom_param_fops);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}