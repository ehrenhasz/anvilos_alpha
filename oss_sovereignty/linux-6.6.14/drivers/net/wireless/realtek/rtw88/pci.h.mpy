{
  "module_name": "pci.h",
  "hash_id": "e97c54a1aff298fc4a927742e66e556b414401974da124fc2fb748afbf448676",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/realtek/rtw88/pci.h",
  "human_readable_source": " \n \n\n#ifndef __RTK_PCI_H_\n#define __RTK_PCI_H_\n\n#include \"main.h\"\n\n#define RTK_DEFAULT_TX_DESC_NUM 128\n#define RTK_BEQ_TX_DESC_NUM\t256\n\n#define RTK_MAX_RX_DESC_NUM\t512\n \n#define RTK_PCI_RX_BUF_SIZE\t(11454 + 24)\n\n#define RTK_PCI_CTRL\t\t0x300\n#define BIT_RST_TRXDMA_INTF\tBIT(20)\n#define BIT_RX_TAG_EN\t\tBIT(15)\n#define REG_DBI_WDATA_V1\t0x03E8\n#define REG_DBI_RDATA_V1\t0x03EC\n#define REG_DBI_FLAG_V1\t\t0x03F0\n#define BIT_DBI_RFLAG\t\tBIT(17)\n#define BIT_DBI_WFLAG\t\tBIT(16)\n#define BITS_DBI_WREN\t\tGENMASK(15, 12)\n#define BITS_DBI_ADDR_MASK\tGENMASK(11, 2)\n\n#define REG_MDIO_V1\t\t0x03F4\n#define REG_PCIE_MIX_CFG\t0x03F8\n#define BITS_MDIO_ADDR_MASK\tGENMASK(4, 0)\n#define BIT_MDIO_WFLAG_V1\tBIT(5)\n#define RTW_PCI_MDIO_PG_SZ\tBIT(5)\n#define RTW_PCI_MDIO_PG_OFFS_G1\t0\n#define RTW_PCI_MDIO_PG_OFFS_G2\t2\n#define RTW_PCI_WR_RETRY_CNT\t20\n\n#define RTK_PCIE_LINK_CFG\t0x0719\n#define BIT_CLKREQ_SW_EN\tBIT(4)\n#define BIT_L1_SW_EN\t\tBIT(3)\n#define BIT_CLKREQ_N_PAD\tBIT(0)\n#define RTK_PCIE_CLKDLY_CTRL\t0x0725\n\n#define BIT_PCI_BCNQ_FLAG\tBIT(4)\n#define RTK_PCI_TXBD_DESA_BCNQ\t0x308\n#define RTK_PCI_TXBD_DESA_H2CQ\t0x1320\n#define RTK_PCI_TXBD_DESA_MGMTQ\t0x310\n#define RTK_PCI_TXBD_DESA_BKQ\t0x330\n#define RTK_PCI_TXBD_DESA_BEQ\t0x328\n#define RTK_PCI_TXBD_DESA_VIQ\t0x320\n#define RTK_PCI_TXBD_DESA_VOQ\t0x318\n#define RTK_PCI_TXBD_DESA_HI0Q\t0x340\n#define RTK_PCI_RXBD_DESA_MPDUQ\t0x338\n\n#define TRX_BD_IDX_MASK\t\tGENMASK(11, 0)\n#define TRX_BD_HW_IDX_MASK\tGENMASK(27, 16)\n\n \n#define RTK_PCI_TXBD_NUM_H2CQ\t0x1328\n#define RTK_PCI_TXBD_NUM_MGMTQ\t0x380\n#define RTK_PCI_TXBD_NUM_BKQ\t0x38A\n#define RTK_PCI_TXBD_NUM_BEQ\t0x388\n#define RTK_PCI_TXBD_NUM_VIQ\t0x386\n#define RTK_PCI_TXBD_NUM_VOQ\t0x384\n#define RTK_PCI_TXBD_NUM_HI0Q\t0x38C\n#define RTK_PCI_RXBD_NUM_MPDUQ\t0x382\n#define RTK_PCI_TXBD_IDX_H2CQ\t0x132C\n#define RTK_PCI_TXBD_IDX_MGMTQ\t0x3B0\n#define RTK_PCI_TXBD_IDX_BKQ\t0x3AC\n#define RTK_PCI_TXBD_IDX_BEQ\t0x3A8\n#define RTK_PCI_TXBD_IDX_VIQ\t0x3A4\n#define RTK_PCI_TXBD_IDX_VOQ\t0x3A0\n#define RTK_PCI_TXBD_IDX_HI0Q\t0x3B8\n#define RTK_PCI_RXBD_IDX_MPDUQ\t0x3B4\n\n#define RTK_PCI_TXBD_RWPTR_CLR\t0x39C\n#define RTK_PCI_TXBD_H2CQ_CSR\t0x1330\n\n#define BIT_CLR_H2CQ_HOST_IDX\tBIT(16)\n#define BIT_CLR_H2CQ_HW_IDX\tBIT(8)\n\n#define RTK_PCI_HIMR0\t\t0x0B0\n#define RTK_PCI_HISR0\t\t0x0B4\n#define RTK_PCI_HIMR1\t\t0x0B8\n#define RTK_PCI_HISR1\t\t0x0BC\n#define RTK_PCI_HIMR2\t\t0x10B0\n#define RTK_PCI_HISR2\t\t0x10B4\n#define RTK_PCI_HIMR3\t\t0x10B8\n#define RTK_PCI_HISR3\t\t0x10BC\n \n#define IMR_TIMER2\t\tBIT(31)\n#define IMR_TIMER1\t\tBIT(30)\n#define IMR_PSTIMEOUT\t\tBIT(29)\n#define IMR_GTINT4\t\tBIT(28)\n#define IMR_GTINT3\t\tBIT(27)\n#define IMR_TBDER\t\tBIT(26)\n#define IMR_TBDOK\t\tBIT(25)\n#define IMR_TSF_BIT32_TOGGLE\tBIT(24)\n#define IMR_BCNDMAINT0\t\tBIT(20)\n#define IMR_BCNDOK0\t\tBIT(16)\n#define IMR_HSISR_IND_ON_INT\tBIT(15)\n#define IMR_BCNDMAINT_E\t\tBIT(14)\n#define IMR_ATIMEND\t\tBIT(12)\n#define IMR_HISR1_IND_INT\tBIT(11)\n#define IMR_C2HCMD\t\tBIT(10)\n#define IMR_CPWM2\t\tBIT(9)\n#define IMR_CPWM\t\tBIT(8)\n#define IMR_HIGHDOK\t\tBIT(7)\n#define IMR_MGNTDOK\t\tBIT(6)\n#define IMR_BKDOK\t\tBIT(5)\n#define IMR_BEDOK\t\tBIT(4)\n#define IMR_VIDOK\t\tBIT(3)\n#define IMR_VODOK\t\tBIT(2)\n#define IMR_RDU\t\t\tBIT(1)\n#define IMR_ROK\t\t\tBIT(0)\n \n#define IMR_TXFIFO_TH_INT\tBIT(30)\n#define IMR_BTON_STS_UPDATE\tBIT(29)\n#define IMR_MCUERR\t\tBIT(28)\n#define IMR_BCNDMAINT7\t\tBIT(27)\n#define IMR_BCNDMAINT6\t\tBIT(26)\n#define IMR_BCNDMAINT5\t\tBIT(25)\n#define IMR_BCNDMAINT4\t\tBIT(24)\n#define IMR_BCNDMAINT3\t\tBIT(23)\n#define IMR_BCNDMAINT2\t\tBIT(22)\n#define IMR_BCNDMAINT1\t\tBIT(21)\n#define IMR_BCNDOK7\t\tBIT(20)\n#define IMR_BCNDOK6\t\tBIT(19)\n#define IMR_BCNDOK5\t\tBIT(18)\n#define IMR_BCNDOK4\t\tBIT(17)\n#define IMR_BCNDOK3\t\tBIT(16)\n#define IMR_BCNDOK2\t\tBIT(15)\n#define IMR_BCNDOK1\t\tBIT(14)\n#define IMR_ATIMEND_E\t\tBIT(13)\n#define IMR_ATIMEND\t\tBIT(12)\n#define IMR_TXERR\t\tBIT(11)\n#define IMR_RXERR\t\tBIT(10)\n#define IMR_TXFOVW\t\tBIT(9)\n#define IMR_RXFOVW\t\tBIT(8)\n#define IMR_CPU_MGQ_TXDONE\tBIT(5)\n#define IMR_PS_TIMER_C\t\tBIT(4)\n#define IMR_PS_TIMER_B\t\tBIT(3)\n#define IMR_PS_TIMER_A\t\tBIT(2)\n#define IMR_CPUMGQ_TX_TIMER\tBIT(1)\n \n#define IMR_H2CDOK\t\tBIT(16)\n\nenum rtw_pci_flags {\n\tRTW_PCI_FLAG_NAPI_RUNNING,\n\n\tNUM_OF_RTW_PCI_FLAGS,\n};\n\n \nstatic inline int avail_desc(u32 wp, u32 rp, u32 len)\n{\n\tif (rp > wp)\n\t\treturn rp - wp - 1;\n\telse\n\t\treturn len - wp + rp - 1;\n}\n\n#define RTK_PCI_TXBD_OWN_OFFSET 15\n#define RTK_PCI_TXBD_BCN_WORK\t0x383\n\nstruct rtw_pci_tx_buffer_desc {\n\t__le16 buf_size;\n\t__le16 psb_len;\n\t__le32 dma;\n};\n\nstruct rtw_pci_tx_data {\n\tdma_addr_t dma;\n\tu8 sn;\n};\n\nstruct rtw_pci_ring {\n\tu8 *head;\n\tdma_addr_t dma;\n\n\tu8 desc_size;\n\n\tu32 len;\n\tu32 wp;\n\tu32 rp;\n};\n\nstruct rtw_pci_tx_ring {\n\tstruct rtw_pci_ring r;\n\tstruct sk_buff_head queue;\n\tbool queue_stopped;\n};\n\nstruct rtw_pci_rx_buffer_desc {\n\t__le16 buf_size;\n\t__le16 total_pkt_size;\n\t__le32 dma;\n};\n\nstruct rtw_pci_rx_ring {\n\tstruct rtw_pci_ring r;\n\tstruct sk_buff *buf[RTK_MAX_RX_DESC_NUM];\n};\n\n#define RX_TAG_MAX\t8192\n\nstruct rtw_pci {\n\tstruct pci_dev *pdev;\n\n\t \n\tspinlock_t hwirq_lock;\n\t \n\tspinlock_t irq_lock;\n\tu32 irq_mask[4];\n\tbool irq_enabled;\n\tbool running;\n\n\t \n\tstruct net_device netdev;\n\tstruct napi_struct napi;\n\n\tu16 rx_tag;\n\tDECLARE_BITMAP(tx_queued, RTK_MAX_TX_QUEUE_NUM);\n\tstruct rtw_pci_tx_ring tx_rings[RTK_MAX_TX_QUEUE_NUM];\n\tstruct rtw_pci_rx_ring rx_rings[RTK_MAX_RX_QUEUE_NUM];\n\tu16 link_ctrl;\n\tatomic_t link_usage;\n\tbool rx_no_aspm;\n\tDECLARE_BITMAP(flags, NUM_OF_RTW_PCI_FLAGS);\n\n\tvoid __iomem *mmap;\n};\n\nextern const struct dev_pm_ops rtw_pm_ops;\n\nint rtw_pci_probe(struct pci_dev *pdev, const struct pci_device_id *id);\nvoid rtw_pci_remove(struct pci_dev *pdev);\nvoid rtw_pci_shutdown(struct pci_dev *pdev);\n\nstatic inline u32 max_num_of_tx_queue(u8 queue)\n{\n\tu32 max_num;\n\n\tswitch (queue) {\n\tcase RTW_TX_QUEUE_BE:\n\t\tmax_num = RTK_BEQ_TX_DESC_NUM;\n\t\tbreak;\n\tcase RTW_TX_QUEUE_BCN:\n\t\tmax_num = 1;\n\t\tbreak;\n\tdefault:\n\t\tmax_num = RTK_DEFAULT_TX_DESC_NUM;\n\t\tbreak;\n\t}\n\n\treturn max_num;\n}\n\nstatic inline struct\nrtw_pci_tx_data *rtw_pci_get_tx_data(struct sk_buff *skb)\n{\n\tstruct ieee80211_tx_info *info = IEEE80211_SKB_CB(skb);\n\n\tBUILD_BUG_ON(sizeof(struct rtw_pci_tx_data) >\n\t\t     sizeof(info->status.status_driver_data));\n\n\treturn (struct rtw_pci_tx_data *)info->status.status_driver_data;\n}\n\nstatic inline\nstruct rtw_pci_tx_buffer_desc *get_tx_buffer_desc(struct rtw_pci_tx_ring *ring,\n\t\t\t\t\t\t  u32 size)\n{\n\tu8 *buf_desc;\n\n\tbuf_desc = ring->r.head + ring->r.wp * size;\n\treturn (struct rtw_pci_tx_buffer_desc *)buf_desc;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}