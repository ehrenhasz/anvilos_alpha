{
  "module_name": "rtw8822b.c",
  "hash_id": "56452865dcd3e49a50f25218a4e64c14d4704aec048064721c0c784556fc0cf5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/realtek/rtw88/rtw8822b.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include \"main.h\"\n#include \"coex.h\"\n#include \"fw.h\"\n#include \"tx.h\"\n#include \"rx.h\"\n#include \"phy.h\"\n#include \"rtw8822b.h\"\n#include \"rtw8822b_table.h\"\n#include \"mac.h\"\n#include \"reg.h\"\n#include \"debug.h\"\n#include \"bf.h\"\n#include \"regd.h\"\n\nstatic void rtw8822b_config_trx_mode(struct rtw_dev *rtwdev, u8 tx_path,\n\t\t\t\t     u8 rx_path, bool is_tx2_path);\n\nstatic void rtw8822be_efuse_parsing(struct rtw_efuse *efuse,\n\t\t\t\t    struct rtw8822b_efuse *map)\n{\n\tether_addr_copy(efuse->addr, map->e.mac_addr);\n}\n\nstatic void rtw8822bu_efuse_parsing(struct rtw_efuse *efuse,\n\t\t\t\t    struct rtw8822b_efuse *map)\n{\n\tether_addr_copy(efuse->addr, map->u.mac_addr);\n}\n\nstatic void rtw8822bs_efuse_parsing(struct rtw_efuse *efuse,\n\t\t\t\t    struct rtw8822b_efuse *map)\n{\n\tether_addr_copy(efuse->addr, map->s.mac_addr);\n}\n\nstatic int rtw8822b_read_efuse(struct rtw_dev *rtwdev, u8 *log_map)\n{\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tstruct rtw8822b_efuse *map;\n\tint i;\n\n\tmap = (struct rtw8822b_efuse *)log_map;\n\n\tefuse->rfe_option = map->rfe_option;\n\tefuse->rf_board_option = map->rf_board_option;\n\tefuse->crystal_cap = map->xtal_k;\n\tefuse->pa_type_2g = map->pa_type;\n\tefuse->pa_type_5g = map->pa_type;\n\tefuse->lna_type_2g = map->lna_type_2g[0];\n\tefuse->lna_type_5g = map->lna_type_5g[0];\n\tefuse->channel_plan = map->channel_plan;\n\tefuse->country_code[0] = map->country_code[0];\n\tefuse->country_code[1] = map->country_code[1];\n\tefuse->bt_setting = map->rf_bt_setting;\n\tefuse->regd = map->rf_board_option & 0x7;\n\tefuse->thermal_meter[RF_PATH_A] = map->thermal_meter;\n\tefuse->thermal_meter_k = map->thermal_meter;\n\n\tfor (i = 0; i < 4; i++)\n\t\tefuse->txpwr_idx_table[i] = map->txpwr_idx_table[i];\n\n\tswitch (rtw_hci_type(rtwdev)) {\n\tcase RTW_HCI_TYPE_PCIE:\n\t\trtw8822be_efuse_parsing(efuse, map);\n\t\tbreak;\n\tcase RTW_HCI_TYPE_USB:\n\t\trtw8822bu_efuse_parsing(efuse, map);\n\t\tbreak;\n\tcase RTW_HCI_TYPE_SDIO:\n\t\trtw8822bs_efuse_parsing(efuse, map);\n\t\tbreak;\n\tdefault:\n\t\t \n\t\treturn -ENOTSUPP;\n\t}\n\n\treturn 0;\n}\n\nstatic void rtw8822b_phy_rfe_init(struct rtw_dev *rtwdev)\n{\n\t \n\trtw_write32_mask(rtwdev, 0x64, BIT(29) | BIT(28), 0x3);\n\trtw_write32_mask(rtwdev, 0x4c, BIT(26) | BIT(25), 0x0);\n\trtw_write32_mask(rtwdev, 0x40, BIT(2), 0x1);\n\n\t \n\trtw_write32_mask(rtwdev, 0x1990, 0x3f, 0x30);\n\trtw_write32_mask(rtwdev, 0x1990, (BIT(11) | BIT(10)), 0x3);\n\n\t \n\trtw_write32_mask(rtwdev, 0x974, 0x3f, 0x3f);\n\trtw_write32_mask(rtwdev, 0x974, (BIT(11) | BIT(10)), 0x3);\n}\n\n#define RTW_TXSCALE_SIZE 37\nstatic const u32 rtw8822b_txscale_tbl[RTW_TXSCALE_SIZE] = {\n\t0x081, 0x088, 0x090, 0x099, 0x0a2, 0x0ac, 0x0b6, 0x0c0, 0x0cc, 0x0d8,\n\t0x0e5, 0x0f2, 0x101, 0x110, 0x120, 0x131, 0x143, 0x156, 0x16a, 0x180,\n\t0x197, 0x1af, 0x1c8, 0x1e3, 0x200, 0x21e, 0x23e, 0x261, 0x285, 0x2ab,\n\t0x2d3, 0x2fe, 0x32b, 0x35c, 0x38e, 0x3c4, 0x3fe\n};\n\nstatic u8 rtw8822b_get_swing_index(struct rtw_dev *rtwdev)\n{\n\tu8 i = 0;\n\tu32 swing, table_value;\n\n\tswing = rtw_read32_mask(rtwdev, 0xc1c, 0xffe00000);\n\tfor (i = 0; i < RTW_TXSCALE_SIZE; i++) {\n\t\ttable_value = rtw8822b_txscale_tbl[i];\n\t\tif (swing == table_value)\n\t\t\tbreak;\n\t}\n\n\treturn i;\n}\n\nstatic void rtw8822b_pwrtrack_init(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tu8 swing_idx = rtw8822b_get_swing_index(rtwdev);\n\tu8 path;\n\n\tif (swing_idx >= RTW_TXSCALE_SIZE)\n\t\tdm_info->default_ofdm_index = 24;\n\telse\n\t\tdm_info->default_ofdm_index = swing_idx;\n\n\tfor (path = RF_PATH_A; path < rtwdev->hal.rf_path_num; path++) {\n\t\tewma_thermal_init(&dm_info->avg_thermal[path]);\n\t\tdm_info->delta_power_index[path] = 0;\n\t}\n\tdm_info->pwr_trk_triggered = false;\n\tdm_info->pwr_trk_init_trigger = true;\n\tdm_info->thermal_meter_k = rtwdev->efuse.thermal_meter_k;\n}\n\nstatic void rtw8822b_phy_bf_init(struct rtw_dev *rtwdev)\n{\n\trtw_bf_phy_init(rtwdev);\n\t \n\trtw_write32(rtwdev, 0x1C94, 0xAFFFAFFF);\n}\n\nstatic void rtw8822b_phy_set_param(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tu8 crystal_cap;\n\tbool is_tx2_path;\n\n\t \n\trtw_write8_set(rtwdev, REG_SYS_FUNC_EN,\n\t\t       BIT_FEN_BB_RSTB | BIT_FEN_BB_GLB_RST);\n\trtw_write8_set(rtwdev, REG_RF_CTRL,\n\t\t       BIT_RF_EN | BIT_RF_RSTB | BIT_RF_SDM_RSTB);\n\trtw_write32_set(rtwdev, REG_WLRF1, BIT_WLRF1_BBRF_EN);\n\n\t \n\trtw_write32_clr(rtwdev, REG_RXPSEL, BIT_RX_PSEL_RST);\n\n\trtw_phy_load_tables(rtwdev);\n\n\tcrystal_cap = rtwdev->efuse.crystal_cap & 0x3F;\n\trtw_write32_mask(rtwdev, 0x24, 0x7e000000, crystal_cap);\n\trtw_write32_mask(rtwdev, 0x28, 0x7e, crystal_cap);\n\n\t \n\trtw_write32_set(rtwdev, REG_RXPSEL, BIT_RX_PSEL_RST);\n\n\tis_tx2_path = false;\n\trtw8822b_config_trx_mode(rtwdev, hal->antenna_tx, hal->antenna_rx,\n\t\t\t\t is_tx2_path);\n\trtw_phy_init(rtwdev);\n\n\trtw8822b_phy_rfe_init(rtwdev);\n\trtw8822b_pwrtrack_init(rtwdev);\n\n\trtw8822b_phy_bf_init(rtwdev);\n}\n\n#define WLAN_SLOT_TIME\t\t0x09\n#define WLAN_PIFS_TIME\t\t0x19\n#define WLAN_SIFS_CCK_CONT_TX\t0xA\n#define WLAN_SIFS_OFDM_CONT_TX\t0xE\n#define WLAN_SIFS_CCK_TRX\t0x10\n#define WLAN_SIFS_OFDM_TRX\t0x10\n#define WLAN_VO_TXOP_LIMIT\t0x186  \n#define WLAN_VI_TXOP_LIMIT\t0x3BC  \n#define WLAN_RDG_NAV\t\t0x05\n#define WLAN_TXOP_NAV\t\t0x1B\n#define WLAN_CCK_RX_TSF\t\t0x30\n#define WLAN_OFDM_RX_TSF\t0x30\n#define WLAN_TBTT_PROHIBIT\t0x04  \n#define WLAN_TBTT_HOLD_TIME\t0x064  \n#define WLAN_DRV_EARLY_INT\t0x04\n#define WLAN_BCN_DMA_TIME\t0x02\n\n#define WLAN_RX_FILTER0\t\t0x0FFFFFFF\n#define WLAN_RX_FILTER2\t\t0xFFFF\n#define WLAN_RCR_CFG\t\t0xE400220E\n#define WLAN_RXPKT_MAX_SZ\t12288\n#define WLAN_RXPKT_MAX_SZ_512\t(WLAN_RXPKT_MAX_SZ >> 9)\n\n#define WLAN_AMPDU_MAX_TIME\t\t0x70\n#define WLAN_RTS_LEN_TH\t\t\t0xFF\n#define WLAN_RTS_TX_TIME_TH\t\t0x08\n#define WLAN_MAX_AGG_PKT_LIMIT\t\t0x20\n#define WLAN_RTS_MAX_AGG_PKT_LIMIT\t0x20\n#define FAST_EDCA_VO_TH\t\t0x06\n#define FAST_EDCA_VI_TH\t\t0x06\n#define FAST_EDCA_BE_TH\t\t0x06\n#define FAST_EDCA_BK_TH\t\t0x06\n#define WLAN_BAR_RETRY_LIMIT\t\t0x01\n#define WLAN_RA_TRY_RATE_AGG_LIMIT\t0x08\n\n#define WLAN_TX_FUNC_CFG1\t\t0x30\n#define WLAN_TX_FUNC_CFG2\t\t0x30\n#define WLAN_MAC_OPT_NORM_FUNC1\t\t0x98\n#define WLAN_MAC_OPT_LB_FUNC1\t\t0x80\n#define WLAN_MAC_OPT_FUNC2\t\t0xb0810041\n\n#define WLAN_SIFS_CFG\t(WLAN_SIFS_CCK_CONT_TX | \\\n\t\t\t(WLAN_SIFS_OFDM_CONT_TX << BIT_SHIFT_SIFS_OFDM_CTX) | \\\n\t\t\t(WLAN_SIFS_CCK_TRX << BIT_SHIFT_SIFS_CCK_TRX) | \\\n\t\t\t(WLAN_SIFS_OFDM_TRX << BIT_SHIFT_SIFS_OFDM_TRX))\n\n#define WLAN_TBTT_TIME\t(WLAN_TBTT_PROHIBIT |\\\n\t\t\t(WLAN_TBTT_HOLD_TIME << BIT_SHIFT_TBTT_HOLD_TIME_AP))\n\n#define WLAN_NAV_CFG\t\t(WLAN_RDG_NAV | (WLAN_TXOP_NAV << 16))\n#define WLAN_RX_TSF_CFG\t\t(WLAN_CCK_RX_TSF | (WLAN_OFDM_RX_TSF) << 8)\n\nstatic int rtw8822b_mac_init(struct rtw_dev *rtwdev)\n{\n\tu32 value32;\n\n\t \n\trtw_write8_clr(rtwdev, REG_SW_AMPDU_BURST_MODE_CTRL, BIT_PRE_TX_CMD);\n\trtw_write8(rtwdev, REG_AMPDU_MAX_TIME_V1, WLAN_AMPDU_MAX_TIME);\n\trtw_write8_set(rtwdev, REG_TX_HANG_CTRL, BIT_EN_EOF_V1);\n\tvalue32 = WLAN_RTS_LEN_TH | (WLAN_RTS_TX_TIME_TH << 8) |\n\t\t  (WLAN_MAX_AGG_PKT_LIMIT << 16) |\n\t\t  (WLAN_RTS_MAX_AGG_PKT_LIMIT << 24);\n\trtw_write32(rtwdev, REG_PROT_MODE_CTRL, value32);\n\trtw_write16(rtwdev, REG_BAR_MODE_CTRL + 2,\n\t\t    WLAN_BAR_RETRY_LIMIT | WLAN_RA_TRY_RATE_AGG_LIMIT << 8);\n\trtw_write8(rtwdev, REG_FAST_EDCA_VOVI_SETTING, FAST_EDCA_VO_TH);\n\trtw_write8(rtwdev, REG_FAST_EDCA_VOVI_SETTING + 2, FAST_EDCA_VI_TH);\n\trtw_write8(rtwdev, REG_FAST_EDCA_BEBK_SETTING, FAST_EDCA_BE_TH);\n\trtw_write8(rtwdev, REG_FAST_EDCA_BEBK_SETTING + 2, FAST_EDCA_BK_TH);\n\t \n\trtw_write8_clr(rtwdev, REG_TIMER0_SRC_SEL, BIT_TSFT_SEL_TIMER0);\n\trtw_write16(rtwdev, REG_TXPAUSE, 0x0000);\n\trtw_write8(rtwdev, REG_SLOT, WLAN_SLOT_TIME);\n\trtw_write8(rtwdev, REG_PIFS, WLAN_PIFS_TIME);\n\trtw_write32(rtwdev, REG_SIFS, WLAN_SIFS_CFG);\n\trtw_write16(rtwdev, REG_EDCA_VO_PARAM + 2, WLAN_VO_TXOP_LIMIT);\n\trtw_write16(rtwdev, REG_EDCA_VI_PARAM + 2, WLAN_VI_TXOP_LIMIT);\n\trtw_write32(rtwdev, REG_RD_NAV_NXT, WLAN_NAV_CFG);\n\trtw_write16(rtwdev, REG_RXTSF_OFFSET_CCK, WLAN_RX_TSF_CFG);\n\t \n\trtw_write8_set(rtwdev, REG_BCN_CTRL, BIT_EN_BCN_FUNCTION);\n\t \n\trtw_write32(rtwdev, REG_TBTT_PROHIBIT, WLAN_TBTT_TIME);\n\trtw_write8(rtwdev, REG_DRVERLYINT, WLAN_DRV_EARLY_INT);\n\trtw_write8(rtwdev, REG_BCNDMATIM, WLAN_BCN_DMA_TIME);\n\trtw_write8_clr(rtwdev, REG_TX_PTCL_CTRL + 1, BIT_SIFS_BK_EN >> 8);\n\t \n\trtw_write32(rtwdev, REG_RXFLTMAP0, WLAN_RX_FILTER0);\n\trtw_write16(rtwdev, REG_RXFLTMAP2, WLAN_RX_FILTER2);\n\trtw_write32(rtwdev, REG_RCR, WLAN_RCR_CFG);\n\trtw_write8(rtwdev, REG_RX_PKT_LIMIT, WLAN_RXPKT_MAX_SZ_512);\n\trtw_write8(rtwdev, REG_TCR + 2, WLAN_TX_FUNC_CFG2);\n\trtw_write8(rtwdev, REG_TCR + 1, WLAN_TX_FUNC_CFG1);\n\trtw_write32(rtwdev, REG_WMAC_OPTION_FUNCTION + 8, WLAN_MAC_OPT_FUNC2);\n\trtw_write8(rtwdev, REG_WMAC_OPTION_FUNCTION + 4, WLAN_MAC_OPT_NORM_FUNC1);\n\trtw_write8_set(rtwdev, REG_SND_PTCL_CTRL,\n\t\t       BIT_DIS_CHK_VHTSIGB_CRC);\n\n\treturn 0;\n}\n\nstatic void rtw8822b_set_channel_rfe_efem(struct rtw_dev *rtwdev, u8 channel)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\n\tif (IS_CH_2G_BAND(channel)) {\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL0, 0xffffff, 0x705770);\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL8, MASKBYTE1, 0x57);\n\t\trtw_write32s_mask(rtwdev, REG_RFECTL, BIT(4), 0);\n\t} else {\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL0, 0xffffff, 0x177517);\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL8, MASKBYTE1, 0x75);\n\t\trtw_write32s_mask(rtwdev, REG_RFECTL, BIT(5), 0);\n\t}\n\n\trtw_write32s_mask(rtwdev, REG_RFEINV, BIT(11) | BIT(10) | 0x3f, 0x0);\n\n\tif (hal->antenna_rx == BB_PATH_AB ||\n\t    hal->antenna_tx == BB_PATH_AB) {\n\t\t \n\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa501);\n\t} else if (hal->antenna_rx == hal->antenna_tx) {\n\t\t \n\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa500);\n\t} else {\n\t\t \n\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa005);\n\t}\n}\n\nstatic void rtw8822b_set_channel_rfe_ifem(struct rtw_dev *rtwdev, u8 channel)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\n\tif (IS_CH_2G_BAND(channel)) {\n\t\t \n\t\trtw_write32s_mask(rtwdev, REG_RFESEL0, 0xffffff, 0x745774);\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL8, MASKBYTE1, 0x57);\n\t} else {\n\t\t \n\t\trtw_write32s_mask(rtwdev, REG_RFESEL0, 0xffffff, 0x477547);\n\t\trtw_write32s_mask(rtwdev, REG_RFESEL8, MASKBYTE1, 0x75);\n\t}\n\n\trtw_write32s_mask(rtwdev, REG_RFEINV, BIT(11) | BIT(10) | 0x3f, 0x0);\n\n\tif (IS_CH_2G_BAND(channel)) {\n\t\tif (hal->antenna_rx == BB_PATH_AB ||\n\t\t    hal->antenna_tx == BB_PATH_AB) {\n\t\t\t \n\t\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa501);\n\t\t} else if (hal->antenna_rx == hal->antenna_tx) {\n\t\t\t \n\t\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa500);\n\t\t} else {\n\t\t\t \n\t\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa005);\n\t\t}\n\t} else {\n\t\trtw_write32s_mask(rtwdev, REG_TRSW, MASKLWORD, 0xa5a5);\n\t}\n}\n\nenum {\n\tCCUT_IDX_1R_2G,\n\tCCUT_IDX_2R_2G,\n\tCCUT_IDX_1R_5G,\n\tCCUT_IDX_2R_5G,\n\tCCUT_IDX_NR,\n};\n\nstruct cca_ccut {\n\tu32 reg82c[CCUT_IDX_NR];\n\tu32 reg830[CCUT_IDX_NR];\n\tu32 reg838[CCUT_IDX_NR];\n};\n\nstatic const struct cca_ccut cca_ifem_ccut = {\n\t{0x75C97010, 0x75C97010, 0x75C97010, 0x75C97010},  \n\t{0x79a0eaaa, 0x79A0EAAC, 0x79a0eaaa, 0x79a0eaaa},  \n\t{0x87765541, 0x87746341, 0x87765541, 0x87746341},  \n};\n\nstatic const struct cca_ccut cca_efem_ccut = {\n\t{0x75B86010, 0x75B76010, 0x75B86010, 0x75B76010},  \n\t{0x79A0EAA8, 0x79A0EAAC, 0x79A0EAA8, 0x79a0eaaa},  \n\t{0x87766451, 0x87766431, 0x87766451, 0x87766431},  \n};\n\nstatic const struct cca_ccut cca_ifem_ccut_ext = {\n\t{0x75da8010, 0x75da8010, 0x75da8010, 0x75da8010},  \n\t{0x79a0eaaa, 0x97A0EAAC, 0x79a0eaaa, 0x79a0eaaa},  \n\t{0x87765541, 0x86666341, 0x87765561, 0x86666361},  \n};\n\nstatic void rtw8822b_get_cca_val(const struct cca_ccut *cca_ccut, u8 col,\n\t\t\t\t u32 *reg82c, u32 *reg830, u32 *reg838)\n{\n\t*reg82c = cca_ccut->reg82c[col];\n\t*reg830 = cca_ccut->reg830[col];\n\t*reg838 = cca_ccut->reg838[col];\n}\n\nstruct rtw8822b_rfe_info {\n\tconst struct cca_ccut *cca_ccut_2g;\n\tconst struct cca_ccut *cca_ccut_5g;\n\tenum rtw_rfe_fem fem;\n\tbool ifem_ext;\n\tvoid (*rtw_set_channel_rfe)(struct rtw_dev *rtwdev, u8 channel);\n};\n\n#define I2GE5G_CCUT(set_ch) {\t\t\t\t\t\t\\\n\t.cca_ccut_2g = &cca_ifem_ccut,\t\t\t\t\t\\\n\t.cca_ccut_5g = &cca_efem_ccut,\t\t\t\t\t\\\n\t.fem = RTW_RFE_IFEM2G_EFEM5G,\t\t\t\t\t\\\n\t.ifem_ext = false,\t\t\t\t\t\t\\\n\t.rtw_set_channel_rfe = &rtw8822b_set_channel_rfe_ ## set_ch,\t\\\n\t}\n#define IFEM_EXT_CCUT(set_ch) {\t\t\t\t\t\t\\\n\t.cca_ccut_2g = &cca_ifem_ccut_ext,\t\t\t\t\\\n\t.cca_ccut_5g = &cca_ifem_ccut_ext,\t\t\t\t\\\n\t.fem = RTW_RFE_IFEM,\t\t\t\t\t\t\\\n\t.ifem_ext = true,\t\t\t\t\t\t\\\n\t.rtw_set_channel_rfe = &rtw8822b_set_channel_rfe_ ## set_ch,\t\\\n\t}\n\nstatic const struct rtw8822b_rfe_info rtw8822b_rfe_info[] = {\n\t[2] = I2GE5G_CCUT(efem),\n\t[3] = IFEM_EXT_CCUT(ifem),\n\t[5] = IFEM_EXT_CCUT(ifem),\n};\n\nstatic void rtw8822b_set_channel_cca(struct rtw_dev *rtwdev, u8 channel, u8 bw,\n\t\t\t\t     const struct rtw8822b_rfe_info *rfe_info)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tconst struct cca_ccut *cca_ccut;\n\tu8 col;\n\tu32 reg82c, reg830, reg838;\n\tbool is_efem_cca = false, is_ifem_cca = false, is_rfe_type = false;\n\n\tif (IS_CH_2G_BAND(channel)) {\n\t\tcca_ccut = rfe_info->cca_ccut_2g;\n\n\t\tif (hal->antenna_rx == BB_PATH_A ||\n\t\t    hal->antenna_rx == BB_PATH_B)\n\t\t\tcol = CCUT_IDX_1R_2G;\n\t\telse\n\t\t\tcol = CCUT_IDX_2R_2G;\n\t} else {\n\t\tcca_ccut = rfe_info->cca_ccut_5g;\n\n\t\tif (hal->antenna_rx == BB_PATH_A ||\n\t\t    hal->antenna_rx == BB_PATH_B)\n\t\t\tcol = CCUT_IDX_1R_5G;\n\t\telse\n\t\t\tcol = CCUT_IDX_2R_5G;\n\t}\n\n\trtw8822b_get_cca_val(cca_ccut, col, &reg82c, &reg830, &reg838);\n\n\tswitch (rfe_info->fem) {\n\tcase RTW_RFE_IFEM:\n\tdefault:\n\t\tis_ifem_cca = true;\n\t\tif (rfe_info->ifem_ext)\n\t\t\tis_rfe_type = true;\n\t\tbreak;\n\tcase RTW_RFE_EFEM:\n\t\tis_efem_cca = true;\n\t\tbreak;\n\tcase RTW_RFE_IFEM2G_EFEM5G:\n\t\tif (IS_CH_2G_BAND(channel))\n\t\t\tis_ifem_cca = true;\n\t\telse\n\t\t\tis_efem_cca = true;\n\t\tbreak;\n\t}\n\n\tif (is_ifem_cca) {\n\t\tif ((hal->cut_version == RTW_CHIP_VER_CUT_B &&\n\t\t     (col == CCUT_IDX_2R_2G || col == CCUT_IDX_2R_5G) &&\n\t\t     bw == RTW_CHANNEL_WIDTH_40) ||\n\t\t    (!is_rfe_type && col == CCUT_IDX_2R_5G &&\n\t\t     bw == RTW_CHANNEL_WIDTH_40) ||\n\t\t    (efuse->rfe_option == 5 && col == CCUT_IDX_2R_5G))\n\t\t\treg830 = 0x79a0ea28;\n\t}\n\n\trtw_write32_mask(rtwdev, REG_CCASEL, MASKDWORD, reg82c);\n\trtw_write32_mask(rtwdev, REG_PDMFTH, MASKDWORD, reg830);\n\trtw_write32_mask(rtwdev, REG_CCA2ND, MASKDWORD, reg838);\n\n\tif (is_efem_cca && !(hal->cut_version == RTW_CHIP_VER_CUT_B))\n\t\trtw_write32_mask(rtwdev, REG_L1WT, MASKDWORD, 0x9194b2b9);\n\n\tif (bw == RTW_CHANNEL_WIDTH_20 && IS_CH_5G_BAND_MID(channel))\n\t\trtw_write32_mask(rtwdev, REG_CCA2ND, 0xf0, 0x4);\n}\n\nstatic const u8 low_band[15] = {0x7, 0x6, 0x6, 0x5, 0x0, 0x0, 0x7, 0xff, 0x6,\n\t\t\t\t0x5, 0x0, 0x0, 0x7, 0x6, 0x6};\nstatic const u8 middle_band[23] = {0x6, 0x5, 0x0, 0x0, 0x7, 0x6, 0x6, 0xff, 0x0,\n\t\t\t\t   0x0, 0x7, 0x6, 0x6, 0x5, 0x0, 0xff, 0x7, 0x6,\n\t\t\t\t   0x6, 0x5, 0x0, 0x0, 0x7};\nstatic const u8 high_band[15] = {0x5, 0x5, 0x0, 0x7, 0x7, 0x6, 0x5, 0xff, 0x0,\n\t\t\t\t 0x7, 0x7, 0x6, 0x5, 0x5, 0x0};\n\nstatic void rtw8822b_set_channel_rf(struct rtw_dev *rtwdev, u8 channel, u8 bw)\n{\n#define RF18_BAND_MASK\t\t(BIT(16) | BIT(9) | BIT(8))\n#define RF18_BAND_2G\t\t(0)\n#define RF18_BAND_5G\t\t(BIT(16) | BIT(8))\n#define RF18_CHANNEL_MASK\t(MASKBYTE0)\n#define RF18_RFSI_MASK\t\t(BIT(18) | BIT(17))\n#define RF18_RFSI_GE_CH80\t(BIT(17))\n#define RF18_RFSI_GT_CH144\t(BIT(18))\n#define RF18_BW_MASK\t\t(BIT(11) | BIT(10))\n#define RF18_BW_20M\t\t(BIT(11) | BIT(10))\n#define RF18_BW_40M\t\t(BIT(11))\n#define RF18_BW_80M\t\t(BIT(10))\n#define RFBE_MASK\t\t(BIT(17) | BIT(16) | BIT(15))\n\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tu32 rf_reg18, rf_reg_be;\n\n\trf_reg18 = rtw_read_rf(rtwdev, RF_PATH_A, 0x18, RFREG_MASK);\n\n\trf_reg18 &= ~(RF18_BAND_MASK | RF18_CHANNEL_MASK | RF18_RFSI_MASK |\n\t\t      RF18_BW_MASK);\n\n\trf_reg18 |= (IS_CH_2G_BAND(channel) ? RF18_BAND_2G : RF18_BAND_5G);\n\trf_reg18 |= (channel & RF18_CHANNEL_MASK);\n\tif (channel > 144)\n\t\trf_reg18 |= RF18_RFSI_GT_CH144;\n\telse if (channel >= 80)\n\t\trf_reg18 |= RF18_RFSI_GE_CH80;\n\n\tswitch (bw) {\n\tcase RTW_CHANNEL_WIDTH_5:\n\tcase RTW_CHANNEL_WIDTH_10:\n\tcase RTW_CHANNEL_WIDTH_20:\n\tdefault:\n\t\trf_reg18 |= RF18_BW_20M;\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_40:\n\t\trf_reg18 |= RF18_BW_40M;\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_80:\n\t\trf_reg18 |= RF18_BW_80M;\n\t\tbreak;\n\t}\n\n\tif (IS_CH_2G_BAND(channel))\n\t\trf_reg_be = 0x0;\n\telse if (IS_CH_5G_BAND_1(channel) || IS_CH_5G_BAND_2(channel))\n\t\trf_reg_be = low_band[(channel - 36) >> 1];\n\telse if (IS_CH_5G_BAND_3(channel))\n\t\trf_reg_be = middle_band[(channel - 100) >> 1];\n\telse if (IS_CH_5G_BAND_4(channel))\n\t\trf_reg_be = high_band[(channel - 149) >> 1];\n\telse\n\t\tgoto err;\n\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_MALSEL, RFBE_MASK, rf_reg_be);\n\n\t \n\tif (channel == 144)\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTDBG, BIT(18), 0x1);\n\telse\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTDBG, BIT(18), 0x0);\n\n\trtw_write_rf(rtwdev, RF_PATH_A, 0x18, RFREG_MASK, rf_reg18);\n\tif (hal->rf_type > RF_1T1R)\n\t\trtw_write_rf(rtwdev, RF_PATH_B, 0x18, RFREG_MASK, rf_reg18);\n\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_XTALX2, BIT(19), 0);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_XTALX2, BIT(19), 1);\n\n\treturn;\n\nerr:\n\tWARN_ON(1);\n}\n\nstatic void rtw8822b_toggle_igi(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tu32 igi;\n\n\tigi = rtw_read32_mask(rtwdev, REG_RXIGI_A, 0x7f);\n\trtw_write32_mask(rtwdev, REG_RXIGI_A, 0x7f, igi - 2);\n\trtw_write32_mask(rtwdev, REG_RXIGI_A, 0x7f, igi);\n\trtw_write32_mask(rtwdev, REG_RXIGI_B, 0x7f, igi - 2);\n\trtw_write32_mask(rtwdev, REG_RXIGI_B, 0x7f, igi);\n\n\trtw_write32_mask(rtwdev, REG_RXPSEL, MASKBYTE0, 0x0);\n\trtw_write32_mask(rtwdev, REG_RXPSEL, MASKBYTE0,\n\t\t\t hal->antenna_rx | (hal->antenna_rx << 4));\n}\n\nstatic void rtw8822b_set_channel_rxdfir(struct rtw_dev *rtwdev, u8 bw)\n{\n\tif (bw == RTW_CHANNEL_WIDTH_40) {\n\t\t \n\t\trtw_write32_mask(rtwdev, REG_ACBB0, BIT(29) | BIT(28), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_ACBBRXFIR, BIT(29) | BIT(28), 0x0);\n\t\trtw_write32s_mask(rtwdev, REG_TXDFIR, BIT(31), 0x0);\n\t} else if (bw == RTW_CHANNEL_WIDTH_80) {\n\t\t \n\t\trtw_write32_mask(rtwdev, REG_ACBB0, BIT(29) | BIT(28), 0x2);\n\t\trtw_write32_mask(rtwdev, REG_ACBBRXFIR, BIT(29) | BIT(28), 0x1);\n\t\trtw_write32s_mask(rtwdev, REG_TXDFIR, BIT(31), 0x0);\n\t} else {\n\t\t \n\t\trtw_write32_mask(rtwdev, REG_ACBB0, BIT(29) | BIT(28), 0x2);\n\t\trtw_write32_mask(rtwdev, REG_ACBBRXFIR, BIT(29) | BIT(28), 0x2);\n\t\trtw_write32s_mask(rtwdev, REG_TXDFIR, BIT(31), 0x1);\n\t}\n}\n\nstatic void rtw8822b_set_channel_bb(struct rtw_dev *rtwdev, u8 channel, u8 bw,\n\t\t\t\t    u8 primary_ch_idx)\n{\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tu8 rfe_option = efuse->rfe_option;\n\tu32 val32;\n\n\tif (IS_CH_2G_BAND(channel)) {\n\t\trtw_write32_mask(rtwdev, REG_RXPSEL, BIT(28), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_CCK_CHECK, BIT(7), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_ENTXCCK, BIT(18), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_RXCCAMSK, 0x0000FC00, 15);\n\n\t\trtw_write32_mask(rtwdev, REG_ACGG2TBL, 0x1f, 0x0);\n\t\trtw_write32_mask(rtwdev, REG_CLKTRK, 0x1ffe0000, 0x96a);\n\t\tif (channel == 14) {\n\t\t\trtw_write32_mask(rtwdev, REG_TXSF2, MASKDWORD, 0x00006577);\n\t\t\trtw_write32_mask(rtwdev, REG_TXSF6, MASKLWORD, 0x0000);\n\t\t} else {\n\t\t\trtw_write32_mask(rtwdev, REG_TXSF2, MASKDWORD, 0x384f6577);\n\t\t\trtw_write32_mask(rtwdev, REG_TXSF6, MASKLWORD, 0x1525);\n\t\t}\n\n\t\trtw_write32_mask(rtwdev, REG_RFEINV, 0x300, 0x2);\n\t} else if (IS_CH_5G_BAND(channel)) {\n\t\trtw_write32_mask(rtwdev, REG_ENTXCCK, BIT(18), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_CCK_CHECK, BIT(7), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_RXPSEL, BIT(28), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_RXCCAMSK, 0x0000FC00, 34);\n\n\t\tif (IS_CH_5G_BAND_1(channel) || IS_CH_5G_BAND_2(channel))\n\t\t\trtw_write32_mask(rtwdev, REG_ACGG2TBL, 0x1f, 0x1);\n\t\telse if (IS_CH_5G_BAND_3(channel))\n\t\t\trtw_write32_mask(rtwdev, REG_ACGG2TBL, 0x1f, 0x2);\n\t\telse if (IS_CH_5G_BAND_4(channel))\n\t\t\trtw_write32_mask(rtwdev, REG_ACGG2TBL, 0x1f, 0x3);\n\n\t\tif (IS_CH_5G_BAND_1(channel))\n\t\t\trtw_write32_mask(rtwdev, REG_CLKTRK, 0x1ffe0000, 0x494);\n\t\telse if (IS_CH_5G_BAND_2(channel))\n\t\t\trtw_write32_mask(rtwdev, REG_CLKTRK, 0x1ffe0000, 0x453);\n\t\telse if (channel >= 100 && channel <= 116)\n\t\t\trtw_write32_mask(rtwdev, REG_CLKTRK, 0x1ffe0000, 0x452);\n\t\telse if (channel >= 118 && channel <= 177)\n\t\t\trtw_write32_mask(rtwdev, REG_CLKTRK, 0x1ffe0000, 0x412);\n\n\t\trtw_write32_mask(rtwdev, 0xcbc, 0x300, 0x1);\n\t}\n\n\tswitch (bw) {\n\tcase RTW_CHANNEL_WIDTH_20:\n\tdefault:\n\t\tval32 = rtw_read32_mask(rtwdev, REG_ADCCLK, MASKDWORD);\n\t\tval32 &= 0xFFCFFC00;\n\t\tval32 |= (RTW_CHANNEL_WIDTH_20);\n\t\trtw_write32_mask(rtwdev, REG_ADCCLK, MASKDWORD, val32);\n\n\t\trtw_write32_mask(rtwdev, REG_ADC160, BIT(30), 0x1);\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_40:\n\t\tif (primary_ch_idx == RTW_SC_20_UPPER)\n\t\t\trtw_write32_set(rtwdev, REG_RXSB, BIT(4));\n\t\telse\n\t\t\trtw_write32_clr(rtwdev, REG_RXSB, BIT(4));\n\n\t\tval32 = rtw_read32_mask(rtwdev, REG_ADCCLK, MASKDWORD);\n\t\tval32 &= 0xFF3FF300;\n\t\tval32 |= (((primary_ch_idx & 0xf) << 2) | RTW_CHANNEL_WIDTH_40);\n\t\trtw_write32_mask(rtwdev, REG_ADCCLK, MASKDWORD, val32);\n\n\t\trtw_write32_mask(rtwdev, REG_ADC160, BIT(30), 0x1);\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_80:\n\t\tval32 = rtw_read32_mask(rtwdev, REG_ADCCLK, MASKDWORD);\n\t\tval32 &= 0xFCEFCF00;\n\t\tval32 |= (((primary_ch_idx & 0xf) << 2) | RTW_CHANNEL_WIDTH_80);\n\t\trtw_write32_mask(rtwdev, REG_ADCCLK, MASKDWORD, val32);\n\n\t\trtw_write32_mask(rtwdev, REG_ADC160, BIT(30), 0x1);\n\n\t\tif (rfe_option == 2 || rfe_option == 3) {\n\t\t\trtw_write32_mask(rtwdev, REG_L1PKWT, 0x0000f000, 0x6);\n\t\t\trtw_write32_mask(rtwdev, REG_ADC40, BIT(10), 0x1);\n\t\t}\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_5:\n\t\tval32 = rtw_read32_mask(rtwdev, REG_ADCCLK, MASKDWORD);\n\t\tval32 &= 0xEFEEFE00;\n\t\tval32 |= ((BIT(6) | RTW_CHANNEL_WIDTH_20));\n\t\trtw_write32_mask(rtwdev, REG_ADCCLK, MASKDWORD, val32);\n\n\t\trtw_write32_mask(rtwdev, REG_ADC160, BIT(30), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_ADC40, BIT(31), 0x1);\n\t\tbreak;\n\tcase RTW_CHANNEL_WIDTH_10:\n\t\tval32 = rtw_read32_mask(rtwdev, REG_ADCCLK, MASKDWORD);\n\t\tval32 &= 0xEFFEFF00;\n\t\tval32 |= ((BIT(7) | RTW_CHANNEL_WIDTH_20));\n\t\trtw_write32_mask(rtwdev, REG_ADCCLK, MASKDWORD, val32);\n\n\t\trtw_write32_mask(rtwdev, REG_ADC160, BIT(30), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_ADC40, BIT(31), 0x1);\n\t\tbreak;\n\t}\n}\n\nstatic void rtw8822b_set_channel(struct rtw_dev *rtwdev, u8 channel, u8 bw,\n\t\t\t\t u8 primary_chan_idx)\n{\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tconst struct rtw8822b_rfe_info *rfe_info;\n\n\tif (WARN(efuse->rfe_option >= ARRAY_SIZE(rtw8822b_rfe_info),\n\t\t \"rfe_option %d is out of boundary\\n\", efuse->rfe_option))\n\t\treturn;\n\n\trfe_info = &rtw8822b_rfe_info[efuse->rfe_option];\n\n\trtw8822b_set_channel_bb(rtwdev, channel, bw, primary_chan_idx);\n\trtw_set_channel_mac(rtwdev, channel, bw, primary_chan_idx);\n\trtw8822b_set_channel_rf(rtwdev, channel, bw);\n\trtw8822b_set_channel_rxdfir(rtwdev, bw);\n\trtw8822b_toggle_igi(rtwdev);\n\trtw8822b_set_channel_cca(rtwdev, channel, bw, rfe_info);\n\t(*rfe_info->rtw_set_channel_rfe)(rtwdev, channel);\n}\n\nstatic void rtw8822b_config_trx_mode(struct rtw_dev *rtwdev, u8 tx_path,\n\t\t\t\t     u8 rx_path, bool is_tx2_path)\n{\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tconst struct rtw8822b_rfe_info *rfe_info;\n\tu8 ch = rtwdev->hal.current_channel;\n\tu8 tx_path_sel, rx_path_sel;\n\tint counter;\n\n\tif (WARN(efuse->rfe_option >= ARRAY_SIZE(rtw8822b_rfe_info),\n\t\t \"rfe_option %d is out of boundary\\n\", efuse->rfe_option))\n\t\treturn;\n\n\trfe_info = &rtw8822b_rfe_info[efuse->rfe_option];\n\n\tif ((tx_path | rx_path) & BB_PATH_A)\n\t\trtw_write32_mask(rtwdev, REG_AGCTR_A, MASKLWORD, 0x3231);\n\telse\n\t\trtw_write32_mask(rtwdev, REG_AGCTR_A, MASKLWORD, 0x1111);\n\n\tif ((tx_path | rx_path) & BB_PATH_B)\n\t\trtw_write32_mask(rtwdev, REG_AGCTR_B, MASKLWORD, 0x3231);\n\telse\n\t\trtw_write32_mask(rtwdev, REG_AGCTR_B, MASKLWORD, 0x1111);\n\n\trtw_write32_mask(rtwdev, REG_CDDTXP, (BIT(19) | BIT(18)), 0x3);\n\trtw_write32_mask(rtwdev, REG_TXPSEL, (BIT(29) | BIT(28)), 0x1);\n\trtw_write32_mask(rtwdev, REG_TXPSEL, BIT(30), 0x1);\n\n\tif (tx_path & BB_PATH_A) {\n\t\trtw_write32_mask(rtwdev, REG_CDDTXP, 0xfff00000, 0x001);\n\t\trtw_write32_mask(rtwdev, REG_ADCINI, 0xf0000000, 0x8);\n\t} else if (tx_path & BB_PATH_B) {\n\t\trtw_write32_mask(rtwdev, REG_CDDTXP, 0xfff00000, 0x002);\n\t\trtw_write32_mask(rtwdev, REG_ADCINI, 0xf0000000, 0x4);\n\t}\n\n\tif (tx_path == BB_PATH_A || tx_path == BB_PATH_B)\n\t\trtw_write32_mask(rtwdev, REG_TXPSEL1, 0xfff0, 0x01);\n\telse\n\t\trtw_write32_mask(rtwdev, REG_TXPSEL1, 0xfff0, 0x43);\n\n\ttx_path_sel = (tx_path << 4) | tx_path;\n\trtw_write32_mask(rtwdev, REG_TXPSEL, MASKBYTE0, tx_path_sel);\n\n\tif (tx_path != BB_PATH_A && tx_path != BB_PATH_B) {\n\t\tif (is_tx2_path || rtwdev->mp_mode) {\n\t\t\trtw_write32_mask(rtwdev, REG_CDDTXP, 0xfff00000, 0x043);\n\t\t\trtw_write32_mask(rtwdev, REG_ADCINI, 0xf0000000, 0xc);\n\t\t}\n\t}\n\n\trtw_write32_mask(rtwdev, REG_RXDESC, BIT(22), 0x0);\n\trtw_write32_mask(rtwdev, REG_RXDESC, BIT(18), 0x0);\n\n\tif (rx_path & BB_PATH_A)\n\t\trtw_write32_mask(rtwdev, REG_ADCINI, 0x0f000000, 0x0);\n\telse if (rx_path & BB_PATH_B)\n\t\trtw_write32_mask(rtwdev, REG_ADCINI, 0x0f000000, 0x5);\n\n\trx_path_sel = (rx_path << 4) | rx_path;\n\trtw_write32_mask(rtwdev, REG_RXPSEL, MASKBYTE0, rx_path_sel);\n\n\tif (rx_path == BB_PATH_A || rx_path == BB_PATH_B) {\n\t\trtw_write32_mask(rtwdev, REG_ANTWT, BIT(16), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_HTSTFWT, BIT(28), 0x0);\n\t\trtw_write32_mask(rtwdev, REG_MRC, BIT(23), 0x0);\n\t} else {\n\t\trtw_write32_mask(rtwdev, REG_ANTWT, BIT(16), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_HTSTFWT, BIT(28), 0x1);\n\t\trtw_write32_mask(rtwdev, REG_MRC, BIT(23), 0x1);\n\t}\n\n\tfor (counter = 100; counter > 0; counter--) {\n\t\tu32 rf_reg33;\n\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWE, RFREG_MASK, 0x80000);\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWA, RFREG_MASK, 0x00001);\n\n\t\tudelay(2);\n\t\trf_reg33 = rtw_read_rf(rtwdev, RF_PATH_A, 0x33, RFREG_MASK);\n\n\t\tif (rf_reg33 == 0x00001)\n\t\t\tbreak;\n\t}\n\n\tif (WARN(counter <= 0, \"write RF mode table fail\\n\"))\n\t\treturn;\n\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWE, RFREG_MASK, 0x80000);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWA, RFREG_MASK, 0x00001);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWD1, RFREG_MASK, 0x00034);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWD0, RFREG_MASK, 0x4080c);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWE, RFREG_MASK, 0x00000);\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_LUTWE, RFREG_MASK, 0x00000);\n\n\trtw8822b_toggle_igi(rtwdev);\n\trtw8822b_set_channel_cca(rtwdev, 1, RTW_CHANNEL_WIDTH_20, rfe_info);\n\t(*rfe_info->rtw_set_channel_rfe)(rtwdev, ch);\n}\n\nstatic void query_phy_status_page0(struct rtw_dev *rtwdev, u8 *phy_status,\n\t\t\t\t   struct rtw_rx_pkt_stat *pkt_stat)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\ts8 min_rx_power = -120;\n\tu8 pwdb = GET_PHY_STAT_P0_PWDB(phy_status);\n\n\t \n\tpkt_stat->rx_power[RF_PATH_A] = pwdb - 110;\n\tpkt_stat->rssi = rtw_phy_rf_power_2_rssi(pkt_stat->rx_power, 1);\n\tpkt_stat->bw = RTW_CHANNEL_WIDTH_20;\n\tpkt_stat->signal_power = max(pkt_stat->rx_power[RF_PATH_A],\n\t\t\t\t     min_rx_power);\n\tdm_info->rssi[RF_PATH_A] = pkt_stat->rssi;\n}\n\nstatic void query_phy_status_page1(struct rtw_dev *rtwdev, u8 *phy_status,\n\t\t\t\t   struct rtw_rx_pkt_stat *pkt_stat)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tu8 rxsc, bw;\n\ts8 min_rx_power = -120;\n\ts8 rx_evm;\n\tu8 evm_dbm = 0;\n\tu8 rssi;\n\tint path;\n\n\tif (pkt_stat->rate > DESC_RATE11M && pkt_stat->rate < DESC_RATEMCS0)\n\t\trxsc = GET_PHY_STAT_P1_L_RXSC(phy_status);\n\telse\n\t\trxsc = GET_PHY_STAT_P1_HT_RXSC(phy_status);\n\n\tif (rxsc >= 1 && rxsc <= 8)\n\t\tbw = RTW_CHANNEL_WIDTH_20;\n\telse if (rxsc >= 9 && rxsc <= 12)\n\t\tbw = RTW_CHANNEL_WIDTH_40;\n\telse if (rxsc >= 13)\n\t\tbw = RTW_CHANNEL_WIDTH_80;\n\telse\n\t\tbw = GET_PHY_STAT_P1_RF_MODE(phy_status);\n\n\tpkt_stat->rx_power[RF_PATH_A] = GET_PHY_STAT_P1_PWDB_A(phy_status) - 110;\n\tpkt_stat->rx_power[RF_PATH_B] = GET_PHY_STAT_P1_PWDB_B(phy_status) - 110;\n\tpkt_stat->rssi = rtw_phy_rf_power_2_rssi(pkt_stat->rx_power, 2);\n\tpkt_stat->bw = bw;\n\tpkt_stat->signal_power = max3(pkt_stat->rx_power[RF_PATH_A],\n\t\t\t\t      pkt_stat->rx_power[RF_PATH_B],\n\t\t\t\t      min_rx_power);\n\n\tdm_info->curr_rx_rate = pkt_stat->rate;\n\n\tpkt_stat->rx_evm[RF_PATH_A] = GET_PHY_STAT_P1_RXEVM_A(phy_status);\n\tpkt_stat->rx_evm[RF_PATH_B] = GET_PHY_STAT_P1_RXEVM_B(phy_status);\n\n\tpkt_stat->rx_snr[RF_PATH_A] = GET_PHY_STAT_P1_RXSNR_A(phy_status);\n\tpkt_stat->rx_snr[RF_PATH_B] = GET_PHY_STAT_P1_RXSNR_B(phy_status);\n\n\tpkt_stat->cfo_tail[RF_PATH_A] = GET_PHY_STAT_P1_CFO_TAIL_A(phy_status);\n\tpkt_stat->cfo_tail[RF_PATH_B] = GET_PHY_STAT_P1_CFO_TAIL_B(phy_status);\n\n\tfor (path = 0; path <= rtwdev->hal.rf_path_num; path++) {\n\t\trssi = rtw_phy_rf_power_2_rssi(&pkt_stat->rx_power[path], 1);\n\t\tdm_info->rssi[path] = rssi;\n\t\tdm_info->rx_snr[path] = pkt_stat->rx_snr[path] >> 1;\n\t\tdm_info->cfo_tail[path] = (pkt_stat->cfo_tail[path] * 5) >> 1;\n\n\t\trx_evm = pkt_stat->rx_evm[path];\n\n\t\tif (rx_evm < 0) {\n\t\t\tif (rx_evm == S8_MIN)\n\t\t\t\tevm_dbm = 0;\n\t\t\telse\n\t\t\t\tevm_dbm = ((u8)-rx_evm >> 1);\n\t\t}\n\t\tdm_info->rx_evm_dbm[path] = evm_dbm;\n\t}\n}\n\nstatic void query_phy_status(struct rtw_dev *rtwdev, u8 *phy_status,\n\t\t\t     struct rtw_rx_pkt_stat *pkt_stat)\n{\n\tu8 page;\n\n\tpage = *phy_status & 0xf;\n\n\tswitch (page) {\n\tcase 0:\n\t\tquery_phy_status_page0(rtwdev, phy_status, pkt_stat);\n\t\tbreak;\n\tcase 1:\n\t\tquery_phy_status_page1(rtwdev, phy_status, pkt_stat);\n\t\tbreak;\n\tdefault:\n\t\trtw_warn(rtwdev, \"unused phy status page (%d)\\n\", page);\n\t\treturn;\n\t}\n}\n\nstatic void rtw8822b_query_rx_desc(struct rtw_dev *rtwdev, u8 *rx_desc,\n\t\t\t\t   struct rtw_rx_pkt_stat *pkt_stat,\n\t\t\t\t   struct ieee80211_rx_status *rx_status)\n{\n\tstruct ieee80211_hdr *hdr;\n\tu32 desc_sz = rtwdev->chip->rx_pkt_desc_sz;\n\tu8 *phy_status = NULL;\n\n\tmemset(pkt_stat, 0, sizeof(*pkt_stat));\n\n\tpkt_stat->phy_status = GET_RX_DESC_PHYST(rx_desc);\n\tpkt_stat->icv_err = GET_RX_DESC_ICV_ERR(rx_desc);\n\tpkt_stat->crc_err = GET_RX_DESC_CRC32(rx_desc);\n\tpkt_stat->decrypted = !GET_RX_DESC_SWDEC(rx_desc) &&\n\t\t\t      GET_RX_DESC_ENC_TYPE(rx_desc) != RX_DESC_ENC_NONE;\n\tpkt_stat->is_c2h = GET_RX_DESC_C2H(rx_desc);\n\tpkt_stat->pkt_len = GET_RX_DESC_PKT_LEN(rx_desc);\n\tpkt_stat->drv_info_sz = GET_RX_DESC_DRV_INFO_SIZE(rx_desc);\n\tpkt_stat->shift = GET_RX_DESC_SHIFT(rx_desc);\n\tpkt_stat->rate = GET_RX_DESC_RX_RATE(rx_desc);\n\tpkt_stat->cam_id = GET_RX_DESC_MACID(rx_desc);\n\tpkt_stat->ppdu_cnt = GET_RX_DESC_PPDU_CNT(rx_desc);\n\tpkt_stat->tsf_low = GET_RX_DESC_TSFL(rx_desc);\n\n\t \n\tpkt_stat->drv_info_sz *= 8;\n\n\t \n\tif (pkt_stat->is_c2h)\n\t\treturn;\n\n\thdr = (struct ieee80211_hdr *)(rx_desc + desc_sz + pkt_stat->shift +\n\t\t\t\t       pkt_stat->drv_info_sz);\n\tif (pkt_stat->phy_status) {\n\t\tphy_status = rx_desc + desc_sz + pkt_stat->shift;\n\t\tquery_phy_status(rtwdev, phy_status, pkt_stat);\n\t}\n\n\trtw_rx_fill_rx_status(rtwdev, pkt_stat, hdr, rx_status, phy_status);\n}\n\nstatic void\nrtw8822b_set_tx_power_index_by_rate(struct rtw_dev *rtwdev, u8 path, u8 rs)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tstatic const u32 offset_txagc[2] = {0x1d00, 0x1d80};\n\tstatic u32 phy_pwr_idx;\n\tu8 rate, rate_idx, pwr_index, shift;\n\tint j;\n\n\tfor (j = 0; j < rtw_rate_size[rs]; j++) {\n\t\trate = rtw_rate_section[rs][j];\n\t\tpwr_index = hal->tx_pwr_tbl[path][rate];\n\t\tshift = rate & 0x3;\n\t\tphy_pwr_idx |= ((u32)pwr_index << (shift * 8));\n\t\tif (shift == 0x3) {\n\t\t\trate_idx = rate & 0xfc;\n\t\t\trtw_write32(rtwdev, offset_txagc[path] + rate_idx,\n\t\t\t\t    phy_pwr_idx);\n\t\t\tphy_pwr_idx = 0;\n\t\t}\n\t}\n}\n\nstatic void rtw8822b_set_tx_power_index(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tint rs, path;\n\n\tfor (path = 0; path < hal->rf_path_num; path++) {\n\t\tfor (rs = 0; rs < RTW_RATE_SECTION_MAX; rs++)\n\t\t\trtw8822b_set_tx_power_index_by_rate(rtwdev, path, rs);\n\t}\n}\n\nstatic bool rtw8822b_check_rf_path(u8 antenna)\n{\n\tswitch (antenna) {\n\tcase BB_PATH_A:\n\tcase BB_PATH_B:\n\tcase BB_PATH_AB:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic int rtw8822b_set_antenna(struct rtw_dev *rtwdev,\n\t\t\t\tu32 antenna_tx,\n\t\t\t\tu32 antenna_rx)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\n\trtw_dbg(rtwdev, RTW_DBG_PHY, \"config RF path, tx=0x%x rx=0x%x\\n\",\n\t\tantenna_tx, antenna_rx);\n\n\tif (!rtw8822b_check_rf_path(antenna_tx)) {\n\t\trtw_warn(rtwdev, \"unsupported tx path 0x%x\\n\", antenna_tx);\n\t\treturn -EINVAL;\n\t}\n\n\tif (!rtw8822b_check_rf_path(antenna_rx)) {\n\t\trtw_warn(rtwdev, \"unsupported rx path 0x%x\\n\", antenna_rx);\n\t\treturn -EINVAL;\n\t}\n\n\thal->antenna_tx = antenna_tx;\n\thal->antenna_rx = antenna_rx;\n\n\trtw8822b_config_trx_mode(rtwdev, antenna_tx, antenna_rx, false);\n\n\treturn 0;\n}\n\nstatic void rtw8822b_cfg_ldo25(struct rtw_dev *rtwdev, bool enable)\n{\n\tu8 ldo_pwr;\n\n\tldo_pwr = rtw_read8(rtwdev, REG_LDO_EFUSE_CTRL + 3);\n\tldo_pwr = enable ? ldo_pwr | BIT_LDO25_EN : ldo_pwr & ~BIT_LDO25_EN;\n\trtw_write8(rtwdev, REG_LDO_EFUSE_CTRL + 3, ldo_pwr);\n}\n\nstatic void rtw8822b_false_alarm_statistics(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tu32 cck_enable;\n\tu32 cck_fa_cnt;\n\tu32 ofdm_fa_cnt;\n\tu32 crc32_cnt;\n\tu32 cca32_cnt;\n\n\tcck_enable = rtw_read32(rtwdev, 0x808) & BIT(28);\n\tcck_fa_cnt = rtw_read16(rtwdev, 0xa5c);\n\tofdm_fa_cnt = rtw_read16(rtwdev, 0xf48);\n\n\tdm_info->cck_fa_cnt = cck_fa_cnt;\n\tdm_info->ofdm_fa_cnt = ofdm_fa_cnt;\n\tdm_info->total_fa_cnt = ofdm_fa_cnt;\n\tdm_info->total_fa_cnt += cck_enable ? cck_fa_cnt : 0;\n\n\tcrc32_cnt = rtw_read32(rtwdev, 0xf04);\n\tdm_info->cck_ok_cnt = crc32_cnt & 0xffff;\n\tdm_info->cck_err_cnt = (crc32_cnt & 0xffff0000) >> 16;\n\tcrc32_cnt = rtw_read32(rtwdev, 0xf14);\n\tdm_info->ofdm_ok_cnt = crc32_cnt & 0xffff;\n\tdm_info->ofdm_err_cnt = (crc32_cnt & 0xffff0000) >> 16;\n\tcrc32_cnt = rtw_read32(rtwdev, 0xf10);\n\tdm_info->ht_ok_cnt = crc32_cnt & 0xffff;\n\tdm_info->ht_err_cnt = (crc32_cnt & 0xffff0000) >> 16;\n\tcrc32_cnt = rtw_read32(rtwdev, 0xf0c);\n\tdm_info->vht_ok_cnt = crc32_cnt & 0xffff;\n\tdm_info->vht_err_cnt = (crc32_cnt & 0xffff0000) >> 16;\n\n\tcca32_cnt = rtw_read32(rtwdev, 0xf08);\n\tdm_info->ofdm_cca_cnt = ((cca32_cnt & 0xffff0000) >> 16);\n\tdm_info->total_cca_cnt = dm_info->ofdm_cca_cnt;\n\tif (cck_enable) {\n\t\tcca32_cnt = rtw_read32(rtwdev, 0xfcc);\n\t\tdm_info->cck_cca_cnt = cca32_cnt & 0xffff;\n\t\tdm_info->total_cca_cnt += dm_info->cck_cca_cnt;\n\t}\n\n\trtw_write32_set(rtwdev, 0x9a4, BIT(17));\n\trtw_write32_clr(rtwdev, 0x9a4, BIT(17));\n\trtw_write32_clr(rtwdev, 0xa2c, BIT(15));\n\trtw_write32_set(rtwdev, 0xa2c, BIT(15));\n\trtw_write32_set(rtwdev, 0xb58, BIT(0));\n\trtw_write32_clr(rtwdev, 0xb58, BIT(0));\n}\n\nstatic void rtw8822b_do_iqk(struct rtw_dev *rtwdev)\n{\n\tstatic int do_iqk_cnt;\n\tstruct rtw_iqk_para para = {.clear = 0, .segment_iqk = 0};\n\tu32 rf_reg, iqk_fail_mask;\n\tint counter;\n\tbool reload;\n\n\trtw_fw_do_iqk(rtwdev, &para);\n\n\tfor (counter = 0; counter < 300; counter++) {\n\t\trf_reg = rtw_read_rf(rtwdev, RF_PATH_A, RF_DTXLOK, RFREG_MASK);\n\t\tif (rf_reg == 0xabcde)\n\t\t\tbreak;\n\t\tmsleep(20);\n\t}\n\trtw_write_rf(rtwdev, RF_PATH_A, RF_DTXLOK, RFREG_MASK, 0x0);\n\n\treload = !!rtw_read32_mask(rtwdev, REG_IQKFAILMSK, BIT(16));\n\tiqk_fail_mask = rtw_read32_mask(rtwdev, REG_IQKFAILMSK, GENMASK(7, 0));\n\trtw_dbg(rtwdev, RTW_DBG_PHY,\n\t\t\"iqk counter=%d reload=%d do_iqk_cnt=%d n_iqk_fail(mask)=0x%02x\\n\",\n\t\tcounter, reload, ++do_iqk_cnt, iqk_fail_mask);\n}\n\nstatic void rtw8822b_phy_calibration(struct rtw_dev *rtwdev)\n{\n\trtw8822b_do_iqk(rtwdev);\n}\n\nstatic void rtw8822b_coex_cfg_init(struct rtw_dev *rtwdev)\n{\n\t \n\trtw_write8_set(rtwdev, REG_BCN_CTRL, BIT_EN_BCN_FUNCTION);\n\n\t \n\t \n\trtw_write8_mask(rtwdev, REG_BT_TDMA_TIME, BIT_MASK_SAMPLE_RATE, 0x5);\n\n\t \n\trtw_write8(rtwdev, REG_BT_STAT_CTRL, 0x1);\n\n\t \n\trtw_write32_set(rtwdev, REG_GPIO_MUXCFG, BIT_BT_PTA_EN);\n\trtw_write32_set(rtwdev, REG_GPIO_MUXCFG, BIT_PO_BT_PTA_PINS);\n\n\t \n\trtw_write8_set(rtwdev, REG_QUEUE_CTRL, BIT_PTA_WL_TX_EN);\n\t \n\trtw_write8_clr(rtwdev, REG_QUEUE_CTRL, BIT_PTA_EDCCA_EN);\n\t \n\trtw_write16_set(rtwdev, REG_BT_COEX_V2, BIT_GNT_BT_POLARITY);\n}\n\nstatic void rtw8822b_coex_cfg_ant_switch(struct rtw_dev *rtwdev,\n\t\t\t\t\t u8 ctrl_type, u8 pos_type)\n{\n\tstruct rtw_coex *coex = &rtwdev->coex;\n\tstruct rtw_coex_dm *coex_dm = &coex->dm;\n\tstruct rtw_coex_rfe *coex_rfe = &coex->rfe;\n\tbool polarity_inverse;\n\tu8 regval = 0;\n\n\tif (((ctrl_type << 8) + pos_type) == coex_dm->cur_switch_status)\n\t\treturn;\n\n\tcoex_dm->cur_switch_status = (ctrl_type << 8) + pos_type;\n\n\tif (coex_rfe->ant_switch_diversity &&\n\t    ctrl_type == COEX_SWITCH_CTRL_BY_BBSW)\n\t\tctrl_type = COEX_SWITCH_CTRL_BY_ANTDIV;\n\n\tpolarity_inverse = (coex_rfe->ant_switch_polarity == 1);\n\n\tswitch (ctrl_type) {\n\tdefault:\n\tcase COEX_SWITCH_CTRL_BY_BBSW:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x0);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 3, BIT_DPDT_WL_SEL >> 24, 0x1);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_RFE_CTRL8, BIT_MASK_RFE_SEL89, 0x77);\n\n\t\tif (pos_type == COEX_SWITCH_TO_WLG_BT) {\n\t\t\tif (coex_rfe->rfe_module_type != 0x4 &&\n\t\t\t    coex_rfe->rfe_module_type != 0x2)\n\t\t\t\tregval = 0x3;\n\t\t\telse\n\t\t\t\tregval = (!polarity_inverse ? 0x2 : 0x1);\n\t\t} else if (pos_type == COEX_SWITCH_TO_WLG) {\n\t\t\tregval = (!polarity_inverse ? 0x2 : 0x1);\n\t\t} else {\n\t\t\tregval = (!polarity_inverse ? 0x1 : 0x2);\n\t\t}\n\n\t\trtw_write8_mask(rtwdev, REG_RFE_INV8, BIT_MASK_RFE_INV89, regval);\n\t\tbreak;\n\tcase COEX_SWITCH_CTRL_BY_PTA:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x0);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 3, BIT_DPDT_WL_SEL >> 24, 0x1);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_RFE_CTRL8, BIT_MASK_RFE_SEL89, 0x66);\n\n\t\tregval = (!polarity_inverse ? 0x2 : 0x1);\n\t\trtw_write8_mask(rtwdev, REG_RFE_INV8, BIT_MASK_RFE_INV89, regval);\n\t\tbreak;\n\tcase COEX_SWITCH_CTRL_BY_ANTDIV:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x0);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 3, BIT_DPDT_WL_SEL >> 24, 0x1);\n\t\trtw_write8_mask(rtwdev, REG_RFE_CTRL8, BIT_MASK_RFE_SEL89, 0x88);\n\t\tbreak;\n\tcase COEX_SWITCH_CTRL_BY_MAC:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x1);\n\n\t\tregval = (!polarity_inverse ? 0x0 : 0x1);\n\t\trtw_write8_mask(rtwdev, REG_PAD_CTRL1, BIT_SW_DPDT_SEL_DATA, regval);\n\t\tbreak;\n\tcase COEX_SWITCH_CTRL_BY_FW:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x0);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 3, BIT_DPDT_WL_SEL >> 24, 0x1);\n\t\tbreak;\n\tcase COEX_SWITCH_CTRL_BY_BT:\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 2, BIT_DPDT_SEL_EN >> 16, 0x0);\n\t\t \n\t\trtw_write8_mask(rtwdev, REG_LED_CFG + 3, BIT_DPDT_WL_SEL >> 24, 0x0);\n\t\tbreak;\n\t}\n}\n\nstatic void rtw8822b_coex_cfg_gnt_fix(struct rtw_dev *rtwdev)\n{\n}\n\nstatic void rtw8822b_coex_cfg_gnt_debug(struct rtw_dev *rtwdev)\n{\n\trtw_write8_mask(rtwdev, REG_PAD_CTRL1 + 2, BIT_BTGP_SPI_EN >> 16, 0);\n\trtw_write8_mask(rtwdev, REG_PAD_CTRL1 + 3, BIT_BTGP_JTAG_EN >> 24, 0);\n\trtw_write8_mask(rtwdev, REG_GPIO_MUXCFG + 2, BIT_FSPI_EN >> 16, 0);\n\trtw_write8_mask(rtwdev, REG_PAD_CTRL1 + 1, BIT_LED1DIS >> 8, 0);\n\trtw_write8_mask(rtwdev, REG_SYS_SDIO_CTRL + 3, BIT_DBG_GNT_WL_BT >> 24, 0);\n}\n\nstatic void rtw8822b_coex_cfg_rfe_type(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_coex *coex = &rtwdev->coex;\n\tstruct rtw_coex_rfe *coex_rfe = &coex->rfe;\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tbool is_ext_fem = false;\n\n\tcoex_rfe->rfe_module_type = rtwdev->efuse.rfe_option;\n\tcoex_rfe->ant_switch_polarity = 0;\n\tcoex_rfe->ant_switch_diversity = false;\n\tif (coex_rfe->rfe_module_type == 0x12 ||\n\t    coex_rfe->rfe_module_type == 0x15 ||\n\t    coex_rfe->rfe_module_type == 0x16)\n\t\tcoex_rfe->ant_switch_exist = false;\n\telse\n\t\tcoex_rfe->ant_switch_exist = true;\n\n\tif (coex_rfe->rfe_module_type == 2 ||\n\t    coex_rfe->rfe_module_type == 4) {\n\t\trtw_coex_write_scbd(rtwdev, COEX_SCBD_EXTFEM, true);\n\t\tis_ext_fem = true;\n\t} else {\n\t\trtw_coex_write_scbd(rtwdev, COEX_SCBD_EXTFEM, false);\n\t}\n\n\tcoex_rfe->wlg_at_btg = false;\n\n\tif (efuse->share_ant &&\n\t    coex_rfe->ant_switch_exist && !is_ext_fem)\n\t\tcoex_rfe->ant_switch_with_bt = true;\n\telse\n\t\tcoex_rfe->ant_switch_with_bt = false;\n\n\t \n\trtw_write8(rtwdev, REG_RFE_CTRL_E, 0xff);\n\trtw_write8_mask(rtwdev, REG_RFESEL_CTRL + 1, 0x3, 0x0);\n\trtw_write8_mask(rtwdev, REG_RFE_INV16, BIT_RFE_BUF_EN, 0x0);\n\n\t \n\trtw_coex_write_indirect_reg(rtwdev, LTE_COEX_CTRL, BIT_LTE_COEX_EN, 0);\n\n\t \n\trtw_coex_write_indirect_reg(rtwdev, LTE_WL_TRX_CTRL, MASKLWORD, 0xffff);\n\n\t \n\trtw_coex_write_indirect_reg(rtwdev, LTE_BT_TRX_CTRL, MASKLWORD, 0xffff);\n}\n\nstatic void rtw8822b_coex_cfg_wl_tx_power(struct rtw_dev *rtwdev, u8 wl_pwr)\n{\n\tstruct rtw_coex *coex = &rtwdev->coex;\n\tstruct rtw_coex_dm *coex_dm = &coex->dm;\n\tstatic const u16 reg_addr[] = {0xc58, 0xe58};\n\tstatic const u8\twl_tx_power[] = {0xd8, 0xd4, 0xd0, 0xcc, 0xc8};\n\tu8 i, pwr;\n\n\tif (wl_pwr == coex_dm->cur_wl_pwr_lvl)\n\t\treturn;\n\n\tcoex_dm->cur_wl_pwr_lvl = wl_pwr;\n\n\tif (coex_dm->cur_wl_pwr_lvl >= ARRAY_SIZE(wl_tx_power))\n\t\tcoex_dm->cur_wl_pwr_lvl = ARRAY_SIZE(wl_tx_power) - 1;\n\n\tpwr = wl_tx_power[coex_dm->cur_wl_pwr_lvl];\n\n\tfor (i = 0; i < ARRAY_SIZE(reg_addr); i++)\n\t\trtw_write8_mask(rtwdev, reg_addr[i], 0xff, pwr);\n}\n\nstatic void rtw8822b_coex_cfg_wl_rx_gain(struct rtw_dev *rtwdev, bool low_gain)\n{\n\tstruct rtw_coex *coex = &rtwdev->coex;\n\tstruct rtw_coex_dm *coex_dm = &coex->dm;\n\t \n\tstatic const u32 wl_rx_low_gain_on[] = {\n\t\t0xff000003, 0xbd120003, 0xbe100003, 0xbf080003, 0xbf060003,\n\t\t0xbf050003, 0xbc140003, 0xbb160003, 0xba180003, 0xb91a0003,\n\t\t0xb81c0003, 0xb71e0003, 0xb4200003, 0xb5220003, 0xb4240003,\n\t\t0xb3260003, 0xb2280003, 0xb12a0003, 0xb02c0003, 0xaf2e0003,\n\t\t0xae300003, 0xad320003, 0xac340003, 0xab360003, 0x8d380003,\n\t\t0x8c3a0003, 0x8b3c0003, 0x8a3e0003, 0x6e400003, 0x6d420003,\n\t\t0x6c440003, 0x6b460003, 0x6a480003, 0x694a0003, 0x684c0003,\n\t\t0x674e0003, 0x66500003, 0x65520003, 0x64540003, 0x64560003,\n\t\t0x007e0403\n\t};\n\n\t \n\tstatic const u32 wl_rx_low_gain_off[] = {\n\t\t0xff000003, 0xf4120003, 0xf5100003, 0xf60e0003, 0xf70c0003,\n\t\t0xf80a0003, 0xf3140003, 0xf2160003, 0xf1180003, 0xf01a0003,\n\t\t0xef1c0003, 0xee1e0003, 0xed200003, 0xec220003, 0xeb240003,\n\t\t0xea260003, 0xe9280003, 0xe82a0003, 0xe72c0003, 0xe62e0003,\n\t\t0xe5300003, 0xc8320003, 0xc7340003, 0xc6360003, 0xc5380003,\n\t\t0xc43a0003, 0xc33c0003, 0xc23e0003, 0xc1400003, 0xc0420003,\n\t\t0xa5440003, 0xa4460003, 0xa3480003, 0xa24a0003, 0xa14c0003,\n\t\t0x834e0003, 0x82500003, 0x81520003, 0x80540003, 0x65560003,\n\t\t0x007e0403\n\t};\n\tu8 i;\n\n\tif (low_gain == coex_dm->cur_wl_rx_low_gain_en)\n\t\treturn;\n\n\tcoex_dm->cur_wl_rx_low_gain_en = low_gain;\n\n\tif (coex_dm->cur_wl_rx_low_gain_en) {\n\t\trtw_dbg(rtwdev, RTW_DBG_COEX, \"[BTCoex], Hi-Li Table On!\\n\");\n\t\tfor (i = 0; i < ARRAY_SIZE(wl_rx_low_gain_on); i++)\n\t\t\trtw_write32(rtwdev, REG_RX_GAIN_EN, wl_rx_low_gain_on[i]);\n\n\t\t \n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_RCKD, 0x2, 0x1);\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_RCK, 0x3f, 0x3f);\n\t\trtw_write_rf(rtwdev, RF_PATH_B, RF_RCKD, 0x2, 0x1);\n\t\trtw_write_rf(rtwdev, RF_PATH_B, RF_RCK, 0x3f, 0x3f);\n\t} else {\n\t\trtw_dbg(rtwdev, RTW_DBG_COEX, \"[BTCoex], Hi-Li Table Off!\\n\");\n\t\tfor (i = 0; i < ARRAY_SIZE(wl_rx_low_gain_off); i++)\n\t\t\trtw_write32(rtwdev, 0x81c, wl_rx_low_gain_off[i]);\n\n\t\t \n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_RCK, 0x3f, 0x4);\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_RCKD, 0x2, 0x0);\n\t\trtw_write_rf(rtwdev, RF_PATH_B, RF_RCK, 0x3f, 0x4);\n\t\trtw_write_rf(rtwdev, RF_PATH_B, RF_RCKD, 0x2, 0x0);\n\t}\n}\n\nstatic void rtw8822b_txagc_swing_offset(struct rtw_dev *rtwdev, u8 path,\n\t\t\t\t\tu8 tx_pwr_idx_offset,\n\t\t\t\t\ts8 *txagc_idx, u8 *swing_idx)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\ts8 delta_pwr_idx = dm_info->delta_power_index[path];\n\tu8 swing_upper_bound = dm_info->default_ofdm_index + 10;\n\tu8 swing_lower_bound = 0;\n\tu8 max_tx_pwr_idx_offset = 0xf;\n\ts8 agc_index = 0;\n\tu8 swing_index = dm_info->default_ofdm_index;\n\n\ttx_pwr_idx_offset = min_t(u8, tx_pwr_idx_offset, max_tx_pwr_idx_offset);\n\n\tif (delta_pwr_idx >= 0) {\n\t\tif (delta_pwr_idx <= tx_pwr_idx_offset) {\n\t\t\tagc_index = delta_pwr_idx;\n\t\t\tswing_index = dm_info->default_ofdm_index;\n\t\t} else if (delta_pwr_idx > tx_pwr_idx_offset) {\n\t\t\tagc_index = tx_pwr_idx_offset;\n\t\t\tswing_index = dm_info->default_ofdm_index +\n\t\t\t\t\tdelta_pwr_idx - tx_pwr_idx_offset;\n\t\t\tswing_index = min_t(u8, swing_index, swing_upper_bound);\n\t\t}\n\t} else {\n\t\tif (dm_info->default_ofdm_index > abs(delta_pwr_idx))\n\t\t\tswing_index =\n\t\t\t\tdm_info->default_ofdm_index + delta_pwr_idx;\n\t\telse\n\t\t\tswing_index = swing_lower_bound;\n\t\tswing_index = max_t(u8, swing_index, swing_lower_bound);\n\n\t\tagc_index = 0;\n\t}\n\n\tif (swing_index >= RTW_TXSCALE_SIZE) {\n\t\trtw_warn(rtwdev, \"swing index overflow\\n\");\n\t\tswing_index = RTW_TXSCALE_SIZE - 1;\n\t}\n\t*txagc_idx = agc_index;\n\t*swing_idx = swing_index;\n}\n\nstatic void rtw8822b_pwrtrack_set_pwr(struct rtw_dev *rtwdev, u8 path,\n\t\t\t\t      u8 pwr_idx_offset)\n{\n\ts8 txagc_idx;\n\tu8 swing_idx;\n\tu32 reg1, reg2;\n\n\tif (path == RF_PATH_A) {\n\t\treg1 = 0xc94;\n\t\treg2 = 0xc1c;\n\t} else if (path == RF_PATH_B) {\n\t\treg1 = 0xe94;\n\t\treg2 = 0xe1c;\n\t} else {\n\t\treturn;\n\t}\n\n\trtw8822b_txagc_swing_offset(rtwdev, path, pwr_idx_offset,\n\t\t\t\t    &txagc_idx, &swing_idx);\n\trtw_write32_mask(rtwdev, reg1, GENMASK(29, 25), txagc_idx);\n\trtw_write32_mask(rtwdev, reg2, GENMASK(31, 21),\n\t\t\t rtw8822b_txscale_tbl[swing_idx]);\n}\n\nstatic void rtw8822b_pwrtrack_set(struct rtw_dev *rtwdev, u8 path)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tu8 pwr_idx_offset, tx_pwr_idx;\n\tu8 channel = rtwdev->hal.current_channel;\n\tu8 band_width = rtwdev->hal.current_band_width;\n\tu8 regd = rtw_regd_get(rtwdev);\n\tu8 tx_rate = dm_info->tx_rate;\n\tu8 max_pwr_idx = rtwdev->chip->max_power_index;\n\n\ttx_pwr_idx = rtw_phy_get_tx_power_index(rtwdev, path, tx_rate,\n\t\t\t\t\t\tband_width, channel, regd);\n\n\ttx_pwr_idx = min_t(u8, tx_pwr_idx, max_pwr_idx);\n\n\tpwr_idx_offset = max_pwr_idx - tx_pwr_idx;\n\n\trtw8822b_pwrtrack_set_pwr(rtwdev, path, pwr_idx_offset);\n}\n\nstatic void rtw8822b_phy_pwrtrack_path(struct rtw_dev *rtwdev,\n\t\t\t\t       struct rtw_swing_table *swing_table,\n\t\t\t\t       u8 path)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tu8 power_idx_cur, power_idx_last;\n\tu8 delta;\n\n\t \n\tdelta = rtw_phy_pwrtrack_get_delta(rtwdev, RF_PATH_A);\n\n\tpower_idx_last = dm_info->delta_power_index[path];\n\tpower_idx_cur = rtw_phy_pwrtrack_get_pwridx(rtwdev, swing_table,\n\t\t\t\t\t\t    path, RF_PATH_A, delta);\n\n\t \n\tif (power_idx_cur == power_idx_last)\n\t\treturn;\n\n\tdm_info->delta_power_index[path] = power_idx_cur;\n\trtw8822b_pwrtrack_set(rtwdev, path);\n}\n\nstatic void rtw8822b_phy_pwrtrack(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\tstruct rtw_swing_table swing_table;\n\tu8 thermal_value, path;\n\n\trtw_phy_config_swing_table(rtwdev, &swing_table);\n\n\tif (rtwdev->efuse.thermal_meter[RF_PATH_A] == 0xff)\n\t\treturn;\n\n\tthermal_value = rtw_read_rf(rtwdev, RF_PATH_A, RF_T_METER, 0xfc00);\n\n\trtw_phy_pwrtrack_avg(rtwdev, thermal_value, RF_PATH_A);\n\n\tif (dm_info->pwr_trk_init_trigger)\n\t\tdm_info->pwr_trk_init_trigger = false;\n\telse if (!rtw_phy_pwrtrack_thermal_changed(rtwdev, thermal_value,\n\t\t\t\t\t\t   RF_PATH_A))\n\t\tgoto iqk;\n\n\tfor (path = 0; path < rtwdev->hal.rf_path_num; path++)\n\t\trtw8822b_phy_pwrtrack_path(rtwdev, &swing_table, path);\n\niqk:\n\tif (rtw_phy_pwrtrack_need_iqk(rtwdev))\n\t\trtw8822b_do_iqk(rtwdev);\n}\n\nstatic void rtw8822b_pwr_track(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\n\tif (efuse->power_track_type != 0)\n\t\treturn;\n\n\tif (!dm_info->pwr_trk_triggered) {\n\t\trtw_write_rf(rtwdev, RF_PATH_A, RF_T_METER,\n\t\t\t     GENMASK(17, 16), 0x03);\n\t\tdm_info->pwr_trk_triggered = true;\n\t\treturn;\n\t}\n\n\trtw8822b_phy_pwrtrack(rtwdev);\n\tdm_info->pwr_trk_triggered = false;\n}\n\nstatic void rtw8822b_bf_config_bfee_su(struct rtw_dev *rtwdev,\n\t\t\t\t       struct rtw_vif *vif,\n\t\t\t\t       struct rtw_bfee *bfee, bool enable)\n{\n\tif (enable)\n\t\trtw_bf_enable_bfee_su(rtwdev, vif, bfee);\n\telse\n\t\trtw_bf_remove_bfee_su(rtwdev, bfee);\n}\n\nstatic void rtw8822b_bf_config_bfee_mu(struct rtw_dev *rtwdev,\n\t\t\t\t       struct rtw_vif *vif,\n\t\t\t\t       struct rtw_bfee *bfee, bool enable)\n{\n\tif (enable)\n\t\trtw_bf_enable_bfee_mu(rtwdev, vif, bfee);\n\telse\n\t\trtw_bf_remove_bfee_mu(rtwdev, bfee);\n}\n\nstatic void rtw8822b_bf_config_bfee(struct rtw_dev *rtwdev, struct rtw_vif *vif,\n\t\t\t\t    struct rtw_bfee *bfee, bool enable)\n{\n\tif (bfee->role == RTW_BFEE_SU)\n\t\trtw8822b_bf_config_bfee_su(rtwdev, vif, bfee, enable);\n\telse if (bfee->role == RTW_BFEE_MU)\n\t\trtw8822b_bf_config_bfee_mu(rtwdev, vif, bfee, enable);\n\telse\n\t\trtw_warn(rtwdev, \"wrong bfee role\\n\");\n}\n\nstatic void rtw8822b_adaptivity_init(struct rtw_dev *rtwdev)\n{\n\trtw_phy_set_edcca_th(rtwdev, RTW8822B_EDCCA_MAX, RTW8822B_EDCCA_MAX);\n\n\t \n\trtw_write32_clr(rtwdev, REG_TX_PTCL_CTRL, BIT_DIS_EDCCA);\n\trtw_write32_set(rtwdev, REG_RD_CTRL, BIT_EDCCA_MSK_CNTDOWN_EN);\n\trtw_write32_mask(rtwdev, REG_EDCCA_SOURCE, BIT_SOURCE_OPTION,\n\t\t\t RTW8822B_EDCCA_SRC_DEF);\n\trtw_write32_mask(rtwdev, REG_EDCCA_POW_MA, BIT_MA_LEVEL, 0);\n\n\t \n\trtw_write32_set(rtwdev, REG_EDCCA_DECISION, BIT_EDCCA_OPTION);\n}\n\nstatic void rtw8822b_adaptivity(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_dm_info *dm_info = &rtwdev->dm_info;\n\ts8 l2h, h2l;\n\tu8 igi;\n\n\tigi = dm_info->igi_history[0];\n\tif (dm_info->edcca_mode == RTW_EDCCA_NORMAL) {\n\t\tl2h = max_t(s8, igi + EDCCA_IGI_L2H_DIFF, EDCCA_TH_L2H_LB);\n\t\th2l = l2h - EDCCA_L2H_H2L_DIFF_NORMAL;\n\t} else {\n\t\tl2h = min_t(s8, igi, dm_info->l2h_th_ini);\n\t\th2l = l2h - EDCCA_L2H_H2L_DIFF;\n\t}\n\n\trtw_phy_set_edcca_th(rtwdev, l2h, h2l);\n}\n\nstatic void rtw8822b_fill_txdesc_checksum(struct rtw_dev *rtwdev,\n\t\t\t\t\t  struct rtw_tx_pkt_info *pkt_info,\n\t\t\t\t\t  u8 *txdesc)\n{\n\tsize_t words = 32 / 2;  \n\n\tfill_txdesc_checksum_common(txdesc, words);\n}\n\nstatic const struct rtw_pwr_seq_cmd trans_carddis_to_cardemu_8822b[] = {\n\t{0x0086,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0x0086,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_POLLING, BIT(1), BIT(1)},\n\t{0x004A,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(3) | BIT(4) | BIT(7), 0},\n\t{0x0300,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0x0301,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0xFFFF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t 0,\n\t RTW_PWR_CMD_END, 0, 0},\n};\n\nstatic const struct rtw_pwr_seq_cmd trans_cardemu_to_act_8822b[] = {\n\t{0x0012,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), 0},\n\t{0x0012,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0020,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0001,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_DELAY, 1, RTW_PWR_DELAY_MS},\n\t{0x0000,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, (BIT(4) | BIT(3) | BIT(2)), 0},\n\t{0x0075,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0006,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_POLLING, BIT(1), BIT(1)},\n\t{0x0075,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0xFF1A,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0x0006,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(7), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, (BIT(4) | BIT(3)), 0},\n\t{0x10C3,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_POLLING, BIT(0), 0},\n\t{0x0020,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(3), BIT(3)},\n\t{0x10A8,\n\t RTW_PWR_CUT_C_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0x10A9,\n\t RTW_PWR_CUT_C_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0xef},\n\t{0x10AA,\n\t RTW_PWR_CUT_C_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x0c},\n\t{0x0068,\n\t RTW_PWR_CUT_C_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(4), BIT(4)},\n\t{0x0029,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0xF9},\n\t{0x0024,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(2), 0},\n\t{0x0074,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), BIT(5)},\n\t{0x00AF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), BIT(5)},\n\t{0xFFFF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t 0,\n\t RTW_PWR_CMD_END, 0, 0},\n};\n\nstatic const struct rtw_pwr_seq_cmd trans_act_to_cardemu_8822b[] = {\n\t{0x0003,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(2), 0},\n\t{0x0093,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(3), 0},\n\t{0x001F,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0x00EF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0xFF1A,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x30},\n\t{0x0049,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), 0},\n\t{0x0006,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0002,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), 0},\n\t{0x10C3,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), BIT(1)},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_POLLING, BIT(1), 0},\n\t{0x0020,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(3), 0},\n\t{0x0000,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), BIT(5)},\n\t{0xFFFF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t 0,\n\t RTW_PWR_CMD_END, 0, 0},\n};\n\nstatic const struct rtw_pwr_seq_cmd trans_cardemu_to_carddis_8822b[] = {\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(7), BIT(7)},\n\t{0x0007,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x20},\n\t{0x0067,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(2), BIT(2)},\n\t{0x004A,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0x0067,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(5), 0},\n\t{0x0067,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(4), 0},\n\t{0x004F,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(0), 0},\n\t{0x0067,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), 0},\n\t{0x0046,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(6), BIT(6)},\n\t{0x0067,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(2), 0},\n\t{0x0046,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(7), BIT(7)},\n\t{0x0062,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(4), BIT(4)},\n\t{0x0081,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(7) | BIT(6), 0},\n\t{0x0005,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(3) | BIT(4), BIT(3)},\n\t{0x0086,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, BIT(0), BIT(0)},\n\t{0x0086,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_POLLING, BIT(1), 0},\n\t{0x0090,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_USB_MSK | RTW_PWR_INTF_PCI_MSK,\n\t RTW_PWR_ADDR_MAC,\n\t RTW_PWR_CMD_WRITE, BIT(1), 0},\n\t{0x0044,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0},\n\t{0x0040,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x90},\n\t{0x0041,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x00},\n\t{0x0042,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_SDIO_MSK,\n\t RTW_PWR_ADDR_SDIO,\n\t RTW_PWR_CMD_WRITE, 0xFF, 0x04},\n\t{0xFFFF,\n\t RTW_PWR_CUT_ALL_MSK,\n\t RTW_PWR_INTF_ALL_MSK,\n\t 0,\n\t RTW_PWR_CMD_END, 0, 0},\n};\n\nstatic const struct rtw_pwr_seq_cmd *card_enable_flow_8822b[] = {\n\ttrans_carddis_to_cardemu_8822b,\n\ttrans_cardemu_to_act_8822b,\n\tNULL\n};\n\nstatic const struct rtw_pwr_seq_cmd *card_disable_flow_8822b[] = {\n\ttrans_act_to_cardemu_8822b,\n\ttrans_cardemu_to_carddis_8822b,\n\tNULL\n};\n\nstatic const struct rtw_intf_phy_para usb2_param_8822b[] = {\n\t{0xFFFF, 0x00,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_ALL,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n};\n\nstatic const struct rtw_intf_phy_para usb3_param_8822b[] = {\n\t{0x0001, 0xA841,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_D,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0xFFFF, 0x0000,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_ALL,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n};\n\nstatic const struct rtw_intf_phy_para pcie_gen1_param_8822b[] = {\n\t{0x0001, 0xA841,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0002, 0x60C6,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0008, 0x3596,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0009, 0x321C,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x000A, 0x9623,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0020, 0x94FF,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0021, 0xFFCF,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0026, 0xC006,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0029, 0xFF0E,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x002A, 0x1840,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0xFFFF, 0x0000,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_ALL,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n};\n\nstatic const struct rtw_intf_phy_para pcie_gen2_param_8822b[] = {\n\t{0x0001, 0xA841,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0002, 0x60C6,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0008, 0x3597,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0009, 0x321C,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x000A, 0x9623,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0020, 0x94FF,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0021, 0xFFCF,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0026, 0xC006,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x0029, 0xFF0E,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0x002A, 0x3040,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_C,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n\t{0xFFFF, 0x0000,\n\t RTW_IP_SEL_PHY,\n\t RTW_INTF_PHY_CUT_ALL,\n\t RTW_INTF_PHY_PLATFORM_ALL},\n};\n\nstatic const struct rtw_intf_phy_para_table phy_para_table_8822b = {\n\t.usb2_para\t= usb2_param_8822b,\n\t.usb3_para\t= usb3_param_8822b,\n\t.gen1_para\t= pcie_gen1_param_8822b,\n\t.gen2_para\t= pcie_gen2_param_8822b,\n\t.n_usb2_para\t= ARRAY_SIZE(usb2_param_8822b),\n\t.n_usb3_para\t= ARRAY_SIZE(usb2_param_8822b),\n\t.n_gen1_para\t= ARRAY_SIZE(pcie_gen1_param_8822b),\n\t.n_gen2_para\t= ARRAY_SIZE(pcie_gen2_param_8822b),\n};\n\nstatic const struct rtw_rfe_def rtw8822b_rfe_defs[] = {\n\t[2] = RTW_DEF_RFE(8822b, 2, 2),\n\t[3] = RTW_DEF_RFE(8822b, 3, 0),\n\t[5] = RTW_DEF_RFE(8822b, 5, 5),\n};\n\nstatic const struct rtw_hw_reg rtw8822b_dig[] = {\n\t[0] = { .addr = 0xc50, .mask = 0x7f },\n\t[1] = { .addr = 0xe50, .mask = 0x7f },\n};\n\nstatic const struct rtw_ltecoex_addr rtw8822b_ltecoex_addr = {\n\t.ctrl = LTECOEX_ACCESS_CTRL,\n\t.wdata = LTECOEX_WRITE_DATA,\n\t.rdata = LTECOEX_READ_DATA,\n};\n\nstatic const struct rtw_page_table page_table_8822b[] = {\n\t{64, 64, 64, 64, 1},\n\t{64, 64, 64, 64, 1},\n\t{64, 64, 0, 0, 1},\n\t{64, 64, 64, 0, 1},\n\t{64, 64, 64, 64, 1},\n};\n\nstatic const struct rtw_rqpn rqpn_table_8822b[] = {\n\t{RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_NORMAL,\n\t RTW_DMA_MAPPING_LOW, RTW_DMA_MAPPING_LOW,\n\t RTW_DMA_MAPPING_EXTRA, RTW_DMA_MAPPING_HIGH},\n\t{RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_NORMAL,\n\t RTW_DMA_MAPPING_LOW, RTW_DMA_MAPPING_LOW,\n\t RTW_DMA_MAPPING_EXTRA, RTW_DMA_MAPPING_HIGH},\n\t{RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_NORMAL,\n\t RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_HIGH,\n\t RTW_DMA_MAPPING_HIGH, RTW_DMA_MAPPING_HIGH},\n\t{RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_NORMAL,\n\t RTW_DMA_MAPPING_LOW, RTW_DMA_MAPPING_LOW,\n\t RTW_DMA_MAPPING_HIGH, RTW_DMA_MAPPING_HIGH},\n\t{RTW_DMA_MAPPING_NORMAL, RTW_DMA_MAPPING_NORMAL,\n\t RTW_DMA_MAPPING_LOW, RTW_DMA_MAPPING_LOW,\n\t RTW_DMA_MAPPING_EXTRA, RTW_DMA_MAPPING_HIGH},\n};\n\nstatic struct rtw_prioq_addrs prioq_addrs_8822b = {\n\t.prio[RTW_DMA_MAPPING_EXTRA] = {\n\t\t.rsvd = REG_FIFOPAGE_INFO_4, .avail = REG_FIFOPAGE_INFO_4 + 2,\n\t},\n\t.prio[RTW_DMA_MAPPING_LOW] = {\n\t\t.rsvd = REG_FIFOPAGE_INFO_2, .avail = REG_FIFOPAGE_INFO_2 + 2,\n\t},\n\t.prio[RTW_DMA_MAPPING_NORMAL] = {\n\t\t.rsvd = REG_FIFOPAGE_INFO_3, .avail = REG_FIFOPAGE_INFO_3 + 2,\n\t},\n\t.prio[RTW_DMA_MAPPING_HIGH] = {\n\t\t.rsvd = REG_FIFOPAGE_INFO_1, .avail = REG_FIFOPAGE_INFO_1 + 2,\n\t},\n\t.wsize = true,\n};\n\nstatic struct rtw_chip_ops rtw8822b_ops = {\n\t.phy_set_param\t\t= rtw8822b_phy_set_param,\n\t.read_efuse\t\t= rtw8822b_read_efuse,\n\t.query_rx_desc\t\t= rtw8822b_query_rx_desc,\n\t.set_channel\t\t= rtw8822b_set_channel,\n\t.mac_init\t\t= rtw8822b_mac_init,\n\t.read_rf\t\t= rtw_phy_read_rf,\n\t.write_rf\t\t= rtw_phy_write_rf_reg_sipi,\n\t.set_tx_power_index\t= rtw8822b_set_tx_power_index,\n\t.set_antenna\t\t= rtw8822b_set_antenna,\n\t.cfg_ldo25\t\t= rtw8822b_cfg_ldo25,\n\t.false_alarm_statistics\t= rtw8822b_false_alarm_statistics,\n\t.phy_calibration\t= rtw8822b_phy_calibration,\n\t.pwr_track\t\t= rtw8822b_pwr_track,\n\t.config_bfee\t\t= rtw8822b_bf_config_bfee,\n\t.set_gid_table\t\t= rtw_bf_set_gid_table,\n\t.cfg_csi_rate\t\t= rtw_bf_cfg_csi_rate,\n\t.adaptivity_init\t= rtw8822b_adaptivity_init,\n\t.adaptivity\t\t= rtw8822b_adaptivity,\n\t.fill_txdesc_checksum\t= rtw8822b_fill_txdesc_checksum,\n\n\t.coex_set_init\t\t= rtw8822b_coex_cfg_init,\n\t.coex_set_ant_switch\t= rtw8822b_coex_cfg_ant_switch,\n\t.coex_set_gnt_fix\t= rtw8822b_coex_cfg_gnt_fix,\n\t.coex_set_gnt_debug\t= rtw8822b_coex_cfg_gnt_debug,\n\t.coex_set_rfe_type\t= rtw8822b_coex_cfg_rfe_type,\n\t.coex_set_wl_tx_power\t= rtw8822b_coex_cfg_wl_tx_power,\n\t.coex_set_wl_rx_gain\t= rtw8822b_coex_cfg_wl_rx_gain,\n};\n\n \nstatic const struct coex_table_para table_sant_8822b[] = {\n\t{0xffffffff, 0xffffffff},  \n\t{0x55555555, 0x55555555},\n\t{0x66555555, 0x66555555},\n\t{0xaaaaaaaa, 0xaaaaaaaa},\n\t{0x5a5a5a5a, 0x5a5a5a5a},\n\t{0xfafafafa, 0xfafafafa},  \n\t{0x6a5a5555, 0xaaaaaaaa},\n\t{0x6a5a56aa, 0x6a5a56aa},\n\t{0x6a5a5a5a, 0x6a5a5a5a},\n\t{0x66555555, 0x5a5a5a5a},\n\t{0x66555555, 0x6a5a5a5a},  \n\t{0x66555555, 0xfafafafa},\n\t{0x66555555, 0x5a5a5aaa},\n\t{0x66555555, 0x6aaa5aaa},\n\t{0x66555555, 0xaaaa5aaa},\n\t{0x66555555, 0xaaaaaaaa},  \n\t{0xffff55ff, 0xfafafafa},\n\t{0xffff55ff, 0x6afa5afa},\n\t{0xaaffffaa, 0xfafafafa},\n\t{0xaa5555aa, 0x5a5a5a5a},\n\t{0xaa5555aa, 0x6a5a5a5a},  \n\t{0xaa5555aa, 0xaaaaaaaa},\n\t{0xffffffff, 0x5a5a5a5a},\n\t{0xffffffff, 0x5a5a5a5a},\n\t{0xffffffff, 0x55555555},\n\t{0xffffffff, 0x6a5a5aaa},  \n\t{0x55555555, 0x5a5a5a5a},\n\t{0x55555555, 0xaaaaaaaa},\n\t{0x55555555, 0x6a5a6a5a},\n\t{0x66556655, 0x66556655},\n\t{0x66556aaa, 0x6a5a6aaa},  \n\t{0xffffffff, 0x5aaa5aaa},\n\t{0x56555555, 0x5a5a5aaa},\n};\n\n \nstatic const struct coex_table_para table_nsant_8822b[] = {\n\t{0xffffffff, 0xffffffff},  \n\t{0x55555555, 0x55555555},\n\t{0x66555555, 0x66555555},\n\t{0xaaaaaaaa, 0xaaaaaaaa},\n\t{0x5a5a5a5a, 0x5a5a5a5a},\n\t{0xfafafafa, 0xfafafafa},  \n\t{0x5afa5afa, 0x5afa5afa},\n\t{0x55555555, 0xfafafafa},\n\t{0x66555555, 0xfafafafa},\n\t{0x66555555, 0x5a5a5a5a},\n\t{0x66555555, 0x6a5a5a5a},  \n\t{0x66555555, 0xaaaaaaaa},\n\t{0xffff55ff, 0xfafafafa},\n\t{0xffff55ff, 0x5afa5afa},\n\t{0xffff55ff, 0xaaaaaaaa},\n\t{0xffff55ff, 0xffff55ff},  \n\t{0xaaffffaa, 0x5afa5afa},\n\t{0xaaffffaa, 0xaaaaaaaa},\n\t{0xffffffff, 0xfafafafa},\n\t{0xffffffff, 0x5afa5afa},\n\t{0xffffffff, 0xaaaaaaaa},  \n\t{0x55ff55ff, 0x5afa5afa},\n\t{0x55ff55ff, 0xaaaaaaaa},\n\t{0x55ff55ff, 0x55ff55ff}\n};\n\n \nstatic const struct coex_tdma_para tdma_sant_8822b[] = {\n\t{ {0x00, 0x00, 0x00, 0x00, 0x00} },  \n\t{ {0x61, 0x45, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x3a, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x30, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x20, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x10, 0x03, 0x11, 0x11} },  \n\t{ {0x61, 0x45, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x3a, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x30, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x20, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x10, 0x03, 0x11, 0x10} },  \n\t{ {0x61, 0x08, 0x03, 0x11, 0x14} },\n\t{ {0x61, 0x08, 0x03, 0x10, 0x14} },\n\t{ {0x51, 0x08, 0x03, 0x10, 0x54} },\n\t{ {0x51, 0x08, 0x03, 0x10, 0x55} },\n\t{ {0x51, 0x08, 0x07, 0x10, 0x54} },  \n\t{ {0x51, 0x45, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x3a, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x30, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x20, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x10, 0x03, 0x10, 0x50} },  \n\t{ {0x51, 0x4a, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x0c, 0x03, 0x10, 0x54} },\n\t{ {0x55, 0x08, 0x03, 0x10, 0x54} },\n\t{ {0x65, 0x10, 0x03, 0x11, 0x10} },\n\t{ {0x51, 0x10, 0x03, 0x10, 0x51} },  \n\t{ {0x51, 0x08, 0x03, 0x10, 0x50} },\n\t{ {0x61, 0x08, 0x03, 0x11, 0x11} }\n};\n\n \nstatic const struct coex_tdma_para tdma_nsant_8822b[] = {\n\t{ {0x00, 0x00, 0x00, 0x00, 0x00} },  \n\t{ {0x61, 0x45, 0x03, 0x11, 0x11} },  \n\t{ {0x61, 0x3a, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x30, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x20, 0x03, 0x11, 0x11} },\n\t{ {0x61, 0x10, 0x03, 0x11, 0x11} },  \n\t{ {0x61, 0x45, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x3a, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x30, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x20, 0x03, 0x11, 0x10} },\n\t{ {0x61, 0x10, 0x03, 0x11, 0x10} },  \n\t{ {0x61, 0x08, 0x03, 0x11, 0x14} },\n\t{ {0x61, 0x08, 0x03, 0x10, 0x14} },\n\t{ {0x51, 0x08, 0x03, 0x10, 0x54} },\n\t{ {0x51, 0x08, 0x03, 0x10, 0x55} },\n\t{ {0x51, 0x08, 0x07, 0x10, 0x54} },  \n\t{ {0x51, 0x45, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x3a, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x30, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x20, 0x03, 0x10, 0x50} },\n\t{ {0x51, 0x10, 0x03, 0x10, 0x50} },  \n\t{ {0x51, 0x08, 0x03, 0x10, 0x50} }\n};\n\n \nstatic const u8 wl_rssi_step_8822b[] = {60, 50, 44, 30};\nstatic const u8 bt_rssi_step_8822b[] = {30, 30, 30, 30};\n\n \nstatic const struct coex_rf_para rf_para_tx_8822b[] = {\n\t{0, 0, false, 7},   \n\t{0, 16, false, 7},  \n\t{4, 0, true, 1},\n\t{3, 6, true, 1},\n\t{2, 9, true, 1},\n\t{1, 13, true, 1}\n};\n\nstatic const struct coex_rf_para rf_para_rx_8822b[] = {\n\t{0, 0, false, 7},   \n\t{0, 16, false, 7},  \n\t{4, 0, true, 1},\n\t{3, 6, true, 1},\n\t{2, 9, true, 1},\n\t{1, 13, true, 1}\n};\n\nstatic const struct coex_5g_afh_map afh_5g_8822b[] = {\n\t{120, 2, 4},\n\t{124, 8, 8},\n\t{128, 17, 8},\n\t{132, 26, 10},\n\t{136, 34, 8},\n\t{140, 42, 10},\n\t{144, 51, 8},\n\t{149, 62, 8},\n\t{153, 71, 10},\n\t{157, 77, 4},\n\t{118, 2, 4},\n\t{126, 12, 16},\n\t{134, 29, 16},\n\t{142, 46, 16},\n\t{151, 66, 16},\n\t{159, 76, 4},\n\t{122, 10, 20},\n\t{138, 37, 34},\n\t{155, 68, 20}\n};\nstatic_assert(ARRAY_SIZE(rf_para_tx_8822b) == ARRAY_SIZE(rf_para_rx_8822b));\n\nstatic const u8\nrtw8822b_pwrtrk_5gb_n[RTW_PWR_TRK_5G_NUM][RTW_PWR_TRK_TBL_SZ] = {\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n};\n\nstatic const u8\nrtw8822b_pwrtrk_5gb_p[RTW_PWR_TRK_5G_NUM][RTW_PWR_TRK_TBL_SZ] = {\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23 },\n};\n\nstatic const u8\nrtw8822b_pwrtrk_5ga_n[RTW_PWR_TRK_5G_NUM][RTW_PWR_TRK_TBL_SZ] = {\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  8,  9, 10, 11, 11, 12, 13, 14, 14,\n\t 15, 16, 17, 17, 18, 19, 20, 20, 21, 22 },\n};\n\nstatic const u8\nrtw8822b_pwrtrk_5ga_p[RTW_PWR_TRK_5G_NUM][RTW_PWR_TRK_TBL_SZ] = {\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23},\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23},\n\t{ 0,  1,  2,  2,  3,  4,  5,  5,  6,  7,\n\t  8,  9,  9, 10, 11, 12, 13, 14, 14, 15,\n\t 16, 17, 18, 19, 19, 20, 21, 22, 22, 23},\n};\n\nstatic const u8 rtw8822b_pwrtrk_2gb_n[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  1,  1,  1,  2,  2,  3,  3,  3,  4,\n\t4,  5,  5,  5,  6,  6,  7,  7,  7,  8,\n\t8,  9,  9,  9, 10, 10, 11, 11, 11, 12\n};\n\nstatic const u8 rtw8822b_pwrtrk_2gb_p[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  0,  1,  1,  2,  2,  3,  3,  4,  4,\n\t5,  5,  6,  6,  6,  7,  7,  8,  8,  9,\n\t9, 10, 10, 11, 11, 12, 12, 12, 13, 13\n};\n\nstatic const u8 rtw8822b_pwrtrk_2ga_n[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  1,  1,  1,  2,  2,  3,  3,  3,  4,\n\t4,  5,  5,  5,  6,  6,  7,  7,  7,  8,\n\t8,  9,  9,  9, 10, 10, 11, 11, 11, 12\n};\n\nstatic const u8 rtw8822b_pwrtrk_2ga_p[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  1,  1,  2,  2,  3,  3,  4,  4,  5,\n\t5,  6,  6,  7,  7,  8,  8,  9,  9, 10,\n\t10, 11, 11, 12, 12, 13, 13, 14, 14, 15\n};\n\nstatic const u8 rtw8822b_pwrtrk_2g_cck_b_n[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  1,  1,  1,  2,  2,  3,  3,  3,  4,\n\t4,  5,  5,  5,  6,  6,  7,  7,  7,  8,\n\t8,  9,  9,  9, 10, 10, 11, 11, 11, 12\n};\n\nstatic const u8 rtw8822b_pwrtrk_2g_cck_b_p[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  0,  1,  1,  2,  2,  3,  3,  4,  4,\n\t5,  5,  6,  6,  6,  7,  7,  8,  8,  9,\n\t9, 10, 10, 11, 11, 12, 12, 12, 13, 13\n};\n\nstatic const u8 rtw8822b_pwrtrk_2g_cck_a_n[RTW_PWR_TRK_TBL_SZ] = {\n\t0,  1,  1,  1,  2,  2,  3,  3,  3,  4,\n\t4,  5,  5,  5,  6,  6,  7,  7,  7,  8,\n\t8,  9,  9,  9, 10, 10, 11, 11, 11, 12\n};\n\nstatic const u8 rtw8822b_pwrtrk_2g_cck_a_p[RTW_PWR_TRK_TBL_SZ] = {\n\t 0,  1,  1,  2,  2,  3,  3,  4,  4,  5,\n\t 5,  6,  6,  7,  7,  8,  8,  9,  9, 10,\n\t10, 11, 11, 12, 12, 13, 13, 14, 14, 15\n};\n\nstatic const struct rtw_pwr_track_tbl rtw8822b_rtw_pwr_track_tbl = {\n\t.pwrtrk_5gb_n[RTW_PWR_TRK_5G_1] = rtw8822b_pwrtrk_5gb_n[RTW_PWR_TRK_5G_1],\n\t.pwrtrk_5gb_n[RTW_PWR_TRK_5G_2] = rtw8822b_pwrtrk_5gb_n[RTW_PWR_TRK_5G_2],\n\t.pwrtrk_5gb_n[RTW_PWR_TRK_5G_3] = rtw8822b_pwrtrk_5gb_n[RTW_PWR_TRK_5G_3],\n\t.pwrtrk_5gb_p[RTW_PWR_TRK_5G_1] = rtw8822b_pwrtrk_5gb_p[RTW_PWR_TRK_5G_1],\n\t.pwrtrk_5gb_p[RTW_PWR_TRK_5G_2] = rtw8822b_pwrtrk_5gb_p[RTW_PWR_TRK_5G_2],\n\t.pwrtrk_5gb_p[RTW_PWR_TRK_5G_3] = rtw8822b_pwrtrk_5gb_p[RTW_PWR_TRK_5G_3],\n\t.pwrtrk_5ga_n[RTW_PWR_TRK_5G_1] = rtw8822b_pwrtrk_5ga_n[RTW_PWR_TRK_5G_1],\n\t.pwrtrk_5ga_n[RTW_PWR_TRK_5G_2] = rtw8822b_pwrtrk_5ga_n[RTW_PWR_TRK_5G_2],\n\t.pwrtrk_5ga_n[RTW_PWR_TRK_5G_3] = rtw8822b_pwrtrk_5ga_n[RTW_PWR_TRK_5G_3],\n\t.pwrtrk_5ga_p[RTW_PWR_TRK_5G_1] = rtw8822b_pwrtrk_5ga_p[RTW_PWR_TRK_5G_1],\n\t.pwrtrk_5ga_p[RTW_PWR_TRK_5G_2] = rtw8822b_pwrtrk_5ga_p[RTW_PWR_TRK_5G_2],\n\t.pwrtrk_5ga_p[RTW_PWR_TRK_5G_3] = rtw8822b_pwrtrk_5ga_p[RTW_PWR_TRK_5G_3],\n\t.pwrtrk_2gb_n = rtw8822b_pwrtrk_2gb_n,\n\t.pwrtrk_2gb_p = rtw8822b_pwrtrk_2gb_p,\n\t.pwrtrk_2ga_n = rtw8822b_pwrtrk_2ga_n,\n\t.pwrtrk_2ga_p = rtw8822b_pwrtrk_2ga_p,\n\t.pwrtrk_2g_cckb_n = rtw8822b_pwrtrk_2g_cck_b_n,\n\t.pwrtrk_2g_cckb_p = rtw8822b_pwrtrk_2g_cck_b_p,\n\t.pwrtrk_2g_ccka_n = rtw8822b_pwrtrk_2g_cck_a_n,\n\t.pwrtrk_2g_ccka_p = rtw8822b_pwrtrk_2g_cck_a_p,\n};\n\nstatic const struct rtw_reg_domain coex_info_hw_regs_8822b[] = {\n\t{0xcb0, MASKDWORD, RTW_REG_DOMAIN_MAC32},\n\t{0xcb4, MASKDWORD, RTW_REG_DOMAIN_MAC32},\n\t{0xcba, MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n\t{0xcbd, MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n\t{0xc58, MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n\t{0xcbd, BIT(0), RTW_REG_DOMAIN_MAC8},\n\t{0, 0, RTW_REG_DOMAIN_NL},\n\t{0x430, MASKDWORD, RTW_REG_DOMAIN_MAC32},\n\t{0x434, MASKDWORD, RTW_REG_DOMAIN_MAC32},\n\t{0x42a, MASKLWORD, RTW_REG_DOMAIN_MAC16},\n\t{0x426, MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n\t{0x45e, BIT(3), RTW_REG_DOMAIN_MAC8},\n\t{0x454, MASKLWORD, RTW_REG_DOMAIN_MAC16},\n\t{0, 0, RTW_REG_DOMAIN_NL},\n\t{0x4c, BIT(24) | BIT(23), RTW_REG_DOMAIN_MAC32},\n\t{0x64, BIT(0), RTW_REG_DOMAIN_MAC8},\n\t{0x4c6, BIT(4), RTW_REG_DOMAIN_MAC8},\n\t{0x40, BIT(5), RTW_REG_DOMAIN_MAC8},\n\t{0x1, RFREG_MASK, RTW_REG_DOMAIN_RF_B},\n\t{0, 0, RTW_REG_DOMAIN_NL},\n\t{0x550, MASKDWORD, RTW_REG_DOMAIN_MAC32},\n\t{0x522, MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n\t{0x953, BIT(1), RTW_REG_DOMAIN_MAC8},\n\t{0xc50,  MASKBYTE0, RTW_REG_DOMAIN_MAC8},\n};\n\nstatic struct rtw_hw_reg_offset rtw8822b_edcca_th[] = {\n\t[EDCCA_TH_L2H_IDX] = {{.addr = 0x8a4, .mask = MASKBYTE0}, .offset = 0},\n\t[EDCCA_TH_H2L_IDX] = {{.addr = 0x8a4, .mask = MASKBYTE1}, .offset = 0},\n};\n\nconst struct rtw_chip_info rtw8822b_hw_spec = {\n\t.ops = &rtw8822b_ops,\n\t.id = RTW_CHIP_TYPE_8822B,\n\t.fw_name = \"rtw88/rtw8822b_fw.bin\",\n\t.wlan_cpu = RTW_WCPU_11AC,\n\t.tx_pkt_desc_sz = 48,\n\t.tx_buf_desc_sz = 16,\n\t.rx_pkt_desc_sz = 24,\n\t.rx_buf_desc_sz = 8,\n\t.phy_efuse_size = 1024,\n\t.log_efuse_size = 768,\n\t.ptct_efuse_size = 96,\n\t.txff_size = 262144,\n\t.rxff_size = 24576,\n\t.fw_rxff_size = 12288,\n\t.rsvd_drv_pg_num = 8,\n\t.txgi_factor = 1,\n\t.is_pwr_by_rate_dec = true,\n\t.max_power_index = 0x3f,\n\t.csi_buf_pg_num = 0,\n\t.band = RTW_BAND_2G | RTW_BAND_5G,\n\t.page_size = TX_PAGE_SIZE,\n\t.dig_min = 0x1c,\n\t.ht_supported = true,\n\t.vht_supported = true,\n\t.lps_deep_mode_supported = BIT(LPS_DEEP_MODE_LCLK),\n\t.sys_func_en = 0xDC,\n\t.pwr_on_seq = card_enable_flow_8822b,\n\t.pwr_off_seq = card_disable_flow_8822b,\n\t.page_table = page_table_8822b,\n\t.rqpn_table = rqpn_table_8822b,\n\t.prioq_addrs = &prioq_addrs_8822b,\n\t.intf_table = &phy_para_table_8822b,\n\t.dig = rtw8822b_dig,\n\t.dig_cck = NULL,\n\t.rf_base_addr = {0x2800, 0x2c00},\n\t.rf_sipi_addr = {0xc90, 0xe90},\n\t.ltecoex_addr = &rtw8822b_ltecoex_addr,\n\t.mac_tbl = &rtw8822b_mac_tbl,\n\t.agc_tbl = &rtw8822b_agc_tbl,\n\t.bb_tbl = &rtw8822b_bb_tbl,\n\t.rf_tbl = {&rtw8822b_rf_a_tbl, &rtw8822b_rf_b_tbl},\n\t.rfe_defs = rtw8822b_rfe_defs,\n\t.rfe_defs_size = ARRAY_SIZE(rtw8822b_rfe_defs),\n\t.pwr_track_tbl = &rtw8822b_rtw_pwr_track_tbl,\n\t.iqk_threshold = 8,\n\t.bfer_su_max_num = 2,\n\t.bfer_mu_max_num = 1,\n\t.rx_ldpc = true,\n\t.edcca_th = rtw8822b_edcca_th,\n\t.l2h_th_ini_cs = 10 + EDCCA_IGI_BASE,\n\t.l2h_th_ini_ad = -14 + EDCCA_IGI_BASE,\n\t.ampdu_density = IEEE80211_HT_MPDU_DENSITY_2,\n\t.max_scan_ie_len = IEEE80211_MAX_DATA_LEN,\n\n\t.coex_para_ver = 0x20070206,\n\t.bt_desired_ver = 0x6,\n\t.scbd_support = true,\n\t.new_scbd10_def = false,\n\t.ble_hid_profile_support = false,\n\t.wl_mimo_ps_support = false,\n\t.pstdma_type = COEX_PSTDMA_FORCE_LPSOFF,\n\t.bt_rssi_type = COEX_BTRSSI_RATIO,\n\t.ant_isolation = 15,\n\t.rssi_tolerance = 2,\n\t.wl_rssi_step = wl_rssi_step_8822b,\n\t.bt_rssi_step = bt_rssi_step_8822b,\n\t.table_sant_num = ARRAY_SIZE(table_sant_8822b),\n\t.table_sant = table_sant_8822b,\n\t.table_nsant_num = ARRAY_SIZE(table_nsant_8822b),\n\t.table_nsant = table_nsant_8822b,\n\t.tdma_sant_num = ARRAY_SIZE(tdma_sant_8822b),\n\t.tdma_sant = tdma_sant_8822b,\n\t.tdma_nsant_num = ARRAY_SIZE(tdma_nsant_8822b),\n\t.tdma_nsant = tdma_nsant_8822b,\n\t.wl_rf_para_num = ARRAY_SIZE(rf_para_tx_8822b),\n\t.wl_rf_para_tx = rf_para_tx_8822b,\n\t.wl_rf_para_rx = rf_para_rx_8822b,\n\t.bt_afh_span_bw20 = 0x24,\n\t.bt_afh_span_bw40 = 0x36,\n\t.afh_5g_num = ARRAY_SIZE(afh_5g_8822b),\n\t.afh_5g = afh_5g_8822b,\n\n\t.coex_info_hw_regs_num = ARRAY_SIZE(coex_info_hw_regs_8822b),\n\t.coex_info_hw_regs = coex_info_hw_regs_8822b,\n\n\t.fw_fifo_addr = {0x780, 0x700, 0x780, 0x660, 0x650, 0x680},\n};\nEXPORT_SYMBOL(rtw8822b_hw_spec);\n\nMODULE_FIRMWARE(\"rtw88/rtw8822b_fw.bin\");\n\nMODULE_AUTHOR(\"Realtek Corporation\");\nMODULE_DESCRIPTION(\"Realtek 802.11ac wireless 8822b driver\");\nMODULE_LICENSE(\"Dual BSD/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}