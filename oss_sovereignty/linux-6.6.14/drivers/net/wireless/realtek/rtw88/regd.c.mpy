{
  "module_name": "regd.c",
  "hash_id": "bc7c521e0b8a8069d2c4f1bd9e5747c9ae549e1507e2c5343086f6d647601af4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/realtek/rtw88/regd.c",
  "human_readable_source": "\n \n\n#include \"main.h\"\n#include \"regd.h\"\n#include \"debug.h\"\n#include \"phy.h\"\n\n#define COUNTRY_REGD_ENT(_alpha2, _regd_2g, _regd_5g) \\\n\t{.alpha2 = (_alpha2), \\\n\t .txpwr_regd_2g = (_regd_2g), \\\n\t .txpwr_regd_5g = (_regd_5g), \\\n\t}\n\n#define rtw_dbg_regd_dump(_dev, _msg, _args...)\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\tstruct rtw_dev *__d = (_dev);\t\t\t\t\\\n\tconst struct rtw_regd *__r =  &__d->regd;\t\t\\\n\trtw_dbg(__d, RTW_DBG_REGD, _msg\t\t\t\t\\\n\t\t\"apply alpha2 %c%c, regd {%d, %d}, dfs_region %d\\n\",\\\n\t\t##_args,\t\t\t\t\t\\\n\t\t__r->regulatory->alpha2[0],\t\t\t\\\n\t\t__r->regulatory->alpha2[1],\t\t\t\\\n\t\t__r->regulatory->txpwr_regd_2g,\t\t\t\\\n\t\t__r->regulatory->txpwr_regd_5g,\t\t\t\\\n\t\t__r->dfs_region);\t\t\t\t\\\n} while (0)\n\n \nstatic const struct rtw_regulatory rtw_reg_ww =\n\tCOUNTRY_REGD_ENT(\"00\", RTW_REGD_WW, RTW_REGD_WW);\n\nstatic const struct rtw_regulatory rtw_reg_map[] = {\n\tCOUNTRY_REGD_ENT(\"AD\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AG\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"AI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AN\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"AO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AQ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AR\", RTW_REGD_MEXICO, RTW_REGD_MEXICO),\n\tCOUNTRY_REGD_ENT(\"AS\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"AT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"AU\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"AW\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"AZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BB\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"BD\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BJ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BM\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"BN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BO\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"BR\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"BS\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"BT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BV\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BY\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"BZ\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"CA\", RTW_REGD_IC, RTW_REGD_IC),\n\tCOUNTRY_REGD_ENT(\"CC\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CD\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CL\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"CM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CO\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"CR\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"CV\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CX\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"CY\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"CZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"DE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"DJ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"DK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"DM\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"DO\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"DZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"EC\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"EE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"EG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"EH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ER\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ES\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ET\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"FI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"FJ\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"FK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"FM\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"FO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"FR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GB\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GD\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"GE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GP\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GQ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GT\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"GU\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"GW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"GY\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"HK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"HM\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"HN\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"HR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"HT\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"HU\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ID\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IQ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"IT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"JE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"JM\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"JO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"JP\", RTW_REGD_MKK, RTW_REGD_MKK),\n\tCOUNTRY_REGD_ENT(\"KE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KN\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"KR\", RTW_REGD_KCC, RTW_REGD_KCC),\n\tCOUNTRY_REGD_ENT(\"KW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"KY\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"KZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LB\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LC\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"LI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LU\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LV\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"LY\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MC\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MD\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ME\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MF\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"MG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MH\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"MK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ML\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MP\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"MQ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MU\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MV\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MX\", RTW_REGD_MEXICO, RTW_REGD_MEXICO),\n\tCOUNTRY_REGD_ENT(\"MY\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"MZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NC\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NF\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"NG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NI\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"NL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NP\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"NU\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"NZ\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"OM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PA\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"PE\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"PF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PR\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"PS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"PW\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"PY\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"QA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"RE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"RO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"RS\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"RU\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"RW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SB\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SC\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"SE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SI\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SJ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SL\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"SR\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"ST\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"SV\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"SX\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"SZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TC\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TD\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TH\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TJ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TK\", RTW_REGD_ACMA, RTW_REGD_ACMA),\n\tCOUNTRY_REGD_ENT(\"TM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TO\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TR\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"TT\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"TV\", RTW_REGD_ETSI, RTW_REGD_WW),\n\tCOUNTRY_REGD_ENT(\"TW\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"TZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"UA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"UG\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"US\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"UY\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"UZ\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"VA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"VC\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"VE\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"VG\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"VI\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"VN\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"VU\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"WF\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"WS\", RTW_REGD_FCC, RTW_REGD_FCC),\n\tCOUNTRY_REGD_ENT(\"XK\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"YE\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"YT\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ZA\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ZM\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n\tCOUNTRY_REGD_ENT(\"ZW\", RTW_REGD_ETSI, RTW_REGD_ETSI),\n};\n\nstatic void rtw_regd_apply_hw_cap_flags(struct wiphy *wiphy)\n{\n\tstruct ieee80211_hw *hw = wiphy_to_ieee80211_hw(wiphy);\n\tstruct ieee80211_supported_band *sband;\n\tstruct ieee80211_channel *ch;\n\tstruct rtw_dev *rtwdev = hw->priv;\n\tstruct rtw_efuse *efuse = &rtwdev->efuse;\n\tint i;\n\n\tif (efuse->hw_cap.bw & BIT(RTW_CHANNEL_WIDTH_80))\n\t\treturn;\n\n\tsband = wiphy->bands[NL80211_BAND_2GHZ];\n\tif (!sband)\n\t\tgoto out_5g;\n\n\tfor (i = 0; i < sband->n_channels; i++) {\n\t\tch = &sband->channels[i];\n\t\tch->flags |= IEEE80211_CHAN_NO_80MHZ;\n\t}\n\nout_5g:\n\tsband = wiphy->bands[NL80211_BAND_5GHZ];\n\tif (!sband)\n\t\treturn;\n\n\tfor (i = 0; i < sband->n_channels; i++) {\n\t\tch = &sband->channels[i];\n\t\tch->flags |= IEEE80211_CHAN_NO_80MHZ;\n\t}\n}\n\nstatic bool rtw_reg_is_ww(const struct rtw_regulatory *reg)\n{\n\treturn reg == &rtw_reg_ww;\n}\n\nstatic bool rtw_reg_match(const struct rtw_regulatory *reg, const char *alpha2)\n{\n\treturn memcmp(reg->alpha2, alpha2, 2) == 0;\n}\n\nstatic const struct rtw_regulatory *rtw_reg_find_by_name(const char *alpha2)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rtw_reg_map); i++) {\n\t\tif (rtw_reg_match(&rtw_reg_map[i], alpha2))\n\t\t\treturn &rtw_reg_map[i];\n\t}\n\n\treturn &rtw_reg_ww;\n}\n\nstatic\nvoid rtw_regd_notifier(struct wiphy *wiphy, struct regulatory_request *request);\n\n \nint rtw_regd_init(struct rtw_dev *rtwdev)\n{\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\tconst struct rtw_regulatory *chip_reg;\n\n\tif (!wiphy)\n\t\treturn -EINVAL;\n\n\twiphy->reg_notifier = rtw_regd_notifier;\n\n\tchip_reg = rtw_reg_find_by_name(rtwdev->efuse.country_code);\n\tif (!rtw_reg_is_ww(chip_reg)) {\n\t\trtwdev->regd.state = RTW_REGD_STATE_PROGRAMMED;\n\n\t\t \n\t\twiphy->regulatory_flags |= REGULATORY_STRICT_REG;\n\t\twiphy->regulatory_flags |= REGULATORY_COUNTRY_IE_IGNORE;\n\t} else {\n\t\trtwdev->regd.state = RTW_REGD_STATE_WORLDWIDE;\n\t}\n\n\trtwdev->regd.regulatory = &rtw_reg_ww;\n\trtwdev->regd.dfs_region = NL80211_DFS_UNSET;\n\trtw_dbg_regd_dump(rtwdev, \"regd init state %d: \", rtwdev->regd.state);\n\n\trtw_regd_apply_hw_cap_flags(wiphy);\n\treturn 0;\n}\n\n \nint rtw_regd_hint(struct rtw_dev *rtwdev)\n{\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\tint ret;\n\n\tif (!wiphy)\n\t\treturn -EINVAL;\n\n\tif (rtwdev->regd.state == RTW_REGD_STATE_PROGRAMMED) {\n\t\trtw_dbg(rtwdev, RTW_DBG_REGD,\n\t\t\t\"country domain %c%c is PGed on efuse\",\n\t\t\trtwdev->efuse.country_code[0],\n\t\t\trtwdev->efuse.country_code[1]);\n\n\t\tret = regulatory_hint(wiphy, rtwdev->efuse.country_code);\n\t\tif (ret) {\n\t\t\trtw_warn(rtwdev,\n\t\t\t\t \"failed to hint regulatory: %d\\n\", ret);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic bool rtw_regd_mgmt_worldwide(struct rtw_dev *rtwdev,\n\t\t\t\t    struct rtw_regd *next_regd,\n\t\t\t\t    struct regulatory_request *request)\n{\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\n\tnext_regd->state = RTW_REGD_STATE_WORLDWIDE;\n\n\tif (request->initiator == NL80211_REGDOM_SET_BY_USER &&\n\t    !rtw_reg_is_ww(next_regd->regulatory)) {\n\t\tnext_regd->state = RTW_REGD_STATE_SETTING;\n\t\twiphy->regulatory_flags |= REGULATORY_COUNTRY_IE_IGNORE;\n\t}\n\n\treturn true;\n}\n\nstatic bool rtw_regd_mgmt_programmed(struct rtw_dev *rtwdev,\n\t\t\t\t     struct rtw_regd *next_regd,\n\t\t\t\t     struct regulatory_request *request)\n{\n\tif (request->initiator == NL80211_REGDOM_SET_BY_DRIVER &&\n\t    rtw_reg_match(next_regd->regulatory, rtwdev->efuse.country_code)) {\n\t\tnext_regd->state = RTW_REGD_STATE_PROGRAMMED;\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nstatic bool rtw_regd_mgmt_setting(struct rtw_dev *rtwdev,\n\t\t\t\t  struct rtw_regd *next_regd,\n\t\t\t\t  struct regulatory_request *request)\n{\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\n\tif (request->initiator != NL80211_REGDOM_SET_BY_USER)\n\t\treturn false;\n\n\tnext_regd->state = RTW_REGD_STATE_SETTING;\n\n\tif (rtw_reg_is_ww(next_regd->regulatory)) {\n\t\tnext_regd->state = RTW_REGD_STATE_WORLDWIDE;\n\t\twiphy->regulatory_flags &= ~REGULATORY_COUNTRY_IE_IGNORE;\n\t}\n\n\treturn true;\n}\n\nstatic bool (*const rtw_regd_handler[RTW_REGD_STATE_NR])\n\t(struct rtw_dev *, struct rtw_regd *, struct regulatory_request *) = {\n\t[RTW_REGD_STATE_WORLDWIDE] = rtw_regd_mgmt_worldwide,\n\t[RTW_REGD_STATE_PROGRAMMED] = rtw_regd_mgmt_programmed,\n\t[RTW_REGD_STATE_SETTING] = rtw_regd_mgmt_setting,\n};\n\nstatic bool rtw_regd_state_hdl(struct rtw_dev *rtwdev,\n\t\t\t       struct rtw_regd *next_regd,\n\t\t\t       struct regulatory_request *request)\n{\n\tnext_regd->regulatory = rtw_reg_find_by_name(request->alpha2);\n\tnext_regd->dfs_region = request->dfs_region;\n\treturn rtw_regd_handler[rtwdev->regd.state](rtwdev, next_regd, request);\n}\n\nstatic\nvoid rtw_regd_notifier(struct wiphy *wiphy, struct regulatory_request *request)\n{\n\tstruct ieee80211_hw *hw = wiphy_to_ieee80211_hw(wiphy);\n\tstruct rtw_dev *rtwdev = hw->priv;\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tstruct rtw_regd next_regd = {0};\n\tbool hdl;\n\n\thdl = rtw_regd_state_hdl(rtwdev, &next_regd, request);\n\tif (!hdl) {\n\t\trtw_dbg(rtwdev, RTW_DBG_REGD,\n\t\t\t\"regd state %d: ignore request %c%c of initiator %d\\n\",\n\t\t\trtwdev->regd.state,\n\t\t\trequest->alpha2[0],\n\t\t\trequest->alpha2[1],\n\t\t\trequest->initiator);\n\t\treturn;\n\t}\n\n\trtw_dbg(rtwdev, RTW_DBG_REGD, \"regd state: %d -> %d\\n\",\n\t\trtwdev->regd.state, next_regd.state);\n\n\tmutex_lock(&rtwdev->mutex);\n\trtwdev->regd = next_regd;\n\trtw_dbg_regd_dump(rtwdev, \"get alpha2 %c%c from initiator %d: \",\n\t\t\t  request->alpha2[0],\n\t\t\t  request->alpha2[1],\n\t\t\t  request->initiator);\n\n\trtw_phy_adaptivity_set_mode(rtwdev);\n\trtw_phy_set_tx_power_level(rtwdev, hal->current_channel);\n\tmutex_unlock(&rtwdev->mutex);\n}\n\nu8 rtw_regd_get(struct rtw_dev *rtwdev)\n{\n\tstruct rtw_hal *hal = &rtwdev->hal;\n\tu8 band = hal->current_band_type;\n\n\treturn band == RTW_BAND_2G ?\n\t       rtwdev->regd.regulatory->txpwr_regd_2g :\n\t       rtwdev->regd.regulatory->txpwr_regd_5g;\n}\nEXPORT_SYMBOL(rtw_regd_get);\n\nstruct rtw_regd_alternative_t {\n\tbool set;\n\tu8 alt;\n};\n\n#define DECL_REGD_ALT(_regd, _regd_alt) \\\n\t[(_regd)] = {.set = true, .alt = (_regd_alt)}\n\nstatic const struct rtw_regd_alternative_t\nrtw_regd_alt[RTW_REGD_MAX] = {\n\tDECL_REGD_ALT(RTW_REGD_IC, RTW_REGD_FCC),\n\tDECL_REGD_ALT(RTW_REGD_KCC, RTW_REGD_ETSI),\n\tDECL_REGD_ALT(RTW_REGD_ACMA, RTW_REGD_ETSI),\n\tDECL_REGD_ALT(RTW_REGD_CHILE, RTW_REGD_FCC),\n\tDECL_REGD_ALT(RTW_REGD_UKRAINE, RTW_REGD_ETSI),\n\tDECL_REGD_ALT(RTW_REGD_MEXICO, RTW_REGD_FCC),\n\tDECL_REGD_ALT(RTW_REGD_CN, RTW_REGD_ETSI),\n};\n\nbool rtw_regd_has_alt(u8 regd, u8 *regd_alt)\n{\n\tif (!rtw_regd_alt[regd].set)\n\t\treturn false;\n\n\t*regd_alt = rtw_regd_alt[regd].alt;\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}