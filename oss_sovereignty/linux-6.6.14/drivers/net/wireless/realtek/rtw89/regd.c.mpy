{
  "module_name": "regd.c",
  "hash_id": "4f70eb41e8a6b9132a0627f93c5d258f33929ce54c7d8dd9eeff94d83eba405f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/realtek/rtw89/regd.c",
  "human_readable_source": "\n \n\n#include \"acpi.h\"\n#include \"debug.h\"\n#include \"ps.h\"\n#include \"util.h\"\n\n#define COUNTRY_REGD(_alpha2, _txpwr_regd...) \\\n\t{.alpha2 = (_alpha2), \\\n\t .txpwr_regd = {_txpwr_regd}, \\\n\t}\n\nstatic const struct rtw89_regd rtw89_ww_regd =\n\tCOUNTRY_REGD(\"00\", RTW89_WW, RTW89_WW, RTW89_WW);\n\nstatic const struct rtw89_regd rtw89_regd_map[] = {\n\tCOUNTRY_REGD(\"AR\", RTW89_MEXICO, RTW89_MEXICO, RTW89_FCC),\n\tCOUNTRY_REGD(\"BO\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BR\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"CL\", RTW89_CHILE, RTW89_CHILE, RTW89_CHILE),\n\tCOUNTRY_REGD(\"CO\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"CR\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"EC\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"SV\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"GT\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"HN\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"MX\", RTW89_MEXICO, RTW89_MEXICO, RTW89_FCC),\n\tCOUNTRY_REGD(\"NI\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PA\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PY\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PE\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"US\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"UY\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"VE\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PR\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"DO\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"AT\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"BE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CY\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CZ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"DK\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"EE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"FI\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"FR\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"DE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"GR\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"HU\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"IS\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"IE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"IT\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LV\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LI\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LT\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LU\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MT\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MC\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"NL\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"NO\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"PL\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"PT\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"SK\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"SI\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"ES\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"SE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CH\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"GB\", RTW89_UK, RTW89_UK, RTW89_UK),\n\tCOUNTRY_REGD(\"AL\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AZ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"BH\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"BA\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BG\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"HR\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"EG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GH\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"IQ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"IL\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"JO\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"KZ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"KW\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"KG\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LB\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LS\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MK\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MA\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MZ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NA\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"OM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"QA\", RTW89_QATAR, RTW89_QATAR, RTW89_QATAR),\n\tCOUNTRY_REGD(\"RO\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"RU\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SA\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"SN\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"RS\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"ME\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ZA\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"TR\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"UA\", RTW89_UKRAINE, RTW89_UKRAINE, RTW89_UKRAINE),\n\tCOUNTRY_REGD(\"AE\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"YE\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ZW\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BD\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KH\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"CN\", RTW89_CN, RTW89_CN, RTW89_CN),\n\tCOUNTRY_REGD(\"HK\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"IN\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ID\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KR\", RTW89_KCC, RTW89_KCC, RTW89_KCC),\n\tCOUNTRY_REGD(\"MY\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"PK\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"PH\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"LK\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TW\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"TH\", RTW89_WW, RTW89_WW, RTW89_WW),\n\tCOUNTRY_REGD(\"VN\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AU\", RTW89_ACMA, RTW89_ACMA, RTW89_ACMA),\n\tCOUNTRY_REGD(\"NZ\", RTW89_ACMA, RTW89_ACMA, RTW89_ACMA),\n\tCOUNTRY_REGD(\"PG\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CA\", RTW89_IC, RTW89_IC, RTW89_IC),\n\tCOUNTRY_REGD(\"JP\", RTW89_MKK, RTW89_MKK, RTW89_MKK),\n\tCOUNTRY_REGD(\"JM\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"AN\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"TT\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"TN\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"DZ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"AS\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"AD\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AI\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"AQ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"AG\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"AM\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"AW\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BS\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BB\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BY\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BZ\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"BJ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BM\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BT\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BW\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"BV\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"IO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"VG\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"BN\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BF\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"BI\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"CV\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KY\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"CF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TD\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CX\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"CC\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"KM\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"CG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"CD\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"CK\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"CI\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"DJ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"DM\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"GQ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"ER\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ET\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"FK\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"FO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"FJ\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"GF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"PF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GA\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GM\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"GE\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GI\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GL\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GD\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"GP\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GU\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"GG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GN\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"GW\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GY\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"HT\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"HM\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"VA\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"IM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"JE\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KI\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"XK\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LA\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"LR\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"LY\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MG\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MW\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MV\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ML\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MH\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"MQ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MR\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"MU\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"YT\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"FM\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"MD\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MN\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"MS\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NR\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NP\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NC\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NE\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"NU\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"NF\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"MP\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PW\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"RE\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"RW\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SH\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"KN\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"LC\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"MF\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"SX\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"PM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"VC\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"WS\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"SM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ST\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SC\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"SL\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"SB\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"GS\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SR\", RTW89_FCC, RTW89_FCC, RTW89_FCC),\n\tCOUNTRY_REGD(\"SJ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"SZ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TJ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"TZ\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TG\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"TK\", RTW89_ACMA, RTW89_ACMA, RTW89_NA),\n\tCOUNTRY_REGD(\"TO\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TC\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"TV\", RTW89_ETSI, RTW89_NA, RTW89_NA),\n\tCOUNTRY_REGD(\"UG\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"VI\", RTW89_FCC, RTW89_FCC, RTW89_NA),\n\tCOUNTRY_REGD(\"UZ\", RTW89_ETSI, RTW89_ETSI, RTW89_ETSI),\n\tCOUNTRY_REGD(\"VU\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"WF\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"EH\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"ZM\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"IR\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n\tCOUNTRY_REGD(\"PS\", RTW89_ETSI, RTW89_ETSI, RTW89_NA),\n};\n\nstatic const struct rtw89_regd *rtw89_regd_find_reg_by_name(char *alpha2)\n{\n\tu32 i;\n\n\tfor (i = 0; i < ARRAY_SIZE(rtw89_regd_map); i++) {\n\t\tif (!memcmp(rtw89_regd_map[i].alpha2, alpha2, 2))\n\t\t\treturn &rtw89_regd_map[i];\n\t}\n\n\treturn &rtw89_ww_regd;\n}\n\nstatic bool rtw89_regd_is_ww(const struct rtw89_regd *regd)\n{\n\treturn regd == &rtw89_ww_regd;\n}\n\n#define rtw89_debug_regd(_dev, _regd, _desc, _argv...) \\\ndo { \\\n\ttypeof(_regd) __r = _regd; \\\n\trtw89_debug(_dev, RTW89_DBG_REGD, _desc \\\n\t\t    \": %c%c: mapping txregd to {2g: %d, 5g: %d, 6g: %d}\\n\", \\\n\t\t    ##_argv, __r->alpha2[0], __r->alpha2[1], \\\n\t\t    __r->txpwr_regd[RTW89_BAND_2G], \\\n\t\t    __r->txpwr_regd[RTW89_BAND_5G], \\\n\t\t    __r->txpwr_regd[RTW89_BAND_6G]); \\\n} while (0)\n\nstatic void rtw89_regd_setup_unii4(struct rtw89_dev *rtwdev,\n\t\t\t\t   struct wiphy *wiphy)\n{\n\tconst struct rtw89_chip_info *chip = rtwdev->chip;\n\tbool regd_allow_unii_4 = chip->support_unii4;\n\tstruct ieee80211_supported_band *sband;\n\tint ret;\n\tu8 val;\n\n\tif (!chip->support_unii4)\n\t\tgoto bottom;\n\n\tret = rtw89_acpi_evaluate_dsm(rtwdev, RTW89_ACPI_DSM_FUNC_59G_EN, &val);\n\tif (ret) {\n\t\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t\t    \"acpi: cannot eval unii 4: %d\\n\", ret);\n\t\tgoto bottom;\n\t}\n\n\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t    \"acpi: eval if allow unii 4: %d\\n\", val);\n\n\tswitch (val) {\n\tcase 0:\n\t\tregd_allow_unii_4 = false;\n\t\tbreak;\n\tcase 1:\n\t\tregd_allow_unii_4 = true;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\nbottom:\n\trtw89_debug(rtwdev, RTW89_DBG_REGD, \"regd: allow unii 4: %d\\n\",\n\t\t    regd_allow_unii_4);\n\n\tif (regd_allow_unii_4)\n\t\treturn;\n\n\tsband = wiphy->bands[NL80211_BAND_5GHZ];\n\tif (!sband)\n\t\treturn;\n\n\tsband->n_channels -= 3;\n}\n\nstatic void rtw89_regd_setup_6ghz(struct rtw89_dev *rtwdev, struct wiphy *wiphy)\n{\n\tconst struct rtw89_chip_info *chip = rtwdev->chip;\n\tbool chip_support_6ghz = chip->support_bands & BIT(NL80211_BAND_6GHZ);\n\tbool regd_allow_6ghz = chip_support_6ghz;\n\tstruct ieee80211_supported_band *sband;\n\tint ret;\n\tu8 val;\n\n\tif (!chip_support_6ghz)\n\t\tgoto bottom;\n\n\tret = rtw89_acpi_evaluate_dsm(rtwdev, RTW89_ACPI_DSM_FUNC_6G_DIS, &val);\n\tif (ret) {\n\t\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t\t    \"acpi: cannot eval 6ghz: %d\\n\", ret);\n\t\tgoto bottom;\n\t}\n\n\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t    \"acpi: eval if disallow 6ghz: %d\\n\", val);\n\n\tswitch (val) {\n\tcase 0:\n\t\tregd_allow_6ghz = true;\n\t\tbreak;\n\tcase 1:\n\t\tregd_allow_6ghz = false;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\nbottom:\n\trtw89_debug(rtwdev, RTW89_DBG_REGD, \"regd: allow 6ghz: %d\\n\",\n\t\t    regd_allow_6ghz);\n\n\tif (regd_allow_6ghz)\n\t\treturn;\n\n\tsband = wiphy->bands[NL80211_BAND_6GHZ];\n\tif (!sband)\n\t\treturn;\n\n\twiphy->bands[NL80211_BAND_6GHZ] = NULL;\n\tkfree(sband->iftype_data);\n\tkfree(sband);\n}\n\nint rtw89_regd_setup(struct rtw89_dev *rtwdev)\n{\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\n\tif (!wiphy)\n\t\treturn -EINVAL;\n\n\trtw89_regd_setup_unii4(rtwdev, wiphy);\n\trtw89_regd_setup_6ghz(rtwdev, wiphy);\n\n\twiphy->reg_notifier = rtw89_regd_notifier;\n\treturn 0;\n}\n\nint rtw89_regd_init(struct rtw89_dev *rtwdev,\n\t\t    void (*reg_notifier)(struct wiphy *wiphy,\n\t\t\t\t\t struct regulatory_request *request))\n{\n\tstruct rtw89_regulatory_info *regulatory = &rtwdev->regulatory;\n\tconst struct rtw89_regd *chip_regd;\n\tstruct wiphy *wiphy = rtwdev->hw->wiphy;\n\tint ret;\n\n\tregulatory->reg_6ghz_power = RTW89_REG_6GHZ_POWER_DFLT;\n\n\tif (!wiphy)\n\t\treturn -EINVAL;\n\n\tchip_regd = rtw89_regd_find_reg_by_name(rtwdev->efuse.country_code);\n\tif (!rtw89_regd_is_ww(chip_regd)) {\n\t\trtwdev->regulatory.regd = chip_regd;\n\t\t \n\t\twiphy->regulatory_flags |= REGULATORY_COUNTRY_IE_IGNORE;\n\t\twiphy->regulatory_flags |= REGULATORY_STRICT_REG;\n\n\t\tret = regulatory_hint(rtwdev->hw->wiphy,\n\t\t\t\t      rtwdev->regulatory.regd->alpha2);\n\t\tif (ret)\n\t\t\trtw89_warn(rtwdev, \"failed to hint regulatory:%d\\n\", ret);\n\n\t\trtw89_debug_regd(rtwdev, chip_regd, \"efuse country code\");\n\t\treturn 0;\n\t}\n\n\trtw89_debug_regd(rtwdev, rtwdev->regulatory.regd,\n\t\t\t \"worldwide roaming chip, follow the setting of stack\");\n\treturn 0;\n}\n\nstatic void rtw89_regd_notifier_apply(struct rtw89_dev *rtwdev,\n\t\t\t\t      struct wiphy *wiphy,\n\t\t\t\t      struct regulatory_request *request)\n{\n\trtwdev->regulatory.regd = rtw89_regd_find_reg_by_name(request->alpha2);\n\t \n\tif (request->initiator == NL80211_REGDOM_SET_BY_USER &&\n\t    !rtw89_regd_is_ww(rtwdev->regulatory.regd))\n\t\twiphy->regulatory_flags |= REGULATORY_COUNTRY_IE_IGNORE;\n\telse\n\t\twiphy->regulatory_flags &= ~REGULATORY_COUNTRY_IE_IGNORE;\n}\n\nvoid rtw89_regd_notifier(struct wiphy *wiphy, struct regulatory_request *request)\n{\n\tstruct ieee80211_hw *hw = wiphy_to_ieee80211_hw(wiphy);\n\tstruct rtw89_dev *rtwdev = hw->priv;\n\n\tmutex_lock(&rtwdev->mutex);\n\trtw89_leave_ps_mode(rtwdev);\n\n\tif (wiphy->regd) {\n\t\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t\t    \"There is a country domain programmed in chip, ignore notifications\\n\");\n\t\tgoto exit;\n\t}\n\trtw89_regd_notifier_apply(rtwdev, wiphy, request);\n\trtw89_debug_regd(rtwdev, rtwdev->regulatory.regd,\n\t\t\t \"get from initiator %d, alpha2\",\n\t\t\t request->initiator);\n\n\trtw89_core_set_chip_txpwr(rtwdev);\n\nexit:\n\tmutex_unlock(&rtwdev->mutex);\n}\n\nstatic void __rtw89_reg_6ghz_power_recalc(struct rtw89_dev *rtwdev)\n{\n\tstruct rtw89_regulatory_info *regulatory = &rtwdev->regulatory;\n\tenum rtw89_reg_6ghz_power sel;\n\tconst struct rtw89_chan *chan;\n\tstruct rtw89_vif *rtwvif;\n\tint count = 0;\n\n\trtw89_for_each_rtwvif(rtwdev, rtwvif) {\n\t\tchan = rtw89_chan_get(rtwdev, rtwvif->sub_entity_idx);\n\t\tif (chan->band_type != RTW89_BAND_6G)\n\t\t\tcontinue;\n\n\t\tif (count != 0 && rtwvif->reg_6ghz_power == sel)\n\t\t\tcontinue;\n\n\t\tsel = rtwvif->reg_6ghz_power;\n\t\tcount++;\n\t}\n\n\tif (count != 1)\n\t\tsel = RTW89_REG_6GHZ_POWER_DFLT;\n\n\tif (regulatory->reg_6ghz_power == sel)\n\t\treturn;\n\n\trtw89_debug(rtwdev, RTW89_DBG_REGD,\n\t\t    \"recalc 6 GHz reg power type to %d\\n\", sel);\n\n\tregulatory->reg_6ghz_power = sel;\n\n\trtw89_core_set_chip_txpwr(rtwdev);\n}\n\nvoid rtw89_reg_6ghz_power_recalc(struct rtw89_dev *rtwdev,\n\t\t\t\t struct rtw89_vif *rtwvif, bool active)\n{\n\tstruct ieee80211_vif *vif = rtwvif_to_vif(rtwvif);\n\n\tlockdep_assert_held(&rtwdev->mutex);\n\n\tif (active) {\n\t\tswitch (vif->bss_conf.power_type) {\n\t\tcase IEEE80211_REG_VLP_AP:\n\t\t\trtwvif->reg_6ghz_power = RTW89_REG_6GHZ_POWER_VLP;\n\t\t\tbreak;\n\t\tcase IEEE80211_REG_LPI_AP:\n\t\t\trtwvif->reg_6ghz_power = RTW89_REG_6GHZ_POWER_LPI;\n\t\t\tbreak;\n\t\tcase IEEE80211_REG_SP_AP:\n\t\t\trtwvif->reg_6ghz_power = RTW89_REG_6GHZ_POWER_STD;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\trtwvif->reg_6ghz_power = RTW89_REG_6GHZ_POWER_DFLT;\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\trtwvif->reg_6ghz_power = RTW89_REG_6GHZ_POWER_DFLT;\n\t}\n\n\t__rtw89_reg_6ghz_power_recalc(rtwdev);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}