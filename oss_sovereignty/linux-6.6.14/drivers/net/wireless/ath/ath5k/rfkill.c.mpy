{
  "module_name": "rfkill.c",
  "hash_id": "9ee33b5920eaabc225947fcc3a7c4cdf5ee562129c843053d394fee17671ade3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath5k/rfkill.c",
  "human_readable_source": " \n\n#include \"ath5k.h\"\n\n\nstatic inline void ath5k_rfkill_disable(struct ath5k_hw *ah)\n{\n\tATH5K_DBG(ah, ATH5K_DEBUG_ANY, \"rfkill disable (gpio:%d polarity:%d)\\n\",\n\t\tah->rf_kill.gpio, ah->rf_kill.polarity);\n\tath5k_hw_set_gpio_output(ah, ah->rf_kill.gpio);\n\tath5k_hw_set_gpio(ah, ah->rf_kill.gpio, !ah->rf_kill.polarity);\n}\n\n\nstatic inline void ath5k_rfkill_enable(struct ath5k_hw *ah)\n{\n\tATH5K_DBG(ah, ATH5K_DEBUG_ANY, \"rfkill enable (gpio:%d polarity:%d)\\n\",\n\t\tah->rf_kill.gpio, ah->rf_kill.polarity);\n\tath5k_hw_set_gpio_output(ah, ah->rf_kill.gpio);\n\tath5k_hw_set_gpio(ah, ah->rf_kill.gpio, ah->rf_kill.polarity);\n}\n\nstatic inline void ath5k_rfkill_set_intr(struct ath5k_hw *ah, bool enable)\n{\n\tu32 curval;\n\n\tath5k_hw_set_gpio_input(ah, ah->rf_kill.gpio);\n\tcurval = ath5k_hw_get_gpio(ah, ah->rf_kill.gpio);\n\tath5k_hw_set_gpio_intr(ah, ah->rf_kill.gpio, enable ?\n\t\t\t\t\t!!curval : !curval);\n}\n\nstatic bool\nath5k_is_rfkill_set(struct ath5k_hw *ah)\n{\n\t \n\t \n\treturn ath5k_hw_get_gpio(ah, ah->rf_kill.gpio) ==\n\t\t\t\t\t\t\tah->rf_kill.polarity;\n}\n\nstatic void\nath5k_tasklet_rfkill_toggle(struct tasklet_struct *t)\n{\n\tstruct ath5k_hw *ah = from_tasklet(ah, t, rf_kill.toggleq);\n\tbool blocked;\n\n\tblocked = ath5k_is_rfkill_set(ah);\n\twiphy_rfkill_set_hw_state(ah->hw->wiphy, blocked);\n}\n\n\nvoid\nath5k_rfkill_hw_start(struct ath5k_hw *ah)\n{\n\t \n\tah->rf_kill.gpio = ah->ah_capabilities.cap_eeprom.ee_rfkill_pin;\n\tah->rf_kill.polarity = ah->ah_capabilities.cap_eeprom.ee_rfkill_pol;\n\n\ttasklet_setup(&ah->rf_kill.toggleq, ath5k_tasklet_rfkill_toggle);\n\n\tath5k_rfkill_disable(ah);\n\n\t \n\tif (AR5K_EEPROM_HDR_RFKILL(ah->ah_capabilities.cap_eeprom.ee_header))\n\t\tath5k_rfkill_set_intr(ah, true);\n}\n\n\nvoid\nath5k_rfkill_hw_stop(struct ath5k_hw *ah)\n{\n\t \n\tif (AR5K_EEPROM_HDR_RFKILL(ah->ah_capabilities.cap_eeprom.ee_header))\n\t\tath5k_rfkill_set_intr(ah, false);\n\n\ttasklet_kill(&ah->rf_kill.toggleq);\n\n\t \n\tath5k_rfkill_enable(ah);\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}