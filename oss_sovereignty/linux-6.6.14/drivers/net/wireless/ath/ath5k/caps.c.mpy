{
  "module_name": "caps.c",
  "hash_id": "9b02efe740fe57c768a0cc63bc07f0702671a852a8dc79ab0aeaa038c7dcefdd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath5k/caps.c",
  "human_readable_source": " \n\n \n\n#include \"ath5k.h\"\n#include \"reg.h\"\n#include \"debug.h\"\n#include \"../regd.h\"\n\n \nint ath5k_hw_set_capabilities(struct ath5k_hw *ah)\n{\n\tstruct ath5k_capabilities *caps = &ah->ah_capabilities;\n\tu16 ee_header;\n\n\t \n\tee_header = caps->cap_eeprom.ee_header;\n\n\tif (ah->ah_version == AR5K_AR5210) {\n\t\t \n\t\tcaps->cap_range.range_5ghz_min = 5120;\n\t\tcaps->cap_range.range_5ghz_max = 5430;\n\t\tcaps->cap_range.range_2ghz_min = 0;\n\t\tcaps->cap_range.range_2ghz_max = 0;\n\n\t\t \n\t\t__set_bit(AR5K_MODE_11A, caps->cap_mode);\n\t} else {\n\t\t \n\n\t\t \n\n\t\tif (AR5K_EEPROM_HDR_11A(ee_header)) {\n\t\t\tif (ath_is_49ghz_allowed(caps->cap_eeprom.ee_regdomain))\n\t\t\t\tcaps->cap_range.range_5ghz_min = 4920;\n\t\t\telse\n\t\t\t\tcaps->cap_range.range_5ghz_min = 5005;\n\t\t\tcaps->cap_range.range_5ghz_max = 6100;\n\n\t\t\t \n\t\t\t__set_bit(AR5K_MODE_11A, caps->cap_mode);\n\t\t}\n\n\t\t \n\t\tif (AR5K_EEPROM_HDR_11B(ee_header) ||\n\t\t    (AR5K_EEPROM_HDR_11G(ee_header) &&\n\t\t     ah->ah_version != AR5K_AR5211)) {\n\t\t\t \n\t\t\tcaps->cap_range.range_2ghz_min = 2412;\n\t\t\tcaps->cap_range.range_2ghz_max = 2732;\n\n\t\t\t \n\t\t\tif (!caps->cap_needs_2GHz_ovr) {\n\t\t\t\tif (AR5K_EEPROM_HDR_11B(ee_header))\n\t\t\t\t\t__set_bit(AR5K_MODE_11B,\n\t\t\t\t\t\t\tcaps->cap_mode);\n\n\t\t\t\tif (AR5K_EEPROM_HDR_11G(ee_header) &&\n\t\t\t\tah->ah_version != AR5K_AR5211)\n\t\t\t\t\t__set_bit(AR5K_MODE_11G,\n\t\t\t\t\t\t\tcaps->cap_mode);\n\t\t\t}\n\t\t}\n\t}\n\n\tif ((ah->ah_radio_5ghz_revision & 0xf0) == AR5K_SREV_RAD_2112)\n\t\t__clear_bit(AR5K_MODE_11A, caps->cap_mode);\n\n\t \n\tif (ah->ah_version == AR5K_AR5210)\n\t\tcaps->cap_queues.q_tx_num = AR5K_NUM_TX_QUEUES_NOQCU;\n\telse\n\t\tcaps->cap_queues.q_tx_num = AR5K_NUM_TX_QUEUES;\n\n\t \n\tif (ah->ah_mac_srev >= AR5K_SREV_AR5213A)\n\t\tcaps->cap_has_phyerr_counters = true;\n\telse\n\t\tcaps->cap_has_phyerr_counters = false;\n\n\t \n\tif (ah->ah_version == AR5K_AR5212)\n\t\tcaps->cap_has_mrr_support = true;\n\telse\n\t\tcaps->cap_has_mrr_support = false;\n\n\treturn 0;\n}\n\n \n\nint ath5k_hw_enable_pspoll(struct ath5k_hw *ah, u8 *bssid,\n\t\tu16 assoc_id)\n{\n\tif (ah->ah_version == AR5K_AR5210) {\n\t\tAR5K_REG_DISABLE_BITS(ah, AR5K_STA_ID1,\n\t\t\tAR5K_STA_ID1_NO_PSPOLL | AR5K_STA_ID1_DEFAULT_ANTENNA);\n\t\treturn 0;\n\t}\n\n\treturn -EIO;\n}\n\nint ath5k_hw_disable_pspoll(struct ath5k_hw *ah)\n{\n\tif (ah->ah_version == AR5K_AR5210) {\n\t\tAR5K_REG_ENABLE_BITS(ah, AR5K_STA_ID1,\n\t\t\tAR5K_STA_ID1_NO_PSPOLL | AR5K_STA_ID1_DEFAULT_ANTENNA);\n\t\treturn 0;\n\t}\n\n\treturn -EIO;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}