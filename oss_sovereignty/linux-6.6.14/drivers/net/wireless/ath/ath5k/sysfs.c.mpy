{
  "module_name": "sysfs.c",
  "hash_id": "f65be0edf3d03a137a591b2df5a0175389cb44cca48010e099489d97807391bb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath5k/sysfs.c",
  "human_readable_source": "\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/device.h>\n#include <linux/pci.h>\n\n#include \"ath5k.h\"\n#include \"reg.h\"\n\n#define SIMPLE_SHOW_STORE(name, get, set)\t\t\t\t\\\nstatic ssize_t ath5k_attr_show_##name(struct device *dev,\t\t\\\n\t\t\tstruct device_attribute *attr,\t\t\t\\\n\t\t\tchar *buf)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct ieee80211_hw *hw = dev_get_drvdata(dev);\t\t\t\\\n\tstruct ath5k_hw *ah = hw->priv;\t\t\t\t\\\n\treturn sysfs_emit(buf, \"%d\\n\", get);\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\nstatic ssize_t ath5k_attr_store_##name(struct device *dev,\t\t\\\n\t\t\tstruct device_attribute *attr,\t\t\t\\\n\t\t\tconst char *buf, size_t count)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct ieee80211_hw *hw = dev_get_drvdata(dev);\t\t\t\\\n\tstruct ath5k_hw *ah = hw->priv;\t\t\t\t\\\n\tint val, ret;\t\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tret = kstrtoint(buf, 10, &val);\t\t\t\t\t\\\n\tif (ret < 0)\t\t\t\t\t\t\t\\\n\t\treturn ret;\t\t\t\t\t\t\\\n\tset(ah, val);\t\t\t\t\t\t\\\n\treturn count;\t\t\t\t\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\nstatic DEVICE_ATTR(name, 0644,\t\t\t\t\t\t\\\n\t\t   ath5k_attr_show_##name, ath5k_attr_store_##name)\n\n#define SIMPLE_SHOW(name, get)\t\t\t\t\t\t\\\nstatic ssize_t ath5k_attr_show_##name(struct device *dev,\t\t\\\n\t\t\tstruct device_attribute *attr,\t\t\t\\\n\t\t\tchar *buf)\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct ieee80211_hw *hw = dev_get_drvdata(dev);\t\t\t\\\n\tstruct ath5k_hw *ah = hw->priv;\t\t\t\t\\\n\treturn sysfs_emit(buf, \"%d\\n\", get);\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\nstatic DEVICE_ATTR(name, 0444, ath5k_attr_show_##name, NULL)\n\n \n\nSIMPLE_SHOW_STORE(ani_mode, ah->ani_state.ani_mode, ath5k_ani_init);\nSIMPLE_SHOW_STORE(noise_immunity_level, ah->ani_state.noise_imm_level,\n\t\t\tath5k_ani_set_noise_immunity_level);\nSIMPLE_SHOW_STORE(spur_level, ah->ani_state.spur_level,\n\t\t\tath5k_ani_set_spur_immunity_level);\nSIMPLE_SHOW_STORE(firstep_level, ah->ani_state.firstep_level,\n\t\t\tath5k_ani_set_firstep_level);\nSIMPLE_SHOW_STORE(ofdm_weak_signal_detection, ah->ani_state.ofdm_weak_sig,\n\t\t\tath5k_ani_set_ofdm_weak_signal_detection);\nSIMPLE_SHOW_STORE(cck_weak_signal_detection, ah->ani_state.cck_weak_sig,\n\t\t\tath5k_ani_set_cck_weak_signal_detection);\nSIMPLE_SHOW(spur_level_max, ah->ani_state.max_spur_level);\n\nstatic ssize_t ath5k_attr_show_noise_immunity_level_max(struct device *dev,\n\t\t\tstruct device_attribute *attr,\n\t\t\tchar *buf)\n{\n\treturn sysfs_emit(buf, \"%d\\n\", ATH5K_ANI_MAX_NOISE_IMM_LVL);\n}\nstatic DEVICE_ATTR(noise_immunity_level_max, 0444,\n\t\t   ath5k_attr_show_noise_immunity_level_max, NULL);\n\nstatic ssize_t ath5k_attr_show_firstep_level_max(struct device *dev,\n\t\t\tstruct device_attribute *attr,\n\t\t\tchar *buf)\n{\n\treturn sysfs_emit(buf, \"%d\\n\", ATH5K_ANI_MAX_FIRSTEP_LVL);\n}\nstatic DEVICE_ATTR(firstep_level_max, 0444,\n\t\t   ath5k_attr_show_firstep_level_max, NULL);\n\nstatic struct attribute *ath5k_sysfs_entries_ani[] = {\n\t&dev_attr_ani_mode.attr,\n\t&dev_attr_noise_immunity_level.attr,\n\t&dev_attr_spur_level.attr,\n\t&dev_attr_firstep_level.attr,\n\t&dev_attr_ofdm_weak_signal_detection.attr,\n\t&dev_attr_cck_weak_signal_detection.attr,\n\t&dev_attr_noise_immunity_level_max.attr,\n\t&dev_attr_spur_level_max.attr,\n\t&dev_attr_firstep_level_max.attr,\n\tNULL\n};\n\nstatic struct attribute_group ath5k_attribute_group_ani = {\n\t.name = \"ani\",\n\t.attrs = ath5k_sysfs_entries_ani,\n};\n\n\n \n\nint\nath5k_sysfs_register(struct ath5k_hw *ah)\n{\n\tstruct device *dev = ah->dev;\n\tint err;\n\n\terr = sysfs_create_group(&dev->kobj, &ath5k_attribute_group_ani);\n\tif (err) {\n\t\tATH5K_ERR(ah, \"failed to create sysfs group\\n\");\n\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nvoid\nath5k_sysfs_unregister(struct ath5k_hw *ah)\n{\n\tstruct device *dev = ah->dev;\n\n\tsysfs_remove_group(&dev->kobj, &ath5k_attribute_group_ani);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}