{
  "module_name": "pci.h",
  "hash_id": "efe4820e347357d51d19c5b54e8e486575c40aa0f270b80aef908a7af1b42630",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath10k/pci.h",
  "human_readable_source": " \n \n\n#ifndef _PCI_H_\n#define _PCI_H_\n\n#include <linux/interrupt.h>\n#include <linux/mutex.h>\n\n#include \"hw.h\"\n#include \"ce.h\"\n#include \"ahb.h\"\n\n \n#define DIAG_TRANSFER_LIMIT 2048\n\nstruct bmi_xfer {\n\tbool tx_done;\n\tbool rx_done;\n\tbool wait_for_resp;\n\tu32 resp_len;\n};\n\n \nstruct pcie_state {\n\t \n\t \n\tu32 pipe_cfg_addr;\n\n\t \n\t \n\tu32 svc_to_pipe_map;\n\n\t \n\tu32 msi_requested;\n\n\t \n\tu32 msi_granted;\n\n\t \n\tu32 msi_addr;\n\n\t \n\tu32 msi_data;\n\n\t \n\tu32 msi_fw_intr_data;\n\n\t \n\tu32 power_mgmt_method;\n\n\t \n\tu32 config_flags;\n};\n\n \n#define PCIE_CONFIG_FLAG_ENABLE_L1  0x0000001\n\n \nstruct ath10k_pci_pipe {\n\t \n\tstruct ath10k_ce_pipe *ce_hdl;\n\n\t \n\tu8 pipe_num;\n\n\t \n\tstruct ath10k *hif_ce_state;\n\n\tsize_t buf_sz;\n\n\t \n\tspinlock_t pipe_lock;\n};\n\nstruct ath10k_pci_supp_chip {\n\tu32 dev_id;\n\tu32 rev_id;\n};\n\nenum ath10k_pci_irq_mode {\n\tATH10K_PCI_IRQ_AUTO = 0,\n\tATH10K_PCI_IRQ_LEGACY = 1,\n\tATH10K_PCI_IRQ_MSI = 2,\n};\n\nstruct ath10k_pci {\n\tstruct pci_dev *pdev;\n\tstruct device *dev;\n\tstruct ath10k *ar;\n\tvoid __iomem *mem;\n\tsize_t mem_len;\n\n\t \n\tenum ath10k_pci_irq_mode oper_irq_mode;\n\n\tstruct ath10k_pci_pipe pipe_info[CE_COUNT_MAX];\n\n\t \n\tstruct ath10k_ce_pipe *ce_diag;\n\t \n\tstruct mutex ce_diag_mutex;\n\n\tstruct work_struct dump_work;\n\n\tstruct ath10k_ce ce;\n\tstruct timer_list rx_post_retry;\n\n\t \n\tu16 link_ctl;\n\n\t \n\tspinlock_t ps_lock;\n\n\t \n\tunsigned long ps_wake_refcount;\n\n\t \n\tstruct timer_list ps_timer;\n\n\t \n\tbool ps_awake;\n\n\t \n\tbool pci_ps;\n\n\t \n\tint (*pci_soft_reset)(struct ath10k *ar);\n\n\t \n\tint (*pci_hard_reset)(struct ath10k *ar);\n\n\t \n\tu32 (*targ_cpu_to_ce_addr)(struct ath10k *ar, u32 addr);\n\n\tstruct ce_attr *attr;\n\tstruct ce_pipe_config *pipe_config;\n\tstruct ce_service_to_pipe *serv_to_pipe;\n\n\t \n\tstruct ath10k_ahb ahb[];\n\n};\n\nstatic inline struct ath10k_pci *ath10k_pci_priv(struct ath10k *ar)\n{\n\treturn (struct ath10k_pci *)ar->drv_priv;\n}\n\n#define ATH10K_PCI_RX_POST_RETRY_MS 50\n#define ATH_PCI_RESET_WAIT_MAX 10  \n#define PCIE_WAKE_TIMEOUT 30000\t \n#define PCIE_WAKE_LATE_US 10000\t \n\n#define BAR_NUM 0\n\n#define CDC_WAR_MAGIC_STR   0xceef0000\n#define CDC_WAR_DATA_CE     4\n\n \n#define DIAG_ACCESS_CE_TIMEOUT_US 10000  \n#define DIAG_ACCESS_CE_WAIT_US\t50\n\nvoid ath10k_pci_write32(struct ath10k *ar, u32 offset, u32 value);\nvoid ath10k_pci_soc_write32(struct ath10k *ar, u32 addr, u32 val);\nvoid ath10k_pci_reg_write32(struct ath10k *ar, u32 addr, u32 val);\n\nu32 ath10k_pci_read32(struct ath10k *ar, u32 offset);\nu32 ath10k_pci_soc_read32(struct ath10k *ar, u32 addr);\nu32 ath10k_pci_reg_read32(struct ath10k *ar, u32 addr);\n\nint ath10k_pci_hif_tx_sg(struct ath10k *ar, u8 pipe_id,\n\t\t\t struct ath10k_hif_sg_item *items, int n_items);\nint ath10k_pci_hif_diag_read(struct ath10k *ar, u32 address, void *buf,\n\t\t\t     size_t buf_len);\nint ath10k_pci_diag_write_mem(struct ath10k *ar, u32 address,\n\t\t\t      const void *data, int nbytes);\nint ath10k_pci_hif_exchange_bmi_msg(struct ath10k *ar, void *req, u32 req_len,\n\t\t\t\t    void *resp, u32 *resp_len);\nint ath10k_pci_hif_map_service_to_pipe(struct ath10k *ar, u16 service_id,\n\t\t\t\t       u8 *ul_pipe, u8 *dl_pipe);\nvoid ath10k_pci_hif_get_default_pipe(struct ath10k *ar, u8 *ul_pipe,\n\t\t\t\t     u8 *dl_pipe);\nvoid ath10k_pci_hif_send_complete_check(struct ath10k *ar, u8 pipe,\n\t\t\t\t\tint force);\nu16 ath10k_pci_hif_get_free_queue_number(struct ath10k *ar, u8 pipe);\nvoid ath10k_pci_hif_power_down(struct ath10k *ar);\nint ath10k_pci_alloc_pipes(struct ath10k *ar);\nvoid ath10k_pci_free_pipes(struct ath10k *ar);\nvoid ath10k_pci_rx_replenish_retry(struct timer_list *t);\nvoid ath10k_pci_ce_deinit(struct ath10k *ar);\nvoid ath10k_pci_init_napi(struct ath10k *ar);\nint ath10k_pci_init_pipes(struct ath10k *ar);\nint ath10k_pci_init_config(struct ath10k *ar);\nvoid ath10k_pci_rx_post(struct ath10k *ar);\nvoid ath10k_pci_flush(struct ath10k *ar);\nvoid ath10k_pci_enable_legacy_irq(struct ath10k *ar);\nbool ath10k_pci_irq_pending(struct ath10k *ar);\nvoid ath10k_pci_disable_and_clear_legacy_irq(struct ath10k *ar);\nvoid ath10k_pci_irq_msi_fw_mask(struct ath10k *ar);\nint ath10k_pci_wait_for_target_init(struct ath10k *ar);\nint ath10k_pci_setup_resource(struct ath10k *ar);\nvoid ath10k_pci_release_resource(struct ath10k *ar);\n\n \n#define ATH10K_PCI_SLEEP_GRACE_PERIOD_MSEC 60\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}