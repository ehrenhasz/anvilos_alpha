{
  "module_name": "htt.h",
  "hash_id": "dd3fbeb79e116f1df57e10c44bff4a40cfe2cb1673124277be18dddef3daae0d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath10k/htt.h",
  "human_readable_source": " \n \n\n#ifndef _HTT_H_\n#define _HTT_H_\n\n#include <linux/bug.h>\n#include <linux/interrupt.h>\n#include <linux/dmapool.h>\n#include <linux/hashtable.h>\n#include <linux/kfifo.h>\n#include <net/mac80211.h>\n\n#include \"htc.h\"\n#include \"hw.h\"\n#include \"rx_desc.h\"\n\nenum htt_dbg_stats_type {\n\tHTT_DBG_STATS_WAL_PDEV_TXRX = 1 << 0,\n\tHTT_DBG_STATS_RX_REORDER    = 1 << 1,\n\tHTT_DBG_STATS_RX_RATE_INFO  = 1 << 2,\n\tHTT_DBG_STATS_TX_PPDU_LOG   = 1 << 3,\n\tHTT_DBG_STATS_TX_RATE_INFO  = 1 << 4,\n\t \n\n\tHTT_DBG_NUM_STATS  \n};\n\nenum htt_h2t_msg_type {  \n\tHTT_H2T_MSG_TYPE_VERSION_REQ        = 0,\n\tHTT_H2T_MSG_TYPE_TX_FRM             = 1,\n\tHTT_H2T_MSG_TYPE_RX_RING_CFG        = 2,\n\tHTT_H2T_MSG_TYPE_STATS_REQ          = 3,\n\tHTT_H2T_MSG_TYPE_SYNC               = 4,\n\tHTT_H2T_MSG_TYPE_AGGR_CFG           = 5,\n\tHTT_H2T_MSG_TYPE_FRAG_DESC_BANK_CFG = 6,\n\n\t \n\tHTT_H2T_MSG_TYPE_MGMT_TX            = 7,\n\tHTT_H2T_MSG_TYPE_TX_FETCH_RESP      = 11,\n\n\tHTT_H2T_NUM_MSGS  \n};\n\nstruct htt_cmd_hdr {\n\tu8 msg_type;\n} __packed;\n\nstruct htt_ver_req {\n\tu8 pad[sizeof(u32) - sizeof(struct htt_cmd_hdr)];\n} __packed;\n\n \nstruct htt_data_tx_desc_frag {\n\tunion {\n\t\tstruct double_word_addr {\n\t\t\t__le32 paddr;\n\t\t\t__le32 len;\n\t\t} __packed dword_addr;\n\t\tstruct triple_word_addr {\n\t\t\t__le32 paddr_lo;\n\t\t\t__le16 paddr_hi;\n\t\t\t__le16 len_16;\n\t\t} __packed tword_addr;\n\t} __packed;\n} __packed;\n\nstruct htt_msdu_ext_desc {\n\t__le32 tso_flag[3];\n\t__le16 ip_identification;\n\tu8 flags;\n\tu8 reserved;\n\tstruct htt_data_tx_desc_frag frags[6];\n};\n\nstruct htt_msdu_ext_desc_64 {\n\t__le32 tso_flag[5];\n\t__le16 ip_identification;\n\tu8 flags;\n\tu8 reserved;\n\tstruct htt_data_tx_desc_frag frags[6];\n};\n\n#define\tHTT_MSDU_EXT_DESC_FLAG_IPV4_CSUM_ENABLE\t\tBIT(0)\n#define\tHTT_MSDU_EXT_DESC_FLAG_UDP_IPV4_CSUM_ENABLE\tBIT(1)\n#define\tHTT_MSDU_EXT_DESC_FLAG_UDP_IPV6_CSUM_ENABLE\tBIT(2)\n#define\tHTT_MSDU_EXT_DESC_FLAG_TCP_IPV4_CSUM_ENABLE\tBIT(3)\n#define\tHTT_MSDU_EXT_DESC_FLAG_TCP_IPV6_CSUM_ENABLE\tBIT(4)\n\n#define HTT_MSDU_CHECKSUM_ENABLE (HTT_MSDU_EXT_DESC_FLAG_IPV4_CSUM_ENABLE \\\n\t\t\t\t | HTT_MSDU_EXT_DESC_FLAG_UDP_IPV4_CSUM_ENABLE \\\n\t\t\t\t | HTT_MSDU_EXT_DESC_FLAG_UDP_IPV6_CSUM_ENABLE \\\n\t\t\t\t | HTT_MSDU_EXT_DESC_FLAG_TCP_IPV4_CSUM_ENABLE \\\n\t\t\t\t | HTT_MSDU_EXT_DESC_FLAG_TCP_IPV6_CSUM_ENABLE)\n\n#define HTT_MSDU_EXT_DESC_FLAG_IPV4_CSUM_ENABLE_64\t\tBIT(16)\n#define HTT_MSDU_EXT_DESC_FLAG_UDP_IPV4_CSUM_ENABLE_64\t\tBIT(17)\n#define HTT_MSDU_EXT_DESC_FLAG_UDP_IPV6_CSUM_ENABLE_64\t\tBIT(18)\n#define HTT_MSDU_EXT_DESC_FLAG_TCP_IPV4_CSUM_ENABLE_64\t\tBIT(19)\n#define HTT_MSDU_EXT_DESC_FLAG_TCP_IPV6_CSUM_ENABLE_64\t\tBIT(20)\n#define HTT_MSDU_EXT_DESC_FLAG_PARTIAL_CSUM_ENABLE_64\t\tBIT(21)\n\n#define HTT_MSDU_CHECKSUM_ENABLE_64  (HTT_MSDU_EXT_DESC_FLAG_IPV4_CSUM_ENABLE_64 \\\n\t\t\t\t     | HTT_MSDU_EXT_DESC_FLAG_UDP_IPV4_CSUM_ENABLE_64 \\\n\t\t\t\t     | HTT_MSDU_EXT_DESC_FLAG_UDP_IPV6_CSUM_ENABLE_64 \\\n\t\t\t\t     | HTT_MSDU_EXT_DESC_FLAG_TCP_IPV4_CSUM_ENABLE_64 \\\n\t\t\t\t     | HTT_MSDU_EXT_DESC_FLAG_TCP_IPV6_CSUM_ENABLE_64)\n\nenum htt_data_tx_desc_flags0 {\n\tHTT_DATA_TX_DESC_FLAGS0_MAC_HDR_PRESENT = 1 << 0,\n\tHTT_DATA_TX_DESC_FLAGS0_NO_AGGR         = 1 << 1,\n\tHTT_DATA_TX_DESC_FLAGS0_NO_ENCRYPT      = 1 << 2,\n\tHTT_DATA_TX_DESC_FLAGS0_NO_CLASSIFY     = 1 << 3,\n\tHTT_DATA_TX_DESC_FLAGS0_RSVD0           = 1 << 4\n#define HTT_DATA_TX_DESC_FLAGS0_PKT_TYPE_MASK 0xE0\n#define HTT_DATA_TX_DESC_FLAGS0_PKT_TYPE_LSB 5\n};\n\nenum htt_data_tx_desc_flags1 {\n#define HTT_DATA_TX_DESC_FLAGS1_VDEV_ID_BITS 6\n#define HTT_DATA_TX_DESC_FLAGS1_VDEV_ID_MASK 0x003F\n#define HTT_DATA_TX_DESC_FLAGS1_VDEV_ID_LSB  0\n#define HTT_DATA_TX_DESC_FLAGS1_EXT_TID_BITS 5\n#define HTT_DATA_TX_DESC_FLAGS1_EXT_TID_MASK 0x07C0\n#define HTT_DATA_TX_DESC_FLAGS1_EXT_TID_LSB  6\n\tHTT_DATA_TX_DESC_FLAGS1_POSTPONED        = 1 << 11,\n\tHTT_DATA_TX_DESC_FLAGS1_MORE_IN_BATCH    = 1 << 12,\n\tHTT_DATA_TX_DESC_FLAGS1_CKSUM_L3_OFFLOAD = 1 << 13,\n\tHTT_DATA_TX_DESC_FLAGS1_CKSUM_L4_OFFLOAD = 1 << 14,\n\tHTT_DATA_TX_DESC_FLAGS1_TX_COMPLETE      = 1 << 15\n};\n\n#define HTT_TX_CREDIT_DELTA_ABS_M      0xffff0000\n#define HTT_TX_CREDIT_DELTA_ABS_S      16\n#define HTT_TX_CREDIT_DELTA_ABS_GET(word) \\\n\t    (((word) & HTT_TX_CREDIT_DELTA_ABS_M) >> HTT_TX_CREDIT_DELTA_ABS_S)\n\n#define HTT_TX_CREDIT_SIGN_BIT_M       0x00000100\n#define HTT_TX_CREDIT_SIGN_BIT_S       8\n#define HTT_TX_CREDIT_SIGN_BIT_GET(word) \\\n\t    (((word) & HTT_TX_CREDIT_SIGN_BIT_M) >> HTT_TX_CREDIT_SIGN_BIT_S)\n\nenum htt_data_tx_ext_tid {\n\tHTT_DATA_TX_EXT_TID_NON_QOS_MCAST_BCAST = 16,\n\tHTT_DATA_TX_EXT_TID_MGMT                = 17,\n\tHTT_DATA_TX_EXT_TID_INVALID             = 31\n};\n\n#define HTT_INVALID_PEERID 0xFFFF\n\n \nstruct htt_data_tx_desc {\n\tu8 flags0;  \n\t__le16 flags1;  \n\t__le16 len;\n\t__le16 id;\n\t__le32 frags_paddr;\n\tunion {\n\t\t__le32 peerid;\n\t\tstruct {\n\t\t\t__le16 peerid;\n\t\t\t__le16 freq;\n\t\t} __packed offchan_tx;\n\t} __packed;\n\tu8 prefetch[0];  \n} __packed;\n\nstruct htt_data_tx_desc_64 {\n\tu8 flags0;  \n\t__le16 flags1;  \n\t__le16 len;\n\t__le16 id;\n\t__le64 frags_paddr;\n\tunion {\n\t\t__le32 peerid;\n\t\tstruct {\n\t\t\t__le16 peerid;\n\t\t\t__le16 freq;\n\t\t} __packed offchan_tx;\n\t} __packed;\n\tu8 prefetch[0];  \n} __packed;\n\nenum htt_rx_ring_flags {\n\tHTT_RX_RING_FLAGS_MAC80211_HDR = 1 << 0,\n\tHTT_RX_RING_FLAGS_MSDU_PAYLOAD = 1 << 1,\n\tHTT_RX_RING_FLAGS_PPDU_START   = 1 << 2,\n\tHTT_RX_RING_FLAGS_PPDU_END     = 1 << 3,\n\tHTT_RX_RING_FLAGS_MPDU_START   = 1 << 4,\n\tHTT_RX_RING_FLAGS_MPDU_END     = 1 << 5,\n\tHTT_RX_RING_FLAGS_MSDU_START   = 1 << 6,\n\tHTT_RX_RING_FLAGS_MSDU_END     = 1 << 7,\n\tHTT_RX_RING_FLAGS_RX_ATTENTION = 1 << 8,\n\tHTT_RX_RING_FLAGS_FRAG_INFO    = 1 << 9,\n\tHTT_RX_RING_FLAGS_UNICAST_RX   = 1 << 10,\n\tHTT_RX_RING_FLAGS_MULTICAST_RX = 1 << 11,\n\tHTT_RX_RING_FLAGS_CTRL_RX      = 1 << 12,\n\tHTT_RX_RING_FLAGS_MGMT_RX      = 1 << 13,\n\tHTT_RX_RING_FLAGS_NULL_RX      = 1 << 14,\n\tHTT_RX_RING_FLAGS_PHY_DATA_RX  = 1 << 15\n};\n\n#define HTT_RX_RING_SIZE_MIN 128\n#define HTT_RX_RING_SIZE_MAX 2048\n#define HTT_RX_RING_SIZE HTT_RX_RING_SIZE_MAX\n#define HTT_RX_RING_FILL_LEVEL (((HTT_RX_RING_SIZE) / 2) - 1)\n#define HTT_RX_RING_FILL_LEVEL_DUAL_MAC (HTT_RX_RING_SIZE - 1)\n\nstruct htt_rx_ring_rx_desc_offsets {\n\t \n\t__le16 mac80211_hdr_offset;\n\t__le16 msdu_payload_offset;\n\t__le16 ppdu_start_offset;\n\t__le16 ppdu_end_offset;\n\t__le16 mpdu_start_offset;\n\t__le16 mpdu_end_offset;\n\t__le16 msdu_start_offset;\n\t__le16 msdu_end_offset;\n\t__le16 rx_attention_offset;\n\t__le16 frag_info_offset;\n} __packed;\n\nstruct htt_rx_ring_setup_ring32 {\n\t__le32 fw_idx_shadow_reg_paddr;\n\t__le32 rx_ring_base_paddr;\n\t__le16 rx_ring_len;  \n\t__le16 rx_ring_bufsize;  \n\t__le16 flags;  \n\t__le16 fw_idx_init_val;\n\n\tstruct htt_rx_ring_rx_desc_offsets offsets;\n} __packed;\n\nstruct htt_rx_ring_setup_ring64 {\n\t__le64 fw_idx_shadow_reg_paddr;\n\t__le64 rx_ring_base_paddr;\n\t__le16 rx_ring_len;  \n\t__le16 rx_ring_bufsize;  \n\t__le16 flags;  \n\t__le16 fw_idx_init_val;\n\n\tstruct htt_rx_ring_rx_desc_offsets offsets;\n} __packed;\n\nstruct htt_rx_ring_setup_hdr {\n\tu8 num_rings;  \n\t__le16 rsvd0;\n} __packed;\n\nstruct htt_rx_ring_setup_32 {\n\tstruct htt_rx_ring_setup_hdr hdr;\n\tstruct htt_rx_ring_setup_ring32 rings[];\n} __packed;\n\nstruct htt_rx_ring_setup_64 {\n\tstruct htt_rx_ring_setup_hdr hdr;\n\tstruct htt_rx_ring_setup_ring64 rings[];\n} __packed;\n\n \nstruct htt_stats_req {\n\tu8 upload_types[3];\n\tu8 rsvd0;\n\tu8 reset_types[3];\n\tstruct {\n\t\tu8 mpdu_bytes;\n\t\tu8 mpdu_num_msdus;\n\t\tu8 msdu_bytes;\n\t} __packed;\n\tu8 stat_type;\n\t__le32 cookie_lsb;\n\t__le32 cookie_msb;\n} __packed;\n\n#define HTT_STATS_REQ_CFG_STAT_TYPE_INVALID 0xff\n#define HTT_STATS_BIT_MASK GENMASK(16, 0)\n\n \nstruct htt_oob_sync_req {\n\tu8 sync_count;\n\t__le16 rsvd0;\n} __packed;\n\nstruct htt_aggr_conf {\n\tu8 max_num_ampdu_subframes;\n\t \n\tu8 max_num_amsdu_subframes;\n} __packed;\n\nstruct htt_aggr_conf_v2 {\n\tu8 max_num_ampdu_subframes;\n\t \n\tu8 max_num_amsdu_subframes;\n\tu8 reserved;\n} __packed;\n\n#define HTT_MGMT_FRM_HDR_DOWNLOAD_LEN 32\nstruct htt_mgmt_tx_desc_qca99x0 {\n\t__le32 rate;\n} __packed;\n\nstruct htt_mgmt_tx_desc {\n\tu8 pad[sizeof(u32) - sizeof(struct htt_cmd_hdr)];\n\t__le32 msdu_paddr;\n\t__le32 desc_id;\n\t__le32 len;\n\t__le32 vdev_id;\n\tu8 hdr[HTT_MGMT_FRM_HDR_DOWNLOAD_LEN];\n\tunion {\n\t\tstruct htt_mgmt_tx_desc_qca99x0 qca99x0;\n\t} __packed;\n} __packed;\n\nenum htt_mgmt_tx_status {\n\tHTT_MGMT_TX_STATUS_OK    = 0,\n\tHTT_MGMT_TX_STATUS_RETRY = 1,\n\tHTT_MGMT_TX_STATUS_DROP  = 2\n};\n\n \n\nenum htt_main_t2h_msg_type {\n\tHTT_MAIN_T2H_MSG_TYPE_VERSION_CONF             = 0x0,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_IND                   = 0x1,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_FLUSH                 = 0x2,\n\tHTT_MAIN_T2H_MSG_TYPE_PEER_MAP                 = 0x3,\n\tHTT_MAIN_T2H_MSG_TYPE_PEER_UNMAP               = 0x4,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_ADDBA                 = 0x5,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_DELBA                 = 0x6,\n\tHTT_MAIN_T2H_MSG_TYPE_TX_COMPL_IND             = 0x7,\n\tHTT_MAIN_T2H_MSG_TYPE_PKTLOG                   = 0x8,\n\tHTT_MAIN_T2H_MSG_TYPE_STATS_CONF               = 0x9,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_FRAG_IND              = 0xa,\n\tHTT_MAIN_T2H_MSG_TYPE_SEC_IND                  = 0xb,\n\tHTT_MAIN_T2H_MSG_TYPE_TX_INSPECT_IND           = 0xd,\n\tHTT_MAIN_T2H_MSG_TYPE_MGMT_TX_COMPL_IND        = 0xe,\n\tHTT_MAIN_T2H_MSG_TYPE_TX_CREDIT_UPDATE_IND     = 0xf,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_PN_IND                = 0x10,\n\tHTT_MAIN_T2H_MSG_TYPE_RX_OFFLOAD_DELIVER_IND   = 0x11,\n\tHTT_MAIN_T2H_MSG_TYPE_TEST,\n\t \n\tHTT_MAIN_T2H_NUM_MSGS\n};\n\nenum htt_10x_t2h_msg_type {\n\tHTT_10X_T2H_MSG_TYPE_VERSION_CONF              = 0x0,\n\tHTT_10X_T2H_MSG_TYPE_RX_IND                    = 0x1,\n\tHTT_10X_T2H_MSG_TYPE_RX_FLUSH                  = 0x2,\n\tHTT_10X_T2H_MSG_TYPE_PEER_MAP                  = 0x3,\n\tHTT_10X_T2H_MSG_TYPE_PEER_UNMAP                = 0x4,\n\tHTT_10X_T2H_MSG_TYPE_RX_ADDBA                  = 0x5,\n\tHTT_10X_T2H_MSG_TYPE_RX_DELBA                  = 0x6,\n\tHTT_10X_T2H_MSG_TYPE_TX_COMPL_IND              = 0x7,\n\tHTT_10X_T2H_MSG_TYPE_PKTLOG                    = 0x8,\n\tHTT_10X_T2H_MSG_TYPE_STATS_CONF                = 0x9,\n\tHTT_10X_T2H_MSG_TYPE_RX_FRAG_IND               = 0xa,\n\tHTT_10X_T2H_MSG_TYPE_SEC_IND                   = 0xb,\n\tHTT_10X_T2H_MSG_TYPE_RC_UPDATE_IND             = 0xc,\n\tHTT_10X_T2H_MSG_TYPE_TX_INSPECT_IND            = 0xd,\n\tHTT_10X_T2H_MSG_TYPE_TEST                      = 0xe,\n\tHTT_10X_T2H_MSG_TYPE_CHAN_CHANGE               = 0xf,\n\tHTT_10X_T2H_MSG_TYPE_AGGR_CONF                 = 0x11,\n\tHTT_10X_T2H_MSG_TYPE_STATS_NOUPLOAD            = 0x12,\n\tHTT_10X_T2H_MSG_TYPE_MGMT_TX_COMPL_IND         = 0x13,\n\t \n\tHTT_10X_T2H_NUM_MSGS\n};\n\nenum htt_tlv_t2h_msg_type {\n\tHTT_TLV_T2H_MSG_TYPE_VERSION_CONF              = 0x0,\n\tHTT_TLV_T2H_MSG_TYPE_RX_IND                    = 0x1,\n\tHTT_TLV_T2H_MSG_TYPE_RX_FLUSH                  = 0x2,\n\tHTT_TLV_T2H_MSG_TYPE_PEER_MAP                  = 0x3,\n\tHTT_TLV_T2H_MSG_TYPE_PEER_UNMAP                = 0x4,\n\tHTT_TLV_T2H_MSG_TYPE_RX_ADDBA                  = 0x5,\n\tHTT_TLV_T2H_MSG_TYPE_RX_DELBA                  = 0x6,\n\tHTT_TLV_T2H_MSG_TYPE_TX_COMPL_IND              = 0x7,\n\tHTT_TLV_T2H_MSG_TYPE_PKTLOG                    = 0x8,\n\tHTT_TLV_T2H_MSG_TYPE_STATS_CONF                = 0x9,\n\tHTT_TLV_T2H_MSG_TYPE_RX_FRAG_IND               = 0xa,\n\tHTT_TLV_T2H_MSG_TYPE_SEC_IND                   = 0xb,\n\tHTT_TLV_T2H_MSG_TYPE_RC_UPDATE_IND             = 0xc,  \n\tHTT_TLV_T2H_MSG_TYPE_TX_INSPECT_IND            = 0xd,\n\tHTT_TLV_T2H_MSG_TYPE_MGMT_TX_COMPL_IND         = 0xe,\n\tHTT_TLV_T2H_MSG_TYPE_TX_CREDIT_UPDATE_IND      = 0xf,\n\tHTT_TLV_T2H_MSG_TYPE_RX_PN_IND                 = 0x10,\n\tHTT_TLV_T2H_MSG_TYPE_RX_OFFLOAD_DELIVER_IND    = 0x11,\n\tHTT_TLV_T2H_MSG_TYPE_RX_IN_ORD_PADDR_IND       = 0x12,\n\t \n\tHTT_TLV_T2H_MSG_TYPE_WDI_IPA_OP_RESPONSE       = 0x14,\n\tHTT_TLV_T2H_MSG_TYPE_CHAN_CHANGE               = 0x15,\n\tHTT_TLV_T2H_MSG_TYPE_RX_OFLD_PKT_ERR           = 0x16,\n\tHTT_TLV_T2H_MSG_TYPE_TEST,\n\t \n\tHTT_TLV_T2H_NUM_MSGS\n};\n\nenum htt_10_4_t2h_msg_type {\n\tHTT_10_4_T2H_MSG_TYPE_VERSION_CONF           = 0x0,\n\tHTT_10_4_T2H_MSG_TYPE_RX_IND                 = 0x1,\n\tHTT_10_4_T2H_MSG_TYPE_RX_FLUSH               = 0x2,\n\tHTT_10_4_T2H_MSG_TYPE_PEER_MAP               = 0x3,\n\tHTT_10_4_T2H_MSG_TYPE_PEER_UNMAP             = 0x4,\n\tHTT_10_4_T2H_MSG_TYPE_RX_ADDBA               = 0x5,\n\tHTT_10_4_T2H_MSG_TYPE_RX_DELBA               = 0x6,\n\tHTT_10_4_T2H_MSG_TYPE_TX_COMPL_IND           = 0x7,\n\tHTT_10_4_T2H_MSG_TYPE_PKTLOG                 = 0x8,\n\tHTT_10_4_T2H_MSG_TYPE_STATS_CONF             = 0x9,\n\tHTT_10_4_T2H_MSG_TYPE_RX_FRAG_IND            = 0xa,\n\tHTT_10_4_T2H_MSG_TYPE_SEC_IND                = 0xb,\n\tHTT_10_4_T2H_MSG_TYPE_RC_UPDATE_IND          = 0xc,\n\tHTT_10_4_T2H_MSG_TYPE_TX_INSPECT_IND         = 0xd,\n\tHTT_10_4_T2H_MSG_TYPE_MGMT_TX_COMPL_IND      = 0xe,\n\tHTT_10_4_T2H_MSG_TYPE_CHAN_CHANGE            = 0xf,\n\tHTT_10_4_T2H_MSG_TYPE_TX_CREDIT_UPDATE_IND   = 0x10,\n\tHTT_10_4_T2H_MSG_TYPE_RX_PN_IND              = 0x11,\n\tHTT_10_4_T2H_MSG_TYPE_RX_OFFLOAD_DELIVER_IND = 0x12,\n\tHTT_10_4_T2H_MSG_TYPE_TEST                   = 0x13,\n\tHTT_10_4_T2H_MSG_TYPE_EN_STATS               = 0x14,\n\tHTT_10_4_T2H_MSG_TYPE_AGGR_CONF              = 0x15,\n\tHTT_10_4_T2H_MSG_TYPE_TX_FETCH_IND           = 0x16,\n\tHTT_10_4_T2H_MSG_TYPE_TX_FETCH_CONFIRM       = 0x17,\n\tHTT_10_4_T2H_MSG_TYPE_STATS_NOUPLOAD         = 0x18,\n\t \n\tHTT_10_4_T2H_MSG_TYPE_TX_MODE_SWITCH_IND     = 0x30,\n\tHTT_10_4_T2H_MSG_TYPE_PEER_STATS\t     = 0x31,\n\t \n\tHTT_10_4_T2H_NUM_MSGS\n};\n\nenum htt_t2h_msg_type {\n\tHTT_T2H_MSG_TYPE_VERSION_CONF,\n\tHTT_T2H_MSG_TYPE_RX_IND,\n\tHTT_T2H_MSG_TYPE_RX_FLUSH,\n\tHTT_T2H_MSG_TYPE_PEER_MAP,\n\tHTT_T2H_MSG_TYPE_PEER_UNMAP,\n\tHTT_T2H_MSG_TYPE_RX_ADDBA,\n\tHTT_T2H_MSG_TYPE_RX_DELBA,\n\tHTT_T2H_MSG_TYPE_TX_COMPL_IND,\n\tHTT_T2H_MSG_TYPE_PKTLOG,\n\tHTT_T2H_MSG_TYPE_STATS_CONF,\n\tHTT_T2H_MSG_TYPE_RX_FRAG_IND,\n\tHTT_T2H_MSG_TYPE_SEC_IND,\n\tHTT_T2H_MSG_TYPE_RC_UPDATE_IND,\n\tHTT_T2H_MSG_TYPE_TX_INSPECT_IND,\n\tHTT_T2H_MSG_TYPE_MGMT_TX_COMPLETION,\n\tHTT_T2H_MSG_TYPE_TX_CREDIT_UPDATE_IND,\n\tHTT_T2H_MSG_TYPE_RX_PN_IND,\n\tHTT_T2H_MSG_TYPE_RX_OFFLOAD_DELIVER_IND,\n\tHTT_T2H_MSG_TYPE_RX_IN_ORD_PADDR_IND,\n\tHTT_T2H_MSG_TYPE_WDI_IPA_OP_RESPONSE,\n\tHTT_T2H_MSG_TYPE_CHAN_CHANGE,\n\tHTT_T2H_MSG_TYPE_RX_OFLD_PKT_ERR,\n\tHTT_T2H_MSG_TYPE_AGGR_CONF,\n\tHTT_T2H_MSG_TYPE_STATS_NOUPLOAD,\n\tHTT_T2H_MSG_TYPE_TEST,\n\tHTT_T2H_MSG_TYPE_EN_STATS,\n\tHTT_T2H_MSG_TYPE_TX_FETCH_IND,\n\tHTT_T2H_MSG_TYPE_TX_FETCH_CONFIRM,\n\tHTT_T2H_MSG_TYPE_TX_MODE_SWITCH_IND,\n\tHTT_T2H_MSG_TYPE_PEER_STATS,\n\t \n\tHTT_T2H_NUM_MSGS\n};\n\n \nstruct htt_resp_hdr {\n\tu8 msg_type;\n} __packed;\n\n#define HTT_RESP_HDR_MSG_TYPE_OFFSET 0\n#define HTT_RESP_HDR_MSG_TYPE_MASK   0xff\n#define HTT_RESP_HDR_MSG_TYPE_LSB    0\n\n \nstruct htt_ver_resp {\n\tu8 minor;\n\tu8 major;\n\tu8 rsvd0;\n} __packed;\n\n#define HTT_MGMT_TX_CMPL_FLAG_ACK_RSSI BIT(0)\n\n#define HTT_MGMT_TX_CMPL_INFO_ACK_RSSI_MASK\tGENMASK(7, 0)\n\nstruct htt_mgmt_tx_completion {\n\tu8 rsvd0;\n\tu8 rsvd1;\n\tu8 flags;\n\t__le32 desc_id;\n\t__le32 status;\n\t__le32 ppdu_id;\n\t__le32 info;\n} __packed;\n\n#define HTT_RX_INDICATION_INFO0_EXT_TID_MASK  (0x1F)\n#define HTT_RX_INDICATION_INFO0_EXT_TID_LSB   (0)\n#define HTT_RX_INDICATION_INFO0_FLUSH_VALID   (1 << 5)\n#define HTT_RX_INDICATION_INFO0_RELEASE_VALID (1 << 6)\n#define HTT_RX_INDICATION_INFO0_PPDU_DURATION BIT(7)\n\n#define HTT_RX_INDICATION_INFO1_FLUSH_START_SEQNO_MASK   0x0000003F\n#define HTT_RX_INDICATION_INFO1_FLUSH_START_SEQNO_LSB    0\n#define HTT_RX_INDICATION_INFO1_FLUSH_END_SEQNO_MASK     0x00000FC0\n#define HTT_RX_INDICATION_INFO1_FLUSH_END_SEQNO_LSB      6\n#define HTT_RX_INDICATION_INFO1_RELEASE_START_SEQNO_MASK 0x0003F000\n#define HTT_RX_INDICATION_INFO1_RELEASE_START_SEQNO_LSB  12\n#define HTT_RX_INDICATION_INFO1_RELEASE_END_SEQNO_MASK   0x00FC0000\n#define HTT_RX_INDICATION_INFO1_RELEASE_END_SEQNO_LSB    18\n#define HTT_RX_INDICATION_INFO1_NUM_MPDU_RANGES_MASK     0xFF000000\n#define HTT_RX_INDICATION_INFO1_NUM_MPDU_RANGES_LSB      24\n\n#define HTT_TX_CMPL_FLAG_DATA_RSSI\t\tBIT(0)\n#define HTT_TX_CMPL_FLAG_PPID_PRESENT\t\tBIT(1)\n#define HTT_TX_CMPL_FLAG_PA_PRESENT\t\tBIT(2)\n#define HTT_TX_CMPL_FLAG_PPDU_DURATION_PRESENT\tBIT(3)\n\n#define HTT_TX_DATA_RSSI_ENABLE_WCN3990 BIT(3)\n#define HTT_TX_DATA_APPEND_RETRIES BIT(0)\n#define HTT_TX_DATA_APPEND_TIMESTAMP BIT(1)\n\nstruct htt_rx_indication_hdr {\n\tu8 info0;  \n\t__le16 peer_id;\n\t__le32 info1;  \n} __packed;\n\n#define HTT_RX_INDICATION_INFO0_PHY_ERR_VALID    (1 << 0)\n#define HTT_RX_INDICATION_INFO0_LEGACY_RATE_MASK (0x1E)\n#define HTT_RX_INDICATION_INFO0_LEGACY_RATE_LSB  (1)\n#define HTT_RX_INDICATION_INFO0_LEGACY_RATE_CCK  (1 << 5)\n#define HTT_RX_INDICATION_INFO0_END_VALID        (1 << 6)\n#define HTT_RX_INDICATION_INFO0_START_VALID      (1 << 7)\n\n#define HTT_RX_INDICATION_INFO1_VHT_SIG_A1_MASK    0x00FFFFFF\n#define HTT_RX_INDICATION_INFO1_VHT_SIG_A1_LSB     0\n#define HTT_RX_INDICATION_INFO1_PREAMBLE_TYPE_MASK 0xFF000000\n#define HTT_RX_INDICATION_INFO1_PREAMBLE_TYPE_LSB  24\n\n#define HTT_RX_INDICATION_INFO2_VHT_SIG_A1_MASK 0x00FFFFFF\n#define HTT_RX_INDICATION_INFO2_VHT_SIG_A1_LSB  0\n#define HTT_RX_INDICATION_INFO2_SERVICE_MASK    0xFF000000\n#define HTT_RX_INDICATION_INFO2_SERVICE_LSB     24\n\nenum htt_rx_legacy_rate {\n\tHTT_RX_OFDM_48 = 0,\n\tHTT_RX_OFDM_24 = 1,\n\tHTT_RX_OFDM_12,\n\tHTT_RX_OFDM_6,\n\tHTT_RX_OFDM_54,\n\tHTT_RX_OFDM_36,\n\tHTT_RX_OFDM_18,\n\tHTT_RX_OFDM_9,\n\n\t \n\tHTT_RX_CCK_11_LP = 0,\n\tHTT_RX_CCK_5_5_LP = 1,\n\tHTT_RX_CCK_2_LP,\n\tHTT_RX_CCK_1_LP,\n\t \n\tHTT_RX_CCK_11_SP,\n\tHTT_RX_CCK_5_5_SP,\n\tHTT_RX_CCK_2_SP\n};\n\nenum htt_rx_legacy_rate_type {\n\tHTT_RX_LEGACY_RATE_OFDM = 0,\n\tHTT_RX_LEGACY_RATE_CCK\n};\n\nenum htt_rx_preamble_type {\n\tHTT_RX_LEGACY        = 0x4,\n\tHTT_RX_HT            = 0x8,\n\tHTT_RX_HT_WITH_TXBF  = 0x9,\n\tHTT_RX_VHT           = 0xC,\n\tHTT_RX_VHT_WITH_TXBF = 0xD,\n};\n\n \nstruct htt_rx_indication_ppdu {\n\tu8 combined_rssi;\n\tu8 sub_usec_timestamp;\n\tu8 phy_err_code;\n\tu8 info0;  \n\tstruct {\n\t\tu8 pri20_db;\n\t\tu8 ext20_db;\n\t\tu8 ext40_db;\n\t\tu8 ext80_db;\n\t} __packed rssi_chains[4];\n\t__le32 tsf;\n\t__le32 usec_timestamp;\n\t__le32 info1;  \n\t__le32 info2;  \n} __packed;\n\nenum htt_rx_mpdu_status {\n\tHTT_RX_IND_MPDU_STATUS_UNKNOWN = 0x0,\n\tHTT_RX_IND_MPDU_STATUS_OK,\n\tHTT_RX_IND_MPDU_STATUS_ERR_FCS,\n\tHTT_RX_IND_MPDU_STATUS_ERR_DUP,\n\tHTT_RX_IND_MPDU_STATUS_ERR_REPLAY,\n\tHTT_RX_IND_MPDU_STATUS_ERR_INV_PEER,\n\t \n\tHTT_RX_IND_MPDU_STATUS_UNAUTH_PEER,\n\tHTT_RX_IND_MPDU_STATUS_OUT_OF_SYNC,\n\t \n\tHTT_RX_IND_MPDU_STATUS_MGMT_CTRL,\n\tHTT_RX_IND_MPDU_STATUS_TKIP_MIC_ERR,\n\tHTT_RX_IND_MPDU_STATUS_DECRYPT_ERR,\n\tHTT_RX_IND_MPDU_STATUS_MPDU_LENGTH_ERR,\n\tHTT_RX_IND_MPDU_STATUS_ENCRYPT_REQUIRED_ERR,\n\tHTT_RX_IND_MPDU_STATUS_PRIVACY_ERR,\n\n\t \n\tHTT_RX_IND_MPDU_STATUS_ERR_MISC = 0xFF\n};\n\nstruct htt_rx_indication_mpdu_range {\n\tu8 mpdu_count;\n\tu8 mpdu_range_status;  \n\tu8 pad0;\n\tu8 pad1;\n} __packed;\n\nstruct htt_rx_indication_prefix {\n\t__le16 fw_rx_desc_bytes;\n\tu8 pad0;\n\tu8 pad1;\n} __packed;\n\nstruct htt_rx_indication {\n\tstruct htt_rx_indication_hdr hdr;\n\tstruct htt_rx_indication_ppdu ppdu;\n\tstruct htt_rx_indication_prefix prefix;\n\n\t \n\n\t \n\tstruct fw_rx_desc_base fw_desc;\n\n\t \n\tstruct htt_rx_indication_mpdu_range mpdu_ranges[];\n} __packed;\n\n \nstruct htt_rx_indication_hl {\n\tstruct htt_rx_indication_hdr hdr;\n\tstruct htt_rx_indication_ppdu ppdu;\n\tstruct htt_rx_indication_prefix prefix;\n\tstruct fw_rx_desc_hl fw_desc;\n\tstruct htt_rx_indication_mpdu_range mpdu_ranges[];\n} __packed;\n\nstruct htt_hl_rx_desc {\n\t__le32 info;\n\t__le32 pn_31_0;\n\tunion {\n\t\tstruct {\n\t\t\t__le16 pn_47_32;\n\t\t\t__le16 pn_63_48;\n\t\t} pn16;\n\t\t__le32 pn_63_32;\n\t} u0;\n\t__le32 pn_95_64;\n\t__le32 pn_127_96;\n} __packed;\n\nstatic inline struct htt_rx_indication_mpdu_range *\n\t\thtt_rx_ind_get_mpdu_ranges(struct htt_rx_indication *rx_ind)\n{\n\tvoid *ptr = rx_ind;\n\n\tptr += sizeof(rx_ind->hdr)\n\t     + sizeof(rx_ind->ppdu)\n\t     + sizeof(rx_ind->prefix)\n\t     + roundup(__le16_to_cpu(rx_ind->prefix.fw_rx_desc_bytes), 4);\n\treturn ptr;\n}\n\nstatic inline struct htt_rx_indication_mpdu_range *\n\thtt_rx_ind_get_mpdu_ranges_hl(struct htt_rx_indication_hl *rx_ind)\n{\n\tvoid *ptr = rx_ind;\n\n\tptr += sizeof(rx_ind->hdr)\n\t     + sizeof(rx_ind->ppdu)\n\t     + sizeof(rx_ind->prefix)\n\t     + sizeof(rx_ind->fw_desc);\n\treturn ptr;\n}\n\nenum htt_rx_flush_mpdu_status {\n\tHTT_RX_FLUSH_MPDU_DISCARD = 0,\n\tHTT_RX_FLUSH_MPDU_REORDER = 1,\n};\n\n \nstruct htt_rx_flush {\n\t__le16 peer_id;\n\tu8 tid;\n\tu8 rsvd0;\n\tu8 mpdu_status;  \n\tu8 seq_num_start;  \n\tu8 seq_num_end;  \n};\n\nstruct htt_rx_peer_map {\n\tu8 vdev_id;\n\t__le16 peer_id;\n\tu8 addr[6];\n\tu8 rsvd0;\n\tu8 rsvd1;\n} __packed;\n\nstruct htt_rx_peer_unmap {\n\tu8 rsvd0;\n\t__le16 peer_id;\n} __packed;\n\nenum htt_txrx_sec_cast_type {\n\tHTT_TXRX_SEC_MCAST = 0,\n\tHTT_TXRX_SEC_UCAST\n};\n\nenum htt_rx_pn_check_type {\n\tHTT_RX_NON_PN_CHECK = 0,\n\tHTT_RX_PN_CHECK\n};\n\nenum htt_rx_tkip_demic_type {\n\tHTT_RX_NON_TKIP_MIC = 0,\n\tHTT_RX_TKIP_MIC\n};\n\nenum htt_security_types {\n\tHTT_SECURITY_NONE,\n\tHTT_SECURITY_WEP128,\n\tHTT_SECURITY_WEP104,\n\tHTT_SECURITY_WEP40,\n\tHTT_SECURITY_TKIP,\n\tHTT_SECURITY_TKIP_NOMIC,\n\tHTT_SECURITY_AES_CCMP,\n\tHTT_SECURITY_WAPI,\n\n\tHTT_NUM_SECURITY_TYPES  \n};\n\n#define ATH10K_HTT_TXRX_PEER_SECURITY_MAX 2\n#define ATH10K_TXRX_NUM_EXT_TIDS 19\n#define ATH10K_TXRX_NON_QOS_TID 16\n\nenum htt_security_flags {\n#define HTT_SECURITY_TYPE_MASK 0x7F\n#define HTT_SECURITY_TYPE_LSB  0\n\tHTT_SECURITY_IS_UNICAST = 1 << 7\n};\n\nstruct htt_security_indication {\n\tunion {\n\t\t \n\t\tu8 flags;  \n\t\tstruct {\n\t\t\tu8 security_type:7,  \n\t\t\t   is_unicast:1;\n\t\t} __packed;\n\t} __packed;\n\t__le16 peer_id;\n\tu8 michael_key[8];\n\tu8 wapi_rsc[16];\n} __packed;\n\n#define HTT_RX_BA_INFO0_TID_MASK     0x000F\n#define HTT_RX_BA_INFO0_TID_LSB      0\n#define HTT_RX_BA_INFO0_PEER_ID_MASK 0xFFF0\n#define HTT_RX_BA_INFO0_PEER_ID_LSB  4\n\nstruct htt_rx_addba {\n\tu8 window_size;\n\t__le16 info0;  \n} __packed;\n\nstruct htt_rx_delba {\n\tu8 rsvd0;\n\t__le16 info0;  \n} __packed;\n\nenum htt_data_tx_status {\n\tHTT_DATA_TX_STATUS_OK            = 0,\n\tHTT_DATA_TX_STATUS_DISCARD       = 1,\n\tHTT_DATA_TX_STATUS_NO_ACK        = 2,\n\tHTT_DATA_TX_STATUS_POSTPONE      = 3,  \n\tHTT_DATA_TX_STATUS_DOWNLOAD_FAIL = 128\n};\n\nenum htt_data_tx_flags {\n#define HTT_DATA_TX_STATUS_MASK 0x07\n#define HTT_DATA_TX_STATUS_LSB  0\n#define HTT_DATA_TX_TID_MASK    0x78\n#define HTT_DATA_TX_TID_LSB     3\n\tHTT_DATA_TX_TID_INVALID = 1 << 7\n};\n\n#define HTT_TX_COMPL_INV_MSDU_ID 0xFFFF\n\nstruct htt_append_retries {\n\t__le16 msdu_id;\n\tu8 tx_retries;\n\tu8 flag;\n} __packed;\n\nstruct htt_data_tx_completion_ext {\n\tstruct htt_append_retries a_retries;\n\t__le32 t_stamp;\n\t__le16 msdus_rssi[];\n} __packed;\n\n \n\nstruct htt_data_tx_completion {\n\tunion {\n\t\tu8 flags;\n\t\tstruct {\n\t\t\tu8 status:3,\n\t\t\t   tid:4,\n\t\t\t   tid_invalid:1;\n\t\t} __packed;\n\t} __packed;\n\tu8 num_msdus;\n\tu8 flags2;  \n\t__le16 msdus[];  \n} __packed;\n\n#define HTT_TX_PPDU_DUR_INFO0_PEER_ID_MASK\tGENMASK(15, 0)\n#define HTT_TX_PPDU_DUR_INFO0_TID_MASK\t\tGENMASK(20, 16)\n\nstruct htt_data_tx_ppdu_dur {\n\t__le32 info0;  \n\t__le32 tx_duration;  \n} __packed;\n\n#define HTT_TX_COMPL_PPDU_DUR_INFO0_NUM_ENTRIES_MASK\tGENMASK(7, 0)\n\nstruct htt_data_tx_compl_ppdu_dur {\n\t__le32 info0;  \n\tstruct htt_data_tx_ppdu_dur ppdu_dur[];\n} __packed;\n\nstruct htt_tx_compl_ind_base {\n\tu32 hdr;\n\tu16 payload[1 ];\n} __packed;\n\nstruct htt_rc_tx_done_params {\n\tu32 rate_code;\n\tu32 rate_code_flags;\n\tu32 flags;\n\tu32 num_enqued;  \n\tu32 num_retries;\n\tu32 num_failed;  \n\tu32 ack_rssi;\n\tu32 time_stamp;\n\tu32 is_probe;\n};\n\nstruct htt_rc_update {\n\tu8 vdev_id;\n\t__le16 peer_id;\n\tu8 addr[6];\n\tu8 num_elems;\n\tu8 rsvd0;\n\tstruct htt_rc_tx_done_params params[];  \n} __packed;\n\n \nstruct htt_rx_fragment_indication {\n\tunion {\n\t\tu8 info0;  \n\t\tstruct {\n\t\t\tu8 ext_tid:5,\n\t\t\t   flush_valid:1;\n\t\t} __packed;\n\t} __packed;\n\t__le16 peer_id;\n\t__le32 info1;  \n\t__le16 fw_rx_desc_bytes;\n\t__le16 rsvd0;\n\n\tu8 fw_msdu_rx_desc[];\n} __packed;\n\n#define ATH10K_IEEE80211_EXTIV               BIT(5)\n#define ATH10K_IEEE80211_TKIP_MICLEN         8    \n\n#define HTT_RX_FRAG_IND_INFO0_HEADER_LEN     16\n\n#define HTT_RX_FRAG_IND_INFO0_EXT_TID_MASK     0x1F\n#define HTT_RX_FRAG_IND_INFO0_EXT_TID_LSB      0\n#define HTT_RX_FRAG_IND_INFO0_FLUSH_VALID_MASK 0x20\n#define HTT_RX_FRAG_IND_INFO0_FLUSH_VALID_LSB  5\n\n#define HTT_RX_FRAG_IND_INFO1_FLUSH_SEQ_NUM_START_MASK 0x0000003F\n#define HTT_RX_FRAG_IND_INFO1_FLUSH_SEQ_NUM_START_LSB  0\n#define HTT_RX_FRAG_IND_INFO1_FLUSH_SEQ_NUM_END_MASK   0x00000FC0\n#define HTT_RX_FRAG_IND_INFO1_FLUSH_SEQ_NUM_END_LSB    6\n\nstruct htt_rx_pn_ind {\n\t__le16 peer_id;\n\tu8 tid;\n\tu8 seqno_start;\n\tu8 seqno_end;\n\tu8 pn_ie_count;\n\tu8 reserved;\n\tu8 pn_ies[];\n} __packed;\n\nstruct htt_rx_offload_msdu {\n\t__le16 msdu_len;\n\t__le16 peer_id;\n\tu8 vdev_id;\n\tu8 tid;\n\tu8 fw_desc;\n\tu8 payload[];\n} __packed;\n\nstruct htt_rx_offload_ind {\n\tu8 reserved;\n\t__le16 msdu_count;\n} __packed;\n\nstruct htt_rx_in_ord_msdu_desc {\n\t__le32 msdu_paddr;\n\t__le16 msdu_len;\n\tu8 fw_desc;\n\tu8 reserved;\n} __packed;\n\nstruct htt_rx_in_ord_msdu_desc_ext {\n\t__le64 msdu_paddr;\n\t__le16 msdu_len;\n\tu8 fw_desc;\n\tu8 reserved;\n} __packed;\n\nstruct htt_rx_in_ord_ind {\n\tu8 info;\n\t__le16 peer_id;\n\tu8 vdev_id;\n\tu8 reserved;\n\t__le16 msdu_count;\n\tunion {\n\t\tDECLARE_FLEX_ARRAY(struct htt_rx_in_ord_msdu_desc,\n\t\t\t\t   msdu_descs32);\n\t\tDECLARE_FLEX_ARRAY(struct htt_rx_in_ord_msdu_desc_ext,\n\t\t\t\t   msdu_descs64);\n\t} __packed;\n} __packed;\n\n#define HTT_RX_IN_ORD_IND_INFO_TID_MASK\t\t0x0000001f\n#define HTT_RX_IN_ORD_IND_INFO_TID_LSB\t\t0\n#define HTT_RX_IN_ORD_IND_INFO_OFFLOAD_MASK\t0x00000020\n#define HTT_RX_IN_ORD_IND_INFO_OFFLOAD_LSB\t5\n#define HTT_RX_IN_ORD_IND_INFO_FRAG_MASK\t0x00000040\n#define HTT_RX_IN_ORD_IND_INFO_FRAG_LSB\t\t6\n\n \nstruct htt_rx_test {\n\tu8 num_ints;\n\t__le16 num_chars;\n\n\t \n\tu8 payload[];\n} __packed;\n\nstatic inline __le32 *htt_rx_test_get_ints(struct htt_rx_test *rx_test)\n{\n\treturn (__le32 *)rx_test->payload;\n}\n\nstatic inline u8 *htt_rx_test_get_chars(struct htt_rx_test *rx_test)\n{\n\treturn rx_test->payload + (rx_test->num_ints * sizeof(__le32));\n}\n\n \nstruct htt_pktlog_msg {\n\tu8 pad[3];\n\tu8 payload[];\n} __packed;\n\nstruct htt_dbg_stats_rx_reorder_stats {\n\t \n\t__le32 deliver_non_qos;\n\n\t \n\t__le32 deliver_in_order;\n\n\t \n\t__le32 deliver_flush_timeout;\n\n\t \n\t__le32 deliver_flush_oow;\n\n\t \n\t__le32 deliver_flush_delba;\n\n\t \n\t__le32 fcs_error;\n\n\t \n\t__le32 mgmt_ctrl;\n\n\t \n\t__le32 invalid_peer;\n\n\t \n\t__le32 dup_non_aggr;\n\n\t \n\t__le32 dup_past;\n\n\t \n\t__le32 dup_in_reorder;\n\n\t \n\t__le32 reorder_timeout;\n\n\t \n\t__le32 invalid_bar_ssn;\n\n\t \n\t__le32 ssn_reset;\n};\n\nstruct htt_dbg_stats_wal_tx_stats {\n\t \n\t__le32 comp_queued;\n\n\t \n\t__le32 comp_delivered;\n\n\t \n\t__le32 msdu_enqued;\n\n\t \n\t__le32 mpdu_enqued;\n\n\t \n\t__le32 wmm_drop;\n\n\t \n\t__le32 local_enqued;\n\n\t \n\t__le32 local_freed;\n\n\t \n\t__le32 hw_queued;\n\n\t \n\t__le32 hw_reaped;\n\n\t \n\t__le32 underrun;\n\n\t \n\t__le32 tx_abort;\n\n\t \n\t__le32 mpdus_requeued;\n\n\t \n\t__le32 tx_ko;\n\n\t \n\t__le32 data_rc;\n\n\t \n\t__le32 self_triggers;\n\n\t \n\t__le32 sw_retry_failure;\n\n\t \n\t__le32 illgl_rate_phy_err;\n\n\t \n\t__le32 pdev_cont_xretry;\n\n\t \n\t__le32 pdev_tx_timeout;\n\n\t \n\t__le32 pdev_resets;\n\n\t__le32 phy_underrun;\n\n\t \n\t__le32 txop_ovf;\n} __packed;\n\nstruct htt_dbg_stats_wal_rx_stats {\n\t \n\t__le32 mid_ppdu_route_change;\n\n\t \n\t__le32 status_rcvd;\n\n\t \n\t__le32 r0_frags;\n\t__le32 r1_frags;\n\t__le32 r2_frags;\n\t__le32 r3_frags;\n\n\t \n\t__le32 htt_msdus;\n\t__le32 htt_mpdus;\n\n\t \n\t__le32 loc_msdus;\n\t__le32 loc_mpdus;\n\n\t \n\t__le32 oversize_amsdu;\n\n\t \n\t__le32 phy_errs;\n\n\t \n\t__le32 phy_err_drop;\n\n\t \n\t__le32 mpdu_errs;\n} __packed;\n\nstruct htt_dbg_stats_wal_peer_stats {\n\t__le32 dummy;  \n} __packed;\n\nstruct htt_dbg_stats_wal_pdev_txrx {\n\tstruct htt_dbg_stats_wal_tx_stats tx_stats;\n\tstruct htt_dbg_stats_wal_rx_stats rx_stats;\n\tstruct htt_dbg_stats_wal_peer_stats peer_stats;\n} __packed;\n\nstruct htt_dbg_stats_rx_rate_info {\n\t__le32 mcs[10];\n\t__le32 sgi[10];\n\t__le32 nss[4];\n\t__le32 stbc[10];\n\t__le32 bw[3];\n\t__le32 pream[6];\n\t__le32 ldpc;\n\t__le32 txbf;\n};\n\n \nenum htt_dbg_stats_status {\n\tHTT_DBG_STATS_STATUS_PRESENT     = 0,\n\tHTT_DBG_STATS_STATUS_PARTIAL     = 1,\n\tHTT_DBG_STATS_STATUS_ERROR       = 2,\n\tHTT_DBG_STATS_STATUS_INVALID     = 3,\n\tHTT_DBG_STATS_STATUS_SERIES_DONE = 7\n};\n\n \nstruct htt_frag_desc_bank_id {\n\t__le16 bank_min_id;\n\t__le16 bank_max_id;\n} __packed;\n\n \n#define HTT_FRAG_DESC_BANK_MAX 4\n\n#define HTT_FRAG_DESC_BANK_CFG_INFO_PDEV_ID_MASK\t\t0x03\n#define HTT_FRAG_DESC_BANK_CFG_INFO_PDEV_ID_LSB\t\t\t0\n#define HTT_FRAG_DESC_BANK_CFG_INFO_SWAP\t\t\tBIT(2)\n#define HTT_FRAG_DESC_BANK_CFG_INFO_Q_STATE_VALID\t\tBIT(3)\n#define HTT_FRAG_DESC_BANK_CFG_INFO_Q_STATE_DEPTH_TYPE_MASK\tBIT(4)\n#define HTT_FRAG_DESC_BANK_CFG_INFO_Q_STATE_DEPTH_TYPE_LSB\t4\n\nenum htt_q_depth_type {\n\tHTT_Q_DEPTH_TYPE_BYTES = 0,\n\tHTT_Q_DEPTH_TYPE_MSDUS = 1,\n};\n\n#define HTT_TX_Q_STATE_NUM_PEERS\t\t(TARGET_10_4_NUM_QCACHE_PEERS_MAX + \\\n\t\t\t\t\t\t TARGET_10_4_NUM_VDEVS)\n#define HTT_TX_Q_STATE_NUM_TIDS\t\t\t8\n#define HTT_TX_Q_STATE_ENTRY_SIZE\t\t1\n#define HTT_TX_Q_STATE_ENTRY_MULTIPLIER\t\t0\n\n \nstruct htt_q_state_conf {\n\t__le32 paddr;\n\t__le16 num_peers;\n\t__le16 num_tids;\n\tu8 record_size;\n\tu8 record_multiplier;\n\tu8 pad[2];\n} __packed;\n\nstruct htt_frag_desc_bank_cfg32 {\n\tu8 info;  \n\tu8 num_banks;\n\tu8 desc_size;\n\t__le32 bank_base_addrs[HTT_FRAG_DESC_BANK_MAX];\n\tstruct htt_frag_desc_bank_id bank_id[HTT_FRAG_DESC_BANK_MAX];\n\tstruct htt_q_state_conf q_state;\n} __packed;\n\nstruct htt_frag_desc_bank_cfg64 {\n\tu8 info;  \n\tu8 num_banks;\n\tu8 desc_size;\n\t__le64 bank_base_addrs[HTT_FRAG_DESC_BANK_MAX];\n\tstruct htt_frag_desc_bank_id bank_id[HTT_FRAG_DESC_BANK_MAX];\n\tstruct htt_q_state_conf q_state;\n} __packed;\n\n#define HTT_TX_Q_STATE_ENTRY_COEFFICIENT\t128\n#define HTT_TX_Q_STATE_ENTRY_FACTOR_MASK\t0x3f\n#define HTT_TX_Q_STATE_ENTRY_FACTOR_LSB\t\t0\n#define HTT_TX_Q_STATE_ENTRY_EXP_MASK\t\t0xc0\n#define HTT_TX_Q_STATE_ENTRY_EXP_LSB\t\t6\n\n \nstruct htt_q_state {\n\tu8 count[HTT_TX_Q_STATE_NUM_TIDS][HTT_TX_Q_STATE_NUM_PEERS];\n\tu32 map[HTT_TX_Q_STATE_NUM_TIDS][(HTT_TX_Q_STATE_NUM_PEERS + 31) / 32];\n\t__le32 seq;\n} __packed;\n\n#define HTT_TX_FETCH_RECORD_INFO_PEER_ID_MASK\t0x0fff\n#define HTT_TX_FETCH_RECORD_INFO_PEER_ID_LSB\t0\n#define HTT_TX_FETCH_RECORD_INFO_TID_MASK\t0xf000\n#define HTT_TX_FETCH_RECORD_INFO_TID_LSB\t12\n\nstruct htt_tx_fetch_record {\n\t__le16 info;  \n\t__le16 num_msdus;\n\t__le32 num_bytes;\n} __packed;\n\nstruct htt_tx_fetch_ind {\n\tu8 pad0;\n\t__le16 fetch_seq_num;\n\t__le32 token;\n\t__le16 num_resp_ids;\n\t__le16 num_records;\n\tunion {\n\t\t \n\t\tDECLARE_FLEX_ARRAY(__le32, resp_ids);\n\t\tDECLARE_FLEX_ARRAY(struct htt_tx_fetch_record, records);\n\t} __packed;\n} __packed;\n\nstatic inline void *\nath10k_htt_get_tx_fetch_ind_resp_ids(struct htt_tx_fetch_ind *ind)\n{\n\treturn (void *)&ind->records[le16_to_cpu(ind->num_records)];\n}\n\nstruct htt_tx_fetch_resp {\n\tu8 pad0;\n\t__le16 resp_id;\n\t__le16 fetch_seq_num;\n\t__le16 num_records;\n\t__le32 token;\n\tstruct htt_tx_fetch_record records[];\n} __packed;\n\nstruct htt_tx_fetch_confirm {\n\tu8 pad0;\n\t__le16 num_resp_ids;\n\t__le32 resp_ids[];\n} __packed;\n\nenum htt_tx_mode_switch_mode {\n\tHTT_TX_MODE_SWITCH_PUSH = 0,\n\tHTT_TX_MODE_SWITCH_PUSH_PULL = 1,\n};\n\n#define HTT_TX_MODE_SWITCH_IND_INFO0_ENABLE\t\tBIT(0)\n#define HTT_TX_MODE_SWITCH_IND_INFO0_NUM_RECORDS_MASK\t0xfffe\n#define HTT_TX_MODE_SWITCH_IND_INFO0_NUM_RECORDS_LSB\t1\n\n#define HTT_TX_MODE_SWITCH_IND_INFO1_MODE_MASK\t\t0x0003\n#define HTT_TX_MODE_SWITCH_IND_INFO1_MODE_LSB\t\t0\n#define HTT_TX_MODE_SWITCH_IND_INFO1_THRESHOLD_MASK\t0xfffc\n#define HTT_TX_MODE_SWITCH_IND_INFO1_THRESHOLD_LSB\t2\n\n#define HTT_TX_MODE_SWITCH_RECORD_INFO0_PEER_ID_MASK\t0x0fff\n#define HTT_TX_MODE_SWITCH_RECORD_INFO0_PEER_ID_LSB\t0\n#define HTT_TX_MODE_SWITCH_RECORD_INFO0_TID_MASK\t0xf000\n#define HTT_TX_MODE_SWITCH_RECORD_INFO0_TID_LSB\t\t12\n\nstruct htt_tx_mode_switch_record {\n\t__le16 info0;  \n\t__le16 num_max_msdus;\n} __packed;\n\nstruct htt_tx_mode_switch_ind {\n\tu8 pad0;\n\t__le16 info0;  \n\t__le16 info1;  \n\tu8 pad1[2];\n\tstruct htt_tx_mode_switch_record records[];\n} __packed;\n\nstruct htt_channel_change {\n\tu8 pad[3];\n\t__le32 freq;\n\t__le32 center_freq1;\n\t__le32 center_freq2;\n\t__le32 phymode;\n} __packed;\n\nstruct htt_per_peer_tx_stats_ind {\n\t__le32\tsucc_bytes;\n\t__le32  retry_bytes;\n\t__le32  failed_bytes;\n\tu8\tratecode;\n\tu8\tflags;\n\t__le16\tpeer_id;\n\t__le16  succ_pkts;\n\t__le16\tretry_pkts;\n\t__le16\tfailed_pkts;\n\t__le16\ttx_duration;\n\t__le32\treserved1;\n\t__le32\treserved2;\n} __packed;\n\nstruct htt_peer_tx_stats {\n\tu8 num_ppdu;\n\tu8 ppdu_len;\n\tu8 version;\n\tu8 payload[];\n} __packed;\n\n#define ATH10K_10_2_TX_STATS_OFFSET\t136\n#define PEER_STATS_FOR_NO_OF_PPDUS\t4\n\nstruct ath10k_10_2_peer_tx_stats {\n\tu8 ratecode[PEER_STATS_FOR_NO_OF_PPDUS];\n\tu8 success_pkts[PEER_STATS_FOR_NO_OF_PPDUS];\n\t__le16 success_bytes[PEER_STATS_FOR_NO_OF_PPDUS];\n\tu8 retry_pkts[PEER_STATS_FOR_NO_OF_PPDUS];\n\t__le16 retry_bytes[PEER_STATS_FOR_NO_OF_PPDUS];\n\tu8 failed_pkts[PEER_STATS_FOR_NO_OF_PPDUS];\n\t__le16 failed_bytes[PEER_STATS_FOR_NO_OF_PPDUS];\n\tu8 flags[PEER_STATS_FOR_NO_OF_PPDUS];\n\t__le32 tx_duration;\n\tu8 tx_ppdu_cnt;\n\tu8 peer_id;\n} __packed;\n\nunion htt_rx_pn_t {\n\t \n\tu32 pn24;\n\n\t \n\tu64 pn48;\n\n\t \n\tu64 pn128[2];\n};\n\nstruct htt_cmd {\n\tstruct htt_cmd_hdr hdr;\n\tunion {\n\t\tstruct htt_ver_req ver_req;\n\t\tstruct htt_mgmt_tx_desc mgmt_tx;\n\t\tstruct htt_data_tx_desc data_tx;\n\t\tstruct htt_rx_ring_setup_32 rx_setup_32;\n\t\tstruct htt_rx_ring_setup_64 rx_setup_64;\n\t\tstruct htt_stats_req stats_req;\n\t\tstruct htt_oob_sync_req oob_sync_req;\n\t\tstruct htt_aggr_conf aggr_conf;\n\t\tstruct htt_aggr_conf_v2 aggr_conf_v2;\n\t\tstruct htt_frag_desc_bank_cfg32 frag_desc_bank_cfg32;\n\t\tstruct htt_frag_desc_bank_cfg64 frag_desc_bank_cfg64;\n\t\tstruct htt_tx_fetch_resp tx_fetch_resp;\n\t};\n} __packed;\n\nstruct htt_resp {\n\tstruct htt_resp_hdr hdr;\n\tunion {\n\t\tstruct htt_ver_resp ver_resp;\n\t\tstruct htt_mgmt_tx_completion mgmt_tx_completion;\n\t\tstruct htt_data_tx_completion data_tx_completion;\n\t\tstruct htt_rx_indication rx_ind;\n\t\tstruct htt_rx_indication_hl rx_ind_hl;\n\t\tstruct htt_rx_fragment_indication rx_frag_ind;\n\t\tstruct htt_rx_peer_map peer_map;\n\t\tstruct htt_rx_peer_unmap peer_unmap;\n\t\tstruct htt_rx_flush rx_flush;\n\t\tstruct htt_rx_addba rx_addba;\n\t\tstruct htt_rx_delba rx_delba;\n\t\tstruct htt_security_indication security_indication;\n\t\tstruct htt_rc_update rc_update;\n\t\tstruct htt_rx_test rx_test;\n\t\tstruct htt_pktlog_msg pktlog_msg;\n\t\tstruct htt_rx_pn_ind rx_pn_ind;\n\t\tstruct htt_rx_offload_ind rx_offload_ind;\n\t\tstruct htt_rx_in_ord_ind rx_in_ord_ind;\n\t\tstruct htt_tx_fetch_ind tx_fetch_ind;\n\t\tstruct htt_tx_fetch_confirm tx_fetch_confirm;\n\t\tstruct htt_tx_mode_switch_ind tx_mode_switch_ind;\n\t\tstruct htt_channel_change chan_change;\n\t\tstruct htt_peer_tx_stats peer_tx_stats;\n\t} __packed;\n} __packed;\n\n \n\nstruct htt_tx_done {\n\tu16 msdu_id;\n\tu16 status;\n\tu8 ack_rssi;\n};\n\nenum htt_tx_compl_state {\n\tHTT_TX_COMPL_STATE_NONE,\n\tHTT_TX_COMPL_STATE_ACK,\n\tHTT_TX_COMPL_STATE_NOACK,\n\tHTT_TX_COMPL_STATE_DISCARD,\n};\n\nstruct htt_peer_map_event {\n\tu8 vdev_id;\n\tu16 peer_id;\n\tu8 addr[ETH_ALEN];\n};\n\nstruct htt_peer_unmap_event {\n\tu16 peer_id;\n};\n\nstruct ath10k_htt_txbuf_32 {\n\tstruct htt_data_tx_desc_frag frags[2];\n\tstruct ath10k_htc_hdr htc_hdr;\n\tstruct htt_cmd_hdr cmd_hdr;\n\tstruct htt_data_tx_desc cmd_tx;\n} __packed __aligned(4);\n\nstruct ath10k_htt_txbuf_64 {\n\tstruct htt_data_tx_desc_frag frags[2];\n\tstruct ath10k_htc_hdr htc_hdr;\n\tstruct htt_cmd_hdr cmd_hdr;\n\tstruct htt_data_tx_desc_64 cmd_tx;\n} __packed __aligned(4);\n\nstruct ath10k_htt {\n\tstruct ath10k *ar;\n\tenum ath10k_htc_ep_id eid;\n\n\tstruct sk_buff_head rx_indication_head;\n\n\tu8 target_version_major;\n\tu8 target_version_minor;\n\tstruct completion target_version_received;\n\tu8 max_num_amsdu;\n\tu8 max_num_ampdu;\n\n\tconst enum htt_t2h_msg_type *t2h_msg_types;\n\tu32 t2h_msg_types_max;\n\n\tstruct {\n\t\t \n\t\tstruct sk_buff **netbufs_ring;\n\n\t\t \n\t\tbool in_ord_rx;\n\t\tDECLARE_HASHTABLE(skb_table, 4);\n\n\t\t \n\t\tunion {\n\t\t\t__le64 *paddrs_ring_64;\n\t\t\t__le32 *paddrs_ring_32;\n\t\t};\n\n\t\t \n\t\tdma_addr_t base_paddr;\n\n\t\t \n\t\tint size;\n\n\t\t \n\t\tunsigned int size_mask;\n\n\t\t \n\t\tint fill_level;\n\n\t\t \n\t\tint fill_cnt;\n\n\t\t \n\t\tstruct {\n\t\t\t__le32 *vaddr;\n\t\t\tdma_addr_t paddr;\n\t\t} alloc_idx;\n\n\t\t \n\t\tstruct {\n\t\t\tunsigned int msdu_payld;\n\t\t} sw_rd_idx;\n\n\t\t \n\t\tstruct timer_list refill_retry_timer;\n\n\t\t \n\t\tspinlock_t lock;\n\t} rx_ring;\n\n\tunsigned int prefetch_len;\n\n\t \n\tspinlock_t tx_lock;\n\tint max_num_pending_tx;\n\tint num_pending_tx;\n\tint num_pending_mgmt_tx;\n\tstruct idr pending_tx;\n\twait_queue_head_t empty_tx_wq;\n\n\t \n\tDECLARE_KFIFO_PTR(txdone_fifo, struct htt_tx_done);\n\n\t \n\tbool rx_confused;\n\tatomic_t num_mpdus_ready;\n\n\t \n\tstruct sk_buff_head rx_msdus_q;\n\tstruct sk_buff_head rx_in_ord_compl_q;\n\tstruct sk_buff_head tx_fetch_ind_q;\n\n\t \n\tstruct ieee80211_rx_status rx_status;\n\n\tstruct {\n\t\tdma_addr_t paddr;\n\t\tunion {\n\t\t\tstruct htt_msdu_ext_desc *vaddr_desc_32;\n\t\t\tstruct htt_msdu_ext_desc_64 *vaddr_desc_64;\n\t\t};\n\t\tsize_t size;\n\t} frag_desc;\n\n\tstruct {\n\t\tdma_addr_t paddr;\n\t\tunion {\n\t\t\tstruct ath10k_htt_txbuf_32 *vaddr_txbuff_32;\n\t\t\tstruct ath10k_htt_txbuf_64 *vaddr_txbuff_64;\n\t\t};\n\t\tsize_t size;\n\t} txbuf;\n\n\tstruct {\n\t\tbool enabled;\n\t\tstruct htt_q_state *vaddr;\n\t\tdma_addr_t paddr;\n\t\tu16 num_push_allowed;\n\t\tu16 num_peers;\n\t\tu16 num_tids;\n\t\tenum htt_tx_mode_switch_mode mode;\n\t\tenum htt_q_depth_type type;\n\t} tx_q_state;\n\n\tbool tx_mem_allocated;\n\tconst struct ath10k_htt_tx_ops *tx_ops;\n\tconst struct ath10k_htt_rx_ops *rx_ops;\n\tbool disable_tx_comp;\n\tbool bundle_tx;\n\tstruct sk_buff_head tx_req_head;\n\tstruct sk_buff_head tx_complete_head;\n};\n\nstruct ath10k_htt_tx_ops {\n\tint (*htt_send_rx_ring_cfg)(struct ath10k_htt *htt);\n\tint (*htt_send_frag_desc_bank_cfg)(struct ath10k_htt *htt);\n\tint (*htt_alloc_frag_desc)(struct ath10k_htt *htt);\n\tvoid (*htt_free_frag_desc)(struct ath10k_htt *htt);\n\tint (*htt_tx)(struct ath10k_htt *htt, enum ath10k_hw_txrx_mode txmode,\n\t\t      struct sk_buff *msdu);\n\tint (*htt_alloc_txbuff)(struct ath10k_htt *htt);\n\tvoid (*htt_free_txbuff)(struct ath10k_htt *htt);\n\tint (*htt_h2t_aggr_cfg_msg)(struct ath10k_htt *htt,\n\t\t\t\t    u8 max_subfrms_ampdu,\n\t\t\t\t    u8 max_subfrms_amsdu);\n\tvoid (*htt_flush_tx)(struct ath10k_htt *htt);\n};\n\nstatic inline int ath10k_htt_send_rx_ring_cfg(struct ath10k_htt *htt)\n{\n\tif (!htt->tx_ops->htt_send_rx_ring_cfg)\n\t\treturn -EOPNOTSUPP;\n\n\treturn htt->tx_ops->htt_send_rx_ring_cfg(htt);\n}\n\nstatic inline int ath10k_htt_send_frag_desc_bank_cfg(struct ath10k_htt *htt)\n{\n\tif (!htt->tx_ops->htt_send_frag_desc_bank_cfg)\n\t\treturn -EOPNOTSUPP;\n\n\treturn htt->tx_ops->htt_send_frag_desc_bank_cfg(htt);\n}\n\nstatic inline int ath10k_htt_alloc_frag_desc(struct ath10k_htt *htt)\n{\n\tif (!htt->tx_ops->htt_alloc_frag_desc)\n\t\treturn -EOPNOTSUPP;\n\n\treturn htt->tx_ops->htt_alloc_frag_desc(htt);\n}\n\nstatic inline void ath10k_htt_free_frag_desc(struct ath10k_htt *htt)\n{\n\tif (htt->tx_ops->htt_free_frag_desc)\n\t\thtt->tx_ops->htt_free_frag_desc(htt);\n}\n\nstatic inline int ath10k_htt_tx(struct ath10k_htt *htt,\n\t\t\t\tenum ath10k_hw_txrx_mode txmode,\n\t\t\t\tstruct sk_buff *msdu)\n{\n\treturn htt->tx_ops->htt_tx(htt, txmode, msdu);\n}\n\nstatic inline void ath10k_htt_flush_tx(struct ath10k_htt *htt)\n{\n\tif (htt->tx_ops->htt_flush_tx)\n\t\thtt->tx_ops->htt_flush_tx(htt);\n}\n\nstatic inline int ath10k_htt_alloc_txbuff(struct ath10k_htt *htt)\n{\n\tif (!htt->tx_ops->htt_alloc_txbuff)\n\t\treturn -EOPNOTSUPP;\n\n\treturn htt->tx_ops->htt_alloc_txbuff(htt);\n}\n\nstatic inline void ath10k_htt_free_txbuff(struct ath10k_htt *htt)\n{\n\tif (htt->tx_ops->htt_free_txbuff)\n\t\thtt->tx_ops->htt_free_txbuff(htt);\n}\n\nstatic inline int ath10k_htt_h2t_aggr_cfg_msg(struct ath10k_htt *htt,\n\t\t\t\t\t      u8 max_subfrms_ampdu,\n\t\t\t\t\t      u8 max_subfrms_amsdu)\n\n{\n\tif (!htt->tx_ops->htt_h2t_aggr_cfg_msg)\n\t\treturn -EOPNOTSUPP;\n\n\treturn htt->tx_ops->htt_h2t_aggr_cfg_msg(htt,\n\t\t\t\t\t\t max_subfrms_ampdu,\n\t\t\t\t\t\t max_subfrms_amsdu);\n}\n\nstruct ath10k_htt_rx_ops {\n\tsize_t (*htt_get_rx_ring_size)(struct ath10k_htt *htt);\n\tvoid (*htt_config_paddrs_ring)(struct ath10k_htt *htt, void *vaddr);\n\tvoid (*htt_set_paddrs_ring)(struct ath10k_htt *htt, dma_addr_t paddr,\n\t\t\t\t    int idx);\n\tvoid* (*htt_get_vaddr_ring)(struct ath10k_htt *htt);\n\tvoid (*htt_reset_paddrs_ring)(struct ath10k_htt *htt, int idx);\n\tbool (*htt_rx_proc_rx_frag_ind)(struct ath10k_htt *htt,\n\t\t\t\t\tstruct htt_rx_fragment_indication *rx,\n\t\t\t\t\tstruct sk_buff *skb);\n};\n\nstatic inline size_t ath10k_htt_get_rx_ring_size(struct ath10k_htt *htt)\n{\n\tif (!htt->rx_ops->htt_get_rx_ring_size)\n\t\treturn 0;\n\n\treturn htt->rx_ops->htt_get_rx_ring_size(htt);\n}\n\nstatic inline void ath10k_htt_config_paddrs_ring(struct ath10k_htt *htt,\n\t\t\t\t\t\t void *vaddr)\n{\n\tif (htt->rx_ops->htt_config_paddrs_ring)\n\t\thtt->rx_ops->htt_config_paddrs_ring(htt, vaddr);\n}\n\nstatic inline void ath10k_htt_set_paddrs_ring(struct ath10k_htt *htt,\n\t\t\t\t\t      dma_addr_t paddr,\n\t\t\t\t\t      int idx)\n{\n\tif (htt->rx_ops->htt_set_paddrs_ring)\n\t\thtt->rx_ops->htt_set_paddrs_ring(htt, paddr, idx);\n}\n\nstatic inline void *ath10k_htt_get_vaddr_ring(struct ath10k_htt *htt)\n{\n\tif (!htt->rx_ops->htt_get_vaddr_ring)\n\t\treturn NULL;\n\n\treturn htt->rx_ops->htt_get_vaddr_ring(htt);\n}\n\nstatic inline void ath10k_htt_reset_paddrs_ring(struct ath10k_htt *htt, int idx)\n{\n\tif (htt->rx_ops->htt_reset_paddrs_ring)\n\t\thtt->rx_ops->htt_reset_paddrs_ring(htt, idx);\n}\n\nstatic inline bool ath10k_htt_rx_proc_rx_frag_ind(struct ath10k_htt *htt,\n\t\t\t\t\t\t  struct htt_rx_fragment_indication *rx,\n\t\t\t\t\t\t  struct sk_buff *skb)\n{\n\tif (!htt->rx_ops->htt_rx_proc_rx_frag_ind)\n\t\treturn true;\n\n\treturn htt->rx_ops->htt_rx_proc_rx_frag_ind(htt, rx, skb);\n}\n\n \n#define RX_HTT_HDR_STATUS_LEN 64\n\n \n\n \nstruct htt_rx_desc {\n\tunion {\n\t\t \n\t\tstruct fw_rx_desc_base fw_desc;\n\t\tu32 pad;\n\t} __packed;\n} __packed;\n\n \nstruct htt_rx_desc_v2 {\n\tstruct htt_rx_desc base;\n\tstruct {\n\t\tstruct rx_attention attention;\n\t\tstruct rx_frag_info frag_info;\n\t\tstruct rx_mpdu_start mpdu_start;\n\t\tstruct rx_msdu_start msdu_start;\n\t\tstruct rx_msdu_end msdu_end;\n\t\tstruct rx_mpdu_end mpdu_end;\n\t\tstruct rx_ppdu_start ppdu_start;\n\t\tstruct rx_ppdu_end ppdu_end;\n\t} __packed;\n\tu8 rx_hdr_status[RX_HTT_HDR_STATUS_LEN];\n\tu8 msdu_payload[];\n};\n\n \nstruct htt_rx_desc_v1 {\n\tstruct htt_rx_desc base;\n\tstruct {\n\t\tstruct rx_attention attention;\n\t\tstruct rx_frag_info_v1 frag_info;\n\t\tstruct rx_mpdu_start mpdu_start;\n\t\tstruct rx_msdu_start_v1 msdu_start;\n\t\tstruct rx_msdu_end_v1 msdu_end;\n\t\tstruct rx_mpdu_end mpdu_end;\n\t\tstruct rx_ppdu_start ppdu_start;\n\t\tstruct rx_ppdu_end_v1 ppdu_end;\n\t} __packed;\n\tu8 rx_hdr_status[RX_HTT_HDR_STATUS_LEN];\n\tu8 msdu_payload[];\n};\n\n \nstruct ath10k_htt_rx_desc_ops {\n\t \n\n\t \n\tsize_t rx_desc_size;\n\n\t \n\tsize_t rx_desc_msdu_payload_offset;\n\n\t \n\tbool (*rx_desc_get_msdu_limit_error)(struct htt_rx_desc *rxd);\n\tint (*rx_desc_get_l3_pad_bytes)(struct htt_rx_desc *rxd);\n\n\t \n\tstruct htt_rx_desc *(*rx_desc_from_raw_buffer)(void *buff);\n\n\tvoid (*rx_desc_get_offsets)(struct htt_rx_ring_rx_desc_offsets *offs);\n\tstruct rx_attention *(*rx_desc_get_attention)(struct htt_rx_desc *rxd);\n\tstruct rx_frag_info_common *(*rx_desc_get_frag_info)(struct htt_rx_desc *rxd);\n\tstruct rx_mpdu_start *(*rx_desc_get_mpdu_start)(struct htt_rx_desc *rxd);\n\tstruct rx_mpdu_end *(*rx_desc_get_mpdu_end)(struct htt_rx_desc *rxd);\n\tstruct rx_msdu_start_common *(*rx_desc_get_msdu_start)(struct htt_rx_desc *rxd);\n\tstruct rx_msdu_end_common *(*rx_desc_get_msdu_end)(struct htt_rx_desc *rxd);\n\tstruct rx_ppdu_start *(*rx_desc_get_ppdu_start)(struct htt_rx_desc *rxd);\n\tstruct rx_ppdu_end_common *(*rx_desc_get_ppdu_end)(struct htt_rx_desc *rxd);\n\tu8 *(*rx_desc_get_rx_hdr_status)(struct htt_rx_desc *rxd);\n\tu8 *(*rx_desc_get_msdu_payload)(struct htt_rx_desc *rxd);\n};\n\nextern const struct ath10k_htt_rx_desc_ops qca988x_rx_desc_ops;\nextern const struct ath10k_htt_rx_desc_ops qca99x0_rx_desc_ops;\nextern const struct ath10k_htt_rx_desc_ops wcn3990_rx_desc_ops;\n\nstatic inline int\nath10k_htt_rx_desc_get_l3_pad_bytes(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tif (hw->rx_desc_ops->rx_desc_get_l3_pad_bytes)\n\t\treturn hw->rx_desc_ops->rx_desc_get_l3_pad_bytes(rxd);\n\treturn 0;\n}\n\nstatic inline bool\nath10k_htt_rx_desc_msdu_limit_error(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tif (hw->rx_desc_ops->rx_desc_get_msdu_limit_error)\n\t\treturn hw->rx_desc_ops->rx_desc_get_msdu_limit_error(rxd);\n\treturn false;\n}\n\n \nstatic inline struct htt_rx_desc *\nath10k_htt_rx_desc_from_raw_buffer(struct ath10k_hw_params *hw,\tvoid *buff)\n{\n\tif (hw->rx_desc_ops->rx_desc_from_raw_buffer)\n\t\treturn hw->rx_desc_ops->rx_desc_from_raw_buffer(buff);\n\treturn &((struct htt_rx_desc_v1 *)buff)->base;\n}\n\nstatic inline void\nath10k_htt_rx_desc_get_offsets(struct ath10k_hw_params *hw,\n\t\t\t       struct htt_rx_ring_rx_desc_offsets *off)\n{\n\tif (hw->rx_desc_ops->rx_desc_get_offsets) {\n\t\thw->rx_desc_ops->rx_desc_get_offsets(off);\n\t} else {\n#define\tdesc_offset(x) (offsetof(struct\thtt_rx_desc_v1, x)\t/ 4)\n\t\toff->mac80211_hdr_offset = __cpu_to_le16(desc_offset(rx_hdr_status));\n\t\toff->msdu_payload_offset = __cpu_to_le16(desc_offset(msdu_payload));\n\t\toff->ppdu_start_offset = __cpu_to_le16(desc_offset(ppdu_start));\n\t\toff->ppdu_end_offset = __cpu_to_le16(desc_offset(ppdu_end));\n\t\toff->mpdu_start_offset = __cpu_to_le16(desc_offset(mpdu_start));\n\t\toff->mpdu_end_offset = __cpu_to_le16(desc_offset(mpdu_end));\n\t\toff->msdu_start_offset = __cpu_to_le16(desc_offset(msdu_start));\n\t\toff->msdu_end_offset = __cpu_to_le16(desc_offset(msdu_end));\n\t\toff->rx_attention_offset = __cpu_to_le16(desc_offset(attention));\n\t\toff->frag_info_offset =\t__cpu_to_le16(desc_offset(frag_info));\n#undef desc_offset\n\t}\n}\n\nstatic inline struct rx_attention *\nath10k_htt_rx_desc_get_attention(struct\tath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_attention)\n\t\treturn hw->rx_desc_ops->rx_desc_get_attention(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->attention;\n}\n\nstatic inline struct rx_frag_info_common *\nath10k_htt_rx_desc_get_frag_info(struct\tath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_frag_info)\n\t\treturn hw->rx_desc_ops->rx_desc_get_frag_info(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->frag_info.common;\n}\n\nstatic inline struct rx_mpdu_start *\nath10k_htt_rx_desc_get_mpdu_start(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_mpdu_start)\n\t\treturn hw->rx_desc_ops->rx_desc_get_mpdu_start(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->mpdu_start;\n}\n\nstatic inline struct rx_mpdu_end *\nath10k_htt_rx_desc_get_mpdu_end(struct ath10k_hw_params\t*hw, struct htt_rx_desc\t*rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_mpdu_end)\n\t\treturn hw->rx_desc_ops->rx_desc_get_mpdu_end(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->mpdu_end;\n}\n\nstatic inline struct rx_msdu_start_common *\nath10k_htt_rx_desc_get_msdu_start(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_msdu_start)\n\t\treturn hw->rx_desc_ops->rx_desc_get_msdu_start(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->msdu_start.common;\n}\n\nstatic inline struct rx_msdu_end_common\t*\nath10k_htt_rx_desc_get_msdu_end(struct ath10k_hw_params\t*hw, struct htt_rx_desc\t*rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_msdu_end)\n\t\treturn hw->rx_desc_ops->rx_desc_get_msdu_end(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->msdu_end.common;\n}\n\nstatic inline struct rx_ppdu_start *\nath10k_htt_rx_desc_get_ppdu_start(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_ppdu_start)\n\t\treturn hw->rx_desc_ops->rx_desc_get_ppdu_start(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->ppdu_start;\n}\n\nstatic inline struct rx_ppdu_end_common\t*\nath10k_htt_rx_desc_get_ppdu_end(struct ath10k_hw_params\t*hw, struct htt_rx_desc\t*rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_ppdu_end)\n\t\treturn hw->rx_desc_ops->rx_desc_get_ppdu_end(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn &rx_desc->ppdu_end.common;\n}\n\nstatic inline u8 *\nath10k_htt_rx_desc_get_rx_hdr_status(struct ath10k_hw_params *hw, struct htt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_rx_hdr_status)\n\t\treturn hw->rx_desc_ops->rx_desc_get_rx_hdr_status(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn rx_desc->rx_hdr_status;\n}\n\nstatic inline u8 *\nath10k_htt_rx_desc_get_msdu_payload(struct ath10k_hw_params *hw, struct\thtt_rx_desc *rxd)\n{\n\tstruct htt_rx_desc_v1 *rx_desc;\n\n\tif (hw->rx_desc_ops->rx_desc_get_msdu_payload)\n\t\treturn hw->rx_desc_ops->rx_desc_get_msdu_payload(rxd);\n\n\trx_desc = container_of(rxd, struct htt_rx_desc_v1, base);\n\treturn rx_desc->msdu_payload;\n}\n\n#define HTT_RX_DESC_HL_INFO_SEQ_NUM_MASK           0x00000fff\n#define HTT_RX_DESC_HL_INFO_SEQ_NUM_LSB            0\n#define HTT_RX_DESC_HL_INFO_ENCRYPTED_MASK         0x00001000\n#define HTT_RX_DESC_HL_INFO_ENCRYPTED_LSB          12\n#define HTT_RX_DESC_HL_INFO_CHAN_INFO_PRESENT_MASK 0x00002000\n#define HTT_RX_DESC_HL_INFO_CHAN_INFO_PRESENT_LSB  13\n#define HTT_RX_DESC_HL_INFO_MCAST_BCAST_MASK       0x00010000\n#define HTT_RX_DESC_HL_INFO_MCAST_BCAST_LSB        16\n#define HTT_RX_DESC_HL_INFO_KEY_ID_OCT_MASK        0x01fe0000\n#define HTT_RX_DESC_HL_INFO_KEY_ID_OCT_LSB         17\n\nstruct htt_rx_desc_base_hl {\n\t__le32 info;  \n};\n\nstruct htt_rx_chan_info {\n\t__le16 primary_chan_center_freq_mhz;\n\t__le16 contig_chan1_center_freq_mhz;\n\t__le16 contig_chan2_center_freq_mhz;\n\tu8 phy_mode;\n\tu8 reserved;\n} __packed;\n\n#define HTT_RX_DESC_ALIGN 8\n\n#define HTT_MAC_ADDR_LEN 6\n\n \n#define HTT_RX_BUF_SIZE 2048\n\n \nstatic inline int ath10k_htt_rx_msdu_size(struct ath10k_hw_params *hw)\n{\n\treturn HTT_RX_BUF_SIZE - (int)hw->rx_desc_ops->rx_desc_size;\n}\n\n \n#define ATH10K_HTT_MAX_NUM_REFILL 100\n\n \n#define HTT_LOG2_MAX_CACHE_LINE_SIZE 7\t \n#define HTT_MAX_CACHE_LINE_SIZE_MASK ((1 << HTT_LOG2_MAX_CACHE_LINE_SIZE) - 1)\n\n \n#define ATH10K_HTT_MAX_NUM_AMSDU_DEFAULT 3\n#define ATH10K_HTT_MAX_NUM_AMPDU_DEFAULT 64\n\nint ath10k_htt_connect(struct ath10k_htt *htt);\nint ath10k_htt_init(struct ath10k *ar);\nint ath10k_htt_setup(struct ath10k_htt *htt);\n\nint ath10k_htt_tx_start(struct ath10k_htt *htt);\nvoid ath10k_htt_tx_stop(struct ath10k_htt *htt);\nvoid ath10k_htt_tx_destroy(struct ath10k_htt *htt);\nvoid ath10k_htt_tx_free(struct ath10k_htt *htt);\n\nint ath10k_htt_rx_alloc(struct ath10k_htt *htt);\nint ath10k_htt_rx_ring_refill(struct ath10k *ar);\nvoid ath10k_htt_rx_free(struct ath10k_htt *htt);\n\nvoid ath10k_htt_htc_tx_complete(struct ath10k *ar, struct sk_buff *skb);\nvoid ath10k_htt_htc_t2h_msg_handler(struct ath10k *ar, struct sk_buff *skb);\nbool ath10k_htt_t2h_msg_handler(struct ath10k *ar, struct sk_buff *skb);\nint ath10k_htt_h2t_ver_req_msg(struct ath10k_htt *htt);\nint ath10k_htt_h2t_stats_req(struct ath10k_htt *htt, u32 mask, u32 reset_mask,\n\t\t\t     u64 cookie);\nvoid ath10k_htt_hif_tx_complete(struct ath10k *ar, struct sk_buff *skb);\nint ath10k_htt_tx_fetch_resp(struct ath10k *ar,\n\t\t\t     __le32 token,\n\t\t\t     __le16 fetch_seq_num,\n\t\t\t     struct htt_tx_fetch_record *records,\n\t\t\t     size_t num_records);\nvoid ath10k_htt_op_ep_tx_credits(struct ath10k *ar);\n\nvoid ath10k_htt_tx_txq_update(struct ieee80211_hw *hw,\n\t\t\t      struct ieee80211_txq *txq);\nvoid ath10k_htt_tx_txq_recalc(struct ieee80211_hw *hw,\n\t\t\t      struct ieee80211_txq *txq);\nvoid ath10k_htt_tx_txq_sync(struct ath10k *ar);\nvoid ath10k_htt_tx_dec_pending(struct ath10k_htt *htt);\nint ath10k_htt_tx_inc_pending(struct ath10k_htt *htt);\nvoid ath10k_htt_tx_mgmt_dec_pending(struct ath10k_htt *htt);\nint ath10k_htt_tx_mgmt_inc_pending(struct ath10k_htt *htt, bool is_mgmt,\n\t\t\t\t   bool is_presp);\n\nint ath10k_htt_tx_alloc_msdu_id(struct ath10k_htt *htt, struct sk_buff *skb);\nvoid ath10k_htt_tx_free_msdu_id(struct ath10k_htt *htt, u16 msdu_id);\nint ath10k_htt_mgmt_tx(struct ath10k_htt *htt, struct sk_buff *msdu);\nvoid ath10k_htt_rx_pktlog_completion_handler(struct ath10k *ar,\n\t\t\t\t\t     struct sk_buff *skb);\nint ath10k_htt_txrx_compl_task(struct ath10k *ar, int budget);\nint ath10k_htt_rx_hl_indication(struct ath10k *ar, int budget);\nvoid ath10k_htt_set_tx_ops(struct ath10k_htt *htt);\nvoid ath10k_htt_set_rx_ops(struct ath10k_htt *htt);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}