{
  "module_name": "core.h",
  "hash_id": "4e0b68c0708351c70aa3fa5cdd6cacf2f14500e9ce1658b8b30cfc3252e739ac",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath10k/core.h",
  "human_readable_source": " \n \n\n#ifndef _CORE_H_\n#define _CORE_H_\n\n#include <linux/completion.h>\n#include <linux/if_ether.h>\n#include <linux/types.h>\n#include <linux/pci.h>\n#include <linux/uuid.h>\n#include <linux/time.h>\n\n#include \"htt.h\"\n#include \"htc.h\"\n#include \"hw.h\"\n#include \"targaddrs.h\"\n#include \"wmi.h\"\n#include \"../ath.h\"\n#include \"../regd.h\"\n#include \"../dfs_pattern_detector.h\"\n#include \"spectral.h\"\n#include \"thermal.h\"\n#include \"wow.h\"\n#include \"swap.h\"\n\n#define MS(_v, _f) (((_v) & _f##_MASK) >> _f##_LSB)\n#define SM(_v, _f) (((_v) << _f##_LSB) & _f##_MASK)\n#define WO(_f)      ((_f##_OFFSET) >> 2)\n\n#define ATH10K_SCAN_ID 0\n#define ATH10K_SCAN_CHANNEL_SWITCH_WMI_EVT_OVERHEAD 10  \n#define WMI_READY_TIMEOUT (5 * HZ)\n#define ATH10K_FLUSH_TIMEOUT_HZ (5 * HZ)\n#define ATH10K_CONNECTION_LOSS_HZ (3 * HZ)\n#define ATH10K_NUM_CHANS 41\n#define ATH10K_MAX_5G_CHAN 173\n\n \n#define ATH10K_DEFAULT_NOISE_FLOOR -95\n\n#define ATH10K_INVALID_RSSI 128\n\n#define ATH10K_MAX_NUM_MGMT_PENDING 128\n\n \n#define ATH10K_KICKOUT_THRESHOLD (20 * 16)\n\n \n#define ATH10K_KEEPALIVE_MIN_IDLE 3747\n#define ATH10K_KEEPALIVE_MAX_IDLE 3895\n#define ATH10K_KEEPALIVE_MAX_UNRESPONSIVE 3900\n\n \n#define ATH10K_SMBIOS_BDF_EXT_TYPE 0xF8\n\n \n#define ATH10K_SMBIOS_BDF_EXT_LENGTH 0x9\n\n \n#define ATH10K_SMBIOS_BDF_EXT_OFFSET 0x8\n\n \n#define ATH10K_SMBIOS_BDF_EXT_STR_LENGTH 0x20\n\n \n#define ATH10K_SMBIOS_BDF_EXT_MAGIC \"BDF_\"\n\n \n#define ATH10K_AIRTIME_WEIGHT_MULTIPLIER  4\n\n#define ATH10K_MAX_RETRY_COUNT 30\n\n#define ATH10K_ITER_NORMAL_FLAGS (IEEE80211_IFACE_ITER_NORMAL | \\\n\t\t\t\t  IEEE80211_IFACE_SKIP_SDATA_NOT_IN_DRIVER)\n#define ATH10K_ITER_RESUME_FLAGS (IEEE80211_IFACE_ITER_RESUME_ALL |\\\n\t\t\t\t  IEEE80211_IFACE_SKIP_SDATA_NOT_IN_DRIVER)\n\nstruct ath10k;\n\nstatic inline const char *ath10k_bus_str(enum ath10k_bus bus)\n{\n\tswitch (bus) {\n\tcase ATH10K_BUS_PCI:\n\t\treturn \"pci\";\n\tcase ATH10K_BUS_AHB:\n\t\treturn \"ahb\";\n\tcase ATH10K_BUS_SDIO:\n\t\treturn \"sdio\";\n\tcase ATH10K_BUS_USB:\n\t\treturn \"usb\";\n\tcase ATH10K_BUS_SNOC:\n\t\treturn \"snoc\";\n\t}\n\n\treturn \"unknown\";\n}\n\nenum ath10k_skb_flags {\n\tATH10K_SKB_F_NO_HWCRYPT = BIT(0),\n\tATH10K_SKB_F_DTIM_ZERO = BIT(1),\n\tATH10K_SKB_F_DELIVER_CAB = BIT(2),\n\tATH10K_SKB_F_MGMT = BIT(3),\n\tATH10K_SKB_F_QOS = BIT(4),\n\tATH10K_SKB_F_RAW_TX = BIT(5),\n\tATH10K_SKB_F_NOACK_TID = BIT(6),\n};\n\nstruct ath10k_skb_cb {\n\tdma_addr_t paddr;\n\tu8 flags;\n\tu8 eid;\n\tu16 msdu_id;\n\tu16 airtime_est;\n\tstruct ieee80211_vif *vif;\n\tstruct ieee80211_txq *txq;\n\tu32 ucast_cipher;\n} __packed;\n\nstruct ath10k_skb_rxcb {\n\tdma_addr_t paddr;\n\tstruct hlist_node hlist;\n\tu8 eid;\n};\n\nstatic inline struct ath10k_skb_cb *ATH10K_SKB_CB(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct ath10k_skb_cb) >\n\t\t     IEEE80211_TX_INFO_DRIVER_DATA_SIZE);\n\treturn (struct ath10k_skb_cb *)&IEEE80211_SKB_CB(skb)->driver_data;\n}\n\nstatic inline struct ath10k_skb_rxcb *ATH10K_SKB_RXCB(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct ath10k_skb_rxcb) > sizeof(skb->cb));\n\treturn (struct ath10k_skb_rxcb *)skb->cb;\n}\n\n#define ATH10K_RXCB_SKB(rxcb) \\\n\t\tcontainer_of((void *)rxcb, struct sk_buff, cb)\n\nstatic inline u32 host_interest_item_address(u32 item_offset)\n{\n\treturn QCA988X_HOST_INTEREST_ADDRESS + item_offset;\n}\n\nenum ath10k_phy_mode {\n\tATH10K_PHY_MODE_LEGACY = 0,\n\tATH10K_PHY_MODE_HT = 1,\n\tATH10K_PHY_MODE_VHT = 2,\n};\n\n \nstruct ath10k_index_ht_data_rate_type {\n\tu8   beacon_rate_index;\n\tu16  supported_rate[4];\n};\n\n \nstruct ath10k_index_vht_data_rate_type {\n\tu8   beacon_rate_index;\n\tu16  supported_VHT80_rate[2];\n\tu16  supported_VHT40_rate[2];\n\tu16  supported_VHT20_rate[2];\n};\n\nstruct ath10k_bmi {\n\tbool done_sent;\n};\n\nstruct ath10k_mem_chunk {\n\tvoid *vaddr;\n\tdma_addr_t paddr;\n\tu32 len;\n\tu32 req_id;\n};\n\nstruct ath10k_wmi {\n\tenum ath10k_htc_ep_id eid;\n\tstruct completion service_ready;\n\tstruct completion unified_ready;\n\tstruct completion barrier;\n\tstruct completion radar_confirm;\n\twait_queue_head_t tx_credits_wq;\n\tDECLARE_BITMAP(svc_map, WMI_SERVICE_MAX);\n\tstruct wmi_cmd_map *cmd;\n\tstruct wmi_vdev_param_map *vdev_param;\n\tstruct wmi_pdev_param_map *pdev_param;\n\tstruct wmi_peer_param_map *peer_param;\n\tconst struct wmi_ops *ops;\n\tconst struct wmi_peer_flags_map *peer_flags;\n\n\tu32 mgmt_max_num_pending_tx;\n\n\t \n\tstruct idr mgmt_pending_tx;\n\n\tu32 num_mem_chunks;\n\tu32 rx_decap_mode;\n\tstruct ath10k_mem_chunk mem_chunks[WMI_MAX_MEM_REQS];\n};\n\nstruct ath10k_fw_stats_peer {\n\tstruct list_head list;\n\n\tu8 peer_macaddr[ETH_ALEN];\n\tu32 peer_rssi;\n\tu32 peer_tx_rate;\n\tu32 peer_rx_rate;  \n\tu64 rx_duration;\n};\n\nstruct ath10k_fw_extd_stats_peer {\n\tstruct list_head list;\n\n\tu8 peer_macaddr[ETH_ALEN];\n\tu64 rx_duration;\n};\n\nstruct ath10k_fw_stats_vdev {\n\tstruct list_head list;\n\n\tu32 vdev_id;\n\tu32 beacon_snr;\n\tu32 data_snr;\n\tu32 num_tx_frames[4];\n\tu32 num_rx_frames;\n\tu32 num_tx_frames_retries[4];\n\tu32 num_tx_frames_failures[4];\n\tu32 num_rts_fail;\n\tu32 num_rts_success;\n\tu32 num_rx_err;\n\tu32 num_rx_discard;\n\tu32 num_tx_not_acked;\n\tu32 tx_rate_history[10];\n\tu32 beacon_rssi_history[10];\n};\n\nstruct ath10k_fw_stats_vdev_extd {\n\tstruct list_head list;\n\n\tu32 vdev_id;\n\tu32 ppdu_aggr_cnt;\n\tu32 ppdu_noack;\n\tu32 mpdu_queued;\n\tu32 ppdu_nonaggr_cnt;\n\tu32 mpdu_sw_requeued;\n\tu32 mpdu_suc_retry;\n\tu32 mpdu_suc_multitry;\n\tu32 mpdu_fail_retry;\n\tu32 tx_ftm_suc;\n\tu32 tx_ftm_suc_retry;\n\tu32 tx_ftm_fail;\n\tu32 rx_ftmr_cnt;\n\tu32 rx_ftmr_dup_cnt;\n\tu32 rx_iftmr_cnt;\n\tu32 rx_iftmr_dup_cnt;\n};\n\nstruct ath10k_fw_stats_pdev {\n\tstruct list_head list;\n\n\t \n\ts32 ch_noise_floor;\n\tu32 tx_frame_count;  \n\tu32 rx_frame_count;  \n\tu32 rx_clear_count;  \n\tu32 cycle_count;  \n\tu32 phy_err_count;\n\tu32 chan_tx_power;\n\tu32 ack_rx_bad;\n\tu32 rts_bad;\n\tu32 rts_good;\n\tu32 fcs_bad;\n\tu32 no_beacons;\n\tu32 mib_int_count;\n\n\t \n\ts32 comp_queued;\n\ts32 comp_delivered;\n\ts32 msdu_enqued;\n\ts32 mpdu_enqued;\n\ts32 wmm_drop;\n\ts32 local_enqued;\n\ts32 local_freed;\n\ts32 hw_queued;\n\ts32 hw_reaped;\n\ts32 underrun;\n\tu32 hw_paused;\n\ts32 tx_abort;\n\ts32 mpdus_requeued;\n\tu32 tx_ko;\n\tu32 data_rc;\n\tu32 self_triggers;\n\tu32 sw_retry_failure;\n\tu32 illgl_rate_phy_err;\n\tu32 pdev_cont_xretry;\n\tu32 pdev_tx_timeout;\n\tu32 pdev_resets;\n\tu32 phy_underrun;\n\tu32 txop_ovf;\n\tu32 seq_posted;\n\tu32 seq_failed_queueing;\n\tu32 seq_completed;\n\tu32 seq_restarted;\n\tu32 mu_seq_posted;\n\tu32 mpdus_sw_flush;\n\tu32 mpdus_hw_filter;\n\tu32 mpdus_truncated;\n\tu32 mpdus_ack_failed;\n\tu32 mpdus_expired;\n\n\t \n\ts32 mid_ppdu_route_change;\n\ts32 status_rcvd;\n\ts32 r0_frags;\n\ts32 r1_frags;\n\ts32 r2_frags;\n\ts32 r3_frags;\n\ts32 htt_msdus;\n\ts32 htt_mpdus;\n\ts32 loc_msdus;\n\ts32 loc_mpdus;\n\ts32 oversize_amsdu;\n\ts32 phy_errs;\n\ts32 phy_err_drop;\n\ts32 mpdu_errs;\n\ts32 rx_ovfl_errs;\n};\n\nstruct ath10k_fw_stats {\n\tbool extended;\n\tstruct list_head pdevs;\n\tstruct list_head vdevs;\n\tstruct list_head peers;\n\tstruct list_head peers_extd;\n};\n\n#define ATH10K_TPC_TABLE_TYPE_FLAG\t1\n#define ATH10K_TPC_PREAM_TABLE_END\t0xFFFF\n\nstruct ath10k_tpc_table {\n\tu32 pream_idx[WMI_TPC_RATE_MAX];\n\tu8 rate_code[WMI_TPC_RATE_MAX];\n\tchar tpc_value[WMI_TPC_RATE_MAX][WMI_TPC_TX_N_CHAIN * WMI_TPC_BUF_SIZE];\n};\n\nstruct ath10k_tpc_stats {\n\tu32 reg_domain;\n\tu32 chan_freq;\n\tu32 phy_mode;\n\tu32 twice_antenna_reduction;\n\tu32 twice_max_rd_power;\n\ts32 twice_antenna_gain;\n\tu32 power_limit;\n\tu32 num_tx_chain;\n\tu32 ctl;\n\tu32 rate_max;\n\tu8 flag[WMI_TPC_FLAG];\n\tstruct ath10k_tpc_table tpc_table[WMI_TPC_FLAG];\n};\n\nstruct ath10k_tpc_table_final {\n\tu32 pream_idx[WMI_TPC_FINAL_RATE_MAX];\n\tu8 rate_code[WMI_TPC_FINAL_RATE_MAX];\n\tchar tpc_value[WMI_TPC_FINAL_RATE_MAX][WMI_TPC_TX_N_CHAIN * WMI_TPC_BUF_SIZE];\n};\n\nstruct ath10k_tpc_stats_final {\n\tu32 reg_domain;\n\tu32 chan_freq;\n\tu32 phy_mode;\n\tu32 twice_antenna_reduction;\n\tu32 twice_max_rd_power;\n\ts32 twice_antenna_gain;\n\tu32 power_limit;\n\tu32 num_tx_chain;\n\tu32 ctl;\n\tu32 rate_max;\n\tu8 flag[WMI_TPC_FLAG];\n\tstruct ath10k_tpc_table_final tpc_table_final[WMI_TPC_FLAG];\n};\n\nstruct ath10k_dfs_stats {\n\tu32 phy_errors;\n\tu32 pulses_total;\n\tu32 pulses_detected;\n\tu32 pulses_discarded;\n\tu32 radar_detected;\n};\n\nenum ath10k_radar_confirmation_state {\n\tATH10K_RADAR_CONFIRMATION_IDLE = 0,\n\tATH10K_RADAR_CONFIRMATION_INPROGRESS,\n\tATH10K_RADAR_CONFIRMATION_STOPPED,\n};\n\nstruct ath10k_radar_found_info {\n\tu32 pri_min;\n\tu32 pri_max;\n\tu32 width_min;\n\tu32 width_max;\n\tu32 sidx_min;\n\tu32 sidx_max;\n};\n\n#define ATH10K_MAX_NUM_PEER_IDS (1 << 11)  \n\nstruct ath10k_peer {\n\tstruct list_head list;\n\tstruct ieee80211_vif *vif;\n\tstruct ieee80211_sta *sta;\n\n\tbool removed;\n\tint vdev_id;\n\tu8 addr[ETH_ALEN];\n\tDECLARE_BITMAP(peer_ids, ATH10K_MAX_NUM_PEER_IDS);\n\n\t \n\tstruct ieee80211_key_conf *keys[WMI_MAX_KEY_INDEX + 1];\n\tunion htt_rx_pn_t tids_last_pn[ATH10K_TXRX_NUM_EXT_TIDS];\n\tbool tids_last_pn_valid[ATH10K_TXRX_NUM_EXT_TIDS];\n\tunion htt_rx_pn_t frag_tids_last_pn[ATH10K_TXRX_NUM_EXT_TIDS];\n\tu32 frag_tids_seq[ATH10K_TXRX_NUM_EXT_TIDS];\n\tstruct {\n\t\tenum htt_security_types sec_type;\n\t\tint pn_len;\n\t} rx_pn[ATH10K_HTT_TXRX_PEER_SECURITY_MAX];\n};\n\nstruct ath10k_txq {\n\tstruct list_head list;\n\tunsigned long num_fw_queued;\n\tunsigned long num_push_allowed;\n};\n\nenum ath10k_pkt_rx_err {\n\tATH10K_PKT_RX_ERR_FCS,\n\tATH10K_PKT_RX_ERR_TKIP,\n\tATH10K_PKT_RX_ERR_CRYPT,\n\tATH10K_PKT_RX_ERR_PEER_IDX_INVAL,\n\tATH10K_PKT_RX_ERR_MAX,\n};\n\nenum ath10k_ampdu_subfrm_num {\n\tATH10K_AMPDU_SUBFRM_NUM_10,\n\tATH10K_AMPDU_SUBFRM_NUM_20,\n\tATH10K_AMPDU_SUBFRM_NUM_30,\n\tATH10K_AMPDU_SUBFRM_NUM_40,\n\tATH10K_AMPDU_SUBFRM_NUM_50,\n\tATH10K_AMPDU_SUBFRM_NUM_60,\n\tATH10K_AMPDU_SUBFRM_NUM_MORE,\n\tATH10K_AMPDU_SUBFRM_NUM_MAX,\n};\n\nenum ath10k_amsdu_subfrm_num {\n\tATH10K_AMSDU_SUBFRM_NUM_1,\n\tATH10K_AMSDU_SUBFRM_NUM_2,\n\tATH10K_AMSDU_SUBFRM_NUM_3,\n\tATH10K_AMSDU_SUBFRM_NUM_4,\n\tATH10K_AMSDU_SUBFRM_NUM_MORE,\n\tATH10K_AMSDU_SUBFRM_NUM_MAX,\n};\n\nstruct ath10k_sta_tid_stats {\n\tunsigned long rx_pkt_from_fw;\n\tunsigned long rx_pkt_unchained;\n\tunsigned long rx_pkt_drop_chained;\n\tunsigned long rx_pkt_drop_filter;\n\tunsigned long rx_pkt_err[ATH10K_PKT_RX_ERR_MAX];\n\tunsigned long rx_pkt_queued_for_mac;\n\tunsigned long rx_pkt_ampdu[ATH10K_AMPDU_SUBFRM_NUM_MAX];\n\tunsigned long rx_pkt_amsdu[ATH10K_AMSDU_SUBFRM_NUM_MAX];\n};\n\nenum ath10k_counter_type {\n\tATH10K_COUNTER_TYPE_BYTES,\n\tATH10K_COUNTER_TYPE_PKTS,\n\tATH10K_COUNTER_TYPE_MAX,\n};\n\nenum ath10k_stats_type {\n\tATH10K_STATS_TYPE_SUCC,\n\tATH10K_STATS_TYPE_FAIL,\n\tATH10K_STATS_TYPE_RETRY,\n\tATH10K_STATS_TYPE_AMPDU,\n\tATH10K_STATS_TYPE_MAX,\n};\n\nstruct ath10k_htt_data_stats {\n\tu64 legacy[ATH10K_COUNTER_TYPE_MAX][ATH10K_LEGACY_NUM];\n\tu64 ht[ATH10K_COUNTER_TYPE_MAX][ATH10K_HT_MCS_NUM];\n\tu64 vht[ATH10K_COUNTER_TYPE_MAX][ATH10K_VHT_MCS_NUM];\n\tu64 bw[ATH10K_COUNTER_TYPE_MAX][ATH10K_BW_NUM];\n\tu64 nss[ATH10K_COUNTER_TYPE_MAX][ATH10K_NSS_NUM];\n\tu64 gi[ATH10K_COUNTER_TYPE_MAX][ATH10K_GI_NUM];\n\tu64 rate_table[ATH10K_COUNTER_TYPE_MAX][ATH10K_RATE_TABLE_NUM];\n};\n\nstruct ath10k_htt_tx_stats {\n\tstruct ath10k_htt_data_stats stats[ATH10K_STATS_TYPE_MAX];\n\tu64 tx_duration;\n\tu64 ba_fails;\n\tu64 ack_fails;\n};\n\n#define ATH10K_TID_MAX\t8\n\nstruct ath10k_sta {\n\tstruct ath10k_vif *arvif;\n\n\t \n\tu32 changed;  \n\tu32 bw;\n\tu32 nss;\n\tu32 smps;\n\tu16 peer_id;\n\tstruct rate_info txrate;\n\tstruct ieee80211_tx_info tx_info;\n\tu32 tx_retries;\n\tu32 tx_failed;\n\tu32 last_tx_bitrate;\n\n\tu32 rx_rate_code;\n\tu32 rx_bitrate_kbps;\n\tu32 tx_rate_code;\n\tu32 tx_bitrate_kbps;\n\tstruct work_struct update_wk;\n\tu64 rx_duration;\n\tstruct ath10k_htt_tx_stats *tx_stats;\n\tu32 ucast_cipher;\n\n#ifdef CONFIG_MAC80211_DEBUGFS\n\t \n\tbool aggr_mode;\n\n\t \n\tstruct ath10k_sta_tid_stats tid_stats[IEEE80211_NUM_TIDS + 1];\n#endif\n\t \n\tu32 peer_ps_state;\n\tstruct work_struct tid_config_wk;\n\tint noack[ATH10K_TID_MAX];\n\tint retry_long[ATH10K_TID_MAX];\n\tint ampdu[ATH10K_TID_MAX];\n\tu8 rate_ctrl[ATH10K_TID_MAX];\n\tu32 rate_code[ATH10K_TID_MAX];\n\tint rtscts[ATH10K_TID_MAX];\n};\n\n#define ATH10K_VDEV_SETUP_TIMEOUT_HZ\t(5 * HZ)\n#define ATH10K_VDEV_DELETE_TIMEOUT_HZ\t(5 * HZ)\n\nenum ath10k_beacon_state {\n\tATH10K_BEACON_SCHEDULED = 0,\n\tATH10K_BEACON_SENDING,\n\tATH10K_BEACON_SENT,\n};\n\nstruct ath10k_vif {\n\tstruct list_head list;\n\n\tu32 vdev_id;\n\tu16 peer_id;\n\tenum wmi_vdev_type vdev_type;\n\tenum wmi_vdev_subtype vdev_subtype;\n\tu32 beacon_interval;\n\tu32 dtim_period;\n\tstruct sk_buff *beacon;\n\t \n\tenum ath10k_beacon_state beacon_state;\n\tvoid *beacon_buf;\n\tdma_addr_t beacon_paddr;\n\tunsigned long tx_paused;  \n\n\tstruct ath10k *ar;\n\tstruct ieee80211_vif *vif;\n\n\tbool is_started;\n\tbool is_up;\n\tbool spectral_enabled;\n\tbool ps;\n\tu32 aid;\n\tu8 bssid[ETH_ALEN];\n\n\tstruct ieee80211_key_conf *wep_keys[WMI_MAX_KEY_INDEX + 1];\n\ts8 def_wep_key_idx;\n\n\tu16 tx_seq_no;\n\n\tunion {\n\t\tstruct {\n\t\t\tu32 uapsd;\n\t\t} sta;\n\t\tstruct {\n\t\t\t \n\t\t\tu8 tim_bitmap[64];\n\t\t\tu8 tim_len;\n\t\t\tu32 ssid_len;\n\t\t\tu8 ssid[IEEE80211_MAX_SSID_LEN];\n\t\t\tbool hidden_ssid;\n\t\t\t \n\t\t\tu32 noa_len;\n\t\t\tu8 *noa_data;\n\t\t} ap;\n\t} u;\n\n\tbool use_cts_prot;\n\tbool nohwcrypt;\n\tint num_legacy_stations;\n\tint txpower;\n\tbool ftm_responder;\n\tstruct wmi_wmm_params_all_arg wmm_params;\n\tstruct work_struct ap_csa_work;\n\tstruct delayed_work connection_loss_work;\n\tstruct cfg80211_bitrate_mask bitrate_mask;\n\n\t \n\tint vht_num_rates;\n\tu8 vht_pfr;\n\tu32 tid_conf_changed[ATH10K_TID_MAX];\n\tint noack[ATH10K_TID_MAX];\n\tint retry_long[ATH10K_TID_MAX];\n\tint ampdu[ATH10K_TID_MAX];\n\tu8 rate_ctrl[ATH10K_TID_MAX];\n\tu32 rate_code[ATH10K_TID_MAX];\n\tint rtscts[ATH10K_TID_MAX];\n\tu32 tids_rst;\n};\n\nstruct ath10k_vif_iter {\n\tu32 vdev_id;\n\tstruct ath10k_vif *arvif;\n};\n\n \nstruct ath10k_ce_crash_data {\n\t__le32 base_addr;\n\t__le32 src_wr_idx;\n\t__le32 src_r_idx;\n\t__le32 dst_wr_idx;\n\t__le32 dst_r_idx;\n};\n\nstruct ath10k_ce_crash_hdr {\n\t__le32 ce_count;\n\t__le32 reserved[3];  \n\tstruct ath10k_ce_crash_data entries[];\n};\n\n#define MAX_MEM_DUMP_TYPE\t5\n\n \nstruct ath10k_fw_crash_data {\n\tguid_t guid;\n\tstruct timespec64 timestamp;\n\t__le32 registers[REG_DUMP_COUNT_QCA988X];\n\tstruct ath10k_ce_crash_data ce_crash_data[CE_COUNT_MAX];\n\n\tu8 *ramdump_buf;\n\tsize_t ramdump_buf_len;\n};\n\nstruct ath10k_debug {\n\tstruct dentry *debugfs_phy;\n\n\tstruct ath10k_fw_stats fw_stats;\n\tstruct completion fw_stats_complete;\n\tbool fw_stats_done;\n\n\tunsigned long htt_stats_mask;\n\tunsigned long reset_htt_stats;\n\tstruct delayed_work htt_stats_dwork;\n\tstruct ath10k_dfs_stats dfs_stats;\n\tstruct ath_dfs_pool_stats dfs_pool_stats;\n\n\t \n\tstruct ath10k_tpc_stats *tpc_stats;\n\tstruct ath10k_tpc_stats_final *tpc_stats_final;\n\n\tstruct completion tpc_complete;\n\n\t \n\tu64 fw_dbglog_mask;\n\tu32 fw_dbglog_level;\n\tu32 reg_addr;\n\tu32 nf_cal_period;\n\tvoid *cal_data;\n\tu32 enable_extd_tx_stats;\n\tu8 fw_dbglog_mode;\n};\n\nenum ath10k_state {\n\tATH10K_STATE_OFF = 0,\n\tATH10K_STATE_ON,\n\n\t \n\tATH10K_STATE_RESTARTING,\n\tATH10K_STATE_RESTARTED,\n\n\t \n\tATH10K_STATE_WEDGED,\n\n\t \n\tATH10K_STATE_UTF,\n};\n\nenum ath10k_firmware_mode {\n\t \n\tATH10K_FIRMWARE_MODE_NORMAL,\n\n\t \n\tATH10K_FIRMWARE_MODE_UTF,\n};\n\nenum ath10k_fw_features {\n\t \n\tATH10K_FW_FEATURE_EXT_WMI_MGMT_RX = 0,\n\n\t \n\tATH10K_FW_FEATURE_WMI_10X = 1,\n\n\t \n\tATH10K_FW_FEATURE_HAS_WMI_MGMT_TX = 2,\n\n\t \n\tATH10K_FW_FEATURE_NO_P2P = 3,\n\n\t \n\tATH10K_FW_FEATURE_WMI_10_2 = 4,\n\n\t \n\tATH10K_FW_FEATURE_MULTI_VIF_PS_SUPPORT = 5,\n\n\t \n\tATH10K_FW_FEATURE_WOWLAN_SUPPORT = 6,\n\n\t \n\tATH10K_FW_FEATURE_IGNORE_OTP_RESULT = 7,\n\n\t \n\tATH10K_FW_FEATURE_NO_NWIFI_DECAP_4ADDR_PADDING = 8,\n\n\t \n\tATH10K_FW_FEATURE_SUPPORTS_SKIP_CLOCK_INIT = 9,\n\n\t \n\tATH10K_FW_FEATURE_RAW_MODE_SUPPORT = 10,\n\n\t \n\tATH10K_FW_FEATURE_SUPPORTS_ADAPTIVE_CCA = 11,\n\n\t \n\tATH10K_FW_FEATURE_MFP_SUPPORT = 12,\n\n\t \n\tATH10K_FW_FEATURE_PEER_FLOW_CONTROL = 13,\n\n\t \n\tATH10K_FW_FEATURE_BTCOEX_PARAM = 14,\n\n\t \n\tATH10K_FW_FEATURE_SKIP_NULL_FUNC_WAR = 15,\n\n\t \n\tATH10K_FW_FEATURE_ALLOWS_MESH_BCAST = 16,\n\n\t \n\tATH10K_FW_FEATURE_NO_PS = 17,\n\n\t \n\tATH10K_FW_FEATURE_MGMT_TX_BY_REF = 18,\n\n\t \n\tATH10K_FW_FEATURE_NON_BMI = 19,\n\n\t \n\tATH10K_FW_FEATURE_SINGLE_CHAN_INFO_PER_CHANNEL = 20,\n\n\t \n\tATH10K_FW_FEATURE_PEER_FIXED_RATE = 21,\n\n\t \n\tATH10K_FW_FEATURE_IRAM_RECOVERY = 22,\n\n\t \n\tATH10K_FW_FEATURE_COUNT,\n};\n\nenum ath10k_dev_flags {\n\t \n\tATH10K_CAC_RUNNING,\n\tATH10K_FLAG_CORE_REGISTERED,\n\n\t \n\tATH10K_FLAG_CRASH_FLUSH,\n\n\t \n\tATH10K_FLAG_RAW_MODE,\n\n\t \n\tATH10K_FLAG_HW_CRYPTO_DISABLED,\n\n\t \n\tATH10K_FLAG_BTCOEX,\n\n\t \n\tATH10K_FLAG_PEER_STATS,\n\n\t \n\tATH10K_FLAG_RESTARTING,\n\n\t \n\tATH10K_FLAG_NAPI_ENABLED,\n};\n\nenum ath10k_cal_mode {\n\tATH10K_CAL_MODE_FILE,\n\tATH10K_CAL_MODE_OTP,\n\tATH10K_CAL_MODE_DT,\n\tATH10K_CAL_MODE_NVMEM,\n\tATH10K_PRE_CAL_MODE_FILE,\n\tATH10K_PRE_CAL_MODE_DT,\n\tATH10K_PRE_CAL_MODE_NVMEM,\n\tATH10K_CAL_MODE_EEPROM,\n};\n\nenum ath10k_crypt_mode {\n\t \n\tATH10K_CRYPT_MODE_HW,\n\t \n\tATH10K_CRYPT_MODE_SW,\n};\n\nstatic inline const char *ath10k_cal_mode_str(enum ath10k_cal_mode mode)\n{\n\tswitch (mode) {\n\tcase ATH10K_CAL_MODE_FILE:\n\t\treturn \"file\";\n\tcase ATH10K_CAL_MODE_OTP:\n\t\treturn \"otp\";\n\tcase ATH10K_CAL_MODE_DT:\n\t\treturn \"dt\";\n\tcase ATH10K_CAL_MODE_NVMEM:\n\t\treturn \"nvmem\";\n\tcase ATH10K_PRE_CAL_MODE_FILE:\n\t\treturn \"pre-cal-file\";\n\tcase ATH10K_PRE_CAL_MODE_DT:\n\t\treturn \"pre-cal-dt\";\n\tcase ATH10K_PRE_CAL_MODE_NVMEM:\n\t\treturn \"pre-cal-nvmem\";\n\tcase ATH10K_CAL_MODE_EEPROM:\n\t\treturn \"eeprom\";\n\t}\n\n\treturn \"unknown\";\n}\n\nenum ath10k_scan_state {\n\tATH10K_SCAN_IDLE,\n\tATH10K_SCAN_STARTING,\n\tATH10K_SCAN_RUNNING,\n\tATH10K_SCAN_ABORTING,\n};\n\nstatic inline const char *ath10k_scan_state_str(enum ath10k_scan_state state)\n{\n\tswitch (state) {\n\tcase ATH10K_SCAN_IDLE:\n\t\treturn \"idle\";\n\tcase ATH10K_SCAN_STARTING:\n\t\treturn \"starting\";\n\tcase ATH10K_SCAN_RUNNING:\n\t\treturn \"running\";\n\tcase ATH10K_SCAN_ABORTING:\n\t\treturn \"aborting\";\n\t}\n\n\treturn \"unknown\";\n}\n\nenum ath10k_tx_pause_reason {\n\tATH10K_TX_PAUSE_Q_FULL,\n\tATH10K_TX_PAUSE_MAX,\n};\n\nstruct ath10k_fw_file {\n\tconst struct firmware *firmware;\n\n\tchar fw_version[ETHTOOL_FWVERS_LEN];\n\n\tDECLARE_BITMAP(fw_features, ATH10K_FW_FEATURE_COUNT);\n\n\tenum ath10k_fw_wmi_op_version wmi_op_version;\n\tenum ath10k_fw_htt_op_version htt_op_version;\n\n\tconst void *firmware_data;\n\tsize_t firmware_len;\n\n\tconst void *otp_data;\n\tsize_t otp_len;\n\n\tconst void *codeswap_data;\n\tsize_t codeswap_len;\n\n\t \n\tstruct ath10k_swap_code_seg_info *firmware_swap_code_seg_info;\n};\n\nstruct ath10k_fw_components {\n\tconst struct firmware *board;\n\tconst void *board_data;\n\tsize_t board_len;\n\tconst struct firmware *ext_board;\n\tconst void *ext_board_data;\n\tsize_t ext_board_len;\n\n\tstruct ath10k_fw_file fw_file;\n};\n\nstruct ath10k_per_peer_tx_stats {\n\tu32\tsucc_bytes;\n\tu32\tretry_bytes;\n\tu32\tfailed_bytes;\n\tu8\tratecode;\n\tu8\tflags;\n\tu16\tpeer_id;\n\tu16\tsucc_pkts;\n\tu16\tretry_pkts;\n\tu16\tfailed_pkts;\n\tu16\tduration;\n\tu32\treserved1;\n\tu32\treserved2;\n};\n\nenum ath10k_dev_type {\n\tATH10K_DEV_TYPE_LL,\n\tATH10K_DEV_TYPE_HL,\n};\n\nstruct ath10k_bus_params {\n\tu32 chip_id;\n\tenum ath10k_dev_type dev_type;\n\tbool link_can_suspend;\n\tbool hl_msdu_ids;\n};\n\nstruct ath10k {\n\tstruct ath_common ath_common;\n\tstruct ieee80211_hw *hw;\n\tstruct ieee80211_ops *ops;\n\tstruct device *dev;\n\tstruct msa_region {\n\t\tdma_addr_t paddr;\n\t\tu32 mem_size;\n\t\tvoid *vaddr;\n\t} msa;\n\tu8 mac_addr[ETH_ALEN];\n\n\tenum ath10k_hw_rev hw_rev;\n\tu16 dev_id;\n\tu32 chip_id;\n\tu32 target_version;\n\tu8 fw_version_major;\n\tu32 fw_version_minor;\n\tu16 fw_version_release;\n\tu16 fw_version_build;\n\tu32 fw_stats_req_mask;\n\tu32 phy_capability;\n\tu32 hw_min_tx_power;\n\tu32 hw_max_tx_power;\n\tu32 hw_eeprom_rd;\n\tu32 ht_cap_info;\n\tu32 vht_cap_info;\n\tu32 vht_supp_mcs;\n\tu32 num_rf_chains;\n\tu32 max_spatial_stream;\n\t \n\tu32 low_2ghz_chan;\n\tu32 high_2ghz_chan;\n\tu32 low_5ghz_chan;\n\tu32 high_5ghz_chan;\n\tbool ani_enabled;\n\tu32 sys_cap_info;\n\n\t \n\tbool hw_rfkill_on;\n\n\t \n\tu8 ps_state_enable;\n\n\tbool nlo_enabled;\n\tbool p2p;\n\n\tstruct {\n\t\tenum ath10k_bus bus;\n\t\tconst struct ath10k_hif_ops *ops;\n\t} hif;\n\n\tstruct completion target_suspend;\n\tstruct completion driver_recovery;\n\n\tconst struct ath10k_hw_regs *regs;\n\tconst struct ath10k_hw_ce_regs *hw_ce_regs;\n\tconst struct ath10k_hw_values *hw_values;\n\tstruct ath10k_bmi bmi;\n\tstruct ath10k_wmi wmi;\n\tstruct ath10k_htc htc;\n\tstruct ath10k_htt htt;\n\n\tstruct ath10k_hw_params hw_params;\n\n\t \n\tstruct ath10k_fw_components normal_mode_fw;\n\n\t \n\tconst struct ath10k_fw_components *running_fw;\n\n\tconst struct firmware *pre_cal_file;\n\tconst struct firmware *cal_file;\n\n\tstruct {\n\t\tu32 vendor;\n\t\tu32 device;\n\t\tu32 subsystem_vendor;\n\t\tu32 subsystem_device;\n\n\t\tbool bmi_ids_valid;\n\t\tbool qmi_ids_valid;\n\t\tu32 qmi_board_id;\n\t\tu32 qmi_chip_id;\n\t\tu8 bmi_board_id;\n\t\tu8 bmi_eboard_id;\n\t\tu8 bmi_chip_id;\n\t\tbool ext_bid_supported;\n\n\t\tchar bdf_ext[ATH10K_SMBIOS_BDF_EXT_STR_LENGTH];\n\t} id;\n\n\tint fw_api;\n\tint bd_api;\n\tenum ath10k_cal_mode cal_mode;\n\n\tstruct {\n\t\tstruct completion started;\n\t\tstruct completion completed;\n\t\tstruct completion on_channel;\n\t\tstruct delayed_work timeout;\n\t\tenum ath10k_scan_state state;\n\t\tbool is_roc;\n\t\tint vdev_id;\n\t\tint roc_freq;\n\t\tbool roc_notify;\n\t} scan;\n\n\tstruct {\n\t\tstruct ieee80211_supported_band sbands[NUM_NL80211_BANDS];\n\t} mac;\n\n\t \n\tstruct ieee80211_channel *rx_channel;\n\n\t \n\tstruct ieee80211_channel *scan_channel;\n\n\t \n\tstruct cfg80211_chan_def chandef;\n\n\t \n\tstruct ieee80211_channel *tgt_oper_chan;\n\n\tunsigned long long free_vdev_map;\n\tstruct ath10k_vif *monitor_arvif;\n\tbool monitor;\n\tint monitor_vdev_id;\n\tbool monitor_started;\n\tunsigned int filter_flags;\n\tunsigned long dev_flags;\n\tbool dfs_block_radar_events;\n\n\t \n\tbool radar_enabled;\n\tint num_started_vdevs;\n\n\t \n\tu8 cfg_tx_chainmask;\n\tu8 cfg_rx_chainmask;\n\n\tstruct completion install_key_done;\n\n\tint last_wmi_vdev_start_status;\n\tstruct completion vdev_setup_done;\n\tstruct completion vdev_delete_done;\n\tstruct completion peer_stats_info_complete;\n\n\tstruct workqueue_struct *workqueue;\n\t \n\tstruct workqueue_struct *workqueue_aux;\n\tstruct workqueue_struct *workqueue_tx_complete;\n\t \n\tstruct mutex conf_mutex;\n\n\t \n\tstruct mutex dump_mutex;\n\n\t \n\tspinlock_t data_lock;\n\n\t \n\tspinlock_t queue_lock[IEEE80211_NUM_ACS];\n\n\tstruct list_head arvifs;\n\tstruct list_head peers;\n\tstruct ath10k_peer *peer_map[ATH10K_MAX_NUM_PEER_IDS];\n\twait_queue_head_t peer_mapping_wq;\n\n\t \n\tint num_peers;\n\tint num_stations;\n\n\tint max_num_peers;\n\tint max_num_stations;\n\tint max_num_vdevs;\n\tint max_num_tdls_vdevs;\n\tint num_active_peers;\n\tint num_tids;\n\n\tstruct work_struct svc_rdy_work;\n\tstruct sk_buff *svc_rdy_skb;\n\n\tstruct work_struct offchan_tx_work;\n\tstruct sk_buff_head offchan_tx_queue;\n\tstruct completion offchan_tx_completed;\n\tstruct sk_buff *offchan_tx_skb;\n\n\tstruct work_struct wmi_mgmt_tx_work;\n\tstruct sk_buff_head wmi_mgmt_tx_queue;\n\n\tenum ath10k_state state;\n\n\tstruct work_struct register_work;\n\tstruct work_struct restart_work;\n\tstruct work_struct bundle_tx_work;\n\tstruct work_struct tx_complete_work;\n\n\t \n\tu32 survey_last_rx_clear_count;\n\tu32 survey_last_cycle_count;\n\tstruct survey_info survey[ATH10K_NUM_CHANS];\n\n\t \n\tbool ch_info_can_report_survey;\n\tstruct completion bss_survey_done;\n\n\tstruct dfs_pattern_detector *dfs_detector;\n\n\tunsigned long tx_paused;  \n\n#ifdef CONFIG_ATH10K_DEBUGFS\n\tstruct ath10k_debug debug;\n\tstruct {\n\t\t \n\t\tstruct rchan *rfs_chan_spec_scan;\n\n\t\t \n\t\tenum ath10k_spectral_mode mode;\n\t\tstruct ath10k_spec_scan config;\n\t} spectral;\n#endif\n\n\tu32 pktlog_filter;\n\n#ifdef CONFIG_DEV_COREDUMP\n\tstruct {\n\t\tstruct ath10k_fw_crash_data *fw_crash_data;\n\t} coredump;\n#endif\n\n\tstruct {\n\t\t \n\t\tstruct ath10k_fw_components utf_mode_fw;\n\n\t\t \n\t\tbool utf_monitor;\n\t} testmode;\n\n\tstruct {\n\t\t \n\t\tu32 rx_crc_err_drop;\n\t\tu32 fw_crash_counter;\n\t\tu32 fw_warm_reset_counter;\n\t\tu32 fw_cold_reset_counter;\n\t} stats;\n\n\tstruct ath10k_thermal thermal;\n\tstruct ath10k_wow wow;\n\tstruct ath10k_per_peer_tx_stats peer_tx_stats;\n\n\t \n\tstruct net_device napi_dev;\n\tstruct napi_struct napi;\n\n\tstruct work_struct set_coverage_class_work;\n\t \n\tstruct {\n\t\t \n\t\ts16 coverage_class;\n\n\t\tu32 reg_phyclk;\n\t\tu32 reg_slottime_conf;\n\t\tu32 reg_slottime_orig;\n\t\tu32 reg_ack_cts_timeout_conf;\n\t\tu32 reg_ack_cts_timeout_orig;\n\t} fw_coverage;\n\n\tu32 ampdu_reference;\n\n\tconst u8 *wmi_key_cipher;\n\tvoid *ce_priv;\n\n\tu32 sta_tid_stats_mask;\n\n\t \n\tenum ath10k_radar_confirmation_state radar_conf_state;\n\tstruct ath10k_radar_found_info last_radar_info;\n\tstruct work_struct radar_confirmation_work;\n\tstruct ath10k_bus_params bus_param;\n\tstruct completion peer_delete_done;\n\n\tbool coex_support;\n\tint coex_gpio_pin;\n\n\ts32 tx_power_2g_limit;\n\ts32 tx_power_5g_limit;\n\n\t \n\tu8 drv_priv[] __aligned(sizeof(void *));\n};\n\nstatic inline bool ath10k_peer_stats_enabled(struct ath10k *ar)\n{\n\tif (test_bit(ATH10K_FLAG_PEER_STATS, &ar->dev_flags) &&\n\t    test_bit(WMI_SERVICE_PEER_STATS, ar->wmi.svc_map))\n\t\treturn true;\n\n\treturn false;\n}\n\nextern unsigned int ath10k_frame_mode;\nextern unsigned long ath10k_coredump_mask;\n\nvoid ath10k_core_napi_sync_disable(struct ath10k *ar);\nvoid ath10k_core_napi_enable(struct ath10k *ar);\nstruct ath10k *ath10k_core_create(size_t priv_size, struct device *dev,\n\t\t\t\t  enum ath10k_bus bus,\n\t\t\t\t  enum ath10k_hw_rev hw_rev,\n\t\t\t\t  const struct ath10k_hif_ops *hif_ops);\nvoid ath10k_core_destroy(struct ath10k *ar);\nvoid ath10k_core_get_fw_features_str(struct ath10k *ar,\n\t\t\t\t     char *buf,\n\t\t\t\t     size_t max_len);\nint ath10k_core_fetch_firmware_api_n(struct ath10k *ar, const char *name,\n\t\t\t\t     struct ath10k_fw_file *fw_file);\n\nint ath10k_core_start(struct ath10k *ar, enum ath10k_firmware_mode mode,\n\t\t      const struct ath10k_fw_components *fw_components);\nint ath10k_wait_for_suspend(struct ath10k *ar, u32 suspend_opt);\nvoid ath10k_core_stop(struct ath10k *ar);\nvoid ath10k_core_start_recovery(struct ath10k *ar);\nint ath10k_core_register(struct ath10k *ar,\n\t\t\t const struct ath10k_bus_params *bus_params);\nvoid ath10k_core_unregister(struct ath10k *ar);\nint ath10k_core_fetch_board_file(struct ath10k *ar, int bd_ie_type);\nint ath10k_core_check_dt(struct ath10k *ar);\nvoid ath10k_core_free_board_files(struct ath10k *ar);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}