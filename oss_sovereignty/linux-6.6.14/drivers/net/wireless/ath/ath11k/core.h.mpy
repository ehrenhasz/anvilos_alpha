{
  "module_name": "core.h",
  "hash_id": "54c98a2528b5ff037288e858844bd614eef32b0f9da9c743071241753b28d2a4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath11k/core.h",
  "human_readable_source": " \n \n\n#ifndef ATH11K_CORE_H\n#define ATH11K_CORE_H\n\n#include <linux/types.h>\n#include <linux/interrupt.h>\n#include <linux/irq.h>\n#include <linux/bitfield.h>\n#include <linux/dmi.h>\n#include <linux/ctype.h>\n#include <linux/rhashtable.h>\n#include <linux/average.h>\n#include \"qmi.h\"\n#include \"htc.h\"\n#include \"wmi.h\"\n#include \"hal.h\"\n#include \"dp.h\"\n#include \"ce.h\"\n#include \"mac.h\"\n#include \"hw.h\"\n#include \"hal_rx.h\"\n#include \"reg.h\"\n#include \"thermal.h\"\n#include \"dbring.h\"\n#include \"spectral.h\"\n#include \"wow.h\"\n\n#define SM(_v, _f) (((_v) << _f##_LSB) & _f##_MASK)\n\n#define ATH11K_TX_MGMT_NUM_PENDING_MAX\t512\n\n#define ATH11K_TX_MGMT_TARGET_MAX_SUPPORT_WMI 64\n\n \n#define ATH11K_PRB_RSP_DROP_THRESHOLD ((ATH11K_TX_MGMT_TARGET_MAX_SUPPORT_WMI * 3) / 4)\n\n#define ATH11K_INVALID_HW_MAC_ID\t0xFF\n#define ATH11K_CONNECTION_LOSS_HZ\t(3 * HZ)\n\n \n#define ATH11K_SMBIOS_BDF_EXT_TYPE 0xF8\n\n \n#define ATH11K_SMBIOS_BDF_EXT_LENGTH 0x9\n\n \n#define ATH11K_SMBIOS_BDF_EXT_MAGIC \"BDF_\"\n\nextern unsigned int ath11k_frame_mode;\nextern bool ath11k_ftm_mode;\n\n#define ATH11K_SCAN_TIMEOUT_HZ (20 * HZ)\n\n#define ATH11K_MON_TIMER_INTERVAL  10\n#define ATH11K_RESET_TIMEOUT_HZ (20 * HZ)\n#define ATH11K_RESET_MAX_FAIL_COUNT_FIRST 3\n#define ATH11K_RESET_MAX_FAIL_COUNT_FINAL 5\n#define ATH11K_RESET_FAIL_TIMEOUT_HZ (20 * HZ)\n#define ATH11K_RECONFIGURE_TIMEOUT_HZ (10 * HZ)\n#define ATH11K_RECOVER_START_TIMEOUT_HZ (20 * HZ)\n\nenum ath11k_supported_bw {\n\tATH11K_BW_20\t= 0,\n\tATH11K_BW_40\t= 1,\n\tATH11K_BW_80\t= 2,\n\tATH11K_BW_160\t= 3,\n};\n\nenum ath11k_bdf_search {\n\tATH11K_BDF_SEARCH_DEFAULT,\n\tATH11K_BDF_SEARCH_BUS_AND_BOARD,\n};\n\nenum wme_ac {\n\tWME_AC_BE,\n\tWME_AC_BK,\n\tWME_AC_VI,\n\tWME_AC_VO,\n\tWME_NUM_AC\n};\n\n#define ATH11K_HT_MCS_MAX\t7\n#define ATH11K_VHT_MCS_MAX\t9\n#define ATH11K_HE_MCS_MAX\t11\n\nenum ath11k_crypt_mode {\n\t \n\tATH11K_CRYPT_MODE_HW,\n\t \n\tATH11K_CRYPT_MODE_SW,\n};\n\nstatic inline enum wme_ac ath11k_tid_to_ac(u32 tid)\n{\n\treturn (((tid == 0) || (tid == 3)) ? WME_AC_BE :\n\t\t((tid == 1) || (tid == 2)) ? WME_AC_BK :\n\t\t((tid == 4) || (tid == 5)) ? WME_AC_VI :\n\t\tWME_AC_VO);\n}\n\nenum ath11k_skb_flags {\n\tATH11K_SKB_HW_80211_ENCAP = BIT(0),\n\tATH11K_SKB_CIPHER_SET = BIT(1),\n};\n\nstruct ath11k_skb_cb {\n\tdma_addr_t paddr;\n\tu8 eid;\n\tu8 flags;\n\tu32 cipher;\n\tstruct ath11k *ar;\n\tstruct ieee80211_vif *vif;\n} __packed;\n\nstruct ath11k_skb_rxcb {\n\tdma_addr_t paddr;\n\tbool is_first_msdu;\n\tbool is_last_msdu;\n\tbool is_continuation;\n\tbool is_mcbc;\n\tbool is_eapol;\n\tstruct hal_rx_desc *rx_desc;\n\tu8 err_rel_src;\n\tu8 err_code;\n\tu8 mac_id;\n\tu8 unmapped;\n\tu8 is_frag;\n\tu8 tid;\n\tu16 peer_id;\n\tu16 seq_no;\n};\n\nenum ath11k_hw_rev {\n\tATH11K_HW_IPQ8074,\n\tATH11K_HW_QCA6390_HW20,\n\tATH11K_HW_IPQ6018_HW10,\n\tATH11K_HW_QCN9074_HW10,\n\tATH11K_HW_WCN6855_HW20,\n\tATH11K_HW_WCN6855_HW21,\n\tATH11K_HW_WCN6750_HW10,\n\tATH11K_HW_IPQ5018_HW10,\n};\n\nenum ath11k_firmware_mode {\n\t \n\tATH11K_FIRMWARE_MODE_NORMAL,\n\n\t \n\tATH11K_FIRMWARE_MODE_FTM,\n\n\t \n\tATH11K_FIRMWARE_MODE_COLD_BOOT = 7,\n};\n\nextern bool ath11k_cold_boot_cal;\n\n#define ATH11K_IRQ_NUM_MAX 52\n#define ATH11K_EXT_IRQ_NUM_MAX\t16\n\nstruct ath11k_ext_irq_grp {\n\tstruct ath11k_base *ab;\n\tu32 irqs[ATH11K_EXT_IRQ_NUM_MAX];\n\tu32 num_irq;\n\tu32 grp_id;\n\tu64 timestamp;\n\tbool napi_enabled;\n\tstruct napi_struct napi;\n\tstruct net_device napi_ndev;\n};\n\nenum ath11k_smbios_cc_type {\n\t \n\tATH11K_SMBIOS_CC_DISABLE = 0,\n\n\t \n\tATH11K_SMBIOS_CC_ISO = 1,\n\n\t \n\tATH11K_SMBIOS_CC_WW = 2,\n};\n\nstruct ath11k_smbios_bdf {\n\tstruct dmi_header hdr;\n\n\tu8 features_disabled;\n\n\t \n\tu8 country_code_flag;\n\n\t \n\tu16 cc_code;\n\n\tu8 bdf_enabled;\n\tu8 bdf_ext[];\n} __packed;\n\n#define HEHANDLE_CAP_PHYINFO_SIZE       3\n#define HECAP_PHYINFO_SIZE              9\n#define HECAP_MACINFO_SIZE              5\n#define HECAP_TXRX_MCS_NSS_SIZE         2\n#define HECAP_PPET16_PPET8_MAX_SIZE     25\n\n#define HE_PPET16_PPET8_SIZE            8\n\n \nstruct he_ppe_threshold {\n\tu32 numss_m1;\n\tu32 ru_mask;\n\tu32 ppet16_ppet8_ru3_ru0[HE_PPET16_PPET8_SIZE];\n};\n\nstruct ath11k_he {\n\tu8 hecap_macinfo[HECAP_MACINFO_SIZE];\n\tu32 hecap_rxmcsnssmap;\n\tu32 hecap_txmcsnssmap;\n\tu32 hecap_phyinfo[HEHANDLE_CAP_PHYINFO_SIZE];\n\tstruct he_ppe_threshold   hecap_ppet;\n\tu32 heop_param;\n};\n\n#define MAX_RADIOS 3\n\n \n#define MAX_RADIOS_5018\t1\n#define CE_CNT_5018\t6\n#define TARGET_CE_CNT_5018\t9\n#define SVC_CE_MAP_LEN_5018\t17\n#define RXDMA_PER_PDEV_5018\t1\n\nenum {\n\tWMI_HOST_TP_SCALE_MAX   = 0,\n\tWMI_HOST_TP_SCALE_50    = 1,\n\tWMI_HOST_TP_SCALE_25    = 2,\n\tWMI_HOST_TP_SCALE_12    = 3,\n\tWMI_HOST_TP_SCALE_MIN   = 4,\n\tWMI_HOST_TP_SCALE_SIZE   = 5,\n};\n\nenum ath11k_scan_state {\n\tATH11K_SCAN_IDLE,\n\tATH11K_SCAN_STARTING,\n\tATH11K_SCAN_RUNNING,\n\tATH11K_SCAN_ABORTING,\n};\n\nenum ath11k_11d_state {\n\tATH11K_11D_IDLE,\n\tATH11K_11D_PREPARING,\n\tATH11K_11D_RUNNING,\n};\n\nenum ath11k_dev_flags {\n\tATH11K_CAC_RUNNING,\n\tATH11K_FLAG_CORE_REGISTERED,\n\tATH11K_FLAG_CRASH_FLUSH,\n\tATH11K_FLAG_RAW_MODE,\n\tATH11K_FLAG_HW_CRYPTO_DISABLED,\n\tATH11K_FLAG_BTCOEX,\n\tATH11K_FLAG_RECOVERY,\n\tATH11K_FLAG_UNREGISTERING,\n\tATH11K_FLAG_REGISTERED,\n\tATH11K_FLAG_QMI_FAIL,\n\tATH11K_FLAG_HTC_SUSPEND_COMPLETE,\n\tATH11K_FLAG_CE_IRQ_ENABLED,\n\tATH11K_FLAG_EXT_IRQ_ENABLED,\n\tATH11K_FLAG_FIXED_MEM_RGN,\n\tATH11K_FLAG_DEVICE_INIT_DONE,\n\tATH11K_FLAG_MULTI_MSI_VECTORS,\n\tATH11K_FLAG_FTM_SEGMENTED,\n};\n\nenum ath11k_monitor_flags {\n\tATH11K_FLAG_MONITOR_CONF_ENABLED,\n\tATH11K_FLAG_MONITOR_STARTED,\n\tATH11K_FLAG_MONITOR_VDEV_CREATED,\n};\n\n#define ATH11K_IPV6_UC_TYPE     0\n#define ATH11K_IPV6_AC_TYPE     1\n\n#define ATH11K_IPV6_MAX_COUNT   16\n#define ATH11K_IPV4_MAX_COUNT   2\n\nstruct ath11k_arp_ns_offload {\n\tu8  ipv4_addr[ATH11K_IPV4_MAX_COUNT][4];\n\tu32 ipv4_count;\n\tu32 ipv6_count;\n\tu8  ipv6_addr[ATH11K_IPV6_MAX_COUNT][16];\n\tu8  self_ipv6_addr[ATH11K_IPV6_MAX_COUNT][16];\n\tu8  ipv6_type[ATH11K_IPV6_MAX_COUNT];\n\tbool ipv6_valid[ATH11K_IPV6_MAX_COUNT];\n\tu8  mac_addr[ETH_ALEN];\n};\n\nstruct ath11k_rekey_data {\n\tu8 kck[NL80211_KCK_LEN];\n\tu8 kek[NL80211_KCK_LEN];\n\tu64 replay_ctr;\n\tbool enable_offload;\n};\n\nstruct ath11k_vif {\n\tu32 vdev_id;\n\tenum wmi_vdev_type vdev_type;\n\tenum wmi_vdev_subtype vdev_subtype;\n\tu32 beacon_interval;\n\tu32 dtim_period;\n\tu16 ast_hash;\n\tu16 ast_idx;\n\tu16 tcl_metadata;\n\tu8 hal_addr_search_flags;\n\tu8 search_type;\n\n\tstruct ath11k *ar;\n\tstruct ieee80211_vif *vif;\n\n\tu16 tx_seq_no;\n\tstruct wmi_wmm_params_all_arg wmm_params;\n\tstruct list_head list;\n\tunion {\n\t\tstruct {\n\t\t\tu32 uapsd;\n\t\t} sta;\n\t\tstruct {\n\t\t\t \n\t\t\tu8 tim_bitmap[16];\n\t\t\tu8 tim_len;\n\t\t\tu32 ssid_len;\n\t\t\tu8 ssid[IEEE80211_MAX_SSID_LEN];\n\t\t\tbool hidden_ssid;\n\t\t\t \n\t\t\tu32 noa_len;\n\t\t\tu8 *noa_data;\n\t\t} ap;\n\t} u;\n\n\tbool is_started;\n\tbool is_up;\n\tbool ftm_responder;\n\tbool spectral_enabled;\n\tbool ps;\n\tu32 aid;\n\tu8 bssid[ETH_ALEN];\n\tstruct cfg80211_bitrate_mask bitrate_mask;\n\tstruct delayed_work connection_loss_work;\n\tint num_legacy_stations;\n\tint rtscts_prot_mode;\n\tint txpower;\n\tbool rsnie_present;\n\tbool wpaie_present;\n\tbool bcca_zero_sent;\n\tbool do_not_send_tmpl;\n\tstruct ieee80211_chanctx_conf chanctx;\n\tstruct ath11k_arp_ns_offload arp_ns_offload;\n\tstruct ath11k_rekey_data rekey_data;\n\n#ifdef CONFIG_ATH11K_DEBUGFS\n\tstruct dentry *debugfs_twt;\n#endif  \n};\n\nstruct ath11k_vif_iter {\n\tu32 vdev_id;\n\tstruct ath11k_vif *arvif;\n};\n\nstruct ath11k_rx_peer_stats {\n\tu64 num_msdu;\n\tu64 num_mpdu_fcs_ok;\n\tu64 num_mpdu_fcs_err;\n\tu64 tcp_msdu_count;\n\tu64 udp_msdu_count;\n\tu64 other_msdu_count;\n\tu64 ampdu_msdu_count;\n\tu64 non_ampdu_msdu_count;\n\tu64 stbc_count;\n\tu64 beamformed_count;\n\tu64 mcs_count[HAL_RX_MAX_MCS + 1];\n\tu64 nss_count[HAL_RX_MAX_NSS];\n\tu64 bw_count[HAL_RX_BW_MAX];\n\tu64 gi_count[HAL_RX_GI_MAX];\n\tu64 coding_count[HAL_RX_SU_MU_CODING_MAX];\n\tu64 tid_count[IEEE80211_NUM_TIDS + 1];\n\tu64 pream_cnt[HAL_RX_PREAMBLE_MAX];\n\tu64 reception_type[HAL_RX_RECEPTION_TYPE_MAX];\n\tu64 rx_duration;\n\tu64 dcm_count;\n\tu64 ru_alloc_cnt[HAL_RX_RU_ALLOC_TYPE_MAX];\n};\n\n#define ATH11K_HE_MCS_NUM       12\n#define ATH11K_VHT_MCS_NUM      10\n#define ATH11K_BW_NUM           4\n#define ATH11K_NSS_NUM          4\n#define ATH11K_LEGACY_NUM       12\n#define ATH11K_GI_NUM           4\n#define ATH11K_HT_MCS_NUM       32\n\nenum ath11k_pkt_rx_err {\n\tATH11K_PKT_RX_ERR_FCS,\n\tATH11K_PKT_RX_ERR_TKIP,\n\tATH11K_PKT_RX_ERR_CRYPT,\n\tATH11K_PKT_RX_ERR_PEER_IDX_INVAL,\n\tATH11K_PKT_RX_ERR_MAX,\n};\n\nenum ath11k_ampdu_subfrm_num {\n\tATH11K_AMPDU_SUBFRM_NUM_10,\n\tATH11K_AMPDU_SUBFRM_NUM_20,\n\tATH11K_AMPDU_SUBFRM_NUM_30,\n\tATH11K_AMPDU_SUBFRM_NUM_40,\n\tATH11K_AMPDU_SUBFRM_NUM_50,\n\tATH11K_AMPDU_SUBFRM_NUM_60,\n\tATH11K_AMPDU_SUBFRM_NUM_MORE,\n\tATH11K_AMPDU_SUBFRM_NUM_MAX,\n};\n\nenum ath11k_amsdu_subfrm_num {\n\tATH11K_AMSDU_SUBFRM_NUM_1,\n\tATH11K_AMSDU_SUBFRM_NUM_2,\n\tATH11K_AMSDU_SUBFRM_NUM_3,\n\tATH11K_AMSDU_SUBFRM_NUM_4,\n\tATH11K_AMSDU_SUBFRM_NUM_MORE,\n\tATH11K_AMSDU_SUBFRM_NUM_MAX,\n};\n\nenum ath11k_counter_type {\n\tATH11K_COUNTER_TYPE_BYTES,\n\tATH11K_COUNTER_TYPE_PKTS,\n\tATH11K_COUNTER_TYPE_MAX,\n};\n\nenum ath11k_stats_type {\n\tATH11K_STATS_TYPE_SUCC,\n\tATH11K_STATS_TYPE_FAIL,\n\tATH11K_STATS_TYPE_RETRY,\n\tATH11K_STATS_TYPE_AMPDU,\n\tATH11K_STATS_TYPE_MAX,\n};\n\nstruct ath11k_htt_data_stats {\n\tu64 legacy[ATH11K_COUNTER_TYPE_MAX][ATH11K_LEGACY_NUM];\n\tu64 ht[ATH11K_COUNTER_TYPE_MAX][ATH11K_HT_MCS_NUM];\n\tu64 vht[ATH11K_COUNTER_TYPE_MAX][ATH11K_VHT_MCS_NUM];\n\tu64 he[ATH11K_COUNTER_TYPE_MAX][ATH11K_HE_MCS_NUM];\n\tu64 bw[ATH11K_COUNTER_TYPE_MAX][ATH11K_BW_NUM];\n\tu64 nss[ATH11K_COUNTER_TYPE_MAX][ATH11K_NSS_NUM];\n\tu64 gi[ATH11K_COUNTER_TYPE_MAX][ATH11K_GI_NUM];\n};\n\nstruct ath11k_htt_tx_stats {\n\tstruct ath11k_htt_data_stats stats[ATH11K_STATS_TYPE_MAX];\n\tu64 tx_duration;\n\tu64 ba_fails;\n\tu64 ack_fails;\n};\n\nstruct ath11k_per_ppdu_tx_stats {\n\tu16 succ_pkts;\n\tu16 failed_pkts;\n\tu16 retry_pkts;\n\tu32 succ_bytes;\n\tu32 failed_bytes;\n\tu32 retry_bytes;\n};\n\nDECLARE_EWMA(avg_rssi, 10, 8)\n\nstruct ath11k_sta {\n\tstruct ath11k_vif *arvif;\n\n\t \n\tu32 changed;  \n\tu32 bw;\n\tu32 nss;\n\tu32 smps;\n\tenum hal_pn_type pn_type;\n\n\tstruct work_struct update_wk;\n\tstruct work_struct set_4addr_wk;\n\tstruct rate_info txrate;\n\tu32 peer_nss;\n\tstruct rate_info last_txrate;\n\tu64 rx_duration;\n\tu64 tx_duration;\n\tu8 rssi_comb;\n\tstruct ewma_avg_rssi avg_rssi;\n\ts8 rssi_beacon;\n\ts8 chain_signal[IEEE80211_MAX_CHAINS];\n\tstruct ath11k_htt_tx_stats *tx_stats;\n\tstruct ath11k_rx_peer_stats *rx_stats;\n\n#ifdef CONFIG_MAC80211_DEBUGFS\n\t \n\tbool aggr_mode;\n#endif\n\n\tbool use_4addr_set;\n\tu16 tcl_metadata;\n\n\t \n\tenum ath11k_wmi_peer_ps_state peer_ps_state;\n\tu64 ps_start_time;\n\tu64 ps_start_jiffies;\n\tu64 ps_total_duration;\n\tbool peer_current_ps_valid;\n\n\tu32 bw_prev;\n};\n\n#define ATH11K_MIN_5G_FREQ 4150\n#define ATH11K_MIN_6G_FREQ 5925\n#define ATH11K_MAX_6G_FREQ 7115\n#define ATH11K_NUM_CHANS 102\n#define ATH11K_MAX_5G_CHAN 177\n\nenum ath11k_state {\n\tATH11K_STATE_OFF,\n\tATH11K_STATE_ON,\n\tATH11K_STATE_RESTARTING,\n\tATH11K_STATE_RESTARTED,\n\tATH11K_STATE_WEDGED,\n\tATH11K_STATE_FTM,\n\t \n};\n\n \n#define ATH11K_DEFAULT_NOISE_FLOOR -95\n\n#define ATH11K_INVALID_RSSI_FULL -1\n\n#define ATH11K_INVALID_RSSI_EMPTY -128\n\nstruct ath11k_fw_stats {\n\tstruct dentry *debugfs_fwstats;\n\tu32 pdev_id;\n\tu32 stats_id;\n\tstruct list_head pdevs;\n\tstruct list_head vdevs;\n\tstruct list_head bcn;\n};\n\nstruct ath11k_dbg_htt_stats {\n\tu8 type;\n\tu8 reset;\n\tstruct debug_htt_stats_req *stats_req;\n\t \n\tspinlock_t lock;\n};\n\n#define MAX_MODULE_ID_BITMAP_WORDS\t16\n\nstruct ath11k_debug {\n\tstruct dentry *debugfs_pdev;\n\tstruct ath11k_dbg_htt_stats htt_stats;\n\tu32 extd_tx_stats;\n\tu32 extd_rx_stats;\n\tu32 pktlog_filter;\n\tu32 pktlog_mode;\n\tu32 pktlog_peer_valid;\n\tu8 pktlog_peer_addr[ETH_ALEN];\n\tu32 rx_filter;\n\tu32 mem_offset;\n\tu32 module_id_bitmap[MAX_MODULE_ID_BITMAP_WORDS];\n\tstruct ath11k_debug_dbr *dbr_debug[WMI_DIRECT_BUF_MAX];\n};\n\nstruct ath11k_per_peer_tx_stats {\n\tu32 succ_bytes;\n\tu32 retry_bytes;\n\tu32 failed_bytes;\n\tu16 succ_pkts;\n\tu16 retry_pkts;\n\tu16 failed_pkts;\n\tu32 duration;\n\tu8 ba_fails;\n\tbool is_ampdu;\n};\n\n#define ATH11K_FLUSH_TIMEOUT (5 * HZ)\n#define ATH11K_VDEV_DELETE_TIMEOUT_HZ (5 * HZ)\n\nstruct ath11k {\n\tstruct ath11k_base *ab;\n\tstruct ath11k_pdev *pdev;\n\tstruct ieee80211_hw *hw;\n\tstruct ieee80211_ops *ops;\n\tstruct ath11k_pdev_wmi *wmi;\n\tstruct ath11k_pdev_dp dp;\n\tu8 mac_addr[ETH_ALEN];\n\tstruct ath11k_he ar_he;\n\tenum ath11k_state state;\n\tbool supports_6ghz;\n\tstruct {\n\t\tstruct completion started;\n\t\tstruct completion completed;\n\t\tstruct completion on_channel;\n\t\tstruct delayed_work timeout;\n\t\tenum ath11k_scan_state state;\n\t\tbool is_roc;\n\t\tint vdev_id;\n\t\tint roc_freq;\n\t\tbool roc_notify;\n\t} scan;\n\n\tstruct {\n\t\tstruct ieee80211_supported_band sbands[NUM_NL80211_BANDS];\n\t\tstruct ieee80211_sband_iftype_data\n\t\t\tiftype[NUM_NL80211_BANDS][NUM_NL80211_IFTYPES];\n\t} mac;\n\n\tunsigned long dev_flags;\n\tunsigned int filter_flags;\n\tunsigned long monitor_flags;\n\tu32 min_tx_power;\n\tu32 max_tx_power;\n\tu32 txpower_limit_2g;\n\tu32 txpower_limit_5g;\n\tu32 txpower_scale;\n\tu32 power_scale;\n\tu32 chan_tx_pwr;\n\tu32 num_stations;\n\tu32 max_num_stations;\n\t \n\tstruct mutex conf_mutex;\n\t \n\tspinlock_t data_lock;\n\n\tstruct list_head arvifs;\n\t \n\tstruct ieee80211_channel *rx_channel;\n\n\t \n\tstruct ieee80211_channel *scan_channel;\n\n\tu8 cfg_tx_chainmask;\n\tu8 cfg_rx_chainmask;\n\tu8 num_rx_chains;\n\tu8 num_tx_chains;\n\t \n\tu8 pdev_idx;\n\tu8 lmac_id;\n\n\tstruct completion peer_assoc_done;\n\tstruct completion peer_delete_done;\n\n\tint install_key_status;\n\tstruct completion install_key_done;\n\n\tint last_wmi_vdev_start_status;\n\tstruct completion vdev_setup_done;\n\tstruct completion vdev_delete_done;\n\n\tint num_peers;\n\tint max_num_peers;\n\tu32 num_started_vdevs;\n\tu32 num_created_vdevs;\n\tunsigned long long allocated_vdev_map;\n\n\tstruct idr txmgmt_idr;\n\t \n\tspinlock_t txmgmt_idr_lock;\n\tatomic_t num_pending_mgmt_tx;\n\twait_queue_head_t txmgmt_empty_waitq;\n\n\t \n\tu32 survey_last_rx_clear_count;\n\tu32 survey_last_cycle_count;\n\n\t \n\tbool ch_info_can_report_survey;\n\tstruct survey_info survey[ATH11K_NUM_CHANS];\n\tstruct completion bss_survey_done;\n\n\tstruct work_struct regd_update_work;\n\n\tstruct work_struct wmi_mgmt_tx_work;\n\tstruct sk_buff_head wmi_mgmt_tx_queue;\n\n\tstruct ath11k_wow wow;\n\tstruct completion target_suspend;\n\tbool target_suspend_ack;\n\tstruct ath11k_per_peer_tx_stats peer_tx_stats;\n\tstruct list_head ppdu_stats_info;\n\tu32 ppdu_stat_list_depth;\n\n\tstruct ath11k_per_peer_tx_stats cached_stats;\n\tu32 last_ppdu_id;\n\tu32 cached_ppdu_id;\n\tint monitor_vdev_id;\n\tstruct completion fw_mode_reset;\n\tu8 ftm_msgref;\n#ifdef CONFIG_ATH11K_DEBUGFS\n\tstruct ath11k_debug debug;\n#endif\n#ifdef CONFIG_ATH11K_SPECTRAL\n\tstruct ath11k_spectral spectral;\n#endif\n\tbool dfs_block_radar_events;\n\tstruct ath11k_thermal thermal;\n\tu32 vdev_id_11d_scan;\n\tstruct completion completed_11d_scan;\n\tenum ath11k_11d_state state_11d;\n\tbool regdom_set_by_user;\n\tint hw_rate_code;\n\tu8 twt_enabled;\n\tbool nlo_enabled;\n\tu8 alpha2[REG_ALPHA2_LEN + 1];\n\tstruct ath11k_fw_stats fw_stats;\n\tstruct completion fw_stats_complete;\n\tbool fw_stats_done;\n\n\t \n\tbool ps_state_enable;\n\tbool ps_timekeeper_enable;\n};\n\nstruct ath11k_band_cap {\n\tu32 phy_id;\n\tu32 max_bw_supported;\n\tu32 ht_cap_info;\n\tu32 he_cap_info[2];\n\tu32 he_mcs;\n\tu32 he_cap_phy_info[PSOC_HOST_MAX_PHY_SIZE];\n\tstruct ath11k_ppe_threshold he_ppet;\n\tu16 he_6ghz_capa;\n};\n\nstruct ath11k_pdev_cap {\n\tu32 supported_bands;\n\tu32 ampdu_density;\n\tu32 vht_cap;\n\tu32 vht_mcs;\n\tu32 he_mcs;\n\tu32 tx_chain_mask;\n\tu32 rx_chain_mask;\n\tu32 tx_chain_mask_shift;\n\tu32 rx_chain_mask_shift;\n\tstruct ath11k_band_cap band[NUM_NL80211_BANDS];\n\tbool nss_ratio_enabled;\n\tu8 nss_ratio_info;\n};\n\nstruct ath11k_pdev {\n\tstruct ath11k *ar;\n\tu32 pdev_id;\n\tstruct ath11k_pdev_cap cap;\n\tu8 mac_addr[ETH_ALEN];\n};\n\nstruct ath11k_board_data {\n\tconst struct firmware *fw;\n\tconst void *data;\n\tsize_t len;\n};\n\nstruct ath11k_pci_ops {\n\tint (*wakeup)(struct ath11k_base *ab);\n\tvoid (*release)(struct ath11k_base *ab);\n\tint (*get_msi_irq)(struct ath11k_base *ab, unsigned int vector);\n\tvoid (*window_write32)(struct ath11k_base *ab, u32 offset, u32 value);\n\tu32 (*window_read32)(struct ath11k_base *ab, u32 offset);\n};\n\n \n#define IPQ8074_CC_FREQ_HERTZ 320000\n\nstruct ath11k_bp_stats {\n\t \n\tu16 hp;\n\n\t \n\tu16 tp;\n\n\t \n\tu32 count;\n\n\t \n\tunsigned long jiffies;\n};\n\nstruct ath11k_dp_ring_bp_stats {\n\tstruct ath11k_bp_stats umac_ring_bp_stats[HTT_SW_UMAC_RING_IDX_MAX];\n\tstruct ath11k_bp_stats lmac_ring_bp_stats[HTT_SW_LMAC_RING_IDX_MAX][MAX_RADIOS];\n};\n\nstruct ath11k_soc_dp_tx_err_stats {\n\t \n\tu32 desc_na[DP_TCL_NUM_RING_MAX];\n\t \n\tatomic_t misc_fail;\n};\n\nstruct ath11k_soc_dp_stats {\n\tu32 err_ring_pkts;\n\tu32 invalid_rbm;\n\tu32 rxdma_error[HAL_REO_ENTR_RING_RXDMA_ECODE_MAX];\n\tu32 reo_error[HAL_REO_DEST_RING_ERROR_CODE_MAX];\n\tu32 hal_reo_error[DP_REO_DST_RING_MAX];\n\tstruct ath11k_soc_dp_tx_err_stats tx_err;\n\tstruct ath11k_dp_ring_bp_stats bp_stats;\n};\n\nstruct ath11k_msi_user {\n\tchar *name;\n\tint num_vectors;\n\tu32 base_vector;\n};\n\nstruct ath11k_msi_config {\n\tint total_vectors;\n\tint total_users;\n\tstruct ath11k_msi_user *users;\n\tu16 hw_rev;\n};\n\n \nstruct ath11k_base {\n\tenum ath11k_hw_rev hw_rev;\n\tenum ath11k_firmware_mode fw_mode;\n\tstruct platform_device *pdev;\n\tstruct device *dev;\n\tstruct ath11k_qmi qmi;\n\tstruct ath11k_wmi_base wmi_ab;\n\tstruct completion fw_ready;\n\tint num_radios;\n\t \n\tu32 cc_freq_hz;\n\n\tstruct ath11k_htc htc;\n\n\tstruct ath11k_dp dp;\n\n\tvoid __iomem *mem;\n\tvoid __iomem *mem_ce;\n\tunsigned long mem_len;\n\n\tstruct {\n\t\tenum ath11k_bus bus;\n\t\tconst struct ath11k_hif_ops *ops;\n\t} hif;\n\n\tstruct {\n\t\tstruct completion wakeup_completed;\n\t} wow;\n\n\tstruct ath11k_ce ce;\n\tstruct timer_list rx_replenish_retry;\n\tstruct ath11k_hal hal;\n\t \n\tstruct mutex core_lock;\n\t \n\tspinlock_t base_lock;\n\tstruct ath11k_pdev pdevs[MAX_RADIOS];\n\tstruct {\n\t\tenum WMI_HOST_WLAN_BAND supported_bands;\n\t\tu32 pdev_id;\n\t} target_pdev_ids[MAX_RADIOS];\n\tu8 target_pdev_count;\n\tstruct ath11k_pdev __rcu *pdevs_active[MAX_RADIOS];\n\tstruct ath11k_hal_reg_capabilities_ext hal_reg_cap[MAX_RADIOS];\n\tunsigned long long free_vdev_map;\n\n\t \n\tstruct mutex tbl_mtx_lock;\n\n\t \n\tstruct rhashtable *rhead_peer_addr;\n\tstruct rhashtable_params rhash_peer_addr_param;\n\n\t \n\tstruct rhashtable *rhead_peer_id;\n\tstruct rhashtable_params rhash_peer_id_param;\n\n\tstruct list_head peers;\n\twait_queue_head_t peer_mapping_wq;\n\tu8 mac_addr[ETH_ALEN];\n\tbool wmi_ready;\n\tu32 wlan_init_status;\n\tint irq_num[ATH11K_IRQ_NUM_MAX];\n\tstruct ath11k_ext_irq_grp ext_irq_grp[ATH11K_EXT_IRQ_GRP_NUM_MAX];\n\tstruct ath11k_targ_cap target_caps;\n\tu32 ext_service_bitmap[WMI_SERVICE_EXT_BM_SIZE];\n\tbool pdevs_macaddr_valid;\n\tint bd_api;\n\n\tstruct ath11k_hw_params hw_params;\n\n\tconst struct firmware *cal_file;\n\n\t \n\t \n\tstruct ieee80211_regdomain *default_regd[MAX_RADIOS];\n\t \n\tstruct ieee80211_regdomain *new_regd[MAX_RADIOS];\n\n\t \n\tenum ath11k_dfs_region dfs_region;\n#ifdef CONFIG_ATH11K_DEBUGFS\n\tstruct dentry *debugfs_soc;\n#endif\n\tstruct ath11k_soc_dp_stats soc_stats;\n\n\tunsigned long dev_flags;\n\tstruct completion driver_recovery;\n\tstruct workqueue_struct *workqueue;\n\tstruct work_struct restart_work;\n\tstruct work_struct update_11d_work;\n\tu8 new_alpha2[3];\n\tstruct workqueue_struct *workqueue_aux;\n\tstruct work_struct reset_work;\n\tatomic_t reset_count;\n\tatomic_t recovery_count;\n\tatomic_t recovery_start_count;\n\tbool is_reset;\n\tstruct completion reset_complete;\n\tstruct completion reconfigure_complete;\n\tstruct completion recovery_start;\n\t \n\tatomic_t fail_cont_count;\n\tunsigned long reset_fail_timeout;\n\tstruct {\n\t\t \n\t\tu32 fw_crash_counter;\n\t} stats;\n\tu32 pktlog_defs_checksum;\n\n\tstruct ath11k_dbring_cap *db_caps;\n\tu32 num_db_cap;\n\n\t \n\tstruct mutex vdev_id_11d_lock;\n\tstruct timer_list mon_reap_timer;\n\n\tstruct completion htc_suspend;\n\n\tstruct {\n\t\tenum ath11k_bdf_search bdf_search;\n\t\tu32 vendor;\n\t\tu32 device;\n\t\tu32 subsystem_vendor;\n\t\tu32 subsystem_device;\n\t} id;\n\n\tstruct {\n\t\tstruct {\n\t\t\tconst struct ath11k_msi_config *config;\n\t\t\tu32 ep_base_data;\n\t\t\tu32 irqs[32];\n\t\t\tu32 addr_lo;\n\t\t\tu32 addr_hi;\n\t\t} msi;\n\n\t\tconst struct ath11k_pci_ops *ops;\n\t} pci;\n\n#ifdef CONFIG_NL80211_TESTMODE\n\tstruct {\n\t\tu32 data_pos;\n\t\tu32 expected_seq;\n\t\tu8 *eventdata;\n\t} testmode;\n#endif\n\n\t \n\tu8 drv_priv[] __aligned(sizeof(void *));\n};\n\nstruct ath11k_fw_stats_pdev {\n\tstruct list_head list;\n\n\t \n\ts32 ch_noise_floor;\n\t \n\tu32 tx_frame_count;\n\t \n\tu32 rx_frame_count;\n\t \n\tu32 rx_clear_count;\n\t \n\tu32 cycle_count;\n\tu32 phy_err_count;\n\tu32 chan_tx_power;\n\tu32 ack_rx_bad;\n\tu32 rts_bad;\n\tu32 rts_good;\n\tu32 fcs_bad;\n\tu32 no_beacons;\n\tu32 mib_int_count;\n\n\t \n\t \n\ts32 comp_queued;\n\t \n\ts32 comp_delivered;\n\t \n\ts32 msdu_enqued;\n\t \n\ts32 mpdu_enqued;\n\t \n\ts32 wmm_drop;\n\t \n\ts32 local_enqued;\n\t \n\ts32 local_freed;\n\t \n\ts32 hw_queued;\n\t \n\ts32 hw_reaped;\n\t \n\ts32 underrun;\n\t \n\tu32 hw_paused;\n\t \n\ts32 tx_abort;\n\t \n\ts32 mpdus_requeued;\n\t \n\tu32 tx_ko;\n\tu32 tx_xretry;\n\t \n\tu32 data_rc;\n\t \n\tu32 self_triggers;\n\t \n\tu32 sw_retry_failure;\n\t \n\tu32 illgl_rate_phy_err;\n\t \n\tu32 pdev_cont_xretry;\n\t \n\tu32 pdev_tx_timeout;\n\t \n\tu32 pdev_resets;\n\t \n\tu32 stateless_tid_alloc_failure;\n\t \n\tu32 phy_underrun;\n\t \n\tu32 txop_ovf;\n\t \n\tu32 seq_posted;\n\t \n\tu32 seq_failed_queueing;\n\t \n\tu32 seq_completed;\n\t \n\tu32 seq_restarted;\n\t \n\tu32 mu_seq_posted;\n\t \n\ts32 mpdus_sw_flush;\n\t \n\ts32 mpdus_hw_filter;\n\t \n\ts32 mpdus_truncated;\n\t \n\ts32 mpdus_ack_failed;\n\t \n\ts32 mpdus_expired;\n\n\t \n\t \n\ts32 mid_ppdu_route_change;\n\t \n\ts32 status_rcvd;\n\t \n\ts32 r0_frags;\n\ts32 r1_frags;\n\ts32 r2_frags;\n\ts32 r3_frags;\n\t \n\ts32 htt_msdus;\n\ts32 htt_mpdus;\n\t \n\ts32 loc_msdus;\n\ts32 loc_mpdus;\n\t \n\ts32 oversize_amsdu;\n\t \n\ts32 phy_errs;\n\t \n\ts32 phy_err_drop;\n\t \n\ts32 mpdu_errs;\n\t \n\ts32 rx_ovfl_errs;\n};\n\nstruct ath11k_fw_stats_vdev {\n\tstruct list_head list;\n\n\tu32 vdev_id;\n\tu32 beacon_snr;\n\tu32 data_snr;\n\tu32 num_tx_frames[WLAN_MAX_AC];\n\tu32 num_rx_frames;\n\tu32 num_tx_frames_retries[WLAN_MAX_AC];\n\tu32 num_tx_frames_failures[WLAN_MAX_AC];\n\tu32 num_rts_fail;\n\tu32 num_rts_success;\n\tu32 num_rx_err;\n\tu32 num_rx_discard;\n\tu32 num_tx_not_acked;\n\tu32 tx_rate_history[MAX_TX_RATE_VALUES];\n\tu32 beacon_rssi_history[MAX_TX_RATE_VALUES];\n};\n\nstruct ath11k_fw_stats_bcn {\n\tstruct list_head list;\n\n\tu32 vdev_id;\n\tu32 tx_bcn_succ_cnt;\n\tu32 tx_bcn_outage_cnt;\n};\n\nvoid ath11k_fw_stats_init(struct ath11k *ar);\nvoid ath11k_fw_stats_pdevs_free(struct list_head *head);\nvoid ath11k_fw_stats_vdevs_free(struct list_head *head);\nvoid ath11k_fw_stats_bcn_free(struct list_head *head);\nvoid ath11k_fw_stats_free(struct ath11k_fw_stats *stats);\n\nextern const struct ce_pipe_config ath11k_target_ce_config_wlan_ipq8074[];\nextern const struct service_to_pipe ath11k_target_service_to_ce_map_wlan_ipq8074[];\nextern const struct service_to_pipe ath11k_target_service_to_ce_map_wlan_ipq6018[];\n\nextern const struct ce_pipe_config ath11k_target_ce_config_wlan_qca6390[];\nextern const struct service_to_pipe ath11k_target_service_to_ce_map_wlan_qca6390[];\n\nextern const struct ce_pipe_config ath11k_target_ce_config_wlan_ipq5018[];\nextern const struct service_to_pipe ath11k_target_service_to_ce_map_wlan_ipq5018[];\n\nextern const struct ce_pipe_config ath11k_target_ce_config_wlan_qcn9074[];\nextern const struct service_to_pipe ath11k_target_service_to_ce_map_wlan_qcn9074[];\nint ath11k_core_qmi_firmware_ready(struct ath11k_base *ab);\nint ath11k_core_pre_init(struct ath11k_base *ab);\nint ath11k_core_init(struct ath11k_base *ath11k);\nvoid ath11k_core_deinit(struct ath11k_base *ath11k);\nstruct ath11k_base *ath11k_core_alloc(struct device *dev, size_t priv_size,\n\t\t\t\t      enum ath11k_bus bus);\nvoid ath11k_core_free(struct ath11k_base *ath11k);\nint ath11k_core_fetch_bdf(struct ath11k_base *ath11k,\n\t\t\t  struct ath11k_board_data *bd);\nint ath11k_core_fetch_regdb(struct ath11k_base *ab, struct ath11k_board_data *bd);\nint ath11k_core_fetch_board_data_api_1(struct ath11k_base *ab,\n\t\t\t\t       struct ath11k_board_data *bd,\n\t\t\t\t       const char *name);\nvoid ath11k_core_free_bdf(struct ath11k_base *ab, struct ath11k_board_data *bd);\nint ath11k_core_check_dt(struct ath11k_base *ath11k);\nint ath11k_core_check_smbios(struct ath11k_base *ab);\nvoid ath11k_core_halt(struct ath11k *ar);\nint ath11k_core_resume(struct ath11k_base *ab);\nint ath11k_core_suspend(struct ath11k_base *ab);\nvoid ath11k_core_pre_reconfigure_recovery(struct ath11k_base *ab);\nbool ath11k_core_coldboot_cal_support(struct ath11k_base *ab);\n\nconst struct firmware *ath11k_core_firmware_request(struct ath11k_base *ab,\n\t\t\t\t\t\t    const char *filename);\n\nstatic inline const char *ath11k_scan_state_str(enum ath11k_scan_state state)\n{\n\tswitch (state) {\n\tcase ATH11K_SCAN_IDLE:\n\t\treturn \"idle\";\n\tcase ATH11K_SCAN_STARTING:\n\t\treturn \"starting\";\n\tcase ATH11K_SCAN_RUNNING:\n\t\treturn \"running\";\n\tcase ATH11K_SCAN_ABORTING:\n\t\treturn \"aborting\";\n\t}\n\n\treturn \"unknown\";\n}\n\nstatic inline struct ath11k_skb_cb *ATH11K_SKB_CB(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct ath11k_skb_cb) >\n\t\t     IEEE80211_TX_INFO_DRIVER_DATA_SIZE);\n\treturn (struct ath11k_skb_cb *)&IEEE80211_SKB_CB(skb)->driver_data;\n}\n\nstatic inline struct ath11k_skb_rxcb *ATH11K_SKB_RXCB(struct sk_buff *skb)\n{\n\tBUILD_BUG_ON(sizeof(struct ath11k_skb_rxcb) > sizeof(skb->cb));\n\treturn (struct ath11k_skb_rxcb *)skb->cb;\n}\n\nstatic inline struct ath11k_vif *ath11k_vif_to_arvif(struct ieee80211_vif *vif)\n{\n\treturn (struct ath11k_vif *)vif->drv_priv;\n}\n\nstatic inline struct ath11k *ath11k_ab_to_ar(struct ath11k_base *ab,\n\t\t\t\t\t     int mac_id)\n{\n\treturn ab->pdevs[ath11k_hw_mac_id_to_pdev_id(&ab->hw_params, mac_id)].ar;\n}\n\nstatic inline void ath11k_core_create_firmware_path(struct ath11k_base *ab,\n\t\t\t\t\t\t    const char *filename,\n\t\t\t\t\t\t    void *buf, size_t buf_len)\n{\n\tsnprintf(buf, buf_len, \"%s/%s/%s\", ATH11K_FW_DIR,\n\t\t ab->hw_params.fw.dir, filename);\n}\n\nstatic inline const char *ath11k_bus_str(enum ath11k_bus bus)\n{\n\tswitch (bus) {\n\tcase ATH11K_BUS_PCI:\n\t\treturn \"pci\";\n\tcase ATH11K_BUS_AHB:\n\t\treturn \"ahb\";\n\t}\n\n\treturn \"unknown\";\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}