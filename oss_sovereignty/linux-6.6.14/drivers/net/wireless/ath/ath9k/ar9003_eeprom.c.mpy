{
  "module_name": "ar9003_eeprom.c",
  "hash_id": "137967987580983445d52439c99cd126bcec325cdc8a0502125d292b933bd0fb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath9k/ar9003_eeprom.c",
  "human_readable_source": " \n\n#include <asm/unaligned.h>\n#include <linux/kernel.h>\n#include \"hw.h\"\n#include \"ar9003_phy.h\"\n#include \"ar9003_eeprom.h\"\n#include \"ar9003_mci.h\"\n\n#define COMP_HDR_LEN 4\n#define COMP_CKSUM_LEN 2\n\n#define LE16(x) cpu_to_le16(x)\n#define LE32(x) cpu_to_le32(x)\n\n \n#define EXT_ADDITIVE (0x8000)\n#define CTL_11A_EXT (CTL_11A | EXT_ADDITIVE)\n#define CTL_11G_EXT (CTL_11G | EXT_ADDITIVE)\n#define CTL_11B_EXT (CTL_11B | EXT_ADDITIVE)\n\n#define SUB_NUM_CTL_MODES_AT_5G_40 2     \n#define SUB_NUM_CTL_MODES_AT_2G_40 3     \n\n#define CTL(_tpower, _flag) ((_tpower) | ((_flag) << 6))\n\n#define EEPROM_DATA_LEN_9485\t1088\n\nstatic int ar9003_hw_power_interpolate(int32_t x,\n\t\t\t\t       int32_t *px, int32_t *py, u_int16_t np);\n\nstatic const struct ar9300_eeprom ar9300_default = {\n\t.eepromVersion = 2,\n\t.templateVersion = 2,\n\t.macAddr = {0, 2, 3, 4, 5, 6},\n\t.custData = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n\t\t     0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t.baseEepHeader = {\n\t\t.regDmn = { LE16(0), LE16(0x1f) },\n\t\t.txrxMask =  0x77,  \n\t\t.opCapFlags = {\n\t\t\t.opFlags = AR5416_OPFLAGS_11G | AR5416_OPFLAGS_11A,\n\t\t\t.eepMisc = AR9300_EEPMISC_LITTLE_ENDIAN,\n\t\t},\n\t\t.rfSilent = 0,\n\t\t.blueToothOptions = 0,\n\t\t.deviceCap = 0,\n\t\t.deviceType = 5,  \n\t\t.pwrTableOffset = AR9300_PWR_TABLE_OFFSET,\n\t\t.params_for_tuning_caps = {0, 0},\n\t\t.featureEnable = 0x0c,\n\t\t  \n\t\t.miscConfiguration = 0,  \n\t\t.eepromWriteEnableGpio = 3,\n\t\t.wlanDisableGpio = 0,\n\t\t.wlanLedGpio = 8,\n\t\t.rxBandSelectGpio = 0xff,\n\t\t.txrxgain = 0,\n\t\t.swreg = 0,\n\t },\n\t.modalHeader2G = {\n\t \n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x22222),\n\n\t\t \n\t\t.antCtrlChain = { LE16(0x150), LE16(0x150), LE16(0x150) },\n\n\t\t \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 36,\n\t\t.voltSlope = 0,\n\n\t\t \n\t\t.spurChans = {0, 0, 0, 0, 0},\n\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2c,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0cf0e0e0),\n\t\t.papdRateMaskHt40 = LE32(0x6cf0e0e0),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t.base_ext1 = {\n\t\t.ant_div_control = 0,\n\t\t.future = {0, 0},\n\t\t.tempslopextension = {0, 0, 0, 0, 0, 0, 0, 0}\n\t},\n\t.calFreqPier2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t },\n\t \n\t.calPierData2G = {\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t },\n\t.calTarget_freqbin_Cck = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2484, 1),\n\t },\n\t.calTarget_freqbin_2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT20 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT40 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTargetPowerCck = {\n\t\t  \n\t\t { {36, 36, 36, 36} },\n\t\t { {36, 36, 36, 36} },\n\t},\n\t.calTargetPower2G = {\n\t\t  \n\t\t { {32, 32, 28, 24} },\n\t\t { {32, 32, 28, 24} },\n\t\t { {32, 32, 28, 24} },\n\t},\n\t.calTargetPower2GHT20 = {\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t},\n\t.calTargetPower2GHT40 = {\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t\t{ {32, 32, 32, 32, 28, 20, 32, 32, 28, 20, 32, 32, 28, 20} },\n\t},\n\t.ctlIndex_2G =  {\n\t\t0x11, 0x12, 0x15, 0x17, 0x41, 0x42,\n\t\t0x45, 0x47, 0x31, 0x32, 0x35, 0x37,\n\t},\n\t.ctl_freqbin_2G = {\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2457, 1),\n\t\t\tFREQ2FBIN(2462, 1)\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2422, 1),\n\t\t\tFREQ2FBIN(2427, 1),\n\t\t\tFREQ2FBIN(2447, 1),\n\t\t\tFREQ2FBIN(2452, 1)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t  FREQ2FBIN(2484, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t}\n\t },\n\t.ctlPowerData_2G = {\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 1) } },\n\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t },\n\t.modalHeader5G = {\n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x22222),\n\t\t  \n\t\t.antCtrlChain = {\n\t\t\tLE16(0x000), LE16(0x000), LE16(0x000),\n\t\t},\n\t\t  \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 68,\n\t\t.voltSlope = 0,\n\t\t \n\t\t.spurChans = {0, 0, 0, 0, 0},\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2d,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0c80c080),\n\t\t.papdRateMaskHt40 = LE32(0x0080c080),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t.base_ext2 = {\n\t\t.tempSlopeLow = 0,\n\t\t.tempSlopeHigh = 0,\n\t\t.xatten1DBLow = {0, 0, 0},\n\t\t.xatten1MarginLow = {0, 0, 0},\n\t\t.xatten1DBHigh = {0, 0, 0},\n\t\t.xatten1MarginHigh = {0, 0, 0}\n\t},\n\t.calFreqPier5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calPierData5G = {\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\n\t},\n\t.calTarget_freqbin_5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT20 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT40 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t },\n\t.calTargetPower5G = {\n\t\t \n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t\t{ {20, 20, 20, 10} },\n\t },\n\t.calTargetPower5GHT20 = {\n\t\t \n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t },\n\t.calTargetPower5GHT40 =  {\n\t\t \n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t\t{ {20, 20, 10, 10, 0, 0, 10, 10, 0, 0, 10, 10, 0, 0} },\n\t },\n\t.ctlIndex_5G =  {\n\t\t0x10, 0x16, 0x18, 0x40, 0x46,\n\t\t0x48, 0x30, 0x36, 0x38\n\t},\n\t.ctl_freqbin_5G =  {\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5520, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5590, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5220, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5560, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0),\n\t\t\t  FREQ2FBIN(5795, 0)\n\t\t}\n\t },\n\t.ctlPowerData_5G = {\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 0), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t }\n};\n\nstatic const struct ar9300_eeprom ar9300_x113 = {\n\t.eepromVersion = 2,\n\t.templateVersion = 6,\n\t.macAddr = {0x00, 0x03, 0x7f, 0x0, 0x0, 0x0},\n\t.custData = {\"x113-023-f0000\"},\n\t.baseEepHeader = {\n\t\t.regDmn = { LE16(0), LE16(0x1f) },\n\t\t.txrxMask =  0x77,  \n\t\t.opCapFlags = {\n\t\t\t.opFlags = AR5416_OPFLAGS_11A,\n\t\t\t.eepMisc = AR9300_EEPMISC_LITTLE_ENDIAN,\n\t\t},\n\t\t.rfSilent = 0,\n\t\t.blueToothOptions = 0,\n\t\t.deviceCap = 0,\n\t\t.deviceType = 5,  \n\t\t.pwrTableOffset = AR9300_PWR_TABLE_OFFSET,\n\t\t.params_for_tuning_caps = {0, 0},\n\t\t.featureEnable = 0x0d,\n\t\t  \n\t\t.miscConfiguration = 0,  \n\t\t.eepromWriteEnableGpio = 6,\n\t\t.wlanDisableGpio = 0,\n\t\t.wlanLedGpio = 8,\n\t\t.rxBandSelectGpio = 0xff,\n\t\t.txrxgain = 0x21,\n\t\t.swreg = 0,\n\t },\n\t.modalHeader2G = {\n\t \n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x44444),\n\n\t\t \n\t\t.antCtrlChain = { LE16(0x150), LE16(0x150), LE16(0x150) },\n\n\t\t \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 25,\n\t\t.voltSlope = 0,\n\n\t\t \n\t\t.spurChans = {FREQ2FBIN(2464, 1), 0, 0, 0, 0},\n\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2c,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0c80c080),\n\t\t.papdRateMaskHt40 = LE32(0x0080c080),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t .base_ext1 = {\n\t\t.ant_div_control = 0,\n\t\t.future = {0, 0},\n\t\t.tempslopextension = {0, 0, 0, 0, 0, 0, 0, 0}\n\t },\n\t.calFreqPier2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t },\n\t \n\t.calPierData2G = {\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t },\n\t.calTarget_freqbin_Cck = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t },\n\t.calTarget_freqbin_2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT20 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT40 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTargetPowerCck = {\n\t\t  \n\t\t { {34, 34, 34, 34} },\n\t\t { {34, 34, 34, 34} },\n\t},\n\t.calTargetPower2G = {\n\t\t  \n\t\t { {34, 34, 32, 32} },\n\t\t { {34, 34, 32, 32} },\n\t\t { {34, 34, 32, 32} },\n\t},\n\t.calTargetPower2GHT20 = {\n\t\t{ {32, 32, 32, 32, 32, 28, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t\t{ {32, 32, 32, 32, 32, 28, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t\t{ {32, 32, 32, 32, 32, 28, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t},\n\t.calTargetPower2GHT40 = {\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t},\n\t.ctlIndex_2G =  {\n\t\t0x11, 0x12, 0x15, 0x17, 0x41, 0x42,\n\t\t0x45, 0x47, 0x31, 0x32, 0x35, 0x37,\n\t},\n\t.ctl_freqbin_2G = {\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2457, 1),\n\t\t\tFREQ2FBIN(2462, 1)\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2422, 1),\n\t\t\tFREQ2FBIN(2427, 1),\n\t\t\tFREQ2FBIN(2447, 1),\n\t\t\tFREQ2FBIN(2452, 1)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t  FREQ2FBIN(2484, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t}\n\t },\n\t.ctlPowerData_2G = {\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 1) } },\n\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t },\n\t.modalHeader5G = {\n\t\t \n\t\t.antCtrlCommon = LE32(0x220),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x11111),\n\t\t  \n\t\t.antCtrlChain = {\n\t\t\tLE16(0x150), LE16(0x150), LE16(0x150),\n\t\t},\n\t\t  \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 68,\n\t\t.voltSlope = 0,\n\t\t \n\t\t.spurChans = {FREQ2FBIN(5500, 0), 0, 0, 0, 0},\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0xf,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2d,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0cf0e0e0),\n\t\t.papdRateMaskHt40 = LE32(0x6cf0e0e0),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t.base_ext2 = {\n\t\t.tempSlopeLow = 72,\n\t\t.tempSlopeHigh = 105,\n\t\t.xatten1DBLow = {0, 0, 0},\n\t\t.xatten1MarginLow = {0, 0, 0},\n\t\t.xatten1DBHigh = {0, 0, 0},\n\t\t.xatten1MarginHigh = {0, 0, 0}\n\t },\n\t.calFreqPier5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5785, 0)\n\t},\n\t.calPierData5G = {\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\n\t},\n\t.calTarget_freqbin_5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5785, 0)\n\t},\n\t.calTarget_freqbin_5GHT20 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT40 = {\n\t\tFREQ2FBIN(5190, 0),\n\t\tFREQ2FBIN(5230, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5410, 0),\n\t\tFREQ2FBIN(5510, 0),\n\t\tFREQ2FBIN(5670, 0),\n\t\tFREQ2FBIN(5755, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t },\n\t.calTargetPower5G = {\n\t\t \n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t\t{ {42, 40, 40, 34} },\n\t },\n\t.calTargetPower5GHT20 = {\n\t\t \n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {40, 40, 40, 40, 32, 28, 40, 40, 32, 28, 40, 40, 32, 20} },\n\t\t{ {38, 38, 38, 38, 32, 28, 38, 38, 32, 28, 38, 38, 32, 26} },\n\t\t{ {36, 36, 36, 36, 32, 28, 36, 36, 32, 28, 36, 36, 32, 26} },\n\t },\n\t.calTargetPower5GHT40 =  {\n\t\t \n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {40, 40, 40, 38, 30, 26, 40, 40, 30, 26, 40, 40, 30, 24} },\n\t\t{ {36, 36, 36, 36, 30, 26, 36, 36, 30, 26, 36, 36, 30, 24} },\n\t\t{ {34, 34, 34, 34, 30, 26, 34, 34, 30, 26, 34, 34, 30, 24} },\n\t },\n\t.ctlIndex_5G =  {\n\t\t0x10, 0x16, 0x18, 0x40, 0x46,\n\t\t0x48, 0x30, 0x36, 0x38\n\t},\n\t.ctl_freqbin_5G =  {\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5520, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5590, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5220, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5560, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0),\n\t\t\t  FREQ2FBIN(5795, 0)\n\t\t}\n\t },\n\t.ctlPowerData_5G = {\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 0), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t }\n};\n\n\nstatic const struct ar9300_eeprom ar9300_h112 = {\n\t.eepromVersion = 2,\n\t.templateVersion = 3,\n\t.macAddr = {0x00, 0x03, 0x7f, 0x0, 0x0, 0x0},\n\t.custData = {\"h112-241-f0000\"},\n\t.baseEepHeader = {\n\t\t.regDmn = { LE16(0), LE16(0x1f) },\n\t\t.txrxMask =  0x77,  \n\t\t.opCapFlags = {\n\t\t\t.opFlags = AR5416_OPFLAGS_11G | AR5416_OPFLAGS_11A,\n\t\t\t.eepMisc = AR9300_EEPMISC_LITTLE_ENDIAN,\n\t\t},\n\t\t.rfSilent = 0,\n\t\t.blueToothOptions = 0,\n\t\t.deviceCap = 0,\n\t\t.deviceType = 5,  \n\t\t.pwrTableOffset = AR9300_PWR_TABLE_OFFSET,\n\t\t.params_for_tuning_caps = {0, 0},\n\t\t.featureEnable = 0x0d,\n\t\t \n\t\t.miscConfiguration = 0,  \n\t\t.eepromWriteEnableGpio = 6,\n\t\t.wlanDisableGpio = 0,\n\t\t.wlanLedGpio = 8,\n\t\t.rxBandSelectGpio = 0xff,\n\t\t.txrxgain = 0x10,\n\t\t.swreg = 0,\n\t},\n\t.modalHeader2G = {\n\t\t \n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x44444),\n\n\t\t \n\t\t.antCtrlChain = { LE16(0x150), LE16(0x150), LE16(0x150) },\n\n\t\t \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 25,\n\t\t.voltSlope = 0,\n\n\t\t \n\t\t.spurChans = {FREQ2FBIN(2464, 1), 0, 0, 0, 0},\n\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2c,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0c80c080),\n\t\t.papdRateMaskHt40 = LE32(0x0080c080),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t},\n\t.base_ext1 = {\n\t\t.ant_div_control = 0,\n\t\t.future = {0, 0},\n\t\t.tempslopextension = {0, 0, 0, 0, 0, 0, 0, 0}\n\t},\n\t.calFreqPier2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2462, 1),\n\t},\n\t \n\t.calPierData2G = {\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t},\n\t.calTarget_freqbin_Cck = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t},\n\t.calTarget_freqbin_2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTarget_freqbin_2GHT20 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTarget_freqbin_2GHT40 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTargetPowerCck = {\n\t\t \n\t\t{ {34, 34, 34, 34} },\n\t\t{ {34, 34, 34, 34} },\n\t},\n\t.calTargetPower2G = {\n\t\t \n\t\t{ {34, 34, 32, 32} },\n\t\t{ {34, 34, 32, 32} },\n\t\t{ {34, 34, 32, 32} },\n\t},\n\t.calTargetPower2GHT20 = {\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 28, 28, 28, 24} },\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 28, 28, 28, 24} },\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 28, 28, 28, 24} },\n\t},\n\t.calTargetPower2GHT40 = {\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 26, 26, 26, 22} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 26, 26, 26, 22} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 26, 26, 26, 22} },\n\t},\n\t.ctlIndex_2G =  {\n\t\t0x11, 0x12, 0x15, 0x17, 0x41, 0x42,\n\t\t0x45, 0x47, 0x31, 0x32, 0x35, 0x37,\n\t},\n\t.ctl_freqbin_2G = {\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2457, 1),\n\t\t\tFREQ2FBIN(2462, 1)\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2422, 1),\n\t\t\tFREQ2FBIN(2427, 1),\n\t\t\tFREQ2FBIN(2447, 1),\n\t\t\tFREQ2FBIN(2452, 1)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t  FREQ2FBIN(2484, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t}\n\t},\n\t.ctlPowerData_2G = {\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 1) } },\n\n\t\t{ { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t},\n\t.modalHeader5G = {\n\t\t \n\t\t.antCtrlCommon = LE32(0x220),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x44444),\n\t\t \n\t\t.antCtrlChain = {\n\t\t\tLE16(0x150), LE16(0x150), LE16(0x150),\n\t\t},\n\t\t \n\t\t.xatten1DB = {0, 0, 0},\n\n\t\t \n\t\t.xatten1Margin = {0, 0, 0},\n\t\t.tempSlope = 45,\n\t\t.voltSlope = 0,\n\t\t \n\t\t.spurChans = {0, 0, 0, 0, 0},\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2d,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0cf0e0e0),\n\t\t.papdRateMaskHt40 = LE32(0x6cf0e0e0),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t},\n\t.base_ext2 = {\n\t\t.tempSlopeLow = 40,\n\t\t.tempSlopeHigh = 50,\n\t\t.xatten1DBLow = {0, 0, 0},\n\t\t.xatten1MarginLow = {0, 0, 0},\n\t\t.xatten1DBHigh = {0, 0, 0},\n\t\t.xatten1MarginHigh = {0, 0, 0}\n\t},\n\t.calFreqPier5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5785, 0)\n\t},\n\t.calPierData5G = {\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\n\t},\n\t.calTarget_freqbin_5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT20 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT40 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTargetPower5G = {\n\t\t \n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t},\n\t.calTargetPower5GHT20 = {\n\t\t \n\t\t{ {30, 30, 30, 28, 24, 20, 30, 28, 24, 20, 20, 20, 20, 16} },\n\t\t{ {30, 30, 30, 28, 24, 20, 30, 28, 24, 20, 20, 20, 20, 16} },\n\t\t{ {30, 30, 30, 26, 22, 18, 30, 26, 22, 18, 18, 18, 18, 16} },\n\t\t{ {30, 30, 30, 26, 22, 18, 30, 26, 22, 18, 18, 18, 18, 16} },\n\t\t{ {30, 30, 30, 24, 20, 16, 30, 24, 20, 16, 16, 16, 16, 14} },\n\t\t{ {30, 30, 30, 24, 20, 16, 30, 24, 20, 16, 16, 16, 16, 14} },\n\t\t{ {30, 30, 30, 22, 18, 14, 30, 22, 18, 14, 14, 14, 14, 12} },\n\t\t{ {30, 30, 30, 22, 18, 14, 30, 22, 18, 14, 14, 14, 14, 12} },\n\t},\n\t.calTargetPower5GHT40 =  {\n\t\t \n\t\t{ {28, 28, 28, 26, 22, 18, 28, 26, 22, 18, 18, 18, 18, 14} },\n\t\t{ {28, 28, 28, 26, 22, 18, 28, 26, 22, 18, 18, 18, 18, 14} },\n\t\t{ {28, 28, 28, 24, 20, 16, 28, 24, 20, 16, 16, 16, 16, 12} },\n\t\t{ {28, 28, 28, 24, 20, 16, 28, 24, 20, 16, 16, 16, 16, 12} },\n\t\t{ {28, 28, 28, 22, 18, 14, 28, 22, 18, 14, 14, 14, 14, 10} },\n\t\t{ {28, 28, 28, 22, 18, 14, 28, 22, 18, 14, 14, 14, 14, 10} },\n\t\t{ {28, 28, 28, 20, 16, 12, 28, 20, 16, 12, 12, 12, 12, 8} },\n\t\t{ {28, 28, 28, 20, 16, 12, 28, 20, 16, 12, 12, 12, 12, 8} },\n\t},\n\t.ctlIndex_5G =  {\n\t\t0x10, 0x16, 0x18, 0x40, 0x46,\n\t\t0x48, 0x30, 0x36, 0x38\n\t},\n\t.ctl_freqbin_5G =  {\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5520, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5590, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5220, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5560, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0),\n\t\t\t  FREQ2FBIN(5795, 0)\n\t\t}\n\t},\n\t.ctlPowerData_5G = {\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 0), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t}\n};\n\n\nstatic const struct ar9300_eeprom ar9300_x112 = {\n\t.eepromVersion = 2,\n\t.templateVersion = 5,\n\t.macAddr = {0x00, 0x03, 0x7f, 0x0, 0x0, 0x0},\n\t.custData = {\"x112-041-f0000\"},\n\t.baseEepHeader = {\n\t\t.regDmn = { LE16(0), LE16(0x1f) },\n\t\t.txrxMask =  0x77,  \n\t\t.opCapFlags = {\n\t\t\t.opFlags = AR5416_OPFLAGS_11G | AR5416_OPFLAGS_11A,\n\t\t\t.eepMisc = AR9300_EEPMISC_LITTLE_ENDIAN,\n\t\t},\n\t\t.rfSilent = 0,\n\t\t.blueToothOptions = 0,\n\t\t.deviceCap = 0,\n\t\t.deviceType = 5,  \n\t\t.pwrTableOffset = AR9300_PWR_TABLE_OFFSET,\n\t\t.params_for_tuning_caps = {0, 0},\n\t\t.featureEnable = 0x0d,\n\t\t \n\t\t.miscConfiguration = 0,  \n\t\t.eepromWriteEnableGpio = 6,\n\t\t.wlanDisableGpio = 0,\n\t\t.wlanLedGpio = 8,\n\t\t.rxBandSelectGpio = 0xff,\n\t\t.txrxgain = 0x0,\n\t\t.swreg = 0,\n\t},\n\t.modalHeader2G = {\n\t\t \n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x22222),\n\n\t\t \n\t\t.antCtrlChain = { LE16(0x10), LE16(0x10), LE16(0x10) },\n\n\t\t \n\t\t.xatten1DB = {0x1b, 0x1b, 0x1b},\n\n\t\t \n\t\t.xatten1Margin = {0x15, 0x15, 0x15},\n\t\t.tempSlope = 50,\n\t\t.voltSlope = 0,\n\n\t\t \n\t\t.spurChans = {FREQ2FBIN(2464, 1), 0, 0, 0, 0},\n\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2c,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0c80c080),\n\t\t.papdRateMaskHt40 = LE32(0x0080c080),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t},\n\t.base_ext1 = {\n\t\t.ant_div_control = 0,\n\t\t.future = {0, 0},\n\t\t.tempslopextension = {0, 0, 0, 0, 0, 0, 0, 0}\n\t},\n\t.calFreqPier2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t},\n\t \n\t.calPierData2G = {\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t},\n\t.calTarget_freqbin_Cck = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t},\n\t.calTarget_freqbin_2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTarget_freqbin_2GHT20 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTarget_freqbin_2GHT40 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t},\n\t.calTargetPowerCck = {\n\t\t \n\t\t{ {38, 38, 38, 38} },\n\t\t{ {38, 38, 38, 38} },\n\t},\n\t.calTargetPower2G = {\n\t\t \n\t\t{ {38, 38, 36, 34} },\n\t\t{ {38, 38, 36, 34} },\n\t\t{ {38, 38, 34, 32} },\n\t},\n\t.calTargetPower2GHT20 = {\n\t\t{ {36, 36, 36, 36, 36, 34, 34, 32, 30, 28, 28, 28, 28, 26} },\n\t\t{ {36, 36, 36, 36, 36, 34, 36, 34, 32, 30, 30, 30, 28, 26} },\n\t\t{ {36, 36, 36, 36, 36, 34, 34, 32, 30, 28, 28, 28, 28, 26} },\n\t},\n\t.calTargetPower2GHT40 = {\n\t\t{ {36, 36, 36, 36, 34, 32, 32, 30, 28, 26, 26, 26, 26, 24} },\n\t\t{ {36, 36, 36, 36, 34, 32, 34, 32, 30, 28, 28, 28, 28, 24} },\n\t\t{ {36, 36, 36, 36, 34, 32, 32, 30, 28, 26, 26, 26, 26, 24} },\n\t},\n\t.ctlIndex_2G =  {\n\t\t0x11, 0x12, 0x15, 0x17, 0x41, 0x42,\n\t\t0x45, 0x47, 0x31, 0x32, 0x35, 0x37,\n\t},\n\t.ctl_freqbin_2G = {\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2457, 1),\n\t\t\tFREQ2FBIN(2462, 1)\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2422, 1),\n\t\t\tFREQ2FBIN(2427, 1),\n\t\t\tFREQ2FBIN(2447, 1),\n\t\t\tFREQ2FBIN(2452, 1)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t  FREQ2FBIN(2484, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t}\n\t},\n\t.ctlPowerData_2G = {\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 1) } },\n\n\t\t{ { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t\t{ { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t},\n\t.modalHeader5G = {\n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x22222),\n\t\t \n\t\t.antCtrlChain = {\n\t\t\tLE16(0x0), LE16(0x0), LE16(0x0),\n\t\t},\n\t\t \n\t\t.xatten1DB = {0x13, 0x19, 0x17},\n\n\t\t \n\t\t.xatten1Margin = {0x19, 0x19, 0x19},\n\t\t.tempSlope = 70,\n\t\t.voltSlope = 15,\n\t\t \n\t\t.spurChans = {0, 0, 0, 0, 0},\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2d,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0cf0e0e0),\n\t\t.papdRateMaskHt40 = LE32(0x6cf0e0e0),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t},\n\t.base_ext2 = {\n\t\t.tempSlopeLow = 72,\n\t\t.tempSlopeHigh = 105,\n\t\t.xatten1DBLow = {0x10, 0x14, 0x10},\n\t\t.xatten1MarginLow = {0x19, 0x19 , 0x19},\n\t\t.xatten1DBHigh = {0x1d, 0x20, 0x24},\n\t\t.xatten1MarginHigh = {0x10, 0x10, 0x10}\n\t},\n\t.calFreqPier5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5785, 0)\n\t},\n\t.calPierData5G = {\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\t\t{\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t\t{0, 0, 0, 0, 0},\n\t\t},\n\n\t},\n\t.calTarget_freqbin_5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT20 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT40 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5725, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTargetPower5G = {\n\t\t \n\t\t{ {32, 32, 28, 26} },\n\t\t{ {32, 32, 28, 26} },\n\t\t{ {32, 32, 28, 26} },\n\t\t{ {32, 32, 26, 24} },\n\t\t{ {32, 32, 26, 24} },\n\t\t{ {32, 32, 24, 22} },\n\t\t{ {30, 30, 24, 22} },\n\t\t{ {30, 30, 24, 22} },\n\t},\n\t.calTargetPower5GHT20 = {\n\t\t \n\t\t{ {32, 32, 32, 32, 28, 26, 32, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 32, 28, 26, 32, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 32, 28, 26, 32, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 32, 28, 26, 32, 26, 24, 22, 22, 22, 20, 20} },\n\t\t{ {32, 32, 32, 32, 28, 26, 32, 26, 24, 22, 20, 18, 16, 16} },\n\t\t{ {32, 32, 32, 32, 28, 26, 32, 24, 20, 16, 18, 16, 14, 14} },\n\t\t{ {30, 30, 30, 30, 28, 26, 30, 24, 20, 16, 18, 16, 14, 14} },\n\t\t{ {30, 30, 30, 30, 28, 26, 30, 24, 20, 16, 18, 16, 14, 14} },\n\t},\n\t.calTargetPower5GHT40 =  {\n\t\t \n\t\t{ {32, 32, 32, 30, 28, 26, 30, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 30, 28, 26, 30, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 30, 28, 26, 30, 28, 26, 24, 24, 24, 22, 22} },\n\t\t{ {32, 32, 32, 30, 28, 26, 30, 26, 24, 22, 22, 22, 20, 20} },\n\t\t{ {32, 32, 32, 30, 28, 26, 30, 26, 24, 22, 20, 18, 16, 16} },\n\t\t{ {32, 32, 32, 30, 28, 26, 30, 22, 20, 16, 18, 16, 14, 14} },\n\t\t{ {30, 30, 30, 30, 28, 26, 30, 22, 20, 16, 18, 16, 14, 14} },\n\t\t{ {30, 30, 30, 30, 28, 26, 30, 22, 20, 16, 18, 16, 14, 14} },\n\t},\n\t.ctlIndex_5G =  {\n\t\t0x10, 0x16, 0x18, 0x40, 0x46,\n\t\t0x48, 0x30, 0x36, 0x38\n\t},\n\t.ctl_freqbin_5G =  {\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5520, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5590, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5220, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5560, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0),\n\t\t\t  FREQ2FBIN(5795, 0)\n\t\t}\n\t},\n\t.ctlPowerData_5G = {\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 0), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t}\n};\n\nstatic const struct ar9300_eeprom ar9300_h116 = {\n\t.eepromVersion = 2,\n\t.templateVersion = 4,\n\t.macAddr = {0x00, 0x03, 0x7f, 0x0, 0x0, 0x0},\n\t.custData = {\"h116-041-f0000\"},\n\t.baseEepHeader = {\n\t\t.regDmn = { LE16(0), LE16(0x1f) },\n\t\t.txrxMask =  0x33,  \n\t\t.opCapFlags = {\n\t\t\t.opFlags = AR5416_OPFLAGS_11G | AR5416_OPFLAGS_11A,\n\t\t\t.eepMisc = AR9300_EEPMISC_LITTLE_ENDIAN,\n\t\t},\n\t\t.rfSilent = 0,\n\t\t.blueToothOptions = 0,\n\t\t.deviceCap = 0,\n\t\t.deviceType = 5,  \n\t\t.pwrTableOffset = AR9300_PWR_TABLE_OFFSET,\n\t\t.params_for_tuning_caps = {0, 0},\n\t\t.featureEnable = 0x0d,\n\t\t  \n\t\t.miscConfiguration = 0,  \n\t\t.eepromWriteEnableGpio = 6,\n\t\t.wlanDisableGpio = 0,\n\t\t.wlanLedGpio = 8,\n\t\t.rxBandSelectGpio = 0xff,\n\t\t.txrxgain = 0x10,\n\t\t.swreg = 0,\n\t },\n\t.modalHeader2G = {\n\t \n\t\t \n\t\t.antCtrlCommon = LE32(0x110),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x44444),\n\n\t\t \n\t\t.antCtrlChain = { LE16(0x10), LE16(0x10), LE16(0x10) },\n\n\t\t \n\t\t.xatten1DB = {0x1f, 0x1f, 0x1f},\n\n\t\t \n\t\t.xatten1Margin = {0x12, 0x12, 0x12},\n\t\t.tempSlope = 25,\n\t\t.voltSlope = 0,\n\n\t\t \n\t\t.spurChans = {FREQ2FBIN(2464, 1), 0, 0, 0, 0},\n\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2c,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0c80C080),\n\t\t.papdRateMaskHt40 = LE32(0x0080C080),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t .base_ext1 = {\n\t\t.ant_div_control = 0,\n\t\t.future = {0, 0},\n\t\t.tempslopextension = {0, 0, 0, 0, 0, 0, 0, 0}\n\t },\n\t.calFreqPier2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2462, 1),\n\t },\n\t \n\t.calPierData2G = {\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t\t{ {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0} },\n\t },\n\t.calTarget_freqbin_Cck = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2472, 1),\n\t },\n\t.calTarget_freqbin_2G = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT20 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTarget_freqbin_2GHT40 = {\n\t\tFREQ2FBIN(2412, 1),\n\t\tFREQ2FBIN(2437, 1),\n\t\tFREQ2FBIN(2472, 1)\n\t },\n\t.calTargetPowerCck = {\n\t\t  \n\t\t { {34, 34, 34, 34} },\n\t\t { {34, 34, 34, 34} },\n\t},\n\t.calTargetPower2G = {\n\t\t  \n\t\t { {34, 34, 32, 32} },\n\t\t { {34, 34, 32, 32} },\n\t\t { {34, 34, 32, 32} },\n\t},\n\t.calTargetPower2GHT20 = {\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t\t{ {32, 32, 32, 32, 32, 30, 32, 32, 30, 28, 0, 0, 0, 0} },\n\t},\n\t.calTargetPower2GHT40 = {\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 30, 30, 28, 30, 30, 28, 26, 0, 0, 0, 0} },\n\t},\n\t.ctlIndex_2G =  {\n\t\t0x11, 0x12, 0x15, 0x17, 0x41, 0x42,\n\t\t0x45, 0x47, 0x31, 0x32, 0x35, 0x37,\n\t},\n\t.ctl_freqbin_2G = {\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2457, 1),\n\t\t\tFREQ2FBIN(2462, 1)\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\n\t\t{\n\t\t\tFREQ2FBIN(2412, 1),\n\t\t\tFREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2462, 1),\n\t\t\t0xFF,\n\t\t},\n\t\t{\n\t\t\tFREQ2FBIN(2422, 1),\n\t\t\tFREQ2FBIN(2427, 1),\n\t\t\tFREQ2FBIN(2447, 1),\n\t\t\tFREQ2FBIN(2452, 1)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t  FREQ2FBIN(2484, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\tFREQ2FBIN(2472, 1),\n\t\t\t0,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2412, 1),\n\t\t\t  FREQ2FBIN(2417, 1),\n\t\t\t  FREQ2FBIN(2472, 1),\n\t\t\t0\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(2422, 1),\n\t\t\t  FREQ2FBIN(2427, 1),\n\t\t\t  FREQ2FBIN(2447, 1),\n\t\t\t  FREQ2FBIN(2462, 1),\n\t\t}\n\t },\n\t.ctlPowerData_2G = {\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 1) } },\n\n\t\t { { CTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 0) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t\t { { CTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 1) } },\n\t },\n\t.modalHeader5G = {\n\t\t \n\t\t.antCtrlCommon = LE32(0x220),\n\t\t \n\t\t.antCtrlCommon2 = LE32(0x44444),\n\t\t  \n\t\t.antCtrlChain = {\n\t\t\tLE16(0x150), LE16(0x150), LE16(0x150),\n\t\t},\n\t\t  \n\t\t.xatten1DB = {0x19, 0x19, 0x19},\n\n\t\t \n\t\t.xatten1Margin = {0x14, 0x14, 0x14},\n\t\t.tempSlope = 70,\n\t\t.voltSlope = 0,\n\t\t \n\t\t.spurChans = {0, 0, 0, 0, 0},\n\t\t \n\t\t.noiseFloorThreshCh = {-1, 0, 0},\n\t\t.reserved = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},\n\t\t.quick_drop = 0,\n\t\t.xpaBiasLvl = 0,\n\t\t.txFrameToDataStart = 0x0e,\n\t\t.txFrameToPaOn = 0x0e,\n\t\t.txClip = 3,  \n\t\t.antennaGain = 0,\n\t\t.switchSettling = 0x2d,\n\t\t.adcDesiredSize = -30,\n\t\t.txEndToXpaOff = 0,\n\t\t.txEndToRxOn = 0x2,\n\t\t.txFrameToXpaOn = 0xe,\n\t\t.thresh62 = 28,\n\t\t.papdRateMaskHt20 = LE32(0x0cf0e0e0),\n\t\t.papdRateMaskHt40 = LE32(0x6cf0e0e0),\n\t\t.switchcomspdt = 0,\n\t\t.xlna_bias_strength = 0,\n\t\t.futureModal = {\n\t\t\t0, 0, 0, 0, 0, 0, 0,\n\t\t},\n\t },\n\t.base_ext2 = {\n\t\t.tempSlopeLow = 35,\n\t\t.tempSlopeHigh = 50,\n\t\t.xatten1DBLow = {0, 0, 0},\n\t\t.xatten1MarginLow = {0, 0, 0},\n\t\t.xatten1DBHigh = {0, 0, 0},\n\t\t.xatten1MarginHigh = {0, 0, 0}\n\t },\n\t.calFreqPier5G = {\n\t\tFREQ2FBIN(5160, 0),\n\t\tFREQ2FBIN(5220, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5785, 0)\n\t},\n\t.calPierData5G = {\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\t\t\t{\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t\t{0, 0, 0, 0, 0},\n\t\t\t},\n\n\t},\n\t.calTarget_freqbin_5G = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5600, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT20 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t},\n\t.calTarget_freqbin_5GHT40 = {\n\t\tFREQ2FBIN(5180, 0),\n\t\tFREQ2FBIN(5240, 0),\n\t\tFREQ2FBIN(5320, 0),\n\t\tFREQ2FBIN(5400, 0),\n\t\tFREQ2FBIN(5500, 0),\n\t\tFREQ2FBIN(5700, 0),\n\t\tFREQ2FBIN(5745, 0),\n\t\tFREQ2FBIN(5825, 0)\n\t },\n\t.calTargetPower5G = {\n\t\t \n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t\t{ {30, 30, 28, 24} },\n\t },\n\t.calTargetPower5GHT20 = {\n\t\t \n\t\t{ {30, 30, 30, 28, 24, 20, 30, 28, 24, 20, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 28, 24, 20, 30, 28, 24, 20, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 26, 22, 18, 30, 26, 22, 18, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 26, 22, 18, 30, 26, 22, 18, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 24, 20, 16, 30, 24, 20, 16, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 24, 20, 16, 30, 24, 20, 16, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 22, 18, 14, 30, 22, 18, 14, 0, 0, 0, 0} },\n\t\t{ {30, 30, 30, 22, 18, 14, 30, 22, 18, 14, 0, 0, 0, 0} },\n\t },\n\t.calTargetPower5GHT40 =  {\n\t\t \n\t\t{ {28, 28, 28, 26, 22, 18, 28, 26, 22, 18, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 26, 22, 18, 28, 26, 22, 18, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 24, 20, 16, 28, 24, 20, 16, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 24, 20, 16, 28, 24, 20, 16, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 22, 18, 14, 28, 22, 18, 14, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 22, 18, 14, 28, 22, 18, 14, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 20, 16, 12, 28, 20, 16, 12, 0, 0, 0, 0} },\n\t\t{ {28, 28, 28, 20, 16, 12, 28, 20, 16, 12, 0, 0, 0, 0} },\n\t },\n\t.ctlIndex_5G =  {\n\t\t0x10, 0x16, 0x18, 0x40, 0x46,\n\t\t0x48, 0x30, 0x36, 0x38\n\t},\n\t.ctl_freqbin_5G =  {\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5280, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5520, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t\t  0xFF,\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5310, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5590, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  0xFF,\n\t\t\t  0xFF\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5200, 0),\n\t\t\t  FREQ2FBIN(5220, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5600, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5180, 0),\n\t\t\t  FREQ2FBIN(5260, 0),\n\t\t\t  FREQ2FBIN(5320, 0),\n\t\t\t  FREQ2FBIN(5500, 0),\n\t\t\t  FREQ2FBIN(5560, 0),\n\t\t\t  FREQ2FBIN(5700, 0),\n\t\t\t  FREQ2FBIN(5745, 0),\n\t\t\t  FREQ2FBIN(5825, 0)\n\t\t},\n\n\t\t{\n\t\t\t  FREQ2FBIN(5190, 0),\n\t\t\t  FREQ2FBIN(5230, 0),\n\t\t\t  FREQ2FBIN(5270, 0),\n\t\t\t  FREQ2FBIN(5510, 0),\n\t\t\t  FREQ2FBIN(5550, 0),\n\t\t\t  FREQ2FBIN(5670, 0),\n\t\t\t  FREQ2FBIN(5755, 0),\n\t\t\t  FREQ2FBIN(5795, 0)\n\t\t}\n\t },\n\t.ctlPowerData_5G = {\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 0), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t\tCTL(60, 0), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 0), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 1), CTL(60, 0),\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t{\n\t\t\t\tCTL(60, 1), CTL(60, 0), CTL(60, 1), CTL(60, 1),\n\t\t\t\tCTL(60, 1), CTL(60, 1), CTL(60, 0), CTL(60, 1),\n\t\t\t}\n\t\t},\n\t }\n};\n\n\nstatic const struct ar9300_eeprom *ar9300_eep_templates[] = {\n\t&ar9300_default,\n\t&ar9300_x112,\n\t&ar9300_h116,\n\t&ar9300_h112,\n\t&ar9300_x113,\n};\n\nstatic const struct ar9300_eeprom *ar9003_eeprom_struct_find_by_id(int id)\n{\n\tint it;\n\n\tfor (it = 0; it < ARRAY_SIZE(ar9300_eep_templates); it++)\n\t\tif (ar9300_eep_templates[it]->templateVersion == id)\n\t\t\treturn ar9300_eep_templates[it];\n\treturn NULL;\n}\n\nstatic int ath9k_hw_ar9300_check_eeprom(struct ath_hw *ah)\n{\n\treturn 0;\n}\n\nstatic int interpolate(int x, int xa, int xb, int ya, int yb)\n{\n\tint bf, factor, plus;\n\n\tbf = 2 * (yb - ya) * (x - xa) / (xb - xa);\n\tfactor = bf / 2;\n\tplus = bf % 2;\n\treturn ya + factor + plus;\n}\n\nstatic u32 ath9k_hw_ar9300_get_eeprom(struct ath_hw *ah,\n\t\t\t\t      enum eeprom_param param)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase = &eep->baseEepHeader;\n\n\tswitch (param) {\n\tcase EEP_MAC_LSW:\n\t\treturn get_unaligned_be16(eep->macAddr);\n\tcase EEP_MAC_MID:\n\t\treturn get_unaligned_be16(eep->macAddr + 2);\n\tcase EEP_MAC_MSW:\n\t\treturn get_unaligned_be16(eep->macAddr + 4);\n\tcase EEP_REG_0:\n\t\treturn le16_to_cpu(pBase->regDmn[0]);\n\tcase EEP_OP_CAP:\n\t\treturn pBase->deviceCap;\n\tcase EEP_OP_MODE:\n\t\treturn pBase->opCapFlags.opFlags;\n\tcase EEP_RF_SILENT:\n\t\treturn pBase->rfSilent;\n\tcase EEP_TX_MASK:\n\t\treturn (pBase->txrxMask >> 4) & 0xf;\n\tcase EEP_RX_MASK:\n\t\treturn pBase->txrxMask & 0xf;\n\tcase EEP_PAPRD:\n\t\treturn !!(pBase->featureEnable & BIT(5));\n\tcase EEP_CHAIN_MASK_REDUCE:\n\t\treturn (pBase->miscConfiguration >> 0x3) & 0x1;\n\tcase EEP_ANT_DIV_CTL1:\n\t\tif (AR_SREV_9565(ah))\n\t\t\treturn AR9300_EEP_ANTDIV_CONTROL_DEFAULT_VALUE;\n\t\telse\n\t\t\treturn eep->base_ext1.ant_div_control;\n\tcase EEP_ANTENNA_GAIN_5G:\n\t\treturn eep->modalHeader5G.antennaGain;\n\tcase EEP_ANTENNA_GAIN_2G:\n\t\treturn eep->modalHeader2G.antennaGain;\n\tdefault:\n\t\treturn 0;\n\t}\n}\n\nstatic bool ar9300_eeprom_read_byte(struct ath_hw *ah, int address,\n\t\t\t\t    u8 *buffer)\n{\n\tu16 val;\n\n\tif (unlikely(!ath9k_hw_nvram_read(ah, address / 2, &val)))\n\t\treturn false;\n\n\t*buffer = (val >> (8 * (address % 2))) & 0xff;\n\treturn true;\n}\n\nstatic bool ar9300_eeprom_read_word(struct ath_hw *ah, int address,\n\t\t\t\t    u8 *buffer)\n{\n\tu16 val;\n\n\tif (unlikely(!ath9k_hw_nvram_read(ah, address / 2, &val)))\n\t\treturn false;\n\n\tbuffer[0] = val >> 8;\n\tbuffer[1] = val & 0xff;\n\n\treturn true;\n}\n\nstatic bool ar9300_read_eeprom(struct ath_hw *ah, int address, u8 *buffer,\n\t\t\t       int count)\n{\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tint i;\n\n\tif ((address < 0) || ((address + count) / 2 > AR9300_EEPROM_SIZE - 1)) {\n\t\tath_dbg(common, EEPROM, \"eeprom address not in range\\n\");\n\t\treturn false;\n\t}\n\n\t \n\tif (address % 2 == 0) {\n\t\tif (!ar9300_eeprom_read_byte(ah, address--, buffer++))\n\t\t\tgoto error;\n\n\t\tcount--;\n\t}\n\n\tfor (i = 0; i < count / 2; i++) {\n\t\tif (!ar9300_eeprom_read_word(ah, address, buffer))\n\t\t\tgoto error;\n\n\t\taddress -= 2;\n\t\tbuffer += 2;\n\t}\n\n\tif (count % 2)\n\t\tif (!ar9300_eeprom_read_byte(ah, address, buffer))\n\t\t\tgoto error;\n\n\treturn true;\n\nerror:\n\tath_dbg(common, EEPROM, \"unable to read eeprom region at offset %d\\n\",\n\t\taddress);\n\treturn false;\n}\n\nstatic bool ar9300_otp_read_word(struct ath_hw *ah, int addr, u32 *data)\n{\n\tREG_READ(ah, AR9300_OTP_BASE(ah) + (4 * addr));\n\n\tif (!ath9k_hw_wait(ah, AR9300_OTP_STATUS(ah), AR9300_OTP_STATUS_TYPE,\n\t\t\t   AR9300_OTP_STATUS_VALID, 1000))\n\t\treturn false;\n\n\t*data = REG_READ(ah, AR9300_OTP_READ_DATA(ah));\n\treturn true;\n}\n\nstatic bool ar9300_read_otp(struct ath_hw *ah, int address, u8 *buffer,\n\t\t\t    int count)\n{\n\tu32 data;\n\tint i;\n\n\tfor (i = 0; i < count; i++) {\n\t\tint offset = 8 * ((address - i) % 4);\n\t\tif (!ar9300_otp_read_word(ah, (address - i) / 4, &data))\n\t\t\treturn false;\n\n\t\tbuffer[i] = (data >> offset) & 0xff;\n\t}\n\n\treturn true;\n}\n\n\nstatic void ar9300_comp_hdr_unpack(u8 *best, int *code, int *reference,\n\t\t\t\t   int *length, int *major, int *minor)\n{\n\tunsigned long value[4];\n\n\tvalue[0] = best[0];\n\tvalue[1] = best[1];\n\tvalue[2] = best[2];\n\tvalue[3] = best[3];\n\t*code = ((value[0] >> 5) & 0x0007);\n\t*reference = (value[0] & 0x001f) | ((value[1] >> 2) & 0x0020);\n\t*length = ((value[1] << 4) & 0x07f0) | ((value[2] >> 4) & 0x000f);\n\t*major = (value[2] & 0x000f);\n\t*minor = (value[3] & 0x00ff);\n}\n\nstatic u16 ar9300_comp_cksum(u8 *data, int dsize)\n{\n\tint it, checksum = 0;\n\n\tfor (it = 0; it < dsize; it++) {\n\t\tchecksum += data[it];\n\t\tchecksum &= 0xffff;\n\t}\n\n\treturn checksum;\n}\n\nstatic bool ar9300_uncompress_block(struct ath_hw *ah,\n\t\t\t\t    u8 *mptr,\n\t\t\t\t    int mdataSize,\n\t\t\t\t    u8 *block,\n\t\t\t\t    int size)\n{\n\tint it;\n\tint spot;\n\tint offset;\n\tint length;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\n\tspot = 0;\n\n\tfor (it = 0; it < size; it += (length+2)) {\n\t\toffset = block[it];\n\t\toffset &= 0xff;\n\t\tspot += offset;\n\t\tlength = block[it+1];\n\t\tlength &= 0xff;\n\n\t\tif (length > 0 && spot >= 0 && spot+length <= mdataSize) {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"Restore at %d: spot=%d offset=%d length=%d\\n\",\n\t\t\t\tit, spot, offset, length);\n\t\t\tmemcpy(&mptr[spot], &block[it+2], length);\n\t\t\tspot += length;\n\t\t} else if (length > 0) {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"Bad restore at %d: spot=%d offset=%d length=%d\\n\",\n\t\t\t\tit, spot, offset, length);\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nstatic int ar9300_compress_decision(struct ath_hw *ah,\n\t\t\t\t    int it,\n\t\t\t\t    int code,\n\t\t\t\t    int reference,\n\t\t\t\t    u8 *mptr,\n\t\t\t\t    u8 *word, int length, int mdata_size)\n{\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tconst struct ar9300_eeprom *eep = NULL;\n\n\tswitch (code) {\n\tcase _CompressNone:\n\t\tif (length != mdata_size) {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"EEPROM structure size mismatch memory=%d eeprom=%d\\n\",\n\t\t\t\tmdata_size, length);\n\t\t\treturn -1;\n\t\t}\n\t\tmemcpy(mptr, word + COMP_HDR_LEN, length);\n\t\tath_dbg(common, EEPROM,\n\t\t\t\"restored eeprom %d: uncompressed, length %d\\n\",\n\t\t\tit, length);\n\t\tbreak;\n\tcase _CompressBlock:\n\t\tif (reference != 0) {\n\t\t\teep = ar9003_eeprom_struct_find_by_id(reference);\n\t\t\tif (eep == NULL) {\n\t\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\t\"can't find reference eeprom struct %d\\n\",\n\t\t\t\t\treference);\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tmemcpy(mptr, eep, mdata_size);\n\t\t}\n\t\tath_dbg(common, EEPROM,\n\t\t\t\"restore eeprom %d: block, reference %d, length %d\\n\",\n\t\t\tit, reference, length);\n\t\tar9300_uncompress_block(ah, mptr, mdata_size,\n\t\t\t\t\t(word + COMP_HDR_LEN), length);\n\t\tbreak;\n\tdefault:\n\t\tath_dbg(common, EEPROM, \"unknown compression code %d\\n\", code);\n\t\treturn -1;\n\t}\n\treturn 0;\n}\n\ntypedef bool (*eeprom_read_op)(struct ath_hw *ah, int address, u8 *buffer,\n\t\t\t       int count);\n\nstatic bool ar9300_check_header(void *data)\n{\n\tu32 *word = data;\n\treturn !(*word == 0 || *word == ~0);\n}\n\nstatic bool ar9300_check_eeprom_header(struct ath_hw *ah, eeprom_read_op read,\n\t\t\t\t       int base_addr)\n{\n\tu8 header[4];\n\n\tif (!read(ah, base_addr, header, 4))\n\t\treturn false;\n\n\treturn ar9300_check_header(header);\n}\n\nstatic int ar9300_eeprom_restore_flash(struct ath_hw *ah, u8 *mptr,\n\t\t\t\t       int mdata_size)\n{\n\tu16 *data = (u16 *) mptr;\n\tint i;\n\n\tfor (i = 0; i < mdata_size / 2; i++, data++)\n\t\tif (!ath9k_hw_nvram_read(ah, i, data))\n\t\t\treturn -EIO;\n\n\treturn 0;\n}\n \nstatic int ar9300_eeprom_restore_internal(struct ath_hw *ah,\n\t\t\t\t\t  u8 *mptr, int mdata_size)\n{\n#define MDEFAULT 15\n#define MSTATE 100\n\tint cptr;\n\tu8 *word;\n\tint code;\n\tint reference, length, major, minor;\n\tint osize;\n\tint it;\n\tu16 checksum, mchecksum;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tstruct ar9300_eeprom *eep;\n\teeprom_read_op read;\n\n\tif (ath9k_hw_use_flash(ah)) {\n\t\tu8 txrx;\n\n\t\tif (ar9300_eeprom_restore_flash(ah, mptr, mdata_size))\n\t\t\treturn -EIO;\n\n\t\t \n\t\teep = (struct ar9300_eeprom *) mptr;\n\t\ttxrx = eep->baseEepHeader.txrxMask;\n\t\tif (txrx != 0 && txrx != 0xff)\n\t\t\treturn 0;\n\t}\n\n\tword = kzalloc(2048, GFP_KERNEL);\n\tif (!word)\n\t\treturn -ENOMEM;\n\n\tmemcpy(mptr, &ar9300_default, mdata_size);\n\n\tread = ar9300_read_eeprom;\n\tif (AR_SREV_9485(ah))\n\t\tcptr = AR9300_BASE_ADDR_4K;\n\telse if (AR_SREV_9330(ah))\n\t\tcptr = AR9300_BASE_ADDR_512;\n\telse\n\t\tcptr = AR9300_BASE_ADDR;\n\tath_dbg(common, EEPROM, \"Trying EEPROM access at Address 0x%04x\\n\",\n\t\tcptr);\n\tif (ar9300_check_eeprom_header(ah, read, cptr))\n\t\tgoto found;\n\n\tcptr = AR9300_BASE_ADDR_4K;\n\tath_dbg(common, EEPROM, \"Trying EEPROM access at Address 0x%04x\\n\",\n\t\tcptr);\n\tif (ar9300_check_eeprom_header(ah, read, cptr))\n\t\tgoto found;\n\n\tcptr = AR9300_BASE_ADDR_512;\n\tath_dbg(common, EEPROM, \"Trying EEPROM access at Address 0x%04x\\n\",\n\t\tcptr);\n\tif (ar9300_check_eeprom_header(ah, read, cptr))\n\t\tgoto found;\n\n\tread = ar9300_read_otp;\n\tcptr = AR9300_BASE_ADDR;\n\tath_dbg(common, EEPROM, \"Trying OTP access at Address 0x%04x\\n\", cptr);\n\tif (ar9300_check_eeprom_header(ah, read, cptr))\n\t\tgoto found;\n\n\tcptr = AR9300_BASE_ADDR_512;\n\tath_dbg(common, EEPROM, \"Trying OTP access at Address 0x%04x\\n\", cptr);\n\tif (ar9300_check_eeprom_header(ah, read, cptr))\n\t\tgoto found;\n\n\tgoto fail;\n\nfound:\n\tath_dbg(common, EEPROM, \"Found valid EEPROM data\\n\");\n\n\tfor (it = 0; it < MSTATE; it++) {\n\t\tif (!read(ah, cptr, word, COMP_HDR_LEN))\n\t\t\tgoto fail;\n\n\t\tif (!ar9300_check_header(word))\n\t\t\tbreak;\n\n\t\tar9300_comp_hdr_unpack(word, &code, &reference,\n\t\t\t\t       &length, &major, &minor);\n\t\tath_dbg(common, EEPROM,\n\t\t\t\"Found block at %x: code=%d ref=%d length=%d major=%d minor=%d\\n\",\n\t\t\tcptr, code, reference, length, major, minor);\n\t\tif ((!AR_SREV_9485(ah) && length >= 1024) ||\n\t\t    (AR_SREV_9485(ah) && length > EEPROM_DATA_LEN_9485) ||\n\t\t    (length > cptr)) {\n\t\t\tath_dbg(common, EEPROM, \"Skipping bad header\\n\");\n\t\t\tcptr -= COMP_HDR_LEN;\n\t\t\tcontinue;\n\t\t}\n\n\t\tosize = length;\n\t\tread(ah, cptr, word, COMP_HDR_LEN + osize + COMP_CKSUM_LEN);\n\t\tchecksum = ar9300_comp_cksum(&word[COMP_HDR_LEN], length);\n\t\tmchecksum = get_unaligned_le16(&word[COMP_HDR_LEN + osize]);\n\t\tath_dbg(common, EEPROM, \"checksum %x %x\\n\",\n\t\t\tchecksum, mchecksum);\n\t\tif (checksum == mchecksum) {\n\t\t\tar9300_compress_decision(ah, it, code, reference, mptr,\n\t\t\t\t\t\t word, length, mdata_size);\n\t\t} else {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"skipping block with bad checksum\\n\");\n\t\t}\n\t\tcptr -= (COMP_HDR_LEN + osize + COMP_CKSUM_LEN);\n\t}\n\n\tkfree(word);\n\treturn cptr;\n\nfail:\n\tkfree(word);\n\treturn -1;\n}\n\n \nstatic bool ath9k_hw_ar9300_fill_eeprom(struct ath_hw *ah)\n{\n\tu8 *mptr = (u8 *) &ah->eeprom.ar9300_eep;\n\n\tif (ar9300_eeprom_restore_internal(ah, mptr,\n\t\t\tsizeof(struct ar9300_eeprom)) < 0)\n\t\treturn false;\n\n\treturn true;\n}\n\n#if defined(CONFIG_ATH9K_DEBUGFS) || defined(CONFIG_ATH9K_HTC_DEBUGFS)\nstatic u32 ar9003_dump_modal_eeprom(char *buf, u32 len, u32 size,\n\t\t\t\t    struct ar9300_modal_eep_header *modal_hdr)\n{\n\tPR_EEP(\"Chain0 Ant. Control\", le16_to_cpu(modal_hdr->antCtrlChain[0]));\n\tPR_EEP(\"Chain1 Ant. Control\", le16_to_cpu(modal_hdr->antCtrlChain[1]));\n\tPR_EEP(\"Chain2 Ant. Control\", le16_to_cpu(modal_hdr->antCtrlChain[2]));\n\tPR_EEP(\"Ant. Common Control\", le32_to_cpu(modal_hdr->antCtrlCommon));\n\tPR_EEP(\"Ant. Common Control2\", le32_to_cpu(modal_hdr->antCtrlCommon2));\n\tPR_EEP(\"Ant. Gain\", modal_hdr->antennaGain);\n\tPR_EEP(\"Switch Settle\", modal_hdr->switchSettling);\n\tPR_EEP(\"Chain0 xatten1DB\", modal_hdr->xatten1DB[0]);\n\tPR_EEP(\"Chain1 xatten1DB\", modal_hdr->xatten1DB[1]);\n\tPR_EEP(\"Chain2 xatten1DB\", modal_hdr->xatten1DB[2]);\n\tPR_EEP(\"Chain0 xatten1Margin\", modal_hdr->xatten1Margin[0]);\n\tPR_EEP(\"Chain1 xatten1Margin\", modal_hdr->xatten1Margin[1]);\n\tPR_EEP(\"Chain2 xatten1Margin\", modal_hdr->xatten1Margin[2]);\n\tPR_EEP(\"Temp Slope\", modal_hdr->tempSlope);\n\tPR_EEP(\"Volt Slope\", modal_hdr->voltSlope);\n\tPR_EEP(\"spur Channels0\", modal_hdr->spurChans[0]);\n\tPR_EEP(\"spur Channels1\", modal_hdr->spurChans[1]);\n\tPR_EEP(\"spur Channels2\", modal_hdr->spurChans[2]);\n\tPR_EEP(\"spur Channels3\", modal_hdr->spurChans[3]);\n\tPR_EEP(\"spur Channels4\", modal_hdr->spurChans[4]);\n\tPR_EEP(\"Chain0 NF Threshold\", modal_hdr->noiseFloorThreshCh[0]);\n\tPR_EEP(\"Chain1 NF Threshold\", modal_hdr->noiseFloorThreshCh[1]);\n\tPR_EEP(\"Chain2 NF Threshold\", modal_hdr->noiseFloorThreshCh[2]);\n\tPR_EEP(\"Quick Drop\", modal_hdr->quick_drop);\n\tPR_EEP(\"txEndToXpaOff\", modal_hdr->txEndToXpaOff);\n\tPR_EEP(\"xPA Bias Level\", modal_hdr->xpaBiasLvl);\n\tPR_EEP(\"txFrameToDataStart\", modal_hdr->txFrameToDataStart);\n\tPR_EEP(\"txFrameToPaOn\", modal_hdr->txFrameToPaOn);\n\tPR_EEP(\"txFrameToXpaOn\", modal_hdr->txFrameToXpaOn);\n\tPR_EEP(\"txClip\", modal_hdr->txClip);\n\tPR_EEP(\"ADC Desired size\", modal_hdr->adcDesiredSize);\n\n\treturn len;\n}\n\nstatic u32 ar9003_dump_cal_data(struct ath_hw *ah, char *buf, u32 len, u32 size,\n\t\t\t\tbool is_2g)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase;\n\tstruct ar9300_cal_data_per_freq_op_loop *cal_pier;\n\tint cal_pier_nr;\n\tint freq;\n\tint i, j;\n\n\tpBase = &eep->baseEepHeader;\n\n\tif (is_2g)\n\t\tcal_pier_nr = AR9300_NUM_2G_CAL_PIERS;\n\telse\n\t\tcal_pier_nr = AR9300_NUM_5G_CAL_PIERS;\n\n\tfor (i = 0; i < AR9300_MAX_CHAINS; i++) {\n\t\tif (!((pBase->txrxMask >> i) & 1))\n\t\t\tcontinue;\n\n\t\tlen += scnprintf(buf + len, size - len, \"Chain %d\\n\", i);\n\n\t\tlen += scnprintf(buf + len, size - len,\n\t\t\t\"Freq\\t ref\\tvolt\\ttemp\\tnf_cal\\tnf_pow\\trx_temp\\n\");\n\n\t\tfor (j = 0; j < cal_pier_nr; j++) {\n\t\t\tif (is_2g) {\n\t\t\t\tcal_pier = &eep->calPierData2G[i][j];\n\t\t\t\tfreq = 2300 + eep->calFreqPier2G[j];\n\t\t\t} else {\n\t\t\t\tcal_pier = &eep->calPierData5G[i][j];\n\t\t\t\tfreq = 4800 + eep->calFreqPier5G[j] * 5;\n\t\t\t}\n\n\t\t\tlen += scnprintf(buf + len, size - len,\n\t\t\t\t\"%d\\t\", freq);\n\n\t\t\tlen += scnprintf(buf + len, size - len,\n\t\t\t\t\"%d\\t%d\\t%d\\t%d\\t%d\\t%d\\n\",\n\t\t\t\tcal_pier->refPower,\n\t\t\t\tcal_pier->voltMeas,\n\t\t\t\tcal_pier->tempMeas,\n\t\t\t\tcal_pier->rxTempMeas ?\n\t\t\t\tN2DBM(cal_pier->rxNoisefloorCal) : 0,\n\t\t\t\tcal_pier->rxTempMeas ?\n\t\t\t\tN2DBM(cal_pier->rxNoisefloorPower) : 0,\n\t\t\t\tcal_pier->rxTempMeas);\n\t\t}\n\t}\n\n\treturn len;\n}\n\nstatic u32 ath9k_hw_ar9003_dump_eeprom(struct ath_hw *ah, bool dump_base_hdr,\n\t\t\t\t       u8 *buf, u32 len, u32 size)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase;\n\n\tif (!dump_base_hdr) {\n\t\tlen += scnprintf(buf + len, size - len,\n\t\t\t\t \"%20s :\\n\", \"2GHz modal Header\");\n\t\tlen = ar9003_dump_modal_eeprom(buf, len, size,\n\t\t\t\t\t\t&eep->modalHeader2G);\n\n\t\tlen += scnprintf(buf + len, size - len, \"Calibration data\\n\");\n\t\tlen = ar9003_dump_cal_data(ah, buf, len, size, true);\n\n\t\tlen += scnprintf(buf + len, size - len,\n\t\t\t\t \"%20s :\\n\", \"5GHz modal Header\");\n\t\tlen = ar9003_dump_modal_eeprom(buf, len, size,\n\t\t\t\t\t\t&eep->modalHeader5G);\n\n\t\tlen += scnprintf(buf + len, size - len, \"Calibration data\\n\");\n\t\tlen = ar9003_dump_cal_data(ah, buf, len, size, false);\n\n\t\tgoto out;\n\t}\n\n\tpBase = &eep->baseEepHeader;\n\n\tPR_EEP(\"EEPROM Version\", ah->eeprom.ar9300_eep.eepromVersion);\n\tPR_EEP(\"RegDomain1\", le16_to_cpu(pBase->regDmn[0]));\n\tPR_EEP(\"RegDomain2\", le16_to_cpu(pBase->regDmn[1]));\n\tPR_EEP(\"TX Mask\", (pBase->txrxMask >> 4));\n\tPR_EEP(\"RX Mask\", (pBase->txrxMask & 0x0f));\n\tPR_EEP(\"Allow 5GHz\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\tAR5416_OPFLAGS_11A));\n\tPR_EEP(\"Allow 2GHz\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\tAR5416_OPFLAGS_11G));\n\tPR_EEP(\"Disable 2GHz HT20\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\t\tAR5416_OPFLAGS_N_2G_HT20));\n\tPR_EEP(\"Disable 2GHz HT40\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\t\tAR5416_OPFLAGS_N_2G_HT40));\n\tPR_EEP(\"Disable 5Ghz HT20\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\t\tAR5416_OPFLAGS_N_5G_HT20));\n\tPR_EEP(\"Disable 5Ghz HT40\", !!(pBase->opCapFlags.opFlags &\n\t\t\t\t\tAR5416_OPFLAGS_N_5G_HT40));\n\tPR_EEP(\"Big Endian\", !!(pBase->opCapFlags.eepMisc &\n\t\t\t\tAR5416_EEPMISC_BIG_ENDIAN));\n\tPR_EEP(\"RF Silent\", pBase->rfSilent);\n\tPR_EEP(\"BT option\", pBase->blueToothOptions);\n\tPR_EEP(\"Device Cap\", pBase->deviceCap);\n\tPR_EEP(\"Device Type\", pBase->deviceType);\n\tPR_EEP(\"Power Table Offset\", pBase->pwrTableOffset);\n\tPR_EEP(\"Tuning Caps1\", pBase->params_for_tuning_caps[0]);\n\tPR_EEP(\"Tuning Caps2\", pBase->params_for_tuning_caps[1]);\n\tPR_EEP(\"Enable Tx Temp Comp\", !!(pBase->featureEnable & BIT(0)));\n\tPR_EEP(\"Enable Tx Volt Comp\", !!(pBase->featureEnable & BIT(1)));\n\tPR_EEP(\"Enable fast clock\", !!(pBase->featureEnable & BIT(2)));\n\tPR_EEP(\"Enable doubling\", !!(pBase->featureEnable & BIT(3)));\n\tPR_EEP(\"Internal regulator\", !!(pBase->featureEnable & BIT(4)));\n\tPR_EEP(\"Enable Paprd\", !!(pBase->featureEnable & BIT(5)));\n\tPR_EEP(\"Driver Strength\", !!(pBase->miscConfiguration & BIT(0)));\n\tPR_EEP(\"Quick Drop\", !!(pBase->miscConfiguration & BIT(1)));\n\tPR_EEP(\"Chain mask Reduce\", (pBase->miscConfiguration >> 0x3) & 0x1);\n\tPR_EEP(\"Write enable Gpio\", pBase->eepromWriteEnableGpio);\n\tPR_EEP(\"WLAN Disable Gpio\", pBase->wlanDisableGpio);\n\tPR_EEP(\"WLAN LED Gpio\", pBase->wlanLedGpio);\n\tPR_EEP(\"Rx Band Select Gpio\", pBase->rxBandSelectGpio);\n\tPR_EEP(\"Tx Gain\", pBase->txrxgain >> 4);\n\tPR_EEP(\"Rx Gain\", pBase->txrxgain & 0xf);\n\tPR_EEP(\"SW Reg\", le32_to_cpu(pBase->swreg));\n\n\tlen += scnprintf(buf + len, size - len, \"%20s : %pM\\n\", \"MacAddress\",\n\t\t\t ah->eeprom.ar9300_eep.macAddr);\nout:\n\tif (len > size)\n\t\tlen = size;\n\n\treturn len;\n}\n#else\nstatic u32 ath9k_hw_ar9003_dump_eeprom(struct ath_hw *ah, bool dump_base_hdr,\n\t\t\t\t       u8 *buf, u32 len, u32 size)\n{\n\treturn 0;\n}\n#endif\n\n \nstatic int ath9k_hw_ar9300_get_eeprom_ver(struct ath_hw *ah)\n{\n\treturn ah->eeprom.ar9300_eep.eepromVersion;\n}\n\n \nstatic int ath9k_hw_ar9300_get_eeprom_rev(struct ath_hw *ah)\n{\n\treturn 0;\n}\n\nstatic struct ar9300_modal_eep_header *ar9003_modal_header(struct ath_hw *ah,\n\t\t\t\t\t\t\t   bool is2ghz)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\n\tif (is2ghz)\n\t\treturn &eep->modalHeader2G;\n\telse\n\t\treturn &eep->modalHeader5G;\n}\n\nstatic void ar9003_hw_xpa_bias_level_apply(struct ath_hw *ah, bool is2ghz)\n{\n\tint bias = ar9003_modal_header(ah, is2ghz)->xpaBiasLvl;\n\n\tif (AR_SREV_9485(ah) || AR_SREV_9330(ah) || AR_SREV_9340(ah) ||\n\t    AR_SREV_9531(ah) || AR_SREV_9561(ah))\n\t\tREG_RMW_FIELD(ah, AR_CH0_TOP2(ah), AR_CH0_TOP2_XPABIASLVL, bias);\n\telse if (AR_SREV_9462(ah) || AR_SREV_9550(ah) || AR_SREV_9565(ah))\n\t\tREG_RMW_FIELD(ah, AR_CH0_TOP(ah), AR_CH0_TOP_XPABIASLVL, bias);\n\telse {\n\t\tREG_RMW_FIELD(ah, AR_CH0_TOP(ah), AR_CH0_TOP_XPABIASLVL, bias);\n\t\tREG_RMW_FIELD(ah, AR_CH0_THERM(ah),\n\t\t\t\tAR_CH0_THERM_XPABIASLVL_MSB,\n\t\t\t\tbias >> 2);\n\t\tREG_RMW_FIELD(ah, AR_CH0_THERM(ah),\n\t\t\t\tAR_CH0_THERM_XPASHORT2GND, 1);\n\t}\n}\n\nstatic u16 ar9003_switch_com_spdt_get(struct ath_hw *ah, bool is2ghz)\n{\n\treturn le16_to_cpu(ar9003_modal_header(ah, is2ghz)->switchcomspdt);\n}\n\nu32 ar9003_hw_ant_ctrl_common_get(struct ath_hw *ah, bool is2ghz)\n{\n\treturn le32_to_cpu(ar9003_modal_header(ah, is2ghz)->antCtrlCommon);\n}\n\nu32 ar9003_hw_ant_ctrl_common_2_get(struct ath_hw *ah, bool is2ghz)\n{\n\treturn le32_to_cpu(ar9003_modal_header(ah, is2ghz)->antCtrlCommon2);\n}\n\nstatic u16 ar9003_hw_ant_ctrl_chain_get(struct ath_hw *ah, int chain,\n\t\t\t\t\tbool is2ghz)\n{\n\t__le16 val = ar9003_modal_header(ah, is2ghz)->antCtrlChain[chain];\n\treturn le16_to_cpu(val);\n}\n\nstatic void ar9003_hw_ant_ctrl_apply(struct ath_hw *ah, bool is2ghz)\n{\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tstruct ath9k_hw_capabilities *pCap = &ah->caps;\n\tint chain;\n\tu32 regval, value, gpio;\n\tstatic const u32 switch_chain_reg[AR9300_MAX_CHAINS] = {\n\t\t\tAR_PHY_SWITCH_CHAIN_0,\n\t\t\tAR_PHY_SWITCH_CHAIN_1,\n\t\t\tAR_PHY_SWITCH_CHAIN_2,\n\t};\n\n\tif (AR_SREV_9485(ah) && (ar9003_hw_get_rx_gain_idx(ah) == 0)) {\n\t\tif (ah->config.xlna_gpio)\n\t\t\tgpio = ah->config.xlna_gpio;\n\t\telse\n\t\t\tgpio = AR9300_EXT_LNA_CTL_GPIO_AR9485;\n\n\t\tath9k_hw_gpio_request_out(ah, gpio, NULL,\n\t\t\t\t\t  AR_GPIO_OUTPUT_MUX_AS_PCIE_ATTENTION_LED);\n\t}\n\n\tvalue = ar9003_hw_ant_ctrl_common_get(ah, is2ghz);\n\n\tif (AR_SREV_9462(ah) || AR_SREV_9565(ah)) {\n\t\tREG_RMW_FIELD(ah, AR_PHY_SWITCH_COM,\n\t\t\t\tAR_SWITCH_TABLE_COM_AR9462_ALL, value);\n\t} else if (AR_SREV_9550(ah) || AR_SREV_9531(ah) || AR_SREV_9561(ah)) {\n\t\tREG_RMW_FIELD(ah, AR_PHY_SWITCH_COM,\n\t\t\t\tAR_SWITCH_TABLE_COM_AR9550_ALL, value);\n\t} else\n\t\tREG_RMW_FIELD(ah, AR_PHY_SWITCH_COM,\n\t\t\t      AR_SWITCH_TABLE_COM_ALL, value);\n\n\n\t \n\tif (AR_SREV_9462_20_OR_LATER(ah) || AR_SREV_9565(ah)) {\n\t\tvalue = ar9003_switch_com_spdt_get(ah, is2ghz);\n\t\tREG_RMW_FIELD(ah, AR_PHY_GLB_CONTROL,\n\t\t\t\tAR_SWITCH_TABLE_COM_SPDT_ALL, value);\n\t\tREG_SET_BIT(ah, AR_PHY_GLB_CONTROL, AR_BTCOEX_CTRL_SPDT_ENABLE);\n\t}\n\n\tvalue = ar9003_hw_ant_ctrl_common_2_get(ah, is2ghz);\n\tif (AR_SREV_9485(ah) && common->bt_ant_diversity) {\n\t\tvalue &= ~AR_SWITCH_TABLE_COM2_ALL;\n\t\tvalue |= ah->config.ant_ctrl_comm2g_switch_enable;\n\n\t}\n\tREG_RMW_FIELD(ah, AR_PHY_SWITCH_COM_2, AR_SWITCH_TABLE_COM2_ALL, value);\n\n\tif ((AR_SREV_9462(ah)) && (ah->rxchainmask == 0x2)) {\n\t\tvalue = ar9003_hw_ant_ctrl_chain_get(ah, 1, is2ghz);\n\t\tREG_RMW_FIELD(ah, switch_chain_reg[0],\n\t\t\t      AR_SWITCH_TABLE_ALL, value);\n\t}\n\n\tfor (chain = 0; chain < AR9300_MAX_CHAINS; chain++) {\n\t\tif ((ah->rxchainmask & BIT(chain)) ||\n\t\t    (ah->txchainmask & BIT(chain))) {\n\t\t\tvalue = ar9003_hw_ant_ctrl_chain_get(ah, chain,\n\t\t\t\t\t\t\t     is2ghz);\n\t\t\tREG_RMW_FIELD(ah, switch_chain_reg[chain],\n\t\t\t\t      AR_SWITCH_TABLE_ALL, value);\n\t\t}\n\t}\n\n\tif (AR_SREV_9330(ah) || AR_SREV_9485(ah) || AR_SREV_9565(ah)) {\n\t\tvalue = ath9k_hw_ar9300_get_eeprom(ah, EEP_ANT_DIV_CTL1);\n\t\t \n\t\tregval = REG_READ(ah, AR_PHY_MC_GAIN_CTRL);\n\t\tregval &= (~AR_ANT_DIV_CTRL_ALL);\n\t\tregval |= (value & 0x3f) << AR_ANT_DIV_CTRL_ALL_S;\n\t\t \n\t\tregval &= (~AR_PHY_ANT_DIV_LNADIV);\n\t\tregval |= ((value >> 6) & 0x1) << AR_PHY_ANT_DIV_LNADIV_S;\n\n\t\tif (AR_SREV_9485(ah) && common->bt_ant_diversity)\n\t\t\tregval |= AR_ANT_DIV_ENABLE;\n\n\t\tif (AR_SREV_9565(ah)) {\n\t\t\tif (common->bt_ant_diversity) {\n\t\t\t\tregval |= (1 << AR_PHY_ANT_SW_RX_PROT_S);\n\n\t\t\t\tREG_SET_BIT(ah, AR_PHY_RESTART,\n\t\t\t\t\t    AR_PHY_RESTART_ENABLE_DIV_M2FLAG);\n\n\t\t\t\t \n\t\t\t\tREG_SET_BIT(ah, AR_BTCOEX_WL_LNADIV,\n\t\t\t\t\t    AR_BTCOEX_WL_LNADIV_FORCE_ON);\n\t\t\t} else {\n\t\t\t\tregval &= ~(1 << AR_PHY_ANT_DIV_LNADIV_S);\n\t\t\t\tregval &= ~(1 << AR_PHY_ANT_SW_RX_PROT_S);\n\n\t\t\t\tREG_CLR_BIT(ah, AR_PHY_MC_GAIN_CTRL,\n\t\t\t\t\t    (1 << AR_PHY_ANT_SW_RX_PROT_S));\n\n\t\t\t\t \n\t\t\t\tREG_CLR_BIT(ah, AR_BTCOEX_WL_LNADIV,\n\t\t\t\t\t    AR_BTCOEX_WL_LNADIV_FORCE_ON);\n\t\t\t}\n\t\t}\n\n\t\tREG_WRITE(ah, AR_PHY_MC_GAIN_CTRL, regval);\n\n\t\t \n\t\tregval = REG_READ(ah, AR_PHY_CCK_DETECT);\n\t\tregval &= (~AR_FAST_DIV_ENABLE);\n\t\tregval |= ((value >> 7) & 0x1) << AR_FAST_DIV_ENABLE_S;\n\n\t\tif ((AR_SREV_9485(ah) || AR_SREV_9565(ah))\n\t\t    && common->bt_ant_diversity)\n\t\t\tregval |= AR_FAST_DIV_ENABLE;\n\n\t\tREG_WRITE(ah, AR_PHY_CCK_DETECT, regval);\n\n\t\tif (pCap->hw_caps & ATH9K_HW_CAP_ANT_DIV_COMB) {\n\t\t\tregval = REG_READ(ah, AR_PHY_MC_GAIN_CTRL);\n\t\t\t \n\t\t\tregval &= (~(AR_PHY_ANT_DIV_MAIN_LNACONF |\n\t\t\t\t     AR_PHY_ANT_DIV_ALT_LNACONF |\n\t\t\t\t     AR_PHY_ANT_DIV_ALT_GAINTB |\n\t\t\t\t     AR_PHY_ANT_DIV_MAIN_GAINTB));\n\t\t\t \n\t\t\tregval |= (ATH_ANT_DIV_COMB_LNA1 <<\n\t\t\t\t   AR_PHY_ANT_DIV_MAIN_LNACONF_S);\n\t\t\tregval |= (ATH_ANT_DIV_COMB_LNA2 <<\n\t\t\t\t   AR_PHY_ANT_DIV_ALT_LNACONF_S);\n\t\t\tREG_WRITE(ah, AR_PHY_MC_GAIN_CTRL, regval);\n\t\t}\n\t}\n}\n\nstatic void ar9003_hw_drive_strength_apply(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase = &eep->baseEepHeader;\n\tint drive_strength;\n\tunsigned long reg;\n\n\tdrive_strength = pBase->miscConfiguration & BIT(0);\n\tif (!drive_strength)\n\t\treturn;\n\n\treg = REG_READ(ah, AR_PHY_65NM_CH0_BIAS1);\n\treg &= ~0x00ffffc0;\n\treg |= 0x5 << 21;\n\treg |= 0x5 << 18;\n\treg |= 0x5 << 15;\n\treg |= 0x5 << 12;\n\treg |= 0x5 << 9;\n\treg |= 0x5 << 6;\n\tREG_WRITE(ah, AR_PHY_65NM_CH0_BIAS1, reg);\n\n\treg = REG_READ(ah, AR_PHY_65NM_CH0_BIAS2);\n\treg &= ~0xffffffe0;\n\treg |= 0x5 << 29;\n\treg |= 0x5 << 26;\n\treg |= 0x5 << 23;\n\treg |= 0x5 << 20;\n\treg |= 0x5 << 17;\n\treg |= 0x5 << 14;\n\treg |= 0x5 << 11;\n\treg |= 0x5 << 8;\n\treg |= 0x5 << 5;\n\tREG_WRITE(ah, AR_PHY_65NM_CH0_BIAS2, reg);\n\n\treg = REG_READ(ah, AR_PHY_65NM_CH0_BIAS4);\n\treg &= ~0xff800000;\n\treg |= 0x5 << 29;\n\treg |= 0x5 << 26;\n\treg |= 0x5 << 23;\n\tREG_WRITE(ah, AR_PHY_65NM_CH0_BIAS4, reg);\n}\n\nstatic u16 ar9003_hw_atten_chain_get(struct ath_hw *ah, int chain,\n\t\t\t\t     struct ath9k_channel *chan)\n{\n\tint f[3], t[3];\n\tu16 value;\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\n\tif (chain >= 0 && chain < 3) {\n\t\tif (IS_CHAN_2GHZ(chan))\n\t\t\treturn eep->modalHeader2G.xatten1DB[chain];\n\t\telse if (eep->base_ext2.xatten1DBLow[chain] != 0) {\n\t\t\tt[0] = eep->base_ext2.xatten1DBLow[chain];\n\t\t\tf[0] = 5180;\n\t\t\tt[1] = eep->modalHeader5G.xatten1DB[chain];\n\t\t\tf[1] = 5500;\n\t\t\tt[2] = eep->base_ext2.xatten1DBHigh[chain];\n\t\t\tf[2] = 5785;\n\t\t\tvalue = ar9003_hw_power_interpolate((s32) chan->channel,\n\t\t\t\t\t\t\t    f, t, 3);\n\t\t\treturn value;\n\t\t} else\n\t\t\treturn eep->modalHeader5G.xatten1DB[chain];\n\t}\n\n\treturn 0;\n}\n\n\nstatic u16 ar9003_hw_atten_chain_get_margin(struct ath_hw *ah, int chain,\n\t\t\t\t\t    struct ath9k_channel *chan)\n{\n\tint f[3], t[3];\n\tu16 value;\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\n\tif (chain >= 0 && chain < 3) {\n\t\tif (IS_CHAN_2GHZ(chan))\n\t\t\treturn eep->modalHeader2G.xatten1Margin[chain];\n\t\telse if (eep->base_ext2.xatten1MarginLow[chain] != 0) {\n\t\t\tt[0] = eep->base_ext2.xatten1MarginLow[chain];\n\t\t\tf[0] = 5180;\n\t\t\tt[1] = eep->modalHeader5G.xatten1Margin[chain];\n\t\t\tf[1] = 5500;\n\t\t\tt[2] = eep->base_ext2.xatten1MarginHigh[chain];\n\t\t\tf[2] = 5785;\n\t\t\tvalue = ar9003_hw_power_interpolate((s32) chan->channel,\n\t\t\t\t\t\t\t    f, t, 3);\n\t\t\treturn value;\n\t\t} else\n\t\t\treturn eep->modalHeader5G.xatten1Margin[chain];\n\t}\n\n\treturn 0;\n}\n\nstatic void ar9003_hw_atten_apply(struct ath_hw *ah, struct ath9k_channel *chan)\n{\n\tint i;\n\tu16 value;\n\tunsigned long ext_atten_reg[3] = {AR_PHY_EXT_ATTEN_CTL_0,\n\t\t\t\t\t  AR_PHY_EXT_ATTEN_CTL_1,\n\t\t\t\t\t  AR_PHY_EXT_ATTEN_CTL_2,\n\t\t\t\t\t };\n\n\tif ((AR_SREV_9462(ah)) && (ah->rxchainmask == 0x2)) {\n\t\tvalue = ar9003_hw_atten_chain_get(ah, 1, chan);\n\t\tREG_RMW_FIELD(ah, ext_atten_reg[0],\n\t\t\t      AR_PHY_EXT_ATTEN_CTL_XATTEN1_DB, value);\n\n\t\tvalue = ar9003_hw_atten_chain_get_margin(ah, 1, chan);\n\t\tREG_RMW_FIELD(ah, ext_atten_reg[0],\n\t\t\t      AR_PHY_EXT_ATTEN_CTL_XATTEN1_MARGIN,\n\t\t\t      value);\n\t}\n\n\t \n\tfor (i = 0; i < AR9300_MAX_CHAINS; i++) {\n\t\tif (ah->txchainmask & BIT(i)) {\n\t\t\tvalue = ar9003_hw_atten_chain_get(ah, i, chan);\n\t\t\tREG_RMW_FIELD(ah, ext_atten_reg[i],\n\t\t\t\t      AR_PHY_EXT_ATTEN_CTL_XATTEN1_DB, value);\n\n\t\t\tif (AR_SREV_9485(ah) &&\n\t\t\t    (ar9003_hw_get_rx_gain_idx(ah) == 0) &&\n\t\t\t    ah->config.xatten_margin_cfg)\n\t\t\t\tvalue = 5;\n\t\t\telse\n\t\t\t\tvalue = ar9003_hw_atten_chain_get_margin(ah, i, chan);\n\n\t\t\tif (ah->config.alt_mingainidx)\n\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_EXT_ATTEN_CTL_0,\n\t\t\t\t\t      AR_PHY_EXT_ATTEN_CTL_XATTEN1_MARGIN,\n\t\t\t\t\t      value);\n\n\t\t\tREG_RMW_FIELD(ah, ext_atten_reg[i],\n\t\t\t\t      AR_PHY_EXT_ATTEN_CTL_XATTEN1_MARGIN,\n\t\t\t\t      value);\n\t\t}\n\t}\n}\n\nstatic bool is_pmu_set(struct ath_hw *ah, u32 pmu_reg, int pmu_set)\n{\n\tint timeout = 100;\n\n\twhile (pmu_set != REG_READ(ah, pmu_reg)) {\n\t\tif (timeout-- == 0)\n\t\t\treturn false;\n\t\tREG_WRITE(ah, pmu_reg, pmu_set);\n\t\tudelay(10);\n\t}\n\n\treturn true;\n}\n\nvoid ar9003_hw_internal_regulator_apply(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase = &eep->baseEepHeader;\n\tu32 reg_val;\n\n\tif (pBase->featureEnable & BIT(4)) {\n\t\tif (AR_SREV_9330(ah) || AR_SREV_9485(ah)) {\n\t\t\tint reg_pmu_set;\n\n\t\t\treg_pmu_set = REG_READ(ah, AR_PHY_PMU2(ah)) & ~AR_PHY_PMU2_PGM;\n\t\t\tREG_WRITE(ah, AR_PHY_PMU2(ah), reg_pmu_set);\n\t\t\tif (!is_pmu_set(ah, AR_PHY_PMU2(ah), reg_pmu_set))\n\t\t\t\treturn;\n\n\t\t\tif (AR_SREV_9330(ah)) {\n\t\t\t\tif (ah->is_clk_25mhz) {\n\t\t\t\t\treg_pmu_set = (3 << 1) | (8 << 4) |\n\t\t\t\t\t\t      (3 << 8) | (1 << 14) |\n\t\t\t\t\t\t      (6 << 17) | (1 << 20) |\n\t\t\t\t\t\t      (3 << 24);\n\t\t\t\t} else {\n\t\t\t\t\treg_pmu_set = (4 << 1)  | (7 << 4) |\n\t\t\t\t\t\t      (3 << 8)  | (1 << 14) |\n\t\t\t\t\t\t      (6 << 17) | (1 << 20) |\n\t\t\t\t\t\t      (3 << 24);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treg_pmu_set = (5 << 1) | (7 << 4) |\n\t\t\t\t\t      (2 << 8) | (2 << 14) |\n\t\t\t\t\t      (6 << 17) | (1 << 20) |\n\t\t\t\t\t      (3 << 24) | (1 << 28);\n\t\t\t}\n\n\t\t\tREG_WRITE(ah, AR_PHY_PMU1(ah), reg_pmu_set);\n\t\t\tif (!is_pmu_set(ah, AR_PHY_PMU1(ah), reg_pmu_set))\n\t\t\t\treturn;\n\n\t\t\treg_pmu_set = (REG_READ(ah, AR_PHY_PMU2(ah)) & ~0xFFC00000)\n\t\t\t\t\t| (4 << 26);\n\t\t\tREG_WRITE(ah, AR_PHY_PMU2(ah), reg_pmu_set);\n\t\t\tif (!is_pmu_set(ah, AR_PHY_PMU2(ah), reg_pmu_set))\n\t\t\t\treturn;\n\n\t\t\treg_pmu_set = (REG_READ(ah, AR_PHY_PMU2(ah)) & ~0x00200000)\n\t\t\t\t\t| (1 << 21);\n\t\t\tREG_WRITE(ah, AR_PHY_PMU2(ah), reg_pmu_set);\n\t\t\tif (!is_pmu_set(ah, AR_PHY_PMU2(ah), reg_pmu_set))\n\t\t\t\treturn;\n\t\t} else if (AR_SREV_9462(ah) || AR_SREV_9565(ah) ||\n\t\t\t   AR_SREV_9561(ah)) {\n\t\t\treg_val = le32_to_cpu(pBase->swreg);\n\t\t\tREG_WRITE(ah, AR_PHY_PMU1(ah), reg_val);\n\n\t\t\tif (AR_SREV_9561(ah))\n\t\t\t\tREG_WRITE(ah, AR_PHY_PMU2(ah), 0x10200000);\n\t\t} else {\n\t\t\t \n\t\t\treg_val = le32_to_cpu(pBase->swreg);\n\t\t\tREG_WRITE(ah, AR_RTC_REG_CONTROL1,\n\t\t\t\t  REG_READ(ah, AR_RTC_REG_CONTROL1) &\n\t\t\t\t  (~AR_RTC_REG_CONTROL1_SWREG_PROGRAM));\n\t\t\tREG_WRITE(ah, AR_RTC_REG_CONTROL0, reg_val);\n\t\t\t \n\t\t\tREG_WRITE(ah, AR_RTC_REG_CONTROL1,\n\t\t\t\t  REG_READ(ah,\n\t\t\t\t\t   AR_RTC_REG_CONTROL1) |\n\t\t\t\t\t   AR_RTC_REG_CONTROL1_SWREG_PROGRAM);\n\t\t}\n\t} else {\n\t\tif (AR_SREV_9330(ah) || AR_SREV_9485(ah)) {\n\t\t\tREG_RMW_FIELD(ah, AR_PHY_PMU2(ah), AR_PHY_PMU2_PGM, 0);\n\t\t\twhile (REG_READ_FIELD(ah, AR_PHY_PMU2(ah),\n\t\t\t\t\t\tAR_PHY_PMU2_PGM))\n\t\t\t\tudelay(10);\n\n\t\t\tREG_RMW_FIELD(ah, AR_PHY_PMU1(ah), AR_PHY_PMU1_PWD, 0x1);\n\t\t\twhile (!REG_READ_FIELD(ah, AR_PHY_PMU1(ah),\n\t\t\t\t\t\tAR_PHY_PMU1_PWD))\n\t\t\t\tudelay(10);\n\t\t\tREG_RMW_FIELD(ah, AR_PHY_PMU2(ah), AR_PHY_PMU2_PGM, 0x1);\n\t\t\twhile (!REG_READ_FIELD(ah, AR_PHY_PMU2(ah),\n\t\t\t\t\t\tAR_PHY_PMU2_PGM))\n\t\t\t\tudelay(10);\n\t\t} else if (AR_SREV_9462(ah) || AR_SREV_9565(ah))\n\t\t\tREG_RMW_FIELD(ah, AR_PHY_PMU1(ah), AR_PHY_PMU1_PWD, 0x1);\n\t\telse {\n\t\t\treg_val = REG_READ(ah, AR_RTC_SLEEP_CLK(ah)) |\n\t\t\t\tAR_RTC_FORCE_SWREG_PRD;\n\t\t\tREG_WRITE(ah, AR_RTC_SLEEP_CLK(ah), reg_val);\n\t\t}\n\t}\n\n}\n\nstatic void ar9003_hw_apply_tuning_caps(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tu8 tuning_caps_param = eep->baseEepHeader.params_for_tuning_caps[0];\n\n\tif (AR_SREV_9340(ah) || AR_SREV_9531(ah))\n\t\treturn;\n\n\tif (eep->baseEepHeader.featureEnable & 0x40) {\n\t\ttuning_caps_param &= 0x7f;\n\t\tREG_RMW_FIELD(ah, AR_CH0_XTAL(ah), AR_CH0_XTAL_CAPINDAC,\n\t\t\t      tuning_caps_param);\n\t\tREG_RMW_FIELD(ah, AR_CH0_XTAL(ah), AR_CH0_XTAL_CAPOUTDAC,\n\t\t\t      tuning_caps_param);\n\t}\n}\n\nstatic void ar9003_hw_quick_drop_apply(struct ath_hw *ah, u16 freq)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase = &eep->baseEepHeader;\n\tint quick_drop;\n\ts32 t[3], f[3] = {5180, 5500, 5785};\n\n\tif (!(pBase->miscConfiguration & BIT(4)))\n\t\treturn;\n\n\tif (AR_SREV_9300(ah) || AR_SREV_9580(ah) || AR_SREV_9340(ah)) {\n\t\tif (freq < 4000) {\n\t\t\tquick_drop = eep->modalHeader2G.quick_drop;\n\t\t} else {\n\t\t\tt[0] = eep->base_ext1.quick_drop_low;\n\t\t\tt[1] = eep->modalHeader5G.quick_drop;\n\t\t\tt[2] = eep->base_ext1.quick_drop_high;\n\t\t\tquick_drop = ar9003_hw_power_interpolate(freq, f, t, 3);\n\t\t}\n\t\tREG_RMW_FIELD(ah, AR_PHY_AGC, AR_PHY_AGC_QUICK_DROP, quick_drop);\n\t}\n}\n\nstatic void ar9003_hw_txend_to_xpa_off_apply(struct ath_hw *ah, bool is2ghz)\n{\n\tu32 value;\n\n\tvalue = ar9003_modal_header(ah, is2ghz)->txEndToXpaOff;\n\n\tREG_RMW_FIELD(ah, AR_PHY_XPA_TIMING_CTL,\n\t\t      AR_PHY_XPA_TIMING_CTL_TX_END_XPAB_OFF, value);\n\tREG_RMW_FIELD(ah, AR_PHY_XPA_TIMING_CTL,\n\t\t      AR_PHY_XPA_TIMING_CTL_TX_END_XPAA_OFF, value);\n}\n\nstatic void ar9003_hw_xpa_timing_control_apply(struct ath_hw *ah, bool is2ghz)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tu8 xpa_ctl;\n\n\tif (!(eep->baseEepHeader.featureEnable & 0x80))\n\t\treturn;\n\n\tif (!AR_SREV_9300(ah) &&\n\t    !AR_SREV_9340(ah) &&\n\t    !AR_SREV_9580(ah) &&\n\t    !AR_SREV_9531(ah) &&\n\t    !AR_SREV_9561(ah))\n\t\treturn;\n\n\txpa_ctl = ar9003_modal_header(ah, is2ghz)->txFrameToXpaOn;\n\tif (is2ghz)\n\t\tREG_RMW_FIELD(ah, AR_PHY_XPA_TIMING_CTL,\n\t\t\t      AR_PHY_XPA_TIMING_CTL_FRAME_XPAB_ON, xpa_ctl);\n\telse\n\t\tREG_RMW_FIELD(ah, AR_PHY_XPA_TIMING_CTL,\n\t\t\t      AR_PHY_XPA_TIMING_CTL_FRAME_XPAA_ON, xpa_ctl);\n}\n\nstatic void ar9003_hw_xlna_bias_strength_apply(struct ath_hw *ah, bool is2ghz)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tu8 bias;\n\n\tif (!(eep->baseEepHeader.miscConfiguration & 0x40))\n\t\treturn;\n\n\tif (!AR_SREV_9300(ah))\n\t\treturn;\n\n\tbias = ar9003_modal_header(ah, is2ghz)->xlna_bias_strength;\n\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH0_RXTX4, AR_PHY_65NM_RXTX4_XLNA_BIAS,\n\t\t      bias & 0x3);\n\tbias >>= 2;\n\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH1_RXTX4, AR_PHY_65NM_RXTX4_XLNA_BIAS,\n\t\t      bias & 0x3);\n\tbias >>= 2;\n\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH2_RXTX4, AR_PHY_65NM_RXTX4_XLNA_BIAS,\n\t\t      bias & 0x3);\n}\n\nstatic int ar9003_hw_get_thermometer(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ar9300_base_eep_hdr *pBase = &eep->baseEepHeader;\n\tint thermometer =  (pBase->miscConfiguration >> 1) & 0x3;\n\n\treturn --thermometer;\n}\n\nstatic void ar9003_hw_thermometer_apply(struct ath_hw *ah)\n{\n\tstruct ath9k_hw_capabilities *pCap = &ah->caps;\n\tint thermometer = ar9003_hw_get_thermometer(ah);\n\tu8 therm_on = (thermometer < 0) ? 0 : 1;\n\n\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH0_RXTX4,\n\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON_OVR, therm_on);\n\tif (pCap->chip_chainmask & BIT(1))\n\t\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH1_RXTX4,\n\t\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON_OVR, therm_on);\n\tif (pCap->chip_chainmask & BIT(2))\n\t\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH2_RXTX4,\n\t\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON_OVR, therm_on);\n\n\ttherm_on = thermometer == 0;\n\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH0_RXTX4,\n\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON, therm_on);\n\tif (pCap->chip_chainmask & BIT(1)) {\n\t\ttherm_on = thermometer == 1;\n\t\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH1_RXTX4,\n\t\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON, therm_on);\n\t}\n\tif (pCap->chip_chainmask & BIT(2)) {\n\t\ttherm_on = thermometer == 2;\n\t\tREG_RMW_FIELD(ah, AR_PHY_65NM_CH2_RXTX4,\n\t\t\t      AR_PHY_65NM_CH0_RXTX4_THERM_ON, therm_on);\n\t}\n}\n\nstatic void ar9003_hw_thermo_cal_apply(struct ath_hw *ah)\n{\n\tu32 data = 0, ko, kg;\n\n\tif (!AR_SREV_9462_20_OR_LATER(ah))\n\t\treturn;\n\n\tar9300_otp_read_word(ah, 1, &data);\n\tko = data & 0xff;\n\tkg = (data >> 8) & 0xff;\n\tif (ko || kg) {\n\t\tREG_RMW_FIELD(ah, AR_PHY_BB_THERM_ADC_3,\n\t\t\t      AR_PHY_BB_THERM_ADC_3_THERM_ADC_OFFSET, ko);\n\t\tREG_RMW_FIELD(ah, AR_PHY_BB_THERM_ADC_3,\n\t\t\t      AR_PHY_BB_THERM_ADC_3_THERM_ADC_SCALE_GAIN,\n\t\t\t      kg + 256);\n\t}\n}\n\nstatic void ar9003_hw_apply_minccapwr_thresh(struct ath_hw *ah,\n\t\t\t\t\t     bool is2ghz)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tconst u_int32_t cca_ctrl[AR9300_MAX_CHAINS] = {\n\t\tAR_PHY_CCA_CTRL_0,\n\t\tAR_PHY_CCA_CTRL_1,\n\t\tAR_PHY_CCA_CTRL_2,\n\t};\n\tint chain;\n\tu32 val;\n\n\tif (is2ghz) {\n\t\tif (!(eep->base_ext1.misc_enable & BIT(2)))\n\t\t\treturn;\n\t} else {\n\t\tif (!(eep->base_ext1.misc_enable & BIT(3)))\n\t\t\treturn;\n\t}\n\n\tfor (chain = 0; chain < AR9300_MAX_CHAINS; chain++) {\n\t\tif (!(ah->caps.tx_chainmask & BIT(chain)))\n\t\t\tcontinue;\n\n\t\tval = ar9003_modal_header(ah, is2ghz)->noiseFloorThreshCh[chain];\n\t\tREG_RMW_FIELD(ah, cca_ctrl[chain],\n\t\t\t      AR_PHY_EXT_CCA0_THRESH62_1, val);\n\t}\n\n}\n\nstatic void ath9k_hw_ar9300_set_board_values(struct ath_hw *ah,\n\t\t\t\t\t     struct ath9k_channel *chan)\n{\n\tbool is2ghz = IS_CHAN_2GHZ(chan);\n\tar9003_hw_xpa_timing_control_apply(ah, is2ghz);\n\tar9003_hw_xpa_bias_level_apply(ah, is2ghz);\n\tar9003_hw_ant_ctrl_apply(ah, is2ghz);\n\tar9003_hw_drive_strength_apply(ah);\n\tar9003_hw_xlna_bias_strength_apply(ah, is2ghz);\n\tar9003_hw_atten_apply(ah, chan);\n\tar9003_hw_quick_drop_apply(ah, chan->channel);\n\tif (!AR_SREV_9330(ah) && !AR_SREV_9340(ah) && !AR_SREV_9531(ah))\n\t\tar9003_hw_internal_regulator_apply(ah);\n\tar9003_hw_apply_tuning_caps(ah);\n\tar9003_hw_apply_minccapwr_thresh(ah, is2ghz);\n\tar9003_hw_txend_to_xpa_off_apply(ah, is2ghz);\n\tar9003_hw_thermometer_apply(ah);\n\tar9003_hw_thermo_cal_apply(ah);\n}\n\nstatic void ath9k_hw_ar9300_set_addac(struct ath_hw *ah,\n\t\t\t\t      struct ath9k_channel *chan)\n{\n}\n\n \nstatic int ar9003_hw_power_interpolate(int32_t x,\n\t\t\t\t       int32_t *px, int32_t *py, u_int16_t np)\n{\n\tint ip = 0;\n\tint lx = 0, ly = 0, lhave = 0;\n\tint hx = 0, hy = 0, hhave = 0;\n\tint dx = 0;\n\tint y = 0;\n\n\tlhave = 0;\n\thhave = 0;\n\n\t \n\tfor (ip = 0; ip < np; ip++) {\n\t\tdx = x - px[ip];\n\n\t\t \n\t\tif (dx <= 0) {\n\t\t\tif (!hhave || dx > (x - hx)) {\n\t\t\t\t \n\t\t\t\thx = px[ip];\n\t\t\t\thy = py[ip];\n\t\t\t\thhave = 1;\n\t\t\t}\n\t\t}\n\t\t \n\t\tif (dx >= 0) {\n\t\t\tif (!lhave || dx < (x - lx)) {\n\t\t\t\t \n\t\t\t\tlx = px[ip];\n\t\t\t\tly = py[ip];\n\t\t\t\tlhave = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\t \n\tif (lhave) {\n\t\t \n\t\tif (hhave) {\n\t\t\t \n\t\t\tif (hx == lx)\n\t\t\t\ty = ly;\n\t\t\telse\t \n\t\t\t\ty = interpolate(x, lx, hx, ly, hy);\n\t\t} else\t\t \n\t\t\ty = ly;\n\t} else if (hhave)\t \n\t\ty = hy;\n\telse  \n\t\ty = -(1 << 30);\n\treturn y;\n}\n\nstatic u8 ar9003_hw_eeprom_get_tgt_pwr(struct ath_hw *ah,\n\t\t\t\t       u16 rateIndex, u16 freq, bool is2GHz)\n{\n\tu16 numPiers, i;\n\ts32 targetPowerArray[AR9300_NUM_5G_20_TARGET_POWERS];\n\ts32 freqArray[AR9300_NUM_5G_20_TARGET_POWERS];\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct cal_tgt_pow_legacy *pEepromTargetPwr;\n\tu8 *pFreqBin;\n\n\tif (is2GHz) {\n\t\tnumPiers = AR9300_NUM_2G_20_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower2G;\n\t\tpFreqBin = eep->calTarget_freqbin_2G;\n\t} else {\n\t\tnumPiers = AR9300_NUM_5G_20_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower5G;\n\t\tpFreqBin = eep->calTarget_freqbin_5G;\n\t}\n\n\t \n\tfor (i = 0; i < numPiers; i++) {\n\t\tfreqArray[i] = ath9k_hw_fbin2freq(pFreqBin[i], is2GHz);\n\t\ttargetPowerArray[i] = pEepromTargetPwr[i].tPow2x[rateIndex];\n\t}\n\n\t \n\treturn (u8) ar9003_hw_power_interpolate((s32) freq,\n\t\t\t\t\t\t freqArray,\n\t\t\t\t\t\t targetPowerArray, numPiers);\n}\n\nstatic u8 ar9003_hw_eeprom_get_ht20_tgt_pwr(struct ath_hw *ah,\n\t\t\t\t\t    u16 rateIndex,\n\t\t\t\t\t    u16 freq, bool is2GHz)\n{\n\tu16 numPiers, i;\n\ts32 targetPowerArray[AR9300_NUM_5G_20_TARGET_POWERS];\n\ts32 freqArray[AR9300_NUM_5G_20_TARGET_POWERS];\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct cal_tgt_pow_ht *pEepromTargetPwr;\n\tu8 *pFreqBin;\n\n\tif (is2GHz) {\n\t\tnumPiers = AR9300_NUM_2G_20_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower2GHT20;\n\t\tpFreqBin = eep->calTarget_freqbin_2GHT20;\n\t} else {\n\t\tnumPiers = AR9300_NUM_5G_20_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower5GHT20;\n\t\tpFreqBin = eep->calTarget_freqbin_5GHT20;\n\t}\n\n\t \n\tfor (i = 0; i < numPiers; i++) {\n\t\tfreqArray[i] = ath9k_hw_fbin2freq(pFreqBin[i], is2GHz);\n\t\ttargetPowerArray[i] = pEepromTargetPwr[i].tPow2x[rateIndex];\n\t}\n\n\t \n\treturn (u8) ar9003_hw_power_interpolate((s32) freq,\n\t\t\t\t\t\t freqArray,\n\t\t\t\t\t\t targetPowerArray, numPiers);\n}\n\nstatic u8 ar9003_hw_eeprom_get_ht40_tgt_pwr(struct ath_hw *ah,\n\t\t\t\t\t    u16 rateIndex,\n\t\t\t\t\t    u16 freq, bool is2GHz)\n{\n\tu16 numPiers, i;\n\ts32 targetPowerArray[AR9300_NUM_5G_40_TARGET_POWERS];\n\ts32 freqArray[AR9300_NUM_5G_40_TARGET_POWERS];\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct cal_tgt_pow_ht *pEepromTargetPwr;\n\tu8 *pFreqBin;\n\n\tif (is2GHz) {\n\t\tnumPiers = AR9300_NUM_2G_40_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower2GHT40;\n\t\tpFreqBin = eep->calTarget_freqbin_2GHT40;\n\t} else {\n\t\tnumPiers = AR9300_NUM_5G_40_TARGET_POWERS;\n\t\tpEepromTargetPwr = eep->calTargetPower5GHT40;\n\t\tpFreqBin = eep->calTarget_freqbin_5GHT40;\n\t}\n\n\t \n\tfor (i = 0; i < numPiers; i++) {\n\t\tfreqArray[i] = ath9k_hw_fbin2freq(pFreqBin[i], is2GHz);\n\t\ttargetPowerArray[i] = pEepromTargetPwr[i].tPow2x[rateIndex];\n\t}\n\n\t \n\treturn (u8) ar9003_hw_power_interpolate((s32) freq,\n\t\t\t\t\t\t freqArray,\n\t\t\t\t\t\t targetPowerArray, numPiers);\n}\n\nstatic u8 ar9003_hw_eeprom_get_cck_tgt_pwr(struct ath_hw *ah,\n\t\t\t\t\t   u16 rateIndex, u16 freq)\n{\n\tu16 numPiers = AR9300_NUM_2G_CCK_TARGET_POWERS, i;\n\ts32 targetPowerArray[AR9300_NUM_2G_CCK_TARGET_POWERS];\n\ts32 freqArray[AR9300_NUM_2G_CCK_TARGET_POWERS];\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct cal_tgt_pow_legacy *pEepromTargetPwr = eep->calTargetPowerCck;\n\tu8 *pFreqBin = eep->calTarget_freqbin_Cck;\n\n\t \n\tfor (i = 0; i < numPiers; i++) {\n\t\tfreqArray[i] = ath9k_hw_fbin2freq(pFreqBin[i], 1);\n\t\ttargetPowerArray[i] = pEepromTargetPwr[i].tPow2x[rateIndex];\n\t}\n\n\t \n\treturn (u8) ar9003_hw_power_interpolate((s32) freq,\n\t\t\t\t\t\t freqArray,\n\t\t\t\t\t\t targetPowerArray, numPiers);\n}\n\nstatic void ar9003_hw_selfgen_tpc_txpower(struct ath_hw *ah,\n\t\t\t\t\t  struct ath9k_channel *chan,\n\t\t\t\t\t  u8 *pwr_array)\n{\n\tu32 val;\n\n\t \n\tif (IS_CHAN_2GHZ(chan)) {\n\t\tval = SM(pwr_array[ALL_TARGET_LEGACY_1L_5L], AR_TPC_ACK) |\n\t\t      SM(pwr_array[ALL_TARGET_LEGACY_1L_5L], AR_TPC_CTS) |\n\t\t      SM(0x3f, AR_TPC_CHIRP) | SM(0x3f, AR_TPC_RPT);\n\t} else {\n\t\tval = SM(pwr_array[ALL_TARGET_LEGACY_6_24], AR_TPC_ACK) |\n\t\t      SM(pwr_array[ALL_TARGET_LEGACY_6_24], AR_TPC_CTS) |\n\t\t      SM(0x3f, AR_TPC_CHIRP) | SM(0x3f, AR_TPC_RPT);\n\t}\n\tREG_WRITE(ah, AR_TPC, val);\n}\n\n \nint ar9003_hw_tx_power_regwrite(struct ath_hw *ah, u8 * pPwrArray)\n{\n#define POW_SM(_r, _s)     (((_r) & 0x3f) << (_s))\n\t \n\tREG_WRITE(ah, AR_PHY_TX_FORCED_GAIN, 0);\n\n\t \n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(0),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 0));\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(1),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_54], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_48], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_36], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 0));\n\n\t \n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(2),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L], 16) |\n\t\t   \n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L], 0));\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(3),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_11S], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_11L], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_5S], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L], 0)\n\t    );\n\n         \n\n         \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(8),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_6_24],  8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_LEGACY_1L_5L],  0)\n\t    );\n\n\t \n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(4),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_5], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_4], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_1_3_9_11_17_19], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_0_8_16], 0)\n\t    );\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(5),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_13], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_12], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_7], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_6], 0)\n\t    );\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(9),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_21], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_20], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_15], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_14], 0)\n\t    );\n\n\t \n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(10),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_23], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_22], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_23], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT20_22], 0)\n\t    );\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(6),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_5], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_4], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_1_3_9_11_17_19], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_0_8_16], 0)\n\t    );\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(7),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_13], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_12], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_7], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_6], 0)\n\t    );\n\n\t \n\tREG_WRITE(ah, AR_PHY_POWER_TX_RATE(11),\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_21], 24) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_20], 16) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_15], 8) |\n\t\t  POW_SM(pPwrArray[ALL_TARGET_HT40_14], 0)\n\t    );\n\n\treturn 0;\n#undef POW_SM\n}\n\nstatic void ar9003_hw_get_legacy_target_powers(struct ath_hw *ah, u16 freq,\n\t\t\t\t\t       u8 *targetPowerValT2,\n\t\t\t\t\t       bool is2GHz)\n{\n\ttargetPowerValT2[ALL_TARGET_LEGACY_6_24] =\n\t    ar9003_hw_eeprom_get_tgt_pwr(ah, LEGACY_TARGET_RATE_6_24, freq,\n\t\t\t\t\t is2GHz);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_36] =\n\t    ar9003_hw_eeprom_get_tgt_pwr(ah, LEGACY_TARGET_RATE_36, freq,\n\t\t\t\t\t is2GHz);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_48] =\n\t    ar9003_hw_eeprom_get_tgt_pwr(ah, LEGACY_TARGET_RATE_48, freq,\n\t\t\t\t\t is2GHz);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_54] =\n\t    ar9003_hw_eeprom_get_tgt_pwr(ah, LEGACY_TARGET_RATE_54, freq,\n\t\t\t\t\t is2GHz);\n}\n\nstatic void ar9003_hw_get_cck_target_powers(struct ath_hw *ah, u16 freq,\n\t\t\t\t\t    u8 *targetPowerValT2)\n{\n\ttargetPowerValT2[ALL_TARGET_LEGACY_1L_5L] =\n\t    ar9003_hw_eeprom_get_cck_tgt_pwr(ah, LEGACY_TARGET_RATE_1L_5L,\n\t\t\t\t\t     freq);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_5S] =\n\t    ar9003_hw_eeprom_get_cck_tgt_pwr(ah, LEGACY_TARGET_RATE_5S, freq);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_11L] =\n\t    ar9003_hw_eeprom_get_cck_tgt_pwr(ah, LEGACY_TARGET_RATE_11L, freq);\n\ttargetPowerValT2[ALL_TARGET_LEGACY_11S] =\n\t    ar9003_hw_eeprom_get_cck_tgt_pwr(ah, LEGACY_TARGET_RATE_11S, freq);\n}\n\nstatic void ar9003_hw_get_ht20_target_powers(struct ath_hw *ah, u16 freq,\n\t\t\t\t\t     u8 *targetPowerValT2, bool is2GHz)\n{\n\ttargetPowerValT2[ALL_TARGET_HT20_0_8_16] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_0_8_16, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_1_3_9_11_17_19] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_1_3_9_11_17_19,\n\t\t\t\t\t      freq, is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_4] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_4, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_5] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_5, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_6] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_6, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_7] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_7, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_12] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_12, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_13] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_13, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_14] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_14, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_15] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_15, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_20] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_20, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_21] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_21, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_22] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_22, freq,\n\t\t\t\t\t      is2GHz);\n\ttargetPowerValT2[ALL_TARGET_HT20_23] =\n\t    ar9003_hw_eeprom_get_ht20_tgt_pwr(ah, HT_TARGET_RATE_23, freq,\n\t\t\t\t\t      is2GHz);\n}\n\nstatic void ar9003_hw_get_ht40_target_powers(struct ath_hw *ah,\n\t\t\t\t\t\t   u16 freq,\n\t\t\t\t\t\t   u8 *targetPowerValT2,\n\t\t\t\t\t\t   bool is2GHz)\n{\n\t \n\tu8 ht40PowerIncForPdadc = 0;\n\n\ttargetPowerValT2[ALL_TARGET_HT40_0_8_16] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_0_8_16, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_1_3_9_11_17_19] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_1_3_9_11_17_19,\n\t\t\t\t\t      freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_4] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_4, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_5] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_5, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_6] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_6, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_7] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_7, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_12] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_12, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_13] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_13, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_14] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_14, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_15] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_15, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_20] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_20, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_21] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_21, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_22] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_22, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n\ttargetPowerValT2[ALL_TARGET_HT40_23] =\n\t    ar9003_hw_eeprom_get_ht40_tgt_pwr(ah, HT_TARGET_RATE_23, freq,\n\t\t\t\t\t      is2GHz) + ht40PowerIncForPdadc;\n}\n\nstatic void ar9003_hw_get_target_power_eeprom(struct ath_hw *ah,\n\t\t\t\t\t      struct ath9k_channel *chan,\n\t\t\t\t\t      u8 *targetPowerValT2)\n{\n\tbool is2GHz = IS_CHAN_2GHZ(chan);\n\tunsigned int i = 0;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tu16 freq = chan->channel;\n\n\tif (is2GHz)\n\t\tar9003_hw_get_cck_target_powers(ah, freq, targetPowerValT2);\n\n\tar9003_hw_get_legacy_target_powers(ah, freq, targetPowerValT2, is2GHz);\n\tar9003_hw_get_ht20_target_powers(ah, freq, targetPowerValT2, is2GHz);\n\n\tif (IS_CHAN_HT40(chan))\n\t\tar9003_hw_get_ht40_target_powers(ah, freq, targetPowerValT2,\n\t\t\t\t\t\t is2GHz);\n\n\tfor (i = 0; i < ar9300RateSize; i++) {\n\t\tath_dbg(common, REGULATORY, \"TPC[%02d] 0x%08x\\n\",\n\t\t\ti, targetPowerValT2[i]);\n\t}\n}\n\nstatic int ar9003_hw_cal_pier_get(struct ath_hw *ah,\n\t\t\t\t  bool is2ghz,\n\t\t\t\t  int ipier,\n\t\t\t\t  int ichain,\n\t\t\t\t  int *pfrequency,\n\t\t\t\t  int *pcorrection,\n\t\t\t\t  int *ptemperature, int *pvoltage,\n\t\t\t\t  int *pnf_cal, int *pnf_power)\n{\n\tu8 *pCalPier;\n\tstruct ar9300_cal_data_per_freq_op_loop *pCalPierStruct;\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\n\tif (ichain >= AR9300_MAX_CHAINS) {\n\t\tath_dbg(common, EEPROM,\n\t\t\t\"Invalid chain index, must be less than %d\\n\",\n\t\t\tAR9300_MAX_CHAINS);\n\t\treturn -1;\n\t}\n\n\tif (is2ghz) {\n\t\tif (ipier >= AR9300_NUM_2G_CAL_PIERS) {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"Invalid 2GHz cal pier index, must be less than %d\\n\",\n\t\t\t\tAR9300_NUM_2G_CAL_PIERS);\n\t\t\treturn -1;\n\t\t}\n\n\t\tpCalPier = &(eep->calFreqPier2G[ipier]);\n\t\tpCalPierStruct = &(eep->calPierData2G[ichain][ipier]);\n\t} else {\n\t\tif (ipier >= AR9300_NUM_5G_CAL_PIERS) {\n\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\"Invalid 5GHz cal pier index, must be less than %d\\n\",\n\t\t\t\tAR9300_NUM_5G_CAL_PIERS);\n\t\t\treturn -1;\n\t\t}\n\t\tpCalPier = &(eep->calFreqPier5G[ipier]);\n\t\tpCalPierStruct = &(eep->calPierData5G[ichain][ipier]);\n\t}\n\n\t*pfrequency = ath9k_hw_fbin2freq(*pCalPier, is2ghz);\n\t*pcorrection = pCalPierStruct->refPower;\n\t*ptemperature = pCalPierStruct->tempMeas;\n\t*pvoltage = pCalPierStruct->voltMeas;\n\t*pnf_cal = pCalPierStruct->rxTempMeas ?\n\t\t\tN2DBM(pCalPierStruct->rxNoisefloorCal) : 0;\n\t*pnf_power = pCalPierStruct->rxTempMeas ?\n\t\t\tN2DBM(pCalPierStruct->rxNoisefloorPower) : 0;\n\n\treturn 0;\n}\n\nstatic void ar9003_hw_power_control_override(struct ath_hw *ah,\n\t\t\t\t\t     int frequency,\n\t\t\t\t\t     int *correction,\n\t\t\t\t\t     int *voltage, int *temperature)\n{\n\tint temp_slope = 0, temp_slope1 = 0, temp_slope2 = 0;\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\tint f[8], t[8], t1[3], t2[3], i;\n\n\tREG_RMW(ah, AR_PHY_TPC_11_B0,\n\t\t(correction[0] << AR_PHY_TPC_OLPC_GAIN_DELTA_S),\n\t\tAR_PHY_TPC_OLPC_GAIN_DELTA);\n\tif (ah->caps.tx_chainmask & BIT(1))\n\t\tREG_RMW(ah, AR_PHY_TPC_11_B1,\n\t\t\t(correction[1] << AR_PHY_TPC_OLPC_GAIN_DELTA_S),\n\t\t\tAR_PHY_TPC_OLPC_GAIN_DELTA);\n\tif (ah->caps.tx_chainmask & BIT(2))\n\t\tREG_RMW(ah, AR_PHY_TPC_11_B2,\n\t\t\t(correction[2] << AR_PHY_TPC_OLPC_GAIN_DELTA_S),\n\t\t\tAR_PHY_TPC_OLPC_GAIN_DELTA);\n\n\t \n\tREG_RMW(ah, AR_PHY_TPC_6_B0,\n\t\t(3 << AR_PHY_TPC_6_ERROR_EST_MODE_S),\n\t\tAR_PHY_TPC_6_ERROR_EST_MODE);\n\tif (ah->caps.tx_chainmask & BIT(1))\n\t\tREG_RMW(ah, AR_PHY_TPC_6_B1,\n\t\t\t(3 << AR_PHY_TPC_6_ERROR_EST_MODE_S),\n\t\t\tAR_PHY_TPC_6_ERROR_EST_MODE);\n\tif (ah->caps.tx_chainmask & BIT(2))\n\t\tREG_RMW(ah, AR_PHY_TPC_6_B2,\n\t\t\t(3 << AR_PHY_TPC_6_ERROR_EST_MODE_S),\n\t\t\tAR_PHY_TPC_6_ERROR_EST_MODE);\n\n\t \n\tif (frequency < 4000) {\n\t\ttemp_slope = eep->modalHeader2G.tempSlope;\n\t} else {\n\t\tif (AR_SREV_9550(ah)) {\n\t\t\tt[0] = eep->base_ext1.tempslopextension[2];\n\t\t\tt1[0] = eep->base_ext1.tempslopextension[3];\n\t\t\tt2[0] = eep->base_ext1.tempslopextension[4];\n\t\t\tf[0] = 5180;\n\n\t\t\tt[1] = eep->modalHeader5G.tempSlope;\n\t\t\tt1[1] = eep->base_ext1.tempslopextension[0];\n\t\t\tt2[1] = eep->base_ext1.tempslopextension[1];\n\t\t\tf[1] = 5500;\n\n\t\t\tt[2] = eep->base_ext1.tempslopextension[5];\n\t\t\tt1[2] = eep->base_ext1.tempslopextension[6];\n\t\t\tt2[2] = eep->base_ext1.tempslopextension[7];\n\t\t\tf[2] = 5785;\n\n\t\t\ttemp_slope = ar9003_hw_power_interpolate(frequency,\n\t\t\t\t\t\t\t\t f, t, 3);\n\t\t\ttemp_slope1 = ar9003_hw_power_interpolate(frequency,\n\t\t\t\t\t\t\t\t   f, t1, 3);\n\t\t\ttemp_slope2 = ar9003_hw_power_interpolate(frequency,\n\t\t\t\t\t\t\t\t   f, t2, 3);\n\n\t\t\tgoto tempslope;\n\t\t}\n\n\t\tif ((eep->baseEepHeader.miscConfiguration & 0x20) != 0) {\n\t\t\tfor (i = 0; i < 8; i++) {\n\t\t\t\tt[i] = eep->base_ext1.tempslopextension[i];\n\t\t\t\tf[i] = FBIN2FREQ(eep->calFreqPier5G[i], 0);\n\t\t\t}\n\t\t\ttemp_slope = ar9003_hw_power_interpolate((s32) frequency,\n\t\t\t\t\t\t\t\t f, t, 8);\n\t\t} else if (eep->base_ext2.tempSlopeLow != 0) {\n\t\t\tt[0] = eep->base_ext2.tempSlopeLow;\n\t\t\tf[0] = 5180;\n\t\t\tt[1] = eep->modalHeader5G.tempSlope;\n\t\t\tf[1] = 5500;\n\t\t\tt[2] = eep->base_ext2.tempSlopeHigh;\n\t\t\tf[2] = 5785;\n\t\t\ttemp_slope = ar9003_hw_power_interpolate((s32) frequency,\n\t\t\t\t\t\t\t\t f, t, 3);\n\t\t} else {\n\t\t\ttemp_slope = eep->modalHeader5G.tempSlope;\n\t\t}\n\t}\n\ntempslope:\n\tif (AR_SREV_9550(ah) || AR_SREV_9531(ah) || AR_SREV_9561(ah)) {\n\t\tu8 txmask = (eep->baseEepHeader.txrxMask & 0xf0) >> 4;\n\n\t\t \n\t\tif (eep->baseEepHeader.featureEnable & 0x1) {\n\t\t\tif (frequency < 4000) {\n\t\t\t\tif (txmask & BIT(0))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      eep->base_ext2.tempSlopeLow);\n\t\t\t\tif (txmask & BIT(1))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B1,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      temp_slope);\n\t\t\t\tif (txmask & BIT(2))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B2,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      eep->base_ext2.tempSlopeHigh);\n\t\t\t} else {\n\t\t\t\tif (txmask & BIT(0))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      temp_slope);\n\t\t\t\tif (txmask & BIT(1))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B1,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      temp_slope1);\n\t\t\t\tif (txmask & BIT(2))\n\t\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B2,\n\t\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM,\n\t\t\t\t\t\t      temp_slope2);\n\t\t\t}\n\t\t} else {\n\t\t\t \n\t\t\tif (txmask & BIT(0))\n\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19,\n\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM, 0);\n\t\t\tif (txmask & BIT(1))\n\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B1,\n\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM, 0);\n\t\t\tif (txmask & BIT(2))\n\t\t\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B2,\n\t\t\t\t\t      AR_PHY_TPC_19_ALPHA_THERM, 0);\n\t\t}\n\t} else {\n\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19,\n\t\t\t      AR_PHY_TPC_19_ALPHA_THERM, temp_slope);\n\t}\n\n\tif (AR_SREV_9462_20_OR_LATER(ah))\n\t\tREG_RMW_FIELD(ah, AR_PHY_TPC_19_B1,\n\t\t\t      AR_PHY_TPC_19_B1_ALPHA_THERM, temp_slope);\n\n\n\tREG_RMW_FIELD(ah, AR_PHY_TPC_18, AR_PHY_TPC_18_THERM_CAL_VALUE,\n\t\t      temperature[0]);\n}\n\n \nstatic int ar9003_hw_calibration_apply(struct ath_hw *ah, int frequency)\n{\n\tint ichain, ipier, npier;\n\tint lfrequency[AR9300_MAX_CHAINS],\n\t    lcorrection[AR9300_MAX_CHAINS],\n\t    ltemperature[AR9300_MAX_CHAINS], lvoltage[AR9300_MAX_CHAINS],\n\t    lnf_cal[AR9300_MAX_CHAINS], lnf_pwr[AR9300_MAX_CHAINS];\n\tint hfrequency[AR9300_MAX_CHAINS],\n\t    hcorrection[AR9300_MAX_CHAINS],\n\t    htemperature[AR9300_MAX_CHAINS], hvoltage[AR9300_MAX_CHAINS],\n\t    hnf_cal[AR9300_MAX_CHAINS], hnf_pwr[AR9300_MAX_CHAINS];\n\tint fdiff;\n\tint correction[AR9300_MAX_CHAINS],\n\t    voltage[AR9300_MAX_CHAINS], temperature[AR9300_MAX_CHAINS],\n\t    nf_cal[AR9300_MAX_CHAINS], nf_pwr[AR9300_MAX_CHAINS];\n\tint pfrequency, pcorrection, ptemperature, pvoltage,\n\t    pnf_cal, pnf_pwr;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tbool is2ghz = frequency < 4000;\n\n\tif (is2ghz)\n\t\tnpier = AR9300_NUM_2G_CAL_PIERS;\n\telse\n\t\tnpier = AR9300_NUM_5G_CAL_PIERS;\n\n\tfor (ichain = 0; ichain < AR9300_MAX_CHAINS; ichain++) {\n\t\tlfrequency[ichain] = 0;\n\t\thfrequency[ichain] = 100000;\n\t}\n\t \n\tfor (ichain = 0; ichain < AR9300_MAX_CHAINS; ichain++) {\n\t\tfor (ipier = 0; ipier < npier; ipier++) {\n\t\t\tif (!ar9003_hw_cal_pier_get(ah, is2ghz, ipier, ichain,\n\t\t\t\t\t\t    &pfrequency, &pcorrection,\n\t\t\t\t\t\t    &ptemperature, &pvoltage,\n\t\t\t\t\t\t    &pnf_cal, &pnf_pwr)) {\n\t\t\t\tfdiff = frequency - pfrequency;\n\n\t\t\t\t \n\t\t\t\tif (fdiff <= 0) {\n\t\t\t\t\tif (hfrequency[ichain] <= 0 ||\n\t\t\t\t\t    hfrequency[ichain] >= 100000 ||\n\t\t\t\t\t    fdiff >\n\t\t\t\t\t    (frequency - hfrequency[ichain])) {\n\t\t\t\t\t\t \n\t\t\t\t\t\thfrequency[ichain] = pfrequency;\n\t\t\t\t\t\thcorrection[ichain] =\n\t\t\t\t\t\t    pcorrection;\n\t\t\t\t\t\thtemperature[ichain] =\n\t\t\t\t\t\t    ptemperature;\n\t\t\t\t\t\thvoltage[ichain] = pvoltage;\n\t\t\t\t\t\thnf_cal[ichain] = pnf_cal;\n\t\t\t\t\t\thnf_pwr[ichain] = pnf_pwr;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (fdiff >= 0) {\n\t\t\t\t\tif (lfrequency[ichain] <= 0\n\t\t\t\t\t    || fdiff <\n\t\t\t\t\t    (frequency - lfrequency[ichain])) {\n\t\t\t\t\t\t \n\t\t\t\t\t\tlfrequency[ichain] = pfrequency;\n\t\t\t\t\t\tlcorrection[ichain] =\n\t\t\t\t\t\t    pcorrection;\n\t\t\t\t\t\tltemperature[ichain] =\n\t\t\t\t\t\t    ptemperature;\n\t\t\t\t\t\tlvoltage[ichain] = pvoltage;\n\t\t\t\t\t\tlnf_cal[ichain] = pnf_cal;\n\t\t\t\t\t\tlnf_pwr[ichain] = pnf_pwr;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t \n\tfor (ichain = 0; ichain < AR9300_MAX_CHAINS; ichain++) {\n\t\tath_dbg(common, EEPROM,\n\t\t\t\"ch=%d f=%d low=%d %d h=%d %d n=%d %d p=%d %d\\n\",\n\t\t\tichain, frequency, lfrequency[ichain],\n\t\t\tlcorrection[ichain], hfrequency[ichain],\n\t\t\thcorrection[ichain], lnf_cal[ichain],\n\t\t\thnf_cal[ichain], lnf_pwr[ichain],\n\t\t\thnf_pwr[ichain]);\n\t\t \n\t\tif (hfrequency[ichain] == lfrequency[ichain]) {\n\t\t\tcorrection[ichain] = lcorrection[ichain];\n\t\t\tvoltage[ichain] = lvoltage[ichain];\n\t\t\ttemperature[ichain] = ltemperature[ichain];\n\t\t\tnf_cal[ichain] = lnf_cal[ichain];\n\t\t\tnf_pwr[ichain] = lnf_pwr[ichain];\n\t\t}\n\t\t \n\t\telse if (frequency - lfrequency[ichain] < 1000) {\n\t\t\t \n\t\t\tif (hfrequency[ichain] - frequency < 1000) {\n\n\t\t\t\tcorrection[ichain] = interpolate(frequency,\n\t\t\t\t\t\tlfrequency[ichain],\n\t\t\t\t\t\thfrequency[ichain],\n\t\t\t\t\t\tlcorrection[ichain],\n\t\t\t\t\t\thcorrection[ichain]);\n\n\t\t\t\ttemperature[ichain] = interpolate(frequency,\n\t\t\t\t\t\tlfrequency[ichain],\n\t\t\t\t\t\thfrequency[ichain],\n\t\t\t\t\t\tltemperature[ichain],\n\t\t\t\t\t\thtemperature[ichain]);\n\n\t\t\t\tvoltage[ichain] = interpolate(frequency,\n\t\t\t\t\t\tlfrequency[ichain],\n\t\t\t\t\t\thfrequency[ichain],\n\t\t\t\t\t\tlvoltage[ichain],\n\t\t\t\t\t\thvoltage[ichain]);\n\n\t\t\t\tnf_cal[ichain] = interpolate(frequency,\n\t\t\t\t\t\tlfrequency[ichain],\n\t\t\t\t\t\thfrequency[ichain],\n\t\t\t\t\t\tlnf_cal[ichain],\n\t\t\t\t\t\thnf_cal[ichain]);\n\n\t\t\t\tnf_pwr[ichain] = interpolate(frequency,\n\t\t\t\t\t\tlfrequency[ichain],\n\t\t\t\t\t\thfrequency[ichain],\n\t\t\t\t\t\tlnf_pwr[ichain],\n\t\t\t\t\t\thnf_pwr[ichain]);\n\t\t\t}\n\t\t\t \n\t\t\telse {\n\t\t\t\tcorrection[ichain] = lcorrection[ichain];\n\t\t\t\ttemperature[ichain] = ltemperature[ichain];\n\t\t\t\tvoltage[ichain] = lvoltage[ichain];\n\t\t\t\tnf_cal[ichain] = lnf_cal[ichain];\n\t\t\t\tnf_pwr[ichain] = lnf_pwr[ichain];\n\t\t\t}\n\t\t}\n\t\t \n\t\telse if (hfrequency[ichain] - frequency < 1000) {\n\t\t\tcorrection[ichain] = hcorrection[ichain];\n\t\t\ttemperature[ichain] = htemperature[ichain];\n\t\t\tvoltage[ichain] = hvoltage[ichain];\n\t\t\tnf_cal[ichain] = hnf_cal[ichain];\n\t\t\tnf_pwr[ichain] = hnf_pwr[ichain];\n\t\t} else {\t \n\t\t\tcorrection[ichain] = 0;\n\t\t\ttemperature[ichain] = 0;\n\t\t\tvoltage[ichain] = 0;\n\t\t\tnf_cal[ichain] = 0;\n\t\t\tnf_pwr[ichain] = 0;\n\t\t}\n\t}\n\n\tar9003_hw_power_control_override(ah, frequency, correction, voltage,\n\t\t\t\t\t temperature);\n\n\tath_dbg(common, EEPROM,\n\t\t\"for frequency=%d, calibration correction = %d %d %d\\n\",\n\t\tfrequency, correction[0], correction[1], correction[2]);\n\n\t \n\tfor (ichain = 0; ichain < AR9300_MAX_CHAINS; ichain++)\n\t\tif (is2ghz) {\n\t\t\tah->nf_2g.cal[ichain] = nf_cal[ichain];\n\t\t\tah->nf_2g.pwr[ichain] = nf_pwr[ichain];\n\t\t} else {\n\t\t\tah->nf_5g.cal[ichain] = nf_cal[ichain];\n\t\t\tah->nf_5g.pwr[ichain] = nf_pwr[ichain];\n\t\t}\n\n\treturn 0;\n}\n\nstatic u16 ar9003_hw_get_direct_edge_power(struct ar9300_eeprom *eep,\n\t\t\t\t\t   int idx,\n\t\t\t\t\t   int edge,\n\t\t\t\t\t   bool is2GHz)\n{\n\tstruct cal_ctl_data_2g *ctl_2g = eep->ctlPowerData_2G;\n\tstruct cal_ctl_data_5g *ctl_5g = eep->ctlPowerData_5G;\n\n\tif (is2GHz)\n\t\treturn CTL_EDGE_TPOWER(ctl_2g[idx].ctlEdges[edge]);\n\telse\n\t\treturn CTL_EDGE_TPOWER(ctl_5g[idx].ctlEdges[edge]);\n}\n\nstatic u16 ar9003_hw_get_indirect_edge_power(struct ar9300_eeprom *eep,\n\t\t\t\t\t     int idx,\n\t\t\t\t\t     unsigned int edge,\n\t\t\t\t\t     u16 freq,\n\t\t\t\t\t     bool is2GHz)\n{\n\tstruct cal_ctl_data_2g *ctl_2g = eep->ctlPowerData_2G;\n\tstruct cal_ctl_data_5g *ctl_5g = eep->ctlPowerData_5G;\n\n\tu8 *ctl_freqbin = is2GHz ?\n\t\t&eep->ctl_freqbin_2G[idx][0] :\n\t\t&eep->ctl_freqbin_5G[idx][0];\n\n\tif (is2GHz) {\n\t\tif (ath9k_hw_fbin2freq(ctl_freqbin[edge - 1], 1) < freq &&\n\t\t    CTL_EDGE_FLAGS(ctl_2g[idx].ctlEdges[edge - 1]))\n\t\t\treturn CTL_EDGE_TPOWER(ctl_2g[idx].ctlEdges[edge - 1]);\n\t} else {\n\t\tif (ath9k_hw_fbin2freq(ctl_freqbin[edge - 1], 0) < freq &&\n\t\t    CTL_EDGE_FLAGS(ctl_5g[idx].ctlEdges[edge - 1]))\n\t\t\treturn CTL_EDGE_TPOWER(ctl_5g[idx].ctlEdges[edge - 1]);\n\t}\n\n\treturn MAX_RATE_POWER;\n}\n\n \nstatic u16 ar9003_hw_get_max_edge_power(struct ar9300_eeprom *eep,\n\t\t\t\t\tu16 freq, int idx, bool is2GHz)\n{\n\tu16 twiceMaxEdgePower = MAX_RATE_POWER;\n\tu8 *ctl_freqbin = is2GHz ?\n\t\t&eep->ctl_freqbin_2G[idx][0] :\n\t\t&eep->ctl_freqbin_5G[idx][0];\n\tu16 num_edges = is2GHz ?\n\t\tAR9300_NUM_BAND_EDGES_2G : AR9300_NUM_BAND_EDGES_5G;\n\tunsigned int edge;\n\n\t \n\tfor (edge = 0;\n\t     (edge < num_edges) && (ctl_freqbin[edge] != AR5416_BCHAN_UNUSED);\n\t     edge++) {\n\t\t \n\t\tif (freq == ath9k_hw_fbin2freq(ctl_freqbin[edge], is2GHz)) {\n\t\t\ttwiceMaxEdgePower =\n\t\t\t\tar9003_hw_get_direct_edge_power(eep, idx,\n\t\t\t\t\t\t\t\tedge, is2GHz);\n\t\t\tbreak;\n\t\t} else if ((edge > 0) &&\n\t\t\t   (freq < ath9k_hw_fbin2freq(ctl_freqbin[edge],\n\t\t\t\t\t\t      is2GHz))) {\n\t\t\ttwiceMaxEdgePower =\n\t\t\t\tar9003_hw_get_indirect_edge_power(eep, idx,\n\t\t\t\t\t\t\t\t  edge, freq,\n\t\t\t\t\t\t\t\t  is2GHz);\n\t\t\t \n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (is2GHz && !twiceMaxEdgePower)\n\t\ttwiceMaxEdgePower = 60;\n\n\treturn twiceMaxEdgePower;\n}\n\nstatic void ar9003_hw_set_power_per_rate_table(struct ath_hw *ah,\n\t\t\t\t\t       struct ath9k_channel *chan,\n\t\t\t\t\t       u8 *pPwrArray, u16 cfgCtl,\n\t\t\t\t\t       u8 antenna_reduction,\n\t\t\t\t\t       u16 powerLimit)\n{\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tstruct ar9300_eeprom *pEepData = &ah->eeprom.ar9300_eep;\n\tu16 twiceMaxEdgePower;\n\tint i;\n\tu16 scaledPower = 0, minCtlPower;\n\tstatic const u16 ctlModesFor11a[] = {\n\t\tCTL_11A, CTL_5GHT20, CTL_11A_EXT, CTL_5GHT40\n\t};\n\tstatic const u16 ctlModesFor11g[] = {\n\t\tCTL_11B, CTL_11G, CTL_2GHT20, CTL_11B_EXT,\n\t\tCTL_11G_EXT, CTL_2GHT40\n\t};\n\tu16 numCtlModes;\n\tconst u16 *pCtlMode;\n\tu16 ctlMode, freq;\n\tstruct chan_centers centers;\n\tu8 *ctlIndex;\n\tu8 ctlNum;\n\tu16 twiceMinEdgePower;\n\tbool is2ghz = IS_CHAN_2GHZ(chan);\n\n\tath9k_hw_get_channel_centers(ah, chan, &centers);\n\tscaledPower = ath9k_hw_get_scaled_power(ah, powerLimit,\n\t\t\t\t\t\tantenna_reduction);\n\n\tif (is2ghz) {\n\t\t \n\t\t \n\t\tnumCtlModes =\n\t\t\tARRAY_SIZE(ctlModesFor11g) -\n\t\t\t\t   SUB_NUM_CTL_MODES_AT_2G_40;\n\t\tpCtlMode = ctlModesFor11g;\n\t\tif (IS_CHAN_HT40(chan))\n\t\t\t \n\t\t\tnumCtlModes = ARRAY_SIZE(ctlModesFor11g);\n\t} else {\n\t\t \n\t\t \n\t\tnumCtlModes = ARRAY_SIZE(ctlModesFor11a) -\n\t\t\t\t\t SUB_NUM_CTL_MODES_AT_5G_40;\n\t\tpCtlMode = ctlModesFor11a;\n\t\tif (IS_CHAN_HT40(chan))\n\t\t\t \n\t\t\tnumCtlModes = ARRAY_SIZE(ctlModesFor11a);\n\t}\n\n\t \n\tfor (ctlMode = 0; ctlMode < numCtlModes; ctlMode++) {\n\t\tbool isHt40CtlMode = (pCtlMode[ctlMode] == CTL_5GHT40) ||\n\t\t\t(pCtlMode[ctlMode] == CTL_2GHT40);\n\t\tif (isHt40CtlMode)\n\t\t\tfreq = centers.synth_center;\n\t\telse if (pCtlMode[ctlMode] & EXT_ADDITIVE)\n\t\t\tfreq = centers.ext_center;\n\t\telse\n\t\t\tfreq = centers.ctl_center;\n\n\t\tath_dbg(common, REGULATORY,\n\t\t\t\"LOOP-Mode ctlMode %d < %d, isHt40CtlMode %d, EXT_ADDITIVE %d\\n\",\n\t\t\tctlMode, numCtlModes, isHt40CtlMode,\n\t\t\t(pCtlMode[ctlMode] & EXT_ADDITIVE));\n\n\t\t \n\t\tif (is2ghz) {\n\t\t\tctlIndex = pEepData->ctlIndex_2G;\n\t\t\tctlNum = AR9300_NUM_CTLS_2G;\n\t\t} else {\n\t\t\tctlIndex = pEepData->ctlIndex_5G;\n\t\t\tctlNum = AR9300_NUM_CTLS_5G;\n\t\t}\n\n\t\ttwiceMaxEdgePower = MAX_RATE_POWER;\n\t\tfor (i = 0; (i < ctlNum) && ctlIndex[i]; i++) {\n\t\t\tath_dbg(common, REGULATORY,\n\t\t\t\t\"LOOP-Ctlidx %d: cfgCtl 0x%2.2x pCtlMode 0x%2.2x ctlIndex 0x%2.2x chan %d\\n\",\n\t\t\t\ti, cfgCtl, pCtlMode[ctlMode], ctlIndex[i],\n\t\t\t\tchan->channel);\n\n\t\t\t \n\t\t\tif ((((cfgCtl & ~CTL_MODE_M) |\n\t\t\t       (pCtlMode[ctlMode] & CTL_MODE_M)) ==\n\t\t\t\tctlIndex[i]) ||\n\t\t\t    (((cfgCtl & ~CTL_MODE_M) |\n\t\t\t       (pCtlMode[ctlMode] & CTL_MODE_M)) ==\n\t\t\t     ((ctlIndex[i] & CTL_MODE_M) |\n\t\t\t       SD_NO_CTL))) {\n\t\t\t\ttwiceMinEdgePower =\n\t\t\t\t  ar9003_hw_get_max_edge_power(pEepData,\n\t\t\t\t\t\t\t       freq, i,\n\t\t\t\t\t\t\t       is2ghz);\n\n\t\t\t\tif ((cfgCtl & ~CTL_MODE_M) == SD_NO_CTL)\n\t\t\t\t\t \n\t\t\t\t\ttwiceMaxEdgePower =\n\t\t\t\t\t\tmin(twiceMaxEdgePower,\n\t\t\t\t\t\t    twiceMinEdgePower);\n\t\t\t\telse {\n\t\t\t\t\t \n\t\t\t\t\ttwiceMaxEdgePower = twiceMinEdgePower;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tminCtlPower = (u8)min(twiceMaxEdgePower, scaledPower);\n\n\t\tath_dbg(common, REGULATORY,\n\t\t\t\"SEL-Min ctlMode %d pCtlMode %d 2xMaxEdge %d sP %d minCtlPwr %d\\n\",\n\t\t\tctlMode, pCtlMode[ctlMode], twiceMaxEdgePower,\n\t\t\tscaledPower, minCtlPower);\n\n\t\t \n\t\tswitch (pCtlMode[ctlMode]) {\n\t\tcase CTL_11B:\n\t\t\tfor (i = ALL_TARGET_LEGACY_1L_5L;\n\t\t\t     i <= ALL_TARGET_LEGACY_11S; i++)\n\t\t\t\tpPwrArray[i] = (u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\t       minCtlPower);\n\t\t\tbreak;\n\t\tcase CTL_11A:\n\t\tcase CTL_11G:\n\t\t\tfor (i = ALL_TARGET_LEGACY_6_24;\n\t\t\t     i <= ALL_TARGET_LEGACY_54; i++)\n\t\t\t\tpPwrArray[i] = (u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\t       minCtlPower);\n\t\t\tbreak;\n\t\tcase CTL_5GHT20:\n\t\tcase CTL_2GHT20:\n\t\t\tfor (i = ALL_TARGET_HT20_0_8_16;\n\t\t\t     i <= ALL_TARGET_HT20_23; i++) {\n\t\t\t\tpPwrArray[i] = (u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\t       minCtlPower);\n\t\t\t\tif (ath9k_hw_mci_is_enabled(ah))\n\t\t\t\t\tpPwrArray[i] =\n\t\t\t\t\t\t(u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\tar9003_mci_get_max_txpower(ah,\n\t\t\t\t\t\t\tpCtlMode[ctlMode]));\n\t\t\t}\n\t\t\tbreak;\n\t\tcase CTL_5GHT40:\n\t\tcase CTL_2GHT40:\n\t\t\tfor (i = ALL_TARGET_HT40_0_8_16;\n\t\t\t     i <= ALL_TARGET_HT40_23; i++) {\n\t\t\t\tpPwrArray[i] = (u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\t       minCtlPower);\n\t\t\t\tif (ath9k_hw_mci_is_enabled(ah))\n\t\t\t\t\tpPwrArray[i] =\n\t\t\t\t\t\t(u8)min((u16)pPwrArray[i],\n\t\t\t\t\t\tar9003_mci_get_max_txpower(ah,\n\t\t\t\t\t\t\tpCtlMode[ctlMode]));\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}  \n}\n\nstatic inline u8 mcsidx_to_tgtpwridx(unsigned int mcs_idx, u8 base_pwridx)\n{\n\tu8 mod_idx = mcs_idx % 8;\n\n\tif (mod_idx <= 3)\n\t\treturn mod_idx ? (base_pwridx + 1) : base_pwridx;\n\telse\n\t\treturn base_pwridx + 4 * (mcs_idx / 8) + mod_idx - 2;\n}\n\nstatic void ar9003_paprd_set_txpower(struct ath_hw *ah,\n\t\t\t\t     struct ath9k_channel *chan,\n\t\t\t\t     u8 *targetPowerValT2)\n{\n\tint i;\n\n\tif (!ar9003_is_paprd_enabled(ah))\n\t\treturn;\n\n\tif (IS_CHAN_HT40(chan))\n\t\ti = ALL_TARGET_HT40_7;\n\telse\n\t\ti = ALL_TARGET_HT20_7;\n\n\tif (IS_CHAN_2GHZ(chan)) {\n\t\tif (!AR_SREV_9330(ah) && !AR_SREV_9340(ah) &&\n\t\t    !AR_SREV_9462(ah) && !AR_SREV_9565(ah)) {\n\t\t\tif (IS_CHAN_HT40(chan))\n\t\t\t\ti = ALL_TARGET_HT40_0_8_16;\n\t\t\telse\n\t\t\t\ti = ALL_TARGET_HT20_0_8_16;\n\t\t}\n\t}\n\n\tah->paprd_target_power = targetPowerValT2[i];\n}\n\nstatic void ath9k_hw_ar9300_set_txpower(struct ath_hw *ah,\n\t\t\t\t\tstruct ath9k_channel *chan, u16 cfgCtl,\n\t\t\t\t\tu8 twiceAntennaReduction,\n\t\t\t\t\tu8 powerLimit, bool test)\n{\n\tstruct ath_regulatory *regulatory = ath9k_hw_regulatory(ah);\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tu8 targetPowerValT2[ar9300RateSize];\n\tu8 target_power_val_t2_eep[ar9300RateSize];\n\tu8 targetPowerValT2_tpc[ar9300RateSize];\n\tunsigned int i = 0, paprd_scale_factor = 0;\n\tu8 pwr_idx, min_pwridx = 0;\n\n\tmemset(targetPowerValT2, 0 , sizeof(targetPowerValT2));\n\n\t \n\tar9003_hw_get_target_power_eeprom(ah, chan, targetPowerValT2);\n\n\tif (ar9003_is_paprd_enabled(ah)) {\n\t\tah->paprd_ratemask =\n\t\t\tar9003_get_paprd_rate_mask_ht20(ah, IS_CHAN_2GHZ(chan)) &\n\t\t\tAR9300_PAPRD_RATE_MASK;\n\n\t\tah->paprd_ratemask_ht40 =\n\t\t\tar9003_get_paprd_rate_mask_ht40(ah, IS_CHAN_2GHZ(chan)) &\n\t\t\tAR9300_PAPRD_RATE_MASK;\n\n\t\tpaprd_scale_factor = ar9003_get_paprd_scale_factor(ah, chan);\n\t\tmin_pwridx = IS_CHAN_HT40(chan) ? ALL_TARGET_HT40_0_8_16 :\n\t\t\t\t\t\t  ALL_TARGET_HT20_0_8_16;\n\n\t\tif (!ah->paprd_table_write_done) {\n\t\t\tmemcpy(target_power_val_t2_eep, targetPowerValT2,\n\t\t\t       sizeof(targetPowerValT2));\n\t\t\tfor (i = 0; i < 24; i++) {\n\t\t\t\tpwr_idx = mcsidx_to_tgtpwridx(i, min_pwridx);\n\t\t\t\tif (ah->paprd_ratemask & (1 << i)) {\n\t\t\t\t\tif (targetPowerValT2[pwr_idx] &&\n\t\t\t\t\t    targetPowerValT2[pwr_idx] ==\n\t\t\t\t\t    target_power_val_t2_eep[pwr_idx])\n\t\t\t\t\t\ttargetPowerValT2[pwr_idx] -=\n\t\t\t\t\t\t\tpaprd_scale_factor;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmemcpy(target_power_val_t2_eep, targetPowerValT2,\n\t\t       sizeof(targetPowerValT2));\n\t}\n\n\tar9003_hw_set_power_per_rate_table(ah, chan,\n\t\t\t\t\t   targetPowerValT2, cfgCtl,\n\t\t\t\t\t   twiceAntennaReduction,\n\t\t\t\t\t   powerLimit);\n\n\tmemcpy(targetPowerValT2_tpc, targetPowerValT2,\n\t       sizeof(targetPowerValT2));\n\n\tif (ar9003_is_paprd_enabled(ah)) {\n\t\tfor (i = 0; i < ar9300RateSize; i++) {\n\t\t\tif ((ah->paprd_ratemask & (1 << i)) &&\n\t\t\t    (abs(targetPowerValT2[i] -\n\t\t\t\ttarget_power_val_t2_eep[i]) >\n\t\t\t    paprd_scale_factor)) {\n\t\t\t\tah->paprd_ratemask &= ~(1 << i);\n\t\t\t\tath_dbg(common, EEPROM,\n\t\t\t\t\t\"paprd disabled for mcs %d\\n\", i);\n\t\t\t}\n\t\t}\n\t}\n\n\tregulatory->max_power_level = 0;\n\tfor (i = 0; i < ar9300RateSize; i++) {\n\t\tif (targetPowerValT2[i] > regulatory->max_power_level)\n\t\t\tregulatory->max_power_level = targetPowerValT2[i];\n\t}\n\n\tath9k_hw_update_regulatory_maxpower(ah);\n\n\tif (test)\n\t\treturn;\n\n\tfor (i = 0; i < ar9300RateSize; i++) {\n\t\tath_dbg(common, REGULATORY, \"TPC[%02d] 0x%08x\\n\",\n\t\t\ti, targetPowerValT2[i]);\n\t}\n\n\t \n\tar9003_hw_tx_power_regwrite(ah, targetPowerValT2);\n\tar9003_hw_calibration_apply(ah, chan->channel);\n\tar9003_paprd_set_txpower(ah, chan, targetPowerValT2);\n\n\tar9003_hw_selfgen_tpc_txpower(ah, chan, targetPowerValT2);\n\n\t \n\tif (ah->tpc_enabled) {\n\t\tu32 val;\n\n\t\tar9003_hw_init_rate_txpower(ah, targetPowerValT2_tpc, chan);\n\n\t\t \n\t\tREG_WRITE(ah, AR_PHY_PWRTX_MAX,\n\t\t\t  AR_PHY_POWER_TX_RATE_MAX_TPC_ENABLE);\n\t\t \n\t\tval = REG_READ(ah, AR_PHY_POWER_TX_SUB);\n\t\tif (AR_SREV_9340(ah))\n\t\t\tREG_WRITE(ah, AR_PHY_POWER_TX_SUB,\n\t\t\t\t  val & 0xFFFFFFC0);\n\t\telse\n\t\t\tREG_WRITE(ah, AR_PHY_POWER_TX_SUB,\n\t\t\t\t  val & 0xFFFFF000);\n\t} else {\n\t\t \n\t\tREG_WRITE(ah, AR_PHY_PWRTX_MAX, 0);\n\t}\n}\n\nstatic u16 ath9k_hw_ar9300_get_spur_channel(struct ath_hw *ah,\n\t\t\t\t\t    u16 i, bool is2GHz)\n{\n\treturn AR_NO_SPUR;\n}\n\ns32 ar9003_hw_get_tx_gain_idx(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\n\treturn (eep->baseEepHeader.txrxgain >> 4) & 0xf;  \n}\n\ns32 ar9003_hw_get_rx_gain_idx(struct ath_hw *ah)\n{\n\tstruct ar9300_eeprom *eep = &ah->eeprom.ar9300_eep;\n\n\treturn (eep->baseEepHeader.txrxgain) & 0xf;  \n}\n\nu8 *ar9003_get_spur_chan_ptr(struct ath_hw *ah, bool is2ghz)\n{\n\treturn ar9003_modal_header(ah, is2ghz)->spurChans;\n}\n\nu32 ar9003_get_paprd_rate_mask_ht20(struct ath_hw *ah, bool is2ghz)\n{\n\treturn le32_to_cpu(ar9003_modal_header(ah, is2ghz)->papdRateMaskHt20);\n}\n\nu32 ar9003_get_paprd_rate_mask_ht40(struct ath_hw *ah, bool is2ghz)\n{\n\treturn le32_to_cpu(ar9003_modal_header(ah, is2ghz)->papdRateMaskHt40);\n}\n\nunsigned int ar9003_get_paprd_scale_factor(struct ath_hw *ah,\n\t\t\t\t\t   struct ath9k_channel *chan)\n{\n\tbool is2ghz = IS_CHAN_2GHZ(chan);\n\n\tif (is2ghz)\n\t\treturn MS(ar9003_get_paprd_rate_mask_ht20(ah, is2ghz),\n\t\t\t  AR9300_PAPRD_SCALE_1);\n\telse {\n\t\tif (chan->channel >= 5700)\n\t\t\treturn MS(ar9003_get_paprd_rate_mask_ht20(ah, is2ghz),\n\t\t\t\t  AR9300_PAPRD_SCALE_1);\n\t\telse if (chan->channel >= 5400)\n\t\t\treturn MS(ar9003_get_paprd_rate_mask_ht40(ah, is2ghz),\n\t\t\t\t  AR9300_PAPRD_SCALE_2);\n\t\telse\n\t\t\treturn MS(ar9003_get_paprd_rate_mask_ht40(ah, is2ghz),\n\t\t\t\t  AR9300_PAPRD_SCALE_1);\n\t}\n}\n\nstatic u8 ar9003_get_eepmisc(struct ath_hw *ah)\n{\n\treturn ah->eeprom.ar9300_eep.baseEepHeader.opCapFlags.eepMisc;\n}\n\nconst struct eeprom_ops eep_ar9300_ops = {\n\t.check_eeprom = ath9k_hw_ar9300_check_eeprom,\n\t.get_eeprom = ath9k_hw_ar9300_get_eeprom,\n\t.fill_eeprom = ath9k_hw_ar9300_fill_eeprom,\n\t.dump_eeprom = ath9k_hw_ar9003_dump_eeprom,\n\t.get_eeprom_ver = ath9k_hw_ar9300_get_eeprom_ver,\n\t.get_eeprom_rev = ath9k_hw_ar9300_get_eeprom_rev,\n\t.set_board_values = ath9k_hw_ar9300_set_board_values,\n\t.set_addac = ath9k_hw_ar9300_set_addac,\n\t.set_txpower = ath9k_hw_ar9300_set_txpower,\n\t.get_spur_channel = ath9k_hw_ar9300_get_spur_channel,\n\t.get_eepmisc = ar9003_get_eepmisc\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}