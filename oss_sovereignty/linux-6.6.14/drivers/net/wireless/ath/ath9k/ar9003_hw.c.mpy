{
  "module_name": "ar9003_hw.c",
  "hash_id": "146d4b024a1145363091fe70663da67420b4771c7f1455596415951d32407c73",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath9k/ar9003_hw.c",
  "human_readable_source": " \n\n#include \"hw.h\"\n#include \"ar9003_mac.h\"\n#include \"ar9003_2p2_initvals.h\"\n#include \"ar9003_buffalo_initvals.h\"\n#include \"ar9485_initvals.h\"\n#include \"ar9340_initvals.h\"\n#include \"ar9330_1p1_initvals.h\"\n#include \"ar9330_1p2_initvals.h\"\n#include \"ar955x_1p0_initvals.h\"\n#include \"ar9580_1p0_initvals.h\"\n#include \"ar9462_2p0_initvals.h\"\n#include \"ar9462_2p1_initvals.h\"\n#include \"ar9565_1p0_initvals.h\"\n#include \"ar9565_1p1_initvals.h\"\n#include \"ar953x_initvals.h\"\n#include \"ar956x_initvals.h\"\n\n \n\n \nstatic void ar9003_hw_init_mode_regs(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_11(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9331_1p1_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9331_1p1_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9331_1p1_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9331_1p1_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9331_1p1_radio_core);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9331_1p1_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9331_1p1_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9331_common_rx_gain_1p1);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9331_modes_lowest_ob_db_tx_gain_1p1);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9331_1p1_baseband_core_txfir_coeff_japan_2484);\n\n\t\t \n\t\tif (ah->is_clk_25mhz)\n\t\t\tINIT_INI_ARRAY(&ah->iniAdditional,\n\t\t\t\t\tar9331_1p1_xtal_25M);\n\t\telse\n\t\t\tINIT_INI_ARRAY(&ah->iniAdditional,\n\t\t\t\t\tar9331_1p1_xtal_40M);\n\t} else if (AR_SREV_9330_12(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9331_1p2_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9331_1p2_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9331_1p2_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9331_1p2_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9331_1p2_radio_core);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9331_1p2_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9331_1p2_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9331_common_rx_gain_1p2);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9331_modes_lowest_ob_db_tx_gain_1p2);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9331_1p2_baseband_core_txfir_coeff_japan_2484);\n\n\t\t \n\t\tif (ah->is_clk_25mhz)\n\t\t\tINIT_INI_ARRAY(&ah->iniAdditional,\n\t\t\t\t\tar9331_1p2_xtal_25M);\n\t\telse\n\t\t\tINIT_INI_ARRAY(&ah->iniAdditional,\n\t\t\t\t\tar9331_1p2_xtal_40M);\n\t} else if (AR_SREV_9340(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9340_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9340_1p0_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9340_1p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9340_1p0_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9340_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar9340_1p0_radio_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9340_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9340_1p0_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9340Common_wo_xlna_rx_gain_table_1p0);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9340Modes_high_ob_db_tx_gain_table_1p0);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       ar9340Modes_fast_clock_1p0);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9340_1p0_baseband_core_txfir_coeff_japan_2484);\n\t\tINIT_INI_ARRAY(&ah->ini_dfs,\n\t\t\t       ar9340_1p0_baseband_postamble_dfs_channel);\n\n\t\tif (!ah->is_clk_25mhz)\n\t\t\tINIT_INI_ARRAY(&ah->iniAdditional,\n\t\t\t\t       ar9340_1p0_radio_core_40M);\n\t} else if (AR_SREV_9485_11_OR_LATER(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9485_1_1_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9485_1_1_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_PRE], ar9485_1_1);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9485_1_1_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9485_1_1_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9485_1_1_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar9485_1_1_radio_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9485_1_1_soc_preamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9485Common_wo_xlna_rx_gain_1_1);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9485_modes_lowest_ob_db_tx_gain_1_1);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9485_1_1_baseband_core_txfir_coeff_japan_2484);\n\n\t\tif (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9485_1_1_pll_on_cdr_on_clkreq_disable_L1);\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9485_1_1_pll_on_cdr_on_clkreq_disable_L1);\n\t\t} else {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9485_1_1_pcie_phy_clkreq_disable_L1);\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9485_1_1_pcie_phy_clkreq_disable_L1);\n\t\t}\n\t} else if (AR_SREV_9462_21(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t       ar9462_2p1_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t       ar9462_2p1_mac_postamble);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t       ar9462_2p1_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t       ar9462_2p1_baseband_postamble);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t       ar9462_2p1_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t       ar9462_2p1_radio_postamble);\n\t\tINIT_INI_ARRAY(&ah->ini_radio_post_sys2ant,\n\t\t\t       ar9462_2p1_radio_postamble_sys2ant);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t       ar9462_2p1_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t       ar9462_2p1_soc_postamble);\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9462_2p1_common_rx_gain);\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       ar9462_2p1_modes_fast_clock);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9462_2p1_baseband_core_txfir_coeff_japan_2484);\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D3)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9462_2p1_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D0)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9462_2p1_pciephy_clkreq_disable_L1);\n\t\t}\n\t} else if (AR_SREV_9462_20(ah)) {\n\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE], ar9462_2p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9462_2p0_mac_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9462_2p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9462_2p0_baseband_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9462_2p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar9462_2p0_radio_postamble);\n\t\tINIT_INI_ARRAY(&ah->ini_radio_post_sys2ant,\n\t\t\t\tar9462_2p0_radio_postamble_sys2ant);\n\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9462_2p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9462_2p0_soc_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9462_2p0_common_rx_gain);\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D3)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9462_2p0_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D0)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9462_2p0_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t\tar9462_2p0_modes_fast_clock);\n\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9462_2p0_baseband_core_txfir_coeff_japan_2484);\n\t} else if (AR_SREV_9550(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar955x_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar955x_1p0_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar955x_1p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar955x_1p0_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar955x_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar955x_1p0_radio_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar955x_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar955x_1p0_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar955x_1p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\tar955x_1p0_common_wo_xlna_rx_gain_bounds);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar955x_1p0_modes_xpa_tx_gain_table);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t\tar955x_1p0_modes_fast_clock);\n\t} else if (AR_SREV_9531(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t       qca953x_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t       qca953x_1p0_mac_postamble);\n\t\tif (AR_SREV_9531_20(ah)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\t       qca953x_2p0_baseband_core);\n\t\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\t       qca953x_2p0_baseband_postamble);\n\t\t} else {\n\t\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\t       qca953x_1p0_baseband_core);\n\t\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\t       qca953x_1p0_baseband_postamble);\n\t\t}\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t       qca953x_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t       qca953x_1p0_radio_postamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t       qca953x_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t       qca953x_1p0_soc_postamble);\n\n\t\tif (AR_SREV_9531_20(ah)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\t       qca953x_2p0_common_wo_xlna_rx_gain_table);\n\t\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t\t       qca953x_2p0_common_wo_xlna_rx_gain_bounds);\n\t\t} else {\n\t\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\t       qca953x_1p0_common_wo_xlna_rx_gain_table);\n\t\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t\t       qca953x_1p0_common_wo_xlna_rx_gain_bounds);\n\t\t}\n\n\t\tif (AR_SREV_9531_20(ah))\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_2p0_modes_no_xpa_tx_gain_table);\n\t\telse if (AR_SREV_9531_11(ah))\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_1p1_modes_no_xpa_tx_gain_table);\n\t\telse\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_1p0_modes_no_xpa_tx_gain_table);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       qca953x_1p0_modes_fast_clock);\n\t} else if (AR_SREV_9561(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t       qca956x_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t       qca956x_1p0_mac_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t       qca956x_1p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t       qca956x_1p0_baseband_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t       qca956x_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t       qca956x_1p0_radio_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t       qca956x_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t       qca956x_1p0_soc_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca956x_1p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca956x_1p0_common_wo_xlna_rx_gain_bounds);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca956x_1p0_modes_no_xpa_tx_gain_table);\n\n\t\tINIT_INI_ARRAY(&ah->ini_dfs,\n\t\t\t       qca956x_1p0_baseband_postamble_dfs_channel);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       qca956x_1p0_baseband_core_txfir_coeff_japan_2484);\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       qca956x_1p0_modes_fast_clock);\n\t} else if (AR_SREV_9580(ah)) {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9580_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9580_1p0_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9580_1p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9580_1p0_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9580_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar9580_1p0_radio_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9580_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9580_1p0_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9580_1p0_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9580_1p0_low_ob_db_tx_gain_table);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       ar9580_1p0_modes_fast_clock);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9580_1p0_baseband_core_txfir_coeff_japan_2484);\n\t\tINIT_INI_ARRAY(&ah->ini_dfs,\n\t\t\t       ar9580_1p0_baseband_postamble_dfs_channel);\n\t} else if (AR_SREV_9565_11_OR_LATER(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t       ar9565_1p1_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t       ar9565_1p1_mac_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t       ar9565_1p1_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t       ar9565_1p1_baseband_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t       ar9565_1p1_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t       ar9565_1p1_radio_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t       ar9565_1p1_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t       ar9565_1p1_soc_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p1_Common_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p1_Modes_lowest_ob_db_tx_gain_table);\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D3)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9565_1p1_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D0)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9565_1p1_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t\tar9565_1p1_modes_fast_clock);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9565_1p1_baseband_core_txfir_coeff_japan_2484);\n\t} else if (AR_SREV_9565(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t       ar9565_1p0_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t       ar9565_1p0_mac_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t       ar9565_1p0_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t       ar9565_1p0_baseband_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t       ar9565_1p0_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t       ar9565_1p0_radio_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t       ar9565_1p0_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t       ar9565_1p0_soc_postamble);\n\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p0_Common_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p0_Modes_lowest_ob_db_tx_gain_table);\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D3)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\t       ar9565_1p0_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\t \n\t\tif ((ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_CONTROL) &&\n\t\t    (ah->config.pll_pwrsave & AR_PCIE_PLL_PWRSAVE_ON_D0)) {\n\t\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\t       ar9565_1p0_pciephy_clkreq_disable_L1);\n\t\t}\n\n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t\tar9565_1p0_modes_fast_clock);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9565_1p0_baseband_core_txfir_coeff_japan_2484);\n\t} else {\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_CORE],\n\t\t\t\tar9300_2p2_mac_core);\n\t\tINIT_INI_ARRAY(&ah->iniMac[ATH_INI_POST],\n\t\t\t\tar9300_2p2_mac_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_CORE],\n\t\t\t\tar9300_2p2_baseband_core);\n\t\tINIT_INI_ARRAY(&ah->iniBB[ATH_INI_POST],\n\t\t\t\tar9300_2p2_baseband_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_CORE],\n\t\t\t\tar9300_2p2_radio_core);\n\t\tINIT_INI_ARRAY(&ah->iniRadio[ATH_INI_POST],\n\t\t\t\tar9300_2p2_radio_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_PRE],\n\t\t\t\tar9300_2p2_soc_preamble);\n\t\tINIT_INI_ARRAY(&ah->iniSOC[ATH_INI_POST],\n\t\t\t\tar9300_2p2_soc_postamble);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9300Common_rx_gain_table_2p2);\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\tar9300Modes_lowest_ob_db_tx_gain_table_2p2);\n\n\t\t \n\n\t\t \n\n\t\tINIT_INI_ARRAY(&ah->iniPcieSerdes,\n\t\t\t\tar9300PciePhy_pll_on_clkreq_disable_L1_2p2);\n\n\t\t \n\n\t\tINIT_INI_ARRAY(&ah->iniPcieSerdesLowPower,\n\t\t\t\tar9300PciePhy_pll_on_clkreq_disable_L1_2p2);\n\n\t\t \n\t\tINIT_INI_ARRAY(&ah->iniModesFastClock,\n\t\t\t       ar9300Modes_fast_clock_2p2);\n\t\tINIT_INI_ARRAY(&ah->iniCckfirJapan2484,\n\t\t\t       ar9300_2p2_baseband_core_txfir_coeff_japan_2484);\n\t\tINIT_INI_ARRAY(&ah->ini_dfs,\n\t\t\t       ar9300_2p2_baseband_postamble_dfs_channel);\n\t}\n}\n\nstatic void ar9003_tx_gain_table_mode0(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_lowest_ob_db_tx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_lowest_ob_db_tx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_lowest_ob_db_tx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485_modes_lowest_ob_db_tx_gain_1_1);\n\telse if (AR_SREV_9550(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar955x_1p0_modes_xpa_tx_gain_table);\n\telse if (AR_SREV_9531_10(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca953x_1p0_modes_xpa_tx_gain_table);\n\telse if (AR_SREV_9531_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca953x_1p1_modes_xpa_tx_gain_table);\n\telse if (AR_SREV_9531_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca953x_2p0_modes_xpa_tx_gain_table);\n\telse if (AR_SREV_9561(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca956x_1p0_modes_xpa_tx_gain_table);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_lowest_ob_db_tx_gain_table);\n\telse if (AR_SREV_9462_21(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9462_2p1_modes_low_ob_db_tx_gain);\n\telse if (AR_SREV_9462_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9462_2p0_modes_low_ob_db_tx_gain);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p1_modes_low_ob_db_tx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p0_modes_low_ob_db_tx_gain_table);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9300Modes_lowest_ob_db_tx_gain_table_2p2);\n}\n\nstatic void ar9003_tx_gain_table_mode1(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_high_ob_db_tx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_high_ob_db_tx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_high_ob_db_tx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485Modes_high_ob_db_tx_gain_1_1);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_high_ob_db_tx_gain_table);\n\telse if (AR_SREV_9550(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar955x_1p0_modes_no_xpa_tx_gain_table);\n\telse if (AR_SREV_9531(ah)) {\n\t\tif (AR_SREV_9531_20(ah))\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_2p0_modes_no_xpa_tx_gain_table);\n\t\telse if (AR_SREV_9531_11(ah))\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_1p1_modes_no_xpa_tx_gain_table);\n\t\telse\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       qca953x_1p0_modes_no_xpa_tx_gain_table);\n\t} else if (AR_SREV_9561(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca956x_1p0_modes_no_xpa_tx_gain_table);\n\telse if (AR_SREV_9462_21(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9462_2p1_modes_high_ob_db_tx_gain);\n\telse if (AR_SREV_9462_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9462_2p0_modes_high_ob_db_tx_gain);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p1_modes_high_ob_db_tx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p0_modes_high_ob_db_tx_gain_table);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9300Modes_high_ob_db_tx_gain_table_2p2);\n}\n\nstatic void ar9003_tx_gain_table_mode2(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_low_ob_db_tx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_low_ob_db_tx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_low_ob_db_tx_gain_table_1p0);\n\telse if (AR_SREV_9531_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca953x_1p1_modes_no_xpa_low_power_tx_gain_table);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485Modes_low_ob_db_tx_gain_1_1);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_low_ob_db_tx_gain_table);\n\telse if (AR_SREV_9561(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca956x_1p0_modes_no_xpa_low_ob_db_tx_gain_table);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p1_modes_low_ob_db_tx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p0_modes_low_ob_db_tx_gain_table);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9300Modes_low_ob_db_tx_gain_table_2p2);\n}\n\nstatic void ar9003_tx_gain_table_mode3(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_high_power_tx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9331_modes_high_power_tx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_high_power_tx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485Modes_high_power_tx_gain_1_1);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_high_power_tx_gain_table);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p1_modes_high_power_tx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9565_1p0_modes_high_power_tx_gain_table);\n\telse {\n\t\tif (ah->config.tx_gain_buffalo)\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       ar9300Modes_high_power_tx_gain_table_buffalo);\n\t\telse\n\t\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t\t       ar9300Modes_high_power_tx_gain_table_2p2);\n\t}\n}\n\nstatic void ar9003_tx_gain_table_mode4(struct ath_hw *ah)\n{\n\tif (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_mixed_ob_db_tx_gain_table_1p0);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_mixed_ob_db_tx_gain_table);\n\telse if (AR_SREV_9462_21(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t       ar9462_2p1_modes_mix_ob_db_tx_gain);\n\telse if (AR_SREV_9462_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t       ar9462_2p0_modes_mix_ob_db_tx_gain);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9300Modes_mixed_ob_db_tx_gain_table_2p2);\n}\n\nstatic void ar9003_tx_gain_table_mode5(struct ath_hw *ah)\n{\n\tif (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485Modes_green_ob_db_tx_gain_1_1);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_type5_tx_gain_table);\n\telse if (AR_SREV_9561(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       qca956x_1p0_modes_no_xpa_green_tx_gain_table);\n\telse if (AR_SREV_9300_22(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9300Modes_type5_tx_gain_table_2p2);\n}\n\nstatic void ar9003_tx_gain_table_mode6(struct ath_hw *ah)\n{\n\tif (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9340Modes_low_ob_db_and_spur_tx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9485Modes_green_spur_ob_db_tx_gain_1_1);\n\telse if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\tar9580_1p0_type6_tx_gain_table);\n}\n\nstatic void ar9003_tx_gain_table_mode7(struct ath_hw *ah)\n{\n\tif (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesTxGain,\n\t\t\t       ar9340_cus227_tx_gain_table_1p0);\n}\n\ntypedef void (*ath_txgain_tab)(struct ath_hw *ah);\n\nstatic void ar9003_tx_gain_table_apply(struct ath_hw *ah)\n{\n\tstatic const ath_txgain_tab modes[] = {\n\t\tar9003_tx_gain_table_mode0,\n\t\tar9003_tx_gain_table_mode1,\n\t\tar9003_tx_gain_table_mode2,\n\t\tar9003_tx_gain_table_mode3,\n\t\tar9003_tx_gain_table_mode4,\n\t\tar9003_tx_gain_table_mode5,\n\t\tar9003_tx_gain_table_mode6,\n\t\tar9003_tx_gain_table_mode7,\n\t};\n\tint idx = ar9003_hw_get_tx_gain_idx(ah);\n\n\tif (idx >= ARRAY_SIZE(modes))\n\t\tidx = 0;\n\n\tmodes[idx](ah);\n}\n\nstatic void ar9003_rx_gain_table_mode0(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9331_common_rx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9331_common_rx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9340Common_rx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9485_common_rx_gain_1_1);\n\telse if (AR_SREV_9550(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar955x_1p0_common_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t\tar955x_1p0_common_rx_gain_bounds);\n\t} else if (AR_SREV_9531(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca953x_1p0_common_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca953x_1p0_common_rx_gain_bounds);\n\t} else if (AR_SREV_9561(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca956x_1p0_common_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca956x_1p0_common_rx_gain_bounds);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_xlna,\n\t\t\t       qca956x_1p0_xlna_only);\n\t} else if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9580_1p0_rx_gain_table);\n\telse if (AR_SREV_9462_21(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9462_2p1_common_rx_gain);\n\telse if (AR_SREV_9462_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9462_2p0_common_rx_gain);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p1_Common_rx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p0_Common_rx_gain_table);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t\tar9300Common_rx_gain_table_2p2);\n}\n\nstatic void ar9003_rx_gain_table_mode1(struct ath_hw *ah)\n{\n\tif (AR_SREV_9330_12(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9331_common_wo_xlna_rx_gain_1p2);\n\telse if (AR_SREV_9330_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9331_common_wo_xlna_rx_gain_1p1);\n\telse if (AR_SREV_9340(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9340Common_wo_xlna_rx_gain_table_1p0);\n\telse if (AR_SREV_9485_11_OR_LATER(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9485Common_wo_xlna_rx_gain_1_1);\n\telse if (AR_SREV_9462_21(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9462_2p1_common_wo_xlna_rx_gain);\n\telse if (AR_SREV_9462_20(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9462_2p0_common_wo_xlna_rx_gain);\n\telse if (AR_SREV_9550(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar955x_1p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\tar955x_1p0_common_wo_xlna_rx_gain_bounds);\n\t} else if (AR_SREV_9531_10(ah) || AR_SREV_9531_11(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca953x_1p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca953x_1p0_common_wo_xlna_rx_gain_bounds);\n\t} else if (AR_SREV_9531_20(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca953x_2p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca953x_2p0_common_wo_xlna_rx_gain_bounds);\n\t} else if (AR_SREV_9561(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       qca956x_1p0_common_wo_xlna_rx_gain_table);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rx_gain_bounds,\n\t\t\t       qca956x_1p0_common_wo_xlna_rx_gain_bounds);\n\t} else if (AR_SREV_9580(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9580_1p0_wo_xlna_rx_gain_table);\n\telse if (AR_SREV_9565_11(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p1_common_wo_xlna_rx_gain_table);\n\telse if (AR_SREV_9565(ah))\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9565_1p0_common_wo_xlna_rx_gain_table);\n\telse\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\tar9300Common_wo_xlna_rx_gain_table_2p2);\n}\n\nstatic void ar9003_rx_gain_table_mode2(struct ath_hw *ah)\n{\n\tif (AR_SREV_9462_21(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9462_2p1_common_mixed_rx_gain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_bb_core,\n\t\t\t       ar9462_2p1_baseband_core_mix_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_bb_postamble,\n\t\t\t       ar9462_2p1_baseband_postamble_mix_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_xlna,\n\t\t\t       ar9462_2p1_baseband_postamble_5g_xlna);\n\t} else if (AR_SREV_9462_20(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9462_2p0_common_mixed_rx_gain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_bb_core,\n\t\t\t       ar9462_2p0_baseband_core_mix_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_bb_postamble,\n\t\t\t       ar9462_2p0_baseband_postamble_mix_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_xlna,\n\t\t\t       ar9462_2p0_baseband_postamble_5g_xlna);\n\t}\n}\n\nstatic void ar9003_rx_gain_table_mode3(struct ath_hw *ah)\n{\n\tif (AR_SREV_9462_21(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9462_2p1_common_5g_xlna_only_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_xlna,\n\t\t\t       ar9462_2p1_baseband_postamble_5g_xlna);\n\t} else if (AR_SREV_9462_20(ah)) {\n\t\tINIT_INI_ARRAY(&ah->iniModesRxGain,\n\t\t\t       ar9462_2p0_common_5g_xlna_only_rxgain);\n\t\tINIT_INI_ARRAY(&ah->ini_modes_rxgain_xlna,\n\t\t\t       ar9462_2p0_baseband_postamble_5g_xlna);\n\t}\n}\n\nstatic void ar9003_rx_gain_table_apply(struct ath_hw *ah)\n{\n\tswitch (ar9003_hw_get_rx_gain_idx(ah)) {\n\tcase 0:\n\tdefault:\n\t\tar9003_rx_gain_table_mode0(ah);\n\t\tbreak;\n\tcase 1:\n\t\tar9003_rx_gain_table_mode1(ah);\n\t\tbreak;\n\tcase 2:\n\t\tar9003_rx_gain_table_mode2(ah);\n\t\tbreak;\n\tcase 3:\n\t\tar9003_rx_gain_table_mode3(ah);\n\t\tbreak;\n\t}\n}\n\n \nstatic void ar9003_hw_init_mode_gain_regs(struct ath_hw *ah)\n{\n\tar9003_tx_gain_table_apply(ah);\n\tar9003_rx_gain_table_apply(ah);\n}\n\n \nstatic void ar9003_hw_configpcipowersave(struct ath_hw *ah,\n\t\t\t\t\t bool power_off)\n{\n\tunsigned int i;\n\tstruct ar5416IniArray *array;\n\n\t \n\tif (AR_SREV_9462(ah)) {\n\t\tu32 val = ah->config.aspm_l1_fix;\n\t\tif ((val & 0xff000000) == 0x17000000) {\n\t\t\tval &= 0x00ffffff;\n\t\t\tval |= 0x27000000;\n\t\t\tREG_WRITE(ah, 0x570c, val);\n\t\t}\n\t}\n\n\t \n\tif (!power_off  ) {\n\t\t \n\t\tREG_SET_BIT(ah, AR_PCIE_PM_CTRL(ah), AR_PCIE_PM_CTRL_ENA);\n\t\tREG_WRITE(ah, AR_WA(ah), ah->WARegVal);\n\t}\n\n\t \n\tarray = power_off ? &ah->iniPcieSerdes :\n\t\t&ah->iniPcieSerdesLowPower;\n\n\tfor (i = 0; i < array->ia_rows; i++) {\n\t\tREG_WRITE(ah,\n\t\t\t  INI_RA(array, i, 0),\n\t\t\t  INI_RA(array, i, 1));\n\t}\n}\n\nstatic void ar9003_hw_init_hang_checks(struct ath_hw *ah)\n{\n\t \n\tah->config.hw_hang_checks |= HW_BB_WATCHDOG;\n\tah->config.hw_hang_checks |= HW_MAC_HANG;\n\n\t \n\tif (AR_SREV_9300_22(ah))\n\t\tah->config.hw_hang_checks |= HW_PHYRESTART_CLC_WAR;\n\n\tif (AR_SREV_9330(ah))\n\t\tah->bb_watchdog_timeout_ms = 85;\n\telse\n\t\tah->bb_watchdog_timeout_ms = 25;\n}\n\n \n\n#define NUM_STATUS_READS 50\n\nstatic bool ath9k_hw_verify_hang(struct ath_hw *ah, unsigned int queue)\n{\n\tu32 dma_dbg_chain, dma_dbg_complete;\n\tu8 dcu_chain_state, dcu_complete_state;\n\tunsigned int dbg_reg, reg_offset;\n\tint i;\n\n\tif (queue < 6) {\n\t\tdbg_reg = AR_DMADBG_4;\n\t\treg_offset = queue * 5;\n\t} else {\n\t\tdbg_reg = AR_DMADBG_5;\n\t\treg_offset = (queue - 6) * 5;\n\t}\n\n\tfor (i = 0; i < NUM_STATUS_READS; i++) {\n\t\tdma_dbg_chain = REG_READ(ah, dbg_reg);\n\t\tdma_dbg_complete = REG_READ(ah, AR_DMADBG_6);\n\n\t\tdcu_chain_state = (dma_dbg_chain >> reg_offset) & 0x1f;\n\t\tdcu_complete_state = dma_dbg_complete & 0x3;\n\n\t\tif ((dcu_chain_state != 0x6) || (dcu_complete_state != 0x1))\n\t\t\treturn false;\n\t}\n\n\tath_dbg(ath9k_hw_common(ah), RESET,\n\t\t\"MAC Hang signature found for queue: %d\\n\", queue);\n\n\treturn true;\n}\n\nstatic bool ar9003_hw_detect_mac_hang(struct ath_hw *ah)\n{\n\tu32 dma_dbg_4, dma_dbg_5, dma_dbg_6, chk_dbg;\n\tu8 dcu_chain_state, dcu_complete_state;\n\tbool dcu_wait_frdone = false;\n\tunsigned long chk_dcu = 0;\n\tunsigned int reg_offset;\n\tunsigned int i = 0;\n\n\tdma_dbg_4 = REG_READ(ah, AR_DMADBG_4);\n\tdma_dbg_5 = REG_READ(ah, AR_DMADBG_5);\n\tdma_dbg_6 = REG_READ(ah, AR_DMADBG_6);\n\n\tdcu_complete_state = dma_dbg_6 & 0x3;\n\tif (dcu_complete_state != 0x1)\n\t\tgoto exit;\n\n\tfor (i = 0; i < ATH9K_NUM_TX_QUEUES; i++) {\n\t\tif (i < 6) {\n\t\t\tchk_dbg = dma_dbg_4;\n\t\t\treg_offset = i * 5;\n\t\t} else {\n\t\t\tchk_dbg = dma_dbg_5;\n\t\t\treg_offset = (i - 6) * 5;\n\t\t}\n\n\t\tdcu_chain_state = (chk_dbg >> reg_offset) & 0x1f;\n\t\tif (dcu_chain_state == 0x6) {\n\t\t\tdcu_wait_frdone = true;\n\t\t\tchk_dcu |= BIT(i);\n\t\t}\n\t}\n\n\tif ((dcu_complete_state == 0x1) && dcu_wait_frdone) {\n\t\tfor_each_set_bit(i, &chk_dcu, ATH9K_NUM_TX_QUEUES) {\n\t\t\tif (ath9k_hw_verify_hang(ah, i))\n\t\t\t\treturn true;\n\t\t}\n\t}\nexit:\n\treturn false;\n}\n\n \nvoid ar9003_hw_attach_ops(struct ath_hw *ah)\n{\n\tstruct ath_hw_private_ops *priv_ops = ath9k_hw_private_ops(ah);\n\tstruct ath_hw_ops *ops = ath9k_hw_ops(ah);\n\n\tar9003_hw_init_mode_regs(ah);\n\n\tif (AR_SREV_9003_PCOEM(ah)) {\n\t\tWARN_ON(!ah->iniPcieSerdes.ia_array);\n\t\tWARN_ON(!ah->iniPcieSerdesLowPower.ia_array);\n\t}\n\n\tpriv_ops->init_mode_gain_regs = ar9003_hw_init_mode_gain_regs;\n\tpriv_ops->init_hang_checks = ar9003_hw_init_hang_checks;\n\tpriv_ops->detect_mac_hang = ar9003_hw_detect_mac_hang;\n\n\tops->config_pci_powersave = ar9003_hw_configpcipowersave;\n\n\tar9003_hw_attach_phy_ops(ah);\n\tar9003_hw_attach_calib_ops(ah);\n\tar9003_hw_attach_mac_ops(ah);\n\tar9003_hw_attach_aic_ops(ah);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}