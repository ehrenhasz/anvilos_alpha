{
  "module_name": "pci.c",
  "hash_id": "1f2c6ffd876be15174f04726bc2238db9bed6314270a9c82a5ea2b40b74d6e70",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath9k/pci.c",
  "human_readable_source": " \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/nl80211.h>\n#include <linux/pci.h>\n#include <linux/module.h>\n#include \"ath9k.h\"\n\nextern int ath9k_use_msi;\n\nstatic const struct pci_device_id ath_pci_id_table[] = {\n\t{ PCI_VDEVICE(ATHEROS, 0x0023) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x0024) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x0027) },  \n\n#ifdef CONFIG_ATH9K_PCOEM\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0029,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x2096),\n\t  .driver_data = ATH9K_PCI_LED_ACT_HI },\n#endif\n\n\t{ PCI_VDEVICE(ATHEROS, 0x0029) },  \n\n#ifdef CONFIG_ATH9K_PCOEM\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1C71),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE01F),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x11AD,  \n\t\t\t 0x6632),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x11AD,  \n\t\t\t 0x6642),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t PCI_VENDOR_ID_QMI,\n\t\t\t 0x0306),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x185F,  \n\t\t\t 0x309D),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x10CF,  \n\t\t\t 0x147C),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x10CF,  \n\t\t\t 0x147D),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002A,\n\t\t\t 0x10CF,  \n\t\t\t 0x1536),\n\t  .driver_data = ATH9K_PCI_D3_L1_WAR },\n#endif\n\n\t{ PCI_VDEVICE(ATHEROS, 0x002A) },  \n\n#ifdef CONFIG_ATH9K_PCOEM\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x002B,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2C37),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n#endif\n\n\t{ PCI_VDEVICE(ATHEROS, 0x002B) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x002C) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x002D) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x002E) },  \n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0030,\n\t\t\t 0x1A56,\n\t\t\t 0x2000),\n\t  .driver_data = ATH9K_PCI_KILLER },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0030,\n\t\t\t 0x1A56,\n\t\t\t 0x2001),\n\t  .driver_data = ATH9K_PCI_KILLER },\n\n\t{ PCI_VDEVICE(ATHEROS, 0x0030) },  \n\n#ifdef CONFIG_ATH9K_PCOEM\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2086),\n\t  .driver_data = ATH9K_PCI_CUS198 | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1237),\n\t  .driver_data = ATH9K_PCI_CUS198 | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2126),\n\t  .driver_data = ATH9K_PCI_CUS198 | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x126A),\n\t  .driver_data = ATH9K_PCI_CUS198 | ATH9K_PCI_BT_ANT_DIV },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2152),\n\t  .driver_data = ATH9K_PCI_CUS230 | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE075),\n\t  .driver_data = ATH9K_PCI_CUS230 | ATH9K_PCI_BT_ANT_DIV },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3119),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3122),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x185F,  \n\t\t\t 0x3119),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x185F,  \n\t\t\t 0x3027),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x4105),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x4106),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x410D),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x410E),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x410F),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0xC706),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0xC680),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0xC708),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_LENOVO,\n\t\t\t 0x3218),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_LENOVO,\n\t\t\t 0x3219),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2C97),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2100),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x1C56,  \n\t\t\t 0x4001),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x11AD,  \n\t\t\t 0x6627),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x11AD,  \n\t\t\t 0x6628),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE04E),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE04F),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x144F,  \n\t\t\t 0x7197),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2000),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2001),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1186),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1F86),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1195),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x1F95),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x1B9A,  \n\t\t\t 0x1C00),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t 0x1B9A,  \n\t\t\t 0x1C01),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0032,\n\t\t\t PCI_VENDOR_ID_ASUSTEK,\n\t\t\t 0x850D),\n\t  .driver_data = ATH9K_PCI_NO_PLL_PWRSAVE },\n#endif\n\n\t{ PCI_VDEVICE(ATHEROS, 0x0032) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x0033) },  \n\n#ifdef CONFIG_ATH9K_PCOEM\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2116),\n\t  .driver_data = ATH9K_PCI_CUS217 },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x11AD,  \n\t\t\t 0x6661),\n\t  .driver_data = ATH9K_PCI_CUS217 },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3117),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_LENOVO,\n\t\t\t 0x3214),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_ATTANSIC,\n\t\t\t 0x0091),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2110),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_ASUSTEK,\n\t\t\t 0x850E),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x11AD,  \n\t\t\t 0x6631),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x11AD,  \n\t\t\t 0x6641),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_HP,\n\t\t\t 0x1864),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x14CD,  \n\t\t\t 0x0063),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x14CD,  \n\t\t\t 0x0064),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t 0x10CF,  \n\t\t\t 0x1783),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_DELL,\n\t\t\t 0x020B),\n\t  .driver_data = ATH9K_PCI_WOW },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0034,\n\t\t\t PCI_VENDOR_ID_DELL,\n\t\t\t 0x0300),\n\t  .driver_data = ATH9K_PCI_WOW },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0030,\n\t\t\t 0x1A56,\n\t\t\t 0x2003),\n\t  .driver_data = ATH9K_PCI_KILLER },\n\n\t{ PCI_VDEVICE(ATHEROS, 0x0034) },  \n\t{ PCI_VDEVICE(ATHEROS, 0x0037) },  \n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3028),\n\t  .driver_data = ATH9K_PCI_CUS252 |\n\t\t\t ATH9K_PCI_AR9565_2ANT |\n\t\t\t ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2176),\n\t  .driver_data = ATH9K_PCI_CUS252 |\n\t\t\t ATH9K_PCI_AR9565_2ANT |\n\t\t\t ATH9K_PCI_BT_ANT_DIV },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE068),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x185F,  \n\t\t\t 0xA119),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0632),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x06B2),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0842),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x1842),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x6671),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2811),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2812),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x28A1),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x28A3),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x218A),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2F8A),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3025),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3026),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x302B),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE069),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x185F,  \n\t\t\t 0x3028),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0622),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0672),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0662),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x06A2),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0682),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x213A),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x213C),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_HP,\n\t\t\t 0x18E3),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_HP,\n\t\t\t 0x217F),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_HP,\n\t\t\t 0x2005),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_DELL,\n\t\t\t 0x020C),\n\t  .driver_data = ATH9K_PCI_AR9565_1ANT | ATH9K_PCI_BT_ANT_DIV },\n\n\t \n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x411A),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x411B),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x411C),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x411D),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x411E),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x4129),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_SAMSUNG,\n\t\t\t 0x412A),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x3027),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x302C),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0642),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0652),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0612),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0832),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x1832),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0692),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0803),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x11AD,  \n\t\t\t 0x0813),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2130),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x213B),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2182),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x218B),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x218C),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_AZWAVE,\n\t\t\t 0x2F82),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x144F,  \n\t\t\t 0x7202),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2810),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x2813),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x28A2),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x1B9A,  \n\t\t\t 0x28A4),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x185F,  \n\t\t\t 0x3027),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t 0x185F,  \n\t\t\t 0xA120),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE07F),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE08F),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE081),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE091),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_FOXCONN,\n\t\t\t 0xE099),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_LENOVO,\n\t\t\t 0x3026),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_LENOVO,\n\t\t\t 0x4026),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_ASUSTEK,\n\t\t\t 0x85F2),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT | ATH9K_PCI_BT_ANT_DIV },\n\t{ PCI_DEVICE_SUB(PCI_VENDOR_ID_ATHEROS,\n\t\t\t 0x0036,\n\t\t\t PCI_VENDOR_ID_DELL,\n\t\t\t 0x020E),\n\t  .driver_data = ATH9K_PCI_AR9565_2ANT |\n\t\t\t ATH9K_PCI_BT_ANT_DIV |\n\t\t\t ATH9K_PCI_LED_ACT_HI},\n\n\t \n\t{ PCI_VDEVICE(ATHEROS, 0x0036),\n\t  .driver_data = ATH9K_PCI_BT_ANT_DIV },\n#endif\n\n\t{ 0 }\n};\n\n\n \nstatic void ath_pci_read_cachesize(struct ath_common *common, int *csz)\n{\n\tstruct ath_softc *sc = (struct ath_softc *) common->priv;\n\tu8 u8tmp;\n\n\tpci_read_config_byte(to_pci_dev(sc->dev), PCI_CACHE_LINE_SIZE, &u8tmp);\n\t*csz = (int)u8tmp;\n\n\t \n\n\tif (*csz == 0)\n\t\t*csz = DEFAULT_CACHELINE >> 2;    \n}\n\nstatic bool ath_pci_eeprom_read(struct ath_common *common, u32 off, u16 *data)\n{\n\tstruct ath_hw *ah = (struct ath_hw *) common->ah;\n\n\tcommon->ops->read(ah, AR5416_EEPROM_OFFSET + (off << AR5416_EEPROM_S));\n\n\tif (!ath9k_hw_wait(ah,\n\t\t\t\tAR_EEPROM_STATUS_DATA(ah),\n\t\t\t\tAR_EEPROM_STATUS_DATA_BUSY |\n\t\t\t\tAR_EEPROM_STATUS_DATA_PROT_ACCESS, 0,\n\t\t\t\tAH_WAIT_TIMEOUT)) {\n\t\treturn false;\n\t}\n\n\t*data = MS(common->ops->read(ah, AR_EEPROM_STATUS_DATA(ah)),\n\t\t\tAR_EEPROM_STATUS_DATA_VAL);\n\n\treturn true;\n}\n\n \nstatic void ath_pci_aspm_init(struct ath_common *common)\n{\n\tstruct ath_softc *sc = (struct ath_softc *) common->priv;\n\tstruct ath_hw *ah = sc->sc_ah;\n\tstruct pci_dev *pdev = to_pci_dev(sc->dev);\n\tstruct pci_dev *parent;\n\tu16 aspm;\n\tint ret;\n\n\tif (!ah->is_pciexpress)\n\t\treturn;\n\n\tparent = pdev->bus->self;\n\tif (!parent)\n\t\treturn;\n\n\tif ((ath9k_hw_get_btcoex_scheme(ah) != ATH_BTCOEX_CFG_NONE) &&\n\t    (AR_SREV_9285(ah))) {\n\t\t \n\t\tpcie_capability_clear_word(pdev, PCI_EXP_LNKCTL,\n\t\t\tPCI_EXP_LNKCTL_ASPM_L0S | PCI_EXP_LNKCTL_ASPM_L1);\n\n\t\t \n\t\tpcie_capability_clear_word(parent, PCI_EXP_LNKCTL,\n\t\t\tPCI_EXP_LNKCTL_ASPM_L0S | PCI_EXP_LNKCTL_ASPM_L1);\n\n\t\tath_info(common, \"Disabling ASPM since BTCOEX is enabled\\n\");\n\t\treturn;\n\t}\n\n\t \n\tif (AR_SREV_9462(ah))\n\t\tpci_read_config_dword(pdev, 0x70c, &ah->config.aspm_l1_fix);\n\n\tret = pcie_capability_read_word(parent, PCI_EXP_LNKCTL, &aspm);\n\tif (!ret && (aspm & (PCI_EXP_LNKCTL_ASPM_L0S | PCI_EXP_LNKCTL_ASPM_L1))) {\n\t\tah->aspm_enabled = true;\n\t\t \n\t\tath9k_hw_configpcipowersave(ah, false);\n\t\tath_info(common, \"ASPM enabled: 0x%x\\n\", aspm);\n\t}\n}\n\nstatic const struct ath_bus_ops ath_pci_bus_ops = {\n\t.ath_bus_type = ATH_PCI,\n\t.read_cachesize = ath_pci_read_cachesize,\n\t.eeprom_read = ath_pci_eeprom_read,\n\t.aspm_init = ath_pci_aspm_init,\n};\n\nstatic int ath_pci_probe(struct pci_dev *pdev, const struct pci_device_id *id)\n{\n\tstruct ath_softc *sc;\n\tstruct ieee80211_hw *hw;\n\tu8 csz;\n\tu32 val;\n\tint ret = 0;\n\tchar hw_name[64];\n\tint msi_enabled = 0;\n\n\tif (pcim_enable_device(pdev))\n\t\treturn -EIO;\n\n\tret = dma_set_mask_and_coherent(&pdev->dev, DMA_BIT_MASK(32));\n\tif (ret) {\n\t\tpr_err(\"32-bit DMA not available\\n\");\n\t\treturn ret;\n\t}\n\n\t \n\tpci_read_config_byte(pdev, PCI_CACHE_LINE_SIZE, &csz);\n\tif (csz == 0) {\n\t\t \n\t\tcsz = L1_CACHE_BYTES / sizeof(u32);\n\t\tpci_write_config_byte(pdev, PCI_CACHE_LINE_SIZE, csz);\n\t}\n\t \n\tpci_write_config_byte(pdev, PCI_LATENCY_TIMER, 0xa8);\n\n\tpci_set_master(pdev);\n\n\t \n\tpci_read_config_dword(pdev, 0x40, &val);\n\tif ((val & 0x0000ff00) != 0)\n\t\tpci_write_config_dword(pdev, 0x40, val & 0xffff00ff);\n\n\tret = pcim_iomap_regions(pdev, BIT(0), \"ath9k\");\n\tif (ret) {\n\t\tdev_err(&pdev->dev, \"PCI memory region reserve error\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\tath9k_fill_chanctx_ops();\n\thw = ieee80211_alloc_hw(sizeof(struct ath_softc), &ath9k_ops);\n\tif (!hw) {\n\t\tdev_err(&pdev->dev, \"No memory for ieee80211_hw\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\tSET_IEEE80211_DEV(hw, &pdev->dev);\n\tpci_set_drvdata(pdev, hw);\n\n\tsc = hw->priv;\n\tsc->hw = hw;\n\tsc->dev = &pdev->dev;\n\tsc->mem = pcim_iomap_table(pdev)[0];\n\tsc->driver_data = id->driver_data;\n\n\tif (ath9k_use_msi) {\n\t\tif (pci_enable_msi(pdev) == 0) {\n\t\t\tmsi_enabled = 1;\n\t\t\tdev_err(&pdev->dev, \"Using MSI\\n\");\n\t\t} else {\n\t\t\tdev_err(&pdev->dev, \"Using INTx\\n\");\n\t\t}\n\t}\n\n\tif (!msi_enabled)\n\t\tret = request_irq(pdev->irq, ath_isr, IRQF_SHARED, \"ath9k\", sc);\n\telse\n\t\tret = request_irq(pdev->irq, ath_isr, 0, \"ath9k\", sc);\n\n\tif (ret) {\n\t\tdev_err(&pdev->dev, \"request_irq failed\\n\");\n\t\tgoto err_irq;\n\t}\n\n\tsc->irq = pdev->irq;\n\n\tret = ath9k_init_device(id->device, sc, &ath_pci_bus_ops);\n\tif (ret) {\n\t\tdev_err(&pdev->dev, \"Failed to initialize device\\n\");\n\t\tgoto err_init;\n\t}\n\n\tsc->sc_ah->msi_enabled = msi_enabled;\n\tsc->sc_ah->msi_reg = 0;\n\n\tath9k_hw_name(sc->sc_ah, hw_name, sizeof(hw_name));\n\twiphy_info(hw->wiphy, \"%s mem=0x%p, irq=%d\\n\",\n\t\t   hw_name, sc->mem, pdev->irq);\n\n\treturn 0;\n\nerr_init:\n\tfree_irq(sc->irq, sc);\nerr_irq:\n\tieee80211_free_hw(hw);\n\treturn ret;\n}\n\nstatic void ath_pci_remove(struct pci_dev *pdev)\n{\n\tstruct ieee80211_hw *hw = pci_get_drvdata(pdev);\n\tstruct ath_softc *sc = hw->priv;\n\n\tif (!is_ath9k_unloaded)\n\t\tsc->sc_ah->ah_flags |= AH_UNPLUGGED;\n\tath9k_deinit_device(sc);\n\tfree_irq(sc->irq, sc);\n\tieee80211_free_hw(sc->hw);\n}\n\n#ifdef CONFIG_PM_SLEEP\n\nstatic int ath_pci_suspend(struct device *device)\n{\n\tstruct ieee80211_hw *hw = dev_get_drvdata(device);\n\tstruct ath_softc *sc = hw->priv;\n\tstruct ath_common *common = ath9k_hw_common(sc->sc_ah);\n\n\tif (test_bit(ATH_OP_WOW_ENABLED, &common->op_flags)) {\n\t\tdev_info(device, \"WOW is enabled, bypassing PCI suspend\\n\");\n\t\treturn 0;\n\t}\n\n\t \n\tath9k_stop_btcoex(sc);\n\tath9k_hw_disable(sc->sc_ah);\n\tdel_timer_sync(&sc->sleep_timer);\n\tath9k_hw_setpower(sc->sc_ah, ATH9K_PM_FULL_SLEEP);\n\n\treturn 0;\n}\n\nstatic int ath_pci_resume(struct device *device)\n{\n\tstruct pci_dev *pdev = to_pci_dev(device);\n\tstruct ieee80211_hw *hw = pci_get_drvdata(pdev);\n\tstruct ath_softc *sc = hw->priv;\n\tstruct ath_hw *ah = sc->sc_ah;\n\tstruct ath_common *common = ath9k_hw_common(ah);\n\tu32 val;\n\n\t \n\tpci_read_config_dword(pdev, 0x40, &val);\n\tif ((val & 0x0000ff00) != 0)\n\t\tpci_write_config_dword(pdev, 0x40, val & 0xffff00ff);\n\n\tath_pci_aspm_init(common);\n\tah->reset_power_on = false;\n\n\treturn 0;\n}\n\nstatic SIMPLE_DEV_PM_OPS(ath9k_pm_ops, ath_pci_suspend, ath_pci_resume);\n\n#define ATH9K_PM_OPS\t(&ath9k_pm_ops)\n\n#else  \n\n#define ATH9K_PM_OPS\tNULL\n\n#endif  \n\n\nMODULE_DEVICE_TABLE(pci, ath_pci_id_table);\n\nstatic struct pci_driver ath_pci_driver = {\n\t.name       = \"ath9k\",\n\t.id_table   = ath_pci_id_table,\n\t.probe      = ath_pci_probe,\n\t.remove     = ath_pci_remove,\n\t.driver.pm  = ATH9K_PM_OPS,\n};\n\nint ath_pci_init(void)\n{\n\treturn pci_register_driver(&ath_pci_driver);\n}\n\nvoid ath_pci_exit(void)\n{\n\tpci_unregister_driver(&ath_pci_driver);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}