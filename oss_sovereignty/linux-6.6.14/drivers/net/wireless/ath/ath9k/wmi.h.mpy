{
  "module_name": "wmi.h",
  "hash_id": "c819e36397fb13177977ed32bd52fb5c8362e0ff2dd4359643acfa83777ada94",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireless/ath/ath9k/wmi.h",
  "human_readable_source": " \n\n#ifndef WMI_H\n#define WMI_H\n\nstruct wmi_event_txrate {\n\t__be32 txrate;\n\tstruct {\n\t\tu8 rssi_thresh;\n\t\tu8 per;\n\t} rc_stats;\n} __packed;\n\nstruct wmi_cmd_hdr {\n\t__be16 command_id;\n\t__be16 seq_no;\n} __packed;\n\nstruct wmi_fw_version {\n\t__be16 major;\n\t__be16 minor;\n\n} __packed;\n\nstruct wmi_event_swba {\n\t__be64 tsf;\n\tu8 beacon_pending;\n} __packed;\n\n \n#define HTC_MAX_TX_STATUS 12\n\n#define ATH9K_HTC_TXSTAT_ACK        BIT(0)\n#define ATH9K_HTC_TXSTAT_FILT       BIT(1)\n#define ATH9K_HTC_TXSTAT_RTC_CTS    BIT(2)\n#define ATH9K_HTC_TXSTAT_MCS        BIT(3)\n#define ATH9K_HTC_TXSTAT_CW40       BIT(4)\n#define ATH9K_HTC_TXSTAT_SGI        BIT(5)\n\n \n#define ATH9K_HTC_TXSTAT_RATE       0x0f\n#define ATH9K_HTC_TXSTAT_RATE_S     0\n\n#define ATH9K_HTC_TXSTAT_EPID       0xf0\n#define ATH9K_HTC_TXSTAT_EPID_S     4\n\nstruct __wmi_event_txstatus {\n\tu8 cookie;\n\tu8 ts_rate;  \n\tu8 ts_flags;\n};\n\nstruct wmi_event_txstatus {\n\tu8 cnt;\n\tstruct __wmi_event_txstatus txstatus[HTC_MAX_TX_STATUS];\n} __packed;\n\nenum wmi_cmd_id {\n\tWMI_ECHO_CMDID = 0x0001,\n\tWMI_ACCESS_MEMORY_CMDID,\n\n\t \n\tWMI_GET_FW_VERSION,\n\tWMI_DISABLE_INTR_CMDID,\n\tWMI_ENABLE_INTR_CMDID,\n\tWMI_ATH_INIT_CMDID,\n\tWMI_ABORT_TXQ_CMDID,\n\tWMI_STOP_TX_DMA_CMDID,\n\tWMI_ABORT_TX_DMA_CMDID,\n\tWMI_DRAIN_TXQ_CMDID,\n\tWMI_DRAIN_TXQ_ALL_CMDID,\n\tWMI_START_RECV_CMDID,\n\tWMI_STOP_RECV_CMDID,\n\tWMI_FLUSH_RECV_CMDID,\n\tWMI_SET_MODE_CMDID,\n\tWMI_NODE_CREATE_CMDID,\n\tWMI_NODE_REMOVE_CMDID,\n\tWMI_VAP_REMOVE_CMDID,\n\tWMI_VAP_CREATE_CMDID,\n\tWMI_REG_READ_CMDID,\n\tWMI_REG_WRITE_CMDID,\n\tWMI_RC_STATE_CHANGE_CMDID,\n\tWMI_RC_RATE_UPDATE_CMDID,\n\tWMI_TARGET_IC_UPDATE_CMDID,\n\tWMI_TX_AGGR_ENABLE_CMDID,\n\tWMI_TGT_DETACH_CMDID,\n\tWMI_NODE_UPDATE_CMDID,\n\tWMI_INT_STATS_CMDID,\n\tWMI_TX_STATS_CMDID,\n\tWMI_RX_STATS_CMDID,\n\tWMI_BITRATE_MASK_CMDID,\n\tWMI_REG_RMW_CMDID,\n};\n\nenum wmi_event_id {\n\tWMI_TGT_RDY_EVENTID = 0x1001,\n\tWMI_SWBA_EVENTID,\n\tWMI_FATAL_EVENTID,\n\tWMI_TXTO_EVENTID,\n\tWMI_BMISS_EVENTID,\n\tWMI_DELBA_EVENTID,\n\tWMI_TXSTATUS_EVENTID,\n};\n\n#define MAX_CMD_NUMBER 62\n#define MAX_RMW_CMD_NUMBER 15\n\nstruct register_write {\n\t__be32 reg;\n\t__be32 val;\n};\n\nstruct register_rmw {\n\t__be32 reg;\n\t__be32 set;\n\t__be32 clr;\n} __packed;\n\nstruct ath9k_htc_tx_event {\n\tint count;\n\tstruct __wmi_event_txstatus txs;\n\tstruct list_head list;\n};\n\nstruct wmi {\n\tstruct ath9k_htc_priv *drv_priv;\n\tstruct htc_target *htc;\n\tenum htc_endpoint_id ctrl_epid;\n\tstruct mutex op_mutex;\n\tstruct completion cmd_wait;\n\tu16 last_seq_id;\n\tstruct sk_buff_head wmi_event_queue;\n\tstruct tasklet_struct wmi_event_tasklet;\n\tu16 tx_seq_id;\n\tu8 *cmd_rsp_buf;\n\tu32 cmd_rsp_len;\n\tbool stopped;\n\n\tstruct list_head pending_tx_events;\n\tspinlock_t event_lock;\n\n\tspinlock_t wmi_lock;\n\n\t \n\tatomic_t mwrite_cnt;\n\tstruct register_write multi_write[MAX_CMD_NUMBER];\n\tu32 multi_write_idx;\n\tstruct mutex multi_write_mutex;\n\n\t \n\tatomic_t m_rmw_cnt;\n\tstruct register_rmw multi_rmw[MAX_RMW_CMD_NUMBER];\n\tu32 multi_rmw_idx;\n\tstruct mutex multi_rmw_mutex;\n\n};\n\nstruct wmi *ath9k_init_wmi(struct ath9k_htc_priv *priv);\nint ath9k_wmi_connect(struct htc_target *htc, struct wmi *wmi,\n\t\t      enum htc_endpoint_id *wmi_ctrl_epid);\nint ath9k_wmi_cmd(struct wmi *wmi, enum wmi_cmd_id cmd_id,\n\t\t  u8 *cmd_buf, u32 cmd_len,\n\t\t  u8 *rsp_buf, u32 rsp_len,\n\t\t  u32 timeout);\nvoid ath9k_wmi_event_tasklet(struct tasklet_struct *t);\nvoid ath9k_fatal_work(struct work_struct *work);\nvoid ath9k_wmi_event_drain(struct ath9k_htc_priv *priv);\nvoid ath9k_stop_wmi(struct ath9k_htc_priv *priv);\nvoid ath9k_destroy_wmi(struct ath9k_htc_priv *priv);\n\n#define WMI_CMD(_wmi_cmd)\t\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tret = ath9k_wmi_cmd(priv->wmi, _wmi_cmd, NULL, 0,\t\\\n\t\t\t\t    (u8 *) &cmd_rsp,\t\t\t\\\n\t\t\t\t    sizeof(cmd_rsp), HZ*2);\t\t\\\n\t} while (0)\n\n#define WMI_CMD_BUF(_wmi_cmd, _buf)\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tret = ath9k_wmi_cmd(priv->wmi, _wmi_cmd,\t\t\\\n\t\t\t\t    (u8 *) _buf, sizeof(*_buf),\t\t\\\n\t\t\t\t    &cmd_rsp, sizeof(cmd_rsp), HZ*2);\t\\\n\t} while (0)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}