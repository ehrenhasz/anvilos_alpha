{
  "module_name": "peerlookup.h",
  "hash_id": "9ef90671aaa82dcebccd9981fe4e104b287edba7e5f3cf36558f1139ad9db222",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireguard/peerlookup.h",
  "human_readable_source": " \n \n\n#ifndef _WG_PEERLOOKUP_H\n#define _WG_PEERLOOKUP_H\n\n#include \"messages.h\"\n\n#include <linux/hashtable.h>\n#include <linux/mutex.h>\n#include <linux/siphash.h>\n\nstruct wg_peer;\n\nstruct pubkey_hashtable {\n\t \n\tDECLARE_HASHTABLE(hashtable, 11);\n\tsiphash_key_t key;\n\tstruct mutex lock;\n};\n\nstruct pubkey_hashtable *wg_pubkey_hashtable_alloc(void);\nvoid wg_pubkey_hashtable_add(struct pubkey_hashtable *table,\n\t\t\t     struct wg_peer *peer);\nvoid wg_pubkey_hashtable_remove(struct pubkey_hashtable *table,\n\t\t\t\tstruct wg_peer *peer);\nstruct wg_peer *\nwg_pubkey_hashtable_lookup(struct pubkey_hashtable *table,\n\t\t\t   const u8 pubkey[NOISE_PUBLIC_KEY_LEN]);\n\nstruct index_hashtable {\n\t \n\tDECLARE_HASHTABLE(hashtable, 13);\n\tspinlock_t lock;\n};\n\nenum index_hashtable_type {\n\tINDEX_HASHTABLE_HANDSHAKE = 1U << 0,\n\tINDEX_HASHTABLE_KEYPAIR = 1U << 1\n};\n\nstruct index_hashtable_entry {\n\tstruct wg_peer *peer;\n\tstruct hlist_node index_hash;\n\tenum index_hashtable_type type;\n\t__le32 index;\n};\n\nstruct index_hashtable *wg_index_hashtable_alloc(void);\n__le32 wg_index_hashtable_insert(struct index_hashtable *table,\n\t\t\t\t struct index_hashtable_entry *entry);\nbool wg_index_hashtable_replace(struct index_hashtable *table,\n\t\t\t\tstruct index_hashtable_entry *old,\n\t\t\t\tstruct index_hashtable_entry *new);\nvoid wg_index_hashtable_remove(struct index_hashtable *table,\n\t\t\t       struct index_hashtable_entry *entry);\nstruct index_hashtable_entry *\nwg_index_hashtable_lookup(struct index_hashtable *table,\n\t\t\t  const enum index_hashtable_type type_mask,\n\t\t\t  const __le32 index, struct wg_peer **peer);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}