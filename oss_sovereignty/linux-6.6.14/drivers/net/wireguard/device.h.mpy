{
  "module_name": "device.h",
  "hash_id": "b4f816ebba0d4b0e85c03932044a86ed9ec1774bf7d27f6c24331c8fedf54c93",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireguard/device.h",
  "human_readable_source": " \n \n\n#ifndef _WG_DEVICE_H\n#define _WG_DEVICE_H\n\n#include \"noise.h\"\n#include \"allowedips.h\"\n#include \"peerlookup.h\"\n#include \"cookie.h\"\n\n#include <linux/types.h>\n#include <linux/netdevice.h>\n#include <linux/workqueue.h>\n#include <linux/mutex.h>\n#include <linux/net.h>\n#include <linux/ptr_ring.h>\n\nstruct wg_device;\n\nstruct multicore_worker {\n\tvoid *ptr;\n\tstruct work_struct work;\n};\n\nstruct crypt_queue {\n\tstruct ptr_ring ring;\n\tstruct multicore_worker __percpu *worker;\n\tint last_cpu;\n};\n\nstruct prev_queue {\n\tstruct sk_buff *head, *tail, *peeked;\n\tstruct { struct sk_buff *next, *prev; } empty; \n\tatomic_t count;\n};\n\nstruct wg_device {\n\tstruct net_device *dev;\n\tstruct crypt_queue encrypt_queue, decrypt_queue, handshake_queue;\n\tstruct sock __rcu *sock4, *sock6;\n\tstruct net __rcu *creating_net;\n\tstruct noise_static_identity static_identity;\n\tstruct workqueue_struct *packet_crypt_wq,*handshake_receive_wq, *handshake_send_wq;\n\tstruct cookie_checker cookie_checker;\n\tstruct pubkey_hashtable *peer_hashtable;\n\tstruct index_hashtable *index_hashtable;\n\tstruct allowedips peer_allowedips;\n\tstruct mutex device_update_lock, socket_update_lock;\n\tstruct list_head device_list, peer_list;\n\tatomic_t handshake_queue_len;\n\tunsigned int num_peers, device_update_gen;\n\tu32 fwmark;\n\tu16 incoming_port;\n};\n\nint wg_device_init(void);\nvoid wg_device_uninit(void);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}