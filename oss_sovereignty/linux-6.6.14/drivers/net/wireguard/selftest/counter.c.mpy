{
  "module_name": "counter.c",
  "hash_id": "c96b64981e652fea62e05bda2c47c6a8422a0006d1799ec2b7157069be4d87a2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/wireguard/selftest/counter.c",
  "human_readable_source": "\n \n\n#ifdef DEBUG\nbool __init wg_packet_counter_selftest(void)\n{\n\tstruct noise_replay_counter *counter;\n\tunsigned int test_num = 0, i;\n\tbool success = true;\n\n\tcounter = kmalloc(sizeof(*counter), GFP_KERNEL);\n\tif (unlikely(!counter)) {\n\t\tpr_err(\"nonce counter self-test malloc: FAIL\\n\");\n\t\treturn false;\n\t}\n\n#define T_INIT do {                                    \\\n\t\tmemset(counter, 0, sizeof(*counter));  \\\n\t\tspin_lock_init(&counter->lock);        \\\n\t} while (0)\n#define T_LIM (COUNTER_WINDOW_SIZE + 1)\n#define T(n, v) do {                                                  \\\n\t\t++test_num;                                           \\\n\t\tif (counter_validate(counter, n) != (v)) {            \\\n\t\t\tpr_err(\"nonce counter self-test %u: FAIL\\n\",  \\\n\t\t\t       test_num);                             \\\n\t\t\tsuccess = false;                              \\\n\t\t}                                                     \\\n\t} while (0)\n\n\tT_INIT;\n\t  T(0, true);\n\t  T(1, true);\n\t  T(1, false);\n\t  T(9, true);\n\t  T(8, true);\n\t  T(7, true);\n\t  T(7, false);\n\t  T(T_LIM, true);\n\t  T(T_LIM - 1, true);\n\t  T(T_LIM - 1, false);\n\t  T(T_LIM - 2, true);\n\t  T(2, true);\n\t  T(2, false);\n\t  T(T_LIM + 16, true);\n\t  T(3, false);\n\t  T(T_LIM + 16, false);\n\t  T(T_LIM * 4, true);\n\t  T(T_LIM * 4 - (T_LIM - 1), true);\n\t  T(10, false);\n\t  T(T_LIM * 4 - T_LIM, false);\n\t  T(T_LIM * 4 - (T_LIM + 1), false);\n\t  T(T_LIM * 4 - (T_LIM - 2), true);\n\t  T(T_LIM * 4 + 1 - T_LIM, false);\n\t  T(0, false);\n\t  T(REJECT_AFTER_MESSAGES, false);\n\t  T(REJECT_AFTER_MESSAGES - 1, true);\n\t  T(REJECT_AFTER_MESSAGES, false);\n\t  T(REJECT_AFTER_MESSAGES - 1, false);\n\t  T(REJECT_AFTER_MESSAGES - 2, true);\n\t  T(REJECT_AFTER_MESSAGES + 1, false);\n\t  T(REJECT_AFTER_MESSAGES + 2, false);\n\t  T(REJECT_AFTER_MESSAGES - 2, false);\n\t  T(REJECT_AFTER_MESSAGES - 3, true);\n\t  T(0, false);\n\n\tT_INIT;\n\tfor (i = 1; i <= COUNTER_WINDOW_SIZE; ++i)\n\t\tT(i, true);\n\tT(0, true);\n\tT(0, false);\n\n\tT_INIT;\n\tfor (i = 2; i <= COUNTER_WINDOW_SIZE + 1; ++i)\n\t\tT(i, true);\n\tT(1, true);\n\tT(0, false);\n\n\tT_INIT;\n\tfor (i = COUNTER_WINDOW_SIZE + 1; i-- > 0;)\n\t\tT(i, true);\n\n\tT_INIT;\n\tfor (i = COUNTER_WINDOW_SIZE + 2; i-- > 1;)\n\t\tT(i, true);\n\tT(0, false);\n\n\tT_INIT;\n\tfor (i = COUNTER_WINDOW_SIZE + 1; i-- > 1;)\n\t\tT(i, true);\n\tT(COUNTER_WINDOW_SIZE + 1, true);\n\tT(0, false);\n\n\tT_INIT;\n\tfor (i = COUNTER_WINDOW_SIZE + 1; i-- > 1;)\n\t\tT(i, true);\n\tT(0, true);\n\tT(COUNTER_WINDOW_SIZE + 1, true);\n\n#undef T\n#undef T_LIM\n#undef T_INIT\n\n\tif (success)\n\t\tpr_info(\"nonce counter self-tests: pass\\n\");\n\tkfree(counter);\n\treturn success;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}