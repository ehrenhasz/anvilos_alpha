{
  "module_name": "pcs-xpcs-nxp.c",
  "hash_id": "eb8c7d078b5bf71a69d49a2272e7274201455e5ae92f5a8eca03afa483fcfce6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/pcs/pcs-xpcs-nxp.c",
  "human_readable_source": "\n \n#include <linux/pcs/pcs-xpcs.h>\n#include \"pcs-xpcs.h\"\n\n \n#define SJA1110_LANE_DRIVER1_0\t\t0x8038\n#define SJA1110_TXDRV(x)\t\t(((x) << 12) & GENMASK(14, 12))\n\n \n#define SJA1110_LANE_DRIVER2_0\t\t0x803a\n#define SJA1110_TXDRVTRIM_LSB(x)\t((x) & GENMASK_ULL(15, 0))\n\n \n#define SJA1110_LANE_DRIVER2_1\t\t0x803b\n#define SJA1110_LANE_DRIVER2_1_RSV\tBIT(9)\n#define SJA1110_TXDRVTRIM_MSB(x)\t(((x) & GENMASK_ULL(23, 16)) >> 16)\n\n \n#define SJA1110_LANE_TRIM\t\t0x8040\n#define SJA1110_TXTEN\t\t\tBIT(11)\n#define SJA1110_TXRTRIM(x)\t\t(((x) << 8) & GENMASK(10, 8))\n#define SJA1110_TXPLL_BWSEL\t\tBIT(7)\n#define SJA1110_RXTEN\t\t\tBIT(6)\n#define SJA1110_RXRTRIM(x)\t\t(((x) << 3) & GENMASK(5, 3))\n#define SJA1110_CDR_GAIN\t\tBIT(2)\n#define SJA1110_ACCOUPLE_RXVCM_EN\tBIT(0)\n\n \n#define SJA1110_LANE_DATAPATH_1\t\t0x8037\n\n \n#define SJA1110_POWERDOWN_ENABLE\t0x8041\n#define SJA1110_TXPLL_PD\t\tBIT(12)\n#define SJA1110_TXPD\t\t\tBIT(11)\n#define SJA1110_RXPKDETEN\t\tBIT(10)\n#define SJA1110_RXCH_PD\t\t\tBIT(9)\n#define SJA1110_RXBIAS_PD\t\tBIT(8)\n#define SJA1110_RESET_SER_EN\t\tBIT(7)\n#define SJA1110_RESET_SER\t\tBIT(6)\n#define SJA1110_RESET_DES\t\tBIT(5)\n#define SJA1110_RCVEN\t\t\tBIT(4)\n\n \n#define SJA1110_RXPLL_CTRL0\t\t0x8065\n#define SJA1110_RXPLL_FBDIV(x)\t\t(((x) << 2) & GENMASK(9, 2))\n\n \n#define SJA1110_RXPLL_CTRL1\t\t0x8066\n#define SJA1110_RXPLL_REFDIV(x)\t\t((x) & GENMASK(4, 0))\n\n \n#define SJA1110_TXPLL_CTRL0\t\t0x806d\n#define SJA1110_TXPLL_FBDIV(x)\t\t((x) & GENMASK(11, 0))\n\n \n#define SJA1110_TXPLL_CTRL1\t\t0x806e\n#define SJA1110_TXPLL_REFDIV(x)\t\t((x) & GENMASK(5, 0))\n\n \n#define SJA1110_RX_DATA_DETECT\t\t0x8045\n\n \n#define SJA1110_RX_CDR_CTLE\t\t0x8042\n\n \nint nxp_sja1105_sgmii_pma_config(struct dw_xpcs *xpcs)\n{\n\treturn xpcs_write(xpcs, MDIO_MMD_VEND2, DW_VR_MII_DIG_CTRL2,\n\t\t\t  DW_VR_MII_DIG_CTRL2_TX_POL_INV);\n}\n\nstatic int nxp_sja1110_pma_config(struct dw_xpcs *xpcs,\n\t\t\t\t  u16 txpll_fbdiv, u16 txpll_refdiv,\n\t\t\t\t  u16 rxpll_fbdiv, u16 rxpll_refdiv,\n\t\t\t\t  u16 rx_cdr_ctle)\n{\n\tu16 val;\n\tint ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_TXPLL_CTRL0,\n\t\t\t SJA1110_TXPLL_FBDIV(txpll_fbdiv));\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_TXPLL_CTRL1,\n\t\t\t SJA1110_TXPLL_REFDIV(txpll_refdiv));\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_LANE_DRIVER1_0,\n\t\t\t SJA1110_TXDRV(0x5));\n\tif (ret < 0)\n\t\treturn ret;\n\n\tval = SJA1110_TXDRVTRIM_LSB(0xffffffull);\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_LANE_DRIVER2_0, val);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tval = SJA1110_TXDRVTRIM_MSB(0xffffffull) | SJA1110_LANE_DRIVER2_1_RSV;\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_LANE_DRIVER2_1, val);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tval = SJA1110_ACCOUPLE_RXVCM_EN | SJA1110_CDR_GAIN |\n\t      SJA1110_RXRTRIM(4) | SJA1110_RXTEN | SJA1110_TXPLL_BWSEL |\n\t      SJA1110_TXRTRIM(3) | SJA1110_TXTEN;\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_LANE_TRIM, val);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_LANE_DATAPATH_1, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_RXPLL_CTRL0,\n\t\t\t SJA1110_RXPLL_FBDIV(rxpll_fbdiv));\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_RXPLL_CTRL1,\n\t\t\t SJA1110_RXPLL_REFDIV(rxpll_refdiv));\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_RX_DATA_DETECT, 0x0005);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_read(xpcs, MDIO_MMD_VEND2, SJA1110_POWERDOWN_ENABLE);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tval = ret & ~(SJA1110_TXPLL_PD | SJA1110_TXPD | SJA1110_RXCH_PD |\n\t\t      SJA1110_RXBIAS_PD | SJA1110_RESET_SER_EN |\n\t\t      SJA1110_RESET_SER | SJA1110_RESET_DES);\n\tval |= SJA1110_RXPKDETEN | SJA1110_RCVEN;\n\n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_POWERDOWN_ENABLE, val);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t \n\tret = xpcs_write(xpcs, MDIO_MMD_VEND2, SJA1110_RX_CDR_CTLE,\n\t\t\t rx_cdr_ctle);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn 0;\n}\n\nint nxp_sja1110_sgmii_pma_config(struct dw_xpcs *xpcs)\n{\n\treturn nxp_sja1110_pma_config(xpcs, 0x19, 0x1, 0x19, 0x1, 0x212a);\n}\n\nint nxp_sja1110_2500basex_pma_config(struct dw_xpcs *xpcs)\n{\n\treturn nxp_sja1110_pma_config(xpcs, 0x7d, 0x2, 0x7d, 0x2, 0x732a);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}