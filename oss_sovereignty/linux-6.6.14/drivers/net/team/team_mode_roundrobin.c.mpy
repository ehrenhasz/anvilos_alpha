{
  "module_name": "team_mode_roundrobin.c",
  "hash_id": "c7f56ddc0d79fb3c19d7fb39ba6f6c4859a1f2794031a38d9e9e74a1efe2e433",
  "original_prompt": "Ingested from linux-6.6.14/drivers/net/team/team_mode_roundrobin.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/netdevice.h>\n#include <linux/if_team.h>\n\nstruct rr_priv {\n\tunsigned int sent_packets;\n};\n\nstatic struct rr_priv *rr_priv(struct team *team)\n{\n\treturn (struct rr_priv *) &team->mode_priv;\n}\n\nstatic bool rr_transmit(struct team *team, struct sk_buff *skb)\n{\n\tstruct team_port *port;\n\tint port_index;\n\n\tport_index = team_num_to_port_index(team,\n\t\t\t\t\t    rr_priv(team)->sent_packets++);\n\tport = team_get_port_by_index_rcu(team, port_index);\n\tif (unlikely(!port))\n\t\tgoto drop;\n\tport = team_get_first_port_txable_rcu(team, port);\n\tif (unlikely(!port))\n\t\tgoto drop;\n\tif (team_dev_queue_xmit(team, port, skb))\n\t\treturn false;\n\treturn true;\n\ndrop:\n\tdev_kfree_skb_any(skb);\n\treturn false;\n}\n\nstatic const struct team_mode_ops rr_mode_ops = {\n\t.transmit\t\t= rr_transmit,\n\t.port_enter\t\t= team_modeop_port_enter,\n\t.port_change_dev_addr\t= team_modeop_port_change_dev_addr,\n};\n\nstatic const struct team_mode rr_mode = {\n\t.kind\t\t= \"roundrobin\",\n\t.owner\t\t= THIS_MODULE,\n\t.priv_size\t= sizeof(struct rr_priv),\n\t.ops\t\t= &rr_mode_ops,\n\t.lag_tx_type\t= NETDEV_LAG_TX_TYPE_ROUNDROBIN,\n};\n\nstatic int __init rr_init_module(void)\n{\n\treturn team_mode_register(&rr_mode);\n}\n\nstatic void __exit rr_cleanup_module(void)\n{\n\tteam_mode_unregister(&rr_mode);\n}\n\nmodule_init(rr_init_module);\nmodule_exit(rr_cleanup_module);\n\nMODULE_LICENSE(\"GPL v2\");\nMODULE_AUTHOR(\"Jiri Pirko <jpirko@redhat.com>\");\nMODULE_DESCRIPTION(\"Round-robin mode for team\");\nMODULE_ALIAS_TEAM_MODE(\"roundrobin\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}