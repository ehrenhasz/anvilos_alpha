{
  "module_name": "zorro-sysfs.c",
  "hash_id": "c99e27b0a869c3062e0ddfdb0510cc967095726190d97aa9cdc9571da2c2d2af",
  "original_prompt": "Ingested from linux-6.6.14/drivers/zorro/zorro-sysfs.c",
  "human_readable_source": " \n\n\n#include <linux/kernel.h>\n#include <linux/zorro.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n\n#include <asm/byteorder.h>\n\n#include \"zorro.h\"\n\n\n \n#define zorro_config_attr(name, field, format_string)\t\t\t\\\nstatic ssize_t name##_show(struct device *dev,\t\t\t\t\\\n\t\t\t   struct device_attribute *attr, char *buf)\t\\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct zorro_dev *z;\t\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\\\n\tz = to_zorro_dev(dev);\t\t\t\t\t\t\\\n\treturn sprintf(buf, format_string, z->field);\t\t\t\\\n}\t\t\t\t\t\t\t\t\t\\\nstatic DEVICE_ATTR_RO(name);\n\nzorro_config_attr(id, id, \"0x%08x\\n\");\nzorro_config_attr(type, rom.er_Type, \"0x%02x\\n\");\nzorro_config_attr(slotaddr, slotaddr, \"0x%04x\\n\");\nzorro_config_attr(slotsize, slotsize, \"0x%04x\\n\");\n\nstatic ssize_t serial_show(struct device *dev, struct device_attribute *attr,\n\t\t\t   char *buf)\n{\n\tstruct zorro_dev *z;\n\n\tz = to_zorro_dev(dev);\n\treturn sprintf(buf, \"0x%08x\\n\", be32_to_cpu(z->rom.er_SerialNumber));\n}\nstatic DEVICE_ATTR_RO(serial);\n\nstatic ssize_t resource_show(struct device *dev, struct device_attribute *attr,\n\t\t\t     char *buf)\n{\n\tstruct zorro_dev *z = to_zorro_dev(dev);\n\n\treturn sprintf(buf, \"0x%08lx 0x%08lx 0x%08lx\\n\",\n\t\t       (unsigned long)zorro_resource_start(z),\n\t\t       (unsigned long)zorro_resource_end(z),\n\t\t       zorro_resource_flags(z));\n}\nstatic DEVICE_ATTR_RO(resource);\n\nstatic ssize_t modalias_show(struct device *dev, struct device_attribute *attr,\n\t\t\t     char *buf)\n{\n\tstruct zorro_dev *z = to_zorro_dev(dev);\n\n\treturn sprintf(buf, ZORRO_DEVICE_MODALIAS_FMT \"\\n\", z->id);\n}\nstatic DEVICE_ATTR_RO(modalias);\n\nstatic struct attribute *zorro_device_attrs[] = {\n\t&dev_attr_id.attr,\n\t&dev_attr_type.attr,\n\t&dev_attr_serial.attr,\n\t&dev_attr_slotaddr.attr,\n\t&dev_attr_slotsize.attr,\n\t&dev_attr_resource.attr,\n\t&dev_attr_modalias.attr,\n\tNULL\n};\n\nstatic ssize_t zorro_read_config(struct file *filp, struct kobject *kobj,\n\t\t\t\t struct bin_attribute *bin_attr,\n\t\t\t\t char *buf, loff_t off, size_t count)\n{\n\tstruct zorro_dev *z = to_zorro_dev(kobj_to_dev(kobj));\n\tstruct ConfigDev cd;\n\n\t \n\tmemset(&cd, 0, sizeof(cd));\n\tcd.cd_Rom = z->rom;\n\tcd.cd_SlotAddr = cpu_to_be16(z->slotaddr);\n\tcd.cd_SlotSize = cpu_to_be16(z->slotsize);\n\tcd.cd_BoardAddr = cpu_to_be32(zorro_resource_start(z));\n\tcd.cd_BoardSize = cpu_to_be32(zorro_resource_len(z));\n\n\treturn memory_read_from_buffer(buf, count, &off, &cd, sizeof(cd));\n}\n\nstatic struct bin_attribute zorro_config_attr = {\n\t.attr =\t{\n\t\t.name = \"config\",\n\t\t.mode = S_IRUGO,\n\t},\n\t.size = sizeof(struct ConfigDev),\n\t.read = zorro_read_config,\n};\n\nstatic struct bin_attribute *zorro_device_bin_attrs[] = {\n\t&zorro_config_attr,\n\tNULL\n};\n\nstatic const struct attribute_group zorro_device_attr_group = {\n\t.attrs\t\t= zorro_device_attrs,\n\t.bin_attrs\t= zorro_device_bin_attrs,\n};\n\nconst struct attribute_group *zorro_device_attribute_groups[] = {\n\t&zorro_device_attr_group,\n\tNULL\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}