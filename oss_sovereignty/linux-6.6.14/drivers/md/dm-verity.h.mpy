{
  "module_name": "dm-verity.h",
  "hash_id": "f450f3c21e789a82c4b21964ee78578eadb94bd11f5e87c8d2ef84db48453c51",
  "original_prompt": "Ingested from linux-6.6.14/drivers/md/dm-verity.h",
  "human_readable_source": " \n \n\n#ifndef DM_VERITY_H\n#define DM_VERITY_H\n\n#include <linux/dm-bufio.h>\n#include <linux/device-mapper.h>\n#include <linux/interrupt.h>\n#include <crypto/hash.h>\n\n#define DM_VERITY_MAX_LEVELS\t\t63\n\nenum verity_mode {\n\tDM_VERITY_MODE_EIO,\n\tDM_VERITY_MODE_LOGGING,\n\tDM_VERITY_MODE_RESTART,\n\tDM_VERITY_MODE_PANIC\n};\n\nenum verity_block_type {\n\tDM_VERITY_BLOCK_TYPE_DATA,\n\tDM_VERITY_BLOCK_TYPE_METADATA\n};\n\nstruct dm_verity_fec;\n\nstruct dm_verity {\n\tstruct dm_dev *data_dev;\n\tstruct dm_dev *hash_dev;\n\tstruct dm_target *ti;\n\tstruct dm_bufio_client *bufio;\n\tchar *alg_name;\n\tstruct crypto_ahash *tfm;\n\tu8 *root_digest;\t \n\tu8 *salt;\t\t \n\tu8 *zero_digest;\t \n\tunsigned int salt_size;\n\tsector_t data_start;\t \n\tsector_t hash_start;\t \n\tsector_t data_blocks;\t \n\tsector_t hash_blocks;\t \n\tunsigned char data_dev_block_bits;\t \n\tunsigned char hash_dev_block_bits;\t \n\tunsigned char hash_per_block_bits;\t \n\tunsigned char levels;\t \n\tunsigned char version;\n\tbool hash_failed:1;\t \n\tbool use_tasklet:1;\t \n\tunsigned int digest_size;\t \n\tunsigned int ahash_reqsize; \n\tenum verity_mode mode;\t \n\tunsigned int corrupted_errs; \n\n\tstruct workqueue_struct *verify_wq;\n\n\t \n\tsector_t hash_level_block[DM_VERITY_MAX_LEVELS];\n\n\tstruct dm_verity_fec *fec;\t \n\tunsigned long *validated_blocks;  \n\n\tchar *signature_key_desc;  \n};\n\nstruct dm_verity_io {\n\tstruct dm_verity *v;\n\n\t \n\tbio_end_io_t *orig_bi_end_io;\n\n\tsector_t block;\n\tunsigned int n_blocks;\n\tbool in_tasklet;\n\n\tstruct bvec_iter iter;\n\n\tstruct work_struct work;\n\tstruct tasklet_struct tasklet;\n\n\t \n};\n\nstatic inline struct ahash_request *verity_io_hash_req(struct dm_verity *v,\n\t\t\t\t\t\t     struct dm_verity_io *io)\n{\n\treturn (struct ahash_request *)(io + 1);\n}\n\nstatic inline u8 *verity_io_real_digest(struct dm_verity *v,\n\t\t\t\t\tstruct dm_verity_io *io)\n{\n\treturn (u8 *)(io + 1) + v->ahash_reqsize;\n}\n\nstatic inline u8 *verity_io_want_digest(struct dm_verity *v,\n\t\t\t\t\tstruct dm_verity_io *io)\n{\n\treturn (u8 *)(io + 1) + v->ahash_reqsize + v->digest_size;\n}\n\nextern int verity_for_bv_block(struct dm_verity *v, struct dm_verity_io *io,\n\t\t\t       struct bvec_iter *iter,\n\t\t\t       int (*process)(struct dm_verity *v,\n\t\t\t\t\t      struct dm_verity_io *io,\n\t\t\t\t\t      u8 *data, size_t len));\n\nextern int verity_hash(struct dm_verity *v, struct ahash_request *req,\n\t\t       const u8 *data, size_t len, u8 *digest, bool may_sleep);\n\nextern int verity_hash_for_block(struct dm_verity *v, struct dm_verity_io *io,\n\t\t\t\t sector_t block, u8 *digest, bool *is_zero);\n\nextern bool dm_is_verity_target(struct dm_target *ti);\nextern int dm_verity_get_mode(struct dm_target *ti);\nextern int dm_verity_get_root_digest(struct dm_target *ti, u8 **root_digest,\n\t\t\t\t     unsigned int *digest_size);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}