{
  "module_name": "dm-ima.h",
  "hash_id": "64aa24af395ba0eb456f19a9b2754438b2f571a8ddf01c685fbbfb4b2aafef50",
  "original_prompt": "Ingested from linux-6.6.14/drivers/md/dm-ima.h",
  "human_readable_source": " \n \n\n#ifndef DM_IMA_H\n#define DM_IMA_H\n\n#define DM_IMA_MEASUREMENT_BUF_LEN\t4096\n#define DM_IMA_DEVICE_BUF_LEN\t\t1024\n#define DM_IMA_TARGET_METADATA_BUF_LEN\t128\n#define DM_IMA_TARGET_DATA_BUF_LEN\t2048\n#define DM_IMA_DEVICE_CAPACITY_BUF_LEN\t128\n#define DM_IMA_TABLE_HASH_ALG\t\t\"sha256\"\n\n#define __dm_ima_stringify(s) #s\n#define __dm_ima_str(s) __dm_ima_stringify(s)\n\n#define DM_IMA_VERSION_STR \"dm_version=\"\t\\\n\t__dm_ima_str(DM_VERSION_MAJOR) \".\"\t\\\n\t__dm_ima_str(DM_VERSION_MINOR) \".\"\t\\\n\t__dm_ima_str(DM_VERSION_PATCHLEVEL) \";\"\n\n#ifdef CONFIG_IMA\n\nstruct dm_ima_device_table_metadata {\n\t \n\tchar *device_metadata;\n\tunsigned int device_metadata_len;\n\tunsigned int num_targets;\n\n\t \n\tchar *hash;\n\tunsigned int hash_len;\n};\n\n \nstruct dm_ima_measurements {\n\tstruct dm_ima_device_table_metadata active_table;\n\tstruct dm_ima_device_table_metadata inactive_table;\n\tunsigned int dm_version_str_len;\n};\n\nvoid dm_ima_reset_data(struct mapped_device *md);\nvoid dm_ima_measure_on_table_load(struct dm_table *table, unsigned int status_flags);\nvoid dm_ima_measure_on_device_resume(struct mapped_device *md, bool swap);\nvoid dm_ima_measure_on_device_remove(struct mapped_device *md, bool remove_all);\nvoid dm_ima_measure_on_table_clear(struct mapped_device *md, bool new_map);\nvoid dm_ima_measure_on_device_rename(struct mapped_device *md);\n\n#else\n\nstatic inline void dm_ima_reset_data(struct mapped_device *md) {}\nstatic inline void dm_ima_measure_on_table_load(struct dm_table *table, unsigned int status_flags) {}\nstatic inline void dm_ima_measure_on_device_resume(struct mapped_device *md, bool swap) {}\nstatic inline void dm_ima_measure_on_device_remove(struct mapped_device *md, bool remove_all) {}\nstatic inline void dm_ima_measure_on_table_clear(struct mapped_device *md, bool new_map) {}\nstatic inline void dm_ima_measure_on_device_rename(struct mapped_device *md) {}\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}