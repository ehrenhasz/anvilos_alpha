{
  "module_name": "dm-thin-metadata.h",
  "hash_id": "0ee1359a27e20fa1ab58647db5872f5326bd8c0b129d7cba8fc3ef15b1039b70",
  "original_prompt": "Ingested from linux-6.6.14/drivers/md/dm-thin-metadata.h",
  "human_readable_source": " \n \n\n#ifndef DM_THIN_METADATA_H\n#define DM_THIN_METADATA_H\n\n#include \"persistent-data/dm-block-manager.h\"\n#include \"persistent-data/dm-space-map.h\"\n#include \"persistent-data/dm-space-map-metadata.h\"\n\n#define THIN_METADATA_BLOCK_SIZE DM_SM_METADATA_BLOCK_SIZE\n\n \n#define THIN_METADATA_MAX_SECTORS DM_SM_METADATA_MAX_SECTORS\n\n \n#define THIN_METADATA_MAX_SECTORS_WARNING (16 * (1024 * 1024 * 1024 >> SECTOR_SHIFT))\n\n \n\n \n#define THIN_METADATA_NEEDS_CHECK_FLAG (1 << 0)\n\nstruct dm_pool_metadata;\nstruct dm_thin_device;\n\n \ntypedef uint64_t dm_thin_id;\n\n \nstruct dm_pool_metadata *dm_pool_metadata_open(struct block_device *bdev,\n\t\t\t\t\t       sector_t data_block_size,\n\t\t\t\t\t       bool format_device);\n\nint dm_pool_metadata_close(struct dm_pool_metadata *pmd);\n\n \n#define THIN_FEATURE_COMPAT_SUPP\t  0UL\n#define THIN_FEATURE_COMPAT_RO_SUPP\t  0UL\n#define THIN_FEATURE_INCOMPAT_SUPP\t  0UL\n\n \nint dm_pool_create_thin(struct dm_pool_metadata *pmd, dm_thin_id dev);\n\n \nint dm_pool_create_snap(struct dm_pool_metadata *pmd, dm_thin_id dev,\n\t\t\tdm_thin_id origin);\n\n \nint dm_pool_delete_thin_device(struct dm_pool_metadata *pmd,\n\t\t\t       dm_thin_id dev);\n\n \nint dm_pool_commit_metadata(struct dm_pool_metadata *pmd);\n\n \nint dm_pool_abort_metadata(struct dm_pool_metadata *pmd);\n\n \nint dm_pool_set_metadata_transaction_id(struct dm_pool_metadata *pmd,\n\t\t\t\t\tuint64_t current_id,\n\t\t\t\t\tuint64_t new_id);\n\nint dm_pool_get_metadata_transaction_id(struct dm_pool_metadata *pmd,\n\t\t\t\t\tuint64_t *result);\n\n \nint dm_pool_reserve_metadata_snap(struct dm_pool_metadata *pmd);\nint dm_pool_release_metadata_snap(struct dm_pool_metadata *pmd);\n\nint dm_pool_get_metadata_snap(struct dm_pool_metadata *pmd,\n\t\t\t      dm_block_t *result);\n\n \n\n \nint dm_pool_open_thin_device(struct dm_pool_metadata *pmd, dm_thin_id dev,\n\t\t\t     struct dm_thin_device **td);\n\nint dm_pool_close_thin_device(struct dm_thin_device *td);\n\ndm_thin_id dm_thin_dev_id(struct dm_thin_device *td);\n\nstruct dm_thin_lookup_result {\n\tdm_block_t block;\n\tbool shared:1;\n};\n\n \nint dm_thin_find_block(struct dm_thin_device *td, dm_block_t block,\n\t\t       int can_issue_io, struct dm_thin_lookup_result *result);\n\n \nint dm_thin_find_mapped_range(struct dm_thin_device *td,\n\t\t\t      dm_block_t begin, dm_block_t end,\n\t\t\t      dm_block_t *thin_begin, dm_block_t *thin_end,\n\t\t\t      dm_block_t *pool_begin, bool *maybe_shared);\n\n \nint dm_pool_alloc_data_block(struct dm_pool_metadata *pmd, dm_block_t *result);\n\n \nint dm_thin_insert_block(struct dm_thin_device *td, dm_block_t block,\n\t\t\t dm_block_t data_block);\n\nint dm_thin_remove_range(struct dm_thin_device *td,\n\t\t\t dm_block_t begin, dm_block_t end);\n\n \nbool dm_thin_changed_this_transaction(struct dm_thin_device *td);\n\nbool dm_pool_changed_this_transaction(struct dm_pool_metadata *pmd);\n\nbool dm_thin_aborted_changes(struct dm_thin_device *td);\n\nint dm_thin_get_highest_mapped_block(struct dm_thin_device *td,\n\t\t\t\t     dm_block_t *highest_mapped);\n\nint dm_thin_get_mapped_count(struct dm_thin_device *td, dm_block_t *result);\n\nint dm_pool_get_free_block_count(struct dm_pool_metadata *pmd,\n\t\t\t\t dm_block_t *result);\n\nint dm_pool_get_free_metadata_block_count(struct dm_pool_metadata *pmd,\n\t\t\t\t\t  dm_block_t *result);\n\nint dm_pool_get_metadata_dev_size(struct dm_pool_metadata *pmd,\n\t\t\t\t  dm_block_t *result);\n\nint dm_pool_get_data_dev_size(struct dm_pool_metadata *pmd, dm_block_t *result);\n\nint dm_pool_block_is_shared(struct dm_pool_metadata *pmd, dm_block_t b, bool *result);\n\nint dm_pool_inc_data_range(struct dm_pool_metadata *pmd, dm_block_t b, dm_block_t e);\nint dm_pool_dec_data_range(struct dm_pool_metadata *pmd, dm_block_t b, dm_block_t e);\n\n \nint dm_pool_resize_data_dev(struct dm_pool_metadata *pmd, dm_block_t new_size);\nint dm_pool_resize_metadata_dev(struct dm_pool_metadata *pmd, dm_block_t new_size);\n\n \nvoid dm_pool_metadata_read_only(struct dm_pool_metadata *pmd);\nvoid dm_pool_metadata_read_write(struct dm_pool_metadata *pmd);\n\nint dm_pool_register_metadata_threshold(struct dm_pool_metadata *pmd,\n\t\t\t\t\tdm_block_t threshold,\n\t\t\t\t\tdm_sm_threshold_fn fn,\n\t\t\t\t\tvoid *context);\n\n \nint dm_pool_metadata_set_needs_check(struct dm_pool_metadata *pmd);\nbool dm_pool_metadata_needs_check(struct dm_pool_metadata *pmd);\n\n \nvoid dm_pool_issue_prefetches(struct dm_pool_metadata *pmd);\n\n \ntypedef int (*dm_pool_pre_commit_fn)(void *context);\n\nvoid dm_pool_register_pre_commit_callback(struct dm_pool_metadata *pmd,\n\t\t\t\t\t  dm_pool_pre_commit_fn fn,\n\t\t\t\t\t  void *context);\n\n \n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}