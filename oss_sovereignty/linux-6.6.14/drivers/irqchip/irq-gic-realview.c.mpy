{
  "module_name": "irq-gic-realview.c",
  "hash_id": "00c9e77b14804f7160bd43a7dd829afb52bf77c2d1e68e9d8ad74240b43aa55d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/irqchip/irq-gic-realview.c",
  "human_readable_source": "\n \n#include <linux/of.h>\n#include <linux/regmap.h>\n#include <linux/mfd/syscon.h>\n#include <linux/bitops.h>\n#include <linux/irqchip.h>\n#include <linux/irqchip/arm-gic.h>\n\n#define REALVIEW_SYS_LOCK_OFFSET\t0x20\n#define REALVIEW_SYS_PLD_CTRL1\t\t0x74\n#define REALVIEW_EB_REVB_SYS_PLD_CTRL1\t0xD8\n#define VERSATILE_LOCK_VAL\t\t0xA05F\n#define PLD_INTMODE_MASK\t\tBIT(22)|BIT(23)|BIT(24)\n#define PLD_INTMODE_LEGACY\t\t0x0\n#define PLD_INTMODE_NEW_DCC\t\tBIT(22)\n#define PLD_INTMODE_NEW_NO_DCC\t\tBIT(23)\n#define PLD_INTMODE_FIQ_ENABLE\t\tBIT(24)\n\n \nstatic const struct of_device_id syscon_pldset_of_match[] = {\n\t{\n\t\t.compatible = \"arm,realview-eb11mp-revb-syscon\",\n\t\t.data = (void *)REALVIEW_EB_REVB_SYS_PLD_CTRL1,\n\t},\n\t{\n\t\t.compatible = \"arm,realview-eb11mp-revc-syscon\",\n\t\t.data = (void *)REALVIEW_SYS_PLD_CTRL1,\n\t},\n\t{\n\t\t.compatible = \"arm,realview-eb-syscon\",\n\t\t.data = (void *)REALVIEW_SYS_PLD_CTRL1,\n\t},\n\t{\n\t\t.compatible = \"arm,realview-pb11mp-syscon\",\n\t\t.data = (void *)REALVIEW_SYS_PLD_CTRL1,\n\t},\n\t{},\n};\n\nstatic int __init\nrealview_gic_of_init(struct device_node *node, struct device_node *parent)\n{\n\tstruct regmap *map;\n\tstruct device_node *np;\n\tconst struct of_device_id *gic_id;\n\tu32 pld1_ctrl;\n\n\tnp = of_find_matching_node_and_match(NULL, syscon_pldset_of_match,\n\t\t\t\t\t     &gic_id);\n\tif (!np)\n\t\treturn -ENODEV;\n\tpld1_ctrl = (u32)gic_id->data;\n\n\t \n\tmap = syscon_node_to_regmap(np);\n\tof_node_put(np);\n\tif (!IS_ERR(map)) {\n\t\t \n\t\tregmap_write(map, REALVIEW_SYS_LOCK_OFFSET,\n\t\t\t     VERSATILE_LOCK_VAL);\n\t\tregmap_update_bits(map, pld1_ctrl,\n\t\t\t\t   PLD_INTMODE_NEW_NO_DCC,\n\t\t\t\t   PLD_INTMODE_MASK);\n\t\tregmap_write(map, REALVIEW_SYS_LOCK_OFFSET, 0x0000);\n\t\tpr_info(\"RealView GIC: set up interrupt controller to NEW mode, no DCC\\n\");\n\t} else {\n\t\tpr_err(\"RealView GIC setup: could not find syscon\\n\");\n\t\treturn -ENODEV;\n\t}\n\treturn gic_of_init(node, parent);\n}\nIRQCHIP_DECLARE(armtc11mp_gic, \"arm,tc11mp-gic\", realview_gic_of_init);\nIRQCHIP_DECLARE(armeb11mp_gic, \"arm,eb11mp-gic\", realview_gic_of_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}