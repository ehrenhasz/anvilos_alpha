{
  "module_name": "irq-sl28cpld.c",
  "hash_id": "39c7c21c4b3d4418e7e7956ef85e32ce88cc2c8e36e2475476be7ef2b5e0b434",
  "original_prompt": "Ingested from linux-6.6.14/drivers/irqchip/irq-sl28cpld.c",
  "human_readable_source": "\n \n\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n#include <linux/property.h>\n#include <linux/regmap.h>\n\n#define INTC_IE 0x00\n#define INTC_IP 0x01\n\nstatic const struct regmap_irq sl28cpld_irqs[] = {\n\tREGMAP_IRQ_REG_LINE(0, 8),\n\tREGMAP_IRQ_REG_LINE(1, 8),\n\tREGMAP_IRQ_REG_LINE(2, 8),\n\tREGMAP_IRQ_REG_LINE(3, 8),\n\tREGMAP_IRQ_REG_LINE(4, 8),\n\tREGMAP_IRQ_REG_LINE(5, 8),\n\tREGMAP_IRQ_REG_LINE(6, 8),\n\tREGMAP_IRQ_REG_LINE(7, 8),\n};\n\nstruct sl28cpld_intc {\n\tstruct regmap *regmap;\n\tstruct regmap_irq_chip chip;\n\tstruct regmap_irq_chip_data *irq_data;\n};\n\nstatic int sl28cpld_intc_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct sl28cpld_intc *irqchip;\n\tint irq;\n\tu32 base;\n\tint ret;\n\n\tif (!dev->parent)\n\t\treturn -ENODEV;\n\n\tirqchip = devm_kzalloc(dev, sizeof(*irqchip), GFP_KERNEL);\n\tif (!irqchip)\n\t\treturn -ENOMEM;\n\n\tirqchip->regmap = dev_get_regmap(dev->parent, NULL);\n\tif (!irqchip->regmap)\n\t\treturn -ENODEV;\n\n\tirq = platform_get_irq(pdev, 0);\n\tif (irq < 0)\n\t\treturn irq;\n\n\tret = device_property_read_u32(&pdev->dev, \"reg\", &base);\n\tif (ret)\n\t\treturn -EINVAL;\n\n\tirqchip->chip.name = \"sl28cpld-intc\";\n\tirqchip->chip.irqs = sl28cpld_irqs;\n\tirqchip->chip.num_irqs = ARRAY_SIZE(sl28cpld_irqs);\n\tirqchip->chip.num_regs = 1;\n\tirqchip->chip.status_base = base + INTC_IP;\n\tirqchip->chip.unmask_base = base + INTC_IE;\n\tirqchip->chip.ack_base = base + INTC_IP;\n\n\treturn devm_regmap_add_irq_chip_fwnode(dev, dev_fwnode(dev),\n\t\t\t\t\t       irqchip->regmap, irq,\n\t\t\t\t\t       IRQF_SHARED | IRQF_ONESHOT, 0,\n\t\t\t\t\t       &irqchip->chip,\n\t\t\t\t\t       &irqchip->irq_data);\n}\n\nstatic const struct of_device_id sl28cpld_intc_of_match[] = {\n\t{ .compatible = \"kontron,sl28cpld-intc\" },\n\t{}\n};\nMODULE_DEVICE_TABLE(of, sl28cpld_intc_of_match);\n\nstatic struct platform_driver sl28cpld_intc_driver = {\n\t.probe = sl28cpld_intc_probe,\n\t.driver = {\n\t\t.name = \"sl28cpld-intc\",\n\t\t.of_match_table = sl28cpld_intc_of_match,\n\t}\n};\nmodule_platform_driver(sl28cpld_intc_driver);\n\nMODULE_DESCRIPTION(\"sl28cpld Interrupt Controller Driver\");\nMODULE_AUTHOR(\"Michael Walle <michael@walle.cc>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}