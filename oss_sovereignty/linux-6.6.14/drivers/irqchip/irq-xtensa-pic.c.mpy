{
  "module_name": "irq-xtensa-pic.c",
  "hash_id": "a47eaaa75097b89465f4bb79a0515ab8a054a0cfe18312285335e060a538b275",
  "original_prompt": "Ingested from linux-6.6.14/drivers/irqchip/irq-xtensa-pic.c",
  "human_readable_source": " \n\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/irqchip.h>\n#include <linux/irqchip/xtensa-pic.h>\n#include <linux/of.h>\n\nunsigned int cached_irq_mask;\n\n \nstatic int xtensa_pic_irq_domain_xlate(struct irq_domain *d,\n\t\tstruct device_node *ctrlr,\n\t\tconst u32 *intspec, unsigned int intsize,\n\t\tunsigned long *out_hwirq, unsigned int *out_type)\n{\n\treturn xtensa_irq_domain_xlate(intspec, intsize,\n\t\t\tintspec[0], intspec[0],\n\t\t\tout_hwirq, out_type);\n}\n\nstatic const struct irq_domain_ops xtensa_irq_domain_ops = {\n\t.xlate = xtensa_pic_irq_domain_xlate,\n\t.map = xtensa_irq_map,\n};\n\nstatic void xtensa_irq_mask(struct irq_data *d)\n{\n\tcached_irq_mask &= ~(1 << d->hwirq);\n\txtensa_set_sr(cached_irq_mask, intenable);\n}\n\nstatic void xtensa_irq_unmask(struct irq_data *d)\n{\n\tcached_irq_mask |= 1 << d->hwirq;\n\txtensa_set_sr(cached_irq_mask, intenable);\n}\n\nstatic void xtensa_irq_enable(struct irq_data *d)\n{\n\txtensa_irq_unmask(d);\n}\n\nstatic void xtensa_irq_disable(struct irq_data *d)\n{\n\txtensa_irq_mask(d);\n}\n\nstatic void xtensa_irq_ack(struct irq_data *d)\n{\n\txtensa_set_sr(1 << d->hwirq, intclear);\n}\n\nstatic int xtensa_irq_retrigger(struct irq_data *d)\n{\n\tunsigned int mask = 1u << d->hwirq;\n\n\tif (WARN_ON(mask & ~XCHAL_INTTYPE_MASK_SOFTWARE))\n\t\treturn 0;\n\txtensa_set_sr(mask, intset);\n\treturn 1;\n}\n\nstatic struct irq_chip xtensa_irq_chip = {\n\t.name\t\t= \"xtensa\",\n\t.irq_enable\t= xtensa_irq_enable,\n\t.irq_disable\t= xtensa_irq_disable,\n\t.irq_mask\t= xtensa_irq_mask,\n\t.irq_unmask\t= xtensa_irq_unmask,\n\t.irq_ack\t= xtensa_irq_ack,\n\t.irq_retrigger\t= xtensa_irq_retrigger,\n};\n\nint __init xtensa_pic_init_legacy(struct device_node *interrupt_parent)\n{\n\tstruct irq_domain *root_domain =\n\t\tirq_domain_add_legacy(NULL, NR_IRQS - 1, 1, 0,\n\t\t\t\t&xtensa_irq_domain_ops, &xtensa_irq_chip);\n\tirq_set_default_host(root_domain);\n\treturn 0;\n}\n\nstatic int __init xtensa_pic_init(struct device_node *np,\n\t\tstruct device_node *interrupt_parent)\n{\n\tstruct irq_domain *root_domain =\n\t\tirq_domain_add_linear(np, NR_IRQS, &xtensa_irq_domain_ops,\n\t\t\t\t&xtensa_irq_chip);\n\tirq_set_default_host(root_domain);\n\treturn 0;\n}\nIRQCHIP_DECLARE(xtensa_irq_chip, \"cdns,xtensa-pic\", xtensa_pic_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}