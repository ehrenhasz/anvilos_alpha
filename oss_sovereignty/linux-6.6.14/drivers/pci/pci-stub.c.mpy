{
  "module_name": "pci-stub.c",
  "hash_id": "984636494d9c7d0eabaccdd9022daecdce6211fe4f709c949a3a4dd00c343e7b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pci/pci-stub.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/pci.h>\n\nstatic char ids[1024] __initdata;\n\nmodule_param_string(ids, ids, sizeof(ids), 0);\nMODULE_PARM_DESC(ids, \"Initial PCI IDs to add to the stub driver, format is \"\n\t\t \"\\\"vendor:device[:subvendor[:subdevice[:class[:class_mask]]]]\\\"\"\n\t\t \" and multiple comma separated entries can be specified\");\n\nstatic int pci_stub_probe(struct pci_dev *dev, const struct pci_device_id *id)\n{\n\tpci_info(dev, \"claimed by stub\\n\");\n\treturn 0;\n}\n\nstatic struct pci_driver stub_driver = {\n\t.name\t\t= \"pci-stub\",\n\t.id_table\t= NULL,\t \n\t.probe\t\t= pci_stub_probe,\n\t.driver_managed_dma = true,\n};\n\nstatic int __init pci_stub_init(void)\n{\n\tchar *p, *id;\n\tint rc;\n\n\trc = pci_register_driver(&stub_driver);\n\tif (rc)\n\t\treturn rc;\n\n\t \n\tif (ids[0] == '\\0')\n\t\treturn 0;\n\n\t \n\tp = ids;\n\twhile ((id = strsep(&p, \",\"))) {\n\t\tunsigned int vendor, device, subvendor = PCI_ANY_ID,\n\t\t\tsubdevice = PCI_ANY_ID, class = 0, class_mask = 0;\n\t\tint fields;\n\n\t\tif (!strlen(id))\n\t\t\tcontinue;\n\n\t\tfields = sscanf(id, \"%x:%x:%x:%x:%x:%x\",\n\t\t\t\t&vendor, &device, &subvendor, &subdevice,\n\t\t\t\t&class, &class_mask);\n\n\t\tif (fields < 2) {\n\t\t\tpr_warn(\"pci-stub: invalid ID string \\\"%s\\\"\\n\", id);\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_info(\"pci-stub: add %04X:%04X sub=%04X:%04X cls=%08X/%08X\\n\",\n\t\t       vendor, device, subvendor, subdevice, class, class_mask);\n\n\t\trc = pci_add_dynid(&stub_driver, vendor, device,\n\t\t\t\t   subvendor, subdevice, class, class_mask, 0);\n\t\tif (rc)\n\t\t\tpr_warn(\"pci-stub: failed to add dynamic ID (%d)\\n\",\n\t\t\t\trc);\n\t}\n\n\treturn 0;\n}\n\nstatic void __exit pci_stub_exit(void)\n{\n\tpci_unregister_driver(&stub_driver);\n}\n\nmodule_init(pci_stub_init);\nmodule_exit(pci_stub_exit);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Chris Wright <chrisw@sous-sol.org>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}