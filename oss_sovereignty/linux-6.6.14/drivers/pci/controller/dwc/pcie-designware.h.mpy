{
  "module_name": "pcie-designware.h",
  "hash_id": "12afb31d431227b04a58fd347ce4f3e901a91b74b3d78589ab69cb09b4ed31a2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pci/controller/dwc/pcie-designware.h",
  "human_readable_source": " \n \n\n#ifndef _PCIE_DESIGNWARE_H\n#define _PCIE_DESIGNWARE_H\n\n#include <linux/bitfield.h>\n#include <linux/bitops.h>\n#include <linux/clk.h>\n#include <linux/dma-mapping.h>\n#include <linux/dma/edma.h>\n#include <linux/gpio/consumer.h>\n#include <linux/irq.h>\n#include <linux/msi.h>\n#include <linux/pci.h>\n#include <linux/reset.h>\n\n#include <linux/pci-epc.h>\n#include <linux/pci-epf.h>\n\n \n#define DW_PCIE_VER_365A\t\t0x3336352a\n#define DW_PCIE_VER_460A\t\t0x3436302a\n#define DW_PCIE_VER_470A\t\t0x3437302a\n#define DW_PCIE_VER_480A\t\t0x3438302a\n#define DW_PCIE_VER_490A\t\t0x3439302a\n#define DW_PCIE_VER_520A\t\t0x3532302a\n#define DW_PCIE_VER_540A\t\t0x3534302a\n\n#define __dw_pcie_ver_cmp(_pci, _ver, _op) \\\n\t((_pci)->version _op DW_PCIE_VER_ ## _ver)\n\n#define dw_pcie_ver_is(_pci, _ver) __dw_pcie_ver_cmp(_pci, _ver, ==)\n\n#define dw_pcie_ver_is_ge(_pci, _ver) __dw_pcie_ver_cmp(_pci, _ver, >=)\n\n#define dw_pcie_ver_type_is(_pci, _ver, _type) \\\n\t(__dw_pcie_ver_cmp(_pci, _ver, ==) && \\\n\t __dw_pcie_ver_cmp(_pci, TYPE_ ## _type, ==))\n\n#define dw_pcie_ver_type_is_ge(_pci, _ver, _type) \\\n\t(__dw_pcie_ver_cmp(_pci, _ver, ==) && \\\n\t __dw_pcie_ver_cmp(_pci, TYPE_ ## _type, >=))\n\n \n#define DW_PCIE_CAP_REQ_RES\t\t0\n#define DW_PCIE_CAP_IATU_UNROLL\t\t1\n#define DW_PCIE_CAP_CDM_CHECK\t\t2\n\n#define dw_pcie_cap_is(_pci, _cap) \\\n\ttest_bit(DW_PCIE_CAP_ ## _cap, &(_pci)->caps)\n\n#define dw_pcie_cap_set(_pci, _cap) \\\n\tset_bit(DW_PCIE_CAP_ ## _cap, &(_pci)->caps)\n\n \n#define LINK_WAIT_MAX_RETRIES\t\t10\n#define LINK_WAIT_USLEEP_MIN\t\t90000\n#define LINK_WAIT_USLEEP_MAX\t\t100000\n\n \n#define LINK_WAIT_MAX_IATU_RETRIES\t5\n#define LINK_WAIT_IATU\t\t\t9\n\n \n#define PCIE_PORT_AFR\t\t\t0x70C\n#define PORT_AFR_N_FTS_MASK\t\tGENMASK(15, 8)\n#define PORT_AFR_N_FTS(n)\t\tFIELD_PREP(PORT_AFR_N_FTS_MASK, n)\n#define PORT_AFR_CC_N_FTS_MASK\t\tGENMASK(23, 16)\n#define PORT_AFR_CC_N_FTS(n)\t\tFIELD_PREP(PORT_AFR_CC_N_FTS_MASK, n)\n#define PORT_AFR_ENTER_ASPM\t\tBIT(30)\n#define PORT_AFR_L0S_ENTRANCE_LAT_SHIFT\t24\n#define PORT_AFR_L0S_ENTRANCE_LAT_MASK\tGENMASK(26, 24)\n#define PORT_AFR_L1_ENTRANCE_LAT_SHIFT\t27\n#define PORT_AFR_L1_ENTRANCE_LAT_MASK\tGENMASK(29, 27)\n\n#define PCIE_PORT_LINK_CONTROL\t\t0x710\n#define PORT_LINK_DLL_LINK_EN\t\tBIT(5)\n#define PORT_LINK_FAST_LINK_MODE\tBIT(7)\n#define PORT_LINK_MODE_MASK\t\tGENMASK(21, 16)\n#define PORT_LINK_MODE(n)\t\tFIELD_PREP(PORT_LINK_MODE_MASK, n)\n#define PORT_LINK_MODE_1_LANES\t\tPORT_LINK_MODE(0x1)\n#define PORT_LINK_MODE_2_LANES\t\tPORT_LINK_MODE(0x3)\n#define PORT_LINK_MODE_4_LANES\t\tPORT_LINK_MODE(0x7)\n#define PORT_LINK_MODE_8_LANES\t\tPORT_LINK_MODE(0xf)\n\n#define PCIE_PORT_DEBUG0\t\t0x728\n#define PORT_LOGIC_LTSSM_STATE_MASK\t0x1f\n#define PORT_LOGIC_LTSSM_STATE_L0\t0x11\n#define PCIE_PORT_DEBUG1\t\t0x72C\n#define PCIE_PORT_DEBUG1_LINK_UP\t\tBIT(4)\n#define PCIE_PORT_DEBUG1_LINK_IN_TRAINING\tBIT(29)\n\n#define PCIE_LINK_WIDTH_SPEED_CONTROL\t0x80C\n#define PORT_LOGIC_N_FTS_MASK\t\tGENMASK(7, 0)\n#define PORT_LOGIC_SPEED_CHANGE\t\tBIT(17)\n#define PORT_LOGIC_LINK_WIDTH_MASK\tGENMASK(12, 8)\n#define PORT_LOGIC_LINK_WIDTH(n)\tFIELD_PREP(PORT_LOGIC_LINK_WIDTH_MASK, n)\n#define PORT_LOGIC_LINK_WIDTH_1_LANES\tPORT_LOGIC_LINK_WIDTH(0x1)\n#define PORT_LOGIC_LINK_WIDTH_2_LANES\tPORT_LOGIC_LINK_WIDTH(0x2)\n#define PORT_LOGIC_LINK_WIDTH_4_LANES\tPORT_LOGIC_LINK_WIDTH(0x4)\n#define PORT_LOGIC_LINK_WIDTH_8_LANES\tPORT_LOGIC_LINK_WIDTH(0x8)\n\n#define PCIE_MSI_ADDR_LO\t\t0x820\n#define PCIE_MSI_ADDR_HI\t\t0x824\n#define PCIE_MSI_INTR0_ENABLE\t\t0x828\n#define PCIE_MSI_INTR0_MASK\t\t0x82C\n#define PCIE_MSI_INTR0_STATUS\t\t0x830\n\n#define GEN3_RELATED_OFF\t\t\t0x890\n#define GEN3_RELATED_OFF_GEN3_ZRXDC_NONCOMPL\tBIT(0)\n#define GEN3_RELATED_OFF_RXEQ_RGRDLESS_RXTS\tBIT(13)\n#define GEN3_RELATED_OFF_GEN3_EQ_DISABLE\tBIT(16)\n#define GEN3_RELATED_OFF_RATE_SHADOW_SEL_SHIFT\t24\n#define GEN3_RELATED_OFF_RATE_SHADOW_SEL_MASK\tGENMASK(25, 24)\n\n#define PCIE_PORT_MULTI_LANE_CTRL\t0x8C0\n#define PORT_MLTI_UPCFG_SUPPORT\t\tBIT(7)\n\n#define PCIE_VERSION_NUMBER\t\t0x8F8\n#define PCIE_VERSION_TYPE\t\t0x8FC\n\n \n#define PCIE_ATU_VIEWPORT\t\t0x900\n#define PCIE_ATU_REGION_DIR_IB\t\tBIT(31)\n#define PCIE_ATU_REGION_DIR_OB\t\t0\n#define PCIE_ATU_VIEWPORT_BASE\t\t0x904\n#define PCIE_ATU_UNROLL_BASE(dir, index) \\\n\t(((index) << 9) | ((dir == PCIE_ATU_REGION_DIR_IB) ? BIT(8) : 0))\n#define PCIE_ATU_VIEWPORT_SIZE\t\t0x2C\n#define PCIE_ATU_REGION_CTRL1\t\t0x000\n#define PCIE_ATU_INCREASE_REGION_SIZE\tBIT(13)\n#define PCIE_ATU_TYPE_MEM\t\t0x0\n#define PCIE_ATU_TYPE_IO\t\t0x2\n#define PCIE_ATU_TYPE_CFG0\t\t0x4\n#define PCIE_ATU_TYPE_CFG1\t\t0x5\n#define PCIE_ATU_TD\t\t\tBIT(8)\n#define PCIE_ATU_FUNC_NUM(pf)           ((pf) << 20)\n#define PCIE_ATU_REGION_CTRL2\t\t0x004\n#define PCIE_ATU_ENABLE\t\t\tBIT(31)\n#define PCIE_ATU_BAR_MODE_ENABLE\tBIT(30)\n#define PCIE_ATU_FUNC_NUM_MATCH_EN      BIT(19)\n#define PCIE_ATU_LOWER_BASE\t\t0x008\n#define PCIE_ATU_UPPER_BASE\t\t0x00C\n#define PCIE_ATU_LIMIT\t\t\t0x010\n#define PCIE_ATU_LOWER_TARGET\t\t0x014\n#define PCIE_ATU_BUS(x)\t\t\tFIELD_PREP(GENMASK(31, 24), x)\n#define PCIE_ATU_DEV(x)\t\t\tFIELD_PREP(GENMASK(23, 19), x)\n#define PCIE_ATU_FUNC(x)\t\tFIELD_PREP(GENMASK(18, 16), x)\n#define PCIE_ATU_UPPER_TARGET\t\t0x018\n#define PCIE_ATU_UPPER_LIMIT\t\t0x020\n\n#define PCIE_MISC_CONTROL_1_OFF\t\t0x8BC\n#define PCIE_DBI_RO_WR_EN\t\tBIT(0)\n\n#define PCIE_MSIX_DOORBELL\t\t0x948\n#define PCIE_MSIX_DOORBELL_PF_SHIFT\t24\n\n \n#define PCIE_DMA_VIEWPORT_BASE\t\t0x970\n#define PCIE_DMA_UNROLL_BASE\t\t0x80000\n#define PCIE_DMA_CTRL\t\t\t0x008\n#define PCIE_DMA_NUM_WR_CHAN\t\tGENMASK(3, 0)\n#define PCIE_DMA_NUM_RD_CHAN\t\tGENMASK(19, 16)\n\n#define PCIE_PL_CHK_REG_CONTROL_STATUS\t\t\t0xB20\n#define PCIE_PL_CHK_REG_CHK_REG_START\t\t\tBIT(0)\n#define PCIE_PL_CHK_REG_CHK_REG_CONTINUOUS\t\tBIT(1)\n#define PCIE_PL_CHK_REG_CHK_REG_COMPARISON_ERROR\tBIT(16)\n#define PCIE_PL_CHK_REG_CHK_REG_LOGIC_ERROR\t\tBIT(17)\n#define PCIE_PL_CHK_REG_CHK_REG_COMPLETE\t\tBIT(18)\n\n#define PCIE_PL_CHK_REG_ERR_ADDR\t\t\t0xB28\n\n \n#define PCIE_ATU_UNR_REGION_CTRL1\t0x00\n#define PCIE_ATU_UNR_REGION_CTRL2\t0x04\n#define PCIE_ATU_UNR_LOWER_BASE\t\t0x08\n#define PCIE_ATU_UNR_UPPER_BASE\t\t0x0C\n#define PCIE_ATU_UNR_LOWER_LIMIT\t0x10\n#define PCIE_ATU_UNR_LOWER_TARGET\t0x14\n#define PCIE_ATU_UNR_UPPER_TARGET\t0x18\n#define PCIE_ATU_UNR_UPPER_LIMIT\t0x20\n\n \n#define PCIE_RAS_DES_EVENT_COUNTER_CONTROL\t0x8\n#define EVENT_COUNTER_ALL_CLEAR\t\t0x3\n#define EVENT_COUNTER_ENABLE_ALL\t0x7\n#define EVENT_COUNTER_ENABLE_SHIFT\t2\n#define EVENT_COUNTER_EVENT_SEL_MASK\tGENMASK(7, 0)\n#define EVENT_COUNTER_EVENT_SEL_SHIFT\t16\n#define EVENT_COUNTER_EVENT_Tx_L0S\t0x2\n#define EVENT_COUNTER_EVENT_Rx_L0S\t0x3\n#define EVENT_COUNTER_EVENT_L1\t\t0x5\n#define EVENT_COUNTER_EVENT_L1_1\t0x7\n#define EVENT_COUNTER_EVENT_L1_2\t0x8\n#define EVENT_COUNTER_GROUP_SEL_SHIFT\t24\n#define EVENT_COUNTER_GROUP_5\t\t0x5\n\n#define PCIE_RAS_DES_EVENT_COUNTER_DATA\t\t0xc\n\n \n#define DEFAULT_DBI_ATU_OFFSET (0x3 << 20)\n#define DEFAULT_DBI_DMA_OFFSET PCIE_DMA_UNROLL_BASE\n\n#define MAX_MSI_IRQS\t\t\t256\n#define MAX_MSI_IRQS_PER_CTRL\t\t32\n#define MAX_MSI_CTRLS\t\t\t(MAX_MSI_IRQS / MAX_MSI_IRQS_PER_CTRL)\n#define MSI_REG_CTRL_BLOCK_SIZE\t\t12\n#define MSI_DEF_NUM_VECTORS\t\t32\n\n \n#define MAX_IATU_IN\t\t\t256\n#define MAX_IATU_OUT\t\t\t256\n\n \n#define DMA_LLP_MEM_SIZE\t\tPAGE_SIZE\n\nstruct dw_pcie;\nstruct dw_pcie_rp;\nstruct dw_pcie_ep;\n\nenum dw_pcie_device_mode {\n\tDW_PCIE_UNKNOWN_TYPE,\n\tDW_PCIE_EP_TYPE,\n\tDW_PCIE_LEG_EP_TYPE,\n\tDW_PCIE_RC_TYPE,\n};\n\nenum dw_pcie_app_clk {\n\tDW_PCIE_DBI_CLK,\n\tDW_PCIE_MSTR_CLK,\n\tDW_PCIE_SLV_CLK,\n\tDW_PCIE_NUM_APP_CLKS\n};\n\nenum dw_pcie_core_clk {\n\tDW_PCIE_PIPE_CLK,\n\tDW_PCIE_CORE_CLK,\n\tDW_PCIE_AUX_CLK,\n\tDW_PCIE_REF_CLK,\n\tDW_PCIE_NUM_CORE_CLKS\n};\n\nenum dw_pcie_app_rst {\n\tDW_PCIE_DBI_RST,\n\tDW_PCIE_MSTR_RST,\n\tDW_PCIE_SLV_RST,\n\tDW_PCIE_NUM_APP_RSTS\n};\n\nenum dw_pcie_core_rst {\n\tDW_PCIE_NON_STICKY_RST,\n\tDW_PCIE_STICKY_RST,\n\tDW_PCIE_CORE_RST,\n\tDW_PCIE_PIPE_RST,\n\tDW_PCIE_PHY_RST,\n\tDW_PCIE_HOT_RST,\n\tDW_PCIE_PWR_RST,\n\tDW_PCIE_NUM_CORE_RSTS\n};\n\nenum dw_pcie_ltssm {\n\t \n\tDW_PCIE_LTSSM_DETECT_QUIET = 0x0,\n\tDW_PCIE_LTSSM_DETECT_ACT = 0x1,\n\tDW_PCIE_LTSSM_L0 = 0x11,\n\tDW_PCIE_LTSSM_L2_IDLE = 0x15,\n\n\tDW_PCIE_LTSSM_UNKNOWN = 0xFFFFFFFF,\n};\n\nstruct dw_pcie_host_ops {\n\tint (*host_init)(struct dw_pcie_rp *pp);\n\tvoid (*host_deinit)(struct dw_pcie_rp *pp);\n\tint (*msi_host_init)(struct dw_pcie_rp *pp);\n\tvoid (*pme_turn_off)(struct dw_pcie_rp *pp);\n};\n\nstruct dw_pcie_rp {\n\tbool\t\t\thas_msi_ctrl:1;\n\tbool\t\t\tcfg0_io_shared:1;\n\tu64\t\t\tcfg0_base;\n\tvoid __iomem\t\t*va_cfg0_base;\n\tu32\t\t\tcfg0_size;\n\tresource_size_t\t\tio_base;\n\tphys_addr_t\t\tio_bus_addr;\n\tu32\t\t\tio_size;\n\tint\t\t\tirq;\n\tconst struct dw_pcie_host_ops *ops;\n\tint\t\t\tmsi_irq[MAX_MSI_CTRLS];\n\tstruct irq_domain\t*irq_domain;\n\tstruct irq_domain\t*msi_domain;\n\tdma_addr_t\t\tmsi_data;\n\tstruct irq_chip\t\t*msi_irq_chip;\n\tu32\t\t\tnum_vectors;\n\tu32\t\t\tirq_mask[MAX_MSI_CTRLS];\n\tstruct pci_host_bridge  *bridge;\n\traw_spinlock_t\t\tlock;\n\tDECLARE_BITMAP(msi_irq_in_use, MAX_MSI_IRQS);\n};\n\nstruct dw_pcie_ep_ops {\n\tvoid\t(*ep_init)(struct dw_pcie_ep *ep);\n\tint\t(*raise_irq)(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t     enum pci_epc_irq_type type, u16 interrupt_num);\n\tconst struct pci_epc_features* (*get_features)(struct dw_pcie_ep *ep);\n\t \n\tunsigned int (*func_conf_select)(struct dw_pcie_ep *ep, u8 func_no);\n};\n\nstruct dw_pcie_ep_func {\n\tstruct list_head\tlist;\n\tu8\t\t\tfunc_no;\n\tu8\t\t\tmsi_cap;\t \n\tu8\t\t\tmsix_cap;\t \n};\n\nstruct dw_pcie_ep {\n\tstruct pci_epc\t\t*epc;\n\tstruct list_head\tfunc_list;\n\tconst struct dw_pcie_ep_ops *ops;\n\tphys_addr_t\t\tphys_base;\n\tsize_t\t\t\taddr_size;\n\tsize_t\t\t\tpage_size;\n\tu8\t\t\tbar_to_atu[PCI_STD_NUM_BARS];\n\tphys_addr_t\t\t*outbound_addr;\n\tunsigned long\t\t*ib_window_map;\n\tunsigned long\t\t*ob_window_map;\n\tvoid __iomem\t\t*msi_mem;\n\tphys_addr_t\t\tmsi_mem_phys;\n\tstruct pci_epf_bar\t*epf_bar[PCI_STD_NUM_BARS];\n};\n\nstruct dw_pcie_ops {\n\tu64\t(*cpu_addr_fixup)(struct dw_pcie *pcie, u64 cpu_addr);\n\tu32\t(*read_dbi)(struct dw_pcie *pcie, void __iomem *base, u32 reg,\n\t\t\t    size_t size);\n\tvoid\t(*write_dbi)(struct dw_pcie *pcie, void __iomem *base, u32 reg,\n\t\t\t     size_t size, u32 val);\n\tvoid    (*write_dbi2)(struct dw_pcie *pcie, void __iomem *base, u32 reg,\n\t\t\t      size_t size, u32 val);\n\tint\t(*link_up)(struct dw_pcie *pcie);\n\tenum dw_pcie_ltssm (*get_ltssm)(struct dw_pcie *pcie);\n\tint\t(*start_link)(struct dw_pcie *pcie);\n\tvoid\t(*stop_link)(struct dw_pcie *pcie);\n};\n\nstruct dw_pcie {\n\tstruct device\t\t*dev;\n\tvoid __iomem\t\t*dbi_base;\n\tvoid __iomem\t\t*dbi_base2;\n\tvoid __iomem\t\t*atu_base;\n\tsize_t\t\t\tatu_size;\n\tu32\t\t\tnum_ib_windows;\n\tu32\t\t\tnum_ob_windows;\n\tu32\t\t\tregion_align;\n\tu64\t\t\tregion_limit;\n\tstruct dw_pcie_rp\tpp;\n\tstruct dw_pcie_ep\tep;\n\tconst struct dw_pcie_ops *ops;\n\tu32\t\t\tversion;\n\tu32\t\t\ttype;\n\tunsigned long\t\tcaps;\n\tint\t\t\tnum_lanes;\n\tint\t\t\tlink_gen;\n\tu8\t\t\tn_fts[2];\n\tstruct dw_edma_chip\tedma;\n\tstruct clk_bulk_data\tapp_clks[DW_PCIE_NUM_APP_CLKS];\n\tstruct clk_bulk_data\tcore_clks[DW_PCIE_NUM_CORE_CLKS];\n\tstruct reset_control_bulk_data\tapp_rsts[DW_PCIE_NUM_APP_RSTS];\n\tstruct reset_control_bulk_data\tcore_rsts[DW_PCIE_NUM_CORE_RSTS];\n\tstruct gpio_desc\t\t*pe_rst;\n\tbool\t\t\tsuspended;\n};\n\n#define to_dw_pcie_from_pp(port) container_of((port), struct dw_pcie, pp)\n\n#define to_dw_pcie_from_ep(endpoint)   \\\n\t\tcontainer_of((endpoint), struct dw_pcie, ep)\n\nint dw_pcie_get_resources(struct dw_pcie *pci);\n\nvoid dw_pcie_version_detect(struct dw_pcie *pci);\n\nu8 dw_pcie_find_capability(struct dw_pcie *pci, u8 cap);\nu16 dw_pcie_find_ext_capability(struct dw_pcie *pci, u8 cap);\n\nint dw_pcie_read(void __iomem *addr, int size, u32 *val);\nint dw_pcie_write(void __iomem *addr, int size, u32 val);\n\nu32 dw_pcie_read_dbi(struct dw_pcie *pci, u32 reg, size_t size);\nvoid dw_pcie_write_dbi(struct dw_pcie *pci, u32 reg, size_t size, u32 val);\nvoid dw_pcie_write_dbi2(struct dw_pcie *pci, u32 reg, size_t size, u32 val);\nint dw_pcie_link_up(struct dw_pcie *pci);\nvoid dw_pcie_upconfig_setup(struct dw_pcie *pci);\nint dw_pcie_wait_for_link(struct dw_pcie *pci);\nint dw_pcie_prog_outbound_atu(struct dw_pcie *pci, int index, int type,\n\t\t\t      u64 cpu_addr, u64 pci_addr, u64 size);\nint dw_pcie_prog_ep_outbound_atu(struct dw_pcie *pci, u8 func_no, int index,\n\t\t\t\t int type, u64 cpu_addr, u64 pci_addr, u64 size);\nint dw_pcie_prog_inbound_atu(struct dw_pcie *pci, int index, int type,\n\t\t\t     u64 cpu_addr, u64 pci_addr, u64 size);\nint dw_pcie_prog_ep_inbound_atu(struct dw_pcie *pci, u8 func_no, int index,\n\t\t\t\tint type, u64 cpu_addr, u8 bar);\nvoid dw_pcie_disable_atu(struct dw_pcie *pci, u32 dir, int index);\nvoid dw_pcie_setup(struct dw_pcie *pci);\nvoid dw_pcie_iatu_detect(struct dw_pcie *pci);\nint dw_pcie_edma_detect(struct dw_pcie *pci);\nvoid dw_pcie_edma_remove(struct dw_pcie *pci);\n\nint dw_pcie_suspend_noirq(struct dw_pcie *pci);\nint dw_pcie_resume_noirq(struct dw_pcie *pci);\n\nstatic inline void dw_pcie_writel_dbi(struct dw_pcie *pci, u32 reg, u32 val)\n{\n\tdw_pcie_write_dbi(pci, reg, 0x4, val);\n}\n\nstatic inline u32 dw_pcie_readl_dbi(struct dw_pcie *pci, u32 reg)\n{\n\treturn dw_pcie_read_dbi(pci, reg, 0x4);\n}\n\nstatic inline void dw_pcie_writew_dbi(struct dw_pcie *pci, u32 reg, u16 val)\n{\n\tdw_pcie_write_dbi(pci, reg, 0x2, val);\n}\n\nstatic inline u16 dw_pcie_readw_dbi(struct dw_pcie *pci, u32 reg)\n{\n\treturn dw_pcie_read_dbi(pci, reg, 0x2);\n}\n\nstatic inline void dw_pcie_writeb_dbi(struct dw_pcie *pci, u32 reg, u8 val)\n{\n\tdw_pcie_write_dbi(pci, reg, 0x1, val);\n}\n\nstatic inline u8 dw_pcie_readb_dbi(struct dw_pcie *pci, u32 reg)\n{\n\treturn dw_pcie_read_dbi(pci, reg, 0x1);\n}\n\nstatic inline void dw_pcie_writel_dbi2(struct dw_pcie *pci, u32 reg, u32 val)\n{\n\tdw_pcie_write_dbi2(pci, reg, 0x4, val);\n}\n\nstatic inline void dw_pcie_dbi_ro_wr_en(struct dw_pcie *pci)\n{\n\tu32 reg;\n\tu32 val;\n\n\treg = PCIE_MISC_CONTROL_1_OFF;\n\tval = dw_pcie_readl_dbi(pci, reg);\n\tval |= PCIE_DBI_RO_WR_EN;\n\tdw_pcie_writel_dbi(pci, reg, val);\n}\n\nstatic inline void dw_pcie_dbi_ro_wr_dis(struct dw_pcie *pci)\n{\n\tu32 reg;\n\tu32 val;\n\n\treg = PCIE_MISC_CONTROL_1_OFF;\n\tval = dw_pcie_readl_dbi(pci, reg);\n\tval &= ~PCIE_DBI_RO_WR_EN;\n\tdw_pcie_writel_dbi(pci, reg, val);\n}\n\nstatic inline int dw_pcie_start_link(struct dw_pcie *pci)\n{\n\tif (pci->ops && pci->ops->start_link)\n\t\treturn pci->ops->start_link(pci);\n\n\treturn 0;\n}\n\nstatic inline void dw_pcie_stop_link(struct dw_pcie *pci)\n{\n\tif (pci->ops && pci->ops->stop_link)\n\t\tpci->ops->stop_link(pci);\n}\n\nstatic inline enum dw_pcie_ltssm dw_pcie_get_ltssm(struct dw_pcie *pci)\n{\n\tu32 val;\n\n\tif (pci->ops && pci->ops->get_ltssm)\n\t\treturn pci->ops->get_ltssm(pci);\n\n\tval = dw_pcie_readl_dbi(pci, PCIE_PORT_DEBUG0);\n\n\treturn (enum dw_pcie_ltssm)FIELD_GET(PORT_LOGIC_LTSSM_STATE_MASK, val);\n}\n\n#ifdef CONFIG_PCIE_DW_HOST\nirqreturn_t dw_handle_msi_irq(struct dw_pcie_rp *pp);\nint dw_pcie_setup_rc(struct dw_pcie_rp *pp);\nint dw_pcie_host_init(struct dw_pcie_rp *pp);\nvoid dw_pcie_host_deinit(struct dw_pcie_rp *pp);\nint dw_pcie_allocate_domains(struct dw_pcie_rp *pp);\nvoid __iomem *dw_pcie_own_conf_map_bus(struct pci_bus *bus, unsigned int devfn,\n\t\t\t\t       int where);\n#else\nstatic inline irqreturn_t dw_handle_msi_irq(struct dw_pcie_rp *pp)\n{\n\treturn IRQ_NONE;\n}\n\nstatic inline int dw_pcie_setup_rc(struct dw_pcie_rp *pp)\n{\n\treturn 0;\n}\n\nstatic inline int dw_pcie_host_init(struct dw_pcie_rp *pp)\n{\n\treturn 0;\n}\n\nstatic inline void dw_pcie_host_deinit(struct dw_pcie_rp *pp)\n{\n}\n\nstatic inline int dw_pcie_allocate_domains(struct dw_pcie_rp *pp)\n{\n\treturn 0;\n}\nstatic inline void __iomem *dw_pcie_own_conf_map_bus(struct pci_bus *bus,\n\t\t\t\t\t\t     unsigned int devfn,\n\t\t\t\t\t\t     int where)\n{\n\treturn NULL;\n}\n#endif\n\n#ifdef CONFIG_PCIE_DW_EP\nvoid dw_pcie_ep_linkup(struct dw_pcie_ep *ep);\nint dw_pcie_ep_init(struct dw_pcie_ep *ep);\nint dw_pcie_ep_init_complete(struct dw_pcie_ep *ep);\nvoid dw_pcie_ep_init_notify(struct dw_pcie_ep *ep);\nvoid dw_pcie_ep_exit(struct dw_pcie_ep *ep);\nint dw_pcie_ep_raise_legacy_irq(struct dw_pcie_ep *ep, u8 func_no);\nint dw_pcie_ep_raise_msi_irq(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t     u8 interrupt_num);\nint dw_pcie_ep_raise_msix_irq(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t     u16 interrupt_num);\nint dw_pcie_ep_raise_msix_irq_doorbell(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t\t       u16 interrupt_num);\nvoid dw_pcie_ep_reset_bar(struct dw_pcie *pci, enum pci_barno bar);\nstruct dw_pcie_ep_func *\ndw_pcie_ep_get_func_from_ep(struct dw_pcie_ep *ep, u8 func_no);\n#else\nstatic inline void dw_pcie_ep_linkup(struct dw_pcie_ep *ep)\n{\n}\n\nstatic inline int dw_pcie_ep_init(struct dw_pcie_ep *ep)\n{\n\treturn 0;\n}\n\nstatic inline int dw_pcie_ep_init_complete(struct dw_pcie_ep *ep)\n{\n\treturn 0;\n}\n\nstatic inline void dw_pcie_ep_init_notify(struct dw_pcie_ep *ep)\n{\n}\n\nstatic inline void dw_pcie_ep_exit(struct dw_pcie_ep *ep)\n{\n}\n\nstatic inline int dw_pcie_ep_raise_legacy_irq(struct dw_pcie_ep *ep, u8 func_no)\n{\n\treturn 0;\n}\n\nstatic inline int dw_pcie_ep_raise_msi_irq(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t\t\t   u8 interrupt_num)\n{\n\treturn 0;\n}\n\nstatic inline int dw_pcie_ep_raise_msix_irq(struct dw_pcie_ep *ep, u8 func_no,\n\t\t\t\t\t   u16 interrupt_num)\n{\n\treturn 0;\n}\n\nstatic inline int dw_pcie_ep_raise_msix_irq_doorbell(struct dw_pcie_ep *ep,\n\t\t\t\t\t\t     u8 func_no,\n\t\t\t\t\t\t     u16 interrupt_num)\n{\n\treturn 0;\n}\n\nstatic inline void dw_pcie_ep_reset_bar(struct dw_pcie *pci, enum pci_barno bar)\n{\n}\n\nstatic inline struct dw_pcie_ep_func *\ndw_pcie_ep_get_func_from_ep(struct dw_pcie_ep *ep, u8 func_no)\n{\n\treturn NULL;\n}\n#endif\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}