{
  "module_name": "pci-host-generic.c",
  "hash_id": "6fc1a9c274e27988f304e17cf44ccc060c08e14a8481d47bdd9056ce9a3de1a1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pci/controller/pci-host-generic.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/pci-ecam.h>\n#include <linux/platform_device.h>\n\nstatic const struct pci_ecam_ops gen_pci_cfg_cam_bus_ops = {\n\t.bus_shift\t= 16,\n\t.pci_ops\t= {\n\t\t.map_bus\t= pci_ecam_map_bus,\n\t\t.read\t\t= pci_generic_config_read,\n\t\t.write\t\t= pci_generic_config_write,\n\t}\n};\n\nstatic bool pci_dw_valid_device(struct pci_bus *bus, unsigned int devfn)\n{\n\tstruct pci_config_window *cfg = bus->sysdata;\n\n\t \n\tif (bus->number == cfg->busr.start && PCI_SLOT(devfn) > 0)\n\t\treturn false;\n\n\treturn true;\n}\n\nstatic void __iomem *pci_dw_ecam_map_bus(struct pci_bus *bus,\n\t\t\t\t\t unsigned int devfn, int where)\n{\n\tif (!pci_dw_valid_device(bus, devfn))\n\t\treturn NULL;\n\n\treturn pci_ecam_map_bus(bus, devfn, where);\n}\n\nstatic const struct pci_ecam_ops pci_dw_ecam_bus_ops = {\n\t.pci_ops\t= {\n\t\t.map_bus\t= pci_dw_ecam_map_bus,\n\t\t.read\t\t= pci_generic_config_read,\n\t\t.write\t\t= pci_generic_config_write,\n\t}\n};\n\nstatic const struct of_device_id gen_pci_of_match[] = {\n\t{ .compatible = \"pci-host-cam-generic\",\n\t  .data = &gen_pci_cfg_cam_bus_ops },\n\n\t{ .compatible = \"pci-host-ecam-generic\",\n\t  .data = &pci_generic_ecam_ops },\n\n\t{ .compatible = \"marvell,armada8k-pcie-ecam\",\n\t  .data = &pci_dw_ecam_bus_ops },\n\n\t{ .compatible = \"socionext,synquacer-pcie-ecam\",\n\t  .data = &pci_dw_ecam_bus_ops },\n\n\t{ .compatible = \"snps,dw-pcie-ecam\",\n\t  .data = &pci_dw_ecam_bus_ops },\n\n\t{ },\n};\nMODULE_DEVICE_TABLE(of, gen_pci_of_match);\n\nstatic struct platform_driver gen_pci_driver = {\n\t.driver = {\n\t\t.name = \"pci-host-generic\",\n\t\t.of_match_table = gen_pci_of_match,\n\t},\n\t.probe = pci_host_common_probe,\n\t.remove = pci_host_common_remove,\n};\nmodule_platform_driver(gen_pci_driver);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}