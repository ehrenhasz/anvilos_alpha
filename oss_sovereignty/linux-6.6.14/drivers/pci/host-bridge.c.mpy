{
  "module_name": "host-bridge.c",
  "hash_id": "21b05f1697bdd0646ca8d3d16d59a84b626011daa152f8fb470f8212144902cb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pci/host-bridge.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/pci.h>\n#include <linux/module.h>\n\n#include \"pci.h\"\n\nstatic struct pci_bus *find_pci_root_bus(struct pci_bus *bus)\n{\n\twhile (bus->parent)\n\t\tbus = bus->parent;\n\n\treturn bus;\n}\n\nstruct pci_host_bridge *pci_find_host_bridge(struct pci_bus *bus)\n{\n\tstruct pci_bus *root_bus = find_pci_root_bus(bus);\n\n\treturn to_pci_host_bridge(root_bus->bridge);\n}\nEXPORT_SYMBOL_GPL(pci_find_host_bridge);\n\nstruct device *pci_get_host_bridge_device(struct pci_dev *dev)\n{\n\tstruct pci_bus *root_bus = find_pci_root_bus(dev->bus);\n\tstruct device *bridge = root_bus->bridge;\n\n\tkobject_get(&bridge->kobj);\n\treturn bridge;\n}\n\nvoid  pci_put_host_bridge_device(struct device *dev)\n{\n\tkobject_put(&dev->kobj);\n}\n\nvoid pci_set_host_bridge_release(struct pci_host_bridge *bridge,\n\t\t\t\t void (*release_fn)(struct pci_host_bridge *),\n\t\t\t\t void *release_data)\n{\n\tbridge->release_fn = release_fn;\n\tbridge->release_data = release_data;\n}\nEXPORT_SYMBOL_GPL(pci_set_host_bridge_release);\n\nvoid pcibios_resource_to_bus(struct pci_bus *bus, struct pci_bus_region *region,\n\t\t\t     struct resource *res)\n{\n\tstruct pci_host_bridge *bridge = pci_find_host_bridge(bus);\n\tstruct resource_entry *window;\n\tresource_size_t offset = 0;\n\n\tresource_list_for_each_entry(window, &bridge->windows) {\n\t\tif (resource_contains(window->res, res)) {\n\t\t\toffset = window->offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tregion->start = res->start - offset;\n\tregion->end = res->end - offset;\n}\nEXPORT_SYMBOL(pcibios_resource_to_bus);\n\nstatic bool region_contains(struct pci_bus_region *region1,\n\t\t\t    struct pci_bus_region *region2)\n{\n\treturn region1->start <= region2->start && region1->end >= region2->end;\n}\n\nvoid pcibios_bus_to_resource(struct pci_bus *bus, struct resource *res,\n\t\t\t     struct pci_bus_region *region)\n{\n\tstruct pci_host_bridge *bridge = pci_find_host_bridge(bus);\n\tstruct resource_entry *window;\n\tresource_size_t offset = 0;\n\n\tresource_list_for_each_entry(window, &bridge->windows) {\n\t\tstruct pci_bus_region bus_region;\n\n\t\tif (resource_type(res) != resource_type(window->res))\n\t\t\tcontinue;\n\n\t\tbus_region.start = window->res->start - window->offset;\n\t\tbus_region.end = window->res->end - window->offset;\n\n\t\tif (region_contains(&bus_region, region)) {\n\t\t\toffset = window->offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tres->start = region->start + offset;\n\tres->end = region->end + offset;\n}\nEXPORT_SYMBOL(pcibios_bus_to_resource);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}