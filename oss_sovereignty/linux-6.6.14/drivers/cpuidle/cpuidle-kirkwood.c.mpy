{
  "module_name": "cpuidle-kirkwood.c",
  "hash_id": "8f5d8ffe1d7e4a72f9914a5bbef0d23a0322f5e4e680f008814ff5f29a929aa0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/cpuidle/cpuidle-kirkwood.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/cpuidle.h>\n#include <linux/io.h>\n#include <linux/export.h>\n#include <asm/cpuidle.h>\n\n#define KIRKWOOD_MAX_STATES\t2\n\nstatic void __iomem *ddr_operation_base;\n\n \nstatic int kirkwood_enter_idle(struct cpuidle_device *dev,\n\t\t\t       struct cpuidle_driver *drv,\n\t\t\t       int index)\n{\n\twritel(0x7, ddr_operation_base);\n\tcpu_do_idle();\n\n\treturn index;\n}\n\nstatic struct cpuidle_driver kirkwood_idle_driver = {\n\t.name\t\t\t= \"kirkwood_idle\",\n\t.owner\t\t\t= THIS_MODULE,\n\t.states[0]\t\t= ARM_CPUIDLE_WFI_STATE,\n\t.states[1]\t\t= {\n\t\t.enter\t\t\t= kirkwood_enter_idle,\n\t\t.exit_latency\t\t= 10,\n\t\t.target_residency\t= 100000,\n\t\t.name\t\t\t= \"DDR SR\",\n\t\t.desc\t\t\t= \"WFI and DDR Self Refresh\",\n\t},\n\t.state_count = KIRKWOOD_MAX_STATES,\n};\n\n \nstatic int kirkwood_cpuidle_probe(struct platform_device *pdev)\n{\n\tddr_operation_base = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(ddr_operation_base))\n\t\treturn PTR_ERR(ddr_operation_base);\n\n\treturn cpuidle_register(&kirkwood_idle_driver, NULL);\n}\n\nstatic int kirkwood_cpuidle_remove(struct platform_device *pdev)\n{\n\tcpuidle_unregister(&kirkwood_idle_driver);\n\treturn 0;\n}\n\nstatic struct platform_driver kirkwood_cpuidle_driver = {\n\t.probe = kirkwood_cpuidle_probe,\n\t.remove = kirkwood_cpuidle_remove,\n\t.driver = {\n\t\t   .name = \"kirkwood_cpuidle\",\n\t\t   },\n};\n\nmodule_platform_driver(kirkwood_cpuidle_driver);\n\nMODULE_AUTHOR(\"Andrew Lunn <andrew@lunn.ch>\");\nMODULE_DESCRIPTION(\"Kirkwood cpu idle driver\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_ALIAS(\"platform:kirkwood-cpuidle\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}