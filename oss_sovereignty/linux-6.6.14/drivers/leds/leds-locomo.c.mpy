{
  "module_name": "leds-locomo.c",
  "hash_id": "69ebf9c2a9b448fd9eb10e59920a0691d4fbcbab0f21e2b9570335d4736787da",
  "original_prompt": "Ingested from linux-6.6.14/drivers/leds/leds-locomo.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/device.h>\n#include <linux/leds.h>\n\n#include <asm/hardware/locomo.h>\n\nstatic void locomoled_brightness_set(struct led_classdev *led_cdev,\n\t\t\t\tenum led_brightness value, int offset)\n{\n\tstruct locomo_dev *locomo_dev = LOCOMO_DEV(led_cdev->dev->parent);\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (value)\n\t\tlocomo_writel(LOCOMO_LPT_TOFH, locomo_dev->mapbase + offset);\n\telse\n\t\tlocomo_writel(LOCOMO_LPT_TOFL, locomo_dev->mapbase + offset);\n\tlocal_irq_restore(flags);\n}\n\nstatic void locomoled_brightness_set0(struct led_classdev *led_cdev,\n\t\t\t\tenum led_brightness value)\n{\n\tlocomoled_brightness_set(led_cdev, value, LOCOMO_LPT0);\n}\n\nstatic void locomoled_brightness_set1(struct led_classdev *led_cdev,\n\t\t\t\tenum led_brightness value)\n{\n\tlocomoled_brightness_set(led_cdev, value, LOCOMO_LPT1);\n}\n\nstatic struct led_classdev locomo_led0 = {\n\t.name\t\t\t= \"locomo:amber:charge\",\n\t.default_trigger\t= \"main-battery-charging\",\n\t.brightness_set\t\t= locomoled_brightness_set0,\n};\n\nstatic struct led_classdev locomo_led1 = {\n\t.name\t\t\t= \"locomo:green:mail\",\n\t.default_trigger\t= \"nand-disk\",\n\t.brightness_set\t\t= locomoled_brightness_set1,\n};\n\nstatic int locomoled_probe(struct locomo_dev *ldev)\n{\n\tint ret;\n\n\tret = devm_led_classdev_register(&ldev->dev, &locomo_led0);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn  devm_led_classdev_register(&ldev->dev, &locomo_led1);\n}\n\n\nstatic struct locomo_driver locomoled_driver = {\n\t.drv = {\n\t\t.name = \"locomoled\"\n\t},\n\t.devid\t= LOCOMO_DEVID_LED,\n\t.probe\t= locomoled_probe,\n};\n\nstatic int __init locomoled_init(void)\n{\n\treturn locomo_driver_register(&locomoled_driver);\n}\nmodule_init(locomoled_init);\n\nMODULE_AUTHOR(\"John Lenz <lenz@cs.wisc.edu>\");\nMODULE_DESCRIPTION(\"Locomo LED driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}