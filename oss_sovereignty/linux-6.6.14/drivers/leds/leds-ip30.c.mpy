{
  "module_name": "leds-ip30.c",
  "hash_id": "e18374c7dc96eb3d4c1fe64003715765af3aaca64efb2cf97e5f99499ca8cfbb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/leds/leds-ip30.c",
  "human_readable_source": "\n \n\n#include <asm/io.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/platform_device.h>\n#include <linux/leds.h>\n\n#define IP30_LED_SYSTEM\t0\n#define IP30_LED_FAULT\t1\n\nstruct ip30_led {\n\tstruct led_classdev cdev;\n\tu32 __iomem *reg;\n};\n\nstatic void ip30led_set(struct led_classdev *led_cdev,\n\t\t\tenum led_brightness value)\n{\n\tstruct ip30_led *led = container_of(led_cdev, struct ip30_led, cdev);\n\n\twritel(value, led->reg);\n}\n\nstatic int ip30led_create(struct platform_device *pdev, int num)\n{\n\tstruct ip30_led *data;\n\n\tdata = devm_kzalloc(&pdev->dev, sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\treturn -ENOMEM;\n\n\tdata->reg = devm_platform_ioremap_resource(pdev, num);\n\tif (IS_ERR(data->reg))\n\t\treturn PTR_ERR(data->reg);\n\n\tswitch (num) {\n\tcase IP30_LED_SYSTEM:\n\t\tdata->cdev.name = \"white:power\";\n\t\tbreak;\n\tcase IP30_LED_FAULT:\n\t\tdata->cdev.name = \"red:fault\";\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tdata->cdev.brightness = readl(data->reg);\n\tdata->cdev.max_brightness = 1;\n\tdata->cdev.brightness_set = ip30led_set;\n\n\treturn devm_led_classdev_register(&pdev->dev, &data->cdev);\n}\n\nstatic int ip30led_probe(struct platform_device *pdev)\n{\n\tint ret;\n\n\tret = ip30led_create(pdev, IP30_LED_SYSTEM);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn ip30led_create(pdev, IP30_LED_FAULT);\n}\n\nstatic struct platform_driver ip30led_driver = {\n\t.probe\t\t= ip30led_probe,\n\t.driver\t\t= {\n\t\t.name\t\t= \"ip30-leds\",\n\t},\n};\n\nmodule_platform_driver(ip30led_driver);\n\nMODULE_AUTHOR(\"Thomas Bogendoerfer <tbogendoerfer@suse.de>\");\nMODULE_DESCRIPTION(\"SGI Octane LED driver\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"platform:ip30-leds\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}