{
  "module_name": "leds-wrap.c",
  "hash_id": "14a207bcd471e4832dc402268c87778d804fee6390878100446f191b35a153d0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/leds/leds-wrap.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/leds.h>\n#include <linux/err.h>\n#include <linux/io.h>\n#include <linux/scx200_gpio.h>\n#include <linux/module.h>\n\n#define DRVNAME \"wrap-led\"\n#define WRAP_POWER_LED_GPIO\t2\n#define WRAP_ERROR_LED_GPIO\t3\n#define WRAP_EXTRA_LED_GPIO\t18\n\nstatic struct platform_device *pdev;\n\nstatic void wrap_power_led_set(struct led_classdev *led_cdev,\n\t\tenum led_brightness value)\n{\n\tif (value)\n\t\tscx200_gpio_set_low(WRAP_POWER_LED_GPIO);\n\telse\n\t\tscx200_gpio_set_high(WRAP_POWER_LED_GPIO);\n}\n\nstatic void wrap_error_led_set(struct led_classdev *led_cdev,\n\t\tenum led_brightness value)\n{\n\tif (value)\n\t\tscx200_gpio_set_low(WRAP_ERROR_LED_GPIO);\n\telse\n\t\tscx200_gpio_set_high(WRAP_ERROR_LED_GPIO);\n}\n\nstatic void wrap_extra_led_set(struct led_classdev *led_cdev,\n\t\tenum led_brightness value)\n{\n\tif (value)\n\t\tscx200_gpio_set_low(WRAP_EXTRA_LED_GPIO);\n\telse\n\t\tscx200_gpio_set_high(WRAP_EXTRA_LED_GPIO);\n}\n\nstatic struct led_classdev wrap_power_led = {\n\t.name\t\t\t= \"wrap::power\",\n\t.brightness_set\t\t= wrap_power_led_set,\n\t.default_trigger\t= \"default-on\",\n\t.flags\t\t\t= LED_CORE_SUSPENDRESUME,\n};\n\nstatic struct led_classdev wrap_error_led = {\n\t.name\t\t= \"wrap::error\",\n\t.brightness_set\t= wrap_error_led_set,\n\t.flags\t\t\t= LED_CORE_SUSPENDRESUME,\n};\n\nstatic struct led_classdev wrap_extra_led = {\n\t.name           = \"wrap::extra\",\n\t.brightness_set = wrap_extra_led_set,\n\t.flags\t\t\t= LED_CORE_SUSPENDRESUME,\n};\n\nstatic int wrap_led_probe(struct platform_device *pdev)\n{\n\tint ret;\n\n\tret = devm_led_classdev_register(&pdev->dev, &wrap_power_led);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = devm_led_classdev_register(&pdev->dev, &wrap_error_led);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn  devm_led_classdev_register(&pdev->dev, &wrap_extra_led);\n}\n\nstatic struct platform_driver wrap_led_driver = {\n\t.probe\t\t= wrap_led_probe,\n\t.driver\t\t= {\n\t\t.name\t\t= DRVNAME,\n\t},\n};\n\nstatic int __init wrap_led_init(void)\n{\n\tint ret;\n\n\tif (!scx200_gpio_present()) {\n\t\tret = -ENODEV;\n\t\tgoto out;\n\t}\n\n\tret = platform_driver_register(&wrap_led_driver);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tpdev = platform_device_register_simple(DRVNAME, -1, NULL, 0);\n\tif (IS_ERR(pdev)) {\n\t\tret = PTR_ERR(pdev);\n\t\tplatform_driver_unregister(&wrap_led_driver);\n\t\tgoto out;\n\t}\n\nout:\n\treturn ret;\n}\n\nstatic void __exit wrap_led_exit(void)\n{\n\tplatform_device_unregister(pdev);\n\tplatform_driver_unregister(&wrap_led_driver);\n}\n\nmodule_init(wrap_led_init);\nmodule_exit(wrap_led_exit);\n\nMODULE_AUTHOR(\"Kristian Kielhofner <kris@krisk.org>\");\nMODULE_DESCRIPTION(\"PCEngines WRAP LED driver\");\nMODULE_LICENSE(\"GPL\");\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}