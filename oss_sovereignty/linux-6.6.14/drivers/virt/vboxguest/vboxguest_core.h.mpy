{
  "module_name": "vboxguest_core.h",
  "hash_id": "c2e6fa136a31d7c63bfef411f94e39b7384409ba7a5ed102899f99497e8dd424",
  "original_prompt": "Ingested from linux-6.6.14/drivers/virt/vboxguest/vboxguest_core.h",
  "human_readable_source": " \n \n\n#ifndef __VBOXGUEST_CORE_H__\n#define __VBOXGUEST_CORE_H__\n\n#include <linux/input.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/list.h>\n#include <linux/miscdevice.h>\n#include <linux/spinlock.h>\n#include <linux/wait.h>\n#include <linux/workqueue.h>\n#include <linux/vboxguest.h>\n#include \"vmmdev.h\"\n\n \n#define VBG_IOCTL_VMMDEV_REQUEST_BIG_ALT _IOC(_IOC_READ | _IOC_WRITE, 'V', 3, 0)\n#define VBG_IOCTL_LOG_ALT(s)             _IOC(_IOC_READ | _IOC_WRITE, 'V', 9, s)\n\nstruct vbg_session;\n\n \nstruct vbg_mem_balloon {\n\t \n\tstruct work_struct work;\n\t \n\tstruct vmmdev_memballoon_info *get_req;\n\t \n\tstruct vmmdev_memballoon_change *change_req;\n\t \n\tu32 chunks;\n\t \n\tu32 max_chunks;\n\t \n\tstruct page ***pages;\n};\n\n \nstruct vbg_bit_usage_tracker {\n\t \n\tu32 per_bit_usage[32];\n\t \n\tu32 mask;\n};\n\n \nstruct vbg_dev {\n\tstruct device *dev;\n\t \n\tu16 io_port;\n\t \n\tstruct vmmdev_memory *mmio;\n\t \n\tchar host_version[64];\n\t \n\tunsigned int host_features;\n\t \n\tstruct page *guest_mappings_dummy_page;\n\tvoid *guest_mappings;\n\t \n\tspinlock_t event_spinlock;\n\t \n\tstruct vmmdev_events *ack_events_req;\n\t \n\twait_queue_head_t event_wq;\n\t \n\tu32 pending_events;\n\t \n\twait_queue_head_t hgcm_wq;\n\t \n\tstruct vmmdev_hgcm_cancel2 *cancel_req;\n\t \n\tstruct mutex cancel_req_mutex;\n\t \n\tstruct vmmdev_mouse_status *mouse_status_req;\n\t \n\tstruct input_dev *input;\n\n\t \n\tstruct vbg_mem_balloon mem_balloon;\n\n\t \n\tstruct mutex session_mutex;\n\t \n\tu32 fixed_events;\n\t \n\tstruct vbg_bit_usage_tracker event_filter_tracker;\n\t \n\tu32 event_filter_host;\n\n\t \n\tu32 acquire_mode_guest_caps;\n\t \n\tu32 acquired_guest_caps;\n\t \n\tstruct vbg_bit_usage_tracker set_guest_caps_tracker;\n\t \n\tu32 guest_caps_host;\n\n\t \n\tstruct timer_list heartbeat_timer;\n\t \n\tint heartbeat_interval_ms;\n\t \n\tstruct vmmdev_request_header *guest_heartbeat_req;\n\n\t \n\tstruct miscdevice misc_device;\n\t \n\tstruct miscdevice misc_device_user;\n};\n\n \nstruct vbg_session {\n\t \n\tstruct vbg_dev *gdev;\n\n\t \n\tu32 hgcm_client_ids[64];\n\t \n\tu32 event_filter;\n\t \n\tu32 acquired_guest_caps;\n\t \n\tu32 set_guest_caps;\n\t \n\tu32 requestor;\n\t \n\tbool cancel_waiters;\n};\n\nint  vbg_core_init(struct vbg_dev *gdev, u32 fixed_events);\nvoid vbg_core_exit(struct vbg_dev *gdev);\nstruct vbg_session *vbg_core_open_session(struct vbg_dev *gdev, u32 requestor);\nvoid vbg_core_close_session(struct vbg_session *session);\nint  vbg_core_ioctl(struct vbg_session *session, unsigned int req, void *data);\nint  vbg_core_set_mouse_status(struct vbg_dev *gdev, u32 features);\n\nirqreturn_t vbg_core_isr(int irq, void *dev_id);\n\nvoid vbg_linux_mouse_event(struct vbg_dev *gdev);\n\n \nvoid *vbg_req_alloc(size_t len, enum vmmdev_request_type req_type,\n\t\t    u32 requestor);\nvoid vbg_req_free(void *req, size_t len);\nint vbg_req_perform(struct vbg_dev *gdev, void *req);\nint vbg_hgcm_call32(\n\tstruct vbg_dev *gdev, u32 requestor, u32 client_id, u32 function,\n\tu32 timeout_ms, struct vmmdev_hgcm_function_parameter32 *parm32,\n\tu32 parm_count, int *vbox_status);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}