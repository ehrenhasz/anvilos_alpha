{
  "module_name": "trace_mr.h",
  "hash_id": "3d1fd2f1b55299623b72665816c95d9bd91d66de8b76d07feece8653f1307fcb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/sw/rdmavt/trace_mr.h",
  "human_readable_source": " \n \n#if !defined(__RVT_TRACE_MR_H) || defined(TRACE_HEADER_MULTI_READ)\n#define __RVT_TRACE_MR_H\n\n#include <linux/tracepoint.h>\n#include <linux/trace_seq.h>\n\n#include <rdma/ib_verbs.h>\n#include <rdma/rdma_vt.h>\n#include <rdma/rdmavt_mr.h>\n\n#include \"mr.h\"\n\n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM rvt_mr\nDECLARE_EVENT_CLASS(\n\trvt_mr_template,\n\tTP_PROTO(struct rvt_mregion *mr, u16 m, u16 n, void *v, size_t len),\n\tTP_ARGS(mr, m, n, v, len),\n\tTP_STRUCT__entry(\n\t\tRDI_DEV_ENTRY(ib_to_rvt(mr->pd->device))\n\t\t__field(void *, vaddr)\n\t\t__field(struct page *, page)\n\t\t__field(u64, iova)\n\t\t__field(u64, user_base)\n\t\t__field(size_t, len)\n\t\t__field(size_t, length)\n\t\t__field(u32, lkey)\n\t\t__field(u32, offset)\n\t\t__field(u16, m)\n\t\t__field(u16, n)\n\t),\n\tTP_fast_assign(\n\t\tRDI_DEV_ASSIGN(ib_to_rvt(mr->pd->device));\n\t\t__entry->vaddr = v;\n\t\t__entry->page = virt_to_page(v);\n\t\t__entry->iova = mr->iova;\n\t\t__entry->user_base = mr->user_base;\n\t\t__entry->lkey = mr->lkey;\n\t\t__entry->m = m;\n\t\t__entry->n = n;\n\t\t__entry->len = len;\n\t\t__entry->length = mr->length;\n\t\t__entry->offset = mr->offset;\n\t),\n\tTP_printk(\n\t\t\"[%s] lkey %x iova %llx user_base %llx mr_len %lu vaddr %llx page %p m %u n %u len %lu off %u\",\n\t\t__get_str(dev),\n\t\t__entry->lkey,\n\t\t__entry->iova,\n\t\t__entry->user_base,\n\t\t__entry->length,\n\t\t(unsigned long long)__entry->vaddr,\n\t\t__entry->page,\n\t\t__entry->m,\n\t\t__entry->n,\n\t\t__entry->len,\n\t\t__entry->offset\n\t)\n);\n\nDEFINE_EVENT(\n\trvt_mr_template, rvt_mr_page_seg,\n\tTP_PROTO(struct rvt_mregion *mr, u16 m, u16 n, void *v, size_t len),\n\tTP_ARGS(mr, m, n, v, len));\n\nDEFINE_EVENT(\n\trvt_mr_template, rvt_mr_fmr_seg,\n\tTP_PROTO(struct rvt_mregion *mr, u16 m, u16 n, void *v, size_t len),\n\tTP_ARGS(mr, m, n, v, len));\n\nDEFINE_EVENT(\n\trvt_mr_template, rvt_mr_user_seg,\n\tTP_PROTO(struct rvt_mregion *mr, u16 m, u16 n, void *v, size_t len),\n\tTP_ARGS(mr, m, n, v, len));\n\nDECLARE_EVENT_CLASS(\n\trvt_sge_template,\n\tTP_PROTO(struct rvt_sge *sge, struct ib_sge *isge),\n\tTP_ARGS(sge, isge),\n\tTP_STRUCT__entry(\n\t\tRDI_DEV_ENTRY(ib_to_rvt(sge->mr->pd->device))\n\t\t__field(struct rvt_mregion *, mr)\n\t\t__field(struct rvt_sge *, sge)\n\t\t__field(struct ib_sge *, isge)\n\t\t__field(void *, vaddr)\n\t\t__field(u64, ivaddr)\n\t\t__field(u32, lkey)\n\t\t__field(u32, sge_length)\n\t\t__field(u32, length)\n\t\t__field(u32, ilength)\n\t\t__field(int, user)\n\t\t__field(u16, m)\n\t\t__field(u16, n)\n\t),\n\tTP_fast_assign(\n\t\tRDI_DEV_ASSIGN(ib_to_rvt(sge->mr->pd->device));\n\t\t__entry->mr = sge->mr;\n\t\t__entry->sge = sge;\n\t\t__entry->isge = isge;\n\t\t__entry->vaddr = sge->vaddr;\n\t\t__entry->ivaddr = isge->addr;\n\t\t__entry->lkey = sge->mr->lkey;\n\t\t__entry->sge_length = sge->sge_length;\n\t\t__entry->length = sge->length;\n\t\t__entry->ilength = isge->length;\n\t\t__entry->m = sge->m;\n\t\t__entry->n = sge->m;\n\t\t__entry->user = ibpd_to_rvtpd(sge->mr->pd)->user;\n\t),\n\tTP_printk(\n\t\t\"[%s] mr %p sge %p isge %p vaddr %p ivaddr %llx lkey %x sge_length %u length %u ilength %u m %u n %u user %u\",\n\t\t__get_str(dev),\n\t\t__entry->mr,\n\t\t__entry->sge,\n\t\t__entry->isge,\n\t\t__entry->vaddr,\n\t\t__entry->ivaddr,\n\t\t__entry->lkey,\n\t\t__entry->sge_length,\n\t\t__entry->length,\n\t\t__entry->ilength,\n\t\t__entry->m,\n\t\t__entry->n,\n\t\t__entry->user\n\t)\n);\n\nDEFINE_EVENT(\n\trvt_sge_template, rvt_sge_adjacent,\n\tTP_PROTO(struct rvt_sge *sge, struct ib_sge *isge),\n\tTP_ARGS(sge, isge));\n\nDEFINE_EVENT(\n\trvt_sge_template, rvt_sge_new,\n\tTP_PROTO(struct rvt_sge *sge, struct ib_sge *isge),\n\tTP_ARGS(sge, isge));\n\nTRACE_EVENT(\n\trvt_map_mr_sg,\n\tTP_PROTO(struct ib_mr *ibmr, int sg_nents, unsigned int *sg_offset),\n\tTP_ARGS(ibmr, sg_nents, sg_offset),\n\tTP_STRUCT__entry(\n\t\tRDI_DEV_ENTRY(ib_to_rvt(to_imr(ibmr)->mr.pd->device))\n\t\t__field(u64, iova)\n\t\t__field(u64, ibmr_iova)\n\t\t__field(u64, user_base)\n\t\t__field(u64, ibmr_length)\n\t\t__field(int, sg_nents)\n\t\t__field(uint, sg_offset)\n\t),\n\tTP_fast_assign(\n\t\tRDI_DEV_ASSIGN(ib_to_rvt(to_imr(ibmr)->mr.pd->device));\n\t\t__entry->ibmr_iova = ibmr->iova;\n\t\t__entry->iova = to_imr(ibmr)->mr.iova;\n\t\t__entry->user_base = to_imr(ibmr)->mr.user_base;\n\t\t__entry->ibmr_length = to_imr(ibmr)->mr.length;\n\t\t__entry->sg_nents = sg_nents;\n\t\t__entry->sg_offset = sg_offset ? *sg_offset : 0;\n\t),\n\tTP_printk(\n\t\t\"[%s] ibmr_iova %llx iova %llx user_base %llx length %llx sg_nents %d sg_offset %u\",\n\t\t__get_str(dev),\n\t\t__entry->ibmr_iova,\n\t\t__entry->iova,\n\t\t__entry->user_base,\n\t\t__entry->ibmr_length,\n\t\t__entry->sg_nents,\n\t\t__entry->sg_offset\n\t)\n);\n\n#endif  \n\n#undef TRACE_INCLUDE_PATH\n#undef TRACE_INCLUDE_FILE\n#define TRACE_INCLUDE_PATH .\n#define TRACE_INCLUDE_FILE trace_mr\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}