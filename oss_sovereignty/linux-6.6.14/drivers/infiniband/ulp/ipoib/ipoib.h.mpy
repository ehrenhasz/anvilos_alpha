{
  "module_name": "ipoib.h",
  "hash_id": "d840d3a059d3e854d6750064f9b662fc23e39c8d50e6c1ff0d22c4efa1678396",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/ulp/ipoib/ipoib.h",
  "human_readable_source": " \n\n#ifndef _IPOIB_H\n#define _IPOIB_H\n\n#include <linux/list.h>\n#include <linux/skbuff.h>\n#include <linux/netdevice.h>\n#include <linux/workqueue.h>\n#include <linux/kref.h>\n#include <linux/if_infiniband.h>\n#include <linux/mutex.h>\n\n#include <net/neighbour.h>\n#include <net/sch_generic.h>\n\n#include <linux/atomic.h>\n\n#include <rdma/ib_verbs.h>\n#include <rdma/ib_pack.h>\n#include <rdma/ib_sa.h>\n#include <linux/sched.h>\n \n\nenum ipoib_flush_level {\n\tIPOIB_FLUSH_LIGHT,\n\tIPOIB_FLUSH_NORMAL,\n\tIPOIB_FLUSH_HEAVY\n};\n\nenum {\n\tIPOIB_ENCAP_LEN\t\t  = 4,\n\tIPOIB_PSEUDO_LEN\t  = 20,\n\tIPOIB_HARD_LEN\t\t  = IPOIB_ENCAP_LEN + IPOIB_PSEUDO_LEN,\n\n\tIPOIB_UD_HEAD_SIZE\t  = IB_GRH_BYTES + IPOIB_ENCAP_LEN,\n\tIPOIB_UD_RX_SG\t\t  = 2,  \n\n\tIPOIB_CM_MTU\t\t  = 0x10000 - 0x10,  \n\tIPOIB_CM_BUF_SIZE\t  = IPOIB_CM_MTU  + IPOIB_ENCAP_LEN,\n\tIPOIB_CM_HEAD_SIZE\t  = IPOIB_CM_BUF_SIZE % PAGE_SIZE,\n\tIPOIB_CM_RX_SG\t\t  = ALIGN(IPOIB_CM_BUF_SIZE, PAGE_SIZE) / PAGE_SIZE,\n\tIPOIB_RX_RING_SIZE\t  = 256,\n\tIPOIB_TX_RING_SIZE\t  = 128,\n\tIPOIB_MAX_QUEUE_SIZE\t  = 8192,\n\tIPOIB_MIN_QUEUE_SIZE\t  = 2,\n\tIPOIB_CM_MAX_CONN_QP\t  = 4096,\n\n\tIPOIB_NUM_WC\t\t  = 4,\n\n\tIPOIB_MAX_PATH_REC_QUEUE  = 3,\n\tIPOIB_MAX_MCAST_QUEUE\t  = 64,\n\n\tIPOIB_FLAG_OPER_UP\t  = 0,\n\tIPOIB_FLAG_INITIALIZED\t  = 1,\n\tIPOIB_FLAG_ADMIN_UP\t  = 2,\n\tIPOIB_PKEY_ASSIGNED\t  = 3,\n\tIPOIB_FLAG_SUBINTERFACE\t  = 5,\n\tIPOIB_STOP_REAPER\t  = 7,\n\tIPOIB_FLAG_ADMIN_CM\t  = 9,\n\tIPOIB_FLAG_UMCAST\t  = 10,\n\tIPOIB_NEIGH_TBL_FLUSH\t  = 12,\n\tIPOIB_FLAG_DEV_ADDR_SET\t  = 13,\n\tIPOIB_FLAG_DEV_ADDR_CTRL  = 14,\n\n\tIPOIB_MAX_BACKOFF_SECONDS = 16,\n\n\tIPOIB_MCAST_FLAG_FOUND\t  = 0,\t \n\tIPOIB_MCAST_FLAG_SENDONLY = 1,\n\t \n\tIPOIB_MCAST_FLAG_BUSY\t  = 2,\n\tIPOIB_MCAST_FLAG_ATTACHED = 3,\n\n\tMAX_SEND_CQE\t\t  = 64,\n\tIPOIB_CM_COPYBREAK\t  = 256,\n\n\tIPOIB_NON_CHILD\t\t  = 0,\n\tIPOIB_LEGACY_CHILD\t  = 1,\n\tIPOIB_RTNL_CHILD\t  = 2,\n};\n\n#define\tIPOIB_OP_RECV   (1ul << 31)\n#ifdef CONFIG_INFINIBAND_IPOIB_CM\n#define\tIPOIB_OP_CM     (1ul << 30)\n#else\n#define\tIPOIB_OP_CM     (0)\n#endif\n\n#define IPOIB_QPN_MASK ((__force u32) cpu_to_be32(0xFFFFFF))\n\n \n\nstruct ipoib_header {\n\t__be16\tproto;\n\tu16\treserved;\n};\n\nstruct ipoib_pseudo_header {\n\tu8\thwaddr[INFINIBAND_ALEN];\n};\n\nstatic inline void skb_add_pseudo_hdr(struct sk_buff *skb)\n{\n\tchar *data = skb_push(skb, IPOIB_PSEUDO_LEN);\n\n\t \n\tmemset(data, 0, IPOIB_PSEUDO_LEN);\n\tskb_reset_mac_header(skb);\n\tskb_pull(skb, IPOIB_HARD_LEN);\n}\n\nstatic inline struct ipoib_dev_priv *ipoib_priv(const struct net_device *dev)\n{\n\tstruct rdma_netdev *rn = netdev_priv(dev);\n\n\treturn rn->clnt_priv;\n}\n\n \nstruct ipoib_mcast {\n\tstruct ib_sa_mcmember_rec mcmember;\n\tstruct ib_sa_multicast\t *mc;\n\tstruct ipoib_ah\t\t *ah;\n\n\tstruct rb_node    rb_node;\n\tstruct list_head  list;\n\n\tunsigned long created;\n\tunsigned long backoff;\n\tunsigned long delay_until;\n\n\tunsigned long flags;\n\tunsigned char logcount;\n\n\tstruct list_head  neigh_list;\n\n\tstruct sk_buff_head pkt_queue;\n\n\tstruct net_device *dev;\n\tstruct completion done;\n};\n\nstruct ipoib_rx_buf {\n\tstruct sk_buff *skb;\n\tu64\t\tmapping[IPOIB_UD_RX_SG];\n};\n\nstruct ipoib_tx_buf {\n\tstruct sk_buff *skb;\n\tu64\t\tmapping[MAX_SKB_FRAGS + 1];\n};\n\nstruct ib_cm_id;\n\nstruct ipoib_cm_data {\n\t__be32 qpn;  \n\t__be32 mtu;\n};\n\n \n\nenum ipoib_cm_state {\n\tIPOIB_CM_RX_LIVE,\n\tIPOIB_CM_RX_ERROR,  \n\tIPOIB_CM_RX_FLUSH   \n};\n\nstruct ipoib_cm_rx {\n\tstruct ib_cm_id\t       *id;\n\tstruct ib_qp\t       *qp;\n\tstruct ipoib_cm_rx_buf *rx_ring;\n\tstruct list_head\tlist;\n\tstruct net_device      *dev;\n\tunsigned long\t\tjiffies;\n\tenum ipoib_cm_state\tstate;\n\tint\t\t\trecv_count;\n};\n\nstruct ipoib_cm_tx {\n\tstruct ib_cm_id\t    *id;\n\tstruct ib_qp\t    *qp;\n\tstruct list_head     list;\n\tstruct net_device   *dev;\n\tstruct ipoib_neigh  *neigh;\n\tstruct ipoib_tx_buf *tx_ring;\n\tunsigned int\t     tx_head;\n\tunsigned int\t     tx_tail;\n\tunsigned long\t     flags;\n\tu32\t\t     mtu;\n\tunsigned int         max_send_sge;\n};\n\nstruct ipoib_cm_rx_buf {\n\tstruct sk_buff *skb;\n\tu64 mapping[IPOIB_CM_RX_SG];\n};\n\nstruct ipoib_cm_dev_priv {\n\tstruct ib_srq\t       *srq;\n\tstruct ipoib_cm_rx_buf *srq_ring;\n\tstruct ib_cm_id\t       *id;\n\tstruct list_head\tpassive_ids;    \n\tstruct list_head\trx_error_list;  \n\tstruct list_head\trx_flush_list;  \n\tstruct list_head\trx_drain_list;  \n\tstruct list_head\trx_reap_list;   \n\tstruct work_struct      start_task;\n\tstruct work_struct      reap_task;\n\tstruct work_struct      skb_task;\n\tstruct work_struct      rx_reap_task;\n\tstruct delayed_work     stale_task;\n\tstruct sk_buff_head     skb_queue;\n\tstruct list_head\tstart_list;\n\tstruct list_head\treap_list;\n\tstruct ib_wc\t\tibwc[IPOIB_NUM_WC];\n\tstruct ib_sge\t\trx_sge[IPOIB_CM_RX_SG];\n\tstruct ib_recv_wr       rx_wr;\n\tint\t\t\tnonsrq_conn_qp;\n\tint\t\t\tmax_cm_mtu;\n\tint\t\t\tnum_frags;\n};\n\nstruct ipoib_ethtool_st {\n\tu16     coalesce_usecs;\n\tu16     max_coalesced_frames;\n};\n\nstruct ipoib_neigh_table;\n\nstruct ipoib_neigh_hash {\n\tstruct ipoib_neigh_table       *ntbl;\n\tstruct ipoib_neigh __rcu      **buckets;\n\tstruct rcu_head\t\t\trcu;\n\tu32\t\t\t\tmask;\n\tu32\t\t\t\tsize;\n};\n\nstruct ipoib_neigh_table {\n\tstruct ipoib_neigh_hash __rcu  *htbl;\n\tatomic_t\t\t\tentries;\n\tstruct completion\t\tflushed;\n\tstruct completion\t\tdeleted;\n};\n\nstruct ipoib_qp_state_validate {\n\tstruct work_struct work;\n\tstruct ipoib_dev_priv   *priv;\n};\n\n \nstruct ipoib_dev_priv {\n\tspinlock_t lock;\n\n\tstruct net_device *dev;\n\tvoid (*next_priv_destructor)(struct net_device *dev);\n\n\tstruct napi_struct send_napi;\n\tstruct napi_struct recv_napi;\n\n\tunsigned long flags;\n\n\t \n\tstruct rw_semaphore vlan_rwsem;\n\tstruct mutex mcast_mutex;\n\n\tstruct rb_root  path_tree;\n\tstruct list_head path_list;\n\n\tstruct ipoib_neigh_table ntbl;\n\n\tstruct ipoib_mcast *broadcast;\n\tstruct list_head multicast_list;\n\tstruct rb_root multicast_tree;\n\n\tstruct workqueue_struct *wq;\n\tstruct delayed_work mcast_task;\n\tstruct work_struct carrier_on_task;\n\tstruct work_struct flush_light;\n\tstruct work_struct flush_normal;\n\tstruct work_struct flush_heavy;\n\tstruct work_struct restart_task;\n\tstruct delayed_work ah_reap_task;\n\tstruct delayed_work neigh_reap_task;\n\tstruct ib_device *ca;\n\tu8\t\t  port;\n\tu16\t\t  pkey;\n\tu16\t\t  pkey_index;\n\tstruct ib_pd\t *pd;\n\tstruct ib_cq\t *recv_cq;\n\tstruct ib_cq\t *send_cq;\n\tstruct ib_qp\t *qp;\n\tu32\t\t  qkey;\n\n\tunion ib_gid local_gid;\n\tu32\t     local_lid;\n\n\tunsigned int admin_mtu;\n\tunsigned int mcast_mtu;\n\tunsigned int max_ib_mtu;\n\n\tstruct ipoib_rx_buf *rx_ring;\n\n\tstruct ipoib_tx_buf *tx_ring;\n\t \n\tunsigned int\t     tx_head;\n\tunsigned int\t     tx_tail;\n\t \n\tunsigned int\t     global_tx_head;\n\tunsigned int\t     global_tx_tail;\n\tstruct ib_sge\t     tx_sge[MAX_SKB_FRAGS + 1];\n\tstruct ib_ud_wr      tx_wr;\n\tstruct ib_wc\t     send_wc[MAX_SEND_CQE];\n\n\tstruct ib_recv_wr    rx_wr;\n\tstruct ib_sge\t     rx_sge[IPOIB_UD_RX_SG];\n\n\tstruct ib_wc ibwc[IPOIB_NUM_WC];\n\n\tstruct list_head dead_ahs;\n\n\tstruct ib_event_handler event_handler;\n\n\tstruct net_device *parent;\n\tstruct list_head child_intfs;\n\tstruct list_head list;\n\tint    child_type;\n\n#ifdef CONFIG_INFINIBAND_IPOIB_CM\n\tstruct ipoib_cm_dev_priv cm;\n#endif\n\n#ifdef CONFIG_INFINIBAND_IPOIB_DEBUG\n\tstruct list_head fs_list;\n\tstruct dentry *mcg_dentry;\n\tstruct dentry *path_dentry;\n#endif\n\tu64\thca_caps;\n\tu64\tkernel_caps;\n\tstruct ipoib_ethtool_st ethtool;\n\tunsigned int max_send_sge;\n\tconst struct net_device_ops\t*rn_ops;\n};\n\nstruct ipoib_ah {\n\tstruct net_device *dev;\n\tstruct ib_ah\t  *ah;\n\tstruct list_head   list;\n\tstruct kref\t   ref;\n\tunsigned int\t   last_send;\n\tint  \t\t   valid;\n};\n\nstruct ipoib_path {\n\tstruct net_device    *dev;\n\tstruct sa_path_rec pathrec;\n\tstruct ipoib_ah      *ah;\n\tstruct sk_buff_head   queue;\n\n\tstruct list_head      neigh_list;\n\n\tint\t\t      query_id;\n\tstruct ib_sa_query   *query;\n\tstruct completion     done;\n\n\tstruct rb_node\t      rb_node;\n\tstruct list_head      list;\n};\n\nstruct ipoib_neigh {\n\tstruct ipoib_ah    *ah;\n#ifdef CONFIG_INFINIBAND_IPOIB_CM\n\tstruct ipoib_cm_tx *cm;\n#endif\n\tu8     daddr[INFINIBAND_ALEN];\n\tstruct sk_buff_head queue;\n\n\tstruct net_device *dev;\n\n\tstruct list_head    list;\n\tstruct ipoib_neigh __rcu *hnext;\n\tstruct rcu_head     rcu;\n\trefcount_t\t    refcnt;\n\tunsigned long       alive;\n};\n\n#define IPOIB_UD_MTU(ib_mtu)\t\t(ib_mtu - IPOIB_ENCAP_LEN)\n#define IPOIB_UD_BUF_SIZE(ib_mtu)\t(ib_mtu + IB_GRH_BYTES)\n\nvoid ipoib_neigh_dtor(struct ipoib_neigh *neigh);\nstatic inline void ipoib_neigh_put(struct ipoib_neigh *neigh)\n{\n\tif (refcount_dec_and_test(&neigh->refcnt))\n\t\tipoib_neigh_dtor(neigh);\n}\nstruct ipoib_neigh *ipoib_neigh_get(struct net_device *dev, u8 *daddr);\nstruct ipoib_neigh *ipoib_neigh_alloc(u8 *daddr,\n\t\t\t\t      struct net_device *dev);\nvoid ipoib_neigh_free(struct ipoib_neigh *neigh);\nvoid ipoib_del_neighs_by_gid(struct net_device *dev, u8 *gid);\n\nextern struct workqueue_struct *ipoib_workqueue;\n\n \n\nint ipoib_rx_poll(struct napi_struct *napi, int budget);\nint ipoib_tx_poll(struct napi_struct *napi, int budget);\nvoid ipoib_ib_rx_completion(struct ib_cq *cq, void *ctx_ptr);\nvoid ipoib_ib_tx_completion(struct ib_cq *cq, void *ctx_ptr);\n\nstruct ipoib_ah *ipoib_create_ah(struct net_device *dev,\n\t\t\t\t struct ib_pd *pd, struct rdma_ah_attr *attr);\nvoid ipoib_free_ah(struct kref *kref);\nstatic inline void ipoib_put_ah(struct ipoib_ah *ah)\n{\n\tkref_put(&ah->ref, ipoib_free_ah);\n}\nint ipoib_open(struct net_device *dev);\nvoid ipoib_intf_free(struct net_device *dev);\nint ipoib_add_pkey_attr(struct net_device *dev);\nint ipoib_add_umcast_attr(struct net_device *dev);\n\nint ipoib_send(struct net_device *dev, struct sk_buff *skb,\n\t       struct ib_ah *address, u32 dqpn);\nvoid ipoib_reap_ah(struct work_struct *work);\n\nstruct ipoib_path *__path_find(struct net_device *dev, void *gid);\nvoid ipoib_mark_paths_invalid(struct net_device *dev);\nvoid ipoib_flush_paths(struct net_device *dev);\nstruct net_device *ipoib_intf_alloc(struct ib_device *hca, u32 port,\n\t\t\t\t    const char *format);\nint ipoib_intf_init(struct ib_device *hca, u32 port, const char *format,\n\t\t    struct net_device *dev);\nvoid ipoib_ib_tx_timer_func(struct timer_list *t);\nvoid ipoib_ib_dev_flush_light(struct work_struct *work);\nvoid ipoib_ib_dev_flush_normal(struct work_struct *work);\nvoid ipoib_ib_dev_flush_heavy(struct work_struct *work);\nvoid ipoib_pkey_event(struct work_struct *work);\nvoid ipoib_ib_dev_cleanup(struct net_device *dev);\n\nint ipoib_ib_dev_open_default(struct net_device *dev);\nint ipoib_ib_dev_open(struct net_device *dev);\nvoid ipoib_ib_dev_stop(struct net_device *dev);\nvoid ipoib_ib_dev_up(struct net_device *dev);\nvoid ipoib_ib_dev_down(struct net_device *dev);\nint ipoib_ib_dev_stop_default(struct net_device *dev);\nvoid ipoib_pkey_dev_check_presence(struct net_device *dev);\n\nvoid ipoib_mcast_join_task(struct work_struct *work);\nvoid ipoib_mcast_carrier_on_task(struct work_struct *work);\nvoid ipoib_mcast_send(struct net_device *dev, u8 *daddr, struct sk_buff *skb);\n\nvoid ipoib_mcast_restart_task(struct work_struct *work);\nvoid ipoib_mcast_start_thread(struct net_device *dev);\nvoid ipoib_mcast_stop_thread(struct net_device *dev);\n\nvoid ipoib_mcast_dev_down(struct net_device *dev);\nvoid ipoib_mcast_dev_flush(struct net_device *dev);\n\nint ipoib_dma_map_tx(struct ib_device *ca, struct ipoib_tx_buf *tx_req);\nvoid ipoib_dma_unmap_tx(struct ipoib_dev_priv *priv,\n\t\t\tstruct ipoib_tx_buf *tx_req);\n\nstruct rtnl_link_ops *ipoib_get_link_ops(void);\n\nstatic inline void ipoib_build_sge(struct ipoib_dev_priv *priv,\n\t\t\t\t   struct ipoib_tx_buf *tx_req)\n{\n\tint i, off;\n\tstruct sk_buff *skb = tx_req->skb;\n\tskb_frag_t *frags = skb_shinfo(skb)->frags;\n\tint nr_frags = skb_shinfo(skb)->nr_frags;\n\tu64 *mapping = tx_req->mapping;\n\n\tif (skb_headlen(skb)) {\n\t\tpriv->tx_sge[0].addr         = mapping[0];\n\t\tpriv->tx_sge[0].length       = skb_headlen(skb);\n\t\toff = 1;\n\t} else\n\t\toff = 0;\n\n\tfor (i = 0; i < nr_frags; ++i) {\n\t\tpriv->tx_sge[i + off].addr = mapping[i + off];\n\t\tpriv->tx_sge[i + off].length = skb_frag_size(&frags[i]);\n\t}\n\tpriv->tx_wr.wr.num_sge\t     = nr_frags + off;\n}\n\n#ifdef CONFIG_INFINIBAND_IPOIB_DEBUG\nstruct ipoib_mcast_iter *ipoib_mcast_iter_init(struct net_device *dev);\nint ipoib_mcast_iter_next(struct ipoib_mcast_iter *iter);\nvoid ipoib_mcast_iter_read(struct ipoib_mcast_iter *iter,\n\t\t\t\t  union ib_gid *gid,\n\t\t\t\t  unsigned long *created,\n\t\t\t\t  unsigned int *queuelen,\n\t\t\t\t  unsigned int *complete,\n\t\t\t\t  unsigned int *send_only);\n\nstruct ipoib_path_iter *ipoib_path_iter_init(struct net_device *dev);\nint ipoib_path_iter_next(struct ipoib_path_iter *iter);\nvoid ipoib_path_iter_read(struct ipoib_path_iter *iter,\n\t\t\t  struct ipoib_path *path);\n#endif\n\nint ipoib_mcast_attach(struct net_device *dev, struct ib_device *hca,\n\t\t       union ib_gid *mgid, u16 mlid, int set_qkey, u32 qkey);\nint ipoib_mcast_detach(struct net_device *dev, struct ib_device *hca,\n\t\t       union ib_gid *mgid, u16 mlid);\nvoid ipoib_mcast_remove_list(struct list_head *remove_list);\nvoid ipoib_check_and_add_mcast_sendonly(struct ipoib_dev_priv *priv, u8 *mgid,\n\t\t\t\tstruct list_head *remove_list);\n\nint ipoib_init_qp(struct net_device *dev);\nint ipoib_transport_dev_init(struct net_device *dev, struct ib_device *ca);\nvoid ipoib_transport_dev_cleanup(struct net_device *dev);\n\nvoid ipoib_event(struct ib_event_handler *handler,\n\t\t struct ib_event *record);\n\nint ipoib_vlan_add(struct net_device *pdev, unsigned short pkey);\nint ipoib_vlan_delete(struct net_device *pdev, unsigned short pkey);\n\nint __ipoib_vlan_add(struct ipoib_dev_priv *ppriv, struct ipoib_dev_priv *priv,\n\t\t     u16 pkey, int child_type);\n\nint  __init ipoib_netlink_init(void);\nvoid __exit ipoib_netlink_fini(void);\n\nvoid ipoib_set_umcast(struct net_device *ndev, int umcast_val);\nint  ipoib_set_mode(struct net_device *dev, const char *buf);\n\nvoid ipoib_setup_common(struct net_device *dev);\n\nvoid ipoib_pkey_open(struct ipoib_dev_priv *priv);\nvoid ipoib_drain_cq(struct net_device *dev);\n\nvoid ipoib_set_ethtool_ops(struct net_device *dev);\n\n#define IPOIB_FLAGS_RC\t\t0x80\n#define IPOIB_FLAGS_UC\t\t0x40\n\n \n#define IPOIB_CM_SUPPORTED(ha)   (ha[0] & (IPOIB_FLAGS_RC))\n\n#ifdef CONFIG_INFINIBAND_IPOIB_CM\n\nextern int ipoib_max_conn_qp;\n\nstatic inline int ipoib_cm_admin_enabled(struct net_device *dev)\n{\n\tstruct ipoib_dev_priv *priv = ipoib_priv(dev);\n\treturn IPOIB_CM_SUPPORTED(dev->dev_addr) &&\n\t\ttest_bit(IPOIB_FLAG_ADMIN_CM, &priv->flags);\n}\n\nstatic inline int ipoib_cm_enabled(struct net_device *dev, u8 *hwaddr)\n{\n\tstruct ipoib_dev_priv *priv = ipoib_priv(dev);\n\treturn IPOIB_CM_SUPPORTED(hwaddr) &&\n\t\ttest_bit(IPOIB_FLAG_ADMIN_CM, &priv->flags);\n}\n\nstatic inline int ipoib_cm_up(struct ipoib_neigh *neigh)\n\n{\n\treturn test_bit(IPOIB_FLAG_OPER_UP, &neigh->cm->flags);\n}\n\nstatic inline struct ipoib_cm_tx *ipoib_cm_get(struct ipoib_neigh *neigh)\n{\n\treturn neigh->cm;\n}\n\nstatic inline void ipoib_cm_set(struct ipoib_neigh *neigh, struct ipoib_cm_tx *tx)\n{\n\tneigh->cm = tx;\n}\n\nstatic inline int ipoib_cm_has_srq(struct net_device *dev)\n{\n\tstruct ipoib_dev_priv *priv = ipoib_priv(dev);\n\treturn !!priv->cm.srq;\n}\n\nstatic inline unsigned int ipoib_cm_max_mtu(struct net_device *dev)\n{\n\tstruct ipoib_dev_priv *priv = ipoib_priv(dev);\n\treturn priv->cm.max_cm_mtu;\n}\n\nvoid ipoib_cm_send(struct net_device *dev, struct sk_buff *skb, struct ipoib_cm_tx *tx);\nint ipoib_cm_dev_open(struct net_device *dev);\nvoid ipoib_cm_dev_stop(struct net_device *dev);\nint ipoib_cm_dev_init(struct net_device *dev);\nint ipoib_cm_add_mode_attr(struct net_device *dev);\nvoid ipoib_cm_dev_cleanup(struct net_device *dev);\nstruct ipoib_cm_tx *ipoib_cm_create_tx(struct net_device *dev, struct ipoib_path *path,\n\t\t\t\t    struct ipoib_neigh *neigh);\nvoid ipoib_cm_destroy_tx(struct ipoib_cm_tx *tx);\nvoid ipoib_cm_skb_too_long(struct net_device *dev, struct sk_buff *skb,\n\t\t\t   unsigned int mtu);\nvoid ipoib_cm_handle_rx_wc(struct net_device *dev, struct ib_wc *wc);\nvoid ipoib_cm_handle_tx_wc(struct net_device *dev, struct ib_wc *wc);\n#else\n\n#define ipoib_max_conn_qp 0\n\nstatic inline int ipoib_cm_admin_enabled(struct net_device *dev)\n{\n\treturn 0;\n}\nstatic inline int ipoib_cm_enabled(struct net_device *dev, u8 *hwaddr)\n\n{\n\treturn 0;\n}\n\nstatic inline int ipoib_cm_up(struct ipoib_neigh *neigh)\n\n{\n\treturn 0;\n}\n\nstatic inline struct ipoib_cm_tx *ipoib_cm_get(struct ipoib_neigh *neigh)\n{\n\treturn NULL;\n}\n\nstatic inline void ipoib_cm_set(struct ipoib_neigh *neigh, struct ipoib_cm_tx *tx)\n{\n}\n\nstatic inline int ipoib_cm_has_srq(struct net_device *dev)\n{\n\treturn 0;\n}\n\nstatic inline unsigned int ipoib_cm_max_mtu(struct net_device *dev)\n{\n\treturn 0;\n}\n\nstatic inline\nvoid ipoib_cm_send(struct net_device *dev, struct sk_buff *skb, struct ipoib_cm_tx *tx)\n{\n\treturn;\n}\n\nstatic inline\nint ipoib_cm_dev_open(struct net_device *dev)\n{\n\treturn 0;\n}\n\nstatic inline\nvoid ipoib_cm_dev_stop(struct net_device *dev)\n{\n\treturn;\n}\n\nstatic inline\nint ipoib_cm_dev_init(struct net_device *dev)\n{\n\treturn -EOPNOTSUPP;\n}\n\nstatic inline\nvoid ipoib_cm_dev_cleanup(struct net_device *dev)\n{\n\treturn;\n}\n\nstatic inline\nstruct ipoib_cm_tx *ipoib_cm_create_tx(struct net_device *dev, struct ipoib_path *path,\n\t\t\t\t    struct ipoib_neigh *neigh)\n{\n\treturn NULL;\n}\n\nstatic inline\nvoid ipoib_cm_destroy_tx(struct ipoib_cm_tx *tx)\n{\n\treturn;\n}\n\nstatic inline\nint ipoib_cm_add_mode_attr(struct net_device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void ipoib_cm_skb_too_long(struct net_device *dev, struct sk_buff *skb,\n\t\t\t\t\t unsigned int mtu)\n{\n\tdev_kfree_skb_any(skb);\n}\n\nstatic inline void ipoib_cm_handle_rx_wc(struct net_device *dev, struct ib_wc *wc)\n{\n}\n\nstatic inline void ipoib_cm_handle_tx_wc(struct net_device *dev, struct ib_wc *wc)\n{\n}\n#endif\n\n#ifdef CONFIG_INFINIBAND_IPOIB_DEBUG\nvoid ipoib_create_debug_files(struct net_device *dev);\nvoid ipoib_delete_debug_files(struct net_device *dev);\nvoid ipoib_register_debugfs(void);\nvoid ipoib_unregister_debugfs(void);\n#else\nstatic inline void ipoib_create_debug_files(struct net_device *dev) { }\nstatic inline void ipoib_delete_debug_files(struct net_device *dev) { }\nstatic inline void ipoib_register_debugfs(void) { }\nstatic inline void ipoib_unregister_debugfs(void) { }\n#endif\n\n#define ipoib_printk(level, priv, format, arg...)\t\\\n\tprintk(level \"%s: \" format, ((struct ipoib_dev_priv *) priv)->dev->name , ## arg)\n#define ipoib_warn(priv, format, arg...)\t\t\\\ndo {\t\t\t\t\t\t\t\\\n\tstatic DEFINE_RATELIMIT_STATE(_rs,\t\t\\\n\t\t10 * HZ  ,\t\t\\\n\t\t100);\t\t\\\n\tif (__ratelimit(&_rs))\t\t\t\t\\\n\t\tipoib_printk(KERN_WARNING, priv, format , ## arg);\\\n} while (0)\n\nextern int ipoib_sendq_size;\nextern int ipoib_recvq_size;\n\nextern struct ib_sa_client ipoib_sa_client;\n\n#ifdef CONFIG_INFINIBAND_IPOIB_DEBUG\nextern int ipoib_debug_level;\n\n#define ipoib_dbg(priv, format, arg...)\t\t\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\tif (ipoib_debug_level > 0)\t\t\t\\\n\t\t\tipoib_printk(KERN_DEBUG, priv, format , ## arg); \\\n\t} while (0)\n#define ipoib_dbg_mcast(priv, format, arg...)\t\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\tif (mcast_debug_level > 0)\t\t\\\n\t\t\tipoib_printk(KERN_DEBUG, priv, format , ## arg); \\\n\t} while (0)\n#else  \n#define ipoib_dbg(priv, format, arg...)\t\t\t\\\n\tdo { (void) (priv); } while (0)\n#define ipoib_dbg_mcast(priv, format, arg...)\t\t\\\n\tdo { (void) (priv); } while (0)\n#endif  \n\n#ifdef CONFIG_INFINIBAND_IPOIB_DEBUG_DATA\n#define ipoib_dbg_data(priv, format, arg...)\t\t\\\n\tdo {\t\t\t\t\t\t\\\n\t\tif (data_debug_level > 0)\t\t\\\n\t\t\tipoib_printk(KERN_DEBUG, priv, format , ## arg); \\\n\t} while (0)\n#else  \n#define ipoib_dbg_data(priv, format, arg...)\t\t\\\n\tdo { (void) (priv); } while (0)\n#endif  \n\n#define IPOIB_QPN(ha) (be32_to_cpup((__be32 *) ha) & 0xffffff)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}