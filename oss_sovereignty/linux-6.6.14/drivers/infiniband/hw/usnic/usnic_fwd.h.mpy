{
  "module_name": "usnic_fwd.h",
  "hash_id": "6aaeeca4837e51bd84a7945f6f8b2eb1e178947573052a5cb69a4b4490f413d1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/usnic/usnic_fwd.h",
  "human_readable_source": " \n\n#ifndef USNIC_FWD_H_\n#define USNIC_FWD_H_\n\n#include <linux/if.h>\n#include <linux/netdevice.h>\n#include <linux/if_ether.h>\n#include <linux/pci.h>\n#include <linux/in.h>\n\n#include \"usnic_abi.h\"\n#include \"usnic_common_pkt_hdr.h\"\n#include \"vnic_devcmd.h\"\n\nstruct usnic_fwd_dev {\n\tstruct pci_dev\t\t\t*pdev;\n\tstruct net_device\t\t*netdev;\n\tspinlock_t\t\t\tlock;\n\t \n\tbool\t\t\t\tlink_up;\n\tchar\t\t\t\tmac[ETH_ALEN];\n\tunsigned int\t\t\tmtu;\n\t__be32\t\t\t\tinaddr;\n\tchar\t\t\t\tname[IFNAMSIZ];\n};\n\nstruct usnic_fwd_flow {\n\tuint32_t\t\t\tflow_id;\n\tstruct usnic_fwd_dev\t\t*ufdev;\n\tunsigned int\t\t\tvnic_idx;\n};\n\nstruct usnic_filter_action {\n\tint\t\t\t\tvnic_idx;\n\tstruct filter_action\t\taction;\n};\n\nstruct usnic_fwd_dev *usnic_fwd_dev_alloc(struct pci_dev *pdev);\nvoid usnic_fwd_dev_free(struct usnic_fwd_dev *ufdev);\n\nvoid usnic_fwd_set_mac(struct usnic_fwd_dev *ufdev, const char mac[ETH_ALEN]);\nvoid usnic_fwd_add_ipaddr(struct usnic_fwd_dev *ufdev, __be32 inaddr);\nvoid usnic_fwd_del_ipaddr(struct usnic_fwd_dev *ufdev);\nvoid usnic_fwd_carrier_up(struct usnic_fwd_dev *ufdev);\nvoid usnic_fwd_carrier_down(struct usnic_fwd_dev *ufdev);\nvoid usnic_fwd_set_mtu(struct usnic_fwd_dev *ufdev, unsigned int mtu);\n\n \nstruct usnic_fwd_flow*\nusnic_fwd_alloc_flow(struct usnic_fwd_dev *ufdev, struct filter *filter,\n\t\t\t\tstruct usnic_filter_action *action);\nint usnic_fwd_dealloc_flow(struct usnic_fwd_flow *flow);\nint usnic_fwd_enable_qp(struct usnic_fwd_dev *ufdev, int vnic_idx, int qp_idx);\nint usnic_fwd_disable_qp(struct usnic_fwd_dev *ufdev, int vnic_idx, int qp_idx);\n\nstatic inline void usnic_fwd_init_usnic_filter(struct filter *filter,\n\t\t\t\t\t\tuint32_t usnic_id)\n{\n\tfilter->type = FILTER_USNIC_ID;\n\tfilter->u.usnic.ethtype = ETH_P_IBOE;\n\tfilter->u.usnic.flags = FILTER_FIELD_USNIC_ETHTYPE |\n\t\t\t\tFILTER_FIELD_USNIC_ID |\n\t\t\t\tFILTER_FIELD_USNIC_PROTO;\n\tfilter->u.usnic.proto_version = (USNIC_ROCE_GRH_VER <<\n\t\t\t\t\t USNIC_ROCE_GRH_VER_SHIFT) |\n\t\t\t\t\t USNIC_PROTO_VER;\n\tfilter->u.usnic.usnic_id = usnic_id;\n}\n\nstatic inline void usnic_fwd_init_udp_filter(struct filter *filter,\n\t\t\t\t\t\tuint32_t daddr, uint16_t dport)\n{\n\tfilter->type = FILTER_IPV4_5TUPLE;\n\tfilter->u.ipv4.flags = FILTER_FIELD_5TUP_PROTO;\n\tfilter->u.ipv4.protocol = PROTO_UDP;\n\n\tif (daddr) {\n\t\tfilter->u.ipv4.flags |= FILTER_FIELD_5TUP_DST_AD;\n\t\tfilter->u.ipv4.dst_addr = daddr;\n\t}\n\n\tif (dport) {\n\t\tfilter->u.ipv4.flags |= FILTER_FIELD_5TUP_DST_PT;\n\t\tfilter->u.ipv4.dst_port = dport;\n\t}\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}