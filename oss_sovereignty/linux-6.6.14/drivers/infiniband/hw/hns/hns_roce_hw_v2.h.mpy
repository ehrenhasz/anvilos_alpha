{
  "module_name": "hns_roce_hw_v2.h",
  "hash_id": "9da2427110724bc9ae59f356f0447642d0d3ba5ad66e20516d1259cd23215702",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/hns/hns_roce_hw_v2.h",
  "human_readable_source": " \n\n#ifndef _HNS_ROCE_HW_V2_H\n#define _HNS_ROCE_HW_V2_H\n\n#include <linux/bitops.h>\n\n#define HNS_ROCE_V2_MAX_RC_INL_INN_SZ\t\t32\n#define HNS_ROCE_V2_MTT_ENTRY_SZ\t\t64\n#define HNS_ROCE_V2_AEQE_VEC_NUM\t\t1\n#define HNS_ROCE_V2_ABNORMAL_VEC_NUM\t\t1\n#define HNS_ROCE_V2_MAX_SRQWQE_SEGS\t\t0x1000000\n#define HNS_ROCE_V2_MAX_IDX_SEGS\t\t0x1000000\n#define HNS_ROCE_V2_MAX_XRCD_NUM\t\t0x1000000\n\n#define HNS_ROCE_V2_QP_ACK_TIMEOUT_OFS_HIP08    10\n\n#define HNS_ROCE_V3_SCCC_SZ\t\t\t64\n#define HNS_ROCE_V3_GMV_ENTRY_SZ\t\t32\n\n#define HNS_ROCE_V2_EXT_LLM_ENTRY_SZ\t\t8\n#define HNS_ROCE_V2_EXT_LLM_MAX_DEPTH\t\t4096\n\n#define HNS_ROCE_V2_QPC_TIMER_ENTRY_SZ\t\tPAGE_SIZE\n#define HNS_ROCE_V2_CQC_TIMER_ENTRY_SZ\t\tPAGE_SIZE\n#define HNS_ROCE_V2_PAGE_SIZE_SUPPORTED\t\t0xFFFF000\n#define HNS_ROCE_V2_MAX_INNER_MTPT_NUM\t\t2\n#define HNS_ROCE_INVALID_LKEY\t\t\t0x0\n#define HNS_ROCE_INVALID_SGE_LENGTH\t\t0x80000000\n#define HNS_ROCE_CMQ_TX_TIMEOUT\t\t\t30000\n#define HNS_ROCE_V2_RSV_QPS\t\t\t8\n\n#define HNS_ROCE_V2_HW_RST_TIMEOUT\t\t1000\n#define HNS_ROCE_V2_HW_RST_UNINT_DELAY\t\t100\n\n#define HNS_ROCE_V2_HW_RST_COMPLETION_WAIT\t20\n\n#define HNS_ROCE_CONTEXT_HOP_NUM\t\t1\n#define HNS_ROCE_SCCC_HOP_NUM\t\t\t1\n#define HNS_ROCE_MTT_HOP_NUM\t\t\t1\n#define HNS_ROCE_CQE_HOP_NUM\t\t\t1\n#define HNS_ROCE_SRQWQE_HOP_NUM\t\t\t1\n#define HNS_ROCE_PBL_HOP_NUM\t\t\t2\n#define HNS_ROCE_IDX_HOP_NUM\t\t\t1\n#define HNS_ROCE_SQWQE_HOP_NUM\t\t\t2\n#define HNS_ROCE_EXT_SGE_HOP_NUM\t\t1\n#define HNS_ROCE_RQWQE_HOP_NUM\t\t\t2\n\n#define HNS_ROCE_V2_EQE_HOP_NUM\t\t\t2\n#define HNS_ROCE_V3_EQE_HOP_NUM\t\t\t1\n\n#define HNS_ROCE_BA_PG_SZ_SUPPORTED_256K\t6\n#define HNS_ROCE_BA_PG_SZ_SUPPORTED_16K\t\t2\n#define HNS_ROCE_V2_GID_INDEX_NUM\t\t16\n\n#define HNS_ROCE_V2_TABLE_CHUNK_SIZE\t\t(1 << 18)\n\nenum {\n\tHNS_ROCE_CMD_FLAG_IN = BIT(0),\n\tHNS_ROCE_CMD_FLAG_OUT = BIT(1),\n\tHNS_ROCE_CMD_FLAG_NEXT = BIT(2),\n\tHNS_ROCE_CMD_FLAG_WR = BIT(3),\n\tHNS_ROCE_CMD_FLAG_ERR_INTR = BIT(5),\n};\n\n#define HNS_ROCE_CMQ_DESC_NUM_S\t\t3\n\n#define HNS_ROCE_CMQ_SCC_CLR_DONE_CNT\t\t5\n\n#define HNS_ROCE_CONG_SIZE 64\n\n#define check_whether_last_step(hop_num, step_idx) \\\n\t((step_idx == 0 && hop_num == HNS_ROCE_HOP_NUM_0) || \\\n\t(step_idx == 1 && hop_num == 1) || \\\n\t(step_idx == 2 && hop_num == 2))\n#define HNS_ICL_SWITCH_CMD_ROCEE_SEL_SHIFT\t0\n#define HNS_ICL_SWITCH_CMD_ROCEE_SEL\tBIT(HNS_ICL_SWITCH_CMD_ROCEE_SEL_SHIFT)\n\n#define CMD_CSQ_DESC_NUM\t\t1024\n#define CMD_CRQ_DESC_NUM\t\t1024\n\n \n#define HNS_ROCE_FREE_MR_USED_CQE_NUM\t\t128\n#define HNS_ROCE_FREE_MR_USED_QP_NUM\t\t0x8\n#define HNS_ROCE_FREE_MR_USED_PSN\t\t0x0808\n#define HNS_ROCE_FREE_MR_USED_QP_RETRY_CNT\t0x7\n#define HNS_ROCE_FREE_MR_USED_QP_TIMEOUT\t0x12\n#define HNS_ROCE_FREE_MR_USED_SQWQE_NUM\t\t128\n#define HNS_ROCE_FREE_MR_USED_SQSGE_NUM\t\t0x2\n#define HNS_ROCE_FREE_MR_USED_RQWQE_NUM\t\t128\n#define HNS_ROCE_FREE_MR_USED_RQSGE_NUM\t\t0x2\n#define HNS_ROCE_V2_FREE_MR_TIMEOUT\t\t4500\n\nenum {\n\tNO_ARMED = 0x0,\n\tREG_NXT_CEQE = 0x2,\n\tREG_NXT_SE_CEQE = 0x3\n};\n\nenum {\n\tCQE_SIZE_32B = 0x0,\n\tCQE_SIZE_64B = 0x1\n};\n\n#define V2_CQ_DB_REQ_NOT_SOL\t\t\t0\n#define V2_CQ_DB_REQ_NOT\t\t\t1\n\n#define V2_CQ_STATE_VALID\t\t\t1\n#define V2_QKEY_VAL\t\t\t\t0x80010000\n\n#define\tGID_LEN_V2\t\t\t\t16\n\nenum {\n\tHNS_ROCE_V2_WQE_OP_SEND\t\t\t\t= 0x0,\n\tHNS_ROCE_V2_WQE_OP_SEND_WITH_INV\t\t= 0x1,\n\tHNS_ROCE_V2_WQE_OP_SEND_WITH_IMM\t\t= 0x2,\n\tHNS_ROCE_V2_WQE_OP_RDMA_WRITE\t\t\t= 0x3,\n\tHNS_ROCE_V2_WQE_OP_RDMA_WRITE_WITH_IMM\t\t= 0x4,\n\tHNS_ROCE_V2_WQE_OP_RDMA_READ\t\t\t= 0x5,\n\tHNS_ROCE_V2_WQE_OP_ATOM_CMP_AND_SWAP\t\t= 0x6,\n\tHNS_ROCE_V2_WQE_OP_ATOM_FETCH_AND_ADD\t\t= 0x7,\n\tHNS_ROCE_V2_WQE_OP_ATOM_MSK_CMP_AND_SWAP\t= 0x8,\n\tHNS_ROCE_V2_WQE_OP_ATOM_MSK_FETCH_AND_ADD\t= 0x9,\n\tHNS_ROCE_V2_WQE_OP_FAST_REG_PMR\t\t\t= 0xa,\n\tHNS_ROCE_V2_WQE_OP_BIND_MW\t\t\t= 0xc,\n\tHNS_ROCE_V2_WQE_OP_MASK\t\t\t\t= 0x1f,\n};\n\nenum {\n\t \n\tHNS_ROCE_V2_OPCODE_RDMA_WRITE_IMM = 0x0,\n\tHNS_ROCE_V2_OPCODE_SEND = 0x1,\n\tHNS_ROCE_V2_OPCODE_SEND_WITH_IMM = 0x2,\n\tHNS_ROCE_V2_OPCODE_SEND_WITH_INV = 0x3,\n};\n\nenum {\n\tHNS_ROCE_V2_SQ_DB,\n\tHNS_ROCE_V2_RQ_DB,\n\tHNS_ROCE_V2_SRQ_DB,\n\tHNS_ROCE_V2_CQ_DB,\n\tHNS_ROCE_V2_CQ_DB_NOTIFY\n};\n\nenum {\n\tHNS_ROCE_CQE_V2_SUCCESS\t\t\t\t= 0x00,\n\tHNS_ROCE_CQE_V2_LOCAL_LENGTH_ERR\t\t= 0x01,\n\tHNS_ROCE_CQE_V2_LOCAL_QP_OP_ERR\t\t\t= 0x02,\n\tHNS_ROCE_CQE_V2_LOCAL_PROT_ERR\t\t\t= 0x04,\n\tHNS_ROCE_CQE_V2_WR_FLUSH_ERR\t\t\t= 0x05,\n\tHNS_ROCE_CQE_V2_MW_BIND_ERR\t\t\t= 0x06,\n\tHNS_ROCE_CQE_V2_BAD_RESP_ERR\t\t\t= 0x10,\n\tHNS_ROCE_CQE_V2_LOCAL_ACCESS_ERR\t\t= 0x11,\n\tHNS_ROCE_CQE_V2_REMOTE_INVAL_REQ_ERR\t\t= 0x12,\n\tHNS_ROCE_CQE_V2_REMOTE_ACCESS_ERR\t\t= 0x13,\n\tHNS_ROCE_CQE_V2_REMOTE_OP_ERR\t\t\t= 0x14,\n\tHNS_ROCE_CQE_V2_TRANSPORT_RETRY_EXC_ERR\t\t= 0x15,\n\tHNS_ROCE_CQE_V2_RNR_RETRY_EXC_ERR\t\t= 0x16,\n\tHNS_ROCE_CQE_V2_REMOTE_ABORT_ERR\t\t= 0x22,\n\tHNS_ROCE_CQE_V2_GENERAL_ERR\t\t\t= 0x23,\n\n\tHNS_ROCE_V2_CQE_STATUS_MASK\t\t\t= 0xff,\n};\n\n \nenum hns_roce_opcode_type {\n\tHNS_QUERY_FW_VER\t\t\t\t= 0x0001,\n\tHNS_ROCE_OPC_QUERY_HW_VER\t\t\t= 0x8000,\n\tHNS_ROCE_OPC_CFG_GLOBAL_PARAM\t\t\t= 0x8001,\n\tHNS_ROCE_OPC_ALLOC_PF_RES\t\t\t= 0x8004,\n\tHNS_ROCE_OPC_QUERY_COUNTER\t\t\t= 0x8206,\n\tHNS_ROCE_OPC_QUERY_PF_RES\t\t\t= 0x8400,\n\tHNS_ROCE_OPC_ALLOC_VF_RES\t\t\t= 0x8401,\n\tHNS_ROCE_OPC_CFG_EXT_LLM\t\t\t= 0x8403,\n\tHNS_ROCE_OPC_QUERY_PF_TIMER_RES\t\t\t= 0x8406,\n\tHNS_ROCE_OPC_QUERY_FUNC_INFO\t\t\t= 0x8407,\n\tHNS_ROCE_OPC_QUERY_PF_CAPS_NUM                  = 0x8408,\n\tHNS_ROCE_OPC_CFG_ENTRY_SIZE\t\t\t= 0x8409,\n\tHNS_ROCE_OPC_QUERY_VF_CAPS_NUM\t\t\t= 0x8410,\n\tHNS_ROCE_OPC_CFG_SGID_TB\t\t\t= 0x8500,\n\tHNS_ROCE_OPC_CFG_SMAC_TB\t\t\t= 0x8501,\n\tHNS_ROCE_OPC_POST_MB\t\t\t\t= 0x8504,\n\tHNS_ROCE_OPC_QUERY_MB_ST\t\t\t= 0x8505,\n\tHNS_ROCE_OPC_CFG_BT_ATTR\t\t\t= 0x8506,\n\tHNS_ROCE_OPC_FUNC_CLEAR\t\t\t\t= 0x8508,\n\tHNS_ROCE_OPC_CLR_SCCC\t\t\t\t= 0x8509,\n\tHNS_ROCE_OPC_QUERY_SCCC\t\t\t\t= 0x850a,\n\tHNS_ROCE_OPC_RESET_SCCC\t\t\t\t= 0x850b,\n\tHNS_ROCE_OPC_CLEAR_EXTDB_LIST_INFO\t\t= 0x850d,\n\tHNS_ROCE_OPC_QUERY_VF_RES\t\t\t= 0x850e,\n\tHNS_ROCE_OPC_CFG_GMV_TBL\t\t\t= 0x850f,\n\tHNS_ROCE_OPC_CFG_GMV_BT\t\t\t\t= 0x8510,\n\tHNS_ROCE_QUERY_RAM_ECC\t\t\t\t= 0x8513,\n\tHNS_SWITCH_PARAMETER_CFG\t\t\t= 0x1033,\n};\n\nenum {\n\tTYPE_CRQ,\n\tTYPE_CSQ,\n};\n\nenum hns_roce_cmd_return_status {\n\tCMD_EXEC_SUCCESS,\n\tCMD_NO_AUTH,\n\tCMD_NOT_EXIST,\n\tCMD_CRQ_FULL,\n\tCMD_NEXT_ERR,\n\tCMD_NOT_EXEC,\n\tCMD_PARA_ERR,\n\tCMD_RESULT_ERR,\n\tCMD_TIMEOUT,\n\tCMD_HILINK_ERR,\n\tCMD_INFO_ILLEGAL,\n\tCMD_INVALID,\n\tCMD_ROH_CHECK_FAIL,\n\tCMD_OTHER_ERR = 0xff\n};\n\nstruct hns_roce_cmd_errcode {\n\tenum hns_roce_cmd_return_status return_status;\n\tint errno;\n};\n\nenum hns_roce_sgid_type {\n\tGID_TYPE_FLAG_ROCE_V1 = 0,\n\tGID_TYPE_FLAG_ROCE_V2_IPV4,\n\tGID_TYPE_FLAG_ROCE_V2_IPV6,\n};\n\nstruct hns_roce_v2_cq_context {\n\t__le32 byte_4_pg_ceqn;\n\t__le32 byte_8_cqn;\n\t__le32 cqe_cur_blk_addr;\n\t__le32 byte_16_hop_addr;\n\t__le32 cqe_nxt_blk_addr;\n\t__le32 byte_24_pgsz_addr;\n\t__le32 byte_28_cq_pi;\n\t__le32 byte_32_cq_ci;\n\t__le32 cqe_ba;\n\t__le32 byte_40_cqe_ba;\n\t__le32 byte_44_db_record;\n\t__le32 db_record_addr;\n\t__le32 byte_52_cqe_cnt;\n\t__le32 byte_56_cqe_period_maxcnt;\n\t__le32 cqe_report_timer;\n\t__le32 byte_64_se_cqe_idx;\n};\n\n#define HNS_ROCE_V2_CQ_DEFAULT_BURST_NUM 0x0\n#define HNS_ROCE_V2_CQ_DEFAULT_INTERVAL\t0x0\n\n#define CQC_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_cq_context, h, l)\n\n#define CQC_CQ_ST CQC_FIELD_LOC(1, 0)\n#define CQC_POLL CQC_FIELD_LOC(2, 2)\n#define CQC_SE CQC_FIELD_LOC(3, 3)\n#define CQC_OVER_IGNORE CQC_FIELD_LOC(4, 4)\n#define CQC_ARM_ST CQC_FIELD_LOC(7, 6)\n#define CQC_SHIFT CQC_FIELD_LOC(12, 8)\n#define CQC_CMD_SN CQC_FIELD_LOC(14, 13)\n#define CQC_CEQN CQC_FIELD_LOC(23, 15)\n#define CQC_CQN CQC_FIELD_LOC(55, 32)\n#define CQC_POE_EN CQC_FIELD_LOC(56, 56)\n#define CQC_POE_NUM CQC_FIELD_LOC(58, 57)\n#define CQC_CQE_SIZE CQC_FIELD_LOC(60, 59)\n#define CQC_CQ_CNT_MODE CQC_FIELD_LOC(61, 61)\n#define CQC_STASH CQC_FIELD_LOC(63, 63)\n#define CQC_CQE_CUR_BLK_ADDR_L CQC_FIELD_LOC(95, 64)\n#define CQC_CQE_CUR_BLK_ADDR_H CQC_FIELD_LOC(115, 96)\n#define CQC_POE_QID CQC_FIELD_LOC(125, 116)\n#define CQC_CQE_HOP_NUM CQC_FIELD_LOC(127, 126)\n#define CQC_CQE_NEX_BLK_ADDR_L CQC_FIELD_LOC(159, 128)\n#define CQC_CQE_NEX_BLK_ADDR_H CQC_FIELD_LOC(179, 160)\n#define CQC_CQE_BAR_PG_SZ CQC_FIELD_LOC(187, 184)\n#define CQC_CQE_BUF_PG_SZ CQC_FIELD_LOC(191, 188)\n#define CQC_CQ_PRODUCER_IDX CQC_FIELD_LOC(215, 192)\n#define CQC_CQ_CONSUMER_IDX CQC_FIELD_LOC(247, 224)\n#define CQC_CQE_BA_L CQC_FIELD_LOC(287, 256)\n#define CQC_CQE_BA_H CQC_FIELD_LOC(316, 288)\n#define CQC_POE_QID_H_0 CQC_FIELD_LOC(319, 317)\n#define CQC_DB_RECORD_EN CQC_FIELD_LOC(320, 320)\n#define CQC_CQE_DB_RECORD_ADDR_L CQC_FIELD_LOC(351, 321)\n#define CQC_CQE_DB_RECORD_ADDR_H CQC_FIELD_LOC(383, 352)\n#define CQC_CQE_CNT CQC_FIELD_LOC(407, 384)\n#define CQC_CQ_MAX_CNT CQC_FIELD_LOC(431, 416)\n#define CQC_CQ_PERIOD CQC_FIELD_LOC(447, 432)\n#define CQC_CQE_REPORT_TIMER CQC_FIELD_LOC(471, 448)\n#define CQC_WR_CQE_IDX CQC_FIELD_LOC(479, 472)\n#define CQC_SE_CQE_IDX CQC_FIELD_LOC(503, 480)\n#define CQC_POE_QID_H_1 CQC_FIELD_LOC(511, 511)\n\nstruct hns_roce_srq_context {\n\t__le32 data[16];\n};\n\n#define SRQC_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_srq_context, h, l)\n\n#define SRQC_SRQ_ST SRQC_FIELD_LOC(1, 0)\n#define SRQC_WQE_HOP_NUM SRQC_FIELD_LOC(3, 2)\n#define SRQC_SHIFT SRQC_FIELD_LOC(7, 4)\n#define SRQC_SRQN SRQC_FIELD_LOC(31, 8)\n#define SRQC_LIMIT_WL SRQC_FIELD_LOC(47, 32)\n#define SRQC_RSV0 SRQC_FIELD_LOC(63, 48)\n#define SRQC_XRCD SRQC_FIELD_LOC(87, 64)\n#define SRQC_RSV1 SRQC_FIELD_LOC(95, 88)\n#define SRQC_PRODUCER_IDX SRQC_FIELD_LOC(111, 96)\n#define SRQC_CONSUMER_IDX SRQC_FIELD_LOC(127, 112)\n#define SRQC_WQE_BT_BA_L SRQC_FIELD_LOC(159, 128)\n#define SRQC_WQE_BT_BA_H SRQC_FIELD_LOC(188, 160)\n#define SRQC_RSV2 SRQC_FIELD_LOC(190, 189)\n#define SRQC_SRQ_TYPE SRQC_FIELD_LOC(191, 191)\n#define SRQC_PD SRQC_FIELD_LOC(215, 192)\n#define SRQC_RQWS SRQC_FIELD_LOC(219, 216)\n#define SRQC_RSV3 SRQC_FIELD_LOC(223, 220)\n#define SRQC_IDX_BT_BA_L SRQC_FIELD_LOC(255, 224)\n#define SRQC_IDX_BT_BA_H SRQC_FIELD_LOC(284, 256)\n#define SRQC_RSV4 SRQC_FIELD_LOC(287, 285)\n#define SRQC_IDX_CUR_BLK_ADDR_L SRQC_FIELD_LOC(319, 288)\n#define SRQC_IDX_CUR_BLK_ADDR_H SRQC_FIELD_LOC(339, 320)\n#define SRQC_RSV5 SRQC_FIELD_LOC(341, 340)\n#define SRQC_IDX_HOP_NUM SRQC_FIELD_LOC(343, 342)\n#define SRQC_IDX_BA_PG_SZ SRQC_FIELD_LOC(347, 344)\n#define SRQC_IDX_BUF_PG_SZ SRQC_FIELD_LOC(351, 348)\n#define SRQC_IDX_NXT_BLK_ADDR_L SRQC_FIELD_LOC(383, 352)\n#define SRQC_IDX_NXT_BLK_ADDR_H SRQC_FIELD_LOC(403, 384)\n#define SRQC_RSV6 SRQC_FIELD_LOC(415, 404)\n#define SRQC_XRC_CQN SRQC_FIELD_LOC(439, 416)\n#define SRQC_WQE_BA_PG_SZ SRQC_FIELD_LOC(443, 440)\n#define SRQC_WQE_BUF_PG_SZ SRQC_FIELD_LOC(447, 444)\n#define SRQC_DB_RECORD_EN SRQC_FIELD_LOC(448, 448)\n#define SRQC_DB_RECORD_ADDR_L SRQC_FIELD_LOC(479, 449)\n#define SRQC_DB_RECORD_ADDR_H SRQC_FIELD_LOC(511, 480)\n\nenum {\n\tV2_MPT_ST_VALID = 0x1,\n\tV2_MPT_ST_FREE\t= 0x2,\n};\n\nenum hns_roce_v2_qp_state {\n\tHNS_ROCE_QP_ST_RST,\n\tHNS_ROCE_QP_ST_INIT,\n\tHNS_ROCE_QP_ST_RTR,\n\tHNS_ROCE_QP_ST_RTS,\n\tHNS_ROCE_QP_ST_SQD,\n\tHNS_ROCE_QP_ST_SQER,\n\tHNS_ROCE_QP_ST_ERR,\n\tHNS_ROCE_QP_ST_SQ_DRAINING,\n\tHNS_ROCE_QP_NUM_ST\n};\n\nstruct hns_roce_v2_qp_context_ex {\n\t__le32 data[64];\n};\n\nstruct hns_roce_v2_qp_context {\n\t__le32 byte_4_sqpn_tst;\n\t__le32 wqe_sge_ba;\n\t__le32 byte_12_sq_hop;\n\t__le32 byte_16_buf_ba_pg_sz;\n\t__le32 byte_20_smac_sgid_idx;\n\t__le32 byte_24_mtu_tc;\n\t__le32 byte_28_at_fl;\n\tu8 dgid[GID_LEN_V2];\n\t__le32 dmac;\n\t__le32 byte_52_udpspn_dmac;\n\t__le32 byte_56_dqpn_err;\n\t__le32 byte_60_qpst_tempid;\n\t__le32 qkey_xrcd;\n\t__le32 byte_68_rq_db;\n\t__le32 rq_db_record_addr;\n\t__le32 byte_76_srqn_op_en;\n\t__le32 byte_80_rnr_rx_cqn;\n\t__le32 byte_84_rq_ci_pi;\n\t__le32 rq_cur_blk_addr;\n\t__le32 byte_92_srq_info;\n\t__le32 byte_96_rx_reqmsn;\n\t__le32 rq_nxt_blk_addr;\n\t__le32 byte_104_rq_sge;\n\t__le32 byte_108_rx_reqepsn;\n\t__le32 rq_rnr_timer;\n\t__le32 rx_msg_len;\n\t__le32 rx_rkey_pkt_info;\n\t__le64 rx_va;\n\t__le32 byte_132_trrl;\n\t__le32 trrl_ba;\n\t__le32 byte_140_raq;\n\t__le32 byte_144_raq;\n\t__le32 byte_148_raq;\n\t__le32 byte_152_raq;\n\t__le32 byte_156_raq;\n\t__le32 byte_160_sq_ci_pi;\n\t__le32 sq_cur_blk_addr;\n\t__le32 byte_168_irrl_idx;\n\t__le32 byte_172_sq_psn;\n\t__le32 byte_176_msg_pktn;\n\t__le32 sq_cur_sge_blk_addr;\n\t__le32 byte_184_irrl_idx;\n\t__le32 cur_sge_offset;\n\t__le32 byte_192_ext_sge;\n\t__le32 byte_196_sq_psn;\n\t__le32 byte_200_sq_max;\n\t__le32 irrl_ba;\n\t__le32 byte_208_irrl;\n\t__le32 byte_212_lsn;\n\t__le32 sq_timer;\n\t__le32 byte_220_retry_psn_msn;\n\t__le32 byte_224_retry_msg;\n\t__le32 rx_sq_cur_blk_addr;\n\t__le32 byte_232_irrl_sge;\n\t__le32 irrl_cur_sge_offset;\n\t__le32 byte_240_irrl_tail;\n\t__le32 byte_244_rnr_rxack;\n\t__le32 byte_248_ack_psn;\n\t__le32 byte_252_err_txcqn;\n\t__le32 byte_256_sqflush_rqcqe;\n\n\tstruct hns_roce_v2_qp_context_ex ext;\n};\n\n#define QPC_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_qp_context, h, l)\n\n#define QPC_TST QPC_FIELD_LOC(2, 0)\n#define QPC_SGE_SHIFT QPC_FIELD_LOC(7, 3)\n#define QPC_CNP_TIMER QPC_FIELD_LOC(31, 8)\n#define QPC_WQE_SGE_BA_L QPC_FIELD_LOC(63, 32)\n#define QPC_WQE_SGE_BA_H QPC_FIELD_LOC(92, 64)\n#define QPC_SQ_HOP_NUM QPC_FIELD_LOC(94, 93)\n#define QPC_CIRE_EN QPC_FIELD_LOC(95, 95)\n#define QPC_WQE_SGE_BA_PG_SZ QPC_FIELD_LOC(99, 96)\n#define QPC_WQE_SGE_BUF_PG_SZ QPC_FIELD_LOC(103, 100)\n#define QPC_PD QPC_FIELD_LOC(127, 104)\n#define QPC_RQ_HOP_NUM QPC_FIELD_LOC(129, 128)\n#define QPC_SGE_HOP_NUM QPC_FIELD_LOC(131, 130)\n#define QPC_RQWS QPC_FIELD_LOC(135, 132)\n#define QPC_SQ_SHIFT QPC_FIELD_LOC(139, 136)\n#define QPC_RQ_SHIFT QPC_FIELD_LOC(143, 140)\n#define QPC_GMV_IDX QPC_FIELD_LOC(159, 144)\n#define QPC_HOPLIMIT QPC_FIELD_LOC(167, 160)\n#define QPC_TC QPC_FIELD_LOC(175, 168)\n#define QPC_VLAN_ID QPC_FIELD_LOC(187, 176)\n#define QPC_MTU QPC_FIELD_LOC(191, 188)\n#define QPC_FL QPC_FIELD_LOC(211, 192)\n#define QPC_SL QPC_FIELD_LOC(215, 212)\n#define QPC_CNP_TX_FLAG QPC_FIELD_LOC(216, 216)\n#define QPC_CE_FLAG QPC_FIELD_LOC(217, 217)\n#define QPC_LBI QPC_FIELD_LOC(218, 218)\n#define QPC_AT QPC_FIELD_LOC(223, 219)\n#define QPC_DGID QPC_FIELD_LOC(351, 224)\n#define QPC_DMAC_L QPC_FIELD_LOC(383, 352)\n#define QPC_DMAC_H QPC_FIELD_LOC(399, 384)\n#define QPC_UDPSPN QPC_FIELD_LOC(415, 400)\n#define QPC_DQPN QPC_FIELD_LOC(439, 416)\n#define QPC_SQ_TX_ERR QPC_FIELD_LOC(440, 440)\n#define QPC_SQ_RX_ERR QPC_FIELD_LOC(441, 441)\n#define QPC_RQ_TX_ERR QPC_FIELD_LOC(442, 442)\n#define QPC_RQ_RX_ERR QPC_FIELD_LOC(443, 443)\n#define QPC_LP_PKTN_INI QPC_FIELD_LOC(447, 444)\n#define QPC_CONG_ALGO_TMPL_ID QPC_FIELD_LOC(455, 448)\n#define QPC_SCC_TOKEN QPC_FIELD_LOC(474, 456)\n#define QPC_SQ_DB_DOING QPC_FIELD_LOC(475, 475)\n#define QPC_RQ_DB_DOING QPC_FIELD_LOC(476, 476)\n#define QPC_QP_ST QPC_FIELD_LOC(479, 477)\n#define QPC_QKEY_XRCD QPC_FIELD_LOC(511, 480)\n#define QPC_RQ_RECORD_EN QPC_FIELD_LOC(512, 512)\n#define QPC_RQ_DB_RECORD_ADDR_L QPC_FIELD_LOC(543, 513)\n#define QPC_RQ_DB_RECORD_ADDR_H QPC_FIELD_LOC(575, 544)\n#define QPC_SRQN QPC_FIELD_LOC(599, 576)\n#define QPC_SRQ_EN QPC_FIELD_LOC(600, 600)\n#define QPC_RRE QPC_FIELD_LOC(601, 601)\n#define QPC_RWE QPC_FIELD_LOC(602, 602)\n#define QPC_ATE QPC_FIELD_LOC(603, 603)\n#define QPC_RQIE QPC_FIELD_LOC(604, 604)\n#define QPC_EXT_ATE QPC_FIELD_LOC(605, 605)\n#define QPC_RQ_VLAN_EN QPC_FIELD_LOC(606, 606)\n#define QPC_RQ_RTY_TX_ERR QPC_FIELD_LOC(607, 607)\n#define QPC_RX_CQN QPC_FIELD_LOC(631, 608)\n#define QPC_XRC_QP_TYPE QPC_FIELD_LOC(632, 632)\n#define QPC_CQEIE QPC_FIELD_LOC(633, 633)\n#define QPC_CQEIS QPC_FIELD_LOC(634, 634)\n#define QPC_MIN_RNR_TIME QPC_FIELD_LOC(639, 635)\n#define QPC_RQ_PRODUCER_IDX QPC_FIELD_LOC(655, 640)\n#define QPC_RQ_CONSUMER_IDX QPC_FIELD_LOC(671, 656)\n#define QPC_RQ_CUR_BLK_ADDR_L QPC_FIELD_LOC(703, 672)\n#define QPC_RQ_CUR_BLK_ADDR_H QPC_FIELD_LOC(723, 704)\n#define QPC_SRQ_INFO QPC_FIELD_LOC(735, 724)\n#define QPC_RX_REQ_MSN QPC_FIELD_LOC(759, 736)\n#define QPC_REDUCE_CODE QPC_FIELD_LOC(766, 760)\n#define QPC_RX_XRC_PKT_CQE_FLG QPC_FIELD_LOC(767, 767)\n#define QPC_RQ_NXT_BLK_ADDR_L QPC_FIELD_LOC(799, 768)\n#define QPC_RQ_NXT_BLK_ADDR_H QPC_FIELD_LOC(819, 800)\n#define QPC_REDUCE_EN QPC_FIELD_LOC(820, 820)\n#define QPC_FLUSH_EN QPC_FIELD_LOC(821, 821)\n#define QPC_AW_EN QPC_FIELD_LOC(822, 822)\n#define QPC_WN_EN QPC_FIELD_LOC(823, 823)\n#define QPC_RQ_CUR_WQE_SGE_NUM QPC_FIELD_LOC(831, 824)\n#define QPC_INV_CREDIT QPC_FIELD_LOC(832, 832)\n#define QPC_LAST_WRITE_TYPE QPC_FIELD_LOC(834, 833)\n#define QPC_RX_REQ_PSN_ERR QPC_FIELD_LOC(835, 835)\n#define QPC_RX_REQ_LAST_OPTYPE QPC_FIELD_LOC(838, 836)\n#define QPC_RX_REQ_RNR QPC_FIELD_LOC(839, 839)\n#define QPC_RX_REQ_EPSN QPC_FIELD_LOC(863, 840)\n#define QPC_RQ_RNR_TIMER QPC_FIELD_LOC(895, 864)\n#define QPC_RX_MSG_LEN QPC_FIELD_LOC(927, 896)\n#define QPC_RX_RKEY_PKT_INFO QPC_FIELD_LOC(959, 928)\n#define QPC_RX_VA QPC_FIELD_LOC(1023, 960)\n#define QPC_TRRL_HEAD_MAX QPC_FIELD_LOC(1031, 1024)\n#define QPC_TRRL_TAIL_MAX QPC_FIELD_LOC(1039, 1032)\n#define QPC_TRRL_BA_L QPC_FIELD_LOC(1055, 1040)\n#define QPC_TRRL_BA_M QPC_FIELD_LOC(1087, 1056)\n#define QPC_TRRL_BA_H QPC_FIELD_LOC(1099, 1088)\n#define QPC_RR_MAX QPC_FIELD_LOC(1102, 1100)\n#define QPC_RQ_RTY_WAIT_DO QPC_FIELD_LOC(1103, 1103)\n#define QPC_RAQ_TRRL_HEAD QPC_FIELD_LOC(1111, 1104)\n#define QPC_RAQ_TRRL_TAIL QPC_FIELD_LOC(1119, 1112)\n#define QPC_RAQ_RTY_INI_PSN QPC_FIELD_LOC(1143, 1120)\n#define QPC_CIRE_SLV_RQ_EN QPC_FIELD_LOC(1144, 1144)\n#define QPC_RAQ_CREDIT QPC_FIELD_LOC(1149, 1145)\n#define QPC_RQ_DB_IN_EXT QPC_FIELD_LOC(1150, 1150)\n#define QPC_RESP_RTY_FLG QPC_FIELD_LOC(1151, 1151)\n#define QPC_RAQ_MSN QPC_FIELD_LOC(1175, 1152)\n#define QPC_RAQ_SYNDROME QPC_FIELD_LOC(1183, 1176)\n#define QPC_RAQ_PSN QPC_FIELD_LOC(1207, 1184)\n#define QPC_RAQ_TRRL_RTY_HEAD QPC_FIELD_LOC(1215, 1208)\n#define QPC_RAQ_USE_PKTN QPC_FIELD_LOC(1239, 1216)\n#define QPC_RQ_SCC_TOKEN QPC_FIELD_LOC(1245, 1240)\n#define QPC_RVD10 QPC_FIELD_LOC(1247, 1246)\n#define QPC_SQ_PRODUCER_IDX QPC_FIELD_LOC(1263, 1248)\n#define QPC_SQ_CONSUMER_IDX QPC_FIELD_LOC(1279, 1264)\n#define QPC_SQ_CUR_BLK_ADDR_L QPC_FIELD_LOC(1311, 1280)\n#define QPC_SQ_CUR_BLK_ADDR_H QPC_FIELD_LOC(1331, 1312)\n#define QPC_MSG_RTY_LP_FLG QPC_FIELD_LOC(1332, 1332)\n#define QPC_SQ_INVLD_FLG QPC_FIELD_LOC(1333, 1333)\n#define QPC_LP_SGEN_INI QPC_FIELD_LOC(1335, 1334)\n#define QPC_SQ_VLAN_EN QPC_FIELD_LOC(1336, 1336)\n#define QPC_POLL_DB_WAIT_DO QPC_FIELD_LOC(1337, 1337)\n#define QPC_SCC_TOKEN_FORBID_SQ_DEQ QPC_FIELD_LOC(1338, 1338)\n#define QPC_WAIT_ACK_TIMEOUT QPC_FIELD_LOC(1339, 1339)\n#define QPC_IRRL_IDX_LSB QPC_FIELD_LOC(1343, 1340)\n#define QPC_ACK_REQ_FREQ QPC_FIELD_LOC(1349, 1344)\n#define QPC_MSG_RNR_FLG QPC_FIELD_LOC(1350, 1350)\n#define QPC_FRE QPC_FIELD_LOC(1351, 1351)\n#define QPC_SQ_CUR_PSN QPC_FIELD_LOC(1375, 1352)\n#define QPC_MSG_USE_PKTN QPC_FIELD_LOC(1399, 1376)\n#define QPC_IRRL_HEAD_PRE QPC_FIELD_LOC(1407, 1400)\n#define QPC_SQ_CUR_SGE_BLK_ADDR_L QPC_FIELD_LOC(1439, 1408)\n#define QPC_SQ_CUR_SGE_BLK_ADDR_H QPC_FIELD_LOC(1459, 1440)\n#define QPC_IRRL_IDX_MSB QPC_FIELD_LOC(1471, 1460)\n#define QPC_CUR_SGE_OFFSET QPC_FIELD_LOC(1503, 1472)\n#define QPC_CUR_SGE_IDX QPC_FIELD_LOC(1527, 1504)\n#define QPC_EXT_SGE_NUM_LEFT QPC_FIELD_LOC(1535, 1528)\n#define QPC_OWNER_MODE QPC_FIELD_LOC(1536, 1536)\n#define QPC_CIRE_SLV_SQ_EN QPC_FIELD_LOC(1537, 1537)\n#define QPC_CIRE_DOING QPC_FIELD_LOC(1538, 1538)\n#define QPC_CIRE_RESULT QPC_FIELD_LOC(1539, 1539)\n#define QPC_OWNER_DB_WAIT_DO QPC_FIELD_LOC(1540, 1540)\n#define QPC_SQ_WQE_INVLD QPC_FIELD_LOC(1541, 1541)\n#define QPC_DCA_MODE QPC_FIELD_LOC(1542, 1542)\n#define QPC_RTY_OWNER_NOCHK QPC_FIELD_LOC(1543, 1543)\n#define QPC_V2_IRRL_HEAD QPC_FIELD_LOC(1543, 1536)\n#define QPC_SQ_MAX_PSN QPC_FIELD_LOC(1567, 1544)\n#define QPC_SQ_MAX_IDX QPC_FIELD_LOC(1583, 1568)\n#define QPC_LCL_OPERATED_CNT QPC_FIELD_LOC(1599, 1584)\n#define QPC_IRRL_BA_L QPC_FIELD_LOC(1631, 1600)\n#define QPC_IRRL_BA_H QPC_FIELD_LOC(1657, 1632)\n#define QPC_PKT_RNR_FLG QPC_FIELD_LOC(1658, 1658)\n#define QPC_PKT_RTY_FLG QPC_FIELD_LOC(1659, 1659)\n#define QPC_RMT_E2E QPC_FIELD_LOC(1660, 1660)\n#define QPC_SR_MAX QPC_FIELD_LOC(1663, 1661)\n#define QPC_LSN QPC_FIELD_LOC(1687, 1664)\n#define QPC_RETRY_NUM_INIT QPC_FIELD_LOC(1690, 1688)\n#define QPC_CHECK_FLG QPC_FIELD_LOC(1692, 1691)\n#define QPC_RETRY_CNT QPC_FIELD_LOC(1695, 1693)\n#define QPC_SQ_TIMER QPC_FIELD_LOC(1727, 1696)\n#define QPC_RETRY_MSG_MSN QPC_FIELD_LOC(1743, 1728)\n#define QPC_RETRY_MSG_PSN_L QPC_FIELD_LOC(1759, 1744)\n#define QPC_RETRY_MSG_PSN_H QPC_FIELD_LOC(1767, 1760)\n#define QPC_RETRY_MSG_FPKT_PSN QPC_FIELD_LOC(1791, 1768)\n#define QPC_RX_SQ_CUR_BLK_ADDR_L QPC_FIELD_LOC(1823, 1792)\n#define QPC_RX_SQ_CUR_BLK_ADDR_H QPC_FIELD_LOC(1843, 1824)\n#define QPC_IRRL_SGE_IDX QPC_FIELD_LOC(1851, 1844)\n#define QPC_LSAN_EN QPC_FIELD_LOC(1852, 1852)\n#define QPC_SO_LP_VLD QPC_FIELD_LOC(1853, 1853)\n#define QPC_FENCE_LP_VLD QPC_FIELD_LOC(1854, 1854)\n#define QPC_IRRL_LP_VLD QPC_FIELD_LOC(1855, 1855)\n#define QPC_IRRL_CUR_SGE_OFFSET QPC_FIELD_LOC(1887, 1856)\n#define QPC_IRRL_TAIL_REAL QPC_FIELD_LOC(1895, 1888)\n#define QPC_IRRL_TAIL_RD QPC_FIELD_LOC(1903, 1896)\n#define QPC_RX_ACK_MSN QPC_FIELD_LOC(1919, 1904)\n#define QPC_RX_ACK_EPSN QPC_FIELD_LOC(1943, 1920)\n#define QPC_RNR_NUM_INIT QPC_FIELD_LOC(1946, 1944)\n#define QPC_RNR_CNT QPC_FIELD_LOC(1949, 1947)\n#define QPC_LCL_OP_FLG QPC_FIELD_LOC(1950, 1950)\n#define QPC_IRRL_RD_FLG QPC_FIELD_LOC(1951, 1951)\n#define QPC_IRRL_PSN QPC_FIELD_LOC(1975, 1952)\n#define QPC_ACK_PSN_ERR QPC_FIELD_LOC(1976, 1976)\n#define QPC_ACK_LAST_OPTYPE QPC_FIELD_LOC(1978, 1977)\n#define QPC_IRRL_PSN_VLD QPC_FIELD_LOC(1979, 1979)\n#define QPC_RNR_RETRY_FLAG QPC_FIELD_LOC(1980, 1980)\n#define QPC_SQ_RTY_TX_ERR QPC_FIELD_LOC(1981, 1981)\n#define QPC_LAST_IND QPC_FIELD_LOC(1982, 1982)\n#define QPC_CQ_ERR_IND QPC_FIELD_LOC(1983, 1983)\n#define QPC_TX_CQN QPC_FIELD_LOC(2007, 1984)\n#define QPC_SIG_TYPE QPC_FIELD_LOC(2008, 2008)\n#define QPC_ERR_TYPE QPC_FIELD_LOC(2015, 2009)\n#define QPC_RQ_CQE_IDX QPC_FIELD_LOC(2031, 2016)\n#define QPC_SQ_FLUSH_IDX QPC_FIELD_LOC(2047, 2032)\n\n#define RETRY_MSG_PSN_SHIFT 16\n\n#define QPCEX_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_qp_context_ex, h, l)\n\n#define QPCEX_CONG_ALG_SEL QPCEX_FIELD_LOC(0, 0)\n#define QPCEX_CONG_ALG_SUB_SEL QPCEX_FIELD_LOC(1, 1)\n#define QPCEX_DIP_CTX_IDX_VLD QPCEX_FIELD_LOC(2, 2)\n#define QPCEX_DIP_CTX_IDX QPCEX_FIELD_LOC(22, 3)\n#define QPCEX_SQ_RQ_NOT_FORBID_EN QPCEX_FIELD_LOC(23, 23)\n#define QPCEX_STASH QPCEX_FIELD_LOC(82, 82)\n\n#define\tV2_QP_RWE_S 1  \n#define\tV2_QP_RRE_S 2  \n#define\tV2_QP_ATE_S 3  \n\nstruct hns_roce_v2_cqe {\n\t__le32\tbyte_4;\n\tunion {\n\t\t__le32 rkey;\n\t\t__le32 immtdata;\n\t};\n\t__le32\tbyte_12;\n\t__le32\tbyte_16;\n\t__le32\tbyte_cnt;\n\tu8\tsmac[4];\n\t__le32\tbyte_28;\n\t__le32\tbyte_32;\n\t__le32\trsv[8];\n};\n\n#define CQE_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_cqe, h, l)\n\n#define CQE_OPCODE CQE_FIELD_LOC(4, 0)\n#define CQE_RQ_INLINE CQE_FIELD_LOC(5, 5)\n#define CQE_S_R CQE_FIELD_LOC(6, 6)\n#define CQE_OWNER CQE_FIELD_LOC(7, 7)\n#define CQE_STATUS CQE_FIELD_LOC(15, 8)\n#define CQE_WQE_IDX CQE_FIELD_LOC(31, 16)\n#define CQE_RKEY_IMMTDATA CQE_FIELD_LOC(63, 32)\n#define CQE_XRC_SRQN CQE_FIELD_LOC(87, 64)\n#define CQE_RSV0 CQE_FIELD_LOC(95, 88)\n#define CQE_LCL_QPN CQE_FIELD_LOC(119, 96)\n#define CQE_SUB_STATUS CQE_FIELD_LOC(127, 120)\n#define CQE_BYTE_CNT CQE_FIELD_LOC(159, 128)\n#define CQE_SMAC CQE_FIELD_LOC(207, 160)\n#define CQE_PORT_TYPE CQE_FIELD_LOC(209, 208)\n#define CQE_VID CQE_FIELD_LOC(221, 210)\n#define CQE_VID_VLD CQE_FIELD_LOC(222, 222)\n#define CQE_RSV2 CQE_FIELD_LOC(223, 223)\n#define CQE_RMT_QPN CQE_FIELD_LOC(247, 224)\n#define CQE_SL CQE_FIELD_LOC(250, 248)\n#define CQE_PORTN CQE_FIELD_LOC(253, 251)\n#define CQE_GRH CQE_FIELD_LOC(254, 254)\n#define CQE_LPK CQE_FIELD_LOC(255, 255)\n#define CQE_RSV3 CQE_FIELD_LOC(511, 256)\n\nstruct hns_roce_v2_mpt_entry {\n\t__le32\tbyte_4_pd_hop_st;\n\t__le32\tbyte_8_mw_cnt_en;\n\t__le32\tbyte_12_mw_pa;\n\t__le32\tbound_lkey;\n\t__le32\tlen_l;\n\t__le32\tlen_h;\n\t__le32\tlkey;\n\t__le32\tva_l;\n\t__le32\tva_h;\n\t__le32\tpbl_size;\n\t__le32\tpbl_ba_l;\n\t__le32\tbyte_48_mode_ba;\n\t__le32\tpa0_l;\n\t__le32\tbyte_56_pa0_h;\n\t__le32\tpa1_l;\n\t__le32\tbyte_64_buf_pa1;\n};\n\n#define MPT_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_mpt_entry, h, l)\n\n#define MPT_ST MPT_FIELD_LOC(1, 0)\n#define MPT_PBL_HOP_NUM MPT_FIELD_LOC(3, 2)\n#define MPT_PBL_BA_PG_SZ MPT_FIELD_LOC(7, 4)\n#define MPT_PD MPT_FIELD_LOC(31, 8)\n#define MPT_RA_EN MPT_FIELD_LOC(32, 32)\n#define MPT_R_INV_EN MPT_FIELD_LOC(33, 33)\n#define MPT_L_INV_EN MPT_FIELD_LOC(34, 34)\n#define MPT_BIND_EN MPT_FIELD_LOC(35, 35)\n#define MPT_ATOMIC_EN MPT_FIELD_LOC(36, 36)\n#define MPT_RR_EN MPT_FIELD_LOC(37, 37)\n#define MPT_RW_EN MPT_FIELD_LOC(38, 38)\n#define MPT_LW_EN MPT_FIELD_LOC(39, 39)\n#define MPT_MW_CNT MPT_FIELD_LOC(63, 40)\n#define MPT_FRE MPT_FIELD_LOC(64, 64)\n#define MPT_PA MPT_FIELD_LOC(65, 65)\n#define MPT_ZBVA MPT_FIELD_LOC(66, 66)\n#define MPT_SHARE MPT_FIELD_LOC(67, 67)\n#define MPT_MR_MW MPT_FIELD_LOC(68, 68)\n#define MPT_BPD MPT_FIELD_LOC(69, 69)\n#define MPT_BQP MPT_FIELD_LOC(70, 70)\n#define MPT_INNER_PA_VLD MPT_FIELD_LOC(71, 71)\n#define MPT_MW_BIND_QPN MPT_FIELD_LOC(95, 72)\n#define MPT_BOUND_LKEY MPT_FIELD_LOC(127, 96)\n#define MPT_LEN_L MPT_FIELD_LOC(159, 128)\n#define MPT_LEN_H MPT_FIELD_LOC(191, 160)\n#define MPT_LKEY MPT_FIELD_LOC(223, 192)\n#define MPT_VA MPT_FIELD_LOC(287, 224)\n#define MPT_PBL_SIZE MPT_FIELD_LOC(319, 288)\n#define MPT_PBL_BA_L MPT_FIELD_LOC(351, 320)\n#define MPT_PBL_BA_H MPT_FIELD_LOC(380, 352)\n#define MPT_BLK_MODE MPT_FIELD_LOC(381, 381)\n#define MPT_RSV0 MPT_FIELD_LOC(383, 382)\n#define MPT_PA0_L MPT_FIELD_LOC(415, 384)\n#define MPT_PA0_H MPT_FIELD_LOC(441, 416)\n#define MPT_BOUND_VA MPT_FIELD_LOC(447, 442)\n#define MPT_PA1_L MPT_FIELD_LOC(479, 448)\n#define MPT_PA1_H MPT_FIELD_LOC(505, 480)\n#define MPT_PERSIST_EN MPT_FIELD_LOC(506, 506)\n#define MPT_RSV2 MPT_FIELD_LOC(507, 507)\n#define MPT_PBL_BUF_PG_SZ MPT_FIELD_LOC(511, 508)\n\n#define V2_MPT_BYTE_4_MPT_ST_S 0\n#define V2_MPT_BYTE_4_MPT_ST_M GENMASK(1, 0)\n\n#define V2_MPT_BYTE_4_PBL_HOP_NUM_S 2\n#define V2_MPT_BYTE_4_PBL_HOP_NUM_M GENMASK(3, 2)\n\n#define V2_MPT_BYTE_4_PBL_BA_PG_SZ_S 4\n#define V2_MPT_BYTE_4_PBL_BA_PG_SZ_M GENMASK(7, 4)\n\n#define V2_MPT_BYTE_4_PD_S 8\n#define V2_MPT_BYTE_4_PD_M GENMASK(31, 8)\n\n#define V2_MPT_BYTE_8_RA_EN_S 0\n\n#define V2_MPT_BYTE_8_R_INV_EN_S 1\n\n#define V2_MPT_BYTE_8_L_INV_EN_S 2\n\n#define V2_MPT_BYTE_8_BIND_EN_S 3\n\n#define V2_MPT_BYTE_8_ATOMIC_EN_S 4\n\n#define V2_MPT_BYTE_8_RR_EN_S 5\n\n#define V2_MPT_BYTE_8_RW_EN_S 6\n\n#define V2_MPT_BYTE_8_LW_EN_S 7\n\n#define V2_MPT_BYTE_8_MW_CNT_S 8\n#define V2_MPT_BYTE_8_MW_CNT_M GENMASK(31, 8)\n\n#define V2_MPT_BYTE_12_FRE_S 0\n\n#define V2_MPT_BYTE_12_PA_S 1\n\n#define V2_MPT_BYTE_12_MR_MW_S 4\n\n#define V2_MPT_BYTE_12_BPD_S 5\n\n#define V2_MPT_BYTE_12_BQP_S 6\n\n#define V2_MPT_BYTE_12_INNER_PA_VLD_S 7\n\n#define V2_MPT_BYTE_12_MW_BIND_QPN_S 8\n#define V2_MPT_BYTE_12_MW_BIND_QPN_M GENMASK(31, 8)\n\n#define V2_MPT_BYTE_48_PBL_BA_H_S 0\n#define V2_MPT_BYTE_48_PBL_BA_H_M GENMASK(28, 0)\n\n#define V2_MPT_BYTE_48_BLK_MODE_S 29\n\n#define V2_MPT_BYTE_56_PA0_H_S 0\n#define V2_MPT_BYTE_56_PA0_H_M GENMASK(25, 0)\n\n#define V2_MPT_BYTE_64_PA1_H_S 0\n#define V2_MPT_BYTE_64_PA1_H_M GENMASK(25, 0)\n\n#define V2_MPT_BYTE_64_PBL_BUF_PG_SZ_S 28\n#define V2_MPT_BYTE_64_PBL_BUF_PG_SZ_M GENMASK(31, 28)\n\nstruct hns_roce_v2_db {\n\t__le32\tdata[2];\n};\n\n#define DB_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_db, h, l)\n\n#define DB_TAG DB_FIELD_LOC(23, 0)\n#define DB_CMD DB_FIELD_LOC(27, 24)\n#define DB_FLAG DB_FIELD_LOC(31, 31)\n#define DB_PI DB_FIELD_LOC(47, 32)\n#define DB_SL DB_FIELD_LOC(50, 48)\n#define DB_CQ_CI DB_FIELD_LOC(55, 32)\n#define DB_CQ_NOTIFY DB_FIELD_LOC(56, 56)\n#define DB_CQ_CMD_SN DB_FIELD_LOC(58, 57)\n#define EQ_DB_TAG DB_FIELD_LOC(7, 0)\n#define EQ_DB_CMD DB_FIELD_LOC(17, 16)\n#define EQ_DB_CI DB_FIELD_LOC(55, 32)\n\n#define V2_DB_PRODUCER_IDX_S 0\n#define V2_DB_PRODUCER_IDX_M GENMASK(15, 0)\n\n#define V2_CQ_DB_CONS_IDX_S 0\n#define V2_CQ_DB_CONS_IDX_M GENMASK(23, 0)\n\nstruct hns_roce_v2_ud_send_wqe {\n\t__le32\tbyte_4;\n\t__le32\tmsg_len;\n\t__le32\timmtdata;\n\t__le32\tbyte_16;\n\t__le32\tbyte_20;\n\t__le32\tbyte_24;\n\t__le32\tqkey;\n\t__le32\tbyte_32;\n\t__le32\tbyte_36;\n\t__le32\tbyte_40;\n\tu8\tdmac[ETH_ALEN];\n\tu8\tsgid_index;\n\tu8\tsmac_index;\n\tu8\tdgid[GID_LEN_V2];\n};\n\n#define UD_SEND_WQE_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_ud_send_wqe, h, l)\n\n#define UD_SEND_WQE_OPCODE UD_SEND_WQE_FIELD_LOC(4, 0)\n#define UD_SEND_WQE_OWNER UD_SEND_WQE_FIELD_LOC(7, 7)\n#define UD_SEND_WQE_CQE UD_SEND_WQE_FIELD_LOC(8, 8)\n#define UD_SEND_WQE_SE UD_SEND_WQE_FIELD_LOC(11, 11)\n#define UD_SEND_WQE_PD UD_SEND_WQE_FIELD_LOC(119, 96)\n#define UD_SEND_WQE_SGE_NUM UD_SEND_WQE_FIELD_LOC(127, 120)\n#define UD_SEND_WQE_MSG_START_SGE_IDX UD_SEND_WQE_FIELD_LOC(151, 128)\n#define UD_SEND_WQE_UDPSPN UD_SEND_WQE_FIELD_LOC(191, 176)\n#define UD_SEND_WQE_DQPN UD_SEND_WQE_FIELD_LOC(247, 224)\n#define UD_SEND_WQE_VLAN UD_SEND_WQE_FIELD_LOC(271, 256)\n#define UD_SEND_WQE_HOPLIMIT UD_SEND_WQE_FIELD_LOC(279, 272)\n#define UD_SEND_WQE_TCLASS UD_SEND_WQE_FIELD_LOC(287, 280)\n#define UD_SEND_WQE_FLOW_LABEL UD_SEND_WQE_FIELD_LOC(307, 288)\n#define UD_SEND_WQE_SL UD_SEND_WQE_FIELD_LOC(311, 308)\n#define UD_SEND_WQE_VLAN_EN UD_SEND_WQE_FIELD_LOC(318, 318)\n#define UD_SEND_WQE_LBI UD_SEND_WQE_FIELD_LOC(319, 319)\n\nstruct hns_roce_v2_rc_send_wqe {\n\t__le32\t\tbyte_4;\n\t__le32\t\tmsg_len;\n\tunion {\n\t\t__le32  inv_key;\n\t\t__le32  immtdata;\n\t};\n\t__le32\t\tbyte_16;\n\t__le32\t\tbyte_20;\n\t__le32\t\trkey;\n\t__le64\t\tva;\n};\n\n#define RC_SEND_WQE_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_v2_rc_send_wqe, h, l)\n\n#define RC_SEND_WQE_OPCODE RC_SEND_WQE_FIELD_LOC(4, 0)\n#define RC_SEND_WQE_DB_SL_L RC_SEND_WQE_FIELD_LOC(6, 5)\n#define RC_SEND_WQE_DB_SL_H RC_SEND_WQE_FIELD_LOC(14, 13)\n#define RC_SEND_WQE_OWNER RC_SEND_WQE_FIELD_LOC(7, 7)\n#define RC_SEND_WQE_CQE RC_SEND_WQE_FIELD_LOC(8, 8)\n#define RC_SEND_WQE_FENCE RC_SEND_WQE_FIELD_LOC(9, 9)\n#define RC_SEND_WQE_SE RC_SEND_WQE_FIELD_LOC(11, 11)\n#define RC_SEND_WQE_INLINE RC_SEND_WQE_FIELD_LOC(12, 12)\n#define RC_SEND_WQE_WQE_INDEX RC_SEND_WQE_FIELD_LOC(30, 15)\n#define RC_SEND_WQE_FLAG RC_SEND_WQE_FIELD_LOC(31, 31)\n#define RC_SEND_WQE_XRC_SRQN RC_SEND_WQE_FIELD_LOC(119, 96)\n#define RC_SEND_WQE_SGE_NUM RC_SEND_WQE_FIELD_LOC(127, 120)\n#define RC_SEND_WQE_MSG_START_SGE_IDX RC_SEND_WQE_FIELD_LOC(151, 128)\n#define RC_SEND_WQE_INL_TYPE RC_SEND_WQE_FIELD_LOC(159, 159)\n\nstruct hns_roce_wqe_frmr_seg {\n\t__le32\tpbl_size;\n\t__le32\tbyte_40;\n};\n\n#define FRMR_WQE_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_wqe_frmr_seg, h, l)\n\n#define FRMR_PBL_SIZE FRMR_WQE_FIELD_LOC(31, 0)\n#define FRMR_BLOCK_SIZE FRMR_WQE_FIELD_LOC(35, 32)\n#define FRMR_PBL_BUF_PG_SZ FRMR_WQE_FIELD_LOC(39, 36)\n#define FRMR_BLK_MODE FRMR_WQE_FIELD_LOC(40, 40)\n#define FRMR_ZBVA FRMR_WQE_FIELD_LOC(41, 41)\n#define FRMR_BIND_EN FRMR_WQE_FIELD_LOC(42, 42)\n#define FRMR_ATOMIC FRMR_WQE_FIELD_LOC(43, 43)\n#define FRMR_RR FRMR_WQE_FIELD_LOC(44, 44)\n#define FRMR_RW FRMR_WQE_FIELD_LOC(45, 45)\n#define FRMR_LW FRMR_WQE_FIELD_LOC(46, 46)\n\nstruct hns_roce_v2_wqe_data_seg {\n\t__le32    len;\n\t__le32    lkey;\n\t__le64    addr;\n};\n\nstruct hns_roce_query_version {\n\t__le16 rocee_vendor_id;\n\t__le16 rocee_hw_version;\n\t__le32 rsv[5];\n};\n\nstruct hns_roce_query_fw_info {\n\t__le32 fw_ver;\n\t__le32 rsv[5];\n};\n\nstruct hns_roce_func_clear {\n\t__le32 rst_funcid_en;\n\t__le32 func_done;\n\t__le32 rsv[4];\n};\n\n#define FUNC_CLEAR_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_func_clear, h, l)\n\n#define FUNC_CLEAR_RST_FUN_DONE FUNC_CLEAR_FIELD_LOC(32, 32)\n\n \n#define HNS_ROCE_V2_FUNC_CLEAR_TIMEOUT_MSECS\t(249 * 2 * 100)\n#define HNS_ROCE_V2_READ_FUNC_CLEAR_FLAG_INTERVAL\t40\n#define HNS_ROCE_V2_READ_FUNC_CLEAR_FLAG_FAIL_WAIT\t20\n\n#define CFG_LLM_A_BA_L CMQ_REQ_FIELD_LOC(31, 0)\n#define CFG_LLM_A_BA_H CMQ_REQ_FIELD_LOC(63, 32)\n#define CFG_LLM_A_DEPTH CMQ_REQ_FIELD_LOC(76, 64)\n#define CFG_LLM_A_PGSZ CMQ_REQ_FIELD_LOC(83, 80)\n#define CFG_LLM_A_INIT_EN CMQ_REQ_FIELD_LOC(84, 84)\n#define CFG_LLM_A_HEAD_BA_L CMQ_REQ_FIELD_LOC(127, 96)\n#define CFG_LLM_A_HEAD_BA_H CMQ_REQ_FIELD_LOC(147, 128)\n#define CFG_LLM_A_HEAD_NXTPTR CMQ_REQ_FIELD_LOC(159, 148)\n#define CFG_LLM_A_HEAD_PTR CMQ_REQ_FIELD_LOC(171, 160)\n#define CFG_LLM_B_TAIL_BA_L CMQ_REQ_FIELD_LOC(31, 0)\n#define CFG_LLM_B_TAIL_BA_H CMQ_REQ_FIELD_LOC(63, 32)\n#define CFG_LLM_B_TAIL_PTR CMQ_REQ_FIELD_LOC(75, 64)\n\n \n#define CFG_GLOBAL_PARAM_1US_CYCLES CMQ_REQ_FIELD_LOC(9, 0)\n#define CFG_GLOBAL_PARAM_UDP_PORT CMQ_REQ_FIELD_LOC(31, 16)\n\n \n#define FUNC_RES_A_VF_ID CMQ_REQ_FIELD_LOC(7, 0)\n#define FUNC_RES_A_QPC_BT_IDX CMQ_REQ_FIELD_LOC(42, 32)\n#define FUNC_RES_A_QPC_BT_NUM CMQ_REQ_FIELD_LOC(59, 48)\n#define FUNC_RES_A_SRQC_BT_IDX CMQ_REQ_FIELD_LOC(72, 64)\n#define FUNC_RES_A_SRQC_BT_NUM CMQ_REQ_FIELD_LOC(89, 80)\n#define FUNC_RES_A_CQC_BT_IDX CMQ_REQ_FIELD_LOC(104, 96)\n#define FUNC_RES_A_CQC_BT_NUM CMQ_REQ_FIELD_LOC(121, 112)\n#define FUNC_RES_A_MPT_BT_IDX CMQ_REQ_FIELD_LOC(136, 128)\n#define FUNC_RES_A_MPT_BT_NUM CMQ_REQ_FIELD_LOC(153, 144)\n#define FUNC_RES_A_EQC_BT_IDX CMQ_REQ_FIELD_LOC(168, 160)\n#define FUNC_RES_A_EQC_BT_NUM CMQ_REQ_FIELD_LOC(185, 176)\n#define FUNC_RES_B_SMAC_IDX CMQ_REQ_FIELD_LOC(39, 32)\n#define FUNC_RES_B_SMAC_NUM CMQ_REQ_FIELD_LOC(48, 40)\n#define FUNC_RES_B_SGID_IDX CMQ_REQ_FIELD_LOC(71, 64)\n#define FUNC_RES_B_SGID_NUM CMQ_REQ_FIELD_LOC(80, 72)\n#define FUNC_RES_B_QID_IDX CMQ_REQ_FIELD_LOC(105, 96)\n#define FUNC_RES_B_QID_NUM CMQ_REQ_FIELD_LOC(122, 112)\n#define FUNC_RES_V_QID_NUM CMQ_REQ_FIELD_LOC(115, 112)\n\n#define FUNC_RES_B_SCCC_BT_IDX CMQ_REQ_FIELD_LOC(136, 128)\n#define FUNC_RES_B_SCCC_BT_NUM CMQ_REQ_FIELD_LOC(145, 137)\n#define FUNC_RES_B_GMV_BT_IDX CMQ_REQ_FIELD_LOC(167, 160)\n#define FUNC_RES_B_GMV_BT_NUM CMQ_REQ_FIELD_LOC(176, 168)\n#define FUNC_RES_V_GMV_BT_NUM CMQ_REQ_FIELD_LOC(184, 176)\n\n \n#define PF_TIMER_RES_QPC_ITEM_IDX CMQ_REQ_FIELD_LOC(43, 32)\n#define PF_TIMER_RES_QPC_ITEM_NUM CMQ_REQ_FIELD_LOC(60, 48)\n#define PF_TIMER_RES_CQC_ITEM_IDX CMQ_REQ_FIELD_LOC(74, 64)\n#define PF_TIMER_RES_CQC_ITEM_NUM CMQ_REQ_FIELD_LOC(91, 80)\n\nstruct hns_roce_vf_switch {\n\t__le32 rocee_sel;\n\t__le32 fun_id;\n\t__le32 cfg;\n\t__le32 resv1;\n\t__le32 resv2;\n\t__le32 resv3;\n};\n\n#define VF_SWITCH_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_vf_switch, h, l)\n\n#define VF_SWITCH_VF_ID VF_SWITCH_FIELD_LOC(42, 35)\n#define VF_SWITCH_ALW_LPBK VF_SWITCH_FIELD_LOC(65, 65)\n#define VF_SWITCH_ALW_LCL_LPBK VF_SWITCH_FIELD_LOC(66, 66)\n#define VF_SWITCH_ALW_DST_OVRD VF_SWITCH_FIELD_LOC(67, 67)\n\nstruct hns_roce_post_mbox {\n\t__le32\tin_param_l;\n\t__le32\tin_param_h;\n\t__le32\tout_param_l;\n\t__le32\tout_param_h;\n\t__le32\tcmd_tag;\n\t__le32\ttoken_event_en;\n};\n\nstruct hns_roce_mbox_status {\n\t__le32\tmb_status_hw_run;\n\t__le32\trsv[5];\n};\n\n#define HNS_ROCE_V2_GO_BIT_TIMEOUT_MSECS 10000\n\n#define MB_ST_HW_RUN_M BIT(31)\n#define MB_ST_COMPLETE_M GENMASK(7, 0)\n\n#define MB_ST_COMPLETE_SUCC 1\n\n \n#define CFG_BT_ATTR_QPC_BA_PGSZ CMQ_REQ_FIELD_LOC(3, 0)\n#define CFG_BT_ATTR_QPC_BUF_PGSZ CMQ_REQ_FIELD_LOC(7, 4)\n#define CFG_BT_ATTR_QPC_HOPNUM CMQ_REQ_FIELD_LOC(9, 8)\n#define CFG_BT_ATTR_SRQC_BA_PGSZ CMQ_REQ_FIELD_LOC(35, 32)\n#define CFG_BT_ATTR_SRQC_BUF_PGSZ CMQ_REQ_FIELD_LOC(39, 36)\n#define CFG_BT_ATTR_SRQC_HOPNUM CMQ_REQ_FIELD_LOC(41, 40)\n#define CFG_BT_ATTR_CQC_BA_PGSZ CMQ_REQ_FIELD_LOC(67, 64)\n#define CFG_BT_ATTR_CQC_BUF_PGSZ CMQ_REQ_FIELD_LOC(71, 68)\n#define CFG_BT_ATTR_CQC_HOPNUM CMQ_REQ_FIELD_LOC(73, 72)\n#define CFG_BT_ATTR_MPT_BA_PGSZ CMQ_REQ_FIELD_LOC(99, 96)\n#define CFG_BT_ATTR_MPT_BUF_PGSZ CMQ_REQ_FIELD_LOC(103, 100)\n#define CFG_BT_ATTR_MPT_HOPNUM CMQ_REQ_FIELD_LOC(105, 104)\n#define CFG_BT_ATTR_SCCC_BA_PGSZ CMQ_REQ_FIELD_LOC(131, 128)\n#define CFG_BT_ATTR_SCCC_BUF_PGSZ CMQ_REQ_FIELD_LOC(135, 132)\n#define CFG_BT_ATTR_SCCC_HOPNUM CMQ_REQ_FIELD_LOC(137, 136)\n\n \n#define CFG_HEM_ENTRY_SIZE_TYPE CMQ_REQ_FIELD_LOC(31, 0)\nenum {\n\tHNS_ROCE_CFG_QPC_SIZE = BIT(0),\n\tHNS_ROCE_CFG_SCCC_SIZE = BIT(1),\n};\n\n#define CFG_HEM_ENTRY_SIZE_VALUE CMQ_REQ_FIELD_LOC(191, 160)\n\n \n#define CFG_GMV_BT_BA_L CMQ_REQ_FIELD_LOC(31, 0)\n#define CFG_GMV_BT_BA_H CMQ_REQ_FIELD_LOC(51, 32)\n#define CFG_GMV_BT_IDX CMQ_REQ_FIELD_LOC(95, 64)\n\n \n#define QUERY_RAM_ECC_1BIT_ERR CMQ_REQ_FIELD_LOC(31, 0)\n#define QUERY_RAM_ECC_RES_TYPE CMQ_REQ_FIELD_LOC(63, 32)\n#define QUERY_RAM_ECC_TAG CMQ_REQ_FIELD_LOC(95, 64)\n\nstruct hns_roce_cfg_sgid_tb {\n\t__le32\ttable_idx_rsv;\n\t__le32\tvf_sgid_l;\n\t__le32\tvf_sgid_ml;\n\t__le32\tvf_sgid_mh;\n\t__le32\tvf_sgid_h;\n\t__le32\tvf_sgid_type_rsv;\n};\n\n#define SGID_TB_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_cfg_sgid_tb, h, l)\n\n#define CFG_SGID_TB_TABLE_IDX SGID_TB_FIELD_LOC(7, 0)\n#define CFG_SGID_TB_VF_SGID_TYPE SGID_TB_FIELD_LOC(161, 160)\n\nstruct hns_roce_cfg_smac_tb {\n\t__le32\ttb_idx_rsv;\n\t__le32\tvf_smac_l;\n\t__le32\tvf_smac_h_rsv;\n\t__le32\trsv[3];\n};\n\n#define SMAC_TB_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_cfg_smac_tb, h, l)\n\n#define CFG_SMAC_TB_IDX SMAC_TB_FIELD_LOC(7, 0)\n#define CFG_SMAC_TB_VF_SMAC_H SMAC_TB_FIELD_LOC(79, 64)\n\nstruct hns_roce_cfg_gmv_tb_a {\n\t__le32 vf_sgid_l;\n\t__le32 vf_sgid_ml;\n\t__le32 vf_sgid_mh;\n\t__le32 vf_sgid_h;\n\t__le32 vf_sgid_type_vlan;\n\t__le32 resv;\n};\n\n#define GMV_TB_A_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_cfg_gmv_tb_a, h, l)\n\n#define GMV_TB_A_VF_SGID_TYPE GMV_TB_A_FIELD_LOC(129, 128)\n#define GMV_TB_A_VF_VLAN_EN GMV_TB_A_FIELD_LOC(130, 130)\n#define GMV_TB_A_VF_VLAN_ID GMV_TB_A_FIELD_LOC(155, 144)\n\nstruct hns_roce_cfg_gmv_tb_b {\n\t__le32\tvf_smac_l;\n\t__le32\tvf_smac_h;\n\t__le32\ttable_idx_rsv;\n\t__le32\tresv[3];\n};\n\n#define GMV_TB_B_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_cfg_gmv_tb_b, h, l)\n\n#define GMV_TB_B_SMAC_H GMV_TB_B_FIELD_LOC(47, 32)\n#define GMV_TB_B_SGID_IDX GMV_TB_B_FIELD_LOC(71, 64)\n\n#define HNS_ROCE_QUERY_PF_CAPS_CMD_NUM 5\nstruct hns_roce_query_pf_caps_a {\n\tu8 number_ports;\n\tu8 local_ca_ack_delay;\n\t__le16 max_sq_sg;\n\t__le16 max_sq_inline;\n\t__le16 max_rq_sg;\n\t__le32 rsv0;\n\t__le16 num_qpc_timer;\n\t__le16 num_cqc_timer;\n\t__le16 max_srq_sges;\n\tu8 num_aeq_vectors;\n\tu8 num_other_vectors;\n\tu8 max_sq_desc_sz;\n\tu8 max_rq_desc_sz;\n\tu8 rsv1;\n\tu8 cqe_sz;\n};\n\nstruct hns_roce_query_pf_caps_b {\n\tu8 mtpt_entry_sz;\n\tu8 irrl_entry_sz;\n\tu8 trrl_entry_sz;\n\tu8 cqc_entry_sz;\n\tu8 srqc_entry_sz;\n\tu8 idx_entry_sz;\n\tu8 sccc_sz;\n\tu8 max_mtu;\n\t__le16 qpc_sz;\n\t__le16 qpc_timer_entry_sz;\n\t__le16 cqc_timer_entry_sz;\n\tu8 min_cqes;\n\tu8 min_wqes;\n\t__le32 page_size_cap;\n\tu8 pkey_table_len;\n\tu8 phy_num_uars;\n\tu8 ctx_hop_num;\n\tu8 pbl_hop_num;\n};\n\nstruct hns_roce_query_pf_caps_c {\n\t__le32 cap_flags_num_pds;\n\t__le32 max_gid_num_cqs;\n\t__le32 cq_depth;\n\t__le32 num_mrws;\n\t__le32 ord_num_qps;\n\t__le16 sq_depth;\n\t__le16 rq_depth;\n};\n\n#define PF_CAPS_C_FIELD_LOC(h, l) \\\n\tFIELD_LOC(struct hns_roce_query_pf_caps_c, h, l)\n\n#define PF_CAPS_C_NUM_PDS PF_CAPS_C_FIELD_LOC(19, 0)\n#define PF_CAPS_C_CAP_FLAGS PF_CAPS_C_FIELD_LOC(31, 20)\n#define PF_CAPS_C_NUM_CQS PF_CAPS_C_FIELD_LOC(51, 32)\n#define PF_CAPS_C_MAX_GID PF_CAPS_C_FIELD_LOC(60, 52)\n#define PF_CAPS_C_CQ_DEPTH PF_CAPS_C_FIELD_LOC(86, 64)\n#define PF_CAPS_C_NUM_XRCDS PF_CAPS_C_FIELD_LOC(91, 87)\n#define PF_CAPS_C_NUM_MRWS PF_CAPS_C_FIELD_LOC(115, 96)\n#define PF_CAPS_C_NUM_QPS PF_CAPS_C_FIELD_LOC(147, 128)\n#define PF_CAPS_C_MAX_ORD PF_CAPS_C_FIELD_LOC(155, 148)\n\nstruct hns_roce_query_pf_caps_d {\n\t__le32 wq_hop_num_max_srqs;\n\t__le16 srq_depth;\n\t__le16 cap_flags_ex;\n\t__le32 num_ceqs_ceq_depth;\n\t__le32 arm_st_aeq_depth;\n\t__le32 num_uars_rsv_pds;\n\t__le32 rsv_uars_rsv_qps;\n};\n\n#define PF_CAPS_D_FIELD_LOC(h, l) \\\n\tFIELD_LOC(struct hns_roce_query_pf_caps_d, h, l)\n\n#define PF_CAPS_D_NUM_SRQS PF_CAPS_D_FIELD_LOC(19, 0)\n#define PF_CAPS_D_RQWQE_HOP_NUM PF_CAPS_D_FIELD_LOC(21, 20)\n#define PF_CAPS_D_EX_SGE_HOP_NUM PF_CAPS_D_FIELD_LOC(23, 22)\n#define PF_CAPS_D_SQWQE_HOP_NUM PF_CAPS_D_FIELD_LOC(25, 24)\n#define PF_CAPS_D_CONG_TYPE PF_CAPS_D_FIELD_LOC(29, 26)\n#define PF_CAPS_D_CEQ_DEPTH PF_CAPS_D_FIELD_LOC(85, 64)\n#define PF_CAPS_D_NUM_CEQS PF_CAPS_D_FIELD_LOC(95, 86)\n#define PF_CAPS_D_AEQ_DEPTH PF_CAPS_D_FIELD_LOC(117, 96)\n#define PF_CAPS_D_AEQ_ARM_ST PF_CAPS_D_FIELD_LOC(119, 118)\n#define PF_CAPS_D_CEQ_ARM_ST PF_CAPS_D_FIELD_LOC(121, 120)\n#define PF_CAPS_D_RSV_PDS PF_CAPS_D_FIELD_LOC(147, 128)\n#define PF_CAPS_D_NUM_UARS PF_CAPS_D_FIELD_LOC(155, 148)\n#define PF_CAPS_D_RSV_QPS PF_CAPS_D_FIELD_LOC(179, 160)\n#define PF_CAPS_D_RSV_UARS PF_CAPS_D_FIELD_LOC(187, 180)\n\n#define HNS_ROCE_CAP_FLAGS_EX_SHIFT 12\n\nstruct hns_roce_congestion_algorithm {\n\tu8 alg_sel;\n\tu8 alg_sub_sel;\n\tu8 dip_vld;\n\tu8 wnd_mode_sel;\n};\n\nstruct hns_roce_query_pf_caps_e {\n\t__le32 chunk_size_shift_rsv_mrws;\n\t__le32 rsv_cqs;\n\t__le32 rsv_srqs;\n\t__le32 rsv_lkey;\n\t__le16 ceq_max_cnt;\n\t__le16 ceq_period;\n\t__le16 aeq_max_cnt;\n\t__le16 aeq_period;\n};\n\n#define PF_CAPS_E_FIELD_LOC(h, l) \\\n\tFIELD_LOC(struct hns_roce_query_pf_caps_e, h, l)\n\n#define PF_CAPS_E_RSV_MRWS PF_CAPS_E_FIELD_LOC(19, 0)\n#define PF_CAPS_E_CHUNK_SIZE_SHIFT PF_CAPS_E_FIELD_LOC(31, 20)\n#define PF_CAPS_E_RSV_CQS PF_CAPS_E_FIELD_LOC(51, 32)\n#define PF_CAPS_E_RSV_XRCDS PF_CAPS_E_FIELD_LOC(63, 52)\n#define PF_CAPS_E_RSV_SRQS PF_CAPS_E_FIELD_LOC(83, 64)\n#define PF_CAPS_E_RSV_LKEYS PF_CAPS_E_FIELD_LOC(115, 96)\n\nstruct hns_roce_cmq_req {\n\t__le32 data[6];\n};\n\n#define CMQ_REQ_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_cmq_req, h, l)\n\nstruct hns_roce_cmq_desc {\n\t__le16 opcode;\n\t__le16 flag;\n\t__le16 retval;\n\t__le16 rsv;\n\tunion {\n\t\t__le32 data[6];\n\t\tstruct {\n\t\t\t__le32 own_func_num;\n\t\t\t__le32 own_mac_id;\n\t\t\t__le32 rsv[4];\n\t\t} func_info;\n\t};\n};\n\nstruct hns_roce_v2_cmq_ring {\n\tdma_addr_t desc_dma_addr;\n\tstruct hns_roce_cmq_desc *desc;\n\tu32 head;\n\tu16 buf_size;\n\tu16 desc_num;\n\tu8 flag;\n\tspinlock_t lock;  \n};\n\nstruct hns_roce_v2_cmq {\n\tstruct hns_roce_v2_cmq_ring csq;\n\tu16 tx_timeout;\n};\n\nstruct hns_roce_link_table {\n\tstruct hns_roce_buf_list table;\n\tstruct hns_roce_buf *buf;\n};\n\n#define HNS_ROCE_EXT_LLM_ENTRY(addr, id) (((id) << (64 - 12)) | ((addr) >> 12))\n#define HNS_ROCE_EXT_LLM_MIN_PAGES(que_num) ((que_num) * 4 + 2)\n\nstruct hns_roce_v2_free_mr {\n\tstruct hns_roce_qp *rsv_qp[HNS_ROCE_FREE_MR_USED_QP_NUM];\n\tstruct hns_roce_cq *rsv_cq;\n\tstruct hns_roce_pd *rsv_pd;\n\tstruct mutex mutex;\n};\n\nstruct hns_roce_v2_priv {\n\tstruct hnae3_handle *handle;\n\tstruct hns_roce_v2_cmq cmq;\n\tstruct hns_roce_link_table ext_llm;\n\tstruct hns_roce_v2_free_mr free_mr;\n};\n\nstruct hns_roce_dip {\n\tu8 dgid[GID_LEN_V2];\n\tu32 dip_idx;\n\tstruct list_head node;  \n};\n\nstruct fmea_ram_ecc {\n\tu32\tis_ecc_err;\n\tu32\tres_type;\n\tu32\tindex;\n};\n\n \n#define HNS_ROCE_CLOCK_ADJUST 1000\n#define HNS_ROCE_MAX_CQ_PERIOD 65\n#define HNS_ROCE_MAX_EQ_PERIOD 65\n#define HNS_ROCE_RNR_TIMER_10NS 1\n#define HNS_ROCE_1US_CFG 999\n#define HNS_ROCE_1NS_CFG 0\n\n#define HNS_ROCE_AEQ_DEFAULT_BURST_NUM\t0x0\n#define HNS_ROCE_AEQ_DEFAULT_INTERVAL\t0x0\n#define HNS_ROCE_CEQ_DEFAULT_BURST_NUM\t0x0\n#define HNS_ROCE_CEQ_DEFAULT_INTERVAL\t0x0\n\n#define HNS_ROCE_V2_EQ_STATE_INVALID\t\t0\n#define HNS_ROCE_V2_EQ_STATE_VALID\t\t1\n#define HNS_ROCE_V2_EQ_STATE_OVERFLOW\t\t2\n#define HNS_ROCE_V2_EQ_STATE_FAILURE\t\t3\n\n#define HNS_ROCE_V2_EQ_OVER_IGNORE_0\t\t0\n#define HNS_ROCE_V2_EQ_OVER_IGNORE_1\t\t1\n\n#define HNS_ROCE_V2_EQ_COALESCE_0\t\t0\n#define HNS_ROCE_V2_EQ_COALESCE_1\t\t1\n\n#define HNS_ROCE_V2_EQ_FIRED\t\t\t0\n#define HNS_ROCE_V2_EQ_ARMED\t\t\t1\n#define HNS_ROCE_V2_EQ_ALWAYS_ARMED\t\t3\n\n#define HNS_ROCE_EQ_INIT_EQE_CNT\t\t0\n#define HNS_ROCE_EQ_INIT_PROD_IDX\t\t0\n#define HNS_ROCE_EQ_INIT_REPORT_TIMER\t\t0\n#define HNS_ROCE_EQ_INIT_MSI_IDX\t\t0\n#define HNS_ROCE_EQ_INIT_CONS_IDX\t\t0\n#define HNS_ROCE_EQ_INIT_NXT_EQE_BA\t\t0\n\n#define HNS_ROCE_V2_COMP_EQE_NUM\t\t0x1000\n#define HNS_ROCE_V2_ASYNC_EQE_NUM\t\t0x1000\n\n#define HNS_ROCE_V2_VF_INT_ST_AEQ_OVERFLOW_S\t0\n\n#define HNS_ROCE_EQ_DB_CMD_AEQ\t\t\t0x0\n#define HNS_ROCE_EQ_DB_CMD_AEQ_ARMED\t\t0x1\n#define HNS_ROCE_EQ_DB_CMD_CEQ\t\t\t0x2\n#define HNS_ROCE_EQ_DB_CMD_CEQ_ARMED\t\t0x3\n\n#define EQ_ENABLE\t\t\t\t1\n#define EQ_DISABLE\t\t\t\t0\n\n#define EQ_REG_OFFSET\t\t\t\t0x4\n\n#define HNS_ROCE_INT_NAME_LEN\t\t\t32\n#define HNS_ROCE_V2_EQN_M GENMASK(23, 0)\n\n#define HNS_ROCE_V2_VF_ABN_INT_EN_S 0\n#define HNS_ROCE_V2_VF_ABN_INT_EN_M GENMASK(0, 0)\n#define HNS_ROCE_V2_VF_ABN_INT_ST_M GENMASK(2, 0)\n#define HNS_ROCE_V2_VF_ABN_INT_CFG_M GENMASK(2, 0)\n#define HNS_ROCE_V2_VF_EVENT_INT_EN_M GENMASK(0, 0)\n\nstruct hns_roce_eq_context {\n\t__le32\tdata[16];\n};\n\n#define EQC_FIELD_LOC(h, l) FIELD_LOC(struct hns_roce_eq_context, h, l)\n\n#define EQC_EQ_ST EQC_FIELD_LOC(1, 0)\n#define EQC_EQE_HOP_NUM EQC_FIELD_LOC(3, 2)\n#define EQC_OVER_IGNORE EQC_FIELD_LOC(4, 4)\n#define EQC_COALESCE EQC_FIELD_LOC(5, 5)\n#define EQC_ARM_ST EQC_FIELD_LOC(7, 6)\n#define EQC_EQN EQC_FIELD_LOC(15, 8)\n#define EQC_EQE_CNT EQC_FIELD_LOC(31, 16)\n#define EQC_EQE_BA_PG_SZ EQC_FIELD_LOC(35, 32)\n#define EQC_EQE_BUF_PG_SZ EQC_FIELD_LOC(39, 36)\n#define EQC_EQ_PROD_INDX EQC_FIELD_LOC(63, 40)\n#define EQC_EQ_MAX_CNT EQC_FIELD_LOC(79, 64)\n#define EQC_EQ_PERIOD EQC_FIELD_LOC(95, 80)\n#define EQC_EQE_REPORT_TIMER EQC_FIELD_LOC(127, 96)\n#define EQC_EQE_BA_L EQC_FIELD_LOC(159, 128)\n#define EQC_EQE_BA_H EQC_FIELD_LOC(188, 160)\n#define EQC_SHIFT EQC_FIELD_LOC(199, 192)\n#define EQC_MSI_INDX EQC_FIELD_LOC(207, 200)\n#define EQC_CUR_EQE_BA_L EQC_FIELD_LOC(223, 208)\n#define EQC_CUR_EQE_BA_M EQC_FIELD_LOC(255, 224)\n#define EQC_CUR_EQE_BA_H EQC_FIELD_LOC(259, 256)\n#define EQC_EQ_CONS_INDX EQC_FIELD_LOC(287, 264)\n#define EQC_NEX_EQE_BA_L EQC_FIELD_LOC(319, 288)\n#define EQC_NEX_EQE_BA_H EQC_FIELD_LOC(339, 320)\n#define EQC_EQE_SIZE EQC_FIELD_LOC(341, 340)\n\n#define MAX_SERVICE_LEVEL 0x7\n\nstruct hns_roce_wqe_atomic_seg {\n\t__le64          fetchadd_swap_data;\n\t__le64          cmp_data;\n};\n\nstruct hns_roce_sccc_clr {\n\t__le32 qpn;\n\t__le32 rsv[5];\n};\n\nstruct hns_roce_sccc_clr_done {\n\t__le32 clr_done;\n\t__le32 rsv[5];\n};\n\nint hns_roce_v2_destroy_qp(struct ib_qp *ibqp, struct ib_udata *udata);\n\nstatic inline void hns_roce_write64(struct hns_roce_dev *hr_dev, __le32 val[2],\n\t\t\t\t    void __iomem *dest)\n{\n\tstruct hns_roce_v2_priv *priv = hr_dev->priv;\n\tstruct hnae3_handle *handle = priv->handle;\n\tconst struct hnae3_ae_ops *ops = handle->ae_algo->ops;\n\n\tif (!hr_dev->dis_db && !ops->get_hw_reset_stat(handle))\n\t\thns_roce_write64_k(val, dest);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}