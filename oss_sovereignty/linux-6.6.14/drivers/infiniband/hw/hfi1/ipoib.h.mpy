{
  "module_name": "ipoib.h",
  "hash_id": "d18f03da918bedca5b02b439695f354c11440d3f98df25d3899edf2ad0f32926",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/hfi1/ipoib.h",
  "human_readable_source": " \n \n\n \n\n#ifndef HFI1_IPOIB_H\n#define HFI1_IPOIB_H\n\n#include <linux/types.h>\n#include <linux/stddef.h>\n#include <linux/atomic.h>\n#include <linux/netdevice.h>\n#include <linux/slab.h>\n#include <linux/skbuff.h>\n#include <linux/list.h>\n#include <linux/if_infiniband.h>\n\n#include \"hfi.h\"\n#include \"iowait.h\"\n#include \"netdev.h\"\n\n#include <rdma/ib_verbs.h>\n\n#define HFI1_IPOIB_ENTROPY_SHIFT   24\n\n#define HFI1_IPOIB_TXREQ_NAME_LEN   32\n\n#define HFI1_IPOIB_PSEUDO_LEN 20\n#define HFI1_IPOIB_ENCAP_LEN 4\n\nstruct hfi1_ipoib_dev_priv;\n\nunion hfi1_ipoib_flow {\n\tu16 as_int;\n\tstruct {\n\t\tu8 tx_queue;\n\t\tu8 sc5;\n\t} __attribute__((__packed__));\n};\n\n \nstruct ipoib_txreq {\n\tstruct sdma_txreq           txreq;\n\tstruct hfi1_sdma_header     *sdma_hdr;\n\tint                         sdma_status;\n\tint                         complete;\n\tstruct hfi1_ipoib_dev_priv *priv;\n\tstruct hfi1_ipoib_txq      *txq;\n\tstruct sk_buff             *skb;\n};\n\n \nstruct hfi1_ipoib_circ_buf {\n\tvoid *items;\n\tu32 max_items;\n\tu32 shift;\n\t \n\tu64 ____cacheline_aligned_in_smp sent_txreqs;\n\tu32 avail;\n\tu32 tail;\n\tatomic_t stops;\n\tatomic_t ring_full;\n\tatomic_t no_desc;\n\t \n\tu64 ____cacheline_aligned_in_smp complete_txreqs;\n\tu32 head;\n};\n\n \nstruct hfi1_ipoib_txq {\n\tstruct napi_struct napi;\n\tstruct hfi1_ipoib_dev_priv *priv;\n\tstruct sdma_engine *sde;\n\tstruct list_head tx_list;\n\tunion hfi1_ipoib_flow flow;\n\tu8 q_idx;\n\tbool pkts_sent;\n\tstruct iowait wait;\n\n\tstruct hfi1_ipoib_circ_buf ____cacheline_aligned_in_smp tx_ring;\n};\n\nstruct hfi1_ipoib_dev_priv {\n\tstruct hfi1_devdata *dd;\n\tstruct net_device   *netdev;\n\tstruct ib_device    *device;\n\tstruct hfi1_ipoib_txq *txqs;\n\tconst struct net_device_ops *netdev_ops;\n\tstruct rvt_qp *qp;\n\tu32 qkey;\n\tu16 pkey;\n\tu16 pkey_index;\n\tu8 port_num;\n};\n\n \nstruct hfi1_ipoib_rdma_netdev {\n\tstruct rdma_netdev rn;   \n\t \n\tstruct hfi1_ipoib_dev_priv dev_priv;\n};\n\nstatic inline struct hfi1_ipoib_dev_priv *\nhfi1_ipoib_priv(const struct net_device *dev)\n{\n\treturn &((struct hfi1_ipoib_rdma_netdev *)netdev_priv(dev))->dev_priv;\n}\n\nint hfi1_ipoib_send(struct net_device *dev,\n\t\t    struct sk_buff *skb,\n\t\t    struct ib_ah *address,\n\t\t    u32 dqpn);\n\nint hfi1_ipoib_txreq_init(struct hfi1_ipoib_dev_priv *priv);\nvoid hfi1_ipoib_txreq_deinit(struct hfi1_ipoib_dev_priv *priv);\n\nint hfi1_ipoib_rxq_init(struct net_device *dev);\nvoid hfi1_ipoib_rxq_deinit(struct net_device *dev);\n\nvoid hfi1_ipoib_napi_tx_enable(struct net_device *dev);\nvoid hfi1_ipoib_napi_tx_disable(struct net_device *dev);\n\nstruct sk_buff *hfi1_ipoib_prepare_skb(struct hfi1_netdev_rxq *rxq,\n\t\t\t\t       int size, void *data);\n\nint hfi1_ipoib_rn_get_params(struct ib_device *device,\n\t\t\t     u32 port_num,\n\t\t\t     enum rdma_netdev_t type,\n\t\t\t     struct rdma_netdev_alloc_params *params);\n\nvoid hfi1_ipoib_tx_timeout(struct net_device *dev, unsigned int q);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}