{
  "module_name": "platform.h",
  "hash_id": "ac9362c8b1deac51af4d78eae57a70a2cfa1e9dc785913a54b65b975a70880dd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/hfi1/platform.h",
  "human_readable_source": " \n \n\n#ifndef __PLATFORM_H\n#define __PLATFORM_H\n\n#define METADATA_TABLE_FIELD_START_SHIFT\t\t0\n#define METADATA_TABLE_FIELD_START_LEN_BITS\t\t15\n#define METADATA_TABLE_FIELD_LEN_SHIFT\t\t\t16\n#define METADATA_TABLE_FIELD_LEN_LEN_BITS\t\t16\n\n \n#define PLATFORM_CONFIG_HEADER_RECORD_IDX_SHIFT\t\t\t0\n#define PLATFORM_CONFIG_HEADER_RECORD_IDX_LEN_BITS\t\t6\n#define PLATFORM_CONFIG_HEADER_TABLE_LENGTH_SHIFT\t\t16\n#define PLATFORM_CONFIG_HEADER_TABLE_LENGTH_LEN_BITS\t\t12\n#define PLATFORM_CONFIG_HEADER_TABLE_TYPE_SHIFT\t\t\t28\n#define PLATFORM_CONFIG_HEADER_TABLE_TYPE_LEN_BITS\t\t4\n\nenum platform_config_table_type_encoding {\n\tPLATFORM_CONFIG_TABLE_RESERVED,\n\tPLATFORM_CONFIG_SYSTEM_TABLE,\n\tPLATFORM_CONFIG_PORT_TABLE,\n\tPLATFORM_CONFIG_RX_PRESET_TABLE,\n\tPLATFORM_CONFIG_TX_PRESET_TABLE,\n\tPLATFORM_CONFIG_QSFP_ATTEN_TABLE,\n\tPLATFORM_CONFIG_VARIABLE_SETTINGS_TABLE,\n\tPLATFORM_CONFIG_TABLE_MAX\n};\n\nenum platform_config_system_table_fields {\n\tSYSTEM_TABLE_RESERVED,\n\tSYSTEM_TABLE_NODE_STRING,\n\tSYSTEM_TABLE_SYSTEM_IMAGE_GUID,\n\tSYSTEM_TABLE_NODE_GUID,\n\tSYSTEM_TABLE_REVISION,\n\tSYSTEM_TABLE_VENDOR_OUI,\n\tSYSTEM_TABLE_META_VERSION,\n\tSYSTEM_TABLE_DEVICE_ID,\n\tSYSTEM_TABLE_PARTITION_ENFORCEMENT_CAP,\n\tSYSTEM_TABLE_QSFP_POWER_CLASS_MAX,\n\tSYSTEM_TABLE_QSFP_ATTENUATION_DEFAULT_12G,\n\tSYSTEM_TABLE_QSFP_ATTENUATION_DEFAULT_25G,\n\tSYSTEM_TABLE_VARIABLE_TABLE_ENTRIES_PER_PORT,\n\tSYSTEM_TABLE_MAX\n};\n\nenum platform_config_port_table_fields {\n\tPORT_TABLE_RESERVED,\n\tPORT_TABLE_PORT_TYPE,\n\tPORT_TABLE_LOCAL_ATTEN_12G,\n\tPORT_TABLE_LOCAL_ATTEN_25G,\n\tPORT_TABLE_LINK_SPEED_SUPPORTED,\n\tPORT_TABLE_LINK_WIDTH_SUPPORTED,\n\tPORT_TABLE_AUTO_LANE_SHEDDING_ENABLED,\n\tPORT_TABLE_EXTERNAL_LOOPBACK_ALLOWED,\n\tPORT_TABLE_VL_CAP,\n\tPORT_TABLE_MTU_CAP,\n\tPORT_TABLE_TX_LANE_ENABLE_MASK,\n\tPORT_TABLE_LOCAL_MAX_TIMEOUT,\n\tPORT_TABLE_REMOTE_ATTEN_12G,\n\tPORT_TABLE_REMOTE_ATTEN_25G,\n\tPORT_TABLE_TX_PRESET_IDX_ACTIVE_NO_EQ,\n\tPORT_TABLE_TX_PRESET_IDX_ACTIVE_EQ,\n\tPORT_TABLE_RX_PRESET_IDX,\n\tPORT_TABLE_CABLE_REACH_CLASS,\n\tPORT_TABLE_MAX\n};\n\nenum platform_config_rx_preset_table_fields {\n\tRX_PRESET_TABLE_RESERVED,\n\tRX_PRESET_TABLE_QSFP_RX_CDR_APPLY,\n\tRX_PRESET_TABLE_QSFP_RX_EMP_APPLY,\n\tRX_PRESET_TABLE_QSFP_RX_AMP_APPLY,\n\tRX_PRESET_TABLE_QSFP_RX_CDR,\n\tRX_PRESET_TABLE_QSFP_RX_EMP,\n\tRX_PRESET_TABLE_QSFP_RX_AMP,\n\tRX_PRESET_TABLE_MAX\n};\n\nenum platform_config_tx_preset_table_fields {\n\tTX_PRESET_TABLE_RESERVED,\n\tTX_PRESET_TABLE_PRECUR,\n\tTX_PRESET_TABLE_ATTN,\n\tTX_PRESET_TABLE_POSTCUR,\n\tTX_PRESET_TABLE_QSFP_TX_CDR_APPLY,\n\tTX_PRESET_TABLE_QSFP_TX_EQ_APPLY,\n\tTX_PRESET_TABLE_QSFP_TX_CDR,\n\tTX_PRESET_TABLE_QSFP_TX_EQ,\n\tTX_PRESET_TABLE_MAX\n};\n\nenum platform_config_qsfp_attn_table_fields {\n\tQSFP_ATTEN_TABLE_RESERVED,\n\tQSFP_ATTEN_TABLE_TX_PRESET_IDX,\n\tQSFP_ATTEN_TABLE_RX_PRESET_IDX,\n\tQSFP_ATTEN_TABLE_MAX\n};\n\nenum platform_config_variable_settings_table_fields {\n\tVARIABLE_SETTINGS_TABLE_RESERVED,\n\tVARIABLE_SETTINGS_TABLE_TX_PRESET_IDX,\n\tVARIABLE_SETTINGS_TABLE_RX_PRESET_IDX,\n\tVARIABLE_SETTINGS_TABLE_MAX\n};\n\nstruct platform_config {\n\tsize_t size;\n\tconst u8 *data;\n};\n\nstruct platform_config_data {\n\tu32 *table;\n\tu32 *table_metadata;\n\tu32 num_table;\n};\n\n \nstruct platform_config_cache {\n\tu8  cache_valid;\n\tstruct platform_config_data config_tables[PLATFORM_CONFIG_TABLE_MAX];\n};\n\n \n\n \n#define PLATFORM_CONFIG_MAGIC_NUM\t\t0x3d4f5041\n#define PLATFORM_CONFIG_MAGIC_NUMBER_LEN\t4\n\n \nenum platform_config_qsfp_power_class_encoding {\n\tQSFP_POWER_CLASS_1 = 1,\n\tQSFP_POWER_CLASS_2,\n\tQSFP_POWER_CLASS_3,\n\tQSFP_POWER_CLASS_4,\n\tQSFP_POWER_CLASS_5,\n\tQSFP_POWER_CLASS_6,\n\tQSFP_POWER_CLASS_7\n};\n\n \nenum platform_config_port_type_encoding {\n\tPORT_TYPE_UNKNOWN,\n\tPORT_TYPE_DISCONNECTED,\n\tPORT_TYPE_FIXED,\n\tPORT_TYPE_VARIABLE,\n\tPORT_TYPE_QSFP,\n\tPORT_TYPE_MAX\n};\n\nenum platform_config_link_speed_supported_encoding {\n\tLINK_SPEED_SUPP_12G = 1,\n\tLINK_SPEED_SUPP_25G,\n\tLINK_SPEED_SUPP_12G_25G,\n\tLINK_SPEED_SUPP_MAX\n};\n\n \nenum platform_config_link_width_supported_encoding {\n\tLINK_WIDTH_SUPP_1X = 1,\n\tLINK_WIDTH_SUPP_2X,\n\tLINK_WIDTH_SUPP_2X_1X,\n\tLINK_WIDTH_SUPP_3X,\n\tLINK_WIDTH_SUPP_3X_1X,\n\tLINK_WIDTH_SUPP_3X_2X,\n\tLINK_WIDTH_SUPP_3X_2X_1X,\n\tLINK_WIDTH_SUPP_4X,\n\tLINK_WIDTH_SUPP_4X_1X,\n\tLINK_WIDTH_SUPP_4X_2X,\n\tLINK_WIDTH_SUPP_4X_2X_1X,\n\tLINK_WIDTH_SUPP_4X_3X,\n\tLINK_WIDTH_SUPP_4X_3X_1X,\n\tLINK_WIDTH_SUPP_4X_3X_2X,\n\tLINK_WIDTH_SUPP_4X_3X_2X_1X,\n\tLINK_WIDTH_SUPP_MAX\n};\n\nenum platform_config_virtual_lane_capability_encoding {\n\tVL_CAP_VL0 = 1,\n\tVL_CAP_VL0_1,\n\tVL_CAP_VL0_2,\n\tVL_CAP_VL0_3,\n\tVL_CAP_VL0_4,\n\tVL_CAP_VL0_5,\n\tVL_CAP_VL0_6,\n\tVL_CAP_VL0_7,\n\tVL_CAP_VL0_8,\n\tVL_CAP_VL0_9,\n\tVL_CAP_VL0_10,\n\tVL_CAP_VL0_11,\n\tVL_CAP_VL0_12,\n\tVL_CAP_VL0_13,\n\tVL_CAP_VL0_14,\n\tVL_CAP_MAX\n};\n\n \nenum platform_config_mtu_capability_encoding {\n\tMTU_CAP_256   = 1,\n\tMTU_CAP_512   = 2,\n\tMTU_CAP_1024  = 3,\n\tMTU_CAP_2048  = 4,\n\tMTU_CAP_4096  = 5,\n\tMTU_CAP_8192  = 6,\n\tMTU_CAP_10240 = 7\n};\n\nenum platform_config_local_max_timeout_encoding {\n\tLOCAL_MAX_TIMEOUT_10_MS = 1,\n\tLOCAL_MAX_TIMEOUT_100_MS,\n\tLOCAL_MAX_TIMEOUT_1_S,\n\tLOCAL_MAX_TIMEOUT_10_S,\n\tLOCAL_MAX_TIMEOUT_100_S,\n\tLOCAL_MAX_TIMEOUT_1000_S\n};\n\nenum link_tuning_encoding {\n\tOPA_PASSIVE_TUNING,\n\tOPA_ACTIVE_TUNING,\n\tOPA_UNKNOWN_TUNING\n};\n\n \n#define PORT0_PORT_TYPE_SHIFT\t\t0\n#define PORT0_LOCAL_ATTEN_SHIFT\t\t4\n#define PORT0_REMOTE_ATTEN_SHIFT\t10\n#define PORT0_DEFAULT_ATTEN_SHIFT\t32\n\n#define PORT1_PORT_TYPE_SHIFT\t\t16\n#define PORT1_LOCAL_ATTEN_SHIFT\t\t20\n#define PORT1_REMOTE_ATTEN_SHIFT\t26\n#define PORT1_DEFAULT_ATTEN_SHIFT\t40\n\n#define PORT0_PORT_TYPE_MASK\t\t0xFUL\n#define PORT0_LOCAL_ATTEN_MASK\t\t0x3FUL\n#define PORT0_REMOTE_ATTEN_MASK\t\t0x3FUL\n#define PORT0_DEFAULT_ATTEN_MASK\t0xFFUL\n\n#define PORT1_PORT_TYPE_MASK\t\t0xFUL\n#define PORT1_LOCAL_ATTEN_MASK\t\t0x3FUL\n#define PORT1_REMOTE_ATTEN_MASK\t\t0x3FUL\n#define PORT1_DEFAULT_ATTEN_MASK\t0xFFUL\n\n#define PORT0_PORT_TYPE_SMASK\t\t(PORT0_PORT_TYPE_MASK << \\\n\t\t\t\t\t PORT0_PORT_TYPE_SHIFT)\n#define PORT0_LOCAL_ATTEN_SMASK\t\t(PORT0_LOCAL_ATTEN_MASK << \\\n\t\t\t\t\t PORT0_LOCAL_ATTEN_SHIFT)\n#define PORT0_REMOTE_ATTEN_SMASK\t(PORT0_REMOTE_ATTEN_MASK << \\\n\t\t\t\t\t PORT0_REMOTE_ATTEN_SHIFT)\n#define PORT0_DEFAULT_ATTEN_SMASK\t(PORT0_DEFAULT_ATTEN_MASK << \\\n\t\t\t\t\t PORT0_DEFAULT_ATTEN_SHIFT)\n\n#define PORT1_PORT_TYPE_SMASK\t\t(PORT1_PORT_TYPE_MASK << \\\n\t\t\t\t\t PORT1_PORT_TYPE_SHIFT)\n#define PORT1_LOCAL_ATTEN_SMASK\t\t(PORT1_LOCAL_ATTEN_MASK << \\\n\t\t\t\t\t PORT1_LOCAL_ATTEN_SHIFT)\n#define PORT1_REMOTE_ATTEN_SMASK\t(PORT1_REMOTE_ATTEN_MASK << \\\n\t\t\t\t\t PORT1_REMOTE_ATTEN_SHIFT)\n#define PORT1_DEFAULT_ATTEN_SMASK\t(PORT1_DEFAULT_ATTEN_MASK << \\\n\t\t\t\t\t PORT1_DEFAULT_ATTEN_SHIFT)\n\n#define QSFP_MAX_POWER_SHIFT\t\t0\n#define TX_NO_EQ_SHIFT\t\t\t4\n#define TX_EQ_SHIFT\t\t\t25\n#define RX_SHIFT\t\t\t46\n\n#define QSFP_MAX_POWER_MASK\t\t0xFUL\n#define TX_NO_EQ_MASK\t\t\t0x1FFFFFUL\n#define TX_EQ_MASK\t\t\t0x1FFFFFUL\n#define RX_MASK\t\t\t\t0xFFFFUL\n\n#define QSFP_MAX_POWER_SMASK\t\t(QSFP_MAX_POWER_MASK << \\\n\t\t\t\t\t QSFP_MAX_POWER_SHIFT)\n#define TX_NO_EQ_SMASK\t\t\t(TX_NO_EQ_MASK << TX_NO_EQ_SHIFT)\n#define TX_EQ_SMASK\t\t\t(TX_EQ_MASK << TX_EQ_SHIFT)\n#define RX_SMASK\t\t\t(RX_MASK << RX_SHIFT)\n\n#define TX_PRECUR_SHIFT\t\t\t0\n#define TX_ATTN_SHIFT\t\t\t4\n#define QSFP_TX_CDR_APPLY_SHIFT\t\t9\n#define QSFP_TX_EQ_APPLY_SHIFT\t\t10\n#define QSFP_TX_CDR_SHIFT\t\t11\n#define QSFP_TX_EQ_SHIFT\t\t12\n#define TX_POSTCUR_SHIFT\t\t16\n\n#define TX_PRECUR_MASK\t\t\t0xFUL\n#define TX_ATTN_MASK\t\t\t0x1FUL\n#define QSFP_TX_CDR_APPLY_MASK\t\t0x1UL\n#define QSFP_TX_EQ_APPLY_MASK\t\t0x1UL\n#define QSFP_TX_CDR_MASK\t\t0x1UL\n#define QSFP_TX_EQ_MASK\t\t\t0xFUL\n#define TX_POSTCUR_MASK\t\t\t0x1FUL\n\n#define TX_PRECUR_SMASK\t\t\t(TX_PRECUR_MASK << TX_PRECUR_SHIFT)\n#define TX_ATTN_SMASK\t\t\t(TX_ATTN_MASK << TX_ATTN_SHIFT)\n#define QSFP_TX_CDR_APPLY_SMASK\t\t(QSFP_TX_CDR_APPLY_MASK << \\\n\t\t\t\t\t QSFP_TX_CDR_APPLY_SHIFT)\n#define QSFP_TX_EQ_APPLY_SMASK\t\t(QSFP_TX_EQ_APPLY_MASK << \\\n\t\t\t\t\t QSFP_TX_EQ_APPLY_SHIFT)\n#define QSFP_TX_CDR_SMASK\t\t(QSFP_TX_CDR_MASK << QSFP_TX_CDR_SHIFT)\n#define QSFP_TX_EQ_SMASK\t\t(QSFP_TX_EQ_MASK << QSFP_TX_EQ_SHIFT)\n#define TX_POSTCUR_SMASK\t\t(TX_POSTCUR_MASK << TX_POSTCUR_SHIFT)\n\n#define QSFP_RX_CDR_APPLY_SHIFT\t\t0\n#define QSFP_RX_EMP_APPLY_SHIFT\t\t1\n#define QSFP_RX_AMP_APPLY_SHIFT\t\t2\n#define QSFP_RX_CDR_SHIFT\t\t3\n#define QSFP_RX_EMP_SHIFT\t\t4\n#define QSFP_RX_AMP_SHIFT\t\t8\n\n#define QSFP_RX_CDR_APPLY_MASK\t\t0x1UL\n#define QSFP_RX_EMP_APPLY_MASK\t\t0x1UL\n#define QSFP_RX_AMP_APPLY_MASK\t\t0x1UL\n#define QSFP_RX_CDR_MASK\t\t0x1UL\n#define QSFP_RX_EMP_MASK\t\t0xFUL\n#define QSFP_RX_AMP_MASK\t\t0x3UL\n\n#define QSFP_RX_CDR_APPLY_SMASK\t\t(QSFP_RX_CDR_APPLY_MASK << \\\n\t\t\t\t\t QSFP_RX_CDR_APPLY_SHIFT)\n#define QSFP_RX_EMP_APPLY_SMASK\t\t(QSFP_RX_EMP_APPLY_MASK << \\\n\t\t\t\t\t QSFP_RX_EMP_APPLY_SHIFT)\n#define QSFP_RX_AMP_APPLY_SMASK\t\t(QSFP_RX_AMP_APPLY_MASK << \\\n\t\t\t\t\t QSFP_RX_AMP_APPLY_SHIFT)\n#define QSFP_RX_CDR_SMASK\t\t(QSFP_RX_CDR_MASK << QSFP_RX_CDR_SHIFT)\n#define QSFP_RX_EMP_SMASK\t\t(QSFP_RX_EMP_MASK << QSFP_RX_EMP_SHIFT)\n#define QSFP_RX_AMP_SMASK\t\t(QSFP_RX_AMP_MASK << QSFP_RX_AMP_SHIFT)\n\n#define BITMAP_VERSION\t\t\t1\n#define BITMAP_VERSION_SHIFT\t\t44\n#define BITMAP_VERSION_MASK\t\t0xFUL\n#define BITMAP_VERSION_SMASK\t\t(BITMAP_VERSION_MASK << \\\n\t\t\t\t\t BITMAP_VERSION_SHIFT)\n#define CHECKSUM_SHIFT\t\t\t48\n#define CHECKSUM_MASK\t\t\t0xFFFFUL\n#define CHECKSUM_SMASK\t\t\t(CHECKSUM_MASK << CHECKSUM_SHIFT)\n\n \nvoid get_platform_config(struct hfi1_devdata *dd);\nvoid free_platform_config(struct hfi1_devdata *dd);\nvoid get_port_type(struct hfi1_pportdata *ppd);\nint set_qsfp_tx(struct hfi1_pportdata *ppd, int on);\nvoid tune_serdes(struct hfi1_pportdata *ppd);\n\n#endif\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}