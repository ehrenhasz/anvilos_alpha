{
  "module_name": "qib_common.h",
  "hash_id": "da74927adaad80da4410df2561a4f7eeeede9b9a0ab7b26eabed9ad683009d81",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/qib/qib_common.h",
  "human_readable_source": " \n\n#ifndef _QIB_COMMON_H\n#define _QIB_COMMON_H\n\n \n\n \n#define QIB_SRC_OUI_1 0x00\n#define QIB_SRC_OUI_2 0x11\n#define QIB_SRC_OUI_3 0x75\n\n \n#define IPS_PROTO_VERSION 2\n\n \n\n \n#define QIB_KD_QP 0x656b78\n\n \n#define QIB_STATUS_INITTED       0x1     \n \n#define QIB_STATUS_CHIP_PRESENT 0x20\n \n#define QIB_STATUS_IB_READY     0x40\n \n#define QIB_STATUS_IB_CONF      0x80\n \n#define QIB_STATUS_HWERROR     0x200\n\n \nenum qib_ureg {\n\t \n\tur_rcvhdrtail = 0,\n\t \n\tur_rcvhdrhead = 1,\n\t \n\tur_rcvegrindextail = 2,\n\t \n\tur_rcvegrindexhead = 3,\n\t \n\t_QIB_UregMax\n};\n\n \n#define QIB_RUNTIME_PCIE                0x0002\n#define QIB_RUNTIME_FORCE_WC_ORDER      0x0004\n#define QIB_RUNTIME_RCVHDR_COPY         0x0008\n#define QIB_RUNTIME_MASTER              0x0010\n#define QIB_RUNTIME_RCHK                0x0020\n#define QIB_RUNTIME_NODMA_RTAIL         0x0080\n#define QIB_RUNTIME_SPECIAL_TRIGGER     0x0100\n#define QIB_RUNTIME_SDMA                0x0200\n#define QIB_RUNTIME_FORCE_PIOAVAIL      0x0400\n#define QIB_RUNTIME_PIO_REGSWAPPED      0x0800\n#define QIB_RUNTIME_CTXT_MSB_IN_QP      0x1000\n#define QIB_RUNTIME_CTXT_REDIRECT       0x2000\n#define QIB_RUNTIME_HDRSUPP             0x4000\n\n \nstruct qib_base_info {\n\t \n\t__u32 spi_hw_version;\n\t \n\t__u32 spi_sw_version;\n\t \n\t__u16 spi_ctxt;\n\t__u16 spi_subctxt;\n\t \n\t__u32 spi_mtu;\n\t \n\t__u32 spi_piosize;\n\t \n\t__u32 spi_tidcnt;\n\t \n\t__u32 spi_tidegrcnt;\n\t \n\t__u32 spi_rcvhdrent_size;\n\t \n\t__u32 spi_rcvhdr_cnt;\n\n\t \n\t__u32 spi_runtime_flags;\n\n\t \n\t__u64 spi_rcvhdr_base;\n\n\t \n\n\t \n\t__u64 spi_rcv_egrbufs;\n\n\t \n\n\t \n\t__u32 spi_rcv_egrbufsize;\n\t \n\t__u32 spi_qpair;\n\n\t \n\t__u64 spi_uregbase;\n\t \n\t__u32 spi_tid_maxsize;\n\t \n\t__u32 spi_pioalign;\n\t \n\t__u32 spi_pioindex;\n\t  \n\t__u32 spi_piocnt;\n\n\t \n\t__u64 spi_piobufbase;\n\n\t \n\t__u64 spi_pioavailaddr;\n\n\t \n\t__u64 spi_status;\n\n\t \n\t__u32 spi_nctxts;\n\t__u16 spi_unit;  \n\t__u16 spi_port;  \n\t \n\t__u32 spi_rcv_egrperchunk;\n\t \n\t__u32 spi_rcv_egrchunksize;\n\t \n\t__u32 spi_rcv_egrbuftotlen;\n\t__u32 spi_rhf_offset;  \n\t \n\t__u64 spi_rcvhdr_tailaddr;\n\n\t \n\t__u64 spi_subctxt_uregbase;\n\t__u64 spi_subctxt_rcvegrbuf;\n\t__u64 spi_subctxt_rcvhdr_base;\n\n\t \n\t__u64 spi_sendbuf_status;\n} __aligned(8);\n\n \n#define QIB_USER_SWMAJOR 1\n\n \n#define QIB_USER_SWMINOR 13\n\n#define QIB_USER_SWVERSION ((QIB_USER_SWMAJOR << 16) | QIB_USER_SWMINOR)\n\n#ifndef QIB_KERN_TYPE\n#define QIB_KERN_TYPE 0\n#endif\n\n \n#define QIB_KERN_SWVERSION ((QIB_KERN_TYPE << 31) | QIB_USER_SWVERSION)\n\n \n#define QIB_DRIVER_VERSION_BASE \"1.11\"\n\n \n#ifdef QIB_IDSTR\n#define QIB_DRIVER_VERSION QIB_DRIVER_VERSION_BASE \" \" QIB_IDSTR\n#else\n#define QIB_DRIVER_VERSION QIB_DRIVER_VERSION_BASE\n#endif\n\n \n#define QIB_PORT_ALG_ACROSS 0  \n#define QIB_PORT_ALG_WITHIN 1  \n#define QIB_PORT_ALG_COUNT 2  \n\n \nstruct qib_user_info {\n\t \n\t__u32 spu_userversion;\n\n\t__u32 _spu_unused2;\n\n\t \n\t__u32 spu_base_info_size;\n\n\t__u32 spu_port_alg;  \n\n\t \n\t__u16 spu_subctxt_cnt;\n\t__u16 spu_subctxt_id;\n\n\t__u32 spu_port;  \n\n\t \n\t__u64 spu_base_info;\n\n} __aligned(8);\n\n \n\n \n#define QIB_CMD_CTXT_INFO       17       \n#define QIB_CMD_RECV_CTRL       18       \n#define QIB_CMD_TID_UPDATE      19       \n#define QIB_CMD_TID_FREE        20       \n#define QIB_CMD_SET_PART_KEY    21       \n \n#define QIB_CMD_ASSIGN_CTXT     23       \n#define QIB_CMD_USER_INIT       24       \n#define QIB_CMD_UNUSED_1        25\n#define QIB_CMD_UNUSED_2        26\n#define QIB_CMD_PIOAVAILUPD     27       \n#define QIB_CMD_POLL_TYPE       28       \n#define QIB_CMD_ARMLAUNCH_CTRL  29       \n \n#define QIB_CMD_SDMA_INFLIGHT   31       \n#define QIB_CMD_SDMA_COMPLETE   32       \n \n#define QIB_CMD_DISARM_BUFS     34       \n#define QIB_CMD_ACK_EVENT       35       \n#define QIB_CMD_CPUS_LIST       36       \n\n \n#define _QIB_EVENT_DISARM_BUFS_BIT\t0\n#define _QIB_EVENT_LINKDOWN_BIT\t\t1\n#define _QIB_EVENT_LID_CHANGE_BIT\t2\n#define _QIB_EVENT_LMC_CHANGE_BIT\t3\n#define _QIB_EVENT_SL2VL_CHANGE_BIT\t4\n#define _QIB_MAX_EVENT_BIT _QIB_EVENT_SL2VL_CHANGE_BIT\n\n#define QIB_EVENT_DISARM_BUFS_BIT\t(1UL << _QIB_EVENT_DISARM_BUFS_BIT)\n#define QIB_EVENT_LINKDOWN_BIT\t\t(1UL << _QIB_EVENT_LINKDOWN_BIT)\n#define QIB_EVENT_LID_CHANGE_BIT\t(1UL << _QIB_EVENT_LID_CHANGE_BIT)\n#define QIB_EVENT_LMC_CHANGE_BIT\t(1UL << _QIB_EVENT_LMC_CHANGE_BIT)\n#define QIB_EVENT_SL2VL_CHANGE_BIT\t(1UL << _QIB_EVENT_SL2VL_CHANGE_BIT)\n\n\n \n#define QIB_POLL_TYPE_ANYRCV     0x0\n#define QIB_POLL_TYPE_URGENT     0x1\n\nstruct qib_ctxt_info {\n\t__u16 num_active;        \n\t__u16 unit;              \n\t__u16 port;              \n\t__u16 ctxt;              \n\t__u16 subctxt;           \n\t__u16 num_ctxts;         \n\t__u16 num_subctxts;      \n\t__u16 rec_cpu;           \n};\n\nstruct qib_tid_info {\n\t__u32 tidcnt;\n\t \n\t__u32 tid__unused;\n\t \n\t__u64 tidvaddr;\n\t \n\t__u64 tidlist;\n\n\t \n\t__u64 tidmap;\n};\n\nstruct qib_cmd {\n\t__u32 type;                      \n\tunion {\n\t\tstruct qib_tid_info tid_info;\n\t\tstruct qib_user_info user_info;\n\n\t\t \n\t\t__u64 sdma_inflight;\n\t\t \n\t\t__u64 sdma_complete;\n\t\t \n\t\t__u64 ctxt_info;\n\t\t \n\t\t__u32 recv_ctrl;\n\t\t \n\t\t__u32 armlaunch_ctrl;\n\t\t \n\t\t__u16 part_key;\n\t\t \n\t\t__u64 slave_mask_addr;\n\t\t \n\t\t__u16 poll_type;\n\t\t \n\t\t__u8 ctxt_bp;\n\t\t \n\t\t__u64 event_mask;\n\t} cmd;\n};\n\nstruct qib_iovec {\n\t \n\t__u64 iov_base;\n\n\t \n\t__u64 iov_len;\n};\n\n \nstruct __qib_sendpkt {\n\t__u32 sps_flags;         \n\t__u32 sps_cnt;           \n\t \n\tstruct qib_iovec sps_iov[4];\n};\n\n \n#define _DIAG_XPKT_VERS 3\nstruct qib_diag_xpkt {\n\t__u16 version;\n\t__u16 unit;\n\t__u16 port;\n\t__u16 len;\n\t__u64 data;\n\t__u64 pbc_wd;\n};\n\n \n#define QIB_FLASH_VERSION 2\nstruct qib_flash {\n\t \n\t__u8 if_fversion;\n\t \n\t__u8 if_csum;\n\t \n\t__u8 if_length;\n\t \n\t__u8 if_guid[8];\n\t \n\t__u8 if_numguid;\n\t \n\tchar if_serial[12];\n\t \n\tchar if_mfgdate[8];\n\t \n\tchar if_testdate[8];\n\t \n\t__u8 if_errcntp[4];\n\t \n\t__u8 if_powerhour[2];\n\t \n\tchar if_comment[32];\n\t \n\tchar if_sprefix[4];\n\t \n\t__u8 if_future[46];\n};\n\n \nstruct qlogic_ib_counters {\n\t__u64 LBIntCnt;\n\t__u64 LBFlowStallCnt;\n\t__u64 TxSDmaDescCnt;     \n\t__u64 TxUnsupVLErrCnt;\n\t__u64 TxDataPktCnt;\n\t__u64 TxFlowPktCnt;\n\t__u64 TxDwordCnt;\n\t__u64 TxLenErrCnt;\n\t__u64 TxMaxMinLenErrCnt;\n\t__u64 TxUnderrunCnt;\n\t__u64 TxFlowStallCnt;\n\t__u64 TxDroppedPktCnt;\n\t__u64 RxDroppedPktCnt;\n\t__u64 RxDataPktCnt;\n\t__u64 RxFlowPktCnt;\n\t__u64 RxDwordCnt;\n\t__u64 RxLenErrCnt;\n\t__u64 RxMaxMinLenErrCnt;\n\t__u64 RxICRCErrCnt;\n\t__u64 RxVCRCErrCnt;\n\t__u64 RxFlowCtrlErrCnt;\n\t__u64 RxBadFormatCnt;\n\t__u64 RxLinkProblemCnt;\n\t__u64 RxEBPCnt;\n\t__u64 RxLPCRCErrCnt;\n\t__u64 RxBufOvflCnt;\n\t__u64 RxTIDFullErrCnt;\n\t__u64 RxTIDValidErrCnt;\n\t__u64 RxPKeyMismatchCnt;\n\t__u64 RxP0HdrEgrOvflCnt;\n\t__u64 RxP1HdrEgrOvflCnt;\n\t__u64 RxP2HdrEgrOvflCnt;\n\t__u64 RxP3HdrEgrOvflCnt;\n\t__u64 RxP4HdrEgrOvflCnt;\n\t__u64 RxP5HdrEgrOvflCnt;\n\t__u64 RxP6HdrEgrOvflCnt;\n\t__u64 RxP7HdrEgrOvflCnt;\n\t__u64 RxP8HdrEgrOvflCnt;\n\t__u64 RxP9HdrEgrOvflCnt;\n\t__u64 RxP10HdrEgrOvflCnt;\n\t__u64 RxP11HdrEgrOvflCnt;\n\t__u64 RxP12HdrEgrOvflCnt;\n\t__u64 RxP13HdrEgrOvflCnt;\n\t__u64 RxP14HdrEgrOvflCnt;\n\t__u64 RxP15HdrEgrOvflCnt;\n\t__u64 RxP16HdrEgrOvflCnt;\n\t__u64 IBStatusChangeCnt;\n\t__u64 IBLinkErrRecoveryCnt;\n\t__u64 IBLinkDownedCnt;\n\t__u64 IBSymbolErrCnt;\n\t__u64 RxVL15DroppedPktCnt;\n\t__u64 RxOtherLocalPhyErrCnt;\n\t__u64 PcieRetryBufDiagQwordCnt;\n\t__u64 ExcessBufferOvflCnt;\n\t__u64 LocalLinkIntegrityErrCnt;\n\t__u64 RxVlErrCnt;\n\t__u64 RxDlidFltrCnt;\n};\n\n \n\n \n#define QLOGIC_IB_RHF_LENGTH_MASK 0x7FF\n#define QLOGIC_IB_RHF_LENGTH_SHIFT 0\n#define QLOGIC_IB_RHF_RCVTYPE_MASK 0x7\n#define QLOGIC_IB_RHF_RCVTYPE_SHIFT 11\n#define QLOGIC_IB_RHF_EGRINDEX_MASK 0xFFF\n#define QLOGIC_IB_RHF_EGRINDEX_SHIFT 16\n#define QLOGIC_IB_RHF_SEQ_MASK 0xF\n#define QLOGIC_IB_RHF_SEQ_SHIFT 0\n#define QLOGIC_IB_RHF_HDRQ_OFFSET_MASK 0x7FF\n#define QLOGIC_IB_RHF_HDRQ_OFFSET_SHIFT 4\n#define QLOGIC_IB_RHF_H_ICRCERR   0x80000000\n#define QLOGIC_IB_RHF_H_VCRCERR   0x40000000\n#define QLOGIC_IB_RHF_H_PARITYERR 0x20000000\n#define QLOGIC_IB_RHF_H_LENERR    0x10000000\n#define QLOGIC_IB_RHF_H_MTUERR    0x08000000\n#define QLOGIC_IB_RHF_H_IHDRERR   0x04000000\n#define QLOGIC_IB_RHF_H_TIDERR    0x02000000\n#define QLOGIC_IB_RHF_H_MKERR     0x01000000\n#define QLOGIC_IB_RHF_H_IBERR     0x00800000\n#define QLOGIC_IB_RHF_H_ERR_MASK  0xFF800000\n#define QLOGIC_IB_RHF_L_USE_EGR   0x80000000\n#define QLOGIC_IB_RHF_L_SWA       0x00008000\n#define QLOGIC_IB_RHF_L_SWB       0x00004000\n\n \n#define QLOGIC_IB_I_VERS_MASK 0xF\n#define QLOGIC_IB_I_VERS_SHIFT 28\n#define QLOGIC_IB_I_CTXT_MASK 0xF\n#define QLOGIC_IB_I_CTXT_SHIFT 24\n#define QLOGIC_IB_I_TID_MASK 0x7FF\n#define QLOGIC_IB_I_TID_SHIFT 13\n#define QLOGIC_IB_I_OFFSET_MASK 0x1FFF\n#define QLOGIC_IB_I_OFFSET_SHIFT 0\n\n \n#define QLOGIC_IB_KPF_INTR 0x1\n#define QLOGIC_IB_KPF_SUBCTXT_MASK 0x3\n#define QLOGIC_IB_KPF_SUBCTXT_SHIFT 1\n\n#define QLOGIC_IB_MAX_SUBCTXT   4\n\n \n#define QLOGIC_IB_SP_TEST    0x40\n#define QLOGIC_IB_SP_TESTEBP 0x20\n#define QLOGIC_IB_SP_TRIGGER_SHIFT  15\n\n \n#define QLOGIC_IB_SENDPIOAVAIL_BUSY_SHIFT 1\n#define QLOGIC_IB_SENDPIOAVAIL_CHECK_SHIFT 0\n\n \nstruct qib_header {\n\t \n\t__le32 ver_ctxt_tid_offset;\n\t__le16 chksum;\n\t__le16 pkt_flags;\n};\n\n \nstruct qib_message_header {\n\t__be16 lrh[4];\n\t__be32 bth[3];\n\t \n\tstruct qib_header iph;\n\t \n\t \n\t__u8 sub_opcode;\n\t__u8 flags;\n\t__u16 commidx;\n\t__u32 ack_seq_num;\n\t__u8 flowid;\n\t__u8 hdr_dlen;\n\t__u16 mqhdr;\n\t__u32 uwords[4];\n};\n\n \nunion qib_seqnum {\n\tstruct {\n\t\t__u32 seq:11;\n\t\t__u32 gen:8;\n\t\t__u32 flow:5;\n\t};\n\tstruct {\n\t\t__u32 pkt:16;\n\t\t__u32 msg:8;\n\t};\n\t__u32 val;\n};\n\n \nstruct qib_tid_session_member {\n\t__u16 tid;\n\t__u16 offset;\n\t__u16 length;\n};\n\n \n#define QIB_LRH_GRH 0x0003       \n#define QIB_LRH_BTH 0x0002       \n\n \n#define SIZE_OF_CRC 1\n\n#define QIB_DEFAULT_P_KEY 0xFFFF\n#define QIB_PSN_MASK 0xFFFFFF\n#define QIB_EAGER_TID_ID QLOGIC_IB_I_TID_MASK\n#define QIB_MULTICAST_QPN 0xFFFFFF\n\n \n#define RCVHQ_RCV_TYPE_EXPECTED  0\n#define RCVHQ_RCV_TYPE_EAGER     1\n#define RCVHQ_RCV_TYPE_NON_KD    2\n#define RCVHQ_RCV_TYPE_ERROR     3\n\n#define QIB_HEADER_QUEUE_WORDS 9\n\n \nstatic inline __u32 qib_hdrget_err_flags(const __le32 *rbuf)\n{\n\treturn __le32_to_cpu(rbuf[1]) & QLOGIC_IB_RHF_H_ERR_MASK;\n}\n\nstatic inline __u32 qib_hdrget_rcv_type(const __le32 *rbuf)\n{\n\treturn (__le32_to_cpu(rbuf[0]) >> QLOGIC_IB_RHF_RCVTYPE_SHIFT) &\n\t\tQLOGIC_IB_RHF_RCVTYPE_MASK;\n}\n\nstatic inline __u32 qib_hdrget_length_in_bytes(const __le32 *rbuf)\n{\n\treturn ((__le32_to_cpu(rbuf[0]) >> QLOGIC_IB_RHF_LENGTH_SHIFT) &\n\t\tQLOGIC_IB_RHF_LENGTH_MASK) << 2;\n}\n\nstatic inline __u32 qib_hdrget_index(const __le32 *rbuf)\n{\n\treturn (__le32_to_cpu(rbuf[0]) >> QLOGIC_IB_RHF_EGRINDEX_SHIFT) &\n\t\tQLOGIC_IB_RHF_EGRINDEX_MASK;\n}\n\nstatic inline __u32 qib_hdrget_seq(const __le32 *rbuf)\n{\n\treturn (__le32_to_cpu(rbuf[1]) >> QLOGIC_IB_RHF_SEQ_SHIFT) &\n\t\tQLOGIC_IB_RHF_SEQ_MASK;\n}\n\nstatic inline __u32 qib_hdrget_offset(const __le32 *rbuf)\n{\n\treturn (__le32_to_cpu(rbuf[1]) >> QLOGIC_IB_RHF_HDRQ_OFFSET_SHIFT) &\n\t\tQLOGIC_IB_RHF_HDRQ_OFFSET_MASK;\n}\n\nstatic inline __u32 qib_hdrget_use_egr_buf(const __le32 *rbuf)\n{\n\treturn __le32_to_cpu(rbuf[0]) & QLOGIC_IB_RHF_L_USE_EGR;\n}\n#endif                           \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}