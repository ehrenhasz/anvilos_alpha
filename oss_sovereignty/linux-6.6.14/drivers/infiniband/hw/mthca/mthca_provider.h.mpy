{
  "module_name": "mthca_provider.h",
  "hash_id": "058a7b77478315a5683f532f69f0f7569f523d386712befab3a85e15a90636a5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/mthca/mthca_provider.h",
  "human_readable_source": " \n\n#ifndef MTHCA_PROVIDER_H\n#define MTHCA_PROVIDER_H\n\n#include <rdma/ib_verbs.h>\n#include <rdma/ib_pack.h>\n\n#define MTHCA_MPT_FLAG_ATOMIC        (1 << 14)\n#define MTHCA_MPT_FLAG_REMOTE_WRITE  (1 << 13)\n#define MTHCA_MPT_FLAG_REMOTE_READ   (1 << 12)\n#define MTHCA_MPT_FLAG_LOCAL_WRITE   (1 << 11)\n#define MTHCA_MPT_FLAG_LOCAL_READ    (1 << 10)\n\nstruct mthca_buf_list {\n\tvoid *buf;\n\tDEFINE_DMA_UNMAP_ADDR(mapping);\n};\n\nunion mthca_buf {\n\tstruct mthca_buf_list direct;\n\tstruct mthca_buf_list *page_list;\n};\n\nstruct mthca_uar {\n\tunsigned long pfn;\n\tint           index;\n};\n\nstruct mthca_user_db_table;\n\nstruct mthca_ucontext {\n\tstruct ib_ucontext          ibucontext;\n\tstruct mthca_uar            uar;\n\tstruct mthca_user_db_table *db_tab;\n\tint\t\t\t    reg_mr_warned;\n};\n\nstruct mthca_mtt;\n\nstruct mthca_mr {\n\tstruct ib_mr      ibmr;\n\tstruct ib_umem   *umem;\n\tstruct mthca_mtt *mtt;\n};\n\nstruct mthca_pd {\n\tstruct ib_pd    ibpd;\n\tu32             pd_num;\n\tatomic_t        sqp_count;\n\tstruct mthca_mr ntmr;\n\tint             privileged;\n};\n\nstruct mthca_eq {\n\tstruct mthca_dev      *dev;\n\tint                    eqn;\n\tu32                    eqn_mask;\n\tu32                    cons_index;\n\tu16                    msi_x_vector;\n\tu16                    msi_x_entry;\n\tint                    have_irq;\n\tint                    nent;\n\tstruct mthca_buf_list *page_list;\n\tstruct mthca_mr        mr;\n\tchar\t\t       irq_name[IB_DEVICE_NAME_MAX];\n};\n\nstruct mthca_av;\n\nenum mthca_ah_type {\n\tMTHCA_AH_ON_HCA,\n\tMTHCA_AH_PCI_POOL,\n\tMTHCA_AH_KMALLOC\n};\n\nstruct mthca_ah {\n\tstruct ib_ah       ibah;\n\tenum mthca_ah_type type;\n\tu32                key;\n\tstruct mthca_av   *av;\n\tdma_addr_t         avdma;\n};\n\n \n\nstruct mthca_cq_buf {\n\tunion mthca_buf\t\tqueue;\n\tstruct mthca_mr\t\tmr;\n\tint\t\t\tis_direct;\n};\n\nstruct mthca_cq_resize {\n\tstruct mthca_cq_buf\tbuf;\n\tint\t\t\tcqe;\n\tenum {\n\t\tCQ_RESIZE_ALLOC,\n\t\tCQ_RESIZE_READY,\n\t\tCQ_RESIZE_SWAPPED\n\t}\t\t\tstate;\n};\n\nstruct mthca_cq {\n\tstruct ib_cq\t\tibcq;\n\tspinlock_t\t\tlock;\n\tint\t\t\trefcount;\n\tint\t\t\tcqn;\n\tu32\t\t\tcons_index;\n\tstruct mthca_cq_buf\tbuf;\n\tstruct mthca_cq_resize *resize_buf;\n\tint\t\t\tis_kernel;\n\n\t \n\tint\t\t\tset_ci_db_index;\n\t__be32\t\t       *set_ci_db;\n\tint\t\t\tarm_db_index;\n\t__be32\t\t       *arm_db;\n\tint\t\t\tarm_sn;\n\n\twait_queue_head_t\twait;\n\tstruct mutex\t\tmutex;\n};\n\nstruct mthca_srq {\n\tstruct ib_srq\t\tibsrq;\n\tspinlock_t\t\tlock;\n\tint\t\t\trefcount;\n\tint\t\t\tsrqn;\n\tint\t\t\tmax;\n\tint\t\t\tmax_gs;\n\tint\t\t\twqe_shift;\n\tint\t\t\tfirst_free;\n\tint\t\t\tlast_free;\n\tu16\t\t\tcounter;   \n\tint\t\t\tdb_index;  \n\t__be32\t\t       *db;        \n\tvoid\t\t       *last;\n\n\tint\t\t\tis_direct;\n\tu64\t\t       *wrid;\n\tunion mthca_buf\t\tqueue;\n\tstruct mthca_mr\t\tmr;\n\n\twait_queue_head_t\twait;\n\tstruct mutex\t\tmutex;\n};\n\nstruct mthca_wq {\n\tspinlock_t lock;\n\tint        max;\n\tunsigned   next_ind;\n\tunsigned   last_comp;\n\tunsigned   head;\n\tunsigned   tail;\n\tvoid      *last;\n\tint        max_gs;\n\tint        wqe_shift;\n\n\tint        db_index;\t \n\t__be32    *db;\n};\n\nstruct mthca_sqp {\n\tint             pkey_index;\n\tu32             qkey;\n\tu32             send_psn;\n\tstruct ib_ud_header ud_header;\n\tint             header_buf_size;\n\tvoid           *header_buf;\n\tdma_addr_t      header_dma;\n};\n\nstruct mthca_qp {\n\tstruct ib_qp           ibqp;\n\tint                    refcount;\n\tu32                    qpn;\n\tint                    is_direct;\n\tu8                     port;  \n\tu8                     alt_port;  \n\tu8                     transport;\n\tu8                     state;\n\tu8                     atomic_rd_en;\n\tu8                     resp_depth;\n\n\tstruct mthca_mr        mr;\n\n\tstruct mthca_wq        rq;\n\tstruct mthca_wq        sq;\n\tenum ib_sig_type       sq_policy;\n\tint                    send_wqe_offset;\n\tint                    max_inline_data;\n\n\tu64                   *wrid;\n\tunion mthca_buf\t       queue;\n\n\twait_queue_head_t      wait;\n\tstruct mutex\t       mutex;\n\tstruct mthca_sqp *sqp;\n};\n\nstatic inline struct mthca_ucontext *to_mucontext(struct ib_ucontext *ibucontext)\n{\n\treturn container_of(ibucontext, struct mthca_ucontext, ibucontext);\n}\n\nstatic inline struct mthca_mr *to_mmr(struct ib_mr *ibmr)\n{\n\treturn container_of(ibmr, struct mthca_mr, ibmr);\n}\n\nstatic inline struct mthca_pd *to_mpd(struct ib_pd *ibpd)\n{\n\treturn container_of(ibpd, struct mthca_pd, ibpd);\n}\n\nstatic inline struct mthca_ah *to_mah(struct ib_ah *ibah)\n{\n\treturn container_of(ibah, struct mthca_ah, ibah);\n}\n\nstatic inline struct mthca_cq *to_mcq(struct ib_cq *ibcq)\n{\n\treturn container_of(ibcq, struct mthca_cq, ibcq);\n}\n\nstatic inline struct mthca_srq *to_msrq(struct ib_srq *ibsrq)\n{\n\treturn container_of(ibsrq, struct mthca_srq, ibsrq);\n}\n\nstatic inline struct mthca_qp *to_mqp(struct ib_qp *ibqp)\n{\n\treturn container_of(ibqp, struct mthca_qp, ibqp);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}