{
  "module_name": "mthca_doorbell.h",
  "hash_id": "f5d11743ec5ae7e8a0f3b2b3da09be15dc4918313414836acd12243f25e492fe",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/mthca/mthca_doorbell.h",
  "human_readable_source": " \n\n#include <linux/types.h>\n\n#define MTHCA_RD_DOORBELL      0x00\n#define MTHCA_SEND_DOORBELL    0x10\n#define MTHCA_RECEIVE_DOORBELL 0x18\n#define MTHCA_CQ_DOORBELL      0x20\n#define MTHCA_EQ_DOORBELL      0x28\n\n#if BITS_PER_LONG == 64\n \n\n#define MTHCA_DECLARE_DOORBELL_LOCK(name)\n#define MTHCA_INIT_DOORBELL_LOCK(ptr)    do { } while (0)\n#define MTHCA_GET_DOORBELL_LOCK(ptr)      (NULL)\n\nstatic inline void mthca_write64_raw(__be64 val, void __iomem *dest)\n{\n\t__raw_writeq((__force u64) val, dest);\n}\n\nstatic inline void mthca_write64(u32 hi, u32 lo, void __iomem *dest,\n\t\t\t\t spinlock_t *doorbell_lock)\n{\n\t__raw_writeq((__force u64) cpu_to_be64((u64) hi << 32 | lo), dest);\n}\n\nstatic inline void mthca_write_db_rec(__be32 val[2], __be32 *db)\n{\n\t*(u64 *) db = *(u64 *) val;\n}\n\n#else\n\n \n\n#define MTHCA_DECLARE_DOORBELL_LOCK(name) spinlock_t name;\n#define MTHCA_INIT_DOORBELL_LOCK(ptr)     spin_lock_init(ptr)\n#define MTHCA_GET_DOORBELL_LOCK(ptr)      (ptr)\n\nstatic inline void mthca_write64_raw(__be64 val, void __iomem *dest)\n{\n\t__raw_writel(((__force u32 *) &val)[0], dest);\n\t__raw_writel(((__force u32 *) &val)[1], dest + 4);\n}\n\nstatic inline void mthca_write64(u32 hi, u32 lo, void __iomem *dest,\n\t\t\t\t spinlock_t *doorbell_lock)\n{\n\tunsigned long flags;\n\n\thi = (__force u32) cpu_to_be32(hi);\n\tlo = (__force u32) cpu_to_be32(lo);\n\n\tspin_lock_irqsave(doorbell_lock, flags);\n\t__raw_writel(hi, dest);\n\t__raw_writel(lo, dest + 4);\n\tspin_unlock_irqrestore(doorbell_lock, flags);\n}\n\nstatic inline void mthca_write_db_rec(__be32 val[2], __be32 *db)\n{\n\tdb[0] = val[0];\n\twmb();\n\tdb[1] = val[1];\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}