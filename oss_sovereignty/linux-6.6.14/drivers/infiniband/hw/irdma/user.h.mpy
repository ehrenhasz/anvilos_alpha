{
  "module_name": "user.h",
  "hash_id": "9c4d7d30c814f8ccaa8c5c3a608a6b7ef3b80db03182f81f0806fd89f8eebe67",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/hw/irdma/user.h",
  "human_readable_source": " \n \n#ifndef IRDMA_USER_H\n#define IRDMA_USER_H\n\n#define irdma_handle void *\n#define irdma_adapter_handle irdma_handle\n#define irdma_qp_handle irdma_handle\n#define irdma_cq_handle irdma_handle\n#define irdma_pd_id irdma_handle\n#define irdma_stag_handle irdma_handle\n#define irdma_stag_index u32\n#define irdma_stag u32\n#define irdma_stag_key u8\n#define irdma_tagged_offset u64\n#define irdma_access_privileges u32\n#define irdma_physical_fragment u64\n#define irdma_address_list u64 *\n\n#define\tIRDMA_MAX_MR_SIZE       0x200000000000ULL\n\n#define IRDMA_ACCESS_FLAGS_LOCALREAD\t\t0x01\n#define IRDMA_ACCESS_FLAGS_LOCALWRITE\t\t0x02\n#define IRDMA_ACCESS_FLAGS_REMOTEREAD_ONLY\t0x04\n#define IRDMA_ACCESS_FLAGS_REMOTEREAD\t\t0x05\n#define IRDMA_ACCESS_FLAGS_REMOTEWRITE_ONLY\t0x08\n#define IRDMA_ACCESS_FLAGS_REMOTEWRITE\t\t0x0a\n#define IRDMA_ACCESS_FLAGS_BIND_WINDOW\t\t0x10\n#define IRDMA_ACCESS_FLAGS_ZERO_BASED\t\t0x20\n#define IRDMA_ACCESS_FLAGS_ALL\t\t\t0x3f\n\n#define IRDMA_OP_TYPE_RDMA_WRITE\t\t0x00\n#define IRDMA_OP_TYPE_RDMA_READ\t\t\t0x01\n#define IRDMA_OP_TYPE_SEND\t\t\t0x03\n#define IRDMA_OP_TYPE_SEND_INV\t\t\t0x04\n#define IRDMA_OP_TYPE_SEND_SOL\t\t\t0x05\n#define IRDMA_OP_TYPE_SEND_SOL_INV\t\t0x06\n#define IRDMA_OP_TYPE_RDMA_WRITE_SOL\t\t0x0d\n#define IRDMA_OP_TYPE_BIND_MW\t\t\t0x08\n#define IRDMA_OP_TYPE_FAST_REG_NSMR\t\t0x09\n#define IRDMA_OP_TYPE_INV_STAG\t\t\t0x0a\n#define IRDMA_OP_TYPE_RDMA_READ_INV_STAG\t0x0b\n#define IRDMA_OP_TYPE_NOP\t\t\t0x0c\n#define IRDMA_OP_TYPE_REC\t0x3e\n#define IRDMA_OP_TYPE_REC_IMM\t0x3f\n\n#define IRDMA_FLUSH_MAJOR_ERR\t1\n\nenum irdma_device_caps_const {\n\tIRDMA_WQE_SIZE =\t\t\t4,\n\tIRDMA_CQP_WQE_SIZE =\t\t\t8,\n\tIRDMA_CQE_SIZE =\t\t\t4,\n\tIRDMA_EXTENDED_CQE_SIZE =\t\t8,\n\tIRDMA_AEQE_SIZE =\t\t\t2,\n\tIRDMA_CEQE_SIZE =\t\t\t1,\n\tIRDMA_CQP_CTX_SIZE =\t\t\t8,\n\tIRDMA_SHADOW_AREA_SIZE =\t\t8,\n\tIRDMA_QUERY_FPM_BUF_SIZE =\t\t176,\n\tIRDMA_COMMIT_FPM_BUF_SIZE =\t\t176,\n\tIRDMA_GATHER_STATS_BUF_SIZE =\t\t1024,\n\tIRDMA_MIN_IW_QP_ID =\t\t\t0,\n\tIRDMA_MAX_IW_QP_ID =\t\t\t262143,\n\tIRDMA_MIN_CEQID =\t\t\t0,\n\tIRDMA_MAX_CEQID =\t\t\t1023,\n\tIRDMA_CEQ_MAX_COUNT =\t\t\tIRDMA_MAX_CEQID + 1,\n\tIRDMA_MIN_CQID =\t\t\t0,\n\tIRDMA_MAX_CQID =\t\t\t524287,\n\tIRDMA_MIN_AEQ_ENTRIES =\t\t\t1,\n\tIRDMA_MAX_AEQ_ENTRIES =\t\t\t524287,\n\tIRDMA_MIN_CEQ_ENTRIES =\t\t\t1,\n\tIRDMA_MAX_CEQ_ENTRIES =\t\t\t262143,\n\tIRDMA_MIN_CQ_SIZE =\t\t\t1,\n\tIRDMA_MAX_CQ_SIZE =\t\t\t1048575,\n\tIRDMA_DB_ID_ZERO =\t\t\t0,\n\tIRDMA_MAX_WQ_FRAGMENT_COUNT =\t\t13,\n\tIRDMA_MAX_SGE_RD =\t\t\t13,\n\tIRDMA_MAX_OUTBOUND_MSG_SIZE =\t\t2147483647,\n\tIRDMA_MAX_INBOUND_MSG_SIZE =\t\t2147483647,\n\tIRDMA_MAX_PUSH_PAGE_COUNT =\t\t1024,\n\tIRDMA_MAX_PE_ENA_VF_COUNT =\t\t32,\n\tIRDMA_MAX_VF_FPM_ID =\t\t\t47,\n\tIRDMA_MAX_SQ_PAYLOAD_SIZE =\t\t2145386496,\n\tIRDMA_MAX_INLINE_DATA_SIZE =\t\t101,\n\tIRDMA_MAX_WQ_ENTRIES =\t\t\t32768,\n\tIRDMA_Q2_BUF_SIZE =\t\t\t256,\n\tIRDMA_QP_CTX_SIZE =\t\t\t256,\n\tIRDMA_MAX_PDS =\t\t\t\t262144,\n\tIRDMA_MIN_WQ_SIZE_GEN2 =                8,\n};\n\nenum irdma_addressing_type {\n\tIRDMA_ADDR_TYPE_ZERO_BASED = 0,\n\tIRDMA_ADDR_TYPE_VA_BASED   = 1,\n};\n\nenum irdma_flush_opcode {\n\tFLUSH_INVALID = 0,\n\tFLUSH_GENERAL_ERR,\n\tFLUSH_PROT_ERR,\n\tFLUSH_REM_ACCESS_ERR,\n\tFLUSH_LOC_QP_OP_ERR,\n\tFLUSH_REM_OP_ERR,\n\tFLUSH_LOC_LEN_ERR,\n\tFLUSH_FATAL_ERR,\n\tFLUSH_RETRY_EXC_ERR,\n\tFLUSH_MW_BIND_ERR,\n\tFLUSH_REM_INV_REQ_ERR,\n};\n\nenum irdma_cmpl_status {\n\tIRDMA_COMPL_STATUS_SUCCESS = 0,\n\tIRDMA_COMPL_STATUS_FLUSHED,\n\tIRDMA_COMPL_STATUS_INVALID_WQE,\n\tIRDMA_COMPL_STATUS_QP_CATASTROPHIC,\n\tIRDMA_COMPL_STATUS_REMOTE_TERMINATION,\n\tIRDMA_COMPL_STATUS_INVALID_STAG,\n\tIRDMA_COMPL_STATUS_BASE_BOUND_VIOLATION,\n\tIRDMA_COMPL_STATUS_ACCESS_VIOLATION,\n\tIRDMA_COMPL_STATUS_INVALID_PD_ID,\n\tIRDMA_COMPL_STATUS_WRAP_ERROR,\n\tIRDMA_COMPL_STATUS_STAG_INVALID_PDID,\n\tIRDMA_COMPL_STATUS_RDMA_READ_ZERO_ORD,\n\tIRDMA_COMPL_STATUS_QP_NOT_PRIVLEDGED,\n\tIRDMA_COMPL_STATUS_STAG_NOT_INVALID,\n\tIRDMA_COMPL_STATUS_INVALID_PHYS_BUF_SIZE,\n\tIRDMA_COMPL_STATUS_INVALID_PHYS_BUF_ENTRY,\n\tIRDMA_COMPL_STATUS_INVALID_FBO,\n\tIRDMA_COMPL_STATUS_INVALID_LEN,\n\tIRDMA_COMPL_STATUS_INVALID_ACCESS,\n\tIRDMA_COMPL_STATUS_PHYS_BUF_LIST_TOO_LONG,\n\tIRDMA_COMPL_STATUS_INVALID_VIRT_ADDRESS,\n\tIRDMA_COMPL_STATUS_INVALID_REGION,\n\tIRDMA_COMPL_STATUS_INVALID_WINDOW,\n\tIRDMA_COMPL_STATUS_INVALID_TOTAL_LEN,\n\tIRDMA_COMPL_STATUS_UNKNOWN,\n};\n\nenum irdma_cmpl_notify {\n\tIRDMA_CQ_COMPL_EVENT     = 0,\n\tIRDMA_CQ_COMPL_SOLICITED = 1,\n};\n\nenum irdma_qp_caps {\n\tIRDMA_WRITE_WITH_IMM = 1,\n\tIRDMA_SEND_WITH_IMM  = 2,\n\tIRDMA_ROCE\t     = 4,\n\tIRDMA_PUSH_MODE      = 8,\n};\n\nstruct irdma_qp_uk;\nstruct irdma_cq_uk;\nstruct irdma_qp_uk_init_info;\nstruct irdma_cq_uk_init_info;\n\nstruct irdma_ring {\n\tu32 head;\n\tu32 tail;\n\tu32 size;\n};\n\nstruct irdma_cqe {\n\t__le64 buf[IRDMA_CQE_SIZE];\n};\n\nstruct irdma_extended_cqe {\n\t__le64 buf[IRDMA_EXTENDED_CQE_SIZE];\n};\n\nstruct irdma_post_send {\n\tstruct ib_sge *sg_list;\n\tu32 num_sges;\n\tu32 qkey;\n\tu32 dest_qp;\n\tu32 ah_id;\n};\n\nstruct irdma_post_rq_info {\n\tu64 wr_id;\n\tstruct ib_sge *sg_list;\n\tu32 num_sges;\n};\n\nstruct irdma_rdma_write {\n\tstruct ib_sge *lo_sg_list;\n\tu32 num_lo_sges;\n\tstruct ib_sge rem_addr;\n};\n\nstruct irdma_rdma_read {\n\tstruct ib_sge *lo_sg_list;\n\tu32 num_lo_sges;\n\tstruct ib_sge rem_addr;\n};\n\nstruct irdma_bind_window {\n\tirdma_stag mr_stag;\n\tu64 bind_len;\n\tvoid *va;\n\tenum irdma_addressing_type addressing_type;\n\tbool ena_reads:1;\n\tbool ena_writes:1;\n\tirdma_stag mw_stag;\n\tbool mem_window_type_1:1;\n};\n\nstruct irdma_inv_local_stag {\n\tirdma_stag target_stag;\n};\n\nstruct irdma_post_sq_info {\n\tu64 wr_id;\n\tu8 op_type;\n\tu8 l4len;\n\tbool signaled:1;\n\tbool read_fence:1;\n\tbool local_fence:1;\n\tbool inline_data:1;\n\tbool imm_data_valid:1;\n\tbool report_rtt:1;\n\tbool udp_hdr:1;\n\tbool defer_flag:1;\n\tu32 imm_data;\n\tu32 stag_to_inv;\n\tunion {\n\t\tstruct irdma_post_send send;\n\t\tstruct irdma_rdma_write rdma_write;\n\t\tstruct irdma_rdma_read rdma_read;\n\t\tstruct irdma_bind_window bind_window;\n\t\tstruct irdma_inv_local_stag inv_local_stag;\n\t} op;\n};\n\nstruct irdma_cq_poll_info {\n\tu64 wr_id;\n\tirdma_qp_handle qp_handle;\n\tu32 bytes_xfered;\n\tu32 tcp_seq_num_rtt;\n\tu32 qp_id;\n\tu32 ud_src_qpn;\n\tu32 imm_data;\n\tirdma_stag inv_stag;  \n\tenum irdma_cmpl_status comp_status;\n\tu16 major_err;\n\tu16 minor_err;\n\tu16 ud_vlan;\n\tu8 ud_smac[6];\n\tu8 op_type;\n\tu8 q_type;\n\tbool stag_invalid_set:1;  \n\tbool error:1;\n\tbool solicited_event:1;\n\tbool ipv4:1;\n\tbool ud_vlan_valid:1;\n\tbool ud_smac_valid:1;\n\tbool imm_valid:1;\n};\n\nint irdma_uk_inline_rdma_write(struct irdma_qp_uk *qp,\n\t\t\t       struct irdma_post_sq_info *info, bool post_sq);\nint irdma_uk_inline_send(struct irdma_qp_uk *qp,\n\t\t\t struct irdma_post_sq_info *info, bool post_sq);\nint irdma_uk_post_nop(struct irdma_qp_uk *qp, u64 wr_id, bool signaled,\n\t\t      bool post_sq);\nint irdma_uk_post_receive(struct irdma_qp_uk *qp,\n\t\t\t  struct irdma_post_rq_info *info);\nvoid irdma_uk_qp_post_wr(struct irdma_qp_uk *qp);\nint irdma_uk_rdma_read(struct irdma_qp_uk *qp, struct irdma_post_sq_info *info,\n\t\t       bool inv_stag, bool post_sq);\nint irdma_uk_rdma_write(struct irdma_qp_uk *qp, struct irdma_post_sq_info *info,\n\t\t\tbool post_sq);\nint irdma_uk_send(struct irdma_qp_uk *qp, struct irdma_post_sq_info *info,\n\t\t  bool post_sq);\nint irdma_uk_stag_local_invalidate(struct irdma_qp_uk *qp,\n\t\t\t\t   struct irdma_post_sq_info *info,\n\t\t\t\t   bool post_sq);\n\nstruct irdma_wqe_uk_ops {\n\tvoid (*iw_copy_inline_data)(u8 *dest, struct ib_sge *sge_list,\n\t\t\t\t    u32 num_sges, u8 polarity);\n\tu16 (*iw_inline_data_size_to_quanta)(u32 data_size);\n\tvoid (*iw_set_fragment)(__le64 *wqe, u32 offset, struct ib_sge *sge,\n\t\t\t\tu8 valid);\n\tvoid (*iw_set_mw_bind_wqe)(__le64 *wqe,\n\t\t\t\t   struct irdma_bind_window *op_info);\n};\n\nint irdma_uk_cq_poll_cmpl(struct irdma_cq_uk *cq,\n\t\t\t  struct irdma_cq_poll_info *info);\nvoid irdma_uk_cq_request_notification(struct irdma_cq_uk *cq,\n\t\t\t\t      enum irdma_cmpl_notify cq_notify);\nvoid irdma_uk_cq_resize(struct irdma_cq_uk *cq, void *cq_base, int size);\nvoid irdma_uk_cq_set_resized_cnt(struct irdma_cq_uk *qp, u16 cnt);\nvoid irdma_uk_cq_init(struct irdma_cq_uk *cq,\n\t\t      struct irdma_cq_uk_init_info *info);\nint irdma_uk_qp_init(struct irdma_qp_uk *qp,\n\t\t     struct irdma_qp_uk_init_info *info);\nvoid irdma_uk_calc_shift_wq(struct irdma_qp_uk_init_info *ukinfo, u8 *sq_shift,\n\t\t\t    u8 *rq_shift);\nint irdma_uk_calc_depth_shift_sq(struct irdma_qp_uk_init_info *ukinfo,\n\t\t\t\t u32 *sq_depth, u8 *sq_shift);\nint irdma_uk_calc_depth_shift_rq(struct irdma_qp_uk_init_info *ukinfo,\n\t\t\t\t u32 *rq_depth, u8 *rq_shift);\nstruct irdma_sq_uk_wr_trk_info {\n\tu64 wrid;\n\tu32 wr_len;\n\tu16 quanta;\n\tu8 reserved[2];\n};\n\nstruct irdma_qp_quanta {\n\t__le64 elem[IRDMA_WQE_SIZE];\n};\n\nstruct irdma_qp_uk {\n\tstruct irdma_qp_quanta *sq_base;\n\tstruct irdma_qp_quanta *rq_base;\n\tstruct irdma_uk_attrs *uk_attrs;\n\tu32 __iomem *wqe_alloc_db;\n\tstruct irdma_sq_uk_wr_trk_info *sq_wrtrk_array;\n\tu64 *rq_wrid_array;\n\t__le64 *shadow_area;\n\tstruct irdma_ring sq_ring;\n\tstruct irdma_ring rq_ring;\n\tstruct irdma_ring initial_ring;\n\tu32 qp_id;\n\tu32 qp_caps;\n\tu32 sq_size;\n\tu32 rq_size;\n\tu32 max_sq_frag_cnt;\n\tu32 max_rq_frag_cnt;\n\tu32 max_inline_data;\n\tstruct irdma_wqe_uk_ops wqe_ops;\n\tu16 conn_wqes;\n\tu8 qp_type;\n\tu8 swqe_polarity;\n\tu8 swqe_polarity_deferred;\n\tu8 rwqe_polarity;\n\tu8 rq_wqe_size;\n\tu8 rq_wqe_size_multiplier;\n\tbool deferred_flag:1;\n\tbool first_sq_wq:1;\n\tbool sq_flush_complete:1;  \n\tbool rq_flush_complete:1;  \n\tbool destroy_pending:1;  \n\tvoid *back_qp;\n\tu8 dbg_rq_flushed;\n\tu8 sq_flush_seen;\n\tu8 rq_flush_seen;\n};\n\nstruct irdma_cq_uk {\n\tstruct irdma_cqe *cq_base;\n\tu32 __iomem *cqe_alloc_db;\n\tu32 __iomem *cq_ack_db;\n\t__le64 *shadow_area;\n\tu32 cq_id;\n\tu32 cq_size;\n\tstruct irdma_ring cq_ring;\n\tu8 polarity;\n\tbool avoid_mem_cflct:1;\n};\n\nstruct irdma_qp_uk_init_info {\n\tstruct irdma_qp_quanta *sq;\n\tstruct irdma_qp_quanta *rq;\n\tstruct irdma_uk_attrs *uk_attrs;\n\tu32 __iomem *wqe_alloc_db;\n\t__le64 *shadow_area;\n\tstruct irdma_sq_uk_wr_trk_info *sq_wrtrk_array;\n\tu64 *rq_wrid_array;\n\tu32 qp_id;\n\tu32 qp_caps;\n\tu32 sq_size;\n\tu32 rq_size;\n\tu32 max_sq_frag_cnt;\n\tu32 max_rq_frag_cnt;\n\tu32 max_inline_data;\n\tu32 sq_depth;\n\tu32 rq_depth;\n\tu8 first_sq_wq;\n\tu8 type;\n\tu8 sq_shift;\n\tu8 rq_shift;\n\tint abi_ver;\n\tbool legacy_mode;\n};\n\nstruct irdma_cq_uk_init_info {\n\tu32 __iomem *cqe_alloc_db;\n\tu32 __iomem *cq_ack_db;\n\tstruct irdma_cqe *cq_base;\n\t__le64 *shadow_area;\n\tu32 cq_size;\n\tu32 cq_id;\n\tbool avoid_mem_cflct;\n};\n\n__le64 *irdma_qp_get_next_send_wqe(struct irdma_qp_uk *qp, u32 *wqe_idx,\n\t\t\t\t   u16 quanta, u32 total_size,\n\t\t\t\t   struct irdma_post_sq_info *info);\n__le64 *irdma_qp_get_next_recv_wqe(struct irdma_qp_uk *qp, u32 *wqe_idx);\nvoid irdma_uk_clean_cq(void *q, struct irdma_cq_uk *cq);\nint irdma_nop(struct irdma_qp_uk *qp, u64 wr_id, bool signaled, bool post_sq);\nint irdma_fragcnt_to_quanta_sq(u32 frag_cnt, u16 *quanta);\nint irdma_fragcnt_to_wqesize_rq(u32 frag_cnt, u16 *wqe_size);\nvoid irdma_get_wqe_shift(struct irdma_uk_attrs *uk_attrs, u32 sge,\n\t\t\t u32 inline_data, u8 *shift);\nint irdma_get_sqdepth(struct irdma_uk_attrs *uk_attrs, u32 sq_size, u8 shift,\n\t\t      u32 *wqdepth);\nint irdma_get_rqdepth(struct irdma_uk_attrs *uk_attrs, u32 rq_size, u8 shift,\n\t\t      u32 *wqdepth);\nvoid irdma_clr_wqes(struct irdma_qp_uk *qp, u32 qp_wqe_idx);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}