{
  "module_name": "rdma_core.h",
  "hash_id": "9c397213514d069ac957a3b769cc70c08a861a8e00ffc7109d4f341e0d7008e0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/core/rdma_core.h",
  "human_readable_source": " \n\n#ifndef RDMA_CORE_H\n#define RDMA_CORE_H\n\n#include <linux/idr.h>\n#include <rdma/uverbs_types.h>\n#include <rdma/uverbs_ioctl.h>\n#include <rdma/ib_verbs.h>\n#include <linux/mutex.h>\n\nstruct ib_uverbs_device;\n\nvoid uverbs_destroy_ufile_hw(struct ib_uverbs_file *ufile,\n\t\t\t     enum rdma_remove_reason reason);\n\nint uobj_destroy(struct ib_uobject *uobj, struct uverbs_attr_bundle *attrs);\n\n \nstruct ib_uobject *\nuverbs_get_uobject_from_file(u16 object_id, enum uverbs_obj_access access,\n\t\t\t     s64 id, struct uverbs_attr_bundle *attrs);\n\nvoid uverbs_finalize_object(struct ib_uobject *uobj,\n\t\t\t    enum uverbs_obj_access access, bool hw_obj_valid,\n\t\t\t    bool commit, struct uverbs_attr_bundle *attrs);\n\nint uverbs_output_written(const struct uverbs_attr_bundle *bundle, size_t idx);\n\nvoid setup_ufile_idr_uobject(struct ib_uverbs_file *ufile);\nvoid release_ufile_idr_uobject(struct ib_uverbs_file *ufile);\n\nstruct ib_udata *uverbs_get_cleared_udata(struct uverbs_attr_bundle *attrs);\n\n \n\n \n\nstruct uverbs_api_ioctl_method {\n\tint(__rcu *handler)(struct uverbs_attr_bundle *attrs);\n\tDECLARE_BITMAP(attr_mandatory, UVERBS_API_ATTR_BKEY_LEN);\n\tu16 bundle_size;\n\tu8 use_stack:1;\n\tu8 driver_method:1;\n\tu8 disabled:1;\n\tu8 has_udata:1;\n\tu8 key_bitmap_len;\n\tu8 destroy_bkey;\n};\n\nstruct uverbs_api_write_method {\n\tint (*handler)(struct uverbs_attr_bundle *attrs);\n\tu8 disabled:1;\n\tu8 is_ex:1;\n\tu8 has_udata:1;\n\tu8 has_resp:1;\n\tu8 req_size;\n\tu8 resp_size;\n};\n\nstruct uverbs_api_attr {\n\tstruct uverbs_attr_spec spec;\n};\n\nstruct uverbs_api {\n\t \n\tstruct radix_tree_root radix;\n\tenum rdma_driver_id driver_id;\n\n\tunsigned int num_write;\n\tunsigned int num_write_ex;\n\tstruct uverbs_api_write_method notsupp_method;\n\tconst struct uverbs_api_write_method **write_methods;\n\tconst struct uverbs_api_write_method **write_ex_methods;\n};\n\n \nstatic inline const struct uverbs_api_object *\nuapi_get_object(struct uverbs_api *uapi, u16 object_id)\n{\n\tconst struct uverbs_api_object *res;\n\n\tif (object_id == UVERBS_IDR_ANY_OBJECT)\n\t\treturn ERR_PTR(-ENOMSG);\n\n\tres = radix_tree_lookup(&uapi->radix, uapi_key_obj(object_id));\n\tif (!res)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn res;\n}\n\nchar *uapi_key_format(char *S, unsigned int key);\nstruct uverbs_api *uverbs_alloc_api(struct ib_device *ibdev);\nvoid uverbs_disassociate_api_pre(struct ib_uverbs_device *uverbs_dev);\nvoid uverbs_disassociate_api(struct uverbs_api *uapi);\nvoid uverbs_destroy_api(struct uverbs_api *uapi);\nvoid uapi_compute_bundle_size(struct uverbs_api_ioctl_method *method_elm,\n\t\t\t      unsigned int num_attrs);\nvoid uverbs_user_mmap_disassociate(struct ib_uverbs_file *ufile);\n\nextern const struct uapi_definition uverbs_def_obj_async_fd[];\nextern const struct uapi_definition uverbs_def_obj_counters[];\nextern const struct uapi_definition uverbs_def_obj_cq[];\nextern const struct uapi_definition uverbs_def_obj_device[];\nextern const struct uapi_definition uverbs_def_obj_dm[];\nextern const struct uapi_definition uverbs_def_obj_flow_action[];\nextern const struct uapi_definition uverbs_def_obj_intf[];\nextern const struct uapi_definition uverbs_def_obj_mr[];\nextern const struct uapi_definition uverbs_def_obj_qp[];\nextern const struct uapi_definition uverbs_def_obj_srq[];\nextern const struct uapi_definition uverbs_def_obj_wq[];\nextern const struct uapi_definition uverbs_def_write_intf[];\n\nstatic inline const struct uverbs_api_write_method *\nuapi_get_method(const struct uverbs_api *uapi, u32 command)\n{\n\tu32 cmd_idx = command & IB_USER_VERBS_CMD_COMMAND_MASK;\n\n\tif (command & ~(u32)(IB_USER_VERBS_CMD_FLAG_EXTENDED |\n\t\t\t     IB_USER_VERBS_CMD_COMMAND_MASK))\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (command & IB_USER_VERBS_CMD_FLAG_EXTENDED) {\n\t\tif (cmd_idx >= uapi->num_write_ex)\n\t\t\treturn ERR_PTR(-EOPNOTSUPP);\n\t\treturn uapi->write_ex_methods[cmd_idx];\n\t}\n\n\tif (cmd_idx >= uapi->num_write)\n\t\treturn ERR_PTR(-EOPNOTSUPP);\n\treturn uapi->write_methods[cmd_idx];\n}\n\nvoid uverbs_fill_udata(struct uverbs_attr_bundle *bundle,\n\t\t       struct ib_udata *udata, unsigned int attr_in,\n\t\t       unsigned int attr_out);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}