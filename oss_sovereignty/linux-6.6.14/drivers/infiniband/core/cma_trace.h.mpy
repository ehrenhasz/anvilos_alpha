{
  "module_name": "cma_trace.h",
  "hash_id": "162576723592cc2951ef65a383e284259dcd4990de28ea880a94db4bf1c334eb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/infiniband/core/cma_trace.h",
  "human_readable_source": " \n \n\n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM rdma_cma\n\n#if !defined(_TRACE_RDMA_CMA_H) || defined(TRACE_HEADER_MULTI_READ)\n\n#define _TRACE_RDMA_CMA_H\n\n#include <linux/tracepoint.h>\n#include <trace/misc/rdma.h>\n\n\nDECLARE_EVENT_CLASS(cma_fsm_class,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv\n\t),\n\n\tTP_ARGS(id_priv),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, tos)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr, __entry->tos\n\t)\n);\n\n#define DEFINE_CMA_FSM_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(cma_fsm_class, cm_##name,\t\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\t\t\tconst struct rdma_id_private *id_priv\t\\\n\t\t\t\t),\t\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(id_priv))\n\nDEFINE_CMA_FSM_EVENT(send_rtu);\nDEFINE_CMA_FSM_EVENT(send_rej);\nDEFINE_CMA_FSM_EVENT(send_mra);\nDEFINE_CMA_FSM_EVENT(send_sidr_req);\nDEFINE_CMA_FSM_EVENT(send_sidr_rep);\nDEFINE_CMA_FSM_EVENT(disconnect);\nDEFINE_CMA_FSM_EVENT(sent_drep);\nDEFINE_CMA_FSM_EVENT(sent_dreq);\nDEFINE_CMA_FSM_EVENT(id_destroy);\n\nTRACE_EVENT(cm_id_attach,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv,\n\t\tconst struct ib_device *device\n\t),\n\n\tTP_ARGS(id_priv, device),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t\t__string(devname, device->name)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\t__assign_str(devname, device->name);\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc device=%s\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr,\n\t\t__get_str(devname)\n\t)\n);\n\nDECLARE_EVENT_CLASS(cma_qp_class,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv\n\t),\n\n\tTP_ARGS(id_priv),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, tos)\n\t\t__field(u32, qp_num)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\t__entry->qp_num = id_priv->qp_num;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u qp_num=%u\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr, __entry->tos,\n\t\t__entry->qp_num\n\t)\n);\n\n#define DEFINE_CMA_QP_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(cma_qp_class, cm_##name,\t\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\t\t\tconst struct rdma_id_private *id_priv\t\\\n\t\t\t\t),\t\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(id_priv))\n\nDEFINE_CMA_QP_EVENT(send_req);\nDEFINE_CMA_QP_EVENT(send_rep);\nDEFINE_CMA_QP_EVENT(qp_destroy);\n\n \n#define IB_QP_TYPE_LIST\t\t\t\t\\\n\tib_qp_type(SMI)\t\t\t\t\\\n\tib_qp_type(GSI)\t\t\t\t\\\n\tib_qp_type(RC)\t\t\t\t\\\n\tib_qp_type(UC)\t\t\t\t\\\n\tib_qp_type(UD)\t\t\t\t\\\n\tib_qp_type(RAW_IPV6)\t\t\t\\\n\tib_qp_type(RAW_ETHERTYPE)\t\t\\\n\tib_qp_type(RAW_PACKET)\t\t\t\\\n\tib_qp_type(XRC_INI)\t\t\t\\\n\tib_qp_type_end(XRC_TGT)\n\n#undef ib_qp_type\n#undef ib_qp_type_end\n\n#define ib_qp_type(x)\t\tTRACE_DEFINE_ENUM(IB_QPT_##x);\n#define ib_qp_type_end(x)\tTRACE_DEFINE_ENUM(IB_QPT_##x);\n\nIB_QP_TYPE_LIST\n\n#undef ib_qp_type\n#undef ib_qp_type_end\n\n#define ib_qp_type(x)\t\t{ IB_QPT_##x, #x },\n#define ib_qp_type_end(x)\t{ IB_QPT_##x, #x }\n\n#define rdma_show_qp_type(x) \\\n\t\t__print_symbolic(x, IB_QP_TYPE_LIST)\n\n\nTRACE_EVENT(cm_qp_create,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv,\n\t\tconst struct ib_pd *pd,\n\t\tconst struct ib_qp_init_attr *qp_init_attr,\n\t\tint rc\n\t),\n\n\tTP_ARGS(id_priv, pd, qp_init_attr, rc),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, pd_id)\n\t\t__field(u32, tos)\n\t\t__field(u32, qp_num)\n\t\t__field(u32, send_wr)\n\t\t__field(u32, recv_wr)\n\t\t__field(int, rc)\n\t\t__field(unsigned long, qp_type)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->pd_id = pd->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\t__entry->send_wr = qp_init_attr->cap.max_send_wr;\n\t\t__entry->recv_wr = qp_init_attr->cap.max_recv_wr;\n\t\t__entry->rc = rc;\n\t\tif (!rc) {\n\t\t\t__entry->qp_num = id_priv->qp_num;\n\t\t\t__entry->qp_type = id_priv->id.qp_type;\n\t\t} else {\n\t\t\t__entry->qp_num = 0;\n\t\t\t__entry->qp_type = 0;\n\t\t}\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u pd.id=%u qp_type=%s\"\n\t\t\" send_wr=%u recv_wr=%u qp_num=%u rc=%d\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr,\n\t\t__entry->tos, __entry->pd_id,\n\t\trdma_show_qp_type(__entry->qp_type), __entry->send_wr,\n\t\t__entry->recv_wr, __entry->qp_num, __entry->rc\n\t)\n);\n\nTRACE_EVENT(cm_req_handler,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv,\n\t\tint event\n\t),\n\n\tTP_ARGS(id_priv, event),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, tos)\n\t\t__field(unsigned long, event)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\t__entry->event = event;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u %s (%lu)\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr, __entry->tos,\n\t\trdma_show_ib_cm_event(__entry->event), __entry->event\n\t)\n);\n\nTRACE_EVENT(cm_event_handler,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv,\n\t\tconst struct rdma_cm_event *event\n\t),\n\n\tTP_ARGS(id_priv, event),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, tos)\n\t\t__field(unsigned long, event)\n\t\t__field(int, status)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\t__entry->event = event->event;\n\t\t__entry->status = event->status;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u %s (%lu/%d)\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr, __entry->tos,\n\t\trdma_show_cm_event(__entry->event), __entry->event,\n\t\t__entry->status\n\t)\n);\n\nTRACE_EVENT(cm_event_done,\n\tTP_PROTO(\n\t\tconst struct rdma_id_private *id_priv,\n\t\tconst struct rdma_cm_event *event,\n\t\tint result\n\t),\n\n\tTP_ARGS(id_priv, event, result),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, cm_id)\n\t\t__field(u32, tos)\n\t\t__field(unsigned long, event)\n\t\t__field(int, result)\n\t\t__array(unsigned char, srcaddr, sizeof(struct sockaddr_in6))\n\t\t__array(unsigned char, dstaddr, sizeof(struct sockaddr_in6))\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->cm_id = id_priv->res.id;\n\t\t__entry->tos = id_priv->tos;\n\t\t__entry->event = event->event;\n\t\t__entry->result = result;\n\t\tmemcpy(__entry->srcaddr, &id_priv->id.route.addr.src_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t\tmemcpy(__entry->dstaddr, &id_priv->id.route.addr.dst_addr,\n\t\t       sizeof(struct sockaddr_in6));\n\t),\n\n\tTP_printk(\"cm.id=%u src=%pISpc dst=%pISpc tos=%u %s consumer returns %d\",\n\t\t__entry->cm_id, __entry->srcaddr, __entry->dstaddr, __entry->tos,\n\t\trdma_show_cm_event(__entry->event), __entry->result\n\t)\n);\n\nDECLARE_EVENT_CLASS(cma_client_class,\n\tTP_PROTO(\n\t\tconst struct ib_device *device\n\t),\n\n\tTP_ARGS(device),\n\n\tTP_STRUCT__entry(\n\t\t__string(name, device->name)\n\t),\n\n\tTP_fast_assign(\n\t\t__assign_str(name, device->name);\n\t),\n\n\tTP_printk(\"device name=%s\",\n\t\t__get_str(name)\n\t)\n);\n\n#define DEFINE_CMA_CLIENT_EVENT(name)\t\t\t\t\t\t\\\n\t\tDEFINE_EVENT(cma_client_class, cm_##name,\t\t\t\\\n\t\t\t\tTP_PROTO(\t\t\t\t\t\\\n\t\t\t\t\tconst struct ib_device *device\t\t\\\n\t\t\t\t),\t\t\t\t\t\t\\\n\t\t\t\tTP_ARGS(device))\n\nDEFINE_CMA_CLIENT_EVENT(add_one);\nDEFINE_CMA_CLIENT_EVENT(remove_one);\n\n#endif  \n\n#undef TRACE_INCLUDE_PATH\n#define TRACE_INCLUDE_PATH .\n#define TRACE_INCLUDE_FILE cma_trace\n\n#include <trace/define_trace.h>\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}