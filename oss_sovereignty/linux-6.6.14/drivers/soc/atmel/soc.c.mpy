{
  "module_name": "soc.c",
  "hash_id": "65c860334352c00445c4d417bcfd575cb6af246bfe4f084e422fb636d9de762c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/soc/atmel/soc.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt)\t\"AT91: \" fmt\n\n#include <linux/io.h>\n#include <linux/of.h>\n#include <linux/of_address.h>\n#include <linux/of_platform.h>\n#include <linux/slab.h>\n#include <linux/sys_soc.h>\n\n#include \"soc.h\"\n\n#define AT91_DBGU_CIDR\t\t\t0x40\n#define AT91_DBGU_EXID\t\t\t0x44\n#define AT91_CHIPID_CIDR\t\t0x00\n#define AT91_CHIPID_EXID\t\t0x04\n#define AT91_CIDR_VERSION(x, m)\t\t((x) & (m))\n#define AT91_CIDR_VERSION_MASK\t\tGENMASK(4, 0)\n#define AT91_CIDR_VERSION_MASK_SAMA7G5\tGENMASK(3, 0)\n#define AT91_CIDR_EXT\t\t\tBIT(31)\n#define AT91_CIDR_MATCH_MASK\t\tGENMASK(30, 5)\n#define AT91_CIDR_MASK_SAMA7G5\t\tGENMASK(27, 5)\n\nstatic const struct at91_soc socs[] __initconst = {\n#ifdef CONFIG_SOC_AT91RM9200\n\tAT91_SOC(AT91RM9200_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91rm9200 BGA\", \"at91rm9200\"),\n#endif\n#ifdef CONFIG_SOC_AT91SAM9\n\tAT91_SOC(AT91SAM9260_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9260\", NULL),\n\tAT91_SOC(AT91SAM9261_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9261\", NULL),\n\tAT91_SOC(AT91SAM9263_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9263\", NULL),\n\tAT91_SOC(AT91SAM9G20_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9g20\", NULL),\n\tAT91_SOC(AT91SAM9RL64_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9rl64\", NULL),\n\tAT91_SOC(AT91SAM9G45_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9M11_EXID_MATCH,\n\t\t \"at91sam9m11\", \"at91sam9g45\"),\n\tAT91_SOC(AT91SAM9G45_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9M10_EXID_MATCH,\n\t\t \"at91sam9m10\", \"at91sam9g45\"),\n\tAT91_SOC(AT91SAM9G45_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9G46_EXID_MATCH,\n\t\t \"at91sam9g46\", \"at91sam9g45\"),\n\tAT91_SOC(AT91SAM9G45_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9G45_EXID_MATCH,\n\t\t \"at91sam9g45\", \"at91sam9g45\"),\n\tAT91_SOC(AT91SAM9X5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9G15_EXID_MATCH,\n\t\t \"at91sam9g15\", \"at91sam9x5\"),\n\tAT91_SOC(AT91SAM9X5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9G35_EXID_MATCH,\n\t\t \"at91sam9g35\", \"at91sam9x5\"),\n\tAT91_SOC(AT91SAM9X5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9X35_EXID_MATCH,\n\t\t \"at91sam9x35\", \"at91sam9x5\"),\n\tAT91_SOC(AT91SAM9X5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9G25_EXID_MATCH,\n\t\t \"at91sam9g25\", \"at91sam9x5\"),\n\tAT91_SOC(AT91SAM9X5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9X25_EXID_MATCH,\n\t\t \"at91sam9x25\", \"at91sam9x5\"),\n\tAT91_SOC(AT91SAM9N12_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9CN12_EXID_MATCH,\n\t\t \"at91sam9cn12\", \"at91sam9n12\"),\n\tAT91_SOC(AT91SAM9N12_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9N12_EXID_MATCH,\n\t\t \"at91sam9n12\", \"at91sam9n12\"),\n\tAT91_SOC(AT91SAM9N12_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, AT91SAM9CN11_EXID_MATCH,\n\t\t \"at91sam9cn11\", \"at91sam9n12\"),\n\tAT91_SOC(AT91SAM9XE128_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9xe128\", \"at91sam9xe128\"),\n\tAT91_SOC(AT91SAM9XE256_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9xe256\", \"at91sam9xe256\"),\n\tAT91_SOC(AT91SAM9XE512_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, 0, \"at91sam9xe512\", \"at91sam9xe512\"),\n#endif\n#ifdef CONFIG_SOC_SAM9X60\n\tAT91_SOC(SAM9X60_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAM9X60_EXID_MATCH,\n\t\t \"sam9x60\", \"sam9x60\"),\n\tAT91_SOC(SAM9X60_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAM9X60_D5M_EXID_MATCH,\n\t\t \"sam9x60 64MiB DDR2 SiP\", \"sam9x60\"),\n\tAT91_SOC(SAM9X60_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAM9X60_D1G_EXID_MATCH,\n\t\t \"sam9x60 128MiB DDR2 SiP\", \"sam9x60\"),\n\tAT91_SOC(SAM9X60_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAM9X60_D6K_EXID_MATCH,\n\t\t \"sam9x60 8MiB SDRAM SiP\", \"sam9x60\"),\n#endif\n#ifdef CONFIG_SOC_SAMA5\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D21CU_EXID_MATCH,\n\t\t \"sama5d21\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D22CU_EXID_MATCH,\n\t\t \"sama5d22\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D225C_D1M_EXID_MATCH,\n\t\t \"sama5d225c 16MiB SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D23CU_EXID_MATCH,\n\t\t \"sama5d23\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D24CX_EXID_MATCH,\n\t\t \"sama5d24\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D24CU_EXID_MATCH,\n\t\t \"sama5d24\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D26CU_EXID_MATCH,\n\t\t \"sama5d26\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27CU_EXID_MATCH,\n\t\t \"sama5d27\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27CN_EXID_MATCH,\n\t\t \"sama5d27\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27C_D1G_EXID_MATCH,\n\t\t \"sama5d27c 128MiB SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27C_D5M_EXID_MATCH,\n\t\t \"sama5d27c 64MiB SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27C_LD1G_EXID_MATCH,\n\t\t \"sama5d27c 128MiB LPDDR2 SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D27C_LD2G_EXID_MATCH,\n\t\t \"sama5d27c 256MiB LPDDR2 SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D28CU_EXID_MATCH,\n\t\t \"sama5d28\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D28CN_EXID_MATCH,\n\t\t \"sama5d28\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D28C_D1G_EXID_MATCH,\n\t\t \"sama5d28c 128MiB SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D28C_LD1G_EXID_MATCH,\n\t\t \"sama5d28c 128MiB LPDDR2 SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D28C_LD2G_EXID_MATCH,\n\t\t \"sama5d28c 256MiB LPDDR2 SiP\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D2_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D29CN_EXID_MATCH,\n\t\t \"sama5d29\", \"sama5d2\"),\n\tAT91_SOC(SAMA5D3_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D31_EXID_MATCH,\n\t\t \"sama5d31\", \"sama5d3\"),\n\tAT91_SOC(SAMA5D3_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D33_EXID_MATCH,\n\t\t \"sama5d33\", \"sama5d3\"),\n\tAT91_SOC(SAMA5D3_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D34_EXID_MATCH,\n\t\t \"sama5d34\", \"sama5d3\"),\n\tAT91_SOC(SAMA5D3_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D35_EXID_MATCH,\n\t\t \"sama5d35\", \"sama5d3\"),\n\tAT91_SOC(SAMA5D3_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D36_EXID_MATCH,\n\t\t \"sama5d36\", \"sama5d3\"),\n\tAT91_SOC(SAMA5D4_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D41_EXID_MATCH,\n\t\t \"sama5d41\", \"sama5d4\"),\n\tAT91_SOC(SAMA5D4_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D42_EXID_MATCH,\n\t\t \"sama5d42\", \"sama5d4\"),\n\tAT91_SOC(SAMA5D4_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D43_EXID_MATCH,\n\t\t \"sama5d43\", \"sama5d4\"),\n\tAT91_SOC(SAMA5D4_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMA5D44_EXID_MATCH,\n\t\t \"sama5d44\", \"sama5d4\"),\n#endif\n#ifdef CONFIG_SOC_SAMV7\n\tAT91_SOC(SAME70Q21_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAME70Q21_EXID_MATCH,\n\t\t \"same70q21\", \"same7\"),\n\tAT91_SOC(SAME70Q20_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAME70Q20_EXID_MATCH,\n\t\t \"same70q20\", \"same7\"),\n\tAT91_SOC(SAME70Q19_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAME70Q19_EXID_MATCH,\n\t\t \"same70q19\", \"same7\"),\n\tAT91_SOC(SAMS70Q21_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMS70Q21_EXID_MATCH,\n\t\t \"sams70q21\", \"sams7\"),\n\tAT91_SOC(SAMS70Q20_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMS70Q20_EXID_MATCH,\n\t\t \"sams70q20\", \"sams7\"),\n\tAT91_SOC(SAMS70Q19_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMS70Q19_EXID_MATCH,\n\t\t \"sams70q19\", \"sams7\"),\n\tAT91_SOC(SAMV71Q21_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMV71Q21_EXID_MATCH,\n\t\t \"samv71q21\", \"samv7\"),\n\tAT91_SOC(SAMV71Q20_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMV71Q20_EXID_MATCH,\n\t\t \"samv71q20\", \"samv7\"),\n\tAT91_SOC(SAMV71Q19_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMV71Q19_EXID_MATCH,\n\t\t \"samv71q19\", \"samv7\"),\n\tAT91_SOC(SAMV70Q20_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMV70Q20_EXID_MATCH,\n\t\t \"samv70q20\", \"samv7\"),\n\tAT91_SOC(SAMV70Q19_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK, SAMV70Q19_EXID_MATCH,\n\t\t \"samv70q19\", \"samv7\"),\n#endif\n#ifdef CONFIG_SOC_SAMA7\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G51_EXID_MATCH,\n\t\t \"sama7g51\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G52_EXID_MATCH,\n\t\t \"sama7g52\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G53_EXID_MATCH,\n\t\t \"sama7g53\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G54_EXID_MATCH,\n\t\t \"sama7g54\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G54_D1G_EXID_MATCH,\n\t\t \"SAMA7G54 1Gb DDR3L SiP\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G54_D2G_EXID_MATCH,\n\t\t \"SAMA7G54 2Gb DDR3L SiP\", \"sama7g5\"),\n\tAT91_SOC(SAMA7G5_CIDR_MATCH, AT91_CIDR_MATCH_MASK,\n\t\t AT91_CIDR_VERSION_MASK_SAMA7G5, SAMA7G54_D4G_EXID_MATCH,\n\t\t \"SAMA7G54 4Gb DDR3L SiP\", \"sama7g5\"),\n#endif\n\t{   },\n};\n\nstatic int __init at91_get_cidr_exid_from_dbgu(u32 *cidr, u32 *exid)\n{\n\tstruct device_node *np;\n\tvoid __iomem *regs;\n\n\tnp = of_find_compatible_node(NULL, NULL, \"atmel,at91rm9200-dbgu\");\n\tif (!np)\n\t\tnp = of_find_compatible_node(NULL, NULL,\n\t\t\t\t\t     \"atmel,at91sam9260-dbgu\");\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tregs = of_iomap(np, 0);\n\tof_node_put(np);\n\n\tif (!regs) {\n\t\tpr_warn(\"Could not map DBGU iomem range\");\n\t\treturn -ENXIO;\n\t}\n\n\t*cidr = readl(regs + AT91_DBGU_CIDR);\n\t*exid = readl(regs + AT91_DBGU_EXID);\n\n\tiounmap(regs);\n\n\treturn 0;\n}\n\nstatic int __init at91_get_cidr_exid_from_chipid(u32 *cidr, u32 *exid)\n{\n\tstruct device_node *np;\n\tvoid __iomem *regs;\n\tstatic const struct of_device_id chipids[] = {\n\t\t{ .compatible = \"atmel,sama5d2-chipid\" },\n\t\t{ .compatible = \"microchip,sama7g5-chipid\" },\n\t\t{ },\n\t};\n\n\tnp = of_find_matching_node(NULL, chipids);\n\tif (!np)\n\t\treturn -ENODEV;\n\n\tregs = of_iomap(np, 0);\n\tof_node_put(np);\n\n\tif (!regs) {\n\t\tpr_warn(\"Could not map DBGU iomem range\");\n\t\treturn -ENXIO;\n\t}\n\n\t*cidr = readl(regs + AT91_CHIPID_CIDR);\n\t*exid = readl(regs + AT91_CHIPID_EXID);\n\n\tiounmap(regs);\n\n\treturn 0;\n}\n\nstruct soc_device * __init at91_soc_init(const struct at91_soc *socs)\n{\n\tstruct soc_device_attribute *soc_dev_attr;\n\tconst struct at91_soc *soc;\n\tstruct soc_device *soc_dev;\n\tu32 cidr, exid;\n\tint ret;\n\n\t \n\tret = at91_get_cidr_exid_from_dbgu(&cidr, &exid);\n\tif (ret)\n\t\tret = at91_get_cidr_exid_from_chipid(&cidr, &exid);\n\tif (ret) {\n\t\tif (ret == -ENODEV)\n\t\t\tpr_warn(\"Could not find identification node\");\n\t\treturn NULL;\n\t}\n\n\tfor (soc = socs; soc->name; soc++) {\n\t\tif (soc->cidr_match != (cidr & soc->cidr_mask))\n\t\t\tcontinue;\n\n\t\tif (!(cidr & AT91_CIDR_EXT) || soc->exid_match == exid)\n\t\t\tbreak;\n\t}\n\n\tif (!soc->name) {\n\t\tpr_warn(\"Could not find matching SoC description\\n\");\n\t\treturn NULL;\n\t}\n\n\tsoc_dev_attr = kzalloc(sizeof(*soc_dev_attr), GFP_KERNEL);\n\tif (!soc_dev_attr)\n\t\treturn NULL;\n\n\tsoc_dev_attr->family = soc->family;\n\tsoc_dev_attr->soc_id = soc->name;\n\tsoc_dev_attr->revision = kasprintf(GFP_KERNEL, \"%X\",\n\t\t\t\t\t   AT91_CIDR_VERSION(cidr, soc->version_mask));\n\tsoc_dev = soc_device_register(soc_dev_attr);\n\tif (IS_ERR(soc_dev)) {\n\t\tkfree(soc_dev_attr->revision);\n\t\tkfree(soc_dev_attr);\n\t\tpr_warn(\"Could not register SoC device\\n\");\n\t\treturn NULL;\n\t}\n\n\tif (soc->family)\n\t\tpr_info(\"Detected SoC family: %s\\n\", soc->family);\n\tpr_info(\"Detected SoC: %s, revision %X\\n\", soc->name,\n\t\tAT91_CIDR_VERSION(cidr, soc->version_mask));\n\n\treturn soc_dev;\n}\n\nstatic const struct of_device_id at91_soc_allowed_list[] __initconst = {\n\t{ .compatible = \"atmel,at91rm9200\", },\n\t{ .compatible = \"atmel,at91sam9\", },\n\t{ .compatible = \"atmel,sama5\", },\n\t{ .compatible = \"atmel,samv7\", },\n\t{ .compatible = \"microchip,sama7g5\", },\n\t{ }\n};\n\nstatic int __init atmel_soc_device_init(void)\n{\n\tstruct device_node *np = of_find_node_by_path(\"/\");\n\n\tif (!of_match_node(at91_soc_allowed_list, np))\n\t\treturn 0;\n\n\tat91_soc_init(socs);\n\n\treturn 0;\n}\nsubsys_initcall(atmel_soc_device_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}