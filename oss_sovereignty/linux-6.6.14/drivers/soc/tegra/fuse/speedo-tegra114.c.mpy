{
  "module_name": "speedo-tegra114.c",
  "hash_id": "e950b2c342b69401204e904ea63a8a88a7f284cb7356cc0ab6964e59f139c333",
  "original_prompt": "Ingested from linux-6.6.14/drivers/soc/tegra/fuse/speedo-tegra114.c",
  "human_readable_source": "\n \n\n#include <linux/bug.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n\n#include <soc/tegra/fuse.h>\n\n#include \"fuse.h\"\n\n#define SOC_PROCESS_CORNERS\t2\n#define CPU_PROCESS_CORNERS\t2\n\nenum {\n\tTHRESHOLD_INDEX_0,\n\tTHRESHOLD_INDEX_1,\n\tTHRESHOLD_INDEX_COUNT,\n};\n\nstatic const u32 __initconst soc_process_speedos[][SOC_PROCESS_CORNERS] = {\n\t{1123,     UINT_MAX},\n\t{0,        UINT_MAX},\n};\n\nstatic const u32 __initconst cpu_process_speedos[][CPU_PROCESS_CORNERS] = {\n\t{1695,     UINT_MAX},\n\t{0,        UINT_MAX},\n};\n\nstatic void __init rev_sku_to_speedo_ids(struct tegra_sku_info *sku_info,\n\t\t\t\t\t int *threshold)\n{\n\tu32 tmp;\n\tu32 sku = sku_info->sku_id;\n\tenum tegra_revision rev = sku_info->revision;\n\n\tswitch (sku) {\n\tcase 0x00:\n\tcase 0x10:\n\tcase 0x05:\n\tcase 0x06:\n\t\tsku_info->cpu_speedo_id = 1;\n\t\tsku_info->soc_speedo_id = 0;\n\t\t*threshold = THRESHOLD_INDEX_0;\n\t\tbreak;\n\n\tcase 0x03:\n\tcase 0x04:\n\t\tsku_info->cpu_speedo_id = 2;\n\t\tsku_info->soc_speedo_id = 1;\n\t\t*threshold = THRESHOLD_INDEX_1;\n\t\tbreak;\n\n\tdefault:\n\t\tpr_err(\"Tegra Unknown SKU %d\\n\", sku);\n\t\tsku_info->cpu_speedo_id = 0;\n\t\tsku_info->soc_speedo_id = 0;\n\t\t*threshold = THRESHOLD_INDEX_0;\n\t\tbreak;\n\t}\n\n\tif (rev == TEGRA_REVISION_A01) {\n\t\ttmp = tegra_fuse_read_early(0x270) << 1;\n\t\ttmp |= tegra_fuse_read_early(0x26c);\n\t\tif (!tmp)\n\t\t\tsku_info->cpu_speedo_id = 0;\n\t}\n}\n\nvoid __init tegra114_init_speedo_data(struct tegra_sku_info *sku_info)\n{\n\tu32 cpu_speedo_val;\n\tu32 soc_speedo_val;\n\tint threshold;\n\tint i;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(cpu_process_speedos) !=\n\t\t\tTHRESHOLD_INDEX_COUNT);\n\tBUILD_BUG_ON(ARRAY_SIZE(soc_process_speedos) !=\n\t\t\tTHRESHOLD_INDEX_COUNT);\n\n\trev_sku_to_speedo_ids(sku_info, &threshold);\n\n\tcpu_speedo_val = tegra_fuse_read_early(0x12c) + 1024;\n\tsoc_speedo_val = tegra_fuse_read_early(0x134);\n\n\tfor (i = 0; i < CPU_PROCESS_CORNERS; i++)\n\t\tif (cpu_speedo_val < cpu_process_speedos[threshold][i])\n\t\t\tbreak;\n\tsku_info->cpu_process_id = i;\n\n\tfor (i = 0; i < SOC_PROCESS_CORNERS; i++)\n\t\tif (soc_speedo_val < soc_process_speedos[threshold][i])\n\t\t\tbreak;\n\tsku_info->soc_process_id = i;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}