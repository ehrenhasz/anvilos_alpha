{
  "module_name": "rpmh-internal.h",
  "hash_id": "5bc062ee5b4739872976e83be9de4b3188c7b9023d8e66970b48760052f6d206",
  "original_prompt": "Ingested from linux-6.6.14/drivers/soc/qcom/rpmh-internal.h",
  "human_readable_source": " \n \n\n\n#ifndef __RPM_INTERNAL_H__\n#define __RPM_INTERNAL_H__\n\n#include <linux/bitmap.h>\n#include <linux/wait.h>\n#include <soc/qcom/tcs.h>\n\n#define TCS_TYPE_NR\t\t\t4\n#define MAX_CMDS_PER_TCS\t\t16\n#define MAX_TCS_PER_TYPE\t\t3\n#define MAX_TCS_NR\t\t\t(MAX_TCS_PER_TYPE * TCS_TYPE_NR)\n#define MAX_TCS_SLOTS\t\t\t(MAX_CMDS_PER_TCS * MAX_TCS_PER_TYPE)\n\nstruct rsc_drv;\n\n \nstruct tcs_group {\n\tstruct rsc_drv *drv;\n\tint type;\n\tu32 mask;\n\tu32 offset;\n\tint num_tcs;\n\tint ncpt;\n\tconst struct tcs_request *req[MAX_TCS_PER_TYPE];\n\tDECLARE_BITMAP(slots, MAX_TCS_SLOTS);\n};\n\n \nstruct rpmh_request {\n\tstruct tcs_request msg;\n\tstruct tcs_cmd cmd[MAX_RPMH_PAYLOAD];\n\tstruct completion *completion;\n\tconst struct device *dev;\n\tbool needs_free;\n};\n\n \nstruct rpmh_ctrlr {\n\tstruct list_head cache;\n\tspinlock_t cache_lock;\n\tbool dirty;\n\tstruct list_head batch_cache;\n};\n\nstruct rsc_ver {\n\tu32 major;\n\tu32 minor;\n};\n\n \nstruct rsc_drv {\n\tconst char *name;\n\tvoid __iomem *base;\n\tvoid __iomem *tcs_base;\n\tint id;\n\tint num_tcs;\n\tstruct notifier_block rsc_pm;\n\tstruct notifier_block genpd_nb;\n\tatomic_t cpus_in_pm;\n\tstruct tcs_group tcs[TCS_TYPE_NR];\n\tDECLARE_BITMAP(tcs_in_use, MAX_TCS_NR);\n\tspinlock_t lock;\n\twait_queue_head_t tcs_wait;\n\tstruct rpmh_ctrlr client;\n\tstruct device *dev;\n\tstruct rsc_ver ver;\n\tu32 *regs;\n};\n\nint rpmh_rsc_send_data(struct rsc_drv *drv, const struct tcs_request *msg);\nint rpmh_rsc_write_ctrl_data(struct rsc_drv *drv,\n\t\t\t     const struct tcs_request *msg);\nvoid rpmh_rsc_invalidate(struct rsc_drv *drv);\nvoid rpmh_rsc_write_next_wakeup(struct rsc_drv *drv);\n\nvoid rpmh_tx_done(const struct tcs_request *msg);\nint rpmh_flush(struct rpmh_ctrlr *ctrlr);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}