{
  "module_name": "sunxi_mbus.c",
  "hash_id": "986ef55b06c6be2485d9718845681be8432d06d60a016bcadd2c5dc995ea88a8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/soc/sunxi/sunxi_mbus.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/dma-map-ops.h>\n#include <linux/init.h>\n#include <linux/notifier.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n\nstatic const char * const sunxi_mbus_devices[] = {\n\t \n\t\"allwinner,sun4i-a10-display-engine\",\n\t\"allwinner,sun5i-a10s-display-engine\",\n\t\"allwinner,sun5i-a13-display-engine\",\n\t\"allwinner,sun6i-a31-display-engine\",\n\t\"allwinner,sun6i-a31s-display-engine\",\n\t\"allwinner,sun7i-a20-display-engine\",\n\t\"allwinner,sun8i-a23-display-engine\",\n\t\"allwinner,sun8i-a33-display-engine\",\n\t\"allwinner,sun9i-a80-display-engine\",\n\n\t \n\t\"allwinner,sun4i-a10-csi1\",\n\t\"allwinner,sun4i-a10-display-backend\",\n\t\"allwinner,sun4i-a10-display-frontend\",\n\t\"allwinner,sun4i-a10-video-engine\",\n\t\"allwinner,sun5i-a13-display-backend\",\n\t\"allwinner,sun5i-a13-video-engine\",\n\t\"allwinner,sun6i-a31-csi\",\n\t\"allwinner,sun6i-a31-display-backend\",\n\t\"allwinner,sun7i-a20-csi0\",\n\t\"allwinner,sun7i-a20-display-backend\",\n\t\"allwinner,sun7i-a20-display-frontend\",\n\t\"allwinner,sun7i-a20-video-engine\",\n\t\"allwinner,sun8i-a23-display-backend\",\n\t\"allwinner,sun8i-a23-display-frontend\",\n\t\"allwinner,sun8i-a33-display-backend\",\n\t\"allwinner,sun8i-a33-display-frontend\",\n\t\"allwinner,sun8i-a33-video-engine\",\n\t\"allwinner,sun8i-a83t-csi\",\n\t\"allwinner,sun8i-h3-csi\",\n\t\"allwinner,sun8i-h3-video-engine\",\n\t\"allwinner,sun8i-v3s-csi\",\n\t\"allwinner,sun9i-a80-display-backend\",\n\t\"allwinner,sun50i-a64-csi\",\n\t\"allwinner,sun50i-a64-video-engine\",\n\t\"allwinner,sun50i-h5-video-engine\",\n\tNULL,\n};\n\nstatic int sunxi_mbus_notifier(struct notifier_block *nb,\n\t\t\t       unsigned long event, void *__dev)\n{\n\tstruct device *dev = __dev;\n\tint ret;\n\n\tif (event != BUS_NOTIFY_ADD_DEVICE)\n\t\treturn NOTIFY_DONE;\n\n\t \n\tif (!of_device_compatible_match(dev->of_node, sunxi_mbus_devices))\n\t\treturn NOTIFY_DONE;\n\n\t \n\tif (of_property_present(dev->of_node, \"interconnects\"))\n\t\treturn NOTIFY_DONE;\n\n\tret = dma_direct_set_offset(dev, PHYS_OFFSET, 0, SZ_4G);\n\tif (ret)\n\t\tdev_err(dev, \"Couldn't setup our DMA offset: %d\\n\", ret);\n\n\treturn NOTIFY_DONE;\n}\n\nstatic struct notifier_block sunxi_mbus_nb = {\n\t.notifier_call = sunxi_mbus_notifier,\n};\n\nstatic const char * const sunxi_mbus_platforms[] __initconst = {\n\t\"allwinner,sun4i-a10\",\n\t\"allwinner,sun5i-a10s\",\n\t\"allwinner,sun5i-a13\",\n\t\"allwinner,sun6i-a31\",\n\t\"allwinner,sun7i-a20\",\n\t\"allwinner,sun8i-a23\",\n\t\"allwinner,sun8i-a33\",\n\t\"allwinner,sun8i-a83t\",\n\t\"allwinner,sun8i-h3\",\n\t\"allwinner,sun8i-r40\",\n\t\"allwinner,sun8i-v3\",\n\t\"allwinner,sun8i-v3s\",\n\t\"allwinner,sun9i-a80\",\n\t\"allwinner,sun50i-a64\",\n\t\"allwinner,sun50i-h5\",\n\t\"nextthing,gr8\",\n\tNULL,\n};\n\nstatic int __init sunxi_mbus_init(void)\n{\n\tif (!of_device_compatible_match(of_root, sunxi_mbus_platforms))\n\t\treturn 0;\n\n\tbus_register_notifier(&platform_bus_type, &sunxi_mbus_nb);\n\treturn 0;\n}\narch_initcall(sunxi_mbus_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}