{
  "module_name": "tsi721.h",
  "hash_id": "3ed16929c8be93d5d6213ab71ebf1ffb3300cf1edc84262c38a85d62271a5dba",
  "original_prompt": "Ingested from linux-6.6.14/drivers/rapidio/devices/tsi721.h",
  "human_readable_source": " \n \n\n#ifndef __TSI721_H\n#define __TSI721_H\n\n \nenum {\n\tDBG_NONE\t= 0,\n\tDBG_INIT\t= BIT(0),  \n\tDBG_EXIT\t= BIT(1),  \n\tDBG_MPORT\t= BIT(2),  \n\tDBG_MAINT\t= BIT(3),  \n\tDBG_DMA\t\t= BIT(4),  \n\tDBG_DMAV\t= BIT(5),  \n\tDBG_IBW\t\t= BIT(6),  \n\tDBG_EVENT\t= BIT(7),  \n\tDBG_OBW\t\t= BIT(8),  \n\tDBG_DBELL\t= BIT(9),  \n\tDBG_OMSG\t= BIT(10),  \n\tDBG_IMSG\t= BIT(11),  \n\tDBG_ALL\t\t= ~0,\n};\n\n#ifdef DEBUG\nextern u32 tsi_dbg_level;\n\n#define tsi_debug(level, dev, fmt, arg...)\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\\\n\t\tif (DBG_##level & tsi_dbg_level)\t\t\t\t\\\n\t\t\tdev_dbg(dev, \"%s: \" fmt \"\\n\", __func__, ##arg);\t\\\n\t} while (0)\n#else\n#define tsi_debug(level, dev, fmt, arg...) \\\n\t\tno_printk(KERN_DEBUG \"%s: \" fmt \"\\n\", __func__, ##arg)\n#endif\n\n#define tsi_info(dev, fmt, arg...) \\\n\tdev_info(dev, \"%s: \" fmt \"\\n\", __func__, ##arg)\n\n#define tsi_warn(dev, fmt, arg...) \\\n\tdev_warn(dev, \"%s: WARNING \" fmt \"\\n\", __func__, ##arg)\n\n#define tsi_err(dev, fmt, arg...) \\\n\tdev_err(dev, \"%s: ERROR \" fmt \"\\n\", __func__, ##arg)\n\n#define DRV_NAME\t\"tsi721\"\n\n#define DEFAULT_HOPCOUNT\t0xff\n#define DEFAULT_DESTID\t\t0xff\n\n \n#define PCI_DEVICE_ID_TSI721\t\t0x80ab\n\n#define BAR_0\t0\n#define BAR_1\t1\n#define BAR_2\t2\n#define BAR_4\t4\n\n#define TSI721_PC2SR_BARS\t2\n#define TSI721_PC2SR_WINS\t8\n#define TSI721_PC2SR_ZONES\t8\n#define TSI721_MAINT_WIN\t0  \n#define IDB_QUEUE\t\t0  \n#define IDB_QSIZE\t\t512  \n\n \n#define TSI721_REG_SPACE_SIZE\t\t(512 * 1024)  \n#define TSI721_DB_WIN_SIZE\t\t(16 * 1024 * 1024)  \n\n#define  RIO_TT_CODE_8\t\t0x00000000\n#define  RIO_TT_CODE_16\t\t0x00000001\n\n#define TSI721_DMA_MAXCH\t8\n#define TSI721_DMA_MINSTSSZ\t32\n#define TSI721_DMA_STSBLKSZ\t8\n\n#define TSI721_SRIO_MAXCH\t8\n\n#define DBELL_SID(buf)\t\t(((u8)buf[2] << 8) | (u8)buf[3])\n#define DBELL_TID(buf)\t\t(((u8)buf[4] << 8) | (u8)buf[5])\n#define DBELL_INF(buf)\t\t(((u8)buf[0] << 8) | (u8)buf[1])\n\n#define TSI721_RIO_PW_MSG_SIZE\t16   \n\n \n\n \n\n#define TSI721_PCIECFG_MSIXTBL\t0x0a4\n#define TSI721_MSIXTBL_OFFSET\t0x2c000\n#define TSI721_PCIECFG_MSIXPBA\t0x0a8\n#define TSI721_MSIXPBA_OFFSET\t0x2a000\n#define TSI721_PCIECFG_EPCTL\t0x400\n\n \n\n#define TSI721_RIO_EM_INT_STAT\t\t0x10910\n#define TSI721_RIO_EM_INT_STAT_PW_RX\t0x00010000\n\n#define TSI721_RIO_EM_INT_ENABLE\t0x10914\n#define TSI721_RIO_EM_INT_ENABLE_PW_RX\t0x00010000\n\n#define TSI721_RIO_EM_DEV_INT_EN\t0x10930\n#define TSI721_RIO_EM_DEV_INT_EN_INT\t0x00000001\n\n \n\n#define TSI721_RIO_PW_CTL\t\t0x10a04\n#define TSI721_RIO_PW_CTL_PW_TIMER\t0xf0000000\n#define TSI721_RIO_PW_CTL_PWT_DIS\t(0 << 28)\n#define TSI721_RIO_PW_CTL_PWT_103\t(1 << 28)\n#define TSI721_RIO_PW_CTL_PWT_205\t(1 << 29)\n#define TSI721_RIO_PW_CTL_PWT_410\t(1 << 30)\n#define TSI721_RIO_PW_CTL_PWT_820\t(1 << 31)\n#define TSI721_RIO_PW_CTL_PWC_MODE\t0x01000000\n#define TSI721_RIO_PW_CTL_PWC_CONT\t0x00000000\n#define TSI721_RIO_PW_CTL_PWC_REL\t0x01000000\n\n#define TSI721_RIO_PW_RX_STAT\t\t0x10a10\n#define TSI721_RIO_PW_RX_STAT_WR_SIZE\t0x0000f000\n#define TSI_RIO_PW_RX_STAT_WDPTR\t0x00000100\n#define TSI721_RIO_PW_RX_STAT_PW_SHORT\t0x00000008\n#define TSI721_RIO_PW_RX_STAT_PW_TRUNC\t0x00000004\n#define TSI721_RIO_PW_RX_STAT_PW_DISC\t0x00000002\n#define TSI721_RIO_PW_RX_STAT_PW_VAL\t0x00000001\n\n#define TSI721_RIO_PW_RX_CAPT(x)\t(0x10a20 + (x)*4)\n\n \n\n#define TSI721_IDB_ENTRY_SIZE\t64\n\n#define TSI721_IDQ_CTL(x)\t(0x20000 + (x) * 0x1000)\n#define TSI721_IDQ_SUSPEND\t0x00000002\n#define TSI721_IDQ_INIT\t\t0x00000001\n\n#define TSI721_IDQ_STS(x)\t(0x20004 + (x) * 0x1000)\n#define TSI721_IDQ_RUN\t\t0x00200000\n\n#define TSI721_IDQ_MASK(x)\t(0x20008 + (x) * 0x1000)\n#define TSI721_IDQ_MASK_MASK\t0xffff0000\n#define TSI721_IDQ_MASK_PATT\t0x0000ffff\n\n#define TSI721_IDQ_RP(x)\t(0x2000c + (x) * 0x1000)\n#define TSI721_IDQ_RP_PTR\t0x0007ffff\n\n#define TSI721_IDQ_WP(x)\t(0x20010 + (x) * 0x1000)\n#define TSI721_IDQ_WP_PTR\t0x0007ffff\n\n#define TSI721_IDQ_BASEL(x)\t(0x20014 + (x) * 0x1000)\n#define TSI721_IDQ_BASEL_ADDR\t0xffffffc0\n#define TSI721_IDQ_BASEU(x)\t(0x20018 + (x) * 0x1000)\n#define TSI721_IDQ_SIZE(x)\t(0x2001c + (x) * 0x1000)\n#define TSI721_IDQ_SIZE_VAL(size)\t(__fls(size) - 4)\n#define TSI721_IDQ_SIZE_MIN\t512\n#define TSI721_IDQ_SIZE_MAX\t(512 * 1024)\n\n#define TSI721_SR_CHINT(x)\t(0x20040 + (x) * 0x1000)\n#define TSI721_SR_CHINTE(x)\t(0x20044 + (x) * 0x1000)\n#define TSI721_SR_CHINTSET(x)\t(0x20048 + (x) * 0x1000)\n#define TSI721_SR_CHINT_ODBOK\t0x00000020\n#define TSI721_SR_CHINT_IDBQRCV\t0x00000010\n#define TSI721_SR_CHINT_SUSP\t0x00000008\n#define TSI721_SR_CHINT_ODBTO\t0x00000004\n#define TSI721_SR_CHINT_ODBRTRY\t0x00000002\n#define TSI721_SR_CHINT_ODBERR\t0x00000001\n#define TSI721_SR_CHINT_ALL\t0x0000003f\n\n#define TSI721_IBWIN_NUM\t8\n\n#define TSI721_IBWIN_LB(x)\t(0x29000 + (x) * 0x20)\n#define TSI721_IBWIN_LB_BA\t0xfffff000\n#define TSI721_IBWIN_LB_WEN\t0x00000001\n\n#define TSI721_IBWIN_UB(x)\t(0x29004 + (x) * 0x20)\n#define TSI721_IBWIN_SZ(x)\t(0x29008 + (x) * 0x20)\n#define TSI721_IBWIN_SZ_SIZE\t0x00001f00\n#define TSI721_IBWIN_SIZE(size)\t(__fls(size) - 12)\n\n#define TSI721_IBWIN_TLA(x)\t(0x2900c + (x) * 0x20)\n#define TSI721_IBWIN_TLA_ADD\t0xfffff000\n#define TSI721_IBWIN_TUA(x)\t(0x29010 + (x) * 0x20)\n\n#define TSI721_SR2PC_GEN_INTE\t0x29800\n#define TSI721_SR2PC_PWE\t0x29804\n#define TSI721_SR2PC_GEN_INT\t0x29808\n\n#define TSI721_DEV_INTE\t\t0x29840\n#define TSI721_DEV_INT\t\t0x29844\n#define TSI721_DEV_INTSET\t0x29848\n#define TSI721_DEV_INT_BDMA_CH\t0x00002000\n#define TSI721_DEV_INT_BDMA_NCH\t0x00001000\n#define TSI721_DEV_INT_SMSG_CH\t0x00000800\n#define TSI721_DEV_INT_SMSG_NCH\t0x00000400\n#define TSI721_DEV_INT_SR2PC_CH\t0x00000200\n#define TSI721_DEV_INT_SRIO\t0x00000020\n\n#define TSI721_DEV_CHAN_INTE\t0x2984c\n#define TSI721_DEV_CHAN_INT\t0x29850\n\n#define TSI721_INT_SR2PC_CHAN_M\t0xff000000\n#define TSI721_INT_SR2PC_CHAN(x) (1 << (24 + (x)))\n#define TSI721_INT_IMSG_CHAN_M\t0x00ff0000\n#define TSI721_INT_IMSG_CHAN(x)\t(1 << (16 + (x)))\n#define TSI721_INT_OMSG_CHAN_M\t0x0000ff00\n#define TSI721_INT_OMSG_CHAN(x)\t(1 << (8 + (x)))\n#define TSI721_INT_BDMA_CHAN_M\t0x000000ff\n#define TSI721_INT_BDMA_CHAN(x)\t(1 << (x))\n\n \n#define TSI721_OBWIN_NUM\tTSI721_PC2SR_WINS\n\n#define TSI721_OBWINLB(x)\t(0x40000 + (x) * 0x20)\n#define TSI721_OBWINLB_BA\t0xffff8000\n#define TSI721_OBWINLB_WEN\t0x00000001\n\n#define TSI721_OBWINUB(x)\t(0x40004 + (x) * 0x20)\n\n#define TSI721_OBWINSZ(x)\t(0x40008 + (x) * 0x20)\n#define TSI721_OBWINSZ_SIZE\t0x00001f00\n#define TSI721_OBWIN_SIZE(size)\t(__fls(size) - 15)\n\n#define TSI721_ZONE_SEL\t\t0x41300\n#define TSI721_ZONE_SEL_RD_WRB\t0x00020000\n#define TSI721_ZONE_SEL_GO\t0x00010000\n#define TSI721_ZONE_SEL_WIN\t0x00000038\n#define TSI721_ZONE_SEL_ZONE\t0x00000007\n\n#define TSI721_LUT_DATA0\t0x41304\n#define TSI721_LUT_DATA0_ADD\t0xfffff000\n#define TSI721_LUT_DATA0_RDTYPE\t0x00000f00\n#define TSI721_LUT_DATA0_NREAD\t0x00000100\n#define TSI721_LUT_DATA0_MNTRD\t0x00000200\n#define TSI721_LUT_DATA0_RDCRF\t0x00000020\n#define TSI721_LUT_DATA0_WRCRF\t0x00000010\n#define TSI721_LUT_DATA0_WRTYPE\t0x0000000f\n#define TSI721_LUT_DATA0_NWR\t0x00000001\n#define TSI721_LUT_DATA0_MNTWR\t0x00000002\n#define TSI721_LUT_DATA0_NWR_R\t0x00000004\n\n#define TSI721_LUT_DATA1\t0x41308\n\n#define TSI721_LUT_DATA2\t0x4130c\n#define TSI721_LUT_DATA2_HC\t0xff000000\n#define TSI721_LUT_DATA2_ADD65\t0x000c0000\n#define TSI721_LUT_DATA2_TT\t0x00030000\n#define TSI721_LUT_DATA2_DSTID\t0x0000ffff\n\n#define TSI721_PC2SR_INTE\t0x41310\n\n#define TSI721_DEVCTL\t\t0x48004\n#define TSI721_DEVCTL_SRBOOT_CMPL\t0x00000004\n\n#define TSI721_I2C_INT_ENABLE\t0x49120\n\n \n\n#define TSI721_DMAC_BASE(x)\t(0x51000 + (x) * 0x1000)\n\n#define TSI721_DMAC_DWRCNT\t0x000\n#define TSI721_DMAC_DRDCNT\t0x004\n\n#define TSI721_DMAC_CTL\t\t0x008\n#define TSI721_DMAC_CTL_SUSP\t0x00000002\n#define TSI721_DMAC_CTL_INIT\t0x00000001\n\n#define TSI721_DMAC_INT\t\t0x00c\n#define TSI721_DMAC_INT_STFULL\t0x00000010\n#define TSI721_DMAC_INT_DONE\t0x00000008\n#define TSI721_DMAC_INT_SUSP\t0x00000004\n#define TSI721_DMAC_INT_ERR\t0x00000002\n#define TSI721_DMAC_INT_IOFDONE\t0x00000001\n#define TSI721_DMAC_INT_ALL\t0x0000001f\n\n#define TSI721_DMAC_INTSET\t0x010\n\n#define TSI721_DMAC_STS\t\t0x014\n#define TSI721_DMAC_STS_ABORT\t0x00400000\n#define TSI721_DMAC_STS_RUN\t0x00200000\n#define TSI721_DMAC_STS_CS\t0x001f0000\n\n#define TSI721_DMAC_INTE\t0x018\n\n#define TSI721_DMAC_DPTRL\t0x024\n#define TSI721_DMAC_DPTRL_MASK\t0xffffffe0\n\n#define TSI721_DMAC_DPTRH\t0x028\n\n#define TSI721_DMAC_DSBL\t0x02c\n#define TSI721_DMAC_DSBL_MASK\t0xffffffc0\n\n#define TSI721_DMAC_DSBH\t0x030\n\n#define TSI721_DMAC_DSSZ\t0x034\n#define TSI721_DMAC_DSSZ_SIZE_M\t0x0000000f\n#define TSI721_DMAC_DSSZ_SIZE(size)\t(__fls(size) - 4)\n\n#define TSI721_DMAC_DSRP\t0x038\n#define TSI721_DMAC_DSRP_MASK\t0x0007ffff\n\n#define TSI721_DMAC_DSWP\t0x03c\n#define TSI721_DMAC_DSWP_MASK\t0x0007ffff\n\n#define TSI721_BDMA_INTE\t0x5f000\n\n \n#define TSI721_MSG_BUFFER_SIZE\t\tRIO_MAX_MSG_SIZE\n#define TSI721_MSG_MAX_SIZE\t\tRIO_MAX_MSG_SIZE\n#define TSI721_IMSG_MAXCH\t\t8\n#define TSI721_IMSG_CHNUM\t\tTSI721_IMSG_MAXCH\n#define TSI721_IMSGD_MIN_RING_SIZE\t32\n#define TSI721_IMSGD_RING_SIZE\t\t512\n\n#define TSI721_OMSG_CHNUM\t\t4  \n#define TSI721_OMSGD_MIN_RING_SIZE\t32\n#define TSI721_OMSGD_RING_SIZE\t\t512\n\n \n\n#define TSI721_OBDMAC_DWRCNT(x)\t\t(0x61000 + (x) * 0x1000)\n\n#define TSI721_OBDMAC_DRDCNT(x)\t\t(0x61004 + (x) * 0x1000)\n\n#define TSI721_OBDMAC_CTL(x)\t\t(0x61008 + (x) * 0x1000)\n#define TSI721_OBDMAC_CTL_MASK\t\t0x00000007\n#define TSI721_OBDMAC_CTL_RETRY_THR\t0x00000004\n#define TSI721_OBDMAC_CTL_SUSPEND\t0x00000002\n#define TSI721_OBDMAC_CTL_INIT\t\t0x00000001\n\n#define TSI721_OBDMAC_INT(x)\t\t(0x6100c + (x) * 0x1000)\n#define TSI721_OBDMAC_INTSET(x)\t\t(0x61010 + (x) * 0x1000)\n#define TSI721_OBDMAC_INTE(x)\t\t(0x61018 + (x) * 0x1000)\n#define TSI721_OBDMAC_INT_MASK\t\t0x0000001F\n#define TSI721_OBDMAC_INT_ST_FULL\t0x00000010\n#define TSI721_OBDMAC_INT_DONE\t\t0x00000008\n#define TSI721_OBDMAC_INT_SUSPENDED\t0x00000004\n#define TSI721_OBDMAC_INT_ERROR\t\t0x00000002\n#define TSI721_OBDMAC_INT_IOF_DONE\t0x00000001\n#define TSI721_OBDMAC_INT_ALL\t\tTSI721_OBDMAC_INT_MASK\n\n#define TSI721_OBDMAC_STS(x)\t\t(0x61014 + (x) * 0x1000)\n#define TSI721_OBDMAC_STS_MASK\t\t0x007f0000\n#define TSI721_OBDMAC_STS_ABORT\t\t0x00400000\n#define TSI721_OBDMAC_STS_RUN\t\t0x00200000\n#define TSI721_OBDMAC_STS_CS\t\t0x001f0000\n\n#define TSI721_OBDMAC_PWE(x)\t\t(0x6101c + (x) * 0x1000)\n#define TSI721_OBDMAC_PWE_MASK\t\t0x00000002\n#define TSI721_OBDMAC_PWE_ERROR_EN\t0x00000002\n\n#define TSI721_OBDMAC_DPTRL(x)\t\t(0x61020 + (x) * 0x1000)\n#define TSI721_OBDMAC_DPTRL_MASK\t0xfffffff0\n\n#define TSI721_OBDMAC_DPTRH(x)\t\t(0x61024 + (x) * 0x1000)\n#define TSI721_OBDMAC_DPTRH_MASK\t0xffffffff\n\n#define TSI721_OBDMAC_DSBL(x)\t\t(0x61040 + (x) * 0x1000)\n#define TSI721_OBDMAC_DSBL_MASK\t\t0xffffffc0\n\n#define TSI721_OBDMAC_DSBH(x)\t\t(0x61044 + (x) * 0x1000)\n#define TSI721_OBDMAC_DSBH_MASK\t\t0xffffffff\n\n#define TSI721_OBDMAC_DSSZ(x)\t\t(0x61048 + (x) * 0x1000)\n#define TSI721_OBDMAC_DSSZ_MASK\t\t0x0000000f\n\n#define TSI721_OBDMAC_DSRP(x)\t\t(0x6104c + (x) * 0x1000)\n#define TSI721_OBDMAC_DSRP_MASK\t\t0x0007ffff\n\n#define TSI721_OBDMAC_DSWP(x)\t\t(0x61050 + (x) * 0x1000)\n#define TSI721_OBDMAC_DSWP_MASK\t\t0x0007ffff\n\n#define TSI721_RQRPTO\t\t\t0x60010\n#define TSI721_RQRPTO_MASK\t\t0x00ffffff\n#define TSI721_RQRPTO_VAL\t\t400\t \n\n \n\n#define TSI721_IB_DEVID_GLOBAL\t\t0xffff\n#define TSI721_IBDMAC_FQBL(x)\t\t(0x61200 + (x) * 0x1000)\n#define TSI721_IBDMAC_FQBL_MASK\t\t0xffffffc0\n\n#define TSI721_IBDMAC_FQBH(x)\t\t(0x61204 + (x) * 0x1000)\n#define TSI721_IBDMAC_FQBH_MASK\t\t0xffffffff\n\n#define TSI721_IBDMAC_FQSZ_ENTRY_INX\tTSI721_IMSGD_RING_SIZE\n#define TSI721_IBDMAC_FQSZ(x)\t\t(0x61208 + (x) * 0x1000)\n#define TSI721_IBDMAC_FQSZ_MASK\t\t0x0000000f\n\n#define TSI721_IBDMAC_FQRP(x)\t\t(0x6120c + (x) * 0x1000)\n#define TSI721_IBDMAC_FQRP_MASK\t\t0x0007ffff\n\n#define TSI721_IBDMAC_FQWP(x)\t\t(0x61210 + (x) * 0x1000)\n#define TSI721_IBDMAC_FQWP_MASK\t\t0x0007ffff\n\n#define TSI721_IBDMAC_FQTH(x)\t\t(0x61214 + (x) * 0x1000)\n#define TSI721_IBDMAC_FQTH_MASK\t\t0x0007ffff\n\n#define TSI721_IB_DEVID\t\t\t0x60020\n#define TSI721_IB_DEVID_MASK\t\t0x0000ffff\n\n#define TSI721_IBDMAC_CTL(x)\t\t(0x61240 + (x) * 0x1000)\n#define TSI721_IBDMAC_CTL_MASK\t\t0x00000003\n#define TSI721_IBDMAC_CTL_SUSPEND\t0x00000002\n#define TSI721_IBDMAC_CTL_INIT\t\t0x00000001\n\n#define TSI721_IBDMAC_STS(x)\t\t(0x61244 + (x) * 0x1000)\n#define TSI721_IBDMAC_STS_MASK\t\t0x007f0000\n#define TSI721_IBSMAC_STS_ABORT\t\t0x00400000\n#define TSI721_IBSMAC_STS_RUN\t\t0x00200000\n#define TSI721_IBSMAC_STS_CS\t\t0x001f0000\n\n#define TSI721_IBDMAC_INT(x)\t\t(0x61248 + (x) * 0x1000)\n#define TSI721_IBDMAC_INTSET(x)\t\t(0x6124c + (x) * 0x1000)\n#define TSI721_IBDMAC_INTE(x)\t\t(0x61250 + (x) * 0x1000)\n#define TSI721_IBDMAC_INT_MASK\t\t0x0000100f\n#define TSI721_IBDMAC_INT_SRTO\t\t0x00001000\n#define TSI721_IBDMAC_INT_SUSPENDED\t0x00000008\n#define TSI721_IBDMAC_INT_PC_ERROR\t0x00000004\n#define TSI721_IBDMAC_INT_FQ_LOW\t0x00000002\n#define TSI721_IBDMAC_INT_DQ_RCV\t0x00000001\n#define TSI721_IBDMAC_INT_ALL\t\tTSI721_IBDMAC_INT_MASK\n\n#define TSI721_IBDMAC_PWE(x)\t\t(0x61254 + (x) * 0x1000)\n#define TSI721_IBDMAC_PWE_MASK\t\t0x00001700\n#define TSI721_IBDMAC_PWE_SRTO\t\t0x00001000\n#define TSI721_IBDMAC_PWE_ILL_FMT\t0x00000400\n#define TSI721_IBDMAC_PWE_ILL_DEC\t0x00000200\n#define TSI721_IBDMAC_PWE_IMP_SP\t0x00000100\n\n#define TSI721_IBDMAC_DQBL(x)\t\t(0x61300 + (x) * 0x1000)\n#define TSI721_IBDMAC_DQBL_MASK\t\t0xffffffc0\n#define TSI721_IBDMAC_DQBL_ADDR\t\t0xffffffc0\n\n#define TSI721_IBDMAC_DQBH(x)\t\t(0x61304 + (x) * 0x1000)\n#define TSI721_IBDMAC_DQBH_MASK\t\t0xffffffff\n\n#define TSI721_IBDMAC_DQRP(x)\t\t(0x61308 + (x) * 0x1000)\n#define TSI721_IBDMAC_DQRP_MASK\t\t0x0007ffff\n\n#define TSI721_IBDMAC_DQWR(x)\t\t(0x6130c + (x) * 0x1000)\n#define TSI721_IBDMAC_DQWR_MASK\t\t0x0007ffff\n\n#define TSI721_IBDMAC_DQSZ(x)\t\t(0x61314 + (x) * 0x1000)\n#define TSI721_IBDMAC_DQSZ_MASK\t\t0x0000000f\n\n \n\n#define TSI721_SMSG_PWE\t\t\t0x6a004\n\n#define TSI721_SMSG_INTE\t\t0x6a000\n#define TSI721_SMSG_INT\t\t\t0x6a008\n#define TSI721_SMSG_INTSET\t\t0x6a010\n#define TSI721_SMSG_INT_MASK\t\t0x0086ffff\n#define TSI721_SMSG_INT_UNS_RSP\t\t0x00800000\n#define TSI721_SMSG_INT_ECC_NCOR\t0x00040000\n#define TSI721_SMSG_INT_ECC_COR\t\t0x00020000\n#define TSI721_SMSG_INT_ECC_NCOR_CH\t0x0000ff00\n#define TSI721_SMSG_INT_ECC_COR_CH\t0x000000ff\n\n#define TSI721_SMSG_ECC_LOG\t\t0x6a014\n#define TSI721_SMSG_ECC_LOG_MASK\t0x00070007\n#define TSI721_SMSG_ECC_LOG_ECC_NCOR_M\t0x00070000\n#define TSI721_SMSG_ECC_LOG_ECC_COR_M\t0x00000007\n\n#define TSI721_RETRY_GEN_CNT\t\t0x6a100\n#define TSI721_RETRY_GEN_CNT_MASK\t0xffffffff\n\n#define TSI721_RETRY_RX_CNT\t\t0x6a104\n#define TSI721_RETRY_RX_CNT_MASK\t0xffffffff\n\n#define TSI721_SMSG_ECC_COR_LOG(x)\t(0x6a300 + (x) * 4)\n#define TSI721_SMSG_ECC_COR_LOG_MASK\t0x000000ff\n\n#define TSI721_SMSG_ECC_NCOR(x)\t\t(0x6a340 + (x) * 4)\n#define TSI721_SMSG_ECC_NCOR_MASK\t0x000000ff\n\n \n\nstruct tsi721_dma_desc {\n\t__le32 type_id;\n\n#define TSI721_DMAD_DEVID\t0x0000ffff\n#define TSI721_DMAD_CRF\t\t0x00010000\n#define TSI721_DMAD_PRIO\t0x00060000\n#define TSI721_DMAD_RTYPE\t0x00780000\n#define TSI721_DMAD_IOF\t\t0x08000000\n#define TSI721_DMAD_DTYPE\t0xe0000000\n\n\t__le32 bcount;\n\n#define TSI721_DMAD_BCOUNT1\t0x03ffffff  \n#define TSI721_DMAD_BCOUNT2\t0x0000000f  \n#define TSI721_DMAD_TT\t\t0x0c000000\n#define TSI721_DMAD_RADDR0\t0xc0000000\n\n\tunion {\n\t\t__le32 raddr_lo;\t    \n\t\t__le32 next_lo;\t\t    \n\t};\n\n#define TSI721_DMAD_CFGOFF\t0x00ffffff\n#define TSI721_DMAD_HOPCNT\t0xff000000\n\n\tunion {\n\t\t__le32 raddr_hi;\t    \n\t\t__le32 next_hi;\t\t    \n\t};\n\n\tunion {\n\t\tstruct {\t\t    \n\t\t\t__le32 bufptr_lo;\n\t\t\t__le32 bufptr_hi;\n\t\t\t__le32 s_dist;\n\t\t\t__le32 s_size;\n\t\t} t1;\n\t\t__le32 data[4];\t\t    \n\t\tu32    reserved[4];\t    \n\t};\n} __aligned(32);\n\n \nstruct tsi721_imsg_desc {\n\t__le32 type_id;\n\n#define TSI721_IMD_DEVID\t0x0000ffff\n#define TSI721_IMD_CRF\t\t0x00010000\n#define TSI721_IMD_PRIO\t\t0x00060000\n#define TSI721_IMD_TT\t\t0x00180000\n#define TSI721_IMD_DTYPE\t0xe0000000\n\n\t__le32 msg_info;\n\n#define TSI721_IMD_BCOUNT\t0x00000ff8\n#define TSI721_IMD_SSIZE\t0x0000f000\n#define TSI721_IMD_LETER\t0x00030000\n#define TSI721_IMD_XMBOX\t0x003c0000\n#define TSI721_IMD_MBOX\t\t0x00c00000\n#define TSI721_IMD_CS\t\t0x78000000\n#define TSI721_IMD_HO\t\t0x80000000\n\n\t__le32 bufptr_lo;\n\t__le32 bufptr_hi;\n\tu32    reserved[12];\n\n} __aligned(64);\n\n \nstruct tsi721_omsg_desc {\n\t__le32 type_id;\n\n#define TSI721_OMD_DEVID\t0x0000ffff\n#define TSI721_OMD_CRF\t\t0x00010000\n#define TSI721_OMD_PRIO\t\t0x00060000\n#define TSI721_OMD_IOF\t\t0x08000000\n#define TSI721_OMD_DTYPE\t0xe0000000\n#define TSI721_OMD_RSRVD\t0x17f80000\n\n\t__le32 msg_info;\n\n#define TSI721_OMD_BCOUNT\t0x00000ff8\n#define TSI721_OMD_SSIZE\t0x0000f000\n#define TSI721_OMD_LETER\t0x00030000\n#define TSI721_OMD_XMBOX\t0x003c0000\n#define TSI721_OMD_MBOX\t\t0x00c00000\n#define TSI721_OMD_TT\t\t0x0c000000\n\n\tunion {\n\t\t__le32 bufptr_lo;\t \n\t\t__le32 next_lo;\t\t \n\t};\n\n\tunion {\n\t\t__le32 bufptr_hi;\t \n\t\t__le32 next_hi;\t\t \n\t};\n\n} __aligned(16);\n\nstruct tsi721_dma_sts {\n\t__le64\tdesc_sts[8];\n} __aligned(64);\n\nstruct tsi721_desc_sts_fifo {\n\tunion {\n\t\t__le64\tda64;\n\t\tstruct {\n\t\t\t__le32\tlo;\n\t\t\t__le32\thi;\n\t\t} da32;\n\t} stat[8];\n} __aligned(64);\n\n \nenum dma_dtype {\n\tDTYPE1 = 1,  \n\tDTYPE2 = 2,  \n\tDTYPE3 = 3,  \n\tDTYPE4 = 4,  \n\tDTYPE5 = 5,  \n\tDTYPE6 = 6   \n};\n\nenum dma_rtype {\n\tNREAD = 0,\n\tLAST_NWRITE_R = 1,\n\tALL_NWRITE = 2,\n\tALL_NWRITE_R = 3,\n\tMAINT_RD = 4,\n\tMAINT_WR = 5\n};\n\n \n#define TSI721_DMA_CHNUM\tTSI721_DMA_MAXCH\n\n#define TSI721_DMACH_MAINT\t7\t \n#define TSI721_DMACH_MAINT_NBD\t32\t \n\n#define TSI721_DMACH_DMA\t1\t \n\n#define MSG_DMA_ENTRY_INX_TO_SIZE(x)\t((0x10 << (x)) & 0xFFFF0)\n\nenum tsi721_smsg_int_flag {\n\tSMSG_INT_NONE\t\t= 0x00000000,\n\tSMSG_INT_ECC_COR_CH\t= 0x000000ff,\n\tSMSG_INT_ECC_NCOR_CH\t= 0x0000ff00,\n\tSMSG_INT_ECC_COR\t= 0x00020000,\n\tSMSG_INT_ECC_NCOR\t= 0x00040000,\n\tSMSG_INT_UNS_RSP\t= 0x00800000,\n\tSMSG_INT_ALL\t\t= 0x0006ffff\n};\n\n \n\n#ifdef CONFIG_RAPIDIO_DMA_ENGINE\n\n#define TSI721_BDMA_MAX_BCOUNT\t(TSI721_DMAD_BCOUNT1 + 1)\n\nstruct tsi721_tx_desc {\n\tstruct dma_async_tx_descriptor\ttxd;\n\tu16\t\t\t\tdestid;\n\t \n\tu64\t\t\t\trio_addr;\n\t \n\tu8\t\t\t\trio_addr_u;\n\tenum dma_rtype\t\t\trtype;\n\tstruct list_head\t\tdesc_node;\n\tstruct scatterlist\t\t*sg;\n\tunsigned int\t\t\tsg_len;\n\tenum dma_status\t\t\tstatus;\n};\n\nstruct tsi721_bdma_chan {\n\tint\t\tid;\n\tvoid __iomem\t*regs;\n\tint\t\tbd_num;\t\t \n\tvoid\t\t*bd_base;\t \n\tdma_addr_t\tbd_phys;\n\tvoid\t\t*sts_base;\t \n\tdma_addr_t\tsts_phys;\n\tint\t\tsts_size;\n\tu32\t\tsts_rdptr;\n\tu32\t\twr_count;\n\tu32\t\twr_count_next;\n\n\tstruct dma_chan\t\tdchan;\n\tstruct tsi721_tx_desc\t*tx_desc;\n\tspinlock_t\t\tlock;\n\tstruct tsi721_tx_desc\t*active_tx;\n\tstruct list_head\tqueue;\n\tstruct list_head\tfree_list;\n\tstruct tasklet_struct\ttasklet;\n\tbool\t\t\tactive;\n};\n\n#endif  \n\nstruct tsi721_bdma_maint {\n\tint\t\tch_id;\t\t \n\tint\t\tbd_num;\t\t \n\tvoid\t\t*bd_base;\t \n\tdma_addr_t\tbd_phys;\n\tvoid\t\t*sts_base;\t \n\tdma_addr_t\tsts_phys;\n\tint\t\tsts_size;\n};\n\nstruct tsi721_imsg_ring {\n\tu32\t\tsize;\n\t \n\tvoid\t\t*buf_base;\n\tdma_addr_t\tbuf_phys;\n\t \n\tvoid\t\t*imfq_base;\n\tdma_addr_t\timfq_phys;\n\t \n\tvoid\t\t*imd_base;\n\tdma_addr_t\timd_phys;\n\t  \n\tvoid\t\t*imq_base[TSI721_IMSGD_RING_SIZE];\n\n\tu32\t\trx_slot;\n\tvoid\t\t*dev_id;\n\tu32\t\tfq_wrptr;\n\tu32\t\tdesc_rdptr;\n\tspinlock_t\tlock;\n};\n\nstruct tsi721_omsg_ring {\n\tu32\t\tsize;\n\t \n\tvoid\t\t*omd_base;\n\tdma_addr_t\tomd_phys;\n\t \n\tvoid\t\t*omq_base[TSI721_OMSGD_RING_SIZE];\n\tdma_addr_t\tomq_phys[TSI721_OMSGD_RING_SIZE];\n\t \n\tvoid\t\t*sts_base;\n\tdma_addr_t\tsts_phys;\n\tu32\t\tsts_size;  \n\tu32\t\tsts_rdptr;\n\n\tu32\t\ttx_slot;\n\tvoid\t\t*dev_id;\n\tu32\t\twr_count;\n\tspinlock_t\tlock;\n};\n\nenum tsi721_flags {\n\tTSI721_USING_MSI\t= (1 << 0),\n\tTSI721_USING_MSIX\t= (1 << 1),\n\tTSI721_IMSGID_SET\t= (1 << 2),\n};\n\n#ifdef CONFIG_PCI_MSI\n \n#define TSI721_MSIX_DMACH_DONE(x)\t(0 + (x))\n#define TSI721_MSIX_DMACH_INT(x)\t(8 + (x))\n#define TSI721_MSIX_BDMA_INT\t\t16\n#define TSI721_MSIX_OMSG_DONE(x)\t(17 + (x))\n#define TSI721_MSIX_OMSG_INT(x)\t\t(25 + (x))\n#define TSI721_MSIX_IMSG_DQ_RCV(x)\t(33 + (x))\n#define TSI721_MSIX_IMSG_INT(x)\t\t(41 + (x))\n#define TSI721_MSIX_MSG_INT\t\t49\n#define TSI721_MSIX_SR2PC_IDBQ_RCV(x)\t(50 + (x))\n#define TSI721_MSIX_SR2PC_CH_INT(x)\t(58 + (x))\n#define TSI721_MSIX_SR2PC_INT\t\t66\n#define TSI721_MSIX_PC2SR_INT\t\t67\n#define TSI721_MSIX_SRIO_MAC_INT\t68\n#define TSI721_MSIX_I2C_INT\t\t69\n\n \nenum tsi721_msix_vect {\n\tTSI721_VECT_IDB,\n\tTSI721_VECT_PWRX,  \n\tTSI721_VECT_OMB0_DONE,\n\tTSI721_VECT_OMB1_DONE,\n\tTSI721_VECT_OMB2_DONE,\n\tTSI721_VECT_OMB3_DONE,\n\tTSI721_VECT_OMB0_INT,\n\tTSI721_VECT_OMB1_INT,\n\tTSI721_VECT_OMB2_INT,\n\tTSI721_VECT_OMB3_INT,\n\tTSI721_VECT_IMB0_RCV,\n\tTSI721_VECT_IMB1_RCV,\n\tTSI721_VECT_IMB2_RCV,\n\tTSI721_VECT_IMB3_RCV,\n\tTSI721_VECT_IMB0_INT,\n\tTSI721_VECT_IMB1_INT,\n\tTSI721_VECT_IMB2_INT,\n\tTSI721_VECT_IMB3_INT,\n#ifdef CONFIG_RAPIDIO_DMA_ENGINE\n\tTSI721_VECT_DMA0_DONE,\n\tTSI721_VECT_DMA1_DONE,\n\tTSI721_VECT_DMA2_DONE,\n\tTSI721_VECT_DMA3_DONE,\n\tTSI721_VECT_DMA4_DONE,\n\tTSI721_VECT_DMA5_DONE,\n\tTSI721_VECT_DMA6_DONE,\n\tTSI721_VECT_DMA7_DONE,\n\tTSI721_VECT_DMA0_INT,\n\tTSI721_VECT_DMA1_INT,\n\tTSI721_VECT_DMA2_INT,\n\tTSI721_VECT_DMA3_INT,\n\tTSI721_VECT_DMA4_INT,\n\tTSI721_VECT_DMA5_INT,\n\tTSI721_VECT_DMA6_INT,\n\tTSI721_VECT_DMA7_INT,\n#endif  \n\tTSI721_VECT_MAX\n};\n\n#define IRQ_DEVICE_NAME_MAX\t64\n\nstruct msix_irq {\n\tu16\tvector;\n\tchar\tirq_name[IRQ_DEVICE_NAME_MAX];\n};\n#endif  \n\nstruct tsi721_ib_win_mapping {\n\tstruct list_head node;\n\tdma_addr_t\tlstart;\n};\n\nstruct tsi721_ib_win {\n\tu64\t\trstart;\n\tu32\t\tsize;\n\tdma_addr_t\tlstart;\n\tbool\t\tactive;\n\tbool\t\txlat;\n\tstruct list_head mappings;\n};\n\nstruct tsi721_obw_bar {\n\tu64\t\tbase;\n\tu64\t\tsize;\n\tu64\t\tfree;\n};\n\nstruct tsi721_ob_win {\n\tu64\t\tbase;\n\tu32\t\tsize;\n\tu16\t\tdestid;\n\tu64\t\trstart;\n\tbool\t\tactive;\n\tstruct tsi721_obw_bar *pbar;\n};\n\nstruct tsi721_device {\n\tstruct pci_dev\t*pdev;\n\tstruct rio_mport mport;\n\tu32\t\tflags;\n\tvoid __iomem\t*regs;\n#ifdef CONFIG_PCI_MSI\n\tstruct msix_irq\tmsix[TSI721_VECT_MAX];\n#endif\n\t \n\tvoid __iomem\t*odb_base;\n\tvoid\t\t*idb_base;\n\tdma_addr_t\tidb_dma;\n\tstruct work_struct idb_work;\n\tu32\t\tdb_discard_count;\n\n\t \n\tstruct work_struct pw_work;\n\tstruct kfifo\tpw_fifo;\n\tspinlock_t\tpw_fifo_lock;\n\tu32\t\tpw_discard_count;\n\n\t \n\tstruct tsi721_bdma_maint mdma;  \n\n#ifdef CONFIG_RAPIDIO_DMA_ENGINE\n\tstruct tsi721_bdma_chan bdma[TSI721_DMA_CHNUM];\n#endif\n\n\t \n\tint\t\timsg_init[TSI721_IMSG_CHNUM];\n\tstruct tsi721_imsg_ring imsg_ring[TSI721_IMSG_CHNUM];\n\n\t \n\tint\t\tomsg_init[TSI721_OMSG_CHNUM];\n\tstruct tsi721_omsg_ring\tomsg_ring[TSI721_OMSG_CHNUM];\n\n\t \n\tstruct tsi721_ib_win ib_win[TSI721_IBWIN_NUM];\n\tint\t\tibwin_cnt;\n\n\t \n\tstruct tsi721_obw_bar p2r_bar[2];\n\tstruct tsi721_ob_win  ob_win[TSI721_OBWIN_NUM];\n\tint\t\tobwin_cnt;\n};\n\n#ifdef CONFIG_RAPIDIO_DMA_ENGINE\nextern void tsi721_bdma_handler(struct tsi721_bdma_chan *bdma_chan);\nextern int tsi721_register_dma(struct tsi721_device *priv);\nextern void tsi721_unregister_dma(struct tsi721_device *priv);\nextern void tsi721_dma_stop_all(struct tsi721_device *priv);\n#else\n#define tsi721_dma_stop_all(priv) do {} while (0)\n#define tsi721_unregister_dma(priv) do {} while (0)\n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}