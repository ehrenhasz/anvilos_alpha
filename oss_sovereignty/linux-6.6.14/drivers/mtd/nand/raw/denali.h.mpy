{
  "module_name": "denali.h",
  "hash_id": "21335b6de24b6c1b1fdc6ad8f2ec9d8b9a48d453313fb319d0983ae24418e7e8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/nand/raw/denali.h",
  "human_readable_source": " \n \n\n#ifndef __DENALI_H__\n#define __DENALI_H__\n\n#include <linux/bits.h>\n#include <linux/completion.h>\n#include <linux/list.h>\n#include <linux/mtd/rawnand.h>\n#include <linux/spinlock_types.h>\n#include <linux/types.h>\n\n#define DEVICE_RESET\t\t\t\t0x0\n#define     DEVICE_RESET__BANK(bank)\t\t\tBIT(bank)\n\n#define TRANSFER_SPARE_REG\t\t\t0x10\n#define     TRANSFER_SPARE_REG__FLAG\t\t\tBIT(0)\n\n#define LOAD_WAIT_CNT\t\t\t\t0x20\n#define     LOAD_WAIT_CNT__VALUE\t\t\tGENMASK(15, 0)\n\n#define PROGRAM_WAIT_CNT\t\t\t0x30\n#define     PROGRAM_WAIT_CNT__VALUE\t\t\tGENMASK(15, 0)\n\n#define ERASE_WAIT_CNT\t\t\t\t0x40\n#define     ERASE_WAIT_CNT__VALUE\t\t\tGENMASK(15, 0)\n\n#define INT_MON_CYCCNT\t\t\t\t0x50\n#define     INT_MON_CYCCNT__VALUE\t\t\tGENMASK(15, 0)\n\n#define RB_PIN_ENABLED\t\t\t\t0x60\n#define     RB_PIN_ENABLED__BANK(bank)\t\t\tBIT(bank)\n\n#define MULTIPLANE_OPERATION\t\t\t0x70\n#define     MULTIPLANE_OPERATION__FLAG\t\t\tBIT(0)\n\n#define MULTIPLANE_READ_ENABLE\t\t\t0x80\n#define     MULTIPLANE_READ_ENABLE__FLAG\t\tBIT(0)\n\n#define COPYBACK_DISABLE\t\t\t0x90\n#define     COPYBACK_DISABLE__FLAG\t\t\tBIT(0)\n\n#define CACHE_WRITE_ENABLE\t\t\t0xa0\n#define     CACHE_WRITE_ENABLE__FLAG\t\t\tBIT(0)\n\n#define CACHE_READ_ENABLE\t\t\t0xb0\n#define     CACHE_READ_ENABLE__FLAG\t\t\tBIT(0)\n\n#define PREFETCH_MODE\t\t\t\t0xc0\n#define     PREFETCH_MODE__PREFETCH_EN\t\t\tBIT(0)\n#define     PREFETCH_MODE__PREFETCH_BURST_LENGTH\tGENMASK(15, 4)\n\n#define CHIP_ENABLE_DONT_CARE\t\t\t0xd0\n#define     CHIP_EN_DONT_CARE__FLAG\t\t\tBIT(0)\n\n#define ECC_ENABLE\t\t\t\t0xe0\n#define     ECC_ENABLE__FLAG\t\t\t\tBIT(0)\n\n#define GLOBAL_INT_ENABLE\t\t\t0xf0\n#define     GLOBAL_INT_EN_FLAG\t\t\t\tBIT(0)\n\n#define TWHR2_AND_WE_2_RE\t\t\t0x100\n#define     TWHR2_AND_WE_2_RE__WE_2_RE\t\t\tGENMASK(5, 0)\n#define     TWHR2_AND_WE_2_RE__TWHR2\t\t\tGENMASK(13, 8)\n\n#define TCWAW_AND_ADDR_2_DATA\t\t\t0x110\n \n#define     TCWAW_AND_ADDR_2_DATA__ADDR_2_DATA\t\tGENMASK(6, 0)\n#define     TCWAW_AND_ADDR_2_DATA__TCWAW\t\tGENMASK(13, 8)\n\n#define RE_2_WE\t\t\t\t\t0x120\n#define     RE_2_WE__VALUE\t\t\t\tGENMASK(5, 0)\n\n#define ACC_CLKS\t\t\t\t0x130\n#define     ACC_CLKS__VALUE\t\t\t\tGENMASK(3, 0)\n\n#define NUMBER_OF_PLANES\t\t\t0x140\n#define     NUMBER_OF_PLANES__VALUE\t\t\tGENMASK(2, 0)\n\n#define PAGES_PER_BLOCK\t\t\t\t0x150\n#define     PAGES_PER_BLOCK__VALUE\t\t\tGENMASK(15, 0)\n\n#define DEVICE_WIDTH\t\t\t\t0x160\n#define     DEVICE_WIDTH__VALUE\t\t\t\tGENMASK(1, 0)\n\n#define DEVICE_MAIN_AREA_SIZE\t\t\t0x170\n#define     DEVICE_MAIN_AREA_SIZE__VALUE\t\tGENMASK(15, 0)\n\n#define DEVICE_SPARE_AREA_SIZE\t\t\t0x180\n#define     DEVICE_SPARE_AREA_SIZE__VALUE\t\tGENMASK(15, 0)\n\n#define TWO_ROW_ADDR_CYCLES\t\t\t0x190\n#define     TWO_ROW_ADDR_CYCLES__FLAG\t\t\tBIT(0)\n\n#define MULTIPLANE_ADDR_RESTRICT\t\t0x1a0\n#define     MULTIPLANE_ADDR_RESTRICT__FLAG\t\tBIT(0)\n\n#define ECC_CORRECTION\t\t\t\t0x1b0\n#define     ECC_CORRECTION__VALUE\t\t\tGENMASK(4, 0)\n#define     ECC_CORRECTION__ERASE_THRESHOLD\t\tGENMASK(31, 16)\n\n#define READ_MODE\t\t\t\t0x1c0\n#define     READ_MODE__VALUE\t\t\t\tGENMASK(3, 0)\n\n#define WRITE_MODE\t\t\t\t0x1d0\n#define     WRITE_MODE__VALUE\t\t\t\tGENMASK(3, 0)\n\n#define COPYBACK_MODE\t\t\t\t0x1e0\n#define     COPYBACK_MODE__VALUE\t\t\tGENMASK(3, 0)\n\n#define RDWR_EN_LO_CNT\t\t\t\t0x1f0\n#define     RDWR_EN_LO_CNT__VALUE\t\t\tGENMASK(4, 0)\n\n#define RDWR_EN_HI_CNT\t\t\t\t0x200\n#define     RDWR_EN_HI_CNT__VALUE\t\t\tGENMASK(4, 0)\n\n#define MAX_RD_DELAY\t\t\t\t0x210\n#define     MAX_RD_DELAY__VALUE\t\t\t\tGENMASK(3, 0)\n\n#define CS_SETUP_CNT\t\t\t\t0x220\n#define     CS_SETUP_CNT__VALUE\t\t\t\tGENMASK(4, 0)\n#define     CS_SETUP_CNT__TWB\t\t\t\tGENMASK(17, 12)\n\n#define SPARE_AREA_SKIP_BYTES\t\t\t0x230\n#define     SPARE_AREA_SKIP_BYTES__VALUE\t\tGENMASK(5, 0)\n\n#define SPARE_AREA_MARKER\t\t\t0x240\n#define     SPARE_AREA_MARKER__VALUE\t\t\tGENMASK(15, 0)\n\n#define DEVICES_CONNECTED\t\t\t0x250\n#define     DEVICES_CONNECTED__VALUE\t\t\tGENMASK(2, 0)\n\n#define DIE_MASK\t\t\t\t0x260\n#define     DIE_MASK__VALUE\t\t\t\tGENMASK(7, 0)\n\n#define FIRST_BLOCK_OF_NEXT_PLANE\t\t0x270\n#define     FIRST_BLOCK_OF_NEXT_PLANE__VALUE\t\tGENMASK(15, 0)\n\n#define WRITE_PROTECT\t\t\t\t0x280\n#define     WRITE_PROTECT__FLAG\t\t\t\tBIT(0)\n\n#define RE_2_RE\t\t\t\t\t0x290\n#define     RE_2_RE__VALUE\t\t\t\tGENMASK(5, 0)\n\n#define MANUFACTURER_ID\t\t\t\t0x300\n#define     MANUFACTURER_ID__VALUE\t\t\tGENMASK(7, 0)\n\n#define DEVICE_ID\t\t\t\t0x310\n#define     DEVICE_ID__VALUE\t\t\t\tGENMASK(7, 0)\n\n#define DEVICE_PARAM_0\t\t\t\t0x320\n#define     DEVICE_PARAM_0__VALUE\t\t\tGENMASK(7, 0)\n\n#define DEVICE_PARAM_1\t\t\t\t0x330\n#define     DEVICE_PARAM_1__VALUE\t\t\tGENMASK(7, 0)\n\n#define DEVICE_PARAM_2\t\t\t\t0x340\n#define     DEVICE_PARAM_2__VALUE\t\t\tGENMASK(7, 0)\n\n#define LOGICAL_PAGE_DATA_SIZE\t\t\t0x350\n#define     LOGICAL_PAGE_DATA_SIZE__VALUE\t\tGENMASK(15, 0)\n\n#define LOGICAL_PAGE_SPARE_SIZE\t\t\t0x360\n#define     LOGICAL_PAGE_SPARE_SIZE__VALUE\t\tGENMASK(15, 0)\n\n#define REVISION\t\t\t\t0x370\n#define     REVISION__VALUE\t\t\t\tGENMASK(15, 0)\n\n#define ONFI_DEVICE_FEATURES\t\t\t0x380\n#define     ONFI_DEVICE_FEATURES__VALUE\t\t\tGENMASK(5, 0)\n\n#define ONFI_OPTIONAL_COMMANDS\t\t\t0x390\n#define     ONFI_OPTIONAL_COMMANDS__VALUE\t\tGENMASK(5, 0)\n\n#define ONFI_TIMING_MODE\t\t\t0x3a0\n#define     ONFI_TIMING_MODE__VALUE\t\t\tGENMASK(5, 0)\n\n#define ONFI_PGM_CACHE_TIMING_MODE\t\t0x3b0\n#define     ONFI_PGM_CACHE_TIMING_MODE__VALUE\t\tGENMASK(5, 0)\n\n#define ONFI_DEVICE_NO_OF_LUNS\t\t\t0x3c0\n#define     ONFI_DEVICE_NO_OF_LUNS__NO_OF_LUNS\t\tGENMASK(7, 0)\n#define     ONFI_DEVICE_NO_OF_LUNS__ONFI_DEVICE\t\tBIT(8)\n\n#define ONFI_DEVICE_NO_OF_BLOCKS_PER_LUN_L\t0x3d0\n#define     ONFI_DEVICE_NO_OF_BLOCKS_PER_LUN_L__VALUE\tGENMASK(15, 0)\n\n#define ONFI_DEVICE_NO_OF_BLOCKS_PER_LUN_U\t0x3e0\n#define     ONFI_DEVICE_NO_OF_BLOCKS_PER_LUN_U__VALUE\tGENMASK(15, 0)\n\n#define FEATURES\t\t\t\t0x3f0\n#define     FEATURES__N_BANKS\t\t\t\tGENMASK(1, 0)\n#define     FEATURES__ECC_MAX_ERR\t\t\tGENMASK(5, 2)\n#define     FEATURES__DMA\t\t\t\tBIT(6)\n#define     FEATURES__CMD_DMA\t\t\t\tBIT(7)\n#define     FEATURES__PARTITION\t\t\t\tBIT(8)\n#define     FEATURES__XDMA_SIDEBAND\t\t\tBIT(9)\n#define     FEATURES__GPREG\t\t\t\tBIT(10)\n#define     FEATURES__INDEX_ADDR\t\t\tBIT(11)\n\n#define TRANSFER_MODE\t\t\t\t0x400\n#define     TRANSFER_MODE__VALUE\t\t\tGENMASK(1, 0)\n\n#define INTR_STATUS(bank)\t\t\t(0x410 + (bank) * 0x50)\n#define INTR_EN(bank)\t\t\t\t(0x420 + (bank) * 0x50)\n \n#define     INTR__ECC_UNCOR_ERR\t\t\t\tBIT(0)\t \n#define     INTR__ECC_TRANSACTION_DONE\t\t\tBIT(0)\t \n#define     INTR__ECC_ERR\t\t\t\tBIT(1)\t \n#define     INTR__DMA_CMD_COMP\t\t\t\tBIT(2)\n#define     INTR__TIME_OUT\t\t\t\tBIT(3)\n#define     INTR__PROGRAM_FAIL\t\t\t\tBIT(4)\n#define     INTR__ERASE_FAIL\t\t\t\tBIT(5)\n#define     INTR__LOAD_COMP\t\t\t\tBIT(6)\n#define     INTR__PROGRAM_COMP\t\t\t\tBIT(7)\n#define     INTR__ERASE_COMP\t\t\t\tBIT(8)\n#define     INTR__PIPE_CPYBCK_CMD_COMP\t\t\tBIT(9)\n#define     INTR__LOCKED_BLK\t\t\t\tBIT(10)\n#define     INTR__UNSUP_CMD\t\t\t\tBIT(11)\n#define     INTR__INT_ACT\t\t\t\tBIT(12)\n#define     INTR__RST_COMP\t\t\t\tBIT(13)\n#define     INTR__PIPE_CMD_ERR\t\t\t\tBIT(14)\n#define     INTR__PAGE_XFER_INC\t\t\t\tBIT(15)\n#define     INTR__ERASED_PAGE\t\t\t\tBIT(16)\n\n#define PAGE_CNT(bank)\t\t\t\t(0x430 + (bank) * 0x50)\n#define ERR_PAGE_ADDR(bank)\t\t\t(0x440 + (bank) * 0x50)\n#define ERR_BLOCK_ADDR(bank)\t\t\t(0x450 + (bank) * 0x50)\n\n#define ECC_THRESHOLD\t\t\t\t0x600\n#define     ECC_THRESHOLD__VALUE\t\t\tGENMASK(9, 0)\n\n#define ECC_ERROR_BLOCK_ADDRESS\t\t\t0x610\n#define     ECC_ERROR_BLOCK_ADDRESS__VALUE\t\tGENMASK(15, 0)\n\n#define ECC_ERROR_PAGE_ADDRESS\t\t\t0x620\n#define     ECC_ERROR_PAGE_ADDRESS__VALUE\t\tGENMASK(11, 0)\n#define     ECC_ERROR_PAGE_ADDRESS__BANK\t\tGENMASK(15, 12)\n\n#define ECC_ERROR_ADDRESS\t\t\t0x630\n#define     ECC_ERROR_ADDRESS__OFFSET\t\t\tGENMASK(11, 0)\n#define     ECC_ERROR_ADDRESS__SECTOR\t\t\tGENMASK(15, 12)\n\n#define ERR_CORRECTION_INFO\t\t\t0x640\n#define     ERR_CORRECTION_INFO__BYTE\t\t\tGENMASK(7, 0)\n#define     ERR_CORRECTION_INFO__DEVICE\t\t\tGENMASK(11, 8)\n#define     ERR_CORRECTION_INFO__UNCOR\t\t\tBIT(14)\n#define     ERR_CORRECTION_INFO__LAST_ERR\t\tBIT(15)\n\n#define ECC_COR_INFO(bank)\t\t\t(0x650 + (bank) / 2 * 0x10)\n#define     ECC_COR_INFO__SHIFT(bank)\t\t\t((bank) % 2 * 8)\n#define     ECC_COR_INFO__MAX_ERRORS\t\t\tGENMASK(6, 0)\n#define     ECC_COR_INFO__UNCOR_ERR\t\t\tBIT(7)\n\n#define CFG_DATA_BLOCK_SIZE\t\t\t0x6b0\n\n#define CFG_LAST_DATA_BLOCK_SIZE\t\t0x6c0\n\n#define CFG_NUM_DATA_BLOCKS\t\t\t0x6d0\n\n#define CFG_META_DATA_SIZE\t\t\t0x6e0\n\n#define DMA_ENABLE\t\t\t\t0x700\n#define     DMA_ENABLE__FLAG\t\t\t\tBIT(0)\n\n#define IGNORE_ECC_DONE\t\t\t\t0x710\n#define     IGNORE_ECC_DONE__FLAG\t\t\tBIT(0)\n\n#define DMA_INTR\t\t\t\t0x720\n#define DMA_INTR_EN\t\t\t\t0x730\n#define     DMA_INTR__TARGET_ERROR\t\t\tBIT(0)\n#define     DMA_INTR__DESC_COMP_CHANNEL0\t\tBIT(1)\n#define     DMA_INTR__DESC_COMP_CHANNEL1\t\tBIT(2)\n#define     DMA_INTR__DESC_COMP_CHANNEL2\t\tBIT(3)\n#define     DMA_INTR__DESC_COMP_CHANNEL3\t\tBIT(4)\n#define     DMA_INTR__MEMCOPY_DESC_COMP\t\t\tBIT(5)\n\n#define TARGET_ERR_ADDR_LO\t\t\t0x740\n#define     TARGET_ERR_ADDR_LO__VALUE\t\t\tGENMASK(15, 0)\n\n#define TARGET_ERR_ADDR_HI\t\t\t0x750\n#define     TARGET_ERR_ADDR_HI__VALUE\t\t\tGENMASK(15, 0)\n\n#define CHNL_ACTIVE\t\t\t\t0x760\n#define     CHNL_ACTIVE__CHANNEL0\t\t\tBIT(0)\n#define     CHNL_ACTIVE__CHANNEL1\t\t\tBIT(1)\n#define     CHNL_ACTIVE__CHANNEL2\t\t\tBIT(2)\n#define     CHNL_ACTIVE__CHANNEL3\t\t\tBIT(3)\n\n \nstruct denali_chip_sel {\n\tint bank;\n\tu32 hwhr2_and_we_2_re;\n\tu32 tcwaw_and_addr_2_data;\n\tu32 re_2_we;\n\tu32 acc_clks;\n\tu32 rdwr_en_lo_cnt;\n\tu32 rdwr_en_hi_cnt;\n\tu32 cs_setup_cnt;\n\tu32 re_2_re;\n};\n\n \nstruct denali_chip {\n\tstruct nand_chip chip;\n\tstruct list_head node;\n\tunsigned int nsels;\n\tstruct denali_chip_sel sels[];\n};\n\n \nstruct denali_controller {\n\tstruct nand_controller controller;\n\tstruct device *dev;\n\tstruct list_head chips;\n\tunsigned long clk_rate;\n\tunsigned long clk_x_rate;\n\tvoid __iomem *reg;\n\tvoid __iomem *host;\n\tstruct completion complete;\n\tint irq;\n\tu32 irq_mask;\n\tu32 irq_status;\n\tspinlock_t irq_lock;\n\tbool dma_avail;\n\tint devs_per_cs;\n\tint oob_skip_bytes;\n\tint active_bank;\n\tint nbanks;\n\tunsigned int revision;\n\tunsigned int caps;\n\tconst struct nand_ecc_caps *ecc_caps;\n\tu32 (*host_read)(struct denali_controller *denali, u32 addr);\n\tvoid (*host_write)(struct denali_controller *denali, u32 addr,\n\t\t\t   u32 data);\n\tvoid (*setup_dma)(struct denali_controller *denali, dma_addr_t dma_addr,\n\t\t\t  int page, bool write);\n};\n\n#define DENALI_CAP_HW_ECC_FIXUP\t\t\tBIT(0)\n#define DENALI_CAP_DMA_64BIT\t\t\tBIT(1)\n\nint denali_calc_ecc_bytes(int step_size, int strength);\nint denali_chip_init(struct denali_controller *denali,\n\t\t     struct denali_chip *dchip);\nint denali_init(struct denali_controller *denali);\nvoid denali_remove(struct denali_controller *denali);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}