{
  "module_name": "esmt.c",
  "hash_id": "00e648ba131c2cc1ee289e06cf7b326d4614e852d2bab5a1b9e9b7936844925f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/nand/spi/esmt.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/mtd/spinand.h>\n\n \n#define SPINAND_MFR_ESMT_C8\t\t\t0xc8\n\nstatic SPINAND_OP_VARIANTS(read_cache_variants,\n\t\t\t   SPINAND_PAGE_READ_FROM_CACHE_X4_OP(0, 1, NULL, 0),\n\t\t\t   SPINAND_PAGE_READ_FROM_CACHE_X2_OP(0, 1, NULL, 0),\n\t\t\t   SPINAND_PAGE_READ_FROM_CACHE_OP(true, 0, 1, NULL, 0),\n\t\t\t   SPINAND_PAGE_READ_FROM_CACHE_OP(false, 0, 1, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(write_cache_variants,\n\t\t\t   SPINAND_PROG_LOAD_X4(true, 0, NULL, 0),\n\t\t\t   SPINAND_PROG_LOAD(true, 0, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(update_cache_variants,\n\t\t\t   SPINAND_PROG_LOAD_X4(false, 0, NULL, 0),\n\t\t\t   SPINAND_PROG_LOAD(false, 0, NULL, 0));\n\n \n\n#define ESMT_OOB_SECTION_COUNT\t\t\t4\n#define ESMT_OOB_SECTION_SIZE(nand) \\\n\t(nanddev_per_page_oobsize(nand) / ESMT_OOB_SECTION_COUNT)\n#define ESMT_OOB_FREE_SIZE(nand) \\\n\t(ESMT_OOB_SECTION_SIZE(nand) / 2)\n#define ESMT_OOB_ECC_SIZE(nand) \\\n\t(ESMT_OOB_SECTION_SIZE(nand) - ESMT_OOB_FREE_SIZE(nand))\n#define ESMT_OOB_BBM_SIZE\t\t\t2\n\nstatic int f50l1g41lb_ooblayout_ecc(struct mtd_info *mtd, int section,\n\t\t\t\t    struct mtd_oob_region *region)\n{\n\tstruct nand_device *nand = mtd_to_nanddev(mtd);\n\n\tif (section >= ESMT_OOB_SECTION_COUNT)\n\t\treturn -ERANGE;\n\n\tregion->offset = section * ESMT_OOB_SECTION_SIZE(nand) +\n\t\t\t ESMT_OOB_FREE_SIZE(nand);\n\tregion->length = ESMT_OOB_ECC_SIZE(nand);\n\n\treturn 0;\n}\n\nstatic int f50l1g41lb_ooblayout_free(struct mtd_info *mtd, int section,\n\t\t\t\t     struct mtd_oob_region *region)\n{\n\tstruct nand_device *nand = mtd_to_nanddev(mtd);\n\n\tif (section >= ESMT_OOB_SECTION_COUNT)\n\t\treturn -ERANGE;\n\n\t \n\tregion->offset = section * ESMT_OOB_SECTION_SIZE(nand) + 2;\n\n\t \n\tregion->length = 2;\n\n\treturn 0;\n}\n\nstatic const struct mtd_ooblayout_ops f50l1g41lb_ooblayout = {\n\t.ecc = f50l1g41lb_ooblayout_ecc,\n\t.free = f50l1g41lb_ooblayout_free,\n};\n\nstatic const struct spinand_info esmt_c8_spinand_table[] = {\n\tSPINAND_INFO(\"F50L1G41LB\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0x01),\n\t\t     NAND_MEMORG(1, 2048, 64, 64, 1024, 20, 1, 1, 1),\n\t\t     NAND_ECCREQ(1, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     0,\n\t\t     SPINAND_ECCINFO(&f50l1g41lb_ooblayout, NULL)),\n\tSPINAND_INFO(\"F50D1G41LB\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0x11),\n\t\t     NAND_MEMORG(1, 2048, 64, 64, 1024, 20, 1, 1, 1),\n\t\t     NAND_ECCREQ(1, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     0,\n\t\t     SPINAND_ECCINFO(&f50l1g41lb_ooblayout, NULL)),\n\tSPINAND_INFO(\"F50D2G41KA\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0x51),\n\t\t     NAND_MEMORG(1, 2048, 128, 64, 2048, 40, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     0,\n\t\t     SPINAND_ECCINFO(&f50l1g41lb_ooblayout, NULL)),\n};\n\nstatic const struct spinand_manufacturer_ops esmt_spinand_manuf_ops = {\n};\n\nconst struct spinand_manufacturer esmt_c8_spinand_manufacturer = {\n\t.id = SPINAND_MFR_ESMT_C8,\n\t.name = \"ESMT\",\n\t.chips = esmt_c8_spinand_table,\n\t.nchips = ARRAY_SIZE(esmt_c8_spinand_table),\n\t.ops = &esmt_spinand_manuf_ops,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}