{
  "module_name": "xtx.c",
  "hash_id": "cffa1a3911113504c556538268ad9a45a36a6f2447cca76918e9d226062f5827",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/nand/spi/xtx.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/mtd/spinand.h>\n\n#define SPINAND_MFR_XTX\t0x0B\n\n#define XT26G0XA_STATUS_ECC_MASK\tGENMASK(5, 2)\n#define XT26G0XA_STATUS_ECC_NO_DETECTED\t(0 << 2)\n#define XT26G0XA_STATUS_ECC_8_CORRECTED\t(3 << 4)\n#define XT26G0XA_STATUS_ECC_UNCOR_ERROR\t(2 << 4)\n\nstatic SPINAND_OP_VARIANTS(read_cache_variants,\n\t\tSPINAND_PAGE_READ_FROM_CACHE_QUADIO_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_X4_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_DUALIO_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_X2_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_OP(true, 0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_OP(false, 0, 1, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(write_cache_variants,\n\t\tSPINAND_PROG_LOAD_X4(true, 0, NULL, 0),\n\t\tSPINAND_PROG_LOAD(true, 0, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(update_cache_variants,\n\t\tSPINAND_PROG_LOAD_X4(false, 0, NULL, 0),\n\t\tSPINAND_PROG_LOAD(false, 0, NULL, 0));\n\nstatic int xt26g0xa_ooblayout_ecc(struct mtd_info *mtd, int section,\n\t\t\t\t   struct mtd_oob_region *region)\n{\n\tif (section)\n\t\treturn -ERANGE;\n\n\tregion->offset = 48;\n\tregion->length = 16;\n\n\treturn 0;\n}\n\nstatic int xt26g0xa_ooblayout_free(struct mtd_info *mtd, int section,\n\t\t\t\t   struct mtd_oob_region *region)\n{\n\tif (section)\n\t\treturn -ERANGE;\n\n\tregion->offset = 1;\n\tregion->length = 47;\n\n\treturn 0;\n}\n\nstatic const struct mtd_ooblayout_ops xt26g0xa_ooblayout = {\n\t.ecc = xt26g0xa_ooblayout_ecc,\n\t.free = xt26g0xa_ooblayout_free,\n};\n\nstatic int xt26g0xa_ecc_get_status(struct spinand_device *spinand,\n\t\t\t\t\t u8 status)\n{\n\tstatus = status & XT26G0XA_STATUS_ECC_MASK;\n\n\tswitch (status) {\n\tcase XT26G0XA_STATUS_ECC_NO_DETECTED:\n\t\treturn 0;\n\tcase XT26G0XA_STATUS_ECC_8_CORRECTED:\n\t\treturn 8;\n\tcase XT26G0XA_STATUS_ECC_UNCOR_ERROR:\n\t\treturn -EBADMSG;\n\tdefault:\n\t\tbreak;\n\t}\n\n\t \n\tif (status > XT26G0XA_STATUS_ECC_UNCOR_ERROR)\n\t\treturn -EINVAL;\n\n\t \n\treturn status >> 2;\n}\n\nstatic const struct spinand_info xtx_spinand_table[] = {\n\tSPINAND_INFO(\"XT26G01A\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0xE1),\n\t\t     NAND_MEMORG(1, 2048, 64, 64, 1024, 20, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     SPINAND_HAS_QE_BIT,\n\t\t     SPINAND_ECCINFO(&xt26g0xa_ooblayout,\n\t\t\t\t     xt26g0xa_ecc_get_status)),\n\tSPINAND_INFO(\"XT26G02A\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0xE2),\n\t\t     NAND_MEMORG(1, 2048, 64, 64, 2048, 40, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     SPINAND_HAS_QE_BIT,\n\t\t     SPINAND_ECCINFO(&xt26g0xa_ooblayout,\n\t\t\t\t     xt26g0xa_ecc_get_status)),\n\tSPINAND_INFO(\"XT26G04A\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_ADDR, 0xE3),\n\t\t     NAND_MEMORG(1, 2048, 64, 128, 2048, 40, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     SPINAND_HAS_QE_BIT,\n\t\t     SPINAND_ECCINFO(&xt26g0xa_ooblayout,\n\t\t\t\t     xt26g0xa_ecc_get_status)),\n};\n\nstatic const struct spinand_manufacturer_ops xtx_spinand_manuf_ops = {\n};\n\nconst struct spinand_manufacturer xtx_spinand_manufacturer = {\n\t.id = SPINAND_MFR_XTX,\n\t.name = \"XTX\",\n\t.chips = xtx_spinand_table,\n\t.nchips = ARRAY_SIZE(xtx_spinand_table),\n\t.ops = &xtx_spinand_manuf_ops,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}