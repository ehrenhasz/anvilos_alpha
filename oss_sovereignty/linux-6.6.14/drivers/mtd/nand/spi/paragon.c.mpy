{
  "module_name": "paragon.c",
  "hash_id": "3270f5b0ceb1f0cc5896f4254eccc3ca4ddc2fa63cf7f83f440232bb6cee1ba1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/nand/spi/paragon.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/mtd/spinand.h>\n\n\n#define SPINAND_MFR_PARAGON\t0xa1\n\n\n#define PN26G0XA_STATUS_ECC_BITMASK\t\t(3 << 4)\n\n#define PN26G0XA_STATUS_ECC_NONE_DETECTED\t(0 << 4)\n#define PN26G0XA_STATUS_ECC_1_7_CORRECTED\t(1 << 4)\n#define PN26G0XA_STATUS_ECC_ERRORED\t\t(2 << 4)\n#define PN26G0XA_STATUS_ECC_8_CORRECTED\t\t(3 << 4)\n\n\nstatic SPINAND_OP_VARIANTS(read_cache_variants,\n\t\tSPINAND_PAGE_READ_FROM_CACHE_QUADIO_OP(0, 2, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_X4_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_DUALIO_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_X2_OP(0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_OP(true, 0, 1, NULL, 0),\n\t\tSPINAND_PAGE_READ_FROM_CACHE_OP(false, 0, 1, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(write_cache_variants,\n\t\tSPINAND_PROG_LOAD_X4(true, 0, NULL, 0),\n\t\tSPINAND_PROG_LOAD(true, 0, NULL, 0));\n\nstatic SPINAND_OP_VARIANTS(update_cache_variants,\n\t\tSPINAND_PROG_LOAD_X4(false, 0, NULL, 0),\n\t\tSPINAND_PROG_LOAD(false, 0, NULL, 0));\n\n\nstatic int pn26g0xa_ooblayout_ecc(struct mtd_info *mtd, int section,\n\t\t\t\t   struct mtd_oob_region *region)\n{\n\tif (section > 3)\n\t\treturn -ERANGE;\n\n\tregion->offset = 6 + (15 * section);  \n\tregion->length = 13;\n\n\treturn 0;\n}\n\nstatic int pn26g0xa_ooblayout_free(struct mtd_info *mtd, int section,\n\t\t\t\t   struct mtd_oob_region *region)\n{\n\tif (section > 4)\n\t\treturn -ERANGE;\n\n\tif (section == 4) {\n\t\tregion->offset = 64;\n\t\tregion->length = 64;\n\t} else {\n\t\tregion->offset = 4 + (15 * section);\n\t\tregion->length = 2;\n\t}\n\n\treturn 0;\n}\n\nstatic int pn26g0xa_ecc_get_status(struct spinand_device *spinand,\n\t\t\t\t   u8 status)\n{\n\tswitch (status & PN26G0XA_STATUS_ECC_BITMASK) {\n\tcase PN26G0XA_STATUS_ECC_NONE_DETECTED:\n\t\treturn 0;\n\n\tcase PN26G0XA_STATUS_ECC_1_7_CORRECTED:\n\t\treturn 7;\t \n\n\tcase PN26G0XA_STATUS_ECC_8_CORRECTED:\n\t\treturn 8;\n\n\tcase PN26G0XA_STATUS_ECC_ERRORED:\n\t\treturn -EBADMSG;\n\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn -EINVAL;\n}\n\nstatic const struct mtd_ooblayout_ops pn26g0xa_ooblayout = {\n\t.ecc = pn26g0xa_ooblayout_ecc,\n\t.free = pn26g0xa_ooblayout_free,\n};\n\n\nstatic const struct spinand_info paragon_spinand_table[] = {\n\tSPINAND_INFO(\"PN26G01A\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_DUMMY, 0xe1),\n\t\t     NAND_MEMORG(1, 2048, 128, 64, 1024, 21, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     0,\n\t\t     SPINAND_ECCINFO(&pn26g0xa_ooblayout,\n\t\t\t\t     pn26g0xa_ecc_get_status)),\n\tSPINAND_INFO(\"PN26G02A\",\n\t\t     SPINAND_ID(SPINAND_READID_METHOD_OPCODE_DUMMY, 0xe2),\n\t\t     NAND_MEMORG(1, 2048, 128, 64, 2048, 41, 1, 1, 1),\n\t\t     NAND_ECCREQ(8, 512),\n\t\t     SPINAND_INFO_OP_VARIANTS(&read_cache_variants,\n\t\t\t\t\t      &write_cache_variants,\n\t\t\t\t\t      &update_cache_variants),\n\t\t     0,\n\t\t     SPINAND_ECCINFO(&pn26g0xa_ooblayout,\n\t\t\t\t     pn26g0xa_ecc_get_status)),\n};\n\nstatic const struct spinand_manufacturer_ops paragon_spinand_manuf_ops = {\n};\n\nconst struct spinand_manufacturer paragon_spinand_manufacturer = {\n\t.id = SPINAND_MFR_PARAGON,\n\t.name = \"Paragon\",\n\t.chips = paragon_spinand_table,\n\t.nchips = ARRAY_SIZE(paragon_spinand_table),\n\t.ops = &paragon_spinand_manuf_ops,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}