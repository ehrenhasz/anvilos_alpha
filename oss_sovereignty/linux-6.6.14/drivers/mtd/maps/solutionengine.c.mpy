{
  "module_name": "solutionengine.c",
  "hash_id": "41938755e20410aa28fc079d3ac9d54fcbff03ad5a21168d37bd93468841096a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/maps/solutionengine.c",
  "human_readable_source": " \n\n#include <linux/module.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <asm/io.h>\n#include <linux/mtd/mtd.h>\n#include <linux/mtd/map.h>\n#include <linux/mtd/partitions.h>\n#include <linux/errno.h>\n\nstatic struct mtd_info *flash_mtd;\nstatic struct mtd_info *eprom_mtd;\n\nstruct map_info soleng_eprom_map = {\n\t.name = \"Solution Engine EPROM\",\n\t.size = 0x400000,\n\t.bankwidth = 4,\n};\n\nstruct map_info soleng_flash_map = {\n\t.name = \"Solution Engine FLASH\",\n\t.size = 0x400000,\n\t.bankwidth = 4,\n};\n\nstatic const char * const probes[] = { \"RedBoot\", \"cmdlinepart\", NULL };\n\nstatic int __init init_soleng_maps(void)\n{\n\t \n\tsoleng_flash_map.phys = 0;\n\tsoleng_flash_map.virt = (void __iomem *)P2SEGADDR(0);\n\tsoleng_eprom_map.phys = 0x01000000;\n\tsoleng_eprom_map.virt = (void __iomem *)P1SEGADDR(0x01000000);\n\tsimple_map_init(&soleng_eprom_map);\n\tsimple_map_init(&soleng_flash_map);\n\n\tprintk(KERN_NOTICE \"Probing for flash chips at 0x00000000:\\n\");\n\tflash_mtd = do_map_probe(\"cfi_probe\", &soleng_flash_map);\n\tif (!flash_mtd) {\n\t\t \n\t\tprintk(KERN_NOTICE \"Probing for flash chips at 0x01000000:\\n\");\n\t\tsoleng_flash_map.phys = 0x01000000;\n\t\tsoleng_flash_map.virt = P2SEGADDR(0x01000000);\n\t\tsoleng_eprom_map.phys = 0;\n\t\tsoleng_eprom_map.virt = P1SEGADDR(0);\n\t\tflash_mtd = do_map_probe(\"cfi_probe\", &soleng_flash_map);\n\t\tif (!flash_mtd) {\n\t\t\t \n\t\t\tprintk(KERN_NOTICE \"Flash chips not detected at either possible location.\\n\");\n\t\t\treturn -ENXIO;\n\t\t}\n\t}\n\tprintk(KERN_NOTICE \"Solution Engine: Flash at 0x%pap, EPROM at 0x%pap\\n\",\n\t       &soleng_flash_map.phys,\n\t       &soleng_eprom_map.phys);\n\tflash_mtd->owner = THIS_MODULE;\n\n\teprom_mtd = do_map_probe(\"map_rom\", &soleng_eprom_map);\n\tif (eprom_mtd) {\n\t\teprom_mtd->owner = THIS_MODULE;\n\t\tmtd_device_register(eprom_mtd, NULL, 0);\n\t}\n\n\tmtd_device_parse_register(flash_mtd, probes, NULL, NULL, 0);\n\n\treturn 0;\n}\n\nstatic void __exit cleanup_soleng_maps(void)\n{\n\tif (eprom_mtd) {\n\t\tmtd_device_unregister(eprom_mtd);\n\t\tmap_destroy(eprom_mtd);\n\t}\n\n\tmtd_device_unregister(flash_mtd);\n\tmap_destroy(flash_mtd);\n}\n\nmodule_init(init_soleng_maps);\nmodule_exit(cleanup_soleng_maps);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"David Woodhouse <dwmw2@infradead.org>\");\nMODULE_DESCRIPTION(\"MTD map driver for Hitachi SolutionEngine (and similar) boards\");\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}