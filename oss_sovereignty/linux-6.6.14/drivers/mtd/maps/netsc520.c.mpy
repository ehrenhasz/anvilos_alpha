{
  "module_name": "netsc520.c",
  "hash_id": "7696975f45f82087ba12b914b64233e6fa8d430443d744ca52413640589f08ef",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mtd/maps/netsc520.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <asm/io.h>\n#include <linux/mtd/mtd.h>\n#include <linux/mtd/map.h>\n#include <linux/mtd/partitions.h>\n\n\n \n\n \nstatic const struct mtd_partition partition_info[] = {\n    {\n\t    .name = \"NetSc520 boot kernel\",\n\t    .offset = 0,\n\t    .size = 0xc0000\n    },\n    {\n\t    .name = \"NetSc520 Low BIOS\",\n\t    .offset = 0xc0000,\n\t    .size = 0x40000\n    },\n    {\n\t    .name = \"NetSc520 file system\",\n\t    .offset = 0x100000,\n\t    .size = 0xe80000\n    },\n    {\n\t    .name = \"NetSc520 High BIOS\",\n\t    .offset = 0xf80000,\n\t    .size = 0x80000\n    },\n};\n#define NUM_PARTITIONS ARRAY_SIZE(partition_info)\n\n#define WINDOW_SIZE\t0x00100000\n#define WINDOW_ADDR\t0x00200000\n\nstatic struct map_info netsc520_map = {\n\t.name = \"netsc520 Flash Bank\",\n\t.size = WINDOW_SIZE,\n\t.bankwidth = 4,\n\t.phys = WINDOW_ADDR,\n};\n\n#define NUM_FLASH_BANKS\tARRAY_SIZE(netsc520_map)\n\nstatic struct mtd_info *mymtd;\n\nstatic int __init init_netsc520(void)\n{\n\tprintk(KERN_NOTICE \"NetSc520 flash device: 0x%Lx at 0x%Lx\\n\",\n\t\t\t(unsigned long long)netsc520_map.size,\n\t\t\t(unsigned long long)netsc520_map.phys);\n\tnetsc520_map.virt = ioremap(netsc520_map.phys, netsc520_map.size);\n\n\tif (!netsc520_map.virt) {\n\t\tprintk(\"Failed to ioremap\\n\");\n\t\treturn -EIO;\n\t}\n\n\tsimple_map_init(&netsc520_map);\n\n\tmymtd = do_map_probe(\"cfi_probe\", &netsc520_map);\n\tif(!mymtd)\n\t\tmymtd = do_map_probe(\"map_ram\", &netsc520_map);\n\tif(!mymtd)\n\t\tmymtd = do_map_probe(\"map_rom\", &netsc520_map);\n\n\tif (!mymtd) {\n\t\tiounmap(netsc520_map.virt);\n\t\treturn -ENXIO;\n\t}\n\n\tmymtd->owner = THIS_MODULE;\n\tmtd_device_register(mymtd, partition_info, NUM_PARTITIONS);\n\treturn 0;\n}\n\nstatic void __exit cleanup_netsc520(void)\n{\n\tif (mymtd) {\n\t\tmtd_device_unregister(mymtd);\n\t\tmap_destroy(mymtd);\n\t}\n\tif (netsc520_map.virt) {\n\t\tiounmap(netsc520_map.virt);\n\t\tnetsc520_map.virt = NULL;\n\t}\n}\n\nmodule_init(init_netsc520);\nmodule_exit(cleanup_netsc520);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Mark Langsdorf <mark.langsdorf@amd.com>\");\nMODULE_DESCRIPTION(\"MTD map driver for AMD NetSc520 Demonstration Board\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}