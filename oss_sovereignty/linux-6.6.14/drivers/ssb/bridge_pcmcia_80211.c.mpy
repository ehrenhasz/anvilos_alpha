{
  "module_name": "bridge_pcmcia_80211.c",
  "hash_id": "3566976487061f4988dd5f2444dd6767406000092af7d24adebd54fed5e34272",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ssb/bridge_pcmcia_80211.c",
  "human_readable_source": " \n\n#include \"ssb_private.h\"\n\n#include <linux/ssb/ssb.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n\n#include <pcmcia/cistpl.h>\n#include <pcmcia/ciscode.h>\n#include <pcmcia/ds.h>\n#include <pcmcia/cisreg.h>\n\nstatic const struct pcmcia_device_id ssb_host_pcmcia_tbl[] = {\n\tPCMCIA_DEVICE_MANF_CARD(0x2D0, 0x448),\n\tPCMCIA_DEVICE_MANF_CARD(0x2D0, 0x476),\n\tPCMCIA_DEVICE_NULL,\n};\n\nMODULE_DEVICE_TABLE(pcmcia, ssb_host_pcmcia_tbl);\n\nstatic int ssb_host_pcmcia_probe(struct pcmcia_device *dev)\n{\n\tstruct ssb_bus *ssb;\n\tint err = -ENOMEM;\n\tint res = 0;\n\n\tssb = kzalloc(sizeof(*ssb), GFP_KERNEL);\n\tif (!ssb)\n\t\tgoto out_error;\n\n\terr = -ENODEV;\n\n\tdev->config_flags |= CONF_ENABLE_IRQ;\n\n\tdev->resource[2]->flags |=  WIN_ENABLE | WIN_DATA_WIDTH_16 |\n\t\t\t WIN_USE_WAIT;\n\tdev->resource[2]->start = 0;\n\tdev->resource[2]->end = SSB_CORE_SIZE;\n\tres = pcmcia_request_window(dev, dev->resource[2], 250);\n\tif (res != 0)\n\t\tgoto err_kfree_ssb;\n\n\tres = pcmcia_map_mem_page(dev, dev->resource[2], 0);\n\tif (res != 0)\n\t\tgoto err_disable;\n\n\tif (!dev->irq)\n\t\tgoto err_disable;\n\n\tres = pcmcia_enable_device(dev);\n\tif (res != 0)\n\t\tgoto err_disable;\n\n\terr = ssb_bus_pcmciabus_register(ssb, dev, dev->resource[2]->start);\n\tif (err)\n\t\tgoto err_disable;\n\tdev->priv = ssb;\n\n\treturn 0;\n\nerr_disable:\n\tpcmcia_disable_device(dev);\nerr_kfree_ssb:\n\tkfree(ssb);\nout_error:\n\tdev_err(&dev->dev, \"Initialization failed (%d, %d)\\n\", res, err);\n\treturn err;\n}\n\nstatic void ssb_host_pcmcia_remove(struct pcmcia_device *dev)\n{\n\tstruct ssb_bus *ssb = dev->priv;\n\n\tssb_bus_unregister(ssb);\n\tpcmcia_disable_device(dev);\n\tkfree(ssb);\n\tdev->priv = NULL;\n}\n\n#ifdef CONFIG_PM\nstatic int ssb_host_pcmcia_suspend(struct pcmcia_device *dev)\n{\n\tstruct ssb_bus *ssb = dev->priv;\n\n\treturn ssb_bus_suspend(ssb);\n}\n\nstatic int ssb_host_pcmcia_resume(struct pcmcia_device *dev)\n{\n\tstruct ssb_bus *ssb = dev->priv;\n\n\treturn ssb_bus_resume(ssb);\n}\n#else  \n# define ssb_host_pcmcia_suspend\t\tNULL\n# define ssb_host_pcmcia_resume\t\tNULL\n#endif  \n\nstatic struct pcmcia_driver ssb_host_pcmcia_driver = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"ssb-pcmcia\",\n\t.id_table\t= ssb_host_pcmcia_tbl,\n\t.probe\t\t= ssb_host_pcmcia_probe,\n\t.remove\t\t= ssb_host_pcmcia_remove,\n\t.suspend\t= ssb_host_pcmcia_suspend,\n\t.resume\t\t= ssb_host_pcmcia_resume,\n};\n\nstatic int pcmcia_init_failed;\n\n \nint ssb_host_pcmcia_init(void)\n{\n\tpcmcia_init_failed = pcmcia_register_driver(&ssb_host_pcmcia_driver);\n\n\treturn pcmcia_init_failed;\n}\n\nvoid ssb_host_pcmcia_exit(void)\n{\n\tif (!pcmcia_init_failed)\n\t\tpcmcia_unregister_driver(&ssb_host_pcmcia_driver);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}