{
  "module_name": "fit2.c",
  "hash_id": "92cb94387ea29a07a3facd425b51246882e0e29d8c4591805f1c30b04758ef23",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ata/pata_parport/fit2.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n#include <linux/wait.h>\n#include <asm/io.h>\n#include \"pata_parport.h\"\n\n#define j44(a, b)\t(((a >> 4) & 0x0f) | (b & 0xf0))\n\n \n\nstatic void fit2_write_regr(struct pi_adapter *pi, int cont, int regr, int val)\n{\n\tif (cont == 1)\n\t\treturn;\n\tw2(0xc); w0(regr); w2(4); w0(val); w2(5); w0(0); w2(4);\n}\n\nstatic int fit2_read_regr(struct pi_adapter *pi, int cont, int regr)\n{\n\tint  a, b, r;\n\n\tif (cont) {\n\t\tif (regr != 6)\n\t\t\treturn 0xff;\n\t\tr = 7;\n\t} else {\n\t\tr = regr + 0x10;\n\t}\n\n\tw2(0xc); w0(r); w2(4); w2(5);\n\tw0(0); a = r1();\n\tw0(1); b = r1();\n\tw2(4);\n\n\treturn j44(a, b);\n}\n\nstatic void fit2_read_block(struct pi_adapter *pi, char *buf, int count)\n{\n\tint  k, a, b, c, d;\n\n\tw2(0xc); w0(0x10);\n\n\tfor (k = 0; k < count / 4; k++) {\n\t\tw2(4); w2(5);\n\t\tw0(0); a = r1(); w0(1); b = r1();\n\t\tw0(3); c = r1(); w0(2); d = r1();\n\t\tbuf[4 * k + 0] = j44(a, b);\n\t\tbuf[4 * k + 1] = j44(d, c);\n\n\t\tw2(4); w2(5);\n\t\ta = r1(); w0(3); b = r1();\n\t\tw0(1); c = r1(); w0(0); d = r1();\n\t\tbuf[4 * k + 2] = j44(d, c);\n\t\tbuf[4 * k + 3] = j44(a, b);\n\t}\n\n\tw2(4);\n}\n\nstatic void fit2_write_block(struct pi_adapter *pi, char *buf, int count)\n{\n\tint k;\n\n\tw2(0xc); w0(0);\n\tfor (k = 0; k < count / 2; k++) {\n\t\tw2(4); w0(buf[2 * k]);\n\t\tw2(5); w0(buf[2 * k + 1]);\n\t}\n\tw2(4);\n}\n\nstatic void fit2_connect(struct pi_adapter *pi)\n{\n\tpi->saved_r0 = r0();\n\tpi->saved_r2 = r2();\n\tw2(0xcc);\n}\n\nstatic void fit2_disconnect(struct pi_adapter *pi)\n{\n\tw0(pi->saved_r0);\n\tw2(pi->saved_r2);\n}\n\nstatic void fit2_log_adapter(struct pi_adapter *pi)\n{\n\tdev_info(&pi->dev, \"FIT 2000 adapter at 0x%x, delay %d\\n\",\n\t\t pi->port, pi->delay);\n\n}\n\nstatic struct pi_protocol fit2 = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"fit2\",\n\t.max_mode\t= 1,\n\t.epp_first\t= 2,\n\t.default_delay\t= 1,\n\t.max_units\t= 1,\n\t.write_regr\t= fit2_write_regr,\n\t.read_regr\t= fit2_read_regr,\n\t.write_block\t= fit2_write_block,\n\t.read_block\t= fit2_read_block,\n\t.connect\t= fit2_connect,\n\t.disconnect\t= fit2_disconnect,\n\t.log_adapter\t= fit2_log_adapter,\n};\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Grant R. Guenther <grant@torque.net>\");\nMODULE_DESCRIPTION(\"Fidelity International Technology parallel port IDE adapter\"\n\t\t   \"(older models) protocol driver\");\nmodule_pata_parport_driver(fit2);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}