{
  "module_name": "reset-axs10x.c",
  "hash_id": "122f0f3c8fe7106af681f598b69cafb67aaeabc68f36f3d1f7b0a0b659b480c5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/reset/reset-axs10x.c",
  "human_readable_source": " \n\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/platform_device.h>\n#include <linux/reset-controller.h>\n\n#define to_axs10x_rst(p)\tcontainer_of((p), struct axs10x_rst, rcdev)\n\n#define AXS10X_MAX_RESETS\t32\n\nstruct axs10x_rst {\n\tvoid __iomem\t\t\t*regs_rst;\n\tspinlock_t\t\t\tlock;\n\tstruct reset_controller_dev\trcdev;\n};\n\nstatic int axs10x_reset_reset(struct reset_controller_dev *rcdev,\n\t\t\t      unsigned long id)\n{\n\tstruct axs10x_rst *rst = to_axs10x_rst(rcdev);\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&rst->lock, flags);\n\twritel(BIT(id), rst->regs_rst);\n\tspin_unlock_irqrestore(&rst->lock, flags);\n\n\treturn 0;\n}\n\nstatic const struct reset_control_ops axs10x_reset_ops = {\n\t.reset\t= axs10x_reset_reset,\n};\n\nstatic int axs10x_reset_probe(struct platform_device *pdev)\n{\n\tstruct axs10x_rst *rst;\n\n\trst = devm_kzalloc(&pdev->dev, sizeof(*rst), GFP_KERNEL);\n\tif (!rst)\n\t\treturn -ENOMEM;\n\n\trst->regs_rst = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(rst->regs_rst))\n\t\treturn PTR_ERR(rst->regs_rst);\n\n\tspin_lock_init(&rst->lock);\n\n\trst->rcdev.owner = THIS_MODULE;\n\trst->rcdev.ops = &axs10x_reset_ops;\n\trst->rcdev.of_node = pdev->dev.of_node;\n\trst->rcdev.nr_resets = AXS10X_MAX_RESETS;\n\n\treturn devm_reset_controller_register(&pdev->dev, &rst->rcdev);\n}\n\nstatic const struct of_device_id axs10x_reset_dt_match[] = {\n\t{ .compatible = \"snps,axs10x-reset\" },\n\t{ },\n};\n\nstatic struct platform_driver axs10x_reset_driver = {\n\t.probe\t= axs10x_reset_probe,\n\t.driver\t= {\n\t\t.name = \"axs10x-reset\",\n\t\t.of_match_table = axs10x_reset_dt_match,\n\t},\n};\nbuiltin_platform_driver(axs10x_reset_driver);\n\nMODULE_AUTHOR(\"Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>\");\nMODULE_DESCRIPTION(\"Synopsys AXS10x reset driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}