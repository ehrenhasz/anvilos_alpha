{
  "module_name": "tb_msgs.h",
  "hash_id": "9c1987cc8c803c593d2b37f474bc925627b882635a0c4bb4a0ac1e7f1a103e08",
  "original_prompt": "Ingested from linux-6.6.14/drivers/thunderbolt/tb_msgs.h",
  "human_readable_source": " \n \n\n#ifndef _TB_MSGS\n#define _TB_MSGS\n\n#include <linux/types.h>\n#include <linux/uuid.h>\n\nenum tb_cfg_space {\n\tTB_CFG_HOPS = 0,\n\tTB_CFG_PORT = 1,\n\tTB_CFG_SWITCH = 2,\n\tTB_CFG_COUNTERS = 3,\n};\n\nenum tb_cfg_error {\n\tTB_CFG_ERROR_PORT_NOT_CONNECTED = 0,\n\tTB_CFG_ERROR_LINK_ERROR = 1,\n\tTB_CFG_ERROR_INVALID_CONFIG_SPACE = 2,\n\tTB_CFG_ERROR_NO_SUCH_PORT = 4,\n\tTB_CFG_ERROR_ACK_PLUG_EVENT = 7,  \n\tTB_CFG_ERROR_LOOP = 8,\n\tTB_CFG_ERROR_HEC_ERROR_DETECTED = 12,\n\tTB_CFG_ERROR_FLOW_CONTROL_ERROR = 13,\n\tTB_CFG_ERROR_LOCK = 15,\n\tTB_CFG_ERROR_DP_BW = 32,\n\tTB_CFG_ERROR_ROP_CMPLT = 33,\n\tTB_CFG_ERROR_POP_CMPLT = 34,\n\tTB_CFG_ERROR_PCIE_WAKE = 35,\n\tTB_CFG_ERROR_DP_CON_CHANGE = 36,\n\tTB_CFG_ERROR_DPTX_DISCOVERY = 37,\n\tTB_CFG_ERROR_LINK_RECOVERY = 38,\n\tTB_CFG_ERROR_ASYM_LINK = 39,\n};\n\n \nstruct tb_cfg_header {\n\tu32 route_hi:22;\n\tu32 unknown:10;  \n\tu32 route_lo;\n} __packed;\n\n \nstruct tb_cfg_address {\n\tu32 offset:13;  \n\tu32 length:6;  \n\tu32 port:6;\n\tenum tb_cfg_space space:2;\n\tu32 seq:2;  \n\tu32 zero:3;\n} __packed;\n\n \nstruct cfg_read_pkg {\n\tstruct tb_cfg_header header;\n\tstruct tb_cfg_address addr;\n} __packed;\n\n \nstruct cfg_write_pkg {\n\tstruct tb_cfg_header header;\n\tstruct tb_cfg_address addr;\n\tu32 data[64];  \n} __packed;\n\n \nstruct cfg_error_pkg {\n\tstruct tb_cfg_header header;\n\tenum tb_cfg_error error:8;\n\tu32 port:6;\n\tu32 reserved:16;\n\tu32 pg:2;\n} __packed;\n\nstruct cfg_ack_pkg {\n\tstruct tb_cfg_header header;\n};\n\n#define TB_CFG_ERROR_PG_HOT_PLUG\t0x2\n#define TB_CFG_ERROR_PG_HOT_UNPLUG\t0x3\n\n \nstruct cfg_event_pkg {\n\tstruct tb_cfg_header header;\n\tu32 port:6;\n\tu32 zero:25;\n\tbool unplug:1;\n} __packed;\n\n \nstruct cfg_reset_pkg {\n\tstruct tb_cfg_header header;\n} __packed;\n\n \nstruct cfg_pts_pkg {\n\tstruct tb_cfg_header header;\n\tu32 data;\n} __packed;\n\n \n\nenum icm_pkg_code {\n\tICM_GET_TOPOLOGY = 0x1,\n\tICM_DRIVER_READY = 0x3,\n\tICM_APPROVE_DEVICE = 0x4,\n\tICM_CHALLENGE_DEVICE = 0x5,\n\tICM_ADD_DEVICE_KEY = 0x6,\n\tICM_GET_ROUTE = 0xa,\n\tICM_APPROVE_XDOMAIN = 0x10,\n\tICM_DISCONNECT_XDOMAIN = 0x11,\n\tICM_PREBOOT_ACL = 0x18,\n\tICM_USB4_SWITCH_OP = 0x20,\n};\n\nenum icm_event_code {\n\tICM_EVENT_DEVICE_CONNECTED = 0x3,\n\tICM_EVENT_DEVICE_DISCONNECTED = 0x4,\n\tICM_EVENT_XDOMAIN_CONNECTED = 0x6,\n\tICM_EVENT_XDOMAIN_DISCONNECTED = 0x7,\n\tICM_EVENT_RTD3_VETO = 0xa,\n};\n\nstruct icm_pkg_header {\n\tu8 code;\n\tu8 flags;\n\tu8 packet_id;\n\tu8 total_packets;\n};\n\n#define ICM_FLAGS_ERROR\t\t\tBIT(0)\n#define ICM_FLAGS_NO_KEY\t\tBIT(1)\n#define ICM_FLAGS_SLEVEL_SHIFT\t\t3\n#define ICM_FLAGS_SLEVEL_MASK\t\tGENMASK(4, 3)\n#define ICM_FLAGS_DUAL_LANE\t\tBIT(5)\n#define ICM_FLAGS_SPEED_GEN3\t\tBIT(7)\n#define ICM_FLAGS_WRITE\t\t\tBIT(7)\n\nstruct icm_pkg_driver_ready {\n\tstruct icm_pkg_header hdr;\n};\n\n \n\nstruct icm_fr_pkg_driver_ready_response {\n\tstruct icm_pkg_header hdr;\n\tu8 romver;\n\tu8 ramver;\n\tu16 security_level;\n};\n\n#define ICM_FR_SLEVEL_MASK\t\t0xf\n\n \n\nstruct icm_fr_pkg_get_topology {\n\tstruct icm_pkg_header hdr;\n};\n\n#define ICM_GET_TOPOLOGY_PACKETS\t14\n\nstruct icm_fr_pkg_get_topology_response {\n\tstruct icm_pkg_header hdr;\n\tu32 route_lo;\n\tu32 route_hi;\n\tu8 first_data;\n\tu8 second_data;\n\tu8 drom_i2c_address_index;\n\tu8 switch_index;\n\tu32 reserved[2];\n\tu32 ports[16];\n\tu32 port_hop_info[16];\n};\n\n#define ICM_SWITCH_USED\t\t\tBIT(0)\n#define ICM_SWITCH_UPSTREAM_PORT_MASK\tGENMASK(7, 1)\n#define ICM_SWITCH_UPSTREAM_PORT_SHIFT\t1\n\n#define ICM_PORT_TYPE_MASK\t\tGENMASK(23, 0)\n#define ICM_PORT_INDEX_SHIFT\t\t24\n#define ICM_PORT_INDEX_MASK\t\tGENMASK(31, 24)\n\nstruct icm_fr_event_device_connected {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 link_info;\n\tu32 ep_name[55];\n};\n\n#define ICM_LINK_INFO_LINK_MASK\t\t0x7\n#define ICM_LINK_INFO_DEPTH_SHIFT\t4\n#define ICM_LINK_INFO_DEPTH_MASK\tGENMASK(7, 4)\n#define ICM_LINK_INFO_APPROVED\t\tBIT(8)\n#define ICM_LINK_INFO_REJECTED\t\tBIT(9)\n#define ICM_LINK_INFO_BOOT\t\tBIT(10)\n\nstruct icm_fr_pkg_approve_device {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 reserved;\n};\n\nstruct icm_fr_event_device_disconnected {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n};\n\nstruct icm_fr_event_xdomain_connected {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tuuid_t remote_uuid;\n\tuuid_t local_uuid;\n\tu32 local_route_hi;\n\tu32 local_route_lo;\n\tu32 remote_route_hi;\n\tu32 remote_route_lo;\n};\n\nstruct icm_fr_event_xdomain_disconnected {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tuuid_t remote_uuid;\n};\n\nstruct icm_fr_pkg_add_device_key {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 reserved;\n\tu32 key[8];\n};\n\nstruct icm_fr_pkg_add_device_key_response {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 reserved;\n};\n\nstruct icm_fr_pkg_challenge_device {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 reserved;\n\tu32 challenge[8];\n};\n\nstruct icm_fr_pkg_challenge_device_response {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu8 connection_key;\n\tu8 connection_id;\n\tu16 reserved;\n\tu32 challenge[8];\n\tu32 response[8];\n};\n\nstruct icm_fr_pkg_approve_xdomain {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tuuid_t remote_uuid;\n\tu16 transmit_path;\n\tu16 transmit_ring;\n\tu16 receive_path;\n\tu16 receive_ring;\n};\n\nstruct icm_fr_pkg_approve_xdomain_response {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tuuid_t remote_uuid;\n\tu16 transmit_path;\n\tu16 transmit_ring;\n\tu16 receive_path;\n\tu16 receive_ring;\n};\n\n \n\nstruct icm_ar_pkg_driver_ready_response {\n\tstruct icm_pkg_header hdr;\n\tu8 romver;\n\tu8 ramver;\n\tu16 info;\n};\n\n#define ICM_AR_FLAGS_RTD3\t\tBIT(6)\n\n#define ICM_AR_INFO_SLEVEL_MASK\t\tGENMASK(3, 0)\n#define ICM_AR_INFO_BOOT_ACL_SHIFT\t7\n#define ICM_AR_INFO_BOOT_ACL_MASK\tGENMASK(11, 7)\n#define ICM_AR_INFO_BOOT_ACL_SUPPORTED\tBIT(13)\n\nstruct icm_ar_pkg_get_route {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n};\n\nstruct icm_ar_pkg_get_route_response {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tu32 route_hi;\n\tu32 route_lo;\n};\n\nstruct icm_ar_boot_acl_entry {\n\tu32 uuid_lo;\n\tu32 uuid_hi;\n};\n\n#define ICM_AR_PREBOOT_ACL_ENTRIES\t16\n\nstruct icm_ar_pkg_preboot_acl {\n\tstruct icm_pkg_header hdr;\n\tstruct icm_ar_boot_acl_entry acl[ICM_AR_PREBOOT_ACL_ENTRIES];\n};\n\nstruct icm_ar_pkg_preboot_acl_response {\n\tstruct icm_pkg_header hdr;\n\tstruct icm_ar_boot_acl_entry acl[ICM_AR_PREBOOT_ACL_ENTRIES];\n};\n\n \n\nstruct icm_tr_pkg_driver_ready_response {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved1;\n\tu16 info;\n\tu32 nvm_version;\n\tu16 device_id;\n\tu16 reserved2;\n};\n\n#define ICM_TR_FLAGS_RTD3\t\tBIT(6)\n\n#define ICM_TR_INFO_SLEVEL_MASK\t\tGENMASK(2, 0)\n#define ICM_TR_INFO_PROTO_VERSION_MASK\tGENMASK(6, 4)\n#define ICM_TR_INFO_PROTO_VERSION_SHIFT\t4\n#define ICM_TR_INFO_BOOT_ACL_SHIFT\t7\n#define ICM_TR_INFO_BOOT_ACL_MASK\tGENMASK(12, 7)\n\nstruct icm_tr_event_device_connected {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved;\n\tu16 link_info;\n\tu32 ep_name[55];\n};\n\nstruct icm_tr_event_device_disconnected {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n};\n\nstruct icm_tr_event_xdomain_connected {\n\tstruct icm_pkg_header hdr;\n\tu16 reserved;\n\tu16 link_info;\n\tuuid_t remote_uuid;\n\tuuid_t local_uuid;\n\tu32 local_route_hi;\n\tu32 local_route_lo;\n\tu32 remote_route_hi;\n\tu32 remote_route_lo;\n};\n\nstruct icm_tr_event_xdomain_disconnected {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n\tuuid_t remote_uuid;\n};\n\nstruct icm_tr_pkg_approve_device {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved1[3];\n};\n\nstruct icm_tr_pkg_add_device_key {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved[3];\n\tu32 key[8];\n};\n\nstruct icm_tr_pkg_challenge_device {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved[3];\n\tu32 challenge[8];\n};\n\nstruct icm_tr_pkg_approve_xdomain {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n\tuuid_t remote_uuid;\n\tu16 transmit_path;\n\tu16 transmit_ring;\n\tu16 receive_path;\n\tu16 receive_ring;\n};\n\nstruct icm_tr_pkg_disconnect_xdomain {\n\tstruct icm_pkg_header hdr;\n\tu8 stage;\n\tu8 reserved[3];\n\tu32 route_hi;\n\tu32 route_lo;\n\tuuid_t remote_uuid;\n};\n\nstruct icm_tr_pkg_challenge_device_response {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved[3];\n\tu32 challenge[8];\n\tu32 response[8];\n};\n\nstruct icm_tr_pkg_add_device_key_response {\n\tstruct icm_pkg_header hdr;\n\tuuid_t ep_uuid;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu8 connection_id;\n\tu8 reserved[3];\n};\n\nstruct icm_tr_pkg_approve_xdomain_response {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n\tuuid_t remote_uuid;\n\tu16 transmit_path;\n\tu16 transmit_ring;\n\tu16 receive_path;\n\tu16 receive_ring;\n};\n\nstruct icm_tr_pkg_disconnect_xdomain_response {\n\tstruct icm_pkg_header hdr;\n\tu8 stage;\n\tu8 reserved[3];\n\tu32 route_hi;\n\tu32 route_lo;\n\tuuid_t remote_uuid;\n};\n\n \n\nstruct icm_icl_event_rtd3_veto {\n\tstruct icm_pkg_header hdr;\n\tu32 veto_reason;\n};\n\n \n\nstruct icm_usb4_switch_op {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu32 metadata;\n\tu16 opcode;\n\tu16 data_len_valid;\n\tu32 data[16];\n};\n\n#define ICM_USB4_SWITCH_DATA_LEN_MASK\tGENMASK(3, 0)\n#define ICM_USB4_SWITCH_DATA_VALID\tBIT(4)\n\nstruct icm_usb4_switch_op_response {\n\tstruct icm_pkg_header hdr;\n\tu32 route_hi;\n\tu32 route_lo;\n\tu32 metadata;\n\tu16 opcode;\n\tu16 status;\n\tu32 data[16];\n};\n\n \n\nstruct tb_xdomain_header {\n\tu32 route_hi;\n\tu32 route_lo;\n\tu32 length_sn;\n};\n\n#define TB_XDOMAIN_LENGTH_MASK\tGENMASK(5, 0)\n#define TB_XDOMAIN_SN_MASK\tGENMASK(28, 27)\n#define TB_XDOMAIN_SN_SHIFT\t27\n\nenum tb_xdp_type {\n\tUUID_REQUEST_OLD = 1,\n\tUUID_RESPONSE = 2,\n\tPROPERTIES_REQUEST,\n\tPROPERTIES_RESPONSE,\n\tPROPERTIES_CHANGED_REQUEST,\n\tPROPERTIES_CHANGED_RESPONSE,\n\tERROR_RESPONSE,\n\tUUID_REQUEST = 12,\n\tLINK_STATE_STATUS_REQUEST = 15,\n\tLINK_STATE_STATUS_RESPONSE,\n\tLINK_STATE_CHANGE_REQUEST,\n\tLINK_STATE_CHANGE_RESPONSE,\n};\n\nstruct tb_xdp_header {\n\tstruct tb_xdomain_header xd_hdr;\n\tuuid_t uuid;\n\tu32 type;\n};\n\nstruct tb_xdp_error_response {\n\tstruct tb_xdp_header hdr;\n\tu32 error;\n};\n\nstruct tb_xdp_link_state_status {\n\tstruct tb_xdp_header hdr;\n};\n\nstruct tb_xdp_link_state_status_response {\n\tunion {\n\t\tstruct tb_xdp_error_response err;\n\t\tstruct {\n\t\t\tstruct tb_xdp_header hdr;\n\t\t\tu32 status;\n\t\t\tu8 slw;\n\t\t\tu8 tlw;\n\t\t\tu8 sls;\n\t\t\tu8 tls;\n\t\t};\n\t};\n};\n\nstruct tb_xdp_link_state_change {\n\tstruct tb_xdp_header hdr;\n\tu8 tlw;\n\tu8 tls;\n\tu16 reserved;\n};\n\nstruct tb_xdp_link_state_change_response {\n\tunion {\n\t\tstruct tb_xdp_error_response err;\n\t\tstruct {\n\t\t\tstruct tb_xdp_header hdr;\n\t\t\tu32 status;\n\t\t};\n\t};\n};\n\nstruct tb_xdp_uuid {\n\tstruct tb_xdp_header hdr;\n};\n\nstruct tb_xdp_uuid_response {\n\tunion {\n\t\tstruct tb_xdp_error_response err;\n\t\tstruct {\n\t\t\tstruct tb_xdp_header hdr;\n\t\t\tuuid_t src_uuid;\n\t\t\tu32 src_route_hi;\n\t\t\tu32 src_route_lo;\n\t\t};\n\t};\n};\n\nstruct tb_xdp_properties {\n\tstruct tb_xdp_header hdr;\n\tuuid_t src_uuid;\n\tuuid_t dst_uuid;\n\tu16 offset;\n\tu16 reserved;\n};\n\nstruct tb_xdp_properties_response {\n\tunion {\n\t\tstruct tb_xdp_error_response err;\n\t\tstruct {\n\t\t\tstruct tb_xdp_header hdr;\n\t\t\tuuid_t src_uuid;\n\t\t\tuuid_t dst_uuid;\n\t\t\tu16 offset;\n\t\t\tu16 data_length;\n\t\t\tu32 generation;\n\t\t\tu32 data[];\n\t\t};\n\t};\n};\n\n \n#define TB_XDP_PROPERTIES_MAX_DATA_LENGTH\t\\\n\t(((256 - 4 - sizeof(struct tb_xdp_properties_response))) / 4)\n\n \n#define TB_XDP_PROPERTIES_MAX_LENGTH\t\t500\n\nstruct tb_xdp_properties_changed {\n\tstruct tb_xdp_header hdr;\n\tuuid_t src_uuid;\n};\n\nstruct tb_xdp_properties_changed_response {\n\tunion {\n\t\tstruct tb_xdp_error_response err;\n\t\tstruct tb_xdp_header hdr;\n\t};\n};\n\nenum tb_xdp_error {\n\tERROR_SUCCESS,\n\tERROR_UNKNOWN_PACKET,\n\tERROR_UNKNOWN_DOMAIN,\n\tERROR_NOT_SUPPORTED,\n\tERROR_NOT_READY,\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}