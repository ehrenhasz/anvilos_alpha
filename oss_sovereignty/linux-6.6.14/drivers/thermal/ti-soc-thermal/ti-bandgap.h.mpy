{
  "module_name": "ti-bandgap.h",
  "hash_id": "da7ce3958a34ef6a9c95b41a38f8b30f093fbbbd722fcb0c3cf7959cc32fac42",
  "original_prompt": "Ingested from linux-6.6.14/drivers/thermal/ti-soc-thermal/ti-bandgap.h",
  "human_readable_source": " \n \n#ifndef __TI_BANDGAP_H\n#define __TI_BANDGAP_H\n\n#include <linux/spinlock.h>\n#include <linux/types.h>\n#include <linux/err.h>\n#include <linux/cpu_pm.h>\n#include <linux/device.h>\n#include <linux/pm_runtime.h>\n#include <linux/pm.h>\n\nstruct gpio_desc;\n\n \n\n \n\nstruct temp_sensor_registers {\n\tu32\ttemp_sensor_ctrl;\n\tu32\tbgap_tempsoff_mask;\n\tu32\tbgap_soc_mask;\n\tu32\tbgap_eocz_mask;\n\tu32\tbgap_dtemp_mask;\n\n\tu32\tbgap_mask_ctrl;\n\tu32\tmask_hot_mask;\n\tu32\tmask_cold_mask;\n\tu32\tmask_counter_delay_mask;\n\tu32\tmask_freeze_mask;\n\n\tu32\tbgap_mode_ctrl;\n\tu32\tmode_ctrl_mask;\n\n\tu32\tbgap_counter;\n\tu32\tcounter_mask;\n\n\tu32\tbgap_threshold;\n\tu32\tthreshold_thot_mask;\n\tu32\tthreshold_tcold_mask;\n\n\tu32\ttshut_threshold;\n\tu32\ttshut_hot_mask;\n\tu32\ttshut_cold_mask;\n\n\tu32\tbgap_status;\n\tu32\tstatus_hot_mask;\n\tu32\tstatus_cold_mask;\n\n\tu32\tctrl_dtemp_1;\n\tu32\tctrl_dtemp_2;\n\tu32\tbgap_efuse;\n};\n\n \nstruct temp_sensor_data {\n\tu32\ttshut_hot;\n\tu32\ttshut_cold;\n\tu32\tt_hot;\n\tu32\tt_cold;\n\tu32\tmin_freq;\n\tu32\tmax_freq;\n};\n\nstruct ti_bandgap_data;\n\n \nstruct temp_sensor_regval {\n\tu32\t\t\tbg_mode_ctrl;\n\tu32\t\t\tbg_ctrl;\n\tu32\t\t\tbg_counter;\n\tu32\t\t\tbg_threshold;\n\tu32\t\t\ttshut_threshold;\n\tvoid\t\t\t*data;\n};\n\n \nstruct ti_bandgap {\n\tstruct device\t\t\t*dev;\n\tvoid __iomem\t\t\t*base;\n\tconst struct ti_bandgap_data\t*conf;\n\tstruct temp_sensor_regval\t*regval;\n\tstruct clk\t\t\t*fclock;\n\tstruct clk\t\t\t*div_clk;\n\tspinlock_t\t\t\tlock;  \n\tint\t\t\t\tirq;\n\tstruct gpio_desc\t\t*tshut_gpiod;\n\tu32\t\t\t\tclk_rate;\n\tstruct notifier_block\t\tnb;\n\tunsigned int is_suspended:1;\n};\n\n \nstruct ti_temp_sensor {\n\tstruct temp_sensor_data\t\t*ts_data;\n\tstruct temp_sensor_registers\t*registers;\n\tchar\t\t\t\t*domain;\n\t \n\tconst int\t\t\tslope_pcb;\n\tconst int\t\t\tconstant_pcb;\n\tint (*register_cooling)(struct ti_bandgap *bgp, int id);\n\tint (*unregister_cooling)(struct ti_bandgap *bgp, int id);\n};\n\n \n#define TI_BANDGAP_FEATURE_TSHUT\t\tBIT(0)\n#define TI_BANDGAP_FEATURE_TSHUT_CONFIG\t\tBIT(1)\n#define TI_BANDGAP_FEATURE_TALERT\t\tBIT(2)\n#define TI_BANDGAP_FEATURE_MODE_CONFIG\t\tBIT(3)\n#define TI_BANDGAP_FEATURE_COUNTER\t\tBIT(4)\n#define TI_BANDGAP_FEATURE_POWER_SWITCH\t\tBIT(5)\n#define TI_BANDGAP_FEATURE_CLK_CTRL\t\tBIT(6)\n#define TI_BANDGAP_FEATURE_FREEZE_BIT\t\tBIT(7)\n#define TI_BANDGAP_FEATURE_COUNTER_DELAY\tBIT(8)\n#define TI_BANDGAP_FEATURE_HISTORY_BUFFER\tBIT(9)\n#define TI_BANDGAP_FEATURE_ERRATA_814\t\tBIT(10)\n#define TI_BANDGAP_FEATURE_UNRELIABLE\t\tBIT(11)\n#define TI_BANDGAP_FEATURE_CONT_MODE_ONLY\tBIT(12)\n#define TI_BANDGAP_HAS(b, f)\t\t\t\\\n\t\t\t((b)->conf->features & TI_BANDGAP_FEATURE_ ## f)\n\n \nstruct ti_bandgap_data {\n\tunsigned int\t\t\tfeatures;\n\tconst int\t\t\t*conv_table;\n\tu32\t\t\t\tadc_start_val;\n\tu32\t\t\t\tadc_end_val;\n\tchar\t\t\t\t*fclock_name;\n\tchar\t\t\t\t*div_ck_name;\n\tint\t\t\t\tsensor_count;\n\tint (*report_temperature)(struct ti_bandgap *bgp, int id);\n\tint (*expose_sensor)(struct ti_bandgap *bgp, int id, char *domain);\n\tint (*remove_sensor)(struct ti_bandgap *bgp, int id);\n\n\t \n\tstruct ti_temp_sensor\t\tsensors[];\n};\n\nint ti_bandgap_read_thot(struct ti_bandgap *bgp, int id, int *thot);\nint ti_bandgap_write_thot(struct ti_bandgap *bgp, int id, int val);\nint ti_bandgap_read_tcold(struct ti_bandgap *bgp, int id, int *tcold);\nint ti_bandgap_write_tcold(struct ti_bandgap *bgp, int id, int val);\nint ti_bandgap_read_update_interval(struct ti_bandgap *bgp, int id,\n\t\t\t\t    int *interval);\nint ti_bandgap_write_update_interval(struct ti_bandgap *bgp, int id,\n\t\t\t\t     u32 interval);\nint ti_bandgap_read_temperature(struct ti_bandgap *bgp, int id,\n\t\t\t\t  int *temperature);\nint ti_bandgap_set_sensor_data(struct ti_bandgap *bgp, int id, void *data);\nvoid *ti_bandgap_get_sensor_data(struct ti_bandgap *bgp, int id);\nint ti_bandgap_get_trend(struct ti_bandgap *bgp, int id, int *trend);\n\n#ifdef CONFIG_OMAP3_THERMAL\nextern const struct ti_bandgap_data omap34xx_data;\nextern const struct ti_bandgap_data omap36xx_data;\n#else\n#define omap34xx_data\t\t\t\t\tNULL\n#define omap36xx_data\t\t\t\t\tNULL\n#endif\n\n#ifdef CONFIG_OMAP4_THERMAL\nextern const struct ti_bandgap_data omap4430_data;\nextern const struct ti_bandgap_data omap4460_data;\nextern const struct ti_bandgap_data omap4470_data;\n#else\n#define omap4430_data\t\t\t\t\tNULL\n#define omap4460_data\t\t\t\t\tNULL\n#define omap4470_data\t\t\t\t\tNULL\n#endif\n\n#ifdef CONFIG_OMAP5_THERMAL\nextern const struct ti_bandgap_data omap5430_data;\n#else\n#define omap5430_data\t\t\t\t\tNULL\n#endif\n\n#ifdef CONFIG_DRA752_THERMAL\nextern const struct ti_bandgap_data dra752_data;\n#else\n#define dra752_data\t\t\t\t\tNULL\n#endif\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}