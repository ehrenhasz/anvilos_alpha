{
  "module_name": "tsens-v2.c",
  "hash_id": "420251c22e173d5751dbc112128030bf0481e736c555e25c0d89b90fb897a9a8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/thermal/qcom/tsens-v2.c",
  "human_readable_source": "\n \n\n#include <linux/bitops.h>\n#include <linux/regmap.h>\n#include \"tsens.h\"\n\n \n#define SROT_HW_VER_OFF\t0x0000\n#define SROT_CTRL_OFF\t\t0x0004\n\n \n#define TM_INT_EN_OFF\t\t\t0x0004\n#define TM_UPPER_LOWER_INT_STATUS_OFF\t0x0008\n#define TM_UPPER_LOWER_INT_CLEAR_OFF\t0x000c\n#define TM_UPPER_LOWER_INT_MASK_OFF\t0x0010\n#define TM_CRITICAL_INT_STATUS_OFF\t0x0014\n#define TM_CRITICAL_INT_CLEAR_OFF\t0x0018\n#define TM_CRITICAL_INT_MASK_OFF\t0x001c\n#define TM_Sn_UPPER_LOWER_THRESHOLD_OFF 0x0020\n#define TM_Sn_CRITICAL_THRESHOLD_OFF\t0x0060\n#define TM_Sn_STATUS_OFF\t\t0x00a0\n#define TM_TRDY_OFF\t\t\t0x00e4\n#define TM_WDOG_LOG_OFF\t\t0x013c\n\n \n\nstatic struct tsens_features tsens_v2_feat = {\n\t.ver_major\t= VER_2_X,\n\t.crit_int\t= 1,\n\t.combo_int\t= 0,\n\t.adc\t\t= 0,\n\t.srot_split\t= 1,\n\t.max_sensors\t= 16,\n\t.trip_min_temp\t= -40000,\n\t.trip_max_temp\t= 120000,\n};\n\nstatic struct tsens_features ipq8074_feat = {\n\t.ver_major\t= VER_2_X,\n\t.crit_int\t= 1,\n\t.combo_int\t= 1,\n\t.adc\t\t= 0,\n\t.srot_split\t= 1,\n\t.max_sensors\t= 16,\n\t.trip_min_temp\t= 0,\n\t.trip_max_temp\t= 204000,\n};\n\nstatic const struct reg_field tsens_v2_regfields[MAX_REGFIELDS] = {\n\t \n\t \n\t[VER_MAJOR] = REG_FIELD(SROT_HW_VER_OFF, 28, 31),\n\t[VER_MINOR] = REG_FIELD(SROT_HW_VER_OFF, 16, 27),\n\t[VER_STEP]  = REG_FIELD(SROT_HW_VER_OFF,  0, 15),\n\t \n\t[TSENS_EN]     = REG_FIELD(SROT_CTRL_OFF,    0,  0),\n\t[TSENS_SW_RST] = REG_FIELD(SROT_CTRL_OFF,    1,  1),\n\n\t \n\t \n\t \n\t[INT_EN]  = REG_FIELD(TM_INT_EN_OFF, 0, 2),\n\n\t \n\tREG_FIELD_FOR_EACH_SENSOR16(LOW_THRESH,  TM_Sn_UPPER_LOWER_THRESHOLD_OFF,  0,  11),\n\tREG_FIELD_FOR_EACH_SENSOR16(UP_THRESH,   TM_Sn_UPPER_LOWER_THRESHOLD_OFF, 12,  23),\n\tREG_FIELD_FOR_EACH_SENSOR16(CRIT_THRESH, TM_Sn_CRITICAL_THRESHOLD_OFF,     0,  11),\n\n\t \n\tREG_FIELD_SPLIT_BITS_0_15(LOW_INT_STATUS,  TM_UPPER_LOWER_INT_STATUS_OFF),\n\tREG_FIELD_SPLIT_BITS_0_15(LOW_INT_CLEAR,   TM_UPPER_LOWER_INT_CLEAR_OFF),\n\tREG_FIELD_SPLIT_BITS_0_15(LOW_INT_MASK,    TM_UPPER_LOWER_INT_MASK_OFF),\n\tREG_FIELD_SPLIT_BITS_16_31(UP_INT_STATUS,  TM_UPPER_LOWER_INT_STATUS_OFF),\n\tREG_FIELD_SPLIT_BITS_16_31(UP_INT_CLEAR,   TM_UPPER_LOWER_INT_CLEAR_OFF),\n\tREG_FIELD_SPLIT_BITS_16_31(UP_INT_MASK,    TM_UPPER_LOWER_INT_MASK_OFF),\n\tREG_FIELD_SPLIT_BITS_0_15(CRIT_INT_STATUS, TM_CRITICAL_INT_STATUS_OFF),\n\tREG_FIELD_SPLIT_BITS_0_15(CRIT_INT_CLEAR,  TM_CRITICAL_INT_CLEAR_OFF),\n\tREG_FIELD_SPLIT_BITS_0_15(CRIT_INT_MASK,   TM_CRITICAL_INT_MASK_OFF),\n\n\t \n\t[WDOG_BARK_STATUS] = REG_FIELD(TM_CRITICAL_INT_STATUS_OFF, 31, 31),\n\t[WDOG_BARK_CLEAR]  = REG_FIELD(TM_CRITICAL_INT_CLEAR_OFF,  31, 31),\n\t[WDOG_BARK_MASK]   = REG_FIELD(TM_CRITICAL_INT_MASK_OFF,   31, 31),\n\t[CC_MON_STATUS]    = REG_FIELD(TM_CRITICAL_INT_STATUS_OFF, 30, 30),\n\t[CC_MON_CLEAR]     = REG_FIELD(TM_CRITICAL_INT_CLEAR_OFF,  30, 30),\n\t[CC_MON_MASK]      = REG_FIELD(TM_CRITICAL_INT_MASK_OFF,   30, 30),\n\t[WDOG_BARK_COUNT]  = REG_FIELD(TM_WDOG_LOG_OFF,             0,  7),\n\n\t \n\tREG_FIELD_FOR_EACH_SENSOR16(LAST_TEMP,       TM_Sn_STATUS_OFF,  0,  11),\n\tREG_FIELD_FOR_EACH_SENSOR16(VALID,           TM_Sn_STATUS_OFF, 21,  21),\n\t \n\tREG_FIELD_FOR_EACH_SENSOR16(MIN_STATUS,      TM_Sn_STATUS_OFF, 16,  16),\n\tREG_FIELD_FOR_EACH_SENSOR16(LOWER_STATUS,    TM_Sn_STATUS_OFF, 17,  17),\n\tREG_FIELD_FOR_EACH_SENSOR16(UPPER_STATUS,    TM_Sn_STATUS_OFF, 18,  18),\n\tREG_FIELD_FOR_EACH_SENSOR16(CRITICAL_STATUS, TM_Sn_STATUS_OFF, 19,  19),\n\tREG_FIELD_FOR_EACH_SENSOR16(MAX_STATUS,      TM_Sn_STATUS_OFF, 20,  20),\n\n\t \n\t[TRDY] = REG_FIELD(TM_TRDY_OFF, 0, 0),\n};\n\nstatic const struct tsens_ops ops_generic_v2 = {\n\t.init\t\t= init_common,\n\t.get_temp\t= get_temp_tsens_valid,\n};\n\nstruct tsens_plat_data data_tsens_v2 = {\n\t.ops\t\t= &ops_generic_v2,\n\t.feat\t\t= &tsens_v2_feat,\n\t.fields\t= tsens_v2_regfields,\n};\n\nstruct tsens_plat_data data_ipq8074 = {\n\t.ops\t\t= &ops_generic_v2,\n\t.feat\t\t= &ipq8074_feat,\n\t.fields\t= tsens_v2_regfields,\n};\n\n \nstruct tsens_plat_data data_8996 = {\n\t.num_sensors\t= 13,\n\t.ops\t\t= &ops_generic_v2,\n\t.feat\t\t= &tsens_v2_feat,\n\t.fields\t= tsens_v2_regfields,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}