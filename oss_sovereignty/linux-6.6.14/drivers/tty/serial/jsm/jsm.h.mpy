{
  "module_name": "jsm.h",
  "hash_id": "ecfaf25e2fe940545bffbb7962137fae2d1d753bd798623de9fa751c191f90f9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tty/serial/jsm/jsm.h",
  "human_readable_source": " \n \n\n#ifndef __JSM_DRIVER_H\n#define __JSM_DRIVER_H\n\n#include <linux/kernel.h>\n#include <linux/types.h>\t \n#include <linux/tty.h>\n#include <linux/serial_core.h>\n#include <linux/device.h>\n\n \nenum {\n\tDBG_INIT\t= 0x01,\n\tDBG_BASIC\t= 0x02,\n\tDBG_CORE\t= 0x04,\n\tDBG_OPEN\t= 0x08,\n\tDBG_CLOSE\t= 0x10,\n\tDBG_READ\t= 0x20,\n\tDBG_WRITE\t= 0x40,\n\tDBG_IOCTL\t= 0x80,\n\tDBG_PROC\t= 0x100,\n\tDBG_PARAM\t= 0x200,\n\tDBG_PSCAN\t= 0x400,\n\tDBG_EVENT\t= 0x800,\n\tDBG_DRAIN\t= 0x1000,\n\tDBG_MSIGS\t= 0x2000,\n\tDBG_MGMT\t= 0x4000,\n\tDBG_INTR\t= 0x8000,\n\tDBG_CARR\t= 0x10000,\n};\n\n#define jsm_dbg(nlevel, pdev, fmt, ...)\t\t\t\t\\\ndo {\t\t\t\t\t\t\t\t\\\n\tif (DBG_##nlevel & jsm_debug)\t\t\t\t\\\n\t\tdev_dbg(pdev->dev, fmt, ##__VA_ARGS__);\t\t\\\n} while (0)\n\n#define\tMAXLINES\t256\n#define MAXPORTS\t8\n#define MAX_STOPS_SENT\t5\n\n \n#define PCI_DEVICE_ID_CLASSIC_4\t\t0x0028\n#define PCI_DEVICE_ID_CLASSIC_8\t\t0x0029\n#define PCI_DEVICE_ID_CLASSIC_4_422\t0x00D0\n#define PCI_DEVICE_ID_CLASSIC_8_422\t0x00D1\n#define PCI_DEVICE_ID_NEO_4             0x00B0\n#define PCI_DEVICE_ID_NEO_1_422         0x00CC\n#define PCI_DEVICE_ID_NEO_1_422_485     0x00CD\n#define PCI_DEVICE_ID_NEO_2_422_485     0x00CE\n#define PCIE_DEVICE_ID_NEO_8            0x00F0\n#define PCIE_DEVICE_ID_NEO_4            0x00F1\n#define PCIE_DEVICE_ID_NEO_4RJ45        0x00F2\n#define PCIE_DEVICE_ID_NEO_8RJ45        0x00F3\n\n \n\n#define T_NEO\t\t0000\n#define T_CLASSIC\t0001\n#define T_PCIBUS\t0400\n\n \n\n#define BD_RUNNING\t0x0\n#define BD_REASON\t0x7f\n#define BD_NOTFOUND\t0x1\n#define BD_NOIOPORT\t0x2\n#define BD_NOMEM\t0x3\n#define BD_NOBIOS\t0x4\n#define BD_NOFEP\t0x5\n#define BD_FAILED\t0x6\n#define BD_ALLOCATED\t0x7\n#define BD_TRIBOOT\t0x8\n#define BD_BADKME\t0x80\n\n\n \n#define WRITEBUFLEN\t((4096) + 4)\n\n#define JSM_VERSION\t\"jsm: 1.2-1-INKERNEL\"\n#define JSM_PARTNUM\t\"40002438_A-INKERNEL\"\n\nstruct jsm_board;\nstruct jsm_channel;\n\n \nstruct board_ops {\n\tirq_handler_t intr;\n\tvoid (*uart_init)(struct jsm_channel *ch);\n\tvoid (*uart_off)(struct jsm_channel *ch);\n\tvoid (*param)(struct jsm_channel *ch);\n\tvoid (*assert_modem_signals)(struct jsm_channel *ch);\n\tvoid (*flush_uart_write)(struct jsm_channel *ch);\n\tvoid (*flush_uart_read)(struct jsm_channel *ch);\n\tvoid (*disable_receiver)(struct jsm_channel *ch);\n\tvoid (*enable_receiver)(struct jsm_channel *ch);\n\tvoid (*send_break)(struct jsm_channel *ch);\n\tvoid (*clear_break)(struct jsm_channel *ch);\n\tvoid (*send_start_character)(struct jsm_channel *ch);\n\tvoid (*send_stop_character)(struct jsm_channel *ch);\n\tvoid (*copy_data_from_queue_to_uart)(struct jsm_channel *ch);\n\tu32 (*get_uart_bytes_left)(struct jsm_channel *ch);\n\tvoid (*send_immediate_char)(struct jsm_channel *ch, unsigned char);\n};\n\n\n \nstruct jsm_board\n{\n\tint\t\tboardnum;\t \n\n\tint\t\ttype;\t\t \n\tu8\t\trev;\t\t \n\tstruct pci_dev\t*pci_dev;\n\tu32\t\tmaxports;\t \n\n\tspinlock_t\tbd_intr_lock;\t \n\n\tu32\t\tnasync;\t\t \n\n\tu32\t\tirq;\t\t \n\n\tu64\t\tmembase;\t \n\tu64\t\tmembase_end;\t \n\n\tu8\t__iomem *re_map_membase; \n\n\tu64\t\tiobase;\t\t \n\tu64\t\tiobase_end;\t \n\n\tu32\t\tbd_uart_offset;\t \n\n\tstruct jsm_channel *channels[MAXPORTS];  \n\n\tu32\t\tbd_dividend;\t \n\n\tstruct board_ops *bd_ops;\n\n\tstruct list_head jsm_board_entry;\n};\n\n \n#define CH_PRON\t\t0x0001\t\t \n#define CH_STOP\t\t0x0002\t\t \n#define CH_STOPI\t0x0004\t\t \n#define CH_CD\t\t0x0008\t\t \n#define CH_FCAR\t\t0x0010\t\t \n#define CH_HANGUP\t0x0020\t\t \n\n#define CH_RECEIVER_OFF\t0x0040\t\t \n#define CH_OPENING\t0x0080\t\t \n#define CH_CLOSING\t0x0100\t\t \n#define CH_FIFO_ENABLED 0x0200\t\t \n#define CH_TX_FIFO_EMPTY 0x0400\t\t \n#define CH_TX_FIFO_LWM\t0x0800\t\t \n#define CH_BREAK_SENDING 0x1000\t\t \n#define CH_LOOPBACK 0x2000\t\t \n#define CH_BAUD0\t0x08000\t\t \n\n \n#define RQUEUEMASK\t0x1FFF\t\t \n#define EQUEUEMASK\t0x1FFF\t\t \n#define RQUEUESIZE\t(RQUEUEMASK + 1)\n#define EQUEUESIZE\tRQUEUESIZE\n\n\n \nstruct jsm_channel {\n\tstruct uart_port uart_port;\n\tstruct jsm_board\t*ch_bd;\t\t \n\n\tspinlock_t\tch_lock;\t \n\twait_queue_head_t ch_flags_wait;\n\n\tu32\t\tch_portnum;\t \n\tu32\t\tch_open_count;\t \n\tu32\t\tch_flags;\t \n\n\tu64\t\tch_close_delay;\t \n\n\ttcflag_t\tch_c_iflag;\t \n\ttcflag_t\tch_c_cflag;\t \n\ttcflag_t\tch_c_oflag;\t \n\ttcflag_t\tch_c_lflag;\t \n\tu8\t\tch_stopc;\t \n\tu8\t\tch_startc;\t \n\n\tu8\t\tch_mostat;\t \n\tu8\t\tch_mistat;\t \n\n\t \n\tstruct neo_uart_struct __iomem *ch_neo_uart;  \n\tstruct cls_uart_struct __iomem *ch_cls_uart;  \n\n\tu8\t\tch_cached_lsr;\t \n\n\tu8\t\t*ch_rqueue;\t \n\tu16\t\tch_r_head;\t \n\tu16\t\tch_r_tail;\t \n\n\tu8\t\t*ch_equeue;\t \n\tu16\t\tch_e_head;\t \n\tu16\t\tch_e_tail;\t \n\n\tu64\t\tch_rxcount;\t \n\tu64\t\tch_txcount;\t \n\n\tu8\t\tch_r_tlevel;\t \n\tu8\t\tch_t_tlevel;\t \n\n\tu8\t\tch_r_watermark;\t \n\n\n\tu32\t\tch_stops_sent;\t \n\tu64\t\tch_err_parity;\t \n\tu64\t\tch_err_frame;\t \n\tu64\t\tch_err_break;\t \n\tu64\t\tch_err_overrun;  \n\n\tu64\t\tch_xon_sends;\t \n\tu64\t\tch_xoff_sends;\t \n};\n\n \n\nstruct cls_uart_struct {\n\tu8 txrx;\t \n\tu8 ier;\t\t \n\tu8 isr_fcr;\t \n\tu8 lcr;\t\t \n\tu8 mcr;\t\t \n\tu8 lsr;\t\t \n\tu8 msr;\t\t \n\tu8 spr;\t\t \n};\n\n \n#define UART_CLASSIC_POLL_ADDR_OFFSET\t0x40\n\n#define UART_EXAR654_ENHANCED_REGISTER_SET 0xBF\n\n#define UART_16654_FCR_TXTRIGGER_8\t0x0\n#define UART_16654_FCR_TXTRIGGER_16\t0x10\n#define UART_16654_FCR_TXTRIGGER_32\t0x20\n#define UART_16654_FCR_TXTRIGGER_56\t0x30\n\n#define UART_16654_FCR_RXTRIGGER_8\t0x0\n#define UART_16654_FCR_RXTRIGGER_16\t0x40\n#define UART_16654_FCR_RXTRIGGER_56\t0x80\n#define UART_16654_FCR_RXTRIGGER_60\t0xC0\n\n#define UART_IIR_CTSRTS\t\t\t0x20\t \n#define UART_IIR_RDI_TIMEOUT\t\t0x0C     \n\n \n#define UART_EXAR654_EFR_ECB      0x10     \n#define UART_EXAR654_EFR_IXON     0x2      \n#define UART_EXAR654_EFR_IXOFF    0x8      \n#define UART_EXAR654_EFR_RTSDTR   0x40     \n#define UART_EXAR654_EFR_CTSDSR   0x80     \n\n#define UART_EXAR654_XOFF_DETECT  0x1      \n#define UART_EXAR654_XON_DETECT   0x2      \n\n#define UART_EXAR654_IER_XOFF     0x20     \n#define UART_EXAR654_IER_RTSDTR   0x40     \n#define UART_EXAR654_IER_CTSDSR   0x80     \n\n \n\nstruct neo_uart_struct {\n\t u8 txrx;\t\t \n\t u8 ier;\t\t \n\t u8 isr_fcr;\t\t \n\t u8 lcr;\t\t \n\t u8 mcr;\t\t \n\t u8 lsr;\t\t \n\t u8 msr;\t\t \n\t u8 spr;\t\t \n\t u8 fctr;\t\t \n\t u8 efr;\t\t \n\t u8 tfifo;\t\t \n\t u8 rfifo;\t\t \n\t u8 xoffchar1;\t \n\t u8 xoffchar2;\t \n\t u8 xonchar1;\t \n\t u8 xonchar2;\t \n\n\t u8 reserved1[0x2ff - 0x200];  \n\t u8 txrxburst[64];\t \n\t u8 reserved2[0x37f - 0x340];  \n\t u8 rxburst_with_errors[64];\t \n};\n\n \n#define\tUART_17158_POLL_ADDR_OFFSET\t0x80\n\n \n\n \n#define UART_17158_FCTR_RTS_NODELAY\t0x00\n#define UART_17158_FCTR_RTS_4DELAY\t0x01\n#define UART_17158_FCTR_RTS_6DELAY\t0x02\n#define UART_17158_FCTR_RTS_8DELAY\t0x03\n#define UART_17158_FCTR_RTS_12DELAY\t0x12\n#define UART_17158_FCTR_RTS_16DELAY\t0x05\n#define UART_17158_FCTR_RTS_20DELAY\t0x13\n#define UART_17158_FCTR_RTS_24DELAY\t0x06\n#define UART_17158_FCTR_RTS_28DELAY\t0x14\n#define UART_17158_FCTR_RTS_32DELAY\t0x07\n#define UART_17158_FCTR_RTS_36DELAY\t0x16\n#define UART_17158_FCTR_RTS_40DELAY\t0x08\n#define UART_17158_FCTR_RTS_44DELAY\t0x09\n#define UART_17158_FCTR_RTS_48DELAY\t0x10\n#define UART_17158_FCTR_RTS_52DELAY\t0x11\n\n#define UART_17158_FCTR_RTS_IRDA\t0x10\n#define UART_17158_FCTR_RS485\t\t0x20\n#define UART_17158_FCTR_TRGA\t\t0x00\n#define UART_17158_FCTR_TRGB\t\t0x40\n#define UART_17158_FCTR_TRGC\t\t0x80\n#define UART_17158_FCTR_TRGD\t\t0xC0\n\n \n#define UART_17158_FCTR_BIT6\t\t0x40\n#define UART_17158_FCTR_BIT7\t\t0x80\n\n \n#define UART_17158_RX_FIFOSIZE\t\t64\n#define UART_17158_TX_FIFOSIZE\t\t64\n\n \n#define UART_17158_IIR_RDI_TIMEOUT\t0x0C\t \n#define UART_17158_IIR_XONXOFF\t\t0x10\t \n#define UART_17158_IIR_HWFLOW_STATE_CHANGE 0x20\t \n#define UART_17158_IIR_FIFO_ENABLED\t0xC0\t \n\n \n#define UART_17158_RX_LINE_STATUS\t0x1\t \n#define UART_17158_RXRDY_TIMEOUT\t0x2\t \n#define UART_17158_TXRDY\t\t0x3\t \n#define UART_17158_MSR\t\t\t0x4\t \n#define UART_17158_TX_AND_FIFO_CLR\t0x40\t \n#define UART_17158_RX_FIFO_DATA_ERROR\t0x80\t \n\n \n#define UART_17158_EFR_ECB\t0x10\t \n#define UART_17158_EFR_IXON\t0x2\t \n#define UART_17158_EFR_IXOFF\t0x8\t \n#define UART_17158_EFR_RTSDTR\t0x40\t \n#define UART_17158_EFR_CTSDSR\t0x80\t \n\n#define UART_17158_XOFF_DETECT\t0x1\t \n#define UART_17158_XON_DETECT\t0x2\t \n\n#define UART_17158_IER_RSVD1\t0x10\t \n#define UART_17158_IER_XOFF\t0x20\t \n#define UART_17158_IER_RTSDTR\t0x40\t \n#define UART_17158_IER_CTSDSR\t0x80\t \n\n#define PCI_DEVICE_NEO_2DB9_PCI_NAME\t\t\"Neo 2 - DB9 Universal PCI\"\n#define PCI_DEVICE_NEO_2DB9PRI_PCI_NAME\t\t\"Neo 2 - DB9 Universal PCI - Powered Ring Indicator\"\n#define PCI_DEVICE_NEO_2RJ45_PCI_NAME\t\t\"Neo 2 - RJ45 Universal PCI\"\n#define PCI_DEVICE_NEO_2RJ45PRI_PCI_NAME\t\"Neo 2 - RJ45 Universal PCI - Powered Ring Indicator\"\n#define PCIE_DEVICE_NEO_IBM_PCI_NAME\t\t\"Neo 4 - PCI Express - IBM\"\n\n \nextern struct\tuart_driver jsm_uart_driver;\nextern struct\tboard_ops jsm_neo_ops;\nextern struct\tboard_ops jsm_cls_ops;\nextern int\tjsm_debug;\n\n \nint jsm_tty_init(struct jsm_board *);\nint jsm_uart_port_init(struct jsm_board *);\nint jsm_remove_uart_port(struct jsm_board *);\nvoid jsm_input(struct jsm_channel *ch);\nvoid jsm_check_queue_flow_control(struct jsm_channel *ch);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}