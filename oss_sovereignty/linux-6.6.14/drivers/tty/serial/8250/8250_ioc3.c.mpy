{
  "module_name": "8250_ioc3.c",
  "hash_id": "4fb7fa716372faae0175214a801a1e9d592e9e23950d9a96df8dbfafdbb8822d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tty/serial/8250/8250_ioc3.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/io.h>\n#include <linux/platform_device.h>\n\n#include \"8250.h\"\n\n#define IOC3_UARTCLK (22000000 / 3)\n\nstruct ioc3_8250_data {\n\tint line;\n};\n\nstatic unsigned int ioc3_serial_in(struct uart_port *p, int offset)\n{\n\treturn readb(p->membase + (offset ^ 3));\n}\n\nstatic void ioc3_serial_out(struct uart_port *p, int offset, int value)\n{\n\twriteb(value, p->membase + (offset ^ 3));\n}\n\nstatic int serial8250_ioc3_probe(struct platform_device *pdev)\n{\n\tstruct ioc3_8250_data *data;\n\tstruct uart_8250_port up;\n\tstruct resource *r;\n\tvoid __iomem *membase;\n\tint irq, line;\n\n\tr = platform_get_resource(pdev, IORESOURCE_MEM, 0);\n\tif (!r)\n\t\treturn -ENODEV;\n\n\tdata = devm_kzalloc(&pdev->dev, sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\treturn -ENOMEM;\n\n\tmembase = devm_ioremap(&pdev->dev, r->start, resource_size(r));\n\tif (!membase)\n\t\treturn -ENOMEM;\n\n\tirq = platform_get_irq(pdev, 0);\n\tif (irq < 0)\n\t\tirq = 0;  \n\n\t \n\tmemset(&up, 0, sizeof(struct uart_8250_port));\n\tup.port.iotype = UPIO_MEM;\n\tup.port.uartclk = IOC3_UARTCLK;\n\tup.port.type = PORT_16550A;\n\tup.port.irq = irq;\n\tup.port.flags = (UPF_BOOT_AUTOCONF | UPF_SHARE_IRQ);\n\tup.port.dev = &pdev->dev;\n\tup.port.membase = membase;\n\tup.port.mapbase = r->start;\n\tup.port.serial_in = ioc3_serial_in;\n\tup.port.serial_out = ioc3_serial_out;\n\tline = serial8250_register_8250_port(&up);\n\tif (line < 0)\n\t\treturn line;\n\n\tplatform_set_drvdata(pdev, data);\n\treturn 0;\n}\n\nstatic int serial8250_ioc3_remove(struct platform_device *pdev)\n{\n\tstruct ioc3_8250_data *data = platform_get_drvdata(pdev);\n\n\tserial8250_unregister_port(data->line);\n\treturn 0;\n}\n\nstatic struct platform_driver serial8250_ioc3_driver = {\n\t.probe  = serial8250_ioc3_probe,\n\t.remove = serial8250_ioc3_remove,\n\t.driver = {\n\t\t.name = \"ioc3-serial8250\",\n\t}\n};\n\nmodule_platform_driver(serial8250_ioc3_driver);\n\nMODULE_AUTHOR(\"Thomas Bogendoerfer <tbogendoerfer@suse.de>\");\nMODULE_DESCRIPTION(\"SGI IOC3 8250 UART driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}