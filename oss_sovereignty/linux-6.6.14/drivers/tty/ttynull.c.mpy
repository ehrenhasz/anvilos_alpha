{
  "module_name": "ttynull.c",
  "hash_id": "1642ad3b960c314a9c4dfcfb50de8bd191303399de736ee308ea34af41142e8b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tty/ttynull.c",
  "human_readable_source": "\n \n\n#include <linux/console.h>\n#include <linux/module.h>\n#include <linux/tty.h>\n\nstatic const struct tty_port_operations ttynull_port_ops;\nstatic struct tty_driver *ttynull_driver;\nstatic struct tty_port ttynull_port;\n\nstatic int ttynull_open(struct tty_struct *tty, struct file *filp)\n{\n\treturn tty_port_open(&ttynull_port, tty, filp);\n}\n\nstatic void ttynull_close(struct tty_struct *tty, struct file *filp)\n{\n\ttty_port_close(&ttynull_port, tty, filp);\n}\n\nstatic void ttynull_hangup(struct tty_struct *tty)\n{\n\ttty_port_hangup(&ttynull_port);\n}\n\nstatic ssize_t ttynull_write(struct tty_struct *tty, const u8 *buf,\n\t\t\t     size_t count)\n{\n\treturn count;\n}\n\nstatic unsigned int ttynull_write_room(struct tty_struct *tty)\n{\n\treturn 65536;\n}\n\nstatic const struct tty_operations ttynull_ops = {\n\t.open = ttynull_open,\n\t.close = ttynull_close,\n\t.hangup = ttynull_hangup,\n\t.write = ttynull_write,\n\t.write_room = ttynull_write_room,\n};\n\nstatic struct tty_driver *ttynull_device(struct console *c, int *index)\n{\n\t*index = 0;\n\treturn ttynull_driver;\n}\n\nstatic struct console ttynull_console = {\n\t.name = \"ttynull\",\n\t.device = ttynull_device,\n};\n\nstatic int __init ttynull_init(void)\n{\n\tstruct tty_driver *driver;\n\tint ret;\n\n\tdriver = tty_alloc_driver(1,\n\t\tTTY_DRIVER_RESET_TERMIOS |\n\t\tTTY_DRIVER_REAL_RAW |\n\t\tTTY_DRIVER_UNNUMBERED_NODE);\n\tif (IS_ERR(driver))\n\t\treturn PTR_ERR(driver);\n\n\ttty_port_init(&ttynull_port);\n\tttynull_port.ops = &ttynull_port_ops;\n\n\tdriver->driver_name = \"ttynull\";\n\tdriver->name = \"ttynull\";\n\tdriver->type = TTY_DRIVER_TYPE_CONSOLE;\n\tdriver->init_termios = tty_std_termios;\n\tdriver->init_termios.c_oflag = OPOST | OCRNL | ONOCR | ONLRET;\n\ttty_set_operations(driver, &ttynull_ops);\n\ttty_port_link_device(&ttynull_port, driver, 0);\n\n\tret = tty_register_driver(driver);\n\tif (ret < 0) {\n\t\ttty_driver_kref_put(driver);\n\t\ttty_port_destroy(&ttynull_port);\n\t\treturn ret;\n\t}\n\n\tttynull_driver = driver;\n\tregister_console(&ttynull_console);\n\n\treturn 0;\n}\n\nstatic void __exit ttynull_exit(void)\n{\n\tunregister_console(&ttynull_console);\n\ttty_unregister_driver(ttynull_driver);\n\ttty_driver_kref_put(ttynull_driver);\n\ttty_port_destroy(&ttynull_port);\n}\n\nmodule_init(ttynull_init);\nmodule_exit(ttynull_exit);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}