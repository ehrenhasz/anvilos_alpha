{
  "module_name": "common.h",
  "hash_id": "52de1d175b0ab6802dc694db7a17e2eb76eb565d93d0d466619f602c26bda68d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/bus/mhi/common.h",
  "human_readable_source": " \n \n\n#ifndef _MHI_COMMON_H\n#define _MHI_COMMON_H\n\n#include <linux/bitfield.h>\n#include <linux/mhi.h>\n\n \n#define MHIREGLEN\t\t\t0x00\n#define MHIVER\t\t\t\t0x08\n#define MHICFG\t\t\t\t0x10\n#define CHDBOFF\t\t\t\t0x18\n#define ERDBOFF\t\t\t\t0x20\n#define BHIOFF\t\t\t\t0x28\n#define BHIEOFF\t\t\t\t0x2c\n#define DEBUGOFF\t\t\t0x30\n#define MHICTRL\t\t\t\t0x38\n#define MHISTATUS\t\t\t0x48\n#define CCABAP_LOWER\t\t\t0x58\n#define CCABAP_HIGHER\t\t\t0x5c\n#define ECABAP_LOWER\t\t\t0x60\n#define ECABAP_HIGHER\t\t\t0x64\n#define CRCBAP_LOWER\t\t\t0x68\n#define CRCBAP_HIGHER\t\t\t0x6c\n#define CRDB_LOWER\t\t\t0x70\n#define CRDB_HIGHER\t\t\t0x74\n#define MHICTRLBASE_LOWER\t\t0x80\n#define MHICTRLBASE_HIGHER\t\t0x84\n#define MHICTRLLIMIT_LOWER\t\t0x88\n#define MHICTRLLIMIT_HIGHER\t\t0x8c\n#define MHIDATABASE_LOWER\t\t0x98\n#define MHIDATABASE_HIGHER\t\t0x9c\n#define MHIDATALIMIT_LOWER\t\t0xa0\n#define MHIDATALIMIT_HIGHER\t\t0xa4\n\n \n#define BHI_BHIVERSION_MINOR\t\t0x00\n#define BHI_BHIVERSION_MAJOR\t\t0x04\n#define BHI_IMGADDR_LOW\t\t\t0x08\n#define BHI_IMGADDR_HIGH\t\t0x0c\n#define BHI_IMGSIZE\t\t\t0x10\n#define BHI_RSVD1\t\t\t0x14\n#define BHI_IMGTXDB\t\t\t0x18\n#define BHI_RSVD2\t\t\t0x1c\n#define BHI_INTVEC\t\t\t0x20\n#define BHI_RSVD3\t\t\t0x24\n#define BHI_EXECENV\t\t\t0x28\n#define BHI_STATUS\t\t\t0x2c\n#define BHI_ERRCODE\t\t\t0x30\n#define BHI_ERRDBG1\t\t\t0x34\n#define BHI_ERRDBG2\t\t\t0x38\n#define BHI_ERRDBG3\t\t\t0x3c\n#define BHI_SERIALNU\t\t\t0x40\n#define BHI_SBLANTIROLLVER\t\t0x44\n#define BHI_NUMSEG\t\t\t0x48\n#define BHI_MSMHWID(n)\t\t\t(0x4c + (0x4 * (n)))\n#define BHI_OEMPKHASH(n)\t\t(0x64 + (0x4 * (n)))\n#define BHI_RSVD5\t\t\t0xc4\n\n \n#define BHI_TXDB_SEQNUM_BMSK\t\tGENMASK(29, 0)\n#define BHI_TXDB_SEQNUM_SHFT\t\t0\n#define BHI_STATUS_MASK\t\t\tGENMASK(31, 30)\n#define BHI_STATUS_ERROR\t\t0x03\n#define BHI_STATUS_SUCCESS\t\t0x02\n#define BHI_STATUS_RESET\t\t0x00\n\n \n#define BHIE_MSMSOCID_OFFS\t\t0x00\n#define BHIE_TXVECADDR_LOW_OFFS\t\t0x2c\n#define BHIE_TXVECADDR_HIGH_OFFS\t0x30\n#define BHIE_TXVECSIZE_OFFS\t\t0x34\n#define BHIE_TXVECDB_OFFS\t\t0x3c\n#define BHIE_TXVECSTATUS_OFFS\t\t0x44\n#define BHIE_RXVECADDR_LOW_OFFS\t\t0x60\n#define BHIE_RXVECADDR_HIGH_OFFS\t0x64\n#define BHIE_RXVECSIZE_OFFS\t\t0x68\n#define BHIE_RXVECDB_OFFS\t\t0x70\n#define BHIE_RXVECSTATUS_OFFS\t\t0x78\n\n \n#define BHIE_TXVECDB_SEQNUM_BMSK\tGENMASK(29, 0)\n#define BHIE_TXVECDB_SEQNUM_SHFT\t0\n#define BHIE_TXVECSTATUS_SEQNUM_BMSK\tGENMASK(29, 0)\n#define BHIE_TXVECSTATUS_SEQNUM_SHFT\t0\n#define BHIE_TXVECSTATUS_STATUS_BMSK\tGENMASK(31, 30)\n#define BHIE_TXVECSTATUS_STATUS_SHFT\t30\n#define BHIE_TXVECSTATUS_STATUS_RESET\t0x00\n#define BHIE_TXVECSTATUS_STATUS_XFER_COMPL\t0x02\n#define BHIE_TXVECSTATUS_STATUS_ERROR\t0x03\n#define BHIE_RXVECDB_SEQNUM_BMSK\tGENMASK(29, 0)\n#define BHIE_RXVECDB_SEQNUM_SHFT\t0\n#define BHIE_RXVECSTATUS_SEQNUM_BMSK\tGENMASK(29, 0)\n#define BHIE_RXVECSTATUS_SEQNUM_SHFT\t0\n#define BHIE_RXVECSTATUS_STATUS_BMSK\tGENMASK(31, 30)\n#define BHIE_RXVECSTATUS_STATUS_SHFT\t30\n#define BHIE_RXVECSTATUS_STATUS_RESET\t0x00\n#define BHIE_RXVECSTATUS_STATUS_XFER_COMPL\t0x02\n#define BHIE_RXVECSTATUS_STATUS_ERROR\t0x03\n\n \n#define MHICFG_NHWER_MASK\t\tGENMASK(31, 24)\n#define MHICFG_NER_MASK\t\t\tGENMASK(23, 16)\n#define MHICFG_NHWCH_MASK\t\tGENMASK(15, 8)\n#define MHICFG_NCH_MASK\t\t\tGENMASK(7, 0)\n#define MHICTRL_MHISTATE_MASK\t\tGENMASK(15, 8)\n#define MHICTRL_RESET_MASK\t\tBIT(1)\n#define MHISTATUS_MHISTATE_MASK\t\tGENMASK(15, 8)\n#define MHISTATUS_SYSERR_MASK\t\tBIT(2)\n#define MHISTATUS_READY_MASK\t\tBIT(0)\n\n \n \n#define MHI_TRE_CMD_NOOP_PTR\t\t0\n#define MHI_TRE_CMD_NOOP_DWORD0\t\t0\n#define MHI_TRE_CMD_NOOP_DWORD1\t\tcpu_to_le32(FIELD_PREP(GENMASK(23, 16), MHI_CMD_NOP))\n\n \n#define MHI_TRE_CMD_RESET_PTR\t\t0\n#define MHI_TRE_CMD_RESET_DWORD0\t0\n#define MHI_TRE_CMD_RESET_DWORD1(chid)\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), chid) | \\\n\t\t\t\t\t\t    FIELD_PREP(GENMASK(23, 16),         \\\n\t\t\t\t\t\t\t       MHI_CMD_RESET_CHAN))\n\n \n#define MHI_TRE_CMD_STOP_PTR\t\t0\n#define MHI_TRE_CMD_STOP_DWORD0\t\t0\n#define MHI_TRE_CMD_STOP_DWORD1(chid)\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), chid) | \\\n\t\t\t\t\t\t    FIELD_PREP(GENMASK(23, 16),         \\\n\t\t\t\t\t\t\t       MHI_CMD_STOP_CHAN))\n\n \n#define MHI_TRE_CMD_START_PTR\t\t0\n#define MHI_TRE_CMD_START_DWORD0\t0\n#define MHI_TRE_CMD_START_DWORD1(chid)\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), chid) | \\\n\t\t\t\t\t\t    FIELD_PREP(GENMASK(23, 16),         \\\n\t\t\t\t\t\t\t       MHI_CMD_START_CHAN))\n\n#define MHI_TRE_GET_DWORD(tre, word)\tle32_to_cpu((tre)->dword[(word)])\n#define MHI_TRE_GET_CMD_CHID(tre)\tFIELD_GET(GENMASK(31, 24), MHI_TRE_GET_DWORD(tre, 1))\n#define MHI_TRE_GET_CMD_TYPE(tre)\tFIELD_GET(GENMASK(23, 16), MHI_TRE_GET_DWORD(tre, 1))\n\n \n#define MHI_TRE_EV_PTR(ptr)\t\tcpu_to_le64(ptr)\n#define MHI_TRE_EV_DWORD0(code, len)\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), code) | \\\n\t\t\t\t\t\t    FIELD_PREP(GENMASK(15, 0), len))\n#define MHI_TRE_EV_DWORD1(chid, type)\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), chid) | \\\n\t\t\t\t\t\t    FIELD_PREP(GENMASK(23, 16), type))\n#define MHI_TRE_GET_EV_PTR(tre)\t\tle64_to_cpu((tre)->ptr)\n#define MHI_TRE_GET_EV_CODE(tre)\tFIELD_GET(GENMASK(31, 24), (MHI_TRE_GET_DWORD(tre, 0)))\n#define MHI_TRE_GET_EV_LEN(tre)\t\tFIELD_GET(GENMASK(15, 0), (MHI_TRE_GET_DWORD(tre, 0)))\n#define MHI_TRE_GET_EV_CHID(tre)\tFIELD_GET(GENMASK(31, 24), (MHI_TRE_GET_DWORD(tre, 1)))\n#define MHI_TRE_GET_EV_TYPE(tre)\tFIELD_GET(GENMASK(23, 16), (MHI_TRE_GET_DWORD(tre, 1)))\n#define MHI_TRE_GET_EV_STATE(tre)\tFIELD_GET(GENMASK(31, 24), (MHI_TRE_GET_DWORD(tre, 0)))\n#define MHI_TRE_GET_EV_EXECENV(tre)\tFIELD_GET(GENMASK(31, 24), (MHI_TRE_GET_DWORD(tre, 0)))\n#define MHI_TRE_GET_EV_SEQ(tre)\t\tMHI_TRE_GET_DWORD(tre, 0)\n#define MHI_TRE_GET_EV_TIME(tre)\tMHI_TRE_GET_EV_PTR(tre)\n#define MHI_TRE_GET_EV_COOKIE(tre)\tlower_32_bits(MHI_TRE_GET_EV_PTR(tre))\n#define MHI_TRE_GET_EV_VEID(tre)\tFIELD_GET(GENMASK(23, 16), (MHI_TRE_GET_DWORD(tre, 0)))\n#define MHI_TRE_GET_EV_LINKSPEED(tre)\tFIELD_GET(GENMASK(31, 24), (MHI_TRE_GET_DWORD(tre, 1)))\n#define MHI_TRE_GET_EV_LINKWIDTH(tre)\tFIELD_GET(GENMASK(7, 0), (MHI_TRE_GET_DWORD(tre, 0)))\n\n \n#define MHI_SC_EV_PTR\t\t\t0\n#define MHI_SC_EV_DWORD0(state)\t\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), state))\n#define MHI_SC_EV_DWORD1(type)\t\tcpu_to_le32(FIELD_PREP(GENMASK(23, 16), type))\n\n \n#define MHI_EE_EV_PTR\t\t\t0\n#define MHI_EE_EV_DWORD0(ee)\t\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), ee))\n#define MHI_EE_EV_DWORD1(type)\t\tcpu_to_le32(FIELD_PREP(GENMASK(23, 16), type))\n\n\n \n#define MHI_CC_EV_PTR(ptr)\t\tcpu_to_le64(ptr)\n#define MHI_CC_EV_DWORD0(code)\t\tcpu_to_le32(FIELD_PREP(GENMASK(31, 24), code))\n#define MHI_CC_EV_DWORD1(type)\t\tcpu_to_le32(FIELD_PREP(GENMASK(23, 16), type))\n\n \n#define MHI_TRE_DATA_PTR(ptr)\t\tcpu_to_le64(ptr)\n#define MHI_TRE_DATA_DWORD0(len)\tcpu_to_le32(FIELD_PREP(GENMASK(15, 0), len))\n#define MHI_TRE_TYPE_TRANSFER\t\t2\n#define MHI_TRE_DATA_DWORD1(bei, ieot, ieob, chain) cpu_to_le32(FIELD_PREP(GENMASK(23, 16), \\\n\t\t\t\t\t\t\t\tMHI_TRE_TYPE_TRANSFER) |    \\\n\t\t\t\t\t\t\t\tFIELD_PREP(BIT(10), bei) |  \\\n\t\t\t\t\t\t\t\tFIELD_PREP(BIT(9), ieot) |  \\\n\t\t\t\t\t\t\t\tFIELD_PREP(BIT(8), ieob) |  \\\n\t\t\t\t\t\t\t\tFIELD_PREP(BIT(0), chain))\n#define MHI_TRE_DATA_GET_PTR(tre)\tle64_to_cpu((tre)->ptr)\n#define MHI_TRE_DATA_GET_LEN(tre)\tFIELD_GET(GENMASK(15, 0), MHI_TRE_GET_DWORD(tre, 0))\n#define MHI_TRE_DATA_GET_CHAIN(tre)\t(!!(FIELD_GET(BIT(0), MHI_TRE_GET_DWORD(tre, 1))))\n#define MHI_TRE_DATA_GET_IEOB(tre)\t(!!(FIELD_GET(BIT(8), MHI_TRE_GET_DWORD(tre, 1))))\n#define MHI_TRE_DATA_GET_IEOT(tre)\t(!!(FIELD_GET(BIT(9), MHI_TRE_GET_DWORD(tre, 1))))\n#define MHI_TRE_DATA_GET_BEI(tre)\t(!!(FIELD_GET(BIT(10), MHI_TRE_GET_DWORD(tre, 1))))\n\n \n#define MHI_RSCTRE_DATA_PTR(ptr, len)\tcpu_to_le64(FIELD_PREP(GENMASK(64, 48), len) | ptr)\n#define MHI_RSCTRE_DATA_DWORD0(cookie)\tcpu_to_le32(cookie)\n#define MHI_RSCTRE_DATA_DWORD1\t\tcpu_to_le32(FIELD_PREP(GENMASK(23, 16), \\\n\t\t\t\t\t\t\t       MHI_PKT_TYPE_COALESCING))\n\nenum mhi_pkt_type {\n\tMHI_PKT_TYPE_INVALID = 0x0,\n\tMHI_PKT_TYPE_NOOP_CMD = 0x1,\n\tMHI_PKT_TYPE_TRANSFER = 0x2,\n\tMHI_PKT_TYPE_COALESCING = 0x8,\n\tMHI_PKT_TYPE_RESET_CHAN_CMD = 0x10,\n\tMHI_PKT_TYPE_STOP_CHAN_CMD = 0x11,\n\tMHI_PKT_TYPE_START_CHAN_CMD = 0x12,\n\tMHI_PKT_TYPE_STATE_CHANGE_EVENT = 0x20,\n\tMHI_PKT_TYPE_CMD_COMPLETION_EVENT = 0x21,\n\tMHI_PKT_TYPE_TX_EVENT = 0x22,\n\tMHI_PKT_TYPE_RSC_TX_EVENT = 0x28,\n\tMHI_PKT_TYPE_EE_EVENT = 0x40,\n\tMHI_PKT_TYPE_TSYNC_EVENT = 0x48,\n\tMHI_PKT_TYPE_BW_REQ_EVENT = 0x50,\n\tMHI_PKT_TYPE_STALE_EVENT,  \n};\n\n \nenum mhi_ev_ccs {\n\tMHI_EV_CC_INVALID = 0x0,\n\tMHI_EV_CC_SUCCESS = 0x1,\n\tMHI_EV_CC_EOT = 0x2,  \n\tMHI_EV_CC_OVERFLOW = 0x3,\n\tMHI_EV_CC_EOB = 0x4,  \n\tMHI_EV_CC_OOB = 0x5,  \n\tMHI_EV_CC_DB_MODE = 0x6,\n\tMHI_EV_CC_UNDEFINED_ERR = 0x10,\n\tMHI_EV_CC_BAD_TRE = 0x11,\n};\n\n \nenum mhi_ch_state {\n\tMHI_CH_STATE_DISABLED,\n\tMHI_CH_STATE_ENABLED,\n\tMHI_CH_STATE_RUNNING,\n\tMHI_CH_STATE_SUSPENDED,\n\tMHI_CH_STATE_STOP,\n\tMHI_CH_STATE_ERROR,\n};\n\nenum mhi_cmd_type {\n\tMHI_CMD_NOP = 1,\n\tMHI_CMD_RESET_CHAN = 16,\n\tMHI_CMD_STOP_CHAN = 17,\n\tMHI_CMD_START_CHAN = 18,\n};\n\n#define EV_CTX_RESERVED_MASK\t\tGENMASK(7, 0)\n#define EV_CTX_INTMODC_MASK\t\tGENMASK(15, 8)\n#define EV_CTX_INTMODT_MASK\t\tGENMASK(31, 16)\nstruct mhi_event_ctxt {\n\t__le32 intmod;\n\t__le32 ertype;\n\t__le32 msivec;\n\n\t__le64 rbase __packed __aligned(4);\n\t__le64 rlen __packed __aligned(4);\n\t__le64 rp __packed __aligned(4);\n\t__le64 wp __packed __aligned(4);\n};\n\n#define CHAN_CTX_CHSTATE_MASK\t\tGENMASK(7, 0)\n#define CHAN_CTX_BRSTMODE_MASK\t\tGENMASK(9, 8)\n#define CHAN_CTX_POLLCFG_MASK\t\tGENMASK(15, 10)\n#define CHAN_CTX_RESERVED_MASK\t\tGENMASK(31, 16)\nstruct mhi_chan_ctxt {\n\t__le32 chcfg;\n\t__le32 chtype;\n\t__le32 erindex;\n\n\t__le64 rbase __packed __aligned(4);\n\t__le64 rlen __packed __aligned(4);\n\t__le64 rp __packed __aligned(4);\n\t__le64 wp __packed __aligned(4);\n};\n\nstruct mhi_cmd_ctxt {\n\t__le32 reserved0;\n\t__le32 reserved1;\n\t__le32 reserved2;\n\n\t__le64 rbase __packed __aligned(4);\n\t__le64 rlen __packed __aligned(4);\n\t__le64 rp __packed __aligned(4);\n\t__le64 wp __packed __aligned(4);\n};\n\nstruct mhi_ring_element {\n\t__le64 ptr;\n\t__le32 dword[2];\n};\n\nstatic inline const char *mhi_state_str(enum mhi_state state)\n{\n\tswitch (state) {\n\tcase MHI_STATE_RESET:\n\t\treturn \"RESET\";\n\tcase MHI_STATE_READY:\n\t\treturn \"READY\";\n\tcase MHI_STATE_M0:\n\t\treturn \"M0\";\n\tcase MHI_STATE_M1:\n\t\treturn \"M1\";\n\tcase MHI_STATE_M2:\n\t\treturn \"M2\";\n\tcase MHI_STATE_M3:\n\t\treturn \"M3\";\n\tcase MHI_STATE_M3_FAST:\n\t\treturn \"M3 FAST\";\n\tcase MHI_STATE_BHI:\n\t\treturn \"BHI\";\n\tcase MHI_STATE_SYS_ERR:\n\t\treturn \"SYS ERROR\";\n\tdefault:\n\t\treturn \"Unknown state\";\n\t}\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}