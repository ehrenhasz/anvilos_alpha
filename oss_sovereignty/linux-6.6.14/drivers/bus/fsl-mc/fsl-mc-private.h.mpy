{
  "module_name": "fsl-mc-private.h",
  "hash_id": "0f3f68b296ab07b910f76028a854347cb57b42a75687b45773f8ff9fbdcc02f1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/bus/fsl-mc/fsl-mc-private.h",
  "human_readable_source": " \n \n#ifndef _FSL_MC_PRIVATE_H_\n#define _FSL_MC_PRIVATE_H_\n\n#include <linux/fsl/mc.h>\n#include <linux/mutex.h>\n#include <linux/ioctl.h>\n#include <linux/miscdevice.h>\n\n \n\n \n#define DPMNG_CMD_BASE_VERSION\t\t1\n#define DPMNG_CMD_ID_OFFSET\t\t4\n\n#define DPMNG_CMD(id)\t(((id) << DPMNG_CMD_ID_OFFSET) | DPMNG_CMD_BASE_VERSION)\n\n \n#define DPMNG_CMDID_GET_VERSION\t\tDPMNG_CMD(0x831)\n\nstruct dpmng_rsp_get_version {\n\t__le32 revision;\n\t__le32 version_major;\n\t__le32 version_minor;\n};\n\n \n\n \n#define DPMCP_MIN_VER_MAJOR\t\t3\n#define DPMCP_MIN_VER_MINOR\t\t0\n\n \n#define DPMCP_CMD_BASE_VERSION\t\t1\n#define DPMCP_CMD_ID_OFFSET\t\t4\n\n#define DPMCP_CMD(id)\t(((id) << DPMCP_CMD_ID_OFFSET) | DPMCP_CMD_BASE_VERSION)\n\n \n#define DPMCP_CMDID_CLOSE\t\tDPMCP_CMD(0x800)\n#define DPMCP_CMDID_RESET\t\tDPMCP_CMD(0x005)\n\nstruct dpmcp_cmd_open {\n\t__le32 dpmcp_id;\n};\n\n \nint dpmcp_open(struct fsl_mc_io *mc_io,\n\t       u32 cmd_flags,\n\t       int dpmcp_id,\n\t       u16 *token);\n\nint dpmcp_close(struct fsl_mc_io *mc_io,\n\t\tu32 cmd_flags,\n\t\tu16 token);\n\nint dpmcp_reset(struct fsl_mc_io *mc_io,\n\t\tu32 cmd_flags,\n\t\tu16 token);\n\n \n\n \n#define DPRC_MIN_VER_MAJOR\t\t\t6\n#define DPRC_MIN_VER_MINOR\t\t\t0\n\n \n#define DPRC_CMD_BASE_VERSION\t\t\t1\n#define DPRC_CMD_2ND_VERSION\t\t\t2\n#define DPRC_CMD_3RD_VERSION\t\t\t3\n#define DPRC_CMD_ID_OFFSET\t\t\t4\n\n#define DPRC_CMD(id)\t(((id) << DPRC_CMD_ID_OFFSET) | DPRC_CMD_BASE_VERSION)\n#define DPRC_CMD_V2(id)\t(((id) << DPRC_CMD_ID_OFFSET) | DPRC_CMD_2ND_VERSION)\n#define DPRC_CMD_V3(id)\t(((id) << DPRC_CMD_ID_OFFSET) | DPRC_CMD_3RD_VERSION)\n\n \n#define DPRC_CMDID_CLOSE                        DPRC_CMD(0x800)\n#define DPRC_CMDID_GET_API_VERSION              DPRC_CMD(0xa05)\n\n#define DPRC_CMDID_GET_ATTR                     DPRC_CMD(0x004)\n#define DPRC_CMDID_RESET_CONT                   DPRC_CMD(0x005)\n#define DPRC_CMDID_RESET_CONT_V2                DPRC_CMD_V2(0x005)\n\n#define DPRC_CMDID_SET_IRQ                      DPRC_CMD(0x010)\n#define DPRC_CMDID_SET_IRQ_ENABLE               DPRC_CMD(0x012)\n#define DPRC_CMDID_SET_IRQ_MASK                 DPRC_CMD(0x014)\n#define DPRC_CMDID_GET_IRQ_STATUS               DPRC_CMD(0x016)\n#define DPRC_CMDID_CLEAR_IRQ_STATUS             DPRC_CMD(0x017)\n\n#define DPRC_CMDID_GET_CONT_ID                  DPRC_CMD(0x830)\n#define DPRC_CMDID_GET_OBJ_COUNT                DPRC_CMD(0x159)\n#define DPRC_CMDID_GET_OBJ                      DPRC_CMD(0x15A)\n#define DPRC_CMDID_GET_OBJ_REG                  DPRC_CMD(0x15E)\n#define DPRC_CMDID_GET_OBJ_REG_V2               DPRC_CMD_V2(0x15E)\n#define DPRC_CMDID_GET_OBJ_REG_V3               DPRC_CMD_V3(0x15E)\n#define DPRC_CMDID_SET_OBJ_IRQ                  DPRC_CMD(0x15F)\n\n#define DPRC_CMDID_GET_CONNECTION               DPRC_CMD(0x16C)\n\nstruct dprc_cmd_open {\n\t__le32 container_id;\n};\n\nstruct dprc_cmd_reset_container {\n\t__le32 child_container_id;\n\t__le32 options;\n};\n\nstruct dprc_cmd_set_irq {\n\t \n\t__le32 irq_val;\n\tu8 irq_index;\n\tu8 pad[3];\n\t \n\t__le64 irq_addr;\n\t \n\t__le32 irq_num;\n};\n\n#define DPRC_ENABLE\t\t0x1\n\nstruct dprc_cmd_set_irq_enable {\n\tu8 enable;\n\tu8 pad[3];\n\tu8 irq_index;\n};\n\nstruct dprc_cmd_set_irq_mask {\n\t__le32 mask;\n\tu8 irq_index;\n};\n\nstruct dprc_cmd_get_irq_status {\n\t__le32 status;\n\tu8 irq_index;\n};\n\nstruct dprc_rsp_get_irq_status {\n\t__le32 status;\n};\n\nstruct dprc_cmd_clear_irq_status {\n\t__le32 status;\n\tu8 irq_index;\n};\n\nstruct dprc_rsp_get_attributes {\n\t \n\t__le32 container_id;\n\t__le32 icid;\n\t \n\t__le32 options;\n\t__le32 portal_id;\n};\n\nstruct dprc_rsp_get_obj_count {\n\t__le32 pad;\n\t__le32 obj_count;\n};\n\nstruct dprc_cmd_get_obj {\n\t__le32 obj_index;\n};\n\nstruct dprc_rsp_get_obj {\n\t \n\t__le32 pad0;\n\t__le32 id;\n\t \n\t__le16 vendor;\n\tu8 irq_count;\n\tu8 region_count;\n\t__le32 state;\n\t \n\t__le16 version_major;\n\t__le16 version_minor;\n\t__le16 flags;\n\t__le16 pad1;\n\t \n\tu8 type[16];\n\t \n\tu8 label[16];\n};\n\nstruct dprc_cmd_get_obj_region {\n\t \n\t__le32 obj_id;\n\t__le16 pad0;\n\tu8 region_index;\n\tu8 pad1;\n\t \n\t__le64 pad2[2];\n\t \n\tu8 obj_type[16];\n};\n\nstruct dprc_rsp_get_obj_region {\n\t \n\t__le64 pad0;\n\t \n\t__le64 base_offset;\n\t \n\t__le32 size;\n\tu8 type;\n\tu8 pad2[3];\n\t \n\t__le32 flags;\n\t__le32 pad3;\n\t \n\t \n\t__le64 base_addr;\n};\n\nstruct dprc_cmd_set_obj_irq {\n\t \n\t__le32 irq_val;\n\tu8 irq_index;\n\tu8 pad[3];\n\t \n\t__le64 irq_addr;\n\t \n\t__le32 irq_num;\n\t__le32 obj_id;\n\t \n\tu8 obj_type[16];\n};\n\nstruct dprc_cmd_get_connection {\n\t__le32 ep1_id;\n\t__le16 ep1_interface_id;\n\tu8 pad[2];\n\tu8 ep1_type[16];\n};\n\nstruct dprc_rsp_get_connection {\n\t__le64 pad[3];\n\t__le32 ep2_id;\n\t__le16 ep2_interface_id;\n\t__le16 pad1;\n\tu8 ep2_type[16];\n\t__le32 state;\n};\n\n \nint dprc_open(struct fsl_mc_io *mc_io,\n\t      u32 cmd_flags,\n\t      int container_id,\n\t      u16 *token);\n\nint dprc_close(struct fsl_mc_io *mc_io,\n\t       u32 cmd_flags,\n\t       u16 token);\n\n \n\n \n#define DPRC_IRQ_EVENT_OBJ_ADDED\t\t0x00000001\n \n#define DPRC_IRQ_EVENT_OBJ_REMOVED\t\t0x00000002\n \n#define DPRC_IRQ_EVENT_CONTAINER_DESTROYED\t0x00000010\n\n \n#define DPRC_IRQ_EVENT_OBJ_DESTROYED\t\t0x00000020\n\n \n#define DPRC_IRQ_EVENT_OBJ_CREATED\t\t0x00000040\n\n \nstruct dprc_irq_cfg {\n\t     phys_addr_t paddr;\n\t     u32 val;\n\t     int irq_num;\n};\n\nint dprc_set_irq(struct fsl_mc_io *mc_io,\n\t\t u32 cmd_flags,\n\t\t u16 token,\n\t\t u8 irq_index,\n\t\t struct dprc_irq_cfg *irq_cfg);\n\nint dprc_set_irq_enable(struct fsl_mc_io *mc_io,\n\t\t\tu32 cmd_flags,\n\t\t\tu16 token,\n\t\t\tu8 irq_index,\n\t\t\tu8 en);\n\nint dprc_set_irq_mask(struct fsl_mc_io *mc_io,\n\t\t      u32 cmd_flags,\n\t\t      u16 token,\n\t\t      u8 irq_index,\n\t\t      u32 mask);\n\nint dprc_get_irq_status(struct fsl_mc_io *mc_io,\n\t\t\tu32 cmd_flags,\n\t\t\tu16 token,\n\t\t\tu8 irq_index,\n\t\t\tu32 *status);\n\nint dprc_clear_irq_status(struct fsl_mc_io *mc_io,\n\t\t\t  u32 cmd_flags,\n\t\t\t  u16 token,\n\t\t\t  u8 irq_index,\n\t\t\t  u32 status);\n\n \nstruct dprc_attributes {\n\tint container_id;\n\tu32 icid;\n\tint portal_id;\n\tu64 options;\n};\n\nint dprc_get_attributes(struct fsl_mc_io *mc_io,\n\t\t\tu32 cmd_flags,\n\t\t\tu16 token,\n\t\t\tstruct dprc_attributes *attributes);\n\nint dprc_get_obj_count(struct fsl_mc_io *mc_io,\n\t\t       u32 cmd_flags,\n\t\t       u16 token,\n\t\t       int *obj_count);\n\nint dprc_get_obj(struct fsl_mc_io *mc_io,\n\t\t u32 cmd_flags,\n\t\t u16 token,\n\t\t int obj_index,\n\t\t struct fsl_mc_obj_desc *obj_desc);\n\nint dprc_set_obj_irq(struct fsl_mc_io *mc_io,\n\t\t     u32 cmd_flags,\n\t\t     u16 token,\n\t\t     char *obj_type,\n\t\t     int obj_id,\n\t\t     u8 irq_index,\n\t\t     struct dprc_irq_cfg *irq_cfg);\n \nenum dprc_region_type {\n\tDPRC_REGION_TYPE_MC_PORTAL,\n\tDPRC_REGION_TYPE_QBMAN_PORTAL,\n\tDPRC_REGION_TYPE_QBMAN_MEM_BACKED_PORTAL\n};\n\n \nstruct dprc_region_desc {\n\tu32 base_offset;\n\tu32 size;\n\tu32 flags;\n\tenum dprc_region_type type;\n\tu64 base_address;\n};\n\nint dprc_get_obj_region(struct fsl_mc_io *mc_io,\n\t\t\tu32 cmd_flags,\n\t\t\tu16 token,\n\t\t\tchar *obj_type,\n\t\t\tint obj_id,\n\t\t\tu8 region_index,\n\t\t\tstruct dprc_region_desc *region_desc);\n\nint dprc_get_api_version(struct fsl_mc_io *mc_io,\n\t\t\t u32 cmd_flags,\n\t\t\t u16 *major_ver,\n\t\t\t u16 *minor_ver);\n\nint dprc_get_container_id(struct fsl_mc_io *mc_io,\n\t\t\t  u32 cmd_flags,\n\t\t\t  int *container_id);\n\n \nstruct dprc_endpoint {\n\tchar type[16];\n\tint id;\n\tu16 if_id;\n};\n\nint dprc_get_connection(struct fsl_mc_io *mc_io,\n\t\t\tu32 cmd_flags,\n\t\t\tu16 token,\n\t\t\tconst struct dprc_endpoint *endpoint1,\n\t\t\tstruct dprc_endpoint *endpoint2,\n\t\t\tint *state);\n\n \n\n \n#define DPBP_VER_MAJOR\t\t\t\t3\n#define DPBP_VER_MINOR\t\t\t\t2\n\n \n#define DPBP_CMD_BASE_VERSION\t\t\t1\n#define DPBP_CMD_ID_OFFSET\t\t\t4\n\n#define DPBP_CMD(id)\t(((id) << DPBP_CMD_ID_OFFSET) | DPBP_CMD_BASE_VERSION)\n\n \n#define DPBP_CMDID_CLOSE\t\tDPBP_CMD(0x800)\n\n#define DPBP_CMDID_ENABLE\t\tDPBP_CMD(0x002)\n#define DPBP_CMDID_DISABLE\t\tDPBP_CMD(0x003)\n#define DPBP_CMDID_GET_ATTR\t\tDPBP_CMD(0x004)\n#define DPBP_CMDID_RESET\t\tDPBP_CMD(0x005)\n\nstruct dpbp_cmd_open {\n\t__le32 dpbp_id;\n};\n\n#define DPBP_ENABLE\t\t\t0x1\n\nstruct dpbp_rsp_get_attributes {\n\t \n\t__le16 pad;\n\t__le16 bpid;\n\t__le32 id;\n\t \n\t__le16 version_major;\n\t__le16 version_minor;\n};\n\n \n\n \n#define DPCON_VER_MAJOR\t\t\t\t3\n#define DPCON_VER_MINOR\t\t\t\t2\n\n \n#define DPCON_CMD_BASE_VERSION\t\t\t1\n#define DPCON_CMD_ID_OFFSET\t\t\t4\n\n#define DPCON_CMD(id)\t(((id) << DPCON_CMD_ID_OFFSET) | DPCON_CMD_BASE_VERSION)\n\n \n#define DPCON_CMDID_CLOSE\t\t\tDPCON_CMD(0x800)\n\n#define DPCON_CMDID_ENABLE\t\t\tDPCON_CMD(0x002)\n#define DPCON_CMDID_DISABLE\t\t\tDPCON_CMD(0x003)\n#define DPCON_CMDID_GET_ATTR\t\t\tDPCON_CMD(0x004)\n#define DPCON_CMDID_RESET\t\t\tDPCON_CMD(0x005)\n\n#define DPCON_CMDID_SET_NOTIFICATION\t\tDPCON_CMD(0x100)\n\nstruct dpcon_cmd_open {\n\t__le32 dpcon_id;\n};\n\n#define DPCON_ENABLE\t\t\t1\n\nstruct dpcon_rsp_get_attr {\n\t \n\t__le32 id;\n\t__le16 qbman_ch_id;\n\tu8 num_priorities;\n\tu8 pad;\n};\n\nstruct dpcon_cmd_set_notification {\n\t \n\t__le32 dpio_id;\n\tu8 priority;\n\tu8 pad[3];\n\t \n\t__le64 user_ctx;\n};\n\n \n\n \n#define OBJ_CMD_BASE_VERSION\t\t1\n#define OBJ_CMD_ID_OFFSET\t\t4\n\n#define OBJ_CMD(id)\t(((id) << OBJ_CMD_ID_OFFSET) | OBJ_CMD_BASE_VERSION)\n\n \n#define DPRTC_CMDID_OPEN\t\tOBJ_CMD(0x810)\n#define DPNI_CMDID_OPEN\t\tOBJ_CMD(0x801)\n#define DPSW_CMDID_OPEN\t\tOBJ_CMD(0x802)\n#define DPIO_CMDID_OPEN\t\tOBJ_CMD(0x803)\n#define DPBP_CMDID_OPEN\t\tOBJ_CMD(0x804)\n#define DPRC_CMDID_OPEN\t\tOBJ_CMD(0x805)\n#define DPDMUX_CMDID_OPEN\t\tOBJ_CMD(0x806)\n#define DPCI_CMDID_OPEN\t\tOBJ_CMD(0x807)\n#define DPCON_CMDID_OPEN\t\tOBJ_CMD(0x808)\n#define DPSECI_CMDID_OPEN\t\tOBJ_CMD(0x809)\n#define DPAIOP_CMDID_OPEN\t\tOBJ_CMD(0x80a)\n#define DPMCP_CMDID_OPEN\t\tOBJ_CMD(0x80b)\n#define DPMAC_CMDID_OPEN\t\tOBJ_CMD(0x80c)\n#define DPDCEI_CMDID_OPEN\t\tOBJ_CMD(0x80d)\n#define DPDMAI_CMDID_OPEN\t\tOBJ_CMD(0x80e)\n#define DPDBG_CMDID_OPEN\t\tOBJ_CMD(0x80f)\n\n \n#define OBJ_CMDID_CLOSE\t\tOBJ_CMD(0x800)\n#define OBJ_CMDID_RESET\t\tOBJ_CMD(0x005)\n\nstruct fsl_mc_obj_cmd_open {\n\t__le32 obj_id;\n};\n\n \nstruct fsl_mc_resource_pool {\n\tenum fsl_mc_pool_type type;\n\tint max_count;\n\tint free_count;\n\tstruct mutex mutex;\t \n\tstruct list_head free_list;\n\tstruct fsl_mc_bus *mc_bus;\n};\n\n \nstruct fsl_mc_uapi {\n\tstruct miscdevice misc;\n\tstruct device *device;\n\tstruct mutex mutex;  \n\tu32 local_instance_in_use;\n\tstruct fsl_mc_io *static_mc_io;\n};\n\n \nstruct fsl_mc_bus {\n\tstruct fsl_mc_device mc_dev;\n\tstruct fsl_mc_resource_pool resource_pools[FSL_MC_NUM_POOL_TYPES];\n\tstruct fsl_mc_device_irq *irq_resources;\n\tstruct mutex scan_mutex;     \n\tstruct dprc_attributes dprc_attr;\n\tstruct fsl_mc_uapi uapi_misc;\n\tint irq_enabled;\n};\n\n#define to_fsl_mc_bus(_mc_dev) \\\n\tcontainer_of(_mc_dev, struct fsl_mc_bus, mc_dev)\n\nint __must_check fsl_mc_device_add(struct fsl_mc_obj_desc *obj_desc,\n\t\t\t\t   struct fsl_mc_io *mc_io,\n\t\t\t\t   struct device *parent_dev,\n\t\t\t\t   struct fsl_mc_device **new_mc_dev);\n\nvoid fsl_mc_device_remove(struct fsl_mc_device *mc_dev);\n\nint __init dprc_driver_init(void);\n\nvoid dprc_driver_exit(void);\n\nint dprc_scan_objects(struct fsl_mc_device *mc_bus_dev,\n\t\t      bool alloc_interrupts);\n\nint __init fsl_mc_allocator_driver_init(void);\n\nvoid fsl_mc_allocator_driver_exit(void);\n\nvoid fsl_mc_init_all_resource_pools(struct fsl_mc_device *mc_bus_dev);\n\nvoid fsl_mc_cleanup_all_resource_pools(struct fsl_mc_device *mc_bus_dev);\n\nint __must_check fsl_mc_resource_allocate(struct fsl_mc_bus *mc_bus,\n\t\t\t\t\t  enum fsl_mc_pool_type pool_type,\n\t\t\t\t\t  struct fsl_mc_resource\n\t\t\t\t\t\t\t  **new_resource);\n\nvoid fsl_mc_resource_free(struct fsl_mc_resource *resource);\n\nint fsl_mc_msi_domain_alloc_irqs(struct device *dev,\n\t\t\t\t unsigned int irq_count);\n\nvoid fsl_mc_msi_domain_free_irqs(struct device *dev);\n\nstruct irq_domain *fsl_mc_find_msi_domain(struct device *dev);\n\nint __must_check fsl_create_mc_io(struct device *dev,\n\t\t\t\t  phys_addr_t mc_portal_phys_addr,\n\t\t\t\t  u32 mc_portal_size,\n\t\t\t\t  struct fsl_mc_device *dpmcp_dev,\n\t\t\t\t  u32 flags, struct fsl_mc_io **new_mc_io);\n\nvoid fsl_destroy_mc_io(struct fsl_mc_io *mc_io);\n\nbool fsl_mc_is_root_dprc(struct device *dev);\n\nvoid fsl_mc_get_root_dprc(struct device *dev,\n\t\t\t struct device **root_dprc_dev);\n\nstruct fsl_mc_device *fsl_mc_device_lookup(struct fsl_mc_obj_desc *obj_desc,\n\t\t\t\t\t   struct fsl_mc_device *mc_bus_dev);\n\nu16 mc_cmd_hdr_read_cmdid(struct fsl_mc_command *cmd);\n\n#ifdef CONFIG_FSL_MC_UAPI_SUPPORT\n\nint fsl_mc_uapi_create_device_file(struct fsl_mc_bus *mc_bus);\n\nvoid fsl_mc_uapi_remove_device_file(struct fsl_mc_bus *mc_bus);\n\n#else\n\nstatic inline int fsl_mc_uapi_create_device_file(struct fsl_mc_bus *mc_bus)\n{\n\treturn 0;\n}\n\nstatic inline void fsl_mc_uapi_remove_device_file(struct fsl_mc_bus *mc_bus)\n{\n}\n\n#endif\n\nint disable_dprc_irq(struct fsl_mc_device *mc_dev);\nint enable_dprc_irq(struct fsl_mc_device *mc_dev);\nint get_dprc_irq_state(struct fsl_mc_device *mc_dev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}