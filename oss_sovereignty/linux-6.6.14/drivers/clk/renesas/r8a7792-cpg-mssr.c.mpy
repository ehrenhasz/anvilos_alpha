{
  "module_name": "r8a7792-cpg-mssr.c",
  "hash_id": "d4af952eae598fd7add2793e68fef30463baea3f243cc746a3aca8e0d7b2a083",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/renesas/r8a7792-cpg-mssr.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/soc/renesas/rcar-rst.h>\n\n#include <dt-bindings/clock/r8a7792-cpg-mssr.h>\n\n#include \"renesas-cpg-mssr.h\"\n#include \"rcar-gen2-cpg.h\"\n\nenum clk_ids {\n\t \n\tLAST_DT_CORE_CLK = R8A7792_CLK_OSC,\n\n\t \n\tCLK_EXTAL,\n\n\t \n\tCLK_MAIN,\n\tCLK_PLL0,\n\tCLK_PLL1,\n\tCLK_PLL3,\n\tCLK_PLL1_DIV2,\n\n\t \n\tMOD_CLK_BASE\n};\n\nstatic const struct cpg_core_clk r8a7792_core_clks[] __initconst = {\n\t \n\tDEF_INPUT(\"extal\",     CLK_EXTAL),\n\n\t \n\tDEF_BASE(\".main\",       CLK_MAIN, CLK_TYPE_GEN2_MAIN, CLK_EXTAL),\n\tDEF_BASE(\".pll0\",       CLK_PLL0, CLK_TYPE_GEN2_PLL0, CLK_MAIN),\n\tDEF_BASE(\".pll1\",       CLK_PLL1, CLK_TYPE_GEN2_PLL1, CLK_MAIN),\n\tDEF_BASE(\".pll3\",       CLK_PLL3, CLK_TYPE_GEN2_PLL3, CLK_MAIN),\n\n\tDEF_FIXED(\".pll1_div2\", CLK_PLL1_DIV2, CLK_PLL1, 2, 1),\n\n\t \n\tDEF_BASE(\"qspi\", R8A7792_CLK_QSPI, CLK_TYPE_GEN2_QSPI, CLK_PLL1_DIV2),\n\n\tDEF_FIXED(\"z\",      R8A7792_CLK_Z,     CLK_PLL0,          1, 1),\n\tDEF_FIXED(\"zg\",     R8A7792_CLK_ZG,    CLK_PLL1,          5, 1),\n\tDEF_FIXED(\"zx\",     R8A7792_CLK_ZX,    CLK_PLL1,          3, 1),\n\tDEF_FIXED(\"zs\",     R8A7792_CLK_ZS,    CLK_PLL1,          6, 1),\n\tDEF_FIXED(\"hp\",     R8A7792_CLK_HP,    CLK_PLL1,         12, 1),\n\tDEF_FIXED(\"i\",      R8A7792_CLK_I,     CLK_PLL1,          3, 1),\n\tDEF_FIXED(\"b\",      R8A7792_CLK_B,     CLK_PLL1,         12, 1),\n\tDEF_FIXED(\"lb\",     R8A7792_CLK_LB,    CLK_PLL1,         24, 1),\n\tDEF_FIXED(\"p\",      R8A7792_CLK_P,     CLK_PLL1,         24, 1),\n\tDEF_FIXED(\"cl\",     R8A7792_CLK_CL,    CLK_PLL1,         48, 1),\n\tDEF_FIXED(\"m2\",     R8A7792_CLK_M2,    CLK_PLL1,          8, 1),\n\tDEF_FIXED(\"imp\",    R8A7792_CLK_IMP,   CLK_PLL1,          4, 1),\n\tDEF_FIXED(\"zb3\",    R8A7792_CLK_ZB3,   CLK_PLL3,          4, 1),\n\tDEF_FIXED(\"zb3d2\",  R8A7792_CLK_ZB3D2, CLK_PLL3,          8, 1),\n\tDEF_FIXED(\"ddr\",    R8A7792_CLK_DDR,   CLK_PLL3,          8, 1),\n\tDEF_FIXED(\"sd\",     R8A7792_CLK_SD,    CLK_PLL1_DIV2,     8, 1),\n\tDEF_FIXED(\"mp\",     R8A7792_CLK_MP,    CLK_PLL1_DIV2,    15, 1),\n\tDEF_FIXED(\"cp\",     R8A7792_CLK_CP,    CLK_PLL1,         48, 1),\n\tDEF_FIXED(\"cpex\",   R8A7792_CLK_CPEX,  CLK_EXTAL,         2, 1),\n\tDEF_FIXED(\"rcan\",   R8A7792_CLK_RCAN,  CLK_PLL1_DIV2,    49, 1),\n\tDEF_FIXED(\"r\",      R8A7792_CLK_R,     CLK_PLL1,      49152, 1),\n\tDEF_FIXED(\"osc\",    R8A7792_CLK_OSC,   CLK_PLL1,      12288, 1),\n};\n\nstatic const struct mssr_mod_clk r8a7792_mod_clks[] __initconst = {\n\tDEF_MOD(\"msiof0\",\t\t   0,\tR8A7792_CLK_MP),\n\tDEF_MOD(\"jpu\",\t\t\t 106,\tR8A7792_CLK_M2),\n\tDEF_MOD(\"tmu1\",\t\t\t 111,\tR8A7792_CLK_P),\n\tDEF_MOD(\"3dg\",\t\t\t 112,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"2d-dmac\",\t\t 115,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"tmu3\",\t\t\t 121,\tR8A7792_CLK_P),\n\tDEF_MOD(\"tmu2\",\t\t\t 122,\tR8A7792_CLK_P),\n\tDEF_MOD(\"cmt0\",\t\t\t 124,\tR8A7792_CLK_R),\n\tDEF_MOD(\"tmu0\",\t\t\t 125,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"vsp1du1\",\t\t 127,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"vsp1du0\",\t\t 128,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"vsps\",\t\t\t 131,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"msiof1\",\t\t 208,\tR8A7792_CLK_MP),\n\tDEF_MOD(\"sys-dmac1\",\t\t 218,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"sys-dmac0\",\t\t 219,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"tpu0\",\t\t\t 304,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"sdhi0\",\t\t 314,\tR8A7792_CLK_SD),\n\tDEF_MOD(\"cmt1\",\t\t\t 329,\tR8A7792_CLK_R),\n\tDEF_MOD(\"rwdt\",\t\t\t 402,\tR8A7792_CLK_R),\n\tDEF_MOD(\"irqc\",\t\t\t 407,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"intc-sys\",\t\t 408,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"audio-dmac0\",\t\t 502,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"thermal\",\t\t 522,\tCLK_EXTAL),\n\tDEF_MOD(\"pwm\",\t\t\t 523,\tR8A7792_CLK_P),\n\tDEF_MOD(\"hscif1\",\t\t 716,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"hscif0\",\t\t 717,\tR8A7792_CLK_ZS),\n\tDEF_MOD(\"scif3\",\t\t 718,\tR8A7792_CLK_P),\n\tDEF_MOD(\"scif2\",\t\t 719,\tR8A7792_CLK_P),\n\tDEF_MOD(\"scif1\",\t\t 720,\tR8A7792_CLK_P),\n\tDEF_MOD(\"scif0\",\t\t 721,\tR8A7792_CLK_P),\n\tDEF_MOD(\"du1\",\t\t\t 723,\tR8A7792_CLK_ZX),\n\tDEF_MOD(\"du0\",\t\t\t 724,\tR8A7792_CLK_ZX),\n\tDEF_MOD(\"vin5\",\t\t\t 804,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"vin4\",\t\t\t 805,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"vin3\",\t\t\t 808,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"vin2\",\t\t\t 809,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"vin1\",\t\t\t 810,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"vin0\",\t\t\t 811,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"etheravb\",\t\t 812,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"imr-lx3\",\t\t 821,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-1\",\t\t 822,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-0\",\t\t 823,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-5\",\t\t 825,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-4\",\t\t 826,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-3\",\t\t 827,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"imr-lsx3-2\",\t\t 828,\tR8A7792_CLK_ZG),\n\tDEF_MOD(\"gyro-adc\",\t\t 901,\tR8A7792_CLK_P),\n\tDEF_MOD(\"gpio7\",\t\t 904,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio6\",\t\t 905,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio5\",\t\t 907,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio4\",\t\t 908,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio3\",\t\t 909,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio2\",\t\t 910,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio1\",\t\t 911,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio0\",\t\t 912,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio11\",\t\t 913,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio10\",\t\t 914,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"can1\",\t\t\t 915,\tR8A7792_CLK_P),\n\tDEF_MOD(\"can0\",\t\t\t 916,\tR8A7792_CLK_P),\n\tDEF_MOD(\"qspi_mod\",\t\t 917,\tR8A7792_CLK_QSPI),\n\tDEF_MOD(\"gpio9\",\t\t 919,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"gpio8\",\t\t 921,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"i2c5\",\t\t\t 925,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"iicdvfs\",\t\t 926,\tR8A7792_CLK_CP),\n\tDEF_MOD(\"i2c4\",\t\t\t 927,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"i2c3\",\t\t\t 928,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"i2c2\",\t\t\t 929,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"i2c1\",\t\t\t 930,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"i2c0\",\t\t\t 931,\tR8A7792_CLK_HP),\n\tDEF_MOD(\"ssi-all\",\t\t1005,\tR8A7792_CLK_P),\n\tDEF_MOD(\"ssi4\",\t\t\t1011,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi3\",\t\t\t1012,\tMOD_CLK_ID(1005)),\n};\n\nstatic const unsigned int r8a7792_crit_mod_clks[] __initconst = {\n\tMOD_CLK_ID(402),\t \n\tMOD_CLK_ID(408),\t \n};\n\n \n\n \n#define CPG_PLL_CONFIG_INDEX(md)\t((((md) & BIT(14)) >> 12) | \\\n\t\t\t\t\t (((md) & BIT(13)) >> 12) | \\\n\t\t\t\t\t (((md) & BIT(19)) >> 19))\nstatic const struct rcar_gen2_cpg_pll_config cpg_pll_configs[8] __initconst = {\n\t{ 1, 208, 106, 200 },\n\t{ 1, 208,  88, 200 },\n\t{ 1, 156,  80, 150 },\n\t{ 1, 156,  66, 150 },\n\t{ 2, 240, 122, 230 },\n\t{ 2, 240, 102, 230 },\n\t{ 2, 208, 106, 200 },\n\t{ 2, 208,  88, 200 },\n};\n\nstatic int __init r8a7792_cpg_mssr_init(struct device *dev)\n{\n\tconst struct rcar_gen2_cpg_pll_config *cpg_pll_config;\n\tu32 cpg_mode;\n\tint error;\n\n\terror = rcar_rst_read_mode_pins(&cpg_mode);\n\tif (error)\n\t\treturn error;\n\n\tcpg_pll_config = &cpg_pll_configs[CPG_PLL_CONFIG_INDEX(cpg_mode)];\n\n\treturn rcar_gen2_cpg_init(cpg_pll_config, 3, cpg_mode);\n}\n\nconst struct cpg_mssr_info r8a7792_cpg_mssr_info __initconst = {\n\t \n\t.core_clks = r8a7792_core_clks,\n\t.num_core_clks = ARRAY_SIZE(r8a7792_core_clks),\n\t.last_dt_core_clk = LAST_DT_CORE_CLK,\n\t.num_total_core_clks = MOD_CLK_BASE,\n\n\t \n\t.mod_clks = r8a7792_mod_clks,\n\t.num_mod_clks = ARRAY_SIZE(r8a7792_mod_clks),\n\t.num_hw_mod_clks = 12 * 32,\n\n\t \n\t.crit_mod_clks = r8a7792_crit_mod_clks,\n\t.num_crit_mod_clks = ARRAY_SIZE(r8a7792_crit_mod_clks),\n\n\t \n\t.init = r8a7792_cpg_mssr_init,\n\t.cpg_clk_register = rcar_gen2_cpg_clk_register,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}