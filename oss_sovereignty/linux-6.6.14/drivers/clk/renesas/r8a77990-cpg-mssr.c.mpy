{
  "module_name": "r8a77990-cpg-mssr.c",
  "hash_id": "b3644520537d161b9c622350698485421546ac0dde8d306c61511d13a3f1a76f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/renesas/r8a77990-cpg-mssr.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/soc/renesas/rcar-rst.h>\n\n#include <dt-bindings/clock/r8a77990-cpg-mssr.h>\n\n#include \"renesas-cpg-mssr.h\"\n#include \"rcar-gen3-cpg.h\"\n\nenum clk_ids {\n\t \n\tLAST_DT_CORE_CLK = R8A77990_CLK_CPEX,\n\n\t \n\tCLK_EXTAL,\n\n\t \n\tCLK_MAIN,\n\tCLK_PLL0,\n\tCLK_PLL1,\n\tCLK_PLL3,\n\tCLK_PLL0D4,\n\tCLK_PLL0D6,\n\tCLK_PLL0D8,\n\tCLK_PLL0D20,\n\tCLK_PLL0D24,\n\tCLK_PLL1D2,\n\tCLK_PE,\n\tCLK_S0,\n\tCLK_S1,\n\tCLK_S2,\n\tCLK_S3,\n\tCLK_SDSRC,\n\tCLK_RPCSRC,\n\tCLK_RINT,\n\tCLK_OCO,\n\n\t \n\tMOD_CLK_BASE\n};\n\nstatic const struct cpg_core_clk r8a77990_core_clks[] __initconst = {\n\t \n\tDEF_INPUT(\"extal\",     CLK_EXTAL),\n\n\t \n\tDEF_BASE(\".main\",      CLK_MAIN, CLK_TYPE_GEN3_MAIN,       CLK_EXTAL),\n\tDEF_BASE(\".pll1\",      CLK_PLL1, CLK_TYPE_GEN3_PLL1,       CLK_MAIN),\n\tDEF_BASE(\".pll3\",      CLK_PLL3, CLK_TYPE_GEN3_PLL3,       CLK_MAIN),\n\n\tDEF_FIXED(\".pll0\",     CLK_PLL0,           CLK_MAIN,\t   1, 100),\n\tDEF_FIXED(\".pll0d4\",   CLK_PLL0D4,         CLK_PLL0,       4, 1),\n\tDEF_FIXED(\".pll0d6\",   CLK_PLL0D6,         CLK_PLL0,       6, 1),\n\tDEF_FIXED(\".pll0d8\",   CLK_PLL0D8,         CLK_PLL0,       8, 1),\n\tDEF_FIXED(\".pll0d20\",  CLK_PLL0D20,        CLK_PLL0,      20, 1),\n\tDEF_FIXED(\".pll0d24\",  CLK_PLL0D24,        CLK_PLL0,      24, 1),\n\tDEF_FIXED(\".pll1d2\",   CLK_PLL1D2,         CLK_PLL1,       2, 1),\n\tDEF_FIXED(\".pe\",       CLK_PE,             CLK_PLL0D20,    1, 1),\n\tDEF_FIXED(\".s0\",       CLK_S0,             CLK_PLL1,       2, 1),\n\tDEF_FIXED(\".s1\",       CLK_S1,             CLK_PLL1,       3, 1),\n\tDEF_FIXED(\".s2\",       CLK_S2,             CLK_PLL1,       4, 1),\n\tDEF_FIXED(\".s3\",       CLK_S3,             CLK_PLL1,       6, 1),\n\tDEF_FIXED(\".sdsrc\",    CLK_SDSRC,          CLK_PLL1,       2, 1),\n\n\tDEF_FIXED_RPCSRC_E3(\".rpcsrc\", CLK_RPCSRC, CLK_PLL0, CLK_PLL1),\n\n\tDEF_DIV6_RO(\".r\",      CLK_RINT,           CLK_EXTAL, CPG_RCKCR, 32),\n\n\tDEF_RATE(\".oco\",       CLK_OCO,            8 * 1000 * 1000),\n\n\t \n\tDEF_FIXED(\"za2\",       R8A77990_CLK_ZA2,   CLK_PLL0D24,    1, 1),\n\tDEF_FIXED(\"za8\",       R8A77990_CLK_ZA8,   CLK_PLL0D8,     1, 1),\n\tDEF_GEN3_Z(\"z2\",       R8A77990_CLK_Z2,    CLK_TYPE_GEN3_Z, CLK_PLL0, 4, 8),\n\tDEF_FIXED(\"ztr\",       R8A77990_CLK_ZTR,   CLK_PLL1,       6, 1),\n\tDEF_FIXED(\"zt\",        R8A77990_CLK_ZT,    CLK_PLL1,       4, 1),\n\tDEF_FIXED(\"zx\",        R8A77990_CLK_ZX,    CLK_PLL1,       3, 1),\n\tDEF_FIXED(\"s0d1\",      R8A77990_CLK_S0D1,  CLK_S0,         1, 1),\n\tDEF_FIXED(\"s0d3\",      R8A77990_CLK_S0D3,  CLK_S0,         3, 1),\n\tDEF_FIXED(\"s0d6\",      R8A77990_CLK_S0D6,  CLK_S0,         6, 1),\n\tDEF_FIXED(\"s0d12\",     R8A77990_CLK_S0D12, CLK_S0,        12, 1),\n\tDEF_FIXED(\"s0d24\",     R8A77990_CLK_S0D24, CLK_S0,        24, 1),\n\tDEF_FIXED(\"s1d1\",      R8A77990_CLK_S1D1,  CLK_S1,         1, 1),\n\tDEF_FIXED(\"s1d2\",      R8A77990_CLK_S1D2,  CLK_S1,         2, 1),\n\tDEF_FIXED(\"s1d4\",      R8A77990_CLK_S1D4,  CLK_S1,         4, 1),\n\tDEF_FIXED(\"s2d1\",      R8A77990_CLK_S2D1,  CLK_S2,         1, 1),\n\tDEF_FIXED(\"s2d2\",      R8A77990_CLK_S2D2,  CLK_S2,         2, 1),\n\tDEF_FIXED(\"s2d4\",      R8A77990_CLK_S2D4,  CLK_S2,         4, 1),\n\tDEF_FIXED(\"s3d1\",      R8A77990_CLK_S3D1,  CLK_S3,         1, 1),\n\tDEF_FIXED(\"s3d2\",      R8A77990_CLK_S3D2,  CLK_S3,         2, 1),\n\tDEF_FIXED(\"s3d4\",      R8A77990_CLK_S3D4,  CLK_S3,         4, 1),\n\n\tDEF_GEN3_SDH(\"sd0h\",   R8A77990_CLK_SD0H,  CLK_SDSRC,         0x0074),\n\tDEF_GEN3_SDH(\"sd1h\",   R8A77990_CLK_SD1H,  CLK_SDSRC,         0x0078),\n\tDEF_GEN3_SDH(\"sd3h\",   R8A77990_CLK_SD3H,  CLK_SDSRC,         0x026c),\n\tDEF_GEN3_SD(\"sd0\",     R8A77990_CLK_SD0,   R8A77990_CLK_SD0H, 0x0074),\n\tDEF_GEN3_SD(\"sd1\",     R8A77990_CLK_SD1,   R8A77990_CLK_SD1H, 0x0078),\n\tDEF_GEN3_SD(\"sd3\",     R8A77990_CLK_SD3,   R8A77990_CLK_SD3H, 0x026c),\n\n\tDEF_BASE(\"rpc\",        R8A77990_CLK_RPC,   CLK_TYPE_GEN3_RPC,   CLK_RPCSRC),\n\tDEF_BASE(\"rpcd2\",      R8A77990_CLK_RPCD2, CLK_TYPE_GEN3_RPCD2, R8A77990_CLK_RPC),\n\n\tDEF_FIXED(\"cl\",        R8A77990_CLK_CL,    CLK_PLL1,      48, 1),\n\tDEF_FIXED(\"cr\",        R8A77990_CLK_CR,    CLK_PLL1D2,     2, 1),\n\tDEF_FIXED(\"cp\",        R8A77990_CLK_CP,    CLK_EXTAL,      2, 1),\n\tDEF_FIXED(\"cpex\",      R8A77990_CLK_CPEX,  CLK_EXTAL,      4, 1),\n\n\tDEF_DIV6_RO(\"osc\",     R8A77990_CLK_OSC,   CLK_EXTAL, CPG_RCKCR,  8),\n\n\tDEF_GEN3_PE(\"s0d6c\",   R8A77990_CLK_S0D6C, CLK_S0, 6, CLK_PE, 2),\n\tDEF_GEN3_PE(\"s3d1c\",   R8A77990_CLK_S3D1C, CLK_S3, 1, CLK_PE, 1),\n\tDEF_GEN3_PE(\"s3d2c\",   R8A77990_CLK_S3D2C, CLK_S3, 2, CLK_PE, 2),\n\tDEF_GEN3_PE(\"s3d4c\",   R8A77990_CLK_S3D4C, CLK_S3, 4, CLK_PE, 4),\n\n\tDEF_DIV6P1(\"canfd\",    R8A77990_CLK_CANFD, CLK_PLL0D6, 0x244),\n\tDEF_DIV6P1(\"csi0\",     R8A77990_CLK_CSI0,  CLK_PLL1D2, 0x00c),\n\tDEF_DIV6P1(\"mso\",      R8A77990_CLK_MSO,   CLK_PLL1D2, 0x014),\n\n\tDEF_GEN3_RCKSEL(\"r\",   R8A77990_CLK_R, CLK_RINT, 1, CLK_OCO, 61 * 4),\n};\n\nstatic const struct mssr_mod_clk r8a77990_mod_clks[] __initconst = {\n\tDEF_MOD(\"tmu4\",\t\t\t 121,\tR8A77990_CLK_S0D6C),\n\tDEF_MOD(\"tmu3\",\t\t\t 122,\tR8A77990_CLK_S3D2C),\n\tDEF_MOD(\"tmu2\",\t\t\t 123,\tR8A77990_CLK_S3D2C),\n\tDEF_MOD(\"tmu1\",\t\t\t 124,\tR8A77990_CLK_S3D2C),\n\tDEF_MOD(\"tmu0\",\t\t\t 125,\tR8A77990_CLK_CP),\n\tDEF_MOD(\"scif5\",\t\t 202,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"scif4\",\t\t 203,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"scif3\",\t\t 204,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"scif1\",\t\t 206,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"scif0\",\t\t 207,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"msiof3\",\t\t 208,\tR8A77990_CLK_MSO),\n\tDEF_MOD(\"msiof2\",\t\t 209,\tR8A77990_CLK_MSO),\n\tDEF_MOD(\"msiof1\",\t\t 210,\tR8A77990_CLK_MSO),\n\tDEF_MOD(\"msiof0\",\t\t 211,\tR8A77990_CLK_MSO),\n\tDEF_MOD(\"sys-dmac2\",\t\t 217,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"sys-dmac1\",\t\t 218,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"sys-dmac0\",\t\t 219,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"sceg-pub\",\t\t 229,\tR8A77990_CLK_CR),\n\n\tDEF_MOD(\"cmt3\",\t\t\t 300,\tR8A77990_CLK_R),\n\tDEF_MOD(\"cmt2\",\t\t\t 301,\tR8A77990_CLK_R),\n\tDEF_MOD(\"cmt1\",\t\t\t 302,\tR8A77990_CLK_R),\n\tDEF_MOD(\"cmt0\",\t\t\t 303,\tR8A77990_CLK_R),\n\tDEF_MOD(\"scif2\",\t\t 310,\tR8A77990_CLK_S3D4C),\n\tDEF_MOD(\"sdif3\",\t\t 311,\tR8A77990_CLK_SD3),\n\tDEF_MOD(\"sdif1\",\t\t 313,\tR8A77990_CLK_SD1),\n\tDEF_MOD(\"sdif0\",\t\t 314,\tR8A77990_CLK_SD0),\n\tDEF_MOD(\"pcie0\",\t\t 319,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"usb3-if0\",\t\t 328,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"usb-dmac0\",\t\t 330,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"usb-dmac1\",\t\t 331,\tR8A77990_CLK_S3D1),\n\n\tDEF_MOD(\"rwdt\",\t\t\t 402,\tR8A77990_CLK_R),\n\tDEF_MOD(\"intc-ex\",\t\t 407,\tR8A77990_CLK_CP),\n\tDEF_MOD(\"intc-ap\",\t\t 408,\tR8A77990_CLK_S0D3),\n\n\tDEF_MOD(\"audmac0\",\t\t 502,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"drif31\",\t\t 508,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif30\",\t\t 509,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif21\",\t\t 510,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif20\",\t\t 511,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif11\",\t\t 512,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif10\",\t\t 513,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif01\",\t\t 514,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"drif00\",\t\t 515,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"hscif4\",\t\t 516,\tR8A77990_CLK_S3D1C),\n\tDEF_MOD(\"hscif3\",\t\t 517,\tR8A77990_CLK_S3D1C),\n\tDEF_MOD(\"hscif2\",\t\t 518,\tR8A77990_CLK_S3D1C),\n\tDEF_MOD(\"hscif1\",\t\t 519,\tR8A77990_CLK_S3D1C),\n\tDEF_MOD(\"hscif0\",\t\t 520,\tR8A77990_CLK_S3D1C),\n\tDEF_MOD(\"thermal\",\t\t 522,\tR8A77990_CLK_CP),\n\tDEF_MOD(\"pwm\",\t\t\t 523,\tR8A77990_CLK_S3D4C),\n\n\tDEF_MOD(\"fcpvd1\",\t\t 602,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"fcpvd0\",\t\t 603,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"fcpvb0\",\t\t 607,\tR8A77990_CLK_S0D1),\n\tDEF_MOD(\"fcpvi0\",\t\t 611,\tR8A77990_CLK_S0D1),\n\tDEF_MOD(\"fcpf0\",\t\t 615,\tR8A77990_CLK_S0D1),\n\tDEF_MOD(\"fcpcs\",\t\t 619,\tR8A77990_CLK_S0D1),\n\tDEF_MOD(\"vspd1\",\t\t 622,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"vspd0\",\t\t 623,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"vspb\",\t\t\t 626,\tR8A77990_CLK_S0D1),\n\tDEF_MOD(\"vspi0\",\t\t 631,\tR8A77990_CLK_S0D1),\n\n\tDEF_MOD(\"ehci0\",\t\t 703,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"hsusb\",\t\t 704,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"cmm1\",\t\t\t 710,\tR8A77990_CLK_S1D1),\n\tDEF_MOD(\"cmm0\",\t\t\t 711,\tR8A77990_CLK_S1D1),\n\tDEF_MOD(\"csi40\",\t\t 716,\tR8A77990_CLK_CSI0),\n\tDEF_MOD(\"du1\",\t\t\t 723,\tR8A77990_CLK_S1D1),\n\tDEF_MOD(\"du0\",\t\t\t 724,\tR8A77990_CLK_S1D1),\n\tDEF_MOD(\"lvds\",\t\t\t 727,\tR8A77990_CLK_S2D1),\n\n\tDEF_MOD(\"mlp\",\t\t\t 802,\tR8A77990_CLK_S2D1),\n\tDEF_MOD(\"vin5\",\t\t\t 806,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"vin4\",\t\t\t 807,\tR8A77990_CLK_S1D2),\n\tDEF_MOD(\"etheravb\",\t\t 812,\tR8A77990_CLK_S3D2),\n\n\tDEF_MOD(\"gpio6\",\t\t 906,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio5\",\t\t 907,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio4\",\t\t 908,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio3\",\t\t 909,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio2\",\t\t 910,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio1\",\t\t 911,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"gpio0\",\t\t 912,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"can-fd\",\t\t 914,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"can-if1\",\t\t 915,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"can-if0\",\t\t 916,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"rpc-if\",\t\t 917,\tR8A77990_CLK_RPCD2),\n\tDEF_MOD(\"i2c6\",\t\t\t 918,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"i2c5\",\t\t\t 919,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"adg\",\t\t\t 922,\tR8A77990_CLK_ZA2),\n\tDEF_MOD(\"i2c-dvfs\",\t\t 926,\tR8A77990_CLK_CP),\n\tDEF_MOD(\"i2c4\",\t\t\t 927,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"i2c3\",\t\t\t 928,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"i2c2\",\t\t\t 929,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"i2c1\",\t\t\t 930,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"i2c0\",\t\t\t 931,\tR8A77990_CLK_S3D2),\n\n\tDEF_MOD(\"i2c7\",\t\t\t1003,\tR8A77990_CLK_S3D2),\n\tDEF_MOD(\"ssi-all\",\t\t1005,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"ssi9\",\t\t\t1006,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi8\",\t\t\t1007,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi7\",\t\t\t1008,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi6\",\t\t\t1009,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi5\",\t\t\t1010,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi4\",\t\t\t1011,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi3\",\t\t\t1012,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi2\",\t\t\t1013,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi1\",\t\t\t1014,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"ssi0\",\t\t\t1015,\tMOD_CLK_ID(1005)),\n\tDEF_MOD(\"dab\",\t\t\t1016,\tR8A77990_CLK_S3D1),\n\tDEF_MOD(\"scu-all\",\t\t1017,\tR8A77990_CLK_S3D4),\n\tDEF_MOD(\"scu-dvc1\",\t\t1018,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-dvc0\",\t\t1019,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-ctu1-mix1\",\t1020,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-ctu0-mix0\",\t1021,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src9\",\t\t1022,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src8\",\t\t1023,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src7\",\t\t1024,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src6\",\t\t1025,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src5\",\t\t1026,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src4\",\t\t1027,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src3\",\t\t1028,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src2\",\t\t1029,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src1\",\t\t1030,\tMOD_CLK_ID(1017)),\n\tDEF_MOD(\"scu-src0\",\t\t1031,\tMOD_CLK_ID(1017)),\n};\n\nstatic const unsigned int r8a77990_crit_mod_clks[] __initconst = {\n\tMOD_CLK_ID(402),\t \n\tMOD_CLK_ID(408),\t \n};\n\n \n\n \n#define CPG_PLL_CONFIG_INDEX(md)\t(((md) & BIT(19)) >> 19)\n\nstatic const struct rcar_gen3_cpg_pll_config cpg_pll_configs[2] __initconst = {\n\t \n\t{ 1,\t\t100,\t3,\t100,\t3,\t},\n\t{ 1,\t\t100,\t3,\t 58,\t3,\t},\n};\n\nstatic int __init r8a77990_cpg_mssr_init(struct device *dev)\n{\n\tconst struct rcar_gen3_cpg_pll_config *cpg_pll_config;\n\tu32 cpg_mode;\n\tint error;\n\n\terror = rcar_rst_read_mode_pins(&cpg_mode);\n\tif (error)\n\t\treturn error;\n\n\tcpg_pll_config = &cpg_pll_configs[CPG_PLL_CONFIG_INDEX(cpg_mode)];\n\n\treturn rcar_gen3_cpg_init(cpg_pll_config, 0, cpg_mode);\n}\n\nconst struct cpg_mssr_info r8a77990_cpg_mssr_info __initconst = {\n\t \n\t.core_clks = r8a77990_core_clks,\n\t.num_core_clks = ARRAY_SIZE(r8a77990_core_clks),\n\t.last_dt_core_clk = LAST_DT_CORE_CLK,\n\t.num_total_core_clks = MOD_CLK_BASE,\n\n\t \n\t.mod_clks = r8a77990_mod_clks,\n\t.num_mod_clks = ARRAY_SIZE(r8a77990_mod_clks),\n\t.num_hw_mod_clks = 12 * 32,\n\n\t \n\t.crit_mod_clks = r8a77990_crit_mod_clks,\n\t.num_crit_mod_clks = ARRAY_SIZE(r8a77990_crit_mod_clks),\n\n\t \n\t.init = r8a77990_cpg_mssr_init,\n\t.cpg_clk_register = rcar_gen3_cpg_clk_register,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}