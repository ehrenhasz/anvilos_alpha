{
  "module_name": "clk-mt7629.c",
  "hash_id": "8e884d37f5130d75d517f6779cb138d876f332aadaebce1d5f5e4dabb97eeace",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/mediatek/clk-mt7629.c",
  "human_readable_source": "\n \n\n#include <linux/clk.h>\n#include <linux/clk-provider.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n\n#include \"clk-cpumux.h\"\n#include \"clk-gate.h\"\n#include \"clk-mtk.h\"\n#include \"clk-pll.h\"\n\n#include <dt-bindings/clock/mt7629-clk.h>\n\n#define MT7629_PLL_FMAX\t\t(2500UL * MHZ)\n#define CON0_MT7629_RST_BAR\tBIT(24)\n\n#define PLL_B(_id, _name, _reg, _pwr_reg, _en_mask, _flags, _pcwbits,\t\\\n\t\t\t_pd_reg, _pd_shift, _tuner_reg, _pcw_reg,\t\\\n\t\t\t_pcw_shift, _div_table, _parent_name) {\t\t\\\n\t\t.id = _id,\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\t\\\n\t\t.reg = _reg,\t\t\t\t\t\t\\\n\t\t.pwr_reg = _pwr_reg,\t\t\t\t\t\\\n\t\t.en_mask = _en_mask,\t\t\t\t\t\\\n\t\t.flags = _flags,\t\t\t\t\t\\\n\t\t.rst_bar_mask = CON0_MT7629_RST_BAR,\t\t\t\\\n\t\t.fmax = MT7629_PLL_FMAX,\t\t\t\t\\\n\t\t.pcwbits = _pcwbits,\t\t\t\t\t\\\n\t\t.pd_reg = _pd_reg,\t\t\t\t\t\\\n\t\t.pd_shift = _pd_shift,\t\t\t\t\t\\\n\t\t.tuner_reg = _tuner_reg,\t\t\t\t\\\n\t\t.pcw_reg = _pcw_reg,\t\t\t\t\t\\\n\t\t.pcw_shift = _pcw_shift,\t\t\t\t\\\n\t\t.div_table = _div_table,\t\t\t\t\\\n\t\t.parent_name = _parent_name,\t\t\t\t\\\n\t}\n\n#define PLL(_id, _name, _reg, _pwr_reg, _en_mask, _flags, _pcwbits,\t\\\n\t\t_pd_reg, _pd_shift, _tuner_reg, _pcw_reg,\t\t\\\n\t\t_pcw_shift)\t\t\t\t\t\t\\\n\tPLL_B(_id, _name, _reg, _pwr_reg, _en_mask, _flags, _pcwbits,\t\\\n\t\t_pd_reg, _pd_shift, _tuner_reg, _pcw_reg, _pcw_shift,\t\\\n\t\tNULL, \"clk20m\")\n\n#define GATE_APMIXED(_id, _name, _parent, _shift)\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &apmixed_cg_regs, _shift, &mtk_clk_gate_ops_no_setclr_inv)\n\n#define GATE_INFRA(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &infra_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\n#define GATE_PERI0(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &peri0_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\n#define GATE_PERI1(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &peri1_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\nstatic DEFINE_SPINLOCK(mt7629_clk_lock);\n\nstatic const char * const axi_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d2\",\n\t\"syspll_d5\",\n\t\"syspll1_d4\",\n\t\"univpll_d5\",\n\t\"univpll2_d2\",\n\t\"univpll_d7\",\n\t\"dmpll_ck\"\n};\n\nstatic const char * const mem_parents[] = {\n\t\"clkxtal\",\n\t\"dmpll_ck\"\n};\n\nstatic const char * const ddrphycfg_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d8\"\n};\n\nstatic const char * const eth_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d2\",\n\t\"univpll1_d2\",\n\t\"syspll1_d4\",\n\t\"univpll_d5\",\n\t\"sgmiipll_d2\",\n\t\"univpll_d7\",\n\t\"dmpll_ck\"\n};\n\nstatic const char * const pwm_parents[] = {\n\t\"clkxtal\",\n\t\"univpll2_d4\"\n};\n\nstatic const char * const f10m_ref_parents[] = {\n\t\"clkxtal\",\n\t\"sgmiipll_d2\"\n};\n\nstatic const char * const nfi_infra_parents[] = {\n\t\"clkxtal\",\n\t\"clkxtal\",\n\t\"clkxtal\",\n\t\"clkxtal\",\n\t\"clkxtal\",\n\t\"clkxtal\",\n\t\"univpll2_d8\",\n\t\"univpll3_d4\",\n\t\"syspll1_d8\",\n\t\"univpll1_d8\",\n\t\"syspll4_d2\",\n\t\"syspll2_d4\",\n\t\"univpll2_d4\",\n\t\"univpll3_d2\",\n\t\"syspll1_d4\",\n\t\"syspll_d7\"\n};\n\nstatic const char * const flash_parents[] = {\n\t\"clkxtal\",\n\t\"univpll_d80_d4\",\n\t\"syspll2_d8\",\n\t\"syspll3_d4\",\n\t\"univpll3_d4\",\n\t\"univpll1_d8\",\n\t\"syspll2_d4\",\n\t\"univpll2_d4\"\n};\n\nstatic const char * const uart_parents[] = {\n\t\"clkxtal\",\n\t\"univpll2_d8\"\n};\n\nstatic const char * const spi0_parents[] = {\n\t\"clkxtal\",\n\t\"syspll3_d2\",\n\t\"clkxtal\",\n\t\"syspll2_d4\",\n\t\"syspll4_d2\",\n\t\"univpll2_d4\",\n\t\"univpll1_d8\",\n\t\"clkxtal\"\n};\n\nstatic const char * const spi1_parents[] = {\n\t\"clkxtal\",\n\t\"syspll3_d2\",\n\t\"clkxtal\",\n\t\"syspll4_d4\",\n\t\"syspll4_d2\",\n\t\"univpll2_d4\",\n\t\"univpll1_d8\",\n\t\"clkxtal\"\n};\n\nstatic const char * const msdc30_0_parents[] = {\n\t\"clkxtal\",\n\t\"univpll2_d16\",\n\t\"univ48m\"\n};\n\nstatic const char * const msdc30_1_parents[] = {\n\t\"clkxtal\",\n\t\"univpll2_d16\",\n\t\"univ48m\",\n\t\"syspll2_d4\",\n\t\"univpll2_d4\",\n\t\"syspll_d7\",\n\t\"syspll2_d2\",\n\t\"univpll2_d2\"\n};\n\nstatic const char * const ap2wbmcu_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d2\",\n\t\"univ48m\",\n\t\"syspll1_d8\",\n\t\"univpll2_d4\",\n\t\"syspll_d7\",\n\t\"syspll2_d2\",\n\t\"univpll2_d2\"\n};\n\nstatic const char * const audio_parents[] = {\n\t\"clkxtal\",\n\t\"syspll3_d4\",\n\t\"syspll4_d4\",\n\t\"syspll1_d16\"\n};\n\nstatic const char * const aud_intbus_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d4\",\n\t\"syspll4_d2\",\n\t\"dmpll_d4\"\n};\n\nstatic const char * const pmicspi_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d8\",\n\t\"syspll3_d4\",\n\t\"syspll1_d16\",\n\t\"univpll3_d4\",\n\t\"clkxtal\",\n\t\"univpll2_d4\",\n\t\"dmpll_d8\"\n};\n\nstatic const char * const scp_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d8\",\n\t\"univpll2_d2\",\n\t\"univpll2_d4\"\n};\n\nstatic const char * const atb_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d2\",\n\t\"syspll_d5\"\n};\n\nstatic const char * const hif_parents[] = {\n\t\"clkxtal\",\n\t\"syspll1_d2\",\n\t\"univpll1_d2\",\n\t\"syspll1_d4\",\n\t\"univpll_d5\",\n\t\"clk_null\",\n\t\"univpll_d7\"\n};\n\nstatic const char * const sata_parents[] = {\n\t\"clkxtal\",\n\t\"univpll2_d4\"\n};\n\nstatic const char * const usb20_parents[] = {\n\t\"clkxtal\",\n\t\"univpll3_d4\",\n\t\"syspll1_d8\"\n};\n\nstatic const char * const aud1_parents[] = {\n\t\"clkxtal\"\n};\n\nstatic const char * const irrx_parents[] = {\n\t\"clkxtal\",\n\t\"syspll4_d16\"\n};\n\nstatic const char * const crypto_parents[] = {\n\t\"clkxtal\",\n\t\"univpll_d3\",\n\t\"univpll1_d2\",\n\t\"syspll1_d2\",\n\t\"univpll_d5\",\n\t\"syspll_d5\",\n\t\"univpll2_d2\",\n\t\"syspll_d2\"\n};\n\nstatic const char * const gpt10m_parents[] = {\n\t\"clkxtal\",\n\t\"clkxtal_d4\"\n};\n\nstatic const char * const peribus_ck_parents[] = {\n\t\"syspll1_d8\",\n\t\"syspll1_d4\"\n};\n\nstatic const char * const infra_mux1_parents[] = {\n\t\"clkxtal\",\n\t\"armpll\",\n\t\"main_core_en\",\n\t\"armpll\"\n};\n\nstatic const struct mtk_gate_regs apmixed_cg_regs = {\n\t.set_ofs = 0x8,\n\t.clr_ofs = 0x8,\n\t.sta_ofs = 0x8,\n};\n\nstatic const struct mtk_gate_regs infra_cg_regs = {\n\t.set_ofs = 0x40,\n\t.clr_ofs = 0x44,\n\t.sta_ofs = 0x48,\n};\n\nstatic const struct mtk_gate_regs peri0_cg_regs = {\n\t.set_ofs = 0x8,\n\t.clr_ofs = 0x10,\n\t.sta_ofs = 0x18,\n};\n\nstatic const struct mtk_gate_regs peri1_cg_regs = {\n\t.set_ofs = 0xC,\n\t.clr_ofs = 0x14,\n\t.sta_ofs = 0x1C,\n};\n\nstatic const struct mtk_pll_data plls[] = {\n\tPLL(CLK_APMIXED_ARMPLL, \"armpll\", 0x0200, 0x020C, 0,\n\t    0, 21, 0x0204, 24, 0, 0x0204, 0),\n\tPLL(CLK_APMIXED_MAINPLL, \"mainpll\", 0x0210, 0x021C, 0,\n\t    HAVE_RST_BAR, 21, 0x0214, 24, 0, 0x0214, 0),\n\tPLL(CLK_APMIXED_UNIV2PLL, \"univ2pll\", 0x0220, 0x022C, 0,\n\t    HAVE_RST_BAR, 7, 0x0224, 24, 0, 0x0224, 14),\n\tPLL(CLK_APMIXED_ETH1PLL, \"eth1pll\", 0x0300, 0x0310, 0,\n\t    0, 21, 0x0300, 1, 0, 0x0304, 0),\n\tPLL(CLK_APMIXED_ETH2PLL, \"eth2pll\", 0x0314, 0x0320, 0,\n\t    0, 21, 0x0314, 1, 0, 0x0318, 0),\n\tPLL(CLK_APMIXED_SGMIPLL, \"sgmipll\", 0x0358, 0x0368, 0,\n\t    0, 21, 0x0358, 1, 0, 0x035C, 0),\n};\n\nstatic const struct mtk_gate apmixed_clks[] = {\n\tGATE_APMIXED(CLK_APMIXED_MAIN_CORE_EN, \"main_core_en\", \"mainpll\", 5),\n};\n\nstatic const struct mtk_gate infra_clks[] = {\n\tGATE_INFRA(CLK_INFRA_DBGCLK_PD, \"infra_dbgclk_pd\", \"hd_faxi\", 0),\n\tGATE_INFRA(CLK_INFRA_TRNG_PD, \"infra_trng_pd\", \"hd_faxi\", 2),\n\tGATE_INFRA(CLK_INFRA_DEVAPC_PD, \"infra_devapc_pd\", \"hd_faxi\", 4),\n\tGATE_INFRA(CLK_INFRA_APXGPT_PD, \"infra_apxgpt_pd\", \"infrao_10m\", 18),\n\tGATE_INFRA(CLK_INFRA_SEJ_PD, \"infra_sej_pd\", \"infrao_10m\", 19),\n};\n\nstatic const struct mtk_fixed_clk top_fixed_clks[] = {\n\tFIXED_CLK(CLK_TOP_TO_U2_PHY, \"to_u2_phy\", \"clkxtal\",\n\t\t  31250000),\n\tFIXED_CLK(CLK_TOP_TO_U2_PHY_1P, \"to_u2_phy_1p\", \"clkxtal\",\n\t\t  31250000),\n\tFIXED_CLK(CLK_TOP_PCIE0_PIPE_EN, \"pcie0_pipe_en\", \"clkxtal\",\n\t\t  125000000),\n\tFIXED_CLK(CLK_TOP_PCIE1_PIPE_EN, \"pcie1_pipe_en\", \"clkxtal\",\n\t\t  125000000),\n\tFIXED_CLK(CLK_TOP_SSUSB_TX250M, \"ssusb_tx250m\", \"clkxtal\",\n\t\t  250000000),\n\tFIXED_CLK(CLK_TOP_SSUSB_EQ_RX250M, \"ssusb_eq_rx250m\", \"clkxtal\",\n\t\t  250000000),\n\tFIXED_CLK(CLK_TOP_SSUSB_CDR_REF, \"ssusb_cdr_ref\", \"clkxtal\",\n\t\t  33333333),\n\tFIXED_CLK(CLK_TOP_SSUSB_CDR_FB, \"ssusb_cdr_fb\", \"clkxtal\",\n\t\t  50000000),\n\tFIXED_CLK(CLK_TOP_SATA_ASIC, \"sata_asic\", \"clkxtal\",\n\t\t  50000000),\n\tFIXED_CLK(CLK_TOP_SATA_RBC, \"sata_rbc\", \"clkxtal\",\n\t\t  50000000),\n};\n\nstatic const struct mtk_fixed_factor top_divs[] = {\n\tFACTOR(CLK_TOP_TO_USB3_SYS, \"to_usb3_sys\", \"eth1pll\", 1, 4),\n\tFACTOR(CLK_TOP_P1_1MHZ, \"p1_1mhz\", \"eth1pll\", 1, 500),\n\tFACTOR(CLK_TOP_4MHZ, \"free_run_4mhz\", \"eth1pll\", 1, 125),\n\tFACTOR(CLK_TOP_P0_1MHZ, \"p0_1mhz\", \"eth1pll\", 1, 500),\n\tFACTOR(CLK_TOP_ETH_500M, \"eth_500m\", \"eth1pll\", 1, 1),\n\tFACTOR(CLK_TOP_TXCLK_SRC_PRE, \"txclk_src_pre\", \"sgmiipll_d2\", 1, 1),\n\tFACTOR(CLK_TOP_RTC, \"rtc\", \"clkxtal\", 1, 1024),\n\tFACTOR(CLK_TOP_PWM_QTR_26M, \"pwm_qtr_26m\", \"clkxtal\", 1, 1),\n\tFACTOR(CLK_TOP_CPUM_TCK_IN, \"cpum_tck_in\", \"cpum_tck\", 1, 1),\n\tFACTOR(CLK_TOP_TO_USB3_DA_TOP, \"to_usb3_da_top\", \"clkxtal\", 1, 1),\n\tFACTOR(CLK_TOP_MEMPLL, \"mempll\", \"clkxtal\", 32, 1),\n\tFACTOR(CLK_TOP_DMPLL, \"dmpll_ck\", \"mempll\", 1, 1),\n\tFACTOR(CLK_TOP_DMPLL_D4, \"dmpll_d4\", \"mempll\", 1, 4),\n\tFACTOR(CLK_TOP_DMPLL_D8, \"dmpll_d8\", \"mempll\", 1, 8),\n\tFACTOR(CLK_TOP_SYSPLL_D2, \"syspll_d2\", \"mainpll\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL1_D2, \"syspll1_d2\", \"mainpll\", 1, 4),\n\tFACTOR(CLK_TOP_SYSPLL1_D4, \"syspll1_d4\", \"mainpll\", 1, 8),\n\tFACTOR(CLK_TOP_SYSPLL1_D8, \"syspll1_d8\", \"mainpll\", 1, 16),\n\tFACTOR(CLK_TOP_SYSPLL1_D16, \"syspll1_d16\", \"mainpll\", 1, 32),\n\tFACTOR(CLK_TOP_SYSPLL2_D2, \"syspll2_d2\", \"mainpll\", 1, 6),\n\tFACTOR(CLK_TOP_SYSPLL2_D4, \"syspll2_d4\", \"mainpll\", 1, 12),\n\tFACTOR(CLK_TOP_SYSPLL2_D8, \"syspll2_d8\", \"mainpll\", 1, 24),\n\tFACTOR(CLK_TOP_SYSPLL_D5, \"syspll_d5\", \"mainpll\", 1, 5),\n\tFACTOR(CLK_TOP_SYSPLL3_D2, \"syspll3_d2\", \"mainpll\", 1, 10),\n\tFACTOR(CLK_TOP_SYSPLL3_D4, \"syspll3_d4\", \"mainpll\", 1, 20),\n\tFACTOR(CLK_TOP_SYSPLL_D7, \"syspll_d7\", \"mainpll\", 1, 7),\n\tFACTOR(CLK_TOP_SYSPLL4_D2, \"syspll4_d2\", \"mainpll\", 1, 14),\n\tFACTOR(CLK_TOP_SYSPLL4_D4, \"syspll4_d4\", \"mainpll\", 1, 28),\n\tFACTOR(CLK_TOP_SYSPLL4_D16, \"syspll4_d16\", \"mainpll\", 1, 112),\n\tFACTOR(CLK_TOP_UNIVPLL, \"univpll\", \"univ2pll\", 1, 2),\n\tFACTOR(CLK_TOP_UNIVPLL1_D2, \"univpll1_d2\", \"univpll\", 1, 4),\n\tFACTOR(CLK_TOP_UNIVPLL1_D4, \"univpll1_d4\", \"univpll\", 1, 8),\n\tFACTOR(CLK_TOP_UNIVPLL1_D8, \"univpll1_d8\", \"univpll\", 1, 16),\n\tFACTOR(CLK_TOP_UNIVPLL_D3, \"univpll_d3\", \"univpll\", 1, 3),\n\tFACTOR(CLK_TOP_UNIVPLL2_D2, \"univpll2_d2\", \"univpll\", 1, 6),\n\tFACTOR(CLK_TOP_UNIVPLL2_D4, \"univpll2_d4\", \"univpll\", 1, 12),\n\tFACTOR(CLK_TOP_UNIVPLL2_D8, \"univpll2_d8\", \"univpll\", 1, 24),\n\tFACTOR(CLK_TOP_UNIVPLL2_D16, \"univpll2_d16\", \"univpll\", 1, 48),\n\tFACTOR(CLK_TOP_UNIVPLL_D5, \"univpll_d5\", \"univpll\", 1, 5),\n\tFACTOR(CLK_TOP_UNIVPLL3_D2, \"univpll3_d2\", \"univpll\", 1, 10),\n\tFACTOR(CLK_TOP_UNIVPLL3_D4, \"univpll3_d4\", \"univpll\", 1, 20),\n\tFACTOR(CLK_TOP_UNIVPLL3_D16, \"univpll3_d16\", \"univpll\", 1, 80),\n\tFACTOR(CLK_TOP_UNIVPLL_D7, \"univpll_d7\", \"univpll\", 1, 7),\n\tFACTOR(CLK_TOP_UNIVPLL_D80_D4, \"univpll_d80_d4\", \"univpll\", 1, 320),\n\tFACTOR(CLK_TOP_UNIV48M, \"univ48m\", \"univpll\", 1, 25),\n\tFACTOR(CLK_TOP_SGMIIPLL_D2, \"sgmiipll_d2\", \"sgmipll\", 1, 2),\n\tFACTOR(CLK_TOP_CLKXTAL_D4, \"clkxtal_d4\", \"clkxtal\", 1, 4),\n\tFACTOR(CLK_TOP_HD_FAXI, \"hd_faxi\", \"axi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_FAXI, \"faxi\", \"axi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_FAUD_INTBUS, \"f_faud_intbus\", \"aud_intbus_sel\", 1, 1),\n\tFACTOR(CLK_TOP_AP2WBHIF_HCLK, \"ap2wbhif_hclk\", \"syspll1_d8\", 1, 1),\n\tFACTOR(CLK_TOP_10M_INFRAO, \"infrao_10m\", \"gpt10m_sel\", 1, 1),\n\tFACTOR(CLK_TOP_MSDC30_1, \"msdc30_1\", \"msdc30_1_sel\", 1, 1),\n\tFACTOR(CLK_TOP_SPI, \"spi\", \"spi0_sel\", 1, 1),\n\tFACTOR(CLK_TOP_SF, \"sf\", \"nfi_infra_sel\", 1, 1),\n\tFACTOR(CLK_TOP_FLASH, \"flash\", \"flash_sel\", 1, 1),\n\tFACTOR(CLK_TOP_TO_USB3_REF, \"to_usb3_ref\", \"sata_sel\", 1, 4),\n\tFACTOR(CLK_TOP_TO_USB3_MCU, \"to_usb3_mcu\", \"axi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_TO_USB3_DMA, \"to_usb3_dma\", \"hif_sel\", 1, 1),\n\tFACTOR(CLK_TOP_FROM_TOP_AHB, \"from_top_ahb\", \"axi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_FROM_TOP_AXI, \"from_top_axi\", \"hif_sel\", 1, 1),\n\tFACTOR(CLK_TOP_PCIE1_MAC_EN, \"pcie1_mac_en\", \"sata_sel\", 1, 1),\n\tFACTOR(CLK_TOP_PCIE0_MAC_EN, \"pcie0_mac_en\", \"sata_sel\", 1, 1),\n};\n\nstatic const struct mtk_gate peri_clks[] = {\n\t \n\tGATE_PERI0(CLK_PERI_PWM1_PD, \"peri_pwm1_pd\", \"pwm_qtr_26m\", 2),\n\tGATE_PERI0(CLK_PERI_PWM2_PD, \"peri_pwm2_pd\", \"pwm_qtr_26m\", 3),\n\tGATE_PERI0(CLK_PERI_PWM3_PD, \"peri_pwm3_pd\", \"pwm_qtr_26m\", 4),\n\tGATE_PERI0(CLK_PERI_PWM4_PD, \"peri_pwm4_pd\", \"pwm_qtr_26m\", 5),\n\tGATE_PERI0(CLK_PERI_PWM5_PD, \"peri_pwm5_pd\", \"pwm_qtr_26m\", 6),\n\tGATE_PERI0(CLK_PERI_PWM6_PD, \"peri_pwm6_pd\", \"pwm_qtr_26m\", 7),\n\tGATE_PERI0(CLK_PERI_PWM7_PD, \"peri_pwm7_pd\", \"pwm_qtr_26m\", 8),\n\tGATE_PERI0(CLK_PERI_PWM_PD, \"peri_pwm_pd\", \"pwm_qtr_26m\", 9),\n\tGATE_PERI0(CLK_PERI_AP_DMA_PD, \"peri_ap_dma_pd\", \"faxi\", 12),\n\tGATE_PERI0(CLK_PERI_MSDC30_1_PD, \"peri_msdc30_1\", \"msdc30_1\", 14),\n\tGATE_PERI0(CLK_PERI_UART0_PD, \"peri_uart0_pd\", \"faxi\", 17),\n\tGATE_PERI0(CLK_PERI_UART1_PD, \"peri_uart1_pd\", \"faxi\", 18),\n\tGATE_PERI0(CLK_PERI_UART2_PD, \"peri_uart2_pd\", \"faxi\", 19),\n\tGATE_PERI0(CLK_PERI_UART3_PD, \"peri_uart3_pd\", \"faxi\", 20),\n\tGATE_PERI0(CLK_PERI_BTIF_PD, \"peri_btif_pd\", \"faxi\", 22),\n\tGATE_PERI0(CLK_PERI_I2C0_PD, \"peri_i2c0_pd\", \"faxi\", 23),\n\tGATE_PERI0(CLK_PERI_SPI0_PD, \"peri_spi0_pd\", \"spi\", 28),\n\tGATE_PERI0(CLK_PERI_SNFI_PD, \"peri_snfi_pd\", \"sf\", 29),\n\tGATE_PERI0(CLK_PERI_NFI_PD, \"peri_nfi_pd\", \"faxi\", 30),\n\tGATE_PERI0(CLK_PERI_NFIECC_PD, \"peri_nfiecc_pd\", \"faxi\", 31),\n\t \n\tGATE_PERI1(CLK_PERI_FLASH_PD, \"peri_flash_pd\", \"flash\", 1),\n};\n\nstatic struct mtk_composite infra_muxes[] = {\n\t \n\tMUX(CLK_INFRA_MUX1_SEL, \"infra_mux1_sel\", infra_mux1_parents, 0x000,\n\t    2, 2),\n};\n\nstatic struct mtk_composite top_muxes[] = {\n\t \n\tMUX_GATE(CLK_TOP_AXI_SEL, \"axi_sel\", axi_parents,\n\t\t 0x040, 0, 3, 7),\n\tMUX_GATE(CLK_TOP_MEM_SEL, \"mem_sel\", mem_parents,\n\t\t 0x040, 8, 1, 15),\n\tMUX_GATE(CLK_TOP_DDRPHYCFG_SEL, \"ddrphycfg_sel\", ddrphycfg_parents,\n\t\t 0x040, 16, 1, 23),\n\tMUX_GATE(CLK_TOP_ETH_SEL, \"eth_sel\", eth_parents,\n\t\t 0x040, 24, 3, 31),\n\t \n\tMUX_GATE(CLK_TOP_PWM_SEL, \"pwm_sel\", pwm_parents,\n\t\t 0x050, 0, 2, 7),\n\tMUX_GATE(CLK_TOP_F10M_REF_SEL, \"f10m_ref_sel\", f10m_ref_parents,\n\t\t 0x050, 8, 1, 15),\n\tMUX_GATE(CLK_TOP_NFI_INFRA_SEL, \"nfi_infra_sel\", nfi_infra_parents,\n\t\t 0x050, 16, 4, 23),\n\tMUX_GATE(CLK_TOP_FLASH_SEL, \"flash_sel\", flash_parents,\n\t\t 0x050, 24, 3, 31),\n\t \n\tMUX_GATE(CLK_TOP_UART_SEL, \"uart_sel\", uart_parents,\n\t\t 0x060, 0, 1, 7),\n\tMUX_GATE(CLK_TOP_SPI0_SEL, \"spi0_sel\", spi0_parents,\n\t\t 0x060, 8, 3, 15),\n\tMUX_GATE(CLK_TOP_SPI1_SEL, \"spi1_sel\", spi1_parents,\n\t\t 0x060, 16, 3, 23),\n\tMUX_GATE(CLK_TOP_MSDC50_0_SEL, \"msdc50_0_sel\", uart_parents,\n\t\t 0x060, 24, 3, 31),\n\t \n\tMUX_GATE(CLK_TOP_MSDC30_0_SEL, \"msdc30_0_sel\", msdc30_0_parents,\n\t\t 0x070, 0, 3, 7),\n\tMUX_GATE(CLK_TOP_MSDC30_1_SEL, \"msdc30_1_sel\", msdc30_1_parents,\n\t\t 0x070, 8, 3, 15),\n\tMUX_GATE(CLK_TOP_AP2WBMCU_SEL, \"ap2wbmcu_sel\", ap2wbmcu_parents,\n\t\t 0x070, 16, 3, 23),\n\tMUX_GATE(CLK_TOP_AP2WBHIF_SEL, \"ap2wbhif_sel\", ap2wbmcu_parents,\n\t\t 0x070, 24, 3, 31),\n\t \n\tMUX_GATE(CLK_TOP_AUDIO_SEL, \"audio_sel\", audio_parents,\n\t\t 0x080, 0, 2, 7),\n\tMUX_GATE(CLK_TOP_AUD_INTBUS_SEL, \"aud_intbus_sel\", aud_intbus_parents,\n\t\t 0x080, 8, 2, 15),\n\tMUX_GATE(CLK_TOP_PMICSPI_SEL, \"pmicspi_sel\", pmicspi_parents,\n\t\t 0x080, 16, 3, 23),\n\tMUX_GATE(CLK_TOP_SCP_SEL, \"scp_sel\", scp_parents,\n\t\t 0x080, 24, 2, 31),\n\t \n\tMUX_GATE(CLK_TOP_ATB_SEL, \"atb_sel\", atb_parents,\n\t\t 0x090, 0, 2, 7),\n\tMUX_GATE(CLK_TOP_HIF_SEL, \"hif_sel\", hif_parents,\n\t\t 0x090, 8, 3, 15),\n\tMUX_GATE(CLK_TOP_SATA_SEL, \"sata_sel\", sata_parents,\n\t\t 0x090, 16, 1, 23),\n\tMUX_GATE(CLK_TOP_U2_SEL, \"usb20_sel\", usb20_parents,\n\t\t 0x090, 24, 2, 31),\n\t \n\tMUX_GATE(CLK_TOP_AUD1_SEL, \"aud1_sel\", aud1_parents,\n\t\t 0x0A0, 0, 1, 7),\n\tMUX_GATE(CLK_TOP_AUD2_SEL, \"aud2_sel\", aud1_parents,\n\t\t 0x0A0, 8, 1, 15),\n\tMUX_GATE(CLK_TOP_IRRX_SEL, \"irrx_sel\", irrx_parents,\n\t\t 0x0A0, 16, 1, 23),\n\tMUX_GATE(CLK_TOP_IRTX_SEL, \"irtx_sel\", irrx_parents,\n\t\t 0x0A0, 24, 1, 31),\n\t \n\tMUX_GATE(CLK_TOP_SATA_MCU_SEL, \"sata_mcu_sel\", scp_parents,\n\t\t 0x0B0, 0, 2, 7),\n\tMUX_GATE(CLK_TOP_PCIE0_MCU_SEL, \"pcie0_mcu_sel\", scp_parents,\n\t\t 0x0B0, 8, 2, 15),\n\tMUX_GATE(CLK_TOP_PCIE1_MCU_SEL, \"pcie1_mcu_sel\", scp_parents,\n\t\t 0x0B0, 16, 2, 23),\n\tMUX_GATE(CLK_TOP_SSUSB_MCU_SEL, \"ssusb_mcu_sel\", scp_parents,\n\t\t 0x0B0, 24, 2, 31),\n\t \n\tMUX_GATE(CLK_TOP_CRYPTO_SEL, \"crypto_sel\", crypto_parents,\n\t\t 0x0C0, 0, 3, 7),\n\tMUX_GATE(CLK_TOP_SGMII_REF_1_SEL, \"sgmii_ref_1_sel\", f10m_ref_parents,\n\t\t 0x0C0, 8, 1, 15),\n\tMUX_GATE(CLK_TOP_10M_SEL, \"gpt10m_sel\", gpt10m_parents,\n\t\t 0x0C0, 16, 1, 23),\n};\n\nstatic struct mtk_composite peri_muxes[] = {\n\t \n\tMUX(CLK_PERIBUS_SEL, \"peribus_ck_sel\", peribus_ck_parents, 0x05C, 0, 1),\n};\n\nstatic int mtk_topckgen_init(struct platform_device *pdev)\n{\n\tstruct clk_hw_onecell_data *clk_data;\n\tvoid __iomem *base;\n\tstruct device_node *node = pdev->dev.of_node;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tclk_data = mtk_alloc_clk_data(CLK_TOP_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_fixed_clks(top_fixed_clks, ARRAY_SIZE(top_fixed_clks),\n\t\t\t\t    clk_data);\n\n\tmtk_clk_register_factors(top_divs, ARRAY_SIZE(top_divs),\n\t\t\t\t clk_data);\n\n\tmtk_clk_register_composites(&pdev->dev, top_muxes,\n\t\t\t\t    ARRAY_SIZE(top_muxes), base,\n\t\t\t\t    &mt7629_clk_lock, clk_data);\n\n\tclk_prepare_enable(clk_data->hws[CLK_TOP_AXI_SEL]->clk);\n\tclk_prepare_enable(clk_data->hws[CLK_TOP_MEM_SEL]->clk);\n\tclk_prepare_enable(clk_data->hws[CLK_TOP_DDRPHYCFG_SEL]->clk);\n\n\treturn of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n}\n\nstatic int mtk_infrasys_init(struct platform_device *pdev)\n{\n\tstruct device_node *node = pdev->dev.of_node;\n\tstruct clk_hw_onecell_data *clk_data;\n\n\tclk_data = mtk_alloc_clk_data(CLK_INFRA_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_gates(&pdev->dev, node, infra_clks,\n\t\t\t       ARRAY_SIZE(infra_clks), clk_data);\n\n\tmtk_clk_register_cpumuxes(&pdev->dev, node, infra_muxes,\n\t\t\t\t  ARRAY_SIZE(infra_muxes), clk_data);\n\n\treturn of_clk_add_hw_provider(node, of_clk_hw_onecell_get,\n\t\t\t\t      clk_data);\n}\n\nstatic int mtk_pericfg_init(struct platform_device *pdev)\n{\n\tstruct clk_hw_onecell_data *clk_data;\n\tvoid __iomem *base;\n\tint r;\n\tstruct device_node *node = pdev->dev.of_node;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tclk_data = mtk_alloc_clk_data(CLK_PERI_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_gates(&pdev->dev, node, peri_clks,\n\t\t\t       ARRAY_SIZE(peri_clks), clk_data);\n\n\tmtk_clk_register_composites(&pdev->dev, peri_muxes,\n\t\t\t\t    ARRAY_SIZE(peri_muxes), base,\n\t\t\t\t    &mt7629_clk_lock, clk_data);\n\n\tr = of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n\tif (r)\n\t\treturn r;\n\n\tclk_prepare_enable(clk_data->hws[CLK_PERI_UART0_PD]->clk);\n\n\treturn 0;\n}\n\nstatic int mtk_apmixedsys_init(struct platform_device *pdev)\n{\n\tstruct clk_hw_onecell_data *clk_data;\n\tstruct device_node *node = pdev->dev.of_node;\n\n\tclk_data = mtk_alloc_clk_data(CLK_APMIXED_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_plls(node, plls, ARRAY_SIZE(plls),\n\t\t\t      clk_data);\n\n\tmtk_clk_register_gates(&pdev->dev, node, apmixed_clks,\n\t\t\t       ARRAY_SIZE(apmixed_clks), clk_data);\n\n\tclk_prepare_enable(clk_data->hws[CLK_APMIXED_ARMPLL]->clk);\n\tclk_prepare_enable(clk_data->hws[CLK_APMIXED_MAIN_CORE_EN]->clk);\n\n\treturn of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n}\n\n\nstatic const struct of_device_id of_match_clk_mt7629[] = {\n\t{\n\t\t.compatible = \"mediatek,mt7629-apmixedsys\",\n\t\t.data = mtk_apmixedsys_init,\n\t}, {\n\t\t.compatible = \"mediatek,mt7629-infracfg\",\n\t\t.data = mtk_infrasys_init,\n\t}, {\n\t\t.compatible = \"mediatek,mt7629-topckgen\",\n\t\t.data = mtk_topckgen_init,\n\t}, {\n\t\t.compatible = \"mediatek,mt7629-pericfg\",\n\t\t.data = mtk_pericfg_init,\n\t}, {\n\t\t \n\t}\n};\nMODULE_DEVICE_TABLE(of, of_match_clk_mt7629);\n\nstatic int clk_mt7629_probe(struct platform_device *pdev)\n{\n\tint (*clk_init)(struct platform_device *);\n\tint r;\n\n\tclk_init = of_device_get_match_data(&pdev->dev);\n\tif (!clk_init)\n\t\treturn -EINVAL;\n\n\tr = clk_init(pdev);\n\tif (r)\n\t\tdev_err(&pdev->dev,\n\t\t\t\"could not register clock provider: %s: %d\\n\",\n\t\t\tpdev->name, r);\n\n\treturn r;\n}\n\nstatic struct platform_driver clk_mt7629_drv = {\n\t.probe = clk_mt7629_probe,\n\t.driver = {\n\t\t.name = \"clk-mt7629\",\n\t\t.of_match_table = of_match_clk_mt7629,\n\t},\n};\n\nstatic int clk_mt7629_init(void)\n{\n\treturn platform_driver_register(&clk_mt7629_drv);\n}\n\narch_initcall(clk_mt7629_init);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}