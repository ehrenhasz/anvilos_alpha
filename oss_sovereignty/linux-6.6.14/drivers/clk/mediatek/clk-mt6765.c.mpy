{
  "module_name": "clk-mt6765.c",
  "hash_id": "ddfe9ffdfa90f36be046d863513159bdc75cf4ecbabc8e5a0e634b05c2065699",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/mediatek/clk-mt6765.c",
  "human_readable_source": "\n \n\n#include <linux/clk-provider.h>\n#include <linux/of.h>\n#include <linux/of_address.h>\n#include <linux/slab.h>\n#include <linux/mfd/syscon.h>\n#include <linux/mod_devicetable.h>\n#include <linux/platform_device.h>\n\n#include \"clk-gate.h\"\n#include \"clk-mtk.h\"\n#include \"clk-mux.h\"\n#include \"clk-pll.h\"\n\n#include <dt-bindings/clock/mt6765-clk.h>\n\n \n#define _DIV4_ 1\n\nstatic DEFINE_SPINLOCK(mt6765_clk_lock);\n\n \nstatic void __iomem *cksys_base;\nstatic void __iomem *apmixed_base;\n\n \n#define CLK_SCP_CFG_0\t\t(cksys_base + 0x200)\n#define CLK_SCP_CFG_1\t\t(cksys_base + 0x204)\n\n \n#define AP_PLL_CON3\t\t(apmixed_base + 0x0C)\n#define PLLON_CON0\t\t(apmixed_base + 0x44)\n#define PLLON_CON1\t\t(apmixed_base + 0x48)\n\n \n#define CLK_CFG_0\t\t0x40\n#define CLK_CFG_0_SET\t\t0x44\n#define CLK_CFG_0_CLR\t\t0x48\n#define CLK_CFG_1\t\t0x50\n#define CLK_CFG_1_SET\t\t0x54\n#define CLK_CFG_1_CLR\t\t0x58\n#define CLK_CFG_2\t\t0x60\n#define CLK_CFG_2_SET\t\t0x64\n#define CLK_CFG_2_CLR\t\t0x68\n#define CLK_CFG_3\t\t0x70\n#define CLK_CFG_3_SET\t\t0x74\n#define CLK_CFG_3_CLR\t\t0x78\n#define CLK_CFG_4\t\t0x80\n#define CLK_CFG_4_SET\t\t0x84\n#define CLK_CFG_4_CLR\t\t0x88\n#define CLK_CFG_5\t\t0x90\n#define CLK_CFG_5_SET\t\t0x94\n#define CLK_CFG_5_CLR\t\t0x98\n#define CLK_CFG_6\t\t0xa0\n#define CLK_CFG_6_SET\t\t0xa4\n#define CLK_CFG_6_CLR\t\t0xa8\n#define CLK_CFG_7\t\t0xb0\n#define CLK_CFG_7_SET\t\t0xb4\n#define CLK_CFG_7_CLR\t\t0xb8\n#define CLK_CFG_8\t\t0xc0\n#define CLK_CFG_8_SET\t\t0xc4\n#define CLK_CFG_8_CLR\t\t0xc8\n#define CLK_CFG_9\t\t0xd0\n#define CLK_CFG_9_SET\t\t0xd4\n#define CLK_CFG_9_CLR\t\t0xd8\n#define CLK_CFG_10\t\t0xe0\n#define CLK_CFG_10_SET\t\t0xe4\n#define CLK_CFG_10_CLR\t\t0xe8\n#define CLK_CFG_UPDATE\t\t0x004\n\nstatic const struct mtk_fixed_clk fixed_clks[] = {\n\tFIXED_CLK(CLK_TOP_F_FRTC, \"f_frtc_ck\", \"clk32k\", 32768),\n\tFIXED_CLK(CLK_TOP_CLK26M, \"clk_26m_ck\", \"clk26m\", 26000000),\n\tFIXED_CLK(CLK_TOP_DMPLL, \"dmpll_ck\", NULL, 466000000),\n};\n\nstatic const struct mtk_fixed_factor top_divs[] = {\n\tFACTOR(CLK_TOP_SYSPLL, \"syspll_ck\", \"mainpll\", 1, 1),\n\tFACTOR(CLK_TOP_SYSPLL_D2, \"syspll_d2\", \"mainpll\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL1_D2, \"syspll1_d2\", \"syspll_d2\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL1_D4, \"syspll1_d4\", \"syspll_d2\", 1, 4),\n\tFACTOR(CLK_TOP_SYSPLL1_D8, \"syspll1_d8\", \"syspll_d2\", 1, 8),\n\tFACTOR(CLK_TOP_SYSPLL1_D16, \"syspll1_d16\", \"syspll_d2\", 1, 16),\n\tFACTOR(CLK_TOP_SYSPLL_D3, \"syspll_d3\", \"mainpll\", 1, 3),\n\tFACTOR(CLK_TOP_SYSPLL2_D2, \"syspll2_d2\", \"syspll_d3\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL2_D4, \"syspll2_d4\", \"syspll_d3\", 1, 4),\n\tFACTOR(CLK_TOP_SYSPLL2_D8, \"syspll2_d8\", \"syspll_d3\", 1, 8),\n\tFACTOR(CLK_TOP_SYSPLL_D5, \"syspll_d5\", \"mainpll\", 1, 5),\n\tFACTOR(CLK_TOP_SYSPLL3_D2, \"syspll3_d2\", \"syspll_d5\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL3_D4, \"syspll3_d4\", \"syspll_d5\", 1, 4),\n\tFACTOR(CLK_TOP_SYSPLL_D7, \"syspll_d7\", \"mainpll\", 1, 7),\n\tFACTOR(CLK_TOP_SYSPLL4_D2, \"syspll4_d2\", \"syspll_d7\", 1, 2),\n\tFACTOR(CLK_TOP_SYSPLL4_D4, \"syspll4_d4\", \"syspll_d7\", 1, 4),\n\tFACTOR(CLK_TOP_UNIVPLL, \"univpll\", \"univ2pll\", 1, 2),\n\tFACTOR(CLK_TOP_USB20_192M, \"usb20_192m_ck\", \"univpll\", 2, 13),\n\tFACTOR(CLK_TOP_USB20_192M_D4, \"usb20_192m_d4\", \"usb20_192m_ck\", 1, 4),\n\tFACTOR(CLK_TOP_USB20_192M_D8, \"usb20_192m_d8\", \"usb20_192m_ck\", 1, 8),\n\tFACTOR(CLK_TOP_USB20_192M_D16,\n\t       \"usb20_192m_d16\", \"usb20_192m_ck\", 1, 16),\n\tFACTOR(CLK_TOP_USB20_192M_D32,\n\t       \"usb20_192m_d32\", \"usb20_192m_ck\", 1, 32),\n\tFACTOR(CLK_TOP_UNIVPLL_D2, \"univpll_d2\", \"univpll\", 1, 2),\n\tFACTOR(CLK_TOP_UNIVPLL1_D2, \"univpll1_d2\", \"univpll_d2\", 1, 2),\n\tFACTOR(CLK_TOP_UNIVPLL1_D4, \"univpll1_d4\", \"univpll_d2\", 1, 4),\n\tFACTOR(CLK_TOP_UNIVPLL_D3, \"univpll_d3\", \"univpll\", 1, 3),\n\tFACTOR(CLK_TOP_UNIVPLL2_D2, \"univpll2_d2\", \"univpll_d3\", 1, 2),\n\tFACTOR(CLK_TOP_UNIVPLL2_D4, \"univpll2_d4\", \"univpll_d3\", 1, 4),\n\tFACTOR(CLK_TOP_UNIVPLL2_D8, \"univpll2_d8\", \"univpll_d3\", 1, 8),\n\tFACTOR(CLK_TOP_UNIVPLL2_D32, \"univpll2_d32\", \"univpll_d3\", 1, 32),\n\tFACTOR(CLK_TOP_UNIVPLL_D5, \"univpll_d5\", \"univpll\", 1, 5),\n\tFACTOR(CLK_TOP_UNIVPLL3_D2, \"univpll3_d2\", \"univpll_d5\", 1, 2),\n\tFACTOR(CLK_TOP_UNIVPLL3_D4, \"univpll3_d4\", \"univpll_d5\", 1, 4),\n\tFACTOR(CLK_TOP_MMPLL, \"mmpll_ck\", \"mmpll\", 1, 1),\n\tFACTOR(CLK_TOP_MMPLL_D2, \"mmpll_d2\", \"mmpll_ck\", 1, 2),\n\tFACTOR(CLK_TOP_MPLL, \"mpll_ck\", \"mpll\", 1, 1),\n\tFACTOR(CLK_TOP_DA_MPLL_104M_DIV, \"mpll_104m_div\", \"mpll_ck\", 1, 2),\n\tFACTOR(CLK_TOP_DA_MPLL_52M_DIV, \"mpll_52m_div\", \"mpll_ck\", 1, 4),\n\tFACTOR(CLK_TOP_MFGPLL, \"mfgpll_ck\", \"mfgpll\", 1, 1),\n\tFACTOR(CLK_TOP_MSDCPLL, \"msdcpll_ck\", \"msdcpll\", 1, 1),\n\tFACTOR(CLK_TOP_MSDCPLL_D2, \"msdcpll_d2\", \"msdcpll_ck\", 1, 2),\n\tFACTOR(CLK_TOP_APLL1, \"apll1_ck\", \"apll1\", 1, 1),\n\tFACTOR(CLK_TOP_APLL1_D2, \"apll1_d2\", \"apll1_ck\", 1, 2),\n\tFACTOR(CLK_TOP_APLL1_D4, \"apll1_d4\", \"apll1_ck\", 1, 4),\n\tFACTOR(CLK_TOP_APLL1_D8, \"apll1_d8\", \"apll1_ck\", 1, 8),\n\tFACTOR(CLK_TOP_ULPOSC1, \"ulposc1_ck\", \"ulposc1\", 1, 1),\n\tFACTOR(CLK_TOP_ULPOSC1_D2, \"ulposc1_d2\", \"ulposc1_ck\", 1, 2),\n\tFACTOR(CLK_TOP_ULPOSC1_D4, \"ulposc1_d4\", \"ulposc1_ck\", 1, 4),\n\tFACTOR(CLK_TOP_ULPOSC1_D8, \"ulposc1_d8\", \"ulposc1_ck\", 1, 8),\n\tFACTOR(CLK_TOP_ULPOSC1_D16, \"ulposc1_d16\", \"ulposc1_ck\", 1, 16),\n\tFACTOR(CLK_TOP_ULPOSC1_D32, \"ulposc1_d32\", \"ulposc1_ck\", 1, 32),\n\tFACTOR(CLK_TOP_F_F26M, \"f_f26m_ck\", \"clk_26m_ck\", 1, 1),\n\tFACTOR(CLK_TOP_AXI, \"axi_ck\", \"axi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_MM, \"mm_ck\", \"mm_sel\", 1, 1),\n\tFACTOR(CLK_TOP_SCP, \"scp_ck\", \"scp_sel\", 1, 1),\n\tFACTOR(CLK_TOP_MFG, \"mfg_ck\", \"mfg_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_FUART, \"f_fuart_ck\", \"uart_sel\", 1, 1),\n\tFACTOR(CLK_TOP_SPI, \"spi_ck\", \"spi_sel\", 1, 1),\n\tFACTOR(CLK_TOP_MSDC50_0, \"msdc50_0_ck\", \"msdc50_0_sel\", 1, 1),\n\tFACTOR(CLK_TOP_MSDC30_1, \"msdc30_1_ck\", \"msdc30_1_sel\", 1, 1),\n\tFACTOR(CLK_TOP_AUDIO, \"audio_ck\", \"audio_sel\", 1, 1),\n\tFACTOR(CLK_TOP_AUD_1, \"aud_1_ck\", \"aud_1_sel\", 1, 1),\n\tFACTOR(CLK_TOP_AUD_ENGEN1, \"aud_engen1_ck\", \"aud_engen1_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_FDISP_PWM, \"f_fdisp_pwm_ck\", \"disp_pwm_sel\", 1, 1),\n\tFACTOR(CLK_TOP_SSPM, \"sspm_ck\", \"sspm_sel\", 1, 1),\n\tFACTOR(CLK_TOP_DXCC, \"dxcc_ck\", \"dxcc_sel\", 1, 1),\n\tFACTOR(CLK_TOP_I2C, \"i2c_ck\", \"i2c_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_FPWM, \"f_fpwm_ck\", \"pwm_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_FSENINF, \"f_fseninf_ck\", \"seninf_sel\", 1, 1),\n\tFACTOR(CLK_TOP_AES_FDE, \"aes_fde_ck\", \"aes_fde_sel\", 1, 1),\n\tFACTOR(CLK_TOP_F_BIST2FPC, \"f_bist2fpc_ck\", \"univpll2_d2\", 1, 1),\n\tFACTOR(CLK_TOP_ARMPLL_DIVIDER_PLL0, \"arm_div_pll0\", \"syspll_d2\", 1, 1),\n\tFACTOR(CLK_TOP_ARMPLL_DIVIDER_PLL1, \"arm_div_pll1\", \"syspll_ck\", 1, 1),\n\tFACTOR(CLK_TOP_ARMPLL_DIVIDER_PLL2, \"arm_div_pll2\", \"univpll_d2\", 1, 1),\n\tFACTOR(CLK_TOP_DA_USB20_48M_DIV,\n\t       \"usb20_48m_div\", \"usb20_192m_d4\", 1, 1),\n\tFACTOR(CLK_TOP_DA_UNIV_48M_DIV, \"univ_48m_div\", \"usb20_192m_d4\", 1, 1),\n};\n\nstatic const char * const axi_parents[] = {\n\t\"clk26m\",\n\t\"syspll_d7\",\n\t\"syspll1_d4\",\n\t\"syspll3_d2\"\n};\n\nstatic const char * const mem_parents[] = {\n\t\"clk26m\",\n\t\"dmpll_ck\",\n\t\"apll1_ck\"\n};\n\nstatic const char * const mm_parents[] = {\n\t\"clk26m\",\n\t\"mmpll_ck\",\n\t\"syspll1_d2\",\n\t\"syspll_d5\",\n\t\"syspll1_d4\",\n\t\"univpll_d5\",\n\t\"univpll1_d2\",\n\t\"mmpll_d2\"\n};\n\nstatic const char * const scp_parents[] = {\n\t\"clk26m\",\n\t\"syspll4_d2\",\n\t\"univpll2_d2\",\n\t\"syspll1_d2\",\n\t\"univpll1_d2\",\n\t\"syspll_d3\",\n\t\"univpll_d3\"\n};\n\nstatic const char * const mfg_parents[] = {\n\t\"clk26m\",\n\t\"mfgpll_ck\",\n\t\"syspll_d3\",\n\t\"univpll_d3\"\n};\n\nstatic const char * const atb_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d4\",\n\t\"syspll1_d2\"\n};\n\nstatic const char * const camtg_parents[] = {\n\t\"clk26m\",\n\t\"usb20_192m_d8\",\n\t\"univpll2_d8\",\n\t\"usb20_192m_d4\",\n\t\"univpll2_d32\",\n\t\"usb20_192m_d16\",\n\t\"usb20_192m_d32\"\n};\n\nstatic const char * const uart_parents[] = {\n\t\"clk26m\",\n\t\"univpll2_d8\"\n};\n\nstatic const char * const spi_parents[] = {\n\t\"clk26m\",\n\t\"syspll3_d2\",\n\t\"syspll4_d2\",\n\t\"syspll2_d4\"\n};\n\nstatic const char * const msdc5hclk_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d2\",\n\t\"univpll1_d4\",\n\t\"syspll2_d2\"\n};\n\nstatic const char * const msdc50_0_parents[] = {\n\t\"clk26m\",\n\t\"msdcpll_ck\",\n\t\"syspll2_d2\",\n\t\"syspll4_d2\",\n\t\"univpll1_d2\",\n\t\"syspll1_d2\",\n\t\"univpll_d5\",\n\t\"univpll1_d4\"\n};\n\nstatic const char * const msdc30_1_parents[] = {\n\t\"clk26m\",\n\t\"msdcpll_d2\",\n\t\"univpll2_d2\",\n\t\"syspll2_d2\",\n\t\"syspll1_d4\",\n\t\"univpll1_d4\",\n\t\"usb20_192m_d4\",\n\t\"syspll2_d4\"\n};\n\nstatic const char * const audio_parents[] = {\n\t\"clk26m\",\n\t\"syspll3_d4\",\n\t\"syspll4_d4\",\n\t\"syspll1_d16\"\n};\n\nstatic const char * const aud_intbus_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d4\",\n\t\"syspll4_d2\"\n};\n\nstatic const char * const aud_1_parents[] = {\n\t\"clk26m\",\n\t\"apll1_ck\"\n};\n\nstatic const char * const aud_engen1_parents[] = {\n\t\"clk26m\",\n\t\"apll1_d2\",\n\t\"apll1_d4\",\n\t\"apll1_d8\"\n};\n\nstatic const char * const disp_pwm_parents[] = {\n\t\"clk26m\",\n\t\"univpll2_d4\",\n\t\"ulposc1_d2\",\n\t\"ulposc1_d8\"\n};\n\nstatic const char * const sspm_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d2\",\n\t\"syspll_d3\"\n};\n\nstatic const char * const dxcc_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d2\",\n\t\"syspll1_d4\",\n\t\"syspll1_d8\"\n};\n\nstatic const char * const usb_top_parents[] = {\n\t\"clk26m\",\n\t\"univpll3_d4\"\n};\n\nstatic const char * const spm_parents[] = {\n\t\"clk26m\",\n\t\"syspll1_d8\"\n};\n\nstatic const char * const i2c_parents[] = {\n\t\"clk26m\",\n\t\"univpll3_d4\",\n\t\"univpll3_d2\",\n\t\"syspll1_d8\",\n\t\"syspll2_d8\"\n};\n\nstatic const char * const pwm_parents[] = {\n\t\"clk26m\",\n\t\"univpll3_d4\",\n\t\"syspll1_d8\"\n};\n\nstatic const char * const seninf_parents[] = {\n\t\"clk26m\",\n\t\"univpll1_d4\",\n\t\"univpll1_d2\",\n\t\"univpll2_d2\"\n};\n\nstatic const char * const aes_fde_parents[] = {\n\t\"clk26m\",\n\t\"msdcpll_ck\",\n\t\"univpll_d3\",\n\t\"univpll2_d2\",\n\t\"univpll1_d2\",\n\t\"syspll1_d2\"\n};\n\nstatic const char * const ulposc_parents[] = {\n\t\"clk26m\",\n\t\"ulposc1_d4\",\n\t\"ulposc1_d8\",\n\t\"ulposc1_d16\",\n\t\"ulposc1_d32\"\n};\n\nstatic const char * const camtm_parents[] = {\n\t\"clk26m\",\n\t\"univpll1_d4\",\n\t\"univpll1_d2\",\n\t\"univpll2_d2\"\n};\n\n#define INVALID_UPDATE_REG 0xFFFFFFFF\n#define INVALID_UPDATE_SHIFT -1\n#define INVALID_MUX_GATE -1\n\nstatic const struct mtk_mux top_muxes[] = {\n\t \n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_AXI_SEL, \"axi_sel\", axi_parents,\n\t\t\t      CLK_CFG_0, CLK_CFG_0_SET, CLK_CFG_0_CLR,\n\t\t\t      0, 2, 7, CLK_CFG_UPDATE, 0,\n\t\t\t      CLK_IS_CRITICAL | CLK_SET_RATE_PARENT),\n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_MEM_SEL, \"mem_sel\", mem_parents,\n\t\t\t      CLK_CFG_0, CLK_CFG_0_SET, CLK_CFG_0_CLR,\n\t\t\t      8, 2, 15, CLK_CFG_UPDATE, 1,\n\t\t\t      CLK_IS_CRITICAL | CLK_SET_RATE_PARENT),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_MM_SEL, \"mm_sel\", mm_parents, CLK_CFG_0,\n\t\t\tCLK_CFG_0_SET, CLK_CFG_0_CLR, 16, 3, 23,\n\t\t\tCLK_CFG_UPDATE, 2),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_SCP_SEL, \"scp_sel\", scp_parents, CLK_CFG_0,\n\t\t\tCLK_CFG_0_SET, CLK_CFG_0_CLR, 24, 3, 31,\n\t\t\tCLK_CFG_UPDATE, 3),\n\t \n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_MFG_SEL, \"mfg_sel\", mfg_parents, CLK_CFG_1,\n\t\t\tCLK_CFG_1_SET, CLK_CFG_1_CLR, 0, 2, 7,\n\t\t\tCLK_CFG_UPDATE, 4),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_ATB_SEL, \"atb_sel\", atb_parents, CLK_CFG_1,\n\t\t\tCLK_CFG_1_SET, CLK_CFG_1_CLR, 8, 2, 15,\n\t\t\tCLK_CFG_UPDATE, 5),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_CAMTG_SEL, \"camtg_sel\",\n\t\t\tcamtg_parents, CLK_CFG_1, CLK_CFG_1_SET,\n\t\t\tCLK_CFG_1_CLR, 16, 3, 23, CLK_CFG_UPDATE, 6),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_CAMTG1_SEL, \"camtg1_sel\", camtg_parents,\n\t\t\tCLK_CFG_1, CLK_CFG_1_SET, CLK_CFG_1_CLR,\n\t\t\t24, 3, 31, CLK_CFG_UPDATE, 7),\n\t \n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_CAMTG2_SEL, \"camtg2_sel\",\n\t\t\tcamtg_parents, CLK_CFG_2, CLK_CFG_2_SET,\n\t\t\tCLK_CFG_2_CLR, 0, 3, 7, CLK_CFG_UPDATE, 8),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_CAMTG3_SEL, \"camtg3_sel\", camtg_parents,\n\t\t\tCLK_CFG_2, CLK_CFG_2_SET, CLK_CFG_2_CLR,\n\t\t\t8, 3, 15, CLK_CFG_UPDATE, 9),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_UART_SEL, \"uart_sel\", uart_parents,\n\t\t\tCLK_CFG_2, CLK_CFG_2_SET, CLK_CFG_2_CLR, 16, 1, 23,\n\t\t\tCLK_CFG_UPDATE, 10),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_SPI_SEL, \"spi_sel\", spi_parents, CLK_CFG_2,\n\t\t\tCLK_CFG_2_SET, CLK_CFG_2_CLR, 24, 2, 31,\n\t\t\tCLK_CFG_UPDATE, 11),\n\t \n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_MSDC50_0_HCLK_SEL, \"msdc5hclk\",\n\t\t\tmsdc5hclk_parents, CLK_CFG_3, CLK_CFG_3_SET,\n\t\t\tCLK_CFG_3_CLR, 0, 2, 7, CLK_CFG_UPDATE, 12, 0),\n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_MSDC50_0_SEL, \"msdc50_0_sel\",\n\t\t\tmsdc50_0_parents, CLK_CFG_3, CLK_CFG_3_SET,\n\t\t\tCLK_CFG_3_CLR, 8, 3, 15, CLK_CFG_UPDATE, 13, 0),\n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_MSDC30_1_SEL, \"msdc30_1_sel\",\n\t\t\tmsdc30_1_parents, CLK_CFG_3, CLK_CFG_3_SET,\n\t\t\tCLK_CFG_3_CLR, 16, 3, 23, CLK_CFG_UPDATE, 14, 0),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_AUDIO_SEL, \"audio_sel\", audio_parents,\n\t\t\tCLK_CFG_3, CLK_CFG_3_SET, CLK_CFG_3_CLR,\n\t\t\t24, 2, 31, CLK_CFG_UPDATE, 15),\n\t \n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_AUD_INTBUS_SEL, \"aud_intbus_sel\",\n\t\t\taud_intbus_parents, CLK_CFG_4, CLK_CFG_4_SET,\n\t\t\tCLK_CFG_4_CLR, 0, 2, 7, CLK_CFG_UPDATE, 16),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_AUD_1_SEL, \"aud_1_sel\", aud_1_parents,\n\t\t\tCLK_CFG_4, CLK_CFG_4_SET, CLK_CFG_4_CLR,\n\t\t\t8, 1, 15, CLK_CFG_UPDATE, 17),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_AUD_ENGEN1_SEL, \"aud_engen1_sel\",\n\t\t\taud_engen1_parents, CLK_CFG_4, CLK_CFG_4_SET,\n\t\t\tCLK_CFG_4_CLR, 16, 2, 23, CLK_CFG_UPDATE, 18),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_DISP_PWM_SEL, \"disp_pwm_sel\",\n\t\t\tdisp_pwm_parents, CLK_CFG_4, CLK_CFG_4_SET,\n\t\t\tCLK_CFG_4_CLR, 24, 2, 31, CLK_CFG_UPDATE, 19),\n\t \n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_SSPM_SEL, \"sspm_sel\", sspm_parents,\n\t\t\tCLK_CFG_5, CLK_CFG_5_SET, CLK_CFG_5_CLR, 0, 2, 7,\n\t\t\tCLK_CFG_UPDATE, 20),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_DXCC_SEL, \"dxcc_sel\", dxcc_parents,\n\t\t\tCLK_CFG_5, CLK_CFG_5_SET, CLK_CFG_5_CLR, 8, 2, 15,\n\t\t\tCLK_CFG_UPDATE, 21),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_USB_TOP_SEL, \"usb_top_sel\",\n\t\t\tusb_top_parents, CLK_CFG_5, CLK_CFG_5_SET,\n\t\t\tCLK_CFG_5_CLR, 16, 1, 23, CLK_CFG_UPDATE, 22),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_SPM_SEL, \"spm_sel\", spm_parents, CLK_CFG_5,\n\t\t\tCLK_CFG_5_SET, CLK_CFG_5_CLR, 24, 1, 31,\n\t\t\tCLK_CFG_UPDATE, 23),\n\t \n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_I2C_SEL, \"i2c_sel\", i2c_parents, CLK_CFG_6,\n\t\t\tCLK_CFG_6_SET, CLK_CFG_6_CLR, 0, 3, 7, CLK_CFG_UPDATE,\n\t\t\t24),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_PWM_SEL, \"pwm_sel\", pwm_parents, CLK_CFG_6,\n\t\t\tCLK_CFG_6_SET, CLK_CFG_6_CLR, 8, 2, 15, CLK_CFG_UPDATE,\n\t\t\t25),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_SENINF_SEL, \"seninf_sel\", seninf_parents,\n\t\t\tCLK_CFG_6, CLK_CFG_6_SET, CLK_CFG_6_CLR, 16, 2, 23,\n\t\t\tCLK_CFG_UPDATE, 26),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_AES_FDE_SEL, \"aes_fde_sel\",\n\t\t\taes_fde_parents, CLK_CFG_6, CLK_CFG_6_SET,\n\t\t\tCLK_CFG_6_CLR, 24, 3, 31, CLK_CFG_UPDATE, 27),\n\t \n\tMUX_GATE_CLR_SET_UPD_FLAGS(CLK_TOP_PWRAP_ULPOSC_SEL, \"ulposc_sel\",\n\t\t\t      ulposc_parents, CLK_CFG_7, CLK_CFG_7_SET,\n\t\t\t      CLK_CFG_7_CLR, 0, 3, 7, CLK_CFG_UPDATE, 28,\n\t\t\t      CLK_IS_CRITICAL | CLK_SET_RATE_PARENT),\n\tMUX_GATE_CLR_SET_UPD(CLK_TOP_CAMTM_SEL, \"camtm_sel\", camtm_parents,\n\t\t\tCLK_CFG_7, CLK_CFG_7_SET, CLK_CFG_7_CLR, 8, 2, 15,\n\t\t\tCLK_CFG_UPDATE, 29),\n};\n\nstatic const struct mtk_gate_regs top0_cg_regs = {\n\t.set_ofs = 0x0,\n\t.clr_ofs = 0x0,\n\t.sta_ofs = 0x0,\n};\n\nstatic const struct mtk_gate_regs top1_cg_regs = {\n\t.set_ofs = 0x104,\n\t.clr_ofs = 0x104,\n\t.sta_ofs = 0x104,\n};\n\nstatic const struct mtk_gate_regs top2_cg_regs = {\n\t.set_ofs = 0x320,\n\t.clr_ofs = 0x320,\n\t.sta_ofs = 0x320,\n};\n\n#define GATE_TOP0(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &top0_cg_regs, _shift, &mtk_clk_gate_ops_no_setclr)\n\n#define GATE_TOP1(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &top1_cg_regs, _shift, &mtk_clk_gate_ops_no_setclr_inv)\n\n#define GATE_TOP2(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &top2_cg_regs, _shift, &mtk_clk_gate_ops_no_setclr)\n\nstatic const struct mtk_gate top_clks[] = {\n\t \n\tGATE_TOP0(CLK_TOP_MD_32K, \"md_32k\", \"f_frtc_ck\", 8),\n\tGATE_TOP0(CLK_TOP_MD_26M, \"md_26m\", \"f_f26m_ck\", 9),\n\tGATE_TOP0(CLK_TOP_MD2_32K, \"md2_32k\", \"f_frtc_ck\", 10),\n\tGATE_TOP0(CLK_TOP_MD2_26M, \"md2_26m\", \"f_f26m_ck\", 11),\n\t \n\tGATE_TOP1(CLK_TOP_ARMPLL_DIVIDER_PLL0_EN,\n\t\t  \"arm_div_pll0_en\", \"arm_div_pll0\", 3),\n\tGATE_TOP1(CLK_TOP_ARMPLL_DIVIDER_PLL1_EN,\n\t\t  \"arm_div_pll1_en\", \"arm_div_pll1\", 4),\n\tGATE_TOP1(CLK_TOP_ARMPLL_DIVIDER_PLL2_EN,\n\t\t  \"arm_div_pll2_en\", \"arm_div_pll2\", 5),\n\tGATE_TOP1(CLK_TOP_FMEM_OCC_DRC_EN, \"drc_en\", \"univpll2_d2\", 6),\n\tGATE_TOP1(CLK_TOP_USB20_48M_EN, \"usb20_48m_en\", \"usb20_48m_div\", 8),\n\tGATE_TOP1(CLK_TOP_UNIVPLL_48M_EN, \"univpll_48m_en\", \"univ_48m_div\", 9),\n\tGATE_TOP1(CLK_TOP_F_UFS_MP_SAP_CFG_EN, \"ufs_sap\", \"f_f26m_ck\", 12),\n\tGATE_TOP1(CLK_TOP_F_BIST2FPC_EN, \"bist2fpc\", \"f_bist2fpc_ck\", 16),\n\t \n\tGATE_TOP2(CLK_TOP_APLL12_DIV0, \"apll12_div0\", \"aud_1_ck\", 2),\n\tGATE_TOP2(CLK_TOP_APLL12_DIV1, \"apll12_div1\", \"aud_1_ck\", 3),\n\tGATE_TOP2(CLK_TOP_APLL12_DIV2, \"apll12_div2\", \"aud_1_ck\", 4),\n\tGATE_TOP2(CLK_TOP_APLL12_DIV3, \"apll12_div3\", \"aud_1_ck\", 5),\n};\n\nstatic const struct mtk_gate_regs ifr2_cg_regs = {\n\t.set_ofs = 0x80,\n\t.clr_ofs = 0x84,\n\t.sta_ofs = 0x90,\n};\n\nstatic const struct mtk_gate_regs ifr3_cg_regs = {\n\t.set_ofs = 0x88,\n\t.clr_ofs = 0x8c,\n\t.sta_ofs = 0x94,\n};\n\nstatic const struct mtk_gate_regs ifr4_cg_regs = {\n\t.set_ofs = 0xa4,\n\t.clr_ofs = 0xa8,\n\t.sta_ofs = 0xac,\n};\n\nstatic const struct mtk_gate_regs ifr5_cg_regs = {\n\t.set_ofs = 0xc0,\n\t.clr_ofs = 0xc4,\n\t.sta_ofs = 0xc8,\n};\n\n#define GATE_IFR2(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &ifr2_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\n#define GATE_IFR3(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &ifr3_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\n#define GATE_IFR4(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &ifr4_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\n#define GATE_IFR5(_id, _name, _parent, _shift)\t\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &ifr5_cg_regs, _shift, &mtk_clk_gate_ops_setclr)\n\nstatic const struct mtk_gate ifr_clks[] = {\n\t \n\t \n\t \n\tGATE_IFR2(CLK_IFR_ICUSB, \"ifr_icusb\", \"axi_ck\", 8),\n\tGATE_IFR2(CLK_IFR_GCE, \"ifr_gce\", \"axi_ck\", 9),\n\tGATE_IFR2(CLK_IFR_THERM, \"ifr_therm\", \"axi_ck\", 10),\n\tGATE_IFR2(CLK_IFR_I2C_AP, \"ifr_i2c_ap\", \"i2c_ck\", 11),\n\tGATE_IFR2(CLK_IFR_I2C_CCU, \"ifr_i2c_ccu\", \"i2c_ck\", 12),\n\tGATE_IFR2(CLK_IFR_I2C_SSPM, \"ifr_i2c_sspm\", \"i2c_ck\", 13),\n\tGATE_IFR2(CLK_IFR_I2C_RSV, \"ifr_i2c_rsv\", \"i2c_ck\", 14),\n\tGATE_IFR2(CLK_IFR_PWM_HCLK, \"ifr_pwm_hclk\", \"axi_ck\", 15),\n\tGATE_IFR2(CLK_IFR_PWM1, \"ifr_pwm1\", \"f_fpwm_ck\", 16),\n\tGATE_IFR2(CLK_IFR_PWM2, \"ifr_pwm2\", \"f_fpwm_ck\", 17),\n\tGATE_IFR2(CLK_IFR_PWM3, \"ifr_pwm3\", \"f_fpwm_ck\", 18),\n\tGATE_IFR2(CLK_IFR_PWM4, \"ifr_pwm4\", \"f_fpwm_ck\", 19),\n\tGATE_IFR2(CLK_IFR_PWM5, \"ifr_pwm5\", \"f_fpwm_ck\", 20),\n\tGATE_IFR2(CLK_IFR_PWM, \"ifr_pwm\", \"f_fpwm_ck\", 21),\n\tGATE_IFR2(CLK_IFR_UART0, \"ifr_uart0\", \"f_fuart_ck\", 22),\n\tGATE_IFR2(CLK_IFR_UART1, \"ifr_uart1\", \"f_fuart_ck\", 23),\n\tGATE_IFR2(CLK_IFR_GCE_26M, \"ifr_gce_26m\", \"f_f26m_ck\", 27),\n\tGATE_IFR2(CLK_IFR_CQ_DMA_FPC, \"ifr_dma\", \"axi_ck\", 28),\n\tGATE_IFR2(CLK_IFR_BTIF, \"ifr_btif\", \"axi_ck\", 31),\n\t \n\tGATE_IFR3(CLK_IFR_SPI0, \"ifr_spi0\", \"spi_ck\", 1),\n\tGATE_IFR3(CLK_IFR_MSDC0, \"ifr_msdc0\", \"msdc5hclk\", 2),\n\tGATE_IFR3(CLK_IFR_MSDC1, \"ifr_msdc1\", \"axi_ck\", 4),\n\tGATE_IFR3(CLK_IFR_TRNG, \"ifr_trng\", \"axi_ck\", 9),\n\tGATE_IFR3(CLK_IFR_AUXADC, \"ifr_auxadc\", \"f_f26m_ck\", 10),\n\tGATE_IFR3(CLK_IFR_CCIF1_AP, \"ifr_ccif1_ap\", \"axi_ck\", 12),\n\tGATE_IFR3(CLK_IFR_CCIF1_MD, \"ifr_ccif1_md\", \"axi_ck\", 13),\n\tGATE_IFR3(CLK_IFR_AUXADC_MD, \"ifr_auxadc_md\", \"f_f26m_ck\", 14),\n\tGATE_IFR3(CLK_IFR_AP_DMA, \"ifr_ap_dma\", \"axi_ck\", 18),\n\tGATE_IFR3(CLK_IFR_DEVICE_APC, \"ifr_dapc\", \"axi_ck\", 20),\n\tGATE_IFR3(CLK_IFR_CCIF_AP, \"ifr_ccif_ap\", \"axi_ck\", 23),\n\tGATE_IFR3(CLK_IFR_AUDIO, \"ifr_audio\", \"axi_ck\", 25),\n\tGATE_IFR3(CLK_IFR_CCIF_MD, \"ifr_ccif_md\", \"axi_ck\", 26),\n\t \n\tGATE_IFR4(CLK_IFR_RG_PWM_FBCLK6, \"ifr_pwmfb\", \"f_f26m_ck\", 0),\n\tGATE_IFR4(CLK_IFR_DISP_PWM, \"ifr_disp_pwm\", \"f_fdisp_pwm_ck\", 2),\n\tGATE_IFR4(CLK_IFR_CLDMA_BCLK, \"ifr_cldmabclk\", \"axi_ck\", 3),\n\tGATE_IFR4(CLK_IFR_AUDIO_26M_BCLK, \"ifr_audio26m\", \"f_f26m_ck\", 4),\n\tGATE_IFR4(CLK_IFR_SPI1, \"ifr_spi1\", \"spi_ck\", 6),\n\tGATE_IFR4(CLK_IFR_I2C4, \"ifr_i2c4\", \"i2c_ck\", 7),\n\tGATE_IFR4(CLK_IFR_SPI2, \"ifr_spi2\", \"spi_ck\", 9),\n\tGATE_IFR4(CLK_IFR_SPI3, \"ifr_spi3\", \"spi_ck\", 10),\n\tGATE_IFR4(CLK_IFR_I2C5, \"ifr_i2c5\", \"i2c_ck\", 18),\n\tGATE_IFR4(CLK_IFR_I2C5_ARBITER, \"ifr_i2c5a\", \"i2c_ck\", 19),\n\tGATE_IFR4(CLK_IFR_I2C5_IMM, \"ifr_i2c5_imm\", \"i2c_ck\", 20),\n\tGATE_IFR4(CLK_IFR_I2C1_ARBITER, \"ifr_i2c1a\", \"i2c_ck\", 21),\n\tGATE_IFR4(CLK_IFR_I2C1_IMM, \"ifr_i2c1_imm\", \"i2c_ck\", 22),\n\tGATE_IFR4(CLK_IFR_I2C2_ARBITER, \"ifr_i2c2a\", \"i2c_ck\", 23),\n\tGATE_IFR4(CLK_IFR_I2C2_IMM, \"ifr_i2c2_imm\", \"i2c_ck\", 24),\n\tGATE_IFR4(CLK_IFR_SPI4, \"ifr_spi4\", \"spi_ck\", 25),\n\tGATE_IFR4(CLK_IFR_SPI5, \"ifr_spi5\", \"spi_ck\", 26),\n\tGATE_IFR4(CLK_IFR_CQ_DMA, \"ifr_cq_dma\", \"axi_ck\", 27),\n\tGATE_IFR4(CLK_IFR_FAES_FDE, \"ifr_faes_fde_ck\", \"aes_fde_ck\", 29),\n\t \n\tGATE_IFR5(CLK_IFR_MSDC0_SELF, \"ifr_msdc0sf\", \"msdc50_0_ck\", 0),\n\tGATE_IFR5(CLK_IFR_MSDC1_SELF, \"ifr_msdc1sf\", \"msdc50_0_ck\", 1),\n\tGATE_IFR5(CLK_IFR_I2C6, \"ifr_i2c6\", \"i2c_ck\", 6),\n\tGATE_IFR5(CLK_IFR_AP_MSDC0, \"ifr_ap_msdc0\", \"msdc50_0_ck\", 7),\n\tGATE_IFR5(CLK_IFR_MD_MSDC0, \"ifr_md_msdc0\", \"msdc50_0_ck\", 8),\n\tGATE_IFR5(CLK_IFR_MSDC0_SRC, \"ifr_msdc0_clk\", \"msdc50_0_ck\", 9),\n\tGATE_IFR5(CLK_IFR_MSDC1_SRC, \"ifr_msdc1_clk\", \"msdc30_1_ck\", 10),\n\tGATE_IFR5(CLK_IFR_MCU_PM_BCLK, \"ifr_mcu_pm_bclk\", \"axi_ck\", 17),\n\tGATE_IFR5(CLK_IFR_CCIF2_AP, \"ifr_ccif2_ap\", \"axi_ck\", 18),\n\tGATE_IFR5(CLK_IFR_CCIF2_MD, \"ifr_ccif2_md\", \"axi_ck\", 19),\n\tGATE_IFR5(CLK_IFR_CCIF3_AP, \"ifr_ccif3_ap\", \"axi_ck\", 20),\n\tGATE_IFR5(CLK_IFR_CCIF3_MD, \"ifr_ccif3_md\", \"axi_ck\", 21),\n};\n\n \nstatic const struct mtk_gate_regs apmixed_cg_regs = {\n\t.set_ofs = 0x14,\n\t.clr_ofs = 0x14,\n\t.sta_ofs = 0x14,\n};\n\n#define GATE_APMIXED(_id, _name, _parent, _shift)\t\t\t\\\n\tGATE_MTK(_id, _name, _parent, &apmixed_cg_regs, _shift, &mtk_clk_gate_ops_no_setclr_inv)\n\nstatic const struct mtk_gate apmixed_clks[] = {\n\t \n\tGATE_APMIXED(CLK_APMIXED_SSUSB26M, \"apmixed_ssusb26m\", \"f_f26m_ck\",\n\t\t     4),\n\tGATE_APMIXED(CLK_APMIXED_APPLL26M, \"apmixed_appll26m\", \"f_f26m_ck\",\n\t\t     5),\n\tGATE_APMIXED(CLK_APMIXED_MIPIC0_26M, \"apmixed_mipic026m\", \"f_f26m_ck\",\n\t\t     6),\n\tGATE_APMIXED(CLK_APMIXED_MDPLLGP26M, \"apmixed_mdpll26m\", \"f_f26m_ck\",\n\t\t     7),\n\tGATE_APMIXED(CLK_APMIXED_MMSYS_F26M, \"apmixed_mmsys26m\", \"f_f26m_ck\",\n\t\t     8),\n\tGATE_APMIXED(CLK_APMIXED_UFS26M, \"apmixed_ufs26m\", \"f_f26m_ck\",\n\t\t     9),\n\tGATE_APMIXED(CLK_APMIXED_MIPIC1_26M, \"apmixed_mipic126m\", \"f_f26m_ck\",\n\t\t     11),\n\tGATE_APMIXED(CLK_APMIXED_MEMPLL26M, \"apmixed_mempll26m\", \"f_f26m_ck\",\n\t\t     13),\n\tGATE_APMIXED(CLK_APMIXED_CLKSQ_LVPLL_26M, \"apmixed_lvpll26m\",\n\t\t     \"f_f26m_ck\", 14),\n\tGATE_APMIXED(CLK_APMIXED_MIPID0_26M, \"apmixed_mipid026m\", \"f_f26m_ck\",\n\t\t     16),\n};\n\n#define MT6765_PLL_FMAX\t\t(3800UL * MHZ)\n#define MT6765_PLL_FMIN\t\t(1500UL * MHZ)\n\n#define CON0_MT6765_RST_BAR\tBIT(23)\n\n#define PLL_INFO_NULL\t\t(0xFF)\n\n#define PLL_B(_id, _name, _reg, _pwr_reg, _en_mask, _flags, _pcwbits,\t\\\n\t\t_pcwibits, _pd_reg, _pd_shift, _tuner_reg, _tuner_en_reg,\\\n\t\t_tuner_en_bit, _pcw_reg, _pcw_shift, _div_table) {\\\n\t\t.id = _id,\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\t\\\n\t\t.reg = _reg,\t\t\t\t\t\t\\\n\t\t.pwr_reg = _pwr_reg,\t\t\t\t\t\\\n\t\t.en_mask = _en_mask,\t\t\t\t\t\\\n\t\t.flags = _flags,\t\t\t\t\t\\\n\t\t.rst_bar_mask = CON0_MT6765_RST_BAR,\t\t\t\\\n\t\t.fmax = MT6765_PLL_FMAX,\t\t\t\t\\\n\t\t.fmin = MT6765_PLL_FMIN,\t\t\t\t\\\n\t\t.pcwbits = _pcwbits,\t\t\t\t\t\\\n\t\t.pcwibits = _pcwibits,\t\t\t\t\t\\\n\t\t.pd_reg = _pd_reg,\t\t\t\t\t\\\n\t\t.pd_shift = _pd_shift,\t\t\t\t\t\\\n\t\t.tuner_reg = _tuner_reg,\t\t\t\t\\\n\t\t.tuner_en_reg = _tuner_en_reg,\t\t\t\t\\\n\t\t.tuner_en_bit = _tuner_en_bit,\t\t\t\t\\\n\t\t.pcw_reg = _pcw_reg,\t\t\t\t\t\\\n\t\t.pcw_shift = _pcw_shift,\t\t\t\t\\\n\t\t.div_table = _div_table,\t\t\t\t\\\n\t}\n\n#define PLL(_id, _name, _reg, _pwr_reg, _en_mask, _flags, _pcwbits,\t\\\n\t\t\t_pcwibits, _pd_reg, _pd_shift, _tuner_reg,\t\\\n\t\t\t_tuner_en_reg, _tuner_en_bit, _pcw_reg,\t\\\n\t\t\t_pcw_shift)\t\\\n\t\tPLL_B(_id, _name, _reg, _pwr_reg, _en_mask, _flags,\t\\\n\t\t\t_pcwbits, _pcwibits, _pd_reg, _pd_shift,\t\\\n\t\t\t_tuner_reg, _tuner_en_reg, _tuner_en_bit,\t\\\n\t\t\t_pcw_reg, _pcw_shift, NULL)\t\\\n\nstatic const struct mtk_pll_data plls[] = {\n\tPLL(CLK_APMIXED_ARMPLL_L, \"armpll_l\", 0x021C, 0x0228, 0,\n\t    PLL_AO, 22, 8, 0x0220, 24, 0, 0, 0, 0x0220, 0),\n\tPLL(CLK_APMIXED_ARMPLL, \"armpll\", 0x020C, 0x0218, 0,\n\t    PLL_AO, 22, 8, 0x0210, 24, 0, 0, 0, 0x0210, 0),\n\tPLL(CLK_APMIXED_CCIPLL, \"ccipll\", 0x022C, 0x0238, 0,\n\t    PLL_AO, 22, 8, 0x0230, 24, 0, 0, 0, 0x0230, 0),\n\tPLL(CLK_APMIXED_MAINPLL, \"mainpll\", 0x023C, 0x0248, 0,\n\t    (HAVE_RST_BAR | PLL_AO), 22, 8, 0x0240, 24, 0, 0, 0, 0x0240,\n\t    0),\n\tPLL(CLK_APMIXED_MFGPLL, \"mfgpll\", 0x024C, 0x0258, 0,\n\t    0, 22, 8, 0x0250, 24, 0, 0, 0, 0x0250, 0),\n\tPLL(CLK_APMIXED_MMPLL, \"mmpll\", 0x025C, 0x0268, 0,\n\t    0, 22, 8, 0x0260, 24, 0, 0, 0, 0x0260, 0),\n\tPLL(CLK_APMIXED_UNIV2PLL, \"univ2pll\", 0x026C, 0x0278, 0,\n\t    HAVE_RST_BAR, 22, 8, 0x0270, 24, 0, 0, 0, 0x0270, 0),\n\tPLL(CLK_APMIXED_MSDCPLL, \"msdcpll\", 0x027C, 0x0288, 0,\n\t    0, 22, 8, 0x0280, 24, 0, 0, 0, 0x0280, 0),\n\tPLL(CLK_APMIXED_APLL1, \"apll1\", 0x028C, 0x029C, 0,\n\t    0, 32, 8, 0x0290, 24, 0x0040, 0x000C, 0, 0x0294, 0),\n\tPLL(CLK_APMIXED_MPLL, \"mpll\", 0x02A0, 0x02AC, 0,\n\t    PLL_AO, 22, 8, 0x02A4, 24, 0, 0, 0, 0x02A4, 0),\n};\n\nstatic int clk_mt6765_apmixed_probe(struct platform_device *pdev)\n{\n\tstruct clk_hw_onecell_data *clk_data;\n\tint r;\n\tstruct device_node *node = pdev->dev.of_node;\n\tvoid __iomem *base;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tclk_data = mtk_alloc_clk_data(CLK_APMIXED_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_plls(node, plls, ARRAY_SIZE(plls), clk_data);\n\n\tmtk_clk_register_gates(&pdev->dev, node, apmixed_clks,\n\t\t\t       ARRAY_SIZE(apmixed_clks), clk_data);\n\tr = of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n\n\tif (r)\n\t\tpr_err(\"%s(): could not register clock provider: %d\\n\",\n\t\t       __func__, r);\n\n\tapmixed_base = base;\n\t \n\twritel(readl(AP_PLL_CON3) & 0xFFFFFFE1, AP_PLL_CON3);\n\twritel(readl(PLLON_CON0) & 0x01041041, PLLON_CON0);\n\twritel(readl(PLLON_CON1) & 0x01041041, PLLON_CON1);\n\n\treturn r;\n}\n\nstatic int clk_mt6765_top_probe(struct platform_device *pdev)\n{\n\tint r;\n\tstruct device_node *node = pdev->dev.of_node;\n\tvoid __iomem *base;\n\tstruct clk_hw_onecell_data *clk_data;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tclk_data = mtk_alloc_clk_data(CLK_TOP_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_fixed_clks(fixed_clks, ARRAY_SIZE(fixed_clks),\n\t\t\t\t    clk_data);\n\tmtk_clk_register_factors(top_divs, ARRAY_SIZE(top_divs),\n\t\t\t\t clk_data);\n\tmtk_clk_register_muxes(&pdev->dev, top_muxes,\n\t\t\t       ARRAY_SIZE(top_muxes), node,\n\t\t\t       &mt6765_clk_lock, clk_data);\n\tmtk_clk_register_gates(&pdev->dev, node, top_clks,\n\t\t\t       ARRAY_SIZE(top_clks), clk_data);\n\n\tr = of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n\n\tif (r)\n\t\tpr_err(\"%s(): could not register clock provider: %d\\n\",\n\t\t       __func__, r);\n\n\tcksys_base = base;\n\t \n\twritel(readl(CLK_SCP_CFG_0) | 0x3EF, CLK_SCP_CFG_0);\n\t \n\twritel(readl(CLK_SCP_CFG_1) | 0x1, CLK_SCP_CFG_1);\n\n\treturn r;\n}\n\nstatic int clk_mt6765_ifr_probe(struct platform_device *pdev)\n{\n\tstruct clk_hw_onecell_data *clk_data;\n\tint r;\n\tstruct device_node *node = pdev->dev.of_node;\n\tvoid __iomem *base;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tclk_data = mtk_alloc_clk_data(CLK_IFR_NR_CLK);\n\tif (!clk_data)\n\t\treturn -ENOMEM;\n\n\tmtk_clk_register_gates(&pdev->dev, node, ifr_clks,\n\t\t\t       ARRAY_SIZE(ifr_clks), clk_data);\n\tr = of_clk_add_hw_provider(node, of_clk_hw_onecell_get, clk_data);\n\n\tif (r)\n\t\tpr_err(\"%s(): could not register clock provider: %d\\n\",\n\t\t       __func__, r);\n\n\treturn r;\n}\n\nstatic const struct of_device_id of_match_clk_mt6765[] = {\n\t{\n\t\t.compatible = \"mediatek,mt6765-apmixedsys\",\n\t\t.data = clk_mt6765_apmixed_probe,\n\t}, {\n\t\t.compatible = \"mediatek,mt6765-topckgen\",\n\t\t.data = clk_mt6765_top_probe,\n\t}, {\n\t\t.compatible = \"mediatek,mt6765-infracfg\",\n\t\t.data = clk_mt6765_ifr_probe,\n\t}, {\n\t\t \n\t}\n};\nMODULE_DEVICE_TABLE(of, of_match_clk_mt6765);\n\nstatic int clk_mt6765_probe(struct platform_device *pdev)\n{\n\tint (*clk_probe)(struct platform_device *d);\n\tint r;\n\n\tclk_probe = of_device_get_match_data(&pdev->dev);\n\tif (!clk_probe)\n\t\treturn -EINVAL;\n\n\tr = clk_probe(pdev);\n\tif (r)\n\t\tdev_err(&pdev->dev,\n\t\t\t\"could not register clock provider: %s: %d\\n\",\n\t\t\tpdev->name, r);\n\n\treturn r;\n}\n\nstatic struct platform_driver clk_mt6765_drv = {\n\t.probe = clk_mt6765_probe,\n\t.driver = {\n\t\t.name = \"clk-mt6765\",\n\t\t.of_match_table = of_match_clk_mt6765,\n\t},\n};\n\nstatic int __init clk_mt6765_init(void)\n{\n\treturn platform_driver_register(&clk_mt6765_drv);\n}\n\narch_initcall(clk_mt6765_init);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}