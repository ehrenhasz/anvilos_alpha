{
  "module_name": "clk-mtk.h",
  "hash_id": "9e18f099169feacdb020674af8fba523a941324542da7d6e16912238a1e1fc43",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/mediatek/clk-mtk.h",
  "human_readable_source": " \n \n\n#ifndef __DRV_CLK_MTK_H\n#define __DRV_CLK_MTK_H\n\n#include <linux/clk-provider.h>\n#include <linux/io.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/types.h>\n\n#include \"reset.h\"\n\n#define MAX_MUX_GATE_BIT\t31\n#define INVALID_MUX_GATE_BIT\t(MAX_MUX_GATE_BIT + 1)\n\n#define MHZ (1000 * 1000)\n\nstruct platform_device;\n\n \n#define CLK_DUMMY\t\t0\n\nextern const struct clk_ops mtk_clk_dummy_ops;\nextern const struct mtk_gate_regs cg_regs_dummy;\n\n#define GATE_DUMMY(_id, _name) {\t\t\t\t\\\n\t\t.id = _id,\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\\\n\t\t.regs = &cg_regs_dummy,\t\t\t\t\\\n\t\t.ops = &mtk_clk_dummy_ops,\t\t\t\\\n\t}\n\nstruct mtk_fixed_clk {\n\tint id;\n\tconst char *name;\n\tconst char *parent;\n\tunsigned long rate;\n};\n\n#define FIXED_CLK(_id, _name, _parent, _rate) {\t\t\\\n\t\t.id = _id,\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\\\n\t\t.parent = _parent,\t\t\t\\\n\t\t.rate = _rate,\t\t\t\t\\\n\t}\n\nint mtk_clk_register_fixed_clks(const struct mtk_fixed_clk *clks, int num,\n\t\t\t\tstruct clk_hw_onecell_data *clk_data);\nvoid mtk_clk_unregister_fixed_clks(const struct mtk_fixed_clk *clks, int num,\n\t\t\t\t   struct clk_hw_onecell_data *clk_data);\n\nstruct mtk_fixed_factor {\n\tint id;\n\tconst char *name;\n\tconst char *parent_name;\n\tint mult;\n\tint div;\n\tunsigned long flags;\n};\n\n#define FACTOR_FLAGS(_id, _name, _parent, _mult, _div, _fl) {\t\\\n\t\t.id = _id,\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\\\n\t\t.parent_name = _parent,\t\t\t\\\n\t\t.mult = _mult,\t\t\t\t\\\n\t\t.div = _div,\t\t\t\t\\\n\t\t.flags = _fl,\t\t\t\t\\\n\t}\n\n#define FACTOR(_id, _name, _parent, _mult, _div)\t\\\n\tFACTOR_FLAGS(_id, _name, _parent, _mult, _div, CLK_SET_RATE_PARENT)\n\nint mtk_clk_register_factors(const struct mtk_fixed_factor *clks, int num,\n\t\t\t     struct clk_hw_onecell_data *clk_data);\nvoid mtk_clk_unregister_factors(const struct mtk_fixed_factor *clks, int num,\n\t\t\t\tstruct clk_hw_onecell_data *clk_data);\n\nstruct mtk_composite {\n\tint id;\n\tconst char *name;\n\tconst char * const *parent_names;\n\tconst char *parent;\n\tunsigned flags;\n\n\tuint32_t mux_reg;\n\tuint32_t divider_reg;\n\tuint32_t gate_reg;\n\n\tsigned char mux_shift;\n\tsigned char mux_width;\n\tsigned char gate_shift;\n\n\tsigned char divider_shift;\n\tsigned char divider_width;\n\n\tu8 mux_flags;\n\n\tsigned char num_parents;\n};\n\n#define MUX_GATE_FLAGS_2(_id, _name, _parents, _reg, _shift,\t\t\\\n\t\t\t\t_width, _gate, _flags, _muxflags) {\t\\\n\t\t.id = _id,\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\t\\\n\t\t.mux_reg = _reg,\t\t\t\t\t\\\n\t\t.mux_shift = _shift,\t\t\t\t\t\\\n\t\t.mux_width = _width,\t\t\t\t\t\\\n\t\t.gate_reg = _reg,\t\t\t\t\t\\\n\t\t.gate_shift = _gate,\t\t\t\t\t\\\n\t\t.divider_shift = -1,\t\t\t\t\t\\\n\t\t.parent_names = _parents,\t\t\t\t\\\n\t\t.num_parents = ARRAY_SIZE(_parents),\t\t\t\\\n\t\t.flags = _flags,\t\t\t\t\t\\\n\t\t.mux_flags = _muxflags,\t\t\t\t\t\\\n\t}\n\n \n#define MUX_GATE_FLAGS(_id, _name, _parents, _reg, _shift, _width,\t\\\n\t\t\t_gate, _flags)\t\t\t\t\t\\\n\t\tMUX_GATE_FLAGS_2(_id, _name, _parents, _reg,\t\t\\\n\t\t\t\t\t_shift, _width, _gate, _flags, 0)\n\n \n#define MUX_GATE(_id, _name, _parents, _reg, _shift, _width, _gate)\t\\\n\tMUX_GATE_FLAGS(_id, _name, _parents, _reg, _shift, _width,\t\\\n\t\t_gate, CLK_SET_RATE_PARENT)\n\n#define MUX(_id, _name, _parents, _reg, _shift, _width)\t\t\t\\\n\tMUX_FLAGS(_id, _name, _parents, _reg,\t\t\t\t\\\n\t\t  _shift, _width, CLK_SET_RATE_PARENT)\n\n#define MUX_FLAGS(_id, _name, _parents, _reg, _shift, _width, _flags) {\t\\\n\t\t.id = _id,\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\t\\\n\t\t.mux_reg = _reg,\t\t\t\t\t\\\n\t\t.mux_shift = _shift,\t\t\t\t\t\\\n\t\t.mux_width = _width,\t\t\t\t\t\\\n\t\t.gate_shift = -1,\t\t\t\t\t\\\n\t\t.divider_shift = -1,\t\t\t\t\t\\\n\t\t.parent_names = _parents,\t\t\t\t\\\n\t\t.num_parents = ARRAY_SIZE(_parents),\t\t\t\\\n\t\t.flags = _flags,\t\t\t\t\\\n\t}\n\n#define DIV_GATE(_id, _name, _parent, _gate_reg, _gate_shift, _div_reg,\t\\\n\t\t\t\t\t_div_width, _div_shift) {\t\\\n\t\t.id = _id,\t\t\t\t\t\t\\\n\t\t.parent = _parent,\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\t\\\n\t\t.divider_reg = _div_reg,\t\t\t\t\\\n\t\t.divider_shift = _div_shift,\t\t\t\t\\\n\t\t.divider_width = _div_width,\t\t\t\t\\\n\t\t.gate_reg = _gate_reg,\t\t\t\t\t\\\n\t\t.gate_shift = _gate_shift,\t\t\t\t\\\n\t\t.mux_shift = -1,\t\t\t\t\t\\\n\t\t.flags = 0,\t\t\t\t\t\t\\\n\t}\n\nint mtk_clk_register_composites(struct device *dev,\n\t\t\t\tconst struct mtk_composite *mcs, int num,\n\t\t\t\tvoid __iomem *base, spinlock_t *lock,\n\t\t\t\tstruct clk_hw_onecell_data *clk_data);\nvoid mtk_clk_unregister_composites(const struct mtk_composite *mcs, int num,\n\t\t\t\t   struct clk_hw_onecell_data *clk_data);\n\nstruct mtk_clk_divider {\n\tint id;\n\tconst char *name;\n\tconst char *parent_name;\n\tunsigned long flags;\n\n\tu32 div_reg;\n\tunsigned char div_shift;\n\tunsigned char div_width;\n\tunsigned char clk_divider_flags;\n\tconst struct clk_div_table *clk_div_table;\n};\n\n#define DIV_ADJ(_id, _name, _parent, _reg, _shift, _width) {\t\\\n\t\t.id = _id,\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\\\n\t\t.parent_name = _parent,\t\t\t\t\\\n\t\t.div_reg = _reg,\t\t\t\t\\\n\t\t.div_shift = _shift,\t\t\t\t\\\n\t\t.div_width = _width,\t\t\t\t\\\n}\n\nint mtk_clk_register_dividers(struct device *dev,\n\t\t\t      const struct mtk_clk_divider *mcds, int num,\n\t\t\t      void __iomem *base, spinlock_t *lock,\n\t\t\t      struct clk_hw_onecell_data *clk_data);\nvoid mtk_clk_unregister_dividers(const struct mtk_clk_divider *mcds, int num,\n\t\t\t\t struct clk_hw_onecell_data *clk_data);\n\nstruct clk_hw_onecell_data *mtk_alloc_clk_data(unsigned int clk_num);\nstruct clk_hw_onecell_data *mtk_devm_alloc_clk_data(struct device *dev,\n\t\t\t\t\t\t    unsigned int clk_num);\nvoid mtk_free_clk_data(struct clk_hw_onecell_data *clk_data);\n\nstruct clk_hw *mtk_clk_register_ref2usb_tx(const char *name,\n\t\t\tconst char *parent_name, void __iomem *reg);\nvoid mtk_clk_unregister_ref2usb_tx(struct clk_hw *hw);\n\nstruct mtk_clk_desc {\n\tconst struct mtk_gate *clks;\n\tsize_t num_clks;\n\tconst struct mtk_composite *composite_clks;\n\tsize_t num_composite_clks;\n\tconst struct mtk_clk_divider *divider_clks;\n\tsize_t num_divider_clks;\n\tconst struct mtk_fixed_clk *fixed_clks;\n\tsize_t num_fixed_clks;\n\tconst struct mtk_fixed_factor *factor_clks;\n\tsize_t num_factor_clks;\n\tconst struct mtk_mux *mux_clks;\n\tsize_t num_mux_clks;\n\tconst struct mtk_clk_rst_desc *rst_desc;\n\tspinlock_t *clk_lock;\n\tbool shared_io;\n\n\tint (*clk_notifier_func)(struct device *dev, struct clk *clk);\n\tunsigned int mfg_clk_idx;\n};\n\nint mtk_clk_pdev_probe(struct platform_device *pdev);\nvoid mtk_clk_pdev_remove(struct platform_device *pdev);\nint mtk_clk_simple_probe(struct platform_device *pdev);\nvoid mtk_clk_simple_remove(struct platform_device *pdev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}