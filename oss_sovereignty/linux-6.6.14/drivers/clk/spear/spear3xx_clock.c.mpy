{
  "module_name": "spear3xx_clock.c",
  "hash_id": "7d21ff392fe862bad40cff7a1768abb0925a514a41c4a79df7654e9032ea9c8e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/spear/spear3xx_clock.c",
  "human_readable_source": "\n \n\n#include <linux/clk.h>\n#include <linux/clkdev.h>\n#include <linux/clk/spear.h>\n#include <linux/err.h>\n#include <linux/io.h>\n#include <linux/of.h>\n#include <linux/spinlock_types.h>\n#include \"clk.h\"\n\nstatic DEFINE_SPINLOCK(_lock);\n\n#define PLL1_CTR\t\t\t(misc_base + 0x008)\n#define PLL1_FRQ\t\t\t(misc_base + 0x00C)\n#define PLL2_CTR\t\t\t(misc_base + 0x014)\n#define PLL2_FRQ\t\t\t(misc_base + 0x018)\n#define PLL_CLK_CFG\t\t\t(misc_base + 0x020)\n\t \n\t#define MCTR_CLK_SHIFT\t\t28\n\t#define MCTR_CLK_MASK\t\t3\n\n#define CORE_CLK_CFG\t\t\t(misc_base + 0x024)\n\t \n\t#define GEN_SYNTH2_3_CLK_SHIFT\t18\n\t#define GEN_SYNTH2_3_CLK_MASK\t1\n\n\t#define HCLK_RATIO_SHIFT\t10\n\t#define HCLK_RATIO_MASK\t\t2\n\t#define PCLK_RATIO_SHIFT\t8\n\t#define PCLK_RATIO_MASK\t\t2\n\n#define PERIP_CLK_CFG\t\t\t(misc_base + 0x028)\n\t \n\t#define UART_CLK_SHIFT\t\t4\n\t#define UART_CLK_MASK\t\t1\n\t#define FIRDA_CLK_SHIFT\t\t5\n\t#define FIRDA_CLK_MASK\t\t2\n\t#define GPT0_CLK_SHIFT\t\t8\n\t#define GPT1_CLK_SHIFT\t\t11\n\t#define GPT2_CLK_SHIFT\t\t12\n\t#define GPT_CLK_MASK\t\t1\n\n#define PERIP1_CLK_ENB\t\t\t(misc_base + 0x02C)\n\t \n\t#define UART_CLK_ENB\t\t3\n\t#define SSP_CLK_ENB\t\t5\n\t#define I2C_CLK_ENB\t\t7\n\t#define JPEG_CLK_ENB\t\t8\n\t#define FIRDA_CLK_ENB\t\t10\n\t#define GPT1_CLK_ENB\t\t11\n\t#define GPT2_CLK_ENB\t\t12\n\t#define ADC_CLK_ENB\t\t15\n\t#define RTC_CLK_ENB\t\t17\n\t#define GPIO_CLK_ENB\t\t18\n\t#define DMA_CLK_ENB\t\t19\n\t#define SMI_CLK_ENB\t\t21\n\t#define GMAC_CLK_ENB\t\t23\n\t#define USBD_CLK_ENB\t\t24\n\t#define USBH_CLK_ENB\t\t25\n\t#define C3_CLK_ENB\t\t31\n\n#define RAS_CLK_ENB\t\t\t(misc_base + 0x034)\n\t#define RAS_AHB_CLK_ENB\t\t0\n\t#define RAS_PLL1_CLK_ENB\t1\n\t#define RAS_APB_CLK_ENB\t\t2\n\t#define RAS_32K_CLK_ENB\t\t3\n\t#define RAS_24M_CLK_ENB\t\t4\n\t#define RAS_48M_CLK_ENB\t\t5\n\t#define RAS_PLL2_CLK_ENB\t7\n\t#define RAS_SYNT0_CLK_ENB\t8\n\t#define RAS_SYNT1_CLK_ENB\t9\n\t#define RAS_SYNT2_CLK_ENB\t10\n\t#define RAS_SYNT3_CLK_ENB\t11\n\n#define PRSC0_CLK_CFG\t\t\t(misc_base + 0x044)\n#define PRSC1_CLK_CFG\t\t\t(misc_base + 0x048)\n#define PRSC2_CLK_CFG\t\t\t(misc_base + 0x04C)\n#define AMEM_CLK_CFG\t\t\t(misc_base + 0x050)\n\t#define AMEM_CLK_ENB\t\t0\n\n#define CLCD_CLK_SYNT\t\t\t(misc_base + 0x05C)\n#define FIRDA_CLK_SYNT\t\t\t(misc_base + 0x060)\n#define UART_CLK_SYNT\t\t\t(misc_base + 0x064)\n#define GMAC_CLK_SYNT\t\t\t(misc_base + 0x068)\n#define GEN0_CLK_SYNT\t\t\t(misc_base + 0x06C)\n#define GEN1_CLK_SYNT\t\t\t(misc_base + 0x070)\n#define GEN2_CLK_SYNT\t\t\t(misc_base + 0x074)\n#define GEN3_CLK_SYNT\t\t\t(misc_base + 0x078)\n\n \nstatic struct pll_rate_tbl pll_rtbl[] = {\n\t{.mode = 0, .m = 0x53, .n = 0x0C, .p = 0x1},  \n\t{.mode = 0, .m = 0x85, .n = 0x0C, .p = 0x1},  \n\t{.mode = 0, .m = 0xA6, .n = 0x0C, .p = 0x1},  \n};\n\n \nstatic struct aux_rate_tbl aux_rtbl[] = {\n\t \n\t{.xscale = 1, .yscale = 81, .eq = 0},  \n\t{.xscale = 1, .yscale = 59, .eq = 0},  \n\t{.xscale = 2, .yscale = 81, .eq = 0},  \n\t{.xscale = 3, .yscale = 89, .eq = 0},  \n\t{.xscale = 4, .yscale = 81, .eq = 0},  \n\t{.xscale = 4, .yscale = 59, .eq = 0},  \n\t{.xscale = 2, .yscale = 27, .eq = 0},  \n\t{.xscale = 2, .yscale = 8, .eq = 0},  \n\t{.xscale = 2, .yscale = 4, .eq = 0},  \n\t{.xscale = 1, .yscale = 2, .eq = 1},  \n};\n\n \nstatic struct gpt_rate_tbl gpt_rtbl[] = {\n\t \n\t{.mscale = 4, .nscale = 0},  \n\t{.mscale = 2, .nscale = 0},  \n\t{.mscale = 1, .nscale = 0},  \n};\n\n \nstatic const char *uart0_parents[] = { \"pll3_clk\", \"uart_syn_gclk\", };\nstatic const char *firda_parents[] = { \"pll3_clk\", \"firda_syn_gclk\",\n};\nstatic const char *gpt0_parents[] = { \"pll3_clk\", \"gpt0_syn_clk\", };\nstatic const char *gpt1_parents[] = { \"pll3_clk\", \"gpt1_syn_clk\", };\nstatic const char *gpt2_parents[] = { \"pll3_clk\", \"gpt2_syn_clk\", };\nstatic const char *gen2_3_parents[] = { \"pll1_clk\", \"pll2_clk\", };\nstatic const char *ddr_parents[] = { \"ahb_clk\", \"ahbmult2_clk\", \"none\",\n\t\"pll2_clk\", };\n\n#ifdef CONFIG_MACH_SPEAR300\nstatic void __init spear300_clk_init(void)\n{\n\tstruct clk *clk;\n\n\tclk = clk_register_fixed_factor(NULL, \"clcd_clk\", \"ras_pll3_clk\", 0,\n\t\t\t1, 1);\n\tclk_register_clkdev(clk, NULL, \"60000000.clcd\");\n\n\tclk = clk_register_fixed_factor(NULL, \"fsmc_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"94000000.flash\");\n\n\tclk = clk_register_fixed_factor(NULL, \"sdhci_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"70000000.sdhci\");\n\n\tclk = clk_register_fixed_factor(NULL, \"gpio1_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a9000000.gpio\");\n\n\tclk = clk_register_fixed_factor(NULL, \"kbd_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a0000000.kbd\");\n}\n#else\nstatic inline void spear300_clk_init(void) { }\n#endif\n\n \n#ifdef CONFIG_MACH_SPEAR310\nstatic void __init spear310_clk_init(void)\n{\n\tstruct clk *clk;\n\n\tclk = clk_register_fixed_factor(NULL, \"emi_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"emi\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"fsmc_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"44000000.flash\");\n\n\tclk = clk_register_fixed_factor(NULL, \"tdm_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"tdm\");\n\n\tclk = clk_register_fixed_factor(NULL, \"uart1_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"b2000000.serial\");\n\n\tclk = clk_register_fixed_factor(NULL, \"uart2_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"b2080000.serial\");\n\n\tclk = clk_register_fixed_factor(NULL, \"uart3_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"b2100000.serial\");\n\n\tclk = clk_register_fixed_factor(NULL, \"uart4_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"b2180000.serial\");\n\n\tclk = clk_register_fixed_factor(NULL, \"uart5_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"b2200000.serial\");\n}\n#else\nstatic inline void spear310_clk_init(void) { }\n#endif\n\n \n#ifdef CONFIG_MACH_SPEAR320\n\n#define SPEAR320_CONTROL_REG\t\t(soc_config_base + 0x0010)\n#define SPEAR320_EXT_CTRL_REG\t\t(soc_config_base + 0x0018)\n\n\t#define SPEAR320_UARTX_PCLK_MASK\t\t0x1\n\t#define SPEAR320_UART2_PCLK_SHIFT\t\t8\n\t#define SPEAR320_UART3_PCLK_SHIFT\t\t9\n\t#define SPEAR320_UART4_PCLK_SHIFT\t\t10\n\t#define SPEAR320_UART5_PCLK_SHIFT\t\t11\n\t#define SPEAR320_UART6_PCLK_SHIFT\t\t12\n\t#define SPEAR320_RS485_PCLK_SHIFT\t\t13\n\t#define SMII_PCLK_SHIFT\t\t\t\t18\n\t#define SMII_PCLK_MASK\t\t\t\t2\n\t#define SMII_PCLK_VAL_PAD\t\t\t0x0\n\t#define SMII_PCLK_VAL_PLL2\t\t\t0x1\n\t#define SMII_PCLK_VAL_SYNTH0\t\t\t0x2\n\t#define SDHCI_PCLK_SHIFT\t\t\t15\n\t#define SDHCI_PCLK_MASK\t\t\t\t1\n\t#define SDHCI_PCLK_VAL_48M\t\t\t0x0\n\t#define SDHCI_PCLK_VAL_SYNTH3\t\t\t0x1\n\t#define I2S_REF_PCLK_SHIFT\t\t\t8\n\t#define I2S_REF_PCLK_MASK\t\t\t1\n\t#define I2S_REF_PCLK_SYNTH_VAL\t\t\t0x1\n\t#define I2S_REF_PCLK_PLL2_VAL\t\t\t0x0\n\t#define UART1_PCLK_SHIFT\t\t\t6\n\t#define UART1_PCLK_MASK\t\t\t\t1\n\t#define SPEAR320_UARTX_PCLK_VAL_SYNTH1\t\t0x0\n\t#define SPEAR320_UARTX_PCLK_VAL_APB\t\t0x1\n\nstatic const char *i2s_ref_parents[] = { \"ras_pll2_clk\", \"ras_syn2_gclk\", };\nstatic const char *sdhci_parents[] = { \"ras_pll3_clk\", \"ras_syn3_gclk\", };\nstatic const char *smii0_parents[] = { \"smii_125m_pad\", \"ras_pll2_clk\",\n\t\"ras_syn0_gclk\", };\nstatic const char *uartx_parents[] = { \"ras_syn1_gclk\", \"ras_apb_clk\", };\n\nstatic void __init spear320_clk_init(void __iomem *soc_config_base,\n\t\t\t\t     struct clk *ras_apb_clk)\n{\n\tstruct clk *clk;\n\n\tclk = clk_register_fixed_rate(NULL, \"smii_125m_pad_clk\", NULL,\n\t\t\t0, 125000000);\n\tclk_register_clkdev(clk, \"smii_125m_pad\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"clcd_clk\", \"ras_pll3_clk\", 0,\n\t\t\t1, 1);\n\tclk_register_clkdev(clk, NULL, \"90000000.clcd\");\n\n\tclk = clk_register_fixed_factor(NULL, \"emi_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"emi\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"fsmc_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"4c000000.flash\");\n\n\tclk = clk_register_fixed_factor(NULL, \"i2c1_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a7000000.i2c\");\n\n\tclk = clk_register_fixed_factor(NULL, \"pwm_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a8000000.pwm\");\n\n\tclk = clk_register_fixed_factor(NULL, \"ssp1_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a5000000.spi\");\n\n\tclk = clk_register_fixed_factor(NULL, \"ssp2_clk\", \"ras_ahb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a6000000.spi\");\n\n\tclk = clk_register_fixed_factor(NULL, \"can0_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"c_can_platform.0\");\n\n\tclk = clk_register_fixed_factor(NULL, \"can1_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"c_can_platform.1\");\n\n\tclk = clk_register_fixed_factor(NULL, \"i2s_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"a9400000.i2s\");\n\n\tclk = clk_register_mux(NULL, \"i2s_ref_clk\", i2s_ref_parents,\n\t\t\tARRAY_SIZE(i2s_ref_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_CONTROL_REG, I2S_REF_PCLK_SHIFT,\n\t\t\tI2S_REF_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"i2s_ref_clk\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"i2s_sclk\", \"i2s_ref_clk\",\n\t\t\tCLK_SET_RATE_PARENT, 1,\n\t\t\t4);\n\tclk_register_clkdev(clk, \"i2s_sclk\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"macb1_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"hclk\", \"aa000000.eth\");\n\n\tclk = clk_register_fixed_factor(NULL, \"macb2_clk\", \"ras_apb_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"hclk\", \"ab000000.eth\");\n\n\tclk = clk_register_mux(NULL, \"rs485_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_RS485_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"a9300000.serial\");\n\n\tclk = clk_register_mux(NULL, \"sdhci_clk\", sdhci_parents,\n\t\t\tARRAY_SIZE(sdhci_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_CONTROL_REG, SDHCI_PCLK_SHIFT, SDHCI_PCLK_MASK,\n\t\t\t0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"70000000.sdhci\");\n\n\tclk = clk_register_mux(NULL, \"smii_pclk\", smii0_parents,\n\t\t\tARRAY_SIZE(smii0_parents), CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_CONTROL_REG, SMII_PCLK_SHIFT, SMII_PCLK_MASK,\n\t\t\t0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"smii_pclk\");\n\n\tclk = clk_register_fixed_factor(NULL, \"smii_clk\", \"smii_pclk\", 0, 1, 1);\n\tclk_register_clkdev(clk, NULL, \"smii\");\n\n\tclk = clk_register_mux(NULL, \"uart1_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_CONTROL_REG, UART1_PCLK_SHIFT, UART1_PCLK_MASK,\n\t\t\t0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"a3000000.serial\");\n\t \n\tclk_set_parent(clk, ras_apb_clk);\n\n\tclk = clk_register_mux(NULL, \"uart2_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_UART2_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"a4000000.serial\");\n\t \n\tclk_set_parent(clk, ras_apb_clk);\n\n\tclk = clk_register_mux(NULL, \"uart3_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_UART3_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"a9100000.serial\");\n\n\tclk = clk_register_mux(NULL, \"uart4_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_UART4_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"a9200000.serial\");\n\n\tclk = clk_register_mux(NULL, \"uart5_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_UART5_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"60000000.serial\");\n\n\tclk = clk_register_mux(NULL, \"uart6_clk\", uartx_parents,\n\t\t\tARRAY_SIZE(uartx_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tSPEAR320_EXT_CTRL_REG, SPEAR320_UART6_PCLK_SHIFT,\n\t\t\tSPEAR320_UARTX_PCLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"60100000.serial\");\n}\n#else\nstatic inline void spear320_clk_init(void __iomem *sb, struct clk *rc) { }\n#endif\n\nvoid __init spear3xx_clk_init(void __iomem *misc_base, void __iomem *soc_config_base)\n{\n\tstruct clk *clk, *clk1, *ras_apb_clk;\n\n\tclk = clk_register_fixed_rate(NULL, \"osc_32k_clk\", NULL, 0, 32000);\n\tclk_register_clkdev(clk, \"osc_32k_clk\", NULL);\n\n\tclk = clk_register_fixed_rate(NULL, \"osc_24m_clk\", NULL, 0, 24000000);\n\tclk_register_clkdev(clk, \"osc_24m_clk\", NULL);\n\n\t \n\tclk = clk_register_gate(NULL, \"rtc-spear\", \"osc_32k_clk\", 0,\n\t\t\tPERIP1_CLK_ENB, RTC_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"fc900000.rtc\");\n\n\t \n\tclk = clk_register_fixed_rate(NULL, \"pll3_clk\", \"osc_24m_clk\", 0,\n\t\t\t48000000);\n\tclk_register_clkdev(clk, \"pll3_clk\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"wdt_clk\", \"osc_24m_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, NULL, \"fc880000.wdt\");\n\n\tclk = clk_register_vco_pll(\"vco1_clk\", \"pll1_clk\", NULL,\n\t\t\t\"osc_24m_clk\", 0, PLL1_CTR, PLL1_FRQ, pll_rtbl,\n\t\t\tARRAY_SIZE(pll_rtbl), &_lock, &clk1, NULL);\n\tclk_register_clkdev(clk, \"vco1_clk\", NULL);\n\tclk_register_clkdev(clk1, \"pll1_clk\", NULL);\n\n\tclk = clk_register_vco_pll(\"vco2_clk\", \"pll2_clk\", NULL,\n\t\t\t\"osc_24m_clk\", 0, PLL2_CTR, PLL2_FRQ, pll_rtbl,\n\t\t\tARRAY_SIZE(pll_rtbl), &_lock, &clk1, NULL);\n\tclk_register_clkdev(clk, \"vco2_clk\", NULL);\n\tclk_register_clkdev(clk1, \"pll2_clk\", NULL);\n\n\t \n\tclk = clk_register_fixed_factor(NULL, \"cpu_clk\", \"pll1_clk\",\n\t\t\tCLK_SET_RATE_PARENT, 1, 1);\n\tclk_register_clkdev(clk, \"cpu_clk\", NULL);\n\n\tclk = clk_register_divider(NULL, \"ahb_clk\", \"pll1_clk\",\n\t\t\tCLK_SET_RATE_PARENT, CORE_CLK_CFG, HCLK_RATIO_SHIFT,\n\t\t\tHCLK_RATIO_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"ahb_clk\", NULL);\n\n\tclk = clk_register_aux(\"uart_syn_clk\", \"uart_syn_gclk\", \"pll1_clk\", 0,\n\t\t\tUART_CLK_SYNT, NULL, aux_rtbl, ARRAY_SIZE(aux_rtbl),\n\t\t\t&_lock, &clk1);\n\tclk_register_clkdev(clk, \"uart_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"uart_syn_gclk\", NULL);\n\n\tclk = clk_register_mux(NULL, \"uart0_mclk\", uart0_parents,\n\t\t\tARRAY_SIZE(uart0_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tPERIP_CLK_CFG, UART_CLK_SHIFT, UART_CLK_MASK, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"uart0_mclk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"uart0\", \"uart0_mclk\",\n\t\t\tCLK_SET_RATE_PARENT, PERIP1_CLK_ENB, UART_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, NULL, \"d0000000.serial\");\n\n\tclk = clk_register_aux(\"firda_syn_clk\", \"firda_syn_gclk\", \"pll1_clk\", 0,\n\t\t\tFIRDA_CLK_SYNT, NULL, aux_rtbl, ARRAY_SIZE(aux_rtbl),\n\t\t\t&_lock, &clk1);\n\tclk_register_clkdev(clk, \"firda_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"firda_syn_gclk\", NULL);\n\n\tclk = clk_register_mux(NULL, \"firda_mclk\", firda_parents,\n\t\t\tARRAY_SIZE(firda_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tPERIP_CLK_CFG, FIRDA_CLK_SHIFT, FIRDA_CLK_MASK, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"firda_mclk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"firda_clk\", \"firda_mclk\",\n\t\t\tCLK_SET_RATE_PARENT, PERIP1_CLK_ENB, FIRDA_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, NULL, \"firda\");\n\n\t \n\tclk_register_gpt(\"gpt0_syn_clk\", \"pll1_clk\", 0, PRSC0_CLK_CFG, gpt_rtbl,\n\t\t\tARRAY_SIZE(gpt_rtbl), &_lock);\n\tclk = clk_register_mux(NULL, \"gpt0_clk\", gpt0_parents,\n\t\t\tARRAY_SIZE(gpt0_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tPERIP_CLK_CFG, GPT0_CLK_SHIFT, GPT_CLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"gpt0\");\n\n\tclk_register_gpt(\"gpt1_syn_clk\", \"pll1_clk\", 0, PRSC1_CLK_CFG, gpt_rtbl,\n\t\t\tARRAY_SIZE(gpt_rtbl), &_lock);\n\tclk = clk_register_mux(NULL, \"gpt1_mclk\", gpt1_parents,\n\t\t\tARRAY_SIZE(gpt1_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tPERIP_CLK_CFG, GPT1_CLK_SHIFT, GPT_CLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"gpt1_mclk\", NULL);\n\tclk = clk_register_gate(NULL, \"gpt1_clk\", \"gpt1_mclk\",\n\t\t\tCLK_SET_RATE_PARENT, PERIP1_CLK_ENB, GPT1_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, NULL, \"gpt1\");\n\n\tclk_register_gpt(\"gpt2_syn_clk\", \"pll1_clk\", 0, PRSC2_CLK_CFG, gpt_rtbl,\n\t\t\tARRAY_SIZE(gpt_rtbl), &_lock);\n\tclk = clk_register_mux(NULL, \"gpt2_mclk\", gpt2_parents,\n\t\t\tARRAY_SIZE(gpt2_parents),\n\t\t\tCLK_SET_RATE_PARENT | CLK_SET_RATE_NO_REPARENT,\n\t\t\tPERIP_CLK_CFG, GPT2_CLK_SHIFT, GPT_CLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"gpt2_mclk\", NULL);\n\tclk = clk_register_gate(NULL, \"gpt2_clk\", \"gpt2_mclk\",\n\t\t\tCLK_SET_RATE_PARENT, PERIP1_CLK_ENB, GPT2_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, NULL, \"gpt2\");\n\n\t \n\tclk = clk_register_aux(\"gen0_syn_clk\", \"gen0_syn_gclk\", \"pll1_clk\",\n\t\t\t0, GEN0_CLK_SYNT, NULL, aux_rtbl, ARRAY_SIZE(aux_rtbl),\n\t\t\t&_lock, &clk1);\n\tclk_register_clkdev(clk, \"gen0_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"gen0_syn_gclk\", NULL);\n\n\tclk = clk_register_aux(\"gen1_syn_clk\", \"gen1_syn_gclk\", \"pll1_clk\",\n\t\t\t0, GEN1_CLK_SYNT, NULL, aux_rtbl, ARRAY_SIZE(aux_rtbl),\n\t\t\t&_lock, &clk1);\n\tclk_register_clkdev(clk, \"gen1_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"gen1_syn_gclk\", NULL);\n\n\tclk = clk_register_mux(NULL, \"gen2_3_par_clk\", gen2_3_parents,\n\t\t\tARRAY_SIZE(gen2_3_parents), CLK_SET_RATE_NO_REPARENT,\n\t\t\tCORE_CLK_CFG, GEN_SYNTH2_3_CLK_SHIFT,\n\t\t\tGEN_SYNTH2_3_CLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"gen2_3_par_clk\", NULL);\n\n\tclk = clk_register_aux(\"gen2_syn_clk\", \"gen2_syn_gclk\",\n\t\t\t\"gen2_3_par_clk\", 0, GEN2_CLK_SYNT, NULL, aux_rtbl,\n\t\t\tARRAY_SIZE(aux_rtbl), &_lock, &clk1);\n\tclk_register_clkdev(clk, \"gen2_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"gen2_syn_gclk\", NULL);\n\n\tclk = clk_register_aux(\"gen3_syn_clk\", \"gen3_syn_gclk\",\n\t\t\t\"gen2_3_par_clk\", 0, GEN3_CLK_SYNT, NULL, aux_rtbl,\n\t\t\tARRAY_SIZE(aux_rtbl), &_lock, &clk1);\n\tclk_register_clkdev(clk, \"gen3_syn_clk\", NULL);\n\tclk_register_clkdev(clk1, \"gen3_syn_gclk\", NULL);\n\n\t \n\tclk = clk_register_gate(NULL, \"usbh_clk\", \"pll3_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tUSBH_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"e1800000.ehci\");\n\tclk_register_clkdev(clk, NULL, \"e1900000.ohci\");\n\tclk_register_clkdev(clk, NULL, \"e2100000.ohci\");\n\n\tclk = clk_register_fixed_factor(NULL, \"usbh.0_clk\", \"usbh_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"usbh.0_clk\", NULL);\n\n\tclk = clk_register_fixed_factor(NULL, \"usbh.1_clk\", \"usbh_clk\", 0, 1,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"usbh.1_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"usbd_clk\", \"pll3_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tUSBD_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"e1100000.usbd\");\n\n\t \n\tclk = clk_register_fixed_factor(NULL, \"ahbmult2_clk\", \"ahb_clk\", 0, 2,\n\t\t\t1);\n\tclk_register_clkdev(clk, \"ahbmult2_clk\", NULL);\n\n\tclk = clk_register_mux(NULL, \"ddr_clk\", ddr_parents,\n\t\t\tARRAY_SIZE(ddr_parents), CLK_SET_RATE_NO_REPARENT,\n\t\t\tPLL_CLK_CFG, MCTR_CLK_SHIFT, MCTR_CLK_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"ddr_clk\", NULL);\n\n\tclk = clk_register_divider(NULL, \"apb_clk\", \"ahb_clk\",\n\t\t\tCLK_SET_RATE_PARENT, CORE_CLK_CFG, PCLK_RATIO_SHIFT,\n\t\t\tPCLK_RATIO_MASK, 0, &_lock);\n\tclk_register_clkdev(clk, \"apb_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"amem_clk\", \"ahb_clk\", 0, AMEM_CLK_CFG,\n\t\t\tAMEM_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"amem_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"c3_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tC3_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"c3_clk\");\n\n\tclk = clk_register_gate(NULL, \"dma_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tDMA_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"fc400000.dma\");\n\n\tclk = clk_register_gate(NULL, \"gmac_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tGMAC_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"e0800000.eth\");\n\n\tclk = clk_register_gate(NULL, \"i2c0_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tI2C_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"d0180000.i2c\");\n\n\tclk = clk_register_gate(NULL, \"jpeg_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tJPEG_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"jpeg\");\n\n\tclk = clk_register_gate(NULL, \"smi_clk\", \"ahb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tSMI_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"fc000000.flash\");\n\n\t \n\tclk = clk_register_gate(NULL, \"adc_clk\", \"apb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tADC_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"d0080000.adc\");\n\n\tclk = clk_register_gate(NULL, \"gpio0_clk\", \"apb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tGPIO_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"fc980000.gpio\");\n\n\tclk = clk_register_gate(NULL, \"ssp0_clk\", \"apb_clk\", 0, PERIP1_CLK_ENB,\n\t\t\tSSP_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, NULL, \"d0100000.spi\");\n\n\t \n\tclk = clk_register_gate(NULL, \"ras_ahb_clk\", \"ahb_clk\", 0, RAS_CLK_ENB,\n\t\t\tRAS_AHB_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_ahb_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_apb_clk\", \"apb_clk\", 0, RAS_CLK_ENB,\n\t\t\tRAS_APB_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_apb_clk\", NULL);\n\tras_apb_clk = clk;\n\n\tclk = clk_register_gate(NULL, \"ras_32k_clk\", \"osc_32k_clk\", 0,\n\t\t\tRAS_CLK_ENB, RAS_32K_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_32k_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_24m_clk\", \"osc_24m_clk\", 0,\n\t\t\tRAS_CLK_ENB, RAS_24M_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_24m_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_pll1_clk\", \"pll1_clk\", 0,\n\t\t\tRAS_CLK_ENB, RAS_PLL1_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_pll1_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_pll2_clk\", \"pll2_clk\", 0,\n\t\t\tRAS_CLK_ENB, RAS_PLL2_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_pll2_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_pll3_clk\", \"pll3_clk\", 0,\n\t\t\tRAS_CLK_ENB, RAS_48M_CLK_ENB, 0, &_lock);\n\tclk_register_clkdev(clk, \"ras_pll3_clk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_syn0_gclk\", \"gen0_syn_gclk\",\n\t\t\tCLK_SET_RATE_PARENT, RAS_CLK_ENB, RAS_SYNT0_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"ras_syn0_gclk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_syn1_gclk\", \"gen1_syn_gclk\",\n\t\t\tCLK_SET_RATE_PARENT, RAS_CLK_ENB, RAS_SYNT1_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"ras_syn1_gclk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_syn2_gclk\", \"gen2_syn_gclk\",\n\t\t\tCLK_SET_RATE_PARENT, RAS_CLK_ENB, RAS_SYNT2_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"ras_syn2_gclk\", NULL);\n\n\tclk = clk_register_gate(NULL, \"ras_syn3_gclk\", \"gen3_syn_gclk\",\n\t\t\tCLK_SET_RATE_PARENT, RAS_CLK_ENB, RAS_SYNT3_CLK_ENB, 0,\n\t\t\t&_lock);\n\tclk_register_clkdev(clk, \"ras_syn3_gclk\", NULL);\n\n\tif (of_machine_is_compatible(\"st,spear300\"))\n\t\tspear300_clk_init();\n\telse if (of_machine_is_compatible(\"st,spear310\"))\n\t\tspear310_clk_init();\n\telse if (of_machine_is_compatible(\"st,spear320\"))\n\t\tspear320_clk_init(soc_config_base, ras_apb_clk);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}