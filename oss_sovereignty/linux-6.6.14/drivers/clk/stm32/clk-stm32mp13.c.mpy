{
  "module_name": "clk-stm32mp13.c",
  "hash_id": "e34b973f85aee6bd4795bf201105bff4cea5e306b976ac33caffcee076048361",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/stm32/clk-stm32mp13.c",
  "human_readable_source": "\n \n\n#include <linux/clk.h>\n#include <linux/module.h>\n#include <linux/of_address.h>\n#include <linux/platform_device.h>\n#include <dt-bindings/clock/stm32mp13-clks.h>\n#include \"clk-stm32-core.h\"\n#include \"stm32mp13_rcc.h\"\n\n#define RCC_CLR_OFFSET\t\t0x4\n\n \nenum enum_gate_cfg {\n\tGATE_MCO1,\n\tGATE_MCO2,\n\tGATE_DBGCK,\n\tGATE_TRACECK,\n\tGATE_DDRC1,\n\tGATE_DDRC1LP,\n\tGATE_DDRPHYC,\n\tGATE_DDRPHYCLP,\n\tGATE_DDRCAPB,\n\tGATE_DDRCAPBLP,\n\tGATE_AXIDCG,\n\tGATE_DDRPHYCAPB,\n\tGATE_DDRPHYCAPBLP,\n\tGATE_TIM2,\n\tGATE_TIM3,\n\tGATE_TIM4,\n\tGATE_TIM5,\n\tGATE_TIM6,\n\tGATE_TIM7,\n\tGATE_LPTIM1,\n\tGATE_SPI2,\n\tGATE_SPI3,\n\tGATE_USART3,\n\tGATE_UART4,\n\tGATE_UART5,\n\tGATE_UART7,\n\tGATE_UART8,\n\tGATE_I2C1,\n\tGATE_I2C2,\n\tGATE_SPDIF,\n\tGATE_TIM1,\n\tGATE_TIM8,\n\tGATE_SPI1,\n\tGATE_USART6,\n\tGATE_SAI1,\n\tGATE_SAI2,\n\tGATE_DFSDM,\n\tGATE_ADFSDM,\n\tGATE_FDCAN,\n\tGATE_LPTIM2,\n\tGATE_LPTIM3,\n\tGATE_LPTIM4,\n\tGATE_LPTIM5,\n\tGATE_VREF,\n\tGATE_DTS,\n\tGATE_PMBCTRL,\n\tGATE_HDP,\n\tGATE_SYSCFG,\n\tGATE_DCMIPP,\n\tGATE_DDRPERFM,\n\tGATE_IWDG2APB,\n\tGATE_USBPHY,\n\tGATE_STGENRO,\n\tGATE_LTDC,\n\tGATE_RTCAPB,\n\tGATE_TZC,\n\tGATE_ETZPC,\n\tGATE_IWDG1APB,\n\tGATE_BSEC,\n\tGATE_STGENC,\n\tGATE_USART1,\n\tGATE_USART2,\n\tGATE_SPI4,\n\tGATE_SPI5,\n\tGATE_I2C3,\n\tGATE_I2C4,\n\tGATE_I2C5,\n\tGATE_TIM12,\n\tGATE_TIM13,\n\tGATE_TIM14,\n\tGATE_TIM15,\n\tGATE_TIM16,\n\tGATE_TIM17,\n\tGATE_DMA1,\n\tGATE_DMA2,\n\tGATE_DMAMUX1,\n\tGATE_DMA3,\n\tGATE_DMAMUX2,\n\tGATE_ADC1,\n\tGATE_ADC2,\n\tGATE_USBO,\n\tGATE_TSC,\n\tGATE_GPIOA,\n\tGATE_GPIOB,\n\tGATE_GPIOC,\n\tGATE_GPIOD,\n\tGATE_GPIOE,\n\tGATE_GPIOF,\n\tGATE_GPIOG,\n\tGATE_GPIOH,\n\tGATE_GPIOI,\n\tGATE_PKA,\n\tGATE_SAES,\n\tGATE_CRYP1,\n\tGATE_HASH1,\n\tGATE_RNG1,\n\tGATE_BKPSRAM,\n\tGATE_AXIMC,\n\tGATE_MCE,\n\tGATE_ETH1CK,\n\tGATE_ETH1TX,\n\tGATE_ETH1RX,\n\tGATE_ETH1MAC,\n\tGATE_FMC,\n\tGATE_QSPI,\n\tGATE_SDMMC1,\n\tGATE_SDMMC2,\n\tGATE_CRC1,\n\tGATE_USBH,\n\tGATE_ETH2CK,\n\tGATE_ETH2TX,\n\tGATE_ETH2RX,\n\tGATE_ETH2MAC,\n\tGATE_ETH1STP,\n\tGATE_ETH2STP,\n\tGATE_MDMA,\n\tGATE_NB\n};\n\n#define _CFG_GATE(_id, _offset, _bit_idx, _offset_clr)\\\n\t[(_id)] = {\\\n\t\t.offset\t\t= (_offset),\\\n\t\t.bit_idx\t= (_bit_idx),\\\n\t\t.set_clr\t= (_offset_clr),\\\n\t}\n\n#define CFG_GATE(_id, _offset, _bit_idx)\\\n\t_CFG_GATE(_id, _offset, _bit_idx, 0)\n\n#define CFG_GATE_SETCLR(_id, _offset, _bit_idx)\\\n\t_CFG_GATE(_id, _offset, _bit_idx, RCC_CLR_OFFSET)\n\nstatic struct stm32_gate_cfg stm32mp13_gates[] = {\n\tCFG_GATE(GATE_MCO1,\t\tRCC_MCO1CFGR,\t\t12),\n\tCFG_GATE(GATE_MCO2,\t\tRCC_MCO2CFGR,\t\t12),\n\tCFG_GATE(GATE_DBGCK,\t\tRCC_DBGCFGR,\t\t8),\n\tCFG_GATE(GATE_TRACECK,\t\tRCC_DBGCFGR,\t\t9),\n\tCFG_GATE(GATE_DDRC1,\t\tRCC_DDRITFCR,\t\t0),\n\tCFG_GATE(GATE_DDRC1LP,\t\tRCC_DDRITFCR,\t\t1),\n\tCFG_GATE(GATE_DDRPHYC,\t\tRCC_DDRITFCR,\t\t4),\n\tCFG_GATE(GATE_DDRPHYCLP,\tRCC_DDRITFCR,\t\t5),\n\tCFG_GATE(GATE_DDRCAPB,\t\tRCC_DDRITFCR,\t\t6),\n\tCFG_GATE(GATE_DDRCAPBLP,\tRCC_DDRITFCR,\t\t7),\n\tCFG_GATE(GATE_AXIDCG,\t\tRCC_DDRITFCR,\t\t8),\n\tCFG_GATE(GATE_DDRPHYCAPB,\tRCC_DDRITFCR,\t\t9),\n\tCFG_GATE(GATE_DDRPHYCAPBLP,\tRCC_DDRITFCR,\t\t10),\n\tCFG_GATE_SETCLR(GATE_TIM2,\tRCC_MP_APB1ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_TIM3,\tRCC_MP_APB1ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_TIM4,\tRCC_MP_APB1ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_TIM5,\tRCC_MP_APB1ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_TIM6,\tRCC_MP_APB1ENSETR,\t4),\n\tCFG_GATE_SETCLR(GATE_TIM7,\tRCC_MP_APB1ENSETR,\t5),\n\tCFG_GATE_SETCLR(GATE_LPTIM1,\tRCC_MP_APB1ENSETR,\t9),\n\tCFG_GATE_SETCLR(GATE_SPI2,\tRCC_MP_APB1ENSETR,\t11),\n\tCFG_GATE_SETCLR(GATE_SPI3,\tRCC_MP_APB1ENSETR,\t12),\n\tCFG_GATE_SETCLR(GATE_USART3,\tRCC_MP_APB1ENSETR,\t15),\n\tCFG_GATE_SETCLR(GATE_UART4,\tRCC_MP_APB1ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_UART5,\tRCC_MP_APB1ENSETR,\t17),\n\tCFG_GATE_SETCLR(GATE_UART7,\tRCC_MP_APB1ENSETR,\t18),\n\tCFG_GATE_SETCLR(GATE_UART8,\tRCC_MP_APB1ENSETR,\t19),\n\tCFG_GATE_SETCLR(GATE_I2C1,\tRCC_MP_APB1ENSETR,\t21),\n\tCFG_GATE_SETCLR(GATE_I2C2,\tRCC_MP_APB1ENSETR,\t22),\n\tCFG_GATE_SETCLR(GATE_SPDIF,\tRCC_MP_APB1ENSETR,\t26),\n\tCFG_GATE_SETCLR(GATE_TIM1,\tRCC_MP_APB2ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_TIM8,\tRCC_MP_APB2ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_SPI1,\tRCC_MP_APB2ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_USART6,\tRCC_MP_APB2ENSETR,\t13),\n\tCFG_GATE_SETCLR(GATE_SAI1,\tRCC_MP_APB2ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_SAI2,\tRCC_MP_APB2ENSETR,\t17),\n\tCFG_GATE_SETCLR(GATE_DFSDM,\tRCC_MP_APB2ENSETR,\t20),\n\tCFG_GATE_SETCLR(GATE_ADFSDM,\tRCC_MP_APB2ENSETR,\t21),\n\tCFG_GATE_SETCLR(GATE_FDCAN,\tRCC_MP_APB2ENSETR,\t24),\n\tCFG_GATE_SETCLR(GATE_LPTIM2,\tRCC_MP_APB3ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_LPTIM3,\tRCC_MP_APB3ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_LPTIM4,\tRCC_MP_APB3ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_LPTIM5,\tRCC_MP_APB3ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_VREF,\tRCC_MP_APB3ENSETR,\t13),\n\tCFG_GATE_SETCLR(GATE_DTS,\tRCC_MP_APB3ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_PMBCTRL,\tRCC_MP_APB3ENSETR,\t17),\n\tCFG_GATE_SETCLR(GATE_HDP,\tRCC_MP_APB3ENSETR,\t20),\n\tCFG_GATE_SETCLR(GATE_SYSCFG,\tRCC_MP_NS_APB3ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_DCMIPP,\tRCC_MP_APB4ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_DDRPERFM,\tRCC_MP_APB4ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_IWDG2APB,\tRCC_MP_APB4ENSETR,\t15),\n\tCFG_GATE_SETCLR(GATE_USBPHY,\tRCC_MP_APB4ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_STGENRO,\tRCC_MP_APB4ENSETR,\t20),\n\tCFG_GATE_SETCLR(GATE_LTDC,\tRCC_MP_NS_APB4ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_RTCAPB,\tRCC_MP_APB5ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_TZC,\tRCC_MP_APB5ENSETR,\t11),\n\tCFG_GATE_SETCLR(GATE_ETZPC,\tRCC_MP_APB5ENSETR,\t13),\n\tCFG_GATE_SETCLR(GATE_IWDG1APB,\tRCC_MP_APB5ENSETR,\t15),\n\tCFG_GATE_SETCLR(GATE_BSEC,\tRCC_MP_APB5ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_STGENC,\tRCC_MP_APB5ENSETR,\t20),\n\tCFG_GATE_SETCLR(GATE_USART1,\tRCC_MP_APB6ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_USART2,\tRCC_MP_APB6ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_SPI4,\tRCC_MP_APB6ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_SPI5,\tRCC_MP_APB6ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_I2C3,\tRCC_MP_APB6ENSETR,\t4),\n\tCFG_GATE_SETCLR(GATE_I2C4,\tRCC_MP_APB6ENSETR,\t5),\n\tCFG_GATE_SETCLR(GATE_I2C5,\tRCC_MP_APB6ENSETR,\t6),\n\tCFG_GATE_SETCLR(GATE_TIM12,\tRCC_MP_APB6ENSETR,\t7),\n\tCFG_GATE_SETCLR(GATE_TIM13,\tRCC_MP_APB6ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_TIM14,\tRCC_MP_APB6ENSETR,\t9),\n\tCFG_GATE_SETCLR(GATE_TIM15,\tRCC_MP_APB6ENSETR,\t10),\n\tCFG_GATE_SETCLR(GATE_TIM16,\tRCC_MP_APB6ENSETR,\t11),\n\tCFG_GATE_SETCLR(GATE_TIM17,\tRCC_MP_APB6ENSETR,\t12),\n\tCFG_GATE_SETCLR(GATE_DMA1,\tRCC_MP_AHB2ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_DMA2,\tRCC_MP_AHB2ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_DMAMUX1,\tRCC_MP_AHB2ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_DMA3,\tRCC_MP_AHB2ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_DMAMUX2,\tRCC_MP_AHB2ENSETR,\t4),\n\tCFG_GATE_SETCLR(GATE_ADC1,\tRCC_MP_AHB2ENSETR,\t5),\n\tCFG_GATE_SETCLR(GATE_ADC2,\tRCC_MP_AHB2ENSETR,\t6),\n\tCFG_GATE_SETCLR(GATE_USBO,\tRCC_MP_AHB2ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_TSC,\tRCC_MP_AHB4ENSETR,\t15),\n\tCFG_GATE_SETCLR(GATE_GPIOA,\tRCC_MP_NS_AHB4ENSETR,\t0),\n\tCFG_GATE_SETCLR(GATE_GPIOB,\tRCC_MP_NS_AHB4ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_GPIOC,\tRCC_MP_NS_AHB4ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_GPIOD,\tRCC_MP_NS_AHB4ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_GPIOE,\tRCC_MP_NS_AHB4ENSETR,\t4),\n\tCFG_GATE_SETCLR(GATE_GPIOF,\tRCC_MP_NS_AHB4ENSETR,\t5),\n\tCFG_GATE_SETCLR(GATE_GPIOG,\tRCC_MP_NS_AHB4ENSETR,\t6),\n\tCFG_GATE_SETCLR(GATE_GPIOH,\tRCC_MP_NS_AHB4ENSETR,\t7),\n\tCFG_GATE_SETCLR(GATE_GPIOI,\tRCC_MP_NS_AHB4ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_PKA,\tRCC_MP_AHB5ENSETR,\t2),\n\tCFG_GATE_SETCLR(GATE_SAES,\tRCC_MP_AHB5ENSETR,\t3),\n\tCFG_GATE_SETCLR(GATE_CRYP1,\tRCC_MP_AHB5ENSETR,\t4),\n\tCFG_GATE_SETCLR(GATE_HASH1,\tRCC_MP_AHB5ENSETR,\t5),\n\tCFG_GATE_SETCLR(GATE_RNG1,\tRCC_MP_AHB5ENSETR,\t6),\n\tCFG_GATE_SETCLR(GATE_BKPSRAM,\tRCC_MP_AHB5ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_AXIMC,\tRCC_MP_AHB5ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_MCE,\tRCC_MP_AHB6ENSETR,\t1),\n\tCFG_GATE_SETCLR(GATE_ETH1CK,\tRCC_MP_AHB6ENSETR,\t7),\n\tCFG_GATE_SETCLR(GATE_ETH1TX,\tRCC_MP_AHB6ENSETR,\t8),\n\tCFG_GATE_SETCLR(GATE_ETH1RX,\tRCC_MP_AHB6ENSETR,\t9),\n\tCFG_GATE_SETCLR(GATE_ETH1MAC,\tRCC_MP_AHB6ENSETR,\t10),\n\tCFG_GATE_SETCLR(GATE_FMC,\tRCC_MP_AHB6ENSETR,\t12),\n\tCFG_GATE_SETCLR(GATE_QSPI,\tRCC_MP_AHB6ENSETR,\t14),\n\tCFG_GATE_SETCLR(GATE_SDMMC1,\tRCC_MP_AHB6ENSETR,\t16),\n\tCFG_GATE_SETCLR(GATE_SDMMC2,\tRCC_MP_AHB6ENSETR,\t17),\n\tCFG_GATE_SETCLR(GATE_CRC1,\tRCC_MP_AHB6ENSETR,\t20),\n\tCFG_GATE_SETCLR(GATE_USBH,\tRCC_MP_AHB6ENSETR,\t24),\n\tCFG_GATE_SETCLR(GATE_ETH2CK,\tRCC_MP_AHB6ENSETR,\t27),\n\tCFG_GATE_SETCLR(GATE_ETH2TX,\tRCC_MP_AHB6ENSETR,\t28),\n\tCFG_GATE_SETCLR(GATE_ETH2RX,\tRCC_MP_AHB6ENSETR,\t29),\n\tCFG_GATE_SETCLR(GATE_ETH2MAC,\tRCC_MP_AHB6ENSETR,\t30),\n\tCFG_GATE_SETCLR(GATE_ETH1STP,\tRCC_MP_AHB6LPENSETR,\t11),\n\tCFG_GATE_SETCLR(GATE_ETH2STP,\tRCC_MP_AHB6LPENSETR,\t31),\n\tCFG_GATE_SETCLR(GATE_MDMA,\tRCC_MP_NS_AHB6ENSETR,\t0),\n};\n\n \nenum enum_div_cfg {\n\tDIV_RTC,\n\tDIV_HSI,\n\tDIV_MCO1,\n\tDIV_MCO2,\n\tDIV_TRACE,\n\tDIV_ETH1PTP,\n\tDIV_ETH2PTP,\n\tDIV_NB\n};\n\nstatic const struct clk_div_table ck_trace_div_table[] = {\n\t{ 0, 1 }, { 1, 2 }, { 2, 4 }, { 3, 8 },\n\t{ 4, 16 }, { 5, 16 }, { 6, 16 }, { 7, 16 },\n\t{ 0 },\n};\n\n#define CFG_DIV(_id, _offset, _shift, _width, _flags, _table, _ready)\\\n\t[(_id)] = {\\\n\t\t.offset\t= (_offset),\\\n\t\t.shift\t= (_shift),\\\n\t\t.width\t= (_width),\\\n\t\t.flags\t= (_flags),\\\n\t\t.table\t= (_table),\\\n\t\t.ready\t= (_ready),\\\n\t}\n\nstatic const struct stm32_div_cfg stm32mp13_dividers[DIV_NB] = {\n\tCFG_DIV(DIV_RTC, RCC_RTCDIVR, 0, 6, 0, NULL, DIV_NO_RDY),\n\tCFG_DIV(DIV_MCO1, RCC_MCO1CFGR, 4, 4, 0, NULL, DIV_NO_RDY),\n\tCFG_DIV(DIV_MCO2, RCC_MCO2CFGR, 4, 4, 0, NULL, DIV_NO_RDY),\n\tCFG_DIV(DIV_TRACE, RCC_DBGCFGR, 0, 3, 0, ck_trace_div_table, DIV_NO_RDY),\n\tCFG_DIV(DIV_ETH1PTP, RCC_ETH12CKSELR, 4, 4, 0, NULL, DIV_NO_RDY),\n\tCFG_DIV(DIV_ETH2PTP, RCC_ETH12CKSELR, 12, 4, 0, NULL, DIV_NO_RDY),\n};\n\n \nenum enum_mux_cfg {\n\tMUX_ADC1,\n\tMUX_ADC2,\n\tMUX_DCMIPP,\n\tMUX_ETH1,\n\tMUX_ETH2,\n\tMUX_FDCAN,\n\tMUX_FMC,\n\tMUX_I2C12,\n\tMUX_I2C3,\n\tMUX_I2C4,\n\tMUX_I2C5,\n\tMUX_LPTIM1,\n\tMUX_LPTIM2,\n\tMUX_LPTIM3,\n\tMUX_LPTIM45,\n\tMUX_MCO1,\n\tMUX_MCO2,\n\tMUX_QSPI,\n\tMUX_RNG1,\n\tMUX_SAES,\n\tMUX_SAI1,\n\tMUX_SAI2,\n\tMUX_SDMMC1,\n\tMUX_SDMMC2,\n\tMUX_SPDIF,\n\tMUX_SPI1,\n\tMUX_SPI23,\n\tMUX_SPI4,\n\tMUX_SPI5,\n\tMUX_STGEN,\n\tMUX_UART1,\n\tMUX_UART2,\n\tMUX_UART4,\n\tMUX_UART6,\n\tMUX_UART35,\n\tMUX_UART78,\n\tMUX_USBO,\n\tMUX_USBPHY,\n\tMUX_NB\n};\n\n#define _CFG_MUX(_id, _offset, _shift, _witdh, _ready, _flags)\\\n\t[_id] = {\\\n\t\t.offset\t\t= (_offset),\\\n\t\t.shift\t\t= (_shift),\\\n\t\t.width\t\t= (_witdh),\\\n\t\t.ready\t\t= (_ready),\\\n\t\t.flags\t\t= (_flags),\\\n\t}\n\n#define CFG_MUX(_id, _offset, _shift, _witdh)\\\n\t_CFG_MUX(_id, _offset, _shift, _witdh, MUX_NO_RDY, 0)\n\n#define CFG_MUX_SAFE(_id, _offset, _shift, _witdh)\\\n\t_CFG_MUX(_id, _offset, _shift, _witdh, MUX_NO_RDY, MUX_SAFE)\n\nstatic const struct stm32_mux_cfg stm32mp13_muxes[] = {\n\tCFG_MUX(MUX_I2C12,\tRCC_I2C12CKSELR,\t0, 3),\n\tCFG_MUX(MUX_LPTIM45,\tRCC_LPTIM45CKSELR,\t0, 3),\n\tCFG_MUX(MUX_SPI23,\tRCC_SPI2S23CKSELR,\t0, 3),\n\tCFG_MUX(MUX_UART35,\tRCC_UART35CKSELR,\t0, 3),\n\tCFG_MUX(MUX_UART78,\tRCC_UART78CKSELR,\t0, 3),\n\tCFG_MUX(MUX_ADC1,\tRCC_ADC12CKSELR,\t0, 2),\n\tCFG_MUX(MUX_ADC2,\tRCC_ADC12CKSELR,\t2, 2),\n\tCFG_MUX(MUX_DCMIPP,\tRCC_DCMIPPCKSELR,\t0, 2),\n\tCFG_MUX(MUX_ETH1,\tRCC_ETH12CKSELR,\t0, 2),\n\tCFG_MUX(MUX_ETH2,\tRCC_ETH12CKSELR,\t8, 2),\n\tCFG_MUX(MUX_FDCAN,\tRCC_FDCANCKSELR,\t0, 2),\n\tCFG_MUX(MUX_I2C3,\tRCC_I2C345CKSELR,\t0, 3),\n\tCFG_MUX(MUX_I2C4,\tRCC_I2C345CKSELR,\t3, 3),\n\tCFG_MUX(MUX_I2C5,\tRCC_I2C345CKSELR,\t6, 3),\n\tCFG_MUX(MUX_LPTIM1,\tRCC_LPTIM1CKSELR,\t0, 3),\n\tCFG_MUX(MUX_LPTIM2,\tRCC_LPTIM23CKSELR,\t0, 3),\n\tCFG_MUX(MUX_LPTIM3,\tRCC_LPTIM23CKSELR,\t3, 3),\n\tCFG_MUX(MUX_MCO1,\tRCC_MCO1CFGR,\t\t0, 3),\n\tCFG_MUX(MUX_MCO2,\tRCC_MCO2CFGR,\t\t0, 3),\n\tCFG_MUX(MUX_RNG1,\tRCC_RNG1CKSELR,\t\t0, 2),\n\tCFG_MUX(MUX_SAES,\tRCC_SAESCKSELR,\t\t0, 2),\n\tCFG_MUX(MUX_SAI1,\tRCC_SAI1CKSELR,\t\t0, 3),\n\tCFG_MUX(MUX_SAI2,\tRCC_SAI2CKSELR,\t\t0, 3),\n\tCFG_MUX(MUX_SPDIF,\tRCC_SPDIFCKSELR,\t0, 2),\n\tCFG_MUX(MUX_SPI1,\tRCC_SPI2S1CKSELR,\t0, 3),\n\tCFG_MUX(MUX_SPI4,\tRCC_SPI45CKSELR,\t0, 3),\n\tCFG_MUX(MUX_SPI5,\tRCC_SPI45CKSELR,\t3, 3),\n\tCFG_MUX(MUX_STGEN,\tRCC_STGENCKSELR,\t0, 2),\n\tCFG_MUX(MUX_UART1,\tRCC_UART12CKSELR,\t0, 3),\n\tCFG_MUX(MUX_UART2,\tRCC_UART12CKSELR,\t3, 3),\n\tCFG_MUX(MUX_UART4,\tRCC_UART4CKSELR,\t0, 3),\n\tCFG_MUX(MUX_UART6,\tRCC_UART6CKSELR,\t0, 3),\n\tCFG_MUX(MUX_USBO,\tRCC_USBCKSELR,\t\t4, 1),\n\tCFG_MUX(MUX_USBPHY,\tRCC_USBCKSELR,\t\t0, 2),\n\tCFG_MUX_SAFE(MUX_FMC,\tRCC_FMCCKSELR,\t\t0, 2),\n\tCFG_MUX_SAFE(MUX_QSPI,\tRCC_QSPICKSELR,\t\t0, 2),\n\tCFG_MUX_SAFE(MUX_SDMMC1, RCC_SDMMC12CKSELR,\t0, 3),\n\tCFG_MUX_SAFE(MUX_SDMMC2, RCC_SDMMC12CKSELR,\t3, 3),\n};\n\nstruct clk_stm32_securiy {\n\tu32\toffset;\n\tu8\tbit_idx;\n\tunsigned long scmi_id;\n};\n\nenum security_clk {\n\tSECF_NONE,\n\tSECF_LPTIM2,\n\tSECF_LPTIM3,\n\tSECF_VREF,\n\tSECF_DCMIPP,\n\tSECF_USBPHY,\n\tSECF_TZC,\n\tSECF_ETZPC,\n\tSECF_IWDG1,\n\tSECF_BSEC,\n\tSECF_STGENC,\n\tSECF_STGENRO,\n\tSECF_USART1,\n\tSECF_USART2,\n\tSECF_SPI4,\n\tSECF_SPI5,\n\tSECF_I2C3,\n\tSECF_I2C4,\n\tSECF_I2C5,\n\tSECF_TIM12,\n\tSECF_TIM13,\n\tSECF_TIM14,\n\tSECF_TIM15,\n\tSECF_TIM16,\n\tSECF_TIM17,\n\tSECF_DMA3,\n\tSECF_DMAMUX2,\n\tSECF_ADC1,\n\tSECF_ADC2,\n\tSECF_USBO,\n\tSECF_TSC,\n\tSECF_PKA,\n\tSECF_SAES,\n\tSECF_CRYP1,\n\tSECF_HASH1,\n\tSECF_RNG1,\n\tSECF_BKPSRAM,\n\tSECF_MCE,\n\tSECF_FMC,\n\tSECF_QSPI,\n\tSECF_SDMMC1,\n\tSECF_SDMMC2,\n\tSECF_ETH1CK,\n\tSECF_ETH1TX,\n\tSECF_ETH1RX,\n\tSECF_ETH1MAC,\n\tSECF_ETH1STP,\n\tSECF_ETH2CK,\n\tSECF_ETH2TX,\n\tSECF_ETH2RX,\n\tSECF_ETH2MAC,\n\tSECF_ETH2STP,\n\tSECF_MCO1,\n\tSECF_MCO2\n};\n\n#define SECF(_sec_id, _offset, _bit_idx)[_sec_id] = {\\\n\t.offset\t= _offset,\\\n\t.bit_idx\t= _bit_idx,\\\n\t.scmi_id\t= -1,\\\n}\n\nstatic const struct clk_stm32_securiy stm32mp13_security[] = {\n\tSECF(SECF_LPTIM2, RCC_APB3SECSR, RCC_APB3SECSR_LPTIM2SECF),\n\tSECF(SECF_LPTIM3, RCC_APB3SECSR, RCC_APB3SECSR_LPTIM3SECF),\n\tSECF(SECF_VREF, RCC_APB3SECSR, RCC_APB3SECSR_VREFSECF),\n\tSECF(SECF_DCMIPP, RCC_APB4SECSR, RCC_APB4SECSR_DCMIPPSECF),\n\tSECF(SECF_USBPHY, RCC_APB4SECSR, RCC_APB4SECSR_USBPHYSECF),\n\tSECF(SECF_TZC, RCC_APB5SECSR, RCC_APB5SECSR_TZCSECF),\n\tSECF(SECF_ETZPC, RCC_APB5SECSR, RCC_APB5SECSR_ETZPCSECF),\n\tSECF(SECF_IWDG1, RCC_APB5SECSR, RCC_APB5SECSR_IWDG1SECF),\n\tSECF(SECF_BSEC, RCC_APB5SECSR, RCC_APB5SECSR_BSECSECF),\n\tSECF(SECF_STGENC, RCC_APB5SECSR, RCC_APB5SECSR_STGENCSECF),\n\tSECF(SECF_STGENRO, RCC_APB5SECSR, RCC_APB5SECSR_STGENROSECF),\n\tSECF(SECF_USART1, RCC_APB6SECSR, RCC_APB6SECSR_USART1SECF),\n\tSECF(SECF_USART2, RCC_APB6SECSR, RCC_APB6SECSR_USART2SECF),\n\tSECF(SECF_SPI4, RCC_APB6SECSR, RCC_APB6SECSR_SPI4SECF),\n\tSECF(SECF_SPI5, RCC_APB6SECSR, RCC_APB6SECSR_SPI5SECF),\n\tSECF(SECF_I2C3, RCC_APB6SECSR, RCC_APB6SECSR_I2C3SECF),\n\tSECF(SECF_I2C4, RCC_APB6SECSR, RCC_APB6SECSR_I2C4SECF),\n\tSECF(SECF_I2C5, RCC_APB6SECSR, RCC_APB6SECSR_I2C5SECF),\n\tSECF(SECF_TIM12, RCC_APB6SECSR, RCC_APB6SECSR_TIM12SECF),\n\tSECF(SECF_TIM13, RCC_APB6SECSR, RCC_APB6SECSR_TIM13SECF),\n\tSECF(SECF_TIM14, RCC_APB6SECSR, RCC_APB6SECSR_TIM14SECF),\n\tSECF(SECF_TIM15, RCC_APB6SECSR, RCC_APB6SECSR_TIM15SECF),\n\tSECF(SECF_TIM16, RCC_APB6SECSR, RCC_APB6SECSR_TIM16SECF),\n\tSECF(SECF_TIM17, RCC_APB6SECSR, RCC_APB6SECSR_TIM17SECF),\n\tSECF(SECF_DMA3, RCC_AHB2SECSR, RCC_AHB2SECSR_DMA3SECF),\n\tSECF(SECF_DMAMUX2, RCC_AHB2SECSR, RCC_AHB2SECSR_DMAMUX2SECF),\n\tSECF(SECF_ADC1, RCC_AHB2SECSR, RCC_AHB2SECSR_ADC1SECF),\n\tSECF(SECF_ADC2, RCC_AHB2SECSR, RCC_AHB2SECSR_ADC2SECF),\n\tSECF(SECF_USBO, RCC_AHB2SECSR, RCC_AHB2SECSR_USBOSECF),\n\tSECF(SECF_TSC, RCC_AHB4SECSR, RCC_AHB4SECSR_TSCSECF),\n\tSECF(SECF_PKA, RCC_AHB5SECSR, RCC_AHB5SECSR_PKASECF),\n\tSECF(SECF_SAES, RCC_AHB5SECSR, RCC_AHB5SECSR_SAESSECF),\n\tSECF(SECF_CRYP1, RCC_AHB5SECSR, RCC_AHB5SECSR_CRYP1SECF),\n\tSECF(SECF_HASH1, RCC_AHB5SECSR, RCC_AHB5SECSR_HASH1SECF),\n\tSECF(SECF_RNG1, RCC_AHB5SECSR, RCC_AHB5SECSR_RNG1SECF),\n\tSECF(SECF_BKPSRAM, RCC_AHB5SECSR, RCC_AHB5SECSR_BKPSRAMSECF),\n\tSECF(SECF_MCE, RCC_AHB6SECSR, RCC_AHB6SECSR_MCESECF),\n\tSECF(SECF_FMC, RCC_AHB6SECSR, RCC_AHB6SECSR_FMCSECF),\n\tSECF(SECF_QSPI, RCC_AHB6SECSR, RCC_AHB6SECSR_QSPISECF),\n\tSECF(SECF_SDMMC1, RCC_AHB6SECSR, RCC_AHB6SECSR_SDMMC1SECF),\n\tSECF(SECF_SDMMC2, RCC_AHB6SECSR, RCC_AHB6SECSR_SDMMC2SECF),\n\tSECF(SECF_ETH1CK, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH1CKSECF),\n\tSECF(SECF_ETH1TX, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH1TXSECF),\n\tSECF(SECF_ETH1RX, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH1RXSECF),\n\tSECF(SECF_ETH1MAC, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH1MACSECF),\n\tSECF(SECF_ETH1STP, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH1STPSECF),\n\tSECF(SECF_ETH2CK, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH2CKSECF),\n\tSECF(SECF_ETH2TX, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH2TXSECF),\n\tSECF(SECF_ETH2RX, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH2RXSECF),\n\tSECF(SECF_ETH2MAC, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH2MACSECF),\n\tSECF(SECF_ETH2STP, RCC_AHB6SECSR, RCC_AHB6SECSR_ETH2STPSECF),\n\tSECF(SECF_MCO1, RCC_SECCFGR, RCC_SECCFGR_MCO1SEC),\n\tSECF(SECF_MCO2, RCC_SECCFGR, RCC_SECCFGR_MCO2SEC),\n};\n\nstatic const char * const adc12_src[] = {\n\t\"pll4_r\", \"ck_per\", \"pll3_q\"\n};\n\nstatic const char * const dcmipp_src[] = {\n\t\"ck_axi\", \"pll2_q\", \"pll4_p\", \"ck_per\",\n};\n\nstatic const char * const eth12_src[] = {\n\t\"pll4_p\", \"pll3_q\"\n};\n\nstatic const char * const fdcan_src[] = {\n\t\"ck_hse\", \"pll3_q\", \"pll4_q\", \"pll4_r\"\n};\n\nstatic const char * const fmc_src[] = {\n\t\"ck_axi\", \"pll3_r\", \"pll4_p\", \"ck_per\"\n};\n\nstatic const char * const i2c12_src[] = {\n\t\"pclk1\", \"pll4_r\", \"ck_hsi\", \"ck_csi\"\n};\n\nstatic const char * const i2c345_src[] = {\n\t\"pclk6\", \"pll4_r\", \"ck_hsi\", \"ck_csi\"\n};\n\nstatic const char * const lptim1_src[] = {\n\t\"pclk1\", \"pll4_p\", \"pll3_q\", \"ck_lse\", \"ck_lsi\", \"ck_per\"\n};\n\nstatic const char * const lptim23_src[] = {\n\t\"pclk3\", \"pll4_q\", \"ck_per\", \"ck_lse\", \"ck_lsi\"\n};\n\nstatic const char * const lptim45_src[] = {\n\t\"pclk3\", \"pll4_p\", \"pll3_q\", \"ck_lse\", \"ck_lsi\", \"ck_per\"\n};\n\nstatic const char * const mco1_src[] = {\n\t\"ck_hsi\", \"ck_hse\", \"ck_csi\", \"ck_lsi\", \"ck_lse\"\n};\n\nstatic const char * const mco2_src[] = {\n\t\"ck_mpu\", \"ck_axi\", \"ck_mlahb\", \"pll4_p\", \"ck_hse\", \"ck_hsi\"\n};\n\nstatic const char * const qspi_src[] = {\n\t\"ck_axi\", \"pll3_r\", \"pll4_p\", \"ck_per\"\n};\n\nstatic const char * const rng1_src[] = {\n\t\"ck_csi\", \"pll4_r\", \"ck_lse\", \"ck_lsi\"\n};\n\nstatic const char * const saes_src[] = {\n\t\"ck_axi\", \"ck_per\", \"pll4_r\", \"ck_lsi\"\n};\n\nstatic const char * const sai1_src[] = {\n\t\"pll4_q\", \"pll3_q\", \"i2s_ckin\", \"ck_per\", \"pll3_r\"\n};\n\nstatic const char * const sai2_src[] = {\n\t\"pll4_q\", \"pll3_q\", \"i2s_ckin\", \"ck_per\", \"spdif_ck_symb\", \"pll3_r\"\n};\n\nstatic const char * const sdmmc12_src[] = {\n\t\"ck_axi\", \"pll3_r\", \"pll4_p\", \"ck_hsi\"\n};\n\nstatic const char * const spdif_src[] = {\n\t\"pll4_p\", \"pll3_q\", \"ck_hsi\"\n};\n\nstatic const char * const spi123_src[] = {\n\t\"pll4_p\", \"pll3_q\", \"i2s_ckin\", \"ck_per\", \"pll3_r\"\n};\n\nstatic const char * const spi4_src[] = {\n\t\"pclk6\", \"pll4_q\", \"ck_hsi\", \"ck_csi\", \"ck_hse\", \"i2s_ckin\"\n};\n\nstatic const char * const spi5_src[] = {\n\t\"pclk6\", \"pll4_q\", \"ck_hsi\", \"ck_csi\", \"ck_hse\"\n};\n\nstatic const char * const stgen_src[] = {\n\t\"ck_hsi\", \"ck_hse\"\n};\n\nstatic const char * const usart12_src[] = {\n\t\"pclk6\", \"pll3_q\", \"ck_hsi\", \"ck_csi\", \"pll4_q\", \"ck_hse\"\n};\n\nstatic const char * const usart34578_src[] = {\n\t\"pclk1\", \"pll4_q\", \"ck_hsi\", \"ck_csi\", \"ck_hse\"\n};\n\nstatic const char * const usart6_src[] = {\n\t\"pclk2\", \"pll4_q\", \"ck_hsi\", \"ck_csi\", \"ck_hse\"\n};\n\nstatic const char * const usbo_src[] = {\n\t\"pll4_r\", \"ck_usbo_48m\"\n};\n\nstatic const char * const usbphy_src[] = {\n\t\"ck_hse\", \"pll4_r\", \"clk-hse-div2\"\n};\n\n \nstatic struct clk_stm32_gate tim2_k = {\n\t.gate_id = GATE_TIM2,\n\t.hw.init = CLK_HW_INIT(\"tim2_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim3_k = {\n\t.gate_id = GATE_TIM3,\n\t.hw.init = CLK_HW_INIT(\"tim3_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim4_k = {\n\t.gate_id = GATE_TIM4,\n\t.hw.init = CLK_HW_INIT(\"tim4_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim5_k = {\n\t.gate_id = GATE_TIM5,\n\t.hw.init = CLK_HW_INIT(\"tim5_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim6_k = {\n\t.gate_id = GATE_TIM6,\n\t.hw.init = CLK_HW_INIT(\"tim6_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim7_k = {\n\t.gate_id = GATE_TIM7,\n\t.hw.init = CLK_HW_INIT(\"tim7_k\", \"timg1_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim1_k = {\n\t.gate_id = GATE_TIM1,\n\t.hw.init = CLK_HW_INIT(\"tim1_k\", \"timg2_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim8_k = {\n\t.gate_id = GATE_TIM8,\n\t.hw.init = CLK_HW_INIT(\"tim8_k\", \"timg2_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim12_k = {\n\t.gate_id = GATE_TIM12,\n\t.hw.init = CLK_HW_INIT(\"tim12_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim13_k = {\n\t.gate_id = GATE_TIM13,\n\t.hw.init = CLK_HW_INIT(\"tim13_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim14_k = {\n\t.gate_id = GATE_TIM14,\n\t.hw.init = CLK_HW_INIT(\"tim14_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim15_k = {\n\t.gate_id = GATE_TIM15,\n\t.hw.init = CLK_HW_INIT(\"tim15_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim16_k = {\n\t.gate_id = GATE_TIM16,\n\t.hw.init = CLK_HW_INIT(\"tim16_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_gate tim17_k = {\n\t.gate_id = GATE_TIM17,\n\t.hw.init = CLK_HW_INIT(\"tim17_k\", \"timg3_ck\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\n \nstatic struct clk_stm32_gate sai1 = {\n\t.gate_id = GATE_SAI1,\n\t.hw.init = CLK_HW_INIT(\"sai1\", \"pclk2\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate sai2 = {\n\t.gate_id = GATE_SAI2,\n\t.hw.init = CLK_HW_INIT(\"sai2\", \"pclk2\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate syscfg = {\n\t.gate_id = GATE_SYSCFG,\n\t.hw.init = CLK_HW_INIT(\"syscfg\", \"pclk3\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate vref = {\n\t.gate_id = GATE_VREF,\n\t.hw.init = CLK_HW_INIT(\"vref\", \"pclk3\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dts = {\n\t.gate_id = GATE_DTS,\n\t.hw.init = CLK_HW_INIT(\"dts\", \"pclk3\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate pmbctrl = {\n\t.gate_id = GATE_PMBCTRL,\n\t.hw.init = CLK_HW_INIT(\"pmbctrl\", \"pclk3\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate hdp = {\n\t.gate_id = GATE_HDP,\n\t.hw.init = CLK_HW_INIT(\"hdp\", \"pclk3\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate iwdg2 = {\n\t.gate_id = GATE_IWDG2APB,\n\t.hw.init = CLK_HW_INIT(\"iwdg2\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate stgenro = {\n\t.gate_id = GATE_STGENRO,\n\t.hw.init = CLK_HW_INIT(\"stgenro\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpioa = {\n\t.gate_id = GATE_GPIOA,\n\t.hw.init = CLK_HW_INIT(\"gpioa\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpiob = {\n\t.gate_id = GATE_GPIOB,\n\t.hw.init = CLK_HW_INIT(\"gpiob\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpioc = {\n\t.gate_id = GATE_GPIOC,\n\t.hw.init = CLK_HW_INIT(\"gpioc\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpiod = {\n\t.gate_id = GATE_GPIOD,\n\t.hw.init = CLK_HW_INIT(\"gpiod\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpioe = {\n\t.gate_id = GATE_GPIOE,\n\t.hw.init = CLK_HW_INIT(\"gpioe\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpiof = {\n\t.gate_id = GATE_GPIOF,\n\t.hw.init = CLK_HW_INIT(\"gpiof\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpiog = {\n\t.gate_id = GATE_GPIOG,\n\t.hw.init = CLK_HW_INIT(\"gpiog\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpioh = {\n\t.gate_id = GATE_GPIOH,\n\t.hw.init = CLK_HW_INIT(\"gpioh\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate gpioi = {\n\t.gate_id = GATE_GPIOI,\n\t.hw.init = CLK_HW_INIT(\"gpioi\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate tsc = {\n\t.gate_id = GATE_TSC,\n\t.hw.init = CLK_HW_INIT(\"tsc\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate ddrperfm = {\n\t.gate_id = GATE_DDRPERFM,\n\t.hw.init = CLK_HW_INIT(\"ddrperfm\", \"pclk4\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate tzpc = {\n\t.gate_id = GATE_TZC,\n\t.hw.init = CLK_HW_INIT(\"tzpc\", \"pclk5\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate iwdg1 = {\n\t.gate_id = GATE_IWDG1APB,\n\t.hw.init = CLK_HW_INIT(\"iwdg1\", \"pclk5\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate bsec = {\n\t.gate_id = GATE_BSEC,\n\t.hw.init = CLK_HW_INIT(\"bsec\", \"pclk5\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dma1 = {\n\t.gate_id = GATE_DMA1,\n\t.hw.init = CLK_HW_INIT(\"dma1\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dma2 = {\n\t.gate_id = GATE_DMA2,\n\t.hw.init = CLK_HW_INIT(\"dma2\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dmamux1 = {\n\t.gate_id = GATE_DMAMUX1,\n\t.hw.init = CLK_HW_INIT(\"dmamux1\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dma3 = {\n\t.gate_id = GATE_DMA3,\n\t.hw.init = CLK_HW_INIT(\"dma3\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate dmamux2 = {\n\t.gate_id = GATE_DMAMUX2,\n\t.hw.init = CLK_HW_INIT(\"dmamux2\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate adc1 = {\n\t.gate_id = GATE_ADC1,\n\t.hw.init = CLK_HW_INIT(\"adc1\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate adc2 = {\n\t.gate_id = GATE_ADC2,\n\t.hw.init = CLK_HW_INIT(\"adc2\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate pka = {\n\t.gate_id = GATE_PKA,\n\t.hw.init = CLK_HW_INIT(\"pka\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate cryp1 = {\n\t.gate_id = GATE_CRYP1,\n\t.hw.init = CLK_HW_INIT(\"cryp1\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate hash1 = {\n\t.gate_id = GATE_HASH1,\n\t.hw.init = CLK_HW_INIT(\"hash1\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate bkpsram = {\n\t.gate_id = GATE_BKPSRAM,\n\t.hw.init = CLK_HW_INIT(\"bkpsram\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate mdma = {\n\t.gate_id = GATE_MDMA,\n\t.hw.init = CLK_HW_INIT(\"mdma\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth1tx = {\n\t.gate_id = GATE_ETH1TX,\n\t.hw.init = CLK_HW_INIT(\"eth1tx\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth1rx = {\n\t.gate_id = GATE_ETH1RX,\n\t.hw.init = CLK_HW_INIT(\"eth1rx\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth1mac = {\n\t.gate_id = GATE_ETH1MAC,\n\t.hw.init = CLK_HW_INIT(\"eth1mac\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth2tx = {\n\t.gate_id = GATE_ETH2TX,\n\t.hw.init = CLK_HW_INIT(\"eth2tx\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth2rx = {\n\t.gate_id = GATE_ETH2RX,\n\t.hw.init = CLK_HW_INIT(\"eth2rx\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth2mac = {\n\t.gate_id = GATE_ETH2MAC,\n\t.hw.init = CLK_HW_INIT(\"eth2mac\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate crc1 = {\n\t.gate_id = GATE_CRC1,\n\t.hw.init = CLK_HW_INIT(\"crc1\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate usbh = {\n\t.gate_id = GATE_USBH,\n\t.hw.init = CLK_HW_INIT(\"usbh\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth1stp = {\n\t.gate_id = GATE_ETH1STP,\n\t.hw.init = CLK_HW_INIT(\"eth1stp\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate eth2stp = {\n\t.gate_id = GATE_ETH2STP,\n\t.hw.init = CLK_HW_INIT(\"eth2stp\", \"ck_axi\", &clk_stm32_gate_ops, 0),\n};\n\n \nstatic struct clk_stm32_composite sdmmc1_k = {\n\t.gate_id = GATE_SDMMC1,\n\t.mux_id = MUX_SDMMC1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"sdmmc1_k\", sdmmc12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite sdmmc2_k = {\n\t.gate_id = GATE_SDMMC2,\n\t.mux_id = MUX_SDMMC2,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"sdmmc2_k\", sdmmc12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite fmc_k = {\n\t.gate_id = GATE_FMC,\n\t.mux_id = MUX_FMC,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"fmc_k\", fmc_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite qspi_k = {\n\t.gate_id = GATE_QSPI,\n\t.mux_id = MUX_QSPI,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"qspi_k\", qspi_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spi2_k = {\n\t.gate_id = GATE_SPI2,\n\t.mux_id = MUX_SPI23,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spi2_k\", spi123_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spi3_k = {\n\t.gate_id = GATE_SPI3,\n\t.mux_id = MUX_SPI23,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spi3_k\", spi123_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite i2c1_k = {\n\t.gate_id = GATE_I2C1,\n\t.mux_id = MUX_I2C12,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"i2c1_k\", i2c12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite i2c2_k = {\n\t.gate_id = GATE_I2C2,\n\t.mux_id = MUX_I2C12,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"i2c2_k\", i2c12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite lptim4_k = {\n\t.gate_id = GATE_LPTIM4,\n\t.mux_id = MUX_LPTIM45,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"lptim4_k\", lptim45_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite lptim5_k = {\n\t.gate_id = GATE_LPTIM5,\n\t.mux_id = MUX_LPTIM45,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"lptim5_k\", lptim45_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite usart3_k = {\n\t.gate_id = GATE_USART3,\n\t.mux_id = MUX_UART35,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"usart3_k\", usart34578_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite uart5_k = {\n\t.gate_id = GATE_UART5,\n\t.mux_id = MUX_UART35,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"uart5_k\", usart34578_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite uart7_k = {\n\t.gate_id = GATE_UART7,\n\t.mux_id = MUX_UART78,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"uart7_k\", usart34578_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite uart8_k = {\n\t.gate_id = GATE_UART8,\n\t.mux_id = MUX_UART78,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"uart8_k\", usart34578_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite sai1_k = {\n\t.gate_id = GATE_SAI1,\n\t.mux_id = MUX_SAI1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"sai1_k\", sai1_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite adfsdm_k = {\n\t.gate_id = GATE_ADFSDM,\n\t.mux_id = MUX_SAI1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"adfsdm_k\", sai1_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite sai2_k = {\n\t.gate_id = GATE_SAI2,\n\t.mux_id = MUX_SAI2,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"sai2_k\", sai2_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite adc1_k = {\n\t.gate_id = GATE_ADC1,\n\t.mux_id = MUX_ADC1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"adc1_k\", adc12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite adc2_k = {\n\t.gate_id = GATE_ADC2,\n\t.mux_id = MUX_ADC2,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"adc2_k\", adc12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite rng1_k = {\n\t.gate_id = GATE_RNG1,\n\t.mux_id = MUX_RNG1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"rng1_k\", rng1_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite usbphy_k = {\n\t.gate_id = GATE_USBPHY,\n\t.mux_id = MUX_USBPHY,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"usbphy_k\", usbphy_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite stgen_k = {\n\t.gate_id = GATE_STGENC,\n\t.mux_id = MUX_STGEN,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"stgen_k\", stgen_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spdif_k = {\n\t.gate_id = GATE_SPDIF,\n\t.mux_id = MUX_SPDIF,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spdif_k\", spdif_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spi1_k = {\n\t.gate_id = GATE_SPI1,\n\t.mux_id = MUX_SPI1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spi1_k\", spi123_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spi4_k = {\n\t.gate_id = GATE_SPI4,\n\t.mux_id = MUX_SPI4,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spi4_k\", spi4_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite spi5_k = {\n\t.gate_id = GATE_SPI5,\n\t.mux_id = MUX_SPI5,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"spi5_k\", spi5_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite i2c3_k = {\n\t.gate_id = GATE_I2C3,\n\t.mux_id = MUX_I2C3,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"i2c3_k\", i2c345_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite i2c4_k = {\n\t.gate_id = GATE_I2C4,\n\t.mux_id = MUX_I2C4,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"i2c4_k\", i2c345_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite i2c5_k = {\n\t.gate_id = GATE_I2C5,\n\t.mux_id = MUX_I2C5,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"i2c5_k\", i2c345_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite lptim1_k = {\n\t.gate_id = GATE_LPTIM1,\n\t.mux_id = MUX_LPTIM1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"lptim1_k\", lptim1_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite lptim2_k = {\n\t.gate_id = GATE_LPTIM2,\n\t.mux_id = MUX_LPTIM2,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"lptim2_k\", lptim23_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite lptim3_k = {\n\t.gate_id = GATE_LPTIM3,\n\t.mux_id = MUX_LPTIM3,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"lptim3_k\", lptim23_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite usart1_k = {\n\t.gate_id = GATE_USART1,\n\t.mux_id = MUX_UART1,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"usart1_k\", usart12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite usart2_k = {\n\t.gate_id = GATE_USART2,\n\t.mux_id = MUX_UART2,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"usart2_k\", usart12_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite uart4_k = {\n\t.gate_id = GATE_UART4,\n\t.mux_id = MUX_UART4,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"uart4_k\", usart34578_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite uart6_k = {\n\t.gate_id = GATE_USART6,\n\t.mux_id = MUX_UART6,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"uart6_k\", usart6_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite fdcan_k = {\n\t.gate_id = GATE_FDCAN,\n\t.mux_id = MUX_FDCAN,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"fdcan_k\", fdcan_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite dcmipp_k = {\n\t.gate_id = GATE_DCMIPP,\n\t.mux_id = MUX_DCMIPP,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"dcmipp_k\", dcmipp_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite usbo_k = {\n\t.gate_id = GATE_USBO,\n\t.mux_id = MUX_USBO,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"usbo_k\", usbo_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite saes_k = {\n\t.gate_id = GATE_SAES,\n\t.mux_id = MUX_SAES,\n\t.div_id = NO_STM32_DIV,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"saes_k\", saes_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_gate dfsdm_k = {\n\t.gate_id = GATE_DFSDM,\n\t.hw.init = CLK_HW_INIT(\"dfsdm_k\", \"ck_mlahb\", &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_gate ltdc_px = {\n\t.gate_id = GATE_LTDC,\n\t.hw.init = CLK_HW_INIT(\"ltdc_px\", \"pll4_q\", &clk_stm32_gate_ops, CLK_SET_RATE_PARENT),\n};\n\nstatic struct clk_stm32_mux ck_ker_eth1 = {\n\t.mux_id = MUX_ETH1,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"ck_ker_eth1\", eth12_src, &clk_stm32_mux_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_gate eth1ck_k = {\n\t.gate_id = GATE_ETH1CK,\n\t.hw.init = CLK_HW_INIT_HW(\"eth1ck_k\", &ck_ker_eth1.hw, &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_div eth1ptp_k = {\n\t.div_id = DIV_ETH1PTP,\n\t.hw.init = CLK_HW_INIT_HW(\"eth1ptp_k\", &ck_ker_eth1.hw, &clk_stm32_divider_ops,\n\t\t\t\t  CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_mux ck_ker_eth2 = {\n\t.mux_id = MUX_ETH2,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"ck_ker_eth2\", eth12_src, &clk_stm32_mux_ops,\n\t\t\t\t\t    CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_gate eth2ck_k = {\n\t.gate_id = GATE_ETH2CK,\n\t.hw.init = CLK_HW_INIT_HW(\"eth2ck_k\", &ck_ker_eth2.hw, &clk_stm32_gate_ops, 0),\n};\n\nstatic struct clk_stm32_div eth2ptp_k = {\n\t.div_id = DIV_ETH2PTP,\n\t.hw.init = CLK_HW_INIT_HW(\"eth2ptp_k\", &ck_ker_eth2.hw, &clk_stm32_divider_ops,\n\t\t\t\t  CLK_SET_RATE_NO_REPARENT),\n};\n\nstatic struct clk_stm32_composite ck_mco1 = {\n\t.gate_id = GATE_MCO1,\n\t.mux_id = MUX_MCO1,\n\t.div_id = DIV_MCO1,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"ck_mco1\", mco1_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT |\n\t\t\t\t       CLK_IGNORE_UNUSED),\n};\n\nstatic struct clk_stm32_composite ck_mco2 = {\n\t.gate_id = GATE_MCO2,\n\t.mux_id = MUX_MCO2,\n\t.div_id = DIV_MCO2,\n\t.hw.init = CLK_HW_INIT_PARENTS(\"ck_mco2\", mco2_src, &clk_stm32_composite_ops,\n\t\t\t\t       CLK_OPS_PARENT_ENABLE | CLK_SET_RATE_NO_REPARENT |\n\t\t\t\t       CLK_IGNORE_UNUSED),\n};\n\n \nstatic struct clk_stm32_gate ck_sys_dbg = {\n\t.gate_id = GATE_DBGCK,\n\t.hw.init = CLK_HW_INIT(\"ck_sys_dbg\", \"ck_axi\", &clk_stm32_gate_ops, CLK_IS_CRITICAL),\n};\n\nstatic struct clk_stm32_composite ck_trace = {\n\t.gate_id = GATE_TRACECK,\n\t.mux_id = NO_STM32_MUX,\n\t.div_id = DIV_TRACE,\n\t.hw.init = CLK_HW_INIT(\"ck_trace\", \"ck_axi\", &clk_stm32_composite_ops, CLK_IGNORE_UNUSED),\n};\n\nstatic const struct clock_config stm32mp13_clock_cfg[] = {\n\t \n\tSTM32_GATE_CFG(TIM2_K, tim2_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM3_K, tim3_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM4_K, tim4_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM5_K, tim5_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM6_K, tim6_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM7_K, tim7_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM1_K, tim1_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM8_K, tim8_k, SECF_NONE),\n\tSTM32_GATE_CFG(TIM12_K, tim12_k, SECF_TIM12),\n\tSTM32_GATE_CFG(TIM13_K, tim13_k, SECF_TIM13),\n\tSTM32_GATE_CFG(TIM14_K, tim14_k, SECF_TIM14),\n\tSTM32_GATE_CFG(TIM15_K, tim15_k, SECF_TIM15),\n\tSTM32_GATE_CFG(TIM16_K, tim16_k, SECF_TIM16),\n\tSTM32_GATE_CFG(TIM17_K, tim17_k, SECF_TIM17),\n\n\t \n\tSTM32_GATE_CFG(SAI1, sai1, SECF_NONE),\n\tSTM32_GATE_CFG(SAI2, sai2, SECF_NONE),\n\tSTM32_GATE_CFG(SYSCFG, syscfg, SECF_NONE),\n\tSTM32_GATE_CFG(VREF, vref, SECF_VREF),\n\tSTM32_GATE_CFG(DTS, dts, SECF_NONE),\n\tSTM32_GATE_CFG(PMBCTRL, pmbctrl, SECF_NONE),\n\tSTM32_GATE_CFG(HDP, hdp, SECF_NONE),\n\tSTM32_GATE_CFG(IWDG2, iwdg2, SECF_NONE),\n\tSTM32_GATE_CFG(STGENRO, stgenro, SECF_STGENRO),\n\tSTM32_GATE_CFG(TZPC, tzpc, SECF_TZC),\n\tSTM32_GATE_CFG(IWDG1, iwdg1, SECF_IWDG1),\n\tSTM32_GATE_CFG(BSEC, bsec, SECF_BSEC),\n\tSTM32_GATE_CFG(DMA1, dma1, SECF_NONE),\n\tSTM32_GATE_CFG(DMA2, dma2, SECF_NONE),\n\tSTM32_GATE_CFG(DMAMUX1, dmamux1, SECF_NONE),\n\tSTM32_GATE_CFG(DMA3, dma3, SECF_DMA3),\n\tSTM32_GATE_CFG(DMAMUX2, dmamux2, SECF_DMAMUX2),\n\tSTM32_GATE_CFG(ADC1, adc1, SECF_ADC1),\n\tSTM32_GATE_CFG(ADC2, adc2, SECF_ADC2),\n\tSTM32_GATE_CFG(GPIOA, gpioa, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOB, gpiob, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOC, gpioc, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOD, gpiod, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOE, gpioe, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOF, gpiof, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOG, gpiog, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOH, gpioh, SECF_NONE),\n\tSTM32_GATE_CFG(GPIOI, gpioi, SECF_NONE),\n\tSTM32_GATE_CFG(TSC, tsc, SECF_TZC),\n\tSTM32_GATE_CFG(PKA, pka, SECF_PKA),\n\tSTM32_GATE_CFG(CRYP1, cryp1, SECF_CRYP1),\n\tSTM32_GATE_CFG(HASH1, hash1, SECF_HASH1),\n\tSTM32_GATE_CFG(BKPSRAM, bkpsram, SECF_BKPSRAM),\n\tSTM32_GATE_CFG(MDMA, mdma, SECF_NONE),\n\tSTM32_GATE_CFG(ETH1TX, eth1tx, SECF_ETH1TX),\n\tSTM32_GATE_CFG(ETH1RX, eth1rx, SECF_ETH1RX),\n\tSTM32_GATE_CFG(ETH1MAC, eth1mac, SECF_ETH1MAC),\n\tSTM32_GATE_CFG(ETH2TX, eth2tx, SECF_ETH2TX),\n\tSTM32_GATE_CFG(ETH2RX, eth2rx, SECF_ETH2RX),\n\tSTM32_GATE_CFG(ETH2MAC, eth2mac, SECF_ETH2MAC),\n\tSTM32_GATE_CFG(CRC1, crc1, SECF_NONE),\n\tSTM32_GATE_CFG(USBH, usbh, SECF_NONE),\n\tSTM32_GATE_CFG(DDRPERFM, ddrperfm, SECF_NONE),\n\tSTM32_GATE_CFG(ETH1STP, eth1stp, SECF_ETH1STP),\n\tSTM32_GATE_CFG(ETH2STP, eth2stp, SECF_ETH2STP),\n\n\t \n\tSTM32_COMPOSITE_CFG(SDMMC1_K, sdmmc1_k, SECF_SDMMC1),\n\tSTM32_COMPOSITE_CFG(SDMMC2_K, sdmmc2_k, SECF_SDMMC2),\n\tSTM32_COMPOSITE_CFG(FMC_K, fmc_k, SECF_FMC),\n\tSTM32_COMPOSITE_CFG(QSPI_K, qspi_k, SECF_QSPI),\n\tSTM32_COMPOSITE_CFG(SPI2_K, spi2_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(SPI3_K, spi3_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(I2C1_K, i2c1_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(I2C2_K, i2c2_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(LPTIM4_K, lptim4_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(LPTIM5_K, lptim5_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(USART3_K, usart3_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(UART5_K, uart5_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(UART7_K, uart7_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(UART8_K, uart8_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(SAI1_K, sai1_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(SAI2_K, sai2_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(ADFSDM_K, adfsdm_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(ADC1_K, adc1_k, SECF_ADC1),\n\tSTM32_COMPOSITE_CFG(ADC2_K, adc2_k, SECF_ADC2),\n\tSTM32_COMPOSITE_CFG(RNG1_K, rng1_k, SECF_RNG1),\n\tSTM32_COMPOSITE_CFG(USBPHY_K, usbphy_k, SECF_USBPHY),\n\tSTM32_COMPOSITE_CFG(STGEN_K, stgen_k, SECF_STGENC),\n\tSTM32_COMPOSITE_CFG(SPDIF_K, spdif_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(SPI1_K, spi1_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(SPI4_K, spi4_k, SECF_SPI4),\n\tSTM32_COMPOSITE_CFG(SPI5_K, spi5_k, SECF_SPI5),\n\tSTM32_COMPOSITE_CFG(I2C3_K, i2c3_k, SECF_I2C3),\n\tSTM32_COMPOSITE_CFG(I2C4_K, i2c4_k, SECF_I2C4),\n\tSTM32_COMPOSITE_CFG(I2C5_K, i2c5_k, SECF_I2C5),\n\tSTM32_COMPOSITE_CFG(LPTIM1_K, lptim1_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(LPTIM2_K, lptim2_k, SECF_LPTIM2),\n\tSTM32_COMPOSITE_CFG(LPTIM3_K, lptim3_k, SECF_LPTIM3),\n\tSTM32_COMPOSITE_CFG(USART1_K, usart1_k, SECF_USART1),\n\tSTM32_COMPOSITE_CFG(USART2_K, usart2_k, SECF_USART2),\n\tSTM32_COMPOSITE_CFG(UART4_K, uart4_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(USART6_K, uart6_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(FDCAN_K, fdcan_k, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(DCMIPP_K, dcmipp_k, SECF_DCMIPP),\n\tSTM32_COMPOSITE_CFG(USBO_K, usbo_k, SECF_USBO),\n\tSTM32_COMPOSITE_CFG(SAES_K, saes_k, SECF_SAES),\n\tSTM32_GATE_CFG(DFSDM_K, dfsdm_k, SECF_NONE),\n\tSTM32_GATE_CFG(LTDC_PX, ltdc_px, SECF_NONE),\n\n\tSTM32_MUX_CFG(NO_ID, ck_ker_eth1, SECF_ETH1CK),\n\tSTM32_GATE_CFG(ETH1CK_K, eth1ck_k, SECF_ETH1CK),\n\tSTM32_DIV_CFG(ETH1PTP_K, eth1ptp_k, SECF_ETH1CK),\n\n\tSTM32_MUX_CFG(NO_ID, ck_ker_eth2, SECF_ETH2CK),\n\tSTM32_GATE_CFG(ETH2CK_K, eth2ck_k, SECF_ETH2CK),\n\tSTM32_DIV_CFG(ETH2PTP_K, eth2ptp_k, SECF_ETH2CK),\n\n\tSTM32_GATE_CFG(CK_DBG, ck_sys_dbg, SECF_NONE),\n\tSTM32_COMPOSITE_CFG(CK_TRACE, ck_trace, SECF_NONE),\n\n\tSTM32_COMPOSITE_CFG(CK_MCO1, ck_mco1, SECF_MCO1),\n\tSTM32_COMPOSITE_CFG(CK_MCO2, ck_mco2, SECF_MCO2),\n};\n\nstatic int stm32mp13_clock_is_provided_by_secure(void __iomem *base,\n\t\t\t\t\t\t const struct clock_config *cfg)\n{\n\tint sec_id = cfg->sec_id;\n\n\tif (sec_id != SECF_NONE) {\n\t\tconst struct clk_stm32_securiy *secf;\n\n\t\tsecf = &stm32mp13_security[sec_id];\n\n\t\treturn !!(readl(base + secf->offset) & BIT(secf->bit_idx));\n\t}\n\n\treturn 0;\n}\n\nstruct multi_mux {\n\tstruct clk_hw *hw1;\n\tstruct clk_hw *hw2;\n};\n\nstatic struct multi_mux *stm32_mp13_multi_mux[MUX_NB] = {\n\t[MUX_SPI23]\t= &(struct multi_mux){ &spi2_k.hw,\t&spi3_k.hw },\n\t[MUX_I2C12]\t= &(struct multi_mux){ &i2c1_k.hw,\t&i2c2_k.hw },\n\t[MUX_LPTIM45]\t= &(struct multi_mux){ &lptim4_k.hw,\t&lptim5_k.hw },\n\t[MUX_UART35]\t= &(struct multi_mux){ &usart3_k.hw,\t&uart5_k.hw },\n\t[MUX_UART78]\t= &(struct multi_mux){ &uart7_k.hw,\t&uart8_k.hw },\n\t[MUX_SAI1]\t= &(struct multi_mux){ &sai1_k.hw,\t&adfsdm_k.hw },\n};\n\nstatic struct clk_hw *stm32mp13_is_multi_mux(struct clk_hw *hw)\n{\n\tstruct clk_stm32_composite *composite = to_clk_stm32_composite(hw);\n\tstruct multi_mux *mmux = stm32_mp13_multi_mux[composite->mux_id];\n\n\tif (mmux) {\n\t\tif (!(mmux->hw1 == hw))\n\t\t\treturn mmux->hw1;\n\t\telse\n\t\t\treturn mmux->hw2;\n\t}\n\n\treturn NULL;\n}\n\nstatic u16 stm32mp13_cpt_gate[GATE_NB];\n\nstatic struct clk_stm32_clock_data stm32mp13_clock_data = {\n\t.gate_cpt\t= stm32mp13_cpt_gate,\n\t.gates\t\t= stm32mp13_gates,\n\t.muxes\t\t= stm32mp13_muxes,\n\t.dividers\t= stm32mp13_dividers,\n\t.is_multi_mux\t= stm32mp13_is_multi_mux,\n};\n\nstatic const struct stm32_rcc_match_data stm32mp13_data = {\n\t.tab_clocks\t= stm32mp13_clock_cfg,\n\t.num_clocks\t= ARRAY_SIZE(stm32mp13_clock_cfg),\n\t.clock_data\t= &stm32mp13_clock_data,\n\t.check_security = &stm32mp13_clock_is_provided_by_secure,\n\t.maxbinding\t= STM32MP1_LAST_CLK,\n\t.clear_offset\t= RCC_CLR_OFFSET,\n};\n\nstatic const struct of_device_id stm32mp13_match_data[] = {\n\t{\n\t\t.compatible = \"st,stm32mp13-rcc\",\n\t\t.data = &stm32mp13_data,\n\t},\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, stm32mp13_match_data);\n\nstatic int stm32mp1_rcc_init(struct device *dev)\n{\n\tvoid __iomem *rcc_base;\n\tint ret = -ENOMEM;\n\n\trcc_base = of_iomap(dev_of_node(dev), 0);\n\tif (!rcc_base) {\n\t\tdev_err(dev, \"%pOFn: unable to map resource\", dev_of_node(dev));\n\t\tgoto out;\n\t}\n\n\tret = stm32_rcc_init(dev, stm32mp13_match_data, rcc_base);\nout:\n\tif (ret) {\n\t\tif (rcc_base)\n\t\t\tiounmap(rcc_base);\n\n\t\tof_node_put(dev_of_node(dev));\n\t}\n\n\treturn ret;\n}\n\nstatic int get_clock_deps(struct device *dev)\n{\n\tstatic const char * const clock_deps_name[] = {\n\t\t\"hsi\", \"hse\", \"csi\", \"lsi\", \"lse\",\n\t};\n\tsize_t deps_size = sizeof(struct clk *) * ARRAY_SIZE(clock_deps_name);\n\tstruct clk **clk_deps;\n\tint i;\n\n\tclk_deps = devm_kzalloc(dev, deps_size, GFP_KERNEL);\n\tif (!clk_deps)\n\t\treturn -ENOMEM;\n\n\tfor (i = 0; i < ARRAY_SIZE(clock_deps_name); i++) {\n\t\tstruct clk *clk = of_clk_get_by_name(dev_of_node(dev),\n\t\t\t\t\t\t     clock_deps_name[i]);\n\n\t\tif (IS_ERR(clk)) {\n\t\t\tif (PTR_ERR(clk) != -EINVAL && PTR_ERR(clk) != -ENOENT)\n\t\t\t\treturn PTR_ERR(clk);\n\t\t} else {\n\t\t\t \n\t\t\tclk_deps[i] = devm_clk_get(dev, __clk_get_name(clk));\n\t\t\tclk_put(clk);\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int stm32mp1_rcc_clocks_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tint ret = get_clock_deps(dev);\n\n\tif (!ret)\n\t\tret = stm32mp1_rcc_init(dev);\n\n\treturn ret;\n}\n\nstatic void stm32mp1_rcc_clocks_remove(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct device_node *child, *np = dev_of_node(dev);\n\n\tfor_each_available_child_of_node(np, child)\n\t\tof_clk_del_provider(child);\n}\n\nstatic struct platform_driver stm32mp13_rcc_clocks_driver = {\n\t.driver\t= {\n\t\t.name = \"stm32mp13_rcc\",\n\t\t.of_match_table = stm32mp13_match_data,\n\t},\n\t.probe = stm32mp1_rcc_clocks_probe,\n\t.remove_new = stm32mp1_rcc_clocks_remove,\n};\n\nstatic int __init stm32mp13_clocks_init(void)\n{\n\treturn platform_driver_register(&stm32mp13_rcc_clocks_driver);\n}\ncore_initcall(stm32mp13_clocks_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}