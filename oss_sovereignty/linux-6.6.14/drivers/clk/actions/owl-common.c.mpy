{
  "module_name": "owl-common.c",
  "hash_id": "ff51813323e8a3d26b848d28df72bd6e905a1ea17984aee54f819226551f5084",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/actions/owl-common.c",
  "human_readable_source": "\n\n\n\n\n\n\n\n\n\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n\n#include \"owl-common.h\"\n\nstatic const struct regmap_config owl_regmap_config = {\n\t.reg_bits\t= 32,\n\t.reg_stride\t= 4,\n\t.val_bits\t= 32,\n\t.max_register\t= 0x00cc,\n\t.fast_io\t= true,\n};\n\nstatic void owl_clk_set_regmap(const struct owl_clk_desc *desc,\n\t\t\t struct regmap *regmap)\n{\n\tint i;\n\tstruct owl_clk_common *clks;\n\n\tfor (i = 0; i < desc->num_clks; i++) {\n\t\tclks = desc->clks[i];\n\t\tif (!clks)\n\t\t\tcontinue;\n\n\t\tclks->regmap = regmap;\n\t}\n}\n\nint owl_clk_regmap_init(struct platform_device *pdev,\n\t\t\tstruct owl_clk_desc *desc)\n{\n\tvoid __iomem *base;\n\tstruct regmap *regmap;\n\n\tbase = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base))\n\t\treturn PTR_ERR(base);\n\n\tregmap = devm_regmap_init_mmio(&pdev->dev, base, &owl_regmap_config);\n\tif (IS_ERR(regmap)) {\n\t\tpr_err(\"failed to init regmap\\n\");\n\t\treturn PTR_ERR(regmap);\n\t}\n\n\towl_clk_set_regmap(desc, regmap);\n\tdesc->regmap = regmap;\n\n\treturn 0;\n}\n\nint owl_clk_probe(struct device *dev, struct clk_hw_onecell_data *hw_clks)\n{\n\tint i, ret;\n\tstruct clk_hw *hw;\n\n\tfor (i = 0; i < hw_clks->num; i++) {\n\t\tconst char *name;\n\n\t\thw = hw_clks->hws[i];\n\t\tif (IS_ERR_OR_NULL(hw))\n\t\t\tcontinue;\n\n\t\tname = hw->init->name;\n\t\tret = devm_clk_hw_register(dev, hw);\n\t\tif (ret) {\n\t\t\tdev_err(dev, \"Couldn't register clock %d - %s\\n\",\n\t\t\t\ti, name);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tret = devm_of_clk_add_hw_provider(dev, of_clk_hw_onecell_get, hw_clks);\n\tif (ret)\n\t\tdev_err(dev, \"Failed to add clock provider\\n\");\n\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}