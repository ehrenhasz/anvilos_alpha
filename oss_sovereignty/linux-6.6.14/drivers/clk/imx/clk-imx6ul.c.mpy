{
  "module_name": "clk-imx6ul.c",
  "hash_id": "574109d94a7ccd12520df153b31e80bfc204c4241aa376657bb0329d433022df",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/imx/clk-imx6ul.c",
  "human_readable_source": "\n \n\n#include <dt-bindings/clock/imx6ul-clock.h>\n#include <linux/clk.h>\n#include <linux/clkdev.h>\n#include <linux/clk-provider.h>\n#include <linux/err.h>\n#include <linux/init.h>\n#include <linux/io.h>\n#include <linux/mfd/syscon/imx6q-iomuxc-gpr.h>\n#include <linux/of.h>\n#include <linux/of_address.h>\n#include <linux/of_irq.h>\n#include <linux/types.h>\n\n#include \"clk.h\"\n\nstatic const char *pll_bypass_src_sels[] = { \"osc\", \"dummy\", };\nstatic const char *pll1_bypass_sels[] = { \"pll1\", \"pll1_bypass_src\", };\nstatic const char *pll2_bypass_sels[] = { \"pll2\", \"pll2_bypass_src\", };\nstatic const char *pll3_bypass_sels[] = { \"pll3\", \"pll3_bypass_src\", };\nstatic const char *pll4_bypass_sels[] = { \"pll4\", \"pll4_bypass_src\", };\nstatic const char *pll5_bypass_sels[] = { \"pll5\", \"pll5_bypass_src\", };\nstatic const char *pll6_bypass_sels[] = { \"pll6\", \"pll6_bypass_src\", };\nstatic const char *pll7_bypass_sels[] = { \"pll7\", \"pll7_bypass_src\", };\nstatic const char *ca7_secondary_sels[] = { \"pll2_pfd2_396m\", \"pll2_bus\", };\nstatic const char *step_sels[] = { \"osc\", \"ca7_secondary_sel\", };\nstatic const char *pll1_sw_sels[] = { \"pll1_sys\", \"step\", };\nstatic const char *axi_alt_sels[] = { \"pll2_pfd2_396m\", \"pll3_pfd1_540m\", };\nstatic const char *axi_sels[] = {\"periph\", \"axi_alt_sel\", };\nstatic const char *periph_pre_sels[] = { \"pll2_bus\", \"pll2_pfd2_396m\", \"pll2_pfd0_352m\", \"pll2_198m\", };\nstatic const char *periph2_pre_sels[] = { \"pll2_bus\", \"pll2_pfd2_396m\", \"pll2_pfd0_352m\", \"pll4_audio_div\", };\nstatic const char *periph_clk2_sels[] = { \"pll3_usb_otg\", \"osc\", \"pll2_bypass_src\", };\nstatic const char *periph2_clk2_sels[] = { \"pll3_usb_otg\", \"osc\", };\nstatic const char *periph_sels[] = { \"periph_pre\", \"periph_clk2\", };\nstatic const char *periph2_sels[] = { \"periph2_pre\", \"periph2_clk2\", };\nstatic const char *usdhc_sels[] = { \"pll2_pfd2_396m\", \"pll2_pfd0_352m\", };\nstatic const char *bch_sels[] = { \"pll2_pfd2_396m\", \"pll2_pfd0_352m\", };\nstatic const char *gpmi_sels[] = { \"pll2_pfd2_396m\", \"pll2_pfd0_352m\", };\nstatic const char *eim_slow_sels[] =  { \"axi\", \"pll3_usb_otg\", \"pll2_pfd2_396m\", \"pll3_pfd0_720m\", };\nstatic const char *spdif_sels[] = { \"pll4_audio_div\", \"pll3_pfd2_508m\", \"pll5_video_div\", \"pll3_usb_otg\", };\nstatic const char *sai_sels[] = { \"pll3_pfd2_508m\", \"pll5_video_div\", \"pll4_audio_div\", };\nstatic const char *lcdif_pre_sels[] = { \"pll2_bus\", \"pll3_pfd3_454m\", \"pll5_video_div\", \"pll2_pfd0_352m\", \"pll2_pfd1_594m\", \"pll3_pfd1_540m\", };\nstatic const char *sim_pre_sels[] = { \"pll2_bus\", \"pll3_usb_otg\", \"pll5_video_div\", \"pll2_pfd0_352m\", \"pll2_pfd2_396m\", \"pll3_pfd2_508m\", };\nstatic const char *ldb_di0_sels[] = { \"pll5_video_div\", \"pll2_pfd0_352m\", \"pll2_pfd2_396m\", \"pll2_pfd3_594m\", \"pll2_pfd1_594m\", \"pll3_pfd3_454m\", };\nstatic const char *ldb_di0_div_sels[] = { \"ldb_di0_div_3_5\", \"ldb_di0_div_7\", };\nstatic const char *ldb_di1_div_sels[] = { \"ldb_di1_div_3_5\", \"ldb_di1_div_7\", };\nstatic const char *qspi1_sels[] = { \"pll3_usb_otg\", \"pll2_pfd0_352m\", \"pll2_pfd2_396m\", \"pll2_bus\", \"pll3_pfd3_454m\", \"pll3_pfd2_508m\", };\nstatic const char *enfc_sels[] = { \"pll2_pfd0_352m\", \"pll2_bus\", \"pll3_usb_otg\", \"pll2_pfd2_396m\", \"pll3_pfd3_454m\", \"dummy\", \"dummy\", \"dummy\", };\nstatic const char *can_sels[] = { \"pll3_60m\", \"osc\", \"pll3_80m\", \"dummy\", };\nstatic const char *ecspi_sels[] = { \"pll3_60m\", \"osc\", };\nstatic const char *uart_sels[] = { \"pll3_80m\", \"osc\", };\nstatic const char *perclk_sels[] = { \"ipg\", \"osc\", };\nstatic const char *lcdif_sels[] = { \"lcdif_podf\", \"ipp_di0\", \"ipp_di1\", \"ldb_di0\", \"ldb_di1\", };\nstatic const char *csi_sels[] = { \"osc\", \"pll2_pfd2_396m\", \"pll3_120m\", \"pll3_pfd1_540m\", };\nstatic const char *sim_sels[] = { \"sim_podf\", \"ipp_di0\", \"ipp_di1\", \"ldb_di0\", \"ldb_di1\", };\n \nstatic const char *epdc_pre_sels[] = { \"pll2_bus\", \"pll3_usb_otg\", \"pll5_video_div\", \"pll2_pfd0_352m\", \"pll2_pfd2_396m\", \"pll3_pfd2_508m\", };\nstatic const char *esai_sels[] = { \"pll4_audio_div\", \"pll3_pfd2_508m\", \"pll5_video_div\", \"pll3_usb_otg\", };\nstatic const char *epdc_sels[] = { \"epdc_podf\", \"ipp_di0\", \"ipp_di1\", \"ldb_di0\", \"ldb_di1\", };\nstatic const char *cko1_sels[] = { \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"axi\", \"enfc\", \"dummy\", \"dummy\",\n\t\t\t\t   \"dummy\", \"lcdif_pix\", \"ahb\", \"ipg\", \"ipg_per\", \"ckil\", \"pll4_audio_div\", };\nstatic const char *cko2_sels[] = { \"dummy\", \"dummy\", \"dummy\", \"usdhc1\", \"dummy\", \"dummy\", \"ecspi_root\", \"dummy\",\n\t\t\t\t   \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"osc\", \"dummy\",\n\t\t\t\t   \"dummy\", \"usdhc2\", \"sai1\", \"sai2\", \"sai3\", \"dummy\", \"dummy\", \"can_root\",\n\t\t\t\t   \"dummy\", \"dummy\", \"dummy\", \"dummy\", \"uart_serial\", \"spdif\", \"dummy\", \"dummy\", };\nstatic const char *cko_sels[] = { \"cko1\", \"cko2\", };\n\nstatic struct clk_hw **hws;\nstatic struct clk_hw_onecell_data *clk_hw_data;\n\nstatic const struct clk_div_table clk_enet_ref_table[] = {\n\t{ .val = 0, .div = 20, },\n\t{ .val = 1, .div = 10, },\n\t{ .val = 2, .div = 5, },\n\t{ .val = 3, .div = 4, },\n\t{ }\n};\n\nstatic const struct clk_div_table post_div_table[] = {\n\t{ .val = 2, .div = 1, },\n\t{ .val = 1, .div = 2, },\n\t{ .val = 0, .div = 4, },\n\t{ }\n};\n\nstatic const struct clk_div_table video_div_table[] = {\n\t{ .val = 0, .div = 1, },\n\t{ .val = 1, .div = 2, },\n\t{ .val = 2, .div = 1, },\n\t{ .val = 3, .div = 4, },\n\t{ }\n};\n\nstatic const char * enet1_ref_sels[] = { \"enet1_ref_125m\", \"enet1_ref_pad\", \"dummy\", \"dummy\"};\nstatic const u32 enet1_ref_sels_table[] = { IMX6UL_GPR1_ENET1_TX_CLK_DIR,\n\t\t\t\t\t    IMX6UL_GPR1_ENET1_CLK_SEL, 0,\n\t\t\t\t\t    IMX6UL_GPR1_ENET1_TX_CLK_DIR | IMX6UL_GPR1_ENET1_CLK_SEL };\nstatic const u32 enet1_ref_sels_table_mask = IMX6UL_GPR1_ENET1_TX_CLK_DIR |\n\t\t\t\t\t     IMX6UL_GPR1_ENET1_CLK_SEL;\nstatic const char * enet2_ref_sels[] = { \"enet2_ref_125m\", \"enet2_ref_pad\", \"dummy\", \"dummy\"};\nstatic const u32 enet2_ref_sels_table[] = { IMX6UL_GPR1_ENET2_TX_CLK_DIR,\n\t\t\t\t\t    IMX6UL_GPR1_ENET2_CLK_SEL, 0,\n\t\t\t\t\t    IMX6UL_GPR1_ENET2_TX_CLK_DIR | IMX6UL_GPR1_ENET2_CLK_SEL };\nstatic const u32 enet2_ref_sels_table_mask = IMX6UL_GPR1_ENET2_TX_CLK_DIR |\n\t\t\t\t\t     IMX6UL_GPR1_ENET2_CLK_SEL;\n\nstatic u32 share_count_asrc;\nstatic u32 share_count_audio;\nstatic u32 share_count_sai1;\nstatic u32 share_count_sai2;\nstatic u32 share_count_sai3;\nstatic u32 share_count_esai;\n\nstatic inline int clk_on_imx6ul(void)\n{\n\treturn of_machine_is_compatible(\"fsl,imx6ul\");\n}\n\nstatic inline int clk_on_imx6ull(void)\n{\n\treturn of_machine_is_compatible(\"fsl,imx6ull\");\n}\n\nstatic void __init imx6ul_clocks_init(struct device_node *ccm_node)\n{\n\tstruct device_node *np;\n\tvoid __iomem *base;\n\n\tclk_hw_data = kzalloc(struct_size(clk_hw_data, hws,\n\t\t\t\t\t  IMX6UL_CLK_END), GFP_KERNEL);\n\tif (WARN_ON(!clk_hw_data))\n\t\treturn;\n\n\tclk_hw_data->num = IMX6UL_CLK_END;\n\thws = clk_hw_data->hws;\n\n\thws[IMX6UL_CLK_DUMMY] = imx_clk_hw_fixed(\"dummy\", 0);\n\n\thws[IMX6UL_CLK_CKIL] = imx_get_clk_hw_by_name(ccm_node, \"ckil\");\n\thws[IMX6UL_CLK_OSC] = imx_get_clk_hw_by_name(ccm_node, \"osc\");\n\n\t \n\thws[IMX6UL_CLK_IPP_DI0] = imx_get_clk_hw_by_name(ccm_node, \"ipp_di0\");\n\thws[IMX6UL_CLK_IPP_DI1] = imx_get_clk_hw_by_name(ccm_node, \"ipp_di1\");\n\n\tnp = of_find_compatible_node(NULL, NULL, \"fsl,imx6ul-anatop\");\n\tbase = of_iomap(np, 0);\n\tof_node_put(np);\n\tWARN_ON(!base);\n\n\thws[IMX6UL_PLL1_BYPASS_SRC] = imx_clk_hw_mux(\"pll1_bypass_src\", base + 0x00, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL2_BYPASS_SRC] = imx_clk_hw_mux(\"pll2_bypass_src\", base + 0x30, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL3_BYPASS_SRC] = imx_clk_hw_mux(\"pll3_bypass_src\", base + 0x10, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL4_BYPASS_SRC] = imx_clk_hw_mux(\"pll4_bypass_src\", base + 0x70, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL5_BYPASS_SRC] = imx_clk_hw_mux(\"pll5_bypass_src\", base + 0xa0, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL6_BYPASS_SRC] = imx_clk_hw_mux(\"pll6_bypass_src\", base + 0xe0, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\thws[IMX6UL_PLL7_BYPASS_SRC] = imx_clk_hw_mux(\"pll7_bypass_src\", base + 0x20, 14, 1, pll_bypass_src_sels, ARRAY_SIZE(pll_bypass_src_sels));\n\n\thws[IMX6UL_CLK_PLL1] = imx_clk_hw_pllv3(IMX_PLLV3_SYS,\t \"pll1\", \"osc\", base + 0x00, 0x7f);\n\thws[IMX6UL_CLK_PLL2] = imx_clk_hw_pllv3(IMX_PLLV3_GENERIC, \"pll2\", \"osc\", base + 0x30, 0x1);\n\thws[IMX6UL_CLK_PLL3] = imx_clk_hw_pllv3(IMX_PLLV3_USB,\t \"pll3\", \"osc\", base + 0x10, 0x3);\n\thws[IMX6UL_CLK_PLL4] = imx_clk_hw_pllv3(IMX_PLLV3_AV,\t \"pll4\", \"osc\", base + 0x70, 0x7f);\n\thws[IMX6UL_CLK_PLL5] = imx_clk_hw_pllv3(IMX_PLLV3_AV,\t \"pll5\", \"osc\", base + 0xa0, 0x7f);\n\thws[IMX6UL_CLK_PLL6] = imx_clk_hw_pllv3(IMX_PLLV3_ENET,\t \"pll6\", \"osc\", base + 0xe0, 0x3);\n\thws[IMX6UL_CLK_PLL7] = imx_clk_hw_pllv3(IMX_PLLV3_USB,\t \"pll7\", \"osc\", base + 0x20, 0x3);\n\n\thws[IMX6UL_PLL1_BYPASS] = imx_clk_hw_mux_flags(\"pll1_bypass\", base + 0x00, 16, 1, pll1_bypass_sels, ARRAY_SIZE(pll1_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL2_BYPASS] = imx_clk_hw_mux_flags(\"pll2_bypass\", base + 0x30, 16, 1, pll2_bypass_sels, ARRAY_SIZE(pll2_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL3_BYPASS] = imx_clk_hw_mux_flags(\"pll3_bypass\", base + 0x10, 16, 1, pll3_bypass_sels, ARRAY_SIZE(pll3_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL4_BYPASS] = imx_clk_hw_mux_flags(\"pll4_bypass\", base + 0x70, 16, 1, pll4_bypass_sels, ARRAY_SIZE(pll4_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL5_BYPASS] = imx_clk_hw_mux_flags(\"pll5_bypass\", base + 0xa0, 16, 1, pll5_bypass_sels, ARRAY_SIZE(pll5_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL6_BYPASS] = imx_clk_hw_mux_flags(\"pll6_bypass\", base + 0xe0, 16, 1, pll6_bypass_sels, ARRAY_SIZE(pll6_bypass_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_PLL7_BYPASS] = imx_clk_hw_mux_flags(\"pll7_bypass\", base + 0x20, 16, 1, pll7_bypass_sels, ARRAY_SIZE(pll7_bypass_sels), CLK_SET_RATE_PARENT);\n\n\t \n\tclk_set_parent(hws[IMX6UL_PLL1_BYPASS]->clk, hws[IMX6UL_CLK_PLL1]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL2_BYPASS]->clk, hws[IMX6UL_CLK_PLL2]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL3_BYPASS]->clk, hws[IMX6UL_CLK_PLL3]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL4_BYPASS]->clk, hws[IMX6UL_CLK_PLL4]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL5_BYPASS]->clk, hws[IMX6UL_CLK_PLL5]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL6_BYPASS]->clk, hws[IMX6UL_CLK_PLL6]->clk);\n\tclk_set_parent(hws[IMX6UL_PLL7_BYPASS]->clk, hws[IMX6UL_CLK_PLL7]->clk);\n\n\thws[IMX6UL_CLK_PLL1_SYS]\t= imx_clk_hw_fixed_factor(\"pll1_sys\",\t\"pll1_bypass\", 1, 1);\n\thws[IMX6UL_CLK_PLL2_BUS]\t= imx_clk_hw_gate(\"pll2_bus\",\t\"pll2_bypass\", base + 0x30, 13);\n\thws[IMX6UL_CLK_PLL3_USB_OTG]\t= imx_clk_hw_gate(\"pll3_usb_otg\",\t\"pll3_bypass\", base + 0x10, 13);\n\thws[IMX6UL_CLK_PLL4_AUDIO]\t= imx_clk_hw_gate(\"pll4_audio\",\t\"pll4_bypass\", base + 0x70, 13);\n\thws[IMX6UL_CLK_PLL5_VIDEO]\t= imx_clk_hw_gate(\"pll5_video\",\t\"pll5_bypass\", base + 0xa0, 13);\n\thws[IMX6UL_CLK_PLL6_ENET]\t= imx_clk_hw_fixed_factor(\"pll6_enet\",\t\"pll6_bypass\", 1, 1);\n\thws[IMX6UL_CLK_PLL7_USB_HOST]\t= imx_clk_hw_gate(\"pll7_usb_host\",\t\"pll7_bypass\", base + 0x20, 13);\n\n\t \n\thws[IMX6UL_CLK_USBPHY1] = imx_clk_hw_gate(\"usbphy1\", \"pll3_usb_otg\",  base + 0x10, 20);\n\thws[IMX6UL_CLK_USBPHY2] = imx_clk_hw_gate(\"usbphy2\", \"pll7_usb_host\", base + 0x20, 20);\n\n\t \n\thws[IMX6UL_CLK_USBPHY1_GATE] = imx_clk_hw_gate(\"usbphy1_gate\", \"dummy\", base + 0x10, 6);\n\thws[IMX6UL_CLK_USBPHY2_GATE] = imx_clk_hw_gate(\"usbphy2_gate\", \"dummy\", base + 0x20, 6);\n\n\t \n\thws[IMX6UL_CLK_PLL2_PFD0] = imx_clk_hw_pfd(\"pll2_pfd0_352m\", \"pll2_bus\",\t   base + 0x100, 0);\n\thws[IMX6UL_CLK_PLL2_PFD1] = imx_clk_hw_pfd(\"pll2_pfd1_594m\", \"pll2_bus\",\t   base + 0x100, 1);\n\thws[IMX6UL_CLK_PLL2_PFD2] = imx_clk_hw_pfd(\"pll2_pfd2_396m\", \"pll2_bus\",\t   base + 0x100, 2);\n\thws[IMX6UL_CLK_PLL2_PFD3] = imx_clk_hw_pfd(\"pll2_pfd3_594m\", \"pll2_bus\",\t   base + 0x100, 3);\n\thws[IMX6UL_CLK_PLL3_PFD0] = imx_clk_hw_pfd(\"pll3_pfd0_720m\", \"pll3_usb_otg\", base + 0xf0,  0);\n\thws[IMX6UL_CLK_PLL3_PFD1] = imx_clk_hw_pfd(\"pll3_pfd1_540m\", \"pll3_usb_otg\", base + 0xf0,  1);\n\thws[IMX6UL_CLK_PLL3_PFD2] = imx_clk_hw_pfd(\"pll3_pfd2_508m\", \"pll3_usb_otg\", base + 0xf0,\t 2);\n\thws[IMX6UL_CLK_PLL3_PFD3] = imx_clk_hw_pfd(\"pll3_pfd3_454m\", \"pll3_usb_otg\", base + 0xf0,\t 3);\n\n\thws[IMX6UL_CLK_ENET_REF] = clk_hw_register_divider_table(NULL, \"enet1_ref\", \"pll6_enet\", 0,\n\t\t\tbase + 0xe0, 0, 2, 0, clk_enet_ref_table, &imx_ccm_lock);\n\thws[IMX6UL_CLK_ENET2_REF] = clk_hw_register_divider_table(NULL, \"enet2_ref\", \"pll6_enet\", 0,\n\t\t\tbase + 0xe0, 2, 2, 0, clk_enet_ref_table, &imx_ccm_lock);\n\n\thws[IMX6UL_CLK_ENET1_REF_125M] = imx_clk_hw_gate(\"enet1_ref_125m\", \"enet1_ref\", base + 0xe0, 13);\n\thws[IMX6UL_CLK_ENET2_REF_125M] = imx_clk_hw_gate(\"enet2_ref_125m\", \"enet2_ref\", base + 0xe0, 20);\n\thws[IMX6UL_CLK_ENET_PTP_REF]\t= imx_clk_hw_fixed_factor(\"enet_ptp_ref\", \"pll6_enet\", 1, 20);\n\thws[IMX6UL_CLK_ENET_PTP]\t= imx_clk_hw_gate(\"enet_ptp\", \"enet_ptp_ref\", base + 0xe0, 21);\n\n\thws[IMX6UL_CLK_PLL4_POST_DIV]  = clk_hw_register_divider_table(NULL, \"pll4_post_div\", \"pll4_audio\",\n\t\t CLK_SET_RATE_PARENT | CLK_SET_RATE_GATE, base + 0x70, 19, 2, 0, post_div_table, &imx_ccm_lock);\n\thws[IMX6UL_CLK_PLL4_AUDIO_DIV] = clk_hw_register_divider(NULL, \"pll4_audio_div\", \"pll4_post_div\",\n\t\t CLK_SET_RATE_PARENT | CLK_SET_RATE_GATE, base + 0x170, 15, 1, 0, &imx_ccm_lock);\n\thws[IMX6UL_CLK_PLL5_POST_DIV]  = clk_hw_register_divider_table(NULL, \"pll5_post_div\", \"pll5_video\",\n\t\t CLK_SET_RATE_PARENT | CLK_SET_RATE_GATE, base + 0xa0, 19, 2, 0, post_div_table, &imx_ccm_lock);\n\thws[IMX6UL_CLK_PLL5_VIDEO_DIV] = clk_hw_register_divider_table(NULL, \"pll5_video_div\", \"pll5_post_div\",\n\t\t CLK_SET_RATE_PARENT | CLK_SET_RATE_GATE, base + 0x170, 30, 2, 0, video_div_table, &imx_ccm_lock);\n\n\t \n\thws[IMX6UL_CLK_PLL2_198M] = imx_clk_hw_fixed_factor(\"pll2_198m\", \"pll2_pfd2_396m\", 1,\t2);\n\thws[IMX6UL_CLK_PLL3_80M]  = imx_clk_hw_fixed_factor(\"pll3_80m\",  \"pll3_usb_otg\",   1,\t6);\n\thws[IMX6UL_CLK_PLL3_60M]  = imx_clk_hw_fixed_factor(\"pll3_60m\",  \"pll3_usb_otg\",   1,\t8);\n\thws[IMX6UL_CLK_GPT_3M]\t   = imx_clk_hw_fixed_factor(\"gpt_3m\",\t\"osc\",\t\t 1,\t8);\n\n\tnp = ccm_node;\n\tbase = of_iomap(np, 0);\n\tWARN_ON(!base);\n\n\thws[IMX6UL_CA7_SECONDARY_SEL]\t  = imx_clk_hw_mux(\"ca7_secondary_sel\", base + 0xc, 3, 1, ca7_secondary_sels, ARRAY_SIZE(ca7_secondary_sels));\n\thws[IMX6UL_CLK_STEP]\t\t  = imx_clk_hw_mux(\"step\", base + 0x0c, 8, 1, step_sels, ARRAY_SIZE(step_sels));\n\thws[IMX6UL_CLK_PLL1_SW]\t  = imx_clk_hw_mux_flags(\"pll1_sw\",   base + 0x0c, 2,  1, pll1_sw_sels, ARRAY_SIZE(pll1_sw_sels), 0);\n\thws[IMX6UL_CLK_AXI_ALT_SEL]\t  = imx_clk_hw_mux(\"axi_alt_sel\",\t\tbase + 0x14, 7,  1, axi_alt_sels, ARRAY_SIZE(axi_alt_sels));\n\thws[IMX6UL_CLK_AXI_SEL]\t  = imx_clk_hw_mux_flags(\"axi_sel\",\tbase + 0x14, 6,  1, axi_sels, ARRAY_SIZE(axi_sels), 0);\n\thws[IMX6UL_CLK_PERIPH_PRE]\t  = imx_clk_hw_mux(\"periph_pre\",       base + 0x18, 18, 2, periph_pre_sels, ARRAY_SIZE(periph_pre_sels));\n\thws[IMX6UL_CLK_PERIPH2_PRE]\t  = imx_clk_hw_mux(\"periph2_pre\",      base + 0x18, 21, 2, periph2_pre_sels, ARRAY_SIZE(periph2_pre_sels));\n\thws[IMX6UL_CLK_PERIPH_CLK2_SEL]  = imx_clk_hw_mux(\"periph_clk2_sel\",  base + 0x18, 12, 2, periph_clk2_sels, ARRAY_SIZE(periph_clk2_sels));\n\thws[IMX6UL_CLK_PERIPH2_CLK2_SEL] = imx_clk_hw_mux(\"periph2_clk2_sel\", base + 0x18, 20, 1, periph2_clk2_sels, ARRAY_SIZE(periph2_clk2_sels));\n\thws[IMX6UL_CLK_EIM_SLOW_SEL]\t  = imx_clk_hw_mux(\"eim_slow_sel\", base + 0x1c, 29, 2, eim_slow_sels, ARRAY_SIZE(eim_slow_sels));\n\thws[IMX6UL_CLK_GPMI_SEL]\t  = imx_clk_hw_mux(\"gpmi_sel\",     base + 0x1c, 19, 1, gpmi_sels, ARRAY_SIZE(gpmi_sels));\n\thws[IMX6UL_CLK_BCH_SEL]\t  = imx_clk_hw_mux(\"bch_sel\",\tbase + 0x1c, 18, 1, bch_sels, ARRAY_SIZE(bch_sels));\n\thws[IMX6UL_CLK_USDHC2_SEL]\t  = imx_clk_hw_mux(\"usdhc2_sel\",   base + 0x1c, 17, 1, usdhc_sels, ARRAY_SIZE(usdhc_sels));\n\thws[IMX6UL_CLK_USDHC1_SEL]\t  = imx_clk_hw_mux(\"usdhc1_sel\",   base + 0x1c, 16, 1, usdhc_sels, ARRAY_SIZE(usdhc_sels));\n\thws[IMX6UL_CLK_SAI3_SEL]\t  = imx_clk_hw_mux(\"sai3_sel\",     base + 0x1c, 14, 2, sai_sels, ARRAY_SIZE(sai_sels));\n\thws[IMX6UL_CLK_SAI2_SEL]         = imx_clk_hw_mux(\"sai2_sel\",     base + 0x1c, 12, 2, sai_sels, ARRAY_SIZE(sai_sels));\n\thws[IMX6UL_CLK_SAI1_SEL]\t  = imx_clk_hw_mux(\"sai1_sel\",     base + 0x1c, 10, 2, sai_sels, ARRAY_SIZE(sai_sels));\n\thws[IMX6UL_CLK_QSPI1_SEL]\t  = imx_clk_hw_mux(\"qspi1_sel\",    base + 0x1c, 7,  3, qspi1_sels, ARRAY_SIZE(qspi1_sels));\n\thws[IMX6UL_CLK_PERCLK_SEL]\t  = imx_clk_hw_mux(\"perclk_sel\",\tbase + 0x1c, 6,  1, perclk_sels, ARRAY_SIZE(perclk_sels));\n\thws[IMX6UL_CLK_CAN_SEL]\t  = imx_clk_hw_mux(\"can_sel\",\tbase + 0x20, 8,  2, can_sels, ARRAY_SIZE(can_sels));\n\tif (clk_on_imx6ull())\n\t\thws[IMX6ULL_CLK_ESAI_SEL]\t  = imx_clk_hw_mux(\"esai_sel\",\tbase + 0x20, 19, 2, esai_sels, ARRAY_SIZE(esai_sels));\n\thws[IMX6UL_CLK_UART_SEL]\t  = imx_clk_hw_mux(\"uart_sel\",\tbase + 0x24, 6,  1, uart_sels, ARRAY_SIZE(uart_sels));\n\thws[IMX6UL_CLK_ENFC_SEL]\t  = imx_clk_hw_mux(\"enfc_sel\",\tbase + 0x2c, 15, 3, enfc_sels, ARRAY_SIZE(enfc_sels));\n\thws[IMX6UL_CLK_LDB_DI0_SEL]\t  = imx_clk_hw_mux(\"ldb_di0_sel\",\tbase + 0x2c, 9,  3, ldb_di0_sels, ARRAY_SIZE(ldb_di0_sels));\n\thws[IMX6UL_CLK_SPDIF_SEL]\t  = imx_clk_hw_mux(\"spdif_sel\",\tbase + 0x30, 20, 2, spdif_sels, ARRAY_SIZE(spdif_sels));\n\tif (clk_on_imx6ul()) {\n\t\thws[IMX6UL_CLK_SIM_PRE_SEL]\t= imx_clk_hw_mux(\"sim_pre_sel\",\tbase + 0x34, 15, 3, sim_pre_sels, ARRAY_SIZE(sim_pre_sels));\n\t\thws[IMX6UL_CLK_SIM_SEL]\t\t= imx_clk_hw_mux(\"sim_sel\",\tbase + 0x34, 9, 3, sim_sels, ARRAY_SIZE(sim_sels));\n\t} else if (clk_on_imx6ull()) {\n\t\thws[IMX6ULL_CLK_EPDC_PRE_SEL]\t= imx_clk_hw_mux(\"epdc_pre_sel\",\tbase + 0x34, 15, 3, epdc_pre_sels, ARRAY_SIZE(epdc_pre_sels));\n\t\thws[IMX6ULL_CLK_EPDC_SEL]\t= imx_clk_hw_mux(\"epdc_sel\",\tbase + 0x34, 9, 3, epdc_sels, ARRAY_SIZE(epdc_sels));\n\t}\n\thws[IMX6UL_CLK_ECSPI_SEL]\t  = imx_clk_hw_mux(\"ecspi_sel\",\tbase + 0x38, 18, 1, ecspi_sels, ARRAY_SIZE(ecspi_sels));\n\thws[IMX6UL_CLK_LCDIF_PRE_SEL]\t  = imx_clk_hw_mux_flags(\"lcdif_pre_sel\", base + 0x38, 15, 3, lcdif_pre_sels, ARRAY_SIZE(lcdif_pre_sels), CLK_SET_RATE_PARENT);\n\thws[IMX6UL_CLK_LCDIF_SEL]\t  = imx_clk_hw_mux(\"lcdif_sel\",\tbase + 0x38, 9, 3, lcdif_sels, ARRAY_SIZE(lcdif_sels));\n\thws[IMX6UL_CLK_CSI_SEL]\t\t  = imx_clk_hw_mux(\"csi_sel\", base + 0x3c, 9, 2, csi_sels, ARRAY_SIZE(csi_sels));\n\n\thws[IMX6UL_CLK_LDB_DI0_DIV_SEL]  = imx_clk_hw_mux(\"ldb_di0\", base + 0x20, 10, 1, ldb_di0_div_sels, ARRAY_SIZE(ldb_di0_div_sels));\n\thws[IMX6UL_CLK_LDB_DI1_DIV_SEL]  = imx_clk_hw_mux(\"ldb_di1\", base + 0x20, 11, 1, ldb_di1_div_sels, ARRAY_SIZE(ldb_di1_div_sels));\n\n\thws[IMX6UL_CLK_CKO1_SEL]\t  = imx_clk_hw_mux(\"cko1_sel\", base + 0x60, 0,  4, cko1_sels, ARRAY_SIZE(cko1_sels));\n\thws[IMX6UL_CLK_CKO2_SEL]\t  = imx_clk_hw_mux(\"cko2_sel\", base + 0x60, 16, 5, cko2_sels, ARRAY_SIZE(cko2_sels));\n\thws[IMX6UL_CLK_CKO]\t\t  = imx_clk_hw_mux(\"cko\", base + 0x60, 8, 1, cko_sels, ARRAY_SIZE(cko_sels));\n\n\thws[IMX6UL_CLK_LDB_DI0_DIV_3_5] = imx_clk_hw_fixed_factor(\"ldb_di0_div_3_5\", \"ldb_di0_sel\", 2, 7);\n\thws[IMX6UL_CLK_LDB_DI0_DIV_7]\t = imx_clk_hw_fixed_factor(\"ldb_di0_div_7\",   \"ldb_di0_sel\", 1, 7);\n\thws[IMX6UL_CLK_LDB_DI1_DIV_3_5] = imx_clk_hw_fixed_factor(\"ldb_di1_div_3_5\", \"qspi1_sel\", 2, 7);\n\thws[IMX6UL_CLK_LDB_DI1_DIV_7]\t = imx_clk_hw_fixed_factor(\"ldb_di1_div_7\",   \"qspi1_sel\", 1, 7);\n\n\thws[IMX6UL_CLK_PERIPH]  = imx_clk_hw_busy_mux(\"periph\",  base + 0x14, 25, 1, base + 0x48, 5, periph_sels, ARRAY_SIZE(periph_sels));\n\thws[IMX6UL_CLK_PERIPH2] = imx_clk_hw_busy_mux(\"periph2\", base + 0x14, 26, 1, base + 0x48, 3, periph2_sels, ARRAY_SIZE(periph2_sels));\n\n\thws[IMX6UL_CLK_PERIPH_CLK2]\t= imx_clk_hw_divider(\"periph_clk2\",   \"periph_clk2_sel\",\tbase + 0x14, 27, 3);\n\thws[IMX6UL_CLK_PERIPH2_CLK2]\t= imx_clk_hw_divider(\"periph2_clk2\",  \"periph2_clk2_sel\",\tbase + 0x14, 0,  3);\n\thws[IMX6UL_CLK_IPG]\t\t= imx_clk_hw_divider(\"ipg\",\t   \"ahb\",\t\tbase + 0x14, 8,\t 2);\n\thws[IMX6UL_CLK_LCDIF_PODF]\t= imx_clk_hw_divider(\"lcdif_podf\",\t   \"lcdif_pred\",\tbase + 0x18, 23, 3);\n\thws[IMX6UL_CLK_QSPI1_PDOF]\t= imx_clk_hw_divider(\"qspi1_podf\",\t   \"qspi1_sel\",\t\tbase + 0x1c, 26, 3);\n\thws[IMX6UL_CLK_EIM_SLOW_PODF]\t= imx_clk_hw_divider(\"eim_slow_podf\", \"eim_slow_sel\",\tbase + 0x1c, 23, 3);\n\thws[IMX6UL_CLK_PERCLK]\t\t= imx_clk_hw_divider(\"perclk\",\t   \"perclk_sel\",\tbase + 0x1c, 0,  6);\n\thws[IMX6UL_CLK_CAN_PODF]\t= imx_clk_hw_divider(\"can_podf\",\t   \"can_sel\",\t\tbase + 0x20, 2,  6);\n\thws[IMX6UL_CLK_GPMI_PODF]\t= imx_clk_hw_divider(\"gpmi_podf\",\t   \"gpmi_sel\",\t\tbase + 0x24, 22, 3);\n\thws[IMX6UL_CLK_BCH_PODF]\t= imx_clk_hw_divider(\"bch_podf\",\t   \"bch_sel\",\t\tbase + 0x24, 19, 3);\n\thws[IMX6UL_CLK_USDHC2_PODF]\t= imx_clk_hw_divider(\"usdhc2_podf\",   \"usdhc2_sel\",\tbase + 0x24, 16, 3);\n\thws[IMX6UL_CLK_USDHC1_PODF]\t= imx_clk_hw_divider(\"usdhc1_podf\",   \"usdhc1_sel\",\tbase + 0x24, 11, 3);\n\thws[IMX6UL_CLK_UART_PODF]\t= imx_clk_hw_divider(\"uart_podf\",\t   \"uart_sel\",\t\tbase + 0x24, 0,  6);\n\thws[IMX6UL_CLK_SAI3_PRED]\t= imx_clk_hw_divider(\"sai3_pred\",\t   \"sai3_sel\",\t\tbase + 0x28, 22, 3);\n\thws[IMX6UL_CLK_SAI3_PODF]\t= imx_clk_hw_divider(\"sai3_podf\",\t   \"sai3_pred\",\t\tbase + 0x28, 16, 6);\n\thws[IMX6UL_CLK_SAI1_PRED]\t= imx_clk_hw_divider(\"sai1_pred\",\t   \"sai1_sel\",\t\tbase + 0x28, 6,\t 3);\n\thws[IMX6UL_CLK_SAI1_PODF]\t= imx_clk_hw_divider(\"sai1_podf\",\t   \"sai1_pred\",\t\tbase + 0x28, 0,\t 6);\n\tif (clk_on_imx6ull()) {\n\t\thws[IMX6ULL_CLK_ESAI_PRED]\t= imx_clk_hw_divider(\"esai_pred\",     \"esai_sel\",\t\tbase + 0x28, 9,  3);\n\t\thws[IMX6ULL_CLK_ESAI_PODF]\t= imx_clk_hw_divider(\"esai_podf\",     \"esai_pred\",\t\tbase + 0x28, 25, 3);\n\t}\n\thws[IMX6UL_CLK_ENFC_PRED]\t= imx_clk_hw_divider(\"enfc_pred\",\t   \"enfc_sel\",\t\tbase + 0x2c, 18, 3);\n\thws[IMX6UL_CLK_ENFC_PODF]\t= imx_clk_hw_divider(\"enfc_podf\",\t   \"enfc_pred\",\t\tbase + 0x2c, 21, 6);\n\thws[IMX6UL_CLK_SAI2_PRED]\t= imx_clk_hw_divider(\"sai2_pred\",\t   \"sai2_sel\",\t\tbase + 0x2c, 6,\t 3);\n\thws[IMX6UL_CLK_SAI2_PODF]\t= imx_clk_hw_divider(\"sai2_podf\",\t   \"sai2_pred\",\t\tbase + 0x2c, 0,  6);\n\thws[IMX6UL_CLK_SPDIF_PRED]\t= imx_clk_hw_divider(\"spdif_pred\",\t   \"spdif_sel\",\t\tbase + 0x30, 25, 3);\n\thws[IMX6UL_CLK_SPDIF_PODF]\t= imx_clk_hw_divider(\"spdif_podf\",\t   \"spdif_pred\",\tbase + 0x30, 22, 3);\n\tif (clk_on_imx6ul())\n\t\thws[IMX6UL_CLK_SIM_PODF]\t= imx_clk_hw_divider(\"sim_podf\",\t   \"sim_pre_sel\",\tbase + 0x34, 12, 3);\n\telse if (clk_on_imx6ull())\n\t\thws[IMX6ULL_CLK_EPDC_PODF]\t= imx_clk_hw_divider(\"epdc_podf\",\t   \"epdc_pre_sel\",\tbase + 0x34, 12, 3);\n\thws[IMX6UL_CLK_ECSPI_PODF]\t= imx_clk_hw_divider(\"ecspi_podf\",\t   \"ecspi_sel\",\t\tbase + 0x38, 19, 6);\n\thws[IMX6UL_CLK_LCDIF_PRED]\t= imx_clk_hw_divider(\"lcdif_pred\",\t   \"lcdif_pre_sel\",\tbase + 0x38, 12, 3);\n\thws[IMX6UL_CLK_CSI_PODF]       = imx_clk_hw_divider(\"csi_podf\",      \"csi_sel\",           base + 0x3c, 11, 3);\n\n\thws[IMX6UL_CLK_CKO1_PODF]\t= imx_clk_hw_divider(\"cko1_podf\",     \"cko1_sel\",          base + 0x60, 4,  3);\n\thws[IMX6UL_CLK_CKO2_PODF]\t= imx_clk_hw_divider(\"cko2_podf\",     \"cko2_sel\",          base + 0x60, 21, 3);\n\n\thws[IMX6UL_CLK_ARM]\t\t= imx_clk_hw_busy_divider(\"arm\",\t    \"pll1_sw\",\tbase +\t0x10, 0,  3,  base + 0x48, 16);\n\thws[IMX6UL_CLK_MMDC_PODF]\t= imx_clk_hw_busy_divider(\"mmdc_podf\", \"periph2\",\tbase +  0x14, 3,  3,  base + 0x48, 2);\n\thws[IMX6UL_CLK_AXI_PODF]\t= imx_clk_hw_busy_divider(\"axi_podf\",  \"axi_sel\",\tbase +  0x14, 16, 3,  base + 0x48, 0);\n\thws[IMX6UL_CLK_AHB]\t\t= imx_clk_hw_busy_divider(\"ahb\",\t    \"periph\",\tbase +  0x14, 10, 3,  base + 0x48, 1);\n\n\t \n\thws[IMX6UL_CLK_AIPSTZ1]\t= imx_clk_hw_gate2_flags(\"aips_tz1\", \"ahb\", base + 0x68, 0, CLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_AIPSTZ2]\t= imx_clk_hw_gate2_flags(\"aips_tz2\", \"ahb\", base + 0x68, 2, CLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_APBHDMA]\t= imx_clk_hw_gate2(\"apbh_dma\",\t\"bch_podf\",\tbase + 0x68,\t4);\n\thws[IMX6UL_CLK_ASRC_IPG]\t= imx_clk_hw_gate2_shared(\"asrc_ipg\",\t\"ahb\",\tbase + 0x68,\t6, &share_count_asrc);\n\thws[IMX6UL_CLK_ASRC_MEM]\t= imx_clk_hw_gate2_shared(\"asrc_mem\",\t\"ahb\",\tbase + 0x68,\t6, &share_count_asrc);\n\tif (clk_on_imx6ul()) {\n\t\thws[IMX6UL_CLK_CAAM_MEM]\t= imx_clk_hw_gate2(\"caam_mem\",\t\"ahb\",\t\tbase + 0x68,\t8);\n\t\thws[IMX6UL_CLK_CAAM_ACLK]\t= imx_clk_hw_gate2(\"caam_aclk\",\t\"ahb\",\t\tbase + 0x68,\t10);\n\t\thws[IMX6UL_CLK_CAAM_IPG]\t= imx_clk_hw_gate2(\"caam_ipg\",\t\"ipg\",\t\tbase + 0x68,\t12);\n\t} else if (clk_on_imx6ull()) {\n\t\thws[IMX6ULL_CLK_DCP_CLK]\t= imx_clk_hw_gate2(\"dcp\",\t\t\"ahb\",\t\tbase + 0x68,\t10);\n\t\thws[IMX6UL_CLK_ENET]\t\t= imx_clk_hw_gate2(\"enet\",\t\t\"ipg\",\t\tbase + 0x68,\t12);\n\t\thws[IMX6UL_CLK_ENET_AHB]\t= imx_clk_hw_gate2(\"enet_ahb\",\t\"ahb\",\t\tbase + 0x68,\t12);\n\t}\n\thws[IMX6UL_CLK_CAN1_IPG]\t= imx_clk_hw_gate2(\"can1_ipg\",\t\"ipg\",\t\tbase + 0x68,\t14);\n\thws[IMX6UL_CLK_CAN1_SERIAL]\t= imx_clk_hw_gate2(\"can1_serial\",\t\"can_podf\",\tbase + 0x68,\t16);\n\thws[IMX6UL_CLK_CAN2_IPG]\t= imx_clk_hw_gate2(\"can2_ipg\",\t\"ipg\",\t\tbase + 0x68,\t18);\n\thws[IMX6UL_CLK_CAN2_SERIAL]\t= imx_clk_hw_gate2(\"can2_serial\",\t\"can_podf\",\tbase + 0x68,\t20);\n\thws[IMX6UL_CLK_GPT2_BUS]\t= imx_clk_hw_gate2(\"gpt2_bus\",\t\"perclk\",\tbase + 0x68,\t24);\n\thws[IMX6UL_CLK_GPT2_SERIAL]\t= imx_clk_hw_gate2(\"gpt2_serial\",\t\"perclk\",\tbase + 0x68,\t26);\n\thws[IMX6UL_CLK_UART2_IPG]\t= imx_clk_hw_gate2(\"uart2_ipg\",\t\"ipg\",\t\tbase + 0x68,\t28);\n\thws[IMX6UL_CLK_UART2_SERIAL]\t= imx_clk_hw_gate2(\"uart2_serial\",\t\"uart_podf\",\tbase + 0x68,\t28);\n\tif (clk_on_imx6ull())\n\t\thws[IMX6UL_CLK_AIPSTZ3]\t= imx_clk_hw_gate2(\"aips_tz3\",\t\"ahb\",\t\t base + 0x80,\t18);\n\thws[IMX6UL_CLK_GPIO2]\t\t= imx_clk_hw_gate2(\"gpio2\",\t\"ipg\",\t\tbase + 0x68,\t30);\n\n\t \n\thws[IMX6UL_CLK_ECSPI1]\t\t= imx_clk_hw_gate2(\"ecspi1\",\t\"ecspi_podf\",\tbase + 0x6c,\t0);\n\thws[IMX6UL_CLK_ECSPI2]\t\t= imx_clk_hw_gate2(\"ecspi2\",\t\"ecspi_podf\",\tbase + 0x6c,\t2);\n\thws[IMX6UL_CLK_ECSPI3]\t\t= imx_clk_hw_gate2(\"ecspi3\",\t\"ecspi_podf\",\tbase + 0x6c,\t4);\n\thws[IMX6UL_CLK_ECSPI4]\t\t= imx_clk_hw_gate2(\"ecspi4\",\t\"ecspi_podf\",\tbase + 0x6c,\t6);\n\thws[IMX6UL_CLK_ADC2]\t\t= imx_clk_hw_gate2(\"adc2\",\t\t\"ipg\",\t\tbase + 0x6c,\t8);\n\thws[IMX6UL_CLK_UART3_IPG]\t= imx_clk_hw_gate2(\"uart3_ipg\",\t\"ipg\",\t\tbase + 0x6c,\t10);\n\thws[IMX6UL_CLK_UART3_SERIAL]\t= imx_clk_hw_gate2(\"uart3_serial\",\t\"uart_podf\",\tbase + 0x6c,\t10);\n\thws[IMX6UL_CLK_EPIT1]\t\t= imx_clk_hw_gate2(\"epit1\",\t\"perclk\",\tbase + 0x6c,\t12);\n\thws[IMX6UL_CLK_EPIT2]\t\t= imx_clk_hw_gate2(\"epit2\",\t\"perclk\",\tbase + 0x6c,\t14);\n\thws[IMX6UL_CLK_ADC1]\t\t= imx_clk_hw_gate2(\"adc1\",\t\t\"ipg\",\t\tbase + 0x6c,\t16);\n\thws[IMX6UL_CLK_GPT1_BUS]\t= imx_clk_hw_gate2(\"gpt1_bus\",\t\"perclk\",\tbase + 0x6c,\t20);\n\thws[IMX6UL_CLK_GPT1_SERIAL]\t= imx_clk_hw_gate2(\"gpt1_serial\",\t\"perclk\",\tbase + 0x6c,\t22);\n\thws[IMX6UL_CLK_UART4_IPG]\t= imx_clk_hw_gate2(\"uart4_ipg\",\t\"ipg\",\t\tbase + 0x6c,\t24);\n\thws[IMX6UL_CLK_UART4_SERIAL]\t= imx_clk_hw_gate2(\"uart4_serial\",\t\"uart_podf\",\tbase + 0x6c,\t24);\n\thws[IMX6UL_CLK_GPIO1]\t\t= imx_clk_hw_gate2(\"gpio1\",\t\"ipg\",\t\tbase + 0x6c,\t26);\n\thws[IMX6UL_CLK_GPIO5]\t\t= imx_clk_hw_gate2(\"gpio5\",\t\"ipg\",\t\tbase + 0x6c,\t30);\n\n\t \n\tif (clk_on_imx6ull()) {\n\t\thws[IMX6ULL_CLK_ESAI_EXTAL]\t= imx_clk_hw_gate2_shared(\"esai_extal\",\t\"esai_podf\",\tbase + 0x70,\t0, &share_count_esai);\n\t\thws[IMX6ULL_CLK_ESAI_IPG]\t= imx_clk_hw_gate2_shared(\"esai_ipg\",\t\"ahb\",\t\tbase + 0x70,\t0, &share_count_esai);\n\t\thws[IMX6ULL_CLK_ESAI_MEM]\t= imx_clk_hw_gate2_shared(\"esai_mem\",\t\"ahb\",\t\tbase + 0x70,\t0, &share_count_esai);\n\t}\n\thws[IMX6UL_CLK_I2C1]\t\t= imx_clk_hw_gate2(\"i2c1\",\t\t\"perclk\",\tbase + 0x70,\t6);\n\thws[IMX6UL_CLK_I2C2]\t\t= imx_clk_hw_gate2(\"i2c2\",\t\t\"perclk\",\tbase + 0x70,\t8);\n\thws[IMX6UL_CLK_I2C3]\t\t= imx_clk_hw_gate2(\"i2c3\",\t\t\"perclk\",\tbase + 0x70,\t10);\n\thws[IMX6UL_CLK_OCOTP]\t\t= imx_clk_hw_gate2(\"ocotp\",\t\"ipg\",\t\tbase + 0x70,\t12);\n\thws[IMX6UL_CLK_IOMUXC]\t\t= imx_clk_hw_gate2(\"iomuxc\",\t\"lcdif_podf\",\tbase + 0x70,\t14);\n\thws[IMX6UL_CLK_GPIO3]\t\t= imx_clk_hw_gate2(\"gpio3\",\t\"ipg\",\t\tbase + 0x70,\t26);\n\thws[IMX6UL_CLK_LCDIF_APB]\t= imx_clk_hw_gate2(\"lcdif_apb\",\t\"axi\",\t\tbase + 0x70,\t28);\n\thws[IMX6UL_CLK_PXP]\t\t= imx_clk_hw_gate2(\"pxp\",\t\t\"axi\",\t\tbase + 0x70,\t30);\n\n\t \n\t \n\thws[IMX6UL_CLK_CSI]\t\t= imx_clk_hw_gate2(\"csi\",\t\"csi_podf\",\tbase + 0x74,\t0);\n\thws[IMX6UL_CLK_UART5_IPG]\t= imx_clk_hw_gate2(\"uart5_ipg\",\t\"ipg\",\t\tbase + 0x74,\t2);\n\thws[IMX6UL_CLK_UART5_SERIAL]\t= imx_clk_hw_gate2(\"uart5_serial\",\t\"uart_podf\",\tbase + 0x74,\t2);\n\tif (clk_on_imx6ul()) {\n\t\thws[IMX6UL_CLK_ENET]\t\t= imx_clk_hw_gate2(\"enet\",\t\t\"ipg\",\t\tbase + 0x74,\t4);\n\t\thws[IMX6UL_CLK_ENET_AHB]\t= imx_clk_hw_gate2(\"enet_ahb\",\t\"ahb\",\t\tbase + 0x74,\t4);\n\t} else if (clk_on_imx6ull()) {\n\t\thws[IMX6ULL_CLK_EPDC_ACLK]\t= imx_clk_hw_gate2(\"epdc_aclk\",\t\"axi\",\t\tbase + 0x74,\t4);\n\t\thws[IMX6ULL_CLK_EPDC_PIX]\t= imx_clk_hw_gate2(\"epdc_pix\",\t\"epdc_podf\",\tbase + 0x74,\t4);\n\t}\n\thws[IMX6UL_CLK_UART6_IPG]\t= imx_clk_hw_gate2(\"uart6_ipg\",\t\"ipg\",\t\tbase + 0x74,\t6);\n\thws[IMX6UL_CLK_UART6_SERIAL]\t= imx_clk_hw_gate2(\"uart6_serial\",\t\"uart_podf\",\tbase + 0x74,\t6);\n\thws[IMX6UL_CLK_LCDIF_PIX]\t= imx_clk_hw_gate2(\"lcdif_pix\",\t\"lcdif_podf\",\tbase + 0x74,\t10);\n\thws[IMX6UL_CLK_GPIO4]\t\t= imx_clk_hw_gate2(\"gpio4\",\t\"ipg\",\t\tbase + 0x74,\t12);\n\thws[IMX6UL_CLK_QSPI]\t\t= imx_clk_hw_gate2(\"qspi1\",\t\"qspi1_podf\",\tbase + 0x74,\t14);\n\thws[IMX6UL_CLK_WDOG1]\t\t= imx_clk_hw_gate2(\"wdog1\",\t\"ipg\",\t\tbase + 0x74,\t16);\n\thws[IMX6UL_CLK_MMDC_P0_FAST]\t= imx_clk_hw_gate_flags(\"mmdc_p0_fast\", \"mmdc_podf\", base + 0x74,\t20, CLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_MMDC_P0_IPG]\t= imx_clk_hw_gate2_flags(\"mmdc_p0_ipg\",\t\"ipg\",\t\tbase + 0x74,\t24, CLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_MMDC_P1_IPG]\t= imx_clk_hw_gate2_flags(\"mmdc_p1_ipg\",\t\"ipg\",\t\tbase + 0x74,\t26, CLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_AXI]\t\t= imx_clk_hw_gate_flags(\"axi\",\t\"axi_podf\",\tbase + 0x74,\t28, CLK_IS_CRITICAL);\n\n\t \n\thws[IMX6UL_CLK_PER_BCH]\t= imx_clk_hw_gate2(\"per_bch\",\t\"bch_podf\",\tbase + 0x78,\t12);\n\thws[IMX6UL_CLK_PWM1]\t\t= imx_clk_hw_gate2(\"pwm1\",\t\t\"perclk\",\tbase + 0x78,\t16);\n\thws[IMX6UL_CLK_PWM2]\t\t= imx_clk_hw_gate2(\"pwm2\",\t\t\"perclk\",\tbase + 0x78,\t18);\n\thws[IMX6UL_CLK_PWM3]\t\t= imx_clk_hw_gate2(\"pwm3\",\t\t\"perclk\",\tbase + 0x78,\t20);\n\thws[IMX6UL_CLK_PWM4]\t\t= imx_clk_hw_gate2(\"pwm4\",\t\t\"perclk\",\tbase + 0x78,\t22);\n\thws[IMX6UL_CLK_GPMI_BCH_APB]\t= imx_clk_hw_gate2(\"gpmi_bch_apb\",\t\"bch_podf\",\tbase + 0x78,\t24);\n\thws[IMX6UL_CLK_GPMI_BCH]\t= imx_clk_hw_gate2(\"gpmi_bch\",\t\"gpmi_podf\",\tbase + 0x78,\t26);\n\thws[IMX6UL_CLK_GPMI_IO]\t= imx_clk_hw_gate2(\"gpmi_io\",\t\"enfc_podf\",\tbase + 0x78,\t28);\n\thws[IMX6UL_CLK_GPMI_APB]\t= imx_clk_hw_gate2(\"gpmi_apb\",\t\"bch_podf\",\tbase + 0x78,\t30);\n\n\t \n\thws[IMX6UL_CLK_ROM]\t\t= imx_clk_hw_gate2_flags(\"rom\",\t\"ahb\",\t\tbase + 0x7c,\t0,\tCLK_IS_CRITICAL);\n\thws[IMX6UL_CLK_SDMA]\t\t= imx_clk_hw_gate2(\"sdma\",\t\t\"ahb\",\t\tbase + 0x7c,\t6);\n\thws[IMX6UL_CLK_KPP]\t\t= imx_clk_hw_gate2(\"kpp\",\t\t\"ipg\",\t\tbase + 0x7c,\t8);\n\thws[IMX6UL_CLK_WDOG2]\t\t= imx_clk_hw_gate2(\"wdog2\",\t\"ipg\",\t\tbase + 0x7c,\t10);\n\thws[IMX6UL_CLK_SPBA]\t\t= imx_clk_hw_gate2(\"spba\",\t\t\"ipg\",\t\tbase + 0x7c,\t12);\n\thws[IMX6UL_CLK_SPDIF]\t\t= imx_clk_hw_gate2_shared(\"spdif\",\t\t\"spdif_podf\",\tbase + 0x7c,\t14, &share_count_audio);\n\thws[IMX6UL_CLK_SPDIF_GCLK]\t= imx_clk_hw_gate2_shared(\"spdif_gclk\",\t\"ipg\",\t\tbase + 0x7c,\t14, &share_count_audio);\n\thws[IMX6UL_CLK_SAI3]\t\t= imx_clk_hw_gate2_shared(\"sai3\",\t\t\"sai3_podf\",\tbase + 0x7c,\t22, &share_count_sai3);\n\thws[IMX6UL_CLK_SAI3_IPG]\t= imx_clk_hw_gate2_shared(\"sai3_ipg\",\t\"ipg\",\t\tbase + 0x7c,\t22, &share_count_sai3);\n\thws[IMX6UL_CLK_UART1_IPG]\t= imx_clk_hw_gate2(\"uart1_ipg\",\t\"ipg\",\t\tbase + 0x7c,\t24);\n\thws[IMX6UL_CLK_UART1_SERIAL]\t= imx_clk_hw_gate2(\"uart1_serial\",\t\"uart_podf\",\tbase + 0x7c,\t24);\n\thws[IMX6UL_CLK_UART7_IPG]\t= imx_clk_hw_gate2(\"uart7_ipg\",\t\"ipg\",\t\tbase + 0x7c,\t26);\n\thws[IMX6UL_CLK_UART7_SERIAL]\t= imx_clk_hw_gate2(\"uart7_serial\",\t\"uart_podf\",\tbase + 0x7c,\t26);\n\thws[IMX6UL_CLK_SAI1]\t\t= imx_clk_hw_gate2_shared(\"sai1\",\t\t\"sai1_podf\",\tbase + 0x7c,\t28, &share_count_sai1);\n\thws[IMX6UL_CLK_SAI1_IPG]\t= imx_clk_hw_gate2_shared(\"sai1_ipg\",\t\"ipg\",\t\tbase + 0x7c,\t28, &share_count_sai1);\n\thws[IMX6UL_CLK_SAI2]\t\t= imx_clk_hw_gate2_shared(\"sai2\",\t\t\"sai2_podf\",\tbase + 0x7c,\t30, &share_count_sai2);\n\thws[IMX6UL_CLK_SAI2_IPG]\t= imx_clk_hw_gate2_shared(\"sai2_ipg\",\t\"ipg\",\t\tbase + 0x7c,\t30, &share_count_sai2);\n\n\t \n\thws[IMX6UL_CLK_USBOH3]\t\t= imx_clk_hw_gate2(\"usboh3\",\t\"ipg\",\t\t base + 0x80,\t0);\n\thws[IMX6UL_CLK_USDHC1]\t\t= imx_clk_hw_gate2(\"usdhc1\",\t\"usdhc1_podf\",\t base + 0x80,\t2);\n\thws[IMX6UL_CLK_USDHC2]\t\t= imx_clk_hw_gate2(\"usdhc2\",\t\"usdhc2_podf\",\t base + 0x80,\t4);\n\tif (clk_on_imx6ul()) {\n\t\thws[IMX6UL_CLK_SIM1]\t\t= imx_clk_hw_gate2(\"sim1\",\t\t\"sim_sel\",\t base + 0x80,\t6);\n\t\thws[IMX6UL_CLK_SIM2]\t\t= imx_clk_hw_gate2(\"sim2\",\t\t\"sim_sel\",\t base + 0x80,\t8);\n\t}\n\thws[IMX6UL_CLK_EIM]\t\t= imx_clk_hw_gate2(\"eim\",\t\t\"eim_slow_podf\", base + 0x80,\t10);\n\thws[IMX6UL_CLK_PWM8]\t\t= imx_clk_hw_gate2(\"pwm8\",\t\t\"perclk\",\t base + 0x80,\t16);\n\thws[IMX6UL_CLK_UART8_IPG]\t= imx_clk_hw_gate2(\"uart8_ipg\",\t\"ipg\",\t\t base + 0x80,\t14);\n\thws[IMX6UL_CLK_UART8_SERIAL]\t= imx_clk_hw_gate2(\"uart8_serial\", \"uart_podf\",\t base + 0x80,\t14);\n\thws[IMX6UL_CLK_WDOG3]\t\t= imx_clk_hw_gate2(\"wdog3\",\t\"ipg\",\t\t base + 0x80,\t20);\n\thws[IMX6UL_CLK_I2C4]\t\t= imx_clk_hw_gate2(\"i2c4\",\t\t\"perclk\",\t base + 0x80,\t24);\n\thws[IMX6UL_CLK_PWM5]\t\t= imx_clk_hw_gate2(\"pwm5\",\t\t\"perclk\",\t base + 0x80,\t26);\n\thws[IMX6UL_CLK_PWM6]\t\t= imx_clk_hw_gate2(\"pwm6\",\t\t\"perclk\",\t base +\t0x80,\t28);\n\thws[IMX6UL_CLK_PWM7]\t\t= imx_clk_hw_gate2(\"pwm7\",\t\t\"perclk\",\t base + 0x80,\t30);\n\n\t \n\thws[IMX6UL_CLK_CKO1]\t\t= imx_clk_hw_gate(\"cko1\",\t\t\"cko1_podf\",\t base + 0x60,\t7);\n\thws[IMX6UL_CLK_CKO2]\t\t= imx_clk_hw_gate(\"cko2\",\t\t\"cko2_podf\",\t base + 0x60,\t24);\n\n\t \n\timx_mmdc_mask_handshake(base, 0);\n\n\thws[IMX6UL_CLK_ENET1_REF_PAD] = imx_obtain_fixed_of_clock(ccm_node, \"enet1_ref_pad\", 0);\n\n\thws[IMX6UL_CLK_ENET1_REF_SEL] = imx_clk_gpr_mux(\"enet1_ref_sel\", \"fsl,imx6ul-iomuxc-gpr\",\n\t\t\t\tIOMUXC_GPR1, enet1_ref_sels, ARRAY_SIZE(enet1_ref_sels),\n\t\t\t\tenet1_ref_sels_table, enet1_ref_sels_table_mask);\n\thws[IMX6UL_CLK_ENET2_REF_PAD] = imx_obtain_fixed_of_clock(ccm_node, \"enet2_ref_pad\", 0);\n\n\thws[IMX6UL_CLK_ENET2_REF_SEL] = imx_clk_gpr_mux(\"enet2_ref_sel\", \"fsl,imx6ul-iomuxc-gpr\",\n\t\t\t\tIOMUXC_GPR1, enet2_ref_sels, ARRAY_SIZE(enet2_ref_sels),\n\t\t\t\tenet2_ref_sels_table, enet2_ref_sels_table_mask);\n\n\timx_check_clk_hws(hws, IMX6UL_CLK_END);\n\n\tof_clk_add_hw_provider(np, of_clk_hw_onecell_get, clk_hw_data);\n\n\t \n\tclk_set_rate(hws[IMX6UL_CLK_AHB]->clk, 99000000);\n\n\t \n\tclk_set_parent(hws[IMX6UL_CLK_PERIPH_CLK2_SEL]->clk, hws[IMX6UL_CLK_OSC]->clk);\n\tclk_set_parent(hws[IMX6UL_CLK_PERIPH]->clk, hws[IMX6UL_CLK_PERIPH_CLK2]->clk);\n\tclk_set_parent(hws[IMX6UL_CLK_PERIPH_PRE]->clk, hws[IMX6UL_CLK_PLL2_BUS]->clk);\n\tclk_set_parent(hws[IMX6UL_CLK_PERIPH]->clk, hws[IMX6UL_CLK_PERIPH_PRE]->clk);\n\n\t \n\tclk_set_rate(hws[IMX6UL_CLK_AHB]->clk, 132000000);\n\n\t \n\tclk_set_parent(hws[IMX6UL_CLK_PERCLK_SEL]->clk, hws[IMX6UL_CLK_OSC]->clk);\n\n\tclk_set_rate(hws[IMX6UL_CLK_ENET_REF]->clk, 50000000);\n\tclk_set_rate(hws[IMX6UL_CLK_ENET2_REF]->clk, 50000000);\n\tclk_set_rate(hws[IMX6UL_CLK_CSI]->clk, 24000000);\n\n\tif (clk_on_imx6ull())\n\t\tclk_prepare_enable(hws[IMX6UL_CLK_AIPSTZ3]->clk);\n\n\tif (IS_ENABLED(CONFIG_USB_MXS_PHY)) {\n\t\tclk_prepare_enable(hws[IMX6UL_CLK_USBPHY1_GATE]->clk);\n\t\tclk_prepare_enable(hws[IMX6UL_CLK_USBPHY2_GATE]->clk);\n\t}\n\n\tclk_set_parent(hws[IMX6UL_CLK_CAN_SEL]->clk, hws[IMX6UL_CLK_PLL3_80M]->clk);\n\tif (clk_on_imx6ul())\n\t\tclk_set_parent(hws[IMX6UL_CLK_SIM_PRE_SEL]->clk, hws[IMX6UL_CLK_PLL3_USB_OTG]->clk);\n\telse if (clk_on_imx6ull())\n\t\tclk_set_parent(hws[IMX6ULL_CLK_EPDC_PRE_SEL]->clk, hws[IMX6UL_CLK_PLL3_PFD2]->clk);\n\n\tclk_set_parent(hws[IMX6UL_CLK_ENFC_SEL]->clk, hws[IMX6UL_CLK_PLL2_PFD2]->clk);\n\n\tclk_set_parent(hws[IMX6UL_CLK_ENET1_REF_SEL]->clk, hws[IMX6UL_CLK_ENET_REF]->clk);\n\tclk_set_parent(hws[IMX6UL_CLK_ENET2_REF_SEL]->clk, hws[IMX6UL_CLK_ENET2_REF]->clk);\n\n\timx_register_uart_clocks();\n}\n\nCLK_OF_DECLARE(imx6ul, \"fsl,imx6ul-ccm\", imx6ul_clocks_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}