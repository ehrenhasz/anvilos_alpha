{
  "module_name": "clk-imx5.c",
  "hash_id": "c6801b65b59858fa8dab139ae1f76bb12a181ecdad7f60daf073866915f2b1cc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/imx/clk-imx5.c",
  "human_readable_source": "\n \n#include <linux/mm.h>\n#include <linux/delay.h>\n#include <linux/clk.h>\n#include <linux/io.h>\n#include <linux/clkdev.h>\n#include <linux/clk-provider.h>\n#include <linux/err.h>\n#include <linux/of.h>\n#include <linux/of_address.h>\n#include <linux/of_irq.h>\n#include <linux/sizes.h>\n#include <soc/imx/revision.h>\n#include <dt-bindings/clock/imx5-clock.h>\n\n#include \"clk.h\"\n\n#define MX51_DPLL1_BASE\t\t0x83f80000\n#define MX51_DPLL2_BASE\t\t0x83f84000\n#define MX51_DPLL3_BASE\t\t0x83f88000\n\n#define MX53_DPLL1_BASE\t\t0x63f80000\n#define MX53_DPLL2_BASE\t\t0x63f84000\n#define MX53_DPLL3_BASE\t\t0x63f88000\n#define MX53_DPLL4_BASE\t\t0x63f8c000\n\n#define MXC_CCM_CCR\t\t(ccm_base + 0x00)\n#define MXC_CCM_CCDR\t\t(ccm_base + 0x04)\n#define MXC_CCM_CSR\t\t(ccm_base + 0x08)\n#define MXC_CCM_CCSR\t\t(ccm_base + 0x0c)\n#define MXC_CCM_CACRR\t\t(ccm_base + 0x10)\n#define MXC_CCM_CBCDR\t\t(ccm_base + 0x14)\n#define MXC_CCM_CBCMR\t\t(ccm_base + 0x18)\n#define MXC_CCM_CSCMR1\t\t(ccm_base + 0x1c)\n#define MXC_CCM_CSCMR2\t\t(ccm_base + 0x20)\n#define MXC_CCM_CSCDR1\t\t(ccm_base + 0x24)\n#define MXC_CCM_CS1CDR\t\t(ccm_base + 0x28)\n#define MXC_CCM_CS2CDR\t\t(ccm_base + 0x2c)\n#define MXC_CCM_CDCDR\t\t(ccm_base + 0x30)\n#define MXC_CCM_CHSCDR\t\t(ccm_base + 0x34)\n#define MXC_CCM_CSCDR2\t\t(ccm_base + 0x38)\n#define MXC_CCM_CSCDR3\t\t(ccm_base + 0x3c)\n#define MXC_CCM_CSCDR4\t\t(ccm_base + 0x40)\n#define MXC_CCM_CWDR\t\t(ccm_base + 0x44)\n#define MXC_CCM_CDHIPR\t\t(ccm_base + 0x48)\n#define MXC_CCM_CDCR\t\t(ccm_base + 0x4c)\n#define MXC_CCM_CTOR\t\t(ccm_base + 0x50)\n#define MXC_CCM_CLPCR\t\t(ccm_base + 0x54)\n#define MXC_CCM_CISR\t\t(ccm_base + 0x58)\n#define MXC_CCM_CIMR\t\t(ccm_base + 0x5c)\n#define MXC_CCM_CCOSR\t\t(ccm_base + 0x60)\n#define MXC_CCM_CGPR\t\t(ccm_base + 0x64)\n#define MXC_CCM_CCGR0\t\t(ccm_base + 0x68)\n#define MXC_CCM_CCGR1\t\t(ccm_base + 0x6c)\n#define MXC_CCM_CCGR2\t\t(ccm_base + 0x70)\n#define MXC_CCM_CCGR3\t\t(ccm_base + 0x74)\n#define MXC_CCM_CCGR4\t\t(ccm_base + 0x78)\n#define MXC_CCM_CCGR5\t\t(ccm_base + 0x7c)\n#define MXC_CCM_CCGR6\t\t(ccm_base + 0x80)\n#define MXC_CCM_CCGR7\t\t(ccm_base + 0x84)\n\n \nstatic const char *lp_apm_sel[] = { \"osc\", };\n\n \nstatic const char *standard_pll_sel[] = { \"pll1_sw\", \"pll2_sw\", \"pll3_sw\", \"lp_apm\", };\nstatic const char *periph_apm_sel[] = { \"pll1_sw\", \"pll3_sw\", \"lp_apm\", };\nstatic const char *main_bus_sel[] = { \"pll2_sw\", \"periph_apm\", };\nstatic const char *per_lp_apm_sel[] = { \"main_bus\", \"lp_apm\", };\nstatic const char *per_root_sel[] = { \"per_podf\", \"ipg\", };\nstatic const char *esdhc_c_sel[] = { \"esdhc_a_podf\", \"esdhc_b_podf\", };\nstatic const char *esdhc_d_sel[] = { \"esdhc_a_podf\", \"esdhc_b_podf\", };\nstatic const char *ssi_apm_sels[] = { \"ckih1\", \"lp_amp\", \"ckih2\", };\nstatic const char *ssi_clk_sels[] = { \"pll1_sw\", \"pll2_sw\", \"pll3_sw\", \"ssi_apm\", };\nstatic const char *ssi3_clk_sels[] = { \"ssi1_root_gate\", \"ssi2_root_gate\", };\nstatic const char *ssi_ext1_com_sels[] = { \"ssi_ext1_podf\", \"ssi1_root_gate\", };\nstatic const char *ssi_ext2_com_sels[] = { \"ssi_ext2_podf\", \"ssi2_root_gate\", };\nstatic const char *emi_slow_sel[] = { \"main_bus\", \"ahb\", };\nstatic const char *usb_phy_sel_str[] = { \"osc\", \"usb_phy_podf\", };\nstatic const char *mx51_ipu_di0_sel[] = { \"di_pred\", \"osc\", \"ckih1\", \"tve_di\", };\nstatic const char *mx53_ipu_di0_sel[] = { \"di_pred\", \"osc\", \"ckih1\", \"di_pll4_podf\", \"dummy\", \"ldb_di0_gate\", };\nstatic const char *mx53_ldb_di0_sel[] = { \"pll3_sw\", \"pll4_sw\", };\nstatic const char *mx51_ipu_di1_sel[] = { \"di_pred\", \"osc\", \"ckih1\", \"tve_di\", \"ipp_di1\", };\nstatic const char *mx53_ipu_di1_sel[] = { \"di_pred\", \"osc\", \"ckih1\", \"tve_di\", \"ipp_di1\", \"ldb_di1_gate\", };\nstatic const char *mx53_ldb_di1_sel[] = { \"pll3_sw\", \"pll4_sw\", };\nstatic const char *mx51_tve_ext_sel[] = { \"osc\", \"ckih1\", };\nstatic const char *mx53_tve_ext_sel[] = { \"pll4_sw\", \"ckih1\", };\nstatic const char *mx51_tve_sel[] = { \"tve_pred\", \"tve_ext_sel\", };\nstatic const char *ipu_sel[] = { \"axi_a\", \"axi_b\", \"emi_slow_gate\", \"ahb\", };\nstatic const char *gpu3d_sel[] = { \"axi_a\", \"axi_b\", \"emi_slow_gate\", \"ahb\" };\nstatic const char *gpu2d_sel[] = { \"axi_a\", \"axi_b\", \"emi_slow_gate\", \"ahb\" };\nstatic const char *vpu_sel[] = { \"axi_a\", \"axi_b\", \"emi_slow_gate\", \"ahb\", };\nstatic const char *mx53_can_sel[] = { \"ipg\", \"ckih1\", \"ckih2\", \"lp_apm\", };\nstatic const char *mx53_cko1_sel[] = {\n\t\"cpu_podf\", \"pll1_sw\", \"pll2_sw\", \"pll3_sw\",\n\t\"emi_slow_podf\", \"pll4_sw\", \"nfc_podf\", \"dummy\",\n\t\"di_pred\", \"dummy\", \"dummy\", \"ahb\",\n\t\"ipg\", \"per_root\", \"ckil\", \"dummy\",};\nstatic const char *mx53_cko2_sel[] = {\n\t\"dummy\" , \"dummy\" ,\n\t\"dummy\", \"esdhc_a_podf\",\n\t\"usboh3_podf\", \"dummy\" ,\n\t\"ecspi_podf\", \"dummy\" ,\n\t\"esdhc_b_podf\", \"dummy\" ,\n\t\"dummy\" , \"dummy\" ,\n\t\"vpu_sel\", \"ipu_sel\",\n\t\"osc\", \"ckih1\",\n\t\"dummy\", \"esdhc_c_sel\",\n\t\"ssi1_root_podf\", \"ssi2_root_podf\",\n\t\"dummy\", \"dummy\",\n\t\"dummy\" , \"dummy\" ,\n\t\"dummy\" , \"usb_phy_sel\",\n\t\"tve_sel\", \"lp_apm\",\n\t\"uart_root\", \"dummy\" ,\n\t\"dummy\", \"dummy\", };\nstatic const char *mx51_spdif_xtal_sel[] = { \"osc\", \"ckih\", \"ckih2\", };\nstatic const char *mx53_spdif_xtal_sel[] = { \"osc\", \"ckih\", \"ckih2\", \"pll4_sw\", };\nstatic const char *spdif_sel[] = { \"pll1_sw\", \"pll2_sw\", \"pll3_sw\", \"spdif_xtal_sel\", };\nstatic const char *spdif0_com_sel[] = { \"spdif0_podf\", \"ssi1_root_gate\", };\nstatic const char *mx51_spdif1_com_sel[] = { \"spdif1_podf\", \"ssi2_root_gate\", };\nstatic const char *step_sels[] = { \"lp_apm\", };\nstatic const char *cpu_podf_sels[] = { \"pll1_sw\", \"step_sel\" };\nstatic const char *ieee1588_sels[] = { \"pll3_sw\", \"pll4_sw\", \"dummy\"  , \"dummy\"   };\n\nstatic struct clk *clk[IMX5_CLK_END];\nstatic struct clk_onecell_data clk_data;\n\nstatic void __init mx5_clocks_common_init(void __iomem *ccm_base)\n{\n\tclk[IMX5_CLK_DUMMY]\t\t= imx_clk_fixed(\"dummy\", 0);\n\tclk[IMX5_CLK_CKIL]\t\t= imx_obtain_fixed_clock(\"ckil\", 0);\n\tclk[IMX5_CLK_OSC]\t\t= imx_obtain_fixed_clock(\"osc\", 0);\n\tclk[IMX5_CLK_CKIH1]\t\t= imx_obtain_fixed_clock(\"ckih1\", 0);\n\tclk[IMX5_CLK_CKIH2]\t\t= imx_obtain_fixed_clock(\"ckih2\", 0);\n\n\tclk[IMX5_CLK_PER_LP_APM]\t= imx_clk_mux(\"per_lp_apm\", MXC_CCM_CBCMR, 1, 1,\n\t\t\t\t\t\tper_lp_apm_sel, ARRAY_SIZE(per_lp_apm_sel));\n\tclk[IMX5_CLK_PER_PRED1]\t\t= imx_clk_divider(\"per_pred1\", \"per_lp_apm\", MXC_CCM_CBCDR, 6, 2);\n\tclk[IMX5_CLK_PER_PRED2]\t\t= imx_clk_divider(\"per_pred2\", \"per_pred1\", MXC_CCM_CBCDR, 3, 3);\n\tclk[IMX5_CLK_PER_PODF]\t\t= imx_clk_divider(\"per_podf\", \"per_pred2\", MXC_CCM_CBCDR, 0, 3);\n\tclk[IMX5_CLK_PER_ROOT]\t\t= imx_clk_mux(\"per_root\", MXC_CCM_CBCMR, 0, 1,\n\t\t\t\t\t\tper_root_sel, ARRAY_SIZE(per_root_sel));\n\tclk[IMX5_CLK_AHB]\t\t= imx_clk_divider(\"ahb\", \"main_bus\", MXC_CCM_CBCDR, 10, 3);\n\tclk[IMX5_CLK_AHB_MAX]\t\t= imx_clk_gate2_flags(\"ahb_max\", \"ahb\", MXC_CCM_CCGR0, 28, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_AIPS_TZ1]\t\t= imx_clk_gate2_flags(\"aips_tz1\", \"ahb\", MXC_CCM_CCGR0, 24, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_AIPS_TZ2]\t\t= imx_clk_gate2_flags(\"aips_tz2\", \"ahb\", MXC_CCM_CCGR0, 26, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_TMAX1]\t\t= imx_clk_gate2_flags(\"tmax1\", \"ahb\", MXC_CCM_CCGR1, 0, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_TMAX2]\t\t= imx_clk_gate2_flags(\"tmax2\", \"ahb\", MXC_CCM_CCGR1, 2, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_TMAX3]\t\t= imx_clk_gate2_flags(\"tmax3\", \"ahb\", MXC_CCM_CCGR1, 4, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_SPBA]\t\t= imx_clk_gate2_flags(\"spba\", \"ipg\", MXC_CCM_CCGR5, 0, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_IPG]\t\t= imx_clk_divider(\"ipg\", \"ahb\", MXC_CCM_CBCDR, 8, 2);\n\tclk[IMX5_CLK_AXI_A]\t\t= imx_clk_divider(\"axi_a\", \"main_bus\", MXC_CCM_CBCDR, 16, 3);\n\tclk[IMX5_CLK_AXI_B]\t\t= imx_clk_divider(\"axi_b\", \"main_bus\", MXC_CCM_CBCDR, 19, 3);\n\tclk[IMX5_CLK_UART_SEL]\t\t= imx_clk_mux(\"uart_sel\", MXC_CCM_CSCMR1, 24, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_UART_PRED]\t\t= imx_clk_divider(\"uart_pred\", \"uart_sel\", MXC_CCM_CSCDR1, 3, 3);\n\tclk[IMX5_CLK_UART_ROOT]\t\t= imx_clk_divider(\"uart_root\", \"uart_pred\", MXC_CCM_CSCDR1, 0, 3);\n\n\tclk[IMX5_CLK_ESDHC_A_PRED]\t= imx_clk_divider(\"esdhc_a_pred\", \"esdhc_a_sel\", MXC_CCM_CSCDR1, 16, 3);\n\tclk[IMX5_CLK_ESDHC_A_PODF]\t= imx_clk_divider(\"esdhc_a_podf\", \"esdhc_a_pred\", MXC_CCM_CSCDR1, 11, 3);\n\tclk[IMX5_CLK_ESDHC_B_PRED]\t= imx_clk_divider(\"esdhc_b_pred\", \"esdhc_b_sel\", MXC_CCM_CSCDR1, 22, 3);\n\tclk[IMX5_CLK_ESDHC_B_PODF]\t= imx_clk_divider(\"esdhc_b_podf\", \"esdhc_b_pred\", MXC_CCM_CSCDR1, 19, 3);\n\n\tclk[IMX5_CLK_EMI_SEL]\t\t= imx_clk_mux(\"emi_sel\", MXC_CCM_CBCDR, 26, 1,\n\t\t\t\t\t\temi_slow_sel, ARRAY_SIZE(emi_slow_sel));\n\tclk[IMX5_CLK_EMI_SLOW_PODF]\t= imx_clk_divider(\"emi_slow_podf\", \"emi_sel\", MXC_CCM_CBCDR, 22, 3);\n\tclk[IMX5_CLK_NFC_PODF]\t\t= imx_clk_divider(\"nfc_podf\", \"emi_slow_podf\", MXC_CCM_CBCDR, 13, 3);\n\tclk[IMX5_CLK_ECSPI_SEL]\t\t= imx_clk_mux(\"ecspi_sel\", MXC_CCM_CSCMR1, 4, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ECSPI_PRED]\t= imx_clk_divider(\"ecspi_pred\", \"ecspi_sel\", MXC_CCM_CSCDR2, 25, 3);\n\tclk[IMX5_CLK_ECSPI_PODF]\t= imx_clk_divider(\"ecspi_podf\", \"ecspi_pred\", MXC_CCM_CSCDR2, 19, 6);\n\tclk[IMX5_CLK_USBOH3_SEL]\t= imx_clk_mux(\"usboh3_sel\", MXC_CCM_CSCMR1, 22, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_USBOH3_PRED]\t= imx_clk_divider(\"usboh3_pred\", \"usboh3_sel\", MXC_CCM_CSCDR1, 8, 3);\n\tclk[IMX5_CLK_USBOH3_PODF]\t= imx_clk_divider(\"usboh3_podf\", \"usboh3_pred\", MXC_CCM_CSCDR1, 6, 2);\n\tclk[IMX5_CLK_USB_PHY_PRED]\t= imx_clk_divider(\"usb_phy_pred\", \"pll3_sw\", MXC_CCM_CDCDR, 3, 3);\n\tclk[IMX5_CLK_USB_PHY_PODF]\t= imx_clk_divider(\"usb_phy_podf\", \"usb_phy_pred\", MXC_CCM_CDCDR, 0, 3);\n\tclk[IMX5_CLK_USB_PHY_SEL]\t= imx_clk_mux(\"usb_phy_sel\", MXC_CCM_CSCMR1, 26, 1,\n\t\t\t\t\t\tusb_phy_sel_str, ARRAY_SIZE(usb_phy_sel_str));\n\tclk[IMX5_CLK_STEP_SEL]\t\t= imx_clk_mux(\"step_sel\", MXC_CCM_CCSR, 7, 2, step_sels, ARRAY_SIZE(step_sels));\n\tclk[IMX5_CLK_CPU_PODF_SEL]\t= imx_clk_mux(\"cpu_podf_sel\", MXC_CCM_CCSR, 2, 1, cpu_podf_sels, ARRAY_SIZE(cpu_podf_sels));\n\tclk[IMX5_CLK_CPU_PODF]\t\t= imx_clk_divider(\"cpu_podf\", \"cpu_podf_sel\", MXC_CCM_CACRR, 0, 3);\n\tclk[IMX5_CLK_DI_PRED]\t\t= imx_clk_divider(\"di_pred\", \"pll3_sw\", MXC_CCM_CDCDR, 6, 3);\n\tclk[IMX5_CLK_IIM_GATE]\t\t= imx_clk_gate2(\"iim_gate\", \"ipg\", MXC_CCM_CCGR0, 30);\n\tclk[IMX5_CLK_UART1_IPG_GATE]\t= imx_clk_gate2(\"uart1_ipg_gate\", \"ipg\", MXC_CCM_CCGR1, 6);\n\tclk[IMX5_CLK_UART1_PER_GATE]\t= imx_clk_gate2(\"uart1_per_gate\", \"uart_root\", MXC_CCM_CCGR1, 8);\n\tclk[IMX5_CLK_UART2_IPG_GATE]\t= imx_clk_gate2(\"uart2_ipg_gate\", \"ipg\", MXC_CCM_CCGR1, 10);\n\tclk[IMX5_CLK_UART2_PER_GATE]\t= imx_clk_gate2(\"uart2_per_gate\", \"uart_root\", MXC_CCM_CCGR1, 12);\n\tclk[IMX5_CLK_UART3_IPG_GATE]\t= imx_clk_gate2(\"uart3_ipg_gate\", \"ipg\", MXC_CCM_CCGR1, 14);\n\tclk[IMX5_CLK_UART3_PER_GATE]\t= imx_clk_gate2(\"uart3_per_gate\", \"uart_root\", MXC_CCM_CCGR1, 16);\n\tclk[IMX5_CLK_I2C1_GATE]\t\t= imx_clk_gate2(\"i2c1_gate\", \"per_root\", MXC_CCM_CCGR1, 18);\n\tclk[IMX5_CLK_I2C2_GATE]\t\t= imx_clk_gate2(\"i2c2_gate\", \"per_root\", MXC_CCM_CCGR1, 20);\n\tclk[IMX5_CLK_PWM1_IPG_GATE]\t= imx_clk_gate2(\"pwm1_ipg_gate\", \"ipg\", MXC_CCM_CCGR2, 10);\n\tclk[IMX5_CLK_PWM1_HF_GATE]\t= imx_clk_gate2(\"pwm1_hf_gate\", \"per_root\", MXC_CCM_CCGR2, 12);\n\tclk[IMX5_CLK_PWM2_IPG_GATE]\t= imx_clk_gate2(\"pwm2_ipg_gate\", \"ipg\", MXC_CCM_CCGR2, 14);\n\tclk[IMX5_CLK_PWM2_HF_GATE]\t= imx_clk_gate2(\"pwm2_hf_gate\", \"per_root\", MXC_CCM_CCGR2, 16);\n\tclk[IMX5_CLK_GPT_IPG_GATE]\t= imx_clk_gate2(\"gpt_ipg_gate\", \"ipg\", MXC_CCM_CCGR2, 18);\n\tclk[IMX5_CLK_GPT_HF_GATE]\t= imx_clk_gate2(\"gpt_hf_gate\", \"per_root\", MXC_CCM_CCGR2, 20);\n\tclk[IMX5_CLK_FEC_GATE]\t\t= imx_clk_gate2(\"fec_gate\", \"ipg\", MXC_CCM_CCGR2, 24);\n\tclk[IMX5_CLK_USBOH3_GATE]\t= imx_clk_gate2(\"usboh3_gate\", \"ipg\", MXC_CCM_CCGR2, 26);\n\tclk[IMX5_CLK_USBOH3_PER_GATE]\t= imx_clk_gate2(\"usboh3_per_gate\", \"usboh3_podf\", MXC_CCM_CCGR2, 28);\n\tclk[IMX5_CLK_ESDHC1_IPG_GATE]\t= imx_clk_gate2(\"esdhc1_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 0);\n\tclk[IMX5_CLK_ESDHC2_IPG_GATE]\t= imx_clk_gate2(\"esdhc2_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 4);\n\tclk[IMX5_CLK_ESDHC3_IPG_GATE]\t= imx_clk_gate2(\"esdhc3_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 8);\n\tclk[IMX5_CLK_ESDHC4_IPG_GATE]\t= imx_clk_gate2(\"esdhc4_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 12);\n\tclk[IMX5_CLK_SSI1_IPG_GATE]\t= imx_clk_gate2(\"ssi1_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 16);\n\tclk[IMX5_CLK_SSI2_IPG_GATE]\t= imx_clk_gate2(\"ssi2_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 20);\n\tclk[IMX5_CLK_SSI3_IPG_GATE]\t= imx_clk_gate2(\"ssi3_ipg_gate\", \"ipg\", MXC_CCM_CCGR3, 24);\n\tclk[IMX5_CLK_ECSPI1_IPG_GATE]\t= imx_clk_gate2(\"ecspi1_ipg_gate\", \"ipg\", MXC_CCM_CCGR4, 18);\n\tclk[IMX5_CLK_ECSPI1_PER_GATE]\t= imx_clk_gate2(\"ecspi1_per_gate\", \"ecspi_podf\", MXC_CCM_CCGR4, 20);\n\tclk[IMX5_CLK_ECSPI2_IPG_GATE]\t= imx_clk_gate2(\"ecspi2_ipg_gate\", \"ipg\", MXC_CCM_CCGR4, 22);\n\tclk[IMX5_CLK_ECSPI2_PER_GATE]\t= imx_clk_gate2(\"ecspi2_per_gate\", \"ecspi_podf\", MXC_CCM_CCGR4, 24);\n\tclk[IMX5_CLK_CSPI_IPG_GATE]\t= imx_clk_gate2(\"cspi_ipg_gate\", \"ipg\", MXC_CCM_CCGR4, 26);\n\tclk[IMX5_CLK_SDMA_GATE]\t\t= imx_clk_gate2(\"sdma_gate\", \"ipg\", MXC_CCM_CCGR4, 30);\n\tclk[IMX5_CLK_EMI_FAST_GATE]\t= imx_clk_gate2_flags(\"emi_fast_gate\", \"dummy\", MXC_CCM_CCGR5, 14, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_EMI_SLOW_GATE]\t= imx_clk_gate2_flags(\"emi_slow_gate\", \"emi_slow_podf\", MXC_CCM_CCGR5, 16, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_IPU_SEL]\t\t= imx_clk_mux(\"ipu_sel\", MXC_CCM_CBCMR, 6, 2, ipu_sel, ARRAY_SIZE(ipu_sel));\n\tclk[IMX5_CLK_IPU_GATE]\t\t= imx_clk_gate2(\"ipu_gate\", \"ipu_sel\", MXC_CCM_CCGR5, 10);\n\tclk[IMX5_CLK_NFC_GATE]\t\t= imx_clk_gate2(\"nfc_gate\", \"nfc_podf\", MXC_CCM_CCGR5, 20);\n\tclk[IMX5_CLK_IPU_DI0_GATE]\t= imx_clk_gate2(\"ipu_di0_gate\", \"ipu_di0_sel\", MXC_CCM_CCGR6, 10);\n\tclk[IMX5_CLK_IPU_DI1_GATE]\t= imx_clk_gate2(\"ipu_di1_gate\", \"ipu_di1_sel\", MXC_CCM_CCGR6, 12);\n\tclk[IMX5_CLK_GPU3D_SEL]\t\t= imx_clk_mux(\"gpu3d_sel\", MXC_CCM_CBCMR, 4, 2, gpu3d_sel, ARRAY_SIZE(gpu3d_sel));\n\tclk[IMX5_CLK_GPU2D_SEL]\t\t= imx_clk_mux(\"gpu2d_sel\", MXC_CCM_CBCMR, 16, 2, gpu2d_sel, ARRAY_SIZE(gpu2d_sel));\n\tclk[IMX5_CLK_GPU3D_GATE]\t= imx_clk_gate2(\"gpu3d_gate\", \"gpu3d_sel\", MXC_CCM_CCGR5, 2);\n\tclk[IMX5_CLK_GARB_GATE]\t\t= imx_clk_gate2(\"garb_gate\", \"axi_a\", MXC_CCM_CCGR5, 4);\n\tclk[IMX5_CLK_GPU2D_GATE]\t= imx_clk_gate2(\"gpu2d_gate\", \"gpu2d_sel\", MXC_CCM_CCGR6, 14);\n\tclk[IMX5_CLK_VPU_SEL]\t\t= imx_clk_mux(\"vpu_sel\", MXC_CCM_CBCMR, 14, 2, vpu_sel, ARRAY_SIZE(vpu_sel));\n\tclk[IMX5_CLK_VPU_GATE]\t\t= imx_clk_gate2(\"vpu_gate\", \"vpu_sel\", MXC_CCM_CCGR5, 6);\n\tclk[IMX5_CLK_VPU_REFERENCE_GATE] = imx_clk_gate2(\"vpu_reference_gate\", \"osc\", MXC_CCM_CCGR5, 8);\n\tclk[IMX5_CLK_GPC_DVFS]\t\t= imx_clk_gate2_flags(\"gpc_dvfs\", \"dummy\", MXC_CCM_CCGR5, 24, CLK_IS_CRITICAL);\n\n\tclk[IMX5_CLK_SSI_APM]\t\t= imx_clk_mux(\"ssi_apm\", MXC_CCM_CSCMR1, 8, 2, ssi_apm_sels, ARRAY_SIZE(ssi_apm_sels));\n\tclk[IMX5_CLK_SSI1_ROOT_SEL]\t= imx_clk_mux(\"ssi1_root_sel\", MXC_CCM_CSCMR1, 14, 2, ssi_clk_sels, ARRAY_SIZE(ssi_clk_sels));\n\tclk[IMX5_CLK_SSI2_ROOT_SEL]\t= imx_clk_mux(\"ssi2_root_sel\", MXC_CCM_CSCMR1, 12, 2, ssi_clk_sels, ARRAY_SIZE(ssi_clk_sels));\n\tclk[IMX5_CLK_SSI3_ROOT_SEL]\t= imx_clk_mux(\"ssi3_root_sel\", MXC_CCM_CSCMR1, 11, 1, ssi3_clk_sels, ARRAY_SIZE(ssi3_clk_sels));\n\tclk[IMX5_CLK_SSI_EXT1_SEL]\t= imx_clk_mux(\"ssi_ext1_sel\", MXC_CCM_CSCMR1, 28, 2, ssi_clk_sels, ARRAY_SIZE(ssi_clk_sels));\n\tclk[IMX5_CLK_SSI_EXT2_SEL]\t= imx_clk_mux(\"ssi_ext2_sel\", MXC_CCM_CSCMR1, 30, 2, ssi_clk_sels, ARRAY_SIZE(ssi_clk_sels));\n\tclk[IMX5_CLK_SSI_EXT1_COM_SEL]\t= imx_clk_mux(\"ssi_ext1_com_sel\", MXC_CCM_CSCMR1, 0, 1, ssi_ext1_com_sels, ARRAY_SIZE(ssi_ext1_com_sels));\n\tclk[IMX5_CLK_SSI_EXT2_COM_SEL]\t= imx_clk_mux(\"ssi_ext2_com_sel\", MXC_CCM_CSCMR1, 1, 1, ssi_ext2_com_sels, ARRAY_SIZE(ssi_ext2_com_sels));\n\tclk[IMX5_CLK_SSI1_ROOT_PRED]\t= imx_clk_divider(\"ssi1_root_pred\", \"ssi1_root_sel\", MXC_CCM_CS1CDR, 6, 3);\n\tclk[IMX5_CLK_SSI1_ROOT_PODF]\t= imx_clk_divider(\"ssi1_root_podf\", \"ssi1_root_pred\", MXC_CCM_CS1CDR, 0, 6);\n\tclk[IMX5_CLK_SSI2_ROOT_PRED]\t= imx_clk_divider(\"ssi2_root_pred\", \"ssi2_root_sel\", MXC_CCM_CS2CDR, 6, 3);\n\tclk[IMX5_CLK_SSI2_ROOT_PODF]\t= imx_clk_divider(\"ssi2_root_podf\", \"ssi2_root_pred\", MXC_CCM_CS2CDR, 0, 6);\n\tclk[IMX5_CLK_SSI_EXT1_PRED]\t= imx_clk_divider(\"ssi_ext1_pred\", \"ssi_ext1_sel\", MXC_CCM_CS1CDR, 22, 3);\n\tclk[IMX5_CLK_SSI_EXT1_PODF]\t= imx_clk_divider(\"ssi_ext1_podf\", \"ssi_ext1_pred\", MXC_CCM_CS1CDR, 16, 6);\n\tclk[IMX5_CLK_SSI_EXT2_PRED]\t= imx_clk_divider(\"ssi_ext2_pred\", \"ssi_ext2_sel\", MXC_CCM_CS2CDR, 22, 3);\n\tclk[IMX5_CLK_SSI_EXT2_PODF]\t= imx_clk_divider(\"ssi_ext2_podf\", \"ssi_ext2_pred\", MXC_CCM_CS2CDR, 16, 6);\n\tclk[IMX5_CLK_SSI1_ROOT_GATE]\t= imx_clk_gate2(\"ssi1_root_gate\", \"ssi1_root_podf\", MXC_CCM_CCGR3, 18);\n\tclk[IMX5_CLK_SSI2_ROOT_GATE]\t= imx_clk_gate2(\"ssi2_root_gate\", \"ssi2_root_podf\", MXC_CCM_CCGR3, 22);\n\tclk[IMX5_CLK_SSI3_ROOT_GATE]\t= imx_clk_gate2(\"ssi3_root_gate\", \"ssi3_root_sel\", MXC_CCM_CCGR3, 26);\n\tclk[IMX5_CLK_SSI_EXT1_GATE]\t= imx_clk_gate2(\"ssi_ext1_gate\", \"ssi_ext1_com_sel\", MXC_CCM_CCGR3, 28);\n\tclk[IMX5_CLK_SSI_EXT2_GATE]\t= imx_clk_gate2(\"ssi_ext2_gate\", \"ssi_ext2_com_sel\", MXC_CCM_CCGR3, 30);\n\tclk[IMX5_CLK_EPIT1_IPG_GATE]\t= imx_clk_gate2(\"epit1_ipg_gate\", \"ipg\", MXC_CCM_CCGR2, 2);\n\tclk[IMX5_CLK_EPIT1_HF_GATE]\t= imx_clk_gate2(\"epit1_hf_gate\", \"per_root\", MXC_CCM_CCGR2, 4);\n\tclk[IMX5_CLK_EPIT2_IPG_GATE]\t= imx_clk_gate2(\"epit2_ipg_gate\", \"ipg\", MXC_CCM_CCGR2, 6);\n\tclk[IMX5_CLK_EPIT2_HF_GATE]\t= imx_clk_gate2(\"epit2_hf_gate\", \"per_root\", MXC_CCM_CCGR2, 8);\n\tclk[IMX5_CLK_OWIRE_GATE]\t= imx_clk_gate2(\"owire_gate\", \"per_root\", MXC_CCM_CCGR2, 22);\n\tclk[IMX5_CLK_SRTC_GATE]\t\t= imx_clk_gate2(\"srtc_gate\", \"per_root\", MXC_CCM_CCGR4, 28);\n\tclk[IMX5_CLK_PATA_GATE]\t\t= imx_clk_gate2(\"pata_gate\", \"ipg\", MXC_CCM_CCGR4, 0);\n\tclk[IMX5_CLK_SPDIF0_SEL]\t= imx_clk_mux(\"spdif0_sel\", MXC_CCM_CSCMR2, 0, 2, spdif_sel, ARRAY_SIZE(spdif_sel));\n\tclk[IMX5_CLK_SPDIF0_PRED]\t= imx_clk_divider(\"spdif0_pred\", \"spdif0_sel\", MXC_CCM_CDCDR, 25, 3);\n\tclk[IMX5_CLK_SPDIF0_PODF]\t= imx_clk_divider(\"spdif0_podf\", \"spdif0_pred\", MXC_CCM_CDCDR, 19, 6);\n\tclk[IMX5_CLK_SPDIF0_COM_SEL]\t= imx_clk_mux_flags(\"spdif0_com_sel\", MXC_CCM_CSCMR2, 4, 1,\n\t\t\t\t\t\tspdif0_com_sel, ARRAY_SIZE(spdif0_com_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_SPDIF0_GATE]\t= imx_clk_gate2(\"spdif0_gate\", \"spdif0_com_sel\", MXC_CCM_CCGR5, 26);\n\tclk[IMX5_CLK_SPDIF_IPG_GATE]\t= imx_clk_gate2(\"spdif_ipg_gate\", \"ipg\", MXC_CCM_CCGR5, 30);\n\tclk[IMX5_CLK_SAHARA_IPG_GATE]\t= imx_clk_gate2(\"sahara_ipg_gate\", \"ipg\", MXC_CCM_CCGR4, 14);\n\tclk[IMX5_CLK_SATA_REF]\t\t= imx_clk_fixed_factor(\"sata_ref\", \"usb_phy1_gate\", 1, 1);\n\n\tclk_register_clkdev(clk[IMX5_CLK_CPU_PODF], NULL, \"cpu0\");\n\tclk_register_clkdev(clk[IMX5_CLK_GPC_DVFS], \"gpc_dvfs\", NULL);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_USB_PHY_SEL], clk[IMX5_CLK_OSC]);\n}\n\nstatic void __init mx50_clocks_init(struct device_node *np)\n{\n\tvoid __iomem *ccm_base;\n\tvoid __iomem *pll_base;\n\tunsigned long r;\n\n\tpll_base = ioremap(MX53_DPLL1_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL1_SW]\t\t= imx_clk_pllv2(\"pll1_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX53_DPLL2_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL2_SW]\t\t= imx_clk_pllv2(\"pll2_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX53_DPLL3_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL3_SW]\t\t= imx_clk_pllv2(\"pll3_sw\", \"osc\", pll_base);\n\n\tccm_base = of_iomap(np, 0);\n\tWARN_ON(!ccm_base);\n\n\tmx5_clocks_common_init(ccm_base);\n\n\t \n\tclk[IMX5_CLK_MAIN_BUS]          = imx_clk_mux(\"main_bus\", MXC_CCM_CBCDR, 25, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\n\tclk[IMX5_CLK_LP_APM]\t\t= imx_clk_mux(\"lp_apm\", MXC_CCM_CCSR, 10, 1,\n\t\t\t\t\t\tlp_apm_sel, ARRAY_SIZE(lp_apm_sel));\n\tclk[IMX5_CLK_ESDHC_A_SEL]\t= imx_clk_mux(\"esdhc_a_sel\", MXC_CCM_CSCMR1, 21, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_B_SEL]\t= imx_clk_mux(\"esdhc_b_sel\", MXC_CCM_CSCMR1, 16, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_C_SEL]\t= imx_clk_mux(\"esdhc_c_sel\", MXC_CCM_CSCMR1, 20, 1, esdhc_c_sel, ARRAY_SIZE(esdhc_c_sel));\n\tclk[IMX5_CLK_ESDHC_D_SEL]\t= imx_clk_mux(\"esdhc_d_sel\", MXC_CCM_CSCMR1, 19, 1, esdhc_d_sel, ARRAY_SIZE(esdhc_d_sel));\n\tclk[IMX5_CLK_ESDHC1_PER_GATE]\t= imx_clk_gate2(\"esdhc1_per_gate\", \"esdhc_a_podf\", MXC_CCM_CCGR3, 2);\n\tclk[IMX5_CLK_ESDHC2_PER_GATE]\t= imx_clk_gate2(\"esdhc2_per_gate\", \"esdhc_c_sel\", MXC_CCM_CCGR3, 6);\n\tclk[IMX5_CLK_ESDHC3_PER_GATE]\t= imx_clk_gate2(\"esdhc3_per_gate\", \"esdhc_b_podf\", MXC_CCM_CCGR3, 10);\n\tclk[IMX5_CLK_ESDHC4_PER_GATE]\t= imx_clk_gate2(\"esdhc4_per_gate\", \"esdhc_d_sel\", MXC_CCM_CCGR3, 14);\n\tclk[IMX5_CLK_USB_PHY1_GATE]\t= imx_clk_gate2(\"usb_phy1_gate\", \"usb_phy_sel\", MXC_CCM_CCGR4, 10);\n\tclk[IMX5_CLK_USB_PHY2_GATE]\t= imx_clk_gate2(\"usb_phy2_gate\", \"usb_phy_sel\", MXC_CCM_CCGR4, 12);\n\tclk[IMX5_CLK_I2C3_GATE]\t\t= imx_clk_gate2(\"i2c3_gate\", \"per_root\", MXC_CCM_CCGR1, 22);\n\tclk[IMX5_CLK_UART4_IPG_GATE]\t= imx_clk_gate2(\"uart4_ipg_gate\", \"ipg\", MXC_CCM_CCGR7, 8);\n\tclk[IMX5_CLK_UART4_PER_GATE]\t= imx_clk_gate2(\"uart4_per_gate\", \"uart_root\", MXC_CCM_CCGR7, 10);\n\tclk[IMX5_CLK_UART5_IPG_GATE]\t= imx_clk_gate2(\"uart5_ipg_gate\", \"ipg\", MXC_CCM_CCGR7, 12);\n\tclk[IMX5_CLK_UART5_PER_GATE]\t= imx_clk_gate2(\"uart5_per_gate\", \"uart_root\", MXC_CCM_CCGR7, 14);\n\n\tclk[IMX5_CLK_CKO1_SEL]\t\t= imx_clk_mux(\"cko1_sel\", MXC_CCM_CCOSR, 0, 4,\n\t\t\t\t\t\tmx53_cko1_sel, ARRAY_SIZE(mx53_cko1_sel));\n\tclk[IMX5_CLK_CKO1_PODF]\t\t= imx_clk_divider(\"cko1_podf\", \"cko1_sel\", MXC_CCM_CCOSR, 4, 3);\n\tclk[IMX5_CLK_CKO1]\t\t= imx_clk_gate2(\"cko1\", \"cko1_podf\", MXC_CCM_CCOSR, 7);\n\n\tclk[IMX5_CLK_CKO2_SEL]\t\t= imx_clk_mux(\"cko2_sel\", MXC_CCM_CCOSR, 16, 5,\n\t\t\t\t\t\tmx53_cko2_sel, ARRAY_SIZE(mx53_cko2_sel));\n\tclk[IMX5_CLK_CKO2_PODF]\t\t= imx_clk_divider(\"cko2_podf\", \"cko2_sel\", MXC_CCM_CCOSR, 21, 3);\n\tclk[IMX5_CLK_CKO2]\t\t= imx_clk_gate2(\"cko2\", \"cko2_podf\", MXC_CCM_CCOSR, 24);\n\n\timx_check_clocks(clk, ARRAY_SIZE(clk));\n\n\tclk_data.clks = clk;\n\tclk_data.clk_num = ARRAY_SIZE(clk);\n\tof_clk_add_provider(np, of_clk_src_onecell_get, &clk_data);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_ESDHC_A_SEL], clk[IMX5_CLK_PLL2_SW]);\n\tclk_set_parent(clk[IMX5_CLK_ESDHC_B_SEL], clk[IMX5_CLK_PLL2_SW]);\n\n\t \n\tclk_set_rate(clk[IMX5_CLK_ESDHC_A_PODF], 200000000);\n\tclk_set_rate(clk[IMX5_CLK_ESDHC_B_PODF], 200000000);\n\n\tclk_prepare_enable(clk[IMX5_CLK_IIM_GATE]);\n\timx_print_silicon_rev(\"i.MX50\", IMX_CHIP_REVISION_1_1);\n\tclk_disable_unprepare(clk[IMX5_CLK_IIM_GATE]);\n\n\tr = clk_round_rate(clk[IMX5_CLK_USBOH3_PER_GATE], 54000000);\n\tclk_set_rate(clk[IMX5_CLK_USBOH3_PER_GATE], r);\n\n\timx_register_uart_clocks();\n}\nCLK_OF_DECLARE(imx50_ccm, \"fsl,imx50-ccm\", mx50_clocks_init);\n\nstatic void __init mx51_clocks_init(struct device_node *np)\n{\n\tvoid __iomem *ccm_base;\n\tvoid __iomem *pll_base;\n\tu32 val;\n\n\tpll_base = ioremap(MX51_DPLL1_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL1_SW]\t\t= imx_clk_pllv2(\"pll1_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX51_DPLL2_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL2_SW]\t\t= imx_clk_pllv2(\"pll2_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX51_DPLL3_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL3_SW]\t\t= imx_clk_pllv2(\"pll3_sw\", \"osc\", pll_base);\n\n\tccm_base = of_iomap(np, 0);\n\tWARN_ON(!ccm_base);\n\n\tmx5_clocks_common_init(ccm_base);\n\n\tclk[IMX5_CLK_PERIPH_APM]\t= imx_clk_mux(\"periph_apm\", MXC_CCM_CBCMR, 12, 2,\n\t\t\t\t\t\tperiph_apm_sel, ARRAY_SIZE(periph_apm_sel));\n\tclk[IMX5_CLK_MAIN_BUS]\t\t= imx_clk_mux(\"main_bus\", MXC_CCM_CBCDR, 25, 1,\n\t\t\t\t\t\tmain_bus_sel, ARRAY_SIZE(main_bus_sel));\n\tclk[IMX5_CLK_LP_APM]\t\t= imx_clk_mux(\"lp_apm\", MXC_CCM_CCSR, 9, 1,\n\t\t\t\t\t\tlp_apm_sel, ARRAY_SIZE(lp_apm_sel));\n\tclk[IMX5_CLK_IPU_DI0_SEL]\t= imx_clk_mux_flags(\"ipu_di0_sel\", MXC_CCM_CSCMR2, 26, 3,\n\t\t\t\t\t\tmx51_ipu_di0_sel, ARRAY_SIZE(mx51_ipu_di0_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_IPU_DI1_SEL]\t= imx_clk_mux_flags(\"ipu_di1_sel\", MXC_CCM_CSCMR2, 29, 3,\n\t\t\t\t\t\tmx51_ipu_di1_sel, ARRAY_SIZE(mx51_ipu_di1_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_TVE_EXT_SEL]\t= imx_clk_mux_flags(\"tve_ext_sel\", MXC_CCM_CSCMR1, 6, 1,\n\t\t\t\t\t\tmx51_tve_ext_sel, ARRAY_SIZE(mx51_tve_ext_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_TVE_SEL]\t\t= imx_clk_mux(\"tve_sel\", MXC_CCM_CSCMR1, 7, 1,\n\t\t\t\t\t\tmx51_tve_sel, ARRAY_SIZE(mx51_tve_sel));\n\tclk[IMX5_CLK_TVE_GATE]\t\t= imx_clk_gate2(\"tve_gate\", \"tve_sel\", MXC_CCM_CCGR2, 30);\n\tclk[IMX5_CLK_TVE_PRED]\t\t= imx_clk_divider(\"tve_pred\", \"pll3_sw\", MXC_CCM_CDCDR, 28, 3);\n\tclk[IMX5_CLK_ESDHC_A_SEL]\t= imx_clk_mux(\"esdhc_a_sel\", MXC_CCM_CSCMR1, 20, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_B_SEL]\t= imx_clk_mux(\"esdhc_b_sel\", MXC_CCM_CSCMR1, 16, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_C_SEL]\t= imx_clk_mux(\"esdhc_c_sel\", MXC_CCM_CSCMR1, 19, 1, esdhc_c_sel, ARRAY_SIZE(esdhc_c_sel));\n\tclk[IMX5_CLK_ESDHC_D_SEL]\t= imx_clk_mux(\"esdhc_d_sel\", MXC_CCM_CSCMR1, 18, 1, esdhc_d_sel, ARRAY_SIZE(esdhc_d_sel));\n\tclk[IMX5_CLK_ESDHC1_PER_GATE]\t= imx_clk_gate2(\"esdhc1_per_gate\", \"esdhc_a_podf\", MXC_CCM_CCGR3, 2);\n\tclk[IMX5_CLK_ESDHC2_PER_GATE]\t= imx_clk_gate2(\"esdhc2_per_gate\", \"esdhc_b_podf\", MXC_CCM_CCGR3, 6);\n\tclk[IMX5_CLK_ESDHC3_PER_GATE]\t= imx_clk_gate2(\"esdhc3_per_gate\", \"esdhc_c_sel\", MXC_CCM_CCGR3, 10);\n\tclk[IMX5_CLK_ESDHC4_PER_GATE]\t= imx_clk_gate2(\"esdhc4_per_gate\", \"esdhc_d_sel\", MXC_CCM_CCGR3, 14);\n\tclk[IMX5_CLK_USB_PHY_GATE]\t= imx_clk_gate2(\"usb_phy_gate\", \"usb_phy_sel\", MXC_CCM_CCGR2, 0);\n\tclk[IMX5_CLK_HSI2C_GATE]\t= imx_clk_gate2(\"hsi2c_gate\", \"ipg\", MXC_CCM_CCGR1, 22);\n\tclk[IMX5_CLK_SCC2_IPG_GATE]\t= imx_clk_gate2(\"scc2_gate\", \"ipg\", MXC_CCM_CCGR1, 30);\n\tclk[IMX5_CLK_MIPI_HSC1_GATE]\t= imx_clk_gate2_flags(\"mipi_hsc1_gate\", \"ipg\", MXC_CCM_CCGR4, 6, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_MIPI_HSC2_GATE]\t= imx_clk_gate2_flags(\"mipi_hsc2_gate\", \"ipg\", MXC_CCM_CCGR4, 8, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_MIPI_ESC_GATE]\t= imx_clk_gate2_flags(\"mipi_esc_gate\", \"ipg\", MXC_CCM_CCGR4, 10, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_MIPI_HSP_GATE]\t= imx_clk_gate2_flags(\"mipi_hsp_gate\", \"ipg\", MXC_CCM_CCGR4, 12, CLK_IS_CRITICAL);\n\tclk[IMX5_CLK_SPDIF_XTAL_SEL]\t= imx_clk_mux(\"spdif_xtal_sel\", MXC_CCM_CSCMR1, 2, 2,\n\t\t\t\t\t\tmx51_spdif_xtal_sel, ARRAY_SIZE(mx51_spdif_xtal_sel));\n\tclk[IMX5_CLK_SPDIF1_SEL]\t= imx_clk_mux(\"spdif1_sel\", MXC_CCM_CSCMR2, 2, 2,\n\t\t\t\t\t\tspdif_sel, ARRAY_SIZE(spdif_sel));\n\tclk[IMX5_CLK_SPDIF1_PRED]\t= imx_clk_divider(\"spdif1_pred\", \"spdif1_sel\", MXC_CCM_CDCDR, 16, 3);\n\tclk[IMX5_CLK_SPDIF1_PODF]\t= imx_clk_divider(\"spdif1_podf\", \"spdif1_pred\", MXC_CCM_CDCDR, 9, 6);\n\tclk[IMX5_CLK_SPDIF1_COM_SEL]\t= imx_clk_mux(\"spdif1_com_sel\", MXC_CCM_CSCMR2, 5, 1,\n\t\t\t\t\t\tmx51_spdif1_com_sel, ARRAY_SIZE(mx51_spdif1_com_sel));\n\tclk[IMX5_CLK_SPDIF1_GATE]\t= imx_clk_gate2(\"spdif1_gate\", \"spdif1_com_sel\", MXC_CCM_CCGR5, 28);\n\n\timx_check_clocks(clk, ARRAY_SIZE(clk));\n\n\tclk_data.clks = clk;\n\tclk_data.clk_num = ARRAY_SIZE(clk);\n\tof_clk_add_provider(np, of_clk_src_onecell_get, &clk_data);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_USBOH3_SEL], clk[IMX5_CLK_PLL2_SW]);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_ESDHC_A_SEL], clk[IMX5_CLK_PLL2_SW]);\n\tclk_set_parent(clk[IMX5_CLK_ESDHC_B_SEL], clk[IMX5_CLK_PLL2_SW]);\n\n\t \n\tclk_set_rate(clk[IMX5_CLK_ESDHC_A_PODF], 166250000);\n\tclk_set_rate(clk[IMX5_CLK_ESDHC_B_PODF], 166250000);\n\n\tclk_prepare_enable(clk[IMX5_CLK_IIM_GATE]);\n\timx_print_silicon_rev(\"i.MX51\", mx51_revision());\n\tclk_disable_unprepare(clk[IMX5_CLK_IIM_GATE]);\n\n\t \n\tval = readl(MXC_CCM_CCDR);\n\tval |= 1 << 18;\n\twritel(val, MXC_CCM_CCDR);\n\n\tval = readl(MXC_CCM_CLPCR);\n\tval |= 1 << 23;\n\twritel(val, MXC_CCM_CLPCR);\n\n\timx_register_uart_clocks();\n}\nCLK_OF_DECLARE(imx51_ccm, \"fsl,imx51-ccm\", mx51_clocks_init);\n\nstatic void __init mx53_clocks_init(struct device_node *np)\n{\n\tvoid __iomem *ccm_base;\n\tvoid __iomem *pll_base;\n\tunsigned long r;\n\n\tpll_base = ioremap(MX53_DPLL1_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL1_SW]\t\t= imx_clk_pllv2(\"pll1_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX53_DPLL2_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL2_SW]\t\t= imx_clk_pllv2(\"pll2_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX53_DPLL3_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL3_SW]\t\t= imx_clk_pllv2(\"pll3_sw\", \"osc\", pll_base);\n\n\tpll_base = ioremap(MX53_DPLL4_BASE, SZ_16K);\n\tWARN_ON(!pll_base);\n\tclk[IMX5_CLK_PLL4_SW]\t\t= imx_clk_pllv2(\"pll4_sw\", \"osc\", pll_base);\n\n\tccm_base = of_iomap(np, 0);\n\tWARN_ON(!ccm_base);\n\n\tmx5_clocks_common_init(ccm_base);\n\n\tclk[IMX5_CLK_PERIPH_APM]\t= imx_clk_mux(\"periph_apm\", MXC_CCM_CBCMR, 12, 2,\n\t\t\t\t\t\tperiph_apm_sel, ARRAY_SIZE(periph_apm_sel));\n\tclk[IMX5_CLK_MAIN_BUS]\t\t= imx_clk_mux(\"main_bus\", MXC_CCM_CBCDR, 25, 1,\n\t\t\t\t\t\tmain_bus_sel, ARRAY_SIZE(main_bus_sel));\n\tclk[IMX5_CLK_LP_APM]\t\t= imx_clk_mux(\"lp_apm\", MXC_CCM_CCSR, 10, 1,\n\t\t\t\t\t\tlp_apm_sel, ARRAY_SIZE(lp_apm_sel));\n\tclk[IMX5_CLK_LDB_DI1_DIV_3_5]\t= imx_clk_fixed_factor(\"ldb_di1_div_3_5\", \"ldb_di1_sel\", 2, 7);\n\tclk[IMX5_CLK_LDB_DI1_DIV]\t= imx_clk_divider_flags(\"ldb_di1_div\", \"ldb_di1_div_3_5\", MXC_CCM_CSCMR2, 11, 1, 0);\n\tclk[IMX5_CLK_LDB_DI1_SEL]\t= imx_clk_mux_flags(\"ldb_di1_sel\", MXC_CCM_CSCMR2, 9, 1,\n\t\t\t\t\t\tmx53_ldb_di1_sel, ARRAY_SIZE(mx53_ldb_di1_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_DI_PLL4_PODF]\t= imx_clk_divider(\"di_pll4_podf\", \"pll4_sw\", MXC_CCM_CDCDR, 16, 3);\n\tclk[IMX5_CLK_LDB_DI0_DIV_3_5]\t= imx_clk_fixed_factor(\"ldb_di0_div_3_5\", \"ldb_di0_sel\", 2, 7);\n\tclk[IMX5_CLK_LDB_DI0_DIV]\t= imx_clk_divider_flags(\"ldb_di0_div\", \"ldb_di0_div_3_5\", MXC_CCM_CSCMR2, 10, 1, 0);\n\tclk[IMX5_CLK_LDB_DI0_SEL]\t= imx_clk_mux_flags(\"ldb_di0_sel\", MXC_CCM_CSCMR2, 8, 1,\n\t\t\t\t\t\tmx53_ldb_di0_sel, ARRAY_SIZE(mx53_ldb_di0_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_LDB_DI0_GATE]\t= imx_clk_gate2(\"ldb_di0_gate\", \"ldb_di0_div\", MXC_CCM_CCGR6, 28);\n\tclk[IMX5_CLK_LDB_DI1_GATE]\t= imx_clk_gate2(\"ldb_di1_gate\", \"ldb_di1_div\", MXC_CCM_CCGR6, 30);\n\tclk[IMX5_CLK_IPU_DI0_SEL]\t= imx_clk_mux_flags(\"ipu_di0_sel\", MXC_CCM_CSCMR2, 26, 3,\n\t\t\t\t\t\tmx53_ipu_di0_sel, ARRAY_SIZE(mx53_ipu_di0_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_IPU_DI1_SEL]\t= imx_clk_mux_flags(\"ipu_di1_sel\", MXC_CCM_CSCMR2, 29, 3,\n\t\t\t\t\t\tmx53_ipu_di1_sel, ARRAY_SIZE(mx53_ipu_di1_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_TVE_EXT_SEL]\t= imx_clk_mux_flags(\"tve_ext_sel\", MXC_CCM_CSCMR1, 6, 1,\n\t\t\t\t\t\tmx53_tve_ext_sel, ARRAY_SIZE(mx53_tve_ext_sel), CLK_SET_RATE_PARENT);\n\tclk[IMX5_CLK_TVE_GATE]\t\t= imx_clk_gate2(\"tve_gate\", \"tve_pred\", MXC_CCM_CCGR2, 30);\n\tclk[IMX5_CLK_TVE_PRED]\t\t= imx_clk_divider(\"tve_pred\", \"tve_ext_sel\", MXC_CCM_CDCDR, 28, 3);\n\tclk[IMX5_CLK_ESDHC_A_SEL]\t= imx_clk_mux(\"esdhc_a_sel\", MXC_CCM_CSCMR1, 20, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_B_SEL]\t= imx_clk_mux(\"esdhc_b_sel\", MXC_CCM_CSCMR1, 16, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_ESDHC_C_SEL]\t= imx_clk_mux(\"esdhc_c_sel\", MXC_CCM_CSCMR1, 19, 1, esdhc_c_sel, ARRAY_SIZE(esdhc_c_sel));\n\tclk[IMX5_CLK_ESDHC_D_SEL]\t= imx_clk_mux(\"esdhc_d_sel\", MXC_CCM_CSCMR1, 18, 1, esdhc_d_sel, ARRAY_SIZE(esdhc_d_sel));\n\tclk[IMX5_CLK_ESDHC1_PER_GATE]\t= imx_clk_gate2(\"esdhc1_per_gate\", \"esdhc_a_podf\", MXC_CCM_CCGR3, 2);\n\tclk[IMX5_CLK_ESDHC2_PER_GATE]\t= imx_clk_gate2(\"esdhc2_per_gate\", \"esdhc_c_sel\", MXC_CCM_CCGR3, 6);\n\tclk[IMX5_CLK_ESDHC3_PER_GATE]\t= imx_clk_gate2(\"esdhc3_per_gate\", \"esdhc_b_podf\", MXC_CCM_CCGR3, 10);\n\tclk[IMX5_CLK_ESDHC4_PER_GATE]\t= imx_clk_gate2(\"esdhc4_per_gate\", \"esdhc_d_sel\", MXC_CCM_CCGR3, 14);\n\tclk[IMX5_CLK_USB_PHY1_GATE]\t= imx_clk_gate2(\"usb_phy1_gate\", \"usb_phy_sel\", MXC_CCM_CCGR4, 10);\n\tclk[IMX5_CLK_USB_PHY2_GATE]\t= imx_clk_gate2(\"usb_phy2_gate\", \"usb_phy_sel\", MXC_CCM_CCGR4, 12);\n\tclk[IMX5_CLK_CAN_SEL]\t\t= imx_clk_mux(\"can_sel\", MXC_CCM_CSCMR2, 6, 2,\n\t\t\t\t\t\tmx53_can_sel, ARRAY_SIZE(mx53_can_sel));\n\tclk[IMX5_CLK_CAN1_SERIAL_GATE]\t= imx_clk_gate2(\"can1_serial_gate\", \"can_sel\", MXC_CCM_CCGR6, 22);\n\tclk[IMX5_CLK_CAN1_IPG_GATE]\t= imx_clk_gate2(\"can1_ipg_gate\", \"ipg\", MXC_CCM_CCGR6, 20);\n\tclk[IMX5_CLK_OCRAM]\t\t= imx_clk_gate2(\"ocram\", \"ahb\", MXC_CCM_CCGR6, 2);\n\tclk[IMX5_CLK_CAN2_SERIAL_GATE]\t= imx_clk_gate2(\"can2_serial_gate\", \"can_sel\", MXC_CCM_CCGR4, 8);\n\tclk[IMX5_CLK_CAN2_IPG_GATE]\t= imx_clk_gate2(\"can2_ipg_gate\", \"ipg\", MXC_CCM_CCGR4, 6);\n\tclk[IMX5_CLK_I2C3_GATE]\t\t= imx_clk_gate2(\"i2c3_gate\", \"per_root\", MXC_CCM_CCGR1, 22);\n\tclk[IMX5_CLK_SATA_GATE]\t\t= imx_clk_gate2(\"sata_gate\", \"ipg\", MXC_CCM_CCGR4, 2);\n\n\tclk[IMX5_CLK_FIRI_SEL]\t\t= imx_clk_mux(\"firi_sel\", MXC_CCM_CSCMR2, 12, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_FIRI_PRED]\t\t= imx_clk_divider(\"firi_pred\", \"firi_sel\", MXC_CCM_CSCDR3, 6, 3);\n\tclk[IMX5_CLK_FIRI_PODF]\t\t= imx_clk_divider(\"firi_podf\", \"firi_pred\", MXC_CCM_CSCDR3, 0, 6);\n\tclk[IMX5_CLK_FIRI_SERIAL_GATE]\t= imx_clk_gate2(\"firi_serial_gate\", \"firi_podf\", MXC_CCM_CCGR1, 28);\n\tclk[IMX5_CLK_FIRI_IPG_GATE]\t= imx_clk_gate2(\"firi_ipg_gate\", \"ipg\", MXC_CCM_CCGR1, 26);\n\n\tclk[IMX5_CLK_CSI0_MCLK1_SEL]\t= imx_clk_mux(\"csi0_mclk1_sel\", MXC_CCM_CSCMR2, 22, 2,\n\t\t\t\t\t\tstandard_pll_sel, ARRAY_SIZE(standard_pll_sel));\n\tclk[IMX5_CLK_CSI0_MCLK1_PRED]\t= imx_clk_divider(\"csi0_mclk1_pred\", \"csi0_mclk1_sel\", MXC_CCM_CSCDR4, 6, 3);\n\tclk[IMX5_CLK_CSI0_MCLK1_PODF]\t= imx_clk_divider(\"csi0_mclk1_podf\", \"csi0_mclk1_pred\", MXC_CCM_CSCDR4, 0, 6);\n\tclk[IMX5_CLK_CSI0_MCLK1_GATE]\t= imx_clk_gate2(\"csi0_mclk1_serial_gate\", \"csi0_mclk1_podf\", MXC_CCM_CCGR6, 4);\n\n\tclk[IMX5_CLK_IEEE1588_SEL]\t= imx_clk_mux(\"ieee1588_sel\", MXC_CCM_CSCMR2, 14, 2,\n\t\t\t\t\t\tieee1588_sels, ARRAY_SIZE(ieee1588_sels));\n\tclk[IMX5_CLK_IEEE1588_PRED]\t= imx_clk_divider(\"ieee1588_pred\", \"ieee1588_sel\", MXC_CCM_CSCDR2, 6, 3);\n\tclk[IMX5_CLK_IEEE1588_PODF]\t= imx_clk_divider(\"ieee1588_podf\", \"ieee1588_pred\", MXC_CCM_CSCDR2, 0, 6);\n\tclk[IMX5_CLK_IEEE1588_GATE]\t= imx_clk_gate2(\"ieee1588_serial_gate\", \"ieee1588_podf\", MXC_CCM_CCGR7, 6);\n\tclk[IMX5_CLK_UART4_IPG_GATE]\t= imx_clk_gate2(\"uart4_ipg_gate\", \"ipg\", MXC_CCM_CCGR7, 8);\n\tclk[IMX5_CLK_UART4_PER_GATE]\t= imx_clk_gate2(\"uart4_per_gate\", \"uart_root\", MXC_CCM_CCGR7, 10);\n\tclk[IMX5_CLK_UART5_IPG_GATE]\t= imx_clk_gate2(\"uart5_ipg_gate\", \"ipg\", MXC_CCM_CCGR7, 12);\n\tclk[IMX5_CLK_UART5_PER_GATE]\t= imx_clk_gate2(\"uart5_per_gate\", \"uart_root\", MXC_CCM_CCGR7, 14);\n\n\tclk[IMX5_CLK_CKO1_SEL]\t\t= imx_clk_mux(\"cko1_sel\", MXC_CCM_CCOSR, 0, 4,\n\t\t\t\t\t\tmx53_cko1_sel, ARRAY_SIZE(mx53_cko1_sel));\n\tclk[IMX5_CLK_CKO1_PODF]\t\t= imx_clk_divider(\"cko1_podf\", \"cko1_sel\", MXC_CCM_CCOSR, 4, 3);\n\tclk[IMX5_CLK_CKO1]\t\t= imx_clk_gate2(\"cko1\", \"cko1_podf\", MXC_CCM_CCOSR, 7);\n\n\tclk[IMX5_CLK_CKO2_SEL]\t\t= imx_clk_mux(\"cko2_sel\", MXC_CCM_CCOSR, 16, 5,\n\t\t\t\t\t\tmx53_cko2_sel, ARRAY_SIZE(mx53_cko2_sel));\n\tclk[IMX5_CLK_CKO2_PODF]\t\t= imx_clk_divider(\"cko2_podf\", \"cko2_sel\", MXC_CCM_CCOSR, 21, 3);\n\tclk[IMX5_CLK_CKO2]\t\t= imx_clk_gate2(\"cko2\", \"cko2_podf\", MXC_CCM_CCOSR, 24);\n\tclk[IMX5_CLK_SPDIF_XTAL_SEL]\t= imx_clk_mux(\"spdif_xtal_sel\", MXC_CCM_CSCMR1, 2, 2,\n\t\t\t\t\t\tmx53_spdif_xtal_sel, ARRAY_SIZE(mx53_spdif_xtal_sel));\n\tclk[IMX5_CLK_ARM]\t\t= imx_clk_cpu(\"arm\", \"cpu_podf\",\n\t\t\t\t\t\tclk[IMX5_CLK_CPU_PODF],\n\t\t\t\t\t\tclk[IMX5_CLK_CPU_PODF_SEL],\n\t\t\t\t\t\tclk[IMX5_CLK_PLL1_SW],\n\t\t\t\t\t\tclk[IMX5_CLK_STEP_SEL]);\n\n\timx_check_clocks(clk, ARRAY_SIZE(clk));\n\n\tclk_data.clks = clk;\n\tclk_data.clk_num = ARRAY_SIZE(clk);\n\tof_clk_add_provider(np, of_clk_src_onecell_get, &clk_data);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_ESDHC_A_SEL], clk[IMX5_CLK_PLL2_SW]);\n\tclk_set_parent(clk[IMX5_CLK_ESDHC_B_SEL], clk[IMX5_CLK_PLL2_SW]);\n\n\t \n\tclk_set_rate(clk[IMX5_CLK_ESDHC_A_PODF], 200000000);\n\tclk_set_rate(clk[IMX5_CLK_ESDHC_B_PODF], 200000000);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_CAN_SEL], clk[IMX5_CLK_LP_APM]);\n\n\t \n\tclk_set_parent(clk[IMX5_CLK_STEP_SEL], clk[IMX5_CLK_LP_APM]);\n\n\tclk_prepare_enable(clk[IMX5_CLK_IIM_GATE]);\n\timx_print_silicon_rev(\"i.MX53\", mx53_revision());\n\tclk_disable_unprepare(clk[IMX5_CLK_IIM_GATE]);\n\n\tr = clk_round_rate(clk[IMX5_CLK_USBOH3_PER_GATE], 54000000);\n\tclk_set_rate(clk[IMX5_CLK_USBOH3_PER_GATE], r);\n\n\timx_register_uart_clocks();\n}\nCLK_OF_DECLARE(imx53_ccm, \"fsl,imx53-ccm\", mx53_clocks_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}