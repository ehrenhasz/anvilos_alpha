{
  "module_name": "jz4780-cgu.c",
  "hash_id": "b1990c58d2e6427dc16160eb259f18d0d06f0d913a52cf73cc03702673d30a26",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/ingenic/jz4780-cgu.c",
  "human_readable_source": "\n \n\n#include <linux/clk-provider.h>\n#include <linux/delay.h>\n#include <linux/io.h>\n#include <linux/iopoll.h>\n#include <linux/of.h>\n\n#include <dt-bindings/clock/ingenic,jz4780-cgu.h>\n\n#include \"cgu.h\"\n#include \"pm.h\"\n\n \n#define CGU_REG_CLOCKCONTROL\t0x00\n#define CGU_REG_LCR\t\t\t\t0x04\n#define CGU_REG_APLL\t\t\t0x10\n#define CGU_REG_MPLL\t\t\t0x14\n#define CGU_REG_EPLL\t\t\t0x18\n#define CGU_REG_VPLL\t\t\t0x1c\n#define CGU_REG_CLKGR0\t\t\t0x20\n#define CGU_REG_OPCR\t\t\t0x24\n#define CGU_REG_CLKGR1\t\t\t0x28\n#define CGU_REG_DDRCDR\t\t\t0x2c\n#define CGU_REG_VPUCDR\t\t\t0x30\n#define CGU_REG_USBPCR\t\t\t0x3c\n#define CGU_REG_USBRDT\t\t\t0x40\n#define CGU_REG_USBVBFIL\t\t0x44\n#define CGU_REG_USBPCR1\t\t\t0x48\n#define CGU_REG_LP0CDR\t\t\t0x54\n#define CGU_REG_I2SCDR\t\t\t0x60\n#define CGU_REG_LP1CDR\t\t\t0x64\n#define CGU_REG_MSC0CDR\t\t\t0x68\n#define CGU_REG_UHCCDR\t\t\t0x6c\n#define CGU_REG_SSICDR\t\t\t0x74\n#define CGU_REG_CIMCDR\t\t\t0x7c\n#define CGU_REG_PCMCDR\t\t\t0x84\n#define CGU_REG_GPUCDR\t\t\t0x88\n#define CGU_REG_HDMICDR\t\t\t0x8c\n#define CGU_REG_MSC1CDR\t\t\t0xa4\n#define CGU_REG_MSC2CDR\t\t\t0xa8\n#define CGU_REG_BCHCDR\t\t\t0xac\n#define CGU_REG_CLOCKSTATUS\t\t0xd4\n\n \n#define OPCR_SPENDN0\t\t\tBIT(7)\n#define OPCR_SPENDN1\t\t\tBIT(6)\n\n \n#define USBPCR_USB_MODE\t\t\tBIT(31)\n#define USBPCR_IDPULLUP_MASK\t(0x3 << 28)\n#define USBPCR_COMMONONN\t\tBIT(25)\n#define USBPCR_VBUSVLDEXT\t\tBIT(24)\n#define USBPCR_VBUSVLDEXTSEL\tBIT(23)\n#define USBPCR_POR\t\t\t\tBIT(22)\n#define USBPCR_SIDDQ\t\t\tBIT(21)\n#define USBPCR_OTG_DISABLE\t\tBIT(20)\n#define USBPCR_COMPDISTUNE_MASK\t(0x7 << 17)\n#define USBPCR_OTGTUNE_MASK\t\t(0x7 << 14)\n#define USBPCR_SQRXTUNE_MASK\t(0x7 << 11)\n#define USBPCR_TXFSLSTUNE_MASK\t(0xf << 7)\n#define USBPCR_TXPREEMPHTUNE\tBIT(6)\n#define USBPCR_TXHSXVTUNE_MASK\t(0x3 << 4)\n#define USBPCR_TXVREFTUNE_MASK\t0xf\n\n \n#define USBPCR1_REFCLKSEL_SHIFT\t26\n#define USBPCR1_REFCLKSEL_MASK\t(0x3 << USBPCR1_REFCLKSEL_SHIFT)\n#define USBPCR1_REFCLKSEL_CORE\t(0x2 << USBPCR1_REFCLKSEL_SHIFT)\n#define USBPCR1_REFCLKDIV_SHIFT\t24\n#define USBPCR1_REFCLKDIV_MASK\t(0x3 << USBPCR1_REFCLKDIV_SHIFT)\n#define USBPCR1_REFCLKDIV_19_2\t(0x3 << USBPCR1_REFCLKDIV_SHIFT)\n#define USBPCR1_REFCLKDIV_48\t(0x2 << USBPCR1_REFCLKDIV_SHIFT)\n#define USBPCR1_REFCLKDIV_24\t(0x1 << USBPCR1_REFCLKDIV_SHIFT)\n#define USBPCR1_REFCLKDIV_12\t(0x0 << USBPCR1_REFCLKDIV_SHIFT)\n#define USBPCR1_USB_SEL\t\t\tBIT(28)\n#define USBPCR1_WORD_IF0\t\tBIT(19)\n#define USBPCR1_WORD_IF1\t\tBIT(18)\n\n \n#define USBRDT_VBFIL_LD_EN\t\tBIT(25)\n#define USBRDT_USBRDT_MASK\t\t0x7fffff\n\n \n#define USBVBFIL_IDDIGFIL_SHIFT\t16\n#define USBVBFIL_IDDIGFIL_MASK\t(0xffff << USBVBFIL_IDDIGFIL_SHIFT)\n#define USBVBFIL_USBVBFIL_MASK\t(0xffff)\n\n \n#define LCR_PD_SCPU\t\t\t\tBIT(31)\n#define LCR_SCPUS\t\t\t\tBIT(27)\n\n \n#define CLKGR1_CORE1\t\t\tBIT(15)\n\nstatic struct ingenic_cgu *cgu;\n\nstatic unsigned long jz4780_otg_phy_recalc_rate(struct clk_hw *hw,\n\t\t\t\t\t\tunsigned long parent_rate)\n{\n\tu32 usbpcr1;\n\tunsigned refclk_div;\n\n\tusbpcr1 = readl(cgu->base + CGU_REG_USBPCR1);\n\trefclk_div = usbpcr1 & USBPCR1_REFCLKDIV_MASK;\n\n\tswitch (refclk_div) {\n\tcase USBPCR1_REFCLKDIV_12:\n\t\treturn 12000000;\n\n\tcase USBPCR1_REFCLKDIV_24:\n\t\treturn 24000000;\n\n\tcase USBPCR1_REFCLKDIV_48:\n\t\treturn 48000000;\n\n\tcase USBPCR1_REFCLKDIV_19_2:\n\t\treturn 19200000;\n\t}\n\n\treturn parent_rate;\n}\n\nstatic long jz4780_otg_phy_round_rate(struct clk_hw *hw, unsigned long req_rate,\n\t\t\t\t      unsigned long *parent_rate)\n{\n\tif (req_rate < 15600000)\n\t\treturn 12000000;\n\n\tif (req_rate < 21600000)\n\t\treturn 19200000;\n\n\tif (req_rate < 36000000)\n\t\treturn 24000000;\n\n\treturn 48000000;\n}\n\nstatic int jz4780_otg_phy_set_rate(struct clk_hw *hw, unsigned long req_rate,\n\t\t\t\t   unsigned long parent_rate)\n{\n\tunsigned long flags;\n\tu32 usbpcr1, div_bits;\n\n\tswitch (req_rate) {\n\tcase 12000000:\n\t\tdiv_bits = USBPCR1_REFCLKDIV_12;\n\t\tbreak;\n\n\tcase 19200000:\n\t\tdiv_bits = USBPCR1_REFCLKDIV_19_2;\n\t\tbreak;\n\n\tcase 24000000:\n\t\tdiv_bits = USBPCR1_REFCLKDIV_24;\n\t\tbreak;\n\n\tcase 48000000:\n\t\tdiv_bits = USBPCR1_REFCLKDIV_48;\n\t\tbreak;\n\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock_irqsave(&cgu->lock, flags);\n\n\tusbpcr1 = readl(cgu->base + CGU_REG_USBPCR1);\n\tusbpcr1 &= ~USBPCR1_REFCLKDIV_MASK;\n\tusbpcr1 |= div_bits;\n\twritel(usbpcr1, cgu->base + CGU_REG_USBPCR1);\n\n\tspin_unlock_irqrestore(&cgu->lock, flags);\n\treturn 0;\n}\n\nstatic int jz4780_otg_phy_enable(struct clk_hw *hw)\n{\n\tvoid __iomem *reg_opcr\t\t= cgu->base + CGU_REG_OPCR;\n\tvoid __iomem *reg_usbpcr\t= cgu->base + CGU_REG_USBPCR;\n\n\twritel(readl(reg_opcr) | OPCR_SPENDN0, reg_opcr);\n\twritel(readl(reg_usbpcr) & ~USBPCR_OTG_DISABLE & ~USBPCR_SIDDQ, reg_usbpcr);\n\treturn 0;\n}\n\nstatic void jz4780_otg_phy_disable(struct clk_hw *hw)\n{\n\tvoid __iomem *reg_opcr\t\t= cgu->base + CGU_REG_OPCR;\n\tvoid __iomem *reg_usbpcr\t= cgu->base + CGU_REG_USBPCR;\n\n\twritel(readl(reg_opcr) & ~OPCR_SPENDN0, reg_opcr);\n\twritel(readl(reg_usbpcr) | USBPCR_OTG_DISABLE | USBPCR_SIDDQ, reg_usbpcr);\n}\n\nstatic int jz4780_otg_phy_is_enabled(struct clk_hw *hw)\n{\n\tvoid __iomem *reg_opcr\t\t= cgu->base + CGU_REG_OPCR;\n\tvoid __iomem *reg_usbpcr\t= cgu->base + CGU_REG_USBPCR;\n\n\treturn (readl(reg_opcr) & OPCR_SPENDN0) &&\n\t\t!(readl(reg_usbpcr) & USBPCR_SIDDQ) &&\n\t\t!(readl(reg_usbpcr) & USBPCR_OTG_DISABLE);\n}\n\nstatic const struct clk_ops jz4780_otg_phy_ops = {\n\t.recalc_rate = jz4780_otg_phy_recalc_rate,\n\t.round_rate = jz4780_otg_phy_round_rate,\n\t.set_rate = jz4780_otg_phy_set_rate,\n\n\t.enable\t\t= jz4780_otg_phy_enable,\n\t.disable\t= jz4780_otg_phy_disable,\n\t.is_enabled\t= jz4780_otg_phy_is_enabled,\n};\n\nstatic int jz4780_core1_enable(struct clk_hw *hw)\n{\n\tstruct ingenic_clk *ingenic_clk = to_ingenic_clk(hw);\n\tstruct ingenic_cgu *cgu = ingenic_clk->cgu;\n\tconst unsigned int timeout = 5000;\n\tunsigned long flags;\n\tint retval;\n\tu32 lcr, clkgr1;\n\n\tspin_lock_irqsave(&cgu->lock, flags);\n\n\tlcr = readl(cgu->base + CGU_REG_LCR);\n\tlcr &= ~LCR_PD_SCPU;\n\twritel(lcr, cgu->base + CGU_REG_LCR);\n\n\tclkgr1 = readl(cgu->base + CGU_REG_CLKGR1);\n\tclkgr1 &= ~CLKGR1_CORE1;\n\twritel(clkgr1, cgu->base + CGU_REG_CLKGR1);\n\n\tspin_unlock_irqrestore(&cgu->lock, flags);\n\n\t \n\tretval = readl_poll_timeout(cgu->base + CGU_REG_LCR, lcr,\n\t\t\t\t !(lcr & LCR_SCPUS), 10, timeout);\n\tif (retval == -ETIMEDOUT) {\n\t\tpr_err(\"%s: Wait for power up core1 timeout\\n\", __func__);\n\t\treturn retval;\n\t}\n\n\treturn 0;\n}\n\nstatic const struct clk_ops jz4780_core1_ops = {\n\t.enable = jz4780_core1_enable,\n};\n\nstatic const s8 pll_od_encoding[16] = {\n\t0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7,\n\t0x8, 0x9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,\n};\n\nstatic const struct ingenic_cgu_clk_info jz4780_cgu_clocks[] = {\n\n\t \n\n\t[JZ4780_CLK_EXCLK] = { \"ext\", CGU_CLK_EXT },\n\t[JZ4780_CLK_RTCLK] = { \"rtc\", CGU_CLK_EXT },\n\n\t \n\n#define DEF_PLL(name) { \\\n\t.reg = CGU_REG_ ## name, \\\n\t.rate_multiplier = 1, \\\n\t.m_shift = 19, \\\n\t.m_bits = 13, \\\n\t.m_offset = 1, \\\n\t.n_shift = 13, \\\n\t.n_bits = 6, \\\n\t.n_offset = 1, \\\n\t.od_shift = 9, \\\n\t.od_bits = 4, \\\n\t.od_max = 16, \\\n\t.od_encoding = pll_od_encoding, \\\n\t.stable_bit = 6, \\\n\t.bypass_reg = CGU_REG_ ## name, \\\n\t.bypass_bit = 1, \\\n\t.enable_bit = 0, \\\n}\n\n\t[JZ4780_CLK_APLL] = {\n\t\t\"apll\", CGU_CLK_PLL,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.pll = DEF_PLL(APLL),\n\t},\n\n\t[JZ4780_CLK_MPLL] = {\n\t\t\"mpll\", CGU_CLK_PLL,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.pll = DEF_PLL(MPLL),\n\t},\n\n\t[JZ4780_CLK_EPLL] = {\n\t\t\"epll\", CGU_CLK_PLL,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.pll = DEF_PLL(EPLL),\n\t},\n\n\t[JZ4780_CLK_VPLL] = {\n\t\t\"vpll\", CGU_CLK_PLL,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.pll = DEF_PLL(VPLL),\n\t},\n\n#undef DEF_PLL\n\n\t \n\n\t[JZ4780_CLK_OTGPHY] = {\n\t\t\"otg_phy\", CGU_CLK_CUSTOM,\n\t\t.parents = { -1, -1, JZ4780_CLK_EXCLK, -1 },\n\t\t.custom = { &jz4780_otg_phy_ops },\n\t},\n\n\t \n\n\t[JZ4780_CLK_SCLKA] = {\n\t\t\"sclk_a\", CGU_CLK_MUX,\n\t\t.parents = { -1, JZ4780_CLK_APLL, JZ4780_CLK_EXCLK,\n\t\t\t     JZ4780_CLK_RTCLK },\n\t\t.mux = { CGU_REG_CLOCKCONTROL, 30, 2 },\n\t},\n\n\t[JZ4780_CLK_CPUMUX] = {\n\t\t\"cpumux\", CGU_CLK_MUX,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL },\n\t\t.mux = { CGU_REG_CLOCKCONTROL, 28, 2 },\n\t},\n\n\t[JZ4780_CLK_CPU] = {\n\t\t\"cpu\", CGU_CLK_DIV,\n\t\t \n\t\t.flags = CLK_IS_CRITICAL,\n\t\t.parents = { JZ4780_CLK_CPUMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_CLOCKCONTROL, 0, 1, 4, 22, -1, -1 },\n\t},\n\n\t[JZ4780_CLK_L2CACHE] = {\n\t\t\"l2cache\", CGU_CLK_DIV,\n\t\t \n\t\t.flags = CLK_IS_CRITICAL,\n\t\t.parents = { JZ4780_CLK_CPUMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_CLOCKCONTROL, 4, 1, 4, -1, -1, -1 },\n\t},\n\n\t[JZ4780_CLK_AHB0] = {\n\t\t\"ahb0\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL },\n\t\t.mux = { CGU_REG_CLOCKCONTROL, 26, 2 },\n\t\t.div = { CGU_REG_CLOCKCONTROL, 8, 1, 4, 21, -1, -1 },\n\t},\n\n\t[JZ4780_CLK_AHB2PMUX] = {\n\t\t\"ahb2_apb_mux\", CGU_CLK_MUX,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_RTCLK },\n\t\t.mux = { CGU_REG_CLOCKCONTROL, 24, 2 },\n\t},\n\n\t[JZ4780_CLK_AHB2] = {\n\t\t\"ahb2\", CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_AHB2PMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_CLOCKCONTROL, 12, 1, 4, 20, -1, -1 },\n\t},\n\n\t[JZ4780_CLK_PCLK] = {\n\t\t\"pclk\", CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_AHB2PMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_CLOCKCONTROL, 16, 1, 4, 20, -1, -1 },\n\t},\n\n\t[JZ4780_CLK_DDR] = {\n\t\t\"ddr\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t \n\t\t.flags = CLK_IS_CRITICAL,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL, -1 },\n\t\t.mux = { CGU_REG_DDRCDR, 30, 2 },\n\t\t.div = { CGU_REG_DDRCDR, 0, 1, 4, 29, 28, 27 },\n\t},\n\n\t[JZ4780_CLK_VPU] = {\n\t\t\"vpu\", CGU_CLK_MUX | CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL, -1 },\n\t\t.mux = { CGU_REG_VPUCDR, 30, 2 },\n\t\t.div = { CGU_REG_VPUCDR, 0, 1, 4, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR1, 2 },\n\t},\n\n\t[JZ4780_CLK_I2SPLL] = {\n\t\t\"i2s_pll\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_EPLL, -1, -1 },\n\t\t.mux = { CGU_REG_I2SCDR, 30, 1 },\n\t\t.div = { CGU_REG_I2SCDR, 0, 1, 8, 29, 28, 27 },\n\t},\n\n\t[JZ4780_CLK_I2S] = {\n\t\t\"i2s\", CGU_CLK_MUX,\n\t\t.parents = { JZ4780_CLK_EXCLK, JZ4780_CLK_I2SPLL, -1, -1 },\n\t\t.mux = { CGU_REG_I2SCDR, 31, 1 },\n\t},\n\n\t[JZ4780_CLK_LCD0PIXCLK] = {\n\t\t\"lcd0pixclk\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_VPLL, -1 },\n\t\t.mux = { CGU_REG_LP0CDR, 30, 2 },\n\t\t.div = { CGU_REG_LP0CDR, 0, 1, 8, 28, 27, 26 },\n\t},\n\n\t[JZ4780_CLK_LCD1PIXCLK] = {\n\t\t\"lcd1pixclk\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_VPLL, -1 },\n\t\t.mux = { CGU_REG_LP1CDR, 30, 2 },\n\t\t.div = { CGU_REG_LP1CDR, 0, 1, 8, 28, 27, 26 },\n\t},\n\n\t[JZ4780_CLK_MSCMUX] = {\n\t\t\"msc_mux\", CGU_CLK_MUX,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL, -1 },\n\t\t.mux = { CGU_REG_MSC0CDR, 30, 2 },\n\t},\n\n\t[JZ4780_CLK_MSC0] = {\n\t\t\"msc0\", CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_MSCMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_MSC0CDR, 0, 2, 8, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR0, 3 },\n\t},\n\n\t[JZ4780_CLK_MSC1] = {\n\t\t\"msc1\", CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_MSCMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_MSC1CDR, 0, 2, 8, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR0, 11 },\n\t},\n\n\t[JZ4780_CLK_MSC2] = {\n\t\t\"msc2\", CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_MSCMUX, -1, -1, -1 },\n\t\t.div = { CGU_REG_MSC2CDR, 0, 2, 8, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR0, 12 },\n\t},\n\n\t[JZ4780_CLK_UHC] = {\n\t\t\"uhc\", CGU_CLK_MUX | CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL, JZ4780_CLK_OTGPHY },\n\t\t.mux = { CGU_REG_UHCCDR, 30, 2 },\n\t\t.div = { CGU_REG_UHCCDR, 0, 1, 8, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR0, 24 },\n\t},\n\n\t[JZ4780_CLK_SSIPLL] = {\n\t\t\"ssi_pll\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL, -1, -1 },\n\t\t.mux = { CGU_REG_SSICDR, 30, 1 },\n\t\t.div = { CGU_REG_SSICDR, 0, 1, 8, 29, 28, 27 },\n\t},\n\n\t[JZ4780_CLK_SSI] = {\n\t\t\"ssi\", CGU_CLK_MUX,\n\t\t.parents = { JZ4780_CLK_EXCLK, JZ4780_CLK_SSIPLL, -1, -1 },\n\t\t.mux = { CGU_REG_SSICDR, 31, 1 },\n\t},\n\n\t[JZ4780_CLK_CIMMCLK] = {\n\t\t\"cim_mclk\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL, -1, -1 },\n\t\t.mux = { CGU_REG_CIMCDR, 31, 1 },\n\t\t.div = { CGU_REG_CIMCDR, 0, 1, 8, 30, 29, 28 },\n\t},\n\n\t[JZ4780_CLK_PCMPLL] = {\n\t\t\"pcm_pll\", CGU_CLK_MUX | CGU_CLK_DIV,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL, JZ4780_CLK_VPLL },\n\t\t.mux = { CGU_REG_PCMCDR, 29, 2 },\n\t\t.div = { CGU_REG_PCMCDR, 0, 1, 8, 28, 27, 26 },\n\t},\n\n\t[JZ4780_CLK_PCM] = {\n\t\t\"pcm\", CGU_CLK_MUX | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, JZ4780_CLK_PCMPLL, -1, -1 },\n\t\t.mux = { CGU_REG_PCMCDR, 31, 1 },\n\t\t.gate = { CGU_REG_CLKGR1, 3 },\n\t},\n\n\t[JZ4780_CLK_GPU] = {\n\t\t\"gpu\", CGU_CLK_MUX | CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL },\n\t\t.mux = { CGU_REG_GPUCDR, 30, 2 },\n\t\t.div = { CGU_REG_GPUCDR, 0, 1, 4, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR1, 4 },\n\t},\n\n\t[JZ4780_CLK_HDMI] = {\n\t\t\"hdmi\", CGU_CLK_MUX | CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_VPLL, -1 },\n\t\t.mux = { CGU_REG_HDMICDR, 30, 2 },\n\t\t.div = { CGU_REG_HDMICDR, 0, 1, 8, 29, 28, 26 },\n\t\t.gate = { CGU_REG_CLKGR1, 9 },\n\t},\n\n\t[JZ4780_CLK_BCH] = {\n\t\t\"bch\", CGU_CLK_MUX | CGU_CLK_DIV | CGU_CLK_GATE,\n\t\t.parents = { -1, JZ4780_CLK_SCLKA, JZ4780_CLK_MPLL,\n\t\t\t     JZ4780_CLK_EPLL },\n\t\t.mux = { CGU_REG_BCHCDR, 30, 2 },\n\t\t.div = { CGU_REG_BCHCDR, 0, 1, 4, 29, 28, 27 },\n\t\t.gate = { CGU_REG_CLKGR0, 1 },\n\t},\n\n\t[JZ4780_CLK_EXCLK_DIV512] = {\n\t\t\"exclk_div512\", CGU_CLK_FIXDIV,\n\t\t.parents = { JZ4780_CLK_EXCLK },\n\t\t.fixdiv = { 512 },\n\t},\n\n\t[JZ4780_CLK_RTC] = {\n\t\t\"rtc_ercs\", CGU_CLK_MUX | CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK_DIV512, JZ4780_CLK_RTCLK },\n\t\t.mux = { CGU_REG_OPCR, 2, 1},\n\t},\n\n\t \n\n\t[JZ4780_CLK_NEMC] = {\n\t\t\"nemc\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_AHB2, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 0 },\n\t},\n\n\t[JZ4780_CLK_OTG0] = {\n\t\t\"otg0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 2 },\n\t},\n\n\t[JZ4780_CLK_SSI0] = {\n\t\t\"ssi0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SSI, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 4 },\n\t},\n\n\t[JZ4780_CLK_SMB0] = {\n\t\t\"smb0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_PCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 5 },\n\t},\n\n\t[JZ4780_CLK_SMB1] = {\n\t\t\"smb1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_PCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 6 },\n\t},\n\n\t[JZ4780_CLK_SCC] = {\n\t\t\"scc\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 7 },\n\t},\n\n\t[JZ4780_CLK_AIC] = {\n\t\t\"aic\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 8 },\n\t},\n\n\t[JZ4780_CLK_TSSI0] = {\n\t\t\"tssi0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 9 },\n\t},\n\n\t[JZ4780_CLK_OWI] = {\n\t\t\"owi\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 10 },\n\t},\n\n\t[JZ4780_CLK_KBC] = {\n\t\t\"kbc\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 13 },\n\t},\n\n\t[JZ4780_CLK_SADC] = {\n\t\t\"sadc\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 14 },\n\t},\n\n\t[JZ4780_CLK_UART0] = {\n\t\t\"uart0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 15 },\n\t},\n\n\t[JZ4780_CLK_UART1] = {\n\t\t\"uart1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 16 },\n\t},\n\n\t[JZ4780_CLK_UART2] = {\n\t\t\"uart2\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 17 },\n\t},\n\n\t[JZ4780_CLK_UART3] = {\n\t\t\"uart3\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 18 },\n\t},\n\n\t[JZ4780_CLK_SSI1] = {\n\t\t\"ssi1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SSI, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 19 },\n\t},\n\n\t[JZ4780_CLK_SSI2] = {\n\t\t\"ssi2\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_SSI, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 20 },\n\t},\n\n\t[JZ4780_CLK_PDMA] = {\n\t\t\"pdma\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 21 },\n\t},\n\n\t[JZ4780_CLK_GPS] = {\n\t\t\"gps\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 22 },\n\t},\n\n\t[JZ4780_CLK_MAC] = {\n\t\t\"mac\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 23 },\n\t},\n\n\t[JZ4780_CLK_SMB2] = {\n\t\t\"smb2\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_PCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 24 },\n\t},\n\n\t[JZ4780_CLK_CIM] = {\n\t\t\"cim\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 26 },\n\t},\n\n\t[JZ4780_CLK_LCD] = {\n\t\t\"lcd\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 28 },\n\t},\n\n\t[JZ4780_CLK_TVE] = {\n\t\t\"tve\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_LCD, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 27 },\n\t},\n\n\t[JZ4780_CLK_IPU] = {\n\t\t\"ipu\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 29 },\n\t},\n\n\t[JZ4780_CLK_DDR0] = {\n\t\t\"ddr0\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_DDR, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 30 },\n\t},\n\n\t[JZ4780_CLK_DDR1] = {\n\t\t\"ddr1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_DDR, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR0, 31 },\n\t},\n\n\t[JZ4780_CLK_SMB3] = {\n\t\t\"smb3\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_PCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 0 },\n\t},\n\n\t[JZ4780_CLK_TSSI1] = {\n\t\t\"tssi1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 1 },\n\t},\n\n\t[JZ4780_CLK_COMPRESS] = {\n\t\t\"compress\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 5 },\n\t},\n\n\t[JZ4780_CLK_AIC1] = {\n\t\t\"aic1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 6 },\n\t},\n\n\t[JZ4780_CLK_GPVLC] = {\n\t\t\"gpvlc\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 7 },\n\t},\n\n\t[JZ4780_CLK_OTG1] = {\n\t\t\"otg1\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 8 },\n\t},\n\n\t[JZ4780_CLK_UART4] = {\n\t\t\"uart4\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 10 },\n\t},\n\n\t[JZ4780_CLK_AHBMON] = {\n\t\t\"ahb_mon\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 11 },\n\t},\n\n\t[JZ4780_CLK_SMB4] = {\n\t\t\"smb4\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_PCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 12 },\n\t},\n\n\t[JZ4780_CLK_DES] = {\n\t\t\"des\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 13 },\n\t},\n\n\t[JZ4780_CLK_X2D] = {\n\t\t\"x2d\", CGU_CLK_GATE,\n\t\t.parents = { JZ4780_CLK_EXCLK, -1, -1, -1 },\n\t\t.gate = { CGU_REG_CLKGR1, 14 },\n\t},\n\n\t[JZ4780_CLK_CORE1] = {\n\t\t\"core1\", CGU_CLK_CUSTOM,\n\t\t.parents = { JZ4780_CLK_CPU, -1, -1, -1 },\n\t\t.custom = { &jz4780_core1_ops },\n\t},\n\n};\n\nstatic void __init jz4780_cgu_init(struct device_node *np)\n{\n\tint retval;\n\n\tcgu = ingenic_cgu_new(jz4780_cgu_clocks,\n\t\t\t      ARRAY_SIZE(jz4780_cgu_clocks), np);\n\tif (!cgu) {\n\t\tpr_err(\"%s: failed to initialise CGU\\n\", __func__);\n\t\treturn;\n\t}\n\n\tretval = ingenic_cgu_register_clocks(cgu);\n\tif (retval) {\n\t\tpr_err(\"%s: failed to register CGU Clocks\\n\", __func__);\n\t\treturn;\n\t}\n\n\tingenic_cgu_register_syscore_ops(cgu);\n}\nCLK_OF_DECLARE_DRIVER(jz4780_cgu, \"ingenic,jz4780-cgu\", jz4780_cgu_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}