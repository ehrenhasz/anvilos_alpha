{
  "module_name": "clk.h",
  "hash_id": "594b6ddb039faa73408a5fb599a1b009bebc11c25a85e3e5a917bf69d2a60bce",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/mmp/clk.h",
  "human_readable_source": " \n#ifndef __MACH_MMP_CLK_H\n#define __MACH_MMP_CLK_H\n\n#include <linux/clk-provider.h>\n#include <linux/pm_domain.h>\n#include <linux/clkdev.h>\n\n#define APBC_NO_BUS_CTRL\tBIT(0)\n#define APBC_POWER_CTRL\t\tBIT(1)\n\n\n \nstruct mmp_clk_factor_masks {\n\tunsigned int factor;\n\tunsigned int num_mask;\n\tunsigned int den_mask;\n\tunsigned int num_shift;\n\tunsigned int den_shift;\n\tunsigned int enable_mask;\n};\n\nstruct mmp_clk_factor_tbl {\n\tunsigned int num;\n\tunsigned int den;\n};\n\nstruct mmp_clk_factor {\n\tstruct clk_hw hw;\n\tvoid __iomem *base;\n\tstruct mmp_clk_factor_masks *masks;\n\tstruct mmp_clk_factor_tbl *ftbl;\n\tunsigned int ftbl_cnt;\n\tspinlock_t *lock;\n};\n\nextern struct clk *mmp_clk_register_factor(const char *name,\n\t\tconst char *parent_name, unsigned long flags,\n\t\tvoid __iomem *base, struct mmp_clk_factor_masks *masks,\n\t\tstruct mmp_clk_factor_tbl *ftbl, unsigned int ftbl_cnt,\n\t\tspinlock_t *lock);\n\n \n#define MMP_CLK_BITS_MASK(width, shift)\t\t\t\\\n\t\t(((1 << (width)) - 1) << (shift))\n#define MMP_CLK_BITS_GET_VAL(data, width, shift)\t\\\n\t\t((data & MMP_CLK_BITS_MASK(width, shift)) >> (shift))\n#define MMP_CLK_BITS_SET_VAL(val, width, shift)\t\t\\\n\t\t(((val) << (shift)) & MMP_CLK_BITS_MASK(width, shift))\n\nenum {\n\tMMP_CLK_MIX_TYPE_V1,\n\tMMP_CLK_MIX_TYPE_V2,\n\tMMP_CLK_MIX_TYPE_V3,\n};\n\n \nstruct mmp_clk_mix_reg_info {\n\tvoid __iomem *reg_clk_ctrl;\n\tvoid __iomem *reg_clk_sel;\n\tu8 width_div;\n\tu8 shift_div;\n\tu8 width_mux;\n\tu8 shift_mux;\n\tu8 bit_fc;\n};\n\n \nstruct mmp_clk_mix_clk_table {\n\tunsigned long rate;\n\tu8 parent_index;\n\tunsigned int divisor;\n\tunsigned int valid;\n};\n\nstruct mmp_clk_mix_config {\n\tstruct mmp_clk_mix_reg_info reg_info;\n\tstruct mmp_clk_mix_clk_table *table;\n\tunsigned int table_size;\n\tu32 *mux_table;\n\tstruct clk_div_table *div_table;\n\tu8 div_flags;\n\tu8 mux_flags;\n};\n\nstruct mmp_clk_mix {\n\tstruct clk_hw hw;\n\tstruct mmp_clk_mix_reg_info reg_info;\n\tstruct mmp_clk_mix_clk_table *table;\n\tu32 *mux_table;\n\tstruct clk_div_table *div_table;\n\tunsigned int table_size;\n\tu8 div_flags;\n\tu8 mux_flags;\n\tunsigned int type;\n\tspinlock_t *lock;\n};\n\nextern const struct clk_ops mmp_clk_mix_ops;\nextern struct clk *mmp_clk_register_mix(struct device *dev,\n\t\t\t\t\tconst char *name,\n\t\t\t\t\tconst char * const *parent_names,\n\t\t\t\t\tu8 num_parents,\n\t\t\t\t\tunsigned long flags,\n\t\t\t\t\tstruct mmp_clk_mix_config *config,\n\t\t\t\t\tspinlock_t *lock);\n\n\n \n#define MMP_CLK_GATE_NEED_DELAY\t\tBIT(0)\n\nstruct mmp_clk_gate {\n\tstruct clk_hw hw;\n\tvoid __iomem *reg;\n\tu32 mask;\n\tu32 val_enable;\n\tu32 val_disable;\n\tunsigned int flags;\n\tspinlock_t *lock;\n};\n\nextern const struct clk_ops mmp_clk_gate_ops;\nextern struct clk *mmp_clk_register_gate(struct device *dev, const char *name,\n\t\t\tconst char *parent_name, unsigned long flags,\n\t\t\tvoid __iomem *reg, u32 mask, u32 val_enable,\n\t\t\tu32 val_disable, unsigned int gate_flags,\n\t\t\tspinlock_t *lock);\n\nextern struct clk *mmp_clk_register_apbc(const char *name,\n\t\tconst char *parent_name, void __iomem *base,\n\t\tunsigned int delay, unsigned int apbc_flags, spinlock_t *lock);\nextern struct clk *mmp_clk_register_apmu(const char *name,\n\t\tconst char *parent_name, void __iomem *base, u32 enable_mask,\n\t\tspinlock_t *lock);\n\nstruct mmp_clk_unit {\n\tunsigned int nr_clks;\n\tstruct clk **clk_table;\n\tstruct clk_onecell_data clk_data;\n};\n\nstruct mmp_param_fixed_rate_clk {\n\tunsigned int id;\n\tchar *name;\n\tconst char *parent_name;\n\tunsigned long flags;\n\tunsigned long fixed_rate;\n};\nvoid mmp_register_fixed_rate_clks(struct mmp_clk_unit *unit,\n\t\t\t\tstruct mmp_param_fixed_rate_clk *clks,\n\t\t\t\tint size);\n\nstruct mmp_param_fixed_factor_clk {\n\tunsigned int id;\n\tchar *name;\n\tconst char *parent_name;\n\tunsigned long mult;\n\tunsigned long div;\n\tunsigned long flags;\n};\nvoid mmp_register_fixed_factor_clks(struct mmp_clk_unit *unit,\n\t\t\t\tstruct mmp_param_fixed_factor_clk *clks,\n\t\t\t\tint size);\n\nstruct mmp_param_general_gate_clk {\n\tunsigned int id;\n\tconst char *name;\n\tconst char *parent_name;\n\tunsigned long flags;\n\tunsigned long offset;\n\tu8 bit_idx;\n\tu8 gate_flags;\n\tspinlock_t *lock;\n};\nvoid mmp_register_general_gate_clks(struct mmp_clk_unit *unit,\n\t\t\t\tstruct mmp_param_general_gate_clk *clks,\n\t\t\t\tvoid __iomem *base, int size);\n\nstruct mmp_param_gate_clk {\n\tunsigned int id;\n\tchar *name;\n\tconst char *parent_name;\n\tunsigned long flags;\n\tunsigned long offset;\n\tu32 mask;\n\tu32 val_enable;\n\tu32 val_disable;\n\tunsigned int gate_flags;\n\tspinlock_t *lock;\n};\nvoid mmp_register_gate_clks(struct mmp_clk_unit *unit,\n\t\t\tstruct mmp_param_gate_clk *clks,\n\t\t\tvoid __iomem *base, int size);\n\nstruct mmp_param_mux_clk {\n\tunsigned int id;\n\tchar *name;\n\tconst char * const *parent_name;\n\tu8 num_parents;\n\tunsigned long flags;\n\tunsigned long offset;\n\tu8 shift;\n\tu8 width;\n\tu8 mux_flags;\n\tspinlock_t *lock;\n};\nvoid mmp_register_mux_clks(struct mmp_clk_unit *unit,\n\t\t\tstruct mmp_param_mux_clk *clks,\n\t\t\tvoid __iomem *base, int size);\n\nstruct mmp_param_div_clk {\n\tunsigned int id;\n\tchar *name;\n\tconst char *parent_name;\n\tunsigned long flags;\n\tunsigned long offset;\n\tu8 shift;\n\tu8 width;\n\tu8 div_flags;\n\tspinlock_t *lock;\n};\nvoid mmp_register_div_clks(struct mmp_clk_unit *unit,\n\t\t\tstruct mmp_param_div_clk *clks,\n\t\t\tvoid __iomem *base, int size);\n\nstruct mmp_param_pll_clk {\n\tunsigned int id;\n\tchar *name;\n\tunsigned long default_rate;\n\tunsigned long enable_offset;\n\tu32 enable;\n\tunsigned long offset;\n\tu8 shift;\n\t \n\tunsigned long input_rate;\n\tunsigned long postdiv_offset;\n\tunsigned long postdiv_shift;\n};\nvoid mmp_register_pll_clks(struct mmp_clk_unit *unit,\n\t\t\tstruct mmp_param_pll_clk *clks,\n\t\t\tvoid __iomem *base, int size);\n\n#define DEFINE_MIX_REG_INFO(w_d, s_d, w_m, s_m, fc)\t\\\n{\t\t\t\t\t\t\t\\\n\t.width_div = (w_d),\t\t\t\t\\\n\t.shift_div = (s_d),\t\t\t\t\\\n\t.width_mux = (w_m),\t\t\t\t\\\n\t.shift_mux = (s_m),\t\t\t\t\\\n\t.bit_fc = (fc),\t\t\t\t\t\\\n}\n\nvoid mmp_clk_init(struct device_node *np, struct mmp_clk_unit *unit,\n\t\tint nr_clks);\nvoid mmp_clk_add(struct mmp_clk_unit *unit, unsigned int id,\n\t\tstruct clk *clk);\n\n \n#define MMP_PM_DOMAIN_NO_DISABLE\t\tBIT(0)\n\nstruct generic_pm_domain *mmp_pm_domain_register(const char *name,\n\t\tvoid __iomem *reg,\n\t\tu32 power_on, u32 reset, u32 clock_enable,\n\t\tunsigned int flags, spinlock_t *lock);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}