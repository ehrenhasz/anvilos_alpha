{
  "module_name": "u8500_of_clk.c",
  "hash_id": "f0707fb1fcfac6c5d05f173faed6a26639a8c5174979a215316ebaaa61abc6d0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/ux500/u8500_of_clk.c",
  "human_readable_source": "\n \n\n#include <linux/of.h>\n#include <linux/of_address.h>\n#include <linux/clk-provider.h>\n#include <linux/mfd/dbx500-prcmu.h>\n\n#include \"clk.h\"\n#include \"prcc.h\"\n#include \"reset-prcc.h\"\n\nstatic struct clk *prcc_pclk[(PRCC_NUM_PERIPH_CLUSTERS + 1) * PRCC_PERIPHS_PER_CLUSTER];\nstatic struct clk *prcc_kclk[(PRCC_NUM_PERIPH_CLUSTERS + 1) * PRCC_PERIPHS_PER_CLUSTER];\nstatic struct clk_hw *clkout_clk[2];\n\n#define PRCC_SHOW(clk, base, bit) \\\n\tclk[(base * PRCC_PERIPHS_PER_CLUSTER) + bit]\n#define PRCC_PCLK_STORE(clk, base, bit)\t\\\n\tprcc_pclk[(base * PRCC_PERIPHS_PER_CLUSTER) + bit] = clk\n#define PRCC_KCLK_STORE(clk, base, bit)        \\\n\tprcc_kclk[(base * PRCC_PERIPHS_PER_CLUSTER) + bit] = clk\n\nstatic struct clk *ux500_twocell_get(struct of_phandle_args *clkspec,\n\t\t\t\t     void *data)\n{\n\tstruct clk **clk_data = data;\n\tunsigned int base, bit;\n\n\tif (clkspec->args_count != 2)\n\t\treturn  ERR_PTR(-EINVAL);\n\n\tbase = clkspec->args[0];\n\tbit = clkspec->args[1];\n\n\tif (base != 1 && base != 2 && base != 3 && base != 5 && base != 6) {\n\t\tpr_err(\"%s: invalid PRCC base %d\\n\", __func__, base);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\treturn PRCC_SHOW(clk_data, base, bit);\n}\n\nstatic struct clk_hw_onecell_data u8500_prcmu_hw_clks = {\n\t.hws = {\n\t\t \n\t\t[PRCMU_NUM_CLKS] = NULL,\n\t},\n\t.num = PRCMU_NUM_CLKS,\n};\n\n \nstatic const char * const u8500_clkout_parents[] = {\n\t\"clk38m_to_clkgen\",\n\t\"aclk\",\n\t \n\t\"ab8500_sysclk\",\n\t\"lcdclk\",\n\t\"sdmmcclk\",\n\t\"tvclk\",\n\t\"timclk\",\n\t \n\t\"clk009\",\n};\n\nstatic struct clk_hw *ux500_clkout_get(struct of_phandle_args *clkspec,\n\t\t\t\t       void *data)\n{\n\tu32 id, source, divider;\n\tstruct clk_hw *clkout;\n\n\tif (clkspec->args_count != 3)\n\t\treturn  ERR_PTR(-EINVAL);\n\n\tid = clkspec->args[0];\n\tsource = clkspec->args[1];\n\tdivider = clkspec->args[2];\n\n\tif (id > 1) {\n\t\tpr_err(\"%s: invalid clkout ID %d\\n\", __func__, id);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tif (clkout_clk[id]) {\n\t\tpr_info(\"%s: clkout%d already registered, not reconfiguring\\n\",\n\t\t\t__func__, id + 1);\n\t\treturn clkout_clk[id];\n\t}\n\n\tif (source > 7) {\n\t\tpr_err(\"%s: invalid source ID %d\\n\", __func__, source);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tif (divider == 0 || divider > 63) {\n\t\tpr_err(\"%s: invalid divider %d\\n\", __func__, divider);\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tpr_debug(\"registering clkout%d with source %d and divider %d\\n\",\n\t\t id + 1, source, divider);\n\n\tclkout = clk_reg_prcmu_clkout(id ? \"clkout2\" : \"clkout1\",\n\t\t\t\t      u8500_clkout_parents,\n\t\t\t\t      ARRAY_SIZE(u8500_clkout_parents),\n\t\t\t\t      source, divider);\n\tif (IS_ERR(clkout)) {\n\t\tpr_err(\"failed to register clkout%d\\n\",  id + 1);\n\t\treturn ERR_CAST(clkout);\n\t}\n\n\tclkout_clk[id] = clkout;\n\n\treturn clkout;\n}\n\nstatic void u8500_clk_init(struct device_node *np)\n{\n\tstruct prcmu_fw_version *fw_version;\n\tstruct device_node *child = NULL;\n\tconst char *sgaclk_parent = NULL;\n\tstruct clk *clk, *rtc_clk, *twd_clk;\n\tu32 bases[CLKRST_MAX];\n\tstruct u8500_prcc_reset *rstc;\n\tint i;\n\n\t \n\trstc = kzalloc(sizeof(*rstc), GFP_KERNEL);\n\tif (!rstc)\n\t\treturn;\n\n\tfor (i = 0; i < ARRAY_SIZE(bases); i++) {\n\t\tstruct resource r;\n\n\t\tif (of_address_to_resource(np, i, &r))\n\t\t\t \n\t\t\tpr_err(\"failed to get CLKRST %d base address\\n\",\n\t\t\t       i + 1);\n\t\tbases[i] = r.start;\n\t\trstc->phy_base[i] = r.start;\n\t}\n\n\t \n\tu8500_prcmu_hw_clks.hws[PRCMU_PLLSOC0] =\n\t\tclk_reg_prcmu_gate(\"soc0_pll\", NULL, PRCMU_PLLSOC0,\n\t\t\t\t   CLK_IGNORE_UNUSED);\n\n\tu8500_prcmu_hw_clks.hws[PRCMU_PLLSOC1] =\n\t\tclk_reg_prcmu_gate(\"soc1_pll\", NULL, PRCMU_PLLSOC1,\n\t\t\t\t   CLK_IGNORE_UNUSED);\n\n\tu8500_prcmu_hw_clks.hws[PRCMU_PLLDDR] =\n\t\tclk_reg_prcmu_gate(\"ddr_pll\", NULL, PRCMU_PLLDDR,\n\t\t\t\t   CLK_IGNORE_UNUSED);\n\n\t \n\tclk_reg_prcmu_rate(\"clk38m_to_clkgen\", NULL, PRCMU_SYSCLK,\n\t\t\t   CLK_IGNORE_UNUSED);\n\tclk_reg_prcmu_rate(\"aclk\", NULL, PRCMU_ACLK,\n\t\t\t   CLK_IGNORE_UNUSED);\n\n\t \n\n\trtc_clk = clk_register_fixed_rate(NULL, \"rtc32k\", \"NULL\",\n\t\t\t\tCLK_IGNORE_UNUSED,\n\t\t\t\t32768);\n\n\t \n\tfw_version = prcmu_get_fw_version();\n\tif (fw_version != NULL) {\n\t\tswitch (fw_version->project) {\n\t\tcase PRCMU_FW_PROJECT_U8500_C2:\n\t\tcase PRCMU_FW_PROJECT_U8500_SSG1:\n\t\tcase PRCMU_FW_PROJECT_U8520:\n\t\tcase PRCMU_FW_PROJECT_U8420:\n\t\tcase PRCMU_FW_PROJECT_U8420_SYSCLK:\n\t\tcase PRCMU_FW_PROJECT_U8500_SSG2:\n\t\t\tsgaclk_parent = \"soc0_pll\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (sgaclk_parent)\n\t\tu8500_prcmu_hw_clks.hws[PRCMU_SGACLK] =\n\t\t\tclk_reg_prcmu_gate(\"sgclk\", sgaclk_parent,\n\t\t\t\t\t   PRCMU_SGACLK, 0);\n\telse\n\t\tu8500_prcmu_hw_clks.hws[PRCMU_SGACLK] =\n\t\t\tclk_reg_prcmu_gate(\"sgclk\", NULL, PRCMU_SGACLK, 0);\n\n\tu8500_prcmu_hw_clks.hws[PRCMU_UARTCLK] =\n\t\tclk_reg_prcmu_gate(\"uartclk\", NULL, PRCMU_UARTCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_MSP02CLK] =\n\t\tclk_reg_prcmu_gate(\"msp02clk\", NULL, PRCMU_MSP02CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_MSP1CLK] =\n\t\tclk_reg_prcmu_gate(\"msp1clk\", NULL, PRCMU_MSP1CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_I2CCLK] =\n\t\tclk_reg_prcmu_gate(\"i2cclk\", NULL, PRCMU_I2CCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_SLIMCLK] =\n\t\tclk_reg_prcmu_gate(\"slimclk\", NULL, PRCMU_SLIMCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER1CLK] =\n\t\tclk_reg_prcmu_gate(\"per1clk\", NULL, PRCMU_PER1CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER2CLK] =\n\t\tclk_reg_prcmu_gate(\"per2clk\", NULL, PRCMU_PER2CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER3CLK] =\n\t\tclk_reg_prcmu_gate(\"per3clk\", NULL, PRCMU_PER3CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER5CLK] =\n\t\tclk_reg_prcmu_gate(\"per5clk\", NULL, PRCMU_PER5CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER6CLK] =\n\t\tclk_reg_prcmu_gate(\"per6clk\", NULL, PRCMU_PER6CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PER7CLK] =\n\t\tclk_reg_prcmu_gate(\"per7clk\", NULL, PRCMU_PER7CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_LCDCLK] =\n\t\tclk_reg_prcmu_scalable(\"lcdclk\", NULL, PRCMU_LCDCLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_BMLCLK] =\n\t\tclk_reg_prcmu_opp_gate(\"bmlclk\", NULL, PRCMU_BMLCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_HSITXCLK] =\n\t\tclk_reg_prcmu_scalable(\"hsitxclk\", NULL, PRCMU_HSITXCLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_HSIRXCLK] =\n\t\tclk_reg_prcmu_scalable(\"hsirxclk\", NULL, PRCMU_HSIRXCLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_HDMICLK] =\n\t\tclk_reg_prcmu_scalable(\"hdmiclk\", NULL, PRCMU_HDMICLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_APEATCLK] =\n\t\tclk_reg_prcmu_gate(\"apeatclk\", NULL, PRCMU_APEATCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_APETRACECLK] =\n\t\tclk_reg_prcmu_scalable(\"apetraceclk\", NULL, PRCMU_APETRACECLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_MCDECLK] =\n\t\tclk_reg_prcmu_gate(\"mcdeclk\", NULL, PRCMU_MCDECLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_IPI2CCLK] =\n\t\tclk_reg_prcmu_opp_gate(\"ipi2cclk\", NULL, PRCMU_IPI2CCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSIALTCLK] =\n\t\tclk_reg_prcmu_gate(\"dsialtclk\", NULL, PRCMU_DSIALTCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DMACLK] =\n\t\tclk_reg_prcmu_gate(\"dmaclk\", NULL, PRCMU_DMACLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_B2R2CLK] =\n\t\tclk_reg_prcmu_gate(\"b2r2clk\", NULL, PRCMU_B2R2CLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_TVCLK] =\n\t\tclk_reg_prcmu_scalable(\"tvclk\", NULL, PRCMU_TVCLK, 0,\n\t\t\t\t       CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_SSPCLK] =\n\t\tclk_reg_prcmu_gate(\"sspclk\", NULL, PRCMU_SSPCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_RNGCLK] =\n\t\tclk_reg_prcmu_gate(\"rngclk\", NULL, PRCMU_RNGCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_UICCCLK] =\n\t\tclk_reg_prcmu_gate(\"uiccclk\", NULL, PRCMU_UICCCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_TIMCLK] =\n\t\tclk_reg_prcmu_gate(\"timclk\", NULL, PRCMU_TIMCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_SYSCLK] =\n\t\tclk_reg_prcmu_gate(\"ab8500_sysclk\", NULL, PRCMU_SYSCLK, 0);\n\tu8500_prcmu_hw_clks.hws[PRCMU_SDMMCCLK] =\n\t\tclk_reg_prcmu_opp_volt_scalable(\"sdmmcclk\", NULL,\n\t\t\t\t\t\tPRCMU_SDMMCCLK, 100000000,\n\t\t\t\t\t\tCLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_PLLDSI] =\n\t\tclk_reg_prcmu_scalable(\"dsi_pll\", \"hdmiclk\",\n\t\t\t\t       PRCMU_PLLDSI, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSI0CLK] =\n\t\tclk_reg_prcmu_scalable(\"dsi0clk\", \"dsi_pll\",\n\t\t\t\t       PRCMU_DSI0CLK, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSI1CLK] =\n\t\tclk_reg_prcmu_scalable(\"dsi1clk\", \"dsi_pll\",\n\t\t\t\t       PRCMU_DSI1CLK, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSI0ESCCLK] =\n\t\tclk_reg_prcmu_scalable(\"dsi0escclk\", \"tvclk\",\n\t\t\t\t       PRCMU_DSI0ESCCLK, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSI1ESCCLK] =\n\t\tclk_reg_prcmu_scalable(\"dsi1escclk\", \"tvclk\",\n\t\t\t\t       PRCMU_DSI1ESCCLK, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_DSI2ESCCLK] =\n\t\tclk_reg_prcmu_scalable(\"dsi2escclk\", \"tvclk\",\n\t\t\t\t       PRCMU_DSI2ESCCLK, 0, CLK_SET_RATE_GATE);\n\tu8500_prcmu_hw_clks.hws[PRCMU_ARMSS] =\n\t\tclk_reg_prcmu_scalable_rate(\"armss\", NULL,\n\t\t\t\t\t    PRCMU_ARMSS, 0, CLK_IGNORE_UNUSED);\n\n\ttwd_clk = clk_register_fixed_factor(NULL, \"smp_twd\", \"armss\",\n\t\t\t\tCLK_IGNORE_UNUSED, 1, 2);\n\n\t \n\tclk = clk_reg_prcc_pclk(\"p1_pclk0\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(0), 0);\n\tPRCC_PCLK_STORE(clk, 1, 0);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk1\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(1), 0);\n\tPRCC_PCLK_STORE(clk, 1, 1);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk2\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(2), 0);\n\tPRCC_PCLK_STORE(clk, 1, 2);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk3\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(3), 0);\n\tPRCC_PCLK_STORE(clk, 1, 3);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk4\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(4), 0);\n\tPRCC_PCLK_STORE(clk, 1, 4);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk5\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(5), 0);\n\tPRCC_PCLK_STORE(clk, 1, 5);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk6\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(6), 0);\n\tPRCC_PCLK_STORE(clk, 1, 6);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk7\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(7), 0);\n\tPRCC_PCLK_STORE(clk, 1, 7);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk8\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(8), 0);\n\tPRCC_PCLK_STORE(clk, 1, 8);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk9\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(9), 0);\n\tPRCC_PCLK_STORE(clk, 1, 9);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk10\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(10), 0);\n\tPRCC_PCLK_STORE(clk, 1, 10);\n\n\tclk = clk_reg_prcc_pclk(\"p1_pclk11\", \"per1clk\", bases[CLKRST1_INDEX],\n\t\t\t\tBIT(11), 0);\n\tPRCC_PCLK_STORE(clk, 1, 11);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk0\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(0), 0);\n\tPRCC_PCLK_STORE(clk, 2, 0);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk1\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(1), 0);\n\tPRCC_PCLK_STORE(clk, 2, 1);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk2\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(2), 0);\n\tPRCC_PCLK_STORE(clk, 2, 2);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk3\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(3), 0);\n\tPRCC_PCLK_STORE(clk, 2, 3);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk4\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(4), 0);\n\tPRCC_PCLK_STORE(clk, 2, 4);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk5\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(5), 0);\n\tPRCC_PCLK_STORE(clk, 2, 5);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk6\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(6), 0);\n\tPRCC_PCLK_STORE(clk, 2, 6);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk7\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(7), 0);\n\tPRCC_PCLK_STORE(clk, 2, 7);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk8\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(8), 0);\n\tPRCC_PCLK_STORE(clk, 2, 8);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk9\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(9), 0);\n\tPRCC_PCLK_STORE(clk, 2, 9);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk10\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(10), 0);\n\tPRCC_PCLK_STORE(clk, 2, 10);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk11\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(11), 0);\n\tPRCC_PCLK_STORE(clk, 2, 11);\n\n\tclk = clk_reg_prcc_pclk(\"p2_pclk12\", \"per2clk\", bases[CLKRST2_INDEX],\n\t\t\t\tBIT(12), 0);\n\tPRCC_PCLK_STORE(clk, 2, 12);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk0\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(0), 0);\n\tPRCC_PCLK_STORE(clk, 3, 0);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk1\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(1), 0);\n\tPRCC_PCLK_STORE(clk, 3, 1);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk2\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(2), 0);\n\tPRCC_PCLK_STORE(clk, 3, 2);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk3\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(3), 0);\n\tPRCC_PCLK_STORE(clk, 3, 3);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk4\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(4), 0);\n\tPRCC_PCLK_STORE(clk, 3, 4);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk5\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(5), 0);\n\tPRCC_PCLK_STORE(clk, 3, 5);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk6\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(6), 0);\n\tPRCC_PCLK_STORE(clk, 3, 6);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk7\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(7), 0);\n\tPRCC_PCLK_STORE(clk, 3, 7);\n\n\tclk = clk_reg_prcc_pclk(\"p3_pclk8\", \"per3clk\", bases[CLKRST3_INDEX],\n\t\t\t\tBIT(8), 0);\n\tPRCC_PCLK_STORE(clk, 3, 8);\n\n\tclk = clk_reg_prcc_pclk(\"p5_pclk0\", \"per5clk\", bases[CLKRST5_INDEX],\n\t\t\t\tBIT(0), 0);\n\tPRCC_PCLK_STORE(clk, 5, 0);\n\n\tclk = clk_reg_prcc_pclk(\"p5_pclk1\", \"per5clk\", bases[CLKRST5_INDEX],\n\t\t\t\tBIT(1), 0);\n\tPRCC_PCLK_STORE(clk, 5, 1);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk0\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(0), 0);\n\tPRCC_PCLK_STORE(clk, 6, 0);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk1\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(1), 0);\n\tPRCC_PCLK_STORE(clk, 6, 1);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk2\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(2), 0);\n\tPRCC_PCLK_STORE(clk, 6, 2);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk3\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(3), 0);\n\tPRCC_PCLK_STORE(clk, 6, 3);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk4\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(4), 0);\n\tPRCC_PCLK_STORE(clk, 6, 4);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk5\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(5), 0);\n\tPRCC_PCLK_STORE(clk, 6, 5);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk6\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(6), 0);\n\tPRCC_PCLK_STORE(clk, 6, 6);\n\n\tclk = clk_reg_prcc_pclk(\"p6_pclk7\", \"per6clk\", bases[CLKRST6_INDEX],\n\t\t\t\tBIT(7), 0);\n\tPRCC_PCLK_STORE(clk, 6, 7);\n\n\t \n\n\t \n\tclk = clk_reg_prcc_kclk(\"p1_uart0_kclk\", \"uartclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(0), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 0);\n\n\tclk = clk_reg_prcc_kclk(\"p1_uart1_kclk\", \"uartclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(1), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 1);\n\n\tclk = clk_reg_prcc_kclk(\"p1_i2c1_kclk\", \"i2cclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(2), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 2);\n\n\tclk = clk_reg_prcc_kclk(\"p1_msp0_kclk\", \"msp02clk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(3), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 3);\n\n\tclk = clk_reg_prcc_kclk(\"p1_msp1_kclk\", \"msp1clk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(4), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 4);\n\n\tclk = clk_reg_prcc_kclk(\"p1_sdi0_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(5), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 5);\n\n\tclk = clk_reg_prcc_kclk(\"p1_i2c2_kclk\", \"i2cclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(6), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 6);\n\n\tclk = clk_reg_prcc_kclk(\"p1_slimbus0_kclk\", \"slimclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(8), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 8);\n\n\tclk = clk_reg_prcc_kclk(\"p1_i2c4_kclk\", \"i2cclk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(9), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 9);\n\n\tclk = clk_reg_prcc_kclk(\"p1_msp3_kclk\", \"msp1clk\",\n\t\t\tbases[CLKRST1_INDEX], BIT(10), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 1, 10);\n\n\t \n\tclk = clk_reg_prcc_kclk(\"p2_i2c3_kclk\", \"i2cclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(0), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 2, 0);\n\n\tclk = clk_reg_prcc_kclk(\"p2_sdi4_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(2), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 2, 2);\n\n\tclk = clk_reg_prcc_kclk(\"p2_msp2_kclk\", \"msp02clk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(3), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 2, 3);\n\n\tclk = clk_reg_prcc_kclk(\"p2_sdi1_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(4), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 2, 4);\n\n\tclk = clk_reg_prcc_kclk(\"p2_sdi3_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(5), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 2, 5);\n\n\t \n\tclk = clk_reg_prcc_kclk(\"p2_ssirx_kclk\", \"hsirxclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(6),\n\t\t\tCLK_SET_RATE_GATE|CLK_SET_RATE_PARENT);\n\tPRCC_KCLK_STORE(clk, 2, 6);\n\n\tclk = clk_reg_prcc_kclk(\"p2_ssitx_kclk\", \"hsitxclk\",\n\t\t\tbases[CLKRST2_INDEX], BIT(7),\n\t\t\tCLK_SET_RATE_GATE|CLK_SET_RATE_PARENT);\n\tPRCC_KCLK_STORE(clk, 2, 7);\n\n\t \n\tclk = clk_reg_prcc_kclk(\"p3_ssp0_kclk\", \"sspclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(1), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 1);\n\n\tclk = clk_reg_prcc_kclk(\"p3_ssp1_kclk\", \"sspclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(2), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 2);\n\n\tclk = clk_reg_prcc_kclk(\"p3_i2c0_kclk\", \"i2cclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(3), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 3);\n\n\tclk = clk_reg_prcc_kclk(\"p3_sdi2_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(4), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 4);\n\n\tclk = clk_reg_prcc_kclk(\"p3_ske_kclk\", \"rtc32k\",\n\t\t\tbases[CLKRST3_INDEX], BIT(5), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 5);\n\n\tclk = clk_reg_prcc_kclk(\"p3_uart2_kclk\", \"uartclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(6), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 6);\n\n\tclk = clk_reg_prcc_kclk(\"p3_sdi5_kclk\", \"sdmmcclk\",\n\t\t\tbases[CLKRST3_INDEX], BIT(7), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 3, 7);\n\n\t \n\tclk = clk_reg_prcc_kclk(\"p3_rng_kclk\", \"rngclk\",\n\t\t\tbases[CLKRST6_INDEX], BIT(0), CLK_SET_RATE_GATE);\n\tPRCC_KCLK_STORE(clk, 6, 0);\n\n\tfor_each_child_of_node(np, child) {\n\t\tif (of_node_name_eq(child, \"prcmu-clock\"))\n\t\t\tof_clk_add_hw_provider(child, of_clk_hw_onecell_get,\n\t\t\t\t\t       &u8500_prcmu_hw_clks);\n\n\t\tif (of_node_name_eq(child, \"clkout-clock\"))\n\t\t\tof_clk_add_hw_provider(child, ux500_clkout_get, NULL);\n\n\t\tif (of_node_name_eq(child, \"prcc-periph-clock\"))\n\t\t\tof_clk_add_provider(child, ux500_twocell_get, prcc_pclk);\n\n\t\tif (of_node_name_eq(child, \"prcc-kernel-clock\"))\n\t\t\tof_clk_add_provider(child, ux500_twocell_get, prcc_kclk);\n\n\t\tif (of_node_name_eq(child, \"rtc32k-clock\"))\n\t\t\tof_clk_add_provider(child, of_clk_src_simple_get, rtc_clk);\n\n\t\tif (of_node_name_eq(child, \"smp-twd-clock\"))\n\t\t\tof_clk_add_provider(child, of_clk_src_simple_get, twd_clk);\n\n\t\tif (of_node_name_eq(child, \"prcc-reset-controller\"))\n\t\t\tu8500_prcc_reset_init(child, rstc);\n\t}\n}\nCLK_OF_DECLARE(u8500_clks, \"stericsson,u8500-clks\", u8500_clk_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}