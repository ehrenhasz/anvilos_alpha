{
  "module_name": "orion.c",
  "hash_id": "26dfa3ca7a2dfd2aa39cdd2c157506014140269eed977a291cc4b709d0ed09f2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/mvebu/orion.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/clk-provider.h>\n#include <linux/io.h>\n#include <linux/of.h>\n#include \"common.h\"\n\nstatic const struct coreclk_ratio orion_coreclk_ratios[] __initconst = {\n\t{ .id = 0, .name = \"ddrclk\", }\n};\n\n \n\n#define SAR_MV88F5181_TCLK_FREQ      8\n#define SAR_MV88F5181_TCLK_FREQ_MASK 0x3\n\nstatic u32 __init mv88f5181_get_tclk_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5181_TCLK_FREQ) &\n\t\tSAR_MV88F5181_TCLK_FREQ_MASK;\n\tif (opt == 0)\n\t\treturn 133333333;\n\telse if (opt == 1)\n\t\treturn 150000000;\n\telse if (opt == 2)\n\t\treturn 166666667;\n\telse\n\t\treturn 0;\n}\n\n#define SAR_MV88F5181_CPU_FREQ       4\n#define SAR_MV88F5181_CPU_FREQ_MASK  0xf\n\nstatic u32 __init mv88f5181_get_cpu_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5181_CPU_FREQ) &\n\t\tSAR_MV88F5181_CPU_FREQ_MASK;\n\tif (opt == 0)\n\t\treturn 333333333;\n\telse if (opt == 1 || opt == 2)\n\t\treturn 400000000;\n\telse if (opt == 3)\n\t\treturn 500000000;\n\telse\n\t\treturn 0;\n}\n\nstatic void __init mv88f5181_get_clk_ratio(void __iomem *sar, int id,\n\t\t\t\t\t   int *mult, int *div)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5181_CPU_FREQ) &\n\t\tSAR_MV88F5181_CPU_FREQ_MASK;\n\tif (opt == 0 || opt == 1) {\n\t\t*mult = 1;\n\t\t*div  = 2;\n\t} else if (opt == 2 || opt == 3) {\n\t\t*mult = 1;\n\t\t*div  = 3;\n\t} else {\n\t\t*mult = 0;\n\t\t*div  = 1;\n\t}\n}\n\nstatic const struct coreclk_soc_desc mv88f5181_coreclks = {\n\t.get_tclk_freq = mv88f5181_get_tclk_freq,\n\t.get_cpu_freq = mv88f5181_get_cpu_freq,\n\t.get_clk_ratio = mv88f5181_get_clk_ratio,\n\t.ratios = orion_coreclk_ratios,\n\t.num_ratios = ARRAY_SIZE(orion_coreclk_ratios),\n};\n\nstatic void __init mv88f5181_clk_init(struct device_node *np)\n{\n\treturn mvebu_coreclk_setup(np, &mv88f5181_coreclks);\n}\n\nCLK_OF_DECLARE(mv88f5181_clk, \"marvell,mv88f5181-core-clock\", mv88f5181_clk_init);\n\n \n\n#define SAR_MV88F5182_TCLK_FREQ      8\n#define SAR_MV88F5182_TCLK_FREQ_MASK 0x3\n\nstatic u32 __init mv88f5182_get_tclk_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5182_TCLK_FREQ) &\n\t\tSAR_MV88F5182_TCLK_FREQ_MASK;\n\tif (opt == 1)\n\t\treturn 150000000;\n\telse if (opt == 2)\n\t\treturn 166666667;\n\telse\n\t\treturn 0;\n}\n\n#define SAR_MV88F5182_CPU_FREQ       4\n#define SAR_MV88F5182_CPU_FREQ_MASK  0xf\n\nstatic u32 __init mv88f5182_get_cpu_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5182_CPU_FREQ) &\n\t\tSAR_MV88F5182_CPU_FREQ_MASK;\n\tif (opt == 0)\n\t\treturn 333333333;\n\telse if (opt == 1 || opt == 2)\n\t\treturn 400000000;\n\telse if (opt == 3)\n\t\treturn 500000000;\n\telse\n\t\treturn 0;\n}\n\nstatic void __init mv88f5182_get_clk_ratio(void __iomem *sar, int id,\n\t\t\t\t\t   int *mult, int *div)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5182_CPU_FREQ) &\n\t\tSAR_MV88F5182_CPU_FREQ_MASK;\n\tif (opt == 0 || opt == 1) {\n\t\t*mult = 1;\n\t\t*div  = 2;\n\t} else if (opt == 2 || opt == 3) {\n\t\t*mult = 1;\n\t\t*div  = 3;\n\t} else {\n\t\t*mult = 0;\n\t\t*div  = 1;\n\t}\n}\n\nstatic const struct coreclk_soc_desc mv88f5182_coreclks = {\n\t.get_tclk_freq = mv88f5182_get_tclk_freq,\n\t.get_cpu_freq = mv88f5182_get_cpu_freq,\n\t.get_clk_ratio = mv88f5182_get_clk_ratio,\n\t.ratios = orion_coreclk_ratios,\n\t.num_ratios = ARRAY_SIZE(orion_coreclk_ratios),\n};\n\nstatic void __init mv88f5182_clk_init(struct device_node *np)\n{\n\treturn mvebu_coreclk_setup(np, &mv88f5182_coreclks);\n}\n\nCLK_OF_DECLARE(mv88f5182_clk, \"marvell,mv88f5182-core-clock\", mv88f5182_clk_init);\n\n \n\nstatic u32 __init mv88f5281_get_tclk_freq(void __iomem *sar)\n{\n\t \n\treturn 166666667;\n}\n\n#define SAR_MV88F5281_CPU_FREQ       4\n#define SAR_MV88F5281_CPU_FREQ_MASK  0xf\n\nstatic u32 __init mv88f5281_get_cpu_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5281_CPU_FREQ) &\n\t\tSAR_MV88F5281_CPU_FREQ_MASK;\n\tif (opt == 1 || opt == 2)\n\t\treturn 400000000;\n\telse if (opt == 3)\n\t\treturn 500000000;\n\telse\n\t\treturn 0;\n}\n\nstatic void __init mv88f5281_get_clk_ratio(void __iomem *sar, int id,\n\t\t\t\t\t   int *mult, int *div)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F5281_CPU_FREQ) &\n\t\tSAR_MV88F5281_CPU_FREQ_MASK;\n\tif (opt == 1) {\n\t\t*mult = 1;\n\t\t*div = 2;\n\t} else if (opt == 2 || opt == 3) {\n\t\t*mult = 1;\n\t\t*div = 3;\n\t} else {\n\t\t*mult = 0;\n\t\t*div = 1;\n\t}\n}\n\nstatic const struct coreclk_soc_desc mv88f5281_coreclks = {\n\t.get_tclk_freq = mv88f5281_get_tclk_freq,\n\t.get_cpu_freq = mv88f5281_get_cpu_freq,\n\t.get_clk_ratio = mv88f5281_get_clk_ratio,\n\t.ratios = orion_coreclk_ratios,\n\t.num_ratios = ARRAY_SIZE(orion_coreclk_ratios),\n};\n\nstatic void __init mv88f5281_clk_init(struct device_node *np)\n{\n\treturn mvebu_coreclk_setup(np, &mv88f5281_coreclks);\n}\n\nCLK_OF_DECLARE(mv88f5281_clk, \"marvell,mv88f5281-core-clock\", mv88f5281_clk_init);\n\n \n\n#define SAR_MV88F6183_TCLK_FREQ      9\n#define SAR_MV88F6183_TCLK_FREQ_MASK 0x1\n\nstatic u32 __init mv88f6183_get_tclk_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F6183_TCLK_FREQ) &\n\t\tSAR_MV88F6183_TCLK_FREQ_MASK;\n\tif (opt == 0)\n\t\treturn 133333333;\n\telse if (opt == 1)\n\t\treturn 166666667;\n\telse\n\t\treturn 0;\n}\n\n#define SAR_MV88F6183_CPU_FREQ       1\n#define SAR_MV88F6183_CPU_FREQ_MASK  0x3f\n\nstatic u32 __init mv88f6183_get_cpu_freq(void __iomem *sar)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F6183_CPU_FREQ) &\n\t\tSAR_MV88F6183_CPU_FREQ_MASK;\n\tif (opt == 9)\n\t\treturn 333333333;\n\telse if (opt == 17)\n\t\treturn 400000000;\n\telse\n\t\treturn 0;\n}\n\nstatic void __init mv88f6183_get_clk_ratio(void __iomem *sar, int id,\n\t\t\t\t\t   int *mult, int *div)\n{\n\tu32 opt = (readl(sar) >> SAR_MV88F6183_CPU_FREQ) &\n\t\tSAR_MV88F6183_CPU_FREQ_MASK;\n\tif (opt == 9 || opt == 17) {\n\t\t*mult = 1;\n\t\t*div  = 2;\n\t} else {\n\t\t*mult = 0;\n\t\t*div  = 1;\n\t}\n}\n\nstatic const struct coreclk_soc_desc mv88f6183_coreclks = {\n\t.get_tclk_freq = mv88f6183_get_tclk_freq,\n\t.get_cpu_freq = mv88f6183_get_cpu_freq,\n\t.get_clk_ratio = mv88f6183_get_clk_ratio,\n\t.ratios = orion_coreclk_ratios,\n\t.num_ratios = ARRAY_SIZE(orion_coreclk_ratios),\n};\n\n\nstatic void __init mv88f6183_clk_init(struct device_node *np)\n{\n\treturn mvebu_coreclk_setup(np, &mv88f6183_coreclks);\n}\n\nCLK_OF_DECLARE(mv88f6183_clk, \"marvell,mv88f6183-core-clock\", mv88f6183_clk_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}