{
  "module_name": "apcs-msm8996.c",
  "hash_id": "6305318952738f070765dac517e86de67a7cf698bb10238d9f0a4dc0b84770d8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/qcom/apcs-msm8996.c",
  "human_readable_source": "\n \n\n#include <linux/bits.h>\n#include <linux/bitfield.h>\n#include <linux/clk-provider.h>\n#include <linux/delay.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n\n#define APCS_AUX_OFFSET\t0x50\n\n#define APCS_AUX_DIV_MASK GENMASK(17, 16)\n#define APCS_AUX_DIV_2 0x1\n\nstatic int qcom_apcs_msm8996_clk_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct device *parent = dev->parent;\n\tstruct regmap *regmap;\n\tstruct clk_hw *hw;\n\tunsigned int val;\n\tint ret = -ENODEV;\n\n\tregmap = dev_get_regmap(parent, NULL);\n\tif (!regmap) {\n\t\tdev_err(dev, \"failed to get regmap: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tregmap_read(regmap, APCS_AUX_OFFSET, &val);\n\tregmap_update_bits(regmap, APCS_AUX_OFFSET, APCS_AUX_DIV_MASK,\n\t\t\t   FIELD_PREP(APCS_AUX_DIV_MASK, APCS_AUX_DIV_2));\n\n\t \n\tudelay(5);\n\n\t \n\thw = devm_clk_hw_register_fixed_rate(dev, \"sys_apcs_aux\", NULL, 0, 300000000);\n\tif (IS_ERR(hw))\n\t\treturn PTR_ERR(hw);\n\n\treturn devm_of_clk_add_hw_provider(dev, of_clk_hw_simple_get, hw);\n}\n\nstatic struct platform_driver qcom_apcs_msm8996_clk_driver = {\n\t.probe = qcom_apcs_msm8996_clk_probe,\n\t.driver = {\n\t\t.name = \"qcom-apcs-msm8996-clk\",\n\t},\n};\n\n \nstatic int __init qcom_apcs_msm8996_clk_init(void)\n{\n\treturn platform_driver_register(&qcom_apcs_msm8996_clk_driver);\n}\npostcore_initcall(qcom_apcs_msm8996_clk_init);\n\nstatic void __exit qcom_apcs_msm8996_clk_exit(void)\n{\n\tplatform_driver_unregister(&qcom_apcs_msm8996_clk_driver);\n}\nmodule_exit(qcom_apcs_msm8996_clk_exit);\n\nMODULE_AUTHOR(\"Dmitry Baryshkov <dmitry.baryshkov@linaro.org>\");\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"Qualcomm MSM8996 APCS clock driver\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}