{
  "module_name": "ccu_mux.h",
  "hash_id": "572cb01bc144a0dcb2462c268398619f852634f7d031ef8093bb58c22b21a7af",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/sunxi-ng/ccu_mux.h",
  "human_readable_source": " \n#ifndef _CCU_MUX_H_\n#define _CCU_MUX_H_\n\n#include <linux/clk-provider.h>\n\n#include \"ccu_common.h\"\n\nstruct ccu_mux_fixed_prediv {\n\tu8\tindex;\n\tu16\tdiv;\n};\n\nstruct ccu_mux_var_prediv {\n\tu8\tindex;\n\tu8\tshift;\n\tu8\twidth;\n};\n\nstruct ccu_mux_internal {\n\tu8\t\tshift;\n\tu8\t\twidth;\n\tconst u8\t*table;\n\n\tconst struct ccu_mux_fixed_prediv\t*fixed_predivs;\n\tu8\t\tn_predivs;\n\n\tconst struct ccu_mux_var_prediv\t\t*var_predivs;\n\tu8\t\tn_var_predivs;\n};\n\n#define _SUNXI_CCU_MUX_TABLE(_shift, _width, _table)\t\\\n\t{\t\t\t\t\t\t\\\n\t\t.shift\t= _shift,\t\t\t\\\n\t\t.width\t= _width,\t\t\t\\\n\t\t.table\t= _table,\t\t\t\\\n\t}\n\n#define _SUNXI_CCU_MUX(_shift, _width) \\\n\t_SUNXI_CCU_MUX_TABLE(_shift, _width, NULL)\n\nstruct ccu_mux {\n\tu32\t\t\tenable;\n\n\tstruct ccu_mux_internal\tmux;\n\tstruct ccu_common\tcommon;\n};\n\n#define SUNXI_CCU_MUX_TABLE_WITH_GATE_FEAT(_struct, _name, _parents, _table,\t\\\n\t\t\t\t     _reg, _shift, _width, _gate,\t\t\\\n\t\t\t\t     _flags, _features)\t\t\t\t\\\n\tstruct ccu_mux _struct = {\t\t\t\t\t\t\\\n\t\t.enable\t= _gate,\t\t\t\t\t\t\\\n\t\t.mux\t= _SUNXI_CCU_MUX_TABLE(_shift, _width, _table),\t\t\\\n\t\t.common\t= {\t\t\t\t\t\t\t\\\n\t\t\t.reg\t\t= _reg,\t\t\t\t\t\\\n\t\t\t.hw.init\t= CLK_HW_INIT_PARENTS(_name,\t\t\\\n\t\t\t\t\t\t\t      _parents,\t\t\\\n\t\t\t\t\t\t\t      &ccu_mux_ops,\t\\\n\t\t\t\t\t\t\t      _flags),\t\t\\\n\t\t\t.features\t= _features,\t\t\t\t\\\n\t\t}\t\t\t\t\t\t\t\t\\\n\t}\n\n#define SUNXI_CCU_MUX_TABLE_WITH_GATE_CLOSEST(_struct, _name, _parents,\t\\\n\t\t\t\t\t      _table, _reg, _shift,\t\\\n\t\t\t\t\t      _width, _gate, _flags)\t\\\n\tSUNXI_CCU_MUX_TABLE_WITH_GATE_FEAT(_struct, _name, _parents,\t\\\n\t\t\t\t\t   _table, _reg, _shift,\t\\\n\t\t\t\t\t   _width, _gate, _flags,\t\\\n\t\t\t\t\t   CCU_FEATURE_CLOSEST_RATE)\n\n#define SUNXI_CCU_MUX_TABLE_WITH_GATE(_struct, _name, _parents, _table,\t\\\n\t\t\t\t     _reg, _shift, _width, _gate,\t\\\n\t\t\t\t     _flags)\t\t\t\t\\\n\tSUNXI_CCU_MUX_TABLE_WITH_GATE_FEAT(_struct, _name, _parents,\t\\\n\t\t\t\t\t   _table, _reg, _shift,\t\\\n\t\t\t\t\t   _width, _gate, _flags, 0)\n\n#define SUNXI_CCU_MUX_WITH_GATE(_struct, _name, _parents, _reg,\t\t\\\n\t\t\t\t_shift, _width, _gate, _flags)\t\t\\\n\tSUNXI_CCU_MUX_TABLE_WITH_GATE(_struct, _name, _parents, NULL,\t\\\n\t\t\t\t      _reg, _shift, _width, _gate,\t\\\n\t\t\t\t      _flags)\n\n#define SUNXI_CCU_MUX(_struct, _name, _parents, _reg, _shift, _width,\t\\\n\t\t      _flags)\t\t\t\t\t\t\\\n\tSUNXI_CCU_MUX_TABLE_WITH_GATE(_struct, _name, _parents, NULL,\t\\\n\t\t\t\t      _reg, _shift, _width, 0, _flags)\n\n#define SUNXI_CCU_MUX_DATA_WITH_GATE(_struct, _name, _parents, _reg,\t\\\n\t\t\t\t     _shift, _width, _gate, _flags)\t\\\n\tstruct ccu_mux _struct = {\t\t\t\t\t\\\n\t\t.enable\t= _gate,\t\t\t\t\t\\\n\t\t.mux\t= _SUNXI_CCU_MUX(_shift, _width),\t\t\\\n\t\t.common\t= {\t\t\t\t\t\t\\\n\t\t\t.reg\t\t= _reg,\t\t\t\t\\\n\t\t\t.hw.init\t= CLK_HW_INIT_PARENTS_DATA(_name, \\\n\t\t\t\t\t\t\t\t   _parents, \\\n\t\t\t\t\t\t\t\t   &ccu_mux_ops, \\\n\t\t\t\t\t\t\t\t   _flags), \\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\n\n#define SUNXI_CCU_MUX_DATA(_struct, _name, _parents, _reg,\t\t\\\n\t\t      _shift, _width, _flags)\t\t\t\t\\\n\tSUNXI_CCU_MUX_DATA_WITH_GATE(_struct, _name, _parents, _reg,\t\\\n\t\t\t\t     _shift, _width, 0, _flags)\n\n#define SUNXI_CCU_MUX_HW_WITH_GATE(_struct, _name, _parents, _reg,\t\\\n\t\t\t\t   _shift, _width, _gate, _flags)\t\\\n\tstruct ccu_mux _struct = {\t\t\t\t\t\\\n\t\t.enable\t= _gate,\t\t\t\t\t\\\n\t\t.mux\t= _SUNXI_CCU_MUX(_shift, _width),\t\t\\\n\t\t.common\t= {\t\t\t\t\t\t\\\n\t\t\t.reg\t\t= _reg,\t\t\t\t\\\n\t\t\t.hw.init\t= CLK_HW_INIT_PARENTS_HW(_name, \\\n\t\t\t\t\t\t\t\t _parents, \\\n\t\t\t\t\t\t\t\t &ccu_mux_ops, \\\n\t\t\t\t\t\t\t\t _flags), \\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\n\nstatic inline struct ccu_mux *hw_to_ccu_mux(struct clk_hw *hw)\n{\n\tstruct ccu_common *common = hw_to_ccu_common(hw);\n\n\treturn container_of(common, struct ccu_mux, common);\n}\n\nextern const struct clk_ops ccu_mux_ops;\n\nunsigned long ccu_mux_helper_apply_prediv(struct ccu_common *common,\n\t\t\t\t\t  struct ccu_mux_internal *cm,\n\t\t\t\t\t  int parent_index,\n\t\t\t\t\t  unsigned long parent_rate);\nint ccu_mux_helper_determine_rate(struct ccu_common *common,\n\t\t\t\t  struct ccu_mux_internal *cm,\n\t\t\t\t  struct clk_rate_request *req,\n\t\t\t\t  unsigned long (*round)(struct ccu_mux_internal *,\n\t\t\t\t\t\t\t struct clk_hw *,\n\t\t\t\t\t\t\t unsigned long *,\n\t\t\t\t\t\t\t unsigned long,\n\t\t\t\t\t\t\t void *),\n\t\t\t\t  void *data);\nu8 ccu_mux_helper_get_parent(struct ccu_common *common,\n\t\t\t     struct ccu_mux_internal *cm);\nint ccu_mux_helper_set_parent(struct ccu_common *common,\n\t\t\t      struct ccu_mux_internal *cm,\n\t\t\t      u8 index);\n\nstruct ccu_mux_nb {\n\tstruct notifier_block\tclk_nb;\n\tstruct ccu_common\t*common;\n\tstruct ccu_mux_internal\t*cm;\n\n\tu32\tdelay_us;\t \n\tu8\tbypass_index;\t \n\tu8\toriginal_index;\t \n};\n\n#define to_ccu_mux_nb(_nb) container_of(_nb, struct ccu_mux_nb, clk_nb)\n\nint ccu_mux_notifier_register(struct clk *clk, struct ccu_mux_nb *mux_nb);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}