{
  "module_name": "ccu-sun50i-h6-r.c",
  "hash_id": "8ac2f078578948336ba154a6a4178431a0d0493b9d9c4ad6a0548aa63b816399",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/sunxi-ng/ccu-sun50i-h6-r.c",
  "human_readable_source": "\n \n\n#include <linux/clk-provider.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n\n#include \"ccu_common.h\"\n#include \"ccu_reset.h\"\n\n#include \"ccu_div.h\"\n#include \"ccu_gate.h\"\n#include \"ccu_mp.h\"\n#include \"ccu_nm.h\"\n\n#include \"ccu-sun50i-h6-r.h\"\n\n \n\nstatic const char * const ar100_r_apb2_parents[] = { \"osc24M\", \"osc32k\",\n\t\t\t\t\t\t     \"iosc\", \"pll-periph0\" };\nstatic const struct ccu_mux_var_prediv ar100_r_apb2_predivs[] = {\n\t{ .index = 3, .shift = 0, .width = 5 },\n};\n\nstatic struct ccu_div ar100_clk = {\n\t.div\t\t= _SUNXI_CCU_DIV_FLAGS(8, 2, CLK_DIVIDER_POWER_OF_TWO),\n\n\t.mux\t\t= {\n\t\t.shift\t= 24,\n\t\t.width\t= 2,\n\n\t\t.var_predivs\t= ar100_r_apb2_predivs,\n\t\t.n_var_predivs\t= ARRAY_SIZE(ar100_r_apb2_predivs),\n\t},\n\n\t.common\t\t= {\n\t\t.reg\t\t= 0x000,\n\t\t.features\t= CCU_FEATURE_VARIABLE_PREDIV,\n\t\t.hw.init\t= CLK_HW_INIT_PARENTS(\"ar100\",\n\t\t\t\t\t\t      ar100_r_apb2_parents,\n\t\t\t\t\t\t      &ccu_div_ops,\n\t\t\t\t\t\t      0),\n\t},\n};\n\nstatic CLK_FIXED_FACTOR_HW(r_ahb_clk, \"r-ahb\", &ar100_clk.common.hw, 1, 1, 0);\n\nstatic SUNXI_CCU_M(r_apb1_clk, \"r-apb1\", \"r-ahb\", 0x00c, 0, 2, 0);\n\nstatic struct ccu_div r_apb2_clk = {\n\t.div\t\t= _SUNXI_CCU_DIV_FLAGS(8, 2, CLK_DIVIDER_POWER_OF_TWO),\n\n\t.mux\t\t= {\n\t\t.shift\t= 24,\n\t\t.width\t= 2,\n\n\t\t.var_predivs\t= ar100_r_apb2_predivs,\n\t\t.n_var_predivs\t= ARRAY_SIZE(ar100_r_apb2_predivs),\n\t},\n\n\t.common\t\t= {\n\t\t.reg\t\t= 0x010,\n\t\t.features\t= CCU_FEATURE_VARIABLE_PREDIV,\n\t\t.hw.init\t= CLK_HW_INIT_PARENTS(\"r-apb2\",\n\t\t\t\t\t\t      ar100_r_apb2_parents,\n\t\t\t\t\t\t      &ccu_div_ops,\n\t\t\t\t\t\t      0),\n\t},\n};\n\n \nstatic SUNXI_CCU_GATE(r_apb1_timer_clk,\t\"r-apb1-timer\",\t\"r-apb1\",\n\t\t      0x11c, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb1_twd_clk,\t\"r-apb1-twd\",\t\"r-apb1\",\n\t\t      0x12c, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb1_pwm_clk,\t\"r-apb1-pwm\",\t\"r-apb1\",\n\t\t      0x13c, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb2_uart_clk,\t\"r-apb2-uart\",\t\"r-apb2\",\n\t\t      0x18c, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb2_i2c_clk,\t\"r-apb2-i2c\",\t\"r-apb2\",\n\t\t      0x19c, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb2_rsb_clk,\t\"r-apb2-rsb\",\t\"r-apb2\",\n\t\t      0x1bc, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb1_ir_clk,\t\"r-apb1-ir\",\t\"r-apb1\",\n\t\t      0x1cc, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb1_w1_clk,\t\"r-apb1-w1\",\t\"r-apb1\",\n\t\t      0x1ec, BIT(0), 0);\nstatic SUNXI_CCU_GATE(r_apb1_rtc_clk,\t\"r-apb1-rtc\",\t\"r-apb1\",\n\t\t      0x20c, BIT(0), CLK_IGNORE_UNUSED);\n\n \nstatic const char * const r_mod0_default_parents[] = { \"osc32k\", \"osc24M\" };\nstatic SUNXI_CCU_MP_WITH_MUX_GATE(ir_clk, \"ir\",\n\t\t\t\t  r_mod0_default_parents, 0x1c0,\n\t\t\t\t  0, 5,\t\t \n\t\t\t\t  8, 2,\t\t \n\t\t\t\t  24, 1,\t \n\t\t\t\t  BIT(31),\t \n\t\t\t\t  0);\n\n \n\nstatic SUNXI_CCU_MP_WITH_MUX_GATE(w1_clk, \"w1\",\n\t\t\t\t  r_mod0_default_parents, 0x1e0,\n\t\t\t\t  0, 5,\t\t \n\t\t\t\t  8, 2,\t\t \n\t\t\t\t  24, 1,\t \n\t\t\t\t  BIT(31),\t \n\t\t\t\t  0);\n\nstatic struct ccu_common *sun50i_h6_r_ccu_clks[] = {\n\t&ar100_clk.common,\n\t&r_apb1_clk.common,\n\t&r_apb2_clk.common,\n\t&r_apb1_timer_clk.common,\n\t&r_apb1_twd_clk.common,\n\t&r_apb1_pwm_clk.common,\n\t&r_apb2_uart_clk.common,\n\t&r_apb2_i2c_clk.common,\n\t&r_apb2_rsb_clk.common,\n\t&r_apb1_ir_clk.common,\n\t&r_apb1_w1_clk.common,\n\t&r_apb1_rtc_clk.common,\n\t&ir_clk.common,\n\t&w1_clk.common,\n};\n\nstatic struct clk_hw_onecell_data sun50i_h6_r_hw_clks = {\n\t.hws\t= {\n\t\t[CLK_AR100]\t\t= &ar100_clk.common.hw,\n\t\t[CLK_R_AHB]\t\t= &r_ahb_clk.hw,\n\t\t[CLK_R_APB1]\t\t= &r_apb1_clk.common.hw,\n\t\t[CLK_R_APB2]\t\t= &r_apb2_clk.common.hw,\n\t\t[CLK_R_APB1_TIMER]\t= &r_apb1_timer_clk.common.hw,\n\t\t[CLK_R_APB1_TWD]\t= &r_apb1_twd_clk.common.hw,\n\t\t[CLK_R_APB1_PWM]\t= &r_apb1_pwm_clk.common.hw,\n\t\t[CLK_R_APB2_UART]\t= &r_apb2_uart_clk.common.hw,\n\t\t[CLK_R_APB2_I2C]\t= &r_apb2_i2c_clk.common.hw,\n\t\t[CLK_R_APB2_RSB]\t= &r_apb2_rsb_clk.common.hw,\n\t\t[CLK_R_APB1_IR]\t\t= &r_apb1_ir_clk.common.hw,\n\t\t[CLK_R_APB1_W1]\t\t= &r_apb1_w1_clk.common.hw,\n\t\t[CLK_R_APB1_RTC]\t= &r_apb1_rtc_clk.common.hw,\n\t\t[CLK_IR]\t\t= &ir_clk.common.hw,\n\t\t[CLK_W1]\t\t= &w1_clk.common.hw,\n\t},\n\t.num\t= CLK_NUMBER,\n};\n\nstatic struct clk_hw_onecell_data sun50i_h616_r_hw_clks = {\n\t.hws\t= {\n\t\t[CLK_R_AHB]\t\t= &r_ahb_clk.hw,\n\t\t[CLK_R_APB1]\t\t= &r_apb1_clk.common.hw,\n\t\t[CLK_R_APB2]\t\t= &r_apb2_clk.common.hw,\n\t\t[CLK_R_APB1_TWD]\t= &r_apb1_twd_clk.common.hw,\n\t\t[CLK_R_APB2_I2C]\t= &r_apb2_i2c_clk.common.hw,\n\t\t[CLK_R_APB2_RSB]\t= &r_apb2_rsb_clk.common.hw,\n\t\t[CLK_R_APB1_IR]\t\t= &r_apb1_ir_clk.common.hw,\n\t\t[CLK_R_APB1_RTC]\t= &r_apb1_rtc_clk.common.hw,\n\t\t[CLK_IR]\t\t= &ir_clk.common.hw,\n\t},\n\t.num\t= CLK_NUMBER,\n};\n\nstatic struct ccu_reset_map sun50i_h6_r_ccu_resets[] = {\n\t[RST_R_APB1_TIMER]\t=  { 0x11c, BIT(16) },\n\t[RST_R_APB1_TWD]\t=  { 0x12c, BIT(16) },\n\t[RST_R_APB1_PWM]\t=  { 0x13c, BIT(16) },\n\t[RST_R_APB2_UART]\t=  { 0x18c, BIT(16) },\n\t[RST_R_APB2_I2C]\t=  { 0x19c, BIT(16) },\n\t[RST_R_APB2_RSB]\t=  { 0x1bc, BIT(16) },\n\t[RST_R_APB1_IR]\t\t=  { 0x1cc, BIT(16) },\n\t[RST_R_APB1_W1]\t\t=  { 0x1ec, BIT(16) },\n};\n\nstatic struct ccu_reset_map sun50i_h616_r_ccu_resets[] = {\n\t[RST_R_APB1_TWD]\t=  { 0x12c, BIT(16) },\n\t[RST_R_APB2_I2C]\t=  { 0x19c, BIT(16) },\n\t[RST_R_APB2_RSB]\t=  { 0x1bc, BIT(16) },\n\t[RST_R_APB1_IR]\t\t=  { 0x1cc, BIT(16) },\n};\n\nstatic const struct sunxi_ccu_desc sun50i_h6_r_ccu_desc = {\n\t.ccu_clks\t= sun50i_h6_r_ccu_clks,\n\t.num_ccu_clks\t= ARRAY_SIZE(sun50i_h6_r_ccu_clks),\n\n\t.hw_clks\t= &sun50i_h6_r_hw_clks,\n\n\t.resets\t\t= sun50i_h6_r_ccu_resets,\n\t.num_resets\t= ARRAY_SIZE(sun50i_h6_r_ccu_resets),\n};\n\nstatic const struct sunxi_ccu_desc sun50i_h616_r_ccu_desc = {\n\t.ccu_clks\t= sun50i_h6_r_ccu_clks,\n\t.num_ccu_clks\t= ARRAY_SIZE(sun50i_h6_r_ccu_clks),\n\n\t.hw_clks\t= &sun50i_h616_r_hw_clks,\n\n\t.resets\t\t= sun50i_h616_r_ccu_resets,\n\t.num_resets\t= ARRAY_SIZE(sun50i_h616_r_ccu_resets),\n};\n\nstatic int sun50i_h6_r_ccu_probe(struct platform_device *pdev)\n{\n\tconst struct sunxi_ccu_desc *desc;\n\tvoid __iomem *reg;\n\n\tdesc = of_device_get_match_data(&pdev->dev);\n\tif (!desc)\n\t\treturn -EINVAL;\n\n\treg = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(reg))\n\t\treturn PTR_ERR(reg);\n\n\treturn devm_sunxi_ccu_probe(&pdev->dev, reg, desc);\n}\n\nstatic const struct of_device_id sun50i_h6_r_ccu_ids[] = {\n\t{\n\t\t.compatible = \"allwinner,sun50i-h6-r-ccu\",\n\t\t.data = &sun50i_h6_r_ccu_desc,\n\t},\n\t{\n\t\t.compatible = \"allwinner,sun50i-h616-r-ccu\",\n\t\t.data = &sun50i_h616_r_ccu_desc,\n\t},\n\t{ }\n};\n\nstatic struct platform_driver sun50i_h6_r_ccu_driver = {\n\t.probe\t= sun50i_h6_r_ccu_probe,\n\t.driver\t= {\n\t\t.name\t\t\t= \"sun50i-h6-r-ccu\",\n\t\t.suppress_bind_attrs\t= true,\n\t\t.of_match_table\t\t= sun50i_h6_r_ccu_ids,\n\t},\n};\nmodule_platform_driver(sun50i_h6_r_ccu_driver);\n\nMODULE_IMPORT_NS(SUNXI_CCU);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}