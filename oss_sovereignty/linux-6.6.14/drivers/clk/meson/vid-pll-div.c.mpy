{
  "module_name": "vid-pll-div.c",
  "hash_id": "b3d20d1bd62cf2645bfe46a7b14e545423e5fa095cd092950ac52f057cd70962",
  "original_prompt": "Ingested from linux-6.6.14/drivers/clk/meson/vid-pll-div.c",
  "human_readable_source": "\n \n\n#include <linux/clk-provider.h>\n#include <linux/module.h>\n\n#include \"clk-regmap.h\"\n#include \"vid-pll-div.h\"\n\nstatic inline struct meson_vid_pll_div_data *\nmeson_vid_pll_div_data(struct clk_regmap *clk)\n{\n\treturn (struct meson_vid_pll_div_data *)clk->data;\n}\n\n \n\nstruct vid_pll_div {\n\tunsigned int shift_val;\n\tunsigned int shift_sel;\n\tunsigned int divider;\n\tunsigned int multiplier;\n};\n\n#define VID_PLL_DIV(_val, _sel, _ft, _fb)\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\t\\\n\t\t.shift_val = (_val),\t\t\t\t\t\\\n\t\t.shift_sel = (_sel),\t\t\t\t\t\\\n\t\t.divider = (_ft),\t\t\t\t\t\\\n\t\t.multiplier = (_fb),\t\t\t\t\t\\\n\t}\n\nstatic const struct vid_pll_div vid_pll_div_table[] = {\n\tVID_PLL_DIV(0x0aaa, 0, 2, 1),\t \n\tVID_PLL_DIV(0x5294, 2, 5, 2),\t \n\tVID_PLL_DIV(0x0db6, 0, 3, 1),\t \n\tVID_PLL_DIV(0x36cc, 1, 7, 2),\t \n\tVID_PLL_DIV(0x6666, 2, 15, 4),\t \n\tVID_PLL_DIV(0x0ccc, 0, 4, 1),\t \n\tVID_PLL_DIV(0x739c, 2, 5, 1),\t \n\tVID_PLL_DIV(0x0e38, 0, 6, 1),\t \n\tVID_PLL_DIV(0x0000, 3, 25, 4),\t \n\tVID_PLL_DIV(0x3c78, 1, 7, 1),\t \n\tVID_PLL_DIV(0x78f0, 2, 15, 2),\t \n\tVID_PLL_DIV(0x0fc0, 0, 12, 1),\t \n\tVID_PLL_DIV(0x3f80, 1, 14, 1),\t \n\tVID_PLL_DIV(0x7f80, 2, 15, 1),\t \n};\n\n#define to_meson_vid_pll_div(_hw) \\\n\tcontainer_of(_hw, struct meson_vid_pll_div, hw)\n\nstatic const struct vid_pll_div *_get_table_val(unsigned int shift_val,\n\t\t\t\t\t\tunsigned int shift_sel)\n{\n\tint i;\n\n\tfor (i = 0 ; i < ARRAY_SIZE(vid_pll_div_table) ; ++i) {\n\t\tif (vid_pll_div_table[i].shift_val == shift_val &&\n\t\t    vid_pll_div_table[i].shift_sel == shift_sel)\n\t\t\treturn &vid_pll_div_table[i];\n\t}\n\n\treturn NULL;\n}\n\nstatic unsigned long meson_vid_pll_div_recalc_rate(struct clk_hw *hw,\n\t\t\t\t\t\t   unsigned long parent_rate)\n{\n\tstruct clk_regmap *clk = to_clk_regmap(hw);\n\tstruct meson_vid_pll_div_data *pll_div = meson_vid_pll_div_data(clk);\n\tconst struct vid_pll_div *div;\n\n\tdiv = _get_table_val(meson_parm_read(clk->map, &pll_div->val),\n\t\t\t     meson_parm_read(clk->map, &pll_div->sel));\n\tif (!div || !div->divider) {\n\t\tpr_debug(\"%s: Invalid config value for vid_pll_div\\n\", __func__);\n\t\treturn 0;\n\t}\n\n\treturn DIV_ROUND_UP_ULL(parent_rate * div->multiplier, div->divider);\n}\n\nconst struct clk_ops meson_vid_pll_div_ro_ops = {\n\t.recalc_rate\t= meson_vid_pll_div_recalc_rate,\n};\nEXPORT_SYMBOL_GPL(meson_vid_pll_div_ro_ops);\n\nMODULE_DESCRIPTION(\"Amlogic video pll divider driver\");\nMODULE_AUTHOR(\"Neil Armstrong <narmstrong@baylibre.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}