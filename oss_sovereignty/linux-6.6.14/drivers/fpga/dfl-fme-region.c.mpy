{
  "module_name": "dfl-fme-region.c",
  "hash_id": "a48297929622c769a11fd612335b62ae883cbccafc0c5e4e67c12275a6453ac5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/fpga/dfl-fme-region.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/fpga/fpga-mgr.h>\n#include <linux/fpga/fpga-region.h>\n\n#include \"dfl-fme-pr.h\"\n\nstatic int fme_region_get_bridges(struct fpga_region *region)\n{\n\tstruct dfl_fme_region_pdata *pdata = region->priv;\n\tstruct device *dev = &pdata->br->dev;\n\n\treturn fpga_bridge_get_to_list(dev, region->info, &region->bridge_list);\n}\n\nstatic int fme_region_probe(struct platform_device *pdev)\n{\n\tstruct dfl_fme_region_pdata *pdata = dev_get_platdata(&pdev->dev);\n\tstruct fpga_region_info info = { 0 };\n\tstruct device *dev = &pdev->dev;\n\tstruct fpga_region *region;\n\tstruct fpga_manager *mgr;\n\tint ret;\n\n\tmgr = fpga_mgr_get(&pdata->mgr->dev);\n\tif (IS_ERR(mgr))\n\t\treturn -EPROBE_DEFER;\n\n\tinfo.mgr = mgr;\n\tinfo.compat_id = mgr->compat_id;\n\tinfo.get_bridges = fme_region_get_bridges;\n\tinfo.priv = pdata;\n\tregion = fpga_region_register_full(dev, &info);\n\tif (IS_ERR(region)) {\n\t\tret = PTR_ERR(region);\n\t\tgoto eprobe_mgr_put;\n\t}\n\n\tplatform_set_drvdata(pdev, region);\n\n\tdev_dbg(dev, \"DFL FME FPGA Region probed\\n\");\n\n\treturn 0;\n\neprobe_mgr_put:\n\tfpga_mgr_put(mgr);\n\treturn ret;\n}\n\nstatic int fme_region_remove(struct platform_device *pdev)\n{\n\tstruct fpga_region *region = platform_get_drvdata(pdev);\n\tstruct fpga_manager *mgr = region->mgr;\n\n\tfpga_region_unregister(region);\n\tfpga_mgr_put(mgr);\n\n\treturn 0;\n}\n\nstatic struct platform_driver fme_region_driver = {\n\t.driver\t= {\n\t\t.name    = DFL_FPGA_FME_REGION,\n\t},\n\t.probe   = fme_region_probe,\n\t.remove  = fme_region_remove,\n};\n\nmodule_platform_driver(fme_region_driver);\n\nMODULE_DESCRIPTION(\"FPGA Region for DFL FPGA Management Engine\");\nMODULE_AUTHOR(\"Intel Corporation\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_ALIAS(\"platform:dfl-fme-region\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}