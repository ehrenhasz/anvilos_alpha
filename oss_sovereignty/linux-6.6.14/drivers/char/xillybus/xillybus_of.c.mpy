{
  "module_name": "xillybus_of.c",
  "hash_id": "70812a7fefb2dccdb45313550e7aa604063e43f75b9898f095d8676522404f51",
  "original_prompt": "Ingested from linux-6.6.14/drivers/char/xillybus/xillybus_of.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/device.h>\n#include <linux/slab.h>\n#include <linux/platform_device.h>\n#include <linux/of.h>\n#include <linux/err.h>\n#include \"xillybus.h\"\n\nMODULE_DESCRIPTION(\"Xillybus driver for Open Firmware\");\nMODULE_AUTHOR(\"Eli Billauer, Xillybus Ltd.\");\nMODULE_ALIAS(\"xillybus_of\");\nMODULE_LICENSE(\"GPL v2\");\n\nstatic const char xillyname[] = \"xillybus_of\";\n\n \nstatic const struct of_device_id xillybus_of_match[] = {\n\t{ .compatible = \"xillybus,xillybus-1.00.a\", },\n\t{ .compatible = \"xlnx,xillybus-1.00.a\", },  \n\t{}\n};\n\nMODULE_DEVICE_TABLE(of, xillybus_of_match);\n\nstatic int xilly_drv_probe(struct platform_device *op)\n{\n\tstruct device *dev = &op->dev;\n\tstruct xilly_endpoint *endpoint;\n\tint rc;\n\tint irq;\n\n\tendpoint = xillybus_init_endpoint(dev);\n\n\tif (!endpoint)\n\t\treturn -ENOMEM;\n\n\tdev_set_drvdata(dev, endpoint);\n\n\tendpoint->owner = THIS_MODULE;\n\n\tendpoint->registers = devm_platform_ioremap_resource(op, 0);\n\tif (IS_ERR(endpoint->registers))\n\t\treturn PTR_ERR(endpoint->registers);\n\n\tirq = platform_get_irq(op, 0);\n\n\trc = devm_request_irq(dev, irq, xillybus_isr, 0, xillyname, endpoint);\n\n\tif (rc) {\n\t\tdev_err(endpoint->dev,\n\t\t\t\"Failed to register IRQ handler. Aborting.\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\treturn xillybus_endpoint_discovery(endpoint);\n}\n\nstatic int xilly_drv_remove(struct platform_device *op)\n{\n\tstruct device *dev = &op->dev;\n\tstruct xilly_endpoint *endpoint = dev_get_drvdata(dev);\n\n\txillybus_endpoint_remove(endpoint);\n\n\treturn 0;\n}\n\nstatic struct platform_driver xillybus_platform_driver = {\n\t.probe = xilly_drv_probe,\n\t.remove = xilly_drv_remove,\n\t.driver = {\n\t\t.name = xillyname,\n\t\t.of_match_table = xillybus_of_match,\n\t},\n};\n\nmodule_platform_driver(xillybus_platform_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}