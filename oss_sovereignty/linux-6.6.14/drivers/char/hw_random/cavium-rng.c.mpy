{
  "module_name": "cavium-rng.c",
  "hash_id": "8189ac60e94882cfd371c617d4120b45c4b401946de4550e3db80b0dc0268972",
  "original_prompt": "Ingested from linux-6.6.14/drivers/char/hw_random/cavium-rng.c",
  "human_readable_source": "\n \n\n#include <linux/hw_random.h>\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/pci.h>\n#include <linux/pci_ids.h>\n\n#define THUNDERX_RNM_ENT_EN     0x1\n#define THUNDERX_RNM_RNG_EN     0x2\n\nstruct cavium_rng_pf {\n\tvoid __iomem *control_status;\n};\n\n \nstatic int cavium_rng_probe(struct pci_dev *pdev,\n\t\t\tconst struct pci_device_id *id)\n{\n\tstruct\tcavium_rng_pf *rng;\n\tint\tiov_err;\n\n\trng = devm_kzalloc(&pdev->dev, sizeof(*rng), GFP_KERNEL);\n\tif (!rng)\n\t\treturn -ENOMEM;\n\n\t \n\trng->control_status = pcim_iomap(pdev, 0, 0);\n\tif (!rng->control_status) {\n\t\tdev_err(&pdev->dev,\n\t\t\t\"Error iomap failed retrieving control_status.\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\t \n\twriteq(THUNDERX_RNM_RNG_EN | THUNDERX_RNM_ENT_EN,\n\t\trng->control_status);\n\n\tpci_set_drvdata(pdev, rng);\n\n\t \n\tiov_err = pci_enable_sriov(pdev, 1);\n\tif (iov_err != 0) {\n\t\t \n\t\twriteq(0, rng->control_status);\n\t\tdev_err(&pdev->dev,\n\t\t\t\"Error initializing RNG virtual function,(%i).\\n\",\n\t\t\tiov_err);\n\t\treturn iov_err;\n\t}\n\n\treturn 0;\n}\n\n \nstatic void cavium_rng_remove(struct pci_dev *pdev)\n{\n\tstruct cavium_rng_pf *rng;\n\n\trng = pci_get_drvdata(pdev);\n\n\t \n\tpci_disable_sriov(pdev);\n\n\t \n\twriteq(0, rng->control_status);\n}\n\nstatic const struct pci_device_id cavium_rng_pf_id_table[] = {\n\t{ PCI_DEVICE(PCI_VENDOR_ID_CAVIUM, 0xa018), 0, 0, 0},  \n\t{0,},\n};\n\nMODULE_DEVICE_TABLE(pci, cavium_rng_pf_id_table);\n\nstatic struct pci_driver cavium_rng_pf_driver = {\n\t.name\t\t= \"cavium_rng_pf\",\n\t.id_table\t= cavium_rng_pf_id_table,\n\t.probe\t\t= cavium_rng_probe,\n\t.remove\t\t= cavium_rng_remove,\n};\n\nmodule_pci_driver(cavium_rng_pf_driver);\nMODULE_AUTHOR(\"Omer Khaliq <okhaliq@caviumnetworks.com>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}