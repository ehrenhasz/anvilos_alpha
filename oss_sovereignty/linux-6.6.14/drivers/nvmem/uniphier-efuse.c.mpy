{
  "module_name": "uniphier-efuse.c",
  "hash_id": "1b7cea8bddf9bab7d9d8b049d59155e7a8457588f68947d4dd5c2e5eb110e852",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nvmem/uniphier-efuse.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/nvmem-provider.h>\n#include <linux/platform_device.h>\n\nstruct uniphier_efuse_priv {\n\tvoid __iomem *base;\n};\n\nstatic int uniphier_reg_read(void *context,\n\t\t\t     unsigned int reg, void *_val, size_t bytes)\n{\n\tstruct uniphier_efuse_priv *priv = context;\n\tu8 *val = _val;\n\tint offs;\n\n\tfor (offs = 0; offs < bytes; offs += sizeof(u8))\n\t\t*val++ = readb(priv->base + reg + offs);\n\n\treturn 0;\n}\n\nstatic int uniphier_efuse_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct resource *res;\n\tstruct nvmem_device *nvmem;\n\tstruct nvmem_config econfig = {};\n\tstruct uniphier_efuse_priv *priv;\n\n\tpriv = devm_kzalloc(dev, sizeof(*priv), GFP_KERNEL);\n\tif (!priv)\n\t\treturn -ENOMEM;\n\n\tpriv->base = devm_platform_get_and_ioremap_resource(pdev, 0, &res);\n\tif (IS_ERR(priv->base))\n\t\treturn PTR_ERR(priv->base);\n\n\teconfig.stride = 1;\n\teconfig.word_size = 1;\n\teconfig.read_only = true;\n\teconfig.reg_read = uniphier_reg_read;\n\teconfig.size = resource_size(res);\n\teconfig.priv = priv;\n\teconfig.dev = dev;\n\tnvmem = devm_nvmem_register(dev, &econfig);\n\n\treturn PTR_ERR_OR_ZERO(nvmem);\n}\n\nstatic const struct of_device_id uniphier_efuse_of_match[] = {\n\t{ .compatible = \"socionext,uniphier-efuse\",},\n\t{ },\n};\nMODULE_DEVICE_TABLE(of, uniphier_efuse_of_match);\n\nstatic struct platform_driver uniphier_efuse_driver = {\n\t.probe = uniphier_efuse_probe,\n\t.driver = {\n\t\t.name = \"uniphier-efuse\",\n\t\t.of_match_table = uniphier_efuse_of_match,\n\t},\n};\nmodule_platform_driver(uniphier_efuse_driver);\n\nMODULE_AUTHOR(\"Keiji Hayashibara <hayashibara.keiji@socionext.com>\");\nMODULE_DESCRIPTION(\"UniPhier eFuse driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}