{
  "module_name": "gpio-ts4800.c",
  "hash_id": "05c1c3d1a1e814a85fb0257ce3fa236c5be16cec84d59e0540ec9f08058d6d67",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpio/gpio-ts4800.c",
  "human_readable_source": "\n \n\n#include <linux/gpio/driver.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n\n#define DEFAULT_PIN_NUMBER      16\n#define INPUT_REG_OFFSET        0x00\n#define OUTPUT_REG_OFFSET       0x02\n#define DIRECTION_REG_OFFSET    0x04\n\nstatic int ts4800_gpio_probe(struct platform_device *pdev)\n{\n\tstruct device_node *node;\n\tstruct gpio_chip *chip;\n\tvoid __iomem *base_addr;\n\tint retval;\n\tu32 ngpios;\n\n\tchip = devm_kzalloc(&pdev->dev, sizeof(struct gpio_chip), GFP_KERNEL);\n\tif (!chip)\n\t\treturn -ENOMEM;\n\n\tbase_addr = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(base_addr))\n\t\treturn PTR_ERR(base_addr);\n\n\tnode = pdev->dev.of_node;\n\tif (!node)\n\t\treturn -EINVAL;\n\n\tretval = of_property_read_u32(node, \"ngpios\", &ngpios);\n\tif (retval == -EINVAL)\n\t\tngpios = DEFAULT_PIN_NUMBER;\n\telse if (retval)\n\t\treturn retval;\n\n\tretval = bgpio_init(chip, &pdev->dev, 2, base_addr + INPUT_REG_OFFSET,\n\t\t\t    base_addr + OUTPUT_REG_OFFSET, NULL,\n\t\t\t    base_addr + DIRECTION_REG_OFFSET, NULL, 0);\n\tif (retval) {\n\t\tdev_err(&pdev->dev, \"bgpio_init failed\\n\");\n\t\treturn retval;\n\t}\n\n\tchip->ngpio = ngpios;\n\n\tplatform_set_drvdata(pdev, chip);\n\n\treturn devm_gpiochip_add_data(&pdev->dev, chip, NULL);\n}\n\nstatic const struct of_device_id ts4800_gpio_of_match[] = {\n\t{ .compatible = \"technologic,ts4800-gpio\", },\n\t{},\n};\nMODULE_DEVICE_TABLE(of, ts4800_gpio_of_match);\n\nstatic struct platform_driver ts4800_gpio_driver = {\n\t.driver = {\n\t\t   .name = \"ts4800-gpio\",\n\t\t   .of_match_table = ts4800_gpio_of_match,\n\t\t   },\n\t.probe = ts4800_gpio_probe,\n};\n\nmodule_platform_driver_probe(ts4800_gpio_driver, ts4800_gpio_probe);\n\nMODULE_AUTHOR(\"Julien Grossholtz <julien.grossholtz@savoirfairelinux.com>\");\nMODULE_DESCRIPTION(\"TS4800 FPGA GPIO driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}