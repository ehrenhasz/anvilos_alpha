{
  "module_name": "gpiolib-legacy.c",
  "hash_id": "ea6adee79759f7fdddca96c05a9f9921d258296cf68fe4e073cee9735d914ee3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpio/gpiolib-legacy.c",
  "human_readable_source": "\n#include <linux/gpio/consumer.h>\n#include <linux/gpio/driver.h>\n\n#include <linux/gpio.h>\n\n#include \"gpiolib.h\"\n\nvoid gpio_free(unsigned gpio)\n{\n\tgpiod_free(gpio_to_desc(gpio));\n}\nEXPORT_SYMBOL_GPL(gpio_free);\n\n \nint gpio_request_one(unsigned gpio, unsigned long flags, const char *label)\n{\n\tstruct gpio_desc *desc;\n\tint err;\n\n\tdesc = gpio_to_desc(gpio);\n\n\t \n\tif (!desc && gpio_is_valid(gpio))\n\t\treturn -EPROBE_DEFER;\n\n\terr = gpiod_request(desc, label);\n\tif (err)\n\t\treturn err;\n\n\tif (flags & GPIOF_ACTIVE_LOW)\n\t\tset_bit(FLAG_ACTIVE_LOW, &desc->flags);\n\n\tif (flags & GPIOF_DIR_IN)\n\t\terr = gpiod_direction_input(desc);\n\telse\n\t\terr = gpiod_direction_output_raw(desc,\n\t\t\t\t(flags & GPIOF_INIT_HIGH) ? 1 : 0);\n\n\tif (err)\n\t\tgoto free_gpio;\n\n\treturn 0;\n\n free_gpio:\n\tgpiod_free(desc);\n\treturn err;\n}\nEXPORT_SYMBOL_GPL(gpio_request_one);\n\nint gpio_request(unsigned gpio, const char *label)\n{\n\tstruct gpio_desc *desc = gpio_to_desc(gpio);\n\n\t \n\tif (!desc && gpio_is_valid(gpio))\n\t\treturn -EPROBE_DEFER;\n\n\treturn gpiod_request(desc, label);\n}\nEXPORT_SYMBOL_GPL(gpio_request);\n\n \nint gpio_request_array(const struct gpio *array, size_t num)\n{\n\tint i, err;\n\n\tfor (i = 0; i < num; i++, array++) {\n\t\terr = gpio_request_one(array->gpio, array->flags, array->label);\n\t\tif (err)\n\t\t\tgoto err_free;\n\t}\n\treturn 0;\n\nerr_free:\n\twhile (i--)\n\t\tgpio_free((--array)->gpio);\n\treturn err;\n}\nEXPORT_SYMBOL_GPL(gpio_request_array);\n\n \nvoid gpio_free_array(const struct gpio *array, size_t num)\n{\n\twhile (num--)\n\t\tgpio_free((array++)->gpio);\n}\nEXPORT_SYMBOL_GPL(gpio_free_array);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}