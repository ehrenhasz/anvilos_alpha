{
  "module_name": "gpio-ge.c",
  "hash_id": "0cb7b519c0a9775c735550ca84b95dd3afebc3bdf53dbd13916dc5b2f4ba6881",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpio/gpio-ge.c",
  "human_readable_source": "\n \n\n \n\n#include <linux/gpio/driver.h>\n#include <linux/io.h>\n#include <linux/kernel.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n#include <linux/property.h>\n#include <linux/slab.h>\n\n#define GEF_GPIO_DIRECT\t\t0x00\n#define GEF_GPIO_IN\t\t0x04\n#define GEF_GPIO_OUT\t\t0x08\n#define GEF_GPIO_TRIG\t\t0x0C\n#define GEF_GPIO_POLAR_A\t0x10\n#define GEF_GPIO_POLAR_B\t0x14\n#define GEF_GPIO_INT_STAT\t0x18\n#define GEF_GPIO_OVERRUN\t0x1C\n#define GEF_GPIO_MODE\t\t0x20\n\nstatic const struct of_device_id gef_gpio_ids[] = {\n\t{\n\t\t.compatible\t= \"gef,sbc610-gpio\",\n\t\t.data\t\t= (void *)19,\n\t}, {\n\t\t.compatible\t= \"gef,sbc310-gpio\",\n\t\t.data\t\t= (void *)6,\n\t}, {\n\t\t.compatible\t= \"ge,imp3a-gpio\",\n\t\t.data\t\t= (void *)16,\n\t},\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, gef_gpio_ids);\n\nstatic int __init gef_gpio_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tstruct gpio_chip *gc;\n\tvoid __iomem *regs;\n\tint ret;\n\n\tgc = devm_kzalloc(dev, sizeof(*gc), GFP_KERNEL);\n\tif (!gc)\n\t\treturn -ENOMEM;\n\n\tregs = devm_platform_ioremap_resource(pdev, 0);\n\tif (IS_ERR(regs))\n\t\treturn PTR_ERR(regs);\n\n\tret = bgpio_init(gc, dev, 4, regs + GEF_GPIO_IN, regs + GEF_GPIO_OUT,\n\t\t\t NULL, NULL, regs + GEF_GPIO_DIRECT,\n\t\t\t BGPIOF_BIG_ENDIAN_BYTE_ORDER);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"bgpio_init failed\\n\");\n\n\t \n\tgc->label = devm_kasprintf(dev, GFP_KERNEL, \"%pfw\", dev_fwnode(dev));\n\tif (!gc->label)\n\t\treturn -ENOMEM;\n\n\tgc->base = -1;\n\tgc->ngpio = (uintptr_t)device_get_match_data(dev);\n\n\t \n\tret = devm_gpiochip_add_data(dev, gc, NULL);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"GPIO chip registration failed\\n\");\n\n\treturn 0;\n};\n\nstatic struct platform_driver gef_gpio_driver = {\n\t.driver = {\n\t\t.name\t\t= \"gef-gpio\",\n\t\t.of_match_table\t= gef_gpio_ids,\n\t},\n};\nmodule_platform_driver_probe(gef_gpio_driver, gef_gpio_probe);\n\nMODULE_DESCRIPTION(\"GE I/O FPGA GPIO driver\");\nMODULE_AUTHOR(\"Martyn Welch <martyn.welch@ge.com>\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}