{
  "module_name": "rmobile-reset.c",
  "hash_id": "e47da93083df90621e4e890b311c21a6cb20f47f38d2a4aea972a3ff751c3e22",
  "original_prompt": "Ingested from linux-6.6.14/drivers/power/reset/rmobile-reset.c",
  "human_readable_source": "\n \n\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/of_address.h>\n#include <linux/platform_device.h>\n#include <linux/printk.h>\n#include <linux/reboot.h>\n\n \n#define RESCNT2\t\t0x20\t\t \n\n \n#define RESCNT2_PRES\t0x80000000\t \n\nstatic void __iomem *sysc_base2;\n\nstatic int rmobile_reset_handler(struct notifier_block *this,\n\t\t\t\t unsigned long mode, void *cmd)\n{\n\tpr_debug(\"%s %lu\\n\", __func__, mode);\n\n\t \n\twritel(RESCNT2_PRES, sysc_base2 + RESCNT2);\n\n\treturn NOTIFY_DONE;\n}\n\nstatic struct notifier_block rmobile_reset_nb = {\n\t.notifier_call = rmobile_reset_handler,\n\t.priority = 192,\n};\n\nstatic int rmobile_reset_probe(struct platform_device *pdev)\n{\n\tint error;\n\n\tsysc_base2 = of_iomap(pdev->dev.of_node, 1);\n\tif (!sysc_base2)\n\t\treturn -ENODEV;\n\n\terror = register_restart_handler(&rmobile_reset_nb);\n\tif (error) {\n\t\tdev_err(&pdev->dev,\n\t\t\t\"cannot register restart handler (err=%d)\\n\", error);\n\t\tgoto fail_unmap;\n\t}\n\n\treturn 0;\n\nfail_unmap:\n\tiounmap(sysc_base2);\n\treturn error;\n}\n\nstatic int rmobile_reset_remove(struct platform_device *pdev)\n{\n\tunregister_restart_handler(&rmobile_reset_nb);\n\tiounmap(sysc_base2);\n\treturn 0;\n}\n\nstatic const struct of_device_id rmobile_reset_of_match[] = {\n\t{ .compatible = \"renesas,sysc-rmobile\", },\n\t{   }\n};\nMODULE_DEVICE_TABLE(of, rmobile_reset_of_match);\n\nstatic struct platform_driver rmobile_reset_driver = {\n\t.probe = rmobile_reset_probe,\n\t.remove = rmobile_reset_remove,\n\t.driver = {\n\t\t.name = \"rmobile_reset\",\n\t\t.of_match_table = rmobile_reset_of_match,\n\t},\n};\n\nmodule_platform_driver(rmobile_reset_driver);\n\nMODULE_DESCRIPTION(\"Renesas R-Mobile Reset Driver\");\nMODULE_AUTHOR(\"Geert Uytterhoeven <geert+renesas@glider.be>\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}