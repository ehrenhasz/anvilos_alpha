{
  "module_name": "amdtee_private.h",
  "hash_id": "51900d55f496f1ff3c8d4dfe85adc79e8429ddd1400ce99a17131656263ce693",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tee/amdtee/amdtee_private.h",
  "human_readable_source": " \n\n \n\n#ifndef AMDTEE_PRIVATE_H\n#define AMDTEE_PRIVATE_H\n\n#include <linux/mutex.h>\n#include <linux/spinlock.h>\n#include <linux/tee_drv.h>\n#include <linux/kref.h>\n#include <linux/types.h>\n#include \"amdtee_if.h\"\n\n#define DRIVER_NAME\t\"amdtee\"\n#define DRIVER_AUTHOR   \"AMD-TEE Linux driver team\"\n\n \n#define TEEC_SUCCESS\t\t\t0x00000000\n#define TEEC_ERROR_GENERIC\t\t0xFFFF0000\n#define TEEC_ERROR_BAD_PARAMETERS\t0xFFFF0006\n#define TEEC_ERROR_OUT_OF_MEMORY\t0xFFFF000C\n#define TEEC_ERROR_COMMUNICATION\t0xFFFF000E\n\n#define TEEC_ORIGIN_COMMS\t\t0x00000002\n\n \n#define TEE_NUM_SESSIONS\t\t\t32\n\n#define TA_LOAD_PATH\t\t\t\t\"/amdtee\"\n#define TA_PATH_MAX\t\t\t\t60\n\n \nstruct amdtee {\n\tstruct tee_device *teedev;\n\tstruct tee_shm_pool *pool;\n};\n\n \nstruct amdtee_session {\n\tstruct list_head list_node;\n\tu32 ta_handle;\n\tstruct kref refcount;\n\tu32 session_info[TEE_NUM_SESSIONS];\n\tDECLARE_BITMAP(sess_mask, TEE_NUM_SESSIONS);\n\tspinlock_t lock;\t \n};\n\n \nstruct amdtee_context_data {\n\tstruct list_head sess_list;\n\tstruct list_head shm_list;\n\tstruct mutex shm_mutex;    \n};\n\nstruct amdtee_driver_data {\n\tstruct amdtee *amdtee;\n};\n\nstruct shmem_desc {\n\tvoid *kaddr;\n\tu64 size;\n};\n\n \nstruct amdtee_shm_data {\n\tstruct  list_head shm_node;\n\tvoid    *kaddr;\n\tu32     buf_id;\n};\n\n \nstruct amdtee_ta_data {\n\tstruct list_head list_node;\n\tu32 ta_handle;\n\tu32 refcount;\n};\n\n#define LOWER_TWO_BYTE_MASK\t0x0000FFFF\n\n \nstatic inline void set_session_id(u32 ta_handle, u32 session_index,\n\t\t\t\t  u32 *session)\n{\n\t*session = (session_index << 16) | (LOWER_TWO_BYTE_MASK & ta_handle);\n}\n\nstatic inline u32 get_ta_handle(u32 session)\n{\n\treturn session & LOWER_TWO_BYTE_MASK;\n}\n\nstatic inline u32 get_session_index(u32 session)\n{\n\treturn (session >> 16) & LOWER_TWO_BYTE_MASK;\n}\n\nint amdtee_open_session(struct tee_context *ctx,\n\t\t\tstruct tee_ioctl_open_session_arg *arg,\n\t\t\tstruct tee_param *param);\n\nint amdtee_close_session(struct tee_context *ctx, u32 session);\n\nint amdtee_invoke_func(struct tee_context *ctx,\n\t\t       struct tee_ioctl_invoke_arg *arg,\n\t\t       struct tee_param *param);\n\nint amdtee_cancel_req(struct tee_context *ctx, u32 cancel_id, u32 session);\n\nint amdtee_map_shmem(struct tee_shm *shm);\n\nvoid amdtee_unmap_shmem(struct tee_shm *shm);\n\nint handle_load_ta(void *data, u32 size,\n\t\t   struct tee_ioctl_open_session_arg *arg);\n\nint handle_unload_ta(u32 ta_handle);\n\nint handle_open_session(struct tee_ioctl_open_session_arg *arg, u32 *info,\n\t\t\tstruct tee_param *p);\n\nint handle_close_session(u32 ta_handle, u32 info);\n\nint handle_map_shmem(u32 count, struct shmem_desc *start, u32 *buf_id);\n\nvoid handle_unmap_shmem(u32 buf_id);\n\nint handle_invoke_cmd(struct tee_ioctl_invoke_arg *arg, u32 sinfo,\n\t\t      struct tee_param *p);\n\nstruct tee_shm_pool *amdtee_config_shm(void);\n\nu32 get_buffer_id(struct tee_shm *shm);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}