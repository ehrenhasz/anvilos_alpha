{
  "module_name": "optee_smc.h",
  "hash_id": "38e888b0a4eb686757fae799c268d14db53ff604ba4a40ff632da5e1fd3c8866",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tee/optee/optee_smc.h",
  "human_readable_source": " \n \n#ifndef OPTEE_SMC_H\n#define OPTEE_SMC_H\n\n#include <linux/arm-smccc.h>\n#include <linux/bitops.h>\n\n#define OPTEE_SMC_STD_CALL_VAL(func_num) \\\n\tARM_SMCCC_CALL_VAL(ARM_SMCCC_STD_CALL, ARM_SMCCC_SMC_32, \\\n\t\t\t   ARM_SMCCC_OWNER_TRUSTED_OS, (func_num))\n#define OPTEE_SMC_FAST_CALL_VAL(func_num) \\\n\tARM_SMCCC_CALL_VAL(ARM_SMCCC_FAST_CALL, ARM_SMCCC_SMC_32, \\\n\t\t\t   ARM_SMCCC_OWNER_TRUSTED_OS, (func_num))\n\n \n#define OPTEE_SMC_FUNCID_CALLS_COUNT\t0xFF00\n#define OPTEE_SMC_CALLS_COUNT \\\n\tARM_SMCCC_CALL_VAL(OPTEE_SMC_FAST_CALL, SMCCC_SMC_32, \\\n\t\t\t   SMCCC_OWNER_TRUSTED_OS_END, \\\n\t\t\t   OPTEE_SMC_FUNCID_CALLS_COUNT)\n\n \n#define OPTEE_SMC_SHM_CACHED\t\t1\n\n \n\n \n#define OPTEE_SMC_FUNCID_CALLS_UID OPTEE_MSG_FUNCID_CALLS_UID\n#define OPTEE_SMC_CALLS_UID \\\n\tARM_SMCCC_CALL_VAL(ARM_SMCCC_FAST_CALL, ARM_SMCCC_SMC_32, \\\n\t\t\t   ARM_SMCCC_OWNER_TRUSTED_OS_END, \\\n\t\t\t   OPTEE_SMC_FUNCID_CALLS_UID)\n\n \n#define OPTEE_SMC_FUNCID_CALLS_REVISION OPTEE_MSG_FUNCID_CALLS_REVISION\n#define OPTEE_SMC_CALLS_REVISION \\\n\tARM_SMCCC_CALL_VAL(ARM_SMCCC_FAST_CALL, ARM_SMCCC_SMC_32, \\\n\t\t\t   ARM_SMCCC_OWNER_TRUSTED_OS_END, \\\n\t\t\t   OPTEE_SMC_FUNCID_CALLS_REVISION)\n\nstruct optee_smc_calls_revision_result {\n\tunsigned long major;\n\tunsigned long minor;\n\tunsigned long reserved0;\n\tunsigned long reserved1;\n};\n\n \n#define OPTEE_SMC_FUNCID_GET_OS_UUID OPTEE_MSG_FUNCID_GET_OS_UUID\n#define OPTEE_SMC_CALL_GET_OS_UUID \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_GET_OS_UUID)\n\n \n#define OPTEE_SMC_FUNCID_GET_OS_REVISION OPTEE_MSG_FUNCID_GET_OS_REVISION\n#define OPTEE_SMC_CALL_GET_OS_REVISION \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_GET_OS_REVISION)\n\nstruct optee_smc_call_get_os_revision_result {\n\tunsigned long major;\n\tunsigned long minor;\n\tunsigned long build_id;\n\tunsigned long reserved1;\n};\n\n \n#define OPTEE_SMC_FUNCID_LOAD_IMAGE 2\n#define OPTEE_SMC_CALL_LOAD_IMAGE \\\n\tARM_SMCCC_CALL_VAL(ARM_SMCCC_FAST_CALL, ARM_SMCCC_SMC_32, \\\n\t\t\t   ARM_SMCCC_OWNER_TRUSTED_OS_END, \\\n\t\t\t   OPTEE_SMC_FUNCID_LOAD_IMAGE)\n\n \n#define OPTEE_SMC_FUNCID_CALL_WITH_ARG OPTEE_MSG_FUNCID_CALL_WITH_ARG\n#define OPTEE_SMC_CALL_WITH_ARG \\\n\tOPTEE_SMC_STD_CALL_VAL(OPTEE_SMC_FUNCID_CALL_WITH_ARG)\n#define OPTEE_SMC_CALL_WITH_RPC_ARG \\\n\tOPTEE_SMC_STD_CALL_VAL(OPTEE_SMC_FUNCID_CALL_WITH_RPC_ARG)\n#define OPTEE_SMC_CALL_WITH_REGD_ARG \\\n\tOPTEE_SMC_STD_CALL_VAL(OPTEE_SMC_FUNCID_CALL_WITH_REGD_ARG)\n\n \n#define OPTEE_SMC_FUNCID_GET_SHM_CONFIG\t7\n#define OPTEE_SMC_GET_SHM_CONFIG \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_GET_SHM_CONFIG)\n\nstruct optee_smc_get_shm_config_result {\n\tunsigned long status;\n\tunsigned long start;\n\tunsigned long size;\n\tunsigned long settings;\n};\n\n \n \n#define OPTEE_SMC_NSEC_CAP_UNIPROCESSOR\t\tBIT(0)\n \n#define OPTEE_SMC_SEC_CAP_HAVE_RESERVED_SHM\tBIT(0)\n \n#define OPTEE_SMC_SEC_CAP_UNREGISTERED_SHM\tBIT(1)\n\n \n#define OPTEE_SMC_SEC_CAP_DYNAMIC_SHM\t\tBIT(2)\n \n#define OPTEE_SMC_SEC_CAP_VIRTUALIZATION\tBIT(3)\n \n#define OPTEE_SMC_SEC_CAP_MEMREF_NULL\t\tBIT(4)\n \n#define OPTEE_SMC_SEC_CAP_ASYNC_NOTIF\t\tBIT(5)\n \n#define OPTEE_SMC_SEC_CAP_RPC_ARG\t\tBIT(6)\n\n#define OPTEE_SMC_FUNCID_EXCHANGE_CAPABILITIES\t9\n#define OPTEE_SMC_EXCHANGE_CAPABILITIES \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_EXCHANGE_CAPABILITIES)\n\nstruct optee_smc_exchange_capabilities_result {\n\tunsigned long status;\n\tunsigned long capabilities;\n\tunsigned long max_notif_value;\n\tunsigned long data;\n};\n\n \n#define OPTEE_SMC_FUNCID_DISABLE_SHM_CACHE\t10\n#define OPTEE_SMC_DISABLE_SHM_CACHE \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_DISABLE_SHM_CACHE)\n\nstruct optee_smc_disable_shm_cache_result {\n\tunsigned long status;\n\tunsigned long shm_upper32;\n\tunsigned long shm_lower32;\n\tunsigned long reserved0;\n};\n\n \n#define OPTEE_SMC_FUNCID_ENABLE_SHM_CACHE\t11\n#define OPTEE_SMC_ENABLE_SHM_CACHE \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_ENABLE_SHM_CACHE)\n\n \n#define OPTEE_SMC_FUNCID_GET_THREAD_COUNT\t15\n#define OPTEE_SMC_GET_THREAD_COUNT \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_GET_THREAD_COUNT)\n\n \n#define OPTEE_SMC_FUNCID_ENABLE_ASYNC_NOTIF\t16\n#define OPTEE_SMC_ENABLE_ASYNC_NOTIF \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_ENABLE_ASYNC_NOTIF)\n\n \n#define OPTEE_SMC_ASYNC_NOTIF_VALUE_VALID\tBIT(0)\n#define OPTEE_SMC_ASYNC_NOTIF_VALUE_PENDING\tBIT(1)\n\n \n#define OPTEE_SMC_ASYNC_NOTIF_VALUE_DO_BOTTOM_HALF\t0\n\n#define OPTEE_SMC_FUNCID_GET_ASYNC_NOTIF_VALUE\t17\n#define OPTEE_SMC_GET_ASYNC_NOTIF_VALUE \\\n\tOPTEE_SMC_FAST_CALL_VAL(OPTEE_SMC_FUNCID_GET_ASYNC_NOTIF_VALUE)\n\n \n#define OPTEE_SMC_FUNCID_CALL_WITH_RPC_ARG\t18\n\n \n#define OPTEE_SMC_FUNCID_CALL_WITH_REGD_ARG\t19\n\n \n#define OPTEE_SMC_FUNCID_RETURN_FROM_RPC\t3\n#define OPTEE_SMC_CALL_RETURN_FROM_RPC \\\n\tOPTEE_SMC_STD_CALL_VAL(OPTEE_SMC_FUNCID_RETURN_FROM_RPC)\n\n#define OPTEE_SMC_RETURN_RPC_PREFIX_MASK\t0xFFFF0000\n#define OPTEE_SMC_RETURN_RPC_PREFIX\t\t0xFFFF0000\n#define OPTEE_SMC_RETURN_RPC_FUNC_MASK\t\t0x0000FFFF\n\n#define OPTEE_SMC_RETURN_GET_RPC_FUNC(ret) \\\n\t((ret) & OPTEE_SMC_RETURN_RPC_FUNC_MASK)\n\n#define OPTEE_SMC_RPC_VAL(func)\t\t((func) | OPTEE_SMC_RETURN_RPC_PREFIX)\n\n \n#define OPTEE_SMC_RPC_FUNC_ALLOC\t0\n#define OPTEE_SMC_RETURN_RPC_ALLOC \\\n\tOPTEE_SMC_RPC_VAL(OPTEE_SMC_RPC_FUNC_ALLOC)\n\n \n#define OPTEE_SMC_RPC_FUNC_FREE\t\t2\n#define OPTEE_SMC_RETURN_RPC_FREE \\\n\tOPTEE_SMC_RPC_VAL(OPTEE_SMC_RPC_FUNC_FREE)\n\n \n#define OPTEE_SMC_RPC_FUNC_FOREIGN_INTR\t4\n#define OPTEE_SMC_RETURN_RPC_FOREIGN_INTR \\\n\tOPTEE_SMC_RPC_VAL(OPTEE_SMC_RPC_FUNC_FOREIGN_INTR)\n\n \n#define OPTEE_SMC_RPC_FUNC_CMD\t\t5\n#define OPTEE_SMC_RETURN_RPC_CMD \\\n\tOPTEE_SMC_RPC_VAL(OPTEE_SMC_RPC_FUNC_CMD)\n\n \n#define OPTEE_SMC_RETURN_UNKNOWN_FUNCTION 0xFFFFFFFF\n\n \n#define OPTEE_SMC_RETURN_OK\t\t0x0\n#define OPTEE_SMC_RETURN_ETHREAD_LIMIT\t0x1\n#define OPTEE_SMC_RETURN_EBUSY\t\t0x2\n#define OPTEE_SMC_RETURN_ERESUME\t0x3\n#define OPTEE_SMC_RETURN_EBADADDR\t0x4\n#define OPTEE_SMC_RETURN_EBADCMD\t0x5\n#define OPTEE_SMC_RETURN_ENOMEM\t\t0x6\n#define OPTEE_SMC_RETURN_ENOTAVAIL\t0x7\n#define OPTEE_SMC_RETURN_IS_RPC(ret)\t__optee_smc_return_is_rpc((ret))\n\nstatic inline bool __optee_smc_return_is_rpc(u32 ret)\n{\n\treturn ret != OPTEE_SMC_RETURN_UNKNOWN_FUNCTION &&\n\t       (ret & OPTEE_SMC_RETURN_RPC_PREFIX_MASK) ==\n\t\t\tOPTEE_SMC_RETURN_RPC_PREFIX;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}