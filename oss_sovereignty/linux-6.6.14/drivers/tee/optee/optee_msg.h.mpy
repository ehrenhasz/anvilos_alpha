{
  "module_name": "optee_msg.h",
  "hash_id": "9bd04d367693d1f077319c1ff4f113d0739a9bca232a23462afa38e9f41fc6ab",
  "original_prompt": "Ingested from linux-6.6.14/drivers/tee/optee/optee_msg.h",
  "human_readable_source": " \n \n#ifndef _OPTEE_MSG_H\n#define _OPTEE_MSG_H\n\n#include <linux/bitops.h>\n#include <linux/types.h>\n\n \n\n \n\n#define OPTEE_MSG_ATTR_TYPE_NONE\t\t0x0\n#define OPTEE_MSG_ATTR_TYPE_VALUE_INPUT\t\t0x1\n#define OPTEE_MSG_ATTR_TYPE_VALUE_OUTPUT\t0x2\n#define OPTEE_MSG_ATTR_TYPE_VALUE_INOUT\t\t0x3\n#define OPTEE_MSG_ATTR_TYPE_RMEM_INPUT\t\t0x5\n#define OPTEE_MSG_ATTR_TYPE_RMEM_OUTPUT\t\t0x6\n#define OPTEE_MSG_ATTR_TYPE_RMEM_INOUT\t\t0x7\n#define OPTEE_MSG_ATTR_TYPE_FMEM_INPUT\t\tOPTEE_MSG_ATTR_TYPE_RMEM_INPUT\n#define OPTEE_MSG_ATTR_TYPE_FMEM_OUTPUT\t\tOPTEE_MSG_ATTR_TYPE_RMEM_OUTPUT\n#define OPTEE_MSG_ATTR_TYPE_FMEM_INOUT\t\tOPTEE_MSG_ATTR_TYPE_RMEM_INOUT\n#define OPTEE_MSG_ATTR_TYPE_TMEM_INPUT\t\t0x9\n#define OPTEE_MSG_ATTR_TYPE_TMEM_OUTPUT\t\t0xa\n#define OPTEE_MSG_ATTR_TYPE_TMEM_INOUT\t\t0xb\n\n#define OPTEE_MSG_ATTR_TYPE_MASK\t\tGENMASK(7, 0)\n\n \n#define OPTEE_MSG_ATTR_META\t\t\tBIT(8)\n\n \n#define OPTEE_MSG_ATTR_NONCONTIG\t\tBIT(9)\n\n \n#define OPTEE_MSG_ATTR_CACHE_SHIFT\t\t16\n#define OPTEE_MSG_ATTR_CACHE_MASK\t\tGENMASK(2, 0)\n#define OPTEE_MSG_ATTR_CACHE_PREDEFINED\t\t0\n\n \n#define OPTEE_MSG_LOGIN_PUBLIC\t\t\t0x00000000\n#define OPTEE_MSG_LOGIN_USER\t\t\t0x00000001\n#define OPTEE_MSG_LOGIN_GROUP\t\t\t0x00000002\n#define OPTEE_MSG_LOGIN_APPLICATION\t\t0x00000004\n#define OPTEE_MSG_LOGIN_APPLICATION_USER\t0x00000005\n#define OPTEE_MSG_LOGIN_APPLICATION_GROUP\t0x00000006\n\n \n#define OPTEE_MSG_NONCONTIG_PAGE_SIZE\t\t4096\n\n#define OPTEE_MSG_FMEM_INVALID_GLOBAL_ID\t0xffffffffffffffff\n\n \nstruct optee_msg_param_tmem {\n\tu64 buf_ptr;\n\tu64 size;\n\tu64 shm_ref;\n};\n\n \nstruct optee_msg_param_rmem {\n\tu64 offs;\n\tu64 size;\n\tu64 shm_ref;\n};\n\n \nstruct optee_msg_param_fmem {\n\tu32 offs_low;\n\tu16 offs_high;\n\tu16 internal_offs;\n\tu64 size;\n\tu64 global_id;\n};\n\n \nstruct optee_msg_param_value {\n\tu64 a;\n\tu64 b;\n\tu64 c;\n};\n\n \nstruct optee_msg_param {\n\tu64 attr;\n\tunion {\n\t\tstruct optee_msg_param_tmem tmem;\n\t\tstruct optee_msg_param_rmem rmem;\n\t\tstruct optee_msg_param_fmem fmem;\n\t\tstruct optee_msg_param_value value;\n\t\tu8 octets[24];\n\t} u;\n};\n\n \nstruct optee_msg_arg {\n\tu32 cmd;\n\tu32 func;\n\tu32 session;\n\tu32 cancel_id;\n\tu32 pad;\n\tu32 ret;\n\tu32 ret_origin;\n\tu32 num_params;\n\n\t \n\tstruct optee_msg_param params[];\n};\n\n \n#define OPTEE_MSG_GET_ARG_SIZE(num_params) \\\n\t(sizeof(struct optee_msg_arg) + \\\n\t sizeof(struct optee_msg_param) * (num_params))\n\n \n\n \n#define OPTEE_MSG_UID_0\t\t\t0x384fb3e0\n#define OPTEE_MSG_UID_1\t\t\t0xe7f811e3\n#define OPTEE_MSG_UID_2\t\t\t0xaf630002\n#define OPTEE_MSG_UID_3\t\t\t0xa5d5c51b\n#define OPTEE_MSG_IMAGE_LOAD_UID_0\t0xa3fbeab1\n#define OPTEE_MSG_IMAGE_LOAD_UID_1\t0x1246315d\n#define OPTEE_MSG_IMAGE_LOAD_UID_2\t0xc7c406b9\n#define OPTEE_MSG_IMAGE_LOAD_UID_3\t0xc03cbea4\n#define OPTEE_MSG_FUNCID_CALLS_UID\t0xFF01\n\n \n#define OPTEE_MSG_REVISION_MAJOR\t2\n#define OPTEE_MSG_REVISION_MINOR\t0\n#define OPTEE_MSG_FUNCID_CALLS_REVISION\t0xFF03\n\n \n#define OPTEE_MSG_OS_OPTEE_UUID_0\t0x486178e0\n#define OPTEE_MSG_OS_OPTEE_UUID_1\t0xe7f811e3\n#define OPTEE_MSG_OS_OPTEE_UUID_2\t0xbc5e0002\n#define OPTEE_MSG_OS_OPTEE_UUID_3\t0xa5d5c51b\n#define OPTEE_MSG_FUNCID_GET_OS_UUID\t0x0000\n\n \n#define OPTEE_MSG_FUNCID_GET_OS_REVISION\t0x0001\n\n \n#define OPTEE_MSG_CMD_OPEN_SESSION\t0\n#define OPTEE_MSG_CMD_INVOKE_COMMAND\t1\n#define OPTEE_MSG_CMD_CLOSE_SESSION\t2\n#define OPTEE_MSG_CMD_CANCEL\t\t3\n#define OPTEE_MSG_CMD_REGISTER_SHM\t4\n#define OPTEE_MSG_CMD_UNREGISTER_SHM\t5\n#define OPTEE_MSG_CMD_DO_BOTTOM_HALF\t6\n#define OPTEE_MSG_CMD_STOP_ASYNC_NOTIF\t7\n#define OPTEE_MSG_FUNCID_CALL_WITH_ARG\t0x0004\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}