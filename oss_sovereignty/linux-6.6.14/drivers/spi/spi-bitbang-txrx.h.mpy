{
  "module_name": "spi-bitbang-txrx.h",
  "hash_id": "06b756d2af441b3769828a29f29f0009d9614f419bbf29615163b6fe19a384b5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/spi/spi-bitbang-txrx.h",
  "human_readable_source": " \n \n\n \n\nstatic inline u32\nbitbang_txrx_be_cpha0(struct spi_device *spi,\n\t\tunsigned nsecs, unsigned cpol, unsigned flags,\n\t\tu32 word, u8 bits)\n{\n\t \n\n\tu32 oldbit = (!(word & (1<<(bits-1)))) << 31;\n\t \n\tfor (word <<= (32 - bits); likely(bits); bits--) {\n\n\t\t \n\t\tif ((flags & SPI_CONTROLLER_NO_TX) == 0) {\n\t\t\tif ((word & (1 << 31)) != oldbit) {\n\t\t\t\tsetmosi(spi, word & (1 << 31));\n\t\t\t\toldbit = word & (1 << 31);\n\t\t\t}\n\t\t}\n\t\tspidelay(nsecs);\t \n\n\t\tsetsck(spi, !cpol);\n\t\tspidelay(nsecs);\n\n\t\t \n\t\tword <<= 1;\n\t\tif ((flags & SPI_CONTROLLER_NO_RX) == 0)\n\t\t\tword |= getmiso(spi);\n\t\tsetsck(spi, cpol);\n\t}\n\treturn word;\n}\n\nstatic inline u32\nbitbang_txrx_be_cpha1(struct spi_device *spi,\n\t\tunsigned nsecs, unsigned cpol, unsigned flags,\n\t\tu32 word, u8 bits)\n{\n\t \n\n\tu32 oldbit = (!(word & (1<<(bits-1)))) << 31;\n\t \n\tfor (word <<= (32 - bits); likely(bits); bits--) {\n\n\t\t \n\t\tsetsck(spi, !cpol);\n\t\tif ((flags & SPI_CONTROLLER_NO_TX) == 0) {\n\t\t\tif ((word & (1 << 31)) != oldbit) {\n\t\t\t\tsetmosi(spi, word & (1 << 31));\n\t\t\t\toldbit = word & (1 << 31);\n\t\t\t}\n\t\t}\n\t\tspidelay(nsecs);  \n\n\t\tsetsck(spi, cpol);\n\t\tspidelay(nsecs);\n\n\t\t \n\t\tword <<= 1;\n\t\tif ((flags & SPI_CONTROLLER_NO_RX) == 0)\n\t\t\tword |= getmiso(spi);\n\t}\n\treturn word;\n}\n\nstatic inline u32\nbitbang_txrx_le_cpha0(struct spi_device *spi,\n\t\tunsigned int nsecs, unsigned int cpol, unsigned int flags,\n\t\tu32 word, u8 bits)\n{\n\t \n\n\tu8 rxbit = bits - 1;\n\tu32 oldbit = !(word & 1);\n\t \n\tfor (; likely(bits); bits--) {\n\n\t\t \n\t\tif ((flags & SPI_CONTROLLER_NO_TX) == 0) {\n\t\t\tif ((word & 1) != oldbit) {\n\t\t\t\tsetmosi(spi, word & 1);\n\t\t\t\toldbit = word & 1;\n\t\t\t}\n\t\t}\n\t\tspidelay(nsecs);\t \n\n\t\tsetsck(spi, !cpol);\n\t\tspidelay(nsecs);\n\n\t\t \n\t\tword >>= 1;\n\t\tif ((flags & SPI_CONTROLLER_NO_RX) == 0)\n\t\t\tword |= getmiso(spi) << rxbit;\n\t\tsetsck(spi, cpol);\n\t}\n\treturn word;\n}\n\nstatic inline u32\nbitbang_txrx_le_cpha1(struct spi_device *spi,\n\t\tunsigned int nsecs, unsigned int cpol, unsigned int flags,\n\t\tu32 word, u8 bits)\n{\n\t \n\n\tu8 rxbit = bits - 1;\n\tu32 oldbit = !(word & 1);\n\t \n\tfor (; likely(bits); bits--) {\n\n\t\t \n\t\tsetsck(spi, !cpol);\n\t\tif ((flags & SPI_CONTROLLER_NO_TX) == 0) {\n\t\t\tif ((word & 1) != oldbit) {\n\t\t\t\tsetmosi(spi, word & 1);\n\t\t\t\toldbit = word & 1;\n\t\t\t}\n\t\t}\n\t\tspidelay(nsecs);  \n\n\t\tsetsck(spi, cpol);\n\t\tspidelay(nsecs);\n\n\t\t \n\t\tword >>= 1;\n\t\tif ((flags & SPI_CONTROLLER_NO_RX) == 0)\n\t\t\tword |= getmiso(spi) << rxbit;\n\t}\n\treturn word;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}