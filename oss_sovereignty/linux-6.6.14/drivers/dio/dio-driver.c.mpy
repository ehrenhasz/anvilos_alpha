{
  "module_name": "dio-driver.c",
  "hash_id": "76f23a65dc5fa1c8db3c6cba5acbbb98784feae74758ea65db95a4929a832632",
  "original_prompt": "Ingested from linux-6.6.14/drivers/dio/dio-driver.c",
  "human_readable_source": " \n\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/dio.h>\n\n\n \n\nstatic const struct dio_device_id *\ndio_match_device(const struct dio_device_id *ids,\n\t\t   const struct dio_dev *d)\n{\n\twhile (ids->id) {\n\t\tif (ids->id == DIO_WILDCARD)\n\t\t\treturn ids;\n\t\tif (DIO_NEEDSSECID(ids->id & 0xff)) {\n\t\t\tif (ids->id == d->id)\n\t\t\t\treturn ids;\n\t\t} else {\n\t\t\tif ((ids->id & 0xff) == (d->id & 0xff))\n\t\t\t\treturn ids;\n\t\t}\n\t\tids++;\n\t}\n\treturn NULL;\n}\n\nstatic int dio_device_probe(struct device *dev)\n{\n\tint error = 0;\n\tstruct dio_driver *drv = to_dio_driver(dev->driver);\n\tstruct dio_dev *d = to_dio_dev(dev);\n\n\tif (!d->driver && drv->probe) {\n\t\tconst struct dio_device_id *id;\n\n\t\tid = dio_match_device(drv->id_table, d);\n\t\tif (id)\n\t\t\terror = drv->probe(d, id);\n\t\tif (error >= 0) {\n\t\t\td->driver = drv;\n\t\t\terror = 0;\n\t\t}\n\t}\n\treturn error;\n}\n\n\n \n\nint dio_register_driver(struct dio_driver *drv)\n{\n\t \n\tdrv->driver.name = drv->name;\n\tdrv->driver.bus = &dio_bus_type;\n\n\t \n\treturn driver_register(&drv->driver);\n}\n\n\n \n\nvoid dio_unregister_driver(struct dio_driver *drv)\n{\n\tdriver_unregister(&drv->driver);\n}\n\n\n \n\nstatic int dio_bus_match(struct device *dev, struct device_driver *drv)\n{\n\tstruct dio_dev *d = to_dio_dev(dev);\n\tstruct dio_driver *dio_drv = to_dio_driver(drv);\n\tconst struct dio_device_id *ids = dio_drv->id_table;\n\n\tif (!ids)\n\t\treturn 0;\n\n\treturn dio_match_device(ids, d) ? 1 : 0;\n}\n\n\nstruct bus_type dio_bus_type = {\n\t.name\t= \"dio\",\n\t.match\t= dio_bus_match,\n\t.probe\t= dio_device_probe,\n};\n\n\nstatic int __init dio_driver_init(void)\n{\n\treturn bus_register(&dio_bus_type);\n}\n\npostcore_initcall(dio_driver_init);\n\nEXPORT_SYMBOL(dio_register_driver);\nEXPORT_SYMBOL(dio_unregister_driver);\nEXPORT_SYMBOL(dio_bus_type);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}