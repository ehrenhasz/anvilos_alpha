{
  "module_name": "nx-842.h",
  "hash_id": "c785e6e1e8fca6c072860b00cb14ec684227e7144e935162f5349b7625b8817b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/nx/nx-842.h",
  "human_readable_source": " \n\n#ifndef __NX_842_H__\n#define __NX_842_H__\n\n#include <crypto/algapi.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/mm.h>\n#include <linux/ratelimit.h>\n\n \n#define DDE_BUFFER_ALIGN\t(128)\n#define DDE_BUFFER_SIZE_MULT\t(32)\n#define DDE_BUFFER_LAST_MULT\t(8)\n\n \n#define DDL_LEN_MAX\t\t(17)\n\n \n#define CCW_CI_842\t\t(0x00003ff8)\n#define CCW_FC_842\t\t(0x00000007)\n\n \n#define CCW_FC_842_COMP_NOCRC\t(0)\n#define CCW_FC_842_COMP_CRC\t(1)\n#define CCW_FC_842_DECOMP_NOCRC\t(2)\n#define CCW_FC_842_DECOMP_CRC\t(3)\n#define CCW_FC_842_MOVE\t\t(4)\n\n \n \n#define CSB_CC_TRANSLATION_DUP1\t(80)\n#define CSB_CC_TRANSLATION_DUP2\t(82)\n#define CSB_CC_TRANSLATION_DUP3\t(84)\n#define CSB_CC_TRANSLATION_DUP4\t(86)\n#define CSB_CC_TRANSLATION_DUP5\t(92)\n#define CSB_CC_TRANSLATION_DUP6\t(94)\n#define CSB_CC_PROTECTION_DUP1\t(81)\n#define CSB_CC_PROTECTION_DUP2\t(83)\n#define CSB_CC_PROTECTION_DUP3\t(85)\n#define CSB_CC_PROTECTION_DUP4\t(87)\n#define CSB_CC_PROTECTION_DUP5\t(93)\n#define CSB_CC_PROTECTION_DUP6\t(95)\n#define CSB_CC_RD_EXTERNAL_DUP1\t(89)\n#define CSB_CC_RD_EXTERNAL_DUP2\t(90)\n#define CSB_CC_RD_EXTERNAL_DUP3\t(91)\n \n \n#define CSB_CC_TPBC_GT_SPBC\t(64)  \n#define CSB_CC_CRC_MISMATCH\t(65)  \n#define CSB_CC_TEMPL_INVALID\t(66)  \n#define CSB_CC_TEMPL_OVERFLOW\t(67)  \n \n#define CSB_CC_DECRYPT_OVERFLOW\t(64)\n \n#define CSB_CC_MINV_OVERFLOW\t(128)\n \n#define CSB_CC_HW_EXPIRED_TIMER\t\t(224)\n \n#define CSB_CC_HYP_RESERVE_START\t(240)\n#define CSB_CC_HYP_RESERVE_END\t\t(253)\n#define CSB_CC_HYP_RESERVE_P9_END\t(251)\n \n#define CSB_CC_HYP_RESERVE_NO_INTR_SERVER\t(252)\n#define CSB_CC_HYP_NO_HW\t\t(254)\n#define CSB_CC_HYP_HANG_ABORTED\t\t(255)\n\n \n#define CCB_CM_EXTRA_WRITE\t(CCB_CM0_ALL_COMPLETIONS & CCB_CM12_STORE)\n#define CCB_CM_INTERRUPT\t(CCB_CM0_ALL_COMPLETIONS & CCB_CM12_INTERRUPT)\n\n#define LEN_ON_SIZE(pa, size)\t((size) - ((pa) & ((size) - 1)))\n#define LEN_ON_PAGE(pa)\t\tLEN_ON_SIZE(pa, PAGE_SIZE)\n\nstatic inline unsigned long nx842_get_pa(void *addr)\n{\n\tif (!is_vmalloc_addr(addr))\n\t\treturn __pa(addr);\n\n\treturn page_to_phys(vmalloc_to_page(addr)) + offset_in_page(addr);\n}\n\n \nstruct nx842_constraints {\n\tint alignment;\n\tint multiple;\n\tint minimum;\n\tint maximum;\n};\n\nstruct nx842_driver {\n\tchar *name;\n\tstruct module *owner;\n\tsize_t workmem_size;\n\n\tstruct nx842_constraints *constraints;\n\n\tint (*compress)(const unsigned char *in, unsigned int in_len,\n\t\t\tunsigned char *out, unsigned int *out_len,\n\t\t\tvoid *wrkmem);\n\tint (*decompress)(const unsigned char *in, unsigned int in_len,\n\t\t\t  unsigned char *out, unsigned int *out_len,\n\t\t\t  void *wrkmem);\n};\n\nstruct nx842_crypto_header_group {\n\t__be16 padding;\t\t\t \n\t__be32 compressed_length;\t \n\t__be32 uncompressed_length;\t \n} __packed;\n\nstruct nx842_crypto_header {\n\t__be16 magic;\t\t \n\t__be16 ignore;\t\t \n\tu8 groups;\t\t \n\tstruct nx842_crypto_header_group group[];\n} __packed;\n\n#define NX842_CRYPTO_GROUP_MAX\t(0x20)\n\nstruct nx842_crypto_ctx {\n\tspinlock_t lock;\n\n\tu8 *wmem;\n\tu8 *sbounce, *dbounce;\n\n\tstruct nx842_crypto_header header;\n\tstruct nx842_crypto_header_group group[NX842_CRYPTO_GROUP_MAX];\n\n\tstruct nx842_driver *driver;\n};\n\nint nx842_crypto_init(struct crypto_tfm *tfm, struct nx842_driver *driver);\nvoid nx842_crypto_exit(struct crypto_tfm *tfm);\nint nx842_crypto_compress(struct crypto_tfm *tfm,\n\t\t\t  const u8 *src, unsigned int slen,\n\t\t\t  u8 *dst, unsigned int *dlen);\nint nx842_crypto_decompress(struct crypto_tfm *tfm,\n\t\t\t    const u8 *src, unsigned int slen,\n\t\t\t    u8 *dst, unsigned int *dlen);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}