{
  "module_name": "nx.h",
  "hash_id": "a943f61ff85f9fef87c98e23d6ce33e87915ea92dc608b6d47e54270bf9f0d3e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/nx/nx.h",
  "human_readable_source": " \n\n#ifndef __NX_H__\n#define __NX_H__\n\n#include <crypto/ctr.h>\n\n#define NX_NAME\t\t\"nx-crypto\"\n#define NX_STRING\t\"IBM Power7+ Nest Accelerator Crypto Driver\"\n#define NX_VERSION\t\"1.0\"\n\n \nstruct nx_sg {\n\tu64 addr;\n\tu32 rsvd;\n\tu32 len;\n} __attribute((packed));\n\n#define NX_PAGE_SIZE\t\t(4096)\n#define NX_MAX_SG_ENTRIES\t(NX_PAGE_SIZE/(sizeof(struct nx_sg)))\n\nenum nx_status {\n\tNX_DISABLED,\n\tNX_WAITING,\n\tNX_OKAY\n};\n\n \nstruct msc_triplet {\n\tu32 keybitlen;\n\tu32 databytelen;\n\tu32 sglen;\n} __packed;\n\nstruct max_sync_cop {\n\tu32 fc;\n\tu32 mode;\n\tu32 triplets;\n\tstruct msc_triplet trip[];\n} __packed;\n\nstruct alg_props {\n\tu32 databytelen;\n\tu32 sglen;\n};\n\n#define NX_OF_FLAG_MAXSGLEN_SET\t\t(1)\n#define NX_OF_FLAG_STATUS_SET\t\t(2)\n#define NX_OF_FLAG_MAXSYNCCOP_SET\t(4)\n#define NX_OF_FLAG_MASK_READY\t\t(NX_OF_FLAG_MAXSGLEN_SET | \\\n\t\t\t\t\t NX_OF_FLAG_STATUS_SET |   \\\n\t\t\t\t\t NX_OF_FLAG_MAXSYNCCOP_SET)\nstruct nx_of {\n\tu32 flags;\n\tu32 max_sg_len;\n\tenum nx_status status;\n\tstruct alg_props ap[NX_MAX_FC][NX_MAX_MODE][3];\n};\n\nstruct nx_stats {\n\tatomic_t aes_ops;\n\tatomic64_t aes_bytes;\n\tatomic_t sha256_ops;\n\tatomic64_t sha256_bytes;\n\tatomic_t sha512_ops;\n\tatomic64_t sha512_bytes;\n\n\tatomic_t sync_ops;\n\n\tatomic_t errors;\n\tatomic_t last_error;\n\tatomic_t last_error_pid;\n};\n\nstruct nx_crypto_driver {\n\tstruct nx_stats    stats;\n\tstruct nx_of       of;\n\tstruct vio_dev    *viodev;\n\tstruct vio_driver  viodriver;\n\tstruct dentry     *dfs_root;\n};\n\n#define NX_GCM4106_NONCE_LEN\t\t(4)\n#define NX_GCM_CTR_OFFSET\t\t(12)\nstruct nx_gcm_rctx {\n\tu8 iv[16];\n};\n\nstruct nx_gcm_priv {\n\tu8 iauth_tag[16];\n\tu8 nonce[NX_GCM4106_NONCE_LEN];\n};\n\n#define NX_CCM_AES_KEY_LEN\t\t(16)\n#define NX_CCM4309_AES_KEY_LEN\t\t(19)\n#define NX_CCM4309_NONCE_LEN\t\t(3)\nstruct nx_ccm_rctx {\n\tu8 iv[16];\n};\n\nstruct nx_ccm_priv {\n\tu8 b0[16];\n\tu8 iauth_tag[16];\n\tu8 oauth_tag[16];\n\tu8 nonce[NX_CCM4309_NONCE_LEN];\n};\n\nstruct nx_xcbc_priv {\n\tu8 key[16];\n};\n\nstruct nx_ctr_priv {\n\tu8 nonce[CTR_RFC3686_NONCE_SIZE];\n};\n\nstruct nx_crypto_ctx {\n\tspinlock_t lock;\t   \n\tvoid *kmem;\t\t   \n\tsize_t kmem_len;\t   \n\tstruct nx_csbcpb *csbcpb;  \n\tstruct vio_pfo_op op;      \n\tstruct nx_csbcpb *csbcpb_aead;  \n\tstruct vio_pfo_op op_aead; \n\n\tstruct nx_sg *in_sg;       \n\tstruct nx_sg *out_sg;      \n\n\tstruct alg_props *ap;\t   \n\tstruct alg_props props[3]; \n\tstruct nx_stats *stats;    \n\n\tunion {\n\t\tstruct nx_gcm_priv gcm;\n\t\tstruct nx_ccm_priv ccm;\n\t\tstruct nx_xcbc_priv xcbc;\n\t\tstruct nx_ctr_priv ctr;\n\t} priv;\n};\n\nstruct crypto_aead;\n\n \nint nx_crypto_ctx_aes_ccm_init(struct crypto_aead *tfm);\nint nx_crypto_ctx_aes_gcm_init(struct crypto_aead *tfm);\nint nx_crypto_ctx_aes_xcbc_init(struct crypto_tfm *tfm);\nint nx_crypto_ctx_aes_ctr_init(struct crypto_skcipher *tfm);\nint nx_crypto_ctx_aes_cbc_init(struct crypto_skcipher *tfm);\nint nx_crypto_ctx_aes_ecb_init(struct crypto_skcipher *tfm);\nint nx_crypto_ctx_sha_init(struct crypto_tfm *tfm);\nvoid nx_crypto_ctx_exit(struct crypto_tfm *tfm);\nvoid nx_crypto_ctx_skcipher_exit(struct crypto_skcipher *tfm);\nvoid nx_crypto_ctx_aead_exit(struct crypto_aead *tfm);\nvoid nx_ctx_init(struct nx_crypto_ctx *nx_ctx, unsigned int function);\nint nx_hcall_sync(struct nx_crypto_ctx *ctx, struct vio_pfo_op *op,\n\t\t  u32 may_sleep);\nstruct nx_sg *nx_build_sg_list(struct nx_sg *, u8 *, unsigned int *, u32);\nint nx_build_sg_lists(struct nx_crypto_ctx *nx_ctx, const u8 *iv,\n\t\t      struct scatterlist *dst, struct scatterlist *src,\n\t\t      unsigned int *nbytes, unsigned int offset, u8 *oiv);\nstruct nx_sg *nx_walk_and_build(struct nx_sg *, unsigned int,\n\t\t\t\tstruct scatterlist *, unsigned int,\n\t\t\t\tunsigned int *);\n\n#ifdef CONFIG_DEBUG_FS\n#define NX_DEBUGFS_INIT(drv)\tnx_debugfs_init(drv)\n#define NX_DEBUGFS_FINI(drv)\tnx_debugfs_fini(drv)\n\nvoid nx_debugfs_init(struct nx_crypto_driver *);\nvoid nx_debugfs_fini(struct nx_crypto_driver *);\n#else\n#define NX_DEBUGFS_INIT(drv)\tdo {} while (0)\n#define NX_DEBUGFS_FINI(drv)\tdo {} while (0)\n#endif\n\n#define NX_PAGE_NUM(x)\t\t((u64)(x) & 0xfffffffffffff000ULL)\n\nextern struct skcipher_alg nx_cbc_aes_alg;\nextern struct skcipher_alg nx_ecb_aes_alg;\nextern struct aead_alg nx_gcm_aes_alg;\nextern struct aead_alg nx_gcm4106_aes_alg;\nextern struct skcipher_alg nx_ctr3686_aes_alg;\nextern struct aead_alg nx_ccm_aes_alg;\nextern struct aead_alg nx_ccm4309_aes_alg;\nextern struct shash_alg nx_shash_aes_xcbc_alg;\nextern struct shash_alg nx_shash_sha512_alg;\nextern struct shash_alg nx_shash_sha256_alg;\n\nextern struct nx_crypto_driver nx_driver;\n\n#define SCATTERWALK_TO_SG\t1\n#define SCATTERWALK_FROM_SG\t0\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}