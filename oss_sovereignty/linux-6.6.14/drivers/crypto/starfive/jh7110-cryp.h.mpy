{
  "module_name": "jh7110-cryp.h",
  "hash_id": "8eb775f96e8463d414c7de7cbec9a1edafb9e754f148d152b0b76bb7a819a1a8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/starfive/jh7110-cryp.h",
  "human_readable_source": " \n#ifndef __STARFIVE_STR_H__\n#define __STARFIVE_STR_H__\n\n#include <crypto/aes.h>\n#include <crypto/hash.h>\n#include <crypto/scatterwalk.h>\n#include <crypto/sha2.h>\n#include <crypto/sm3.h>\n#include <linux/delay.h>\n#include <linux/dma-mapping.h>\n#include <linux/dmaengine.h>\n#include <linux/interrupt.h>\n\n#define STARFIVE_ALG_CR_OFFSET\t\t\t0x0\n#define STARFIVE_ALG_FIFO_OFFSET\t\t0x4\n#define STARFIVE_IE_MASK_OFFSET\t\t\t0x8\n#define STARFIVE_IE_FLAG_OFFSET\t\t\t0xc\n#define STARFIVE_DMA_IN_LEN_OFFSET\t\t0x10\n#define STARFIVE_DMA_OUT_LEN_OFFSET\t\t0x14\n\n#define STARFIVE_IE_MASK_AES_DONE\t\t0x1\n#define STARFIVE_IE_MASK_HASH_DONE\t\t0x4\n#define STARFIVE_IE_MASK_PKA_DONE\t\t0x8\n#define STARFIVE_IE_FLAG_AES_DONE\t\t0x1\n#define STARFIVE_IE_FLAG_HASH_DONE\t\t0x4\n#define STARFIVE_IE_FLAG_PKA_DONE\t\t0x8\n\n#define STARFIVE_MSG_BUFFER_SIZE\t\tSZ_16K\n#define MAX_KEY_SIZE\t\t\t\tSHA512_BLOCK_SIZE\n#define STARFIVE_AES_IV_LEN\t\t\tAES_BLOCK_SIZE\n#define STARFIVE_AES_CTR_LEN\t\t\tAES_BLOCK_SIZE\n\nunion starfive_aes_csr {\n\tu32 v;\n\tstruct {\n\t\tu32 cmode\t\t\t:1;\n#define STARFIVE_AES_KEYMODE_128\t\t0x0\n#define STARFIVE_AES_KEYMODE_192\t\t0x1\n#define STARFIVE_AES_KEYMODE_256\t\t0x2\n\t\tu32 keymode\t\t\t:2;\n#define STARFIVE_AES_BUSY\t\t\tBIT(3)\n\t\tu32 busy\t\t\t:1;\n\t\tu32 done\t\t\t:1;\n#define STARFIVE_AES_KEY_DONE\t\t\tBIT(5)\n\t\tu32 krdy\t\t\t:1;\n\t\tu32 aesrst\t\t\t:1;\n\t\tu32 ie\t\t\t\t:1;\n#define STARFIVE_AES_CCM_START\t\t\tBIT(8)\n\t\tu32 ccm_start\t\t\t:1;\n#define STARFIVE_AES_MODE_ECB\t\t\t0x0\n#define STARFIVE_AES_MODE_CBC\t\t\t0x1\n#define STARFIVE_AES_MODE_CFB\t\t\t0x2\n#define STARFIVE_AES_MODE_OFB\t\t\t0x3\n#define STARFIVE_AES_MODE_CTR\t\t\t0x4\n#define STARFIVE_AES_MODE_CCM\t\t\t0x5\n#define STARFIVE_AES_MODE_GCM\t\t\t0x6\n\t\tu32 mode\t\t\t:3;\n#define STARFIVE_AES_GCM_START\t\t\tBIT(12)\n\t\tu32 gcm_start\t\t\t:1;\n#define STARFIVE_AES_GCM_DONE\t\t\tBIT(13)\n\t\tu32 gcm_done\t\t\t:1;\n\t\tu32 delay_aes\t\t\t:1;\n\t\tu32 vaes_start\t\t\t:1;\n\t\tu32 rsvd_0\t\t\t:8;\n#define STARFIVE_AES_MODE_XFB_1\t\t\t0x0\n#define STARFIVE_AES_MODE_XFB_128\t\t0x5\n\t\tu32 stmode\t\t\t:3;\n\t\tu32 rsvd_1\t\t\t:5;\n\t};\n};\n\nunion starfive_hash_csr {\n\tu32 v;\n\tstruct {\n\t\tu32 start\t\t\t:1;\n\t\tu32 reset\t\t\t:1;\n\t\tu32 ie\t\t\t\t:1;\n\t\tu32 firstb\t\t\t:1;\n#define STARFIVE_HASH_SM3\t\t\t0x0\n#define STARFIVE_HASH_SHA224\t\t\t0x3\n#define STARFIVE_HASH_SHA256\t\t\t0x4\n#define STARFIVE_HASH_SHA384\t\t\t0x5\n#define STARFIVE_HASH_SHA512\t\t\t0x6\n#define STARFIVE_HASH_MODE_MASK\t\t\t0x7\n\t\tu32 mode\t\t\t:3;\n\t\tu32 rsvd_1\t\t\t:1;\n\t\tu32 final\t\t\t:1;\n\t\tu32 rsvd_2\t\t\t:2;\n#define STARFIVE_HASH_HMAC_FLAGS\t\t0x800\n\t\tu32 hmac\t\t\t:1;\n\t\tu32 rsvd_3\t\t\t:1;\n#define STARFIVE_HASH_KEY_DONE\t\t\tBIT(13)\n\t\tu32 key_done\t\t\t:1;\n\t\tu32 key_flag\t\t\t:1;\n\t\tu32 hmac_done\t\t\t:1;\n#define STARFIVE_HASH_BUSY\t\t\tBIT(16)\n\t\tu32 busy\t\t\t:1;\n\t\tu32 hashdone\t\t\t:1;\n\t\tu32 rsvd_4\t\t\t:14;\n\t};\n};\n\nunion starfive_pka_cacr {\n\tu32 v;\n\tstruct {\n\t\tu32 start\t\t\t:1;\n\t\tu32 reset\t\t\t:1;\n\t\tu32 ie\t\t\t\t:1;\n\t\tu32 rsvd_0\t\t\t:1;\n\t\tu32 fifo_mode\t\t\t:1;\n\t\tu32 not_r2\t\t\t:1;\n\t\tu32 ecc_sub\t\t\t:1;\n\t\tu32 pre_expf\t\t\t:1;\n\t\tu32 cmd\t\t\t\t:4;\n\t\tu32 rsvd_1\t\t\t:1;\n\t\tu32 ctrl_dummy\t\t\t:1;\n\t\tu32 ctrl_false\t\t\t:1;\n\t\tu32 cln_done\t\t\t:1;\n\t\tu32 opsize\t\t\t:6;\n\t\tu32 rsvd_2\t\t\t:2;\n\t\tu32 exposize\t\t\t:6;\n\t\tu32 rsvd_3\t\t\t:1;\n\t\tu32 bigendian\t\t\t:1;\n\t};\n};\n\nstruct starfive_rsa_key {\n\tu8\t*n;\n\tu8\t*e;\n\tu8\t*d;\n\tint\te_bitlen;\n\tint\td_bitlen;\n\tint\tbitlen;\n\tsize_t\tkey_sz;\n};\n\nunion starfive_alg_cr {\n\tu32 v;\n\tstruct {\n\t\tu32 start\t\t\t:1;\n\t\tu32 aes_dma_en\t\t\t:1;\n\t\tu32 rsvd_0\t\t\t:1;\n\t\tu32 hash_dma_en\t\t\t:1;\n\t\tu32 alg_done\t\t\t:1;\n\t\tu32 rsvd_1\t\t\t:3;\n\t\tu32 clear\t\t\t:1;\n\t\tu32 rsvd_2\t\t\t:23;\n\t};\n};\n\nstruct starfive_cryp_ctx {\n\tstruct starfive_cryp_dev\t\t*cryp;\n\tstruct starfive_cryp_request_ctx\t*rctx;\n\n\tunsigned int\t\t\t\thash_mode;\n\tu8\t\t\t\t\tkey[MAX_KEY_SIZE];\n\tint\t\t\t\t\tkeylen;\n\tbool\t\t\t\t\tis_hmac;\n\tstruct starfive_rsa_key\t\t\trsa_key;\n\tstruct crypto_akcipher\t\t\t*akcipher_fbk;\n\tstruct crypto_ahash\t\t\t*ahash_fbk;\n\tstruct crypto_aead\t\t\t*aead_fbk;\n};\n\nstruct starfive_cryp_dev {\n\tstruct list_head\t\t\tlist;\n\tstruct device\t\t\t\t*dev;\n\tstruct clk\t\t\t\t*hclk;\n\tstruct clk\t\t\t\t*ahb;\n\tstruct reset_control\t\t\t*rst;\n\n\tvoid __iomem\t\t\t\t*base;\n\tphys_addr_t\t\t\t\tphys_base;\n\n\tu32\t\t\t\t\tdma_maxburst;\n\tstruct dma_chan\t\t\t\t*tx;\n\tstruct dma_chan\t\t\t\t*rx;\n\tstruct dma_slave_config\t\t\tcfg_in;\n\tstruct dma_slave_config\t\t\tcfg_out;\n\tstruct scatter_walk\t\t\tin_walk;\n\tstruct scatter_walk\t\t\tout_walk;\n\tstruct crypto_engine\t\t\t*engine;\n\tstruct tasklet_struct\t\t\taes_done;\n\tstruct tasklet_struct\t\t\thash_done;\n\tstruct completion\t\t\tpka_done;\n\tsize_t\t\t\t\t\tassoclen;\n\tsize_t\t\t\t\t\ttotal_in;\n\tsize_t\t\t\t\t\ttotal_out;\n\tu32\t\t\t\t\ttag_in[4];\n\tu32\t\t\t\t\ttag_out[4];\n\tunsigned int\t\t\t\tauthsize;\n\tunsigned long\t\t\t\tflags;\n\tint\t\t\t\t\terr;\n\tbool\t\t\t\t\tside_chan;\n\tunion starfive_alg_cr\t\t\talg_cr;\n\tunion {\n\t\tstruct ahash_request\t\t*hreq;\n\t\tstruct aead_request\t\t*areq;\n\t\tstruct skcipher_request\t\t*sreq;\n\t} req;\n};\n\nstruct starfive_cryp_request_ctx {\n\tunion {\n\t\tunion starfive_hash_csr\t\thash;\n\t\tunion starfive_pka_cacr\t\tpka;\n\t\tunion starfive_aes_csr\t\taes;\n\t} csr;\n\n\tstruct scatterlist\t\t\t*in_sg;\n\tstruct scatterlist\t\t\t*out_sg;\n\tstruct ahash_request\t\t\tahash_fbk_req;\n\tsize_t\t\t\t\t\ttotal;\n\tsize_t\t\t\t\t\tnents;\n\tunsigned int\t\t\t\tblksize;\n\tunsigned int\t\t\t\tdigsize;\n\tunsigned long\t\t\t\tin_sg_len;\n\tunsigned char\t\t\t\t*adata;\n\tu8 rsa_data[] __aligned(sizeof(u32));\n};\n\nstruct starfive_cryp_dev *starfive_cryp_find_dev(struct starfive_cryp_ctx *ctx);\n\nint starfive_hash_register_algs(void);\nvoid starfive_hash_unregister_algs(void);\n\nint starfive_rsa_register_algs(void);\nvoid starfive_rsa_unregister_algs(void);\n\nint starfive_aes_register_algs(void);\nvoid starfive_aes_unregister_algs(void);\n\nvoid starfive_hash_done_task(unsigned long param);\nvoid starfive_aes_done_task(unsigned long param);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}