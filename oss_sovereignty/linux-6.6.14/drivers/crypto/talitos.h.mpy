{
  "module_name": "talitos.h",
  "hash_id": "525e565e1b374d829c84254ab157e79620f4384122457e114913bbd80e9b9460",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/talitos.h",
  "human_readable_source": " \n \n\n#define TALITOS_TIMEOUT 100000\n#define TALITOS1_MAX_DATA_LEN 32768\n#define TALITOS2_MAX_DATA_LEN 65535\n\n#define DESC_TYPE(desc_hdr) ((be32_to_cpu(desc_hdr) >> 3) & 0x1f)\n#define PRIMARY_EU(desc_hdr) ((be32_to_cpu(desc_hdr) >> 28) & 0xf)\n#define SECONDARY_EU(desc_hdr) ((be32_to_cpu(desc_hdr) >> 16) & 0xf)\n\n \nstruct talitos_ptr {\n\tunion {\n\t\tstruct {\t\t \n\t\t\t__be16 len;      \n\t\t\tu8 j_extent;     \n\t\t\tu8 eptr;         \n\t\t};\n\t\tstruct {\t\t\t \n\t\t\t__be16 res;\n\t\t\t__be16 len1;\t \n\t\t};\n\t};\n\t__be32 ptr;      \n};\n\n \nstruct talitos_desc {\n\t__be32 hdr;                      \n\tunion {\n\t\t__be32 hdr_lo;\t\t \n\t\t__be32 hdr1;\t\t \n\t};\n\tstruct talitos_ptr ptr[7];       \n\t__be32 next_desc;\t\t \n};\n\n#define TALITOS_DESC_SIZE\t(sizeof(struct talitos_desc) - sizeof(__be32))\n\n \nstruct talitos_edesc {\n\tint src_nents;\n\tint dst_nents;\n\tdma_addr_t iv_dma;\n\tint dma_len;\n\tdma_addr_t dma_link_tbl;\n\tstruct talitos_desc desc;\n\tunion {\n\t\tDECLARE_FLEX_ARRAY(struct talitos_ptr, link_tbl);\n\t\tDECLARE_FLEX_ARRAY(u8, buf);\n\t};\n};\n\n \nstruct talitos_request {\n\tstruct talitos_desc *desc;\n\tdma_addr_t dma_desc;\n\tvoid (*callback) (struct device *dev, struct talitos_desc *desc,\n\t\t\t  void *context, int error);\n\tvoid *context;\n};\n\n \nstruct talitos_channel {\n\tvoid __iomem *reg;\n\n\t \n\tstruct talitos_request *fifo;\n\n\t \n\tatomic_t submit_count ____cacheline_aligned;\n\n\t \n\tspinlock_t head_lock ____cacheline_aligned;\n\t \n\tint head;\n\n\t \n\tspinlock_t tail_lock ____cacheline_aligned;\n\t \n\tint tail;\n};\n\nstruct talitos_private {\n\tstruct device *dev;\n\tstruct platform_device *ofdev;\n\tvoid __iomem *reg;\n\tvoid __iomem *reg_deu;\n\tvoid __iomem *reg_aesu;\n\tvoid __iomem *reg_mdeu;\n\tvoid __iomem *reg_afeu;\n\tvoid __iomem *reg_rngu;\n\tvoid __iomem *reg_pkeu;\n\tvoid __iomem *reg_keu;\n\tvoid __iomem *reg_crcu;\n\tint irq[2];\n\n\t \n\tspinlock_t reg_lock ____cacheline_aligned;\n\n\t \n\tunsigned int num_channels;\n\tunsigned int chfifo_len;\n\tunsigned int exec_units;\n\tunsigned int desc_types;\n\n\t \n\tunsigned long features;\n\n\t \n\tunsigned int fifo_len;\n\n\tstruct talitos_channel *chan;\n\n\t \n\tatomic_t last_chan ____cacheline_aligned;\n\n\t \n\tstruct tasklet_struct done_task[2];\n\n\t \n\tstruct list_head alg_list;\n\n\t \n\tstruct hwrng rng;\n\tbool rng_registered;\n};\n\n \n#define TALITOS_FTR_SRC_LINK_TBL_LEN_INCLUDES_EXTENT 0x00000001\n#define TALITOS_FTR_HW_AUTH_CHECK 0x00000002\n#define TALITOS_FTR_SHA224_HWINIT 0x00000004\n#define TALITOS_FTR_HMAC_OK 0x00000008\n#define TALITOS_FTR_SEC1 0x00000010\n\n \nstatic inline bool has_ftr_sec1(struct talitos_private *priv)\n{\n\tif (IS_ENABLED(CONFIG_CRYPTO_DEV_TALITOS1) &&\n\t    IS_ENABLED(CONFIG_CRYPTO_DEV_TALITOS2))\n\t\treturn priv->features & TALITOS_FTR_SEC1;\n\n\treturn IS_ENABLED(CONFIG_CRYPTO_DEV_TALITOS1);\n}\n\n \n\n#define ISR1_FORMAT(x)\t\t\t(((x) << 28) | ((x) << 16))\n#define ISR2_FORMAT(x)\t\t\t(((x) << 4) | (x))\n\n \n#define TALITOS_MCR\t\t\t0x1030   \n#define   TALITOS_MCR_RCA0\t\t(1 << 15)  \n#define   TALITOS_MCR_RCA1\t\t(1 << 14)  \n#define   TALITOS_MCR_RCA2\t\t(1 << 13)  \n#define   TALITOS_MCR_RCA3\t\t(1 << 12)  \n#define   TALITOS1_MCR_SWR\t\t0x1000000      \n#define   TALITOS2_MCR_SWR\t\t0x1      \n#define TALITOS_MCR_LO\t\t\t0x1034\n#define TALITOS_IMR\t\t\t0x1008   \n \n#define   TALITOS1_IMR_INIT\t\tISR1_FORMAT(0xf)\n#define   TALITOS1_IMR_DONE\t\tISR1_FORMAT(0x5)  \n \n#define   TALITOS2_IMR_INIT\t\t(ISR2_FORMAT(0xf) | 0x10000)\n#define   TALITOS2_IMR_DONE\t\tISR1_FORMAT(0x5)  \n#define TALITOS_IMR_LO\t\t\t0x100C\n#define   TALITOS1_IMR_LO_INIT\t\t0x2000000  \n#define   TALITOS2_IMR_LO_INIT\t\t0x20000  \n#define TALITOS_ISR\t\t\t0x1010   \n#define   TALITOS1_ISR_4CHERR\t\tISR1_FORMAT(0xa)  \n#define   TALITOS1_ISR_4CHDONE\t\tISR1_FORMAT(0x5)  \n#define   TALITOS1_ISR_CH_0_ERR\t\t(2 << 28)  \n#define   TALITOS1_ISR_CH_0_DONE\t(1 << 28)  \n#define   TALITOS1_ISR_TEA_ERR\t\t0x00000040\n#define   TALITOS2_ISR_4CHERR\t\tISR2_FORMAT(0xa)  \n#define   TALITOS2_ISR_4CHDONE\t\tISR2_FORMAT(0x5)  \n#define   TALITOS2_ISR_CH_0_ERR\t\t2  \n#define   TALITOS2_ISR_CH_0_DONE\t1  \n#define   TALITOS2_ISR_CH_0_2_ERR\tISR2_FORMAT(0x2)  \n#define   TALITOS2_ISR_CH_0_2_DONE\tISR2_FORMAT(0x1)  \n#define   TALITOS2_ISR_CH_1_3_ERR\tISR2_FORMAT(0x8)  \n#define   TALITOS2_ISR_CH_1_3_DONE\tISR2_FORMAT(0x4)  \n#define TALITOS_ISR_LO\t\t\t0x1014\n#define TALITOS_ICR\t\t\t0x1018   \n#define TALITOS_ICR_LO\t\t\t0x101C\n\n \n#define TALITOS_CH_BASE_OFFSET\t\t0x1000\t \n#define TALITOS1_CH_STRIDE\t\t0x1000\n#define TALITOS2_CH_STRIDE\t\t0x100\n\n \n#define TALITOS_CCCR\t\t\t0x8\n#define   TALITOS2_CCCR_CONT\t\t0x2     \n#define   TALITOS2_CCCR_RESET\t\t0x1     \n#define TALITOS_CCCR_LO\t\t\t0xc\n#define   TALITOS_CCCR_LO_IWSE\t\t0x80    \n#define   TALITOS_CCCR_LO_EAE\t\t0x20    \n#define   TALITOS_CCCR_LO_CDWE\t\t0x10    \n#define   TALITOS_CCCR_LO_NE\t\t0x8     \n#define   TALITOS_CCCR_LO_NT\t\t0x4     \n#define   TALITOS_CCCR_LO_CDIE\t\t0x2     \n#define   TALITOS1_CCCR_LO_RESET\t0x1     \n\n \n#define TALITOS_CCPSR\t\t\t0x10\n#define TALITOS_CCPSR_LO\t\t0x14\n#define   TALITOS_CCPSR_LO_DOF\t\t0x8000  \n#define   TALITOS_CCPSR_LO_SOF\t\t0x4000  \n#define   TALITOS_CCPSR_LO_MDTE\t\t0x2000  \n#define   TALITOS_CCPSR_LO_SGDLZ\t0x1000  \n#define   TALITOS_CCPSR_LO_FPZ\t\t0x0800  \n#define   TALITOS_CCPSR_LO_IDH\t\t0x0400  \n#define   TALITOS_CCPSR_LO_IEU\t\t0x0200  \n#define   TALITOS_CCPSR_LO_EU\t\t0x0100  \n#define   TALITOS_CCPSR_LO_GB\t\t0x0080  \n#define   TALITOS_CCPSR_LO_GRL\t\t0x0040  \n#define   TALITOS_CCPSR_LO_SB\t\t0x0020  \n#define   TALITOS_CCPSR_LO_SRL\t\t0x0010  \n\n \n#define TALITOS_FF\t\t\t0x48\n#define TALITOS_FF_LO\t\t\t0x4c\n\n \n#define TALITOS_CDPR\t\t\t0x40\n#define TALITOS_CDPR_LO\t\t\t0x44\n\n \n#define TALITOS_DESCBUF\t\t\t0x80\n#define TALITOS_DESCBUF_LO\t\t0x84\n\n \n#define TALITOS_GATHER\t\t\t0xc0\n#define TALITOS_GATHER_LO\t\t0xc4\n\n \n#define TALITOS_SCATTER\t\t\t0xe0\n#define TALITOS_SCATTER_LO\t\t0xe4\n\n \n#define TALITOS2_DEU\t\t\t0x2000\n#define TALITOS2_AESU\t\t\t0x4000\n#define TALITOS2_MDEU\t\t\t0x6000\n#define TALITOS2_AFEU\t\t\t0x8000\n#define TALITOS2_RNGU\t\t\t0xa000\n#define TALITOS2_PKEU\t\t\t0xc000\n#define TALITOS2_KEU\t\t\t0xe000\n#define TALITOS2_CRCU\t\t\t0xf000\n\n#define TALITOS12_AESU\t\t\t0x4000\n#define TALITOS12_DEU\t\t\t0x5000\n#define TALITOS12_MDEU\t\t\t0x6000\n\n#define TALITOS10_AFEU\t\t\t0x8000\n#define TALITOS10_DEU\t\t\t0xa000\n#define TALITOS10_MDEU\t\t\t0xc000\n#define TALITOS10_RNGU\t\t\t0xe000\n#define TALITOS10_PKEU\t\t\t0x10000\n#define TALITOS10_AESU\t\t\t0x12000\n\n \n#define TALITOS_EUDSR\t\t\t0x10\t \n#define TALITOS_EUDSR_LO\t\t0x14\n#define TALITOS_EURCR\t\t\t0x18  \n#define TALITOS_EURCR_LO\t\t0x1c\n#define TALITOS_EUSR\t\t\t0x28  \n#define TALITOS_EUSR_LO\t\t\t0x2c\n#define TALITOS_EUISR\t\t\t0x30\n#define TALITOS_EUISR_LO\t\t0x34\n#define TALITOS_EUICR\t\t\t0x38  \n#define TALITOS_EUICR_LO\t\t0x3c\n#define TALITOS_EU_FIFO\t\t\t0x800  \n#define TALITOS_EU_FIFO_LO\t\t0x804  \n \n#define   TALITOS1_DEUICR_KPE\t\t0x00200000  \n \n#define   TALITOS_MDEUICR_LO_ICE\t0x4000  \n \n#define   TALITOS_RNGUSR_LO_RD\t\t0x1\t \n#define   TALITOS_RNGUSR_LO_OFL\t\t0xff0000 \n#define   TALITOS_RNGURCR_LO_SR\t\t0x1\t \n\n#define TALITOS_MDEU_CONTEXT_SIZE_MD5_SHA1_SHA256\t0x28\n#define TALITOS_MDEU_CONTEXT_SIZE_SHA384_SHA512\t\t0x48\n\n \n\n \n#define DESC_HDR_DONE\t\t\tcpu_to_be32(0xff000000)\n#define DESC_HDR_LO_ICCR1_MASK\t\tcpu_to_be32(0x00180000)\n#define DESC_HDR_LO_ICCR1_PASS\t\tcpu_to_be32(0x00080000)\n#define DESC_HDR_LO_ICCR1_FAIL\t\tcpu_to_be32(0x00100000)\n\n \n#define\tDESC_HDR_SEL0_MASK\t\tcpu_to_be32(0xf0000000)\n#define\tDESC_HDR_SEL0_AFEU\t\tcpu_to_be32(0x10000000)\n#define\tDESC_HDR_SEL0_DEU\t\tcpu_to_be32(0x20000000)\n#define\tDESC_HDR_SEL0_MDEUA\t\tcpu_to_be32(0x30000000)\n#define\tDESC_HDR_SEL0_MDEUB\t\tcpu_to_be32(0xb0000000)\n#define\tDESC_HDR_SEL0_RNG\t\tcpu_to_be32(0x40000000)\n#define\tDESC_HDR_SEL0_PKEU\t\tcpu_to_be32(0x50000000)\n#define\tDESC_HDR_SEL0_AESU\t\tcpu_to_be32(0x60000000)\n#define\tDESC_HDR_SEL0_KEU\t\tcpu_to_be32(0x70000000)\n#define\tDESC_HDR_SEL0_CRCU\t\tcpu_to_be32(0x80000000)\n\n \n#define\tDESC_HDR_MODE0_ENCRYPT\t\tcpu_to_be32(0x00100000)\n#define\tDESC_HDR_MODE0_AESU_MASK\tcpu_to_be32(0x00600000)\n#define\tDESC_HDR_MODE0_AESU_CBC\t\tcpu_to_be32(0x00200000)\n#define\tDESC_HDR_MODE0_AESU_CTR\t\tcpu_to_be32(0x00600000)\n#define\tDESC_HDR_MODE0_DEU_CBC\t\tcpu_to_be32(0x00400000)\n#define\tDESC_HDR_MODE0_DEU_3DES\t\tcpu_to_be32(0x00200000)\n#define\tDESC_HDR_MODE0_MDEU_CONT\tcpu_to_be32(0x08000000)\n#define\tDESC_HDR_MODE0_MDEU_INIT\tcpu_to_be32(0x01000000)\n#define\tDESC_HDR_MODE0_MDEU_HMAC\tcpu_to_be32(0x00800000)\n#define\tDESC_HDR_MODE0_MDEU_PAD\t\tcpu_to_be32(0x00400000)\n#define\tDESC_HDR_MODE0_MDEU_SHA224\tcpu_to_be32(0x00300000)\n#define\tDESC_HDR_MODE0_MDEU_MD5\t\tcpu_to_be32(0x00200000)\n#define\tDESC_HDR_MODE0_MDEU_SHA256\tcpu_to_be32(0x00100000)\n#define\tDESC_HDR_MODE0_MDEU_SHA1\tcpu_to_be32(0x00000000)\n#define\tDESC_HDR_MODE0_MDEUB_SHA384\tcpu_to_be32(0x00000000)\n#define\tDESC_HDR_MODE0_MDEUB_SHA512\tcpu_to_be32(0x00200000)\n#define\tDESC_HDR_MODE0_MDEU_MD5_HMAC\t(DESC_HDR_MODE0_MDEU_MD5 | \\\n\t\t\t\t\t DESC_HDR_MODE0_MDEU_HMAC)\n#define\tDESC_HDR_MODE0_MDEU_SHA256_HMAC\t(DESC_HDR_MODE0_MDEU_SHA256 | \\\n\t\t\t\t\t DESC_HDR_MODE0_MDEU_HMAC)\n#define\tDESC_HDR_MODE0_MDEU_SHA1_HMAC\t(DESC_HDR_MODE0_MDEU_SHA1 | \\\n\t\t\t\t\t DESC_HDR_MODE0_MDEU_HMAC)\n\n \n#define\tDESC_HDR_SEL1_MASK\t\tcpu_to_be32(0x000f0000)\n#define\tDESC_HDR_SEL1_MDEUA\t\tcpu_to_be32(0x00030000)\n#define\tDESC_HDR_SEL1_MDEUB\t\tcpu_to_be32(0x000b0000)\n#define\tDESC_HDR_SEL1_CRCU\t\tcpu_to_be32(0x00080000)\n\n \n#define\tDESC_HDR_MODE1_MDEU_CICV\tcpu_to_be32(0x00004000)\n#define\tDESC_HDR_MODE1_MDEU_INIT\tcpu_to_be32(0x00001000)\n#define\tDESC_HDR_MODE1_MDEU_HMAC\tcpu_to_be32(0x00000800)\n#define\tDESC_HDR_MODE1_MDEU_PAD\t\tcpu_to_be32(0x00000400)\n#define\tDESC_HDR_MODE1_MDEU_SHA224\tcpu_to_be32(0x00000300)\n#define\tDESC_HDR_MODE1_MDEU_MD5\t\tcpu_to_be32(0x00000200)\n#define\tDESC_HDR_MODE1_MDEU_SHA256\tcpu_to_be32(0x00000100)\n#define\tDESC_HDR_MODE1_MDEU_SHA1\tcpu_to_be32(0x00000000)\n#define\tDESC_HDR_MODE1_MDEUB_SHA384\tcpu_to_be32(0x00000000)\n#define\tDESC_HDR_MODE1_MDEUB_SHA512\tcpu_to_be32(0x00000200)\n#define\tDESC_HDR_MODE1_MDEU_MD5_HMAC\t(DESC_HDR_MODE1_MDEU_MD5 | \\\n\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n#define\tDESC_HDR_MODE1_MDEU_SHA256_HMAC\t(DESC_HDR_MODE1_MDEU_SHA256 | \\\n\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n#define\tDESC_HDR_MODE1_MDEU_SHA1_HMAC\t(DESC_HDR_MODE1_MDEU_SHA1 | \\\n\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n#define DESC_HDR_MODE1_MDEU_SHA224_HMAC\t(DESC_HDR_MODE1_MDEU_SHA224 | \\\n\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n#define DESC_HDR_MODE1_MDEUB_SHA384_HMAC\t(DESC_HDR_MODE1_MDEUB_SHA384 | \\\n\t\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n#define DESC_HDR_MODE1_MDEUB_SHA512_HMAC\t(DESC_HDR_MODE1_MDEUB_SHA512 | \\\n\t\t\t\t\t\t DESC_HDR_MODE1_MDEU_HMAC)\n\n \n#define\tDESC_HDR_DIR_INBOUND\t\tcpu_to_be32(0x00000002)\n\n \n#define\tDESC_HDR_DONE_NOTIFY\t\tcpu_to_be32(0x00000001)\n\n \n#define DESC_HDR_TYPE_AESU_CTR_NONSNOOP\t\tcpu_to_be32(0 << 3)\n#define DESC_HDR_TYPE_IPSEC_ESP\t\t\tcpu_to_be32(1 << 3)\n#define DESC_HDR_TYPE_COMMON_NONSNOOP_NO_AFEU\tcpu_to_be32(2 << 3)\n#define DESC_HDR_TYPE_HMAC_SNOOP_NO_AFEU\tcpu_to_be32(4 << 3)\n\n \n#define DESC_PTR_LNKTBL_JUMP\t\t\t0x80\n#define DESC_PTR_LNKTBL_RET\t\t\t0x02\n#define DESC_PTR_LNKTBL_NEXT\t\t\t0x01\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}