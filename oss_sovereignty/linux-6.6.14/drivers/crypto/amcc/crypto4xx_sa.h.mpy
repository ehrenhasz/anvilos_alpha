{
  "module_name": "crypto4xx_sa.h",
  "hash_id": "0b9dd381ddaac863da57a8e44a08430d42d212853a457279e866054c5cd5fdbd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/amcc/crypto4xx_sa.h",
  "human_readable_source": " \n \n\n#ifndef __CRYPTO4XX_SA_H__\n#define __CRYPTO4XX_SA_H__\n\n#define AES_IV_SIZE\t\t\t\t16\n\n \nunion dynamic_sa_contents {\n\tstruct {\n\t\tu32 arc4_state_ptr:1;\n\t\tu32 arc4_ij_ptr:1;\n\t\tu32 state_ptr:1;\n\t\tu32 iv3:1;\n\t\tu32 iv2:1;\n\t\tu32 iv1:1;\n\t\tu32 iv0:1;\n\t\tu32 seq_num_mask3:1;\n\t\tu32 seq_num_mask2:1;\n\t\tu32 seq_num_mask1:1;\n\t\tu32 seq_num_mask0:1;\n\t\tu32 seq_num1:1;\n\t\tu32 seq_num0:1;\n\t\tu32 spi:1;\n\t\tu32 outer_size:5;\n\t\tu32 inner_size:5;\n\t\tu32 key_size:4;\n\t\tu32 cmd_size:4;\n\t} bf;\n\tu32 w;\n} __attribute__((packed));\n\n#define DIR_OUTBOUND\t\t\t\t0\n#define DIR_INBOUND\t\t\t\t1\n#define SA_OP_GROUP_BASIC\t\t\t0\n#define SA_OPCODE_ENCRYPT\t\t\t0\n#define SA_OPCODE_DECRYPT\t\t\t0\n#define SA_OPCODE_ENCRYPT_HASH\t\t\t1\n#define SA_OPCODE_HASH_DECRYPT\t\t\t1\n#define SA_OPCODE_HASH\t\t\t\t3\n#define SA_CIPHER_ALG_DES\t\t\t0\n#define SA_CIPHER_ALG_3DES\t\t\t1\n#define SA_CIPHER_ALG_ARC4\t\t\t2\n#define SA_CIPHER_ALG_AES\t\t\t3\n#define SA_CIPHER_ALG_KASUMI\t\t\t4\n#define SA_CIPHER_ALG_NULL\t\t\t15\n\n#define SA_HASH_ALG_MD5\t\t\t\t0\n#define SA_HASH_ALG_SHA1\t\t\t1\n#define SA_HASH_ALG_GHASH\t\t\t12\n#define SA_HASH_ALG_CBC_MAC\t\t\t14\n#define SA_HASH_ALG_NULL\t\t\t15\n#define SA_HASH_ALG_SHA1_DIGEST_SIZE\t\t20\n\n#define SA_LOAD_HASH_FROM_SA\t\t\t0\n#define SA_LOAD_HASH_FROM_STATE\t\t\t2\n#define SA_NOT_LOAD_HASH\t\t\t3\n#define SA_LOAD_IV_FROM_SA\t\t\t0\n#define SA_LOAD_IV_FROM_INPUT\t\t\t1\n#define SA_LOAD_IV_FROM_STATE\t\t\t2\n#define SA_LOAD_IV_GEN_IV\t\t\t3\n\n#define SA_PAD_TYPE_CONSTANT\t\t\t2\n#define SA_PAD_TYPE_ZERO\t\t\t3\n#define SA_PAD_TYPE_TLS\t\t\t\t5\n#define SA_PAD_TYPE_DTLS\t\t\t5\n#define SA_NOT_SAVE_HASH\t\t\t0\n#define SA_SAVE_HASH\t\t\t\t1\n#define SA_NOT_SAVE_IV\t\t\t\t0\n#define SA_SAVE_IV\t\t\t\t1\n#define SA_HEADER_PROC\t\t\t\t1\n#define SA_NO_HEADER_PROC\t\t\t0\n\nunion sa_command_0 {\n\tstruct {\n\t\tu32 scatter:1;\n\t\tu32 gather:1;\n\t\tu32 save_hash_state:1;\n\t\tu32 save_iv:1;\n\t\tu32 load_hash_state:2;\n\t\tu32 load_iv:2;\n\t\tu32 digest_len:4;\n\t\tu32 hdr_proc:1;\n\t\tu32 extend_pad:1;\n\t\tu32 stream_cipher_pad:1;\n\t\tu32 rsv:1;\n\t\tu32 hash_alg:4;\n\t\tu32 cipher_alg:4;\n\t\tu32 pad_type:2;\n\t\tu32 op_group:2;\n\t\tu32 dir:1;\n\t\tu32 opcode:3;\n\t} bf;\n\tu32 w;\n} __attribute__((packed));\n\n#define CRYPTO_MODE_ECB\t\t\t\t0\n#define CRYPTO_MODE_CBC\t\t\t\t1\n#define CRYPTO_MODE_OFB\t\t\t\t2\n#define CRYPTO_MODE_CFB\t\t\t\t3\n#define CRYPTO_MODE_CTR\t\t\t\t4\n\n#define CRYPTO_FEEDBACK_MODE_NO_FB\t\t0\n#define CRYPTO_FEEDBACK_MODE_64BIT_OFB\t\t0\n#define CRYPTO_FEEDBACK_MODE_8BIT_CFB\t\t1\n#define CRYPTO_FEEDBACK_MODE_1BIT_CFB\t\t2\n#define CRYPTO_FEEDBACK_MODE_128BIT_CFB\t\t3\n\n#define SA_AES_KEY_LEN_128\t\t\t2\n#define SA_AES_KEY_LEN_192\t\t\t3\n#define SA_AES_KEY_LEN_256\t\t\t4\n\n#define SA_REV2\t\t\t\t\t1\n \n#define SA_HASH_MODE_HASH\t\t\t0\n#define SA_HASH_MODE_HMAC\t\t\t1\n#define SA_MC_ENABLE\t\t\t\t0\n#define SA_MC_DISABLE\t\t\t\t1\n#define SA_NOT_COPY_HDR\t\t\t\t0\n#define SA_COPY_HDR\t\t\t\t1\n#define SA_NOT_COPY_PAD\t\t\t\t0\n#define SA_COPY_PAD\t\t\t\t1\n#define SA_NOT_COPY_PAYLOAD\t\t\t0\n#define SA_COPY_PAYLOAD\t\t\t\t1\n#define SA_EXTENDED_SN_OFF\t\t\t0\n#define SA_EXTENDED_SN_ON\t\t\t1\n#define SA_SEQ_MASK_OFF\t\t\t\t0\n#define SA_SEQ_MASK_ON\t\t\t\t1\n\nunion sa_command_1 {\n\tstruct {\n\t\tu32 crypto_mode31:1;\n\t\tu32 save_arc4_state:1;\n\t\tu32 arc4_stateful:1;\n\t\tu32 key_len:5;\n\t\tu32 hash_crypto_offset:8;\n\t\tu32 sa_rev:2;\n\t\tu32 byte_offset:1;\n\t\tu32 hmac_muting:1;\n\t\tu32 feedback_mode:2;\n\t\tu32 crypto_mode9_8:2;\n\t\tu32 extended_seq_num:1;\n\t\tu32 seq_num_mask:1;\n\t\tu32 mutable_bit_proc:1;\n\t\tu32 ip_version:1;\n\t\tu32 copy_pad:1;\n\t\tu32 copy_payload:1;\n\t\tu32 copy_hdr:1;\n\t\tu32 rsv1:1;\n\t} bf;\n\tu32 w;\n} __attribute__((packed));\n\nstruct dynamic_sa_ctl {\n\tunion dynamic_sa_contents sa_contents;\n\tunion sa_command_0 sa_command_0;\n\tunion sa_command_1 sa_command_1;\n} __attribute__((packed));\n\n \nstruct  sa_state_record {\n\t__le32 save_iv[4];\n\t__le32 save_hash_byte_cnt[2];\n\tunion {\n\t\tu32 save_digest[16];  \n\t\t__le32 save_digest_le32[16];  \n\t};\n} __attribute__((packed));\n\n \nstruct dynamic_sa_aes128 {\n\tstruct dynamic_sa_ctl\tctrl;\n\t__le32 key[4];\n\t__le32 iv[4];  \n\tu32 state_ptr;\n\tu32 reserved;\n} __attribute__((packed));\n\n#define SA_AES128_LEN\t\t(sizeof(struct dynamic_sa_aes128)/4)\n#define SA_AES128_CONTENTS\t0x3e000042\n\n \nstruct dynamic_sa_aes192 {\n\tstruct dynamic_sa_ctl ctrl;\n\t__le32 key[6];\n\t__le32 iv[4];  \n\tu32 state_ptr;\n\tu32 reserved;\n} __attribute__((packed));\n\n#define SA_AES192_LEN\t\t(sizeof(struct dynamic_sa_aes192)/4)\n#define SA_AES192_CONTENTS\t0x3e000062\n\n \nstruct dynamic_sa_aes256 {\n\tstruct dynamic_sa_ctl ctrl;\n\t__le32 key[8];\n\t__le32 iv[4];  \n\tu32 state_ptr;\n\tu32 reserved;\n} __attribute__((packed));\n\n#define SA_AES256_LEN\t\t(sizeof(struct dynamic_sa_aes256)/4)\n#define SA_AES256_CONTENTS\t0x3e000082\n#define SA_AES_CONTENTS\t\t0x3e000002\n\n \nstruct dynamic_sa_aes128_ccm {\n\tstruct dynamic_sa_ctl ctrl;\n\t__le32 key[4];\n\t__le32 iv[4];\n\tu32 state_ptr;\n\tu32 reserved;\n} __packed;\n#define SA_AES128_CCM_LEN\t(sizeof(struct dynamic_sa_aes128_ccm)/4)\n#define SA_AES128_CCM_CONTENTS\t0x3e000042\n#define SA_AES_CCM_CONTENTS\t0x3e000002\n\n \nstruct dynamic_sa_aes128_gcm {\n\tstruct dynamic_sa_ctl ctrl;\n\t__le32 key[4];\n\t__le32 inner_digest[4];\n\t__le32 iv[4];\n\tu32 state_ptr;\n\tu32 reserved;\n} __packed;\n\n#define SA_AES128_GCM_LEN\t(sizeof(struct dynamic_sa_aes128_gcm)/4)\n#define SA_AES128_GCM_CONTENTS\t0x3e000442\n#define SA_AES_GCM_CONTENTS\t0x3e000402\n\n \nstruct dynamic_sa_hash160 {\n\tstruct dynamic_sa_ctl ctrl;\n\t__le32 inner_digest[5];\n\t__le32 outer_digest[5];\n\tu32 state_ptr;\n\tu32 reserved;\n} __attribute__((packed));\n#define SA_HASH160_LEN\t\t(sizeof(struct dynamic_sa_hash160)/4)\n#define SA_HASH160_CONTENTS     0x2000a502\n\nstatic inline u32\nget_dynamic_sa_offset_state_ptr_field(struct dynamic_sa_ctl *cts)\n{\n\tu32 offset;\n\n\toffset = cts->sa_contents.bf.key_size\n\t\t+ cts->sa_contents.bf.inner_size\n\t\t+ cts->sa_contents.bf.outer_size\n\t\t+ cts->sa_contents.bf.spi\n\t\t+ cts->sa_contents.bf.seq_num0\n\t\t+ cts->sa_contents.bf.seq_num1\n\t\t+ cts->sa_contents.bf.seq_num_mask0\n\t\t+ cts->sa_contents.bf.seq_num_mask1\n\t\t+ cts->sa_contents.bf.seq_num_mask2\n\t\t+ cts->sa_contents.bf.seq_num_mask3\n\t\t+ cts->sa_contents.bf.iv0\n\t\t+ cts->sa_contents.bf.iv1\n\t\t+ cts->sa_contents.bf.iv2\n\t\t+ cts->sa_contents.bf.iv3;\n\n\treturn sizeof(struct dynamic_sa_ctl) + offset * 4;\n}\n\nstatic inline __le32 *get_dynamic_sa_key_field(struct dynamic_sa_ctl *cts)\n{\n\treturn (__le32 *) ((unsigned long)cts + sizeof(struct dynamic_sa_ctl));\n}\n\nstatic inline __le32 *get_dynamic_sa_inner_digest(struct dynamic_sa_ctl *cts)\n{\n\treturn (__le32 *) ((unsigned long)cts +\n\t\tsizeof(struct dynamic_sa_ctl) +\n\t\tcts->sa_contents.bf.key_size * 4);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}