{
  "module_name": "virtio_crypto_common.h",
  "hash_id": "05f27a5f3fd62747c411acfc3bedc201c4ebc3ef72dc58799d54ba33e2933eda",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/virtio/virtio_crypto_common.h",
  "human_readable_source": " \n \n\n#ifndef _VIRTIO_CRYPTO_COMMON_H\n#define _VIRTIO_CRYPTO_COMMON_H\n\n#include <linux/virtio.h>\n#include <linux/crypto.h>\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <crypto/aead.h>\n#include <crypto/aes.h>\n#include <crypto/engine.h>\n#include <uapi/linux/virtio_crypto.h>\n\n\n \nstruct data_queue {\n\t \n\tstruct virtqueue *vq;\n\n\t \n\tspinlock_t lock;\n\n\t \n\tchar name[32];\n\n\tstruct crypto_engine *engine;\n\tstruct tasklet_struct done_task;\n};\n\nstruct virtio_crypto {\n\tstruct virtio_device *vdev;\n\tstruct virtqueue *ctrl_vq;\n\tstruct data_queue *data_vq;\n\n\t \n\tstruct work_struct config_work;\n\n\t \n\tspinlock_t ctrl_lock;\n\n\t \n\tu32 max_data_queues;\n\n\t \n\tu32 curr_queue;\n\n\t \n\tu32 crypto_services;\n\n\t \n\tu32 cipher_algo_l;\n\tu32 cipher_algo_h;\n\tu32 hash_algo;\n\tu32 mac_algo_l;\n\tu32 mac_algo_h;\n\tu32 aead_algo;\n\tu32 akcipher_algo;\n\n\t \n\tu32 max_cipher_key_len;\n\t \n\tu32 max_auth_key_len;\n\t \n\tu64 max_size;\n\n\tunsigned long status;\n\tatomic_t ref_count;\n\tstruct list_head list;\n\tstruct module *owner;\n\tuint8_t dev_id;\n\n\t \n\tbool affinity_hint_set;\n};\n\nstruct virtio_crypto_sym_session_info {\n\t \n\t__u64 session_id;\n};\n\n \nstruct virtio_crypto_ctrl_request {\n\tstruct virtio_crypto_op_ctrl_req ctrl;\n\tstruct virtio_crypto_session_input input;\n\tstruct virtio_crypto_inhdr ctrl_status;\n\tstruct completion compl;\n};\n\nstruct virtio_crypto_request;\ntypedef void (*virtio_crypto_data_callback)\n\t\t(struct virtio_crypto_request *vc_req, int len);\n\nstruct virtio_crypto_request {\n\tuint8_t status;\n\tstruct virtio_crypto_op_data_req *req_data;\n\tstruct scatterlist **sgs;\n\tstruct data_queue *dataq;\n\tvirtio_crypto_data_callback alg_cb;\n};\n\nint virtcrypto_devmgr_add_dev(struct virtio_crypto *vcrypto_dev);\nstruct list_head *virtcrypto_devmgr_get_head(void);\nvoid virtcrypto_devmgr_rm_dev(struct virtio_crypto *vcrypto_dev);\nstruct virtio_crypto *virtcrypto_devmgr_get_first(void);\nint virtcrypto_dev_in_use(struct virtio_crypto *vcrypto_dev);\nint virtcrypto_dev_get(struct virtio_crypto *vcrypto_dev);\nvoid virtcrypto_dev_put(struct virtio_crypto *vcrypto_dev);\nint virtcrypto_dev_started(struct virtio_crypto *vcrypto_dev);\nbool virtcrypto_algo_is_supported(struct virtio_crypto *vcrypto_dev,\n\t\t\t\t  uint32_t service,\n\t\t\t\t  uint32_t algo);\nstruct virtio_crypto *virtcrypto_get_dev_node(int node,\n\t\t\t\t\t      uint32_t service,\n\t\t\t\t\t      uint32_t algo);\nint virtcrypto_dev_start(struct virtio_crypto *vcrypto);\nvoid virtcrypto_dev_stop(struct virtio_crypto *vcrypto);\nint virtio_crypto_skcipher_crypt_req(\n\tstruct crypto_engine *engine, void *vreq);\n\nvoid\nvirtcrypto_clear_request(struct virtio_crypto_request *vc_req);\n\nstatic inline int virtio_crypto_get_current_node(void)\n{\n\tint cpu, node;\n\n\tcpu = get_cpu();\n\tnode = topology_physical_package_id(cpu);\n\tput_cpu();\n\n\treturn node;\n}\n\nint virtio_crypto_skcipher_algs_register(struct virtio_crypto *vcrypto);\nvoid virtio_crypto_skcipher_algs_unregister(struct virtio_crypto *vcrypto);\nint virtio_crypto_akcipher_algs_register(struct virtio_crypto *vcrypto);\nvoid virtio_crypto_akcipher_algs_unregister(struct virtio_crypto *vcrypto);\nint virtio_crypto_ctrl_vq_request(struct virtio_crypto *vcrypto, struct scatterlist *sgs[],\n\t\t\t\t  unsigned int out_sgs, unsigned int in_sgs,\n\t\t\t\t  struct virtio_crypto_ctrl_request *vc_ctrl_req);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}