{
  "module_name": "spu.h",
  "hash_id": "547856f118fe426a1313b93be335d60551e28ad083002f2263c491b8285f6014",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/bcm/spu.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _SPU_H\n#define _SPU_H\n\n#include <linux/types.h>\n#include <linux/scatterlist.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n\nenum spu_cipher_alg {\n\tCIPHER_ALG_NONE = 0x0,\n\tCIPHER_ALG_RC4 = 0x1,\n\tCIPHER_ALG_DES = 0x2,\n\tCIPHER_ALG_3DES = 0x3,\n\tCIPHER_ALG_AES = 0x4,\n\tCIPHER_ALG_LAST = 0x5\n};\n\nenum spu_cipher_mode {\n\tCIPHER_MODE_NONE = 0x0,\n\tCIPHER_MODE_ECB = 0x0,\n\tCIPHER_MODE_CBC = 0x1,\n\tCIPHER_MODE_OFB = 0x2,\n\tCIPHER_MODE_CFB = 0x3,\n\tCIPHER_MODE_CTR = 0x4,\n\tCIPHER_MODE_CCM = 0x5,\n\tCIPHER_MODE_GCM = 0x6,\n\tCIPHER_MODE_XTS = 0x7,\n\tCIPHER_MODE_LAST = 0x8\n};\n\nenum spu_cipher_type {\n\tCIPHER_TYPE_NONE = 0x0,\n\tCIPHER_TYPE_DES = 0x0,\n\tCIPHER_TYPE_3DES = 0x0,\n\tCIPHER_TYPE_INIT = 0x0,\t \n\tCIPHER_TYPE_AES128 = 0x0,\n\tCIPHER_TYPE_AES192 = 0x1,\n\tCIPHER_TYPE_UPDT = 0x1,\t \n\tCIPHER_TYPE_AES256 = 0x2,\n};\n\nenum hash_alg {\n\tHASH_ALG_NONE = 0x0,\n\tHASH_ALG_MD5 = 0x1,\n\tHASH_ALG_SHA1 = 0x2,\n\tHASH_ALG_SHA224 = 0x3,\n\tHASH_ALG_SHA256 = 0x4,\n\tHASH_ALG_AES = 0x5,\n\tHASH_ALG_SHA384 = 0x6,\n\tHASH_ALG_SHA512 = 0x7,\n\t \n\tHASH_ALG_SHA3_224 = 0x8,\n\tHASH_ALG_SHA3_256 = 0x9,\n\tHASH_ALG_SHA3_384 = 0xa,\n\tHASH_ALG_SHA3_512 = 0xb,\n\tHASH_ALG_LAST\n};\n\nenum hash_mode {\n\tHASH_MODE_NONE = 0x0,\n\tHASH_MODE_HASH = 0x0,\n\tHASH_MODE_XCBC = 0x0,\n\tHASH_MODE_CMAC = 0x1,\n\tHASH_MODE_CTXT = 0x1,\n\tHASH_MODE_HMAC = 0x2,\n\tHASH_MODE_RABIN = 0x4,\n\tHASH_MODE_FHMAC = 0x6,\n\tHASH_MODE_CCM = 0x5,\n\tHASH_MODE_GCM = 0x6,\n};\n\nenum hash_type {\n\tHASH_TYPE_NONE = 0x0,\n\tHASH_TYPE_FULL = 0x0,\n\tHASH_TYPE_INIT = 0x1,\n\tHASH_TYPE_UPDT = 0x2,\n\tHASH_TYPE_FIN = 0x3,\n\tHASH_TYPE_AES128 = 0x0,\n\tHASH_TYPE_AES192 = 0x1,\n\tHASH_TYPE_AES256 = 0x2\n};\n\nenum aead_type {\n\tAES_CCM,\n\tAES_GCM,\n\tAUTHENC,\n\tAEAD_TYPE_LAST\n};\n\nextern char *hash_alg_name[HASH_ALG_LAST];\nextern char *aead_alg_name[AEAD_TYPE_LAST];\n\nstruct spu_request_opts {\n\tbool is_inbound;\n\tbool auth_first;\n\tbool is_aead;\n\tbool is_esp;\n\tbool bd_suppress;\n\tbool is_rfc4543;\n};\n\nstruct spu_cipher_parms {\n\tenum spu_cipher_alg  alg;\n\tenum spu_cipher_mode mode;\n\tenum spu_cipher_type type;\n\tu8                  *key_buf;\n\tu16                  key_len;\n\t \n\tu8                  *iv_buf;\n\tu16                  iv_len;\n};\n\nstruct spu_hash_parms {\n\tenum hash_alg  alg;\n\tenum hash_mode mode;\n\tenum hash_type type;\n\tu8             digestsize;\n\tu8            *key_buf;\n\tu16            key_len;\n\tu16            prebuf_len;\n\t \n\tint            pad_len;\n};\n\nstruct spu_aead_parms {\n\tu32 assoc_size;\n\tu16 iv_len;       \n\tu8  aad_pad_len;  \n\tu8  data_pad_len; \n\tbool return_iv;   \n\tu32 ret_iv_len;   \n\tu32 ret_iv_off;   \n};\n\n \n\n#define SPU_RX_STATUS_LEN  4\n\n \n#define SPU_STAT_PAD_MAX  4\n\n \n#define SPU_PAD_LEN_MAX (SPU_GCM_CCM_ALIGN + MAX_HASH_BLOCK_SIZE + \\\n\t\t\t SPU_STAT_PAD_MAX)\n\n \n#define SPU_GCM_CCM_ALIGN 16\n\n \n#define SPU_SUPDT_LEN 260\n\n \n#define SPU_INVALID_ICV  1\n\n \n#define SPU_MAX_PAYLOAD_INF  0xFFFFFFFF\n\n \n#define SPU_XTS_TWEAK_SIZE 16\n\n \n#define CCM_B0_ADATA\t\t0x40\n#define CCM_B0_ADATA_SHIFT\t   6\n#define CCM_B0_M_PRIME\t\t0x38\n#define CCM_B0_M_PRIME_SHIFT\t   3\n#define CCM_B0_L_PRIME\t\t0x07\n#define CCM_B0_L_PRIME_SHIFT\t   0\n#define CCM_ESP_L_VALUE\t\t   4\n\n \nstatic __always_inline  bool spu_req_incl_icv(enum spu_cipher_mode cipher_mode,\n\t\t\t\t\t      bool is_encrypt)\n{\n\tif ((cipher_mode == CIPHER_MODE_GCM) && !is_encrypt)\n\t\treturn true;\n\tif ((cipher_mode == CIPHER_MODE_CCM) && !is_encrypt)\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic __always_inline u32 spu_real_db_size(u32 assoc_size,\n\t\t\t\t\t    u32 aead_iv_buf_len,\n\t\t\t\t\t    u32 prebuf_len,\n\t\t\t\t\t    u32 data_size,\n\t\t\t\t\t    u32 aad_pad_len,\n\t\t\t\t\t    u32 gcm_pad_len,\n\t\t\t\t\t    u32 hash_pad_len)\n{\n\treturn assoc_size + aead_iv_buf_len + prebuf_len + data_size +\n\t    aad_pad_len + gcm_pad_len + hash_pad_len;\n}\n\n \n\nvoid spum_dump_msg_hdr(u8 *buf, unsigned int buf_len);\n\nu32 spum_ns2_ctx_max_payload(enum spu_cipher_alg cipher_alg,\n\t\t\t     enum spu_cipher_mode cipher_mode,\n\t\t\t     unsigned int blocksize);\nu32 spum_nsp_ctx_max_payload(enum spu_cipher_alg cipher_alg,\n\t\t\t     enum spu_cipher_mode cipher_mode,\n\t\t\t     unsigned int blocksize);\nu32 spum_payload_length(u8 *spu_hdr);\nu16 spum_response_hdr_len(u16 auth_key_len, u16 enc_key_len, bool is_hash);\nu16 spum_hash_pad_len(enum hash_alg hash_alg, enum hash_mode hash_mode,\n\t\t      u32 chunksize, u16 hash_block_size);\nu32 spum_gcm_ccm_pad_len(enum spu_cipher_mode cipher_mode,\n\t\t\t unsigned int data_size);\nu32 spum_assoc_resp_len(enum spu_cipher_mode cipher_mode,\n\t\t\tunsigned int assoc_len, unsigned int iv_len,\n\t\t\tbool is_encrypt);\nu8 spum_aead_ivlen(enum spu_cipher_mode cipher_mode, u16 iv_len);\nbool spu_req_incl_icv(enum spu_cipher_mode cipher_mode, bool is_encrypt);\nenum hash_type spum_hash_type(u32 src_sent);\nu32 spum_digest_size(u32 alg_digest_size, enum hash_alg alg,\n\t\t     enum hash_type htype);\n\nu32 spum_create_request(u8 *spu_hdr,\n\t\t\tstruct spu_request_opts *req_opts,\n\t\t\tstruct spu_cipher_parms *cipher_parms,\n\t\t\tstruct spu_hash_parms *hash_parms,\n\t\t\tstruct spu_aead_parms *aead_parms,\n\t\t\tunsigned int data_size);\n\nu16 spum_cipher_req_init(u8 *spu_hdr, struct spu_cipher_parms *cipher_parms);\n\nvoid spum_cipher_req_finish(u8 *spu_hdr,\n\t\t\t    u16 spu_req_hdr_len,\n\t\t\t    unsigned int is_inbound,\n\t\t\t    struct spu_cipher_parms *cipher_parms,\n\t\t\t    unsigned int data_size);\n\nvoid spum_request_pad(u8 *pad_start,\n\t\t      u32 gcm_padding,\n\t\t      u32 hash_pad_len,\n\t\t      enum hash_alg auth_alg,\n\t\t      enum hash_mode auth_mode,\n\t\t      unsigned int total_sent, u32 status_padding);\n\nu8 spum_xts_tweak_in_payload(void);\nu8 spum_tx_status_len(void);\nu8 spum_rx_status_len(void);\nint spum_status_process(u8 *statp);\n\nvoid spum_ccm_update_iv(unsigned int digestsize,\n\t\t\tstruct spu_cipher_parms *cipher_parms,\n\t\t\tunsigned int assoclen,\n\t\t\tunsigned int chunksize,\n\t\t\tbool is_encrypt,\n\t\t\tbool is_esp);\nu32 spum_wordalign_padlen(u32 data_size);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}