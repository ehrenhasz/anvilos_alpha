{
  "module_name": "spu2.h",
  "hash_id": "e3921111ae9015119503400bf8aefe111317d001d29efc94d68965a23ea2fabd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/bcm/spu2.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _SPU2_H\n#define _SPU2_H\n\nenum spu2_cipher_type {\n\tSPU2_CIPHER_TYPE_NONE = 0x0,\n\tSPU2_CIPHER_TYPE_AES128 = 0x1,\n\tSPU2_CIPHER_TYPE_AES192 = 0x2,\n\tSPU2_CIPHER_TYPE_AES256 = 0x3,\n\tSPU2_CIPHER_TYPE_DES = 0x4,\n\tSPU2_CIPHER_TYPE_3DES = 0x5,\n\tSPU2_CIPHER_TYPE_LAST\n};\n\nenum spu2_cipher_mode {\n\tSPU2_CIPHER_MODE_ECB = 0x0,\n\tSPU2_CIPHER_MODE_CBC = 0x1,\n\tSPU2_CIPHER_MODE_CTR = 0x2,\n\tSPU2_CIPHER_MODE_CFB = 0x3,\n\tSPU2_CIPHER_MODE_OFB = 0x4,\n\tSPU2_CIPHER_MODE_XTS = 0x5,\n\tSPU2_CIPHER_MODE_CCM = 0x6,\n\tSPU2_CIPHER_MODE_GCM = 0x7,\n\tSPU2_CIPHER_MODE_LAST\n};\n\nenum spu2_hash_type {\n\tSPU2_HASH_TYPE_NONE = 0x0,\n\tSPU2_HASH_TYPE_AES128 = 0x1,\n\tSPU2_HASH_TYPE_AES192 = 0x2,\n\tSPU2_HASH_TYPE_AES256 = 0x3,\n\tSPU2_HASH_TYPE_MD5 = 0x6,\n\tSPU2_HASH_TYPE_SHA1 = 0x7,\n\tSPU2_HASH_TYPE_SHA224 = 0x8,\n\tSPU2_HASH_TYPE_SHA256 = 0x9,\n\tSPU2_HASH_TYPE_SHA384 = 0xa,\n\tSPU2_HASH_TYPE_SHA512 = 0xb,\n\tSPU2_HASH_TYPE_SHA512_224 = 0xc,\n\tSPU2_HASH_TYPE_SHA512_256 = 0xd,\n\tSPU2_HASH_TYPE_SHA3_224 = 0xe,\n\tSPU2_HASH_TYPE_SHA3_256 = 0xf,\n\tSPU2_HASH_TYPE_SHA3_384 = 0x10,\n\tSPU2_HASH_TYPE_SHA3_512 = 0x11,\n\tSPU2_HASH_TYPE_LAST\n};\n\nenum spu2_hash_mode {\n\tSPU2_HASH_MODE_CMAC = 0x0,\n\tSPU2_HASH_MODE_CBC_MAC = 0x1,\n\tSPU2_HASH_MODE_XCBC_MAC = 0x2,\n\tSPU2_HASH_MODE_HMAC = 0x3,\n\tSPU2_HASH_MODE_RABIN = 0x4,\n\tSPU2_HASH_MODE_CCM = 0x5,\n\tSPU2_HASH_MODE_GCM = 0x6,\n\tSPU2_HASH_MODE_RESERVED = 0x7,\n\tSPU2_HASH_MODE_LAST\n};\n\nenum spu2_ret_md_opts {\n\tSPU2_RET_NO_MD = 0,\t \n\tSPU2_RET_FMD_OMD = 1,\t \n\tSPU2_RET_FMD_ONLY = 2,\t \n\tSPU2_RET_FMD_OMD_IV = 3,\t \n};\n\n \nstruct SPU2_FMD {\n\t__le64 ctrl0;\n\t__le64 ctrl1;\n\t__le64 ctrl2;\n\t__le64 ctrl3;\n};\n\n#define FMD_SIZE  sizeof(struct SPU2_FMD)\n\n \n#define SPU2_REQ_FIXED_LEN FMD_SIZE\n#define SPU2_HEADER_ALLOC_LEN (SPU_REQ_FIXED_LEN + \\\n\t\t\t\t2 * MAX_KEY_SIZE + 2 * MAX_IV_SIZE)\n\n \n#define SPU2_CIPH_ENCRYPT_EN            0x1  \n#define SPU2_CIPH_TYPE                 0xF0  \n#define SPU2_CIPH_TYPE_SHIFT              4\n#define SPU2_CIPH_MODE                0xF00  \n#define SPU2_CIPH_MODE_SHIFT              8\n#define SPU2_CFB_MASK                0x7000  \n#define SPU2_CFB_MASK_SHIFT              12\n#define SPU2_PROTO_SEL             0xF00000  \n#define SPU2_PROTO_SEL_SHIFT             20\n#define SPU2_HASH_FIRST           0x1000000  \n#define SPU2_CHK_TAG              0x2000000  \n#define SPU2_HASH_TYPE          0x1F0000000  \n#define SPU2_HASH_TYPE_SHIFT             28\n#define SPU2_HASH_MODE         0xF000000000  \n#define SPU2_HASH_MODE_SHIFT             36\n#define SPU2_CIPH_PAD_EN     0x100000000000  \n#define SPU2_CIPH_PAD      0xFF000000000000  \n#define SPU2_CIPH_PAD_SHIFT              48\n\n \n#define SPU2_TAG_LOC                    0x1  \n#define SPU2_HAS_FR_DATA                0x2  \n#define SPU2_HAS_AAD1                   0x4  \n#define SPU2_HAS_NAAD                   0x8  \n#define SPU2_HAS_AAD2                  0x10  \n#define SPU2_HAS_ESN                   0x20  \n#define SPU2_HASH_KEY_LEN            0xFF00  \n#define SPU2_HASH_KEY_LEN_SHIFT           8\n#define SPU2_CIPH_KEY_LEN         0xFF00000  \n#define SPU2_CIPH_KEY_LEN_SHIFT          20\n#define SPU2_GENIV               0x10000000  \n#define SPU2_HASH_IV             0x20000000  \n#define SPU2_RET_IV              0x40000000  \n#define SPU2_RET_IV_LEN         0xF00000000  \n#define SPU2_RET_IV_LEN_SHIFT            32\n#define SPU2_IV_OFFSET         0xF000000000  \n#define SPU2_IV_OFFSET_SHIFT             36\n#define SPU2_IV_LEN          0x1F0000000000  \n#define SPU2_IV_LEN_SHIFT                40\n#define SPU2_HASH_TAG_LEN  0x7F000000000000  \n#define SPU2_HASH_TAG_LEN_SHIFT          48\n#define SPU2_RETURN_MD    0x300000000000000  \n#define SPU2_RETURN_MD_SHIFT             56\n#define SPU2_RETURN_FD    0x400000000000000\n#define SPU2_RETURN_AAD1  0x800000000000000\n#define SPU2_RETURN_NAAD 0x1000000000000000\n#define SPU2_RETURN_AAD2 0x2000000000000000\n#define SPU2_RETURN_PAY  0x4000000000000000  \n\n \n#define SPU2_AAD1_OFFSET              0xFFF  \n#define SPU2_AAD1_LEN               0xFF000  \n#define SPU2_AAD1_LEN_SHIFT              12\n#define SPU2_AAD2_OFFSET         0xFFF00000  \n#define SPU2_AAD2_OFFSET_SHIFT           20\n#define SPU2_PL_OFFSET   0xFFFFFFFF00000000  \n#define SPU2_PL_OFFSET_SHIFT             32\n\n \n#define SPU2_PL_LEN              0xFFFFFFFF  \n#define SPU2_TLS_LEN         0xFFFF00000000  \n#define SPU2_TLS_LEN_SHIFT               32\n\n \n#define SPU2_MAX_PAYLOAD  SPU2_PL_LEN\n\n \n#define SPU2_INVALID_ICV  1\n\nvoid spu2_dump_msg_hdr(u8 *buf, unsigned int buf_len);\nu32 spu2_ctx_max_payload(enum spu_cipher_alg cipher_alg,\n\t\t\t enum spu_cipher_mode cipher_mode,\n\t\t\t unsigned int blocksize);\nu32 spu2_payload_length(u8 *spu_hdr);\nu16 spu2_response_hdr_len(u16 auth_key_len, u16 enc_key_len, bool is_hash);\nu16 spu2_hash_pad_len(enum hash_alg hash_alg, enum hash_mode hash_mode,\n\t\t      u32 chunksize, u16 hash_block_size);\nu32 spu2_gcm_ccm_pad_len(enum spu_cipher_mode cipher_mode,\n\t\t\t unsigned int data_size);\nu32 spu2_assoc_resp_len(enum spu_cipher_mode cipher_mode,\n\t\t\tunsigned int assoc_len, unsigned int iv_len,\n\t\t\tbool is_encrypt);\nu8 spu2_aead_ivlen(enum spu_cipher_mode cipher_mode,\n\t\t   u16 iv_len);\nenum hash_type spu2_hash_type(u32 src_sent);\nu32 spu2_digest_size(u32 alg_digest_size, enum hash_alg alg,\n\t\t     enum hash_type htype);\nu32 spu2_create_request(u8 *spu_hdr,\n\t\t\tstruct spu_request_opts *req_opts,\n\t\t\tstruct spu_cipher_parms *cipher_parms,\n\t\t\tstruct spu_hash_parms *hash_parms,\n\t\t\tstruct spu_aead_parms *aead_parms,\n\t\t\tunsigned int data_size);\nu16 spu2_cipher_req_init(u8 *spu_hdr, struct spu_cipher_parms *cipher_parms);\nvoid spu2_cipher_req_finish(u8 *spu_hdr,\n\t\t\t    u16 spu_req_hdr_len,\n\t\t\t    unsigned int is_inbound,\n\t\t\t    struct spu_cipher_parms *cipher_parms,\n\t\t\t    unsigned int data_size);\nvoid spu2_request_pad(u8 *pad_start, u32 gcm_padding, u32 hash_pad_len,\n\t\t      enum hash_alg auth_alg, enum hash_mode auth_mode,\n\t\t      unsigned int total_sent, u32 status_padding);\nu8 spu2_xts_tweak_in_payload(void);\nu8 spu2_tx_status_len(void);\nu8 spu2_rx_status_len(void);\nint spu2_status_process(u8 *statp);\nvoid spu2_ccm_update_iv(unsigned int digestsize,\n\t\t\tstruct spu_cipher_parms *cipher_parms,\n\t\t\tunsigned int assoclen, unsigned int chunksize,\n\t\t\tbool is_encrypt, bool is_esp);\nu32 spu2_wordalign_padlen(u32 data_size);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}