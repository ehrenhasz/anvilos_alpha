{
  "module_name": "cc_aead.h",
  "hash_id": "1e1543f43b0f520c93e5b50d927e1af33f4788396a9470cedd82d986335bcee3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccree/cc_aead.h",
  "human_readable_source": " \n \n\n \n\n#ifndef __CC_AEAD_H__\n#define __CC_AEAD_H__\n\n#include <linux/kernel.h>\n#include <crypto/algapi.h>\n#include <crypto/ctr.h>\n\n \n#define ICV_CMP_SIZE 8\n#define CCM_CONFIG_BUF_SIZE (AES_BLOCK_SIZE * 3)\n#define MAX_MAC_SIZE SHA256_DIGEST_SIZE\n\n \n#define GCM_BLOCK_LEN_SIZE 8\n\n#define GCM_BLOCK_RFC4_IV_OFFSET\t4\n#define GCM_BLOCK_RFC4_IV_SIZE\t\t8   \n#define GCM_BLOCK_RFC4_NONCE_OFFSET\t0\n#define GCM_BLOCK_RFC4_NONCE_SIZE\t4\n\n \n#define CCM_B0_OFFSET 0\n#define CCM_A0_OFFSET 16\n#define CCM_CTR_COUNT_0_OFFSET 32\n \n#define CCM_BLOCK_NONCE_OFFSET 1   \n#define CCM_BLOCK_NONCE_SIZE   3   \n#define CCM_BLOCK_IV_OFFSET    4   \n#define CCM_BLOCK_IV_SIZE      8   \n\nenum aead_ccm_header_size {\n\tccm_header_size_null = -1,\n\tccm_header_size_zero = 0,\n\tccm_header_size_2 = 2,\n\tccm_header_size_6 = 6,\n\tccm_header_size_max = S32_MAX\n};\n\nstruct aead_req_ctx {\n\t \n\tu8 mac_buf[MAX_MAC_SIZE] ____cacheline_aligned;\n\tu8 ctr_iv[AES_BLOCK_SIZE] ____cacheline_aligned;\n\n\t\n\tu8 gcm_iv_inc1[AES_BLOCK_SIZE] ____cacheline_aligned;\n\tu8 gcm_iv_inc2[AES_BLOCK_SIZE] ____cacheline_aligned;\n\tu8 hkey[AES_BLOCK_SIZE] ____cacheline_aligned;\n\tstruct {\n\t\tu8 len_a[GCM_BLOCK_LEN_SIZE] ____cacheline_aligned;\n\t\tu8 len_c[GCM_BLOCK_LEN_SIZE];\n\t} gcm_len_block;\n\n\tu8 ccm_config[CCM_CONFIG_BUF_SIZE] ____cacheline_aligned;\n\t \n\tunsigned int hw_iv_size ____cacheline_aligned;\n\t \n\tu8 backup_mac[MAX_MAC_SIZE];\n\tu8 *backup_iv;  \n\tu32 assoclen;  \n\tdma_addr_t mac_buf_dma_addr;  \n\t \n\tdma_addr_t ccm_iv0_dma_addr;\n\tdma_addr_t icv_dma_addr;  \n\n\t\n\t \n\tdma_addr_t gcm_iv_inc1_dma_addr;\n\t \n\tdma_addr_t gcm_iv_inc2_dma_addr;\n\tdma_addr_t hkey_dma_addr;  \n\tdma_addr_t gcm_block_len_dma_addr;  \n\n\tu8 *icv_virt_addr;  \n\tstruct async_gen_req_ctx gen_ctx;\n\tstruct cc_mlli assoc;\n\tstruct cc_mlli src;\n\tstruct cc_mlli dst;\n\tstruct scatterlist *src_sgl;\n\tstruct scatterlist *dst_sgl;\n\tunsigned int src_offset;\n\tunsigned int dst_offset;\n\tenum cc_req_dma_buf_type assoc_buff_type;\n\tenum cc_req_dma_buf_type data_buff_type;\n\tstruct mlli_params mlli_params;\n\tunsigned int cryptlen;\n\tstruct scatterlist ccm_adata_sg;\n\tenum aead_ccm_header_size ccm_hdr_size;\n\tunsigned int req_authsize;\n\tenum drv_cipher_mode cipher_mode;\n\tbool is_icv_fragmented;\n\tbool is_single_pass;\n\tbool plaintext_authenticate_only; \n};\n\nint cc_aead_alloc(struct cc_drvdata *drvdata);\nint cc_aead_free(struct cc_drvdata *drvdata);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}