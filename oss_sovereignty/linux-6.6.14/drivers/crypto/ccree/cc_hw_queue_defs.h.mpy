{
  "module_name": "cc_hw_queue_defs.h",
  "hash_id": "5fb8fb46ac8d27a3cca4ed650a8c32a12d64bc799bb72e02355d66c9d79b49c4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccree/cc_hw_queue_defs.h",
  "human_readable_source": " \n \n\n#ifndef __CC_HW_QUEUE_DEFS_H__\n#define __CC_HW_QUEUE_DEFS_H__\n\n#include <linux/types.h>\n\n#include \"cc_kernel_regs.h\"\n#include <linux/bitfield.h>\n\n \n\n#define HW_DESC_SIZE_WORDS\t\t6\n \n#define HW_QUEUE_SLOTS_MAX              15\n\n#define CC_REG_LOW(name)  (name ## _BIT_SHIFT)\n#define CC_REG_HIGH(name) (CC_REG_LOW(name) + name ## _BIT_SIZE - 1)\n#define CC_GENMASK(name)  GENMASK(CC_REG_HIGH(name), CC_REG_LOW(name))\n\n#define CC_HWQ_GENMASK(word, field) \\\n\tCC_GENMASK(CC_DSCRPTR_QUEUE_WORD ## word ## _ ## field)\n\n#define WORD0_VALUE\t\tCC_HWQ_GENMASK(0, VALUE)\n#define\tWORD0_CPP_CIPHER_MODE\tCC_HWQ_GENMASK(0, CPP_CIPHER_MODE)\n#define WORD1_DIN_CONST_VALUE\tCC_HWQ_GENMASK(1, DIN_CONST_VALUE)\n#define WORD1_DIN_DMA_MODE\tCC_HWQ_GENMASK(1, DIN_DMA_MODE)\n#define WORD1_DIN_SIZE\t\tCC_HWQ_GENMASK(1, DIN_SIZE)\n#define WORD1_NOT_LAST\t\tCC_HWQ_GENMASK(1, NOT_LAST)\n#define WORD1_NS_BIT\t\tCC_HWQ_GENMASK(1, NS_BIT)\n#define WORD1_LOCK_QUEUE\tCC_HWQ_GENMASK(1, LOCK_QUEUE)\n#define WORD2_VALUE\t\tCC_HWQ_GENMASK(2, VALUE)\n#define WORD3_DOUT_DMA_MODE\tCC_HWQ_GENMASK(3, DOUT_DMA_MODE)\n#define WORD3_DOUT_LAST_IND\tCC_HWQ_GENMASK(3, DOUT_LAST_IND)\n#define WORD3_DOUT_SIZE\t\tCC_HWQ_GENMASK(3, DOUT_SIZE)\n#define WORD3_HASH_XOR_BIT\tCC_HWQ_GENMASK(3, HASH_XOR_BIT)\n#define WORD3_NS_BIT\t\tCC_HWQ_GENMASK(3, NS_BIT)\n#define WORD3_QUEUE_LAST_IND\tCC_HWQ_GENMASK(3, QUEUE_LAST_IND)\n#define WORD4_ACK_NEEDED\tCC_HWQ_GENMASK(4, ACK_NEEDED)\n#define WORD4_AES_SEL_N_HASH\tCC_HWQ_GENMASK(4, AES_SEL_N_HASH)\n#define WORD4_AES_XOR_CRYPTO_KEY CC_HWQ_GENMASK(4, AES_XOR_CRYPTO_KEY)\n#define WORD4_BYTES_SWAP\tCC_HWQ_GENMASK(4, BYTES_SWAP)\n#define WORD4_CIPHER_CONF0\tCC_HWQ_GENMASK(4, CIPHER_CONF0)\n#define WORD4_CIPHER_CONF1\tCC_HWQ_GENMASK(4, CIPHER_CONF1)\n#define WORD4_CIPHER_CONF2\tCC_HWQ_GENMASK(4, CIPHER_CONF2)\n#define WORD4_CIPHER_DO\t\tCC_HWQ_GENMASK(4, CIPHER_DO)\n#define WORD4_CIPHER_MODE\tCC_HWQ_GENMASK(4, CIPHER_MODE)\n#define WORD4_CMAC_SIZE0\tCC_HWQ_GENMASK(4, CMAC_SIZE0)\n#define WORD4_DATA_FLOW_MODE\tCC_HWQ_GENMASK(4, DATA_FLOW_MODE)\n#define WORD4_KEY_SIZE\t\tCC_HWQ_GENMASK(4, KEY_SIZE)\n#define WORD4_SETUP_OPERATION\tCC_HWQ_GENMASK(4, SETUP_OPERATION)\n#define WORD5_DIN_ADDR_HIGH\tCC_HWQ_GENMASK(5, DIN_ADDR_HIGH)\n#define WORD5_DOUT_ADDR_HIGH\tCC_HWQ_GENMASK(5, DOUT_ADDR_HIGH)\n\n \n\nstruct cc_hw_desc {\n\tunion {\n\t\tu32 word[HW_DESC_SIZE_WORDS];\n\t\tu16 hword[HW_DESC_SIZE_WORDS * 2];\n\t};\n};\n\nenum cc_axi_sec {\n\tAXI_SECURE = 0,\n\tAXI_NOT_SECURE = 1\n};\n\nenum cc_desc_direction {\n\tDESC_DIRECTION_ILLEGAL = -1,\n\tDESC_DIRECTION_ENCRYPT_ENCRYPT = 0,\n\tDESC_DIRECTION_DECRYPT_DECRYPT = 1,\n\tDESC_DIRECTION_DECRYPT_ENCRYPT = 3,\n\tDESC_DIRECTION_END = S32_MAX,\n};\n\nenum cc_dma_mode {\n\tDMA_MODE_NULL\t\t= -1,\n\tNO_DMA\t\t\t= 0,\n\tDMA_SRAM\t\t= 1,\n\tDMA_DLLI\t\t= 2,\n\tDMA_MLLI\t\t= 3,\n\tDMA_MODE_END\t\t= S32_MAX,\n};\n\nenum cc_flow_mode {\n\tFLOW_MODE_NULL\t\t= -1,\n\t \n\tBYPASS\t\t\t= 0,\n\tDIN_AES_DOUT\t\t= 1,\n\tAES_to_HASH\t\t= 2,\n\tAES_and_HASH\t\t= 3,\n\tDIN_DES_DOUT\t\t= 4,\n\tDES_to_HASH\t\t= 5,\n\tDES_and_HASH\t\t= 6,\n\tDIN_HASH\t\t= 7,\n\tDIN_HASH_and_BYPASS\t= 8,\n\tAESMAC_and_BYPASS\t= 9,\n\tAES_to_HASH_and_DOUT\t= 10,\n\tDIN_RC4_DOUT\t\t= 11,\n\tDES_to_HASH_and_DOUT\t= 12,\n\tAES_to_AES_to_HASH_and_DOUT\t= 13,\n\tAES_to_AES_to_HASH\t= 14,\n\tAES_to_HASH_and_AES\t= 15,\n\tDIN_SM4_DOUT\t\t= 16,\n\tDIN_AES_AESMAC\t\t= 17,\n\tHASH_to_DOUT\t\t= 18,\n\t \n\tS_DIN_to_AES\t\t= 32,\n\tS_DIN_to_AES2\t\t= 33,\n\tS_DIN_to_DES\t\t= 34,\n\tS_DIN_to_RC4\t\t= 35,\n\tS_DIN_to_SM4\t\t= 36,\n\tS_DIN_to_HASH\t\t= 37,\n\tS_AES_to_DOUT\t\t= 38,\n\tS_AES2_to_DOUT\t\t= 39,\n\tS_SM4_to_DOUT\t\t= 40,\n\tS_RC4_to_DOUT\t\t= 41,\n\tS_DES_to_DOUT\t\t= 42,\n\tS_HASH_to_DOUT\t\t= 43,\n\tSET_FLOW_ID\t\t= 44,\n\tFLOW_MODE_END = S32_MAX,\n};\n\nenum cc_setup_op {\n\tSETUP_LOAD_NOP\t\t= 0,\n\tSETUP_LOAD_STATE0\t= 1,\n\tSETUP_LOAD_STATE1\t= 2,\n\tSETUP_LOAD_STATE2\t= 3,\n\tSETUP_LOAD_KEY0\t\t= 4,\n\tSETUP_LOAD_XEX_KEY\t= 5,\n\tSETUP_WRITE_STATE0\t= 8,\n\tSETUP_WRITE_STATE1\t= 9,\n\tSETUP_WRITE_STATE2\t= 10,\n\tSETUP_WRITE_STATE3\t= 11,\n\tSETUP_OP_END = S32_MAX,\n};\n\nenum cc_hash_conf_pad {\n\tHASH_PADDING_DISABLED = 0,\n\tHASH_PADDING_ENABLED = 1,\n\tHASH_DIGEST_RESULT_LITTLE_ENDIAN = 2,\n\tHASH_CONFIG1_PADDING_RESERVE32 = S32_MAX,\n};\n\nenum cc_aes_mac_selector {\n\tAES_SK = 1,\n\tAES_CMAC_INIT = 2,\n\tAES_CMAC_SIZE0 = 3,\n\tAES_MAC_END = S32_MAX,\n};\n\n#define HW_KEY_MASK_CIPHER_DO\t  0x3\n#define HW_KEY_SHIFT_CIPHER_CFG2  2\n\n \n \nenum cc_hw_crypto_key {\n\tUSER_KEY = 0,\t\t\t \n\tROOT_KEY = 1,\t\t\t \n\tPROVISIONING_KEY = 2,\t\t   \n\tSESSION_KEY = 3,\t\t \n\tRESERVED_KEY = 4,\t\t \n\tPLATFORM_KEY = 5,\t\t \n\tCUSTOMER_KEY = 6,\t\t \n\tKFDE0_KEY = 7,\t\t\t \n\tKFDE1_KEY = 9,\t\t\t \n\tKFDE2_KEY = 10,\t\t\t \n\tKFDE3_KEY = 11,\t\t\t \n\tEND_OF_KEYS = S32_MAX,\n};\n\n#define CC_NUM_HW_KEY_SLOTS\t4\n#define CC_FIRST_HW_KEY_SLOT\t0\n#define CC_LAST_HW_KEY_SLOT\t(CC_FIRST_HW_KEY_SLOT + CC_NUM_HW_KEY_SLOTS - 1)\n\n#define CC_NUM_CPP_KEY_SLOTS\t8\n#define CC_FIRST_CPP_KEY_SLOT\t16\n#define CC_LAST_CPP_KEY_SLOT\t(CC_FIRST_CPP_KEY_SLOT + \\\n\t\t\t\t\tCC_NUM_CPP_KEY_SLOTS - 1)\n\nenum cc_hw_aes_key_size {\n\tAES_128_KEY = 0,\n\tAES_192_KEY = 1,\n\tAES_256_KEY = 2,\n\tEND_OF_AES_KEYS = S32_MAX,\n};\n\nenum cc_hash_cipher_pad {\n\tDO_NOT_PAD = 0,\n\tDO_PAD = 1,\n\tHASH_CIPHER_DO_PADDING_RESERVE32 = S32_MAX,\n};\n\n#define CC_CPP_DIN_ADDR\t0xFF00FF00UL\n#define CC_CPP_DIN_SIZE 0xFF00FFUL\n\n \n \n \n\n \nstatic inline void hw_desc_init(struct cc_hw_desc *pdesc)\n{\n\tmemset(pdesc, 0, sizeof(struct cc_hw_desc));\n}\n\n \nstatic inline void set_queue_last_ind_bit(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[3] |= FIELD_PREP(WORD3_QUEUE_LAST_IND, 1);\n}\n\n \nstatic inline void set_din_type(struct cc_hw_desc *pdesc,\n\t\t\t\tenum cc_dma_mode dma_mode, dma_addr_t addr,\n\t\t\t\tu32 size, enum cc_axi_sec axi_sec)\n{\n\tpdesc->word[0] = lower_32_bits(addr);\n#ifdef CONFIG_ARCH_DMA_ADDR_T_64BIT\n\tpdesc->word[5] |= FIELD_PREP(WORD5_DIN_ADDR_HIGH, upper_32_bits(addr));\n#endif\n\tpdesc->word[1] |= FIELD_PREP(WORD1_DIN_DMA_MODE, dma_mode) |\n\t\t\t\tFIELD_PREP(WORD1_DIN_SIZE, size) |\n\t\t\t\tFIELD_PREP(WORD1_NS_BIT, axi_sec);\n}\n\n \nstatic inline void set_din_no_dma(struct cc_hw_desc *pdesc, u32 addr, u32 size)\n{\n\tpdesc->word[0] = addr;\n\tpdesc->word[1] |= FIELD_PREP(WORD1_DIN_SIZE, size);\n}\n\n \nstatic inline void set_cpp_crypto_key(struct cc_hw_desc *pdesc, u8 slot)\n{\n\tpdesc->word[0] |= CC_CPP_DIN_ADDR;\n\n\tpdesc->word[1] |= FIELD_PREP(WORD1_DIN_SIZE, CC_CPP_DIN_SIZE);\n\tpdesc->word[1] |= FIELD_PREP(WORD1_LOCK_QUEUE, 1);\n\n\tpdesc->word[4] |= FIELD_PREP(WORD4_SETUP_OPERATION, slot);\n}\n\n \nstatic inline void set_din_sram(struct cc_hw_desc *pdesc, u32 addr, u32 size)\n{\n\tpdesc->word[0] = addr;\n\tpdesc->word[1] |= FIELD_PREP(WORD1_DIN_SIZE, size) |\n\t\t\t\tFIELD_PREP(WORD1_DIN_DMA_MODE, DMA_SRAM);\n}\n\n \nstatic inline void set_din_const(struct cc_hw_desc *pdesc, u32 val, u32 size)\n{\n\tpdesc->word[0] = val;\n\tpdesc->word[1] |= FIELD_PREP(WORD1_DIN_CONST_VALUE, 1) |\n\t\t\tFIELD_PREP(WORD1_DIN_DMA_MODE, DMA_SRAM) |\n\t\t\tFIELD_PREP(WORD1_DIN_SIZE, size);\n}\n\n \nstatic inline void set_din_not_last_indication(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[1] |= FIELD_PREP(WORD1_NOT_LAST, 1);\n}\n\n \nstatic inline void set_dout_type(struct cc_hw_desc *pdesc,\n\t\t\t\t enum cc_dma_mode dma_mode, dma_addr_t addr,\n\t\t\t\t u32 size, enum cc_axi_sec axi_sec)\n{\n\tpdesc->word[2] = lower_32_bits(addr);\n#ifdef CONFIG_ARCH_DMA_ADDR_T_64BIT\n\tpdesc->word[5] |= FIELD_PREP(WORD5_DOUT_ADDR_HIGH, upper_32_bits(addr));\n#endif\n\tpdesc->word[3] |= FIELD_PREP(WORD3_DOUT_DMA_MODE, dma_mode) |\n\t\t\t\tFIELD_PREP(WORD3_DOUT_SIZE, size) |\n\t\t\t\tFIELD_PREP(WORD3_NS_BIT, axi_sec);\n}\n\n \nstatic inline void set_dout_dlli(struct cc_hw_desc *pdesc, dma_addr_t addr,\n\t\t\t\t u32 size, enum cc_axi_sec axi_sec,\n\t\t\t\t u32 last_ind)\n{\n\tset_dout_type(pdesc, DMA_DLLI, addr, size, axi_sec);\n\tpdesc->word[3] |= FIELD_PREP(WORD3_DOUT_LAST_IND, last_ind);\n}\n\n \nstatic inline void set_dout_mlli(struct cc_hw_desc *pdesc, u32 addr, u32 size,\n\t\t\t\t enum cc_axi_sec axi_sec, bool last_ind)\n{\n\tset_dout_type(pdesc, DMA_MLLI, addr, size, axi_sec);\n\tpdesc->word[3] |= FIELD_PREP(WORD3_DOUT_LAST_IND, last_ind);\n}\n\n \nstatic inline void set_dout_no_dma(struct cc_hw_desc *pdesc, u32 addr,\n\t\t\t\t   u32 size, bool write_enable)\n{\n\tpdesc->word[2] = addr;\n\tpdesc->word[3] |= FIELD_PREP(WORD3_DOUT_SIZE, size) |\n\t\t\tFIELD_PREP(WORD3_DOUT_LAST_IND, write_enable);\n}\n\n \nstatic inline void set_xor_val(struct cc_hw_desc *pdesc, u32 val)\n{\n\tpdesc->word[2] = val;\n}\n\n \nstatic inline void set_xor_active(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[3] |= FIELD_PREP(WORD3_HASH_XOR_BIT, 1);\n}\n\n \nstatic inline void set_aes_not_hash_mode(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_AES_SEL_N_HASH, 1);\n}\n\n \nstatic inline void set_aes_xor_crypto_key(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_AES_XOR_CRYPTO_KEY, 1);\n}\n\n \nstatic inline void set_dout_sram(struct cc_hw_desc *pdesc, u32 addr, u32 size)\n{\n\tpdesc->word[2] = addr;\n\tpdesc->word[3] |= FIELD_PREP(WORD3_DOUT_DMA_MODE, DMA_SRAM) |\n\t\t\tFIELD_PREP(WORD3_DOUT_SIZE, size);\n}\n\n \nstatic inline void set_xex_data_unit_size(struct cc_hw_desc *pdesc, u32 size)\n{\n\tpdesc->word[2] = size;\n}\n\n \nstatic inline void set_multi2_num_rounds(struct cc_hw_desc *pdesc, u32 num)\n{\n\tpdesc->word[2] = num;\n}\n\n \nstatic inline void set_flow_mode(struct cc_hw_desc *pdesc,\n\t\t\t\t enum cc_flow_mode mode)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_DATA_FLOW_MODE, mode);\n}\n\n \nstatic inline void set_cipher_mode(struct cc_hw_desc *pdesc, int mode)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CIPHER_MODE, mode);\n}\n\n \nstatic inline void set_hash_cipher_mode(struct cc_hw_desc *pdesc,\n\t\t\t\t\tenum drv_cipher_mode cipher_mode,\n\t\t\t\t\tenum drv_hash_mode hash_mode)\n{\n\tset_cipher_mode(pdesc, cipher_mode);\n\tif (hash_mode == DRV_HASH_SM3)\n\t\tset_aes_xor_crypto_key(pdesc);\n}\n\n \nstatic inline void set_cipher_config0(struct cc_hw_desc *pdesc, int mode)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CIPHER_CONF0, mode);\n}\n\n \nstatic inline void set_cipher_config1(struct cc_hw_desc *pdesc,\n\t\t\t\t      enum cc_hash_conf_pad config)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CIPHER_CONF1, config);\n}\n\n \nstatic inline void set_hw_crypto_key(struct cc_hw_desc *pdesc,\n\t\t\t\t     enum cc_hw_crypto_key hw_key)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CIPHER_DO,\n\t\t\t\t     (hw_key & HW_KEY_MASK_CIPHER_DO)) |\n\t\t\tFIELD_PREP(WORD4_CIPHER_CONF2,\n\t\t\t\t   (hw_key >> HW_KEY_SHIFT_CIPHER_CFG2));\n}\n\n \nstatic inline void set_bytes_swap(struct cc_hw_desc *pdesc, bool config)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_BYTES_SWAP, config);\n}\n\n \nstatic inline void set_cmac_size0_mode(struct cc_hw_desc *pdesc)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CMAC_SIZE0, 1);\n}\n\n \nstatic inline void set_key_size(struct cc_hw_desc *pdesc, u32 size)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_KEY_SIZE, size);\n}\n\n \nstatic inline void set_key_size_aes(struct cc_hw_desc *pdesc, u32 size)\n{\n\tset_key_size(pdesc, ((size >> 3) - 2));\n}\n\n \nstatic inline void set_key_size_des(struct cc_hw_desc *pdesc, u32 size)\n{\n\tset_key_size(pdesc, ((size >> 3) - 1));\n}\n\n \nstatic inline void set_setup_mode(struct cc_hw_desc *pdesc,\n\t\t\t\t  enum cc_setup_op mode)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_SETUP_OPERATION, mode);\n}\n\n \nstatic inline void set_cipher_do(struct cc_hw_desc *pdesc,\n\t\t\t\t enum cc_hash_cipher_pad config)\n{\n\tpdesc->word[4] |= FIELD_PREP(WORD4_CIPHER_DO,\n\t\t\t\t(config & HW_KEY_MASK_CIPHER_DO));\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}