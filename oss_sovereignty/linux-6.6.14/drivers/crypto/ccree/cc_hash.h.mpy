{
  "module_name": "cc_hash.h",
  "hash_id": "13765dd7a83d6225eea7f52bae191408f35dc116e3c0eeb6bd5e14690c74a7b2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccree/cc_hash.h",
  "human_readable_source": " \n \n\n \n\n#ifndef __CC_HASH_H__\n#define __CC_HASH_H__\n\n#include \"cc_buffer_mgr.h\"\n\n#define HMAC_IPAD_CONST\t0x36363636\n#define HMAC_OPAD_CONST\t0x5C5C5C5C\n#define HASH_LEN_SIZE_712 16\n#define HASH_LEN_SIZE_630 8\n#define HASH_MAX_LEN_SIZE HASH_LEN_SIZE_712\n#define CC_MAX_HASH_DIGEST_SIZE\tSHA512_DIGEST_SIZE\n#define CC_MAX_HASH_BLCK_SIZE SHA512_BLOCK_SIZE\n\n#define XCBC_MAC_K1_OFFSET 0\n#define XCBC_MAC_K2_OFFSET 16\n#define XCBC_MAC_K3_OFFSET 32\n\n#define CC_EXPORT_MAGIC 0xC2EE1070U\n\n \nstruct aeshash_state {\n\tu8 state[AES_BLOCK_SIZE];\n\tunsigned int count;\n\tu8 buffer[AES_BLOCK_SIZE];\n};\n\n \nstruct ahash_req_ctx {\n\tu8 buffers[2][CC_MAX_HASH_BLCK_SIZE] ____cacheline_aligned;\n\tu8 digest_result_buff[CC_MAX_HASH_DIGEST_SIZE] ____cacheline_aligned;\n\tu8 digest_buff[CC_MAX_HASH_DIGEST_SIZE] ____cacheline_aligned;\n\tu8 opad_digest_buff[CC_MAX_HASH_DIGEST_SIZE] ____cacheline_aligned;\n\tu8 digest_bytes_len[HASH_MAX_LEN_SIZE] ____cacheline_aligned;\n\tstruct async_gen_req_ctx gen_ctx ____cacheline_aligned;\n\tenum cc_req_dma_buf_type data_dma_buf_type;\n\tdma_addr_t opad_digest_dma_addr;\n\tdma_addr_t digest_buff_dma_addr;\n\tdma_addr_t digest_bytes_len_dma_addr;\n\tdma_addr_t digest_result_dma_addr;\n\tu32 buf_cnt[2];\n\tu32 buff_index;\n\tu32 xcbc_count;  \n\tstruct scatterlist buff_sg[2];\n\tstruct scatterlist *curr_sg;\n\tu32 in_nents;\n\tu32 mlli_nents;\n\tstruct mlli_params mlli_params;\n};\n\nstatic inline u32 *cc_hash_buf_cnt(struct ahash_req_ctx *state)\n{\n\treturn &state->buf_cnt[state->buff_index];\n}\n\nstatic inline u8 *cc_hash_buf(struct ahash_req_ctx *state)\n{\n\treturn state->buffers[state->buff_index];\n}\n\nstatic inline u32 *cc_next_buf_cnt(struct ahash_req_ctx *state)\n{\n\treturn &state->buf_cnt[state->buff_index ^ 1];\n}\n\nstatic inline u8 *cc_next_buf(struct ahash_req_ctx *state)\n{\n\treturn state->buffers[state->buff_index ^ 1];\n}\n\nint cc_hash_alloc(struct cc_drvdata *drvdata);\nint cc_init_hash_sram(struct cc_drvdata *drvdata);\nint cc_hash_free(struct cc_drvdata *drvdata);\n\n \nu32 cc_digest_len_addr(void *drvdata, u32 mode);\n\n \nu32 cc_larval_digest_addr(void *drvdata, u32 mode);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}