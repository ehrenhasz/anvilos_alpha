{
  "module_name": "cc_debugfs.c",
  "hash_id": "3ec2b3eea9bccb6268653299756e6050a71b281d73369b45b9479d17a6f03b1c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccree/cc_debugfs.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/debugfs.h>\n#include <linux/stringify.h>\n#include \"cc_driver.h\"\n#include \"cc_crypto_ctx.h\"\n#include \"cc_debugfs.h\"\n\n#define CC_DEBUG_REG(_X) {\t\\\n\t.name = __stringify(_X),\\\n\t.offset = CC_REG(_X)\t\\\n\t}\n\n \nstatic struct dentry *cc_debugfs_dir;\n\nstatic struct debugfs_reg32 ver_sig_regs[] = {\n\t{ .name = \"SIGNATURE\" },  \n\t{ .name = \"VERSION\" },  \n};\n\nstatic const struct debugfs_reg32 pid_cid_regs[] = {\n\tCC_DEBUG_REG(PERIPHERAL_ID_0),\n\tCC_DEBUG_REG(PERIPHERAL_ID_1),\n\tCC_DEBUG_REG(PERIPHERAL_ID_2),\n\tCC_DEBUG_REG(PERIPHERAL_ID_3),\n\tCC_DEBUG_REG(PERIPHERAL_ID_4),\n\tCC_DEBUG_REG(COMPONENT_ID_0),\n\tCC_DEBUG_REG(COMPONENT_ID_1),\n\tCC_DEBUG_REG(COMPONENT_ID_2),\n\tCC_DEBUG_REG(COMPONENT_ID_3),\n};\n\nstatic const struct debugfs_reg32 debug_regs[] = {\n\tCC_DEBUG_REG(HOST_IRR),\n\tCC_DEBUG_REG(HOST_POWER_DOWN_EN),\n\tCC_DEBUG_REG(AXIM_MON_ERR),\n\tCC_DEBUG_REG(DSCRPTR_QUEUE_CONTENT),\n\tCC_DEBUG_REG(HOST_IMR),\n\tCC_DEBUG_REG(AXIM_CFG),\n\tCC_DEBUG_REG(AXIM_CACHE_PARAMS),\n\tCC_DEBUG_REG(GPR_HOST),\n\tCC_DEBUG_REG(AXIM_MON_COMP),\n};\n\nvoid __init cc_debugfs_global_init(void)\n{\n\tcc_debugfs_dir = debugfs_create_dir(\"ccree\", NULL);\n}\n\nvoid cc_debugfs_global_fini(void)\n{\n\tdebugfs_remove(cc_debugfs_dir);\n}\n\nint cc_debugfs_init(struct cc_drvdata *drvdata)\n{\n\tstruct device *dev = drvdata_to_dev(drvdata);\n\tstruct debugfs_regset32 *regset, *verset;\n\n\tregset = devm_kzalloc(dev, sizeof(*regset), GFP_KERNEL);\n\tif (!regset)\n\t\treturn -ENOMEM;\n\n\tregset->regs = debug_regs;\n\tregset->nregs = ARRAY_SIZE(debug_regs);\n\tregset->base = drvdata->cc_base;\n\tregset->dev = dev;\n\n\tdrvdata->dir = debugfs_create_dir(drvdata->plat_dev->name,\n\t\t\t\t\t  cc_debugfs_dir);\n\n\tdebugfs_create_regset32(\"regs\", 0400, drvdata->dir, regset);\n\tdebugfs_create_bool(\"coherent\", 0400, drvdata->dir, &drvdata->coherent);\n\n\tverset = devm_kzalloc(dev, sizeof(*verset), GFP_KERNEL);\n\t \n\tif (!verset)\n\t\treturn 0;\n\n\tif (drvdata->hw_rev <= CC_HW_REV_712) {\n\t\tver_sig_regs[0].offset = drvdata->sig_offset;\n\t\tver_sig_regs[1].offset = drvdata->ver_offset;\n\t\tverset->regs = ver_sig_regs;\n\t\tverset->nregs = ARRAY_SIZE(ver_sig_regs);\n\t} else {\n\t\tverset->regs = pid_cid_regs;\n\t\tverset->nregs = ARRAY_SIZE(pid_cid_regs);\n\t}\n\tverset->base = drvdata->cc_base;\n\tverset->dev = dev;\n\n\tdebugfs_create_regset32(\"version\", 0400, drvdata->dir, verset);\n\treturn 0;\n}\n\nvoid cc_debugfs_fini(struct cc_drvdata *drvdata)\n{\n\tdebugfs_remove_recursive(drvdata->dir);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}