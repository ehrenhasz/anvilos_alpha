{
  "module_name": "atmel-i2c.h",
  "hash_id": "170e5fd16614f8f41b1fa942888c6e37f24f62f134ea1a23f96de629578ff2a5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/atmel-i2c.h",
  "human_readable_source": " \n \n\n#ifndef __ATMEL_I2C_H__\n#define __ATMEL_I2C_H__\n\n#include <linux/hw_random.h>\n#include <linux/types.h>\n\n#define ATMEL_ECC_PRIORITY\t\t300\n\n#define COMMAND\t\t\t\t0x03  \n#define SLEEP_TOKEN\t\t\t0x01\n#define WAKE_TOKEN_MAX_SIZE\t\t8\n\n \n#define WORD_ADDR_SIZE\t\t\t1\n#define COUNT_SIZE\t\t\t1\n#define CRC_SIZE\t\t\t2\n#define CMD_OVERHEAD_SIZE\t\t(COUNT_SIZE + CRC_SIZE)\n\n \n#define ATMEL_ECC_NIST_P256_N_SIZE\t32\n#define ATMEL_ECC_PUBKEY_SIZE\t\t(2 * ATMEL_ECC_NIST_P256_N_SIZE)\n\n#define STATUS_RSP_SIZE\t\t\t4\n#define ECDH_RSP_SIZE\t\t\t(32 + CMD_OVERHEAD_SIZE)\n#define GENKEY_RSP_SIZE\t\t\t(ATMEL_ECC_PUBKEY_SIZE + \\\n\t\t\t\t\t CMD_OVERHEAD_SIZE)\n#define READ_RSP_SIZE\t\t\t(4 + CMD_OVERHEAD_SIZE)\n#define RANDOM_RSP_SIZE\t\t\t(32 + CMD_OVERHEAD_SIZE)\n#define MAX_RSP_SIZE\t\t\tGENKEY_RSP_SIZE\n\n \nstruct atmel_i2c_cmd {\n\tu8 word_addr;\n\tu8 count;\n\tu8 opcode;\n\tu8 param1;\n\t__le16 param2;\n\tu8 data[MAX_RSP_SIZE];\n\tu8 msecs;\n\tu16 rxsize;\n} __packed;\n\n \n#define STATUS_SIZE\t\t\t0x04\n#define STATUS_NOERR\t\t\t0x00\n#define STATUS_WAKE_SUCCESSFUL\t\t0x11\n\n \n#define CONFIGURATION_ZONE\t\t0\n\n \n#define RSP_DATA_IDX\t\t\t1  \n#define DATA_SLOT_2\t\t\t2  \n\n \n#define DEVICE_LOCK_ADDR\t\t0x15\n#define LOCK_VALUE_IDX\t\t\t(RSP_DATA_IDX + 2)\n#define LOCK_CONFIG_IDX\t\t\t(RSP_DATA_IDX + 3)\n\n \n#define TWHI_MIN\t\t\t1500\n#define TWHI_MAX\t\t\t1550\n\n \n#define TWLO_USEC\t\t\t60\n\n \n#define MAX_EXEC_TIME_ECDH\t\t58\n#define MAX_EXEC_TIME_GENKEY\t\t115\n#define MAX_EXEC_TIME_READ\t\t1\n#define MAX_EXEC_TIME_RANDOM\t\t50\n\n \n#define OPCODE_ECDH\t\t\t0x43\n#define OPCODE_GENKEY\t\t\t0x40\n#define OPCODE_READ\t\t\t0x02\n#define OPCODE_RANDOM\t\t\t0x1b\n\n \n#define READ_COUNT\t\t\t7\n\n \n#define RANDOM_COUNT\t\t\t7\n\n \n#define GENKEY_COUNT\t\t\t7\n#define GENKEY_MODE_PRIVATE\t\t0x04\n\n \n#define ECDH_COUNT\t\t\t71\n#define ECDH_PREFIX_MODE\t\t0x00\n\n \nstruct atmel_ecc_driver_data {\n\tstruct list_head i2c_client_list;\n\tspinlock_t i2c_list_lock;\n} ____cacheline_aligned;\n\n \nstruct atmel_i2c_client_priv {\n\tstruct i2c_client *client;\n\tstruct list_head i2c_client_list_node;\n\tstruct mutex lock;\n\tu8 wake_token[WAKE_TOKEN_MAX_SIZE];\n\tsize_t wake_token_sz;\n\tatomic_t tfm_count ____cacheline_aligned;\n\tstruct hwrng hwrng;\n};\n\n \nstruct atmel_i2c_work_data {\n\tvoid *ctx;\n\tstruct i2c_client *client;\n\tvoid (*cbk)(struct atmel_i2c_work_data *work_data, void *areq,\n\t\t    int status);\n\tvoid *areq;\n\tstruct work_struct work;\n\tstruct atmel_i2c_cmd cmd;\n};\n\nint atmel_i2c_probe(struct i2c_client *client);\n\nvoid atmel_i2c_enqueue(struct atmel_i2c_work_data *work_data,\n\t\t       void (*cbk)(struct atmel_i2c_work_data *work_data,\n\t\t\t\t   void *areq, int status),\n\t\t       void *areq);\nvoid atmel_i2c_flush_queue(void);\n\nint atmel_i2c_send_receive(struct i2c_client *client, struct atmel_i2c_cmd *cmd);\n\nvoid atmel_i2c_init_read_cmd(struct atmel_i2c_cmd *cmd);\nvoid atmel_i2c_init_random_cmd(struct atmel_i2c_cmd *cmd);\nvoid atmel_i2c_init_genkey_cmd(struct atmel_i2c_cmd *cmd, u16 keyid);\nint atmel_i2c_init_ecdh_cmd(struct atmel_i2c_cmd *cmd,\n\t\t\t    struct scatterlist *pubkey);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}