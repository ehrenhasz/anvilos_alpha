{
  "module_name": "aspeed-hace.h",
  "hash_id": "98a7b8f07c6036c994dbb00ade9644d6846af12f95654437ff7bf5187dca26b9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/aspeed/aspeed-hace.h",
  "human_readable_source": " \n#ifndef __ASPEED_HACE_H__\n#define __ASPEED_HACE_H__\n\n#include <crypto/aes.h>\n#include <crypto/engine.h>\n#include <crypto/hash.h>\n#include <crypto/sha2.h>\n#include <linux/bits.h>\n#include <linux/compiler_attributes.h>\n#include <linux/interrupt.h>\n#include <linux/types.h>\n\n \n#define ASPEED_HACE_SRC\t\t\t0x00\t \n#define ASPEED_HACE_DEST\t\t0x04\t \n#define ASPEED_HACE_CONTEXT\t\t0x08\t \n#define ASPEED_HACE_DATA_LEN\t\t0x0C\t \n#define ASPEED_HACE_CMD\t\t\t0x10\t \n\n \n#define ASPEED_HACE_TAG\t\t\t0x18\t \n \n#define ASPEED_HACE_GCM_ADD_LEN\t\t0x14\t \n#define ASPEED_HACE_GCM_TAG_BASE_ADDR\t0x18\t \n\n#define ASPEED_HACE_STS\t\t\t0x1C\t \n\n#define ASPEED_HACE_HASH_SRC\t\t0x20\t \n#define ASPEED_HACE_HASH_DIGEST_BUFF\t0x24\t \n#define ASPEED_HACE_HASH_KEY_BUFF\t0x28\t \n#define ASPEED_HACE_HASH_DATA_LEN\t0x2C\t \n#define ASPEED_HACE_HASH_CMD\t\t0x30\t \n\n \n#define  HACE_CMD_SINGLE_DES\t\t0\n#define  HACE_CMD_TRIPLE_DES\t\tBIT(17)\n#define  HACE_CMD_AES_SELECT\t\t0\n#define  HACE_CMD_DES_SELECT\t\tBIT(16)\n#define  HACE_CMD_ISR_EN\t\tBIT(12)\n#define  HACE_CMD_CONTEXT_SAVE_ENABLE\t(0)\n#define  HACE_CMD_CONTEXT_SAVE_DISABLE\tBIT(9)\n#define  HACE_CMD_AES\t\t\t(0)\n#define  HACE_CMD_DES\t\t\t(0)\n#define  HACE_CMD_RC4\t\t\tBIT(8)\n#define  HACE_CMD_DECRYPT\t\t(0)\n#define  HACE_CMD_ENCRYPT\t\tBIT(7)\n\n#define  HACE_CMD_ECB\t\t\t(0x0 << 4)\n#define  HACE_CMD_CBC\t\t\t(0x1 << 4)\n#define  HACE_CMD_CFB\t\t\t(0x2 << 4)\n#define  HACE_CMD_OFB\t\t\t(0x3 << 4)\n#define  HACE_CMD_CTR\t\t\t(0x4 << 4)\n#define  HACE_CMD_OP_MODE_MASK\t\t(0x7 << 4)\n\n#define  HACE_CMD_AES128\t\t(0x0 << 2)\n#define  HACE_CMD_AES192\t\t(0x1 << 2)\n#define  HACE_CMD_AES256\t\t(0x2 << 2)\n#define  HACE_CMD_OP_CASCADE\t\t(0x3)\n#define  HACE_CMD_OP_INDEPENDENT\t(0x1)\n\n \n#define  HACE_CMD_RI_WO_DATA_ENABLE\t(0)\n#define  HACE_CMD_RI_WO_DATA_DISABLE\tBIT(11)\n#define  HACE_CMD_CONTEXT_LOAD_ENABLE\t(0)\n#define  HACE_CMD_CONTEXT_LOAD_DISABLE\tBIT(10)\n \n#define  HACE_CMD_AES_KEY_FROM_OTP\tBIT(24)\n#define  HACE_CMD_GHASH_TAG_XOR_EN\tBIT(23)\n#define  HACE_CMD_GHASH_PAD_LEN_INV\tBIT(22)\n#define  HACE_CMD_GCM_TAG_ADDR_SEL\tBIT(21)\n#define  HACE_CMD_MBUS_REQ_SYNC_EN\tBIT(20)\n#define  HACE_CMD_DES_SG_CTRL\t\tBIT(19)\n#define  HACE_CMD_SRC_SG_CTRL\t\tBIT(18)\n#define  HACE_CMD_CTR_IV_AES_96\t\t(0x1 << 14)\n#define  HACE_CMD_CTR_IV_DES_32\t\t(0x1 << 14)\n#define  HACE_CMD_CTR_IV_AES_64\t\t(0x2 << 14)\n#define  HACE_CMD_CTR_IV_AES_32\t\t(0x3 << 14)\n#define  HACE_CMD_AES_KEY_HW_EXP\tBIT(13)\n#define  HACE_CMD_GCM\t\t\t(0x5 << 4)\n\n \n#define  HACE_CRYPTO_ISR\t\tBIT(12)\n#define  HACE_HASH_ISR\t\t\tBIT(9)\n#define  HACE_HASH_BUSY\t\t\tBIT(0)\n\n \n#define  HASH_CMD_MBUS_REQ_SYNC_EN\tBIT(20)\n#define  HASH_CMD_HASH_SRC_SG_CTRL\tBIT(18)\n#define  HASH_CMD_SHA512_224\t\t(0x3 << 10)\n#define  HASH_CMD_SHA512_256\t\t(0x2 << 10)\n#define  HASH_CMD_SHA384\t\t(0x1 << 10)\n#define  HASH_CMD_SHA512\t\t(0)\n#define  HASH_CMD_INT_ENABLE\t\tBIT(9)\n#define  HASH_CMD_HMAC\t\t\t(0x1 << 7)\n#define  HASH_CMD_ACC_MODE\t\t(0x2 << 7)\n#define  HASH_CMD_HMAC_KEY\t\t(0x3 << 7)\n#define  HASH_CMD_SHA1\t\t\t(0x2 << 4)\n#define  HASH_CMD_SHA224\t\t(0x4 << 4)\n#define  HASH_CMD_SHA256\t\t(0x5 << 4)\n#define  HASH_CMD_SHA512_SER\t\t(0x6 << 4)\n#define  HASH_CMD_SHA_SWAP\t\t(0x2 << 2)\n\n#define HASH_SG_LAST_LIST\t\tBIT(31)\n\n#define CRYPTO_FLAGS_BUSY\t\tBIT(1)\n\n#define SHA_OP_UPDATE\t\t\t1\n#define SHA_OP_FINAL\t\t\t2\n\n#define SHA_FLAGS_SHA1\t\t\tBIT(0)\n#define SHA_FLAGS_SHA224\t\tBIT(1)\n#define SHA_FLAGS_SHA256\t\tBIT(2)\n#define SHA_FLAGS_SHA384\t\tBIT(3)\n#define SHA_FLAGS_SHA512\t\tBIT(4)\n#define SHA_FLAGS_SHA512_224\t\tBIT(5)\n#define SHA_FLAGS_SHA512_256\t\tBIT(6)\n#define SHA_FLAGS_HMAC\t\t\tBIT(8)\n#define SHA_FLAGS_FINUP\t\t\tBIT(9)\n#define SHA_FLAGS_MASK\t\t\t(0xff)\n\n#define ASPEED_CRYPTO_SRC_DMA_BUF_LEN\t0xa000\n#define ASPEED_CRYPTO_DST_DMA_BUF_LEN\t0xa000\n#define ASPEED_CRYPTO_GCM_TAG_OFFSET\t0x9ff0\n#define ASPEED_HASH_SRC_DMA_BUF_LEN\t0xa000\n#define ASPEED_HASH_QUEUE_LENGTH\t50\n\n#define HACE_CMD_IV_REQUIRE\t\t(HACE_CMD_CBC | HACE_CMD_CFB | \\\n\t\t\t\t\t HACE_CMD_OFB | HACE_CMD_CTR)\n\nstruct aspeed_hace_dev;\nstruct scatterlist;\n\ntypedef int (*aspeed_hace_fn_t)(struct aspeed_hace_dev *);\n\nstruct aspeed_sg_list {\n\t__le32 len;\n\t__le32 phy_addr;\n};\n\nstruct aspeed_engine_hash {\n\tstruct tasklet_struct\t\tdone_task;\n\tunsigned long\t\t\tflags;\n\tstruct ahash_request\t\t*req;\n\n\t \n\tvoid\t\t\t\t*ahash_src_addr;\n\tdma_addr_t\t\t\tahash_src_dma_addr;\n\n\tdma_addr_t\t\t\tsrc_dma;\n\tdma_addr_t\t\t\tdigest_dma;\n\n\tsize_t\t\t\t\tsrc_length;\n\n\t \n\taspeed_hace_fn_t\t\tresume;\n\taspeed_hace_fn_t\t\tdma_prepare;\n};\n\nstruct aspeed_sha_hmac_ctx {\n\tstruct crypto_shash *shash;\n\tu8 ipad[SHA512_BLOCK_SIZE];\n\tu8 opad[SHA512_BLOCK_SIZE];\n};\n\nstruct aspeed_sham_ctx {\n\tstruct aspeed_hace_dev\t\t*hace_dev;\n\tunsigned long\t\t\tflags;\t \n\n\tstruct aspeed_sha_hmac_ctx\tbase[];\n};\n\nstruct aspeed_sham_reqctx {\n\tunsigned long\t\tflags;\t\t \n\tunsigned long\t\top;\t\t \n\tu32\t\t\tcmd;\t\t \n\n\t \n\tstruct scatterlist\t*src_sg;\n\tint\t\t\tsrc_nents;\n\tunsigned int\t\toffset;\t\t \n\tunsigned int\t\ttotal;\t\t \n\n\tsize_t\t\t\tdigsize;\n\tsize_t\t\t\tblock_size;\n\tsize_t\t\t\tivsize;\n\tconst __be32\t\t*sha_iv;\n\n\t \n\tu8\t\t\tbuffer[SHA512_BLOCK_SIZE * 2];\n\tdma_addr_t\t\tbuffer_dma_addr;\n\tsize_t\t\t\tbufcnt;\t\t \n\n\t \n\tu8\t\t\tdigest[SHA512_DIGEST_SIZE] __aligned(64);\n\tdma_addr_t\t\tdigest_dma_addr;\n\tu64\t\t\tdigcnt[2];\n};\n\nstruct aspeed_engine_crypto {\n\tstruct tasklet_struct\t\tdone_task;\n\tunsigned long\t\t\tflags;\n\tstruct skcipher_request\t\t*req;\n\n\t \n\tvoid\t\t\t\t*cipher_ctx;\n\tdma_addr_t\t\t\tcipher_ctx_dma;\n\n\t \n\tvoid\t\t\t\t*cipher_addr;\n\tdma_addr_t\t\t\tcipher_dma_addr;\n\n\t \n\tvoid\t\t\t\t*dst_sg_addr;\n\tdma_addr_t\t\t\tdst_sg_dma_addr;\n\n\t \n\taspeed_hace_fn_t\t\tresume;\n};\n\nstruct aspeed_cipher_ctx {\n\tstruct aspeed_hace_dev\t\t*hace_dev;\n\tint\t\t\t\tkey_len;\n\tu8\t\t\t\tkey[AES_MAX_KEYLENGTH];\n\n\t \n\taspeed_hace_fn_t\t\tstart;\n\n\tstruct crypto_skcipher          *fallback_tfm;\n};\n\nstruct aspeed_cipher_reqctx {\n\tint enc_cmd;\n\tint src_nents;\n\tint dst_nents;\n\n\tstruct skcipher_request         fallback_req;    \n};\n\nstruct aspeed_hace_dev {\n\tvoid __iomem\t\t\t*regs;\n\tstruct device\t\t\t*dev;\n\tint\t\t\t\tirq;\n\tstruct clk\t\t\t*clk;\n\tunsigned long\t\t\tversion;\n\n\tstruct crypto_engine\t\t*crypt_engine_hash;\n\tstruct crypto_engine\t\t*crypt_engine_crypto;\n\n\tstruct aspeed_engine_hash\thash_engine;\n\tstruct aspeed_engine_crypto\tcrypto_engine;\n};\n\nstruct aspeed_hace_alg {\n\tstruct aspeed_hace_dev\t\t*hace_dev;\n\n\tconst char\t\t\t*alg_base;\n\n\tunion {\n\t\tstruct skcipher_engine_alg skcipher;\n\t\tstruct ahash_engine_alg ahash;\n\t} alg;\n};\n\nenum aspeed_version {\n\tAST2500_VERSION = 5,\n\tAST2600_VERSION\n};\n\n#define ast_hace_write(hace, val, offset)\t\\\n\twritel((val), (hace)->regs + (offset))\n#define ast_hace_read(hace, offset)\t\t\\\n\treadl((hace)->regs + (offset))\n\nvoid aspeed_register_hace_hash_algs(struct aspeed_hace_dev *hace_dev);\nvoid aspeed_unregister_hace_hash_algs(struct aspeed_hace_dev *hace_dev);\nvoid aspeed_register_hace_crypto_algs(struct aspeed_hace_dev *hace_dev);\nvoid aspeed_unregister_hace_crypto_algs(struct aspeed_hace_dev *hace_dev);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}