{
  "module_name": "rk3288_crypto.h",
  "hash_id": "119889a1e7f817921ec4ee99892611eee0cebcac5fd2caad5d8dd81593f47c3d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/rockchip/rk3288_crypto.h",
  "human_readable_source": " \n#ifndef __RK3288_CRYPTO_H__\n#define __RK3288_CRYPTO_H__\n\n#include <crypto/aes.h>\n#include <crypto/engine.h>\n#include <crypto/internal/des.h>\n#include <crypto/internal/hash.h>\n#include <crypto/internal/skcipher.h>\n#include <crypto/md5.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n#include <linux/dma-mapping.h>\n#include <linux/interrupt.h>\n#include <linux/pm_runtime.h>\n#include <linux/scatterlist.h>\n#include <linux/types.h>\n\n#define _SBF(v, f)\t\t\t((v) << (f))\n\n \n#define RK_CRYPTO_INTSTS\t\t0x0000\n#define RK_CRYPTO_PKA_DONE_INT\t\tBIT(5)\n#define RK_CRYPTO_HASH_DONE_INT\t\tBIT(4)\n#define RK_CRYPTO_HRDMA_ERR_INT\t\tBIT(3)\n#define RK_CRYPTO_HRDMA_DONE_INT\tBIT(2)\n#define RK_CRYPTO_BCDMA_ERR_INT\t\tBIT(1)\n#define RK_CRYPTO_BCDMA_DONE_INT\tBIT(0)\n\n#define RK_CRYPTO_INTENA\t\t0x0004\n#define RK_CRYPTO_PKA_DONE_ENA\t\tBIT(5)\n#define RK_CRYPTO_HASH_DONE_ENA\t\tBIT(4)\n#define RK_CRYPTO_HRDMA_ERR_ENA\t\tBIT(3)\n#define RK_CRYPTO_HRDMA_DONE_ENA\tBIT(2)\n#define RK_CRYPTO_BCDMA_ERR_ENA\t\tBIT(1)\n#define RK_CRYPTO_BCDMA_DONE_ENA\tBIT(0)\n\n#define RK_CRYPTO_CTRL\t\t\t0x0008\n#define RK_CRYPTO_WRITE_MASK\t\t_SBF(0xFFFF, 16)\n#define RK_CRYPTO_TRNG_FLUSH\t\tBIT(9)\n#define RK_CRYPTO_TRNG_START\t\tBIT(8)\n#define RK_CRYPTO_PKA_FLUSH\t\tBIT(7)\n#define RK_CRYPTO_HASH_FLUSH\t\tBIT(6)\n#define RK_CRYPTO_BLOCK_FLUSH\t\tBIT(5)\n#define RK_CRYPTO_PKA_START\t\tBIT(4)\n#define RK_CRYPTO_HASH_START\t\tBIT(3)\n#define RK_CRYPTO_BLOCK_START\t\tBIT(2)\n#define RK_CRYPTO_TDES_START\t\tBIT(1)\n#define RK_CRYPTO_AES_START\t\tBIT(0)\n\n#define RK_CRYPTO_CONF\t\t\t0x000c\n \n#define RK_CRYPTO_HR_ADDR_MODE\t\tBIT(8)\n \n#define RK_CRYPTO_BT_ADDR_MODE\t\tBIT(7)\n \n#define RK_CRYPTO_BR_ADDR_MODE\t\tBIT(6)\n#define RK_CRYPTO_BYTESWAP_HRFIFO\tBIT(5)\n#define RK_CRYPTO_BYTESWAP_BTFIFO\tBIT(4)\n#define RK_CRYPTO_BYTESWAP_BRFIFO\tBIT(3)\n \n#define RK_CRYPTO_DESSEL\t\t\t\tBIT(2)\n#define RK_CYYPTO_HASHINSEL_INDEPENDENT_SOURCE\t\t_SBF(0x00, 0)\n#define RK_CYYPTO_HASHINSEL_BLOCK_CIPHER_INPUT\t\t_SBF(0x01, 0)\n#define RK_CYYPTO_HASHINSEL_BLOCK_CIPHER_OUTPUT\t\t_SBF(0x02, 0)\n\n \n#define RK_CRYPTO_BRDMAS\t\t0x0010\n \n#define RK_CRYPTO_BTDMAS\t\t0x0014\n \n#define RK_CRYPTO_BRDMAL\t\t0x0018\n \n#define RK_CRYPTO_HRDMAS\t\t0x001c\n \n#define RK_CRYPTO_HRDMAL\t\t0x0020\n\n \n#define RK_CRYPTO_AES_CTRL\t\t\t  0x0080\n#define RK_CRYPTO_AES_BYTESWAP_CNT\tBIT(11)\n#define RK_CRYPTO_AES_BYTESWAP_KEY\tBIT(10)\n#define RK_CRYPTO_AES_BYTESWAP_IV\tBIT(9)\n#define RK_CRYPTO_AES_BYTESWAP_DO\tBIT(8)\n#define RK_CRYPTO_AES_BYTESWAP_DI\tBIT(7)\n#define RK_CRYPTO_AES_KEY_CHANGE\tBIT(6)\n#define RK_CRYPTO_AES_ECB_MODE\t\t_SBF(0x00, 4)\n#define RK_CRYPTO_AES_CBC_MODE\t\t_SBF(0x01, 4)\n#define RK_CRYPTO_AES_CTR_MODE\t\t_SBF(0x02, 4)\n#define RK_CRYPTO_AES_128BIT_key\t_SBF(0x00, 2)\n#define RK_CRYPTO_AES_192BIT_key\t_SBF(0x01, 2)\n#define RK_CRYPTO_AES_256BIT_key\t_SBF(0x02, 2)\n \n#define RK_CRYPTO_AES_FIFO_MODE\t\tBIT(1)\n \n#define RK_CRYPTO_AES_DEC\t\tBIT(0)\n\n#define RK_CRYPTO_AES_STS\t\t0x0084\n#define RK_CRYPTO_AES_DONE\t\tBIT(0)\n\n \n#define RK_CRYPTO_AES_DIN_0\t\t0x0088\n#define RK_CRYPTO_AES_DIN_1\t\t0x008c\n#define RK_CRYPTO_AES_DIN_2\t\t0x0090\n#define RK_CRYPTO_AES_DIN_3\t\t0x0094\n\n \n#define RK_CRYPTO_AES_DOUT_0\t\t0x0098\n#define RK_CRYPTO_AES_DOUT_1\t\t0x009c\n#define RK_CRYPTO_AES_DOUT_2\t\t0x00a0\n#define RK_CRYPTO_AES_DOUT_3\t\t0x00a4\n\n \n#define RK_CRYPTO_AES_IV_0\t\t0x00a8\n#define RK_CRYPTO_AES_IV_1\t\t0x00ac\n#define RK_CRYPTO_AES_IV_2\t\t0x00b0\n#define RK_CRYPTO_AES_IV_3\t\t0x00b4\n\n \n#define RK_CRYPTO_AES_KEY_0\t\t0x00b8\n#define RK_CRYPTO_AES_KEY_1\t\t0x00bc\n#define RK_CRYPTO_AES_KEY_2\t\t0x00c0\n#define RK_CRYPTO_AES_KEY_3\t\t0x00c4\n#define RK_CRYPTO_AES_KEY_4\t\t0x00c8\n#define RK_CRYPTO_AES_KEY_5\t\t0x00cc\n#define RK_CRYPTO_AES_KEY_6\t\t0x00d0\n#define RK_CRYPTO_AES_KEY_7\t\t0x00d4\n\n \n#define RK_CRYPTO_TDES_CTRL\t\t0x0100\n#define RK_CRYPTO_TDES_BYTESWAP_KEY\tBIT(8)\n#define RK_CRYPTO_TDES_BYTESWAP_IV\tBIT(7)\n#define RK_CRYPTO_TDES_BYTESWAP_DO\tBIT(6)\n#define RK_CRYPTO_TDES_BYTESWAP_DI\tBIT(5)\n \n#define RK_CRYPTO_TDES_CHAINMODE_CBC\tBIT(4)\n \n#define RK_CRYPTO_TDES_EEE\t\tBIT(3)\n \n#define RK_CRYPTO_TDES_SELECT\t\tBIT(2)\n \n#define RK_CRYPTO_TDES_FIFO_MODE\tBIT(1)\n \n#define RK_CRYPTO_TDES_DEC\t\tBIT(0)\n\n#define RK_CRYPTO_TDES_STS\t\t0x0104\n#define RK_CRYPTO_TDES_DONE\t\tBIT(0)\n\n#define RK_CRYPTO_TDES_DIN_0\t\t0x0108\n#define RK_CRYPTO_TDES_DIN_1\t\t0x010c\n#define RK_CRYPTO_TDES_DOUT_0\t\t0x0110\n#define RK_CRYPTO_TDES_DOUT_1\t\t0x0114\n#define RK_CRYPTO_TDES_IV_0\t\t0x0118\n#define RK_CRYPTO_TDES_IV_1\t\t0x011c\n#define RK_CRYPTO_TDES_KEY1_0\t\t0x0120\n#define RK_CRYPTO_TDES_KEY1_1\t\t0x0124\n#define RK_CRYPTO_TDES_KEY2_0\t\t0x0128\n#define RK_CRYPTO_TDES_KEY2_1\t\t0x012c\n#define RK_CRYPTO_TDES_KEY3_0\t\t0x0130\n#define RK_CRYPTO_TDES_KEY3_1\t\t0x0134\n\n \n#define RK_CRYPTO_HASH_CTRL\t\t0x0180\n#define RK_CRYPTO_HASH_SWAP_DO\t\tBIT(3)\n#define RK_CRYPTO_HASH_SWAP_DI\t\tBIT(2)\n#define RK_CRYPTO_HASH_SHA1\t\t_SBF(0x00, 0)\n#define RK_CRYPTO_HASH_MD5\t\t_SBF(0x01, 0)\n#define RK_CRYPTO_HASH_SHA256\t\t_SBF(0x02, 0)\n#define RK_CRYPTO_HASH_PRNG\t\t_SBF(0x03, 0)\n\n#define RK_CRYPTO_HASH_STS\t\t0x0184\n#define RK_CRYPTO_HASH_DONE\t\tBIT(0)\n\n#define RK_CRYPTO_HASH_MSG_LEN\t\t0x0188\n#define RK_CRYPTO_HASH_DOUT_0\t\t0x018c\n#define RK_CRYPTO_HASH_DOUT_1\t\t0x0190\n#define RK_CRYPTO_HASH_DOUT_2\t\t0x0194\n#define RK_CRYPTO_HASH_DOUT_3\t\t0x0198\n#define RK_CRYPTO_HASH_DOUT_4\t\t0x019c\n#define RK_CRYPTO_HASH_DOUT_5\t\t0x01a0\n#define RK_CRYPTO_HASH_DOUT_6\t\t0x01a4\n#define RK_CRYPTO_HASH_DOUT_7\t\t0x01a8\n\n#define CRYPTO_READ(dev, offset)\t\t  \\\n\t\treadl_relaxed(((dev)->reg + (offset)))\n#define CRYPTO_WRITE(dev, offset, val)\t  \\\n\t\twritel_relaxed((val), ((dev)->reg + (offset)))\n\n#define RK_MAX_CLKS 4\n\n \nstruct rockchip_ip {\n\tstruct list_head\tdev_list;\n\tspinlock_t\t\tlock;  \n\tstruct dentry\t\t*dbgfs_dir;\n\tstruct dentry\t\t*dbgfs_stats;\n};\n\nstruct rk_clks {\n\tconst char *name;\n\tunsigned long max;\n};\n\nstruct rk_variant {\n\tint num_clks;\n\tstruct rk_clks rkclks[RK_MAX_CLKS];\n};\n\nstruct rk_crypto_info {\n\tstruct list_head\t\tlist;\n\tstruct device\t\t\t*dev;\n\tstruct clk_bulk_data\t\t*clks;\n\tint\t\t\t\tnum_clks;\n\tstruct reset_control\t\t*rst;\n\tvoid __iomem\t\t\t*reg;\n\tint\t\t\t\tirq;\n\tconst struct rk_variant *variant;\n\tunsigned long nreq;\n\tstruct crypto_engine *engine;\n\tstruct completion complete;\n\tint status;\n};\n\n \nstruct rk_ahash_ctx {\n\t \n\tstruct crypto_ahash\t\t*fallback_tfm;\n};\n\n \nstruct rk_ahash_rctx {\n\tstruct rk_crypto_info\t\t*dev;\n\tstruct ahash_request\t\tfallback_req;\n\tu32\t\t\t\tmode;\n\tint nrsg;\n};\n\n \nstruct rk_cipher_ctx {\n\tunsigned int\t\t\tkeylen;\n\tu8\t\t\t\tkey[AES_MAX_KEY_SIZE];\n\tu8\t\t\t\tiv[AES_BLOCK_SIZE];\n\tstruct crypto_skcipher *fallback_tfm;\n};\n\nstruct rk_cipher_rctx {\n\tstruct rk_crypto_info\t\t*dev;\n\tu8 backup_iv[AES_BLOCK_SIZE];\n\tu32\t\t\t\tmode;\n\tstruct skcipher_request fallback_req;   \n};\n\nstruct rk_crypto_tmp {\n\tu32 type;\n\tstruct rk_crypto_info           *dev;\n\tunion {\n\t\tstruct skcipher_engine_alg skcipher;\n\t\tstruct ahash_engine_alg hash;\n\t} alg;\n\tunsigned long stat_req;\n\tunsigned long stat_fb;\n\tunsigned long stat_fb_len;\n\tunsigned long stat_fb_sglen;\n\tunsigned long stat_fb_align;\n\tunsigned long stat_fb_sgdiff;\n};\n\nextern struct rk_crypto_tmp rk_ecb_aes_alg;\nextern struct rk_crypto_tmp rk_cbc_aes_alg;\nextern struct rk_crypto_tmp rk_ecb_des_alg;\nextern struct rk_crypto_tmp rk_cbc_des_alg;\nextern struct rk_crypto_tmp rk_ecb_des3_ede_alg;\nextern struct rk_crypto_tmp rk_cbc_des3_ede_alg;\n\nextern struct rk_crypto_tmp rk_ahash_sha1;\nextern struct rk_crypto_tmp rk_ahash_sha256;\nextern struct rk_crypto_tmp rk_ahash_md5;\n\nstruct rk_crypto_info *get_rk_crypto(void);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}