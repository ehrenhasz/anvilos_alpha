{
  "module_name": "caamhash_desc.c",
  "hash_id": "94afd4abc1951f3c4a1472daf1e88b29391951d7c52c4ec2ba6a7aa73acaeeaa",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/caam/caamhash_desc.c",
  "human_readable_source": "\n \n\n#include \"compat.h\"\n#include \"desc_constr.h\"\n#include \"caamhash_desc.h\"\n\n \nvoid cnstr_shdsc_ahash(u32 * const desc, struct alginfo *adata, u32 state,\n\t\t       int digestsize, int ctx_len, bool import_ctx, int era)\n{\n\tu32 op = adata->algtype;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tif (state != OP_ALG_AS_UPDATE && adata->keylen) {\n\t\tu32 *skip_key_load;\n\n\t\t \n\t\tskip_key_load = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_SHRD);\n\n\t\tif (era < 6)\n\t\t\tappend_key_as_imm(desc, adata->key_virt,\n\t\t\t\t\t  adata->keylen_pad,\n\t\t\t\t\t  adata->keylen, CLASS_2 |\n\t\t\t\t\t  KEY_DEST_MDHA_SPLIT | KEY_ENC);\n\t\telse\n\t\t\tappend_proto_dkp(desc, adata);\n\n\t\tset_jump_tgt_here(desc, skip_key_load);\n\n\t\top |= OP_ALG_AAI_HMAC_PRECOMP;\n\t}\n\n\t \n\tif (import_ctx)\n\t\tappend_seq_load(desc, ctx_len, LDST_CLASS_2_CCB |\n\t\t\t\tLDST_SRCDST_BYTE_CONTEXT);\n\n\t \n\tappend_operation(desc, op | state | OP_ALG_ENCRYPT);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS2 | FIFOLD_TYPE_LAST2 |\n\t\t\t     FIFOLD_TYPE_MSG | KEY_VLF);\n\t \n\tappend_seq_store(desc, digestsize, LDST_CLASS_2_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n}\nEXPORT_SYMBOL(cnstr_shdsc_ahash);\n\n \nvoid cnstr_shdsc_sk_hash(u32 * const desc, struct alginfo *adata, u32 state,\n\t\t\t int digestsize, int ctx_len)\n{\n\tu32 *skip_key_load;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\n\t \n\tskip_key_load = append_jump(desc, JUMP_TEST_ALL | JUMP_COND_SHRD);\n\n\tif (state == OP_ALG_AS_INIT || state == OP_ALG_AS_INITFINAL) {\n\t\tappend_key_as_imm(desc, adata->key_virt, adata->keylen,\n\t\t\t\t  adata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\t} else {  \n\t\tif (is_xcbc_aes(adata->algtype))\n\t\t\t \n\t\t\tappend_key(desc, adata->key_dma, adata->keylen,\n\t\t\t\t   CLASS_1 | KEY_DEST_CLASS_REG | KEY_ENC);\n\t\telse  \n\t\t\tappend_key_as_imm(desc, adata->key_virt, adata->keylen,\n\t\t\t\t\t  adata->keylen, CLASS_1 |\n\t\t\t\t\t  KEY_DEST_CLASS_REG);\n\t\t \n\t\tappend_seq_load(desc, ctx_len, LDST_CLASS_1_CCB |\n\t\t\t\tLDST_SRCDST_BYTE_CONTEXT);\n\t}\n\n\tset_jump_tgt_here(desc, skip_key_load);\n\n\t \n\tappend_operation(desc, adata->algtype | state | OP_ALG_ENCRYPT);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLD_TYPE_LAST1 |\n\t\t\t     FIFOLD_TYPE_MSG | FIFOLDST_VLF);\n\n\t \n\tappend_seq_store(desc, digestsize, LDST_CLASS_1_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\tif (is_xcbc_aes(adata->algtype) && state == OP_ALG_AS_INIT)\n\t\t \n\t\tappend_fifo_store(desc, adata->key_dma, adata->keylen,\n\t\t\t\t  LDST_CLASS_1_CCB | FIFOST_TYPE_KEY_KEK);\n}\nEXPORT_SYMBOL(cnstr_shdsc_sk_hash);\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\nMODULE_DESCRIPTION(\"FSL CAAM ahash descriptors support\");\nMODULE_AUTHOR(\"NXP Semiconductors\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}